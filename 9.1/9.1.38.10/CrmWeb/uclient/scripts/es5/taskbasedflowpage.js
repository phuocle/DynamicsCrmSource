(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/taskbasedflowpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[106,30],{"+6eZ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){var t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},"+P1Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("c/eZ"),a=r("gk6Q"),i=r("YCDx"),o=r("QAhb"),s=r("n1Ju"),c=function(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]},l=r("IiPO"),u=r("+Z9T"),p=r("HSdq"),d=r("F2uj"),h=r("c7nC"),g=r("9r0m"),f=r("H9Ho"),m=r("kvLG");var b,v=r("ezfI"),y=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._entityAttribute=null,b=t,s.registerObserversForControlStateChange(),s}return Object(n.__extends)(t,e),t.prototype.getAttribute=function(){var e="ClientApi.XrmDataControl.getAttribute";try{if(v.a.instance.reportCall(e),!this._entityAttribute){var t=void 0;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{var r=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=r.get(this.controlDescriptor.DataFieldName)}}return v.a.instance.reportSuccess(e),this._entityAttribute}catch(t){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.updateAttribute=function(e,t){var r="ClientApi.XrmDataControl.updateAttribute";try{if(v.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;var n=e.attributes;n&&(this._entityAttribute=n.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),v.a.instance.reportSuccess(r)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype.addNotification=function(e){var t="ClientApi.XrmDataControl.addNotification";try{if(v.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){var r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):b.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),b.dispatch(Object(s.b)(this.pageId,this.getName(),r,this.contextToken)),v.a.instance.reportSuccess(t),!0}return v.a.instance.reportSuccess(t),!1}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype._clearControlNotification=function(e){var t=this,r=Object(p.A)(b.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(r){var n=Object.keys(r),a=null;if(e){if(!((a=r[e])&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(u.a)(e)||0===e.trim().length)&&n.forEach((function(e){a=r[e],t._clearNotification(a)}));return!0}return!1},t.prototype._clearNotification=function(e){e.actions=null,e.messages=null,e.notificationLevel=null,b.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))},t.prototype.clearNotification=function(e){var t="ClientApi.XrmDataControl.clearNotification";try{v.a.instance.reportCall(t);var r=!!this._clearControlNotification(e);return v.a.instance.reportSuccess(t),r}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setNotification=function(e,t){var r="ClientApi.XrmDataControl.setNotification";try{v.a.instance.reportCall(r);var n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return v.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype._isValidNotification=function(e){return!(!e||!e.messages||Object(f.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)},t.prototype._reportAddNotificationEvent=function(e){if(this._isValidNotification(e)){var t,r=e.messages[0],n=new c("Added",this.contextToken.entityTypeName,this.getName(),r);b.dispatch((t=n,{type:"report.xrm.event",execute:function(e,r){try{l.a.getInstance().reportEvent(t)}catch(e){var n="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(n,e),Object(u.j)(n,"XrmReporting")}return Promise.resolve()}}))}},t.prototype.getEntityReference=function(){var e=this.formContext.entityReference,t=e.id?new g.a(e.id):null;return new o.a(e.entityType,t)},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(a.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t.prototype.getAttrDescriptor=function(e,t,r){var n=this.getEntityReference().etn,a=Object(p.r)(b.getState(),n,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),(a=Object(d.a)(b.getState(),n,this.controlDescriptor.DataFieldName))||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),a},t}(i.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"+ulc":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ShowHeaderFieldsInFlyout.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{headerFieldsInFlyout:r},meta:{pageId:e,contextKey:i}}}},"/0Gr":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("gBKR"),a=r("lMVv"),i=r("uO/V"),o=r("F7qm"),s=r("F2uj");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute:function(t,r){var i=t.dispatch,o=t.getState;try{var s=Object(a.h)(o(),e),c={};return u(c,e),Object.keys(s.ManyToManyRelationships).forEach((function(t){var r=s.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){var n=r.Entity1LogicalName;n===e&&(n=r.Entity2LogicalName),u(c,n)}})),Object.keys(s.OneToManyRelationships).forEach((function(e){var t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(c,t.ReferencingEntity,t.ReferencingAttribute)})),Object.keys(s.ManyToOneRelationships).forEach((function(e){var t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(c,t.ReferencedEntity),u(c,t.ReferencingEntity,t.ReferencingAttribute))})),i(Object(n.e)(c)).catch((function(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}))}catch(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute:function(t,r){var n=t.getState;try{var i,c=n(),l=Object(a.h)(c,e),u=[];return Object.keys(l.OneToManyRelationships).forEach((function(e){var t,r,n=l.OneToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencingEntity,h=Object(a.h)(c,i),g=Object(s.a)(c,i,n.ReferencingAttribute);if(h){var f=p(h,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:h.DisplayCollectionName),m=d(n,h.DisplayCollectionName,o.RelationshipType.OneToMany);u.push([f,m])}}})),Object.keys(l.ManyToManyRelationships).forEach((function(e){var t,r,n=l.ManyToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=!0,s=n.Entity1LogicalName,d=void 0,h=void 0,g=!0;if(s===l.EntityLogicalName?(s=n.Entity2LogicalName,n.IsCustomRelationship&&(i=2!==n.Entity2AssociatedMenuConfiguration.Behavior),h=n.Entity2AssociatedMenuConfiguration.Behavior,d=null!==(t=n.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",g=!1):(n.IsCustomRelationship&&(i=2!==n.Entity1AssociatedMenuConfiguration.Behavior),h=n.Entity1AssociatedMenuConfiguration.Behavior,d=null!==(r=n.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),i)if(b=Object(a.h)(c,s)){var f=p(b,1===h?d:b.DisplayCollectionName),m=void 0;m=g?{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute}:{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity2IntersectAttribute},u.push([f,m])}if(n.Entity1LogicalName===n.Entity2LogicalName){var b=Object(a.h)(c,n.Entity2LogicalName);if(2!==n.Entity1AssociatedMenuConfiguration.Behavior){f=p(b,1===n.Entity1AssociatedMenuConfiguration.Behavior?n.Entity1AssociatedMenuConfiguration.Label:b.DisplayCollectionName),m={displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute};u.push([f,m])}}}})),Object.keys(l.ManyToOneRelationships).forEach((function(e){var t,r,n=l.ManyToOneRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencedEntity,h=n.ReferencingAttribute,g=Object(a.h)(c,i),f=Object(s.a)(c,l.EntityLogicalName,h);if(g){var m=d(n,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==f?void 0:f.DisplayName)&&void 0!==r?r:g.DisplayCollectionName,o.RelationshipType.ManyToOne);u.push([p(g,g.DisplayCollectionName),m])}}})),i=u.sort((function(e,t){var r,n,a,i;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;var o=e[1].displayName.localeCompare(t[1].displayName);return 0===o?(null===(a=e[0])||void 0===a?void 0:a.displayName)&&(null===(i=t[0])||void 0===i?void 0:i.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:o})),Promise.resolve(i)}catch(t){return h(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function p(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function d(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function h(e,t,r,n,a){var o=[{name:i.k,value:e}];return t.EventManager.ReportComponentFailure(Object(i.G)(n,a),r,null,o),Promise.resolve(null)}},"/CqC":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.relationship.clear";function a(e,t){return{type:n,payload:{relationship:t},meta:{pageId:e}}}},"/U1C":function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("c/eZ"),a={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(a),o={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(o),c={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},l=Object.values(c),u={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},p=Object.values(u),d=Object(n.__spreadArrays)(i,s,p);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/V8d":function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"e",(function(){return D})),r.d(t,"d",(function(){return B})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return R}));var n=r("c/eZ"),a=r("pOv+"),i=r("9r0m"),o=r("sgPk"),s=r("U0B9"),c=r("2OIc"),l=r("Gemh"),u=r("kl3Z"),p=r("lMVv"),d=r("bH46"),h=r("i8/j"),g=r("PQ2H"),f=r("8xrh"),m=r("WS0f"),b=r("7EJx"),v=r("vt+k"),y=r("QAhb"),_=r("HSdq"),S=r("yHpA"),O=r("hl8w"),C=r("RNNy"),I=r("F2uj"),j=r("uO/V"),P=r("qC0c"),T=r("cZkS"),x=r("jigW"),E=r("i2G7"),F=r("sOTk"),w=r("xkx/"),N=r("r2h9"),A=r("+l2M"),k=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],M=["Opportunity_ActivityPointers"];function D(e){var t,r=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(j.r)&&e.control.Parameters[j.r],n=[e.viewId,r,e.recordsPerPage,(t=e,t&&t.controlParameters&&t.controlParameters.ChartDrillDownParameters&&t.controlParameters.ChartDrillDownParameters.length>0)];return e.customQueryStateKeyParts&&n.push.apply(n,e.customQueryStateKeyParts),n.join("")}function R(e,t,r,n,a){var i=L(e,t,r,n,a);return function(t){var r=i(t);return r&&r.getQueryState(r instanceof o.a?void 0:e)}}function L(e,t,r,n,a){var c={};return function(u){var p=new i.a(u.viewId),d=Object(l.qb)(e(),p,t);if(!d)return null;var h=function(e,t,r){var n=t.fetchXML,a=null,i="TeamTemplateId";if(t.entityLogicalName===C.a&&e.controlParameters[i]){var o=e.controlParameters[i];if(n&&n.indexOf(o)<0){var s=r?r.guid:"",c=Object(O.a)(n,o,s);n=c.updatedFetchXml,a=c.filterString}}return{fetchXML:n,filterString:a}}(u,d,n),g=h.fetchXML;if(!g&&d.queryApi)return null;if(Object(x.l)(e())&&u.quickFindViewId){var j=new i.a(u.quickFindViewId),k=i.a.isNullOrEmpty(j)?null:Object(l.qb)(e(),j,t);Object(m.a)(k)||(g=function(e,t){var r=new DOMParser;if(e){for(var n=r.parseFromString(e.fetchXML,"text/xml"),a=r.parseFromString(t.fetchXML,"text/xml"),i=n.getElementsByTagName("filter"),o=0;o<i.length;o++)i[o].attributes&&i[o].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[o]);return(new XMLSerializer).serializeToString(a)}return t.fetchXML}(k,d))}var D=e(),R=u.entityLogicalName,L=u.getCustomFilter&&u.getCustomFilter(),V=function(e,t,r,n,a){var o=a.controlParameters.RelationshipName;if(o){var s=n,c=null,u=null;if(a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;if(a.controlParameters.IsDataSetLookup)if(s=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;var p=Object(_.ac)(e,t,a.contextToken),d=new y.a(r,s),h=null,g=!1;Object(I.a)(e,r,c)?h=Object(S.d)(e,p,d,c):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===r&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);var f=h;f&&f.reference?s=f.reference.id:!a.controlParameters.IsDataSetLookup&&null===c||null!==f&&null!==f.reference||!d||null===d.id||g||(s=null);var m=Object(l.kb)(e,t,a.contextToken),b=0,O=v.h.None;return m?(b=1,-1===M.indexOf(o)&&(O=v.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(b=2),{type:b,rollupType:O,entityReference:d,contextId:s,relationshipName:o}}return null}(D,t,a||r&&r.EntityLogicalName,n,u),G=Object(f.p)(e(),R),z=function(e,t,r,n,a,o,s){var c,u=Object(F.g)(e,o),p=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(l.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),d=Object(l.qb)(e,s,o),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(c=t.control)||void 0===c?void 0:c.ClassId,A.E));return Object(w.e)(e)&&(h||Object(w.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!a&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!p&&(null==d?void 0:d.queryType)!==N.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(D,u,V,L,G,t,p)?E.a.fromView(p,u.quickFindSearchString):o.a.fromXmlAndSql(g,d.offlineSqlQuery,p,u.quickFindSearchString,R,e);(null==h?void 0:h.filterString)&&n&&z.addExistingContextFilterToKey(i.a.toString(n),h.filterString);var W=Object(l.x)(e(),t,u.contextToken);W&&(z.pageNumber=W);var q=B(e(),t,r,u,d,R);q.length&&z.select.apply(z,q);var U=function(e,t,r,n,a,i){var o=null;if(!Object(P.a)(e,T.ub)||!i.hasGrid||1!==i.gridType)return null;var c=Object(l.j)(n)(e,t,i.contextToken),u=Object(s.b)(e),p=c&&c.CustomControls&&c.CustomControls[u]&&c.CustomControls[u].Parameters;if(!Object(l.vb)(p)&&(o=Object(l.o)(e,r))){var d=[],h=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(h)for(var g in h)h.hasOwnProperty(g)&&d.push(h[g].name);-1!==d.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(x.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,R,p,d,u);U&&(U.lookupAttribute&&z.select(U.lookupAttribute),U.primaryAttribute&&z.addChildCountAttribute(U.primaryAttribute));var X=u.getCustomSorting&&u.getCustomSorting(d,c);if(X)for(var H=0,K=X;H<K.length;H++){var Q=K[H];z.orderBy(Q.name,1===Q.sortDirection)}if(V)switch(V.type){case 1:z.applyRollupContextFilter(V.entityReference,V.rollupType);break;case 2:var Y=Object(l.v)(D,t,u.contextToken);z.applyContextFilter(V.relationshipName,V.contextId,D,Y?Y.relationshipRoleOrdinal:void 0)}if(G&&z.where(G),L&&L.filter)if(Array.isArray(L.filter))for(var J=0,Z=L.filter;J<Z.length;J++){var $=Z[J];z.where($,$.shouldReplace)}else!function(e){return!!(e&&e.operator&&e.terms)}($=L.filter)?z.where(Object(f.n)(L.filter,null)):z.where($,$.shouldReplace);if(L&&L.linkEntities)for(var ee=0,te=L.linkEntities;ee<te.length;ee++){var re=te[ee];z.addLinkedEntity(re,re.attributes||[])}var ne=u.recordsPerPage;if(ne)z.pageSize=ne;else{var ae=Object(b.h)(e());u.hasChart||Object(m.a)(ae)?z instanceof o.a&&z.setDefaultPageSize():z.pageSize=ae}return z}}function B(e,t,r,o,f,m){var b=Object(n.__spreadArrays)(function(e,t,r,n){if(0!==r.gridType)return[];var a="Grid",i=Object(s.b)(e),o=t&&Object(c.a)(r.control,t,i);o&&(a=Object(l.ab)(e,o.CustomControlId));return Object(u.b)(e,r.control.UniqueId,a,t&&t.Id,null,null,n)||[]}(e,r,o,f.viewId),function(e,t,r,n){if(1!==t.gridType)return[];return Object(u.a)(e,r,n)||[]}(e,o,m,f.viewId),function(e,t,r,n){var a=[],i=Object(p.h)(e,n);i&&(function(e,t,r){var n=Object(s.b)(e),a=t&&Object(c.a)(r.control,t,n);return a&&[a.CustomControlId&&a.Name].some((function(e){return-1!==k.indexOf(e)}))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(l.vb)(r.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(x.a)(i.PrimaryImageAttribute)));return a}(e,r,o,m),function(e,t,r){var n=[];if(4&t.streamMode){n.push("modifiedon");var a=Object(I.d)(e,r);if(a)for(var i in a){var o=a[i];o.IsSortableEnabled&&"image"!==o.Type&&"multiselectpicklist"!==o.Type&&Object(d.b)(e,r,o.LogicalName,o)&&n.push(o.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}(e,o,m),function(e,t,r,n){var o=[],s=r.cardFormId;if(s)if("activitypointer"===n)o.push.apply(o,d.a);else{var c=i.a.equals(s,a.a)?Object(h.h)(e,n,Object(g.a)(11)):s,l=Object(h.d)(e,c,t);if(l)for(var u in l){var p=l[u];p.DataFieldName&&o.push(p.DataFieldName)}}return o}(e,t,o,m),o.getCustomColumns?o.getCustomColumns():[]);if(b.length){var v=[],y=[],_=f&&f.grid&&f.grid.rows&&f.grid.rows[0]&&f.grid.rows[0].cells;if(_)for(var S in _)_.hasOwnProperty(S)&&y.push(_[S].name);for(var O in b){var C=b[O];-1===y.indexOf(C)&&-1===v.indexOf(C)&&v.push(C)}return v}return b}},"/W63":function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n=r("ar+e"),a=r("VlhU"),i=r("bCrZ"),o=r("Gemh"),s=r("r2h9"),c=r("RlP9"),l=r("sgPk"),u=r("olrR"),p=r("uO/V"),d=r("7pqb"),h=r("s2by"),g=r("19Zc"),f=r("fE8x"),m=r("YrcW"),b=r("JlqV"),v=r("jigW"),y=r("G7N+"),_=r("qC0c"),S=r("cZkS"),O=r("5cS+"),C=r("gBKR"),I=p.x+"."+p.v;function j(e,t,r,n,a,s,u,p,d,f){var m=T(n,u,d),y=Object(c.c)(t,r);if(!y)return Promise.resolve(null);var O=l.a.fromXmlAndSql(y.fetchXML,y.offlineSqlQuery,r).getQueryState(),C=f||Object(o.db)(t,n,u),I=Object(v.c)(a,s),j=!1;Object(b.b)(t)&&Object(v.h)(t,s.relationshipName,!0)&&(j=!0);var x=Object(o.ub)(t,n);if(x||"activitypointer"===n||j){var E=t.user&&t.user.userId,F=Object(_.c)(t,S.Zc),w=Object(h.a)(n,E,s,F,x);return e(w.getFilterOptionsAction()).then((function(r){if(r&&r.length>0){var o=r.filter((function(e){return e.isDefault}));if(o&&o.length>0){var c=w.getFilterExpression(o[0].value);e(Object(g.l)(c,a,s))}}return e(Object(i.d)(O,n,a,s,null,u,C,j,I)).then((function(r){return P(e,r,t,n,a,m,p)}))}))}return e(Object(i.d)(O,n,a,s,null,u,C,void 0,I)).then((function(r){return P(e,r,t,n,a,m,p)}))}function P(e,t,r,n,a,s,c){var l=Object(f.c)(r),u=Object(f.b)(r);return(l||u)&&Object(o.sb)(r,n)&&Object(i.e)(c,e,n,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function T(e,t,r){return[{name:d.a.CorrelationId,value:r.correlationId},{name:d.a.ContextId,value:r.contextId},{name:d.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function x(e,t,r){var i=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute:function(i,l,p){var h=i.dispatch,g=i.getState,f=g(),b=Object(n.e)(f,{id:e},t.parentContextToken),v=T(r.entityName,r.relationshipName,p);if(h(Object(a.b)(e,t,r)),null!==b&&b.id===r.id&&b.isSelected===r.isSelected&&b.relationshipName===r.relationshipName||h(Object(a.b)(e,t.parentContextToken,r)),h(Object(m.a)(e,r)),r&&!r.url){var P=function(e,t){return[{name:d.a.CorrelationId,value:e.correlationId},{name:d.a.ContextId,value:e.contextId},{name:d.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(p,r.entityName);if(!Object(o.v)(f,e,t)){h(Object(u.b)(r.entityName,s.a.MAIN_APPLICATION_VIEW));var x=Object(c.a)(f,r.entityName,s.a.SUB_GRID),E=Object(c.c)(f,x),F=Object(_.c)(f,S.Xc),w=!F||function(e,t){var r,n,a;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(a=e.metadata)||void 0===a?void 0:a.entities))return!0;var i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(var o=0;o<i.length;o++)if(i[o].relatedEntityName&&!e.metadata.entities[i[o].relatedEntityName])return!1;return!0}(f,E);return E&&E.initialized===y.a.Initialized&&w?(j(h,f,x,r.entityName,e,t,r.relationshipName,l,p,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),Promise.resolve(x)):h(Object(u.a)(r.entityName,s.a.SUB_GRID)).then((function(n){var a=Promise.resolve();if(F){var i=Object(O.a)(f,n,e);a=h(Object(C.e)(i))}return a.then((function(){var a=g();return j(h,a,n,r.entityName,e,t,r.relationshipName,l,p,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),n}))}),(function(e){l.EventManager.ReportComponentFailure(I,e,null,v)}))}}return Promise.resolve(null)},getFailureParameters:function(e,t){return i}}}},"/lKk":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("UGbr"),a=r("/j9Z"),i=r("71iK"),o=r("RYq1"),s=r("LFYt"),c=r("Ww2r"),l=r("HfRC"),u=r("yOMg"),p=r("VnuK"),d=r("rIXY"),h=r("Sscr"),g=r("HSdq"),f=r("yHpA"),m=r("zsi3"),b=r("+ieV"),v=r("Srej");function y(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute:function(t,r,y){var _=t.dispatch,S=(0,t.getState)(),O=Object(h.j)(S,e),C=Object(g.zb)(S,e,O),I=Object(g.ac)(S,e,O);if(!(!Object(f.g)(S,I)&&C&&Object.keys(C).length>0))return _(Object(n.e)(e,2)).then((function(t){var n=Object(g.Ib)(S,e),h=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(t){var f=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:t.etn}];return r.EventManager.ReportComponentSuccess(h,f),(n?Promise.resolve(e):_(Object(s.b)(e,t))).then((function(e){return _(Object(i.a)(t.etn)),function(e,t,r){var n="quickcreate_",a=Object(c.e)(t,[d.g,d.c]),i={actionLabel:Object(c.c)(a,d.g),eventHandler:function(){e(Object(l.a)(r)),e(Object(u.removeToastNotification)(n+r.id.guid))}},o=null,s={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(a,d.c),title:null,action:i,onCloseHandler:o};e(Object(p.b)(s))}(_,S,t),_(Object(o.e)(e,"save")).then((function(){return t}))}))}return r.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))}));for(var j in C){var P=C[j].label,T=C[j].errorMessage,x=_(Object(b.b)(P,T));_(Object(b.c)(O,e,x,m.a.error,Object(v.d)(e,j)))}}}}},"/wtJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return p}));var n=r("UOiB"),a=r("Sscr"),i=r("HSdq"),o=r("ObKm"),s=r("yHpA"),c=r("sOTk"),l=r("krRo"),u="attribute.precision";function p(e,t,r,p){return{type:"attribute.precision.update",sync:!0,execute:function(d,h){var g,f=d.dispatch,m=d.getState,b=m();f(function(e,t,r,i){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(l.e)(e,t,r,i);var o=Object(a.x)(t);return{type:u,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,p)),b=m();var v=null,y=null,_=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)v=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,_=Object(a.t)(t),S=Object(a.r)(t);else{var O=Object(c.g)(b,e);v=O&&O.entityTypeName?O.entityTypeName:null,y=O&&O.id?O.id:null,_=null,S=t}var C=Object(i.ac)(b,e,t),I=Object(s.d)(b,C,{etn:v,id:y},r),j=((g={})[r]=I,g);f(Object(o.a)(e,j,!0,!0,v,y?y.guid:null,_,S))}}}},"0MLN":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.setLabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{label:r},meta:{pageId:e,contextKey:i}}}},"0bF2":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="grid.updatequerykey";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(r),o=Object(n.v)(r);return{type:a,payload:e,meta:{pageId:t,contextKey:i,dataSetContextKey:o}}}},"0hCf":function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n,a,i=r("HSdq"),o=r("yZTI"),s=r("Zy0S"),c=r("c/eZ"),l=r("FlW1"),u=r("ll2N"),p=r("s0Zj"),d=r("+Z9T"),h=r("w/nD"),g=r("ksD2"),f=r("A8fJ"),m=r("PLtI"),b=r("IiPO"),v=r("ezfI"),y=r("7ipg"),_=function(e){function t(t,r,a,i,o,s){var c=this;return Object(d.g)(o,"ClientApi.XrmTab.constructor","parent"),Object(d.g)(t,"ClientApi.XrmTab.constructor","store"),c=e.call(this,t,r,i,a)||this,n=t,c._parent=o,c._formContext=s,c._iConnectedTabProps={tabName:c.name,tabId:c._getTabId(),id:c.pageId,showTab:!0},c._clientApiExecutor=new y.b(n,"ClientApi.XrmTab.",r),c}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){var e="ClientApi.XrmTab.sections";try{if(v.a.instance.reportCall(e),!this._sections){this._sections=new s.a(e);for(var t=n.getState(),r=Object(i.Gc)(t,this.pageId,this.name,this.contextToken),a=0;a<r.Columns.length;a++)for(var o=Object(i.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:a},this.contextToken),c=null,l=0;l<o.SectionNames.length;l++)c=new u.a(n,this.contextToken,this.pageId,o.SectionNames[l],this,this._formContext),this._sections.add(c.getName(),c)}return v.a.instance.reportSuccess(e),this._sections}catch(t){var p=b.a.getInstance().getEventParameters(this.contextToken);throw p.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,p),t}},enumerable:!1,configurable:!0}),t.prototype.addTabStateChange=function(e){var t="ClientApi.XrmTab.addTabStateChange";Object(d.g)(e,t,"handler");try{v.a.instance.reportCall(t),n.dispatch(Object(h.s)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeTabStateChange=function(e){var t="ClientApi.XrmTab.removeTabStateChange";Object(d.g)(e,t,"handler");try{v.a.instance.reportCall(t),n.dispatch(Object(h.N)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getDisplayState=function(){var e="ClientApi.XrmTab.getDisplayState";try{v.a.instance.reportCall(e);var t=Object(i.Dc)(n.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return v.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParent=function(){return v.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent},t.prototype.setDisplayState=function(e){var t="ClientApi.XrmTab.setDisplayState";try{v.a.instance.reportCall(t);var r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(d.h)(t,"TabDisplayState",e)}r||n.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess(t)}catch(e){var a=b.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.setFocus=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.setFocus"),n.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){var e=b.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTab.setVisible";try{v.a.instance.reportCall(t),n.dispatch(Object(g.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getLabel=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.getLabel");var e=Object(i.Hc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return v.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){var t=b.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}},t.prototype.getVisible=function(){var e="ClientApi.XrmTab.getVisible";try{v.a.instance.reportCall(e);var t=Object(i.Kc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return v.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTab.setLabel";Object(d.g)(e,t,"label");try{v.a.instance.reportCall(t),n.dispatch(Object(m.b)(this.pageId,this.contextToken,this._getTabId(),e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype._getTabId=function(){var e=n.getState(),t=Object(i.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id},t.prototype.setContentType=function(e){var t=this;return this._clientApiExecutor.execute("setContentType",(function(){var r;switch(e){case"default":case"cardSections":r="cardSections";break;case"expandAvailableSpace":case"singleComponent":r="singleComponent";break;default:Object(d.h)("setContentType","TabContentType",e)}n.dispatch(Object(f.b)(t.pageId,t._getTabId(),t.contextToken,r))}),[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])},t.prototype.getContentType=function(){var e=this;return this._clientApiExecutor.execute("getContentType",(function(){var t;return null===(t=Object(i.Jc)(n.getState(),e._getTabId(),e._iConnectedTabProps.id,e.contextToken))||void 0===t?void 0:t.contentType}))},t}(l.a),S=r("9r0m"),O=r("tcXs"),C=r("UOiB"),I=r("i8/j"),j=r("sOTk"),P=r("/zIU"),T=r("1z64"),x=r("OTOS"),E=r("uQP8"),F=r("kvLG"),w=function(){function e(e,t,r,n,i,o,s){var c=Object(j.l)(e.getState(),r),l=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:c,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new T.a(e,"ClientApi.XrmFormUIBase.",r,t,l),this._pageId=r,a=e,this._formContext=n,this._entityName=i,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=o}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutor.execute("controls_get",(function(t,r){if(!e._controls){e._controls=new s.a(t);var n=(h=e.pageId,g=e.contextToken,f=e._controls,m=Object(E.b)(a.getState(),h,g),b=Object(x.b)(a.getState(),h),v=S.a.equals(m,b),y=Object(j.l)(a.getState(),h)===P.a.Dialog,_=Object(I.y)(a.getState(),m),O=_&&_.reduce((function(e,t){return e.add(t),e}),new Set),function(e,t){var r=Object(i.s)(a.getState(),{controlName:e,id:h},g),n=Object(i.Rc)(a.getState(),h,r);v&&n&&!y?O&&O.has(r.DataFieldName)&&Object(i.fd)(a.getState(),h,r,g)&&f.add(e,t):f.add(e,t)}),o=e.getFormDescriptor(t,r);if(o){var c={isEventParam:!0,name:"controlName",value:""},l={isEventParam:!0,name:"controlType",value:""};for(var u in r.push(c),r.push(l),o.Controls){var p=o.Controls[u];c.value=u,l.value=p&&p.ClassId?p.ClassId.guid:"";var d=e.xrmControlFactory.createXrmControl(e.contextToken,p,e._formContext,t,r);d&&n(d.getName(),d)}}}var h,g,f,m,b,v,y,_,O;return e._controls}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formSelector",{get:function(){var e=this;return this._clientApiExecutor.execute("formSelector_get",(function(t,r){if(!e._formSelector){var n=e.getFormDescriptor(t,r);n&&(e._formSelector=new e._formSelectorType(a,e._contextToken,n.Id,e._entityName,e._pageId))}return e._formSelector}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(t,r){if(!e._tabs){e._tabs=new s.a(t);var n=e.getFormDescriptor(t,r);if(n){var i=n.Tabs;for(var o in i){var c=new _(a,e._contextToken,i[o].Name,e._pageId,e,e._formContext);e._tabs.add(c.getName(),c)}}}return e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),e.prototype.refreshRibbon=function(e){var t=this;void 0===e&&(e=!1),this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(O.a)(t._pageId,null,e))}))},Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formContext",{get:function(){var e=this;return this._clientApiExecutor.execute("formContext",(function(){return e._formContext}))},enumerable:!1,configurable:!0}),e.prototype.getControls=function(){if(!this._controls&&this.contextToken.contextTokenType===C.a.GridRow){var e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new s.a(e),this._controls}return this.controls},e.prototype.getFormDescriptor=function(e,t){var r=Object(i.fb)(a.getState(),{id:this._pageId},this._contextToken);if(!r){var n="Form descriptor not found";if(Object(o.n)(a.getState(),this._pageId))F.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===C.a.GridRow)F.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;var s=new Error(n);this._clientApiExecutor.reportFailure(e,s,t)}}return r},e}()},"0rak":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,r){return{type:"chart.drilldownparameters.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".updateChartDrillDownParametersAction";try{p.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var g="Updatation of the chart drilldown parameters failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},"19Zc":function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"l",(function(){return f})),r.d(t,"i",(function(){return m})),r.d(t,"m",(function(){return b})),r.d(t,"n",(function(){return v})),r.d(t,"k",(function(){return y})),r.d(t,"h",(function(){return _})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return S}));var n=r("Sscr"),a=r("uO/V"),i=r("WS0f"),o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",p="grid.applyActivityTypeFilterCurrentValue",d="grid.applyAdvancedFindFilter";function h(e,t,r,i){return{type:"grid.applyFilter.async",execute:function(o,s){var c=o.dispatch,l=s.TraceManager.getTracer(a.z),u=a.x+".applyGridFilterAction",p=Object(n.v)(i),d=[];d.push({name:a.n,value:e}),d.push({name:a.e,value:p});try{return l.info("Applying the filter expression to the grid. "),c(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,p)),s.EventManager.ReportComponentSuccess(u,d),Promise.resolve()}catch(e){s.EventManager.ReportComponentFailure(u,Error("Applying the filter expression to the grid failed "),"",d)}}}}function g(e,t,r){var a=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:a}}}var f=function(e,t,r){return h(o,e,t,r)},m=function(e,t,r){return h(s,e,t,r)},b=function(e,t,r){return h(c,e,t,r)},v=function(e,t,r){return h(l,Object(i.a)(e)?e:e.trim(),t,r)},y=function(e,t,r){return h(u,e,t,r)},_=function(e,t,r){return h(p,e,t,r)},S=function(e,t,r){return h(d,e,t,r)}},"1PXy":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("YCDx"),c=r("PZxu"),l=r("ildB"),u=r("3OsR"),p=r("+Z9T"),d=r("ME4N"),h=r("IiPO"),g=r("7bez"),f=r("h82J"),m=r("Sscr"),b=r("ezfI"),v=r("gBKR"),y=r("9r0m"),_="ClientApi.XrmControlTimeline.",S=function(e){function t(t,r,a,o,s,c,l,u){var p=e.call(this,t,r,a,o,s,l)||this;return p._defaultLabel=d.u.Timeline,n=t,p._applicationContext=u,p._controlId=c,p._traceManager=u.TraceManager,p._subgridToken=Object(m.p)(r,s),p._clientApiExecutorTimeline=new i.a(t,_,a,r),p._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:s,isEventParam:!0,expectedDataType:"string"}),p._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:c,isEventParam:!0,expectedDataType:"string"}),p._gridControl=new g.a(t,p._subgridToken,a,!1,3,!0,u,s),t.dispatch(Object(f.a)(p,a,p._subgridToken)),p}return Object(a.__extends)(t,e),t.prototype.getControlType=function(){return b.a.instance.reportUsage(_+"getControlType"),"timelinewall"},t.prototype.getName=function(){var e=this;return this.clientApiExecutor.execute("getName",(function(){return e.controlDescriptor&&e.controlDescriptor.Parameters&&e.controlDescriptor.Parameters[d.s.UClientUniqueName]?e.controlDescriptor.Parameters[d.s.UClientUniqueName]:d.u.Timeline}))},t.prototype.getLabel=function(){var e=_+"getLabel";try{b.a.instance.reportCall(e);var t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(p.a)(this.controlDescriptor.Parameters[d.s.Label])?this.controlDescriptor.Parameters[d.s.Label]:this._defaultLabel?this._defaultLabel:"";return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(t){var r=_+"setLabel";try{b.a.instance.reportCall(r),e.prototype.setLabel.call(this,t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[d.s.Label]=t:this._defaultLabel=t,b.a.instance.reportSuccess(r)}catch(e){var n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.openEmail=function(e){var t=_+"openEmail";try{b.a.instance.reportCall(t),n.dispatch(Object(l.t)(this._controlId,e)),n.dispatch(Object(l.o)(this._controlId,u.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.refresh=function(e){var t=_+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{b.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[d.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[d.s.UClientActivities]=e.activities)),n.dispatch(Object(l.o)(this._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setTargetEntity=function(e,t,r){var a=this;void 0===r&&(r=!0);var i=_+"setTargetEntity";try{b.a.instance.reportCall(i);var o={etn:e,id:t,isAPI:!0},s={};return s[e]=[],n.dispatch(Object(l.v)(this._controlId,o)),n.dispatch(Object(v.e)(s)).catch((function(t){var r=h.a.getInstance().getEventParameters(a.contextToken);throw r.push({name:"controlName",value:a.getName()}),r.push({name:"entityName",value:e}),h.a.getInstance().reportFailure(i+"-retrieveEntities",t,null,r),t})).then((function(){r&&n.dispatch(Object(l.o)(a._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(i)}))}catch(e){var c=h.a.getInstance().getEventParameters(this.contextToken);throw c.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(i,e,null,c),e}},t.prototype.getGrid=function(){var e=_+"getGrid";try{return b.a.instance.reportCall(e),this._grid||(this._grid=new c.a(n,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return b.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{b.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getEntityName=function(){return b.a.instance.reportUsage(_+"getEntityName"),"activitypointer"},t.prototype.getUrl=function(){var e=h.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""},t.prototype.getFilterXml=function(){var e=_+"getFilterXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getFetchXml=function(){var e=_+"getFetchXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getViewSelector=function(){var e=_+"getViewSelector",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.getTeamTemplateId=function(){return null},t.prototype.getRelationship=function(){var e=_+"getRelationship",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.setFilterXml=function(e){var t=_+"setFilterXml",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.addOnLoad=function(e){var t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")},t.prototype.removeOnLoad=function(e){var t=_+"removeOnLoad",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.openRelatedGrid=function(){var e=_+"openRelatedGrid",t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e)},t}(s.a)},"2ojE":function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return h})),r.d(t,"b",(function(){return g}));var n=r("VcAV"),a=r("/j9Z"),i=r("yHpA"),o=r("LhJP"),s=r("9r0m"),c=r("TCcM"),l=r("T576"),u=r("sOTk"),p=r("WS0f");function d(e,t,r,n){var a=[];try{var i=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,o=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,p=i&&!s.a.equals(i,s.a.EMPTY)?function(e,t){var r=Object(l.a)(e,t);if(r)return r.businessProcessFlowProcessState;return null}(e,i):0,d=Object(u.l)(e,r),h={name:"ProcessId",value:i?s.a.toString(i):s.a.EMPTYGUIDSTRING},g={name:"ProcessInstanceId",value:o?s.a.toString(o):s.a.EMPTYGUIDSTRING},f={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},m={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},b={name:"ProcessState",value:p},v={name:"PageId",value:r||""},y={name:"PageType",value:d};a.push(h),a.push(g),a.push(f),a.push(m),a.push(b),a.push(v),a.push(y)}catch(e){n.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,a)}return a}function h(e,t,r){r.EventManager.ReportComponentSuccess(e,t)}function g(e,t,r,s,c,l,u){!function(e,t){if(!Object(n.c)(e)){var r=Object(a.c)(e);if(!Object(n.c)(r)){var i=r.errorCode;if(!Object(n.c)(i)){var o={name:"ErrorCode",value:"0x"+i.toString(16)};t.push(o)}}}}(t,s),function(e,t,r,s){if(!Object(n.c)(e)){var c=Object(a.c)(e);if(!Object(n.c)(c)&&!Object(n.c)(c.FaultedSnapshotId)){var l={name:o.p,value:c.FaultedSnapshotId};if(t.push(l),!Object(n.c)(r)&&!Object(n.c)(s)){var u=Object(i.c)(s,r);if(!Object(n.c)(u)){var d=u.snapshotId;if(!Object(n.c)(d)&&!Object(p.b)(d)&&d===c.FaultedSnapshotId){var h={name:o.q,value:"serverSideCurrentForm"};t.push(h)}}}}}}(t,s,l,u),c.EventManager.ReportComponentFailure(e,t,r,s)}},"3INI":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._traversedPath},set:function(e){for(this._traversedPath=Object(n.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(n.a)(this._traversedPath)},enumerable:!1,configurable:!0}),e.getCandidateTraversedPathFromStagStep=function(e,t){t=Object(n.a)(t);var r=!1;if(!e||e.length)return null;for(var a=0;a<e.length;a++){var i=Object(n.a)(e[a].get_stageId());if("".concat(i,","),t===i){r=!0;break}}return r?"".substring(0,"".length-2):null},e.prototype.isInTraversedPath=function(e){return!Object(a.b)(e)&&this._traversedPath.indexOf(Object(n.a)(e))>-1},e}()},"4HtA":function(e,t,r){"use strict";r.d(t,"a",(function(){return ct}));var n,a=r("c/eZ"),i=r("DRVD"),o=r.n(i),s=r("sOTk"),c=r("r0tX"),l=r("6FBX"),u=r("UGbr"),p=r("UTiY"),d=r("c3W+"),h=r("EGdP"),g=r("/j9Z"),f=r("9r0m"),m=r("T576"),b=r("Y70o");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(n||(n={}));var v=function(){function e(e,t){this._getState=e,this._processId=t}return e.prototype.GenerateMessageForAction=function(e){var t="",r="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(b.a)(a,r,"Crm_GenericErrorMessage");switch(e){case n.Completed:t=String.format(i,(new Date).toLocaleString());break;case n.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t},e.prototype.GetActionMetadata=function(e){var t,r=Object(m.a)(this._getState(),new f.a(this._processId.guid));return r&&r.businessProcessFlowActions&&r.businessProcessFlowActions[e]&&(t=r.businessProcessFlowActions[e]),t},e.prototype.InvokeProcessAction=function(e,t,r){return Xrm.Utility.invokeProcessActionInternal(e,r,t)},e}(),y=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if(!e)return null;var t=function(e){var t=[];return e.forEach((function(e){var r={id:f.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(r)})),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function S(e,t,r,n){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:function(a,i){a.dispatch,a.getState;return function(e,t,r,n,a){return e.retrieveNavigationEntities(t,r,n,a,null).nativePromise().then(_,g.b)}(i.DataSource,e,t,r,n)}}}var O=r("mLFd"),C=r("GWjq"),I=r("phfH"),j=function(){function e(e,t){this.Target=e,this.NewProcess=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),P=function(){function e(e,t,r){this.Target=e,this.NewProcess=t,this.NewProcessInstance=r}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),T=r("RVz9"),x=r("IBKq");function E(e,t,r,n,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:function(o,s){o.dispatch,o.getState;return function(e,t,r,n,a,i,o){var s=new x.a(f.a.toLegacyGuid(t.id),t.etn,f.a.toLegacyGuid(r.id),r.etn,f.a.toLegacyGuid(n),a,f.a.toLegacyGuid(i),f.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(s.DataSource,e,t,r,n,a,i)}}}var F=r("Ia1G"),w=function(){function e(e,t){this.EntityId=e,this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}},e}();var N=function(){function e(e,t){this.EntityLogicalName=e,this.AppModuleId=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}},e}(),A=r("4tno");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k,M=function(){function e(e,t,r){this._name=e,this._uniqueName=t,this._workflowId=r}return Object.defineProperty(e.prototype,"workflowId",{get:function(){return this._workflowId},set:function(e){this._workflowId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueName",{get:function(){return this._uniqueName},set:function(e){this._uniqueName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),e}(),D=r("9rlF"),R=function(){function e(){}return Object.defineProperty(e.prototype,"activeStageId",{get:function(){return this._activeStageId},set:function(e){this._activeStageId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceId",{get:function(){return this._businessProcessInstanceId},set:function(e){this._businessProcessInstanceId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceName",{get:function(){return this._businessProcessInstanceName},set:function(e){this._businessProcessInstanceName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessState",{get:function(){return this._businessProcessState},set:function(e){this._businessProcessState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessStatus",{get:function(){return this._businessProcessStatus},set:function(e){this._businessProcessStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},set:function(e){this._navigationEntities=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpfDefinitionVersionNumber",{get:function(){return this._bpfDefinitionVersionNumber},set:function(e){this._bpfDefinitionVersionNumber=e},enumerable:!1,configurable:!0}),e}(),L=r("3INI"),B=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryField",{get:function(){return this._primaryField},set:function(e){this._primaryField=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityTypeCode",{get:function(){return this._entityTypeCode},set:function(e){this._entityTypeCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityLogicalName",{get:function(){return this._entityLogicalName},set:function(e){this._entityLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyName",{get:function(){return this._primaryKeyName},set:function(e){this._primaryKeyName=e},enumerable:!1,configurable:!0}),e}(),V=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(k||(k={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var G,z=function(){function e(e){this._stageManager=e,this._populateTraversedPath()}return e.prototype.getTraversedPath=function(){return this._traversedPath},e.prototype._populateTraversedPath=function(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path},e}(),W=r("7kKV"),q=r("AqA3"),U=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.invalid,n.stageInvalidReason=q.a.invalid,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),X=(function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.crossEntity,n.stageInvalidReason=q.a.crossEntity,Object.setPrototypeOf(n,t.prototype),n}Object(a.__extends)(t,e)}(Error),function(e){function t(r){var n=e.call(this,r)||this;return n.stageInvalidReason=q.a.unreachable,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error)),H=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.dirtyForm,n.stageInvalidReason=q.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),K=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.end,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Q=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.beginning,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Y=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.stageGate,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),J=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.invalidProcess,n.stageInvalidReason=q.a.invalidProcess,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Z=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=W.a.dirtyForm,n.stageInvalidReason=q.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),$=r("QAhb"),ee=r("TVue"),te=r("rQCE"),re=r("lFQy"),ne=r("Jcuz"),ae=r("690X"),ie=r("eA/s"),oe=r("jJRu"),se=r("g9bv"),ce=r("r454"),le=r("OROb"),ue=r("qYad"),pe=r("TCcM"),de=r("cAHA"),he=r("Sscr"),ge=r("yHpA"),fe=r("LteD"),me=r("BFwB"),be=function(e){function t(t,r,n){var a=e.call(this,"BusinessProcessFlow_"+t)||this;return a.addEventParameter("ProcessId",r),a.addEventParameter("ProcessInstanceId",n),a}return Object(a.__extends)(t,e),t}(me.a),ve=function(e){function t(t,r){return e.call(this,"Initialized",t,r)||this}return Object(a.__extends)(t,e),t}(be),ye=function(e){function t(t,r,n){var a=e.call(this,"SetActiveStageEvent",t,r)||this;return a.addEventParameter("ActiveStageId",n),a}return Object(a.__extends)(t,e),t}(be),_e=function(e){function t(t,r,n){var a=e.call(this,"DisplayStateEvent",t,r)||this;return a.addEventParameter("CurrentDisplayState",n),a}return Object(a.__extends)(t,e),t}(be),Se=function(e){function t(t,r,n,a){var i=e.call(this,"StatusEvent",t,r)||this;return i.addEventParameter("ProcessStatus",n),i.addEventParameter("CurrentDisplayState",a),i}return Object(a.__extends)(t,e),t}(be),Oe=r("txwV"),Ce=r("WS0f"),Ie=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}},e}(),je=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Pe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}},e}(),Te=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}},e}(),xe=r("K1ho"),Ee=r("ObKm"),Fe=r("uwKl"),we=r("ed60");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(G||(G={}));var Ne=r("2ojE"),Ae=r("LhJP"),ke=r("lMVv"),Me=r("GHPx"),De=r("h82J"),Re=r("VcAV"),Le=function(){function e(e,t){this._getState=e,this._applicationContext=t}return e.prototype.setBpfInstance=function(e){return this._processInstance=e,this},e.prototype.setBpfInstanceName=function(e){return this._processInstanceName=e,this},e.prototype.setProcess=function(e){return this._process=e,this},e.prototype.setProcessId=function(e){return this._processId=e,this},e.prototype.setFormEntity=function(e){return this._formEntity=e,this},e.prototype.GetFlowStepMetadata=function(e,t){var r=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),n=this._processId&&this._processId.guid||null,a=Object(m.a)(this._getState(),f.a.tryParse(n));if(Object(Re.c)(a))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;var i=a.businessProcessFlowFlows;if(Object(Re.c)(i))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;var o=i[e];return Object(Re.c)(i)?(r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o},e.prototype.openFlowWidget=function(e,t){if(f.a.tryParse(e.flowStepId)===f.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);var r=this._populateFlowDialogParams(e,t),n={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",n,r)},e.prototype._populateFlowDialogParams=function(t,r){var n=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Re.c)(n))throw new Error("BPF Flow Step Failure: null metadata");var a={},i=n.flowId;if(Object(Re.c)(i))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){var o=[];o.push(this._processInstance.id.guid);var s=JSON.stringify(o);a.entity_ids=s}a.flow_id=i,a.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),a.bpf_step_id=t.flowStepId;var c=Xrm.Page.data.entity.getEntityName(),l=this._getState().metadata.entities[c].EntitySetName,u=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");a.entity_logical_collection_name=l,a.entity_logical_name=c,a.flows_destination_url=u,a.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");var p=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");a.flows_fpi_site_url=p+"&flowsEnableWidgetV2=true",a.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),a.flows_enable_widget_v2=!0,e.UpdateEventParameter(r,"flows_destination_url",u),e.UpdateEventParameter(r,"flow_id",i),Object(Re.c)(t.workflowLogId)||t.workflowLogId===f.a.EMPTY||(a.flows_wflog_id=f.a.toString(t.workflowLogId));var d=this._processInstance&&this._processInstance.id;if(Object(Re.c)(d)||d===f.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+d);a.bpf_instance_id=f.a.toString(d);var h=this._processInstance&&this._processInstance.etn;if(Object(Ce.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+h);a.bpf_instance_entity_name=h;var g=this._processId&&this._processId.guid||null;if(f.a.tryParse(g)===f.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+g);a.bpf_definition_id=g,a.bpf_definition_entity_name="workflow";var m=this._process&&this._process.get_Name();if(Object(Ce.b)(m))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+m);if(a.bpf_definition_name=m,Object(Ce.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);a.bpf_instance_name=this._processInstanceName;var b=t.selectedStage&&t.selectedStage.get_Description();if(Object(Ce.b)(b))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+b);a.bpf_flowstage_localized_name=b,a.bpf_flowstage_entity_name=c,a.bpf_flowstage_entity_collection_name=l;var v=this._formEntity&&this._formEntity.id;if(Object(Re.c)(v)||v===f.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+v);a.bpf_flowstage_entity_record_id=f.a.toString(v);var y=f.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Re.c)(y)||y===f.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+y);a.bpf_activestage_id=f.a.toString(y);var _=t.activeStage&&t.activeStage.get_Description();if(Object(Ce.b)(_))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+_);return a.bpf_activestage_localized_name=_,a.bpf_activestageentity_name="processstage",a},e.prototype._getLocalizedLabel=function(e){return Xrm.Utility.getResourceString("Main_system_library",e)},e.getTelemetryParamsForFlowStep=function(e,t,r,n,a){var i=a||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:r},l={name:"bpf_step_id",value:n};return i.push(o),i.push(s),i.push(c),i.push(l),i},e.UpdateEventParameter=function(e,t,r){e&&0!==e.length&&e.some((function(e){if(e.name===t)return e.value=r,!0}))},e}(),Be=r("qC0c"),Ve=r("pflg"),Ge=r("UWFM"),ze=r("b1hT"),We=r("tvev"),qe=r("RK8T"),Ue=r("xc1f"),Xe=r("yZTI"),He=r("UVKb"),Ke=r("j+yI"),Qe=r("OTOS"),Ye=r("uQP8"),Je=r("lKeh"),Ze=r("IQF2"),$e=r("buKK"),et=r("+D0h"),tt=r("YEEA"),rt=r("2nMH"),nt=o.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),at=o.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),it=o.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ot=o.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=o.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager"),ct=function(){function e(e,t,r,n,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=r,this._stageMetadata=n,this._activeStageManager=a}return e.prototype.initilaizeWithProcessAndFormEntity=function(e,t,r,n,a,i){var o=this,s=nt.startStopwatch({processId:f.a.toString(n),processInstanceId:f.a.toString(a.id)});this._currentPageId=i,this._processId=n,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=r,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);var c=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(c),this._stageMetadata.initializeDefaultPathManager(new z(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;var l={};if(this._isUserSelectedStage)l.selectedStageId=f.a.tryParseOrNull(this.getSelectedStageId());else{var u=this.getActiveStageId();this._isActiveStageInCurrentEntity(u)?l.selectedStageId=f.a.tryParseOrNull(u):l.selectedStageId=this._getDefaultSelectedStageId()||f.a.tryParseOrNull(u)}this._dispatch(Object(re.a)(l,this._currentBpfInstance));var p=new ve(f.a.toString(n),f.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(p),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then((function(e){e&&e.getEventManager().addOnProcessChangeEvent(o.getContextToken(),(function(){o._saveCrossEntityBpf()}))}))),Object(ze.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new v(this._getState,n),this._flowStepManager=new Le(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(m.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(ze.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var d=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ae.g).error("ProcessManager is initialized with current entity as null",d);Object(Ne.c)(Ae.g,d,this._applicationContext),s()},e.prototype._saveCrossEntityBpf=function(){var e=this._getState(),t=Object(s.g)(e,this._currentPageId),r=Object(Ve.a)(t),n=Object(Ve.b)(t);if(r&&n){var a=new $.a(t.data.parentrecordtype,new f.a(t.data.parentrecordid)),i=new $.a(t.entityTypeName,t.id);this._dispatch(Object(Fe.b)(r,i)),this._dispatch(Object(we.b)(n,i)),this.navigateToNextEntityForCrossEntityBpf(a,i,r,n)}},e.prototype.initilaizeWithFormEntityOnly=function(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(ze.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(ze.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var r=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ae.f).error("ProcessManager is initialized with current entity as null",r);Object(Ne.c)(Ae.f,r,this._applicationContext)},e.prototype.setActiveProcess=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(Ne.b)(Ae.m,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=f.a.tryParseOrNull(e);if(!o)return Object(Ne.c)(Ae.m,a,t._applicationContext),void n(new Error("Invalid process id"));if(f.a.isNullOrEmpty(t.getCurrentFormEntity().id))return Object(Ne.c)(Ae.m,a,t._applicationContext),void n(new g.a("Not supported on new records",2147877748));var s=new j({id:f.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:f.a.toString(o),entityType:l.fc});t._dispatch(Object(T.b)(s)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcess"),Object(Ne.c)(Ae.m,a,t._applicationContext),r()}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)})),Object(Ne.b)(Ae.m,e,null,a,t._applicationContext,null,t._getState())}))}))},e.prototype.setActiveProcessInstance=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(Ne.b)(Ae.n,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=f.a.tryParseOrNull(e);o?t.getProcessInstances().then((function(e){if(e&&e.value){for(var a="",i=0,s=e.value;i<s.length;i++){var c=s[i];if(c&&c.businessprocessflowinstanceid&&c.businessprocessflowinstanceid.toLowerCase()===f.a.toString(o).toLowerCase()){a=c["a_processid_value".substring(1)];break}}if(Object(Ce.b)(a))n(new g.a("Supplied process instance does not match any existing instance on this entity",2147877744));else{var u=f.a.tryParseOrNull(a);if(u){var d=new P({id:f.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:f.a.toString(u),entityType:l.fc},{id:f.a.toString(o),entityType:l.fc});t._dispatch(Object(T.b)(d)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcessInstance"),r(a)}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)}))}))}else n(new Error("Invalid process id"))}}else n(new Error("No process instances found for current entity"))}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)}))})):n(new Error("Invalid process instance id"))}))},e.prototype.setCurrentInstance=function(e){this._currentBpfInstance=e},e.prototype.setStatus=function(e){var t=this;return new Promise((function(r,n){var a;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===V.a.Active)a=t.reactivateProcess();else if(e===V.a.Finished)a=t.completeProcess();else{if(e!==V.a.Aborted)return n(new Error("Invalid status passed to setStatus"));a=t.abandonProcess()}a.then((function(){var n=new Se(f.a.toString(t._processId),f.a.toString(t.getProcessInstanceId()),e,t.getDisplayState());t._applicationContext.EventManager.ReportEvent(n),r()}),(function(e){n(e)}))}))},e.prototype.setVisible=function(e){if(!(Object(Ce.a)(this._currentBpfInstance)||Object(Ce.a)(this._currentFormEntity)||Object(Ce.a)(this._currentFormEntity.etn))){var t=Object(he.h)(this._currentFormEntity.etn);this._dispatch(Object(fe.b)(this._currentPageId,Oe.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}},e.prototype.isVisible=function(){if(!this._currentBpfInstance)return!1;var e=Object(he.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:Oe.a},e)},e.prototype.getCurrentFormEntity=function(){return this._currentFormEntity},e.prototype.getActiveStageEntityRef=function(){var e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,r=this._getNavigationEntityIdsByEntityLogicalName();return t&&r&&r.hasOwnProperty(t)?new $.a(t,r[t]):null},e.prototype.getProcess=function(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()},e.prototype.getProcessInstanceName=function(){return this._currentBpfInstance&&Object(C.e)(this._getState(),this._currentBpfInstance)},e.prototype.getTraversedPath=function(){return Object(C.h)(this._getState(),this._currentBpfInstance)},e.prototype.getProcessId=function(){return this._processId},e.prototype.getVersion=function(){return this._version},e.prototype.getProcessInstanceId=function(){return this._currentBpfInstance&&this._currentBpfInstance.id},e.prototype.getBpfEntityLogicalName=function(){return this._currentBpfInstance&&this._currentBpfInstance.etn},e.prototype.getEntityStages=function(){return this._stageMetadata.getEntityStages()},e.prototype.getActiveStage=function(){return this._getStage(this.getActiveStageId())},e.prototype.getProcessInstances=function(){var e=this;return new Promise((function(t,r){var n,a;e._dispatch((n=e._currentFormEntity.id,a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute:function(e,t){e.dispatch;var r=e.getState,i=t.DataSource.get_WebAPIService(),o=new w(n,a),s=Object(F.a)(r(),o);return i.sendRequest(s).then((function(e){return e.json()}),g.b)}})).then((function(e){t(e)}),(function(e){r(e)}))}))},e.prototype.getSelectedStage=function(){return this._getStage(this.getSelectedStageId())},e.prototype.isCrossEntityNavigation=function(e){var t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;var r=this._stageMetadata.getStage(t);if(!r)return!1;var n=r.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&n&&n.get_EntityLogicalName()!==this._currentFormEntity.etn},e.prototype._isStageOnPath=function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(f.a.equals(a,e))return!0}return!1},e.prototype.getProcessState=function(){var e=Object(m.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null},e.prototype.getState=function(){if(this._currentBpfInstance){var e=Object(C.f)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getStatusName=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e)return e.label}return null},e.prototype.getStatus=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getActiveStageId=function(){if(this._currentBpfInstance){var e=this._currentBpfInstance&&Object(C.a)(this._getState(),this._currentBpfInstance);if(f.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){var t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=f.a.tryParseOrNull(t))}if(!f.a.isNullOrEmpty(e)){var r=this.getActivePath();if(r&&r.length>0)return this._isStageOnPath(e,r)?e.guid:r[0].guid}}return null},e.prototype.getActivePathStages=function(){var e=this.getActivePath();if(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=this._getStage(e[r].guid);return t}return null},e.prototype.getActivePath=function(){if(!this._currentBpfInstance)return null;var e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e},e.prototype.getDisplayState=function(){return this._currentBpfInstance?Object(I.d)(this._getState())||c.a.getDefaultDisplayState():null},e.prototype.getSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()},e.prototype._getDefaultSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),f.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e},e.prototype._isActiveStageInCurrentEntity=function(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0},e.prototype.getStageMetadata=function(){return this._stageMetadata},e.prototype.isBusinessProcessAborted=function(){return this.getStatus()===V.a.Aborted},e.prototype.isBusinessProcessCompleted=function(){return this.getStatus()===V.a.Finished},e.prototype.moveToNextStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getNextStageId(e.getActiveStageId());if(n){t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._saveFormDataAndActiveStage(f.a.tryParseOrNull(n),0,"MoveToNextStage")})))}else r(new K("Last stage in the active path reached. Next stage does not exist."))}));return r.then((function(){Object(Ne.c)(Ae.h,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.h,t,e._applicationContext):Object(Ne.b)(Ae.h,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.moveToPreviousStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getPreviousStageId(e.getActiveStageId());if(!n)return r(new Q("The first stage in the traversed path reached. Previous stage does not exist."));t(e._saveFormDataAndActiveStage(f.a.tryParseOrNull(n),1,"MoveToPreviousStage"))})).then((function(){e._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e.getActiveStageId())}));return r.then((function(){Object(Ne.c)(Ae.i,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.i,t,e._applicationContext):Object(Ne.b)(Ae.i,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.setActiveStage=function(e){var t=this,r=at.startStopwatch({processId:f.a.toString(this.getProcessId()),processInstanceId:f.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),a=new Promise((function(r,n){var a=f.a.tryParseOrNull(e),i=t.getTraversedPath();if(Object(Ce.a)(t._currentBpfInstance))return n(new g.a("Process Control does not exist on form.",2147877746));if(!a)return n(new U("setActiveStage can only be called with a valid stage id"));if(!t._stageMetadata.getStage(a.guid))return n(new U("stage id does not exist on any path of the instance"));if(!i)return n(new U("Traversed Path is not present"));if(t.getActiveStageId()===a.guid)return r();var o=new L.a(i);if(!o||!o.isInTraversedPath(e))return n(t.getActivePath().some((function(e){return f.a.equals(e,a)}))?new U("The stage is not in traversed path. Only navigating backwards is supported."):new X("stage id does not exist on the current acitve path of the instance."));r(t._saveFormDataAndActiveStage(a,1,"SetActiveStage"))})).then((function(){var r=new ye(f.a.toString(t._processId),f.a.toString(t.getProcessInstanceId()),e);t._applicationContext.EventManager.ReportEvent(r),t._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)}));return a.then((function(){r(),Object(Ne.c)(Ae.o,n,t._applicationContext)}),(function(e){r(),t._shouldReportErrorAsSuccess(e)?Object(Ne.c)(Ae.o,n,t._applicationContext):Object(Ne.b)(Ae.o,e,null,n,t._applicationContext,t.getCurrentFormEntity(),t._getState())})),a},e.prototype.switchProcess=function(){},e.prototype.abandonProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessAborted()?t():void t(e._updateStateAndStatusOfProcess(V.a.Aborted,k.Inactive,"AbandonProcess"))}));return r.then((function(){Object(Ne.c)(Ae.a,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.a,t,e._applicationContext):Object(Ne.b)(Ae.a,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.reactivateProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.getStatus()===V.a.Active?t():void t(e._updateStateAndStatusOfProcess(V.a.Active,k.Active,"ReactivateProcess"))}));return r.then((function(){Object(Ne.c)(Ae.j,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.j,t,e._applicationContext):Object(Ne.b)(Ae.j,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.completeProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessCompleted()?t():f.a.tryParseOrNull(e._stageMetadata.getNextStageId(e.getActiveStageId()))?r(new g.a("Attempt to finish a process not on last stage.",2148081666)):void t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._updateStateAndStatusOfProcess(V.a.Finished,k.Inactive,"CompleteProcess")})))}));return r.then((function(){Object(Ne.c)(Ae.c,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ne.c)(Ae.c,t,e._applicationContext):Object(Ne.b)(Ae.c,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype._shouldReportErrorAsSuccess=function(e){return e instanceof J||(e instanceof Y||(e instanceof K||(e instanceof Q||(e instanceof U||(e instanceof X||e instanceof Z)))))},e.prototype.triggerActionStepClick=function(e){var t=this;if(Object(Ce.b)(e)){var r=new Error("BPF Action Step Failure: null ControlId");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var n=this._actionStepManager.GetActionMetadata(e);if(Object(Ce.a)(n)){r=new Error("BPF Action Step Failure: null metadata");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var a=this._getState();if(Object(Ce.a)(a)){r=new Error("BPF Action Step Failure: null state");throw Object(Ne.b)(Ae.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var i=this._getTelemetryParamsForActionStep(n.actionType,e,n.actionId);try{var o=new f.a(n.actionId);if(n.actionType===G.AsyncWorkflow||n.actionType===G.SyncWorkflow){var s=[this._processId.guid,f.a.toString(this.getProcessInstanceId()),o.guid].map((function(e){var t=new je;return t.Type="System.String",t.Value=e,t})),c=new Pe;c.Keys=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],c.Values=s,c.Count=3,c.IsReadOnly=!0;var l=new Te;l.Arguments=c;var u=new Ie;u.EntityId=this._currentFormEntity.id,u.InputArguments=l,u.entity={id:n.workflowId,entityType:"workflow"},this.UpdateActionLog(o,1),this._dispatch(Object(T.b)(u)).then((function(){Object(xe.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2)),Object(Ne.c)(Ae.b,i,t._applicationContext)}),(function(r){Object(xe.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ne.b)(Ae.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(p.b)(r,!0)).then()}))}else if(n.actionType===G.ProcessAction){var d=function(r){Object(xe.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ne.b)(Ae.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(p.b)(r,!0)).then()},h=function(r){Object(xe.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2));var a=r.get_outputParameters();n.outputBindings.forEach((function(e){if(e.parameterName in a){var r=a[e.parameterName],n=e.boundAttributeName,i={};i[n]={key:n,value:r},t._dispatch(Object(Ee.a)(t._currentPageId,i,!1,!0,t._currentFormEntity.etn,t._currentFormEntity.id.guid,null,t.getContextToken()))}})),Object(Ne.c)(Ae.b,i,t._applicationContext)},g={};n.inputBindings.forEach((function(e){var r=Object(D.c)(Object(pe.j)(t._getState(),t.getCurrentFormEntity(),e.boundAttributeName));g["ProcessUnification_Arguments_"+e.parameterName]=r})),this._addInputParametersToParamList(n.inputParameters,g),this.UpdateActionLog(o,1),Xrm.Navigation.openDialog(n.workflowId,this._getDialogOptions(),g).then((function(r){if(r=r?r.parameters:{},t._filterInputArguments(r)){var a={id:f.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn};r.Target=a,r.BusinessProcessFlowId=t._processId.guid,r.BusinessProcessFlowInstanceId=f.a.toString(t.getProcessInstanceId()),r.ActionStepId=n.actionId,t._actionStepManager.InvokeProcessAction(n.uniqueName,n,r).then(h,d)}else Object(xe.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3))}),d)}}catch(e){throw 0===i.length&&(i=this.getTelemetryParams()),Object(Ne.b)(Ae.b,e,null,i,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}},e.prototype.triggerFlowStepClick=function(e,t){t=t;var r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{var n=f.a.newGuid(),a={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:n};this._flowStepManager.openFlowWidget(a,r),this.UpdateActionLog(new f.a(e),1,void 0,n);var i=this.getActionLog(new f.a(e));this.createWorkflowLogRecord(i),Object(Ne.c)(Ae.d,r,this._applicationContext)}catch(e){Object(Ne.b)(Ae.d,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}},e.prototype.refreshFlowStepClick=function(e){var t=this,r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(He.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then((function(){t._updateProcessInstanceModifiedTime(),Object(Ne.c)(Ae.k,r,t._applicationContext)})).catch((function(e){Object(Ne.b)(Ae.k,e,null,r,t._applicationContext,t.getCurrentFormEntity(),t._getState())}))},e.prototype._addInputParametersToParamList=function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];"ProcessUnification_Arguments_"+e[a].parameterName in t||(t["ProcessUnification_Arguments_"+e[a].parameterName]=null)}},e.prototype._filterInputArguments=function(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){for(var t in e){var r=e[t];if(t.startsWith("ProcessUnification_Arguments_"))e[t.substring("ProcessUnification_Arguments_".length,t.length)]=r;delete e[t]}return!0}return!1},e.prototype._getDialogOptions=function(){return{height:450,width:450,position:1}},e.prototype._createSnapshotRequest=function(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");var r=new $.a("processstage",e),n=this._calculateNewTraversedPath(e),a={activestageid:{reference:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,t)},e.prototype._addFieldsToBPFSnapshotForCreate=function(e,t){if(!e||!this._hasBpfInstance())return e;var r=Object(Ke.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return r&&(e[r.ReferencingAttribute]={reference:new $.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new $.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e},e.prototype.generateBPFInstanceSnapshotId=function(){if(this.isImmersiveBPF()||!Object(Be.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;var e=[],t=null;try{var r=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),n=Object(ge.b)(this._getState(),r),a=n.identifier&&n.identifier.id||this._currentFormEntity.id,i=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ke.e)(i))return Object(Ke.f)(this._getState(),r,a,this._dispatch),null;if(!this._hasBpfInstance()||f.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Ke.d)(this._getState(),n.identifier,this._currentPageId))return Object(Ke.f)(this._getState(),r,a,this._dispatch),null;f.a.isNullOrEmpty(a)&&(a=f.a.newGuid(),Object(Ke.f)(this._getState(),r,a,this._dispatch)),t=this._createActiveStageSnapshot(f.a.tryParse(this.getActiveStageId()),a);var o=Object(ge.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map((function(e){return"Property: "+e})).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t},e.prototype._calculateNewTraversedPath=function(e){for(var t="",r=0,n=this.getActivePath();r<n.length;r++){var a=n[r];if(t+=","+a.guid,f.a.equals(a,e))return t.substring(1)}return(t+=","+e.guid).substring(1)},e.prototype._createActiveStageSnapshot=function(e,t){var r=this._createSnapshotRequest(e,t),n=ot.startStopwatch({processId:f.a.toString(this.getProcessId()),processInstanceId:f.a.toString(this.getProcessInstanceId())}),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Ce.a)(a)){var i=Object(se.b)(this._getState(),a.snapshotId,r);return this._dispatch(i),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n(),a.snapshotId}var o=Object(he.h)(this._currentFormEntity.etn),s=Object(he.x)(o),c=Object(oe.b)(this._getState(),this._currentBpfInstance,r,s,this._hasBpfInstance()?de.a.Create:de.a.Update),l=c.payload.snapshotId;return this._dispatch(c),n(),l},e.prototype._hasBpfInstance=function(){return!this._currentBpfInstance||f.a.isNullOrEmpty(this._currentBpfInstance.id)},e.prototype._updateStateAndStatusOfProcess=function(e,t,r){var n=this;return new Promise((function(a,i){var o=n._createStatusAndStateUpdateRequest(e,t),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity()),c=null;if(n.isImmersiveBPF()&&!Object(Ce.a)(s)){var l=Object(se.b)(n._getState(),s.snapshotId,o);n._dispatch(l),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity())}else{var u=Object(he.h)(n.getCurrentFormEntity().etn),d=Object(he.x)(u),h=Object(oe.b)(n._getState(),n._currentBpfInstance,o,d);c=h.payload.snapshotId,n._dispatch(h)}if(!n.executePreEvent("runOnPreProcessStatusChange",r,null,e))if(n._shouldPerformFormSave()){var f=n._validateSnapshot(s).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return n._saveFormEntityAndBPFEntitySnapshots(c,s,!1)})).then((function(){n._executePostEvent("runOnProcessStatusChange",r,null,e)})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,c)})).catch((function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e})).catch((function(e){n._dispatch(Object(p.b)(e,!0)).then((function(){return i(e)}))}));a(f)}else n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){var t=null;t=n.isImmersiveBPF()&&!Object(Ce.a)(s)?s.snapshotId:c;n._dispatch(Object(le.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh())).then((function(){n._updateProcessInstanceModifiedTime(),n._executePostEvent("runOnProcessStatusChange",r,null,e)})),a()})).catch((function(e){n._dispatch(Object(p.b)(e,!0)).then((function(){return i(e)}))}))}));a()}))},e.prototype._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures=function(e){var t=this;return new Promise((function(r,n){if("CompleteProcess"===e||"MoveToNextStage"===e){var a=t.ValidateRequiredFieldsForNavigation();if(a&&!a.isValid)if("MoveToNextStage"===e)n(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new Y("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return r()}))},e.prototype._saveFormChangesBeforeNavigation=function(){var e=this;if(this._shouldPerformFormSave()){var t=Object(ge.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then((function(){return e._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")})).then((function(){var r=e._getColumnsToRefresh();return e._dispatch(Object(le.c)(t.snapshotId,!0,r))})).catch((function(r){return e._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(r,t.snapshotId),e._dispatch(Object(p.b)(r,!0))}))}return Promise.resolve()},e.prototype._shouldPerformFormSave=function(){var e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),r=this._getState();if(Object(y.kb)(r,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;var n=this._dispatch(Object(De.b)(this._currentPageId,this.getContextToken()));if(n&&n.data&&n.data.getIsDirty){var a=n.data.getIsDirty(),i={name:"shouldPerformMainFormSave",value:a};return t.push(i),e.info("Checking if main form save should be performed due to dirty form",t),a}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1},e.prototype._saveMainFormIfImmersiveBpfAndNewRecord=function(){var e=this,t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===Ue.a&&f.a.isNullOrEmpty(this.getCurrentFormEntity().id)){return this._dispatch(Object(u.f)(this._currentPageId,t,!1,1,!1,!1)).then((function(t){e._currentFormEntity=t}))}return Promise.resolve(void 0)},e.prototype._validateSnapshot=function(e){var t=this;return new Promise((function(r,n){var a=t._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),i=t._getSnapshotStateTelemetryParams(e),o=t._currentPageId,s=t.getContextToken(),c=t._dispatch(t._getEventManager().runOnSave(s,1));for(var l in c&&(t._dispatch(Object(d.b)(o,s,2)),t._dispatch(Object(h.b)(o,s,!1)),a.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",i),n(new g.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737))),e.activeChanges){var u=e.activeChanges[l],p=t._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,l),f=Object(Ce.a)(p)?null:p.get_logicalName(),m=Object(Ce.a)(p)?We.a.get_empty():p.get_id();if(Object(Ce.a)(u))return a.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+f+" with ID: "+m,i),n(new Error("Internal Client Error - null fieldValue"));var b=u.validationResult;if(Object(Ce.a)(b)){if(f===Me.c){a.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+f+" with ID: "+m,i);continue}return a.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+f+" with ID: "+m,i),n(new Error("Internal Client Error - null validatorResult"))}var v=b.isValueValid;if(Object(Ce.a)(v))return a.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+f+" with ID: "+m,i),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!v){var y={name:Ae.q,value:"clientSideCurrentForm"};return i.push(y),a.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+f+" with ID: "+m,i),n(new H("Unable to save form data due to validation errors"))}}return r(!0)}))},e.prototype._createStatusAndStateUpdateRequest=function(e,t){var r;return(r={}).statuscode={label:V.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r.statecode={label:k[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r},e.prototype.ValidateRequiredFieldsForNavigation=function(){for(var e=it.startStopwatch({processId:f.a.toString(this.getProcessId()),processInstanceId:f.a.toString(this.getProcessInstanceId())}),t=this._getState(),r=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),n=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a={emptySteps:[],errorSteps:[]},i=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),l=0,p=r;l<p.length;l++){var d=p[l];c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+d,o);var h=Object(pe.j)(this._getState(),this.getCurrentFormEntity(),d);i&&i.activeChanges&&d in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+d,o),h=i.activeChanges[d]),Object(I.h)(h,this._getState(),this.getCurrentFormEntity().etn,d)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+d,o),a.emptySteps.push(d)):h.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+d,o),a.errorSteps.push(d))}for(var g=0,m=n;g<m.length;g++){var b=m[g],v=f.a.tryParse(b);if(f.a.isNullOrEmpty(v))c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+b,o);else{var _=this.getActionLog(v);if(_){var S=_.status;2!==S&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". The Flow Step Action Log has stauts of : "+S,o),a.errorSteps.push(b))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". No action logs were found for this Flow Step",o),a.errorSteps.push(b)}}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;var O=Object(Ye.a)(t,this._currentPageId);if(!Object(y.Gb)(O,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);var C=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(u.f)(this._currentPageId,C,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){var j=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(j,o)}return e(),a},e.prototype.setSelectedStage=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise((function(n,a){var i=f.a.tryParseOrNull(e);if(!i)return a("setSelectedStage can only be called with a valid stage id");var o={selectedStageId:i};r._updateBusinessProcessFlowData(r._currentBpfInstance,o),r._isUserSelectedStage=t,t&&r._executePostEvent("runOnStageSelected","setSelectedStage"),n()}))},e.prototype.setDisplayState=function(e){if(this._currentBpfInstance&&(e===c.a.collapsed||e===c.a.expanded||e===c.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);var t=new _e(f.a.toString(this._processId),f.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}},e.prototype.setActivePath=function(e){if(e&&0!==e.length){for(var t=[],r=0;r<e.length;r++)t[r]=new f.a(e[r]);var n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}},e.prototype.setBpfNavigationBehavior=function(e){var t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)},e.prototype.getBpfNavigationBehavior=function(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())},e.prototype.shouldReInitializeNavigationBehavior=function(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Ce.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))},e.prototype.getBpfNavigationBehaviorAllowCreateNew=function(e){var t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)},e.prototype.createWorkflowLogRecord=function(e){var t;if(Object(Ce.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");var r=this._getState();if(Object(Ce.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");var n=r.metadata;if(Object(Ce.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");var a=n.entities;if(Object(Ce.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");var i=this._currentBpfInstance.etn;if(Object(Ce.b)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");var o=a[i];if(Object(Ce.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");var s=o.EntitySetName;if(Object(Ce.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");var c=Object(ke.z)(r,"workflowlog",o.EntityLogicalName,"asyncoperationid");if(Object(Ce.a)(c))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Ce.b)(c.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");var l=c.ReferencingEntityNavigationPropertyName+"@odata.bind",u="/"+s+"("+e.processInstanceid.guid+")",p=((t={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid})[l]=u,t.activityname=e.processDefinitionid.guid,t.status=e.status,t);Xrm.WebApi.createRecord("workflowlog",p)},e.prototype._getTracer=function(){return Object(Ce.a)(this._applicationContext)||Object(Ce.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")},e.prototype._getDefaultActivePath=function(){var e=this._getTracer();if(Object(Ce.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;var t=this._stageMetadata.getDefaultPathManager();if(Object(Ce.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;var r=t.getDefaultPath();if(Object(Ce.a)(r))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;var n=[];for(var a in r){var i=f.a.parse(r[a]);n.push(i)}return n},e.prototype._updateBusinessProcessFlowData=function(e,t){e&&(this._dispatch(Object(re.a)(t,e)),this._updateProcessInstanceModifiedTime())},e.prototype._updateDisplayState=function(e,t){this._dispatch(Object(ne.a)(t,e)),this._updateProcessInstanceModifiedTime()},e.prototype.getForwardNavigationEntities=function(e,t,r,n){var a=this;return this._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(S(e,t,r,n||null))}))},e.prototype.navigateToNextEntity=function(e,t,r,n){var a=this;return new Promise((function(i,o){var s=a.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return o(new Y("Unable to navigate to next stage as required fields have not been set"));var c=a._stageMetadata.getNextStageId(a.getActiveStageId());if(!c)return o(new K("Last stage in the active path reached. Next stage does not exist."));var l=new f.a(c),u=a.getTraversedPath()+","+c;return a._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(E(e,t,l,u,r,n))})).then((function(){return a.setSelectedStage(c)})).then((function(){a._executePostEvent("runOnStageChange","navigateToNextEntity",0),i()})).catch((function(e){a._dispatch(Object(p.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.navigateToNextEntityForCrossEntityBpf=function(e,t,r,n){var a=this;return new Promise((function(i,o){a._dispatch(E(e,t,new f.a(a.getActiveStageId()),a.getTraversedPath(),r,n)).then((function(){a._dispatch(Object(ie.b)(t,a._currentBpfInstance)),a._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),i()})).catch((function(e){a._dispatch(Object(p.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.getActiveStageActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.b)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceCompletedIn=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance),t=Object(C.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null},e.prototype.getActionLogCollection=function(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null},e.prototype.getActionLog=function(e){var t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null},e.prototype.UpdateActionLog=function(e,t,r,n){if(!this._currentBpfInstance)return null;var i=Object(I.a)(this._getState(),this.getProcessInstanceId()),o=i&&i[e.guid]?i[e.guid]:null,s=(f.a.EMPTY,{actionLogId:Object(Ce.a)(n)||n===f.a.EMPTY?o?o.actionLogId:f.a.newGuid():n,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:r}),c=Object(a.__assign)({},i);c[e.guid]=s;var l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"},e.prototype.getEnabledProcesses=function(){var e=this,t=[];return new Promise((function(r,n){var a;e._currentFormEntity&&e._currentFormEntity.etn?e._dispatch((a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute:function(e,t){e.dispatch;var r=e.getState,n=t.DataSource.get_WebAPIService(),i=r(),o=f.a.tryParse(Object(A.i)(i)),s=new N(a,o),c=Object(F.a)(r(),s);return n.sendRequest(c).then((function(e){return e.json()}),g.b)}})).then((function(e){for(var n=0,a=e.value;n<a.length;n++){var i=a[n];t.push(new M(i.name,i.uniquename,i.workflowid))}r(t)}),(function(e){n(e)})):n(new g.a("Current Form Entity cannot be NULL",2147877745))}))},e.prototype.getNavigationEntities=function(){return this._activeStageManager.navigationEntities},e.prototype._getNavigationEntityIdsByEntityLogicalName=function(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName},e.prototype._updateGlobalActiveStage=function(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)},e.prototype._createGlobalNavigationData=function(e){var t=new R,r=Object(D.b)(e.activestageid);t.activeStageId=f.a.toString(r);var n=Object(D.c)(e.traversedpath);Object(Ce.b)(n)&&(n=L.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=n,t.navigationEntities=[];for(var a=0,i=this._getNavigationEntityTypesFromWorkflowObjectModel();a<i.length;a++){var o=i[a],s=new B;for(var c in s.entityLogicalName=o,s.id=f.a.EMPTY.guid,e)if(Object(D.k)(e[c])){var l=e[c],u=[];if(Object(Ce.a)(l.reference)||Object(Ce.a)(l.reference.etn))u.push({name:"entityReference.reference",value:"NULL"}),this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",u);l&&l.reference&&l.reference.etn===o&&(s.id=l.reference.id.guid)}t.navigationEntities.push(s)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(D.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(D.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(D.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(D.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(D.c)(e.bpfDefinitionVersioNumber)),t},e.prototype._getNavigationEntityTypesFromWorkflowObjectModel=function(){var e={};if(!Object(Ce.a)(this.getProcess()))for(var t=0;t<this.getProcess().get_Steps().get_Count();t++){var r=this.getProcess().get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){var n=r.get_Description();e[n]||(e[n]=n)}}return Object.keys(e)},e.prototype.reflow=function(e,t,r){var n=this._stageMetadata.getDefaultPathManager();if(t||r){if(t){t=new f.a(t).guid;var a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===t||a.indexOf(t)<0)&&(n.updateDefaultPath(t,r),this._updateProcessInstanceModifiedTime())}}else this._reflowInternal()},e.prototype._reflowInternal=function(e,t){var r=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(r.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())},e.prototype.callPblToEvaluateBranching=function(e){var t=this,r=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");var n=Object(ee.a)(r,this._currentPageId);this.getScriptContainerPromise().then((function(r){n<te.a.EditReady&&r.getEventManager().addOnLoadEvent(t.getContextToken(),(function(){r.execute(e,[])})),n>=te.a.OnLoadReady&&r.execute(e,[])}))},e.prototype.update=function(e){!Object(Ce.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()},e.prototype.waitForOngoingWork=function(){return Ze.a.getInstance().checkForOutstandingWork(this._getState())},e.prototype._getEventManager=function(){var e=this.getScriptContainer();return e?e.getEventManager():null},e.prototype.getScriptContainer=function(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;var e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e},e.prototype.getScriptContainerPromise=function(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")},e.prototype._executePostEvent=function(e,t,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),Object(Xe.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,r));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}},e.prototype.executePreEvent=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var a=!1;if(!Object(Xe.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,r))}return this._logTraceInfoForProcessPreEvent(a,e,t,t),a}return this._logTraceFailureForProcessEvent(t,e,e),a},e.prototype._saveFormDataAndActiveStage=function(e,t,r){var n=this,a=st.startStopwatch({processId:f.a.toString(this.getProcessId()),processInstanceId:f.a.toString(this.getProcessInstanceId())}),i=this.executePreEvent("runOnPreStageChange",r,t),o=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(!i){var s=new Promise((function(t,a){if(!e)return a(new U("Attemping to save invalid stage id"));for(var i,s,c=["traversedpath","activestageid","activestagestartedon","completedon"],l=n.getNavigationEntities(),u=Object(m.b)(n._getState(),n._currentBpfInstance),p=0,d=l;p<d.length;p++){var h=d[p];for(var f in u)if(f.includes(h.entityLogicalName)){c.push(f);break}}if(n._shouldPerformFormSave()){var b=n._getState();i=n._validateSnapshot(o).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return s=n._createActiveStageSnapshot(e),n._saveFormEntityAndBPFEntitySnapshots(s,o,!1)})).then((function(){var e=n.getCurrentFormEntity();n._dispatch(Object(rt.a)(n._currentPageId,b,n.getContextToken(),e.etn,e.id))})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,s)}))}else i=n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){return s=n._createActiveStageSnapshot(e),n._dispatch(Object(le.c)(s,!0,c,n._getRetrieveProcessControlDataRequest())).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh(),n._getRetrieveProcessControlDataRequest())),n._dispatch(Object(O.b)(!0,n._currentFormEntity))}))}));t(i)})).then((function(){var e=n.getTraversedPath(),a=n.getActiveStageId();n._updateGlobalActiveStage(e,a),n.setSelectedStage(a),n._executePostEvent("runOnStageChange",r,t)}),(function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}));return s.then(c,c),s}function c(){a()}},e.prototype._handleDuplicateDetection=function(e,t){var r=this;if(Object(tt.e)(e))return this._dispatch(Object($e.a)(this._currentPageId,e,this._currentFormEntity)).then((function(e){return 0===e.status?r._dispatch(Object(et.a)(e.pageId)).then((function(e){return e.value.param_lastButtonClicked===u.a?Promise.resolve("success"):Promise.resolve("aborted")})):Promise.resolve("noop")})).then((function(e){if("success"===e){var n=Object(ge.c)(r._getState(),r.getCurrentFormEntity());return r._saveFormEntityAndBPFEntitySnapshots(t,n,!0)}}));throw e},e.prototype._saveFormEntityAndBPFEntitySnapshots=function(e,t,r){var n={};n[t.identifier.etn]=this._getColumnsToRefresh();var a=null;return a=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(le.d)(a,r,n,this._getRetrieveProcessControlDataRequest()))},e.prototype._logTraceInfoForProcessPreEvent=function(e,t,r,n){var a=this._applicationContext.TraceManager.getTracer(n),i=this.getTelemetryParams(),o={name:"BpfOperationName",value:r};i.push(o);var s={name:"eventName",value:t};i.push(s);var c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+t,i)},e.prototype._logTraceFailureForProcessEvent=function(e,t,r){var n=this._applicationContext.TraceManager.getTracer(r),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});var o={name:"eventName",value:t};a.push(o);var s={name:"isPageDead",value:Object(Xe.n)(this._getState(),this._currentPageId)};a.push(s);var c={name:"currentPageId",value:this._currentPageId};a.push(c),n.error("BPF ProcessManager not able to to execute scripts registered on event "+t+" does not exist",a)},e.prototype._logTraceFailureForScriptContainer=function(){var e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});var r={name:"IsPageDead",value:Object(Xe.n)(this._getState(),this._currentPageId)};t.push(r);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)},e.prototype._getStage=function(e){var t=this,r=null;if(e){var n=this.getEntityStages();n&&n.some((function(n){for(var a=0;a<n.get_Steps().get_Count();a++){var i=n.get_Steps().get_item(a);if(t._equalsIgnoreCase(e,i.get_Id()))return r=i,!0}}))}return r},e.prototype.getContextToken=function(){return Object(he.j)(this._getState(),this._currentPageId)},e.prototype._updateProcessInstanceModifiedTime=function(){this._dispatch(Object(ae.b)(this.getCurrentFormEntity()))},e.prototype._isSelectedStageControl=function(e){if(!Object(Ce.a)(this.getSelectedStage()))for(var t=this.getSelectedStage().get_Steps(),r=0;r<t.get_Count();r++)if(this._equalsIgnoreCase(t.get_item(r).get_Id(),e))return!0;return!1},e.prototype._equalsIgnoreCase=function(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()},e.prototype._getSnapshotStateTelemetryParams=function(e){var t=[];if(Object(Ce.a)(e))return t;var r={name:"mode",value:e.mode},n={name:"identifierId",value:Object(Ce.a)(e.identifier)||Object(Ce.a)(e.identifier.id)?null:f.a.toString(e.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(Ce.a)(a)?null:f.a.fromLegacyGuid(a.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(Ce.a)(a)?null:a.get_objectTypeCode()},s={name:"activeChanges",value:Object(Ce.a)(a)?null:this._getIFieldValuesString(e.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(Ce.a)(a)?null:this._getIFieldValuesString(e.lockedChanges,a.get_logicalName())};return t.push(r),t.push(i),t.push(o),t.push(n),t.push(s),t.push(c),t},e.prototype._getTelemetryParamsForActionStep=function(e,t,r){var n=this.getTelemetryParams(),a={name:"ActionStepType",value:e},i={name:"ControlId",value:t},o={name:"ActionStepId",value:r};return n.push(a),n.push(i),n.push(o),n},e.prototype.getTelemetryParams=function(){var e=[];try{var t={name:"ProcessId",value:f.a.toString(this.getProcessId())},r={name:"ProcessInstanceId",value:f.a.toString(this.getProcessInstanceId())},n={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?f.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},p={name:"PageId",value:this._currentPageId},d={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},g={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Be.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var m={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},b={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(m),e.push(b)}var v={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(r),e.push(n),e.push(i),e.push(o),e.push(a),e.push(c),e.push(l),e.push(u),e.push(p),e.push(d),e.push(h),e.push(g),e.push(v)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e},e.prototype._getIFieldValuesString=function(e,t){var r="";if(!Object(Ce.a)(e))for(var n in e)if(Object(Ce.a)(n))r+=String.format("[fieldName: {0}]",null);else{var a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,n),i=e[n];if(Object(Ce.a)(i)||Object(Ce.a)(a))r+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Ce.a)(i),Object(Ce.a)(a));else{var o="";Object(Ce.a)(i.timestamp)||(o=i.timestamp.toUTCString());var s="",c="",l=null,u=null;Object(Ce.a)(i.validationResult)||(s=i.validationResult.errorId,c=i.validationResult.errorMessage,l=i.validationResult.isOfflineSyncError,u=i.validationResult.isValueValid);var p=a.get_id();r+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",p,o,s,c,l,u)}}return r},e.prototype._getActivePathString=function(){var e=this.getActivePath(),t="";if(e&&e.length>0){for(var r=0;r<e.length-1;r++)t=t+e[r].guid+",";t+=e[e.length-1].guid}return t},e.prototype.isImmersiveBPF=function(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn},e.prototype._getColumnsToRefresh=function(){var e=Object(Qe.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ce.a)(t)){var r=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),a=this._getSnapshotStateTelemetryParams(r);return n.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",a),[]}var i=Object(ke.E)(this._getState(),t.entityTypeName),o=Object(u.g)(this._getState(),e,t,i,null);return o&&o.hasOwnProperty(t.entityTypeName)?o[t.entityTypeName]:[]},e.prototype._getRetrieveProcessControlDataRequest=function(){var e=this.getProcessId()&&!f.a.equals(this.getProcessId(),f.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!f.a.equals(this.getProcessInstanceId(),f.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new qe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new qe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null},e.prototype.getCustomControlIndicator=function(){return this._customControlsPresent},e.prototype.setCustomControlIndicator=function(e){this._customControlsPresent=e},e.prototype.getFormXmlRenderingIndicator=function(){return this._renderedFromFormXml},e.prototype.setFormXmlRenderingIndicator=function(e){this._renderedFromFormXml=e},e.prototype.getInstanceModifiedTimestamp=function(){return this._instanceModifiedTimestamp},e.prototype.isBpfFormDescriptorValid=function(e,t,r,n){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Je.f)(e,t,r,n)),this._isBpfFormValid},e.prototype._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure=function(e,t){var r=t;if(Object(Ce.a)(t)){var n=Object(g.c)(e);r=!Object(Ce.a)(n)&&n.FaultedSnapshotId}!Object(Ce.b)(r)&&this._dispatch(Object(ce.b)(r,!1));var a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());a&&!Object(Ce.a)(a.snapshotId)&&a.snapshotId!==r&&this._dispatch(Object(ce.b)(a.snapshotId,!1))},e}()},"4Q7K":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="dataset.set.newPageRequested";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(t),o=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:o}}}},"52Se":function(e,t,r){"use strict";r.d(t,"a",(function(){return St}));var n,a=r("c/eZ"),i=r("7z0H"),o=r("9r0m"),s=r("Qeyq"),c=r("s0Zj"),l=r("ksD2"),u=r("A8fJ"),p=r("PLtI"),d=r("ASFs"),h=Object(d.d)(((n={})[c.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{collapsed:t.payload})},n[l.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},n[u.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{contentType:t.payload})},n[p.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload})},n),{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var g,f=r("JCHT"),m=r("OmYs"),b=Object(d.d)(((g={})[f.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},g[m.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload})},g),{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var v,y=r("l9yF"),_=r("LteD"),S=r("jT7O"),O=r("kr+h"),C=r("QItn"),I=r("hE7j"),j=r("Q60c"),P=r("n1Ju"),T=r("slAZ"),x=r("tNVD"),E=r("x6Ak");var F=Object(d.d)(((v={})[_.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},v[S.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload,labelSource:y.a.ClientAPI})},v[O.a]=function(e,t){return null!==t.payload?Object(a.__assign)(Object(a.__assign)({},e),{disabledByClientApi:t.payload}):e},v[I.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.parameters),t.payload);return Object(a.__assign)(Object(a.__assign)({},e),{parameters:r})},v[j.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.parameters),{defaultviewid:t.payload});return Object(a.__assign)(Object(a.__assign)({},e),{parameters:r})},v[x.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.views),t.payload.views);return Object(a.__assign)(Object(a.__assign)({},e),{views:r})},v[T.a]=function(e,t){for(var r=e.customFilter?e.customFilter:[],n=r.length-1;n>=0;n--)if(r[n].entityLogicalName===t.payload.entityLogicalName){if(r[n].customFilter===t.payload.customFilter)return e;break}return r.push(t.payload),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[T.c]=function(e,t){var r=[];return r.push({customFilter:"START_FLAG",entityLogicalName:""}),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[T.b]=function(e,t){var r=e.customFilter?e.customFilter:[];if(r.length>0&&"END_FLAG"===r[r.length-1].customFilter)return e;return r.push({customFilter:"END_FLAG",entityLogicalName:""}),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[P.a]=function(e,t){if(t.payload)return Object(a.__assign)(Object(a.__assign)({},e),{notifications:Object(a.__assign)(Object(a.__assign)({},e.notifications),t.payload)});return Object(a.__assign)(Object(a.__assign)({},e),{notifications:t.payload})},v[C.a]=function(e,t){var r=[].concat(e.parameters),n=e;null!==t.payload&&(r.DisableMru=t.payload?"true":"false",n=Object(a.__assign)(Object(a.__assign)({},n),{parameters:r}));return n},v[E.a]=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object(a.__assign)({},e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,v[x.d]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{initializationIntent:t.payload})},v),{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var w,N=r("c7nC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e,t,r){var n=Object(a.__assign)({},e),i=Object.keys(n).length,o={};return r?(n.hasOwnProperty(t)&&delete n[t],Object(a.__assign)({},n)):i>0?n.hasOwnProperty(t)?n:(o[t]=!0,Object(a.__assign)(Object(a.__assign)({},e),o)):(o[t]=!0,o)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var k=Object(d.d)(((w={})[N.a]=function(e,t){return Object(a.__assign)({},A(e,t.meta.controlName,t.payload.isValid))},w),{});var M,D=r("3NtJ"),R=r("fTYK"),L=r("VlhU"),B=r("c3W+"),V=r("UOUy"),G=r("0MLN"),z=r("EGdP"),W=r("zvr0"),q=Object(d.d)(((M={})[W.a]=function(e,t){return Object(a.__assign)({},t.payload.controlUnboundOutputs)},M),{});var U,X=r("n4BT"),H=r("enCe"),K=r("+ulc"),Q=r("hCnb"),Y=Object(d.d)(((U={})[Q.a]=function(e,t){return Object(a.__assign)({},A(e,t.meta.attributeName,t.payload.isValid))},U),{});var J=r("lwSE"),Z=r("SdPQ"),$=r("e2rP"),ee=r("uCYK");var te={tabs:Object(d.b)("tabId",h),sections:Object(d.b)("sectionName",b),controls:Object(d.b)("controlName",F),selectedTab:function(e,t){if(void 0===e&&(e=Object(s.a)()),t.type===R.a){if(e.navigationStack&&e.navigationStack.length>0)return Object(a.__assign)(Object(a.__assign)({},e),{tabId:e.navigationStack[e.navigationStack.length-1],navigationStack:e.navigationStack.slice(0,e.navigationStack.length-1)})}else if(t.type===D.a){var r=(e.navigationStack||[]).slice(0);return e.tabId&&e.tabId!==t.payload&&r.push(e.tabId),Object(a.__assign)(Object(a.__assign)({},e),{tabId:t.payload,navigationStack:r})}return e},selectedRelatedEntity:function(e,t){return void 0===e&&(e=null),t.type===L.a?t.payload:e},xrmReady:function(e,t){return void 0===e&&(e=!1),t.type===i.b?t.payload.xrmReady:e},isSaving:function(e,t){return void 0===e&&(e=!1),t.type===B.a?t.payload.savingState:e},controlUnboundOutputs:q,inlineQuickForms:function(e,t){return void 0===e&&(e=null),t.type===i.a?t.payload.formUIState.inlineQuickForms:e},invalidControls:k,invalidAttributes:Y,label:function(e,t){return void 0===e&&(e=""),t.type===G.a?t.payload.label:e},hasOfflineChanges:function(e,t){return void 0===e&&(e=!1),t.type===V.a?t.payload.hasOfflineChanges:e},viewportWidth:function(e,t){return void 0===e&&(e=0),t.type===X.a?t.payload.viewportWidth:e},viewportHeight:function(e,t){return void 0===e&&(e=0),t.type===X.a?t.payload.viewportHeight:e},formId:function(e,t){return void 0===e&&(e=o.a.EMPTY),e},showHeaderFieldsInSection:function(e,t){return void 0===e&&(e=!1),t.type===H.a?t.payload.showHeaderFieldsInSection:e},headerFieldsInFlyout:function(e,t){if(t.type===K.a){for(var r=new Set,n=t.payload.headerFieldsInFlyout,a=0;a<n.length;a++)r.add(n[a].Name);return r}return e},isAutoSaving:function(e,t){return void 0===e&&(e=!1),t.type===z.a?t.payload.isAutoSaving:e},header:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),t.type){case Z.a:return Object(a.__assign)(Object(a.__assign)({},e),{bodyVisible:t.payload});case $.a:return Object(a.__assign)(Object(a.__assign)({},e),{commandBarVisible:t.payload});case J.a:return Object(a.__assign)(Object(a.__assign)({},e),{tabNavigatorVisible:t.payload})}return e},footer:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={visible:!0}),t.type){case ee.a:return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})}return e},formScrollAndFocusState:function(e,t){return t.type===x.e?t.payload:e}},re=Object(d.a)(te),ne=Object(d.b)("contextKey",re),ae=r("g24L"),ie=r("kk/C"),oe=r("d/U0");var se,ce={snapshotId:ae.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===ie.a){var r={},n=t.payload.fieldValues;if(!n)return e;for(var i in n)e&&e.hasOwnProperty(i)||(r[i]=n[i]);return Object.keys(r).length>0?Object(a.__assign)(Object(a.__assign)({},e),r):e}if(t.type===ie.b){r={};if(t.payload.keepFields)for(var o=0,s=t.payload.keepFields;o<s.length;o++){e[i=s[o]]&&(r[i]=e[i])}return r}return e},isDeleted:function(e,t){return void 0===e&&(e=!1),t.type===oe.a?t.payload:e}},le=Object(d.a)(ce),ue=Object(d.b)("contextKey",le),pe=r("/wtJ"),de=r("FuJ2"),he=r("ABRM"),ge=r("YdIa"),fe=r("JFej"),me=r("Ini7"),be=r("FGem"),ve=r("E0SJ"),ye=r("NuVc"),_e=r("xirW"),Se=Object(d.d)(((se={})[pe.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Precision:t.payload,PrecisionSource:ye.a.attribute})},se[de.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{RequiredLevel:t.payload})},se[he.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Format:t.payload})},se[ge.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Targets:t.payload})},se[fe.a]=function(e,t){var r=e.OptionSet,n=t.payload.option;if(!r||!n)return e;var i=t.payload.index;r=r.slice(0),i>=0&&i<r.length?r.splice(i,0,n):r.push(n);return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r})},se[me.a]=function(e,t){var r=e.OptionSet;if(!r)return e;var n=t.payload;r=r.slice(0);for(var i=0;i<r.length;i++)if(r[i].Value===n)return r.splice(i,1),Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r});return e},se[be.a]=function(e,t){if(!e.OptionSet)return e;return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:[]})},se[ve.a]=function(e,t){if(!e.OptionSet)return e;var r=t.payload;return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r||[]})},se[_e.a]=function(e,t){if(t.payload)return Object(a.__assign)(Object(a.__assign)({},e),{notifications:Object(a.__assign)(Object(a.__assign)({},e.notifications),t.payload)});return Object(a.__assign)(Object(a.__assign)({},e),{notifications:t.payload})},se),{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var Oe,Ce=r("5jMY"),Ie=r("o0+l"),je=Object(d.d)(((Oe={})[Ie.a]=function(e,t){var r;if(t.payload===Ce.a.Dirty){var n={};if(t.meta.dataFieldName&&Object.keys(e).lastIndexOf(t.meta.dataFieldName)>-1){for(var i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];s!==t.meta.dataFieldName&&(n[s]=e[s])}return Object.freeze(n)}return e}return Object(a.__assign)(Object(a.__assign)({},e),((r={})[t.meta.dataFieldName]=t.payload,r))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Oe),{});var Pe,Te={attributes:Object(d.b)("dataFieldName",Se),submitModes:je},xe=Object(d.a)(Te),Ee=Object(d.b)("contextKey",xe),Fe=r("LFYt"),we=r("Uhhf"),Ne=Object(d.d)(((Pe={})[Fe.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{value:t.payload.value})},Pe[we.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{value:t.payload.value})},Pe),{reason:"",value:""});var Ae,ke=r("rQCE"),Me=r("LiB6"),De=r("dWLV"),Re=r("PhZR"),Le=r("YOvo"),Be=r("VQYK");var Ve=Object(d.d)(((Ae={})[Re.a]=function(e,t){var r=Object(a.__assign)({},e);return Ge(r,t.payload.label,t.payload.currentLanguageId),r.labelSetByClientAPI=!0,Object.freeze(r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Ae[Le.a]=function(e,t){var r=t.payload;return Object.freeze(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e),r),{showSetByClientAPI:!0}))},Ae),{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function Ge(e,t,r){var n=Object(Be.b)(e,r);if(n)n.Value=t;else{var a=null===r?"":r.toString();e.titles[""]={Name:a,Value:t}}return e}var ze=Object(d.d)({},{}),We=Object(d.d)({},{}),qe=Object(d.d)({},{}),Ue=r("jWor"),Xe=Object(d.b)("navigationItemId",Ve);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var He,Ke={navBarAreas:ze,navPaneIsvItems:We,navBarByRelationshipItems:function(e,t){if(t.type===Ue.a){if(t.payload.allNavBarByRelationshipItems&&t.payload.allNavBarByRelationshipItems.length>0){var r=Object(a.__assign)({},e);return t.payload.allNavBarByRelationshipItems.forEach((function(e){e&&e.id&&(r[e.id]||(r[e.id]=Object(a.__assign)(Object(a.__assign)({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:e.id})),Ge(r[e.id],e.title,t.payload.currentLanguageId))})),Object.freeze(r)}return e}return Xe(e,t)},navBarItems:qe},Qe=Object(d.a)(Ke),Ye=r("+ieV"),Je=r("2p2B"),Ze=Object(d.d)(((He={})[Ye.a]=function(e,t){var r,n={Message:t.payload.message,Level:t.payload.level,UniqueId:t.payload.uniqueId,Buttons:t.payload.buttons,MessagePlaceholders:t.payload.placeholders,ControlName:t.payload.controlName,ComponentId:t.payload.componentId};return Object(a.__assign)(Object(a.__assign)({},e),((r={})[t.payload.uniqueId]=n,r))},He[Je.a]=function(e,t){if(Object.keys(e).length<1)return e;var r={};if(t.payload.uniqueId)for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];i!==t.payload.uniqueId&&(r[i]=e[i])}return r},He),{});var $e,et=r("KbPJ"),tt=r("/CqC"),rt=Object(d.d)((($e={})[et.a]=function(e,t){if(t.type===et.a)return Object(a.__assign)(Object(a.__assign)({},e),t.payload);return e},$e[tt.a]=function(e,t){var r=Object(a.__assign)({},e);return delete r[t.payload.relationship],Object.freeze(r)},$e),{});var nt=r("NWJ/"),at=r("I6xF"),it=r("+hGu"),ot=r("ApiM"),st=r("NfcN"),ct=r("VHYb"),lt=r("bCrZ"),ut=r("UOiB"),pt=r("Sscr"),dt=r("oUmu"),ht=r("Axwz"),gt=r("vm7t"),ft=r("gRWC"),mt={selectedFormId:null,forms:{}},bt=r("Gt1u"),vt=r("9KTg");var yt=r("bhC+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _t=Object(d.a)({loadingState:function(e,t){return void 0===e&&(e=ke.a.Initial),t.type===nt.a?t.payload:e},formId:function(e,t){return void 0===e&&(e=null),t.type===i.a?t.payload.formId:e},navigation:Qe,notifications:Ze,powerBISignedInState:function(e,t){return void 0===e&&(e="NotSignedIn"),t.type===at.a?t.payload:e},suppressDuplicateDetection:function(e,t){return void 0===e&&(e=!1),t.type===it.a?t.payload.suppressDuplicateDetection:e},customDataProviderOutputs:Me.a,formlessControlOutputs:De.a,output:Ne,datasets:ct.a,metadata:Ee,records:ue,forms:ne,entityReferenceByRelationship:rt,referenceInformationByRelationship:function(e,t){return void 0===e&&(e={}),t.type===st.a?t.payload:e},primaryEntity:function(e,t){return void 0===e&&(e=""),"set.primary.entity"===t.type?t.payload:e},visitedTabNames:function(e,t){if(void 0===e&&(e=null),t.type===ht.a){var r=t.payload;if(!e)return r?new Set([r]):null;if(!r||e.has(r))return new Set(e);var n=new Set(e);return n.add(r),n}return e},autoSaveInterval:function(e,t){return void 0===e&&(e=gt.a),t.type===gt.d?e=gt.a:t.type===gt.b&&e<gt.c&&(e+=gt.a),e},formInstances:function(e,t){var r,n;if(void 0===e&&(e={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}}),t.type===x.b){var i=t.payload.formInstanceId,o=t.payload.controlName,s=Object(a.__spreadArrays)(e.list,[i]),c=Object(a.__assign)(Object(a.__assign)({},e.formInstanceIdByControlName),((r={})[o]=i,r)),l=Object(a.__assign)(Object(a.__assign)({},e.controlNameByFormInstanceId),((n={})[i]=o,n));e=Object(a.__assign)(Object(a.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}else if(t.type===x.g){var u=t.payload.formInstanceId;o=t.payload.controlName,s=e.list.filter((function(e){return e!==u}));if(e.formInstanceIdByControlName[o]&&e.controlNameByFormInstanceId[u]){var p=o,d=e.formInstanceIdByControlName,h=p,g=(d[h],c=Object(a.__rest)(d,["symbol"==typeof h?h:h+""]),u),f=e.controlNameByFormInstanceId,m=g;f[m],l=Object(a.__rest)(f,["symbol"==typeof m?m:m+""]);e=Object(a.__assign)(Object(a.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}}return e},formSelector:function(e,t){var r;return void 0===e&&(e=mt),t.type===ft.a?Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(r={},r[t.meta.formId]={visible:t.payload.visible},r))}):t.type===yt.a?Object(a.__assign)(Object(a.__assign)({},e),{selectedFormId:t.payload.formId}):e},parentComponentId:function(e,t){return void 0===e&&(e=""),t.type===x.c?t.payload.parentComponentId:e},referencePanel:function(e,t){switch(void 0===e&&(e={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""}),t.type){case vt.a:return t.payload.messageId?Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId,messageId:t.payload.messageId})):Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case vt.d:case vt.c:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case vt.e:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{messageId:t.payload.messageId}));case vt.g:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case vt.f:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case vt.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case vt.h:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs}));default:return e}},formLoadError:function(e,t){return void 0===e&&(e=null),t.type===bt.a?t.payload.error:e}});function St(e,t){var r,n,o,s,c,l,u;if(void 0===e){var p=_t(e,t);return Object.freeze(p)}if(t.type===i.a){var d=t.meta.contextToken,h=Ot(P=Object(pt.v)(d)),g=e.forms[P],f=O=e.metadata;t.payload.relatedEntityMetadataState&&(f=Object.assign.apply(Object,Object(a.__spreadArrays)([{},f],[t.payload.relatedEntityMetadataState])));var m=Object(a.__assign)(Object(a.__assign)({},e.forms),((r={})[P]=Object(a.__assign)(Object(a.__assign)({},g),t.payload.formUIState),r));f=Object(a.__assign)(Object(a.__assign)({},f),((n={})[P]=Object(a.__assign)(Object(a.__assign)({},f[P]),t.payload.formMetadataState),n));var b=Object(a.__assign)(Object(a.__assign)({},e.navigation),m&&d.contextTokenType===ut.a.MainForm?m[P].navigation:e.navigation);if(b.navBarByRelationshipItems){var v=b.navBarByRelationshipItems;b.navBarByRelationshipItems={};for(var y=Object.keys(v),_=0;_<y.length;_++){var S=y[_];b.navBarByRelationshipItems[S]=Object(Be.a)(v[S],t.payload.currentLanguageId)}}u=Object(a.__assign)(Object(a.__assign)({},e),{formId:t.payload.formId,forms:m,metadata:f,records:h,powerBISignedInState:"NotSignedIn",suppressDuplicateDetection:!1,navigation:b})}else if(t.type===ot.a&&e.metadata[t.meta.contextKey]){var O=e.metadata[t.meta.contextKey];u=Object(a.__assign)(Object(a.__assign)({},e),{metadata:Object(a.__assign)(Object(a.__assign)({},e.metadata),(o={},o[t.meta.contextKey]=Object(a.__assign)(Object(a.__assign)({},O),{attributes:Object(a.__assign)(Object(a.__assign)({},null==O?void 0:O.attributes),t.payload.attributes)}),o))})}else if(t.type===ot.b){var C=e.forms[t.meta.contextKey];u=Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(s={},s[t.meta.contextKey]=Object(a.__assign)(Object(a.__assign)({},C),{controls:Object(a.__assign)(Object(a.__assign)({},e.forms[t.meta.contextKey].controls),t.payload.controls)}),s))})}else if(t.type===lt.a){var I=t.payload,j=Object(a.__assign)(Object(a.__assign)({},e.datasets),((c={})[I.contextKey]=I.initialDataSetState,c));u=Object(a.__assign)(Object(a.__assign)({},e),{datasets:j})}else if(t.type===dt.a){d=t.meta.contextToken;var P=Object(pt.v)(d),T=(C=e.forms[P],Object(a.__assign)({},C)),E=C.selectedTab.tabId;if(!t.payload.formUIState.tabs[E]){var F=C.tabs[E];if(F){var w=F.domId,N=void 0;for(var A in t.payload.formUIState.tabs){if(t.payload.formUIState.tabs[A].domId===w){N=A;break}}C.selectedTab.tabId=N||""}}T.controls=t.payload.formUIState.controls,T.sections=t.payload.formUIState.sections,T.tabs=t.payload.formUIState.tabs,T.label=t.payload.formUIState.label,T.inlineQuickForms=t.payload.formUIState.inlineQuickForms,u=Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(l={},l[P]=T,l))})}else if(t.type===x.h){d=t.meta.contextToken,h=Ot(P=Object(pt.v)(d));u=Object(a.__assign)(Object(a.__assign)({},e),{records:h})}else u=_t(e,t);return Object.freeze(u)}function Ot(e){var t;return(t={})[e]={snapshotId:"",isDeleted:!1},t}},"5cS+":function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d}));var n=r("c/eZ"),a=r("9r0m"),i=r("gBKR"),o=r("r2h9"),s=r("/j9Z"),c=r("olrR"),l=r("uO/V"),u=r("/45f"),p=r("Gemh");function d(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute:function(d,g){var f=d.dispatch,m=d.getState,b=g.TraceManager.getTracer(l.z),v=l.x+".loadDataSetHostDependenciesAction";b.info("Retrieving view with ID "+a.a.toString(t)+" for "+e+" entity.");var y=Object(p.pb)(m(),e,t);return f(Object(c.a)(e,o.a.MAIN_APPLICATION_VIEW,y,t)).then((function(o){if(!o){var c="Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID "+a.a.toString(t)+" for "+e;return g.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.b))}var l=h(m(),t,r);return f(Object(i.e)(l)).then((function(){var r=[{name:"entityTypeName",value:e},{name:"viewId",value:a.a.toString(t)}];return g.EventManager.ReportComponentSuccess(v,r),Promise.resolve()})).catch((function(r){var i=[];for(var o in l)l[o].length&&(i=Object(n.__spreadArrays)(l[o],i));var c="Unable to retrieve DataSetHost dependencies for the grid for view with ID "+a.a.toString(t)+". Failed to retrieve entity with attributes "+i.join()+" for "+e;return g.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.a))}))}))}}}function h(e,t,r){var n=Object(p.qb)(e,t,r),a={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){var i=[];n.grid.rows[0].cells.forEach((function(e){if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){var t=e.name.split(".")[1];a[e.relatedEntityName]||(a[e.relatedEntityName]=[]),-1===a[e.relatedEntityName].indexOf(t)&&t&&a[e.relatedEntityName].push(t)}}else-1===i.indexOf(e.name)&&i.push(e.name)})),i.length>0&&(a[n.entityLogicalName]=i)}return a}},"7bez":function(e,t,r){"use strict";r.d(t,"a",(function(){return F})),r.d(t,"b",(function(){return w}));var n,a,i=r("1z64"),o=r("sOTk"),s=r("/zIU"),c=r("PZxu"),l=r("9r0m"),u=r("Wye+"),p=r("+Z9T"),d=r("Gemh"),h=r("IiPO"),g=r("HSdq"),f=r("/j9Z"),m=r("Sscr"),b=r("ezfI"),v=r("kvLG"),y=function(){function e(e,t,r,a,o){this._pageId=r,n=e,this._contextToken=t,this._controlName=a,this._gridType=o,this._clientApiExecutor=new i.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:o,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}return e.prototype.setCurrentView=function(e){var t=this;this._clientApiExecutor.executeAsync("setCurrentView",(function(r,a){return e&&e.id?n.dispatch(Object(u.a)(t._pageId,t._contextToken,t._controlName,e.id)):(a.push({name:"validationError",value:"true"}),v.a.getInstance().traceManager.getTracer(r).error("View ID is required",a),Promise.resolve())}))},e.prototype.getCurrentView=function(){var e="ClientApi.XrmViewSelector.getCurrentView";try{b.a.instance.reportCall(e);var t=Object(d.hb)(n.getState(),this._pageId,this._contextToken,this._controlName),r=null,a=null;if(t)a=t.ViewId;else if(3===this._gridType){var i={id:this._pageId},o=Object(g.fb)(n.getState(),i,this._contextToken.parentContextToken);if(!(o&&o.Controls&&o.Controls[this._controlName]&&o.Controls[this._controlName].Parameters&&o.Controls[this._controlName].Parameters.ViewId)){var s=void 0;return o?o.Controls?o.Controls[this._controlName]?o.Controls[this._controlName].Parameters?o.Controls[this._controlName].Parameters.ViewId||(s="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):s="formDescriptor.Controls[this._controlName].Parameters is null or undefined":s="formDescriptor.Controls[this._controlName] is null or undefined":s="formDescriptor.Controls is null or undefined":s="formDescriptor is null or undefined",(v=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new f.a(s),null,v),null}a=o.Controls[this._controlName].Parameters.ViewId}if(a){if(r=Object(d.qb)(n.getState(),l.a.parse(a),this._pageId)){var c={entityType:Object(d.ob)(n.getState(),a,this._pageId),id:l.a.externalGuid(r.viewId),name:r.title};return b.a.instance.reportSuccess(e),c}var u=[];return u.push({name:"controlName",value:this._controlName}),u.push({name:"contextKey",value:Object(m.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,u),null}var p=[];return p.push({name:"controlName",value:this._controlName}),p.push({name:"contextKey",value:Object(m.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,p),null}catch(t){var v;throw(v=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,v),t}},e.prototype.isVisible=function(){var e="ClientApi.XrmViewSelector.isVisible";try{if(b.a.instance.reportCall(e),Object(p.a)(this._isVisible)){var t=Object(d.hb)(n.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{var r={id:this._pageId},a=Object(g.fb)(n.getState(),r,this._contextToken.parentContextToken);if(!(a&&a.Controls&&a.Controls[this._controlName]&&a.Controls[this._controlName].Parameters&&a.Controls[this._controlName].Parameters.EnableViewPicker))return(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new f.a("FormDescriptor is null"),null,i),!1;this._isVisible=a.Controls[this._controlName].Parameters.EnableViewPicker}}return b.a.instance.reportSuccess(e),this._isVisible}catch(t){var i;throw(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e}(),_=r("h82J"),S=r("fW82"),O=r("tcXs"),C=r("Cgjg"),I=r("lMVv"),j=r("r2h9"),P=r("gLMt"),T=r("qC0c"),x=r("cZkS"),E=r("Ka9P"),F=function(){function e(e,t,r,n,o,s,c,l){this._relationship=null;var u="ClientApi.XrmGridControl.constructor";e||Object(p.j)(u,"store"),t||Object(p.j)(u,"contextToken"),r||Object(p.j)(u,"pageId"),a=e,this._pageId=r,this._contextToken=t,this._controlName=l,this._isEditable=n,this._gridType=o,this._applicationContext=c,s||a.dispatch(Object(_.a)(this,r,t)),this._clientApiExecutor=new i.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:l,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:n,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:o,isEventParam:!0})}return Object.defineProperty(e.prototype,"_connectedControlProps",{get:function(){return{controlName:this._controlName,id:this._pageId}},enumerable:!1,configurable:!0}),e.prototype.setFilterXml=function(e){var t=this;this._clientApiExecutor.executeAsync("setFilterXml",(function(){var r=(new Date).getTime();return a.dispatch(Object(C.b)(e,1,t._pageId,t._contextToken,r))}))},e.prototype.getFilterXml=function(){var e="ClientApi.XrmGridControl.getFilterXml";try{b.a.instance.reportCall(e);var t=Object(d.u)(a.getState(),this._pageId,this._contextToken);return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFetchXml=function(){var e="ClientApi.XrmGridControl.getFetchXml";try{b.a.instance.reportCall(e);var t=Object(d.A)(a.getState(),this._contextToken,{id:this._pageId});return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getGrid=function(){var e="ClientApi.XrmGridControl.getGrid";try{return b.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new c.a(a,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getViewSelector=function(){var e="ClientApi.XrmGridControl.getViewSelector";try{return b.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(a,this._contextToken,this._pageId,this._controlName,this._gridType)),b.a.instance.reportSuccess(e),this._viewSelector}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getTeamTemplateId=function(){var e="ClientApi.XrmGridControl.getTeamTemplateId";try{b.a.instance.reportCall(e);var t=null,r=a.getState();if(Object(T.c)(r,x.c))if(this.getEntityName()&&3===this._gridType){var n=Object(g.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken);n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters.TeamTemplateId&&(t=n.Controls[this._controlName].Parameters.TeamTemplateId)}return b.a.instance.reportSuccess(e),t}catch(t){var i=h.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getEntityName=function(){var e=this;return this._clientApiExecutor.execute("getEntityName",(function(t,r){if(!e._entityName){if(e._entityName=Object(d.F)(a.getState(),e._pageId,e._contextToken,e._controlName),!e._entityName&&3===e._gridType){var n=Object(g.fb)(a.getState(),e._connectedControlProps,e._contextToken.parentContextToken);if(!(n&&n.Controls&&n.Controls[e._controlName]&&n.Controls[e._controlName].Parameters&&n.Controls[e._controlName].Parameters.TargetEntityType)){var i=void 0;return n?n.Controls?n.Controls[e._controlName]?n.Controls[e._controlName].Parameters?n.Controls[e._controlName].Parameters.TargetEntityType||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",e._clientApiExecutor.reportFailure(t,new f.a(i),r),null}e._entityName=n.Controls[e._controlName].Parameters.TargetEntityType}if(!e._entityName)return e._clientApiExecutor.reportFailure(t,new f.a("Logical name of the entity type is coming as null or undefined."),r),null}return e._entityName}))},e.prototype.refresh=function(){var e=this;this._clientApiExecutor.executeAsync("refresh",(function(){return a.dispatch(Object(u.a)(e._pageId,e._contextToken,e._controlName))}))},e.prototype.refreshRibbon=function(){var e=this;this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(O.a)(e._pageId,Object(d.w)(a.getState(),e._pageId,e._contextToken)))}))},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridControl.getUrl";try{b.a.instance.reportCall(t);var r,n=null,i=this._getCurrentView();n={entityTypeName:this.getEntityName()},i&&(n.viewType="savedquery"===i.entityType?j.b.savedview:j.b.userview,n.viewId=new l.a(i.id)),r=s.a.Grid;var o=null;if(1===e)o=a.dispatch(Object(S.a)(r,n));else{var c=Object(P.a)(a,this._pageId);o=a.dispatch(Object(S.c)(c,r,n))}return b.a.instance.reportSuccess(t),o}catch(e){var u=h.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(t,e,null,u),e}},e.prototype.getRecordSetQueryKey=function(){var e=this;return this._clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(d.cb)(a.getState(),e._contextToken,{id:e._pageId})}))},e.prototype.getGridType=function(){return b.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType},e.prototype.getRelationship=function(){var e=this;return this._clientApiExecutor.execute("getRelationship",(function(t,r){if(!e._relationship){var n=Object(d.v)(a.getState(),e._pageId,e._contextToken);if(n){var i=n.relationshipName;if(i&&(e._relationship=w(i,e.getEntityName()),n.relationshipRoleOrdinal)){var o=n.relationshipRoleOrdinal===E.a.Referencing?1:2;e._relationship.roleType=o}}else v.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",r)}return e._relationship}))},e.prototype.getParentForm=function(){var e="ClientApi.XrmGridControl.getParentForm";try{b.a.instance.reportCall(e);var t=this._contextToken&&this._contextToken.parentContextToken?a.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getRollupType=function(){var e=this;return this._clientApiExecutor.execute("getRollupType",(function(){return Object(d.eb)(a.getState(),e._pageId,e._contextToken)}))},e.prototype._getCurrentView=function(){var e=null,t=this.getViewSelector().getCurrentView();if(t)return{entityType:e="savedquery"===t.entityType?"savedquery":"userquery",id:t.id};var r=Object(o.g)(a.getState(),this._pageId);if(r.viewType&&r.viewId){var n=r.viewId?l.a.externalGuid(r.viewId):void 0;if((e=r.viewType===j.b.savedview?"savedquery":"userquery")&&n)return{entityType:e,id:n}}return null},e}();function w(e,t){var r={};r.name=e;var n=Object(I.h)(a.getState(),t);if(n){var i=void 0;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?i=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(i=n.ManyToOneRelationships[e]),i)r.attributeName=i.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=i.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){var o=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=o.Entity1IntersectAttribute,r.navigationPropertyName=o.Entity1NavigationPropertyName):(r.attributeName=o.Entity2IntersectAttribute,r.navigationPropertyName=o.Entity2NavigationPropertyName)}}return r}},"7oc5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i=r("zETL"),o="grid.toggleRollupView";var s=function(e,t,r){return function(e,t,r,o){return{type:"grid.toggleRollupView.async",execute:function(s,c){var l=s.dispatch,u=c.TraceManager.getTracer(a.z),p=a.x+".toggleRollupViewAction";try{u.info("Setting Toggle value to "+t+" for the grid.");var d=Object(n.v)(o);l(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,d)),l(Object(i.b)(r,o));var h=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(p,h),Promise.resolve()}catch(e){c.EventManager.ReportComponentFailure(p,Error("Setting Toggle value to the grid failed"))}}}}(o,e,t,r)}},"7z0H":function(e,t,r){"use strict";r.d(t,"f",(function(){return _e})),r.d(t,"h",(function(){return ne})),r.d(t,"i",(function(){return pe})),r.d(t,"j",(function(){return de})),r.d(t,"k",(function(){return he})),r.d(t,"c",(function(){return oe})),r.d(t,"d",(function(){return se})),r.d(t,"a",(function(){return te})),r.d(t,"b",(function(){return re})),r.d(t,"e",(function(){return ae})),r.d(t,"g",(function(){return ye}));var n=r("wQXd"),a=r("9r0m"),i=r("i8/j"),o=r("/j9Z"),s=r("HSdq"),c=r("2OIc"),l=r("sOTk"),u=r("QAhb"),p=r("F2uj"),d=r("7EJx"),h=r("ObKm"),g=r("CpQy"),f=r("gBKR"),m=r("jJRu"),b=r("cAHA"),v=r("lMVv"),y=r("TCcM"),_=r("GWjY"),S=r("DJ9D");var O=r("VWqI"),C=r("Cfob"),I=r("Qeyq"),j=r("r4Uk"),P=r("T2Xs"),T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var x=r("aUuu"),E=r("Sscr"),F=r("mGpW"),w=r("RNNy"),N=r("WACO"),A=r("M6d0"),k=r("n+eO"),M=r("yHpA"),D=r("+l2M"),R=r("YHw6"),L=r("IfuP"),B=r("cL6R"),V=r("YEEA"),G=r("Ww2r"),z=r("EcZf"),W=r("BRt1"),q=r("U0B9"),U=r("jm5F"),X=r("TiXY"),H=r("wUng"),K=r("cZkS"),Q=r("qC0c"),Y=r("AfKB"),J=r("455M"),Z=r("ZEX9"),$=r("yZTI"),ee=r("uQP8"),te="form.initialize",re="form.xrmready";function ne(e,t,r,n,c){var g=[{name:"formId",value:a.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(E.v)(r)}];return{type:"form.initialize.async",execute:function(f,m,b){var y,_=f.dispatch,S=f.getState,C=S(),I=Object(l.g)(C,t),F=I.entityTypeName,w=I.data,M=I.recordSetQueryKey,L=m.TraceManager.getTracer("Forms.InitializeForm"),G=[];if(g.push({name:"isPreview",value:I&&I.isPreview}),g.push({name:"EntityName",value:I&&I.entityTypeName}),L.info("initializeForm started.",g),Object(Z.b)(function(e){return function(){var t={},r={},n={};return function(a,i,o,s,c){P.a.info(T+o.controlId+": createGetTimelineWallData started");var l=!1;r.hasOwnProperty(a)&&r[a]||(r[a]=new j.a(e,a,o.id));var u=r[a],p=u.retrieveTimelineWallObject(i,o,s,c,e);n.hasOwnProperty(a)&&n[a]&&p===n[a]||(n[a]=p,l=!0);var d=u;return l&&(t[a]=d),P.a.info(T+o.controlId+": createGetTimelineWallData finished"),t[a]}}}(_),J.a.TimelineWall),L.info("BusinessProcessWrapperManager.Instance.init started.",g),G.push(k.a.Instance.init(m,S,_).then((function(){return L.info("BusinessProcessWrapperManager.Instance.init completed.",g)}))),Object(O.a)(C,e))if(Object(l.m)(C,t)){if(!Object(O.g)(C,F,1,0)&&!(null==I?void 0:I.isPreview))return ie(22e8,_,L,b,C,t)}else if(!Object(O.g)(C,F,2,0))return ie(2147746342,_,L,b,C,t);var q=Object(i.j)(C,e),$=ye(C,q,e),ee=me(C,F,q),te=function(e,t,r,n){var a={};if(t&&t.RelatedEntityAttributes&&n)for(var i in t.RelatedEntityAttributes){var o=Object(v.x)(e,n,i);if(o&&o.ReferencedEntity){var s={},c=be(e,o.ReferencedEntity,t.RelatedEntityAttributes[i]),l=Object(E.m)(r,i);a[Object(E.v)(l)]={attributes:c,submitModes:s}}}return a}(C,q,r,F),re=Object(W.a)(C),ne=Object(d.s)(C);for(var ae in Se(C,_,e,$,ee,t,r,te,ne),M&&!re&&_(Object(z.g)(t,M)),L.info("Update quick view forms started.",g),q.InlineQuickForms){var oe=q.InlineQuickForms[ae];for(var se in oe){var pe=oe[se],de=Object(i.j)(C,pe),he=ye(C,de,pe),ve=me(C,se,de),_e=Object(E.l)(r,ae,se);Se(C,_,e,he,ve,t,_e,null,ne)}}if(L.info("Update quick view forms completed.",g),w&&0!==Object.keys(w).length){var Oe=I,Ce=Oe.createFromEntity,Ie=Oe.createFromRelationship,je=I.initWithEntity,Pe=Ce;!Pe&&je&&(Pe=je),y=function(e,t,r,n,i,c,d,g,f,m,b){r&&r.info("initializeFormWithDefaultValue started.",n);var y,_,S=Object(p.d)(e,c),O=null,C={},I=Object(l.m)(e,i),j=a.a.toString(g),P=[];j&&(O=Object(p.k)(e,j));for(var T=0,x=Object.keys(d);T<x.length;T++){var F=x[T];if("processid"!==F){var w=S[F];if(!w&&O&&(w=O[F]),w&&!w.AttributeOf){var N=w.Type;switch(N){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof d[F]){var k=ce(d,F,w);if(!k){ue(r,F);continue}if(C[F]=k,!a.a.equals(a.a.EMPTY,k.id)&&"owner"!==N&&I&&(m||b))if(_){var M=_.then((function(){return t(Object(U.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (1).",n)}))}));P.push(M)}else _=fe(e,t,k,c,i,r,n,m,b),P.push(_)}else{var D=void 0;(D=Array.isArray(d[F])?d[F][0]:d[F])&&D.id&&a.a.tryParseOrNull(D.id)&&D.entityType&&(C[F]=new u.a(D.entityType,new a.a(D.id),D.name))}break;case"partylist":var R=d[F],L=R,B=[];try{"string"==typeof R&&(L=JSON.parse(R));for(var G=0,z=L;G<z.length;G++){var W=z[G];B.push(new u.a(W.entityType,new a.a(W.id),W.name))}}catch(e){ue(r,F,"partylist")}C[F]=B;break;case"boolean":case"picklist":case"status":C[F]=d[F];break;case"uniqueidentifier":C[F]=new a.a(d[F]);break;default:C[F]=d[F]}}else if(-1!==F.indexOf(Y.d)||"_CreateFromId"===F){var q=null;if(-1!==F.indexOf(Y.d)&&(q=ce(d,Y.d,w)),!q&&"_CreateFromId"===F){var J=Object(v.m)(e,d._CreateFromType),Z=Object(v.h)(e,J);Z&&(q=le(J,d._CreateFromId,Z.DisplayName))}if(!q){ue(r,Y.d);continue}if(!y&&(y=q,I))if(_){M=_.then((function(){return t(Object(U.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (2).",n)}))}));P.push(M)}else _=fe(e,t,y,c,i,r,n,m,b),P.push(_);if(Object(v.h)(e,c).IsActivity&&-1===Object.keys(C).indexOf(A.t)&&Object(v.z)(e,c,y.etn,A.t)){var $=Object(s.ab)(e,i,f);$&&$[A.t]&&(C[A.t]=q)}}else{if(ue(r,F),Object(Q.c)(e,K.Rc))return Promise.reject(Object(V.b)(e,i,2200000009))}}}var ee=Object(Q.c)(e,K.L),te=C;ee&&(te=function(e,t,r,n,a){var i={},o=Object(E.w)(n),c=Object(s.P)(e,o,t,r);for(var l in a)if(c&&c.hasOwnProperty(l)){var u=Object(p.a)(e,t,l);if(!(u&&u.ParentPicklistLogicalName)&&!Object(X.a)(e,n,r,t,c,l,{name:l,value:0})){i[l]=a[l];var d=[];for(u&&u.ChildPicklistLogicalNames&&(d=d.concat(u.ChildPicklistLogicalNames));d&&d.length>0;){var h=d.pop();if(a.hasOwnProperty(h)){var g=Object(p.a)(e,t,h),f=JSON.parse(a[g.ParentPicklistLogicalName]),m=JSON.parse(a[h]);Object(H.a)(e,r,n,g,t,f,m)&&(i[h]=a[h],g.ChildPicklistLogicalNames&&g.ChildPicklistLogicalNames.length>0&&(d=d.concat(g.ChildPicklistLogicalNames)))}}}}else i[l]=a[l];return i}(e,c,i,f,C));var re=ge(te);if(P.length>0)return Promise.all(P).catch((function(e){if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)})).then((function(){return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",n),Promise.resolve(null)}));return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",n),Promise.resolve(null)}(S(),_,L,g,t,F,w,e,r,Pe,Ie)}if(q&&q.Controls&&q.Controls.notescontrol){var Te=Object(l.g)(C,t);L.info("loadTimelineConfigAndMetaData started.",g),_(Object(x.b)(q.Controls.notescontrol,Te,n)).then((function(){L.info("loadTimelineConfigAndMetaData completed.",g)}))}if(q&&q.Controls)for(var xe in q.Controls)if(q.Controls[xe]){if(q.Controls[xe].Id&&q.Controls[xe].Id.startsWith("WebResource"))for(var Ee=0,Fe=q.Controls[xe].Parameters;Ee<Fe.length;Ee++){var we=Fe[Ee];if("Url"===we.Name){var Ne=!1;if(c)for(var Ae=0,ke=c;Ae<ke.length;Ae++){var Me=ke[Ae],De=we.Value&&we.Value.toLowerCase()||"";if(De.length>=Me.length&&De.length-Me.length===De.lastIndexOf(Me)){Ne=!0;break}}if(!Ne){var Re=Object(N.j)(C,we.Value);Re&&!Re.Name&&(L.info("retrieveWebResourceDescriptorByName started.",g),_(Object(B.c)(we.Value)).then((function(){L.info("retrieveWebResourceDescriptorByName completed.",g)})))}}}a.a.equals(q.Controls[xe].ClassId,D.rb)&&C&&void 0===C.currentServerTime.serverTimeDiffInSeconds&&(L.info("retrieveServerTime started.",g),_(Object(R.b)(new u.a(F))).then((function(){L.info("retrieveServerTime completed.",g)})))}return null!=y?y:(L.info("initializeForm completed.",g),Promise.all(G))},getFailureParameters:function(e,t){return g}}}function ae(e,t,r,a,i,o,s){var c=t(Object(f.f)(o,!1,[])).then((function(){var r=Object(v.h)(e(),o);if(r.IsChildEntity){var n=Object(O.d)(e(),r);return t(Object(f.f)(n.EntityLogicalName,!1,[]))}})),u=function(){var i=e();if(!Object(O.b)(i,o))return ie(2200000001,t,r,a,i,s);var c=Object(O.c)(i,o),u=Object(n.d)(i);return c&&Object(l.m)(i,s)&&!u?ie(2200000002,t,r,a,i,s):void 0};return c?c.then(u):Promise.resolve(u())}function ie(e,t,r,n,a,i){var o=Object(V.d)(e);return t(Object(F.e)(o)).then((function(){var t=Object(V.c)(e);if(r){var s=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.debug(t,s)}var c=Object(G.e)(a,o),l=Object(G.c)(c,o[0]),u=Object(G.c)(c,o[1]);throw Object(V.b)(a,i,e,t,l,u)}))}function oe(e,t,r,n,a,i,o,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);var f=Object(p.d)(e,r);if(f){for(var m=function(e){return e&&e.OptionSet&&Object.keys(e.OptionSet).length>0},b=Object(l.g)(e,n).id,v=new u.a(r,b),y={},_=Object(s.ac)(e,n,o),S=function(t){var r=f[t];if(r&&(a.indexOf(t)>=0&&i.indexOf(t)>=0||m(r))&&!Object(s.X)(e,n,o,_,v,r.LogicalName)){switch(t){case A.q:var c=Object(d.q)(e),l=Object(d.t)(e);if(c&&l){var p=new u.a(w.a,c,l);y[t]=p}break;case A.w:if(!Object(M.d)(e,_,null,A.w)){var h=Object(d.b)(e);if(h){var g=new u.a(w.b,h.transactionCurrencyId,h.currencyName);y[t]=g}}}if(m(r)){var b=Object(M.d)(e,_,new u.a(r.EntityLogicalName),t),S=b?parseInt(b.valueString,10):null!=r.DefaultValue?r.DefaultValue:t===A.u?0:void 0;if(void 0===S||S<0||(y[t]=S),t===A.u&&-1!==a.indexOf(A.v)){var O=f[t];if(O&&O.OptionSet&&Object.keys(O.OptionSet).length>0){var C=r.OptionSet.find((function(e){return e.Value===S})),I=C?C.DefaultStatus:f[A.v].DefaultValue||0;I<0||(y[A.v]=I)}}}}},O=0,C=a.concat(i);O<C.length;O++){S(C[O])}var I=ge(y);t(Object(h.a)(n,I,!0,!0)),c.info("autoPopulateFields completed.",g)}else c&&c.warn("attributes is null.",g)}function se(e,t,r,n,i,o,s){var c=Object(l.g)(e,n).id,p=new u.a(r,c),d={};if(a.a.isNullOrEmpty(p.id)&&!s)return function(e,t,r,n,i){var o=Object(y.d)(e,r);if(null!=o)return Promise.resolve(o);return t(Object(L.a)(a.a.EMPTY,new u.a(r,a.a.EMPTY))).then((function(e){return e&&e.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)})).catch((function(e){var t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:r},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return n.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),n.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)}))}(e,t,r,i,o).then((function(e){e&&(d.processid=e.guid);var r=ge(d);return t(Object(h.a)(n,r,!0,!0)),Promise.resolve()}));s&&(d.processid=s);var g=ge(d);return t(Object(h.a)(n,g,!0,!0)),Promise.resolve()}function ce(e,t,r){var n=t;!t.match(/id$/i)&&t.indexOf(Y.d)>-1&&(n+="id");var i=e[n];if(null!=i){if(a.a.validate(i)){var o=i,s=e[t+"name"],c=e[t+"type"]||e[t+"target"];return!c&&r.Targets&&r.Targets.length>0&&(c=r.Targets[0]),le(c,o,s)}try{var l=JSON.parse(i);if(l)return le(l.entityType,l.id,l.name)}catch(e){}}return null}function le(e,t,r){if(e&&t&&a.a.validate(t)){var n=new a.a(t);if(!a.a.isNullOrEmpty(n))return new u.a(e,n,r)}return null}function ue(e,t,r){if(e){var n=[{name:"key",value:t},{name:"source",value:r}];e.warn("Value passed is not in correct syntax.",n)}}function pe(e,t,r,n,a,i,o,s){return de(e,t,r,n,i,o,s).then((function(){return he(e,t,r,a,i,o,s)}))}function de(e,t,r,n,a,i,o){return!Object(s.Eb)(e,a)&&Object($.n)(e,a)?(i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,a,2200000008,"Page has expired."))):(i&&i.info("loadScripts started.",o),r(t.ScriptManager.getContainer(a).getEventManager().loadScripts(n,a)).then((function(){i&&i.info("loadScripts completed",o)})))}function he(e,t,r,n,a,i,o){if(Object(s.Eb)(e,a)||!Object($.n)(e,a)){i&&i.info("runFormOnLoadScripts started.",o);var c=t.ScriptManager.getContainer(a).getEventManager();r(c.addPblEvent(n)),r(c.runOnLoad(n,1)),r(c.runOnDataLoad(n,1)),i&&i.info("runFormOnLoadScripts completed.",o)}else i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",o)}function ge(e){var t={};for(var r in e){var n={fieldName:r,value:e[r]};t[r]=n}return t}function fe(e,t,r,n,a,i,s,c,l){var p=Object(E.j)(e,a),d=Object(E.x)(p);return i&&i.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,r,n,a){return{type:"snapshot.from.async",execute:function(i,s){var c=i.dispatch,l=i.getState,p=s.DataSource,d=u.a.toLegacyEntityReference(e),h=new _.a(d,t,S.a.All),O=p.execute(h,null).nativePromise(),C=null,I=null,j=null;return O.then((function(e){var r=e.get_entity();return C=Object(g.a)(r),I=C.fields,j=C.identifier,c(Object(f.f)(t,!1,Object.keys(C.fields)))}),(function(e){var r=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||r&&-2147217919===r.getNegativeErrorCode())&&n){var i=[];if(I={},n.etn){var s=Object(v.c)(l(),n.etn,t);if(s)for(var p=0,d=s;p<d.length;p++){var h=d[p];h.ReferencingAttribute&&i.push(h.ReferencingAttribute)}}else a&&i.push(a.attributeName);for(var g=0,m=i;g<m.length;g++){var b=m[g];if(!n.name&&n.id){var _=Object(y.h)(l(),n.etn,n.id.guid);if(_&&_.fields){var S=Object(v.E)(l(),n.etn),O=_.fields[S];O&&O.value||(O=_.fields.name),O&&O.value&&(n={etn:n.etn,id:n.id,name:O.value})}}I[b]={reference:n,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return j=new u.a(t),c(Object(f.f)(t,!1,i))}Object(o.b)(e)})).then((function(){var e=Object(m.b)(l(),j,I,r,b.a.Create),t=e.payload.snapshotId;return c(e),t}))}}}(r,n,d,c,l)).then((function(e){i&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(C.b)(a,e,p)).then((function(){i&&i.info("createAndSetDataSnapshotFrom completed.",s)}))}))}function me(e,t,r){var n={};if(r&&r.Attributes&&t){var a=Object(N.d)(e,r.FormLibraries,[t]);if(r.Attributes||a){var i=[].concat(r.Attributes,a);-1===i.indexOf(A.u)&&i.push(A.u),n=be(e,t,i)}}return{attributes:n,submitModes:{}}}function be(e,t,r){var n={};if(r&&t)for(var a=0;a<r.length;a++){var i=r[a];if(i){var o=Object(s.L)(e,t,i);o&&(n[i]=o)}}return n}function ve(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function ye(e,t,r){var n={},a={},i={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0},u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames)for(var p=!1,d=0,h=Object(s.m)(e,t);d<h.length;d++){var g=h[d],f={collapsed:!!p||!(g.Expanded&&g.Visible),visible:g.Visible,label:g.Label,sectionNames:[],domId:g.DomId,showLabel:g.ShowLabel,contentType:null};switch(g.ContentType){case"expandAvailableSpace":case"singleComponent":f.contentType="singleComponent";break;default:f.contentType="cardSections"}p=p||g.Expanded&&g.Visible;var m=[];if(g.Columns)for(var b=0;b<g.Columns.length;b++){var v=g.Columns[b];if(v.SectionNames)for(var y=0;y<v.SectionNames.length;y++){var _=v.SectionNames[y];if(t.Sections[_]){var S=t.Sections[_];m.push(_);for(var O=[],C=0,j=t.Sections[_].Rows;C<j.length;C++)for(var P=0,T=j[C].Cells;P<T.length;P++){var x=T[P];x.ControlName&&O.push(x.ControlName)}var E={parentTabId:g.Id,visible:S.Visible,label:S.Label,controlNames:O,domId:S.DomId,semanticZoomDomId:S.SemanticZoomDomId};a[_]=E;for(var F=0;F<O.length;F++){var w=O[F];if(t.Controls[w]){var N=t.Controls[w],A=_e(N,_,!0),k=Object(c.a)(N,t,Object(q.b)(e));null!=k&&(A.visible=A.visible||k.ShouldOverrideControlVisible),Oe(A),i[w]=A}}}}}if(g.Header)for(var M=0,D=g.Header;M<D.length;M++){i[(z=D[M]).Name]=_e(z,null,!0)}if(g.Footer)for(var R=0,L=g.Footer;R<L.length;R++){i[(H=L[R]).Name]=_e(H,null,!0)}f.sectionNames=m,n[g.Id]=f}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){var B=ve(t.Header);if(B)for(var V=0,G=B;V<G.length;V++){var z;i[(z=G[V]).Name]=_e(z,null,!0),Oe(i[z.Name])}o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){var W=ve(t.Footer);if(W)for(var U=0,X=W;U<X.length;U++){var H;i[(H=X[U]).Name]=_e(H,null,!0),Oe(i[H.Name])}l.visible=!1!==t.Footer.Visible}return{formId:r,tabs:n,sections:a,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:l}}function _e(e,t,r){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:r,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Se(e,t,r,n,i,o,c,l,u){void 0===l&&(l=null);var p=Object(s.cb)(e,o,c),d=Object(ee.a)(e,o);a.a.equals(null==p?void 0:p.formId,null==n?void 0:n.formId)&&a.a.equals(r,null==d?void 0:d.formId)||t(function(e,t,r,n,a,i,o){void 0===i&&(i=null);return{type:te,payload:{formId:e,formUIState:t,formMetadataState:r,relatedEntityMetadataState:i,currentLanguageId:o},meta:{pageId:n,contextToken:a}}}(r,n,i,o,c,l,u))}function Oe(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},"8ADW":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Chart.Component",a="ViewId",i="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",p="RETRIEVECHARTTS_RETRIEVECHARTODATA"},"8Fmj":function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("9r0m"),a=r("G7N+"),i=r("KDdL"),o=r("7dGM"),s=r("8ADW"),c=r("z9yS"),l=r("Xlzu"),u=r("t8f4"),p=r("QAhb"),d=r("xhI+"),h=r("/j9Z"),g=r("Fpc+"),f=r("Kn4q"),m=r("zEjV"),b=r("S2mk"),v=r("cZkS"),y=r("qC0c");function _(e,t,r){void 0===t&&(t=c.a.savedvisualization);var d=[];return d.push({name:s.f,value:e}),d.push({name:s.i,value:t}),d.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(g,b){var _=g.dispatch,S=g.getState;try{var C=f.a.LocalAndRemote,P=b.TraceManager.getTracer(s.d),E=b.DataSource,F=S(),w=r;if(P.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){return b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error("entityTypeName is null"),s.d,d),Promise.reject("entityTypeName is null")}n.a.isNullOrEmpty(w)&&(w=Object(o.j)(F,e));var N=Object(y.c)(S(),v.A);if(!n.a.isNullOrEmpty(w)){var A=Object(o.f)(F,w),k=Object(o.g)(F,w);if(A===a.a.Initialized){if(function(){var r=Object(o.a)(F,w),n=function(e,t,r,n){var a=c.a[r],i=Object(o.i)(e,t);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][n.guid]}(F,e,t,w),a=n&&!n.IsUserChart;switch(Object(l.d)(F,a,r,(function(){return n}))){case 1:C=f.a.Remote;break;case 2:_(function(e,t,r){var n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute:function(e,a){var o=e.dispatch;e.getState;try{return o(Object(l.b)(c.a[r],null,t,null,!0,m.a.OnDemandWithContext,null,null,[],null,f.a.LocalAndRemote)).catch(h.b)}catch(e){throw a.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),s.e,n),e}}}}(0,e,t))}}(),C!==f.a.LocalAndRemote)return I(_,E,e,w,t,C,b,d);if(N&&k===a.a.Uninitialized){var M=new p.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",w),D=Object(o.a)(F,w);return _(O(w,a.a.Initialized)),_(Object(u.d)(M)).catch(h.b).then((function(e){return j(D,e),_(T(e)),b.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(w)}),(function(e){return x(_,e,w.guid,D,b,d),Promise.resolve(w)}))}return Promise.resolve(w)}return I(_,E,e,w,t,C,b,d)}return I(_,E,e,w,t,C,b,d)}catch(e){throw b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,d),e}}}}function S(e){return{type:"chart.dependencies.update.async",execute:function(t,r){var a=t.dispatch,i=t.getState,s=[];for(var c in e)s.push(e[c]+":name");return s.length>0?a(Object(d.a)(s)).then((function(){var t=new Map,r=i();for(var s in e){var c=e[s],l=Object(o.a)(r,new n.a(c));l&&c&&r.metadata.labels&&r.metadata.labels[c]&&r.metadata.labels[c].name&&(l.Name=r.metadata.labels[c].name,t.set(c,l))}t.size>0&&a(function(e){var t={};return e.forEach((function(e,r){t[r]=e})),{type:"chart.descriptor.update",payload:{charts:t}}}(t))}),h.b):Promise.resolve()}}}function O(e,t){var r,i=n.a.isNullOrEmpty(e)?null:{charts:(r={},r[n.a.toString(e)]={initialized:t,oDataInitialized:a.a.Initializing},r)};return{type:g.f,payload:i}}function C(e,t,r,o,d){void 0===o&&(o=c.a.savedvisualization);var g=[];return g.push({name:s.f,value:t}),g.push({name:s.i,value:o}),g.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(e,s){var f=e.dispatch,b=e.getState;return Object(y.c)(b(),v.A)?r?function(e,t,r,o,s,d,g){var f=new p.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,a.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,m.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b),e(Object(u.d)(f)).catch(h.c)]).then((function(t){return t[1].constructor===h.a?x(e,t[1],r.guid,t[0].charts[r.guid],d,g):(j(t[0].charts[r.guid],t[1]),e(T(t[1])),d.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]}))}(f,t,r,o,d,s,g):function(e,t,r,o,s,d,g){return e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,m.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b).then((function(t){var r=new n.a(Object.keys(t.charts)[0]),s=new p.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(O(r,a.a.Initializing)),e(Object(u.d)(s)).catch(h.b).then((function(n){return j(t.charts[r.guid],n),e(T(n)),d.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t}),(function(n){return x(e,n,r.guid,t.charts[r.guid],d,g),t}))}))}(f,t,r,o,d,s,g):function(e,t,r,a,i){return e(Object(l.b)(c.a[a],null,t,n.a.toLegacyGuid(r),!0,m.a.OnDemandWithContext,null,null,[],null,i)).catch(h.b)}(f,t,r,o,d)}}}function I(e,t,r,o,c,l,u,p){var d,f,m;return e((d=o,m=n.a.isNullOrEmpty(d)?null:{charts:(f={},f[n.a.toString(d)]={initialized:a.a.Initializing},f)},{type:g.b,payload:m})),e(C(0,r,o,c,l)).then((function(t){t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:a.a.Initialized,chartTypes:{}});var s=[];for(var c in t.charts)s.push(c);return e(S(s)).then((function(){return e(P(t)),n.a.isNullOrEmpty(o)&&(o=t.chartDefaults[r]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),o}),h.b)}),(function(t){var c,l,d=t&&!Object(b.j)(t.errorCode)&&t.errorCode,g={chartSelectors:(c={},c[r]={initialized:a.a.Initialized,chartTypes:{}},c)};if(e(P(g)),Object(b.j)(d))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),s.d,p),Object(h.b)(t);var f={charts:(l={},l[n.a.toString(o)]={initialized:a.a.Error,errorCode:d},l)};e(P(f))}))}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=a.a.Initialized}function P(e){return{type:g.b,payload:e}}function T(e){return{type:g.f,payload:e}}function x(e,t,r,n,o,c){var l;e(T({charts:(l={},l[r]={initialized:n.initialized,oDataInitialized:a.a.Error},l)})),o.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),s.c,c)}},"8VL5":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("uO/V"),a=r("/j9Z"),i="customcontrol.refreshCustomDataProvider";function o(e,t,r,o){return{type:"customcontrol.refreshCustomDataProvider.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,n.x+".refreshCustomDataProviderAction");return o().then((function(n){return l(function(e,t,r,n){var a=new Array;n&&n.length>0&&(a=n.slice());return{type:i,payload:a,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),c.EventManager.ReportComponentSuccess(u),n})).catch((function(e){return c.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new a.a(e))}))}}}},"90Ov":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(n.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},"9LTA":function(e,t,r){"use strict";r.d(t,"b",(function(){return Oe})),r.d(t,"d",(function(){return Ce})),r.d(t,"e",(function(){return Ie})),r.d(t,"c",(function(){return je})),r.d(t,"a",(function(){return Pe}));var n=r("0RbL"),a=r("9r0m"),i=r("G7N+"),o=r("KDdL"),s=r("c/eZ");var c=r("70DF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var l=r("QAhb"),u=r("VcAV"),p=r("+h4s"),d=function(){function e(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}return e.prototype.addAggregator=function(e,t,r,n,i){if(r>=c.a.DAY&&r<c.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,i);else if(r===c.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,i);else if(r===c.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,i);else{var o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(o.FieldName=e,o.EntityName=n,o.LinkEntityExpressionArray=i,Object(u.c)(t))o.Value=null;else if(t instanceof l.a){var s=t;o.Value=s.id.guid,o.DisplayName=s.name,o.EntityLogicalName=s.etn}else t instanceof a.a?o.Value=a.a.toString(t):o.Value=t.toString();this._dataPointAggregators.push(o)}},e._daysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype._addDataPointFiscalPeriodAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");var i=t.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}else this._dataPointFiscalPeriodAggregators.push(a)},e.prototype._addDataPointFiscalYearAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");a.Year=Number(t),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)},e.prototype._addDateTimeRangeAggregatorInfo=function(e,t,r,n,a){var i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||c.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=n),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),r){case c.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case c.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case c.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case c.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case c.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(r,i.dateTimeAggregatorPrecision)},e.prototype._getDataPointDateTimeRangeAggregators=function(t,r){var n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((function(a,i){var o,s={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};if(s.FieldName=a.dateTimeAggregatorFieldName,s.EntityName=a.dateTimeAggregatorEntityName,s.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:e._daysInMonth(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),s.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case c.a.DAY:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth(),s.MaxDate.getDate());break;case c.a.WEEK:r===p.a.FirstFullWeekOfTheYear&&(r=p.a.FirstDayOfTheYear);var l=Object(p.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,t,r),u=Object(p.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,t,r);if(u.setDate(u.getDate()-1),r===p.a.FirstDayOfTheYear)if(u>=new Date(a.dateTimeAggregatorYear+1,0,1))u=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){var d=new Date(a.dateTimeAggregatorYear,0,1);l<d&&(l=d)}s.MinDate=l,s.MaxDate=u,h(s.MaxDate),h(s.MinDate);break;case c.a.MONTH:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-1,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth())+1),h(s.MaxDate),h(s.MinDate);break;case c.a.QUARTER:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-3,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth()-2)+1),h(s.MaxDate),h(s.MinDate);break;case c.a.YEAR:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear()-1,s.MaxDate.getMonth(),s.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(s)}else n.push(s)})),n},e.prototype.getAggregators=function(e,t){var r=this._dataPointAggregators,n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r},e}();function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var g=r("Ww2r"),f=r("dUXI"),m=r("7EJx"),b=r("otJc"),v=r("yGoS"),y=r("EGsq"),_=r("F2uj"),S=r("uXKh"),O=r("sRkF");function C(e,t){var r=Object(_.a)(e,t.entity.entityName,t.attributeName),n=r?r.DisplayName:null;n||(n=t.attributeName);var a=n;if(t.dateTimeGrouping){var i=v.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(g.b)(e,f.c),Object(g.b)(e,f.c+"."+i.toUpperCase()),n)}else t.hasAggregate&&t.aggregateType&&(a=String.format(Object(g.b)(e,f.d),Object(g.b)(e,f.d+"."+t.aggregateType.toUpperCase()),n));if(r&&"money"===r.Type){var o="",s=null,c=Object(y.x)(e);r.IsBaseCurrency?c&&c.baseCurrencyId&&c.transactionCurrencyById&&(s=c.transactionCurrencyById[c.baseCurrencyId.guid]):t.hasAggregate&&(s=Object(m.b)(e)),s&&(o=c&&c.currencyDisplayOption===S.a.CurrencyCode?s.currencyCode:s.currencySymbol),o&&(a=String.format(Object(g.b)(e,f.b),a,o))}return a}function I(e,t,r){return r>0?String.format(Object(g.b)(e,f.y),r,t):String.format(Object(g.b)(e,f.w),t)}function j(e,t,r,n,a){var i=a<1&&n>=1&&r<1,o=a<1&&n<1&&r>=1,s=n<1&&r<1;if(a>=1&&n<1&&r>=1){var c=new Date(t,r-1,a),l=Object(m.w)(e),u=l.formatInfoCultureName,p=l.numberFormatInfo,d=l.dateFormatInfo,h=new Sys.CultureInfo(u,p,d);return Object(b.s)(c,h,O.a.None)}return i?String.format(Object(g.b)(e,f.z),n,t):o?String.format("{0} {1}",function(e){var t=Object(g.b)(e,f.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):s?String(t):""}function P(e){return Object(g.b)(e,f.v)}var T=r("9rlF"),x=r("+Z9T");function E(e,t,r){var n=!1;return r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0),{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function F(e,t){var r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(T.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return j(e.state,a,n,-1,r)}(e,t);case c.a.WEEK:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,-1,r,-1)}(e,t);case c.a.MONTH:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,r,-1,-1)}(e,t);case c.a.QUARTER:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case c.a.FISCAL_PERIOD:return function(e,t){return Object(T.e)(t.fields[e.aliasName])}(e,t);case c.a.YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return j(e.state,r,-1,-1,-1)}(e,t);case c.a.FISCAL_YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return I(e.state,r,-1)}(e,t);default:return Object(T.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=(r=Object(T.c)(t.fields[e.aliasName]))||""),0===r.length?Object(g.b)(e.state,f.v):r}function w(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return F(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":var r=Object(T.e)(t.fields[e.aliasName]);return r=Object(x.a)(r)?-1:Number(r);case"datetime":return function(e,t){var r=-1,n=-1,a=-1;switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case c.a.MONTH:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.YEAR:a=Object(T.e)(t.fields[e.aliasName]);break;case c.a.QUARTER:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.WEEK:r=1+7*(Object(T.e)(t.fields[e.aliasName])-1),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return F(e,t)}return new Date(a,n-1,r).getTime()}(e,t);default:return F(e,t)}}function N(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function A(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k=function(e){function t(r,n,a){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.title=n,i.description=a,i}return Object(s.__extends)(t,e),t}(Error),M=r("qC0c"),D=r("cZkS"),R=r("glw0"),L=r("scgP"),B=r("WS0f");function V(){return this.point.formattedValue}function G(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}var z=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"primaryGroupBy",{get:function(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryModel",{get:function(){return this._queryModel},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,r,n,a,i,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0},e.prototype.setXAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.setYAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.retrieveChartArea3DStyle=function(){var e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e},e.prototype.retrieveChartAreaGradientStyle=function(){var e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e},e.prototype.setYAxisOppositeProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.setXAxisIsReversedProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.retrieveChartYAxis=function(){var e=this,t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;for(var r=function(t,r,n){e.chartPresentationYAxis&&e.chartPresentationYAxis.length>r&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Title?t.Title=e.chartPresentationYAxis[r].Title:1===n&&(t.Title=e._queryModel.SeriesList[r].Title)},n=0,a=-1,i=-1,o=!1,s=!1,c=0;c<this.chartPresentationSeries.length;c++)this.chartPresentationSeries[c].SecondaryYAxis?(n++,i=-1===i?c:i,s=s||this.shouldDisableAllowDecimals(c)):(a=-1===a?c:a,o=o||this.shouldDisableAllowDecimals(c));return r(t[0],a,this.chartPresentationSeries.length-n),t[0].Opposite=!1,o&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},r(t[1],i,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((function(t,r){var n,a,i,o,s,c,l,u,p,d,h,g,f,m;t.Disabled=e.chartPresentationYAxis&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Disabled,t.LabelForeColor=null===(a=null===(n=e.chartPresentationYAxis)||void 0===n?void 0:n[r])||void 0===a?void 0:a.LabelForeColor,t.AxisLineColor=null===(o=null===(i=e.chartPresentationYAxis)||void 0===i?void 0:i[r])||void 0===o?void 0:o.AxisLineColor,t.AxisTitleForeColor=null===(c=null===(s=e.chartPresentationYAxis)||void 0===s?void 0:s[r])||void 0===c?void 0:c.AxisTitleForeColor,t.LabelDisabled=null===(u=null===(l=e.chartPresentationYAxis)||void 0===l?void 0:l[r])||void 0===u?void 0:u.LabelDisabled,t.AxisInterval=null===(d=null===(p=e.chartPresentationYAxis)||void 0===p?void 0:p[r])||void 0===d?void 0:d.AxisInterval,t.AxisMinimum=null===(g=null===(h=e.chartPresentationYAxis)||void 0===h?void 0:h[r])||void 0===g?void 0:g.AxisMinimum,t.AxisMaximum=null===(m=null===(f=e.chartPresentationYAxis)||void 0===f?void 0:f[r])||void 0===m?void 0:m.AxisMaximum,t=e.setYAxisMajorGridAndMajorTickProperties(t,r)})),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),t},e.prototype._isChartCustomizationParityFCBEnabled=function(){return Object(M.a)(this.getState(),D.s,D.Lc,D.w)},e.prototype.retrieveChartAnnotations=function(){for(var e=new Array(this.chartPresentationAnnotationList.length),t=0;t<this.chartPresentationAnnotationList.length;t++){var r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e},e.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o=new Array(1),s=null;this.categoryColumn.length>0&&(s=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};for(var c=new Array(this.chartData.length),l=0;l<this.chartData.length;l++){var u=this.chartData[l];if(s){if(c[l]=F(s,u),"-1"===c[l])c[l]=Object(g.b)(this.getState(),f.f);else if(!s.isDateTimeChart&&"number"==typeof Object(T.e)(u.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){var p=Object(m.w)(this.getState());c[l]=Object(L.c)(Object(T.e)(u.fields[s.aliasName]),Object(b.d)(p),this.chartPresentationXAxis[0].FormatString)}}else c[l]=P(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,o[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o},e.prototype.retrieveChartCategoryTitle=function(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?C((t=e).state,t.attribute):"";var t},e.prototype.retrieveChartSeries=function(e){for(var t=new Array(this.chartPresentationSeries.length),r=function(r){var a=n.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,i=a.aliasName?a.aliasName:a.attributeName,o=n.chartPresentationSeries[r].IsValueShownAsLabel,s=n.chartPresentationSeries[r].LabelFormat,c=null;s&&Object(L.d)(s)&&(c=Object(L.g)(s));var l=!1;n.chartPresentationSeries[r].Label&&"#percent"===n.chartPresentationSeries[r].Label.toLowerCase()&&(l=!0);var u=!1;s&&W(n.chartPresentationSeries[r].ChartType)&&Object(L.e)(s)&&(u=!0);var p=null,d=C(n.getState(),a);t[r]=n.cloneBlueprintSeriesStyle(n.chartPresentationSeries[r]),n.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),n.primaryGroupBy&&((p=[]).push(n.primaryGroupBy.groupAttribute),n.primaryGroupBy.extendedGroupBys&&n.primaryGroupBy.extendedGroupBys.forEach((function(e){p.push(e)})));for(var h=new Array(n.chartData.length),g=i,f=0,v=0;v<n.chartData.length;v++){var y=n.chartData[v];h[v]=A();var _=Object(T.e)(y.fields[i]);if(h[v].Value=_||0,f+=_||0,s){var S=Object(m.w)(n.getState()),O=Object(b.d)(S);Object(L.f)(s)?h[v].FormattedValue=Object(R.b)(h[v].Value,n.chartPresentationSeries[r].LabelFormat,O):Object(L.d)(s)&&!u?h[v].FormattedValue=Object(L.a)(h[v].Value,c,O):h[v].FormattedValue=Object(T.c)(y.fields[g])||0}else h[v].FormattedValue=Object(T.c)(y.fields[g])||0;n.attachAggregators(h[v],y,p)}var I=N();o?(I.Enabled=!0,I.LabelFormatter=V):l&&(I.Enabled=!0,I.LabelFormatter=G(f)),I.Color=n.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=I,t[r].DataPoints=h,t[r].Title=n.getChartTitleFromPresentationSeries(d,r),t[r].XAxisNumber=e,t[r].HideInLegend=n.chartPresentationSeries[r].HideInLegend,t[r].Stack=n.chartPresentationSeries[r].Stack},n=this,a=0;a<this.chartPresentationSeries.length;a++)r(a);var i=Object(m.w)(this.getState()),o=Object(b.d)(i),s=this.chartPresentationSeries[0].IsValueShownAsLabel,c=this.chartPresentationSeries[0].LabelFormat;if(s&&W(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(c))for(var l=q(c,o),u=0;u<t[0].DataPoints.length;u++)l(0,u,0,t);return t},e.prototype.getChartTitleFromPresentationSeries=function(e,t){return void 0===t&&(t=0),Object(B.b)(this.chartPresentationSeries[t].LegendText)?Object(B.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText},e.prototype.shouldDisableAllowDecimals=function(e){var t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType},e.prototype.cloneBlueprintSeriesStyle=function(e){var t,r={DataPoints:t&&t.DataPoints||null,DataLabels:t&&t.DataLabels||null,ChartType:t&&t.ChartType||"line",YAxisNumber:t&&t.YAxisNumber||0,XAxisNumber:t&&t.XAxisNumber||0,Title:t&&t.Title||"",Color:t&&t.Color||"",BorderColor:t&&t.BorderColor||"",BorderWidth:t&&t.BorderWidth||0,CustomProperties:t&&t.CustomProperties||null,Stack:t&&t.Stack||null};return r.ChartType=e.ChartType,r.Color=e.Color,r.BorderColor=e.BorderColor,r.BorderWidth=e.BorderWidth,r.CustomProperties=e.CustomProperties,r},e.prototype.attachAggregators=function(t,r,n){if(n){for(var a=new d,i=function(t){var i=n[t],o=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach((function(e){var t,r={name:t&&t.name||null,from:t&&t.from||null,to:t&&t.to||null,linkType:t&&t.linkType||null,alias:t&&t.alias||null};r.name=e.entityName,r.from=e.linkFromAttribute,r.to=e.linkToAttribute,r.linkType=e.joinType.toString(),r.alias=e.alias,o.push(r)})),a.addAggregator(i.attributeName,Object(T.e)(r.fields[e._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,o)},o=0;o<n.length;o++)i(o);var s=Object(m.w)(this.getState()),c=this._getFirstDayOfWeekFromUserSettings(s),l=this._getCalendarWeekRuleFromUserSettings(s);t.Aggregators=a.getAggregators(c,l)}},e.prototype._getFirstDayOfWeekFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0},e.prototype._getCalendarWeekRuleFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0},e.prototype.getFormatterPropertiesForAttribute=function(e){return Object(b.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))},e._getFieldName=function(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName},e.prototype.isChartDrillable=function(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(var e=0,t=this.chartDataDescription.category.measureCollections;e<t.length;e++)for(var r=0,n=t[e].secondaryGroupBys;r<n.length;r++){var a=n[r];if(!this._isGroupByDrillable(a))return!1}return!!this.chartDataDescription.entityExpression.hasAggregate},e.prototype._isGroupByDrillable=function(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))},e.prototype._isAttributeDrillable=function(e){var t,r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(n,r,this.getState())},e.prototype._validateChartAggregateAttributes=function(){for(var e,t,r,n,a=0;a<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);a++){var i=this.chartDataDescription.entityExpression.aggregateAttributes[a],o=null===(n=null==i?void 0:i.entity)||void 0===n?void 0:n.entityName,s=null==i?void 0:i.attributeName,c=Object(_.b)(s,o,this.getState());if(!("date"!==c&&"datetime"!==c||"min"!==i.aggregateType&&"max"!==i.aggregateType)){var l=String.format(Object(g.b)(this.getState(),f.h),s);throw new k("ChartError",l,l)}}},e}();function W(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function q(e,t){return function r(n,a,i,o){if(n===o.length)return i;var s=o[n].DataPoints[a];return i=r(++n,a,i+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(L.a)(s.Value/i*100,Object(L.g)(e),t)),i}}var U=r("lMVv"),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");var a=new Array(0),i=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(var c=0;c<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;c++)a.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[c]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");for(var l=this._addSecondaryGroupByToFieldAggregators(s,a),u=s.measures[0].measureAttribute,p=u.aliasName?u.aliasName:u.attributeName,d=p,h=o.primaryGroupBy.groupAttribute,g=E(this.getState(),this._getGroupByAttribute(h,o.primaryGroupBy),o.primaryGroupBy),f=new Array,v=new Array,y=new Map,_=0;_<this.chartData.length;_++){var S=F(g,D=this.chartData[_]),O=F(l,D),C=void 0;C=null==O?O=P(this.getState()):w(l,D),i.set(C,O),v.indexOf(S)<0&&v.push(S),f.indexOf(C)<0&&f.push(C)}f.forEach((function(e){var t=new Array(v.length);y.set(e,t)}));var I=Object(m.w)(this.getState()),j=this.chartPresentationSeries[0].LabelFormat,k=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(k=!0);var M=!1;j&&W(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(j)&&(M=!0);for(_=0;_<this.chartData.length;_++){var D,B=w(l,D=this.chartData[_]);Object(x.a)(B)&&(B=P(this.getState()));var z=y.get(B),U=(S=F(g,D),v.indexOf(S));if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(v[U]=Object(L.c)(Object(T.e)(D.fields[g.aliasName]),Object(b.d)(I),this.chartPresentationXAxis[0].FormatString)),z[U]=A(),z[U].Value=Object(T.e)(D.fields[p]),j){var X=Object(b.d)(I);Object(L.f)(j)?z[U].FormattedValue=Object(R.b)(z[_].Value,j,X):Object(L.d)(j)&&!M?z[U].FormattedValue=Object(L.a)(z[U].Value,Object(L.g)(j),X):z[U].FormattedValue=Object(T.c)(D.fields[d])||0}else z[U].FormattedValue=Object(T.c)(D.fields[d])||0;this.attachAggregators(z[U],D,a)}f.forEach((function(e){for(var t=y.get(e),r=0;r<v.length;r++)t[r]||(t[r]=A())}));var H=new Array(1);H[0]={},H[0].Title=this.retrieveChartCategoryTitle(g),H[0].Values=v,H[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,H[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,H[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,H[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,H[0]=this.setXAxisMajorGridAndMajorTickProperties(H[0]),H[0]=this.setXAxisIsReversedProperty(H[0]),this._sortComparisonCodes(s,f);for(var K=new Array(f.length),Q=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,Y=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,J=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,Z=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name),$=function(e){var t=f[e];if(K[e]=ee.cloneBlueprintSeriesStyle(ee.chartPresentationSeries[0]),K[e].Title=Z||i.get(t),K[e].DataPoints=y.get(t),K[e].HideInLegend=J,Q)(r=N()).Enabled=!0,r.LabelFormatter=V,K[e].DataLabels=r,r.Color=Y;else if(k){var r,n=0;K[e].DataPoints.forEach((function(e){n+=e&&e.Value?e.Value:0})),(r=N()).Enabled=!0,r.LabelFormatter=G(n),K[e].DataLabels=r,r.Color=Y}},ee=this,te=0;te<f.length;te++)$(te);if(Q&&M)for(var re=q(j,X=Object(b.d)(I)),ne=0;ne<H[0].Values.length;ne++)re(0,ne,0,K);this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=H,this.queryModel.YAxes=this._retrieveChartYAxis(u),this.queryModel.SeriesList=K,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()},t.prototype._sortComparisonCodes=function(e,t){e.secondaryGroupBys[0].descending?t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)})):t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t)}))},t.prototype._getGroupByAttribute=function(e,t){return e.attributeName!==Object(U.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e},t.prototype._addSecondaryGroupByToFieldAggregators=function(e,t){var r=e.secondaryGroupBys[0].groupAttribute,n=E(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(var a=0;a<e.secondaryGroupBys[0].extendedGroupBys.length;a++)t.push(e.secondaryGroupBys[0].extendedGroupBys[a]);return n},t.prototype._retrieveChartYAxis=function(e){var t,r,n,a,i,o,s,c,l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=C(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),l[0].AxisInterval=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisInterval,l[0].AxisMinimum=null===(o=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l},t}(z),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o,s,c=new Array(1);if(this.chartData.length<1)return c;var l=this.primaryGroupBy.groupAttribute;c[0]={};var u=new Array(this.chartData.length),p=E(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(p),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(var d=0;d<this.chartData.length;d++){var h=this.chartData[d];u[d]=F(p,h),p.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[d]!==Object(g.b)(p.state,f.v)&&(u[d]=Object(L.b)(new Date(u[d]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c},t}(z),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t}(z);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Q=r("Je7O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Y(e){var t={};try{if(e){var r=/\w+=\w+/;e.split(/\s*,\s*/).forEach((function(e){if(e&&r.test(e)){var n=e.split("="),a=n[0],i=n[1];t[a]=i}}))}}catch(t){throw"Failed to parse chart custom properties, value: "+e+" "}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var J=r("S2mk"),Z=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $(e,t,r){var n=(new DOMParser).parseFromString(t,"text/xml");return function(e,t){var r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new k("ChartError",Object(g.b)(t,f.t),Object(g.b)(t,f.s))}(n,e),{chartPresentationSeries:ee(e,n,r),chartPresentationLegendList:ne(n),colorsList:re(n),chartPresentationArea3DStyle:ce(n),chartPresentationAreaGradientStyle:le(n),chartPresentationXAxis:ie(n),chartPresentationYAxis:oe(n),chartPresentationAnnotationList:ae(n)}}function ee(e,t,r){for(var n=new Array,a=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer,o=0;o<a.length;o++){var s=a[o],c={},l=s.getAttribute("ChartType")||"Column";if(-1===Z.indexOf(l.toUpperCase()))throw new k("ChartError",Object(g.b)(e,f.t),Object(g.b)(e,f.t));c.ChartType=l;var u=s.getAttribute("Color");c.Color=u?ue(u):null;var p=s.getAttribute("LegendText");c.LegendText=p||null;var d=s.getAttribute("CustomProperties");c.CustomProperties=Y(d);var h=s.getAttribute("BorderColor");c.BorderColor=h?ue(h):null;var m=s.getAttribute("BorderWidth");c.BorderWidth=m?Number(m):null;var b=s.getAttribute("IsValueShownAsLabel");c.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,c.Label=s.getAttribute("Label");var v=s.getAttribute("YAxisType");c.SecondaryYAxis=v&&"secondary"===v.toLowerCase();var y=s.getAttribute("IsVisibleInLegend");c.HideInLegend=y&&"false"===y.toLowerCase();var _=s.getAttribute("LabelForeColor");c.LabelForeColor=_?ue(_):null,c.LabelFormat=s.getAttribute("LabelFormat");var S=te(e,s.outerHTML||i.serializeToString(s),r);c.Name=S||null,c.Stack=c.CustomProperties.StackedGroupName,n.push(c)}return n}function te(e,t,r){var n=Object(o.a)(t);if(Object(J.j)(n)||n.length<5)return"";var a=n[2].toLowerCase(),i=n[4],s="",c=a.substring(0,r.length);if(c!==r)return"";var l=a.substring(r.length+1,a.length),u=Object(_.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter((function(e){return e.Value.toString().toLowerCase()===i.toLowerCase()}))[0].Label),s}function re(e){var t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach((function(e){if(e){var r=ue(e);t.push(r)}})),t}function ne(e){for(var t=new Array,r=e.querySelectorAll("Chart Legends Legend"),n=0;n<r.length;n++){var a={},i=r[n].getAttribute("Enabled");a.Enabled=null===i||"True"===i,t.push(a)}return t}function ae(e){for(var t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation"),n=0;n<r.length;n++){var a=r[n],i={},o=a.getAttribute("X");i.X=o?Number(o):null;var s=a.getAttribute("Y");i.Y=s?Number(s):null,i.Text=a.getAttribute("Text");var c=a.getAttribute("ForeColor");i.ForeColor=c?ue(c):null,t.push(i)}return t}function ie(e){for(var t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX"),n=0;n<r.length;n++){var a=r[n],i={};se(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");var o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){var s=null==o?void 0:o.getAttribute("ForeColor"),c=null==o?void 0:o.getAttribute("Enabled");i.LabelForeColor=s?ue(s):null,i.LabelDisabled=c&&"false"===c.toLowerCase(),i.FormatString=o.getAttribute("Format")}var l=a.getAttribute("Enabled"),u=a.getAttribute("LineColor"),p=a.getAttribute("TitleForeColor");i.Disabled=l&&"false"===l.toLowerCase(),i.AxisLineColor=u?ue(u):null,i.AxisTitleForeColor=p?ue(p):null,i.Disabled=l&&"false"===l.toLowerCase();var d=a.getAttribute("IsReversed");i.IsReversed=d&&"true"===d.toLowerCase(),t.push(i)}return t}function oe(e){var t=new Array,r=function(e,r){var n,a,i={};if(e){var o=e;i.Title=o.getAttribute("Title"),se(i,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);var s=o.getAttribute("Enabled");i.Disabled=s&&"false"===s.toLowerCase();var c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;var p=o.querySelectorAll("LabelStyle");p&&p[0]&&p[0].getAttribute("Format")&&(i.FormatString=p[0].getAttribute("Format"));var d=null===(n=null==p?void 0:p[0])||void 0===n?void 0:n.getAttribute("ForeColor");i.LabelForeColor=d?ue(d):null;var h=null===(a=null==p?void 0:p[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=h&&"false"===h.toLowerCase();var g=o.getAttribute("LineColor");i.AxisLineColor=g?ue(g):null;var f=o.getAttribute("TitleForeColor");i.AxisTitleForeColor=f?ue(f):null,t.splice(r,0,i)}else t.splice(r,0,i)},n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),(n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"))&&r(n[0],1),t}function se(e,t,r){if(e){if(t){var n=t.getAttribute("LineColor"),a=t.getAttribute("Enabled");e.AxisMajorGridColor=n?ue(n):null,e.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(r){var i=r.getAttribute("LineColor"),o=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=i?ue(i):null,e.AxisMajorTickMarkEnabled=o&&"true"===o.toLowerCase()}return e}}function ce(e){var t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function le(e){var t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function ue(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){var t=[];e.split(",").forEach((function(e){return t.push(e.trim())}));var r=t.shift(),n=parseFloat(r)/255,a=t.slice();return a.push(n.toString()),String.format("rgba({0})",a.join(","))}return e}var pe=r("BuSU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var he=function(){function e(e,t,r,n,a,i,o,s){this._getState=e,this._chartData=a,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=i,this._drilldownChartType=o,this._entityLogicalName=s}return e.prototype.buildChartModel=function(){if(this._chartQueryModel=Object(pe.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof k))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel},e.prototype._buildDataEmptyMessage=function(){var e=Object(g.b)(this._getState(),f.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)},e.prototype._buildErrorMessage=function(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)},e.prototype._buildChartHeading=function(){var e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()},e.prototype._buildChartPresentation=function(){var e,t=this;this._chartPresentationParser=$(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach((function(e){e.ChartType=t._drilldownChartType})),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList},e.prototype._buildChart=function(){this._chartParserType=this._getChartParserType();var e=function(e){var t=null;switch(e){case 2:t=new X;break;case 3:t=new H;break;case 1:default:t=new K}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()},e.prototype._getChartParserType=function(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1},e}(),ge=r("8ADW"),fe=r("y5DA"),me=r("kKaT"),be=r("TbLg"),ve=r("z8lM"),ye=r("Fpc+"),_e=r("ZZrQ"),Se=r("AhDg");function Oe(e,t,r){return{type:"chartData.retrieve.core.async",execute:function(n,i,s){var c=n.dispatch,l=n.getState,u=[];try{var p=l();if(!Object(o.b)(l,c,i,u,e,t,r,!0))return Promise.resolve();var d=new _e.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);var h=function(e){var t={};if(null!=e){var r=new _e.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){var i=new Se.a(a.a.toString(a.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,i).nativePromise()}(i.DataSource,d,h,s).then((function(n){var i=function(t,r,n){var a=new Te(e.viewTitle,e.viewEntityLogicalName),i=new Te(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(ve.a)(t);Object(o.e)(s,c,r());var l=e;return new he(r,a,i,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,n).buildChartModel()}(n,l,t);Object(M.c)(p,D.rd)?(c(Pe(e.getStorageKey(),i)),Ie(p,c,e.getStorageKey(),r)):(c(je(a.a.toString(e.visualizationId),a.a.toString(e.viewId),i)),Ce(p,c,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r))})).catch((function(t){Object(fe.c)(p,c,t,e,r)}))}catch(e){return i.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),ge.b,u),Promise.reject(e)}}}}function Ce(e,t,r,i,o){if(e){var s=new a.a(r),c=a.a.toString(s),l=new a.a(i),u=a.a.toString(l),p={},d={};if(d[u]=function(e,t,r,a){if(!e)return null;if(a&&""!==a){var i=Object(be.c)(e,t,r),o=i&&i.slice();return Object(n.a)(o,a)}return null}(e,c,u,o),d[u]){p[c]=d;var h={entities:null,lists:null,charts:p};t(Object(me.b)(h))}}}function Ie(e,t,r,a){if(e){var i={};if(i[r]=function(e,t,r){if(!e)return null;if(r){var a=Object(be.b)(e,t),i=a&&a.slice();return Object(n.a)(i,r)}return null}(e,r,a),i[r]){var o={entities:null,lists:null,charts:null,chartData:i};t(Object(me.b)(o))}}}function je(e,t,r){var n,o,s=new a.a(e),c=a.a.toString(s),l=new a.a(t),u=a.a.toString(l),p={charts:(n={},n[c]=(o={},o[u]={initialized:i.a.Initialized,chartConfigObject:r},o),n)};return{type:ye.d,payload:p}}function Pe(e,t){var r,n={chartData:(r={},r[e]={initialized:i.a.Initialized,chartConfigObject:t},r)};return{type:ye.d,payload:n}}var Te=function(){function e(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}return e.prototype.get_DisplayName=function(){return this._displayName},e.prototype.get_AssociatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e}()},"A/RO":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,a=r("9r0m"),i=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(n||(n={}));var o=r("nbQV"),s=r("lKeh"),c=r("QAhb"),l=r("VnpK"),u=r("S2mk"),p=r("F2uj"),d=r("T576"),h=r("HSdq"),g=r("Sscr"),f=r("lMVv"),m=r("WS0f"),b=r("qC0c"),v=r("U0B9"),y=r("sOTk"),_=r("MSdU"),S=r("r0s4"),O=function(){function e(e,t,r){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=r}return e.prototype.generate=function(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null},e.prototype._getBusinessProcessFlowWrapper=function(e,t){var r=this._getState(),n=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!n||!t||!t.getProcessId())return null;var i=t.getCurrentFormEntity(),c=Object(y.g)(r,e);this._navigationEntities=t.getNavigationEntities();var l=Object(d.f)(r,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(r,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(n.data.activePath,n.activeStageId,n.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:n.activeStageId,selectedStageId:n.data.selectedStageId,activePath:n.data.activePath,displayState:n.displayState,currentEntity:new _.a(i.etn,a.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(h.Lb)(r,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:n.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}},e.prototype._getStages=function(e,t,r,n,i){var o=this;if(!e||0===e.length)return null;var s={},c=[];return e.forEach((function(e,l){s[e.guid]=l;var u=a.a.equals(e,r),p=o._getStageWrapper(e,u,t,s,n,i);p&&c.push(p)})),c},e.prototype._getStageWrapper=function(e,t,r,n,i,o){var c=this,l=Object(s.c)(this._getState(),o.getProcessId(),e);if(!l)return null;var u=t&&this._getSteps(l,i,o)||[];if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var p="BusinessProcessFlow.CustomControlConfiguration",d=this._context.TraceManager.getTracer(p),h=Object(s.a)(this._getState(),o.getProcessId(),d);if(!Object(m.a)(h)&&!Object(m.a)(h.ControlConfigurations)){var g=o.getTelemetryParams();if(g.push({name:"BPFEntityFormId",value:h.Id.guid},{name:"BPFEntityFormType",value:h.FormType}),Object(m.a)(h.ControlConfigurations)||g.push({name:"CustomControls",value:Object.keys(h.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),h,d))try{if(!Object(m.a)(h.ControlConfigurations)){var v=Object(s.b)(h,d),y=h.ControlConfigurations,_=this._getNonDefaultControlConfiguration(y);if(Object(b.c)(this._getState(),"FCB.EnableBPFCCPhase3")){var S=this._buildStepsFromFormXml(l,h,_,g,i,o);S&&S.length>0&&(u=S,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(p,g))}else Object(m.a)(v)||Object.keys(v).forEach((function(e){if(v[e].ParentCellId){var t=new a.a(v[e].ParentCellId);if((l&&l.stage&&l.stage.steps?l.stage.steps.map((function(e){return e.stepId.guid})).indexOf(t.guid):-1)>=0&&t){var r=[];r.push({name:"StepId",value:t.guid},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),d.info("Non-default control found for step",r);var n=null;_&&v[e].UniqueId&&(o.setFormXmlRenderingIndicator(!0),n=_[v[e].UniqueId]?_[v[e].UniqueId]:null);var i={attributeName:v[e].DataFieldName,isRequired:c._getIsStepRequired(t.guid,l),name:v[e].Label,stepId:new a.a(t.guid),stepType:"field",attributeType:c._getMetadataTypeByAttribute(l.entityLogicalName,v[e].DataFieldName),controlName:"header_process_"+v[e].Label,isVisible:v[e].Visible,isControlDisabled:v[e].Disabled,nonDefaultConfiguration:n};u.push(i),Object(m.a)(i.stepId.guid)||i.stepId.guid===a.a.EMPTY.guid||g.push({name:"StepId",value:i.stepId.guid}),g.push({name:"AttributeName",value:i.attributeName},{name:"AttributeType",value:i.attributeType},{name:"IsRequired",value:i.isRequired},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),Object(m.a)(n)?c._context.EventManager.ReportComponentFailure(p,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,g):(o.setCustomControlIndicator(!0),g.push({name:"CustomControlId",value:n.CustomControlId}),!Object(m.a)(n.Name)&&n.Name.indexOf("MscrmControls")>=0&&g.push({name:"CustomControlName",value:n.Name}),c._context.EventManager.ReportComponentSuccess(p,g))}}}))}}catch(e){d.error("Message: "+e.message+", Stack: "+e.stack,g),this._context.EventManager.ReportComponentFailure(p,e,null,g)}else this._context.EventManager.ReportComponentFailure(p,new Error("Invalid FormXML - Fallback invoked"),null,g)}}return{id:l.stage.stageId,name:l.stage.stageDisplayName,entityName:l.entityLogicalName,entityDisplayName:Object(f.f)(this._getState(),l.entityLogicalName)||l.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(l.entityLogicalName),referencingAttributeName:l.referencingAttributeName,status:this._getStageStatus(n[e.guid],n[r.guid],o),steps:u}},e.prototype._buildStepsFromFormXml=function(e,t,r,n,i,o){var s=this,c=[],l=t.Controls;return!Object(m.a)(l)&&this._areStepsValid(e,t,n)&&Object.keys(l).forEach((function(u){if(!Object(m.a)(l[u])&&l[u].ParentCellId){var p=new a.a(l[u].ParentCellId),d=t.Tabs.find((function(e){return e.Id===l[u].ParentTabId}));if(d&&!Object(m.a)(d.RawTabId)&&e.stage.stageId.guid===new a.a(d.RawTabId).guid){var g=null;r&&l[u].UniqueId!==a.a.EMPTY.guid&&(g=r[l[u].UniqueId]?r[l[u].UniqueId]:null);var f=s._retrieveControlName(l[u],e.stage.steps),b=s._getUIControl(i,f),v={attributeName:l[u].DataFieldName,isRequired:l[u].IsRequired,name:s._retrieveStepLabel(l[u],b,e.stage.steps),stepId:new a.a(p.guid),stepType:s._getStepTypeFromControlKey(u),attributeType:s._getMetadataTypeByAttribute(e.entityLogicalName,l[u].DataFieldName),controlName:f,isVisible:b&&!Object(m.a)(b.visible)?b.visible:l[u].Visible,isControlDisabled:l[u].Disabled||Object(h.t)(s._getState(),{id:i,controlName:f},o.getContextToken()),viewId:b&&b.parameters&&b.parameters.defaultviewid?b.parameters.defaultviewid:null,nonDefaultConfiguration:Object(m.a)(g)?null:g};v.config=s._getConfig(t,o,l[u],i,n),v.viewId&&v.config&&v.config.Parameters&&v.config.Parameters.value&&(v.config.Parameters.value.ViewId=v.viewId,b&&b.customFilter&&b.customFilter.length>0&&(s._applyLookupFilter(v,b),v.config.Parameters.value.ExtraFilters=v.extraFilters)),c.push(v),n.push({name:"StepId",value:v.stepId.guid},{name:"AttributeName",value:v.attributeName},{name:"AttributeType",value:v.attributeType},{name:"IsRequired",value:v.isRequired},{name:"NonDefaultControlUniqueId",value:l[u].UniqueId}),Object(m.a)(g)||l[u].UniqueId===a.a.EMPTY.guid||(o.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:g.CustomControlId}),!Object(m.a)(g.Name)&&g.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:g.Name}))}}})),c},e.prototype._areStepsValid=function(e,t,r){if(!(Object(m.a)(t)||Object(m.a)(e)||Object(m.a)(e.stage)||Object(m.a)(e.stage.stageId))){var n=t.Controls,i=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(m.a)(n)){if(Object.keys(n).forEach((function(e){if(!Object(m.a)(n[e].ParentCellId)){var r=new a.a(n[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find((function(t){return t.Id===n[e].ParentTabId}));if(!Object(m.a)(o)&&!Object(m.a)(o.RawTabId)){var c=new a.a(o.RawTabId).guid.toLowerCase();i===c&&s.indexOf(r)<0&&s.push(r)}}})),o.length!==s.length)return r.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(var c=0;c<o.length;c++)if(s.indexOf(o[c].stepId.guid.toLowerCase())<0)return r.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[c].stepId.guid.toLowerCase()}),!1;return!0}}return!1},e.prototype._retrieveStepLabel=function(e,t,r){if(!Object(m.a)(t)&&!Object(m.a)(t.label)&&""!==t.label)return t.label;if(!Object(m.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(m.a)(r)&&r.length>0)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(m.a)(o.label)&&""!==o.label)return o.label}return""},e.prototype._retrieveControlName=function(e,t){if(!Object(m.a)(t)&&t.length>0)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(m.b)(i.controlName))return i.controlName}return Object(m.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName},e.prototype._getConfig=function(e,t,r,n,a){try{var i=Object(h.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:r&&r.Name});var c=i(this._getState(),r,n,o,s&&s.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){a.push({name:"CCFControlConfigError",value:e})}return null},e.prototype._getStageStatus=function(e,t,r){return null==t||e<t?n.Completed:e===t?r.getStatus()===i.a.Finished?n.Completed:n.Active:n.Inactive},e.prototype._getSteps=function(e,t,r){var n=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(var a=0,i=e.stage.steps;a<i.length;a++){var o=i[a],c=this._getUIControl(t,o.controlName),l=null;if(o.name&&o.stepType&&"field"===o.stepType.toLowerCase()){if(!(l=this._getMetadataTypeByAttribute(e.entityLogicalName,o.name)))continue;if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var u=this._context.TraceManager.getTracer("BpfCustomControlSupport"),p=Object(s.a)(this._getState(),r.getProcessId(),u);if(!Object(m.a)(p)&&!Object(m.a)(p.ControlConfigurations)&&r.isBpfFormDescriptorValid(this._getState(),r.getProcessId(),p,u)){var d=Object(s.b)(p,u),g=this._getNonDefaultControlStepIds(d);if(!Object(m.a)(g)&&g.map((function(e){return e.guid})).indexOf(o.stepId.guid)>=0)continue}}}var f=this._getState(),v={attributeName:o.name,controlName:o.controlName,isRequired:o.required,isVisible:!c||c.visible,name:c?c.label:o.label,stepId:o.stepId,stepType:o.stepType,attributeType:l,viewId:c&&c.parameters&&c.parameters.defaultviewid?c.parameters.defaultviewid:o.viewId,isControlDisabled:Object(h.t)(f,{id:t,controlName:o.controlName},r.getContextToken())};v.viewId&&c&&c.customFilter&&c.customFilter&&c.customFilter.length>0&&this._applyLookupFilter(v,c),n.push(v)}return n},e.prototype._applyLookupFilter=function(e,t){var r;r=!1;var n=[];if(e&&t){for(var a=0;a<t.customFilter.length;a++){if("END_FLAG"===t.customFilter[a].customFilter){r=!0;break}if("START_FLAG"!==t.customFilter[a].customFilter){var i=Object(l.i)(Object(S.CrmHtmlDecode)(t.customFilter[a].customFilter));i&&(i.conditions&&i.conditions.length>0||i.filters&&i.filters.length>0)&&n.push(JSON.stringify(i))}}r?(this._memorizedExtraFilters=n,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}},e.prototype._getMetadataTypeByAttribute=function(e,t){var r=this._getState(),n=Object(p.a)(r,e,t);if(!n)return null;var a=n.Type+"."+n.Format;return Object(u.n)(a)},e.prototype._getActions=function(e){return{completeProcess:function(){return e.completeProcess()},moveNext:function(){return e.moveToNextStage()},movePrevious:function(){return e.moveToPreviousStage()},setActiveStage:function(t){return e.setActiveStage(t.guid)},setSelectedStage:function(t,r){void 0===r&&(r=!1),e.setSelectedStage(t?t.guid:null,r)},triggerActionStepClick:function(t){e.triggerActionStepClick(t)},triggerFlowStepClick:function(t,r){e.triggerFlowStepClick(t,r)},refreshFlowStepClick:function(t){e.refreshFlowStepClick(t)},setDisplayState:function(t){e.setDisplayState(t)},getForwardNavigationEntities:function(t,r,n,a){return e.getForwardNavigationEntities(t,r,n,a)},navigateToNextEntity:function(t,r,n,a){return e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(r),n,a)},executePreEvent:function(t,r,n,a){return e.executePreEvent(t,r,n,a)},validateRequiredFieldsForNavigation:function(){return e.ValidateRequiredFieldsForNavigation()},waitForOngoingWork:function(){return e.waitForOngoingWork()},getActiveStageActiveFor:function(){return e.getActiveStageActiveFor()},getBpfInstanceActiveFor:function(){return e.getBpfInstanceActiveFor()},getBpfInstanceCompletedIn:function(){return e.getBpfInstanceCompletedIn()},getBpfNavigationBehavior:function(){return e.getBpfNavigationBehavior()},setBpfNavigationBehavior:function(t){e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:function(t){return e.getBpfNavigationBehaviorAllowCreateNew(t)},getActiveStage:function(){var t=e.getContextToken(),r=e.getScriptContainer().getEventManager().getClientApiForm(t);return r?r.data.process.getActiveStage():null}}},e.prototype._getRelatedEntityReference=function(e){if(!this._navigationEntities)return null;var t=this._navigationEntities.find((function(t){return t.entityLogicalName===e}));return t?new _.a(t.entityLogicalName,a.a.toLegacyGuid(a.a.parse(t.id))):null},e.prototype._getUIControl=function(e,t){if(t){var r=this._getState(),n=Object(g.j)(r,e),a={controlName:t,id:e};return Object(h.Mc)(this._getState(),a,n)}return null},e.prototype._getNonDefaultControlConfiguration=function(e){var t={};if(e)for(var r=Object.keys(e),n=0;n<r.length;n++){var a,i=Object(v.b)(this._getState());(a=e[r[n]].CustomControls[i])&&(t[r[n]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}return t},e.prototype._getNonDefaultControlStepIds=function(e){var t=[];return e&&Object.keys(e).forEach((function(r){e[r].ParentCellId&&t.push(new a.a(e[r].ParentCellId))})),t},e.prototype._getIsStepRequired=function(e,t){var r=t.stage.steps,n=r?r.map((function(e){return e.stepId.guid})).indexOf(e):-1;return n>=0&&!Object(m.a)(r[n].required)&&r[n].required},e.prototype._getStepTypeFromControlKey=function(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"},e}()},A8fJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.contentType";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i,meta:{pageId:e,tabId:t,contextKey:o}}}},ABRM:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.format";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},AVer:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("G7N+"),a=r("Sscr"),i=r("c56u"),o=r("kJGL"),s=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,i,o,c,u,p){var d,h=Object(a.v)(o),g=function(e,t){var r;if(!e)return null;var n=new DOMParser,a=e?n.parseFromString(e,"text/xml"):null;if(!a)return null;var i=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!i)return null;for(var o=i,s=[],c=0;c<o.length;c++)if(o[c].getAttribute){for(var u=o[c]?o[c].children?o[c].children:o[c].childNodes:void 0,p=[],d=null,h=0;h<u.length;h++){var g=u[h];if(g.getAttribute){var f=g.getAttribute("name"),m=void 0;m=(r=l(f,d,n,t)).relatedEntityName,d=r.fetchXmlDocument,p.push({name:f,width:parseInt(g.getAttribute("width"),10),relatedEntityName:m,disableMetaDataBinding:"1"===g.getAttribute("disableMetaDataBinding"),labelId:g.getAttribute("labelId"),isHidden:"1"===g.getAttribute("isHidden"),disableSorting:"1"===g.getAttribute("disableSorting"),addedBy:g.getAttribute("addedBy"),desc:g.getAttribute("desc"),cellType:g.getAttribute("cellType"),imageProviderWebresource:g.getAttribute("imageProviderWebresource"),imageProviderFunctionName:g.getAttribute("imageProviderFunctionName")})}}var b={name:o[c].getAttribute("name"),id:o[c].getAttribute("id"),cells:p,multiObjectIdField:o[c].getAttribute("multiObjectIdField"),layoutStyle:o[c].getAttribute("multiObjectIdField")};s.push(b)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(p,u),f={initialized:n.a.Initialized,viewId:r,fetchXML:u,entityLogicalName:i,title:c,layoutXML:p,grid:g,isCustomView:!0};return{type:s.a,payload:{views:(d={},d[r.guid]=f,d)},meta:{pageId:e,controlName:t,contextKey:h}}}function l(e,t,r,n){var a="";if(e.indexOf(".")>0){var i=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));var o=t.querySelector('link-entity[alias="'+i+'"]');o&&(a=o.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:function(t,r){return(Object(i.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then((function(t){return e.offlineSqlQuery=t}))}}}},ApiM:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return l}));var n=r("9r0m"),a=r("7z0H"),i=r("Sscr"),o="businessProcessFlow.attributes.add",s="businessProcessFlow.controls.add";function c(e,t,r){var n=Object(i.v)(e);return{type:o,payload:{attributes:p(r)},meta:{pageId:t,contextKey:n}}}function l(e,t,r){var n=Object(i.v)(e);return{type:s,payload:{controls:u(r)},meta:{pageId:t,contextKey:n}}}function u(e){var t={};for(var r in e&&!e.header_process&&(e.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:n.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")}),e){var i=Object(a.f)(e[r],null,!0);i&&(t[r]=i)}return t}function p(e){var t={};for(var r in e){var n=e[r],a={Precision:n.Precision,PrecisionSource:n.PrecisionSource,RequiredLevel:n.RequiredLevel,Format:n.Format,OptionSet:n.OptionSet,IsValidForCreate:n.IsValidForCreate,IsValidForUpdate:n.IsValidForUpdate,Targets:n.Targets};t[n.LogicalName]=a}return t}},BWVO:function(e,t,r){"use strict";r.d(t,"a",(function(){return Me})),r.d(t,"b",(function(){return De}));var n,a,i,o,s,c,l,u,p,d=r("1z64"),h=r("9r0m"),g=r("9rlF"),f=r("QAhb"),m=r("ezfI"),b=r("F2uj"),v=r("iutC"),y=r("yHpA"),_=r("FuJ2"),S=r("o0+l"),O=r("HSdq"),C=r("5jMY"),I=r("Zy0S"),j=r("ObKm"),P=r("w/nD"),T=r("+Z9T"),x=r("IiPO"),E=r("Sscr"),F=r("lMVv"),w=r("zsi3"),N=r("xirW"),A=r("hCnb"),k=r("2p2B"),M=r("uQP8"),D=r("r0s4"),R=r("Srej"),L="ClientApi.XrmEntityAttribute.",B=function(){function e(e,t,r,a,i,o){n=e,this._clientApiExecutorAttribute=new d.a(e,L,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});var s=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(T.j)(s,"attributeName"),e||Object(T.j)(s,"store"),r||Object(T.j)(s,"pageId"),t||Object(T.j)(s,"contextToken"),o||Object(T.j)(s,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=r,this.xrmFormUi=o,this._contextToken=t}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutorAttribute.execute("controls",(function(t,r){if(!e._controls){e._controls=new I.a(t);var a=Object(O.z)(n.getState(),e._pageId,e.contextToken,e._attributeName);if(a){e.xrmFormUi.getControls();for(var i=e.xrmFormUi.controls,o=0;o<a.length;o++){var s=a[o],c=i.get(s);c&&e._controls.add(s,c)}}}return e._controls}))},enumerable:!1,configurable:!0}),e.prototype.addOnChange=function(e){var t=L+"addOnChange";e||Object(T.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(P.a)(this.contextToken,this._pageId,this.getName(),e)),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.fireOnChange=function(){var e=L+"fireOnChange";try{m.a.instance.reportCall(e),n.dispatch(Object(P.P)(this.contextToken,this._pageId,this.getName())),m.a.instance.reportSuccess(e)}catch(r){var t=x.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getAttributeType=function(){var e=L+"getAttributeType";try{m.a.instance.reportCall(e);var t=this.getAttrDescriptor().Type;return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFormat=function(){var e=this;return this._clientApiExecutorAttribute.execute("getFormat",(function(){var t=e.getAttrDescriptor();if(!t||!t.Format)return null;var r=t.Format.toLowerCase(),n=r;switch(e.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==r&&"2"!==r||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===r&&(n="none");break;case"memo":"2"!==r&&"1"!==r||(n="textarea");break;default:"0"===r?n="none":void 0===n&&(n=null)}return n}))},e.prototype.getIsDirty=function(){var e=L+"getIsDirty";try{m.a.instance.reportCall(e);var t=Object(O.Jb)(n.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(y.e)(n.getState(),Object(O.ac)(n.getState(),this.getPageId(),this.dataContextToken),this.getName());return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getName=function(){return m.a.instance.reportUsage(L+"getName"),this._attributeName},e.prototype.getParent=function(){return m.a.instance.reportUsage(L+"getParent"),this._parentEntity},e.prototype.getRequiredLevel=function(){var e=L+"getRequiredLevel";try{m.a.instance.reportCall(e);var t=Object(O.pc)(n.getState(),this._pageId,this.dataContextToken,this.getName()),r=void 0;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(T.h)(e,"RequiredLevel",t)}return m.a.instance.reportSuccess(e),r}catch(t){var a=x.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getSubmitMode=function(){var e=L+"getSubmitMode";try{m.a.instance.reportCall(e);var t=Object(O.zc)(n.getState(),this._pageId,this.contextToken,this.getName()),r=void 0;switch(t){case C.a.Dirty:r="dirty";break;case C.a.Always:r="always";break;case C.a.Never:r="never";break;default:Object(T.h)(e,"SubmitMode",t)}return m.a.instance.reportSuccess(e),r}catch(t){var a=x.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getUserPrivilege=function(){var e=L+"getUserPrivilege";try{m.a.instance.reportCall(e);var t=null;if(n.getState()&&this._parentEntity&&this._attributeName){var r=Object(v.a)(n.getState(),this._parentEntity.getEntityName(),h.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);r&&(t={canCreate:r.canCreate,canRead:r.canRead,canUpdate:r.canUpdate})}return m.a.instance.reportSuccess(e),t}catch(t){var a=x.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getValue=function(){var e=L+"getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return Object(T.a)(t)||(Object(g.j)(t)?r=t.value:Object(T.k)(e,"isPlainValue","value")),m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnChange=function(e){var t=L+"removeOnChange";e||Object(T.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(P.v)(this.contextToken,this._pageId,this.getName(),e)),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setRequiredLevel=function(e){var t=L+"setRequiredLevel";e||Object(T.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(T.h)(t,"RequiredLevel",e);try{m.a.instance.reportCall(t);var r=void 0;switch(e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}n.dispatch(Object(_.b)(this._pageId,this.dataContextToken,this._attributeName,r)),m.a.instance.reportSuccess(t)}catch(e){var a=x.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setSubmitMode=function(e){var t=L+"setSubmitMode";e||Object(T.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(T.h)(t,"SubmitMode",e);try{m.a.instance.reportCall(t);var r=void 0;switch(e){case"dirty":r=C.a.Dirty;break;case"always":r=C.a.Always;break;case"never":r=C.a.Never}n.dispatch(Object(S.b)(this._pageId,this.contextToken,this.getName(),r)),m.a.instance.reportSuccess(t)}catch(e){var a=x.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setValue=function(e){var t=L+"setValue";try{m.a.instance.reportCall(t),this.setValueInternal(e),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setIsValid=function(e,t){var r=this;return this._clientApiExecutorAttribute.execute("setIsValid",(function(a,i){e?(n.dispatch(Object(A.b)(r._pageId,r._attributeName,!0,r.contextToken)),n.dispatch(Object(k.b)(r.contextToken,r._pageId,Object(R.d)(r._pageId,r._attributeName))),n.dispatch(Object(N.b)(n.getState(),r._pageId,r._attributeName,null,r.contextToken))):r._addNotification(t)}))},e.prototype._addNotification=function(e){n.dispatch(Object(A.b)(this._pageId,this._attributeName,!1,this.contextToken));var t={messages:[e],notificationLevel:w.a.error};n.dispatch(Object(N.b)(n.getState(),this._pageId,this._attributeName,t,this.contextToken))},e.prototype.isValid=function(){var e=L+"isValid";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=this.getParent();if(r){var a=Object(F.h)(n.getState(),r.getEntityName());if(a&&a.PrimaryIdAttribute!==this.getName()&&r.getId()!==h.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(T.a)(t))return m.a.instance.reportSuccess(e),!1}var i=!0;return this.hasErrorNotification()?i=!1:t&&t.validationResult&&(i=t.validationResult.isValueValid),m.a.instance.reportSuccess(e),i}catch(t){var o=x.a.getInstance().getEventParameters(this._contextToken);throw o.push({name:"attributeName",value:this._attributeName}),x.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.hasErrorNotification=function(){var e=Object(E.v)(this.contextToken),t=n.getState(),r=Object(M.a)(t,this._pageId);return!(!r.forms||!r.forms[e]||!r.forms[e].invalidControls&&!r.forms[e].invalidAttributes)&&(!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()])},e.prototype.getPageId=function(){return this._pageId},e.prototype.getAttrDescriptor=function(){if(this.getParent()){var e=Object(O.r)(n.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(b.a)(n.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(O.Nc)(n.getState(),this.getPageId(),this.getName())},e.prototype.getDataXmlInternal=function(){var e="";return e=e+"<"+Object(D.CrmXmlEncode)(this.getName())+">"+Object(D.CrmXmlEncode)(this.getValue())+"</"+Object(D.CrmXmlEncode)(this.getName())+">"},e.prototype.setValueInternal=function(e){var t=this.getName(),r={};r[t]={fieldName:t,value:e},n.dispatch(Object(j.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(E.t)(this._contextToken),this.contextToken))},Object.defineProperty(e.prototype,"parentEntityReference",{get:function(){var e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new f.a(e,new h.a(t)):new f.a(e)},enumerable:!1,configurable:!0}),e.prototype.getValueInternal=function(){var e=Object(O.ac)(n.getState(),this.getPageId(),this.dataContextToken);return Object(O.X)(n.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,n.dispatch)},Object.defineProperty(e.prototype,"contextToken",{get:function(){return Object(E.r)(this._contextToken)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataContextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}(),V=r("c/eZ"),G=r("TCcM"),z=r("TV33"),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getOption=function(e){var t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(T.a)(e))return null;var r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(T.k)(t,"number","value");try{m.a.instance.reportCall(t);for(var n=this.getAttrDescriptor().OptionSet,a=null,i=0;i<n.length;i++)n[i].Value===e&&(a={text:n[i].Label,value:n[i].Value});return m.a.instance.reportSuccess(t),a}catch(e){throw x.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e),e}},t.prototype.getOptions=function(){var e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{m.a.instance.reportCall(e);var t=this.getAttrDescriptor().OptionSet.map((function(e){return{text:e.Label,value:e.Value}}));return m.a.instance.reportSuccess(e),t}catch(t){throw x.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t),t}},t}(B),q=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{m.a.instance.reportCall(e);var t=Object(G.j)(a.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(z.a)(t);return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(T.a)(e)||"boolean"!=typeof e&&Object(T.k)(t,"boolean","value");try{m.a.instance.reportCall(t),this.setValueInternal(e),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"},t}(W),U=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;return i=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{m.a.instance.reportCall(e);var t=Object(G.j)(i.getState(),this.parentEntityReference,this.getName()),r=Object(z.e)(t);return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getSelectedOption=function(){var e=this,t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{m.a.instance.reportCall(t);var r=null,n=this.getValue();return n&&(r=[],n.forEach((function(t){var n=e.getOption(t);n&&r.push(n)}))),m.a.instance.reportSuccess(t),r}catch(e){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{m.a.instance.reportCall(e);var t=null,r=this.getSelectedOption();return r&&(t=[],r.forEach((function(e){t.push(e.text)}))),m.a.instance.reportSuccess(e),t}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return t&&(r=Object(z.e)(t)),m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{m.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},t}(W),X=r("otJc"),H=r("dl9j"),K=r("+h4s"),Q=r("sRkF"),Y=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));var t=Object(D.CrmXmlEncode)(this.getName()),r="";return r+="<"+t+">",r+=""+(null===e?"":Object(D.CrmXmlEncode)(e.format("s"))),r+="</"+t+">"},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;if(Object(g.j)(t)&&!Object(T.a)(t.formatted)){var n=this.getAttrDescriptor();r=Object(z.b)(o.getState(),n,t)}return m.a.instance.reportSuccess(e),r}catch(t){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._userSettings=function(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new H.a(o)},t.prototype.getUtcValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{m.a.instance.reportCall(e);var t=this.getValue();return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(T.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(T.k)(t,"Date","value");try{if(m.a.instance.reportCall(t),Object(T.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){var r=new Date,n=this.getAttrDescriptor(),a=Object(X.z)(o.getState(),n),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(K.o)(new Date(r.getFullYear(),r.getMonth(),r.getDate()),a.userSettings.timeZoneAdjusters)-Object(K.o)(e,a.userSettings.timeZoneAdjusters),c=6e4*e.getTimezoneOffset(),l=null;switch(a.controlAttributes.Behavior){case Q.a.UserLocal:l=new Date(e.getTime()+c+i-s);break;default:l=new Date(e.getTime())}this.setValueInternal(l)}m.a.instance.reportSuccess(t)}catch(e){var u=x.a.getInstance().getEventParameters(this.contextToken);throw u.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,u),e}},t.prototype.setUtcValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{m.a.instance.reportCall(t),this.setValue(e),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"},t}(B),J=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c}return Object(V.__extends)(t,e),t.prototype.getIsPartyList=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1},t.prototype.getDataXmlInternal=function(){var e=this.getValue(),t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{var r=Object(D.CrmXmlEncode)(this.getName());t+="<"+r+">",t+="</"+r+">"}return t.toString()},t.prototype.getLookupDataXml=function(e,t){var r=Object(D.CrmXmlEncode)(e),n="<"+r,a=this.getEntityTypeCode(t.entityType);return a>0&&(n+=' type="'+Object(D.CrmXmlAttributeEncode)(a.toString())+'"'),t.entityType&&(n+=' typeName="'+Object(D.CrmXmlAttributeEncode)(t.entityType)+'"'),Object(T.a)(t.name)||(n+=' name="'+Object(D.CrmXmlAttributeEncode)(t.name)+'"'),n+=">"+Object(D.CrmXmlEncode)(t.id)+"</"+r+">"},t.prototype.getEntityTypeCode=function(e){return Object(F.p)(s.getState(),e)},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeLookup.setValue",r=null;if(e&&Array.isArray(e)&&e.length>0){e.length>1?Object(T.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?h.a.tryParseOrNull(e[0].id)||Object(T.h)(t,"guid",e[0].id):Object(T.j)(t,"value[0].id"):Object(T.j)(t,"value[0].entityType");var n=void 0;try{n=Object(O.Ob)(s.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw(a=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t+".getLookupTargets",e,null,a),e}if(n)if(!(n.indexOf(e[0].entityType)>-1))(a=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"actualValue",value:e[0].entityType}),Object(T.k)(t,"entityType","value[0].entityType",a);try{m.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new f.a(e[0].entityType,new h.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),m.a.instance.reportSuccess(t)}catch(e){var a;throw(a=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,a),e}}else this.setValueInternal(r)},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeLookup.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(z.d)(t);return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"},t}(B),Z=r("/wtJ"),$=r("kvLG"),ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return c=t,s._clientApiExecutorAttributeNumber=new d.a(t,"ClientApi.XrmEntityAttributeNumber.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getMax=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMax",(function(){return e.getAttrDescriptor().MaxValue}))},t.prototype.getMin=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMin",(function(){return e.getAttrDescriptor().MinValue}))},t.prototype.getPrecision=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getPrecision",(function(){return Object(O.k)(c.getState(),e.getPageId(),e.dataContextToken,e.getName())}))},t.prototype.setPrecision=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setPrecision",(function(r,n){"integer"===t.getAttributeType()&&Object(T.e)(r,"setPrecision is not valid on integer attributes",void 0,n);var a=Object(b.a)(c.getState(),t.getParent().getEntityName(),t.getName());(e<0||e>a.Precision)&&(n.push({name:"metadataPrecision",value:a.Precision}),Object(T.h)(r,"precision",e.toString(),n)),c.dispatch(Object(Z.b)(t.getPageId(),t.dataContextToken,t.getName(),e))}),[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getValue",(function(){var t=e.getValueInternal();return Object(z.f)(t,e.getAttributeType(),e.getPrecision())}))},t.prototype.setValue=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setValue",(function(){t.setValueInternal(e)}),[{name:"value",value:e,expectedDataType:"number"}])},t.prototype.getAttributeType=function(){var t=this;return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(function(r,n){var a=t.getAttrDescriptor().Type;switch(a){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return n.push({name:"attributeType",value:a}),a?t._clientApiExecutorAttributeNumber.reportFailure(r,new Error("Unexpected number attribute type."),n):$.a.getInstance().traceManager.getTracer(r).error("Number attribute type was not defined in metadata.",n),e.prototype.getAttributeType.call(t)}}))},t}(B),te=r("sOTk"),re=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return l=t,s}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{m.a.instance.reportCall(e);var t=Object(G.j)(l.getState(),this.parentEntityReference,this.getName()),r=Object(te.m)(l.getState(),this.getPageId()),n=void 0;if(r){var a=this.getAttrDescriptor();n=Object(z.g)(t)||a&&a.DefaultFormValue?a.DefaultFormValue:null}else n=Object(z.g)(t);return m.a.instance.reportSuccess(e),n}catch(t){var i=x.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.getSelectedOption=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{m.a.instance.reportCall(e);var t=this.getOption(this.getValue());return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getText";try{m.a.instance.reportCall(e);var t=this.getSelectedOption(),r=null;return t&&(r=t.text),m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(z.g)(t),n=Object(T.a)(r)?Object(z.f)(t,this.getAttributeType(),0):r;return m.a.instance.reportSuccess(e),n}catch(t){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(T.k)(t,"number","value");var r=!1;try{if(e&&this.getParent()){var n=this.getAttrDescriptor();for(var a in n.OptionSet)if(e===n.OptionSet[a].Value){r=!0;break}}else r=!0}catch(e){throw(i=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,i),e}r||Object(T.h)(t,"OptionSetValue",e);try{m.a.instance.reportCall(t),this.setValueInternal(e),m.a.instance.reportSuccess(t)}catch(e){var i;throw(i=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"},t}(W),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getMaxLength=function(){var e="ClientApi.XrmEntityAttributeString.getMaxLength";try{m.a.instance.reportCall(e);var t=this.getAttrDescriptor().MaxLength;return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeString.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(z.i)(t);return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeString.setValue";Object(T.a)(e)||"string"!=typeof e&&Object(T.k)(t,"string","value");try{m.a.instance.reportCall(t),this.setValueInternal(e),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){var t="ClientApi.XrmEntityAttributeString.getAttributeType";try{m.a.instance.reportCall(t);var r=void 0,n=this.getAttrDescriptor().Type;switch(n){case"memo":r="memo";break;case"string":r="string";break;default:(a=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"attributeType",value:n}),x.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,a),r=e.prototype.getAttributeType.call(this)}return m.a.instance.reportSuccess(t),r}catch(e){var a;throw(a=x.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,a),e}},t}(B),ae=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutor=new d.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,r),s._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0}),s}return Object(V.__extends)(t,e),t.prototype.setValue=function(e){var t=this;this._clientApiExecutor.execute("setValue",(function(){t.setValueInternal(h.a.tryParseOrNull(e))}),[{name:"value",value:e,expectedDataType:"guid"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutor.execute("getValue",(function(){var t=e.getValueInternal();return Object(z.j)(t)}))},t.prototype.getAttributeType=function(){return this._clientApiExecutor.execute("getAttributeType",(function(){return"string"}))},t}(B),ie=r("nVTU"),oe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return u=t,s}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this,t=Object(D.CrmXmlEncode)(this.getName()),r=this.getValue(),n="";return n+="<"+t+">",r.forEach((function(t){n+="<activityparty>",n+=e.getLookupDataXml("partyid",t),n+="</activityparty>"})),(n+="</"+t+">").toString()},t.prototype.setValue=function(e){var t,r="ClientApi.XrmEntityAttributePartyList.setValue",n=x.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(T.k)(r,"LookupValue[]","value",n));var a=new Array;try{t=Object(O.Ob)(u.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw x.a.getInstance().reportFailure(r+".getLookupTargets",e,null,n),e}e&&t&&(t.push("unresolvedaddress"),e.forEach((function(e){t.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(T.e)(r,'LookupValue[] with invalid entity type. Entity type "'+e.entityType+'" is invalid.',"LookupValue[] with invalid entity type",n))})));try{m.a.instance.reportCall(r),e?(t?e.forEach((function(e){t.indexOf(e.entityType)>-1&&a.push(new ie.a(e.entityType,e.id,e.name))})):e.forEach((function(e){a.push(new ie.a(e.entityType,e.id,e.name))})),this.setValueInternal(a)):this.setValueInternal([]),m.a.instance.reportSuccess(r)}catch(e){throw x.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributePartyList.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(z.h)(t);return m.a.instance.reportSuccess(e),r}catch(t){var n=x.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getIsPartyList=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0},t}(J),se=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorAttributeFile=new d.a(t,"ClientApi.XrmEntityFile.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeFile.execute("getValue",(function(){var t=e.getValueInternal();return Object(z.c)(t)}))},t.prototype.setValue=function(e){var t=this;this._clientApiExecutorAttributeFile.execute("setValue",(function(){t.setValueInternal(e)}))},t}(B),ce=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return p=t,s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeEntityName.getValue";try{m.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(b.a)(p.getState(),this.getParent().getEntityName(),this.getName()),n=null;return r.IsEntityReferenceStored&&Object(g.j)(t)&&(n=t.value),m.a.instance.reportSuccess(e),n}catch(t){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(T.a)(e)||"string"==typeof e||Object(T.k)(t,"string","value");try{m.a.instance.reportCall(t),this.setValueInternal(e),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return m.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"},t}(B),le=r("r529"),ue=r("Xia5"),pe=r("jJRu"),de=r("Cfob"),he=r("cAHA"),ge=r("8aRo"),fe=r("+P1Q"),me=r("qYad"),be=r("9qYn"),ve=r("yZTI"),ye=r("Z1aD"),_e=r("xc1f"),Se=r("Gemh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Oe(e,t,r,n){var a=Object(O.z)(e,t,r,n,r.relationshipName);if(!a||0===a.length)return!0;for(var i=0;i<a.length;i++)if(!Object(O.t)(e,{controlName:a[i],id:t},r))return!0;return!1}function Ce(e,t,r,n,a,i){if(!Object(Se.K)(e,t,r,n,null==i?void 0:i.id))return!1;var o=Object(Se.y)(e,r,t);if(!a||!o)return!1;if(o&&0===o[n])return!1;if(null===a.ParentPicklistLogicalName)return!0;var s=Object(O.ac)(e,t,r),c=Object(O.X)(e,t,r,s,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie,je,Pe,Te=r("UOiB"),xe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return Ie=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";try{m.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Ce(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Oe(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),m.a.instance.reportSuccess(n)}catch(e){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")},t}(re),Ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return je=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";try{m.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Ce(je.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Oe(je.getState(),this.getPageId(),this.contextToken,this.getName()),m.a.instance.reportSuccess(n)}catch(e){var a=x.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),x.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)(n,"Can not execute setValue for dependent option set attribute since it is disabled.")},t}(U),Fe=r("cZkS"),we=r("qC0c"),Ne=r("3ZuC"),Ae=r("WVwd"),ke=r("RK8T"),Me=function(){function e(e,t,r,n,a,i,o,s){Pe=e;var c=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:n,isRequired:!0}];this._clientApiExecutor=new d.a(e,"ClientApi.XrmEntity.",r,t,c),this._pageId=r,this._xrmForm=n,this._contextToken=t,this._entityType=a,this._entityId=i,this._getAttributeNames=o,this._applicationContext=s}return Object.defineProperty(e.prototype,"attributes",{get:function(){var e=this;return this._clientApiExecutor.execute("attributes",(function(t,r){if(!e._attributes){e._attributes=new I.a(t);var n=e._getAttributeNames(e._applicationContext,e._contextToken,e._pageId);if(!n)return e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),r),e._attributes;0===n.length&&e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),r),n.forEach((function(t){var r=Object(b.a)(Pe.getState(),e.getEntityName(),t);if(r){var n=De(Pe,e._contextToken,e._pageId,t,e,e._xrmForm.ui,r);e._attributes.add(t,n)}}))}return e._attributes}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedEntities",{get:function(){var t=this,r="ClientApi.XrmEntity.relatedEntities";try{if(m.a.instance.reportCall(r),!this._relatedEntities){this._relatedEntities=new I.a(r);var n=Object(O.oc)(Pe.getState(),{id:this._pageId},this._contextToken);for(var a in n)if(n[a]){var i=Object(E.m)(this._contextToken,a),o=new e(Pe,i,this._pageId,this._xrmForm,n[a].etn,n[a].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,o),this._updateControl(o,a)}var s=Object(O.nc)(Pe.getState(),{id:this._pageId}),c={};for(var a in s){var l=s[a];c[l.referencingAttribute]||(c[l.referencingAttribute]={}),c[l.referencingAttribute][l.referencedEntity]=a}var u=function(r){Pe.dispatch(Object(P.a)(p._contextToken,p._pageId,r,(function(n){for(var a in c[r]){var i=t._relatedEntities.get(c[r][a]);i&&t._relatedEntities.remove(i)}var o=n.getEventSource().getValue();if(o&&o.length>0){var s=o[0],l=c[r][s.entityType],u=Object(E.m)(t._contextToken,l),p=new e(Pe,u,t._pageId,t._xrmForm,s.entityType,h.a.tryParse(s.id),t._getAttributeNames,t._applicationContext);t._relatedEntities.add(l,p),t._updateControl(p,l)}}),!0))},p=this;for(var d in c)u(d)}return m.a.instance.reportSuccess(r),this._relatedEntities}catch(e){var g=x.a.getInstance().getEventParameters(this._contextToken);throw g.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(r,e,null,g),e}},enumerable:!1,configurable:!0}),e.prototype._updateControl=function(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach((function(r){r instanceof fe.a&&r.updateAttribute(e,t)}))},e.prototype.addOnSave=function(e){var t="ClientApi.XrmEntity.addOnSave";e||Object(T.j)(t,"handler");try{m.a.instance.reportCall(t),Pe.dispatch(Object(P.o)(this._contextToken,this._pageId,e)),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getDataXml=function(){var e="ClientApi.XrmEntity.getDataXml";try{m.a.instance.reportCall(e);var t="";return this.attributes.forEach((function(e){e.getIsDirty()&&(t+=e.getDataXmlInternal())})),t="<"+Object(D.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(D.CrmXmlEncode)(this.getEntityName())+">",m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityReference=function(){var e="ClientApi.XrmEntity.getEntityReference";try{m.a.instance.reportCall(e);var t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return m.a.instance.reportSuccess(e),t}catch(t){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityName=function(){var e="ClientApi.XrmEntity.getEntityName";try{return m.a.instance.reportCall(e),m.a.instance.reportSuccess(e),this._entityType}catch(r){var t=x.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getId=function(){var e="ClientApi.XrmEntity.getId";try{if(m.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING){var t=Object(te.i)(Pe.getState(),this._pageId);if(t&&t.value){var r=t.value;this._entityId=r.id}else{var n=Object(O.ac)(Pe.getState(),this._pageId,this._contextToken);if(n){var a=Object(y.b)(Pe.getState(),n);a&&a.identifier&&(this._entityId=a.identifier.id)}}}return this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING?(m.a.instance.reportSuccess(e),h.a.EMPTYSTRING):(m.a.instance.reportSuccess(e),h.a.externalGuid(this._entityId))}catch(t){var i=x.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getPrimaryAttributeValue=function(){var e=this;return this._clientApiExecutor.execute("getPrimaryAttributeValue",(function(t,r){var n="",a=Object(F.h)(Pe.getState(),e.getEntityName());if(a){if(!a.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",$.a.getInstance().traceManager.getTracer(t).error(n,r),"";var i=Object(O.ac)(Pe.getState(),e._pageId,e._contextToken),o=e.getId()?new f.a(e.getEntityName(),new h.a(e.getId())):new f.a(e.getEntityName()),s=Object(O.X)(Pe.getState(),e._pageId,e._contextToken,i,o,a.PrimaryNameAttribute);if(!s)return"";if(Object(g.j)(s))return s.value;n="PrimaryAttribute value was not an IPlainValue"}else n="Entity descriptor could not be retrieved.";return x.a.getInstance().reportFailure(t,new Error(n),null,r),""}))},e.prototype.getIsDirty=function(){var e="ClientApi.XrmEntity.getIsDirty";try{m.a.instance.reportCall(e);for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return m.a.instance.reportSuccess(e),!0}for(t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return m.a.instance.reportSuccess(e),!0}return m.a.instance.reportSuccess(e),!1}catch(t){var n=x.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnSave=function(e){var t="ClientApi.XrmEntity.removeOnSave";e||Object(T.j)(t,"handler");try{m.a.instance.reportCall(t),Pe.dispatch(Object(P.J)(this._contextToken,this._pageId,e)),m.a.instance.reportSuccess(t)}catch(e){var r=x.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.save=function(e){var t=this;this._clientApiExecutor.executeAsync("save",(function(r,n){var a=1;if(e)if("string"==typeof e)switch(e){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else e.saveMode&&(a=e.saveMode);var i=Pe.getState();return Object(Ae.b)(t._pageId,Pe,a,n,t._contextToken,t,!1,"saveandclose"!==e).then((function(r){return t._performAfterSaveLogic(i,r,e)}))}))},e.prototype.isValid=function(){var e="ClientApi.XrmEntity.isValid";try{if(m.a.instance.reportCall(e),this.attributes)for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return m.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return m.a.instance.reportSuccess(e),!1;return m.a.instance.reportSuccess(e),!0}catch(t){var n=x.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setRecordId=function(e){var t=this,r="ClientApi.XrmEntity.setRecordId";e||Object(T.j)(r,"id");try{if(m.a.instance.reportCall(r),this.getId()&&this._entityId.guid!==h.a.EMPTYGUIDSTRING)m.a.instance.reportSuccess(r);else{var n=h.a.tryParse(e);h.a.isNullOrEmpty(n)&&Object(T.j)(r,"id");var a=Pe.getState(),i=Object(O.ac)(a,this._pageId,this._contextToken),o=Object(E.x)(this._contextToken);if(i){var s=new f.a(this.getEntityName(),n);Pe.dispatch(Object(ue.b)(i,s)),m.a.instance.reportSuccess(r)}else{var c=Object(pe.b)(a,new f.a(this.getEntityName(),n),{},o,he.a.Create),l=c.payload.snapshotId;Pe.dispatch(c),Pe.dispatch(Object(de.b)(this._pageId,l,this._contextToken)).then((function(){m.a.instance.reportSuccess(r)})).catch((function(e){var n=x.a.getInstance().getEventParameters(t._contextToken);n.push({name:"entityName",value:t.getEntityName()}),x.a.getInstance().reportFailure(r+".setDataSnapshotId",e,null,n)}))}}}catch(e){var u=x.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityName",value:this.getEntityName()}),x.a.getInstance().reportFailure(r,e,null,u),e}},e.prototype.refresh=function(){var e=this,t="ClientApi.XrmEntity.refresh";try{if(m.a.instance.reportCall(t),this.getId()){for(var r=new f.a(this.getEntityName(),new h.a(this.getId())),n=[],a=[],i=0;i<this.attributes.getLength();i++)a.push(this.attributes.get(i).getName());var o=Object(ge.a)(Pe.getState(),r.etn);if(o&&a.push.apply(a,o),n.push(Pe.dispatch(Object(me.a)(this._pageId,r,a,new ke.a(f.a.toLegacyEntityReference(r),null,null)))),this.relatedEntities)for(i=0;i<this.relatedEntities.getLength();i++)n.push(this.relatedEntities.get(i).refresh());return Promise.all(n).then((function(){Object(be.b)(e),m.a.instance.reportSuccess(t)})).catch((function(r){var n=x.a.getInstance().getEventParameters(e._contextToken);return n.push({name:"entityName",value:e.getEntityName()}),Object(T.d)(Pe,r,t,n)}))}return m.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){var s=x.a.getInstance().getEventParameters(this._contextToken);return s.push({name:"entityName",value:this.getEntityName()}),Object(T.d)(Pe,e,t,s)}},e.prototype._attributeHasActiveControl=function(e){if(e&&e.controls)for(var t=e.controls.getLength(),r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0;return!1},e.prototype._performAfterSaveLogic=function(e,t,r){var n=Object(O.kb)(Pe.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(be.b)(this),"saveandclose"===r){if(!Object(be.a)(Object(ve.b)(Pe.getState())===this._pageId)){var a=Object(O.Kb)(e,this._pageId),i=Object(O.Ib)(e,this._pageId);if(!a&&!i){var o=Object(Ne.a)(Pe.getState(),this._pageId);return Pe.dispatch(Object(le.b)(o))}}}else if("saveandnew"===r){var s={entityTypeName:this.getEntityName()};return Pe.dispatch(Object(ye.a)(_e.a,s,this._pageId))}return Promise.resolve()},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function De(e,t,r,n,a,i,o){var s=null;switch(o.Type){case"datetime":s=new Y(e,t,r,n,a,i);break;case"decimal":case"double":case"integer":case"money":s=new ee(e,t,r,n,a,i);break;case"lookup":case"owner":case"customer":s=new J(e,t,r,n,a,i);break;case"partylist":s=new oe(e,t,r,n,a,i);break;case"memo":case"string":s=new ne(e,t,r,n,a,i);break;case"picklist":if(Object(we.c)(e.getState(),Fe.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)){s=new xe(e,t,r,n,a,i);break}case"optionset":case"state":case"status":s=new re(e,t,r,n,a,i);break;case"boolean":s=new q(e,t,r,n,a,i);break;case"entityname":s=new ce(e,t,r,n,a,i);break;case"uniqueidentifier":s=new ae(e,t,r,n,a,i);break;case"multiselectpicklist":s=Object(we.c)(e.getState(),Fe.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)?new Ee(e,t,r,n,a,i):new U(e,t,r,n,a,i);break;case"file":s=new se(e,t,r,n,a,i);break;default:s=new B(e,t,r,n,a,i)}return s}},Baft:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="polite",a="assertive"},BuSU:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},Cgjg:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCustomFilter";function o(e,t,r,o,s){return{type:"grid.setCustomFilter.async",execute:function(c,l){var u=c.dispatch,p=(c.getState,l.TraceManager.getTracer(a.z)),d=a.x+".setCustomFilterAction";try{return p.info("Adding a custom filter for the grid. "),u(function(e,t,r,a,o){var s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}var c=Object(n.y)(a),l=Object(n.v)(a);return{type:i,payload:s,meta:{pageId:r,contextKey:c,dataSetContextKey:l}}}(e,t,r,o,s)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){l.EventManager.ReportComponentFailure(d,Error("Adding a custom filter for the grid failed"))}}}}},"Dlr/":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("9r0m"),c=r("YCDx"),l=r("w/nD"),u=r("Sscr"),p=r("/W63"),d=r("IiPO"),h=r("ar+e"),g=r("QUnS"),f=r("Ka9P"),m=r("7bez"),b=r("h82J"),v=r("ezfI"),y=r("kvLG"),_="ClientApi.XrmControlSubGrid.",S=function(e){function t(t,r,a,o,s,c,l,p){var d=e.call(this,t,r,a,l,o,c)||this;return d._relationship=null,n=t,d._subgridToken=Object(u.p)(r,o),d._clientApiExecutorSubGrid=new i.a(t,_,a,d._subgridToken),d.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),d.clientApiExecutor.addEventParameter({name:"isEditable",value:s,isEventParam:!0}),d._gridControl=new m.a(t,d._subgridToken,a,s,3,!0,p,o),t.dispatch(Object(b.a)(d,a,d._subgridToken)),d}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorSubGrid},enumerable:!1,configurable:!0}),t.prototype.setFilterXml=function(e){var t=_+"setFilterXml";try{v.a.instance.reportCall(t),this._gridControl.setFilterXml(e),v.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getFilterXml=function(){var e=_+"getFilterXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFilterXml();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refresh=function(){var e=_+"refresh";try{v.a.instance.reportCall(e),this._gridControl.refresh(),v.a.instance.reportSuccess(e)}catch(r){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getFetchXml=function(){var e=_+"getFetchXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFetchXml();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getGrid=function(){var e=_+"getGrid";try{v.a.instance.reportCall(e);var t=this._gridControl.getGrid();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getViewSelector=function(){var e=_+"getViewSelector";try{v.a.instance.reportCall(e);var t=this._gridControl.getViewSelector();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getTeamTemplateId=function(){var e=_+"getTeamTemplateId";try{v.a.instance.reportCall(e);var t=this._gridControl.getTeamTemplateId();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnLoad=function(e){var t=this;this.clientApiExecutor.execute("addOnLoad",(function(){n.dispatch(Object(l.d)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.removeOnLoad=function(e){var t=this;this.clientApiExecutor.execute("removeOnLoad",(function(){n.dispatch(Object(l.y)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.getEntityName=function(){var e=_+"getEntityName";try{v.a.instance.reportCall(e);var t=this._gridControl.getEntityName();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){var e=this;return this.clientApiExecutor.execute("getControlType",(function(){var t=Object(g.a)(n.getState(),e.controlDescriptor,e.pageId,e.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"}))},t.prototype.getRelationship=function(){var e=this;return this.clientApiExecutor.execute("getRelationship",(function(t,r){var n,a;if(!e._relationship){if(null===(a=null===(n=e.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===a?void 0:a.RelationshipName){var i=e.controlDescriptor.Parameters.RelationshipName,o=e.controlDescriptor.Parameters.RelationshipRoleOrdinal,s=e.controlDescriptor.Parameters.TargetEntityType;e._relationship=Object(m.b)(i,s),e._relationship.roleType=o}e._relationship||(e._relationship=e._gridControl.getRelationship())}return e._relationship}))},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return v.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.openRelatedGrid=function(){var e=this;this.clientApiExecutor.executeAsync("openRelatedGrid",(function(t,r){var a=e.getRelationship();if(!a)return y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",r),Promise.resolve(s.a.EMPTY);for(var i=Object(h.c)(n.getState(),e.pageId),o=null,c=0;c<i.length;c++)if(i[c].relationshipName===a.name){o=i[c];break}if(!o)return r.push({name:"relationshipName",value:a.name}),y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",r),Promise.resolve(s.a.EMPTY);var l={id:o.id,title:o.title,entityName:e.getEntityName(),relationshipName:a.name,isSelected:!0,show:o.show},d=Object(u.a)(e._subgridToken.parentContextToken,a.name,a.roleType?1===a.roleType?f.a.Referencing:f.a.AssociationEntity:void 0);return n.dispatch(Object(p.a)(e.pageId,d,l))}))},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{v.a.instance.reportCall(e),this._gridControl.refreshRibbon(),v.a.instance.reportSuccess(e)}catch(r){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getUrl=function(){var e=_+"getUrl";try{v.a.instance.reportCall(e);var t=this._gridControl.getUrl();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{v.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return v.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t}(c.a)},Ds7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return m}));var n=r("9r0m"),a=r("Sscr"),i=r("uO/V"),o=r("Gemh"),s=r("F2uj"),c=r("VWqI"),l=r("wUng"),u=r("QAhb"),p=r("cZkS"),d=r("qC0c"),h=r("yHpA"),g=r("+Xnp"),f="dataset.row.properties";function m(e,t,r){return{type:"row.properties.async",execute:function(l,h){var m,v,y,_=l.dispatch,S=l.getState,O=h.TraceManager.getTracer(i.z),C=i.x+".RowPropertiesAction",I=Object(d.c)(S(),p.L);try{var j=Object(a.v)(t),P=Object(o.P)(S(),t,{id:e});if(P){var T=null,x=Object(o.Q)(S(),e,t);if(x)T=x;else{var E=Object(o.S)(S(),{id:e},t);E&&E.entityLogicalName&&(T=E.entityLogicalName)}if(T){var F=Object(s.d)(S(),T),w=Object(o.y)(S(),t,e);if(F){for(var N=[],A=0,k=Object.keys(F);A<k.length;A++){var M=F[k[A]],D=Object(c.f)(S(),T,M.LogicalName,g.a.CanUpdate),R=!0;I&&w&&0===w[M.LogicalName]&&(R=!1),N.push(((m={})[M.LogicalName]={requiredLevel:M.RequiredLevel,isDisabled:!(M.IsValidForUpdate&&D&&R),notifications:{}},m))}for(var L=function(e){var t;if(0===P.records.filter((function(t){return Object.keys(t)[0]===n.a.toString(e)})).length)P.records.push(((t={})[n.a.toString(e)]=N,t));else{var r=P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)],a=JSON.parse(JSON.stringify(N));r&&r.forEach((function(e){var t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(a.find((function(t){return Object.keys(t)[0]===Object.keys(e)[0]}))[Object.keys(e)[0]].notifications=t.notifications)})),P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)]=a}},B=0,V=r;B<V.length;B++){L(V[B])}}}if(_(function(e,t,r){return{type:f,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,j,P)),I&&T){F=Object(s.d)(S(),T),w=Object(o.y)(S(),t,e);for(var G=0,z=r;G<z.length;G++){var W=z[G],q=(S(),v=W,y=T,new u.a(y,v)),U=Object(a.f)(t,W,T);if(F)for(var X=0,H=Object.keys(F);X<H.length;X++){M=F[H[X]];w&&1===w[M.LogicalName]&&null===M.ParentPicklistLogicalName&&b(S(),_,e,q,M.LogicalName,U)}}}O.info("creating the rowproperties for {0} rows"+r.length),h.EventManager.ReportComponentSuccess(C)}return Promise.resolve()}catch(e){var K="creating the rowproperties for {0} rows"+r.length+"failed";h.EventManager.ReportComponentFailure(C,Error(K))}}}}function b(e,t,r,n,a,i){var s={},c=Object(o.R)(e,r,i),u=Object(h.d)(e,c,n,a);s[a]=u,Object.keys(s).length>0&&t(Object(l.b)(r,i,!1,s))}},FGem:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.options.clear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:r}}}},FPMG:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="dataset.update.pagingdata";function o(e,t,r){return{type:"dataset.update.pagingdata.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(a.z)),u=a.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),c(function(e,t,r){var a=Object(n.y)(t),o=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}(e,t,r)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var p="Updation of paging data for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(p))}}}}},FuJ2:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("sOTk"),a=r("UOiB"),i=r("Sscr"),o=r("krRo"),s=r("HSdq"),c=r("ObKm"),l=r("yHpA"),u=r("9rlF"),p="attribute.requiredLevel";function d(e,t,r,d){return{type:"attribute.requiredLevel.validation",sync:!0,execute:function(h,g){var f,m=h.getState();if(d!==Object(s.pc)(m,e,t,r)){h.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(o.f)(e,t,r,n);var s=Object(i.x)(t);return{type:p,payload:n,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,d));var b=Object(s.ac)(m,e,t),v=Object(l.b)(m,b);if((0===d||3===d)&&v&&v.activeChanges&&v.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow){var y=null,_=null,S=null,O=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)y=t.entityTypeName?t.entityTypeName:null,_=t.recordId?t.recordId:null,S=Object(i.t)(t),O=Object(i.r)(t);else{var C=Object(n.g)(m,e);y=C&&C.entityTypeName?C.entityTypeName:null,_=C&&C.id?C.id:null,S=null,O=t}var I=Object(l.d)(m,b,{etn:y,id:_},r);if(Object(s.Uc)(I)){var j=((f={})[r]={fieldName:r,value:I?I.formatted?I:Object(u.e)(I):I},f);h.dispatch(Object(c.a)(e,j,!0,!0,y,_?_.guid:null,S,O))}}}}}}},G9wF:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return u}));var n,a=r("c/eZ"),i=r("Zy0S"),o=r("ixd0"),s=r("i8/j"),c=r("9r0m"),l=r("1z64"),u=function(){function e(e,t,r,a,i,c,u){void 0===c&&(c=s.n),void 0===u&&(u=o.a),this._formId=r,n=e,this._entityName=a,this._pageId=i,this._getSelectorItems=c,this._selectorItemType=u,this._clientApiExecutor=new l.a(e,"ClientApi.XrmControlFormSelector.",i,t)}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._clientApiExecutor.execute("items_get",(function(t){if(!e._items){e._items=new i.a(t);var r=e._getSelectorItems(n.getState(),e._entityName);if(r)for(var a in r){var o=r[a],s=o.name||o.DisplayName,l=new e._selectorItemType(new c.a(a),s,n,e._pageId);e._items.add(l.getId(),l)}}return e._items}))},enumerable:!1,configurable:!0}),e.prototype.getCurrentItem=function(){var e=this;return this._clientApiExecutor.execute("getCurrentItem",(function(){for(var t=e.items,r=0;r<t.getLength();r++){var n=t.get(r);if(n.getId()===c.a.toString(e._formId))return n}return null}))},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(u)},Gt1u:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setFormLoadError";function a(e,t){return{type:n,payload:{error:t},meta:{pageId:e}}}},GueY:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r("c/eZ"),a=r("1z64"),i=r("HSdq"),o=r("ezfI"),s=r("Zy0S"),c=r("+ieV"),l=r("2p2B"),u=r("0MLN"),p=r("9r0m"),d=r("G9wF"),h=r("ar+e"),g=r("PhZR"),f=r("YOvo"),m=r("+Z9T"),b=r("IiPO"),v=r("/W63"),y=r("s0Zj"),_=r("Sscr");var S,O,C,I,j,P,T=r("7EJx"),x=function(){function e(e,t,r,n){var a="ClientApi.XrmNavigationItem.constructor";e||Object(m.j)(a,"store"),r||Object(m.j)(a,"pageId"),t||Object(m.j)(a,"contextToken"),Object(m.a)(n)&&Object(m.j)(a,"id"),S=e,this._pageId=r,this._id=n,this._contextToken=t}return e.prototype.getId=function(){return o.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id},e.prototype.getLabel=function(){var e="ClientApi.XrmNavigationItem.getLabel";try{o.a.instance.reportCall(e);var t=Object(i.Rb)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmNavigationItem.getVisible";try{o.a.instance.reportCall(e);var t=Object(i.Ub)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setFocus=function(){var e,t,r,n="ClientApi.XrmNavigationItem.setFocus";try{o.a.instance.reportCall(n),S.dispatch((e=this._pageId,t=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute:function(n,a,i){var o=n.dispatch,s=n.getState,c=Object(h.d)(s(),e,r);if(c){c.isSelected=!0;var l=Object(_.a)(t,c.relationshipName,c.ordinal);o(Object(y.b)(e,void 0,t)),o(Object(v.a)(e,l,c))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),o.a.instance.reportSuccess(n)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.setLabel=function(e){var t="ClientApi.XrmNavigationItem.setLabel";try{if(o.a.instance.reportCall(t),!Object(m.a)(e)){var r=Object(T.s)(S.getState());S.dispatch(Object(g.b)(this._pageId,this._id,e,r))}o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmNavigationItem.setVisible";try{o.a.instance.reportCall(t),S.dispatch(Object(f.b)(this._pageId,this._id,!0===e)),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e}(),E=function(){function e(e,t,r){r||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),O=e,this._pageId=r,this._contextToken=t}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this,t="ClientApi.XrmFormNavigation.items";try{if(o.a.instance.reportCall(t),!this._items){this._items=new s.a(t);var r=Object(h.f)()(O.getState(),{id:this._pageId});r&&r.forEach((function(t){t&&t.relatedItems&&t.relatedItems.forEach((function(t){t&&t.id&&e._items.add(t.id,new x(O,e._contextToken,e._pageId,t.id))}))}))}return o.a.instance.reportSuccess(t),this._items}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},enumerable:!1,configurable:!0}),e}(),F=r("ll2N"),w=r("oPeH"),N=r("e2rP"),A=r("SdPQ"),k=r("lwSE"),M=r("7ipg"),D=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return C=r,o._clientApiExecutor=new M.b(C,"ClientApi.XrmHeaderSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""},t.prototype.getVisible=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")},t.prototype.setVisible=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")},t.prototype.getControlsDescriptor=function(e){var t=Object(i.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.prototype.setCommandBarVisible=function(e){var t=this;this._clientApiExecutor.execute("setCommandBarVisible",(function(){C.dispatch(Object(N.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getCommandBarVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(w.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.commandBarVisible}))},t.prototype.setBodyVisible=function(e){var t=this;this._clientApiExecutor.execute("setBodyVisible",(function(){C.dispatch(Object(A.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getBodyVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(w.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.bodyVisible}))},t.prototype.setTabNavigatorVisible=function(e){var t=this;this._clientApiExecutor.execute("setTabNavigatorVisible",(function(){C.dispatch(Object(k.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getTabNavigatorVisible=function(){var e=this;return this._clientApiExecutor.execute("getTabNavigatorVisible",(function(){var t;return null===(t=Object(w.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.tabNavigatorVisible}))},t.NAME="Header",t}(F.a),R=r("cQE4"),L=r("uCYK"),B=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return I=r,o._clientApiExecutor=new M.b(I,"ClientApi.XrmFooterSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""},t.prototype.getVisible=function(){var e=this;return this._clientApiExecutor.execute("getVisible",(function(){var t;return null===(t=Object(R.a)(I.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.visible}))},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")},t.prototype.setVisible=function(e){var t=this;this._clientApiExecutor.execute("setVisible",(function(){I.dispatch(Object(L.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getControlsDescriptor=function(e){var t=Object(i.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.NAME="Footer",t}(F.a),V=r("RYq1"),G=r("sOTk"),z=r("gk6Q"),W=r("m8A1"),q=r("03gN"),U=r("kvLG"),X=function(){function e(e,t,r,n){var a="ClientApi.XrmProcessControlUI.constructor";n||Object(m.j)(a,"entity"),t||Object(m.j)(a,"contextToken"),r||Object(m.j)(a,"pageId"),e||Object(m.j)(a,"store"),j=e,this._pageId=r;var i=!1;if(Object(W.d)(j.getState(),this._pageId,a)){var o=Object(G.g)(j.getState(),this._pageId);this._processManager=Object(z.b)(this._pageId,o),i=!0}this._contextToken=t;var s=Object(W.b)(r,e.getState(),i);U.a.getInstance().eventManager.ReportComponentSuccess(a,s)}return e.prototype.getDisplayState=function(){var e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(o.a.instance.reportCall(e),!Object(W.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getDisplayState();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmProcessControlUI.getVisible";try{if(o.a.instance.reportCall(e),!Object(W.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),!1;var t=this._getProcessManager().isVisible();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setDisplayState=function(e){var t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(o.a.instance.reportCall(t),!Object(W.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);e!==q.a.collapsed&&e!==q.a.expanded&&e!==q.a.floating||this._getProcessManager().setDisplayState(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmProcessControlUI.setVisible";try{if(o.a.instance.reportCall(t),!Object(W.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reflow=function(e,t,r){var n="ClientApi.XrmProcessControlUI.reflow";try{if(o.a.instance.reportCall(n),!Object(W.d)(j.getState(),this._pageId,n))return void o.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),o.a.instance.reportSuccess(n)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(W.c)(this._processManager,j,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager},e}(),H=r("w/nD"),K=r("UGbr"),Q=r("yHpA"),Y=r("cAHA"),J=r("9qYn"),Z=r("yZTI"),$=r("0hCf"),ee=r("zPLw"),te=function(e){function t(t,r,n,i,o,s){var c=this;return P=t,(c=e.call(this,t,r,n,i,o,s,d.a)||this)._clientApiExecutorFormUI=new a.a(t,"ClientApi.XrmFormUI.",n,r),c._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:o,isEventParam:!0}),c}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"headerSection",{get:function(){var e="ClientApi.XrmFormUI.headerSection";try{return o.a.instance.reportCall(e),this._headerSection||(this._headerSection=new D(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerSection",{get:function(){var e="ClientApi.XrmFormUI.footerSection";try{return o.a.instance.reportCall(e),this._footerSection||(this._footerSection=new B(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.addControls=function(e){var t=b.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};for(var n in t.push(r),e)if(e[n]){r.value=n;var a=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);a&&this.controls.add(a.getName(),a)}},Object.defineProperty(t.prototype,"navigation",{get:function(){var e="ClientApi.XrmFormUI.navigation";try{return o.a.instance.reportCall(e),this._navigation||(this._navigation=new E(P,this.contextToken,this.pageId)),o.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"process",{get:function(){var e="ClientApi.XrmFormUI.process_get";try{o.a.instance.reportCall(e);var t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new X(P,this.contextToken,this.pageId,this.formContext.data.entity));var r=Object(W.a)(this.pageId,P.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return U.a.getInstance().eventManager.ReportComponentSuccess(e,r),o.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}},set:function(e){var t=Object(W.a)(this.pageId,P.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));U.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickForms",{get:function(){var e="ClientApi.XrmFormUI.quickForms";try{return o.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),o.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.clearFormNotification=function(e){var t="ClientApi.XrmFormUI.clearFormNotification";try{o.a.instance.reportCall(t);var r=P.dispatch(Object(l.b)(this.contextToken,this.pageId,e));return o.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}},t.prototype.close=function(){try{o.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(J.a)(Object(Z.b)(P.getState())===this.pageId)||P.dispatch(Object(V.e)(this.pageId)),o.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}},t.prototype.getFormType=function(){var e=this;return this._clientApiExecutorFormUI.execute("getFormType",(function(t,r){var n=e.getFormDescriptor(t,r);if(n){var a=e.formContext;if(a&&a.data&&a.data.entity&&Object(i.Lb)(P.getState(),a.data.entity.getEntityName(),p.a.tryParse(a.data.entity.getId())))return 4;if(Object(i.kb)(P.getState(),{id:e.pageId},e.contextToken))return 3;if(6===n.FormType)return 3;var o=Object(i.ac)(P.getState(),e.pageId,e.contextToken);if(o){var s=Object(Q.b)(P.getState(),o);return s?s.mode===Y.a.Create?1:2:(r.push({name:"snapshotID",value:o}),e._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),r),0)}return a&&a.data&&a.data.entity&&!p.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0}))},t.prototype.isDialog=function(){var e=this;return this._clientApiExecutorFormUI.execute("isDialog",(function(){return Object(G.f)(P.getState(),e.pageId)}))},t.prototype.getViewPortHeight=function(){var e="ClientApi.XrmFormUI.getViewPortHeight";try{o.a.instance.reportCall(e);var t=Object(i.qb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.getViewPortWidth=function(){var e="ClientApi.XrmFormUI.getViewPortWidth";try{o.a.instance.reportCall(e);var t=Object(i.rb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.setFormEntityName=function(e){var t="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(e,t,"name");try{o.a.instance.reportCall(t),P.dispatch(Object(u.b)(this.pageId,this.contextToken,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.setFormNotification=function(e,t,r,n,a){var i=this;return this._clientApiExecutorFormUI.execute("setFormNotification",(function(o,s){var l;switch(Object(m.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":l=ee.a;break;case"WARNING":l=ee.e;break;case"INFORMATION":case"INFO":l=ee.b;break;default:Object(m.h)(o,"notificationLevel",t,s)}return!Object(m.a)(e)&&"string"==typeof e&&(P.dispatch(Object(c.c)(i.contextToken,i.pageId,e,l,r,n,a)),!0)}))},t.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.refresh=function(){var e=this,t="ClientApi.XrmFormUI.refresh";try{o.a.instance.reportCall(t);var r=Object(G.l)(P.getState(),this.pageId);return P.dispatch(Object(K.f)(this.pageId,r,!0,1,!0,!0)).then((function(r){return Object(J.b)(e.formContext.data.entity),o.a.instance.reportSuccess(t),r})).catch((function(r){var n=b.a.getInstance().getEventParameters(e.contextToken);return Object(m.d)(P,r,t+".saveFormAndNavigate",n)}))}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)(P,e,t,n)}},t.prototype._reportFailure=function(e,t){var r=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,r),t},t}($.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},HRxj:function(e,t,r){"use strict";r.d(t,"a",(function(){return H}));var n=r("c/eZ"),a=r("nuS9"),i=r("NJzV"),o=r("4E+q"),s=r("Tr6b"),c=r("YWpA"),l=r("wV3W"),u=r("5olG"),p=r("LWFb"),d=r("Sscr"),h=r("ar+e"),g=r("/W63"),f=r("MLbG"),m=r("Vm/X"),b=r("mGpW"),v=r("Ww2r");var y=r("kyRo"),_=r("Ka9P"),S=r("uO/V"),O=r("dUXI"),C=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0},r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){e>0&&e!==this.state.width&&this.setState({width:e})},t.prototype.render=function(){var e;if(!this.props.configuration)return null;var t=this.state.width,r=this.props.rowSpan*this.props.rowHeight,n={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},o={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"navigateToAssociatedGrid",eventhandler:[this._navigateToAssociatedGrid.bind(this)]}]};return a.createElement(c.a,{key:"FormCellChart_"+this.props.id,testhooks:{id:"FormCellChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this.state.width>0&&a.createElement(c.a,{key:"FormCellChart_"+this.props.id+"_container",style:n,id:this.props.domId,testhooks:(e={},e[p.b]=this.props.previewId,e[p.c]=20,e)},a.createElement(i.c,{key:this.props.key,controlId:this.props.controlId,id:this.props.id,systemDefinedProperties:this.props.customControlPropertyBag,configuration:this.props.configuration,descriptor:this.props.descriptor,parentDefinedControlProps:o})))},t.prototype._navigateToAssociatedGrid=function(){var e=this,t=this._getRelatedEntityItemForChart(this.props),r="FormCellChart.navigateToAssociatedGrid",n=[];if(!t){var a=this.props.descriptor&&this.props.descriptor.Parameters?this.props.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null,i=String.format(this.props.chartNavigationErrorDetail,a);return r="FormCellChart.openErrorDialog",n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:a}],this.props.openErrorDialog(this.props.chartNavigationError,[i],this.props.id,"https://docs.microsoft.com/en-us/powerapps/maker/model-driven-apps/add-edit-form-navigation-related-entities").then((function(){e.context.EventManager.ReportComponentSuccess(r,n)}),(function(t){e.context.EventManager.ReportComponentFailure(r,t,"",n)}))}var o=Object(d.a)(this.props.contextToken.parentContextToken,t.relationshipName,t.ordinal);return n=[{name:"pageEtn",value:this.props.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:t.relationshipName},{name:"associatedGridEntityName",value:t.entityName}],this.props.openRelatedGrid(this.props.id,o,t).then((function(){e.context.EventManager.ReportComponentSuccess(r,n)}),(function(t){e.context.EventManager.ReportComponentFailure(r,t,"",n)}))},t.prototype._getRelatedEntityItemForChart=function(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;var t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null;if(!t)return null;var r=null;return e.associatedGridsRelationshipInfo.forEach((function(e){!r&&e&&e.relatedItems&&e.relatedItems.forEach((function(e){!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==_.a.Referencing||(r=e)}))})),r?{id:r.id,title:r.title,entityName:r.entityName,isSelected:!0,relationshipName:r.relationshipName,url:r.url,ordinal:r.ordinal}:null},t}(a.Component);var I=Object(o.a)((function(){var e,t,r=(e=null,t=Object(h.f)(),function(r,n){return e||(e=t(r,{id:n.id})),e});return function(e,t){var n=Object(l.a)(e),a=Object(u.a)(n.sizes.Section.cellHeightInRem),i=r(e,t),o=Object(v.b)(e,O.k),s=Object(v.b)(e,O.l);return{rowHeight:a,associatedGridsRelationshipInfo:i,chartNavigationError:o,chartNavigationErrorDetail:s}}}),(function(e,t){return{openRelatedGrid:function(t,r,n){return e(Object(g.a)(t,r,n))},openErrorDialog:function(t,r,n,a){return e(function(e,t,r,n){return{type:"form.openFormChartErrorDialog",execute:function(a,i,o){var s=["ErrorIconAltInformation","Button_Label_OK","L_Show_Details_Text","L_Help_Label_Text"];return a.dispatch(Object(b.e)(s)).then((function(){var i=Object(v.e)(a.getState(),s),o=Object(v.c)(i,"ErrorIconAltInformation"),c=Object(v.c)(i,"Button_Label_OK"),l=Object(v.c)(i,"L_Show_Details_Text"),u={dynamicHelpLabel:Object(v.c)(i,"L_Help_Label_Text"),dynamicHelpURL:n};return a.dispatch(Object(f.a)(m.d,void 0,{type:"information"},void 0,o,e,c,l,t,!0,r,u))}))}}}(t,r,n,a))}}}))(C);C.contextType=y.a;var j=Object(o.a)((function(e){return{cellHeightInRem:Object(l.a)(e).sizes.Section.cellHeightInRem}}))((function(e){var t=window.innerWidth<=381?1.32:0,r={height:Object(u.a)(t+e.cellHeightInRem)+"px"};return a.createElement(c.a,{id:e.domId,testhooks:{id:e.controlName},style:r},e.disableWebResourceControlsMessage)})),P=r("NxDw"),T=r("swEE"),x=r("9r0m"),E=r("RlP9"),F=r("qC0c"),w=r("2OIc"),N=r("Gemh"),A=r("cZkS"),k=r("HSdq");var M=r("oY7N"),D=r("6ebE"),R=["OpenAssociatedGridViewImageButtonTooltip","OpenAssociatedGridViewImageButtonText","OpenAllRecordsViewImageButtonText","OpenAllRecordsViewImageButtonToolTip"],L=r("Z1aD"),B=r("r2h9"),V=r("I0a0"),G=r("0hZT");function z(e){if(!e.associatedGridsRelationshipInfo||0===e.associatedGridsRelationshipInfo.length)return null;var t=e.descriptor&&e.descriptor.Parameters?e.descriptor.Parameters[S.F.RELATIONSHIP_NAME]:null;if(!t)return null;var r=null;return e.associatedGridsRelationshipInfo.forEach((function(e){!r&&e&&e.relatedItems&&e.relatedItems.forEach((function(e){!e||e.relationshipName!==t||e.ordinal&&e.ordinal!==_.a.Referencing||(r=e)}))})),r?{id:r.id,title:r.title,entityName:r.entityName,isSelected:!0,relationshipName:r.relationshipName,url:r.url,ordinal:r.ordinal}:null}var W=Object(o.a)((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(){var e,t,r,n=(e=null,t=Object(h.f)(),function(r,n){return e||(e=t(r,{id:n.id})),e}),a=(r=null,function(e,t){if(r)return r;var n=t&&t.CustomControlId?t.CustomControlId:null;if(!n)return null;var a=Object(N.ab)(e,n),i=Object(w.e)(e,n);if(a&&i&&i.Properties.DataSetDefinitions&&i.Properties.DataSetDefinitions[a]&&i.Properties.DataSetDefinitions[a].CDSDataSetOptions){var o=i.Properties.DataSetDefinitions[a].CDSDataSetOptions;r={displayChart:!(!o.hasOwnProperty("displayChart")||!o.displayChart),displayCommandBar:!(!o.hasOwnProperty("displayCommandBar")||!o.displayCommandBar),displayIndex:!(!o.hasOwnProperty("displayIndex")||!o.displayIndex),displayQuickFind:!(!o.hasOwnProperty("displayQuickFind")||!o.displayQuickFind),displayViewSelector:!(!o.hasOwnProperty("displayViewSelector")||!o.displayViewSelector)}}return r});return function(e,t){var r=null,i=null;if(Object(F.c)(e,A.Fc)){var o=Object(E.c)(e,x.a.tryParse(t.descriptor.Parameters.ViewId));i="actioncard"===(i=o?o.entityLogicalName:null)?null:i,r=n(e,t)}var s=a(e,t.configuration),c=Object(k.Eb)(e,t.id);return{associatedGridsRelationshipInfo:r,gridEntityTypeName:i,subgridControlDataSetUIOptions:s,isInsideFormComponentInstance:c}}}),(function(e,t){return{openRelatedGrid:function(t,r,n){return e(Object(g.a)(t,r,n))},createXrm:function(t){return e(Object(D.b)(t))},openGrid:function(t,r){return e(Object(L.a)(G.a,r,t))}}}))((function(e){var t=e.controlName,r=e.id,n=e.rowSpan,i=a.useContext(y.a),o=Object(V.a)(R),s=!1,c=[],l=z(e);if(l&&!e.isInsideFormComponentInstance){var u={Icon:"TableLink",Tooltip:{title:Object(v.c)(o,"OpenAssociatedGridViewImageButtonTooltip")},DisplayText:Object(v.c)(o,"OpenAssociatedGridViewImageButtonText"),Id:"navigateToAssociatedGrid-"+l.relationshipName+"-"+e.id,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:function(){return function(e,t){var r=z(e);if(!r)return Promise.reject("related entity item not found for this button");var n=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"associatedGridRelationship",value:r.relationshipName},{name:"associatedGridEntityName",value:r.entityName}],a=Object(d.a)(e.contextToken.parentContextToken,r.relationshipName,r.ordinal);return e.openRelatedGrid(e.id,a,r).then((function(){t.EventManager.ReportComponentSuccess("ShowFullView.navigateToAssociatedGrid",n)}),(function(e){t.EventManager.ReportComponentFailure("ShowFullView.navigateToAssociatedGrid",e,"",n)}))}(e,i)}};c.push(u)}else if(e.gridEntityTypeName){var p={Icon:"TableGroup",Tooltip:{title:Object(v.c)(o,"OpenAllRecordsViewImageButtonToolTip")},DisplayText:Object(v.c)(o,"OpenAllRecordsViewImageButtonText"),Id:"navigateToGrid-"+e.id,WillOpenFlyout:!1,IsInFlyout:!0,Children:null,execute:function(){return function(e,t){var r={pageType:"entitylist",viewId:e.descriptor.Parameters.ViewId?new x.a(e.descriptor.Parameters.ViewId):null,entityTypeName:e.gridEntityTypeName,viewType:"true"===e.descriptor.Parameters.isUserView?B.b.userview:B.b.savedview},n=[{name:"pageEtn",value:e.contextToken.parentContextToken.entityTypeName},{name:"gridEtn",value:e.gridEntityTypeName},{name:"viewId",value:e.descriptor.Parameters.ViewId}];return e.openGrid(e.id,r).then((function(e){e&&0===e.status?t.EventManager.ReportComponentSuccess("ShowFullView.navigateToGrid",n):t.EventManager.ReportComponentFailure("ShowFullView.navigateToGrid",e.error,"",n)}))}(e,i)}};c.push(p)}var h={shouldRender:e.shouldRender,gridConfigurations:e.configurations,addedCommandListFromHostParent:c},g=null;return"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.CustomControlId||"MscrmControls.Grid.GridControl"===e.configuration.CustomControlId||"MscrmControls.MailApp.MailAppListControl"===e.configuration.CustomControlId||"MscrmControls.Grid.ReadOnlyGrid"===e.configuration.Name||"MscrmControls.Grid.GridControl"===e.configuration.Name||"MscrmControls.MailApp.MailAppListControl"===e.configuration.Name?(g={displayChart:!0,displayCommandBar:!0,displayIndex:!0,displayQuickFind:!0,displayViewSelector:!0},s=!0):e.subgridControlDataSetUIOptions?(g=e.subgridControlDataSetUIOptions,e.subgridControlDataSetUIOptions.displayCommandBar&&(s=!0)):g={displayChart:!1,displayCommandBar:!1,displayIndex:!1,displayQuickFind:!1,displayViewSelector:!1},"MscrmControls.Calendar.CalendarControl"===e.configuration.Name&&(g.displayCommandBar=!0,s=!0),g.displayCommandBar=s,a.createElement(M.a,{key:r+t,id:r,previewId:e.previewId,controlId:t,contextString:S.h.SUBGRID,configuration:e.configuration,descriptor:e.descriptor,systemDefinedProperties:e.customControlPropertyBag,rowSpan:n,parentContextToken:e.parentContextToken,nonCompositionProps:h,formInfo:e.formInfo,dataSetUIOptions:g,parentDefinedControlProps:e.parentProps})})),q=r("uGUB"),U=r("HHlV"),X=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.onRenderCompleteCallback=n.onRenderCompleteCallback.bind(n),t.domId&&!r.AccessibilityManager.isClientAPISetFocusScheduled()&&(n._intersectionObserverHelper=t.intersectionObserverHelper),n.state={visibleToViewport:!n._intersectionObserverHelper||void 0},n}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this._observeCell(),this.onRenderCompleteCallback()},t.prototype.componentDidUpdate=function(){this._observeCell()},t.prototype._observeCell=function(){this._intersectionObserverHelper&&!this.state.visibleToViewport&&this._intersectionObserverHelper.observe(this)},t.prototype.componentWillUnmount=function(){this._intersectionObserverHelper&&this._intersectionObserverHelper.unobserve(this)},t.prototype.getDomId=function(){return this.props.domId},t.prototype.intersecting=function(){var e=this;this.state.visibleToViewport||Object(q.c)((function(){return e.setState({visibleToViewport:!0})}))},t.prototype.onRenderCompleteCallback=function(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()},t.prototype._transformStyle=function(){var e=this.props.defaultCellStyle;return this.props.style&&Object.keys(this.props.style).length>0&&(e=Object(n.__assign)(Object(n.__assign)({},e),this.props.style)),!1===this.props.isParentPaddingAdded&&1!==this.props.cellControlMode&&this.props.configuration.Name!==U.d&&(e=Object(n.__assign)(Object(n.__assign)({},e),this.props.extraSidePaddingStyle)),e},t.prototype.render=function(){return this.state.visibleToViewport&&!this.props.disableWebResourceControlsMessage?this._render():a.createElement(j,{controlName:this.props.controlName,domId:this.props.domId,disableWebResourceControlsMessage:this.props.disableWebResourceControlsMessage})},t.prototype._render=function(){var e,t,r,n;if(void 0!==this.props.overriddenVisibility&&!this.props.overriddenVisibility)return null;if(!this.props.descriptor||!this.props.informationAvailableToRender)return null;if(this.props.clientHost===P.a.MobileApplication&&void 0!==this.props.descriptor.Parameters.ShowOnMobileClient&&"false"===this.props.descriptor.Parameters.ShowOnMobileClient||this.props.clientHostSubtype===T.a.Phone&&null!==this.props.availableForPhone&&void 0!==this.props.availableForPhone&&!this.props.availableForPhone)return null;if(this.props.isCreateForm&&this.props.isRelatedDataSetControl&&!this.props.isPreviewMode)return null;var o=this.props,s=o.controlName,l=o.id,u=o.userSpacer,d=o.rowSpan;if(this._parentProps||(this._parentProps={parentInSeeMoreMode:this.props.inDialogWithZIndex,parentFlyoutId:this.props.parentFlyoutRoot}),u)return a.createElement(c.a,{id:this.props.domId,style:this.props.spacerCellStyle,testhooks:(e={},e[p.b]=this.props.previewId,e[p.c]=20,e["control-name"]=s,e)});if(!s)return null;if(2===this.props.cellControlMode)return a.createElement(c.a,{style:this._transformStyle(),testhooks:(t={},t["control-name"]=s,t),id:this.props.domId},a.createElement(I,{key:s+l,controlId:s,id:l,domId:this.props.domId,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,style:this._transformStyle(),rowSpan:d,contextToken:this.props.contextToken}));if(1===this.props.cellControlMode)return a.createElement(c.a,{style:this._transformStyle(),testhooks:(r={},r["control-name"]=s,r),id:this.props.domId},a.createElement(W,{key:s+l,controlName:s,id:l,previewId:this.props.previewId,customControlPropertyBag:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:this.props.configuration,configurations:this.props.configurations,rowSpan:d,isRemoteAvailable:this.props.isRemoteAvailable,isEntityEnabledForOffline:this.props.isEntityEnabledForOffline,parentProps:this._parentProps,contextToken:this.props.contextToken,parentContextToken:this.props.parentContextToken,shouldRender:this.props.shouldRender,formInfo:this.props.formInfo}));var h=this.props.configuration.Children&&this.props.configuration.Children.fieldControl,g=h?h.CustomControlId:this.props.configuration.CustomControlId,f=!1===this.props.useControlWrapper&&h?h:this.props.configuration;return a.createElement(c.a,{style:this._transformStyle(),testhooks:(n={id:s},n[p.b]=this.props.previewId,n[p.c]=20,n["control-name"]=s,n),id:this.props.domId},a.createElement(i.c,{key:s+l+g,controlId:s,id:l,systemDefinedProperties:this.props.customControlPropertyBag,descriptor:this.props.descriptor,configuration:f,rowSpan:d,formInfo:this.props.formInfo,shouldRender:this.props.shouldRender,parentContextToken:this.props.parentContextToken,parentDefinedControlProps:this._parentProps}))},t}(a.Component);X.displayName="Cell";var H=Object(o.a)(s.c)(X);X.contextType=y.a},HfRC:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("xc1f"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,l,u){var p={entityTypeName:e.etn,id:e.id,formId:r,data:i,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(a.a)(n.a,p,t)}},I6xF:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n="powerbi.signedin.state";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},IF6v:function(e,t,r){"use strict";r.d(t,"a",(function(){return T}));var n=r("c/eZ"),a=r("nuS9"),i=r("4E+q"),o=r("H/hG"),s=r("evW+"),c=r("pxbl"),l=r("Smta"),u=r("YWpA"),p=r("wV3W"),d=r("aPRd"),h=r("zt+H"),g=r("qC0c"),f=r("cZkS");var m=r("vTeb"),b=r("5aNC"),v=r("yotr"),y=r("XIN1"),_=r("znb3"),S=r("9rQ4"),O=r("Wi7Z"),C=r("zPLw"),I=r("Ww2r"),j=r("Ro59"),P=function(e){function t(t){var r=e.call(this,t)||this;return r._onButtonClick=r._onButtonClick.bind(r),r._onNotificationClick=r._onNotificationClick.bind(r),r.toggleExpandMessage=r.toggleExpandMessage.bind(r),r.onRenderCompleteCallback=r.onRenderCompleteCallback.bind(r),r.onKeyDownAnchorEvent=r.onKeyDownAnchorEvent.bind(r),r.onKeyDownEvent=r.onKeyDownEvent.bind(r),r.state={messageExpanded:!1},r._backgroundCanvas=document.createElement("canvas"),r}return Object(n.__extends)(t,e),t.prototype.toggleExpandMessage=function(e){e&&e.stopPropagation(),this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{messageExpanded:!this.state.messageExpanded}))},t.prototype._renderButtons=function(){var e=this.props.notification.Buttons,t=[];if(!e||0===e.length)return null;for(var r in e){var i=e[r],c=Object(b.b)(this.props.notification.UniqueId,r),l=0===t.length?this.props.buttonStyle:this.props.secondaryButtonStyle,p=Object(n.__assign)(Object(n.__assign)({},l),0===t.length?this.props.firstButtonStyle:{});if(t.push(a.createElement(s.a,{key:c,id:c,style:p,onClick:this._onButtonClick.bind(this,i),title:i.Label},a.createElement(o.a,{testhooks:{id:i.Label},style:0===t.length?this.props.buttonLabelStyle:this.props.secondaryButtonLabelStyle},i.Label))),t.length>2)break}return a.createElement(u.a,{key:"buttonWrapper",style:this.props.buttonWrapperStyle},t)},t.prototype._renderCloseButton=function(){return this.props.closeAction&&a.createElement(s.a,{onClick:this.props.closeAction,style:this.props.closeButtonStyle},a.createElement(y.b,{type:_.a.Cancel}))},t.prototype._renderMessage=function(e,t){var r=this.props.notification.MessagePlaceholders,n=[],i="",s=this.state.messageExpanded||!t?99:2;if(r&&r.length>0&&this._getPlacehoderCountInMessage()===r.length){var l=this.props.notification.Message.split(/{[0-9]+}/);for(var p in l){var d=l[p];if(n.push(d),i=i.concat(d),parseInt(p,10)<r.length){var h=r[parseInt(p,10)],g=Object(v.b)(this.props.notification.UniqueId,p);i=i.concat(h.Label),h.Handler?n.push(a.createElement(m.a,{key:g,id:g,style:this.props.placeHolderLinkStyle,href:null,onClick:this._onButtonClick.bind(this,h)},h.Label)):n.push(h.Label)}}}return a.createElement(u.a,{key:"message",style:this.props.notificationType===C.a?this.props.notificationErrorMessageStyle:this.props.notificationMessageStyle},a.createElement(c.a,{noExpandable:!0,truncatedlines:s,testhooks:{id:"warningNotification"}},n&&n.length>0?n:this.props.notification.Message,e&&this.state.messageExpanded?a.createElement(o.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageTruncate()):null),e&&!this.state.messageExpanded?a.createElement(o.a,{onClick:this.toggleExpandMessage,style:this.props.notificationExpandTextStyle,tabIndex:0,onKeyDown:this.onKeyDownEvent},this._notificationLongMessageExpand()):null)},t.prototype._getPlacehoderCountInMessage=function(){return(this.props.notification.Message.match(/{[0-9]+}/g)||[]).length},t.prototype._onButtonClick=function(e,t){t.preventDefault(),this.props.buttonOnClick(e)},t.prototype._notificationLongMessageTruncate=function(){return Object(I.c)(this.props.resourceStrings,j.c)},t.prototype._notificationLongMessageExpand=function(){return Object(I.c)(this.props.resourceStrings,j.b)},t.prototype._getMessageIcon=function(e,t){switch(e){case C.a:return a.createElement(u.a,{accessibilityHidden:!0,style:this.props.errorIconStyleWrapper},a.createElement(y.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.MarkAsLost}));case C.e:return a.createElement(u.a,{accessibilityHidden:!0,style:this.props.warningIconStyleWrapper},a.createElement(y.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.Warning}));case C.d:return a.createElement(u.a,{accessibilityHidden:!0,style:this.props.successIconStyleWrapper},a.createElement(y.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.SuccessIcon}));case C.c:return a.createElement(u.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},a.createElement(y.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.Locked,testhooks:{id:"formReadOnlyIcon"}}));default:return a.createElement(u.a,{accessibilityHidden:!0,style:this.props.infoIconStyleWrapper},a.createElement(y.b,{style:this.props.notificationIconStyle,id:"notification_icon_"+t,type:_.a.InformationIcon}))}},t.prototype.onRenderCompleteCallback=function(){this.props.shouldNotifyRenderComplete&&this.props.onRenderComplete()},t.prototype.componentDidMount=function(){this.onRenderCompleteCallback()},t.prototype.onKeyDownEvent=function(e){e.keyCode===S.a.Escape?this.props.keyDownHandler(e):e.keyCode===S.a.Enter&&this.toggleExpandMessage()},t.prototype.onKeyDownAnchorEvent=function(e){e.keyCode===S.a.Escape?this.props.keyDownHandler(e):e.keyCode===S.a.Enter&&this._onNotificationClick()},t.prototype._onNotificationClick=function(){this.props.notification.OnNotificationClick&&(!this.props.onlyNotification&&this.props.toggleFlyout&&this.props.toggleFlyout(),this.props.notificationClick())},t.prototype._isLongMessage=function(){var e=this._backgroundCanvas.getContext("2d");return e.font=this.props.notificationMessageStyle.fontSize&&this.props.notificationMessageStyle.fontFamily,e.measureText(this.props.notification.Message).width/this.props.domWidth>=2},t.prototype.render=function(){var e=this._isLongMessage(),t=!this.props.useSeeMoreBtn&&e,r=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationStyle),this.props.displayFullMessage?{maxHeight:"none"}:{}),{":hover":{backgroundColor:this.props.notification.OnNotificationClick||t?"#F3F2F1":""},cursor:this.props.notification.OnNotificationClick||t?"pointer":"default"});return a.createElement(l.a,{key:"Notification_"+this.props.notification.UniqueId,style:r,onClick:this.props.notification.OnNotificationClick?this._onNotificationClick.bind(this):void 0,onKeyDown:this.props.notification.OnNotificationClick?this.onKeyDownAnchorEvent:this.onKeyDownEvent,role:!this.props.onlyNotification||"ERROR"!==this.props.notification.Level&&"INFORMATION"!==this.props.notification.Level&&"WARNING"!==this.props.notification.Level?void 0:O.a},a.createElement(o.a,{key:"text",style:this.props.messageIconWrapperStyle},a.createElement(o.a,{style:this.props.messageIconStyle,accessibilityHidden:!0},this._getMessageIcon(this.props.notification.Level,this.props.notification.Message))),a.createElement(u.a,{key:"notificationMessageAndButtons",id:"notificationMessageAndButtons",onClick:this.props.notification.OnNotificationClick||!t?void 0:this.toggleExpandMessage,style:this.props.notificationMessageAndButtonsStyle,isRequestedMeasuring:!!this.props.buttonMeasuringCallback,onMeasuring:this.props.buttonMeasuringCallback},this._renderMessage(this.props.useSeeMoreBtn&&e,e),this._renderButtons()),this._renderCloseButton())},t}(a.Component);P.displayName="FormNotification";var T=Object(i.a)((function(){var e,t,r,a,i,o=(e=null,t=null,r=null,a=!1,i=null,function(o,s){var c=Object(p.a)(o),l=Object(d.c)(o),u=Object(g.a)(o,f.ob);if(t!==c||r!==l||a!==s.onlyNotification||i!==s.notificationType){t=c,r=l,a=s.onlyNotification,i=s.notificationType;var m=s.notificationWidth<=c.sizes.Breakpoints.DimensionXS;e={formNotificationStyle:{display:"flex",width:"100%",flexDirection:"row",backgroundColor:s.onlyNotification?Object(h.d)(s.notificationType):"#FFFFFF",paddingRight:"10px",paddingLeft:"10px",minHeight:h.a+"px",height:"auto",lineHeight:c.sizes.Measures.Measure100,boxSizing:"border-box",overflow:"hidden",borderBottom:s.onlyNotification?"":"1px solid "+h.c},notificationMessageAndButtonsStyle:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",paddingLeft:"9px",paddingRight:"9px"},notificationMessageStyle:{flexGrow:1,whiteSpace:"normal",padding:0,marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:c.fontFamilies.Regular,color:"#1F2126"},notificationExpandTextStyle:{fontSize:"12px",whiteSpace:"nowrap",paddingTop:"16px",fontFamily:c.fontFamilies.Regular,color:"#0000FF",paddingLeft:"2px",paddingRight:"2px",cursor:"pointer"},notificationErrorMessageStyle:{flexGrow:1,whiteSpace:"normal",marginTop:"7px",marginBottom:"7px",lineHeight:"16px",overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px",fontFamily:c.fontFamilies.Regular,color:"#1F2126"},buttonWrapperStyle:{marginBottom:"5px",maxWidth:"100%",flexWrap:m?"wrap":"nowrap",marginTop:"5px"},buttonStyle:{height:"21px",backgroundColor:"#6E6F77",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #3A3C42",boxSizing:"border-box",borderRadius:"2px",backgroundColor:"#3A3C42"}},secondaryButtonStyle:{height:"21px",backgroundColor:"#FFFFFF",border:"1px solid #6E6F77",boxSizing:"border-box",borderRadius:"2px",":hover":{border:"1px solid #A4A6AC",boxSizing:"border-box",backgroundColor:"#E8EAEC",borderRadius:"2px"}},buttonLabelStyle:Object(n.__assign)(Object(n.__assign)({},c.buttons.ButtonPrimaryText),{color:"#FFFFFF",lineHeight:"19px",fontSize:"12px"}),secondaryButtonLabelStyle:Object(n.__assign)(Object(n.__assign)({},c.buttons.ButtonSecondaryText),{color:"#1F2126",lineHeight:"19px",fontSize:"12px"}),placeHolderLinkStyle:{cursor:"pointer",color:c.colors.BaseColor.Blue.Blue3,padding:0},messageIconWrapperStyle:{boxSizing:"content-box",minWidth:u?"16px":"20px",height:u?"16px":"20px",position:"relative"},messageIconStyle:{position:"absolute",height:u?"16px":"20px",width:u?"16px":"20px",paddingTop:"9px"},firstButtonStyle:{marginRight:m?"0":"0.5rem"},errorIconStyleWrapper:{color:h.f},successIconStyleWrapper:{color:h.h},warningIconStyleWrapper:{color:h.i},infoIconStyleWrapper:{color:h.g},notificationIconStyle:{fontSize:"20px"},closeButtonStyle:{backgroundColor:"transparent",borderWidth:0,marginTop:"8px",height:"16px",fontSize:"16px",padding:0}}}return e}),s=Object(I.h)();return function(e,t){var r=o(e,t),a=s(e,j.f),i=Object(g.a)(e,f.ob);return Object(n.__assign)(Object(n.__assign)({},r),{resourceStrings:a,useSeeMoreBtn:i})}}),(function(e,t){return{buttonOnClick:function(t){t.Handler&&("function"==typeof t.Handler?t.Handler():e(t.Handler))},notificationClick:t.notification.OnNotificationClick&&function(){return e(t.notification.OnNotificationClick)},closeAction:t.notification.CloseAction&&function(){return e(t.notification.CloseAction)}}}))(P)},Ini7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.removeOption";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},JFej:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.option.add";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.x)(t);return{type:a,payload:{option:i,index:o},meta:{pageId:e,contextKey:s,dataFieldName:r}}}},JVfT:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="update.grid.paging.refresh.input";function o(e,t){return{type:"update.grid.paging.refresh.input.async",execute:function(r,o){var s=r.dispatch,c=(r.getState,o.TraceManager.getTracer(a.z)),l=a.x+".updateGridPagingRefreshInputAction";try{var u=Object(n.u)(t);return s(function(e,t){return{type:i,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}(e,u)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var p="Updating the grid pagingRefreshInput failed with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(p))}}}}},Jcuz:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r={displayState:e};return{type:n.c,payload:r}}},Je7O:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(){}return e.prototype.get_ErrorType=function(){return this._errorType},e.prototype.set_ErrorType=function(e){this._errorType=e},e.prototype.get_ErrorDescription=function(){return this._errorDescription},e.prototype.set_ErrorDescription=function(e){this._errorDescription=e},e}()},KDdL:function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return f})),r.d(t,"d",(function(){return m})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return b})),r.d(t,"a",(function(){return v}));var n=r("9r0m"),a=r("G7N+"),i=r("dUXI"),o=r("8ADW"),s=r("y5DA"),c=r("lMVv"),l=r("Ww2r"),u=r("JlqV"),p=r("9rlF"),d=r("F2uj"),h=o.a;function g(e,t,r,a,p,d,g,f){return void 0===f&&(f=!1),function(e,t,r){if(!n.a.toString(r.viewId)){var a="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(a),o.d,t),new Error(a)}return!0}(r,a,p)&&function(e,t,r,a,o){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){var u=e(),p=Object(l.b)(u,i.n),d=Object(c.f)(u,a)||a,h=String.format(p,d);return Object(s.a)(u,t,h,r,o),!1}return!0}(e,t,p,d,g)&&function(e,t,r,n){var a=e();if(!Object(u.b)(a)){var o=Object(l.b)(a,i.r);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,p,g)&&function(e,t,r,n){if(r.isRollUpView){var a=e(),o=Object(l.b)(a,i.j);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,p,g)&&(!f||function(e,t,r,n){if(!r.viewXml){var a=Object(l.b)(e(),i.g);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,p,g)&&function(e,t,r,n){if(!r.fetchXml){var a=Object(l.b)(e(),i.o);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,p,g))}function f(e,t,r){var i,o,s=new n.a(e),c=n.a.toString(s),l=new n.a(t),u=n.a.toString(l);return{type:r,payload:{charts:(i={},i[c]=(o={},o[u]={initialized:a.a.Initializing},o),i)}}}function m(e,t){var r;return{type:t,payload:{chartData:(r={},r[e]={initialized:a.a.Initializing},r)}}}function b(e,t,r){var n,a=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(function(e,t){var r;if(!e)return!1;var n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,a=null==e?void 0:e.attributeName,i=Object(d.b)(a,n,t);return"picklist"===i||"state"===i||"status"===i}(i,r)&&e.isOrderPresentOnPrimaryGroupBy()){var o=i.aliasName,s=new y(o);t.sort(s.comparator),a.descending&&t.reverse()}}function v(e){var t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g")),n=[];return r&&r.forEach((function(e){n=e.match(new RegExp(t,"m"))})),n}var y=function(){function e(e){var t=this;this._primaryGroupByAttributeAlias=null,this.comparator=function(e,r){return t._getRawValue(e)-t._getRawValue(r)},this._primaryGroupByAttributeAlias=e}return e.prototype._getRawValue=function(e){if(this._primaryGroupByAttributeAlias in e.fields){var t=e.fields[this._primaryGroupByAttributeAlias],r=Object(p.e)(t);return parseInt(r,10)}return-1},e}()},KbPJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.entityreferencebyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Kdvm:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("9r0m"),a=function(){function e(){}return e.prototype.generate=function(e,t){return t&&t.getProcessId()?{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:n.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:n.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}:null},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},LAsh:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{paddingLeft:e.sizes.Measures.Measure100,paddingRight:e.sizes.Measures.Measure100}}r.d(t,"a",(function(){return n}))},LBS5:function(e,t,r){"use strict";r.d(t,"b",(function(){return k})),r.d(t,"a",(function(){return A})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return R})),r.d(t,"d",(function(){return L}));var n,a,i=r("TJkj"),o=r("UOiB"),s=r("kvLG"),c=r("mPpC"),l=r("Y+r4"),u=r("c/eZ"),p=r("ZOZo"),d=r("0hCf"),h=r("G9wF"),g=r("T4u8"),f=r("9r0m"),m=r("ixd0"),b=r("JX21"),v=r("1z64"),y=r("5KPK"),_=function(e){function t(t,r,a,i){var o=e.call(this,t,r,a,i)||this;return o._dashboardId=t,n=a,o._clientApiExecutor=new v.a(a,"ClientApi.XrmDashboardSelectorItem.",i),o}return Object(u.__extends)(t,e),t.prototype._getEventParams=function(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:f.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])},Object.defineProperty(t.prototype,"isBoundDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isBoundDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return!t||1032==+t.Type}),this._getEventParams())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isUserDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return Object(b.c)(t)}),this._getEventParams())},enumerable:!1,configurable:!0}),t.prototype.navigate=function(){var e=this;this._clientApiExecutor.executeAsync("navigate",(function(){return n.dispatch(Object(y.a)(null,e._dashboardId,null,null,null,null,e.getPageId()))}),this._getEventParams())},t}(m.a),S=function(e){function t(t,r,n,a,i){var o=g.c;if(a){var s=t.getState(),c=Object(g.g)(s,a);c&&c[n.guid]&&(o=g.g)}return e.call(this,t,r,n,a,i,o,_)||this}return Object(u.__extends)(t,e),t}(h.b),O=function(e){function t(t,r,n,a,i,o){return e.call(this,t,r,n,a,i,o,S)||this}return Object(u.__extends)(t,e),t}(d.a),C=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r&&r.etn,i,o,(function(){return O}),n)||this;return a=t,c._getCommands=s,c._apiExecutor=new v.a(t,"ClientApi.XrmDashboard.",o,i),c}return Object(u.__extends)(t,e),Object.defineProperty(t.prototype,"commands",{get:function(){var e=this;return this._apiExecutor.execute("commands_get",(function(){return e._commands||(e._commands=e._getCommands(a,e.contextToken,e.pageId))}))},enumerable:!1,configurable:!0}),t}(p.a),I=r("7bez"),j=r("Dlr/"),P=r("1PXy"),T=r("h82J"),x=r("HSdq"),E=r("IiPO"),F=r("ks02"),w=r("+Z9T"),N=r("W1TM");function A(e,t,r,n){return M((function(r,a){return new C(r,a,new c.b(r,t),e,t,n)}),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function k(e,t,r,n){return M((function(r,n){return new l.a(r,n,new c.b(r,t),e,t)}),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function M(e,t,r,n,a,o,c,l){return{type:t,sync:!0,execute:function(t,u){Object(w.g)(n,r,"contextToken"),Object(w.g)(a,r,"pageId"),c&&Object(w.g)(o,r,"entityTypeName");try{var p=t.dispatch(Object(T.b)(a,n));if(!p){(p=e(t,{etn:o,id:l})).applicationContext=u;var d=new F.a(t,a);if(p.context=d,!n.parentContextToken){var h=u.ClientApiManager.getClientApiEntry(a);Object(i.b)("form.initialization",(function(){h.xrmInstance.Page=p})),h.primaryContextToken=n}}return p}catch(e){var g=E.a.getInstance().getEventParameters(n);throw g.push({name:"entityTypeName",value:o}),s.a.getInstance().eventManager.ReportComponentFailure(r,e,null,g),e}}}}function D(e,t,r,n,a){var i="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute:function(c,l){Object(w.g)(e,i,"contextToken"),Object(w.g)(t,i,"pageId");try{var u=c.dispatch(Object(T.c)(t,e));if(!u){if(3===n){var p=Object(x.s)(c.getState(),{id:t,controlName:a},e.parentContextToken);if(p){var d=c.dispatch(Object(T.b)(t,e.parentContextToken));return new j.a(c,e.parentContextToken,t,a,r,d,p,l)}(h=E.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Control descriptor could not be found for subgrid control"),null,h)}if(u=new I.a(c,e,t,r,n,!1,l,a),!e.parentContextToken&&e.contextTokenType===o.a.MainGrid)l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}return u}catch(t){var h;throw(h=E.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,t,null,h),t}}}}function R(e,t,r,n){var a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute:function(i,o){Object(w.g)(e,a,"contextToken"),Object(w.g)(t,a,"pageId"),Object(w.g)(r,a,"controlName"),Object(w.g)(n,a,"controlId");try{var c=i.dispatch(Object(T.b)(t,e.parentContextToken)),l=null;switch(r){case"notescontrol":if(!(l=i.dispatch(Object(T.f)(t,e)))){var u=Object(x.s)(i.getState(),{id:t,controlName:r},e.parentContextToken);l=new P.a(i,e.parentContextToken,t,u,r,n,c,o)}break;default:(p=E.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,p)}return l}catch(t){var p;throw(p=E.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,t,null,p),t}}}}function L(e,t){var r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute:function(n,a){Object(w.g)(e,r,"contextToken"),Object(w.g)(t,r,"pageId");try{var i=n.dispatch(Object(T.g)(t,e));if(!i&&(i=new N.a(n,e,t),!e.parentContextToken)){var o=a.ClientApiManager.getClientApiEntry(t);o.xrmInstance.Page=i,o.primaryContextToken=e}return i}catch(t){var c=E.a.getInstance().getEventParameters(e);throw s.a.getInstance().eventManager.ReportComponentFailure(r,t,null,c),t}}}}},LFYt:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r("mVnn"),a="quickCreateForm.output";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){return{type:"quickCreateForm.output.async",execute:function(r){var i=r.dispatch,o=r.getState,s=Object(n.a)(o(),e)||[];return s.push(t),i(function(e,t){return{type:a,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},LdMy:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(){}return Object.defineProperty(e.prototype,"invocationSource",{get:function(){return this._invocationSource},set:function(e){this._invocationSource=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workflowStep",{get:function(){return this._workflowStep},set:function(e){this._workflowStep=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},set:function(e){this._businessProcessFlowVisitor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEntityName",{get:function(){return this._currentEntityName},set:function(e){this._currentEntityName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processManager",{get:function(){return this._processManager},set:function(e){this._processManager=e},enumerable:!1,configurable:!0}),e.prototype.getStageStep=function(e){if(Object(a.b)(e)||!this._businessProcessFlowVisitor)return null;var t=this._businessProcessFlowVisitor.get_stagesById()[Object(n.a)(e)];return t||null},e}(),o=r("c/eZ"),s=function(e){function t(t){return e.call(this,Object(n.a)(t))||this}return Object(o.__extends)(t,e),t}(function(){function e(e){this.value=e,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.getNext=function(){return this._next},e.prototype.setNext=function(e){this._next=e},e}()),c=function(){function e(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}return e.prototype.find=function(e,t){if(e=Object(n.a)(e),t){for(var r in this._rootNodesValue)if(e===this._rootNodesValue[r])return this._rootNodes[r];return null}for(var r in this._rootNodes){var a=this._rootNodes[r];if(a.value===e)return a;for(;null!=a.getNext();)if((a=a.getNext()).value===e)return a}return null},e.prototype.getNode=function(e){return this._rootNodes[e]},e.prototype.setNode=function(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value},e.prototype.getDefaultPath=function(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray},e.prototype.addAfter=function(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)},e.prototype.getDefaultPathHash=function(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash},e.prototype._ensureLatestDefaultPathIsCalculated=function(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())},e.prototype._recaculateDefaultPath=function(){this._defaultPathArray=[];for(var e=0;e<this._rootNodes.length;e++){var t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){var r=t.getNext();r.value&&(this._defaultPathArray[this._defaultPathArray.length]=r.value),t=r}}return this._defaultPathArray},e.prototype._addAfterInternal=function(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1},e.prototype._generateDefaultPathCalculatedTimeHash=function(){var e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e},e}(),l=function(){function e(){}return e.prototype.pathChanged=function(e){this._handler&&!Object(a.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)},e.prototype.getHandler=function(){return this._handler},e.prototype.setHandler=function(e){this._handler=e},e}(),u=function(){function e(e,t){this._nextStage=t,this._parentStage=e}return Object.defineProperty(e.prototype,"parentStage",{get:function(){return this._parentStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextStage",{get:function(){return this._nextStage},enumerable:!1,configurable:!0}),e}(),p=function(){function e(e,t,r){this._context=e,this._defaultPath=t,this._staticPath=r}return e.prototype.calculate=function(){for(var e=this._startingNodeInDefaultPath(),t=0;t<this._staticPath.length;t++){var r=this._staticPath[t];if(this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(r)){var n=this._defaultPath.find(r,!0);n?e=n:(this._defaultPath.addAfter(e,new s(r)),e=e.getNext())}}this._lastEvaluatedNode=e},e.prototype.getLastEvaluatedNodeInDefaultPath=function(){return this._lastEvaluatedNode},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._startingNodeInDefaultPath=function(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode},e}(),d=function(){function e(e,t){this._defaultPath=t,this._context=e}return e.prototype.calculate=function(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()},e.prototype.getLastDefaultNode=function(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_staticPathToDefaultPathCalculator",{get:function(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new p(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e,t){this._context=e,this._defaultPath=t}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getLastCalculatedDefaultNode=function(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraveresedStages=function(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_traversedDefaultPathCalculator",{get:function(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),g=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._stageStep},set:function(e){this._stageStep=e},enumerable:!1,configurable:!0}),e.prototype.tryExecute=function(){var e=Object(n.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)},t.prototype._sanitizeGuidForFunctionName=function(e){if(Object(a.b)(e))return e;for(e=Object(n.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e},t}(g),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e=Object(n.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(t){var r=t.findElseBranch(),a=null;if(r&&r.get_Steps().get_Count()>0)a=r.get_Steps().get_item(0).get_stageId();this._invokeReflowFunction(e,a)}},t.prototype._invokeReflowFunction=function(e,t){this.context.processManager.reflow(!1,e,t)},t}(g),b=function(){function e(){}return e.prototype.getStageCommand=function(e,t){var r=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(n.a)(t.get_stageId())];return e.currentEntityName!==r.get_EntityLogicalName()?new m(e):new f(e)},e}(),v=function(){function e(e,t,r){this._defaultPath=t,this._cascadeUpdate=r,this._context=e,this._businessRuleCommandFactory=new b}return e.prototype.handleChange=function(e,t){var r=this._defaultPath.find(e,!1);if(null!=r){var n=Object(a.b)(t)?null:t,i=new s(n);this._defaultPath.addAfter(r,i),n&&this.triggerSubsequentDefaultPathCalculation(i)}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(e){var t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){var r=this._context.getStageStep(t).get_nextStageId();if(!r)return;var n=this._defaultPath.find(r,!0);if(n)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(n));this._defaultPath.addAfter(e,new s(r)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}},e.prototype._tryExecuteConditionForStage=function(e){var t=this._context.invocationSource;try{this._context.invocationSource="internal";var r=this._context.getStageStep(e.value),n=this._businessRuleCommandFactory.getStageCommand(this._context,r);if(n.stage=r,!n.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1},e}(),y=function(){function e(e,t,r){this._context=e,this._listener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startNode},set:function(e){this._startNode=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!0)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t,r){this._context=e,this._listener=t,this._initialDefaultPath=r}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startingNodeInDefaultPath},set:function(e){this._startingNodeInDefaultPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraversedStages=function(){this._defaultPath=this._initialDefaultPath},e.prototype._calculateForNonTraversedStages=function(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_nonTraversedDefaultPathCalculator",{get:function(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r){this._context=e,this._changeListener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._changeListener.setHandler(e)},e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!1)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),O=r("9r0m"),C=function(){function e(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new l,this._initializeDefaultPathFromRootStages()}return e.prototype.initializeComplete=function(){var e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();var t=this._context.processManager.getSelectedStageId(),r=this._context.processManager.getActivePath(),n=!Object(a.a)(t)&&!Object(a.a)(r),i=n&&r.findIndex((function(e){return e.guid.toString()===t}))<0,o=n&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())},e.prototype.updateDefaultPath=function(e,t){if(e){var r=null;if("internal"!==this._context.invocationSource&&(r=this.defaultPathHash()),this._changeListener.pathChanged(new u(e,t)),"internal"!==this._context.invocationSource)if(r!==this.defaultPathHash()){var n=this.getDefaultPath();this._context.processManager.setActivePath(n)}}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(!!O.a.tryParseOrNull(e)&&!!this.getDefaultPath().find((function(t){return t.toLowerCase()===e.toLowerCase()}))){var t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource)if(t!==this.defaultPathHash()){var r=this.getDefaultPath();this._context.processManager.setActivePath(r)}}},e.prototype.getDefaultPath=function(){return this._defaultPath.getDefaultPath()},e.prototype.defaultPathHash=function(){return this._defaultPath.getDefaultPathHash()},e.prototype.getNextStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return-1!==r&&r<t.length-1?t[r+1]:null},e.prototype.getPreviousStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return r<=0?null:t[r-1]},e.prototype._initializeDefaultPathFromRootStages=function(){this._defaultPath=new c;var e=this._context.businessProcessFlowVisitor.get_firstLevelStages(),t=0;for(var r in e)this._defaultPath.setNode(t,new s(r)),t++},e.prototype._initializeTraversedPath=function(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()},e.prototype._initializeNonTraversedPath=function(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()},Object.defineProperty(e.prototype,"_loadTimeDefaultPathCalculator",{get:function(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_afterLoadPathCalculator",{get:function(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_runTimePathCalculator",{get:function(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new S(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator},enumerable:!1,configurable:!0}),e}(),I=r("HSdq"),j=function(){function e(){}return e.prototype.setPrimaryModel=function(e){this._primaryModelName=e},e.prototype.getDefaultPathManager=function(){return this._defaultPathManager},e.prototype.setObjectModel=function(e){var t=this,r=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach((function(e){if(t._isRelationshipStep(e)){var a=t._createRelationshipCollectionStep(r,e);a&&r.appendStep(a)}else{var i=t._createEntity(r,e);i&&(r.appendStep(i),n.hasOwnProperty(i.get_EntityLogicalName())||(n[i.get_EntityLogicalName()]=!0))}})),r.set_Name(e.businessProcessFlowName),r.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=r,this._initializeVisitor()},e.prototype.initializeDefaultPathManager=function(e,t){var r=new i;r.processManager=t,r.businessProcessFlowVisitor=this._businessProcessFlowVisitor,r.workflowStep=this._processObjectModel,r.currentEntityName=this._primaryModelName,this._defaultPathManager=new C(e,r),this._defaultPathManager.initializeComplete()},Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},enumerable:!1,configurable:!0}),e.prototype.getEntityStages=function(){if(!this._processObjectModel)return null;var e=this._processObjectModel.get_Steps(),t=[];if(e){for(var r=0;r<e.get_Count();r++){var n=e.get_item(r);n&&n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(r))}return t}return null},e.prototype.getRequiredFlowStepsForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);this._isFlowStep(c)&&c.get_isProcessRequired()&&a.push(c.get_Id())}return a},e.prototype.getRequiredAttributesForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);if(!this._isActionStep(c)&&!this._isFlowStep(c))if(c.get_isProcessRequired())a.push(c.get_Description());else{var l=this._getDataFieldNameFromStepStep(c);l&&this._isRequiredAttribute(l,t,r,n)&&a.push(c.get_Description())}}return a},e.prototype._getDataFieldNameFromStepStep=function(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){var t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null},e.prototype._isRequiredAttribute=function(e,t,r,n){return null!=e&&2===Object(I.pc)(n,t,r,e)},e.prototype._isFlowStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0;return!1},e.prototype._isActionStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0;return!1},e.prototype._isControlStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0;return!1},e.prototype._initializeVisitor=function(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)},e.prototype._isRelationshipStep=function(e){return!(!e||!e.hasOwnProperty("relationships"))},e.prototype._createEntity=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);r.set_Name(t.entityLogicalName),r.set_Description(t.entityDisplayName),r.set_relationshipName(t.relationshipName),r.set_attributeName(t.referencingAttributeName),r.set_parent(e);var n=this._createStage(e,t.stage);r&&n&&r.appendStep(n);for(var a=0;a<t.stage.steps.length;a++){var i=this._createStep(e,t.stage.steps[a]);i&&n.appendStep(i)}var o=this._createConditionStep(e,n,t.stage);return o&&n.appendStep(o),r},e.prototype._createRelationshipCollectionStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(r.set_workflow(e),t.relationships)for(var n=0;n<t.relationships.length;n++){var a=this._createRelationshipStep(e,t.relationships[n]);r.appendStep(a)}return r},e.prototype._createRelationshipStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return r.set_workflow(e),r.set_sourceStageId(t.sourceStageId.guid),r.set_targetStageId(t.targetStageId.guid),r.set_attributeName(t.attributeName),r.set_relationshipName(t.relationshipName),r},e.prototype._createStage=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return r.set_Id(t.stageId.guid),r.set_stageId(t.stageId.guid),r.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),r.set_stageCategory(t.stageCategory),r},e.prototype._createStep=function(e,t){var r="action"===t.stepType.toLowerCase()?t.label:t.name,n=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,r||"dummy");n.set_isProcessRequired(t.required),n.set_Name(t.label),n.set_Id(t.stepId?t.stepId.guid:""),n.set_workflow(e);var a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(a.set_dataFieldName(r),"action"===t.stepType.toLowerCase()){var i=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);i.set_Name(r),i.set_actionControl(a),n.appendStep(i)}else if("modernflow"===t.stepType.toLowerCase()){var o=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);o.set_Name(r),o.set_flowControl(a),n.appendStep(o)}else n.appendStep(a);return n},e.prototype._createConditionStep=function(e,t,r){if(!r.conditionJson)return null;var n=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return n.set_parent(t),n.initializeFromDynamic(JSON.parse(r.conditionJson)),n.fixLinks(),n},e.prototype.getProcessObjectModel=function(){return this._processObjectModel},e.prototype.getStage=function(e){return Object(a.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null},e.prototype.getPreviousStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e.prototype.getNextStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e}()},LhJP:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return a})),r.d(t,"o",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"j",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"k",(function(){return f})),r.d(t,"l",(function(){return m})),r.d(t,"e",(function(){return b})),r.d(t,"q",(function(){return v})),r.d(t,"p",(function(){return y})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",p="BusinessProcessFlow.SetActiveProcess",d="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",f="BusinessProcessFlow.RefreshFlowStep",m="BusinessProcessFlow.RenderProcessControl",b="BusinessProcessFlow.HideProcessControlForUciOffline",v="SaveFailureReason",y="faultedSnapshotId"},LiB6:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("c/eZ"),a=r("UlLp"),i=r("8VL5"),o={};function s(e,t){var r;return void 0===e&&(e=o),t.type===i.a?Object(n.__assign)(Object(n.__assign)({},e),((r={})[Object(a.a)(t.meta.customControlId,t.meta.dataSetParameterName)]=t.payload,r)):e}},NJzV:function(e,t,r){"use strict";r.d(t,"b",(function(){return ur})),r.d(t,"a",(function(){return pr})),r.d(t,"d",(function(){return hr})),r.d(t,"c",(function(){return lr}));var n=r("c/eZ"),a=r("4E+q"),i=r("kyRo"),o=r("nuS9"),s=r("93Ls"),c=r("kGA3"),l=r("VnpK"),u=r("S2mk"),p=r("DRVD"),d=r.n(p),h=r("CCTC"),g=r("9r0m"),f=r("WS0f"),m=r("sOTk"),b=r("Nw1z"),v=r("HSdq"),y=r("riBC"),_=r("2OIc"),S=r("T2Xs"),O=r("Sscr"),C=r("UOiB"),I=r("QAhb"),j=r("yHpA"),P=r("JX21"),T=r("T4u8"),x=r("cZkS"),E=r("qC0c"),F="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function w(){var e=null,t=null,r=null;return function(n,a){S.a.info(a.controlId+"."+F+": createGetContextTokenSelector started");var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r,n=t.parentContextToken,a=t.contextString,i=t.configuration,o=Object(_.e)(e,t.configuration.CustomControlId);if(Object(E.c)(e,x.J)&&Object(l.s)(o)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===C.a.UnboundForm&&r.formId)return!(!Object(P.a)(t,r.formId)&&!Object(T.a)(t,r.formId));return e(t,r.parentContextToken)}(e,n))return r=O.p(n.parentContextToken,t.controlId);if("default"===a&&Object(l.s)(o)&&!Object(l.r)(t.configuration.Parameters)||Object(l.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return r=O.e(n,t.controlId);if(!t.formInfo&&i&&i.Parameters&&i.Parameters.value&&"TimelineWall"===i.Parameters.value.Type)return r=O.p(n,t.controlId);if(!t.formInfo&&Object(l.t)(t.configuration)){var s=function(e,t){var r=Object(m.g)(e,t.id),n=new I.a(r.entityTypeName,r.id||g.a.EMPTY),a=Object(v.ac)(e,t.id,t.parentContextToken),i=Object(j.d)(e,a,n,t.descriptor.DataFieldName),o=i?i.reference:null;return o?o.etn:Object(l.m)(t.descriptor)}(e,t);return r=O.l(n,t.controlId,s)}r=n;var c=t.descriptor&&t.descriptor.Relationship;c&&(r=O.m(r,c));return r}(n,a);return(r!==o||N(e,s)||N(t,i))&&(e=s,t=i,r=o),S.a.info(a.controlId+"."+F+": createGetContextTokenSelector finished"),e}}function N(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var A=r("ZEX9"),k=r("Gemh"),M=r("OTOS"),D=r("WH9N"),R=r("L8Ie"),L=r("0hZT");function B(){var e={},t=!1;return function(r,n,a,i,o,s){S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");var c=Object(m.a)(r,n),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){var p=Object(M.b)(r,n.id),d=g.a.equals(g.a.tryParse(a.UniqueId),g.a.EMPTY)?n.controlId:a.UniqueId;e=p&&s===D.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,p,d):p&&s===R.a?function(e,t,r,n){var a=Object(m.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"dialog",entityTypeName:i,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,p,d):p?function(e,t,r,n){var a=Object(m.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"form",entityTypeName:i,recordGuid:a.id,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,p,d):s===L.a?function(e,t,r,n){var a=Object(k.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:a?a.split(",")[1]:void 0}}(r,n,i.entityTypeName,o):{areaType:null,entityTypeName:null,controlUniqueId:d,viewId:void 0},t=!0}return S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var V=r("pmTS"),G=r("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function z(e,t,r,n,a){var i=Object(G.a)(e,t),o=a?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",s=Object(O.v)(n);return i&&i[o]&&i[o][s]&&i[o][s][r]?i[o][s][r]:null}var W=r("pdGj"),q=r("vO+w"),U=r("xc1f"),X=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",h.c),H=r("CSbt"),K=r("hXUt"),Q=r("5Fed"),Y=r("PQ2H"),J=r("Oqm9"),Z=r("lMVv"),$=r("Eoze"),ee=r("vYfn"),te=r("i8/j"),re=r("9KTg");function ne(e,t){return{type:re.a,payload:e,meta:{pageId:t}}}function ae(e){return{type:"execute.cleanreferencepanelstate.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e){return{type:re.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve()}}}function ie(e){return{type:"execute.closeallsessiontabs.async",execute:function(t,r){var n=t.dispatch,a=(0,t.getState)();return n(function(e,t){return{type:re.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(J.b)(a,e)},e)),Promise.resolve()}}}function oe(e,t){return{type:"execute.closesessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=Object(J.a)(i,e,t);return o.splice(e,1),a(function(e,t){return{type:re.d,payload:e,meta:{pageId:t}}}({sessionTabs:o,activeTabId:s},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e,t){return{type:re.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve()}}}function ce(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute:function(r,n){var a=r.dispatch,i=r.getState,o=Object(J.c)(i(),t);if(e&&!(o.activeTabId&&o.controlNames.length>0))return a(function(e,t){return{type:re.f,payload:e,meta:{pageId:t}}}({controlNames:e.map((function(e){return e.Name})),activeTabId:e[0].Id},t)),Promise.resolve()}}}var le=r("sm1J");function ue(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){for(var a=r.dispatch,i=r.getState,o=Object(J.d)(i(),t),s=[],c=0;c<o.length;c++)o[c].id===e.id?s.push(e):s.push(o[c]);return a(function(e,t){return{type:re.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var pe=r("kvLG"),de=r("w/nD");var he=r("oj0s"),ge=r("qIF7"),fe=r("I6xF"),me=r("ObKm"),be=r("g9bv"),ve=r("jJRu"),ye=r("GHPx"),_e=r("cAHA");var Se=r("h82J"),Oe=r("pdOk"),Ce=r("RXRQ"),Ie=r("gBKR"),je=r("EcZf"),Pe=r("bCrZ"),Te=r("olrR"),xe=r("OROb"),Ee=r("HEkv"),Fe=r("HfRC"),we=r("evh6"),Ne=r("ya7l"),Ae=r("12n8"),ke=r("4fxQ"),Me=r("wYyS");var De=r("otMa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Re=function(){function e(e,t){this.Target=e,this.FieldName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Le=r("qYad"),Be=r("UR8A"),Ve=r("j6Db");var Ge=r("EGsq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ze=r("969l"),We=r("mGpW"),qe=r("Ww2r");var Ue=r("XjtF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Xe(e,t){return{type:"customcontrol.loadresources.async",execute:function(r,n){r.dispatch;var a=r.getState;return function(e,t,r,n){var a=Object(Ge.t)(t);return r.initializeContainerForClientApi(n).then((function(t){return t.loadWebResources([Object(Ge.a)(a,e)]).then((function(){return{container:t,webResourcePath:a}}))}))}(e,a(),n.ScriptManager,t)}}}var He=r("EwXg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ke=r("n1Ju"),Qe=r("zsi3"),Ye=r("c7nC"),Je=r("F2uj");var Ze=r("8Fmj"),$e=r("w82B"),et=r("y5DA"),tt=r("RwQN"),rt=r("T0dC"),nt=r("/SAa"),at=r("o5EQ"),it=r("8VL5"),ot=r("cqI9"),st=r("Zdrd"),ct=r("Yc9S"),lt=r("0rak"),ut=r("G7N+"),pt=r("/j9Z"),dt=r("sgPk"),ht=r("TCcM"),gt=function(){function e(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}},e}(),ft=r("Ia1G"),mt=r("CO6B"),bt=r("2IT6"),vt=r("ak18");function yt(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.rollup.async",execute:function(n,a){var i=n.dispatch,o=n.getState,s=o(),c=e.key,l=dt.a.fromState(e,o),u=Object(ht.u)(s,c,l.pageNumber-1);return u&&(l.pagingCookie=u),r.push({name:vt.a,value:Object(vt.e)(e)}),r.push({name:"isRefresh",value:t}),i(function(e,t,r){var n;void 0===r&&(r=!1);var a={lists:(n={},n[e]={initialized:r?ut.a.Refreshing:ut.a.Initializing,pageSize:t},n)};return{type:"gridData.retrieve.rollup",payload:a}}(c,l.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then((function(n){return t(Object(ft.b)(new gt(I.a.toExternalEntityReference(r.target),n,r.rollupType))).then((function(n){return Object(bt.g)(n).then((function(n){return function(e,t,r,n){var a=r.getKeyQuery(),i=Object(mt.e)(a),o=Object(Ie.e)(i.entity2AttributesMap);return t(o).then((function(){var t=e();return Object(mt.a)(t,a,i,n)}))}(e,t,r,n)}))}))}))}(o,i,l).then((function(e){s=o(),i(Object(je.e)(s,i,c,l,e))})).catch((function(e){Object(pt.b)(e)}))},getFailureParameters:function(e,t){return r},getSuccessParameters:function(e,t,n){return r}}}var _t=r("AVer"),St=r("Z46F"),Ot=r("slAZ");function Ct(e,t,r,n,a){var i="",o="";if(n&&n.message&&(i=n.message),n&&n.errorCode){var s=a||Ve.a,c=function(e){return r.EventManager.ReportComponentFailure(s,e,null,[{name:"hexErrorCode",value:o},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:a},{name:"APIName",value:Ve.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(o+" "+i)};try{var l="Error_Title_"+(o="0x"+St.a.getHexErrorCodeFromInt(n.errorCode)),u="Error_Message_"+o,p="Localized resource strings not found for neither "+l+" nor "+u+".  Please add error resources for error code "+o,d=e(Object(We.e)([l])).catch((function(){})),h=e(Object(We.e)([u])).catch((function(){}));return Promise.all([d,h]).then((function(){var e=Object(qe.e)(t(),[l,u]),r=Object(qe.c)(e,l),n=Object(qe.c)(e,u),a="";return(a=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(o)?r+(r&&n?": ":"")+n:r||n)?Promise.resolve(o+" "+a):c(p)}))}catch(e){return c(e)}}return Promise.resolve(o+" "+i)}function It(e,t){if(e instanceof nt.a)(r=e.getLatestData()).loading=!0,e.setRefreshingStart();else if(e instanceof at.a||e instanceof rt.a){var r;(r=e.getLatestData())&&(r.working=!0,at.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute:function(r,n){var a=r.dispatch,i=r.getState;if(e instanceof tt.a){var o={retrieveGridDataAction:function(e){return a(Object(je.d)(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(de.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(de.X)(t,e,r,n))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},retreiveChartAction:function(e,t,r){return a(Object(Ze.a)(e,t,r))},retreiveChartDataAction:function(e,t,r,n){return void 0===n&&(n=!0),a(Object($e.a)(e,t,r,n))},updateDataSetChartVisualizationId:function(e,t,r){return a(Object(ot.b)(e,t,r))},updateDataSetChartVisualizationType:function(e,t,r){return a(Object(st.b)(e,t,r))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e,t){return Ct(a,i,n,e,t)},updateChartFilterExpression:function(e,t,r){return a(Object(ct.c)(e,t,r))},updateChartDrillDownParameters:function(e,t,r){return a(Object(lt.c)(e,t,r))},updateChartErrorInformation:function(e,t,r,n){Object(et.a)(e,a,t,r,n)}};return e.refreshDataSet(i,o,n)}var s={retrieveGridDataAction:function(e){return Object(f.a)(e.rollupType)?a(Object(je.d)(e)):a(yt(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(de.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(de.X)(t,e,r,n))},startCustomFilter:function(e,t,r){return a(Object(Ot.f)(e,t,r))},endCustomFilter:function(e,t,r){return a(Object(Ot.e)(e,t,r))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e){return Ct(a,i,n,e)},getAdditionalResourceStrings:function(e){return a(Object(We.e)(e))},addCustomViewAction:function(e,t,r,n,i,o,s,c){return a(Object(_t.a)(e,t,r,n,i,o,s,c))},setOfflineQueryAction:function(e){return a(Object(_t.b)(e))}};return e.refreshDataSet(i,s,n)}}}var jt=r("IQF2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Pt=r("bH46"),Tt=r("VZmd");var xt=r("yrP7"),Et=r("vqdi"),Ft=r("LBS5"),wt=r("XJ3n");var Nt=r("zvr0"),At=r("nIt0"),kt=r("455M");var Mt=r("uO/V"),Dt=r("oY7N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e,t,r){if(r.dataSetUIOptions){var n=e+t.id,a=t.contextString;switch(t.contextString){case Mt.h.ASSOCIATEDGRID:case Mt.h.SUBGRID:case Mt.h.GRID:break;case Mt.h.CUSTOM:default:a=Mt.h.CUSTOM}return o.createElement(Dt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:a,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return o.createElement(lr,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Lt=r("RB3d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bt(e){if(e){if(e instanceof I.a)return e;var t,r=e.entityName||e.LogicalName;return t=g.a.fromLegacyGuid(e.Id),g.a.isNullOrEmpty(t)&&(t=new g.a(e.id||e.Id)),new I.a(r,t,Object(f.a)(e.name)?e.Name:e.name)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(Pt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var Gt=r("q6M9"),zt=r("IUjT"),Wt=r("eYbs"),qt=r("RlP9"),Ut=function(){function e(){}return e.prototype.convert=function(e,t,r){var n=(new DOMParser).parseFromString(e,"text/xml"),a=this._firstElementChild(n),i=this._childElements(a);if(!i)return null;for(var o=[],s=0,c=i;s<c.length;s++){for(var l=c[s],u=[],p=0,d=this._childElements(l);p<d.length;p++){var h=d[p];u.push(this._getGridCellDescriptor(h))}o.push(this._getGridRowDescriptor(l,u))}var g=this._getGridDescriptor(a,o,r);return this._populateRelationshipInformation(g,t),g},e.prototype._attributeValueBoolean=function(e,t){return"1"===this._attributeValueString(e,t,"")},e.prototype._attributeValueString=function(e,t,r){var n=e.attributes.getNamedItem(t);return n&&n.value||r},e.prototype._attributeValueInt=function(e,t,r){var n=this._attributeValueString(e,t,r+"");return parseInt(n,10)},e.prototype._childElements=function(e){return e?e.children?Array.from(e.children):e.childNodes?Array.from(e.childNodes).filter((function(e){return e.nodeType===Node.ELEMENT_NODE})).map((function(e){return e})):null:null},e.prototype._getGridCellDescriptor=function(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}},e.prototype._getGridRowDescriptor=function(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}},e.prototype._getGridDescriptor=function(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}},e.prototype._firstElementChild=function(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;var t=this._childElements(e);return t&&t[0]},e.prototype._populateRelationshipInformation=function(e,t){var r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),a=this._firstElementChild(n),i=this._childElements(a);if(i)for(var o=0,s=i;o<s.length;o++){var c=s[o];"link-entity"===c.nodeName&&this._attributeValueString(c,"alias","")&&this._attributeValueString(c,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(c,"alias",""),this._attributeValueString(c,"name",""))}},e.prototype._setRelatedEntityName=function(e,t,r){for(var n=0;n<e.rows.length;n++)for(var a=0;a<e.rows[n].cells.length;a++){var i=e.rows[n].cells[a].name;(i?i.substring(0,i.indexOf(".")):void 0)===t&&(e.rows[n].cells[a].relatedEntityName=r)}},e}(),Xt=r("bIXa"),Ht=r("r0s4");function Kt(e,t,r,n,a,i,o,s){return void 0===t&&(t=!1),{type:"populateAndSend.LookupData.Action",sync:!0,execute:function(c,l){var u=c.dispatch,p=(0,c.getState)(),d=a||e.LookupEntityByName[0].EntityLogicalName,h=Object(zt.f)(p,d,o,n),f=[];if(s){var b=s.split("."),y=Object(m.g)(p,n),_=void 0,S=Object(v.ac)(p,n,r),O=Object(j.b)(p,S);_=O&&O.activeChanges&&O.activeChanges[b[1]]?O.activeChanges[b[1]]:Object(ht.j)(p,new I.a(b[0],y.id),b[1]),e.RelatedRecordId=_&&_.reference&&_.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length)for(var C=Object(v.eb)(p,n,r),P=C&&C[i],T=0,x=e.LookupEntityByName;T<x.length;T++){var E=x[T],F=Object(Xt.b)(p,n,r,i,E.EntityLogicalName);if(F&&(E.CustomFilter=Object(Ht.CrmHtmlDecode)(F).replace(/"/g,"'")),h){var w=Object(Wt.a)(p,h,E.EntityLogicalName);w&&w.view&&(g.a.equals(w.view.viewId,E.ViewId)||Object(qt.c)(p,E.ViewId))||f.push(u(Object(Te.a)(E.EntityLogicalName,null,null,E.ViewId)))}var N=P&&P.parameters&&P.parameters.defaultviewid;if(P&&P.views&&P.views[N]&&P.views[N].entityLogicalName===E.EntityLogicalName){E.ViewId=null,E.FetchXml=P.views[N].fetchXML.replace(/"/g,"'");var A=Object(Z.h)(p,E.EntityLogicalName),k=new Ut;E.LayoutJson=JSON.stringify(k.convert(P.views[N].layoutXML,P.views[N].fetchXML,A.ObjectTypeCode)).replace(/"/g,"'")}}var M=Object(Gt.b)(p,d,e),D=Object(ht.o)(p,M);t=t||D===ut.a.Initialized,f.push(u(Object(Gt.d)(e,t)));var R=function(e,t,r,n,a){var i,o,s={},c=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName,l=a||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!c&&!l)return null;c||(c="placeholderEtn");if(r.LookupEntityByName)for(var u=0,p=r.LookupEntityByName;u<p.length;u++){var d=p[u];s[d.EntityLogicalName]=Object(Gt.b)(e,d.EntityLogicalName,r)}var h=Object(Gt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:(i={},i[c]=(o={},o[l]={metadataKey:h,dataKeys:s},o),i),meta:{pageId:t}}}(p,n,e,a,o);return R&&u(R),Promise.all(f)}}}var Qt=r("kRDR"),Yt=r("CcDq");var Jt,Zt,$t,er,tr=r("feNe"),rr=r("aBa1");function nr(e,t){return{openEditForm:function(r,n,a,i,o){var s=Bt(r);e(n?Object(Fe.a)(s,t.id,void 0,void 0,n,a,i,o):Object(Fe.a)(s,t.id))},openGridPage:function(r,n,a,i,o,s,c,l){e(Object(we.a)(r,t.id,g.a.tryParseOrNull(n),a,i,g.a.tryParseOrNull(o),s,null,l,c))},openCreateForm:function(r,n,a){e(Object(ee.b)(new I.a(r),null,"QuickCreate")).then((function(i){e(Object(ge.b)(r,t.id,null,n,Bt(a)))})).catch((function(a){e(Object(Fe.a)(new I.a(r),t.id,void 0,n))}))},openSearch:function(r){e(Object(Ae.a)(r,null,t.id))},openPowerBIFullScreenPage:function(r,n,a,i,o,s,c){e(Object(Ne.a)(t.id,r,n,a,i,o,s,c))},openDashboard:function(e){},openUrl:function(e,t){},openUrlWithProtocol:function(e,t){},openPhoneNumber:function(r,n,a,i,o,s,c,l,u,p,d){return void 0===p&&(p=!1),void 0===d&&(d=!0),e(function(e,t,r,n,a,i,o,s,c,l,u,p){return void 0===u&&(u=!1),void 0===p&&(p=!0),{type:"customcontrol.openphonecall",execute:function(d,h){var f=e.trim(),m=Object(Ge.x)(d.getState()).defaultCountryCode;0!==f.indexOf("tel:")?(m&&(f=m+f),f="tel:"+f):m&&(f=f.slice(0,4)+m+f.slice(4));var b,v=new Yt.a(h,d);h.ScriptManager.containerExists(Qt.d)&&(b=h.GlobalCustomEventManager);var y=function(){if(u){var c=null,l={};if(t){c=new I.a(r,new g.a(t));var p={id:t,entityType:r,name:n},h=p;i&&(h={id:i,entityType:o,name:s}),l.contactinfo=e,l.to=[p],l.regardingobjectid=h}return d.dispatch(Object(ge.b)("phonecall",a,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return v.canOpenUri(f).then((function(e){if(p&&b&&d.dispatch(b.runOnOpenUrl(a,f,l,c)))return null;var t=Object(E.c)(d.getState(),x.C);e?(v.openUri(f),t&&y()):u&&t&&y()}),(function(){return null}))},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,a,n,i,t.id,s,o,c,l,u,p,d))},openMaps:function(e){},openMap:function(e){}}}var ar=r("6Tlt"),ir=r("lU69"),or=r("Wg6j"),sr=r("uGUB"),cr=Object(a.a)((function(){var e,t={},r=null,a={},i={},o={},s=!1,c="",p=null,d={},h=!1,O="",C=!1,I={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},j=-1,P=-1,T=Object(A.a)(),x=Object(V.a)(),E=B(),F=w();return function(w,N){S.a.info(N.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");var A,k,M,D,R,L=X.startStopwatch({controlId:N.controlId,parentId:Object(l.p)(N),level:(0).toString()}),B=[],V=!1,G=null,H=null,K=null,Q=null,Y=null,J=null,Z=null,$=null,ee=null,te=null,re=!1,ne=null,ae=null,ie=null,oe=!1;try{var se=null;N.formInfo?(p&&d.EntityName===N.formInfo.EntityName&&d.RecordId===N.formInfo.RecordId&&d.FormId===N.formInfo.FormId||(p={id:N.formInfo.RecordId?new g.a(N.formInfo.RecordId):null,formId:N.formInfo.FormId?new g.a(N.formInfo.FormId):null,entityTypeName:N.formInfo.EntityName},d=N.formInfo),se=p):se=Object(m.g)(w,N.id),H=N.descriptor,K=N.configuration,M=Object(b.b)(w),A=Object(m.l)(w,N.id),Object(m.f)(w,N.id)&&(R="DialogContainer__"+N.id),!R&&N.parentDefinedControlProps&&N.parentDefinedControlProps.parentFlyoutId&&(R=N.parentDefinedControlProps.parentFlyoutId),A&&(k=F(w,N));var ce=Object(v.kb)(w,N,k),le=K;if(null!==N.systemDefinedProperties){var ue=Object(n.__assign)(Object(n.__assign)({},K.Parameters),N.systemDefinedProperties);le=Object(n.__assign)(Object(n.__assign)({},K),{Parameters:ue})}if(!(Q=Object(_.e)(w,K.CustomControlId)||Object(_.e)(w,K.Name))||!Q.ConstructorName){Q=null;var pe=Object(u.h)(K.CustomControlId);pe!==K.CustomControlId&&(Q=Object(_.e)(w,pe))}Q&&(Z=($=x(w,Q,se,ce,N.contextHelper)).response,te=(Y=(J=T(le,H,N,w,se,k)).response)&&Y.dataReady?E(w,N,H,se,k,A):null,ee=Object(y.a)(w,te,Q.CustomControlId,N.id));var de=z(w,N.id,N.controlId,k);de&&(re=de.every((function(e){return Object(W.b)(w,e)}))),D=z(w,N.id,N.controlId,k,!0),ae=N.parentDefinedControlProps&&!Object(f.a)(N.parentDefinedControlProps.height)?N.parentDefinedControlProps.height:-1,ne=N.parentDefinedControlProps&&!Object(f.a)(N.parentDefinedControlProps.width)?N.parentDefinedControlProps.width:-1,ie=Object(q.b)(w)?Object(q.a)(w):null,oe=function(e,t,r,n){return Object(m.l)(e,t)===U.a&&!Object(v.Fb)(e,t,r,n)}(w,N.id,k,N.descriptor.Name)}catch(e){var he=Q.ConstructorName;S.a.error(he+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:N.controlId},{name:"customControlId",value:Q.CustomControlId},{name:"manifest",value:JSON.stringify(Q)},{name:"descriptor",value:JSON.stringify(H)},{name:"configuration",value:JSON.stringify(K)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),V=!0,G=e.toString()+". Stack: "+e.Stack}return r&&(B=B.concat(function(e,t){var r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r}(H,r))),r=N.descriptor,Y!==a||Q!==t||Z!==i||te!==o||V!==s||A!==c||re!==h||D!==e||ae!==P||ne!==j||R!==O||ie!==I.designLanguage||oe!==C?(ae===P&&ne===j||B.push("layout"),J&&(B=B.concat(J.updatedProperties)),$&&(B=B.concat($.updatedProperties)),ie!==I.designLanguage&&B.push("design"),I={stateToPropsMappingError:V,stateToPropsMappingErrorMessage:G,dynamicData:Y,manifest:Q,personalizationState:ee,propBagData:Z,children:K&&K.Children,personalizationConfiguration:te,pageType:A,popupStack:M,contextToken:k,updatedProperties:B,globalCommandManagerInitialized:re,internalCommandManagerIds:D,portalFlyoutToDialogId:R,designLanguage:ie,inactive:oe},h=re,e=D,O=R,s=V,i=Z,t=Q,a=Y,o=te,c=A,P=ae,j=ne,C=oe):I.updatedProperties=B,L({updatedProperties:JSON.stringify(B)}),S.a.info(N.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),I}}),(function(){var e;return function(t,r){if(e)return e;var n=nr(t,r);return Jt={setNotification:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"customcontrol.propertybag.mode.setnotification",execute:function(s,c){var l=s.dispatch,u=s.getState,p={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Qe.a.error,actions:[{actions:[function(){}],message:""}]};l(Object(Ke.b)(r,n,p,a));var d=u(),h=new I.a(i,g.a.fromExternalGuid(o)),f=Object(Je.a)(d,h.etn,n);return h&&f&&(2===f.RequiredLevel||1===f.RequiredLevel)&&l(Object(Ye.b)(r,n,!1,a)),!0},sync:!0}}(e,r,n,a,i,o,s))},clearNotification:function(e,r,n,a,i,o){return t(function(e,t,r,n,a,i){return{type:"customcontrol.propertybag.mode.clearnotification",execute:function(n,a){var o=n.dispatch,s=n.getState,c=Object(v.A)(s(),{controlName:t,id:e},r);if(c){i=i||"";for(var l=Object.keys(c),u=null,p=l.length-1;p>-1;--p)l[p]===i&&((u=c[l[p]]).actions=null,u.messages=null,u.notificationLevel=null,o(Object(Ke.b)(e,t,u,r)))}return!0},sync:!0}}(e,r,n,0,0,o))}},$t={setState:function(e){return!0},logMessage:function(e,r,n){t(function(e,t,r){return{type:"customcontrol.log",execute:function(n,a){n.dispatch,n.getState;var i=a.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(r){case He.a.Error:i.error(o);break;case He.a.Info:i.info(o);break;case He.a.Warning:i.warn(o);break;case He.a.Verbose:i.debug(o)}},sync:!0}}(e,r,n))}},Zt={isGetBarcodeValueOperationAvailable:function(){return t(Object(De.c)())},isTakePictureOperationAvailable:function(){return t(Object(De.e)())},isCaptureVideoOperationAvailable:function(){return t(Object(De.b)())},isCaptureAudioOperationAvailable:function(){return t(Object(De.a)())},isOpenARViewerAvailable:function(){return t(Object(De.d)())}},er={clearNestedChild:function(e){return!0},createAccessibilityComponent:Lt.a,createCommandManagerUXComponent:function(){var e=null;return function(t){var r=pr(t);return hr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,ur(r)}},createKeyboardShortcut:Lt.b,createXrmForm:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(Ft.b)(t,r,n,new g.a(a)))}(t,e,r,n,a)},createXrmGrid:function(e,r,n,a){var i=[C.a.AssociatedGrid,C.a.CustomGrid,C.a.SubGrid,C.a.MainGrid];if(e&&-1===i.indexOf(e.contextTokenType))for(var o in n)if("Grid"===n[o].Type){var s=n[o];t(Object(Pe.c)(s.TargetEntityType||s.EntityName,s.ViewId,r,e));break}return function(e,t,r,n,a){var i=Object(k.vb)(n);if(t){var o=void 0;switch(t.contextTokenType){case C.a.SubGrid:o=3;break;case C.a.AssociatedGrid:o=2;break;case C.a.MainGrid:case C.a.CustomGrid:o=1;break;default:var s=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:a},{name:"isEditableGrid",value:i}];pe.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,s),o=1}return!!e(Object(Ft.c)(t,r,i,o,a))}return!0}(t,e,r,n,a)},registerNewControl:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(Ft.e)(t,r,n,a))}(t,e,r,n,a)},executeAddOnLoad:function(e,r){t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute:function(r,n){var a=r.dispatch;r.getState,e.gridRunOnLoad((function(e,r,i){if(n.ScriptManager.containerExists(e)){var o=n.ScriptManager.getContainer(e).getEventManager();a(o.runOnGridDataLoad(t,1,i,r))}}))}}}(e,r))},addSessionTab:function(e,r){return t(function(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=!0;if(e){if(o.forEach((function(t){e.id===t.id&&(s=!1)})),s){if("quickViewFormTab"===e.type){var c=!1,l=e,u=Object(Y.a)(6),p=Object(Z.E)(i,l.entityFormOptions.entityName),d=void 0;d=i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?Object(v.ec)(i,"activitypointer",new g.a(l.entityFormOptions.entityId)):Object(v.ec)(i,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId));var h=new I.a(l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),f=[];if(!d){var m=a(Object($.d)(h,[p]));f.push(m)}var b=Object(te.h)(i,l.entityFormOptions.entityName,u);if(g.a.isNullOrEmpty(b)){var y=a(Object(ee.b)(h,null,u)).then((function(e){b=e,g.a.isNullOrEmpty(b)||b===ee.a||(c=!0)}));f.push(y)}else c=!0,l.entityFormOptions.formId=b.guid;Promise.all(f).then((function(){l.entityFormOptions.formId=c?b.guid:"",l.entityMetadata={DisplayName:i.metadata.entities[l.entityFormOptions.entityName].DisplayName},i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?l.title=Object(v.ec)(i,"activitypointer",new g.a(l.entityFormOptions.entityId)):l.title=Object(v.ec)(i,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),o.unshift(l),a(ne({sessionTabs:o,activeTabId:l.id,messageId:c?"":"quick_view_form_not_exist_message"},t))}))}else o.unshift(e),a(ne({sessionTabs:o,activeTabId:e.id},t));return Promise.resolve()}a(ne({sessionTabs:o,activeTabId:e.id},t))}}}}(e,r))},closeSessionTab:function(e,r){return t(oe(e,r))},updateSessionTab:function(e,r){return t(ue(e,r))},closeAllSessionTabs:function(e){return t(ie(e))},dismissMessage:function(e){return t(se(e))},markActiveTab:function(e,r,n){return t(Object(le.b)(e,r,n))},initializeReferencePanelControl:function(e,r){return t(ce(e,r))},cleanReferencePanelState:function(e){return t(ae(e))},executeNotifyHandlersThatEventOccurred:function(e){return t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute:function(t,r){var n=t.dispatch,a=t.getState,i=null;try{switch(e.eventName){case"onresultopened":n(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":n(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":n(Object(de.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":var o=e.contextToken,s=e.fieldName,c=e.record,l=!1,u=Object(de.u)("ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",a(),r,e.pageId,c);u&&(l=n(u.runOnLookupTagClick(o,s,null,c,a()))),i=l}return Promise.resolve(i)}catch(e){throw pe.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e))},getConnectorsApi:function(e){return null},executeRollupRequest:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute:function(n,a){var i=n.dispatch;if(n.getState,e&&t){var o=new Re(e,t),s=Be.a.execute(o).then((function(e){return e.json()})).then((function(n){if(n){var o=[];for(var s in n)-1!==s.indexOf("@")||s.startsWith("_")||o.push(s);var c=new I.a(e.entityType,g.a.fromExternalGuid(e.id));return i(Object(Le.a)(r,c,o)).then((function(){a.EventManager.ReportComponentSuccess(Ve.a+".Action",[{name:"APIName",value:Ve.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])}),(function(r){a.EventManager.ReportComponentFailure(Ve.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Ve.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:n}])}))}}));return Be.a.Diagnostics.traceInfo(Ve.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,r,n))},getResource:function(e){return t(function(e){return{type:"customcontrol.getresources.async",execute:function(t,r){t.dispatch;var n=t.getState,a=r.AssetLoader,i=n(),o=Object(Ge.t)(i);if(3===e.Type||2===e.Type)return a.loadRawData(o+e.Name)}}}(e))},getRecordSetQueryKey:function(e){return e?e.getPreviousQueryKey():null},loadResources:function(e){return t(Object(Ue.a)(e))},triggerOfflineMetadataSync:function(){return t(Object(Oe.h)())},retrieveFormWithAttributes:function(e,r,n){return t(Object(Pt.c)(new I.a(e),g.a.tryParse(r),n))},loadManifest:function(e,r){return t(Object(Ce.c)(e,r))},updateOutputs:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"outputs.update",execute:function(s,c){var l=s.dispatch,u=s.getState;try{var p={},d={};if(i)for(var h=0,g=Object.keys(i);h<g.length;h++){var f=g[h],m=i[f],b=f;switch(m.fieldName&&(b=m.fieldName),(m.paramType===kt.a.LookupSimple||m.paramType===kt.a.LookupCustomer||m.paramType===kt.a.LookupOwner||m.paramType===kt.a.LookupRegarding||m.paramType===kt.a.LookupMultiEntity)&&m.value&&m.value instanceof Array&&(m.value.length>0?m.value=m.value[0]:m.value=null),m.type){case 0:p[b]=i[f];break;case 2:d[b]=i[f]}}var v=new Array,y=l(Object(me.a)(e,p,!1,!1,t,r,a,o));if(v.push(y),Object(G.a)(u(),e).forms){var _=l(Object(Nt.b)(e,n,o,d));v.push(_)}else{var O=l(Object(At.b)(e,n,d));v.push(O)}return Promise.all(v)}catch(a){var C=n+" failed at updating its outputs",I=Object(S.b)(u(),n);return c.EventManager.ReportComponentFailure(I+".CustomControl.updateOutputs",a,C,[{name:"APIName",value:Ve.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(i)}]),c.TraceManager.getTracer("customcontrol").warn(I+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a,i,o,s))},updateFieldValue:function(e,r,n,a,i,o,s){return t(Object(me.a)(e,r,!1,n,a,i,o,s))},runCustomOpenRecord:function(e,r,n,a){return t(function(e,t,r,n){return{type:"record.open",execute:function(a,i){var o=i.ScriptManager.getContainer(e).getEventManager(),s=new g.a(r),c=Object(O.f)(n,s,t),l=a.dispatch(Object(Ft.b)(c,e,t,s));return l=new wt.a(a,i,c,e,t,s),a.dispatch(o.runOnRecordOpen(n,r,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},getBoundFileObject:function(e,r,n,a){if(null==e||null==r||null==r.id||null==n)return null;var i={id:new g.a(r.id),etn:r.entityType};return t(Object(tr.c)(e,i,n,a,"full"))},saveEmbeddedEntity:function(e,r,n,a,i,o,s,c){return void 0===s&&(s=!1),t(Object(Et.a)(e,r,n,a,i,o,s,c))},renderNestedCustomControl:Rt,renderReactSubtree:ke.createPortal,retrieveView:function(e,r,n,a){return t(Object(Te.a)(e,r,n,a))},retrieveViewSelector:function(e,r){return t(Object(Te.b)(e,r))},retrieveGridData:function(e){return t(Object(je.d)(e))},retrieveRecordDataForForm:function(e,r,n,a,i){return t(Object($.e)(Bt(e),g.a.tryParse(r),n,a,i))},retrieveForm:function(e,r,n){var a=g.a.tryParse(r),i=Bt(e);return t(Object(ee.b)(i,a,n)).then((function(e){return t(Object(he.c)(a,i.etn)).then((function(){return e}))}))},retrieveEntityData:function(e){return t(Object(Ie.f)(e,!1,[]))},retrieveChartDrilldownAttributes:function(e){return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:function(e,t){var n=e.dispatch,a=e.getState;return n(Object(Ie.f)(r,!0,[])).then((function(){var e=a(),t=Object(Je.d)(e,r);if(t&&Object.keys(t).length>0){var n={};for(var i in t){var o=t[i];Vt(e,r,i,o)&&(n[i]=o)}return n}return null}),(function(e){var n=e.get_message();return t.EventManager.ReportComponentFailure(Ve.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(n),n,[{name:"APIName",value:Ve.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null}))}}));var r},refreshDataSetParameter:function(e,r){return t(It(e,r))},retrieveLookupMetadataAction:function(e){return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute:function(e,t){var n=e.dispatch,a=e.getState;if(r instanceof Tt.a){var i={retrieveGridDataAction:function(e){return n(Object(je.d)(e))},retrieveViewAction:function(e,t,r,a){return n(Object(Te.a)(e,t,r,a))},retrieveViewSelectorAction:function(e,t){return n(Object(Te.b)(e,t))},runPreSearch:function(e,t,r){return n(Object(de.W)(Object(O.j)(a(),e),e,t,r))},runSetAdditionalParams:function(e,t,r){return n(Object(de.X)(Object(O.j)(a(),e),e,t,r))},refreshCustomDataProviderAction:function(e,t,r,a){return n(Object(it.b)(e,t,r,a))},getEntityMetadataAction:function(e,t){return n(Object(Ie.f)(e,!1,t))}};return r.retrieveLookupMetadata(a,i)}}}));var r},retrieveDataSetLookupCellParameter:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:function(n,a){var i=n.dispatch,o=n.getState;return i(It(t,r)).then((function(){var r=t.retrieveDataSetObject(o(),e,a);return Promise.resolve(r)})).catch((function(e){a.EventManager.ReportComponentFailure(Ve.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Ve.a+".Actions.RetrieveDataSetLookupCellParameter"}])}))}}}(e,r,n))},updateControlMemoizedDataSet:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute:function(n,a){n.dispatch;var i=(0,n.getState)(),o=e.retrieveDataSetObject(i,null,null,null,a);e.linkToParameter(o,t),e.updateControlMemoizedParameter(i,o,!0,r)}}}(e,r,n))},loadResourceStrings:function(e){return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute:function(e,t){var n=e.dispatch,a=e.getState,i=r.CustomControlId;if(!i)return Promise.resolve();var o=a(),s=ze.a.getControlsResourceKeyList(i);if(!s)return Promise.resolve();var c=Object(qe.d)(o);if(!c)return n(Object(We.e)(s));for(var l=[],u=0,p=s;u<p.length;u++){var d=p[u];c.hasOwnProperty(d)||l.push(d)}return 0===l.length?Promise.resolve():n(Object(We.e)(l))}}));var r},retrieveLookupData:function(e){return t(Object(je.d)(e))},setFieldControlPersonalization:function(e,r,n){return t(Object(Ee.j)(e,r,n))},setGridControlPersonalization:function(e,r,n){return t(Object(Ee.m)(e,r,n))},setDashboardControlPersonalization:function(e,r,n){return t(Object(Ee.i)(e,r,n))},setGenericControlPersonalization:function(e,r,n){return t(Object(Ee.k)(e,r,n))},setGlobalControlPersonalization:function(e,r){return t(Object(Ee.l)(e,r))},setPowerBISignedInState:function(e,r){return t(Object(fe.b)(e,r))},beginSecureSessionForResource:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute:function(a,i){var o=new Me.a(i,a);return n?o.beginSecureSessionForResource(e,t,r):o.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,a))},setXrmObject:function(e){},addPendingCommandManagerId:function(e,r,n,a){var i;return t(Object(xt.a)(e,r,n,a)),{promise:new Promise((function(e){i=e})),resolve:i}},initializeCommandManager:function(e,r,n,a,i){var o;return t(Object(xt.b)(e,r,n,a,i)),{promise:new Promise((function(e){o=e})),resolve:o}},retrieveRecordCommand:function(e,r,n,a,i,o,s,c,l,u){return t(Object(xt.c)(u,e,r,n,a,i,o,s,c,l))},setValue:function(e,r,n,a){return e&&r?t(function(e,t,r,n){var a=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute:function(i,o,s){var c=i.dispatch,l=(0,i.getState)(),u=Object(O.j)(l,e),p=Object(O.x)(u),d=Object(ye.a)(l,n,t,r,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),h=g.a.isNullOrEmpty(t.id)?_e.a.Create:_e.a.Update;if(a.push({name:"CorrelationId",value:s.correlationId},{name:"ContextId",value:s.contextId},{name:"ActionStack",value:s.stack},{name:"mode",value:h}),n)return c(Object(be.b)(l,n,d)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",a),Promise.resolve();var f=Object(ve.b)(l,t,d,p,h),m=f.payload.snapshotId;return c(f),a.push({name:"newSnapshotId",value:m}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",a),Promise.resolve(m)},getFailureParameters:function(e,t){return a}}}(a,e,r,n)).then((function(e){return Promise.resolve(e||n)})):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required")},save:function(e,r){return void 0===r&&(r=[]),t(Object(xe.c)(e,!1,r))},openPopup:function(e){return t(Object(Q.a)(e))},closePopup:function(e){return t(Object(K.a)(e))},loadWebResource:function(e,r){return t(Xe(e,r))},registerOngoingWork:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:function(a,i){return a.dispatch,a.getState,jt.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},isPresenceEnabledEntity:function(e){return Object(H.b)(e)},getPresenceMappedField:function(e){return Object(H.a)(e)},fireXrmEvent:function(e,r,n,a,i){var o=t(Object(Se.b)(r,n)),s=null;if(o&&o.ui&&o.ui.controls&&(s=o.ui.controls.get(e)),s)switch(a){case 0:s.fireOnKeyPress&&s.fireOnKeyPress()}},sendLookupRequest:function(e,r,n,a,i,o,s){return t(Kt(e,!0,r,n,a,i,o,s))},runPreSearch:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunPreSearch",execute:function(n){var a=n.dispatch;n.getState,a(Object(Ot.f)(r,t,e)),a(Object(de.W)(e,r,t)),a(Object(de.X)(e,r,t)),a(Object(Ot.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute:function(n,a){var i=n.dispatch;n.getState,a.ScriptManager.containerExists(t)&&i(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:function(e,r,n){return t(Object(rr.a)(e,r,n))},retrieveLookupRecordsByIds:function(e,r,n){return t(Object(rr.b)(e,r,n))}},e={actions:er,propBagMethods:{utils:$t,navigation:n,device:Zt,mode:Jt}}}}))(s.a),lr=function(e){function t(t,r){var n=e.call(this,t)||this;return n._updateCounter=0,n._isUpdateScheduled=!1,n._reRunMapStateToProps=function(){n._isUpdateScheduled||(n._isUpdateScheduled=!0,Object(sr.c)((function(){n._isUpdateScheduled=!1,n._updateCounter++,n.forceUpdate()})))},n._reRunMapStateToProps=n._reRunMapStateToProps.bind(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),o.createElement(c.a.Provider,{value:this.context},o.createElement(cr,Object(n.__assign)({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))},t}(o.Component);function ur(e){var t="cm"+Object(ir.a)();return o.createElement(ar.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function pr(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:or.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:dr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function dr(e){var t=[];if(e)for(var r=0,n=e;r<n.length;r++){var a=n[r];t.push(Bt(a))}return t}function hr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){for(var r=e.length,n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}lr.contextType=i.a},NfcN:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.referenceinformationbyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Nhrb:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("Sscr"),a=r("uO/V"),i="control.update.parameter";function o(e,t,r,o,s){return{type:"control.update.parameter.async",execute:function(c,l){var u=c.dispatch,p=(c.getState,a.x+".updateControlParameterAction");u(function(e,t,r,o,s){var c=Object(n.v)(s);return{type:i,payload:{name:r,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:a.o}}}(e,0,r,o,s));var d=[];return d.push({name:"controlName",value:t}),d.push({name:"paramName",value:""+r}),l.EventManager.ReportComponentSuccess(p,d),Promise.resolve()}}}},Oiu5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r("Gemh");function a(e){var t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,a=[];return r?(t.forEach((function(e){if(4200!==r[e].ObjectTypeCode){var t=function(e){var t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);a.push(t)}})),a.sort(i)):a}function i(e,t){var r=e.entityDisplayName,n=t.entityDisplayName,a=0;return r>n?a=1:r<n&&(a=-1),a}function o(e){for(var t=[],r=0;r<e.length;r++){var n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map((function(e){return{key:e.value,text:e.text}})):[]}},OmYs:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="section.label";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,sectionName:r}}}},PLtI:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.setlabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,tabId:r}}}},PZxu:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,a=r("Gemh"),i=r("Zy0S"),o=r("XJ3n"),s=r("+Z9T"),c=r("Sscr"),l=r("9r0m"),u=r("TCcM"),p=r("QAhb"),d=r("9rlF"),h=r("IiPO"),g=r("w/nD"),f=r("ezfI"),m=r("/j9Z"),b=r("kvLG"),v=function(){function e(e,t,r,a,i,o,c){var l="ClientApi.XrmControlGrid.constructor";if(a||Object(s.j)(l,"pageId"),r||Object(s.j)(l,"contextToken"),e||Object(s.j)(l,"store"),i||Object(s.j)(l,"gridEntity"),Object(s.a)(o)&&Object(s.j)(l,"isEditable"),n=e,this._applicationContext=t,this._contextToken=r,this._pageId=a,this._gridEntityName=i,this.controlName=c,this._isEditable=o,!this._contextToken.contextTokenType){var u=h.a.getInstance().getEventParameters(this._contextToken);u.push({name:"controlName",value:this.controlName}),u.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(l,new m.a("context token passed to grids with empty context token type"),null,u)}}return Object.defineProperty(e.prototype,"_isEditable",{get:function(){var e=Object(a.V)(n.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){var t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmControlGrid._isEditable_get",new m.a("control configuration parameters not found"),null,t),this._isGridEditable}return e},set:function(e){this._isGridEditable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationContext",{get:function(){return f.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext},set:function(e){f.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")},enumerable:!1,configurable:!0}),e.prototype.getTotalRecordCount=function(){var e="ClientApi.XrmControlGrid.getTotalRecordCount";try{f.a.instance.reportCall(e);var t=Object(a.Y)(n.getState(),this._pageId,this._contextToken);if(t){var r=JSON.parse(t),i=r&&r.totalResultCount?r.totalResultCount:0;return f.a.instance.reportSuccess(e),i}return f.a.instance.reportSuccess(e),0}catch(t){var o=h.a.getInstance().getEventParameters(this.contextToken);throw o.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.getRows=function(){var e="ClientApi.XrmControlGrid.getRows";try{f.a.instance.reportCall(e);var t=new i.a(e),r=n.getState(),s=Object(a.H)(r,this.contextToken,{id:this.pageId});if(s)for(var l=0;l<s.length;l++){var u=s[l].identifier.id,p=this._getRowEntityName(s[l],u),d=new o.a(n,this._applicationContext,Object(c.f)(this.contextToken,u,p),this.pageId,p,u),g=s[l].identifier.id.guid;t.add(g,d)}return f.a.instance.reportSuccess(e),t}catch(t){var m=h.a.getInstance().getEventParameters(this.contextToken);throw m.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,m),t}},e.prototype.getSelectedRows=function(){var e="ClientApi.XrmControlGrid.getSelectedRows";try{f.a.instance.reportCall(e);var t=new i.a(e),r=Object(a.fb)(n.getState(),this.pageId,this.contextToken);if(r)for(var s=Object(a.Q)(n.getState(),this.pageId,this.contextToken),p=function(e){var i=void 0;if(s)i=s;else{var p=n.getState(),h=Object(a.v)(p,d.pageId,d.contextToken),g=(h&&h.queryKey&&Object(u.q)(p,h.queryKey,null,null,!0)||[]).find((function(t){return t.identifier&&l.a.equals(t.identifier.id,r[e])}));i=d._getRowEntityName(g,r[e])}var f=new o.a(n,d._applicationContext,Object(c.f)(d.contextToken,r[e],i),d.pageId,i,r[e]),m=r[e].guid;t.add(m,f)},d=this,g=0;g<r.length;g++)p(g);return f.a.instance.reportSuccess(e),t}catch(t){var m=h.a.getInstance().getEventParameters(this.contextToken);throw m.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,m),t}},e.prototype.addOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(g.m)(this.contextToken,this.pageId,e,this.controlName)),f.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.removeOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(g.H)(this.contextToken,this.pageId,e,this.controlName)),f.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.runOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.runOnRecordSelect";try{f.a.instance.reportCall(t),this._isEditable&&n.dispatch(Object(g.T)(this.contextToken,this.pageId,e,this.controlName)),f.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getRowEntityName=function(e,t){var r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){var a=Object(u.j)(n.getState(),new p.a(this._gridEntityName,t),"activitytypecode");if(Object(d.j)(a))return a.value}return r},Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}()},PhZR:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.label";function a(e,t,r,a){return{type:n,payload:{label:r,currentLanguageId:a},meta:{pageId:e,navigationItemId:t}}}},"Pm+b":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("7z0H"),a=r("bCrZ"),i=r("Sscr");function o(e,t,r){var a=Object(i.v)(r),o={xrmReady:e};return{type:n.b,payload:o,meta:{pageId:t,contextKey:a}}}function s(e,t,r){var n=Object(i.u)(r),o={xrmReady:e};return{type:a.b,payload:o,meta:{pageId:t,contextKey:n}}}},Q60c:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="controls.DefaultView";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},QItn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.mrudisabled";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:o,meta:{pageId:t,controlName:r,contextKey:s}}}},Qeyq:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(){return{tabId:"",navigationStack:[]}}r.d(t,"a",(function(){return n}))},QqTr:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r("7pqb"),a=r("zmaG"),i=r.n(a),o=r("NUwQ"),s=r("IQF2");function c(e,t,r,a){return{type:"onClick.BusinessLogicAction.sync",sync:!0,execute:function(c,l,u){var p=c.dispatch,d=c.getState,h=a?Object(o.c)(a):{};h[n.b.DialogButtonClickParameters.ControlId]=r,i.a.addKeyPerformanceIndicatorOnIdle("MDD.Performance.DialogButtonClick",h),s.a.getInstance().checkForOutstandingWork(d()).then((function(){var n=l.ScriptManager.getContainer(t).getEventManager();if(n){var a=n.runOnClick(e,r);p(a)}}))},getFailureParameters:function(e,t){var i=[{name:n.b.DialogButtonClickParameters.ControlId,value:r}];return a&&i.push.apply(i,a),i}}}},RB3d:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("nuS9"),a=r("B73A"),i=r("akzq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n,i,o){return new a.a(e,(function(e){t(e.EVENT)}),r,n,i,o)}function s(e){return n.createElement(i.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},SdPQ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.bodyvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},TCDU:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("1Tfq"),a=r("aGOT"),i=r("HSdq"),o=r("kk/C"),s=r("OTOS"),c=r("Sscr"),l=r("yHpA"),u=r("2p2B"),p=r("Srej");function d(e){return{type:"handle.unsaved.changes.async",execute:function(t,r,d){var h=t.dispatch,g=t.getState;return h(Object(n.a)(e)).then((function(t){if(t){for(var r=Object(s.a)(g(),e),n=r.map((function(e){return Object(c.j)(g(),e)})),d=0;d<r.length;d++){for(var f=r[d],m=n[d],b=Object(i.ac)(g(),f,m),v=Object(l.b)(g(),b),y=0,_=(null==v?void 0:v.activeChanges)?Object.keys(v.activeChanges):[];y<_.length;y++){var S=_[y];h(Object(u.b)(m,f,Object(p.d)(f,S)))}h(Object(a.c)(f,b,m)),h(Object(o.d)(f,m))}return!0}return!1}))}}}},Tr6b:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return M})),r.d(t,"b",(function(){return D}));var n=r("c/eZ"),a=r("ASFs"),i=r("VcAV"),o=r("i8/j"),s=r("HSdq"),c=r("2OIc"),l=r("sOTk"),u=r("hadW"),p=r("455M"),d=r("wV3W"),h=r("5olG"),g=r("LAsh");var f,m=r("UOiB"),b=r("Sscr"),v=r("lMVv"),y=r("JlqV"),_=r("uO/V"),S=r("Gemh"),O=r("aPRd"),C=r("DgF7"),I=r("9r0m"),j=r("Ev4I"),P=r("F2uj"),T=r("cZkS"),x=r("qC0c"),E=r("wQXd"),F=r("OTOS"),w=r("Ww2r"),N=r("CUpQ"),A=[p.a.LookupSimple,p.a.LookupPartyList,p.a.LookupRegarding,p.a.LookupOwner,p.a.LookupCustomer,p.a.LookupMultiEntity],k=[u.c,u.i,u.h];function M(){var e,t,r=null,f=null,O=null,M=null,R=null,L=null,B=null,V=null,G=null,z=null,W=null,q=null,U=!1,X=0,H=null,K={descriptor:null,configuration:null,configurations:null,contextKey:null,defaultCellStyle:null,spacerCellStyle:null,extraSidePaddingStyle:null,parentContextToken:null,formInfo:null,clientHost:null,clientHostSubtype:null,isRemoteAvailable:!1,isEntityEnabledForOffline:!1,informationAvailableToRender:!1,cellControlMode:0,isCreateForm:!1,isRelatedDataSetControl:!1,isPreviewMode:!1},Q=Object(s.h)(),Y=function(){var e=null,t=null,r=null,a=null;return function(c,u){if(!u.controlName)return t;null===a&&(a=Object(x.c)(c,T.bd));var p=Object(F.b)(c,u.id);if(p){var d=Object(b.j)(c,u.id),h=Object(o.b)(c,u.id,p,u.controlName);if(h){var g=h.Visible,f=h.Label,m=h.Disabled,v=h.Parameters&&h.Parameters.DisableMru,O=h.Url,C=Object(s.w)(c,u,d);i.c(C)||(f=C);var j=Object(s.G)(c,u,d);i.c(j)||(g=j);var P=Object(s.t)(c,u,d);i.c(P)||(m=P);var E=Object(s.D)(c,u,d);i.c(E)||(O=E);var w=Object(s.x)(c,u,d);i.c(w)||(v=w);var N=I.a.tryParseOrNull(Object(s.K)(c,u.id,u.controlName,d));if(N&&I.a.equals(N,r)){var A=Object(b.p)(d,u.controlName),k=Object(b.v)(A),M=Object(b.h)(k);N=Object(S.T)(c,u.id,M,u.controlName)||N}if(!I.a.equals(N,r)){for(var D in r=N,h.Parameters)if(h.Parameters[D].Name===_.C){h=Object(n.__assign)({},h),a&&(h.Parameters=Object(n.__assign)({},h.Parameters),h.Parameters[D]=Object(n.__assign)({},h.Parameters[D])),h.Parameters[D].Value=I.a.toString(N);break}h.Parameters[_.C]=I.a.toString(N)}if("TaskBasedFlow"!==Object(l.l)(c,u.id)||Object(y.b)(c)||(m=!0),h!==e||g!==t.Visible||f!==t.Label||m!==t.Disabled||O!==t.Url||v!==t.Parameters.DisableMru){e=h;var R=O?Object(n.__assign)(Object(n.__assign)({},e.Parameters),{Url:O,isCustomSrc:Object(s.E)(c,u,d),length:e.Parameters.length}):e.Parameters;(t=Object(n.__assign)(Object(n.__assign)({},h),{Visible:g,Label:f,Disabled:m,Url:O,Parameters:R})).Parameters.DisableMru=v}}else e=null,t=null}return t}}(),J=function(){var e=null;return function(t,r,n){var a=n;if(a&&a.Relationship){var o=Object(s.U)(t,r,a.Relationship);if(o)e&&e.EntityName===o.etn&&e.RecordId===o.id.guid||(e={EntityName:o.etn,RecordId:o.id.guid});else{var c=Object(l.g)(t,r.id);if(c){var u=Object(v.x)(t,c.entityTypeName,a.Relationship);u&&u.ReferencedEntity&&(e&&e.EntityName===u.ReferencedEntity&&i.c(e.RecordId)||(e={EntityName:u.ReferencedEntity}))}}}return e}}(),Z=D(),$=(e=null,t=null,function(r,n){var a=Object(d.a)(r),i=Object(h.a)(a.sizes.Section.cellHeightInRem);if(t!==a){t=a;var o=Object(g.a)(a);e={defaultCellStyle:{flex:"1 1 auto",width:"100%",whiteSpace:"nowrap",overflowX:"hidden",overflowY:"hidden",minHeight:i+"px"},spacerCellStyle:{height:a.sizes.Measures.Measure350},extraSidePaddingStyle:{paddingLeft:o.paddingLeft,paddingRight:o.paddingRight,width:"auto"}}}return e});return function(e,t){var n=Y(e,t),o=f,h=M,g=R,v=L,S=J(e,t,n),D=Object(C.a)(e),ee=Object(C.e)(e),te=!0;n&&n.Relationship&&S&&i.c(S.RecordId)&&(n.Disabled=!0);var re=Object(F.b)(e,t.id),ne=n?Object(c.b)(e,n.UniqueId,re):null;if((n&&(n!==r||n.Parameters.hasOwnProperty(s.d))||0!==X)&&(o=Q(e,n,t.id,re,S&&S.EntityName,!1,g)),0===X&&o&&n&&n.Parameters&&Object(x.c)(e,T.y)){var ae=n.Parameters,ie=I.a.tryParse(ae.VisualizationId);I.a.isNullOrEmpty(ie)||"Chart"!==ae.ChartGridMode||(X=2)}!h&&o&&(v=Object(b.j)(e,t.id),g=Object(b.p)(v,t.controlName),h=Object(b.v)(g));var oe=Object(s.u)(e,{id:t.id,controlName:t.controlName},v)?Object(w.b)(e,N.d)||"The control has been disabled with a URL parameter":null;if(0===X&&o){var se=n&&n.ClassId&&n.ClassId.guid?n.ClassId.guid:null;se&&p.a.ClassIdControlMap[se.toLowerCase()]===_.t&&(X=1),0===X&&o&&o.Parameters&&Object.keys(o.Parameters).map((function(e){return o.Parameters[e]})).filter((function(e){return e.Type===p.a.Grid})).length>0&&(X=1)}if(1===X)g=Object(b.p)(v,n.Name),h=Object(b.v)(g);else if(o&&o.Parameters&&o.Parameters.value){var ce=o.Parameters.value;if(A.indexOf(ce.Type)>-1){var le=ce;if(le){var ue=Object(s.C)(e,t.id,o.Name,Object(b.j)(e,t.id)),pe=ue&&ue.parameters&&ue.parameters.DefaultViewId,de=ue&&ue.parameters&&ue.parameters.defaultviewid;de?le.ViewId=de:pe&&(le.ViewId=pe)}}}V=Z(t,e,g);var he=Object(a.e)(L,v),ge=Object(a.e)(R,g),fe=Object(y.b)(e),me=!(!S||!S.EntityName)&&Object(j.l)(e,S.EntityName);if(g&&g.parentContextToken&&g.parentContextToken.contextTokenType===m.a.MainForm&&Object(s.Rc)(e,t.id,n)){var be=g.parentContextToken.entityTypeName;if(S&&S.EntityName)be=S.EntityName;else{var ve=Object(l.g)(e,t.id);ve&&ve.entityTypeName&&(be=ve.entityTypeName)}Object(P.a)(e,be,n.DataFieldName)||(te=!1)}var ye=Object(l.m)(e,t.id),_e=!1;if(1!==X&&2!==X||(_e=!!(n&&n.Parameters&&n.Parameters.RelationshipName)),n!==r||o!==f||S!==B||O!==ne||!he||!ge||G!==D||z!==ee||W!==fe||q!==me||U!==te||X!==K.cellControlMode||ye!==K.isCreateForm||_e!==K.isRelatedDataSetControl||H!==oe){var Se=$(e,t);if(n&&n.ClassId&&(I.a.equals(n.ClassId,u.e)&&(Se.defaultCellStyle.overflowX="visible",Se.defaultCellStyle.overflowY="visible"),function(e){return k.filter((function(t){return I.a.equals(e,t)})).length>0}(n.ClassId))){var Oe=Object(d.a)(e);Se.defaultCellStyle.minHeight=(t.rowSpan?t.rowSpan:1)*Oe.sizes.Section.cellHeightInRem+"rem"}K={descriptor:n,configuration:o,configurations:ne,contextKey:h,contextToken:g,defaultCellStyle:Se.defaultCellStyle,spacerCellStyle:Se.spacerCellStyle,extraSidePaddingStyle:Se.extraSidePaddingStyle,parentContextToken:v,customControlPropertyBag:V,formInfo:S,clientHost:D,clientHostSubtype:ee,isRemoteAvailable:fe,isEntityEnabledForOffline:me,informationAvailableToRender:te,cellControlMode:X,isCreateForm:ye,isRelatedDataSetControl:_e,isPreviewMode:Object(E.d)(e),disableWebResourceControlsMessage:oe},r=n,f=o,M=h,R=g,L=v,B=S,O=ne,G=D,z=ee,W=fe,q=me,U=te,H=oe}return K}}function D(){var e={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},t={Usage:1,Static:!0,Type:"WholeNumber.None",Value:0,Primary:!1},r={Usage:1,Static:!0,Type:"WholeNumber.None",Value:f.EditForm,Primary:!1},n={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},a={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},i={Usage:1,Static:!0,Type:"TwoOptions",Value:!0,Primary:!1},o={Usage:1,Static:!0,Type:"TwoOptions",Value:!1,Primary:!1},c={deviceSizeMode:e,viewportSizeMode:t,syncError:n,isEmpty:i,scope:r,forceColumnLayout:a,autoExpand:o};return function(l,u,p){var h=Object(s.Cc)(u,l,p),g=function(e){var t=Object(d.a)(e),r=t.sizes.Breakpoints.DimensionM,n=t.sizes.Breakpoints.DimensionS,a=Object(O.c)(e);return a<n?2:a<r?1:0}(u),f=1===l.cellLabelPosition;return l.cellSizeMode===e.Value&&h===n.Value&&l.scope===r.Value&&g===t.Value&&f===a.Value&&l.autoExpand===o.Value||(e.Value=l.cellSizeMode,t.Value=g,r.Value=l.scope,n.Value=h,a.Value=f,o.Value=l.autoExpand,c={deviceSizeMode:e,viewportSizeMode:t,scope:r,isEmpty:i,syncError:n,forceColumnLayout:a,autoExpand:o}),c}}!function(e){e[e.Header=0]="Header",e[e.EditForm=1]="EditForm",e[e.Footer=2]="Footer"}(f||(f={}))},"U/bH":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return p}));var n=r("Sscr"),a=r("uO/V"),i=r("Gemh"),o=r("VWqI"),s=r("EwXg"),c=r("BFwB"),l=r("+Xnp"),u="dataset.dependentoptionset.column.status";function p(e,t){var r=[];return{type:"dependentoptionset.column.status",sync:!0,execute:function(o,l,p){var f=o.dispatch,m=o.getState,b=l.TraceManager.getTracer(a.z),v=a.x+".SetDependentOptionSetColumnStatusAction";l.TraceManager.setLogLevel(s.a.Info,v);try{var y=Object(n.v)(t),_=m(),S=null,O=Object(i.Q)(m(),e,t),C={};if(O)S=O;else{var I=Object(i.S)(m(),{id:e},t);I&&I.entityLogicalName&&(S=I.entityLogicalName)}if(S){r.push({name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:S}),b.info("Executing initialize dependent option set column status action in grid.",r);var j={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},P=[],T=0,x=Object(i.z)(_,t,S,e);for(var E in x){var F=x[E];if(null===F.ParentPicklistLogicalName){var w={name:E,value:0};d(_,t,e,S,x,E,w)?h(x,E,C,j):(g(x,E,C),T++,P.push(w))}else void 0===x[F.ParentPicklistLogicalName]&&h(x,E,C,j)}var N={name:"NumCompleteDependentOptionSetChainsInGrid",value:T},A={name:"CompleteChainsMaxDepthInGrid",value:P};r.push(N,j,A);var k=new c.a(v);k.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",T),k.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",j.value),k.addEventParameter("CompleteChainsMaxDepthInGrid",P),l.EventManager.ReportEvent(k),l.EventManager.ReportComponentSuccess(v),b.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(C).length>0&&f(function(e,t,r){return{type:u,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,y,C))}catch(e){l.EventManager.ReportComponentFailure(v,Error("creating dependent option set column status node in state tree failed."))}}}}function d(e,t,r,n,a,i,s){if(void 0===a[i])return!0;if(function(e,t,r,n,a){if(!Object(o.f)(e,a,n,l.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,a,i,n))return!0;var c=a[i].ChildPicklistLogicalNames;if(null!==c)for(var u=0;u<c.length;u++){var p={name:i,value:0};if(d(e,t,r,n,a,c[u],p))return!0;s.value=Math.max(s.value,p.value)}return s.value=s.value+1,!1}function h(e,t,r,n){if(void 0!==e[t]){r[t]=0,n.value=n.value+1;var a=e[t].ChildPicklistLogicalNames;if(a)for(var i=0;i<a.length;i++)h(e,a[i],r,n)}}function g(e,t,r){r[t]=1;var n=e[t].ChildPicklistLogicalNames;if(n)for(var a=0;a<n.length;a++)g(e,n[a],r)}},UVKb:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,a=r("qC0c"),i=r("lFQy"),o=r("t8f4"),s=r("Y70o"),c=r("WS0f"),l="ProcessControl_ActionExecuter_ExecutionTimeTooltip",u="ProcessControl_ActionExecuter_ErrorMessageTooltip",p="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";function d(e){switch(e){case n.InProgress:case n.Waiting:return 1;case n.Succeeded:return 2;case n.Failed:case n.Canceled:return 3;default:return 0}}function h(e,t,r,a){var i="";if(Object(c.b)(e)||(i=String.format(a[l],new Date(e).toLocaleString())),r===n.Failed){var o=Object(c.b)(t)?a.Crm_GenericErrorMessage:t;i+="\n"+String.format(a[u],o)}return""===i?t:i}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute:function(r,n){var c=r.dispatch,g=r.getState,f=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),m=g();if(function(e){return Object(a.b)(e,"BpfActionSupportActionQuerying")}(m))return c(Object(o.e)("workflowlog",f)).then((function(e){if(e.value&&e.value.length){var r={};r[l]=Object(s.a)(m,p,l),r[u]=Object(s.a)(m,p,u),r.Crm_GenericErrorMessage=Object(s.a)(m,p,"Crm_GenericErrorMessage");var n={};e.value.forEach((function(e){if(e.stepname&&-1===Object.keys(n).indexOf(e.stepname)){var t={actionLogId:e.workflowlogid,status:d(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:h(e.modifiedon,e.message,e.status,r)};n[e.stepname]=t}}));var a={actionLogCollection:n};return c(Object(i.a)(a,t))}}))}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(n||(n={}))},VHYb:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ie}));var n,a,i,o,s,c,l,u,p,d=r("c/eZ"),h=r("ASFs"),g=r("nn4v"),f=r("3IUl"),m=[],b=Object(h.d)(((n={})[f.a]=function(e,t){return void 0===e&&(e=m),t.payload?t.payload:e},n),m),v=r("bc+P"),y=Object(h.d)(((a={})[v.a]=function(e,t){return void 0===e&&(e=null),t?t.payload:e},a),null),_=r("Ds7n"),S=r("krRo"),O=r("9r0m"),C=Object(h.d)(((i={})[_.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},i[S.b]=function(e,t){if(void 0===e&&(e=null),e&&e.records){var r=e.records.filter((function(e){return Object.keys(e)[0]===O.a.toString(t.payload.recordId)}));if(r&&r.length){var n=r[0];n&&n[O.a.toString(t.payload.recordId)]&&n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))&&(void 0!==t.payload.requiredLevel&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].requiredLevel=t.payload.requiredLevel),void 0!==t.payload.isDisabled&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].isDisabled=t.payload.isDisabled),void 0!==t.payload.notifications&&(n[O.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].notifications=t.payload.notifications))}}return e},i[S.a]=function(e,t){return void 0===e&&(e=null),e},i),null),I=r("19Zc"),j={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},P=function(e,t){switch(void 0===e&&(e=j),t.type){case I.e:return Object(d.__assign)(Object(d.__assign)({},e),{activityOrQueue:t.payload});case I.b:return Object(d.__assign)(Object(d.__assign)({},e),{activityTypeFilter:t.payload});case I.f:return Object(d.__assign)(Object(d.__assign)({},e),{jumpBar:t.payload});case I.g:return Object(d.__assign)(Object(d.__assign)({},e),{quickFind:t.payload});case I.d:return Object(d.__assign)(Object(d.__assign)({},e),{activityOrQueueFilterValue:t.payload});case I.c:return Object(d.__assign)(Object(d.__assign)({},e),{advancedFindFilter:t.payload});case I.a:return Object(d.__assign)(Object(d.__assign)({},e),{activityTypeSelectedValues:t.payload});default:return e}},T=Object(h.d)(((o={})[I.e]=P,o[I.f]=P,o[I.g]=P,o[I.d]=P,o[I.c]=P,o[I.b]=P,o[I.a]=P,o),j),x=r("7oc5"),E=Object(h.d)(((s={})[x.a]=function(e,t){return void 0===e&&(e=false),e!==t.payload?t.payload:e},s),false),F=r("d26+"),w=Object(h.d)(((c={})[F.a]=function(e,t){return void 0===e&&(e=""),t.payload?t.payload:e},c),""),N=r("whwt"),A=Object(h.d)(((l={})[N.a]=function(e,t){return void 0===e&&(e=false),t.payload&&"showChart"===t.payload.name?t.payload.value:e},l),false),k=r("Cgjg"),M={customFilterXml:null,source:null,timeStamp:null},D=Object(h.d)(((u={})[k.a]=function(e,t){return void 0===e&&(e=M),null!=t.payload?t.payload:e},u),M),R=r("zETL"),L=Object(h.d)(((p={})[R.a]=function(e,t){if(t.payload)return t.payload;return e},p),0);var B,V=r("JVfT"),G=Object(h.d)(((B={})[V.a]=function(e,t){if(t.payload)return t.payload;return e},B),0);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var z,W=r("0bF2"),q=Object(h.d)(((z={})[W.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},z),null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function U(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function X(e,t){return void 0===e&&(e=!1),e!==t.payload?t.payload:e}var H,K,Q,Y,J=r("Nhrb"),Z=Object(h.d)(((H={})[J.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"ViewId"===t.payload.name?O.a.tryParseOrNull(t.payload.value):e},H),null),$=r("cqI9"),ee=Object(h.d)(((K={})[$.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"VisualizationId"===t.payload.name?O.a.tryParseOrNull(t.payload.value):e},K),null),te=r("Zdrd"),re=r("z9yS").a.savedvisualization,ne=Object(h.d)(((Q={})[te.a]=function(e,t){return void 0===e&&(e=re),t.payload&&"chartVisualizationType"===t.payload.name?t.payload.value:e},Q),re),ae={parameters:{}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ie,oe,se,ce=Object(h.d)(((Y={})[J.a]=function(e,t){var r;void 0===e&&(e=ae);var n,a=t.payload.name,i=e.parameters;for(var o in i)i[o].Name===a&&(n=o);var s=Object(d.__assign)(Object(d.__assign)({},e.parameters[n]),{Value:t.payload.value}),c=Object(d.__assign)(Object(d.__assign)({},e.parameters),((r={})[n]=s,r));return c[a]&&(c[a]=t.payload.value),Object(d.__assign)(Object(d.__assign)({},e),{parameters:c})},Y),ae),le=Object(h.b)("controlName",ce),ue=r("Yc9S"),pe=Object(h.d)(((ie={})[ue.b]=function(e,t){return void 0===e&&(e=""),t.payload&&t.payload.name===ue.a?t.payload.value:e},ie),""),de=r("0rak"),he=[],ge=Object(h.d)(((oe={})[de.b]=function(e,t){return void 0===e&&(e=he),t.payload&&t.payload.name===de.a?t.payload.value:e},oe),he),fe=r("YT7W"),me=r("4Q7K"),be=r("FPMG"),ve=r("r7Ib");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ye(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _e=Object(h.d)(((se={})[ve.a]=function(e,t){if(t)return t.payload;return e},se),"");var Se,Oe=r("U/bH"),Ce=Object(h.d)(((Se={})[Oe.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},Se),null),Ie=Object(h.b)("dataSetContextKey",(function(e,t){switch(void 0===e&&(e=g.a),t.type){case f.a:return Object(d.__assign)(Object(d.__assign)({},e),{selectedRows:b(e.selectedRows,t)});case v.a:return Object(d.__assign)(Object(d.__assign)({},e),{selectedRelatedEntity:y(e.selectedRelatedEntity,t)});case _.a:return Object(d.__assign)(Object(d.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case R.a:return Object(d.__assign)(Object(d.__assign)({},e),{refreshCounter:L(e.refreshCounter,t)});case V.a:return Object(d.__assign)(Object(d.__assign)({},e),{pagingRefreshInput:G(e.pagingRefreshInput,t)});case W.a:return Object(d.__assign)(Object(d.__assign)({},e),{queryKey:q(e.queryKey,t)});case k.a:return Object(d.__assign)(Object(d.__assign)({},e),{customFilter:D(e.customFilter,t)});case I.e:case I.b:case I.f:case I.g:case I.d:case I.c:case I.a:return Object(d.__assign)(Object(d.__assign)({},e),{filters:T(e.filters,t)});case x.a:return Object(d.__assign)(Object(d.__assign)({},e),{useRollupView:E(e.useRollupView,t)});case F.a:return Object(d.__assign)(Object(d.__assign)({},e),{fetchXml:w(e.fetchXml,t)});case J.a:return Object(d.__assign)(Object(d.__assign)({},e),{viewId:Z(e.viewId,t),controls:le(e.controls,t)});case $.a:return Object(d.__assign)(Object(d.__assign)({},e),{visualizationId:ee(e.visualizationId,t)});case te.a:return Object(d.__assign)(Object(d.__assign)({},e),{chartVisualizationType:ne(e.chartVisualizationType,t)});case S.b:case S.a:return Object(d.__assign)(Object(d.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case fe.a:return Object(d.__assign)(Object(d.__assign)({},e),{pageNumber:U(e.pageNumber,t)});case me.a:return Object(d.__assign)(Object(d.__assign)({},e),{isNewPageRequested:X(e.isNewPageRequested,t)});case be.a:return Object(d.__assign)(Object(d.__assign)({},e),{pagingData:ye(e.pagingData,t)});case ve.a:return Object(d.__assign)(Object(d.__assign)({},e),{commandManagerId:_e(e.commandManagerId,t)});case ue.b:return Object(d.__assign)(Object(d.__assign)({},e),{chartFilterExpression:pe(e.chartFilterExpression,t)});case de.b:return Object(d.__assign)(Object(d.__assign)({},e),{chartDrillDownParameters:ge(e.chartDrillDownParameters,t)});case N.a:return Object(d.__assign)(Object(d.__assign)({},e),{showChart:A(e.showChart,t)});case Oe.a:return Object(d.__assign)(Object(d.__assign)({},e),{dependentOptionSetColumnStatus:Ce(e.dependentOptionSetColumnStatus,t)});default:return e}}))},W51q:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("qC0c"),a=r("cZkS"),i=r("7EJx");function o(e){return!!Object(n.a)(e,a.S,a.h)&&(!!Object(n.a)(e,a.d,a.Lc)||1033===Object(i.s)(e))}},WAlM:function(e,t,r){"use strict";r.r(t),r.d(t,"TaskBasedFlow",(function(){return Tt}));var n=r("uTwg"),a=r("9r0m"),i=r("4E+q"),o=r("lwyl"),s=r("HSdq"),c=r("+ieV"),l=r("2p2B"),u=r("3NtJ"),p=r("fTYK"),d=r("c/eZ"),h=r("sOTk"),g=r("zpQF"),f=r("Eoze"),m=r("QAhb"),b=r("i8/j"),v=r("lMVv"),y=r("TCcM"),_=r("KbPJ"),S=r("NfcN"),O=r("UTiY"),C=r("VWqI"),I=r("RYq1"),j=r("+D0h"),P=r("12y7"),T=r("sMXu"),x=r("/CqC"),E=r("ObKm"),F=r("Ww2r"),w=r("Pm+b"),N=r("7z0H"),A=r("Sscr"),k=r("tIxw"),M=r("QSLN"),D=r("RndP"),R="Button_Label_OK",L="Button_Label_Close",B="Button_Label_Cancel",V="TaskBasedFlow_Button_Next",G="TaskBasedFlow_Lookup_Label",z="Mobile_Error_On_Page_Message",W="Mobile_TaskBasedFlow_Error_When_Saving_Message",q="Mobile_TaskBasedFlow_UnableToSave_Message",U="Error_Message_0x80040226",X="Error_Title_0x80040220",H="Mobile_TaskBasedFlow_Offline_Title",K="Mobile_TaskBasedFlow_Offline_Message",Q="Mobile_TaskBasedFlow_CloseDiscard_Text",Y="Mobile_TaskBasedFlow_ReturnToTaskFlow_Text",J="Mobile_TaskBasedFlow_DiscardChanges_Text",Z="Mobile_TaskBasedFlow_Error_When_Saving_Title",$="Mobile_TaskBasedFlow_Error_When_Saving_Message",ee=[H,K,Q,Y,J,Z,$],te=[R,L,B,"Leave_This_Page","Leave_Page_Text",V,G,z,W,q,U,X,H,K,Q,Y,J,Z,$,"ProcessControl.Configurator.Expand","ProcessControl.Notification","ToastNotification_Error","ToastNotification_Warning","ToastNotification_Information","ProcessControl.NotificationCount"].concat(k.g,M.o,D.c),re=r("w/nD");function ne(e,t,r,n){return{type:"updaterelatedentitiesdataaction.async",execute:function(a,i){var s=a.dispatch,c=(a.getState,i.TraceManager.getTracer(Object(o.c)())),l={};if(n.etn===r.referencedEntity)return l[t]=n,c.info("Fetching columns "+r.referencedEntityColumnNames+" for related entity "+l[t].etn+", record id "+l[t].id.guid),s(Object(_.b)(e,l)),s(Object(f.d)(l[t],r.referencedEntityColumnNames))}}}var ae=r("aGOT"),ie=r("yHpA"),oe=r("OROb"),se=r("c7nC"),ce=r("zmaG"),le=r.n(ce),ue=r("7pqb"),pe=r("LBS5"),de=r("8JH3");function he(e,t,r){var n=Object(h.g)(e,t),a=n.uniqueName,i=[{name:"entityTypeName",value:n.entityTypeName},{name:"uniqueName",value:a}];if(r)for(var o=0,s=r;o<s.length;o++){var c=s[o];i.push(c)}return i}function ge(e,t,r){if(!Object(de.c)(e,t,r))return 0;var n=1,a=Object(s.vc)(e,t,r);return a&&(n+=a.length),n}function fe(e,t){var r=Object(A.j)(e,t);return[{name:"numPagesTraversed",value:ge(e,t,r)},{name:"numPagesTotal",value:Object(s.Ec)(e,t,r)}]}var me=r("TiXY"),be=r("cZkS"),ve=r("qC0c"),ye=Object(o.b)()+".loadDataAndInitializeComponentsAction";function _e(e,t,r,n,i,c){return{type:"loaddataandinitializecomponentsaction.async",execute:function(l,u){var p=l.dispatch,j=l.getState,P=u.TraceManager.getTracer(Object(o.c)());P.info("loadDataAndInitializeComponentsAction called: pageId "+e+", primaryModelName "+t+", formId "+r+", recordId "+n+", loadData "+c);var E=j();if(!c)return Se(p,E,e,i,P,r).then((function(){var t=Ie(r,n,c,!1),a=he(E,e,t);u.EventManager.ReportComponentSuccess(ye,a)})).catch((function(t){return Ce(E,e,u,r,n,c,!1,t),Promise.reject(t)}));!function(e,t,r){var n={};n[ue.b.TaskBasedFlowParameters.PrimaryModelName]=e,n[ue.b.FormId]=a.a.toString(t),n[ue.b.TaskBasedFlowParameters.RecordId]=a.a.toString(r),le.a.addKeyPerformanceIndicatorOnIdle("TaskBasedFlow.loadDataAndInitializeComponentsAction",n)}(t,r,n);var k=Object(h.g)(E,e),M=Object(d.__assign)(Object(d.__assign)({},k),{id:n}),D=!(!k||!k.id),L=new m.a(t,n),B=function(e,t,r,n,a){var i=Object(b.d)(e,r,t),o={},s=(new Set).add(n.etn);return Object.keys(i).forEach((function(t){var r=i[t];if(r.Relationship&&r.DataFieldName)if(o.hasOwnProperty(r.Relationship))o[r.Relationship].referencedEntityColumnNames.push(r.DataFieldName);else{var c=Object(v.x)(e,n.etn,r.Relationship);c&&c.ReferencingAttribute?(o[r.Relationship]={referencingAttribute:c.ReferencingAttribute,referencedEntity:c.ReferencedEntity,referencedEntityColumnNames:[r.DataFieldName]},s.add(c.ReferencedEntity)):a.warn("No relationship metadata or referencing attribute information found for control "+r.DataFieldName+" of primary entity "+n.etn)}})),{referenceInformationByRelationship:o,allETNsInTBX:s}}(E,e,r,L,P),V=B.referenceInformationByRelationship,G=B.allETNsInTBX;return p(Object(S.b)(e,V)),function(e,t,r,n,a){if(!function(e,t,r){for(var n=Array.from(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!Object(C.g)(e,o,2,0))return r.warn("User does not have read permission for entity "+o),!1}return!0}(e,a,r)){r.warn("Insufficient entity permissions");var i=Object(F.b)(e,U),o=Object(F.b)(e,R),s=Object(F.b)(e,X);return t(Object(T.a)({title:s,text:i,confirmButtonLabel:o},void 0,n)),t(Object(I.e)(n,"dismiss")).then((function(){return Promise.resolve(!1)}))}return r.info("Sufficient entity permissions"),Promise.resolve(!0)}(E,p,P,e,G).then((function(o){if(o){var l=new Set;Object.keys(V).forEach((function(e){l.add(V[e].referencingAttribute)})),P.info("Referencing attributes "+l+" will be included in the retrieval, needed for related entity data.");var d=p(Object(f.e)(L,r,null,Array.from(l))).catch((function(e){return P.error("Could not load primary record data because "+e.message,[je(D)]),Promise.reject(e)})).then((function(){return P.info("Fetching related entities data for primary entity record id "+n.guid),function(e,t,r,n,a,i){var o={},s=[];return Object.keys(r).forEach((function(t){var c=r[t].referencingAttribute,l=Object(y.j)(e,n,c);if(l&&l.reference&&l.reference.etn===r[t].referencedEntity){o[t]=l.reference,i.info("Fetching columns "+r[t].referencedEntityColumnNames+" for related entity "+o[t].etn+", record id "+o[t].id.guid);var u=a(Object(f.d)(o[t],r[t].referencedEntityColumnNames)).catch((function(e){var a=e&&e.message?e.message:e;return i.error("Could not retrieve record data for related entity "+o[t].etn+", record id "+o[t].id.guid+", columns "+r[t].referencedEntityColumnNames+", for primary entity "+n.etn+", referencing field "+c+", error "+a),Promise.reject(e)}));s.push(u)}})),Promise.all(s).then((function(){return a(Object(_.b)(t,o))}))}(j(),e,V,L,p,P)})),h=Se(p,E,e,i,P,r).then((function(){return function(e,t,r,n,a,i,o){return i.ScriptManager.initializeContainerForClientApi(t).then((function(){e(Object(pe.b)(r,t,a,n)),o.info("Client API initialized")})).catch((function(r){return o.info("Could not initialize container because "+r.message),e(Object(O.b)(r,!0,t)),Promise.reject(r)}))}(p,e,i,n,t,u,P).then((function(){l.forEach((function(t){!function(e,t,r,n,i,o){e(Object(re.a)(i,n,r,(function(c){o.info("onChange handler called for referencing attribute "+r);var l=t(),u=c.getEventSource().getValue(),p=Object(s.oc)(l,{id:n},i),d=Object(s.nc)(l,{id:n}),h=null;u&&u.length>0&&(h=u[0]);var g=new Set;for(var f in d)d[f].referencingAttribute===r&&g.add(f);for(var b=function(t){if(p&&p.hasOwnProperty(t)){if(!p[t])return o.error("Relationship "+t+" found in entityReferenceByRelationship but it does not contain any entity reference. This relationship will be removed."),e(Object(x.b)(n,t)),"continue";h&&h.entityType===p[t].etn?h&&p[t].id&&h.id!==p[t].id.guid&&Oe(e,l,n,t,r,p[t],i,o).then((function(r){if(r){o.debug("New record selected entityType "+h.entityType+" ID "+h.id);var i=new m.a(h.entityType,new a.a(h.id),h.name);e(ne(n,t,d[t],i))}})).catch((function(t){return e(Object(O.b)(t,!0,n))})):Oe(e,l,n,t,r,p[t],i,o).then((function(r){r&&(o.debug("Removing entity reference for relationship "+t),e(Object(x.b)(n,t)))})).catch((function(t){return e(Object(O.b)(t,!0,n))}))}else if(h&&h.entityType===d[t].referencedEntity){o.debug("New record selected entityType "+h.entityType+" ID "+h.id);var s=new m.a(h.entityType,new a.a(h.id),h.name);e(ne(n,t,d[t],s))}},v=0,y=Array.from(g);v<y.length;v++){b(y[v])}})))}(p,j,t,e,i,P)}))}))})),b=Promise.all([d,h]).then((function(){return Object(ve.c)(E,be.L)&&function(e,t,r,n){var a=n.entityTypeName;for(var i in e(Object(me.c)(a,r,n)),t){var o=Object(A.m)(n,i);e(Object(me.c)(t[i].referencedEntity,r,o))}}(p,V,e,i),Object(N.i)(j(),u,p,r,i,e,P,[])}));return P.info("Updating page input to add the record id "+n.guid+"."),p(Object(g.b)(M,e)),b.then((function(){p(Object(w.a)(!0,e,i));var t=Ie(r,n,c,D),a=he(E,e,t);u.EventManager.ReportComponentSuccess(ye,a)})).catch((function(t){return Ce(E,e,u,r,n,c,D,t),Promise.reject(t)}))}P.warn("Data not loaded because user does not have read permissions.")}))}}}function Se(e,t,r,n,a,i){return e(Object(N.h)(i,r,n)).then((function(){a.info("Form initialized");var o=Object(b.j)(t,i);return o&&o.Tabs&&o.Tabs.length>0&&e(Object(u.b)(r,n,o.Tabs[0].Id)),Promise.resolve()}))}function Oe(e,t,r,n,a,i,o,c){var l=Object(A.m)(o,n),u=Object(s.ac)(t,r,l);if(c.info("_checkAndSaveUpdatesToRelatedEntityFields called for relationship "+n),u){var p=Object(ie.b)(t,u);if(p){var d=[];for(var h in p.activeChanges)p.activeChanges[h].validationResult.isValueValid||d.push(h);return d.length>0?(c.warn("Updates contain invalid value(s) for "+d+". Changes will not be saved."),function(e,t,r,n,a,i,o,c,l,u,p){var d=Object(F.b)(t,Z),h=Object(F.b)(t,z),g=Object(F.b)(t,J),f=Object(F.b)(t,B);return e(Object(P.a)(h,{},d,r,null,g,f)).then((function(d){return e(Object(j.a)(d)).then((function(d){if(d&&d.value&&d.value.confirmed)return p.debug("Changes to related entity fields for relationship "+a+" will be discarded."),e(Object(ae.c)(r,n,u)),function(e,t,r,n,a,i){for(var o=0,c=n;o<c.length;o++){var l=c[o],u=Object(s.z)(t,r,i,l,a);if(u)for(var p=0,d=u;p<d.length;p++){var h=d[p];e(Object(se.b)(r,h,!0,i))}}}(e,t,r,c,a,l),Promise.resolve(!0);p.debug("Changes to related entity fields for relationship "+a+" will not be discarded.");var h={};return h[i]={fieldName:i,value:o},e(Object(E.a)(r,h,null,!0)),Promise.resolve(!1)}))}))}(e,t,r,u,n,a,i,d,o,l,c)):(c.info("Saving updates to related entity fields"),e(Object(oe.c)(u,!0)).then((function(){return e(Object(ae.c)(r,u,l)),Promise.resolve(!0)})).catch((function(e){return c.error("Error while saving snapshot "+e),Promise.reject(e)})))}c.warn("No data snapshot found for relationship "+n+", snapshot ID "+u+". Changes will not be saved.")}return Promise.resolve(!0)}function Ce(e,t,r,n,a,i,o,s){var c=s&&s.message?s.message:s,l=he(e,t,Ie(n,a,i,o));r.EventManager.ReportComponentFailure(ye,Error(c),void 0,l)}function Ie(e,t,r,n){return[{name:"formId",value:a.a.toString(e)},{name:"recordId",value:a.a.toString(t)},{name:"loadData",value:r},je(n)]}function je(e){return{name:"IDSpecifiedThroughClientAPI",value:e}}var Pe,Te=r("1Tfq"),xe=r("p5Y6");function Ee(e,t){return void 0===t&&(t=!1),{type:"cancel.taskBasedFlowAction.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),c=n.TraceManager.getTracer(Object(o.c)()),l=Object(o.b)()+".CancelTaskBasedFlowAction";return t?Fe(i,n,a,e,l):function(e,t){var r=Object(A.j)(e,t);if(Object(ie.g)(e,Object(s.ac)(e,t,r)))return!0;var n=Object(s.nc)(e,{id:t}),a=n&&Object.keys(n);return a&&a.some((function(n){var a=Object(A.m)(r,n);return Object(ie.g)(e,Object(s.ac)(e,t,a))}))}(i,e)?(c.info("Attempting to close task flow that has pending changes"),a(Object(Te.a)(e)).then((function(t){if(t)return Fe(i,n,a,e,l);var r=fe(i,e).concat([{name:"closed",value:!1}]),o=he(i,e,r);return n.EventManager.ReportComponentSuccess(l,o),Promise.resolve({})}))):we(i,a,n,e,l)}}}function Fe(e,t,r,n,a){return r(Object(xe.a)(n)).then((function(){return we(e,r,t,n,a)}))}function we(e,t,r,n,a){return t(Object(I.e)(n,"dismiss")).then((function(){var t=fe(e,n).concat([{name:"closed",value:!0}]),i=he(e,n,t);return r.EventManager.ReportComponentSuccess(a,i),Promise.resolve({})}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Valid=0]="Valid",e[e.InvalidControlOnCurrentTab=1]="InvalidControlOnCurrentTab",e[e.InvalidControlInTraversedTabs=2]="InvalidControlInTraversedTabs",e[e.InvalidControlNotInTraversedTabs=3]="InvalidControlNotInTraversedTabs"}(Pe||(Pe={}));var Ne=r("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ae(e,t,r){for(var n=Object(s.uc)(e,t,r),a=Object(Ne.a)(e,t),i=Object(s.yb)(a,r),o=new Set(Object(s.vc)(e,t,r)).add(n),c=!1,l=!1,u=!1,p=0,d=i;p<d.length;p++){var h=d[p],g=Object(s.bc)(a,h,r),f=Object(s.cc)(a,g,r);if(f===n?u=!0:o.has(f)?l=!0:c=!0,u&&c&&l)break}return u?Pe.InvalidControlOnCurrentTab:l?Pe.InvalidControlInTraversedTabs:c?Pe.InvalidControlNotInTraversedTabs:Pe.Valid}var ke=r("QqTr"),Me=r("r2h9"),De=r("RlP9"),Re=r("wV3W"),Le=r("aPRd"),Be=r("nuS9"),Ve=r("zSKH"),Ge=r("YWpA"),ze=r("uTTW"),We=r("H/hG"),qe=r("evW+"),Ue=r("S2mk"),Xe=r("NJzV"),He=r("znb3"),Ke=r("XIN1"),Qe=r("PMTb"),Ye=r("akzq"),Je=r("MGMD"),Ze=r("zsi3"),$e=r("l2WT"),et=r("9rQ4"),tt=r("E705"),rt=r("Wi7Z"),nt=r("Srej"),at=function(e){function t(t){var r=e.call(this,t)||this;return r._navigationButtonWasClicked=!1,r._onKeyDownHandler=r._onKeyDownHandler.bind(r),r._onLookupNextClick=r._onLookupNextClick.bind(r),r._onCancelButtonClick=r._onCancelButtonClick.bind(r),r._onTbxLoadMeasuring=r._onTbxLoadMeasuring.bind(r),r.state={selectedRecordId:void 0,lookupInputElementId:"tbxLookup"},r}return Object(d.__extends)(t,e),t.prototype._clearFormNotification=function(){this.props.clearFormNotification(this.props.contextToken,this._formErrorNotificationId),this._formErrorNotificationId=null},t.prototype._openTBXOfflineDialog=function(){var e=this;this.props.openTBXOfflineDialog().then((function(t){t&&e.props.cancelForm(!0)}))},t.prototype._onCancelButtonClick=function(e){this.props.cancelForm(!1)},t.prototype._renderCancelButton=function(){var e,t=Object(F.c)(this.props.resourceStrings,L);return Be.createElement(Ge.a,{id:"tbxCancelButtonContainer",key:"tbxCancelButtonContainer",role:rt.r,style:this.props.tbxCancelButtonContainerStyle},Be.createElement(Ge.a,{id:"tbxCancelButtonPaddingContainer",key:"tbxCancelButtonPaddingContainer",role:rt.r,style:this.props.tbxCancelButtonPaddingContainerStyle},Be.createElement(qe.a,{id:"tbxCancelBtn",testhooks:(e={id:"tbxCancelBtn"},e[Je.a.LearningPathDOMAttributeSuffix]="tbx|tbxCancelBtn",e),ref:"tbxCancelBtn",key:"tbxCancelBtn",onClick:this._onCancelButtonClick,accessibilityLabel:t,title:t,style:this.props.cancelButtonStyle},Be.createElement(Ke.b,{id:"tbxCancelIcon",type:He.a.Cancel,style:this.props.tbxButtonIconStyle}))))},t.prototype._renderHeader=function(){var e,t,r=null;this.props.descriptor&&this.props.descriptor.imageUrl&&(r=Be.createElement(ze.a,{source:this.props.descriptor.imageUrl,style:this.props.tbxHeaderBackgroundImageStyle,role:rt.r}));var n=this.props.descriptor&&this.props.descriptor.displayName?this.props.descriptor.displayName:"",a=this.props.descriptor&&this.props.descriptor.description?this.props.descriptor.description:"";return Be.createElement(Ge.a,{id:"tbxHeaderContainer",key:"tbxHeaderContainer",testhooks:{id:"tbxHeaderContainer"},style:this.props.tbxHeaderContainerStyle,role:rt.r},r,Be.createElement(Ge.a,{key:"tbxHeaderBlackBackground",style:this.props.tbxHeaderBlackBackgroundStyle,role:rt.r}),Be.createElement(Ge.a,{key:"tbxHeaderSubContainer",style:this.props.tbxHeaderSubContainerStyle,role:rt.r},this._renderCancelButton(),Be.createElement(Ge.a,{id:"tbxHeaderTextContainer",key:"tbxHeaderTextContainer",style:this.props.tbxHeaderTextContainerStyle,role:rt.r},Be.createElement(Ge.a,{id:"tbxHeaderTextPaddingContainer",key:"tbxHeaderTextPaddingContainer",style:this.props.tbxHeaderTextPaddingContainerStyle,role:rt.r},Be.createElement(We.a,{id:"tbxHeader",key:"tbxHeader",testhooks:(e={id:"tbxHeader"},e[Je.a.LearningPathDOMAttributeSuffix]="tbx|tbxHeaderContainer|tbxHeader",e),semanticTag:"h1",style:this.props.tbxHeaderStyle,tabIndex:-1},n),Be.createElement(We.a,{id:"tbxSubHeader",key:"tbxSubHeader",testhooks:(t={id:"tbxSubHeader"},t[Je.a.LearningPathDOMAttributeSuffix]="tbx|tbxHeaderContainer|tbxSubHeader",t),semanticTag:"h2",style:this.props.tbxSubHeaderStyle,tabIndex:-1,accessibilityHidden:!a},a)))))},t.prototype._renderTabs=function(){var e=[];if(this.props.formDescriptor&&this.props.formDescriptor.Tabs)for(var t=0,r=this.props.formDescriptor.Tabs;t<r.length;t++){var n=r[t];e.push(Be.createElement(Ve.a,{cellStyle:this.props.customCellStyle,sectionStyle:this.props.customSectionStyle,cellContainerStyle:this.props.cellContainerStyle,style:this.props.tbxTabStyle,key:n.Name,id:this.props.id,tabId:n.Id,tabName:n.Name,showTab:n.Id===this.props.activeTabId}))}return Be.createElement(Ge.a,{id:"tbxTabContainer",key:"tbxTabContainer",role:rt.r,style:this.props.tbxTabContainerStyle},e)},t.prototype._getActiveTab=function(){var e=this;if(this.props&&this.props.formDescriptor&&this.props.formDescriptor.Tabs){var t=this.props.formDescriptor.Tabs.find((function(t){return t.Id===e.props.activeTabId}));return null!=t?t:this.props.formDescriptor.Tabs[0]}return null},t.prototype._renderFooter=function(){var e=this,t=Object(nt.g)("tbxFooterContainer",this.props.id),r=[];if(this.props.isRecordBound){if(this.props.formDescriptor&&this.props.formDescriptor.Tabs){var n=this._getActiveTab();n&&n.Footer&&n.Footer.forEach((function(t,a){var i=t.Id,o=t.Label,s=a===n.Footer.length-1,c=!s||s&&e.props.isXrmReady,l=e._renderFooterRegularButton(s,i,o,!c);e.props.isMobileMode?r.unshift(l):r.push(l)}))}}else{var a=Object(F.c)(this.props.resourceStrings,V);r.push(this._renderFooterButton(!0,"tbxNextButton","Next_button",a,this._onLookupNextClick,null==this.state.selectedRecordId))}return r.length?Be.createElement(Ge.a,{id:t,key:t,style:this.props.tbxButtonContainerStyle,className:"dialogButtons"},r):null},t.prototype._renderFooterRegularButton=function(e,t,r,n){void 0===n&&(n=!1);var a=t;a=t.indexOf("_back")>0?"Back_button":Object(F.c)(this.props.resourceStrings,V)===r?"Next_button":"Done_button";var i=t.indexOf("_back")>0?this._backOnClick.bind(this):this._forwardOnClick.bind(this,t);return this._renderFooterButton(e,t,a,r,i,n)},t.prototype._backOnClick=function(){this.props.isOffline?this._openTBXOfflineDialog():this._navigationIsAllowed(1)&&(this._setNavigationButtonWasClicked(),this.props.navigateBack(this.props.contextToken))},t.prototype._forwardOnClick=function(e){if(this.props.isOffline)this._openTBXOfflineDialog();else{if(this.props.validationResult!==Pe.Valid&&!this._formErrorNotificationId){var t=void 0;switch(this.props.validationResult){case Pe.InvalidControlOnCurrentTab:t=z;break;case Pe.InvalidControlInTraversedTabs:t=W;break;default:t=q}var r=Object(F.c)(this.props.resourceStrings,t),n=new Date;this._formErrorNotificationId="nf_"+n.getMilliseconds().toString(),this.props.setFormNotification(this.props.contextToken,r,Ze.a.error,this._formErrorNotificationId)}this._navigationIsAllowed(0)&&(this._setNavigationButtonWasClicked(),this.props.customOnClick(this.props.contextToken,e))}},t.prototype._navigationIsAllowed=function(e){return 0===e?!this._navigationButtonWasClicked&&this.props.validationResult!==Pe.InvalidControlOnCurrentTab:1===e&&(!this._navigationButtonWasClicked||this.props.validationResult===Pe.InvalidControlInTraversedTabs)},t.prototype._renderFooterButton=function(e,t,r,n,a,i){var o;if(void 0===i&&(i=!1),null!=t){n=n||"";var s=Object(nt.g)(t+"_"+n,this.props.id);return Be.createElement(qe.a,{testhooks:(o={id:r},o[Je.a.LearningPathDOMAttributeSuffix]="tbx|"+t,o),id:s,key:s,style:e?this.props.tbxFooterPrimaryButtonStyle:this.props.tbxFooterDefaultButtonStyle,tabIndex:0,accessibilityLabel:n,onClick:a,disabled:i},Be.createElement(We.a,{id:"tbxButtonText_"+s,key:"tbxButtonText_"+s,style:e?this.props.tbxFooterPrimaryButtonTextStyle:this.props.tbxDefaultButtonTextStyle},n))}return null},t.prototype._onLookupNextClick=function(){this.props.isOffline?this._openTBXOfflineDialog():null!=this.state.selectedRecordId&&(this._navigationButtonWasClicked||(this._setNavigationButtonWasClicked(),this.props.loadRecordData(this.state.selectedRecordId,this.props.descriptor.primaryModelName,this.props.formDescriptor.Id,this.props.contextToken)))},t.prototype._setNavigationButtonWasClicked=function(){var e=this;this._navigationButtonWasClicked=!0,window.setTimeout((function(){e._navigationButtonWasClicked=!1}),500)},t.prototype._renderLookupControl=function(){if(this.props.descriptor&&this.props.formDescriptor){if(this._memoizedDefaultViewId!==this.props.defaultViewId||this._memoizedPrimaryModelName!==this.props.descriptor.primaryModelName){this._memoizedDefaultViewId=this.props.defaultViewId,this._memoizedPrimaryModelName=this.props.descriptor.primaryModelName;var e=Object(F.c)(this.props.resourceStrings,G),r=this._lookupValueChanged.bind(this);this._memoizedLookupControlConfiguration=Object(Ue.C)("MscrmControls.FieldControls.SimpleLookupControl",this.props.defaultViewId,this.props.descriptor.primaryModelName,e,r)}if(this.props.formDescriptor&&this.props.defaultViewId){var n=[{eventname:"getLabelUniqueId",eventhandler:[this._setLookupInputElementId.bind(this)]}];return Be.createElement(Xe.c,{key:"tbxLookup",id:this.props.id,controlId:"MscrmControls.FieldControls.SimpleLookupControl",configuration:this._memoizedLookupControlConfiguration,descriptor:t._Lookup_descriptor,systemDefinedProperties:this.props.customControlPropertyBag,parentDefinedControlProps:{eventListeners:n}})}}return null},t.prototype._renderLabel=function(){if(!this.props.isRecordBound){var e=Object(F.c)(this.props.resourceStrings,G);return Be.createElement(Qe.a,{id:"tbxLookupLabel",key:"tbxLookupLabel",style:this.props.tbxLookupLabelStyle,tabIndex:-1,forElementId:this.state.lookupInputElementId,accessibilityLabel:e},e)}return null},t.prototype._renderFormNotifications=function(){return this.props&&this.props.formNotificationIds?Be.createElement($e.a,{key:"formNotificationList",id:this.props.id,domWidth:this._domWidth,displayFullMessage:!0,component:"tbxRoot"}):null},t.prototype._lookupValueChanged=function(e){var t;if(e&&e.length>0&&(t=e[0]),t&&t.id){var r=a.a.tryParse(t.id),n=a.a.isNullOrEmpty(r)?void 0:r;this.setState({selectedRecordId:n})}else this.setState({selectedRecordId:void 0})},t.prototype._setLookupInputElementId=function(e){e&&e.id&&this.state.lookupInputElementId!==e.id&&this.setState({lookupInputElementId:e.id})},t.prototype._onKeyDownHandler=function(e){this.props.isTopDialog&&e.keyCode===et.a.Escape&&(e.stopImmediatePropagation(),this.props.cancelForm(!1))},t.prototype.componentDidUpdate=function(e,t){if(this.props.validationResult===Pe.Valid&&this._formErrorNotificationId&&this._clearFormNotification(),this.props.activeTabId!==e.activeTabId&&(this._focusedOnceOnElementInTab=!1),this.props.activeTabId===e.activeTabId&&this.props.isRecordBound===e.isRecordBound||(this._navigationButtonWasClicked=!1),this.props.isRecordBound&&!this._focusedOnceOnElementInTab){var r=Object(tt.b)(document.getElementById("tbxTabContainer"));r&&(r.editableElement||r.focusableElement)||(r=Object(tt.b)(document.getElementById("tbxBody"))),r.editableElement?(r.editableElement.focus(),this._focusedOnceOnElementInTab=!0):r.focusableElement&&(r.focusableElement.focus(),this._focusedOnceOnElementInTab=!0)}},t.prototype._onTbxLoadMeasuring=function(e){this._domWidth=document.getElementById("tbxBody").offsetWidth},t.prototype.render=function(){var e=[];return e.push(Be.createElement(Ye.a,{key:"tbxAccessibility",rootElementId:"tbxRoot",shouldManageFocus:!0,isModal:!0,waitForEditable:!0})),Be.createElement(Ge.a,{id:"tbxRoot",key:"tbxRoot",testhooks:{id:"tbxRoot"},style:this.props.rootContainerStyle,role:rt.e,accessibilityHidden:!1,labelledByElementId:"tbxHeader",describedByElementId:"tbxSubHeader",tabIndex:-1},this._renderHeader(),Be.createElement(Ge.a,{id:"tbxBody",key:"tbxBody",style:this.props.tbxBodyStyle,isRequestedMeasuring:!0,onMeasuring:this._onTbxLoadMeasuring,role:rt.r},this._renderFormNotifications(),this._renderLabel(),this.props.isRecordBound?this._renderTabs():this._renderLookupControl(),this._renderFooter()),e)},t.prototype.componentDidMount=function(){document.addEventListener("keydown",this._onKeyDownHandler)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._onKeyDownHandler)},t._Lookup_descriptor={Id:"MscrmControls.FieldControls.SimpleLookupControl",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,DomId:"tbxLookup",Parameters:{defaulttype:"1",lookupstyle:"single"}},t}(Be.Component),it=r("QVns"),ot=r("TCzx");var st=r("Bgsp"),ct=r("yZTI"),lt=r("JlqV");var ut=r("7EJx"),pt=r("Tr6b");var dt=Object(i.a)((function(){var e,t,r=Object(s.Yc)(),n=(e=null,t=Pe.Valid,function(r,n){var a=Object(Ne.a)(r,n.pageId);return e&&e===a||(e=a,t=Ae(r,n.pageId,n.contextToken)),t}),i=Object(pt.b)(),c={controlName:null,id:null,scope:pt.a.EditForm,cellSizeMode:0};return function(e,t){var l=t.id,u=Object(A.j)(e,l),p=Object(Re.a)(e),g=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return t&&e&&e.sizes.Breakpoints.DimensionS&&t.deviceWidth<e.sizes.Breakpoints.DimensionS}(p,Object(Le.a)(e)),f=!Object(lt.b)(e),m=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r){var n=it.d.White,a={minWidth:t?"100%":e.sizes.Measures.Measure600,marginLeft:t?"0px":e.sizes.Measures.Measure025,marginRight:t?"0px":e.sizes.Measures.Measure025},i={minWidth:t?"100%":e.sizes.Measures.Measure600,marginLeft:t?"0px":e.sizes.Measures.Measure025,marginRight:t?"0px":e.sizes.Measures.Measure025,marginTop:t?e.sizes.Measures.Measure075:"0px"},o={margin:ot.a.getInstance().get_IsBrowserIE()?void 0:"auto"},s=Object(d.__assign)(Object(d.__assign)({},e.buttons.Button01Primary),a),c=Object(d.__assign)(Object(d.__assign)({},e.buttons.Button01Secondary),i),l=Object(d.__assign)(Object(d.__assign)({},e.buttons.ButtonPrimaryText),o),u=Object(d.__assign)(Object(d.__assign)({},e.buttons.ButtonSecondaryText),o),p={":focus":{outline:"1px dotted "+n+"!important"},":hover":{backgroundColor:it.d.Grey.Grey4}},h={borderStyle:"none",backgroundColor:"transparent",cursor:"pointer",minWidth:e.sizes.Measures.Measure200,height:e.sizes.Measures.Measure200,opacity:1,zIndex:1,alignSelf:"flex-end",justifyContent:"center",padding:"0",display:"block"},g=Object(d.__assign)(Object(d.__assign)({},h),p);return{rootContainerStyle:{flexWrap:"nowrap",height:"100%",width:t?"100vw":"30rem",alignContent:"flex-start",flexDirection:"column",boxSizing:"border-box",backgroundColor:"#FFFFFF"},tbxBodyStyle:{flexDirection:"column",flexGrow:1,overflow:"auto",paddingRight:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,paddingTop:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,paddingBottom:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure200,borderLeftWidth:"1px",borderRightWidth:"1px",borderBottomWidth:"1px",borderStyle:e.display.SolidBorderStyle,borderColor:"transparent"},tbxLookupLabelStyle:{fontFamily:e.fontFamilies.Regular,fontSize:e.fontSizes.Font100,color:"#3b79b7",marginBottom:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150},tbxHeaderContainerStyle:{display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:t?e.sizes.Measures.Measure775:e.sizes.Measures.Measure1075,maxHeight:t?e.sizes.Measures.Measure775:e.sizes.Measures.Measure1075,zIndex:0,position:"relative",overflow:"hidden"},tbxHeaderBackgroundImageStyle:{position:"absolute",top:0,left:0,width:"100%",height:"auto",marginTop:"-28%",zIndex:-10,filter:"blur(6px)"},tbxHeaderBlackBackgroundStyle:{position:"absolute",top:0,left:0,width:"100%",minHeight:t?e.sizes.Measures.Measure775:e.sizes.Measures.Measure1075,zIndex:-1,backgroundColor:"black",opacity:.65},tbxHeaderSubContainerStyle:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},tbxHeaderStyle:{width:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:"white",textAlign:"center",fontSize:t?e.fontSizes.Font125:e.fontSizes.Font150,fontFamily:e.fontFamilies.Semibold,marginBottom:e.sizes.Measures.Measure050,minHeight:e.sizes.Measures.Measure175},tbxSubHeaderStyle:{textOverflow:"ellipsis",overflow:"hidden",color:"white",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Regular,fontWeight:"normal",textAlign:"center",lineHeight:"1.4rem",maxHeight:t?"2.8rem":"4.2rem"},tbxHeaderTextContainerStyle:{alignSelf:"center",flexDirection:"column",maxWidth:"100%",height:t?e.sizes.Measures.Measure775:e.sizes.Measures.Measure1075},tbxHeaderTextPaddingContainerStyle:{flexDirection:"column",paddingLeft:e.sizes.Measures.Measure100,paddingRight:e.sizes.Measures.Measure100},tbxButtonContainerStyle:{justifyContent:t?"center":"flex-end",alignSelf:t?"center":"flex-end",flexDirection:t?"column":"row",alignItems:t?"center":void 0,marginTop:"auto",minWidth:t?"100%":void 0,flex:"0 0 auto"},tbxFooterPrimaryButtonStyle:s,tbxFooterPrimaryButtonTextStyle:l,tbxFooterDefaultButtonStyle:c,tbxDefaultButtonTextStyle:u,tbxButtonIconStyle:{color:"white",width:"40%",backgroundColor:"transparent",fontSize:e.fontSizes.TextBox.FontIcon},cancelButtonStyle:g,tbxCancelButtonContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"},tbxCancelButtonPaddingContainerStyle:{paddingTop:e.sizes.Measures.Measure100,paddingRight:r?"0px":e.sizes.Measures.Measure100,paddingLeft:r?e.sizes.Measures.Measure100:"0px",display:"block",maxHeight:"1.3rem"},tbxTabContainerStyle:{overflow:"auto",width:"100%",marginBottom:t?e.sizes.Measures.Measure200:e.sizes.Measures.Measure100},tbxTabStyle:{width:"100%"},cellContainerStyle:{flex:"1 0 auto"},customSectionStyle:{flex:"1 0 auto"},customCellStyle:{minHeight:0,flex:"0 1 auto"}}}(p,g,Object(ut.g)(e)),b=i(c,e,u),v=r(e,t.id),y=Object(o.a)(e,t),_=Object(s.fb)(e,t,u),S=Object(h.a)(e,t),O=y?Object(De.a)(e,y.primaryModelName,Me.a.LOOKUP_VIEW):null,C=Object(st.a)(e),I=Object(ct.b)(e)===t.id&&!C,j=Pe.Valid,P=Object(de.c)(e,l,u);return _&&(j=n(e,{pageId:l,contextToken:u})),{descriptor:y,formDescriptor:_,uniqueId:a.a.newGuid(),rootContainerStyle:m.rootContainerStyle,tbxBodyStyle:m.tbxBodyStyle,tbxLookupLabelStyle:m.tbxLookupLabelStyle,tbxHeaderContainerStyle:m.tbxHeaderContainerStyle,tbxHeaderBackgroundImageStyle:m.tbxHeaderBackgroundImageStyle,tbxHeaderBlackBackgroundStyle:m.tbxHeaderBlackBackgroundStyle,tbxHeaderSubContainerStyle:m.tbxHeaderSubContainerStyle,tbxHeaderStyle:m.tbxHeaderStyle,tbxSubHeaderStyle:m.tbxSubHeaderStyle,tbxHeaderTextContainerStyle:m.tbxHeaderTextContainerStyle,tbxHeaderTextPaddingContainerStyle:m.tbxHeaderTextPaddingContainerStyle,tbxButtonContainerStyle:m.tbxButtonContainerStyle,tbxFooterDefaultButtonStyle:m.tbxFooterDefaultButtonStyle,tbxDefaultButtonTextStyle:m.tbxDefaultButtonTextStyle,tbxFooterPrimaryButtonStyle:m.tbxFooterPrimaryButtonStyle,tbxFooterPrimaryButtonTextStyle:m.tbxFooterPrimaryButtonTextStyle,cancelButtonStyle:m.cancelButtonStyle,tbxCancelButtonContainerStyle:m.tbxCancelButtonContainerStyle,tbxCancelButtonPaddingContainerStyle:m.tbxCancelButtonPaddingContainerStyle,tbxButtonIconStyle:m.tbxButtonIconStyle,tbxTabContainerStyle:m.tbxTabContainerStyle,tbxTabStyle:m.tbxTabStyle,customSectionStyle:m.customSectionStyle,cellContainerStyle:m.cellContainerStyle,customCellStyle:m.customCellStyle,defaultViewId:O?a.a.toString(O):a.a.EMPTYSTRING,isRecordBound:!!S.id,isTopDialog:I,activeTabId:Object(s.wc)(e,t,u),validationResult:j,formNotificationIds:v,contextToken:u,resourceStrings:Object(F.e)(e,te),isMobileMode:g,isOffline:f,customControlPropertyBag:b,isXrmReady:P}}}),(function(e,t){return{customOnClick:function(r,n){n&&e(Object(ke.a)(r,t.id,n))},cancelForm:function(r){e(Ee(t.id,r))},loadRecordData:function(r,n,a,i){e(_e(t.id,n,a,r,i,!0))},selectTab:function(r,n){e(Object(u.b)(t.id,n,r))},navigateBack:function(r){e(Object(p.b)(t.id,r))},setFormNotification:function(r,n,a,i){e(Object(c.c)(r,t.id,n,a,i))},clearFormNotification:function(r,n){e(Object(l.b)(r,t.id,n))},openTBXOfflineDialog:function(){return e((r=t.id,{type:"taskBasedFlow.opneOfflineDialog.async",execute:function(e){var t=e.dispatch,n=e.getState,a=Object(F.e)(n(),ee),i=Object(F.c)(a,H),o=Object(F.c)(a,K),s=Object(F.c)(a,Q),c=Object(F.c)(a,Y);return t(Object(P.a)(o,{},i,r,"",s,c)).then((function(e){return 0===e.status?t(Object(j.a)(e.pageId)).then((function(e){return e.value.confirmed})):Promise.reject(e.error)}))}}));var r}}}))(at),ht=r("52Se"),gt=r("BFwB"),ft=function(e){function t(t){var r=e.call(this,"uci_taskflow_opened")||this;return r.addEventParameter("EventTime",new Date),r.addEventParameter("UniqueName",t),r}return Object(d.__extends)(t,e),t}(gt.a),mt=r("mGpW"),bt=r("NWJ/"),vt=r("rQCE"),yt=r("KIny"),_t=r("ep/o");function St(e){return{type:"initialize.taskBasedFlowAction.async",execute:function(t,r){var n=t.dispatch,i=t.getState,s=r.TraceManager.getTracer(Object(o.c)()),c=Object(o.b)()+".intializeAction",l=i(),u=Object(h.g)(l,e),p=u.uniqueName,d=u.id,g=u.entityTypeName;s.info("Executing task flow initialize action uniqueName: "+p+" id: "+a.a.toString(d)+" entityTypeName: "+g);var f=Object(A.j)(l,e),b=Object(yt.a)(l,p),v=new m.a(b.primaryModelName,d),y=v&&!a.a.isNullOrEmpty(v.id),_=n(_e(e,v.etn,b.formId,v.id,f,y)),S=n(Object(mt.e)(te));return Object(_t.a)(t,r,e),Promise.all([_,S]).then((function(t){!function(e,t,r){e.EventManager.ReportComponentSuccess(t);var n=new ft(r);e.EventManager.ReportEvent(n)}(r,c,p),n(Object(bt.b)(e,vt.a.FullLoad))})).catch((function(t){var i=t&&t.message?t.message:t;return r.EventManager.ReportComponentFailure(c,Error("Error in initializeAction due to "+i+" uniqueName: "+p+" id: "+a.a.toString(d)+" entityTypeName: "+g)),s.error("Error in initializeAction due to "+i+" uniqueName: "+p+" id: "+a.a.toString(d)+" entityTypeName: "+g),(t&&!t.getNegativeErrorCode||t&&t.getNegativeErrorCode&&-2147220969!==t.getNegativeErrorCode())&&n(Object(O.b)(t,!0)).then((function(){n(Object(I.e)(e,"dismiss"))})),Promise.reject(t)}))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ot=function(e){function t(t){var r=e.call(this,"uci_taskflow_saved")||this;return r.addEventParameter("EventTime",new Date),r.addEventParameter("UniqueName",t),r}return Object(d.__extends)(t,e),t}(gt.a);function Ct(){var e=document.getElementById("tbxMenuLauncher");null!=e&&e.focus()}var It=r("rVsJ"),jt=r("UGbr"),Pt=r("/j9Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Tt=function(){function e(e){this._id=e,this._initializeAction=St(this._id)}return e.prototype.getName=function(){return n.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return this._initializeAction},e.prototype.getRootReducer=function(){return ht.a},e.prototype.getRootComponent=function(){return dt},e.prototype.getCloseAction=function(e){return function(e,t){var r=t;return{type:"close.taskBasedFlowAction.async",execute:function(t,n){t.dispatch;var a=(0,t.getState)(),i=n.TraceManager.getTracer(Object(o.c)()),s=Object(o.b)()+".CloseTaskBasedFlowAction",c=Object(h.g)(a,e).uniqueName;if("dismiss"===r)return i.info("Changes have not been saved and TBX will be closed."),Ct(),Promise.resolve({});var l=fe(a,e);n.EventManager.ReportComponentSuccess(s,he(a,e,l)),i.info("Changes have been saved and TBX will be closed.");var u=new Ot(c);return n.EventManager.ReportEvent(u),Ct(),Promise.resolve({})}}}(this._id,e)},e.prototype.prePageClose=function(e,t,r,n,a){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t,r,n,a){var i=t.TraceManager.getTracer(Object(o.c)()),s=Object(h.g)(n(),e),c=s.uniqueName,l=s.id,u=s.entityTypeName;if("dismiss"===a||"close"===a&&null==l){var p={resultType:It.a.Success};return Promise.resolve(p)}var d=n(),g=Ae(d,e,Object(A.j)(d,e));if(g!==Pe.Valid){var f=Object(F.e)(d,te),m=void 0;switch(g){case Pe.InvalidControlOnCurrentTab:m=z;break;case Pe.InvalidControlInTraversedTabs:m=W;break;case Pe.InvalidControlNotInTraversedTabs:default:m=q}var b=Object(F.c)(f,m),v=new Pt.a(b);return r(Object(O.b)(v,!0)),p={resultType:It.a.Fail,resultValue:v},Promise.resolve(p)}return r(Object(jt.e)(e,1)).then((function(){var e={resultType:It.a.Success};return Promise.resolve(e)})).catch((function(e){e=e&&e.reason?e.reason:e;var t={resultType:It.a.Success};if(2200000006!==e.errorCode){var r=e&&e.message?e.message:e;i.warn("Changes have not been saved and TBX has not closed. uniqueName: "+c+" id: "+l.guid+" entityTypeName: "+u+" Error: "+r+" "),t={resultType:It.a.Fail,resultValue:e}}return Promise.resolve(t)}))}(e,t,r,n,a)},e}()},WVwd:function(e,t,r){"use strict";r.d(t,"a",(function(){return Y})),r.d(t,"b",(function(){return J}));var n,a,i,o=r("9r0m"),s=r("HSdq"),c=r("BWVO"),l=r("7ipg"),u=r("1z64"),p=r("QAhb"),d=r("/eCp"),h=r("TCcM"),g=r("nbQV"),f=r("IiPO"),m=r("+Z9T"),b=r("ezfI"),v=function(){function e(e,t,r){var n="ClientApi.XrmProcessStep.constructor";t||Object(m.j)(n,"step"),r||Object(m.j)(n,"processManager"),e||Object(m.j)(n,"store"),this._step=t,this._processManager=r}return e.prototype.isRequired=function(){var e="ClientApi.XrmProcessStep.isRequired";try{b.a.instance.reportCall(e);var t=this._step.get_isProcessRequired();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getAttribute=function(){var e="ClientApi.XrmProcessStep.getAttribute";try{if(b.a.instance.reportCall(e),!this._attribute){var t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return b.a.instance.reportSuccess(e),this._attribute}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStep.getName";try{b.a.instance.reportCall(e);var t=this._step.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getProgress=function(){var e="ClientApi.XrmProcessStep.getProgress";try{b.a.instance.reportCall(e);var t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0))if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){var r=this._processManager.getActionLog(new o.a(this._step.get_Id()));r&&(t=r.status),t=0}return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.setProgress=function(e,t){var r="ClientApi.XrmProcessStep.setProgress";try{b.a.instance.reportCall(r);var n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return b.a.instance.reportSuccess(r),n}catch(e){throw f.a.getInstance().reportFailure(r,e),e}},e.prototype._setProgressInternal=function(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)&&this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){var r=this._processManager.UpdateActionLog(new o.a(this._step.get_Id()),e,t);if(r)return r}return"invalid"},e}(),y=r("Zy0S"),_=function(){function e(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}return Object.defineProperty(e.prototype,"allowCreateNew",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew},set:function(e){var t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{b.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),b.a.instance.reportSuccess(t)}catch(e){throw f.a.getInstance().reportFailure(t,e),e}},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r,a,i){n=e,this._entityTypeName=r,this._activeStageId=a,this._stageStep=t,new _(e,i),i&&(this._processManager=i)}return e.prototype.getCategory=function(){var e="ClientApi.XrmProcessStage.getCategory";try{b.a.instance.reportCall(e);var t=this._stageStep.get_stageCategory(),r={getValue:function(){var e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return b.a.instance.reportSuccess(e),r}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmProcessStage.getId";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getEntityName=function(){return b.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessStage.getStatus";try{b.a.instance.reportCall(e);var t=this.getId()===this._activeStageId?"active":"inactive";return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStage.getName";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Description();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getSteps=function(){var e="ClientApi.XrmProcessStage.getSteps";try{if(b.a.instance.reportCall(e),!this._steps&&(this._steps=new y.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(var t=0;t<this._stageStep.get_Steps().get_Count();t++){var r=this._stageStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var a=r.get_Steps().get_item(0);a&&(a instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(r.get_Id(),new v(n,r,this._processManager))}}return b.a.instance.reportSuccess(e),this._steps}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getNavigationBehavior=function(){var e="ClientApi.XrmProcessStage.getNavigationBehavior";try{b.a.instance.reportCall(e);var t=this._processManager.getBpfNavigationBehavior();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e}(),O=function(){function e(e,t,r,n,i){var o="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(m.j)(o,"workflowStep"),n||Object(m.j)(o,"activeStageId"),i||Object(m.j)(o,"processManager"),e||Object(m.j)(o,"store"),Object(m.a)(r)&&Object(m.j)(o,"isRendered"),a=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=i}return e.prototype.getName=function(){var e="ClientApi.XrmBusinessProcessFlow.getName";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmBusinessProcessFlow.getId";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e.prototype.isRendered=function(){return b.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered},e.prototype.getStages=function(){var e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(b.a.instance.reportCall(e),!this._stages){this._stages=new y.a(e);for(var t=0;t<this._workflowStep.get_Steps().get_Count();t++){var r=this._workflowStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep)for(var n=r,i=0;i<n.get_Steps().get_Count();i++){var o=n.get_Steps().get_item(i);this._stages.add(o.get_Id(),new S(a,o,n.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}return b.a.instance.reportSuccess(e),this._stages}catch(t){throw f.a.getInstance().reportFailure(e,t),t}},e}(),C=r("w/nD"),I=r("JBkQ"),j=r("7kKV"),P=r("AqA3");!function(e){e.success="success",e.invalid="invalid"}(i||(i={}));var T,x,E=r("m8A1"),F=r("BvBP"),w=r("c56u"),N=r("JlqV"),A=r("kvLG"),k=r("sOTk"),M=r("b1hT"),D=r("l9h5"),R=r("Z1aD"),L=r("xc1f"),B=function(){function e(e,t,r,n,a){this._clientApiExecutor=new u.a(e,"ClientApi.XrmProcessControlData.",r,t);var i=this._clientApiExecutor.getComponentName("constructor");r||Object(m.j)(i,"pageId"),n||Object(m.j)(i,"entity"),t||Object(m.j)(i,"contextToken"),e||Object(m.j)(i,"store"),T=e,this._pageId=r,this._entity=n;var s=!1;Object(E.d)(T.getState(),this._pageId,i,!0)&&(this._processManager=a,s=!0),this._contextToken=t;var c=n.getEntityReference();this._entityRef=new p.a(c.entityType,o.a.tryParseOrNull(c.id),c.name);var l=Object(E.b)(r,e.getState(),s);A.a.getInstance().eventManager.ReportComponentSuccess(i,l)}return e.prototype.getActiveProcess=function(){var e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcess(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new O(T,t,!0,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var a=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.setStatus=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setStatus";try{if(b.a.instance.reportCall(n),!Object(E.d)(T.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void b.a.instance.reportSuccess(n);var a;if(e===I.a.active)a=d.a.Active;else if(e===I.a.finished)a=d.a.Finished;else{if(e!==I.a.aborted)return void b.a.instance.reportSuccess(n);a=d.a.Aborted}this._getProcessManager().setStatus(a).then((function(){r._callback(t,e,n),b.a.instance.reportSuccess(n)})).catch((function(t){var a=f.a.getInstance().getEventParameters(r._contextToken);return a.push({name:"newStatus",value:e}),Object(m.d)(T,t,n,a)}))}catch(e){var i=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessControlData.getStatus";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return b.a.instance.reportSuccess(e),t}catch(t){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getInstanceName=function(){var e="ClientApi.XrmProcessControlData.getInstanceName";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceName();if(!t){var r=Object(h.e)(T.getState(),this._entityRef);t=Object(g.c)(T.getState(),r)}return b.a.instance.reportSuccess(e),t}catch(t){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getInstanceId=function(){var e="ClientApi.XrmProcessControlData.getInstanceId";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceId(),r=t?o.a.toString(t):null;return b.a.instance.reportSuccess(e),r}catch(t){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getProcessInstances=function(e){var t=this,r="ClientApi.XrmProcessControlData.getProcessInstances";try{if(b.a.instance.reportCall(r),!Object(E.d)(T.getState(),this._pageId,r)||Object(M.g)(T.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then((function(n){if(n&&n.value&&n.value.length>0){var a={};n.value.forEach((function(e){e.businessprocessflowinstanceid&&(a[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:t._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})})),Object(l.c)(r,[],(function(){e(a)}))}b.a.instance.reportSuccess(r)})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(T,e,r+".getProcessInstances",n)}))}catch(e){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.setActiveProcess=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcess",(function(n,a){var s=o.a.tryParseOrNull(e),c=Object(k.m)(T.getState(),r._pageId);if(s&&o.a.equals(s,o.a.EMPTY)){if(c){var l=new p.a(r._entity.getEntityName(),o.a.EMPTY);return T.dispatch(Object(D.b)(!0,l)),A.a.getInstance().eventManager.ReportComponentSuccess(n,a),Promise.resolve().then((function(){return r._callback(t,i.success,n,a),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}return Promise.resolve().then((function(){return r._callback(t,i.invalid,n,a),Promise.resolve()}))}if(!Object(E.d)(T.getState(),r._pageId,n,!0)||Object(M.g)(T.getState()))return Promise.resolve();return(c?Promise.resolve():r._getProcessManager().setActiveProcess(e)).then((function(){r._callback(t,i.success,n,a);var o=r.getActiveProcess();return o&&o.getId().toUpperCase()===e.toUpperCase()||r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.setActiveProcessInstance=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcessInstance",(function(n,a){return!Object(E.d)(T.getState(),r._pageId,n)||Object(M.g)(T.getState())?Promise.resolve():r._getProcessManager().setActiveProcessInstance(e).then((function(o){return r._callback(t,i.success,n,a),r.getInstanceId()!==e&&r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),o,e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.getEnabledProcesses=function(e){var t=this,r="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(b.a.instance.reportCall(r),!Object(E.d)(T.getState(),this._pageId,r,!0))return void b.a.instance.reportSuccess(r);var n=T.getState();if(Object(F.g)(n)&&Object(w.w)(n)&&!Object(N.b)(n)){var a={};return void("function"==typeof e&&Object(l.c)(r,[],(function(){e(a)})))}this._getProcessManager().getEnabledProcesses().then((function(t){var n={};t&&t.length>0&&t.forEach((function(e){n[e.workflowId]=e.name})),"function"==typeof e&&Object(l.c)(r,[],(function(){e(n)})),b.a.instance.reportSuccess(r)})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(T,e,r+".getEnabledProcesses",n)}))}catch(e){var i=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(r,e,null,i),e}},e.prototype.switchProcess=function(){var e="ClientApi.XrmProcessControlData.switchProcess";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e)||Object(M.g)(T.getState()))return;this._getProcessManager().switchProcess(),b.a.instance.reportSuccess(e)}catch(r){var t=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.abandonProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.abandonProcess";try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=f.a.getInstance().getEventParameters(e._contextToken);return Object(m.d)(T,r,t+".abandonProcess",n)}))}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reactivateProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=f.a.getInstance().getEventParameters(e._contextToken);return Object(m.d)(T,r,t+".reactivateProcess",n)}))}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.completeProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.completeProcess";try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=f.a.getInstance().getEventParameters(e._contextToken);return Object(m.d)(T,r,t+".completeProcess",n)}))}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getActiveStage=function(){var e="ClientApi.XrmProcessControlData.getActiveStage";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getActiveStage(),r=null;return t&&(r=new S(T,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),b.a.instance.reportSuccess(e),r}catch(t){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getActivePath=function(){var e=this,t="ClientApi.XrmProcessControlData.getActivePath";try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return b.a.instance.reportSuccess(t),null;var r=this._getProcessManager().getActivePathStages(),n=null;if(r){var a=this._getProcessManager().getActiveStageId(),i=new y.a(t);r.forEach((function(t){var r=t.get_parent().get_EntityLogicalName();i.add(t.get_stageId(),new S(T,t,r,a,e._getProcessManager()))})),n=i}return b.a.instance.reportSuccess(t),n}catch(e){var o=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,o),e}},e.prototype.setActiveStage=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setActiveStage";try{if(b.a.instance.reportCall(n),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(n),this._callback(t,j.a.dirtyForm,n);else{if(!Object(E.d)(T.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then((function(){r._callback(t,r._getStageInvalidReason(null),n),r._loadActiveStageEntity(n),b.a.instance.reportSuccess(n)})).catch((function(e){r._callback(t,e?r._getStageInvalidReason(e):P.a.invalid,n)}))}}catch(e){var a=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.moveNext=function(e){var t=this,r="ClientApi.XrmProcessControlData.moveNext";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(E.d)(T.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(this._getProcessManager().isCrossEntityNavigation(!0))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToNextStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),b.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,a,r),a===j.a.invalid){var i=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(T,n,r+".moveToNextStage",i)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.movePrevious=function(e){var t=this,r="ClientApi.XrmProcessControlData.movePrevious";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(E.d)(T.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(Object(M.g)(T.getState())&&this._getProcessManager().isCrossEntityNavigation(!1))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToPreviousStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),t._loadActiveStageEntity(r),b.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,a,r),a===j.a.invalid){var i=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(T,n,r+".moveToPreviousStage",i)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.getSelectedStage=function(){var e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(b.a.instance.reportCall(e),!Object(E.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getSelectedStage(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new S(T,t,this._getProcessManager().getCurrentFormEntity().etn,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var a=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.addOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.q)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(m.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.j)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.L)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(m.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.E)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.r)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.M)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.k)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(m.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.i)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(m.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.F)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(m.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(E.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.D)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getStageInvalidReason=function(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success},e.prototype._getNavigationStatus=function(e){return e?e.navigationStatus||j.a.invalid:j.a.success},e.prototype._convertToXrmProcessInstanceStatus=function(e){if(e){if(e===d.a.Active)return I.a.active;if(e===d.a.Finished)return I.a.finished;if(e===d.a.Aborted)return I.a.aborted}return null},e.prototype._callback=function(e,t,r,n){var a=r+".Callback";n||(n=f.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(l.c)(a,n,(function(){"function"==typeof e&&e(t)}))},e.prototype._reloadPage=function(e,t,r,n){if(t){var a=Object(k.m)(T.getState(),this._pageId),i={entityTypeName:t.etn,id:a?void 0:t.id,processId:r,processInstanceId:n};T.dispatch(Object(R.a)(L.a,i,this._pageId,{target:"inline"})).then((function(t){if(0!==t.status)return Object(m.d)(T,t.error,e+".navigateTo.INavigationFailure")})).catch((function(t){return Object(m.d)(T,t,e+".navigateTo.")}))}},e.prototype._loadActiveStageEntity=function(e){var t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(E.c)(this._processManager,T,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager},e}(),V=r("UGbr"),G=r("TCDU"),z=r("UOiB"),W=r("/j9Z"),q=r("9qYn"),U=r("ObKm"),X=r("/lKk"),H=r("gk6Q"),K=r("vqdi"),Q=r("Gemh"),Y=function(){function e(e,t,r,n,a){this._entity=null;var i="ClientApi.XrmFormData.constructor";e||Object(m.j)(i,"store"),r||Object(m.j)(i,"pageId"),t||Object(m.j)(i,"contextToken"),n||Object(m.j)(i,"formContext"),x=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=a}return Object.defineProperty(e.prototype,"entity",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"process",{get:function(){var e="ClientApi.XrmFormData.process_get";try{var t=Object(M.f)(x.getState());b.a.instance.reportCall(e);var r=!!this._process;if((!t&&!this._process||t)&&this._entity){var n=Object(k.g)(x.getState(),this._pageId),a=Object(H.b)(this._pageId,n);this._entity&&(this._process=new B(x,this._contextToken,this._pageId,this.entity,a))}b.a.instance.reportSuccess(e);var i=Object(E.a)(this._pageId,x.getState(),r,!!this._entity);return A.a.getInstance().eventManager.ReportComponentSuccess(e,i),this._process}catch(t){var o=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,o),t}},set:function(e){var t=Object(E.a)(this._pageId,x.getState(),!!this._process,!!this._entity);A.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e},enumerable:!1,configurable:!0}),e.prototype.getEntity=function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity},e.prototype.getIsDirty=function(){var e,t,r,n="ClientApi.XrmFormData.getIsDirty";try{b.a.instance.reportCall(n);var a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(var i=0;i<this.attributes.getLength();i++){var o=this.attributes.get(i);if("never"!==o.getSubmitMode()&&o.getIsDirty()){a=!0;break}}if(!a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(i=0;i<this._formContext.ui.controls.getLength();i++){var s=this._formContext.ui.controls.get(i);if("formcomponent"===s.getControlType()&&s.isLoaded()&&(null===(r=s.data)||void 0===r?void 0:r.getIsDirty())){a=!0;break}}}return b.a.instance.reportSuccess(n),a}catch(e){var c=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(n,e,null,c),e}},Object.defineProperty(e.prototype,"attributes",{get:function(){var e="ClientApi.XrmFormData.attributes";try{if(b.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new y.a(e);var t=Object(s.Oc)(x.getState(),this._pageId);if(t)for(var r in t){var n=t[r],a=r,i=Object(c.b)(x,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,n);this._unboundAttributes.add(i.getName(),i)}}return b.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){var o=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(e,t,null,o),t}},enumerable:!1,configurable:!0}),e.prototype._refreshEntity=function(e){var t=this;return this.entity.refresh().then((function(){Object(V.d)(x.dispatch,t._contextToken,t._pageId),e&&x.dispatch(Object(C.Q)(t._contextToken,t._pageId,3,t.entity)),Object(q.b)(t.entity)}))},e.prototype.refresh=function(e){var t=this,r="ClientApi.XrmFormData.refresh";try{if(b.a.instance.reportCall(r),this.entity){var n=Object(s.kb)(x.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then((function(e){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(x,e,r+".save",n)})):!n&&this.entity.getIsDirty()?x.dispatch(Object(G.a)(this._pageId)).then((function(e){if(e)return t._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(x,e,r+".handleUnsavedChanges.refreshEntity",n)}))})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(x,e,r+".handleUnsavedChanges",n)})):this._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=f.a.getInstance().getEventParameters(t._contextToken);return Object(m.d)(x,e,r+".handleUnsavedChanges.refreshEntity",n)}))}var a=new W.a("Refresh action cannot be executed since form entity is null",2147746581);return A.a.getInstance().traceManager.getTracer(r).info("Refreshing on a non entity page"),Object(m.d)(x,a,r+".entity")}catch(e){var i=f.a.getInstance().getEventParameters(this._contextToken);return Object(m.d)(x,e,r,i)}},e.prototype.save=function(e){var t=this,r="ClientApi.XrmFormData.save",n=f.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){var a=new W.a("Save action cannot be executed since form entity is null",2147746581);return Object(m.d)(x,a,r+".entity")}try{b.a.instance.reportCall(r);var i=1;return e&&e.saveMode&&(i=e.saveMode),J(this._pageId,x,i,n,this._contextToken,this.entity,!0,!0).then((function(e){if(e){var a={entityType:e.etn,id:o.a.toString(e.id),name:e.name};return Object(s.Kb)(x.getState(),t._pageId)?(b.a.instance.reportSuccess(r),{savedEntityReference:a}):t._refreshEntity(!1).then((function(){return b.a.instance.reportSuccess(r),{savedEntityReference:a}})).catch((function(e){return Object(m.d)(x,e,r+".refresh",n)}))}if(Object(s.kb)(x.getState(),{id:t._pageId},t._contextToken)||!t.entity.getIsDirty()){var i=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),{savedEntityReference:i}}var c=new W.a("Save action was not executed and the form is dirty.",2147879192);return Object(m.d)(x,c,r+".NoReference",null,!1)})).catch((function(e){if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){var a=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),Promise.resolve({savedEntityReference:a})}return Object(m.d)(x,e,r,n)}))}catch(e){return Object(m.d)(x,e,r,n)}},e.prototype.isValid=function(){var e,t,r,n="ClientApi.XrmFormData.isValid";try{b.a.instance.reportCall(n);var a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(var i=0;i<this.attributes.getLength();i++)if(!this.attributes.get(i).isValid()){a=!1;break}if(a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(var o=0;o<this._formContext.ui.controls.getLength();o++){var s=this._formContext.ui.controls.get(o);if("formcomponent"===s.getControlType()&&s.isLoaded()&&!(null===(r=s.data)||void 0===r?void 0:r.isValid())){a=!1;break}}return a||x.dispatch(Object(U.b)(this._pageId,this._contextToken)),b.a.instance.reportSuccess(n),a}catch(e){var c=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(n,e,null,c),e}},e.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormData.addOnLoad";e||Object(m.j)(t,"handler");try{b.a.instance.reportCall(t),x.dispatch(Object(C.c)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormData.removeOnLoad";e||Object(m.j)(t,"handler");try{b.a.instance.reportCall(t),x.dispatch(Object(C.x)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=f.a.getInstance().getEventParameters(this._contextToken);throw f.a.getInstance().reportFailure(t,e,null,r),e}},e}();function J(e,t,r,n,a,i,c,l){var u=t.getState(),p=o.a.tryParseOrNull(i.getId());if(a.contextTokenType===z.a.GridRow){var d=[],h=Object(Q.T)(u,e,a.parentContextToken,a.parentContextToken.controlName);return i.attributes.forEach((function(e){return d.push(e.getName())})),n.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(K.a)(e,i.getEntityName(),null==p?void 0:p.guid,null,d,null==h?void 0:h.guid,!1,a.parentContextToken))}if(Object(s.Kb)(u,e))return n.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(X.a)(e));if(p&&!o.a.equals(p,o.a.EMPTY))return n.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(V.e)(e,r));var g=Object(k.l)(t.getState(),e);return n.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(V.f)(e,g,l,r,!1,c))}},"Wye+":function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("Gemh"),a=r("Nhrb");var i=r("/j9Z"),o=r("9r0m"),s=r("G7N+"),c=r("olrR"),l=r("RlP9"),u=r("r2h9"),p=r("8Fmj"),d=r("cqI9"),h=r("7dGM"),g=r("lMVv"),f=r("JlqV"),m=r("z9yS"),b=r("uO/V"),v=r("Yc9S"),y=r("0rak");var _=r("zETL"),S=r("3IUl"),O=r("bc+P"),C=r("xm8q"),I=r("okRr"),j=r("U/bH"),P=r("cZkS"),T=r("qC0c"),x=r("VcAV");function E(e,t,r,E,w,N){return{type:"grid.refresh.async",execute:function(A,k){var M=A.dispatch,D=A.getState,R=k.TraceManager.getTracer(b.z),L=b.x+".refreshGridAction";try{var B=D(),V=o.a.tryParseOrNull(E);if(V){var G=N||(r?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,r,a,p,d,h,g){var m=Object(n.qb)(t,g,r);if(m&&m.initialized===s.a.Initialized&&(Object(f.b)(t)||!Object(x.b)(m.offlineSqlQuery)))return Promise.resolve(g);var b=d||Object(n.F)(t,r,a,p),v=Object(l.f)(t,b,h),y=Object(l.f)(t,b,u.a.MAIN_APPLICATION_VIEW),_=v&&v[o.a.toString(g)]&&v[o.a.toString(g)].isUserView?u.b.userview:u.b.savedview;y&&y[o.a.toString(g)]&&y[o.a.toString(g)].isUserView&&(_=u.b.userview);return e(Object(c.a)(b,h,_,g)).then((function(e){if(!e)throw new i.a("View retrieval failed");return e}))}(M,B,e,t,r,w,G,V).then((function(i){R.info("Refreshing the grid with new view id - {0}"+V);var c=Object(n.T)(B,e,t);M(function(e,t,r,n){return Object(a.b)(e,t,"ViewId",r,n)}(e,r,E,t)),function(e,t,r,a,i,c,u,p,d){var h=function(e,t,r,a,i){return e||Object(n.F)(t,r,a,i)}(r,e,i,c,u),g=Object(n.qb)(e,a,i);if(g&&g.initialized===s.a.Initialized){var f=Object(l.f)(e,h,p),m=f&&f[o.a.toString(a)]&&f[o.a.toString(a)].isUserView;if(h===b.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){var v=[];v.push({name:"view.title",value:"View title doesn't contains value"}),v.push({name:"ViewId",value:"ViewId: "+a}),v.push({name:"View",value:F(g)}),v.push({name:"entityTypeName",value:h}),d.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",v)}var y={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:a,IsUserView:m,Title:g.title};t(Object(C.b)(y))}}(D(),M,w,i,e,t,r,G,k),Object(T.c)(D(),P.L)&&M(Object(j.b)(e,t)),w&&M(function(e,t,r,n){return Object(a.b)(e,t,"TargetEntityType",r,n)}(e,r,w,t)),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(O.b)(e,t,null));var x=[];if(w&&x.push({name:"entityName",value:w}),!Object(n.ib)(B,e,t))return k.EventManager.ReportComponentSuccess(L,x),Promise.resolve();M(function(e,t,r,a,i,s){return{type:"chart.refresh.async",execute:function(c,_){var S=c.dispatch,O=c.getState,C=b.x+".refreshChartAction",I=O();if(!r)return Promise.resolve();if(!Object(f.b)(I))return Promise.resolve();var j=Object(l.c)(I,r);if(!(i=j&&j.entityLogicalName?j.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(S(Object(y.c)(e,t,[])),S(Object(v.c)(e,t,"{}"))),!o.a.equals(a,r)){S(Object(y.c)(e,t,[])),S(Object(v.c)(e,t,"{}"));var P=Object(n.r)(I,e,t,i),T=Object(h.a)(I,P),x=T&&T.PrimaryEntityTypeCode,E=x&&Object(g.m)(I,parseInt(x,10));if(E&&i!==E)return S(Object(p.a)(i,m.a.savedvisualization)).then((function(r){var n=o.a.toString(r);return n||(n=o.a.EMPTYGUIDSTRING),S(Object(d.b)(e,t,n)).then((function(){_.EventManager.ReportComponentSuccess(C)}))}))}return _.EventManager.ReportComponentSuccess(C),Promise.resolve()}}}(e,t,V,c,w,N)).then((function(){return M(Object(_.b)(e,t)),k.EventManager.ReportComponentSuccess(L,x),Promise.resolve()})).catch((function(e){return k.EventManager.ReportComponentFailure(L,Error(e)),Promise.resolve()}))}))}if(Object(n.v)(D(),e,t)){R.info("Refreshing the grid."),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(O.b)(e,t,null));var z=[];w&&z.push({name:"entityName",value:w}),k.EventManager.ReportComponentSuccess(L,z)}return Promise.resolve()}catch(e){var W="Refresh action for grid failed";e&&e.message&&(W+="with the error message as : "+e.message),k.EventManager.ReportComponentFailure(L,Error(W))}}}}function F(e){if(!e)return"View is "+e;var t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},XJ3n:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,a=r("fW82"),i=r("9r0m"),o=r("+Z9T"),s=r("BWVO"),c=r("WVwd"),l=r("/zIU"),u=r("GueY"),p=r("Gemh"),d=r("IiPO"),h=r("mPpC"),g=r("ks02"),f=r("FoZz"),m=r("sOTk"),b=r("gLMt"),v=r("ezfI"),y=function(){function e(e,t,r,a,i,s){var c="ClientApi.XrmGridRow.constructor";e||Object(o.j)(c,"store"),a||Object(o.j)(c,"pageId"),r||Object(o.j)(c,"contextToken"),i||Object(o.j)(c,"entityType"),s||Object(o.j)(c,"entityId"),n=e,this._applicationContext=t,this._pageId=a,this._contextToken=r,this._entityType=i,this._entityId=s}return Object.defineProperty(e.prototype,"applicationContext",{get:function(){return v.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e="ClientApi.XrmGridRow.context";try{return v.a.instance.reportCall(e),this._globalContext||(this._globalContext=new g.a(n,this._pageId)),v.a.instance.reportSuccess(e),this._globalContext}catch(r){var t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,r,null,t),r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var e=this,t="ClientApi.XrmGridRow.data";try{if(v.a.instance.reportCall(t),!this._data){var r=new s.a(n,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new c.a(n,this._contextToken,this._pageId,this,r);var a=new h.b(n,this._pageId),o=[],l={isEventParam:!0,name:"attributeName",value:""};o.push(l),r.attributes.forEach((function(r){var n=r.getName();l.value=n;var s={Id:n,Label:null,Name:n,ShowLabel:!1,Visible:!0,ClassId:new i.a(h.a),Disabled:!1,DataFieldName:n},c=a.createXrmControl(e._contextToken,s,e,t,o);c&&r.controls.add(c.getName(),c)}))}return v.a.instance.reportSuccess(t),this._data}catch(e){var u=d.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,u),e}},enumerable:!1,configurable:!0}),e.prototype.getData=function(){try{return v.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){var e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}},Object.defineProperty(e.prototype,"ui",{get:function(){try{if(v.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){var e=new h.b(n,this._pageId);this._ui=new u.a(n,this._contextToken,this._pageId,this,this._entityType,e)}return v.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){var t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t="ClientApi.XrmGridRow.getControl";try{v.a.instance.reportCall(t);var r=this.ui.controls.get(e);return v.a.instance.reportSuccess(t),r}catch(e){var n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getAttribute=function(e){var t="ClientApi.XrmGridRow.getAttribute";try{if(v.a.instance.reportCall(t),this.data.entity){var r=this.data.entity.attributes.get(e);return v.a.instance.reportSuccess(t),r}return v.a.instance.reportSuccess(t),null}catch(e){var n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridRow.getUrl";try{v.a.instance.reportCall(t);var r=this.data.entity.getEntityReference();this._internal=new f.a(n,this._applicationContext,this.context,this._pageId);var o=Object(m.g)(n.getState(),this._pageId),s={entityTypeName:r.entityType,etn:r.name,id:i.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:o.recordSetQueryKey};if(1===e){var c=n.dispatch(Object(a.a)(l.a.EditForm,s));return v.a.instance.reportSuccess(t),c}var u=Object(b.a)(n,this._pageId),p=n.dispatch(Object(a.c)(u,l.a.EditForm,s));return v.a.instance.reportSuccess(t),p}catch(e){var h=d.a.getInstance().getEventParameters(this._contextToken);throw h.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,h),e}},Object.defineProperty(e.prototype,"entityReference",{get:function(){try{return this.data.entity.getEntityReference()}catch(t){var e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}},enumerable:!1,configurable:!0}),e}();function _(e,t,r){var a=Object(p.D)(n.getState(),{id:r},t.parentContextToken);return a||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},XjtF:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a,i,o=r("EGsq"),s=r("cL6R"),c=r("KVkm"),l=r("WACO"),u=r("JlqV"),p=["JQUERY","JQUERY.JS"];function d(e){return{type:"customcontrol.loadresources",execute:function(t,r){var d=t.dispatch,h=t.getState,g=[],f=h(),m=Object(o.t)(f),b=e.Properties.Resources.filter((function(e,t,n){return(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==p.indexOf(e.LibraryName.toUpperCase())||r.AssetLoader.isResourceLoaded(m+e.Name))})).sort((function(e,t){return e.LoadOrder-t.LoadOrder})),v=e.Properties.Resources.filter((function(e,t,r){return 5===e.Type}));if(b.length>0){var y=void 0,_=function(){return function(e,t,r,a,i){for(var o=[],s=0;s<i.length;s++){var l=i[s],u=void 0,p=l.Name,d=r;if(n&&n[l.Name])d=window.__public_path__+"control",p=n[l.Name];else if(0===l.Type){var h=l.LibraryName+".js";n&&n[h]&&(d=window.__public_path__+"control",p=n[h])}switch(l.Type){case 0:case 4:u=a.loadWebResource(p,d,3,(function(t){return e(Object(c.a)(t))}),t,!1);break;case 1:u=u=a.loadWebResource(p,d,2,(function(t){return e(Object(c.a)(t))}),t);break;default:u=null}u&&o.push(u)}return Promise.all(o)}(d,!Object(u.b)(f),m,r.AssetLoader,b)};(y=!function(){null==i&&(i=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return i}()||n?_():function(){if(a)return a;if("/uclient/"!==window.__public_path__){if(!n){var e=window.__public_path__+"controlFileMap.json";(a=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise((function(t){var r=new XMLHttpRequest;r.addEventListener("load",(function(){var e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",(function(){t({})})),r.open("GET",e),r.send()})):fetch(e).then((function(e){return e.json()}),(function(){return Promise.resolve({})}))).then((function(e){n=e}),(function(){n={}}))}}else n={},a=Promise.resolve({});return a}().then(_,_))&&g.push(y)}for(var S=Object(l.k)(f),O=function(e){if(!S||!S.hasOwnProperty(v[e].Name)){var t=d(Object(s.c)(v[e].Name)).then((function(t){for(var r=!1,n=0,a=t;n<a.length;n++){var i=a[n];i&&i.webResourceDescriptorsByName&&i.webResourceDescriptorsByName.hasOwnProperty(v[e].Name)&&(r=!0)}!r&&d(Object(s.b)(v[e].Name))}));g.push(t)}},C=0;C<v.length;C++)O(C);return g.length>0?Promise.all(g):null},sync:!0}}},"Y+r4":function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,a,i=r("c/eZ"),o=r("1z64"),s=r("fW82"),c=r("sOTk"),l=r("BWVO"),u=r("WVwd"),p=r("ezfI"),d=r("/zIU"),h=r("GueY"),g=r("HSdq"),f=r("3NtJ"),m=r("fTYK"),b=r("+Z9T"),v=r("IiPO"),y=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(i.__extends)(t,e),t.prototype.getDefaultNextPageName=function(){var e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{p.a.instance.reportCall(e);var t=Object(g.M)(n.getState(),this.pageId,this.contextToken);return p.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.movePrevious=function(){var e="ClientApi.XrmNavigableFormUi.movePrevious";try{p.a.instance.reportCall(e),n.dispatch(Object(m.b)(this.pageId,this.contextToken)),p.a.instance.reportSuccess(e)}catch(r){var t=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.moveTo=function(e){var t,r="ClientApi.XrmNavigableFormUi.moveTo";try{if(p.a.instance.reportCall(r),e&&this.tabs){var a=Object(g.Gc)(n.getState(),this.pageId,e,this.contextToken);(t=this.tabs.get(null==a?void 0:a.Name))&&n.dispatch(Object(f.b)(this.pageId,this.contextToken,null==a?void 0:a.Id))}p.a.instance.reportSuccess(r)}catch(e){var i=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(r,e,null,i),e}t||Object(b.h)(r,"pageName",e)},Object.defineProperty(t.prototype,"taskProcess",{get:function(){return p.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this},enumerable:!1,configurable:!0}),t}(h.a),_=r("9r0m"),S=r("FoZz"),O=r("gLMt"),C=r("ZOZo"),I=r("WS0f"),j=function(e){function t(t,r,n,i,s){var c=this,l=[{name:"pageId",value:s,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return(c=e.call(this,t,r&&r.etn,i,s,(function(e){return 10===e||12===e?y:h.a}),n)||this)._clientApiExecutorForm=new o.a(t,"ClientApi.XrmForm.",s,i,l),a=t,c._entityReference=r,c}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"applicationContext",{get:function(){return this._applicationContext},set:function(e){this._applicationContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){try{return p.a.instance.reportCall("ClientApi.XrmForm.context"),p.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}},set:function(e){this._globalContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){var e=this;return this._clientApiExecutorForm.execute("entityReference_get",(function(){return{id:_.a.externalGuid(e._entityReference.id),entityType:e._entityReference.etn}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){try{if(p.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){var e=void 0,t=Object(c.l)(a.getState(),this.pageId);t!==d.a.Dialog&&t!==d.a.ModalDialog&&this._entityReference&&(e=new l.a(a,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,P,this._applicationContext)),this._data=new u.a(a,this.contextToken,this.pageId,this,e)}return p.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}},enumerable:!1,configurable:!0}),t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutorForm.execute("getAttribute",(function(){var r,n,a=null;return t.data&&t.data.entity&&(a=t.data.entity.attributes.get(e)),a?Object(I.a)(e)&&(a=a.concat(t.data.attributes.get(e))):a=null===(n=null===(r=t.data)||void 0===r?void 0:r.attributes)||void 0===n?void 0:n.get(e),a}))},t.prototype.getUrl=function(e){try{p.a.instance.reportCall("ClientApi.XrmForm.getUrl");var t=null,r=null;if(this.contextToken.parentContextToken){var n=this.data.entity.getEntityReference(),i={entityTypeName:n.entityType,etn:n.name,id:_.a.fromExternalGuid(n.id)};t=d.a.EditForm,r=i}else t=Object(c.l)(a.getState(),this.pageId),r=Object(c.g)(a.getState(),this.pageId);switch(t){case d.a.EditForm:var o=new S.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:o.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break;case d.a.Grid:o=new S.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:o.getEntityCode(r.entityTypeName)}}var l=null;if(1===e)l=a.dispatch(Object(s.a)(t,r));else{var u=Object(O.a)(a,this.pageId);l=a.dispatch(Object(s.c)(u,t,r))}return p.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),l}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}},t.prototype._reportFailure=function(e,t){var r=v.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),v.a.getInstance().reportFailure(e,t,null,r),t},t}(C.a);function P(e,t,r){var n=Object(g.bb)(a.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},YOvo:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.visibility";function a(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},Yc9S:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,r){return{type:"chart.filterexpression.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".updateFilterExpressionAction";try{p.info("Updating the chart filter expression"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var g="Updatation of the chart filter expression failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},YdIa:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.targets.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},ZOZo:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a=r("h82J"),i=r("HSdq"),o=r("1z64"),s=function(){function e(e,t,r,i,s,c){this._clientApiExecutor=new o.a(e,"ClientApi.XrmFormBase.",i,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),n=e,this.pageId=i,this.contextToken=r,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,n.dispatch(Object(a.a)(this,i,r))}return Object.defineProperty(e.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ui_get",(function(){if(!e._ui){var t={id:e.pageId},r=Object(i.fb)(n.getState(),t,e.contextToken),a=r&&r.FormType,o=e._getUiType(a);e._ui=new o(n,e.contextToken,e.pageId,e,e._entityName,e._xrmControlFactory)}return e._ui}))},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t=this,r=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",(function(){return t.ui.controls.get(e)}),r)},e}()},Zdrd:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationtype.update";function o(e,t,r){return{type:"chart.visualizationtype.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(a.z),p=a.x+".updateVisualizationTypeAction";try{u.info("Update the chart visualization type"),t||(t=Object(n.k)(l(),e));var d=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,d,r)),s.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Update the chart visualization type failed with error : "+e.message;s.EventManager.ReportComponentFailure(p,Error(h))}}}}},aBa1:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("c/eZ"),a=r("AhDg"),i=r("9r0m"),o=r("lMVv"),s=r("gBKR"),c=r("7pqb"),l=r("t8f4"),u=r("r0s4"),p=c.b.AdvancedFindLookupResolverParameters;function d(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.async",execute:function(u,d,h){var f=u.dispatch,m=u.getState,b=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:p.PrimaryEntity,value:e},{name:p.Targets,value:t.join(",")});var v=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return f(Object(s.e)(v)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:p.EntityMetadataUnavailable,value:i}),a;var c='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or"><condition attribute="'+s.PrimaryNameAttribute+'" operator="like" value="%'+(t||"")+'%" /></filter></entity></fetch>',l=g(e,s,c,n);return a.push(l),a}}(f,r,m(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function h(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute:function(u,d,h){var f=u.dispatch,m=u.getState,b=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:p.PrimaryEntity,value:e},{name:p.Targets,value:t.join(",")});var v=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return f(Object(s.e)(v)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:p.EntityMetadataUnavailable,value:i}),a;var c=t.filter((function(e){return!!e})).map((function(e){return'<condition attribute="'+s.PrimaryIdAttribute+'" operator="eq" value="'+e+'" />'})),l='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or">'+c+"</filter></entity></fetch>",u=g(e,s,l,n);return a.push(u),a}}(f,r,m(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function g(e,t,r,n){var a="?fetchXml="+Object(u.CrmUrlEncode)(r);return new Promise((function(r,i){e(Object(l.e)(t.EntityLogicalName,a,100)).then((function(e){var a=function(e,t){var r=[];t.value&&t.value.length>0&&t.value.forEach((function(t){r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})}));return r}(t,e);n.push({name:p.RetrieveRequestSuccess,value:"Retrieve Seccuess for "+t.EntityLogicalName+" Count: "+a.length}),r(a)}),(function(e){n.push({name:p.RetrieveRequestFail,value:"Failed to retrieve records for "+t.EntityLogicalName+" Error: "+e}),r([])}))}))}},bCrZ:function(e,t,r){"use strict";r.d(t,"f",(function(){return f})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return v}));var n=r("c/eZ"),a=r("9r0m"),i=r("Sscr"),o=r("uO/V"),s=r("nn4v"),c=r("Gemh"),l=r("cZkS"),u=r("qC0c"),p=r("U/bH"),d=r("jigW"),h="grid.initialize",g="grid.initialize.xrmready";function f(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute:function(n,a){var i=n.dispatch,s=(n.getState,o.x+".gridPreInitializedAction");try{i(b(null,e,t,r,void 0,void 0,void 0,void 0,null));var c=[{name:"entityTypeName",value:e}];return a.EventManager.ReportComponentSuccess(s,c),Promise.resolve(void 0)}catch(t){var l="Failed for "+e+" with error "+t.message;return a.EventManager.ReportComponentFailure(s,Error(l)),Promise.resolve(void 0)}}}}function m(e,t,r,a,i,d,h,g,f){return e?{type:"grid.initialize.async",execute:function(m,v){var y=m.dispatch,_=m.getState,S=o.x+".gridInitializedAction";try{var O=null;Object(u.c)(_(),l.zb)&&(O=function(e,t,r){var a=Object(c.v)(e,t,r),i=Object(n.__assign)({},s.a);return a&&(a.filters&&(i.filters=a.filters),a.customFilter&&(i.customFilter=a.customFilter),a.pageNumber&&(i.pageNumber=a.pageNumber),a.pagingRefreshInput&&(i.pagingRefreshInput=a.pagingRefreshInput)),i}(_(),r,a)),y(b(e,t,r,a,i,d,h,g,O,f));var C=[];return C.push({name:"entityTypeName",value:t}),v.EventManager.ReportComponentSuccess(S,C),Object(u.c)(_(),l.L)&&y(Object(p.b)(r,a)),Promise.resolve(void 0)}catch(e){var I="Grid initialized failed for entity type "+t;return v.EventManager.ReportComponentFailure(S,Error(I)),Promise.reject(void 0)}}}:null}function b(e,t,r,c,l,u,p,g,f,m){var b=l&&l.Parameters?l.Parameters[o.j]:null;try{var v=!0;b&&(v="true"===b);var y=Object(i.u)(c),_={contextKey:y,initialDataSetState:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},s.a),f),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:u,relationshipRoleOrdinal:p,useRollupView:g||!1,commandManagerId:m||Object(d.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:e&&e.viewId?a.a.toString(e.viewId):null},1:{Name:o.j,Value:v},2:{Name:o.u,Value:t}}}}})};return{type:h,payload:_,meta:{pageId:r,contextKey:y}}}catch(e){throw Error(e)}}function v(e,t,r,c){var l=Object(i.u)(c),u=a.a.tryParseOrNull(t),p={contextKey:l,initialDataSetState:Object(n.__assign)(Object(n.__assign)({},s.a),{viewId:u||null,fetchXml:null,commandManagerId:Object(d.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:t||null},1:{Name:o.j,Value:!1},2:{Name:o.u,Value:e}}}}})};return{type:h,payload:p,meta:{pageId:r,contextKey:l}}}function y(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},bH46:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("9r0m"),a=r("vYfn"),i=r("i8/j"),o=r("F2uj"),s=r("gBKR"),c=r("VWqI"),l=r("j6Db"),u=r("+Xnp"),p=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function d(e,t,r){return{type:"formandattribute.retrieve.async",execute:function(c,u){var d=c.dispatch,f=c.getState,m="Card"===r;return e.etn&&"activitypointer"===e.etn&&m?d(Object(s.f)("activitypointer",!1,p)).then((function(){for(var t=f(),r={},n=0,a=p;n<a.length;n++){var i=a[n],s=Object(o.a)(t,e.etn,i);s&&h(t,e.etn,i,s)&&(r[i]=s)}return g(t,e.etn,r,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}})):d(Object(a.b)(e,t,r)).then((function(a){var c={},p=null;return e.etn?d(Object(s.f)(e.etn,!0,[])).then((function(){var t=f();if(!n.a.isNullOrEmpty(a)&&(p=Object(i.j)(t,a))&&p.Attributes)for(var r in p.Attributes){var s=p.Attributes[r],l=Object(o.a)(t,e.etn,s);l&&h(t,e.etn,s,l)&&(c[s]=l)}return m&&g(t,e.etn,c,Object(o.d)(t,e.etn)),{formDescriptor:p,attributeDescriptors:c}})):(u.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)}),(function(e){var a=e.get_message();u.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])}))}}}function h(e,t,r,n){return Object(c.f)(e,t,r,u.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(var a in n){var i=n[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||r[a]||!h(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(r[a]=i)}}},bJYk:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r("9r0m"),a=r("sOTk"),i=r("Z1aD"),o=r("KQ+A"),s=r("t8f4"),c=r("QAhb"),l=r("lMVv"),u=r("WS0f"),p=r("riBC"),d=r("7EJx"),h=r("JlqV"),g=r("HSdq"),f=r("YEEA");function m(e,t,r,c){var m=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute:function(v,y,_){var S=v.dispatch,O=v.getState,C=O();if(Object(g.Eb)(C,t))return Promise.reject(Object(f.b)(C,t,2200000016));var I=Object(a.g)(C,t),j=I.entityTypeName,P=I.id,T=I.recordSetQueryKey,x=I.data,E=I.createFromRelationship,F=I.initWithEntity;m.push({name:"entityTypeName",value:j});var w=n.a.tryParse(e),N={entityTypeName:j,formId:w,id:c?n.a.tryParse(c):P,recordSetQueryKey:T,data:x,createFromRelationship:E,initWithEntity:F},A=w.guid.toString(),k='<MRUForm><Form Type="Main" Id="'+A+'" /></MRUForm>',M=Object(p.c)(C,j);return S(Object(i.a)(r,N,t,{replaceState:!0})).then((function(e){var t,r;if(0===e.status)if(Object(h.b)(O()))null==M||M===n.a.EMPTY?function(e,t,r,a,i,c,p,h){var g=Object(l.p)(a,e),f=Object(d.q)(a),m="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",v=String.format(m,g.toString(),f.guid.toString());i(Object(s.e)("userentityuisettings",v)).then((function(d){d.value&&d.value.length>0&&(r=d.value[0].userentityuisettingsid?new n.a(d.value[0].userentityuisettingsid):n.a.EMPTY),Object(u.a)(r)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,a,i,c,p){var d=n.a.EMPTY,h=Object(l.p)(r,e),g="userentityuisettings";a(Object(s.b)(g,{objecttypecode:h,lastviewedformxml:t})).then((function(t){if(d=t,!(Object(u.a)(d)||Object(u.a)(i)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(d))){var r=p.TraceManager.getTracer("Forms.FormSelectorChange"),s="Created an entry for selected form successfully formid : "+i;r.info(s),a(Object(o.b)(e,i,d))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(i)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,i,d)),{};var r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+i;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),p.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)}))}(e,t,a,i,c,p,h):b(e,t,r,a,i,c,p,h)})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,c,r)),{};var n=[{name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}(j,k,M,O(),S,w,_,y):b(j,k,M,O(),S,w,_,y);else{Object(u.a)(w)||Object(u.a)(j)||0===j.length||S(Object(o.b)(j,w,M));var a=null===(t=null==y?void 0:y.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),i="Selected form did not save in the UserEntityUiSetting table, for formid: "+w;null==a||a.info(i)}else if(1===e.status){a=null===(r=null==y?void 0:y.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),i="Could not change to form with id "+A+" due to a navigation failure or because navigation was cancelled";null==a||a.info(i,m)}return e}))},getFailureParameters:function(e,t){return m}}}function b(e,t,r,a,i,l,p,d){var h=new c.a("userentityuisettings",r);i(Object(s.f)(h,{lastviewedformxml:t})).then((function(){if(!(Object(u.a)(r)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){var t=d.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+l;t.info(a),i(Object(o.b)(e,l,r))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,l,r)),{};var n=[{name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+l;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}},"bhC+":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setSelectedFormId";function a(e,t){return{type:n,payload:{formId:t},meta:{pageId:e}}}},c0jI:function(e,t,r){"use strict";r.d(t,"g",(function(){return _})),r.d(t,"i",(function(){return S})),r.d(t,"h",(function(){return O})),r.d(t,"e",(function(){return C})),r.d(t,"f",(function(){return I})),r.d(t,"a",(function(){return j})),r.d(t,"c",(function(){return T})),r.d(t,"b",(function(){return E})),r.d(t,"d",(function(){return P}));var n=r("c/eZ"),a=r("uO/V"),i=r("Gemh"),o=r("sOTk");function s(e,t,r,n){var a,i;return{type:"update.grid.configuration",payload:((a={})[t]=((i={})[r]=e,i),a),meta:{pageId:n}}}function c(e,t,r){var n;return{type:"update.views.configuration",payload:((n={})[t]=e,n),meta:{pageId:r}}}var l=r("RXRQ"),u=r("U0B9"),p=r("2OIc"),d=r("i8/j"),h=r("9r0m"),g=r("RlP9"),f=r("S2mk"),m=r("T2Xs"),b=r("j6Db"),v=r("OTOS");function y(e,t){var r=Object(n.__assign)({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){var a=!1;for(var i in e.CustomControls)if(j(e.CustomControls[i],e.CustomControls[t])&&i!==t.toString()){a=!0;break}if(!a){var o=-1;r[o]?o--:r[o.toString()]=e.CustomControls[t]}}return r[t]=null,r}function _(e,t,r,a,p){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(d,h){var g,f,v=d.dispatch,y=d.getState,_=y(),S=Object(u.b)(_),O=Object(i.k)(_,e,t),C={UniqueId:O?O.UniqueId:null,CustomControls:(g={},g[S]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:S}),g),FormLibraries:O?O.FormLibraries:null,EventHandlers:O?O.EventHandlers:null},I=Object(o.g)(_,e).entityTypeName;if(p){var j=Object(i.T)(_,e,t);v(c({UniqueId:null,CustomControls:(f={},f[S]=null,f),FormLibraries:null,EventHandlers:null},j.guid,e))}v(Object(l.c)(r.CustomControlId)).then((function(){v(s(C,I,a,e))}),(function(t){var n=Object(m.b)(y(),r.CustomControlId);h.EventManager.ReportComponentFailure(n+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:I},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:a},{name:"config",value:JSON.stringify(r)}])}))}}}function S(e,t,r,a,p){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(d){var h,f=d.dispatch,m=(0,d.getState)(),b=Object(u.b)(m),v=Object(i.T)(m,e,t),_=Object(g.d)(m,v),S={UniqueId:_?_.UniqueId:null,CustomControls:(h={},h[b]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:b}),h),FormLibraries:_?_.FormLibraries:null,EventHandlers:_?_.EventHandlers:null},O=Object(o.g)(m,e).entityTypeName;if(p){var C=Object(i.k)(m,e,t);if(C&&C.CustomControls&&C.CustomControls[b]){var I={UniqueId:C.UniqueId,CustomControls:y(C,b),FormLibraries:C.FormLibraries,EventHandlers:C.EventHandlers};f(s(I,O,a,e))}}f(Object(l.c)(r.CustomControlId)).then((function(){f(c(S,v.guid,e))}))}}}function O(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute:function(a){var i,o=a.dispatch,c=(0,a.getState)(),h=Object(u.b)(c),g=Object(v.b)(c,e),f=Object(d.b)(c,e,g,r),m=Object(p.b)(c,f.UniqueId,g);if(m&&m.CustomControls){var b={UniqueId:f.UniqueId,CustomControls:(i={},i[h]=Object(n.__assign)(Object(n.__assign)({},t),{FormFactor:h}),i),FormLibraries:m.FormLibraries,EventHandlers:m.EventHandlers};o(Object(l.c)(t.CustomControlId)).then((function(){o(s(b,g.guid,m.UniqueId,e))}))}}}}function C(e,t,r,a,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute:function(o){var c,p=o.dispatch,d=(0,o.getState)(),h=Object(u.b)(d),g={UniqueId:i.UniqueId,CustomControls:(c={},c[h]=Object(n.__assign)(Object(n.__assign)({},a),{FormFactor:h}),c),FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};p(Object(l.c)(a.CustomControlId)).then((function(){p(s(g,t,r,e))}))}}}function I(e,t,r,a,i,o,p){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute:function(d){var h,g=d.dispatch,f=(0,d.getState)(),m=Object(u.b)(f),b={UniqueId:o.UniqueId,CustomControls:(h={},h[m]=Object(n.__assign)(Object(n.__assign)({},i),{FormFactor:m}),h),FormLibraries:o.FormLibraries,EventHandlers:o.EventHandlers};if(p&&p.CustomControls&&p.CustomControls[m]){var v={UniqueId:p.UniqueId,CustomControls:y(p,m),FormLibraries:p.FormLibraries,EventHandlers:p.EventHandlers};g(s(v,t,r,e))}g(Object(l.c)(i.CustomControlId)).then((function(){g(c(b,a.guid,e))}))}}}function j(e,t){if(e&&t){var r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,a;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(var i in t)if(t[i]!==r[i]){if("function"==typeof t[i])continue;if(t[i]&&r[i]&&"object"==typeof t[i]&&"object"==typeof r[i]){if(e(t[i],r[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(n=t[i])||void 0===n?void 0:n.toString())===(null===(a=r[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(var n in e.Children)r=r&&j(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function P(e,t,r,n,a,i,o,s){var c=t?t.TraceManager.getTracer("customcontrol"):null;return e(T(r,n,i.configuration,i,i.contextString,s).map((function(e){return e.configuration.DisplayNameKey}))).catch((function(e){return c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()}))}function T(e,t,r,n,i,o){var s=[];if(null==o)return s;if(i===a.h.CUSTOM&&n.configuration.isDefaultConfig)return s;var c=i===a.h.GRID||i===a.h.ASSOCIATEDGRID?Object(f.u)(n&&n.controlId,n&&n.gridEntityTypeName,n&&h.a.toString(n.viewId)):Object(f.x)(n&&n.controlId,n&&n.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&x(s,e,"GRID_CONFIG"),t&&t.CustomControls&&x(s,t,"VIEW_CONFIG"),s}function x(e,t,r){for(var n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){for(var a=!1,i=0;i<e.length;i++)if(j(e[i].configuration,t.CustomControls[n])){a=!0;break}a||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function E(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},cQE4:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.cb)(e,t,r);return a?a.footer:null}},cm3g:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){this._value=null,this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}()},cqI9:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationid.update";function o(e,t,r){return{type:"chart.visualizationid.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(a.z),p=a.x+".updateVisualizationIdAction";try{u.info("Updating the chart visualization id"),t||(t=Object(n.k)(l(),e));var d=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,d,r)),s.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Updatation of the chart visualization id failed with error : "+e.message;s.EventManager.ReportComponentFailure(p,Error(h))}}}}},"d26+":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("jigW"),i=r("uO/V"),o="dataset.update.fetchxml";function s(e,t,r){return{type:"dataset.update.fetchxml.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,c.TraceManager.getTracer(i.z)),p=i.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),l(function(e,t,r){var a=Object(n.y)(t),i=Object(n.v)(t);return{type:o,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:i}}}(e,t,r));var d=Object(a.j)(r),h=[];return h.push({name:"fetchXML",value:d}),c.EventManager.ReportComponentSuccess(p,h),Promise.resolve()}catch(e){var g="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},dWLV:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a=r("c/eZ"),i=r("ASFs"),o=r("nIt0"),s=Object(i.d)(((n={})[o.a]=function(e,t){return Object(a.__assign)({},t.payload.formlessControlOutputs)},n),{})},e2rP:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.commandbarvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},enCe:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ShowHeaderFieldsInSection.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{showHeaderFieldsInSection:r},meta:{pageId:e,contextKey:i}}}},"fH/t":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Grid_Paging_Mask",a="Grid_StatusMessage_Mask",i="Grid_ItemsSelected_Mask",o="Grid_TotalCount_Mask",s="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",p="Grid_TotalCount_Approximate",d="Grid_TotalCount_Exact",h=[n,a,i,o,s,c,l,u,p,d]},fTYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.tab.selectPrevious";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var r=Object(n.v)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:r}}}},g24L:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("jJRu"),a=r("aGOT"),i=r("Cfob");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return void 0===e&&(e=null),t.type===n.a?t.payload.snapshotId:t.type===i.a?t.payload:t.type===a.a?null:e}},gRWC:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="formSelector.visible";function a(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},grpZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("9r0m"),a=r("uQP8"),i=r("sOTk"),o=r("i8/j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r){var n;void 0===r&&(r=!1);var s=Object(i.g)(e,t).entityTypeName,c=Object(o.n)(e,s);if(!r)return c;var l=Object(a.a)(e,t),u=null===(n=null==l?void 0:l.formSelector)||void 0===n?void 0:n.forms,p=c;if(u&&Object.keys(u).length>0)for(var d in p=new Object,c)u[d]&&!u[d].visible||(p[d]=c[d]);return p}function c(e,t,r){var s,c,l=Object(a.a)(e,t),u=n.a.toString(r);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;var p=Object(i.g)(e,t).entityTypeName;return!!Object(o.m)(e,p,r)||null}function l(e,t){var r,n=Object(a.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},hE7j:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.setSrc";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},hurf:function(e,t,r){"use strict";r.r(t),r.d(t,"BarNotificationList",(function(){return x}));var n=r("c/eZ"),a=r("nuS9"),i=r("4fxQ"),o=r("4E+q"),s=r("lU69"),c=r("wV3W"),l=r("aPRd"),u=r("zt+H");var p=r("Ww2r"),d=r("Ro59"),h=r("zPLw"),g=r("gvL4"),f=r("H/hG"),m=r("YWpA"),b=r("Wi7Z"),v=r("1AYO"),y=r("9rQ4"),_=r("B73A"),S=r("akzq"),O=r("+spQ"),C=r("XIN1"),I=r("znb3"),j=r("IF6v"),P=Object(s.a)(),T=function(e){function t(t){var r=e.call(this,t)||this;return r._flyoutOutsideClickHandler=r._flyoutOutsideClickHandler.bind(r),r._notificationKeyDownHandler=r._notificationKeyDownHandler.bind(r),r._onNotificationItemDidMount=r._onNotificationItemDidMount.bind(r),r._toggleFlyout=r._toggleFlyout.bind(r),r._notificationRef=r._notificationRef.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.state={isNotificationFlyoutOpened:!1,focusedIndex:-1,isNotificationRendered:!1},r._previousHeaderCollapsed=t.headerCollapsed,r}return Object(n.__extends)(t,e),t.prototype._toggleFlyout=function(){this._updateFlyoutWidth(),this.state.isNotificationFlyoutOpened?this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!1})):this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:!this.state.isNotificationFlyoutOpened}))},t.prototype._notificationsCountMessage=function(){var e=Object(p.c)(this.props.resourceStrings,d.a);return e=e.replace("{0}",String(this.props.notificationList.length))},t.prototype._updateFlyoutWidth=function(){var e=i.findDOMNode(this.refs.notificationWrapper);e&&(this._clientWidth=e.clientWidth)},t.prototype._createKeyboardShortcuts=function(){var e="Notification Flyout "+this.props.component,t=this._shortcutHandler.bind(this),r=this._shiftTabShortcutHandler.bind(this),n=[],a=new _.a([y.a.Escape],t,!0,e,"Close Notification Flyout"),i=new _.a([y.a.Enter],t,!1,e,"Open Notification Flyout",this._getWrapperId()),o=new _.a([y.a.UpArrow],t,!0,e,"Move Up on Notifiation Flyout"),s=new _.a([y.a.DownArrow],t,!0,e,"Move Down on Notifiation Flyout"),c=new _.a([y.a.Tab],t,!0,e,"Tab on the Notification Flyout"),l=new _.a([y.a.Shift,y.a.Tab],r,!0,e,"Shift Tab on the Notification Flyout");return n.push(a),n.push(i),n.push(o),n.push(s),n.push(c),n.push(l),n},t.prototype._shiftTabShortcutHandler=function(e){var t=e.EVENT;this.state.isNotificationFlyoutOpened&&(t.preventDefault(),t.stopPropagation())},t.prototype._shortcutHandler=function(e){var t=e.EVENT;if(t.keyCode===y.a.Enter)this.state.isNotificationFlyoutOpened||this._toggleFlyout();else if(t.keyCode===y.a.DownArrow&&this.state.focusedIndex>-1){var r=(this.state.focusedIndex+1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(r)}else if(t.keyCode===y.a.UpArrow&&this.state.focusedIndex>-1){r=(this.state.focusedIndex-1+this.props.notificationList.length)%this.props.notificationList.length;this._moveFocus(r)}else t.keyCode===y.a.Tab&&this.state.isNotificationFlyoutOpened&&t.preventDefault()},t.prototype._moveFocus=function(e){var t=i.findDOMNode(this._notificationItemsList).childNodes[e];t&&(t.tabIndex=0,t.focus(),this.setState({focusedIndex:e}))},t.prototype._notificationRef=function(e){this._notificationItemsList=e},t.prototype._onNotificationItemDidMount=function(){-1===this.state.focusedIndex&&this.state.isNotificationFlyoutOpened&&this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationRendered:!0}))},t.prototype._renderNotificationList=function(e){var t=this;if(e&&e.length){var r=1===e.length,n=e.map((function(e,n){return a.createElement(j.a,{key:e.UniqueId,id:t.props.id,domWidth:t.props.domWidth,notification:e,notificationType:e.Level,shouldNotifyRenderComplete:!0,onRenderComplete:t._onNotificationItemDidMount,displayFullMessage:t.props.displayFullMessage,keyDownHandler:t._notificationKeyDownHandler,notificationWidth:t._clientWidth,onlyNotification:r,buttonMeasuringCallback:t.props.buttonMeasuringCallback,toggleFlyout:t._toggleFlyout})}));return a.createElement(g.a,{testhooks:{id:"notificationList"},ref:this._notificationRef,style:this.props.formNotificationListStyle,role:r?b.r:void 0},n)}},t.prototype._flyoutOutsideClickHandler=function(e){if(e&&e.target){var t=e.target.id;t!==this._getWrapperId()&&t!==this._getWrapperId()+"_icon"&&t!==this._getWrapperId()+"_message"&&t!==this._getWrapperId()+"_expandIcon"&&"notificationIcon"!==t&&t!==O.a&&this._toggleFlyout()}},t.prototype._notificationKeyDownHandler=function(e){if(this.state.isNotificationFlyoutOpened&&e&&e.keyCode&&e.keyCode===y.a.Escape){this._toggleFlyout(),e.stopPropagation();var t=i.findDOMNode(this.refs.notificationWrapper);t&&t.focus()}},t.prototype._getWrapperId=function(){return"notificationWrapper"+this.props.id},t.prototype._getMessageIcon=function(e){switch(e){case h.a:return I.a.MarkAsLost;case h.e:return I.a.Warning;case h.d:return I.a.SuccessIcon;default:return I.a.InformationIcon}},t.prototype.onMeasuring=function(e){var t=i.findDOMNode(this.refs.notificationWrapper);if(t){var r=t.clientWidth,a=t.clientHeight;this._clientWidth!==r&&this.state.isNotificationFlyoutOpened&&(this._updateFlyoutWidth(),this.setState(Object(n.__assign)(Object(n.__assign)({},this.state),{isNotificationFlyoutOpened:this.state.isNotificationFlyoutOpened,focusedIndex:-1,isNotificationRendered:!0}))),this._clientHeight!==a&&(this.props.buttonMeasuringCallback&&this.props.buttonMeasuringCallback(r,a),this._clientHeight=t.clientHeight)}},t.prototype.componentWillReceiveProps=function(e){this.state.isNotificationFlyoutOpened&&this._previousHeaderCollapsed!==e.headerCollapsed&&this._toggleFlyout()},t.prototype.render=function(){return a.createElement(m.a,{key:"barnotificationlistAccessibility",id:"barnotificationlistAccessibility_"+Object(s.a)()},this._renderBarNotifications())},t.prototype._renderBarNotifications=function(){var e=this;if(this.props.notificationList.length>0){if(1===this.props.notificationList.length){var t=this._renderNotificationList(this.props.notificationList);return a.createElement(m.a,{ref:"notificationWrapper",style:Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationWrapperStyle),this.props.customStyle),testhooks:{id:"notificationWrapper"}},a.createElement(S.a,{keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!0}),t)}var r=void 0;if(this.state.isNotificationFlyoutOpened){t=this._renderNotificationList(this.props.notificationList);r=a.createElement(v.a,{key:P,id:P,flyoutDirection:v.b.down,relativeToElementId:this._getWrapperId(),enforceDirection:!0,positionType:"relative",flyoutStyle:this.props.formNotificationFlyoutStyle,size:{width:this._clientWidth||500},onOutsideClick:this._flyoutOutsideClickHandler,testhooks:{id:"notificationFlyout"}},t)}else r=void 0;return this.props.setFormNotificationHeight&&this.props.setFormNotificationHeight(u.a),a.createElement(m.a,{isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:Object(n.__assign)(Object(n.__assign)({},this.props.formNotificationWrapperStyle),this.props.customStyle),role:b.a},a.createElement(m.a,{ref:"notificationWrapper",style:this.props.formNotificationStyle,onClick:function(){return e._toggleFlyout()},role:b.d,controlsElementId:P,notificationType:"assertive",testhooks:{id:"notificationWrapper"},id:this._getWrapperId(),tabIndex:0,accessibilityExpanded:this.state.isNotificationFlyoutOpened},a.createElement(S.a,{key:"flyoutAccessibility",rootElementId:this._getWrapperId(),keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),a.createElement(f.a,{id:this._getWrapperId()+"_icon",style:this.props.notificationList.some((function(e){return e.Level===h.a}))?this.props.notificationIconWrapperStyle:this.props.notificationNoErrorIconWrapperStyle},a.createElement(C.b,{style:this.props.notificationIconStyle,id:"notificationIcon",type:this._getMessageIcon(this.props.mostSevereLevel),testhooks:{id:"formNotificationIcon"}})),a.createElement(f.a,{id:this._getWrapperId()+"_message",announceAccessibilityNotification:!0,ownsElementId:this.state.isNotificationFlyoutOpened?P:void 0,style:this.props.notificationList.some((function(e){return e.Level===h.a}))?this.props.alertTextStyle:this.props.alertNoErrorTextStyle},this._notificationsCountMessage()),a.createElement(f.a,{id:this._getWrapperId()+"_expandIcon",style:this.props.notificationExpandIconWrapperStyle},a.createElement(C.b,{style:this.props.notificationExpandIconStyle,id:O.a,type:this.state.isNotificationFlyoutOpened?I.a.ChevronUp:I.a.ChevronDown,testhooks:{id:{NOTIFICATION_EXPAND_ICON_ID:O.a}}})),r))}return null},t.prototype.componentDidUpdate=function(){-1===this.state.focusedIndex&&this._notificationItemsList&&this.state.isNotificationFlyoutOpened&&this.state.isNotificationRendered&&this._moveFocus(0),this._previousHeaderCollapsed=this.props.headerCollapsed},t.prototype.componentDidMount=function(){this._previousHeaderCollapsed=this.props.headerCollapsed},t}(a.Component);T.displayName="BarNotificationList";var x=Object(o.a)((function(){var e,t,r,a,i,o=(e=null,t=null,r=null,a=null,i=null,function(n,o,s){var p=Object(c.a)(n),d=Object(l.b)(n),h=Object(l.c)(n);if(r!==p||a!==d||i!==h||t!==s){r=p,a=d,i=h,t=s;var g=Object(u.d)(s);e={formNotificationWrapperStyle:{display:"flex",width:"100%",boxSizing:"border-box",minHeight:u.a+"px",maxHeight:"100%",marginTop:p.sizes.Measures.Measure100},formNotificationStyle:{display:"flex",backgroundColor:g,flex:"1 1 auto",cursor:"pointer",boxSizing:"border-box"},formNotificationFlyoutStyle:{left:"15px",display:"flex",flexDirection:"column",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.12), 0px 6.4px 7.2px rgba(0, 0, 0, 0.1)"},formNotificationListStyle:{overflowY:"hidden",listStyleType:"none",width:"100%",display:"inline"},notificationIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px"},notificationNoErrorIconWrapperStyle:{textAlign:"center",backgroundColor:"transparent",borderBottom:"1px solid transparent",height:"20px",paddingLeft:"10px",paddingRight:"10px",paddingTop:"6px",color:"#797673"},notificationIconStyle:{height:"20px",width:"20px",fontSize:"20px",color:Object(u.e)(s)},alertTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:p.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},alertNoErrorTextStyle:{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"12px",fontFamily:p.fontFamilies.Regular,color:"#1F2126",marginTop:"7px",lineHeight:"16px"},notificationExpandIconWrapperStyle:{paddingTop:"9px",paddingRight:"10px",paddingLeft:"10px",textAlign:"center",backgroundColor:"transparent"},notificationExpandIconStyle:{height:"16px",width:"16px",fontSize:"16px",color:"#1F2126"}}}return e}),s=Object(p.h)();return function(e,t){var r=function(e){var t=h.b;if(!e||0===e.length)return t;for(var r=[h.a,h.e,h.b,h.d],n=e.map((function(e){return e.Level})),a=0,i=r;a<i.length;a++){var o=i[a];if(n.indexOf(o)>=0)return o}return t}(t.notificationList),a=o(e,t,r),i=s(e,d.f);return Object(n.__assign)(Object(n.__assign)({},a),{mostSevereLevel:r,resourceStrings:i})}}))(T)},i6iy:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return m}));var n=r("cZkS"),a=r("9r0m"),i=r("Gemh"),o=r("qC0c"),s=r("Wye+"),c=r("UOiB"),l=r("olrR"),u=r("RlP9"),p=r("r2h9"),d=r("uO/V"),h=r("19Zc"),g=r("jigW");function f(e,t,r,f){return{type:"grid.quickfind.apply.async",execute:function(m,b){var v=m.dispatch,y=m.getState,_=b.TraceManager.getTracer(d.z),S=d.x+".QuickFilterAction";try{var O=y(),C=Object(i.F)(O,t,r,f);return function(e,t,r){return new Promise((function(n){var a=Object(u.a)(e,r,p.a.QUICKFIND_SEARCH);a?n(a):t(Object(l.a)(r,p.a.QUICKFIND_SEARCH,p.b.savedview)).then((function(e){n(e)}))}))}(O,v,C).then((function(l){_.info("Performing quick find on the grid ");var u=Object(i.T)(O,t,r,f),d=u,m=r.contextTokenType===c.a.SubGrid,C=!1;if(m&&r.controlName){var I=Object(i.hb)(y(),t,r,r.controlName);I&&(C=I.EnableViewPicker)}return Object(o.a)(y(),n.Nd)&&m&&!C||Object(g.l)(O)||(d=l),v(Object(h.n)(e,t,r)),v(Object(s.a)(t,r,f,a.a.toString(d),null,p.a.QUICKFIND_SEARCH)).then((function(){return b.EventManager.ReportComponentSuccess(S),u}))}))}catch(e){b.EventManager.ReportComponentFailure(S,Error("Unable to perform a quick find on the grid"))}}}}function m(e,t,r,n){return{type:"grid.quickfind.clear.async",execute:function(i,o){var c=i.dispatch,l=(i.getState,o.TraceManager.getTracer(d.z)),u=d.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),c(Object(h.n)("",t,r)),c(Object(s.a)(t,r,n,a.a.toString(e))).then((function(){o.EventManager.ReportComponentSuccess(u)}))}catch(e){o.EventManager.ReportComponentFailure(u,Error("Unable to clear quick find value for grid"))}}}}},ig6i:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}return Object.defineProperty(e.prototype,"etn",{get:function(){return this._etn},set:function(e){this._etn=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},set:function(e){this._attributeName=e},enumerable:!1,configurable:!0}),e}()},ixd0:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a=r("9r0m"),i=r("IiPO"),o=r("sOTk"),s=r("+Z9T"),c=r("ezfI"),l=r("bJYk"),u=r("gRWC"),p=r("grpZ"),d=function(){function e(e,t,r,a){this._id=e,this._label=t,n=r,this._pageId=a}return e.prototype.getId=function(){var e="ClientApi.XrmFormSelectorItem.getId";try{c.a.instance.reportCall(e);var t=a.a.toString(this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.getLabel=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label},e.prototype.getPageId=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId},e.prototype.setVisible=function(e){var t="ClientApi.XrmFormSelectorItem.setVisible";try{c.a.instance.reportCall(t),n.dispatch(Object(u.b)(this._pageId,a.a.toString(this._id),e)),c.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}},e.prototype.getVisible=function(){var e="ClientApi.XrmFormSelectorItem.getVisible";try{c.a.instance.reportCall(e);var t=Object(p.c)(n.getState(),this._pageId,this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.navigate=function(){var e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),c.a.instance.reportCall(e);var t=Object(o.g)(n.getState(),this._pageId),r=t&&t.id?t.id.guid:"",a=Object(o.l)(n.getState(),this._pageId);n.dispatch(Object(l.a)(this._id.guid,this._pageId,a,r)).then((function(){c.a.instance.reportSuccess(e)})).catch((function(t){return Object(s.d)(n,t,e+".changeForm")}))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e}()},jWor:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.defaultvalues";function a(e,t,r){return{type:n,payload:{allNavBarByRelationshipItems:t,currentLanguageId:r},meta:{pageId:e}}}},ksD2:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("Sscr"),a=r("HSdq"),i=r("s0Zj"),o=r("ar+e"),s=r("B188"),c=r("4sax"),l=r("7pqb"),u=r("KzM6"),p="tab.visible";function d(e,t,r,d){return{type:"tab.visible.sync",sync:!0,execute:function(h,g){var f,m=h.dispatch,b=h.getState,v=b();m(function(e,t,r,a){var i=Object(n.v)(r);return{type:p,payload:a,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,r,d));var y=Object(a.wc)(v,{id:e},r),_=Object(o.e)(v,{id:e},r);if(y||(null==_?void 0:_.isSelected)||!d){if(y===t&&!d){var S=Object(a.fb)(v,{id:e},r),O=!1;if(S)for(var C=0,I=Object(a.m)(v,S);C<I.length;C++){var j=I[C];if(j.Id!==t&&Object(a.Kc)(v,j.Id,e,r)){O=!0,m(Object(i.b)(e,j.Id,r));break}}O||m(Object(i.b)(e,void 0,r))}}else m(Object(i.b)(e,t,r));if(Object(s.a)()){var P=b(),T=null===(f=null==g?void 0:g.TraceManager)||void 0===f?void 0:f.getTracer(""+l.k+l.r),x=Object(a.Kc)(v,t,e,r),E=Object(a.Kc)(P,t,e,r),F=Object(u.a)(P,e);F.push({name:"tabId",value:t}),F.push({name:"tabName",value:Object(a.Ic)(P,t,e,r)}),F.push({name:"tabLabel",value:Object(a.Hc)(P,t,e,r)}),F.push({name:"visible state before change",value:null==x?void 0:x.toString()}),F.push({name:"visible state after change",value:null==E?void 0:E.toString()}),F.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==T||T.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(F)}])}}}}},l2WT:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r("c/eZ"),a=r("nuS9"),i=r("HSdq"),o=r("4E+q"),s=r("hurf"),c=r("Sscr");function l(e,t,r){var n=[{name:"controlId",value:r}];return{type:"onClick.FormNotificationAction.sync",sync:!0,execute:function(a,i,o){var s=a.dispatch;a.getState;(n.push({name:"CorrelationId",value:o.correlationId},{name:"ContextId",value:o.contextId},{name:"ActionStack",value:o.stack}),r)?(s(i.ScriptManager.getContainer(t).getEventManager().runOnClick(e,r)),i.EventManager.ReportComponentSuccess("Forms.FormNotificationButtonOnClickAction",n)):i.TraceManager.getTracer("Forms.FormNotificationButtonOnClickAction").warn("Null/undefined controlId.",n)},getFailureParameters:function(e,t){return n}}}var u=r("K1ho"),p=r("qC0c"),d=r("cZkS"),h=r("zPLw"),g=r("Ww2r"),f=r("Ro59"),m=r("5aNC"),b=r("yotr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){return a.createElement(s.BarNotificationList,Object(n.__assign)({},e))}function y(e,t,r,n){if(e)return e.map((function(e,a){var i=Object(m.b)(n,a+"");return{Label:e.Label,Handler:l(t,r,i)}}))}function _(e,t,r,n){if(e)return e.map((function(e,a){var i=Object(b.b)(n,a+"");return{Label:e.Label,Handler:l(t,r,i)}}))}function S(e,t,r,n,a){return!t.ControlName&&r&&t.Level!==h.c&&n?(e||"")+" "+function(e){return Object(g.b)(e,f.d)}(a):e}function O(e){return{type:"set.focus.on.notification",execute:function(t,r){var n=t.dispatch,a=t.getState;if(e.ControlName){var i=[{name:"NotificationId",value:e.UniqueId}],o=Object(c.j)(a(),e.ComponentId);return n(Object(u.a)(e.ComponentId,o,e.ControlName)).then((function(){r.EventManager.ReportComponentSuccess("Forms.SetFocusAction.entered",i)}))}}}}v.displayName="FormNotificationList";var C=Object(o.a)((function(){var e={},t=[],r=Object(i.Zc)();return function(a,o){var s=r(a,o.id);return e!==s&&(t=function(e,t,r){var a=[];if(e)for(var o=Object(p.a)(r,d.ob),s=Object(c.j)(r,t),l=Object(i.zb)(r,t,s),u=0,h=Object.keys(e);u<h.length;u++){var g=e[h[u]],f=g.UniqueId in l,m=Object(n.__assign)(Object(n.__assign)({},g),{Buttons:y(g.Buttons,s,t,g.UniqueId),MessagePlaceholders:_(g.MessagePlaceholders,s,t,g.UniqueId),Message:S(g.Message,g,f,o,r),OnNotificationClick:g.ControlName&&o&&O(g)});a.push(m)}return a}(s,o.id,a),e=s),{notificationList:t}}}))(v)},lFQy:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("9r0m"),a=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){var r,i={dataById:(r={},r[n.a.toString(t.id)]=e,r)};return{type:a.a,payload:i}}},ll2N:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n,a=r("c/eZ"),i=r("1z64"),o=r("FlW1"),s=r("HSdq"),c=r("Zy0S"),l=r("+Z9T"),u=r("JCHT"),p=r("OmYs"),d=r("IiPO"),h=r("ezfI"),g=r("kvLG"),f=function(e){function t(t,r,a,o,s,c){var l=e.call(this,t,r,a,o)||this;return l._parent=s,n=t,l._formContext=c,l._iConnectedSectionProp={sectionName:l.name,id:l.pageId},l._clientApiExecutorTabSection=new i.a(t,"ClientApi.XrmTabSection.",a,r),l.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),l}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorTabSection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){var e=this;return this.clientApiExecutor.execute("controls",(function(t,r){if(!e._controls){var a=n.getState();e._controls=new c.a(t);var i=e.getControlsDescriptor(a);if(!i)return e._controls;for(var o in i){var s=e._formContext.ui.controls.get(o);if(s)e._controls.add(s.getName(),s);else{var l=r.slice();l.push({name:"controlKey",value:o}),g.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",l)}}}return e._controls}))},enumerable:!1,configurable:!0}),t.prototype.getParent=function(){return h.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent},t.prototype.getVisible=function(){var e="ClientApi.XrmTabSection.getVisible";try{h.a.instance.reportCall(e);var t=Object(s.tc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Visible:t;return h.a.instance.reportSuccess(e),r}catch(t){var a=d.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.getLabel=function(){var e="ClientApi.XrmTabSection.getLabel";try{h.a.instance.reportCall(e);var t=Object(s.rc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return h.a.instance.reportSuccess(e),r}catch(t){var a=d.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._getSectionDescriptorValues=function(){try{return Object(s.qc)(n.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){var e=d.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}},t.prototype.getControlsDescriptor=function(e){try{return Object(s.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTabSection.setVisible";try{h.a.instance.reportCall(t),n.dispatch(Object(u.b)(this.pageId,this.contextToken,this.name,!0===e)),h.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTabSection.setLabel";Object(l.a)(e)&&Object(l.j)(t,"label");try{h.a.instance.reportCall(t),n.dispatch(Object(p.b)(this.pageId,this.contextToken,this.name,e)),h.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(t,e,null,r),e}},t}(o.a)},lwSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.tabnavigatorvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},m8A1:function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("HSdq"),a=r("sOTk"),i=r("gk6Q"),o=r("kvLG"),s=r("b1hT"),c=r("QAhb"),l=r("j+yI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,r,i){if(void 0===i&&(i=!1),!e)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;var u=function(e,t){var r=Object(a.g)(e,t);if(!r)return null;var n=r.entityTypeName,i=r.id;return new c.a(n,i)}(e,t),p=!Object(n.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(i||!Object(l.d)(e,u,t)),d=g(t,e);return d.push({name:"xrmProcessControlClientApiIsSupported",value:p}),o.a.getInstance().eventManager.ReportComponentSuccess(r,d),p}function p(e,t,r,n){if(!e&&(o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),u(t.getState(),r,n))){o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));var s=Object(a.g)(t.getState(),r);return Object(i.b)(r,s)}return e}function d(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function h(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)}]}},mPpC:function(e,t,r){"use strict";r.d(t,"b",(function(){return Ee})),r.d(t,"a",(function(){return xe}));var n,a,i,o,s,c,l,u,p,d,h,g=r("+l2M"),f=r("sOTk"),m=r("c/eZ"),b=r("YCDx"),v=r("HSdq"),y=r("x6Ak"),_=r("IiPO"),S=r("ezfI"),O=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(m.__extends)(t,e),t.prototype.refresh=function(){var e="ClientApi.XrmControlTimer.refresh";try{S.a.instance.reportCall(e),n.dispatch(Object(y.b)(this.pageId,this.contextToken,this.name)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getState=function(){var e="ClientApi.XrmControlTimer.getState";try{S.a.instance.reportCall(e);var t=Object(v.cb)(n.getState(),this.pageId,this.contextToken).controls[this.getName()].parameters.timerState;return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"},t}(b.a),C=r("Zz0a"),I=r("w/nD"),j=r("+Z9T"),P=r("gk6Q"),T=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c.registerObserversForControlStateChange(),c}return Object(m.__extends)(t,e),t.prototype.addOnClick=function(e){var t="ClientApi.XrmControlButton.addOnClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),a.dispatch(Object(I.b)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnClick=function(e){var t="ClientApi.XrmControlButton.removeOnClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),a.dispatch(Object(I.w)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(P.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t}(b.a),x=r("1z64"),E=r("hE7j"),F=r("EGsq"),w=r("WACO"),N=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;i=t;var l=[{name:"controlName",value:o,isEventParam:!0}];return c._clientApiExecutorWebResource=new x.a(t,"ClientApi.XrmControlWebResource.",n,r,l),c}return Object(m.__extends)(t,e),t.prototype.getSrc=function(){var e=this;return this._clientApiExecutorWebResource.execute("getSrc",(function(){var t=i.getState(),r=Object(F.t)(t)+Object(v.wb)(t,{controlName:e.name,id:e.pageId},e.contextToken);return Object(w.c)(t,e.pageId,e.name,e.contextToken,r)}))},t.prototype.getContentWindow=function(){var e=this;return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(function(t,r){var n=e.formContext.applicationContext.TraceManager.getTracer(t),a=function(){var t=Object(v.xb)(i.getState(),e.pageId,e.getName());if(t){var a=null;try{return"complete"===(a=t.contentWindow).document.readyState?Promise.resolve(a):(r.push({name:"readyState",value:a.document.readyState}),n.info("Frame content window not ready",r),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(e){return a?(r.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",r),Promise.resolve(a)):Promise.reject(e)}}else n.info("Frame DOM element not ready",r);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then((function(e){return Promise.resolve(e)})).catch((function(t){if(111!==t.errorCode)return Promise.reject(t);var o=e.contextToken,s=e.pageId,c=e.getName();return new Promise((function(e,t){var l=function(){Object(I.G)(o,s,l,c),a().then((function(t){e(t)})).catch((function(a){a.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",r),e(a.contentWindow)):t&&(111===a.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",r),t(new Error("Frame element could not be found."))):t(a))}))};i.dispatch(Object(I.l)(o,s,l,c))}))}))}))},t.prototype.getObject=function(){var e=this;return this._clientApiExecutorWebResource.execute("getObject",(function(){return Object(v.xb)(i.getState(),e.pageId,e.name)}))},t.prototype.setSrc=function(e){var t=this;return this._clientApiExecutorWebResource.execute("getControlType",(function(){Object(j.a)(e)||i.dispatch(Object(E.b)(t.pageId,t.name,t.contextToken,e))}))},t.prototype.getControlType=function(){return this._clientApiExecutorWebResource.execute("getControlType",(function(){return"webresource"}))},t.prototype.addOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",(function(){i.dispatch(Object(I.l)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t.prototype.removeOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",(function(){i.dispatch(Object(I.G)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t}(b.a),A=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(m.__extends)(t,e),t.prototype.getInitialUrl=function(){var e="ClientApi.XrmControlIFrame.getInitialUrl";try{S.a.instance.reportCall(e);var t=Object(v.sb)(o.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"},t.prototype.getSrc=function(){var e="ClientApi.XrmControlIFrame.getSrc";try{S.a.instance.reportCall(e);var t=o.getState(),r=this.getInitialUrl(),n=Object(w.c)(t,this.pageId,this.name,this.contextToken,r);return S.a.instance.reportSuccess(e),n}catch(t){var a=_.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,a),t}},t}(N),k=r("+P1Q"),M=r("Q60c"),D=r("slAZ"),R=r("AVer"),L=r("QItn"),B=r("9r0m"),V=r("YdIa"),G=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c._clientApiExecutorLookup=new x.a(t,"ClientApi.XrmControlLookup.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),c}return Object(m.__extends)(t,e),t.prototype.addCustomView=function(e,t,r,n,a,i){var o=this;this._clientApiExecutorLookup.execute("addCustomView",(function(c,l){var u=B.a.tryParseOrNull(e);u||Object(j.k)(c,"guid","viewId",l),s.dispatch(Object(R.a)(o.pageId,o.name,u,t,o.contextToken,r,n,a)),i&&o.setDefaultView(e)}),[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])},t.prototype.addCustomFilter=function(e,t){var r="ClientApi.XrmControlLookup.addCustomFilter";Object(j.a)(e)&&Object(j.j)(r,"fetchXmlFilter"),Object(j.b)(e)||Object(j.l)(r);try{S.a.instance.reportCall(r),s.dispatch(Object(D.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(r)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(r,e,null,n),e}},Object.defineProperty(t.prototype,"disableMru",{get:function(){var e="ClientApi.XrmControlLookup.getDisableMru";try{S.a.instance.reportCall(e);var t=Object(v.x)(s.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},set:function(e){var t="ClientApi.XrmControlLookup.setDisableMru";try{S.a.instance.reportCall(t),s.dispatch(Object(L.b)(s.getState(),this.pageId,this.name,this.contextToken,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},enumerable:!1,configurable:!0}),t.prototype.startCustomFilter=function(){var e="ClientApi.XrmControlLookup.startCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.endCustomFilter=function(){var e="ClientApi.XrmControlLookup.endCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getDefaultView=function(){var e=this;return this._clientApiExecutorLookup.execute("getDefaultView",(function(){var t=Object(v.O)(s.getState(),e.pageId,e.name,e.contextToken);return t?B.a.externalGuid(new B.a(t)):null}))},t.prototype.setDefaultView=function(e){var t=this;this._clientApiExecutorLookup.execute("setDefaultView",(function(r,n){var a=B.a.tryParseOrNull(e);a||Object(j.k)(r,"guid","id",n),s.dispatch(Object(M.b)(t.pageId,t.name,t.contextToken,a))}),[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])},t.prototype.addOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.g)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.addPreSearch=function(e){var t="ClientApi.XrmControlLookup.addPreSearch";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.t)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.B)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removePreSearch=function(e){var t="ClientApi.XrmControlLookup.removePreSearch";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.O)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"},t.prototype.getEntityTypes=function(){var e="ClientApi.XrmControlLookup.getEntityTypes";try{S.a.instance.reportCall(e);var t=Object(v.Ob)(s.getState(),this.pageId,this.contextToken,this._dataFieldName);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setEntityTypes=function(e){var t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(j.j)(t,"entityTypes");var r=[];try{S.a.instance.reportCall(t),e=Array.from(new Set(e));var n=Object(v.Pb)(s.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};n.forEach((function(e){a[e]=!0})),e.forEach((function(e){a[e]||r.push(e)}))}catch(e){throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t+".validation",e,null,i),e}r.length>0&&Object(j.h)(t,"entityType",r[0]);try{s.dispatch(Object(V.b)(this.pageId,this.contextToken,this._dataFieldName,e)),S.a.instance.reportSuccess(t)}catch(e){var i;throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,i),e}},Object.defineProperty(t.prototype,"_dataFieldName",{get:function(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name},enumerable:!1,configurable:!0}),t}(k.a),z=r("JFej"),W=r("Ini7"),q=r("FGem"),U=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;c=t;var l=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return s._clientApiExecutorOptionsetBase=new x.a(t,"ClientApi.XrmControlOptionSetBase.",n,r,l),s}return Object(m.__extends)(t,e),t.prototype.addOption=function(e,t){var r=this;this._clientApiExecutorOptionsetBase.execute("addOption",(function(){var n=r._options.length;Object(j.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,c.dispatch(Object(z.b)(r.pageId,r.contextToken,r.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))}),[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])},t.prototype.clearOptions=function(){var e=this;this._clientApiExecutorOptionsetBase.execute("clearOptions",(function(){c.dispatch(Object(q.b)(e.pageId,e.contextToken,e.controlDescriptor.DataFieldName))}))},t.prototype.removeOption=function(e){var t=this;return this._clientApiExecutorOptionsetBase.execute("removeOption",(function(){c.dispatch(Object(W.b)(t.pageId,t.contextToken,t.controlDescriptor.DataFieldName,e))}),[{name:"value",value:e,isRequired:!0}])},t.prototype.getOptions=function(){var e=this;return this._clientApiExecutorOptionsetBase.execute("getOptions",(function(){return e._options}))},Object.defineProperty(t.prototype,"_options",{get:function(){var e=new Array,t=Object(v.B)(c.getState(),this.pageId,this.contextToken,this.name);if(t)for(var r in t.length&&e.push({text:"",value:NaN}),t)e.push({text:t[r].Label,value:t[r].Value});return e},enumerable:!1,configurable:!0}),t}(k.a),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(m.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"},t}(U),H=r("ABRM"),K=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._isDateFormatDateTime=!1,l=t,s._clientApiExecutorDateTime=new x.a(t,"ClientApi.XrmControlDateTime.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s._clientApiExecutorDateTime.execute("constructor",(function(e,t){s._isDateFormatDateTime=s._getShowTime(e,t)}),null,!1),s}return Object(m.__extends)(t,e),t.prototype.getShowTime=function(){var e=this;return this._clientApiExecutorDateTime.execute("getShowTime",(function(t,r){return e._getShowTime(t,r)}))},t.prototype.setShowTime=function(e){var t=this;this._clientApiExecutorDateTime.execute("setShowTime",(function(r,n){if(t._getShowTime(r,n)!==e){var a=e&&t._isDateFormatDateTime?"datetime":"date";l.dispatch(Object(H.b)(t.pageId,t.contextToken,t.name,a))}}))},t.prototype._getShowTime=function(e,t){var r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format},t}(k.a),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(m.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"},t}(U),Y=r("455M"),J=r("Dlr/"),Z=r("Sscr"),$=r("7bez"),ee=r("h82J"),te=r("Gemh"),re=function(e){function t(t,r,n,a,i){var o=e.call(this,t,r,n,a,a.Name,i)||this,s=Object(Z.e)(r,a.Name);return t.dispatch(Object(ee.a)(o,n,s)),u=t,o._clientApiExecutorControlstream=new x.a(t,"ClientApi.XrmControlStream.",n,r),o}return Object(m.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorControlstream},enumerable:!1,configurable:!0}),t.prototype._getGridControls=function(){if(!this._underlyingGridControls){this._underlyingGridControls=[];var e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){var t=e.StreamObjectCollection;if(t)for(var r=t.ShowAsTiles?[!0,!1]:[!0],n=0,a=t;n<a.length;n++)for(var i=a[n],o=0,s=r;o<s.length;o++){var c=s[o],l=Object(Z.o)(this.contextToken,this.getName(),i.Id,c),p=new $.a(u,l,this.pageId,!1,3,!0,this.formContext.applicationContext,l.controlName);this._underlyingGridControls.push({contextToken:l,gridControl:p})}}}return this._underlyingGridControls},t.prototype.refresh=function(){var e=this;this.clientApiExecutor.execute("refresh",(function(){for(var t=[],r=0,n=e._getGridControls();r<n.length;r++){var a=n[r],i=a.contextToken,o=a.gridControl;if(Object(te.hb)(u.getState(),e.pageId,i,i.controlName))try{o.refresh()}catch(e){t.push(e)}}if(t.length>0){var s=Object(m.__spreadArrays)(_.a.getInstance().getEventParameters(e.contextToken),[{name:"count",value:t.length}]);Object(j.e)(e.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,s)}}))},t}(b.a),ne=r("QAhb"),ae=r("TV33"),ie=r("Y+r4"),oe=r("ks02"),se=r("uQP8"),ce=r("6JRL"),le=r("kvLG"),ue=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,a.Name,i)||this;return p=t,s._clientApiExecutor=new x.a(t,"ClientApi.XrmControlSubFormBase.",n,r,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),s._xrmControlFactory=o,s}return Object(m.__extends)(t,e),t.prototype.getParentComponent=function(){return Object(se.a)(p.getState(),this.pageId)},Object.defineProperty(t.prototype,"context",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",(function(){return e._form?e._form.context:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentFormContext",{get:function(){return this.formContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_form",{get:function(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ce.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);var e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;var t=this._getValueInternal(),r=Object(ae.d)(t);return e?(this._formInstance=p.dispatch(Object(ee.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=p.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new B.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance):(_.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),le.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null)},enumerable:!1,configurable:!0}),t.prototype._createXrmForm=function(e,t,r,n){var a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute:function(i,o){var s=new ie.a(i,{etn:r,id:n},a,e,t);s.applicationContext=o;var c=new oe.a(i,t);return s.context=c,s}}},Object.defineProperty(t.prototype,"_subFormControlContextToken",{get:function(){var e=this._getValueInternal(),t=Object(ae.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&p.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(p.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",(function(){return e._form?e._form.data:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",(function(){return e._form?e._form.ui:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){return S.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null},enumerable:!1,configurable:!0}),t.prototype.getControl=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",(function(){return t._form?t._form.getControl(e):null}))},t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",(function(){return t._form?t._form.getAttribute(e):null}))},t.prototype.getUrl=function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",(function(){return e._form?e._form.getUrl():null}))},t.prototype.refresh=function(){var e=this;this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",(function(){e.data&&e.data.refresh()}))},t.prototype._getValueInternal=function(){var e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new ne.a(e,new B.a(t)):new ne.a(e),n=Object(v.ac)(p.getState(),this._subFormInstanceId,this.contextToken);return Object(v.X)(p.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)},t}(b.a),pe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return d=t,s}return Object(m.__extends)(t,e),t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.l)(this.contextToken,this.name,this._entityType)},t.prototype.getSubFormInstanceId=function(){return this.pageId},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._tryGetSubFormInstanceId=function(){},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this.pageId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e="ClientApi.XrmControlQuickForm.isLoaded";try{S.a.instance.reportCall(e);var t=Object(v.ic)(d.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return S.a.instance.reportSuccess(e),!!t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"},t}(ue),de=function(e){function t(t,r,n,a,i,o){var s;return t||Object(j.j)("ClientApi.XrmStandardDataControl.constructor","store"),s=e.call(this,t,r,n,a,i,o)||this,h=t,s}return Object(m.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmStandardDataControl.getValue";try{S.a.instance.reportCall(e);var t=Object(v.F)(h.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.e)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(j.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.z)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.fireOnKeyPress=function(){var e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{S.a.instance.reportCall(e),h.dispatch(Object(I.R)(this.contextToken,this.pageId,this.name,this)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,r,null,t),r}},t}(k.a),he=r("1PXy"),ge=r("lRv2"),fe=r("QUnS"),me=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new x.a(t,"ClientApi.XrmControlDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(m.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"DependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"DependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"DependentOptionSet.setVisible",t)}))},t}(X),be=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new x.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(m.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setVisible",t)}))},t}(Q),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(m.__extends)(t,e),t.prototype.setDisabled=function(e){var t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";S.a.instance.reportUsage(t),Object(j.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))},t}(de),ye=r("F2uj"),_e=r("cZkS"),Se=r("qC0c"),Oe=r("2OIc"),Ce=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Ie,je,Pe=function(e){function t(t,r,n,a,i,o){var s,c,l=e.call(this,t,r,n,a,i,o)||this;return l._formInstanceId=null===(c=null===(s=l.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===c?void 0:c.formInstanceIdByControlName[l.controlDescriptor.Name],l._formComponentClientApiExecutor=new x.a(t,"ClientApi.XrmControlFormComponent.",l._formInstanceId),l._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),Ie=t,l}return Object(m.__extends)(t,e),t.prototype._tryGetSubFormInstanceId=function(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.h)(r)},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this._formInstanceId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e=this;return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",(function(){return!!Object(v.yc)(Ie.getState(),e._subFormInstanceId,e._subFormControlContextToken)}))},t.prototype.setInitializationIntent=function(e){var t=this;void 0===e&&(e="fullload"),this._formComponentClientApiExecutor.execute("setInitializationIntent",(function(r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o,s;"nothing"!==e&&"fullload"!==e&&Object(j.h)(r,e,"intent"),Ie.dispatch((n=t.pageId,a=t.name,i=t.contextToken,o=e,s=Object(Z.v)(i),{type:Ce.d,payload:o,meta:{pageId:n,controlName:a,contextKey:s}}))}),[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"},t}(ue),Te=r("HHlV"),xe="3d180de6-b456-4d90-9d5a-9899936baf44",Ee=function(){function e(e,t){this._pageId=t,je=e}return e.prototype.createXrmControl=function(e,t,r,n,a){Object(j.g)(t,n,"control");try{a.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),a.push({name:"controlName",value:t?t.Name:""}),a.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),a.push({name:"pageId",value:this._pageId});var i=Object(f.l)(je.getState(),this._pageId);a.push({name:"pageType",value:i});var o=!1,s=null,c=this._getControlType(t,r,e,n,a);switch(c){case g.i.guid:s=new T(je,e,this._pageId,t,t.Name,r);break;case Y.a.KbContent:case Y.a.KbArticle:case g.C.guid:case g.I.guid:s=new A(je,e,this._pageId,t,t.Name,r);break;case Y.a.LookupRegarding:case Y.a.LookupCustomer:case Y.a.LookupMultiEntity:case Y.a.LookupOwner:case Y.a.LookupSimple:case Y.a.LookupPartyList:case g.M.guid:case g.fb.guid:case g.S.guid:case g.l.guid:if(Object(Se.c)(je.getState(),_e.jb)){var l=Object(se.b)(je.getState(),this._pageId,e);if(Object(Oe.c)(je.getState(),t.UniqueId,l)===Te.d){s=new Pe(je,e,this._pageId,t,r,this);break}}s=new G(je,e,this._pageId,t,t.Name,r);break;case Y.a.OptionSet:case g.U.guid:if(1==Object(Se.c)(je.getState(),_e.L)){var u=this._getEntityNameForControl(t,r);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new me(je,e,this._pageId,t,t.Name,r);break}}case Y.a.EntityNameOptionSet:case Y.a.TwoOptions:case Y.a.StatusOptionSet:case g.sb.guid:case g.K.guid:case g.W.guid:case g.V.guid:case g.hb.guid:case g.n.guid:case g.N.guid:s=new X(je,e,this._pageId,t,t.Name,r);break;case Y.a.MultiSelectPicklist:case g.Q.guid:if(Object(Se.c)(je.getState(),_e.L)){u=this._getEntityNameForControl(t,r);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new be(je,e,this._pageId,t,t.Name,r);break}}s=new Q(je,e,this._pageId,t,t.Name,r);break;case Y.a.QuickForm:case g.cb.guid:case g.ab.guid:case g.Z.guid:var p=new pe(je,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,p);break;case Y.a.SearchWidget:case Y.a.ReferencePanelSearchWidget:case g.db.guid:case g.kb.guid:s=new C.a(je,e,this._pageId,t,t.Name,r);break;case Y.a.TimelineWall:case g.qb.guid:(s=je.dispatch(Object(ee.f)(this._pageId,Object(Z.p)(e,t.Name))))||(s=new he.a(je,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case Y.a.DateAndTimeDateOnly:case Y.a.DateAndTimeDateAndTime:case g.q.guid:s=new K(je,e,this._pageId,t,t.Name,r);break;case Y.a.Grid:case g.eb.guid:case g.E.guid:var d=Object(Z.p)(e,t.Name),h=je.dispatch(Object(ee.c)(this._pageId,d));h&&(h.getName||3!==h.getGridType()?s=h:(_.a.getInstance().reportFailure(n,new Error("Main grid found in cache - converting to a subgrid."),null,a),je.dispatch(Object(ee.h)(this._pageId,d)))),s||(s=new J.a(je,e,this._pageId,t.Name,Object(te.wb)(je.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case Y.a.Timer:case g.rb.guid:s=new O(je,e,this._pageId,t,t.Name,r);break;case Y.a.WebResourceHtmlControl:case g.ub.guid:case g.vb.guid:s=new N(je,e,this._pageId,t,t.Name,r);break;case g.mb.guid:s=new re(je,e,this._pageId,t,r);break;case g.z.guid:case g.G.guid:break;case xe:if(Object(Se.c)(je.getState(),_e.L)&&Object(ye.l)(je.getState(),e.entityTypeName,t.Name)){s=new ve(je,e,this._pageId,t,t.Name,r);break}case Y.a.AppliedFilters:case Y.a.BusinessProcessFlow:case Y.a.Card:case Y.a.Currency:case Y.a.Dashboard:case Y.a.Decimal:case Y.a.EmailEngagementActions:case Y.a.EmailEngagementRecipientActivity:case Y.a.FP:case Y.a.GlobalFilter:case Y.a.MicrosoftFlow:case Y.a.Multiple:case Y.a.PowerBI:case Y.a.ReferencePanel:case Y.a.Search:case Y.a.SingleLineAddress:case Y.a.SingleLineEmail:case Y.a.SingleLinePhone:case Y.a.SingleLineText:case Y.a.SingleLineTextArea:case Y.a.SingleLineTickerSymbol:case Y.a.SingleLineURL:case Y.a.SocialInsightsControl:case Y.a.WholeDuration:case Y.a.WholeLanguage:case Y.a.WholeNone:case Y.a.WholeTimeZone:case g.a.guid:case g.b.guid:case g.c.guid:case g.d.guid:case g.e.guid:case g.f.guid:case g.g.guid:case g.h.guid:case g.j.guid:case g.k.guid:case g.m.guid:case g.p.guid:case g.r.guid:case g.s.guid:case g.t.guid:case g.u.guid:case g.v.guid:case g.w.guid:case g.x.guid:case g.y.guid:case g.A.guid:case g.B.guid:case g.D.guid:case g.H.guid:case g.J.guid:case g.L.guid:case g.O.guid:case g.P.guid:case g.R.guid:case g.T.guid:case g.X.guid:case g.Y.guid:case g.bb.guid:case g.gb.guid:case g.ib.guid:case g.jb.guid:case g.lb.guid:case g.mb.guid:case g.nb.guid:case g.ob.guid:case g.pb.guid:case g.tb.guid:case g.wb.guid:o=!0;default:s=t.DataFieldName?new de(je,e,this._pageId,t,t.Name,r):new b.a(je,e,this._pageId,t,t.Name,r),o||(a.push({name:"controlType",value:c}),le.a.getInstance().traceManager.getTracer(n).error("Unknown Form Control",a))}return s}catch(e){return _.a.getInstance().reportFailure(n+".createXrmControl",e,null,a),null}},e.prototype._getControlType=function(e,t,r,n,a){if(B.a.equals(e.ClassId,g.o)){var i=this._getCustomControlType(e,t,r);return i||le.a.getInstance().traceManager.getTracer(n+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:i}),i}return e.ClassId.guid},e.prototype._getCustomControlType=function(e,t,r){var n,a,i,o=Object(se.b)(je.getState(),this._pageId,r),s=Object(ge.c)(je.getState(),e,o);if(!s){var c=Object(v.h)(),l=(null===(a=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===a?void 0:a.getEntityName())||"",u=c(je.getState(),e,this._pageId,o,l);if(u||(u=Object(fe.a)(je.getState(),e,this._pageId,r)),null==u?void 0:u.Parameters)for(var p in u.Parameters)if(null===(i=u.Parameters[p])||void 0===i?void 0:i.Primary){s=u.Parameters[p].Type;break}}return s},e.prototype._getEntityNameForControl=function(e,t){var r="";if(e.Relationship)r=Object(v.T)(je.getState(),this._pageId,e.Relationship);else{var n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r},e}()},mVnn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},"n+eO":function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("r0tX"),a=r("9r0m"),i=r("WS0f"),o=r("9rlF"),s=r("nbQV"),c=r("TCcM"),l=r("T576"),u=r("QAhb"),p=r("A/RO"),d=r("Kdvm"),h=r("4HtA"),g=r("r3Bs"),f=r("LdMy"),m=r("sOTk"),b=r("mLFd"),v=r("G7N+"),y=r("ed60"),_=r("uwKl"),S=r("DUDQ"),O=r("lFQy"),C=r("gk6Q"),I=r("HSdq"),j=r("pflg"),P=r("b1hT"),T=r("lMVv"),x=r("2ojE"),E=r("LhJP"),F=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e,Object(C.c)(e._instance)),e._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t,n){var a=this;return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=n,this._processManager=new h.a(e,t,n,new f.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new d.a,this._businessProcessFlowWrapperFactory=new p.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),r.e(49).then(r.bind(null,"pG8E")).then((function(e){var t=e.BusinessProcessPageWrapper;return a._businessProcessPerPageWrapper=new t(a._applicationContext,a._getState,a._dispatch),Promise.resolve()})))},e.prototype.getBusinessProcessFlowWrapper=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))},e.prototype.getProcessManager=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)},e.prototype.getCurrentProcessManagerWithoutInit=function(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);var t=Object(m.g)(this._getState(),e),r=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,n=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(x.a)(this._getState(),r,e,this._applicationContext);return n.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null},e.prototype.hasChanged=function(e,t,r,n){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,n)))return!0;if(!t)return!1;var a=new u.a(t.entityTypeName,t.id),o=Object(l.f)(e,a);return!Object(i.a)(o)&&(!r||o>r.instanceModifiedTimestamp)||this._needsDockedModeRefresh(r,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,r,n)},e.prototype._needsDockedModeRefresh=function(e,t){return this._processManager.getDisplayState()===n.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)},e.prototype._reloadData=function(e,t){var r=this,n=this._getState();this._pageId=e,this._pageInfo=t;var p=Object(m.g)(n,e);if(p){var d=p.id,h=new u.a(p.entityTypeName,d);if(this._processIdInState=Object(c.e)(n,h),Object(P.g)(n)&&(!Object(P.d)(n)||Object(P.c)(n,e))){var g=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(x.c)(E.e,g,this._applicationContext)}var f=Object(j.a)(p),b=Object(j.b)(p);if(a.a.equals(h.id,a.a.EMPTY)&&f&&b){var C=Object(s.b)(n,f),I=new u.a(C.businessProcessFlowUniqueName,b),F=Object(l.b)(n,I);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(F,p),void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,f,I,e)}if(this._processIdInState){C=Object(s.b)(n,this._processIdInState);if(!Object(i.a)(C)&&Object(v.b)(C.initialized)){I=new u.a(C.businessProcessFlowUniqueName,Object(c.f)(n,h)),F=Object(l.b)(n,I);if(a.a.equals(h.id,a.a.EMPTY)){var w=Object(P.b)(C);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(O.a)(null,I))),w&&w.stage&&w.stage.stageId){var N=Object(P.a)(w);return this._dispatch(Object(S.b)(I,N)),void this._processManager.initilaizeWithProcessAndFormEntity(N.fields,C,h,this._processIdInState,I,e)}}else if(Object(i.a)(F))return;var A=Object(T.h)(n,h.etn);if(A&&A.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,this._processIdInState,I,e);for(var k in F)if(Object(o.k)(F[k])&&F[k].reference&&F[k].reference.id&&F[k].reference.etn===h.etn&&(a.a.equals(F[k].reference.id,h.id)||a.a.equals(F[k].reference.id,a.a.EMPTY))&&Object(P.e)(k))return void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,this._processIdInState,I,e);var M=this._dispatch(Object(y.b)(a.a.EMPTY,h)),D=this._dispatch(Object(_.b)(a.a.EMPTY,h));Promise.all([M,D]).then((function(t){r._processManager.initilaizeWithFormEntityOnly(h,e)}))}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}},e.prototype._reloadDataIfRequired=function(e,t){var r=this._getState(),n=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=n;var i=null,o=!1;if(n&&(i=Object(c.b)(n)(r,n.etn))&&(o=i.refreshGlobalNavigationData),!Object(P.g)(r)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(P.g)(r)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(b.b)(!1,n)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){var s=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),l=this._processManager.getTelemetryParams();s.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",l)}this._reloadDataCount++}else this._reloadDataCount=0},e.prototype._hasProcessChanged=function(e){var t=this._processIdInState||a.a.EMPTY,r=this._getState(),n=new u.a(e.entityTypeName,e.id),i=Object(m.g)(r,this._pageId),o=Object(j.a)(i),l=a.a.equals(n.id,a.a.EMPTY)&&o?o:Object(c.e)(r,n)||a.a.EMPTY;if(!a.a.equals(l,t))return!0;if(a.a.equals(l,a.a.EMPTY))return!1;var p=Object(s.b)(r,l);return!!p&&this._processManager.getVersion()<p.businessProcessFlowProcessVersion},e.prototype._moveToNextStageForCrossEntityBPF=function(e,t){var r=e.activestageid,n=e.traversedpath,i=t.data.nextStageId;if(!i){var o=Object(j.a)(t),s=Object(j.b)(t);if(!a.a.equals(o,this._processManager.getProcessId())||!a.a.equals(s,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}a.a.equals(r.reference.id,new a.a(i))||(r.reference=new u.a("processstage",new a.a(i)),n.value=n.value+","+i,e.activestagestartedon.value=new Date)},e}()},n4BT:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ViewPortSizes.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:{viewportWidth:r,viewportHeight:i},meta:{pageId:e,contextKey:o}}}},nIt0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("uO/V"),i=r("uQP8"),o="control.update.formlessControlOutputs";function s(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute:function(s,c){var l=s.dispatch,u=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();var h=u(),g=Object(i.a)(h,e),f=Object(n.__assign)({},g.formlessControlOutputs),m=!1;for(var b in p.info("Updating the unbound output."),r){var v=r[b],y=t+"."+b;f[y]!==v&&(f[y]=v,m=!0)}return m&&l(function(e,t){return{type:o,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,f)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var _="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(_))}}}}},nn4v:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},"o0+l":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.submitmode";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},oUmu:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("i8/j"),a=r("7z0H"),i="form.ui.metadata.update";function o(e,t,r){return{type:"form.ui.metadata.update.async",execute:function(o,s,c){var l=o.dispatch,u=(0,o.getState)(),p=Object(n.j)(u,e),d=Object(a.g)(u,p,e);return l(function(e,t,r,n){return{type:i,payload:{formId:e,formUIState:t},meta:{pageId:r,contextToken:n}}}(e,d,t,r)),Promise.resolve()}}}},oY7N:function(e,t,r){"use strict";r.d(t,"a",(function(){return Xt}));var n=r("c/eZ"),a=r("nuS9"),i=r("4fxQ"),o=r("D9ys"),s=r("4E+q"),c=r("YWpA"),l=r("hPFj"),u=r("H/hG"),p=r("e9UD"),d=r("znb3"),h=r("NJzV"),g=r("VnpK"),f=r("POU9"),m=r("vP/5"),b=r("0u+G"),v=r("uO/V"),y=2/(1+Math.sqrt(5)),_=function(e){function t(t){var r=e.call(this,t)||this;return r._memorizedDescriptor=null,r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0,height:0},r}return Object(n.__extends)(t,e),t.prototype._getGoldenRatioHeight=function(e){return y*e},t.prototype.onMeasuring=function(e,t){var r=!1,n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)},t.prototype.render=function(){var e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});var t,r,n=parseFloat(getComputedStyle(document.documentElement).fontSize),i=this._getTopAndBottomAdjustment(n),o=this._getLeftAndRightAdjustment(n);this.props.isLayoutVertical?(t=this.state.width-o,r=this._getGoldenRatioHeight(t),this.props.style.minHeight=r+i):(t=Math.max(this.state.width,320)-o,r=this.state.height-i);var s={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},l={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return a.createElement(c.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},a.createElement(c.a,{key:"pageChart_"+this.props.id+"_container",style:s},a.createElement(h.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))},t.prototype._closeChartPane=function(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)},t.prototype._getTopAndBottomAdjustment=function(e){var t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t},t.prototype._getLeftAndRightAdjustment=function(e){var t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t},t}(a.Component),S=r("9r0m"),O=r("ah4O"),C=r("RlP9"),I=r("r2h9"),j=r("RB3d"),P=r("perk"),T=r("Gemh"),x=r("pWlk"),E=r("olrR"),F=r("mGpW"),w=r("Ww2r"),N=r("gBKR"),A=r("lMVv"),k=r("G7N+"),M=r("hXUt"),D=r("5Fed"),R=r("Ev4I"),L=r("JlqV"),B=r("pJ3X"),V=r("oVzJ"),G=r("cZkS"),z=r("qC0c"),W=r("PMTb"),q=[],U=function(e){function t(t){var r=e.call(this,t)||this;return r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onChange=r._onChange.bind(r),r.props.entityTypeName.toLowerCase()===T.a&&(r.props.loadAllActivityTypes(t.activities),r.props.loadAllActivityResourceString()),r}return Object(n.__extends)(t,e),t.prototype._getEntityTypeNameFromViewId=function(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null},t.prototype._onChange=function(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new S.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===T.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)},t.prototype._isViewSelectorHidden=function(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)},t.prototype.render=function(){var e=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===v.h.GRID,r=t?this._onItemIconPointerDown:null,n=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,i=n?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,o=n?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,s=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null;if(this._isViewSelectorHidden())return s&&s.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;var c=[],l=!1;for(var u in this.props.gridViewSelectorItems){var p=this.props.gridViewSelectorItems[u];if(p){var h=p.isUserView;h&&(l=!0);var g=void 0;if(this.props.entityTypeName===T.a&&this.props.pinnedActivityView){var f=p;g=f.isPinned&&this.props.pinnedActivityView.PinnedEntity===f.relatedEntityName}else g=p.isPinned;var m=t?g?d.a.Pinned:d.a.Pin:null,b={":hover":{"::before":{content:g?'""':'""'}}};this.props.useViewSelectorV2&&Object.assign(b,{marginLeft:"8px",marginRight:"8px"});var y=t?b:null,_=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_DEFAULTVIEW),S=Object(w.c)(this.props.resourceStrings,P.VIEWSELECTOR_SETDEFAULTVIEW),C=t?g?_:S:null,x="";x=this.props.entityTypeName===T.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(q.indexOf(p.relatedEntityName)+1).toString():h?I.b.userview.toString():I.b.savedview.toString();var E=p.name;u===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?E="*"+E:E+="*"),c.push({value:u,text:E,categoryId:x,iconType:m,iconTitle:C,iconStyle:y})}}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){var F=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:F,categoryId:I.b.savedview.toString()})}var N=l?this.props.viewCategories:this.props.viewCategories.filter((function(e){return e.id!==I.b.userview.toString()}));return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?a.createElement(B.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?a.createElement(W.a,null,"New view"):a.createElement(B.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?a.createElement(W.a,{style:i},"New view"):a.createElement(O.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:N,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:i,viewSelectorStyle:o,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:j.a,createKeyboardShortcut:j.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})},t.prototype.componentDidMount=function(){var e=this;if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),!this._isViewSelectorHidden()){var t=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(t=!0),!t){if(this.props.viewIds)this.props.viewIds.find((function(t){return t.guid===e.props.selectedViewId}))&&(t=!0);this.props.defaultViewId&&this.props.defaultViewId.guid!==S.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}},t.prototype._onItemIconPointerDown=function(e){var t=this,r=e,n=e.iconType===d.a.Pinned,a=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null,i=e.categoryId,o=this.props.entityTypeName;if(this.props.entityTypeName===T.a){var s=this.props.gridViewSelectorItems;o=s&&s[e.value]?s[e.value].relatedEntityName:o,i=!(!s||!s[e.value])&&s[e.value].isUserView?I.b.userview.toString():I.b.savedview.toString()}a&&a.info("Toggle the the pin status for "+e.value+" for "+o+" entity"),this.props.onItemIconPointerDown(o,e.value,i,"",n).then((function(){if(a&&a.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&t.props.entityTypeName===T.a){var i=t.props.gridViewSelectorItems[r.value];t.props.pinnedActivityView.PinnedEntity=i.relatedEntityName,t.props.pinnedActivityView.ViewId=new S.a(e.value),t.props.pinnedActivityView.ViewType=i.isUserView?I.b.userview:I.b.savedview}for(var o in t.props.gridViewSelectorItems)t.props.gridViewSelectorItems[o].isPinned=o===r.value&&!n;t.forceUpdate()}),(function(e){a&&a.error("Could not pin the selected view, pinning action failed with error "+e)}))},t}(a.Component);function X(e,t,r,n){var a=[];if(t===T.a&&n){var i=1;q.forEach((function(t){a.push({id:i.toString(),name:Object(A.f)(e,t)}),i++}))}else a=Object(T.mb)(e,r);return a}function H(e,t,r){var a;return t.forEach((function(t,i){var o=function(e,t,r){var n=Object(C.f)(e,t,r);n&&!Object(L.b)(e)&&Object(R.l)(e,t)&&(n=Object.keys(n).reduce((function(a,i){return(n[i].isAvailableInOffline||i===S.a.toString(Object(C.a)(e,t,r)))&&(a[i]=n[i]),a}),{}));return n}(e,r,t);o&&(a=Object(n.__assign)(Object(n.__assign)({},a),o))})),a}U.displayName="DataSetViewSelector";var K=Object(s.a)((function(){var e=null,t=null,r=null,a={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null},i=Object(x.a)(),o=Object(w.h)();return function(s,c){var l,u=o(s,P.labelList),p=S.a.toString(Object(C.a)(s,c.entityTypeName,I.a.QUICKFIND_SEARCH)),d=null,h=null,g=i(s,c.contextString);q=Object(T.B)(s);var f=!1;if(c.queryViewSelectorTypes&&c.queryViewSelectorTypes.length>0&&!c.viewIds){if(c.entityTypeName===T.a&&c.shouldDisplayNestedViewSelector?(q.forEach((function(e){var t=H(s,c.queryViewSelectorTypes,e);t&&(d=Object(n.__assign)(Object(n.__assign)({},d),t))})),h=Object(w.e)(s,["ViewSelectorAllActivities"])):d=H(s,c.queryViewSelectorTypes,c.entityTypeName),e)for(var m in d)if(!e[m]||e[m]!==d[m]){f=!0;break}}else if(c.viewIds){for(var b={},v=0;v<c.viewIds.length;v++){var y=Object(T.qb)(s,c.viewIds[v],c.id);if(y&&y.grid&&y.grid.rows){var _=e?e[y.viewId.guid]:void 0,O=!_||_.name!==y.title||_.queryType!==y.queryType;m=O?{name:y.title,queryType:y.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:y.isUserView}:_;Object.assign(b,((l={})[y.viewId.guid]=m,l)),f=f||O}}b&&(d=b)}return!d||e&&Object.keys(e).length===Object.keys(d).length||(f=!0),h&&a.allActivitiesString!==h.ViewSelectorAllActivities&&(f=!0),t!==p&&(f=!0),r!==g&&(f=!0),f&&(t=p,r=g,a={gridViewSelectorItems:e=d,viewCategories:X(s,c.entityTypeName,P,c.shouldDisplayNestedViewSelector),allActivitiesString:h&&h.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:u,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(V.b)(s),useViewSelectorV2:Object(z.a)(s,G.le,G.h)}),a}}),(function(e){return{loadViewsByType:function(t,r,n){var a=[];return t.forEach((function(t,i){t===I.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||a.push(e(Object(E.a)(r,t,void 0,void 0)))})),Promise.all(a)},loadAllActivityResourceString:function(){return e(Object(F.e)(["ViewSelectorAllActivities"]))},loadAllActivityTypes:function(t){var r=null;for(var n in t)t[n].Initialized!==k.a.Initialized&&(r||(r={}),r[n]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(N.e)(r)):Promise.resolve()},loadGridViewsByViewId:function(t,r){var n=[];return t.forEach((function(t,a){n.push(e(Object(E.a)(r,void 0,void 0,t)))})),Promise.all(n)},openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))(U),Q=r("6Tlt"),Y=r("Wg6j"),J=r("XIN1"),Z=r("r7Ib"),$=r("Md8f"),ee=r("5olG"),te=r("c96h"),re=42,ne=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={commandbarWidth:0},r._lastCommandManagerId=t.commandManagerId,r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){var t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object(ee.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object(ee.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?re:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})},t.prototype.componentDidUpdate=function(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))},t.prototype._renderConsoleAppBackButton=function(){return this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.pageId}):null},t.prototype._renderNativeSubgridCommandBar=function(){return this.props.isNativeMode?a.createElement(B.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null},t.prototype.render=function(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;var e=!this.state.commandbarWidth,t=a.createElement(Q.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:Y.a.IconLabel,key:this.props.pageId,iconPosition:J.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:a.createElement(c.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())},t}(a.Component);ne.displayName="DataSetCommandBar";var ae=Object(s.a)((function(){return function(e,t){var r=Object(V.b)(e);return{commandManagerId:Object(T.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(te.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:function(t,r,n){t&&r&&n&&e(Object(Z.b)(t,r,n))}}}))(ne),ie=r("A6np"),oe=r("jigW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){var t=e.split(":");if(2===t.length)return t[1].split(",")}return[]}function ce(e){if(e&&e.filterOptions&&e.filterOptions.length>0){var t=e.filterOptions.filter((function(e){return e.isDefault})),r=e.userSetting,n=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];n&&""!==n.QueueId&&(t=e.filterOptions.filter((function(e){return Object(T.bb)(n.QueueId).sort().join(",")===se(e.value).sort().join(",")})));var i=void 0,o=void 0;e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=Object(oe.f)(e.filterOptions,e.previousValue),o=e.previousValue),i||(t.length>0?(i=t[0].text,o=t[0].value):(i=e.filterOptions[0].text,o=e.filterOptions[0].value)),e.updateFilterValue(o);var s=Object(w.c)(e.resourceStrings,P.QUEUE_FILTER_LABEL),l=a.createElement(ie.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:s,accessibilityLabel:s,defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,createKeyboardShortcut:j.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return a.createElement(c.a,{key:"GridFilterView",style:e.style},l)}var u=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(v.z):null;return u&&u.info("Queue Filter not rendered because there are no filter options available"),null}var le=r("np0M"),ue=r("Oiu5"),pe={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},de={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function he(e,t){if(!e.isRollupViewSupported)return null;var r,i,o,s,c=function(e){var t=[];if(!Array.isArray(e))return t;for(var r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(w.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_OFF),Object(w.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_ON)]),l=e.isOffline,u=(r=e.toggleValue,i=t,o=e.onToggleChange,s=c,Object(n.__assign)(Object(n.__assign)({},de),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:r?1:0,Attributes:{DefaultValue:0,Options:s,DisplayName:i},Callback:o}}})),p=function(e,t){return Object(n.__assign)(Object(n.__assign)({},pe),{Label:e,Disabled:t})}(t,l),d="rollup_view_switch_"+e.id;return a.createElement(h.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:p,configuration:u,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ge(e,t,r,n,i){var o=e.theme,s=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return a.createElement(c.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},a.createElement(c.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,r]),i?a.createElement(c.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[n,i]):null,function(e,t,r,n){if(!t)return;var i=Object(w.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_LABEL),o={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},s={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:n?0:r.sizes.Measures.Measure100,marginLeft:n?r.sizes.Measures.Measure100:0};return a.createElement(c.a,{key:"RollupViewControlContainer",style:o},a.createElement(c.a,{key:"rollupViewFilterLabelView",style:s},i),he(e,i))}(e,e.isRollupViewSupported,o,s))}var fe=Object(s.a)(void 0,(function(e){return{openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))((function(e){var t,n=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(v.z):null,i="",o=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){var s=e.filterOptions.filter((function(e){return e.isDefault}));o&&(t=Object(ue.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=o?e.previousValue:Object(oe.f)(e.filterOptions,e.previousValue)),i||(i=s.length>0?o?s[0].value:s[0].text:o?e.filterOptions[0].value:e.filterOptions[0].text)}var l=a.useState(i),p=l[0],d=l[1];if(e&&e.filterOptions&&e.filterOptions.length>0){var h=o?Object(w.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(w.c)(e.resourceStrings,e.entityFilterLabelResourceString),g=null;h&&(g=a.createElement(u.a,{key:"activityDueDateFilterLabel",style:o?e.activityMgmtLabelStyle:e.labelStyle}," ",h," "));var f=a.createElement(c.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},g),m=a.createElement(ie.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,textStyle:{flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},createKeyboardShortcut:j.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:h,freeTextMode:!0,suppressFreeTextChangeCallback:!0});if(o&&(m=a.createElement(le.a,{key:"activityDueDateFilterComboBox",loader:function(){return Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(29),r.e(91)]).then(r.bind(null,"YDph")).then((function(e){return e.ComboBox}))},props:{selectedKey:p,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:t,onChange:function(t,r){d(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:h,useComboBoxAsMenuWidth:!0,allowFreeform:!0}})),e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===v.a){var b=null,y=Object(w.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);y&&(b=a.createElement(u.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",y," "));var _=a.createElement(c.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},b),S=void 0;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){n&&n.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);var O=Object(ue.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){var C=Object(w.c)(e.resourceStrings,P.ACTIVITYTYPE_SELECTALL),I=[];I.push({key:"selectAllKey",text:C}),O=I.concat(O)}var T=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(T=Object(ue.b)(e.activityTypePreviousValues)),S=a.createElement(le.a,{key:"activityTypeFilterBox",loader:function(){return Promise.all([r.e(10),r.e(29),r.e(41)]).then(r.bind(null,"x3Jg")).then((function(e){return e.ActivityTypeCombobox}))},props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:T,onActivityTypeFilterClear:function(){e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:function(t){e.onActivityTypeChange(t)},options:O,ariaLabel:y,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return ge(e,f,m,_,S)}return ge(e,f,m,null,null)}return n&&n.info("Activity Filter not rendered because there are no filter options available"),null})),me=r("lU69"),be=r("gvL4"),ve=r("Smta"),ye=r("vTeb"),_e=r("evW+"),Se=r("1AYO"),Oe=r("19Zc"),Ce=r("wV3W"),Ie=r("vO+w");var je=r("rbxJ"),Pe=r("9rQ4"),Te=r("hl8w"),xe=r("akzq"),Ee=r("Wi7Z"),Fe=r("B73A"),we=r("E705"),Ne=r("YT7W"),Ae=r("TCzx"),ke=function(e){function t(t){var r=e.call(this,t)||this;return r._cachedSelectedFilter="",r._onFilterChange=r._onFilterChange.bind(r),r._toggleJumpBarFlyout=r._toggleJumpBarFlyout.bind(r),r._closeJumpBarDomId="close-jumpbar-"+Object(me.a)(),r._selectedFilterDomId="selected-filter-"+Object(me.a)(),r.state={isFlyoutOpened:!1},r}return Object(n.__extends)(t,e),t.prototype._onOutsideClickHandler=function(e,t){var r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()},t.prototype.keyDownHandler=function(e){switch(e.EVENT.keyCode){case Pe.a.Escape:this._setIsFlyoutOpenedState(!1)}},t.prototype._toggleJumpBarFlyout=function(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)},t.prototype._setIsFlyoutOpenedState=function(e){this.setState({isFlyoutOpened:e}),Object(we.g)(e)},t.prototype._filterGrid=function(e){var t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){var n=e.getAttribute("data-value").toUpperCase();n!==r&&(r=r+"|"+n)}t=this.props.dataSetFetchXml?Object(Te.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Te.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)},t.prototype._onFilterChange=function(e){var t=e.target,r=e;("click"===e.type||r&&r.keyCode===Pe.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))},t.prototype._renderListItem=function(e,t,r){var i=Object(n.__assign)({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),o=Object(n.__assign)(Object(n.__assign)({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(i=Object.assign(i,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),o=Object.assign(o,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),a.createElement(ve.a,Object(n.__assign)({},r,{style:i}),a.createElement(ye.a,Object(n.__assign)({},e,{style:o}),t))},t.prototype._createKeyboardShortcuts=function(){var e=Object(w.c)(this.props.resourceStrings,P.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new Fe.a([Pe.a.Escape],t,!0,"",e);return r.push(n),r},t.prototype._renderJumpBarAlphabet=function(){var e=this,t=[],r=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET),n=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_INDICATOR),a=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_TOOLTIP),i=Ae.a.getInstance(),o=!!i&&i.get_IsIOS();return r.split(",").forEach((function(r){var i=Object(je.h)(r),s=i[0],c=i[1],l=s+"_listItem",u=s+"_link",p={id:l,key:l,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,c),role:Ee.q,onClick:e._onFilterChange,onKeyDown:e._onFilterChange,tabIndex:-1},d={id:u,key:u,testhooks:{id:u},tabIndex:-1,role:Ee.r,accessibilityHidden:!o,accessibilityLabel:o?String.format(P.FILTERBY_ARIALABEL,c):void 0};s===n&&(d.title=a,d.accessibilityLabel=P.NUMBER_ARIALABEL),e.props.selectedFilter!==s&&e.props.selectedFilter!==c||(p.describedByElementId=e._selectedFilterDomId,p.isSelected=!0,p.tabIndex=0),c&&(p.dataValue=c),t.push(e._renderListItem(d,s,p))})),t},t.prototype._renderJumpBarAll=function(){var e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALL),t=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";var r=e+"_link",n=Ae.a.getInstance(),a=!!n&&n.get_IsIOS(),i={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Ee.q,tabIndex:-1,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,e)},o={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:Ee.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(P.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(i.describedByElementId=this._selectedFilterDomId,i.isSelected=!0,i.tabIndex=0),this._renderListItem(o,e,i)},t.prototype._renderList=function(){var e=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE);return a.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Ee.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object(n.__assign)(Object(n.__assign)({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:P.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())},t.prototype._onJumpbarKeyDown=function(e){var t=e.target;if(this.state.isFlyoutOpened){var r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();(i=t.previousElementSibling)?i.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();(a=t.nextElementSibling)&&a.focus()}return}}if(e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.LeftArrow||e.keyCode===Pe.a.RightArrow){e.stopPropagation(),e.preventDefault();var a,i,o=e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.RightArrow,s=e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.LeftArrow;if(o)return void((a=t.nextElementSibling)&&a.focus());if(s)return void((i=t.previousElementSibling)&&i.focus())}},t.prototype._renderJumpBarFlyout=function(e,t){var r="jumpbar-flyout_"+this.props.id,n=r+"Accessibility",i=[];return i.push(a.createElement(xe.a,{key:n,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),a.createElement(c.a,{role:Ee.e},a.createElement(Se.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Se.b.upleft:Se.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},a.createElement(_e.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:P.CLOSE_JUMPBAR_ARIALABEL},a.createElement(u.a,{style:this.props.styles.closeButtonTextStyle},a.createElement(J.b,{type:d.a.Close}))),this._renderList()),i)},t.prototype._renderFlyoutButton=function(e){for(var t=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE),r=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET).split(","),n="",i=0;i<3;i++){n+=Object(je.h)(r[i+1])[0]}return a.createElement(_e.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},a.createElement(u.a,{style:this.props.styles.jumpBarButtonTextStyle},n))},t.prototype.render=function(){try{if(this.props.resourceStrings){var e="jumpBarRoot_"+this.props.id,t=e+"_"+this.props.uniqueId,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),n={position:"relative"};this.props.renderMobile&&Object.assign(n,{maxWidth:"100%"});var i={height:"0",width:"0"},o="flyoutRelativeElement"+this.props.controlKey;return a.createElement(c.a,{id:t,key:t,testhooks:{id:e},style:n},this.props.isRTL?null:a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,o):null,a.createElement(c.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},P.SELECTEDFILTER_TEXT),this.props.isRTL?a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}},t}(a.Component);var Me=Object(s.a)((function(){var e,t,r=null,n=null,a=null,i=Object(w.h)(),o=(e=null,t=null,function(r,n){var a,i,o,s,c,l,u,p,d,h,g,f,m,b,v,y,_,S,O,C,I,j,P,T,x,E,F,w,N,A,k,M,D,R,L=Object(Ce.a)(r),B=Object(Ie.b)(r)&&Object(z.a)(r,G.Fb,G.Lc)&&(null===(a=Object(Ie.a)(r))||void 0===a?void 0:a.Components)?Object(Ie.a)(r).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(s=null===(o=null===(i=null==B?void 0:B.Grid)||void 0===i?void 0:i.Footer)||void 0===o?void 0:o.JumpBar)||void 0===s?void 0:s.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==B?void 0:B.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(d=null===(p=null==B?void 0:B.Grid)||void 0===p?void 0:p.Footer)||void 0===d?void 0:d.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(m=null===(f=null===(g=null==B?void 0:B.Grid)||void 0===g?void 0:g.Footer)||void 0===f?void 0:f.JumpBar)||void 0===m?void 0:m.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(y=null===(v=null===(b=null==B?void 0:B.Grid)||void 0===b?void 0:b.Footer)||void 0===v?void 0:v.JumpBar)||void 0===y?void 0:y.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(O=null===(S=null===(_=null==B?void 0:B.Grid)||void 0===_?void 0:_.Footer)||void 0===S?void 0:S.JumpBar)||void 0===O?void 0:O.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(j=null===(I=null===(C=null==B?void 0:B.Grid)||void 0===C?void 0:C.Footer)||void 0===I?void 0:I.JumpBar)||void 0===j?void 0:j.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(x=null===(T=null===(P=null==B?void 0:B.Grid)||void 0===P?void 0:P.Footer)||void 0===T?void 0:T.JumpBar)||void 0===x?void 0:x.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(w=null===(F=null===(E=null==B?void 0:B.Grid)||void 0===E?void 0:E.Footer)||void 0===F?void 0:F.JumpBar)||void 0===w?void 0:w.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(A=null===(N=null==B?void 0:B.Grid)||void 0===N?void 0:N.Footer)||void 0===A?void 0:A.JumpBar)||void 0===k?void 0:k.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(D=null===(M=null==B?void 0:B.Grid)||void 0===M?void 0:M.Footer)||void 0===D?void 0:D.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e});return function(e,t){var s=o(e,t);if(null===r&&(r=Object(A.E)(e,t.entityTypeName)),null==n&&(n=e.metadata.attributes[t.entityTypeName]),Object(z.a)(e,G.ac)){var c=Object(T.v)(e,t.id,t.contextToken);a=c&&c.fetchXml}return{resourceStrings:i(e,P.labelList),primaryNameAttribute:r,dataSetFetchXml:a,entityAttributeMetadata:n,styles:s}}}),(function(e,t){return{applyGridFilter:function(r,n,a){if(e(Object(Oe.m)(r,t.id,a)),e(Object(Ne.b)(t.id,a,1)),n){var i=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(i,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(ke),De=r("fH/t");var Re=r("4Q7K"),Le=r("3IUl"),Be=r("bc+P"),Ve=r("+6eZ"),Ge=r("Baft"),ze=r("zETL"),We=r("r0s4"),qe=function(e){function t(t){var r=e.call(this,t)||this;return r._goToFirstPage=r._goToFirstPage.bind(r),r._goToPreviousPage=r._goToPreviousPage.bind(r),r._goToNextPage=r._goToNextPage.bind(r),Object(w.c)(t.resourceStrings,De.d)||t.retrieveResourceStrings(De.k),r}return Object(n.__extends)(t,e),t.prototype._firstButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._nextButtonEnabled=function(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage},t.prototype._previousButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._goToNextPage=function(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)},t.prototype._goToPreviousPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)},t.prototype._goToFirstPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)},t.prototype._setFooterButtonsFocus=function(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){var r=e.currentTarget,n=e.currentTarget.parentElement.children[1];setTimeout((function(){r.disabled&&n.focus()}),500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){var a=e.currentTarget,i=e.currentTarget.parentElement.lastElementChild;setTimeout((function(){a.disabled&&i.focus()}),500)}},t.prototype._getResources=function(){if(this._loadFirstPage=this._loadFirstPage||Object(w.c)(this.props.resourceStrings,De.d),this._loadNextPage=this._loadNextPage||Object(w.c)(this.props.resourceStrings,De.e),this._loadPreviousPage=this._loadPreviousPage||Object(w.c)(this.props.resourceStrings,De.f),!this._spaceResource){var e=Object(w.c)(this.props.resourceStrings,De.j);this._spaceResource=Object(We.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(w.c)(this.props.resourceStrings,De.a),this._gridTotalCount=this._gridTotalCount||Object(w.c)(this.props.resourceStrings,De.c),this._itemSelected=this._itemSelected||Object(w.c)(this.props.resourceStrings,De.b),this._totalApproximate=this._totalApproximate||Object(w.c)(this.props.resourceStrings,De.h),this._totalExact=this._totalExact||Object(w.c)(this.props.resourceStrings,De.i)},t.prototype.render=function(){if(!this.props.pagingData)return null;var e=Object(Ve.a)(this.props.pagingData),t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));var n=e.totalResultCount,i=this._firstButtonEnabled(e),o=this._nextButtonEnabled(e),s=this._previousButtonEnabled(e);this._getResources();var l=n;-1===n&&(l=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);var u="";u=-1===n?String.format(this._totalApproximate,this.props.isServerOffline?r:l):this.props.isServerOffline&&n>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:n);var p=String.format(this._gridTotalCount,this._spaceResource,u),d=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(w.c)(this.props.resourceStrings,De.g),g=String.format(h,this.props.currentPage),f=n/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(f=-1/e.pageSize),a.createElement(c.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,p,d),this._renderPagingButtons(i,o,s,g,f))},t.prototype._renderPagingButtons=function(e,t,r,n,i){return(i<0||i>1)&&this.props.enhancedPagingDisabled?a.createElement(c.a,{style:this.props.styleProps.navigationPanelStyle},a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},a.createElement(J.b,{type:d.a.FirstPageButton})),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},a.createElement(J.b,{type:d.a.BackButton})),a.createElement(u.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Ee.a,notificationType:Ge.b},null!==this.props.currentPage?String.format(n,this.props.currentPage):null),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},a.createElement(J.b,{type:d.a.Forward}))):null},t.prototype._renderPagingText=function(e,t,r,n){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return a.createElement(c.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},a.createElement(u.a,null,String.format(this._gridInfoResource,e,t,r,n)))},t}(a.Component);var Ue=Object(s.a)((function(){var e,t,r,a=null,i=Object(w.h)(),o=(e=null,t=null,r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}},function(a,i){var o,s,c,l,u,p,d,h,g,f,m,b,v=Object(Ie.b)(a)&&Object(z.a)(a,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(a))||void 0===c?void 0:c.Components)?Object(Ie.a)(a).Components:null;if(e!==i){e=i;var y=Object(Ce.a)(a),_=a.user.userSettings.isRTL,S=Object(n.__assign)(Object(n.__assign)({},r.containerStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100}),O=Object(n.__assign)(Object(n.__assign)({},r.navigationPanelStyle),((o={})["margin"+(_?"Right":"Left")]="auto",o)),C=Object(n.__assign)(Object(n.__assign)({},r.pageNumberStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100,fontSize:y.fontSizes.Font085,fontFamily:y.fontFamilies.Regular,color:(null===(u=null===(l=null==v?void 0:v.Grid)||void 0===l?void 0:l.Footer)||void 0===u?void 0:u.TextColor)||y.colors.BaseColor.Grey.Grey7}),I=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r.pagingButton),{color:(null===(d=null===(p=null==v?void 0:v.Grid)||void 0===p?void 0:p.Footer)||void 0===d?void 0:d.IconColor)||y.colors.BaseColor.Blue.Blue3,marginLeft:y.sizes.Measures.Measure050,marginRight:y.sizes.Measures.Measure050,width:"0px",fontSize:y.fontSizes.Font085,"[disabled]":{color:(null===(f=null===(g=null===(h=null==v?void 0:v.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.Disabled)||void 0===f?void 0:f.IconColor)||y.colors.BaseColor.Grey.Grey5}}),_&&{transform:"scaleX(-1)"}),j=((s={})["margin"+(_?"Left":"Right")]="auto",s.fontSize=y.fontSizes.Font085,s.fontFamily=y.fontFamilies.Regular,s.color=(null===(b=null===(m=null==v?void 0:v.Grid)||void 0===m?void 0:m.Footer)||void 0===b?void 0:b.TextColor)||y.colors.BaseColor.Grey.Grey7,s);t=Object(n.__assign)(Object(n.__assign)({},r),{containerStyle:S,navigationPanelStyle:O,pagingButton:I,pageNumberStyle:C,pagingTextStyle:j})}return t});return function(e,t){var r=o(e,t.contextString),n=Object(T.fb)(e,t.id,t.contextToken),s=n?n.length:0,c=i(e,De.k),l=Object(T.Y)(e,t.id,t.contextToken),u=Object(T.x)(e,t.id,t.contextToken);return a!==r&&(a=r),{selectedRowCount:s,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:a}}}),(function(e,t){return{retrieveResourceStrings:function(t){return e(Object(F.e)(t))},updatePageNumber:function(r){if(e(Object(Ne.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(ze.b)(t.id,t.contextToken)),t.isGridRoot){var n=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(n,t.id)}return e(Object(Be.b)(t.id,t.contextToken,null)),e(Object(Le.b)(t.id,t.contextToken,[]))},setNewPageRequested:function(r){e(Object(Re.b)(t.id,t.contextToken,r))}}}))(qe),Xe=r("PBKq"),He=r("i6iy"),Ke=r("7EJx");var Qe=r("jf1O"),Ye=r("aPRd"),Je=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindInnerTextRef=null,r._searchBarFocusTriggered=!1,r._onTextInputChange=r._onTextInputChange.bind(r),r._onkeyDown=r._onkeyDown.bind(r),r._onButtonClick=r._onButtonClick.bind(r),r._focusTextInput=r._focusTextInput.bind(r),r.updateSearchTextAndFind=r.updateSearchTextAndFind.bind(r),r.props.isGridPaginationStateFeatureEnabled&&r.props&&r.props.gridInput&&r.props.gridInput.quickFindExpression?r.state={quickFindText:r.props.gridInput.quickFindExpression.trim(),currentViewId:r.props.currentViewIdToRestore,clearQuickFind:!0}:r.state={quickFindText:null,currentViewId:null,clearQuickFind:!1},r}return Object(n.__extends)(t,e),t.prototype.clearSearchBar=function(){this.setState({quickFindText:null,clearQuickFind:!1})},t.prototype.updateSearchTextAndFind=function(e,t){var r=this;this.setState({quickFindText:e},(function(){t&&r._applyQuickFind()}))},t.prototype._onButtonClick=function(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()},t.prototype._onkeyDown=function(e){e.keyCode===Pe.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())},t.prototype._onTextInputChange=function(e){var t=""===e;this.setState({quickFindText:e,clearQuickFind:t})},t.prototype._applyFilter=function(){var e=this._formatQuickFindText(),t=Object(Te.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)},t.prototype._clearFilter=function(){var e=this;this.setState({quickFindText:""},(function(){e._applyFilter()}))},t.prototype._formatQuickFindText=function(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")},t.prototype._applyQuickFind=function(){var e=this;this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then((function(t){e.setState({clearQuickFind:!0}),e.state.currentViewId||e.setState({currentViewId:t})})):this._clearQuickFind()},t.prototype._clearQuickFind=function(){var e=this;this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then((function(){e.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})}))},t.prototype._getPlaceholderText=function(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)},t.prototype._createUniqueId=function(e){var t=this.props,r=t.contextToken,n=t.id;return r.controlName?e+"_"+r.controlName+"_"+n:e+"_"+n},t.prototype.render=function(){var e=this,t=this._getPlaceholderText(),r=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return a.createElement(c.a,null,a.createElement(B.i,{placeholder:t,cancelText:Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_CANCEL_LABEL_ID),clearText:r,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));var n=this._createUniqueId("quickFind_text"),i=this._createUniqueId("quickFind_button"),o=this._createUniqueId("quickFind_button_icon"),s=Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_APPLY_BUTTON),l=this.state&&this.state.clearQuickFind?r:s;return a.createElement(c.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},a.createElement(Xe.a,{id:n,key:n,ref:function(t){e._quickFindInnerTextRef=t},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:t,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:t}),a.createElement(_e.a,{id:i,key:i,testhooks:{id:i},accessibilityLabel:l,title:l,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},a.createElement(J.b,{id:o,key:o,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))},t.prototype._focusTextInput=function(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){var e=i.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}},t.prototype.componentDidMount=function(){this._focusTextInput()},t}(a.Component);Je.displayName="DataSetQuickFind";var Ze=Object(s.a)((function(){var e,t,r,a,i=null,o=null,s=null,c=(t=null,r=null,a={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}},function(i,o){var s,c,l,u,p,d,h,g,f,m,b,v,y,_,S,O,C,I=Object(Ke.g)(i),j=Object(Ie.b)(i)&&Object(z.a)(i,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(i))||void 0===c?void 0:c.Components)?Object(Ie.a)(i).Components:null;if(j&&(a=Object.assign(a,{inputStyle:{color:null===(p=null===(u=null===(l=null==j?void 0:j.Grid)||void 0===l?void 0:l.ColumnHeader)||void 0===u?void 0:u.QuickFind)||void 0===p?void 0:p.TextColor,backgroundColor:null===(g=null===(h=null===(d=null==j?void 0:j.Grid)||void 0===d?void 0:d.ColumnHeader)||void 0===h?void 0:h.QuickFind)||void 0===g?void 0:g.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(b=null===(m=null===(f=null==j?void 0:j.Grid)||void 0===f?void 0:f.ColumnHeader)||void 0===m?void 0:m.QuickFind)||void 0===b?void 0:b.IconColor},buttonIconStyle:{color:null===(_=null===(y=null===(v=null==j?void 0:j.Grid)||void 0===v?void 0:v.ColumnHeader)||void 0===y?void 0:y.QuickFind)||void 0===_?void 0:_.IconColor}})),t!==o||e!==I){t=o,e=I;var P=Object(Ce.a)(i),T=Object(n.__assign)(Object(n.__assign)({},a.buttonStyle),{":before":{content:"''",display:"inline-block",width:P.sizes.Measures.Measure250}}),x=Object(n.__assign)(Object(n.__assign)({},a.quickFindStyle),((s={borderColor:(null===(C=null===(O=null===(S=null==j?void 0:j.Grid)||void 0===S?void 0:S.ColumnHeader)||void 0===O?void 0:O.QuickFind)||void 0===C?void 0:C.BorderColor)||P.colors.BaseColor.Grey.Grey3})["padding"+(I?"Right":"Left")]=P.sizes.Measures.Measure025,s));r=Object(n.__assign)(Object(n.__assign)({},a),{buttonStyle:T,quickFindStyle:x})}return r}),l=Object(Qe.a)(),u=Object(w.h)(),p=null;return function(e,t){var r=c(e,t.contextString),n=l(e,t);s||(s=u(e,P.labelList)),i!==r&&(i=r),o!==n&&(o=n),p||(p=Object(z.c)(e,G.bd));var a=Object(z.a)(e,G.zb),d=null;a&&t.gridInput&&(d=(t.gridInput&&t.gridInput.viewId&&!S.a.isNullOrEmpty(t.gridInput.viewId)?t.gridInput.viewId:null)||Object(C.a)(e,t.entityTypeName,I.a.MAIN_APPLICATION_VIEW));return{quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(A.E)(e,t.entityTypeName),styleProps:i,quickFindRNStyleProps:o,shouldUseFilter:!(Object(je.e)(t.contextString)||Object(je.d)(t.contextString)||Object(je.g)(t.contextString)&&p),resourceStrings:s,isGridPaginationStateFeatureEnabled:a,currentViewIdToRestore:d,shouldGridSearchUseCurrentView:Object(oe.l)(e),isGridSearchCanUseCurrentViewFeatureEnabled:Object(z.a)(e,G.Db,G.h),isQuickFindImprovementsFeatureEnabled:Object(z.a)(e,G.ad,G.tc),viewPortWidth:Object(Ye.c)(e)}}}),(function(e,t){return{applyQuickFind:function(r,n,a,i,o,s){if(a&&s){var c=[{filterType:1,filterExpressionOrValue:r}];a.entityTypeName===v.a&&c.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(c,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(He.a)(r,n,i,o))},clearQuickFind:function(r,n,a,i,o){if(a){t.updateGridPaginationStateHandler([{filterType:1,filterExpressionOrValue:null}],t.id)}return e(Object(He.b)(r,n,i,o))},applyGridFilter:function(r,n){e(Object(Oe.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Je);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var $e=function(e){return function(e,t,r,n,i,o){var s=(null==o?void 0:o.seeMoreTooltip)||Object(w.c)(t,P.SEE_MORE_TOOL_TIP),l=(null==o?void 0:o.seeMoreLabel)||Object(w.c)(t,P.SEE_MORE_LABEL),p=s;return(null==o?void 0:o.uniqueLabel)&&(p+=" "+o.uniqueLabel),a.createElement(c.a,{style:r},a.createElement(_e.a,{key:"seeMoreBtn",id:"seemore-btn",title:s,style:n,onClick:e,tabIndex:0,accessibilityLabel:p,describedByElementId:null},a.createElement(u.a,{style:i},l)))}(e.onSeeMoreClick,e.resourceStrings,e.containerStyle,e.buttonStyle,e.seeMoreTextStyle,e.localizedStrings)};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var et=r("s2by"),tt=r("/45f"),rt=r("sgPk"),nt=r("WS0f"),at=r("fE8x");var it=r("Cgjg"),ot=r("FPMG"),st=r("0bF2"),ct=r("bCrZ"),lt=r("Wye+"),ut=r("Ds7n"),pt=r("d26+"),dt=r("7oc5"),ht=r("tcXs"),gt=r("c0jI"),ft=r("t8f4"),mt=r("QAhb"),bt=r("8egQ");var vt=r("5cS+"),yt=r("whwt"),_t=r("ASFs"),St=r("Z46F"),Ot=r("LWFb"),Ct=r("kyRo"),It=r("buKK"),jt=r("+D0h"),Pt=r("6FBX"),Tt=r("LnR7"),xt=r("pLx/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Et(e){return a.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(34)]).then(r.bind(null,"GDLi")).then((function(e){return e.DataSetExpressionBuilder}))},props:e})}Et.displayName="DataSetExpressionBuilderLazyLoadComponent";var Ft=r("/U1C"),wt=r("RrHr"),Nt=r("zpQF"),At=r("/0Gr"),kt=r("TUxu"),Mt=r("/j9Z"),Dt=r("VcAV"),Rt=r("swEE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Lt(e){return a.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(113),r.e(33)]).then(r.bind(null,"pnQ/")).then((function(e){return e.ColumnEditor}))},props:e})}Lt.displayName="ColumnEditorLazyLoadComponent";var Bt=r("2Sll"),Vt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Bt.a)();var Gt=v.x+".DataSetHost",zt=Gt+".AdvancedFind.Open",Wt=Gt+".AdvancedFind.Discard",qt=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindCommandBarId="showQuickFind",r._changeVisualizationCommandBarId="changeVisualization",r._savedDefault=null,r._savedFormInfo=null,r._currentFilterValue=null,r._addedCommandListFromHost=[],r._addedCommandListFromControl=[],r._addedCommandListFromHostParent=[],r._memoizedConfiguration=null,r._memoizedResourceStrings=null,r._memoizedViewConfigurations=null,r._memoizedButtonList=null,r._parentSwitchVisualizationButton=null,r._keyIndex=0,r._width=0,r._height=0,r._isFirstRequestComplete=!1,r._isPreNavigationEventAttached=!1,r._offlineSqlQueryRetrieveState=0,r._dataSetQuickFindRef=a.createRef(),r._isSubGridFirstLoad=!1,r._minWidthForChartPlusGridReflow=640,r._isReflowLayoutVertical=!1,r._isSwitchVisualizationInitialized=!1,r._accessibilityId=1,r._incrementLastPage=function(){r.props.pageNumber===r.state.pagingInfo.lastPageNumber&&r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{lastPageNumber:r.state.pagingInfo.lastPageNumber+1})})},r._setFirstPage=function(e){r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{firstPageNumber:e})})},r._seeMorePopup=r._seeMorePopup.bind(r),r._onSendControlCommandsEventFired=r._onSendControlCommandsEventFired.bind(r),r._onSelectedOrderColumnChangeFired=r._onSelectedOrderColumnChangeFired.bind(r),r._onParentPagePreNavigationEventFired=r._onParentPagePreNavigationEventFired.bind(r),r._onFilterChange=r._onFilterChange.bind(r),r._onActivityTypeMenuDismissed=r._onActivityTypeMenuDismissed.bind(r),r._updateDataSetLoadingStateEvent=r._updateDataSetLoadingStateEvent.bind(r),r._updateFilterValue=r._updateFilterValue.bind(r),r._onRollupViewToggleChanged=r._onRollupViewToggleChanged.bind(r),r._onQuickFind=r._onQuickFind.bind(r),r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onViewChanged=r._onViewChanged.bind(r),r._onControlLoadedError=r._onControlLoadedError.bind(r),r._updatePagingInfo=r._updatePagingInfo.bind(r),r._updateFilterExpressionStrings=r._updateFilterExpressionStrings.bind(r),r._configureDataSetControlParams=r._configureDataSetControlParams.bind(r),r._openManageDuplicatesDialog=r._openManageDuplicatesDialog.bind(r),r._showInnerError=r._showInnerError.bind(r),r._isInSeeMoreState=r._isInSeeMoreState.bind(r),r._getChartPaneText=r._getChartPaneText.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.closeFilterPanel=r.closeFilterPanel.bind(r),r._clearActivityTypeFilter=r._clearActivityTypeFilter.bind(r),r._updateCurrentPageNumber=r._updateCurrentPageNumber.bind(r),r._isNativePlatform=null!=t.platformType&&t.platformType===b.b.Native,r._currentPagingString=null,r._preSeeMoreCachedPagingString=null,r._boundOnRecordsSelected=null,r._pageNumberToRestoreForEnhancedPaging=r.props.pageNumberForEnhancedPaging,r._shouldResetPagingForEnhancedPaging=!1,r._previousSortingInfo=null,r._resetProcessedForEnhancedPaging=!0,r.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,lastPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,currentPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:k.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},r._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[r._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[r._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[r._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[r._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[r._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[r._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[r._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[r._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[r._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(je.e)(t.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:r._onControlLoadedError},r._seeMoreHelper=new m.a,r}return Object(n.__extends)(t,e),t.prototype._logInfo=function(e){this._tracer&&this._tracer.info(e)},t.prototype._updateDataSetLoadingStateEvent=function(e){this._updateDataSetLoadingState(e.value)},t.prototype._updateDataSetLoadingState=function(e,t){var r=this;void 0===t&&(t={}),(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout((function(){r._updateDataSetLoadingState(2)}),3e4)))},t.prototype._openManageDuplicatesDialog=function(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)},t.prototype._showInnerError=function(e){this.props.showInnerError(e)},t.prototype._updatePagingInfo=function(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(_t.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))},t.prototype._updateCurrentPageNumber=function(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)},t.prototype._updateFilterExpressionStrings=function(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){var t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}},t.prototype._setResetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)},t.prototype._resetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)},t.prototype._onControlLoadedError=function(e){var t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()},t.prototype._setControlLoadError=function(e){void 0===e&&(e=P.GRID_CONTROL_LOAD_ERROR),this.setState({controlLoadErrorMessage:Object(w.c)(this.props.resourceStrings,e)})},t.prototype._logTelemetryData=function(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))},t.prototype._renderTitle=function(){if(!this.props.descriptor)return null;var e=this.props.descriptor,t=e.ShowLabel,r=e.Name,n=e.Label,i=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return t&&n?a.createElement(u.a,{key:r,semanticTag:"div",style:i},n):null},t.prototype.onMeasuring=function(e,t){if(this._height=t,!(Math.abs(this._width-e)<50)&&(this._width=e,!this._getCachedSize()||e!==this._getCachedSize().width||t&&t!==this._getCachedSize().height)){var r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),a=this._seeMoreHelper.getSeeMorePopupInfo(),i=n?a.endWidthInner:e,o=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,o.push("isWidthInitialized:"+r.isWidthInitialized));var s=i<=this.props.viewportSm;s!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=s,o.push("isWidthLessThanViewportSm:"+s));var c=i<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,o.push("isWidthLessThanViewportM:"+c));var l=i<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=l,o.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));var u=this._jumpBarShouldRenderAsFlyout(i);u!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=u,o.push("isJumpBarRenderingAsFlyout:"+u));var p=i>480;p!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=p,o.push("isWidthGreaterThan480:"+p));var d=n?a.endHeightInner:t,h=d>240;h!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=h,o.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn("The measuring service returned width or height as 0. The new dimensions are width is "+e+" and height is "+t);var g=!1,f=this.props.quickFindProps&&s&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();f!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=f,o.push("showCommandBarButtonSearch:"+f),g=!0);var m=Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(m!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=m,o.push("showCommandBarButtonShowChart:"+m),g=!0),o.length>0){o.push("currentWidth:"+e),o.push("currentHeight:"+t),o.push("usePoppedOutDimensions:"+n),o.push("newWidth:"+i),o.push("newHeight:"+d),o.push("commandBarNeedsUpdate:"+g);var b=o.join(",");this._logInfo("onMeasuring change: "+b)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:s,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:p,isHeightGreaterThan240:h,showCommandBarButtonSearch:f,showCommandBarButtonShowChart:m}));var v=r;g&&(v=Object.assign(v,this._getUpdateAddedCommandList(f,m))),Object.keys(v).length&&this.setState(v)}},t.prototype._getUpdateAddedCommandList=function(e,t){var r=this;if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(w.c)(this.props.resourceStrings,P.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");var n=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:n,Tooltip:{title:n},Id:"ClearQuery",execute:function(){return r.props.clearQuery()}})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");var a=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:a,Tooltip:{title:a},Id:"ShowChartPane",execute:function(){return r.props.toggleChartPane(r.props.id,r.props.contextToken,!r.props.showChart)}})}return this._onAddedCommandListChange(!1)},t.prototype._onViewChanged=function(e,t,r){var n,a=this;void 0===r&&(r=!0),r&&this._updateDataSetLoadingState(1);var i=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+i),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();var o=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===T.a;this.props.updateView(this.props.id,i,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,o).then((function(){a.props.nonCompositionProps&&a.props.nonCompositionProps.setPageInputViewId&&a.props.nonCompositionProps.setPageInputViewId(e),a.state.controlLoadErrorMessage&&a.setState({controlLoadErrorMessage:null})}),(function(e){a._logInfo(e.message),a._setControlLoadError()}))},t.prototype._onItemIconPointerDown=function(e,t,r,n,a){this._logInfo("“Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+a);var i=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,i,a)},t.prototype._onQuickFind=function(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})},t.prototype._getChartPaneText=function(){var e=this.props,t=e.resourceStrings;return e.showChart?Object(w.c)(t,P.CHARTS_HIDE_CHART_PANE_LABEL):Object(w.c)(t,P.CHARTS_SHOW_CHART_PANE_LABEL)},t.prototype._getClearQueryText=function(){return"Clear query"},t.prototype._updateFilterValue=function(e){this._currentFilterValue=e},t.prototype._onFilterChange=function(e,t){void 0===t&&(t=this.props.gridEntityTypeName),this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);var r=Object(et.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)},t.prototype._clearActivityTypeFilter=function(){this.props.applyActivityTypeFilter("","",this.props.contextToken)},t.prototype._onActivityTypeMenuDismissed=function(e){if(!this.props.isOffline){var t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;for(var r=null,n=[],a=0;a<e.length;a++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[a]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));var a=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Gt,a)}},t.prototype._shouldActivitySelectAllFilterFire=function(e,t,r){if(r){var n=!1,a=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(n=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(a=!0),!(n&&a)}return!0},t.prototype._onRollupViewToggleChanged=function(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)},t.prototype._updateFilterOnViewSelectorChange=function(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)},t.prototype._onSendControlCommandsEventFired=function(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())},t.prototype._onSelectedOrderColumnChangeFired=function(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){var t=e.columnSortingName;t=Object(Te.d)(t,e.columnSortingType,e.primaryNameAttribute);var r=Object(Te.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}},t.prototype._onParentPagePreNavigationEventFired=function(e){var t=this;e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach((function(e){return t.context.Router.registerPreNavigationHandler((function(){try{return e()}catch(e){t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt,e,null,[{name:"subComponent",value:"onPreNavigation"}])}return Promise.resolve(!0)}))})),this._isPreNavigationEventAttached=!0)},t.prototype._createSwitchVisualization=function(e,t){var r=this;return function(){switch(r._keyIndex++,r.props.contextString){case v.h.ASSOCIATEDGRID:r.props.switchAssociatedGridVisualization(r.props.id,r.props.entityTypeName,r.props.controlId,r.props.viewId,e,r.props.nonCompositionProps&&r.props.nonCompositionProps.viewConfigurations,r.props.nonCompositionProps&&r.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case v.h.SUBGRID:r.props.switchSubgridVisualization(r.props.id,e,r.props.controlId);break;case v.h.GRID:default:if(r.props.featureControlProps.isGridPaginationStateFeatureEnabled&&r.props.gridInput){r.props.updateGridPaginationStateHandler([{filterType:3,filterExpressionOrValue:null}],r.props.id),r.props.setCustomFilter("",0,r.props.id,r.props.contextToken)}"VIEW_CONFIG"===t?r.props.switchViewConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!1):r.props.switchHomepageConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!0)}}},t.prototype._updateChangeVisualizationButtons=function(e){var t=this,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,a=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(w.c)(this.props.resourceStrings,P.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],Object(gt.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e).forEach((function(r){if(!(Object(gt.a)(t.props.updatedConfiguration,r.configuration)||r.configuration.isDefaultConfig&&t.props.updatedConfiguration.isDefaultConfig||t.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(oe.g)(r.configuration,parseInt(e,10)))){var n={Icon:"SelectChart",DisplayText:""+Object(gt.b)(t.props.switchVisualizationResourceStrings,r.configuration),Id:t._changeVisualizationCommandBarId+"-"+r.configuration.Name+"-"+r.formFactor,execute:t._createSwitchVisualization(r.configuration,r.configurationType),IsInFlyout:!0};t._memoizedButtonList.push(n),a=!0}}))),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(gt.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,a&&this._onAddedCommandListChange()},t.prototype._onAddedCommandListChange=function(e){var t,r,n,a;void 0===e&&(e=!0);var i=[],o=[],s=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&o.push(this._parentSwitchVisualizationButton),o.push.apply(o,this._addedCommandListFromControl),o.push.apply(o,this._addedCommandListFromHost),(null===(a=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===a?void 0:a.length)>0&&i.push.apply(i,this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&i.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:o,appendedCommandList:i};this&&this.setState&&this.setState({addedCommandList:o,appendedCommandList:i})},t.prototype._seeMoreCallback=function(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})},t.prototype._seeMorePopup=function(e,t){void 0===t&&(t=!1),!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)},t.prototype._getDataSetHostRootElement=function(){return i.findDOMNode(this)},t.prototype._onRecordsSelectedCallback=function(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);for(var r=[],n=0,a=t;n<a.length;n++){var i=a[n];r.push(new S.a(i))}if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){var o=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,o.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))},t.prototype.markGridFirstRequestComplete=function(){this._isFirstRequestComplete=!0},t.prototype._isDataSetHostKnownError=function(e){return!(!e||""===e)&&(-1!==e.indexOf(St.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(St.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))},t.prototype._onDataSetUpdateCallback=function(e){this._logInfo("DataSetUpdated for DataSetHost control");var t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});var r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(Dt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Gt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Gt,t);var n={};if(r)n={compositeControlInitState:k.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);var a=null;if(e.existedFilteringString){var i=JSON.parse(e.existedFilteringString);a=Object(g.j)(i,We.CrmXmlEncode),this.props.setCustomFilter(a,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){var o=[],s=!1,c=null;e.existedValidSortingArrayString&&(c=e.existedValidSortingArrayString);var l=!Object(nt.a)(c)&&JSON.parse(c);if(l&&l instanceof Array&&l.length>0&&c!==this.props.gridSortingInfo&&(this.props.gridInput&&o.push({filterType:7,filterExpressionOrValue:c}),s=!0),s){if(e.existedPagingString){var u=JSON.parse(e.existedPagingString);u.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,u.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(o,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++},t.prototype._configureDataSetControlParams=function(){if(this.props.updatedConfiguration){var e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(nt.a)(e.onRecordsSelected)&&Object(nt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(nt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);var t=this.props.descriptor,r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);var a={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[v.q]&&parseInt(t.Parameters[v.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},i=Object(Ve.a)(this._currentPagingString);if(i&&i.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+i.pageSize),a.pageSize=i.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(a)},this.props.refreshCounter){var o=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(o,10),Static:!0},!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){var s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)){s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}var c=!Object(nt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),l=c&&c instanceof Array&&c.length>0,u=!Object(nt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),p=u&&u instanceof Array&&u.length>0;(l||p&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();var d=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(d&&(d.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){o=this.props.refreshCounter.toString();d.RefreshInput={Value:parseInt(o,10),Static:!0}}}},t.prototype._addExtraParametersToConfiguration=function(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(nt.a)(this._pageNumberToRestoreForEnhancedPaging))){var e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})},t.prototype._renderAccessibilityNotification=function(e){var t,r=e+"_accessibility",n={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(n.overflow="hidden");var i=Object(w.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),o=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":i;return a.createElement(c.a,{key:r+"_"+this._accessibilityId,id:r,style:n,role:Ee.s,notificationType:Ge.b},o)},t.prototype._renderQuickFind=function(){var e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){var t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},a.createElement(Ze,Object(n.__assign)({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(je.g)(this.props.contextString)?a.createElement(c.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null},t.prototype._renderAdvancedFilter=function(){var e=this;return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&a.createElement(_e.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(w.c)(this.props.resourceStrings,Ft.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){e._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(w.c)(this.props.resourceStrings,Ft.c.OpenAdvancedFiltersTitleAndAria)},a.createElement(J.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))},t.prototype._renderAdvancedFindPanel=function(){var e,t=this;this._updateDataSetLoadingState(1);var r=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then((function(){t.setState({isFilterPanelOpen:!0}),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentSuccess(zt,r)}),(function(e){t._tracer.error(null==e?void 0:e.message),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentFailure(zt,new Error(e),r)}))},t.prototype._renderDiscardChanges=function(){var e=this;if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return a.createElement(_e.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(w.c)(this.props.resourceStrings,P.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){var t;e.props.removeEditedViewPageMap(e.props.gridInput.pageToEditedViewMapId.guid,e.props.viewId),e._clearCustomFilterAndUpdateControlKeyIndex();var r=[{name:"entityName",value:e.props.entityTypeName},{name:"ViewId",value:null===(t=e.props.viewId)||void 0===t?void 0:t.guid}];e.context.EventManager.ReportComponentSuccess(Wt,r)},tabIndex:0,accessibilityLabel:Object(w.c)(this.props.resourceStrings,P.AdvancedFilter_DiscardButton_AccessibilityLabel)},a.createElement(J.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))},t.prototype._renderColumnEditor=function(){var e=this;if(this.props.showColumnEditor&&this._isWidthInitialized()){var t=Object(w.c)(this.props.resourceStrings,P.ColumnEditorButton);return a.createElement(Vt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:t,"aria-label":t,onClick:function(){return e.setState({columnEditorPanelOpen:!0})},style:this.props.styles.columnEditorButtonStyle})}},t.prototype._clearCustomFilterAndUpdateControlKeyIndex=function(){var e=this;this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then((function(){e._keyIndex++,e._onViewChanged(e.props.viewId.guid,e.props.entityTypeName,!1)}))},t.prototype._getQuickFind=function(){return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindStyle},a.createElement(Ze,Object(n.__assign)({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))},t.prototype._renderViewSelector=function(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return a.createElement(c.a,{key:"viewSelector",style:e},a.createElement(K,Object(n.__assign)({isGridRoot:Object(je.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()},t.prototype._renderQueueFilter=function(){if((this.props.entityTypeName===Pt.Bb||this.props.entityTypeName===Tt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return a.createElement(ce,Object(n.__assign)({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null},t.prototype._renderEntityFilter=function(){if(this.props.entityFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return a.createElement(fe,Object(n.__assign)({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null},t.prototype._renderDataSetChart=function(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,a.createElement(_,Object(n.__assign)({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null},t.prototype._renderBackButtonForGridInMobile=function(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(je.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null},t.prototype._renderCommandBar=function(){var e=this;if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise((function(t){e._commandBarLoadedResolve=t}))),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(me.a)();var t=this.props.styles.commandManagerContainerStyle,r=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(t=this.props.styles.commandManagerContainerMobileStyle,r=this.props.styles.commandBarMobileInnerStyle);var i=Object(je.e)(this.props.contextString);return Object(Y.b)(this.props.commandBarRefreshProps,r,this._isWidthLessThanViewportSm(),t),a.createElement(ae,Object(n.__assign)({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:t,commandbarStyles:r,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:i,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))},t.prototype._renderFooter=function(){var e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(je.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&!(e=this._shouldRenderSeeMoreButton()))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){var t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object(n.__assign)(Object(n.__assign)({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),a.createElement(c.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null},t.prototype._jumpBarShouldRenderAsFlyout=function(e){var t=Object(w.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET);if(t){var r=t.split(","),n=e-100,a=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+a}return!1},t.prototype._renderJumpBar=function(){var e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?a.createElement(c.a,{key:"jumpBar_"+this.props.id,style:e},a.createElement(Me,Object(n.__assign)({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null},t.prototype._renderPaging=function(e){var t=Object(je.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(nt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?a.createElement(Ue,Object(n.__assign)({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null},t.prototype.renderDataSetHostComponent=function(e,t,r,i,o){var s,u,p,g,m=this,b=[],y=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{var _=this._getDataSetHostErrorMessage();if(Object(nt.a)(_)||this.state.compositeControlInitState===k.a.Initializing){if(this._isWidthInitialized()||Object(je.g)(this.props.contextString)&&this.state.compositeControlInitState!==k.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);var S=(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.entityIsActivityType;y||Object(je.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(je.e)(this.props.contextString)&&(o=Object(n.__assign)(Object(n.__assign)({},o),{display:"none"})),b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],o),this._renderQuickFind(),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===v.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(b.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],o),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===v.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));var O=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;if(this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(je.d)(this.props.contextString)&&(O=Object(n.__assign)(Object(n.__assign)({},O),{flexBasis:"0px"})),this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){O=Object(n.__assign)(Object(n.__assign)({},O),{borderTop:"1px solid #d8d8d8"})}var C=(null===(g=null===(p=null===(u=this.props)||void 0===u?void 0:u.configuration)||void 0===p?void 0:p.Parameters)||void 0===g?void 0:g.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,I=C&&C.Value,j=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(je.g)(this.props.contextString)&&"true"===I;j&&0===this.props.totalResultCount&&(O=Object(n.__assign)(Object(n.__assign)({},O),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&j&&(O=Object(n.__assign)(Object(n.__assign)({},O),{minHeight:"0px"}));var T=y&&Object(je.e)(this.props.contextString),x=this._parentDefinedProps;this.props.parentDefinedControlProps&&(x.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===f.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,x.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===f.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,x.decorators=this.props.parentDefinedControlProps.decorators,x.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),x.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==f.b.NotInUse,x.containerStyleOverrides=this._getCombinedContainerStyleOverrides();var E=null;this.props.chartProps&&this._isWidthInitialized()&&(E={width:"70%"});var F=Ae.a.getInstance().get_IsBrowserIE()?Object.assign(i,{flex:"1 1 100%"}):i;b.push(a.createElement(c.a,{key:"dataSetContentBody_"+this.props.id,style:O},this._renderDataSetChart(),a.createElement(c.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(F,E),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:"data-set-body-container"}},a.createElement(h.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:x,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),T?null:this._renderFooter()))),T&&b.push(this._renderFooter()),b.push(this._renderAccessibilityNotification(e)),b=b.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],o))),this._isWidthInitialized()){var N={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},A=Object(w.c)(this.props.resourceStrings,P.SEE_MORE_DETAILS);b.push(a.createElement(c.a,null,a.createElement(l.a,{id:"gridErrorContainer"+this.props.id,text:_,icon:d.a.DetailsPageClose,iconStyle:N}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&a.createElement(c.a,{style:{display:"flex",justifyContent:"center"}},a.createElement(ye.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:A,onClick:function(){m.props.showInnerError(m.state.controlLoadInnerErrorMessage)}},A))))}var M=Object(n.__assign)(Object(n.__assign)({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return a.createElement(c.a,{style:M,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:(s={id:e},s[Ot.b]=this.props.previewId,s[Ot.c]=20,s),semanticTag:this.props.semanticTag},b)}catch(e){this._onControlLoadedError(e)}},t.prototype._getDataSetHostErrorMessage=function(){var e,t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(w.c)(this.props.resourceStrings,P.OFFLINE_NOT_READY_FOR_USE):Object(w.c)(this.props.resourceStrings,P.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{var r="";this.props.offlineProps.offlineErrorMessageKey&&(r=Object(w.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),r||(r=Object(w.c)(this.props.resourceStrings,P.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=r}else{var n=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,a=Object(w.c)(this.props.resourceStrings,P.UCI_DISABLED_ENTITY_ERROR);t=String.format(a,n)}else t=Object(w.c)(this.props.resourceStrings,P.READ_PRIVILEGE_VIOLATION_KEY);return Object(nt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(Gt+"._getDataSetHostErrorMessage : "+t,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t},t.prototype._renderHeader=function(e,t){void 0===e&&(e=[]);var r=(e||[]).filter((function(e){return!!e}));return r.length?a.createElement(c.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null},t.prototype._getParentDefinedPropsDecoratorValue=function(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]},t.prototype._shouldRenderSeeMoreButton=function(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount},t.prototype._renderSeeMoreButton=function(){var e=Object(je.g)(this.props.contextString),t=Object(je.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),n=Object(je.f)(this.props);return!((e||t)&&!n)||r===f.b.PopFadeIn||r===f.b.PoppedOut||r===f.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):a.createElement($e,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})},t.prototype._getSeeMoreLocalizedStrings=function(){var e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(w.c)(this.props.resourceStrings,P.SEE_ALL_LABEL),seeMoreTooltip:Object(w.c)(this.props.resourceStrings,P.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}},t.prototype._isStreamOnSuiterDashboard=function(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(je.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value},t.prototype._renderProgressIndicator=function(){var e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);var t=Object(n.__assign)({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle),r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object(n.__assign)(Object(n.__assign)({},r),{borderBottom:"none"})),a.createElement(c.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},a.createElement(c.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},a.createElement(p.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))},t.prototype.componentWillUnmount=function(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null},Object.defineProperty(t.prototype,"_tracer",{get:function(){return this.context?this.context.TraceManager.getTracer(v.z):null},enumerable:!1,configurable:!0}),t.prototype._updateStatus=function(e){var t=this;this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout((function(){return t.setState({statusMessage:e})}),1e3))},t.prototype.render=function(){var e,t,r,i,o,s=this;if(Object(nt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==k.a.Error){var l=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!l)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===k.a.Uninitialized){this.setState({compositeControlInitState:k.a.Initializing});var p=this.props.viewId?this.props.viewId:l.ViewId?S.a.parse(l.ViewId):null,d=this.props.gridEntityTypeName||l.TargetEntityType||l.EntityName;if(!d&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo("Initializing grid for "+p+" view and "+d+" entity."),this.props.initializeGrid(p,d,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then((function(){s._logInfo("Initialized grid for "+p+" view and "+d+" entity."),s.setState({compositeControlInitState:k.a.Initialized})}),(function(e){var t=e instanceof Error?e.message:e;-1!==tt.c.indexOf(t)?s._setControlLoadError(t):s._tracer&&s._tracer.error("Grid initialization failed. Reason: "+t),s.setState({compositeControlInitState:k.a.Error})}))}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){var h=this.props.descriptor.Parameters[v.c];if(this._isWidthLessThanViewportSm()&&h&&"false"===h)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(i=this.props.gridInput)||void 0===i?void 0:i.viewType)||this.props.savedQueryType===I.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));var g=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,m="dataSetRoot_"+g,b=this.props.styles,y=b.containerStyle,_=b.headerStyle,O=this.props.styles,C=O.rootStyle,j=O.headerInnerStyle,P=O.bodyStyle;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());var T=y,x={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(P=this.props.styles.bodyMobileStyle,j=this.props.styles.headerInnerMobileStyle);var E=this._seeMoreHelper.getSeeMorePopupStatus(),F=this._seeMoreHelper.getSeeMorePopupInfo();E!==f.b.NotInUse&&(x=f.a.getCustomControlFancyPopoutStyles(this.props.renderer,E,F),E!==f.b.ReturnFadeIn&&(T={height:F.startHeight,width:F.startWidth},C=Object(n.__assign)(Object(n.__assign)({},C),{height:F.endHeightInner-48})));var w=this.renderDataSetHostComponent(m,C,_,P,j),N=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),A=this.props.isRTL,M=function(e,t,r,n,i,o,s,l){void 0===l&&(l=!1);var u=i||o,p="DataSetHostContainer";return a.createElement(c.a,{key:p,id:p+"_"+s,style:u,testhooks:{id:p}},e.renderCloseButton(n,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,w,0,N,x.innerStyle,C,m,A),D=Object(n.__assign)({},x.outerStyle?x.outerStyle:C);0===this.state.loadingState?(D.visibility="hidden",D.maxHeight="0"):1===this.state.loadingState&&(D=Object(n.__assign)(Object(n.__assign)({},D),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));var R=function(e,t,r,n){var i=t||{width:"100%"},o=n?Ee.e:null;return a.createElement(c.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:i,role:o},e)}(M,D,m,(null===(o=this._seeMoreHelper)||void 0===o?void 0:o.getSeeMorePopupStatus())!==f.b.NotInUse),L=function(e,t){return t=t||{display:"none"},a.createElement(c.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(m,x.shadowStyle),B="datassethost_root_view_"+g+"_"+m,V=Ae.a.getInstance().get_IsBrowserIE()&&Object(je.g)(this.props.contextString)?{overflow:"visible"}:{},G=this.props.styles.mobileSubGridContainerStyles,z=Object.assign(T,V);return this._isNativePlatform&&Object(je.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(z=Object(n.__assign)(Object(n.__assign)({},z),G)),a.createElement(c.a,{key:B,style:z},a.createElement(u.a,{role:Ee.s,notificationType:Ge.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),L,R,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&a.createElement(Et,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:function(){s._clearCustomFilterAndUpdateControlKeyIndex(),s.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:Wt,resetAdvancedFilter:function(){return s.setState({isAdvancedFilterEdited:!1})}}),this.props.showColumnEditor&&a.createElement(Lt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:function(){return s.setState({columnEditorPanelOpen:!1})},viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)},t.prototype.componentDidMount=function(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())},t.prototype.closeFilterPanel=function(){this.setState({isFilterPanelOpen:!1})},t.prototype.componentWillReceiveProps=function(e){var t=this;(Object(je.e)(this.props.contextString)||Object(je.g)(this.props.contextString)||Object(je.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then((function(){t._offlineSqlQueryRetrieveState=2;var e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentSuccess&&t.context.EventManager.ReportComponentSuccess(Gt+".componentWillReceiveProps",e)})).catch((function(e){t._offlineSqlQueryRetrieveState=2;var r=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)},{name:"viewType",value:t.props.viewType},{name:"savedQueryType",value:t.props.savedQueryType}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt+".componentWillReceiveProps",e,null,r)}))),this._isShowChartChanged=this.props.showChart!==e.showChart},t.prototype.shouldComponentUpdate=function(e){return this.props.entityTypeName===T.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)},t.prototype.componentDidUpdate=function(){this._seeMoreHelper.getSeeMorePopupStatus()!==f.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());var e=Object(w.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(je.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)},t.prototype._renderAccessibilityComponent=function(e){var t=e+"Accessibility";if(Object(je.e)(this.props.contextString)){var r=[];if(this.props.viewSelectorProps){var n=this.props.viewSelectorProps.id;r.push(a.createElement(xe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:n}))}else r.push(a.createElement(xe.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null},t.prototype._isInSeeMoreState=function(){var e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==f.b.NotInUse&&e!==f.b.ReturnFadeOutAndMove&&e!==f.b.ReturnFadeIn},t.prototype._isNativeSubgrid=function(){return Object(je.g)(this.props.contextString)&&this.props.clientHostSubtype===Rt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled},t.prototype._getCombinedContainerStyleOverrides=function(){var e=this._parentDefinedProps.containerStyleOverrides,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(je.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})},t.prototype._updateViewSelectorProps=function(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){var t=e.descriptor.Parameters[v.B],r=t?t.toString().split(","):null,n=r?r.map((function(e){return S.a.tryParse(e)})):null;e.viewSelectorProps.viewIds=n||null}},t.prototype._getCachedSize=function(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize},t.prototype._isWidthInitialized=function(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1},t.prototype._isWidthLessThanViewportSm=function(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1},t.prototype._isWidthLessThanViewportM=function(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1},t.prototype._isWidthLessThanMinWidthForChartPlusGridReflow=function(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1},t.prototype._isWidthGreaterThan480=function(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1},t.prototype._isHeightGreaterThan240=function(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1},t.prototype._showCommandBarButtonSearch=function(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1},t.prototype._showCommandBarButtonShowChart=function(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1},t.prototype._isJumpBarRenderingAsFlyout=function(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1},t.prototype._hideJumpbarForMobile=function(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020},t.prototype._showNewQuickFindSearchBarForMobile=function(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===v.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===v.m)},t.prototype._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot=function(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(je.e)(this.props.contextString)},t}(a.Component);function Ut(e,t){return a.createElement(qt,Object(n.__assign)({},e,{renderer:t.renderer}))}qt.displayName="DataSetHost",qt.contextType=Ct.a,Ut.contextTypes={renderer:o.object};var Xt=Object(s.a)(je.i,(function(e,t){return{initializeGrid:function(r,n,a,i){var o=rt.a.fromXmlAndSql("","",r).getQueryState(),s=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[v.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[v.s]?parseInt(t.descriptor.Parameters[v.s],10):null;a||(a=Object(oe.c)(t.id,i));var l=e(Object(ct.d)(o,n,t.id,i,t.descriptor,s,c,void 0,a)),u=e(Object(vt.b)(n,r,t.id)),p=e(Object(F.e)(P.labelList));return Promise.all([l,p,u])},removeEditedViewPageMap:function(t,r){return e(Object(wt.c)(t,r.guid))},updatePageInput:function(t,r){return e(Object(Nt.b)(t,r))},updateView:function(r,n,a,i,o,s,c,l,u){var p=e(Object(lt.a)(r,s,n,a,i)).then((function(){return e(Object(ht.a)(r,o))})),d=S.a.tryParseOrNull(a),h=e(Object(vt.b)(i,d,r)),g=Promise.resolve(null);if(u){var f=Object(et.a)(i,c,s,l,!0);g=e(f.getFilterOptionsAction())}return Promise.all([p,h,g]).then((function(){if(Object(je.e)(t.contextString)){t.updateGridPaginationStateHandler([{filterType:0,filterExpressionOrValue:null}],t.id)}e(Object(Oe.m)("",r,s)),e(Object(Oe.n)("",r,s)),e(Object(Oe.j)("",r,s)),e(Object(it.b)("",0,r,s))}))},retrieveView:function(t,r,n,a,i){return e(Object(E.a)(t,r,n,a,!1))},markSelectedRows:function(t,r,n){return e(Object(Le.b)(t,r,n))},markSelectedRelatedEntity:function(t,r,n){return e(Object(Be.b)(t,r,n))},rowProperties:function(t,r,n){return e(Object(ut.b)(t,r,n))},updateFetchXml:function(t,r,n){return e(Object(pt.b)(t,r,n))},applyGridFilter:function(r,n,a){if(Object(je.e)(t.contextString)){var i=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Oe.k)(n,t.id,a)),e(Object(Oe.l)(r,t.id,a))},applyActivityTypeFilter:function(r,n,a){if(Object(je.e)(t.contextString)){var i=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Oe.h)(n,t.id,a)),e(Object(Oe.i)(r,t.id,a))},onSelectedOrderColumnChange:function(r,n){e(Object(Oe.o)(r,t.id,n))},toggleGridRollupView:function(r,n){e(Object(dt.b)(r,t.id,n))},updatePagingData:function(t,r,n){return e(Object(ot.b)(t,r,n))},updateQueryKey:function(t,r,n){e(Object(st.b)(t,r,n))},setCustomFilter:function(t,r,n,a){return e(Object(it.b)(t,r,n,a))},runOnRecordSelect:function(r,n,a){e(function(e,t,r,n,a){return{type:"dataset.run.on.record.select",sync:!0,execute:function(a,i){var o=a.dispatch,s=a.getState,c=i.TraceManager.getTracer(v.z),l=v.x+".RunOnRecordAction";try{if(i&&i.ScriptManager){var u=i.ScriptManager.getContainer(e);if(u&&n&&1===n.length){var p=Object(at.c)(s()),d=Object(at.b)(s());p&&(o(u.getEventManager().addGridOnRecordSelectHandlers(t)),o(u.getEventManager().addGridOnChangeHandlers(t))),(p||d)&&o(u.getEventManager().runOnRecordSelect(t,r)),c.info("Triggered the action for {0} selected records"+n.length),i.EventManager.ReportComponentSuccess(l)}}}catch(e){var h="Triggered action for selected records failed with error : "+e.message;i.EventManager.ReportComponentFailure(l,Error(h))}}}}(r,n,n.controlName?n.controlName:"entity_control",a,Object(je.e)(t.contextString)||Object(je.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:function(t){return e(Object(At.a)(t))},switchHomepageConfiguration:function(t,r,n,a,i){e(Object(gt.g)(t,r,n,a,i))},switchViewConfiguration:function(t,r,n,a,i){e(Object(gt.i)(t,r,n,a,i))},switchSubgridVisualization:function(t,r,n){e(Object(gt.h)(t,r,n))},switchAssociatedGridVisualization:function(t,r,n,a,i,o,s,c){e(c?Object(gt.f)(t,r,n,a,i,o,s):Object(gt.e)(t,r,n,i,s))},toggleChartPane:function(t,r,n){e(Object(yt.b)(t,r,n))},clearQuery:function(){e(Object(xt.a)())},updateUserDefaultGridView:function(t,r,n,a,i,o){return e(function(e,t,r,n,a,i){return{type:"grid.update.userdefaultview",execute:function(o,s){var c=s.TraceManager.getTracer(v.z),l=v.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");var u=o.getState(),p=new mt.a("usersettings",Object(Ke.q)(u)),d=Object(A.h)(u,e);if(!p||!d.ObjectTypeCode)return Promise.resolve();i&&(t="",r="",a=[],n="");for(var h=[],g=0,f=a;g<f.length;g++){var m=f[g],b=S.a.tryParse(m),y=S.a.externalGuid(b);h.push(y)}var _=String.format("<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>",d.ObjectTypeCode,n||"",1===h.length?h.toString():"",S.a.externalGuid(S.a.tryParse(t)),r);o.dispatch(Object(ft.f)(p,{personalizationsettings:_}));var O={ViewId:t,ViewType:+r,QueueId:a.toString()};return o.dispatch(Object(bt.f)(O,e)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var C="Failed to update user default grid view with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(C))}}}}(t,r,n,a,i,o))},updateCurrentPageNumber:function(t,r,n){return e(Object(Ne.b)(t,r,n))},setNewPageRequested:function(t,r,n){e(Object(Re.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:function(t){var r=t.filter((function(e){return null!=e}));return e(Object(F.e)(r))},updatePageNumberForEnhancedPaging:function(e){if(Object(je.e)(t.contextString)){var r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:function(t){e(Object(It.a)(null,null,mt.a.fromExternalEntityReference(t.entityReference))).then((function(r){if(0===r.status)return e(Object(jt.a)(r.pageId)).then((function(e){"ignore_save"===e.value.param_lastButtonClicked&&t.reject()}))}))},showInnerError:function(r){var n=new Mt.a(r,null,null,null,null,{stack:r+" "+(new Error).stack,message:r});e(Object(kt.a)(t.id,n))}}}))(Ut)},otMa:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return p}));var n=r("rn9m"),a=r("Roat"),i=r("U56z"),o="customcontrol.propertybag.device.isoperationavailable";function s(){return{type:o,execute:function(e,t){return new n.a(t,e).isOperationAvailable(i.b.getBarcodeValue.name)},sync:!0}}function c(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.takePicture.name)},sync:!0}}function l(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureVideo.name)},sync:!0}}function u(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureAudio.name)},sync:!0}}function p(){return{type:o,execute:function(){return!1},sync:!0}}},p5Y6:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("HSdq"),a=r("aGOT"),i=r("Sscr");function o(e){return{type:"form.cancel.async",execute:function(t){var r=t.dispatch,o=t.getState,s=Object(i.j)(o(),e),c=Object(n.ac)(o(),e,s);return r(Object(a.c)(e,c,s)),Promise.resolve()}}}},"pLx/":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("Z1aD"),a=r("45T4");function i(e,t){return Object(n.a)(a.a,{},t,e)}},r0tX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(n||(n={}))},r3Bs:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._traversedPath=e,this._stageId=t}return Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stageId",{get:function(){return this._stageId},set:function(e){this._stageId=e},enumerable:!1,configurable:!0}),e}(),a=r("3INI"),i=r("9r0m"),o=function(){function e(){}return Object.defineProperty(e.prototype,"globalPathAndActiveStage",{get:function(){return this._globalPathAndActiveStage},set:function(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntityIdsByEntityLogicalName",{get:function(){return this._navigationEntityIdsByEntityLogicalName},enumerable:!1,configurable:!0}),e.prototype.InitGlobalPathAndActiveStage=function(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)},e.prototype.UpdateGlobalPathAndActiveStage=function(e,t){this.globalPathAndActiveStage=new n(new a.a(e),t)},e.prototype._updateNavigationDictionary=function(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(var t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}},e}()},r7Ib:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCommandManagerId";function o(e,t,r){return{type:"grid.setCommandManagerId.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(a.z)),u=a.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");var p=Object(n.v)(r);return c(function(e,t,r){return{type:i,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,p)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var d="Updating the command manager id for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(d))}}}}},rbxJ:function(e,t,r){"use strict";r.d(t,"i",(function(){return de})),r.d(t,"g",(function(){return ne})),r.d(t,"e",(function(){return ae})),r.d(t,"d",(function(){return ie})),r.d(t,"f",(function(){return ge})),r.d(t,"h",(function(){return fe})),r.d(t,"c",(function(){return se})),r.d(t,"a",(function(){return pe})),r.d(t,"b",(function(){return ue}));var n=r("c/eZ"),a=r("9r0m"),i=r("swEE"),o=r("NxDw"),s=r("G7N+"),c=r("S2mk"),l=r("UOiB"),u=r("Fas2"),p=r("r2h9"),d=r("lMVv"),h=r("7EJx"),g=r("EGsq"),f=r("Ww2r"),m=r("RlP9"),b=r("z9yS"),v=r("uO/V"),y=r("Gemh"),_=r("Sscr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(){var e=null,t=null,r=null;return function(n,a){var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r=t.parentContextToken;switch(t.contextString){case v.h.ASSOCIATEDGRID:var n=Object(y.gb)(e,t,r);return _.a(r,n.relationshipName,n.ordinal);case v.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);var a=_.p(r,t.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=se(e,t,i,a),a;case v.h.GRID:return _.k(e,t.id);case v.h.CUSTOM:return _.c(r,t.controlId);default:return r}}(n,a);return(r!==o||O(e,s)||O(t,i))&&(e=s,t=i,r=o),e}}function O(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var C=r("jf1O"),I=r("perk"),j=r("/3Li"),P=r("0u+G"),T=r("wV3W"),x=r("DgF7"),E=r("Wg6j"),F=r("WS0f"),w=r("VWqI"),N=r("Ev4I"),A=r("JlqV"),k=r("cZkS"),M=r("qC0c"),D=r("c0jI"),R=r("jigW"),L=r("sOTk"),B=r("7pqb"),V=r("s2by"),G=r("VnpK"),z=r("CIm2"),W=r("+6eZ"),q=r("3/zo"),U=r("oVzJ"),X=r("2OIc"),H=r("/V8d"),K=r("M6d0"),Q=r("Oiu5"),Y=r("/U1C"),J=r("W51q"),Z=r("c56u"),$=r("F2uj"),ee=r("HF9s"),te=r("c96h"),re=r("TCzx");function ne(e){return e===v.h.SUBGRID}function ae(e){return e===v.h.GRID}function ie(e){return e===v.h.ASSOCIATEDGRID}function oe(e){switch(e){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return"div";case v.h.GRID:default:return"section"}}function se(e,t,r,n){var a=r?Object(d.G)(e,r,n.relationshipName):null;if(null===a&&t.descriptor&&t.descriptor.Parameters){var i=t.descriptor.Parameters[v.F.RELATIONSHIP_NAME],o=t.descriptor.Parameters[v.F.TARGET_ENTITY_TYPE];i&&r?a=Object(d.G)(e,r,i):i&&o&&(a=Object(d.G)(e,o,i))}return a}function ce(){var e=null,t=null;return function(r){return e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return[p.a.SUB_GRID,p.a.MAIN_APPLICATION_VIEW];case v.h.GRID:return e.isAdvancedFindView?[p.a.ADVANCED_SEARCH]:[p.a.MAIN_APPLICATION_VIEW];default:return[p.a.MAIN_APPLICATION_VIEW]}}(r)),t}}function le(e){return e&&[e.CustomControlId,e.Name].some((function(e){return-1!==H.a.indexOf(e)}))}function ue(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==l.a.AssociatedGrid&&e.contextTokenType!==l.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return le(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function pe(){var e=null,t=null;return function(r,n,a){if(e&&t===n.CustomControlId)return e;var i=n&&n.CustomControlId?n.CustomControlId:null;if(!i)return null;var o=Object(y.ab)(r,i),s=Object(X.e)(r,i);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){var c=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:c.hasOwnProperty("displayChart")?c.displayChart:ue(a,"displayChart",n),displayCommandBar:c.hasOwnProperty("displayCommandBar")?c.displayCommandBar:ue(a,"displayCommandBar",n),displayIndex:c.hasOwnProperty("displayIndex")?c.displayIndex:ue(a,"displayIndex",n),displayQuickFind:c.hasOwnProperty("displayQuickFind")?c.displayQuickFind:ue(a,"displayQuickFind",n),displayViewSelector:c.hasOwnProperty("displayViewSelector")?c.displayViewSelector:ue(a,"displayViewSelector",n)},t=n.CustomControlId}return e}}function de(){var e,t,r,l,_,O,G,X,H,ue,pe,de,ge,ve,ye,_e,Se,Oe,Ce,Ie,je,Pe,Te,xe,Ee,Fe,we,Ne,Ae,ke,Me,De,Re,Le,Be,Ve,Ge=null,ze=null,We=null,qe=null,Ue="",Xe=null,He=null,Ke=null,Qe=null,Ye=null,Je=null,Ze=null,$e=null,et=(t=null,function(e,r,n,a){var i=t;switch(Object(F.b)(a)&&(a=r.contextString),a){case v.h.ASSOCIATEDGRID:i=Object(u.b)(n);break;case v.h.SUBGRID:i=Object(u.l)(n);break;case v.h.GRID:default:i=Object(u.h)(n)}return i!==t&&(t=i),t}),tt=Object(C.a)(),rt=S(),nt=(r=null,_=null,l=function(e,t,r){var n,i,s,l,u;if(Object(y.ib)(e,t.id,r)){n=Object(y.T)(e,t.id,r);var p=Object(y.qb)(e,n,t.id);i=p&&p.entityLogicalName,u=p&&p.isUserView,s=Object(y.r)(e,t.id,r,i),l=Object(y.s)(e,t.id,r)!==b.a.savedvisualization}else{var d=Object(y.ab)(e,t.configuration.CustomControlId);if(d){var h=t.configuration.Parameters[d];h&&(n=h.ViewId&&new a.a(h.ViewId),i=h.TargetEntityType,s=h.VisualizationId&&new a.a(h.VisualizationId),l=!(!h.IsUserChart||"true"!==h.IsUserChart),u=!(!h.IsUserView||"true"!==h.IsUserView))}}if(!a.a.isNullOrEmpty(n)&&s&&i){var g=Object(y.q)(e,t.id,r),f=Object(y.p)(e,t.id,r),m=Object(y.C)(e,t.id,r),S=he(e,t,r,m,!0),O=Object(y.N)(e,t.id,r),C=e.user&&e.user.userId,I=Object(M.c)(e,k.Zc),j=Object(V.a)(i,C,r,I),P=j&&j.getFilterAndLinkedEntities(m&&m.activityOrQueueFilterValue?m.activityOrQueueFilterValue:void 0),T=P&&null!==P.linkEntities?JSON.stringify(P.linkEntities):null,E=Object(M.a)(e,k.Od,k.h),F=!E||E&&Object(x.a)(e)===o.a.MobileApplication,w=E,N=ie(t.contextString)?Object(c.p)(v.d,i,a.a.toString(n),a.a.toString(s),r.relationshipName,O,l,u,S,T,w):Object(c.t)(v.d,i,a.a.toString(n),a.a.toString(s),O,g,l,f,u,S,T,F,w);if(_){var A=N&&N.CustomControlId?N.CustomControlId:null;if((L=Object(y.ab)(e,A))&&N.Parameters[L]){var D=N.Parameters[L],R=_.Parameters[L];D.ViewId===R.ViewId&&D.VisualizationId===R.VisualizationId&&D.EntityName===R.EntityName&&D.HighchartFilterExpression===R.HighchartFilterExpression&&D.ChartDrillDownParameters===R.ChartDrillDownParameters&&D.ExtraFilters===R.ExtraFilters||(_=N)}}else _=N}else if(_&&i&&!s){var L;A=_.CustomControlId,(L=Object(y.ab)(e,A))&&_.Parameters[L]&&i!==(R=_.Parameters[L]).EntityName&&(_=null)}return _},function(e,t,n){var a=l(e,t,n),i=t.id;return r&&r.configuration===a&&r.id===i||(r={configuration:a,id:i,chartId:v.d,showChart:!0,contextToken:n}),r}),at=(O=null,function(e,t,r,n,a,i){var o=i.commandBarStyle,s=t.id,c=se(e,t,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),l=Object(y.w)(e,s,r);return O&&O.commandManagerId===l&&O.pageId===s&&O.ribbonId===a&&O.relationshipType===c&&O.contextToken===r&&O.style===o||(O={commandManagerId:l,pageId:s,ribbonId:a,relationshipType:c,contextToken:r,style:o}),O}),it=(G=null,X=ce(),function(e,t,r,n,i,o){var s,c=o.viewSelectorStyle,l=a.a.toString(i),u=X(t),d=Object(y.nb)(t.id,l),g=ae(t.contextString),f=g,b=t.contextString,v=Object(y.Z)(e),_=Object(h.g)(e),S=Object(y.qb)(e,i,t.id),O=S?S.title:null,C=p.a.MAIN_APPLICATION_VIEW;ne(b)?C=p.a.SUB_GRID:g&&t.isAdvancedFindView&&(C=p.a.ADVANCED_SEARCH);var I=Object(m.a)(e,n,C),j=I||a.a.EMPTY,P=Object(L.g)(e,null==t?void 0:t.id),T=Object(y.rb)(e,null===(s=null==P?void 0:P.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==i?void 0:i.guid);return G&&G.id===d&&G.entityTypeName===n&&G.selectedViewId===l&&G.queryViewSelectorTypes===u&&G.shouldDisplayNestedViewSelector===f&&G.isRTL===_&&G.defaultViewId===j&&G.isEdited===!!T||(G={id:d,pageId:t.id,title:O,entityTypeName:n,selectedViewId:l,style:c,queryViewSelectorTypes:u,shouldDisplayNestedViewSelector:f,contextString:b,pinnedActivityView:v,isRTL:_,defaultViewId:j,isAdvancedFindView:t.isQueryMode&&t.isAdvancedFindView,isEdited:!!T,pageToEditedViewMapId:null==P?void 0:P.pageToEditedViewMapId}),G}),ot=(H=null,function(e,t,r,n,a){var i=t.id,o=Object(y.G)(e,t),s=Object(h.w)(e),c=a.filterComboStyle,l=Object(L.g)(e,i).entityFilterValue;return H&&H.id===i&&H.entityTypeName===n&&H.filterOptions===o&&H.comboBoxStyle===c&&H.userSetting===s&&l===H.previousValue||(H={id:i,filterOptions:o,entityTypeName:n,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:s,style:null,comboBoxStyle:c,previousValue:l}),H}),st=(ue=null,function(e,t,r,a,i){var o=t.id,s=Object(y.G)(e,t,a),c=Object(Q.a)(e),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,p=i.activityTypeComboBoxStyles,d=Object(R.h)(e,r.relationshipName,ie(t.contextString)),g=!Object(A.b)(e),f=Object(y.kb)(e,o,r),m=Object(h.g)(e),b=Object(T.a)(e),v=Object(L.g)(e,o),_=v.entityFilterValue,S=v.activityTypeFilterValue,O=Object(M.a)(e,k.a,k.h),C=Object(M.a)(e,k.a,k.Lc),j=Object(y.ub)(e,a),P=Object(M.c)(e,k.Zc),x=Object(V.a)(a,e.user.userId,r,P,j),E=x&&x.getFilterLabelResourceKey(),F=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,w=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!ue||ue.id!==o||ue.entityTypeName!==a||ue.filterOptions!==s||ue.comboBoxStyle!==l||ue.dueDatecomboBoxStyle!==u||ue.activityTypecomboBoxStyle!==p||ue.labelStyle!==i.filterLabelStyle||ue.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||ue.isActivityManagementFeatureEnabled!==O||ue.filterOptionsForActivityType!==c||ue.isRollupViewSupported!==d||ue.isOffline!==g||ue.toggleValue!==f||ue.isRTL!==m||ue.theme!==b||ue.previousValue!==_||ue.activityTypePreviousValues!==S||ue.isActivityFilterSelectAllEnabled!==C||ue.entityIsActivityType!==j){var N={isRollupViewSupported:d,isOffline:g,toggleValue:f,onToggleChange:null,isRTL:m,theme:b};ue=Object(n.__assign)({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:p,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:O,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:E,activityTypeFilterLabelResourceString:F,dueDateFilterLabelResourceString:w,isActivityFilterSelectAllEnabled:C,isRTL:m,entityIsActivityType:j},N)}return ue}),ct=(pe=null,de=[1041,2052,3076,1028,1042],function(e,t,r,n,a,i){var o=e.id,s=e.descriptor&&e.descriptor.Id?e.descriptor.Id:null,c=a?JSON.parse(a).conditions[0]:null,l=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){var r=fe(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(f.c)(i,I.JUMPBAR_ALPHABET),c);return de.indexOf(n)>-1?pe=null:pe&&pe.id===o&&pe.contextToken===t&&pe.entityTypeName===r&&pe.selectedFilter===l||(pe={id:o,uniqueId:s,contextToken:t,entityTypeName:r,selectedFilter:l,languageId:n}),pe}),lt=(ge=null,function(e,t,r,n){var a=e.id,i=e.contextString;return ge&&ge.id===a&&ge.contextToken===t&&ge.entityTypeName===r&&ge.gridInput===n||(ge={id:a,contextToken:t,entityTypeName:r,contextString:i,gridInput:n}),ge}),ut=(ve=null,function(e,t,r){var n=e.id,a=e.contextString;return ve&&ve.id===n&&ve.contextToken===t||(ve={id:n,contextToken:t,contextString:a}),ve}),pt=Object(f.h)(),dt=(Se=null,Oe=null,je=null,ke={useSkypeProtocol:Ce={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},gridPageNumber:Ie={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},isNewPageRequested:Pe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},enhancedPagingDisabled:Te={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},isActivityTypeFilterDisabled:xe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},showAddNewCommand:Ee={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptySubgridIconAndTextChanges:Fe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptyGridChangesIfQuickFindImprovementsEnabled:we={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},headerDialogOnTop:Ne={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},headerDialogPreventDismissOnScroll:Ae={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1}},function(e,t,r){var a=Object(x.e)(e),s=Object(g.x)(e).useSkypeProtocol,c=Object(y.x)(e,t.id,r),l=Object(y.X)(e,t.id,r);l||je===c||(je=c),ye||(ye=Object(j.a)(e),_e=null!=ye&&ye===P.b.Native);var u=!_e,p=Object(M.a)(e,k.a,k.h),d=t.systemDefinedProperties,h=c!==je&&l,f=u!==Te.Value,m=!1;p&&(ie(t.contextString)||ae(t.contextString))&&(m=!0);var b=!1;Object(U.a)(e)&&ne(t.contextString)&&(b=!0);var v=!1;Object(U.a)(e)&&Object(M.c)(e,k.Md)&&ne(t.contextString)&&Object(x.a)(e)===o.a.MobileApplication&&(v=!0);var _=!1;if(Object(U.a)(e)&&Object(M.c)(e,k.ad)&&ae(t.contextString)&&Object(x.a)(e)===o.a.MobileApplication){var S=Object(y.C)(e,t.id,r);(null==S?void 0:S.quickFind)&&(_=!0)}var O=!ae(t.contextString)&&i.a.Tablet===a,C=i.a.Tablet===a&&!ie(t.contextString)||"Web"===Object(x.k)(e)&&!re.a.getInstance().get_IsAndroid()&&!re.a.getInstance().get_IsWindows()&&!re.a.getInstance().get_isIPhone();if(a!==Se||s!==Oe||h||f||l!==Pe.Value||m!==xe.Value||b!==Ee.Value||v!==Fe.Value||_!==we.Value||O!==Ne.Value||C!==Ae.Value){Se=a,Oe=s,Ie.Value=c,je=c,Pe.Value=l,Te.Value=u,xe.Value=m,Ee.Value=b,Fe.Value=v,we.Value=_,Ne.Value=O,Ae.Value=C;var I=null==Se?s:null;(I!==Ce.Value||h||f)&&(Ce.Value=I,ke=Object(n.__assign)(Object(n.__assign)({},d),{useSkypeProtocol:Ce,gridPageNumber:Ie,isNewPageRequested:Pe,enhancedPagingDisabled:Te,isActivityTypeFilterDisabled:xe,showAddNewCommand:Ee,emptySubgridIconAndTextChanges:Fe,emptyGridChangesIfQuickFindImprovementsEnabled:we,headerDialogOnTop:Ne,headerDialogPreventDismissOnScroll:Ae}))}return ke}),ht=(Me=null,De=null,function(e,t,r){return e&&(De&&Me===e&&!r||(De=Object(n.__assign)({},e),e.Parameters&&(De.Parameters=Object(n.__assign)({},e.Parameters),t&&e.Parameters[t]&&(De.Parameters[t]=Object(n.__assign)({},e.Parameters[t]),e.Parameters[t].Columns&&(De.Parameters[t].Columns=e.Parameters[t].Columns.slice(0)))),Me=e)),De}),gt=Object(E.s)(),ft=(Re=[],function(e,t,r,n,a,i,o,s,c,l,u){return Re&&Re.length&&Re.splice(0,Re.length),Re.push({name:B.b.IsGridRoot,value:e},{name:B.b.IsSubGrid,value:t},{name:B.b.IsAssociatedGrid,value:r},{name:B.b.EntityName,value:n},{name:B.b.ViewId,value:a},{name:B.b.IsEmptyFetch,value:i},{name:B.b.IsEmptyOfflineSqlQuery,value:o},{name:B.b.IsValidFetchXmlForOfflineUsage,value:s},{name:B.b.IsEntityAvailableForOfflineUsage,value:c},{name:B.b.OfflineConfigurationErrorCode,value:l},{name:B.b.RelatedEntityUnavailableOffline,value:u}),Re}),mt=(Le=null,function(e){return Le||(Le={isGridPaginationStateFeatureEnabled:Object(M.a)(e,k.zb),isAssociatedGridHeightEnabled:Object(R.e)(e),isChartOnAssociatedGridEnabled:Object(M.a)(e,k.x,k.h,k.i),isGridProgressIndicatorFeatureEnabled:Object(M.a)(e,k.Ab),isInMobileModeForOct2019:Object(U.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(M.a)(e,k.ac),isJumpbarFeatureForMobileEnabled:Object(M.c)(e,k.Kb),isSuiterChartEnabled:Object(M.a)(e,k.Od,k.h),isSuiterDashboardEnabled:Object(M.a)(e,k.Pd,k.h),isAdvancedFindEnabled:Object(J.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(M.c)(e,k.O),isInMobileModeForApril2020:Object(U.a)(e),isSubgridImprovementsEnabled:Object(M.c)(e,k.Md),isSubGridAutoCollapseEnabled:Object(M.a)(e,k.Jd,k.Lc),isSubGridRemoveMinHeightEnabled:Object(M.a)(e,k.Ld,k.Lc),isQuickFindImprovementsEnabled:Object(M.c)(e,k.ad),isShowAsButtonFirstEnabled:Object(M.c)(e,k.Bd),isColumnEditorButtonEnabled:Object(y.tb)(e),isQueueFilterPerfUCIEnabled:Object(M.c)(e,k.Zc)}),Le}),bt=(Be={fetchXML:null,entityName:null,isOffline:null},Ve={error:!1,errorCode:null,relatedEntityUnavailableOffline:null},function(e,t,r,n){if(Be.entityName!==r||Be.fetchXML!==t||Be.isOffline!==n)if(Object(N.k)(r)){var a=Object(N.b)(e,t);Ve={error:a.error,errorCode:a.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:a.relatedEntityUnavailableOffline},Be={fetchXML:t,entityName:r,isOffline:n}}else Ve={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},Be={fetchXML:t,entityName:r,isOffline:n};return Ve});return function(t,r){var i,o=Object(h.w)(t),c=rt(t,r),l=Object(y.v)(t,r.id,c),u=c.relationshipName,b=c.roleOrd,_=Object(y.N)(t,r.id,c),S=Object(y.I)(t,r.id,c),O=Object(y.x)(t,r.id,c),C=r.descriptor,E=be.bind(null,r,C),B=r.configuration,G=B&&B.CustomControlId?B.CustomControlId:null,U=Object(j.a)(t),X=Object(x.e)(t),H=Object(y.ab)(t,G)||(r.contextString===v.h.CUSTOM?v.g:null),Q=ae(r.contextString),J=mt(t),re=Object(y.A)(t,c,r),se=null,ce=!1,ue=null,pe=Object(y.t)(t,r.id,c),de=Object(y.C)(t,r.id,c);Q&&(se=Object(L.g)(t,r.id),J.isGridPaginationStateFeatureEnabled&&((ue=se.gridSortingInfo)&&(Object(F.a)(Qe)||Qe!==ue)&&(Qe=ue,ce=!0),pe&&(Object(F.a)(Ye)||Ye!==pe.customFilterXml)&&(Ye=pe.customFilterXml,ce=!0)),(de&&Object(F.a)(Je)||Je!==de)&&(Je=de,ce=!0));var ge=ht(B,H,ce),fe=ge&&ge.Parameters?ge.Parameters[H]:null,ve=ie(r.contextString),ye=ne(r.contextString),_e=!Object(A.b)(t),Se=Object(y.jb)(t,c,r),Oe=fe&&!!fe.DataProvider,Ce=fe&&!!fe.BoundViewParams,Ie=Object(g.x)(t),je=Ie&&Ie.gridTotalRecordCountLimit?Ie.gridTotalRecordCountLimit:5e3,Pe=Object(y.ib)(t,r.id,c),Te=le(r.configuration),xe=le(r.configuration);if(null!=r.nonCompositionProps){var Ee=B&&B.FormFactor&&B.FormFactor.toString(),Fe=Object(D.c)(r.nonCompositionProps.gridConfigurations,r.nonCompositionProps.viewConfigurations,B,null,v.h.GRID,Ee).map((function(e){return e.configuration.DisplayNameKey})),we=pt(t,Fe);(!Ke&&""!==Object(f.c)(we,Fe[0])||Ke!==we)&&(Ke=we)}var Ne=!!l,Ae=Object(y.T)(t,r.id,c)||(C&&C.Parameters&&C.Parameters.ViewId?a.a.parse(C.Parameters.ViewId):null),ke=Object(y.qb)(t,Ae,r.id),Me=(null==ke?void 0:ke.isUserView)?p.b.userview:p.b.savedview,De=null==ke?void 0:ke.queryType,Re=null==ke?void 0:ke.entityLogicalName;Re&&Re!==We&&(We=Re);var Le=Object(d.h)(t,We),Be=!_e&&U===P.b.Web&&Q&&J.isAdvancedFindEnabled&&(null==Le?void 0:Le.IsValidForAdvancedFind);if(!He||e!==Be){var Ve=Object(n.__spreadArrays)(I.labelList);Be&&(Ve=Object(n.__spreadArrays)(Ve,[Y.c.OpenAdvancedFiltersTitleAndAria]));var vt=pt(t,Ve);""!==Object(f.c)(vt,I.JUMPBAR_ALL_TITLE)?(He=vt,e=Be):Ne=!1}var yt=Object(y.W)(t,G);yt&&yt!==Xe&&(Xe=yt);var _t=tt(t,r);le(r.configuration)&&(Object.assign(_t.bodyStyle,{flexDirection:"column"}),Object.assign(_t.bodyMobileStyle,{flexDirection:"column"}));var St=Object(y.F)(t,r.id,c)||(C&&C.Parameters&&C.Parameters[v.u]?C.Parameters[v.u]:null),Ot=St;Q&&(Ot=se.entityTypeName);var Ct=Object(w.b)(t,St);Le&&Le.Initialized===s.a.Initialized||Oe||Ce||(Ne=!1);var It=Le?Le.DisplayName:"",jt=Object(g.t)(t),Pt=Object(d.i)(t,St),Tt=!(ke&&ke.fetchXML),xt=ke&&ke.viewId,Et=bt(t,Tt?"":ke.fetchXML,We,_e),Ft=!Tt&&!Et.error,wt=null!=ke&&Object(F.b)(ke.offlineSqlQuery),Nt=Object(N.l)(t,We),At=ft(Q,ye,ve,We,xt?xt.guid:null,Tt,wt,Ft,Nt,Et.error&&Et.errorCode||"",Et.error&&Et.relatedEntityUnavailableOffline||""),kt=!((Q||ve||ye)&&ke&&ke.fetchXML&&_e&&Nt)||!wt&&Ft,Mt="";if(kt?Nt||(Mt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):wt?Mt=I.SQL_QUERY_NOT_AVAILABLE:Et.error&&(Mt=Et.errorCode),fe){fe.TargetEntityType&&St!==fe.TargetEntityType&&(St=fe.TargetEntityType),fe.ExtraFilters=he(t,r,c,de,!1);var Dt=function(e,t,r,n,a){var i=[],o=Object(y.q)(e,t.id,r);if(o){var s=JSON.parse(o);if(s.conditions)for(var c=0,l=s.conditions;c<l.length;c++){var u=l[c];u.linkEntityExpressions&&(i=i.concat(u.linkEntityExpressions))}}var p=e.user&&e.user.userId,d=Object(M.c)(e,k.Zc),h=Object(y.ub)(e,n),g=Object(V.a)(n,p,r,d,h),f=g&&g.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:z.a,a&&!a.activityOrQueue);f&&f.linkEntities&&(i=i.concat(f.linkEntities));return(f=f||{filter:null,linkEntities:null}).linkEntities=i,f}(t,r,c,St,de);if(Dt&&Dt.filter&&(fe.ExtraFilters?fe.ExtraFilters.push(JSON.stringify(Dt.filter)):fe.ExtraFilters=[JSON.stringify(Dt.filter)]),Dt&&Dt.linkEntities&&Dt.linkEntities.length>0){var Rt={Static:!0,Value:Object(W.b)(Dt.linkEntities)};if(fe.LinkingInput){Rt=fe.LinkingInput;var Lt=Object(W.a)(fe.LinkingInput.Value);if(Lt){var Bt=new q.a;Lt.forEach((function(e){Bt.addLinkedEntity(e)})),Dt.linkEntities.forEach((function(e){Bt.addLinkedEntity(e)})),Rt.Value=Object(W.b)(Bt.getLinkedEntities())}}fe.LinkingInput=Rt}if(Ae){var Vt=a.a.toString(Ae);Vt!==fe.ViewId&&(fe.ViewId=Vt)}else Ae=a.a.tryParseOrNull(fe.ViewId);(C&&C.Parameters?"false"===C.Parameters[v.F.ENABLE_CONTEXTUALACTIONS]:null)&&(ge.Parameters[v.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}St&&St!==qe&&(qe=St);var Gt=Object(d.r)(t,St)&&r.contextString===v.h.GRID?y.a:St,zt=fe&&fe.CommandBarContext,Wt=et(t,r,Gt,zt),qt=function(e,t,r){var n=Object(y.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(t,Ae,r.id),Ut=null==qt?void 0:qt.map((function(e){return e.name})),Xt=null==ze?void 0:ze.map((function(e){return e.name}));(JSON.stringify(Ut)!==JSON.stringify(Xt)||(Ae&&Ae.guid)!==(Ge&&Ge.guid)||u===Ze&&b!==$e)&&(Ge=Ae,$e=b,Ue=(C&&C.Id?C.Id:"")+(new Date).getTime(),ze=qt),u&&u!==Ze&&(Ze=u);var Ht=Object(y.o)(t,St),Kt=Ht?Ht.lookupAttribute:null;fe&&(function(e,t,r,n,a,i,o){var s=Object(d.h)(e,n);if(s&&le(t.configuration)){var c=v.b;r.Columns||(r.Columns=[]),n!==y.a||a&&a.some((function(e){return e.name===c}))||r.Columns.find((function(e){return e.Name===c}))||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});var l=s&&s.PrimaryNameAttribute,u=a&&a.some((function(e){return e.name===l}));if(!l||u||r.Columns.some((function(e){return e.Name===l}))||r.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(t.configuration.Parameters)){var p=Object(R.a)(s.PrimaryImageAttribute);p&&!r.Columns.find((function(e){return e.Name===p}))&&r.Columns.push({Alias:K.d,DataType:"SingleLine.Text",Type:"",Name:p}),Object(M.a)(e,k.ub)&&i&&o&&(r.Columns.find((function(e){return e.Name===y.c}))||r.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),r.Columns.find((function(e){return e.Name===i}))||r.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(t,r,fe,St,ze,Kt,!Object(F.a)(se)),function(e,t,r,n,a){if(!Object(y.vb)(t.configuration.Parameters))return;(null==a?void 0:a.some((function(t){var r;return(null===(r=Object($.a)(e,n,t.name))||void 0===r?void 0:r.Type)===ee.a.moneyType})))&&(r.Columns.some((function(e){return e.Alias===v.A}))||r.Columns.push({Alias:v.A,DataType:"Lookup.Simple",Type:"",Name:K.w}))}(t,r,fe,St,ze));var Qt=!St||(Object(w.i)(St)||Object(w.g)(t,St,2,0)&&function(e,t){var r=!0;t&&t.forEach((function(t){if(t.relatedEntityName&&!(r=Object(w.g)(e,t.relatedEntityName,2,0)))return!1}));return r}(t,ze)),Yt=Object(y.Y)(t,r.id,c),Jt=Yt?JSON.parse(Yt):null,Zt=Jt?Jt.totalResultCount:null,$t=Jt?Jt.pageSize:null,er=null!==Zt&&Zt>-1?0===Zt?Object(f.c)(He,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Zt):"",tr=gt(t,Q),rr=!(null!=U&&U===P.b.Native),nr=Object(y.rb)(t,null===(i=null==se?void 0:se.pageToEditedViewMapId)||void 0===i?void 0:i.guid,null==Ae?void 0:Ae.guid),ar={isEmptyOfflineSqlQuery:wt,isEntityAvailableForOffline:Nt,isOfflineSqlQueryAvailable:kt,offlineErrorMessageKey:Mt,isOfflineAvailableForUse:Object(Z.w)(t),offlineGridErrorTelemetryParams:At},ir=Object(te.d)(t),or=Object(m.c)(t,Ge),sr=!_e&&U===P.b.Web&&Q&&J.isColumnEditorButtonEnabled&&!ve&&!ye,cr=Object(y.ub)(t,St);return{showAdvancedFilter:Be,isViewEdited:!!nr,isInitialized:Ne,viewId:Ge,customFilter:pe,gridEntityTypeName:We,chartEntityTypeName:We,isUCIEntity:Ct,totalRecordCountLimitExceeded:Se,chartProps:Pe?nt(t,r,c):null,viewDescriptor:ke,commandBarProps:E(v.E.COMMANDBAR_ENABLED,!0,v.F.ENABLE_CONTEXTUALACTIONS,H,!0)?at(t,r,c,C,Wt,_t):null,viewSelectorProps:Ot&&E(v.E.VIEWSELECTOR_ENABLED,!0,v.F.ENABLE_VIEW_PICKER,H)?it(t,r,c,Ot,Ge,_t):null,queueFilterProps:B&&E(null,!0,v.F.ENABLE_QUEUEFILTER,H)?ot(t,r,c,St,_t):null,entityFilterProps:_e||!cr&&!Object(R.h)(t,Ze,ve)?null:st(t,r,c,St,_t),jumpBarProps:E(v.E.JUMPBAR_ENABLED,Te,v.F.ENABLE_JUMPBAR,H)&&me(r)?ct(r,c,St,o.languageId,de?de.jumpBar:null,He):null,quickFindProps:E(v.E.QUICKFIND_ENABLED,!0,v.F.ENABLE_QUICKFIND,H)?lt(r,c,St,se):null,pagingProps:E(v.E.PAGING_ENABLED,xe,null,H)?ut(r,c,St):null,contextToken:c,controlKey:Ue,styles:_t,refreshCounter:_,pagingRefreshInput:S,pageNumber:O,ribbonId:Wt,semanticTag:oe(r.contextString),recordsPerPageSetting:Object(h.h)(t),userSetting:o,hasReadRolePrivilege:Qt,resourceStrings:He,switchVisualizationResourceStrings:Ke,entityTypeName:qe,primaryDataSetName:H,nestedGridDatasetName:Xe,viewportSm:Object(T.a)(t).sizes.Breakpoints.DimensionS,viewportM:Object(T.a)(t).sizes.Breakpoints.DimensionM,systemDefinedProperties:dt(t,r,c),platformType:Object(j.a)(t),isGridEditable:Object(y.vb)(B?B.Parameters:null),notificationMessage:er,totalResultCount:Zt,pageSize:$t,offlineProps:ar,isRTL:Object(h.g)(t),entityDisplayName:It,isOffline:_e,showChart:Pe,entityIconVectorName:Pt,webResourceUrl:jt,hasCustomDataProvider:Oe,commandBarRefreshProps:tr,updatedConfiguration:ge,offlineGridErrorTelemetryParams:At,gridInput:se,gridTotalRecordsCountLimit:je,gridSortingInfo:ue,nativeFilterExpression:J.isGridPaginationStateFeatureEnabled&&se?se.nativeFilterExpression:null,pageNumberForEnhancedPaging:J.isGridPaginationStateFeatureEnabled&&!rr&&se?se.gridPageNumber:null,userId:t.user&&t.user.userId||null,lookupAttributeForRecordHierarchy:Kt,fetchXML:re,viewType:Me,savedQueryType:De,featureControlProps:J,clientHostSubtype:X,backButtonEnabled:ir,originalView:or,showColumnEditor:sr,entityIsActivityType:cr}}}function he(e,t,r,n,a){if(!n)return[];var i=ae(t.contextString),o=ie(t.contextString),s=ne(t.contextString)&&Object(M.c)(e,k.bd),c=[];for(var l in n)c.push([l,n[l]]);var u=c.reduce((function(e,t){var r=t[0],n=t[1];return(i||o||s)&&"quickFind"===r||("activityOrQueueFilterValue"===r||"activityTypeSelectedValues"===r)||!n||e.push(n),e}),[]);if(a){var p=Object(y.t)(e,t.id,r);if(p&&p.customFilterXml){var d=Object(G.i)(p.customFilterXml),h=JSON.stringify(d);h&&u.push(h)}}else{var g=Object(y.q)(e,t.id,r);g&&u.push(g)}return u}function ge(e){var t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function fe(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));var t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function me(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function be(e,t,r,n,a,i,o){var s=e.dataSetUIOptions,c=n;if(o=!!Object(F.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){var l=e.configuration.Parameters[i];l&&l[v.f]&&(s=l[v.f])}var u=t&&t.Parameters&&t.Parameters[a]?"true"===t.Parameters[a]:o;return s&&r&&!Object(F.a)(s[r])&&(c=s[r]),c&&u}},slAZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"e",(function(){return l}));var n=r("Sscr"),a="controls.addCustomFilter",i="controls.startCustomFilter",o="controls.endCustomFilter";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:{customFilter:o,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,r){var a=Object(n.v)(r);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}function l(e,t,r){var a=Object(n.v)(r);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}},uCYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="footer.visible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},vqdi:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r("OROb"),a=r("lMVv"),i=r("sgPk"),o=r("C8Q/"),s=r("ig6i"),c=r("cm3g"),l=r("9r0m"),u=r("HSdq"),p=r("Sscr"),d=r("sOTk"),h=r("Gemh"),g=r("0hZT"),f=r("fE8x"),m=r("r454"),b=r("cZkS"),v=r("qC0c"),y=r("EcZf"),_=r("YEEA");function S(e,t,r,S,O,C,I,j){return void 0===I&&(I=!1),{type:"embeddedEntity.save",execute:function(S,P){var T,x=S.getState(),E=new l.a(r),F=Object(p.f)(j,E,t);switch(Object(d.l)(x,e)){case g.a:T=Object(h.R)(x,e,F);break;default:T=Object(u.ac)(x,e,F)}var w=Object(f.c)(x),N=Object(f.b)(x);if((w||N)&&"Dashboard"!==Object(d.l)(x,e)){var A=P.ScriptManager.getContainer(e).getEventManager();if(S.dispatch(A.runOnSave(j,1,null,r)))return Promise.reject(Object(_.b)(x,e,2200000005,""))}return S.dispatch(Object(n.c)(T,I,O)).then((function(n){var u=Object(h.qb)(x,new l.a(C),e),p=Object(a.h)(x,t),d=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,S.getState);return d.where(new o.a("eq",new s.a(t,p.PrimaryIdAttribute),new c.a(r))),S.dispatch(Object(y.d)(d.getQueryState())).then((function(){return n}))})).catch((function(e){return Object(v.a)(x,b.xb)&&T&&S.dispatch(Object(m.b)(T,!1)),Promise.reject(e)}))}}}},w82B:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r("cZkS"),a=r("9r0m"),i=r("G7N+"),o=r("9LTA"),s=r("8Fmj"),c=r("7dGM"),l=r("dUXI"),u=r("y5DA"),p=r("gBKR"),d=r("mGpW"),h=r("olrR"),g=r("Ww2r"),f=r("RlP9"),m=r("kl3Z"),b=r("+Z9T"),v=r("vUcA"),y=r("Z46F"),_=r("WS0f"),S=r("KDdL"),O=r("8ADW");function C(e,t,r){return{type:"chartData.retrieve.preReq_async",execute:function(n,C){var I=n.dispatch,j=n.getState,P=j(),T=O.b+".chartData.retrieve.preReq_async",x=e.visualizationId,E=e.viewId;return I(Object(h.a)(t,void 0,e.viewType,E)).then((function(){P=j();var n=Object(f.c)(P,E);if(!function(e,t,n,a){if(!n||!n.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),a,r),!1;return!0}(P,I,n,e))return Promise.resolve(null);var h=I(Object(s.a)(t,e.visualizationType,x)),b=I(Object(d.e)(l.A));return Promise.all([h,b]).then((function(){var t,s;P=j();var h=Object(c.a)(P,x);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(h))return Object(o.d)(P,I,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,a){if(n){if(n.initialized===i.a.Error){var o=Object(v.a)(n.errorCode)||l.u;return t(Object(d.e)([o])).then((function(){var n=Object(g.b)(e,o);Object(u.a)(e,t,n,a,r)}),(function(){Object(u.a)(e,t,Object(g.b)(e,l.u),a,r)})),!1}return!!n.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),a,r),!1)}return!1}(P,I,h,e))return Promise.resolve(null);e.initialized||(e.initialize(h.DataDescription,n.fetchXML,h.PresentationDescription,n.title,n.entityLogicalName,h.Name,h.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());var f={},b=e.dataDefinition.allAttributeNamesByEntity;Array.from(b.keys()).map((function(e){var t=Array.from(b.get(e).keys());f[e]=t}));var y=Object(m.c)(n).filter((function(e){return-1===e.indexOf(".")}));if(y&&y.length>0){var O=n.entityLogicalName;O in f?(t=f[O]).push.apply(t,y):f[O]=y}try{var E=h.PresentationDescription,F=Object(S.a)(E);if(!Object(_.b)(E)&&F.length>0){var w=n.entityLogicalName,N=[];N.push(function(e,t){var r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(w,F)),w in f?(s=f[w]).push.apply(s,N):f[w]=N}}catch(e){var A="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;C.EventManager.ReportComponentFailure(T,Error(A))}return I(Object(p.e)(f)).then((function(){return e}))}),(function(t){return Object(u.b)(t.getNegativeErrorCode(),j(),I,Object(g.b)(j(),l.q),e,r),Promise.resolve(null)}))}),(function(t){var n=t&&!Object(b.a)(t.errorCode)&&t.errorCode,a=Object(v.a)(n),i=a?Object(g.b)(P,a):"retrieve chart failed. error code: "+y.a.getHexErrorCodeFromInt(n);return Object(u.a)(P,I,i,e,r),Promise.resolve(null)}))}}}var I=r("Fpc+"),j=r("qC0c");function P(e,t,r,s){return void 0===s&&(s=!1),{type:"chartData.retrieve.async",execute:function(l,u){var p=l.dispatch,d=l.getState,h=[];try{h.push({name:O.g,value:a.a.toString(e.viewId)}),h.push({name:O.h,value:a.a.toString(e.visualizationId)});var g=d(),f=e.visualizationId,m=a.a.toString(f),b=e.viewId,v=a.a.toString(b);if(!Object(S.b)(d,p,u,h,e,t,r))return Promise.resolve();var y=void 0,_=Object(j.c)(g,n.rd);return((y=_?Object(c.e)(g,e.getStorageKey()):Object(c.d)(g,m,v))===i.a.Initialized&&Object(c.b)(g,m,v)||y===i.a.Initializing)&&!s?Promise.resolve():(p(_?Object(S.d)(e.getStorageKey(),I.c):Object(S.c)(m,v,I.c)),p(C(e,t,r)).then((function(e){if(!e||e.isWebResourceChart)return Promise.resolve();var n=e;return p(Object(o.b)(n,t,r))})))}catch(e){return u.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(e),O.b,h),Promise.reject(e)}}}}},whwt:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return y}));var n=r("Sscr"),a=r("uO/V"),i=r("8Fmj"),o=r("RlP9"),s=r("9r0m"),c=r("Gemh"),l=r("7dGM"),u=r("lMVv"),p=r("Zdrd"),d=r("cqI9"),h=r("z9yS"),g=r("mGpW"),f=r("dUXI"),m=r("JlqV"),b=r("zETL"),v="chart.showChart.update";function y(e,t,r){return{type:"chart.showChart.update.async",execute:function(v,y){var S=v.dispatch,O=v.getState,C=y.TraceManager.getTracer(a.z),I=a.x+".updateShowChartAction";try{C.info("Updating the show chart"),t||(t=Object(n.k)(O(),e));var j=O(),P=Object(n.v)(t),T=Object(c.T)(j,e,t),x=Object(o.c)(j,T),E=x&&x.entityLogicalName,F=Object(c.r)(j,e,t,E),w=Object(c.s)(j,e,t),N=Object(l.a)(j,F),A=N&&N.PrimaryEntityTypeCode,k=A&&Object(u.m)(j,parseInt(A,10));E&&k&&E!==k&&(F=null,w=h.a.savedvisualization);var M=Object(l.i)(j,E);if(F&&M&&M.chartTypes&&Object.keys(M.chartTypes).length>0){var D=s.a.toString(F);w=D in M.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}return r?Object(m.b)(O())?(S(Object(g.e)(f.A)).then((function(){S(Object(i.a)(E,w,F)).then((function(r){return s.a.isNullOrEmpty(r)?(w=h.a.uservisualization,S(Object(p.b)(e,t,w)).then((function(){return S(Object(i.a)(E,w,F)).then((function(e){return Promise.resolve(e)}))}))):Promise.resolve(r)})).then((function(n){var a=s.a.toString(n);Promise.all([S(Object(d.b)(e,t,a)),S(Object(p.b)(e,t,w)),S(_(e,P,r))]).then((function(){return y.EventManager.ReportComponentSuccess(I),S(Object(b.b)(e,t)),Promise.resolve()}))}))})).catch((function(e){return y.EventManager.ReportComponentFailure(I,Error("Retrieve resource strings for chart failed")),Promise.reject(e)})),Promise.resolve()):Promise.resolve():(S(_(e,P,r)),y.EventManager.ReportComponentSuccess(I),Promise.resolve())}catch(e){var R="Update the show chart failed with error : "+e.message;y.EventManager.ReportComponentFailure(I,Error(R))}}}}function _(e,t,r){return{type:v,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},x6Ak:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="refresh.timer";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:i,controlName:r}}}},xirW:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("UOiB"),a=r("Sscr"),i=r("krRo"),o="attribute.notification.update";function s(e,t,r,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute:function(e,l){e.dispatch(function(e,t,r,s){if(s&&s.contextTokenType&&s.contextTokenType===n.a.GridRow)return Object(i.d)(e,s,t,r);var c=Object(a.x)(s);return{type:o,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,s,c))}}}},y5DA:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("9LTA"),a=r("Ww2r"),i=r("dUXI"),o=r("BuSU"),s=r("Je7O"),c=r("cZkS"),l=r("qC0c"),u=r("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t,r,n,o){var s=null;if(s=Object(a.b)(e,i.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:s=Object(a.b)(e,i.r);break;case-2147220960:s=Object(a.b)(e,i.o);break;case-2147164125:s=Object(a.b)(e,i.a);break;case-2147164130:case-2147164126:s=Object(a.b)(e,i.j);break;case-2147217149:s=Object(a.b)(e,i.i);break;case-2147217098:s=Object(a.b)(e,i.x);break;case-2147220969:case-2147187962:s=Object(a.b)(e,i.p);break;default:r.get_Message()&&(s=s+" "+r.get_Message())}d(e,t,s,n,o)}function d(e,t,r,a,i){var p;p=function(e){var t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(l.c)(e,c.rd)?(t(Object(n.a)(a.getStorageKey(),p)),Object(n.e)(e,t,a.getStorageKey(),i)):(t(Object(n.c)(u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,p)),Object(n.d)(e,t,u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,i))}function h(e,t,r,n,o,s){d(t,r,-2147220960===e?Object(a.b)(t,i.o):n,o,s)}},ya7l:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("4Tx6"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,l){var u={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:i,powerBITileId:o,powerBIReportId:s,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(a.a)(n.a,u,e,{target:"dialog"})}},zSKH:function(e,t,r){"use strict";r.d(t,"a",(function(){return ie}));var n=r("c/eZ"),a=r("nuS9"),i=r("lU69"),o=r("4E+q"),s=r("HSdq"),c=r("sOTk"),l=r("HRxj"),u=r("YWpA"),p=r("H/hG"),d=r("wV3W"),h=r("vO+w"),g=r("LAsh");var f=r("Sscr"),m=r("f3SV"),b=r("3wMZ"),v=r("yji3"),y=r("UIMH"),_=r("Tr6b"),S=r("Wi7Z"),O=r("MGMD"),C=r("5olG"),I=r("Ww2r"),j=r("Ingk"),P=r("swEE"),T=r("DgF7"),x=r("i8/j"),E=r("LWFb"),F=r("kyRo"),w=r("Srej"),N=r("uQP8"),A=r("NiE3"),k=r("2OIc"),M=r("HHlV"),D=r("iFdD"),R=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={columnLayout:window.innerWidth<=t.breakpointForSectionReflow?1:null,forceSmallLayout:null},r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){if(e>0){var t=this._getColumnLayout(e),r=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingLeft.toString()):0,n=this.props.customStyle&&this.props.customStyle.paddingLeft?parseFloat(this.props.customStyle.paddingRight.toString()):0,a=e-Object(C.a)(r+n)<this.props.cellBreakPointWidthInPx;t===this.state.columnLayout&&this.state.forceSmallLayout===a||this.setState({columnLayout:t,forceSmallLayout:a});var i=[{name:"currentWidth",value:e},{name:"currentColumnLayout",value:t.toString()}];this.context.TraceManager.getTracer("Forms.Section").debug("Column layout for section",i)}},t.prototype._transformStyle=function(){var e=null===this.state.columnLayout?{visibility:"hidden"}:null,t=this.props.pageType&&"quickcreate"===this.props.pageType?{boxShadow:"none"}:null,r=this._isSectionSidePaddingAdded()?null:{paddingLeft:"0px",paddingRight:"0px"},a=this._isSectionTopPaddingAdded()?null:{paddingTop:"0px"};return Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.sectionStyle),this.props.customStyle),e),t),r),a)},t.prototype._isSectionSidePaddingAdded=function(){return!this.props.noSidePaddingMode||this.props.clientHostSubtype!==P.a.Phone},t.prototype._isSectionTopPaddingAdded=function(){return(!this.props.noTopPaddingMode||1!==this.props.descriptor.Columns)&&!this._isSectionSidePaddingAdded()||this.props.clientHostSubtype!==P.a.Phone},t.prototype._sectionHasSingleColumnCells=function(e){for(var t=0,r=e;t<r.length;t++)for(var n=0,a=r[t].Cells;n<a.length;n++){var i=a[n];if(i.ControlName&&i.ColSpan>1)return!1}return!0},t.prototype._getColumnLayout=function(e){return e>0&&e<this.props.breakpointForSectionReflow?1:0},t.prototype._renderRowsAsColumns=function(e){for(var t,r,i=[],o=[],s=0;s<this.props.numberOfColumns;s++)i[s]=[];for(var c=0;c<e.length;c++)o[c]=[];for(var p=0,d=0,h=e;d<h.length;d++){s=0;for(var g=0,f=h[d].Cells;g<f.length;g++){for(var m=f[g];o[p][s]&&s<this.props.numberOfColumns;)s++;if(i[s]){for(var b=p;b<p+m.RowSpan;b++)o[b]||(o[b]=[]),o[b][s]=!0;var v=Object(C.a)(this.props.cellHeightInRem)*m.RowSpan,y=Object(n.__assign)(Object(n.__assign)({},this.props.cellContainerStyle),this.props.customCellContainerStyle),S=!0;m.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(m.ControlName)&&(S=this.props.controlVisibilityByName[m.ControlName]);var O=a.createElement(u.a,{key:m.Id,style:y},a.createElement(l.a,{domId:Object(w.g)(m.DomId,this.props.id),previewId:m.PreviewId,id:this.props.id,controlName:m.ControlName,userSpacer:m.UserSpacer,rowSpan:m.RowSpan,columnSpan:1,autoExpand:m.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,scope:_.a.EditForm,overriddenVisibility:S,availableForPhone:m.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position,isParentPaddingAdded:this._isSectionSidePaddingAdded()})),I=a.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)({},this.props.spacerContainerStyle),{minHeight:v.toString()+"px"})},a.createElement(u.a,{style:this.props.spacerStyle}));i[s].push(m.ControlName?O:m.UserSpacer?I:null)}s++}p++}var j=0===this.state.columnLayout?Math.floor(100/this.props.numberOfColumns)+"%":"100%",P=[];for(s=0;s<this.props.numberOfColumns;s++){var T=s<this.props.numberOfColumns-1?{paddingRight:"1.5rem"}:{};P.push(a.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle),{width:j}),T)},i[s]))}return a.createElement(u.a,{key:"section-columns-wrapper",style:this.props.columnsWrapperStyle},P)},t.prototype._renderRowsAfterReflow=function(e){for(var t,r,i=[],o=0,s=e;o<s.length;o++)for(var c=0,p=s[o].Cells;c<p.length;c++){var d=p[c];if(d.ControlName){var h=!0;this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(d.ControlName)&&(h=this.props.controlVisibilityByName[d.ControlName]),i.push(a.createElement(l.a,{key:d.Id,id:this.props.id,domId:Object(w.g)(d.DomId,this.props.id),previewId:d.PreviewId,controlName:d.ControlName,rowSpan:d.RowSpan,columnSpan:d.ColSpan,autoExpand:d.AutoExpand,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,style:Object(n.__assign)(Object(n.__assign)({},this.props.cellStyle),this.props.reflowCellStyle),availableForPhone:d.AvailableForPhone,overriddenVisibility:h,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position}))}}return a.createElement(u.a,null,i)},t.prototype._renderRowsInTable=function(e){var t,r,o=[],s=[],c=Object(C.a)(this.props.cellHeightInRem);for(var p in e){o=[];for(var d=0,h=e[p].Cells;d<h.length;d++){var g=h[d],f=c*g.RowSpan,_=!0;g.ControlName&&this.props.controlVisibilityByName&&-1!==Object.keys(this.props.controlVisibilityByName).indexOf(g.ControlName)&&(_=this.props.controlVisibilityByName[g.ControlName]);var O=g.ControlName?a.createElement(l.a,{key:g.Id,id:this.props.id,domId:Object(w.g)(g.DomId,this.props.id),previewId:g.PreviewId,controlName:g.ControlName,rowSpan:g.RowSpan,columnSpan:g.ColSpan,autoExpand:g.AutoExpand,style:this.props.cellStyle,cellSizeMode:this.state.forceSmallLayout?2:0,shouldRender:this.props.shouldRender,availableForPhone:g.AvailableForPhone,overriddenVisibility:_,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._getIntersectionObserverHelperForCell(),isParentPaddingAdded:this._isSectionSidePaddingAdded(),cellLabelPosition:null===(r=null===(t=this.props.descriptor)||void 0===t?void 0:t.CellLabel)||void 0===r?void 0:r.Position}):g.UserSpacer?a.createElement(u.a,{style:Object(n.__assign)(Object(n.__assign)({},this.props.spacerContainerStyle),{minHeight:f.toString()+"px"})},a.createElement(u.a,{style:this.props.spacerStyle})):a.createElement(u.a,{style:this.props.emptyCellStyle});g.ControlName&&void 0!==_&&!_||o.push(a.createElement(y.a,{role:S.r,style:this.props.tableCellStyle,id:Object(w.g)(Object(i.a)(),this.props.id),key:g.Id,rowSpan:g.RowSpan,colSpan:g.ColSpan},O))}s.push(a.createElement(v.a,{role:S.r,key:this.props.id+"_row_"+p},o))}return a.createElement(b.a,{role:S.r,style:this.props.tableStyle,key:this.props.id+"_table"},a.createElement(m.a,{role:S.r,key:this.props.id+"_tablebody"},s))},t.prototype._renderLegend=function(e,t){var r;return t&&e?a.createElement(p.a,{semanticTag:"legend",style:this._isSectionSidePaddingAdded()?this.props.legendStyle:this.props.legendNoSectionSidePaddingStyle},a.createElement(p.a,Object(n.__assign)({semanticTag:"h2",style:this.props.legendTextStyle},((r={})[O.a.LearningPathDOMAttributeName]="form-sectionHeader-"+this.props.sectionName,r),{testhooks:{id:"form-sectionHeader-"+this.props.sectionName},title:e}),e)):null},t.prototype._renderHeaderFooterFields=function(e){var t=this;return e.map((function(e){var r,i;return a.createElement(l.a,{key:e.Id,id:t.props.id,previewId:e.PreviewId,controlName:e.Name,shouldRender:t.props.shouldRender,cellSizeMode:t.state.forceSmallLayout?2:0,style:Object(n.__assign)(Object(n.__assign)({},t.props.cellStyle),t.props.headerFooterFieldCellStyle),inDialogWithZIndex:t.props.inDialogWithZIndex,intersectionObserverHelper:t._getIntersectionObserverHelperForCell(),cellLabelPosition:null===(i=null===(r=t.props.descriptor)||void 0===r?void 0:r.CellLabel)||void 0===i?void 0:i.Position})}))},t.prototype._renderHeaderFooterSection=function(){for(var e,t="headerFooterFieldSection",r=!1,n=(this.props.shouldRenderHeaderFields?this.props.headerFields:[]).concat(this.props.shouldRenderFooterFields?this.props.footerFields:[]),i=0,o=n;i<o.length;i++){if(o[i].Visible){r=!0;break}}if(!((this.props.shouldRenderHeaderFields&&0!==this.props.headerFields.length||this.props.shouldRenderFooterFields&&0!==this.props.footerFields.length)&&r))return null;var s=this._transformStyle();return a.createElement(u.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:t,semanticTag:"section",style:s,testhooks:(e={id:t},e[E.b]=this.props.headerPreviewId,e[E.c]=5,e),accessibilityLabel:"Header and Footer"},a.createElement(u.a,{key:"field-set-wrapper",style:this.props.contentStyle},null!==this.state.columnLayout&&null!==this.state.forceSmallLayout&&this._renderHeaderFooterFields(n)))},t.prototype._renderContent=function(){var e,t=this.props.label,r=this.props.descriptor,n=r.Rows,i=r.ShowLabel;return e=1===this.props.numberOfColumns||this._sectionHasSingleColumnCells(n)?this._renderRowsAsColumns(n):1===this.state.columnLayout?this._renderRowsAfterReflow(n):this._renderRowsInTable(n),a.createElement(u.a,{key:"field-set-wrapper",style:this.props.contentStyle},this._renderLegend(t,i),e)},t.prototype.render=function(){var e;if(this.props.isHeaderOrFooterSection)return this.props.clientHostSubtype!==P.a.Phone||this.props.isHeaderSectionAvailableForPhone||this.props.isFooterSectionAvailableForPhone?this._renderHeaderFooterSection():null;var t=this.props.descriptor;if(!t)return null;if(this.props.clientHostSubtype===P.a.Phone&&null!==t.AvailableForPhone&&void 0!==t.AvailableForPhone&&!t.AvailableForPhone)return null;if(!this.props.visible)return null;if(!this.props.shouldSectionRender)return null;var r=null!==this.state.columnLayout&&null!==this.state.forceSmallLayout,n=r?this._transformStyle():void 0,i=this.props.label?this.props.label:null;return a.createElement(u.a,{onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:t.DomId,style:n,semanticTag:"section",testhooks:(e={id:this.props.sectionName},e[E.b]=this.props.descriptor.PreviewId,e[E.c]=5,e),accessibilityLabel:i},r&&this._renderContent())},t.prototype._getIntersectionObserverHelperForCell=function(){return this.props.isHeaderOrFooterSection?null:this.props.intersectionObserverHelper},t}(a.Component);function L(){var e,t;return function(r){return t!==r&&(e=function(e){if(!e)return null;var t=0;switch(e.Columns){case 1:t=1;break;case 11:t=2;break;case 111:t=3;break;case 1111:t=4}for(var r=0,n=0,a=e.Rows;n<a.length;n++){var i=a[n].Cells.reduce((function(e,t){return e+(t.ColSpan?t.ColSpan:1)}),0);r=Math.max(r,i)}return Math.max(r,t)}(t=r)),e}}R.displayName="Section";var B=Object(o.a)((function(){var e,t,r,n,a=(e=null,t=null,r=null,n=null,function(a,i){var o,s=Object(d.a)(a),c=Object(h.c)(a),l=Object(h.a)(a),u=null==l?void 0:l.Colors;if(t!==s||r!==c||n!==u){t=s,r=c,n=u;var p=Object(g.a)(s);e={sectionStyle:{display:"block",backgroundColor:c?null===(o=null==u?void 0:u.Palette)||void 0===o?void 0:o.Primary01:s.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+s.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},columnsWrapperStyle:{flex:"1 1 auto",flexWrap:"wrap",flexDirection:"row"},columnStyle:{display:"block",boxSizing:"border-box"},cellContainerStyle:{display:"block",flex:"0 1 auto",width:"100%"},headerStyle:{color:s.colors.MainThemeColor.MainColor1.Fill||"#000080",fontSize:s.fontSizes.Header.Header3,fontWeight:600},tableStyle:{width:"100%",tableLayout:"fixed"},emptyCellContainerStyle:{flex:"0 1 auto",whiteSpace:"nowrap",overflow:"hidden"},emptyCellStyle:{width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},tableCellStyle:{height:"1px"},reflowCellStyle:{flex:"1 1 auto"},headerFooterFieldCellStyle:{flex:"1 1 auto"},legendStyle:{height:s.sizes.Measures.Measure225,lineHeight:s.sizes.Measures.Measure225,marginBottom:s.sizes.Measures.Measure025,width:"inherit"},legendNoSectionSidePaddingStyle:{height:s.sizes.Measures.Measure225,lineHeight:s.sizes.Measures.Measure225,marginBottom:s.sizes.Measures.Measure025,paddingLeft:p.paddingLeft,paddingRight:p.paddingRight,width:"auto"},legendTextStyle:{color:s.colors.BaseColor.Grey.Grey7,fontSize:s.fontSizes.Font125,fontFamily:s.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}}return e}),i=Object(s.ed)(),o=Object(s.dd)(),l=L(),u=Object(I.h)(),p=Object(s.bd)();return function(e,t){var r=Object(f.j)(e,t.id),n=Object(s.qc)(e,t,r),h=Object(s.fb)(e,t,r),g=Object(N.b)(e,t.id,r),m=h&&h.Header,b=m&&Object(w.g)(m.DomId,t.id),v=m&&m.PreviewId,y=Object(s.gd)(e,t,r),_=Object(s.tc)(e,t,r),S=Object(s.rc)(e,t,r),O=Object(c.k)(e,t),I=i(e,{id:t.id,contextToken:r}),P=o(e,{id:t.id,contextToken:r}),E=a(e,t),F=Object(A.b)(e,0),R=function e(t,r,n,a){var i,o,s,c,l,u,p,d,h,g,f,m,b=null===(c=null===(s=null===(o=null===(i=null==n?void 0:n.Rows)||void 0===i?void 0:i[0])||void 0===o?void 0:o.Cells)||void 0===s?void 0:s[0])||void 0===c?void 0:c.ControlName;if(Object(k.c)(t,null===(u=null===(l=null==a?void 0:a.Controls)||void 0===l?void 0:l[b])||void 0===u?void 0:u.UniqueId,null==a?void 0:a.Id)===M.d){var v=Object(D.b)(r,b),y=null===(p=Object(N.a)(t,v))||void 0===p?void 0:p.formId;if(!v||!y)return{firstControlName:b,firstControlComponentId:r,firstControlFormId:null==a?void 0:a.Id};var _=Object(x.j)(t,y),S=null===(m=null===(f=null===(g=null===(h=null===(d=null==_?void 0:_.Tabs)||void 0===d?void 0:d[0])||void 0===h?void 0:h.Columns)||void 0===g?void 0:g[0])||void 0===f?void 0:f.SectionNames)||void 0===m?void 0:m[0];return e(t,v,Object(x.t)(t,y,S),_)}return{firstControlName:b,firstControlComponentId:r,firstControlFormId:null==a?void 0:a.Id}}(e,t.id,n,h),L=R.firstControlName,B=R.firstControlComponentId,V=R.firstControlFormId,G=Object(A.a)(e,B,V,L),z=p(e,t,r),W=Object(d.a)(e),q=l(n),U=function(e,t){if(!e||!t)return null;var r=Object(C.c)();return t*e.sizes.Section.SectionWidth-2*(t-1)*r}(W,q),X=u(e,j.a),H=Object(T.e)(e),K=Object(x.q)(e,g),Q=Object(x.p)(e,g),Y=W.sizes.Section.CellBreakPointWidth;return{sectionStyle:E.sectionStyle,contentStyle:E.contentStyle,columnsWrapperStyle:E.columnsWrapperStyle,columnStyle:E.columnStyle,cellContainerStyle:E.cellContainerStyle,headerStyle:E.headerStyle,tableStyle:E.tableStyle,emptyCellContainerStyle:E.emptyCellContainerStyle,emptyCellStyle:E.emptyCellStyle,spacerContainerStyle:E.spacerContainerStyle,spacerStyle:E.spacerStyle,tableCellStyle:E.tableCellStyle,reflowCellStyle:E.reflowCellStyle,headerFooterFieldCellStyle:E.headerFooterFieldCellStyle,legendStyle:E.legendStyle,legendNoSectionSidePaddingStyle:E.legendNoSectionSidePaddingStyle,legendTextStyle:E.legendTextStyle,noSidePaddingMode:F,noTopPaddingMode:G,descriptor:n,headerDomId:b,headerPreviewId:v,shouldSectionRender:y,visible:_,mediumBreakpoint:W.sizes.Breakpoints.DimensionM,label:S,pageType:O,headerFields:I,footerFields:P,numberOfColumns:q,breakpointForSectionReflow:U,cellHeightInRem:W.sizes.Section.cellHeightInRem,clientHostSubtype:H,resourceStrings:X,controlVisibilityByName:z,isHeaderSectionAvailableForPhone:K,isFooterSectionAvailableForPhone:Q,cellBreakPointWidthInPx:Y}}}))(R);R.contextType=F.a;var V=r("ASFs"),G=r("NJzV"),z=r("S2mk"),W=r("7EJx");function q(e){var t=Object(n.__assign)(Object(n.__assign)({},e.referencePanelSectionStyle),e.customStyle);return e.isRTL?Object(n.__assign)(Object(n.__assign)({},t),{paddingLeft:"0rem"}):Object(n.__assign)(Object(n.__assign)({},t),{paddingRight:"0rem"})}function U(e){if(!e.visible)return null;var t=Object(z.B)("MscrmControls.Containers.ReferencePanelControl"),r=e.sectionDescriptor.DomId,n=isNaN(Number.parseInt(e.sectionDescriptor.Height,10))?10:Number.parseInt(e.sectionDescriptor.Height,10);return a.createElement(u.a,{id:r,style:q(e),semanticTag:"section",testhooks:{id:e.sectionName}},a.createElement(G.c,{key:"MscrmControls.Containers.ReferencePanelControl",controlId:"MscrmControls.Containers.ReferencePanelControl",id:e.id,descriptor:e.controlDescriptor,configuration:t,parentContextToken:e.contextToken,rowSpan:n}))}U.displayName="ReferencePanelSection";var X=Object(o.a)((function(){var e,t,r,n,a,i=(e=null,t=null,function(r,n){var a=Object(d.a)(r);return t!==a&&(t=a,e={referencePanelSectionStyle:{display:"block",backgroundColor:a.colors.BaseColor.White,boxShadow:"0px 0px 9px -1px "+a.colors.BaseColor.White},contentStyle:{flex:"1 1 auto",display:"block",width:"100%"},spacerContainerStyle:{flex:"0 1 auto",width:"100%",whiteSpace:"nowrap",overflow:"hidden"},spacerStyle:{width:"100%"},legendStyle:{height:a.sizes.Measures.Measure225,lineHeight:a.sizes.Measures.Measure225,marginBottom:a.sizes.Measures.Measure025},legendTextStyle:{color:a.colors.BaseColor.Blue.Blue4,fontSize:a.fontSizes.Font125,fontFamily:a.fontFamilies.Regular,fontWeight:"normal",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}}),e}),o=(n="",function(e,t,a){return a.Name!==n&&(r={Id:a.Name+"_control",Label:a.Label,Name:a.Name+"_control",ShowLabel:a.ShowLabel,Visible:a.Visible,Disabled:!1},n=a.Name),r}),l=(a=null,function(e,t){var r=Object(f.j)(e,t.id);return Object(V.e)(a,r)||(a=r),a});return function(e,t){var r=l(e,t),n=Object(s.qc)(e,t,r),a=o(e,t,n),u=Object(s.gd)(e,t,r),p=Object(s.tc)(e,t,r),d=Object(s.rc)(e,t,r),h=Object(c.k)(e,t),g=i(e,t),f=Object(W.g)(e);return{contextToken:r,referencePanelSectionStyle:g.referencePanelSectionStyle,contentStyle:g.contentStyle,spacerContainerStyle:g.spacerContainerStyle,spacerStyle:g.spacerStyle,legendStyle:g.legendStyle,legendTextStyle:g.legendTextStyle,sectionDescriptor:n,controlDescriptor:a,shouldSectionRender:u,visible:p,label:d,pageType:h,isRTL:f}}}))(U);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var H=r("qC0c"),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.transformDeviceStyle=function(){return Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle.columnStyle),this.props.customStyle)},t.prototype.render=function(){var e=this,t=this.props.column,r=null==t?void 0:t.SectionNames[0],n=[];if(this.props.shouldRenderHeaderFields||this.props.shouldRenderFooterFields){n.push(a.createElement(B,{key:"headerFooterSection",id:this.props.id,sectionName:"headerFooterSection",isHeaderOrFooterSection:!0,shouldRender:this.props.shouldRender,shouldRenderHeaderFields:this.props.shouldRenderHeaderFields,shouldRenderFooterFields:this.props.shouldRenderFooterFields,customStyle:this.props.sectionStyle,cellStyle:this.props.cellStyle,customCellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this.props.intersectionObserverHelper}))}return t.SectionNames.map((function(t){e.props.referencePanelSectionNames&&e.props.referencePanelSectionNames.length>0&&e.props.referencePanelSectionNames.indexOf(t)>-1?n.push(a.createElement(X,{id:e.props.id,key:t,sectionName:t,shouldRender:e.props.shouldRender,customStyle:e.props.sectionStyle})):n.push(a.createElement(B,{key:t,id:e.props.id,sectionName:t,shouldRender:e.props.shouldRender,customStyle:e.props.sectionStyle,cellStyle:e.props.cellStyle,customCellContainerStyle:e.props.cellContainerStyle,inDialogWithZIndex:e.props.inDialogWithZIndex,intersectionObserverHelper:e.props.intersectionObserverHelper}))})),a.createElement(u.a,{id:r,semanticTag:"section",ref:this.props.descriptorDomId,style:this.transformDeviceStyle(),role:S.r},n)},t}(a.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */K.displayName="Column";var Q=Object(o.a)((function(){var e,t,r,n,a=(e=null,t=null,function(r,n){var a=Object(d.a)(r);return t!==a&&(t=a,e={columnStyle:{display:"block"}}),e}),i=function(e,t){return n!==t&&(n=t,r=t.SectionNames.filter((function(t){return Object(s.Mb)(e,t)}))),r};return function(e,t){var r=Object(f.j)(e,t.id),n=Object(s.p)(e,t,r),o=a(e,t),c=Object(H.b)(e,"ReferencePanelControl")?i(e,n):null;return{column:n,columnStyle:o,shouldRenderHeaderFields:t.renderHeaderFields,shouldRenderFooterFields:t.renderFooterFields,referencePanelSectionNames:c}}}))(K),Y=r("aPRd");var J=r("QJW6"),Z=r("C+i/"),$=r("cZkS"),ee=r("/zIU"),te=r("TCzx"),re=r("iyBA"),ne=r("LAqF"),ae=function(e){function t(t,r){var n=e.call(this,t,r)||this;if(n._shouldRenderContents=!1,n.state={numberOfFormComponentSectionColumns:null},!(te.a.getInstance().get_IsIOS()&&ne.a.get_Instance().get_device().get_DeviceState().get_IsNarratorActive())&&t.isIntersectionObserverEnabled&&t.viewportElementId&&t.pageName===ee.a.EditForm&&!r.AccessibilityManager.isClientAPISetFocusScheduled())try{n._setupIntersectionObserver(t.viewportElementId,t.formLazyLoadConfigFlag)}catch(e){n.context.TraceManager.getTracer("Forms.Tab").warn("Failed to initialize intersection observer with error: "+e.message)}return n._formComponentSectionColumnMeasuringCallback=n._formComponentSectionColumnMeasuringCallback.bind(n),n}return Object(n.__extends)(t,e),t.prototype._formComponentSectionColumnMeasuringCallback=function(e){var t=this.props.descriptor,r=null,n=function(){var e,r,n=document.getElementById(null===(r=null===(e=t.Columns[0])||void 0===e?void 0:e.SectionNames)||void 0===r?void 0:r[0]);return n?getComputedStyle(n).width:null};if(0!==e&&(this._lastViewWidth!==e||this._lastFirstSectionWidth!==(r=n()))){this._lastViewWidth=e,this._lastFirstSectionWidth=r||n();var a=this._getFormComponentSectionColumns(this.props.descriptor,this.props.isDeviceWidthLessThanDimensionS);this.state.numberOfFormComponentSectionColumns!==a&&this.setState({numberOfFormComponentSectionColumns:a})}},t.prototype._getFormComponentSectionColumns=function(e,t){var r,n,a,i,o,s,c,l,u;if(!(null==e?void 0:e.Columns))return null;if(e.Columns.length>1&&!t){var p=document.getElementById(null===(n=null===(r=e.Columns[0])||void 0===r?void 0:r.SectionNames)||void 0===n?void 0:n[0]),d=document.getElementById(null===(i=null===(a=e.Columns[1])||void 0===a?void 0:a.SectionNames)||void 0===i?void 0:i[0]),h=document.getElementById(null===(s=null===(o=e.Columns[2])||void 0===o?void 0:o.SectionNames)||void 0===s?void 0:s[0]);if(p&&d){var g=null===(c=p.getBoundingClientRect())||void 0===c?void 0:c.top,f=null===(l=d.getBoundingClientRect())||void 0===l?void 0:l.top;if(g&&f)if(h){var m=null===(u=h.getBoundingClientRect())||void 0===u?void 0:u.top;if(m&&g===f&&g===m&&f===m)return 3;if(g===f)return 2}else if(g===f)return 2}}return 1},t.prototype._renderColumns=function(e){for(var t=[],r=0;r<e.Columns.length;r++){var i=!1,o=!1;0===r&&this.props.firstVisibleTab&&this.props.tabId===this.props.firstVisibleTab.Id&&(i=this.props.showHeaderFieldsRenderInSection&&this.props.renderHeaderFields,o=this.props.showFooterFieldsRenderInSection&&this.props.renderFooterFields);var s=e.Columns[r].Width,c={},l=this.props.isDeviceWidthLessThanDimensionS?{flex:(parseInt(s,10)/10).toString()+" "+this.props.sectionWidthInPx.toString()+"px",minWidth:0}:{flex:(parseInt(s,10)/10).toString(),minWidth:this.props.sectionWidthInPx},u=this.props.isRTL?{paddingLeft:"1.5rem"}:{paddingRight:"1.5rem"},p=this.state.numberOfFormComponentSectionColumns;p?(r<p-1&&(l=Object.assign(l,u)),1===p&&(c=this.props.sectionFullBleedStyle)):this.props.isFormComponentInstance&&((e.Columns.length<=1||this.props.isDeviceWidthLessThanDimensionS)&&(c=this.props.sectionFullBleedStyle),r<e.Columns.length-1&&!this.props.isDeviceWidthLessThanDimensionS&&(l=Object.assign(l,u)));var d=Object(n.__assign)(Object(n.__assign)({},this.props.columnStyle),l),h=Object(n.__assign)(Object(n.__assign)({},this.props.sectionStyle),c);t.push(a.createElement(Q,{key:r,tabName:this.props.tabId,columnIndex:r,id:this.props.id,renderHeaderFields:i,renderFooterFields:o,descriptorDomId:Object(w.g)(this.props.descriptor.DomId,this.props.id),shouldRender:!0,customStyle:d,sectionStyle:h,cellStyle:this.props.cellStyle,cellContainerStyle:this.props.cellContainerStyle,inDialogWithZIndex:this.props.inDialogWithZIndex,intersectionObserverHelper:this._intersectionObserverHelper}))}return t},t.prototype.componentWillUnmount=function(){this._cleanupIntersectionObserverHelper()},t.prototype._cleanupIntersectionObserverHelper=function(){this._intersectionObserverHelper&&(this.context.IntersectionObserverManager.delete(this.props.tabId),this._intersectionObserverHelper.cleanup(),this._intersectionObserverHelper=null)},t.prototype._setupIntersectionObserver=function(e,t){if(!this._intersectionObserverHelper&&e){var r=document.getElementById(e);if(r){var n={root:r,rootMargin:"50%",threshold:0};this._intersectionObserverHelper=new Z.b(n,this.context.EventManager,t),this.context.IntersectionObserverManager.set(this.props.tabId,this._intersectionObserverHelper)}}},t.prototype._renderSingleComponent=function(){return this.props.firstCell?a.createElement(l.a,{key:0,domId:Object(w.g)(this.props.firstCell.DomId,this.props.id),previewId:this.props.firstCell.PreviewId,id:this.props.id,controlName:this.props.firstCell.ControlName,userSpacer:this.props.firstCell.UserSpacer,rowSpan:this.props.firstCell.RowSpan,columnSpan:1,autoExpand:this.props.firstCell.AutoExpand,style:this.props.cellStyle,cellSizeMode:0,shouldRender:!0,scope:_.a.EditForm,availableForPhone:this.props.firstCell.AvailableForPhone,inDialogWithZIndex:this.props.inDialogWithZIndex,cellLabelPosition:1,isParentPaddingAdded:!0,useControlWrapper:!1}):null},t.prototype.render=function(){var e,t=this.props.descriptor;if(!t)return null;if(this._shouldRenderContents=this._shouldRenderContents||this.props.showTab,!this._shouldRenderContents||!this.props.visible||this.props.clientHostSubtype===P.a.Phone&&null!==t.AvailableForPhone&&void 0!==t.AvailableForPhone&&!t.AvailableForPhone)return null;var r=this.props.showTab?this.props.tabContainerStyle:this.props.hiddenTabStyle;r=this.props.singleComponent&&this.props.showTab?this.props.expandedTabContainerStyle:Object(n.__assign)(Object(n.__assign)({},r),this.props.style);var i=J.a.getInstance().getDisableScrollStyle()?"forceNewStackContextInert":"forceNewStackContext";return a.createElement(u.a,{id:t.DomId,ref:t.DomId,testhooks:(e={id:"tabpanel-"+this.props.tabName},e[E.b]=t.PreviewId,e[O.a.LearningPathDOMAttributeSuffix]="tabpanel-"+this.props.tabName,e),style:r,role:this.props.pageName===ee.a.Dialog||this.props.pageName===ee.a.ModalDialog||this.props.pageName===ee.a.QuickCreateForm||this.props.isFormComponentInstance?S.r:S.v,accessibilityLabel:this.props.pageName===ee.a.Dialog||this.props.pageName===ee.a.ModalDialog||this.props.pageName===ee.a.QuickCreateForm||this.props.isFormComponentInstance?null:this.props.label,"aria-hidden":!this.props.showTab,explicitStyles:i,onMeasuring:this._formComponentSectionColumnMeasuringCallback,isRequestedMeasuring:this.props.isFormComponentInstance},this.props.singleComponent?this._renderSingleComponent():this._renderColumns(t))},t}(a.Component);ae.displayName="Tab";var ie=Object(o.a)((function(){var e,t,r,n=(e=null,t=null,r=null,function(n,a){var i=Object(d.a)(n),o=Object(Y.c)(n),c=Object(s.Ib)(n,a.id);return t===i&&r===o||(t=i,r=o,e={tabContainerStyle:{width:"100%",flexWrap:"wrap",overflowY:"auto",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px",backgroundColor:c?"#F8F7F6":void 0},hiddenTabStyle:{width:"100%",overflowX:"hidden",display:"none"},customFooterRootStyle:{width:"100%",display:"block",position:"fixed",left:o<=i.sizes.Breakpoints.DimensionS?i.sizes.Measures.Measure050:i.sizes.Measures.Measure150,bottom:0,marginLeft:o<=i.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem",marginRight:o<=i.sizes.Breakpoints.DimensionS?"-0.5rem":"-1.5rem"},expandedTabContainerStyle:{display:"flex",width:"100%",flexWrap:"wrap",overflowY:"visible",overflowX:"hidden",flexDirection:"row",flex:"1 0 0px"},sectionFullBleedStyle:{paddingTop:"0px",paddingLeft:"0px",paddingBottom:"0px",paddingRight:"0px",borderWidth:"0px",marginBottom:"0px"}}),e}),a=null;return function(e,t){var r,i=Object(f.j)(e,t.id);Object(V.e)(a,i)||(a=i);var o=Object(s.Fc)(e,t.id,t.tabId,i),l=Object(s.Kc)(e,t.tabId,t.id,i),u=Object(s.Hc)(e,t.tabId,t.id,i),p=Object(d.a)(e),h=Object(T.e)(e),g=Object(s.Y)(e,t,i),m=n(e,t),b=p.sizes.Section.SectionWidth,v=Object(s.xc)(e,t,i),y=Object(H.c)(e,$.Q)&&Z.a,_=Object(c.l)(e,t.id),S=Object(Y.c)(e)<e.theme.sizes.Breakpoints.DimensionS,O=!1!==Object(re.d)(e,"formlazyload")&&!0!==Object(re.d)(e,"testmode"),C=Object(s.Eb)(e,t.id),I=Object(W.g)(e),j="singleComponent"===(null===(r=Object(s.Jc)(e,t.id,t.tabId,i))||void 0===r?void 0:r.contentType),P=j?function(e,t,r,n){for(var a=0,i=e.Columns||[];a<i.length;a++){var o=i[a];if(o)for(var c=0,l=o.SectionNames||[];c<l.length;c++){var u=l[c],p=Object(s.qc)(t,{id:r.id,sectionName:u},n),d=Object(s.tc)(t,{id:r.id,sectionName:u},n);if(p&&!1!==d)for(var h=0,g=p.Rows||[];h<g.length;h++){var f=g[h];if(f&&!1!==f.Visible)for(var m=0,b=f.Cells||[];m<b.length;m++){var v=b[m];if(v&&!1!==v.Visible)return v}}}}return null}(o,e,t,i):null;return{descriptor:o,visible:l,label:u,hiddenTabStyle:m.hiddenTabStyle,tabContainerStyle:m.tabContainerStyle,customFooterRootStyle:m.customFooterRootStyle,expandedTabContainerStyle:m.expandedTabContainerStyle,sectionFullBleedStyle:m.sectionFullBleedStyle,clientHostSubtype:h,firstVisibleTab:g,contextToken:a,sectionWidthInPx:b,showHeaderFieldsRenderInSection:v,isIntersectionObserverEnabled:y,pageName:_,isDeviceWidthLessThanDimensionS:S,formLazyLoadConfigFlag:O,isFormComponentInstance:C,isRTL:I,singleComponent:j,firstCell:P}}}))(ae);ae.contextType=F.a},"zt+H":function(e,t,r){"use strict";r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return d})),r.d(t,"b",(function(){return a})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"g",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"h",(function(){return i})),r.d(t,"a",(function(){return u}));var n=r("zPLw"),a="#FDE7E9",i="#107C10",o="#A80000",s="#D83B01",c="#6E6F77",l="#E8EAEC",u=32;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function p(e){return e===n.a?a:e===n.e?"#FED9CC":e===n.c?"#E1DFDD":e===n.d?"#DFF6DD":"#FFF4CE"}function d(e){return e===n.a?o:e===n.e?s:e===n.d?i:c}},zvr0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("Sscr"),i=r("uQP8"),o="control.update.unboundOutputs";function s(e,t,r,s){return{type:"control.update.unboundOutputs.async",execute:function(c){var l=c.dispatch,u=c.getState;if(!Object.keys(s).length)return Promise.resolve();var p=u(),d=Object(i.a)(p,e),h=!1,g=Object(a.v)(r),f=Object(n.__assign)({},d.forms[g].controlUnboundOutputs);for(var m in s){var b=s[m],v=t+"."+m;f[v]!==b&&(f[v]=b,h=!0)}return h&&l(function(e,t,r){return{type:o,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,g,f)),Promise.resolve()}}}}}]),window.bundleExecutionMarkers["scripts/es5/taskbasedflowpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();