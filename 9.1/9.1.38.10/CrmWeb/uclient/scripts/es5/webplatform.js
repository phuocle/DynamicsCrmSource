(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/webplatform.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[109],{"8fMp":function(e,r,t){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e,r){return{name:e,operations:r}}t.d(r,"a",(function(){return n}))},Qn8b:function(e,r,t){"use strict";t.d(r,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=.75},iLaG:function(e,r,t){"use strict";t.r(r),t.d(r,"WebPlatform",(function(){return T}));var n=t("zhda"),i={},o=function(){function e(){}return e.prototype.executeServiceOperation=function(e,r,t){return new Promise((function(r,t){var i=e.getServiceName(),o=e.getOperationName();t({errorCode:n.a.ServiceAndOperationNotSupported,param:i+"."+o})}))},e.getAvailableServiceOperations=function(e){return null},e}(),a=t("EGsq"),u=t("TCzx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=t("Qn8b"),l=t("L8jl"),s=t("U56z"),p=t("8fMp"),d=t("6JRL"),f=function(){function e(){}return e.prototype.executeServiceOperation=function(e,r,t){var i=e.getOperationName();switch(i){case s.d.openFile.name:return this._openFile(e,r);case s.d.pickFile.name:var o=void 0;return e.getParameters()&&e.getParameters()[0]&&(o=e.getParameters()[0]),(null==o?void 0:o.useBinaryReader)?(r.TraceManager.getTracer().error("pickFile with useBinaryReader=true is currently not supported on web platform"),new Promise((function(e,r){r({errorCode:n.a.ServiceAndOperationNotSupported,param:"pickFile with useBinaryReader=true is currently not supported on web platform"})}))):this._pickFile(e,t)}return new Promise((function(e,r){r({errorCode:n.a.ServiceAndOperationNotSupported,param:"FileManager."+i})}))},e.prototype._openFile=function(e,r){var t=this;return new Promise((function(i,o){var a=e.getParameters()[0],c=e.getParameters()[1].openMode,l=a.fileName,s=a.fileContent,p=r.TraceManager.getTracer();if(!a)return p.error("Parameter file is null or undefined"),o({errorCode:n.a.OpenDocumentErrorCodeGeneric});if(a.fileName||(a.fileName="Default_name_"+Date.now()),!a.mimeType)return p.error("Parameter file.mimeType is null or undefined"),o({errorCode:n.a.OpenDocumentErrorCodeGeneric});if(!a.fileContent)return p.error("File "+a.fileName+" doesnâ€™t have any content and cannot be opened."),o({errorCode:n.a.OpenDocumentErrorCodeGeneric});var d=t._base64ToBlob(s,a.mimeType);switch(c){case 2:return window.navigator.msSaveBlob?window.navigator.msSaveBlob(d,l):u.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?t._saveBlobForSafari(d,o,p):t._saveOrOpenBlob(d,l),i();case 1:return window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(d,l):u.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?t._saveBlobForSafari(d,o,p):t._saveOrOpenBlob(d),i();default:return p.error("Unknown mode value for openFile operation"),o({errorCode:n.a.OpenDocumentErrorCodeGeneric})}}))},e.prototype._pickFile=function(e,r){var t=this;return new Promise((function(n,i){var o;e.getParameters()&&e.getParameters()[0]&&(o=e.getParameters()[0]);var u=!(!o||!o.allowMultipleFiles)&&o.allowMultipleFiles,c=o&&o.maximumAllowedFileSize&&o.maximumAllowedFileSize>0?o.maximumAllowedFileSize:Object(a.x)(r.getState()).maxUploadFileSize,l=o&&o.accept?o.accept:"*";t._pickFileInternal(r,u,c,l).then((function(e){document.body.removeChild(t._fileInput),n(e)}),(function(e){document.body.removeChild(t._fileInput),i(e)}))}))},e.prototype._pickFileInternal=function(e,r,t,i){var o=this;return new Promise((function(e,a){var u=document.getElementById("filepickerid");u?(o._fileInput=u,o._fileInput.multiple=r,o._fileInput.accept=i):(o._fileInput=document.createElement("input"),o._fileInput.type="file",o._fileInput.id="filepickerid",o._fileInput.style.display="none",o._fileInput.multiple=r,o._fileInput.accept=i,o._fileInput.onchange=function(r){for(var i=r.target.files,o=0;o<i.length;o++){if(i[o].size>t)return void a({errorCode:n.a.FilePickerErrorFileSizeBreached,param:t/1024});if(0===i[o].size)return void a({errorCode:n.a.FilePickerErrorFileSizeCannotBeZero})}var u=[],l=0,s=function(r){var t=new FileReader;t.onload=function(){var n=t.result,o=n.substring(n.indexOf(",")+1),a={fileName:i[r].name,mimeType:i[r].type,fileContent:o,fileSize:Math.ceil(o.length*c.a)};u.push(a),++l===i.length&&e(u)},t.onerror=function(e){var t=Object(d.d)("FileReader Error",n.a.FilePickerErrorUnableToOpenFile,[{name:"mimeType",value:i[r].type}]);t.innerError=e,a(t)},t.readAsDataURL(i[r])};for(o=0;o<i.length;o++)s(o)},document.body.appendChild(o._fileInput)),o._fileInput.click()}))},e.prototype._base64ToBlob=function(e,r){for(var t=window.atob(e),n=t.length,i=new ArrayBuffer(n),o=new Uint8Array(i),a=0;a<n;a++)o[a]=t.charCodeAt(a);return new Blob([i],{type:r})},e.prototype._saveOrOpenBlob=function(e,r){var t=window.URL.createObjectURL(e);!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,r){var t=document.createElement("a");t.setAttribute("href",e),u.a.getInstance().get_IsMacSafari()||t.setAttribute("target","_blank"),r&&t.setAttribute("download",r),document.body.appendChild(t),t.click(),document.body.removeChild(t)}(t,r),window.URL.revokeObjectURL(t)},e.prototype._saveBlobForSafari=function(e,r,t){var i=new FileReader;i.onloadend=function(){var r=i.result,t=document.getElementById("__mscrm.safariopenfileiframe");t||((t=document.createElement("iframe")).style.display="none",document.body.appendChild(t),t.id="__mscrm.safariopenfileiframe"),(e.type.startsWith("text")||e.type.startsWith("image")||e.type.startsWith("application"))&&(r=r.replace(e.type,"application/octet-stream")),t.src=r},i.onerror=function(e){return t.error("Something is wrong with buffer data. Error: "+e.toString()),r({errorCode:n.a.OpenDocumentErrorCodeGeneric})},i.readAsDataURL(e)},e.getAvailableServiceOperations=function(){return Object(p.a)(l.d,s.d)},e}(),m=t("c/eZ"),g=t("EXRB"),v=t("1GLu"),w=t("lokH"),h=function(){function e(){}return e.prototype.executeServiceOperation=function(e,r,t){var i=e.getOperationName();switch(i){case s.g.navigateBackOutOfApp.name:return this._goToPreviousPage(r,t.getState());case s.g.openUri.name:return this._openUri(e);case s.g.canOpenUri.name:return Promise.resolve(!0)}return new Promise((function(e,r){r({errorCode:n.a.ServiceAndOperationNotSupported,param:"FileManager."+i})}))},e.prototype._goToPreviousPage=function(e,r){return Object(g.e)(r)||Object(v.a)(r)===w.a.MultiSession?e.Router.navigateToDefault():(window.history.back(),Promise.resolve({status:0,pageId:null}))},e.prototype._openUri=function(r){return new Promise((function(t,n){var i=r.getParameters()[0],o=r.getParameters()[1],a="";if(e._wellKnownProtocols.some((function(e){return i.startsWith(e)})))return window.location.href=i,void t();o&&o.openInNewWindow&&(a=o.width?a+"width="+o.width+",":"",a=o.height?a+"height="+o.height+",":"",a+="resizable=1"),window.open(i,"_blank",a),t()}))},e.getAvailableServiceOperations=function(e){var r=Object(m.__assign)({},s.g);return delete r.switchApp,(Object(g.e)(e)||Object(v.a)(e)===w.a.MultiSession)&&delete r.navigateBackOutOfApp,Object(p.a)(l.g,r)},e._getWellKnownExternalProtocols=function(){var e=["mailto:","tel:"];return u.a.getInstance().get_IsMacSafari()?e:e.concat(["ms-word:","ms-excel:","ms-powerpoint:","onenote:","skype:"])},e._wellKnownProtocols=e._getWellKnownExternalProtocols(),e}(),b=t("7EJx"),O=t("MLbG"),_=t("RYq1"),y=t("Vm/X"),S=t("Ww2r"),A=t("+D0h"),P=t("gVEw"),E=t("l4LF"),C=t("UYb5"),F=t("cOPJ"),I=t("en4/"),j=t("/j9Z"),x=t("4pqm"),B=function(){function e(){}return e.prototype.executeServiceOperation=function(e,r,t){var i=e.getOperationName();switch(i){case s.i.signOut.name:return this._signOut(r,t);case s.i.handleAuthError.name:return this._handleAuthError(r,t)}return new Promise((function(e,r){r({errorCode:n.a.ServiceAndOperationNotSupported,param:"UserAccount."+i})}))},e.prototype._signOut=function(e,r){return new Promise((function(t,n){var i=[];i.push(I.a.get_DefaultInstance().clearAllData()),i.push(I.a.get_DefaultInstance().updateSecureContext()),Promise.all(i).then((function(){e.Dispose();var n=Object(x.b)(),i=Object(b.w)(r.getState());window.location.href=i.isLive?n+"/main.aspx?signout=1&redirect="+n+"/main.aspx":n+"/main.aspx?signout=1",t()}),(function(r){e.TraceManager.getTracer("SignOut").error("Signout failed, errorDetail: "+r.toString()),n({errorCode:-2147093993})}))}))},e.prototype._handleAuthError=function(e,r){var t=this,n=e.TraceManager.getTracer("HandleAuthError");return Object(C.a)(r.getState())?(n.warn("Not showing autherror dialog. A reauth dialog is already showing"),Promise.resolve()):(r.dispatch(Object(F.b)(!0)),new Promise((function(e,i){var o=Object(S.e)(r.getState(),P.o),a=o[P.d],u=o[P.a],c=o[P.m],l=o[P.g];r.dispatch(Object(O.a)(y.b,"",E.b,c,a,u,l)).then((function(o){if(0===o.status){var a=window.RegisterAuthExpiryReminder;return t._registerAuthCompleteHandler(o.pageId,r,a),r.dispatch(Object(A.a)(o.pageId)).then((function(o){if(o&&o.value&&o.value.confirmed)e();else{var u=[{name:"output_value",value:o&&o.value}];n.warn("User closed signin prompt without signing in",u),i(new j.a("User closed signin prompt without signing in",2415919124))}t._unregisterAuthCompleteHandler(a),r.dispatch(Object(F.b)(!1))})).catch((function(e){throw t._unregisterAuthCompleteHandler(a),e}))}var u=[{name:"navigation_error_parameters",value:o.error&&o.error.errorParameters},{name:"navigation_error_message",value:o.error&&o.error.displayMessage}];n.warn("Failed to open signin dialog",u),i(new j.a("Failed to signin")),r.dispatch(Object(F.b)(!1))})).catch((function(e){n.warn("Failure when trying to open auth error handling dialog. Error: "+e),r.dispatch(Object(F.b)(!1)),i(e)}))})))},e.prototype._registerAuthCompleteHandler=function(e,r,t){window.RegisterAuthExpiryReminder=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];t&&t.apply(null,n),null!==e&&r.dispatch(Object(_.e)(e))}},e.prototype._unregisterAuthCompleteHandler=function(e){window.RegisterAuthExpiryReminder=e},e.getAvailableServiceOperations=function(e){var r=Object(b.w)(e);if(r&&(r.isLive||!r.usePathBasedUrls))return Object(p.a)(l.i,{signOut:s.i.signOut,handleAuthError:s.i.handleAuthError})},e}(),k=t("ItJr");var M=t("sgtG"),R=t("0u+G"),T=function(){function e(){}return e.prototype.executeServiceOperation=function(e,r,t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e){switch(e.getServiceName()){case l.d:return new f;case l.g:return new h;case l.i:return new B;default:return new o}}(e).executeServiceOperation(e,r,t)},e.prototype.addOnPlatformReady=function(e,r,t){!function(e,r){var t=[],n=r.getState();for(var a in i)t.push(o.getAvailableServiceOperations(a));t.push(h.getAvailableServiceOperations(n)),t.push(f.getAvailableServiceOperations()),t.push(B.getAvailableServiceOperations(n));for(var u={},c=0;c<t.length;c++){var l=t[c];l&&(u[l.name]=l)}r.dispatch(Object(k.b)(u))}(0,t),t.dispatch(Object(M.d)(R.b.Web)),e()},e}()}}]),window.bundleExecutionMarkers["scripts/es5/webplatform.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();