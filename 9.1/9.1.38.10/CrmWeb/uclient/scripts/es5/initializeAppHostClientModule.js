(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/initializeAppHostClientModule.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[69],{GJM4:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeAppHostClient",(function(){return h})),n.d(t,"getRootAppId",(function(){return m})),n.d(t,"getRootAppLogicalName",(function(){return C})),n.d(t,"runWindowOverrides",(function(){return E}));var r=n("c/eZ"),i=n("iyBA"),o=n("ULvN"),a=n("BZKE"),s=n("sTbl"),c=n("mePC"),u=n("9r0m"),p=n("7LuR"),d=n("4pqm"),l=n("7EJx"),f=n("mGpW"),v=n("Ww2r");function w(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function h(e){return{type:"apphostclient.initialize.async",execute:function(t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function(){var d,h,C,E,H,I;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return n.AppHostClient?[3,6]:Object(s.a)(t.getState())?[3,2]:(j=t.getState(),d=Object(s.e)(j)+"/apphost/clientsdk?version=1",[4,n.AssetLoader.loadScript(d)]);case 1:r.sent(),t.dispatch({type:a.a,payload:!0}),r.label=2;case 2:h=m(t.getState(),e),C={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:h,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(l.w)(t.getState()).formatInfoCultureName,source:"UCI"}},r.label=3;case 3:return r.trys.push([3,5,,6]),[4,b(n,C,9e4)];case 4:return r.sent(),n.AppHostClient.on("appHostClientErrorEvent",(O=t.dispatch,function(e){e&&e.errorInfo&&O(Object(c.b)({level:2,message:e.errorInfo.localizedMessage,id:u.a.newGuid().guid,type:2,showCloseButton:!0}))})),n.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){var n=t.notificationInfo.timeoutInMilliSec,r=u.a.newGuid().guid;e(Object(c.b)({level:w(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:r,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),n>0&&1e4!==n&&setTimeout((function(){e(Object(p.b)(r))}),n)}}}(t.dispatch)),t.dispatch({type:a.b,payload:{initialized:o.a.Initialized,error:void 0}}),[3,6];case 5:throw E=r.sent(),(null===(i=null==E?void 0:E.errorInfo)||void 0===i?void 0:i.code)?t.dispatch(g(E)):("Crm.GenericErrorMessage",H=["Crm.GenericErrorMessage"],t.dispatch(Object(f.e)(H)).then((function(){var e=Object(v.e)(t.getState(),H);t.dispatch(g({errorInfo:{code:"unknown",localizedMessage:Object(v.c)(e,"Crm.GenericErrorMessage"),timestamp:Date.now(),description:(null==E?void 0:E.message)||"Unknown error occured while initializing apphostclient"}}))}))),I=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}],n.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",E,void 0,I),E;case 6:return[2]}var O,j}))}))}}}function b(e,t,n){var r,i=new Promise((function(e,t){r=setTimeout((function(){return t({message:"PowerAppsHostingSdk.initializeAsync timed out"})}),n)})),o=PowerAppsHostingSdk.initializeAsync(t).then((function(t){clearTimeout(r),e.AppHostClient=t}));return Promise.race([o,i])}function g(e){return{type:a.c,payload:{initialized:o.a.Initialize_Failed,error:e}}}function m(e,t){return Object(i.e)(e,"rootAppId")||t}function C(e,t){return Object(i.b)(e,"appLogicalName")||t}function E(e){var t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;var n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var e=this,r=arguments[0],i=arguments[1],o=arguments[2];if(!1===o){var a=[{name:"url",value:i}];t.error("Sync call attempted",a)}var s=arguments[1].indexOf("/webresources/");if(-1!==s){var c=i.slice(s+"/webresources/".length);i=Object(d.b)()+"/api/data/v9.0/webresourceset?$filter=name eq '"+c+"'&$select=content";var u=this.onload;this.onload=function(){var t;try{var n=JSON.parse(e.responseText);e._responseText=atob(null===(t=null==n?void 0:n.value[0])||void 0===t?void 0:t.content)}catch(e){}u(e)}}-1===i.indexOf("https://")&&(i=Object(d.b)()+i),n.call(this,r,i)},window.fetch=function(e){return new Promise((function(t,n){var r=new XMLHttpRequest;r.open(e.method,e.url),e.headers.forEach((function(e,t){r.setRequestHeader(t,e)})),r.onload=function(){var e=204===r.status?null:r.response||r.responseText,n=new Headers;r.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(e){var t=e.split(": ");n.append(t.shift(),t.join(": "))}));var i=new Response(e,{status:r.status,statusText:r.statusText,headers:n});t(i)},r.onerror=function(){n("Error")},e.text().then((function(e){r.send(e)}))}))}}},sTbl:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n("EGsq"),i=n("iyBA"),o=n("qC0c"),a=n("cZkS"),s=n("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e.appHostClient.initialized}function u(e){return e.appHostClient.error}function p(e){var t=Object(r.x)(e),n=t.geoName,s=t.isSovereignCloud;if(Object(o.c)(e,a.yc))return"Test";switch(null==n?void 0:n.toUpperCase()){case"TIP":var c=Object(i.b)(e,"canvashostenv");switch(null==c?void 0:c.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(s)return"Gcc";default:var u=Object(i.b)(e,"canvashostenv");switch(null==u?void 0:u.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function d(e){switch(p(e)){case"Local":return s.Endpoint.Local;case"Test":return s.Endpoint.Test;case"Int":return s.Endpoint.Int;case"Preprod":return s.Endpoint.Preprod;case"Gcc":return s.Endpoint.Gcc;case"GccHigh":return s.Endpoint.GccHigh;case"Preview":return s.Endpoint.Preview;default:return s.Endpoint.Prod}}function l(e){return e.appHostClient.bundleLoaded}}}]),window.bundleExecutionMarkers["scripts/es5/initializeAppHostClientModule.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();