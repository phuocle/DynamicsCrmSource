(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/benchmarkpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[47],{"+6eZ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){var t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},"+P1Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("c/eZ"),a=r("gk6Q"),i=r("YCDx"),o=r("QAhb"),s=r("n1Ju"),c=function(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]},u=r("IiPO"),l=r("+Z9T"),p=r("HSdq"),d=r("F2uj"),h=r("c7nC"),g=r("9r0m"),m=r("H9Ho"),f=r("kvLG");var v,b=r("ezfI"),y=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._entityAttribute=null,v=t,s.registerObserversForControlStateChange(),s}return Object(n.__extends)(t,e),t.prototype.getAttribute=function(){var e="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(e),!this._entityAttribute){var t=void 0;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{var r=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=r.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(e),this._entityAttribute}catch(t){var n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.updateAttribute=function(e,t){var r="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;var n=e.attributes;n&&(this._entityAttribute=n.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(r)}catch(e){var a=u.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype.addNotification=function(e){var t="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){var r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):v.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),v.dispatch(Object(s.b)(this.pageId,this.getName(),r,this.contextToken)),b.a.instance.reportSuccess(t),!0}return b.a.instance.reportSuccess(t),!1}catch(e){var n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype._clearControlNotification=function(e){var t=this,r=Object(p.A)(v.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(r){var n=Object.keys(r),a=null;if(e){if(!((a=r[e])&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(l.a)(e)||0===e.trim().length)&&n.forEach((function(e){a=r[e],t._clearNotification(a)}));return!0}return!1},t.prototype._clearNotification=function(e){e.actions=null,e.messages=null,e.notificationLevel=null,v.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))},t.prototype.clearNotification=function(e){var t="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(t);var r=!!this._clearControlNotification(e);return b.a.instance.reportSuccess(t),r}catch(e){var n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setNotification=function(e,t){var r="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(r);var n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){var a=u.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype._isValidNotification=function(e){return!(!e||!e.messages||Object(m.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)},t.prototype._reportAddNotificationEvent=function(e){if(this._isValidNotification(e)){var t,r=e.messages[0],n=new c("Added",this.contextToken.entityTypeName,this.getName(),r);v.dispatch((t=n,{type:"report.xrm.event",execute:function(e,r){try{u.a.getInstance().reportEvent(t)}catch(e){var n="ClientApi.ReportXrmEventAction.reportXrmEvent";f.a.getInstance().eventManager.ReportComponentFailure(n,e),Object(l.j)(n,"XrmReporting")}return Promise.resolve()}}))}},t.prototype.getEntityReference=function(){var e=this.formContext.entityReference,t=e.id?new g.a(e.id):null;return new o.a(e.entityType,t)},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(a.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t.prototype.getAttrDescriptor=function(e,t,r){var n=this.getEntityReference().etn,a=Object(p.r)(v.getState(),n,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(f.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),(a=Object(d.a)(v.getState(),n,this.controlDescriptor.DataFieldName))||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),a},t}(i.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/0Gr":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("gBKR"),a=r("lMVv"),i=r("uO/V"),o=r("F7qm"),s=r("F2uj");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute:function(t,r){var i=t.dispatch,o=t.getState;try{var s=Object(a.h)(o(),e),c={};return l(c,e),Object.keys(s.ManyToManyRelationships).forEach((function(t){var r=s.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){var n=r.Entity1LogicalName;n===e&&(n=r.Entity2LogicalName),l(c,n)}})),Object.keys(s.OneToManyRelationships).forEach((function(e){var t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&l(c,t.ReferencingEntity,t.ReferencingAttribute)})),Object.keys(s.ManyToOneRelationships).forEach((function(e){var t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(l(c,t.ReferencedEntity),l(c,t.ReferencingEntity,t.ReferencingAttribute))})),i(Object(n.e)(c)).catch((function(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}))}catch(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function u(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute:function(t,r){var n=t.getState;try{var i,c=n(),u=Object(a.h)(c,e),l=[];return Object.keys(u.OneToManyRelationships).forEach((function(e){var t,r,n=u.OneToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencingEntity,h=Object(a.h)(c,i),g=Object(s.a)(c,i,n.ReferencingAttribute);if(h){var m=p(h,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:h.DisplayCollectionName),f=d(n,h.DisplayCollectionName,o.RelationshipType.OneToMany);l.push([m,f])}}})),Object.keys(u.ManyToManyRelationships).forEach((function(e){var t,r,n=u.ManyToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=!0,s=n.Entity1LogicalName,d=void 0,h=void 0,g=!0;if(s===u.EntityLogicalName?(s=n.Entity2LogicalName,n.IsCustomRelationship&&(i=2!==n.Entity2AssociatedMenuConfiguration.Behavior),h=n.Entity2AssociatedMenuConfiguration.Behavior,d=null!==(t=n.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",g=!1):(n.IsCustomRelationship&&(i=2!==n.Entity1AssociatedMenuConfiguration.Behavior),h=n.Entity1AssociatedMenuConfiguration.Behavior,d=null!==(r=n.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),i)if(v=Object(a.h)(c,s)){var m=p(v,1===h?d:v.DisplayCollectionName),f=void 0;f=g?{displayName:v.DisplayCollectionName,referencedFieldName:u.PrimaryIdAttribute,referencingFieldName:v.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute}:{displayName:v.DisplayCollectionName,referencedFieldName:u.PrimaryIdAttribute,referencingFieldName:v.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity2IntersectAttribute},l.push([m,f])}if(n.Entity1LogicalName===n.Entity2LogicalName){var v=Object(a.h)(c,n.Entity2LogicalName);if(2!==n.Entity1AssociatedMenuConfiguration.Behavior){m=p(v,1===n.Entity1AssociatedMenuConfiguration.Behavior?n.Entity1AssociatedMenuConfiguration.Label:v.DisplayCollectionName),f={displayName:v.DisplayCollectionName,referencedFieldName:u.PrimaryIdAttribute,referencingFieldName:v.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute};l.push([m,f])}}}})),Object.keys(u.ManyToOneRelationships).forEach((function(e){var t,r,n=u.ManyToOneRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencedEntity,h=n.ReferencingAttribute,g=Object(a.h)(c,i),m=Object(s.a)(c,u.EntityLogicalName,h);if(g){var f=d(n,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==m?void 0:m.DisplayName)&&void 0!==r?r:g.DisplayCollectionName,o.RelationshipType.ManyToOne);l.push([p(g,g.DisplayCollectionName),f])}}})),i=l.sort((function(e,t){var r,n,a,i;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;var o=e[1].displayName.localeCompare(t[1].displayName);return 0===o?(null===(a=e[0])||void 0===a?void 0:a.displayName)&&(null===(i=t[0])||void 0===i?void 0:i.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:o})),Promise.resolve(i)}catch(t){return h(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function l(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function p(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function d(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function h(e,t,r,n,a){var o=[{name:i.k,value:e}];return t.EventManager.ReportComponentFailure(Object(i.G)(n,a),r,null,o),Promise.resolve(null)}},"/U1C":function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("c/eZ"),a={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(a),o={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(o),c={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},u=Object.values(c),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},p=Object.values(l),d=Object(n.__spreadArrays)(i,s,p);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/V8d":function(e,t,r){"use strict";r.d(t,"a",(function(){return k})),r.d(t,"e",(function(){return D})),r.d(t,"d",(function(){return V})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return R}));var n=r("c/eZ"),a=r("pOv+"),i=r("9r0m"),o=r("sgPk"),s=r("U0B9"),c=r("2OIc"),u=r("Gemh"),l=r("kl3Z"),p=r("lMVv"),d=r("bH46"),h=r("i8/j"),g=r("PQ2H"),m=r("8xrh"),f=r("WS0f"),v=r("7EJx"),b=r("vt+k"),y=r("QAhb"),_=r("HSdq"),S=r("yHpA"),C=r("hl8w"),O=r("RNNy"),I=r("F2uj"),P=r("uO/V"),j=r("qC0c"),T=r("cZkS"),E=r("jigW"),F=r("i2G7"),A=r("sOTk"),x=r("xkx/"),w=r("r2h9"),N=r("+l2M"),k=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],M=["Opportunity_ActivityPointers"];function D(e){var t,r=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(P.r)&&e.control.Parameters[P.r],n=[e.viewId,r,e.recordsPerPage,(t=e,t&&t.controlParameters&&t.controlParameters.ChartDrillDownParameters&&t.controlParameters.ChartDrillDownParameters.length>0)];return e.customQueryStateKeyParts&&n.push.apply(n,e.customQueryStateKeyParts),n.join("")}function R(e,t,r,n,a){var i=L(e,t,r,n,a);return function(t){var r=i(t);return r&&r.getQueryState(r instanceof o.a?void 0:e)}}function L(e,t,r,n,a){var c={};return function(l){var p=new i.a(l.viewId),d=Object(u.qb)(e(),p,t);if(!d)return null;var h=function(e,t,r){var n=t.fetchXML,a=null,i="TeamTemplateId";if(t.entityLogicalName===O.a&&e.controlParameters[i]){var o=e.controlParameters[i];if(n&&n.indexOf(o)<0){var s=r?r.guid:"",c=Object(C.a)(n,o,s);n=c.updatedFetchXml,a=c.filterString}}return{fetchXML:n,filterString:a}}(l,d,n),g=h.fetchXML;if(!g&&d.queryApi)return null;if(Object(E.l)(e())&&l.quickFindViewId){var P=new i.a(l.quickFindViewId),k=i.a.isNullOrEmpty(P)?null:Object(u.qb)(e(),P,t);Object(f.a)(k)||(g=function(e,t){var r=new DOMParser;if(e){for(var n=r.parseFromString(e.fetchXML,"text/xml"),a=r.parseFromString(t.fetchXML,"text/xml"),i=n.getElementsByTagName("filter"),o=0;o<i.length;o++)i[o].attributes&&i[o].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[o]);return(new XMLSerializer).serializeToString(a)}return t.fetchXML}(k,d))}var D=e(),R=l.entityLogicalName,L=l.getCustomFilter&&l.getCustomFilter(),B=function(e,t,r,n,a){var o=a.controlParameters.RelationshipName;if(o){var s=n,c=null,l=null;if(a.controlParameters.DependentAttributeName)c=(l=a.controlParameters.DependentAttributeName).split(".")[1]||l;if(a.controlParameters.IsDataSetLookup)if(s=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)c=(l=a.controlParameters.DependentAttributeName).split(".")[1]||l;var p=Object(_.ac)(e,t,a.contextToken),d=new y.a(r,s),h=null,g=!1;Object(I.a)(e,r,c)?h=Object(S.d)(e,p,d,c):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===r&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);var m=h;m&&m.reference?s=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===c||null!==m&&null!==m.reference||!d||null===d.id||g||(s=null);var f=Object(u.kb)(e,t,a.contextToken),v=0,C=b.h.None;return f?(v=1,-1===M.indexOf(o)&&(C=b.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(v=2),{type:v,rollupType:C,entityReference:d,contextId:s,relationshipName:o}}return null}(D,t,a||r&&r.EntityLogicalName,n,l),G=Object(m.p)(e(),R),X=function(e,t,r,n,a,o,s){var c,l=Object(A.g)(e,o),p=!(!(null==l?void 0:l.pageToEditedViewMapId)||!Object(u.rb)(e,l.pageToEditedViewMapId.guid,s.guid)),d=Object(u.qb)(e,s,o),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(c=t.control)||void 0===c?void 0:c.ClassId,N.E));return Object(x.e)(e)&&(h||Object(x.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!a&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!p&&(null==d?void 0:d.queryType)!==w.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(D,l,B,L,G,t,p)?F.a.fromView(p,l.quickFindSearchString):o.a.fromXmlAndSql(g,d.offlineSqlQuery,p,l.quickFindSearchString,R,e);(null==h?void 0:h.filterString)&&n&&X.addExistingContextFilterToKey(i.a.toString(n),h.filterString);var q=Object(u.x)(e(),t,l.contextToken);q&&(X.pageNumber=q);var U=V(e(),t,r,l,d,R);U.length&&X.select.apply(X,U);var z=function(e,t,r,n,a,i){var o=null;if(!Object(j.a)(e,T.ub)||!i.hasGrid||1!==i.gridType)return null;var c=Object(u.j)(n)(e,t,i.contextToken),l=Object(s.b)(e),p=c&&c.CustomControls&&c.CustomControls[l]&&c.CustomControls[l].Parameters;if(!Object(u.vb)(p)&&(o=Object(u.o)(e,r))){var d=[],h=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(h)for(var g in h)h.hasOwnProperty(g)&&d.push(h[g].name);-1!==d.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(E.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,R,p,d,l);z&&(z.lookupAttribute&&X.select(z.lookupAttribute),z.primaryAttribute&&X.addChildCountAttribute(z.primaryAttribute));var W=l.getCustomSorting&&l.getCustomSorting(d,c);if(W)for(var H=0,Y=W;H<Y.length;H++){var Q=Y[H];X.orderBy(Q.name,1===Q.sortDirection)}if(B)switch(B.type){case 1:X.applyRollupContextFilter(B.entityReference,B.rollupType);break;case 2:var K=Object(u.v)(D,t,l.contextToken);X.applyContextFilter(B.relationshipName,B.contextId,D,K?K.relationshipRoleOrdinal:void 0)}if(G&&X.where(G),L&&L.filter)if(Array.isArray(L.filter))for(var J=0,Z=L.filter;J<Z.length;J++){var $=Z[J];X.where($,$.shouldReplace)}else!function(e){return!!(e&&e.operator&&e.terms)}($=L.filter)?X.where(Object(m.n)(L.filter,null)):X.where($,$.shouldReplace);if(L&&L.linkEntities)for(var ee=0,te=L.linkEntities;ee<te.length;ee++){var re=te[ee];X.addLinkedEntity(re,re.attributes||[])}var ne=l.recordsPerPage;if(ne)X.pageSize=ne;else{var ae=Object(v.h)(e());l.hasChart||Object(f.a)(ae)?X instanceof o.a&&X.setDefaultPageSize():X.pageSize=ae}return X}}function V(e,t,r,o,m,f){var v=Object(n.__spreadArrays)(function(e,t,r,n){if(0!==r.gridType)return[];var a="Grid",i=Object(s.b)(e),o=t&&Object(c.a)(r.control,t,i);o&&(a=Object(u.ab)(e,o.CustomControlId));return Object(l.b)(e,r.control.UniqueId,a,t&&t.Id,null,null,n)||[]}(e,r,o,m.viewId),function(e,t,r,n){if(1!==t.gridType)return[];return Object(l.a)(e,r,n)||[]}(e,o,f,m.viewId),function(e,t,r,n){var a=[],i=Object(p.h)(e,n);i&&(function(e,t,r){var n=Object(s.b)(e),a=t&&Object(c.a)(r.control,t,n);return a&&[a.CustomControlId&&a.Name].some((function(e){return-1!==k.indexOf(e)}))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(u.vb)(r.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(E.a)(i.PrimaryImageAttribute)));return a}(e,r,o,f),function(e,t,r){var n=[];if(4&t.streamMode){n.push("modifiedon");var a=Object(I.d)(e,r);if(a)for(var i in a){var o=a[i];o.IsSortableEnabled&&"image"!==o.Type&&"multiselectpicklist"!==o.Type&&Object(d.b)(e,r,o.LogicalName,o)&&n.push(o.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}(e,o,f),function(e,t,r,n){var o=[],s=r.cardFormId;if(s)if("activitypointer"===n)o.push.apply(o,d.a);else{var c=i.a.equals(s,a.a)?Object(h.h)(e,n,Object(g.a)(11)):s,u=Object(h.d)(e,c,t);if(u)for(var l in u){var p=u[l];p.DataFieldName&&o.push(p.DataFieldName)}}return o}(e,t,o,f),o.getCustomColumns?o.getCustomColumns():[]);if(v.length){var b=[],y=[],_=m&&m.grid&&m.grid.rows&&m.grid.rows[0]&&m.grid.rows[0].cells;if(_)for(var S in _)_.hasOwnProperty(S)&&y.push(_[S].name);for(var C in v){var O=v[C];-1===y.indexOf(O)&&-1===b.indexOf(O)&&b.push(O)}return b}return v}},"/W63":function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("ar+e"),a=r("VlhU"),i=r("bCrZ"),o=r("Gemh"),s=r("r2h9"),c=r("RlP9"),u=r("sgPk"),l=r("olrR"),p=r("uO/V"),d=r("7pqb"),h=r("s2by"),g=r("19Zc"),m=r("fE8x"),f=r("YrcW"),v=r("JlqV"),b=r("jigW"),y=r("G7N+"),_=r("qC0c"),S=r("cZkS"),C=r("5cS+"),O=r("gBKR"),I=p.x+"."+p.v;function P(e,t,r,n,a,s,l,p,d,m){var f=T(n,l,d),y=Object(c.c)(t,r);if(!y)return Promise.resolve(null);var C=u.a.fromXmlAndSql(y.fetchXML,y.offlineSqlQuery,r).getQueryState(),O=m||Object(o.db)(t,n,l),I=Object(b.c)(a,s),P=!1;Object(v.b)(t)&&Object(b.h)(t,s.relationshipName,!0)&&(P=!0);var E=Object(o.ub)(t,n);if(E||"activitypointer"===n||P){var F=t.user&&t.user.userId,A=Object(_.c)(t,S.Zc),x=Object(h.a)(n,F,s,A,E);return e(x.getFilterOptionsAction()).then((function(r){if(r&&r.length>0){var o=r.filter((function(e){return e.isDefault}));if(o&&o.length>0){var c=x.getFilterExpression(o[0].value);e(Object(g.l)(c,a,s))}}return e(Object(i.d)(C,n,a,s,null,l,O,P,I)).then((function(r){return j(e,r,t,n,a,f,p)}))}))}return e(Object(i.d)(C,n,a,s,null,l,O,void 0,I)).then((function(r){return j(e,r,t,n,a,f,p)}))}function j(e,t,r,n,a,s,c){var u=Object(m.c)(r),l=Object(m.b)(r);return(u||l)&&Object(o.sb)(r,n)&&Object(i.e)(c,e,n,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function T(e,t,r){return[{name:d.a.CorrelationId,value:r.correlationId},{name:d.a.ContextId,value:r.contextId},{name:d.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,r){var i=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute:function(i,u,p){var h=i.dispatch,g=i.getState,m=g(),v=Object(n.e)(m,{id:e},t.parentContextToken),b=T(r.entityName,r.relationshipName,p);if(h(Object(a.b)(e,t,r)),null!==v&&v.id===r.id&&v.isSelected===r.isSelected&&v.relationshipName===r.relationshipName||h(Object(a.b)(e,t.parentContextToken,r)),h(Object(f.a)(e,r)),r&&!r.url){var j=function(e,t){return[{name:d.a.CorrelationId,value:e.correlationId},{name:d.a.ContextId,value:e.contextId},{name:d.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(p,r.entityName);if(!Object(o.v)(m,e,t)){h(Object(l.b)(r.entityName,s.a.MAIN_APPLICATION_VIEW));var E=Object(c.a)(m,r.entityName,s.a.SUB_GRID),F=Object(c.c)(m,E),A=Object(_.c)(m,S.Xc),x=!A||function(e,t){var r,n,a;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(a=e.metadata)||void 0===a?void 0:a.entities))return!0;var i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(var o=0;o<i.length;o++)if(i[o].relatedEntityName&&!e.metadata.entities[i[o].relatedEntityName])return!1;return!0}(m,F);return F&&F.initialized===y.a.Initialized&&x?(P(h,m,E,r.entityName,e,t,r.relationshipName,u,p,r.ordinal).catch((function(e){u.EventManager.ReportComponentFailure(I,e,null,b)})),u.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",j),Promise.resolve(E)):h(Object(l.a)(r.entityName,s.a.SUB_GRID)).then((function(n){var a=Promise.resolve();if(A){var i=Object(C.a)(m,n,e);a=h(Object(O.e)(i))}return a.then((function(){var a=g();return P(h,a,n,r.entityName,e,t,r.relationshipName,u,p,r.ordinal).catch((function(e){u.EventManager.ReportComponentFailure(I,e,null,b)})),u.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",j),n}))}),(function(e){u.EventManager.ReportComponentFailure(I,e,null,b)}))}}return Promise.resolve(null)},getFailureParameters:function(e,t){return i}}}},"/lKk":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("UGbr"),a=r("/j9Z"),i=r("71iK"),o=r("RYq1"),s=r("LFYt"),c=r("Ww2r"),u=r("HfRC"),l=r("yOMg"),p=r("VnuK"),d=r("rIXY"),h=r("Sscr"),g=r("HSdq"),m=r("yHpA"),f=r("zsi3"),v=r("+ieV"),b=r("Srej");function y(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute:function(t,r,y){var _=t.dispatch,S=(0,t.getState)(),C=Object(h.j)(S,e),O=Object(g.zb)(S,e,C),I=Object(g.ac)(S,e,C);if(!(!Object(m.g)(S,I)&&O&&Object.keys(O).length>0))return _(Object(n.e)(e,2)).then((function(t){var n=Object(g.Ib)(S,e),h=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(t){var m=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:t.etn}];return r.EventManager.ReportComponentSuccess(h,m),(n?Promise.resolve(e):_(Object(s.b)(e,t))).then((function(e){return _(Object(i.a)(t.etn)),function(e,t,r){var n="quickcreate_",a=Object(c.e)(t,[d.g,d.c]),i={actionLabel:Object(c.c)(a,d.g),eventHandler:function(){e(Object(u.a)(r)),e(Object(l.removeToastNotification)(n+r.id.guid))}},o=null,s={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(a,d.c),title:null,action:i,onCloseHandler:o};e(Object(p.b)(s))}(_,S,t),_(Object(o.e)(e,"save")).then((function(){return t}))}))}return r.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))}));for(var P in O){var j=O[P].label,T=O[P].errorMessage,E=_(Object(v.b)(j,T));_(Object(v.c)(C,e,E,f.a.error,Object(b.d)(e,P)))}}}}},"/wtJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return p}));var n=r("UOiB"),a=r("Sscr"),i=r("HSdq"),o=r("ObKm"),s=r("yHpA"),c=r("sOTk"),u=r("krRo"),l="attribute.precision";function p(e,t,r,p){return{type:"attribute.precision.update",sync:!0,execute:function(d,h){var g,m=d.dispatch,f=d.getState,v=f();m(function(e,t,r,i){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(u.e)(e,t,r,i);var o=Object(a.x)(t);return{type:l,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,p)),v=f();var b=null,y=null,_=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)b=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,_=Object(a.t)(t),S=Object(a.r)(t);else{var C=Object(c.g)(v,e);b=C&&C.entityTypeName?C.entityTypeName:null,y=C&&C.id?C.id:null,_=null,S=t}var O=Object(i.ac)(v,e,t),I=Object(s.d)(v,O,{etn:b,id:y},r),P=((g={})[r]=I,g);m(Object(o.a)(e,P,!0,!0,b,y?y.guid:null,_,S))}}}},"0MLN":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.setLabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{label:r},meta:{pageId:e,contextKey:i}}}},"0bF2":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="grid.updatequerykey";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(r),o=Object(n.v)(r);return{type:a,payload:e,meta:{pageId:t,contextKey:i,dataSetContextKey:o}}}},"0hCf":function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,a,i=r("HSdq"),o=r("yZTI"),s=r("Zy0S"),c=r("c/eZ"),u=r("FlW1"),l=r("ll2N"),p=r("s0Zj"),d=r("+Z9T"),h=r("w/nD"),g=r("ksD2"),m=r("A8fJ"),f=r("PLtI"),v=r("IiPO"),b=r("ezfI"),y=r("7ipg"),_=function(e){function t(t,r,a,i,o,s){var c=this;return Object(d.g)(o,"ClientApi.XrmTab.constructor","parent"),Object(d.g)(t,"ClientApi.XrmTab.constructor","store"),c=e.call(this,t,r,i,a)||this,n=t,c._parent=o,c._formContext=s,c._iConnectedTabProps={tabName:c.name,tabId:c._getTabId(),id:c.pageId,showTab:!0},c._clientApiExecutor=new y.b(n,"ClientApi.XrmTab.",r),c}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){var e="ClientApi.XrmTab.sections";try{if(b.a.instance.reportCall(e),!this._sections){this._sections=new s.a(e);for(var t=n.getState(),r=Object(i.Gc)(t,this.pageId,this.name,this.contextToken),a=0;a<r.Columns.length;a++)for(var o=Object(i.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:a},this.contextToken),c=null,u=0;u<o.SectionNames.length;u++)c=new l.a(n,this.contextToken,this.pageId,o.SectionNames[u],this,this._formContext),this._sections.add(c.getName(),c)}return b.a.instance.reportSuccess(e),this._sections}catch(t){var p=v.a.getInstance().getEventParameters(this.contextToken);throw p.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(e,t,null,p),t}},enumerable:!1,configurable:!0}),t.prototype.addTabStateChange=function(e){var t="ClientApi.XrmTab.addTabStateChange";Object(d.g)(e,t,"handler");try{b.a.instance.reportCall(t),n.dispatch(Object(h.s)(this.contextToken,this.pageId,this.name,e)),b.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeTabStateChange=function(e){var t="ClientApi.XrmTab.removeTabStateChange";Object(d.g)(e,t,"handler");try{b.a.instance.reportCall(t),n.dispatch(Object(h.N)(this.contextToken,this.pageId,this.name,e)),b.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getDisplayState=function(){var e="ClientApi.XrmTab.getDisplayState";try{b.a.instance.reportCall(e);var t=Object(i.Dc)(n.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return b.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParent=function(){return b.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent},t.prototype.setDisplayState=function(e){var t="ClientApi.XrmTab.setDisplayState";try{b.a.instance.reportCall(t);var r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(d.h)(t,"TabDisplayState",e)}r||n.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken)),b.a.instance.reportSuccess(t)}catch(e){var a=v.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.setFocus=function(){try{b.a.instance.reportCall("ClientApi.XrmTab.setFocus"),n.dispatch(Object(p.b)(this.pageId,this._getTabId(),this.contextToken)),b.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){var e=v.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTab.setVisible";try{b.a.instance.reportCall(t),n.dispatch(Object(g.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),b.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getLabel=function(){try{b.a.instance.reportCall("ClientApi.XrmTab.getLabel");var e=Object(i.Hc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return b.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){var t=v.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}},t.prototype.getVisible=function(){var e="ClientApi.XrmTab.getVisible";try{b.a.instance.reportCall(e);var t=Object(i.Kc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return b.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTab.setLabel";Object(d.g)(e,t,"label");try{b.a.instance.reportCall(t),n.dispatch(Object(f.b)(this.pageId,this.contextToken,this._getTabId(),e)),b.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),v.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype._getTabId=function(){var e=n.getState(),t=Object(i.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id},t.prototype.setContentType=function(e){var t=this;return this._clientApiExecutor.execute("setContentType",(function(){var r;switch(e){case"default":case"cardSections":r="cardSections";break;case"expandAvailableSpace":case"singleComponent":r="singleComponent";break;default:Object(d.h)("setContentType","TabContentType",e)}n.dispatch(Object(m.b)(t.pageId,t._getTabId(),t.contextToken,r))}),[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])},t.prototype.getContentType=function(){var e=this;return this._clientApiExecutor.execute("getContentType",(function(){var t;return null===(t=Object(i.Jc)(n.getState(),e._getTabId(),e._iConnectedTabProps.id,e.contextToken))||void 0===t?void 0:t.contentType}))},t}(u.a),S=r("9r0m"),C=r("tcXs"),O=r("UOiB"),I=r("i8/j"),P=r("sOTk"),j=r("/zIU"),T=r("1z64"),E=r("OTOS"),F=r("uQP8"),A=r("kvLG"),x=function(){function e(e,t,r,n,i,o,s){var c=Object(P.l)(e.getState(),r),u=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:c,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new T.a(e,"ClientApi.XrmFormUIBase.",r,t,u),this._pageId=r,a=e,this._formContext=n,this._entityName=i,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=o}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutor.execute("controls_get",(function(t,r){if(!e._controls){e._controls=new s.a(t);var n=(h=e.pageId,g=e.contextToken,m=e._controls,f=Object(F.b)(a.getState(),h,g),v=Object(E.b)(a.getState(),h),b=S.a.equals(f,v),y=Object(P.l)(a.getState(),h)===j.a.Dialog,_=Object(I.y)(a.getState(),f),C=_&&_.reduce((function(e,t){return e.add(t),e}),new Set),function(e,t){var r=Object(i.s)(a.getState(),{controlName:e,id:h},g),n=Object(i.Rc)(a.getState(),h,r);b&&n&&!y?C&&C.has(r.DataFieldName)&&Object(i.fd)(a.getState(),h,r,g)&&m.add(e,t):m.add(e,t)}),o=e.getFormDescriptor(t,r);if(o){var c={isEventParam:!0,name:"controlName",value:""},u={isEventParam:!0,name:"controlType",value:""};for(var l in r.push(c),r.push(u),o.Controls){var p=o.Controls[l];c.value=l,u.value=p&&p.ClassId?p.ClassId.guid:"";var d=e.xrmControlFactory.createXrmControl(e.contextToken,p,e._formContext,t,r);d&&n(d.getName(),d)}}}var h,g,m,f,v,b,y,_,C;return e._controls}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formSelector",{get:function(){var e=this;return this._clientApiExecutor.execute("formSelector_get",(function(t,r){if(!e._formSelector){var n=e.getFormDescriptor(t,r);n&&(e._formSelector=new e._formSelectorType(a,e._contextToken,n.Id,e._entityName,e._pageId))}return e._formSelector}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(t,r){if(!e._tabs){e._tabs=new s.a(t);var n=e.getFormDescriptor(t,r);if(n){var i=n.Tabs;for(var o in i){var c=new _(a,e._contextToken,i[o].Name,e._pageId,e,e._formContext);e._tabs.add(c.getName(),c)}}}return e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),e.prototype.refreshRibbon=function(e){var t=this;void 0===e&&(e=!1),this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(C.a)(t._pageId,null,e))}))},Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formContext",{get:function(){var e=this;return this._clientApiExecutor.execute("formContext",(function(){return e._formContext}))},enumerable:!1,configurable:!0}),e.prototype.getControls=function(){if(!this._controls&&this.contextToken.contextTokenType===O.a.GridRow){var e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new s.a(e),this._controls}return this.controls},e.prototype.getFormDescriptor=function(e,t){var r=Object(i.fb)(a.getState(),{id:this._pageId},this._contextToken);if(!r){var n="Form descriptor not found";if(Object(o.n)(a.getState(),this._pageId))A.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===O.a.GridRow)A.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;var s=new Error(n);this._clientApiExecutor.reportFailure(e,s,t)}}return r},e}()},"0rak":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,r){return{type:"chart.drilldownparameters.update.async",execute:function(s,c){var u=s.dispatch,l=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".updateChartDrillDownParametersAction";try{p.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(l(),e));var h=Object(n.v)(t);return u(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var g="Updatation of the chart drilldown parameters failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},"19Zc":function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return f})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return b})),r.d(t,"k",(function(){return y})),r.d(t,"h",(function(){return _})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return S}));var n=r("Sscr"),a=r("uO/V"),i=r("WS0f"),o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",u="grid.applyQuickFindFilter",l="grid.applyFilterCurrentValue",p="grid.applyActivityTypeFilterCurrentValue",d="grid.applyAdvancedFindFilter";function h(e,t,r,i){return{type:"grid.applyFilter.async",execute:function(o,s){var c=o.dispatch,u=s.TraceManager.getTracer(a.z),l=a.x+".applyGridFilterAction",p=Object(n.v)(i),d=[];d.push({name:a.n,value:e}),d.push({name:a.e,value:p});try{return u.info("Applying the filter expression to the grid. "),c(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,p)),s.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(e){s.EventManager.ReportComponentFailure(l,Error("Applying the filter expression to the grid failed "),"",d)}}}}function g(e,t,r){var a=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:a}}}var m=function(e,t,r){return h(o,e,t,r)},f=function(e,t,r){return h(s,e,t,r)},v=function(e,t,r){return h(c,e,t,r)},b=function(e,t,r){return h(u,Object(i.a)(e)?e:e.trim(),t,r)},y=function(e,t,r){return h(l,e,t,r)},_=function(e,t,r){return h(p,e,t,r)},S=function(e,t,r){return h(d,e,t,r)}},"1PXy":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("YCDx"),c=r("PZxu"),u=r("ildB"),l=r("3OsR"),p=r("+Z9T"),d=r("ME4N"),h=r("IiPO"),g=r("7bez"),m=r("h82J"),f=r("Sscr"),v=r("ezfI"),b=r("gBKR"),y=r("9r0m"),_="ClientApi.XrmControlTimeline.",S=function(e){function t(t,r,a,o,s,c,u,l){var p=e.call(this,t,r,a,o,s,u)||this;return p._defaultLabel=d.u.Timeline,n=t,p._applicationContext=l,p._controlId=c,p._traceManager=l.TraceManager,p._subgridToken=Object(f.p)(r,s),p._clientApiExecutorTimeline=new i.a(t,_,a,r),p._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:s,isEventParam:!0,expectedDataType:"string"}),p._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:c,isEventParam:!0,expectedDataType:"string"}),p._gridControl=new g.a(t,p._subgridToken,a,!1,3,!0,l,s),t.dispatch(Object(m.a)(p,a,p._subgridToken)),p}return Object(a.__extends)(t,e),t.prototype.getControlType=function(){return v.a.instance.reportUsage(_+"getControlType"),"timelinewall"},t.prototype.getName=function(){var e=this;return this.clientApiExecutor.execute("getName",(function(){return e.controlDescriptor&&e.controlDescriptor.Parameters&&e.controlDescriptor.Parameters[d.s.UClientUniqueName]?e.controlDescriptor.Parameters[d.s.UClientUniqueName]:d.u.Timeline}))},t.prototype.getLabel=function(){var e=_+"getLabel";try{v.a.instance.reportCall(e);var t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(p.a)(this.controlDescriptor.Parameters[d.s.Label])?this.controlDescriptor.Parameters[d.s.Label]:this._defaultLabel?this._defaultLabel:"";return v.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(t){var r=_+"setLabel";try{v.a.instance.reportCall(r),e.prototype.setLabel.call(this,t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[d.s.Label]=t:this._defaultLabel=t,v.a.instance.reportSuccess(r)}catch(e){var n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.openEmail=function(e){var t=_+"openEmail";try{v.a.instance.reportCall(t),n.dispatch(Object(u.t)(this._controlId,e)),n.dispatch(Object(u.o)(this._controlId,l.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),v.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.refresh=function(e){var t=_+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{v.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[d.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[d.s.UClientActivities]=e.activities)),n.dispatch(Object(u.o)(this._controlId,l.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),v.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setTargetEntity=function(e,t,r){var a=this;void 0===r&&(r=!0);var i=_+"setTargetEntity";try{v.a.instance.reportCall(i);var o={etn:e,id:t,isAPI:!0},s={};return s[e]=[],n.dispatch(Object(u.v)(this._controlId,o)),n.dispatch(Object(b.e)(s)).catch((function(t){var r=h.a.getInstance().getEventParameters(a.contextToken);throw r.push({name:"controlName",value:a.getName()}),r.push({name:"entityName",value:e}),h.a.getInstance().reportFailure(i+"-retrieveEntities",t,null,r),t})).then((function(){r&&n.dispatch(Object(u.o)(a._controlId,l.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),v.a.instance.reportSuccess(i)}))}catch(e){var c=h.a.getInstance().getEventParameters(this.contextToken);throw c.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(i,e,null,c),e}},t.prototype.getGrid=function(){var e=_+"getGrid";try{return v.a.instance.reportCall(e),this._grid||(this._grid=new c.a(n,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),v.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return v.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{v.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return v.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{v.a.instance.reportCall(e),this._gridControl.refreshRibbon(),v.a.instance.reportSuccess(e)}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getEntityName=function(){return v.a.instance.reportUsage(_+"getEntityName"),"activitypointer"},t.prototype.getUrl=function(){var e=h.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),v.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""},t.prototype.getFilterXml=function(){var e=_+"getFilterXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),v.a.instance.reportUsage(e),""},t.prototype.getFetchXml=function(){var e=_+"getFetchXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),v.a.instance.reportUsage(e),""},t.prototype.getViewSelector=function(){var e=_+"getViewSelector",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),v.a.instance.reportUsage(e),null},t.prototype.getTeamTemplateId=function(){return null},t.prototype.getRelationship=function(){var e=_+"getRelationship",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),v.a.instance.reportUsage(e),null},t.prototype.setFilterXml=function(e){var t=_+"setFilterXml",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),v.a.instance.reportUsage(t)},t.prototype.addOnLoad=function(e){var t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),v.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")},t.prototype.removeOnLoad=function(e){var t=_+"removeOnLoad",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),v.a.instance.reportUsage(t)},t.prototype.openRelatedGrid=function(){var e=_+"openRelatedGrid",t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),v.a.instance.reportUsage(e)},t}(s.a)},"2ojE":function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"c",(function(){return h})),r.d(t,"b",(function(){return g}));var n=r("VcAV"),a=r("/j9Z"),i=r("yHpA"),o=r("LhJP"),s=r("9r0m"),c=r("TCcM"),u=r("T576"),l=r("sOTk"),p=r("WS0f");function d(e,t,r,n){var a=[];try{var i=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,o=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,p=i&&!s.a.equals(i,s.a.EMPTY)?function(e,t){var r=Object(u.a)(e,t);if(r)return r.businessProcessFlowProcessState;return null}(e,i):0,d=Object(l.l)(e,r),h={name:"ProcessId",value:i?s.a.toString(i):s.a.EMPTYGUIDSTRING},g={name:"ProcessInstanceId",value:o?s.a.toString(o):s.a.EMPTYGUIDSTRING},m={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},f={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},v={name:"ProcessState",value:p},b={name:"PageId",value:r||""},y={name:"PageType",value:d};a.push(h),a.push(g),a.push(m),a.push(f),a.push(v),a.push(b),a.push(y)}catch(e){n.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,a)}return a}function h(e,t,r){r.EventManager.ReportComponentSuccess(e,t)}function g(e,t,r,s,c,u,l){!function(e,t){if(!Object(n.c)(e)){var r=Object(a.c)(e);if(!Object(n.c)(r)){var i=r.errorCode;if(!Object(n.c)(i)){var o={name:"ErrorCode",value:"0x"+i.toString(16)};t.push(o)}}}}(t,s),function(e,t,r,s){if(!Object(n.c)(e)){var c=Object(a.c)(e);if(!Object(n.c)(c)&&!Object(n.c)(c.FaultedSnapshotId)){var u={name:o.p,value:c.FaultedSnapshotId};if(t.push(u),!Object(n.c)(r)&&!Object(n.c)(s)){var l=Object(i.c)(s,r);if(!Object(n.c)(l)){var d=l.snapshotId;if(!Object(n.c)(d)&&!Object(p.b)(d)&&d===c.FaultedSnapshotId){var h={name:o.q,value:"serverSideCurrentForm"};t.push(h)}}}}}}(t,s,u,l),c.EventManager.ReportComponentFailure(e,t,r,s)}},"3INI":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._traversedPath},set:function(e){for(this._traversedPath=Object(n.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(n.a)(this._traversedPath)},enumerable:!1,configurable:!0}),e.getCandidateTraversedPathFromStagStep=function(e,t){t=Object(n.a)(t);var r=!1;if(!e||e.length)return null;for(var a=0;a<e.length;a++){var i=Object(n.a)(e[a].get_stageId());if("".concat(i,","),t===i){r=!0;break}}return r?"".substring(0,"".length-2):null},e.prototype.isInTraversedPath=function(e){return!Object(a.b)(e)&&this._traversedPath.indexOf(Object(n.a)(e))>-1},e}()},"4HtA":function(e,t,r){"use strict";r.d(t,"a",(function(){return ct}));var n,a=r("c/eZ"),i=r("DRVD"),o=r.n(i),s=r("sOTk"),c=r("r0tX"),u=r("6FBX"),l=r("UGbr"),p=r("UTiY"),d=r("c3W+"),h=r("EGdP"),g=r("/j9Z"),m=r("9r0m"),f=r("T576"),v=r("Y70o");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(n||(n={}));var b=function(){function e(e,t){this._getState=e,this._processId=t}return e.prototype.GenerateMessageForAction=function(e){var t="",r="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(v.a)(a,r,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(v.a)(a,r,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(v.a)(a,r,"Crm_GenericErrorMessage");switch(e){case n.Completed:t=String.format(i,(new Date).toLocaleString());break;case n.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t},e.prototype.GetActionMetadata=function(e){var t,r=Object(f.a)(this._getState(),new m.a(this._processId.guid));return r&&r.businessProcessFlowActions&&r.businessProcessFlowActions[e]&&(t=r.businessProcessFlowActions[e]),t},e.prototype.InvokeProcessAction=function(e,t,r){return Xrm.Utility.invokeProcessActionInternal(e,r,t)},e}(),y=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if(!e)return null;var t=function(e){var t=[];return e.forEach((function(e){var r={id:m.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(r)})),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function S(e,t,r,n){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:function(a,i){a.dispatch,a.getState;return function(e,t,r,n,a){return e.retrieveNavigationEntities(t,r,n,a,null).nativePromise().then(_,g.b)}(i.DataSource,e,t,r,n)}}}var C=r("mLFd"),O=r("GWjq"),I=r("phfH"),P=function(){function e(e,t){this.Target=e,this.NewProcess=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),j=function(){function e(e,t,r){this.Target=e,this.NewProcess=t,this.NewProcessInstance=r}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),T=r("RVz9"),E=r("IBKq");function F(e,t,r,n,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:function(o,s){o.dispatch,o.getState;return function(e,t,r,n,a,i,o){var s=new E.a(m.a.toLegacyGuid(t.id),t.etn,m.a.toLegacyGuid(r.id),r.etn,m.a.toLegacyGuid(n),a,m.a.toLegacyGuid(i),m.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(s.DataSource,e,t,r,n,a,i)}}}var A=r("Ia1G"),x=function(){function e(e,t){this.EntityId=e,this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}},e}();var w=function(){function e(e,t){this.EntityLogicalName=e,this.AppModuleId=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}},e}(),N=r("4tno");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k,M=function(){function e(e,t,r){this._name=e,this._uniqueName=t,this._workflowId=r}return Object.defineProperty(e.prototype,"workflowId",{get:function(){return this._workflowId},set:function(e){this._workflowId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueName",{get:function(){return this._uniqueName},set:function(e){this._uniqueName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),e}(),D=r("9rlF"),R=function(){function e(){}return Object.defineProperty(e.prototype,"activeStageId",{get:function(){return this._activeStageId},set:function(e){this._activeStageId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceId",{get:function(){return this._businessProcessInstanceId},set:function(e){this._businessProcessInstanceId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceName",{get:function(){return this._businessProcessInstanceName},set:function(e){this._businessProcessInstanceName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessState",{get:function(){return this._businessProcessState},set:function(e){this._businessProcessState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessStatus",{get:function(){return this._businessProcessStatus},set:function(e){this._businessProcessStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},set:function(e){this._navigationEntities=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpfDefinitionVersionNumber",{get:function(){return this._bpfDefinitionVersionNumber},set:function(e){this._bpfDefinitionVersionNumber=e},enumerable:!1,configurable:!0}),e}(),L=r("3INI"),V=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryField",{get:function(){return this._primaryField},set:function(e){this._primaryField=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityTypeCode",{get:function(){return this._entityTypeCode},set:function(e){this._entityTypeCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityLogicalName",{get:function(){return this._entityLogicalName},set:function(e){this._entityLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyName",{get:function(){return this._primaryKeyName},set:function(e){this._primaryKeyName=e},enumerable:!1,configurable:!0}),e}(),B=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(k||(k={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var G,X=function(){function e(e){this._stageManager=e,this._populateTraversedPath()}return e.prototype.getTraversedPath=function(){return this._traversedPath},e.prototype._populateTraversedPath=function(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path},e}(),q=r("7kKV"),U=r("AqA3"),z=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.invalid,n.stageInvalidReason=U.a.invalid,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),W=(function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.crossEntity,n.stageInvalidReason=U.a.crossEntity,Object.setPrototypeOf(n,t.prototype),n}Object(a.__extends)(t,e)}(Error),function(e){function t(r){var n=e.call(this,r)||this;return n.stageInvalidReason=U.a.unreachable,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error)),H=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.dirtyForm,n.stageInvalidReason=U.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Y=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.end,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Q=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.beginning,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),K=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.stageGate,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),J=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.invalidProcess,n.stageInvalidReason=U.a.invalidProcess,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Z=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=q.a.dirtyForm,n.stageInvalidReason=U.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),$=r("QAhb"),ee=r("TVue"),te=r("rQCE"),re=r("lFQy"),ne=r("Jcuz"),ae=r("690X"),ie=r("eA/s"),oe=r("jJRu"),se=r("g9bv"),ce=r("r454"),ue=r("OROb"),le=r("qYad"),pe=r("TCcM"),de=r("cAHA"),he=r("Sscr"),ge=r("yHpA"),me=r("LteD"),fe=r("BFwB"),ve=function(e){function t(t,r,n){var a=e.call(this,"BusinessProcessFlow_"+t)||this;return a.addEventParameter("ProcessId",r),a.addEventParameter("ProcessInstanceId",n),a}return Object(a.__extends)(t,e),t}(fe.a),be=function(e){function t(t,r){return e.call(this,"Initialized",t,r)||this}return Object(a.__extends)(t,e),t}(ve),ye=function(e){function t(t,r,n){var a=e.call(this,"SetActiveStageEvent",t,r)||this;return a.addEventParameter("ActiveStageId",n),a}return Object(a.__extends)(t,e),t}(ve),_e=function(e){function t(t,r,n){var a=e.call(this,"DisplayStateEvent",t,r)||this;return a.addEventParameter("CurrentDisplayState",n),a}return Object(a.__extends)(t,e),t}(ve),Se=function(e){function t(t,r,n,a){var i=e.call(this,"StatusEvent",t,r)||this;return i.addEventParameter("ProcessStatus",n),i.addEventParameter("CurrentDisplayState",a),i}return Object(a.__extends)(t,e),t}(ve),Ce=r("txwV"),Oe=r("WS0f"),Ie=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}},e}(),Pe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}},e}(),je=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}},e}(),Te=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}},e}(),Ee=r("K1ho"),Fe=r("ObKm"),Ae=r("uwKl"),xe=r("ed60");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(G||(G={}));var we=r("2ojE"),Ne=r("LhJP"),ke=r("lMVv"),Me=r("GHPx"),De=r("h82J"),Re=r("VcAV"),Le=function(){function e(e,t){this._getState=e,this._applicationContext=t}return e.prototype.setBpfInstance=function(e){return this._processInstance=e,this},e.prototype.setBpfInstanceName=function(e){return this._processInstanceName=e,this},e.prototype.setProcess=function(e){return this._process=e,this},e.prototype.setProcessId=function(e){return this._processId=e,this},e.prototype.setFormEntity=function(e){return this._formEntity=e,this},e.prototype.GetFlowStepMetadata=function(e,t){var r=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),n=this._processId&&this._processId.guid||null,a=Object(f.a)(this._getState(),m.a.tryParse(n));if(Object(Re.c)(a))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;var i=a.businessProcessFlowFlows;if(Object(Re.c)(i))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;var o=i[e];return Object(Re.c)(i)?(r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o},e.prototype.openFlowWidget=function(e,t){if(m.a.tryParse(e.flowStepId)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);var r=this._populateFlowDialogParams(e,t),n={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",n,r)},e.prototype._populateFlowDialogParams=function(t,r){var n=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Re.c)(n))throw new Error("BPF Flow Step Failure: null metadata");var a={},i=n.flowId;if(Object(Re.c)(i))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){var o=[];o.push(this._processInstance.id.guid);var s=JSON.stringify(o);a.entity_ids=s}a.flow_id=i,a.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),a.bpf_step_id=t.flowStepId;var c=Xrm.Page.data.entity.getEntityName(),u=this._getState().metadata.entities[c].EntitySetName,l=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");a.entity_logical_collection_name=u,a.entity_logical_name=c,a.flows_destination_url=l,a.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");var p=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");a.flows_fpi_site_url=p+"&flowsEnableWidgetV2=true",a.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),a.flows_enable_widget_v2=!0,e.UpdateEventParameter(r,"flows_destination_url",l),e.UpdateEventParameter(r,"flow_id",i),Object(Re.c)(t.workflowLogId)||t.workflowLogId===m.a.EMPTY||(a.flows_wflog_id=m.a.toString(t.workflowLogId));var d=this._processInstance&&this._processInstance.id;if(Object(Re.c)(d)||d===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+d);a.bpf_instance_id=m.a.toString(d);var h=this._processInstance&&this._processInstance.etn;if(Object(Oe.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+h);a.bpf_instance_entity_name=h;var g=this._processId&&this._processId.guid||null;if(m.a.tryParse(g)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+g);a.bpf_definition_id=g,a.bpf_definition_entity_name="workflow";var f=this._process&&this._process.get_Name();if(Object(Oe.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+f);if(a.bpf_definition_name=f,Object(Oe.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);a.bpf_instance_name=this._processInstanceName;var v=t.selectedStage&&t.selectedStage.get_Description();if(Object(Oe.b)(v))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+v);a.bpf_flowstage_localized_name=v,a.bpf_flowstage_entity_name=c,a.bpf_flowstage_entity_collection_name=u;var b=this._formEntity&&this._formEntity.id;if(Object(Re.c)(b)||b===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+b);a.bpf_flowstage_entity_record_id=m.a.toString(b);var y=m.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Re.c)(y)||y===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+y);a.bpf_activestage_id=m.a.toString(y);var _=t.activeStage&&t.activeStage.get_Description();if(Object(Oe.b)(_))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+_);return a.bpf_activestage_localized_name=_,a.bpf_activestageentity_name="processstage",a},e.prototype._getLocalizedLabel=function(e){return Xrm.Utility.getResourceString("Main_system_library",e)},e.getTelemetryParamsForFlowStep=function(e,t,r,n,a){var i=a||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:r},u={name:"bpf_step_id",value:n};return i.push(o),i.push(s),i.push(c),i.push(u),i},e.UpdateEventParameter=function(e,t,r){e&&0!==e.length&&e.some((function(e){if(e.name===t)return e.value=r,!0}))},e}(),Ve=r("qC0c"),Be=r("pflg"),Ge=r("UWFM"),Xe=r("b1hT"),qe=r("tvev"),Ue=r("RK8T"),ze=r("xc1f"),We=r("yZTI"),He=r("UVKb"),Ye=r("j+yI"),Qe=r("OTOS"),Ke=r("uQP8"),Je=r("lKeh"),Ze=r("IQF2"),$e=r("buKK"),et=r("+D0h"),tt=r("YEEA"),rt=r("2nMH"),nt=o.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),at=o.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),it=o.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ot=o.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=o.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager"),ct=function(){function e(e,t,r,n,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=r,this._stageMetadata=n,this._activeStageManager=a}return e.prototype.initilaizeWithProcessAndFormEntity=function(e,t,r,n,a,i){var o=this,s=nt.startStopwatch({processId:m.a.toString(n),processInstanceId:m.a.toString(a.id)});this._currentPageId=i,this._processId=n,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=r,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);var c=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(c),this._stageMetadata.initializeDefaultPathManager(new X(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;var u={};if(this._isUserSelectedStage)u.selectedStageId=m.a.tryParseOrNull(this.getSelectedStageId());else{var l=this.getActiveStageId();this._isActiveStageInCurrentEntity(l)?u.selectedStageId=m.a.tryParseOrNull(l):u.selectedStageId=this._getDefaultSelectedStageId()||m.a.tryParseOrNull(l)}this._dispatch(Object(re.a)(u,this._currentBpfInstance));var p=new be(m.a.toString(n),m.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(p),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then((function(e){e&&e.getEventManager().addOnProcessChangeEvent(o.getContextToken(),(function(){o._saveCrossEntityBpf()}))}))),Object(Xe.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new b(this._getState,n),this._flowStepManager=new Le(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(f.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Xe.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var d=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.g).error("ProcessManager is initialized with current entity as null",d);Object(we.c)(Ne.g,d,this._applicationContext),s()},e.prototype._saveCrossEntityBpf=function(){var e=this._getState(),t=Object(s.g)(e,this._currentPageId),r=Object(Be.a)(t),n=Object(Be.b)(t);if(r&&n){var a=new $.a(t.data.parentrecordtype,new m.a(t.data.parentrecordid)),i=new $.a(t.entityTypeName,t.id);this._dispatch(Object(Ae.b)(r,i)),this._dispatch(Object(xe.b)(n,i)),this.navigateToNextEntityForCrossEntityBpf(a,i,r,n)}},e.prototype.initilaizeWithFormEntityOnly=function(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Xe.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Xe.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var r=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.f).error("ProcessManager is initialized with current entity as null",r);Object(we.c)(Ne.f,r,this._applicationContext)},e.prototype.setActiveProcess=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(we.b)(Ne.m,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);if(!o)return Object(we.c)(Ne.m,a,t._applicationContext),void n(new Error("Invalid process id"));if(m.a.isNullOrEmpty(t.getCurrentFormEntity().id))return Object(we.c)(Ne.m,a,t._applicationContext),void n(new g.a("Not supported on new records",2147877748));var s=new P({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(o),entityType:u.fc});t._dispatch(Object(T.b)(s)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcess"),Object(we.c)(Ne.m,a,t._applicationContext),r()}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)})),Object(we.b)(Ne.m,e,null,a,t._applicationContext,null,t._getState())}))}))},e.prototype.setActiveProcessInstance=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(we.b)(Ne.n,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);o?t.getProcessInstances().then((function(e){if(e&&e.value){for(var a="",i=0,s=e.value;i<s.length;i++){var c=s[i];if(c&&c.businessprocessflowinstanceid&&c.businessprocessflowinstanceid.toLowerCase()===m.a.toString(o).toLowerCase()){a=c["a_processid_value".substring(1)];break}}if(Object(Oe.b)(a))n(new g.a("Supplied process instance does not match any existing instance on this entity",2147877744));else{var l=m.a.tryParseOrNull(a);if(l){var d=new j({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(l),entityType:u.fc},{id:m.a.toString(o),entityType:u.fc});t._dispatch(Object(T.b)(d)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcessInstance"),r(a)}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)}))}))}else n(new Error("Invalid process id"))}}else n(new Error("No process instances found for current entity"))}),(function(e){t._dispatch(Object(p.b)(e,!0)).then((function(){return n(e)}))})):n(new Error("Invalid process instance id"))}))},e.prototype.setCurrentInstance=function(e){this._currentBpfInstance=e},e.prototype.setStatus=function(e){var t=this;return new Promise((function(r,n){var a;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===B.a.Active)a=t.reactivateProcess();else if(e===B.a.Finished)a=t.completeProcess();else{if(e!==B.a.Aborted)return n(new Error("Invalid status passed to setStatus"));a=t.abandonProcess()}a.then((function(){var n=new Se(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e,t.getDisplayState());t._applicationContext.EventManager.ReportEvent(n),r()}),(function(e){n(e)}))}))},e.prototype.setVisible=function(e){if(!(Object(Oe.a)(this._currentBpfInstance)||Object(Oe.a)(this._currentFormEntity)||Object(Oe.a)(this._currentFormEntity.etn))){var t=Object(he.h)(this._currentFormEntity.etn);this._dispatch(Object(me.b)(this._currentPageId,Ce.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}},e.prototype.isVisible=function(){if(!this._currentBpfInstance)return!1;var e=Object(he.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:Ce.a},e)},e.prototype.getCurrentFormEntity=function(){return this._currentFormEntity},e.prototype.getActiveStageEntityRef=function(){var e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,r=this._getNavigationEntityIdsByEntityLogicalName();return t&&r&&r.hasOwnProperty(t)?new $.a(t,r[t]):null},e.prototype.getProcess=function(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()},e.prototype.getProcessInstanceName=function(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this._currentBpfInstance)},e.prototype.getTraversedPath=function(){return Object(O.h)(this._getState(),this._currentBpfInstance)},e.prototype.getProcessId=function(){return this._processId},e.prototype.getVersion=function(){return this._version},e.prototype.getProcessInstanceId=function(){return this._currentBpfInstance&&this._currentBpfInstance.id},e.prototype.getBpfEntityLogicalName=function(){return this._currentBpfInstance&&this._currentBpfInstance.etn},e.prototype.getEntityStages=function(){return this._stageMetadata.getEntityStages()},e.prototype.getActiveStage=function(){return this._getStage(this.getActiveStageId())},e.prototype.getProcessInstances=function(){var e=this;return new Promise((function(t,r){var n,a;e._dispatch((n=e._currentFormEntity.id,a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute:function(e,t){e.dispatch;var r=e.getState,i=t.DataSource.get_WebAPIService(),o=new x(n,a),s=Object(A.a)(r(),o);return i.sendRequest(s).then((function(e){return e.json()}),g.b)}})).then((function(e){t(e)}),(function(e){r(e)}))}))},e.prototype.getSelectedStage=function(){return this._getStage(this.getSelectedStageId())},e.prototype.isCrossEntityNavigation=function(e){var t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;var r=this._stageMetadata.getStage(t);if(!r)return!1;var n=r.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&n&&n.get_EntityLogicalName()!==this._currentFormEntity.etn},e.prototype._isStageOnPath=function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(m.a.equals(a,e))return!0}return!1},e.prototype.getProcessState=function(){var e=Object(f.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null},e.prototype.getState=function(){if(this._currentBpfInstance){var e=Object(O.f)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getStatusName=function(){if(this._currentBpfInstance){var e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e)return e.label}return null},e.prototype.getStatus=function(){if(this._currentBpfInstance){var e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getActiveStageId=function(){if(this._currentBpfInstance){var e=this._currentBpfInstance&&Object(O.a)(this._getState(),this._currentBpfInstance);if(m.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){var t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=m.a.tryParseOrNull(t))}if(!m.a.isNullOrEmpty(e)){var r=this.getActivePath();if(r&&r.length>0)return this._isStageOnPath(e,r)?e.guid:r[0].guid}}return null},e.prototype.getActivePathStages=function(){var e=this.getActivePath();if(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=this._getStage(e[r].guid);return t}return null},e.prototype.getActivePath=function(){if(!this._currentBpfInstance)return null;var e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e},e.prototype.getDisplayState=function(){return this._currentBpfInstance?Object(I.d)(this._getState())||c.a.getDefaultDisplayState():null},e.prototype.getSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()},e.prototype._getDefaultSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),m.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e},e.prototype._isActiveStageInCurrentEntity=function(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0},e.prototype.getStageMetadata=function(){return this._stageMetadata},e.prototype.isBusinessProcessAborted=function(){return this.getStatus()===B.a.Aborted},e.prototype.isBusinessProcessCompleted=function(){return this.getStatus()===B.a.Finished},e.prototype.moveToNextStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Oe.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getNextStageId(e.getActiveStageId());if(n){t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),0,"MoveToNextStage")})))}else r(new Y("Last stage in the active path reached. Next stage does not exist."))}));return r.then((function(){Object(we.c)(Ne.h,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(we.c)(Ne.h,t,e._applicationContext):Object(we.b)(Ne.h,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.moveToPreviousStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Oe.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getPreviousStageId(e.getActiveStageId());if(!n)return r(new Q("The first stage in the traversed path reached. Previous stage does not exist."));t(e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),1,"MoveToPreviousStage"))})).then((function(){e._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e.getActiveStageId())}));return r.then((function(){Object(we.c)(Ne.i,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(we.c)(Ne.i,t,e._applicationContext):Object(we.b)(Ne.i,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.setActiveStage=function(e){var t=this,r=at.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),a=new Promise((function(r,n){var a=m.a.tryParseOrNull(e),i=t.getTraversedPath();if(Object(Oe.a)(t._currentBpfInstance))return n(new g.a("Process Control does not exist on form.",2147877746));if(!a)return n(new z("setActiveStage can only be called with a valid stage id"));if(!t._stageMetadata.getStage(a.guid))return n(new z("stage id does not exist on any path of the instance"));if(!i)return n(new z("Traversed Path is not present"));if(t.getActiveStageId()===a.guid)return r();var o=new L.a(i);if(!o||!o.isInTraversedPath(e))return n(t.getActivePath().some((function(e){return m.a.equals(e,a)}))?new z("The stage is not in traversed path. Only navigating backwards is supported."):new W("stage id does not exist on the current acitve path of the instance."));r(t._saveFormDataAndActiveStage(a,1,"SetActiveStage"))})).then((function(){var r=new ye(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e);t._applicationContext.EventManager.ReportEvent(r),t._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)}));return a.then((function(){r(),Object(we.c)(Ne.o,n,t._applicationContext)}),(function(e){r(),t._shouldReportErrorAsSuccess(e)?Object(we.c)(Ne.o,n,t._applicationContext):Object(we.b)(Ne.o,e,null,n,t._applicationContext,t.getCurrentFormEntity(),t._getState())})),a},e.prototype.switchProcess=function(){},e.prototype.abandonProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Oe.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessAborted()?t():void t(e._updateStateAndStatusOfProcess(B.a.Aborted,k.Inactive,"AbandonProcess"))}));return r.then((function(){Object(we.c)(Ne.a,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(we.c)(Ne.a,t,e._applicationContext):Object(we.b)(Ne.a,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.reactivateProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Oe.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.getStatus()===B.a.Active?t():void t(e._updateStateAndStatusOfProcess(B.a.Active,k.Active,"ReactivateProcess"))}));return r.then((function(){Object(we.c)(Ne.j,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(we.c)(Ne.j,t,e._applicationContext):Object(we.b)(Ne.j,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.completeProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Oe.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessCompleted()?t():m.a.tryParseOrNull(e._stageMetadata.getNextStageId(e.getActiveStageId()))?r(new g.a("Attempt to finish a process not on last stage.",2148081666)):void t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._updateStateAndStatusOfProcess(B.a.Finished,k.Inactive,"CompleteProcess")})))}));return r.then((function(){Object(we.c)(Ne.c,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(we.c)(Ne.c,t,e._applicationContext):Object(we.b)(Ne.c,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype._shouldReportErrorAsSuccess=function(e){return e instanceof J||(e instanceof K||(e instanceof Y||(e instanceof Q||(e instanceof z||(e instanceof W||e instanceof Z)))))},e.prototype.triggerActionStepClick=function(e){var t=this;if(Object(Oe.b)(e)){var r=new Error("BPF Action Step Failure: null ControlId");throw Object(we.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var n=this._actionStepManager.GetActionMetadata(e);if(Object(Oe.a)(n)){r=new Error("BPF Action Step Failure: null metadata");throw Object(we.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var a=this._getState();if(Object(Oe.a)(a)){r=new Error("BPF Action Step Failure: null state");throw Object(we.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var i=this._getTelemetryParamsForActionStep(n.actionType,e,n.actionId);try{var o=new m.a(n.actionId);if(n.actionType===G.AsyncWorkflow||n.actionType===G.SyncWorkflow){var s=[this._processId.guid,m.a.toString(this.getProcessInstanceId()),o.guid].map((function(e){var t=new Pe;return t.Type="System.String",t.Value=e,t})),c=new je;c.Keys=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],c.Values=s,c.Count=3,c.IsReadOnly=!0;var u=new Te;u.Arguments=c;var l=new Ie;l.EntityId=this._currentFormEntity.id,l.InputArguments=u,l.entity={id:n.workflowId,entityType:"workflow"},this.UpdateActionLog(o,1),this._dispatch(Object(T.b)(l)).then((function(){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2)),Object(we.c)(Ne.b,i,t._applicationContext)}),(function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(we.b)(Ne.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(p.b)(r,!0)).then()}))}else if(n.actionType===G.ProcessAction){var d=function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(we.b)(Ne.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(p.b)(r,!0)).then()},h=function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2));var a=r.get_outputParameters();n.outputBindings.forEach((function(e){if(e.parameterName in a){var r=a[e.parameterName],n=e.boundAttributeName,i={};i[n]={key:n,value:r},t._dispatch(Object(Fe.a)(t._currentPageId,i,!1,!0,t._currentFormEntity.etn,t._currentFormEntity.id.guid,null,t.getContextToken()))}})),Object(we.c)(Ne.b,i,t._applicationContext)},g={};n.inputBindings.forEach((function(e){var r=Object(D.c)(Object(pe.j)(t._getState(),t.getCurrentFormEntity(),e.boundAttributeName));g["ProcessUnification_Arguments_"+e.parameterName]=r})),this._addInputParametersToParamList(n.inputParameters,g),this.UpdateActionLog(o,1),Xrm.Navigation.openDialog(n.workflowId,this._getDialogOptions(),g).then((function(r){if(r=r?r.parameters:{},t._filterInputArguments(r)){var a={id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn};r.Target=a,r.BusinessProcessFlowId=t._processId.guid,r.BusinessProcessFlowInstanceId=m.a.toString(t.getProcessInstanceId()),r.ActionStepId=n.actionId,t._actionStepManager.InvokeProcessAction(n.uniqueName,n,r).then(h,d)}else Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3))}),d)}}catch(e){throw 0===i.length&&(i=this.getTelemetryParams()),Object(we.b)(Ne.b,e,null,i,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}},e.prototype.triggerFlowStepClick=function(e,t){t=t;var r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{var n=m.a.newGuid(),a={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:n};this._flowStepManager.openFlowWidget(a,r),this.UpdateActionLog(new m.a(e),1,void 0,n);var i=this.getActionLog(new m.a(e));this.createWorkflowLogRecord(i),Object(we.c)(Ne.d,r,this._applicationContext)}catch(e){Object(we.b)(Ne.d,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}},e.prototype.refreshFlowStepClick=function(e){var t=this,r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(He.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then((function(){t._updateProcessInstanceModifiedTime(),Object(we.c)(Ne.k,r,t._applicationContext)})).catch((function(e){Object(we.b)(Ne.k,e,null,r,t._applicationContext,t.getCurrentFormEntity(),t._getState())}))},e.prototype._addInputParametersToParamList=function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];"ProcessUnification_Arguments_"+e[a].parameterName in t||(t["ProcessUnification_Arguments_"+e[a].parameterName]=null)}},e.prototype._filterInputArguments=function(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){for(var t in e){var r=e[t];if(t.startsWith("ProcessUnification_Arguments_"))e[t.substring("ProcessUnification_Arguments_".length,t.length)]=r;delete e[t]}return!0}return!1},e.prototype._getDialogOptions=function(){return{height:450,width:450,position:1}},e.prototype._createSnapshotRequest=function(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");var r=new $.a("processstage",e),n=this._calculateNewTraversedPath(e),a={activestageid:{reference:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,t)},e.prototype._addFieldsToBPFSnapshotForCreate=function(e,t){if(!e||!this._hasBpfInstance())return e;var r=Object(Ye.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return r&&(e[r.ReferencingAttribute]={reference:new $.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new $.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e},e.prototype.generateBPFInstanceSnapshotId=function(){if(this.isImmersiveBPF()||!Object(Ve.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;var e=[],t=null;try{var r=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),n=Object(ge.b)(this._getState(),r),a=n.identifier&&n.identifier.id||this._currentFormEntity.id,i=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ye.e)(i))return Object(Ye.f)(this._getState(),r,a,this._dispatch),null;if(!this._hasBpfInstance()||m.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Ye.d)(this._getState(),n.identifier,this._currentPageId))return Object(Ye.f)(this._getState(),r,a,this._dispatch),null;m.a.isNullOrEmpty(a)&&(a=m.a.newGuid(),Object(Ye.f)(this._getState(),r,a,this._dispatch)),t=this._createActiveStageSnapshot(m.a.tryParse(this.getActiveStageId()),a);var o=Object(ge.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map((function(e){return"Property: "+e})).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t},e.prototype._calculateNewTraversedPath=function(e){for(var t="",r=0,n=this.getActivePath();r<n.length;r++){var a=n[r];if(t+=","+a.guid,m.a.equals(a,e))return t.substring(1)}return(t+=","+e.guid).substring(1)},e.prototype._createActiveStageSnapshot=function(e,t){var r=this._createSnapshotRequest(e,t),n=ot.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Oe.a)(a)){var i=Object(se.b)(this._getState(),a.snapshotId,r);return this._dispatch(i),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n(),a.snapshotId}var o=Object(he.h)(this._currentFormEntity.etn),s=Object(he.x)(o),c=Object(oe.b)(this._getState(),this._currentBpfInstance,r,s,this._hasBpfInstance()?de.a.Create:de.a.Update),u=c.payload.snapshotId;return this._dispatch(c),n(),u},e.prototype._hasBpfInstance=function(){return!this._currentBpfInstance||m.a.isNullOrEmpty(this._currentBpfInstance.id)},e.prototype._updateStateAndStatusOfProcess=function(e,t,r){var n=this;return new Promise((function(a,i){var o=n._createStatusAndStateUpdateRequest(e,t),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity()),c=null;if(n.isImmersiveBPF()&&!Object(Oe.a)(s)){var u=Object(se.b)(n._getState(),s.snapshotId,o);n._dispatch(u),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity())}else{var l=Object(he.h)(n.getCurrentFormEntity().etn),d=Object(he.x)(l),h=Object(oe.b)(n._getState(),n._currentBpfInstance,o,d);c=h.payload.snapshotId,n._dispatch(h)}if(!n.executePreEvent("runOnPreProcessStatusChange",r,null,e))if(n._shouldPerformFormSave()){var m=n._validateSnapshot(s).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return n._saveFormEntityAndBPFEntitySnapshots(c,s,!1)})).then((function(){n._executePostEvent("runOnProcessStatusChange",r,null,e)})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,c)})).catch((function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e})).catch((function(e){n._dispatch(Object(p.b)(e,!0)).then((function(){return i(e)}))}));a(m)}else n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){var t=null;t=n.isImmersiveBPF()&&!Object(Oe.a)(s)?s.snapshotId:c;n._dispatch(Object(ue.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then((function(){n._dispatch(Object(le.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh())).then((function(){n._updateProcessInstanceModifiedTime(),n._executePostEvent("runOnProcessStatusChange",r,null,e)})),a()})).catch((function(e){n._dispatch(Object(p.b)(e,!0)).then((function(){return i(e)}))}))}));a()}))},e.prototype._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures=function(e){var t=this;return new Promise((function(r,n){if("CompleteProcess"===e||"MoveToNextStage"===e){var a=t.ValidateRequiredFieldsForNavigation();if(a&&!a.isValid)if("MoveToNextStage"===e)n(new K("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new K("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return r()}))},e.prototype._saveFormChangesBeforeNavigation=function(){var e=this;if(this._shouldPerformFormSave()){var t=Object(ge.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then((function(){return e._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")})).then((function(){var r=e._getColumnsToRefresh();return e._dispatch(Object(ue.c)(t.snapshotId,!0,r))})).catch((function(r){return e._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(r,t.snapshotId),e._dispatch(Object(p.b)(r,!0))}))}return Promise.resolve()},e.prototype._shouldPerformFormSave=function(){var e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),r=this._getState();if(Object(y.kb)(r,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;var n=this._dispatch(Object(De.b)(this._currentPageId,this.getContextToken()));if(n&&n.data&&n.data.getIsDirty){var a=n.data.getIsDirty(),i={name:"shouldPerformMainFormSave",value:a};return t.push(i),e.info("Checking if main form save should be performed due to dirty form",t),a}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1},e.prototype._saveMainFormIfImmersiveBpfAndNewRecord=function(){var e=this,t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===ze.a&&m.a.isNullOrEmpty(this.getCurrentFormEntity().id)){return this._dispatch(Object(l.f)(this._currentPageId,t,!1,1,!1,!1)).then((function(t){e._currentFormEntity=t}))}return Promise.resolve(void 0)},e.prototype._validateSnapshot=function(e){var t=this;return new Promise((function(r,n){var a=t._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),i=t._getSnapshotStateTelemetryParams(e),o=t._currentPageId,s=t.getContextToken(),c=t._dispatch(t._getEventManager().runOnSave(s,1));for(var u in c&&(t._dispatch(Object(d.b)(o,s,2)),t._dispatch(Object(h.b)(o,s,!1)),a.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",i),n(new g.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737))),e.activeChanges){var l=e.activeChanges[u],p=t._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,u),m=Object(Oe.a)(p)?null:p.get_logicalName(),f=Object(Oe.a)(p)?qe.a.get_empty():p.get_id();if(Object(Oe.a)(l))return a.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null fieldValue"));var v=l.validationResult;if(Object(Oe.a)(v)){if(m===Me.c){a.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+m+" with ID: "+f,i);continue}return a.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null validatorResult"))}var b=v.isValueValid;if(Object(Oe.a)(b))return a.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!b){var y={name:Ne.q,value:"clientSideCurrentForm"};return i.push(y),a.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+m+" with ID: "+f,i),n(new H("Unable to save form data due to validation errors"))}}return r(!0)}))},e.prototype._createStatusAndStateUpdateRequest=function(e,t){var r;return(r={}).statuscode={label:B.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r.statecode={label:k[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r},e.prototype.ValidateRequiredFieldsForNavigation=function(){for(var e=it.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),t=this._getState(),r=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),n=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a={emptySteps:[],errorSteps:[]},i=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),u=0,p=r;u<p.length;u++){var d=p[u];c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+d,o);var h=Object(pe.j)(this._getState(),this.getCurrentFormEntity(),d);i&&i.activeChanges&&d in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+d,o),h=i.activeChanges[d]),Object(I.h)(h,this._getState(),this.getCurrentFormEntity().etn,d)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+d,o),a.emptySteps.push(d)):h.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+d,o),a.errorSteps.push(d))}for(var g=0,f=n;g<f.length;g++){var v=f[g],b=m.a.tryParse(v);if(m.a.isNullOrEmpty(b))c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+v,o);else{var _=this.getActionLog(b);if(_){var S=_.status;2!==S&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+v+". The Flow Step Action Log has stauts of : "+S,o),a.errorSteps.push(v))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+v+". No action logs were found for this Flow Step",o),a.errorSteps.push(v)}}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;var C=Object(Ke.a)(t,this._currentPageId);if(!Object(y.Gb)(C,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);var O=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(l.f)(this._currentPageId,O,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){var P=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(P,o)}return e(),a},e.prototype.setSelectedStage=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise((function(n,a){var i=m.a.tryParseOrNull(e);if(!i)return a("setSelectedStage can only be called with a valid stage id");var o={selectedStageId:i};r._updateBusinessProcessFlowData(r._currentBpfInstance,o),r._isUserSelectedStage=t,t&&r._executePostEvent("runOnStageSelected","setSelectedStage"),n()}))},e.prototype.setDisplayState=function(e){if(this._currentBpfInstance&&(e===c.a.collapsed||e===c.a.expanded||e===c.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);var t=new _e(m.a.toString(this._processId),m.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}},e.prototype.setActivePath=function(e){if(e&&0!==e.length){for(var t=[],r=0;r<e.length;r++)t[r]=new m.a(e[r]);var n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}},e.prototype.setBpfNavigationBehavior=function(e){var t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)},e.prototype.getBpfNavigationBehavior=function(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())},e.prototype.shouldReInitializeNavigationBehavior=function(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Oe.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))},e.prototype.getBpfNavigationBehaviorAllowCreateNew=function(e){var t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)},e.prototype.createWorkflowLogRecord=function(e){var t;if(Object(Oe.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");var r=this._getState();if(Object(Oe.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");var n=r.metadata;if(Object(Oe.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");var a=n.entities;if(Object(Oe.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");var i=this._currentBpfInstance.etn;if(Object(Oe.b)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");var o=a[i];if(Object(Oe.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");var s=o.EntitySetName;if(Object(Oe.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");var c=Object(ke.z)(r,"workflowlog",o.EntityLogicalName,"asyncoperationid");if(Object(Oe.a)(c))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Oe.b)(c.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");var u=c.ReferencingEntityNavigationPropertyName+"@odata.bind",l="/"+s+"("+e.processInstanceid.guid+")",p=((t={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid})[u]=l,t.activityname=e.processDefinitionid.guid,t.status=e.status,t);Xrm.WebApi.createRecord("workflowlog",p)},e.prototype._getTracer=function(){return Object(Oe.a)(this._applicationContext)||Object(Oe.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")},e.prototype._getDefaultActivePath=function(){var e=this._getTracer();if(Object(Oe.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;var t=this._stageMetadata.getDefaultPathManager();if(Object(Oe.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;var r=t.getDefaultPath();if(Object(Oe.a)(r))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;var n=[];for(var a in r){var i=m.a.parse(r[a]);n.push(i)}return n},e.prototype._updateBusinessProcessFlowData=function(e,t){e&&(this._dispatch(Object(re.a)(t,e)),this._updateProcessInstanceModifiedTime())},e.prototype._updateDisplayState=function(e,t){this._dispatch(Object(ne.a)(t,e)),this._updateProcessInstanceModifiedTime()},e.prototype.getForwardNavigationEntities=function(e,t,r,n){var a=this;return this._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(S(e,t,r,n||null))}))},e.prototype.navigateToNextEntity=function(e,t,r,n){var a=this;return new Promise((function(i,o){var s=a.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return o(new K("Unable to navigate to next stage as required fields have not been set"));var c=a._stageMetadata.getNextStageId(a.getActiveStageId());if(!c)return o(new Y("Last stage in the active path reached. Next stage does not exist."));var u=new m.a(c),l=a.getTraversedPath()+","+c;return a._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(F(e,t,u,l,r,n))})).then((function(){return a.setSelectedStage(c)})).then((function(){a._executePostEvent("runOnStageChange","navigateToNextEntity",0),i()})).catch((function(e){a._dispatch(Object(p.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.navigateToNextEntityForCrossEntityBpf=function(e,t,r,n){var a=this;return new Promise((function(i,o){a._dispatch(F(e,t,new m.a(a.getActiveStageId()),a.getTraversedPath(),r,n)).then((function(){a._dispatch(Object(ie.b)(t,a._currentBpfInstance)),a._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),i()})).catch((function(e){a._dispatch(Object(p.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.getActiveStageActiveFor=function(){if(this._currentBpfInstance){var e=Object(O.b)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceActiveFor=function(){if(this._currentBpfInstance){var e=Object(O.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceCompletedIn=function(){if(this._currentBpfInstance){var e=Object(O.d)(this._getState(),this._currentBpfInstance),t=Object(O.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null},e.prototype.getActionLogCollection=function(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null},e.prototype.getActionLog=function(e){var t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null},e.prototype.UpdateActionLog=function(e,t,r,n){if(!this._currentBpfInstance)return null;var i=Object(I.a)(this._getState(),this.getProcessInstanceId()),o=i&&i[e.guid]?i[e.guid]:null,s=(m.a.EMPTY,{actionLogId:Object(Oe.a)(n)||n===m.a.EMPTY?o?o.actionLogId:m.a.newGuid():n,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:r}),c=Object(a.__assign)({},i);c[e.guid]=s;var u={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,u),"success"},e.prototype.getEnabledProcesses=function(){var e=this,t=[];return new Promise((function(r,n){var a;e._currentFormEntity&&e._currentFormEntity.etn?e._dispatch((a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute:function(e,t){e.dispatch;var r=e.getState,n=t.DataSource.get_WebAPIService(),i=r(),o=m.a.tryParse(Object(N.i)(i)),s=new w(a,o),c=Object(A.a)(r(),s);return n.sendRequest(c).then((function(e){return e.json()}),g.b)}})).then((function(e){for(var n=0,a=e.value;n<a.length;n++){var i=a[n];t.push(new M(i.name,i.uniquename,i.workflowid))}r(t)}),(function(e){n(e)})):n(new g.a("Current Form Entity cannot be NULL",2147877745))}))},e.prototype.getNavigationEntities=function(){return this._activeStageManager.navigationEntities},e.prototype._getNavigationEntityIdsByEntityLogicalName=function(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName},e.prototype._updateGlobalActiveStage=function(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)},e.prototype._createGlobalNavigationData=function(e){var t=new R,r=Object(D.b)(e.activestageid);t.activeStageId=m.a.toString(r);var n=Object(D.c)(e.traversedpath);Object(Oe.b)(n)&&(n=L.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=n,t.navigationEntities=[];for(var a=0,i=this._getNavigationEntityTypesFromWorkflowObjectModel();a<i.length;a++){var o=i[a],s=new V;for(var c in s.entityLogicalName=o,s.id=m.a.EMPTY.guid,e)if(Object(D.k)(e[c])){var u=e[c],l=[];if(Object(Oe.a)(u.reference)||Object(Oe.a)(u.reference.etn))l.push({name:"entityReference.reference",value:"NULL"}),this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",l);u&&u.reference&&u.reference.etn===o&&(s.id=u.reference.id.guid)}t.navigationEntities.push(s)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(D.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(D.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(D.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(D.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(D.c)(e.bpfDefinitionVersioNumber)),t},e.prototype._getNavigationEntityTypesFromWorkflowObjectModel=function(){var e={};if(!Object(Oe.a)(this.getProcess()))for(var t=0;t<this.getProcess().get_Steps().get_Count();t++){var r=this.getProcess().get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){var n=r.get_Description();e[n]||(e[n]=n)}}return Object.keys(e)},e.prototype.reflow=function(e,t,r){var n=this._stageMetadata.getDefaultPathManager();if(t||r){if(t){t=new m.a(t).guid;var a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===t||a.indexOf(t)<0)&&(n.updateDefaultPath(t,r),this._updateProcessInstanceModifiedTime())}}else this._reflowInternal()},e.prototype._reflowInternal=function(e,t){var r=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(r.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())},e.prototype.callPblToEvaluateBranching=function(e){var t=this,r=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");var n=Object(ee.a)(r,this._currentPageId);this.getScriptContainerPromise().then((function(r){n<te.a.EditReady&&r.getEventManager().addOnLoadEvent(t.getContextToken(),(function(){r.execute(e,[])})),n>=te.a.OnLoadReady&&r.execute(e,[])}))},e.prototype.update=function(e){!Object(Oe.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()},e.prototype.waitForOngoingWork=function(){return Ze.a.getInstance().checkForOutstandingWork(this._getState())},e.prototype._getEventManager=function(){var e=this.getScriptContainer();return e?e.getEventManager():null},e.prototype.getScriptContainer=function(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;var e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e},e.prototype.getScriptContainerPromise=function(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")},e.prototype._executePostEvent=function(e,t,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),Object(We.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),B.a[n],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,r));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}},e.prototype.executePreEvent=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var a=!1;if(!Object(We.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),B.a[n],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,r))}return this._logTraceInfoForProcessPreEvent(a,e,t,t),a}return this._logTraceFailureForProcessEvent(t,e,e),a},e.prototype._saveFormDataAndActiveStage=function(e,t,r){var n=this,a=st.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),i=this.executePreEvent("runOnPreStageChange",r,t),o=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(!i){var s=new Promise((function(t,a){if(!e)return a(new z("Attemping to save invalid stage id"));for(var i,s,c=["traversedpath","activestageid","activestagestartedon","completedon"],u=n.getNavigationEntities(),l=Object(f.b)(n._getState(),n._currentBpfInstance),p=0,d=u;p<d.length;p++){var h=d[p];for(var m in l)if(m.includes(h.entityLogicalName)){c.push(m);break}}if(n._shouldPerformFormSave()){var v=n._getState();i=n._validateSnapshot(o).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return s=n._createActiveStageSnapshot(e),n._saveFormEntityAndBPFEntitySnapshots(s,o,!1)})).then((function(){var e=n.getCurrentFormEntity();n._dispatch(Object(rt.a)(n._currentPageId,v,n.getContextToken(),e.etn,e.id))})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,s)}))}else i=n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){return s=n._createActiveStageSnapshot(e),n._dispatch(Object(ue.c)(s,!0,c,n._getRetrieveProcessControlDataRequest())).then((function(){n._dispatch(Object(le.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh(),n._getRetrieveProcessControlDataRequest())),n._dispatch(Object(C.b)(!0,n._currentFormEntity))}))}));t(i)})).then((function(){var e=n.getTraversedPath(),a=n.getActiveStageId();n._updateGlobalActiveStage(e,a),n.setSelectedStage(a),n._executePostEvent("runOnStageChange",r,t)}),(function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}));return s.then(c,c),s}function c(){a()}},e.prototype._handleDuplicateDetection=function(e,t){var r=this;if(Object(tt.e)(e))return this._dispatch(Object($e.a)(this._currentPageId,e,this._currentFormEntity)).then((function(e){return 0===e.status?r._dispatch(Object(et.a)(e.pageId)).then((function(e){return e.value.param_lastButtonClicked===l.a?Promise.resolve("success"):Promise.resolve("aborted")})):Promise.resolve("noop")})).then((function(e){if("success"===e){var n=Object(ge.c)(r._getState(),r.getCurrentFormEntity());return r._saveFormEntityAndBPFEntitySnapshots(t,n,!0)}}));throw e},e.prototype._saveFormEntityAndBPFEntitySnapshots=function(e,t,r){var n={};n[t.identifier.etn]=this._getColumnsToRefresh();var a=null;return a=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(ue.d)(a,r,n,this._getRetrieveProcessControlDataRequest()))},e.prototype._logTraceInfoForProcessPreEvent=function(e,t,r,n){var a=this._applicationContext.TraceManager.getTracer(n),i=this.getTelemetryParams(),o={name:"BpfOperationName",value:r};i.push(o);var s={name:"eventName",value:t};i.push(s);var c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+t,i)},e.prototype._logTraceFailureForProcessEvent=function(e,t,r){var n=this._applicationContext.TraceManager.getTracer(r),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});var o={name:"eventName",value:t};a.push(o);var s={name:"isPageDead",value:Object(We.n)(this._getState(),this._currentPageId)};a.push(s);var c={name:"currentPageId",value:this._currentPageId};a.push(c),n.error("BPF ProcessManager not able to to execute scripts registered on event "+t+" does not exist",a)},e.prototype._logTraceFailureForScriptContainer=function(){var e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});var r={name:"IsPageDead",value:Object(We.n)(this._getState(),this._currentPageId)};t.push(r);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)},e.prototype._getStage=function(e){var t=this,r=null;if(e){var n=this.getEntityStages();n&&n.some((function(n){for(var a=0;a<n.get_Steps().get_Count();a++){var i=n.get_Steps().get_item(a);if(t._equalsIgnoreCase(e,i.get_Id()))return r=i,!0}}))}return r},e.prototype.getContextToken=function(){return Object(he.j)(this._getState(),this._currentPageId)},e.prototype._updateProcessInstanceModifiedTime=function(){this._dispatch(Object(ae.b)(this.getCurrentFormEntity()))},e.prototype._isSelectedStageControl=function(e){if(!Object(Oe.a)(this.getSelectedStage()))for(var t=this.getSelectedStage().get_Steps(),r=0;r<t.get_Count();r++)if(this._equalsIgnoreCase(t.get_item(r).get_Id(),e))return!0;return!1},e.prototype._equalsIgnoreCase=function(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()},e.prototype._getSnapshotStateTelemetryParams=function(e){var t=[];if(Object(Oe.a)(e))return t;var r={name:"mode",value:e.mode},n={name:"identifierId",value:Object(Oe.a)(e.identifier)||Object(Oe.a)(e.identifier.id)?null:m.a.toString(e.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(Oe.a)(a)?null:m.a.fromLegacyGuid(a.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(Oe.a)(a)?null:a.get_objectTypeCode()},s={name:"activeChanges",value:Object(Oe.a)(a)?null:this._getIFieldValuesString(e.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(Oe.a)(a)?null:this._getIFieldValuesString(e.lockedChanges,a.get_logicalName())};return t.push(r),t.push(i),t.push(o),t.push(n),t.push(s),t.push(c),t},e.prototype._getTelemetryParamsForActionStep=function(e,t,r){var n=this.getTelemetryParams(),a={name:"ActionStepType",value:e},i={name:"ControlId",value:t},o={name:"ActionStepId",value:r};return n.push(a),n.push(i),n.push(o),n},e.prototype.getTelemetryParams=function(){var e=[];try{var t={name:"ProcessId",value:m.a.toString(this.getProcessId())},r={name:"ProcessInstanceId",value:m.a.toString(this.getProcessInstanceId())},n={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},u={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?m.a.toString(this.getCurrentFormEntity().id):""},l={name:"ProcessState",value:this.getProcessState()},p={name:"PageId",value:this._currentPageId},d={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},g={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Ve.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var f={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},v={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(f),e.push(v)}var b={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(r),e.push(n),e.push(i),e.push(o),e.push(a),e.push(c),e.push(u),e.push(l),e.push(p),e.push(d),e.push(h),e.push(g),e.push(b)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e},e.prototype._getIFieldValuesString=function(e,t){var r="";if(!Object(Oe.a)(e))for(var n in e)if(Object(Oe.a)(n))r+=String.format("[fieldName: {0}]",null);else{var a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,n),i=e[n];if(Object(Oe.a)(i)||Object(Oe.a)(a))r+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Oe.a)(i),Object(Oe.a)(a));else{var o="";Object(Oe.a)(i.timestamp)||(o=i.timestamp.toUTCString());var s="",c="",u=null,l=null;Object(Oe.a)(i.validationResult)||(s=i.validationResult.errorId,c=i.validationResult.errorMessage,u=i.validationResult.isOfflineSyncError,l=i.validationResult.isValueValid);var p=a.get_id();r+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",p,o,s,c,u,l)}}return r},e.prototype._getActivePathString=function(){var e=this.getActivePath(),t="";if(e&&e.length>0){for(var r=0;r<e.length-1;r++)t=t+e[r].guid+",";t+=e[e.length-1].guid}return t},e.prototype.isImmersiveBPF=function(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn},e.prototype._getColumnsToRefresh=function(){var e=Object(Qe.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Oe.a)(t)){var r=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),a=this._getSnapshotStateTelemetryParams(r);return n.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",a),[]}var i=Object(ke.E)(this._getState(),t.entityTypeName),o=Object(l.g)(this._getState(),e,t,i,null);return o&&o.hasOwnProperty(t.entityTypeName)?o[t.entityTypeName]:[]},e.prototype._getRetrieveProcessControlDataRequest=function(){var e=this.getProcessId()&&!m.a.equals(this.getProcessId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!m.a.equals(this.getProcessInstanceId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new Ue.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new Ue.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null},e.prototype.getCustomControlIndicator=function(){return this._customControlsPresent},e.prototype.setCustomControlIndicator=function(e){this._customControlsPresent=e},e.prototype.getFormXmlRenderingIndicator=function(){return this._renderedFromFormXml},e.prototype.setFormXmlRenderingIndicator=function(e){this._renderedFromFormXml=e},e.prototype.getInstanceModifiedTimestamp=function(){return this._instanceModifiedTimestamp},e.prototype.isBpfFormDescriptorValid=function(e,t,r,n){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Je.f)(e,t,r,n)),this._isBpfFormValid},e.prototype._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure=function(e,t){var r=t;if(Object(Oe.a)(t)){var n=Object(g.c)(e);r=!Object(Oe.a)(n)&&n.FaultedSnapshotId}!Object(Oe.b)(r)&&this._dispatch(Object(ce.b)(r,!1));var a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());a&&!Object(Oe.a)(a.snapshotId)&&a.snapshotId!==r&&this._dispatch(Object(ce.b)(a.snapshotId,!1))},e}()},"4Q7K":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="dataset.set.newPageRequested";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(t),o=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:o}}}},"5cS+":function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return d}));var n=r("c/eZ"),a=r("9r0m"),i=r("gBKR"),o=r("r2h9"),s=r("/j9Z"),c=r("olrR"),u=r("uO/V"),l=r("/45f"),p=r("Gemh");function d(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute:function(d,g){var m=d.dispatch,f=d.getState,v=g.TraceManager.getTracer(u.z),b=u.x+".loadDataSetHostDependenciesAction";v.info("Retrieving view with ID "+a.a.toString(t)+" for "+e+" entity.");var y=Object(p.pb)(f(),e,t);return m(Object(c.a)(e,o.a.MAIN_APPLICATION_VIEW,y,t)).then((function(o){if(!o){var c="Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID "+a.a.toString(t)+" for "+e;return g.EventManager.ReportComponentFailure(b,Error(c)),Promise.reject(new s.a(l.b))}var u=h(f(),t,r);return m(Object(i.e)(u)).then((function(){var r=[{name:"entityTypeName",value:e},{name:"viewId",value:a.a.toString(t)}];return g.EventManager.ReportComponentSuccess(b,r),Promise.resolve()})).catch((function(r){var i=[];for(var o in u)u[o].length&&(i=Object(n.__spreadArrays)(u[o],i));var c="Unable to retrieve DataSetHost dependencies for the grid for view with ID "+a.a.toString(t)+". Failed to retrieve entity with attributes "+i.join()+" for "+e;return g.EventManager.ReportComponentFailure(b,Error(c)),Promise.reject(new s.a(l.a))}))}))}}}function h(e,t,r){var n=Object(p.qb)(e,t,r),a={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){var i=[];n.grid.rows[0].cells.forEach((function(e){if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){var t=e.name.split(".")[1];a[e.relatedEntityName]||(a[e.relatedEntityName]=[]),-1===a[e.relatedEntityName].indexOf(t)&&t&&a[e.relatedEntityName].push(t)}}else-1===i.indexOf(e.name)&&i.push(e.name)})),i.length>0&&(a[n.entityLogicalName]=i)}return a}},"7bez":function(e,t,r){"use strict";r.d(t,"a",(function(){return A})),r.d(t,"b",(function(){return x}));var n,a,i=r("1z64"),o=r("sOTk"),s=r("/zIU"),c=r("PZxu"),u=r("9r0m"),l=r("Wye+"),p=r("+Z9T"),d=r("Gemh"),h=r("IiPO"),g=r("HSdq"),m=r("/j9Z"),f=r("Sscr"),v=r("ezfI"),b=r("kvLG"),y=function(){function e(e,t,r,a,o){this._pageId=r,n=e,this._contextToken=t,this._controlName=a,this._gridType=o,this._clientApiExecutor=new i.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:o,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}return e.prototype.setCurrentView=function(e){var t=this;this._clientApiExecutor.executeAsync("setCurrentView",(function(r,a){return e&&e.id?n.dispatch(Object(l.a)(t._pageId,t._contextToken,t._controlName,e.id)):(a.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(r).error("View ID is required",a),Promise.resolve())}))},e.prototype.getCurrentView=function(){var e="ClientApi.XrmViewSelector.getCurrentView";try{v.a.instance.reportCall(e);var t=Object(d.hb)(n.getState(),this._pageId,this._contextToken,this._controlName),r=null,a=null;if(t)a=t.ViewId;else if(3===this._gridType){var i={id:this._pageId},o=Object(g.fb)(n.getState(),i,this._contextToken.parentContextToken);if(!(o&&o.Controls&&o.Controls[this._controlName]&&o.Controls[this._controlName].Parameters&&o.Controls[this._controlName].Parameters.ViewId)){var s=void 0;return o?o.Controls?o.Controls[this._controlName]?o.Controls[this._controlName].Parameters?o.Controls[this._controlName].Parameters.ViewId||(s="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):s="formDescriptor.Controls[this._controlName].Parameters is null or undefined":s="formDescriptor.Controls[this._controlName] is null or undefined":s="formDescriptor.Controls is null or undefined":s="formDescriptor is null or undefined",(b=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a(s),null,b),null}a=o.Controls[this._controlName].Parameters.ViewId}if(a){if(r=Object(d.qb)(n.getState(),u.a.parse(a),this._pageId)){var c={entityType:Object(d.ob)(n.getState(),a,this._pageId),id:u.a.externalGuid(r.viewId),name:r.title};return v.a.instance.reportSuccess(e),c}var l=[];return l.push({name:"controlName",value:this._controlName}),l.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,l),null}var p=[];return p.push({name:"controlName",value:this._controlName}),p.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,p),null}catch(t){var b;throw(b=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,b),t}},e.prototype.isVisible=function(){var e="ClientApi.XrmViewSelector.isVisible";try{if(v.a.instance.reportCall(e),Object(p.a)(this._isVisible)){var t=Object(d.hb)(n.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{var r={id:this._pageId},a=Object(g.fb)(n.getState(),r,this._contextToken.parentContextToken);if(!(a&&a.Controls&&a.Controls[this._controlName]&&a.Controls[this._controlName].Parameters&&a.Controls[this._controlName].Parameters.EnableViewPicker))return(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a("FormDescriptor is null"),null,i),!1;this._isVisible=a.Controls[this._controlName].Parameters.EnableViewPicker}}return v.a.instance.reportSuccess(e),this._isVisible}catch(t){var i;throw(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e}(),_=r("h82J"),S=r("fW82"),C=r("tcXs"),O=r("Cgjg"),I=r("lMVv"),P=r("r2h9"),j=r("gLMt"),T=r("qC0c"),E=r("cZkS"),F=r("Ka9P"),A=function(){function e(e,t,r,n,o,s,c,u){this._relationship=null;var l="ClientApi.XrmGridControl.constructor";e||Object(p.j)(l,"store"),t||Object(p.j)(l,"contextToken"),r||Object(p.j)(l,"pageId"),a=e,this._pageId=r,this._contextToken=t,this._controlName=u,this._isEditable=n,this._gridType=o,this._applicationContext=c,s||a.dispatch(Object(_.a)(this,r,t)),this._clientApiExecutor=new i.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:u,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:n,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:o,isEventParam:!0})}return Object.defineProperty(e.prototype,"_connectedControlProps",{get:function(){return{controlName:this._controlName,id:this._pageId}},enumerable:!1,configurable:!0}),e.prototype.setFilterXml=function(e){var t=this;this._clientApiExecutor.executeAsync("setFilterXml",(function(){var r=(new Date).getTime();return a.dispatch(Object(O.b)(e,1,t._pageId,t._contextToken,r))}))},e.prototype.getFilterXml=function(){var e="ClientApi.XrmGridControl.getFilterXml";try{v.a.instance.reportCall(e);var t=Object(d.u)(a.getState(),this._pageId,this._contextToken);return v.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFetchXml=function(){var e="ClientApi.XrmGridControl.getFetchXml";try{v.a.instance.reportCall(e);var t=Object(d.A)(a.getState(),this._contextToken,{id:this._pageId});return v.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getGrid=function(){var e="ClientApi.XrmGridControl.getGrid";try{return v.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new c.a(a,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),v.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getViewSelector=function(){var e="ClientApi.XrmGridControl.getViewSelector";try{return v.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(a,this._contextToken,this._pageId,this._controlName,this._gridType)),v.a.instance.reportSuccess(e),this._viewSelector}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getTeamTemplateId=function(){var e="ClientApi.XrmGridControl.getTeamTemplateId";try{v.a.instance.reportCall(e);var t=null,r=a.getState();if(Object(T.c)(r,E.c))if(this.getEntityName()&&3===this._gridType){var n=Object(g.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken);n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters.TeamTemplateId&&(t=n.Controls[this._controlName].Parameters.TeamTemplateId)}return v.a.instance.reportSuccess(e),t}catch(t){var i=h.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getEntityName=function(){var e=this;return this._clientApiExecutor.execute("getEntityName",(function(t,r){if(!e._entityName){if(e._entityName=Object(d.F)(a.getState(),e._pageId,e._contextToken,e._controlName),!e._entityName&&3===e._gridType){var n=Object(g.fb)(a.getState(),e._connectedControlProps,e._contextToken.parentContextToken);if(!(n&&n.Controls&&n.Controls[e._controlName]&&n.Controls[e._controlName].Parameters&&n.Controls[e._controlName].Parameters.TargetEntityType)){var i=void 0;return n?n.Controls?n.Controls[e._controlName]?n.Controls[e._controlName].Parameters?n.Controls[e._controlName].Parameters.TargetEntityType||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",e._clientApiExecutor.reportFailure(t,new m.a(i),r),null}e._entityName=n.Controls[e._controlName].Parameters.TargetEntityType}if(!e._entityName)return e._clientApiExecutor.reportFailure(t,new m.a("Logical name of the entity type is coming as null or undefined."),r),null}return e._entityName}))},e.prototype.refresh=function(){var e=this;this._clientApiExecutor.executeAsync("refresh",(function(){return a.dispatch(Object(l.a)(e._pageId,e._contextToken,e._controlName))}))},e.prototype.refreshRibbon=function(){var e=this;this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(C.a)(e._pageId,Object(d.w)(a.getState(),e._pageId,e._contextToken)))}))},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridControl.getUrl";try{v.a.instance.reportCall(t);var r,n=null,i=this._getCurrentView();n={entityTypeName:this.getEntityName()},i&&(n.viewType="savedquery"===i.entityType?P.b.savedview:P.b.userview,n.viewId=new u.a(i.id)),r=s.a.Grid;var o=null;if(1===e)o=a.dispatch(Object(S.a)(r,n));else{var c=Object(j.a)(a,this._pageId);o=a.dispatch(Object(S.c)(c,r,n))}return v.a.instance.reportSuccess(t),o}catch(e){var l=h.a.getInstance().getEventParameters(this._contextToken);throw l.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(t,e,null,l),e}},e.prototype.getRecordSetQueryKey=function(){var e=this;return this._clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(d.cb)(a.getState(),e._contextToken,{id:e._pageId})}))},e.prototype.getGridType=function(){return v.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType},e.prototype.getRelationship=function(){var e=this;return this._clientApiExecutor.execute("getRelationship",(function(t,r){if(!e._relationship){var n=Object(d.v)(a.getState(),e._pageId,e._contextToken);if(n){var i=n.relationshipName;if(i&&(e._relationship=x(i,e.getEntityName()),n.relationshipRoleOrdinal)){var o=n.relationshipRoleOrdinal===F.a.Referencing?1:2;e._relationship.roleType=o}}else b.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",r)}return e._relationship}))},e.prototype.getParentForm=function(){var e="ClientApi.XrmGridControl.getParentForm";try{v.a.instance.reportCall(e);var t=this._contextToken&&this._contextToken.parentContextToken?a.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return v.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getRollupType=function(){var e=this;return this._clientApiExecutor.execute("getRollupType",(function(){return Object(d.eb)(a.getState(),e._pageId,e._contextToken)}))},e.prototype._getCurrentView=function(){var e=null,t=this.getViewSelector().getCurrentView();if(t)return{entityType:e="savedquery"===t.entityType?"savedquery":"userquery",id:t.id};var r=Object(o.g)(a.getState(),this._pageId);if(r.viewType&&r.viewId){var n=r.viewId?u.a.externalGuid(r.viewId):void 0;if((e=r.viewType===P.b.savedview?"savedquery":"userquery")&&n)return{entityType:e,id:n}}return null},e}();function x(e,t){var r={};r.name=e;var n=Object(I.h)(a.getState(),t);if(n){var i=void 0;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?i=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(i=n.ManyToOneRelationships[e]),i)r.attributeName=i.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=i.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){var o=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=o.Entity1IntersectAttribute,r.navigationPropertyName=o.Entity1NavigationPropertyName):(r.attributeName=o.Entity2IntersectAttribute,r.navigationPropertyName=o.Entity2NavigationPropertyName)}}return r}},"7oc5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i=r("zETL"),o="grid.toggleRollupView";var s=function(e,t,r){return function(e,t,r,o){return{type:"grid.toggleRollupView.async",execute:function(s,c){var u=s.dispatch,l=c.TraceManager.getTracer(a.z),p=a.x+".toggleRollupViewAction";try{l.info("Setting Toggle value to "+t+" for the grid.");var d=Object(n.v)(o);u(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,d)),u(Object(i.b)(r,o));var h=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(p,h),Promise.resolve()}catch(e){c.EventManager.ReportComponentFailure(p,Error("Setting Toggle value to the grid failed"))}}}}(o,e,t,r)}},"7z0H":function(e,t,r){"use strict";r.d(t,"f",(function(){return _e})),r.d(t,"h",(function(){return ne})),r.d(t,"i",(function(){return pe})),r.d(t,"j",(function(){return de})),r.d(t,"k",(function(){return he})),r.d(t,"c",(function(){return oe})),r.d(t,"d",(function(){return se})),r.d(t,"a",(function(){return te})),r.d(t,"b",(function(){return re})),r.d(t,"e",(function(){return ae})),r.d(t,"g",(function(){return ye}));var n=r("wQXd"),a=r("9r0m"),i=r("i8/j"),o=r("/j9Z"),s=r("HSdq"),c=r("2OIc"),u=r("sOTk"),l=r("QAhb"),p=r("F2uj"),d=r("7EJx"),h=r("ObKm"),g=r("CpQy"),m=r("gBKR"),f=r("jJRu"),v=r("cAHA"),b=r("lMVv"),y=r("TCcM"),_=r("GWjY"),S=r("DJ9D");var C=r("VWqI"),O=r("Cfob"),I=r("Qeyq"),P=r("r4Uk"),j=r("T2Xs"),T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=r("aUuu"),F=r("Sscr"),A=r("mGpW"),x=r("RNNy"),w=r("WACO"),N=r("M6d0"),k=r("n+eO"),M=r("yHpA"),D=r("+l2M"),R=r("YHw6"),L=r("IfuP"),V=r("cL6R"),B=r("YEEA"),G=r("Ww2r"),X=r("EcZf"),q=r("BRt1"),U=r("U0B9"),z=r("jm5F"),W=r("TiXY"),H=r("wUng"),Y=r("cZkS"),Q=r("qC0c"),K=r("AfKB"),J=r("455M"),Z=r("ZEX9"),$=r("yZTI"),ee=r("uQP8"),te="form.initialize",re="form.xrmready";function ne(e,t,r,n,c){var g=[{name:"formId",value:a.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(F.v)(r)}];return{type:"form.initialize.async",execute:function(m,f,v){var y,_=m.dispatch,S=m.getState,O=S(),I=Object(u.g)(O,t),A=I.entityTypeName,x=I.data,M=I.recordSetQueryKey,L=f.TraceManager.getTracer("Forms.InitializeForm"),G=[];if(g.push({name:"isPreview",value:I&&I.isPreview}),g.push({name:"EntityName",value:I&&I.entityTypeName}),L.info("initializeForm started.",g),Object(Z.b)(function(e){return function(){var t={},r={},n={};return function(a,i,o,s,c){j.a.info(T+o.controlId+": createGetTimelineWallData started");var u=!1;r.hasOwnProperty(a)&&r[a]||(r[a]=new P.a(e,a,o.id));var l=r[a],p=l.retrieveTimelineWallObject(i,o,s,c,e);n.hasOwnProperty(a)&&n[a]&&p===n[a]||(n[a]=p,u=!0);var d=l;return u&&(t[a]=d),j.a.info(T+o.controlId+": createGetTimelineWallData finished"),t[a]}}}(_),J.a.TimelineWall),L.info("BusinessProcessWrapperManager.Instance.init started.",g),G.push(k.a.Instance.init(f,S,_).then((function(){return L.info("BusinessProcessWrapperManager.Instance.init completed.",g)}))),Object(C.a)(O,e))if(Object(u.m)(O,t)){if(!Object(C.g)(O,A,1,0)&&!(null==I?void 0:I.isPreview))return ie(22e8,_,L,v,O,t)}else if(!Object(C.g)(O,A,2,0))return ie(2147746342,_,L,v,O,t);var U=Object(i.j)(O,e),$=ye(O,U,e),ee=fe(O,A,U),te=function(e,t,r,n){var a={};if(t&&t.RelatedEntityAttributes&&n)for(var i in t.RelatedEntityAttributes){var o=Object(b.x)(e,n,i);if(o&&o.ReferencedEntity){var s={},c=ve(e,o.ReferencedEntity,t.RelatedEntityAttributes[i]),u=Object(F.m)(r,i);a[Object(F.v)(u)]={attributes:c,submitModes:s}}}return a}(O,U,r,A),re=Object(q.a)(O),ne=Object(d.s)(O);for(var ae in Se(O,_,e,$,ee,t,r,te,ne),M&&!re&&_(Object(X.g)(t,M)),L.info("Update quick view forms started.",g),U.InlineQuickForms){var oe=U.InlineQuickForms[ae];for(var se in oe){var pe=oe[se],de=Object(i.j)(O,pe),he=ye(O,de,pe),be=fe(O,se,de),_e=Object(F.l)(r,ae,se);Se(O,_,e,he,be,t,_e,null,ne)}}if(L.info("Update quick view forms completed.",g),x&&0!==Object.keys(x).length){var Ce=I,Oe=Ce.createFromEntity,Ie=Ce.createFromRelationship,Pe=I.initWithEntity,je=Oe;!je&&Pe&&(je=Pe),y=function(e,t,r,n,i,c,d,g,m,f,v){r&&r.info("initializeFormWithDefaultValue started.",n);var y,_,S=Object(p.d)(e,c),C=null,O={},I=Object(u.m)(e,i),P=a.a.toString(g),j=[];P&&(C=Object(p.k)(e,P));for(var T=0,E=Object.keys(d);T<E.length;T++){var A=E[T];if("processid"!==A){var x=S[A];if(!x&&C&&(x=C[A]),x&&!x.AttributeOf){var w=x.Type;switch(w){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof d[A]){var k=ce(d,A,x);if(!k){le(r,A);continue}if(O[A]=k,!a.a.equals(a.a.EMPTY,k.id)&&"owner"!==w&&I&&(f||v))if(_){var M=_.then((function(){return t(Object(z.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (1).",n)}))}));j.push(M)}else _=me(e,t,k,c,i,r,n,f,v),j.push(_)}else{var D=void 0;(D=Array.isArray(d[A])?d[A][0]:d[A])&&D.id&&a.a.tryParseOrNull(D.id)&&D.entityType&&(O[A]=new l.a(D.entityType,new a.a(D.id),D.name))}break;case"partylist":var R=d[A],L=R,V=[];try{"string"==typeof R&&(L=JSON.parse(R));for(var G=0,X=L;G<X.length;G++){var q=X[G];V.push(new l.a(q.entityType,new a.a(q.id),q.name))}}catch(e){le(r,A,"partylist")}O[A]=V;break;case"boolean":case"picklist":case"status":O[A]=d[A];break;case"uniqueidentifier":O[A]=new a.a(d[A]);break;default:O[A]=d[A]}}else if(-1!==A.indexOf(K.d)||"_CreateFromId"===A){var U=null;if(-1!==A.indexOf(K.d)&&(U=ce(d,K.d,x)),!U&&"_CreateFromId"===A){var J=Object(b.m)(e,d._CreateFromType),Z=Object(b.h)(e,J);Z&&(U=ue(J,d._CreateFromId,Z.DisplayName))}if(!U){le(r,K.d);continue}if(!y&&(y=U,I))if(_){M=_.then((function(){return t(Object(z.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (2).",n)}))}));j.push(M)}else _=me(e,t,y,c,i,r,n,f,v),j.push(_);if(Object(b.h)(e,c).IsActivity&&-1===Object.keys(O).indexOf(N.t)&&Object(b.z)(e,c,y.etn,N.t)){var $=Object(s.ab)(e,i,m);$&&$[N.t]&&(O[N.t]=U)}}else{if(le(r,A),Object(Q.c)(e,Y.Rc))return Promise.reject(Object(B.b)(e,i,2200000009))}}}var ee=Object(Q.c)(e,Y.L),te=O;ee&&(te=function(e,t,r,n,a){var i={},o=Object(F.w)(n),c=Object(s.P)(e,o,t,r);for(var u in a)if(c&&c.hasOwnProperty(u)){var l=Object(p.a)(e,t,u);if(!(l&&l.ParentPicklistLogicalName)&&!Object(W.a)(e,n,r,t,c,u,{name:u,value:0})){i[u]=a[u];var d=[];for(l&&l.ChildPicklistLogicalNames&&(d=d.concat(l.ChildPicklistLogicalNames));d&&d.length>0;){var h=d.pop();if(a.hasOwnProperty(h)){var g=Object(p.a)(e,t,h),m=JSON.parse(a[g.ParentPicklistLogicalName]),f=JSON.parse(a[h]);Object(H.a)(e,r,n,g,t,m,f)&&(i[h]=a[h],g.ChildPicklistLogicalNames&&g.ChildPicklistLogicalNames.length>0&&(d=d.concat(g.ChildPicklistLogicalNames)))}}}}else i[u]=a[u];return i}(e,c,i,m,O));var re=ge(te);if(j.length>0)return Promise.all(j).catch((function(e){if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)})).then((function(){return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",n),Promise.resolve(null)}));return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",n),Promise.resolve(null)}(S(),_,L,g,t,A,x,e,r,je,Ie)}if(U&&U.Controls&&U.Controls.notescontrol){var Te=Object(u.g)(O,t);L.info("loadTimelineConfigAndMetaData started.",g),_(Object(E.b)(U.Controls.notescontrol,Te,n)).then((function(){L.info("loadTimelineConfigAndMetaData completed.",g)}))}if(U&&U.Controls)for(var Ee in U.Controls)if(U.Controls[Ee]){if(U.Controls[Ee].Id&&U.Controls[Ee].Id.startsWith("WebResource"))for(var Fe=0,Ae=U.Controls[Ee].Parameters;Fe<Ae.length;Fe++){var xe=Ae[Fe];if("Url"===xe.Name){var we=!1;if(c)for(var Ne=0,ke=c;Ne<ke.length;Ne++){var Me=ke[Ne],De=xe.Value&&xe.Value.toLowerCase()||"";if(De.length>=Me.length&&De.length-Me.length===De.lastIndexOf(Me)){we=!0;break}}if(!we){var Re=Object(w.j)(O,xe.Value);Re&&!Re.Name&&(L.info("retrieveWebResourceDescriptorByName started.",g),_(Object(V.c)(xe.Value)).then((function(){L.info("retrieveWebResourceDescriptorByName completed.",g)})))}}}a.a.equals(U.Controls[Ee].ClassId,D.rb)&&O&&void 0===O.currentServerTime.serverTimeDiffInSeconds&&(L.info("retrieveServerTime started.",g),_(Object(R.b)(new l.a(A))).then((function(){L.info("retrieveServerTime completed.",g)})))}return null!=y?y:(L.info("initializeForm completed.",g),Promise.all(G))},getFailureParameters:function(e,t){return g}}}function ae(e,t,r,a,i,o,s){var c=t(Object(m.f)(o,!1,[])).then((function(){var r=Object(b.h)(e(),o);if(r.IsChildEntity){var n=Object(C.d)(e(),r);return t(Object(m.f)(n.EntityLogicalName,!1,[]))}})),l=function(){var i=e();if(!Object(C.b)(i,o))return ie(2200000001,t,r,a,i,s);var c=Object(C.c)(i,o),l=Object(n.d)(i);return c&&Object(u.m)(i,s)&&!l?ie(2200000002,t,r,a,i,s):void 0};return c?c.then(l):Promise.resolve(l())}function ie(e,t,r,n,a,i){var o=Object(B.d)(e);return t(Object(A.e)(o)).then((function(){var t=Object(B.c)(e);if(r){var s=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.debug(t,s)}var c=Object(G.e)(a,o),u=Object(G.c)(c,o[0]),l=Object(G.c)(c,o[1]);throw Object(B.b)(a,i,e,t,u,l)}))}function oe(e,t,r,n,a,i,o,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);var m=Object(p.d)(e,r);if(m){for(var f=function(e){return e&&e.OptionSet&&Object.keys(e.OptionSet).length>0},v=Object(u.g)(e,n).id,b=new l.a(r,v),y={},_=Object(s.ac)(e,n,o),S=function(t){var r=m[t];if(r&&(a.indexOf(t)>=0&&i.indexOf(t)>=0||f(r))&&!Object(s.X)(e,n,o,_,b,r.LogicalName)){switch(t){case N.q:var c=Object(d.q)(e),u=Object(d.t)(e);if(c&&u){var p=new l.a(x.a,c,u);y[t]=p}break;case N.w:if(!Object(M.d)(e,_,null,N.w)){var h=Object(d.b)(e);if(h){var g=new l.a(x.b,h.transactionCurrencyId,h.currencyName);y[t]=g}}}if(f(r)){var v=Object(M.d)(e,_,new l.a(r.EntityLogicalName),t),S=v?parseInt(v.valueString,10):null!=r.DefaultValue?r.DefaultValue:t===N.u?0:void 0;if(void 0===S||S<0||(y[t]=S),t===N.u&&-1!==a.indexOf(N.v)){var C=m[t];if(C&&C.OptionSet&&Object.keys(C.OptionSet).length>0){var O=r.OptionSet.find((function(e){return e.Value===S})),I=O?O.DefaultStatus:m[N.v].DefaultValue||0;I<0||(y[N.v]=I)}}}}},C=0,O=a.concat(i);C<O.length;C++){S(O[C])}var I=ge(y);t(Object(h.a)(n,I,!0,!0)),c.info("autoPopulateFields completed.",g)}else c&&c.warn("attributes is null.",g)}function se(e,t,r,n,i,o,s){var c=Object(u.g)(e,n).id,p=new l.a(r,c),d={};if(a.a.isNullOrEmpty(p.id)&&!s)return function(e,t,r,n,i){var o=Object(y.d)(e,r);if(null!=o)return Promise.resolve(o);return t(Object(L.a)(a.a.EMPTY,new l.a(r,a.a.EMPTY))).then((function(e){return e&&e.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)})).catch((function(e){var t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:r},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return n.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),n.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)}))}(e,t,r,i,o).then((function(e){e&&(d.processid=e.guid);var r=ge(d);return t(Object(h.a)(n,r,!0,!0)),Promise.resolve()}));s&&(d.processid=s);var g=ge(d);return t(Object(h.a)(n,g,!0,!0)),Promise.resolve()}function ce(e,t,r){var n=t;!t.match(/id$/i)&&t.indexOf(K.d)>-1&&(n+="id");var i=e[n];if(null!=i){if(a.a.validate(i)){var o=i,s=e[t+"name"],c=e[t+"type"]||e[t+"target"];return!c&&r.Targets&&r.Targets.length>0&&(c=r.Targets[0]),ue(c,o,s)}try{var u=JSON.parse(i);if(u)return ue(u.entityType,u.id,u.name)}catch(e){}}return null}function ue(e,t,r){if(e&&t&&a.a.validate(t)){var n=new a.a(t);if(!a.a.isNullOrEmpty(n))return new l.a(e,n,r)}return null}function le(e,t,r){if(e){var n=[{name:"key",value:t},{name:"source",value:r}];e.warn("Value passed is not in correct syntax.",n)}}function pe(e,t,r,n,a,i,o,s){return de(e,t,r,n,i,o,s).then((function(){return he(e,t,r,a,i,o,s)}))}function de(e,t,r,n,a,i,o){return!Object(s.Eb)(e,a)&&Object($.n)(e,a)?(i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(B.b)(e,a,2200000008,"Page has expired."))):(i&&i.info("loadScripts started.",o),r(t.ScriptManager.getContainer(a).getEventManager().loadScripts(n,a)).then((function(){i&&i.info("loadScripts completed",o)})))}function he(e,t,r,n,a,i,o){if(Object(s.Eb)(e,a)||!Object($.n)(e,a)){i&&i.info("runFormOnLoadScripts started.",o);var c=t.ScriptManager.getContainer(a).getEventManager();r(c.addPblEvent(n)),r(c.runOnLoad(n,1)),r(c.runOnDataLoad(n,1)),i&&i.info("runFormOnLoadScripts completed.",o)}else i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",o)}function ge(e){var t={};for(var r in e){var n={fieldName:r,value:e[r]};t[r]=n}return t}function me(e,t,r,n,a,i,s,c,u){var p=Object(F.j)(e,a),d=Object(F.x)(p);return i&&i.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,r,n,a){return{type:"snapshot.from.async",execute:function(i,s){var c=i.dispatch,u=i.getState,p=s.DataSource,d=l.a.toLegacyEntityReference(e),h=new _.a(d,t,S.a.All),C=p.execute(h,null).nativePromise(),O=null,I=null,P=null;return C.then((function(e){var r=e.get_entity();return O=Object(g.a)(r),I=O.fields,P=O.identifier,c(Object(m.f)(t,!1,Object.keys(O.fields)))}),(function(e){var r=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||r&&-2147217919===r.getNegativeErrorCode())&&n){var i=[];if(I={},n.etn){var s=Object(b.c)(u(),n.etn,t);if(s)for(var p=0,d=s;p<d.length;p++){var h=d[p];h.ReferencingAttribute&&i.push(h.ReferencingAttribute)}}else a&&i.push(a.attributeName);for(var g=0,f=i;g<f.length;g++){var v=f[g];if(!n.name&&n.id){var _=Object(y.h)(u(),n.etn,n.id.guid);if(_&&_.fields){var S=Object(b.E)(u(),n.etn),C=_.fields[S];C&&C.value||(C=_.fields.name),C&&C.value&&(n={etn:n.etn,id:n.id,name:C.value})}}I[v]={reference:n,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return P=new l.a(t),c(Object(m.f)(t,!1,i))}Object(o.b)(e)})).then((function(){var e=Object(f.b)(u(),P,I,r,v.a.Create),t=e.payload.snapshotId;return c(e),t}))}}}(r,n,d,c,u)).then((function(e){i&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(O.b)(a,e,p)).then((function(){i&&i.info("createAndSetDataSnapshotFrom completed.",s)}))}))}function fe(e,t,r){var n={};if(r&&r.Attributes&&t){var a=Object(w.d)(e,r.FormLibraries,[t]);if(r.Attributes||a){var i=[].concat(r.Attributes,a);-1===i.indexOf(N.u)&&i.push(N.u),n=ve(e,t,i)}}return{attributes:n,submitModes:{}}}function ve(e,t,r){var n={};if(r&&t)for(var a=0;a<r.length;a++){var i=r[a];if(i){var o=Object(s.L)(e,t,i);o&&(n[i]=o)}}return n}function be(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function ye(e,t,r){var n={},a={},i={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},u={visible:!0},l={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames)for(var p=!1,d=0,h=Object(s.m)(e,t);d<h.length;d++){var g=h[d],m={collapsed:!!p||!(g.Expanded&&g.Visible),visible:g.Visible,label:g.Label,sectionNames:[],domId:g.DomId,showLabel:g.ShowLabel,contentType:null};switch(g.ContentType){case"expandAvailableSpace":case"singleComponent":m.contentType="singleComponent";break;default:m.contentType="cardSections"}p=p||g.Expanded&&g.Visible;var f=[];if(g.Columns)for(var v=0;v<g.Columns.length;v++){var b=g.Columns[v];if(b.SectionNames)for(var y=0;y<b.SectionNames.length;y++){var _=b.SectionNames[y];if(t.Sections[_]){var S=t.Sections[_];f.push(_);for(var C=[],O=0,P=t.Sections[_].Rows;O<P.length;O++)for(var j=0,T=P[O].Cells;j<T.length;j++){var E=T[j];E.ControlName&&C.push(E.ControlName)}var F={parentTabId:g.Id,visible:S.Visible,label:S.Label,controlNames:C,domId:S.DomId,semanticZoomDomId:S.SemanticZoomDomId};a[_]=F;for(var A=0;A<C.length;A++){var x=C[A];if(t.Controls[x]){var w=t.Controls[x],N=_e(w,_,!0),k=Object(c.a)(w,t,Object(U.b)(e));null!=k&&(N.visible=N.visible||k.ShouldOverrideControlVisible),Ce(N),i[x]=N}}}}}if(g.Header)for(var M=0,D=g.Header;M<D.length;M++){i[(X=D[M]).Name]=_e(X,null,!0)}if(g.Footer)for(var R=0,L=g.Footer;R<L.length;R++){i[(H=L[R]).Name]=_e(H,null,!0)}m.sectionNames=f,n[g.Id]=m}if(t&&t.Navigation&&(l=t.Navigation),t&&t.Header){var V=be(t.Header);if(V)for(var B=0,G=V;B<G.length;B++){var X;i[(X=G[B]).Name]=_e(X,null,!0),Ce(i[X.Name])}o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){var q=be(t.Footer);if(q)for(var z=0,W=q;z<W.length;z++){var H;i[(H=W[z]).Name]=_e(H,null,!0),Ce(i[H.Name])}u.visible=!1!==t.Footer.Visible}return{formId:r,tabs:n,sections:a,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:l,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:u}}function _e(e,t,r){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:r,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Se(e,t,r,n,i,o,c,u,l){void 0===u&&(u=null);var p=Object(s.cb)(e,o,c),d=Object(ee.a)(e,o);a.a.equals(null==p?void 0:p.formId,null==n?void 0:n.formId)&&a.a.equals(r,null==d?void 0:d.formId)||t(function(e,t,r,n,a,i,o){void 0===i&&(i=null);return{type:te,payload:{formId:e,formUIState:t,formMetadataState:r,relatedEntityMetadataState:i,currentLanguageId:o},meta:{pageId:n,contextToken:a}}}(r,n,i,o,c,u,l))}function Ce(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},"8ADW":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Chart.Component",a="ViewId",i="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",u="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",l="RETRIEVECHARTTS_RETRIEVECHARTDATA",p="RETRIEVECHARTTS_RETRIEVECHARTODATA"},"8Fmj":function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("9r0m"),a=r("G7N+"),i=r("KDdL"),o=r("7dGM"),s=r("8ADW"),c=r("z9yS"),u=r("Xlzu"),l=r("t8f4"),p=r("QAhb"),d=r("xhI+"),h=r("/j9Z"),g=r("Fpc+"),m=r("Kn4q"),f=r("zEjV"),v=r("S2mk"),b=r("cZkS"),y=r("qC0c");function _(e,t,r){void 0===t&&(t=c.a.savedvisualization);var d=[];return d.push({name:s.f,value:e}),d.push({name:s.i,value:t}),d.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(g,v){var _=g.dispatch,S=g.getState;try{var O=m.a.LocalAndRemote,j=v.TraceManager.getTracer(s.d),F=v.DataSource,A=S(),x=r;if(j.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){return v.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error("entityTypeName is null"),s.d,d),Promise.reject("entityTypeName is null")}n.a.isNullOrEmpty(x)&&(x=Object(o.j)(A,e));var w=Object(y.c)(S(),b.A);if(!n.a.isNullOrEmpty(x)){var N=Object(o.f)(A,x),k=Object(o.g)(A,x);if(N===a.a.Initialized){if(function(){var r=Object(o.a)(A,x),n=function(e,t,r,n){var a=c.a[r],i=Object(o.i)(e,t);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][n.guid]}(A,e,t,x),a=n&&!n.IsUserChart;switch(Object(u.d)(A,a,r,(function(){return n}))){case 1:O=m.a.Remote;break;case 2:_(function(e,t,r){var n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute:function(e,a){var o=e.dispatch;e.getState;try{return o(Object(u.b)(c.a[r],null,t,null,!0,f.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(e){throw a.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),s.e,n),e}}}}(0,e,t))}}(),O!==m.a.LocalAndRemote)return I(_,F,e,x,t,O,v,d);if(w&&k===a.a.Uninitialized){var M=new p.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",x),D=Object(o.a)(A,x);return _(C(x,a.a.Initialized)),_(Object(l.d)(M)).catch(h.b).then((function(e){return P(D,e),_(T(e)),v.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(x)}),(function(e){return E(_,e,x.guid,D,v,d),Promise.resolve(x)}))}return Promise.resolve(x)}return I(_,F,e,x,t,O,v,d)}return I(_,F,e,x,t,O,v,d)}catch(e){throw v.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,d),e}}}}function S(e){return{type:"chart.dependencies.update.async",execute:function(t,r){var a=t.dispatch,i=t.getState,s=[];for(var c in e)s.push(e[c]+":name");return s.length>0?a(Object(d.a)(s)).then((function(){var t=new Map,r=i();for(var s in e){var c=e[s],u=Object(o.a)(r,new n.a(c));u&&c&&r.metadata.labels&&r.metadata.labels[c]&&r.metadata.labels[c].name&&(u.Name=r.metadata.labels[c].name,t.set(c,u))}t.size>0&&a(function(e){var t={};return e.forEach((function(e,r){t[r]=e})),{type:"chart.descriptor.update",payload:{charts:t}}}(t))}),h.b):Promise.resolve()}}}function C(e,t){var r,i=n.a.isNullOrEmpty(e)?null:{charts:(r={},r[n.a.toString(e)]={initialized:t,oDataInitialized:a.a.Initializing},r)};return{type:g.f,payload:i}}function O(e,t,r,o,d){void 0===o&&(o=c.a.savedvisualization);var g=[];return g.push({name:s.f,value:t}),g.push({name:s.i,value:o}),g.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(e,s){var m=e.dispatch,v=e.getState;return Object(y.c)(v(),b.A)?r?function(e,t,r,o,s,d,g){var m=new p.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(C(r,a.a.Initializing)),Promise.all([e(Object(u.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b),e(Object(l.d)(m)).catch(h.c)]).then((function(t){return t[1].constructor===h.a?E(e,t[1],r.guid,t[0].charts[r.guid],d,g):(P(t[0].charts[r.guid],t[1]),e(T(t[1])),d.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]}))}(m,t,r,o,d,s,g):function(e,t,r,o,s,d,g){return e(Object(u.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b).then((function(t){var r=new n.a(Object.keys(t.charts)[0]),s=new p.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(C(r,a.a.Initializing)),e(Object(l.d)(s)).catch(h.b).then((function(n){return P(t.charts[r.guid],n),e(T(n)),d.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t}),(function(n){return E(e,n,r.guid,t.charts[r.guid],d,g),t}))}))}(m,t,r,o,d,s,g):function(e,t,r,a,i){return e(Object(u.b)(c.a[a],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,i)).catch(h.b)}(m,t,r,o,d)}}}function I(e,t,r,o,c,u,l,p){var d,m,f;return e((d=o,f=n.a.isNullOrEmpty(d)?null:{charts:(m={},m[n.a.toString(d)]={initialized:a.a.Initializing},m)},{type:g.b,payload:f})),e(O(0,r,o,c,u)).then((function(t){t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:a.a.Initialized,chartTypes:{}});var s=[];for(var c in t.charts)s.push(c);return e(S(s)).then((function(){return e(j(t)),n.a.isNullOrEmpty(o)&&(o=t.chartDefaults[r]),l.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),o}),h.b)}),(function(t){var c,u,d=t&&!Object(v.j)(t.errorCode)&&t.errorCode,g={chartSelectors:(c={},c[r]={initialized:a.a.Initialized,chartTypes:{}},c)};if(e(j(g)),Object(v.j)(d))return l.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),s.d,p),Object(h.b)(t);var m={charts:(u={},u[n.a.toString(o)]={initialized:a.a.Error,errorCode:d},u)};e(j(m))}))}function P(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=a.a.Initialized}function j(e){return{type:g.b,payload:e}}function T(e){return{type:g.f,payload:e}}function E(e,t,r,n,o,c){var u;e(T({charts:(u={},u[r]={initialized:n.initialized,oDataInitialized:a.a.Error},u)})),o.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),s.c,c)}},"8VL5":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("uO/V"),a=r("/j9Z"),i="customcontrol.refreshCustomDataProvider";function o(e,t,r,o){return{type:"customcontrol.refreshCustomDataProvider.async",execute:function(s,c){var u=s.dispatch,l=(s.getState,n.x+".refreshCustomDataProviderAction");return o().then((function(n){return u(function(e,t,r,n){var a=new Array;n&&n.length>0&&(a=n.slice());return{type:i,payload:a,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),c.EventManager.ReportComponentSuccess(l),n})).catch((function(e){return c.EventManager.ReportComponentFailure(l,Error(e)),Promise.reject(new a.a(e))}))}}}},"90Ov":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(n.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},"9LTA":function(e,t,r){"use strict";r.d(t,"b",(function(){return Ce})),r.d(t,"d",(function(){return Oe})),r.d(t,"e",(function(){return Ie})),r.d(t,"c",(function(){return Pe})),r.d(t,"a",(function(){return je}));var n=r("0RbL"),a=r("9r0m"),i=r("G7N+"),o=r("KDdL"),s=r("c/eZ");var c=r("70DF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var u=r("QAhb"),l=r("VcAV"),p=r("+h4s"),d=function(){function e(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}return e.prototype.addAggregator=function(e,t,r,n,i){if(r>=c.a.DAY&&r<c.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,i);else if(r===c.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,i);else if(r===c.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,i);else{var o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(o.FieldName=e,o.EntityName=n,o.LinkEntityExpressionArray=i,Object(l.c)(t))o.Value=null;else if(t instanceof u.a){var s=t;o.Value=s.id.guid,o.DisplayName=s.name,o.EntityLogicalName=s.etn}else t instanceof a.a?o.Value=a.a.toString(t):o.Value=t.toString();this._dataPointAggregators.push(o)}},e._daysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype._addDataPointFiscalPeriodAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");var i=t.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}else this._dataPointFiscalPeriodAggregators.push(a)},e.prototype._addDataPointFiscalYearAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");a.Year=Number(t),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)},e.prototype._addDateTimeRangeAggregatorInfo=function(e,t,r,n,a){var i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||c.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=n),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),r){case c.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case c.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case c.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case c.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case c.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(r,i.dateTimeAggregatorPrecision)},e.prototype._getDataPointDateTimeRangeAggregators=function(t,r){var n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((function(a,i){var o,s={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};if(s.FieldName=a.dateTimeAggregatorFieldName,s.EntityName=a.dateTimeAggregatorEntityName,s.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:e._daysInMonth(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),s.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case c.a.DAY:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth(),s.MaxDate.getDate());break;case c.a.WEEK:r===p.a.FirstFullWeekOfTheYear&&(r=p.a.FirstDayOfTheYear);var u=Object(p.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,t,r),l=Object(p.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,t,r);if(l.setDate(l.getDate()-1),r===p.a.FirstDayOfTheYear)if(l>=new Date(a.dateTimeAggregatorYear+1,0,1))l=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){var d=new Date(a.dateTimeAggregatorYear,0,1);u<d&&(u=d)}s.MinDate=u,s.MaxDate=l,h(s.MaxDate),h(s.MinDate);break;case c.a.MONTH:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-1,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth())+1),h(s.MaxDate),h(s.MinDate);break;case c.a.QUARTER:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-3,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth()-2)+1),h(s.MaxDate),h(s.MinDate);break;case c.a.YEAR:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear()-1,s.MaxDate.getMonth(),s.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(s)}else n.push(s)})),n},e.prototype.getAggregators=function(e,t){var r=this._dataPointAggregators,n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r},e}();function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var g=r("Ww2r"),m=r("dUXI"),f=r("7EJx"),v=r("otJc"),b=r("yGoS"),y=r("EGsq"),_=r("F2uj"),S=r("uXKh"),C=r("sRkF");function O(e,t){var r=Object(_.a)(e,t.entity.entityName,t.attributeName),n=r?r.DisplayName:null;n||(n=t.attributeName);var a=n;if(t.dateTimeGrouping){var i=b.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(g.b)(e,m.c),Object(g.b)(e,m.c+"."+i.toUpperCase()),n)}else t.hasAggregate&&t.aggregateType&&(a=String.format(Object(g.b)(e,m.d),Object(g.b)(e,m.d+"."+t.aggregateType.toUpperCase()),n));if(r&&"money"===r.Type){var o="",s=null,c=Object(y.x)(e);r.IsBaseCurrency?c&&c.baseCurrencyId&&c.transactionCurrencyById&&(s=c.transactionCurrencyById[c.baseCurrencyId.guid]):t.hasAggregate&&(s=Object(f.b)(e)),s&&(o=c&&c.currencyDisplayOption===S.a.CurrencyCode?s.currencyCode:s.currencySymbol),o&&(a=String.format(Object(g.b)(e,m.b),a,o))}return a}function I(e,t,r){return r>0?String.format(Object(g.b)(e,m.y),r,t):String.format(Object(g.b)(e,m.w),t)}function P(e,t,r,n,a){var i=a<1&&n>=1&&r<1,o=a<1&&n<1&&r>=1,s=n<1&&r<1;if(a>=1&&n<1&&r>=1){var c=new Date(t,r-1,a),u=Object(f.w)(e),l=u.formatInfoCultureName,p=u.numberFormatInfo,d=u.dateFormatInfo,h=new Sys.CultureInfo(l,p,d);return Object(v.s)(c,h,C.a.None)}return i?String.format(Object(g.b)(e,m.z),n,t):o?String.format("{0} {1}",function(e){var t=Object(g.b)(e,m.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):s?String(t):""}function j(e){return Object(g.b)(e,m.v)}var T=r("9rlF"),E=r("+Z9T");function F(e,t,r){var n=!1;return r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0),{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function A(e,t){var r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(T.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return P(e.state,a,n,-1,r)}(e,t);case c.a.WEEK:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return P(e.state,n,-1,r,-1)}(e,t);case c.a.MONTH:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return P(e.state,n,r,-1,-1)}(e,t);case c.a.QUARTER:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case c.a.FISCAL_PERIOD:return function(e,t){return Object(T.e)(t.fields[e.aliasName])}(e,t);case c.a.YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return P(e.state,r,-1,-1,-1)}(e,t);case c.a.FISCAL_YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return I(e.state,r,-1)}(e,t);default:return Object(T.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=(r=Object(T.c)(t.fields[e.aliasName]))||""),0===r.length?Object(g.b)(e.state,m.v):r}function x(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return A(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":var r=Object(T.e)(t.fields[e.aliasName]);return r=Object(E.a)(r)?-1:Number(r);case"datetime":return function(e,t){var r=-1,n=-1,a=-1;switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case c.a.MONTH:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.YEAR:a=Object(T.e)(t.fields[e.aliasName]);break;case c.a.QUARTER:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.WEEK:r=1+7*(Object(T.e)(t.fields[e.aliasName])-1),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return A(e,t)}return new Date(a,n-1,r).getTime()}(e,t);default:return A(e,t)}}function w(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k=function(e){function t(r,n,a){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.title=n,i.description=a,i}return Object(s.__extends)(t,e),t}(Error),M=r("qC0c"),D=r("cZkS"),R=r("glw0"),L=r("scgP"),V=r("WS0f");function B(){return this.point.formattedValue}function G(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}var X=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"primaryGroupBy",{get:function(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryModel",{get:function(){return this._queryModel},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,r,n,a,i,o,s,c,u){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=u,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0},e.prototype.setXAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,u;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(u=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===u?void 0:u.AxisMajorTickMarkEnabled,e},e.prototype.setYAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,u;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(u=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===u?void 0:u.AxisMajorTickMarkEnabled,e},e.prototype.retrieveChartArea3DStyle=function(){var e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e},e.prototype.retrieveChartAreaGradientStyle=function(){var e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e},e.prototype.setYAxisOppositeProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.setXAxisIsReversedProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.retrieveChartYAxis=function(){var e=this,t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;for(var r=function(t,r,n){e.chartPresentationYAxis&&e.chartPresentationYAxis.length>r&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Title?t.Title=e.chartPresentationYAxis[r].Title:1===n&&(t.Title=e._queryModel.SeriesList[r].Title)},n=0,a=-1,i=-1,o=!1,s=!1,c=0;c<this.chartPresentationSeries.length;c++)this.chartPresentationSeries[c].SecondaryYAxis?(n++,i=-1===i?c:i,s=s||this.shouldDisableAllowDecimals(c)):(a=-1===a?c:a,o=o||this.shouldDisableAllowDecimals(c));return r(t[0],a,this.chartPresentationSeries.length-n),t[0].Opposite=!1,o&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},r(t[1],i,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((function(t,r){var n,a,i,o,s,c,u,l,p,d,h,g,m,f;t.Disabled=e.chartPresentationYAxis&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Disabled,t.LabelForeColor=null===(a=null===(n=e.chartPresentationYAxis)||void 0===n?void 0:n[r])||void 0===a?void 0:a.LabelForeColor,t.AxisLineColor=null===(o=null===(i=e.chartPresentationYAxis)||void 0===i?void 0:i[r])||void 0===o?void 0:o.AxisLineColor,t.AxisTitleForeColor=null===(c=null===(s=e.chartPresentationYAxis)||void 0===s?void 0:s[r])||void 0===c?void 0:c.AxisTitleForeColor,t.LabelDisabled=null===(l=null===(u=e.chartPresentationYAxis)||void 0===u?void 0:u[r])||void 0===l?void 0:l.LabelDisabled,t.AxisInterval=null===(d=null===(p=e.chartPresentationYAxis)||void 0===p?void 0:p[r])||void 0===d?void 0:d.AxisInterval,t.AxisMinimum=null===(g=null===(h=e.chartPresentationYAxis)||void 0===h?void 0:h[r])||void 0===g?void 0:g.AxisMinimum,t.AxisMaximum=null===(f=null===(m=e.chartPresentationYAxis)||void 0===m?void 0:m[r])||void 0===f?void 0:f.AxisMaximum,t=e.setYAxisMajorGridAndMajorTickProperties(t,r)})),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),t},e.prototype._isChartCustomizationParityFCBEnabled=function(){return Object(M.a)(this.getState(),D.s,D.Lc,D.w)},e.prototype.retrieveChartAnnotations=function(){for(var e=new Array(this.chartPresentationAnnotationList.length),t=0;t<this.chartPresentationAnnotationList.length;t++){var r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e},e.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o=new Array(1),s=null;this.categoryColumn.length>0&&(s=F(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};for(var c=new Array(this.chartData.length),u=0;u<this.chartData.length;u++){var l=this.chartData[u];if(s){if(c[u]=A(s,l),"-1"===c[u])c[u]=Object(g.b)(this.getState(),m.f);else if(!s.isDateTimeChart&&"number"==typeof Object(T.e)(l.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){var p=Object(f.w)(this.getState());c[u]=Object(L.c)(Object(T.e)(l.fields[s.aliasName]),Object(v.d)(p),this.chartPresentationXAxis[0].FormatString)}}else c[u]=j(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,o[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o},e.prototype.retrieveChartCategoryTitle=function(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?O((t=e).state,t.attribute):"";var t},e.prototype.retrieveChartSeries=function(e){for(var t=new Array(this.chartPresentationSeries.length),r=function(r){var a=n.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,i=a.aliasName?a.aliasName:a.attributeName,o=n.chartPresentationSeries[r].IsValueShownAsLabel,s=n.chartPresentationSeries[r].LabelFormat,c=null;s&&Object(L.d)(s)&&(c=Object(L.g)(s));var u=!1;n.chartPresentationSeries[r].Label&&"#percent"===n.chartPresentationSeries[r].Label.toLowerCase()&&(u=!0);var l=!1;s&&q(n.chartPresentationSeries[r].ChartType)&&Object(L.e)(s)&&(l=!0);var p=null,d=O(n.getState(),a);t[r]=n.cloneBlueprintSeriesStyle(n.chartPresentationSeries[r]),n.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),n.primaryGroupBy&&((p=[]).push(n.primaryGroupBy.groupAttribute),n.primaryGroupBy.extendedGroupBys&&n.primaryGroupBy.extendedGroupBys.forEach((function(e){p.push(e)})));for(var h=new Array(n.chartData.length),g=i,m=0,b=0;b<n.chartData.length;b++){var y=n.chartData[b];h[b]=N();var _=Object(T.e)(y.fields[i]);if(h[b].Value=_||0,m+=_||0,s){var S=Object(f.w)(n.getState()),C=Object(v.d)(S);Object(L.f)(s)?h[b].FormattedValue=Object(R.b)(h[b].Value,n.chartPresentationSeries[r].LabelFormat,C):Object(L.d)(s)&&!l?h[b].FormattedValue=Object(L.a)(h[b].Value,c,C):h[b].FormattedValue=Object(T.c)(y.fields[g])||0}else h[b].FormattedValue=Object(T.c)(y.fields[g])||0;n.attachAggregators(h[b],y,p)}var I=w();o?(I.Enabled=!0,I.LabelFormatter=B):u&&(I.Enabled=!0,I.LabelFormatter=G(m)),I.Color=n.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=I,t[r].DataPoints=h,t[r].Title=n.getChartTitleFromPresentationSeries(d,r),t[r].XAxisNumber=e,t[r].HideInLegend=n.chartPresentationSeries[r].HideInLegend,t[r].Stack=n.chartPresentationSeries[r].Stack},n=this,a=0;a<this.chartPresentationSeries.length;a++)r(a);var i=Object(f.w)(this.getState()),o=Object(v.d)(i),s=this.chartPresentationSeries[0].IsValueShownAsLabel,c=this.chartPresentationSeries[0].LabelFormat;if(s&&q(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(c))for(var u=U(c,o),l=0;l<t[0].DataPoints.length;l++)u(0,l,0,t);return t},e.prototype.getChartTitleFromPresentationSeries=function(e,t){return void 0===t&&(t=0),Object(V.b)(this.chartPresentationSeries[t].LegendText)?Object(V.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText},e.prototype.shouldDisableAllowDecimals=function(e){var t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType},e.prototype.cloneBlueprintSeriesStyle=function(e){var t,r={DataPoints:t&&t.DataPoints||null,DataLabels:t&&t.DataLabels||null,ChartType:t&&t.ChartType||"line",YAxisNumber:t&&t.YAxisNumber||0,XAxisNumber:t&&t.XAxisNumber||0,Title:t&&t.Title||"",Color:t&&t.Color||"",BorderColor:t&&t.BorderColor||"",BorderWidth:t&&t.BorderWidth||0,CustomProperties:t&&t.CustomProperties||null,Stack:t&&t.Stack||null};return r.ChartType=e.ChartType,r.Color=e.Color,r.BorderColor=e.BorderColor,r.BorderWidth=e.BorderWidth,r.CustomProperties=e.CustomProperties,r},e.prototype.attachAggregators=function(t,r,n){if(n){for(var a=new d,i=function(t){var i=n[t],o=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach((function(e){var t,r={name:t&&t.name||null,from:t&&t.from||null,to:t&&t.to||null,linkType:t&&t.linkType||null,alias:t&&t.alias||null};r.name=e.entityName,r.from=e.linkFromAttribute,r.to=e.linkToAttribute,r.linkType=e.joinType.toString(),r.alias=e.alias,o.push(r)})),a.addAggregator(i.attributeName,Object(T.e)(r.fields[e._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,o)},o=0;o<n.length;o++)i(o);var s=Object(f.w)(this.getState()),c=this._getFirstDayOfWeekFromUserSettings(s),u=this._getCalendarWeekRuleFromUserSettings(s);t.Aggregators=a.getAggregators(c,u)}},e.prototype._getFirstDayOfWeekFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0},e.prototype._getCalendarWeekRuleFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0},e.prototype.getFormatterPropertiesForAttribute=function(e){return Object(v.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))},e._getFieldName=function(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName},e.prototype.isChartDrillable=function(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(var e=0,t=this.chartDataDescription.category.measureCollections;e<t.length;e++)for(var r=0,n=t[e].secondaryGroupBys;r<n.length;r++){var a=n[r];if(!this._isGroupByDrillable(a))return!1}return!!this.chartDataDescription.entityExpression.hasAggregate},e.prototype._isGroupByDrillable=function(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))},e.prototype._isAttributeDrillable=function(e){var t,r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(n,r,this.getState())},e.prototype._validateChartAggregateAttributes=function(){for(var e,t,r,n,a=0;a<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);a++){var i=this.chartDataDescription.entityExpression.aggregateAttributes[a],o=null===(n=null==i?void 0:i.entity)||void 0===n?void 0:n.entityName,s=null==i?void 0:i.attributeName,c=Object(_.b)(s,o,this.getState());if(!("date"!==c&&"datetime"!==c||"min"!==i.aggregateType&&"max"!==i.aggregateType)){var u=String.format(Object(g.b)(this.getState(),m.h),s);throw new k("ChartError",u,u)}}},e}();function q(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function U(e,t){return function r(n,a,i,o){if(n===o.length)return i;var s=o[n].DataPoints[a];return i=r(++n,a,i+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(L.a)(s.Value/i*100,Object(L.g)(e),t)),i}}var z=r("lMVv"),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");var a=new Array(0),i=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(var c=0;c<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;c++)a.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[c]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");for(var u=this._addSecondaryGroupByToFieldAggregators(s,a),l=s.measures[0].measureAttribute,p=l.aliasName?l.aliasName:l.attributeName,d=p,h=o.primaryGroupBy.groupAttribute,g=F(this.getState(),this._getGroupByAttribute(h,o.primaryGroupBy),o.primaryGroupBy),m=new Array,b=new Array,y=new Map,_=0;_<this.chartData.length;_++){var S=A(g,D=this.chartData[_]),C=A(u,D),O=void 0;O=null==C?C=j(this.getState()):x(u,D),i.set(O,C),b.indexOf(S)<0&&b.push(S),m.indexOf(O)<0&&m.push(O)}m.forEach((function(e){var t=new Array(b.length);y.set(e,t)}));var I=Object(f.w)(this.getState()),P=this.chartPresentationSeries[0].LabelFormat,k=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(k=!0);var M=!1;P&&q(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(P)&&(M=!0);for(_=0;_<this.chartData.length;_++){var D,V=x(u,D=this.chartData[_]);Object(E.a)(V)&&(V=j(this.getState()));var X=y.get(V),z=(S=A(g,D),b.indexOf(S));if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(b[z]=Object(L.c)(Object(T.e)(D.fields[g.aliasName]),Object(v.d)(I),this.chartPresentationXAxis[0].FormatString)),X[z]=N(),X[z].Value=Object(T.e)(D.fields[p]),P){var W=Object(v.d)(I);Object(L.f)(P)?X[z].FormattedValue=Object(R.b)(X[_].Value,P,W):Object(L.d)(P)&&!M?X[z].FormattedValue=Object(L.a)(X[z].Value,Object(L.g)(P),W):X[z].FormattedValue=Object(T.c)(D.fields[d])||0}else X[z].FormattedValue=Object(T.c)(D.fields[d])||0;this.attachAggregators(X[z],D,a)}m.forEach((function(e){for(var t=y.get(e),r=0;r<b.length;r++)t[r]||(t[r]=N())}));var H=new Array(1);H[0]={},H[0].Title=this.retrieveChartCategoryTitle(g),H[0].Values=b,H[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,H[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,H[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,H[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,H[0]=this.setXAxisMajorGridAndMajorTickProperties(H[0]),H[0]=this.setXAxisIsReversedProperty(H[0]),this._sortComparisonCodes(s,m);for(var Y=new Array(m.length),Q=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,K=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,J=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,Z=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name),$=function(e){var t=m[e];if(Y[e]=ee.cloneBlueprintSeriesStyle(ee.chartPresentationSeries[0]),Y[e].Title=Z||i.get(t),Y[e].DataPoints=y.get(t),Y[e].HideInLegend=J,Q)(r=w()).Enabled=!0,r.LabelFormatter=B,Y[e].DataLabels=r,r.Color=K;else if(k){var r,n=0;Y[e].DataPoints.forEach((function(e){n+=e&&e.Value?e.Value:0})),(r=w()).Enabled=!0,r.LabelFormatter=G(n),Y[e].DataLabels=r,r.Color=K}},ee=this,te=0;te<m.length;te++)$(te);if(Q&&M)for(var re=U(P,W=Object(v.d)(I)),ne=0;ne<H[0].Values.length;ne++)re(0,ne,0,Y);this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=H,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=Y,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()},t.prototype._sortComparisonCodes=function(e,t){e.secondaryGroupBys[0].descending?t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)})):t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t)}))},t.prototype._getGroupByAttribute=function(e,t){return e.attributeName!==Object(z.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e},t.prototype._addSecondaryGroupByToFieldAggregators=function(e,t){var r=e.secondaryGroupBys[0].groupAttribute,n=F(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(var a=0;a<e.secondaryGroupBys[0].extendedGroupBys.length;a++)t.push(e.secondaryGroupBys[0].extendedGroupBys[a]);return n},t.prototype._retrieveChartYAxis=function(e){var t,r,n,a,i,o,s,c,u=new Array(1);return u[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?u[0].Title=this.chartPresentationYAxis[0].Title:u[0].Title=O(this.getState(),e),this.chartPresentationYAxis[0].FormatString?u[0].FormatString=this.chartPresentationYAxis[0].FormatString:u[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(u[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(u[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(u[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(u[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),u[0].AxisInterval=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisInterval,u[0].AxisMinimum=null===(o=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===o?void 0:o.AxisMinimum,u[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(u[0].AllowDecimals=!1),u[0]=this.setYAxisMajorGridAndMajorTickProperties(u[0]),u[0]=this.setYAxisOppositeProperty(u[0]),u},t}(X),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o,s,c=new Array(1);if(this.chartData.length<1)return c;var u=this.primaryGroupBy.groupAttribute;c[0]={};var l=new Array(this.chartData.length),p=F(this.getState(),u,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(p),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(var d=0;d<this.chartData.length;d++){var h=this.chartData[d];l[d]=A(p,h),p.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&l[d]!==Object(g.b)(p.state,m.v)&&(l[d]=Object(L.b)(new Date(l[d]),Object(v.d)(Object(f.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=l,c},t}(X),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t}(X);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Q=r("Je7O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(e){var t={};try{if(e){var r=/\w+=\w+/;e.split(/\s*,\s*/).forEach((function(e){if(e&&r.test(e)){var n=e.split("="),a=n[0],i=n[1];t[a]=i}}))}}catch(t){throw"Failed to parse chart custom properties, value: "+e+" "}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var J=r("S2mk"),Z=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $(e,t,r){var n=(new DOMParser).parseFromString(t,"text/xml");return function(e,t){var r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new k("ChartError",Object(g.b)(t,m.t),Object(g.b)(t,m.s))}(n,e),{chartPresentationSeries:ee(e,n,r),chartPresentationLegendList:ne(n),colorsList:re(n),chartPresentationArea3DStyle:ce(n),chartPresentationAreaGradientStyle:ue(n),chartPresentationXAxis:ie(n),chartPresentationYAxis:oe(n),chartPresentationAnnotationList:ae(n)}}function ee(e,t,r){for(var n=new Array,a=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer,o=0;o<a.length;o++){var s=a[o],c={},u=s.getAttribute("ChartType")||"Column";if(-1===Z.indexOf(u.toUpperCase()))throw new k("ChartError",Object(g.b)(e,m.t),Object(g.b)(e,m.t));c.ChartType=u;var l=s.getAttribute("Color");c.Color=l?le(l):null;var p=s.getAttribute("LegendText");c.LegendText=p||null;var d=s.getAttribute("CustomProperties");c.CustomProperties=K(d);var h=s.getAttribute("BorderColor");c.BorderColor=h?le(h):null;var f=s.getAttribute("BorderWidth");c.BorderWidth=f?Number(f):null;var v=s.getAttribute("IsValueShownAsLabel");c.IsValueShownAsLabel=v&&"true"===v.toLowerCase()||!1,c.Label=s.getAttribute("Label");var b=s.getAttribute("YAxisType");c.SecondaryYAxis=b&&"secondary"===b.toLowerCase();var y=s.getAttribute("IsVisibleInLegend");c.HideInLegend=y&&"false"===y.toLowerCase();var _=s.getAttribute("LabelForeColor");c.LabelForeColor=_?le(_):null,c.LabelFormat=s.getAttribute("LabelFormat");var S=te(e,s.outerHTML||i.serializeToString(s),r);c.Name=S||null,c.Stack=c.CustomProperties.StackedGroupName,n.push(c)}return n}function te(e,t,r){var n=Object(o.a)(t);if(Object(J.j)(n)||n.length<5)return"";var a=n[2].toLowerCase(),i=n[4],s="",c=a.substring(0,r.length);if(c!==r)return"";var u=a.substring(r.length+1,a.length),l=Object(_.a)(e,c,u);return l&&l.OptionSet&&(s=l.OptionSet.filter((function(e){return e.Value.toString().toLowerCase()===i.toLowerCase()}))[0].Label),s}function re(e){var t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach((function(e){if(e){var r=le(e);t.push(r)}})),t}function ne(e){for(var t=new Array,r=e.querySelectorAll("Chart Legends Legend"),n=0;n<r.length;n++){var a={},i=r[n].getAttribute("Enabled");a.Enabled=null===i||"True"===i,t.push(a)}return t}function ae(e){for(var t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation"),n=0;n<r.length;n++){var a=r[n],i={},o=a.getAttribute("X");i.X=o?Number(o):null;var s=a.getAttribute("Y");i.Y=s?Number(s):null,i.Text=a.getAttribute("Text");var c=a.getAttribute("ForeColor");i.ForeColor=c?le(c):null,t.push(i)}return t}function ie(e){for(var t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX"),n=0;n<r.length;n++){var a=r[n],i={};se(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");var o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){var s=null==o?void 0:o.getAttribute("ForeColor"),c=null==o?void 0:o.getAttribute("Enabled");i.LabelForeColor=s?le(s):null,i.LabelDisabled=c&&"false"===c.toLowerCase(),i.FormatString=o.getAttribute("Format")}var u=a.getAttribute("Enabled"),l=a.getAttribute("LineColor"),p=a.getAttribute("TitleForeColor");i.Disabled=u&&"false"===u.toLowerCase(),i.AxisLineColor=l?le(l):null,i.AxisTitleForeColor=p?le(p):null,i.Disabled=u&&"false"===u.toLowerCase();var d=a.getAttribute("IsReversed");i.IsReversed=d&&"true"===d.toLowerCase(),t.push(i)}return t}function oe(e){var t=new Array,r=function(e,r){var n,a,i={};if(e){var o=e;i.Title=o.getAttribute("Title"),se(i,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);var s=o.getAttribute("Enabled");i.Disabled=s&&"false"===s.toLowerCase();var c=o.getAttribute("Interval"),u=o.getAttribute("Minimum"),l=o.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=u?Number(u):null,i.AxisMaximum=l?Number(l):null;var p=o.querySelectorAll("LabelStyle");p&&p[0]&&p[0].getAttribute("Format")&&(i.FormatString=p[0].getAttribute("Format"));var d=null===(n=null==p?void 0:p[0])||void 0===n?void 0:n.getAttribute("ForeColor");i.LabelForeColor=d?le(d):null;var h=null===(a=null==p?void 0:p[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=h&&"false"===h.toLowerCase();var g=o.getAttribute("LineColor");i.AxisLineColor=g?le(g):null;var m=o.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?le(m):null,t.splice(r,0,i)}else t.splice(r,0,i)},n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),(n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"))&&r(n[0],1),t}function se(e,t,r){if(e){if(t){var n=t.getAttribute("LineColor"),a=t.getAttribute("Enabled");e.AxisMajorGridColor=n?le(n):null,e.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(r){var i=r.getAttribute("LineColor"),o=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=i?le(i):null,e.AxisMajorTickMarkEnabled=o&&"true"===o.toLowerCase()}return e}}function ce(e){var t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function ue(e){var t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function le(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){var t=[];e.split(",").forEach((function(e){return t.push(e.trim())}));var r=t.shift(),n=parseFloat(r)/255,a=t.slice();return a.push(n.toString()),String.format("rgba({0})",a.join(","))}return e}var pe=r("BuSU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var he=function(){function e(e,t,r,n,a,i,o,s){this._getState=e,this._chartData=a,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=i,this._drilldownChartType=o,this._entityLogicalName=s}return e.prototype.buildChartModel=function(){if(this._chartQueryModel=Object(pe.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof k))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel},e.prototype._buildDataEmptyMessage=function(){var e=Object(g.b)(this._getState(),m.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)},e.prototype._buildErrorMessage=function(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Q.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)},e.prototype._buildChartHeading=function(){var e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()},e.prototype._buildChartPresentation=function(){var e,t=this;this._chartPresentationParser=$(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach((function(e){e.ChartType=t._drilldownChartType})),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList},e.prototype._buildChart=function(){this._chartParserType=this._getChartParserType();var e=function(e){var t=null;switch(e){case 2:t=new W;break;case 3:t=new H;break;case 1:default:t=new Y}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()},e.prototype._getChartParserType=function(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1},e}(),ge=r("8ADW"),me=r("y5DA"),fe=r("kKaT"),ve=r("TbLg"),be=r("z8lM"),ye=r("Fpc+"),_e=r("ZZrQ"),Se=r("AhDg");function Ce(e,t,r){return{type:"chartData.retrieve.core.async",execute:function(n,i,s){var c=n.dispatch,u=n.getState,l=[];try{var p=u();if(!Object(o.b)(u,c,i,l,e,t,r,!0))return Promise.resolve();var d=new _e.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);var h=function(e){var t={};if(null!=e){var r=new _e.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){var i=new Se.a(a.a.toString(a.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,i).nativePromise()}(i.DataSource,d,h,s).then((function(n){var i=function(t,r,n){var a=new Te(e.viewTitle,e.viewEntityLogicalName),i=new Te(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(be.a)(t);Object(o.e)(s,c,r());var u=e;return new he(r,a,i,s,c,e.presentationXml,u.drillDownChartType?u.drillDownChartType:null,n).buildChartModel()}(n,u,t);Object(M.c)(p,D.rd)?(c(je(e.getStorageKey(),i)),Ie(p,c,e.getStorageKey(),r)):(c(Pe(a.a.toString(e.visualizationId),a.a.toString(e.viewId),i)),Oe(p,c,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r))})).catch((function(t){Object(me.c)(p,c,t,e,r)}))}catch(e){return i.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),ge.b,l),Promise.reject(e)}}}}function Oe(e,t,r,i,o){if(e){var s=new a.a(r),c=a.a.toString(s),u=new a.a(i),l=a.a.toString(u),p={},d={};if(d[l]=function(e,t,r,a){if(!e)return null;if(a&&""!==a){var i=Object(ve.c)(e,t,r),o=i&&i.slice();return Object(n.a)(o,a)}return null}(e,c,l,o),d[l]){p[c]=d;var h={entities:null,lists:null,charts:p};t(Object(fe.b)(h))}}}function Ie(e,t,r,a){if(e){var i={};if(i[r]=function(e,t,r){if(!e)return null;if(r){var a=Object(ve.b)(e,t),i=a&&a.slice();return Object(n.a)(i,r)}return null}(e,r,a),i[r]){var o={entities:null,lists:null,charts:null,chartData:i};t(Object(fe.b)(o))}}}function Pe(e,t,r){var n,o,s=new a.a(e),c=a.a.toString(s),u=new a.a(t),l=a.a.toString(u),p={charts:(n={},n[c]=(o={},o[l]={initialized:i.a.Initialized,chartConfigObject:r},o),n)};return{type:ye.d,payload:p}}function je(e,t){var r,n={chartData:(r={},r[e]={initialized:i.a.Initialized,chartConfigObject:t},r)};return{type:ye.d,payload:n}}var Te=function(){function e(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}return e.prototype.get_DisplayName=function(){return this._displayName},e.prototype.get_AssociatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e}()},"A/RO":function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n,a=r("9r0m"),i=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(n||(n={}));var o=r("nbQV"),s=r("lKeh"),c=r("QAhb"),u=r("VnpK"),l=r("S2mk"),p=r("F2uj"),d=r("T576"),h=r("HSdq"),g=r("Sscr"),m=r("lMVv"),f=r("WS0f"),v=r("qC0c"),b=r("U0B9"),y=r("sOTk"),_=r("MSdU"),S=r("r0s4"),C=function(){function e(e,t,r){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=r}return e.prototype.generate=function(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null},e.prototype._getBusinessProcessFlowWrapper=function(e,t){var r=this._getState(),n=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!n||!t||!t.getProcessId())return null;var i=t.getCurrentFormEntity(),c=Object(y.g)(r,e);this._navigationEntities=t.getNavigationEntities();var u=Object(d.f)(r,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(r,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(n.data.activePath,n.activeStageId,n.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:n.activeStageId,selectedStageId:n.data.selectedStageId,activePath:n.data.activePath,displayState:n.displayState,currentEntity:new _.a(i.etn,a.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(h.Lb)(r,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:n.data.actionLogCollection,instanceModifiedTimestamp:u,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}},e.prototype._getStages=function(e,t,r,n,i){var o=this;if(!e||0===e.length)return null;var s={},c=[];return e.forEach((function(e,u){s[e.guid]=u;var l=a.a.equals(e,r),p=o._getStageWrapper(e,l,t,s,n,i);p&&c.push(p)})),c},e.prototype._getStageWrapper=function(e,t,r,n,i,o){var c=this,u=Object(s.c)(this._getState(),o.getProcessId(),e);if(!u)return null;var l=t&&this._getSteps(u,i,o)||[];if(Object(v.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var p="BusinessProcessFlow.CustomControlConfiguration",d=this._context.TraceManager.getTracer(p),h=Object(s.a)(this._getState(),o.getProcessId(),d);if(!Object(f.a)(h)&&!Object(f.a)(h.ControlConfigurations)){var g=o.getTelemetryParams();if(g.push({name:"BPFEntityFormId",value:h.Id.guid},{name:"BPFEntityFormType",value:h.FormType}),Object(f.a)(h.ControlConfigurations)||g.push({name:"CustomControls",value:Object.keys(h.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),h,d))try{if(!Object(f.a)(h.ControlConfigurations)){var b=Object(s.b)(h,d),y=h.ControlConfigurations,_=this._getNonDefaultControlConfiguration(y);if(Object(v.c)(this._getState(),"FCB.EnableBPFCCPhase3")){var S=this._buildStepsFromFormXml(u,h,_,g,i,o);S&&S.length>0&&(l=S,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(p,g))}else Object(f.a)(b)||Object.keys(b).forEach((function(e){if(b[e].ParentCellId){var t=new a.a(b[e].ParentCellId);if((u&&u.stage&&u.stage.steps?u.stage.steps.map((function(e){return e.stepId.guid})).indexOf(t.guid):-1)>=0&&t){var r=[];r.push({name:"StepId",value:t.guid},{name:"NonDefaultControlUniqueId",value:b[e].UniqueId}),d.info("Non-default control found for step",r);var n=null;_&&b[e].UniqueId&&(o.setFormXmlRenderingIndicator(!0),n=_[b[e].UniqueId]?_[b[e].UniqueId]:null);var i={attributeName:b[e].DataFieldName,isRequired:c._getIsStepRequired(t.guid,u),name:b[e].Label,stepId:new a.a(t.guid),stepType:"field",attributeType:c._getMetadataTypeByAttribute(u.entityLogicalName,b[e].DataFieldName),controlName:"header_process_"+b[e].Label,isVisible:b[e].Visible,isControlDisabled:b[e].Disabled,nonDefaultConfiguration:n};l.push(i),Object(f.a)(i.stepId.guid)||i.stepId.guid===a.a.EMPTY.guid||g.push({name:"StepId",value:i.stepId.guid}),g.push({name:"AttributeName",value:i.attributeName},{name:"AttributeType",value:i.attributeType},{name:"IsRequired",value:i.isRequired},{name:"NonDefaultControlUniqueId",value:b[e].UniqueId}),Object(f.a)(n)?c._context.EventManager.ReportComponentFailure(p,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,g):(o.setCustomControlIndicator(!0),g.push({name:"CustomControlId",value:n.CustomControlId}),!Object(f.a)(n.Name)&&n.Name.indexOf("MscrmControls")>=0&&g.push({name:"CustomControlName",value:n.Name}),c._context.EventManager.ReportComponentSuccess(p,g))}}}))}}catch(e){d.error("Message: "+e.message+", Stack: "+e.stack,g),this._context.EventManager.ReportComponentFailure(p,e,null,g)}else this._context.EventManager.ReportComponentFailure(p,new Error("Invalid FormXML - Fallback invoked"),null,g)}}return{id:u.stage.stageId,name:u.stage.stageDisplayName,entityName:u.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),u.entityLogicalName)||u.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(u.entityLogicalName),referencingAttributeName:u.referencingAttributeName,status:this._getStageStatus(n[e.guid],n[r.guid],o),steps:l}},e.prototype._buildStepsFromFormXml=function(e,t,r,n,i,o){var s=this,c=[],u=t.Controls;return!Object(f.a)(u)&&this._areStepsValid(e,t,n)&&Object.keys(u).forEach((function(l){if(!Object(f.a)(u[l])&&u[l].ParentCellId){var p=new a.a(u[l].ParentCellId),d=t.Tabs.find((function(e){return e.Id===u[l].ParentTabId}));if(d&&!Object(f.a)(d.RawTabId)&&e.stage.stageId.guid===new a.a(d.RawTabId).guid){var g=null;r&&u[l].UniqueId!==a.a.EMPTY.guid&&(g=r[u[l].UniqueId]?r[u[l].UniqueId]:null);var m=s._retrieveControlName(u[l],e.stage.steps),v=s._getUIControl(i,m),b={attributeName:u[l].DataFieldName,isRequired:u[l].IsRequired,name:s._retrieveStepLabel(u[l],v,e.stage.steps),stepId:new a.a(p.guid),stepType:s._getStepTypeFromControlKey(l),attributeType:s._getMetadataTypeByAttribute(e.entityLogicalName,u[l].DataFieldName),controlName:m,isVisible:v&&!Object(f.a)(v.visible)?v.visible:u[l].Visible,isControlDisabled:u[l].Disabled||Object(h.t)(s._getState(),{id:i,controlName:m},o.getContextToken()),viewId:v&&v.parameters&&v.parameters.defaultviewid?v.parameters.defaultviewid:null,nonDefaultConfiguration:Object(f.a)(g)?null:g};b.config=s._getConfig(t,o,u[l],i,n),b.viewId&&b.config&&b.config.Parameters&&b.config.Parameters.value&&(b.config.Parameters.value.ViewId=b.viewId,v&&v.customFilter&&v.customFilter.length>0&&(s._applyLookupFilter(b,v),b.config.Parameters.value.ExtraFilters=b.extraFilters)),c.push(b),n.push({name:"StepId",value:b.stepId.guid},{name:"AttributeName",value:b.attributeName},{name:"AttributeType",value:b.attributeType},{name:"IsRequired",value:b.isRequired},{name:"NonDefaultControlUniqueId",value:u[l].UniqueId}),Object(f.a)(g)||u[l].UniqueId===a.a.EMPTY.guid||(o.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:g.CustomControlId}),!Object(f.a)(g.Name)&&g.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:g.Name}))}}})),c},e.prototype._areStepsValid=function(e,t,r){if(!(Object(f.a)(t)||Object(f.a)(e)||Object(f.a)(e.stage)||Object(f.a)(e.stage.stageId))){var n=t.Controls,i=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(f.a)(n)){if(Object.keys(n).forEach((function(e){if(!Object(f.a)(n[e].ParentCellId)){var r=new a.a(n[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find((function(t){return t.Id===n[e].ParentTabId}));if(!Object(f.a)(o)&&!Object(f.a)(o.RawTabId)){var c=new a.a(o.RawTabId).guid.toLowerCase();i===c&&s.indexOf(r)<0&&s.push(r)}}})),o.length!==s.length)return r.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(var c=0;c<o.length;c++)if(s.indexOf(o[c].stepId.guid.toLowerCase())<0)return r.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[c].stepId.guid.toLowerCase()}),!1;return!0}}return!1},e.prototype._retrieveStepLabel=function(e,t,r){if(!Object(f.a)(t)&&!Object(f.a)(t.label)&&""!==t.label)return t.label;if(!Object(f.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(f.a)(r)&&r.length>0)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.a)(o.label)&&""!==o.label)return o.label}return""},e.prototype._retrieveControlName=function(e,t){if(!Object(f.a)(t)&&t.length>0)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.b)(i.controlName))return i.controlName}return Object(f.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName},e.prototype._getConfig=function(e,t,r,n,a){try{var i=Object(h.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:r&&r.Name});var c=i(this._getState(),r,n,o,s&&s.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){a.push({name:"CCFControlConfigError",value:e})}return null},e.prototype._getStageStatus=function(e,t,r){return null==t||e<t?n.Completed:e===t?r.getStatus()===i.a.Finished?n.Completed:n.Active:n.Inactive},e.prototype._getSteps=function(e,t,r){var n=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(var a=0,i=e.stage.steps;a<i.length;a++){var o=i[a],c=this._getUIControl(t,o.controlName),u=null;if(o.name&&o.stepType&&"field"===o.stepType.toLowerCase()){if(!(u=this._getMetadataTypeByAttribute(e.entityLogicalName,o.name)))continue;if(Object(v.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var l=this._context.TraceManager.getTracer("BpfCustomControlSupport"),p=Object(s.a)(this._getState(),r.getProcessId(),l);if(!Object(f.a)(p)&&!Object(f.a)(p.ControlConfigurations)&&r.isBpfFormDescriptorValid(this._getState(),r.getProcessId(),p,l)){var d=Object(s.b)(p,l),g=this._getNonDefaultControlStepIds(d);if(!Object(f.a)(g)&&g.map((function(e){return e.guid})).indexOf(o.stepId.guid)>=0)continue}}}var m=this._getState(),b={attributeName:o.name,controlName:o.controlName,isRequired:o.required,isVisible:!c||c.visible,name:c?c.label:o.label,stepId:o.stepId,stepType:o.stepType,attributeType:u,viewId:c&&c.parameters&&c.parameters.defaultviewid?c.parameters.defaultviewid:o.viewId,isControlDisabled:Object(h.t)(m,{id:t,controlName:o.controlName},r.getContextToken())};b.viewId&&c&&c.customFilter&&c.customFilter&&c.customFilter.length>0&&this._applyLookupFilter(b,c),n.push(b)}return n},e.prototype._applyLookupFilter=function(e,t){var r;r=!1;var n=[];if(e&&t){for(var a=0;a<t.customFilter.length;a++){if("END_FLAG"===t.customFilter[a].customFilter){r=!0;break}if("START_FLAG"!==t.customFilter[a].customFilter){var i=Object(u.i)(Object(S.CrmHtmlDecode)(t.customFilter[a].customFilter));i&&(i.conditions&&i.conditions.length>0||i.filters&&i.filters.length>0)&&n.push(JSON.stringify(i))}}r?(this._memorizedExtraFilters=n,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}},e.prototype._getMetadataTypeByAttribute=function(e,t){var r=this._getState(),n=Object(p.a)(r,e,t);if(!n)return null;var a=n.Type+"."+n.Format;return Object(l.n)(a)},e.prototype._getActions=function(e){return{completeProcess:function(){return e.completeProcess()},moveNext:function(){return e.moveToNextStage()},movePrevious:function(){return e.moveToPreviousStage()},setActiveStage:function(t){return e.setActiveStage(t.guid)},setSelectedStage:function(t,r){void 0===r&&(r=!1),e.setSelectedStage(t?t.guid:null,r)},triggerActionStepClick:function(t){e.triggerActionStepClick(t)},triggerFlowStepClick:function(t,r){e.triggerFlowStepClick(t,r)},refreshFlowStepClick:function(t){e.refreshFlowStepClick(t)},setDisplayState:function(t){e.setDisplayState(t)},getForwardNavigationEntities:function(t,r,n,a){return e.getForwardNavigationEntities(t,r,n,a)},navigateToNextEntity:function(t,r,n,a){return e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(r),n,a)},executePreEvent:function(t,r,n,a){return e.executePreEvent(t,r,n,a)},validateRequiredFieldsForNavigation:function(){return e.ValidateRequiredFieldsForNavigation()},waitForOngoingWork:function(){return e.waitForOngoingWork()},getActiveStageActiveFor:function(){return e.getActiveStageActiveFor()},getBpfInstanceActiveFor:function(){return e.getBpfInstanceActiveFor()},getBpfInstanceCompletedIn:function(){return e.getBpfInstanceCompletedIn()},getBpfNavigationBehavior:function(){return e.getBpfNavigationBehavior()},setBpfNavigationBehavior:function(t){e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:function(t){return e.getBpfNavigationBehaviorAllowCreateNew(t)},getActiveStage:function(){var t=e.getContextToken(),r=e.getScriptContainer().getEventManager().getClientApiForm(t);return r?r.data.process.getActiveStage():null}}},e.prototype._getRelatedEntityReference=function(e){if(!this._navigationEntities)return null;var t=this._navigationEntities.find((function(t){return t.entityLogicalName===e}));return t?new _.a(t.entityLogicalName,a.a.toLegacyGuid(a.a.parse(t.id))):null},e.prototype._getUIControl=function(e,t){if(t){var r=this._getState(),n=Object(g.j)(r,e),a={controlName:t,id:e};return Object(h.Mc)(this._getState(),a,n)}return null},e.prototype._getNonDefaultControlConfiguration=function(e){var t={};if(e)for(var r=Object.keys(e),n=0;n<r.length;n++){var a,i=Object(b.b)(this._getState());(a=e[r[n]].CustomControls[i])&&(t[r[n]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}return t},e.prototype._getNonDefaultControlStepIds=function(e){var t=[];return e&&Object.keys(e).forEach((function(r){e[r].ParentCellId&&t.push(new a.a(e[r].ParentCellId))})),t},e.prototype._getIsStepRequired=function(e,t){var r=t.stage.steps,n=r?r.map((function(e){return e.stepId.guid})).indexOf(e):-1;return n>=0&&!Object(f.a)(r[n].required)&&r[n].required},e.prototype._getStepTypeFromControlKey=function(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"},e}()},A8fJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.contentType";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i,meta:{pageId:e,tabId:t,contextKey:o}}}},ABRM:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.format";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},AVer:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("G7N+"),a=r("Sscr"),i=r("c56u"),o=r("kJGL"),s=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,i,o,c,l,p){var d,h=Object(a.v)(o),g=function(e,t){var r;if(!e)return null;var n=new DOMParser,a=e?n.parseFromString(e,"text/xml"):null;if(!a)return null;var i=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!i)return null;for(var o=i,s=[],c=0;c<o.length;c++)if(o[c].getAttribute){for(var l=o[c]?o[c].children?o[c].children:o[c].childNodes:void 0,p=[],d=null,h=0;h<l.length;h++){var g=l[h];if(g.getAttribute){var m=g.getAttribute("name"),f=void 0;f=(r=u(m,d,n,t)).relatedEntityName,d=r.fetchXmlDocument,p.push({name:m,width:parseInt(g.getAttribute("width"),10),relatedEntityName:f,disableMetaDataBinding:"1"===g.getAttribute("disableMetaDataBinding"),labelId:g.getAttribute("labelId"),isHidden:"1"===g.getAttribute("isHidden"),disableSorting:"1"===g.getAttribute("disableSorting"),addedBy:g.getAttribute("addedBy"),desc:g.getAttribute("desc"),cellType:g.getAttribute("cellType"),imageProviderWebresource:g.getAttribute("imageProviderWebresource"),imageProviderFunctionName:g.getAttribute("imageProviderFunctionName")})}}var v={name:o[c].getAttribute("name"),id:o[c].getAttribute("id"),cells:p,multiObjectIdField:o[c].getAttribute("multiObjectIdField"),layoutStyle:o[c].getAttribute("multiObjectIdField")};s.push(v)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(p,l),m={initialized:n.a.Initialized,viewId:r,fetchXML:l,entityLogicalName:i,title:c,layoutXML:p,grid:g,isCustomView:!0};return{type:s.a,payload:{views:(d={},d[r.guid]=m,d)},meta:{pageId:e,controlName:t,contextKey:h}}}function u(e,t,r,n){var a="";if(e.indexOf(".")>0){var i=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));var o=t.querySelector('link-entity[alias="'+i+'"]');o&&(a=o.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:t}}function l(e){return{type:s.f,execute:function(t,r){return(Object(i.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then((function(t){return e.offlineSqlQuery=t}))}}}},BWVO:function(e,t,r){"use strict";r.d(t,"a",(function(){return Me})),r.d(t,"b",(function(){return De}));var n,a,i,o,s,c,u,l,p,d=r("1z64"),h=r("9r0m"),g=r("9rlF"),m=r("QAhb"),f=r("ezfI"),v=r("F2uj"),b=r("iutC"),y=r("yHpA"),_=r("FuJ2"),S=r("o0+l"),C=r("HSdq"),O=r("5jMY"),I=r("Zy0S"),P=r("ObKm"),j=r("w/nD"),T=r("+Z9T"),E=r("IiPO"),F=r("Sscr"),A=r("lMVv"),x=r("zsi3"),w=r("xirW"),N=r("hCnb"),k=r("2p2B"),M=r("uQP8"),D=r("r0s4"),R=r("Srej"),L="ClientApi.XrmEntityAttribute.",V=function(){function e(e,t,r,a,i,o){n=e,this._clientApiExecutorAttribute=new d.a(e,L,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});var s=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(T.j)(s,"attributeName"),e||Object(T.j)(s,"store"),r||Object(T.j)(s,"pageId"),t||Object(T.j)(s,"contextToken"),o||Object(T.j)(s,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=r,this.xrmFormUi=o,this._contextToken=t}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutorAttribute.execute("controls",(function(t,r){if(!e._controls){e._controls=new I.a(t);var a=Object(C.z)(n.getState(),e._pageId,e.contextToken,e._attributeName);if(a){e.xrmFormUi.getControls();for(var i=e.xrmFormUi.controls,o=0;o<a.length;o++){var s=a[o],c=i.get(s);c&&e._controls.add(s,c)}}}return e._controls}))},enumerable:!1,configurable:!0}),e.prototype.addOnChange=function(e){var t=L+"addOnChange";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(j.a)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.fireOnChange=function(){var e=L+"fireOnChange";try{f.a.instance.reportCall(e),n.dispatch(Object(j.P)(this.contextToken,this._pageId,this.getName())),f.a.instance.reportSuccess(e)}catch(r){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getAttributeType=function(){var e=L+"getAttributeType";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().Type;return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFormat=function(){var e=this;return this._clientApiExecutorAttribute.execute("getFormat",(function(){var t=e.getAttrDescriptor();if(!t||!t.Format)return null;var r=t.Format.toLowerCase(),n=r;switch(e.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==r&&"2"!==r||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===r&&(n="none");break;case"memo":"2"!==r&&"1"!==r||(n="textarea");break;default:"0"===r?n="none":void 0===n&&(n=null)}return n}))},e.prototype.getIsDirty=function(){var e=L+"getIsDirty";try{f.a.instance.reportCall(e);var t=Object(C.Jb)(n.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(y.e)(n.getState(),Object(C.ac)(n.getState(),this.getPageId(),this.dataContextToken),this.getName());return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getName=function(){return f.a.instance.reportUsage(L+"getName"),this._attributeName},e.prototype.getParent=function(){return f.a.instance.reportUsage(L+"getParent"),this._parentEntity},e.prototype.getRequiredLevel=function(){var e=L+"getRequiredLevel";try{f.a.instance.reportCall(e);var t=Object(C.pc)(n.getState(),this._pageId,this.dataContextToken,this.getName()),r=void 0;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(T.h)(e,"RequiredLevel",t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getSubmitMode=function(){var e=L+"getSubmitMode";try{f.a.instance.reportCall(e);var t=Object(C.zc)(n.getState(),this._pageId,this.contextToken,this.getName()),r=void 0;switch(t){case O.a.Dirty:r="dirty";break;case O.a.Always:r="always";break;case O.a.Never:r="never";break;default:Object(T.h)(e,"SubmitMode",t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getUserPrivilege=function(){var e=L+"getUserPrivilege";try{f.a.instance.reportCall(e);var t=null;if(n.getState()&&this._parentEntity&&this._attributeName){var r=Object(b.a)(n.getState(),this._parentEntity.getEntityName(),h.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);r&&(t={canCreate:r.canCreate,canRead:r.canRead,canUpdate:r.canUpdate})}return f.a.instance.reportSuccess(e),t}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getValue=function(){var e=L+"getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return Object(T.a)(t)||(Object(g.j)(t)?r=t.value:Object(T.k)(e,"isPlainValue","value")),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnChange=function(e){var t=L+"removeOnChange";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(j.v)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setRequiredLevel=function(e){var t=L+"setRequiredLevel";e||Object(T.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(T.h)(t,"RequiredLevel",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}n.dispatch(Object(_.b)(this._pageId,this.dataContextToken,this._attributeName,r)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setSubmitMode=function(e){var t=L+"setSubmitMode";e||Object(T.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(T.h)(t,"SubmitMode",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"dirty":r=O.a.Dirty;break;case"always":r=O.a.Always;break;case"never":r=O.a.Never}n.dispatch(Object(S.b)(this._pageId,this.contextToken,this.getName(),r)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setValue=function(e){var t=L+"setValue";try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setIsValid=function(e,t){var r=this;return this._clientApiExecutorAttribute.execute("setIsValid",(function(a,i){e?(n.dispatch(Object(N.b)(r._pageId,r._attributeName,!0,r.contextToken)),n.dispatch(Object(k.b)(r.contextToken,r._pageId,Object(R.d)(r._pageId,r._attributeName))),n.dispatch(Object(w.b)(n.getState(),r._pageId,r._attributeName,null,r.contextToken))):r._addNotification(t)}))},e.prototype._addNotification=function(e){n.dispatch(Object(N.b)(this._pageId,this._attributeName,!1,this.contextToken));var t={messages:[e],notificationLevel:x.a.error};n.dispatch(Object(w.b)(n.getState(),this._pageId,this._attributeName,t,this.contextToken))},e.prototype.isValid=function(){var e=L+"isValid";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=this.getParent();if(r){var a=Object(A.h)(n.getState(),r.getEntityName());if(a&&a.PrimaryIdAttribute!==this.getName()&&r.getId()!==h.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(T.a)(t))return f.a.instance.reportSuccess(e),!1}var i=!0;return this.hasErrorNotification()?i=!1:t&&t.validationResult&&(i=t.validationResult.isValueValid),f.a.instance.reportSuccess(e),i}catch(t){var o=E.a.getInstance().getEventParameters(this._contextToken);throw o.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.hasErrorNotification=function(){var e=Object(F.v)(this.contextToken),t=n.getState(),r=Object(M.a)(t,this._pageId);return!(!r.forms||!r.forms[e]||!r.forms[e].invalidControls&&!r.forms[e].invalidAttributes)&&(!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()])},e.prototype.getPageId=function(){return this._pageId},e.prototype.getAttrDescriptor=function(){if(this.getParent()){var e=Object(C.r)(n.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(v.a)(n.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(C.Nc)(n.getState(),this.getPageId(),this.getName())},e.prototype.getDataXmlInternal=function(){var e="";return e=e+"<"+Object(D.CrmXmlEncode)(this.getName())+">"+Object(D.CrmXmlEncode)(this.getValue())+"</"+Object(D.CrmXmlEncode)(this.getName())+">"},e.prototype.setValueInternal=function(e){var t=this.getName(),r={};r[t]={fieldName:t,value:e},n.dispatch(Object(P.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(F.t)(this._contextToken),this.contextToken))},Object.defineProperty(e.prototype,"parentEntityReference",{get:function(){var e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new m.a(e,new h.a(t)):new m.a(e)},enumerable:!1,configurable:!0}),e.prototype.getValueInternal=function(){var e=Object(C.ac)(n.getState(),this.getPageId(),this.dataContextToken);return Object(C.X)(n.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,n.dispatch)},Object.defineProperty(e.prototype,"contextToken",{get:function(){return Object(F.r)(this._contextToken)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataContextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}(),B=r("c/eZ"),G=r("TCcM"),X=r("TV33"),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(B.__extends)(t,e),t.prototype.getOption=function(e){var t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(T.a)(e))return null;var r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(T.k)(t,"number","value");try{f.a.instance.reportCall(t);for(var n=this.getAttrDescriptor().OptionSet,a=null,i=0;i<n.length;i++)n[i].Value===e&&(a={text:n[i].Label,value:n[i].Value});return f.a.instance.reportSuccess(t),a}catch(e){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e),e}},t.prototype.getOptions=function(){var e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().OptionSet.map((function(e){return{text:e.Label,value:e.Value}}));return f.a.instance.reportSuccess(e),t}catch(t){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t),t}},t}(V),U=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c}return Object(B.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(a.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(X.a)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(T.a)(e)||"boolean"!=typeof e&&Object(T.k)(t,"boolean","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"},t}(q),z=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;return i=t,c}return Object(B.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(i.getState(),this.parentEntityReference,this.getName()),r=Object(X.e)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getSelectedOption=function(){var e=this,t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{f.a.instance.reportCall(t);var r=null,n=this.getValue();return n&&(r=[],n.forEach((function(t){var n=e.getOption(t);n&&r.push(n)}))),f.a.instance.reportSuccess(t),r}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{f.a.instance.reportCall(e);var t=null,r=this.getSelectedOption();return r&&(t=[],r.forEach((function(e){t.push(e.text)}))),f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return t&&(r=Object(X.e)(t)),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{f.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t}(q),W=r("otJc"),H=r("dl9j"),Y=r("+h4s"),Q=r("sRkF"),K=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(B.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));var t=Object(D.CrmXmlEncode)(this.getName()),r="";return r+="<"+t+">",r+=""+(null===e?"":Object(D.CrmXmlEncode)(e.format("s"))),r+="</"+t+">"},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;if(Object(g.j)(t)&&!Object(T.a)(t.formatted)){var n=this.getAttrDescriptor();r=Object(X.b)(o.getState(),n,t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._userSettings=function(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new H.a(o)},t.prototype.getUtcValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{f.a.instance.reportCall(e);var t=this.getValue();return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(T.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(T.k)(t,"Date","value");try{if(f.a.instance.reportCall(t),Object(T.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){var r=new Date,n=this.getAttrDescriptor(),a=Object(W.z)(o.getState(),n),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(Y.o)(new Date(r.getFullYear(),r.getMonth(),r.getDate()),a.userSettings.timeZoneAdjusters)-Object(Y.o)(e,a.userSettings.timeZoneAdjusters),c=6e4*e.getTimezoneOffset(),u=null;switch(a.controlAttributes.Behavior){case Q.a.UserLocal:u=new Date(e.getTime()+c+i-s);break;default:u=new Date(e.getTime())}this.setValueInternal(u)}f.a.instance.reportSuccess(t)}catch(e){var l=E.a.getInstance().getEventParameters(this.contextToken);throw l.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,l),e}},t.prototype.setUtcValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{f.a.instance.reportCall(t),this.setValue(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"},t}(V),J=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c}return Object(B.__extends)(t,e),t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1},t.prototype.getDataXmlInternal=function(){var e=this.getValue(),t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{var r=Object(D.CrmXmlEncode)(this.getName());t+="<"+r+">",t+="</"+r+">"}return t.toString()},t.prototype.getLookupDataXml=function(e,t){var r=Object(D.CrmXmlEncode)(e),n="<"+r,a=this.getEntityTypeCode(t.entityType);return a>0&&(n+=' type="'+Object(D.CrmXmlAttributeEncode)(a.toString())+'"'),t.entityType&&(n+=' typeName="'+Object(D.CrmXmlAttributeEncode)(t.entityType)+'"'),Object(T.a)(t.name)||(n+=' name="'+Object(D.CrmXmlAttributeEncode)(t.name)+'"'),n+=">"+Object(D.CrmXmlEncode)(t.id)+"</"+r+">"},t.prototype.getEntityTypeCode=function(e){return Object(A.p)(s.getState(),e)},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeLookup.setValue",r=null;if(e&&Array.isArray(e)&&e.length>0){e.length>1?Object(T.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?h.a.tryParseOrNull(e[0].id)||Object(T.h)(t,"guid",e[0].id):Object(T.j)(t,"value[0].id"):Object(T.j)(t,"value[0].entityType");var n=void 0;try{n=Object(C.Ob)(s.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getLookupTargets",e,null,a),e}if(n)if(!(n.indexOf(e[0].entityType)>-1))(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"actualValue",value:e[0].entityType}),Object(T.k)(t,"entityType","value[0].entityType",a);try{f.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new m.a(e[0].entityType,new h.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),f.a.instance.reportSuccess(t)}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}}else this.setValueInternal(r)},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeLookup.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(X.d)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"},t}(V),Z=r("/wtJ"),$=r("kvLG"),ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return c=t,s._clientApiExecutorAttributeNumber=new d.a(t,"ClientApi.XrmEntityAttributeNumber.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(B.__extends)(t,e),t.prototype.getMax=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMax",(function(){return e.getAttrDescriptor().MaxValue}))},t.prototype.getMin=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMin",(function(){return e.getAttrDescriptor().MinValue}))},t.prototype.getPrecision=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getPrecision",(function(){return Object(C.k)(c.getState(),e.getPageId(),e.dataContextToken,e.getName())}))},t.prototype.setPrecision=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setPrecision",(function(r,n){"integer"===t.getAttributeType()&&Object(T.e)(r,"setPrecision is not valid on integer attributes",void 0,n);var a=Object(v.a)(c.getState(),t.getParent().getEntityName(),t.getName());(e<0||e>a.Precision)&&(n.push({name:"metadataPrecision",value:a.Precision}),Object(T.h)(r,"precision",e.toString(),n)),c.dispatch(Object(Z.b)(t.getPageId(),t.dataContextToken,t.getName(),e))}),[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getValue",(function(){var t=e.getValueInternal();return Object(X.f)(t,e.getAttributeType(),e.getPrecision())}))},t.prototype.setValue=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setValue",(function(){t.setValueInternal(e)}),[{name:"value",value:e,expectedDataType:"number"}])},t.prototype.getAttributeType=function(){var t=this;return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(function(r,n){var a=t.getAttrDescriptor().Type;switch(a){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return n.push({name:"attributeType",value:a}),a?t._clientApiExecutorAttributeNumber.reportFailure(r,new Error("Unexpected number attribute type."),n):$.a.getInstance().traceManager.getTracer(r).error("Number attribute type was not defined in metadata.",n),e.prototype.getAttributeType.call(t)}}))},t}(V),te=r("sOTk"),re=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return u=t,s}return Object(B.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(u.getState(),this.parentEntityReference,this.getName()),r=Object(te.m)(u.getState(),this.getPageId()),n=void 0;if(r){var a=this.getAttrDescriptor();n=Object(X.g)(t)||a&&a.DefaultFormValue?a.DefaultFormValue:null}else n=Object(X.g)(t);return f.a.instance.reportSuccess(e),n}catch(t){var i=E.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.getSelectedOption=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{f.a.instance.reportCall(e);var t=this.getOption(this.getValue());return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getText";try{f.a.instance.reportCall(e);var t=this.getSelectedOption(),r=null;return t&&(r=t.text),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(X.g)(t),n=Object(T.a)(r)?Object(X.f)(t,this.getAttributeType(),0):r;return f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(T.k)(t,"number","value");var r=!1;try{if(e&&this.getParent()){var n=this.getAttrDescriptor();for(var a in n.OptionSet)if(e===n.OptionSet[a].Value){r=!0;break}}else r=!0}catch(e){throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,i),e}r||Object(T.h)(t,"OptionSetValue",e);try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var i;throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"},t}(q),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(B.__extends)(t,e),t.prototype.getMaxLength=function(){var e="ClientApi.XrmEntityAttributeString.getMaxLength";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().MaxLength;return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeString.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(X.i)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeString.setValue";Object(T.a)(e)||"string"!=typeof e&&Object(T.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){var t="ClientApi.XrmEntityAttributeString.getAttributeType";try{f.a.instance.reportCall(t);var r=void 0,n=this.getAttrDescriptor().Type;switch(n){case"memo":r="memo";break;case"string":r="string";break;default:(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"attributeType",value:n}),E.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,a),r=e.prototype.getAttributeType.call(this)}return f.a.instance.reportSuccess(t),r}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t}(V),ae=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutor=new d.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,r),s._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0}),s}return Object(B.__extends)(t,e),t.prototype.setValue=function(e){var t=this;this._clientApiExecutor.execute("setValue",(function(){t.setValueInternal(h.a.tryParseOrNull(e))}),[{name:"value",value:e,expectedDataType:"guid"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutor.execute("getValue",(function(){var t=e.getValueInternal();return Object(X.j)(t)}))},t.prototype.getAttributeType=function(){return this._clientApiExecutor.execute("getAttributeType",(function(){return"string"}))},t}(V),ie=r("nVTU"),oe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return l=t,s}return Object(B.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this,t=Object(D.CrmXmlEncode)(this.getName()),r=this.getValue(),n="";return n+="<"+t+">",r.forEach((function(t){n+="<activityparty>",n+=e.getLookupDataXml("partyid",t),n+="</activityparty>"})),(n+="</"+t+">").toString()},t.prototype.setValue=function(e){var t,r="ClientApi.XrmEntityAttributePartyList.setValue",n=E.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(T.k)(r,"LookupValue[]","value",n));var a=new Array;try{t=Object(C.Ob)(l.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw E.a.getInstance().reportFailure(r+".getLookupTargets",e,null,n),e}e&&t&&(t.push("unresolvedaddress"),e.forEach((function(e){t.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(T.e)(r,'LookupValue[] with invalid entity type. Entity type "'+e.entityType+'" is invalid.',"LookupValue[] with invalid entity type",n))})));try{f.a.instance.reportCall(r),e?(t?e.forEach((function(e){t.indexOf(e.entityType)>-1&&a.push(new ie.a(e.entityType,e.id,e.name))})):e.forEach((function(e){a.push(new ie.a(e.entityType,e.id,e.name))})),this.setValueInternal(a)):this.setValueInternal([]),f.a.instance.reportSuccess(r)}catch(e){throw E.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributePartyList.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(X.h)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0},t}(J),se=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorAttributeFile=new d.a(t,"ClientApi.XrmEntityFile.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(B.__extends)(t,e),t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeFile.execute("getValue",(function(){var t=e.getValueInternal();return Object(X.c)(t)}))},t.prototype.setValue=function(e){var t=this;this._clientApiExecutorAttributeFile.execute("setValue",(function(){t.setValueInternal(e)}))},t}(V),ce=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return p=t,s}return Object(B.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeEntityName.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(v.a)(p.getState(),this.getParent().getEntityName(),this.getName()),n=null;return r.IsEntityReferenceStored&&Object(g.j)(t)&&(n=t.value),f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(T.a)(e)||"string"==typeof e||Object(T.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"},t}(V),ue=r("r529"),le=r("Xia5"),pe=r("jJRu"),de=r("Cfob"),he=r("cAHA"),ge=r("8aRo"),me=r("+P1Q"),fe=r("qYad"),ve=r("9qYn"),be=r("yZTI"),ye=r("Z1aD"),_e=r("xc1f"),Se=r("Gemh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ce(e,t,r,n){var a=Object(C.z)(e,t,r,n,r.relationshipName);if(!a||0===a.length)return!0;for(var i=0;i<a.length;i++)if(!Object(C.t)(e,{controlName:a[i],id:t},r))return!0;return!1}function Oe(e,t,r,n,a,i){if(!Object(Se.K)(e,t,r,n,null==i?void 0:i.id))return!1;var o=Object(Se.y)(e,r,t);if(!a||!o)return!1;if(o&&0===o[n])return!1;if(null===a.ParentPicklistLogicalName)return!0;var s=Object(C.ac)(e,t,r),c=Object(C.X)(e,t,r,s,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie,Pe,je,Te=r("UOiB"),Ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return Ie=t,s}return Object(B.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Oe(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Ce(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")},t}(re),Fe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return Pe=t,s}return Object(B.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Oe(Pe.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Ce(Pe.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)(n,"Can not execute setValue for dependent option set attribute since it is disabled.")},t}(z),Ae=r("cZkS"),xe=r("qC0c"),we=r("3ZuC"),Ne=r("WVwd"),ke=r("RK8T"),Me=function(){function e(e,t,r,n,a,i,o,s){je=e;var c=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:n,isRequired:!0}];this._clientApiExecutor=new d.a(e,"ClientApi.XrmEntity.",r,t,c),this._pageId=r,this._xrmForm=n,this._contextToken=t,this._entityType=a,this._entityId=i,this._getAttributeNames=o,this._applicationContext=s}return Object.defineProperty(e.prototype,"attributes",{get:function(){var e=this;return this._clientApiExecutor.execute("attributes",(function(t,r){if(!e._attributes){e._attributes=new I.a(t);var n=e._getAttributeNames(e._applicationContext,e._contextToken,e._pageId);if(!n)return e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),r),e._attributes;0===n.length&&e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),r),n.forEach((function(t){var r=Object(v.a)(je.getState(),e.getEntityName(),t);if(r){var n=De(je,e._contextToken,e._pageId,t,e,e._xrmForm.ui,r);e._attributes.add(t,n)}}))}return e._attributes}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedEntities",{get:function(){var t=this,r="ClientApi.XrmEntity.relatedEntities";try{if(f.a.instance.reportCall(r),!this._relatedEntities){this._relatedEntities=new I.a(r);var n=Object(C.oc)(je.getState(),{id:this._pageId},this._contextToken);for(var a in n)if(n[a]){var i=Object(F.m)(this._contextToken,a),o=new e(je,i,this._pageId,this._xrmForm,n[a].etn,n[a].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,o),this._updateControl(o,a)}var s=Object(C.nc)(je.getState(),{id:this._pageId}),c={};for(var a in s){var u=s[a];c[u.referencingAttribute]||(c[u.referencingAttribute]={}),c[u.referencingAttribute][u.referencedEntity]=a}var l=function(r){je.dispatch(Object(j.a)(p._contextToken,p._pageId,r,(function(n){for(var a in c[r]){var i=t._relatedEntities.get(c[r][a]);i&&t._relatedEntities.remove(i)}var o=n.getEventSource().getValue();if(o&&o.length>0){var s=o[0],u=c[r][s.entityType],l=Object(F.m)(t._contextToken,u),p=new e(je,l,t._pageId,t._xrmForm,s.entityType,h.a.tryParse(s.id),t._getAttributeNames,t._applicationContext);t._relatedEntities.add(u,p),t._updateControl(p,u)}}),!0))},p=this;for(var d in c)l(d)}return f.a.instance.reportSuccess(r),this._relatedEntities}catch(e){var g=E.a.getInstance().getEventParameters(this._contextToken);throw g.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(r,e,null,g),e}},enumerable:!1,configurable:!0}),e.prototype._updateControl=function(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach((function(r){r instanceof me.a&&r.updateAttribute(e,t)}))},e.prototype.addOnSave=function(e){var t="ClientApi.XrmEntity.addOnSave";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),je.dispatch(Object(j.o)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getDataXml=function(){var e="ClientApi.XrmEntity.getDataXml";try{f.a.instance.reportCall(e);var t="";return this.attributes.forEach((function(e){e.getIsDirty()&&(t+=e.getDataXmlInternal())})),t="<"+Object(D.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(D.CrmXmlEncode)(this.getEntityName())+">",f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityReference=function(){var e="ClientApi.XrmEntity.getEntityReference";try{f.a.instance.reportCall(e);var t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityName=function(){var e="ClientApi.XrmEntity.getEntityName";try{return f.a.instance.reportCall(e),f.a.instance.reportSuccess(e),this._entityType}catch(r){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getId=function(){var e="ClientApi.XrmEntity.getId";try{if(f.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING){var t=Object(te.i)(je.getState(),this._pageId);if(t&&t.value){var r=t.value;this._entityId=r.id}else{var n=Object(C.ac)(je.getState(),this._pageId,this._contextToken);if(n){var a=Object(y.b)(je.getState(),n);a&&a.identifier&&(this._entityId=a.identifier.id)}}}return this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING?(f.a.instance.reportSuccess(e),h.a.EMPTYSTRING):(f.a.instance.reportSuccess(e),h.a.externalGuid(this._entityId))}catch(t){var i=E.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getPrimaryAttributeValue=function(){var e=this;return this._clientApiExecutor.execute("getPrimaryAttributeValue",(function(t,r){var n="",a=Object(A.h)(je.getState(),e.getEntityName());if(a){if(!a.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",$.a.getInstance().traceManager.getTracer(t).error(n,r),"";var i=Object(C.ac)(je.getState(),e._pageId,e._contextToken),o=e.getId()?new m.a(e.getEntityName(),new h.a(e.getId())):new m.a(e.getEntityName()),s=Object(C.X)(je.getState(),e._pageId,e._contextToken,i,o,a.PrimaryNameAttribute);if(!s)return"";if(Object(g.j)(s))return s.value;n="PrimaryAttribute value was not an IPlainValue"}else n="Entity descriptor could not be retrieved.";return E.a.getInstance().reportFailure(t,new Error(n),null,r),""}))},e.prototype.getIsDirty=function(){var e="ClientApi.XrmEntity.getIsDirty";try{f.a.instance.reportCall(e);for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return f.a.instance.reportSuccess(e),!0}for(t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return f.a.instance.reportSuccess(e),!0}return f.a.instance.reportSuccess(e),!1}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnSave=function(e){var t="ClientApi.XrmEntity.removeOnSave";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),je.dispatch(Object(j.J)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.save=function(e){var t=this;this._clientApiExecutor.executeAsync("save",(function(r,n){var a=1;if(e)if("string"==typeof e)switch(e){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else e.saveMode&&(a=e.saveMode);var i=je.getState();return Object(Ne.b)(t._pageId,je,a,n,t._contextToken,t,!1,"saveandclose"!==e).then((function(r){return t._performAfterSaveLogic(i,r,e)}))}))},e.prototype.isValid=function(){var e="ClientApi.XrmEntity.isValid";try{if(f.a.instance.reportCall(e),this.attributes)for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return f.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return f.a.instance.reportSuccess(e),!1;return f.a.instance.reportSuccess(e),!0}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setRecordId=function(e){var t=this,r="ClientApi.XrmEntity.setRecordId";e||Object(T.j)(r,"id");try{if(f.a.instance.reportCall(r),this.getId()&&this._entityId.guid!==h.a.EMPTYGUIDSTRING)f.a.instance.reportSuccess(r);else{var n=h.a.tryParse(e);h.a.isNullOrEmpty(n)&&Object(T.j)(r,"id");var a=je.getState(),i=Object(C.ac)(a,this._pageId,this._contextToken),o=Object(F.x)(this._contextToken);if(i){var s=new m.a(this.getEntityName(),n);je.dispatch(Object(le.b)(i,s)),f.a.instance.reportSuccess(r)}else{var c=Object(pe.b)(a,new m.a(this.getEntityName(),n),{},o,he.a.Create),u=c.payload.snapshotId;je.dispatch(c),je.dispatch(Object(de.b)(this._pageId,u,this._contextToken)).then((function(){f.a.instance.reportSuccess(r)})).catch((function(e){var n=E.a.getInstance().getEventParameters(t._contextToken);n.push({name:"entityName",value:t.getEntityName()}),E.a.getInstance().reportFailure(r+".setDataSnapshotId",e,null,n)}))}}}catch(e){var l=E.a.getInstance().getEventParameters(this._contextToken);throw l.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(r,e,null,l),e}},e.prototype.refresh=function(){var e=this,t="ClientApi.XrmEntity.refresh";try{if(f.a.instance.reportCall(t),this.getId()){for(var r=new m.a(this.getEntityName(),new h.a(this.getId())),n=[],a=[],i=0;i<this.attributes.getLength();i++)a.push(this.attributes.get(i).getName());var o=Object(ge.a)(je.getState(),r.etn);if(o&&a.push.apply(a,o),n.push(je.dispatch(Object(fe.a)(this._pageId,r,a,new ke.a(m.a.toLegacyEntityReference(r),null,null)))),this.relatedEntities)for(i=0;i<this.relatedEntities.getLength();i++)n.push(this.relatedEntities.get(i).refresh());return Promise.all(n).then((function(){Object(ve.b)(e),f.a.instance.reportSuccess(t)})).catch((function(r){var n=E.a.getInstance().getEventParameters(e._contextToken);return n.push({name:"entityName",value:e.getEntityName()}),Object(T.d)(je,r,t,n)}))}return f.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){var s=E.a.getInstance().getEventParameters(this._contextToken);return s.push({name:"entityName",value:this.getEntityName()}),Object(T.d)(je,e,t,s)}},e.prototype._attributeHasActiveControl=function(e){if(e&&e.controls)for(var t=e.controls.getLength(),r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0;return!1},e.prototype._performAfterSaveLogic=function(e,t,r){var n=Object(C.kb)(je.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(ve.b)(this),"saveandclose"===r){if(!Object(ve.a)(Object(be.b)(je.getState())===this._pageId)){var a=Object(C.Kb)(e,this._pageId),i=Object(C.Ib)(e,this._pageId);if(!a&&!i){var o=Object(we.a)(je.getState(),this._pageId);return je.dispatch(Object(ue.b)(o))}}}else if("saveandnew"===r){var s={entityTypeName:this.getEntityName()};return je.dispatch(Object(ye.a)(_e.a,s,this._pageId))}return Promise.resolve()},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function De(e,t,r,n,a,i,o){var s=null;switch(o.Type){case"datetime":s=new K(e,t,r,n,a,i);break;case"decimal":case"double":case"integer":case"money":s=new ee(e,t,r,n,a,i);break;case"lookup":case"owner":case"customer":s=new J(e,t,r,n,a,i);break;case"partylist":s=new oe(e,t,r,n,a,i);break;case"memo":case"string":s=new ne(e,t,r,n,a,i);break;case"picklist":if(Object(xe.c)(e.getState(),Ae.L)&&Object(v.l)(e.getState(),o.EntityLogicalName,n)){s=new Ee(e,t,r,n,a,i);break}case"optionset":case"state":case"status":s=new re(e,t,r,n,a,i);break;case"boolean":s=new U(e,t,r,n,a,i);break;case"entityname":s=new ce(e,t,r,n,a,i);break;case"uniqueidentifier":s=new ae(e,t,r,n,a,i);break;case"multiselectpicklist":s=Object(xe.c)(e.getState(),Ae.L)&&Object(v.l)(e.getState(),o.EntityLogicalName,n)?new Fe(e,t,r,n,a,i):new z(e,t,r,n,a,i);break;case"file":s=new se(e,t,r,n,a,i);break;default:s=new V(e,t,r,n,a,i)}return s}},Baft:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="polite",a="assertive"},BuSU:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},Cgjg:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCustomFilter";function o(e,t,r,o,s){return{type:"grid.setCustomFilter.async",execute:function(c,u){var l=c.dispatch,p=(c.getState,u.TraceManager.getTracer(a.z)),d=a.x+".setCustomFilterAction";try{return p.info("Adding a custom filter for the grid. "),l(function(e,t,r,a,o){var s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}var c=Object(n.y)(a),u=Object(n.v)(a);return{type:i,payload:s,meta:{pageId:r,contextKey:c,dataSetContextKey:u}}}(e,t,r,o,s)),u.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){u.EventManager.ReportComponentFailure(d,Error("Adding a custom filter for the grid failed"))}}}}},"Dlr/":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("9r0m"),c=r("YCDx"),u=r("w/nD"),l=r("Sscr"),p=r("/W63"),d=r("IiPO"),h=r("ar+e"),g=r("QUnS"),m=r("Ka9P"),f=r("7bez"),v=r("h82J"),b=r("ezfI"),y=r("kvLG"),_="ClientApi.XrmControlSubGrid.",S=function(e){function t(t,r,a,o,s,c,u,p){var d=e.call(this,t,r,a,u,o,c)||this;return d._relationship=null,n=t,d._subgridToken=Object(l.p)(r,o),d._clientApiExecutorSubGrid=new i.a(t,_,a,d._subgridToken),d.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),d.clientApiExecutor.addEventParameter({name:"isEditable",value:s,isEventParam:!0}),d._gridControl=new f.a(t,d._subgridToken,a,s,3,!0,p,o),t.dispatch(Object(v.a)(d,a,d._subgridToken)),d}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorSubGrid},enumerable:!1,configurable:!0}),t.prototype.setFilterXml=function(e){var t=_+"setFilterXml";try{b.a.instance.reportCall(t),this._gridControl.setFilterXml(e),b.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getFilterXml=function(){var e=_+"getFilterXml";try{b.a.instance.reportCall(e);var t=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refresh=function(){var e=_+"refresh";try{b.a.instance.reportCall(e),this._gridControl.refresh(),b.a.instance.reportSuccess(e)}catch(r){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getFetchXml=function(){var e=_+"getFetchXml";try{b.a.instance.reportCall(e);var t=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getGrid=function(){var e=_+"getGrid";try{b.a.instance.reportCall(e);var t=this._gridControl.getGrid();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getViewSelector=function(){var e=_+"getViewSelector";try{b.a.instance.reportCall(e);var t=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getTeamTemplateId=function(){var e=_+"getTeamTemplateId";try{b.a.instance.reportCall(e);var t=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnLoad=function(e){var t=this;this.clientApiExecutor.execute("addOnLoad",(function(){n.dispatch(Object(u.d)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.removeOnLoad=function(e){var t=this;this.clientApiExecutor.execute("removeOnLoad",(function(){n.dispatch(Object(u.y)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.getEntityName=function(){var e=_+"getEntityName";try{b.a.instance.reportCall(e);var t=this._gridControl.getEntityName();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){var e=this;return this.clientApiExecutor.execute("getControlType",(function(){var t=Object(g.a)(n.getState(),e.controlDescriptor,e.pageId,e.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"}))},t.prototype.getRelationship=function(){var e=this;return this.clientApiExecutor.execute("getRelationship",(function(t,r){var n,a;if(!e._relationship){if(null===(a=null===(n=e.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===a?void 0:a.RelationshipName){var i=e.controlDescriptor.Parameters.RelationshipName,o=e.controlDescriptor.Parameters.RelationshipRoleOrdinal,s=e.controlDescriptor.Parameters.TargetEntityType;e._relationship=Object(f.b)(i,s),e._relationship.roleType=o}e._relationship||(e._relationship=e._gridControl.getRelationship())}return e._relationship}))},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return b.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.openRelatedGrid=function(){var e=this;this.clientApiExecutor.executeAsync("openRelatedGrid",(function(t,r){var a=e.getRelationship();if(!a)return y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",r),Promise.resolve(s.a.EMPTY);for(var i=Object(h.c)(n.getState(),e.pageId),o=null,c=0;c<i.length;c++)if(i[c].relationshipName===a.name){o=i[c];break}if(!o)return r.push({name:"relationshipName",value:a.name}),y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",r),Promise.resolve(s.a.EMPTY);var u={id:o.id,title:o.title,entityName:e.getEntityName(),relationshipName:a.name,isSelected:!0,show:o.show},d=Object(l.a)(e._subgridToken.parentContextToken,a.name,a.roleType?1===a.roleType?m.a.Referencing:m.a.AssociationEntity:void 0);return n.dispatch(Object(p.a)(e.pageId,d,u))}))},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(r){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getUrl=function(){var e=_+"getUrl";try{b.a.instance.reportCall(e);var t=this._gridControl.getUrl();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{b.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,r),t}},t}(c.a)},Ds7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("9r0m"),a=r("Sscr"),i=r("uO/V"),o=r("Gemh"),s=r("F2uj"),c=r("VWqI"),u=r("wUng"),l=r("QAhb"),p=r("cZkS"),d=r("qC0c"),h=r("yHpA"),g=r("+Xnp"),m="dataset.row.properties";function f(e,t,r){return{type:"row.properties.async",execute:function(u,h){var f,b,y,_=u.dispatch,S=u.getState,C=h.TraceManager.getTracer(i.z),O=i.x+".RowPropertiesAction",I=Object(d.c)(S(),p.L);try{var P=Object(a.v)(t),j=Object(o.P)(S(),t,{id:e});if(j){var T=null,E=Object(o.Q)(S(),e,t);if(E)T=E;else{var F=Object(o.S)(S(),{id:e},t);F&&F.entityLogicalName&&(T=F.entityLogicalName)}if(T){var A=Object(s.d)(S(),T),x=Object(o.y)(S(),t,e);if(A){for(var w=[],N=0,k=Object.keys(A);N<k.length;N++){var M=A[k[N]],D=Object(c.f)(S(),T,M.LogicalName,g.a.CanUpdate),R=!0;I&&x&&0===x[M.LogicalName]&&(R=!1),w.push(((f={})[M.LogicalName]={requiredLevel:M.RequiredLevel,isDisabled:!(M.IsValidForUpdate&&D&&R),notifications:{}},f))}for(var L=function(e){var t;if(0===j.records.filter((function(t){return Object.keys(t)[0]===n.a.toString(e)})).length)j.records.push(((t={})[n.a.toString(e)]=w,t));else{var r=j.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)],a=JSON.parse(JSON.stringify(w));r&&r.forEach((function(e){var t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(a.find((function(t){return Object.keys(t)[0]===Object.keys(e)[0]}))[Object.keys(e)[0]].notifications=t.notifications)})),j.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)]=a}},V=0,B=r;V<B.length;V++){L(B[V])}}}if(_(function(e,t,r){return{type:m,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,P,j)),I&&T){A=Object(s.d)(S(),T),x=Object(o.y)(S(),t,e);for(var G=0,X=r;G<X.length;G++){var q=X[G],U=(S(),b=q,y=T,new l.a(y,b)),z=Object(a.f)(t,q,T);if(A)for(var W=0,H=Object.keys(A);W<H.length;W++){M=A[H[W]];x&&1===x[M.LogicalName]&&null===M.ParentPicklistLogicalName&&v(S(),_,e,U,M.LogicalName,z)}}}C.info("creating the rowproperties for {0} rows"+r.length),h.EventManager.ReportComponentSuccess(O)}return Promise.resolve()}catch(e){var Y="creating the rowproperties for {0} rows"+r.length+"failed";h.EventManager.ReportComponentFailure(O,Error(Y))}}}}function v(e,t,r,n,a,i){var s={},c=Object(o.R)(e,r,i),l=Object(h.d)(e,c,n,a);s[a]=l,Object.keys(s).length>0&&t(Object(u.b)(r,i,!1,s))}},EaxW:function(e,t,r){"use strict";r.r(t),r.d(t,"Benchmark",(function(){return m}));var n=r("9n3m"),a=r("sOTk"),i=r("XNwl"),o=r("Pm+b"),s=r("Sscr"),c=r("LBS5");var u=r("nuS9"),l=r("YWpA"),p=r("yZTI"),d=r("NJzV"),h=r("4E+q");var g=Object(h.a)((function(){var e=null;return function(t){var r=Object(p.c)(t),n=Object(a.g)(t,r),i=n.elementNumber||1,o=n.controlName,c=n.configuration,u=n.descriptor;return{pageId:r,controlName:o,configuration:c,contextToken:e=e||Object(s.j)(t,r),descriptor:u,elementNumber:i}}}))((function(e){return u.createElement(l.a,{key:"BenchmarkRoot",style:{display:"flex",flexDirection:"row",flex:"auto",width:"100%"}},e&&e.configuration&&e.configuration?
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){for(var t=[],r=e.elementNumber,n=e.controlName,a=0;a<r;a++){var i=u.createElement(l.a,{style:{display:"flex",flexDirection:"row",flex:"auto",flexWrap:"wrap",margin:"5px",minWidth:"150px",maxWdith:"300px"}},u.createElement(d.c,{key:n+a,controlId:"testControl",id:e.pageId,systemDefinedProperties:null,descriptor:e.descriptor,configuration:e.configuration,formInfo:void 0,shouldRender:!0,parentContextToken:e.contextToken,parentDefinedControlProps:void 0}));t.push(i)}return t}(e):"EMPTY BENCHMARK")})),m=function(){function e(e){this._id=e}return e.prototype.getName=function(){return n.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return e=this._id,{type:"benchmark.initialize.async",execute:function(t,r){var n=t.dispatch,u=t.getState,l=Object(a.g)(u(),e);return n(Object(i.c)(e,"Benchmark")),r.ScriptManager.initializeContainerForClientApi(e).then((function(){if(l.entityTypeName){var t=Object(s.h)(l.entityTypeName);n(Object(c.b)(t,e,l.entityTypeName)),n(Object(o.a)(!0,e,t))}}))}};var e},e.prototype.getRootReducer=function(){return function(e){return e}},e.prototype.getRootComponent=function(){return g},e.prototype.getCloseAction=function(e){},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},FGem:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.options.clear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:r}}}},FPMG:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="dataset.update.pagingdata";function o(e,t,r){return{type:"dataset.update.pagingdata.async",execute:function(o,s){var c=o.dispatch,u=(o.getState,s.TraceManager.getTracer(a.z)),l=a.x+".updatePagingDataAction";try{return u.info("Updating the paging data for the grid."),c(function(e,t,r){var a=Object(n.y)(t),o=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}(e,t,r)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var p="Updation of paging data for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(p))}}}}},FuJ2:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("sOTk"),a=r("UOiB"),i=r("Sscr"),o=r("krRo"),s=r("HSdq"),c=r("ObKm"),u=r("yHpA"),l=r("9rlF"),p="attribute.requiredLevel";function d(e,t,r,d){return{type:"attribute.requiredLevel.validation",sync:!0,execute:function(h,g){var m,f=h.getState();if(d!==Object(s.pc)(f,e,t,r)){h.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(o.f)(e,t,r,n);var s=Object(i.x)(t);return{type:p,payload:n,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,d));var v=Object(s.ac)(f,e,t),b=Object(u.b)(f,v);if((0===d||3===d)&&b&&b.activeChanges&&b.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow){var y=null,_=null,S=null,C=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)y=t.entityTypeName?t.entityTypeName:null,_=t.recordId?t.recordId:null,S=Object(i.t)(t),C=Object(i.r)(t);else{var O=Object(n.g)(f,e);y=O&&O.entityTypeName?O.entityTypeName:null,_=O&&O.id?O.id:null,S=null,C=t}var I=Object(u.d)(f,v,{etn:y,id:_},r);if(Object(s.Uc)(I)){var P=((m={})[r]={fieldName:r,value:I?I.formatted?I:Object(l.e)(I):I},m);h.dispatch(Object(c.a)(e,P,!0,!0,y,_?_.guid:null,S,C))}}}}}}},G9wF:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return l}));var n,a=r("c/eZ"),i=r("Zy0S"),o=r("ixd0"),s=r("i8/j"),c=r("9r0m"),u=r("1z64"),l=function(){function e(e,t,r,a,i,c,l){void 0===c&&(c=s.n),void 0===l&&(l=o.a),this._formId=r,n=e,this._entityName=a,this._pageId=i,this._getSelectorItems=c,this._selectorItemType=l,this._clientApiExecutor=new u.a(e,"ClientApi.XrmControlFormSelector.",i,t)}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._clientApiExecutor.execute("items_get",(function(t){if(!e._items){e._items=new i.a(t);var r=e._getSelectorItems(n.getState(),e._entityName);if(r)for(var a in r){var o=r[a],s=o.name||o.DisplayName,u=new e._selectorItemType(new c.a(a),s,n,e._pageId);e._items.add(u.getId(),u)}}return e._items}))},enumerable:!1,configurable:!0}),e.prototype.getCurrentItem=function(){var e=this;return this._clientApiExecutor.execute("getCurrentItem",(function(){for(var t=e.items,r=0;r<t.getLength();r++){var n=t.get(r);if(n.getId()===c.a.toString(e._formId))return n}return null}))},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(l)},GueY:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r("c/eZ"),a=r("1z64"),i=r("HSdq"),o=r("ezfI"),s=r("Zy0S"),c=r("+ieV"),u=r("2p2B"),l=r("0MLN"),p=r("9r0m"),d=r("G9wF"),h=r("ar+e"),g=r("PhZR"),m=r("YOvo"),f=r("+Z9T"),v=r("IiPO"),b=r("/W63"),y=r("s0Zj"),_=r("Sscr");var S,C,O,I,P,j,T=r("7EJx"),E=function(){function e(e,t,r,n){var a="ClientApi.XrmNavigationItem.constructor";e||Object(f.j)(a,"store"),r||Object(f.j)(a,"pageId"),t||Object(f.j)(a,"contextToken"),Object(f.a)(n)&&Object(f.j)(a,"id"),S=e,this._pageId=r,this._id=n,this._contextToken=t}return e.prototype.getId=function(){return o.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id},e.prototype.getLabel=function(){var e="ClientApi.XrmNavigationItem.getLabel";try{o.a.instance.reportCall(e);var t=Object(i.Rb)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmNavigationItem.getVisible";try{o.a.instance.reportCall(e);var t=Object(i.Ub)(S.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setFocus=function(){var e,t,r,n="ClientApi.XrmNavigationItem.setFocus";try{o.a.instance.reportCall(n),S.dispatch((e=this._pageId,t=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute:function(n,a,i){var o=n.dispatch,s=n.getState,c=Object(h.d)(s(),e,r);if(c){c.isSelected=!0;var u=Object(_.a)(t,c.relationshipName,c.ordinal);o(Object(y.b)(e,void 0,t)),o(Object(b.a)(e,u,c))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),o.a.instance.reportSuccess(n)}catch(e){var a=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.setLabel=function(e){var t="ClientApi.XrmNavigationItem.setLabel";try{if(o.a.instance.reportCall(t),!Object(f.a)(e)){var r=Object(T.s)(S.getState());S.dispatch(Object(g.b)(this._pageId,this._id,e,r))}o.a.instance.reportSuccess(t)}catch(e){var n=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmNavigationItem.setVisible";try{o.a.instance.reportCall(t),S.dispatch(Object(m.b)(this._pageId,this._id,!0===e)),o.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(t,e,null,r),e}},e}(),F=function(){function e(e,t,r){r||Object(f.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(f.j)("ClientApi.XrmFormNavigation.constructor","store"),C=e,this._pageId=r,this._contextToken=t}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this,t="ClientApi.XrmFormNavigation.items";try{if(o.a.instance.reportCall(t),!this._items){this._items=new s.a(t);var r=Object(h.f)()(C.getState(),{id:this._pageId});r&&r.forEach((function(t){t&&t.relatedItems&&t.relatedItems.forEach((function(t){t&&t.id&&e._items.add(t.id,new E(C,e._contextToken,e._pageId,t.id))}))}))}return o.a.instance.reportSuccess(t),this._items}catch(e){var n=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(t,e,null,n),e}},enumerable:!1,configurable:!0}),e}(),A=r("ll2N"),x=r("oPeH"),w=r("e2rP"),N=r("SdPQ"),k=r("lwSE"),M=r("7ipg"),D=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return O=r,o._clientApiExecutor=new M.b(O,"ClientApi.XrmHeaderSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""},t.prototype.getVisible=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")},t.prototype.setVisible=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")},t.prototype.getControlsDescriptor=function(e){var t=Object(i.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.prototype.setCommandBarVisible=function(e){var t=this;this._clientApiExecutor.execute("setCommandBarVisible",(function(){O.dispatch(Object(w.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getCommandBarVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.commandBarVisible}))},t.prototype.setBodyVisible=function(e){var t=this;this._clientApiExecutor.execute("setBodyVisible",(function(){O.dispatch(Object(N.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getBodyVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.bodyVisible}))},t.prototype.setTabNavigatorVisible=function(e){var t=this;this._clientApiExecutor.execute("setTabNavigatorVisible",(function(){O.dispatch(Object(k.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getTabNavigatorVisible=function(){var e=this;return this._clientApiExecutor.execute("getTabNavigatorVisible",(function(){var t;return null===(t=Object(x.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.tabNavigatorVisible}))},t.NAME="Header",t}(A.a),R=r("cQE4"),L=r("uCYK"),V=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return I=r,o._clientApiExecutor=new M.b(I,"ClientApi.XrmFooterSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""},t.prototype.getVisible=function(){var e=this;return this._clientApiExecutor.execute("getVisible",(function(){var t;return null===(t=Object(R.a)(I.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.visible}))},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")},t.prototype.setVisible=function(e){var t=this;this._clientApiExecutor.execute("setVisible",(function(){I.dispatch(Object(L.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getControlsDescriptor=function(e){var t=Object(i.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.NAME="Footer",t}(A.a),B=r("RYq1"),G=r("sOTk"),X=r("gk6Q"),q=r("m8A1"),U=r("03gN"),z=r("kvLG"),W=function(){function e(e,t,r,n){var a="ClientApi.XrmProcessControlUI.constructor";n||Object(f.j)(a,"entity"),t||Object(f.j)(a,"contextToken"),r||Object(f.j)(a,"pageId"),e||Object(f.j)(a,"store"),P=e,this._pageId=r;var i=!1;if(Object(q.d)(P.getState(),this._pageId,a)){var o=Object(G.g)(P.getState(),this._pageId);this._processManager=Object(X.b)(this._pageId,o),i=!0}this._contextToken=t;var s=Object(q.b)(r,e.getState(),i);z.a.getInstance().eventManager.ReportComponentSuccess(a,s)}return e.prototype.getDisplayState=function(){var e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(o.a.instance.reportCall(e),!Object(q.d)(P.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getDisplayState();return o.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmProcessControlUI.getVisible";try{if(o.a.instance.reportCall(e),!Object(q.d)(P.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),!1;var t=this._getProcessManager().isVisible();return o.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setDisplayState=function(e){var t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(o.a.instance.reportCall(t),!Object(q.d)(P.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);e!==U.a.collapsed&&e!==U.a.expanded&&e!==U.a.floating||this._getProcessManager().setDisplayState(e),o.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmProcessControlUI.setVisible";try{if(o.a.instance.reportCall(t),!Object(q.d)(P.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),o.a.instance.reportSuccess(t)}catch(e){var r=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reflow=function(e,t,r){var n="ClientApi.XrmProcessControlUI.reflow";try{if(o.a.instance.reportCall(n),!Object(q.d)(P.getState(),this._pageId,n))return void o.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),o.a.instance.reportSuccess(n)}catch(e){var a=v.a.getInstance().getEventParameters(this._contextToken);throw v.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(q.c)(this._processManager,P,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager},e}(),H=r("w/nD"),Y=r("UGbr"),Q=r("yHpA"),K=r("cAHA"),J=r("9qYn"),Z=r("yZTI"),$=r("0hCf"),ee=r("zPLw"),te=function(e){function t(t,r,n,i,o,s){var c=this;return j=t,(c=e.call(this,t,r,n,i,o,s,d.a)||this)._clientApiExecutorFormUI=new a.a(t,"ClientApi.XrmFormUI.",n,r),c._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:o,isEventParam:!0}),c}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"headerSection",{get:function(){var e="ClientApi.XrmFormUI.headerSection";try{return o.a.instance.reportCall(e),this._headerSection||(this._headerSection=new D(j,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerSection",{get:function(){var e="ClientApi.XrmFormUI.footerSection";try{return o.a.instance.reportCall(e),this._footerSection||(this._footerSection=new V(j,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.addControls=function(e){var t=v.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};for(var n in t.push(r),e)if(e[n]){r.value=n;var a=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);a&&this.controls.add(a.getName(),a)}},Object.defineProperty(t.prototype,"navigation",{get:function(){var e="ClientApi.XrmFormUI.navigation";try{return o.a.instance.reportCall(e),this._navigation||(this._navigation=new F(j,this.contextToken,this.pageId)),o.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"process",{get:function(){var e="ClientApi.XrmFormUI.process_get";try{o.a.instance.reportCall(e);var t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new W(j,this.contextToken,this.pageId,this.formContext.data.entity));var r=Object(q.a)(this.pageId,j.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return z.a.getInstance().eventManager.ReportComponentSuccess(e,r),o.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}},set:function(e){var t=Object(q.a)(this.pageId,j.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));z.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickForms",{get:function(){var e="ClientApi.XrmFormUI.quickForms";try{return o.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),o.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.clearFormNotification=function(e){var t="ClientApi.XrmFormUI.clearFormNotification";try{o.a.instance.reportCall(t);var r=j.dispatch(Object(u.b)(this.contextToken,this.pageId,e));return o.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}},t.prototype.close=function(){try{o.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(J.a)(Object(Z.b)(j.getState())===this.pageId)||j.dispatch(Object(B.e)(this.pageId)),o.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}},t.prototype.getFormType=function(){var e=this;return this._clientApiExecutorFormUI.execute("getFormType",(function(t,r){var n=e.getFormDescriptor(t,r);if(n){var a=e.formContext;if(a&&a.data&&a.data.entity&&Object(i.Lb)(j.getState(),a.data.entity.getEntityName(),p.a.tryParse(a.data.entity.getId())))return 4;if(Object(i.kb)(j.getState(),{id:e.pageId},e.contextToken))return 3;if(6===n.FormType)return 3;var o=Object(i.ac)(j.getState(),e.pageId,e.contextToken);if(o){var s=Object(Q.b)(j.getState(),o);return s?s.mode===K.a.Create?1:2:(r.push({name:"snapshotID",value:o}),e._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),r),0)}return a&&a.data&&a.data.entity&&!p.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0}))},t.prototype.isDialog=function(){var e=this;return this._clientApiExecutorFormUI.execute("isDialog",(function(){return Object(G.f)(j.getState(),e.pageId)}))},t.prototype.getViewPortHeight=function(){var e="ClientApi.XrmFormUI.getViewPortHeight";try{o.a.instance.reportCall(e);var t=Object(i.qb)(j.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.getViewPortWidth=function(){var e="ClientApi.XrmFormUI.getViewPortWidth";try{o.a.instance.reportCall(e);var t=Object(i.rb)(j.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.setFormEntityName=function(e){var t="ClientApi.XrmFormUI.setFormEntityName";Object(f.g)(e,t,"name");try{o.a.instance.reportCall(t),j.dispatch(Object(l.b)(this.pageId,this.contextToken,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.setFormNotification=function(e,t,r,n,a){var i=this;return this._clientApiExecutorFormUI.execute("setFormNotification",(function(o,s){var u;switch(Object(f.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":u=ee.a;break;case"WARNING":u=ee.e;break;case"INFORMATION":case"INFO":u=ee.b;break;default:Object(f.h)(o,"notificationLevel",t,s)}return!Object(f.a)(e)&&"string"==typeof e&&(j.dispatch(Object(c.c)(i.contextToken,i.pageId,e,u,r,n,a)),!0)}))},t.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormUI.addOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),j.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormUI.removeOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),j.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.refresh=function(){var e=this,t="ClientApi.XrmFormUI.refresh";try{o.a.instance.reportCall(t);var r=Object(G.l)(j.getState(),this.pageId);return j.dispatch(Object(Y.f)(this.pageId,r,!0,1,!0,!0)).then((function(r){return Object(J.b)(e.formContext.data.entity),o.a.instance.reportSuccess(t),r})).catch((function(r){var n=v.a.getInstance().getEventParameters(e.contextToken);return Object(f.d)(j,r,t+".saveFormAndNavigate",n)}))}catch(e){var n=v.a.getInstance().getEventParameters(this.contextToken);return Object(f.d)(j,e,t,n)}},t.prototype._reportFailure=function(e,t){var r=v.a.getInstance().getEventParameters(this.contextToken);return v.a.getInstance().reportFailure(e,t,null,r),t},t}($.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},HfRC:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("xc1f"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,u,l){var p={entityTypeName:e.etn,id:e.id,formId:r,data:i,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:u,recordSetQueryKey:l};return Object(a.a)(n.a,p,t)}},I6xF:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n="powerbi.signedin.state";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Ini7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.removeOption";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},JFej:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.option.add";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.x)(t);return{type:a,payload:{option:i,index:o},meta:{pageId:e,contextKey:s,dataFieldName:r}}}},Jcuz:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r={displayState:e};return{type:n.c,payload:r}}},Je7O:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(){}return e.prototype.get_ErrorType=function(){return this._errorType},e.prototype.set_ErrorType=function(e){this._errorType=e},e.prototype.get_ErrorDescription=function(){return this._errorDescription},e.prototype.set_ErrorDescription=function(e){this._errorDescription=e},e}()},KDdL:function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return v})),r.d(t,"a",(function(){return b}));var n=r("9r0m"),a=r("G7N+"),i=r("dUXI"),o=r("8ADW"),s=r("y5DA"),c=r("lMVv"),u=r("Ww2r"),l=r("JlqV"),p=r("9rlF"),d=r("F2uj"),h=o.a;function g(e,t,r,a,p,d,g,m){return void 0===m&&(m=!1),function(e,t,r){if(!n.a.toString(r.viewId)){var a="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(a),o.d,t),new Error(a)}return!0}(r,a,p)&&function(e,t,r,a,o){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){var l=e(),p=Object(u.b)(l,i.n),d=Object(c.f)(l,a)||a,h=String.format(p,d);return Object(s.a)(l,t,h,r,o),!1}return!0}(e,t,p,d,g)&&function(e,t,r,n){var a=e();if(!Object(l.b)(a)){var o=Object(u.b)(a,i.r);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,p,g)&&function(e,t,r,n){if(r.isRollUpView){var a=e(),o=Object(u.b)(a,i.j);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,p,g)&&(!m||function(e,t,r,n){if(!r.viewXml){var a=Object(u.b)(e(),i.g);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,p,g)&&function(e,t,r,n){if(!r.fetchXml){var a=Object(u.b)(e(),i.o);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,p,g))}function m(e,t,r){var i,o,s=new n.a(e),c=n.a.toString(s),u=new n.a(t),l=n.a.toString(u);return{type:r,payload:{charts:(i={},i[c]=(o={},o[l]={initialized:a.a.Initializing},o),i)}}}function f(e,t){var r;return{type:t,payload:{chartData:(r={},r[e]={initialized:a.a.Initializing},r)}}}function v(e,t,r){var n,a=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(function(e,t){var r;if(!e)return!1;var n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,a=null==e?void 0:e.attributeName,i=Object(d.b)(a,n,t);return"picklist"===i||"state"===i||"status"===i}(i,r)&&e.isOrderPresentOnPrimaryGroupBy()){var o=i.aliasName,s=new y(o);t.sort(s.comparator),a.descending&&t.reverse()}}function b(e){var t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g")),n=[];return r&&r.forEach((function(e){n=e.match(new RegExp(t,"m"))})),n}var y=function(){function e(e){var t=this;this._primaryGroupByAttributeAlias=null,this.comparator=function(e,r){return t._getRawValue(e)-t._getRawValue(r)},this._primaryGroupByAttributeAlias=e}return e.prototype._getRawValue=function(e){if(this._primaryGroupByAttributeAlias in e.fields){var t=e.fields[this._primaryGroupByAttributeAlias],r=Object(p.e)(t);return parseInt(r,10)}return-1},e}()},Kdvm:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("9r0m"),a=function(){function e(){}return e.prototype.generate=function(e,t){return t&&t.getProcessId()?{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:n.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:n.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}:null},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},LBS5:function(e,t,r){"use strict";r.d(t,"b",(function(){return k})),r.d(t,"a",(function(){return N})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return R})),r.d(t,"d",(function(){return L}));var n,a,i=r("TJkj"),o=r("UOiB"),s=r("kvLG"),c=r("mPpC"),u=r("Y+r4"),l=r("c/eZ"),p=r("ZOZo"),d=r("0hCf"),h=r("G9wF"),g=r("T4u8"),m=r("9r0m"),f=r("ixd0"),v=r("JX21"),b=r("1z64"),y=r("5KPK"),_=function(e){function t(t,r,a,i){var o=e.call(this,t,r,a,i)||this;return o._dashboardId=t,n=a,o._clientApiExecutor=new b.a(a,"ClientApi.XrmDashboardSelectorItem.",i),o}return Object(l.__extends)(t,e),t.prototype._getEventParams=function(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:m.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])},Object.defineProperty(t.prototype,"isBoundDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isBoundDashboard_get",(function(){var t=Object(v.a)(n.getState(),e._dashboardId);return!t||1032==+t.Type}),this._getEventParams())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isUserDashboard_get",(function(){var t=Object(v.a)(n.getState(),e._dashboardId);return Object(v.c)(t)}),this._getEventParams())},enumerable:!1,configurable:!0}),t.prototype.navigate=function(){var e=this;this._clientApiExecutor.executeAsync("navigate",(function(){return n.dispatch(Object(y.a)(null,e._dashboardId,null,null,null,null,e.getPageId()))}),this._getEventParams())},t}(f.a),S=function(e){function t(t,r,n,a,i){var o=g.c;if(a){var s=t.getState(),c=Object(g.g)(s,a);c&&c[n.guid]&&(o=g.g)}return e.call(this,t,r,n,a,i,o,_)||this}return Object(l.__extends)(t,e),t}(h.b),C=function(e){function t(t,r,n,a,i,o){return e.call(this,t,r,n,a,i,o,S)||this}return Object(l.__extends)(t,e),t}(d.a),O=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r&&r.etn,i,o,(function(){return C}),n)||this;return a=t,c._getCommands=s,c._apiExecutor=new b.a(t,"ClientApi.XrmDashboard.",o,i),c}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"commands",{get:function(){var e=this;return this._apiExecutor.execute("commands_get",(function(){return e._commands||(e._commands=e._getCommands(a,e.contextToken,e.pageId))}))},enumerable:!1,configurable:!0}),t}(p.a),I=r("7bez"),P=r("Dlr/"),j=r("1PXy"),T=r("h82J"),E=r("HSdq"),F=r("IiPO"),A=r("ks02"),x=r("+Z9T"),w=r("W1TM");function N(e,t,r,n){return M((function(r,a){return new O(r,a,new c.b(r,t),e,t,n)}),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function k(e,t,r,n){return M((function(r,n){return new u.a(r,n,new c.b(r,t),e,t)}),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function M(e,t,r,n,a,o,c,u){return{type:t,sync:!0,execute:function(t,l){Object(x.g)(n,r,"contextToken"),Object(x.g)(a,r,"pageId"),c&&Object(x.g)(o,r,"entityTypeName");try{var p=t.dispatch(Object(T.b)(a,n));if(!p){(p=e(t,{etn:o,id:u})).applicationContext=l;var d=new A.a(t,a);if(p.context=d,!n.parentContextToken){var h=l.ClientApiManager.getClientApiEntry(a);Object(i.b)("form.initialization",(function(){h.xrmInstance.Page=p})),h.primaryContextToken=n}}return p}catch(e){var g=F.a.getInstance().getEventParameters(n);throw g.push({name:"entityTypeName",value:o}),s.a.getInstance().eventManager.ReportComponentFailure(r,e,null,g),e}}}}function D(e,t,r,n,a){var i="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute:function(c,u){Object(x.g)(e,i,"contextToken"),Object(x.g)(t,i,"pageId");try{var l=c.dispatch(Object(T.c)(t,e));if(!l){if(3===n){var p=Object(E.s)(c.getState(),{id:t,controlName:a},e.parentContextToken);if(p){var d=c.dispatch(Object(T.b)(t,e.parentContextToken));return new P.a(c,e.parentContextToken,t,a,r,d,p,u)}(h=F.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Control descriptor could not be found for subgrid control"),null,h)}if(l=new I.a(c,e,t,r,n,!1,u,a),!e.parentContextToken&&e.contextTokenType===o.a.MainGrid)u.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}return l}catch(t){var h;throw(h=F.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,t,null,h),t}}}}function R(e,t,r,n){var a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute:function(i,o){Object(x.g)(e,a,"contextToken"),Object(x.g)(t,a,"pageId"),Object(x.g)(r,a,"controlName"),Object(x.g)(n,a,"controlId");try{var c=i.dispatch(Object(T.b)(t,e.parentContextToken)),u=null;switch(r){case"notescontrol":if(!(u=i.dispatch(Object(T.f)(t,e)))){var l=Object(E.s)(i.getState(),{id:t,controlName:r},e.parentContextToken);u=new j.a(i,e.parentContextToken,t,l,r,n,c,o)}break;default:(p=F.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,p)}return u}catch(t){var p;throw(p=F.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,t,null,p),t}}}}function L(e,t){var r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute:function(n,a){Object(x.g)(e,r,"contextToken"),Object(x.g)(t,r,"pageId");try{var i=n.dispatch(Object(T.g)(t,e));if(!i&&(i=new w.a(n,e,t),!e.parentContextToken)){var o=a.ClientApiManager.getClientApiEntry(t);o.xrmInstance.Page=i,o.primaryContextToken=e}return i}catch(t){var c=F.a.getInstance().getEventParameters(e);throw s.a.getInstance().eventManager.ReportComponentFailure(r,t,null,c),t}}}}},LFYt:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r("mVnn"),a="quickCreateForm.output";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){return{type:"quickCreateForm.output.async",execute:function(r){var i=r.dispatch,o=r.getState,s=Object(n.a)(o(),e)||[];return s.push(t),i(function(e,t){return{type:a,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},LdMy:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(){}return Object.defineProperty(e.prototype,"invocationSource",{get:function(){return this._invocationSource},set:function(e){this._invocationSource=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workflowStep",{get:function(){return this._workflowStep},set:function(e){this._workflowStep=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},set:function(e){this._businessProcessFlowVisitor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEntityName",{get:function(){return this._currentEntityName},set:function(e){this._currentEntityName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processManager",{get:function(){return this._processManager},set:function(e){this._processManager=e},enumerable:!1,configurable:!0}),e.prototype.getStageStep=function(e){if(Object(a.b)(e)||!this._businessProcessFlowVisitor)return null;var t=this._businessProcessFlowVisitor.get_stagesById()[Object(n.a)(e)];return t||null},e}(),o=r("c/eZ"),s=function(e){function t(t){return e.call(this,Object(n.a)(t))||this}return Object(o.__extends)(t,e),t}(function(){function e(e){this.value=e,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.getNext=function(){return this._next},e.prototype.setNext=function(e){this._next=e},e}()),c=function(){function e(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}return e.prototype.find=function(e,t){if(e=Object(n.a)(e),t){for(var r in this._rootNodesValue)if(e===this._rootNodesValue[r])return this._rootNodes[r];return null}for(var r in this._rootNodes){var a=this._rootNodes[r];if(a.value===e)return a;for(;null!=a.getNext();)if((a=a.getNext()).value===e)return a}return null},e.prototype.getNode=function(e){return this._rootNodes[e]},e.prototype.setNode=function(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value},e.prototype.getDefaultPath=function(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray},e.prototype.addAfter=function(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)},e.prototype.getDefaultPathHash=function(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash},e.prototype._ensureLatestDefaultPathIsCalculated=function(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())},e.prototype._recaculateDefaultPath=function(){this._defaultPathArray=[];for(var e=0;e<this._rootNodes.length;e++){var t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){var r=t.getNext();r.value&&(this._defaultPathArray[this._defaultPathArray.length]=r.value),t=r}}return this._defaultPathArray},e.prototype._addAfterInternal=function(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1},e.prototype._generateDefaultPathCalculatedTimeHash=function(){var e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e},e}(),u=function(){function e(){}return e.prototype.pathChanged=function(e){this._handler&&!Object(a.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)},e.prototype.getHandler=function(){return this._handler},e.prototype.setHandler=function(e){this._handler=e},e}(),l=function(){function e(e,t){this._nextStage=t,this._parentStage=e}return Object.defineProperty(e.prototype,"parentStage",{get:function(){return this._parentStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextStage",{get:function(){return this._nextStage},enumerable:!1,configurable:!0}),e}(),p=function(){function e(e,t,r){this._context=e,this._defaultPath=t,this._staticPath=r}return e.prototype.calculate=function(){for(var e=this._startingNodeInDefaultPath(),t=0;t<this._staticPath.length;t++){var r=this._staticPath[t];if(this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(r)){var n=this._defaultPath.find(r,!0);n?e=n:(this._defaultPath.addAfter(e,new s(r)),e=e.getNext())}}this._lastEvaluatedNode=e},e.prototype.getLastEvaluatedNodeInDefaultPath=function(){return this._lastEvaluatedNode},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._startingNodeInDefaultPath=function(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode},e}(),d=function(){function e(e,t){this._defaultPath=t,this._context=e}return e.prototype.calculate=function(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()},e.prototype.getLastDefaultNode=function(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_staticPathToDefaultPathCalculator",{get:function(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new p(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e,t){this._context=e,this._defaultPath=t}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getLastCalculatedDefaultNode=function(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraveresedStages=function(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_traversedDefaultPathCalculator",{get:function(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),g=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._stageStep},set:function(e){this._stageStep=e},enumerable:!1,configurable:!0}),e.prototype.tryExecute=function(){var e=Object(n.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)},e}(),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)},t.prototype._sanitizeGuidForFunctionName=function(e){if(Object(a.b)(e))return e;for(e=Object(n.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e},t}(g),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e=Object(n.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(t){var r=t.findElseBranch(),a=null;if(r&&r.get_Steps().get_Count()>0)a=r.get_Steps().get_item(0).get_stageId();this._invokeReflowFunction(e,a)}},t.prototype._invokeReflowFunction=function(e,t){this.context.processManager.reflow(!1,e,t)},t}(g),v=function(){function e(){}return e.prototype.getStageCommand=function(e,t){var r=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(n.a)(t.get_stageId())];return e.currentEntityName!==r.get_EntityLogicalName()?new f(e):new m(e)},e}(),b=function(){function e(e,t,r){this._defaultPath=t,this._cascadeUpdate=r,this._context=e,this._businessRuleCommandFactory=new v}return e.prototype.handleChange=function(e,t){var r=this._defaultPath.find(e,!1);if(null!=r){var n=Object(a.b)(t)?null:t,i=new s(n);this._defaultPath.addAfter(r,i),n&&this.triggerSubsequentDefaultPathCalculation(i)}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(e){var t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){var r=this._context.getStageStep(t).get_nextStageId();if(!r)return;var n=this._defaultPath.find(r,!0);if(n)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(n));this._defaultPath.addAfter(e,new s(r)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}},e.prototype._tryExecuteConditionForStage=function(e){var t=this._context.invocationSource;try{this._context.invocationSource="internal";var r=this._context.getStageStep(e.value),n=this._businessRuleCommandFactory.getStageCommand(this._context,r);if(n.stage=r,!n.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1},e}(),y=function(){function e(e,t,r){this._context=e,this._listener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startNode},set:function(e){this._startNode=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new b(this._context,this._defaultPath,!0)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t,r){this._context=e,this._listener=t,this._initialDefaultPath=r}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startingNodeInDefaultPath},set:function(e){this._startingNodeInDefaultPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraversedStages=function(){this._defaultPath=this._initialDefaultPath},e.prototype._calculateForNonTraversedStages=function(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_nonTraversedDefaultPathCalculator",{get:function(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r){this._context=e,this._changeListener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._changeListener.setHandler(e)},e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new b(this._context,this._defaultPath,!1)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),C=r("9r0m"),O=function(){function e(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new u,this._initializeDefaultPathFromRootStages()}return e.prototype.initializeComplete=function(){var e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();var t=this._context.processManager.getSelectedStageId(),r=this._context.processManager.getActivePath(),n=!Object(a.a)(t)&&!Object(a.a)(r),i=n&&r.findIndex((function(e){return e.guid.toString()===t}))<0,o=n&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())},e.prototype.updateDefaultPath=function(e,t){if(e){var r=null;if("internal"!==this._context.invocationSource&&(r=this.defaultPathHash()),this._changeListener.pathChanged(new l(e,t)),"internal"!==this._context.invocationSource)if(r!==this.defaultPathHash()){var n=this.getDefaultPath();this._context.processManager.setActivePath(n)}}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(!!C.a.tryParseOrNull(e)&&!!this.getDefaultPath().find((function(t){return t.toLowerCase()===e.toLowerCase()}))){var t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource)if(t!==this.defaultPathHash()){var r=this.getDefaultPath();this._context.processManager.setActivePath(r)}}},e.prototype.getDefaultPath=function(){return this._defaultPath.getDefaultPath()},e.prototype.defaultPathHash=function(){return this._defaultPath.getDefaultPathHash()},e.prototype.getNextStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return-1!==r&&r<t.length-1?t[r+1]:null},e.prototype.getPreviousStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return r<=0?null:t[r-1]},e.prototype._initializeDefaultPathFromRootStages=function(){this._defaultPath=new c;var e=this._context.businessProcessFlowVisitor.get_firstLevelStages(),t=0;for(var r in e)this._defaultPath.setNode(t,new s(r)),t++},e.prototype._initializeTraversedPath=function(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()},e.prototype._initializeNonTraversedPath=function(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()},Object.defineProperty(e.prototype,"_loadTimeDefaultPathCalculator",{get:function(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_afterLoadPathCalculator",{get:function(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_runTimePathCalculator",{get:function(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new S(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator},enumerable:!1,configurable:!0}),e}(),I=r("HSdq"),P=function(){function e(){}return e.prototype.setPrimaryModel=function(e){this._primaryModelName=e},e.prototype.getDefaultPathManager=function(){return this._defaultPathManager},e.prototype.setObjectModel=function(e){var t=this,r=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach((function(e){if(t._isRelationshipStep(e)){var a=t._createRelationshipCollectionStep(r,e);a&&r.appendStep(a)}else{var i=t._createEntity(r,e);i&&(r.appendStep(i),n.hasOwnProperty(i.get_EntityLogicalName())||(n[i.get_EntityLogicalName()]=!0))}})),r.set_Name(e.businessProcessFlowName),r.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=r,this._initializeVisitor()},e.prototype.initializeDefaultPathManager=function(e,t){var r=new i;r.processManager=t,r.businessProcessFlowVisitor=this._businessProcessFlowVisitor,r.workflowStep=this._processObjectModel,r.currentEntityName=this._primaryModelName,this._defaultPathManager=new O(e,r),this._defaultPathManager.initializeComplete()},Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},enumerable:!1,configurable:!0}),e.prototype.getEntityStages=function(){if(!this._processObjectModel)return null;var e=this._processObjectModel.get_Steps(),t=[];if(e){for(var r=0;r<e.get_Count();r++){var n=e.get_item(r);n&&n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(r))}return t}return null},e.prototype.getRequiredFlowStepsForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);this._isFlowStep(c)&&c.get_isProcessRequired()&&a.push(c.get_Id())}return a},e.prototype.getRequiredAttributesForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);if(!this._isActionStep(c)&&!this._isFlowStep(c))if(c.get_isProcessRequired())a.push(c.get_Description());else{var u=this._getDataFieldNameFromStepStep(c);u&&this._isRequiredAttribute(u,t,r,n)&&a.push(c.get_Description())}}return a},e.prototype._getDataFieldNameFromStepStep=function(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){var t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null},e.prototype._isRequiredAttribute=function(e,t,r,n){return null!=e&&2===Object(I.pc)(n,t,r,e)},e.prototype._isFlowStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0;return!1},e.prototype._isActionStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0;return!1},e.prototype._isControlStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0;return!1},e.prototype._initializeVisitor=function(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)},e.prototype._isRelationshipStep=function(e){return!(!e||!e.hasOwnProperty("relationships"))},e.prototype._createEntity=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);r.set_Name(t.entityLogicalName),r.set_Description(t.entityDisplayName),r.set_relationshipName(t.relationshipName),r.set_attributeName(t.referencingAttributeName),r.set_parent(e);var n=this._createStage(e,t.stage);r&&n&&r.appendStep(n);for(var a=0;a<t.stage.steps.length;a++){var i=this._createStep(e,t.stage.steps[a]);i&&n.appendStep(i)}var o=this._createConditionStep(e,n,t.stage);return o&&n.appendStep(o),r},e.prototype._createRelationshipCollectionStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(r.set_workflow(e),t.relationships)for(var n=0;n<t.relationships.length;n++){var a=this._createRelationshipStep(e,t.relationships[n]);r.appendStep(a)}return r},e.prototype._createRelationshipStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return r.set_workflow(e),r.set_sourceStageId(t.sourceStageId.guid),r.set_targetStageId(t.targetStageId.guid),r.set_attributeName(t.attributeName),r.set_relationshipName(t.relationshipName),r},e.prototype._createStage=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return r.set_Id(t.stageId.guid),r.set_stageId(t.stageId.guid),r.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),r.set_stageCategory(t.stageCategory),r},e.prototype._createStep=function(e,t){var r="action"===t.stepType.toLowerCase()?t.label:t.name,n=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,r||"dummy");n.set_isProcessRequired(t.required),n.set_Name(t.label),n.set_Id(t.stepId?t.stepId.guid:""),n.set_workflow(e);var a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(a.set_dataFieldName(r),"action"===t.stepType.toLowerCase()){var i=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);i.set_Name(r),i.set_actionControl(a),n.appendStep(i)}else if("modernflow"===t.stepType.toLowerCase()){var o=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);o.set_Name(r),o.set_flowControl(a),n.appendStep(o)}else n.appendStep(a);return n},e.prototype._createConditionStep=function(e,t,r){if(!r.conditionJson)return null;var n=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return n.set_parent(t),n.initializeFromDynamic(JSON.parse(r.conditionJson)),n.fixLinks(),n},e.prototype.getProcessObjectModel=function(){return this._processObjectModel},e.prototype.getStage=function(e){return Object(a.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null},e.prototype.getPreviousStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e.prototype.getNextStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e}()},LhJP:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return a})),r.d(t,"o",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"j",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return l})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return f})),r.d(t,"e",(function(){return v})),r.d(t,"q",(function(){return b})),r.d(t,"p",(function(){return y})),r.d(t,"m",(function(){return p})),r.d(t,"n",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",u="BusinessProcessFlow.InitilaizeWithFormEntityOnly",l="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",p="BusinessProcessFlow.SetActiveProcess",d="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",f="BusinessProcessFlow.RenderProcessControl",v="BusinessProcessFlow.HideProcessControlForUciOffline",b="SaveFailureReason",y="faultedSnapshotId"},NJzV:function(e,t,r){"use strict";r.d(t,"b",(function(){return lr})),r.d(t,"a",(function(){return pr})),r.d(t,"d",(function(){return hr})),r.d(t,"c",(function(){return ur}));var n=r("c/eZ"),a=r("4E+q"),i=r("kyRo"),o=r("nuS9"),s=r("93Ls"),c=r("kGA3"),u=r("VnpK"),l=r("S2mk"),p=r("DRVD"),d=r.n(p),h=r("CCTC"),g=r("9r0m"),m=r("WS0f"),f=r("sOTk"),v=r("Nw1z"),b=r("HSdq"),y=r("riBC"),_=r("2OIc"),S=r("T2Xs"),C=r("Sscr"),O=r("UOiB"),I=r("QAhb"),P=r("yHpA"),j=r("JX21"),T=r("T4u8"),E=r("cZkS"),F=r("qC0c"),A="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function x(){var e=null,t=null,r=null;return function(n,a){S.a.info(a.controlId+"."+A+": createGetContextTokenSelector started");var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r,n=t.parentContextToken,a=t.contextString,i=t.configuration,o=Object(_.e)(e,t.configuration.CustomControlId);if(Object(F.c)(e,E.J)&&Object(u.s)(o)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===O.a.UnboundForm&&r.formId)return!(!Object(j.a)(t,r.formId)&&!Object(T.a)(t,r.formId));return e(t,r.parentContextToken)}(e,n))return r=C.p(n.parentContextToken,t.controlId);if("default"===a&&Object(u.s)(o)&&!Object(u.r)(t.configuration.Parameters)||Object(u.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return r=C.e(n,t.controlId);if(!t.formInfo&&i&&i.Parameters&&i.Parameters.value&&"TimelineWall"===i.Parameters.value.Type)return r=C.p(n,t.controlId);if(!t.formInfo&&Object(u.t)(t.configuration)){var s=function(e,t){var r=Object(f.g)(e,t.id),n=new I.a(r.entityTypeName,r.id||g.a.EMPTY),a=Object(b.ac)(e,t.id,t.parentContextToken),i=Object(P.d)(e,a,n,t.descriptor.DataFieldName),o=i?i.reference:null;return o?o.etn:Object(u.m)(t.descriptor)}(e,t);return r=C.l(n,t.controlId,s)}r=n;var c=t.descriptor&&t.descriptor.Relationship;c&&(r=C.m(r,c));return r}(n,a);return(r!==o||w(e,s)||w(t,i))&&(e=s,t=i,r=o),S.a.info(a.controlId+"."+A+": createGetContextTokenSelector finished"),e}}function w(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var N=r("ZEX9"),k=r("Gemh"),M=r("OTOS"),D=r("WH9N"),R=r("L8Ie"),L=r("0hZT");function V(){var e={},t=!1;return function(r,n,a,i,o,s){S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");var c=Object(f.a)(r,n),u=c&&c.id,l=e&&u&&u.guid&&(!e.recordGuid||e.recordGuid&&u.guid!==e.recordGuid.guid);if(!t||l){var p=Object(M.b)(r,n.id),d=g.a.equals(g.a.tryParse(a.UniqueId),g.a.EMPTY)?n.controlId:a.UniqueId;e=p&&s===D.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,p,d):p&&s===R.a?function(e,t,r,n){var a=Object(f.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"dialog",entityTypeName:i,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,p,d):p?function(e,t,r,n){var a=Object(f.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"form",entityTypeName:i,recordGuid:a.id,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,p,d):s===L.a?function(e,t,r,n){var a=Object(k.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:a?a.split(",")[1]:void 0}}(r,n,i.entityTypeName,o):{areaType:null,entityTypeName:null,controlUniqueId:d,viewId:void 0},t=!0}return S.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var B=r("pmTS"),G=r("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function X(e,t,r,n,a){var i=Object(G.a)(e,t),o=a?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",s=Object(C.v)(n);return i&&i[o]&&i[o][s]&&i[o][s][r]?i[o][s][r]:null}var q=r("pdGj"),U=r("vO+w"),z=r("xc1f"),W=d.a.createEvent("CustomControlHostSelectors.mapStateToProps",h.c),H=r("CSbt"),Y=r("hXUt"),Q=r("5Fed"),K=r("PQ2H"),J=r("Oqm9"),Z=r("lMVv"),$=r("Eoze"),ee=r("vYfn"),te=r("i8/j"),re=r("9KTg");function ne(e,t){return{type:re.a,payload:e,meta:{pageId:t}}}function ae(e){return{type:"execute.cleanreferencepanelstate.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e){return{type:re.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve()}}}function ie(e){return{type:"execute.closeallsessiontabs.async",execute:function(t,r){var n=t.dispatch,a=(0,t.getState)();return n(function(e,t){return{type:re.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(J.b)(a,e)},e)),Promise.resolve()}}}function oe(e,t){return{type:"execute.closesessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=Object(J.a)(i,e,t);return o.splice(e,1),a(function(e,t){return{type:re.d,payload:e,meta:{pageId:t}}}({sessionTabs:o,activeTabId:s},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e,t){return{type:re.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve()}}}function ce(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute:function(r,n){var a=r.dispatch,i=r.getState,o=Object(J.c)(i(),t);if(e&&!(o.activeTabId&&o.controlNames.length>0))return a(function(e,t){return{type:re.f,payload:e,meta:{pageId:t}}}({controlNames:e.map((function(e){return e.Name})),activeTabId:e[0].Id},t)),Promise.resolve()}}}var ue=r("sm1J");function le(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){for(var a=r.dispatch,i=r.getState,o=Object(J.d)(i(),t),s=[],c=0;c<o.length;c++)o[c].id===e.id?s.push(e):s.push(o[c]);return a(function(e,t){return{type:re.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var pe=r("kvLG"),de=r("w/nD");var he=r("oj0s"),ge=r("qIF7"),me=r("I6xF"),fe=r("ObKm"),ve=r("g9bv"),be=r("jJRu"),ye=r("GHPx"),_e=r("cAHA");var Se=r("h82J"),Ce=r("pdOk"),Oe=r("RXRQ"),Ie=r("gBKR"),Pe=r("EcZf"),je=r("bCrZ"),Te=r("olrR"),Ee=r("OROb"),Fe=r("HEkv"),Ae=r("HfRC"),xe=r("evh6"),we=r("ya7l"),Ne=r("12n8"),ke=r("4fxQ"),Me=r("wYyS");var De=r("otMa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Re=function(){function e(e,t){this.Target=e,this.FieldName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Le=r("qYad"),Ve=r("UR8A"),Be=r("j6Db");var Ge=r("EGsq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Xe=r("969l"),qe=r("mGpW"),Ue=r("Ww2r");var ze=r("XjtF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function We(e,t){return{type:"customcontrol.loadresources.async",execute:function(r,n){r.dispatch;var a=r.getState;return function(e,t,r,n){var a=Object(Ge.t)(t);return r.initializeContainerForClientApi(n).then((function(t){return t.loadWebResources([Object(Ge.a)(a,e)]).then((function(){return{container:t,webResourcePath:a}}))}))}(e,a(),n.ScriptManager,t)}}}var He=r("EwXg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ye=r("n1Ju"),Qe=r("zsi3"),Ke=r("c7nC"),Je=r("F2uj");var Ze=r("8Fmj"),$e=r("w82B"),et=r("y5DA"),tt=r("RwQN"),rt=r("T0dC"),nt=r("/SAa"),at=r("o5EQ"),it=r("8VL5"),ot=r("cqI9"),st=r("Zdrd"),ct=r("Yc9S"),ut=r("0rak"),lt=r("G7N+"),pt=r("/j9Z"),dt=r("sgPk"),ht=r("TCcM"),gt=function(){function e(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}},e}(),mt=r("Ia1G"),ft=r("CO6B"),vt=r("2IT6"),bt=r("ak18");function yt(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.rollup.async",execute:function(n,a){var i=n.dispatch,o=n.getState,s=o(),c=e.key,u=dt.a.fromState(e,o),l=Object(ht.u)(s,c,u.pageNumber-1);return l&&(u.pagingCookie=l),r.push({name:bt.a,value:Object(bt.e)(e)}),r.push({name:"isRefresh",value:t}),i(function(e,t,r){var n;void 0===r&&(r=!1);var a={lists:(n={},n[e]={initialized:r?lt.a.Refreshing:lt.a.Initializing,pageSize:t},n)};return{type:"gridData.retrieve.rollup",payload:a}}(c,u.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then((function(n){return t(Object(mt.b)(new gt(I.a.toExternalEntityReference(r.target),n,r.rollupType))).then((function(n){return Object(vt.g)(n).then((function(n){return function(e,t,r,n){var a=r.getKeyQuery(),i=Object(ft.e)(a),o=Object(Ie.e)(i.entity2AttributesMap);return t(o).then((function(){var t=e();return Object(ft.a)(t,a,i,n)}))}(e,t,r,n)}))}))}))}(o,i,u).then((function(e){s=o(),i(Object(Pe.e)(s,i,c,u,e))})).catch((function(e){Object(pt.b)(e)}))},getFailureParameters:function(e,t){return r},getSuccessParameters:function(e,t,n){return r}}}var _t=r("AVer"),St=r("Z46F"),Ct=r("slAZ");function Ot(e,t,r,n,a){var i="",o="";if(n&&n.message&&(i=n.message),n&&n.errorCode){var s=a||Be.a,c=function(e){return r.EventManager.ReportComponentFailure(s,e,null,[{name:"hexErrorCode",value:o},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:a},{name:"APIName",value:Be.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(o+" "+i)};try{var u="Error_Title_"+(o="0x"+St.a.getHexErrorCodeFromInt(n.errorCode)),l="Error_Message_"+o,p="Localized resource strings not found for neither "+u+" nor "+l+".  Please add error resources for error code "+o,d=e(Object(qe.e)([u])).catch((function(){})),h=e(Object(qe.e)([l])).catch((function(){}));return Promise.all([d,h]).then((function(){var e=Object(Ue.e)(t(),[u,l]),r=Object(Ue.c)(e,u),n=Object(Ue.c)(e,l),a="";return(a=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(o)?r+(r&&n?": ":"")+n:r||n)?Promise.resolve(o+" "+a):c(p)}))}catch(e){return c(e)}}return Promise.resolve(o+" "+i)}function It(e,t){if(e instanceof nt.a)(r=e.getLatestData()).loading=!0,e.setRefreshingStart();else if(e instanceof at.a||e instanceof rt.a){var r;(r=e.getLatestData())&&(r.working=!0,at.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute:function(r,n){var a=r.dispatch,i=r.getState;if(e instanceof tt.a){var o={retrieveGridDataAction:function(e){return a(Object(Pe.d)(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(de.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(de.X)(t,e,r,n))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},retreiveChartAction:function(e,t,r){return a(Object(Ze.a)(e,t,r))},retreiveChartDataAction:function(e,t,r,n){return void 0===n&&(n=!0),a(Object($e.a)(e,t,r,n))},updateDataSetChartVisualizationId:function(e,t,r){return a(Object(ot.b)(e,t,r))},updateDataSetChartVisualizationType:function(e,t,r){return a(Object(st.b)(e,t,r))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e,t){return Ot(a,i,n,e,t)},updateChartFilterExpression:function(e,t,r){return a(Object(ct.c)(e,t,r))},updateChartDrillDownParameters:function(e,t,r){return a(Object(ut.c)(e,t,r))},updateChartErrorInformation:function(e,t,r,n){Object(et.a)(e,a,t,r,n)}};return e.refreshDataSet(i,o,n)}var s={retrieveGridDataAction:function(e){return Object(m.a)(e.rollupType)?a(Object(Pe.d)(e)):a(yt(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(de.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(de.X)(t,e,r,n))},startCustomFilter:function(e,t,r){return a(Object(Ct.f)(e,t,r))},endCustomFilter:function(e,t,r){return a(Object(Ct.e)(e,t,r))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e){return Ot(a,i,n,e)},getAdditionalResourceStrings:function(e){return a(Object(qe.e)(e))},addCustomViewAction:function(e,t,r,n,i,o,s,c){return a(Object(_t.a)(e,t,r,n,i,o,s,c))},setOfflineQueryAction:function(e){return a(Object(_t.b)(e))}};return e.refreshDataSet(i,s,n)}}}var Pt=r("IQF2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var jt=r("bH46"),Tt=r("VZmd");var Et=r("yrP7"),Ft=r("vqdi"),At=r("LBS5"),xt=r("XJ3n");var wt=r("zvr0"),Nt=r("nIt0"),kt=r("455M");var Mt=r("uO/V"),Dt=r("oY7N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e,t,r){if(r.dataSetUIOptions){var n=e+t.id,a=t.contextString;switch(t.contextString){case Mt.h.ASSOCIATEDGRID:case Mt.h.SUBGRID:case Mt.h.GRID:break;case Mt.h.CUSTOM:default:a=Mt.h.CUSTOM}return o.createElement(Dt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:a,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return o.createElement(ur,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Lt=r("RB3d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vt(e){if(e){if(e instanceof I.a)return e;var t,r=e.entityName||e.LogicalName;return t=g.a.fromLegacyGuid(e.Id),g.a.isNullOrEmpty(t)&&(t=new g.a(e.id||e.Id)),new I.a(r,t,Object(m.a)(e.name)?e.Name:e.name)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(jt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var Gt=r("q6M9"),Xt=r("IUjT"),qt=r("eYbs"),Ut=r("RlP9"),zt=function(){function e(){}return e.prototype.convert=function(e,t,r){var n=(new DOMParser).parseFromString(e,"text/xml"),a=this._firstElementChild(n),i=this._childElements(a);if(!i)return null;for(var o=[],s=0,c=i;s<c.length;s++){for(var u=c[s],l=[],p=0,d=this._childElements(u);p<d.length;p++){var h=d[p];l.push(this._getGridCellDescriptor(h))}o.push(this._getGridRowDescriptor(u,l))}var g=this._getGridDescriptor(a,o,r);return this._populateRelationshipInformation(g,t),g},e.prototype._attributeValueBoolean=function(e,t){return"1"===this._attributeValueString(e,t,"")},e.prototype._attributeValueString=function(e,t,r){var n=e.attributes.getNamedItem(t);return n&&n.value||r},e.prototype._attributeValueInt=function(e,t,r){var n=this._attributeValueString(e,t,r+"");return parseInt(n,10)},e.prototype._childElements=function(e){return e?e.children?Array.from(e.children):e.childNodes?Array.from(e.childNodes).filter((function(e){return e.nodeType===Node.ELEMENT_NODE})).map((function(e){return e})):null:null},e.prototype._getGridCellDescriptor=function(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}},e.prototype._getGridRowDescriptor=function(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}},e.prototype._getGridDescriptor=function(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}},e.prototype._firstElementChild=function(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;var t=this._childElements(e);return t&&t[0]},e.prototype._populateRelationshipInformation=function(e,t){var r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),a=this._firstElementChild(n),i=this._childElements(a);if(i)for(var o=0,s=i;o<s.length;o++){var c=s[o];"link-entity"===c.nodeName&&this._attributeValueString(c,"alias","")&&this._attributeValueString(c,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(c,"alias",""),this._attributeValueString(c,"name",""))}},e.prototype._setRelatedEntityName=function(e,t,r){for(var n=0;n<e.rows.length;n++)for(var a=0;a<e.rows[n].cells.length;a++){var i=e.rows[n].cells[a].name;(i?i.substring(0,i.indexOf(".")):void 0)===t&&(e.rows[n].cells[a].relatedEntityName=r)}},e}(),Wt=r("bIXa"),Ht=r("r0s4");function Yt(e,t,r,n,a,i,o,s){return void 0===t&&(t=!1),{type:"populateAndSend.LookupData.Action",sync:!0,execute:function(c,u){var l=c.dispatch,p=(0,c.getState)(),d=a||e.LookupEntityByName[0].EntityLogicalName,h=Object(Xt.f)(p,d,o,n),m=[];if(s){var v=s.split("."),y=Object(f.g)(p,n),_=void 0,S=Object(b.ac)(p,n,r),C=Object(P.b)(p,S);_=C&&C.activeChanges&&C.activeChanges[v[1]]?C.activeChanges[v[1]]:Object(ht.j)(p,new I.a(v[0],y.id),v[1]),e.RelatedRecordId=_&&_.reference&&_.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length)for(var O=Object(b.eb)(p,n,r),j=O&&O[i],T=0,E=e.LookupEntityByName;T<E.length;T++){var F=E[T],A=Object(Wt.b)(p,n,r,i,F.EntityLogicalName);if(A&&(F.CustomFilter=Object(Ht.CrmHtmlDecode)(A).replace(/"/g,"'")),h){var x=Object(qt.a)(p,h,F.EntityLogicalName);x&&x.view&&(g.a.equals(x.view.viewId,F.ViewId)||Object(Ut.c)(p,F.ViewId))||m.push(l(Object(Te.a)(F.EntityLogicalName,null,null,F.ViewId)))}var w=j&&j.parameters&&j.parameters.defaultviewid;if(j&&j.views&&j.views[w]&&j.views[w].entityLogicalName===F.EntityLogicalName){F.ViewId=null,F.FetchXml=j.views[w].fetchXML.replace(/"/g,"'");var N=Object(Z.h)(p,F.EntityLogicalName),k=new zt;F.LayoutJson=JSON.stringify(k.convert(j.views[w].layoutXML,j.views[w].fetchXML,N.ObjectTypeCode)).replace(/"/g,"'")}}var M=Object(Gt.b)(p,d,e),D=Object(ht.o)(p,M);t=t||D===lt.a.Initialized,m.push(l(Object(Gt.d)(e,t)));var R=function(e,t,r,n,a){var i,o,s={},c=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName,u=a||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!c&&!u)return null;c||(c="placeholderEtn");if(r.LookupEntityByName)for(var l=0,p=r.LookupEntityByName;l<p.length;l++){var d=p[l];s[d.EntityLogicalName]=Object(Gt.b)(e,d.EntityLogicalName,r)}var h=Object(Gt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:(i={},i[c]=(o={},o[u]={metadataKey:h,dataKeys:s},o),i),meta:{pageId:t}}}(p,n,e,a,o);return R&&l(R),Promise.all(m)}}}var Qt=r("kRDR"),Kt=r("CcDq");var Jt,Zt,$t,er,tr=r("feNe"),rr=r("aBa1");function nr(e,t){return{openEditForm:function(r,n,a,i,o){var s=Vt(r);e(n?Object(Ae.a)(s,t.id,void 0,void 0,n,a,i,o):Object(Ae.a)(s,t.id))},openGridPage:function(r,n,a,i,o,s,c,u){e(Object(xe.a)(r,t.id,g.a.tryParseOrNull(n),a,i,g.a.tryParseOrNull(o),s,null,u,c))},openCreateForm:function(r,n,a){e(Object(ee.b)(new I.a(r),null,"QuickCreate")).then((function(i){e(Object(ge.b)(r,t.id,null,n,Vt(a)))})).catch((function(a){e(Object(Ae.a)(new I.a(r),t.id,void 0,n))}))},openSearch:function(r){e(Object(Ne.a)(r,null,t.id))},openPowerBIFullScreenPage:function(r,n,a,i,o,s,c){e(Object(we.a)(t.id,r,n,a,i,o,s,c))},openDashboard:function(e){},openUrl:function(e,t){},openUrlWithProtocol:function(e,t){},openPhoneNumber:function(r,n,a,i,o,s,c,u,l,p,d){return void 0===p&&(p=!1),void 0===d&&(d=!0),e(function(e,t,r,n,a,i,o,s,c,u,l,p){return void 0===l&&(l=!1),void 0===p&&(p=!0),{type:"customcontrol.openphonecall",execute:function(d,h){var m=e.trim(),f=Object(Ge.x)(d.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(f&&(m=f+m),m="tel:"+m):f&&(m=m.slice(0,4)+f+m.slice(4));var v,b=new Kt.a(h,d);h.ScriptManager.containerExists(Qt.d)&&(v=h.GlobalCustomEventManager);var y=function(){if(l){var c=null,u={};if(t){c=new I.a(r,new g.a(t));var p={id:t,entityType:r,name:n},h=p;i&&(h={id:i,entityType:o,name:s}),u.contactinfo=e,u.to=[p],u.regardingobjectid=h}return d.dispatch(Object(ge.b)("phonecall",a,null,u,c,null,{entityName:"phonecall",showDialog:!0}))}};return b.canOpenUri(m).then((function(e){if(p&&v&&d.dispatch(v.runOnOpenUrl(a,m,u,c)))return null;var t=Object(F.c)(d.getState(),E.C);e?(b.openUri(m),t&&y()):l&&t&&y()}),(function(){return null}))},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,a,n,i,t.id,s,o,c,u,l,p,d))},openMaps:function(e){},openMap:function(e){}}}var ar=r("6Tlt"),ir=r("lU69"),or=r("Wg6j"),sr=r("uGUB"),cr=Object(a.a)((function(){var e,t={},r=null,a={},i={},o={},s=!1,c="",p=null,d={},h=!1,C="",O=!1,I={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},P=-1,j=-1,T=Object(N.a)(),E=Object(B.a)(),F=V(),A=x();return function(x,w){S.a.info(w.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");var N,k,M,D,R,L=W.startStopwatch({controlId:w.controlId,parentId:Object(u.p)(w),level:(0).toString()}),V=[],B=!1,G=null,H=null,Y=null,Q=null,K=null,J=null,Z=null,$=null,ee=null,te=null,re=!1,ne=null,ae=null,ie=null,oe=!1;try{var se=null;w.formInfo?(p&&d.EntityName===w.formInfo.EntityName&&d.RecordId===w.formInfo.RecordId&&d.FormId===w.formInfo.FormId||(p={id:w.formInfo.RecordId?new g.a(w.formInfo.RecordId):null,formId:w.formInfo.FormId?new g.a(w.formInfo.FormId):null,entityTypeName:w.formInfo.EntityName},d=w.formInfo),se=p):se=Object(f.g)(x,w.id),H=w.descriptor,Y=w.configuration,M=Object(v.b)(x),N=Object(f.l)(x,w.id),Object(f.f)(x,w.id)&&(R="DialogContainer__"+w.id),!R&&w.parentDefinedControlProps&&w.parentDefinedControlProps.parentFlyoutId&&(R=w.parentDefinedControlProps.parentFlyoutId),N&&(k=A(x,w));var ce=Object(b.kb)(x,w,k),ue=Y;if(null!==w.systemDefinedProperties){var le=Object(n.__assign)(Object(n.__assign)({},Y.Parameters),w.systemDefinedProperties);ue=Object(n.__assign)(Object(n.__assign)({},Y),{Parameters:le})}if(!(Q=Object(_.e)(x,Y.CustomControlId)||Object(_.e)(x,Y.Name))||!Q.ConstructorName){Q=null;var pe=Object(l.h)(Y.CustomControlId);pe!==Y.CustomControlId&&(Q=Object(_.e)(x,pe))}Q&&(Z=($=E(x,Q,se,ce,w.contextHelper)).response,te=(K=(J=T(ue,H,w,x,se,k)).response)&&K.dataReady?F(x,w,H,se,k,N):null,ee=Object(y.a)(x,te,Q.CustomControlId,w.id));var de=X(x,w.id,w.controlId,k);de&&(re=de.every((function(e){return Object(q.b)(x,e)}))),D=X(x,w.id,w.controlId,k,!0),ae=w.parentDefinedControlProps&&!Object(m.a)(w.parentDefinedControlProps.height)?w.parentDefinedControlProps.height:-1,ne=w.parentDefinedControlProps&&!Object(m.a)(w.parentDefinedControlProps.width)?w.parentDefinedControlProps.width:-1,ie=Object(U.b)(x)?Object(U.a)(x):null,oe=function(e,t,r,n){return Object(f.l)(e,t)===z.a&&!Object(b.Fb)(e,t,r,n)}(x,w.id,k,w.descriptor.Name)}catch(e){var he=Q.ConstructorName;S.a.error(he+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:w.controlId},{name:"customControlId",value:Q.CustomControlId},{name:"manifest",value:JSON.stringify(Q)},{name:"descriptor",value:JSON.stringify(H)},{name:"configuration",value:JSON.stringify(Y)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),B=!0,G=e.toString()+". Stack: "+e.Stack}return r&&(V=V.concat(function(e,t){var r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r}(H,r))),r=w.descriptor,K!==a||Q!==t||Z!==i||te!==o||B!==s||N!==c||re!==h||D!==e||ae!==j||ne!==P||R!==C||ie!==I.designLanguage||oe!==O?(ae===j&&ne===P||V.push("layout"),J&&(V=V.concat(J.updatedProperties)),$&&(V=V.concat($.updatedProperties)),ie!==I.designLanguage&&V.push("design"),I={stateToPropsMappingError:B,stateToPropsMappingErrorMessage:G,dynamicData:K,manifest:Q,personalizationState:ee,propBagData:Z,children:Y&&Y.Children,personalizationConfiguration:te,pageType:N,popupStack:M,contextToken:k,updatedProperties:V,globalCommandManagerInitialized:re,internalCommandManagerIds:D,portalFlyoutToDialogId:R,designLanguage:ie,inactive:oe},h=re,e=D,C=R,s=B,i=Z,t=Q,a=K,o=te,c=N,j=ae,P=ne,O=oe):I.updatedProperties=V,L({updatedProperties:JSON.stringify(V)}),S.a.info(w.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),I}}),(function(){var e;return function(t,r){if(e)return e;var n=nr(t,r);return Jt={setNotification:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"customcontrol.propertybag.mode.setnotification",execute:function(s,c){var u=s.dispatch,l=s.getState,p={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Qe.a.error,actions:[{actions:[function(){}],message:""}]};u(Object(Ye.b)(r,n,p,a));var d=l(),h=new I.a(i,g.a.fromExternalGuid(o)),m=Object(Je.a)(d,h.etn,n);return h&&m&&(2===m.RequiredLevel||1===m.RequiredLevel)&&u(Object(Ke.b)(r,n,!1,a)),!0},sync:!0}}(e,r,n,a,i,o,s))},clearNotification:function(e,r,n,a,i,o){return t(function(e,t,r,n,a,i){return{type:"customcontrol.propertybag.mode.clearnotification",execute:function(n,a){var o=n.dispatch,s=n.getState,c=Object(b.A)(s(),{controlName:t,id:e},r);if(c){i=i||"";for(var u=Object.keys(c),l=null,p=u.length-1;p>-1;--p)u[p]===i&&((l=c[u[p]]).actions=null,l.messages=null,l.notificationLevel=null,o(Object(Ye.b)(e,t,l,r)))}return!0},sync:!0}}(e,r,n,0,0,o))}},$t={setState:function(e){return!0},logMessage:function(e,r,n){t(function(e,t,r){return{type:"customcontrol.log",execute:function(n,a){n.dispatch,n.getState;var i=a.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(r){case He.a.Error:i.error(o);break;case He.a.Info:i.info(o);break;case He.a.Warning:i.warn(o);break;case He.a.Verbose:i.debug(o)}},sync:!0}}(e,r,n))}},Zt={isGetBarcodeValueOperationAvailable:function(){return t(Object(De.c)())},isTakePictureOperationAvailable:function(){return t(Object(De.e)())},isCaptureVideoOperationAvailable:function(){return t(Object(De.b)())},isCaptureAudioOperationAvailable:function(){return t(Object(De.a)())},isOpenARViewerAvailable:function(){return t(Object(De.d)())}},er={clearNestedChild:function(e){return!0},createAccessibilityComponent:Lt.a,createCommandManagerUXComponent:function(){var e=null;return function(t){var r=pr(t);return hr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,lr(r)}},createKeyboardShortcut:Lt.b,createXrmForm:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(At.b)(t,r,n,new g.a(a)))}(t,e,r,n,a)},createXrmGrid:function(e,r,n,a){var i=[O.a.AssociatedGrid,O.a.CustomGrid,O.a.SubGrid,O.a.MainGrid];if(e&&-1===i.indexOf(e.contextTokenType))for(var o in n)if("Grid"===n[o].Type){var s=n[o];t(Object(je.c)(s.TargetEntityType||s.EntityName,s.ViewId,r,e));break}return function(e,t,r,n,a){var i=Object(k.vb)(n);if(t){var o=void 0;switch(t.contextTokenType){case O.a.SubGrid:o=3;break;case O.a.AssociatedGrid:o=2;break;case O.a.MainGrid:case O.a.CustomGrid:o=1;break;default:var s=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:a},{name:"isEditableGrid",value:i}];pe.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,s),o=1}return!!e(Object(At.c)(t,r,i,o,a))}return!0}(t,e,r,n,a)},registerNewControl:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(At.e)(t,r,n,a))}(t,e,r,n,a)},executeAddOnLoad:function(e,r){t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute:function(r,n){var a=r.dispatch;r.getState,e.gridRunOnLoad((function(e,r,i){if(n.ScriptManager.containerExists(e)){var o=n.ScriptManager.getContainer(e).getEventManager();a(o.runOnGridDataLoad(t,1,i,r))}}))}}}(e,r))},addSessionTab:function(e,r){return t(function(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=!0;if(e){if(o.forEach((function(t){e.id===t.id&&(s=!1)})),s){if("quickViewFormTab"===e.type){var c=!1,u=e,l=Object(K.a)(6),p=Object(Z.E)(i,u.entityFormOptions.entityName),d=void 0;d=i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(u.entityFormOptions.entityId)?Object(b.ec)(i,"activitypointer",new g.a(u.entityFormOptions.entityId)):Object(b.ec)(i,u.entityFormOptions.entityName,new g.a(u.entityFormOptions.entityId));var h=new I.a(u.entityFormOptions.entityName,new g.a(u.entityFormOptions.entityId)),m=[];if(!d){var f=a(Object($.d)(h,[p]));m.push(f)}var v=Object(te.h)(i,u.entityFormOptions.entityName,l);if(g.a.isNullOrEmpty(v)){var y=a(Object(ee.b)(h,null,l)).then((function(e){v=e,g.a.isNullOrEmpty(v)||v===ee.a||(c=!0)}));m.push(y)}else c=!0,u.entityFormOptions.formId=v.guid;Promise.all(m).then((function(){u.entityFormOptions.formId=c?v.guid:"",u.entityMetadata={DisplayName:i.metadata.entities[u.entityFormOptions.entityName].DisplayName},i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(u.entityFormOptions.entityId)?u.title=Object(b.ec)(i,"activitypointer",new g.a(u.entityFormOptions.entityId)):u.title=Object(b.ec)(i,u.entityFormOptions.entityName,new g.a(u.entityFormOptions.entityId)),o.unshift(u),a(ne({sessionTabs:o,activeTabId:u.id,messageId:c?"":"quick_view_form_not_exist_message"},t))}))}else o.unshift(e),a(ne({sessionTabs:o,activeTabId:e.id},t));return Promise.resolve()}a(ne({sessionTabs:o,activeTabId:e.id},t))}}}}(e,r))},closeSessionTab:function(e,r){return t(oe(e,r))},updateSessionTab:function(e,r){return t(le(e,r))},closeAllSessionTabs:function(e){return t(ie(e))},dismissMessage:function(e){return t(se(e))},markActiveTab:function(e,r,n){return t(Object(ue.b)(e,r,n))},initializeReferencePanelControl:function(e,r){return t(ce(e,r))},cleanReferencePanelState:function(e){return t(ae(e))},executeNotifyHandlersThatEventOccurred:function(e){return t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute:function(t,r){var n=t.dispatch,a=t.getState,i=null;try{switch(e.eventName){case"onresultopened":n(Object(de.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":n(Object(de.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":n(Object(de.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":var o=e.contextToken,s=e.fieldName,c=e.record,u=!1,l=Object(de.u)("ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",a(),r,e.pageId,c);l&&(u=n(l.runOnLookupTagClick(o,s,null,c,a()))),i=u}return Promise.resolve(i)}catch(e){throw pe.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e))},getConnectorsApi:function(e){return null},executeRollupRequest:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute:function(n,a){var i=n.dispatch;if(n.getState,e&&t){var o=new Re(e,t),s=Ve.a.execute(o).then((function(e){return e.json()})).then((function(n){if(n){var o=[];for(var s in n)-1!==s.indexOf("@")||s.startsWith("_")||o.push(s);var c=new I.a(e.entityType,g.a.fromExternalGuid(e.id));return i(Object(Le.a)(r,c,o)).then((function(){a.EventManager.ReportComponentSuccess(Be.a+".Action",[{name:"APIName",value:Be.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])}),(function(r){a.EventManager.ReportComponentFailure(Be.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Be.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:n}])}))}}));return Ve.a.Diagnostics.traceInfo(Be.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,r,n))},getResource:function(e){return t(function(e){return{type:"customcontrol.getresources.async",execute:function(t,r){t.dispatch;var n=t.getState,a=r.AssetLoader,i=n(),o=Object(Ge.t)(i);if(3===e.Type||2===e.Type)return a.loadRawData(o+e.Name)}}}(e))},getRecordSetQueryKey:function(e){return e?e.getPreviousQueryKey():null},loadResources:function(e){return t(Object(ze.a)(e))},triggerOfflineMetadataSync:function(){return t(Object(Ce.h)())},retrieveFormWithAttributes:function(e,r,n){return t(Object(jt.c)(new I.a(e),g.a.tryParse(r),n))},loadManifest:function(e,r){return t(Object(Oe.c)(e,r))},updateOutputs:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"outputs.update",execute:function(s,c){var u=s.dispatch,l=s.getState;try{var p={},d={};if(i)for(var h=0,g=Object.keys(i);h<g.length;h++){var m=g[h],f=i[m],v=m;switch(f.fieldName&&(v=f.fieldName),(f.paramType===kt.a.LookupSimple||f.paramType===kt.a.LookupCustomer||f.paramType===kt.a.LookupOwner||f.paramType===kt.a.LookupRegarding||f.paramType===kt.a.LookupMultiEntity)&&f.value&&f.value instanceof Array&&(f.value.length>0?f.value=f.value[0]:f.value=null),f.type){case 0:p[v]=i[m];break;case 2:d[v]=i[m]}}var b=new Array,y=u(Object(fe.a)(e,p,!1,!1,t,r,a,o));if(b.push(y),Object(G.a)(l(),e).forms){var _=u(Object(wt.b)(e,n,o,d));b.push(_)}else{var C=u(Object(Nt.b)(e,n,d));b.push(C)}return Promise.all(b)}catch(a){var O=n+" failed at updating its outputs",I=Object(S.b)(l(),n);return c.EventManager.ReportComponentFailure(I+".CustomControl.updateOutputs",a,O,[{name:"APIName",value:Be.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(i)}]),c.TraceManager.getTracer("customcontrol").warn(I+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a,i,o,s))},updateFieldValue:function(e,r,n,a,i,o,s){return t(Object(fe.a)(e,r,!1,n,a,i,o,s))},runCustomOpenRecord:function(e,r,n,a){return t(function(e,t,r,n){return{type:"record.open",execute:function(a,i){var o=i.ScriptManager.getContainer(e).getEventManager(),s=new g.a(r),c=Object(C.f)(n,s,t),u=a.dispatch(Object(At.b)(c,e,t,s));return u=new xt.a(a,i,c,e,t,s),a.dispatch(o.runOnRecordOpen(n,r,u))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},getBoundFileObject:function(e,r,n,a){if(null==e||null==r||null==r.id||null==n)return null;var i={id:new g.a(r.id),etn:r.entityType};return t(Object(tr.c)(e,i,n,a,"full"))},saveEmbeddedEntity:function(e,r,n,a,i,o,s,c){return void 0===s&&(s=!1),t(Object(Ft.a)(e,r,n,a,i,o,s,c))},renderNestedCustomControl:Rt,renderReactSubtree:ke.createPortal,retrieveView:function(e,r,n,a){return t(Object(Te.a)(e,r,n,a))},retrieveViewSelector:function(e,r){return t(Object(Te.b)(e,r))},retrieveGridData:function(e){return t(Object(Pe.d)(e))},retrieveRecordDataForForm:function(e,r,n,a,i){return t(Object($.e)(Vt(e),g.a.tryParse(r),n,a,i))},retrieveForm:function(e,r,n){var a=g.a.tryParse(r),i=Vt(e);return t(Object(ee.b)(i,a,n)).then((function(e){return t(Object(he.c)(a,i.etn)).then((function(){return e}))}))},retrieveEntityData:function(e){return t(Object(Ie.f)(e,!1,[]))},retrieveChartDrilldownAttributes:function(e){return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:function(e,t){var n=e.dispatch,a=e.getState;return n(Object(Ie.f)(r,!0,[])).then((function(){var e=a(),t=Object(Je.d)(e,r);if(t&&Object.keys(t).length>0){var n={};for(var i in t){var o=t[i];Bt(e,r,i,o)&&(n[i]=o)}return n}return null}),(function(e){var n=e.get_message();return t.EventManager.ReportComponentFailure(Be.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(n),n,[{name:"APIName",value:Be.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null}))}}));var r},refreshDataSetParameter:function(e,r){return t(It(e,r))},retrieveLookupMetadataAction:function(e){return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute:function(e,t){var n=e.dispatch,a=e.getState;if(r instanceof Tt.a){var i={retrieveGridDataAction:function(e){return n(Object(Pe.d)(e))},retrieveViewAction:function(e,t,r,a){return n(Object(Te.a)(e,t,r,a))},retrieveViewSelectorAction:function(e,t){return n(Object(Te.b)(e,t))},runPreSearch:function(e,t,r){return n(Object(de.W)(Object(C.j)(a(),e),e,t,r))},runSetAdditionalParams:function(e,t,r){return n(Object(de.X)(Object(C.j)(a(),e),e,t,r))},refreshCustomDataProviderAction:function(e,t,r,a){return n(Object(it.b)(e,t,r,a))},getEntityMetadataAction:function(e,t){return n(Object(Ie.f)(e,!1,t))}};return r.retrieveLookupMetadata(a,i)}}}));var r},retrieveDataSetLookupCellParameter:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:function(n,a){var i=n.dispatch,o=n.getState;return i(It(t,r)).then((function(){var r=t.retrieveDataSetObject(o(),e,a);return Promise.resolve(r)})).catch((function(e){a.EventManager.ReportComponentFailure(Be.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Be.a+".Actions.RetrieveDataSetLookupCellParameter"}])}))}}}(e,r,n))},updateControlMemoizedDataSet:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute:function(n,a){n.dispatch;var i=(0,n.getState)(),o=e.retrieveDataSetObject(i,null,null,null,a);e.linkToParameter(o,t),e.updateControlMemoizedParameter(i,o,!0,r)}}}(e,r,n))},loadResourceStrings:function(e){return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute:function(e,t){var n=e.dispatch,a=e.getState,i=r.CustomControlId;if(!i)return Promise.resolve();var o=a(),s=Xe.a.getControlsResourceKeyList(i);if(!s)return Promise.resolve();var c=Object(Ue.d)(o);if(!c)return n(Object(qe.e)(s));for(var u=[],l=0,p=s;l<p.length;l++){var d=p[l];c.hasOwnProperty(d)||u.push(d)}return 0===u.length?Promise.resolve():n(Object(qe.e)(u))}}));var r},retrieveLookupData:function(e){return t(Object(Pe.d)(e))},setFieldControlPersonalization:function(e,r,n){return t(Object(Fe.j)(e,r,n))},setGridControlPersonalization:function(e,r,n){return t(Object(Fe.m)(e,r,n))},setDashboardControlPersonalization:function(e,r,n){return t(Object(Fe.i)(e,r,n))},setGenericControlPersonalization:function(e,r,n){return t(Object(Fe.k)(e,r,n))},setGlobalControlPersonalization:function(e,r){return t(Object(Fe.l)(e,r))},setPowerBISignedInState:function(e,r){return t(Object(me.b)(e,r))},beginSecureSessionForResource:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute:function(a,i){var o=new Me.a(i,a);return n?o.beginSecureSessionForResource(e,t,r):o.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,a))},setXrmObject:function(e){},addPendingCommandManagerId:function(e,r,n,a){var i;return t(Object(Et.a)(e,r,n,a)),{promise:new Promise((function(e){i=e})),resolve:i}},initializeCommandManager:function(e,r,n,a,i){var o;return t(Object(Et.b)(e,r,n,a,i)),{promise:new Promise((function(e){o=e})),resolve:o}},retrieveRecordCommand:function(e,r,n,a,i,o,s,c,u,l){return t(Object(Et.c)(l,e,r,n,a,i,o,s,c,u))},setValue:function(e,r,n,a){return e&&r?t(function(e,t,r,n){var a=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute:function(i,o,s){var c=i.dispatch,u=(0,i.getState)(),l=Object(C.j)(u,e),p=Object(C.x)(l),d=Object(ye.a)(u,n,t,r,!1,l,o.TraceManager.getTracer("Forms.UpdateValue")),h=g.a.isNullOrEmpty(t.id)?_e.a.Create:_e.a.Update;if(a.push({name:"CorrelationId",value:s.correlationId},{name:"ContextId",value:s.contextId},{name:"ActionStack",value:s.stack},{name:"mode",value:h}),n)return c(Object(ve.b)(u,n,d)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",a),Promise.resolve();var m=Object(be.b)(u,t,d,p,h),f=m.payload.snapshotId;return c(m),a.push({name:"newSnapshotId",value:f}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",a),Promise.resolve(f)},getFailureParameters:function(e,t){return a}}}(a,e,r,n)).then((function(e){return Promise.resolve(e||n)})):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required")},save:function(e,r){return void 0===r&&(r=[]),t(Object(Ee.c)(e,!1,r))},openPopup:function(e){return t(Object(Q.a)(e))},closePopup:function(e){return t(Object(Y.a)(e))},loadWebResource:function(e,r){return t(We(e,r))},registerOngoingWork:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:function(a,i){return a.dispatch,a.getState,Pt.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},isPresenceEnabledEntity:function(e){return Object(H.b)(e)},getPresenceMappedField:function(e){return Object(H.a)(e)},fireXrmEvent:function(e,r,n,a,i){var o=t(Object(Se.b)(r,n)),s=null;if(o&&o.ui&&o.ui.controls&&(s=o.ui.controls.get(e)),s)switch(a){case 0:s.fireOnKeyPress&&s.fireOnKeyPress()}},sendLookupRequest:function(e,r,n,a,i,o,s){return t(Yt(e,!0,r,n,a,i,o,s))},runPreSearch:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunPreSearch",execute:function(n){var a=n.dispatch;n.getState,a(Object(Ct.f)(r,t,e)),a(Object(de.W)(e,r,t)),a(Object(de.X)(e,r,t)),a(Object(Ct.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute:function(n,a){var i=n.dispatch;n.getState,a.ScriptManager.containerExists(t)&&i(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:function(e,r,n){return t(Object(rr.a)(e,r,n))},retrieveLookupRecordsByIds:function(e,r,n){return t(Object(rr.b)(e,r,n))}},e={actions:er,propBagMethods:{utils:$t,navigation:n,device:Zt,mode:Jt}}}}))(s.a),ur=function(e){function t(t,r){var n=e.call(this,t)||this;return n._updateCounter=0,n._isUpdateScheduled=!1,n._reRunMapStateToProps=function(){n._isUpdateScheduled||(n._isUpdateScheduled=!0,Object(sr.c)((function(){n._isUpdateScheduled=!1,n._updateCounter++,n.forceUpdate()})))},n._reRunMapStateToProps=n._reRunMapStateToProps.bind(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),o.createElement(c.a.Provider,{value:this.context},o.createElement(cr,Object(n.__assign)({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))},t}(o.Component);function lr(e){var t="cm"+Object(ir.a)();return o.createElement(ar.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function pr(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:or.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:dr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function dr(e){var t=[];if(e)for(var r=0,n=e;r<n.length;r++){var a=n[r];t.push(Vt(a))}return t}function hr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){for(var r=e.length,n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}ur.contextType=i.a},Nhrb:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("Sscr"),a=r("uO/V"),i="control.update.parameter";function o(e,t,r,o,s){return{type:"control.update.parameter.async",execute:function(c,u){var l=c.dispatch,p=(c.getState,a.x+".updateControlParameterAction");l(function(e,t,r,o,s){var c=Object(n.v)(s);return{type:i,payload:{name:r,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:a.o}}}(e,0,r,o,s));var d=[];return d.push({name:"controlName",value:t}),d.push({name:"paramName",value:""+r}),u.EventManager.ReportComponentSuccess(p,d),Promise.resolve()}}}},Oiu5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r("Gemh");function a(e){var t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,a=[];return r?(t.forEach((function(e){if(4200!==r[e].ObjectTypeCode){var t=function(e){var t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);a.push(t)}})),a.sort(i)):a}function i(e,t){var r=e.entityDisplayName,n=t.entityDisplayName,a=0;return r>n?a=1:r<n&&(a=-1),a}function o(e){for(var t=[],r=0;r<e.length;r++){var n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map((function(e){return{key:e.value,text:e.text}})):[]}},OmYs:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="section.label";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,sectionName:r}}}},PLtI:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.setlabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,tabId:r}}}},PZxu:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n,a=r("Gemh"),i=r("Zy0S"),o=r("XJ3n"),s=r("+Z9T"),c=r("Sscr"),u=r("9r0m"),l=r("TCcM"),p=r("QAhb"),d=r("9rlF"),h=r("IiPO"),g=r("w/nD"),m=r("ezfI"),f=r("/j9Z"),v=r("kvLG"),b=function(){function e(e,t,r,a,i,o,c){var u="ClientApi.XrmControlGrid.constructor";if(a||Object(s.j)(u,"pageId"),r||Object(s.j)(u,"contextToken"),e||Object(s.j)(u,"store"),i||Object(s.j)(u,"gridEntity"),Object(s.a)(o)&&Object(s.j)(u,"isEditable"),n=e,this._applicationContext=t,this._contextToken=r,this._pageId=a,this._gridEntityName=i,this.controlName=c,this._isEditable=o,!this._contextToken.contextTokenType){var l=h.a.getInstance().getEventParameters(this._contextToken);l.push({name:"controlName",value:this.controlName}),l.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(u,new f.a("context token passed to grids with empty context token type"),null,l)}}return Object.defineProperty(e.prototype,"_isEditable",{get:function(){var e=Object(a.V)(n.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){var t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),v.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmControlGrid._isEditable_get",new f.a("control configuration parameters not found"),null,t),this._isGridEditable}return e},set:function(e){this._isGridEditable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationContext",{get:function(){return m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext},set:function(e){m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")},enumerable:!1,configurable:!0}),e.prototype.getTotalRecordCount=function(){var e="ClientApi.XrmControlGrid.getTotalRecordCount";try{m.a.instance.reportCall(e);var t=Object(a.Y)(n.getState(),this._pageId,this._contextToken);if(t){var r=JSON.parse(t),i=r&&r.totalResultCount?r.totalResultCount:0;return m.a.instance.reportSuccess(e),i}return m.a.instance.reportSuccess(e),0}catch(t){var o=h.a.getInstance().getEventParameters(this.contextToken);throw o.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.getRows=function(){var e="ClientApi.XrmControlGrid.getRows";try{m.a.instance.reportCall(e);var t=new i.a(e),r=n.getState(),s=Object(a.H)(r,this.contextToken,{id:this.pageId});if(s)for(var u=0;u<s.length;u++){var l=s[u].identifier.id,p=this._getRowEntityName(s[u],l),d=new o.a(n,this._applicationContext,Object(c.f)(this.contextToken,l,p),this.pageId,p,l),g=s[u].identifier.id.guid;t.add(g,d)}return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.getSelectedRows=function(){var e="ClientApi.XrmControlGrid.getSelectedRows";try{m.a.instance.reportCall(e);var t=new i.a(e),r=Object(a.fb)(n.getState(),this.pageId,this.contextToken);if(r)for(var s=Object(a.Q)(n.getState(),this.pageId,this.contextToken),p=function(e){var i=void 0;if(s)i=s;else{var p=n.getState(),h=Object(a.v)(p,d.pageId,d.contextToken),g=(h&&h.queryKey&&Object(l.q)(p,h.queryKey,null,null,!0)||[]).find((function(t){return t.identifier&&u.a.equals(t.identifier.id,r[e])}));i=d._getRowEntityName(g,r[e])}var m=new o.a(n,d._applicationContext,Object(c.f)(d.contextToken,r[e],i),d.pageId,i,r[e]),f=r[e].guid;t.add(f,m)},d=this,g=0;g<r.length;g++)p(g);return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.addOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.m)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.removeOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.H)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.runOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.runOnRecordSelect";try{m.a.instance.reportCall(t),this._isEditable&&n.dispatch(Object(g.T)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getRowEntityName=function(e,t){var r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){var a=Object(l.j)(n.getState(),new p.a(this._gridEntityName,t),"activitytypecode");if(Object(d.j)(a))return a.value}return r},Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}()},PhZR:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.label";function a(e,t,r,a){return{type:n,payload:{label:r,currentLanguageId:a},meta:{pageId:e,navigationItemId:t}}}},"Pm+b":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("7z0H"),a=r("bCrZ"),i=r("Sscr");function o(e,t,r){var a=Object(i.v)(r),o={xrmReady:e};return{type:n.b,payload:o,meta:{pageId:t,contextKey:a}}}function s(e,t,r){var n=Object(i.u)(r),o={xrmReady:e};return{type:a.b,payload:o,meta:{pageId:t,contextKey:n}}}},Q60c:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="controls.DefaultView";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},QItn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.mrudisabled";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:o,meta:{pageId:t,controlName:r,contextKey:s}}}},Qeyq:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(){return{tabId:"",navigationStack:[]}}r.d(t,"a",(function(){return n}))},RB3d:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("nuS9"),a=r("B73A"),i=r("akzq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n,i,o){return new a.a(e,(function(e){t(e.EVENT)}),r,n,i,o)}function s(e){return n.createElement(i.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},SdPQ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.bodyvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},TCDU:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("1Tfq"),a=r("aGOT"),i=r("HSdq"),o=r("kk/C"),s=r("OTOS"),c=r("Sscr"),u=r("yHpA"),l=r("2p2B"),p=r("Srej");function d(e){return{type:"handle.unsaved.changes.async",execute:function(t,r,d){var h=t.dispatch,g=t.getState;return h(Object(n.a)(e)).then((function(t){if(t){for(var r=Object(s.a)(g(),e),n=r.map((function(e){return Object(c.j)(g(),e)})),d=0;d<r.length;d++){for(var m=r[d],f=n[d],v=Object(i.ac)(g(),m,f),b=Object(u.b)(g(),v),y=0,_=(null==b?void 0:b.activeChanges)?Object.keys(b.activeChanges):[];y<_.length;y++){var S=_[y];h(Object(l.b)(f,m,Object(p.d)(m,S)))}h(Object(a.c)(m,v,f)),h(Object(o.d)(m,f))}return!0}return!1}))}}}},"U/bH":function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return p}));var n=r("Sscr"),a=r("uO/V"),i=r("Gemh"),o=r("VWqI"),s=r("EwXg"),c=r("BFwB"),u=r("+Xnp"),l="dataset.dependentoptionset.column.status";function p(e,t){var r=[];return{type:"dependentoptionset.column.status",sync:!0,execute:function(o,u,p){var m=o.dispatch,f=o.getState,v=u.TraceManager.getTracer(a.z),b=a.x+".SetDependentOptionSetColumnStatusAction";u.TraceManager.setLogLevel(s.a.Info,b);try{var y=Object(n.v)(t),_=f(),S=null,C=Object(i.Q)(f(),e,t),O={};if(C)S=C;else{var I=Object(i.S)(f(),{id:e},t);I&&I.entityLogicalName&&(S=I.entityLogicalName)}if(S){r.push({name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:S}),v.info("Executing initialize dependent option set column status action in grid.",r);var P={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},j=[],T=0,E=Object(i.z)(_,t,S,e);for(var F in E){var A=E[F];if(null===A.ParentPicklistLogicalName){var x={name:F,value:0};d(_,t,e,S,E,F,x)?h(E,F,O,P):(g(E,F,O),T++,j.push(x))}else void 0===E[A.ParentPicklistLogicalName]&&h(E,F,O,P)}var w={name:"NumCompleteDependentOptionSetChainsInGrid",value:T},N={name:"CompleteChainsMaxDepthInGrid",value:j};r.push(w,P,N);var k=new c.a(b);k.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",T),k.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",P.value),k.addEventParameter("CompleteChainsMaxDepthInGrid",j),u.EventManager.ReportEvent(k),u.EventManager.ReportComponentSuccess(b),v.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(O).length>0&&m(function(e,t,r){return{type:l,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,y,O))}catch(e){u.EventManager.ReportComponentFailure(b,Error("creating dependent option set column status node in state tree failed."))}}}}function d(e,t,r,n,a,i,s){if(void 0===a[i])return!0;if(function(e,t,r,n,a){if(!Object(o.f)(e,a,n,u.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,a,i,n))return!0;var c=a[i].ChildPicklistLogicalNames;if(null!==c)for(var l=0;l<c.length;l++){var p={name:i,value:0};if(d(e,t,r,n,a,c[l],p))return!0;s.value=Math.max(s.value,p.value)}return s.value=s.value+1,!1}function h(e,t,r,n){if(void 0!==e[t]){r[t]=0,n.value=n.value+1;var a=e[t].ChildPicklistLogicalNames;if(a)for(var i=0;i<a.length;i++)h(e,a[i],r,n)}}function g(e,t,r){r[t]=1;var n=e[t].ChildPicklistLogicalNames;if(n)for(var a=0;a<n.length;a++)g(e,n[a],r)}},UVKb:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,a=r("qC0c"),i=r("lFQy"),o=r("t8f4"),s=r("Y70o"),c=r("WS0f"),u="ProcessControl_ActionExecuter_ExecutionTimeTooltip",l="ProcessControl_ActionExecuter_ErrorMessageTooltip",p="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";function d(e){switch(e){case n.InProgress:case n.Waiting:return 1;case n.Succeeded:return 2;case n.Failed:case n.Canceled:return 3;default:return 0}}function h(e,t,r,a){var i="";if(Object(c.b)(e)||(i=String.format(a[u],new Date(e).toLocaleString())),r===n.Failed){var o=Object(c.b)(t)?a.Crm_GenericErrorMessage:t;i+="\n"+String.format(a[l],o)}return""===i?t:i}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute:function(r,n){var c=r.dispatch,g=r.getState,m=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),f=g();if(function(e){return Object(a.b)(e,"BpfActionSupportActionQuerying")}(f))return c(Object(o.e)("workflowlog",m)).then((function(e){if(e.value&&e.value.length){var r={};r[u]=Object(s.a)(f,p,u),r[l]=Object(s.a)(f,p,l),r.Crm_GenericErrorMessage=Object(s.a)(f,p,"Crm_GenericErrorMessage");var n={};e.value.forEach((function(e){if(e.stepname&&-1===Object.keys(n).indexOf(e.stepname)){var t={actionLogId:e.workflowlogid,status:d(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:h(e.modifiedon,e.message,e.status,r)};n[e.stepname]=t}}));var a={actionLogCollection:n};return c(Object(i.a)(a,t))}}))}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(n||(n={}))},W51q:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("qC0c"),a=r("cZkS"),i=r("7EJx");function o(e){return!!Object(n.a)(e,a.S,a.h)&&(!!Object(n.a)(e,a.d,a.Lc)||1033===Object(i.s)(e))}},WVwd:function(e,t,r){"use strict";r.d(t,"a",(function(){return K})),r.d(t,"b",(function(){return J}));var n,a,i,o=r("9r0m"),s=r("HSdq"),c=r("BWVO"),u=r("7ipg"),l=r("1z64"),p=r("QAhb"),d=r("/eCp"),h=r("TCcM"),g=r("nbQV"),m=r("IiPO"),f=r("+Z9T"),v=r("ezfI"),b=function(){function e(e,t,r){var n="ClientApi.XrmProcessStep.constructor";t||Object(f.j)(n,"step"),r||Object(f.j)(n,"processManager"),e||Object(f.j)(n,"store"),this._step=t,this._processManager=r}return e.prototype.isRequired=function(){var e="ClientApi.XrmProcessStep.isRequired";try{v.a.instance.reportCall(e);var t=this._step.get_isProcessRequired();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getAttribute=function(){var e="ClientApi.XrmProcessStep.getAttribute";try{if(v.a.instance.reportCall(e),!this._attribute){var t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return v.a.instance.reportSuccess(e),this._attribute}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStep.getName";try{v.a.instance.reportCall(e);var t=this._step.get_Name();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getProgress=function(){var e="ClientApi.XrmProcessStep.getProgress";try{v.a.instance.reportCall(e);var t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0))if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){var r=this._processManager.getActionLog(new o.a(this._step.get_Id()));r&&(t=r.status),t=0}return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.setProgress=function(e,t){var r="ClientApi.XrmProcessStep.setProgress";try{v.a.instance.reportCall(r);var n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return v.a.instance.reportSuccess(r),n}catch(e){throw m.a.getInstance().reportFailure(r,e),e}},e.prototype._setProgressInternal=function(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)&&this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){var r=this._processManager.UpdateActionLog(new o.a(this._step.get_Id()),e,t);if(r)return r}return"invalid"},e}(),y=r("Zy0S"),_=function(){function e(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}return Object.defineProperty(e.prototype,"allowCreateNew",{get:function(){return v.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew},set:function(e){var t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{v.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),v.a.instance.reportSuccess(t)}catch(e){throw m.a.getInstance().reportFailure(t,e),e}},enumerable:!1,configurable:!0}),e}(),S=function(){function e(e,t,r,a,i){n=e,this._entityTypeName=r,this._activeStageId=a,this._stageStep=t,new _(e,i),i&&(this._processManager=i)}return e.prototype.getCategory=function(){var e="ClientApi.XrmProcessStage.getCategory";try{v.a.instance.reportCall(e);var t=this._stageStep.get_stageCategory(),r={getValue:function(){var e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return v.a.instance.reportSuccess(e),r}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmProcessStage.getId";try{v.a.instance.reportCall(e);var t=this._stageStep.get_Id();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getEntityName=function(){return v.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessStage.getStatus";try{v.a.instance.reportCall(e);var t=this.getId()===this._activeStageId?"active":"inactive";return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStage.getName";try{v.a.instance.reportCall(e);var t=this._stageStep.get_Description();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getSteps=function(){var e="ClientApi.XrmProcessStage.getSteps";try{if(v.a.instance.reportCall(e),!this._steps&&(this._steps=new y.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(var t=0;t<this._stageStep.get_Steps().get_Count();t++){var r=this._stageStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var a=r.get_Steps().get_item(0);a&&(a instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(r.get_Id(),new b(n,r,this._processManager))}}return v.a.instance.reportSuccess(e),this._steps}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getNavigationBehavior=function(){var e="ClientApi.XrmProcessStage.getNavigationBehavior";try{v.a.instance.reportCall(e);var t=this._processManager.getBpfNavigationBehavior();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),C=function(){function e(e,t,r,n,i){var o="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(f.j)(o,"workflowStep"),n||Object(f.j)(o,"activeStageId"),i||Object(f.j)(o,"processManager"),e||Object(f.j)(o,"store"),Object(f.a)(r)&&Object(f.j)(o,"isRendered"),a=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=i}return e.prototype.getName=function(){var e="ClientApi.XrmBusinessProcessFlow.getName";try{v.a.instance.reportCall(e);var t=this._workflowStep.get_Name();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmBusinessProcessFlow.getId";try{v.a.instance.reportCall(e);var t=this._workflowStep.get_Id();return v.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.isRendered=function(){return v.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered},e.prototype.getStages=function(){var e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(v.a.instance.reportCall(e),!this._stages){this._stages=new y.a(e);for(var t=0;t<this._workflowStep.get_Steps().get_Count();t++){var r=this._workflowStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep)for(var n=r,i=0;i<n.get_Steps().get_Count();i++){var o=n.get_Steps().get_item(i);this._stages.add(o.get_Id(),new S(a,o,n.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}return v.a.instance.reportSuccess(e),this._stages}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),O=r("w/nD"),I=r("JBkQ"),P=r("7kKV"),j=r("AqA3");!function(e){e.success="success",e.invalid="invalid"}(i||(i={}));var T,E,F=r("m8A1"),A=r("BvBP"),x=r("c56u"),w=r("JlqV"),N=r("kvLG"),k=r("sOTk"),M=r("b1hT"),D=r("l9h5"),R=r("Z1aD"),L=r("xc1f"),V=function(){function e(e,t,r,n,a){this._clientApiExecutor=new l.a(e,"ClientApi.XrmProcessControlData.",r,t);var i=this._clientApiExecutor.getComponentName("constructor");r||Object(f.j)(i,"pageId"),n||Object(f.j)(i,"entity"),t||Object(f.j)(i,"contextToken"),e||Object(f.j)(i,"store"),T=e,this._pageId=r,this._entity=n;var s=!1;Object(F.d)(T.getState(),this._pageId,i,!0)&&(this._processManager=a,s=!0),this._contextToken=t;var c=n.getEntityReference();this._entityRef=new p.a(c.entityType,o.a.tryParseOrNull(c.id),c.name);var u=Object(F.b)(r,e.getState(),s);N.a.getInstance().eventManager.ReportComponentSuccess(i,u)}return e.prototype.getActiveProcess=function(){var e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcess(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new C(T,t,!0,n,this._getProcessManager())}return v.a.instance.reportSuccess(e),r}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.setStatus=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setStatus";try{if(v.a.instance.reportCall(n),!Object(F.d)(T.getState(),this._pageId,n))return void v.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void v.a.instance.reportSuccess(n);var a;if(e===I.a.active)a=d.a.Active;else if(e===I.a.finished)a=d.a.Finished;else{if(e!==I.a.aborted)return void v.a.instance.reportSuccess(n);a=d.a.Aborted}this._getProcessManager().setStatus(a).then((function(){r._callback(t,e,n),v.a.instance.reportSuccess(n)})).catch((function(t){var a=m.a.getInstance().getEventParameters(r._contextToken);return a.push({name:"newStatus",value:e}),Object(f.d)(T,t,n,a)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessControlData.getStatus";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return v.a.instance.reportSuccess(e),t}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getInstanceName=function(){var e="ClientApi.XrmProcessControlData.getInstanceName";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceName();if(!t){var r=Object(h.e)(T.getState(),this._entityRef);t=Object(g.c)(T.getState(),r)}return v.a.instance.reportSuccess(e),t}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getInstanceId=function(){var e="ClientApi.XrmProcessControlData.getInstanceId";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceId(),r=t?o.a.toString(t):null;return v.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getProcessInstances=function(e){var t=this,r="ClientApi.XrmProcessControlData.getProcessInstances";try{if(v.a.instance.reportCall(r),!Object(F.d)(T.getState(),this._pageId,r)||Object(M.g)(T.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then((function(n){if(n&&n.value&&n.value.length>0){var a={};n.value.forEach((function(e){e.businessprocessflowinstanceid&&(a[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:t._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})})),Object(u.c)(r,[],(function(){e(a)}))}v.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".getProcessInstances",n)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.setActiveProcess=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcess",(function(n,a){var s=o.a.tryParseOrNull(e),c=Object(k.m)(T.getState(),r._pageId);if(s&&o.a.equals(s,o.a.EMPTY)){if(c){var u=new p.a(r._entity.getEntityName(),o.a.EMPTY);return T.dispatch(Object(D.b)(!0,u)),N.a.getInstance().eventManager.ReportComponentSuccess(n,a),Promise.resolve().then((function(){return r._callback(t,i.success,n,a),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}return Promise.resolve().then((function(){return r._callback(t,i.invalid,n,a),Promise.resolve()}))}if(!Object(F.d)(T.getState(),r._pageId,n,!0)||Object(M.g)(T.getState()))return Promise.resolve();return(c?Promise.resolve():r._getProcessManager().setActiveProcess(e)).then((function(){r._callback(t,i.success,n,a);var o=r.getActiveProcess();return o&&o.getId().toUpperCase()===e.toUpperCase()||r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.setActiveProcessInstance=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcessInstance",(function(n,a){return!Object(F.d)(T.getState(),r._pageId,n)||Object(M.g)(T.getState())?Promise.resolve():r._getProcessManager().setActiveProcessInstance(e).then((function(o){return r._callback(t,i.success,n,a),r.getInstanceId()!==e&&r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),o,e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.getEnabledProcesses=function(e){var t=this,r="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(v.a.instance.reportCall(r),!Object(F.d)(T.getState(),this._pageId,r,!0))return void v.a.instance.reportSuccess(r);var n=T.getState();if(Object(A.g)(n)&&Object(x.w)(n)&&!Object(w.b)(n)){var a={};return void("function"==typeof e&&Object(u.c)(r,[],(function(){e(a)})))}this._getProcessManager().getEnabledProcesses().then((function(t){var n={};t&&t.length>0&&t.forEach((function(e){n[e.workflowId]=e.name})),"function"==typeof e&&Object(u.c)(r,[],(function(){e(n)})),v.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".getEnabledProcesses",n)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,i),e}},e.prototype.switchProcess=function(){var e="ClientApi.XrmProcessControlData.switchProcess";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e)||Object(M.g)(T.getState()))return;this._getProcessManager().switchProcess(),v.a.instance.reportSuccess(e)}catch(r){var t=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.abandonProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.abandonProcess";try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void v.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then((function(){v.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".abandonProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reactivateProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void v.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then((function(){v.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".reactivateProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.completeProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.completeProcess";try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t)||Object(k.m)(T.getState(),this._pageId))return void v.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then((function(){v.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".completeProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getActiveStage=function(){var e="ClientApi.XrmProcessControlData.getActiveStage";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getActiveStage(),r=null;return t&&(r=new S(T,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),v.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getActivePath=function(){var e=this,t="ClientApi.XrmProcessControlData.getActivePath";try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return v.a.instance.reportSuccess(t),null;var r=this._getProcessManager().getActivePathStages(),n=null;if(r){var a=this._getProcessManager().getActiveStageId(),i=new y.a(t);r.forEach((function(t){var r=t.get_parent().get_EntityLogicalName();i.add(t.get_stageId(),new S(T,t,r,a,e._getProcessManager()))})),n=i}return v.a.instance.reportSuccess(t),n}catch(e){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,o),e}},e.prototype.setActiveStage=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setActiveStage";try{if(v.a.instance.reportCall(n),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))v.a.instance.reportSuccess(n),this._callback(t,P.a.dirtyForm,n);else{if(!Object(F.d)(T.getState(),this._pageId,n))return void v.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then((function(){r._callback(t,r._getStageInvalidReason(null),n),r._loadActiveStageEntity(n),v.a.instance.reportSuccess(n)})).catch((function(e){r._callback(t,e?r._getStageInvalidReason(e):j.a.invalid,n)}))}}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.moveNext=function(e){var t=this,r="ClientApi.XrmProcessControlData.moveNext";try{if(v.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))v.a.instance.reportSuccess(r),this._callback(e,P.a.dirtyForm,r);else{if(!Object(F.d)(T.getState(),this._pageId,r))return void v.a.instance.reportSuccess(r);if(this._getProcessManager().isCrossEntityNavigation(!0))return this._callback(e,P.a.crossEntity,r),void v.a.instance.reportSuccess(r);this._getProcessManager().moveToNextStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),v.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):P.a.invalid;if(t._callback(e,a,r),a===P.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,n,r+".moveToNextStage",i)}v.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.movePrevious=function(e){var t=this,r="ClientApi.XrmProcessControlData.movePrevious";try{if(v.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(T.getState(),this._pageId))v.a.instance.reportSuccess(r),this._callback(e,P.a.dirtyForm,r);else{if(!Object(F.d)(T.getState(),this._pageId,r))return void v.a.instance.reportSuccess(r);if(Object(M.g)(T.getState())&&this._getProcessManager().isCrossEntityNavigation(!1))return this._callback(e,P.a.crossEntity,r),void v.a.instance.reportSuccess(r);this._getProcessManager().moveToPreviousStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),t._loadActiveStageEntity(r),v.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):P.a.invalid;if(t._callback(e,a,r),a===P.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,n,r+".moveToPreviousStage",i)}v.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.getSelectedStage=function(){var e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(v.a.instance.reportCall(e),!Object(F.d)(T.getState(),this._pageId,e))return v.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getSelectedStage(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new S(T,t,this._getProcessManager().getCurrentFormEntity().etn,n,this._getProcessManager())}return v.a.instance.reportSuccess(e),r}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.addOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.q)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(f.g)(e,t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.j)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.L)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(f.g)(e,t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.E)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.r)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.M)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.k)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.i)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.F)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(v.a.instance.reportCall(t),!Object(F.d)(T.getState(),this._pageId,t))return void v.a.instance.reportSuccess(t);T.dispatch(Object(O.D)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getStageInvalidReason=function(e){return e?e.stageInvalidReason||j.a.invalid:P.a.success},e.prototype._getNavigationStatus=function(e){return e?e.navigationStatus||P.a.invalid:P.a.success},e.prototype._convertToXrmProcessInstanceStatus=function(e){if(e){if(e===d.a.Active)return I.a.active;if(e===d.a.Finished)return I.a.finished;if(e===d.a.Aborted)return I.a.aborted}return null},e.prototype._callback=function(e,t,r,n){var a=r+".Callback";n||(n=m.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(u.c)(a,n,(function(){"function"==typeof e&&e(t)}))},e.prototype._reloadPage=function(e,t,r,n){if(t){var a=Object(k.m)(T.getState(),this._pageId),i={entityTypeName:t.etn,id:a?void 0:t.id,processId:r,processInstanceId:n};T.dispatch(Object(R.a)(L.a,i,this._pageId,{target:"inline"})).then((function(t){if(0!==t.status)return Object(f.d)(T,t.error,e+".navigateTo.INavigationFailure")})).catch((function(t){return Object(f.d)(T,t,e+".navigateTo.")}))}},e.prototype._loadActiveStageEntity=function(e){var t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(F.c)(this._processManager,T,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager},e}(),B=r("UGbr"),G=r("TCDU"),X=r("UOiB"),q=r("/j9Z"),U=r("9qYn"),z=r("ObKm"),W=r("/lKk"),H=r("gk6Q"),Y=r("vqdi"),Q=r("Gemh"),K=function(){function e(e,t,r,n,a){this._entity=null;var i="ClientApi.XrmFormData.constructor";e||Object(f.j)(i,"store"),r||Object(f.j)(i,"pageId"),t||Object(f.j)(i,"contextToken"),n||Object(f.j)(i,"formContext"),E=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=a}return Object.defineProperty(e.prototype,"entity",{get:function(){return v.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"process",{get:function(){var e="ClientApi.XrmFormData.process_get";try{var t=Object(M.f)(E.getState());v.a.instance.reportCall(e);var r=!!this._process;if((!t&&!this._process||t)&&this._entity){var n=Object(k.g)(E.getState(),this._pageId),a=Object(H.b)(this._pageId,n);this._entity&&(this._process=new V(E,this._contextToken,this._pageId,this.entity,a))}v.a.instance.reportSuccess(e);var i=Object(F.a)(this._pageId,E.getState(),r,!!this._entity);return N.a.getInstance().eventManager.ReportComponentSuccess(e,i),this._process}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},set:function(e){var t=Object(F.a)(this._pageId,E.getState(),!!this._process,!!this._entity);N.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e},enumerable:!1,configurable:!0}),e.prototype.getEntity=function(){return v.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity},e.prototype.getIsDirty=function(){var e,t,r,n="ClientApi.XrmFormData.getIsDirty";try{v.a.instance.reportCall(n);var a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(var i=0;i<this.attributes.getLength();i++){var o=this.attributes.get(i);if("never"!==o.getSubmitMode()&&o.getIsDirty()){a=!0;break}}if(!a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(i=0;i<this._formContext.ui.controls.getLength();i++){var s=this._formContext.ui.controls.get(i);if("formcomponent"===s.getControlType()&&s.isLoaded()&&(null===(r=s.data)||void 0===r?void 0:r.getIsDirty())){a=!0;break}}}return v.a.instance.reportSuccess(n),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},Object.defineProperty(e.prototype,"attributes",{get:function(){var e="ClientApi.XrmFormData.attributes";try{if(v.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new y.a(e);var t=Object(s.Oc)(E.getState(),this._pageId);if(t)for(var r in t){var n=t[r],a=r,i=Object(c.b)(E,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,n);this._unboundAttributes.add(i.getName(),i)}}return v.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},enumerable:!1,configurable:!0}),e.prototype._refreshEntity=function(e){var t=this;return this.entity.refresh().then((function(){Object(B.d)(E.dispatch,t._contextToken,t._pageId),e&&E.dispatch(Object(O.Q)(t._contextToken,t._pageId,3,t.entity)),Object(U.b)(t.entity)}))},e.prototype.refresh=function(e){var t=this,r="ClientApi.XrmFormData.refresh";try{if(v.a.instance.reportCall(r),this.entity){var n=Object(s.kb)(E.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then((function(e){return v.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".save",n)})):!n&&this.entity.getIsDirty()?E.dispatch(Object(G.a)(this._pageId)).then((function(e){if(e)return t._refreshEntity(!0).then((function(){return v.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges.refreshEntity",n)}))})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges",n)})):this._refreshEntity(!0).then((function(){return v.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges.refreshEntity",n)}))}var a=new q.a("Refresh action cannot be executed since form entity is null",2147746581);return N.a.getInstance().traceManager.getTracer(r).info("Refreshing on a non entity page"),Object(f.d)(E,a,r+".entity")}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);return Object(f.d)(E,e,r,i)}},e.prototype.save=function(e){var t=this,r="ClientApi.XrmFormData.save",n=m.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){var a=new q.a("Save action cannot be executed since form entity is null",2147746581);return Object(f.d)(E,a,r+".entity")}try{v.a.instance.reportCall(r);var i=1;return e&&e.saveMode&&(i=e.saveMode),J(this._pageId,E,i,n,this._contextToken,this.entity,!0,!0).then((function(e){if(e){var a={entityType:e.etn,id:o.a.toString(e.id),name:e.name};return Object(s.Kb)(E.getState(),t._pageId)?(v.a.instance.reportSuccess(r),{savedEntityReference:a}):t._refreshEntity(!1).then((function(){return v.a.instance.reportSuccess(r),{savedEntityReference:a}})).catch((function(e){return Object(f.d)(E,e,r+".refresh",n)}))}if(Object(s.kb)(E.getState(),{id:t._pageId},t._contextToken)||!t.entity.getIsDirty()){var i=t.entity.getEntityReference();return v.a.instance.reportSuccess(r),{savedEntityReference:i}}var c=new q.a("Save action was not executed and the form is dirty.",2147879192);return Object(f.d)(E,c,r+".NoReference",null,!1)})).catch((function(e){if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){var a=t.entity.getEntityReference();return v.a.instance.reportSuccess(r),Promise.resolve({savedEntityReference:a})}return Object(f.d)(E,e,r,n)}))}catch(e){return Object(f.d)(E,e,r,n)}},e.prototype.isValid=function(){var e,t,r,n="ClientApi.XrmFormData.isValid";try{v.a.instance.reportCall(n);var a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(var i=0;i<this.attributes.getLength();i++)if(!this.attributes.get(i).isValid()){a=!1;break}if(a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(var o=0;o<this._formContext.ui.controls.getLength();o++){var s=this._formContext.ui.controls.get(o);if("formcomponent"===s.getControlType()&&s.isLoaded()&&!(null===(r=s.data)||void 0===r?void 0:r.isValid())){a=!1;break}}return a||E.dispatch(Object(z.b)(this._pageId,this._contextToken)),v.a.instance.reportSuccess(n),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},e.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormData.addOnLoad";e||Object(f.j)(t,"handler");try{v.a.instance.reportCall(t),E.dispatch(Object(O.c)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormData.removeOnLoad";e||Object(f.j)(t,"handler");try{v.a.instance.reportCall(t),E.dispatch(Object(O.x)(this._contextToken,this._pageId,e)),v.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e}();function J(e,t,r,n,a,i,c,u){var l=t.getState(),p=o.a.tryParseOrNull(i.getId());if(a.contextTokenType===X.a.GridRow){var d=[],h=Object(Q.T)(l,e,a.parentContextToken,a.parentContextToken.controlName);return i.attributes.forEach((function(e){return d.push(e.getName())})),n.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(Y.a)(e,i.getEntityName(),null==p?void 0:p.guid,null,d,null==h?void 0:h.guid,!1,a.parentContextToken))}if(Object(s.Kb)(l,e))return n.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(W.a)(e));if(p&&!o.a.equals(p,o.a.EMPTY))return n.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(B.e)(e,r));var g=Object(k.l)(t.getState(),e);return n.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(B.f)(e,g,u,r,!1,c))}},"Wye+":function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("Gemh"),a=r("Nhrb");var i=r("/j9Z"),o=r("9r0m"),s=r("G7N+"),c=r("olrR"),u=r("RlP9"),l=r("r2h9"),p=r("8Fmj"),d=r("cqI9"),h=r("7dGM"),g=r("lMVv"),m=r("JlqV"),f=r("z9yS"),v=r("uO/V"),b=r("Yc9S"),y=r("0rak");var _=r("zETL"),S=r("3IUl"),C=r("bc+P"),O=r("xm8q"),I=r("okRr"),P=r("U/bH"),j=r("cZkS"),T=r("qC0c"),E=r("VcAV");function F(e,t,r,F,x,w){return{type:"grid.refresh.async",execute:function(N,k){var M=N.dispatch,D=N.getState,R=k.TraceManager.getTracer(v.z),L=v.x+".refreshGridAction";try{var V=D(),B=o.a.tryParseOrNull(F);if(B){var G=w||(r?l.a.SUB_GRID:l.a.MAIN_APPLICATION_VIEW);return function(e,t,r,a,p,d,h,g){var f=Object(n.qb)(t,g,r);if(f&&f.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(f.offlineSqlQuery)))return Promise.resolve(g);var v=d||Object(n.F)(t,r,a,p),b=Object(u.f)(t,v,h),y=Object(u.f)(t,v,l.a.MAIN_APPLICATION_VIEW),_=b&&b[o.a.toString(g)]&&b[o.a.toString(g)].isUserView?l.b.userview:l.b.savedview;y&&y[o.a.toString(g)]&&y[o.a.toString(g)].isUserView&&(_=l.b.userview);return e(Object(c.a)(v,h,_,g)).then((function(e){if(!e)throw new i.a("View retrieval failed");return e}))}(M,V,e,t,r,x,G,B).then((function(i){R.info("Refreshing the grid with new view id - {0}"+B);var c=Object(n.T)(V,e,t);M(function(e,t,r,n){return Object(a.b)(e,t,"ViewId",r,n)}(e,r,F,t)),function(e,t,r,a,i,c,l,p,d){var h=function(e,t,r,a,i){return e||Object(n.F)(t,r,a,i)}(r,e,i,c,l),g=Object(n.qb)(e,a,i);if(g&&g.initialized===s.a.Initialized){var m=Object(u.f)(e,h,p),f=m&&m[o.a.toString(a)]&&m[o.a.toString(a)].isUserView;if(h===v.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){var b=[];b.push({name:"view.title",value:"View title doesn't contains value"}),b.push({name:"ViewId",value:"ViewId: "+a}),b.push({name:"View",value:A(g)}),b.push({name:"entityTypeName",value:h}),d.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",b)}var y={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:a,IsUserView:f,Title:g.title};t(Object(O.b)(y))}}(D(),M,x,i,e,t,r,G,k),Object(T.c)(D(),j.L)&&M(Object(P.b)(e,t)),x&&M(function(e,t,r,n){return Object(a.b)(e,t,"TargetEntityType",r,n)}(e,r,x,t)),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(C.b)(e,t,null));var E=[];if(x&&E.push({name:"entityName",value:x}),!Object(n.ib)(V,e,t))return k.EventManager.ReportComponentSuccess(L,E),Promise.resolve();M(function(e,t,r,a,i,s){return{type:"chart.refresh.async",execute:function(c,_){var S=c.dispatch,C=c.getState,O=v.x+".refreshChartAction",I=C();if(!r)return Promise.resolve();if(!Object(m.b)(I))return Promise.resolve();var P=Object(u.c)(I,r);if(!(i=P&&P.entityLogicalName?P.entityLogicalName:null))return Promise.resolve();if(s===l.a.QUICKFIND_SEARCH&&(S(Object(y.c)(e,t,[])),S(Object(b.c)(e,t,"{}"))),!o.a.equals(a,r)){S(Object(y.c)(e,t,[])),S(Object(b.c)(e,t,"{}"));var j=Object(n.r)(I,e,t,i),T=Object(h.a)(I,j),E=T&&T.PrimaryEntityTypeCode,F=E&&Object(g.m)(I,parseInt(E,10));if(F&&i!==F)return S(Object(p.a)(i,f.a.savedvisualization)).then((function(r){var n=o.a.toString(r);return n||(n=o.a.EMPTYGUIDSTRING),S(Object(d.b)(e,t,n)).then((function(){_.EventManager.ReportComponentSuccess(O)}))}))}return _.EventManager.ReportComponentSuccess(O),Promise.resolve()}}}(e,t,B,c,x,w)).then((function(){return M(Object(_.b)(e,t)),k.EventManager.ReportComponentSuccess(L,E),Promise.resolve()})).catch((function(e){return k.EventManager.ReportComponentFailure(L,Error(e)),Promise.resolve()}))}))}if(Object(n.v)(D(),e,t)){R.info("Refreshing the grid."),M(Object(_.b)(e,t)),M(Object(S.b)(e,t,[])),M(Object(C.b)(e,t,null));var X=[];x&&X.push({name:"entityName",value:x}),k.EventManager.ReportComponentSuccess(L,X)}return Promise.resolve()}catch(e){var q="Refresh action for grid failed";e&&e.message&&(q+="with the error message as : "+e.message),k.EventManager.ReportComponentFailure(L,Error(q))}}}}function A(e){if(!e)return"View is "+e;var t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},XJ3n:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,a=r("fW82"),i=r("9r0m"),o=r("+Z9T"),s=r("BWVO"),c=r("WVwd"),u=r("/zIU"),l=r("GueY"),p=r("Gemh"),d=r("IiPO"),h=r("mPpC"),g=r("ks02"),m=r("FoZz"),f=r("sOTk"),v=r("gLMt"),b=r("ezfI"),y=function(){function e(e,t,r,a,i,s){var c="ClientApi.XrmGridRow.constructor";e||Object(o.j)(c,"store"),a||Object(o.j)(c,"pageId"),r||Object(o.j)(c,"contextToken"),i||Object(o.j)(c,"entityType"),s||Object(o.j)(c,"entityId"),n=e,this._applicationContext=t,this._pageId=a,this._contextToken=r,this._entityType=i,this._entityId=s}return Object.defineProperty(e.prototype,"applicationContext",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e="ClientApi.XrmGridRow.context";try{return b.a.instance.reportCall(e),this._globalContext||(this._globalContext=new g.a(n,this._pageId)),b.a.instance.reportSuccess(e),this._globalContext}catch(r){var t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,r,null,t),r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var e=this,t="ClientApi.XrmGridRow.data";try{if(b.a.instance.reportCall(t),!this._data){var r=new s.a(n,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new c.a(n,this._contextToken,this._pageId,this,r);var a=new h.b(n,this._pageId),o=[],u={isEventParam:!0,name:"attributeName",value:""};o.push(u),r.attributes.forEach((function(r){var n=r.getName();u.value=n;var s={Id:n,Label:null,Name:n,ShowLabel:!1,Visible:!0,ClassId:new i.a(h.a),Disabled:!1,DataFieldName:n},c=a.createXrmControl(e._contextToken,s,e,t,o);c&&r.controls.add(c.getName(),c)}))}return b.a.instance.reportSuccess(t),this._data}catch(e){var l=d.a.getInstance().getEventParameters(this._contextToken);throw l.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,l),e}},enumerable:!1,configurable:!0}),e.prototype.getData=function(){try{return b.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){var e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}},Object.defineProperty(e.prototype,"ui",{get:function(){try{if(b.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){var e=new h.b(n,this._pageId);this._ui=new l.a(n,this._contextToken,this._pageId,this,this._entityType,e)}return b.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){var t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t="ClientApi.XrmGridRow.getControl";try{b.a.instance.reportCall(t);var r=this.ui.controls.get(e);return b.a.instance.reportSuccess(t),r}catch(e){var n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getAttribute=function(e){var t="ClientApi.XrmGridRow.getAttribute";try{if(b.a.instance.reportCall(t),this.data.entity){var r=this.data.entity.attributes.get(e);return b.a.instance.reportSuccess(t),r}return b.a.instance.reportSuccess(t),null}catch(e){var n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridRow.getUrl";try{b.a.instance.reportCall(t);var r=this.data.entity.getEntityReference();this._internal=new m.a(n,this._applicationContext,this.context,this._pageId);var o=Object(f.g)(n.getState(),this._pageId),s={entityTypeName:r.entityType,etn:r.name,id:i.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:o.recordSetQueryKey};if(1===e){var c=n.dispatch(Object(a.a)(u.a.EditForm,s));return b.a.instance.reportSuccess(t),c}var l=Object(v.a)(n,this._pageId),p=n.dispatch(Object(a.c)(l,u.a.EditForm,s));return b.a.instance.reportSuccess(t),p}catch(e){var h=d.a.getInstance().getEventParameters(this._contextToken);throw h.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,h),e}},Object.defineProperty(e.prototype,"entityReference",{get:function(){try{return this.data.entity.getEntityReference()}catch(t){var e=d.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}},enumerable:!1,configurable:!0}),e}();function _(e,t,r){var a=Object(p.D)(n.getState(),{id:r},t.parentContextToken);return a||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},XjtF:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a,i,o=r("EGsq"),s=r("cL6R"),c=r("KVkm"),u=r("WACO"),l=r("JlqV"),p=["JQUERY","JQUERY.JS"];function d(e){return{type:"customcontrol.loadresources",execute:function(t,r){var d=t.dispatch,h=t.getState,g=[],m=h(),f=Object(o.t)(m),v=e.Properties.Resources.filter((function(e,t,n){return(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==p.indexOf(e.LibraryName.toUpperCase())||r.AssetLoader.isResourceLoaded(f+e.Name))})).sort((function(e,t){return e.LoadOrder-t.LoadOrder})),b=e.Properties.Resources.filter((function(e,t,r){return 5===e.Type}));if(v.length>0){var y=void 0,_=function(){return function(e,t,r,a,i){for(var o=[],s=0;s<i.length;s++){var u=i[s],l=void 0,p=u.Name,d=r;if(n&&n[u.Name])d=window.__public_path__+"control",p=n[u.Name];else if(0===u.Type){var h=u.LibraryName+".js";n&&n[h]&&(d=window.__public_path__+"control",p=n[h])}switch(u.Type){case 0:case 4:l=a.loadWebResource(p,d,3,(function(t){return e(Object(c.a)(t))}),t,!1);break;case 1:l=l=a.loadWebResource(p,d,2,(function(t){return e(Object(c.a)(t))}),t);break;default:l=null}l&&o.push(l)}return Promise.all(o)}(d,!Object(l.b)(m),f,r.AssetLoader,v)};(y=!function(){null==i&&(i=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return i}()||n?_():function(){if(a)return a;if("/uclient/"!==window.__public_path__){if(!n){var e=window.__public_path__+"controlFileMap.json";(a=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise((function(t){var r=new XMLHttpRequest;r.addEventListener("load",(function(){var e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",(function(){t({})})),r.open("GET",e),r.send()})):fetch(e).then((function(e){return e.json()}),(function(){return Promise.resolve({})}))).then((function(e){n=e}),(function(){n={}}))}}else n={},a=Promise.resolve({});return a}().then(_,_))&&g.push(y)}for(var S=Object(u.k)(m),C=function(e){if(!S||!S.hasOwnProperty(b[e].Name)){var t=d(Object(s.c)(b[e].Name)).then((function(t){for(var r=!1,n=0,a=t;n<a.length;n++){var i=a[n];i&&i.webResourceDescriptorsByName&&i.webResourceDescriptorsByName.hasOwnProperty(b[e].Name)&&(r=!0)}!r&&d(Object(s.b)(b[e].Name))}));g.push(t)}},O=0;O<b.length;O++)C(O);return g.length>0?Promise.all(g):null},sync:!0}}},"Y+r4":function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n,a,i=r("c/eZ"),o=r("1z64"),s=r("fW82"),c=r("sOTk"),u=r("BWVO"),l=r("WVwd"),p=r("ezfI"),d=r("/zIU"),h=r("GueY"),g=r("HSdq"),m=r("3NtJ"),f=r("fTYK"),v=r("+Z9T"),b=r("IiPO"),y=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(i.__extends)(t,e),t.prototype.getDefaultNextPageName=function(){var e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{p.a.instance.reportCall(e);var t=Object(g.M)(n.getState(),this.pageId,this.contextToken);return p.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.movePrevious=function(){var e="ClientApi.XrmNavigableFormUi.movePrevious";try{p.a.instance.reportCall(e),n.dispatch(Object(f.b)(this.pageId,this.contextToken)),p.a.instance.reportSuccess(e)}catch(r){var t=b.a.getInstance().getEventParameters(this.contextToken);throw b.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.moveTo=function(e){var t,r="ClientApi.XrmNavigableFormUi.moveTo";try{if(p.a.instance.reportCall(r),e&&this.tabs){var a=Object(g.Gc)(n.getState(),this.pageId,e,this.contextToken);(t=this.tabs.get(null==a?void 0:a.Name))&&n.dispatch(Object(m.b)(this.pageId,this.contextToken,null==a?void 0:a.Id))}p.a.instance.reportSuccess(r)}catch(e){var i=b.a.getInstance().getEventParameters(this.contextToken);throw b.a.getInstance().reportFailure(r,e,null,i),e}t||Object(v.h)(r,"pageName",e)},Object.defineProperty(t.prototype,"taskProcess",{get:function(){return p.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this},enumerable:!1,configurable:!0}),t}(h.a),_=r("9r0m"),S=r("FoZz"),C=r("gLMt"),O=r("ZOZo"),I=r("WS0f"),P=function(e){function t(t,r,n,i,s){var c=this,u=[{name:"pageId",value:s,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return(c=e.call(this,t,r&&r.etn,i,s,(function(e){return 10===e||12===e?y:h.a}),n)||this)._clientApiExecutorForm=new o.a(t,"ClientApi.XrmForm.",s,i,u),a=t,c._entityReference=r,c}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"applicationContext",{get:function(){return this._applicationContext},set:function(e){this._applicationContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){try{return p.a.instance.reportCall("ClientApi.XrmForm.context"),p.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}},set:function(e){this._globalContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){var e=this;return this._clientApiExecutorForm.execute("entityReference_get",(function(){return{id:_.a.externalGuid(e._entityReference.id),entityType:e._entityReference.etn}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){try{if(p.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){var e=void 0,t=Object(c.l)(a.getState(),this.pageId);t!==d.a.Dialog&&t!==d.a.ModalDialog&&this._entityReference&&(e=new u.a(a,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,j,this._applicationContext)),this._data=new l.a(a,this.contextToken,this.pageId,this,e)}return p.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}},enumerable:!1,configurable:!0}),t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutorForm.execute("getAttribute",(function(){var r,n,a=null;return t.data&&t.data.entity&&(a=t.data.entity.attributes.get(e)),a?Object(I.a)(e)&&(a=a.concat(t.data.attributes.get(e))):a=null===(n=null===(r=t.data)||void 0===r?void 0:r.attributes)||void 0===n?void 0:n.get(e),a}))},t.prototype.getUrl=function(e){try{p.a.instance.reportCall("ClientApi.XrmForm.getUrl");var t=null,r=null;if(this.contextToken.parentContextToken){var n=this.data.entity.getEntityReference(),i={entityTypeName:n.entityType,etn:n.name,id:_.a.fromExternalGuid(n.id)};t=d.a.EditForm,r=i}else t=Object(c.l)(a.getState(),this.pageId),r=Object(c.g)(a.getState(),this.pageId);switch(t){case d.a.EditForm:var o=new S.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:o.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break;case d.a.Grid:o=new S.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:o.getEntityCode(r.entityTypeName)}}var u=null;if(1===e)u=a.dispatch(Object(s.a)(t,r));else{var l=Object(C.a)(a,this.pageId);u=a.dispatch(Object(s.c)(l,t,r))}return p.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),u}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}},t.prototype._reportFailure=function(e,t){var r=b.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),b.a.getInstance().reportFailure(e,t,null,r),t},t}(O.a);function j(e,t,r){var n=Object(g.bb)(a.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},YOvo:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.visibility";function a(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},Yc9S:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,r){return{type:"chart.filterexpression.update.async",execute:function(s,c){var u=s.dispatch,l=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".updateFilterExpressionAction";try{p.info("Updating the chart filter expression"),t||(t=Object(n.k)(l(),e));var h=Object(n.v)(t);return u(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var g="Updatation of the chart filter expression failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},YdIa:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.targets.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},ZOZo:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a=r("h82J"),i=r("HSdq"),o=r("1z64"),s=function(){function e(e,t,r,i,s,c){this._clientApiExecutor=new o.a(e,"ClientApi.XrmFormBase.",i,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),n=e,this.pageId=i,this.contextToken=r,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,n.dispatch(Object(a.a)(this,i,r))}return Object.defineProperty(e.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ui_get",(function(){if(!e._ui){var t={id:e.pageId},r=Object(i.fb)(n.getState(),t,e.contextToken),a=r&&r.FormType,o=e._getUiType(a);e._ui=new o(n,e.contextToken,e.pageId,e,e._entityName,e._xrmControlFactory)}return e._ui}))},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t=this,r=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",(function(){return t.ui.controls.get(e)}),r)},e}()},Zdrd:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationtype.update";function o(e,t,r){return{type:"chart.visualizationtype.update.async",execute:function(o,s){var c=o.dispatch,u=o.getState,l=s.TraceManager.getTracer(a.z),p=a.x+".updateVisualizationTypeAction";try{l.info("Update the chart visualization type"),t||(t=Object(n.k)(u(),e));var d=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,d,r)),s.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Update the chart visualization type failed with error : "+e.message;s.EventManager.ReportComponentFailure(p,Error(h))}}}}},aBa1:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("c/eZ"),a=r("AhDg"),i=r("9r0m"),o=r("lMVv"),s=r("gBKR"),c=r("7pqb"),u=r("t8f4"),l=r("r0s4"),p=c.b.AdvancedFindLookupResolverParameters;function d(e,t,r){var u=[];return{type:"advancedFind.lookup.retrieve.async",execute:function(l,d,h){var m=l.dispatch,f=l.getState,v=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);u.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:v.RequestId()},{name:p.PrimaryEntity,value:e},{name:p.Targets,value:t.join(",")});var b=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(b)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:p.EntityMetadataUnavailable,value:i}),a;var c='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or"><condition attribute="'+s.PrimaryNameAttribute+'" operator="like" value="%'+(t||"")+'%" /></filter></entity></fetch>',u=g(e,s,c,n);return a.push(u),a}}(m,r,f(),u),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return u},getFailureParameters:function(e,t){return u}}}function h(e,t,r){var u=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute:function(l,d,h){var m=l.dispatch,f=l.getState,v=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);u.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:v.RequestId()},{name:p.PrimaryEntity,value:e},{name:p.Targets,value:t.join(",")});var b=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(b)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:p.EntityMetadataUnavailable,value:i}),a;var c=t.filter((function(e){return!!e})).map((function(e){return'<condition attribute="'+s.PrimaryIdAttribute+'" operator="eq" value="'+e+'" />'})),u='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or">'+c+"</filter></entity></fetch>",l=g(e,s,u,n);return a.push(l),a}}(m,r,f(),u),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return u},getFailureParameters:function(e,t){return u}}}function g(e,t,r,n){var a="?fetchXml="+Object(l.CrmUrlEncode)(r);return new Promise((function(r,i){e(Object(u.e)(t.EntityLogicalName,a,100)).then((function(e){var a=function(e,t){var r=[];t.value&&t.value.length>0&&t.value.forEach((function(t){r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})}));return r}(t,e);n.push({name:p.RetrieveRequestSuccess,value:"Retrieve Seccuess for "+t.EntityLogicalName+" Count: "+a.length}),r(a)}),(function(e){n.push({name:p.RetrieveRequestFail,value:"Failed to retrieve records for "+t.EntityLogicalName+" Error: "+e}),r([])}))}))}},bCrZ:function(e,t,r){"use strict";r.d(t,"f",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return b}));var n=r("c/eZ"),a=r("9r0m"),i=r("Sscr"),o=r("uO/V"),s=r("nn4v"),c=r("Gemh"),u=r("cZkS"),l=r("qC0c"),p=r("U/bH"),d=r("jigW"),h="grid.initialize",g="grid.initialize.xrmready";function m(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute:function(n,a){var i=n.dispatch,s=(n.getState,o.x+".gridPreInitializedAction");try{i(v(null,e,t,r,void 0,void 0,void 0,void 0,null));var c=[{name:"entityTypeName",value:e}];return a.EventManager.ReportComponentSuccess(s,c),Promise.resolve(void 0)}catch(t){var u="Failed for "+e+" with error "+t.message;return a.EventManager.ReportComponentFailure(s,Error(u)),Promise.resolve(void 0)}}}}function f(e,t,r,a,i,d,h,g,m){return e?{type:"grid.initialize.async",execute:function(f,b){var y=f.dispatch,_=f.getState,S=o.x+".gridInitializedAction";try{var C=null;Object(l.c)(_(),u.zb)&&(C=function(e,t,r){var a=Object(c.v)(e,t,r),i=Object(n.__assign)({},s.a);return a&&(a.filters&&(i.filters=a.filters),a.customFilter&&(i.customFilter=a.customFilter),a.pageNumber&&(i.pageNumber=a.pageNumber),a.pagingRefreshInput&&(i.pagingRefreshInput=a.pagingRefreshInput)),i}(_(),r,a)),y(v(e,t,r,a,i,d,h,g,C,m));var O=[];return O.push({name:"entityTypeName",value:t}),b.EventManager.ReportComponentSuccess(S,O),Object(l.c)(_(),u.L)&&y(Object(p.b)(r,a)),Promise.resolve(void 0)}catch(e){var I="Grid initialized failed for entity type "+t;return b.EventManager.ReportComponentFailure(S,Error(I)),Promise.reject(void 0)}}}:null}function v(e,t,r,c,u,l,p,g,m,f){var v=u&&u.Parameters?u.Parameters[o.j]:null;try{var b=!0;v&&(b="true"===v);var y=Object(i.u)(c),_={contextKey:y,initialDataSetState:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},s.a),m),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:p,useRollupView:g||!1,commandManagerId:f||Object(d.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:e&&e.viewId?a.a.toString(e.viewId):null},1:{Name:o.j,Value:b},2:{Name:o.u,Value:t}}}}})};return{type:h,payload:_,meta:{pageId:r,contextKey:y}}}catch(e){throw Error(e)}}function b(e,t,r,c){var u=Object(i.u)(c),l=a.a.tryParseOrNull(t),p={contextKey:u,initialDataSetState:Object(n.__assign)(Object(n.__assign)({},s.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:t||null},1:{Name:o.j,Value:!1},2:{Name:o.u,Value:e}}}}})};return{type:h,payload:p,meta:{pageId:r,contextKey:u}}}function y(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},bH46:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("9r0m"),a=r("vYfn"),i=r("i8/j"),o=r("F2uj"),s=r("gBKR"),c=r("VWqI"),u=r("j6Db"),l=r("+Xnp"),p=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function d(e,t,r){return{type:"formandattribute.retrieve.async",execute:function(c,l){var d=c.dispatch,m=c.getState,f="Card"===r;return e.etn&&"activitypointer"===e.etn&&f?d(Object(s.f)("activitypointer",!1,p)).then((function(){for(var t=m(),r={},n=0,a=p;n<a.length;n++){var i=a[n],s=Object(o.a)(t,e.etn,i);s&&h(t,e.etn,i,s)&&(r[i]=s)}return g(t,e.etn,r,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}})):d(Object(a.b)(e,t,r)).then((function(a){var c={},p=null;return e.etn?d(Object(s.f)(e.etn,!0,[])).then((function(){var t=m();if(!n.a.isNullOrEmpty(a)&&(p=Object(i.j)(t,a))&&p.Attributes)for(var r in p.Attributes){var s=p.Attributes[r],u=Object(o.a)(t,e.etn,s);u&&h(t,e.etn,s,u)&&(c[s]=u)}return f&&g(t,e.etn,c,Object(o.d)(t,e.etn)),{formDescriptor:p,attributeDescriptors:c}})):(l.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:u.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)}),(function(e){var a=e.get_message();l.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:u.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])}))}}}function h(e,t,r,n){return Object(c.f)(e,t,r,l.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(var a in n){var i=n[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||r[a]||!h(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(r[a]=i)}}},bJYk:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("9r0m"),a=r("sOTk"),i=r("Z1aD"),o=r("KQ+A"),s=r("t8f4"),c=r("QAhb"),u=r("lMVv"),l=r("WS0f"),p=r("riBC"),d=r("7EJx"),h=r("JlqV"),g=r("HSdq"),m=r("YEEA");function f(e,t,r,c){var f=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute:function(b,y,_){var S=b.dispatch,C=b.getState,O=C();if(Object(g.Eb)(O,t))return Promise.reject(Object(m.b)(O,t,2200000016));var I=Object(a.g)(O,t),P=I.entityTypeName,j=I.id,T=I.recordSetQueryKey,E=I.data,F=I.createFromRelationship,A=I.initWithEntity;f.push({name:"entityTypeName",value:P});var x=n.a.tryParse(e),w={entityTypeName:P,formId:x,id:c?n.a.tryParse(c):j,recordSetQueryKey:T,data:E,createFromRelationship:F,initWithEntity:A},N=x.guid.toString(),k='<MRUForm><Form Type="Main" Id="'+N+'" /></MRUForm>',M=Object(p.c)(O,P);return S(Object(i.a)(r,w,t,{replaceState:!0})).then((function(e){var t,r;if(0===e.status)if(Object(h.b)(C()))null==M||M===n.a.EMPTY?function(e,t,r,a,i,c,p,h){var g=Object(u.p)(a,e),m=Object(d.q)(a),f="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",b=String.format(f,g.toString(),m.guid.toString());i(Object(s.e)("userentityuisettings",b)).then((function(d){d.value&&d.value.length>0&&(r=d.value[0].userentityuisettingsid?new n.a(d.value[0].userentityuisettingsid):n.a.EMPTY),Object(l.a)(r)||Object(l.a)(c)||Object(l.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,a,i,c,p){var d=n.a.EMPTY,h=Object(u.p)(r,e),g="userentityuisettings";a(Object(s.b)(g,{objecttypecode:h,lastviewedformxml:t})).then((function(t){if(d=t,!(Object(l.a)(d)||Object(l.a)(i)||Object(l.a)(e)||0===e.length||n.a.isNullOrEmpty(d))){var r=p.TraceManager.getTracer("Forms.FormSelectorChange"),s="Created an entry for selected form successfully formid : "+i;r.info(s),a(Object(o.b)(e,i,d))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(l.a)(i)||Object(l.a)(e)||0===e.length||a(Object(o.b)(e,i,d)),{};var r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+i;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),p.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)}))}(e,t,a,i,c,p,h):v(e,t,r,a,i,c,p,h)})).catch((function(t){if(-2147093999===t.errorCode)return Object(l.a)(c)||Object(l.a)(e)||0===e.length||i(Object(o.b)(e,c,r)),{};var n=[{name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}(P,k,M,C(),S,x,_,y):v(P,k,M,C(),S,x,_,y);else{Object(l.a)(x)||Object(l.a)(P)||0===P.length||S(Object(o.b)(P,x,M));var a=null===(t=null==y?void 0:y.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),i="Selected form did not save in the UserEntityUiSetting table, for formid: "+x;null==a||a.info(i)}else if(1===e.status){a=null===(r=null==y?void 0:y.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),i="Could not change to form with id "+N+" due to a navigation failure or because navigation was cancelled";null==a||a.info(i,f)}return e}))},getFailureParameters:function(e,t){return f}}}function v(e,t,r,a,i,u,p,d){var h=new c.a("userentityuisettings",r);i(Object(s.f)(h,{lastviewedformxml:t})).then((function(){if(!(Object(l.a)(r)||Object(l.a)(u)||Object(l.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){var t=d.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+u;t.info(a),i(Object(o.b)(e,u,r))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(l.a)(u)||Object(l.a)(e)||0===e.length||i(Object(o.b)(e,u,r)),{};var n=[{name:"CorrelationId",value:p.correlationId},{name:"ContextId",value:p.contextId},{name:"ActionStack",value:p.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+u;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}},c0jI:function(e,t,r){"use strict";r.d(t,"g",(function(){return _})),r.d(t,"i",(function(){return S})),r.d(t,"h",(function(){return C})),r.d(t,"e",(function(){return O})),r.d(t,"f",(function(){return I})),r.d(t,"a",(function(){return P})),r.d(t,"c",(function(){return T})),r.d(t,"b",(function(){return F})),r.d(t,"d",(function(){return j}));var n=r("c/eZ"),a=r("uO/V"),i=r("Gemh"),o=r("sOTk");function s(e,t,r,n){var a,i;return{type:"update.grid.configuration",payload:((a={})[t]=((i={})[r]=e,i),a),meta:{pageId:n}}}function c(e,t,r){var n;return{type:"update.views.configuration",payload:((n={})[t]=e,n),meta:{pageId:r}}}var u=r("RXRQ"),l=r("U0B9"),p=r("2OIc"),d=r("i8/j"),h=r("9r0m"),g=r("RlP9"),m=r("S2mk"),f=r("T2Xs"),v=r("j6Db"),b=r("OTOS");function y(e,t){var r=Object(n.__assign)({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){var a=!1;for(var i in e.CustomControls)if(P(e.CustomControls[i],e.CustomControls[t])&&i!==t.toString()){a=!0;break}if(!a){var o=-1;r[o]?o--:r[o.toString()]=e.CustomControls[t]}}return r[t]=null,r}function _(e,t,r,a,p){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(d,h){var g,m,b=d.dispatch,y=d.getState,_=y(),S=Object(l.b)(_),C=Object(i.k)(_,e,t),O={UniqueId:C?C.UniqueId:null,CustomControls:(g={},g[S]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:S}),g),FormLibraries:C?C.FormLibraries:null,EventHandlers:C?C.EventHandlers:null},I=Object(o.g)(_,e).entityTypeName;if(p){var P=Object(i.T)(_,e,t);b(c({UniqueId:null,CustomControls:(m={},m[S]=null,m),FormLibraries:null,EventHandlers:null},P.guid,e))}b(Object(u.c)(r.CustomControlId)).then((function(){b(s(O,I,a,e))}),(function(t){var n=Object(f.b)(y(),r.CustomControlId);h.EventManager.ReportComponentFailure(n+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:v.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:I},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:a},{name:"config",value:JSON.stringify(r)}])}))}}}function S(e,t,r,a,p){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(d){var h,m=d.dispatch,f=(0,d.getState)(),v=Object(l.b)(f),b=Object(i.T)(f,e,t),_=Object(g.d)(f,b),S={UniqueId:_?_.UniqueId:null,CustomControls:(h={},h[v]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:v}),h),FormLibraries:_?_.FormLibraries:null,EventHandlers:_?_.EventHandlers:null},C=Object(o.g)(f,e).entityTypeName;if(p){var O=Object(i.k)(f,e,t);if(O&&O.CustomControls&&O.CustomControls[v]){var I={UniqueId:O.UniqueId,CustomControls:y(O,v),FormLibraries:O.FormLibraries,EventHandlers:O.EventHandlers};m(s(I,C,a,e))}}m(Object(u.c)(r.CustomControlId)).then((function(){m(c(S,b.guid,e))}))}}}function C(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute:function(a){var i,o=a.dispatch,c=(0,a.getState)(),h=Object(l.b)(c),g=Object(b.b)(c,e),m=Object(d.b)(c,e,g,r),f=Object(p.b)(c,m.UniqueId,g);if(f&&f.CustomControls){var v={UniqueId:m.UniqueId,CustomControls:(i={},i[h]=Object(n.__assign)(Object(n.__assign)({},t),{FormFactor:h}),i),FormLibraries:f.FormLibraries,EventHandlers:f.EventHandlers};o(Object(u.c)(t.CustomControlId)).then((function(){o(s(v,g.guid,f.UniqueId,e))}))}}}}function O(e,t,r,a,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute:function(o){var c,p=o.dispatch,d=(0,o.getState)(),h=Object(l.b)(d),g={UniqueId:i.UniqueId,CustomControls:(c={},c[h]=Object(n.__assign)(Object(n.__assign)({},a),{FormFactor:h}),c),FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};p(Object(u.c)(a.CustomControlId)).then((function(){p(s(g,t,r,e))}))}}}function I(e,t,r,a,i,o,p){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute:function(d){var h,g=d.dispatch,m=(0,d.getState)(),f=Object(l.b)(m),v={UniqueId:o.UniqueId,CustomControls:(h={},h[f]=Object(n.__assign)(Object(n.__assign)({},i),{FormFactor:f}),h),FormLibraries:o.FormLibraries,EventHandlers:o.EventHandlers};if(p&&p.CustomControls&&p.CustomControls[f]){var b={UniqueId:p.UniqueId,CustomControls:y(p,f),FormLibraries:p.FormLibraries,EventHandlers:p.EventHandlers};g(s(b,t,r,e))}g(Object(u.c)(i.CustomControlId)).then((function(){g(c(v,a.guid,e))}))}}}function P(e,t){if(e&&t){var r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,a;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(var i in t)if(t[i]!==r[i]){if("function"==typeof t[i])continue;if(t[i]&&r[i]&&"object"==typeof t[i]&&"object"==typeof r[i]){if(e(t[i],r[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(n=t[i])||void 0===n?void 0:n.toString())===(null===(a=r[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(var n in e.Children)r=r&&P(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function j(e,t,r,n,a,i,o,s){var c=t?t.TraceManager.getTracer("customcontrol"):null;return e(T(r,n,i.configuration,i,i.contextString,s).map((function(e){return e.configuration.DisplayNameKey}))).catch((function(e){return c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()}))}function T(e,t,r,n,i,o){var s=[];if(null==o)return s;if(i===a.h.CUSTOM&&n.configuration.isDefaultConfig)return s;var c=i===a.h.GRID||i===a.h.ASSOCIATEDGRID?Object(m.u)(n&&n.controlId,n&&n.gridEntityTypeName,n&&h.a.toString(n.viewId)):Object(m.x)(n&&n.controlId,n&&n.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&E(s,e,"GRID_CONFIG"),t&&t.CustomControls&&E(s,t,"VIEW_CONFIG"),s}function E(e,t,r){for(var n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){for(var a=!1,i=0;i<e.length;i++)if(P(e[i].configuration,t.CustomControls[n])){a=!0;break}a||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function F(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},cQE4:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.cb)(e,t,r);return a?a.footer:null}},cm3g:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){this._value=null,this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}()},cqI9:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationid.update";function o(e,t,r){return{type:"chart.visualizationid.update.async",execute:function(o,s){var c=o.dispatch,u=o.getState,l=s.TraceManager.getTracer(a.z),p=a.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),t||(t=Object(n.k)(u(),e));var d=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,d,r)),s.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Updatation of the chart visualization id failed with error : "+e.message;s.EventManager.ReportComponentFailure(p,Error(h))}}}}},"d26+":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("jigW"),i=r("uO/V"),o="dataset.update.fetchxml";function s(e,t,r){return{type:"dataset.update.fetchxml.async",execute:function(s,c){var u=s.dispatch,l=(s.getState,c.TraceManager.getTracer(i.z)),p=i.x+".updateFetchXMLAction";try{l.info("Updating the fetch xml for the grid."),u(function(e,t,r){var a=Object(n.y)(t),i=Object(n.v)(t);return{type:o,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:i}}}(e,t,r));var d=Object(a.j)(r),h=[];return h.push({name:"fetchXML",value:d}),c.EventManager.ReportComponentSuccess(p,h),Promise.resolve()}catch(e){var g="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},e2rP:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.commandbarvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},"fH/t":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"j",(function(){return l})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return d})),r.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Grid_Paging_Mask",a="Grid_StatusMessage_Mask",i="Grid_ItemsSelected_Mask",o="Grid_TotalCount_Mask",s="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",u="Grid_ToolTip_NextPage",l="Grid_TotalCount_SpaceMask",p="Grid_TotalCount_Approximate",d="Grid_TotalCount_Exact",h=[n,a,i,o,s,c,u,l,p,d]},fTYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.tab.selectPrevious";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var r=Object(n.v)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:r}}}},gRWC:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="formSelector.visible";function a(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},grpZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("9r0m"),a=r("uQP8"),i=r("sOTk"),o=r("i8/j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r){var n;void 0===r&&(r=!1);var s=Object(i.g)(e,t).entityTypeName,c=Object(o.n)(e,s);if(!r)return c;var u=Object(a.a)(e,t),l=null===(n=null==u?void 0:u.formSelector)||void 0===n?void 0:n.forms,p=c;if(l&&Object.keys(l).length>0)for(var d in p=new Object,c)l[d]&&!l[d].visible||(p[d]=c[d]);return p}function c(e,t,r){var s,c,u=Object(a.a)(e,t),l=n.a.toString(r);if(null===(c=null===(s=null==u?void 0:u.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[l])return u.formSelector.forms[l].visible;var p=Object(i.g)(e,t).entityTypeName;return!!Object(o.m)(e,p,r)||null}function u(e,t){var r,n=Object(a.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},hE7j:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.setSrc";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},i6iy:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("cZkS"),a=r("9r0m"),i=r("Gemh"),o=r("qC0c"),s=r("Wye+"),c=r("UOiB"),u=r("olrR"),l=r("RlP9"),p=r("r2h9"),d=r("uO/V"),h=r("19Zc"),g=r("jigW");function m(e,t,r,m){return{type:"grid.quickfind.apply.async",execute:function(f,v){var b=f.dispatch,y=f.getState,_=v.TraceManager.getTracer(d.z),S=d.x+".QuickFilterAction";try{var C=y(),O=Object(i.F)(C,t,r,m);return function(e,t,r){return new Promise((function(n){var a=Object(l.a)(e,r,p.a.QUICKFIND_SEARCH);a?n(a):t(Object(u.a)(r,p.a.QUICKFIND_SEARCH,p.b.savedview)).then((function(e){n(e)}))}))}(C,b,O).then((function(u){_.info("Performing quick find on the grid ");var l=Object(i.T)(C,t,r,m),d=l,f=r.contextTokenType===c.a.SubGrid,O=!1;if(f&&r.controlName){var I=Object(i.hb)(y(),t,r,r.controlName);I&&(O=I.EnableViewPicker)}return Object(o.a)(y(),n.Nd)&&f&&!O||Object(g.l)(C)||(d=u),b(Object(h.n)(e,t,r)),b(Object(s.a)(t,r,m,a.a.toString(d),null,p.a.QUICKFIND_SEARCH)).then((function(){return v.EventManager.ReportComponentSuccess(S),l}))}))}catch(e){v.EventManager.ReportComponentFailure(S,Error("Unable to perform a quick find on the grid"))}}}}function f(e,t,r,n){return{type:"grid.quickfind.clear.async",execute:function(i,o){var c=i.dispatch,u=(i.getState,o.TraceManager.getTracer(d.z)),l=d.x+".QuickFilterAction";try{return u.info("Clearing quick find from the grid."),c(Object(h.n)("",t,r)),c(Object(s.a)(t,r,n,a.a.toString(e))).then((function(){o.EventManager.ReportComponentSuccess(l)}))}catch(e){o.EventManager.ReportComponentFailure(l,Error("Unable to clear quick find value for grid"))}}}}},ig6i:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}return Object.defineProperty(e.prototype,"etn",{get:function(){return this._etn},set:function(e){this._etn=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},set:function(e){this._attributeName=e},enumerable:!1,configurable:!0}),e}()},ixd0:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n,a=r("9r0m"),i=r("IiPO"),o=r("sOTk"),s=r("+Z9T"),c=r("ezfI"),u=r("bJYk"),l=r("gRWC"),p=r("grpZ"),d=function(){function e(e,t,r,a){this._id=e,this._label=t,n=r,this._pageId=a}return e.prototype.getId=function(){var e="ClientApi.XrmFormSelectorItem.getId";try{c.a.instance.reportCall(e);var t=a.a.toString(this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.getLabel=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label},e.prototype.getPageId=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId},e.prototype.setVisible=function(e){var t="ClientApi.XrmFormSelectorItem.setVisible";try{c.a.instance.reportCall(t),n.dispatch(Object(l.b)(this._pageId,a.a.toString(this._id),e)),c.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}},e.prototype.getVisible=function(){var e="ClientApi.XrmFormSelectorItem.getVisible";try{c.a.instance.reportCall(e);var t=Object(p.c)(n.getState(),this._pageId,this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.navigate=function(){var e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),c.a.instance.reportCall(e);var t=Object(o.g)(n.getState(),this._pageId),r=t&&t.id?t.id.guid:"",a=Object(o.l)(n.getState(),this._pageId);n.dispatch(Object(u.a)(this._id.guid,this._pageId,a,r)).then((function(){c.a.instance.reportSuccess(e)})).catch((function(t){return Object(s.d)(n,t,e+".changeForm")}))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e}()},ksD2:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var n=r("Sscr"),a=r("HSdq"),i=r("s0Zj"),o=r("ar+e"),s=r("B188"),c=r("4sax"),u=r("7pqb"),l=r("KzM6"),p="tab.visible";function d(e,t,r,d){return{type:"tab.visible.sync",sync:!0,execute:function(h,g){var m,f=h.dispatch,v=h.getState,b=v();f(function(e,t,r,a){var i=Object(n.v)(r);return{type:p,payload:a,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,r,d));var y=Object(a.wc)(b,{id:e},r),_=Object(o.e)(b,{id:e},r);if(y||(null==_?void 0:_.isSelected)||!d){if(y===t&&!d){var S=Object(a.fb)(b,{id:e},r),C=!1;if(S)for(var O=0,I=Object(a.m)(b,S);O<I.length;O++){var P=I[O];if(P.Id!==t&&Object(a.Kc)(b,P.Id,e,r)){C=!0,f(Object(i.b)(e,P.Id,r));break}}C||f(Object(i.b)(e,void 0,r))}}else f(Object(i.b)(e,t,r));if(Object(s.a)()){var j=v(),T=null===(m=null==g?void 0:g.TraceManager)||void 0===m?void 0:m.getTracer(""+u.k+u.r),E=Object(a.Kc)(b,t,e,r),F=Object(a.Kc)(j,t,e,r),A=Object(l.a)(j,e);A.push({name:"tabId",value:t}),A.push({name:"tabName",value:Object(a.Ic)(j,t,e,r)}),A.push({name:"tabLabel",value:Object(a.Hc)(j,t,e,r)}),A.push({name:"visible state before change",value:null==E?void 0:E.toString()}),A.push({name:"visible state after change",value:null==F?void 0:F.toString()}),A.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==T||T.warn(u.n,[{name:u.v,value:u.r+".visible"},{name:u.r,value:JSON.stringify(A)}])}}}}},lFQy:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("9r0m"),a=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){var r,i={dataById:(r={},r[n.a.toString(t.id)]=e,r)};return{type:a.a,payload:i}}},ll2N:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,a=r("c/eZ"),i=r("1z64"),o=r("FlW1"),s=r("HSdq"),c=r("Zy0S"),u=r("+Z9T"),l=r("JCHT"),p=r("OmYs"),d=r("IiPO"),h=r("ezfI"),g=r("kvLG"),m=function(e){function t(t,r,a,o,s,c){var u=e.call(this,t,r,a,o)||this;return u._parent=s,n=t,u._formContext=c,u._iConnectedSectionProp={sectionName:u.name,id:u.pageId},u._clientApiExecutorTabSection=new i.a(t,"ClientApi.XrmTabSection.",a,r),u.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),u}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorTabSection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){var e=this;return this.clientApiExecutor.execute("controls",(function(t,r){if(!e._controls){var a=n.getState();e._controls=new c.a(t);var i=e.getControlsDescriptor(a);if(!i)return e._controls;for(var o in i){var s=e._formContext.ui.controls.get(o);if(s)e._controls.add(s.getName(),s);else{var u=r.slice();u.push({name:"controlKey",value:o}),g.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",u)}}}return e._controls}))},enumerable:!1,configurable:!0}),t.prototype.getParent=function(){return h.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent},t.prototype.getVisible=function(){var e="ClientApi.XrmTabSection.getVisible";try{h.a.instance.reportCall(e);var t=Object(s.tc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(u.a)(t)?this._getSectionDescriptorValues().Visible:t;return h.a.instance.reportSuccess(e),r}catch(t){var a=d.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.getLabel=function(){var e="ClientApi.XrmTabSection.getLabel";try{h.a.instance.reportCall(e);var t=Object(s.rc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(u.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return h.a.instance.reportSuccess(e),r}catch(t){var a=d.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._getSectionDescriptorValues=function(){try{return Object(s.qc)(n.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){var e=d.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}},t.prototype.getControlsDescriptor=function(e){try{return Object(s.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){var t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTabSection.setVisible";try{h.a.instance.reportCall(t),n.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,!0===e)),h.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTabSection.setLabel";Object(u.a)(e)&&Object(u.j)(t,"label");try{h.a.instance.reportCall(t),n.dispatch(Object(p.b)(this.pageId,this.contextToken,this.name,e)),h.a.instance.reportSuccess(t)}catch(e){var r=d.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),d.a.getInstance().reportFailure(t,e,null,r),e}},t}(o.a)},lwSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.tabnavigatorvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},m8A1:function(e,t,r){"use strict";r.d(t,"d",(function(){return l})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("HSdq"),a=r("sOTk"),i=r("gk6Q"),o=r("kvLG"),s=r("b1hT"),c=r("QAhb"),u=r("j+yI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,r,i){if(void 0===i&&(i=!1),!e)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;var l=function(e,t){var r=Object(a.g)(e,t);if(!r)return null;var n=r.entityTypeName,i=r.id;return new c.a(n,i)}(e,t),p=!Object(n.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(i||!Object(u.d)(e,l,t)),d=g(t,e);return d.push({name:"xrmProcessControlClientApiIsSupported",value:p}),o.a.getInstance().eventManager.ReportComponentSuccess(r,d),p}function p(e,t,r,n){if(!e&&(o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),l(t.getState(),r,n))){o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));var s=Object(a.g)(t.getState(),r);return Object(i.b)(r,s)}return e}function d(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function h(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)}]}},mPpC:function(e,t,r){"use strict";r.d(t,"b",(function(){return Fe})),r.d(t,"a",(function(){return Ee}));var n,a,i,o,s,c,u,l,p,d,h,g=r("+l2M"),m=r("sOTk"),f=r("c/eZ"),v=r("YCDx"),b=r("HSdq"),y=r("x6Ak"),_=r("IiPO"),S=r("ezfI"),C=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(f.__extends)(t,e),t.prototype.refresh=function(){var e="ClientApi.XrmControlTimer.refresh";try{S.a.instance.reportCall(e),n.dispatch(Object(y.b)(this.pageId,this.contextToken,this.name)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getState=function(){var e="ClientApi.XrmControlTimer.getState";try{S.a.instance.reportCall(e);var t=Object(b.cb)(n.getState(),this.pageId,this.contextToken).controls[this.getName()].parameters.timerState;return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"},t}(v.a),O=r("Zz0a"),I=r("w/nD"),P=r("+Z9T"),j=r("gk6Q"),T=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c.registerObserversForControlStateChange(),c}return Object(f.__extends)(t,e),t.prototype.addOnClick=function(e){var t="ClientApi.XrmControlButton.addOnClick";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),a.dispatch(Object(I.b)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnClick=function(e){var t="ClientApi.XrmControlButton.removeOnClick";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),a.dispatch(Object(I.w)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(j.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t}(v.a),E=r("1z64"),F=r("hE7j"),A=r("EGsq"),x=r("WACO"),w=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;i=t;var u=[{name:"controlName",value:o,isEventParam:!0}];return c._clientApiExecutorWebResource=new E.a(t,"ClientApi.XrmControlWebResource.",n,r,u),c}return Object(f.__extends)(t,e),t.prototype.getSrc=function(){var e=this;return this._clientApiExecutorWebResource.execute("getSrc",(function(){var t=i.getState(),r=Object(A.t)(t)+Object(b.wb)(t,{controlName:e.name,id:e.pageId},e.contextToken);return Object(x.c)(t,e.pageId,e.name,e.contextToken,r)}))},t.prototype.getContentWindow=function(){var e=this;return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(function(t,r){var n=e.formContext.applicationContext.TraceManager.getTracer(t),a=function(){var t=Object(b.xb)(i.getState(),e.pageId,e.getName());if(t){var a=null;try{return"complete"===(a=t.contentWindow).document.readyState?Promise.resolve(a):(r.push({name:"readyState",value:a.document.readyState}),n.info("Frame content window not ready",r),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(e){return a?(r.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",r),Promise.resolve(a)):Promise.reject(e)}}else n.info("Frame DOM element not ready",r);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then((function(e){return Promise.resolve(e)})).catch((function(t){if(111!==t.errorCode)return Promise.reject(t);var o=e.contextToken,s=e.pageId,c=e.getName();return new Promise((function(e,t){var u=function(){Object(I.G)(o,s,u,c),a().then((function(t){e(t)})).catch((function(a){a.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",r),e(a.contentWindow)):t&&(111===a.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",r),t(new Error("Frame element could not be found."))):t(a))}))};i.dispatch(Object(I.l)(o,s,u,c))}))}))}))},t.prototype.getObject=function(){var e=this;return this._clientApiExecutorWebResource.execute("getObject",(function(){return Object(b.xb)(i.getState(),e.pageId,e.name)}))},t.prototype.setSrc=function(e){var t=this;return this._clientApiExecutorWebResource.execute("getControlType",(function(){Object(P.a)(e)||i.dispatch(Object(F.b)(t.pageId,t.name,t.contextToken,e))}))},t.prototype.getControlType=function(){return this._clientApiExecutorWebResource.execute("getControlType",(function(){return"webresource"}))},t.prototype.addOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",(function(){i.dispatch(Object(I.l)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t.prototype.removeOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",(function(){i.dispatch(Object(I.G)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t}(v.a),N=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(f.__extends)(t,e),t.prototype.getInitialUrl=function(){var e="ClientApi.XrmControlIFrame.getInitialUrl";try{S.a.instance.reportCall(e);var t=Object(b.sb)(o.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"},t.prototype.getSrc=function(){var e="ClientApi.XrmControlIFrame.getSrc";try{S.a.instance.reportCall(e);var t=o.getState(),r=this.getInitialUrl(),n=Object(x.c)(t,this.pageId,this.name,this.contextToken,r);return S.a.instance.reportSuccess(e),n}catch(t){var a=_.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,a),t}},t}(w),k=r("+P1Q"),M=r("Q60c"),D=r("slAZ"),R=r("AVer"),L=r("QItn"),V=r("9r0m"),B=r("YdIa"),G=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c._clientApiExecutorLookup=new E.a(t,"ClientApi.XrmControlLookup.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),c}return Object(f.__extends)(t,e),t.prototype.addCustomView=function(e,t,r,n,a,i){var o=this;this._clientApiExecutorLookup.execute("addCustomView",(function(c,u){var l=V.a.tryParseOrNull(e);l||Object(P.k)(c,"guid","viewId",u),s.dispatch(Object(R.a)(o.pageId,o.name,l,t,o.contextToken,r,n,a)),i&&o.setDefaultView(e)}),[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])},t.prototype.addCustomFilter=function(e,t){var r="ClientApi.XrmControlLookup.addCustomFilter";Object(P.a)(e)&&Object(P.j)(r,"fetchXmlFilter"),Object(P.b)(e)||Object(P.l)(r);try{S.a.instance.reportCall(r),s.dispatch(Object(D.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(r)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(r,e,null,n),e}},Object.defineProperty(t.prototype,"disableMru",{get:function(){var e="ClientApi.XrmControlLookup.getDisableMru";try{S.a.instance.reportCall(e);var t=Object(b.x)(s.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},set:function(e){var t="ClientApi.XrmControlLookup.setDisableMru";try{S.a.instance.reportCall(t),s.dispatch(Object(L.b)(s.getState(),this.pageId,this.name,this.contextToken,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},enumerable:!1,configurable:!0}),t.prototype.startCustomFilter=function(){var e="ClientApi.XrmControlLookup.startCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.endCustomFilter=function(){var e="ClientApi.XrmControlLookup.endCustomFilter";try{S.a.instance.reportCall(e),s.dispatch(Object(D.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getDefaultView=function(){var e=this;return this._clientApiExecutorLookup.execute("getDefaultView",(function(){var t=Object(b.O)(s.getState(),e.pageId,e.name,e.contextToken);return t?V.a.externalGuid(new V.a(t)):null}))},t.prototype.setDefaultView=function(e){var t=this;this._clientApiExecutorLookup.execute("setDefaultView",(function(r,n){var a=V.a.tryParseOrNull(e);a||Object(P.k)(r,"guid","id",n),s.dispatch(Object(M.b)(t.pageId,t.name,t.contextToken,a))}),[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])},t.prototype.addOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.g)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.addPreSearch=function(e){var t="ClientApi.XrmControlLookup.addPreSearch";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.t)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.B)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removePreSearch=function(e){var t="ClientApi.XrmControlLookup.removePreSearch";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),s.dispatch(Object(I.O)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"},t.prototype.getEntityTypes=function(){var e="ClientApi.XrmControlLookup.getEntityTypes";try{S.a.instance.reportCall(e);var t=Object(b.Ob)(s.getState(),this.pageId,this.contextToken,this._dataFieldName);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setEntityTypes=function(e){var t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(P.j)(t,"entityTypes");var r=[];try{S.a.instance.reportCall(t),e=Array.from(new Set(e));var n=Object(b.Pb)(s.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};n.forEach((function(e){a[e]=!0})),e.forEach((function(e){a[e]||r.push(e)}))}catch(e){throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t+".validation",e,null,i),e}r.length>0&&Object(P.h)(t,"entityType",r[0]);try{s.dispatch(Object(B.b)(this.pageId,this.contextToken,this._dataFieldName,e)),S.a.instance.reportSuccess(t)}catch(e){var i;throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,i),e}},Object.defineProperty(t.prototype,"_dataFieldName",{get:function(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name},enumerable:!1,configurable:!0}),t}(k.a),X=r("JFej"),q=r("Ini7"),U=r("FGem"),z=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;c=t;var u=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return s._clientApiExecutorOptionsetBase=new E.a(t,"ClientApi.XrmControlOptionSetBase.",n,r,u),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){var r=this;this._clientApiExecutorOptionsetBase.execute("addOption",(function(){var n=r._options.length;Object(P.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,c.dispatch(Object(X.b)(r.pageId,r.contextToken,r.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))}),[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])},t.prototype.clearOptions=function(){var e=this;this._clientApiExecutorOptionsetBase.execute("clearOptions",(function(){c.dispatch(Object(U.b)(e.pageId,e.contextToken,e.controlDescriptor.DataFieldName))}))},t.prototype.removeOption=function(e){var t=this;return this._clientApiExecutorOptionsetBase.execute("removeOption",(function(){c.dispatch(Object(q.b)(t.pageId,t.contextToken,t.controlDescriptor.DataFieldName,e))}),[{name:"value",value:e,isRequired:!0}])},t.prototype.getOptions=function(){var e=this;return this._clientApiExecutorOptionsetBase.execute("getOptions",(function(){return e._options}))},Object.defineProperty(t.prototype,"_options",{get:function(){var e=new Array,t=Object(b.B)(c.getState(),this.pageId,this.contextToken,this.name);if(t)for(var r in t.length&&e.push({text:"",value:NaN}),t)e.push({text:t[r].Label,value:t[r].Value});return e},enumerable:!1,configurable:!0}),t}(k.a),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"},t}(z),H=r("ABRM"),Y=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._isDateFormatDateTime=!1,u=t,s._clientApiExecutorDateTime=new E.a(t,"ClientApi.XrmControlDateTime.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s._clientApiExecutorDateTime.execute("constructor",(function(e,t){s._isDateFormatDateTime=s._getShowTime(e,t)}),null,!1),s}return Object(f.__extends)(t,e),t.prototype.getShowTime=function(){var e=this;return this._clientApiExecutorDateTime.execute("getShowTime",(function(t,r){return e._getShowTime(t,r)}))},t.prototype.setShowTime=function(e){var t=this;this._clientApiExecutorDateTime.execute("setShowTime",(function(r,n){if(t._getShowTime(r,n)!==e){var a=e&&t._isDateFormatDateTime?"datetime":"date";u.dispatch(Object(H.b)(t.pageId,t.contextToken,t.name,a))}}))},t.prototype._getShowTime=function(e,t){var r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format},t}(k.a),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"},t}(z),K=r("455M"),J=r("Dlr/"),Z=r("Sscr"),$=r("7bez"),ee=r("h82J"),te=r("Gemh"),re=function(e){function t(t,r,n,a,i){var o=e.call(this,t,r,n,a,a.Name,i)||this,s=Object(Z.e)(r,a.Name);return t.dispatch(Object(ee.a)(o,n,s)),l=t,o._clientApiExecutorControlstream=new E.a(t,"ClientApi.XrmControlStream.",n,r),o}return Object(f.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorControlstream},enumerable:!1,configurable:!0}),t.prototype._getGridControls=function(){if(!this._underlyingGridControls){this._underlyingGridControls=[];var e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){var t=e.StreamObjectCollection;if(t)for(var r=t.ShowAsTiles?[!0,!1]:[!0],n=0,a=t;n<a.length;n++)for(var i=a[n],o=0,s=r;o<s.length;o++){var c=s[o],u=Object(Z.o)(this.contextToken,this.getName(),i.Id,c),p=new $.a(l,u,this.pageId,!1,3,!0,this.formContext.applicationContext,u.controlName);this._underlyingGridControls.push({contextToken:u,gridControl:p})}}}return this._underlyingGridControls},t.prototype.refresh=function(){var e=this;this.clientApiExecutor.execute("refresh",(function(){for(var t=[],r=0,n=e._getGridControls();r<n.length;r++){var a=n[r],i=a.contextToken,o=a.gridControl;if(Object(te.hb)(l.getState(),e.pageId,i,i.controlName))try{o.refresh()}catch(e){t.push(e)}}if(t.length>0){var s=Object(f.__spreadArrays)(_.a.getInstance().getEventParameters(e.contextToken),[{name:"count",value:t.length}]);Object(P.e)(e.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,s)}}))},t}(v.a),ne=r("QAhb"),ae=r("TV33"),ie=r("Y+r4"),oe=r("ks02"),se=r("uQP8"),ce=r("6JRL"),ue=r("kvLG"),le=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,a.Name,i)||this;return p=t,s._clientApiExecutor=new E.a(t,"ClientApi.XrmControlSubFormBase.",n,r,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),s._xrmControlFactory=o,s}return Object(f.__extends)(t,e),t.prototype.getParentComponent=function(){return Object(se.a)(p.getState(),this.pageId)},Object.defineProperty(t.prototype,"context",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",(function(){return e._form?e._form.context:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentFormContext",{get:function(){return this.formContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_form",{get:function(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ce.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);var e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;var t=this._getValueInternal(),r=Object(ae.d)(t);return e?(this._formInstance=p.dispatch(Object(ee.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=p.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new V.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance):(_.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),ue.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null)},enumerable:!1,configurable:!0}),t.prototype._createXrmForm=function(e,t,r,n){var a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute:function(i,o){var s=new ie.a(i,{etn:r,id:n},a,e,t);s.applicationContext=o;var c=new oe.a(i,t);return s.context=c,s}}},Object.defineProperty(t.prototype,"_subFormControlContextToken",{get:function(){var e=this._getValueInternal(),t=Object(ae.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&p.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(p.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",(function(){return e._form?e._form.data:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",(function(){return e._form?e._form.ui:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){return S.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null},enumerable:!1,configurable:!0}),t.prototype.getControl=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",(function(){return t._form?t._form.getControl(e):null}))},t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",(function(){return t._form?t._form.getAttribute(e):null}))},t.prototype.getUrl=function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",(function(){return e._form?e._form.getUrl():null}))},t.prototype.refresh=function(){var e=this;this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",(function(){e.data&&e.data.refresh()}))},t.prototype._getValueInternal=function(){var e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new ne.a(e,new V.a(t)):new ne.a(e),n=Object(b.ac)(p.getState(),this._subFormInstanceId,this.contextToken);return Object(b.X)(p.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)},t}(v.a),pe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return d=t,s}return Object(f.__extends)(t,e),t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.l)(this.contextToken,this.name,this._entityType)},t.prototype.getSubFormInstanceId=function(){return this.pageId},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._tryGetSubFormInstanceId=function(){},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this.pageId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e="ClientApi.XrmControlQuickForm.isLoaded";try{S.a.instance.reportCall(e);var t=Object(b.ic)(d.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return S.a.instance.reportSuccess(e),!!t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"},t}(le),de=function(e){function t(t,r,n,a,i,o){var s;return t||Object(P.j)("ClientApi.XrmStandardDataControl.constructor","store"),s=e.call(this,t,r,n,a,i,o)||this,h=t,s}return Object(f.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmStandardDataControl.getValue";try{S.a.instance.reportCall(e);var t=Object(b.F)(h.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return S.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.e)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(P.j)(t,"handler");try{S.a.instance.reportCall(t),h.dispatch(Object(I.z)(this.contextToken,this.pageId,this.name,e)),S.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.fireOnKeyPress=function(){var e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{S.a.instance.reportCall(e),h.dispatch(Object(I.R)(this.contextToken,this.pageId,this.name,this)),S.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,r,null,t),r}},t}(k.a),he=r("1PXy"),ge=r("lRv2"),me=r("QUnS"),fe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(P.i)(e,"DependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(P.i)(e,"DependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(P.i)(e,"DependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(P.i)(e,"DependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(P.i)(e,"DependentOptionSet.setVisible",t)}))},t}(W),ve=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(P.i)(e,"MultiSelectDependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(P.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(P.i)(e,"MultiSelectDependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(P.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(P.i)(e,"MultiSelectDependentOptionSet.setVisible",t)}))},t}(Q),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.setDisabled=function(e){var t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";S.a.instance.reportUsage(t),Object(P.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))},t}(de),ye=r("F2uj"),_e=r("cZkS"),Se=r("qC0c"),Ce=r("2OIc"),Oe=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Ie,Pe,je=function(e){function t(t,r,n,a,i,o){var s,c,u=e.call(this,t,r,n,a,i,o)||this;return u._formInstanceId=null===(c=null===(s=u.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===c?void 0:c.formInstanceIdByControlName[u.controlDescriptor.Name],u._formComponentClientApiExecutor=new E.a(t,"ClientApi.XrmControlFormComponent.",u._formInstanceId),u._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),Ie=t,u}return Object(f.__extends)(t,e),t.prototype._tryGetSubFormInstanceId=function(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.h)(r)},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this._formInstanceId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e=this;return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",(function(){return!!Object(b.yc)(Ie.getState(),e._subFormInstanceId,e._subFormControlContextToken)}))},t.prototype.setInitializationIntent=function(e){var t=this;void 0===e&&(e="fullload"),this._formComponentClientApiExecutor.execute("setInitializationIntent",(function(r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o,s;"nothing"!==e&&"fullload"!==e&&Object(P.h)(r,e,"intent"),Ie.dispatch((n=t.pageId,a=t.name,i=t.contextToken,o=e,s=Object(Z.v)(i),{type:Oe.d,payload:o,meta:{pageId:n,controlName:a,contextKey:s}}))}),[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])},t.prototype.getControlType=function(){return S.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"},t}(le),Te=r("HHlV"),Ee="3d180de6-b456-4d90-9d5a-9899936baf44",Fe=function(){function e(e,t){this._pageId=t,Pe=e}return e.prototype.createXrmControl=function(e,t,r,n,a){Object(P.g)(t,n,"control");try{a.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),a.push({name:"controlName",value:t?t.Name:""}),a.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),a.push({name:"pageId",value:this._pageId});var i=Object(m.l)(Pe.getState(),this._pageId);a.push({name:"pageType",value:i});var o=!1,s=null,c=this._getControlType(t,r,e,n,a);switch(c){case g.i.guid:s=new T(Pe,e,this._pageId,t,t.Name,r);break;case K.a.KbContent:case K.a.KbArticle:case g.C.guid:case g.I.guid:s=new N(Pe,e,this._pageId,t,t.Name,r);break;case K.a.LookupRegarding:case K.a.LookupCustomer:case K.a.LookupMultiEntity:case K.a.LookupOwner:case K.a.LookupSimple:case K.a.LookupPartyList:case g.M.guid:case g.fb.guid:case g.S.guid:case g.l.guid:if(Object(Se.c)(Pe.getState(),_e.jb)){var u=Object(se.b)(Pe.getState(),this._pageId,e);if(Object(Ce.c)(Pe.getState(),t.UniqueId,u)===Te.d){s=new je(Pe,e,this._pageId,t,r,this);break}}s=new G(Pe,e,this._pageId,t,t.Name,r);break;case K.a.OptionSet:case g.U.guid:if(1==Object(Se.c)(Pe.getState(),_e.L)){var l=this._getEntityNameForControl(t,r);if(Object(ye.l)(Pe.getState(),l,t.DataFieldName)){s=new fe(Pe,e,this._pageId,t,t.Name,r);break}}case K.a.EntityNameOptionSet:case K.a.TwoOptions:case K.a.StatusOptionSet:case g.sb.guid:case g.K.guid:case g.W.guid:case g.V.guid:case g.hb.guid:case g.n.guid:case g.N.guid:s=new W(Pe,e,this._pageId,t,t.Name,r);break;case K.a.MultiSelectPicklist:case g.Q.guid:if(Object(Se.c)(Pe.getState(),_e.L)){l=this._getEntityNameForControl(t,r);if(Object(ye.l)(Pe.getState(),l,t.DataFieldName)){s=new ve(Pe,e,this._pageId,t,t.Name,r);break}}s=new Q(Pe,e,this._pageId,t,t.Name,r);break;case K.a.QuickForm:case g.cb.guid:case g.ab.guid:case g.Z.guid:var p=new pe(Pe,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,p);break;case K.a.SearchWidget:case K.a.ReferencePanelSearchWidget:case g.db.guid:case g.kb.guid:s=new O.a(Pe,e,this._pageId,t,t.Name,r);break;case K.a.TimelineWall:case g.qb.guid:(s=Pe.dispatch(Object(ee.f)(this._pageId,Object(Z.p)(e,t.Name))))||(s=new he.a(Pe,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case K.a.DateAndTimeDateOnly:case K.a.DateAndTimeDateAndTime:case g.q.guid:s=new Y(Pe,e,this._pageId,t,t.Name,r);break;case K.a.Grid:case g.eb.guid:case g.E.guid:var d=Object(Z.p)(e,t.Name),h=Pe.dispatch(Object(ee.c)(this._pageId,d));h&&(h.getName||3!==h.getGridType()?s=h:(_.a.getInstance().reportFailure(n,new Error("Main grid found in cache - converting to a subgrid."),null,a),Pe.dispatch(Object(ee.h)(this._pageId,d)))),s||(s=new J.a(Pe,e,this._pageId,t.Name,Object(te.wb)(Pe.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case K.a.Timer:case g.rb.guid:s=new C(Pe,e,this._pageId,t,t.Name,r);break;case K.a.WebResourceHtmlControl:case g.ub.guid:case g.vb.guid:s=new w(Pe,e,this._pageId,t,t.Name,r);break;case g.mb.guid:s=new re(Pe,e,this._pageId,t,r);break;case g.z.guid:case g.G.guid:break;case Ee:if(Object(Se.c)(Pe.getState(),_e.L)&&Object(ye.l)(Pe.getState(),e.entityTypeName,t.Name)){s=new be(Pe,e,this._pageId,t,t.Name,r);break}case K.a.AppliedFilters:case K.a.BusinessProcessFlow:case K.a.Card:case K.a.Currency:case K.a.Dashboard:case K.a.Decimal:case K.a.EmailEngagementActions:case K.a.EmailEngagementRecipientActivity:case K.a.FP:case K.a.GlobalFilter:case K.a.MicrosoftFlow:case K.a.Multiple:case K.a.PowerBI:case K.a.ReferencePanel:case K.a.Search:case K.a.SingleLineAddress:case K.a.SingleLineEmail:case K.a.SingleLinePhone:case K.a.SingleLineText:case K.a.SingleLineTextArea:case K.a.SingleLineTickerSymbol:case K.a.SingleLineURL:case K.a.SocialInsightsControl:case K.a.WholeDuration:case K.a.WholeLanguage:case K.a.WholeNone:case K.a.WholeTimeZone:case g.a.guid:case g.b.guid:case g.c.guid:case g.d.guid:case g.e.guid:case g.f.guid:case g.g.guid:case g.h.guid:case g.j.guid:case g.k.guid:case g.m.guid:case g.p.guid:case g.r.guid:case g.s.guid:case g.t.guid:case g.u.guid:case g.v.guid:case g.w.guid:case g.x.guid:case g.y.guid:case g.A.guid:case g.B.guid:case g.D.guid:case g.H.guid:case g.J.guid:case g.L.guid:case g.O.guid:case g.P.guid:case g.R.guid:case g.T.guid:case g.X.guid:case g.Y.guid:case g.bb.guid:case g.gb.guid:case g.ib.guid:case g.jb.guid:case g.lb.guid:case g.mb.guid:case g.nb.guid:case g.ob.guid:case g.pb.guid:case g.tb.guid:case g.wb.guid:o=!0;default:s=t.DataFieldName?new de(Pe,e,this._pageId,t,t.Name,r):new v.a(Pe,e,this._pageId,t,t.Name,r),o||(a.push({name:"controlType",value:c}),ue.a.getInstance().traceManager.getTracer(n).error("Unknown Form Control",a))}return s}catch(e){return _.a.getInstance().reportFailure(n+".createXrmControl",e,null,a),null}},e.prototype._getControlType=function(e,t,r,n,a){if(V.a.equals(e.ClassId,g.o)){var i=this._getCustomControlType(e,t,r);return i||ue.a.getInstance().traceManager.getTracer(n+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:i}),i}return e.ClassId.guid},e.prototype._getCustomControlType=function(e,t,r){var n,a,i,o=Object(se.b)(Pe.getState(),this._pageId,r),s=Object(ge.c)(Pe.getState(),e,o);if(!s){var c=Object(b.h)(),u=(null===(a=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===a?void 0:a.getEntityName())||"",l=c(Pe.getState(),e,this._pageId,o,u);if(l||(l=Object(me.a)(Pe.getState(),e,this._pageId,r)),null==l?void 0:l.Parameters)for(var p in l.Parameters)if(null===(i=l.Parameters[p])||void 0===i?void 0:i.Primary){s=l.Parameters[p].Type;break}}return s},e.prototype._getEntityNameForControl=function(e,t){var r="";if(e.Relationship)r=Object(b.T)(Pe.getState(),this._pageId,e.Relationship);else{var n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r},e}()},mVnn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},"n+eO":function(e,t,r){"use strict";r.d(t,"a",(function(){return A}));var n=r("r0tX"),a=r("9r0m"),i=r("WS0f"),o=r("9rlF"),s=r("nbQV"),c=r("TCcM"),u=r("T576"),l=r("QAhb"),p=r("A/RO"),d=r("Kdvm"),h=r("4HtA"),g=r("r3Bs"),m=r("LdMy"),f=r("sOTk"),v=r("mLFd"),b=r("G7N+"),y=r("ed60"),_=r("uwKl"),S=r("DUDQ"),C=r("lFQy"),O=r("gk6Q"),I=r("HSdq"),P=r("pflg"),j=r("b1hT"),T=r("lMVv"),E=r("2ojE"),F=r("LhJP"),A=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e,Object(O.c)(e._instance)),e._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t,n){var a=this;return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=n,this._processManager=new h.a(e,t,n,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new d.a,this._businessProcessFlowWrapperFactory=new p.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),r.e(49).then(r.bind(null,"pG8E")).then((function(e){var t=e.BusinessProcessPageWrapper;return a._businessProcessPerPageWrapper=new t(a._applicationContext,a._getState,a._dispatch),Promise.resolve()})))},e.prototype.getBusinessProcessFlowWrapper=function(e,t){return Object(j.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))},e.prototype.getProcessManager=function(e,t){return Object(j.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)},e.prototype.getCurrentProcessManagerWithoutInit=function(e){if(!Object(j.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);var t=Object(f.g)(this._getState(),e),r=t&&t.entityTypeName?new l.a(t.entityTypeName,t.id):null,n=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(E.a)(this._getState(),r,e,this._applicationContext);return n.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null},e.prototype.hasChanged=function(e,t,r,n){if(!Object(j.f)(this._getState())){if(Object(j.g)(e)&&(!Object(j.d)(e)||Object(j.c)(e,n)))return!0;if(!t)return!1;var a=new l.a(t.entityTypeName,t.id),o=Object(u.f)(e,a);return!Object(i.a)(o)&&(!r||o>r.instanceModifiedTimestamp)||this._needsDockedModeRefresh(r,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,r,n)},e.prototype._needsDockedModeRefresh=function(e,t){return this._processManager.getDisplayState()===n.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)},e.prototype._reloadData=function(e,t){var r=this,n=this._getState();this._pageId=e,this._pageInfo=t;var p=Object(f.g)(n,e);if(p){var d=p.id,h=new l.a(p.entityTypeName,d);if(this._processIdInState=Object(c.e)(n,h),Object(j.g)(n)&&(!Object(j.d)(n)||Object(j.c)(n,e))){var g=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(E.c)(F.e,g,this._applicationContext)}var m=Object(P.a)(p),v=Object(P.b)(p);if(a.a.equals(h.id,a.a.EMPTY)&&m&&v){var O=Object(s.b)(n,m),I=new l.a(O.businessProcessFlowUniqueName,v),A=Object(u.b)(n,I);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(A,p),void this._processManager.initilaizeWithProcessAndFormEntity(A,O,h,m,I,e)}if(this._processIdInState){O=Object(s.b)(n,this._processIdInState);if(!Object(i.a)(O)&&Object(b.b)(O.initialized)){I=new l.a(O.businessProcessFlowUniqueName,Object(c.f)(n,h)),A=Object(u.b)(n,I);if(a.a.equals(h.id,a.a.EMPTY)){var x=Object(j.b)(O);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(C.a)(null,I))),x&&x.stage&&x.stage.stageId){var w=Object(j.a)(x);return this._dispatch(Object(S.b)(I,w)),void this._processManager.initilaizeWithProcessAndFormEntity(w.fields,O,h,this._processIdInState,I,e)}}else if(Object(i.a)(A))return;var N=Object(T.h)(n,h.etn);if(N&&N.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(A,O,h,this._processIdInState,I,e);for(var k in A)if(Object(o.k)(A[k])&&A[k].reference&&A[k].reference.id&&A[k].reference.etn===h.etn&&(a.a.equals(A[k].reference.id,h.id)||a.a.equals(A[k].reference.id,a.a.EMPTY))&&Object(j.e)(k))return void this._processManager.initilaizeWithProcessAndFormEntity(A,O,h,this._processIdInState,I,e);var M=this._dispatch(Object(y.b)(a.a.EMPTY,h)),D=this._dispatch(Object(_.b)(a.a.EMPTY,h));Promise.all([M,D]).then((function(t){r._processManager.initilaizeWithFormEntityOnly(h,e)}))}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}},e.prototype._reloadDataIfRequired=function(e,t){var r=this._getState(),n=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=n;var i=null,o=!1;if(n&&(i=Object(c.b)(n)(r,n.etn))&&(o=i.refreshGlobalNavigationData),!Object(j.g)(r)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(j.g)(r)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(v.b)(!1,n)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){var s=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),u=this._processManager.getTelemetryParams();s.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",u)}this._reloadDataCount++}else this._reloadDataCount=0},e.prototype._hasProcessChanged=function(e){var t=this._processIdInState||a.a.EMPTY,r=this._getState(),n=new l.a(e.entityTypeName,e.id),i=Object(f.g)(r,this._pageId),o=Object(P.a)(i),u=a.a.equals(n.id,a.a.EMPTY)&&o?o:Object(c.e)(r,n)||a.a.EMPTY;if(!a.a.equals(u,t))return!0;if(a.a.equals(u,a.a.EMPTY))return!1;var p=Object(s.b)(r,u);return!!p&&this._processManager.getVersion()<p.businessProcessFlowProcessVersion},e.prototype._moveToNextStageForCrossEntityBPF=function(e,t){var r=e.activestageid,n=e.traversedpath,i=t.data.nextStageId;if(!i){var o=Object(P.a)(t),s=Object(P.b)(t);if(!a.a.equals(o,this._processManager.getProcessId())||!a.a.equals(s,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}a.a.equals(r.reference.id,new a.a(i))||(r.reference=new l.a("processstage",new a.a(i)),n.value=n.value+","+i,e.activestagestartedon.value=new Date)},e}()},nIt0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("uO/V"),i=r("uQP8"),o="control.update.formlessControlOutputs";function s(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute:function(s,c){var u=s.dispatch,l=s.getState,p=c.TraceManager.getTracer(a.z),d=a.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();var h=l(),g=Object(i.a)(h,e),m=Object(n.__assign)({},g.formlessControlOutputs),f=!1;for(var v in p.info("Updating the unbound output."),r){var b=r[v],y=t+"."+v;m[y]!==b&&(m[y]=b,f=!0)}return f&&u(function(e,t){return{type:o,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,m)),c.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var _="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(_))}}}}},nn4v:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},"o0+l":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.submitmode";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},oY7N:function(e,t,r){"use strict";r.d(t,"a",(function(){return Wt}));var n=r("c/eZ"),a=r("nuS9"),i=r("4fxQ"),o=r("D9ys"),s=r("4E+q"),c=r("YWpA"),u=r("hPFj"),l=r("H/hG"),p=r("e9UD"),d=r("znb3"),h=r("NJzV"),g=r("VnpK"),m=r("POU9"),f=r("vP/5"),v=r("0u+G"),b=r("uO/V"),y=2/(1+Math.sqrt(5)),_=function(e){function t(t){var r=e.call(this,t)||this;return r._memorizedDescriptor=null,r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0,height:0},r}return Object(n.__extends)(t,e),t.prototype._getGoldenRatioHeight=function(e){return y*e},t.prototype.onMeasuring=function(e,t){var r=!1,n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)},t.prototype.render=function(){var e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});var t,r,n=parseFloat(getComputedStyle(document.documentElement).fontSize),i=this._getTopAndBottomAdjustment(n),o=this._getLeftAndRightAdjustment(n);this.props.isLayoutVertical?(t=this.state.width-o,r=this._getGoldenRatioHeight(t),this.props.style.minHeight=r+i):(t=Math.max(this.state.width,320)-o,r=this.state.height-i);var s={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},u={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return a.createElement(c.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},a.createElement(c.a,{key:"pageChart_"+this.props.id+"_container",style:s},a.createElement(h.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:u,parentContextToken:this.props.contextToken})))},t.prototype._closeChartPane=function(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)},t.prototype._getTopAndBottomAdjustment=function(e){var t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t},t.prototype._getLeftAndRightAdjustment=function(e){var t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t},t}(a.Component),S=r("9r0m"),C=r("ah4O"),O=r("RlP9"),I=r("r2h9"),P=r("RB3d"),j=r("perk"),T=r("Gemh"),E=r("pWlk"),F=r("olrR"),A=r("mGpW"),x=r("Ww2r"),w=r("gBKR"),N=r("lMVv"),k=r("G7N+"),M=r("hXUt"),D=r("5Fed"),R=r("Ev4I"),L=r("JlqV"),V=r("pJ3X"),B=r("oVzJ"),G=r("cZkS"),X=r("qC0c"),q=r("PMTb"),U=[],z=function(e){function t(t){var r=e.call(this,t)||this;return r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onChange=r._onChange.bind(r),r.props.entityTypeName.toLowerCase()===T.a&&(r.props.loadAllActivityTypes(t.activities),r.props.loadAllActivityResourceString()),r}return Object(n.__extends)(t,e),t.prototype._getEntityTypeNameFromViewId=function(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null},t.prototype._onChange=function(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new S.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===T.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)},t.prototype._isViewSelectorHidden=function(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)},t.prototype.render=function(){var e=Object(x.c)(this.props.resourceStrings,j.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===b.h.GRID,r=t?this._onItemIconPointerDown:null,n=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,i=n?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,o=n?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,s=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.z):null;if(this._isViewSelectorHidden())return s&&s.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;var c=[],u=!1;for(var l in this.props.gridViewSelectorItems){var p=this.props.gridViewSelectorItems[l];if(p){var h=p.isUserView;h&&(u=!0);var g=void 0;if(this.props.entityTypeName===T.a&&this.props.pinnedActivityView){var m=p;g=m.isPinned&&this.props.pinnedActivityView.PinnedEntity===m.relatedEntityName}else g=p.isPinned;var f=t?g?d.a.Pinned:d.a.Pin:null,v={":hover":{"::before":{content:g?'""':'""'}}};this.props.useViewSelectorV2&&Object.assign(v,{marginLeft:"8px",marginRight:"8px"});var y=t?v:null,_=Object(x.c)(this.props.resourceStrings,j.VIEWSELECTOR_DEFAULTVIEW),S=Object(x.c)(this.props.resourceStrings,j.VIEWSELECTOR_SETDEFAULTVIEW),O=t?g?_:S:null,E="";E=this.props.entityTypeName===T.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(U.indexOf(p.relatedEntityName)+1).toString():h?I.b.userview.toString():I.b.savedview.toString();var F=p.name;l===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?F="*"+F:F+="*"),c.push({value:l,text:F,categoryId:E,iconType:f,iconTitle:O,iconStyle:y})}}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){var A=Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:A,categoryId:I.b.savedview.toString()})}var w=u?this.props.viewCategories:this.props.viewCategories.filter((function(e){return e.id!==I.b.userview.toString()}));return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?a.createElement(V.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?a.createElement(q.a,null,"New view"):a.createElement(V.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?a.createElement(q.a,{style:i},"New view"):a.createElement(C.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:w,options:c,style:this.props.style,caretType:d.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:i,viewSelectorStyle:o,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:P.a,createKeyboardShortcut:P.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})},t.prototype.componentDidMount=function(){var e=this;if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),!this._isViewSelectorHidden()){var t=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(t=!0),!t){if(this.props.viewIds)this.props.viewIds.find((function(t){return t.guid===e.props.selectedViewId}))&&(t=!0);this.props.defaultViewId&&this.props.defaultViewId.guid!==S.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}},t.prototype._onItemIconPointerDown=function(e){var t=this,r=e,n=e.iconType===d.a.Pinned,a=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(b.z):null,i=e.categoryId,o=this.props.entityTypeName;if(this.props.entityTypeName===T.a){var s=this.props.gridViewSelectorItems;o=s&&s[e.value]?s[e.value].relatedEntityName:o,i=!(!s||!s[e.value])&&s[e.value].isUserView?I.b.userview.toString():I.b.savedview.toString()}a&&a.info("Toggle the the pin status for "+e.value+" for "+o+" entity"),this.props.onItemIconPointerDown(o,e.value,i,"",n).then((function(){if(a&&a.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&t.props.entityTypeName===T.a){var i=t.props.gridViewSelectorItems[r.value];t.props.pinnedActivityView.PinnedEntity=i.relatedEntityName,t.props.pinnedActivityView.ViewId=new S.a(e.value),t.props.pinnedActivityView.ViewType=i.isUserView?I.b.userview:I.b.savedview}for(var o in t.props.gridViewSelectorItems)t.props.gridViewSelectorItems[o].isPinned=o===r.value&&!n;t.forceUpdate()}),(function(e){a&&a.error("Could not pin the selected view, pinning action failed with error "+e)}))},t}(a.Component);function W(e,t,r,n){var a=[];if(t===T.a&&n){var i=1;U.forEach((function(t){a.push({id:i.toString(),name:Object(N.f)(e,t)}),i++}))}else a=Object(T.mb)(e,r);return a}function H(e,t,r){var a;return t.forEach((function(t,i){var o=function(e,t,r){var n=Object(O.f)(e,t,r);n&&!Object(L.b)(e)&&Object(R.l)(e,t)&&(n=Object.keys(n).reduce((function(a,i){return(n[i].isAvailableInOffline||i===S.a.toString(Object(O.a)(e,t,r)))&&(a[i]=n[i]),a}),{}));return n}(e,r,t);o&&(a=Object(n.__assign)(Object(n.__assign)({},a),o))})),a}z.displayName="DataSetViewSelector";var Y=Object(s.a)((function(){var e=null,t=null,r=null,a={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null},i=Object(E.a)(),o=Object(x.h)();return function(s,c){var u,l=o(s,j.labelList),p=S.a.toString(Object(O.a)(s,c.entityTypeName,I.a.QUICKFIND_SEARCH)),d=null,h=null,g=i(s,c.contextString);U=Object(T.B)(s);var m=!1;if(c.queryViewSelectorTypes&&c.queryViewSelectorTypes.length>0&&!c.viewIds){if(c.entityTypeName===T.a&&c.shouldDisplayNestedViewSelector?(U.forEach((function(e){var t=H(s,c.queryViewSelectorTypes,e);t&&(d=Object(n.__assign)(Object(n.__assign)({},d),t))})),h=Object(x.e)(s,["ViewSelectorAllActivities"])):d=H(s,c.queryViewSelectorTypes,c.entityTypeName),e)for(var f in d)if(!e[f]||e[f]!==d[f]){m=!0;break}}else if(c.viewIds){for(var v={},b=0;b<c.viewIds.length;b++){var y=Object(T.qb)(s,c.viewIds[b],c.id);if(y&&y.grid&&y.grid.rows){var _=e?e[y.viewId.guid]:void 0,C=!_||_.name!==y.title||_.queryType!==y.queryType;f=C?{name:y.title,queryType:y.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:y.isUserView}:_;Object.assign(v,((u={})[y.viewId.guid]=f,u)),m=m||C}}v&&(d=v)}return!d||e&&Object.keys(e).length===Object.keys(d).length||(m=!0),h&&a.allActivitiesString!==h.ViewSelectorAllActivities&&(m=!0),t!==p&&(m=!0),r!==g&&(m=!0),m&&(t=p,r=g,a={gridViewSelectorItems:e=d,viewCategories:W(s,c.entityTypeName,j,c.shouldDisplayNestedViewSelector),allActivitiesString:h&&h.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:l,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(B.b)(s),useViewSelectorV2:Object(X.a)(s,G.le,G.h)}),a}}),(function(e){return{loadViewsByType:function(t,r,n){var a=[];return t.forEach((function(t,i){t===I.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||a.push(e(Object(F.a)(r,t,void 0,void 0)))})),Promise.all(a)},loadAllActivityResourceString:function(){return e(Object(A.e)(["ViewSelectorAllActivities"]))},loadAllActivityTypes:function(t){var r=null;for(var n in t)t[n].Initialized!==k.a.Initialized&&(r||(r={}),r[n]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(w.e)(r)):Promise.resolve()},loadGridViewsByViewId:function(t,r){var n=[];return t.forEach((function(t,a){n.push(e(Object(F.a)(r,void 0,void 0,t)))})),Promise.all(n)},openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))(z),Q=r("6Tlt"),K=r("Wg6j"),J=r("XIN1"),Z=r("r7Ib"),$=r("Md8f"),ee=r("5olG"),te=r("c96h"),re=42,ne=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={commandbarWidth:0},r._lastCommandManagerId=t.commandManagerId,r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){var t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object(ee.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object(ee.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?re:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})},t.prototype.componentDidUpdate=function(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))},t.prototype._renderConsoleAppBackButton=function(){return this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.pageId}):null},t.prototype._renderNativeSubgridCommandBar=function(){return this.props.isNativeMode?a.createElement(V.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null},t.prototype.render=function(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;var e=!this.state.commandbarWidth,t=a.createElement(Q.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:K.a.IconLabel,key:this.props.pageId,iconPosition:J.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:a.createElement(c.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())},t}(a.Component);ne.displayName="DataSetCommandBar";var ae=Object(s.a)((function(){return function(e,t){var r=Object(B.b)(e);return{commandManagerId:Object(T.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(te.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:function(t,r,n){t&&r&&n&&e(Object(Z.b)(t,r,n))}}}))(ne),ie=r("A6np"),oe=r("jigW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){var t=e.split(":");if(2===t.length)return t[1].split(",")}return[]}function ce(e){if(e&&e.filterOptions&&e.filterOptions.length>0){var t=e.filterOptions.filter((function(e){return e.isDefault})),r=e.userSetting,n=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];n&&""!==n.QueueId&&(t=e.filterOptions.filter((function(e){return Object(T.bb)(n.QueueId).sort().join(",")===se(e.value).sort().join(",")})));var i=void 0,o=void 0;e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=Object(oe.f)(e.filterOptions,e.previousValue),o=e.previousValue),i||(t.length>0?(i=t[0].text,o=t[0].value):(i=e.filterOptions[0].text,o=e.filterOptions[0].value)),e.updateFilterValue(o);var s=Object(x.c)(e.resourceStrings,j.QUEUE_FILTER_LABEL),u=a.createElement(ie.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:s,accessibilityLabel:s,defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:P.a,style:e.comboBoxStyle,createKeyboardShortcut:P.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return a.createElement(c.a,{key:"GridFilterView",style:e.style},u)}var l=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(b.z):null;return l&&l.info("Queue Filter not rendered because there are no filter options available"),null}var ue=r("np0M"),le=r("Oiu5"),pe={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},de={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function he(e,t){if(!e.isRollupViewSupported)return null;var r,i,o,s,c=function(e){var t=[];if(!Array.isArray(e))return t;for(var r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(x.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_OFF),Object(x.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_ON)]),u=e.isOffline,l=(r=e.toggleValue,i=t,o=e.onToggleChange,s=c,Object(n.__assign)(Object(n.__assign)({},de),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:r?1:0,Attributes:{DefaultValue:0,Options:s,DisplayName:i},Callback:o}}})),p=function(e,t){return Object(n.__assign)(Object(n.__assign)({},pe),{Label:e,Disabled:t})}(t,u),d="rollup_view_switch_"+e.id;return a.createElement(h.c,{key:d,controlId:d,id:e.id,systemDefinedProperties:null,descriptor:p,configuration:l,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ge(e,t,r,n,i){var o=e.theme,s=e.isRTL,u=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return a.createElement(c.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},a.createElement(c.a,{key:"ActivityDueDateFilterView",style:u?e.activityTypeContainerStyle:e.containerStyle},[t,r]),i?a.createElement(c.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[n,i]):null,function(e,t,r,n){if(!t)return;var i=Object(x.c)(e.resourceStrings,j.ROLLUPVIEW_SWITCH_LABEL),o={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},s={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:n?0:r.sizes.Measures.Measure100,marginLeft:n?r.sizes.Measures.Measure100:0};return a.createElement(c.a,{key:"RollupViewControlContainer",style:o},a.createElement(c.a,{key:"rollupViewFilterLabelView",style:s},i),he(e,i))}(e,e.isRollupViewSupported,o,s))}var me=Object(s.a)(void 0,(function(e){return{openPopup:function(t){return e(Object(D.a)(t))},closePopup:function(t){return e(Object(M.a)(t))}}}))((function(e){var t,n=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(b.z):null,i="",o=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){var s=e.filterOptions.filter((function(e){return e.isDefault}));o&&(t=Object(le.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=o?e.previousValue:Object(oe.f)(e.filterOptions,e.previousValue)),i||(i=s.length>0?o?s[0].value:s[0].text:o?e.filterOptions[0].value:e.filterOptions[0].text)}var u=a.useState(i),p=u[0],d=u[1];if(e&&e.filterOptions&&e.filterOptions.length>0){var h=o?Object(x.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(x.c)(e.resourceStrings,e.entityFilterLabelResourceString),g=null;h&&(g=a.createElement(l.a,{key:"activityDueDateFilterLabel",style:o?e.activityMgmtLabelStyle:e.labelStyle}," ",h," "));var m=a.createElement(c.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},g),f=a.createElement(ie.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:P.a,style:e.comboBoxStyle,textStyle:{flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},createKeyboardShortcut:P.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:h,freeTextMode:!0,suppressFreeTextChangeCallback:!0});if(o&&(f=a.createElement(ue.a,{key:"activityDueDateFilterComboBox",loader:function(){return Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(29),r.e(91)]).then(r.bind(null,"YDph")).then((function(e){return e.ComboBox}))},props:{selectedKey:p,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:t,onChange:function(t,r){d(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:h,useComboBoxAsMenuWidth:!0,allowFreeform:!0}})),e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===b.a){var v=null,y=Object(x.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);y&&(v=a.createElement(l.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",y," "));var _=a.createElement(c.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},v),S=void 0;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){n&&n.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);var C=Object(le.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){var O=Object(x.c)(e.resourceStrings,j.ACTIVITYTYPE_SELECTALL),I=[];I.push({key:"selectAllKey",text:O}),C=I.concat(C)}var T=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(T=Object(le.b)(e.activityTypePreviousValues)),S=a.createElement(ue.a,{key:"activityTypeFilterBox",loader:function(){return Promise.all([r.e(10),r.e(29),r.e(41)]).then(r.bind(null,"x3Jg")).then((function(e){return e.ActivityTypeCombobox}))},props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:T,onActivityTypeFilterClear:function(){e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:function(t){e.onActivityTypeChange(t)},options:C,ariaLabel:y,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return ge(e,m,f,_,S)}return ge(e,m,f,null,null)}return n&&n.info("Activity Filter not rendered because there are no filter options available"),null})),fe=r("lU69"),ve=r("gvL4"),be=r("Smta"),ye=r("vTeb"),_e=r("evW+"),Se=r("1AYO"),Ce=r("19Zc"),Oe=r("wV3W"),Ie=r("vO+w");var Pe=r("rbxJ"),je=r("9rQ4"),Te=r("hl8w"),Ee=r("akzq"),Fe=r("Wi7Z"),Ae=r("B73A"),xe=r("E705"),we=r("YT7W"),Ne=r("TCzx"),ke=function(e){function t(t){var r=e.call(this,t)||this;return r._cachedSelectedFilter="",r._onFilterChange=r._onFilterChange.bind(r),r._toggleJumpBarFlyout=r._toggleJumpBarFlyout.bind(r),r._closeJumpBarDomId="close-jumpbar-"+Object(fe.a)(),r._selectedFilterDomId="selected-filter-"+Object(fe.a)(),r.state={isFlyoutOpened:!1},r}return Object(n.__extends)(t,e),t.prototype._onOutsideClickHandler=function(e,t){var r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()},t.prototype.keyDownHandler=function(e){switch(e.EVENT.keyCode){case je.a.Escape:this._setIsFlyoutOpenedState(!1)}},t.prototype._toggleJumpBarFlyout=function(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)},t.prototype._setIsFlyoutOpenedState=function(e){this.setState({isFlyoutOpened:e}),Object(xe.g)(e)},t.prototype._filterGrid=function(e){var t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){var n=e.getAttribute("data-value").toUpperCase();n!==r&&(r=r+"|"+n)}t=this.props.dataSetFetchXml?Object(Te.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Te.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)},t.prototype._onFilterChange=function(e){var t=e.target,r=e;("click"===e.type||r&&r.keyCode===je.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))},t.prototype._renderListItem=function(e,t,r){var i=Object(n.__assign)({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),o=Object(n.__assign)(Object(n.__assign)({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(i=Object.assign(i,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),o=Object.assign(o,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),a.createElement(be.a,Object(n.__assign)({},r,{style:i}),a.createElement(ye.a,Object(n.__assign)({},e,{style:o}),t))},t.prototype._createKeyboardShortcuts=function(){var e=Object(x.c)(this.props.resourceStrings,j.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new Ae.a([je.a.Escape],t,!0,"",e);return r.push(n),r},t.prototype._renderJumpBarAlphabet=function(){var e=this,t=[],r=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET),n=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_INDICATOR),a=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_NUMBER_TOOLTIP),i=Ne.a.getInstance(),o=!!i&&i.get_IsIOS();return r.split(",").forEach((function(r){var i=Object(Pe.h)(r),s=i[0],c=i[1],u=s+"_listItem",l=s+"_link",p={id:u,key:u,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,c),role:Fe.q,onClick:e._onFilterChange,onKeyDown:e._onFilterChange,tabIndex:-1},d={id:l,key:l,testhooks:{id:l},tabIndex:-1,role:Fe.r,accessibilityHidden:!o,accessibilityLabel:o?String.format(j.FILTERBY_ARIALABEL,c):void 0};s===n&&(d.title=a,d.accessibilityLabel=j.NUMBER_ARIALABEL),e.props.selectedFilter!==s&&e.props.selectedFilter!==c||(p.describedByElementId=e._selectedFilterDomId,p.isSelected=!0,p.tabIndex=0),c&&(p.dataValue=c),t.push(e._renderListItem(d,s,p))})),t},t.prototype._renderJumpBarAll=function(){var e=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_ALL),t=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";var r=e+"_link",n=Ne.a.getInstance(),a=!!n&&n.get_IsIOS(),i={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:Fe.q,tabIndex:-1,accessibilityLabel:String.format(j.FILTERBY_ARIALABEL,e)},o={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:Fe.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(j.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(i.describedByElementId=this._selectedFilterDomId,i.isSelected=!0,i.tabIndex=0),this._renderListItem(o,e,i)},t.prototype._renderList=function(){var e=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE);return a.createElement(ve.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:Fe.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object(n.__assign)(Object(n.__assign)({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:j.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())},t.prototype._onJumpbarKeyDown=function(e){var t=e.target;if(this.state.isFlyoutOpened){var r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();(i=t.previousElementSibling)?i.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();(a=t.nextElementSibling)&&a.focus()}return}}if(e.keyCode===je.a.UpArrow||e.keyCode===je.a.DownArrow||e.keyCode===je.a.LeftArrow||e.keyCode===je.a.RightArrow){e.stopPropagation(),e.preventDefault();var a,i,o=e.keyCode===je.a.DownArrow||e.keyCode===je.a.RightArrow,s=e.keyCode===je.a.UpArrow||e.keyCode===je.a.LeftArrow;if(o)return void((a=t.nextElementSibling)&&a.focus());if(s)return void((i=t.previousElementSibling)&&i.focus())}},t.prototype._renderJumpBarFlyout=function(e,t){var r="jumpbar-flyout_"+this.props.id,n=r+"Accessibility",i=[];return i.push(a.createElement(Ee.a,{key:n,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),a.createElement(c.a,{role:Fe.e},a.createElement(Se.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Se.b.upleft:Se.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},a.createElement(_e.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:j.CLOSE_JUMPBAR_ARIALABEL},a.createElement(l.a,{style:this.props.styles.closeButtonTextStyle},a.createElement(J.b,{type:d.a.Close}))),this._renderList()),i)},t.prototype._renderFlyoutButton=function(e){for(var t=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_LETTER_TITLE),r=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET).split(","),n="",i=0;i<3;i++){n+=Object(Pe.h)(r[i+1])[0]}return a.createElement(_e.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},a.createElement(l.a,{style:this.props.styles.jumpBarButtonTextStyle},n))},t.prototype.render=function(){try{if(this.props.resourceStrings){var e="jumpBarRoot_"+this.props.id,t=e+"_"+this.props.uniqueId,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),n={position:"relative"};this.props.renderMobile&&Object.assign(n,{maxWidth:"100%"});var i={height:"0",width:"0"},o="flyoutRelativeElement"+this.props.controlKey;return a.createElement(c.a,{id:t,key:t,testhooks:{id:e},style:n},this.props.isRTL?null:a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,o):null,a.createElement(c.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},j.SELECTEDFILTER_TEXT),this.props.isRTL?a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}},t}(a.Component);var Me=Object(s.a)((function(){var e,t,r=null,n=null,a=null,i=Object(x.h)(),o=(e=null,t=null,function(r,n){var a,i,o,s,c,u,l,p,d,h,g,m,f,v,b,y,_,S,C,O,I,P,j,T,E,F,A,x,w,N,k,M,D,R,L=Object(Oe.a)(r),V=Object(Ie.b)(r)&&Object(X.a)(r,G.Fb,G.Lc)&&(null===(a=Object(Ie.a)(r))||void 0===a?void 0:a.Components)?Object(Ie.a)(r).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(s=null===(o=null===(i=null==V?void 0:V.Grid)||void 0===i?void 0:i.Footer)||void 0===o?void 0:o.JumpBar)||void 0===s?void 0:s.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(l=null===(u=null===(c=null==V?void 0:V.Grid)||void 0===c?void 0:c.Footer)||void 0===u?void 0:u.JumpBar)||void 0===l?void 0:l.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(d=null===(p=null==V?void 0:V.Grid)||void 0===p?void 0:p.Footer)||void 0===d?void 0:d.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(f=null===(m=null===(g=null==V?void 0:V.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===f?void 0:f.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(y=null===(b=null===(v=null==V?void 0:V.Grid)||void 0===v?void 0:v.Footer)||void 0===b?void 0:b.JumpBar)||void 0===y?void 0:y.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(C=null===(S=null===(_=null==V?void 0:V.Grid)||void 0===_?void 0:_.Footer)||void 0===S?void 0:S.JumpBar)||void 0===C?void 0:C.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(P=null===(I=null===(O=null==V?void 0:V.Grid)||void 0===O?void 0:O.Footer)||void 0===I?void 0:I.JumpBar)||void 0===P?void 0:P.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(E=null===(T=null===(j=null==V?void 0:V.Grid)||void 0===j?void 0:j.Footer)||void 0===T?void 0:T.JumpBar)||void 0===E?void 0:E.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(A=null===(F=null==V?void 0:V.Grid)||void 0===F?void 0:F.Footer)||void 0===A?void 0:A.JumpBar)||void 0===x?void 0:x.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(k=null===(N=null===(w=null==V?void 0:V.Grid)||void 0===w?void 0:w.Footer)||void 0===N?void 0:N.JumpBar)||void 0===k?void 0:k.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(D=null===(M=null==V?void 0:V.Grid)||void 0===M?void 0:M.Footer)||void 0===D?void 0:D.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e});return function(e,t){var s=o(e,t);if(null===r&&(r=Object(N.E)(e,t.entityTypeName)),null==n&&(n=e.metadata.attributes[t.entityTypeName]),Object(X.a)(e,G.ac)){var c=Object(T.v)(e,t.id,t.contextToken);a=c&&c.fetchXml}return{resourceStrings:i(e,j.labelList),primaryNameAttribute:r,dataSetFetchXml:a,entityAttributeMetadata:n,styles:s}}}),(function(e,t){return{applyGridFilter:function(r,n,a){if(e(Object(Ce.m)(r,t.id,a)),e(Object(we.b)(t.id,a,1)),n){var i=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(i,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(ke),De=r("fH/t");var Re=r("4Q7K"),Le=r("3IUl"),Ve=r("bc+P"),Be=r("+6eZ"),Ge=r("Baft"),Xe=r("zETL"),qe=r("r0s4"),Ue=function(e){function t(t){var r=e.call(this,t)||this;return r._goToFirstPage=r._goToFirstPage.bind(r),r._goToPreviousPage=r._goToPreviousPage.bind(r),r._goToNextPage=r._goToNextPage.bind(r),Object(x.c)(t.resourceStrings,De.d)||t.retrieveResourceStrings(De.k),r}return Object(n.__extends)(t,e),t.prototype._firstButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._nextButtonEnabled=function(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage},t.prototype._previousButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._goToNextPage=function(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)},t.prototype._goToPreviousPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)},t.prototype._goToFirstPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)},t.prototype._setFooterButtonsFocus=function(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){var r=e.currentTarget,n=e.currentTarget.parentElement.children[1];setTimeout((function(){r.disabled&&n.focus()}),500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){var a=e.currentTarget,i=e.currentTarget.parentElement.lastElementChild;setTimeout((function(){a.disabled&&i.focus()}),500)}},t.prototype._getResources=function(){if(this._loadFirstPage=this._loadFirstPage||Object(x.c)(this.props.resourceStrings,De.d),this._loadNextPage=this._loadNextPage||Object(x.c)(this.props.resourceStrings,De.e),this._loadPreviousPage=this._loadPreviousPage||Object(x.c)(this.props.resourceStrings,De.f),!this._spaceResource){var e=Object(x.c)(this.props.resourceStrings,De.j);this._spaceResource=Object(qe.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(x.c)(this.props.resourceStrings,De.a),this._gridTotalCount=this._gridTotalCount||Object(x.c)(this.props.resourceStrings,De.c),this._itemSelected=this._itemSelected||Object(x.c)(this.props.resourceStrings,De.b),this._totalApproximate=this._totalApproximate||Object(x.c)(this.props.resourceStrings,De.h),this._totalExact=this._totalExact||Object(x.c)(this.props.resourceStrings,De.i)},t.prototype.render=function(){if(!this.props.pagingData)return null;var e=Object(Be.a)(this.props.pagingData),t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));var n=e.totalResultCount,i=this._firstButtonEnabled(e),o=this._nextButtonEnabled(e),s=this._previousButtonEnabled(e);this._getResources();var u=n;-1===n&&(u=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);var l="";l=-1===n?String.format(this._totalApproximate,this.props.isServerOffline?r:u):this.props.isServerOffline&&n>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:n);var p=String.format(this._gridTotalCount,this._spaceResource,l),d=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(x.c)(this.props.resourceStrings,De.g),g=String.format(h,this.props.currentPage),m=n/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),a.createElement(c.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,p,d),this._renderPagingButtons(i,o,s,g,m))},t.prototype._renderPagingButtons=function(e,t,r,n,i){return(i<0||i>1)&&this.props.enhancedPagingDisabled?a.createElement(c.a,{style:this.props.styleProps.navigationPanelStyle},a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},a.createElement(J.b,{type:d.a.FirstPageButton})),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},a.createElement(J.b,{type:d.a.BackButton})),a.createElement(l.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:Fe.a,notificationType:Ge.b},null!==this.props.currentPage?String.format(n,this.props.currentPage):null),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},a.createElement(J.b,{type:d.a.Forward}))):null},t.prototype._renderPagingText=function(e,t,r,n){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return a.createElement(c.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},a.createElement(l.a,null,String.format(this._gridInfoResource,e,t,r,n)))},t}(a.Component);var ze=Object(s.a)((function(){var e,t,r,a=null,i=Object(x.h)(),o=(e=null,t=null,r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}},function(a,i){var o,s,c,u,l,p,d,h,g,m,f,v,b=Object(Ie.b)(a)&&Object(X.a)(a,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(a))||void 0===c?void 0:c.Components)?Object(Ie.a)(a).Components:null;if(e!==i){e=i;var y=Object(Oe.a)(a),_=a.user.userSettings.isRTL,S=Object(n.__assign)(Object(n.__assign)({},r.containerStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100}),C=Object(n.__assign)(Object(n.__assign)({},r.navigationPanelStyle),((o={})["margin"+(_?"Right":"Left")]="auto",o)),O=Object(n.__assign)(Object(n.__assign)({},r.pageNumberStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100,fontSize:y.fontSizes.Font085,fontFamily:y.fontFamilies.Regular,color:(null===(l=null===(u=null==b?void 0:b.Grid)||void 0===u?void 0:u.Footer)||void 0===l?void 0:l.TextColor)||y.colors.BaseColor.Grey.Grey7}),I=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r.pagingButton),{color:(null===(d=null===(p=null==b?void 0:b.Grid)||void 0===p?void 0:p.Footer)||void 0===d?void 0:d.IconColor)||y.colors.BaseColor.Blue.Blue3,marginLeft:y.sizes.Measures.Measure050,marginRight:y.sizes.Measures.Measure050,width:"0px",fontSize:y.fontSizes.Font085,"[disabled]":{color:(null===(m=null===(g=null===(h=null==b?void 0:b.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.Disabled)||void 0===m?void 0:m.IconColor)||y.colors.BaseColor.Grey.Grey5}}),_&&{transform:"scaleX(-1)"}),P=((s={})["margin"+(_?"Left":"Right")]="auto",s.fontSize=y.fontSizes.Font085,s.fontFamily=y.fontFamilies.Regular,s.color=(null===(v=null===(f=null==b?void 0:b.Grid)||void 0===f?void 0:f.Footer)||void 0===v?void 0:v.TextColor)||y.colors.BaseColor.Grey.Grey7,s);t=Object(n.__assign)(Object(n.__assign)({},r),{containerStyle:S,navigationPanelStyle:C,pagingButton:I,pageNumberStyle:O,pagingTextStyle:P})}return t});return function(e,t){var r=o(e,t.contextString),n=Object(T.fb)(e,t.id,t.contextToken),s=n?n.length:0,c=i(e,De.k),u=Object(T.Y)(e,t.id,t.contextToken),l=Object(T.x)(e,t.id,t.contextToken);return a!==r&&(a=r),{selectedRowCount:s,resourceStrings:c,pagingData:u,currentPage:null===l?1:l,styleProps:a}}}),(function(e,t){return{retrieveResourceStrings:function(t){return e(Object(A.e)(t))},updatePageNumber:function(r){if(e(Object(we.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(Xe.b)(t.id,t.contextToken)),t.isGridRoot){var n=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(n,t.id)}return e(Object(Ve.b)(t.id,t.contextToken,null)),e(Object(Le.b)(t.id,t.contextToken,[]))},setNewPageRequested:function(r){e(Object(Re.b)(t.id,t.contextToken,r))}}}))(Ue),We=r("PBKq"),He=r("i6iy"),Ye=r("7EJx");var Qe=r("jf1O"),Ke=r("aPRd"),Je=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindInnerTextRef=null,r._searchBarFocusTriggered=!1,r._onTextInputChange=r._onTextInputChange.bind(r),r._onkeyDown=r._onkeyDown.bind(r),r._onButtonClick=r._onButtonClick.bind(r),r._focusTextInput=r._focusTextInput.bind(r),r.updateSearchTextAndFind=r.updateSearchTextAndFind.bind(r),r.props.isGridPaginationStateFeatureEnabled&&r.props&&r.props.gridInput&&r.props.gridInput.quickFindExpression?r.state={quickFindText:r.props.gridInput.quickFindExpression.trim(),currentViewId:r.props.currentViewIdToRestore,clearQuickFind:!0}:r.state={quickFindText:null,currentViewId:null,clearQuickFind:!1},r}return Object(n.__extends)(t,e),t.prototype.clearSearchBar=function(){this.setState({quickFindText:null,clearQuickFind:!1})},t.prototype.updateSearchTextAndFind=function(e,t){var r=this;this.setState({quickFindText:e},(function(){t&&r._applyQuickFind()}))},t.prototype._onButtonClick=function(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()},t.prototype._onkeyDown=function(e){e.keyCode===je.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())},t.prototype._onTextInputChange=function(e){var t=""===e;this.setState({quickFindText:e,clearQuickFind:t})},t.prototype._applyFilter=function(){var e=this._formatQuickFindText(),t=Object(Te.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)},t.prototype._clearFilter=function(){var e=this;this.setState({quickFindText:""},(function(){e._applyFilter()}))},t.prototype._formatQuickFindText=function(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")},t.prototype._applyQuickFind=function(){var e=this;this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then((function(t){e.setState({clearQuickFind:!0}),e.state.currentViewId||e.setState({currentViewId:t})})):this._clearQuickFind()},t.prototype._clearQuickFind=function(){var e=this;this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then((function(){e.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})}))},t.prototype._getPlaceholderText=function(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)},t.prototype._createUniqueId=function(e){var t=this.props,r=t.contextToken,n=t.id;return r.controlName?e+"_"+r.controlName+"_"+n:e+"_"+n},t.prototype.render=function(){var e=this,t=this._getPlaceholderText(),r=Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return a.createElement(c.a,null,a.createElement(V.i,{placeholder:t,cancelText:Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_CANCEL_LABEL_ID),clearText:r,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));var n=this._createUniqueId("quickFind_text"),i=this._createUniqueId("quickFind_button"),o=this._createUniqueId("quickFind_button_icon"),s=Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_TOOLTIP_APPLY_BUTTON),u=this.state&&this.state.clearQuickFind?r:s;return a.createElement(c.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},a.createElement(We.a,{id:n,key:n,ref:function(t){e._quickFindInnerTextRef=t},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:t,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:t}),a.createElement(_e.a,{id:i,key:i,testhooks:{id:i},accessibilityLabel:u,title:u,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},a.createElement(J.b,{id:o,key:o,type:this.state&&this.state.clearQuickFind?d.a.Cancel:d.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))},t.prototype._focusTextInput=function(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){var e=i.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}},t.prototype.componentDidMount=function(){this._focusTextInput()},t}(a.Component);Je.displayName="DataSetQuickFind";var Ze=Object(s.a)((function(){var e,t,r,a,i=null,o=null,s=null,c=(t=null,r=null,a={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}},function(i,o){var s,c,u,l,p,d,h,g,m,f,v,b,y,_,S,C,O,I=Object(Ye.g)(i),P=Object(Ie.b)(i)&&Object(X.a)(i,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(i))||void 0===c?void 0:c.Components)?Object(Ie.a)(i).Components:null;if(P&&(a=Object.assign(a,{inputStyle:{color:null===(p=null===(l=null===(u=null==P?void 0:P.Grid)||void 0===u?void 0:u.ColumnHeader)||void 0===l?void 0:l.QuickFind)||void 0===p?void 0:p.TextColor,backgroundColor:null===(g=null===(h=null===(d=null==P?void 0:P.Grid)||void 0===d?void 0:d.ColumnHeader)||void 0===h?void 0:h.QuickFind)||void 0===g?void 0:g.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(v=null===(f=null===(m=null==P?void 0:P.Grid)||void 0===m?void 0:m.ColumnHeader)||void 0===f?void 0:f.QuickFind)||void 0===v?void 0:v.IconColor},buttonIconStyle:{color:null===(_=null===(y=null===(b=null==P?void 0:P.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===y?void 0:y.QuickFind)||void 0===_?void 0:_.IconColor}})),t!==o||e!==I){t=o,e=I;var j=Object(Oe.a)(i),T=Object(n.__assign)(Object(n.__assign)({},a.buttonStyle),{":before":{content:"''",display:"inline-block",width:j.sizes.Measures.Measure250}}),E=Object(n.__assign)(Object(n.__assign)({},a.quickFindStyle),((s={borderColor:(null===(O=null===(C=null===(S=null==P?void 0:P.Grid)||void 0===S?void 0:S.ColumnHeader)||void 0===C?void 0:C.QuickFind)||void 0===O?void 0:O.BorderColor)||j.colors.BaseColor.Grey.Grey3})["padding"+(I?"Right":"Left")]=j.sizes.Measures.Measure025,s));r=Object(n.__assign)(Object(n.__assign)({},a),{buttonStyle:T,quickFindStyle:E})}return r}),u=Object(Qe.a)(),l=Object(x.h)(),p=null;return function(e,t){var r=c(e,t.contextString),n=u(e,t);s||(s=l(e,j.labelList)),i!==r&&(i=r),o!==n&&(o=n),p||(p=Object(X.c)(e,G.bd));var a=Object(X.a)(e,G.zb),d=null;a&&t.gridInput&&(d=(t.gridInput&&t.gridInput.viewId&&!S.a.isNullOrEmpty(t.gridInput.viewId)?t.gridInput.viewId:null)||Object(O.a)(e,t.entityTypeName,I.a.MAIN_APPLICATION_VIEW));return{quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(N.E)(e,t.entityTypeName),styleProps:i,quickFindRNStyleProps:o,shouldUseFilter:!(Object(Pe.e)(t.contextString)||Object(Pe.d)(t.contextString)||Object(Pe.g)(t.contextString)&&p),resourceStrings:s,isGridPaginationStateFeatureEnabled:a,currentViewIdToRestore:d,shouldGridSearchUseCurrentView:Object(oe.l)(e),isGridSearchCanUseCurrentViewFeatureEnabled:Object(X.a)(e,G.Db,G.h),isQuickFindImprovementsFeatureEnabled:Object(X.a)(e,G.ad,G.tc),viewPortWidth:Object(Ke.c)(e)}}}),(function(e,t){return{applyQuickFind:function(r,n,a,i,o,s){if(a&&s){var c=[{filterType:1,filterExpressionOrValue:r}];a.entityTypeName===b.a&&c.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(c,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(He.a)(r,n,i,o))},clearQuickFind:function(r,n,a,i,o){if(a){t.updateGridPaginationStateHandler([{filterType:1,filterExpressionOrValue:null}],t.id)}return e(Object(He.b)(r,n,i,o))},applyGridFilter:function(r,n){e(Object(Ce.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Je);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var $e=function(e){return function(e,t,r,n,i,o){var s=(null==o?void 0:o.seeMoreTooltip)||Object(x.c)(t,j.SEE_MORE_TOOL_TIP),u=(null==o?void 0:o.seeMoreLabel)||Object(x.c)(t,j.SEE_MORE_LABEL),p=s;return(null==o?void 0:o.uniqueLabel)&&(p+=" "+o.uniqueLabel),a.createElement(c.a,{style:r},a.createElement(_e.a,{key:"seeMoreBtn",id:"seemore-btn",title:s,style:n,onClick:e,tabIndex:0,accessibilityLabel:p,describedByElementId:null},a.createElement(l.a,{style:i},u)))}(e.onSeeMoreClick,e.resourceStrings,e.containerStyle,e.buttonStyle,e.seeMoreTextStyle,e.localizedStrings)};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var et=r("s2by"),tt=r("/45f"),rt=r("sgPk"),nt=r("WS0f"),at=r("fE8x");var it=r("Cgjg"),ot=r("FPMG"),st=r("0bF2"),ct=r("bCrZ"),ut=r("Wye+"),lt=r("Ds7n"),pt=r("d26+"),dt=r("7oc5"),ht=r("tcXs"),gt=r("c0jI"),mt=r("t8f4"),ft=r("QAhb"),vt=r("8egQ");var bt=r("5cS+"),yt=r("whwt"),_t=r("ASFs"),St=r("Z46F"),Ct=r("LWFb"),Ot=r("kyRo"),It=r("buKK"),Pt=r("+D0h"),jt=r("6FBX"),Tt=r("LnR7"),Et=r("pLx/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ft(e){return a.createElement(ue.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(34)]).then(r.bind(null,"GDLi")).then((function(e){return e.DataSetExpressionBuilder}))},props:e})}Ft.displayName="DataSetExpressionBuilderLazyLoadComponent";var At=r("/U1C"),xt=r("RrHr"),wt=r("zpQF"),Nt=r("/0Gr"),kt=r("TUxu"),Mt=r("/j9Z"),Dt=r("VcAV"),Rt=r("swEE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Lt(e){return a.createElement(ue.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(113),r.e(33)]).then(r.bind(null,"pnQ/")).then((function(e){return e.ColumnEditor}))},props:e})}Lt.displayName="ColumnEditorLazyLoadComponent";var Vt=r("2Sll"),Bt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Vt.a)();var Gt=b.x+".DataSetHost",Xt=Gt+".AdvancedFind.Open",qt=Gt+".AdvancedFind.Discard",Ut=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindCommandBarId="showQuickFind",r._changeVisualizationCommandBarId="changeVisualization",r._savedDefault=null,r._savedFormInfo=null,r._currentFilterValue=null,r._addedCommandListFromHost=[],r._addedCommandListFromControl=[],r._addedCommandListFromHostParent=[],r._memoizedConfiguration=null,r._memoizedResourceStrings=null,r._memoizedViewConfigurations=null,r._memoizedButtonList=null,r._parentSwitchVisualizationButton=null,r._keyIndex=0,r._width=0,r._height=0,r._isFirstRequestComplete=!1,r._isPreNavigationEventAttached=!1,r._offlineSqlQueryRetrieveState=0,r._dataSetQuickFindRef=a.createRef(),r._isSubGridFirstLoad=!1,r._minWidthForChartPlusGridReflow=640,r._isReflowLayoutVertical=!1,r._isSwitchVisualizationInitialized=!1,r._accessibilityId=1,r._incrementLastPage=function(){r.props.pageNumber===r.state.pagingInfo.lastPageNumber&&r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{lastPageNumber:r.state.pagingInfo.lastPageNumber+1})})},r._setFirstPage=function(e){r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{firstPageNumber:e})})},r._seeMorePopup=r._seeMorePopup.bind(r),r._onSendControlCommandsEventFired=r._onSendControlCommandsEventFired.bind(r),r._onSelectedOrderColumnChangeFired=r._onSelectedOrderColumnChangeFired.bind(r),r._onParentPagePreNavigationEventFired=r._onParentPagePreNavigationEventFired.bind(r),r._onFilterChange=r._onFilterChange.bind(r),r._onActivityTypeMenuDismissed=r._onActivityTypeMenuDismissed.bind(r),r._updateDataSetLoadingStateEvent=r._updateDataSetLoadingStateEvent.bind(r),r._updateFilterValue=r._updateFilterValue.bind(r),r._onRollupViewToggleChanged=r._onRollupViewToggleChanged.bind(r),r._onQuickFind=r._onQuickFind.bind(r),r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onViewChanged=r._onViewChanged.bind(r),r._onControlLoadedError=r._onControlLoadedError.bind(r),r._updatePagingInfo=r._updatePagingInfo.bind(r),r._updateFilterExpressionStrings=r._updateFilterExpressionStrings.bind(r),r._configureDataSetControlParams=r._configureDataSetControlParams.bind(r),r._openManageDuplicatesDialog=r._openManageDuplicatesDialog.bind(r),r._showInnerError=r._showInnerError.bind(r),r._isInSeeMoreState=r._isInSeeMoreState.bind(r),r._getChartPaneText=r._getChartPaneText.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.closeFilterPanel=r.closeFilterPanel.bind(r),r._clearActivityTypeFilter=r._clearActivityTypeFilter.bind(r),r._updateCurrentPageNumber=r._updateCurrentPageNumber.bind(r),r._isNativePlatform=null!=t.platformType&&t.platformType===v.b.Native,r._currentPagingString=null,r._preSeeMoreCachedPagingString=null,r._boundOnRecordsSelected=null,r._pageNumberToRestoreForEnhancedPaging=r.props.pageNumberForEnhancedPaging,r._shouldResetPagingForEnhancedPaging=!1,r._previousSortingInfo=null,r._resetProcessedForEnhancedPaging=!0,r.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,lastPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,currentPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:k.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},r._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[r._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[r._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[r._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[r._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[r._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[r._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[r._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[r._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[r._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(Pe.e)(t.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:r._onControlLoadedError},r._seeMoreHelper=new f.a,r}return Object(n.__extends)(t,e),t.prototype._logInfo=function(e){this._tracer&&this._tracer.info(e)},t.prototype._updateDataSetLoadingStateEvent=function(e){this._updateDataSetLoadingState(e.value)},t.prototype._updateDataSetLoadingState=function(e,t){var r=this;void 0===t&&(t={}),(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout((function(){r._updateDataSetLoadingState(2)}),3e4)))},t.prototype._openManageDuplicatesDialog=function(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)},t.prototype._showInnerError=function(e){this.props.showInnerError(e)},t.prototype._updatePagingInfo=function(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(_t.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))},t.prototype._updateCurrentPageNumber=function(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)},t.prototype._updateFilterExpressionStrings=function(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){var t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}},t.prototype._setResetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)},t.prototype._resetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)},t.prototype._onControlLoadedError=function(e){var t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()},t.prototype._setControlLoadError=function(e){void 0===e&&(e=j.GRID_CONTROL_LOAD_ERROR),this.setState({controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,e)})},t.prototype._logTelemetryData=function(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))},t.prototype._renderTitle=function(){if(!this.props.descriptor)return null;var e=this.props.descriptor,t=e.ShowLabel,r=e.Name,n=e.Label,i=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return t&&n?a.createElement(l.a,{key:r,semanticTag:"div",style:i},n):null},t.prototype.onMeasuring=function(e,t){if(this._height=t,!(Math.abs(this._width-e)<50)&&(this._width=e,!this._getCachedSize()||e!==this._getCachedSize().width||t&&t!==this._getCachedSize().height)){var r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),a=this._seeMoreHelper.getSeeMorePopupInfo(),i=n?a.endWidthInner:e,o=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,o.push("isWidthInitialized:"+r.isWidthInitialized));var s=i<=this.props.viewportSm;s!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=s,o.push("isWidthLessThanViewportSm:"+s));var c=i<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,o.push("isWidthLessThanViewportM:"+c));var u=i<this._minWidthForChartPlusGridReflow;u!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=u,o.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+u));var l=this._jumpBarShouldRenderAsFlyout(i);l!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=l,o.push("isJumpBarRenderingAsFlyout:"+l));var p=i>480;p!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=p,o.push("isWidthGreaterThan480:"+p));var d=n?a.endHeightInner:t,h=d>240;h!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=h,o.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn("The measuring service returned width or height as 0. The new dimensions are width is "+e+" and height is "+t);var g=!1,m=this.props.quickFindProps&&s&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=m,o.push("showCommandBarButtonSearch:"+m),g=!0);var f=Object(Pe.e)(this.props.contextString)||Object(Pe.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(f!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=f,o.push("showCommandBarButtonShowChart:"+f),g=!0),o.length>0){o.push("currentWidth:"+e),o.push("currentHeight:"+t),o.push("usePoppedOutDimensions:"+n),o.push("newWidth:"+i),o.push("newHeight:"+d),o.push("commandBarNeedsUpdate:"+g);var v=o.join(",");this._logInfo("onMeasuring change: "+v)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:s,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:u,isJumpBarRenderingAsFlyout:l,isWidthGreaterThan480:p,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:f}));var b=r;g&&(b=Object.assign(b,this._getUpdateAddedCommandList(m,f))),Object.keys(b).length&&this.setState(b)}},t.prototype._getUpdateAddedCommandList=function(e,t){var r=this;if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(x.c)(this.props.resourceStrings,j.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");var n=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:n,Tooltip:{title:n},Id:"ClearQuery",execute:function(){return r.props.clearQuery()}})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");var a=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:a,Tooltip:{title:a},Id:"ShowChartPane",execute:function(){return r.props.toggleChartPane(r.props.id,r.props.contextToken,!r.props.showChart)}})}return this._onAddedCommandListChange(!1)},t.prototype._onViewChanged=function(e,t,r){var n,a=this;void 0===r&&(r=!0),r&&this._updateDataSetLoadingState(1);var i=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+i),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();var o=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===T.a;this.props.updateView(this.props.id,i,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,o).then((function(){a.props.nonCompositionProps&&a.props.nonCompositionProps.setPageInputViewId&&a.props.nonCompositionProps.setPageInputViewId(e),a.state.controlLoadErrorMessage&&a.setState({controlLoadErrorMessage:null})}),(function(e){a._logInfo(e.message),a._setControlLoadError()}))},t.prototype._onItemIconPointerDown=function(e,t,r,n,a){this._logInfo("Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+a);var i=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,i,a)},t.prototype._onQuickFind=function(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})},t.prototype._getChartPaneText=function(){var e=this.props,t=e.resourceStrings;return e.showChart?Object(x.c)(t,j.CHARTS_HIDE_CHART_PANE_LABEL):Object(x.c)(t,j.CHARTS_SHOW_CHART_PANE_LABEL)},t.prototype._getClearQueryText=function(){return"Clear query"},t.prototype._updateFilterValue=function(e){this._currentFilterValue=e},t.prototype._onFilterChange=function(e,t){void 0===t&&(t=this.props.gridEntityTypeName),this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);var r=Object(et.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)},t.prototype._clearActivityTypeFilter=function(){this.props.applyActivityTypeFilter("","",this.props.contextToken)},t.prototype._onActivityTypeMenuDismissed=function(e){if(!this.props.isOffline){var t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;for(var r=null,n=[],a=0;a<e.length;a++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[a]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));var a=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Gt,a)}},t.prototype._shouldActivitySelectAllFilterFire=function(e,t,r){if(r){var n=!1,a=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(n=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(a=!0),!(n&&a)}return!0},t.prototype._onRollupViewToggleChanged=function(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)},t.prototype._updateFilterOnViewSelectorChange=function(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)},t.prototype._onSendControlCommandsEventFired=function(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())},t.prototype._onSelectedOrderColumnChangeFired=function(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){var t=e.columnSortingName;t=Object(Te.d)(t,e.columnSortingType,e.primaryNameAttribute);var r=Object(Te.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}},t.prototype._onParentPagePreNavigationEventFired=function(e){var t=this;e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach((function(e){return t.context.Router.registerPreNavigationHandler((function(){try{return e()}catch(e){t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt,e,null,[{name:"subComponent",value:"onPreNavigation"}])}return Promise.resolve(!0)}))})),this._isPreNavigationEventAttached=!0)},t.prototype._createSwitchVisualization=function(e,t){var r=this;return function(){switch(r._keyIndex++,r.props.contextString){case b.h.ASSOCIATEDGRID:r.props.switchAssociatedGridVisualization(r.props.id,r.props.entityTypeName,r.props.controlId,r.props.viewId,e,r.props.nonCompositionProps&&r.props.nonCompositionProps.viewConfigurations,r.props.nonCompositionProps&&r.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case b.h.SUBGRID:r.props.switchSubgridVisualization(r.props.id,e,r.props.controlId);break;case b.h.GRID:default:if(r.props.featureControlProps.isGridPaginationStateFeatureEnabled&&r.props.gridInput){r.props.updateGridPaginationStateHandler([{filterType:3,filterExpressionOrValue:null}],r.props.id),r.props.setCustomFilter("",0,r.props.id,r.props.contextToken)}"VIEW_CONFIG"===t?r.props.switchViewConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!1):r.props.switchHomepageConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!0)}}},t.prototype._updateChangeVisualizationButtons=function(e){var t=this,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,a=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(x.c)(this.props.resourceStrings,j.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],Object(gt.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e).forEach((function(r){if(!(Object(gt.a)(t.props.updatedConfiguration,r.configuration)||r.configuration.isDefaultConfig&&t.props.updatedConfiguration.isDefaultConfig||t.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(oe.g)(r.configuration,parseInt(e,10)))){var n={Icon:"SelectChart",DisplayText:""+Object(gt.b)(t.props.switchVisualizationResourceStrings,r.configuration),Id:t._changeVisualizationCommandBarId+"-"+r.configuration.Name+"-"+r.formFactor,execute:t._createSwitchVisualization(r.configuration,r.configurationType),IsInFlyout:!0};t._memoizedButtonList.push(n),a=!0}}))),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(gt.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,a&&this._onAddedCommandListChange()},t.prototype._onAddedCommandListChange=function(e){var t,r,n,a;void 0===e&&(e=!0);var i=[],o=[],s=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&o.push(this._parentSwitchVisualizationButton),o.push.apply(o,this._addedCommandListFromControl),o.push.apply(o,this._addedCommandListFromHost),(null===(a=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===a?void 0:a.length)>0&&i.push.apply(i,this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&i.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:o,appendedCommandList:i};this&&this.setState&&this.setState({addedCommandList:o,appendedCommandList:i})},t.prototype._seeMoreCallback=function(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})},t.prototype._seeMorePopup=function(e,t){void 0===t&&(t=!1),!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)},t.prototype._getDataSetHostRootElement=function(){return i.findDOMNode(this)},t.prototype._onRecordsSelectedCallback=function(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);for(var r=[],n=0,a=t;n<a.length;n++){var i=a[n];r.push(new S.a(i))}if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){var o=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,o.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))},t.prototype.markGridFirstRequestComplete=function(){this._isFirstRequestComplete=!0},t.prototype._isDataSetHostKnownError=function(e){return!(!e||""===e)&&(-1!==e.indexOf(St.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(St.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))},t.prototype._onDataSetUpdateCallback=function(e){this._logInfo("DataSetUpdated for DataSetHost control");var t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});var r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(Dt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Gt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Gt,t);var n={};if(r)n={compositeControlInitState:k.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);var a=null;if(e.existedFilteringString){var i=JSON.parse(e.existedFilteringString);a=Object(g.j)(i,qe.CrmXmlEncode),this.props.setCustomFilter(a,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){var o=[],s=!1,c=null;e.existedValidSortingArrayString&&(c=e.existedValidSortingArrayString);var u=!Object(nt.a)(c)&&JSON.parse(c);if(u&&u instanceof Array&&u.length>0&&c!==this.props.gridSortingInfo&&(this.props.gridInput&&o.push({filterType:7,filterExpressionOrValue:c}),s=!0),s){if(e.existedPagingString){var l=JSON.parse(e.existedPagingString);l.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,l.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(o,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++},t.prototype._configureDataSetControlParams=function(){if(this.props.updatedConfiguration){var e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(nt.a)(e.onRecordsSelected)&&Object(nt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(nt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);var t=this.props.descriptor,r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);var a={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[b.q]&&parseInt(t.Parameters[b.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},i=Object(Be.a)(this._currentPagingString);if(i&&i.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+i.pageSize),a.pageSize=i.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(a)},this.props.refreshCounter){var o=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(o,10),Static:!0},!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){var s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)){s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}var c=!Object(nt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),u=c&&c instanceof Array&&c.length>0,l=!Object(nt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),p=l&&l instanceof Array&&l.length>0;(u||p&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();var d=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(d&&(d.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){o=this.props.refreshCounter.toString();d.RefreshInput={Value:parseInt(o,10),Static:!0}}}},t.prototype._addExtraParametersToConfiguration=function(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(nt.a)(this._pageNumberToRestoreForEnhancedPaging))){var e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})},t.prototype._renderAccessibilityNotification=function(e){var t,r=e+"_accessibility",n={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(n.overflow="hidden");var i=Object(x.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),o=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":i;return a.createElement(c.a,{key:r+"_"+this._accessibilityId,id:r,style:n,role:Fe.s,notificationType:Ge.b},o)},t.prototype._renderQuickFind=function(){var e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){var t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},a.createElement(Ze,Object(n.__assign)({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(Pe.g)(this.props.contextString)?a.createElement(c.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null},t.prototype._renderAdvancedFilter=function(){var e=this;return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&a.createElement(_e.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(x.c)(this.props.resourceStrings,At.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){e._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,At.c.OpenAdvancedFiltersTitleAndAria)},a.createElement(J.b,{id:"filter",accessibilityHidden:!0,type:d.a.Filter}))},t.prototype._renderAdvancedFindPanel=function(){var e,t=this;this._updateDataSetLoadingState(1);var r=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then((function(){t.setState({isFilterPanelOpen:!0}),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentSuccess(Xt,r)}),(function(e){t._tracer.error(null==e?void 0:e.message),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentFailure(Xt,new Error(e),r)}))},t.prototype._renderDiscardChanges=function(){var e=this;if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return a.createElement(_e.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(x.c)(this.props.resourceStrings,j.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){var t;e.props.removeEditedViewPageMap(e.props.gridInput.pageToEditedViewMapId.guid,e.props.viewId),e._clearCustomFilterAndUpdateControlKeyIndex();var r=[{name:"entityName",value:e.props.entityTypeName},{name:"ViewId",value:null===(t=e.props.viewId)||void 0===t?void 0:t.guid}];e.context.EventManager.ReportComponentSuccess(qt,r)},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,j.AdvancedFilter_DiscardButton_AccessibilityLabel)},a.createElement(J.b,{id:"clearFilter",type:d.a.GlobalFilterClearAll}))},t.prototype._renderColumnEditor=function(){var e=this;if(this.props.showColumnEditor&&this._isWidthInitialized()){var t=Object(x.c)(this.props.resourceStrings,j.ColumnEditorButton);return a.createElement(Bt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:t,"aria-label":t,onClick:function(){return e.setState({columnEditorPanelOpen:!0})},style:this.props.styles.columnEditorButtonStyle})}},t.prototype._clearCustomFilterAndUpdateControlKeyIndex=function(){var e=this;this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then((function(){e._keyIndex++,e._onViewChanged(e.props.viewId.guid,e.props.entityTypeName,!1)}))},t.prototype._getQuickFind=function(){return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindStyle},a.createElement(Ze,Object(n.__assign)({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))},t.prototype._renderViewSelector=function(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return a.createElement(c.a,{key:"viewSelector",style:e},a.createElement(Y,Object(n.__assign)({isGridRoot:Object(Pe.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()},t.prototype._renderQueueFilter=function(){if((this.props.entityTypeName===jt.Bb||this.props.entityTypeName===Tt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return a.createElement(ce,Object(n.__assign)({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null},t.prototype._renderEntityFilter=function(){if(this.props.entityFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return a.createElement(me,Object(n.__assign)({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null},t.prototype._renderDataSetChart=function(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,a.createElement(_,Object(n.__assign)({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null},t.prototype._renderBackButtonForGridInMobile=function(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(Pe.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null},t.prototype._renderCommandBar=function(){var e=this;if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise((function(t){e._commandBarLoadedResolve=t}))),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(fe.a)();var t=this.props.styles.commandManagerContainerStyle,r=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(t=this.props.styles.commandManagerContainerMobileStyle,r=this.props.styles.commandBarMobileInnerStyle);var i=Object(Pe.e)(this.props.contextString);return Object(K.b)(this.props.commandBarRefreshProps,r,this._isWidthLessThanViewportSm(),t),a.createElement(ae,Object(n.__assign)({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:t,commandbarStyles:r,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:i,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))},t.prototype._renderFooter=function(){var e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(Pe.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&!(e=this._shouldRenderSeeMoreButton()))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){var t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object(n.__assign)(Object(n.__assign)({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),a.createElement(c.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null},t.prototype._jumpBarShouldRenderAsFlyout=function(e){var t=Object(x.c)(this.props.resourceStrings,j.JUMPBAR_ALPHABET);if(t){var r=t.split(","),n=e-100,a=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+a}return!1},t.prototype._renderJumpBar=function(){var e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?a.createElement(c.a,{key:"jumpBar_"+this.props.id,style:e},a.createElement(Me,Object(n.__assign)({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(Pe.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null},t.prototype._renderPaging=function(e){var t=Object(Pe.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(nt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?a.createElement(ze,Object(n.__assign)({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(Pe.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null},t.prototype.renderDataSetHostComponent=function(e,t,r,i,o){var s,l,p,g,f=this,v=[],y=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{var _=this._getDataSetHostErrorMessage();if(Object(nt.a)(_)||this.state.compositeControlInitState===k.a.Initializing){if(this._isWidthInitialized()||Object(Pe.g)(this.props.contextString)&&this.state.compositeControlInitState!==k.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);var S=(Object(Pe.e)(this.props.contextString)||Object(Pe.d)(this.props.contextString))&&this.props.entityIsActivityType;y||Object(Pe.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(Pe.e)(this.props.contextString)&&(o=Object(n.__assign)(Object(n.__assign)({},o),{display:"none"})),v.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],o),this._renderQuickFind(),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===b.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(v.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&v.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],o),S||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===b.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));var C=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;if(this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(Pe.d)(this.props.contextString)&&(C=Object(n.__assign)(Object(n.__assign)({},C),{flexBasis:"0px"})),this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){C=Object(n.__assign)(Object(n.__assign)({},C),{borderTop:"1px solid #d8d8d8"})}var O=(null===(g=null===(p=null===(l=this.props)||void 0===l?void 0:l.configuration)||void 0===p?void 0:p.Parameters)||void 0===g?void 0:g.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,I=O&&O.Value,P=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(Pe.g)(this.props.contextString)&&"true"===I;P&&0===this.props.totalResultCount&&(C=Object(n.__assign)(Object(n.__assign)({},C),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&P&&(C=Object(n.__assign)(Object(n.__assign)({},C),{minHeight:"0px"}));var T=y&&Object(Pe.e)(this.props.contextString),E=this._parentDefinedProps;this.props.parentDefinedControlProps&&(E.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,E.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,E.decorators=this.props.parentDefinedControlProps.decorators,E.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),E.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse,E.containerStyleOverrides=this._getCombinedContainerStyleOverrides();var F=null;this.props.chartProps&&this._isWidthInitialized()&&(F={width:"70%"});var A=Ne.a.getInstance().get_IsBrowserIE()?Object.assign(i,{flex:"1 1 100%"}):i;v.push(a.createElement(c.a,{key:"dataSetContentBody_"+this.props.id,style:C},this._renderDataSetChart(),a.createElement(c.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(A,F),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:"data-set-body-container"}},a.createElement(h.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:E,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),T?null:this._renderFooter()))),T&&v.push(this._renderFooter()),v.push(this._renderAccessibilityNotification(e)),v=v.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),v.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],o))),this._isWidthInitialized()){var w={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},N=Object(x.c)(this.props.resourceStrings,j.SEE_MORE_DETAILS);v.push(a.createElement(c.a,null,a.createElement(u.a,{id:"gridErrorContainer"+this.props.id,text:_,icon:d.a.DetailsPageClose,iconStyle:w}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&a.createElement(c.a,{style:{display:"flex",justifyContent:"center"}},a.createElement(ye.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:N,onClick:function(){f.props.showInnerError(f.state.controlLoadInnerErrorMessage)}},N))))}var M=Object(n.__assign)(Object(n.__assign)({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return a.createElement(c.a,{style:M,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:(s={id:e},s[Ct.b]=this.props.previewId,s[Ct.c]=20,s),semanticTag:this.props.semanticTag},v)}catch(e){this._onControlLoadedError(e)}},t.prototype._getDataSetHostErrorMessage=function(){var e,t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,j.OFFLINE_NOT_READY_FOR_USE):Object(x.c)(this.props.resourceStrings,j.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{var r="";this.props.offlineProps.offlineErrorMessageKey&&(r=Object(x.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),r||(r=Object(x.c)(this.props.resourceStrings,j.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=r}else{var n=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,a=Object(x.c)(this.props.resourceStrings,j.UCI_DISABLED_ENTITY_ERROR);t=String.format(a,n)}else t=Object(x.c)(this.props.resourceStrings,j.READ_PRIVILEGE_VIOLATION_KEY);return Object(nt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(Gt+"._getDataSetHostErrorMessage : "+t,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t},t.prototype._renderHeader=function(e,t){void 0===e&&(e=[]);var r=(e||[]).filter((function(e){return!!e}));return r.length?a.createElement(c.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null},t.prototype._getParentDefinedPropsDecoratorValue=function(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]},t.prototype._shouldRenderSeeMoreButton=function(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount},t.prototype._renderSeeMoreButton=function(){var e=Object(Pe.g)(this.props.contextString),t=Object(Pe.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),n=Object(Pe.f)(this.props);return!((e||t)&&!n)||r===m.b.PopFadeIn||r===m.b.PoppedOut||r===m.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):a.createElement($e,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})},t.prototype._getSeeMoreLocalizedStrings=function(){var e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(x.c)(this.props.resourceStrings,j.SEE_ALL_LABEL),seeMoreTooltip:Object(x.c)(this.props.resourceStrings,j.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}},t.prototype._isStreamOnSuiterDashboard=function(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(Pe.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value},t.prototype._renderProgressIndicator=function(){var e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);var t=Object(n.__assign)({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle),r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object(n.__assign)(Object(n.__assign)({},r),{borderBottom:"none"})),a.createElement(c.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},a.createElement(c.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},a.createElement(p.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))},t.prototype.componentWillUnmount=function(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null},Object.defineProperty(t.prototype,"_tracer",{get:function(){return this.context?this.context.TraceManager.getTracer(b.z):null},enumerable:!1,configurable:!0}),t.prototype._updateStatus=function(e){var t=this;this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout((function(){return t.setState({statusMessage:e})}),1e3))},t.prototype.render=function(){var e,t,r,i,o,s=this;if(Object(nt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==k.a.Error){var u=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!u)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===k.a.Uninitialized){this.setState({compositeControlInitState:k.a.Initializing});var p=this.props.viewId?this.props.viewId:u.ViewId?S.a.parse(u.ViewId):null,d=this.props.gridEntityTypeName||u.TargetEntityType||u.EntityName;if(!d&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo("Initializing grid for "+p+" view and "+d+" entity."),this.props.initializeGrid(p,d,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then((function(){s._logInfo("Initialized grid for "+p+" view and "+d+" entity."),s.setState({compositeControlInitState:k.a.Initialized})}),(function(e){var t=e instanceof Error?e.message:e;-1!==tt.c.indexOf(t)?s._setControlLoadError(t):s._tracer&&s._tracer.error("Grid initialization failed. Reason: "+t),s.setState({compositeControlInitState:k.a.Error})}))}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){var h=this.props.descriptor.Parameters[b.c];if(this._isWidthLessThanViewportSm()&&h&&"false"===h)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(i=this.props.gridInput)||void 0===i?void 0:i.viewType)||this.props.savedQueryType===I.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));var g=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,f="dataSetRoot_"+g,v=this.props.styles,y=v.containerStyle,_=v.headerStyle,C=this.props.styles,O=C.rootStyle,P=C.headerInnerStyle,j=C.bodyStyle;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());var T=y,E={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(j=this.props.styles.bodyMobileStyle,P=this.props.styles.headerInnerMobileStyle);var F=this._seeMoreHelper.getSeeMorePopupStatus(),A=this._seeMoreHelper.getSeeMorePopupInfo();F!==m.b.NotInUse&&(E=m.a.getCustomControlFancyPopoutStyles(this.props.renderer,F,A),F!==m.b.ReturnFadeIn&&(T={height:A.startHeight,width:A.startWidth},O=Object(n.__assign)(Object(n.__assign)({},O),{height:A.endHeightInner-48})));var x=this.renderDataSetHostComponent(f,O,_,j,P),w=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),N=this.props.isRTL,M=function(e,t,r,n,i,o,s,u){void 0===u&&(u=!1);var l=i||o,p="DataSetHostContainer";return a.createElement(c.a,{key:p,id:p+"_"+s,style:l,testhooks:{id:p}},e.renderCloseButton(n,!0,!1,u),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,x,0,w,E.innerStyle,O,f,N),D=Object(n.__assign)({},E.outerStyle?E.outerStyle:O);0===this.state.loadingState?(D.visibility="hidden",D.maxHeight="0"):1===this.state.loadingState&&(D=Object(n.__assign)(Object(n.__assign)({},D),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));var R=function(e,t,r,n){var i=t||{width:"100%"},o=n?Fe.e:null;return a.createElement(c.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:i,role:o},e)}(M,D,f,(null===(o=this._seeMoreHelper)||void 0===o?void 0:o.getSeeMorePopupStatus())!==m.b.NotInUse),L=function(e,t){return t=t||{display:"none"},a.createElement(c.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(f,E.shadowStyle),V="datassethost_root_view_"+g+"_"+f,B=Ne.a.getInstance().get_IsBrowserIE()&&Object(Pe.g)(this.props.contextString)?{overflow:"visible"}:{},G=this.props.styles.mobileSubGridContainerStyles,X=Object.assign(T,B);return this._isNativePlatform&&Object(Pe.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(X=Object(n.__assign)(Object(n.__assign)({},X),G)),a.createElement(c.a,{key:V,style:X},a.createElement(l.a,{role:Fe.s,notificationType:Ge.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),L,R,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&a.createElement(Ft,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:function(){s._clearCustomFilterAndUpdateControlKeyIndex(),s.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:qt,resetAdvancedFilter:function(){return s.setState({isAdvancedFilterEdited:!1})}}),this.props.showColumnEditor&&a.createElement(Lt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:function(){return s.setState({columnEditorPanelOpen:!1})},viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)},t.prototype.componentDidMount=function(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())},t.prototype.closeFilterPanel=function(){this.setState({isFilterPanelOpen:!1})},t.prototype.componentWillReceiveProps=function(e){var t=this;(Object(Pe.e)(this.props.contextString)||Object(Pe.g)(this.props.contextString)||Object(Pe.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then((function(){t._offlineSqlQueryRetrieveState=2;var e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentSuccess&&t.context.EventManager.ReportComponentSuccess(Gt+".componentWillReceiveProps",e)})).catch((function(e){t._offlineSqlQueryRetrieveState=2;var r=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:S.a.toString(t.props.viewId)},{name:"viewType",value:t.props.viewType},{name:"savedQueryType",value:t.props.savedQueryType}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt+".componentWillReceiveProps",e,null,r)}))),this._isShowChartChanged=this.props.showChart!==e.showChart},t.prototype.shouldComponentUpdate=function(e){return this.props.entityTypeName===T.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)},t.prototype.componentDidUpdate=function(){this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());var e=Object(x.c)(this.props.resourceStrings,j.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(Pe.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)},t.prototype._renderAccessibilityComponent=function(e){var t=e+"Accessibility";if(Object(Pe.e)(this.props.contextString)){var r=[];if(this.props.viewSelectorProps){var n=this.props.viewSelectorProps.id;r.push(a.createElement(Ee.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:n}))}else r.push(a.createElement(Ee.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null},t.prototype._isInSeeMoreState=function(){var e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==m.b.NotInUse&&e!==m.b.ReturnFadeOutAndMove&&e!==m.b.ReturnFadeIn},t.prototype._isNativeSubgrid=function(){return Object(Pe.g)(this.props.contextString)&&this.props.clientHostSubtype===Rt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled},t.prototype._getCombinedContainerStyleOverrides=function(){var e=this._parentDefinedProps.containerStyleOverrides,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(Pe.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})},t.prototype._updateViewSelectorProps=function(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){var t=e.descriptor.Parameters[b.B],r=t?t.toString().split(","):null,n=r?r.map((function(e){return S.a.tryParse(e)})):null;e.viewSelectorProps.viewIds=n||null}},t.prototype._getCachedSize=function(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize},t.prototype._isWidthInitialized=function(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1},t.prototype._isWidthLessThanViewportSm=function(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1},t.prototype._isWidthLessThanViewportM=function(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1},t.prototype._isWidthLessThanMinWidthForChartPlusGridReflow=function(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1},t.prototype._isWidthGreaterThan480=function(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1},t.prototype._isHeightGreaterThan240=function(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1},t.prototype._showCommandBarButtonSearch=function(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1},t.prototype._showCommandBarButtonShowChart=function(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1},t.prototype._isJumpBarRenderingAsFlyout=function(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1},t.prototype._hideJumpbarForMobile=function(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(Pe.e)(this.props.contextString)||Object(Pe.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020},t.prototype._showNewQuickFindSearchBarForMobile=function(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===b.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===b.m)},t.prototype._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot=function(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(Pe.e)(this.props.contextString)},t}(a.Component);function zt(e,t){return a.createElement(Ut,Object(n.__assign)({},e,{renderer:t.renderer}))}Ut.displayName="DataSetHost",Ut.contextType=Ot.a,zt.contextTypes={renderer:o.object};var Wt=Object(s.a)(Pe.i,(function(e,t){return{initializeGrid:function(r,n,a,i){var o=rt.a.fromXmlAndSql("","",r).getQueryState(),s=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[b.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[b.s]?parseInt(t.descriptor.Parameters[b.s],10):null;a||(a=Object(oe.c)(t.id,i));var u=e(Object(ct.d)(o,n,t.id,i,t.descriptor,s,c,void 0,a)),l=e(Object(bt.b)(n,r,t.id)),p=e(Object(A.e)(j.labelList));return Promise.all([u,p,l])},removeEditedViewPageMap:function(t,r){return e(Object(xt.c)(t,r.guid))},updatePageInput:function(t,r){return e(Object(wt.b)(t,r))},updateView:function(r,n,a,i,o,s,c,u,l){var p=e(Object(ut.a)(r,s,n,a,i)).then((function(){return e(Object(ht.a)(r,o))})),d=S.a.tryParseOrNull(a),h=e(Object(bt.b)(i,d,r)),g=Promise.resolve(null);if(l){var m=Object(et.a)(i,c,s,u,!0);g=e(m.getFilterOptionsAction())}return Promise.all([p,h,g]).then((function(){if(Object(Pe.e)(t.contextString)){t.updateGridPaginationStateHandler([{filterType:0,filterExpressionOrValue:null}],t.id)}e(Object(Ce.m)("",r,s)),e(Object(Ce.n)("",r,s)),e(Object(Ce.j)("",r,s)),e(Object(it.b)("",0,r,s))}))},retrieveView:function(t,r,n,a,i){return e(Object(F.a)(t,r,n,a,!1))},markSelectedRows:function(t,r,n){return e(Object(Le.b)(t,r,n))},markSelectedRelatedEntity:function(t,r,n){return e(Object(Ve.b)(t,r,n))},rowProperties:function(t,r,n){return e(Object(lt.b)(t,r,n))},updateFetchXml:function(t,r,n){return e(Object(pt.b)(t,r,n))},applyGridFilter:function(r,n,a){if(Object(Pe.e)(t.contextString)){var i=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Ce.k)(n,t.id,a)),e(Object(Ce.l)(r,t.id,a))},applyActivityTypeFilter:function(r,n,a){if(Object(Pe.e)(t.contextString)){var i=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Ce.h)(n,t.id,a)),e(Object(Ce.i)(r,t.id,a))},onSelectedOrderColumnChange:function(r,n){e(Object(Ce.o)(r,t.id,n))},toggleGridRollupView:function(r,n){e(Object(dt.b)(r,t.id,n))},updatePagingData:function(t,r,n){return e(Object(ot.b)(t,r,n))},updateQueryKey:function(t,r,n){e(Object(st.b)(t,r,n))},setCustomFilter:function(t,r,n,a){return e(Object(it.b)(t,r,n,a))},runOnRecordSelect:function(r,n,a){e(function(e,t,r,n,a){return{type:"dataset.run.on.record.select",sync:!0,execute:function(a,i){var o=a.dispatch,s=a.getState,c=i.TraceManager.getTracer(b.z),u=b.x+".RunOnRecordAction";try{if(i&&i.ScriptManager){var l=i.ScriptManager.getContainer(e);if(l&&n&&1===n.length){var p=Object(at.c)(s()),d=Object(at.b)(s());p&&(o(l.getEventManager().addGridOnRecordSelectHandlers(t)),o(l.getEventManager().addGridOnChangeHandlers(t))),(p||d)&&o(l.getEventManager().runOnRecordSelect(t,r)),c.info("Triggered the action for {0} selected records"+n.length),i.EventManager.ReportComponentSuccess(u)}}}catch(e){var h="Triggered action for selected records failed with error : "+e.message;i.EventManager.ReportComponentFailure(u,Error(h))}}}}(r,n,n.controlName?n.controlName:"entity_control",a,Object(Pe.e)(t.contextString)||Object(Pe.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:function(t){return e(Object(Nt.a)(t))},switchHomepageConfiguration:function(t,r,n,a,i){e(Object(gt.g)(t,r,n,a,i))},switchViewConfiguration:function(t,r,n,a,i){e(Object(gt.i)(t,r,n,a,i))},switchSubgridVisualization:function(t,r,n){e(Object(gt.h)(t,r,n))},switchAssociatedGridVisualization:function(t,r,n,a,i,o,s,c){e(c?Object(gt.f)(t,r,n,a,i,o,s):Object(gt.e)(t,r,n,i,s))},toggleChartPane:function(t,r,n){e(Object(yt.b)(t,r,n))},clearQuery:function(){e(Object(Et.a)())},updateUserDefaultGridView:function(t,r,n,a,i,o){return e(function(e,t,r,n,a,i){return{type:"grid.update.userdefaultview",execute:function(o,s){var c=s.TraceManager.getTracer(b.z),u=b.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");var l=o.getState(),p=new ft.a("usersettings",Object(Ye.q)(l)),d=Object(N.h)(l,e);if(!p||!d.ObjectTypeCode)return Promise.resolve();i&&(t="",r="",a=[],n="");for(var h=[],g=0,m=a;g<m.length;g++){var f=m[g],v=S.a.tryParse(f),y=S.a.externalGuid(v);h.push(y)}var _=String.format("<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>",d.ObjectTypeCode,n||"",1===h.length?h.toString():"",S.a.externalGuid(S.a.tryParse(t)),r);o.dispatch(Object(mt.f)(p,{personalizationsettings:_}));var C={ViewId:t,ViewType:+r,QueueId:a.toString()};return o.dispatch(Object(vt.f)(C,e)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var O="Failed to update user default grid view with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(O))}}}}(t,r,n,a,i,o))},updateCurrentPageNumber:function(t,r,n){return e(Object(we.b)(t,r,n))},setNewPageRequested:function(t,r,n){e(Object(Re.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:function(t){var r=t.filter((function(e){return null!=e}));return e(Object(A.e)(r))},updatePageNumberForEnhancedPaging:function(e){if(Object(Pe.e)(t.contextString)){var r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:function(t){e(Object(It.a)(null,null,ft.a.fromExternalEntityReference(t.entityReference))).then((function(r){if(0===r.status)return e(Object(Pt.a)(r.pageId)).then((function(e){"ignore_save"===e.value.param_lastButtonClicked&&t.reject()}))}))},showInnerError:function(r){var n=new Mt.a(r,null,null,null,null,{stack:r+" "+(new Error).stack,message:r});e(Object(kt.a)(t.id,n))}}}))(zt)},otMa:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return l})),r.d(t,"d",(function(){return p}));var n=r("rn9m"),a=r("Roat"),i=r("U56z"),o="customcontrol.propertybag.device.isoperationavailable";function s(){return{type:o,execute:function(e,t){return new n.a(t,e).isOperationAvailable(i.b.getBarcodeValue.name)},sync:!0}}function c(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.takePicture.name)},sync:!0}}function u(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureVideo.name)},sync:!0}}function l(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureAudio.name)},sync:!0}}function p(){return{type:o,execute:function(){return!1},sync:!0}}},"pLx/":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("Z1aD"),a=r("45T4");function i(e,t){return Object(n.a)(a.a,{},t,e)}},r0tX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(n||(n={}))},r3Bs:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._traversedPath=e,this._stageId=t}return Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stageId",{get:function(){return this._stageId},set:function(e){this._stageId=e},enumerable:!1,configurable:!0}),e}(),a=r("3INI"),i=r("9r0m"),o=function(){function e(){}return Object.defineProperty(e.prototype,"globalPathAndActiveStage",{get:function(){return this._globalPathAndActiveStage},set:function(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntityIdsByEntityLogicalName",{get:function(){return this._navigationEntityIdsByEntityLogicalName},enumerable:!1,configurable:!0}),e.prototype.InitGlobalPathAndActiveStage=function(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)},e.prototype.UpdateGlobalPathAndActiveStage=function(e,t){this.globalPathAndActiveStage=new n(new a.a(e),t)},e.prototype._updateNavigationDictionary=function(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(var t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}},e}()},r7Ib:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCommandManagerId";function o(e,t,r){return{type:"grid.setCommandManagerId.async",execute:function(o,s){var c=o.dispatch,u=(o.getState,s.TraceManager.getTracer(a.z)),l=a.x+".setCommandManagerIdAction";try{u.info("Updating the command manager id for the grid.");var p=Object(n.v)(r);return c(function(e,t,r){return{type:i,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,p)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var d="Updating the command manager id for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(d))}}}}},rbxJ:function(e,t,r){"use strict";r.d(t,"i",(function(){return de})),r.d(t,"g",(function(){return ne})),r.d(t,"e",(function(){return ae})),r.d(t,"d",(function(){return ie})),r.d(t,"f",(function(){return ge})),r.d(t,"h",(function(){return me})),r.d(t,"c",(function(){return se})),r.d(t,"a",(function(){return pe})),r.d(t,"b",(function(){return le}));var n=r("c/eZ"),a=r("9r0m"),i=r("swEE"),o=r("NxDw"),s=r("G7N+"),c=r("S2mk"),u=r("UOiB"),l=r("Fas2"),p=r("r2h9"),d=r("lMVv"),h=r("7EJx"),g=r("EGsq"),m=r("Ww2r"),f=r("RlP9"),v=r("z9yS"),b=r("uO/V"),y=r("Gemh"),_=r("Sscr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function S(){var e=null,t=null,r=null;return function(n,a){var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r=t.parentContextToken;switch(t.contextString){case b.h.ASSOCIATEDGRID:var n=Object(y.gb)(e,t,r);return _.a(r,n.relationshipName,n.ordinal);case b.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);var a=_.p(r,t.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=se(e,t,i,a),a;case b.h.GRID:return _.k(e,t.id);case b.h.CUSTOM:return _.c(r,t.controlId);default:return r}}(n,a);return(r!==o||C(e,s)||C(t,i))&&(e=s,t=i,r=o),e}}function C(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var O=r("jf1O"),I=r("perk"),P=r("/3Li"),j=r("0u+G"),T=r("wV3W"),E=r("DgF7"),F=r("Wg6j"),A=r("WS0f"),x=r("VWqI"),w=r("Ev4I"),N=r("JlqV"),k=r("cZkS"),M=r("qC0c"),D=r("c0jI"),R=r("jigW"),L=r("sOTk"),V=r("7pqb"),B=r("s2by"),G=r("VnpK"),X=r("CIm2"),q=r("+6eZ"),U=r("3/zo"),z=r("oVzJ"),W=r("2OIc"),H=r("/V8d"),Y=r("M6d0"),Q=r("Oiu5"),K=r("/U1C"),J=r("W51q"),Z=r("c56u"),$=r("F2uj"),ee=r("HF9s"),te=r("c96h"),re=r("TCzx");function ne(e){return e===b.h.SUBGRID}function ae(e){return e===b.h.GRID}function ie(e){return e===b.h.ASSOCIATEDGRID}function oe(e){switch(e){case b.h.ASSOCIATEDGRID:case b.h.SUBGRID:return"div";case b.h.GRID:default:return"section"}}function se(e,t,r,n){var a=r?Object(d.G)(e,r,n.relationshipName):null;if(null===a&&t.descriptor&&t.descriptor.Parameters){var i=t.descriptor.Parameters[b.F.RELATIONSHIP_NAME],o=t.descriptor.Parameters[b.F.TARGET_ENTITY_TYPE];i&&r?a=Object(d.G)(e,r,i):i&&o&&(a=Object(d.G)(e,o,i))}return a}function ce(){var e=null,t=null;return function(r){return e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case b.h.ASSOCIATEDGRID:case b.h.SUBGRID:return[p.a.SUB_GRID,p.a.MAIN_APPLICATION_VIEW];case b.h.GRID:return e.isAdvancedFindView?[p.a.ADVANCED_SEARCH]:[p.a.MAIN_APPLICATION_VIEW];default:return[p.a.MAIN_APPLICATION_VIEW]}}(r)),t}}function ue(e){return e&&[e.CustomControlId,e.Name].some((function(e){return-1!==H.a.indexOf(e)}))}function le(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==u.a.AssociatedGrid&&e.contextTokenType!==u.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ue(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function pe(){var e=null,t=null;return function(r,n,a){if(e&&t===n.CustomControlId)return e;var i=n&&n.CustomControlId?n.CustomControlId:null;if(!i)return null;var o=Object(y.ab)(r,i),s=Object(W.e)(r,i);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){var c=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:c.hasOwnProperty("displayChart")?c.displayChart:le(a,"displayChart",n),displayCommandBar:c.hasOwnProperty("displayCommandBar")?c.displayCommandBar:le(a,"displayCommandBar",n),displayIndex:c.hasOwnProperty("displayIndex")?c.displayIndex:le(a,"displayIndex",n),displayQuickFind:c.hasOwnProperty("displayQuickFind")?c.displayQuickFind:le(a,"displayQuickFind",n),displayViewSelector:c.hasOwnProperty("displayViewSelector")?c.displayViewSelector:le(a,"displayViewSelector",n)},t=n.CustomControlId}return e}}function de(){var e,t,r,u,_,C,G,W,H,le,pe,de,ge,be,ye,_e,Se,Ce,Oe,Ie,Pe,je,Te,Ee,Fe,Ae,xe,we,Ne,ke,Me,De,Re,Le,Ve,Be,Ge=null,Xe=null,qe=null,Ue=null,ze="",We=null,He=null,Ye=null,Qe=null,Ke=null,Je=null,Ze=null,$e=null,et=(t=null,function(e,r,n,a){var i=t;switch(Object(A.b)(a)&&(a=r.contextString),a){case b.h.ASSOCIATEDGRID:i=Object(l.b)(n);break;case b.h.SUBGRID:i=Object(l.l)(n);break;case b.h.GRID:default:i=Object(l.h)(n)}return i!==t&&(t=i),t}),tt=Object(O.a)(),rt=S(),nt=(r=null,_=null,u=function(e,t,r){var n,i,s,u,l;if(Object(y.ib)(e,t.id,r)){n=Object(y.T)(e,t.id,r);var p=Object(y.qb)(e,n,t.id);i=p&&p.entityLogicalName,l=p&&p.isUserView,s=Object(y.r)(e,t.id,r,i),u=Object(y.s)(e,t.id,r)!==v.a.savedvisualization}else{var d=Object(y.ab)(e,t.configuration.CustomControlId);if(d){var h=t.configuration.Parameters[d];h&&(n=h.ViewId&&new a.a(h.ViewId),i=h.TargetEntityType,s=h.VisualizationId&&new a.a(h.VisualizationId),u=!(!h.IsUserChart||"true"!==h.IsUserChart),l=!(!h.IsUserView||"true"!==h.IsUserView))}}if(!a.a.isNullOrEmpty(n)&&s&&i){var g=Object(y.q)(e,t.id,r),m=Object(y.p)(e,t.id,r),f=Object(y.C)(e,t.id,r),S=he(e,t,r,f,!0),C=Object(y.N)(e,t.id,r),O=e.user&&e.user.userId,I=Object(M.c)(e,k.Zc),P=Object(B.a)(i,O,r,I),j=P&&P.getFilterAndLinkedEntities(f&&f.activityOrQueueFilterValue?f.activityOrQueueFilterValue:void 0),T=j&&null!==j.linkEntities?JSON.stringify(j.linkEntities):null,F=Object(M.a)(e,k.Od,k.h),A=!F||F&&Object(E.a)(e)===o.a.MobileApplication,x=F,w=ie(t.contextString)?Object(c.p)(b.d,i,a.a.toString(n),a.a.toString(s),r.relationshipName,C,u,l,S,T,x):Object(c.t)(b.d,i,a.a.toString(n),a.a.toString(s),C,g,u,m,l,S,T,A,x);if(_){var N=w&&w.CustomControlId?w.CustomControlId:null;if((L=Object(y.ab)(e,N))&&w.Parameters[L]){var D=w.Parameters[L],R=_.Parameters[L];D.ViewId===R.ViewId&&D.VisualizationId===R.VisualizationId&&D.EntityName===R.EntityName&&D.HighchartFilterExpression===R.HighchartFilterExpression&&D.ChartDrillDownParameters===R.ChartDrillDownParameters&&D.ExtraFilters===R.ExtraFilters||(_=w)}}else _=w}else if(_&&i&&!s){var L;N=_.CustomControlId,(L=Object(y.ab)(e,N))&&_.Parameters[L]&&i!==(R=_.Parameters[L]).EntityName&&(_=null)}return _},function(e,t,n){var a=u(e,t,n),i=t.id;return r&&r.configuration===a&&r.id===i||(r={configuration:a,id:i,chartId:b.d,showChart:!0,contextToken:n}),r}),at=(C=null,function(e,t,r,n,a,i){var o=i.commandBarStyle,s=t.id,c=se(e,t,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),u=Object(y.w)(e,s,r);return C&&C.commandManagerId===u&&C.pageId===s&&C.ribbonId===a&&C.relationshipType===c&&C.contextToken===r&&C.style===o||(C={commandManagerId:u,pageId:s,ribbonId:a,relationshipType:c,contextToken:r,style:o}),C}),it=(G=null,W=ce(),function(e,t,r,n,i,o){var s,c=o.viewSelectorStyle,u=a.a.toString(i),l=W(t),d=Object(y.nb)(t.id,u),g=ae(t.contextString),m=g,v=t.contextString,b=Object(y.Z)(e),_=Object(h.g)(e),S=Object(y.qb)(e,i,t.id),C=S?S.title:null,O=p.a.MAIN_APPLICATION_VIEW;ne(v)?O=p.a.SUB_GRID:g&&t.isAdvancedFindView&&(O=p.a.ADVANCED_SEARCH);var I=Object(f.a)(e,n,O),P=I||a.a.EMPTY,j=Object(L.g)(e,null==t?void 0:t.id),T=Object(y.rb)(e,null===(s=null==j?void 0:j.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==i?void 0:i.guid);return G&&G.id===d&&G.entityTypeName===n&&G.selectedViewId===u&&G.queryViewSelectorTypes===l&&G.shouldDisplayNestedViewSelector===m&&G.isRTL===_&&G.defaultViewId===P&&G.isEdited===!!T||(G={id:d,pageId:t.id,title:C,entityTypeName:n,selectedViewId:u,style:c,queryViewSelectorTypes:l,shouldDisplayNestedViewSelector:m,contextString:v,pinnedActivityView:b,isRTL:_,defaultViewId:P,isAdvancedFindView:t.isQueryMode&&t.isAdvancedFindView,isEdited:!!T,pageToEditedViewMapId:null==j?void 0:j.pageToEditedViewMapId}),G}),ot=(H=null,function(e,t,r,n,a){var i=t.id,o=Object(y.G)(e,t),s=Object(h.w)(e),c=a.filterComboStyle,u=Object(L.g)(e,i).entityFilterValue;return H&&H.id===i&&H.entityTypeName===n&&H.filterOptions===o&&H.comboBoxStyle===c&&H.userSetting===s&&u===H.previousValue||(H={id:i,filterOptions:o,entityTypeName:n,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:s,style:null,comboBoxStyle:c,previousValue:u}),H}),st=(le=null,function(e,t,r,a,i){var o=t.id,s=Object(y.G)(e,t,a),c=Object(Q.a)(e),u=i.filterComboStyle,l=i.dueDateComboBoxStyles,p=i.activityTypeComboBoxStyles,d=Object(R.h)(e,r.relationshipName,ie(t.contextString)),g=!Object(N.b)(e),m=Object(y.kb)(e,o,r),f=Object(h.g)(e),v=Object(T.a)(e),b=Object(L.g)(e,o),_=b.entityFilterValue,S=b.activityTypeFilterValue,C=Object(M.a)(e,k.a,k.h),O=Object(M.a)(e,k.a,k.Lc),P=Object(y.ub)(e,a),j=Object(M.c)(e,k.Zc),E=Object(B.a)(a,e.user.userId,r,j,P),F=E&&E.getFilterLabelResourceKey(),A=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!le||le.id!==o||le.entityTypeName!==a||le.filterOptions!==s||le.comboBoxStyle!==u||le.dueDatecomboBoxStyle!==l||le.activityTypecomboBoxStyle!==p||le.labelStyle!==i.filterLabelStyle||le.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||le.isActivityManagementFeatureEnabled!==C||le.filterOptionsForActivityType!==c||le.isRollupViewSupported!==d||le.isOffline!==g||le.toggleValue!==m||le.isRTL!==f||le.theme!==v||le.previousValue!==_||le.activityTypePreviousValues!==S||le.isActivityFilterSelectAllEnabled!==O||le.entityIsActivityType!==P){var w={isRollupViewSupported:d,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:f,theme:v};le=Object(n.__assign)({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:u,dueDatecomboBoxStyle:l,activityTypecomboBoxStyle:p,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:S,isActivityManagementFeatureEnabled:C,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:F,activityTypeFilterLabelResourceString:A,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:O,isRTL:f,entityIsActivityType:P},w)}return le}),ct=(pe=null,de=[1041,2052,3076,1028,1042],function(e,t,r,n,a,i){var o=e.id,s=e.descriptor&&e.descriptor.Id?e.descriptor.Id:null,c=a?JSON.parse(a).conditions[0]:null,u=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){var r=me(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(m.c)(i,I.JUMPBAR_ALPHABET),c);return de.indexOf(n)>-1?pe=null:pe&&pe.id===o&&pe.contextToken===t&&pe.entityTypeName===r&&pe.selectedFilter===u||(pe={id:o,uniqueId:s,contextToken:t,entityTypeName:r,selectedFilter:u,languageId:n}),pe}),ut=(ge=null,function(e,t,r,n){var a=e.id,i=e.contextString;return ge&&ge.id===a&&ge.contextToken===t&&ge.entityTypeName===r&&ge.gridInput===n||(ge={id:a,contextToken:t,entityTypeName:r,contextString:i,gridInput:n}),ge}),lt=(be=null,function(e,t,r){var n=e.id,a=e.contextString;return be&&be.id===n&&be.contextToken===t||(be={id:n,contextToken:t,contextString:a}),be}),pt=Object(m.h)(),dt=(Se=null,Ce=null,Pe=null,ke={useSkypeProtocol:Oe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},gridPageNumber:Ie={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},isNewPageRequested:je={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},enhancedPagingDisabled:Te={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},isActivityTypeFilterDisabled:Ee={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},showAddNewCommand:Fe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptySubgridIconAndTextChanges:Ae={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptyGridChangesIfQuickFindImprovementsEnabled:xe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},headerDialogOnTop:we={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},headerDialogPreventDismissOnScroll:Ne={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1}},function(e,t,r){var a=Object(E.e)(e),s=Object(g.x)(e).useSkypeProtocol,c=Object(y.x)(e,t.id,r),u=Object(y.X)(e,t.id,r);u||Pe===c||(Pe=c),ye||(ye=Object(P.a)(e),_e=null!=ye&&ye===j.b.Native);var l=!_e,p=Object(M.a)(e,k.a,k.h),d=t.systemDefinedProperties,h=c!==Pe&&u,m=l!==Te.Value,f=!1;p&&(ie(t.contextString)||ae(t.contextString))&&(f=!0);var v=!1;Object(z.a)(e)&&ne(t.contextString)&&(v=!0);var b=!1;Object(z.a)(e)&&Object(M.c)(e,k.Md)&&ne(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication&&(b=!0);var _=!1;if(Object(z.a)(e)&&Object(M.c)(e,k.ad)&&ae(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication){var S=Object(y.C)(e,t.id,r);(null==S?void 0:S.quickFind)&&(_=!0)}var C=!ae(t.contextString)&&i.a.Tablet===a,O=i.a.Tablet===a&&!ie(t.contextString)||"Web"===Object(E.k)(e)&&!re.a.getInstance().get_IsAndroid()&&!re.a.getInstance().get_IsWindows()&&!re.a.getInstance().get_isIPhone();if(a!==Se||s!==Ce||h||m||u!==je.Value||f!==Ee.Value||v!==Fe.Value||b!==Ae.Value||_!==xe.Value||C!==we.Value||O!==Ne.Value){Se=a,Ce=s,Ie.Value=c,Pe=c,je.Value=u,Te.Value=l,Ee.Value=f,Fe.Value=v,Ae.Value=b,xe.Value=_,we.Value=C,Ne.Value=O;var I=null==Se?s:null;(I!==Oe.Value||h||m)&&(Oe.Value=I,ke=Object(n.__assign)(Object(n.__assign)({},d),{useSkypeProtocol:Oe,gridPageNumber:Ie,isNewPageRequested:je,enhancedPagingDisabled:Te,isActivityTypeFilterDisabled:Ee,showAddNewCommand:Fe,emptySubgridIconAndTextChanges:Ae,emptyGridChangesIfQuickFindImprovementsEnabled:xe,headerDialogOnTop:we,headerDialogPreventDismissOnScroll:Ne}))}return ke}),ht=(Me=null,De=null,function(e,t,r){return e&&(De&&Me===e&&!r||(De=Object(n.__assign)({},e),e.Parameters&&(De.Parameters=Object(n.__assign)({},e.Parameters),t&&e.Parameters[t]&&(De.Parameters[t]=Object(n.__assign)({},e.Parameters[t]),e.Parameters[t].Columns&&(De.Parameters[t].Columns=e.Parameters[t].Columns.slice(0)))),Me=e)),De}),gt=Object(F.s)(),mt=(Re=[],function(e,t,r,n,a,i,o,s,c,u,l){return Re&&Re.length&&Re.splice(0,Re.length),Re.push({name:V.b.IsGridRoot,value:e},{name:V.b.IsSubGrid,value:t},{name:V.b.IsAssociatedGrid,value:r},{name:V.b.EntityName,value:n},{name:V.b.ViewId,value:a},{name:V.b.IsEmptyFetch,value:i},{name:V.b.IsEmptyOfflineSqlQuery,value:o},{name:V.b.IsValidFetchXmlForOfflineUsage,value:s},{name:V.b.IsEntityAvailableForOfflineUsage,value:c},{name:V.b.OfflineConfigurationErrorCode,value:u},{name:V.b.RelatedEntityUnavailableOffline,value:l}),Re}),ft=(Le=null,function(e){return Le||(Le={isGridPaginationStateFeatureEnabled:Object(M.a)(e,k.zb),isAssociatedGridHeightEnabled:Object(R.e)(e),isChartOnAssociatedGridEnabled:Object(M.a)(e,k.x,k.h,k.i),isGridProgressIndicatorFeatureEnabled:Object(M.a)(e,k.Ab),isInMobileModeForOct2019:Object(z.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(M.a)(e,k.ac),isJumpbarFeatureForMobileEnabled:Object(M.c)(e,k.Kb),isSuiterChartEnabled:Object(M.a)(e,k.Od,k.h),isSuiterDashboardEnabled:Object(M.a)(e,k.Pd,k.h),isAdvancedFindEnabled:Object(J.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(M.c)(e,k.O),isInMobileModeForApril2020:Object(z.a)(e),isSubgridImprovementsEnabled:Object(M.c)(e,k.Md),isSubGridAutoCollapseEnabled:Object(M.a)(e,k.Jd,k.Lc),isSubGridRemoveMinHeightEnabled:Object(M.a)(e,k.Ld,k.Lc),isQuickFindImprovementsEnabled:Object(M.c)(e,k.ad),isShowAsButtonFirstEnabled:Object(M.c)(e,k.Bd),isColumnEditorButtonEnabled:Object(y.tb)(e),isQueueFilterPerfUCIEnabled:Object(M.c)(e,k.Zc)}),Le}),vt=(Ve={fetchXML:null,entityName:null,isOffline:null},Be={error:!1,errorCode:null,relatedEntityUnavailableOffline:null},function(e,t,r,n){if(Ve.entityName!==r||Ve.fetchXML!==t||Ve.isOffline!==n)if(Object(w.k)(r)){var a=Object(w.b)(e,t);Be={error:a.error,errorCode:a.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:a.relatedEntityUnavailableOffline},Ve={fetchXML:t,entityName:r,isOffline:n}}else Be={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},Ve={fetchXML:t,entityName:r,isOffline:n};return Be});return function(t,r){var i,o=Object(h.w)(t),c=rt(t,r),u=Object(y.v)(t,r.id,c),l=c.relationshipName,v=c.roleOrd,_=Object(y.N)(t,r.id,c),S=Object(y.I)(t,r.id,c),C=Object(y.x)(t,r.id,c),O=r.descriptor,F=ve.bind(null,r,O),V=r.configuration,G=V&&V.CustomControlId?V.CustomControlId:null,z=Object(P.a)(t),W=Object(E.e)(t),H=Object(y.ab)(t,G)||(r.contextString===b.h.CUSTOM?b.g:null),Q=ae(r.contextString),J=ft(t),re=Object(y.A)(t,c,r),se=null,ce=!1,le=null,pe=Object(y.t)(t,r.id,c),de=Object(y.C)(t,r.id,c);Q&&(se=Object(L.g)(t,r.id),J.isGridPaginationStateFeatureEnabled&&((le=se.gridSortingInfo)&&(Object(A.a)(Qe)||Qe!==le)&&(Qe=le,ce=!0),pe&&(Object(A.a)(Ke)||Ke!==pe.customFilterXml)&&(Ke=pe.customFilterXml,ce=!0)),(de&&Object(A.a)(Je)||Je!==de)&&(Je=de,ce=!0));var ge=ht(V,H,ce),me=ge&&ge.Parameters?ge.Parameters[H]:null,be=ie(r.contextString),ye=ne(r.contextString),_e=!Object(N.b)(t),Se=Object(y.jb)(t,c,r),Ce=me&&!!me.DataProvider,Oe=me&&!!me.BoundViewParams,Ie=Object(g.x)(t),Pe=Ie&&Ie.gridTotalRecordCountLimit?Ie.gridTotalRecordCountLimit:5e3,je=Object(y.ib)(t,r.id,c),Te=ue(r.configuration),Ee=ue(r.configuration);if(null!=r.nonCompositionProps){var Fe=V&&V.FormFactor&&V.FormFactor.toString(),Ae=Object(D.c)(r.nonCompositionProps.gridConfigurations,r.nonCompositionProps.viewConfigurations,V,null,b.h.GRID,Fe).map((function(e){return e.configuration.DisplayNameKey})),xe=pt(t,Ae);(!Ye&&""!==Object(m.c)(xe,Ae[0])||Ye!==xe)&&(Ye=xe)}var we=!!u,Ne=Object(y.T)(t,r.id,c)||(O&&O.Parameters&&O.Parameters.ViewId?a.a.parse(O.Parameters.ViewId):null),ke=Object(y.qb)(t,Ne,r.id),Me=(null==ke?void 0:ke.isUserView)?p.b.userview:p.b.savedview,De=null==ke?void 0:ke.queryType,Re=null==ke?void 0:ke.entityLogicalName;Re&&Re!==qe&&(qe=Re);var Le=Object(d.h)(t,qe),Ve=!_e&&z===j.b.Web&&Q&&J.isAdvancedFindEnabled&&(null==Le?void 0:Le.IsValidForAdvancedFind);if(!He||e!==Ve){var Be=Object(n.__spreadArrays)(I.labelList);Ve&&(Be=Object(n.__spreadArrays)(Be,[K.c.OpenAdvancedFiltersTitleAndAria]));var bt=pt(t,Be);""!==Object(m.c)(bt,I.JUMPBAR_ALL_TITLE)?(He=bt,e=Ve):we=!1}var yt=Object(y.W)(t,G);yt&&yt!==We&&(We=yt);var _t=tt(t,r);ue(r.configuration)&&(Object.assign(_t.bodyStyle,{flexDirection:"column"}),Object.assign(_t.bodyMobileStyle,{flexDirection:"column"}));var St=Object(y.F)(t,r.id,c)||(O&&O.Parameters&&O.Parameters[b.u]?O.Parameters[b.u]:null),Ct=St;Q&&(Ct=se.entityTypeName);var Ot=Object(x.b)(t,St);Le&&Le.Initialized===s.a.Initialized||Ce||Oe||(we=!1);var It=Le?Le.DisplayName:"",Pt=Object(g.t)(t),jt=Object(d.i)(t,St),Tt=!(ke&&ke.fetchXML),Et=ke&&ke.viewId,Ft=vt(t,Tt?"":ke.fetchXML,qe,_e),At=!Tt&&!Ft.error,xt=null!=ke&&Object(A.b)(ke.offlineSqlQuery),wt=Object(w.l)(t,qe),Nt=mt(Q,ye,be,qe,Et?Et.guid:null,Tt,xt,At,wt,Ft.error&&Ft.errorCode||"",Ft.error&&Ft.relatedEntityUnavailableOffline||""),kt=!((Q||be||ye)&&ke&&ke.fetchXML&&_e&&wt)||!xt&&At,Mt="";if(kt?wt||(Mt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):xt?Mt=I.SQL_QUERY_NOT_AVAILABLE:Ft.error&&(Mt=Ft.errorCode),me){me.TargetEntityType&&St!==me.TargetEntityType&&(St=me.TargetEntityType),me.ExtraFilters=he(t,r,c,de,!1);var Dt=function(e,t,r,n,a){var i=[],o=Object(y.q)(e,t.id,r);if(o){var s=JSON.parse(o);if(s.conditions)for(var c=0,u=s.conditions;c<u.length;c++){var l=u[c];l.linkEntityExpressions&&(i=i.concat(l.linkEntityExpressions))}}var p=e.user&&e.user.userId,d=Object(M.c)(e,k.Zc),h=Object(y.ub)(e,n),g=Object(B.a)(n,p,r,d,h),m=g&&g.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:X.a,a&&!a.activityOrQueue);m&&m.linkEntities&&(i=i.concat(m.linkEntities));return(m=m||{filter:null,linkEntities:null}).linkEntities=i,m}(t,r,c,St,de);if(Dt&&Dt.filter&&(me.ExtraFilters?me.ExtraFilters.push(JSON.stringify(Dt.filter)):me.ExtraFilters=[JSON.stringify(Dt.filter)]),Dt&&Dt.linkEntities&&Dt.linkEntities.length>0){var Rt={Static:!0,Value:Object(q.b)(Dt.linkEntities)};if(me.LinkingInput){Rt=me.LinkingInput;var Lt=Object(q.a)(me.LinkingInput.Value);if(Lt){var Vt=new U.a;Lt.forEach((function(e){Vt.addLinkedEntity(e)})),Dt.linkEntities.forEach((function(e){Vt.addLinkedEntity(e)})),Rt.Value=Object(q.b)(Vt.getLinkedEntities())}}me.LinkingInput=Rt}if(Ne){var Bt=a.a.toString(Ne);Bt!==me.ViewId&&(me.ViewId=Bt)}else Ne=a.a.tryParseOrNull(me.ViewId);(O&&O.Parameters?"false"===O.Parameters[b.F.ENABLE_CONTEXTUALACTIONS]:null)&&(ge.Parameters[b.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}St&&St!==Ue&&(Ue=St);var Gt=Object(d.r)(t,St)&&r.contextString===b.h.GRID?y.a:St,Xt=me&&me.CommandBarContext,qt=et(t,r,Gt,Xt),Ut=function(e,t,r){var n=Object(y.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(t,Ne,r.id),zt=null==Ut?void 0:Ut.map((function(e){return e.name})),Wt=null==Xe?void 0:Xe.map((function(e){return e.name}));(JSON.stringify(zt)!==JSON.stringify(Wt)||(Ne&&Ne.guid)!==(Ge&&Ge.guid)||l===Ze&&v!==$e)&&(Ge=Ne,$e=v,ze=(O&&O.Id?O.Id:"")+(new Date).getTime(),Xe=Ut),l&&l!==Ze&&(Ze=l);var Ht=Object(y.o)(t,St),Yt=Ht?Ht.lookupAttribute:null;me&&(function(e,t,r,n,a,i,o){var s=Object(d.h)(e,n);if(s&&ue(t.configuration)){var c=b.b;r.Columns||(r.Columns=[]),n!==y.a||a&&a.some((function(e){return e.name===c}))||r.Columns.find((function(e){return e.Name===c}))||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});var u=s&&s.PrimaryNameAttribute,l=a&&a.some((function(e){return e.name===u}));if(!u||l||r.Columns.some((function(e){return e.Name===u}))||r.Columns.push({Alias:u,DataType:"",Type:"",Name:u}),!Object(y.vb)(t.configuration.Parameters)){var p=Object(R.a)(s.PrimaryImageAttribute);p&&!r.Columns.find((function(e){return e.Name===p}))&&r.Columns.push({Alias:Y.d,DataType:"SingleLine.Text",Type:"",Name:p}),Object(M.a)(e,k.ub)&&i&&o&&(r.Columns.find((function(e){return e.Name===y.c}))||r.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),r.Columns.find((function(e){return e.Name===i}))||r.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(t,r,me,St,Xe,Yt,!Object(A.a)(se)),function(e,t,r,n,a){if(!Object(y.vb)(t.configuration.Parameters))return;(null==a?void 0:a.some((function(t){var r;return(null===(r=Object($.a)(e,n,t.name))||void 0===r?void 0:r.Type)===ee.a.moneyType})))&&(r.Columns.some((function(e){return e.Alias===b.A}))||r.Columns.push({Alias:b.A,DataType:"Lookup.Simple",Type:"",Name:Y.w}))}(t,r,me,St,Xe));var Qt=!St||(Object(x.i)(St)||Object(x.g)(t,St,2,0)&&function(e,t){var r=!0;t&&t.forEach((function(t){if(t.relatedEntityName&&!(r=Object(x.g)(e,t.relatedEntityName,2,0)))return!1}));return r}(t,Xe)),Kt=Object(y.Y)(t,r.id,c),Jt=Kt?JSON.parse(Kt):null,Zt=Jt?Jt.totalResultCount:null,$t=Jt?Jt.pageSize:null,er=null!==Zt&&Zt>-1?0===Zt?Object(m.c)(He,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Zt):"",tr=gt(t,Q),rr=!(null!=z&&z===j.b.Native),nr=Object(y.rb)(t,null===(i=null==se?void 0:se.pageToEditedViewMapId)||void 0===i?void 0:i.guid,null==Ne?void 0:Ne.guid),ar={isEmptyOfflineSqlQuery:xt,isEntityAvailableForOffline:wt,isOfflineSqlQueryAvailable:kt,offlineErrorMessageKey:Mt,isOfflineAvailableForUse:Object(Z.w)(t),offlineGridErrorTelemetryParams:Nt},ir=Object(te.d)(t),or=Object(f.c)(t,Ge),sr=!_e&&z===j.b.Web&&Q&&J.isColumnEditorButtonEnabled&&!be&&!ye,cr=Object(y.ub)(t,St);return{showAdvancedFilter:Ve,isViewEdited:!!nr,isInitialized:we,viewId:Ge,customFilter:pe,gridEntityTypeName:qe,chartEntityTypeName:qe,isUCIEntity:Ot,totalRecordCountLimitExceeded:Se,chartProps:je?nt(t,r,c):null,viewDescriptor:ke,commandBarProps:F(b.E.COMMANDBAR_ENABLED,!0,b.F.ENABLE_CONTEXTUALACTIONS,H,!0)?at(t,r,c,O,qt,_t):null,viewSelectorProps:Ct&&F(b.E.VIEWSELECTOR_ENABLED,!0,b.F.ENABLE_VIEW_PICKER,H)?it(t,r,c,Ct,Ge,_t):null,queueFilterProps:V&&F(null,!0,b.F.ENABLE_QUEUEFILTER,H)?ot(t,r,c,St,_t):null,entityFilterProps:_e||!cr&&!Object(R.h)(t,Ze,be)?null:st(t,r,c,St,_t),jumpBarProps:F(b.E.JUMPBAR_ENABLED,Te,b.F.ENABLE_JUMPBAR,H)&&fe(r)?ct(r,c,St,o.languageId,de?de.jumpBar:null,He):null,quickFindProps:F(b.E.QUICKFIND_ENABLED,!0,b.F.ENABLE_QUICKFIND,H)?ut(r,c,St,se):null,pagingProps:F(b.E.PAGING_ENABLED,Ee,null,H)?lt(r,c,St):null,contextToken:c,controlKey:ze,styles:_t,refreshCounter:_,pagingRefreshInput:S,pageNumber:C,ribbonId:qt,semanticTag:oe(r.contextString),recordsPerPageSetting:Object(h.h)(t),userSetting:o,hasReadRolePrivilege:Qt,resourceStrings:He,switchVisualizationResourceStrings:Ye,entityTypeName:Ue,primaryDataSetName:H,nestedGridDatasetName:We,viewportSm:Object(T.a)(t).sizes.Breakpoints.DimensionS,viewportM:Object(T.a)(t).sizes.Breakpoints.DimensionM,systemDefinedProperties:dt(t,r,c),platformType:Object(P.a)(t),isGridEditable:Object(y.vb)(V?V.Parameters:null),notificationMessage:er,totalResultCount:Zt,pageSize:$t,offlineProps:ar,isRTL:Object(h.g)(t),entityDisplayName:It,isOffline:_e,showChart:je,entityIconVectorName:jt,webResourceUrl:Pt,hasCustomDataProvider:Ce,commandBarRefreshProps:tr,updatedConfiguration:ge,offlineGridErrorTelemetryParams:Nt,gridInput:se,gridTotalRecordsCountLimit:Pe,gridSortingInfo:le,nativeFilterExpression:J.isGridPaginationStateFeatureEnabled&&se?se.nativeFilterExpression:null,pageNumberForEnhancedPaging:J.isGridPaginationStateFeatureEnabled&&!rr&&se?se.gridPageNumber:null,userId:t.user&&t.user.userId||null,lookupAttributeForRecordHierarchy:Yt,fetchXML:re,viewType:Me,savedQueryType:De,featureControlProps:J,clientHostSubtype:W,backButtonEnabled:ir,originalView:or,showColumnEditor:sr,entityIsActivityType:cr}}}function he(e,t,r,n,a){if(!n)return[];var i=ae(t.contextString),o=ie(t.contextString),s=ne(t.contextString)&&Object(M.c)(e,k.bd),c=[];for(var u in n)c.push([u,n[u]]);var l=c.reduce((function(e,t){var r=t[0],n=t[1];return(i||o||s)&&"quickFind"===r||("activityOrQueueFilterValue"===r||"activityTypeSelectedValues"===r)||!n||e.push(n),e}),[]);if(a){var p=Object(y.t)(e,t.id,r);if(p&&p.customFilterXml){var d=Object(G.i)(p.customFilterXml),h=JSON.stringify(d);h&&l.push(h)}}else{var g=Object(y.q)(e,t.id,r);g&&l.push(g)}return l}function ge(e){var t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function me(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));var t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function fe(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function ve(e,t,r,n,a,i,o){var s=e.dataSetUIOptions,c=n;if(o=!!Object(A.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){var u=e.configuration.Parameters[i];u&&u[b.f]&&(s=u[b.f])}var l=t&&t.Parameters&&t.Parameters[a]?"true"===t.Parameters[a]:o;return s&&r&&!Object(A.a)(s[r])&&(c=s[r]),c&&l}},slAZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"e",(function(){return u}));var n=r("Sscr"),a="controls.addCustomFilter",i="controls.startCustomFilter",o="controls.endCustomFilter";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:{customFilter:o,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,r){var a=Object(n.v)(r);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}function u(e,t,r){var a=Object(n.v)(r);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}},uCYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="footer.visible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},vqdi:function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n=r("OROb"),a=r("lMVv"),i=r("sgPk"),o=r("C8Q/"),s=r("ig6i"),c=r("cm3g"),u=r("9r0m"),l=r("HSdq"),p=r("Sscr"),d=r("sOTk"),h=r("Gemh"),g=r("0hZT"),m=r("fE8x"),f=r("r454"),v=r("cZkS"),b=r("qC0c"),y=r("EcZf"),_=r("YEEA");function S(e,t,r,S,C,O,I,P){return void 0===I&&(I=!1),{type:"embeddedEntity.save",execute:function(S,j){var T,E=S.getState(),F=new u.a(r),A=Object(p.f)(P,F,t);switch(Object(d.l)(E,e)){case g.a:T=Object(h.R)(E,e,A);break;default:T=Object(l.ac)(E,e,A)}var x=Object(m.c)(E),w=Object(m.b)(E);if((x||w)&&"Dashboard"!==Object(d.l)(E,e)){var N=j.ScriptManager.getContainer(e).getEventManager();if(S.dispatch(N.runOnSave(P,1,null,r)))return Promise.reject(Object(_.b)(E,e,2200000005,""))}return S.dispatch(Object(n.c)(T,I,C)).then((function(n){var l=Object(h.qb)(E,new u.a(O),e),p=Object(a.h)(E,t),d=i.a.fromXmlAndSql(l.fetchXML,l.offlineSqlQuery,l.viewId,null,l.entityLogicalName,S.getState);return d.where(new o.a("eq",new s.a(t,p.PrimaryIdAttribute),new c.a(r))),S.dispatch(Object(y.d)(d.getQueryState())).then((function(){return n}))})).catch((function(e){return Object(b.a)(E,v.xb)&&T&&S.dispatch(Object(f.b)(T,!1)),Promise.reject(e)}))}}}},w82B:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("cZkS"),a=r("9r0m"),i=r("G7N+"),o=r("9LTA"),s=r("8Fmj"),c=r("7dGM"),u=r("dUXI"),l=r("y5DA"),p=r("gBKR"),d=r("mGpW"),h=r("olrR"),g=r("Ww2r"),m=r("RlP9"),f=r("kl3Z"),v=r("+Z9T"),b=r("vUcA"),y=r("Z46F"),_=r("WS0f"),S=r("KDdL"),C=r("8ADW");function O(e,t,r){return{type:"chartData.retrieve.preReq_async",execute:function(n,O){var I=n.dispatch,P=n.getState,j=P(),T=C.b+".chartData.retrieve.preReq_async",E=e.visualizationId,F=e.viewId;return I(Object(h.a)(t,void 0,e.viewType,F)).then((function(){j=P();var n=Object(m.c)(j,F);if(!function(e,t,n,a){if(!n||!n.fetchXML)return Object(l.a)(e,t,Object(g.b)(e,u.g),a,r),!1;return!0}(j,I,n,e))return Promise.resolve(null);var h=I(Object(s.a)(t,e.visualizationType,E)),v=I(Object(d.e)(u.A));return Promise.all([h,v]).then((function(){var t,s;j=P();var h=Object(c.a)(j,E);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(h))return Object(o.d)(j,I,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,a){if(n){if(n.initialized===i.a.Error){var o=Object(b.a)(n.errorCode)||u.u;return t(Object(d.e)([o])).then((function(){var n=Object(g.b)(e,o);Object(l.a)(e,t,n,a,r)}),(function(){Object(l.a)(e,t,Object(g.b)(e,u.u),a,r)})),!1}return!!n.DataDescription||(Object(l.a)(e,t,Object(g.b)(e,u.o),a,r),!1)}return!1}(j,I,h,e))return Promise.resolve(null);e.initialized||(e.initialize(h.DataDescription,n.fetchXML,h.PresentationDescription,n.title,n.entityLogicalName,h.Name,h.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());var m={},v=e.dataDefinition.allAttributeNamesByEntity;Array.from(v.keys()).map((function(e){var t=Array.from(v.get(e).keys());m[e]=t}));var y=Object(f.c)(n).filter((function(e){return-1===e.indexOf(".")}));if(y&&y.length>0){var C=n.entityLogicalName;C in m?(t=m[C]).push.apply(t,y):m[C]=y}try{var F=h.PresentationDescription,A=Object(S.a)(F);if(!Object(_.b)(F)&&A.length>0){var x=n.entityLogicalName,w=[];w.push(function(e,t){var r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(x,A)),x in m?(s=m[x]).push.apply(s,w):m[x]=w}}catch(e){var N="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;O.EventManager.ReportComponentFailure(T,Error(N))}return I(Object(p.e)(m)).then((function(){return e}))}),(function(t){return Object(l.b)(t.getNegativeErrorCode(),P(),I,Object(g.b)(P(),u.q),e,r),Promise.resolve(null)}))}),(function(t){var n=t&&!Object(v.a)(t.errorCode)&&t.errorCode,a=Object(b.a)(n),i=a?Object(g.b)(j,a):"retrieve chart failed. error code: "+y.a.getHexErrorCodeFromInt(n);return Object(l.a)(j,I,i,e,r),Promise.resolve(null)}))}}}var I=r("Fpc+"),P=r("qC0c");function j(e,t,r,s){return void 0===s&&(s=!1),{type:"chartData.retrieve.async",execute:function(u,l){var p=u.dispatch,d=u.getState,h=[];try{h.push({name:C.g,value:a.a.toString(e.viewId)}),h.push({name:C.h,value:a.a.toString(e.visualizationId)});var g=d(),m=e.visualizationId,f=a.a.toString(m),v=e.viewId,b=a.a.toString(v);if(!Object(S.b)(d,p,l,h,e,t,r))return Promise.resolve();var y=void 0,_=Object(P.c)(g,n.rd);return((y=_?Object(c.e)(g,e.getStorageKey()):Object(c.d)(g,f,b))===i.a.Initialized&&Object(c.b)(g,f,b)||y===i.a.Initializing)&&!s?Promise.resolve():(p(_?Object(S.d)(e.getStorageKey(),I.c):Object(S.c)(f,b,I.c)),p(O(e,t,r)).then((function(e){if(!e||e.isWebResourceChart)return Promise.resolve();var n=e;return p(Object(o.b)(n,t,r))})))}catch(e){return l.EventManager.ReportComponentFailure(S.f+".retrieveChartData",Error(e),C.b,h),Promise.reject(e)}}}}},whwt:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return y}));var n=r("Sscr"),a=r("uO/V"),i=r("8Fmj"),o=r("RlP9"),s=r("9r0m"),c=r("Gemh"),u=r("7dGM"),l=r("lMVv"),p=r("Zdrd"),d=r("cqI9"),h=r("z9yS"),g=r("mGpW"),m=r("dUXI"),f=r("JlqV"),v=r("zETL"),b="chart.showChart.update";function y(e,t,r){return{type:"chart.showChart.update.async",execute:function(b,y){var S=b.dispatch,C=b.getState,O=y.TraceManager.getTracer(a.z),I=a.x+".updateShowChartAction";try{O.info("Updating the show chart"),t||(t=Object(n.k)(C(),e));var P=C(),j=Object(n.v)(t),T=Object(c.T)(P,e,t),E=Object(o.c)(P,T),F=E&&E.entityLogicalName,A=Object(c.r)(P,e,t,F),x=Object(c.s)(P,e,t),w=Object(u.a)(P,A),N=w&&w.PrimaryEntityTypeCode,k=N&&Object(l.m)(P,parseInt(N,10));F&&k&&F!==k&&(A=null,x=h.a.savedvisualization);var M=Object(u.i)(P,F);if(A&&M&&M.chartTypes&&Object.keys(M.chartTypes).length>0){var D=s.a.toString(A);x=D in M.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}return r?Object(f.b)(C())?(S(Object(g.e)(m.A)).then((function(){S(Object(i.a)(F,x,A)).then((function(r){return s.a.isNullOrEmpty(r)?(x=h.a.uservisualization,S(Object(p.b)(e,t,x)).then((function(){return S(Object(i.a)(F,x,A)).then((function(e){return Promise.resolve(e)}))}))):Promise.resolve(r)})).then((function(n){var a=s.a.toString(n);Promise.all([S(Object(d.b)(e,t,a)),S(Object(p.b)(e,t,x)),S(_(e,j,r))]).then((function(){return y.EventManager.ReportComponentSuccess(I),S(Object(v.b)(e,t)),Promise.resolve()}))}))})).catch((function(e){return y.EventManager.ReportComponentFailure(I,Error("Retrieve resource strings for chart failed")),Promise.reject(e)})),Promise.resolve()):Promise.resolve():(S(_(e,j,r)),y.EventManager.ReportComponentSuccess(I),Promise.resolve())}catch(e){var R="Update the show chart failed with error : "+e.message;y.EventManager.ReportComponentFailure(I,Error(R))}}}}function _(e,t,r){return{type:b,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},x6Ak:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="refresh.timer";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:i,controlName:r}}}},xirW:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("UOiB"),a=r("Sscr"),i=r("krRo"),o="attribute.notification.update";function s(e,t,r,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute:function(e,u){e.dispatch(function(e,t,r,s){if(s&&s.contextTokenType&&s.contextTokenType===n.a.GridRow)return Object(i.d)(e,s,t,r);var c=Object(a.x)(s);return{type:o,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,s,c))}}}},y5DA:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("9LTA"),a=r("Ww2r"),i=r("dUXI"),o=r("BuSU"),s=r("Je7O"),c=r("cZkS"),u=r("qC0c"),l=r("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t,r,n,o){var s=null;if(s=Object(a.b)(e,i.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:s=Object(a.b)(e,i.r);break;case-2147220960:s=Object(a.b)(e,i.o);break;case-2147164125:s=Object(a.b)(e,i.a);break;case-2147164130:case-2147164126:s=Object(a.b)(e,i.j);break;case-2147217149:s=Object(a.b)(e,i.i);break;case-2147217098:s=Object(a.b)(e,i.x);break;case-2147220969:case-2147187962:s=Object(a.b)(e,i.p);break;default:r.get_Message()&&(s=s+" "+r.get_Message())}d(e,t,s,n,o)}function d(e,t,r,a,i){var p;p=function(e){var t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(u.c)(e,c.rd)?(t(Object(n.a)(a.getStorageKey(),p)),Object(n.e)(e,t,a.getStorageKey(),i)):(t(Object(n.c)(l.a.toString(a.visualizationId)||l.a.EMPTYGUIDSTRING,l.a.toString(a.viewId)||l.a.EMPTYGUIDSTRING,p)),Object(n.d)(e,t,l.a.toString(a.visualizationId)||l.a.EMPTYGUIDSTRING,l.a.toString(a.viewId)||l.a.EMPTYGUIDSTRING,i))}function h(e,t,r,n,o,s){d(t,r,-2147220960===e?Object(a.b)(t,i.o):n,o,s)}},ya7l:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("4Tx6"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,u){var l={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:i,powerBITileId:o,powerBIReportId:s,powerBIReportUrl:c,powerBIComponentTypeCode:u};return Object(a.a)(n.a,l,e,{target:"dialog"})}},zvr0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("Sscr"),i=r("uQP8"),o="control.update.unboundOutputs";function s(e,t,r,s){return{type:"control.update.unboundOutputs.async",execute:function(c){var u=c.dispatch,l=c.getState;if(!Object.keys(s).length)return Promise.resolve();var p=l(),d=Object(i.a)(p,e),h=!1,g=Object(a.v)(r),m=Object(n.__assign)({},d.forms[g].controlUnboundOutputs);for(var f in s){var v=s[f],b=t+"."+f;m[b]!==v&&(m[b]=v,h=!0)}return h&&u(function(e,t,r){return{type:o,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,g,m)),Promise.resolve()}}}}}]),window.bundleExecutionMarkers["scripts/es5/benchmarkpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();