(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/7.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[7],{"5ZRb":function(t,e,o){"use strict";o.d(e,"a",(function(){return n})),o.d(e,"c",(function(){return r})),o.d(e,"b",(function(){return a})),o.d(e,"d",(function(){return i})),o.d(e,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Web.CommandBar.ErrorLoading_Message",r="Web.CommandBar.MoreCommands_ToolTip",a="Web.CommandBar.MoreCommandsForEntity_ToolTip",i="Command_Bar_Label",s=["Web.CommandBar.Loading_Message",n,r,a,i]},"6Tlt":function(t,e,o){"use strict";o.d(e,"a",(function(){return ot}));var n=o("c/eZ"),r=o("nuS9"),a=o("4pqm"),i=o("4E+q"),s=o("iyBA"),d=o("cZkS"),l=o("qC0c"),u=o("s5BY"),m=o("I0a0"),c=o("Ww2r"),p=o("H/hG"),h=o("YWpA"),y=o("QAhb"),b=o("9r0m"),f=o("G7N+"),C=o("wQXd"),I=o("Lzoj"),_=o("QS6j"),S=o("e2pn"),g=o("y3ek"),B=o("8JH3"),v=o("J7ta"),M=o("kRDR"),O=o("spnp"),x=!1;var j=o("dEPU"),L=o("bFFS"),R=o("eQSW"),T=o("f0hy");var E=o("KZAz"),D=o("MtNf"),k=o("haDr"),w=o("Wg6j"),P=o("5ZRb"),F=o("GulM"),z=o("5ZFm"),A=o("Fas2"),N=o("RImw"),W=o("pdGj"),G=o("EevF"),q=o("UOiB"),Z=o("Sscr"),H=o("oVzJ"),K=o("lokH"),J=o("1GLu"),Q=o("9S+1"),V=o("7EJx"),U=o("vO+w"),Y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._startedInitializing=!1,e}return Object(n.__extends)(e,t),e.prototype.componentWillUnmount=function(){this.props.destroyCommandBar(this.props.commandManagerId||this.props.id)},e.prototype.componentDidMount=function(){this._handleProps(this.props)},e.prototype.componentDidUpdate=function(t){this._handleProps(t)},e.prototype.render=function(){if(this._isNativeCommandManager())return null;var t=this.props.customCommandManagerStyle?this.props.customCommandManagerStyle:{float:"right"};if(this.props.isRTL?t.paddingRight=0:t.paddingLeft=0,!this.props.commandBarEnabled&&(this.props.isDashboardCommandBar||this.props.ruleContext&&(this.props.contextToken&&this.props.contextToken.contextTokenType===q.a.MainGrid&&1===this.props.ruleContext.ContextType||2===this.props.ruleContext.ContextType||5===this.props.ruleContext.ContextType)))return null;if(!Object(F.c)(this.props.commandManagerId,!0)){if(this.props.initializeMetadataFailed){if(this._isLoadingStringDisabled())return null;var e=Object(c.c)(this.props.resourceStrings,P.a);return r.createElement(h.a,{style:t},r.createElement(p.a,{style:Object(w.l)()},e))}if(!this.props.initializationCompleted)return this._isLoadingStringDisabled()?null:r.createElement(h.a,{style:t})}var o=this.props.contextToken?Object(Z.v)(this.props.contextToken):null,n=null;return null!==this.props.selectedRecords&&void 0!==this.props.selectedRecords?n=this.props.selectedRecords:this.props.ruleContext&&null!==this.props.ruleContext.SelectedItems&&void 0!==this.props.ruleContext.SelectedItems&&(n=this.props.ruleContext.SelectedItems.map((function(t){return t.EntityReference}))),r.createElement(h.a,{style:t},this.props.isHidden?null:r.createElement(k.b,{commandbarDisplayMode:this.props.commandbarDisplayMode,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,width:this.props.width,mainMenuLength:this.props.mainMenuLength,iconPosition:this.props.iconPosition,commandManagerId:this.props.commandManagerId?this.props.commandManagerId:this.props.id,pageId:this.props.id,ribbonDescriptor:this.props.ribbonDescriptor,selectedRecords:n,executeCommand:this._executeCommand(this.props.ribbonDescriptor,this.props.ruleContext,this.props.id,this.props.commandManagerId?this.props.commandManagerId:this.props.id,o),commandBarStyle:this._autoPopulateCommandBarStyle(),ribbonId:this.props.ribbonId,height:this.props.height,hideFlyoutButtonChevron:this.props.hideFlyoutButtonChevron,isCommandBarRefresh:this.props.isCommandBarRefreshForceEnabled||this.props.isCommandBarRefresh,contextKey:o,rootZIndex:this.props.rootZIndex}))},e.prototype._isLoadingStringDisabled=function(){return this.props.width<170},e.prototype._handleProps=function(t){if(!this.props.initializeMetadataFailed){Object(F.c)(this.props.commandManagerId)&&this.props.initializeGlobalScriptContainer();var e=this.props;if(this._isNativeCommandManager()&&(this._didCommandListChange(e.addedCommandList,t.addedCommandList)&&e.storeAddedCommandList(e.commandManagerId,e.addedCommandList),this._didCommandListChange(e.appendedCommandList,t.appendedCommandList)&&e.storeAppendedCommandList(e.commandManagerId,e.appendedCommandList)),this.props.initializationCompleted){if(t.ruleContext&&e.ruleContext&&!t.ruleContext.IsServerAvailable&&e.ruleContext.IsServerAvailable&&e.retrieveRibbon(e.ribbonId),Object(z.a)(e.allowedControls,t.allowedControls,(function(t,e){return t===e}))||e.storeAllowListInState(e.allowedControls,e.commandManagerId),e.metaDataLoadedResolve&&e.metaDataLoadedResolve(!0),e.contextToken!==t.contextToken&&e.storeContextTokenInState(),e.ribbonId&&""!==e.ribbonId&&e.xrmInitialized&&e.ribbonDescriptor&&e.ribbonDescriptor.initialized===f.a.Initialized){var o=this._didFormChange(e,t),n=this._didRuleContextChange(e,t),r=this._didServerStatusChange(e,t),a=t.ribbonDescriptor!==e.ribbonDescriptor;if(o||n||r||a){var i=o||r||a;a&&e.setCommandManagerInitializationState(G.a.Uninitialized,e.commandManagerId),e.storeRuleContextInState(e.ruleContext,e.commandManagerId||e.id),e.evaluateRules(e.ribbonDescriptor,e.ruleContext,i)}}this._isNativeCommandManager(!1)&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),t.ribbonId!==e.ribbonId&&e.storeRibbonIdInState(e.ribbonId,e.commandManagerId||e.id)}else{var s=Object(N.a)(e.ribbonId);!this.props.xrmInitialized&&e.ribbonId&&s&&"undefined"!==s||this._startedInitializing||(this._startedInitializing=!0,this._isNativeCommandManager()&&(this.props.storeAddedCommandList(this.props.commandManagerId,this.props.addedCommandList),this.props.storeAppendedCommandList(this.props.commandManagerId,this.props.appendedCommandList)),this.props.initializeCommandBar())}}},e.prototype._isNativeCommandManager=function(t){return void 0===t&&(t=!0),t?this.props.isInMobileModeForOct2019&&!this.props.isMainFormDialog&&(this.props.isNativeMode||(e=this.props.id,o=this.props.commandManagerId,Object(F.c)(o)||o===e)):this.props.isInMobileModeForOct2019&&this.props.isNativeMode;var e,o},e.prototype._didCommandListChange=function(t,e){return!Object(z.a)(t,e,(function(t,e){return t.Id===e.Id&&t.DisplayText===e.DisplayText}))},e.prototype._didRuleContextChange=function(t,e){return e.ruleContext&&t.ruleContext&&!Object(z.a)(t.ruleContext.SelectedItems,e.ruleContext.SelectedItems,(function(t,e){return y.a.equals(t.EntityReference,e.EntityReference)}))||!(e.ruleContext||!t.ruleContext)},e.prototype._didServerStatusChange=function(t,e){return e.ruleContext&&t.ruleContext&&e.ruleContext.IsServerAvailable!==t.ruleContext.IsServerAvailable},e.prototype._didFormChange=function(t,e){if(t.isMultiSessionMode&&Object(F.c)(t.commandManagerId,!0))return!1;if(t.recordStateCode!==e.recordStateCode&&null!=t.recordStateCode||t.recordStatusCode!==e.recordStatusCode&&null!=t.recordStatusCode)return!0;var o=t.ruleContext.EntityId||b.a.EMPTY,n=e.ruleContext.EntityId||b.a.EMPTY;return!b.a.equals(o,n)},e.prototype._autoPopulateCommandBarStyle=function(){var t=this.props.designLanguage;this._defaultCommandBarStyle||(this._defaultCommandBarStyle=Object(w.n)(this.props.isRTL,t)),this._memoizedCommandBarStyle||(this._memoizedCommandBarStyle=this._defaultCommandBarStyle);var e=this.props.commandBarStyle?Object(w.n)(this.props.isRTL,t):this._defaultCommandBarStyle;return this.props.commandBarStyle&&(this.props.commandBarStyle.container&&(e.container=this._autoPopulateContainerStyles(this.props.commandBarStyle.container,this._defaultCommandBarStyle.container,this._memoizedCommandBarStyle.container)),this.props.commandBarStyle.flyoutStyles&&(e.flyoutStyles=this._autoPopulateFlyoutStyles(this.props.commandBarStyle.flyoutStyles,this._defaultCommandBarStyle.flyoutStyles,this._memoizedCommandBarStyle.flyoutStyles)),this.props.commandBarStyle.list&&(e.list=this._autoPopulateListStyles(this.props.commandBarStyle.list,this._defaultCommandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.listItem&&(e.listItem=this._autoPopulateListStyles(this.props.commandBarStyle.listItem,this._defaultCommandBarStyle.listItem,this._memoizedCommandBarStyle.listItem)),this.props.commandBarStyle.listItemBody&&(e.listItemBody=this._autoPopulateButtonStyle(this.props.commandBarStyle.listItemBody,this._defaultCommandBarStyle.listItemBody,this._memoizedCommandBarStyle.listItemBody)),this.props.commandBarStyle.primaryOfSplitButton&&(e.primaryOfSplitButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.primaryOfSplitButton,this._defaultCommandBarStyle.primaryOfSplitButton,this._memoizedCommandBarStyle.primaryOfSplitButton)),this.props.commandBarStyle.moreIcon&&(e.moreIcon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.moreIcon,this._defaultCommandBarStyle.moreIcon,this._memoizedCommandBarStyle.moreIcon)),this.props.commandBarStyle.splitbuttonicon&&(e.splitbuttonicon=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonicon,this._defaultCommandBarStyle.splitbuttonicon,this._memoizedCommandBarStyle.splitbuttonicon)),this.props.commandBarStyle.splitbuttonOverflowButton&&(e.splitbuttonOverflowButton=this._autoPopulateIButtonStyles(this.props.commandBarStyle.splitbuttonOverflowButton,this._defaultCommandBarStyle.splitbuttonOverflowButton,this._memoizedCommandBarStyle.splitbuttonOverflowButton)),this.props.commandBarStyle.list&&(e.list=this._autoPopulateListStyle(this.props.commandBarStyle.list,this._memoizedCommandBarStyle.list)),this.props.commandBarStyle.overflowFlyoutMoreButton&&(e.overflowFlyoutMoreButton=this._autoPopulateListStyle(this.props.commandBarStyle.overflowFlyoutMoreButton,this._memoizedCommandBarStyle.overflowFlyoutMoreButton)),this.props.commandBarStyle.commandBarRefreshProps&&(e.commandBarRefreshProps=this.props.commandBarStyle.commandBarRefreshProps)),this._isCommandBarStyleEqual(e,this._memoizedCommandBarStyle)||(this._memoizedCommandBarStyle=e),this._memoizedCommandBarStyle},e.prototype._autoPopulateContainerStyles=function(t,e,o){var n=t||e;return n===o?o:n},e.prototype._autoPopulateListStyles=function(t,e,o){var n=t||e;return n===o?o:n},e.prototype._autoPopulateIButtonStyles=function(t,e,o){var n=t||e;return n===o?o:n},e.prototype._autoPopulateFlyoutStyles=function(t,e,o){var n={flyoutContainerStyles:t.flyoutContainerStyles||e.flyoutContainerStyles,flyoutListItemBody:t.flyoutListItemBody||e.flyoutListItemBody,flyoutListItemStyles:t.flyoutListItemStyles||e.flyoutListItemStyles,flyoutListStyles:t.flyoutListStyles||e.flyoutListStyles,flyoutChevronStyle:t.flyoutChevronStyle||e.flyoutChevronStyle,flyoutPrimaryOfSplitButton:t.flyoutPrimaryOfSplitButton||e.flyoutPrimaryOfSplitButton,flyoutBackButtonStyle:t.flyoutBackButtonStyle||e.flyoutBackButtonStyle,flyoutBackButtonTextStyle:t.flyoutBackButtonTextStyle||e.flyoutBackButtonTextStyle};return this._isFlyoutButtonStyleEqual(n,o)?o:n},e.prototype._autoPopulateButtonStyle=function(t,e,o){var n={button:t.button||e.button,icon:t.icon||e.icon,text:t.text||e.text,iconWrapperStyles:t.iconWrapperStyles||e.iconWrapperStyles,splitButtonChevronIconWrapper:t.splitButtonChevronIconWrapper||e.splitButtonChevronIconWrapper,flyoutButtonChevronIconWrapper:t.flyoutButtonChevronIconWrapper||e.flyoutButtonChevronIconWrapper,buttonContentWrapperStyle:t.buttonContentWrapperStyle||e.buttonContentWrapperStyle};return this._isButtonStyleEqual(n,o)?o:n},e.prototype._autoPopulateListStyle=function(t,e){return e===t?e:t},e.prototype._isCommandBarStyleEqual=function(t,e){return t.container===e.container&&t.flyoutStyles==t.flyoutStyles&&t.list===e.list&&t.listItem===e.listItem&&t.listItemBody===e.listItemBody&&t.moreIcon===e.moreIcon&&t.splitbuttonicon===e.splitbuttonicon},e.prototype._isButtonStyleEqual=function(t,e){return t.button===e.button&&t.icon===e.icon&&t.text===e.text},e.prototype._isFlyoutButtonStyleEqual=function(t,e){return t.flyoutContainerStyles===e.flyoutContainerStyles&&this._isButtonStyleEqual(t.flyoutListItemBody,e.flyoutListItemBody)&&t.flyoutListItemStyles===e.flyoutListItemStyles&&t.flyoutListStyles===e.flyoutListStyles&&t.flyoutPrimaryOfSplitButton===e.flyoutPrimaryOfSplitButton},e.prototype._executeCommand=function(t,e,o,n,r){return function(a,i,s,d,l){return Object(S.a)(t,e,a,i,s,o,n,r,d,l)}},e}(r.Component);Y.displayName="CommandManager";var X=Object(i.a)((function(){var t=Object(N.d)(),e=Object(c.h)();return function(o,n){var r=Object(A.j)(o,n.ribbonId),a=r&&r.initialized===f.a.Error,i=Object(z.b)(o,n),s=Object(z.c)(o,n),d=Object(B.b)(o,n.commandManagerId,n.id,n.contextToken),l=t(o,n.id,n.ribbonId,n.relationshipType,n.contextToken,n.customControlType,n.selectedRecords,n.allRecords),u=Object(C.a)(o),m=e(o,P.e),c=Object(V.g)(o),p=Object(U.b)(o)?Object(U.a)(o):null,h=Object(W.a)(o,n.commandManagerId),y=Object(Q.a)(o),b=Object(J.a)(o)===K.a.MultiSession;return{commandBarEnabled:u,ribbonDescriptor:r,initializeMetadataFailed:a,ruleContext:l,xrmInitialized:d,recordStateCode:i,recordStatusCode:s,resourceStrings:m,isRTL:c,designLanguage:p,initializationCompleted:h,isCommandBarRefresh:y,isMultiSessionMode:b,isInitialRuleEvaluationComplete:b&&Object(W.b)(o,n.commandManagerId),isInMobileModeForOct2019:Object(H.b)(o)}}}),(function(t,e){var o=e.contextToken?Object(Z.v)(e.contextToken):null;return{storeRuleContextInState:function(e,o){return t(Object(D.a)(e,o))},initializeCommandBar:function(){return t(Object(g.a)(e.ribbonId,e.commandManagerId,e.id,e.contextToken,e.relationshipType,e.selectedRecords,e.allRecords,e.customControlType,e.allowedControls,e.metaDataLoadedResolve))},initializeGlobalScriptContainer:function(){return t((o=e.commandManagerId,{type:"commanding.initGlobalScriptContainer",execute:function(t,e){var n=t.dispatch,r=t.getState;return o!==M.d||Object(B.a)(r(),o)||x?Promise.resolve():(x=!0,n(Object(O.a)(v.a.GLOBAL_CONTAINER_KEY,!0)).then((function(){n(Object(O.b)(!0,o)),x=!1})))}}));var o},evaluateRules:function(n,r,a){return t(Object(_.c)(n,r,e.id,e.commandManagerId||e.id,o,a))},storeRibbonIdInState:function(e,o){return t(Object(E.a)(e,o))},storeContextTokenInState:function(){return t(Object(T.a)(e.contextToken,e.commandManagerId))},storeAllowListInState:function(e,o){return t(Object(R.a)(e,o))},destroyCommandBar:function(e){return t(Object(I.a)([e]))},retrieveRibbon:function(e){return t(Object(j.a)(e))},setCommandManagerInitializationState:function(e,o){return t(Object(L.a)(e,o))},storeAppendedCommandList:function(e,o){return t(function(t,e){return{type:M.l,payload:e,meta:{commandManagerId:t}}}(e,o))},storeAddedCommandList:function(e,o){return t(function(t,e){return{type:M.k,payload:e,meta:{commandManagerId:t}}}(e,o))}}}))(Y),$=o("np0M");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function tt(t){return r.createElement($.a,{loader:function(){return Promise.all([o.e(18),o.e(2),o.e(10),o.e(11),o.e(13),o.e(12),o.e(14),o.e(15),o.e(17),o.e(51)]).then(o.bind(null,"ereG")).then((function(t){return t.CommandCheckerInterfaceRoot}))},props:t})}tt.displayName="CommandCheckerInterfaceHook";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var et=["CommandChecker.CommandChecker.Label"];var ot=r.memo((function(t){var e=r.useState(!1),o=e[0],p=e[1],h=t.ribbonId,y=t.appendedCommandList,b=Object(n.__rest)(t,["ribbonId","appendedCommandList"]),f=Object(i.d)(s.g),C=Object(i.d)((function(t){return Object(l.c)(t,d.E)})),I=Object(i.d)((function(t){return Object(A.j)(t,h)})),_=Object(m.a)(et),S=_&&Object(c.c)(_,"CommandChecker.CommandChecker.Label")||"Command checker",g=Object(i.d)((function(e){return Object(A.m)(e,I,t.id,t.commandManagerId,t.selectedRecords&&t.selectedRecords.length>0)})),B=Object(i.d)((function(e){return Object(W.d)(e,t.commandManagerId)})),v=Object(a.b)()+Object(i.d)((function(t){return Object(u.a)(t,"")}));if(f&&C&&I){var M=[];return y&&M.push.apply(M,y),M.push({Icon:"CommandChecker",DisplayText:S,Id:"CommandChecker",execute:function(){p(!0)}}),r.createElement(r.Fragment,null,r.createElement(X,Object(n.__assign)({ribbonId:h,appendedCommandList:M},b)),o&&r.createElement(tt,{ribbonDescriptor:I,context:Object(N.b)(h),entityLogicalName:Object(N.a)(h),closeCommandCheckerHandler:function(){p(!1)},buttonVisibleMap:g,ribbonRuleEvaluationResults:B,orgUrl:v}))}return r.createElement(X,Object(n.__assign)({},t))}))},"8JH3":function(t,e,o){"use strict";o.d(e,"c",(function(){return u})),o.d(e,"b",(function(){return p})),o.d(e,"a",(function(){return m}));var n=o("Sscr"),r=o("sOTk"),a=o("NPyZ"),i=o("kRDR"),s=o("xc1f"),d=o("odkg"),l=o("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(t,e,o){var a=Object(l.a)(t,e);if(a){var i=Object(r.l)(t,e);if(i!==s.a&&"QuickCreateForm"!==i&&"ModalDialog"!==i&&"Dialog"!==i&&"Dashboard"!==i&&"Control"!==i&&"TaskBasedFlow"!==i&&i!==s.b)return a.xrmReady;var d=Object(n.v)(o);if(a.forms&&a.forms[d])return a.forms[d].xrmReady}return!1}function m(t,e){var o=Object(d.b)(t,e);return o&&o.createdScriptContainer}function c(t,e,o,r){var a=u(t,e,r),i=function(t,e,o){if(o){var r=Object(n.v)(o),a=Object(l.a)(t,e);return a&&a.commandXrmCache&&a.commandXrmCache[r]}return!1}(t,e,o);return o?i&&a:a}function p(t,e,o,n){return e===i.d?!!m(t,e):!!c(t,o,n,Object(a.a)(t,o))}},KZAz:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o("JECh");function r(t,e){var o={ribbonId:t};return{type:n.r,payload:o,meta:{commandManagerId:e}}}},MtNf:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o("JECh");function r(t,e){var o={ruleContext:t};return{type:n.s,payload:o,meta:{commandManagerId:e}}}},eQSW:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o("JECh");function r(t,e){var o=null;t&&(o={},t.forEach((function(t){o[t]=!0})));var r={controlAllowList:o};return{type:n.m,payload:r,meta:{commandManagerId:e}}}},f0hy:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o("JECh");function r(t,e){var o={contextToken:t};return{type:n.n,payload:o,meta:{commandManagerId:e}}}},haDr:function(t,e,o){"use strict";o.d(e,"a",(function(){return O})),o.d(e,"b",(function(){return R}));var n=o("c/eZ"),r=o("nuS9"),a=o("mZYw"),i=o("YWpA"),s=o("4E+q"),d=o("gvL4"),l=o("Wi7Z"),u=o("9rQ4"),m=o("4fxQ"),c=o("Wg6j"),p=o("MGMD"),h=o("lMVv"),y=o("5ZFm"),b=o("Fas2"),f=o("RImw"),C=o("Ww2r"),I=o("5ZRb"),_=o("N2KO"),S=o("kRDR"),g=o("T/iA"),B=o("7EJx"),v=o("qC0c"),M=o("cZkS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var O="Commands",x=!1,j=function(t){function e(e){var o=t.call(this,e)||this;return o._isGlobalComandBar=!1,o._allCommandButtonsTabable=!1,o._selectedIndex=-1,o._selectedId="",o._allControls=[],o._allRenderingMenuItems=[],o._keyboardHandler=o._keyboardHandler.bind(o),o._keyboardFocusHandler=o._keyboardFocusHandler.bind(o),o._isGlobalComandBar=e.commandManagerId.startsWith(S.d),o._allCommandButtonsTabable=o._isGlobalComandBar,o._onCommandBarMeasure=o._onCommandBarMeasure.bind(o),o}return Object(n.__extends)(e,t),e.prototype._init=function(){this._initialized||(this._initialized=!0,this._extractButtons(this.props))},e.prototype._needResetIndex=function(){return!this._allCommandButtonsTabable&&(!!m.findDOMNode(this._commandBarItems)&&(!this._selectedId||!document.getElementById(this._selectedId)))},e.prototype._moveIndex=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=!0);var n=m.findDOMNode(this._commandBarItems);if(n){!this._allCommandButtonsTabable&&n.querySelectorAll("[tabindex='0']").forEach((function(t){return t.setAttribute("tabindex","-1")}));var r=n.childNodes[t];if(r){if(e&&this._isSplitButton(t)){var a=r.querySelector("[aria-haspopup='true']");r=a||r}this._selectedIndex=t,this._selectedId=r.id,(o||n.contains(document.activeElement))&&r.focus(),!this._allCommandButtonsTabable&&r.setAttribute("tabindex","0")}}},e.prototype._isSplitButton=function(t){return this._allRenderingMenuItems.length>t&&this._allControls[t].ControlType===_.c},e.prototype._generateControl=function(t){var e=this,o=_.a,n=null;return t.Children&&t.Children.length>0&&(o=t.execute?_.c:_.b,n=t.Children.map((function(t){return e._generateControl(t)}))),{Command:t.Id,Id:t.Id,DataId:t.DataId,ControlType:o,DisplayText:t.DisplayText,execute:t.execute,executeInjectedPopulationQueryCommand:t.executeInjectedPopulationQueryCommand,Icon:t.Icon,isInjectedCommand:!0,WillOpenFlyout:t.WillOpenFlyout,IsInFlyout:t.IsInFlyout,ToolTipTitle:void 0!==t.Tooltip?t.Tooltip.title:"",ToolTipDescription:void 0!==t.Tooltip?t.Tooltip.description:"",ChildInjectedControls:n,dataLPId:t.dataLPId,accessibilityExpanded:t.accessibilityExpanded,controlsElementId:t.controlsElementId,ownsElementId:t.ownsElementId}},e.prototype._getLearningPathId=function(t){var e="commandbar-";if(t.ribbonId)e+=t.ribbonId;else if(t.commandManagerId){var o=(e+=t.commandManagerId).indexOf(":");o>-1&&(e=e.substring(o+1))}return e},e.prototype.componentWillReceiveProps=function(t){var e,o,n;if(!0!==(null===(o=null===(e=this.props)||void 0===e?void 0:e.ribbonDescriptor)||void 0===o?void 0:o.Localized)||!0===(null===(n=null==t?void 0:t.ribbonDescriptor)||void 0===n?void 0:n.Localized)){var r=this._areMenuLengthPropsChanged(t,this.props)||!this._areButtonsEqualInProps(t,this.props);this._extractButtons(t,r)}},e.prototype._areButtonsEqualInProps=function(t,e){return t.menuControlMapping===e.menuControlMapping&&this._areControlListsEqual(t.addedCommandList,e.addedCommandList)&&this._areControlListsEqual(t.appendedCommandList,e.appendedCommandList)},e.prototype._areControlListsEqual=function(t,e){return null==t||null==e?null==t&&null==e:t.length===e.length&&t.every((function(t,o){return t.Id===e[o].Id&&t.DisplayText===e[o].DisplayText}))},e.prototype._areMenuLengthPropsChanged=function(t,e){return t.width!==e.width||t.iconPosition!==e.iconPosition||t.commandbarDisplayMode!==e.commandbarDisplayMode||t.mainMenuLength!==e.mainMenuLength},e.prototype._extractButtons=function(t,e){void 0===e&&(e=!0),this._updateAllControls(t),this._updateRenderingMenuItems(t),e&&(this._mainMenuLength=Object(g.c)(t.width,t.commandBarStyle,this._allControls,t.iconPosition,t.isRTL,t.commandbarDisplayMode,t.mainMenuLength,t.forceUseOfMainMenuLength,x),this._allCommandButtonsTabable||(this._selectedId=void 0))},e.prototype._updateAllControls=function(t){var e=this;if(this._allControls=[],t.addedCommandList&&t.addedCommandList.forEach((function(t){e._allControls.push(e._generateControl(t))})),t.ribbonDescriptor&&t.ribbonDescriptor.Layout){var o=new Array;t.ribbonDescriptor.Layout.Tabs.Tab&&(o=o.concat(t.ribbonDescriptor.Layout.Tabs.Tab)),t.ribbonDescriptor.Layout.ContextualTabs.Tab&&(o=o.concat(t.ribbonDescriptor.Layout.ContextualTabs.Tab)),o.forEach((function(o){o&&o.Groups&&o.Groups.Group&&o.Groups.Group.forEach((function(o){o.Controls.Items.forEach((function(o){var n=o?Object(b.i)(o.Id,Object(f.a)(t.ribbonId)):null;o&&n&&t.menuControlMapping[n]&&e._allControls.push(o)}))}))}))}t.appendedCommandList&&t.appendedCommandList.forEach((function(t){e._allControls.push(e._generateControl(t))}))},e.prototype._updateRenderingMenuItems=function(t){var e=this;this._allRenderingMenuItems=[];var o=t.selectedRecords&&t.selectedRecords.length>0;this._allControls.forEach((function(n,r){var a={RootButtonId:null,contextKey:t.contextKey,areRecordsSelected:o,isFlyoutControl:!1,commandManagerId:t.commandManagerId,control:n,iconPosition:t.iconPosition,flyoutDepth:0,commandBarStyle:t.commandBarStyle,isMainView:!0,executeCommand:t.executeCommand,ribbonId:t.ribbonId,pageId:t.pageId,commandbarDisplayMode:t.commandbarDisplayMode,updateMainViewKeyboardIndex:e._updateSelectedIndex(r),hideFlyoutButtonChevron:t.hideFlyoutButtonChevron,isCommandBarRefresh:t.isCommandBarRefresh,rootZIndex:t.rootZIndex},i=Object(c.f)(n,a,e._allRenderingMenuItems.length,e._allCommandButtonsTabable,t.entityDisplayName,t.entityDisplayCollectionName);e._allRenderingMenuItems.push(i)}))},e.prototype.render=function(){var t=this;this._init(),this._numberMainMenuControls=0,this._numberOverflowControls=0;var e=[],o=[];if(this._allRenderingMenuItems.forEach((function(e){o.length<t._mainMenuLength&&(o.push(e),t._numberMainMenuControls++)})),this._allControls.length>this._mainMenuLength)for(var i=this._mainMenuLength;i<this._allControls.length;i++)this._addControlToMoreMenu(this._allControls[i],e);var s=this.props.selectedRecords&&this.props.selectedRecords.length>0;if(this._numberOverflowControls>0){var d=Object(C.c)(this.props.resourceStrings,I.c),l=Object(C.c)(this.props.resourceStrings,I.b),u=this.props.entityDisplayName?String.format(l,this.props.entityDisplayName):d,m=Object(c.i)({ToolTipTitle:u,OverflowIcon:this.props.useVerticalMoreIcon?"MoreVertical":"More"},S.f),p=Object(c.e)(m,this.props.commandManagerId,this.props.contextKey),h=Object(n.__assign)({},this.props.commandBarStyle);h.listItemBody=Object(n.__assign)({},h.listItemBody),h.listItemBody.button=Object(n.__assign)(Object(n.__assign)({},h.listItemBody.button),{paddingLeft:0,paddingRight:0}),o.push(r.createElement(a.a,{contextKey:this.props.contextKey,areRecordsSelected:s,isOverflowFlyoutMoreButton:!0,commandbarDisplayMode:this.props.commandbarDisplayMode,isFlyoutControl:!1,flyoutDepth:0,commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,accessibilityLabel:u,key:p,id:p,tabIndex:this._allCommandButtonsTabable?0:-1,ariaOwnsElementId:p+"_flyout",RootButtonId:p,menuItems:e,control:m,iconPosition:this.props.iconPosition,commandBarStyle:h,isMainView:!0,executeCommand:this.props.executeCommand,ribbonId:this.props.ribbonId,updateMainViewKeyboardIndex:this._updateSelectedIndex(this._numberMainMenuControls),isCommandBarRefresh:this.props.isCommandBarRefresh,rootZIndex:this.props.rootZIndex})),this._numberMainMenuControls++}return this._getMarkupOfCommandBar(o,this.props)},e.prototype._onCommandBarMeasure=function(){var t=m.findDOMNode(this._commandBarItems);if(t){var e=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(t){if(t){var e=getComputedStyle(t),o=parseInt(e.fontSize,10),n=parseFloat(e.letterSpacing),r=parseFloat(e.wordSpacing);return n>=.12*o&&r>=.16*o}}(t);x!==e&&(x=e,this._extractButtons(this.props),this.forceUpdate())}},e.prototype._getMarkupOfCommandBar=function(t,e){var o,a=this,s="$commandBarInfo"+e.commandManagerId,u="$commandBarItemsList"+e.commandManagerId;return t.length>0?r.createElement(i.a,{style:this._transformContainerStyle(e),key:s,isRequestedMeasuring:!0,onMeasuring:this._onCommandBarMeasure},r.createElement(d.a,{ref:function(t){a._commandBarItems=t,a._needResetIndex()&&a._moveIndex(0,!1,!1)},testhooks:(o={id:"CommandBar"},o[p.a.LearningPathDOMAttributeSuffix]=this._getLearningPathId(e),o),accessibilityLabel:O,key:u,role:l.m,style:Object(n.__assign)(Object(n.__assign)({},e.commandBarStyle.list),{listStyleType:"none",flexShrink:"0"}),onKeyDown:this._keyboardHandler,onFocus:this._keyboardFocusHandler},t)):null},e.prototype._transformContainerStyle=function(t){var e=t.commandBarStyle.container;return t.height&&(e=Object(n.__assign)(Object(n.__assign)({},e),{maxHeight:t.height+"px",overflowY:"auto"})),e},e.prototype._addControlToMoreMenu=function(t,e){e.push(t),this._numberOverflowControls++},e.prototype._updateSelectedIndex=function(t){var e=this;return function(){e._selectedIndex=t,!e._isGlobalComandBar&&e._moveIndex(t,!1,!1)}},e.prototype._getBrightnessFromRGB=function(t,e,o){return Math.round((299*t+587*e+114*o)/1e3)},e.prototype._keyboardFocusHandler=function(t){var e=t.target,o=document.getElementById(e.id);if(o&&o.style){var n="";do{n=window.getComputedStyle(e).backgroundColor,e=e.parentElement}while(("rgba(0, 0, 0, 0)"===n||"transparent"===n)&&e);if(-1!==n.indexOf("rgb")){var r=n.split(/[()]+/)[1].split(",");o.style.outlineColor=this._getBrightnessFromRGB(parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10))>125?"#666666":"#FFFFFF"}}if(!this._isGlobalComandBar){var a=m.findDOMNode(this._commandBarItems),i=a&&a.children;if(i)for(var s=0;s<i.length;s++)""!==i[s].id&&i[s].id===t.target.id&&s!==this._selectedIndex&&this._moveIndex(s)}},e.prototype._keyboardHandler=function(t){if(t.keyCode===u.a.Enter)return t.stopPropagation(),t.preventDefault(),void t.target.click();if(!this._isGlobalComandBar){var e=!this.props.isRTL&&t.keyCode===u.a.RightArrow||this.props.isRTL&&t.keyCode===u.a.LeftArrow;!this.props.isRTL&&t.keyCode===u.a.LeftArrow||this.props.isRTL&&t.keyCode===u.a.RightArrow?this._moveIndex(L(this._selectedIndex-1,this._numberMainMenuControls),!0):e&&this._moveIndex(L(this._selectedIndex+1,this._numberMainMenuControls),!1)}},e}(r.Component);function L(t,e){return(t%e+e)%e}j.displayName="CommandBar";var R=Object(s.a)((function(){var t=Object(y.g)(),e=Object(C.h)();return function(o,n){var r=t(o,n),a=n.ribbonId?n.ribbonId.split(":"):null,i=a&&a.length>1?a[a.length-1]:null,s=Object(h.h)(o,i);return{menuControlMapping:r,entityDisplayName:s&&s.DisplayName?s.DisplayName:"",entityDisplayCollectionName:s&&s.DisplayCollectionName?s.DisplayCollectionName:"",resourceStrings:e(o,I.e),isRTL:Object(B.g)(o),useVerticalMoreIcon:Object(v.a)(o,M.ke,M.h)&&Object(c.r)("MoreVertical")}}}))(j)},y3ek:function(t,e,o){"use strict";o.d(e,"a",(function(){return O}));var n=o("G7N+"),r=o("DRVD"),a=o.n(r),i=o("7pqb"),s=o("Sscr"),d=o("QS6j"),l=o("dEPU"),u=o("Fas2"),m=o("0RbL"),c=o("TbLg"),p=o("0CEd");function h(t,e){return{type:"ribbon.initialize.async",execute:function(o,n){var r=o.dispatch,a=o.getState;if(t){var i=a();!function(t,e,o,n){var r=Object(u.g)();if(t!==r){var a={},i=function(t,e,o){if(!t)return null;if(o){var n=Object(c.k)(t,e),r=n&&n.slice();return Object(m.a)(r,o)}return null}(o,t,e);i&&(a[t]=i,n(Object(p.e)(null,a)))}}(t,e,i,r)}return Promise.resolve()}}}var y=o("eQSW"),b=o("MtNf"),f=o("f0hy"),C=o("KZAz"),I=o("pdGj"),_=o("RImw"),S=o("kRDR"),g=o("EevF"),B=o("bFFS"),v=o("8JH3"),M=a.a.createEvent(S.b,S.a);function O(t,e,o,r,a,m,c,p,S,O){return{type:"commanding.initCmdBar",execute:function(x,j){var L=x.dispatch,R=x.getState;if(!Object(I.c)(R(),e))if(Object(I.b)(R(),e))O&&O(!0);else{L(Object(B.a)(g.a.Initializing,e));var T=Object(_.a)(t);if(t&&""!==t&&T&&"undefined"!==T){var E={};E[i.b.CommandingParameters.CommandManagerId]=e||o||"null",E[i.b.CommandingParameters.RibbonId]=t||"null",E[i.b.CommandingParameters.ContextKey]=r?Object(s.v)(r):"null";var D=M.startStopwatch(E);return function(t,e,o){var n=Object(u.j)(e,o);if(o&&(!n||!n.initialized||!n.Localized))return t(Object(l.a)(o));return Promise.resolve()}(L,R(),t).then((function(){var i=Object(v.b)(R(),e,o,r),l=Object(_.d)()(R(),o,t,a,r,p,m,c),I=Object(u.j)(R(),t);if(i&&l&&I&&I.initialized!==n.a.Error&&I.Commands&&I.Localized){var g=r?Object(s.v)(r):null;return L(h(t,o)),L(Object(y.a)(S,e)),L(Object(b.a)(l,e||o)),L(Object(C.a)(t,e||o)),L(Object(f.a)(r,e)),L(Object(d.c)(I,l,o,e||o,g,!1)).then((function(){O&&O(!0),D()}))}}))}L(Object(B.a)(g.a.SkippedRuleEvaluation,e))}}}}}}]),window.bundleExecutionMarkers["scripts/es5/7.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();