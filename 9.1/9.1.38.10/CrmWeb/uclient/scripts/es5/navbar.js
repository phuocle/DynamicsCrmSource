(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/navbar.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[87],{PXs8:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return l}));var i=r("4fxQ"),s=r("w2s3"),n=r("9rQ4"),a=r("E705");function o(e){var t=e.target;switch(Object(a.e)(e.nativeEvent)){case n.a.DownArrow:var r=t.nextElementSibling;return r&&r.focus(),!0;case n.a.UpArrow:var i=t.previousElementSibling;return i&&i.focus(),!0;case n.a.Tab:return e.preventDefault(),!0;case n.a.Enter:return t.click(),!1;case n.a.Escape:return!1;default:return!0}}function l(e){requestAnimationFrame((function(){if(e){var t=i.findDOMNode(e);t&&t.firstElementChild&&t.firstElementChild.focus()}}))}function c(){var e=document.getElementById(s.f);if(e)for(var t=e.children,r=0;r<t.length;r++){var i=t[r];if(0===i.tabIndex){i.focus();break}}}var p=function(){function e(e){void 0===e&&(e=null),this._entityNavBar=document.getElementById(s.k),this._navBar=document.getElementById(s.f),this._currElement=e}return e.prototype._isElementExpanded=function(e){return!(!e||"true"!==e.getAttribute("aria-expanded")&&"true"!==e.getAttribute("data-expanded"))},e.prototype._getParents=function(e){for(var t=[],r=e;r&&r.parentElement;)r=r.parentElement,t.push(r);return t},e.prototype.getNextSibling=function(e,t){if(void 0===e&&(e=this._currElement),void 0===t&&(t=!0),!e)return null;var r=e.nextElementSibling,i=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&r)return r;if(t&&this._isElementExpanded(e))r=e.getElementsByTagName("li")[0];else if(!r&&this._isElementExpanded(i[2]))r=this.getNextSibling(i[2],!1);else if(!r&&i[1]){var s=i[1].nextElementSibling,n=s?s.getElementsByTagName("li"):null;r=n?n[0]:null}return r},e.prototype.getPrevSibling=function(e){if(void 0===e&&(e=this._currElement),!e)return null;var t=e.previousElementSibling,r=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&t)return t;if(this._isElementExpanded(t)){var i=t.getElementsByTagName("li");if(i.length)return i[i.length-1]}if(t)return t;if(this._isElementExpanded(r[2]))return r[2];if(r[1]){var s=r[1].previousElementSibling,n=s?s.getElementsByTagName("li"):null;if(n&&n.length)return n[n.length-1]}return null},e.prototype.getFirstItemOfEntityNavBar=function(){var e=this._entityNavBar?this._entityNavBar.firstChild:null,t=e?e.getElementsByTagName("li"):null;return t?t[0]:null},e.prototype.getLastItemofEntityNavBar=function(){var e=this._entityNavBar?this._entityNavBar.lastChild:null,t=e?e.getElementsByTagName("li"):null;return t&&t.length?t[t.length-1]:null},e.prototype.findNextMatchingListItem=function(e){if(!this._entityNavBar||!this._entityNavBar.firstChild)return null;var t=this._navBar.contains(this._currElement)?this.getLastItemofEntityNavBar():this._currElement,r=t,i=!1;do{var s=r;if(i?(r=this.getFirstItemOfEntityNavBar(),i=!1):r=this.getNextSibling(s),r){var n=r.getAttribute("data-text");if(n&&n.toLowerCase().startsWith(e))return r}else i=!0}while(r!==t);return null},e}()},UGvi:function(e,t,r){"use strict";r.d(t,"a",(function(){return _})),r.d(t,"b",(function(){return v}));var i=r("c/eZ"),s=r("nuS9"),n=r("evW+"),a=r("H/hG"),o=r("9rQ4"),l=r("YWpA"),c=r("MGMD"),p=r("znb3"),u=r("XIN1"),d=r("3pZv"),h=r("x2VW"),f=r("w2s3"),m=r("kyRo"),b=r("TCzx"),y={height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},g=function(e){function t(t,r){var i=e.call(this,t)||this;return i.onClickHandler=i.onClickHandler.bind(i),i.onKeyDownHandler=i.onKeyDownHandler.bind(i),r.hiddenAction&&(i._hiddenActionTriggerCallback=Object(h.a)(r.hiddenAction)),i}return Object(i.__extends)(t,e),t.prototype.onClickHandler=function(){this.context.toggleSiteMap(),this._hiddenActionTriggerCallback&&this._hiddenActionTriggerCallback()},t.prototype.onKeyDownHandler=function(e){e.keyCode===o.a.Enter&&e.preventDefault()},t.prototype.render=function(){var e,t=this.props.isOpened?f.e:null,r=this.props.isOpened?f.f:null,i=this.props.label,o=this.props.label;return s.createElement(n.a,{id:f.g,style:this.props.buttonStyle,onClick:this.onClickHandler,accessibilityLabel:i,title:Object(d.d)(o,o,null),ownsElementId:r,accessibilityExpanded:this.props.isOpened,controlsElementId:t,accessibilityHasPopup:!0,onKeyDown:this.onKeyDownHandler,testhooks:(e={id:"navbutton"},e[c.a.LearningPathDOMAttributeSuffix]="sitemap-launcher",e)},s.createElement(l.a,{style:y},s.createElement(a.a,{style:this.props.iconStyle},s.createElement(u.b,{type:p.a.SiteMap}))))},t}(s.Component);function v(e,t,r){var i=r?f.e:null,s=r?f.f:null;return b.a.getInstance().get_IsBrowserIE()?{DisplayText:e,WillOpenFlyout:!0,ownsElementId:s,controlsElementId:i,Icon:"SiteMap",DataId:"navbutton",dataLPId:"sitemap-launcher",Id:f.g,Tooltip:Object(d.d)(e,e,null),execute:t}:{DisplayText:e,WillOpenFlyout:!0,ownsElementId:s,controlsElementId:i,Icon:"SiteMap",accessibilityExpanded:r,DataId:"navbutton",dataLPId:"sitemap-launcher",Id:f.g,Tooltip:Object(d.d)(e,e,null),execute:t}}g.contextType=m.b;var _=g},XFTY:function(e,t,r){"use strict";r.r(t),r.d(t,"ConnectedNavBar",(function(){return ze}));var i=r("c/eZ"),s=r("nuS9"),n=r("4fxQ"),a=r("YWpA"),o=r("4E+q"),l=r("GDI2"),c=r("PXs8"),p=r("1AYO"),u=r("Wi7Z"),d=r("9rQ4"),h=r("E705"),f=r("w2s3"),m=r("evW+"),b=r("gvL4"),y=r("p1Sq"),g=r("lU69"),v=r("H/hG"),_=r("eGYM"),I=r("Zh8V"),M=r("Smta"),O=r("MGMD"),S=r("uTTW"),E=r("QVns"),w=r("mTVg"),A=r("VnpK");function B(e,t){return{width:"16px",height:"16px",flex:"0 0 16px",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",fontSize:"16px",marginLeft:t?"16px":e.sizes.Measures.Measure025,marginRight:t?"16px":"0px"}}function k(e,t){return{whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t?"0px":e.sizes.Measures.Measure050,marginRight:t?"0px":e.sizes.Measures.Measure025,fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Regular}}var x={width:"100%"},L={justifyContent:"space-between"},j={display:"inline-block",width:"100%"},T=function(e){function t(t){var r=e.call(this,t)||this;return r.selectItem=r.selectItem.bind(r),r.onKeyDownHandler=r.onKeyDownHandler.bind(r),r}return Object(i.__extends)(t,e),t.prototype.selectItem=function(){this.props.selectArea(this.props.itemId)},t.prototype.onKeyDownHandler=function(e){e.keyCode===d.a.Enter&&this.selectItem()},t.prototype.render=function(){var e,t=this.props,r=t.itemId,n=t.selectedItemId,o=t.title,l=t.theme,c=t.maxWidth,p=t.icon,d=t.hideOverflowButton,h=t.visibleItems,m=t.isWeb,b=r===n,y=this.props.itemId===f.d,g=function(e,t){var r="îª†",i=null;void 0!==_.a[t]&&(r=_.a[t]);e&&(r=e,i=S.a);return{type:i,value:r}}(p,r),T=m?function(e,t,r){return e?{width:"calc((100% - "+r.sizes.NavButtonHeight+")/"+t+")"}:{}}(d,h,l):{},F=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,i){return Object(I.e)({color:Object(E.e)(r.colors.SiteMap.AreaBar),backgroundColor:"transparent",cursor:"pointer",padding:0,borderBottomColor:r.colors.SiteMap.AreaItemBorder,borderBottomWidth:e?r.sizes.SiteMap.AreaItemBorder:0,borderTopColor:"transparent",borderTopWidth:e?r.sizes.SiteMap.AreaItemBorder:0,borderStyle:"solid",maxWidth:t||"100%",display:"flex",alignItems:"center",height:r.sizes.NavButtonHeight,boxSizing:"border-box",paddingLeft:i?"0px":r.sizes.Measures.Measure050,paddingRight:i?"0px":r.sizes.Measures.Measure050},r.colors.NavBar.NavBar1.Fill)}(b,c,l,y)),T),function(e){return e?{flex:"0 0 auto"}:{}}(y));return s.createElement(M.a,{key:"sitemap-navItem-listItem",style:this._addContrastRule(F,g,l,!0),onClick:this.selectItem,accessibilityLabel:o,dataText:o,role:u.t,accessibilityExpanded:b,ownsElementId:f.k,tabIndex:b?0:-1,onKeyDown:this.onKeyDownHandler,isSelected:b,testhooks:(e={id:"sitemap-module-"+r},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-navItem-"+r,e)},s.createElement(a.a,{key:"sitemap-navItem-inlineBlock",style:j,accessibilityHidden:!0},s.createElement(a.a,{key:"sitemap-navItem-innerView",style:L},s.createElement(a.a,{key:"sitemap-navItem-iconContainer",style:x,title:o},s.createElement(v.a,{key:"sitemap-navItem-icon",className:"svgIcon",style:this._addContrastRule(B(l,y),g,l),testhooks:{id:"sitemap-navItem-icon-"+r}},function(e,t){var r=e.type,i=e.value,n=Object(A.n)();switch(r){case S.a:var a={width:t.sizes.Icon.MinWidth,height:t.sizes.Icon.MinHeight};return s.createElement(w.a,{source:i,style:a,highContrast:n});case null:return i}}(g,l)),s.createElement(v.a,{key:"sitemap-navItem-label",style:k(l,y),testhooks:{id:"sitemap-navItem-text-"+r}},y?null:o)))))},t.prototype._addContrastRule=function(e,t,r,i){if(t.type!==S.a||Object(A.n)())return e;var s=i?r.colors.NavBar.NavBar1.Fill.toString():r.colors.SiteMap.AreaBar;return Object(I.b)(e,s,i)},t}(s.Component);var F=r("znb3"),R=r("XIN1"),C=r("0u+G"),D=r("7EJx"),N=r("wV3W");function z(e,t){return{whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t?"0px":e.sizes.Measures.Measure100,marginRight:t?e.sizes.Measures.Measure100:"0px",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Regular,height:e.sizes.Measures.Measure150,lineHeight:e.sizes.Measures.Measure150,display:"inline-block",alignItems:"center"}}function H(e){return{fontFamily:"CRM MDL2",fontSize:"16px",width:"16px",height:e.sizes.Measures.Measure150,display:"flex",alignItems:"center"}}var W=Object(o.a)((function(){return function(e,t){return{theme:Object(N.a)(e),isRTL:Object(D.g)(e)}}}))((function(e){var t,r,i;return s.createElement(p.a,{key:"flyout",positionType:"relative",relativeToElementId:e.relativeToElementId,flyoutDirection:e.isRTL?p.b.left:p.b.right,flyoutStyle:(r=e.theme,i=e.isRTL,{backgroundColor:r.colors.SiteMap.AreaBar,marginTop:r.sizes.Measures.Measure025,marginBottom:r.sizes.Measures.Measure025,marginRight:i?"-"+r.sizes.Measures.Measure025:r.sizes.Measures.Measure025,marginLeft:i?"-"+r.sizes.Measures.Measure025:r.sizes.Measures.Measure025,opacity:.95,boxShadow:r.shadows.Shadow01,maxHeight:"23.75em",overFlowY:"auto"}),onOutsideClick:e.closeFlyout,id:e.id,testhooks:e.isQuickLaunchBar?(t={},t[O.a.LearningPathDOMAttributeSuffix]="sitemap-areabar-overflow-flyout",t):null},s.createElement(b.a,{style:(e.theme,{display:"initial",listStyleType:"none",width:"19.29em"}),onKeyDown:e.keyDownHandler,ref:c.c,role:u.m},function(e,t,r){return(t=t.filter((function(e){return e.Id!==f.d})))&&t.length?t.map((function(t,i){var n,a;return s.createElement(M.a,{key:i,style:(a=e.theme,Object(I.e)({color:Object(E.e)(a.colors.SiteMap.AreaBar),cursor:"pointer",padding:a.sizes.Measures.Measure100,display:"flex",flexDirection:"row"},a.colors.NavBar.NavBar1.Fill)),tabIndex:-1,isSelected:r===t.Id,role:u.n,testhooks:(n={id:(e.isQuickLaunchBar?"quick-launch-overflow-area-":"areabar-overflow-")+t.Id},n[O.a.LearningPathDOMAttributeSuffix]=e.isQuickLaunchBar?null:"sitemap-areabar-overflow-"+t.Id,n),onClick:function(r){e.selectArea(t.Id),e.closeFlyout(r),e.setFocusToFirstEntity()}},s.createElement(v.a,{style:H(e.theme)},r===t.Id?s.createElement(R.b,{type:F.a.CheckMark}):null),s.createElement(v.a,{style:z(e.theme,e.isRTL)},t.Titles[0].Title))})):[]}(e,e.siteMapItems,e.selectedAreaId)))})),P=r("Ww2r"),G=r("EZG4"),Q=Object(g.a)();function q(e){return{flexDirection:"row",flex:"0 1 100%",width:"calc(100% - "+e.sizes.NavButtonHeight+")",minWidth:"0"}}var V={flexDirection:"row",justifyContent:"space-between",width:"100%"};function K(e){return{color:e.colors.SiteMap.AreaBarItemIcon,fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",fontSize:"16px",textAlign:"center",width:"100%"}}var U={flexShrink:0},Z=function(e){function t(t){var r=e.call(this,t)||this;return r._visibleItems=[],r._siteMapItems=[],r._areaListId=Object(g.a)(),r._overflowButtonId=Object(g.a)(),r._overflowFlyoutId=Object(g.a)(),r._overFlowButtonRef=null,r._shouldSelectFirstArea=!1,r._shouldSelectFirstAreaOnReRender=!1,r._hideOverflowButton=!1,r._list=null,r._maxWidth=0,r._getOverflowButtonRef=r._getOverflowButtonRef.bind(r),r._focusOnFirstSubArea=r._focusOnFirstSubArea.bind(r),r._toggleOverFlowFlyout=r._toggleOverFlowFlyout.bind(r),r._selectMruButton=r._selectMruButton.bind(r),r._getListRef=r._getListRef.bind(r),r.keyDownHandler=r.keyDownHandler.bind(r),r.state={isPreRenderStep:!0},r}return Object(i.__extends)(t,e),t.prototype._getListRef=function(e){this._list=e},t.prototype._selectMruButton=function(){this.props.selectArea(f.d)},t.prototype._toggleOverFlowFlyout=function(){this.setState({isOverflowFlyoutVisible:!this.state.isOverflowFlyoutVisible})},t.prototype.componentDidMount=function(){this.setState({isPreRenderStep:!0}),this._shouldSelectFirstArea=!0},t.prototype.componentDidUpdate=function(e,t){e.selectedAreaId!==this.props.selectedAreaId?this.setState({isPreRenderStep:!0}):(this._calculateOverflowItems(this._shouldSelectFirstArea),this._shouldSelectFirstArea?(this._shouldSelectFirstArea=!1,this._shouldSelectFirstAreaOnReRender||Object(c.d)()):this._shouldSelectFirstAreaOnReRender&&(this._shouldSelectFirstAreaOnReRender=!1,Object(c.d)()))},t.prototype._calculateOverflowItems=function(e){var t=document.getElementById(this._areaListId);t&&t.clientWidth<t.scrollWidth?this.state.isPreRenderStep&&(this.setState({isPreRenderStep:!1}),e&&(this._shouldSelectFirstAreaOnReRender=!0),this._assignOverFlowItems()):this._visibleItems.length===this._siteMapItems.length&&(this._hideOverflowButton=!0,this.state.isPreRenderStep&&this.setState({isPreRenderStep:!1}))},t.prototype._assignOverFlowItems=function(){var e=this.props.siteMap,t=e?Object(y.a)(e):[];if(t=t.filter((function(e){return e.Id!==f.d})),this.props.platformType!==C.b.Web)return this._hideOverflowButton=!0,void(this._visibleItems=t);if(t&&t.length&&this._list){var r=n.findDOMNode(this._list);if(!r)return;var i=r.children;if(i.length!==t.length+1)return;this._visibleItems=[];var s=document.getElementById(this._areaListId).clientWidth;s-=X(i.item(0));var a=0;if(this.props.selectedAreaId&&this.props.selectedAreaId!==f.d)for(var o=0;o<t.length;o++){if((p=t[o]).Id===this.props.selectedAreaId){a=o,this._visibleItems.push(p),s-=X(i.item(o+1));break}}for(o=0;o<t.length&&!(s<=0);o++){var l=X(i.item(o+1));if((p=t[o]).Id!==this.props.selectedAreaId){if(l>s)continue;this._visibleItems.length&&o<a?this._visibleItems.splice(this._visibleItems.length-1,0,p):this._visibleItems.push(p),s-=l}}if(this._hideOverflowButton=!1,this._visibleItems.length===t.length)this._hideOverflowButton=!0;else if(this._visibleItems.length+1===t.length){(u=document.getElementById(this._overflowButtonId).offsetWidth)+s>60&&(this._visibleItems=t,this._hideOverflowButton=!0)}if(this._maxWidth=0,s<0)if(this._visibleItems.length){var c=this._visibleItems[this._visibleItems.length-1];for(o=0;o<t.length;o++){var p;if((p=t[o]).Id===c.Id){this._maxWidth=i.item(o+1).offsetWidth+s;break}}}else this._maxWidth=i.item(0).offsetWidth+s;if(this._hideOverflowButton&&this._maxWidth){var u=document.getElementById(this._overflowButtonId).offsetWidth;this._maxWidth=this._maxWidth+u}}},t.prototype._renderItems=function(){var e=this;if(this.props.isAreaBarEmpty)return null;var t=this._visibleItems&&this._visibleItems.length?this._visibleItems.map((function(t,r){return s.createElement(T,{key:r,isWeb:e.props.platformType===C.b.Web,itemId:t.Id,title:t.Titles[0].Title,selectArea:e.props.selectArea,selectedItemId:e.props.selectedAreaId,icon:t.VectorIcon,maxWidth:e._visibleItems.length===r+1?e._maxWidth:0,hideOverflowButton:e._hideOverflowButton,visibleItems:e._visibleItems.length,theme:e.props.theme})})):[];return t.unshift(s.createElement(T,{key:"mru-button",itemId:f.d,title:Object(P.c)(this.props.resourceStrings,G.d),selectArea:this.props.selectArea,selectedItemId:this.props.selectedAreaId,theme:this.props.theme})),t},t.prototype.keyDownHandler=function(e){if(Object(c.b)(e)||this.setState({isOverflowFlyoutVisible:!1}),e.keyCode===d.a.Enter)this._focusOnFirstSubArea();else if(e.keyCode===d.a.Escape&&this._overFlowButtonRef){var t=n.findDOMNode(this._overFlowButtonRef);t&&t.focus()}},t.prototype._focusOnFirstSubArea=function(){requestAnimationFrame((function(){var e=new c.a(null).getFirstItemOfEntityNavBar();e&&e.focus()}))},t.prototype._getOverflowButtonRef=function(e){this._overFlowButtonRef=e},t.prototype._renderOverFlowButton=function(){var e;if(this._hideOverflowButton)return null;var t,r=null,i=null,n=Object(y.a)(this.props.siteMap);return this.state.isOverflowFlyoutVisible&&(i=this._overflowFlyoutId,r=s.createElement(W,{id:this._overflowFlyoutId,setFocusToFirstEntity:this._focusOnFirstSubArea,siteMapItems:n,selectArea:this.props.selectArea,selectedAreaId:this.props.selectedAreaId,relativeToElementId:Q,closeFlyout:this._toggleOverFlowFlyout,isQuickLaunchBar:!1,keyDownHandler:this.keyDownHandler})),s.createElement(a.a,{key:"more-options",style:U},s.createElement(m.a,{key:"more-options-button",accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.a),onClick:this._toggleOverFlowFlyout,style:(t=this.props.theme,Object(I.e)({backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:t.colors.SiteMap.AreaBarItemIcon,paddingLeft:t.sizes.Measures.Measure050,paddingRight:t.sizes.Measures.Measure050,width:t.sizes.NavButtonHeight,height:t.sizes.NavButtonHeight},t.colors.SiteMap.AreaBarItemActive)),id:this._overflowButtonId,accessibilityExpanded:!!this.state.isOverflowFlyoutVisible,accessibilityHasPopup:!0,controlsElementId:i,ownsElementId:i,ref:this._getOverflowButtonRef,testhooks:(e={id:"sitemap-areaBar-more-btn"},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-areaBar-more-btn",e)},s.createElement(v.a,{style:K(this.props.theme)},s.createElement(R.b,{type:F.a.More}))),r)},t.prototype._renderCloseButton=function(){if(this.props.platformType===C.b.Web)return s.createElement(a.a,{key:"close-button",style:U},s.createElement(m.a,{key:"cancel",style:(e=this.props.theme,Object(I.e)({backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",width:e.sizes.NavButtonHeight,height:e.sizes.NavButtonHeight,paddingLeft:e.sizes.Measures.Measure050,paddingRight:e.sizes.Measures.Measure050,display:"flex",justifyContent:"center",alignItems:"center"},e.colors.SiteMap.AreaBarItemActive)),id:Q,onClick:this.props.closeSiteMap,accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.c)},s.createElement(v.a,{style:K(this.props.theme)},s.createElement(R.b,{type:F.a.Close}))));var e},t.prototype.render=function(){if(this.props.platformType!==C.b.Web||this.state.isPreRenderStep||!this._visibleItems){var e=this.props.siteMap?Object(y.a)(this.props.siteMap):[];e=e.filter((function(e){return e.Id!==f.d})),this._siteMapItems=e,this._visibleItems=e,this._maxWidth=0,this._hideOverflowButton=!1,(this.props.platformType!==C.b.Web||this.props.isAreaBarEmpty)&&(this._hideOverflowButton=!0)}return s.createElement(a.a,{style:(i=this.props.theme,{width:"100%",display:"block",backgroundColor:i.colors.SiteMap.AreaBar,minHeight:i.sizes.NavButtonHeight})},s.createElement(a.a,{style:V},s.createElement(a.a,{style:q(this.props.theme)},s.createElement(a.a,{style:(r=this.props.platformType,{overflowX:r===C.b.Web?"hidden":"auto",justifyContent:"flex-start"}),id:this._areaListId},s.createElement(b.a,{key:f.f,ref:this._getListRef,id:f.f,role:u.u,style:(t=this.state.isPreRenderStep,{flexDirection:"row",listStyleType:"none",display:"inline-flex",width:"100%","& *":t?{flexShrink:0}:void 0}),accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.h)},this._renderItems())),this._renderOverFlowButton()),this._renderCloseButton()));var t,r,i},t}(s.Component);function X(e){var t=e,r=t.currentStyle||window.getComputedStyle(t),i=parseFloat(r.marginLeft)+parseFloat(r.marginRight);return t.offsetWidth+(i||0)}var Y=r("Hn5x"),J=r("O+GR"),$=r("UGvi"),ee=r("Ff8i"),te=r("50Zs"),re=Object(g.a)();function ie(e,t,r){return Object(I.e)({display:"block",cursor:"pointer",backgroundColor:"transparent",height:e.sizes.NavbarHeight,width:e.sizes.NavbarHeight,color:Object(E.e)(e.colors.QuickLaunchBar),borderTopWidth:0,borderBottomWidth:0,borderLeftColor:t?"transparent":e.colors.QuickLaunchBarButtonBorderColor,borderLeftWidth:r?e.sizes.QuickLaunchBar.ButtonBorderSize:0,borderRightColor:t?e.colors.QuickLaunchBarButtonBorderColor:"transparent",borderRightWidth:r?e.sizes.QuickLaunchBar.ButtonBorderSize:0,borderStyle:"solid"},e.colors.NavBar.NavBar1.Fill)}function se(e,t){var r=ie(e,t);return r.height=e.sizes.NavButtonHeight,r.backgroundColor=e.colors.NavBar.NavBar1.Fill,r.color=e.colors.NavBar.NavBar1.Text,r}function ne(e){var t=ae(e);return t.color=e.colors.NavBar.NavBar1.Text,t}function ae(e){return{fontFamily:"Dyn CRM Symbol",fontSize:e.fontSizes.QuickLaunchBarIcon}}var oe={display:"block",height:"100%",width:"100%"};function le(e){return{height:"100%",justifyContent:"center","border-top":e.borders.Border04}}var ce={height:"100%",width:"100%",justifyContent:"center",alignItems:"center"},pe=function(e){function t(t){var r=e.call(this,t)||this;return r._moreOptionsButtonId=Object(g.a)(),r._moreOptionsFlyoutId=Object(g.a)(),r._defaultEntitiesInList=10,r._onMeasureHandler=r._onMeasureHandler.bind(r),r._calculateMaxListItems=r._calculateMaxListItems.bind(r),r._getMoreOptionsButtonRef=r._getMoreOptionsButtonRef.bind(r),r._setFocusToFirstEntity=r._setFocusToFirstEntity.bind(r),r._getEntityListRef=r._getEntityListRef.bind(r),r._handleKeyDownInEntityList=r._handleKeyDownInEntityList.bind(r),r._toggleMoreOptionsFlyout=r._toggleMoreOptionsFlyout.bind(r),r._getOpenSiteMapButtonRef=r._getOpenSiteMapButtonRef.bind(r),r._selectAreaForFlyout=r._selectAreaForFlyout.bind(r),r.keyDownHandler=r.keyDownHandler.bind(r),r.state={},r}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;requestAnimationFrame((function(){e._openSiteMapButton&&n.findDOMNode(e._openSiteMapButton).focus()}))},t.prototype._getOpenSiteMapButtonRef=function(e){this._openSiteMapButton=e},t.prototype._toggleMoreOptionsFlyout=function(){this.setState({moreOptionsFlyoutDisplay:!this.state.moreOptionsFlyoutDisplay})},t.prototype._handleKeyDownInEntityList=function(e){var t=e.target;if(e.keyCode===d.a.DownArrow){var r=t.nextElementSibling;r&&r.focus()}else if(e.keyCode===d.a.UpArrow){var i=t.previousElementSibling;i&&i.focus()}},t.prototype._getEntityListRef=function(e){this._entityListRef=e},t.prototype._setFocusToFirstEntity=function(){var e=this;requestAnimationFrame((function(){if(e._entityListRef){var t=n.findDOMNode(e._entityListRef);t.firstChild&&t.firstChild.focus()}}))},t.prototype._renderSitemapAreaEntries=function(){var e=this.props.sitemapEntries;return e.length?e.map((function(e,t){return s.createElement(Y.a,{key:t,entry:e,isQuickLaunchBar:!0,isTabIndexZero:0===t})})):[]},t.prototype._renderMruButton=function(){var e,t=this;return this.props.shouldRenderMRU?s.createElement(a.a,{key:Object(P.c)(this.props.resourceStrings,G.d)},s.createElement(m.a,{accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.d),role:u.t,style:ie(this.props.theme,this.props.isRTL,this.props.selectedAreaId===f.d),title:Object(P.c)(this.props.resourceStrings,G.d),onClick:function(){return t.props.selectArea(f.d)},isSelected:this.props.selectedAreaId===f.d,testhooks:(e={id:"quick-launch-mru-btn"},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-navItem-"+f.d,e)},s.createElement(a.a,{style:ce},s.createElement(v.a,{style:ae(this.props.theme)},s.createElement(R.b,{type:F.a.History}))))):null},t.prototype._renderAreaButton=function(){var e,t=this,r=this.props.selectedAreaId===f.d?this.props.lastNonMruAreaId:this.props.selectedAreaId,i=function(e,t){if(e&&e.Areas&&e.Areas[t])return e.Areas[t].Titles[0].Title;return null}(this.props.siteMap,r),n=function(e,t){var r="îª†",i=null;void 0!==_.a[t]&&(r=_.a[t]);if(e&&e.Areas&&e.Areas[t]){var s=e.Areas[t];s.VectorIcon&&(r=s.VectorIcon,i=S.a)}return{type:i,value:r}}(this.props.siteMap,r);return s.createElement(a.a,{key:"selected-area"},s.createElement(m.a,{accessibilityLabel:i,role:u.t,style:this._addContrastRule(ie(this.props.theme,this.props.isRTL,this.props.selectedAreaId!==f.d),n,this.props.theme,!0),title:i,onClick:function(){return t.props.selectArea(r)},isSelected:this.props.selectedAreaId===r,testhooks:(e={id:"quick-launch-mru-btn"},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-navItem-"+this.props.selectedAreaId,e)},s.createElement(a.a,{style:ce},s.createElement(v.a,{className:"svgIcon",style:this._addContrastRule(ae(this.props.theme),n,this.props.theme)},this._getIcon(n)))))},t.prototype._addContrastRule=function(e,t,r,i){var s=t.type;if(!s||s!==S.a||Object(A.n)())return e;var n=i?r.colors.NavBar.NavBar1.Fill.toString():r.colors.QuickLaunchBar;return Object(I.b)(e,n,i)},t.prototype._getIcon=function(e){var t=e.type,r=e.value;switch(t){case S.a:var i=this.props,n=Object(A.n)(),a={width:i.theme.sizes.Icon.MinWidth,height:i.theme.sizes.Icon.MinHeight};return s.createElement(w.a,{source:r,style:a,highContrast:n});case null:return r}},t.prototype._getMoreOptionsButtonRef=function(e){this._moreOptionsButton=e},t.prototype._selectAreaForFlyout=function(e){this.props.selectArea(e,!0)},t.prototype.keyDownHandler=function(e){if(Object(c.b)(e)||this.setState({moreOptionsFlyoutDisplay:!1}),e.keyCode===d.a.Escape&&this._moreOptionsButton){var t=n.findDOMNode(this._moreOptionsButton);t&&t.focus()}},t.prototype._calculateMaxListItems=function(){var e=this._entityListRef&&n.findDOMNode(this._entityListRef),t=n.findDOMNode(this),r=t&&t.clientHeight;if(!r||!e||!e.offsetWidth)return 0;var i=(r-e.offsetTop)/e.offsetWidth;return Math.floor(i)},t.prototype._onMeasureHandler=function(e){var t=this._calculateMaxListItems();this.state.maxListItems!==t&&this.setState({maxListItems:t})},t.prototype._renderMoreOptionsButton=function(){var e,t=this,r=this.props.siteMap?Object(y.a)(this.props.siteMap):[],i=null,n=null;if(!r.length||1===r.length)return null;return this.state.moreOptionsFlyoutDisplay&&(i=this._moreOptionsFlyoutId,n=s.createElement(W,{id:this._moreOptionsFlyoutId,siteMapItems:r,setFocusToFirstEntity:this._setFocusToFirstEntity,selectedAreaId:this.props.selectedAreaId,selectArea:this._selectAreaForFlyout,keyDownHandler:this.keyDownHandler,relativeToElementId:this._moreOptionsButtonId,closeFlyout:function(e){var r=e.target,i=document.getElementById(t._moreOptionsButtonId);r&&!i.contains(r)&&i!==r&&t._toggleMoreOptionsFlyout()},isQuickLaunchBar:!0})),s.createElement(a.a,{key:"more-options"},s.createElement(m.a,{key:"button",accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.a),style:ie(this.props.theme,this.props.isRTL),id:this._moreOptionsButtonId,onClick:this._toggleMoreOptionsFlyout,accessibilityHasPopup:!0,ownsElementId:i,controlsElementId:i,accessibilityExpanded:!!this.state.moreOptionsFlyoutDisplay,ref:this._getMoreOptionsButtonRef,testhooks:(e={id:"quick-launch-more-options-btn"},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-areaBar-more-btn",e)},s.createElement(a.a,{style:ce},s.createElement(v.a,{style:ae(this.props.theme)},s.createElement(R.b,{type:F.a.More})))),n)},t.prototype.render=function(){var e,t,r=this.state.maxListItems?this.state.maxListItems:this._calculateMaxListItems(),i=this._renderSitemapAreaEntries();return r=(r=Math.min(r,this._defaultEntitiesInList))>0?r:0,i.length>r&&(i.length=r),s.createElement(a.a,{style:(t=this.props,{top:t.theme.sizes.NavbarHeight,left:t.isRTL?"initial":0,right:t.isRTL?0:"initial",bottom:0,overflow:"hidden",position:"absolute"}),testhooks:{id:"quick-launch-bar"},role:u.p,isRequestedMeasuring:!0,onMeasuring:this._onMeasureHandler,accessibilityHidden:!!this.props.isSiteMapOpen},s.createElement(a.a,{style:(e=this.props.theme,{flexDirection:"column",width:e.sizes.NavbarHeight,backgroundColor:e.colors.QuickLaunchBar})},s.createElement(a.a,{key:"Open Site Map"},s.createElement($.a,{buttonStyle:Object(I.e)(se(this.props.theme,this.props.isRTL),this.props.theme.colors.NavBar.NavBar2.Fill),iconStyle:ne(this.props.theme),isMobileMode:!1,isOpened:this.props.isSiteMapOpen,label:Object(P.c)(this.props.resourceStrings,G.k)})),this.props.shouldHideSiteMapItems?null:s.createElement(a.a,null,s.createElement(a.a,{role:u.u,accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.f)},this._renderMruButton(),this._renderAreaButton()),this._renderMoreOptionsButton(),s.createElement(a.a,{style:le(this.props.theme),role:u.v},s.createElement(v.a,{id:re,style:{display:"none"}},Object(P.c)(this.props.resourceStrings,G.f)),s.createElement(b.a,{key:"Sitemap Area Entries List",style:oe,ref:this._getEntityListRef,onKeyDown:this._handleKeyDownInEntityList},i)))))},t}(s.Component);var ue=Object(o.a)((function(){var e,t=[],r=null;return function(i,s){var n=Object(D.g)(i),a=Object(ee.g)(i),o=a&&a.length>0,l=Object(te.c)(i),c=Object(J.j)(i);if(r!==s.selectedAreaId||s.selectedAreaId===f.d||e!==c){r=s.selectedAreaId;var p=[],u=Object(J.l)(i,s.selectedAreaId);if(s.selectedAreaId===f.d&&u&&(u.length=o?1:0,!u.length&&!s.isSiteMapOpen&&s.siteMap&&s.siteMap.AreaIds)){var d=s.siteMap.AreaIds,h=d[0]!==f.d?d[0]:d[1];h&&s.selectArea(h)}u&&u.forEach((function(e){for(var t=0,r=e.entries;t<r.length;t++){var i=r[t];p.push(i)}}));var m=!0;s.selectedAreaId===f.d&&p.length===t.length&&(m=p.some((function(e,r){return e.title!==t[r].title}))),c!==e&&(e=c,m=!0),m&&(t=p)}return{sitemapEntries:t,isRTL:n,shouldRenderMRU:o,shouldHideSiteMapItems:l}}}))(pe),de=r("Cjse"),he=r("kyRo");function fe(e){return{height:e.sizes.Measures.Measure300,width:"100%",minHeight:e.sizes.Measures.Measure300,cursor:"pointer",alignItems:"center",backgroundColor:"transparent",color:e.colors.SiteMap.AppLauncherText,borderWidth:0,paddingTop:e.sizes.Measures.Measure075,paddingBottom:e.sizes.Measures.Measure075}}function me(e){return{marginRight:"5px",fontSize:e.fontSizes.Font100,height:e.sizes.Measures.Measure150,width:e.sizes.Measures.Measure100,display:"flex",alignItems:"center",paddingLeft:e.sizes.Measures.Measure050,paddingRight:e.sizes.Measures.Measure050}}function be(e){return{fontSize:e.fontSizes.Font100,height:e.sizes.Measures.Measure150,display:"inline-block",whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}var ye=function(e){function t(t){var r=e.call(this,t)||this;return r._onClickHandler=r._onClickHandler.bind(r),r}return Object(i.__extends)(t,e),t.prototype._onClickHandler=function(){this.props.skipOpenAppLandingPage||this.props.openAppLandingPage(),this.context.toggleSiteMap()},t.prototype.render=function(){var e,t,r,i;return s.createElement(a.a,{key:"appLauncherView",style:(t=this.props,r=t.theme,i=t.platformType===C.b.Web,{display:"block",width:"100%",height:r.sizes.Measures.Measure300,minHeight:r.sizes.Measures.Measure300,backgroundColor:r.colors.SiteMap.AppLauncherBar,borderColor:r.colors.SiteMap.AppLauncherBorder,borderStyle:"solid",borderLeftWidth:0,borderRightWidth:0,borderTopWidth:i?r.sizes.SiteMap.AppLauncherBorder:0,borderBottomWidth:i?0:r.sizes.SiteMap.AppLauncherBorder})},s.createElement(m.a,{accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.j),key:"appLauncherButton",onClick:this._onClickHandler,style:Object(I.e)(fe(this.props.theme),this.props.theme.colors.SiteMap.AreaBarItemActive),testhooks:(e={id:"sitemap-app-launcher-btn"},e[O.a.LearningPathDOMAttributeSuffix]="sitemap-app-launcher-btn",e)},s.createElement(R.b,{key:"appLauncherIcon",type:F.a.LeftArrowHead,style:me(this.props.theme)}),s.createElement(v.a,{key:"appLauncherText",style:be(this.props.theme)},this.props.appName||Object(P.c)(this.props.resourceStrings,G.j))))},t}(s.Component);ye.contextType=he.b;var ge=Object(o.a)(null,(function(e,t){return{openAppLandingPage:function(){e(Object(de.a)())}}}))(ye),ve=r("9r0m"),_e=function(e){function t(t){var r=e.call(this,t)||this;return r._uniqueId=ve.a.newGuid().guid,r._labelId="sitemap-sitemapAreaGroup-group-"+r._uniqueId,r._describeAreaId=r._labelId+"-narrator",r}return Object(i.__extends)(t,e),t.prototype._getGroupTitleStyle=function(e,t){return{color:e.colors.SiteMap.GroupText,display:"flex",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Semibold,height:e.sizes.Measures.Measure150,marginTop:e.sizes.Measures.Measure025,marginBottom:e.sizes.Measures.Measure025,alignItems:"center",justifyContent:"flex-start",marginLeft:t?e.sizes.Measures.Measure050:e.sizes.Measures.Measure150,marginRight:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure050}},t.prototype._getGroupStyle=function(e,t){var r={};return t||(r.marginBottom=e.sizes.Measures.Measure175),r},t.prototype._getInnerListStyle=function(){return{listStyleType:"none",flexDirection:"column"}},t.prototype._getTabletInnerListStyle=function(){return{listStyleType:"none",flexDirection:"column",width:"270px"}},t.prototype._renderSitemapAreaEntries=function(){var e=this,t=this.props,r=t.sitemapGroup,i=0===t.index,n=!1,a=this.context.toggleSiteMap;return r.entries.map((function(t,r){return t.subActionDescriptor&&!n?(n=!0,s.createElement(Y.a,{key:r,entry:t,toggleSiteMap:a,isTabIndexZero:i&&0===r,describedByElementId:e._describeAreaId})):s.createElement(Y.a,{key:r,entry:t,toggleSiteMap:a,isTabIndexZero:i&&0===r})}))},t.prototype.render=function(){var e=this.props,t=e.sitemapGroup,r=e.theme,i=e.isRTL,n=e.isTablet,a=e.isLastGroup,o=t.title,l=n?this._getTabletInnerListStyle():this._getInnerListStyle(),c=this._getGroupStyle(r,a),p=o.replace(" ","");return s.createElement(M.a,{key:"sitemap-sitemapAreaGroup-listItem",style:c},s.createElement(v.a,{key:this._labelId,testhooks:{id:"sitemap-sitemapAreaGroup-"+p},style:this._getGroupTitleStyle(r,i),role:u.r}," ",o),s.createElement(v.a,{key:this._describeAreaId,id:this._describeAreaId,style:{display:"none"},accessibilityLabel:t.narratorTitle||""}," ",t.narratorTitle||""," "),s.createElement(b.a,{key:"sitemap-sitemapAreaGroup-groupList",accessibilityLabel:o,style:l},this._renderSitemapAreaEntries()))},t}(s.Component);_e.contextType=he.b;var Ie=r("JlqV"),Me=r("/3Li"),Oe=r("aPRd");var Se={overflowY:"auto",flexGrow:1},Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype._renderGroups=function(){var e=this.props,t=e.entryGroups,r=e.isRTL,i=e.isTablet;if(!t)return null;var n=t.length;return t.map((function(t,a){return s.createElement(_e,{key:a,sitemapGroup:t,index:a,theme:e.theme,isRTL:r,isLastGroup:a===n-1,isTablet:i})}))},t.prototype.componentDidUpdate=function(e){var t=n.findDOMNode(this);if(t){var r=this.props;this._lastAreaId||r.areaId===this._lastAreaId||(t.scrollTop=0),this._lastAreaId=r.areaId}},t.prototype.render=function(){return s.createElement(a.a,{style:Se},s.createElement(b.a,{key:f.k,id:f.k,style:(e=this.props,{display:"block",overflowY:"auto",overflowX:"hidden",width:"100%",listStyleType:"none",paddingTop:e.theme.sizes.Measures.Measure150,paddingBottom:e.theme.sizes.Measures.Measure150}),accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.h),role:u.h},this._renderGroups()));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var e},t}(s.Component);function we(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.title===t.title){var r=e.subActionDescriptor||null,i=t.subActionDescriptor||null;return JSON.stringify(r)===JSON.stringify(i)}return!1}var Ae=Object(o.a)((function(){var e=null,t=null,r=null;return function(i,s){var n,a=Object(Ie.b)(i),o=Object(Me.a)(i),l=Object(Oe.c)(i),c=Object(N.a)(i);if(!t||!e||r!==a)return t=s.areaId,r=a,e={entryGroups:Object(J.l)(i,s.areaId),isRTL:Object(D.g)(i),isTablet:o===C.b.Native&&l>c.sizes.Breakpoints.DimensionS};if(s.areaId===t){n=Object(J.l)(i,s.areaId);for(var p=!1,u=function(t){var r=e.entryGroups.find((function(e){return e.title===n[t].title}));if(!r||n[t].entries.length!==r.entries.length)return p=!0,"break";for(var i=0;i<n[t].entries.length;i++){if(!we(n[t].entries[i],r.entries[i])){p=!0;break}}},d=0;d<n.length;d++){if("break"===u(d))break}if(!p)return e}return t=s.areaId,r=a,e={entryGroups:n||Object(J.l)(i,s.areaId),isRTL:Object(D.g)(i),isTablet:o===C.b.Native&&l>c.sizes.Breakpoints.DimensionS}}}))(Ee),Be=r("4tno"),ke=r("mGpW"),xe=r("DgF7"),Le=r("NxDw"),je=r("jV4X"),Te=r("ZVHh"),Fe=r("wQXd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Re(e,t){return{height:"100%",width:t?"100%":e.sizes.SiteMap.Width,flexDirection:"column",backgroundColor:e.colors.SiteMap.Default,boxShadow:t?"none":e.shadows.Shadow01}}function Ce(e,t,r,i,s,n){var a=t!==C.b.Web||i||n?e.sizes.NavBarHeightMobile:e.sizes.NavbarHeight;if((t===C.b.Web||s===Le.a.MailApp)&&!n){var o={top:a,bottom:0};return i||s===Le.a.MailApp?(o.right=0,o.left=0):r?o.right=0:o.left=0,o}return{top:0,bottom:a,left:0,right:0}}function De(e){e&&e.focus()}var Ne=function(e){function t(t){var r=e.call(this,t)||this;return r._closeSiteMap=r._closeSiteMap.bind(r),r._getAppLauncherRef=r._getAppLauncherRef.bind(r),r.selectArea=r.selectArea.bind(r),r.selectAreaNavigatToSubArea=r.selectAreaNavigatToSubArea.bind(r),r.onOutsideClickHandler=r.onOutsideClickHandler.bind(r),r.keyDownHandler=r.keyDownHandler.bind(r),r.state={},G.e.some((function(e){return!Object(P.c)(t.resourceStrings,e)}))&&t.retrieveResourceStrings(G.e),r}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this._selectAreaWithNewSitemapState(this.props.siteMap)},t.prototype.componentWillUpdate=function(e){this._selectAreaWithNewSitemapState(e.siteMap),this.props.areaId!==f.d&&e.areaId===f.d&&this.setState({lastNonMruAreaId:this.props.areaId})},t.prototype._selectAreaWithNewSitemapState=function(e){if((!this.state.lastNonMruAreaId||!this.props.areaId)&&e){var t=e.AreaIds&&e.AreaIds[0];t!==this.state.lastNonMruAreaId&&this.setState({lastNonMruAreaId:t}),t&&this.props.selectArea(t)}},t.prototype._getAppLauncherRef=function(e){this._appLauncherRef=e},t.prototype.selectArea=function(e){this.props.areaId!==e&&this.props.selectArea(e)},t.prototype.selectAreaNavigatToSubArea=function(e,t){if(this.selectArea(e),t||e!==f.d&&this.props.areaId!==f.d){var r=this.props.siteMap&&Object(je.c)(this.props.siteMap,e);r&&this.props.navigateToSubArea(r)}},t.prototype._closeSiteMap=function(){this.props.isOpened&&this.props.toggleSiteMap()},t.prototype.keyDownHandler=function(e){var t=e.target,r=new c.a(t),i=document.getElementById(f.k),s=document.getElementById(f.f);if(t&&s)switch(Object(h.e)(e.nativeEvent)){case d.a.DownArrow:i&&i.contains(t)&&(De(r.getNextSibling()),e.preventDefault());break;case d.a.UpArrow:i.contains(t)&&(De(r.getPrevSibling()),e.preventDefault());break;case d.a.RightArrow:s.contains(t)&&De(r.getNextSibling());break;case d.a.LeftArrow:s.contains(t)&&De(r.getPrevSibling());break;case d.a.Enter:s.contains(t)&&De(r.getFirstItemOfEntityNavBar());break;case d.a.Escape:this._closeSiteMap();break;case d.a.Home:i.contains(t)&&De(r.getFirstItemOfEntityNavBar());break;case d.a.End:i.contains(t)&&De(r.getLastItemofEntityNavBar());break;case d.a.Tab:var a=this.props.platformType===C.b.Web,o=this.props.clientHost===Le.a.MailApp;if(a||o)if(e.shiftKey){if(s.contains(t)){if(this._appLauncherRef)(l=n.findDOMNode(this._appLauncherRef))&&De(l.firstChild);else De(r.getFirstItemOfEntityNavBar());e.preventDefault()}}else if(this._appLauncherRef){(l=n.findDOMNode(this._appLauncherRef))&&l.contains(t)&&(Object(c.d)(),e.preventDefault())}else i.contains(t)&&(Object(c.d)(),e.preventDefault());else if(e.shiftKey){(l=n.findDOMNode(this._appLauncherRef))&&l.contains(t)&&(Object(c.d)(),e.preventDefault())}else if(s.contains(t)){var l;(l=n.findDOMNode(this._appLauncherRef))&&De(l.firstChild),e.preventDefault()}break;default:if(i.contains(t)&&e.keyCode>=d.a.A&&e.keyCode<=d.a.Z){var p=e.keyCode-d.a.A,u=String.fromCharCode("a".charCodeAt(0)+p);De(r.findNextMatchingListItem(u))}}},t.prototype.componentDidUpdate=function(e,t){e.areaId&&e.areaId!==this.props.areaId&&this.props.isOpened&&requestAnimationFrame((function(){De((new c.a).getFirstItemOfEntityNavBar())}))},t.prototype.onOutsideClickHandler=function(e){var t=e.target,r=document.getElementById(f.g);t&&!r.contains(t)&&r!==t&&this.props.toggleSiteMap()},t.prototype._renderQuickLaunchBar=function(e){return this.props.platformType===C.b.Native||e||this.props.shouldHideSideBar||this.props.isEmbedded?null:s.createElement(ue,{key:"quick-launch-bar",siteMap:this.props.siteMap,selectedAreaId:this.props.areaId,lastNonMruAreaId:this.state.lastNonMruAreaId,selectArea:this.selectAreaNavigatToSubArea,theme:this.props.theme,isSiteMapOpen:this.props.isOpened,resourceStrings:this.props.resourceStrings})},t.prototype._renderSiteMap=function(e){var t=this.props.siteMap,r=this.props.clientHost!==Le.a.MobileApplication,i=this.props.platformType===C.b.Native||e;if(!this.props.isOpened)return null;var n=s.createElement(Z,{siteMap:t,platformType:this.props.platformType,theme:this.props.theme,selectedAreaId:this.props.areaId,selectArea:this.selectArea,closeSiteMap:this._closeSiteMap,resourceStrings:this.props.resourceStrings,isAreaBarEmpty:this.props.shouldHideSiteMapItems}),o=this.props.shouldHideSiteMapItems?s.createElement(a.a,{style:{flexGrow:1}}):s.createElement(Ae,{key:"sitemap-navBar-areaPaneNavBar",areaId:this.props.areaId,theme:this.props.theme,resourceStrings:this.props.resourceStrings}),l=this.props.isEmbedded?null:s.createElement(ge,{appName:this.props.appName,theme:this.props.theme,platformType:this.props.platformType,skipOpenAppLandingPage:this.props.clientHost===Le.a.MailApp,ref:this._getAppLauncherRef,resourceStrings:this.props.resourceStrings});return s.createElement(p.a,{key:"sitemap-navBar-flyout",positionType:"absolute",position:Ce(this.props.theme,this.props.platformType,this.props.isRTL,e,this.props.clientHost,this.props.isEmbedded),onOutsideClick:this.onOutsideClickHandler},s.createElement(a.a,{id:f.e,key:f.e,testhooks:{id:"navbar-container"},onKeyDown:this.keyDownHandler,semanticTag:"nav",role:u.p,accessibilityLabel:Object(P.c)(this.props.resourceStrings,G.h),style:Re(this.props.theme,i)},r?n:l,o,r?l:n))},t.prototype.render=function(){var e=this.props.theme.sizes.Breakpoints.DimensionS,t=this.props.viewportWidth<=e;return s.createElement(a.a,null,this._renderSiteMap(t),this._renderQuickLaunchBar(t))},t}(s.Component);Ne.displayName="NavBar";var ze=Object(o.a)((function(){var e=Object(P.h)();return function(t,r){var i=Object(l.b)(t),s=Object(Me.a)(t);return{siteMap:i,theme:Object(N.a)(t),platformType:s,resourceStrings:e(t,G.e),isRTL:Object(D.g)(t),appName:Object(Be.j)(t),viewportWidth:Object(Oe.c)(t),clientHost:Object(xe.a)(t),shouldHideSideBar:Object(te.b)(t),shouldHideSiteMapItems:Object(te.c)(t),isEmbedded:Object(Fe.c)(t)}}}),(function(e,t){return{retrieveResourceStrings:function(t){return e(Object(ke.e)(t))},navigateToSubArea:function(t){e(Object(Te.c)(t,!1,null))}}}))(Ne)},hp1u:function(e,t,r){"use strict";r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return _}));var i=r("c/eZ"),s=r("nuS9"),n=r("uTTW"),a=r("S6oQ"),o=r("4E+q"),l=r("c56u"),c=r("JlqV"),p=r("EGsq"),u=r("EXRB"),d=r("7EJx"),h=r("s5BY");var f=r("kyRo"),m=r("XFxG"),b=r("8ul+"),y=r("qC0c"),g=r("cZkS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){return s.createElement(I,{imgSrc:e.source,render:function(t){return s.createElement(a.a,Object(i.__assign)({focusable:"false"},e,{source:t,altText:e.altText}))}})}function _(e){return s.createElement(I,{imgSrc:e.source,render:function(t){return s.createElement(n.a,Object(i.__assign)({},e,{source:t,altText:e.altText}))}})}function I(e){var t,r=e.imgSrc,i=e.render,n=s.useContext(f.a).AssetLoader,a=s.useState(r),v=a[0],_=a[1],I=function(e,t){return Object(o.d)((function(r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */return function(e,t,r){var i=Object(l.w)(e),s=!Object(c.b)(e),n=Object(p.t)(e),a=Object(u.d)(e);return(i&&s||a)&&function(e,t,r){void 0===t&&(t="");var i="$webresource:",s="/webresources/",n=t.toLowerCase();return n.startsWith(i)?(r(t.substr(i.length)),!0):n.startsWith(s)?(r(t.substr(s.length)),!0):!!n.startsWith(e)&&(r(t.substr(e.length)),!0)}(n,t,r)}(r,e,t)}))}(r,(function(e){return t=e})),M=function(e){return Object(o.d)((function(t){return function(e,t){var r;if((null===(r=Object(d.w)(e))||void 0===r?void 0:r.usePathBasedUrls)&&t.toLowerCase().startsWith("/webresources/"))return Object(h.a)(e,t)}(t,e)}))}(r),O=Object(o.d)((function(e){return Object(y.b)(e,g.b)})),S=Object(o.d)(b.a);return s.useEffect((function(){I?n.loadOfflineWebResource(t).then((function(e){e&&_(m.a.createDataUri(m.b.Svg,e).toString())})):_(M||r)}),[I,M,r,t,n]),i(v,O&&S)}},mTVg:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r("c/eZ"),s=r("nuS9"),n=r("TCzx"),a=r("hp1u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){var t=e.source,r=e.style;if(n.a.getInstance().get_IsBrowserIE()&&!e.useImgInIE||e.highContrast){var o=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},r),e.invert?{fill:"white"}:{}),e.highContrast?{fill:"windowText"}:{});return s.createElement(a.b,{source:t,style:o,fallbackToImage:!0,title:e.title,role:e.role,altText:e.altText})}var l=Object(i.__assign)(Object(i.__assign)({},r),e.invert?{filter:"invert(100%)"}:{});return s.createElement(a.a,{source:t,style:l,title:e.title,role:e.role,altText:e.altText})}}}]),window.bundleExecutionMarkers["scripts/es5/navbar.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();