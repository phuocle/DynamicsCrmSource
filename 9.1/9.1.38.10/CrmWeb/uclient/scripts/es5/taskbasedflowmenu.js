(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/taskbasedflowmenu.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[105],{"X+pq":function(e,t,n){"use strict";n.r(t),n.d(t,"TaskBasedFlowMenu",(function(){return R}));var o=n("c/eZ"),i=n("nuS9"),s=n("1AYO"),r=n("G7N+"),a=n("YWpA"),l=n("evW+"),u=n("Wi7Z"),d=n("4E+q"),p=n("KIny"),c=n("uTTW"),m=n("H/hG"),y=n("sAQI"),h=n("MGMD"),f=n("Smta"),b=function(e){function t(t){var n=e.call(this,t)||this;return n._wasClicked=!1,n._onMenuItemClick=n._onMenuItemClick.bind(n),n}return Object(o.__extends)(t,e),t.prototype._onMenuItemClick=function(e){this._wasClicked||(this._wasClicked=!0,this.props.toggleMenu(),this.props.openTaskBasedFlowPage(this.props.primaryModelName,this.props.uniqueName))},t.prototype.render=function(){var e,t=this.props.id+"_displayImage",n=null;this.props.imageUrl&&(n=i.createElement(c.a,{style:this.props.style.imageStyle,testhooks:{id:t},id:t,key:t,source:this.props.imageUrl,altText:this.props.displayName,role:u.r}));var o=this.props.id+"_body",s=this.props.id+"_displayName",r=this.props.id+"_description",d="tbxmenuitem|"+this.props.uniqueName,p=this.props.id+"tbxMenuItemContainer",y=this.props.id+"tbxMenuItemBlackBackground",b=(this.props.headerLabelId?this.props.headerLabelId+" ":"")+r;return i.createElement(f.a,{id:p,key:p,style:this.props.itemContainerStyle,onClick:this._onMenuItemClick,tabIndex:-1,role:u.n,accessibilityLabel:this.props.displayName,describedByElementId:b},i.createElement(l.a,{testhooks:(e={id:this.props.id},e[h.a.LearningPathDOMAttributeSuffix]=d,e),id:this.props.id,key:this.props.id,role:u.r,style:this.props.style.buttonStyle,tabIndex:-1},i.createElement(a.a,{testhooks:{id:o},id:o,key:o,role:u.r,style:this.props.style.itemBodyStyle,tabIndex:-1},n,i.createElement(a.a,{id:y,key:y,style:this.props.style.blackBackgroundStyle,role:u.r}),i.createElement(m.a,{testhooks:{id:s},id:s,key:s,style:this.props.style.titleStyle},this.props.displayName),i.createElement(m.a,{testhooks:{id:r},id:r,key:r,style:this.props.style.descriptionStyle,tabIndex:-1},this.props.description))))},t}(i.Component);var g=Object(d.a)((function(e,t){var n=Object(p.a)(e,t.uniqueName);return{displayName:n.displayName,imageUrl:n.imageUrl,primaryModelName:n.primaryModelName,description:n.description}}),(function(e){return{openTaskBasedFlowPage:function(t,n,o){e(Object(y.a)(t,n,o,null,void 0))}}}))(b),M=n("kyRo"),_=n("Namv"),C=n("Ww2r"),k=n("BFwB"),w=function(e){function t(t){var n=e.call(this,"uci_taskflow_menu_opened")||this;return n.addEventParameter("EventTime",new Date),n.addEventParameter("NumberOfTaskFlows",t),n}return Object(o.__extends)(t,e),t}(k.a),v=n("znb3"),x=n("XIN1"),S=n("7EJx"),B=n("aPRd"),I=n("wV3W");var F=n("4fxQ"),T=n("gvL4"),E=n("9rQ4"),O=n("JlqV"),j=["TaskBasedFlow_Menu_Loading_Text","TaskBasedFlow_Menu_Empty_Text","Button_Cancel","TaskBasedFlow_Menu_Header_Text","Mobile_TaskBasedFlow_AppLauncher_Offline","TaskBasedFlow_Lookup_Label","TaskBasedFlow_Button_Next"],D=function(e){function t(t){var n=e.call(this,t)||this;return n._onCloseHandler=n._onCloseHandler.bind(n),n._onKeyboardPress=n._onKeyboardPress.bind(n),n._onCancelButtonKeyDown=n._onCancelButtonKeyDown.bind(n),n._setInitialFocus=n._setInitialFocus.bind(n),n._setInitialFocusCancelButton=n._setInitialFocusCancelButton.bind(n),n._selectedMenuItemIndex=-1,n}return Object(o.__extends)(t,e),t.prototype._renderCancelButton=function(){var e=this,t=null;return this.props.isMobileMode&&(t=i.createElement(l.a,{id:"tbxMenuCancel",testhooks:{id:"tbxMenuCancel"},ref:this._setInitialFocusCancelButton,key:"tbxMenuCancel",onClick:function(){return e.props.toggleMenu()},accessibilityLabel:Object(C.c)(this.props.resourceStrings,"Button_Cancel"),style:this.props.cancelButtonStyle,onKeyDown:this._onCancelButtonKeyDown},i.createElement(x.b,{type:v.a.Cancel,style:this.props.cancelButtonIconStyle}))),t},t.prototype.componentDidMount=function(){if(this.props.isMenuOpened){var e=this.context;if(e){var t=this.props.taskBasedFlowNames?this.props.taskBasedFlowNames.length:0,n=new w(t);e.EventManager.ReportEvent(n)}document.addEventListener("keydown",this._onCloseHandler)}},t.prototype._moveIndex=function(e){var t=F.findDOMNode(this._menuItems);if(t&&t.childNodes){var n=t.childNodes[e];n.tabIndex=0,n.focus()}},t.prototype._setInitialFocus=function(e){var t=this;this._menuItems=e;var n=null;if(e){var o=F.findDOMNode(this._menuItems);o&&requestAnimationFrame((function(){(n=o.firstChild)&&(n.focus(),t._selectedMenuItemIndex=0)}))}},t.prototype._setInitialFocusCancelButton=function(){this._taskBasedFlowsAvailable()||requestAnimationFrame((function(){var e=document.getElementById("tbxMenuCancel");e&&e.focus()}))},t.prototype._onKeyboardPress=function(e){if(e.keyCode===E.a.Enter)e.stopPropagation(),e.preventDefault(),e.target&&e.target.click();else if(e.keyCode===E.a.UpArrow){e.stopPropagation(),e.preventDefault();var t=0===this._selectedMenuItemIndex?this.props.taskBasedFlowNames.length-1:this._selectedMenuItemIndex-1;this._selectedMenuItemIndex=t,this._moveIndex(t)}else if(e.keyCode===E.a.DownArrow){e.stopPropagation(),e.preventDefault();t=this._selectedMenuItemIndex===this.props.taskBasedFlowNames.length-1?0:this._selectedMenuItemIndex+1;this._selectedMenuItemIndex=t,this._moveIndex(t)}else if(e.keyCode===E.a.Tab){e.stopPropagation(),e.preventDefault();var n=document.getElementById("tbxMenuCancel");n&&n.focus()}},t.prototype._onCancelButtonKeyDown=function(e){if(e)if(e.keyCode===E.a.Tab){if(e.stopPropagation(),e.preventDefault(),!this._taskBasedFlowsAvailable())return;this._moveIndex(this._selectedMenuItemIndex)}else e.keyCode===E.a.Enter&&(e.stopPropagation(),e.preventDefault(),e.target&&e.target.click(),this._focusParentButton())},t.prototype._onCloseHandler=function(e){if(e.keyCode===E.a.Escape||e.keyCode===E.a.LeftArrow||e.keyCode===E.a.RightArrow){if(!this.props.isMenuOpened)return;e.stopImmediatePropagation(),this.props.toggleMenu(),this._focusParentButton()}},t.prototype._focusParentButton=function(){var e=document.getElementById(this.props.parentElementId);null!=e&&e.focus()},t.prototype._addAriaAttributesForParentElement=function(){var e=document.getElementById(this.props.parentElementId);null!=e&&(e.setAttribute("aria-owns","taskBasedMenuContainer"),e.setAttribute("aria-controls","taskBasedMenuContainer"))},t.prototype._removeAriaAttributesForParentElement=function(){var e=document.getElementById(this.props.parentElementId);null!=e&&(e.hasAttribute("aria-owns")&&e.removeAttribute("aria-owns"),e.hasAttribute("aria-controls")&&e.removeAttribute("aria-controls"))},t.prototype._taskBasedFlowsAvailable=function(){return!this.props.isOffline&&this.props.taskBasedFlowNames&&this.props.taskBasedFlowNames.length>0},t.prototype._getMenuList=function(){for(var e=[],t=0;t<this.props.taskBasedFlowNames.length;t++){var n=this.props.taskBasedFlowNames[t],o="taskBasedFlowMenuItem-"+n,s=this.props.itemStyle.itemContainer;0===t?s=this.props.itemStyle.firstItemContainer:t===this.props.taskBasedFlowNames.length-1&&(s=this.props.itemStyle.lastItemContainer),e.push(i.createElement(g,{id:o,key:n,uniqueName:n,toggleMenu:this.props.toggleMenu,style:this.props.itemStyle,itemContainerStyle:s,headerLabelId:"tbxMenuHeader"}))}return i.createElement(T.a,{id:"tbxMenuContentContainer",key:"tbxMenuContentContainer",ref:this._setInitialFocus,style:this.props.menuContentContainerStyle,role:u.l,onKeyDown:this._onKeyboardPress,accessibilityLabel:Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Header_Text")},e)},t.prototype.render=function(){var e;if(this._taskBasedFlowsAvailable())e=this._getMenuList();else{var t=void 0;t=this.props.isOffline?Object(C.c)(this.props.resourceStrings,"Mobile_TaskBasedFlow_AppLauncher_Offline"):this.props.taskBasedFlowMenuStatus===r.a.Initialized?Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Empty_Text"):Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Loading_Text"),e=i.createElement(a.a,{id:"tbxMenuContentContainer",key:"tbxMenuContentContainer",role:u.r,style:this.props.messageContainerStyle},i.createElement(m.a,{testhooks:{id:"tbx-menu-status"},key:"tbx-menu-status",id:"tbx-menu-status",accessibilityLive:"assertive",role:u.a,semanticTag:"p",onKeyDown:this._onKeyboardPress,style:this.props.messageTextStyle},t))}this._addAriaAttributesForParentElement();var n=Object(C.c)(this.props.resourceStrings,"TaskBasedFlow_Menu_Header_Text");return i.createElement(a.a,{testhooks:{id:"taskBasedMenuContainer"},key:"taskBasedMenuContainer",id:"taskBasedMenuContainer",style:this.props.menuContainerStyle,labelledByElementId:"tbxMenuHeader",role:u.r},i.createElement(a.a,{id:"tbxMenuHeaderContainer",key:"tbxMenuHeaderContainer",style:this.props.menuHeaderContainerStyle,role:u.r},i.createElement(a.a,{id:"tbxMenuHeaderContentContainer",key:"tbxMenuHeaderContentContainer",style:this.props.menuHeaderContentContainerStyle,role:u.r},i.createElement(m.a,{id:"tbxMenuHeader",key:"tbxMenuHeader",style:this.props.headerStyle,role:u.i},n),this._renderCancelButton())),e)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._onCloseHandler),this._removeAriaAttributesForParentElement()},t}(i.Component);D.contextType=M.a;var N=Object(d.a)((function(){var e,t,n,i,s,r,a=Object(C.h)(),l=(e=null,t=null,n=!1,i=null,s=!1,r={":focus":{outlineOffset:"1px !important"}},function(a,l){var u=Object(I.a)(a),d=Object(S.g)(a),p=Object(B.b)(a);if(t!==u||n!==d||i!==p||s!==l.isMobileMode){t=u,n=d,i=p,s=l.isMobileMode;var c={marginBottom:u.sizes.Measures.Measure025,minHeight:"6.3em",marginLeft:u.sizes.Measures.Measure100,marginRight:u.sizes.Measures.Measure100},m=Object(o.__assign)(Object(o.__assign)({},c),r),y=Object(o.__assign)(Object(o.__assign)({},m),{marginTop:"2px"}),h=Object(o.__assign)(Object(o.__assign)({},m),{marginBottom:"0px"});e={menuContainerStyle:{flexDirection:"column",backgroundColor:u.colors.WhiteBackground,width:l.isMobileMode?"100%":"28.6rem",height:l.isMobileMode?"100%":void 0,maxHeight:l.isMobileMode?void 0:.8*p+"px",justifyContent:"flex-start",borderStyle:u.display.SolidBorderStyle,borderWidth:"1px",borderColor:"transparent"},menuContentContainerStyle:{listStyleType:"none",flexDirection:"column",overflowY:"auto",marginTop:u.sizes.Measures.Measure100,marginBottom:u.sizes.Measures.Measure100},menuHeaderContainerStyle:{display:"flex",flexDirection:"column",minHeight:u.sizes.Measures.Measure225,backgroundColor:"white",paddingTop:u.sizes.Measures.Measure050,paddingBottom:u.sizes.Measures.Measure050,justifyContent:"center"},menuHeaderContentContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-between"},headerStyle:{textOverflow:"ellipsis",overflow:"hidden",color:u.colors.BaseColor.Grey.Grey7,fontSize:u.fontSizes.Font100,fontFamily:u.fontFamilies.Semibold,marginLeft:d?void 0:u.sizes.Measures.Measure150,marginRight:d?u.sizes.Measures.Measure150:void 0,alignSelf:"center"},cancelButtonStyle:{borderStyle:"none",backgroundColor:"transparent",cursor:"pointer",minWidth:"2em",height:"2em",opacity:1,marginRight:d?void 0:u.sizes.Measures.Measure100,marginLeft:d?u.sizes.Measures.Measure100:void 0},cancelButtonIconStyle:{color:u.colors.BaseColor.Grey.Grey6,backgroundColor:"transparent",fontSize:u.fontSizes.TextBox.FontIcon},messageTextStyle:{textAlign:"center",fontSize:u.fontSizes.Font100,fontFamily:u.fontFamilies.Regular,color:u.colors.BaseColor.Grey.Grey7},messageContainerStyle:{display:"flex",justifyContent:"center",flexDirection:"column",marginTop:u.sizes.Measures.Measure100,marginBottom:u.sizes.Measures.Measure100},itemStyle:{itemContainer:m,firstItemContainer:y,lastItemContainer:h,buttonStyle:{padding:"1rem",width:"100%",borderStyle:u.display.SolidBorderStyle,borderColor:"transparent",borderWidth:"1px",justifyContent:"center",position:"relative",overflow:"hidden",cursor:"pointer"},itemBodyStyle:{display:"flex",flexDirection:"column",width:"100%"},imageStyle:{position:"absolute",top:0,left:0,width:"100%",height:"auto",marginTop:"-28%",filter:"blur(6px)"},blackBackgroundStyle:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:"black",opacity:.65},titleStyle:{position:"relative",width:"100%",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:u.fontSizes.Font100,fontFamily:u.fontFamilies.Semibold,lineHeight:"1.4rem",color:"white",textAlign:d?"right":"left"},descriptionStyle:{position:"relative",textOverflow:"ellipsis",overflow:"hidden",fontSize:u.fontSizes.Font100,fontFamily:u.fontFamilies.Regular,color:"white",height:"2.8rem",lineHeight:"1.4rem",textAlign:d?"right":"left"}}}}return e});return function(e,t){var n=l(e,t),o=a(e,j),i=Object(_.a)(e),s=!Object(O.b)(e);return{taskBasedFlowNames:i?i.taskBasedFlowUniqueNames:[],taskBasedFlowMenuStatus:i?i.initialized:null,resourceStrings:o,menuContainerStyle:n.menuContainerStyle,menuContentContainerStyle:n.menuContentContainerStyle,menuHeaderContainerStyle:n.menuHeaderContainerStyle,menuHeaderContentContainerStyle:n.menuHeaderContentContainerStyle,headerStyle:n.headerStyle,cancelButtonStyle:n.cancelButtonStyle,cancelButtonIconStyle:n.cancelButtonIconStyle,messageTextStyle:n.messageTextStyle,messageContainerStyle:n.messageContainerStyle,itemStyle:n.itemStyle,isOffline:s}}}))(D),A=n("S9rj"),H=n("/3Li"),z=n("0u+G"),L=n("mGpW"),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.retrieveTbxMenuResourceStrings(),this.props.retrieveTaskBasedFlowGlobalMenu()},t.prototype.toggleFlyout=function(e){this._isTBXMenuButtonClick(e)||this.props.toggleFlyoutDisplay(!1)},t.prototype._isTBXMenuButtonClick=function(e){if(e){var t=e.target;do{if(t.id===this.props.relativeToDomId)return!0;t=t.parentElement}while(t)}return!1},t.prototype.render=function(){var e=this;return i.createElement(s.a,{id:"tbxMenu",key:"tbxMenu",groupId:"tbxMenu",relativeToElementId:this.props.isMobileMode?void 0:this.props.relativeToDomId,positionType:this.props.isMobileMode?"absolute":"relative",position:this.props.isMobileMode?{left:0,top:0}:void 0,size:this.props.isMobileMode?{width:this.props.flyoutWidth,height:this.props.flyoutHeight}:void 0,flyoutDirection:this.props.platformType===z.b.Native?s.b.down:this.props.isMobileMode?void 0:this.props.isRTL?s.b.down:s.b.downleft,onOutsideClick:function(t){return e.toggleFlyout(t)},parentFlyoutRoot:"__flyoutRootNode",flyoutStyle:{boxShadow:this.props.theme.shadows.Shadow01}},i.createElement(N,{isMobileMode:this.props.isMobileMode,isMenuOpened:!0,toggleMenu:this.toggleFlyout.bind(this),parentElementId:this.props.relativeToDomId}))},t}(i.Component);function W(e,t){return t&&e&&e.sizes.Breakpoints.DimensionS&&t.deviceWidth<e.sizes.Breakpoints.DimensionS}var R=Object(d.a)((function(e){var t=Object(I.a)(e),n=Object(B.a)(e);return{isMobileMode:W(t,n),flyoutHeight:n.deviceHeight,flyoutWidth:n.deviceWidth,platformType:Object(H.a)(e),isRTL:Object(S.g)(e),theme:t}}),(function(e){return{toggleFlyoutDisplay:function(t){e(Object(A.d)(t))},retrieveTbxMenuResourceStrings:function(){e(Object(L.e)(j))},retrieveTaskBasedFlowGlobalMenu:function(){e(Object(A.c)())}}}))(P)}}]),window.bundleExecutionMarkers["scripts/es5/taskbasedflowmenu.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();