(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/nativeplatform.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[86],{"7tSO":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e[e.None=0]="None",e[e.UnableToFindAnActivity=1]="UnableToFindAnActivity",e[e.UnableToFindTheDataID=2]="UnableToFindTheDataID",e[e.UnableToFindUIActivity=3]="UnableToFindUIActivity",e[e.EmptyUrl=4]="EmptyUrl",e[e.UnknownMimeType=5]="UnknownMimeType",e[e.InvalidLocalUrl=6]="InvalidLocalUrl",e[e.UnsupportedPlatform=7]="UnsupportedPlatform",e[e.UnableToOpenDocumentInteractionController=8]="UnableToOpenDocumentInteractionController"}(n||(n={}))},"8fMp":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e,t){return{name:e,operations:t}}r.d(t,"a",(function(){return n}))},LycM:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e[e.documentsLibrary=0]="documentsLibrary",e[e.computerFolder=1]="computerFolder",e[e.desktop=2]="desktop",e[e.downloads=3]="downloads",e[e.homeGroup=4]="homeGroup",e[e.musicLibrary=5]="musicLibrary",e[e.picturesLibrary=6]="picturesLibrary",e[e.videosLibrary=7]="videosLibrary"}(n||(n={}))},Qn8b:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=.75},"a/Ab":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="areaSwitcherModal",i="recentsListModal",o="profileModal",a="pinnedListModal",s="settingsModal"},stk2:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return c}));var n=r("c/eZ"),i=r("61oC"),o=r("pytl"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.get_dataID=function(){return this.getValue(t._DataIDProperty)},t.prototype.set_dataID=function(e){return this.setValue(t._DataIDProperty,e),e},t.prototype.get_size=function(){return this.getValue(t._SizeProperty)},t.prototype.set_size=function(e){return this.setValue(t._SizeProperty,e),e},t.prototype.get_filename=function(){return this.getValue(t._FilenameProperty)},t.prototype.set_filename=function(e){return this.setValue(t._FilenameProperty,e),e},t.prototype.get_mimeType=function(){return this.getValue(t._MimeTypeProperty)},t.prototype.set_mimeType=function(e){return this.setValue(t._MimeTypeProperty,e),e},t.prototype.get_name=function(){return this.get_filename()},t.prototype.get_type=function(){return this.get_mimeType()},t._DataIDProperty=new o.a("dataID",String,t),t._SizeProperty=new o.a("size",Number,t),t._FilenameProperty=new o.a("filename",String,t),t._MimeTypeProperty=new o.a("mimeType",String,t),t}(i.a),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.get_fileContents=function(){return this.getValue(t._FileContentsProperty)},t.prototype.set_fileContents=function(e){return this.setValue(t._FileContentsProperty,e),e},t._FileContentsProperty=new o.a("fileContents",String,t),t}(a),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.get_resourceUrl=function(){return this.getValue(t._ResourceUrlProperty)},t.prototype.set_resourceUrl=function(e){return this.setValue(t._ResourceUrlProperty,e),e},t._ResourceUrlProperty=new o.a("resourceUrl",String,t),t}(a)},uvAW:function(e,t,r){"use strict";r.r(t),r.d(t,"NativePlatform",(function(){return Tt}));var n=r("c/eZ"),i=r("BkVw"),o=function(){function e(){}return e.prototype.attachCallbacks=function(e,t,r){return e.push(t,r),e},e}(),a=function(){function e(){}return e.prototype.attachCallbacks=function(e,t,r){return e.unshift(t,r),e},e}();function s(e,t){var r=e,n="get_"+t,i=r[n];return i||(i=r[n="get_"+t.charAt(0).toLowerCase()+t.substring(1)]),i?i.call(r):null}var c,u,l=r("L8jl"),p=r("U56z"),d=r("8fMp"),h=r("zhda"),f=((c={})[l.a]=p.a,c[l.c]=p.c,c[l.h]=p.h,c),m=function(){function e(e,t){this._bridge=e,this._callbackAttacher=t||new o}return e.prototype.executeServiceOperation=function(e,t,r){var i=this;return new Promise((function(t,r){return Object(n.__awaiter)(i,void 0,void 0,(function(){var i,o,a,c,u,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i=e.getServiceName(),o=e.getOperationName(),a=e.getParameters().slice(),(c=s(this._bridge,i))?[4,c]:[3,2];case 1:return u=n.sent(),(l=u[o])?l.apply(u,this._callbackAttacher.attachCallbacks(a,t,r)):r({errorCode:h.a.ServiceAndOperationNotSupported,param:i+"."+o}),[3,3];case 2:r({errorCode:h.a.ServiceNotSupported,param:i}),n.label=3;case 3:return[2]}}))}))}))},e.getAvailableServiceOperations=function(e,t){if(e.willDispatcherBeAvailableFromDevice(t)){var r=f[t];if(r)return Object(d.a)(t,r)}},e}();!function(e){e[e.PluginCancelled=1]="PluginCancelled",e[e.FileSizeBreached=2]="FileSizeBreached",e[e.FileSizeCannotBeZero=3]="FileSizeCannotBeZero",e[e.CameraPluginError=4]="CameraPluginError",e[e.VideoCapturePluginError=5]="VideoCapturePluginError",e[e.AudioCapturePluginError=6]="AudioCapturePluginError",e[e.BarCodePluginError=7]="BarCodePluginError",e[e.GeoLocationPluginError=8]="GeoLocationPluginError",e[e.NoActivityToAudioCapture=9]="NoActivityToAudioCapture"}(u||(u={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var v,g=function(){function e(e){this._defaultProvider=new m(e,new a)}return e.prototype.executeServiceOperation=function(e,t,r){var n=e.getParameters().slice(),o=new i.a("CordovaMedia",e.getOperationName(),n);return this._defaultProvider.executeServiceOperation(o,t,r).then((function(e){return e}),(function(e){return e===u.PluginCancelled?Promise.reject({errorCode:h.a.PluginCancelled}):Promise.reject({errorCode:h.a.BarCodeCaptureFailed})}))},e.getAvailableServiceOperations=function(e){return Object(d.a)(l.b,p.b)},e}(),_=r("EGsq"),b=r("Qn8b");!function(e){e[e.GetPhotoFromGalleryFailed=-1]="GetPhotoFromGalleryFailed",e[e.UnableToOpenFile=0]="UnableToOpenFile",e[e.ApplicationInSnapView=1]="ApplicationInSnapView",e[e.FileSizeBreached=2]="FileSizeBreached",e[e.FileSizeCannotBeZero=3]="FileSizeCannotBeZero",e[e.AttachmentTypeBlocked=4]="AttachmentTypeBlocked",e[e.FilePickerCancelled=5]="FilePickerCancelled"}(v||(v={}));var y=r("stk2"),S=r("7tSO"),O=r("jzXk");function k(e){return new w(e.get_filename(),e.get_size(),e.get_mimeType(),e.get_resourceUrl())}var w=function(){function e(e,t,r,n){this.fileName=e,this.fileSize=t,this.mimeType=r,this.fileUrl=n}return e.prototype.getBinaryReader=function(e){return new T(this.fileUrl,e)},Object.defineProperty(e.prototype,"fileContent",{get:function(){throw new Error("fileContent is not available. Use fileUrl and getBinaryReader() instead.")},enumerable:!1,configurable:!0}),e}(),T=function(){function e(e,t){this._fileUrl=e,this._currentIndex=0,(!t||t<1048576)&&(t=1048576),this._chunkSize=Math.floor(t)}return e.prototype.getCurrentIndex=function(){return this._currentIndex},e.prototype.read=function(){var e=this;return this._fetchBlobFromFileUrl().then((function(){return new Promise((function(t){if(!e._blob||e._currentIndex>=e._blob.size)t(new P(!0,null));else{var r=e._currentIndex+e._chunkSize>e._blob.size?e._blob.size:e._currentIndex+e._chunkSize,n=e._blob.slice(e._currentIndex,r),i=new FileReader;i.onloadend=function(){e._currentIndex=r;var n=i.result,o=new Uint8Array(n);t(new P(!1,o))},i.readAsArrayBuffer(n)}}))}))},e.prototype._fetchBlobFromFileUrl=function(){var e=this;if(!this._fileUrl)throw new Error("_fetchBlobFromFileUrl: fileUrl is not available.");return this._blob?Promise.resolve():fetch(this._fileUrl).then((function(t){return t.ok?t.blob().then((function(t){e._blob=t}),(function(t){return Promise.reject("_fetchBlobFromFileUrl: FAILED - couldn't read body from "+e._fileUrl+": "+JSON.stringify(t))})):Promise.reject("_fetchBlobFromFileUrl: FAILED - received "+t.status+" from "+e._fileUrl)}),(function(t){return Promise.reject("_fetchBlobFromFileUrl: FAILED - "+JSON.stringify(t)+" from "+e._fileUrl)}))},e}(),P=function(e,t){this.done=e,this.value=t},A=r("LycM"),C="Data",F="Document",x="Multimedia",j=function(){function e(e){this._defaultProvider=new m(e)}return e.prototype.executeServiceOperation=function(e,t,r){var n=e.getOperationName();switch(n){case p.d.openFile.name:return this._openFile(e,t,r);case p.d.pickFile.name:var i=void 0;return e.getParameters()&&e.getParameters()[0]&&(i=e.getParameters()[0]),(null==i?void 0:i.useBinaryReader)?this._pickFileForUrl(e,t,r):this._pickFile(e,t,r)}return new Promise((function(e,t){t({errorCode:h.a.ServiceAndOperationNotSupported,param:"FileManager."+n})}))},e.prototype._openFile=function(e,t,r){var n=this;return new Promise((function(o,a){var s=e.getParameters().slice()[0],c=t.TraceManager.getTracer();if(!s)return c.error("Parameter file is null or undefined"),a({errorCode:h.a.OpenDocumentErrorCodeGeneric});if(s.fileName||(s.fileName="Default_name_"+Date.now()),!s.mimeType)return c.error("File "+Object(O.c)(s.fileName)+" parameter file.mimeType is null or undefined"),a({errorCode:h.a.OpenDocumentErrorCodeGeneric});if(!s.fileContent)return c.error("File "+Object(O.c)(s.fileName)+" doesnâ€™t have any content and cannot be opened."),a({errorCode:h.a.OpenDocumentErrorCodeGeneric});var u=[n._fileToPalDataFile(s)],l=new i.a("Data","saveDataFile",u);n._defaultProvider.executeServiceOperation(l,t,r).then((function(e){var o=[e,s.fileName,s.mimeType],a=new i.a("Document","openDocumentWithDataID",o);return n._defaultProvider.executeServiceOperation(a,t,r)}),(function(e){a({errorCode:h.a.SaveDataFileErrorOutOfSpace})})).then((function(e){switch(e===S.a.None&&o(),e){case S.a.UnableToFindAnActivity:c.error("File "+Object(O.c)(s.fileName)+" wasn't opened. Unable to find an activity to open the file."),a({errorCode:h.a.NoApplicableAppFound});break;case S.a.UnableToFindTheDataID:a({errorCode:h.a.OpenDocumentErrorCodeUnableToFindTheDataId});break;default:c.error("File "+Object(O.c)(s.fileName)+" wasn't opened. ErrorCode: "+e.toString()),a({errorCode:h.a.OpenDocumentErrorCodeGeneric})}}))}))},e.prototype._pickFileForUrl=function(e,t,r){var n=this._getPickFileOptions(e,r),o=A.a.documentsLibrary,a=[n.allowMultiple,n.fileFilter,o,n.fileSizeLimit],s=new i.a("Multimedia","openFilePickerForUrl",a),c=[];return this._defaultProvider.executeServiceOperation(s,t,r).then((function(e){for(var t=0;t<e.length;t++)c.push(k(e[t]));return c}),(function(e){return E(t,n.fileSizeLimit,e)}))},e.prototype._pickFile=function(e,t,r){var n=this,o=this._getPickFileOptions(e,r),a=[],s=[o.allowMultiple,o.fileSizeLimit],c=new i.a("Multimedia","pickFile",s);return this._defaultProvider.executeServiceOperation(c,t,r).then((function(e){for(var t=0;t<e.length;t++)a.push(n._palDataFileToFile(e[t]));return a}),(function(e){return E(t,o.fileSizeLimit,e)}))},e.prototype._getPickFileOptions=function(e,t){var r;return e.getParameters()&&e.getParameters()[0]&&(r=e.getParameters()[0]),{allowMultiple:!(!r||!(null==r?void 0:r.allowMultipleFiles)),fileSizeLimit:r&&r.maximumAllowedFileSize>0?r.maximumAllowedFileSize:Object(_.x)(t.getState()).maxUploadFileSize,fileFilter:r&&r.accept?[r.accept]:["*"]}},e.prototype._fileToPalDataFile=function(e){var t=new y.a;return t.set_filename(e.fileName),t.set_mimeType(e.mimeType),t.set_fileContents(e.fileContent),e.fileSize&&t.set_size(e.fileSize),t},e.prototype._palDataFileToFile=function(e){var t=e.get_fileContents();return{fileName:e.get_filename(),mimeType:e.get_mimeType(),fileContent:t,fileSize:Math.ceil(t.length*b.a)}},e.getAvailableServiceOperations=function(e){var t=e.willDispatcherBeAvailableFromDevice(C)&&e.willDispatcherBeAvailableFromDevice(F),r=e.willDispatcherBeAvailableFromDevice(x);return t&&r?Object(d.a)(l.d,p.d):t?Object(d.a)(l.d,{openFile:p.d.openFile}):r?Object(d.a)(l.d,{pickFile:p.d.pickFile}):void 0},e}();function E(e,t,r){var n=e.TraceManager.getTracer();switch(r){case v.FilePickerCancelled:return Promise.reject({errorCode:h.a.PluginCancelled});case v.AttachmentTypeBlocked:return Promise.reject({errorCode:h.a.FilePickerErrorAttachmentTypeBlocked});case v.FileSizeBreached:return Promise.reject({errorCode:h.a.FilePickerErrorFileSizeBreached,param:t/1024});case v.FileSizeCannotBeZero:return Promise.reject({errorCode:h.a.FilePickerErrorFileSizeCannotBeZero});case v.GetPhotoFromGalleryFailed:return n.error("File picker get photo from gallery failed. ErrorCode: "+r.toString()),Promise.reject({errorCode:h.a.GetPhotoFromGalleryFailed});case v.ApplicationInSnapView:case v.UnableToOpenFile:default:return n.error("File picker unable to pick file. ErrorCode: "+r.toString()),Promise.reject({errorCode:h.a.FilePickerErrorUnableToOpenFile})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var N,I,U=function(){function e(e){this._defaultProvider=new m(e,new a)}return e.prototype.executeServiceOperation=function(e,t,r){if(navigator.geolocation&&navigator.userAgent&&!/Windows.*MSAppHost/i.test(navigator.userAgent))return new Promise((function(e,t){navigator.geolocation.getCurrentPosition(e,(function(e){t({errorCode:h.a.GetGeoLocationFailed})}),{maximumAge:0})}));var n=e.getParameters().slice(),o=new i.a("CordovaMedia",e.getOperationName(),n);return this._defaultProvider.executeServiceOperation(o,t,r).then((function(e){return JSON.parse(e)}),(function(e){return Promise.reject({errorCode:h.a.GetGeoLocationFailed})}))},e.getAvailableServiceOperations=function(e){return Object(d.a)(l.e,p.e)},e}(),R=((N={})[l.a]={ready:"clientReady",initialized:"clientInitialized",bootError:"clientBootError"},N[l.b]={getBarcodeValue:"scanBarcode"},N[l.c]={getExternalContextProperty:"GetExternalContextProperty",invokeExternalContextAction:"InvokeExternalContextAction"},N[l.d]={openFile:"openFile",pickFile:"pickFile"},N[l.e]={getCurrentPosition:"getCurrentPosition"},N[l.f]={takePicture:"takePictureOnDevice",captureVideo:"captureVideoFromDevice",captureAudio:"captureAudioFromDevice"},N[l.g]={openUri:"openUri",updateBackBehavior:"updateBackBehavior",canOpenUri:"canOpenUri",openAuthPopup:"openAuthPopup",switchApp:"switchApp",navigateBackOutOfApp:"navigateBackOutOfApp"},N[l.i]={authenticate:"authenticate",beginSecureSessionForAuthFlow:"beginSecureSessionForAuthFlow",beginSecureSessionForResource:"beginSecureSessionForResource",beginSecureSessionForResourceWithPrompt:"beginSecureSessionForResourceWithPrompt",signOut:"signOut",reconfigure:"reconfigure",handleAuthError:"handleAuthError"},N[l.h]={exec:"exec",onSyncStart:"onSyncStart",onSyncComplete:"onSyncComplete",onSyncError:"onSyncError"},N),D="CordovaMedia",B="Multimedia",M=function(){function e(e){this._defaultProvider=new m(e,new a)}return e.prototype.executeServiceOperation=function(e,t,r){var n,i=e.getOperationName();switch(e.getParameters()&&e.getParameters()[1]&&(n=e.getParameters()[1]),i){case R[l.f].takePicture:return(null==n?void 0:n.useBinaryReader)?this._captureImageForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r);case R[l.f].captureVideo:return(null==n?void 0:n.useBinaryReader)?this._captureVideoForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r);case R[l.f].captureAudio:return(null==n?void 0:n.useBinaryReader)?this._captureAudioForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r)}return new Promise((function(e,t){t({errorCode:h.a.ServiceAndOperationNotSupported,param:"MediaContentManager"+i})}))},e.prototype._executeCordovaMediaActions=function(e,t,r){var n=this,o=e.getParameters().slice(),a=new i.a(D,e.getOperationName(),o);return this._defaultProvider.executeServiceOperation(a,t,r).then((function(e){return{fileName:e.get_filename(),mimeType:e.get_mimeType(),fileContent:e.get_fileContents(),fileSize:e.get_size()}}),(function(e){return n._handleCordovaPluginError(t,Object(_.x)(r.getState()).maxUploadFileSize,e)}))},e.prototype._captureImageForUrl=function(e,t,r){var n=Object(_.x)(r.getState()).maxUploadFileSize,o=[n],a=new i.a(B,"captureImage",o);return this._defaultProvider.executeServiceOperation(a,t,r).then((function(e){return k(e)}),(function(e){return E(t,n,e)}))},e.prototype._captureVideoForUrl=function(e,t,r){var n=Object(_.x)(r.getState()).maxUploadFileSize,o=[n],a=new i.a(B,"captureVideo",o);return this._defaultProvider.executeServiceOperation(a,t,r).then((function(e){return k(e)}),(function(e){return E(t,n,e)}))},e.prototype._captureAudioForUrl=function(e,t,r){var n=this,o=Object(_.x)(r.getState()).maxUploadFileSize,a=["captureAudioWithFileUrl",{maxUploadFileSize:o}],s=new i.a(D,"captureAudioWithUrlFromDevice",a);return this._defaultProvider.executeServiceOperation(s,t,r).then((function(e){return k(e)}),(function(e){return n._handleCordovaPluginError(t,o,e)}))},e.prototype._handleCordovaPluginError=function(e,t,r){switch(r){case u.PluginCancelled:return Promise.reject({errorCode:h.a.PluginCancelled});case u.FileSizeBreached:return Promise.reject({errorCode:h.a.FilePickerErrorFileSizeBreached,param:t/1024});case u.CameraPluginError:return Promise.reject({errorCode:h.a.CameraCaptureFailed});case u.VideoCapturePluginError:return Promise.reject({errorCode:h.a.VideoCaptureFailed});case u.AudioCapturePluginError:return Promise.reject({errorCode:h.a.AudioCaptureFailed});case u.NoActivityToAudioCapture:return Promise.reject({errorCode:h.a.NoApplicableAppFound});default:return e.TraceManager.getTracer().error("Media content wasn't captured. ErrorCode: "+r.toString()),Promise.reject({errorCode:h.a.GenericError})}},e.getAvailableServiceOperations=function(e){return Object(d.a)(l.f,p.f)},e}(),z=r("TCzx"),L=r("cZkS"),q=r("qC0c"),G="Document",V="Network",W="Navigation",Z={emailProtocol:"mailto:",skypeProtocol:"skype:",oneNoteProtocol:"onenote:",excelProtocol:"ms-excel:",wordProtocol:"ms-word:",powerPointProtocol:"ms-powerpoint:"},H=function(){function e(e){this._bridge=e,this._defaultProvider=new m(e)}return e.prototype.executeServiceOperation=function(e,t,r){var n=e.getOperationName();switch(n){case p.g.openUri.name:return this._openUri(e,t,r);case p.g.updateBackBehavior.name:return this._updateBackBehavior(e,t,r);case p.g.navigateBackOutOfApp.name:return this._navigateBackToHost();case p.g.canOpenUri.name:return this._canOpenUri(e,t,r).then((function(e){return e.canOpenUrl}));case p.g.openAuthPopup.name:return this._openAuthPopup(e,t,r);case p.g.switchApp.name:return this._switchApp(e,t,r);default:return Promise.reject({errorCode:h.a.ServiceAndOperationNotSupported,param:"NavigationManager."+n})}},e.prototype._openUri=function(e,t,r){var n=this,o=e.getParameters().slice()[0];return this._canOpenUri(e,t,r).then((function(a){if(a.canOpenUrl&&!a.external){var s=new i.a(V,"openUrl",[o]);return n._defaultProvider.executeServiceOperation(s,t,r)}return n._openExternalUrl(e,t,r)}),(function(e){return t.TraceManager.getTracer().error("CanOpenUrl failed for input URL "+o),Promise.reject({errorCode:h.a.GenericError})}))},e.prototype._updateBackBehavior=function(e,t,r){var n=this;return new Promise((function(o,a){var s=e.getParameters().slice()[0],c=new i.a(W,p.g.updateBackBehavior.name,[s]);n._execute(c,t,r),o()}))},e.prototype._navigateBackToHost=function(){var e=this._bridge.get_device();return e.get_IsAvailable()&&e.postMessage(JSON.stringify({name:"navigateBackToHost"})),Promise.resolve({status:0,pageId:null})},e.prototype._canOpenUri=function(e,t,r){var n=this;return new Promise((function(o,a){if(Object(q.c)(r.getState(),L.Hc))o({canOpenUrl:!0,external:!n._bridge.willDispatcherBeAvailableFromDevice(V)});else{var s=e.getParameters().slice()[0],c=z.a.getInstance();if(!s)return t.TraceManager.getTracer().error("Parameter url is null or undefined."),a({errorCode:h.a.GenericError});if(n._isProtocolWellKnown(s)&&(c.get_IsAndroid()||c.get_IsIOS())){var u=new i.a(V,"canOpenUrl",[s]);n._execute(u,t,r).then((function(e){o({canOpenUrl:e,external:!1})}),(function(){a({errorCode:h.a.GenericError})}))}else o({canOpenUrl:!0,external:!0})}}))},e.prototype._openAuthPopup=function(e,t,r){var n=this;return new Promise((function(o,a){var s=e.getParameters().slice()[0];if(!s)return t.TraceManager.getTracer().error("Parameter url is null or undefined."),a({errorCode:h.a.GenericError});var c=new i.a(V,"openAuthPopup",[s,function(e){o(e)}]);n._execute(c,t,r)}))},e.prototype._isProtocolWellKnown=function(e){for(var t in Z)if(e.startsWith(Z[t]))return!0;return!1},e.prototype._openExternalUrl=function(e,t,r){var n=e.getParameters().slice(),o=new i.a(G,"openExternalUrl",n);return this._execute(o,t,r)},e.prototype._switchApp=function(e,t,r){var n=e.getParameters().slice(),o=new i.a(W,e.getOperationName(),n);return this._execute(o,t,r)},e.prototype._execute=function(e,t,r){return this._defaultProvider.executeServiceOperation(e,t,r)},e.getAvailableServiceOperations=function(e){var t=z.a.getInstance(),r=t.get_IsAndroid()||t.get_IsIOS()?e.willDispatcherBeAvailableFromDevice(V)&&e.willDispatcherBeAvailableFromDevice(G):e.willDispatcherBeAvailableFromDevice(G),i=e.willDispatcherBeAvailableFromDevice(W),o=Object(n.__assign)({},p.g);r||(delete o.openUri,delete o.canOpenUri),i||delete o.updateBackBehavior;var a=e.get_application().get_applicationState();return a.get_hasAppList()||delete o.switchApp,a.get_canNavigateBackToHost()||delete o.navigateBackOutOfApp,Object(d.a)(l.g,o)},e}(),J=r("/j9Z"),K=r("GUnN"),Q=function(){function e(e){this._defaultProvider=new m(e)}return e.prototype.executeServiceOperation=function(e,t,r){var n=e.getOperationName(),i=R[l.a];switch(n){case i[p.a.bootError.name]:return this._bootError(e,t,r);case i[p.a.initialized.name]:case i[p.a.ready.name]:return this._defaultProvider.executeServiceOperation(e,t,r)}return new Promise((function(e,t){t({errorCode:h.a.ServiceAndOperationNotSupported,param:"Application."+n})}))},e.prototype._bootError=function(e,t,r){var n=e.getParameters().slice(),o=n[1],a=o.innerError?o.innerError.errorCode:null;t.TraceManager.getTracer("Boot.ShimError").error("Boot failed with error. ErrorMessage: "+o.message+" ErrorCode: "+o.errorCode+" InnerErrorCode: "+a+" Details: "+Object(K.e)(o));var s=o||new J.a("Error_Message_Generic_Mobile_Client");return 0!==s.errorCode&&"function"==typeof s.getNegativeErrorCode?s.errorCode=s.getNegativeErrorCode():s.innerError&&s.innerError.errorCode&&"function"==typeof s.innerError.getNegativeErrorCode&&(s.errorCode=s.innerError.getNegativeErrorCode()),(s=0===s.errorCode?new J.a("Error_Message_Generic_Mobile_Client"):s).errorCode||(s.errorCode=0),n[1]=Object(J.f)(s),e=new i.a(l.a,R[l.a][p.a.bootError.name],n),this._defaultProvider.executeServiceOperation(e,t,r)},e.getAvailableServiceOperations=function(e){if(e.dispatchers[l.a].get_IsAvailable())return Object(d.a)(l.a,p.a)},e}();!function(e){e[e.Success=0]="Success",e[e.UnexpectedError=1]="UnexpectedError",e[e.AuthorityNotFound=2]="AuthorityNotFound",e[e.InvalidResource=3]="InvalidResource",e[e.InvalidDomain=4]="InvalidDomain",e[e.UnsupportedPlatform=5]="UnsupportedPlatform",e[e.FeatureDisabled=6]="FeatureDisabled",e[e.InvalidOrigin=7]="InvalidOrigin"}(I||(I={}));var X=r("eczc"),Y=r("eRQ2"),$=r("4pqm"),ee=r("en4/"),te=r("FCSV"),re=r("6BA3"),ne=r("7EJx"),ie=function(){function e(e,t){this._defaultProvider=new m(e),this._tokenProvider=t}return e.prototype.executeServiceOperation=function(e,t,r){var n=e.getOperationName();switch(n){case p.i.authenticate.name:return this._authenticate(e,t,r);case p.i.beginSecureSessionForAuthFlow.name:return this._beginSecureSessionForAuthFlow(e,t,r,n);case p.i.beginSecureSessionForResource.name:return this._beginSecureSession(t,r,n,e.getParameters(),(function(e){return Object(q.d)(r.getState(),"MobileClientBeginSecureSessionForResource")?h.a.BeginSecureSessionSilentFailed:e}));case p.i.beginSecureSessionForResourceWithPrompt.name:return this._beginSecureSession(t,r,n,e.getParameters());case p.i.signOut.name:return this._signOut(t,r);case p.i.reconfigure.name:return this._reconfigure(t,r);case p.i.handleAuthError.name:return this._handleAuthError(t,r)}return new Promise((function(e,t){t({errorCode:h.a.ServiceAndOperationNotSupported,param:"UserAccount."+n})}))},e.prototype._authenticate=function(e,t,r){var n=this;Object(Y.a)("CrmNativeAuth",Object($.b)().substr(Object($.b)().indexOf(".")));var i=e.getParameters(),o=i&&i[0],a=this._tokenProvider.retrieveAuthToken(o);return a.then((function(){n._setupCookie(t,r)})),a},e.prototype._handleAuthError=function(e,t){var r=new i.a(l.i,p.i.authenticate.name,[!0]);return this._authenticate(r,e,t)},e.prototype._beginSecureSessionForAuthFlow=function(e,t,r,n){var i=e.getParameters(),o=i[0];for(var a in o)void 0===o[a]&&(o[a]=null);return i[0]=new te.a(o),this._beginSecureSession(t,r,n,i)},e.prototype._beginSecureSession=function(e,t,r,o,a){var s=this;return new Promise((function(c,u){var p=new i.a(l.i,r,Object(n.__spreadArrays)(o,[function(t,n){if(t===I.Success)c(new Date(n));else{e.TraceManager.getTracer("Authentication").error(r+" error, ErrorCode: "+t+", ErrorInfo: "+s._getErrorInfo(t));var i=a?a(t):t;u({errorCode:i})}}]));s._defaultProvider.executeServiceOperation(p,e,t)}))},e.prototype._signOut=function(e,t){var r=this;return new Promise((function(n,o){var a=[];a.push(r._clearAuthCookie(e,t)),a.push(ee.a.get_DefaultInstance().clearAllData()),a.push(ee.a.get_DefaultInstance().updateSecureContext()),Promise.all(a).then((function(){r._tokenProvider.clearAuthToken();var o=new i.a(l.i,p.i.signOut.name);r._defaultProvider.executeServiceOperation(o,e,t),n()}),(function(t){e.TraceManager.getTracer("SignOut").error("Signout failed, errorDetail: "+t.toString()),o({errorCode:-2147093993})}))}))},e.prototype._reconfigure=function(e,t){var r=this;return new Promise((function(n,o){var a=[];a.push(r._clearAuthCookie(e,t)),a.push(ee.a.get_DefaultInstance().clearAllData()),a.push(ee.a.get_DefaultInstance().clearAllMetadata()),Promise.all(a).then((function(){r._tokenProvider.clearAuthToken();var o=new i.a(l.i,p.i.reconfigure.name);r._defaultProvider.executeServiceOperation(o,e,t),n()}),(function(t){e.TraceManager.getTracer("Reconfigure").error("Reconfigure failed, errorDetail: "+t.toString()),o({errorCode:-2147093993})}))}))},e.prototype._getErrorInfo=function(e){var t;switch(e){case I.AuthorityNotFound:t="The request failed as there is no oAuth authority in this session.";case I.InvalidResource:t="The session was requested for an unsupported resource.";case I.InvalidDomain:t="The session was requested for an unsupported domain.";case I.UnsupportedPlatform:t="The session was requested on an unsupported platform like ISH.";case I.FeatureDisabled:t="The app is running on a shim that doesnt support authenticated mashups";case I.UnexpectedError:default:t="The request failed due to unknown reasons."}return t},e.prototype._setupCookie=function(e,t){var r;if(Object(ne.w)(t.getState()).isLive){var n=re.c.ACTION,i={endpoint:"/nativewebsession/new",method:"POST",urlParameters:"",additionalParameters:(r={},r[re.a.TYPE]=n,r[re.a.SUB_TYPE]="SetupCookie",r)};t.dispatch(Object(X.a)(i)).catch((function(t){e.EventManager.ReportComponentFailure("Authentication.NativeWebSession.New",t)}))}else this._tokenProvider.setupCookieForOnPrem()},e.prototype._clearAuthCookie=function(e,t){return t.dispatch(Object(X.a)({endpoint:"/nativewebsession/end",method:"POST",urlParameters:""})).catch((function(t){e.EventManager.ReportComponentFailure("Authentication.NativeWebSession.End",t),Object(Y.a)("CrmNativeAuth",Object($.b)().substr(Object($.b)().indexOf(".")))}))},e.getAvailableServiceOperations=function(e,t){var r=e.dispatchers[l.i],i=Object(q.d)(t.getState(),"MobileClientBeginSecureSessionForResource");if(r.get_IsAvailable()){var o=p.i;return i||delete(o=Object(n.__assign)({},p.i)).beginSecureSessionForResource,Object(q.d)(t.getState(),"MobileClientBeginSecureSessionForAuthFlow")||delete(o=Object(n.__assign)({},p.i)).beginSecureSessionForAuthFlow,Object(d.a)(l.i,o)}},e}(),oe=r("ItJr");var ae=r("/N8J");var se={propertyName:"NativeFCBContext",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ae.b)(e[t]))}},ce=r("reTw");var ue={propertyName:"version",dispatcherName:"Application",handler:function(e,t,r){var n=e.get_version(),i=e.get_build(),o=e.get_revision(),a=e.get_nativeRevision(),s=e.get_osVersion();r.dispatch(Object(ce.l)(n,i,o,a,s))}};var le={propertyName:"installationId",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ce.i)(e.get_installationId()))}};var pe={propertyName:"deviceModel",dispatcherName:"Device",handler:function(e,t,r){r.dispatch(Object(ce.h)(e.get_deviceModel()))}},de=r("rpa8");var he={propertyName:"AppId",dispatcherName:"Application",handler:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r){r.dispatch(Object(de.b)(e[t]))}};var fe={propertyName:"TelemetryEventsParams",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ce.k)(e.get_telemetryEventsParams()))}},me=r("Zv3m");function ve(e){return function(t,r,n){return e(t[r],n)}}var ge={propertyName:"AvailableExternalContexts",dispatcherName:"ExternalContext",handler:ve((function(e,t){e&&t.dispatch(Object(me.i)(e.reduce((function(e,t){var r;return Object.assign(e,((r={})[t.id]=t,r))}),{})))}))};var _e={propertyName:"KnownProperties",dispatcherName:"ExternalContext",handler:ve((function(e,t){t.dispatch(Object(me.g)(e))}))},be=r("CMWz");var ye={propertyName:"KnownPropertyUpdate",dispatcherName:"ExternalContext",handler:ve((function(e,t){if(e&&e.contextId&&e.propertyId){t.dispatch(Object(me.j)(e));var r=Object(be.b)(t.getState(),e.contextId,e.propertyId);r&&Array.isArray(r)&&r.forEach((function(t){return t(e.value)}))}}))},Se=r("xile");function Oe(e,t,r){r.dispatch(Object(Se.b)(t,e[t]))}var ke,we={propertyName:"CameraAvailable",dispatcherName:"Device",handler:Oe},Te={propertyName:"MicrophoneAvailable",dispatcherName:"Device",handler:Oe},Pe={propertyName:"GeolocationAvailable",dispatcherName:"Device",handler:Oe},Ae=r("TbJz"),Ce=r("1FZ7"),Fe={dispatcherName:"Cordova",transformers:{FilesDownloadStatus:function(e){if(!e||"string"!=typeof e)return null;try{return{filesDownloadStatus:JSON.parse(e)}}catch(e){return null}}}},xe=((ke={})[Ce.b]=Fe,ke[Ce.a]={dispatcherName:"Network",transformers:{BaseUrlForTemporaryData:null,BaseUrlForEntityData:null,BaseUrlForAppHost:null}},ke);var je,Ee=Object(n.__spreadArrays)([se,ue,le,pe,he,fe,ge,_e,ye,we,Te,Pe],(je=[],Object.entries(xe).forEach((function(e){var t=e[0],r=e[1];Object.entries(r.transformers).forEach((function(e){var n=e[0],i=e[1];je.push(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,n){return{propertyName:e,dispatcherName:t,handler:function(t,i,o){var a,s=t[i],c=n?n(s):((a={})[e]=s,a);null!==c&&o.dispatch(Object(Ae.b)(r,c))}}}(n,r.dispatcherName,t,i))}))})),je)),Ne=r("zk4A");var Ie={eventName:"OnBackButtonPressed",dispatcherName:"Navigation",handler:function(e,t){t.dispatch(Object(Ne.a)())}},Ue=r("UchK");function Re(){return{type:"router.reset.async",execute:function(e,t){var r=e.dispatch;e.getState;return r({type:"router.reset.async",execute:function(e,t){var r=e.dispatch;return e.getState,t.Router.getHistoryManager().ClearHistory(),r(Object(Ue.a)())}})}}}var De={eventName:"OnRouterReset",dispatcherName:"Navigation",handler:function(e,t){t.dispatch(Re())}},Be=r("91HD"),Me=r("PpnT");var ze={eventName:"OnNativeApplicationEventsReceived",dispatcherName:"Logging",handler:function(e,t){Object(Be.a)()&&Object(Me.f)(e)}},Le=r("7s2e");var qe,Ge=[Ie,De,ze,{eventName:"ReportPerformance",dispatcherName:"Application",handler:function(e,t){Object(Le.a)({},[e])}}],Ve=r("sgtG"),We=r("swEE"),Ze=r("0u+G"),He=r("CcDq");!function(e){e[e.CloseShim=0]="CloseShim",e[e.CallAppCode=1]="CallAppCode"}(qe||(qe={}));var Je=r("yZTI"),Ke=r("Z1aD"),Qe=r("JPDs"),Xe=r("LAqF"),Ye=r("Kgz2"),$e=r("A7M3"),et=r("JlqV"),tt=r("n3Go"),rt=r("+Iuh"),nt=function(){function e(){this._authToken=null,this._securityTokenResponse=null,this._tokenExpiry=null,this._objectId=null,this._tenantId=null}return e.prototype.get_authToken=function(){return this._authToken},e.prototype.set_authToken=function(e){return this._authToken=e,e},e.prototype.get_securityTokenResponse=function(){return this._securityTokenResponse},e.prototype.set_securityTokenResponse=function(e){return this._securityTokenResponse=e,e},e.prototype.get_tokenExpiryUtcTime=function(){return this._tokenExpiry},e.prototype.set_tokenExpiryUtcTime=function(e){return this._tokenExpiry=e,e},e.prototype.get_objectId=function(){return this._objectId},e.prototype.set_objectId=function(e){return this._objectId=e,e},e.prototype.get_tenantId=function(){return this._tenantId},e.prototype.set_tenantId=function(e){return this._tenantId=e,e},e}(),it=r("Wn9Y"),ot=r("WS0f"),at=r("9MHR"),st=function(e){function t(t){var r=e.call(this)||this;return r._ParseTokenAndInitializeObject(t),r}return Object(n.__extends)(t,e),t.prototype._ParseTokenAndInitializeObject=function(e){var t=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/AccessToken");this.set_authToken(t.get_innerText());var r=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/ExpiresOn").get_innerText();if(isNaN(r))this.set_tokenExpiryUtcTime(new Date(r)),Object(it.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",at.a.authentication,"Create expiry time object from UTC datetime string: "+r);else{var n=parseInt(r,10);this.set_tokenExpiryUtcTime(new Date(n)),Object(it.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",at.a.authentication,"Create expiry time object from ticks: "+r)}try{var i=this.get_authToken().split(".")[1].replace(new RegExp("-","g"),"+").replace(new RegExp("_","g"),"/"),o=JSON.parse(window.atob(i)),a=o.exp,s=new Date(1e3*parseInt(a,10));Object(ot.a)(this.get_tokenExpiryUtcTime())||"Invalid Date"===this.get_tokenExpiryUtcTime().toString()?(Object(it.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",at.a.authentication,"Token expiry time parsed to invalid date. ExpiryTimeString: "+r+"ExpiryTimeFromTicks: "+s),this.set_tokenExpiryUtcTime(s)):Math.abs(this.get_tokenExpiryUtcTime().getTime()-s.getTime())>2e3&&Object(it.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",at.a.authentication,"Token expiry time calculated from ticks not equal to token expiry time sent from shim. ExpiryTimeString: "+r+" TokenExpiryUtcTime: "+this.get_tokenExpiryUtcTime()+" TokenExpiryFromTicks: "+s);var c=o.oid||"";this.set_objectId(c);var u=o.tid||"";this.set_tenantId(u),this._setSecurityTokenResponse(e)}catch(e){Object(it.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",at.a.authentication,"Failed to extract expiry time or Ids from decoding auth token: "+e.message)}},t.prototype._setSecurityTokenResponse=function(e){var t=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/EncodedAccessToken").get_innerText();this.set_securityTokenResponse('<t:RequestSecurityTokenResponse xmlns:t="http://schemas.xmlsoap.org/ws/2005/02/trust">\n\t\t\t<t:Lifetime>\n\t\t\t<wsu:Created xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">2013-05-21T00:58:40.544Z</wsu:Created>\n\t\t\t<wsu:Expires xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">2013-05-22T00:58:40.544Z</wsu:Expires>\n\t\t\t</t:Lifetime>\n\t\t\t<wsp:AppliesTo xmlns:wsp=""http://schemas.xmlsoap.org/ws/2004/09/policy"">\n\t\t\t<EndpointReference xmlns=""http://www.w3.org/2005/08/addressing"">\n\t\t\t<Address>https://kevinwhi9852org2.crm.crmlivetoday.com/</Address>\n\t\t\t</EndpointReference>\n\t\t\t</wsp:AppliesTo>\n\t\t\t<t:RequestedSecurityToken>\n\t\t\t<wsse:BinarySecurityToken wsu:Id=""_febfbc5a-99cf-4298-ae6f-7d752db4cb24-FECE4032DF73C0855F4B4BA9EAEB9E47"" ValueType=""urn:ietf:params:oauth:token-type:jwt"" EncodingType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"">'+t+"</wsse:BinarySecurityToken>\n\t\t\t</t:RequestedSecurityToken>\n\t\t\t<t:TokenType>urn:ietf:params:oauth:token-type:jwt</t:TokenType>\n\t\t\t<t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>\n\t\t\t<t:KeyType>http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey</t:KeyType>\n\t\t\t</t:RequestSecurityTokenResponse>")},t}(nt),ct=function(e){function t(t){var r=e.call(this)||this;return r._ParseTokenAndInitializeObject(t),r}return Object(n.__extends)(t,e),t.prototype._ParseTokenAndInitializeObject=function(e){var t=!0;e.addNamespace("t","http://schemas.xmlsoap.org/ws/2005/02/trust"),e.addNamespace("wsu","http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"),e.addNamespace("xenc","http://www.w3.org/2001/04/xmlenc#"),e.addNamespace("wsp","http://schemas.xmlsoap.org/ws/2004/09/policy"),e.addNamespace("wsa","http://www.w3.org/2005/08/addressing");var r=e.selectSingleNode("/t:RequestSecurityTokenResponse/wsp:AppliesTo/wsa:EndpointReference/wsa:Address");r&&-1===r.get_innerText().indexOf("urn:")||(t=!1);var n=e.selectSingleNode("/t:RequestSecurityTokenResponse");this.set_securityTokenResponse(n.get_outerXml());var i,o=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken");if(this.set_authToken(o.childNodes().get_item(0).get_outerXml()),t){if(this.set_tokenExpiryUtcTime(new Date),i=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:Lifetime")){var a=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:Lifetime/wsu:Expires").get_innerText();if(!Object(ot.b)(a))if(isNaN(a))this.set_tokenExpiryUtcTime(new Date(a));else{var s=parseInt(a,10);this.set_tokenExpiryUtcTime(new Date(s))}}}else if(e.addNamespace("saml","urn:oasis:names:tc:SAML:1.0:assertion"),i=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken/saml:Assertion/saml:Conditions")){a=i.getAttribute("NotOnOrAfter").toString();Object(ot.b)(a)||this.set_tokenExpiryUtcTime(new Date(a))}},t}(nt);var ut=r("r0s4"),lt=function(){function e(e,t){this._tokenExpiryWindow=6e4,this._tokenExpiryTimer=-1,this._store=e,this._authInProgress=!1,this._tokenRetrievedCallbacks=[],this._tracer=t.TraceManager.getTracer("TokenProvider"),window.onOnPremCookieAvailable=this._onOnPremCookieAvailable.bind(this)}return Object.defineProperty(e.prototype,"_tokenTimeout",{get:function(){return this._tokenExpiry.valueOf()-(new Date).valueOf()-this._tokenExpiryWindow},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenExpired",{get:function(){return this._tokenTimeout<0},enumerable:!1,configurable:!0}),e.prototype.retrieveAuthToken=function(e){return void 0===e&&(e=!1),this._retrieveAuthTokenFromShim(e)},e.prototype.clearAuthToken=function(){this._authToken=null,this._store.dispatch(Object($e.d)(null))},e.prototype.setupCookieForOnPrem=function(){var e=this,t=Object($.b)();document.getElementById("authToken").setAttribute("value",this._securityTokenResponse),document.getElementById("wctx").setAttribute("value","ru="+Object(ut.CrmUrlEncode)(t)+"/nga/main.aspx");var r=document.getElementById("authForm");r.action=t,window.clearTimeout(this._cookieTimeoutTimer),this._cookieTimeoutTimer=window.setTimeout((function(){e._tracer.error("On prem cookie setup, using legacy endpoint failed"),Object(it.b)("OnPrem_CookieSetup",at.a.authentication,"Legacy cookie setup for onprem org timed out")}),6e4),r.submit()},e.prototype._onOnPremCookieAvailable=function(){window.clearTimeout(this._cookieTimeoutTimer),Object(it.c)("OnPrem_CookieSetup",at.a.authentication,"Legacy cookie setup for onprem org successful")},e.prototype._retrieveAuthTokenFromShim=function(e){var t=this;if(this._authToken&&!this.tokenExpired&&!e)return Promise.resolve(!0);this._authToken=null,clearTimeout(this._tokenExpiryTimer);var r=new Promise((function(e,r){t._tokenRetrievedCallbacks.push({successCallback:e,failureCallback:r})}));return this._authInProgress||(this._authInProgress=!0,Xe.a.get_Instance().get_account().requestSecurityToken(e,this._parseSecurityTokenResponse.bind(this))),r},e.prototype._parseSecurityTokenResponse=function(e,t,r,n,i){this._parseSecurityTokenResponseInternal(e,{authResultStatus:t,errorCode:r,errorDescription:n},i)},e.prototype._parseSecurityTokenResponseInternal=function(e,t,r){var n=this;if(this._authInProgress=!1,this._isErrorResponse(e))this._handleFailure(t);else{var i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e=Object(tt.c)(e,"");var t=Object(rt.b)(e),r=Object(rt.a)(t);return r.selectSingleNode("/RequestOAuthSecurityTokenResponse/AccessToken")?new st(r):new ct(r)}(e);this._authToken=i.get_authToken(),this._tokenExpiry=i.get_tokenExpiryUtcTime();var o=i.get_objectId(),a=i.get_tenantId();this._securityTokenResponse=i.get_securityTokenResponse(),this._tokenExpiryTimer=window.setTimeout((function(){Object(et.b)(n._store.getState())&&n.retrieveAuthToken(!0)}),this._tokenTimeout),this._handleSuccess(o,a,r)}},e.prototype._isErrorResponse=function(e){return"AuthError"===e},e.prototype._handleFailure=function(e){var t=[];e&&t.push({name:"description",value:e.errorDescription}),e&&t.push({name:"resultStatus",value:e.authResultStatus}),e&&t.push({name:"code",value:e.errorCode}),this._tracer.error("Token retrival failure",t);var r=0===e.authResultStatus?2147873354:2147873353,n=new J.a(e.errorDescription,r);this._tokenRetrievedCallbacks.forEach((function(e){e.failureCallback&&e.failureCallback(n)})),this._tokenRetrievedCallbacks=[]},e.prototype._handleSuccess=function(e,t,r){this._store.dispatch(Object($e.d)(this._authToken)),this._store.dispatch(Object($e.e)(e)),this._store.dispatch(Object($e.f)(t)),this._tokenRetrievedCallbacks.forEach((function(e){e.successCallback&&e.successCallback(r)})),this._tokenRetrievedCallbacks=[]},e}(),pt=r("aQwt"),dt=r("GDI2"),ht=r("ZVHh"),ft=r("Ff8i"),mt=r("q+pN"),vt=r("xc1f"),gt=r("06Eo"),_t=r("U5ei"),bt=r("9r0m"),yt=r("k78Z"),St=r("a/Ab");function Ot(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,c,u,l,p;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:switch(i=JSON.parse(e),o=i.operation,a=i.payload,o){case"getRecentItems":s=function(e){var t={ok:!0,payload:Object(ft.h)(e.getState())};return Promise.resolve(t)}(t);break;case"getSiteMap":s=function(e){var t={ok:!0,payload:Object(dt.a)(e.getState())};return Promise.resolve(t)}(t);break;case"getSupportedVersions":s=Promise.resolve({ok:!0,payload:["1.0.0"]});break;case"lookup":s=function(e,t){var r=e.entityTypes;if(!r||!r.length)return Promise.reject(new Error("No entityTypes specified for lookup"));var n=Object(Je.c)(t.getState());return Object(gt.a)(e,n,t.dispatch).then((function(e){return{ok:!0,payload:e}}))}(a,t);break;case"openSettings":s=function(e){return e.dispatch(Object(_t.d)(St.e)),Promise.resolve({ok:!0})}(t);break;case"openUserProfile":s=function(e){return e.dispatch(Object(_t.d)(St.c)),Promise.resolve({ok:!0})}(t);break;case"navigateToEntity":c=a.entityName,u=a.entityId,s=function(e,t,r){var n={entityTypeName:e,id:new bt.a(t)};return r.dispatch(Object(Ke.a)(vt.a,n,void 0,{replaceState:!0})).then((function(e){return 0!==e.status?kt(e.error):{ok:!0}}))}(c,u,t);break;case"navigateToRecentItem":s=function(e,t){return t.dispatch(Object(ht.d)(e,!1,null,{replaceState:!0})).then((function(e){return 0!==e.status?kt(e.error):{ok:!0}}))}(a,t);break;case"navigateToSiteMapItem":s=function(e,t){return t.dispatch(Object(ht.c)(e,!1,null,{replaceState:!0})).then((function(e){return 0!==e.status?kt(e.error):{ok:!0}}))}(a,t);break;case"pinRecentItem":s=function(e,t){return t.dispatch(Object(mt.c)(e)),Promise.resolve({ok:!0})}(a,t);break;case"unpinRecentItem":s=function(e,t){return t.dispatch(Object(mt.d)(e)),Promise.resolve({ok:!0})}(a,t);break;case"getOfflineProfileStatus":s=function(e){var t={ok:!0,payload:Object(yt.a)(e.getState())};return Promise.resolve(t)}(t);break;default:s=Promise.resolve({ok:!1,errorMessage:"Unrecognized shell API operation: "+o})}n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s];case 2:return l=n.sent(),wt(o,l,i.requestId,r),[3,4];case 3:return p=n.sent(),wt(o,kt(p),i.requestId,r),[3,4];case 4:return[2]}}))}))}function kt(e){var t=e.displayTitle?e.displayTitle+". ":"";return(t+=e.displayMessage||"")||(t=e.message+": "+e.stack),{ok:!1,errorMessage:t}}function wt(e,t,r,n){var i=n.get_device(),o=i.get_IsAvailable(),a=t.ok,s=t.errorMessage,c=t.payload;if(o){var u={name:"shellApiResponse",version:"1.0.0",operation:e,requestId:r,ok:a,errorMessage:s,payload:c};i.postMessage(JSON.stringify(u))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Tt=function(){function e(e,t,r){void 0===r&&(r=!1),this._bridge=Xe.a.get_Instance(),r&&z.a.getInstance().get_IsIOS()&&this._bridge.forceDeviceReady(),this._dispatcherMethodNames=R,this._tokenProvider=new lt(t,e)}return Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!1,configurable:!0}),e.prototype.executeServiceOperation=function(e,t,r){var n=e.getServiceName(),o=e.getOperationName(),a=e.getParameters().slice(),s=this._dispatcherMethodNames[n];if(!s)return Promise.reject({errorCode:h.a.ServiceNotSupported,param:n});var c=s[o];if(!c)return Promise.reject({errorCode:h.a.ServiceAndOperationNotSupported,param:n+"."+o});var u=new i.a(n,c,a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
return function(e,t,r){switch(e.getServiceName()){case l.i:return new ie(t,r.tokenProvider);case l.b:return new g(t);case l.d:return new j(t);case l.e:return new U(t);case l.f:return new M(t);case l.g:return new H(t);case l.a:return new Q(t);default:return new m(t)}}(e,this._bridge,this).executeServiceOperation(u,t,r)},e.prototype.addOnPlatformReady=function(e,t,r){var i=this,o=this._bridge;this._bridge.add_onReadyOrNow((function(){return Object(n.__awaiter)(i,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r.dispatch(Object(Ve.d)(Ze.b.Native)),r.dispatch(Object(ce.j)(this._getClientHostSubtype(t))),[4,this._subscribeToCustomEvents(o,r)];case 1:return n.sent(),[4,this._subscribeToPropertyChanged(o,r)];case 2:return n.sent(),this._subscribeToStateChanged(o,r),this._subscribeToBackButtonRouterEvent(t,r),this._subscribeToAppLinkChanged(o,r),this._subscribeToShellApiRequests(o,r),function(e,t,r){var n=[];for(var i in f)n.push(m.getAvailableServiceOperations(e,i));n.push(ie.getAvailableServiceOperations(e,r)),n.push(g.getAvailableServiceOperations(e)),n.push(j.getAvailableServiceOperations(e)),n.push(U.getAvailableServiceOperations(e)),n.push(M.getAvailableServiceOperations(e)),n.push(H.getAvailableServiceOperations(e)),n.push(Q.getAvailableServiceOperations(e));for(var o={},a=0;a<n.length;a++){var s=n[a];s&&(o[s.name]=s)}r.dispatch(Object(oe.b)(o))}(o,0,r),e(),[2]}}))}))}))},e.prototype._getClientHostSubtype=function(e){var t=Object(Qe.a)();switch(t){case Ye.a.Phone:return We.a.Phone;case Ye.a.Slate:case Ye.a.MailApp:return We.a.Tablet;default:return e.TraceManager.getTracer().error("Failed to initialize client host subtype: "+t),We.a.Tablet}},e.prototype._subscribeToPropertyChanged=function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(n.__generator)(this,(function(o){switch(o.label){case 0:"apcl",r=function(r){var i,o,a;return Object(n.__generator)(this,(function(c){switch(c.label){case 0:return i=Ee[r],(o=function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(r=s(e,t))?[4,r]:[3,2];case 1:if(i=n.sent(),(a=i[o="get_"+t+"State"])||(o="get_"+t.charAt(0).toLowerCase()+t.substring(1)+"State",a=i[o]),a)return[2,a.call(i)];n.label=2;case 2:return[2,null]}}))}))}(e,i.dispatcherName))?[4,o]:[3,2];case 1:a=c.sent(),a.apcl.call(a,i.propertyName,(function(e,r){return i.handler(e,r,t)})),i.handler(a,i.propertyName,t),c.label=2;case 2:return[2]}}))},i=0,o.label=1;case 1:return i<Ee.length?[5,r(i)]:[3,4];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype._subscribeToCustomEvents=function(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,i;return Object(n.__generator)(this,(function(o){switch(o.label){case 0:"addCustomEventHandler",r=function(r){var i,o,a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(o=s(e,(i=Ge[r]).dispatcherName))?[4,o]:[3,2];case 1:a=n.sent(),a.addCustomEventHandler.call(a,i.eventName,(function(e){return i.handler(e,t)})),n.label=2;case 2:return[2]}}))},i=0,o.label=1;case 1:return i<Ge.length?[5,r(i)]:[3,4];case 2:o.sent(),o.label=3;case 3:return i++,[3,1];case 4:return[2]}}))}))},e.prototype._subscribeToStateChanged=function(e,t){e.add_onActive((function(){t.dispatch(Object(Ve.c)(Ze.a.Active))}));e.add_onInactive((function(){t.dispatch(Object(Ve.c)(Ze.a.Inactive))}))},e.prototype._subscribeToAppLinkChanged=function(e,t){e.add_onAppLink((function(e){var r=Object(Je.a)(t.getState());"#"===r.slice(-1)&&(r=r.slice(0,-1)),t.dispatch(Object(Ke.a)(r+e))}))},e.prototype._subscribeToBackButtonRouterEvent=function(e,t){document.addEventListener("routerBackButtonChanged",(function(){var r=new He.a(e,t);r.isOperationAvailable("updateBackBehavior")&&(Object(pt.b)(t.getState())?r.updateBackBehavior(qe.CallAppCode):r.updateBackBehavior(qe.CloseShim))}),!1)},e.prototype._subscribeToShellApiRequests=function(e,t){e.add_onShellApiRequest((function(r){Ot(r,t,e)}))},e.prototype.setDispatcherMethodNames=function(e){this._dispatcherMethodNames=e},e}()}}]),window.bundleExecutionMarkers["scripts/es5/nativeplatform.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();