(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/dashboardpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[57],{"+6eZ":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){var t="";try{t=JSON.stringify(e)}catch(e){}return t}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},"+P1Q":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("c/eZ"),a=r("gk6Q"),i=r("YCDx"),o=r("QAhb"),s=r("n1Ju"),c=function(e,t,r,n){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:r},{name:"Title",value:n}]},l=r("IiPO"),u=r("+Z9T"),d=r("HSdq"),p=r("F2uj"),h=r("c7nC"),g=r("9r0m"),m=r("H9Ho"),f=r("kvLG");var b,v=r("ezfI"),y=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._entityAttribute=null,b=t,s.registerObserversForControlStateChange(),s}return Object(n.__extends)(t,e),t.prototype.getAttribute=function(){var e="ClientApi.XrmDataControl.getAttribute";try{if(v.a.instance.reportCall(e),!this._entityAttribute){var t=void 0;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{var r=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=r.get(this.controlDescriptor.DataFieldName)}}return v.a.instance.reportSuccess(e),this._entityAttribute}catch(t){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.updateAttribute=function(e,t){var r="ClientApi.XrmDataControl.updateAttribute";try{if(v.a.instance.reportCall(r),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;var n=e.attributes;n&&(this._entityAttribute=n.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),v.a.instance.reportSuccess(r)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype.addNotification=function(e){var t="ClientApi.XrmDataControl.addNotification";try{if(v.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){var r={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):b.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),b.dispatch(Object(s.b)(this.pageId,this.getName(),r,this.contextToken)),v.a.instance.reportSuccess(t),!0}return v.a.instance.reportSuccess(t),!1}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype._clearControlNotification=function(e){var t=this,r=Object(d.A)(b.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(r){var n=Object.keys(r),a=null;if(e){if(!((a=r[e])&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(u.a)(e)||0===e.trim().length)&&n.forEach((function(e){a=r[e],t._clearNotification(a)}));return!0}return!1},t.prototype._clearNotification=function(e){e.actions=null,e.messages=null,e.notificationLevel=null,b.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))},t.prototype.clearNotification=function(e){var t="ClientApi.XrmDataControl.clearNotification";try{v.a.instance.reportCall(t);var r=!!this._clearControlNotification(e);return v.a.instance.reportSuccess(t),r}catch(e){var n=l.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setNotification=function(e,t){var r="ClientApi.XrmDataControl.setNotification";try{v.a.instance.reportCall(r);var n={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return v.a.instance.reportSuccess(r),this.addNotification(n)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(r,e,null,a),e}},t.prototype._isValidNotification=function(e){return!(!e||!e.messages||Object(m.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)},t.prototype._reportAddNotificationEvent=function(e){if(this._isValidNotification(e)){var t,r=e.messages[0],n=new c("Added",this.contextToken.entityTypeName,this.getName(),r);b.dispatch((t=n,{type:"report.xrm.event",execute:function(e,r){try{l.a.getInstance().reportEvent(t)}catch(e){var n="ClientApi.ReportXrmEventAction.reportXrmEvent";f.a.getInstance().eventManager.ReportComponentFailure(n,e),Object(u.j)(n,"XrmReporting")}return Promise.resolve()}}))}},t.prototype.getEntityReference=function(){var e=this.formContext.entityReference,t=e.id?new g.a(e.id):null;return new o.a(e.entityType,t)},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(a.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t.prototype.getAttrDescriptor=function(e,t,r){var n=this.getEntityReference().etn,a=Object(d.r)(b.getState(),n,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(f.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),(a=Object(p.a)(b.getState(),n,this.controlDescriptor.DataFieldName))||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:n}),r.reportFailure(e,new Error("Attribute descriptor was not found"),t))):r.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):r.reportFailure(e,new Error("Control descriptor was not found"),t)),a},t}(i.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"+ulc":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ShowHeaderFieldsInFlyout.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{headerFieldsInFlyout:r},meta:{pageId:e,contextKey:i}}}},"/0Gr":function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("gBKR"),a=r("lMVv"),i=r("uO/V"),o=r("F7qm"),s=r("F2uj");function c(e){return{type:"grid.retrieveRelatedEntityMetadata.async",execute:function(t,r){var i=t.dispatch,o=t.getState;try{var s=Object(a.h)(o(),e),c={};return u(c,e),Object.keys(s.ManyToManyRelationships).forEach((function(t){var r=s.ManyToManyRelationships[t];if(r.IsValidForAdvancedFind){var n=r.Entity1LogicalName;n===e&&(n=r.Entity2LogicalName),u(c,n)}})),Object.keys(s.OneToManyRelationships).forEach((function(e){var t=s.OneToManyRelationships[e];t.IsValidForAdvancedFind&&u(c,t.ReferencingEntity,t.ReferencingAttribute)})),Object.keys(s.ManyToOneRelationships).forEach((function(e){var t=s.ManyToOneRelationships[e];t.IsValidForAdvancedFind&&(u(c,t.ReferencedEntity),u(c,t.ReferencingEntity,t.ReferencingAttribute))})),i(Object(n.e)(c)).catch((function(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}))}catch(t){return h(e,r,t,"retrieveRelatedEntityMetadata.async","retrieveRelatedEntityMetadata")}}}}function l(e){return{type:"grid.retrieveRelatedEntityRelationshipMetadata.async",execute:function(t,r){var n=t.getState;try{var i,c=n(),l=Object(a.h)(c,e),u=[];return Object.keys(l.OneToManyRelationships).forEach((function(e){var t,r,n=l.OneToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencingEntity,h=Object(a.h)(c,i),g=Object(s.a)(c,i,n.ReferencingAttribute);if(h){var m=d(h,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==g?void 0:g.DisplayName)&&void 0!==r?r:h.DisplayCollectionName),f=p(n,h.DisplayCollectionName,o.RelationshipType.OneToMany);u.push([m,f])}}})),Object.keys(l.ManyToManyRelationships).forEach((function(e){var t,r,n=l.ManyToManyRelationships[e];if(n.IsValidForAdvancedFind){var i=!0,s=n.Entity1LogicalName,p=void 0,h=void 0,g=!0;if(s===l.EntityLogicalName?(s=n.Entity2LogicalName,n.IsCustomRelationship&&(i=2!==n.Entity2AssociatedMenuConfiguration.Behavior),h=n.Entity2AssociatedMenuConfiguration.Behavior,p=null!==(t=n.Entity2AssociatedMenuConfiguration.Label)&&void 0!==t?t:"",g=!1):(n.IsCustomRelationship&&(i=2!==n.Entity1AssociatedMenuConfiguration.Behavior),h=n.Entity1AssociatedMenuConfiguration.Behavior,p=null!==(r=n.Entity1AssociatedMenuConfiguration.Label)&&void 0!==r?r:""),i)if(b=Object(a.h)(c,s)){var m=d(b,1===h?p:b.DisplayCollectionName),f=void 0;f=g?{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute}:{displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity1IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity2IntersectAttribute},u.push([m,f])}if(n.Entity1LogicalName===n.Entity2LogicalName){var b=Object(a.h)(c,n.Entity2LogicalName);if(2!==n.Entity1AssociatedMenuConfiguration.Behavior){m=d(b,1===n.Entity1AssociatedMenuConfiguration.Behavior?n.Entity1AssociatedMenuConfiguration.Label:b.DisplayCollectionName),f={displayName:b.DisplayCollectionName,referencedFieldName:l.PrimaryIdAttribute,referencingFieldName:b.PrimaryIdAttribute,relationshipType:o.RelationshipType.ManyToMany,isHierarchical:!1,intersectEntityName:n.IntersectEntityName,entityIntersectIdAttribute:n.Entity2IntersectAttribute,relatedEntityIntersectIdAttribute:n.Entity1IntersectAttribute};u.push([m,f])}}}})),Object.keys(l.ManyToOneRelationships).forEach((function(e){var t,r,n=l.ManyToOneRelationships[e];if(n.IsValidForAdvancedFind){var i=n.ReferencedEntity,h=n.ReferencingAttribute,g=Object(a.h)(c,i),m=Object(s.a)(c,l.EntityLogicalName,h);if(g){var f=p(n,1===n.AssociatedMenuConfiguration.Behavior?null!==(t=n.AssociatedMenuConfiguration.Label)&&void 0!==t?t:"":null!==(r=null==m?void 0:m.DisplayName)&&void 0!==r?r:g.DisplayCollectionName,o.RelationshipType.ManyToOne);u.push([d(g,g.DisplayCollectionName),f])}}})),i=u.sort((function(e,t){var r,n,a,i;if(!(null===(r=e[1])||void 0===r?void 0:r.displayName)||!(null===(n=t[1])||void 0===n?void 0:n.displayName))return 0;var o=e[1].displayName.localeCompare(t[1].displayName);return 0===o?(null===(a=e[0])||void 0===a?void 0:a.displayName)&&(null===(i=t[0])||void 0===i?void 0:i.displayName)?e[0].displayName.localeCompare(t[0].displayName):0:o})),Promise.resolve(i)}catch(t){return h(e,r,t,"retrieveRelatedEntityRelationshipMetadata.async","retrieveRelationshipMetadata")}}}}function u(e,t,r){e[t]||(e[t]=[]),r&&-1===e[t].indexOf(r)&&e[t].push(r)}function d(e,t){var r;return{metadataId:null===(r=e.Id)||void 0===r?void 0:r.guid,displayName:t,primaryIdField:e.PrimaryIdAttribute,primaryNameField:e.PrimaryNameAttribute,name:e.EntityLogicalName}}function p(e,t,r){return{displayName:t,referencingFieldName:e.ReferencingAttribute,isHierarchical:e.IsHierarchical,relationshipType:r,referencedFieldName:e.ReferencedAttribute}}function h(e,t,r,n,a){var o=[{name:i.k,value:e}];return t.EventManager.ReportComponentFailure(Object(i.G)(n,a),r,null,o),Promise.resolve(null)}},"/CqC":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.relationship.clear";function a(e,t){return{type:n,payload:{relationship:t},meta:{pageId:e}}}},"/U1C":function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("c/eZ"),a={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(a),o={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(o),c={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},l=Object.values(c),u={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},d=Object.values(u),p=Object(n.__spreadArrays)(i,s,d);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/V8d":function(e,t,r){"use strict";r.d(t,"a",(function(){return D})),r.d(t,"e",(function(){return M})),r.d(t,"d",(function(){return B})),r.d(t,"b",(function(){return L})),r.d(t,"c",(function(){return R}));var n=r("c/eZ"),a=r("pOv+"),i=r("9r0m"),o=r("sgPk"),s=r("U0B9"),c=r("2OIc"),l=r("Gemh"),u=r("kl3Z"),d=r("lMVv"),p=r("bH46"),h=r("i8/j"),g=r("PQ2H"),m=r("8xrh"),f=r("WS0f"),b=r("7EJx"),v=r("vt+k"),y=r("QAhb"),_=r("HSdq"),O=r("yHpA"),S=r("hl8w"),C=r("RNNy"),I=r("F2uj"),j=r("uO/V"),P=r("qC0c"),T=r("cZkS"),E=r("jigW"),w=r("i2G7"),F=r("sOTk"),x=r("xkx/"),A=r("r2h9"),N=r("+l2M"),D=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function M(e){var t,r=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(j.r)&&e.control.Parameters[j.r],n=[e.viewId,r,e.recordsPerPage,(t=e,t&&t.controlParameters&&t.controlParameters.ChartDrillDownParameters&&t.controlParameters.ChartDrillDownParameters.length>0)];return e.customQueryStateKeyParts&&n.push.apply(n,e.customQueryStateKeyParts),n.join("")}function R(e,t,r,n,a){var i=L(e,t,r,n,a);return function(t){var r=i(t);return r&&r.getQueryState(r instanceof o.a?void 0:e)}}function L(e,t,r,n,a){var c={};return function(u){var d=new i.a(u.viewId),p=Object(l.qb)(e(),d,t);if(!p)return null;var h=function(e,t,r){var n=t.fetchXML,a=null,i="TeamTemplateId";if(t.entityLogicalName===C.a&&e.controlParameters[i]){var o=e.controlParameters[i];if(n&&n.indexOf(o)<0){var s=r?r.guid:"",c=Object(S.a)(n,o,s);n=c.updatedFetchXml,a=c.filterString}}return{fetchXML:n,filterString:a}}(u,p,n),g=h.fetchXML;if(!g&&p.queryApi)return null;if(Object(E.l)(e())&&u.quickFindViewId){var j=new i.a(u.quickFindViewId),D=i.a.isNullOrEmpty(j)?null:Object(l.qb)(e(),j,t);Object(f.a)(D)||(g=function(e,t){var r=new DOMParser;if(e){for(var n=r.parseFromString(e.fetchXML,"text/xml"),a=r.parseFromString(t.fetchXML,"text/xml"),i=n.getElementsByTagName("filter"),o=0;o<i.length;o++)i[o].attributes&&i[o].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[o]);return(new XMLSerializer).serializeToString(a)}return t.fetchXML}(D,p))}var M=e(),R=u.entityLogicalName,L=u.getCustomFilter&&u.getCustomFilter(),V=function(e,t,r,n,a){var o=a.controlParameters.RelationshipName;if(o){var s=n,c=null,u=null;if(a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;if(a.controlParameters.IsDataSetLookup)if(s=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;var d=Object(_.ac)(e,t,a.contextToken),p=new y.a(r,s),h=null,g=!1;Object(I.a)(e,r,c)?h=Object(O.d)(e,d,p,c):a.controlParameters.DependentAttributeType&&(g=a.controlParameters.DependentAttributeType===r&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);var m=h;m&&m.reference?s=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===c||null!==m&&null!==m.reference||!p||null===p.id||g||(s=null);var f=Object(l.kb)(e,t,a.contextToken),b=0,S=v.h.None;return f?(b=1,-1===k.indexOf(o)&&(S=v.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(b=2),{type:b,rollupType:S,entityReference:p,contextId:s,relationshipName:o}}return null}(M,t,a||r&&r.EntityLogicalName,n,u),G=Object(m.p)(e(),R),U=function(e,t,r,n,a,o,s){var c,u=Object(F.g)(e,o),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(l.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),p=Object(l.qb)(e,s,o),h=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(c=t.control)||void 0===c?void 0:c.ClassId,N.E));return Object(x.e)(e)&&(h||Object(x.f)(e))&&!(1===(null==r?void 0:r.type))&&!(2===(null==r?void 0:r.type))&&!(n&&n.linkEntities&&Array.isArray(n.linkEntities)&&n.linkEntities.length>0)&&!a&&!(n&&n.filter&&Array.isArray(n.filter)&&n.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==A.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(M,u,V,L,G,t,d)?w.a.fromView(d,u.quickFindSearchString):o.a.fromXmlAndSql(g,p.offlineSqlQuery,d,u.quickFindSearchString,R,e);(null==h?void 0:h.filterString)&&n&&U.addExistingContextFilterToKey(i.a.toString(n),h.filterString);var z=Object(l.x)(e(),t,u.contextToken);z&&(U.pageNumber=z);var q=B(e(),t,r,u,p,R);q.length&&U.select.apply(U,q);var X=function(e,t,r,n,a,i){var o=null;if(!Object(P.a)(e,T.ub)||!i.hasGrid||1!==i.gridType)return null;var c=Object(l.j)(n)(e,t,i.contextToken),u=Object(s.b)(e),d=c&&c.CustomControls&&c.CustomControls[u]&&c.CustomControls[u].Parameters;if(!Object(l.vb)(d)&&(o=Object(l.o)(e,r))){var p=[],h=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(h)for(var g in h)h.hasOwnProperty(g)&&p.push(h[g].name);-1!==p.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(E.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,R,d,p,u);X&&(X.lookupAttribute&&U.select(X.lookupAttribute),X.primaryAttribute&&U.addChildCountAttribute(X.primaryAttribute));var W=u.getCustomSorting&&u.getCustomSorting(p,c);if(W)for(var H=0,Q=W;H<Q.length;H++){var Y=Q[H];U.orderBy(Y.name,1===Y.sortDirection)}if(V)switch(V.type){case 1:U.applyRollupContextFilter(V.entityReference,V.rollupType);break;case 2:var K=Object(l.v)(M,t,u.contextToken);U.applyContextFilter(V.relationshipName,V.contextId,M,K?K.relationshipRoleOrdinal:void 0)}if(G&&U.where(G),L&&L.filter)if(Array.isArray(L.filter))for(var J=0,Z=L.filter;J<Z.length;J++){var $=Z[J];U.where($,$.shouldReplace)}else!function(e){return!!(e&&e.operator&&e.terms)}($=L.filter)?U.where(Object(m.n)(L.filter,null)):U.where($,$.shouldReplace);if(L&&L.linkEntities)for(var ee=0,te=L.linkEntities;ee<te.length;ee++){var re=te[ee];U.addLinkedEntity(re,re.attributes||[])}var ne=u.recordsPerPage;if(ne)U.pageSize=ne;else{var ae=Object(b.h)(e());u.hasChart||Object(f.a)(ae)?U instanceof o.a&&U.setDefaultPageSize():U.pageSize=ae}return U}}function B(e,t,r,o,m,f){var b=Object(n.__spreadArrays)(function(e,t,r,n){if(0!==r.gridType)return[];var a="Grid",i=Object(s.b)(e),o=t&&Object(c.a)(r.control,t,i);o&&(a=Object(l.ab)(e,o.CustomControlId));return Object(u.b)(e,r.control.UniqueId,a,t&&t.Id,null,null,n)||[]}(e,r,o,m.viewId),function(e,t,r,n){if(1!==t.gridType)return[];return Object(u.a)(e,r,n)||[]}(e,o,f,m.viewId),function(e,t,r,n){var a=[],i=Object(d.h)(e,n);i&&(function(e,t,r){var n=Object(s.b)(e),a=t&&Object(c.a)(r.control,t,n);return a&&[a.CustomControlId&&a.Name].some((function(e){return-1!==D.indexOf(e)}))}(e,t,r)||r.hasGrid)&&("activitypointer"===n&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(l.vb)(r.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(E.a)(i.PrimaryImageAttribute)));return a}(e,r,o,f),function(e,t,r){var n=[];if(4&t.streamMode){n.push("modifiedon");var a=Object(I.d)(e,r);if(a)for(var i in a){var o=a[i];o.IsSortableEnabled&&"image"!==o.Type&&"multiselectpicklist"!==o.Type&&Object(p.b)(e,r,o.LogicalName,o)&&n.push(o.LogicalName)}}else 2&t.streamMode&&n.push("modifiedon");return n}(e,o,f),function(e,t,r,n){var o=[],s=r.cardFormId;if(s)if("activitypointer"===n)o.push.apply(o,p.a);else{var c=i.a.equals(s,a.a)?Object(h.h)(e,n,Object(g.a)(11)):s,l=Object(h.d)(e,c,t);if(l)for(var u in l){var d=l[u];d.DataFieldName&&o.push(d.DataFieldName)}}return o}(e,t,o,f),o.getCustomColumns?o.getCustomColumns():[]);if(b.length){var v=[],y=[],_=m&&m.grid&&m.grid.rows&&m.grid.rows[0]&&m.grid.rows[0].cells;if(_)for(var O in _)_.hasOwnProperty(O)&&y.push(_[O].name);for(var S in b){var C=b[S];-1===y.indexOf(C)&&-1===v.indexOf(C)&&v.push(C)}return v}return b}},"/W63":function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("ar+e"),a=r("VlhU"),i=r("bCrZ"),o=r("Gemh"),s=r("r2h9"),c=r("RlP9"),l=r("sgPk"),u=r("olrR"),d=r("uO/V"),p=r("7pqb"),h=r("s2by"),g=r("19Zc"),m=r("fE8x"),f=r("YrcW"),b=r("JlqV"),v=r("jigW"),y=r("G7N+"),_=r("qC0c"),O=r("cZkS"),S=r("5cS+"),C=r("gBKR"),I=d.x+"."+d.v;function j(e,t,r,n,a,s,u,d,p,m){var f=T(n,u,p),y=Object(c.c)(t,r);if(!y)return Promise.resolve(null);var S=l.a.fromXmlAndSql(y.fetchXML,y.offlineSqlQuery,r).getQueryState(),C=m||Object(o.db)(t,n,u),I=Object(v.c)(a,s),j=!1;Object(b.b)(t)&&Object(v.h)(t,s.relationshipName,!0)&&(j=!0);var E=Object(o.ub)(t,n);if(E||"activitypointer"===n||j){var w=t.user&&t.user.userId,F=Object(_.c)(t,O.Zc),x=Object(h.a)(n,w,s,F,E);return e(x.getFilterOptionsAction()).then((function(r){if(r&&r.length>0){var o=r.filter((function(e){return e.isDefault}));if(o&&o.length>0){var c=x.getFilterExpression(o[0].value);e(Object(g.l)(c,a,s))}}return e(Object(i.d)(S,n,a,s,null,u,C,j,I)).then((function(r){return P(e,r,t,n,a,f,d)}))}))}return e(Object(i.d)(S,n,a,s,null,u,C,void 0,I)).then((function(r){return P(e,r,t,n,a,f,d)}))}function P(e,t,r,n,a,s,c){var l=Object(m.c)(r),u=Object(m.b)(r);return(l||u)&&Object(o.sb)(r,n)&&Object(i.e)(c,e,n,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function T(e,t,r){return[{name:p.a.CorrelationId,value:r.correlationId},{name:p.a.ContextId,value:r.contextId},{name:p.a.ActionStack,value:r.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,r){var i=[{name:"EntityName",value:r.entityName}];return{type:"form.related.openGrid",execute:function(i,l,d){var h=i.dispatch,g=i.getState,m=g(),b=Object(n.e)(m,{id:e},t.parentContextToken),v=T(r.entityName,r.relationshipName,d);if(h(Object(a.b)(e,t,r)),null!==b&&b.id===r.id&&b.isSelected===r.isSelected&&b.relationshipName===r.relationshipName||h(Object(a.b)(e,t.parentContextToken,r)),h(Object(f.a)(e,r)),r&&!r.url){var P=function(e,t){return[{name:p.a.CorrelationId,value:e.correlationId},{name:p.a.ContextId,value:e.contextId},{name:p.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(d,r.entityName);if(!Object(o.v)(m,e,t)){h(Object(u.b)(r.entityName,s.a.MAIN_APPLICATION_VIEW));var E=Object(c.a)(m,r.entityName,s.a.SUB_GRID),w=Object(c.c)(m,E),F=Object(_.c)(m,O.Xc),x=!F||function(e,t){var r,n,a;if(!(null===(n=null===(r=null==t?void 0:t.grid)||void 0===r?void 0:r.rows)||void 0===n?void 0:n.length)||!(null===(a=e.metadata)||void 0===a?void 0:a.entities))return!0;var i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(var o=0;o<i.length;o++)if(i[o].relatedEntityName&&!e.metadata.entities[i[o].relatedEntityName])return!1;return!0}(m,w);return w&&w.initialized===y.a.Initialized&&x?(j(h,m,E,r.entityName,e,t,r.relationshipName,l,d,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),Promise.resolve(E)):h(Object(u.a)(r.entityName,s.a.SUB_GRID)).then((function(n){var a=Promise.resolve();if(F){var i=Object(S.a)(m,n,e);a=h(Object(C.e)(i))}return a.then((function(){var a=g();return j(h,a,n,r.entityName,e,t,r.relationshipName,l,d,r.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),n}))}),(function(e){l.EventManager.ReportComponentFailure(I,e,null,v)}))}}return Promise.resolve(null)},getFailureParameters:function(e,t){return i}}}},"/lKk":function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n=r("UGbr"),a=r("/j9Z"),i=r("71iK"),o=r("RYq1"),s=r("LFYt"),c=r("Ww2r"),l=r("HfRC"),u=r("yOMg"),d=r("VnuK"),p=r("rIXY"),h=r("Sscr"),g=r("HSdq"),m=r("yHpA"),f=r("zsi3"),b=r("+ieV"),v=r("Srej");function y(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute:function(t,r,y){var _=t.dispatch,O=(0,t.getState)(),S=Object(h.j)(O,e),C=Object(g.zb)(O,e,S),I=Object(g.ac)(O,e,S);if(!(!Object(m.g)(O,I)&&C&&Object.keys(C).length>0))return _(Object(n.e)(e,2)).then((function(t){var n=Object(g.Ib)(O,e),h=n?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(t){var m=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:t.etn}];return r.EventManager.ReportComponentSuccess(h,m),(n?Promise.resolve(e):_(Object(s.b)(e,t))).then((function(e){return _(Object(i.a)(t.etn)),function(e,t,r){var n="quickcreate_",a=Object(c.e)(t,[p.g,p.c]),i={actionLabel:Object(c.c)(a,p.g),eventHandler:function(){e(Object(l.a)(r)),e(Object(u.removeToastNotification)(n+r.id.guid))}},o=null,s={id:n+r.id.guid,type:1,level:1,message:Object(c.c)(a,p.c),title:null,action:i,onCloseHandler:o};e(Object(d.b)(s))}(_,O,t),_(Object(o.e)(e,"save")).then((function(){return t}))}))}return r.EventManager.ReportComponentSuccess(h,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))}));for(var j in C){var P=C[j].label,T=C[j].errorMessage,E=_(Object(b.b)(P,T));_(Object(b.c)(S,e,E,f.a.error,Object(v.d)(e,j)))}}}}},"/wtJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("UOiB"),a=r("Sscr"),i=r("HSdq"),o=r("ObKm"),s=r("yHpA"),c=r("sOTk"),l=r("krRo"),u="attribute.precision";function d(e,t,r,d){return{type:"attribute.precision.update",sync:!0,execute:function(p,h){var g,m=p.dispatch,f=p.getState,b=f();m(function(e,t,r,i){if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)return Object(l.e)(e,t,r,i);var o=Object(a.x)(t);return{type:u,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}(e,t,r,d)),b=f();var v=null,y=null,_=null,O=null;if(t&&t.contextTokenType&&t.contextTokenType===n.a.GridRow)v=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,_=Object(a.t)(t),O=Object(a.r)(t);else{var S=Object(c.g)(b,e);v=S&&S.entityTypeName?S.entityTypeName:null,y=S&&S.id?S.id:null,_=null,O=t}var C=Object(i.ac)(b,e,t),I=Object(s.d)(b,C,{etn:v,id:y},r),j=((g={})[r]=I,g);m(Object(o.a)(e,j,!0,!0,v,y?y.guid:null,_,O))}}}},"0MLN":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.setLabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{label:r},meta:{pageId:e,contextKey:i}}}},"0bF2":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="grid.updatequerykey";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(r),o=Object(n.v)(r);return{type:a,payload:e,meta:{pageId:t,contextKey:i,dataSetContextKey:o}}}},"0hCf":function(e,t,r){"use strict";r.d(t,"a",(function(){return x}));var n,a,i=r("HSdq"),o=r("yZTI"),s=r("Zy0S"),c=r("c/eZ"),l=r("FlW1"),u=r("ll2N"),d=r("s0Zj"),p=r("+Z9T"),h=r("w/nD"),g=r("ksD2"),m=r("A8fJ"),f=r("PLtI"),b=r("IiPO"),v=r("ezfI"),y=r("7ipg"),_=function(e){function t(t,r,a,i,o,s){var c=this;return Object(p.g)(o,"ClientApi.XrmTab.constructor","parent"),Object(p.g)(t,"ClientApi.XrmTab.constructor","store"),c=e.call(this,t,r,i,a)||this,n=t,c._parent=o,c._formContext=s,c._iConnectedTabProps={tabName:c.name,tabId:c._getTabId(),id:c.pageId,showTab:!0},c._clientApiExecutor=new y.b(n,"ClientApi.XrmTab.",r),c}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){var e="ClientApi.XrmTab.sections";try{if(v.a.instance.reportCall(e),!this._sections){this._sections=new s.a(e);for(var t=n.getState(),r=Object(i.Gc)(t,this.pageId,this.name,this.contextToken),a=0;a<r.Columns.length;a++)for(var o=Object(i.p)(t,{id:this.pageId,tabName:r.Id,columnIndex:a},this.contextToken),c=null,l=0;l<o.SectionNames.length;l++)c=new u.a(n,this.contextToken,this.pageId,o.SectionNames[l],this,this._formContext),this._sections.add(c.getName(),c)}return v.a.instance.reportSuccess(e),this._sections}catch(t){var d=b.a.getInstance().getEventParameters(this.contextToken);throw d.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,d),t}},enumerable:!1,configurable:!0}),t.prototype.addTabStateChange=function(e){var t="ClientApi.XrmTab.addTabStateChange";Object(p.g)(e,t,"handler");try{v.a.instance.reportCall(t),n.dispatch(Object(h.s)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeTabStateChange=function(e){var t="ClientApi.XrmTab.removeTabStateChange";Object(p.g)(e,t,"handler");try{v.a.instance.reportCall(t),n.dispatch(Object(h.N)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getDisplayState=function(){var e="ClientApi.XrmTab.getDisplayState";try{v.a.instance.reportCall(e);var t=Object(i.Dc)(n.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return v.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParent=function(){return v.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent},t.prototype.setDisplayState=function(e){var t="ClientApi.XrmTab.setDisplayState";try{v.a.instance.reportCall(t);var r=!1;switch(e){case"collapsed":r=!0;break;case"expanded":r=!1;break;default:Object(p.h)(t,"TabDisplayState",e)}r||n.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess(t)}catch(e){var a=b.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.setFocus=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.setFocus"),n.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){var e=b.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTab.setVisible";try{v.a.instance.reportCall(t),n.dispatch(Object(g.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getLabel=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.getLabel");var e=Object(i.Hc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return v.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){var t=b.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}},t.prototype.getVisible=function(){var e="ClientApi.XrmTab.getVisible";try{v.a.instance.reportCall(e);var t=Object(i.Kc)(n.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return v.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTab.setLabel";Object(p.g)(e,t,"label");try{v.a.instance.reportCall(t),n.dispatch(Object(f.b)(this.pageId,this.contextToken,this._getTabId(),e)),v.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype._getTabId=function(){var e=n.getState(),t=Object(i.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id},t.prototype.setContentType=function(e){var t=this;return this._clientApiExecutor.execute("setContentType",(function(){var r;switch(e){case"default":case"cardSections":r="cardSections";break;case"expandAvailableSpace":case"singleComponent":r="singleComponent";break;default:Object(p.h)("setContentType","TabContentType",e)}n.dispatch(Object(m.b)(t.pageId,t._getTabId(),t.contextToken,r))}),[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])},t.prototype.getContentType=function(){var e=this;return this._clientApiExecutor.execute("getContentType",(function(){var t;return null===(t=Object(i.Jc)(n.getState(),e._getTabId(),e._iConnectedTabProps.id,e.contextToken))||void 0===t?void 0:t.contentType}))},t}(l.a),O=r("9r0m"),S=r("tcXs"),C=r("UOiB"),I=r("i8/j"),j=r("sOTk"),P=r("/zIU"),T=r("1z64"),E=r("OTOS"),w=r("uQP8"),F=r("kvLG"),x=function(){function e(e,t,r,n,i,o,s){var c=Object(j.l)(e.getState(),r),l=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"pageType",value:c,isEventParam:!0},{name:"formContext",value:n,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new T.a(e,"ClientApi.XrmFormUIBase.",r,t,l),this._pageId=r,a=e,this._formContext=n,this._entityName=i,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=o}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutor.execute("controls_get",(function(t,r){if(!e._controls){e._controls=new s.a(t);var n=(h=e.pageId,g=e.contextToken,m=e._controls,f=Object(w.b)(a.getState(),h,g),b=Object(E.b)(a.getState(),h),v=O.a.equals(f,b),y=Object(j.l)(a.getState(),h)===P.a.Dialog,_=Object(I.y)(a.getState(),f),S=_&&_.reduce((function(e,t){return e.add(t),e}),new Set),function(e,t){var r=Object(i.s)(a.getState(),{controlName:e,id:h},g),n=Object(i.Rc)(a.getState(),h,r);v&&n&&!y?S&&S.has(r.DataFieldName)&&Object(i.fd)(a.getState(),h,r,g)&&m.add(e,t):m.add(e,t)}),o=e.getFormDescriptor(t,r);if(o){var c={isEventParam:!0,name:"controlName",value:""},l={isEventParam:!0,name:"controlType",value:""};for(var u in r.push(c),r.push(l),o.Controls){var d=o.Controls[u];c.value=u,l.value=d&&d.ClassId?d.ClassId.guid:"";var p=e.xrmControlFactory.createXrmControl(e.contextToken,d,e._formContext,t,r);p&&n(p.getName(),p)}}}var h,g,m,f,b,v,y,_,S;return e._controls}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formSelector",{get:function(){var e=this;return this._clientApiExecutor.execute("formSelector_get",(function(t,r){if(!e._formSelector){var n=e.getFormDescriptor(t,r);n&&(e._formSelector=new e._formSelectorType(a,e._contextToken,n.Id,e._entityName,e._pageId))}return e._formSelector}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(t,r){if(!e._tabs){e._tabs=new s.a(t);var n=e.getFormDescriptor(t,r);if(n){var i=n.Tabs;for(var o in i){var c=new _(a,e._contextToken,i[o].Name,e._pageId,e,e._formContext);e._tabs.add(c.getName(),c)}}}return e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),e.prototype.refreshRibbon=function(e){var t=this;void 0===e&&(e=!1),this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(S.a)(t._pageId,null,e))}))},Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formContext",{get:function(){var e=this;return this._clientApiExecutor.execute("formContext",(function(){return e._formContext}))},enumerable:!1,configurable:!0}),e.prototype.getControls=function(){if(!this._controls&&this.contextToken.contextTokenType===C.a.GridRow){var e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new s.a(e),this._controls}return this.controls},e.prototype.getFormDescriptor=function(e,t){var r=Object(i.fb)(a.getState(),{id:this._pageId},this._contextToken);if(!r){var n="Form descriptor not found";if(Object(o.n)(a.getState(),this._pageId))F.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===C.a.GridRow)F.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;var s=new Error(n);this._clientApiExecutor.reportFailure(e,s,t)}}return r},e}()},"0rak":function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,r){return{type:"chart.drilldownparameters.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(a.z),p=a.x+".updateChartDrillDownParametersAction";try{d.info("Updating the chart drilldown parameters"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var g="Updatation of the chart drilldown parameters failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},"19Zc":function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return f})),r.d(t,"m",(function(){return b})),r.d(t,"n",(function(){return v})),r.d(t,"k",(function(){return y})),r.d(t,"h",(function(){return _})),r.d(t,"o",(function(){return g})),r.d(t,"j",(function(){return O}));var n=r("Sscr"),a=r("uO/V"),i=r("WS0f"),o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function h(e,t,r,i){return{type:"grid.applyFilter.async",execute:function(o,s){var c=o.dispatch,l=s.TraceManager.getTracer(a.z),u=a.x+".applyGridFilterAction",d=Object(n.v)(i),p=[];p.push({name:a.n,value:e}),p.push({name:a.e,value:d});try{return l.info("Applying the filter expression to the grid. "),c(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,d)),s.EventManager.ReportComponentSuccess(u,p),Promise.resolve()}catch(e){s.EventManager.ReportComponentFailure(u,Error("Applying the filter expression to the grid failed "),"",p)}}}}function g(e,t,r){var a=Object(n.v)(r);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:a}}}var m=function(e,t,r){return h(o,e,t,r)},f=function(e,t,r){return h(s,e,t,r)},b=function(e,t,r){return h(c,e,t,r)},v=function(e,t,r){return h(l,Object(i.a)(e)?e:e.trim(),t,r)},y=function(e,t,r){return h(u,e,t,r)},_=function(e,t,r){return h(d,e,t,r)},O=function(e,t,r){return h(p,e,t,r)}},"1PXy":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("YCDx"),c=r("PZxu"),l=r("ildB"),u=r("3OsR"),d=r("+Z9T"),p=r("ME4N"),h=r("IiPO"),g=r("7bez"),m=r("h82J"),f=r("Sscr"),b=r("ezfI"),v=r("gBKR"),y=r("9r0m"),_="ClientApi.XrmControlTimeline.",O=function(e){function t(t,r,a,o,s,c,l,u){var d=e.call(this,t,r,a,o,s,l)||this;return d._defaultLabel=p.u.Timeline,n=t,d._applicationContext=u,d._controlId=c,d._traceManager=u.TraceManager,d._subgridToken=Object(f.p)(r,s),d._clientApiExecutorTimeline=new i.a(t,_,a,r),d._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:s,isEventParam:!0,expectedDataType:"string"}),d._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:c,isEventParam:!0,expectedDataType:"string"}),d._gridControl=new g.a(t,d._subgridToken,a,!1,3,!0,u,s),t.dispatch(Object(m.a)(d,a,d._subgridToken)),d}return Object(a.__extends)(t,e),t.prototype.getControlType=function(){return b.a.instance.reportUsage(_+"getControlType"),"timelinewall"},t.prototype.getName=function(){var e=this;return this.clientApiExecutor.execute("getName",(function(){return e.controlDescriptor&&e.controlDescriptor.Parameters&&e.controlDescriptor.Parameters[p.s.UClientUniqueName]?e.controlDescriptor.Parameters[p.s.UClientUniqueName]:p.u.Timeline}))},t.prototype.getLabel=function(){var e=_+"getLabel";try{b.a.instance.reportCall(e);var t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(d.a)(this.controlDescriptor.Parameters[p.s.Label])?this.controlDescriptor.Parameters[p.s.Label]:this._defaultLabel?this._defaultLabel:"";return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setLabel=function(t){var r=_+"setLabel";try{b.a.instance.reportCall(r),e.prototype.setLabel.call(this,t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[p.s.Label]=t:this._defaultLabel=t,b.a.instance.reportSuccess(r)}catch(e){var n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.openEmail=function(e){var t=_+"openEmail";try{b.a.instance.reportCall(t),n.dispatch(Object(l.t)(this._controlId,e)),n.dispatch(Object(l.o)(this._controlId,u.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.refresh=function(e){var t=_+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{b.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[p.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[p.s.UClientActivities]=e.activities)),n.dispatch(Object(l.o)(this._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setTargetEntity=function(e,t,r){var a=this;void 0===r&&(r=!0);var i=_+"setTargetEntity";try{b.a.instance.reportCall(i);var o={etn:e,id:t,isAPI:!0},s={};return s[e]=[],n.dispatch(Object(l.v)(this._controlId,o)),n.dispatch(Object(v.e)(s)).catch((function(t){var r=h.a.getInstance().getEventParameters(a.contextToken);throw r.push({name:"controlName",value:a.getName()}),r.push({name:"entityName",value:e}),h.a.getInstance().reportFailure(i+"-retrieveEntities",t,null,r),t})).then((function(){r&&n.dispatch(Object(l.o)(a._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(i)}))}catch(e){var c=h.a.getInstance().getEventParameters(this.contextToken);throw c.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(i,e,null,c),e}},t.prototype.getGrid=function(){var e=_+"getGrid";try{return b.a.instance.reportCall(e),this._grid||(this._grid=new c.a(n,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return b.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{b.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(r){var t=h.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),h.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getEntityName=function(){return b.a.instance.reportUsage(_+"getEntityName"),"activitypointer"},t.prototype.getUrl=function(){var e=h.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""},t.prototype.getFilterXml=function(){var e=_+"getFilterXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getFetchXml=function(){var e=_+"getFetchXml",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getViewSelector=function(){var e=_+"getViewSelector",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.getTeamTemplateId=function(){return null},t.prototype.getRelationship=function(){var e=_+"getRelationship",t=h.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.setFilterXml=function(e){var t=_+"setFilterXml",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.addOnLoad=function(e){var t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")},t.prototype.removeOnLoad=function(e){var t=_+"removeOnLoad",r=h.a.getInstance().getEventParameters(this.contextToken);r.push({name:"controlName",value:this.getName()}),r.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",r),b.a.instance.reportUsage(t)},t.prototype.openRelatedGrid=function(){var e=_+"openRelatedGrid",t=h.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e)},t}(s.a)},"2ojE":function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"c",(function(){return h})),r.d(t,"b",(function(){return g}));var n=r("VcAV"),a=r("/j9Z"),i=r("yHpA"),o=r("LhJP"),s=r("9r0m"),c=r("TCcM"),l=r("T576"),u=r("sOTk"),d=r("WS0f");function p(e,t,r,n){var a=[];try{var i=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,o=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,d=i&&!s.a.equals(i,s.a.EMPTY)?function(e,t){var r=Object(l.a)(e,t);if(r)return r.businessProcessFlowProcessState;return null}(e,i):0,p=Object(u.l)(e,r),h={name:"ProcessId",value:i?s.a.toString(i):s.a.EMPTYGUIDSTRING},g={name:"ProcessInstanceId",value:o?s.a.toString(o):s.a.EMPTYGUIDSTRING},m={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},f={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},b={name:"ProcessState",value:d},v={name:"PageId",value:r||""},y={name:"PageType",value:p};a.push(h),a.push(g),a.push(m),a.push(f),a.push(b),a.push(v),a.push(y)}catch(e){n.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,a)}return a}function h(e,t,r){r.EventManager.ReportComponentSuccess(e,t)}function g(e,t,r,s,c,l,u){!function(e,t){if(!Object(n.c)(e)){var r=Object(a.c)(e);if(!Object(n.c)(r)){var i=r.errorCode;if(!Object(n.c)(i)){var o={name:"ErrorCode",value:"0x"+i.toString(16)};t.push(o)}}}}(t,s),function(e,t,r,s){if(!Object(n.c)(e)){var c=Object(a.c)(e);if(!Object(n.c)(c)&&!Object(n.c)(c.FaultedSnapshotId)){var l={name:o.p,value:c.FaultedSnapshotId};if(t.push(l),!Object(n.c)(r)&&!Object(n.c)(s)){var u=Object(i.c)(s,r);if(!Object(n.c)(u)){var p=u.snapshotId;if(!Object(n.c)(p)&&!Object(d.b)(p)&&p===c.FaultedSnapshotId){var h={name:o.q,value:"serverSideCurrentForm"};t.push(h)}}}}}}(t,s,l,u),c.EventManager.ReportComponentFailure(e,t,r,s)}},"3INI":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._traversedPath},set:function(e){for(this._traversedPath=Object(n.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(n.a)(this._traversedPath)},enumerable:!1,configurable:!0}),e.getCandidateTraversedPathFromStagStep=function(e,t){t=Object(n.a)(t);var r=!1;if(!e||e.length)return null;for(var a=0;a<e.length;a++){var i=Object(n.a)(e[a].get_stageId());if("".concat(i,","),t===i){r=!0;break}}return r?"".substring(0,"".length-2):null},e.prototype.isInTraversedPath=function(e){return!Object(a.b)(e)&&this._traversedPath.indexOf(Object(n.a)(e))>-1},e}()},"4HtA":function(e,t,r){"use strict";r.d(t,"a",(function(){return ct}));var n,a=r("c/eZ"),i=r("DRVD"),o=r.n(i),s=r("sOTk"),c=r("r0tX"),l=r("6FBX"),u=r("UGbr"),d=r("UTiY"),p=r("c3W+"),h=r("EGdP"),g=r("/j9Z"),m=r("9r0m"),f=r("T576"),b=r("Y70o");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(n||(n={}));var v=function(){function e(e,t){this._getState=e,this._processId=t}return e.prototype.GenerateMessageForAction=function(e){var t="",r="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(b.a)(a,r,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(b.a)(a,r,"Crm_GenericErrorMessage");switch(e){case n.Completed:t=String.format(i,(new Date).toLocaleString());break;case n.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t},e.prototype.GetActionMetadata=function(e){var t,r=Object(f.a)(this._getState(),new m.a(this._processId.guid));return r&&r.businessProcessFlowActions&&r.businessProcessFlowActions[e]&&(t=r.businessProcessFlowActions[e]),t},e.prototype.InvokeProcessAction=function(e,t,r){return Xrm.Utility.invokeProcessActionInternal(e,r,t)},e}(),y=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if(!e)return null;var t=function(e){var t=[];return e.forEach((function(e){var r={id:m.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(r)})),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function O(e,t,r,n){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:function(a,i){a.dispatch,a.getState;return function(e,t,r,n,a){return e.retrieveNavigationEntities(t,r,n,a,null).nativePromise().then(_,g.b)}(i.DataSource,e,t,r,n)}}}var S=r("mLFd"),C=r("GWjq"),I=r("phfH"),j=function(){function e(e,t){this.Target=e,this.NewProcess=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),P=function(){function e(e,t,r){this.Target=e,this.NewProcess=t,this.NewProcessInstance=r}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),T=r("RVz9"),E=r("IBKq");function w(e,t,r,n,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:function(o,s){o.dispatch,o.getState;return function(e,t,r,n,a,i,o){var s=new E.a(m.a.toLegacyGuid(t.id),t.etn,m.a.toLegacyGuid(r.id),r.etn,m.a.toLegacyGuid(n),a,m.a.toLegacyGuid(i),m.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(s.DataSource,e,t,r,n,a,i)}}}var F=r("Ia1G"),x=function(){function e(e,t){this.EntityId=e,this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}},e}();var A=function(){function e(e,t){this.EntityLogicalName=e,this.AppModuleId=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}},e}(),N=r("4tno");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var D,k=function(){function e(e,t,r){this._name=e,this._uniqueName=t,this._workflowId=r}return Object.defineProperty(e.prototype,"workflowId",{get:function(){return this._workflowId},set:function(e){this._workflowId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueName",{get:function(){return this._uniqueName},set:function(e){this._uniqueName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),e}(),M=r("9rlF"),R=function(){function e(){}return Object.defineProperty(e.prototype,"activeStageId",{get:function(){return this._activeStageId},set:function(e){this._activeStageId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceId",{get:function(){return this._businessProcessInstanceId},set:function(e){this._businessProcessInstanceId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceName",{get:function(){return this._businessProcessInstanceName},set:function(e){this._businessProcessInstanceName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessState",{get:function(){return this._businessProcessState},set:function(e){this._businessProcessState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessStatus",{get:function(){return this._businessProcessStatus},set:function(e){this._businessProcessStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},set:function(e){this._navigationEntities=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpfDefinitionVersionNumber",{get:function(){return this._bpfDefinitionVersionNumber},set:function(e){this._bpfDefinitionVersionNumber=e},enumerable:!1,configurable:!0}),e}(),L=r("3INI"),B=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryField",{get:function(){return this._primaryField},set:function(e){this._primaryField=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityTypeCode",{get:function(){return this._entityTypeCode},set:function(e){this._entityTypeCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityLogicalName",{get:function(){return this._entityLogicalName},set:function(e){this._entityLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyName",{get:function(){return this._primaryKeyName},set:function(e){this._primaryKeyName=e},enumerable:!1,configurable:!0}),e}(),V=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(D||(D={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var G,U=function(){function e(e){this._stageManager=e,this._populateTraversedPath()}return e.prototype.getTraversedPath=function(){return this._traversedPath},e.prototype._populateTraversedPath=function(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path},e}(),z=r("7kKV"),q=r("AqA3"),X=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.invalid,n.stageInvalidReason=q.a.invalid,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),W=(function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.crossEntity,n.stageInvalidReason=q.a.crossEntity,Object.setPrototypeOf(n,t.prototype),n}Object(a.__extends)(t,e)}(Error),function(e){function t(r){var n=e.call(this,r)||this;return n.stageInvalidReason=q.a.unreachable,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error)),H=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.dirtyForm,n.stageInvalidReason=q.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Q=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.end,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Y=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.beginning,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),K=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.stageGate,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),J=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.invalidProcess,n.stageInvalidReason=q.a.invalidProcess,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),Z=function(e){function t(r){var n=e.call(this,r)||this;return n.navigationStatus=z.a.dirtyForm,n.stageInvalidReason=q.a.dirtyForm,Object.setPrototypeOf(n,t.prototype),n}return Object(a.__extends)(t,e),t}(Error),$=r("QAhb"),ee=r("TVue"),te=r("rQCE"),re=r("lFQy"),ne=r("Jcuz"),ae=r("690X"),ie=r("eA/s"),oe=r("jJRu"),se=r("g9bv"),ce=r("r454"),le=r("OROb"),ue=r("qYad"),de=r("TCcM"),pe=r("cAHA"),he=r("Sscr"),ge=r("yHpA"),me=r("LteD"),fe=r("BFwB"),be=function(e){function t(t,r,n){var a=e.call(this,"BusinessProcessFlow_"+t)||this;return a.addEventParameter("ProcessId",r),a.addEventParameter("ProcessInstanceId",n),a}return Object(a.__extends)(t,e),t}(fe.a),ve=function(e){function t(t,r){return e.call(this,"Initialized",t,r)||this}return Object(a.__extends)(t,e),t}(be),ye=function(e){function t(t,r,n){var a=e.call(this,"SetActiveStageEvent",t,r)||this;return a.addEventParameter("ActiveStageId",n),a}return Object(a.__extends)(t,e),t}(be),_e=function(e){function t(t,r,n){var a=e.call(this,"DisplayStateEvent",t,r)||this;return a.addEventParameter("CurrentDisplayState",n),a}return Object(a.__extends)(t,e),t}(be),Oe=function(e){function t(t,r,n,a){var i=e.call(this,"StatusEvent",t,r)||this;return i.addEventParameter("ProcessStatus",n),i.addEventParameter("CurrentDisplayState",a),i}return Object(a.__extends)(t,e),t}(be),Se=r("txwV"),Ce=r("WS0f"),Ie=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}},e}(),je=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Pe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}},e}(),Te=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}},e}(),Ee=r("K1ho"),we=r("ObKm"),Fe=r("uwKl"),xe=r("ed60");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(G||(G={}));var Ae=r("2ojE"),Ne=r("LhJP"),De=r("lMVv"),ke=r("GHPx"),Me=r("h82J"),Re=r("VcAV"),Le=function(){function e(e,t){this._getState=e,this._applicationContext=t}return e.prototype.setBpfInstance=function(e){return this._processInstance=e,this},e.prototype.setBpfInstanceName=function(e){return this._processInstanceName=e,this},e.prototype.setProcess=function(e){return this._process=e,this},e.prototype.setProcessId=function(e){return this._processId=e,this},e.prototype.setFormEntity=function(e){return this._formEntity=e,this},e.prototype.GetFlowStepMetadata=function(e,t){var r=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),n=this._processId&&this._processId.guid||null,a=Object(f.a)(this._getState(),m.a.tryParse(n));if(Object(Re.c)(a))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;var i=a.businessProcessFlowFlows;if(Object(Re.c)(i))return r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;var o=i[e];return Object(Re.c)(i)?(r.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o},e.prototype.openFlowWidget=function(e,t){if(m.a.tryParse(e.flowStepId)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);var r=this._populateFlowDialogParams(e,t),n={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",n,r)},e.prototype._populateFlowDialogParams=function(t,r){var n=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Re.c)(n))throw new Error("BPF Flow Step Failure: null metadata");var a={},i=n.flowId;if(Object(Re.c)(i))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){var o=[];o.push(this._processInstance.id.guid);var s=JSON.stringify(o);a.entity_ids=s}a.flow_id=i,a.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),a.bpf_step_id=t.flowStepId;var c=Xrm.Page.data.entity.getEntityName(),l=this._getState().metadata.entities[c].EntitySetName,u=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");a.entity_logical_collection_name=l,a.entity_logical_name=c,a.flows_destination_url=u,a.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");var d=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");a.flows_fpi_site_url=d+"&flowsEnableWidgetV2=true",a.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),a.flows_enable_widget_v2=!0,e.UpdateEventParameter(r,"flows_destination_url",u),e.UpdateEventParameter(r,"flow_id",i),Object(Re.c)(t.workflowLogId)||t.workflowLogId===m.a.EMPTY||(a.flows_wflog_id=m.a.toString(t.workflowLogId));var p=this._processInstance&&this._processInstance.id;if(Object(Re.c)(p)||p===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+p);a.bpf_instance_id=m.a.toString(p);var h=this._processInstance&&this._processInstance.etn;if(Object(Ce.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+h);a.bpf_instance_entity_name=h;var g=this._processId&&this._processId.guid||null;if(m.a.tryParse(g)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+g);a.bpf_definition_id=g,a.bpf_definition_entity_name="workflow";var f=this._process&&this._process.get_Name();if(Object(Ce.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+f);if(a.bpf_definition_name=f,Object(Ce.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);a.bpf_instance_name=this._processInstanceName;var b=t.selectedStage&&t.selectedStage.get_Description();if(Object(Ce.b)(b))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+b);a.bpf_flowstage_localized_name=b,a.bpf_flowstage_entity_name=c,a.bpf_flowstage_entity_collection_name=l;var v=this._formEntity&&this._formEntity.id;if(Object(Re.c)(v)||v===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+v);a.bpf_flowstage_entity_record_id=m.a.toString(v);var y=m.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Re.c)(y)||y===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+y);a.bpf_activestage_id=m.a.toString(y);var _=t.activeStage&&t.activeStage.get_Description();if(Object(Ce.b)(_))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+_);return a.bpf_activestage_localized_name=_,a.bpf_activestageentity_name="processstage",a},e.prototype._getLocalizedLabel=function(e){return Xrm.Utility.getResourceString("Main_system_library",e)},e.getTelemetryParamsForFlowStep=function(e,t,r,n,a){var i=a||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:r},l={name:"bpf_step_id",value:n};return i.push(o),i.push(s),i.push(c),i.push(l),i},e.UpdateEventParameter=function(e,t,r){e&&0!==e.length&&e.some((function(e){if(e.name===t)return e.value=r,!0}))},e}(),Be=r("qC0c"),Ve=r("pflg"),Ge=r("UWFM"),Ue=r("b1hT"),ze=r("tvev"),qe=r("RK8T"),Xe=r("xc1f"),We=r("yZTI"),He=r("UVKb"),Qe=r("j+yI"),Ye=r("OTOS"),Ke=r("uQP8"),Je=r("lKeh"),Ze=r("IQF2"),$e=r("buKK"),et=r("+D0h"),tt=r("YEEA"),rt=r("2nMH"),nt=o.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),at=o.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),it=o.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ot=o.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=o.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager"),ct=function(){function e(e,t,r,n,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=r,this._stageMetadata=n,this._activeStageManager=a}return e.prototype.initilaizeWithProcessAndFormEntity=function(e,t,r,n,a,i){var o=this,s=nt.startStopwatch({processId:m.a.toString(n),processInstanceId:m.a.toString(a.id)});this._currentPageId=i,this._processId=n,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=r,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);var c=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(c),this._stageMetadata.initializeDefaultPathManager(new U(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;var l={};if(this._isUserSelectedStage)l.selectedStageId=m.a.tryParseOrNull(this.getSelectedStageId());else{var u=this.getActiveStageId();this._isActiveStageInCurrentEntity(u)?l.selectedStageId=m.a.tryParseOrNull(u):l.selectedStageId=this._getDefaultSelectedStageId()||m.a.tryParseOrNull(u)}this._dispatch(Object(re.a)(l,this._currentBpfInstance));var d=new ve(m.a.toString(n),m.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(d),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then((function(e){e&&e.getEventManager().addOnProcessChangeEvent(o.getContextToken(),(function(){o._saveCrossEntityBpf()}))}))),Object(Ue.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new v(this._getState,n),this._flowStepManager=new Le(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(f.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Ue.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var p=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.g).error("ProcessManager is initialized with current entity as null",p);Object(Ae.c)(Ne.g,p,this._applicationContext),s()},e.prototype._saveCrossEntityBpf=function(){var e=this._getState(),t=Object(s.g)(e,this._currentPageId),r=Object(Ve.a)(t),n=Object(Ve.b)(t);if(r&&n){var a=new $.a(t.data.parentrecordtype,new m.a(t.data.parentrecordid)),i=new $.a(t.entityTypeName,t.id);this._dispatch(Object(Fe.b)(r,i)),this._dispatch(Object(xe.b)(n,i)),this.navigateToNextEntityForCrossEntityBpf(a,i,r,n)}},e.prototype.initilaizeWithFormEntityOnly=function(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Ue.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Ue.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var r=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.f).error("ProcessManager is initialized with current entity as null",r);Object(Ae.c)(Ne.f,r,this._applicationContext)},e.prototype.setActiveProcess=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(Ae.b)(Ne.m,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);if(!o)return Object(Ae.c)(Ne.m,a,t._applicationContext),void n(new Error("Invalid process id"));if(m.a.isNullOrEmpty(t.getCurrentFormEntity().id))return Object(Ae.c)(Ne.m,a,t._applicationContext),void n(new g.a("Not supported on new records",2147877748));var s=new j({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(T.b)(s)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcess"),Object(Ae.c)(Ne.m,a,t._applicationContext),r()}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)})),Object(Ae.b)(Ne.m,e,null,a,t._applicationContext,null,t._getState())}))}))},e.prototype.setActiveProcessInstance=function(e){var t=this;return new Promise((function(r,n){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new g.a("Current form entity is not initialized.",2147877745);return Object(Ae.b)(Ne.n,i,null,a,t._applicationContext,null,t._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);o?t.getProcessInstances().then((function(e){if(e&&e.value){for(var a="",i=0,s=e.value;i<s.length;i++){var c=s[i];if(c&&c.businessprocessflowinstanceid&&c.businessprocessflowinstanceid.toLowerCase()===m.a.toString(o).toLowerCase()){a=c["a_processid_value".substring(1)];break}}if(Object(Ce.b)(a))n(new g.a("Supplied process instance does not match any existing instance on this entity",2147877744));else{var u=m.a.tryParseOrNull(a);if(u){var p=new P({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(u),entityType:l.fc},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(T.b)(p)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcessInstance"),r(a)}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)}))}))}else n(new Error("Invalid process id"))}}else n(new Error("No process instances found for current entity"))}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return n(e)}))})):n(new Error("Invalid process instance id"))}))},e.prototype.setCurrentInstance=function(e){this._currentBpfInstance=e},e.prototype.setStatus=function(e){var t=this;return new Promise((function(r,n){var a;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===V.a.Active)a=t.reactivateProcess();else if(e===V.a.Finished)a=t.completeProcess();else{if(e!==V.a.Aborted)return n(new Error("Invalid status passed to setStatus"));a=t.abandonProcess()}a.then((function(){var n=new Oe(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e,t.getDisplayState());t._applicationContext.EventManager.ReportEvent(n),r()}),(function(e){n(e)}))}))},e.prototype.setVisible=function(e){if(!(Object(Ce.a)(this._currentBpfInstance)||Object(Ce.a)(this._currentFormEntity)||Object(Ce.a)(this._currentFormEntity.etn))){var t=Object(he.h)(this._currentFormEntity.etn);this._dispatch(Object(me.b)(this._currentPageId,Se.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}},e.prototype.isVisible=function(){if(!this._currentBpfInstance)return!1;var e=Object(he.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:Se.a},e)},e.prototype.getCurrentFormEntity=function(){return this._currentFormEntity},e.prototype.getActiveStageEntityRef=function(){var e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,r=this._getNavigationEntityIdsByEntityLogicalName();return t&&r&&r.hasOwnProperty(t)?new $.a(t,r[t]):null},e.prototype.getProcess=function(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()},e.prototype.getProcessInstanceName=function(){return this._currentBpfInstance&&Object(C.e)(this._getState(),this._currentBpfInstance)},e.prototype.getTraversedPath=function(){return Object(C.h)(this._getState(),this._currentBpfInstance)},e.prototype.getProcessId=function(){return this._processId},e.prototype.getVersion=function(){return this._version},e.prototype.getProcessInstanceId=function(){return this._currentBpfInstance&&this._currentBpfInstance.id},e.prototype.getBpfEntityLogicalName=function(){return this._currentBpfInstance&&this._currentBpfInstance.etn},e.prototype.getEntityStages=function(){return this._stageMetadata.getEntityStages()},e.prototype.getActiveStage=function(){return this._getStage(this.getActiveStageId())},e.prototype.getProcessInstances=function(){var e=this;return new Promise((function(t,r){var n,a;e._dispatch((n=e._currentFormEntity.id,a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute:function(e,t){e.dispatch;var r=e.getState,i=t.DataSource.get_WebAPIService(),o=new x(n,a),s=Object(F.a)(r(),o);return i.sendRequest(s).then((function(e){return e.json()}),g.b)}})).then((function(e){t(e)}),(function(e){r(e)}))}))},e.prototype.getSelectedStage=function(){return this._getStage(this.getSelectedStageId())},e.prototype.isCrossEntityNavigation=function(e){var t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;var r=this._stageMetadata.getStage(t);if(!r)return!1;var n=r.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&n&&n.get_EntityLogicalName()!==this._currentFormEntity.etn},e.prototype._isStageOnPath=function(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];if(m.a.equals(a,e))return!0}return!1},e.prototype.getProcessState=function(){var e=Object(f.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null},e.prototype.getState=function(){if(this._currentBpfInstance){var e=Object(C.f)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getStatusName=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e)return e.label}return null},e.prototype.getStatus=function(){if(this._currentBpfInstance){var e=Object(C.g)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getActiveStageId=function(){if(this._currentBpfInstance){var e=this._currentBpfInstance&&Object(C.a)(this._getState(),this._currentBpfInstance);if(m.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){var t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=m.a.tryParseOrNull(t))}if(!m.a.isNullOrEmpty(e)){var r=this.getActivePath();if(r&&r.length>0)return this._isStageOnPath(e,r)?e.guid:r[0].guid}}return null},e.prototype.getActivePathStages=function(){var e=this.getActivePath();if(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=this._getStage(e[r].guid);return t}return null},e.prototype.getActivePath=function(){if(!this._currentBpfInstance)return null;var e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e},e.prototype.getDisplayState=function(){return this._currentBpfInstance?Object(I.d)(this._getState())||c.a.getDefaultDisplayState():null},e.prototype.getSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()},e.prototype._getDefaultSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),m.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e},e.prototype._isActiveStageInCurrentEntity=function(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0},e.prototype.getStageMetadata=function(){return this._stageMetadata},e.prototype.isBusinessProcessAborted=function(){return this.getStatus()===V.a.Aborted},e.prototype.isBusinessProcessCompleted=function(){return this.getStatus()===V.a.Finished},e.prototype.moveToNextStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getNextStageId(e.getActiveStageId());if(n){t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),0,"MoveToNextStage")})))}else r(new Q("Last stage in the active path reached. Next stage does not exist."))}));return r.then((function(){Object(Ae.c)(Ne.h,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ae.c)(Ne.h,t,e._applicationContext):Object(Ae.b)(Ne.h,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.moveToPreviousStage=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){if(Object(Ce.a)(e._currentBpfInstance))return r(new g.a("Process Control does not exist on form.",2147877746));var n=e._stageMetadata.getPreviousStageId(e.getActiveStageId());if(!n)return r(new Y("The first stage in the traversed path reached. Previous stage does not exist."));t(e._saveFormDataAndActiveStage(m.a.tryParseOrNull(n),1,"MoveToPreviousStage"))})).then((function(){e._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e.getActiveStageId())}));return r.then((function(){Object(Ae.c)(Ne.i,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ae.c)(Ne.i,t,e._applicationContext):Object(Ae.b)(Ne.i,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.setActiveStage=function(e){var t=this,r=at.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),a=new Promise((function(r,n){var a=m.a.tryParseOrNull(e),i=t.getTraversedPath();if(Object(Ce.a)(t._currentBpfInstance))return n(new g.a("Process Control does not exist on form.",2147877746));if(!a)return n(new X("setActiveStage can only be called with a valid stage id"));if(!t._stageMetadata.getStage(a.guid))return n(new X("stage id does not exist on any path of the instance"));if(!i)return n(new X("Traversed Path is not present"));if(t.getActiveStageId()===a.guid)return r();var o=new L.a(i);if(!o||!o.isInTraversedPath(e))return n(t.getActivePath().some((function(e){return m.a.equals(e,a)}))?new X("The stage is not in traversed path. Only navigating backwards is supported."):new W("stage id does not exist on the current acitve path of the instance."));r(t._saveFormDataAndActiveStage(a,1,"SetActiveStage"))})).then((function(){var r=new ye(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e);t._applicationContext.EventManager.ReportEvent(r),t._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)}));return a.then((function(){r(),Object(Ae.c)(Ne.o,n,t._applicationContext)}),(function(e){r(),t._shouldReportErrorAsSuccess(e)?Object(Ae.c)(Ne.o,n,t._applicationContext):Object(Ae.b)(Ne.o,e,null,n,t._applicationContext,t.getCurrentFormEntity(),t._getState())})),a},e.prototype.switchProcess=function(){},e.prototype.abandonProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessAborted()?t():void t(e._updateStateAndStatusOfProcess(V.a.Aborted,D.Inactive,"AbandonProcess"))}));return r.then((function(){Object(Ae.c)(Ne.a,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ae.c)(Ne.a,t,e._applicationContext):Object(Ae.b)(Ne.a,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.reactivateProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.getStatus()===V.a.Active?t():void t(e._updateStateAndStatusOfProcess(V.a.Active,D.Active,"ReactivateProcess"))}));return r.then((function(){Object(Ae.c)(Ne.j,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ae.c)(Ne.j,t,e._applicationContext):Object(Ae.b)(Ne.j,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype.completeProcess=function(){var e=this,t=this.getTelemetryParams(),r=new Promise((function(t,r){return Object(Ce.a)(e._currentBpfInstance)?r(new g.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessCompleted()?t():m.a.tryParseOrNull(e._stageMetadata.getNextStageId(e.getActiveStageId()))?r(new g.a("Attempt to finish a process not on last stage.",2148081666)):void t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._updateStateAndStatusOfProcess(V.a.Finished,D.Inactive,"CompleteProcess")})))}));return r.then((function(){Object(Ae.c)(Ne.c,t,e._applicationContext)}),(function(r){e._shouldReportErrorAsSuccess(r)?Object(Ae.c)(Ne.c,t,e._applicationContext):Object(Ae.b)(Ne.c,r,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),r},e.prototype._shouldReportErrorAsSuccess=function(e){return e instanceof J||(e instanceof K||(e instanceof Q||(e instanceof Y||(e instanceof X||(e instanceof W||e instanceof Z)))))},e.prototype.triggerActionStepClick=function(e){var t=this;if(Object(Ce.b)(e)){var r=new Error("BPF Action Step Failure: null ControlId");throw Object(Ae.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var n=this._actionStepManager.GetActionMetadata(e);if(Object(Ce.a)(n)){r=new Error("BPF Action Step Failure: null metadata");throw Object(Ae.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var a=this._getState();if(Object(Ce.a)(a)){r=new Error("BPF Action Step Failure: null state");throw Object(Ae.b)(Ne.b,r,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),r}var i=this._getTelemetryParamsForActionStep(n.actionType,e,n.actionId);try{var o=new m.a(n.actionId);if(n.actionType===G.AsyncWorkflow||n.actionType===G.SyncWorkflow){var s=[this._processId.guid,m.a.toString(this.getProcessInstanceId()),o.guid].map((function(e){var t=new je;return t.Type="System.String",t.Value=e,t})),c=new Pe;c.Keys=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],c.Values=s,c.Count=3,c.IsReadOnly=!0;var l=new Te;l.Arguments=c;var u=new Ie;u.EntityId=this._currentFormEntity.id,u.InputArguments=l,u.entity={id:n.workflowId,entityType:"workflow"},this.UpdateActionLog(o,1),this._dispatch(Object(T.b)(u)).then((function(){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2)),Object(Ae.c)(Ne.b,i,t._applicationContext)}),(function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ae.b)(Ne.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(r,!0)).then()}))}else if(n.actionType===G.ProcessAction){var p=function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Ae.b)(Ne.b,r,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(r,!0)).then()},h=function(r){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2));var a=r.get_outputParameters();n.outputBindings.forEach((function(e){if(e.parameterName in a){var r=a[e.parameterName],n=e.boundAttributeName,i={};i[n]={key:n,value:r},t._dispatch(Object(we.a)(t._currentPageId,i,!1,!0,t._currentFormEntity.etn,t._currentFormEntity.id.guid,null,t.getContextToken()))}})),Object(Ae.c)(Ne.b,i,t._applicationContext)},g={};n.inputBindings.forEach((function(e){var r=Object(M.c)(Object(de.j)(t._getState(),t.getCurrentFormEntity(),e.boundAttributeName));g["ProcessUnification_Arguments_"+e.parameterName]=r})),this._addInputParametersToParamList(n.inputParameters,g),this.UpdateActionLog(o,1),Xrm.Navigation.openDialog(n.workflowId,this._getDialogOptions(),g).then((function(r){if(r=r?r.parameters:{},t._filterInputArguments(r)){var a={id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn};r.Target=a,r.BusinessProcessFlowId=t._processId.guid,r.BusinessProcessFlowInstanceId=m.a.toString(t.getProcessInstanceId()),r.ActionStepId=n.actionId,t._actionStepManager.InvokeProcessAction(n.uniqueName,n,r).then(h,p)}else Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3))}),p)}}catch(e){throw 0===i.length&&(i=this.getTelemetryParams()),Object(Ae.b)(Ne.b,e,null,i,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}},e.prototype.triggerFlowStepClick=function(e,t){t=t;var r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{var n=m.a.newGuid(),a={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:n};this._flowStepManager.openFlowWidget(a,r),this.UpdateActionLog(new m.a(e),1,void 0,n);var i=this.getActionLog(new m.a(e));this.createWorkflowLogRecord(i),Object(Ae.c)(Ne.d,r,this._applicationContext)}catch(e){Object(Ae.b)(Ne.d,e,null,r,this._applicationContext,this.getCurrentFormEntity(),this._getState())}},e.prototype.refreshFlowStepClick=function(e){var t=this,r=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(He.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then((function(){t._updateProcessInstanceModifiedTime(),Object(Ae.c)(Ne.k,r,t._applicationContext)})).catch((function(e){Object(Ae.b)(Ne.k,e,null,r,t._applicationContext,t.getCurrentFormEntity(),t._getState())}))},e.prototype._addInputParametersToParamList=function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];"ProcessUnification_Arguments_"+e[a].parameterName in t||(t["ProcessUnification_Arguments_"+e[a].parameterName]=null)}},e.prototype._filterInputArguments=function(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){for(var t in e){var r=e[t];if(t.startsWith("ProcessUnification_Arguments_"))e[t.substring("ProcessUnification_Arguments_".length,t.length)]=r;delete e[t]}return!0}return!1},e.prototype._getDialogOptions=function(){return{height:450,width:450,position:1}},e.prototype._createSnapshotRequest=function(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");var r=new $.a("processstage",e),n=this._calculateNewTraversedPath(e),a={activestageid:{reference:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,t)},e.prototype._addFieldsToBPFSnapshotForCreate=function(e,t){if(!e||!this._hasBpfInstance())return e;var r=Object(Qe.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return r&&(e[r.ReferencingAttribute]={reference:new $.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new $.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e},e.prototype.generateBPFInstanceSnapshotId=function(){if(this.isImmersiveBPF()||!Object(Be.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;var e=[],t=null;try{var r=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),n=Object(ge.b)(this._getState(),r),a=n.identifier&&n.identifier.id||this._currentFormEntity.id,i=Object(s.g)(this._getState(),this._currentPageId);if(Object(Qe.e)(i))return Object(Qe.f)(this._getState(),r,a,this._dispatch),null;if(!this._hasBpfInstance()||m.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Qe.d)(this._getState(),n.identifier,this._currentPageId))return Object(Qe.f)(this._getState(),r,a,this._dispatch),null;m.a.isNullOrEmpty(a)&&(a=m.a.newGuid(),Object(Qe.f)(this._getState(),r,a,this._dispatch)),t=this._createActiveStageSnapshot(m.a.tryParse(this.getActiveStageId()),a);var o=Object(ge.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map((function(e){return"Property: "+e})).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t},e.prototype._calculateNewTraversedPath=function(e){for(var t="",r=0,n=this.getActivePath();r<n.length;r++){var a=n[r];if(t+=","+a.guid,m.a.equals(a,e))return t.substring(1)}return(t+=","+e.guid).substring(1)},e.prototype._createActiveStageSnapshot=function(e,t){var r=this._createSnapshotRequest(e,t),n=ot.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Ce.a)(a)){var i=Object(se.b)(this._getState(),a.snapshotId,r);return this._dispatch(i),a=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n(),a.snapshotId}var o=Object(he.h)(this._currentFormEntity.etn),s=Object(he.x)(o),c=Object(oe.b)(this._getState(),this._currentBpfInstance,r,s,this._hasBpfInstance()?pe.a.Create:pe.a.Update),l=c.payload.snapshotId;return this._dispatch(c),n(),l},e.prototype._hasBpfInstance=function(){return!this._currentBpfInstance||m.a.isNullOrEmpty(this._currentBpfInstance.id)},e.prototype._updateStateAndStatusOfProcess=function(e,t,r){var n=this;return new Promise((function(a,i){var o=n._createStatusAndStateUpdateRequest(e,t),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity()),c=null;if(n.isImmersiveBPF()&&!Object(Ce.a)(s)){var l=Object(se.b)(n._getState(),s.snapshotId,o);n._dispatch(l),s=Object(ge.c)(n._getState(),n.getCurrentFormEntity())}else{var u=Object(he.h)(n.getCurrentFormEntity().etn),p=Object(he.x)(u),h=Object(oe.b)(n._getState(),n._currentBpfInstance,o,p);c=h.payload.snapshotId,n._dispatch(h)}if(!n.executePreEvent("runOnPreProcessStatusChange",r,null,e))if(n._shouldPerformFormSave()){var m=n._validateSnapshot(s).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return n._saveFormEntityAndBPFEntitySnapshots(c,s,!1)})).then((function(){n._executePostEvent("runOnProcessStatusChange",r,null,e)})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,c)})).catch((function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e})).catch((function(e){n._dispatch(Object(d.b)(e,!0)).then((function(){return i(e)}))}));a(m)}else n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){var t=null;t=n.isImmersiveBPF()&&!Object(Ce.a)(s)?s.snapshotId:c;n._dispatch(Object(le.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh())).then((function(){n._updateProcessInstanceModifiedTime(),n._executePostEvent("runOnProcessStatusChange",r,null,e)})),a()})).catch((function(e){n._dispatch(Object(d.b)(e,!0)).then((function(){return i(e)}))}))}));a()}))},e.prototype._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures=function(e){var t=this;return new Promise((function(r,n){if("CompleteProcess"===e||"MoveToNextStage"===e){var a=t.ValidateRequiredFieldsForNavigation();if(a&&!a.isValid)if("MoveToNextStage"===e)n(new K("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new K("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return r()}))},e.prototype._saveFormChangesBeforeNavigation=function(){var e=this;if(this._shouldPerformFormSave()){var t=Object(ge.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then((function(){return e._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")})).then((function(){var r=e._getColumnsToRefresh();return e._dispatch(Object(le.c)(t.snapshotId,!0,r))})).catch((function(r){return e._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(r,t.snapshotId),e._dispatch(Object(d.b)(r,!0))}))}return Promise.resolve()},e.prototype._shouldPerformFormSave=function(){var e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),r=this._getState();if(Object(y.kb)(r,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;var n=this._dispatch(Object(Me.b)(this._currentPageId,this.getContextToken()));if(n&&n.data&&n.data.getIsDirty){var a=n.data.getIsDirty(),i={name:"shouldPerformMainFormSave",value:a};return t.push(i),e.info("Checking if main form save should be performed due to dirty form",t),a}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1},e.prototype._saveMainFormIfImmersiveBpfAndNewRecord=function(){var e=this,t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===Xe.a&&m.a.isNullOrEmpty(this.getCurrentFormEntity().id)){return this._dispatch(Object(u.f)(this._currentPageId,t,!1,1,!1,!1)).then((function(t){e._currentFormEntity=t}))}return Promise.resolve(void 0)},e.prototype._validateSnapshot=function(e){var t=this;return new Promise((function(r,n){var a=t._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),i=t._getSnapshotStateTelemetryParams(e),o=t._currentPageId,s=t.getContextToken(),c=t._dispatch(t._getEventManager().runOnSave(s,1));for(var l in c&&(t._dispatch(Object(p.b)(o,s,2)),t._dispatch(Object(h.b)(o,s,!1)),a.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",i),n(new g.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737))),e.activeChanges){var u=e.activeChanges[l],d=t._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,l),m=Object(Ce.a)(d)?null:d.get_logicalName(),f=Object(Ce.a)(d)?ze.a.get_empty():d.get_id();if(Object(Ce.a)(u))return a.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null fieldValue"));var b=u.validationResult;if(Object(Ce.a)(b)){if(m===ke.c){a.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+m+" with ID: "+f,i);continue}return a.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null validatorResult"))}var v=b.isValueValid;if(Object(Ce.a)(v))return a.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+m+" with ID: "+f,i),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!v){var y={name:Ne.q,value:"clientSideCurrentForm"};return i.push(y),a.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+m+" with ID: "+f,i),n(new H("Unable to save form data due to validation errors"))}}return r(!0)}))},e.prototype._createStatusAndStateUpdateRequest=function(e,t){var r;return(r={}).statuscode={label:V.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r.statecode={label:D[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},r},e.prototype.ValidateRequiredFieldsForNavigation=function(){for(var e=it.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),t=this._getState(),r=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),n=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a={emptySteps:[],errorSteps:[]},i=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),l=0,d=r;l<d.length;l++){var p=d[l];c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+p,o);var h=Object(de.j)(this._getState(),this.getCurrentFormEntity(),p);i&&i.activeChanges&&p in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+p,o),h=i.activeChanges[p]),Object(I.h)(h,this._getState(),this.getCurrentFormEntity().etn,p)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+p,o),a.emptySteps.push(p)):h.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+p,o),a.errorSteps.push(p))}for(var g=0,f=n;g<f.length;g++){var b=f[g],v=m.a.tryParse(b);if(m.a.isNullOrEmpty(v))c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+b,o);else{var _=this.getActionLog(v);if(_){var O=_.status;2!==O&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". The Flow Step Action Log has stauts of : "+O,o),a.errorSteps.push(b))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". No action logs were found for this Flow Step",o),a.errorSteps.push(b)}}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;var S=Object(Ke.a)(t,this._currentPageId);if(!Object(y.Gb)(S,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);var C=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(u.f)(this._currentPageId,C,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){var j=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(j,o)}return e(),a},e.prototype.setSelectedStage=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise((function(n,a){var i=m.a.tryParseOrNull(e);if(!i)return a("setSelectedStage can only be called with a valid stage id");var o={selectedStageId:i};r._updateBusinessProcessFlowData(r._currentBpfInstance,o),r._isUserSelectedStage=t,t&&r._executePostEvent("runOnStageSelected","setSelectedStage"),n()}))},e.prototype.setDisplayState=function(e){if(this._currentBpfInstance&&(e===c.a.collapsed||e===c.a.expanded||e===c.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);var t=new _e(m.a.toString(this._processId),m.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}},e.prototype.setActivePath=function(e){if(e&&0!==e.length){for(var t=[],r=0;r<e.length;r++)t[r]=new m.a(e[r]);var n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}},e.prototype.setBpfNavigationBehavior=function(e){var t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)},e.prototype.getBpfNavigationBehavior=function(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())},e.prototype.shouldReInitializeNavigationBehavior=function(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Ce.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))},e.prototype.getBpfNavigationBehaviorAllowCreateNew=function(e){var t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)},e.prototype.createWorkflowLogRecord=function(e){var t;if(Object(Ce.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");var r=this._getState();if(Object(Ce.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");var n=r.metadata;if(Object(Ce.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");var a=n.entities;if(Object(Ce.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");var i=this._currentBpfInstance.etn;if(Object(Ce.b)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");var o=a[i];if(Object(Ce.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");var s=o.EntitySetName;if(Object(Ce.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");var c=Object(De.z)(r,"workflowlog",o.EntityLogicalName,"asyncoperationid");if(Object(Ce.a)(c))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Ce.b)(c.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");var l=c.ReferencingEntityNavigationPropertyName+"@odata.bind",u="/"+s+"("+e.processInstanceid.guid+")",d=((t={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid})[l]=u,t.activityname=e.processDefinitionid.guid,t.status=e.status,t);Xrm.WebApi.createRecord("workflowlog",d)},e.prototype._getTracer=function(){return Object(Ce.a)(this._applicationContext)||Object(Ce.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")},e.prototype._getDefaultActivePath=function(){var e=this._getTracer();if(Object(Ce.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;var t=this._stageMetadata.getDefaultPathManager();if(Object(Ce.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;var r=t.getDefaultPath();if(Object(Ce.a)(r))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;var n=[];for(var a in r){var i=m.a.parse(r[a]);n.push(i)}return n},e.prototype._updateBusinessProcessFlowData=function(e,t){e&&(this._dispatch(Object(re.a)(t,e)),this._updateProcessInstanceModifiedTime())},e.prototype._updateDisplayState=function(e,t){this._dispatch(Object(ne.a)(t,e)),this._updateProcessInstanceModifiedTime()},e.prototype.getForwardNavigationEntities=function(e,t,r,n){var a=this;return this._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(O(e,t,r,n||null))}))},e.prototype.navigateToNextEntity=function(e,t,r,n){var a=this;return new Promise((function(i,o){var s=a.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return o(new K("Unable to navigate to next stage as required fields have not been set"));var c=a._stageMetadata.getNextStageId(a.getActiveStageId());if(!c)return o(new Q("Last stage in the active path reached. Next stage does not exist."));var l=new m.a(c),u=a.getTraversedPath()+","+c;return a._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(w(e,t,l,u,r,n))})).then((function(){return a.setSelectedStage(c)})).then((function(){a._executePostEvent("runOnStageChange","navigateToNextEntity",0),i()})).catch((function(e){a._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.navigateToNextEntityForCrossEntityBpf=function(e,t,r,n){var a=this;return new Promise((function(i,o){a._dispatch(w(e,t,new m.a(a.getActiveStageId()),a.getTraversedPath(),r,n)).then((function(){a._dispatch(Object(ie.b)(t,a._currentBpfInstance)),a._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),i()})).catch((function(e){a._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.getActiveStageActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.b)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceActiveFor=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceCompletedIn=function(){if(this._currentBpfInstance){var e=Object(C.d)(this._getState(),this._currentBpfInstance),t=Object(C.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null},e.prototype.getActionLogCollection=function(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null},e.prototype.getActionLog=function(e){var t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null},e.prototype.UpdateActionLog=function(e,t,r,n){if(!this._currentBpfInstance)return null;var i=Object(I.a)(this._getState(),this.getProcessInstanceId()),o=i&&i[e.guid]?i[e.guid]:null,s=(m.a.EMPTY,{actionLogId:Object(Ce.a)(n)||n===m.a.EMPTY?o?o.actionLogId:m.a.newGuid():n,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:r}),c=Object(a.__assign)({},i);c[e.guid]=s;var l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"},e.prototype.getEnabledProcesses=function(){var e=this,t=[];return new Promise((function(r,n){var a;e._currentFormEntity&&e._currentFormEntity.etn?e._dispatch((a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute:function(e,t){e.dispatch;var r=e.getState,n=t.DataSource.get_WebAPIService(),i=r(),o=m.a.tryParse(Object(N.i)(i)),s=new A(a,o),c=Object(F.a)(r(),s);return n.sendRequest(c).then((function(e){return e.json()}),g.b)}})).then((function(e){for(var n=0,a=e.value;n<a.length;n++){var i=a[n];t.push(new k(i.name,i.uniquename,i.workflowid))}r(t)}),(function(e){n(e)})):n(new g.a("Current Form Entity cannot be NULL",2147877745))}))},e.prototype.getNavigationEntities=function(){return this._activeStageManager.navigationEntities},e.prototype._getNavigationEntityIdsByEntityLogicalName=function(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName},e.prototype._updateGlobalActiveStage=function(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)},e.prototype._createGlobalNavigationData=function(e){var t=new R,r=Object(M.b)(e.activestageid);t.activeStageId=m.a.toString(r);var n=Object(M.c)(e.traversedpath);Object(Ce.b)(n)&&(n=L.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=n,t.navigationEntities=[];for(var a=0,i=this._getNavigationEntityTypesFromWorkflowObjectModel();a<i.length;a++){var o=i[a],s=new B;for(var c in s.entityLogicalName=o,s.id=m.a.EMPTY.guid,e)if(Object(M.k)(e[c])){var l=e[c],u=[];if(Object(Ce.a)(l.reference)||Object(Ce.a)(l.reference.etn))u.push({name:"entityReference.reference",value:"NULL"}),this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",u);l&&l.reference&&l.reference.etn===o&&(s.id=l.reference.id.guid)}t.navigationEntities.push(s)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(M.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(M.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(M.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(M.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(M.c)(e.bpfDefinitionVersioNumber)),t},e.prototype._getNavigationEntityTypesFromWorkflowObjectModel=function(){var e={};if(!Object(Ce.a)(this.getProcess()))for(var t=0;t<this.getProcess().get_Steps().get_Count();t++){var r=this.getProcess().get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){var n=r.get_Description();e[n]||(e[n]=n)}}return Object.keys(e)},e.prototype.reflow=function(e,t,r){var n=this._stageMetadata.getDefaultPathManager();if(t||r){if(t){t=new m.a(t).guid;var a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===t||a.indexOf(t)<0)&&(n.updateDefaultPath(t,r),this._updateProcessInstanceModifiedTime())}}else this._reflowInternal()},e.prototype._reflowInternal=function(e,t){var r=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(r.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())},e.prototype.callPblToEvaluateBranching=function(e){var t=this,r=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");var n=Object(ee.a)(r,this._currentPageId);this.getScriptContainerPromise().then((function(r){n<te.a.EditReady&&r.getEventManager().addOnLoadEvent(t.getContextToken(),(function(){r.execute(e,[])})),n>=te.a.OnLoadReady&&r.execute(e,[])}))},e.prototype.update=function(e){!Object(Ce.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()},e.prototype.waitForOngoingWork=function(){return Ze.a.getInstance().checkForOutstandingWork(this._getState())},e.prototype._getEventManager=function(){var e=this.getScriptContainer();return e?e.getEventManager():null},e.prototype.getScriptContainer=function(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;var e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e},e.prototype.getScriptContainerPromise=function(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")},e.prototype._executePostEvent=function(e,t,r,n){if(void 0===r&&(r=null),void 0===n&&(n=null),Object(We.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,r));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}},e.prototype.executePreEvent=function(e,t,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var a=!1;if(!Object(We.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),V.a[n],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,r))}return this._logTraceInfoForProcessPreEvent(a,e,t,t),a}return this._logTraceFailureForProcessEvent(t,e,e),a},e.prototype._saveFormDataAndActiveStage=function(e,t,r){var n=this,a=st.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),i=this.executePreEvent("runOnPreStageChange",r,t),o=Object(ge.c)(this._getState(),this.getCurrentFormEntity());if(!i){var s=new Promise((function(t,a){if(!e)return a(new X("Attemping to save invalid stage id"));for(var i,s,c=["traversedpath","activestageid","activestagestartedon","completedon"],l=n.getNavigationEntities(),u=Object(f.b)(n._getState(),n._currentBpfInstance),d=0,p=l;d<p.length;d++){var h=p[d];for(var m in u)if(m.includes(h.entityLogicalName)){c.push(m);break}}if(n._shouldPerformFormSave()){var b=n._getState();i=n._validateSnapshot(o).then((function(){return n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r)})).then((function(){return s=n._createActiveStageSnapshot(e),n._saveFormEntityAndBPFEntitySnapshots(s,o,!1)})).then((function(){var e=n.getCurrentFormEntity();n._dispatch(Object(rt.a)(n._currentPageId,b,n.getContextToken(),e.etn,e.id))})).catch((function(e){var t=Object(g.c)(e);return n._handleDuplicateDetection(t,s)}))}else i=n._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(r).then((function(){return s=n._createActiveStageSnapshot(e),n._dispatch(Object(le.c)(s,!0,c,n._getRetrieveProcessControlDataRequest())).then((function(){n._dispatch(Object(ue.a)(n._currentPageId,n.getCurrentFormEntity(),n._getColumnsToRefresh(),n._getRetrieveProcessControlDataRequest())),n._dispatch(Object(S.b)(!0,n._currentFormEntity))}))}));t(i)})).then((function(){var e=n.getTraversedPath(),a=n.getActiveStageId();n._updateGlobalActiveStage(e,a),n.setSelectedStage(a),n._executePostEvent("runOnStageChange",r,t)}),(function(e){throw n._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}));return s.then(c,c),s}function c(){a()}},e.prototype._handleDuplicateDetection=function(e,t){var r=this;if(Object(tt.e)(e))return this._dispatch(Object($e.a)(this._currentPageId,e,this._currentFormEntity)).then((function(e){return 0===e.status?r._dispatch(Object(et.a)(e.pageId)).then((function(e){return e.value.param_lastButtonClicked===u.a?Promise.resolve("success"):Promise.resolve("aborted")})):Promise.resolve("noop")})).then((function(e){if("success"===e){var n=Object(ge.c)(r._getState(),r.getCurrentFormEntity());return r._saveFormEntityAndBPFEntitySnapshots(t,n,!0)}}));throw e},e.prototype._saveFormEntityAndBPFEntitySnapshots=function(e,t,r){var n={};n[t.identifier.etn]=this._getColumnsToRefresh();var a=null;return a=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(le.d)(a,r,n,this._getRetrieveProcessControlDataRequest()))},e.prototype._logTraceInfoForProcessPreEvent=function(e,t,r,n){var a=this._applicationContext.TraceManager.getTracer(n),i=this.getTelemetryParams(),o={name:"BpfOperationName",value:r};i.push(o);var s={name:"eventName",value:t};i.push(s);var c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+t,i)},e.prototype._logTraceFailureForProcessEvent=function(e,t,r){var n=this._applicationContext.TraceManager.getTracer(r),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});var o={name:"eventName",value:t};a.push(o);var s={name:"isPageDead",value:Object(We.n)(this._getState(),this._currentPageId)};a.push(s);var c={name:"currentPageId",value:this._currentPageId};a.push(c),n.error("BPF ProcessManager not able to to execute scripts registered on event "+t+" does not exist",a)},e.prototype._logTraceFailureForScriptContainer=function(){var e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});var r={name:"IsPageDead",value:Object(We.n)(this._getState(),this._currentPageId)};t.push(r);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)},e.prototype._getStage=function(e){var t=this,r=null;if(e){var n=this.getEntityStages();n&&n.some((function(n){for(var a=0;a<n.get_Steps().get_Count();a++){var i=n.get_Steps().get_item(a);if(t._equalsIgnoreCase(e,i.get_Id()))return r=i,!0}}))}return r},e.prototype.getContextToken=function(){return Object(he.j)(this._getState(),this._currentPageId)},e.prototype._updateProcessInstanceModifiedTime=function(){this._dispatch(Object(ae.b)(this.getCurrentFormEntity()))},e.prototype._isSelectedStageControl=function(e){if(!Object(Ce.a)(this.getSelectedStage()))for(var t=this.getSelectedStage().get_Steps(),r=0;r<t.get_Count();r++)if(this._equalsIgnoreCase(t.get_item(r).get_Id(),e))return!0;return!1},e.prototype._equalsIgnoreCase=function(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()},e.prototype._getSnapshotStateTelemetryParams=function(e){var t=[];if(Object(Ce.a)(e))return t;var r={name:"mode",value:e.mode},n={name:"identifierId",value:Object(Ce.a)(e.identifier)||Object(Ce.a)(e.identifier.id)?null:m.a.toString(e.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(Ce.a)(a)?null:m.a.fromLegacyGuid(a.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(Ce.a)(a)?null:a.get_objectTypeCode()},s={name:"activeChanges",value:Object(Ce.a)(a)?null:this._getIFieldValuesString(e.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(Ce.a)(a)?null:this._getIFieldValuesString(e.lockedChanges,a.get_logicalName())};return t.push(r),t.push(i),t.push(o),t.push(n),t.push(s),t.push(c),t},e.prototype._getTelemetryParamsForActionStep=function(e,t,r){var n=this.getTelemetryParams(),a={name:"ActionStepType",value:e},i={name:"ControlId",value:t},o={name:"ActionStepId",value:r};return n.push(a),n.push(i),n.push(o),n},e.prototype.getTelemetryParams=function(){var e=[];try{var t={name:"ProcessId",value:m.a.toString(this.getProcessId())},r={name:"ProcessInstanceId",value:m.a.toString(this.getProcessInstanceId())},n={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?m.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},p={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},h={name:"SavedPageId",value:this._savedPageId},g={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Be.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var f={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},b={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(f),e.push(b)}var v={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(r),e.push(n),e.push(i),e.push(o),e.push(a),e.push(c),e.push(l),e.push(u),e.push(d),e.push(p),e.push(h),e.push(g),e.push(v)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e},e.prototype._getIFieldValuesString=function(e,t){var r="";if(!Object(Ce.a)(e))for(var n in e)if(Object(Ce.a)(n))r+=String.format("[fieldName: {0}]",null);else{var a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,n),i=e[n];if(Object(Ce.a)(i)||Object(Ce.a)(a))r+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Ce.a)(i),Object(Ce.a)(a));else{var o="";Object(Ce.a)(i.timestamp)||(o=i.timestamp.toUTCString());var s="",c="",l=null,u=null;Object(Ce.a)(i.validationResult)||(s=i.validationResult.errorId,c=i.validationResult.errorMessage,l=i.validationResult.isOfflineSyncError,u=i.validationResult.isValueValid);var d=a.get_id();r+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",d,o,s,c,l,u)}}return r},e.prototype._getActivePathString=function(){var e=this.getActivePath(),t="";if(e&&e.length>0){for(var r=0;r<e.length-1;r++)t=t+e[r].guid+",";t+=e[e.length-1].guid}return t},e.prototype.isImmersiveBPF=function(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn},e.prototype._getColumnsToRefresh=function(){var e=Object(Ye.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ce.a)(t)){var r=Object(ge.c)(this._getState(),this.getCurrentFormEntity()),n=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),a=this._getSnapshotStateTelemetryParams(r);return n.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",a),[]}var i=Object(De.E)(this._getState(),t.entityTypeName),o=Object(u.g)(this._getState(),e,t,i,null);return o&&o.hasOwnProperty(t.entityTypeName)?o[t.entityTypeName]:[]},e.prototype._getRetrieveProcessControlDataRequest=function(){var e=this.getProcessId()&&!m.a.equals(this.getProcessId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!m.a.equals(this.getProcessInstanceId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new qe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new qe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null},e.prototype.getCustomControlIndicator=function(){return this._customControlsPresent},e.prototype.setCustomControlIndicator=function(e){this._customControlsPresent=e},e.prototype.getFormXmlRenderingIndicator=function(){return this._renderedFromFormXml},e.prototype.setFormXmlRenderingIndicator=function(e){this._renderedFromFormXml=e},e.prototype.getInstanceModifiedTimestamp=function(){return this._instanceModifiedTimestamp},e.prototype.isBpfFormDescriptorValid=function(e,t,r,n){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Je.f)(e,t,r,n)),this._isBpfFormValid},e.prototype._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure=function(e,t){var r=t;if(Object(Ce.a)(t)){var n=Object(g.c)(e);r=!Object(Ce.a)(n)&&n.FaultedSnapshotId}!Object(Ce.b)(r)&&this._dispatch(Object(ce.b)(r,!1));var a=Object(ge.c)(this._getState(),this.getCurrentFormEntity());a&&!Object(Ce.a)(a.snapshotId)&&a.snapshotId!==r&&this._dispatch(Object(ce.b)(a.snapshotId,!1))},e}()},"4Q7K":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="dataset.set.newPageRequested";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.y)(t),o=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i,dataSetContextKey:o}}}},"52Se":function(e,t,r){"use strict";r.d(t,"a",(function(){return Ot}));var n,a=r("c/eZ"),i=r("7z0H"),o=r("9r0m"),s=r("Qeyq"),c=r("s0Zj"),l=r("ksD2"),u=r("A8fJ"),d=r("PLtI"),p=r("ASFs"),h=Object(p.d)(((n={})[c.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{collapsed:t.payload})},n[l.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},n[u.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{contentType:t.payload})},n[d.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload})},n),{collapsed:!1,visible:!0,label:"",sectionNames:[],domId:null,showLabel:!0,contentType:"cardSections"});var g,m=r("JCHT"),f=r("OmYs"),b=Object(p.d)(((g={})[m.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},g[f.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload})},g),{parentTabId:null,visible:!0,label:"",controlNames:[],domId:null,semanticZoomDomId:null});var v,y=r("l9yF"),_=r("LteD"),O=r("jT7O"),S=r("kr+h"),C=r("QItn"),I=r("hE7j"),j=r("Q60c"),P=r("n1Ju"),T=r("slAZ"),E=r("tNVD"),w=r("x6Ak");var F=Object(p.d)(((v={})[_.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})},v[O.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{label:t.payload,labelSource:y.a.ClientAPI})},v[S.a]=function(e,t){return null!==t.payload?Object(a.__assign)(Object(a.__assign)({},e),{disabledByClientApi:t.payload}):e},v[I.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.parameters),t.payload);return Object(a.__assign)(Object(a.__assign)({},e),{parameters:r})},v[j.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.parameters),{defaultviewid:t.payload});return Object(a.__assign)(Object(a.__assign)({},e),{parameters:r})},v[E.a]=function(e,t){var r=Object(a.__assign)(Object(a.__assign)({},e.views),t.payload.views);return Object(a.__assign)(Object(a.__assign)({},e),{views:r})},v[T.a]=function(e,t){for(var r=e.customFilter?e.customFilter:[],n=r.length-1;n>=0;n--)if(r[n].entityLogicalName===t.payload.entityLogicalName){if(r[n].customFilter===t.payload.customFilter)return e;break}return r.push(t.payload),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[T.c]=function(e,t){var r=[];return r.push({customFilter:"START_FLAG",entityLogicalName:""}),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[T.b]=function(e,t){var r=e.customFilter?e.customFilter:[];if(r.length>0&&"END_FLAG"===r[r.length-1].customFilter)return e;return r.push({customFilter:"END_FLAG",entityLogicalName:""}),Object(a.__assign)(Object(a.__assign)({},e),{customFilter:r})},v[P.a]=function(e,t){if(t.payload)return Object(a.__assign)(Object(a.__assign)({},e),{notifications:Object(a.__assign)(Object(a.__assign)({},e.notifications),t.payload)});return Object(a.__assign)(Object(a.__assign)({},e),{notifications:t.payload})},v[C.a]=function(e,t){var r=[].concat(e.parameters),n=e;null!==t.payload&&(r.DisableMru=t.payload?"true":"false",n=Object(a.__assign)(Object(a.__assign)({},n),{parameters:r}));return n},v[w.a]=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return Object(a.__assign)({},e)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,v[E.d]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{initializationIntent:t.payload})},v),{parentSectionName:null,visible:!0,label:"",valid:!0,domId:null,notifications:null,dataFieldName:null});var x,A=r("c7nC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e,t,r){var n=Object(a.__assign)({},e),i=Object.keys(n).length,o={};return r?(n.hasOwnProperty(t)&&delete n[t],Object(a.__assign)({},n)):i>0?n.hasOwnProperty(t)?n:(o[t]=!0,Object(a.__assign)(Object(a.__assign)({},e),o)):(o[t]=!0,o)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var D=Object(p.d)(((x={})[A.a]=function(e,t){return Object(a.__assign)({},N(e,t.meta.controlName,t.payload.isValid))},x),{});var k,M=r("3NtJ"),R=r("fTYK"),L=r("VlhU"),B=r("c3W+"),V=r("UOUy"),G=r("0MLN"),U=r("EGdP"),z=r("zvr0"),q=Object(p.d)(((k={})[z.a]=function(e,t){return Object(a.__assign)({},t.payload.controlUnboundOutputs)},k),{});var X,W=r("n4BT"),H=r("enCe"),Q=r("+ulc"),Y=r("hCnb"),K=Object(p.d)(((X={})[Y.a]=function(e,t){return Object(a.__assign)({},N(e,t.meta.attributeName,t.payload.isValid))},X),{});var J=r("lwSE"),Z=r("SdPQ"),$=r("e2rP"),ee=r("uCYK");var te={tabs:Object(p.b)("tabId",h),sections:Object(p.b)("sectionName",b),controls:Object(p.b)("controlName",F),selectedTab:function(e,t){if(void 0===e&&(e=Object(s.a)()),t.type===R.a){if(e.navigationStack&&e.navigationStack.length>0)return Object(a.__assign)(Object(a.__assign)({},e),{tabId:e.navigationStack[e.navigationStack.length-1],navigationStack:e.navigationStack.slice(0,e.navigationStack.length-1)})}else if(t.type===M.a){var r=(e.navigationStack||[]).slice(0);return e.tabId&&e.tabId!==t.payload&&r.push(e.tabId),Object(a.__assign)(Object(a.__assign)({},e),{tabId:t.payload,navigationStack:r})}return e},selectedRelatedEntity:function(e,t){return void 0===e&&(e=null),t.type===L.a?t.payload:e},xrmReady:function(e,t){return void 0===e&&(e=!1),t.type===i.b?t.payload.xrmReady:e},isSaving:function(e,t){return void 0===e&&(e=!1),t.type===B.a?t.payload.savingState:e},controlUnboundOutputs:q,inlineQuickForms:function(e,t){return void 0===e&&(e=null),t.type===i.a?t.payload.formUIState.inlineQuickForms:e},invalidControls:D,invalidAttributes:K,label:function(e,t){return void 0===e&&(e=""),t.type===G.a?t.payload.label:e},hasOfflineChanges:function(e,t){return void 0===e&&(e=!1),t.type===V.a?t.payload.hasOfflineChanges:e},viewportWidth:function(e,t){return void 0===e&&(e=0),t.type===W.a?t.payload.viewportWidth:e},viewportHeight:function(e,t){return void 0===e&&(e=0),t.type===W.a?t.payload.viewportHeight:e},formId:function(e,t){return void 0===e&&(e=o.a.EMPTY),e},showHeaderFieldsInSection:function(e,t){return void 0===e&&(e=!1),t.type===H.a?t.payload.showHeaderFieldsInSection:e},headerFieldsInFlyout:function(e,t){if(t.type===Q.a){for(var r=new Set,n=t.payload.headerFieldsInFlyout,a=0;a<n.length;a++)r.add(n[a].Name);return r}return e},isAutoSaving:function(e,t){return void 0===e&&(e=!1),t.type===U.a?t.payload.isAutoSaving:e},header:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0}),t.type){case Z.a:return Object(a.__assign)(Object(a.__assign)({},e),{bodyVisible:t.payload});case $.a:return Object(a.__assign)(Object(a.__assign)({},e),{commandBarVisible:t.payload});case J.a:return Object(a.__assign)(Object(a.__assign)({},e),{tabNavigatorVisible:t.payload})}return e},footer:function(e,t){switch(void 0===e&&(e=null),null==e&&(e={visible:!0}),t.type){case ee.a:return Object(a.__assign)(Object(a.__assign)({},e),{visible:t.payload})}return e},formScrollAndFocusState:function(e,t){return t.type===E.e?t.payload:e}},re=Object(p.a)(te),ne=Object(p.b)("contextKey",re),ae=r("g24L"),ie=r("kk/C"),oe=r("d/U0");var se,ce={snapshotId:ae.a,updatedFields:
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(t.type===ie.a){var r={},n=t.payload.fieldValues;if(!n)return e;for(var i in n)e&&e.hasOwnProperty(i)||(r[i]=n[i]);return Object.keys(r).length>0?Object(a.__assign)(Object(a.__assign)({},e),r):e}if(t.type===ie.b){r={};if(t.payload.keepFields)for(var o=0,s=t.payload.keepFields;o<s.length;o++){e[i=s[o]]&&(r[i]=e[i])}return r}return e},isDeleted:function(e,t){return void 0===e&&(e=!1),t.type===oe.a?t.payload:e}},le=Object(p.a)(ce),ue=Object(p.b)("contextKey",le),de=r("/wtJ"),pe=r("FuJ2"),he=r("ABRM"),ge=r("YdIa"),me=r("JFej"),fe=r("Ini7"),be=r("FGem"),ve=r("E0SJ"),ye=r("NuVc"),_e=r("xirW"),Oe=Object(p.d)(((se={})[de.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Precision:t.payload,PrecisionSource:ye.a.attribute})},se[pe.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{RequiredLevel:t.payload})},se[he.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Format:t.payload})},se[ge.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{Targets:t.payload})},se[me.a]=function(e,t){var r=e.OptionSet,n=t.payload.option;if(!r||!n)return e;var i=t.payload.index;r=r.slice(0),i>=0&&i<r.length?r.splice(i,0,n):r.push(n);return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r})},se[fe.a]=function(e,t){var r=e.OptionSet;if(!r)return e;var n=t.payload;r=r.slice(0);for(var i=0;i<r.length;i++)if(r[i].Value===n)return r.splice(i,1),Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r});return e},se[be.a]=function(e,t){if(!e.OptionSet)return e;return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:[]})},se[ve.a]=function(e,t){if(!e.OptionSet)return e;var r=t.payload;return Object(a.__assign)(Object(a.__assign)({},e),{OptionSet:r||[]})},se[_e.a]=function(e,t){if(t.payload)return Object(a.__assign)(Object(a.__assign)({},e),{notifications:Object(a.__assign)(Object(a.__assign)({},e.notifications),t.payload)});return Object(a.__assign)(Object(a.__assign)({},e),{notifications:t.payload})},se),{Precision:null,PrecisionSource:null,RequiredLevel:null,Format:null,OptionSet:null,IsValidForCreate:null,IsValidForUpdate:null,notifications:null,Targets:null});var Se,Ce=r("5jMY"),Ie=r("o0+l"),je=Object(p.d)(((Se={})[Ie.a]=function(e,t){var r;if(t.payload===Ce.a.Dirty){var n={};if(t.meta.dataFieldName&&Object.keys(e).lastIndexOf(t.meta.dataFieldName)>-1){for(var i=0,o=Object.keys(e);i<o.length;i++){var s=o[i];s!==t.meta.dataFieldName&&(n[s]=e[s])}return Object.freeze(n)}return e}return Object(a.__assign)(Object(a.__assign)({},e),((r={})[t.meta.dataFieldName]=t.payload,r))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Se),{});var Pe,Te={attributes:Object(p.b)("dataFieldName",Oe),submitModes:je},Ee=Object(p.a)(Te),we=Object(p.b)("contextKey",Ee),Fe=r("LFYt"),xe=r("Uhhf"),Ae=Object(p.d)(((Pe={})[Fe.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{value:t.payload.value})},Pe[xe.a]=function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{value:t.payload.value})},Pe),{reason:"",value:""});var Ne,De=r("rQCE"),ke=r("LiB6"),Me=r("dWLV"),Re=r("PhZR"),Le=r("YOvo"),Be=r("VQYK");var Ve=Object(p.d)(((Ne={})[Re.a]=function(e,t){var r=Object(a.__assign)({},e);return Ge(r,t.payload.label,t.payload.currentLanguageId),r.labelSetByClientAPI=!0,Object.freeze(r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */,Ne[Le.a]=function(e,t){var r=t.payload;return Object.freeze(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e),r),{showSetByClientAPI:!0}))},Ne),{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""});function Ge(e,t,r){var n=Object(Be.b)(e,r);if(n)n.Value=t;else{var a=null===r?"":r.toString();e.titles[""]={Name:a,Value:t}}return e}var Ue=Object(p.d)({},{}),ze=Object(p.d)({},{}),qe=Object(p.d)({},{}),Xe=r("jWor"),We=Object(p.b)("navigationItemId",Ve);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var He,Qe={navBarAreas:Ue,navPaneIsvItems:ze,navBarByRelationshipItems:function(e,t){if(t.type===Xe.a){if(t.payload.allNavBarByRelationshipItems&&t.payload.allNavBarByRelationshipItems.length>0){var r=Object(a.__assign)({},e);return t.payload.allNavBarByRelationshipItems.forEach((function(e){e&&e.id&&(r[e.id]||(r[e.id]=Object(a.__assign)(Object(a.__assign)({},{titles:{},tooltipTitles:{},privileges:[],relationshipName:"",id:"",area:"",titleResourceId:"",client:"",availableOffline:!1,icon:"",sequence:"",show:!0,viewId:""}),{id:e.id})),Ge(r[e.id],e.title,t.payload.currentLanguageId))})),Object.freeze(r)}return e}return We(e,t)},navBarItems:qe},Ye=Object(p.a)(Qe),Ke=r("+ieV"),Je=r("2p2B"),Ze=Object(p.d)(((He={})[Ke.a]=function(e,t){var r,n={Message:t.payload.message,Level:t.payload.level,UniqueId:t.payload.uniqueId,Buttons:t.payload.buttons,MessagePlaceholders:t.payload.placeholders,ControlName:t.payload.controlName,ComponentId:t.payload.componentId};return Object(a.__assign)(Object(a.__assign)({},e),((r={})[t.payload.uniqueId]=n,r))},He[Je.a]=function(e,t){if(Object.keys(e).length<1)return e;var r={};if(t.payload.uniqueId)for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];i!==t.payload.uniqueId&&(r[i]=e[i])}return r},He),{});var $e,et=r("KbPJ"),tt=r("/CqC"),rt=Object(p.d)((($e={})[et.a]=function(e,t){if(t.type===et.a)return Object(a.__assign)(Object(a.__assign)({},e),t.payload);return e},$e[tt.a]=function(e,t){var r=Object(a.__assign)({},e);return delete r[t.payload.relationship],Object.freeze(r)},$e),{});var nt=r("NWJ/"),at=r("I6xF"),it=r("+hGu"),ot=r("ApiM"),st=r("NfcN"),ct=r("VHYb"),lt=r("bCrZ"),ut=r("UOiB"),dt=r("Sscr"),pt=r("oUmu"),ht=r("Axwz"),gt=r("vm7t"),mt=r("gRWC"),ft={selectedFormId:null,forms:{}},bt=r("Gt1u"),vt=r("9KTg");var yt=r("bhC+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _t=Object(p.a)({loadingState:function(e,t){return void 0===e&&(e=De.a.Initial),t.type===nt.a?t.payload:e},formId:function(e,t){return void 0===e&&(e=null),t.type===i.a?t.payload.formId:e},navigation:Ye,notifications:Ze,powerBISignedInState:function(e,t){return void 0===e&&(e="NotSignedIn"),t.type===at.a?t.payload:e},suppressDuplicateDetection:function(e,t){return void 0===e&&(e=!1),t.type===it.a?t.payload.suppressDuplicateDetection:e},customDataProviderOutputs:ke.a,formlessControlOutputs:Me.a,output:Ae,datasets:ct.a,metadata:we,records:ue,forms:ne,entityReferenceByRelationship:rt,referenceInformationByRelationship:function(e,t){return void 0===e&&(e={}),t.type===st.a?t.payload:e},primaryEntity:function(e,t){return void 0===e&&(e=""),"set.primary.entity"===t.type?t.payload:e},visitedTabNames:function(e,t){if(void 0===e&&(e=null),t.type===ht.a){var r=t.payload;if(!e)return r?new Set([r]):null;if(!r||e.has(r))return new Set(e);var n=new Set(e);return n.add(r),n}return e},autoSaveInterval:function(e,t){return void 0===e&&(e=gt.a),t.type===gt.d?e=gt.a:t.type===gt.b&&e<gt.c&&(e+=gt.a),e},formInstances:function(e,t){var r,n;if(void 0===e&&(e={list:[],formInstanceIdByControlName:{},controlNameByFormInstanceId:{}}),t.type===E.b){var i=t.payload.formInstanceId,o=t.payload.controlName,s=Object(a.__spreadArrays)(e.list,[i]),c=Object(a.__assign)(Object(a.__assign)({},e.formInstanceIdByControlName),((r={})[o]=i,r)),l=Object(a.__assign)(Object(a.__assign)({},e.controlNameByFormInstanceId),((n={})[i]=o,n));e=Object(a.__assign)(Object(a.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}else if(t.type===E.g){var u=t.payload.formInstanceId;o=t.payload.controlName,s=e.list.filter((function(e){return e!==u}));if(e.formInstanceIdByControlName[o]&&e.controlNameByFormInstanceId[u]){var d=o,p=e.formInstanceIdByControlName,h=d,g=(p[h],c=Object(a.__rest)(p,["symbol"==typeof h?h:h+""]),u),m=e.controlNameByFormInstanceId,f=g;m[f],l=Object(a.__rest)(m,["symbol"==typeof f?f:f+""]);e=Object(a.__assign)(Object(a.__assign)({},e),{list:s,formInstanceIdByControlName:c,controlNameByFormInstanceId:l})}}return e},formSelector:function(e,t){var r;return void 0===e&&(e=ft),t.type===mt.a?Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(r={},r[t.meta.formId]={visible:t.payload.visible},r))}):t.type===yt.a?Object(a.__assign)(Object(a.__assign)({},e),{selectedFormId:t.payload.formId}):e},parentComponentId:function(e,t){return void 0===e&&(e=""),t.type===E.c?t.payload.parentComponentId:e},referencePanel:function(e,t){switch(void 0===e&&(e={sessionTabs:[],controlNames:[],activeTabId:"",messageId:""}),t.type){case vt.a:return t.payload.messageId?Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId,messageId:t.payload.messageId})):Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case vt.d:case vt.c:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,activeTabId:t.payload.activeTabId}));case vt.e:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{messageId:t.payload.messageId}));case vt.g:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs,controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case vt.f:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{controlNames:t.payload.controlNames,activeTabId:t.payload.activeTabId}));case vt.b:return Object.freeze({sessionTabs:[],controlNames:[],activeTabId:"",messageId:""});case vt.h:return Object.freeze(Object(a.__assign)(Object(a.__assign)({},e),{sessionTabs:t.payload.sessionTabs}));default:return e}},formLoadError:function(e,t){return void 0===e&&(e=null),t.type===bt.a?t.payload.error:e}});function Ot(e,t){var r,n,o,s,c,l,u;if(void 0===e){var d=_t(e,t);return Object.freeze(d)}if(t.type===i.a){var p=t.meta.contextToken,h=St(P=Object(dt.v)(p)),g=e.forms[P],m=S=e.metadata;t.payload.relatedEntityMetadataState&&(m=Object.assign.apply(Object,Object(a.__spreadArrays)([{},m],[t.payload.relatedEntityMetadataState])));var f=Object(a.__assign)(Object(a.__assign)({},e.forms),((r={})[P]=Object(a.__assign)(Object(a.__assign)({},g),t.payload.formUIState),r));m=Object(a.__assign)(Object(a.__assign)({},m),((n={})[P]=Object(a.__assign)(Object(a.__assign)({},m[P]),t.payload.formMetadataState),n));var b=Object(a.__assign)(Object(a.__assign)({},e.navigation),f&&p.contextTokenType===ut.a.MainForm?f[P].navigation:e.navigation);if(b.navBarByRelationshipItems){var v=b.navBarByRelationshipItems;b.navBarByRelationshipItems={};for(var y=Object.keys(v),_=0;_<y.length;_++){var O=y[_];b.navBarByRelationshipItems[O]=Object(Be.a)(v[O],t.payload.currentLanguageId)}}u=Object(a.__assign)(Object(a.__assign)({},e),{formId:t.payload.formId,forms:f,metadata:m,records:h,powerBISignedInState:"NotSignedIn",suppressDuplicateDetection:!1,navigation:b})}else if(t.type===ot.a&&e.metadata[t.meta.contextKey]){var S=e.metadata[t.meta.contextKey];u=Object(a.__assign)(Object(a.__assign)({},e),{metadata:Object(a.__assign)(Object(a.__assign)({},e.metadata),(o={},o[t.meta.contextKey]=Object(a.__assign)(Object(a.__assign)({},S),{attributes:Object(a.__assign)(Object(a.__assign)({},null==S?void 0:S.attributes),t.payload.attributes)}),o))})}else if(t.type===ot.b){var C=e.forms[t.meta.contextKey];u=Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(s={},s[t.meta.contextKey]=Object(a.__assign)(Object(a.__assign)({},C),{controls:Object(a.__assign)(Object(a.__assign)({},e.forms[t.meta.contextKey].controls),t.payload.controls)}),s))})}else if(t.type===lt.a){var I=t.payload,j=Object(a.__assign)(Object(a.__assign)({},e.datasets),((c={})[I.contextKey]=I.initialDataSetState,c));u=Object(a.__assign)(Object(a.__assign)({},e),{datasets:j})}else if(t.type===pt.a){p=t.meta.contextToken;var P=Object(dt.v)(p),T=(C=e.forms[P],Object(a.__assign)({},C)),w=C.selectedTab.tabId;if(!t.payload.formUIState.tabs[w]){var F=C.tabs[w];if(F){var x=F.domId,A=void 0;for(var N in t.payload.formUIState.tabs){if(t.payload.formUIState.tabs[N].domId===x){A=N;break}}C.selectedTab.tabId=A||""}}T.controls=t.payload.formUIState.controls,T.sections=t.payload.formUIState.sections,T.tabs=t.payload.formUIState.tabs,T.label=t.payload.formUIState.label,T.inlineQuickForms=t.payload.formUIState.inlineQuickForms,u=Object(a.__assign)(Object(a.__assign)({},e),{forms:Object(a.__assign)(Object(a.__assign)({},e.forms),(l={},l[P]=T,l))})}else if(t.type===E.h){p=t.meta.contextToken,h=St(P=Object(dt.v)(p));u=Object(a.__assign)(Object(a.__assign)({},e),{records:h})}else u=_t(e,t);return Object.freeze(u)}function St(e){var t;return(t={})[e]={snapshotId:"",isDeleted:!1},t}},"5cS+":function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return p}));var n=r("c/eZ"),a=r("9r0m"),i=r("gBKR"),o=r("r2h9"),s=r("/j9Z"),c=r("olrR"),l=r("uO/V"),u=r("/45f"),d=r("Gemh");function p(e,t,r){return{type:"datasethost.dependencies.retrieve.async",execute:function(p,g){var m=p.dispatch,f=p.getState,b=g.TraceManager.getTracer(l.z),v=l.x+".loadDataSetHostDependenciesAction";b.info("Retrieving view with ID "+a.a.toString(t)+" for "+e+" entity.");var y=Object(d.pb)(f(),e,t);return m(Object(c.a)(e,o.a.MAIN_APPLICATION_VIEW,y,t)).then((function(o){if(!o){var c="Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID "+a.a.toString(t)+" for "+e;return g.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.b))}var l=h(f(),t,r);return m(Object(i.e)(l)).then((function(){var r=[{name:"entityTypeName",value:e},{name:"viewId",value:a.a.toString(t)}];return g.EventManager.ReportComponentSuccess(v,r),Promise.resolve()})).catch((function(r){var i=[];for(var o in l)l[o].length&&(i=Object(n.__spreadArrays)(l[o],i));var c="Unable to retrieve DataSetHost dependencies for the grid for view with ID "+a.a.toString(t)+". Failed to retrieve entity with attributes "+i.join()+" for "+e;return g.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.a))}))}))}}}function h(e,t,r){var n=Object(d.qb)(e,t,r),a={};if(n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells){var i=[];n.grid.rows[0].cells.forEach((function(e){if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){var t=e.name.split(".")[1];a[e.relatedEntityName]||(a[e.relatedEntityName]=[]),-1===a[e.relatedEntityName].indexOf(t)&&t&&a[e.relatedEntityName].push(t)}}else-1===i.indexOf(e.name)&&i.push(e.name)})),i.length>0&&(a[n.entityLogicalName]=i)}return a}},"7bez":function(e,t,r){"use strict";r.d(t,"a",(function(){return F})),r.d(t,"b",(function(){return x}));var n,a,i=r("1z64"),o=r("sOTk"),s=r("/zIU"),c=r("PZxu"),l=r("9r0m"),u=r("Wye+"),d=r("+Z9T"),p=r("Gemh"),h=r("IiPO"),g=r("HSdq"),m=r("/j9Z"),f=r("Sscr"),b=r("ezfI"),v=r("kvLG"),y=function(){function e(e,t,r,a,o){this._pageId=r,n=e,this._contextToken=t,this._controlName=a,this._gridType=o,this._clientApiExecutor=new i.a(e,"ClientApi.XrmViewSelector.",r,t,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:o,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}return e.prototype.setCurrentView=function(e){var t=this;this._clientApiExecutor.executeAsync("setCurrentView",(function(r,a){return e&&e.id?n.dispatch(Object(u.a)(t._pageId,t._contextToken,t._controlName,e.id)):(a.push({name:"validationError",value:"true"}),v.a.getInstance().traceManager.getTracer(r).error("View ID is required",a),Promise.resolve())}))},e.prototype.getCurrentView=function(){var e="ClientApi.XrmViewSelector.getCurrentView";try{b.a.instance.reportCall(e);var t=Object(p.hb)(n.getState(),this._pageId,this._contextToken,this._controlName),r=null,a=null;if(t)a=t.ViewId;else if(3===this._gridType){var i={id:this._pageId},o=Object(g.fb)(n.getState(),i,this._contextToken.parentContextToken);if(!(o&&o.Controls&&o.Controls[this._controlName]&&o.Controls[this._controlName].Parameters&&o.Controls[this._controlName].Parameters.ViewId)){var s=void 0;return o?o.Controls?o.Controls[this._controlName]?o.Controls[this._controlName].Parameters?o.Controls[this._controlName].Parameters.ViewId||(s="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):s="formDescriptor.Controls[this._controlName].Parameters is null or undefined":s="formDescriptor.Controls[this._controlName] is null or undefined":s="formDescriptor.Controls is null or undefined":s="formDescriptor is null or undefined",(v=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a(s),null,v),null}a=o.Controls[this._controlName].Parameters.ViewId}if(a){if(r=Object(p.qb)(n.getState(),l.a.parse(a),this._pageId)){var c={entityType:Object(p.ob)(n.getState(),a,this._pageId),id:l.a.externalGuid(r.viewId),name:r.title};return b.a.instance.reportSuccess(e),c}var u=[];return u.push({name:"controlName",value:this._controlName}),u.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,u),null}var d=[];return d.push({name:"controlName",value:this._controlName}),d.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),h.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,d),null}catch(t){var v;throw(v=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,v),t}},e.prototype.isVisible=function(){var e="ClientApi.XrmViewSelector.isVisible";try{if(b.a.instance.reportCall(e),Object(d.a)(this._isVisible)){var t=Object(p.hb)(n.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{var r={id:this._pageId},a=Object(g.fb)(n.getState(),r,this._contextToken.parentContextToken);if(!(a&&a.Controls&&a.Controls[this._controlName]&&a.Controls[this._controlName].Parameters&&a.Controls[this._controlName].Parameters.EnableViewPicker))return(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,new m.a("FormDescriptor is null"),null,i),!1;this._isVisible=a.Controls[this._controlName].Parameters.EnableViewPicker}}return b.a.instance.reportSuccess(e),this._isVisible}catch(t){var i;throw(i=h.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e}(),_=r("h82J"),O=r("fW82"),S=r("tcXs"),C=r("Cgjg"),I=r("lMVv"),j=r("r2h9"),P=r("gLMt"),T=r("qC0c"),E=r("cZkS"),w=r("Ka9P"),F=function(){function e(e,t,r,n,o,s,c,l){this._relationship=null;var u="ClientApi.XrmGridControl.constructor";e||Object(d.j)(u,"store"),t||Object(d.j)(u,"contextToken"),r||Object(d.j)(u,"pageId"),a=e,this._pageId=r,this._contextToken=t,this._controlName=l,this._isEditable=n,this._gridType=o,this._applicationContext=c,s||a.dispatch(Object(_.a)(this,r,t)),this._clientApiExecutor=new i.a(e,"ClientApi.XrmGridControl.",r,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:l,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:n,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:o,isEventParam:!0})}return Object.defineProperty(e.prototype,"_connectedControlProps",{get:function(){return{controlName:this._controlName,id:this._pageId}},enumerable:!1,configurable:!0}),e.prototype.setFilterXml=function(e){var t=this;this._clientApiExecutor.executeAsync("setFilterXml",(function(){var r=(new Date).getTime();return a.dispatch(Object(C.b)(e,1,t._pageId,t._contextToken,r))}))},e.prototype.getFilterXml=function(){var e="ClientApi.XrmGridControl.getFilterXml";try{b.a.instance.reportCall(e);var t=Object(p.u)(a.getState(),this._pageId,this._contextToken);return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFetchXml=function(){var e="ClientApi.XrmGridControl.getFetchXml";try{b.a.instance.reportCall(e);var t=Object(p.A)(a.getState(),this._contextToken,{id:this._pageId});return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getGrid=function(){var e="ClientApi.XrmGridControl.getGrid";try{return b.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new c.a(a,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),b.a.instance.reportSuccess(e),this._grid}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getViewSelector=function(){var e="ClientApi.XrmGridControl.getViewSelector";try{return b.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(a,this._contextToken,this._pageId,this._controlName,this._gridType)),b.a.instance.reportSuccess(e),this._viewSelector}catch(r){var t=h.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getTeamTemplateId=function(){var e="ClientApi.XrmGridControl.getTeamTemplateId";try{b.a.instance.reportCall(e);var t=null,r=a.getState();if(Object(T.c)(r,E.c))if(this.getEntityName()&&3===this._gridType){var n=Object(g.fb)(r,this._connectedControlProps,this._contextToken.parentContextToken);n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters.TeamTemplateId&&(t=n.Controls[this._controlName].Parameters.TeamTemplateId)}return b.a.instance.reportSuccess(e),t}catch(t){var i=h.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getEntityName=function(){var e=this;return this._clientApiExecutor.execute("getEntityName",(function(t,r){if(!e._entityName){if(e._entityName=Object(p.F)(a.getState(),e._pageId,e._contextToken,e._controlName),!e._entityName&&3===e._gridType){var n=Object(g.fb)(a.getState(),e._connectedControlProps,e._contextToken.parentContextToken);if(!(n&&n.Controls&&n.Controls[e._controlName]&&n.Controls[e._controlName].Parameters&&n.Controls[e._controlName].Parameters.TargetEntityType)){var i=void 0;return n?n.Controls?n.Controls[e._controlName]?n.Controls[e._controlName].Parameters?n.Controls[e._controlName].Parameters.TargetEntityType||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",e._clientApiExecutor.reportFailure(t,new m.a(i),r),null}e._entityName=n.Controls[e._controlName].Parameters.TargetEntityType}if(!e._entityName)return e._clientApiExecutor.reportFailure(t,new m.a("Logical name of the entity type is coming as null or undefined."),r),null}return e._entityName}))},e.prototype.refresh=function(){var e=this;this._clientApiExecutor.executeAsync("refresh",(function(){return a.dispatch(Object(u.a)(e._pageId,e._contextToken,e._controlName))}))},e.prototype.refreshRibbon=function(){var e=this;this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(S.a)(e._pageId,Object(p.w)(a.getState(),e._pageId,e._contextToken)))}))},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridControl.getUrl";try{b.a.instance.reportCall(t);var r,n=null,i=this._getCurrentView();n={entityTypeName:this.getEntityName()},i&&(n.viewType="savedquery"===i.entityType?j.b.savedview:j.b.userview,n.viewId=new l.a(i.id)),r=s.a.Grid;var o=null;if(1===e)o=a.dispatch(Object(O.a)(r,n));else{var c=Object(P.a)(a,this._pageId);o=a.dispatch(Object(O.c)(c,r,n))}return b.a.instance.reportSuccess(t),o}catch(e){var u=h.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(t,e,null,u),e}},e.prototype.getRecordSetQueryKey=function(){var e=this;return this._clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(p.cb)(a.getState(),e._contextToken,{id:e._pageId})}))},e.prototype.getGridType=function(){return b.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType},e.prototype.getRelationship=function(){var e=this;return this._clientApiExecutor.execute("getRelationship",(function(t,r){if(!e._relationship){var n=Object(p.v)(a.getState(),e._pageId,e._contextToken);if(n){var i=n.relationshipName;if(i&&(e._relationship=x(i,e.getEntityName()),n.relationshipRoleOrdinal)){var o=n.relationshipRoleOrdinal===w.a.Referencing?1:2;e._relationship.roleType=o}}else v.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",r)}return e._relationship}))},e.prototype.getParentForm=function(){var e="ClientApi.XrmGridControl.getParentForm";try{b.a.instance.reportCall(e);var t=this._contextToken&&this._contextToken.parentContextToken?a.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return b.a.instance.reportSuccess(e),t}catch(t){var r=h.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"controlName",value:this._controlName}),h.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getRollupType=function(){var e=this;return this._clientApiExecutor.execute("getRollupType",(function(){return Object(p.eb)(a.getState(),e._pageId,e._contextToken)}))},e.prototype._getCurrentView=function(){var e=null,t=this.getViewSelector().getCurrentView();if(t)return{entityType:e="savedquery"===t.entityType?"savedquery":"userquery",id:t.id};var r=Object(o.g)(a.getState(),this._pageId);if(r.viewType&&r.viewId){var n=r.viewId?l.a.externalGuid(r.viewId):void 0;if((e=r.viewType===j.b.savedview?"savedquery":"userquery")&&n)return{entityType:e,id:n}}return null},e}();function x(e,t){var r={};r.name=e;var n=Object(I.h)(a.getState(),t);if(n){var i=void 0;if(n.OneToManyRelationships&&n.OneToManyRelationships[e]?i=n.OneToManyRelationships[e]:n.ManyToOneRelationships&&n.ManyToOneRelationships[e]&&(i=n.ManyToOneRelationships[e]),i)r.attributeName=i.ReferencingAttribute,r.relationshipType=0,r.navigationPropertyName=i.ReferencingEntityNavigationPropertyName;else if(n.ManyToManyRelationships&&n.ManyToManyRelationships[e]){var o=n.ManyToManyRelationships[e];r.relationshipType=1,1===r.roleType?(r.attributeName=o.Entity1IntersectAttribute,r.navigationPropertyName=o.Entity1NavigationPropertyName):(r.attributeName=o.Entity2IntersectAttribute,r.navigationPropertyName=o.Entity2NavigationPropertyName)}}return r}},"7oc5":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i=r("zETL"),o="grid.toggleRollupView";var s=function(e,t,r){return function(e,t,r,o){return{type:"grid.toggleRollupView.async",execute:function(s,c){var l=s.dispatch,u=c.TraceManager.getTracer(a.z),d=a.x+".toggleRollupViewAction";try{u.info("Setting Toggle value to "+t+" for the grid.");var p=Object(n.v)(o);l(function(e,t,r,n){return{type:e,payload:t,meta:{pageId:r,dataSetContextKey:n}}}(e,t,r,p)),l(Object(i.b)(r,o));var h=[{name:"newValue",value:t}];return c.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}catch(e){c.EventManager.ReportComponentFailure(d,Error("Setting Toggle value to the grid failed"))}}}}(o,e,t,r)}},"7z0H":function(e,t,r){"use strict";r.d(t,"f",(function(){return _e})),r.d(t,"h",(function(){return ne})),r.d(t,"i",(function(){return de})),r.d(t,"j",(function(){return pe})),r.d(t,"k",(function(){return he})),r.d(t,"c",(function(){return oe})),r.d(t,"d",(function(){return se})),r.d(t,"a",(function(){return te})),r.d(t,"b",(function(){return re})),r.d(t,"e",(function(){return ae})),r.d(t,"g",(function(){return ye}));var n=r("wQXd"),a=r("9r0m"),i=r("i8/j"),o=r("/j9Z"),s=r("HSdq"),c=r("2OIc"),l=r("sOTk"),u=r("QAhb"),d=r("F2uj"),p=r("7EJx"),h=r("ObKm"),g=r("CpQy"),m=r("gBKR"),f=r("jJRu"),b=r("cAHA"),v=r("lMVv"),y=r("TCcM"),_=r("GWjY"),O=r("DJ9D");var S=r("VWqI"),C=r("Cfob"),I=r("Qeyq"),j=r("r4Uk"),P=r("T2Xs"),T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=r("aUuu"),w=r("Sscr"),F=r("mGpW"),x=r("RNNy"),A=r("WACO"),N=r("M6d0"),D=r("n+eO"),k=r("yHpA"),M=r("+l2M"),R=r("YHw6"),L=r("IfuP"),B=r("cL6R"),V=r("YEEA"),G=r("Ww2r"),U=r("EcZf"),z=r("BRt1"),q=r("U0B9"),X=r("jm5F"),W=r("TiXY"),H=r("wUng"),Q=r("cZkS"),Y=r("qC0c"),K=r("AfKB"),J=r("455M"),Z=r("ZEX9"),$=r("yZTI"),ee=r("uQP8"),te="form.initialize",re="form.xrmready";function ne(e,t,r,n,c){var g=[{name:"formId",value:a.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(w.v)(r)}];return{type:"form.initialize.async",execute:function(m,f,b){var y,_=m.dispatch,O=m.getState,C=O(),I=Object(l.g)(C,t),F=I.entityTypeName,x=I.data,k=I.recordSetQueryKey,L=f.TraceManager.getTracer("Forms.InitializeForm"),G=[];if(g.push({name:"isPreview",value:I&&I.isPreview}),g.push({name:"EntityName",value:I&&I.entityTypeName}),L.info("initializeForm started.",g),Object(Z.b)(function(e){return function(){var t={},r={},n={};return function(a,i,o,s,c){P.a.info(T+o.controlId+": createGetTimelineWallData started");var l=!1;r.hasOwnProperty(a)&&r[a]||(r[a]=new j.a(e,a,o.id));var u=r[a],d=u.retrieveTimelineWallObject(i,o,s,c,e);n.hasOwnProperty(a)&&n[a]&&d===n[a]||(n[a]=d,l=!0);var p=u;return l&&(t[a]=p),P.a.info(T+o.controlId+": createGetTimelineWallData finished"),t[a]}}}(_),J.a.TimelineWall),L.info("BusinessProcessWrapperManager.Instance.init started.",g),G.push(D.a.Instance.init(f,O,_).then((function(){return L.info("BusinessProcessWrapperManager.Instance.init completed.",g)}))),Object(S.a)(C,e))if(Object(l.m)(C,t)){if(!Object(S.g)(C,F,1,0)&&!(null==I?void 0:I.isPreview))return ie(22e8,_,L,b,C,t)}else if(!Object(S.g)(C,F,2,0))return ie(2147746342,_,L,b,C,t);var q=Object(i.j)(C,e),$=ye(C,q,e),ee=fe(C,F,q),te=function(e,t,r,n){var a={};if(t&&t.RelatedEntityAttributes&&n)for(var i in t.RelatedEntityAttributes){var o=Object(v.x)(e,n,i);if(o&&o.ReferencedEntity){var s={},c=be(e,o.ReferencedEntity,t.RelatedEntityAttributes[i]),l=Object(w.m)(r,i);a[Object(w.v)(l)]={attributes:c,submitModes:s}}}return a}(C,q,r,F),re=Object(z.a)(C),ne=Object(p.s)(C);for(var ae in Oe(C,_,e,$,ee,t,r,te,ne),k&&!re&&_(Object(U.g)(t,k)),L.info("Update quick view forms started.",g),q.InlineQuickForms){var oe=q.InlineQuickForms[ae];for(var se in oe){var de=oe[se],pe=Object(i.j)(C,de),he=ye(C,pe,de),ve=fe(C,se,pe),_e=Object(w.l)(r,ae,se);Oe(C,_,e,he,ve,t,_e,null,ne)}}if(L.info("Update quick view forms completed.",g),x&&0!==Object.keys(x).length){var Se=I,Ce=Se.createFromEntity,Ie=Se.createFromRelationship,je=I.initWithEntity,Pe=Ce;!Pe&&je&&(Pe=je),y=function(e,t,r,n,i,c,p,g,m,f,b){r&&r.info("initializeFormWithDefaultValue started.",n);var y,_,O=Object(d.d)(e,c),S=null,C={},I=Object(l.m)(e,i),j=a.a.toString(g),P=[];j&&(S=Object(d.k)(e,j));for(var T=0,E=Object.keys(p);T<E.length;T++){var F=E[T];if("processid"!==F){var x=O[F];if(!x&&S&&(x=S[F]),x&&!x.AttributeOf){var A=x.Type;switch(A){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof p[F]){var D=ce(p,F,x);if(!D){ue(r,F);continue}if(C[F]=D,!a.a.equals(a.a.EMPTY,D.id)&&"owner"!==A&&I&&(f||b))if(_){var k=_.then((function(){return t(Object(X.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (1).",n)}))}));P.push(k)}else _=me(e,t,D,c,i,r,n,f,b),P.push(_)}else{var M=void 0;(M=Array.isArray(p[F])?p[F][0]:p[F])&&M.id&&a.a.tryParseOrNull(M.id)&&M.entityType&&(C[F]=new u.a(M.entityType,new a.a(M.id),M.name))}break;case"partylist":var R=p[F],L=R,B=[];try{"string"==typeof R&&(L=JSON.parse(R));for(var G=0,U=L;G<U.length;G++){var z=U[G];B.push(new u.a(z.entityType,new a.a(z.id),z.name))}}catch(e){ue(r,F,"partylist")}C[F]=B;break;case"boolean":case"picklist":case"status":C[F]=p[F];break;case"uniqueidentifier":C[F]=new a.a(p[F]);break;default:C[F]=p[F]}}else if(-1!==F.indexOf(K.d)||"_CreateFromId"===F){var q=null;if(-1!==F.indexOf(K.d)&&(q=ce(p,K.d,x)),!q&&"_CreateFromId"===F){var J=Object(v.m)(e,p._CreateFromType),Z=Object(v.h)(e,J);Z&&(q=le(J,p._CreateFromId,Z.DisplayName))}if(!q){ue(r,K.d);continue}if(!y&&(y=q,I))if(_){k=_.then((function(){return t(Object(X.b)(i,g)).then((function(){r&&r.info("updateSnapshotWithOptions completed (2).",n)}))}));P.push(k)}else _=me(e,t,y,c,i,r,n,f,b),P.push(_);if(Object(v.h)(e,c).IsActivity&&-1===Object.keys(C).indexOf(N.t)&&Object(v.z)(e,c,y.etn,N.t)){var $=Object(s.ab)(e,i,m);$&&$[N.t]&&(C[N.t]=q)}}else{if(ue(r,F),Object(Y.c)(e,Q.Rc))return Promise.reject(Object(V.b)(e,i,2200000009))}}}var ee=Object(Y.c)(e,Q.L),te=C;ee&&(te=function(e,t,r,n,a){var i={},o=Object(w.w)(n),c=Object(s.P)(e,o,t,r);for(var l in a)if(c&&c.hasOwnProperty(l)){var u=Object(d.a)(e,t,l);if(!(u&&u.ParentPicklistLogicalName)&&!Object(W.a)(e,n,r,t,c,l,{name:l,value:0})){i[l]=a[l];var p=[];for(u&&u.ChildPicklistLogicalNames&&(p=p.concat(u.ChildPicklistLogicalNames));p&&p.length>0;){var h=p.pop();if(a.hasOwnProperty(h)){var g=Object(d.a)(e,t,h),m=JSON.parse(a[g.ParentPicklistLogicalName]),f=JSON.parse(a[h]);Object(H.a)(e,r,n,g,t,m,f)&&(i[h]=a[h],g.ChildPicklistLogicalNames&&g.ChildPicklistLogicalNames.length>0&&(p=p.concat(g.ChildPicklistLogicalNames)))}}}}else i[l]=a[l];return i}(e,c,i,m,C));var re=ge(te);if(P.length>0)return Promise.all(P).catch((function(e){if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)})).then((function(){return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",n),Promise.resolve(null)}));return t(Object(h.a)(i,re,!0,!0)),r&&r.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",n),Promise.resolve(null)}(O(),_,L,g,t,F,x,e,r,Pe,Ie)}if(q&&q.Controls&&q.Controls.notescontrol){var Te=Object(l.g)(C,t);L.info("loadTimelineConfigAndMetaData started.",g),_(Object(E.b)(q.Controls.notescontrol,Te,n)).then((function(){L.info("loadTimelineConfigAndMetaData completed.",g)}))}if(q&&q.Controls)for(var Ee in q.Controls)if(q.Controls[Ee]){if(q.Controls[Ee].Id&&q.Controls[Ee].Id.startsWith("WebResource"))for(var we=0,Fe=q.Controls[Ee].Parameters;we<Fe.length;we++){var xe=Fe[we];if("Url"===xe.Name){var Ae=!1;if(c)for(var Ne=0,De=c;Ne<De.length;Ne++){var ke=De[Ne],Me=xe.Value&&xe.Value.toLowerCase()||"";if(Me.length>=ke.length&&Me.length-ke.length===Me.lastIndexOf(ke)){Ae=!0;break}}if(!Ae){var Re=Object(A.j)(C,xe.Value);Re&&!Re.Name&&(L.info("retrieveWebResourceDescriptorByName started.",g),_(Object(B.c)(xe.Value)).then((function(){L.info("retrieveWebResourceDescriptorByName completed.",g)})))}}}a.a.equals(q.Controls[Ee].ClassId,M.rb)&&C&&void 0===C.currentServerTime.serverTimeDiffInSeconds&&(L.info("retrieveServerTime started.",g),_(Object(R.b)(new u.a(F))).then((function(){L.info("retrieveServerTime completed.",g)})))}return null!=y?y:(L.info("initializeForm completed.",g),Promise.all(G))},getFailureParameters:function(e,t){return g}}}function ae(e,t,r,a,i,o,s){var c=t(Object(m.f)(o,!1,[])).then((function(){var r=Object(v.h)(e(),o);if(r.IsChildEntity){var n=Object(S.d)(e(),r);return t(Object(m.f)(n.EntityLogicalName,!1,[]))}})),u=function(){var i=e();if(!Object(S.b)(i,o))return ie(2200000001,t,r,a,i,s);var c=Object(S.c)(i,o),u=Object(n.d)(i);return c&&Object(l.m)(i,s)&&!u?ie(2200000002,t,r,a,i,s):void 0};return c?c.then(u):Promise.resolve(u())}function ie(e,t,r,n,a,i){var o=Object(V.d)(e);return t(Object(F.e)(o)).then((function(){var t=Object(V.c)(e);if(r){var s=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.debug(t,s)}var c=Object(G.e)(a,o),l=Object(G.c)(c,o[0]),u=Object(G.c)(c,o[1]);throw Object(V.b)(a,i,e,t,l,u)}))}function oe(e,t,r,n,a,i,o,c,g){g.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",g);var m=Object(d.d)(e,r);if(m){for(var f=function(e){return e&&e.OptionSet&&Object.keys(e.OptionSet).length>0},b=Object(l.g)(e,n).id,v=new u.a(r,b),y={},_=Object(s.ac)(e,n,o),O=function(t){var r=m[t];if(r&&(a.indexOf(t)>=0&&i.indexOf(t)>=0||f(r))&&!Object(s.X)(e,n,o,_,v,r.LogicalName)){switch(t){case N.q:var c=Object(p.q)(e),l=Object(p.t)(e);if(c&&l){var d=new u.a(x.a,c,l);y[t]=d}break;case N.w:if(!Object(k.d)(e,_,null,N.w)){var h=Object(p.b)(e);if(h){var g=new u.a(x.b,h.transactionCurrencyId,h.currencyName);y[t]=g}}}if(f(r)){var b=Object(k.d)(e,_,new u.a(r.EntityLogicalName),t),O=b?parseInt(b.valueString,10):null!=r.DefaultValue?r.DefaultValue:t===N.u?0:void 0;if(void 0===O||O<0||(y[t]=O),t===N.u&&-1!==a.indexOf(N.v)){var S=m[t];if(S&&S.OptionSet&&Object.keys(S.OptionSet).length>0){var C=r.OptionSet.find((function(e){return e.Value===O})),I=C?C.DefaultStatus:m[N.v].DefaultValue||0;I<0||(y[N.v]=I)}}}}},S=0,C=a.concat(i);S<C.length;S++){O(C[S])}var I=ge(y);t(Object(h.a)(n,I,!0,!0)),c.info("autoPopulateFields completed.",g)}else c&&c.warn("attributes is null.",g)}function se(e,t,r,n,i,o,s){var c=Object(l.g)(e,n).id,d=new u.a(r,c),p={};if(a.a.isNullOrEmpty(d.id)&&!s)return function(e,t,r,n,i){var o=Object(y.d)(e,r);if(null!=o)return Promise.resolve(o);return t(Object(L.a)(a.a.EMPTY,new u.a(r,a.a.EMPTY))).then((function(e){return e&&e.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)})).catch((function(e){var t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:r},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return n.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),n.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)}))}(e,t,r,i,o).then((function(e){e&&(p.processid=e.guid);var r=ge(p);return t(Object(h.a)(n,r,!0,!0)),Promise.resolve()}));s&&(p.processid=s);var g=ge(p);return t(Object(h.a)(n,g,!0,!0)),Promise.resolve()}function ce(e,t,r){var n=t;!t.match(/id$/i)&&t.indexOf(K.d)>-1&&(n+="id");var i=e[n];if(null!=i){if(a.a.validate(i)){var o=i,s=e[t+"name"],c=e[t+"type"]||e[t+"target"];return!c&&r.Targets&&r.Targets.length>0&&(c=r.Targets[0]),le(c,o,s)}try{var l=JSON.parse(i);if(l)return le(l.entityType,l.id,l.name)}catch(e){}}return null}function le(e,t,r){if(e&&t&&a.a.validate(t)){var n=new a.a(t);if(!a.a.isNullOrEmpty(n))return new u.a(e,n,r)}return null}function ue(e,t,r){if(e){var n=[{name:"key",value:t},{name:"source",value:r}];e.warn("Value passed is not in correct syntax.",n)}}function de(e,t,r,n,a,i,o,s){return pe(e,t,r,n,i,o,s).then((function(){return he(e,t,r,a,i,o,s)}))}function pe(e,t,r,n,a,i,o){return!Object(s.Eb)(e,a)&&Object($.n)(e,a)?(i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,a,2200000008,"Page has expired."))):(i&&i.info("loadScripts started.",o),r(t.ScriptManager.getContainer(a).getEventManager().loadScripts(n,a)).then((function(){i&&i.info("loadScripts completed",o)})))}function he(e,t,r,n,a,i,o){if(Object(s.Eb)(e,a)||!Object($.n)(e,a)){i&&i.info("runFormOnLoadScripts started.",o);var c=t.ScriptManager.getContainer(a).getEventManager();r(c.addPblEvent(n)),r(c.runOnLoad(n,1)),r(c.runOnDataLoad(n,1)),i&&i.info("runFormOnLoadScripts completed.",o)}else i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",o)}function ge(e){var t={};for(var r in e){var n={fieldName:r,value:e[r]};t[r]=n}return t}function me(e,t,r,n,a,i,s,c,l){var d=Object(w.j)(e,a),p=Object(w.x)(d);return i&&i.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,r,n,a){return{type:"snapshot.from.async",execute:function(i,s){var c=i.dispatch,l=i.getState,d=s.DataSource,p=u.a.toLegacyEntityReference(e),h=new _.a(p,t,O.a.All),S=d.execute(h,null).nativePromise(),C=null,I=null,j=null;return S.then((function(e){var r=e.get_entity();return C=Object(g.a)(r),I=C.fields,j=C.identifier,c(Object(m.f)(t,!1,Object.keys(C.fields)))}),(function(e){var r=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||r&&-2147217919===r.getNegativeErrorCode())&&n){var i=[];if(I={},n.etn){var s=Object(v.c)(l(),n.etn,t);if(s)for(var d=0,p=s;d<p.length;d++){var h=p[d];h.ReferencingAttribute&&i.push(h.ReferencingAttribute)}}else a&&i.push(a.attributeName);for(var g=0,f=i;g<f.length;g++){var b=f[g];if(!n.name&&n.id){var _=Object(y.h)(l(),n.etn,n.id.guid);if(_&&_.fields){var O=Object(v.E)(l(),n.etn),S=_.fields[O];S&&S.value||(S=_.fields.name),S&&S.value&&(n={etn:n.etn,id:n.id,name:S.value})}}I[b]={reference:n,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return j=new u.a(t),c(Object(m.f)(t,!1,i))}Object(o.b)(e)})).then((function(){var e=Object(f.b)(l(),j,I,r,b.a.Create),t=e.payload.snapshotId;return c(e),t}))}}}(r,n,p,c,l)).then((function(e){i&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(C.b)(a,e,d)).then((function(){i&&i.info("createAndSetDataSnapshotFrom completed.",s)}))}))}function fe(e,t,r){var n={};if(r&&r.Attributes&&t){var a=Object(A.d)(e,r.FormLibraries,[t]);if(r.Attributes||a){var i=[].concat(r.Attributes,a);-1===i.indexOf(N.u)&&i.push(N.u),n=be(e,t,i)}}return{attributes:n,submitModes:{}}}function be(e,t,r){var n={};if(r&&t)for(var a=0;a<r.length;a++){var i=r[a];if(i){var o=Object(s.L)(e,t,i);o&&(n[i]=o)}}return n}function ve(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function ye(e,t,r){var n={},a={},i={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0},u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames)for(var d=!1,p=0,h=Object(s.m)(e,t);p<h.length;p++){var g=h[p],m={collapsed:!!d||!(g.Expanded&&g.Visible),visible:g.Visible,label:g.Label,sectionNames:[],domId:g.DomId,showLabel:g.ShowLabel,contentType:null};switch(g.ContentType){case"expandAvailableSpace":case"singleComponent":m.contentType="singleComponent";break;default:m.contentType="cardSections"}d=d||g.Expanded&&g.Visible;var f=[];if(g.Columns)for(var b=0;b<g.Columns.length;b++){var v=g.Columns[b];if(v.SectionNames)for(var y=0;y<v.SectionNames.length;y++){var _=v.SectionNames[y];if(t.Sections[_]){var O=t.Sections[_];f.push(_);for(var S=[],C=0,j=t.Sections[_].Rows;C<j.length;C++)for(var P=0,T=j[C].Cells;P<T.length;P++){var E=T[P];E.ControlName&&S.push(E.ControlName)}var w={parentTabId:g.Id,visible:O.Visible,label:O.Label,controlNames:S,domId:O.DomId,semanticZoomDomId:O.SemanticZoomDomId};a[_]=w;for(var F=0;F<S.length;F++){var x=S[F];if(t.Controls[x]){var A=t.Controls[x],N=_e(A,_,!0),D=Object(c.a)(A,t,Object(q.b)(e));null!=D&&(N.visible=N.visible||D.ShouldOverrideControlVisible),Se(N),i[x]=N}}}}}if(g.Header)for(var k=0,M=g.Header;k<M.length;k++){i[(U=M[k]).Name]=_e(U,null,!0)}if(g.Footer)for(var R=0,L=g.Footer;R<L.length;R++){i[(H=L[R]).Name]=_e(H,null,!0)}m.sectionNames=f,n[g.Id]=m}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){var B=ve(t.Header);if(B)for(var V=0,G=B;V<G.length;V++){var U;i[(U=G[V]).Name]=_e(U,null,!0),Se(i[U.Name])}o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){var z=ve(t.Footer);if(z)for(var X=0,W=z;X<W.length;X++){var H;i[(H=W[X]).Name]=_e(H,null,!0),Se(i[H.Name])}l.visible=!1!==t.Footer.Visible}return{formId:r,tabs:n,sections:a,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:l}}function _e(e,t,r){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:r,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Oe(e,t,r,n,i,o,c,l,u){void 0===l&&(l=null);var d=Object(s.cb)(e,o,c),p=Object(ee.a)(e,o);a.a.equals(null==d?void 0:d.formId,null==n?void 0:n.formId)&&a.a.equals(r,null==p?void 0:p.formId)||t(function(e,t,r,n,a,i,o){void 0===i&&(i=null);return{type:te,payload:{formId:e,formUIState:t,formMetadataState:r,relatedEntityMetadataState:i,currentLanguageId:o},meta:{pageId:n,contextToken:a}}}(r,n,i,o,c,l,u))}function Se(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},"8ADW":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Chart.Component",a="ViewId",i="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},"8Fmj":function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("9r0m"),a=r("G7N+"),i=r("KDdL"),o=r("7dGM"),s=r("8ADW"),c=r("z9yS"),l=r("Xlzu"),u=r("t8f4"),d=r("QAhb"),p=r("xhI+"),h=r("/j9Z"),g=r("Fpc+"),m=r("Kn4q"),f=r("zEjV"),b=r("S2mk"),v=r("cZkS"),y=r("qC0c");function _(e,t,r){void 0===t&&(t=c.a.savedvisualization);var p=[];return p.push({name:s.f,value:e}),p.push({name:s.i,value:t}),p.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(g,b){var _=g.dispatch,O=g.getState;try{var C=m.a.LocalAndRemote,P=b.TraceManager.getTracer(s.d),w=b.DataSource,F=O(),x=r;if(P.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+r),!e){return b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error("entityTypeName is null"),s.d,p),Promise.reject("entityTypeName is null")}n.a.isNullOrEmpty(x)&&(x=Object(o.j)(F,e));var A=Object(y.c)(O(),v.A);if(!n.a.isNullOrEmpty(x)){var N=Object(o.f)(F,x),D=Object(o.g)(F,x);if(N===a.a.Initialized){if(function(){var r=Object(o.a)(F,x),n=function(e,t,r,n){var a=c.a[r],i=Object(o.i)(e,t);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][n.guid]}(F,e,t,x),a=n&&!n.IsUserChart;switch(Object(l.d)(F,a,r,(function(){return n}))){case 1:C=m.a.Remote;break;case 2:_(function(e,t,r){var n=[];return n.push({name:"entityTypeName",value:t}),n.push({name:"visualizationType",value:r}),{type:"chartselector.retrieve.async",execute:function(e,a){var o=e.dispatch;e.getState;try{return o(Object(l.b)(c.a[r],null,t,null,!0,f.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(h.b)}catch(e){throw a.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),s.e,n),e}}}}(0,e,t))}}(),C!==m.a.LocalAndRemote)return I(_,w,e,x,t,C,b,p);if(A&&D===a.a.Uninitialized){var k=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",x),M=Object(o.a)(F,x);return _(S(x,a.a.Initialized)),_(Object(u.d)(k)).catch(h.b).then((function(e){return j(M,e),_(T(e)),b.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(x)}),(function(e){return E(_,e,x.guid,M,b,p),Promise.resolve(x)}))}return Promise.resolve(x)}return I(_,w,e,x,t,C,b,p)}return I(_,w,e,x,t,C,b,p)}catch(e){throw b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,p),e}}}}function O(e){return{type:"chart.dependencies.update.async",execute:function(t,r){var a=t.dispatch,i=t.getState,s=[];for(var c in e)s.push(e[c]+":name");return s.length>0?a(Object(p.a)(s)).then((function(){var t=new Map,r=i();for(var s in e){var c=e[s],l=Object(o.a)(r,new n.a(c));l&&c&&r.metadata.labels&&r.metadata.labels[c]&&r.metadata.labels[c].name&&(l.Name=r.metadata.labels[c].name,t.set(c,l))}t.size>0&&a(function(e){var t={};return e.forEach((function(e,r){t[r]=e})),{type:"chart.descriptor.update",payload:{charts:t}}}(t))}),h.b):Promise.resolve()}}}function S(e,t){var r,i=n.a.isNullOrEmpty(e)?null:{charts:(r={},r[n.a.toString(e)]={initialized:t,oDataInitialized:a.a.Initializing},r)};return{type:g.f,payload:i}}function C(e,t,r,o,p){void 0===o&&(o=c.a.savedvisualization);var g=[];return g.push({name:s.f,value:t}),g.push({name:s.i,value:o}),g.push({name:s.h,value:n.a.toString(r)}),{type:"chart.retrieve.async",execute:function(e,s){var m=e.dispatch,b=e.getState;return Object(y.c)(b(),v.A)?r?function(e,t,r,o,s,p,g){var m=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(S(r,a.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b),e(Object(u.d)(m)).catch(h.c)]).then((function(t){return t[1].constructor===h.a?E(e,t[1],r.guid,t[0].charts[r.guid],p,g):(j(t[0].charts[r.guid],t[1]),e(T(t[1])),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]}))}(m,t,r,o,p,s,g):function(e,t,r,o,s,p,g){return e(Object(l.b)(c.a[o],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(h.b).then((function(t){var r=new n.a(Object.keys(t.charts)[0]),s=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",r);return e(S(r,a.a.Initializing)),e(Object(u.d)(s)).catch(h.b).then((function(n){return j(t.charts[r.guid],n),e(T(n)),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t}),(function(n){return E(e,n,r.guid,t.charts[r.guid],p,g),t}))}))}(m,t,r,o,p,s,g):function(e,t,r,a,i){return e(Object(l.b)(c.a[a],null,t,n.a.toLegacyGuid(r),!0,f.a.OnDemandWithContext,null,null,[],null,i)).catch(h.b)}(m,t,r,o,p)}}}function I(e,t,r,o,c,l,u,d){var p,m,f;return e((p=o,f=n.a.isNullOrEmpty(p)?null:{charts:(m={},m[n.a.toString(p)]={initialized:a.a.Initializing},m)},{type:g.b,payload:f})),e(C(0,r,o,c,l)).then((function(t){t&&t.chartSelectors&&!t.chartSelectors[r]&&(t.chartSelectors[r]={initialized:a.a.Initialized,chartTypes:{}});var s=[];for(var c in t.charts)s.push(c);return e(O(s)).then((function(){return e(P(t)),n.a.isNullOrEmpty(o)&&(o=t.chartDefaults[r]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),o}),h.b)}),(function(t){var c,l,p=t&&!Object(b.j)(t.errorCode)&&t.errorCode,g={chartSelectors:(c={},c[r]={initialized:a.a.Initialized,chartTypes:{}},c)};if(e(P(g)),Object(b.j)(p))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),s.d,d),Object(h.b)(t);var m={charts:(l={},l[n.a.toString(o)]={initialized:a.a.Error,errorCode:p},l)};e(P(m))}))}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=a.a.Initialized}function P(e){return{type:g.b,payload:e}}function T(e){return{type:g.f,payload:e}}function E(e,t,r,n,o,c){var l;e(T({charts:(l={},l[r]={initialized:n.initialized,oDataInitialized:a.a.Error},l)})),o.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),s.c,c)}},"8VL5":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("uO/V"),a=r("/j9Z"),i="customcontrol.refreshCustomDataProvider";function o(e,t,r,o){return{type:"customcontrol.refreshCustomDataProvider.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,n.x+".refreshCustomDataProviderAction");return o().then((function(n){return l(function(e,t,r,n){var a=new Array;n&&n.length>0&&(a=n.slice());return{type:i,payload:a,meta:{pageId:e,customControlId:t,dataSetParameterName:r}}}(e,t,r,n)),c.EventManager.ReportComponentSuccess(u),n})).catch((function(e){return c.EventManager.ReportComponentFailure(u,Error(e)),Promise.reject(new a.a(e))}))}}}},"90Ov":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(n.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},"9LTA":function(e,t,r){"use strict";r.d(t,"b",(function(){return Se})),r.d(t,"d",(function(){return Ce})),r.d(t,"e",(function(){return Ie})),r.d(t,"c",(function(){return je})),r.d(t,"a",(function(){return Pe}));var n=r("0RbL"),a=r("9r0m"),i=r("G7N+"),o=r("KDdL"),s=r("c/eZ");var c=r("70DF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var l=r("QAhb"),u=r("VcAV"),d=r("+h4s"),p=function(){function e(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}return e.prototype.addAggregator=function(e,t,r,n,i){if(r>=c.a.DAY&&r<c.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,r,n,i);else if(r===c.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,n,i);else if(r===c.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,n,i);else{var o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(o.FieldName=e,o.EntityName=n,o.LinkEntityExpressionArray=i,Object(u.c)(t))o.Value=null;else if(t instanceof l.a){var s=t;o.Value=s.id.guid,o.DisplayName=s.name,o.EntityLogicalName=s.etn}else t instanceof a.a?o.Value=a.a.toString(t):o.Value=t.toString();this._dataPointAggregators.push(o)}},e._daysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype._addDataPointFiscalPeriodAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");var i=t.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}else this._dataPointFiscalPeriodAggregators.push(a)},e.prototype._addDataPointFiscalYearAggregator=function(e,t,r,n){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=e,a.EntityName=r,a.LinkEntityExpressionArray=n,t){if("number"!=typeof t)throw new Error("value should be number");a.Year=Number(t),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)},e.prototype._addDateTimeRangeAggregatorInfo=function(e,t,r,n,a){var i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||c.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=n),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),r){case c.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case c.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case c.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case c.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case c.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(r,i.dateTimeAggregatorPrecision)},e.prototype._getDataPointDateTimeRangeAggregators=function(t,r){var n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((function(a,i){var o,s={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};if(s.FieldName=a.dateTimeAggregatorFieldName,s.EntityName=a.dateTimeAggregatorEntityName,s.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:e._daysInMonth(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),s.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case c.a.DAY:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth(),s.MaxDate.getDate());break;case c.a.WEEK:r===d.a.FirstFullWeekOfTheYear&&(r=d.a.FirstDayOfTheYear);var l=Object(d.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,t,r),u=Object(d.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,t,r);if(u.setDate(u.getDate()-1),r===d.a.FirstDayOfTheYear)if(u>=new Date(a.dateTimeAggregatorYear+1,0,1))u=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){var p=new Date(a.dateTimeAggregatorYear,0,1);l<p&&(l=p)}s.MinDate=l,s.MaxDate=u,h(s.MaxDate),h(s.MinDate);break;case c.a.MONTH:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-1,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth())+1),h(s.MaxDate),h(s.MinDate);break;case c.a.QUARTER:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-3,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth()-2)+1),h(s.MaxDate),h(s.MinDate);break;case c.a.YEAR:h(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear()-1,s.MaxDate.getMonth(),s.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(s)}else n.push(s)})),n},e.prototype.getAggregators=function(e,t){var r=this._dataPointAggregators,n=this._getDataPointDateTimeRangeAggregators(e,t);return n&&n.length>0&&(r=r.concat(n)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(r=r.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(r=r.concat(this._dataPointFiscalYearAggregators)),r},e}();function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var g=r("Ww2r"),m=r("dUXI"),f=r("7EJx"),b=r("otJc"),v=r("yGoS"),y=r("EGsq"),_=r("F2uj"),O=r("uXKh"),S=r("sRkF");function C(e,t){var r=Object(_.a)(e,t.entity.entityName,t.attributeName),n=r?r.DisplayName:null;n||(n=t.attributeName);var a=n;if(t.dateTimeGrouping){var i=v.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(g.b)(e,m.c),Object(g.b)(e,m.c+"."+i.toUpperCase()),n)}else t.hasAggregate&&t.aggregateType&&(a=String.format(Object(g.b)(e,m.d),Object(g.b)(e,m.d+"."+t.aggregateType.toUpperCase()),n));if(r&&"money"===r.Type){var o="",s=null,c=Object(y.x)(e);r.IsBaseCurrency?c&&c.baseCurrencyId&&c.transactionCurrencyById&&(s=c.transactionCurrencyById[c.baseCurrencyId.guid]):t.hasAggregate&&(s=Object(f.b)(e)),s&&(o=c&&c.currencyDisplayOption===O.a.CurrencyCode?s.currencyCode:s.currencySymbol),o&&(a=String.format(Object(g.b)(e,m.b),a,o))}return a}function I(e,t,r){return r>0?String.format(Object(g.b)(e,m.y),r,t):String.format(Object(g.b)(e,m.w),t)}function j(e,t,r,n,a){var i=a<1&&n>=1&&r<1,o=a<1&&n<1&&r>=1,s=n<1&&r<1;if(a>=1&&n<1&&r>=1){var c=new Date(t,r-1,a),l=Object(f.w)(e),u=l.formatInfoCultureName,d=l.numberFormatInfo,p=l.dateFormatInfo,h=new Sys.CultureInfo(u,d,p);return Object(b.s)(c,h,S.a.None)}return i?String.format(Object(g.b)(e,m.z),n,t):o?String.format("{0} {1}",function(e){var t=Object(g.b)(e,m.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[r-1],t):s?String(t):""}function P(e){return Object(g.b)(e,m.v)}var T=r("9rlF"),E=r("+Z9T");function w(e,t,r){var n=!1;return r&&r.groupAttribute&&r.groupAttribute.dateTimeGrouping&&(n=!0),{attribute:t,primaryGroupBy:r,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:n}}function F(e,t){var r=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(T.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return j(e.state,a,n,-1,r)}(e,t);case c.a.WEEK:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,-1,r,-1)}(e,t);case c.a.MONTH:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,n,r,-1,-1)}(e,t);case c.a.QUARTER:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,n,r)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case c.a.FISCAL_PERIOD:return function(e,t){return Object(T.e)(t.fields[e.aliasName])}(e,t);case c.a.YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return j(e.state,r,-1,-1,-1)}(e,t);case c.a.FISCAL_YEAR:return function(e,t){var r=Object(T.e)(t.fields[e.aliasName]);return I(e.state,r,-1)}(e,t);default:return Object(T.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return r||(r=(r=Object(T.c)(t.fields[e.aliasName]))||""),0===r.length?Object(g.b)(e.state,m.v):r}function x(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return F(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":var r=Object(T.e)(t.fields[e.aliasName]);return r=Object(E.a)(r)?-1:Number(r);case"datetime":return function(e,t){var r=-1,n=-1,a=-1;switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:r=Object(T.e)(t.fields[e.aliasName]),n=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case c.a.MONTH:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.YEAR:a=Object(T.e)(t.fields[e.aliasName]);break;case c.a.QUARTER:n=Object(T.e)(t.fields[e.aliasName]),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.WEEK:r=1+7*(Object(T.e)(t.fields[e.aliasName])-1),a=Object(T.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return F(e,t)}return new Date(a,n-1,r).getTime()}(e,t);default:return F(e,t)}}function A(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var D=function(e){function t(r,n,a){var i=e.call(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i.title=n,i.description=a,i}return Object(s.__extends)(t,e),t}(Error),k=r("qC0c"),M=r("cZkS"),R=r("glw0"),L=r("scgP"),B=r("WS0f");function V(){return this.point.formattedValue}function G(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}var U=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"primaryGroupBy",{get:function(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryModel",{get:function(){return this._queryModel},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,r,n,a,i,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=r,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=n,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0},e.prototype.setXAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.setYAxisMajorGridAndMajorTickProperties=function(e,t){var r,n,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(n=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===n?void 0:n.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.retrieveChartArea3DStyle=function(){var e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e},e.prototype.retrieveChartAreaGradientStyle=function(){var e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e},e.prototype.setYAxisOppositeProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.Opposite=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.setXAxisIsReversedProperty=function(e){var t,r,n,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(r=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.IsReversed)&&(e.IsReversed=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.retrieveChartYAxis=function(){var e=this,t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;for(var r=function(t,r,n){e.chartPresentationYAxis&&e.chartPresentationYAxis.length>r&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Title?t.Title=e.chartPresentationYAxis[r].Title:1===n&&(t.Title=e._queryModel.SeriesList[r].Title)},n=0,a=-1,i=-1,o=!1,s=!1,c=0;c<this.chartPresentationSeries.length;c++)this.chartPresentationSeries[c].SecondaryYAxis?(n++,i=-1===i?c:i,s=s||this.shouldDisableAllowDecimals(c)):(a=-1===a?c:a,o=o||this.shouldDisableAllowDecimals(c));return r(t[0],a,this.chartPresentationSeries.length-n),t[0].Opposite=!1,o&&(t[0].AllowDecimals=!1),0===n&&(t[0]=this.setYAxisOppositeProperty(t[0])),n>0&&(t[1]={},r(t[1],i,n),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((function(t,r){var n,a,i,o,s,c,l,u,d,p,h,g,m,f;t.Disabled=e.chartPresentationYAxis&&e.chartPresentationYAxis[r]&&e.chartPresentationYAxis[r].Disabled,t.LabelForeColor=null===(a=null===(n=e.chartPresentationYAxis)||void 0===n?void 0:n[r])||void 0===a?void 0:a.LabelForeColor,t.AxisLineColor=null===(o=null===(i=e.chartPresentationYAxis)||void 0===i?void 0:i[r])||void 0===o?void 0:o.AxisLineColor,t.AxisTitleForeColor=null===(c=null===(s=e.chartPresentationYAxis)||void 0===s?void 0:s[r])||void 0===c?void 0:c.AxisTitleForeColor,t.LabelDisabled=null===(u=null===(l=e.chartPresentationYAxis)||void 0===l?void 0:l[r])||void 0===u?void 0:u.LabelDisabled,t.AxisInterval=null===(p=null===(d=e.chartPresentationYAxis)||void 0===d?void 0:d[r])||void 0===p?void 0:p.AxisInterval,t.AxisMinimum=null===(g=null===(h=e.chartPresentationYAxis)||void 0===h?void 0:h[r])||void 0===g?void 0:g.AxisMinimum,t.AxisMaximum=null===(f=null===(m=e.chartPresentationYAxis)||void 0===m?void 0:m[r])||void 0===f?void 0:f.AxisMaximum,t=e.setYAxisMajorGridAndMajorTickProperties(t,r)})),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),t},e.prototype._isChartCustomizationParityFCBEnabled=function(){return Object(k.a)(this.getState(),M.s,M.Lc,M.w)},e.prototype.retrieveChartAnnotations=function(){for(var e=new Array(this.chartPresentationAnnotationList.length),t=0;t<this.chartPresentationAnnotationList.length;t++){var r={};r.X=this.chartPresentationAnnotationList[t].X,r.Y=this.chartPresentationAnnotationList[t].Y,r.Text=this.chartPresentationAnnotationList[t].Text,r.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=r}return e},e.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o=new Array(1),s=null;this.categoryColumn.length>0&&(s=w(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};for(var c=new Array(this.chartData.length),l=0;l<this.chartData.length;l++){var u=this.chartData[l];if(s){if(c[l]=F(s,u),"-1"===c[l])c[l]=Object(g.b)(this.getState(),m.f);else if(!s.isDateTimeChart&&"number"==typeof Object(T.e)(u.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){var d=Object(f.w)(this.getState());c[l]=Object(L.c)(Object(T.e)(u.fields[s.aliasName]),Object(b.d)(d),this.chartPresentationXAxis[0].FormatString)}}else c[l]=P(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,o[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o},e.prototype.retrieveChartCategoryTitle=function(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?C((t=e).state,t.attribute):"";var t},e.prototype.retrieveChartSeries=function(e){for(var t=new Array(this.chartPresentationSeries.length),r=function(r){var a=n.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute,i=a.aliasName?a.aliasName:a.attributeName,o=n.chartPresentationSeries[r].IsValueShownAsLabel,s=n.chartPresentationSeries[r].LabelFormat,c=null;s&&Object(L.d)(s)&&(c=Object(L.g)(s));var l=!1;n.chartPresentationSeries[r].Label&&"#percent"===n.chartPresentationSeries[r].Label.toLowerCase()&&(l=!0);var u=!1;s&&z(n.chartPresentationSeries[r].ChartType)&&Object(L.e)(s)&&(u=!0);var d=null,p=C(n.getState(),a);t[r]=n.cloneBlueprintSeriesStyle(n.chartPresentationSeries[r]),n.chartPresentationSeries[r].SecondaryYAxis&&(t[r].YAxisNumber=1),n.primaryGroupBy&&((d=[]).push(n.primaryGroupBy.groupAttribute),n.primaryGroupBy.extendedGroupBys&&n.primaryGroupBy.extendedGroupBys.forEach((function(e){d.push(e)})));for(var h=new Array(n.chartData.length),g=i,m=0,v=0;v<n.chartData.length;v++){var y=n.chartData[v];h[v]=N();var _=Object(T.e)(y.fields[i]);if(h[v].Value=_||0,m+=_||0,s){var O=Object(f.w)(n.getState()),S=Object(b.d)(O);Object(L.f)(s)?h[v].FormattedValue=Object(R.b)(h[v].Value,n.chartPresentationSeries[r].LabelFormat,S):Object(L.d)(s)&&!u?h[v].FormattedValue=Object(L.a)(h[v].Value,c,S):h[v].FormattedValue=Object(T.c)(y.fields[g])||0}else h[v].FormattedValue=Object(T.c)(y.fields[g])||0;n.attachAggregators(h[v],y,d)}var I=A();o?(I.Enabled=!0,I.LabelFormatter=V):l&&(I.Enabled=!0,I.LabelFormatter=G(m)),I.Color=n.chartPresentationSeries[r].LabelForeColor,t[r].DataLabels=I,t[r].DataPoints=h,t[r].Title=n.getChartTitleFromPresentationSeries(p,r),t[r].XAxisNumber=e,t[r].HideInLegend=n.chartPresentationSeries[r].HideInLegend,t[r].Stack=n.chartPresentationSeries[r].Stack},n=this,a=0;a<this.chartPresentationSeries.length;a++)r(a);var i=Object(f.w)(this.getState()),o=Object(b.d)(i),s=this.chartPresentationSeries[0].IsValueShownAsLabel,c=this.chartPresentationSeries[0].LabelFormat;if(s&&z(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(c))for(var l=q(c,o),u=0;u<t[0].DataPoints.length;u++)l(0,u,0,t);return t},e.prototype.getChartTitleFromPresentationSeries=function(e,t){return void 0===t&&(t=0),Object(B.b)(this.chartPresentationSeries[t].LegendText)?Object(B.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText},e.prototype.shouldDisableAllowDecimals=function(e){var t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType},e.prototype.cloneBlueprintSeriesStyle=function(e){var t,r={DataPoints:t&&t.DataPoints||null,DataLabels:t&&t.DataLabels||null,ChartType:t&&t.ChartType||"line",YAxisNumber:t&&t.YAxisNumber||0,XAxisNumber:t&&t.XAxisNumber||0,Title:t&&t.Title||"",Color:t&&t.Color||"",BorderColor:t&&t.BorderColor||"",BorderWidth:t&&t.BorderWidth||0,CustomProperties:t&&t.CustomProperties||null,Stack:t&&t.Stack||null};return r.ChartType=e.ChartType,r.Color=e.Color,r.BorderColor=e.BorderColor,r.BorderWidth=e.BorderWidth,r.CustomProperties=e.CustomProperties,r},e.prototype.attachAggregators=function(t,r,n){if(n){for(var a=new p,i=function(t){var i=n[t],o=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach((function(e){var t,r={name:t&&t.name||null,from:t&&t.from||null,to:t&&t.to||null,linkType:t&&t.linkType||null,alias:t&&t.alias||null};r.name=e.entityName,r.from=e.linkFromAttribute,r.to=e.linkToAttribute,r.linkType=e.joinType.toString(),r.alias=e.alias,o.push(r)})),a.addAggregator(i.attributeName,Object(T.e)(r.fields[e._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,o)},o=0;o<n.length;o++)i(o);var s=Object(f.w)(this.getState()),c=this._getFirstDayOfWeekFromUserSettings(s),l=this._getCalendarWeekRuleFromUserSettings(s);t.Aggregators=a.getAggregators(c,l)}},e.prototype._getFirstDayOfWeekFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0},e.prototype._getCalendarWeekRuleFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0},e.prototype.getFormatterPropertiesForAttribute=function(e){return Object(b.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))},e._getFieldName=function(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName},e.prototype.isChartDrillable=function(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(var e=0,t=this.chartDataDescription.category.measureCollections;e<t.length;e++)for(var r=0,n=t[e].secondaryGroupBys;r<n.length;r++){var a=n[r];if(!this._isGroupByDrillable(a))return!1}return!!this.chartDataDescription.entityExpression.hasAggregate},e.prototype._isGroupByDrillable=function(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))},e.prototype._isAttributeDrillable=function(e){var t,r=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,n=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(n,r,this.getState())},e.prototype._validateChartAggregateAttributes=function(){for(var e,t,r,n,a=0;a<(null===(r=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===r?void 0:r.length);a++){var i=this.chartDataDescription.entityExpression.aggregateAttributes[a],o=null===(n=null==i?void 0:i.entity)||void 0===n?void 0:n.entityName,s=null==i?void 0:i.attributeName,c=Object(_.b)(s,o,this.getState());if(!("date"!==c&&"datetime"!==c||"min"!==i.aggregateType&&"max"!==i.aggregateType)){var l=String.format(Object(g.b)(this.getState(),m.h),s);throw new D("ChartError",l,l)}}},e}();function z(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function q(e,t){return function r(n,a,i,o){if(n===o.length)return i;var s=o[n].DataPoints[a];return i=r(++n,a,i+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(L.a)(s.Value/i*100,Object(L.g)(e),t)),i}}var X=r("lMVv"),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){var e,t,r,n;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");var a=new Array(0),i=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(var c=0;c<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;c++)a.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[c]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");for(var l=this._addSecondaryGroupByToFieldAggregators(s,a),u=s.measures[0].measureAttribute,d=u.aliasName?u.aliasName:u.attributeName,p=d,h=o.primaryGroupBy.groupAttribute,g=w(this.getState(),this._getGroupByAttribute(h,o.primaryGroupBy),o.primaryGroupBy),m=new Array,v=new Array,y=new Map,_=0;_<this.chartData.length;_++){var O=F(g,M=this.chartData[_]),S=F(l,M),C=void 0;C=null==S?S=P(this.getState()):x(l,M),i.set(C,S),v.indexOf(O)<0&&v.push(O),m.indexOf(C)<0&&m.push(C)}m.forEach((function(e){var t=new Array(v.length);y.set(e,t)}));var I=Object(f.w)(this.getState()),j=this.chartPresentationSeries[0].LabelFormat,D=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(D=!0);var k=!1;j&&z(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(j)&&(k=!0);for(_=0;_<this.chartData.length;_++){var M,B=x(l,M=this.chartData[_]);Object(E.a)(B)&&(B=P(this.getState()));var U=y.get(B),X=(O=F(g,M),v.indexOf(O));if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(v[X]=Object(L.c)(Object(T.e)(M.fields[g.aliasName]),Object(b.d)(I),this.chartPresentationXAxis[0].FormatString)),U[X]=N(),U[X].Value=Object(T.e)(M.fields[d]),j){var W=Object(b.d)(I);Object(L.f)(j)?U[X].FormattedValue=Object(R.b)(U[_].Value,j,W):Object(L.d)(j)&&!k?U[X].FormattedValue=Object(L.a)(U[X].Value,Object(L.g)(j),W):U[X].FormattedValue=Object(T.c)(M.fields[p])||0}else U[X].FormattedValue=Object(T.c)(M.fields[p])||0;this.attachAggregators(U[X],M,a)}m.forEach((function(e){for(var t=y.get(e),r=0;r<v.length;r++)t[r]||(t[r]=N())}));var H=new Array(1);H[0]={},H[0].Title=this.retrieveChartCategoryTitle(g),H[0].Values=v,H[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,H[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,H[0].AxisTitleForeColor=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.AxisTitleForeColor,H[0].LabelDisabled=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.LabelDisabled,H[0]=this.setXAxisMajorGridAndMajorTickProperties(H[0]),H[0]=this.setXAxisIsReversedProperty(H[0]),this._sortComparisonCodes(s,m);for(var Q=new Array(m.length),Y=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,K=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,J=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,Z=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name),$=function(e){var t=m[e];if(Q[e]=ee.cloneBlueprintSeriesStyle(ee.chartPresentationSeries[0]),Q[e].Title=Z||i.get(t),Q[e].DataPoints=y.get(t),Q[e].HideInLegend=J,Y)(r=A()).Enabled=!0,r.LabelFormatter=V,Q[e].DataLabels=r,r.Color=K;else if(D){var r,n=0;Q[e].DataPoints.forEach((function(e){n+=e&&e.Value?e.Value:0})),(r=A()).Enabled=!0,r.LabelFormatter=G(n),Q[e].DataLabels=r,r.Color=K}},ee=this,te=0;te<m.length;te++)$(te);if(Y&&k)for(var re=q(j,W=Object(b.d)(I)),ne=0;ne<H[0].Values.length;ne++)re(0,ne,0,Q);this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=H,this.queryModel.YAxes=this._retrieveChartYAxis(u),this.queryModel.SeriesList=Q,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()},t.prototype._sortComparisonCodes=function(e,t){e.secondaryGroupBys[0].descending?t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)})):t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t)}))},t.prototype._getGroupByAttribute=function(e,t){return e.attributeName!==Object(X.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e},t.prototype._addSecondaryGroupByToFieldAggregators=function(e,t){var r=e.secondaryGroupBys[0].groupAttribute,n=w(this.getState(),this._getGroupByAttribute(r,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(r&&t.push(r),e.secondaryGroupBys[0].extendedGroupBys)for(var a=0;a<e.secondaryGroupBys[0].extendedGroupBys.length;a++)t.push(e.secondaryGroupBys[0].extendedGroupBys[a]);return n},t.prototype._retrieveChartYAxis=function(e){var t,r,n,a,i,o,s,c,l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=C(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(r=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===r?void 0:r.LabelDisabled),l[0].AxisInterval=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisInterval,l[0].AxisMinimum=null===(o=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l},t}(U),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t.prototype.retrieveChartCategory=function(){var e,t,r,n,a,i,o,s,c=new Array(1);if(this.chartData.length<1)return c;var l=this.primaryGroupBy.groupAttribute;c[0]={};var u=new Array(this.chartData.length),d=w(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(n=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===n?void 0:n.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(var p=0;p<this.chartData.length;p++){var h=this.chartData[p];u[p]=F(d,h),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[p]!==Object(g.b)(d.state,m.v)&&(u[p]=Object(L.b)(new Date(u[p]),Object(b.d)(Object(f.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c},t}(U),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t}(U);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Y=r("Je7O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(e){var t={};try{if(e){var r=/\w+=\w+/;e.split(/\s*,\s*/).forEach((function(e){if(e&&r.test(e)){var n=e.split("="),a=n[0],i=n[1];t[a]=i}}))}}catch(t){throw"Failed to parse chart custom properties, value: "+e+" "}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var J=r("S2mk"),Z=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $(e,t,r){var n=(new DOMParser).parseFromString(t,"text/xml");return function(e,t){var r=e.getElementsByTagName("parsererror");if(r&&r.length>0)throw new D("ChartError",Object(g.b)(t,m.t),Object(g.b)(t,m.s))}(n,e),{chartPresentationSeries:ee(e,n,r),chartPresentationLegendList:ne(n),colorsList:re(n),chartPresentationArea3DStyle:ce(n),chartPresentationAreaGradientStyle:le(n),chartPresentationXAxis:ie(n),chartPresentationYAxis:oe(n),chartPresentationAnnotationList:ae(n)}}function ee(e,t,r){for(var n=new Array,a=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer,o=0;o<a.length;o++){var s=a[o],c={},l=s.getAttribute("ChartType")||"Column";if(-1===Z.indexOf(l.toUpperCase()))throw new D("ChartError",Object(g.b)(e,m.t),Object(g.b)(e,m.t));c.ChartType=l;var u=s.getAttribute("Color");c.Color=u?ue(u):null;var d=s.getAttribute("LegendText");c.LegendText=d||null;var p=s.getAttribute("CustomProperties");c.CustomProperties=K(p);var h=s.getAttribute("BorderColor");c.BorderColor=h?ue(h):null;var f=s.getAttribute("BorderWidth");c.BorderWidth=f?Number(f):null;var b=s.getAttribute("IsValueShownAsLabel");c.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,c.Label=s.getAttribute("Label");var v=s.getAttribute("YAxisType");c.SecondaryYAxis=v&&"secondary"===v.toLowerCase();var y=s.getAttribute("IsVisibleInLegend");c.HideInLegend=y&&"false"===y.toLowerCase();var _=s.getAttribute("LabelForeColor");c.LabelForeColor=_?ue(_):null,c.LabelFormat=s.getAttribute("LabelFormat");var O=te(e,s.outerHTML||i.serializeToString(s),r);c.Name=O||null,c.Stack=c.CustomProperties.StackedGroupName,n.push(c)}return n}function te(e,t,r){var n=Object(o.a)(t);if(Object(J.j)(n)||n.length<5)return"";var a=n[2].toLowerCase(),i=n[4],s="",c=a.substring(0,r.length);if(c!==r)return"";var l=a.substring(r.length+1,a.length),u=Object(_.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter((function(e){return e.Value.toString().toLowerCase()===i.toLowerCase()}))[0].Label),s}function re(e){var t=new Array,r=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==r&&r.split(";").forEach((function(e){if(e){var r=ue(e);t.push(r)}})),t}function ne(e){for(var t=new Array,r=e.querySelectorAll("Chart Legends Legend"),n=0;n<r.length;n++){var a={},i=r[n].getAttribute("Enabled");a.Enabled=null===i||"True"===i,t.push(a)}return t}function ae(e){for(var t=new Array,r=e.querySelectorAll("Chart Annotations TextAnnotation"),n=0;n<r.length;n++){var a=r[n],i={},o=a.getAttribute("X");i.X=o?Number(o):null;var s=a.getAttribute("Y");i.Y=s?Number(s):null,i.Text=a.getAttribute("Text");var c=a.getAttribute("ForeColor");i.ForeColor=c?ue(c):null,t.push(i)}return t}function ie(e){for(var t=new Array,r=e.querySelectorAll("Chart ChartAreas ChartArea AxisX"),n=0;n<r.length;n++){var a=r[n],i={};se(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");var o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){var s=null==o?void 0:o.getAttribute("ForeColor"),c=null==o?void 0:o.getAttribute("Enabled");i.LabelForeColor=s?ue(s):null,i.LabelDisabled=c&&"false"===c.toLowerCase(),i.FormatString=o.getAttribute("Format")}var l=a.getAttribute("Enabled"),u=a.getAttribute("LineColor"),d=a.getAttribute("TitleForeColor");i.Disabled=l&&"false"===l.toLowerCase(),i.AxisLineColor=u?ue(u):null,i.AxisTitleForeColor=d?ue(d):null,i.Disabled=l&&"false"===l.toLowerCase();var p=a.getAttribute("IsReversed");i.IsReversed=p&&"true"===p.toLowerCase(),t.push(i)}return t}function oe(e){var t=new Array,r=function(e,r){var n,a,i={};if(e){var o=e;i.Title=o.getAttribute("Title"),se(i,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);var s=o.getAttribute("Enabled");i.Disabled=s&&"false"===s.toLowerCase();var c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;var d=o.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(i.FormatString=d[0].getAttribute("Format"));var p=null===(n=null==d?void 0:d[0])||void 0===n?void 0:n.getAttribute("ForeColor");i.LabelForeColor=p?ue(p):null;var h=null===(a=null==d?void 0:d[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=h&&"false"===h.toLowerCase();var g=o.getAttribute("LineColor");i.AxisLineColor=g?ue(g):null;var m=o.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?ue(m):null,t.splice(r,0,i)}else t.splice(r,0,i)},n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return n&&r(n[0],0),(n=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"))&&r(n[0],1),t}function se(e,t,r){if(e){if(t){var n=t.getAttribute("LineColor"),a=t.getAttribute("Enabled");e.AxisMajorGridColor=n?ue(n):null,e.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(r){var i=r.getAttribute("LineColor"),o=r.getAttribute("Enabled");e.AxisMajorTickMarkColor=i?ue(i):null,e.AxisMajorTickMarkEnabled=o&&"true"===o.toLowerCase()}return e}}function ce(e){var t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),r={};return r.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),r}function le(e){var t=e.querySelector("Chart ChartAreas ChartArea"),r={};return r.BackColor=t?t.getAttribute("BackColor"):"",r.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",r.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",r}function ue(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){var t=[];e.split(",").forEach((function(e){return t.push(e.trim())}));var r=t.shift(),n=parseFloat(r)/255,a=t.slice();return a.push(n.toString()),String.format("rgba({0})",a.join(","))}return e}var de=r("BuSU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function pe(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var he=function(){function e(e,t,r,n,a,i,o,s){this._getState=e,this._chartData=a,this._viewRecord=t,this._visualizationRecord=r,this._chartDataDescription=n,this._chartPresentationXML=i,this._drilldownChartType=o,this._entityLogicalName=s}return e.prototype.buildChartModel=function(){if(this._chartQueryModel=Object(de.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof D))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel},e.prototype._buildDataEmptyMessage=function(){var e=Object(g.b)(this._getState(),m.m),t=pe();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)},e.prototype._buildErrorMessage=function(e){this._chartQueryModel.Title=pe(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)},e.prototype._buildChartHeading=function(){var e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=pe(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()},e.prototype._buildChartPresentation=function(){var e,t=this;this._chartPresentationParser=$(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach((function(e){e.ChartType=t._drilldownChartType})),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList},e.prototype._buildChart=function(){this._chartParserType=this._getChartParserType();var e=function(e){var t=null;switch(e){case 2:t=new W;break;case 3:t=new H;break;case 1:default:t=new Q}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()},e.prototype._getChartParserType=function(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1},e}(),ge=r("8ADW"),me=r("y5DA"),fe=r("kKaT"),be=r("TbLg"),ve=r("z8lM"),ye=r("Fpc+"),_e=r("ZZrQ"),Oe=r("AhDg");function Se(e,t,r){return{type:"chartData.retrieve.core.async",execute:function(n,i,s){var c=n.dispatch,l=n.getState,u=[];try{var d=l();if(!Object(o.b)(l,c,i,u,e,t,r,!0))return Promise.resolve();var p=new _e.a(e.fetchXml);p.set_NoLock(!0),p.set_PageSize(e.dataDefinition.entityExpression.top);var h=function(e){var t={};if(null!=e){var r=new _e.a(e);r.set_PageSize(0),r.set_NoLock(!0),t[""]=r}return t}(e.viewXml);return function(e,t,r,n){var i=new Oe.a(a.a.toString(a.a.newGuid()),n&&n.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,r,i).nativePromise()}(i.DataSource,p,h,s).then((function(n){var i=function(t,r,n){var a=new Te(e.viewTitle,e.viewEntityLogicalName),i=new Te(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(ve.a)(t);Object(o.e)(s,c,r());var l=e;return new he(r,a,i,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,n).buildChartModel()}(n,l,t);Object(k.c)(d,M.rd)?(c(Pe(e.getStorageKey(),i)),Ie(d,c,e.getStorageKey(),r)):(c(je(a.a.toString(e.visualizationId),a.a.toString(e.viewId),i)),Ce(d,c,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r))})).catch((function(t){Object(me.c)(d,c,t,e,r)}))}catch(e){return i.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),ge.b,u),Promise.reject(e)}}}}function Ce(e,t,r,i,o){if(e){var s=new a.a(r),c=a.a.toString(s),l=new a.a(i),u=a.a.toString(l),d={},p={};if(p[u]=function(e,t,r,a){if(!e)return null;if(a&&""!==a){var i=Object(be.c)(e,t,r),o=i&&i.slice();return Object(n.a)(o,a)}return null}(e,c,u,o),p[u]){d[c]=p;var h={entities:null,lists:null,charts:d};t(Object(fe.b)(h))}}}function Ie(e,t,r,a){if(e){var i={};if(i[r]=function(e,t,r){if(!e)return null;if(r){var a=Object(be.b)(e,t),i=a&&a.slice();return Object(n.a)(i,r)}return null}(e,r,a),i[r]){var o={entities:null,lists:null,charts:null,chartData:i};t(Object(fe.b)(o))}}}function je(e,t,r){var n,o,s=new a.a(e),c=a.a.toString(s),l=new a.a(t),u=a.a.toString(l),d={charts:(n={},n[c]=(o={},o[u]={initialized:i.a.Initialized,chartConfigObject:r},o),n)};return{type:ye.d,payload:d}}function Pe(e,t){var r,n={chartData:(r={},r[e]={initialized:i.a.Initialized,chartConfigObject:t},r)};return{type:ye.d,payload:n}}var Te=function(){function e(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}return e.prototype.get_DisplayName=function(){return this._displayName},e.prototype.get_AssociatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e}()},"A/RO":function(e,t,r){"use strict";r.d(t,"a",(function(){return S}));var n,a=r("9r0m"),i=r("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(n||(n={}));var o=r("nbQV"),s=r("lKeh"),c=r("QAhb"),l=r("VnpK"),u=r("S2mk"),d=r("F2uj"),p=r("T576"),h=r("HSdq"),g=r("Sscr"),m=r("lMVv"),f=r("WS0f"),b=r("qC0c"),v=r("U0B9"),y=r("sOTk"),_=r("MSdU"),O=r("r0s4"),S=function(){function e(e,t,r){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=r}return e.prototype.generate=function(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null},e.prototype._getBusinessProcessFlowWrapper=function(e,t){var r=this._getState(),n=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!n||!t||!t.getProcessId())return null;var i=t.getCurrentFormEntity(),c=Object(y.g)(r,e);this._navigationEntities=t.getNavigationEntities();var l=Object(p.f)(r,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(r,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(n.data.activePath,n.activeStageId,n.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:n.activeStageId,selectedStageId:n.data.selectedStageId,activePath:n.data.activePath,displayState:n.displayState,currentEntity:new _.a(i.etn,a.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(h.Lb)(r,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:n.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}},e.prototype._getStages=function(e,t,r,n,i){var o=this;if(!e||0===e.length)return null;var s={},c=[];return e.forEach((function(e,l){s[e.guid]=l;var u=a.a.equals(e,r),d=o._getStageWrapper(e,u,t,s,n,i);d&&c.push(d)})),c},e.prototype._getStageWrapper=function(e,t,r,n,i,o){var c=this,l=Object(s.c)(this._getState(),o.getProcessId(),e);if(!l)return null;var u=t&&this._getSteps(l,i,o)||[];if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var d="BusinessProcessFlow.CustomControlConfiguration",p=this._context.TraceManager.getTracer(d),h=Object(s.a)(this._getState(),o.getProcessId(),p);if(!Object(f.a)(h)&&!Object(f.a)(h.ControlConfigurations)){var g=o.getTelemetryParams();if(g.push({name:"BPFEntityFormId",value:h.Id.guid},{name:"BPFEntityFormType",value:h.FormType}),Object(f.a)(h.ControlConfigurations)||g.push({name:"CustomControls",value:Object.keys(h.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),h,p))try{if(!Object(f.a)(h.ControlConfigurations)){var v=Object(s.b)(h,p),y=h.ControlConfigurations,_=this._getNonDefaultControlConfiguration(y);if(Object(b.c)(this._getState(),"FCB.EnableBPFCCPhase3")){var O=this._buildStepsFromFormXml(l,h,_,g,i,o);O&&O.length>0&&(u=O,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(d,g))}else Object(f.a)(v)||Object.keys(v).forEach((function(e){if(v[e].ParentCellId){var t=new a.a(v[e].ParentCellId);if((l&&l.stage&&l.stage.steps?l.stage.steps.map((function(e){return e.stepId.guid})).indexOf(t.guid):-1)>=0&&t){var r=[];r.push({name:"StepId",value:t.guid},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),p.info("Non-default control found for step",r);var n=null;_&&v[e].UniqueId&&(o.setFormXmlRenderingIndicator(!0),n=_[v[e].UniqueId]?_[v[e].UniqueId]:null);var i={attributeName:v[e].DataFieldName,isRequired:c._getIsStepRequired(t.guid,l),name:v[e].Label,stepId:new a.a(t.guid),stepType:"field",attributeType:c._getMetadataTypeByAttribute(l.entityLogicalName,v[e].DataFieldName),controlName:"header_process_"+v[e].Label,isVisible:v[e].Visible,isControlDisabled:v[e].Disabled,nonDefaultConfiguration:n};u.push(i),Object(f.a)(i.stepId.guid)||i.stepId.guid===a.a.EMPTY.guid||g.push({name:"StepId",value:i.stepId.guid}),g.push({name:"AttributeName",value:i.attributeName},{name:"AttributeType",value:i.attributeType},{name:"IsRequired",value:i.isRequired},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),Object(f.a)(n)?c._context.EventManager.ReportComponentFailure(d,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,g):(o.setCustomControlIndicator(!0),g.push({name:"CustomControlId",value:n.CustomControlId}),!Object(f.a)(n.Name)&&n.Name.indexOf("MscrmControls")>=0&&g.push({name:"CustomControlName",value:n.Name}),c._context.EventManager.ReportComponentSuccess(d,g))}}}))}}catch(e){p.error("Message: "+e.message+", Stack: "+e.stack,g),this._context.EventManager.ReportComponentFailure(d,e,null,g)}else this._context.EventManager.ReportComponentFailure(d,new Error("Invalid FormXML - Fallback invoked"),null,g)}}return{id:l.stage.stageId,name:l.stage.stageDisplayName,entityName:l.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),l.entityLogicalName)||l.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(l.entityLogicalName),referencingAttributeName:l.referencingAttributeName,status:this._getStageStatus(n[e.guid],n[r.guid],o),steps:u}},e.prototype._buildStepsFromFormXml=function(e,t,r,n,i,o){var s=this,c=[],l=t.Controls;return!Object(f.a)(l)&&this._areStepsValid(e,t,n)&&Object.keys(l).forEach((function(u){if(!Object(f.a)(l[u])&&l[u].ParentCellId){var d=new a.a(l[u].ParentCellId),p=t.Tabs.find((function(e){return e.Id===l[u].ParentTabId}));if(p&&!Object(f.a)(p.RawTabId)&&e.stage.stageId.guid===new a.a(p.RawTabId).guid){var g=null;r&&l[u].UniqueId!==a.a.EMPTY.guid&&(g=r[l[u].UniqueId]?r[l[u].UniqueId]:null);var m=s._retrieveControlName(l[u],e.stage.steps),b=s._getUIControl(i,m),v={attributeName:l[u].DataFieldName,isRequired:l[u].IsRequired,name:s._retrieveStepLabel(l[u],b,e.stage.steps),stepId:new a.a(d.guid),stepType:s._getStepTypeFromControlKey(u),attributeType:s._getMetadataTypeByAttribute(e.entityLogicalName,l[u].DataFieldName),controlName:m,isVisible:b&&!Object(f.a)(b.visible)?b.visible:l[u].Visible,isControlDisabled:l[u].Disabled||Object(h.t)(s._getState(),{id:i,controlName:m},o.getContextToken()),viewId:b&&b.parameters&&b.parameters.defaultviewid?b.parameters.defaultviewid:null,nonDefaultConfiguration:Object(f.a)(g)?null:g};v.config=s._getConfig(t,o,l[u],i,n),v.viewId&&v.config&&v.config.Parameters&&v.config.Parameters.value&&(v.config.Parameters.value.ViewId=v.viewId,b&&b.customFilter&&b.customFilter.length>0&&(s._applyLookupFilter(v,b),v.config.Parameters.value.ExtraFilters=v.extraFilters)),c.push(v),n.push({name:"StepId",value:v.stepId.guid},{name:"AttributeName",value:v.attributeName},{name:"AttributeType",value:v.attributeType},{name:"IsRequired",value:v.isRequired},{name:"NonDefaultControlUniqueId",value:l[u].UniqueId}),Object(f.a)(g)||l[u].UniqueId===a.a.EMPTY.guid||(o.setCustomControlIndicator(!0),n.push({name:"CustomControlId",value:g.CustomControlId}),!Object(f.a)(g.Name)&&g.Name.indexOf("MscrmControls")>=0&&n.push({name:"CustomControlName",value:g.Name}))}}})),c},e.prototype._areStepsValid=function(e,t,r){if(!(Object(f.a)(t)||Object(f.a)(e)||Object(f.a)(e.stage)||Object(f.a)(e.stage.stageId))){var n=t.Controls,i=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(f.a)(n)){if(Object.keys(n).forEach((function(e){if(!Object(f.a)(n[e].ParentCellId)){var r=new a.a(n[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find((function(t){return t.Id===n[e].ParentTabId}));if(!Object(f.a)(o)&&!Object(f.a)(o.RawTabId)){var c=new a.a(o.RawTabId).guid.toLowerCase();i===c&&s.indexOf(r)<0&&s.push(r)}}})),o.length!==s.length)return r.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(var c=0;c<o.length;c++)if(s.indexOf(o[c].stepId.guid.toLowerCase())<0)return r.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[c].stepId.guid.toLowerCase()}),!1;return!0}}return!1},e.prototype._retrieveStepLabel=function(e,t,r){if(!Object(f.a)(t)&&!Object(f.a)(t.label)&&""!==t.label)return t.label;if(!Object(f.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(f.a)(r)&&r.length>0)for(var n=0,i=r;n<i.length;n++){var o=i[n];if(o.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.a)(o.label)&&""!==o.label)return o.label}return""},e.prototype._retrieveControlName=function(e,t){if(!Object(f.a)(t)&&t.length>0)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.b)(i.controlName))return i.controlName}return Object(f.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName},e.prototype._getConfig=function(e,t,r,n,a){try{var i=Object(h.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:r&&r.Name});var c=i(this._getState(),r,n,o,s&&s.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){a.push({name:"CCFControlConfigError",value:e})}return null},e.prototype._getStageStatus=function(e,t,r){return null==t||e<t?n.Completed:e===t?r.getStatus()===i.a.Finished?n.Completed:n.Active:n.Inactive},e.prototype._getSteps=function(e,t,r){var n=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(var a=0,i=e.stage.steps;a<i.length;a++){var o=i[a],c=this._getUIControl(t,o.controlName),l=null;if(o.name&&o.stepType&&"field"===o.stepType.toLowerCase()){if(!(l=this._getMetadataTypeByAttribute(e.entityLogicalName,o.name)))continue;if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var u=this._context.TraceManager.getTracer("BpfCustomControlSupport"),d=Object(s.a)(this._getState(),r.getProcessId(),u);if(!Object(f.a)(d)&&!Object(f.a)(d.ControlConfigurations)&&r.isBpfFormDescriptorValid(this._getState(),r.getProcessId(),d,u)){var p=Object(s.b)(d,u),g=this._getNonDefaultControlStepIds(p);if(!Object(f.a)(g)&&g.map((function(e){return e.guid})).indexOf(o.stepId.guid)>=0)continue}}}var m=this._getState(),v={attributeName:o.name,controlName:o.controlName,isRequired:o.required,isVisible:!c||c.visible,name:c?c.label:o.label,stepId:o.stepId,stepType:o.stepType,attributeType:l,viewId:c&&c.parameters&&c.parameters.defaultviewid?c.parameters.defaultviewid:o.viewId,isControlDisabled:Object(h.t)(m,{id:t,controlName:o.controlName},r.getContextToken())};v.viewId&&c&&c.customFilter&&c.customFilter&&c.customFilter.length>0&&this._applyLookupFilter(v,c),n.push(v)}return n},e.prototype._applyLookupFilter=function(e,t){var r;r=!1;var n=[];if(e&&t){for(var a=0;a<t.customFilter.length;a++){if("END_FLAG"===t.customFilter[a].customFilter){r=!0;break}if("START_FLAG"!==t.customFilter[a].customFilter){var i=Object(l.i)(Object(O.CrmHtmlDecode)(t.customFilter[a].customFilter));i&&(i.conditions&&i.conditions.length>0||i.filters&&i.filters.length>0)&&n.push(JSON.stringify(i))}}r?(this._memorizedExtraFilters=n,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}},e.prototype._getMetadataTypeByAttribute=function(e,t){var r=this._getState(),n=Object(d.a)(r,e,t);if(!n)return null;var a=n.Type+"."+n.Format;return Object(u.n)(a)},e.prototype._getActions=function(e){return{completeProcess:function(){return e.completeProcess()},moveNext:function(){return e.moveToNextStage()},movePrevious:function(){return e.moveToPreviousStage()},setActiveStage:function(t){return e.setActiveStage(t.guid)},setSelectedStage:function(t,r){void 0===r&&(r=!1),e.setSelectedStage(t?t.guid:null,r)},triggerActionStepClick:function(t){e.triggerActionStepClick(t)},triggerFlowStepClick:function(t,r){e.triggerFlowStepClick(t,r)},refreshFlowStepClick:function(t){e.refreshFlowStepClick(t)},setDisplayState:function(t){e.setDisplayState(t)},getForwardNavigationEntities:function(t,r,n,a){return e.getForwardNavigationEntities(t,r,n,a)},navigateToNextEntity:function(t,r,n,a){return e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(r),n,a)},executePreEvent:function(t,r,n,a){return e.executePreEvent(t,r,n,a)},validateRequiredFieldsForNavigation:function(){return e.ValidateRequiredFieldsForNavigation()},waitForOngoingWork:function(){return e.waitForOngoingWork()},getActiveStageActiveFor:function(){return e.getActiveStageActiveFor()},getBpfInstanceActiveFor:function(){return e.getBpfInstanceActiveFor()},getBpfInstanceCompletedIn:function(){return e.getBpfInstanceCompletedIn()},getBpfNavigationBehavior:function(){return e.getBpfNavigationBehavior()},setBpfNavigationBehavior:function(t){e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:function(t){return e.getBpfNavigationBehaviorAllowCreateNew(t)},getActiveStage:function(){var t=e.getContextToken(),r=e.getScriptContainer().getEventManager().getClientApiForm(t);return r?r.data.process.getActiveStage():null}}},e.prototype._getRelatedEntityReference=function(e){if(!this._navigationEntities)return null;var t=this._navigationEntities.find((function(t){return t.entityLogicalName===e}));return t?new _.a(t.entityLogicalName,a.a.toLegacyGuid(a.a.parse(t.id))):null},e.prototype._getUIControl=function(e,t){if(t){var r=this._getState(),n=Object(g.j)(r,e),a={controlName:t,id:e};return Object(h.Mc)(this._getState(),a,n)}return null},e.prototype._getNonDefaultControlConfiguration=function(e){var t={};if(e)for(var r=Object.keys(e),n=0;n<r.length;n++){var a,i=Object(v.b)(this._getState());(a=e[r[n]].CustomControls[i])&&(t[r[n]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}return t},e.prototype._getNonDefaultControlStepIds=function(e){var t=[];return e&&Object.keys(e).forEach((function(r){e[r].ParentCellId&&t.push(new a.a(e[r].ParentCellId))})),t},e.prototype._getIsStepRequired=function(e,t){var r=t.stage.steps,n=r?r.map((function(e){return e.stepId.guid})).indexOf(e):-1;return n>=0&&!Object(f.a)(r[n].required)&&r[n].required},e.prototype._getStepTypeFromControlKey=function(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"},e}()},A8fJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.contentType";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i,meta:{pageId:e,tabId:t,contextKey:o}}}},ABRM:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.format";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},AVer:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r("G7N+"),a=r("Sscr"),i=r("c56u"),o=r("kJGL"),s=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,r,i,o,c,u,d){var p,h=Object(a.v)(o),g=function(e,t){var r;if(!e)return null;var n=new DOMParser,a=e?n.parseFromString(e,"text/xml"):null;if(!a)return null;var i=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!i)return null;for(var o=i,s=[],c=0;c<o.length;c++)if(o[c].getAttribute){for(var u=o[c]?o[c].children?o[c].children:o[c].childNodes:void 0,d=[],p=null,h=0;h<u.length;h++){var g=u[h];if(g.getAttribute){var m=g.getAttribute("name"),f=void 0;f=(r=l(m,p,n,t)).relatedEntityName,p=r.fetchXmlDocument,d.push({name:m,width:parseInt(g.getAttribute("width"),10),relatedEntityName:f,disableMetaDataBinding:"1"===g.getAttribute("disableMetaDataBinding"),labelId:g.getAttribute("labelId"),isHidden:"1"===g.getAttribute("isHidden"),disableSorting:"1"===g.getAttribute("disableSorting"),addedBy:g.getAttribute("addedBy"),desc:g.getAttribute("desc"),cellType:g.getAttribute("cellType"),imageProviderWebresource:g.getAttribute("imageProviderWebresource"),imageProviderFunctionName:g.getAttribute("imageProviderFunctionName")})}}var b={name:o[c].getAttribute("name"),id:o[c].getAttribute("id"),cells:d,multiObjectIdField:o[c].getAttribute("multiObjectIdField"),layoutStyle:o[c].getAttribute("multiObjectIdField")};s.push(b)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),m={initialized:n.a.Initialized,viewId:r,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:g,isCustomView:!0};return{type:s.a,payload:{views:(p={},p[r.guid]=m,p)},meta:{pageId:e,controlName:t,contextKey:h}}}function l(e,t,r,n){var a="";if(e.indexOf(".")>0){var i=e.split(".")[0];t||(t=r.parseFromString(n,"text/xml"));var o=t.querySelector('link-entity[alias="'+i+'"]');o&&(a=o.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:function(t,r){return(Object(i.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then((function(t){return e.offlineSqlQuery=t}))}}}},ApiM:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return l}));var n=r("9r0m"),a=r("7z0H"),i=r("Sscr"),o="businessProcessFlow.attributes.add",s="businessProcessFlow.controls.add";function c(e,t,r){var n=Object(i.v)(e);return{type:o,payload:{attributes:d(r)},meta:{pageId:t,contextKey:n}}}function l(e,t,r){var n=Object(i.v)(e);return{type:s,payload:{controls:u(r)},meta:{pageId:t,contextKey:n}}}function u(e){var t={};for(var r in e&&!e.header_process&&(e.header_process={Id:null,Label:null,Name:"header_process",ShowLabel:!1,Visible:!0,Disabled:!1,DataFieldName:null,UniqueId:null,ClassId:n.a.tryParse("06E9F7AF-1F54-4681-8EEC-1E21A1CEB465")}),e){var i=Object(a.f)(e[r],null,!0);i&&(t[r]=i)}return t}function d(e){var t={};for(var r in e){var n=e[r],a={Precision:n.Precision,PrecisionSource:n.PrecisionSource,RequiredLevel:n.RequiredLevel,Format:n.Format,OptionSet:n.OptionSet,IsValidForCreate:n.IsValidForCreate,IsValidForUpdate:n.IsValidForUpdate,Targets:n.Targets};t[n.LogicalName]=a}return t}},As2E:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("7cIM"),a=r("Tk0/"),i=r("r0s4"),o=r("4pqm"),s=["app.powerbi.com","msit.powerbi.com","app.powerbigov.us","app.high.powerbigov.us","app.mil.powerbigov.us","app.powerbi.cn","powerbi-df.analysis-df.windows.net"];function c(e){return{type:"dashboard.openinpowerbi",execute:function(t){var r=t.dispatch,n=t.getState,i=Object(a.a)(n(),e);return i?r(l(i.TileUrl,i.Type,i.PowerBIGroupId,i.PowerBIDashboardId,null,i.PowerBIReportId)):Promise.resolve()}}}function l(e,t,r,a,c,l){return{type:"powerbi.openInPowerBICore",execute:function(u,d){var p=u.dispatch,h=d.TraceManager.getTracer("PowerBI"),g=new o.a(e),m=g.hostname,f=g.pathname,b=g.searchParams,v="app.powerbi.com";-1!==s.indexOf(m)?v=m:h.error("Invalid PowerBI domain, using "+v,[{name:"PowerBIDomain",value:m}]);var y,_=new o.a("https://"+v+"/MobileRedirect.html"),O=_.searchParams;switch(t){case"0":y="OpenTile",O.set("tileObjectId",Object(i.CrmUrlEncode)(c));case"1":y=y||"OpenDashboard",O.set("dashboardObjectId",Object(i.CrmUrlEncode)(a));break;case"2":y=(null==f?void 0:f.endsWith("rdlEmbed"))?"OpenRdlReport":"OpenReport",O.set("reportObjectId",Object(i.CrmUrlEncode)(l));var S=b.get("pageName");S&&O.set("reportPage",Object(i.CrmUrlEncode)(S));break;default:return h.error("Invalid PowerBIObjectType",[{name:"PowerBIObjectType",value:t}]),Promise.reject("Invalid PowerBIObjectType: "+t)}return O.set("action",y),r&&O.set("groupObjectId",Object(i.CrmUrlEncode)(r)),p(Object(n.a)(_.toString())),Promise.resolve()}}}},BWVO:function(e,t,r){"use strict";r.d(t,"a",(function(){return ke})),r.d(t,"b",(function(){return Me}));var n,a,i,o,s,c,l,u,d,p=r("1z64"),h=r("9r0m"),g=r("9rlF"),m=r("QAhb"),f=r("ezfI"),b=r("F2uj"),v=r("iutC"),y=r("yHpA"),_=r("FuJ2"),O=r("o0+l"),S=r("HSdq"),C=r("5jMY"),I=r("Zy0S"),j=r("ObKm"),P=r("w/nD"),T=r("+Z9T"),E=r("IiPO"),w=r("Sscr"),F=r("lMVv"),x=r("zsi3"),A=r("xirW"),N=r("hCnb"),D=r("2p2B"),k=r("uQP8"),M=r("r0s4"),R=r("Srej"),L="ClientApi.XrmEntityAttribute.",B=function(){function e(e,t,r,a,i,o){n=e,this._clientApiExecutorAttribute=new p.a(e,L,r,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});var s=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(T.j)(s,"attributeName"),e||Object(T.j)(s,"store"),r||Object(T.j)(s,"pageId"),t||Object(T.j)(s,"contextToken"),o||Object(T.j)(s,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=r,this.xrmFormUi=o,this._contextToken=t}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutorAttribute.execute("controls",(function(t,r){if(!e._controls){e._controls=new I.a(t);var a=Object(S.z)(n.getState(),e._pageId,e.contextToken,e._attributeName);if(a){e.xrmFormUi.getControls();for(var i=e.xrmFormUi.controls,o=0;o<a.length;o++){var s=a[o],c=i.get(s);c&&e._controls.add(s,c)}}}return e._controls}))},enumerable:!1,configurable:!0}),e.prototype.addOnChange=function(e){var t=L+"addOnChange";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(P.a)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.fireOnChange=function(){var e=L+"fireOnChange";try{f.a.instance.reportCall(e),n.dispatch(Object(P.P)(this.contextToken,this._pageId,this.getName())),f.a.instance.reportSuccess(e)}catch(r){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getAttributeType=function(){var e=L+"getAttributeType";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().Type;return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getFormat=function(){var e=this;return this._clientApiExecutorAttribute.execute("getFormat",(function(){var t=e.getAttrDescriptor();if(!t||!t.Format)return null;var r=t.Format.toLowerCase(),n=r;switch(e.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==r&&"2"!==r||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===r&&(n="none");break;case"memo":"2"!==r&&"1"!==r||(n="textarea");break;default:"0"===r?n="none":void 0===n&&(n=null)}return n}))},e.prototype.getIsDirty=function(){var e=L+"getIsDirty";try{f.a.instance.reportCall(e);var t=Object(S.Jb)(n.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(y.e)(n.getState(),Object(S.ac)(n.getState(),this.getPageId(),this.dataContextToken),this.getName());return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getName=function(){return f.a.instance.reportUsage(L+"getName"),this._attributeName},e.prototype.getParent=function(){return f.a.instance.reportUsage(L+"getParent"),this._parentEntity},e.prototype.getRequiredLevel=function(){var e=L+"getRequiredLevel";try{f.a.instance.reportCall(e);var t=Object(S.pc)(n.getState(),this._pageId,this.dataContextToken,this.getName()),r=void 0;switch(t){case 2:case 1:r="required";break;case-1:case 0:r="none";break;case 3:r="recommended";break;default:Object(T.h)(e,"RequiredLevel",t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getSubmitMode=function(){var e=L+"getSubmitMode";try{f.a.instance.reportCall(e);var t=Object(S.zc)(n.getState(),this._pageId,this.contextToken,this.getName()),r=void 0;switch(t){case C.a.Dirty:r="dirty";break;case C.a.Always:r="always";break;case C.a.Never:r="never";break;default:Object(T.h)(e,"SubmitMode",t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getUserPrivilege=function(){var e=L+"getUserPrivilege";try{f.a.instance.reportCall(e);var t=null;if(n.getState()&&this._parentEntity&&this._attributeName){var r=Object(v.a)(n.getState(),this._parentEntity.getEntityName(),h.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);r&&(t={canCreate:r.canCreate,canRead:r.canRead,canUpdate:r.canUpdate})}return f.a.instance.reportSuccess(e),t}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getValue=function(){var e=L+"getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return Object(T.a)(t)||(Object(g.j)(t)?r=t.value:Object(T.k)(e,"isPlainValue","value")),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnChange=function(e){var t=L+"removeOnChange";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),n.dispatch(Object(P.v)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setRequiredLevel=function(e){var t=L+"setRequiredLevel";e||Object(T.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(T.h)(t,"RequiredLevel",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"none":r=0;break;case"recommended":r=3;break;case"required":r=2}n.dispatch(Object(_.b)(this._pageId,this.dataContextToken,this._attributeName,r)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setSubmitMode=function(e){var t=L+"setSubmitMode";e||Object(T.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(T.h)(t,"SubmitMode",e);try{f.a.instance.reportCall(t);var r=void 0;switch(e){case"dirty":r=C.a.Dirty;break;case"always":r=C.a.Always;break;case"never":r=C.a.Never}n.dispatch(Object(O.b)(this._pageId,this.contextToken,this.getName(),r)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setValue=function(e){var t=L+"setValue";try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setIsValid=function(e,t){var r=this;return this._clientApiExecutorAttribute.execute("setIsValid",(function(a,i){e?(n.dispatch(Object(N.b)(r._pageId,r._attributeName,!0,r.contextToken)),n.dispatch(Object(D.b)(r.contextToken,r._pageId,Object(R.d)(r._pageId,r._attributeName))),n.dispatch(Object(A.b)(n.getState(),r._pageId,r._attributeName,null,r.contextToken))):r._addNotification(t)}))},e.prototype._addNotification=function(e){n.dispatch(Object(N.b)(this._pageId,this._attributeName,!1,this.contextToken));var t={messages:[e],notificationLevel:x.a.error};n.dispatch(Object(A.b)(n.getState(),this._pageId,this._attributeName,t,this.contextToken))},e.prototype.isValid=function(){var e=L+"isValid";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=this.getParent();if(r){var a=Object(F.h)(n.getState(),r.getEntityName());if(a&&a.PrimaryIdAttribute!==this.getName()&&r.getId()!==h.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(T.a)(t))return f.a.instance.reportSuccess(e),!1}var i=!0;return this.hasErrorNotification()?i=!1:t&&t.validationResult&&(i=t.validationResult.isValueValid),f.a.instance.reportSuccess(e),i}catch(t){var o=E.a.getInstance().getEventParameters(this._contextToken);throw o.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.hasErrorNotification=function(){var e=Object(w.v)(this.contextToken),t=n.getState(),r=Object(k.a)(t,this._pageId);return!(!r.forms||!r.forms[e]||!r.forms[e].invalidControls&&!r.forms[e].invalidAttributes)&&(!0===r.forms[e].invalidControls[this.getName()]||!0===r.forms[e].invalidAttributes[this.getName()])},e.prototype.getPageId=function(){return this._pageId},e.prototype.getAttrDescriptor=function(){if(this.getParent()){var e=Object(S.r)(n.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(b.a)(n.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(S.Nc)(n.getState(),this.getPageId(),this.getName())},e.prototype.getDataXmlInternal=function(){var e="";return e=e+"<"+Object(M.CrmXmlEncode)(this.getName())+">"+Object(M.CrmXmlEncode)(this.getValue())+"</"+Object(M.CrmXmlEncode)(this.getName())+">"},e.prototype.setValueInternal=function(e){var t=this.getName(),r={};r[t]={fieldName:t,value:e},n.dispatch(Object(j.a)(this._pageId,r,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(w.t)(this._contextToken),this.contextToken))},Object.defineProperty(e.prototype,"parentEntityReference",{get:function(){var e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new m.a(e,new h.a(t)):new m.a(e)},enumerable:!1,configurable:!0}),e.prototype.getValueInternal=function(){var e=Object(S.ac)(n.getState(),this.getPageId(),this.dataContextToken);return Object(S.X)(n.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,n.dispatch)},Object.defineProperty(e.prototype,"contextToken",{get:function(){return Object(w.r)(this._contextToken)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataContextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}(),V=r("c/eZ"),G=r("TCcM"),U=r("TV33"),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getOption=function(e){var t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(T.a)(e))return null;var r="number"==typeof e?e:parseInt(e,10);isNaN(r)&&Object(T.k)(t,"number","value");try{f.a.instance.reportCall(t);for(var n=this.getAttrDescriptor().OptionSet,a=null,i=0;i<n.length;i++)n[i].Value===e&&(a={text:n[i].Label,value:n[i].Value});return f.a.instance.reportSuccess(t),a}catch(e){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e),e}},t.prototype.getOptions=function(){var e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().OptionSet.map((function(e){return{text:e.Label,value:e.Value}}));return f.a.instance.reportSuccess(e),t}catch(t){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t),t}},t}(B),q=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(a.getState(),this.parentEntityReference,this.getName()),r=t?parseInt(t.valueString,10):null;return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(U.a)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(T.a)(e)||"boolean"!=typeof e&&Object(T.k)(t,"boolean","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"},t}(z),X=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;return i=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(i.getState(),this.parentEntityReference,this.getName()),r=Object(U.e)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getSelectedOption=function(){var e=this,t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{f.a.instance.reportCall(t);var r=null,n=this.getValue();return n&&(r=[],n.forEach((function(t){var n=e.getOption(t);n&&r.push(n)}))),f.a.instance.reportSuccess(t),r}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{f.a.instance.reportCall(e);var t=null,r=this.getSelectedOption();return r&&(t=[],r.forEach((function(e){t.push(e.text)}))),f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;return t&&(r=Object(U.e)(t)),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{f.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t}(z),W=r("otJc"),H=r("dl9j"),Q=r("+h4s"),Y=r("sRkF"),K=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));var t=Object(M.CrmXmlEncode)(this.getName()),r="";return r+="<"+t+">",r+=""+(null===e?"":Object(M.CrmXmlEncode)(e.format("s"))),r+="</"+t+">"},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=null;if(Object(g.j)(t)&&!Object(T.a)(t.formatted)){var n=this.getAttrDescriptor();r=Object(U.b)(o.getState(),n,t)}return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._userSettings=function(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new H.a(o)},t.prototype.getUtcValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{f.a.instance.reportCall(e);var t=this.getValue();return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(T.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(T.k)(t,"Date","value");try{if(f.a.instance.reportCall(t),Object(T.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){var r=new Date,n=this.getAttrDescriptor(),a=Object(W.z)(o.getState(),n),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(Q.o)(new Date(r.getFullYear(),r.getMonth(),r.getDate()),a.userSettings.timeZoneAdjusters)-Object(Q.o)(e,a.userSettings.timeZoneAdjusters),c=6e4*e.getTimezoneOffset(),l=null;switch(a.controlAttributes.Behavior){case Y.a.UserLocal:l=new Date(e.getTime()+c+i-s);break;default:l=new Date(e.getTime())}this.setValueInternal(l)}f.a.instance.reportSuccess(t)}catch(e){var u=E.a.getInstance().getEventParameters(this.contextToken);throw u.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,u),e}},t.prototype.setUtcValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{f.a.instance.reportCall(t),this.setValue(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"},t}(B),J=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c}return Object(V.__extends)(t,e),t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1},t.prototype.getDataXmlInternal=function(){var e=this.getValue(),t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{var r=Object(M.CrmXmlEncode)(this.getName());t+="<"+r+">",t+="</"+r+">"}return t.toString()},t.prototype.getLookupDataXml=function(e,t){var r=Object(M.CrmXmlEncode)(e),n="<"+r,a=this.getEntityTypeCode(t.entityType);return a>0&&(n+=' type="'+Object(M.CrmXmlAttributeEncode)(a.toString())+'"'),t.entityType&&(n+=' typeName="'+Object(M.CrmXmlAttributeEncode)(t.entityType)+'"'),Object(T.a)(t.name)||(n+=' name="'+Object(M.CrmXmlAttributeEncode)(t.name)+'"'),n+=">"+Object(M.CrmXmlEncode)(t.id)+"</"+r+">"},t.prototype.getEntityTypeCode=function(e){return Object(F.p)(s.getState(),e)},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeLookup.setValue",r=null;if(e&&Array.isArray(e)&&e.length>0){e.length>1?Object(T.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?h.a.tryParseOrNull(e[0].id)||Object(T.h)(t,"guid",e[0].id):Object(T.j)(t,"value[0].id"):Object(T.j)(t,"value[0].entityType");var n=void 0;try{n=Object(S.Ob)(s.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getLookupTargets",e,null,a),e}if(n)if(!(n.indexOf(e[0].entityType)>-1))(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"actualValue",value:e[0].entityType}),Object(T.k)(t,"entityType","value[0].entityType",a);try{f.a.instance.reportCall(t),n?n.indexOf(e[0].entityType)>-1&&(r=new m.a(e[0].entityType,new h.a(e[0].id),e[0].name),this.setValueInternal(r)):this.setValueInternal(r),f.a.instance.reportSuccess(t)}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}}else this.setValueInternal(r)},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeLookup.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(U.d)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"},t}(B),Z=r("/wtJ"),$=r("kvLG"),ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return c=t,s._clientApiExecutorAttributeNumber=new p.a(t,"ClientApi.XrmEntityAttributeNumber.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getMax=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMax",(function(){return e.getAttrDescriptor().MaxValue}))},t.prototype.getMin=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMin",(function(){return e.getAttrDescriptor().MinValue}))},t.prototype.getPrecision=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getPrecision",(function(){return Object(S.k)(c.getState(),e.getPageId(),e.dataContextToken,e.getName())}))},t.prototype.setPrecision=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setPrecision",(function(r,n){"integer"===t.getAttributeType()&&Object(T.e)(r,"setPrecision is not valid on integer attributes",void 0,n);var a=Object(b.a)(c.getState(),t.getParent().getEntityName(),t.getName());(e<0||e>a.Precision)&&(n.push({name:"metadataPrecision",value:a.Precision}),Object(T.h)(r,"precision",e.toString(),n)),c.dispatch(Object(Z.b)(t.getPageId(),t.dataContextToken,t.getName(),e))}),[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getValue",(function(){var t=e.getValueInternal();return Object(U.f)(t,e.getAttributeType(),e.getPrecision())}))},t.prototype.setValue=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setValue",(function(){t.setValueInternal(e)}),[{name:"value",value:e,expectedDataType:"number"}])},t.prototype.getAttributeType=function(){var t=this;return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(function(r,n){var a=t.getAttrDescriptor().Type;switch(a){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return n.push({name:"attributeType",value:a}),a?t._clientApiExecutorAttributeNumber.reportFailure(r,new Error("Unexpected number attribute type."),n):$.a.getInstance().traceManager.getTracer(r).error("Number attribute type was not defined in metadata.",n),e.prototype.getAttributeType.call(t)}}))},t}(B),te=r("sOTk"),re=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return l=t,s}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(l.getState(),this.parentEntityReference,this.getName()),r=Object(te.m)(l.getState(),this.getPageId()),n=void 0;if(r){var a=this.getAttrDescriptor();n=Object(U.g)(t)||a&&a.DefaultFormValue?a.DefaultFormValue:null}else n=Object(U.g)(t);return f.a.instance.reportSuccess(e),n}catch(t){var i=E.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.getSelectedOption=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{f.a.instance.reportCall(e);var t=this.getOption(this.getValue());return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getText";try{f.a.instance.reportCall(e);var t=this.getSelectedOption(),r=null;return t&&(r=t.text),f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(U.g)(t),n=Object(T.a)(r)?Object(U.f)(t,this.getAttributeType(),0):r;return f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(T.k)(t,"number","value");var r=!1;try{if(e&&this.getParent()){var n=this.getAttrDescriptor();for(var a in n.OptionSet)if(e===n.OptionSet[a].Value){r=!0;break}}else r=!0}catch(e){throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,i),e}r||Object(T.h)(t,"OptionSetValue",e);try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var i;throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"},t}(z),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getMaxLength=function(){var e="ClientApi.XrmEntityAttributeString.getMaxLength";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().MaxLength;return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeString.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(U.i)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeString.setValue";Object(T.a)(e)||"string"!=typeof e&&Object(T.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){var t="ClientApi.XrmEntityAttributeString.getAttributeType";try{f.a.instance.reportCall(t);var r=void 0,n=this.getAttrDescriptor().Type;switch(n){case"memo":r="memo";break;case"string":r="string";break;default:(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"attributeType",value:n}),E.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,a),r=e.prototype.getAttributeType.call(this)}return f.a.instance.reportSuccess(t),r}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t}(B),ae=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutor=new p.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,r),s._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0}),s}return Object(V.__extends)(t,e),t.prototype.setValue=function(e){var t=this;this._clientApiExecutor.execute("setValue",(function(){t.setValueInternal(h.a.tryParseOrNull(e))}),[{name:"value",value:e,expectedDataType:"guid"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutor.execute("getValue",(function(){var t=e.getValueInternal();return Object(U.j)(t)}))},t.prototype.getAttributeType=function(){return this._clientApiExecutor.execute("getAttributeType",(function(){return"string"}))},t}(B),ie=r("nVTU"),oe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return u=t,s}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this,t=Object(M.CrmXmlEncode)(this.getName()),r=this.getValue(),n="";return n+="<"+t+">",r.forEach((function(t){n+="<activityparty>",n+=e.getLookupDataXml("partyid",t),n+="</activityparty>"})),(n+="</"+t+">").toString()},t.prototype.setValue=function(e){var t,r="ClientApi.XrmEntityAttributePartyList.setValue",n=E.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(T.k)(r,"LookupValue[]","value",n));var a=new Array;try{t=Object(S.Ob)(u.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw E.a.getInstance().reportFailure(r+".getLookupTargets",e,null,n),e}e&&t&&(t.push("unresolvedaddress"),e.forEach((function(e){t.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(T.e)(r,'LookupValue[] with invalid entity type. Entity type "'+e.entityType+'" is invalid.',"LookupValue[] with invalid entity type",n))})));try{f.a.instance.reportCall(r),e?(t?e.forEach((function(e){t.indexOf(e.entityType)>-1&&a.push(new ie.a(e.entityType,e.id,e.name))})):e.forEach((function(e){a.push(new ie.a(e.entityType,e.id,e.name))})),this.setValueInternal(a)):this.setValueInternal([]),f.a.instance.reportSuccess(r)}catch(e){throw E.a.getInstance().reportFailure(r,e,null,n),e}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributePartyList.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(U.h)(t);return f.a.instance.reportSuccess(e),r}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0},t}(J),se=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorAttributeFile=new p.a(t,"ClientApi.XrmEntityFile.",n,r,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeFile.execute("getValue",(function(){var t=e.getValueInternal();return Object(U.c)(t)}))},t.prototype.setValue=function(e){var t=this;this._clientApiExecutorAttributeFile.execute("setValue",(function(){t.setValueInternal(e)}))},t}(B),ce=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return d=t,s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeEntityName.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),r=Object(b.a)(d.getState(),this.getParent().getEntityName(),this.getName()),n=null;return r.IsEntityReferenceStored&&Object(g.j)(t)&&(n=t.value),f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(T.a)(e)||"string"==typeof e||Object(T.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"},t}(B),le=r("r529"),ue=r("Xia5"),de=r("jJRu"),pe=r("Cfob"),he=r("cAHA"),ge=r("8aRo"),me=r("+P1Q"),fe=r("qYad"),be=r("9qYn"),ve=r("yZTI"),ye=r("Z1aD"),_e=r("xc1f"),Oe=r("Gemh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Se(e,t,r,n){var a=Object(S.z)(e,t,r,n,r.relationshipName);if(!a||0===a.length)return!0;for(var i=0;i<a.length;i++)if(!Object(S.t)(e,{controlName:a[i],id:t},r))return!0;return!1}function Ce(e,t,r,n,a,i){if(!Object(Oe.K)(e,t,r,n,null==i?void 0:i.id))return!1;var o=Object(Oe.y)(e,r,t);if(!a||!o)return!1;if(o&&0===o[n])return!1;if(null===a.ParentPicklistLogicalName)return!0;var s=Object(S.ac)(e,t,r),c=Object(S.X)(e,t,r,s,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie,je,Pe,Te=r("UOiB"),Ee=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return Ie=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Ce(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")},t}(re),we=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return je=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var r,n="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";try{f.a.instance.reportCall(n),r=this.contextToken.contextTokenType===Te.a.MainGrid||this.contextToken.contextTokenType===Te.a.SubGrid||this.contextToken.contextTokenType===Te.a.AssociatedGrid?Ce(je.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(je.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(n)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(n,e,null,a),e}r?e.prototype.setValue.call(this,t):Object(T.e)(n,"Can not execute setValue for dependent option set attribute since it is disabled.")},t}(X),Fe=r("cZkS"),xe=r("qC0c"),Ae=r("3ZuC"),Ne=r("WVwd"),De=r("RK8T"),ke=function(){function e(e,t,r,n,a,i,o,s){Pe=e;var c=[{name:"pageId",value:r,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:n,isRequired:!0}];this._clientApiExecutor=new p.a(e,"ClientApi.XrmEntity.",r,t,c),this._pageId=r,this._xrmForm=n,this._contextToken=t,this._entityType=a,this._entityId=i,this._getAttributeNames=o,this._applicationContext=s}return Object.defineProperty(e.prototype,"attributes",{get:function(){var e=this;return this._clientApiExecutor.execute("attributes",(function(t,r){if(!e._attributes){e._attributes=new I.a(t);var n=e._getAttributeNames(e._applicationContext,e._contextToken,e._pageId);if(!n)return e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),r),e._attributes;0===n.length&&e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),r),n.forEach((function(t){var r=Object(b.a)(Pe.getState(),e.getEntityName(),t);if(r){var n=Me(Pe,e._contextToken,e._pageId,t,e,e._xrmForm.ui,r);e._attributes.add(t,n)}}))}return e._attributes}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedEntities",{get:function(){var t=this,r="ClientApi.XrmEntity.relatedEntities";try{if(f.a.instance.reportCall(r),!this._relatedEntities){this._relatedEntities=new I.a(r);var n=Object(S.oc)(Pe.getState(),{id:this._pageId},this._contextToken);for(var a in n)if(n[a]){var i=Object(w.m)(this._contextToken,a),o=new e(Pe,i,this._pageId,this._xrmForm,n[a].etn,n[a].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,o),this._updateControl(o,a)}var s=Object(S.nc)(Pe.getState(),{id:this._pageId}),c={};for(var a in s){var l=s[a];c[l.referencingAttribute]||(c[l.referencingAttribute]={}),c[l.referencingAttribute][l.referencedEntity]=a}var u=function(r){Pe.dispatch(Object(P.a)(d._contextToken,d._pageId,r,(function(n){for(var a in c[r]){var i=t._relatedEntities.get(c[r][a]);i&&t._relatedEntities.remove(i)}var o=n.getEventSource().getValue();if(o&&o.length>0){var s=o[0],l=c[r][s.entityType],u=Object(w.m)(t._contextToken,l),d=new e(Pe,u,t._pageId,t._xrmForm,s.entityType,h.a.tryParse(s.id),t._getAttributeNames,t._applicationContext);t._relatedEntities.add(l,d),t._updateControl(d,l)}}),!0))},d=this;for(var p in c)u(p)}return f.a.instance.reportSuccess(r),this._relatedEntities}catch(e){var g=E.a.getInstance().getEventParameters(this._contextToken);throw g.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(r,e,null,g),e}},enumerable:!1,configurable:!0}),e.prototype._updateControl=function(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach((function(r){r instanceof me.a&&r.updateAttribute(e,t)}))},e.prototype.addOnSave=function(e){var t="ClientApi.XrmEntity.addOnSave";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.o)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getDataXml=function(){var e="ClientApi.XrmEntity.getDataXml";try{f.a.instance.reportCall(e);var t="";return this.attributes.forEach((function(e){e.getIsDirty()&&(t+=e.getDataXmlInternal())})),t="<"+Object(M.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(M.CrmXmlEncode)(this.getEntityName())+">",f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityReference=function(){var e="ClientApi.XrmEntity.getEntityReference";try{f.a.instance.reportCall(e);var t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getEntityName=function(){var e="ClientApi.XrmEntity.getEntityName";try{return f.a.instance.reportCall(e),f.a.instance.reportSuccess(e),this._entityType}catch(r){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.getId=function(){var e="ClientApi.XrmEntity.getId";try{if(f.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING){var t=Object(te.i)(Pe.getState(),this._pageId);if(t&&t.value){var r=t.value;this._entityId=r.id}else{var n=Object(S.ac)(Pe.getState(),this._pageId,this._contextToken);if(n){var a=Object(y.b)(Pe.getState(),n);a&&a.identifier&&(this._entityId=a.identifier.id)}}}return this._entityId&&this._entityId.guid===h.a.EMPTYGUIDSTRING?(f.a.instance.reportSuccess(e),h.a.EMPTYSTRING):(f.a.instance.reportSuccess(e),h.a.externalGuid(this._entityId))}catch(t){var i=E.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getPrimaryAttributeValue=function(){var e=this;return this._clientApiExecutor.execute("getPrimaryAttributeValue",(function(t,r){var n="",a=Object(F.h)(Pe.getState(),e.getEntityName());if(a){if(!a.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",$.a.getInstance().traceManager.getTracer(t).error(n,r),"";var i=Object(S.ac)(Pe.getState(),e._pageId,e._contextToken),o=e.getId()?new m.a(e.getEntityName(),new h.a(e.getId())):new m.a(e.getEntityName()),s=Object(S.X)(Pe.getState(),e._pageId,e._contextToken,i,o,a.PrimaryNameAttribute);if(!s)return"";if(Object(g.j)(s))return s.value;n="PrimaryAttribute value was not an IPlainValue"}else n="Entity descriptor could not be retrieved.";return E.a.getInstance().reportFailure(t,new Error(n),null,r),""}))},e.prototype.getIsDirty=function(){var e="ClientApi.XrmEntity.getIsDirty";try{f.a.instance.reportCall(e);for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if("never"!==r.getSubmitMode()&&r.getIsDirty())return f.a.instance.reportSuccess(e),!0}for(t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return f.a.instance.reportSuccess(e),!0}return f.a.instance.reportSuccess(e),!1}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.removeOnSave=function(e){var t="ClientApi.XrmEntity.removeOnSave";e||Object(T.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.J)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.save=function(e){var t=this;this._clientApiExecutor.executeAsync("save",(function(r,n){var a=1;if(e)if("string"==typeof e)switch(e){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else e.saveMode&&(a=e.saveMode);var i=Pe.getState();return Object(Ne.b)(t._pageId,Pe,a,n,t._contextToken,t,!1,"saveandclose"!==e).then((function(r){return t._performAfterSaveLogic(i,r,e)}))}))},e.prototype.isValid=function(){var e="ClientApi.XrmEntity.isValid";try{if(f.a.instance.reportCall(e),this.attributes)for(var t=0;t<this.attributes.getLength();t++){var r=this.attributes.get(t);if(this._attributeHasActiveControl(r)&&!r.isValid()||r.hasErrorNotification())return f.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return f.a.instance.reportSuccess(e),!1;return f.a.instance.reportSuccess(e),!0}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setRecordId=function(e){var t=this,r="ClientApi.XrmEntity.setRecordId";e||Object(T.j)(r,"id");try{if(f.a.instance.reportCall(r),this.getId()&&this._entityId.guid!==h.a.EMPTYGUIDSTRING)f.a.instance.reportSuccess(r);else{var n=h.a.tryParse(e);h.a.isNullOrEmpty(n)&&Object(T.j)(r,"id");var a=Pe.getState(),i=Object(S.ac)(a,this._pageId,this._contextToken),o=Object(w.x)(this._contextToken);if(i){var s=new m.a(this.getEntityName(),n);Pe.dispatch(Object(ue.b)(i,s)),f.a.instance.reportSuccess(r)}else{var c=Object(de.b)(a,new m.a(this.getEntityName(),n),{},o,he.a.Create),l=c.payload.snapshotId;Pe.dispatch(c),Pe.dispatch(Object(pe.b)(this._pageId,l,this._contextToken)).then((function(){f.a.instance.reportSuccess(r)})).catch((function(e){var n=E.a.getInstance().getEventParameters(t._contextToken);n.push({name:"entityName",value:t.getEntityName()}),E.a.getInstance().reportFailure(r+".setDataSnapshotId",e,null,n)}))}}}catch(e){var u=E.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(r,e,null,u),e}},e.prototype.refresh=function(){var e=this,t="ClientApi.XrmEntity.refresh";try{if(f.a.instance.reportCall(t),this.getId()){for(var r=new m.a(this.getEntityName(),new h.a(this.getId())),n=[],a=[],i=0;i<this.attributes.getLength();i++)a.push(this.attributes.get(i).getName());var o=Object(ge.a)(Pe.getState(),r.etn);if(o&&a.push.apply(a,o),n.push(Pe.dispatch(Object(fe.a)(this._pageId,r,a,new De.a(m.a.toLegacyEntityReference(r),null,null)))),this.relatedEntities)for(i=0;i<this.relatedEntities.getLength();i++)n.push(this.relatedEntities.get(i).refresh());return Promise.all(n).then((function(){Object(be.b)(e),f.a.instance.reportSuccess(t)})).catch((function(r){var n=E.a.getInstance().getEventParameters(e._contextToken);return n.push({name:"entityName",value:e.getEntityName()}),Object(T.d)(Pe,r,t,n)}))}return f.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){var s=E.a.getInstance().getEventParameters(this._contextToken);return s.push({name:"entityName",value:this.getEntityName()}),Object(T.d)(Pe,e,t,s)}},e.prototype._attributeHasActiveControl=function(e){if(e&&e.controls)for(var t=e.controls.getLength(),r=0;r<t;r++)if(!e.controls.get(r).getDisabled())return!0;return!1},e.prototype._performAfterSaveLogic=function(e,t,r){var n=Object(S.kb)(Pe.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||n)if(Object(be.b)(this),"saveandclose"===r){if(!Object(be.a)(Object(ve.b)(Pe.getState())===this._pageId)){var a=Object(S.Kb)(e,this._pageId),i=Object(S.Ib)(e,this._pageId);if(!a&&!i){var o=Object(Ae.a)(Pe.getState(),this._pageId);return Pe.dispatch(Object(le.b)(o))}}}else if("saveandnew"===r){var s={entityTypeName:this.getEntityName()};return Pe.dispatch(Object(ye.a)(_e.a,s,this._pageId))}return Promise.resolve()},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Me(e,t,r,n,a,i,o){var s=null;switch(o.Type){case"datetime":s=new K(e,t,r,n,a,i);break;case"decimal":case"double":case"integer":case"money":s=new ee(e,t,r,n,a,i);break;case"lookup":case"owner":case"customer":s=new J(e,t,r,n,a,i);break;case"partylist":s=new oe(e,t,r,n,a,i);break;case"memo":case"string":s=new ne(e,t,r,n,a,i);break;case"picklist":if(Object(xe.c)(e.getState(),Fe.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)){s=new Ee(e,t,r,n,a,i);break}case"optionset":case"state":case"status":s=new re(e,t,r,n,a,i);break;case"boolean":s=new q(e,t,r,n,a,i);break;case"entityname":s=new ce(e,t,r,n,a,i);break;case"uniqueidentifier":s=new ae(e,t,r,n,a,i);break;case"multiselectpicklist":s=Object(xe.c)(e.getState(),Fe.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,n)?new we(e,t,r,n,a,i):new X(e,t,r,n,a,i);break;case"file":s=new se(e,t,r,n,a,i);break;default:s=new B(e,t,r,n,a,i)}return s}},Baft:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="polite",a="assertive"},BuSU:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}r.d(t,"a",(function(){return n}))},Cgjg:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCustomFilter";function o(e,t,r,o,s){return{type:"grid.setCustomFilter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,l.TraceManager.getTracer(a.z)),p=a.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),u(function(e,t,r,a,o){var s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}var c=Object(n.y)(a),l=Object(n.v)(a);return{type:i,payload:s,meta:{pageId:r,contextKey:c,dataSetContextKey:l}}}(e,t,r,o,s)),l.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){l.EventManager.ReportComponentFailure(p,Error("Adding a custom filter for the grid failed"))}}}}},"Dlr/":function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n,a=r("c/eZ"),i=r("1z64"),o=r("Gemh"),s=r("9r0m"),c=r("YCDx"),l=r("w/nD"),u=r("Sscr"),d=r("/W63"),p=r("IiPO"),h=r("ar+e"),g=r("QUnS"),m=r("Ka9P"),f=r("7bez"),b=r("h82J"),v=r("ezfI"),y=r("kvLG"),_="ClientApi.XrmControlSubGrid.",O=function(e){function t(t,r,a,o,s,c,l,d){var p=e.call(this,t,r,a,l,o,c)||this;return p._relationship=null,n=t,p._subgridToken=Object(u.p)(r,o),p._clientApiExecutorSubGrid=new i.a(t,_,a,p._subgridToken),p.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),p.clientApiExecutor.addEventParameter({name:"isEditable",value:s,isEventParam:!0}),p._gridControl=new f.a(t,p._subgridToken,a,s,3,!0,d,o),t.dispatch(Object(b.a)(p,a,p._subgridToken)),p}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorSubGrid},enumerable:!1,configurable:!0}),t.prototype.setFilterXml=function(e){var t=_+"setFilterXml";try{v.a.instance.reportCall(t),this._gridControl.setFilterXml(e),v.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getFilterXml=function(){var e=_+"getFilterXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFilterXml();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.refresh=function(){var e=_+"refresh";try{v.a.instance.reportCall(e),this._gridControl.refresh(),v.a.instance.reportSuccess(e)}catch(r){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getFetchXml=function(){var e=_+"getFetchXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFetchXml();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getGrid=function(){var e=_+"getGrid";try{v.a.instance.reportCall(e);var t=this._gridControl.getGrid();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getViewSelector=function(){var e=_+"getViewSelector";try{v.a.instance.reportCall(e);var t=this._gridControl.getViewSelector();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getTeamTemplateId=function(){var e=_+"getTeamTemplateId";try{v.a.instance.reportCall(e);var t=this._gridControl.getTeamTemplateId();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnLoad=function(e){var t=this;this.clientApiExecutor.execute("addOnLoad",(function(){n.dispatch(Object(l.d)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.removeOnLoad=function(e){var t=this;this.clientApiExecutor.execute("removeOnLoad",(function(){n.dispatch(Object(l.y)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.getEntityName=function(){var e=_+"getEntityName";try{v.a.instance.reportCall(e);var t=this._gridControl.getEntityName();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){var e=this;return this.clientApiExecutor.execute("getControlType",(function(){var t=Object(g.a)(n.getState(),e.controlDescriptor,e.pageId,e.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"}))},t.prototype.getRelationship=function(){var e=this;return this.clientApiExecutor.execute("getRelationship",(function(t,r){var n,a;if(!e._relationship){if(null===(a=null===(n=e.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===a?void 0:a.RelationshipName){var i=e.controlDescriptor.Parameters.RelationshipName,o=e.controlDescriptor.Parameters.RelationshipRoleOrdinal,s=e.controlDescriptor.Parameters.TargetEntityType;e._relationship=Object(f.b)(i,s),e._relationship.roleType=o}e._relationship||(e._relationship=e._gridControl.getRelationship())}return e._relationship}))},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(n.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return v.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(n.getState(),e.pageId,e.contextToken)}))},t.prototype.openRelatedGrid=function(){var e=this;this.clientApiExecutor.executeAsync("openRelatedGrid",(function(t,r){var a=e.getRelationship();if(!a)return y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",r),Promise.resolve(s.a.EMPTY);for(var i=Object(h.c)(n.getState(),e.pageId),o=null,c=0;c<i.length;c++)if(i[c].relationshipName===a.name){o=i[c];break}if(!o)return r.push({name:"relationshipName",value:a.name}),y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",r),Promise.resolve(s.a.EMPTY);var l={id:o.id,title:o.title,entityName:e.getEntityName(),relationshipName:a.name,isSelected:!0,show:o.show},p=Object(u.a)(e._subgridToken.parentContextToken,a.name,a.roleType?1===a.roleType?m.a.Referencing:m.a.AssociationEntity:void 0);return n.dispatch(Object(d.a)(e.pageId,p,l))}))},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{v.a.instance.reportCall(e),this._gridControl.refreshRibbon(),v.a.instance.reportSuccess(e)}catch(r){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getUrl=function(){var e=_+"getUrl";try{v.a.instance.reportCall(e);var t=this._gridControl.getUrl();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{v.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return v.a.instance.reportSuccess(e),t}catch(t){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,r),t}},t}(c.a)},Ds7n:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("9r0m"),a=r("Sscr"),i=r("uO/V"),o=r("Gemh"),s=r("F2uj"),c=r("VWqI"),l=r("wUng"),u=r("QAhb"),d=r("cZkS"),p=r("qC0c"),h=r("yHpA"),g=r("+Xnp"),m="dataset.row.properties";function f(e,t,r){return{type:"row.properties.async",execute:function(l,h){var f,v,y,_=l.dispatch,O=l.getState,S=h.TraceManager.getTracer(i.z),C=i.x+".RowPropertiesAction",I=Object(p.c)(O(),d.L);try{var j=Object(a.v)(t),P=Object(o.P)(O(),t,{id:e});if(P){var T=null,E=Object(o.Q)(O(),e,t);if(E)T=E;else{var w=Object(o.S)(O(),{id:e},t);w&&w.entityLogicalName&&(T=w.entityLogicalName)}if(T){var F=Object(s.d)(O(),T),x=Object(o.y)(O(),t,e);if(F){for(var A=[],N=0,D=Object.keys(F);N<D.length;N++){var k=F[D[N]],M=Object(c.f)(O(),T,k.LogicalName,g.a.CanUpdate),R=!0;I&&x&&0===x[k.LogicalName]&&(R=!1),A.push(((f={})[k.LogicalName]={requiredLevel:k.RequiredLevel,isDisabled:!(k.IsValidForUpdate&&M&&R),notifications:{}},f))}for(var L=function(e){var t;if(0===P.records.filter((function(t){return Object.keys(t)[0]===n.a.toString(e)})).length)P.records.push(((t={})[n.a.toString(e)]=A,t));else{var r=P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)],a=JSON.parse(JSON.stringify(A));r&&r.forEach((function(e){var t=e[Object.keys(e)[0]];t&&Object.keys(t.notifications).length>0&&(a.find((function(t){return Object.keys(t)[0]===Object.keys(e)[0]}))[Object.keys(e)[0]].notifications=t.notifications)})),P.records.find((function(t){return Object.keys(t)[0]===n.a.toString(e)}))[n.a.toString(e)]=a}},B=0,V=r;B<V.length;B++){L(V[B])}}}if(_(function(e,t,r){return{type:m,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,j,P)),I&&T){F=Object(s.d)(O(),T),x=Object(o.y)(O(),t,e);for(var G=0,U=r;G<U.length;G++){var z=U[G],q=(O(),v=z,y=T,new u.a(y,v)),X=Object(a.f)(t,z,T);if(F)for(var W=0,H=Object.keys(F);W<H.length;W++){k=F[H[W]];x&&1===x[k.LogicalName]&&null===k.ParentPicklistLogicalName&&b(O(),_,e,q,k.LogicalName,X)}}}S.info("creating the rowproperties for {0} rows"+r.length),h.EventManager.ReportComponentSuccess(C)}return Promise.resolve()}catch(e){var Q="creating the rowproperties for {0} rows"+r.length+"failed";h.EventManager.ReportComponentFailure(C,Error(Q))}}}}function b(e,t,r,n,a,i){var s={},c=Object(o.R)(e,r,i),u=Object(h.d)(e,c,n,a);s[a]=u,Object.keys(s).length>0&&t(Object(l.b)(r,i,!1,s))}},F314:function(e,t,r){"use strict";r.d(t,"a",(function(){return G}));var n=r("c/eZ"),a=r("pOv+"),i=r("9r0m"),o=r("G7N+"),s=r("sOTk"),c=r("JlqV"),l=r("gBKR"),u=r("lMVv"),d=r("VWqI"),p=r("dEPU"),h=r("QAhb"),g=r("vYfn"),m=r("PQ2H"),f=r("olrR"),b=r("uO/V"),v=r("r2h9"),y=r("/V8d"),_=r("EcZf"),O=r("bCrZ"),S=r("Gemh"),C=r("jigW"),I=r("8Fmj"),j=r("w82B"),P=r("cZkS"),T=r("qC0c"),E=r("B0z9"),w=r("Ajgc"),F=r("7dGM"),x=r("Z46F"),A=r("S2mk"),N=r("s2by"),D=r("EN0n"),k=r("CIm2"),M=r("7EJx"),R=r("7pqb"),L=r("/j9Z");var B=r("sgPk"),V=r("ak18");function G(e,t,r,G,z,q,X,W,H,Q,Y,K,J){void 0===H&&(H=function(){return 7}),void 0===K&&(K=!0),void 0===J&&(J=!1);var Z=[],$=[],ee=function(e,t,r,D,G,z,q,X,W,H,Q){void 0===H&&(H=!0);void 0===Q&&(Q=!1);var Y=Object(s.l)(e(),D),K={},J=function(e,t,r){var n=[],a=[],o={},s={};return function(c,l,u){var d=[],p=l.controlParameters,h=i.a.tryParseOrNull(l.viewId)?i.a.tryParseOrNull(l.viewId):i.a.tryParseOrNull(p.ViewId),g=i.a.toString(h),m=i.a.tryParseOrNull(p.VisualizationId),b=i.a.toString(m);if("true"===p.EnableChartPicker&&-1===n.indexOf(l.entityLogicalName)){n.push(l.entityLogicalName);var y=c(Object(I.a)(l.entityLogicalName,l.chartType)),_=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve chart dispatched",_),d.push(y)}if(Object(T.c)(e(),P.B)&&"true"===p.EnableViewPicker&&-1===a.indexOf(l.entityLogicalName)){a.push(l.entityLogicalName);var O=c(Object(f.a)(l.entityLogicalName,v.a.MAIN_APPLICATION_VIEW,void 0,void 0,!0));_=[{name:"TargetEntityType",value:l.entityLogicalName}];t.info(r+" page, chart control, retrieve view dispatched",_),d.push(O)}return b&&(o[b]||(o[b]=c(Object(I.a)(l.entityLogicalName,l.chartType,m)).catch((function(e){var n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),a=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"VisualizationId",value:b},{name:"ChartType",value:l.chartType},{name:"ErrorCode",value:Object(A.j)(n)?"":"0x"+x.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",a)}))),u.push(o[b]),d.push(o[b])),g&&(s[g]||(s[g]=c(Object(f.a)(l.entityLogicalName,void 0,l.viewType,h)).catch((function(e){var n=e&&e.getNegativeErrorCode&&e.getNegativeErrorCode(),a=[{name:"TargetEntityType",value:l.entityLogicalName},{name:"ViewId",value:g},{name:"ViewType",value:l.viewType},{name:"ErrorCode",value:Object(A.j)(n)?"":"0x"+x.a.getHexErrorCodeFromInt(n)},{name:"ErrorMessage",value:e.message?e.message:""},{name:"ErrorDetails",value:e.details?e.details:""}];t.info(r+" page, retrieve Chart Control metadata failed.",a)}))),u.push(s[g]),d.push(s[g])),d}}(e,t,Y),Z=function(e,t,r,n,a,o){var s=[],c={},l=Object(y.c)(e,n,a,o);return function(a,o){var u,d,p=o.controlParameters,h=Object(y.e)(o),g=c[h];if(!g){var m=e(),f=o.entityLogicalName,b=Object(M.q)(m);if(m&&f&&b){var v=Object(T.c)(m,P.Zc),_=Object(N.a)(f,b,o.contextToken,v).getFilterAndLinkedEntities(k.a,!0);if(_){if(o.getCustomFilter){var O=o.getCustomFilter();if(O&&O.filter){var C=_.filter,I={conditions:[],filterOperator:0,filters:[O.filter,C]};_.filter=I}O&&O.linkEntities&&(u=_.linkEntities).push.apply(u,O.linkEntities)}o.getCustomFilter=function(){return _}}}g=l(o),c[h]=g}var x=p.ChartDrillDownParameters;if(x&&x.length>0){var A=x[x.length-1];d=new E.a(e,i.a.tryParse(p.VisualizationId),i.a.tryParse(o.viewId),o.chartType,o.viewType,A.groupByAttribute.name,A.groupByAttribute.relatedEntityName,A.chartType);var D=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:p.VisualizationId},{name:"DrilldownAttributeName",value:A.groupByAttribute.name},{name:"DrilldownChartType",value:A.chartType}];t.info(r+" page, retrieve chart drilldown data dispatched",D)}else{d=new w.a(e,i.a.tryParse(p.VisualizationId),i.a.tryParse(o.viewId),o.chartType,o.viewType);D=[{name:"TargetEntityType",value:o.entityLogicalName},{name:"ViewId",value:o.viewId},{name:"VisualizationId",value:p.VisualizationId}];t.info(r+" page, retrieve chart data dispatched",D)}var R=Object(S.qb)(e(),i.a.tryParse(o.viewId),n),L=Object(F.a)(e(),i.a.tryParse(p.VisualizationId));return L&&L.DataDescription&&(g&&g.fetchXml||R&&R.fetchXML)&&(d.initialize(L.DataDescription,g.fetchXml?g.fetchXml:R.fetchXML,L.PresentationDescription,R.title,R.entityLogicalName,L.Name,L.PrimaryEntityTypeCode,!i.a.isNullOrEmpty(L.WebResourceId)),d.setupAggregationQueries()),-1===s.indexOf(d.getStorageKey())?(s.push(d.getStorageKey()),a(Object(j.a)(d,o.entityLogicalName,n,!1))):null}}(e,t,Y,D,G,z),$=function(e,t,r,n){var o=[],s={},c={},l={};return function(u,d,b){var y=[],_=d.entityLogicalName,O=d.controlParameters;if(d.ribbonContext){var S=d.ribbonContext+_;if(-1===o.indexOf(S)){o.push(S);var C=u(Object(p.a)(S));y.push(C);var I=[{name:"TargetEntityType",value:_},{name:"RibbonContext",value:d.ribbonContext}];e.info(t+" page, retrieve ribbon dispatched",I)}}var j=d.cardFormId;if(j&&(!i.a.equals(j,a.a)||"activitypointer"!==_)){var P=i.a.equals(j,a.a)?null:j,T=P?P.guid:d.entityLogicalName;if(!s[T]){var E=u(Object(g.b)(new h.a(_),P,Object(m.a)(11)));s[T]=E,y.push(E);I=[{name:"TargetEntityType",value:_},{name:"FormId",value:j&&j.guid}];e.info(t+" page, retrieve card form dispatched",I)}b.push(s[T])}if(!(1===d.gridType||"true"!==O.EnableViewPicker||l[_]&&l[_].allViews)){l[_]||(l[_]={allViews:!1,viewIds:[]});var w=l[_],F=O.ViewIds,x=F&&F.split(",");if(x&&0!==x.length)for(var A=0,N=x;A<N.length;A++){var D=N[A];if(-1===w.viewIds.indexOf(D)){w.viewIds.push(D);var k=i.a.tryParseOrNull(D);if(k){var M=u(Object(f.a)(_,void 0,void 0,k,void 0,n));y.push(M);I=[{name:"TargetEntityType",value:_},{name:"ViewId",value:D}];e.info(t+" page, retrieve view dispatched",I)}}}else{if(w.allViews=!0,0===d.gridType){var B=u(Object(f.a)(_,v.a.SUB_GRID,void 0,void 0,void 0,n));y.push(B)}var V=u(Object(f.a)(_,v.a.MAIN_APPLICATION_VIEW,void 0,void 0,void 0,n));y.push(V);var I=[{name:"TargetEntityType",value:_}];e.info(t+" page, retrieve all views dispatched",I)}}var G=d.viewId;if(c[G])d.viewId=c[G];else{var U="true"===O.IsUserView?v.b.userview:v.b.savedview,z=d.pinnedEntityLogicalName,q=0===d.gridType?v.a.SUB_GRID:v.a.MAIN_APPLICATION_VIEW,X=z||_;d.quickFindSearchString&&(q=v.a.QUICKFIND_SEARCH,X=d.quickFindEntityIfActivity||X);M=u(function(e,t,r,n){return{type:"view.retrieveornull.async",execute:function(a,i,o){var s=a.dispatch,c=(a.getState,s(Object(f.a)(e,t,r,n)));return new Promise((function(a){c.then((function(e){return a(e)}),(function(o){var s=i.TraceManager.getTracer("view.retrieveornull.async"),c=[{name:R.b.EntityName,value:e},{name:R.b.ViewId,value:n&&n.guid||""},{name:"ViewType",value:r},{name:"SavedQueryType",value:t}];return s.warn("Retrieve view or null : retrieve of view failed : "+Object(L.d)(o),c),a(null)}))}))}}}(X,q,U,i.a.tryParseOrNull(G))).then((function(t){return G&&!t&&r?(e.warn("Pinned view retrieval failed. Loading default view."),u(Object(f.a)(_,v.a.MAIN_APPLICATION_VIEW)).then((function(e){return n(e)}))):n(t);function n(e){var t=e&&e.guid;if(d.viewId=t,c[G]=t,d.onViewRetrieve)return d.onViewRetrieve(e)}}));y.push(M),b.push(M);I=[{name:"TargetEntityType",value:_},{name:"ViewId",value:G}];e.info(t+" page, retrieve view dispatched from retrieveControlMetadataAndData",I)}return y}}(t,Y,H,Q),ee=function(e,t,r,n,a,i){var s={},c=Object(y.b)(e,n,a,i);return function(a,i,l,u,d){var p,h,g=[],m=i.entityLogicalName,f=i.viewId;if(f){var b=Object(y.e)(i),v=s[b];if(!v){var C=c(i);if(!(v=v instanceof B.a?C&&C.getQueryState():C&&C.getQueryState(e)))return g;if(s[b]=v,Object(V.c)(v,null===(p=i.contextToken)||void 0===p?void 0:p.contextTokenType,null===(h=i.control)||void 0===h?void 0:h.Id),u){a(Object(_.d)(v)).catch((function(){var e,t={lists:(e={},e[v.key]={initialized:o.a.Error,lastRetrieved:new Date,pageSize:C.pageSize},e)};a({type:_.b,payload:t})}));var I=[{name:"TargetEntityType",value:m},{name:"ViewId",value:f}];t.info(r+" page, retrieve grid data dispatched",I)}}if(d){var j=i.controlParameters.RelationshipName,P=Object(S.db)(e(),m,j),T=a(Object(O.d)(v,m,n,i.contextToken,i.control,j,P,void 0,l));if(g.push(T),i.onInitializeGrid){var E=T.then(i.onInitializeGrid);g.push(E)}}else if(i.onInitializeGrid){E=i.onInitializeGrid();g.push(E)}var w=[{name:"TargetEntityType",value:m},{name:"ViewId",value:f}];return t.info(r+" page, initialize grid dispatched",w),g}}}(e,t,Y,D,G,z),te=function(e){if(e&&e.FormType){var t=Object(m.a)(e.FormType);return b.x+"."+b.y+"."+t}return""}(G),re=U(q,2),ne=U(q,4);return function(t){return{type:"retrieveControlMetadataAndData.loadControl",execute:function(a){var s=a.dispatch,p=function(e,t){if(e&&t&&t.hasGrid&&t.control&&t.controlParameters){var r=[];return r.push({name:"FormId",value:i.a.toString(e.Id)}),r.push({name:"ViewId",value:t.viewId}),r.push({name:"IsUserView",value:t.controlParameters.IsUserView}),r.push({name:"ControlId",value:t.control.Id}),r}return null}(G,t),h=ne(t)&&Object(c.b)(e()),g=[],m=[],f=t.hasGrid&&t.ribbonContext&&t.contextToken&&Object(C.c)(D,t.contextToken),b=t.entityLogicalName,v=K[b];if(!v){var y=X&&X(b);v=s(Object(l.f)(b,y,[])),K[b]=v}var _=[],O=t.hasChart&&h&&J(s,t,_);m.push.apply(m,_),O&&g.push.apply(g,O);var S=[],I=t.hasGrid&&$(s,t,S);m.push.apply(m,S),I&&(g.push.apply(g,I),0===t.gridType&&Promise.all(S).catch((function(e){r.ReportComponentFailure(te,e,null,p)})));var j=W&&W(t,m);j&&g.push.apply(g,j);var P=Promise.all(Object(n.__spreadArrays)([v],m)).then((function(){var n=Object(u.h)(e(),b);if(!n||n.Initialized!==o.a.Initialized||n.IsEnabledInUnifiedInterface&&Object(d.g)(e(),b,2,0)){var a=Object(c.b)(e())&&h,i=[],l=t.hasChart&&a&&Z(s,t);l&&i.push(l);var g=t.hasGrid&&ee(s,t,f,ne(t),re(t));return g&&(i.push.apply(i,g),0===t.gridType&&Promise.all(g).then((function(){r.ReportComponentSuccess(te,p)}),(function(e){r.ReportComponentFailure(te,e,null,p)}))),Promise.all(i)}}));return g.push(P),Promise.all(g)}}}}(e,r,G,z,q,X,H,Q,Y,K,J),te=U(H,1),re=U(H,0);for(var ne in W){var ae=W[ne];if(te(ae))Z.push(t(ee(ae)));else if(!re(ae)){var ie=Object(D.a)(ee(ae));$.push(t(ie))}}return{inProgress:Z,preload:$}}function U(e,t){return 0===t?function(t){return 0===e(t)}:function(r){return!!(e(r)&t)}}},FGem:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.options.clear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:r}}}},FPMG:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="dataset.update.pagingdata";function o(e,t,r){return{type:"dataset.update.pagingdata.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(a.z)),u=a.x+".updatePagingDataAction";try{return l.info("Updating the paging data for the grid."),c(function(e,t,r){var a=Object(n.y)(t),o=Object(n.v)(t);return{type:i,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:o}}}(e,t,r)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var d="Updation of paging data for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(d))}}}}},FuJ2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("sOTk"),a=r("UOiB"),i=r("Sscr"),o=r("krRo"),s=r("HSdq"),c=r("ObKm"),l=r("yHpA"),u=r("9rlF"),d="attribute.requiredLevel";function p(e,t,r,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute:function(h,g){var m,f=h.getState();if(p!==Object(s.pc)(f,e,t,r)){h.dispatch(function(e,t,r,n){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(o.f)(e,t,r,n);var s=Object(i.x)(t);return{type:d,payload:n,meta:{pageId:e,contextKey:s,dataFieldName:r}}}(e,t,r,p));var b=Object(s.ac)(f,e,t),v=Object(l.b)(f,b);if((0===p||3===p)&&v&&v.activeChanges&&v.activeChanges[r]||t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow){var y=null,_=null,O=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)y=t.entityTypeName?t.entityTypeName:null,_=t.recordId?t.recordId:null,O=Object(i.t)(t),S=Object(i.r)(t);else{var C=Object(n.g)(f,e);y=C&&C.entityTypeName?C.entityTypeName:null,_=C&&C.id?C.id:null,O=null,S=t}var I=Object(l.d)(f,b,{etn:y,id:_},r);if(Object(s.Uc)(I)){var j=((m={})[r]={fieldName:r,value:I?I.formatted?I:Object(u.e)(I):I},m);h.dispatch(Object(c.a)(e,j,!0,!0,y,_?_.guid:null,O,S))}}}}}}},G9wF:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return u}));var n,a=r("c/eZ"),i=r("Zy0S"),o=r("ixd0"),s=r("i8/j"),c=r("9r0m"),l=r("1z64"),u=function(){function e(e,t,r,a,i,c,u){void 0===c&&(c=s.n),void 0===u&&(u=o.a),this._formId=r,n=e,this._entityName=a,this._pageId=i,this._getSelectorItems=c,this._selectorItemType=u,this._clientApiExecutor=new l.a(e,"ClientApi.XrmControlFormSelector.",i,t)}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._clientApiExecutor.execute("items_get",(function(t){if(!e._items){e._items=new i.a(t);var r=e._getSelectorItems(n.getState(),e._entityName);if(r)for(var a in r){var o=r[a],s=o.name||o.DisplayName,l=new e._selectorItemType(new c.a(a),s,n,e._pageId);e._items.add(l.getId(),l)}}return e._items}))},enumerable:!1,configurable:!0}),e.prototype.getCurrentItem=function(){var e=this;return this._clientApiExecutor.execute("getCurrentItem",(function(){for(var t=e.items,r=0;r<t.getLength();r++){var n=t.get(r);if(n.getId()===c.a.toString(e._formId))return n}return null}))},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(u)},Gt1u:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setFormLoadError";function a(e,t){return{type:n,payload:{error:t},meta:{pageId:e}}}},GueY:function(e,t,r){"use strict";r.d(t,"a",(function(){return te}));var n=r("c/eZ"),a=r("1z64"),i=r("HSdq"),o=r("ezfI"),s=r("Zy0S"),c=r("+ieV"),l=r("2p2B"),u=r("0MLN"),d=r("9r0m"),p=r("G9wF"),h=r("ar+e"),g=r("PhZR"),m=r("YOvo"),f=r("+Z9T"),b=r("IiPO"),v=r("/W63"),y=r("s0Zj"),_=r("Sscr");var O,S,C,I,j,P,T=r("7EJx"),E=function(){function e(e,t,r,n){var a="ClientApi.XrmNavigationItem.constructor";e||Object(f.j)(a,"store"),r||Object(f.j)(a,"pageId"),t||Object(f.j)(a,"contextToken"),Object(f.a)(n)&&Object(f.j)(a,"id"),O=e,this._pageId=r,this._id=n,this._contextToken=t}return e.prototype.getId=function(){return o.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id},e.prototype.getLabel=function(){var e="ClientApi.XrmNavigationItem.getLabel";try{o.a.instance.reportCall(e);var t=Object(i.Rb)(O.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmNavigationItem.getVisible";try{o.a.instance.reportCall(e);var t=Object(i.Ub)(O.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setFocus=function(){var e,t,r,n="ClientApi.XrmNavigationItem.setFocus";try{o.a.instance.reportCall(n),O.dispatch((e=this._pageId,t=this._contextToken,r=this._id,{type:"forms.selectnavigationtab",sync:!0,execute:function(n,a,i){var o=n.dispatch,s=n.getState,c=Object(h.d)(s(),e,r);if(c){c.isSelected=!0;var l=Object(_.a)(t,c.relationshipName,c.ordinal);o(Object(y.b)(e,void 0,t)),o(Object(v.a)(e,l,c))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),o.a.instance.reportSuccess(n)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.setLabel=function(e){var t="ClientApi.XrmNavigationItem.setLabel";try{if(o.a.instance.reportCall(t),!Object(f.a)(e)){var r=Object(T.s)(O.getState());O.dispatch(Object(g.b)(this._pageId,this._id,e,r))}o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmNavigationItem.setVisible";try{o.a.instance.reportCall(t),O.dispatch(Object(m.b)(this._pageId,this._id,!0===e)),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e}(),w=function(){function e(e,t,r){r||Object(f.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(f.j)("ClientApi.XrmFormNavigation.constructor","store"),S=e,this._pageId=r,this._contextToken=t}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this,t="ClientApi.XrmFormNavigation.items";try{if(o.a.instance.reportCall(t),!this._items){this._items=new s.a(t);var r=Object(h.f)()(S.getState(),{id:this._pageId});r&&r.forEach((function(t){t&&t.relatedItems&&t.relatedItems.forEach((function(t){t&&t.id&&e._items.add(t.id,new E(S,e._contextToken,e._pageId,t.id))}))}))}return o.a.instance.reportSuccess(t),this._items}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},enumerable:!1,configurable:!0}),e}(),F=r("ll2N"),x=r("oPeH"),A=r("e2rP"),N=r("SdPQ"),D=r("lwSE"),k=r("7ipg"),M=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return C=r,o._clientApiExecutor=new k.b(C,"ClientApi.XrmHeaderSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""},t.prototype.getVisible=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")},t.prototype.setVisible=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")},t.prototype.getControlsDescriptor=function(e){var t=Object(i.tb)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.prototype.setCommandBarVisible=function(e){var t=this;this._clientApiExecutor.execute("setCommandBarVisible",(function(){C.dispatch(Object(A.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getCommandBarVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.commandBarVisible}))},t.prototype.setBodyVisible=function(e){var t=this;this._clientApiExecutor.execute("setBodyVisible",(function(){C.dispatch(Object(N.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getBodyVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.bodyVisible}))},t.prototype.setTabNavigatorVisible=function(e){var t=this;this._clientApiExecutor.execute("setTabNavigatorVisible",(function(){C.dispatch(Object(D.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getTabNavigatorVisible=function(){var e=this;return this._clientApiExecutor.execute("getTabNavigatorVisible",(function(){var t;return null===(t=Object(x.f)(C.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.tabNavigatorVisible}))},t.NAME="Header",t}(F.a),R=r("cQE4"),L=r("uCYK"),B=function(e){function t(r,n,a,i){var o=e.call(this,r,n,a,t.NAME,null,i)||this;return I=r,o._clientApiExecutor=new k.b(I,"ClientApi.XrmFooterSection.",n),o}return Object(n.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""},t.prototype.getVisible=function(){var e=this;return this._clientApiExecutor.execute("getVisible",(function(){var t;return null===(t=Object(R.a)(I.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.visible}))},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")},t.prototype.setVisible=function(e){var t=this;this._clientApiExecutor.execute("setVisible",(function(){I.dispatch(Object(L.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getControlsDescriptor=function(e){var t=Object(i.Z)(e,{id:this.pageId},this.contextToken),r={};if(t)for(var n=0;n<t.length;n++){var a=t[n];r[a.Name]=a}return r},t.NAME="Footer",t}(F.a),V=r("RYq1"),G=r("sOTk"),U=r("gk6Q"),z=r("m8A1"),q=r("03gN"),X=r("kvLG"),W=function(){function e(e,t,r,n){var a="ClientApi.XrmProcessControlUI.constructor";n||Object(f.j)(a,"entity"),t||Object(f.j)(a,"contextToken"),r||Object(f.j)(a,"pageId"),e||Object(f.j)(a,"store"),j=e,this._pageId=r;var i=!1;if(Object(z.d)(j.getState(),this._pageId,a)){var o=Object(G.g)(j.getState(),this._pageId);this._processManager=Object(U.b)(this._pageId,o),i=!0}this._contextToken=t;var s=Object(z.b)(r,e.getState(),i);X.a.getInstance().eventManager.ReportComponentSuccess(a,s)}return e.prototype.getDisplayState=function(){var e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(o.a.instance.reportCall(e),!Object(z.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getDisplayState();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmProcessControlUI.getVisible";try{if(o.a.instance.reportCall(e),!Object(z.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),!1;var t=this._getProcessManager().isVisible();return o.a.instance.reportSuccess(e),t}catch(t){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setDisplayState=function(e){var t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(o.a.instance.reportCall(t),!Object(z.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);e!==q.a.collapsed&&e!==q.a.expanded&&e!==q.a.floating||this._getProcessManager().setDisplayState(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmProcessControlUI.setVisible";try{if(o.a.instance.reportCall(t),!Object(z.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reflow=function(e,t,r){var n="ClientApi.XrmProcessControlUI.reflow";try{if(o.a.instance.reportCall(n),!Object(z.d)(j.getState(),this._pageId,n))return void o.a.instance.reportSuccess(n);this._getProcessManager().reflow(e,t,r),o.a.instance.reportSuccess(n)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(z.c)(this._processManager,j,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager},e}(),H=r("w/nD"),Q=r("UGbr"),Y=r("yHpA"),K=r("cAHA"),J=r("9qYn"),Z=r("yZTI"),$=r("0hCf"),ee=r("zPLw"),te=function(e){function t(t,r,n,i,o,s){var c=this;return P=t,(c=e.call(this,t,r,n,i,o,s,p.a)||this)._clientApiExecutorFormUI=new a.a(t,"ClientApi.XrmFormUI.",n,r),c._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:o,isEventParam:!0}),c}return Object(n.__extends)(t,e),Object.defineProperty(t.prototype,"headerSection",{get:function(){var e="ClientApi.XrmFormUI.headerSection";try{return o.a.instance.reportCall(e),this._headerSection||(this._headerSection=new M(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerSection",{get:function(){var e="ClientApi.XrmFormUI.footerSection";try{return o.a.instance.reportCall(e),this._footerSection||(this._footerSection=new B(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.addControls=function(e){var t=b.a.getInstance().getEventParameters(this.contextToken),r={name:"controlName",value:""};for(var n in t.push(r),e)if(e[n]){r.value=n;var a=this.xrmControlFactory.createXrmControl(this.contextToken,e[n],this.formContext,"ClientApi.XrmFormUI.addControls",t);a&&this.controls.add(a.getName(),a)}},Object.defineProperty(t.prototype,"navigation",{get:function(){var e="ClientApi.XrmFormUI.navigation";try{return o.a.instance.reportCall(e),this._navigation||(this._navigation=new w(P,this.contextToken,this.pageId)),o.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"process",{get:function(){var e="ClientApi.XrmFormUI.process_get";try{o.a.instance.reportCall(e);var t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new W(P,this.contextToken,this.pageId,this.formContext.data.entity));var r=Object(z.a)(this.pageId,P.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return X.a.getInstance().eventManager.ReportComponentSuccess(e,r),o.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}},set:function(e){var t=Object(z.a)(this.pageId,P.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));X.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickForms",{get:function(){var e="ClientApi.XrmFormUI.quickForms";try{return o.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),o.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.clearFormNotification=function(e){var t="ClientApi.XrmFormUI.clearFormNotification";try{o.a.instance.reportCall(t);var r=P.dispatch(Object(l.b)(this.contextToken,this.pageId,e));return o.a.instance.reportSuccess(t),r}catch(e){throw this._reportFailure(t,e)}},t.prototype.close=function(){try{o.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(J.a)(Object(Z.b)(P.getState())===this.pageId)||P.dispatch(Object(V.e)(this.pageId)),o.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}},t.prototype.getFormType=function(){var e=this;return this._clientApiExecutorFormUI.execute("getFormType",(function(t,r){var n=e.getFormDescriptor(t,r);if(n){var a=e.formContext;if(a&&a.data&&a.data.entity&&Object(i.Lb)(P.getState(),a.data.entity.getEntityName(),d.a.tryParse(a.data.entity.getId())))return 4;if(Object(i.kb)(P.getState(),{id:e.pageId},e.contextToken))return 3;if(6===n.FormType)return 3;var o=Object(i.ac)(P.getState(),e.pageId,e.contextToken);if(o){var s=Object(Y.b)(P.getState(),o);return s?s.mode===K.a.Create?1:2:(r.push({name:"snapshotID",value:o}),e._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),r),0)}return a&&a.data&&a.data.entity&&!d.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0}))},t.prototype.isDialog=function(){var e=this;return this._clientApiExecutorFormUI.execute("isDialog",(function(){return Object(G.f)(P.getState(),e.pageId)}))},t.prototype.getViewPortHeight=function(){var e="ClientApi.XrmFormUI.getViewPortHeight";try{o.a.instance.reportCall(e);var t=Object(i.qb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.getViewPortWidth=function(){var e="ClientApi.XrmFormUI.getViewPortWidth";try{o.a.instance.reportCall(e);var t=Object(i.rb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.setFormEntityName=function(e){var t="ClientApi.XrmFormUI.setFormEntityName";Object(f.g)(e,t,"name");try{o.a.instance.reportCall(t),P.dispatch(Object(u.b)(this.pageId,this.contextToken,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.setFormNotification=function(e,t,r,n,a){var i=this;return this._clientApiExecutorFormUI.execute("setFormNotification",(function(o,s){var l;switch(Object(f.a)(r)&&(r="Random_String_"+Math.random()),t){case"ERROR":l=ee.a;break;case"WARNING":l=ee.e;break;case"INFORMATION":case"INFO":l=ee.b;break;default:Object(f.h)(o,"notificationLevel",t,s)}return!Object(f.a)(e)&&"string"==typeof e&&(P.dispatch(Object(c.c)(i.contextToken,i.pageId,e,l,r,n,a)),!0)}))},t.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormUI.addOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormUI.removeOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.refresh=function(){var e=this,t="ClientApi.XrmFormUI.refresh";try{o.a.instance.reportCall(t);var r=Object(G.l)(P.getState(),this.pageId);return P.dispatch(Object(Q.f)(this.pageId,r,!0,1,!0,!0)).then((function(r){return Object(J.b)(e.formContext.data.entity),o.a.instance.reportSuccess(t),r})).catch((function(r){var n=b.a.getInstance().getEventParameters(e.contextToken);return Object(f.d)(P,r,t+".saveFormAndNavigate",n)}))}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);return Object(f.d)(P,e,t,n)}},t.prototype._reportFailure=function(e,t){var r=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,r),t},t}($.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},HfRC:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("xc1f"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,l,u){var d={entityTypeName:e.etn,id:e.id,formId:r,data:i,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(a.a)(n.a,d,t)}},I6xF:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var n="powerbi.signedin.state";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Ini7:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.removeOption";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},JFej:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.option.add";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.x)(t);return{type:a,payload:{option:i,index:o},meta:{pageId:e,contextKey:s,dataFieldName:r}}}},JVfT:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="update.grid.paging.refresh.input";function o(e,t){return{type:"update.grid.paging.refresh.input.async",execute:function(r,o){var s=r.dispatch,c=(r.getState,o.TraceManager.getTracer(a.z)),l=a.x+".updateGridPagingRefreshInputAction";try{var u=Object(n.u)(t);return s(function(e,t){return{type:i,payload:Math.floor(1e3*Math.random()),meta:{pageId:e,dataSetContextKey:t}}}(e,u)),c.info("Updating the grid pagingRefreshInput"),o.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var d="Updating the grid pagingRefreshInput failed with error : "+e.message;o.EventManager.ReportComponentFailure(l,Error(d))}}}}},Jcuz:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r={displayState:e};return{type:n.c,payload:r}}},Je7O:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(){}return e.prototype.get_ErrorType=function(){return this._errorType},e.prototype.set_ErrorType=function(e){this._errorType=e},e.prototype.get_ErrorDescription=function(){return this._errorDescription},e.prototype.set_ErrorDescription=function(e){this._errorDescription=e},e}()},KDdL:function(e,t,r){"use strict";r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"b",(function(){return g})),r.d(t,"e",(function(){return b})),r.d(t,"a",(function(){return v}));var n=r("9r0m"),a=r("G7N+"),i=r("dUXI"),o=r("8ADW"),s=r("y5DA"),c=r("lMVv"),l=r("Ww2r"),u=r("JlqV"),d=r("9rlF"),p=r("F2uj"),h=o.a;function g(e,t,r,a,d,p,g,m){return void 0===m&&(m=!1),function(e,t,r){if(!n.a.toString(r.viewId)){var a="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(h+".retrieveChartData",Error(a),o.d,t),new Error(a)}return!0}(r,a,d)&&function(e,t,r,a,o){if(!n.a.toString(r.visualizationId)||n.a.toString(r.visualizationId)===n.a.EMPTYGUIDSTRING){var u=e(),d=Object(l.b)(u,i.n),p=Object(c.f)(u,a)||a,h=String.format(d,p);return Object(s.a)(u,t,h,r,o),!1}return!0}(e,t,d,p,g)&&function(e,t,r,n){var a=e();if(!Object(u.b)(a)){var o=Object(l.b)(a,i.r);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(r.isRollUpView){var a=e(),o=Object(l.b)(a,i.j);return Object(s.a)(a,t,o,r,n),!1}return!0}(e,t,d,g)&&(!m||function(e,t,r,n){if(!r.viewXml){var a=Object(l.b)(e(),i.g);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,d,g)&&function(e,t,r,n){if(!r.fetchXml){var a=Object(l.b)(e(),i.o);return Object(s.a)(e(),t,a,r,n),!1}return!0}(e,t,d,g))}function m(e,t,r){var i,o,s=new n.a(e),c=n.a.toString(s),l=new n.a(t),u=n.a.toString(l);return{type:r,payload:{charts:(i={},i[c]=(o={},o[u]={initialized:a.a.Initializing},o),i)}}}function f(e,t){var r;return{type:t,payload:{chartData:(r={},r[e]={initialized:a.a.Initializing},r)}}}function b(e,t,r){var n,a=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(function(e,t){var r;if(!e)return!1;var n=null===(r=null==e?void 0:e.entity)||void 0===r?void 0:r.entityName,a=null==e?void 0:e.attributeName,i=Object(p.b)(a,n,t);return"picklist"===i||"state"===i||"status"===i}(i,r)&&e.isOrderPresentOnPrimaryGroupBy()){var o=i.aliasName,s=new y(o);t.sort(s.comparator),a.descending&&t.reverse()}}function v(e){var t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,r=e.match(new RegExp(t,"g")),n=[];return r&&r.forEach((function(e){n=e.match(new RegExp(t,"m"))})),n}var y=function(){function e(e){var t=this;this._primaryGroupByAttributeAlias=null,this.comparator=function(e,r){return t._getRawValue(e)-t._getRawValue(r)},this._primaryGroupByAttributeAlias=e}return e.prototype._getRawValue=function(e){if(this._primaryGroupByAttributeAlias in e.fields){var t=e.fields[this._primaryGroupByAttributeAlias],r=Object(d.e)(t);return parseInt(r,10)}return-1},e}()},KbPJ:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.entityreferencebyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Kdvm:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("9r0m"),a=function(){function e(){}return e.prototype.generate=function(e,t){return t&&t.getProcessId()?{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:n.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:n.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}:null},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},LBS5:function(e,t,r){"use strict";r.d(t,"b",(function(){return D})),r.d(t,"a",(function(){return N})),r.d(t,"c",(function(){return M})),r.d(t,"e",(function(){return R})),r.d(t,"d",(function(){return L}));var n,a,i=r("TJkj"),o=r("UOiB"),s=r("kvLG"),c=r("mPpC"),l=r("Y+r4"),u=r("c/eZ"),d=r("ZOZo"),p=r("0hCf"),h=r("G9wF"),g=r("T4u8"),m=r("9r0m"),f=r("ixd0"),b=r("JX21"),v=r("1z64"),y=r("5KPK"),_=function(e){function t(t,r,a,i){var o=e.call(this,t,r,a,i)||this;return o._dashboardId=t,n=a,o._clientApiExecutor=new v.a(a,"ClientApi.XrmDashboardSelectorItem.",i),o}return Object(u.__extends)(t,e),t.prototype._getEventParams=function(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:m.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])},Object.defineProperty(t.prototype,"isBoundDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isBoundDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return!t||1032==+t.Type}),this._getEventParams())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isUserDashboard_get",(function(){var t=Object(b.a)(n.getState(),e._dashboardId);return Object(b.c)(t)}),this._getEventParams())},enumerable:!1,configurable:!0}),t.prototype.navigate=function(){var e=this;this._clientApiExecutor.executeAsync("navigate",(function(){return n.dispatch(Object(y.a)(null,e._dashboardId,null,null,null,null,e.getPageId()))}),this._getEventParams())},t}(f.a),O=function(e){function t(t,r,n,a,i){var o=g.c;if(a){var s=t.getState(),c=Object(g.g)(s,a);c&&c[n.guid]&&(o=g.g)}return e.call(this,t,r,n,a,i,o,_)||this}return Object(u.__extends)(t,e),t}(h.b),S=function(e){function t(t,r,n,a,i,o){return e.call(this,t,r,n,a,i,o,O)||this}return Object(u.__extends)(t,e),t}(p.a),C=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r&&r.etn,i,o,(function(){return S}),n)||this;return a=t,c._getCommands=s,c._apiExecutor=new v.a(t,"ClientApi.XrmDashboard.",o,i),c}return Object(u.__extends)(t,e),Object.defineProperty(t.prototype,"commands",{get:function(){var e=this;return this._apiExecutor.execute("commands_get",(function(){return e._commands||(e._commands=e._getCommands(a,e.contextToken,e.pageId))}))},enumerable:!1,configurable:!0}),t}(d.a),I=r("7bez"),j=r("Dlr/"),P=r("1PXy"),T=r("h82J"),E=r("HSdq"),w=r("IiPO"),F=r("ks02"),x=r("+Z9T"),A=r("W1TM");function N(e,t,r,n){return k((function(r,a){return new C(r,a,new c.b(r,t),e,t,n)}),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,r,!1)}function D(e,t,r,n){return k((function(r,n){return new l.a(r,n,new c.b(r,t),e,t)}),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,r,!0,n)}function k(e,t,r,n,a,o,c,l){return{type:t,sync:!0,execute:function(t,u){Object(x.g)(n,r,"contextToken"),Object(x.g)(a,r,"pageId"),c&&Object(x.g)(o,r,"entityTypeName");try{var d=t.dispatch(Object(T.b)(a,n));if(!d){(d=e(t,{etn:o,id:l})).applicationContext=u;var p=new F.a(t,a);if(d.context=p,!n.parentContextToken){var h=u.ClientApiManager.getClientApiEntry(a);Object(i.b)("form.initialization",(function(){h.xrmInstance.Page=d})),h.primaryContextToken=n}}return d}catch(e){var g=w.a.getInstance().getEventParameters(n);throw g.push({name:"entityTypeName",value:o}),s.a.getInstance().eventManager.ReportComponentFailure(r,e,null,g),e}}}}function M(e,t,r,n,a){var i="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute:function(c,l){Object(x.g)(e,i,"contextToken"),Object(x.g)(t,i,"pageId");try{var u=c.dispatch(Object(T.c)(t,e));if(!u){if(3===n){var d=Object(E.s)(c.getState(),{id:t,controlName:a},e.parentContextToken);if(d){var p=c.dispatch(Object(T.b)(t,e.parentContextToken));return new j.a(c,e.parentContextToken,t,a,r,p,d,l)}(h=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Control descriptor could not be found for subgrid control"),null,h)}if(u=new I.a(c,e,t,r,n,!1,l,a),!e.parentContextToken&&e.contextTokenType===o.a.MainGrid)l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}return u}catch(t){var h;throw(h=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),h.push({name:"gridType",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(i,t,null,h),t}}}}function R(e,t,r,n){var a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute:function(i,o){Object(x.g)(e,a,"contextToken"),Object(x.g)(t,a,"pageId"),Object(x.g)(r,a,"controlName"),Object(x.g)(n,a,"controlId");try{var c=i.dispatch(Object(T.b)(t,e.parentContextToken)),l=null;switch(r){case"notescontrol":if(!(l=i.dispatch(Object(T.f)(t,e)))){var u=Object(E.s)(i.getState(),{id:t,controlName:r},e.parentContextToken);l=new P.a(i,e.parentContextToken,t,u,r,n,c,o)}break;default:(d=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,d)}return l}catch(t){var d;throw(d=w.a.getInstance().getEventParameters(e)).push({name:"controlName",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(a,t,null,d),t}}}}function L(e,t){var r="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute:function(n,a){Object(x.g)(e,r,"contextToken"),Object(x.g)(t,r,"pageId");try{var i=n.dispatch(Object(T.g)(t,e));if(!i&&(i=new A.a(n,e,t),!e.parentContextToken)){var o=a.ClientApiManager.getClientApiEntry(t);o.xrmInstance.Page=i,o.primaryContextToken=e}return i}catch(t){var c=w.a.getInstance().getEventParameters(e);throw s.a.getInstance().eventManager.ReportComponentFailure(r,t,null,c),t}}}}},LFYt:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));var n=r("mVnn"),a="quickCreateForm.output";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){return{type:"quickCreateForm.output.async",execute:function(r){var i=r.dispatch,o=r.getState,s=Object(n.a)(o(),e)||[];return s.push(t),i(function(e,t){return{type:a,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},LdMy:function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("90Ov"),a=r("WS0f"),i=function(){function e(){}return Object.defineProperty(e.prototype,"invocationSource",{get:function(){return this._invocationSource},set:function(e){this._invocationSource=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workflowStep",{get:function(){return this._workflowStep},set:function(e){this._workflowStep=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},set:function(e){this._businessProcessFlowVisitor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEntityName",{get:function(){return this._currentEntityName},set:function(e){this._currentEntityName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processManager",{get:function(){return this._processManager},set:function(e){this._processManager=e},enumerable:!1,configurable:!0}),e.prototype.getStageStep=function(e){if(Object(a.b)(e)||!this._businessProcessFlowVisitor)return null;var t=this._businessProcessFlowVisitor.get_stagesById()[Object(n.a)(e)];return t||null},e}(),o=r("c/eZ"),s=function(e){function t(t){return e.call(this,Object(n.a)(t))||this}return Object(o.__extends)(t,e),t}(function(){function e(e){this.value=e,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.getNext=function(){return this._next},e.prototype.setNext=function(e){this._next=e},e}()),c=function(){function e(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}return e.prototype.find=function(e,t){if(e=Object(n.a)(e),t){for(var r in this._rootNodesValue)if(e===this._rootNodesValue[r])return this._rootNodes[r];return null}for(var r in this._rootNodes){var a=this._rootNodes[r];if(a.value===e)return a;for(;null!=a.getNext();)if((a=a.getNext()).value===e)return a}return null},e.prototype.getNode=function(e){return this._rootNodes[e]},e.prototype.setNode=function(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value},e.prototype.getDefaultPath=function(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray},e.prototype.addAfter=function(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)},e.prototype.getDefaultPathHash=function(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash},e.prototype._ensureLatestDefaultPathIsCalculated=function(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())},e.prototype._recaculateDefaultPath=function(){this._defaultPathArray=[];for(var e=0;e<this._rootNodes.length;e++){var t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){var r=t.getNext();r.value&&(this._defaultPathArray[this._defaultPathArray.length]=r.value),t=r}}return this._defaultPathArray},e.prototype._addAfterInternal=function(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1},e.prototype._generateDefaultPathCalculatedTimeHash=function(){var e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e},e}(),l=function(){function e(){}return e.prototype.pathChanged=function(e){this._handler&&!Object(a.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)},e.prototype.getHandler=function(){return this._handler},e.prototype.setHandler=function(e){this._handler=e},e}(),u=function(){function e(e,t){this._nextStage=t,this._parentStage=e}return Object.defineProperty(e.prototype,"parentStage",{get:function(){return this._parentStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextStage",{get:function(){return this._nextStage},enumerable:!1,configurable:!0}),e}(),d=function(){function e(e,t,r){this._context=e,this._defaultPath=t,this._staticPath=r}return e.prototype.calculate=function(){for(var e=this._startingNodeInDefaultPath(),t=0;t<this._staticPath.length;t++){var r=this._staticPath[t];if(this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(r)){var n=this._defaultPath.find(r,!0);n?e=n:(this._defaultPath.addAfter(e,new s(r)),e=e.getNext())}}this._lastEvaluatedNode=e},e.prototype.getLastEvaluatedNodeInDefaultPath=function(){return this._lastEvaluatedNode},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._startingNodeInDefaultPath=function(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode},e}(),p=function(){function e(e,t){this._defaultPath=t,this._context=e}return e.prototype.calculate=function(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()},e.prototype.getLastDefaultNode=function(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_staticPathToDefaultPathCalculator",{get:function(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new d(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e,t){this._context=e,this._defaultPath=t}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getLastCalculatedDefaultNode=function(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraveresedStages=function(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_traversedDefaultPathCalculator",{get:function(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new p(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),g=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._stageStep},set:function(e){this._stageStep=e},enumerable:!1,configurable:!0}),e.prototype.tryExecute=function(){var e=Object(n.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)},e}(),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)},t.prototype._sanitizeGuidForFunctionName=function(e){if(Object(a.b)(e))return e;for(e=Object(n.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e},t}(g),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e=Object(n.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(t){var r=t.findElseBranch(),a=null;if(r&&r.get_Steps().get_Count()>0)a=r.get_Steps().get_item(0).get_stageId();this._invokeReflowFunction(e,a)}},t.prototype._invokeReflowFunction=function(e,t){this.context.processManager.reflow(!1,e,t)},t}(g),b=function(){function e(){}return e.prototype.getStageCommand=function(e,t){var r=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(n.a)(t.get_stageId())];return e.currentEntityName!==r.get_EntityLogicalName()?new f(e):new m(e)},e}(),v=function(){function e(e,t,r){this._defaultPath=t,this._cascadeUpdate=r,this._context=e,this._businessRuleCommandFactory=new b}return e.prototype.handleChange=function(e,t){var r=this._defaultPath.find(e,!1);if(null!=r){var n=Object(a.b)(t)?null:t,i=new s(n);this._defaultPath.addAfter(r,i),n&&this.triggerSubsequentDefaultPathCalculation(i)}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(e){var t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){var r=this._context.getStageStep(t).get_nextStageId();if(!r)return;var n=this._defaultPath.find(r,!0);if(n)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(n));this._defaultPath.addAfter(e,new s(r)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}},e.prototype._tryExecuteConditionForStage=function(e){var t=this._context.invocationSource;try{this._context.invocationSource="internal";var r=this._context.getStageStep(e.value),n=this._businessRuleCommandFactory.getStageCommand(this._context,r);if(n.stage=r,!n.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1},e}(),y=function(){function e(e,t,r){this._context=e,this._listener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startNode},set:function(e){this._startNode=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!0)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t,r){this._context=e,this._listener=t,this._initialDefaultPath=r}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startingNodeInDefaultPath},set:function(e){this._startingNodeInDefaultPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraversedStages=function(){this._defaultPath=this._initialDefaultPath},e.prototype._calculateForNonTraversedStages=function(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_nonTraversedDefaultPathCalculator",{get:function(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),O=function(){function e(e,t,r){this._context=e,this._changeListener=t,this._defaultPath=r}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._changeListener.setHandler(e)},e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!1)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),S=r("9r0m"),C=function(){function e(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new l,this._initializeDefaultPathFromRootStages()}return e.prototype.initializeComplete=function(){var e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();var t=this._context.processManager.getSelectedStageId(),r=this._context.processManager.getActivePath(),n=!Object(a.a)(t)&&!Object(a.a)(r),i=n&&r.findIndex((function(e){return e.guid.toString()===t}))<0,o=n&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())},e.prototype.updateDefaultPath=function(e,t){if(e){var r=null;if("internal"!==this._context.invocationSource&&(r=this.defaultPathHash()),this._changeListener.pathChanged(new u(e,t)),"internal"!==this._context.invocationSource)if(r!==this.defaultPathHash()){var n=this.getDefaultPath();this._context.processManager.setActivePath(n)}}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(!!S.a.tryParseOrNull(e)&&!!this.getDefaultPath().find((function(t){return t.toLowerCase()===e.toLowerCase()}))){var t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource)if(t!==this.defaultPathHash()){var r=this.getDefaultPath();this._context.processManager.setActivePath(r)}}},e.prototype.getDefaultPath=function(){return this._defaultPath.getDefaultPath()},e.prototype.defaultPathHash=function(){return this._defaultPath.getDefaultPathHash()},e.prototype.getNextStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return-1!==r&&r<t.length-1?t[r+1]:null},e.prototype.getPreviousStage=function(e){var t=this.getDefaultPath(),r=t.indexOf(Object(n.a)(e));return r<=0?null:t[r-1]},e.prototype._initializeDefaultPathFromRootStages=function(){this._defaultPath=new c;var e=this._context.businessProcessFlowVisitor.get_firstLevelStages(),t=0;for(var r in e)this._defaultPath.setNode(t,new s(r)),t++},e.prototype._initializeTraversedPath=function(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()},e.prototype._initializeNonTraversedPath=function(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()},Object.defineProperty(e.prototype,"_loadTimeDefaultPathCalculator",{get:function(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_afterLoadPathCalculator",{get:function(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_runTimePathCalculator",{get:function(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new O(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator},enumerable:!1,configurable:!0}),e}(),I=r("HSdq"),j=function(){function e(){}return e.prototype.setPrimaryModel=function(e){this._primaryModelName=e},e.prototype.getDefaultPathManager=function(){return this._defaultPathManager},e.prototype.setObjectModel=function(e){var t=this,r=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach((function(e){if(t._isRelationshipStep(e)){var a=t._createRelationshipCollectionStep(r,e);a&&r.appendStep(a)}else{var i=t._createEntity(r,e);i&&(r.appendStep(i),n.hasOwnProperty(i.get_EntityLogicalName())||(n[i.get_EntityLogicalName()]=!0))}})),r.set_Name(e.businessProcessFlowName),r.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=r,this._initializeVisitor()},e.prototype.initializeDefaultPathManager=function(e,t){var r=new i;r.processManager=t,r.businessProcessFlowVisitor=this._businessProcessFlowVisitor,r.workflowStep=this._processObjectModel,r.currentEntityName=this._primaryModelName,this._defaultPathManager=new C(e,r),this._defaultPathManager.initializeComplete()},Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},enumerable:!1,configurable:!0}),e.prototype.getEntityStages=function(){if(!this._processObjectModel)return null;var e=this._processObjectModel.get_Steps(),t=[];if(e){for(var r=0;r<e.get_Count();r++){var n=e.get_item(r);n&&n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(r))}return t}return null},e.prototype.getRequiredFlowStepsForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);this._isFlowStep(c)&&c.get_isProcessRequired()&&a.push(c.get_Id())}return a},e.prototype.getRequiredAttributesForStage=function(e,t,r,n){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);if(!this._isActionStep(c)&&!this._isFlowStep(c))if(c.get_isProcessRequired())a.push(c.get_Description());else{var l=this._getDataFieldNameFromStepStep(c);l&&this._isRequiredAttribute(l,t,r,n)&&a.push(c.get_Description())}}return a},e.prototype._getDataFieldNameFromStepStep=function(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){var t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null},e.prototype._isRequiredAttribute=function(e,t,r,n){return null!=e&&2===Object(I.pc)(n,t,r,e)},e.prototype._isFlowStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0;return!1},e.prototype._isActionStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0;return!1},e.prototype._isControlStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0;return!1},e.prototype._initializeVisitor=function(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)},e.prototype._isRelationshipStep=function(e){return!(!e||!e.hasOwnProperty("relationships"))},e.prototype._createEntity=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);r.set_Name(t.entityLogicalName),r.set_Description(t.entityDisplayName),r.set_relationshipName(t.relationshipName),r.set_attributeName(t.referencingAttributeName),r.set_parent(e);var n=this._createStage(e,t.stage);r&&n&&r.appendStep(n);for(var a=0;a<t.stage.steps.length;a++){var i=this._createStep(e,t.stage.steps[a]);i&&n.appendStep(i)}var o=this._createConditionStep(e,n,t.stage);return o&&n.appendStep(o),r},e.prototype._createRelationshipCollectionStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(r.set_workflow(e),t.relationships)for(var n=0;n<t.relationships.length;n++){var a=this._createRelationshipStep(e,t.relationships[n]);r.appendStep(a)}return r},e.prototype._createRelationshipStep=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return r.set_workflow(e),r.set_sourceStageId(t.sourceStageId.guid),r.set_targetStageId(t.targetStageId.guid),r.set_attributeName(t.attributeName),r.set_relationshipName(t.relationshipName),r},e.prototype._createStage=function(e,t){var r=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return r.set_Id(t.stageId.guid),r.set_stageId(t.stageId.guid),r.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),r.set_stageCategory(t.stageCategory),r},e.prototype._createStep=function(e,t){var r="action"===t.stepType.toLowerCase()?t.label:t.name,n=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,r||"dummy");n.set_isProcessRequired(t.required),n.set_Name(t.label),n.set_Id(t.stepId?t.stepId.guid:""),n.set_workflow(e);var a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(a.set_dataFieldName(r),"action"===t.stepType.toLowerCase()){var i=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);i.set_Name(r),i.set_actionControl(a),n.appendStep(i)}else if("modernflow"===t.stepType.toLowerCase()){var o=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);o.set_Name(r),o.set_flowControl(a),n.appendStep(o)}else n.appendStep(a);return n},e.prototype._createConditionStep=function(e,t,r){if(!r.conditionJson)return null;var n=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return n.set_parent(t),n.initializeFromDynamic(JSON.parse(r.conditionJson)),n.fixLinks(),n},e.prototype.getProcessObjectModel=function(){return this._processObjectModel},e.prototype.getStage=function(e){return Object(a.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null},e.prototype.getPreviousStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e.prototype.getNextStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e}()},LhJP:function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"i",(function(){return a})),r.d(t,"o",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"j",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return g})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"q",(function(){return v})),r.d(t,"p",(function(){return y})),r.d(t,"m",(function(){return d})),r.d(t,"n",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",p="BusinessProcessFlow.SetActiveProcessInstance",h="BusinessProcessFlow.ActionStep",g="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",f="BusinessProcessFlow.RenderProcessControl",b="BusinessProcessFlow.HideProcessControlForUciOffline",v="SaveFailureReason",y="faultedSnapshotId"},LiB6:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("c/eZ"),a=r("UlLp"),i=r("8VL5"),o={};function s(e,t){var r;return void 0===e&&(e=o),t.type===i.a?Object(n.__assign)(Object(n.__assign)({},e),((r={})[Object(a.a)(t.meta.customControlId,t.meta.dataSetParameterName)]=t.payload,r)):e}},NJzV:function(e,t,r){"use strict";r.d(t,"b",(function(){return ur})),r.d(t,"a",(function(){return dr})),r.d(t,"d",(function(){return hr})),r.d(t,"c",(function(){return lr}));var n=r("c/eZ"),a=r("4E+q"),i=r("kyRo"),o=r("nuS9"),s=r("93Ls"),c=r("kGA3"),l=r("VnpK"),u=r("S2mk"),d=r("DRVD"),p=r.n(d),h=r("CCTC"),g=r("9r0m"),m=r("WS0f"),f=r("sOTk"),b=r("Nw1z"),v=r("HSdq"),y=r("riBC"),_=r("2OIc"),O=r("T2Xs"),S=r("Sscr"),C=r("UOiB"),I=r("QAhb"),j=r("yHpA"),P=r("JX21"),T=r("T4u8"),E=r("cZkS"),w=r("qC0c"),F="CustomControlFramework.Selectors.CustomControlHostContextTokenSelectors";function x(){var e=null,t=null,r=null;return function(n,a){O.a.info(a.controlId+"."+F+": createGetContextTokenSelector started");var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r,n=t.parentContextToken,a=t.contextString,i=t.configuration,o=Object(_.e)(e,t.configuration.CustomControlId);if(Object(w.c)(e,E.J)&&Object(l.s)(o)&&function e(t,r){if(!r)return!1;if(r.contextTokenType===C.a.UnboundForm&&r.formId)return!(!Object(P.a)(t,r.formId)&&!Object(T.a)(t,r.formId));return e(t,r.parentContextToken)}(e,n))return r=S.p(n.parentContextToken,t.controlId);if("default"===a&&Object(l.s)(o)&&!Object(l.r)(t.configuration.Parameters)||Object(l.r)(t.configuration.Parameters)&&function(e){if(e.indexOf("ClientContextGridControl")>-1||e.indexOf("activeProcessGridControlContainer")>-1||e.indexOf("ManageDuplicatesGrid")>-1||e.indexOf("archivedProcessGridControlContainer")>-1)return!0;return!1}(t.controlId))return r=S.e(n,t.controlId);if(!t.formInfo&&i&&i.Parameters&&i.Parameters.value&&"TimelineWall"===i.Parameters.value.Type)return r=S.p(n,t.controlId);if(!t.formInfo&&Object(l.t)(t.configuration)){var s=function(e,t){var r=Object(f.g)(e,t.id),n=new I.a(r.entityTypeName,r.id||g.a.EMPTY),a=Object(v.ac)(e,t.id,t.parentContextToken),i=Object(j.d)(e,a,n,t.descriptor.DataFieldName),o=i?i.reference:null;return o?o.etn:Object(l.m)(t.descriptor)}(e,t);return r=S.l(n,t.controlId,s)}r=n;var c=t.descriptor&&t.descriptor.Relationship;c&&(r=S.m(r,c));return r}(n,a);return(r!==o||A(e,s)||A(t,i))&&(e=s,t=i,r=o),O.a.info(a.controlId+"."+F+": createGetContextTokenSelector finished"),e}}function A(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName:e!==t}var N=r("ZEX9"),D=r("Gemh"),k=r("OTOS"),M=r("WH9N"),R=r("L8Ie"),L=r("0hZT");function B(){var e={},t=!1;return function(r,n,a,i,o,s){O.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration started");var c=Object(f.a)(r,n),l=c&&c.id,u=e&&l&&l.guid&&(!e.recordGuid||e.recordGuid&&l.guid!==e.recordGuid.guid);if(!t||u){var d=Object(k.b)(r,n.id),p=g.a.equals(g.a.tryParse(a.UniqueId),g.a.EMPTY)?n.controlId:a.UniqueId;e=d&&s===M.a?function(e,t,r,n){return{areaType:"dashboard",entityTypeName:null,recordGuid:null,formGuid:r,controlUniqueId:n,viewId:void 0}}(0,0,d,p):d&&s===R.a?function(e,t,r,n){var a=Object(f.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"dialog",entityTypeName:i,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,d,p):d?function(e,t,r,n){var a=Object(f.a)(e,t),i=a.entityTypeName,o=a.recordSetQueryKey;return{areaType:"form",entityTypeName:i,recordGuid:a.id,formGuid:r,controlUniqueId:n,viewId:o?o.split(",")[1]:void 0}}(r,n,d,p):s===L.a?function(e,t,r,n){var a=Object(D.cb)(e,n,t);return{areaType:"grid",entityTypeName:r,viewId:a?a.split(",")[1]:void 0}}(r,n,i.entityTypeName,o):{areaType:null,entityTypeName:null,controlUniqueId:p,viewId:void 0},t=!0}return O.a.info(n.controlId+".CustomControlFramework.Selectors.CustomControlHostPersonalizationInfoSelectors: createGetPersonalizationConfiguration finished"),e}}var V=r("pmTS"),G=r("uQP8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function U(e,t,r,n,a){var i=Object(G.a)(e,t),o=a?"__hiddenCommandManagerIds":"__pendingCommandManagerIds",s=Object(S.v)(n);return i&&i[o]&&i[o][s]&&i[o][s][r]?i[o][s][r]:null}var z=r("pdGj"),q=r("vO+w"),X=r("xc1f"),W=p.a.createEvent("CustomControlHostSelectors.mapStateToProps",h.c),H=r("CSbt"),Q=r("hXUt"),Y=r("5Fed"),K=r("PQ2H"),J=r("Oqm9"),Z=r("lMVv"),$=r("Eoze"),ee=r("vYfn"),te=r("i8/j"),re=r("9KTg");function ne(e,t){return{type:re.a,payload:e,meta:{pageId:t}}}function ae(e){return{type:"execute.cleanreferencepanelstate.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e){return{type:re.b,payload:{},meta:{pageId:e}}}(e)),Promise.resolve()}}}function ie(e){return{type:"execute.closeallsessiontabs.async",execute:function(t,r){var n=t.dispatch,a=(0,t.getState)();return n(function(e,t){return{type:re.c,payload:e,meta:{pageId:t}}}({sessionTabs:[],activeTabId:Object(J.b)(a,e)},e)),Promise.resolve()}}}function oe(e,t){return{type:"execute.closesessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=Object(J.a)(i,e,t);return o.splice(e,1),a(function(e,t){return{type:re.d,payload:e,meta:{pageId:t}}}({sessionTabs:o,activeTabId:s},t)),Promise.resolve()}}}function se(e){return{type:"execute.dismissmessage.async",execute:function(t,r){var n=t.dispatch;t.getState;return n(function(e,t){return{type:re.e,payload:{referencePanelState:t},meta:{pageId:e}}}(e,{messageId:""})),Promise.resolve()}}}function ce(e,t){return{type:"execute.initializereferencepanelcontrol.async",execute:function(r,n){var a=r.dispatch,i=r.getState,o=Object(J.c)(i(),t);if(e&&!(o.activeTabId&&o.controlNames.length>0))return a(function(e,t){return{type:re.f,payload:e,meta:{pageId:t}}}({controlNames:e.map((function(e){return e.Name})),activeTabId:e[0].Id},t)),Promise.resolve()}}}var le=r("sm1J");function ue(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){for(var a=r.dispatch,i=r.getState,o=Object(J.d)(i(),t),s=[],c=0;c<o.length;c++)o[c].id===e.id?s.push(e):s.push(o[c]);return a(function(e,t){return{type:re.h,payload:e,meta:{pageId:t}}}({sessionTabs:s},t)),Promise.resolve()}}}var de=r("kvLG"),pe=r("w/nD");var he=r("oj0s"),ge=r("qIF7"),me=r("I6xF"),fe=r("ObKm"),be=r("g9bv"),ve=r("jJRu"),ye=r("GHPx"),_e=r("cAHA");var Oe=r("h82J"),Se=r("pdOk"),Ce=r("RXRQ"),Ie=r("gBKR"),je=r("EcZf"),Pe=r("bCrZ"),Te=r("olrR"),Ee=r("OROb"),we=r("HEkv"),Fe=r("HfRC"),xe=r("evh6"),Ae=r("ya7l"),Ne=r("12n8"),De=r("4fxQ"),ke=r("wYyS");var Me=r("otMa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Re=function(){function e(e,t){this.Target=e,this.FieldName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"CalculateRollupField",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},FieldName:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Le=r("qYad"),Be=r("UR8A"),Ve=r("j6Db");var Ge=r("EGsq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ue=r("969l"),ze=r("mGpW"),qe=r("Ww2r");var Xe=r("XjtF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function We(e,t){return{type:"customcontrol.loadresources.async",execute:function(r,n){r.dispatch;var a=r.getState;return function(e,t,r,n){var a=Object(Ge.t)(t);return r.initializeContainerForClientApi(n).then((function(t){return t.loadWebResources([Object(Ge.a)(a,e)]).then((function(){return{container:t,webResourcePath:a}}))}))}(e,a(),n.ScriptManager,t)}}}var He=r("EwXg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Qe=r("n1Ju"),Ye=r("zsi3"),Ke=r("c7nC"),Je=r("F2uj");var Ze=r("8Fmj"),$e=r("w82B"),et=r("y5DA"),tt=r("RwQN"),rt=r("T0dC"),nt=r("/SAa"),at=r("o5EQ"),it=r("8VL5"),ot=r("cqI9"),st=r("Zdrd"),ct=r("Yc9S"),lt=r("0rak"),ut=r("G7N+"),dt=r("/j9Z"),pt=r("sgPk"),ht=r("TCcM"),gt=function(){function e(e,t,r){this.Target=e,this.Query=t,this.RollupType=r}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"Rollup",operationType:1,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Query:{typeName:"Microsoft.Dynamics.CRM.QueryBase",structuralProperty:2},RollupType:{typeName:"Microsoft.Dynamics.CRM.RollupType",structuralProperty:3,enumProperties:[,{name:"None",value:0},{name:"Related",value:1},{name:"Extended",value:2}]}}}},e}(),mt=r("Ia1G"),ft=r("CO6B"),bt=r("2IT6"),vt=r("ak18");function yt(e,t){void 0===t&&(t=!1);var r=[];return{type:"gridData.retrieve.rollup.async",execute:function(n,a){var i=n.dispatch,o=n.getState,s=o(),c=e.key,l=pt.a.fromState(e,o),u=Object(ht.u)(s,c,l.pageNumber-1);return u&&(l.pagingCookie=u),r.push({name:vt.a,value:Object(vt.e)(e)}),r.push({name:"isRefresh",value:t}),i(function(e,t,r){var n;void 0===r&&(r=!1);var a={lists:(n={},n[e]={initialized:r?ut.a.Refreshing:ut.a.Initializing,pageSize:t},n)};return{type:"gridData.retrieve.rollup",payload:a}}(c,l.pageSize,t)),function(e,t,r){return r.toQueryExpression(e,t).then((function(n){return t(Object(mt.b)(new gt(I.a.toExternalEntityReference(r.target),n,r.rollupType))).then((function(n){return Object(bt.g)(n).then((function(n){return function(e,t,r,n){var a=r.getKeyQuery(),i=Object(ft.e)(a),o=Object(Ie.e)(i.entity2AttributesMap);return t(o).then((function(){var t=e();return Object(ft.a)(t,a,i,n)}))}(e,t,r,n)}))}))}))}(o,i,l).then((function(e){s=o(),i(Object(je.e)(s,i,c,l,e))})).catch((function(e){Object(dt.b)(e)}))},getFailureParameters:function(e,t){return r},getSuccessParameters:function(e,t,n){return r}}}var _t=r("AVer"),Ot=r("Z46F"),St=r("slAZ");function Ct(e,t,r,n,a){var i="",o="";if(n&&n.message&&(i=n.message),n&&n.errorCode){var s=a||Ve.a,c=function(e){return r.EventManager.ReportComponentFailure(s,e,null,[{name:"hexErrorCode",value:o},{name:"errorStatus",value:JSON.stringify(n)},{name:"customControlId",value:a},{name:"APIName",value:Ve.a+".Actions.RefreshDataSetParameter.getErrorMessage"}]),Promise.resolve(o+" "+i)};try{var l="Error_Title_"+(o="0x"+Ot.a.getHexErrorCodeFromInt(n.errorCode)),u="Error_Message_"+o,d="Localized resource strings not found for neither "+l+" nor "+u+".  Please add error resources for error code "+o,p=e(Object(ze.e)([l])).catch((function(){})),h=e(Object(ze.e)([u])).catch((function(){}));return Promise.all([p,h]).then((function(){var e=Object(qe.e)(t(),[l,u]),r=Object(qe.c)(e,l),n=Object(qe.c)(e,u),a="";return(a=function(e){return"0x8005f211"===(null==e?void 0:e.toLowerCase())}(o)?r+(r&&n?": ":"")+n:r||n)?Promise.resolve(o+" "+a):c(d)}))}catch(e){return c(e)}}return Promise.resolve(o+" "+i)}function It(e,t){if(e instanceof nt.a)(r=e.getLatestData()).loading=!0,e.setRefreshingStart();else if(e instanceof at.a||e instanceof rt.a){var r;(r=e.getLatestData())&&(r.working=!0,at.a,e.setWrapperLoadingFlag(!0))}return{type:"customcontrol.refreshDataSetParameter.async",execute:function(r,n){var a=r.dispatch,i=r.getState;if(e instanceof tt.a){var o={retrieveGridDataAction:function(e){return a(Object(je.d)(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(pe.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(pe.X)(t,e,r,n))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},retreiveChartAction:function(e,t,r){return a(Object(Ze.a)(e,t,r))},retreiveChartDataAction:function(e,t,r,n){return void 0===n&&(n=!0),a(Object($e.a)(e,t,r,n))},updateDataSetChartVisualizationId:function(e,t,r){return a(Object(ot.b)(e,t,r))},updateDataSetChartVisualizationType:function(e,t,r){return a(Object(st.b)(e,t,r))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e,t){return Ct(a,i,n,e,t)},updateChartFilterExpression:function(e,t,r){return a(Object(ct.c)(e,t,r))},updateChartDrillDownParameters:function(e,t,r){return a(Object(lt.c)(e,t,r))},updateChartErrorInformation:function(e,t,r,n){Object(et.a)(e,a,t,r,n)}};return e.refreshDataSet(i,o,n)}var s={retrieveGridDataAction:function(e){return Object(m.a)(e.rollupType)?a(Object(je.d)(e)):a(yt(e))},retrieveViewAction:function(e,t,r,n){return a(Object(Te.a)(e,t,r,n))},retrieveViewSelectorAction:function(e,t){return a(Object(Te.b)(e,t))},runPreSearch:function(e,r,n){return a(Object(pe.W)(t,e,r,n))},runSetAdditionalParams:function(e,r,n){return a(Object(pe.X)(t,e,r,n))},startCustomFilter:function(e,t,r){return a(Object(St.f)(e,t,r))},endCustomFilter:function(e,t,r){return a(Object(St.e)(e,t,r))},refreshCustomDataProviderAction:function(e,t,r,n){return a(Object(it.b)(e,t,r,n))},getEntityMetadataAction:function(e,t){return a(Object(Ie.f)(e,!1,t))},getLocalizedErrorMessage:function(e){return Ct(a,i,n,e)},getAdditionalResourceStrings:function(e){return a(Object(ze.e)(e))},addCustomViewAction:function(e,t,r,n,i,o,s,c){return a(Object(_t.a)(e,t,r,n,i,o,s,c))},setOfflineQueryAction:function(e){return a(Object(_t.b)(e))}};return e.refreshDataSet(i,s,n)}}}var jt=r("IQF2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Pt=r("bH46"),Tt=r("VZmd");var Et=r("yrP7"),wt=r("vqdi"),Ft=r("LBS5"),xt=r("XJ3n");var At=r("zvr0"),Nt=r("nIt0"),Dt=r("455M");var kt=r("uO/V"),Mt=r("oY7N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Rt(e,t,r){if(r.dataSetUIOptions){var n=e+t.id,a=t.contextString;switch(t.contextString){case kt.h.ASSOCIATEDGRID:case kt.h.SUBGRID:case kt.h.GRID:break;case kt.h.CUSTOM:default:a=kt.h.CUSTOM}return o.createElement(Mt.a,{key:n,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:a,parentContextToken:t.parentContextToken,dataSetUIOptions:r.dataSetUIOptions})}return o.createElement(lr,{key:e,id:t.id,systemDefinedProperties:t.systemDefinedProperties,controlId:t.controlId,configuration:t.configuration,descriptor:t.descriptor,formInfo:t.formInfo,themingData:t.themingData,parentDefinedControlProps:t.parentDefinedControlProps,children:t.children,rowSpan:t.rowSpan,contextString:t.contextString,parentContextToken:t.parentContextToken})}var Lt=r("RB3d");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Bt(e){if(e){if(e instanceof I.a)return e;var t,r=e.entityName||e.LogicalName;return t=g.a.fromLegacyGuid(e.Id),g.a.isNullOrEmpty(t)&&(t=new g.a(e.id||e.Id)),new I.a(r,t,Object(m.a)(e.name)?e.Name:e.name)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vt(e,t,r,n){return n&&n.DisplayName&&"partylist"!==n.Type&&Object(Pt.b)(e,t,r,n)&&n.IsValidForAdvancedFind}var Gt=r("q6M9"),Ut=r("IUjT"),zt=r("eYbs"),qt=r("RlP9"),Xt=function(){function e(){}return e.prototype.convert=function(e,t,r){var n=(new DOMParser).parseFromString(e,"text/xml"),a=this._firstElementChild(n),i=this._childElements(a);if(!i)return null;for(var o=[],s=0,c=i;s<c.length;s++){for(var l=c[s],u=[],d=0,p=this._childElements(l);d<p.length;d++){var h=p[d];u.push(this._getGridCellDescriptor(h))}o.push(this._getGridRowDescriptor(l,u))}var g=this._getGridDescriptor(a,o,r);return this._populateRelationshipInformation(g,t),g},e.prototype._attributeValueBoolean=function(e,t){return"1"===this._attributeValueString(e,t,"")},e.prototype._attributeValueString=function(e,t,r){var n=e.attributes.getNamedItem(t);return n&&n.value||r},e.prototype._attributeValueInt=function(e,t,r){var n=this._attributeValueString(e,t,r+"");return parseInt(n,10)},e.prototype._childElements=function(e){return e?e.children?Array.from(e.children):e.childNodes?Array.from(e.childNodes).filter((function(e){return e.nodeType===Node.ELEMENT_NODE})).map((function(e){return e})):null:null},e.prototype._getGridCellDescriptor=function(e){return{name:this._attributeValueString(e,"name",""),width:this._attributeValueInt(e,"width",0),relatedEntityName:this._attributeValueString(e,"relatedentityname",""),disableMetaDataBinding:this._attributeValueBoolean(e,"disableMetaDataBinding"),labelId:this._attributeValueString(e,"LabelId",""),isHidden:this._attributeValueBoolean(e,"ishidden"),disableSorting:this._attributeValueBoolean(e,"disableSorting"),addedBy:this._attributeValueString(e,"addedby",""),desc:this._attributeValueString(e,"desc",""),cellType:this._attributeValueString(e,"cellType",""),imageProviderWebresource:this._attributeValueString(e,"imageproviderwebresource",""),imageProviderFunctionName:this._attributeValueString(e,"imageproviderfunctionname","")}},e.prototype._getGridRowDescriptor=function(e,t){return{name:this._attributeValueString(e,"name",""),id:this._attributeValueString(e,"id",""),cells:t,multiObjectIdField:this._attributeValueString(e,"multiobjectidfield",""),layoutStyle:this._attributeValueString(e,"layoutstyle","")}},e.prototype._getGridDescriptor=function(e,t,r){return{name:this._attributeValueString(e,"name",""),object:r,rows:t,customControlDescriptions:null,jump:this._attributeValueString(e,"jump",""),select:this._attributeValueBoolean(e,"select"),icon:this._attributeValueBoolean(e,"icon"),preview:this._attributeValueBoolean(e,"preview"),iconrenderer:this._attributeValueString(e,"iconrenderer","")}},e.prototype._firstElementChild=function(e){if(!e)return null;if(e.firstElementChild)return e.firstElementChild;var t=this._childElements(e);return t&&t[0]},e.prototype._populateRelationshipInformation=function(e,t){var r=(new DOMParser).parseFromString(t,"text/xml"),n=this._firstElementChild(r),a=this._firstElementChild(n),i=this._childElements(a);if(i)for(var o=0,s=i;o<s.length;o++){var c=s[o];"link-entity"===c.nodeName&&this._attributeValueString(c,"alias","")&&this._attributeValueString(c,"name","")&&this._setRelatedEntityName(e,this._attributeValueString(c,"alias",""),this._attributeValueString(c,"name",""))}},e.prototype._setRelatedEntityName=function(e,t,r){for(var n=0;n<e.rows.length;n++)for(var a=0;a<e.rows[n].cells.length;a++){var i=e.rows[n].cells[a].name;(i?i.substring(0,i.indexOf(".")):void 0)===t&&(e.rows[n].cells[a].relatedEntityName=r)}},e}(),Wt=r("bIXa"),Ht=r("r0s4");function Qt(e,t,r,n,a,i,o,s){return void 0===t&&(t=!1),{type:"populateAndSend.LookupData.Action",sync:!0,execute:function(c,l){var u=c.dispatch,d=(0,c.getState)(),p=a||e.LookupEntityByName[0].EntityLogicalName,h=Object(Ut.f)(d,p,o,n),m=[];if(s){var b=s.split("."),y=Object(f.g)(d,n),_=void 0,O=Object(v.ac)(d,n,r),S=Object(j.b)(d,O);_=S&&S.activeChanges&&S.activeChanges[b[1]]?S.activeChanges[b[1]]:Object(ht.j)(d,new I.a(b[0],y.id),b[1]),e.RelatedRecordId=_&&_.reference&&_.reference.id}if(e.LookupEntityByName&&e.LookupEntityByName.length)for(var C=Object(v.eb)(d,n,r),P=C&&C[i],T=0,E=e.LookupEntityByName;T<E.length;T++){var w=E[T],F=Object(Wt.b)(d,n,r,i,w.EntityLogicalName);if(F&&(w.CustomFilter=Object(Ht.CrmHtmlDecode)(F).replace(/"/g,"'")),h){var x=Object(zt.a)(d,h,w.EntityLogicalName);x&&x.view&&(g.a.equals(x.view.viewId,w.ViewId)||Object(qt.c)(d,w.ViewId))||m.push(u(Object(Te.a)(w.EntityLogicalName,null,null,w.ViewId)))}var A=P&&P.parameters&&P.parameters.defaultviewid;if(P&&P.views&&P.views[A]&&P.views[A].entityLogicalName===w.EntityLogicalName){w.ViewId=null,w.FetchXml=P.views[A].fetchXML.replace(/"/g,"'");var N=Object(Z.h)(d,w.EntityLogicalName),D=new Xt;w.LayoutJson=JSON.stringify(D.convert(P.views[A].layoutXML,P.views[A].fetchXML,N.ObjectTypeCode)).replace(/"/g,"'")}}var k=Object(Gt.b)(d,p,e),M=Object(ht.o)(d,k);t=t||M===ut.a.Initialized,m.push(u(Object(Gt.d)(e,t)));var R=function(e,t,r,n,a){var i,o,s={},c=n||r.EntityAndAttribute&&r.EntityAndAttribute.EntityName,l=a||r.EntityAndAttribute&&r.EntityAndAttribute.AttributeName;if(!c&&!l)return null;c||(c="placeholderEtn");if(r.LookupEntityByName)for(var u=0,d=r.LookupEntityByName;u<d.length;u++){var p=d[u];s[p.EntityLogicalName]=Object(Gt.b)(e,p.EntityLogicalName,r)}var h=Object(Gt.c)(e,r);return{type:"update.lookupRequestDataKey",payload:(i={},i[c]=(o={},o[l]={metadataKey:h,dataKeys:s},o),i),meta:{pageId:t}}}(d,n,e,a,o);return R&&u(R),Promise.all(m)}}}var Yt=r("kRDR"),Kt=r("CcDq");var Jt,Zt,$t,er,tr=r("feNe"),rr=r("aBa1");function nr(e,t){return{openEditForm:function(r,n,a,i,o){var s=Bt(r);e(n?Object(Fe.a)(s,t.id,void 0,void 0,n,a,i,o):Object(Fe.a)(s,t.id))},openGridPage:function(r,n,a,i,o,s,c,l){e(Object(xe.a)(r,t.id,g.a.tryParseOrNull(n),a,i,g.a.tryParseOrNull(o),s,null,l,c))},openCreateForm:function(r,n,a){e(Object(ee.b)(new I.a(r),null,"QuickCreate")).then((function(i){e(Object(ge.b)(r,t.id,null,n,Bt(a)))})).catch((function(a){e(Object(Fe.a)(new I.a(r),t.id,void 0,n))}))},openSearch:function(r){e(Object(Ne.a)(r,null,t.id))},openPowerBIFullScreenPage:function(r,n,a,i,o,s,c){e(Object(Ae.a)(t.id,r,n,a,i,o,s,c))},openDashboard:function(e){},openUrl:function(e,t){},openUrlWithProtocol:function(e,t){},openPhoneNumber:function(r,n,a,i,o,s,c,l,u,d,p){return void 0===d&&(d=!1),void 0===p&&(p=!0),e(function(e,t,r,n,a,i,o,s,c,l,u,d){return void 0===u&&(u=!1),void 0===d&&(d=!0),{type:"customcontrol.openphonecall",execute:function(p,h){var m=e.trim(),f=Object(Ge.x)(p.getState()).defaultCountryCode;0!==m.indexOf("tel:")?(f&&(m=f+m),m="tel:"+m):f&&(m=m.slice(0,4)+f+m.slice(4));var b,v=new Kt.a(h,p);h.ScriptManager.containerExists(Yt.d)&&(b=h.GlobalCustomEventManager);var y=function(){if(u){var c=null,l={};if(t){c=new I.a(r,new g.a(t));var d={id:t,entityType:r,name:n},h=d;i&&(h={id:i,entityType:o,name:s}),l.contactinfo=e,l.to=[d],l.regardingobjectid=h}return p.dispatch(Object(ge.b)("phonecall",a,null,l,c,null,{entityName:"phonecall",showDialog:!0}))}};return v.canOpenUri(m).then((function(e){if(d&&b&&p.dispatch(b.runOnOpenUrl(a,m,l,c)))return null;var t=Object(w.c)(p.getState(),E.C);e?(v.openUri(m),t&&y()):u&&t&&y()}),(function(){return null}))},shouldReceiveFullStore:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r,a,n,i,t.id,s,o,c,l,u,d,p))},openMaps:function(e){},openMap:function(e){}}}var ar=r("6Tlt"),ir=r("lU69"),or=r("Wg6j"),sr=r("uGUB"),cr=Object(a.a)((function(){var e,t={},r=null,a={},i={},o={},s=!1,c="",d=null,p={},h=!1,S="",C=!1,I={stateToPropsMappingError:!1,dynamicData:null,manifest:null,personalizationState:null,propBagData:null,pageType:null,popupStack:null,contextToken:null,portalFlyoutToDialogId:null,designLanguage:null,inactive:!1},j=-1,P=-1,T=Object(N.a)(),E=Object(V.a)(),w=B(),F=x();return function(x,A){O.a.info(A.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps started");var N,D,k,M,R,L=W.startStopwatch({controlId:A.controlId,parentId:Object(l.p)(A),level:(0).toString()}),B=[],V=!1,G=null,H=null,Q=null,Y=null,K=null,J=null,Z=null,$=null,ee=null,te=null,re=!1,ne=null,ae=null,ie=null,oe=!1;try{var se=null;A.formInfo?(d&&p.EntityName===A.formInfo.EntityName&&p.RecordId===A.formInfo.RecordId&&p.FormId===A.formInfo.FormId||(d={id:A.formInfo.RecordId?new g.a(A.formInfo.RecordId):null,formId:A.formInfo.FormId?new g.a(A.formInfo.FormId):null,entityTypeName:A.formInfo.EntityName},p=A.formInfo),se=d):se=Object(f.g)(x,A.id),H=A.descriptor,Q=A.configuration,k=Object(b.b)(x),N=Object(f.l)(x,A.id),Object(f.f)(x,A.id)&&(R="DialogContainer__"+A.id),!R&&A.parentDefinedControlProps&&A.parentDefinedControlProps.parentFlyoutId&&(R=A.parentDefinedControlProps.parentFlyoutId),N&&(D=F(x,A));var ce=Object(v.kb)(x,A,D),le=Q;if(null!==A.systemDefinedProperties){var ue=Object(n.__assign)(Object(n.__assign)({},Q.Parameters),A.systemDefinedProperties);le=Object(n.__assign)(Object(n.__assign)({},Q),{Parameters:ue})}if(!(Y=Object(_.e)(x,Q.CustomControlId)||Object(_.e)(x,Q.Name))||!Y.ConstructorName){Y=null;var de=Object(u.h)(Q.CustomControlId);de!==Q.CustomControlId&&(Y=Object(_.e)(x,de))}Y&&(Z=($=E(x,Y,se,ce,A.contextHelper)).response,te=(K=(J=T(le,H,A,x,se,D)).response)&&K.dataReady?w(x,A,H,se,D,N):null,ee=Object(y.a)(x,te,Y.CustomControlId,A.id));var pe=U(x,A.id,A.controlId,D);pe&&(re=pe.every((function(e){return Object(z.b)(x,e)}))),M=U(x,A.id,A.controlId,D,!0),ae=A.parentDefinedControlProps&&!Object(m.a)(A.parentDefinedControlProps.height)?A.parentDefinedControlProps.height:-1,ne=A.parentDefinedControlProps&&!Object(m.a)(A.parentDefinedControlProps.width)?A.parentDefinedControlProps.width:-1,ie=Object(q.b)(x)?Object(q.a)(x):null,oe=function(e,t,r,n){return Object(f.l)(e,t)===X.a&&!Object(v.Fb)(e,t,r,n)}(x,A.id,D,A.descriptor.Name)}catch(e){var he=Y.ConstructorName;O.a.error(he+": makeMapStateToProps encountered error, err "+e,[{name:"ApiName",value:"CustomControlFramework.Selectors.CustomControlHostSelectors"},{name:"controlId",value:A.controlId},{name:"customControlId",value:Y.CustomControlId},{name:"manifest",value:JSON.stringify(Y)},{name:"descriptor",value:JSON.stringify(H)},{name:"configuration",value:JSON.stringify(Q)},{name:"error.Stack",value:JSON.stringify(e.stack)}]),V=!0,G=e.toString()+". Stack: "+e.Stack}return r&&(B=B.concat(function(e,t){var r=[];return e.Disabled!==t.Disabled&&r.push("IsControlDisabled"),e.Label!==t.Label&&r.push("Label"),r}(H,r))),r=A.descriptor,K!==a||Y!==t||Z!==i||te!==o||V!==s||N!==c||re!==h||M!==e||ae!==P||ne!==j||R!==S||ie!==I.designLanguage||oe!==C?(ae===P&&ne===j||B.push("layout"),J&&(B=B.concat(J.updatedProperties)),$&&(B=B.concat($.updatedProperties)),ie!==I.designLanguage&&B.push("design"),I={stateToPropsMappingError:V,stateToPropsMappingErrorMessage:G,dynamicData:K,manifest:Y,personalizationState:ee,propBagData:Z,children:Q&&Q.Children,personalizationConfiguration:te,pageType:N,popupStack:k,contextToken:D,updatedProperties:B,globalCommandManagerInitialized:re,internalCommandManagerIds:M,portalFlyoutToDialogId:R,designLanguage:ie,inactive:oe},h=re,e=M,S=R,s=V,i=Z,t=Y,a=K,o=te,c=N,P=ae,j=ne,C=oe):I.updatedProperties=B,L({updatedProperties:JSON.stringify(B)}),O.a.info(A.configuration.CustomControlId+".CustomControlFramework.Selectors.CustomControlHostSelectors: makeMapStateToProps finished"),I}}),(function(){var e;return function(t,r){if(e)return e;var n=nr(t,r);return Jt={setNotification:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"customcontrol.propertybag.mode.setnotification",execute:function(s,c){var l=s.dispatch,u=s.getState,d={uniqueId:t||"",messages:[e],priority:0,notificationLevel:Ye.a.error,actions:[{actions:[function(){}],message:""}]};l(Object(Qe.b)(r,n,d,a));var p=u(),h=new I.a(i,g.a.fromExternalGuid(o)),m=Object(Je.a)(p,h.etn,n);return h&&m&&(2===m.RequiredLevel||1===m.RequiredLevel)&&l(Object(Ke.b)(r,n,!1,a)),!0},sync:!0}}(e,r,n,a,i,o,s))},clearNotification:function(e,r,n,a,i,o){return t(function(e,t,r,n,a,i){return{type:"customcontrol.propertybag.mode.clearnotification",execute:function(n,a){var o=n.dispatch,s=n.getState,c=Object(v.A)(s(),{controlName:t,id:e},r);if(c){i=i||"";for(var l=Object.keys(c),u=null,d=l.length-1;d>-1;--d)l[d]===i&&((u=c[l[d]]).actions=null,u.messages=null,u.notificationLevel=null,o(Object(Qe.b)(e,t,u,r)))}return!0},sync:!0}}(e,r,n,0,0,o))}},$t={setState:function(e){return!0},logMessage:function(e,r,n){t(function(e,t,r){return{type:"customcontrol.log",execute:function(n,a){n.dispatch,n.getState;var i=a.TraceManager.getTracer("customcontrol"),o=e+": "+t;switch(r){case He.a.Error:i.error(o);break;case He.a.Info:i.info(o);break;case He.a.Warning:i.warn(o);break;case He.a.Verbose:i.debug(o)}},sync:!0}}(e,r,n))}},Zt={isGetBarcodeValueOperationAvailable:function(){return t(Object(Me.c)())},isTakePictureOperationAvailable:function(){return t(Object(Me.e)())},isCaptureVideoOperationAvailable:function(){return t(Object(Me.b)())},isCaptureAudioOperationAvailable:function(){return t(Object(Me.a)())},isOpenARViewerAvailable:function(){return t(Object(Me.d)())}},er={clearNestedChild:function(e){return!0},createAccessibilityComponent:Lt.a,createCommandManagerUXComponent:function(){var e=null;return function(t){var r=dr(t);return hr(e,t.selectedRecords)?r.selectedRecords=e:e=r.selectedRecords,ur(r)}},createKeyboardShortcut:Lt.b,createXrmForm:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(Ft.b)(t,r,n,new g.a(a)))}(t,e,r,n,a)},createXrmGrid:function(e,r,n,a){var i=[C.a.AssociatedGrid,C.a.CustomGrid,C.a.SubGrid,C.a.MainGrid];if(e&&-1===i.indexOf(e.contextTokenType))for(var o in n)if("Grid"===n[o].Type){var s=n[o];t(Object(Pe.c)(s.TargetEntityType||s.EntityName,s.ViewId,r,e));break}return function(e,t,r,n,a){var i=Object(D.vb)(n);if(t){var o=void 0;switch(t.contextTokenType){case C.a.SubGrid:o=3;break;case C.a.AssociatedGrid:o=2;break;case C.a.MainGrid:case C.a.CustomGrid:o=1;break;default:var s=[{name:"contextToken",value:JSON.stringify(t)},{name:"controlName",value:a},{name:"isEditableGrid",value:i}];de.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmCommandObjectWrapper.createXrmGridWrapper",new Error("Unknown context token type for grid"),null,s),o=1}return!!e(Object(Ft.c)(t,r,i,o,a))}return!0}(t,e,r,n,a)},registerNewControl:function(e,r,n,a){return function(e,t,r,n,a){return!!e(Object(Ft.e)(t,r,n,a))}(t,e,r,n,a)},executeAddOnLoad:function(e,r){t(function(e,t){return{type:"customcontrol.executeAddOnLoad.async",sync:!0,execute:function(r,n){var a=r.dispatch;r.getState,e.gridRunOnLoad((function(e,r,i){if(n.ScriptManager.containerExists(e)){var o=n.ScriptManager.getContainer(e).getEventManager();a(o.runOnGridDataLoad(t,1,i,r))}}))}}}(e,r))},addSessionTab:function(e,r){return t(function(e,t){return{type:"execute.addsessiontab.async",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=Object(J.d)(i,t),s=!0;if(e){if(o.forEach((function(t){e.id===t.id&&(s=!1)})),s){if("quickViewFormTab"===e.type){var c=!1,l=e,u=Object(K.a)(6),d=Object(Z.E)(i,l.entityFormOptions.entityName),p=void 0;p=i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?Object(v.ec)(i,"activitypointer",new g.a(l.entityFormOptions.entityId)):Object(v.ec)(i,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId));var h=new I.a(l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),m=[];if(!p){var f=a(Object($.d)(h,[d]));m.push(f)}var b=Object(te.h)(i,l.entityFormOptions.entityName,u);if(g.a.isNullOrEmpty(b)){var y=a(Object(ee.b)(h,null,u)).then((function(e){b=e,g.a.isNullOrEmpty(b)||b===ee.a||(c=!0)}));m.push(y)}else c=!0,l.entityFormOptions.formId=b.guid;Promise.all(m).then((function(){l.entityFormOptions.formId=c?b.guid:"",l.entityMetadata={DisplayName:i.metadata.entities[l.entityFormOptions.entityName].DisplayName},i.data.entities.activitypointer&&i.data.entities.activitypointer.hasOwnProperty(l.entityFormOptions.entityId)?l.title=Object(v.ec)(i,"activitypointer",new g.a(l.entityFormOptions.entityId)):l.title=Object(v.ec)(i,l.entityFormOptions.entityName,new g.a(l.entityFormOptions.entityId)),o.unshift(l),a(ne({sessionTabs:o,activeTabId:l.id,messageId:c?"":"quick_view_form_not_exist_message"},t))}))}else o.unshift(e),a(ne({sessionTabs:o,activeTabId:e.id},t));return Promise.resolve()}a(ne({sessionTabs:o,activeTabId:e.id},t))}}}}(e,r))},closeSessionTab:function(e,r){return t(oe(e,r))},updateSessionTab:function(e,r){return t(ue(e,r))},closeAllSessionTabs:function(e){return t(ie(e))},dismissMessage:function(e){return t(se(e))},markActiveTab:function(e,r,n){return t(Object(le.b)(e,r,n))},initializeReferencePanelControl:function(e,r){return t(ce(e,r))},cleanReferencePanelState:function(e){return t(ae(e))},executeNotifyHandlersThatEventOccurred:function(e){return t(function(e){return{type:"execute.notifyhandlersthatevenoccurred.async",execute:function(t,r){var n=t.dispatch,a=t.getState,i=null;try{switch(e.eventName){case"onresultopened":n(Object(pe.U)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onselection":n(Object(pe.V)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onpostsearch":n(Object(pe.S)(e.contextToken,e.pageId,e.fieldName,e.record));break;case"onlookuptagclick":var o=e.contextToken,s=e.fieldName,c=e.record,l=!1,u=Object(pe.u)("ClientApi.ExecuteNotifyHandlersThatEventOccurred.runOnLookupTagClick",a(),r,e.pageId,c);u&&(l=n(u.runOnLookupTagClick(o,s,null,c,a()))),i=l}return Promise.resolve(i)}catch(e){throw de.a.getInstance().eventManager.ReportComponentFailure("ClientApi.ExecuteNotifyHandlersThatEventOccurred.executeNotifyHandlersThatEventOccurred",e),e}}}}(e))},getConnectorsApi:function(e){return null},executeRollupRequest:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.executeRollupRequest.async",execute:function(n,a){var i=n.dispatch;if(n.getState,e&&t){var o=new Re(e,t),s=Be.a.execute(o).then((function(e){return e.json()})).then((function(n){if(n){var o=[];for(var s in n)-1!==s.indexOf("@")||s.startsWith("_")||o.push(s);var c=new I.a(e.entityType,g.a.fromExternalGuid(e.id));return i(Object(Le.a)(r,c,o)).then((function(){a.EventManager.ReportComponentSuccess(Ve.a+".Action",[{name:"APIName",value:Ve.a+".Action.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType}])}),(function(r){a.EventManager.ReportComponentFailure(Ve.a+".Actions",r,"refreshRecordData failure error message",[{name:"APIName",value:Ve.a+".Actions.ExecuteRollupRequest"},{name:"target.entityType",value:e.entityType},{name:"target.id",value:e.id},{name:"fieldName",value:t},{name:"jsonResponse",value:n}])}))}}));return Be.a.Diagnostics.traceInfo(Ve.a+".refreshRecordData","refresh record data return promise"),s}return Promise.resolve()}}}(e,r,n))},getResource:function(e){return t(function(e){return{type:"customcontrol.getresources.async",execute:function(t,r){t.dispatch;var n=t.getState,a=r.AssetLoader,i=n(),o=Object(Ge.t)(i);if(3===e.Type||2===e.Type)return a.loadRawData(o+e.Name)}}}(e))},getRecordSetQueryKey:function(e){return e?e.getPreviousQueryKey():null},loadResources:function(e){return t(Object(Xe.a)(e))},triggerOfflineMetadataSync:function(){return t(Object(Se.h)())},retrieveFormWithAttributes:function(e,r,n){return t(Object(Pt.c)(new I.a(e),g.a.tryParse(r),n))},loadManifest:function(e,r){return t(Object(Ce.c)(e,r))},updateOutputs:function(e,r,n,a,i,o,s){return t(function(e,t,r,n,a,i,o){return{type:"outputs.update",execute:function(s,c){var l=s.dispatch,u=s.getState;try{var d={},p={};if(i)for(var h=0,g=Object.keys(i);h<g.length;h++){var m=g[h],f=i[m],b=m;switch(f.fieldName&&(b=f.fieldName),(f.paramType===Dt.a.LookupSimple||f.paramType===Dt.a.LookupCustomer||f.paramType===Dt.a.LookupOwner||f.paramType===Dt.a.LookupRegarding||f.paramType===Dt.a.LookupMultiEntity)&&f.value&&f.value instanceof Array&&(f.value.length>0?f.value=f.value[0]:f.value=null),f.type){case 0:d[b]=i[m];break;case 2:p[b]=i[m]}}var v=new Array,y=l(Object(fe.a)(e,d,!1,!1,t,r,a,o));if(v.push(y),Object(G.a)(u(),e).forms){var _=l(Object(At.b)(e,n,o,p));v.push(_)}else{var S=l(Object(Nt.b)(e,n,p));v.push(S)}return Promise.all(v)}catch(a){var C=n+" failed at updating its outputs",I=Object(O.b)(u(),n);return c.EventManager.ReportComponentFailure(I+".CustomControl.updateOutputs",a,C,[{name:"APIName",value:Ve.a+".Actions.UpdateOutputs"},{name:"customControlId",value:n},{name:"pageId",value:e},{name:"entityTypeName",value:t},{name:"recordId",value:r},{name:"outputs",value:JSON.stringify(i)}]),c.TraceManager.getTracer("customcontrol").warn(I+" failed at updating its outputs"),null}},sync:!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a,i,o,s))},updateFieldValue:function(e,r,n,a,i,o,s){return t(Object(fe.a)(e,r,!1,n,a,i,o,s))},runCustomOpenRecord:function(e,r,n,a){return t(function(e,t,r,n){return{type:"record.open",execute:function(a,i){var o=i.ScriptManager.getContainer(e).getEventManager(),s=new g.a(r),c=Object(S.f)(n,s,t),l=a.dispatch(Object(Ft.b)(c,e,t,s));return l=new xt.a(a,i,c,e,t,s),a.dispatch(o.runOnRecordOpen(n,r,l))}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},getBoundFileObject:function(e,r,n,a){if(null==e||null==r||null==r.id||null==n)return null;var i={id:new g.a(r.id),etn:r.entityType};return t(Object(tr.c)(e,i,n,a,"full"))},saveEmbeddedEntity:function(e,r,n,a,i,o,s,c){return void 0===s&&(s=!1),t(Object(wt.a)(e,r,n,a,i,o,s,c))},renderNestedCustomControl:Rt,renderReactSubtree:De.createPortal,retrieveView:function(e,r,n,a){return t(Object(Te.a)(e,r,n,a))},retrieveViewSelector:function(e,r){return t(Object(Te.b)(e,r))},retrieveGridData:function(e){return t(Object(je.d)(e))},retrieveRecordDataForForm:function(e,r,n,a,i){return t(Object($.e)(Bt(e),g.a.tryParse(r),n,a,i))},retrieveForm:function(e,r,n){var a=g.a.tryParse(r),i=Bt(e);return t(Object(ee.b)(i,a,n)).then((function(e){return t(Object(he.c)(a,i.etn)).then((function(){return e}))}))},retrieveEntityData:function(e){return t(Object(Ie.f)(e,!1,[]))},retrieveChartDrilldownAttributes:function(e){return t((r=e,{type:"customcontrol.charts.attributes.retrieve.async",execute:function(e,t){var n=e.dispatch,a=e.getState;return n(Object(Ie.f)(r,!0,[])).then((function(){var e=a(),t=Object(Je.d)(e,r);if(t&&Object.keys(t).length>0){var n={};for(var i in t){var o=t[i];Vt(e,r,i,o)&&(n[i]=o)}return n}return null}),(function(e){var n=e.get_message();return t.EventManager.ReportComponentFailure(Ve.a+".CustomControl.retrieveChartDrilldownAttributes",new Error(n),n,[{name:"APIName",value:Ve.a+".Actions.RetrieveChartDrilldownAttributes"},{name:"Entity",value:r}]),null}))}}));var r},refreshDataSetParameter:function(e,r){return t(It(e,r))},retrieveLookupMetadataAction:function(e){return t((r=e,{type:"customcontrol.retrieveLookupMetaData.async",execute:function(e,t){var n=e.dispatch,a=e.getState;if(r instanceof Tt.a){var i={retrieveGridDataAction:function(e){return n(Object(je.d)(e))},retrieveViewAction:function(e,t,r,a){return n(Object(Te.a)(e,t,r,a))},retrieveViewSelectorAction:function(e,t){return n(Object(Te.b)(e,t))},runPreSearch:function(e,t,r){return n(Object(pe.W)(Object(S.j)(a(),e),e,t,r))},runSetAdditionalParams:function(e,t,r){return n(Object(pe.X)(Object(S.j)(a(),e),e,t,r))},refreshCustomDataProviderAction:function(e,t,r,a){return n(Object(it.b)(e,t,r,a))},getEntityMetadataAction:function(e,t){return n(Object(Ie.f)(e,!1,t))}};return r.retrieveLookupMetadata(a,i)}}}));var r},retrieveDataSetLookupCellParameter:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.retrieveDataSetLookupCellParameter.async",execute:function(n,a){var i=n.dispatch,o=n.getState;return i(It(t,r)).then((function(){var r=t.retrieveDataSetObject(o(),e,a);return Promise.resolve(r)})).catch((function(e){a.EventManager.ReportComponentFailure(Ve.a+".Actions",{name:"error",message:e.get_message()},null,[{name:"APIName",value:Ve.a+".Actions.RetrieveDataSetLookupCellParameter"}])}))}}}(e,r,n))},updateControlMemoizedDataSet:function(e,r,n){return t(function(e,t,r){return{type:"customcontrol.updateControlMemoizedDataSet",sync:!0,execute:function(n,a){n.dispatch;var i=(0,n.getState)(),o=e.retrieveDataSetObject(i,null,null,null,a);e.linkToParameter(o,t),e.updateControlMemoizedParameter(i,o,!0,r)}}}(e,r,n))},loadResourceStrings:function(e){return t((r=e,{type:"customcontrol.loadresourcestrings.async",execute:function(e,t){var n=e.dispatch,a=e.getState,i=r.CustomControlId;if(!i)return Promise.resolve();var o=a(),s=Ue.a.getControlsResourceKeyList(i);if(!s)return Promise.resolve();var c=Object(qe.d)(o);if(!c)return n(Object(ze.e)(s));for(var l=[],u=0,d=s;u<d.length;u++){var p=d[u];c.hasOwnProperty(p)||l.push(p)}return 0===l.length?Promise.resolve():n(Object(ze.e)(l))}}));var r},retrieveLookupData:function(e){return t(Object(je.d)(e))},setFieldControlPersonalization:function(e,r,n){return t(Object(we.j)(e,r,n))},setGridControlPersonalization:function(e,r,n){return t(Object(we.m)(e,r,n))},setDashboardControlPersonalization:function(e,r,n){return t(Object(we.i)(e,r,n))},setGenericControlPersonalization:function(e,r,n){return t(Object(we.k)(e,r,n))},setGlobalControlPersonalization:function(e,r){return t(Object(we.l)(e,r))},setPowerBISignedInState:function(e,r){return t(Object(me.b)(e,r))},beginSecureSessionForResource:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.beginsecuresessionforresource",execute:function(a,i){var o=new ke.a(i,a);return n?o.beginSecureSessionForResource(e,t,r):o.beginSecureSessionForResourceSilent(e,t,r)},shouldReceiveFullStore:!0}}(e,r,n,a))},setXrmObject:function(e){},addPendingCommandManagerId:function(e,r,n,a){var i;return t(Object(Et.a)(e,r,n,a)),{promise:new Promise((function(e){i=e})),resolve:i}},initializeCommandManager:function(e,r,n,a,i){var o;return t(Object(Et.b)(e,r,n,a,i)),{promise:new Promise((function(e){o=e})),resolve:o}},retrieveRecordCommand:function(e,r,n,a,i,o,s,c,l,u){return t(Object(Et.c)(u,e,r,n,a,i,o,s,c,l))},setValue:function(e,r,n,a){return e&&r?t(function(e,t,r,n){var a=[{name:"snapshotId",value:n},{name:"entityTypeName",value:t.etn},{name:"attributeNameValuePairs.length",value:r?Object.keys(r).length:null}];return{type:"control.update.value.by.snapshot.async",execute:function(i,o,s){var c=i.dispatch,l=(0,i.getState)(),u=Object(S.j)(l,e),d=Object(S.x)(u),p=Object(ye.a)(l,n,t,r,!1,u,o.TraceManager.getTracer("Forms.UpdateValue")),h=g.a.isNullOrEmpty(t.id)?_e.a.Create:_e.a.Update;if(a.push({name:"CorrelationId",value:s.correlationId},{name:"ContextId",value:s.contextId},{name:"ActionStack",value:s.stack},{name:"mode",value:h}),n)return c(Object(be.b)(l,n,p)),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.updateDataSnapshot",a),Promise.resolve();var m=Object(ve.b)(l,t,p,d,h),f=m.payload.snapshotId;return c(m),a.push({name:"newSnapshotId",value:f}),o.EventManager.ReportComponentSuccess("Forms.UpdateValue.createDataSnapshotAction",a),Promise.resolve(f)},getFailureParameters:function(e,t){return a}}}(a,e,r,n)).then((function(e){return Promise.resolve(e||n)})):Promise.reject("setValue: entityReference and controlKeyValuePairs parameters are required")},save:function(e,r){return void 0===r&&(r=[]),t(Object(Ee.c)(e,!1,r))},openPopup:function(e){return t(Object(Y.a)(e))},closePopup:function(e){return t(Object(Q.a)(e))},loadWebResource:function(e,r){return t(We(e,r))},registerOngoingWork:function(e,r,n,a){return t(function(e,t,r,n){return{type:"customcontrol.registerworkoutstanding",execute:function(a,i){return a.dispatch,a.getState,jt.a.getInstance().addWorkOutstandingPromise(e,t,r,n),Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,r,n,a))},isPresenceEnabledEntity:function(e){return Object(H.b)(e)},getPresenceMappedField:function(e){return Object(H.a)(e)},fireXrmEvent:function(e,r,n,a,i){var o=t(Object(Oe.b)(r,n)),s=null;if(o&&o.ui&&o.ui.controls&&(s=o.ui.controls.get(e)),s)switch(a){case 0:s.fireOnKeyPress&&s.fireOnKeyPress()}},sendLookupRequest:function(e,r,n,a,i,o,s){return t(Qt(e,!0,r,n,a,i,o,s))},runPreSearch:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunPreSearch",execute:function(n){var a=n.dispatch;n.getState,a(Object(St.f)(r,t,e)),a(Object(pe.W)(e,r,t)),a(Object(pe.X)(e,r,t)),a(Object(St.e)(r,t,e))},sync:!0}}(e,r,n))},runOnReadyStateComplete:function(e,r,n){t(function(e,t,r){return{type:"CCF.RunOnReadyStateComplete",execute:function(n,a){var i=n.dispatch;n.getState,a.ScriptManager.containerExists(t)&&i(a.ScriptManager.getContainer(t).getEventManager().runOnReadyStateComplete(e,null,r))},sync:!0}}(e,r,n))},retrieveLookupRecordsBySearchString:function(e,r,n){return t(Object(rr.a)(e,r,n))},retrieveLookupRecordsByIds:function(e,r,n){return t(Object(rr.b)(e,r,n))}},e={actions:er,propBagMethods:{utils:$t,navigation:n,device:Zt,mode:Jt}}}}))(s.a),lr=function(e){function t(t,r){var n=e.call(this,t)||this;return n._updateCounter=0,n._isUpdateScheduled=!1,n._reRunMapStateToProps=function(){n._isUpdateScheduled||(n._isUpdateScheduled=!0,Object(sr.c)((function(){n._isUpdateScheduled=!1,n._updateCounter++,n.forceUpdate()})))},n._reRunMapStateToProps=n._reRunMapStateToProps.bind(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=null,t=null;return this.context&&this.context.CustomControlGlobalHelper&&(e=this.context.CustomControlGlobalHelper,t=this.context.TraceManager.getLogLevel()),o.createElement(c.a.Provider,{value:this.context},o.createElement(cr,Object(n.__assign)({},this.props,{contextHelper:e,logLevel:t,updateCounter:this._updateCounter,reRunMapStateMainProps:this._reRunMapStateToProps})))},t}(o.Component);function ur(e){var t="cm"+Object(ir.a)();return o.createElement(ar.a,{commandbarDisplayMode:e.commandbarDisplayMode,addedCommandList:e.addedCommandList,key:e.key,iconPosition:e.iconPosition,id:e.id,commandManagerId:e.commandManagerId||t,ribbonId:e.ribbonId,selectedRecords:e.selectedRecords,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,isHidden:e.isHidden,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType})}function dr(e){return{commandbarDisplayMode:void 0!==e.commandbarDisplayMode&&null!==e.commandbarDisplayMode?e.commandbarDisplayMode:or.a.IconLabel,id:e.id,commandManagerId:e.commandManagerId,ribbonId:e.ribbonId,mainMenuLength:e.mainMenuLength,iconPosition:e.iconPosition,selectedRecords:pr(e.selectedRecords),key:e.key,commandBarStyle:e.commandBarStyle,customCommandManagerStyle:e.customCommandManagerStyle,isHidden:e.isHidden,width:e.width,metaDataLoadedResolve:e.metaDataLoadedResolve,addedCommandList:e.addedCommandList,contextToken:e.contextToken,rootZIndex:e.rootZIndex,customControlType:e.customControlType}}function pr(e){var t=[];if(e)for(var r=0,n=e;r<n.length;r++){var a=n[r];t.push(Bt(a))}return t}function hr(e,t){if(e===t)return!0;if(e&&t&&e.length===t.length){for(var r=e.length,n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}return!1}lr.contextType=i.a},NfcN:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.referenceinformationbyrelationship";function a(e,t){return{type:n,payload:t,meta:{pageId:e}}}},Nhrb:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("Sscr"),a=r("uO/V"),i="control.update.parameter";function o(e,t,r,o,s){return{type:"control.update.parameter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,a.x+".updateControlParameterAction");u(function(e,t,r,o,s){var c=Object(n.v)(s);return{type:i,payload:{name:r,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:a.o}}}(e,0,r,o,s));var p=[];return p.push({name:"controlName",value:t}),p.push({name:"paramName",value:""+r}),l.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},Oiu5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return s})),r.d(t,"d",(function(){return c}));var n=r("Gemh");function a(e){var t=Object(n.m)(e),r=e&&e.metadata?e.metadata.entities:null,a=[];return r?(t.forEach((function(e){if(4200!==r[e].ObjectTypeCode){var t=function(e){var t=e.DisplayName,r=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:r}}(r[e]);a.push(t)}})),a.sort(i)):a}function i(e,t){var r=e.entityDisplayName,n=t.entityDisplayName,a=0;return r>n?a=1:r<n&&(a=-1),a}function o(e){for(var t=[],r=0;r<e.length;r++){var n={key:e[r].objectTypeCode,text:e[r].entityDisplayName};t.push(n)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map((function(e){return{key:e.value,text:e.text}})):[]}},OmYs:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="section.label";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,sectionName:r}}}},PLtI:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="tab.setlabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,tabId:r}}}},PZxu:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n,a=r("Gemh"),i=r("Zy0S"),o=r("XJ3n"),s=r("+Z9T"),c=r("Sscr"),l=r("9r0m"),u=r("TCcM"),d=r("QAhb"),p=r("9rlF"),h=r("IiPO"),g=r("w/nD"),m=r("ezfI"),f=r("/j9Z"),b=r("kvLG"),v=function(){function e(e,t,r,a,i,o,c){var l="ClientApi.XrmControlGrid.constructor";if(a||Object(s.j)(l,"pageId"),r||Object(s.j)(l,"contextToken"),e||Object(s.j)(l,"store"),i||Object(s.j)(l,"gridEntity"),Object(s.a)(o)&&Object(s.j)(l,"isEditable"),n=e,this._applicationContext=t,this._contextToken=r,this._pageId=a,this._gridEntityName=i,this.controlName=c,this._isEditable=o,!this._contextToken.contextTokenType){var u=h.a.getInstance().getEventParameters(this._contextToken);u.push({name:"controlName",value:this.controlName}),u.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(l,new f.a("context token passed to grids with empty context token type"),null,u)}}return Object.defineProperty(e.prototype,"_isEditable",{get:function(){var e=Object(a.V)(n.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){var t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmControlGrid._isEditable_get",new f.a("control configuration parameters not found"),null,t),this._isGridEditable}return e},set:function(e){this._isGridEditable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationContext",{get:function(){return m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext},set:function(e){m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")},enumerable:!1,configurable:!0}),e.prototype.getTotalRecordCount=function(){var e="ClientApi.XrmControlGrid.getTotalRecordCount";try{m.a.instance.reportCall(e);var t=Object(a.Y)(n.getState(),this._pageId,this._contextToken);if(t){var r=JSON.parse(t),i=r&&r.totalResultCount?r.totalResultCount:0;return m.a.instance.reportSuccess(e),i}return m.a.instance.reportSuccess(e),0}catch(t){var o=h.a.getInstance().getEventParameters(this.contextToken);throw o.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.getRows=function(){var e="ClientApi.XrmControlGrid.getRows";try{m.a.instance.reportCall(e);var t=new i.a(e),r=n.getState(),s=Object(a.H)(r,this.contextToken,{id:this.pageId});if(s)for(var l=0;l<s.length;l++){var u=s[l].identifier.id,d=this._getRowEntityName(s[l],u),p=new o.a(n,this._applicationContext,Object(c.f)(this.contextToken,u,d),this.pageId,d,u),g=s[l].identifier.id.guid;t.add(g,p)}return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.getSelectedRows=function(){var e="ClientApi.XrmControlGrid.getSelectedRows";try{m.a.instance.reportCall(e);var t=new i.a(e),r=Object(a.fb)(n.getState(),this.pageId,this.contextToken);if(r)for(var s=Object(a.Q)(n.getState(),this.pageId,this.contextToken),d=function(e){var i=void 0;if(s)i=s;else{var d=n.getState(),h=Object(a.v)(d,p.pageId,p.contextToken),g=(h&&h.queryKey&&Object(u.q)(d,h.queryKey,null,null,!0)||[]).find((function(t){return t.identifier&&l.a.equals(t.identifier.id,r[e])}));i=p._getRowEntityName(g,r[e])}var m=new o.a(n,p._applicationContext,Object(c.f)(p.contextToken,r[e],i),p.pageId,i,r[e]),f=r[e].guid;t.add(f,m)},p=this,g=0;g<r.length;g++)d(g);return m.a.instance.reportSuccess(e),t}catch(t){var f=h.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.addOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.m)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.removeOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),n.dispatch(Object(g.H)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}}},e.prototype.runOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.runOnRecordSelect";try{m.a.instance.reportCall(t),this._isEditable&&n.dispatch(Object(g.T)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var r=h.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getRowEntityName=function(e,t){var r=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===r){var a=Object(u.j)(n.getState(),new d.a(this._gridEntityName,t),"activitytypecode");if(Object(p.j)(a))return a.value}return r},Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}()},PhZR:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.label";function a(e,t,r,a){return{type:n,payload:{label:r,currentLanguageId:a},meta:{pageId:e,navigationItemId:t}}}},"Pm+b":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("7z0H"),a=r("bCrZ"),i=r("Sscr");function o(e,t,r){var a=Object(i.v)(r),o={xrmReady:e};return{type:n.b,payload:o,meta:{pageId:t,contextKey:a}}}function s(e,t,r){var n=Object(i.u)(r),o={xrmReady:e};return{type:a.b,payload:o,meta:{pageId:t,contextKey:n}}}},Q60c:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="controls.DefaultView";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},QItn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.mrudisabled";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:o,meta:{pageId:t,controlName:r,contextKey:s}}}},Qeyq:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(){return{tabId:"",navigationStack:[]}}r.d(t,"a",(function(){return n}))},RB3d:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return s}));var n=r("nuS9"),a=r("B73A"),i=r("akzq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t,r,n,i,o){return new a.a(e,(function(e){t(e.EVENT)}),r,n,i,o)}function s(e){return n.createElement(i.a,{key:e.id,keyboardShortcuts:e.keyboardShortcuts,defaultFocusId:e.defaultFocusId,rootElementId:e.rootElementId,isModal:e.isModal,shouldManageFocus:e.shouldManageFocus||!1})}},SdPQ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.bodyvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},TCDU:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r("1Tfq"),a=r("aGOT"),i=r("HSdq"),o=r("kk/C"),s=r("OTOS"),c=r("Sscr"),l=r("yHpA"),u=r("2p2B"),d=r("Srej");function p(e){return{type:"handle.unsaved.changes.async",execute:function(t,r,p){var h=t.dispatch,g=t.getState;return h(Object(n.a)(e)).then((function(t){if(t){for(var r=Object(s.a)(g(),e),n=r.map((function(e){return Object(c.j)(g(),e)})),p=0;p<r.length;p++){for(var m=r[p],f=n[p],b=Object(i.ac)(g(),m,f),v=Object(l.b)(g(),b),y=0,_=(null==v?void 0:v.activeChanges)?Object.keys(v.activeChanges):[];y<_.length;y++){var O=_[y];h(Object(u.b)(f,m,Object(d.d)(m,O)))}h(Object(a.c)(m,b,f)),h(Object(o.d)(m,f))}return!0}return!1}))}}}},"Tk0/":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("9r0m"),a=r("i8/j"),i=new n.a("8c54228c-1b25-4909-a12a-f2b968bb0d62");function o(e,t){var r=Object(a.d)(e,t,null);if(!r||1!==Object.keys(r).length)return null;var o=r[Object.keys(r)[0]];return o&&n.a.equals(o.ClassId,i)?o.Parameters:null}function s(e,t){var r=o(e,t),n=null==r?void 0:r.Type;return n&&-1!==["1","2"].indexOf(n)}},"U/bH":function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return d}));var n=r("Sscr"),a=r("uO/V"),i=r("Gemh"),o=r("VWqI"),s=r("EwXg"),c=r("BFwB"),l=r("+Xnp"),u="dataset.dependentoptionset.column.status";function d(e,t){var r=[];return{type:"dependentoptionset.column.status",sync:!0,execute:function(o,l,d){var m=o.dispatch,f=o.getState,b=l.TraceManager.getTracer(a.z),v=a.x+".SetDependentOptionSetColumnStatusAction";l.TraceManager.setLogLevel(s.a.Info,v);try{var y=Object(n.v)(t),_=f(),O=null,S=Object(i.Q)(f(),e,t),C={};if(S)O=S;else{var I=Object(i.S)(f(),{id:e},t);I&&I.entityLogicalName&&(O=I.entityLogicalName)}if(O){r.push({name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:O}),b.info("Executing initialize dependent option set column status action in grid.",r);var j={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},P=[],T=0,E=Object(i.z)(_,t,O,e);for(var w in E){var F=E[w];if(null===F.ParentPicklistLogicalName){var x={name:w,value:0};p(_,t,e,O,E,w,x)?h(E,w,C,j):(g(E,w,C),T++,P.push(x))}else void 0===E[F.ParentPicklistLogicalName]&&h(E,w,C,j)}var A={name:"NumCompleteDependentOptionSetChainsInGrid",value:T},N={name:"CompleteChainsMaxDepthInGrid",value:P};r.push(A,j,N);var D=new c.a(v);D.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",T),D.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",j.value),D.addEventParameter("CompleteChainsMaxDepthInGrid",P),l.EventManager.ReportEvent(D),l.EventManager.ReportComponentSuccess(v),b.info("Executed initialize dependent option set column status action successfully.",r)}Object.keys(C).length>0&&m(function(e,t,r){return{type:u,payload:r,meta:{pageId:e,dataSetContextKey:t}}}(e,y,C))}catch(e){l.EventManager.ReportComponentFailure(v,Error("creating dependent option set column status node in state tree failed."))}}}}function p(e,t,r,n,a,i,s){if(void 0===a[i])return!0;if(function(e,t,r,n,a){if(!Object(o.f)(e,a,n,l.a.CanUpdate)||!r[n].IsValidForUpdate)return!0;return!1}(e,0,a,i,n))return!0;var c=a[i].ChildPicklistLogicalNames;if(null!==c)for(var u=0;u<c.length;u++){var d={name:i,value:0};if(p(e,t,r,n,a,c[u],d))return!0;s.value=Math.max(s.value,d.value)}return s.value=s.value+1,!1}function h(e,t,r,n){if(void 0!==e[t]){r[t]=0,n.value=n.value+1;var a=e[t].ChildPicklistLogicalNames;if(a)for(var i=0;i<a.length;i++)h(e,a[i],r,n)}}function g(e,t,r){r[t]=1;var n=e[t].ChildPicklistLogicalNames;if(n)for(var a=0;a<n.length;a++)g(e,n[a],r)}},UVKb:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n,a=r("qC0c"),i=r("lFQy"),o=r("t8f4"),s=r("Y70o"),c=r("WS0f"),l="ProcessControl_ActionExecuter_ExecutionTimeTooltip",u="ProcessControl_ActionExecuter_ErrorMessageTooltip",d="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";function p(e){switch(e){case n.InProgress:case n.Waiting:return 1;case n.Succeeded:return 2;case n.Failed:case n.Canceled:return 3;default:return 0}}function h(e,t,r,a){var i="";if(Object(c.b)(e)||(i=String.format(a[l],new Date(e).toLocaleString())),r===n.Failed){var o=Object(c.b)(t)?a.Crm_GenericErrorMessage:t;i+="\n"+String.format(a[u],o)}return""===i?t:i}function g(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute:function(r,n){var c=r.dispatch,g=r.getState,m=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),f=g();if(function(e){return Object(a.b)(e,"BpfActionSupportActionQuerying")}(f))return c(Object(o.e)("workflowlog",m)).then((function(e){if(e.value&&e.value.length){var r={};r[l]=Object(s.a)(f,d,l),r[u]=Object(s.a)(f,d,u),r.Crm_GenericErrorMessage=Object(s.a)(f,d,"Crm_GenericErrorMessage");var n={};e.value.forEach((function(e){if(e.stepname&&-1===Object.keys(n).indexOf(e.stepname)){var t={actionLogId:e.workflowlogid,status:p(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:h(e.modifiedon,e.message,e.status,r)};n[e.stepname]=t}}));var a={actionLogCollection:n};return c(Object(i.a)(a,t))}}))}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(n||(n={}))},VHYb:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ie}));var n,a,i,o,s,c,l,u,d,p=r("c/eZ"),h=r("ASFs"),g=r("nn4v"),m=r("3IUl"),f=[],b=Object(h.d)(((n={})[m.a]=function(e,t){return void 0===e&&(e=f),t.payload?t.payload:e},n),f),v=r("bc+P"),y=Object(h.d)(((a={})[v.a]=function(e,t){return void 0===e&&(e=null),t?t.payload:e},a),null),_=r("Ds7n"),O=r("krRo"),S=r("9r0m"),C=Object(h.d)(((i={})[_.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},i[O.b]=function(e,t){if(void 0===e&&(e=null),e&&e.records){var r=e.records.filter((function(e){return Object.keys(e)[0]===S.a.toString(t.payload.recordId)}));if(r&&r.length){var n=r[0];n&&n[S.a.toString(t.payload.recordId)]&&n[S.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))&&(void 0!==t.payload.requiredLevel&&(n[S.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].requiredLevel=t.payload.requiredLevel),void 0!==t.payload.isDisabled&&(n[S.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].isDisabled=t.payload.isDisabled),void 0!==t.payload.notifications&&(n[S.a.toString(t.payload.recordId)].filter((function(e){return Object.keys(e)[0]===t.payload.attributeName}))[0][t.payload.attributeName].notifications=t.payload.notifications))}}return e},i[O.a]=function(e,t){return void 0===e&&(e=null),e},i),null),I=r("19Zc"),j={activityOrQueue:null,jumpBar:null,quickFind:null,advancedFindFilter:null,activityOrQueueFilterValue:null,activityTypeFilter:null,activityTypeSelectedValues:null},P=function(e,t){switch(void 0===e&&(e=j),t.type){case I.e:return Object(p.__assign)(Object(p.__assign)({},e),{activityOrQueue:t.payload});case I.b:return Object(p.__assign)(Object(p.__assign)({},e),{activityTypeFilter:t.payload});case I.f:return Object(p.__assign)(Object(p.__assign)({},e),{jumpBar:t.payload});case I.g:return Object(p.__assign)(Object(p.__assign)({},e),{quickFind:t.payload});case I.d:return Object(p.__assign)(Object(p.__assign)({},e),{activityOrQueueFilterValue:t.payload});case I.c:return Object(p.__assign)(Object(p.__assign)({},e),{advancedFindFilter:t.payload});case I.a:return Object(p.__assign)(Object(p.__assign)({},e),{activityTypeSelectedValues:t.payload});default:return e}},T=Object(h.d)(((o={})[I.e]=P,o[I.f]=P,o[I.g]=P,o[I.d]=P,o[I.c]=P,o[I.b]=P,o[I.a]=P,o),j),E=r("7oc5"),w=Object(h.d)(((s={})[E.a]=function(e,t){return void 0===e&&(e=false),e!==t.payload?t.payload:e},s),false),F=r("d26+"),x=Object(h.d)(((c={})[F.a]=function(e,t){return void 0===e&&(e=""),t.payload?t.payload:e},c),""),A=r("whwt"),N=Object(h.d)(((l={})[A.a]=function(e,t){return void 0===e&&(e=false),t.payload&&"showChart"===t.payload.name?t.payload.value:e},l),false),D=r("Cgjg"),k={customFilterXml:null,source:null,timeStamp:null},M=Object(h.d)(((u={})[D.a]=function(e,t){return void 0===e&&(e=k),null!=t.payload?t.payload:e},u),k),R=r("zETL"),L=Object(h.d)(((d={})[R.a]=function(e,t){if(t.payload)return t.payload;return e},d),0);var B,V=r("JVfT"),G=Object(h.d)(((B={})[V.a]=function(e,t){if(t.payload)return t.payload;return e},B),0);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var U,z=r("0bF2"),q=Object(h.d)(((U={})[z.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},U),null);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function X(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function W(e,t){return void 0===e&&(e=!1),e!==t.payload?t.payload:e}var H,Q,Y,K,J=r("Nhrb"),Z=Object(h.d)(((H={})[J.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"ViewId"===t.payload.name?S.a.tryParseOrNull(t.payload.value):e},H),null),$=r("cqI9"),ee=Object(h.d)(((Q={})[$.a]=function(e,t){return void 0===e&&(e=null),t.payload&&"VisualizationId"===t.payload.name?S.a.tryParseOrNull(t.payload.value):e},Q),null),te=r("Zdrd"),re=r("z9yS").a.savedvisualization,ne=Object(h.d)(((Y={})[te.a]=function(e,t){return void 0===e&&(e=re),t.payload&&"chartVisualizationType"===t.payload.name?t.payload.value:e},Y),re),ae={parameters:{}};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ie,oe,se,ce=Object(h.d)(((K={})[J.a]=function(e,t){var r;void 0===e&&(e=ae);var n,a=t.payload.name,i=e.parameters;for(var o in i)i[o].Name===a&&(n=o);var s=Object(p.__assign)(Object(p.__assign)({},e.parameters[n]),{Value:t.payload.value}),c=Object(p.__assign)(Object(p.__assign)({},e.parameters),((r={})[n]=s,r));return c[a]&&(c[a]=t.payload.value),Object(p.__assign)(Object(p.__assign)({},e),{parameters:c})},K),ae),le=Object(h.b)("controlName",ce),ue=r("Yc9S"),de=Object(h.d)(((ie={})[ue.b]=function(e,t){return void 0===e&&(e=""),t.payload&&t.payload.name===ue.a?t.payload.value:e},ie),""),pe=r("0rak"),he=[],ge=Object(h.d)(((oe={})[pe.b]=function(e,t){return void 0===e&&(e=he),t.payload&&t.payload.name===pe.a?t.payload.value:e},oe),he),me=r("YT7W"),fe=r("4Q7K"),be=r("FPMG"),ve=r("r7Ib");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ye(e,t){return t.payload?t.payload:e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var _e=Object(h.d)(((se={})[ve.a]=function(e,t){if(t)return t.payload;return e},se),"");var Oe,Se=r("U/bH"),Ce=Object(h.d)(((Oe={})[Se.a]=function(e,t){return void 0===e&&(e=null),t.payload?t.payload:e},Oe),null),Ie=Object(h.b)("dataSetContextKey",(function(e,t){switch(void 0===e&&(e=g.a),t.type){case m.a:return Object(p.__assign)(Object(p.__assign)({},e),{selectedRows:b(e.selectedRows,t)});case v.a:return Object(p.__assign)(Object(p.__assign)({},e),{selectedRelatedEntity:y(e.selectedRelatedEntity,t)});case _.a:return Object(p.__assign)(Object(p.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case R.a:return Object(p.__assign)(Object(p.__assign)({},e),{refreshCounter:L(e.refreshCounter,t)});case V.a:return Object(p.__assign)(Object(p.__assign)({},e),{pagingRefreshInput:G(e.pagingRefreshInput,t)});case z.a:return Object(p.__assign)(Object(p.__assign)({},e),{queryKey:q(e.queryKey,t)});case D.a:return Object(p.__assign)(Object(p.__assign)({},e),{customFilter:M(e.customFilter,t)});case I.e:case I.b:case I.f:case I.g:case I.d:case I.c:case I.a:return Object(p.__assign)(Object(p.__assign)({},e),{filters:T(e.filters,t)});case E.a:return Object(p.__assign)(Object(p.__assign)({},e),{useRollupView:w(e.useRollupView,t)});case F.a:return Object(p.__assign)(Object(p.__assign)({},e),{fetchXml:x(e.fetchXml,t)});case J.a:return Object(p.__assign)(Object(p.__assign)({},e),{viewId:Z(e.viewId,t),controls:le(e.controls,t)});case $.a:return Object(p.__assign)(Object(p.__assign)({},e),{visualizationId:ee(e.visualizationId,t)});case te.a:return Object(p.__assign)(Object(p.__assign)({},e),{chartVisualizationType:ne(e.chartVisualizationType,t)});case O.b:case O.a:return Object(p.__assign)(Object(p.__assign)({},e),{rowProperties:C(e.rowProperties,t)});case me.a:return Object(p.__assign)(Object(p.__assign)({},e),{pageNumber:X(e.pageNumber,t)});case fe.a:return Object(p.__assign)(Object(p.__assign)({},e),{isNewPageRequested:W(e.isNewPageRequested,t)});case be.a:return Object(p.__assign)(Object(p.__assign)({},e),{pagingData:ye(e.pagingData,t)});case ve.a:return Object(p.__assign)(Object(p.__assign)({},e),{commandManagerId:_e(e.commandManagerId,t)});case ue.b:return Object(p.__assign)(Object(p.__assign)({},e),{chartFilterExpression:de(e.chartFilterExpression,t)});case pe.b:return Object(p.__assign)(Object(p.__assign)({},e),{chartDrillDownParameters:ge(e.chartDrillDownParameters,t)});case A.a:return Object(p.__assign)(Object(p.__assign)({},e),{showChart:N(e.showChart,t)});case Se.a:return Object(p.__assign)(Object(p.__assign)({},e),{dependentOptionSetColumnStatus:Ce(e.dependentOptionSetColumnStatus,t)});default:return e}}))},W51q:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("qC0c"),a=r("cZkS"),i=r("7EJx");function o(e){return!!Object(n.a)(e,a.S,a.h)&&(!!Object(n.a)(e,a.d,a.Lc)||1033===Object(i.s)(e))}},WVwd:function(e,t,r){"use strict";r.d(t,"a",(function(){return K})),r.d(t,"b",(function(){return J}));var n,a,i,o=r("9r0m"),s=r("HSdq"),c=r("BWVO"),l=r("7ipg"),u=r("1z64"),d=r("QAhb"),p=r("/eCp"),h=r("TCcM"),g=r("nbQV"),m=r("IiPO"),f=r("+Z9T"),b=r("ezfI"),v=function(){function e(e,t,r){var n="ClientApi.XrmProcessStep.constructor";t||Object(f.j)(n,"step"),r||Object(f.j)(n,"processManager"),e||Object(f.j)(n,"store"),this._step=t,this._processManager=r}return e.prototype.isRequired=function(){var e="ClientApi.XrmProcessStep.isRequired";try{b.a.instance.reportCall(e);var t=this._step.get_isProcessRequired();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getAttribute=function(){var e="ClientApi.XrmProcessStep.getAttribute";try{if(b.a.instance.reportCall(e),!this._attribute){var t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return b.a.instance.reportSuccess(e),this._attribute}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStep.getName";try{b.a.instance.reportCall(e);var t=this._step.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getProgress=function(){var e="ClientApi.XrmProcessStep.getProgress";try{b.a.instance.reportCall(e);var t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0))if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){var r=this._processManager.getActionLog(new o.a(this._step.get_Id()));r&&(t=r.status),t=0}return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.setProgress=function(e,t){var r="ClientApi.XrmProcessStep.setProgress";try{b.a.instance.reportCall(r);var n="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:n=this._setProgressInternal(e,t)}return b.a.instance.reportSuccess(r),n}catch(e){throw m.a.getInstance().reportFailure(r,e),e}},e.prototype._setProgressInternal=function(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)&&this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){var r=this._processManager.UpdateActionLog(new o.a(this._step.get_Id()),e,t);if(r)return r}return"invalid"},e}(),y=r("Zy0S"),_=function(){function e(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}return Object.defineProperty(e.prototype,"allowCreateNew",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew},set:function(e){var t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{b.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),b.a.instance.reportSuccess(t)}catch(e){throw m.a.getInstance().reportFailure(t,e),e}},enumerable:!1,configurable:!0}),e}(),O=function(){function e(e,t,r,a,i){n=e,this._entityTypeName=r,this._activeStageId=a,this._stageStep=t,new _(e,i),i&&(this._processManager=i)}return e.prototype.getCategory=function(){var e="ClientApi.XrmProcessStage.getCategory";try{b.a.instance.reportCall(e);var t=this._stageStep.get_stageCategory(),r={getValue:function(){var e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return b.a.instance.reportSuccess(e),r}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmProcessStage.getId";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getEntityName=function(){return b.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessStage.getStatus";try{b.a.instance.reportCall(e);var t=this.getId()===this._activeStageId?"active":"inactive";return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStage.getName";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Description();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getSteps=function(){var e="ClientApi.XrmProcessStage.getSteps";try{if(b.a.instance.reportCall(e),!this._steps&&(this._steps=new y.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(var t=0;t<this._stageStep.get_Steps().get_Count();t++){var r=this._stageStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var a=r.get_Steps().get_item(0);a&&(a instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(r.get_Id(),new v(n,r,this._processManager))}}return b.a.instance.reportSuccess(e),this._steps}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getNavigationBehavior=function(){var e="ClientApi.XrmProcessStage.getNavigationBehavior";try{b.a.instance.reportCall(e);var t=this._processManager.getBpfNavigationBehavior();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),S=function(){function e(e,t,r,n,i){var o="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(f.j)(o,"workflowStep"),n||Object(f.j)(o,"activeStageId"),i||Object(f.j)(o,"processManager"),e||Object(f.j)(o,"store"),Object(f.a)(r)&&Object(f.j)(o,"isRendered"),a=e,this._isRendered=r,this._workflowStep=t,this._activeStageId=n,this._processManager=i}return e.prototype.getName=function(){var e="ClientApi.XrmBusinessProcessFlow.getName";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmBusinessProcessFlow.getId";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.isRendered=function(){return b.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered},e.prototype.getStages=function(){var e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(b.a.instance.reportCall(e),!this._stages){this._stages=new y.a(e);for(var t=0;t<this._workflowStep.get_Steps().get_Count();t++){var r=this._workflowStep.get_Steps().get_item(t);if(r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep)for(var n=r,i=0;i<n.get_Steps().get_Count();i++){var o=n.get_Steps().get_item(i);this._stages.add(o.get_Id(),new O(a,o,n.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}return b.a.instance.reportSuccess(e),this._stages}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),C=r("w/nD"),I=r("JBkQ"),j=r("7kKV"),P=r("AqA3");!function(e){e.success="success",e.invalid="invalid"}(i||(i={}));var T,E,w=r("m8A1"),F=r("BvBP"),x=r("c56u"),A=r("JlqV"),N=r("kvLG"),D=r("sOTk"),k=r("b1hT"),M=r("l9h5"),R=r("Z1aD"),L=r("xc1f"),B=function(){function e(e,t,r,n,a){this._clientApiExecutor=new u.a(e,"ClientApi.XrmProcessControlData.",r,t);var i=this._clientApiExecutor.getComponentName("constructor");r||Object(f.j)(i,"pageId"),n||Object(f.j)(i,"entity"),t||Object(f.j)(i,"contextToken"),e||Object(f.j)(i,"store"),T=e,this._pageId=r,this._entity=n;var s=!1;Object(w.d)(T.getState(),this._pageId,i,!0)&&(this._processManager=a,s=!0),this._contextToken=t;var c=n.getEntityReference();this._entityRef=new d.a(c.entityType,o.a.tryParseOrNull(c.id),c.name);var l=Object(w.b)(r,e.getState(),s);N.a.getInstance().eventManager.ReportComponentSuccess(i,l)}return e.prototype.getActiveProcess=function(){var e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcess(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new S(T,t,!0,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.setStatus=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setStatus";try{if(b.a.instance.reportCall(n),!Object(w.d)(T.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void b.a.instance.reportSuccess(n);var a;if(e===I.a.active)a=p.a.Active;else if(e===I.a.finished)a=p.a.Finished;else{if(e!==I.a.aborted)return void b.a.instance.reportSuccess(n);a=p.a.Aborted}this._getProcessManager().setStatus(a).then((function(){r._callback(t,e,n),b.a.instance.reportSuccess(n)})).catch((function(t){var a=m.a.getInstance().getEventParameters(r._contextToken);return a.push({name:"newStatus",value:e}),Object(f.d)(T,t,n,a)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessControlData.getStatus";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return b.a.instance.reportSuccess(e),t}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getInstanceName=function(){var e="ClientApi.XrmProcessControlData.getInstanceName";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceName();if(!t){var r=Object(h.e)(T.getState(),this._entityRef);t=Object(g.c)(T.getState(),r)}return b.a.instance.reportSuccess(e),t}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getInstanceId=function(){var e="ClientApi.XrmProcessControlData.getInstanceId";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceId(),r=t?o.a.toString(t):null;return b.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getProcessInstances=function(e){var t=this,r="ClientApi.XrmProcessControlData.getProcessInstances";try{if(b.a.instance.reportCall(r),!Object(w.d)(T.getState(),this._pageId,r)||Object(k.g)(T.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then((function(n){if(n&&n.value&&n.value.length>0){var a={};n.value.forEach((function(e){e.businessprocessflowinstanceid&&(a[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:t._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})})),Object(l.c)(r,[],(function(){e(a)}))}b.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".getProcessInstances",n)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.setActiveProcess=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcess",(function(n,a){var s=o.a.tryParseOrNull(e),c=Object(D.m)(T.getState(),r._pageId);if(s&&o.a.equals(s,o.a.EMPTY)){if(c){var l=new d.a(r._entity.getEntityName(),o.a.EMPTY);return T.dispatch(Object(M.b)(!0,l)),N.a.getInstance().eventManager.ReportComponentSuccess(n,a),Promise.resolve().then((function(){return r._callback(t,i.success,n,a),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}return Promise.resolve().then((function(){return r._callback(t,i.invalid,n,a),Promise.resolve()}))}if(!Object(w.d)(T.getState(),r._pageId,n,!0)||Object(k.g)(T.getState()))return Promise.resolve();return(c?Promise.resolve():r._getProcessManager().setActiveProcess(e)).then((function(){r._callback(t,i.success,n,a);var o=r.getActiveProcess();return o&&o.getId().toUpperCase()===e.toUpperCase()||r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.setActiveProcessInstance=function(e,t){var r=this;this._clientApiExecutor.executeAsync("setActiveProcessInstance",(function(n,a){return!Object(w.d)(T.getState(),r._pageId,n)||Object(k.g)(T.getState())?Promise.resolve():r._getProcessManager().setActiveProcessInstance(e).then((function(o){return r._callback(t,i.success,n,a),r.getInstanceId()!==e&&r._reloadPage(n,r._getProcessManager().getCurrentFormEntity(),o,e),Promise.resolve()})).catch((function(e){return r._callback(t,i.invalid,n,a),Promise.reject(e)}))}),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.getEnabledProcesses=function(e){var t=this,r="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(b.a.instance.reportCall(r),!Object(w.d)(T.getState(),this._pageId,r,!0))return void b.a.instance.reportSuccess(r);var n=T.getState();if(Object(F.g)(n)&&Object(x.w)(n)&&!Object(A.b)(n)){var a={};return void("function"==typeof e&&Object(l.c)(r,[],(function(){e(a)})))}this._getProcessManager().getEnabledProcesses().then((function(t){var n={};t&&t.length>0&&t.forEach((function(e){n[e.workflowId]=e.name})),"function"==typeof e&&Object(l.c)(r,[],(function(){e(n)})),b.a.instance.reportSuccess(r)})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,e,r+".getEnabledProcesses",n)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,i),e}},e.prototype.switchProcess=function(){var e="ClientApi.XrmProcessControlData.switchProcess";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e)||Object(k.g)(T.getState()))return;this._getProcessManager().switchProcess(),b.a.instance.reportSuccess(e)}catch(r){var t=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,r,null,t),r}},e.prototype.abandonProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.abandonProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t)||Object(D.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".abandonProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.reactivateProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t)||Object(D.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".reactivateProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.completeProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.completeProcess";try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t)||Object(D.m)(T.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(r){var n=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(T,r,t+".completeProcess",n)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getActiveStage=function(){var e="ClientApi.XrmProcessControlData.getActiveStage";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getActiveStage(),r=null;return t&&(r=new O(T,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),b.a.instance.reportSuccess(e),r}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getActivePath=function(){var e=this,t="ClientApi.XrmProcessControlData.getActivePath";try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return b.a.instance.reportSuccess(t),null;var r=this._getProcessManager().getActivePathStages(),n=null;if(r){var a=this._getProcessManager().getActiveStageId(),i=new y.a(t);r.forEach((function(t){var r=t.get_parent().get_EntityLogicalName();i.add(t.get_stageId(),new O(T,t,r,a,e._getProcessManager()))})),n=i}return b.a.instance.reportSuccess(t),n}catch(e){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,o),e}},e.prototype.setActiveStage=function(e,t){var r=this,n="ClientApi.XrmProcessControlData.setActiveStage";try{if(b.a.instance.reportCall(n),this._entity.getIsDirty()||Object(D.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(n),this._callback(t,j.a.dirtyForm,n);else{if(!Object(w.d)(T.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then((function(){r._callback(t,r._getStageInvalidReason(null),n),r._loadActiveStageEntity(n),b.a.instance.reportSuccess(n)})).catch((function(e){r._callback(t,e?r._getStageInvalidReason(e):P.a.invalid,n)}))}}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,a),e}},e.prototype.moveNext=function(e){var t=this,r="ClientApi.XrmProcessControlData.moveNext";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(D.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(w.d)(T.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(this._getProcessManager().isCrossEntityNavigation(!0))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToNextStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),b.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,a,r),a===j.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,n,r+".moveToNextStage",i)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.movePrevious=function(e){var t=this,r="ClientApi.XrmProcessControlData.movePrevious";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(D.m)(T.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(e,j.a.dirtyForm,r);else{if(!Object(w.d)(T.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(Object(k.g)(T.getState())&&this._getProcessManager().isCrossEntityNavigation(!1))return this._callback(e,j.a.crossEntity,r),void b.a.instance.reportSuccess(r);this._getProcessManager().moveToPreviousStage().then((function(){t._callback(e,t._getNavigationStatus(null),r),t._loadActiveStageEntity(r),b.a.instance.reportSuccess(r)})).catch((function(n){var a=n?t._getNavigationStatus(n):j.a.invalid;if(t._callback(e,a,r),a===j.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(T,n,r+".moveToPreviousStage",i)}b.a.instance.reportSuccess(r)}))}}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,n),e}},e.prototype.getSelectedStage=function(){var e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(b.a.instance.reportCall(e),!Object(w.d)(T.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getSelectedStage(),r=null;if(t){var n=this._getProcessManager().getActiveStageId();r=new O(T,t,this._getProcessManager().getCurrentFormEntity().etn,n,this._getProcessManager())}return b.a.instance.reportSuccess(e),r}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.addOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.q)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.j)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.L)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.E)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.r)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.M)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.k)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.addOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.i)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.F)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(w.d)(T.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);T.dispatch(Object(C.D)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype._getStageInvalidReason=function(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success},e.prototype._getNavigationStatus=function(e){return e?e.navigationStatus||j.a.invalid:j.a.success},e.prototype._convertToXrmProcessInstanceStatus=function(e){if(e){if(e===p.a.Active)return I.a.active;if(e===p.a.Finished)return I.a.finished;if(e===p.a.Aborted)return I.a.aborted}return null},e.prototype._callback=function(e,t,r,n){var a=r+".Callback";n||(n=m.a.getInstance().getEventParameters(this._contextToken)),n.push({name:"Status",value:t}),Object(l.c)(a,n,(function(){"function"==typeof e&&e(t)}))},e.prototype._reloadPage=function(e,t,r,n){if(t){var a=Object(D.m)(T.getState(),this._pageId),i={entityTypeName:t.etn,id:a?void 0:t.id,processId:r,processInstanceId:n};T.dispatch(Object(R.a)(L.a,i,this._pageId,{target:"inline"})).then((function(t){if(0!==t.status)return Object(f.d)(T,t.error,e+".navigateTo.INavigationFailure")})).catch((function(t){return Object(f.d)(T,t,e+".navigateTo.")}))}},e.prototype._loadActiveStageEntity=function(e){var t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(w.c)(this._processManager,T,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager},e}(),V=r("UGbr"),G=r("TCDU"),U=r("UOiB"),z=r("/j9Z"),q=r("9qYn"),X=r("ObKm"),W=r("/lKk"),H=r("gk6Q"),Q=r("vqdi"),Y=r("Gemh"),K=function(){function e(e,t,r,n,a){this._entity=null;var i="ClientApi.XrmFormData.constructor";e||Object(f.j)(i,"store"),r||Object(f.j)(i,"pageId"),t||Object(f.j)(i,"contextToken"),n||Object(f.j)(i,"formContext"),E=e,this._pageId=r,this._formContext=n,this._contextToken=t,this._entity=a}return Object.defineProperty(e.prototype,"entity",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"process",{get:function(){var e="ClientApi.XrmFormData.process_get";try{var t=Object(k.f)(E.getState());b.a.instance.reportCall(e);var r=!!this._process;if((!t&&!this._process||t)&&this._entity){var n=Object(D.g)(E.getState(),this._pageId),a=Object(H.b)(this._pageId,n);this._entity&&(this._process=new B(E,this._contextToken,this._pageId,this.entity,a))}b.a.instance.reportSuccess(e);var i=Object(w.a)(this._pageId,E.getState(),r,!!this._entity);return N.a.getInstance().eventManager.ReportComponentSuccess(e,i),this._process}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},set:function(e){var t=Object(w.a)(this._pageId,E.getState(),!!this._process,!!this._entity);N.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e},enumerable:!1,configurable:!0}),e.prototype.getEntity=function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity},e.prototype.getIsDirty=function(){var e,t,r,n="ClientApi.XrmFormData.getIsDirty";try{b.a.instance.reportCall(n);var a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(var i=0;i<this.attributes.getLength();i++){var o=this.attributes.get(i);if("never"!==o.getSubmitMode()&&o.getIsDirty()){a=!0;break}}if(!a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(i=0;i<this._formContext.ui.controls.getLength();i++){var s=this._formContext.ui.controls.get(i);if("formcomponent"===s.getControlType()&&s.isLoaded()&&(null===(r=s.data)||void 0===r?void 0:r.getIsDirty())){a=!0;break}}}return b.a.instance.reportSuccess(n),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},Object.defineProperty(e.prototype,"attributes",{get:function(){var e="ClientApi.XrmFormData.attributes";try{if(b.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new y.a(e);var t=Object(s.Oc)(E.getState(),this._pageId);if(t)for(var r in t){var n=t[r],a=r,i=Object(c.b)(E,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,n);this._unboundAttributes.add(i.getName(),i)}}return b.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},enumerable:!1,configurable:!0}),e.prototype._refreshEntity=function(e){var t=this;return this.entity.refresh().then((function(){Object(V.d)(E.dispatch,t._contextToken,t._pageId),e&&E.dispatch(Object(C.Q)(t._contextToken,t._pageId,3,t.entity)),Object(q.b)(t.entity)}))},e.prototype.refresh=function(e){var t=this,r="ClientApi.XrmFormData.refresh";try{if(b.a.instance.reportCall(r),this.entity){var n=Object(s.kb)(E.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then((function(e){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".save",n)})):!n&&this.entity.getIsDirty()?E.dispatch(Object(G.a)(this._pageId)).then((function(e){if(e)return t._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges.refreshEntity",n)}))})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges",n)})):this._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(r),{}})).catch((function(e){var n=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,r+".handleUnsavedChanges.refreshEntity",n)}))}var a=new z.a("Refresh action cannot be executed since form entity is null",2147746581);return N.a.getInstance().traceManager.getTracer(r).info("Refreshing on a non entity page"),Object(f.d)(E,a,r+".entity")}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);return Object(f.d)(E,e,r,i)}},e.prototype.save=function(e){var t=this,r="ClientApi.XrmFormData.save",n=m.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){var a=new z.a("Save action cannot be executed since form entity is null",2147746581);return Object(f.d)(E,a,r+".entity")}try{b.a.instance.reportCall(r);var i=1;return e&&e.saveMode&&(i=e.saveMode),J(this._pageId,E,i,n,this._contextToken,this.entity,!0,!0).then((function(e){if(e){var a={entityType:e.etn,id:o.a.toString(e.id),name:e.name};return Object(s.Kb)(E.getState(),t._pageId)?(b.a.instance.reportSuccess(r),{savedEntityReference:a}):t._refreshEntity(!1).then((function(){return b.a.instance.reportSuccess(r),{savedEntityReference:a}})).catch((function(e){return Object(f.d)(E,e,r+".refresh",n)}))}if(Object(s.kb)(E.getState(),{id:t._pageId},t._contextToken)||!t.entity.getIsDirty()){var i=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),{savedEntityReference:i}}var c=new z.a("Save action was not executed and the form is dirty.",2147879192);return Object(f.d)(E,c,r+".NoReference",null,!1)})).catch((function(e){if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){var a=t.entity.getEntityReference();return b.a.instance.reportSuccess(r),Promise.resolve({savedEntityReference:a})}return Object(f.d)(E,e,r,n)}))}catch(e){return Object(f.d)(E,e,r,n)}},e.prototype.isValid=function(){var e,t,r,n="ClientApi.XrmFormData.isValid";try{b.a.instance.reportCall(n);var a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(var i=0;i<this.attributes.getLength();i++)if(!this.attributes.get(i).isValid()){a=!1;break}if(a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(var o=0;o<this._formContext.ui.controls.getLength();o++){var s=this._formContext.ui.controls.get(o);if("formcomponent"===s.getControlType()&&s.isLoaded()&&!(null===(r=s.data)||void 0===r?void 0:r.isValid())){a=!1;break}}return a||E.dispatch(Object(X.b)(this._pageId,this._contextToken)),b.a.instance.reportSuccess(n),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,c),e}},e.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormData.addOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),E.dispatch(Object(C.c)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormData.removeOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),E.dispatch(Object(C.x)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,r),e}},e}();function J(e,t,r,n,a,i,c,l){var u=t.getState(),d=o.a.tryParseOrNull(i.getId());if(a.contextTokenType===U.a.GridRow){var p=[],h=Object(Y.T)(u,e,a.parentContextToken,a.parentContextToken.controlName);return i.attributes.forEach((function(e){return p.push(e.getName())})),n.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(Q.a)(e,i.getEntityName(),null==d?void 0:d.guid,null,p,null==h?void 0:h.guid,!1,a.parentContextToken))}if(Object(s.Kb)(u,e))return n.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(W.a)(e));if(d&&!o.a.equals(d,o.a.EMPTY))return n.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(V.e)(e,r));var g=Object(D.l)(t.getState(),e);return n.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(V.f)(e,g,l,r,!1,c))}},"Wye+":function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var n=r("Gemh"),a=r("Nhrb");var i=r("/j9Z"),o=r("9r0m"),s=r("G7N+"),c=r("olrR"),l=r("RlP9"),u=r("r2h9"),d=r("8Fmj"),p=r("cqI9"),h=r("7dGM"),g=r("lMVv"),m=r("JlqV"),f=r("z9yS"),b=r("uO/V"),v=r("Yc9S"),y=r("0rak");var _=r("zETL"),O=r("3IUl"),S=r("bc+P"),C=r("xm8q"),I=r("okRr"),j=r("U/bH"),P=r("cZkS"),T=r("qC0c"),E=r("VcAV");function w(e,t,r,w,x,A){return{type:"grid.refresh.async",execute:function(N,D){var k=N.dispatch,M=N.getState,R=D.TraceManager.getTracer(b.z),L=b.x+".refreshGridAction";try{var B=M(),V=o.a.tryParseOrNull(w);if(V){var G=A||(r?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,r,a,d,p,h,g){var f=Object(n.qb)(t,g,r);if(f&&f.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(f.offlineSqlQuery)))return Promise.resolve(g);var b=p||Object(n.F)(t,r,a,d),v=Object(l.f)(t,b,h),y=Object(l.f)(t,b,u.a.MAIN_APPLICATION_VIEW),_=v&&v[o.a.toString(g)]&&v[o.a.toString(g)].isUserView?u.b.userview:u.b.savedview;y&&y[o.a.toString(g)]&&y[o.a.toString(g)].isUserView&&(_=u.b.userview);return e(Object(c.a)(b,h,_,g)).then((function(e){if(!e)throw new i.a("View retrieval failed");return e}))}(k,B,e,t,r,x,G,V).then((function(i){R.info("Refreshing the grid with new view id - {0}"+V);var c=Object(n.T)(B,e,t);k(function(e,t,r,n){return Object(a.b)(e,t,"ViewId",r,n)}(e,r,w,t)),function(e,t,r,a,i,c,u,d,p){var h=function(e,t,r,a,i){return e||Object(n.F)(t,r,a,i)}(r,e,i,c,u),g=Object(n.qb)(e,a,i);if(g&&g.initialized===s.a.Initialized){var m=Object(l.f)(e,h,d),f=m&&m[o.a.toString(a)]&&m[o.a.toString(a)].isUserView;if(h===b.a&&(h=g.entityLogicalName?g.entityLogicalName:h),!g.title){var v=[];v.push({name:"view.title",value:"View title doesn't contains value"}),v.push({name:"ViewId",value:"ViewId: "+a}),v.push({name:"View",value:F(g)}),v.push({name:"entityTypeName",value:h}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",v)}var y={RecordType:I.a.Grid,EntityTypeName:h,LastAccessed:new Date,ObjectId:a,IsUserView:f,Title:g.title};t(Object(C.b)(y))}}(M(),k,x,i,e,t,r,G,D),Object(T.c)(M(),P.L)&&k(Object(j.b)(e,t)),x&&k(function(e,t,r,n){return Object(a.b)(e,t,"TargetEntityType",r,n)}(e,r,x,t)),k(Object(_.b)(e,t)),k(Object(O.b)(e,t,[])),k(Object(S.b)(e,t,null));var E=[];if(x&&E.push({name:"entityName",value:x}),!Object(n.ib)(B,e,t))return D.EventManager.ReportComponentSuccess(L,E),Promise.resolve();k(function(e,t,r,a,i,s){return{type:"chart.refresh.async",execute:function(c,_){var O=c.dispatch,S=c.getState,C=b.x+".refreshChartAction",I=S();if(!r)return Promise.resolve();if(!Object(m.b)(I))return Promise.resolve();var j=Object(l.c)(I,r);if(!(i=j&&j.entityLogicalName?j.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(O(Object(y.c)(e,t,[])),O(Object(v.c)(e,t,"{}"))),!o.a.equals(a,r)){O(Object(y.c)(e,t,[])),O(Object(v.c)(e,t,"{}"));var P=Object(n.r)(I,e,t,i),T=Object(h.a)(I,P),E=T&&T.PrimaryEntityTypeCode,w=E&&Object(g.m)(I,parseInt(E,10));if(w&&i!==w)return O(Object(d.a)(i,f.a.savedvisualization)).then((function(r){var n=o.a.toString(r);return n||(n=o.a.EMPTYGUIDSTRING),O(Object(p.b)(e,t,n)).then((function(){_.EventManager.ReportComponentSuccess(C)}))}))}return _.EventManager.ReportComponentSuccess(C),Promise.resolve()}}}(e,t,V,c,x,A)).then((function(){return k(Object(_.b)(e,t)),D.EventManager.ReportComponentSuccess(L,E),Promise.resolve()})).catch((function(e){return D.EventManager.ReportComponentFailure(L,Error(e)),Promise.resolve()}))}))}if(Object(n.v)(M(),e,t)){R.info("Refreshing the grid."),k(Object(_.b)(e,t)),k(Object(O.b)(e,t,[])),k(Object(S.b)(e,t,null));var U=[];x&&U.push({name:"entityName",value:x}),D.EventManager.ReportComponentSuccess(L,U)}return Promise.resolve()}catch(e){var z="Refresh action for grid failed";e&&e.message&&(z+="with the error message as : "+e.message),D.EventManager.ReportComponentFailure(L,Error(z))}}}}function F(e){if(!e)return"View is "+e;var t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},XJ3n:function(e,t,r){"use strict";r.d(t,"a",(function(){return y}));var n,a=r("fW82"),i=r("9r0m"),o=r("+Z9T"),s=r("BWVO"),c=r("WVwd"),l=r("/zIU"),u=r("GueY"),d=r("Gemh"),p=r("IiPO"),h=r("mPpC"),g=r("ks02"),m=r("FoZz"),f=r("sOTk"),b=r("gLMt"),v=r("ezfI"),y=function(){function e(e,t,r,a,i,s){var c="ClientApi.XrmGridRow.constructor";e||Object(o.j)(c,"store"),a||Object(o.j)(c,"pageId"),r||Object(o.j)(c,"contextToken"),i||Object(o.j)(c,"entityType"),s||Object(o.j)(c,"entityId"),n=e,this._applicationContext=t,this._pageId=a,this._contextToken=r,this._entityType=i,this._entityId=s}return Object.defineProperty(e.prototype,"applicationContext",{get:function(){return v.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e="ClientApi.XrmGridRow.context";try{return v.a.instance.reportCall(e),this._globalContext||(this._globalContext=new g.a(n,this._pageId)),v.a.instance.reportSuccess(e),this._globalContext}catch(r){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(e,r,null,t),r}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var e=this,t="ClientApi.XrmGridRow.data";try{if(v.a.instance.reportCall(t),!this._data){var r=new s.a(n,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new c.a(n,this._contextToken,this._pageId,this,r);var a=new h.b(n,this._pageId),o=[],l={isEventParam:!0,name:"attributeName",value:""};o.push(l),r.attributes.forEach((function(r){var n=r.getName();l.value=n;var s={Id:n,Label:null,Name:n,ShowLabel:!1,Visible:!0,ClassId:new i.a(h.a),Disabled:!1,DataFieldName:n},c=a.createXrmControl(e._contextToken,s,e,t,o);c&&r.controls.add(c.getName(),c)}))}return v.a.instance.reportSuccess(t),this._data}catch(e){var u=p.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,u),e}},enumerable:!1,configurable:!0}),e.prototype.getData=function(){try{return v.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}},Object.defineProperty(e.prototype,"ui",{get:function(){try{if(v.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){var e=new h.b(n,this._pageId);this._ui=new u.a(n,this._contextToken,this._pageId,this,this._entityType,e)}return v.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t="ClientApi.XrmGridRow.getControl";try{v.a.instance.reportCall(t);var r=this.ui.controls.get(e);return v.a.instance.reportSuccess(t),r}catch(e){var n=p.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getAttribute=function(e){var t="ClientApi.XrmGridRow.getAttribute";try{if(v.a.instance.reportCall(t),this.data.entity){var r=this.data.entity.attributes.get(e);return v.a.instance.reportSuccess(t),r}return v.a.instance.reportSuccess(t),null}catch(e){var n=p.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridRow.getUrl";try{v.a.instance.reportCall(t);var r=this.data.entity.getEntityReference();this._internal=new m.a(n,this._applicationContext,this.context,this._pageId);var o=Object(f.g)(n.getState(),this._pageId),s={entityTypeName:r.entityType,etn:r.name,id:i.a.fromExternalGuid(r.id),entityTypeCode:this._internal.getEntityCode(r.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:o.recordSetQueryKey};if(1===e){var c=n.dispatch(Object(a.a)(l.a.EditForm,s));return v.a.instance.reportSuccess(t),c}var u=Object(b.a)(n,this._pageId),d=n.dispatch(Object(a.c)(u,l.a.EditForm,s));return v.a.instance.reportSuccess(t),d}catch(e){var h=p.a.getInstance().getEventParameters(this._contextToken);throw h.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,h),e}},Object.defineProperty(e.prototype,"entityReference",{get:function(){try{return this.data.entity.getEntityReference()}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}},enumerable:!1,configurable:!0}),e}();function _(e,t,r){var a=Object(d.D)(n.getState(),{id:r},t.parentContextToken);return a||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},XjtF:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,a,i,o=r("EGsq"),s=r("cL6R"),c=r("KVkm"),l=r("WACO"),u=r("JlqV"),d=["JQUERY","JQUERY.JS"];function p(e){return{type:"customcontrol.loadresources",execute:function(t,r){var p=t.dispatch,h=t.getState,g=[],m=h(),f=Object(o.t)(m),b=e.Properties.Resources.filter((function(e,t,n){return(0===e.Type||4===e.Type||1===e.Type)&&!(e.LibraryName&&-1!==d.indexOf(e.LibraryName.toUpperCase())||r.AssetLoader.isResourceLoaded(f+e.Name))})).sort((function(e,t){return e.LoadOrder-t.LoadOrder})),v=e.Properties.Resources.filter((function(e,t,r){return 5===e.Type}));if(b.length>0){var y=void 0,_=function(){return function(e,t,r,a,i){for(var o=[],s=0;s<i.length;s++){var l=i[s],u=void 0,d=l.Name,p=r;if(n&&n[l.Name])p=window.__public_path__+"control",d=n[l.Name];else if(0===l.Type){var h=l.LibraryName+".js";n&&n[h]&&(p=window.__public_path__+"control",d=n[h])}switch(l.Type){case 0:case 4:u=a.loadWebResource(d,p,3,(function(t){return e(Object(c.a)(t))}),t,!1);break;case 1:u=u=a.loadWebResource(d,p,2,(function(t){return e(Object(c.a)(t))}),t);break;default:u=null}u&&o.push(u)}return Promise.all(o)}(p,!Object(u.b)(m),f,r.AssetLoader,b)};(y=!function(){null==i&&(i=window.location.search.toLocaleLowerCase().indexOf("uselocal=true")>=0);return i}()||n?_():function(){if(a)return a;if("/uclient/"!==window.__public_path__){if(!n){var e=window.__public_path__+"controlFileMap.json";(a=-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?new Promise((function(t){var r=new XMLHttpRequest;r.addEventListener("load",(function(){var e={};try{e=JSON.parse(this.responseText)}catch(e){}t(e)})),r.addEventListener("error",(function(){t({})})),r.open("GET",e),r.send()})):fetch(e).then((function(e){return e.json()}),(function(){return Promise.resolve({})}))).then((function(e){n=e}),(function(){n={}}))}}else n={},a=Promise.resolve({});return a}().then(_,_))&&g.push(y)}for(var O=Object(l.k)(m),S=function(e){if(!O||!O.hasOwnProperty(v[e].Name)){var t=p(Object(s.c)(v[e].Name)).then((function(t){for(var r=!1,n=0,a=t;n<a.length;n++){var i=a[n];i&&i.webResourceDescriptorsByName&&i.webResourceDescriptorsByName.hasOwnProperty(v[e].Name)&&(r=!0)}!r&&p(Object(s.b)(v[e].Name))}));g.push(t)}},C=0;C<v.length;C++)S(C);return g.length>0?Promise.all(g):null},sync:!0}}},"Y+r4":function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n,a,i=r("c/eZ"),o=r("1z64"),s=r("fW82"),c=r("sOTk"),l=r("BWVO"),u=r("WVwd"),d=r("ezfI"),p=r("/zIU"),h=r("GueY"),g=r("HSdq"),m=r("3NtJ"),f=r("fTYK"),b=r("+Z9T"),v=r("IiPO"),y=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(i.__extends)(t,e),t.prototype.getDefaultNextPageName=function(){var e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{d.a.instance.reportCall(e);var t=Object(g.M)(n.getState(),this.pageId,this.contextToken);return d.a.instance.reportSuccess(e),t}catch(t){var r=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.movePrevious=function(){var e="ClientApi.XrmNavigableFormUi.movePrevious";try{d.a.instance.reportCall(e),n.dispatch(Object(f.b)(this.pageId,this.contextToken)),d.a.instance.reportSuccess(e)}catch(r){var t=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.moveTo=function(e){var t,r="ClientApi.XrmNavigableFormUi.moveTo";try{if(d.a.instance.reportCall(r),e&&this.tabs){var a=Object(g.Gc)(n.getState(),this.pageId,e,this.contextToken);(t=this.tabs.get(null==a?void 0:a.Name))&&n.dispatch(Object(m.b)(this.pageId,this.contextToken,null==a?void 0:a.Id))}d.a.instance.reportSuccess(r)}catch(e){var i=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(r,e,null,i),e}t||Object(b.h)(r,"pageName",e)},Object.defineProperty(t.prototype,"taskProcess",{get:function(){return d.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this},enumerable:!1,configurable:!0}),t}(h.a),_=r("9r0m"),O=r("FoZz"),S=r("gLMt"),C=r("ZOZo"),I=r("WS0f"),j=function(e){function t(t,r,n,i,s){var c=this,l=[{name:"pageId",value:s,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return(c=e.call(this,t,r&&r.etn,i,s,(function(e){return 10===e||12===e?y:h.a}),n)||this)._clientApiExecutorForm=new o.a(t,"ClientApi.XrmForm.",s,i,l),a=t,c._entityReference=r,c}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"applicationContext",{get:function(){return this._applicationContext},set:function(e){this._applicationContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){try{return d.a.instance.reportCall("ClientApi.XrmForm.context"),d.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}},set:function(e){this._globalContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){var e=this;return this._clientApiExecutorForm.execute("entityReference_get",(function(){return{id:_.a.externalGuid(e._entityReference.id),entityType:e._entityReference.etn}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){try{if(d.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){var e=void 0,t=Object(c.l)(a.getState(),this.pageId);t!==p.a.Dialog&&t!==p.a.ModalDialog&&this._entityReference&&(e=new l.a(a,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,P,this._applicationContext)),this._data=new u.a(a,this.contextToken,this.pageId,this,e)}return d.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}},enumerable:!1,configurable:!0}),t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutorForm.execute("getAttribute",(function(){var r,n,a=null;return t.data&&t.data.entity&&(a=t.data.entity.attributes.get(e)),a?Object(I.a)(e)&&(a=a.concat(t.data.attributes.get(e))):a=null===(n=null===(r=t.data)||void 0===r?void 0:r.attributes)||void 0===n?void 0:n.get(e),a}))},t.prototype.getUrl=function(e){try{d.a.instance.reportCall("ClientApi.XrmForm.getUrl");var t=null,r=null;if(this.contextToken.parentContextToken){var n=this.data.entity.getEntityReference(),i={entityTypeName:n.entityType,etn:n.name,id:_.a.fromExternalGuid(n.id)};t=p.a.EditForm,r=i}else t=Object(c.l)(a.getState(),this.pageId),r=Object(c.g)(a.getState(),this.pageId);switch(t){case p.a.EditForm:var o=new O.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,etn:r.etn,id:r.id,entityTypeCode:o.getEntityCode(r.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:r.recordSetQueryKey};break;case p.a.Grid:o=new O.a(a,this.applicationContext,this.context,this.pageId);r={entityTypeName:r.entityTypeName,pageType:r.pageType,entityTypeCode:o.getEntityCode(r.entityTypeName)}}var l=null;if(1===e)l=a.dispatch(Object(s.a)(t,r));else{var u=Object(S.a)(a,this.pageId);l=a.dispatch(Object(s.c)(u,t,r))}return d.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),l}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}},t.prototype._reportFailure=function(e,t){var r=v.a.getInstance().getEventParameters(this.contextToken);return r.push({name:"entityName",value:this._entityReference.etn}),v.a.getInstance().reportFailure(e,t,null,r),t},t}(C.a);function P(e,t,r){var n=Object(g.bb)(a.getState(),r,t);return n||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),n}},YOvo:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.visibility";function a(e,t,r){return{type:n,payload:{show:r},meta:{pageId:e,navigationItemId:t}}}},Yc9S:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return s}));var n=r("Sscr"),a=r("uO/V"),i="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,r){return{type:"chart.filterexpression.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(a.z),p=a.x+".updateFilterExpressionAction";try{d.info("Updating the chart filter expression"),t||(t=Object(n.k)(u(),e));var h=Object(n.v)(t);return l(function(e,t,r){return{type:i,payload:{name:o,value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,h,r)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var g="Updatation of the chart filter expression failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(g))}}}}},YdIa:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.targets.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},ZOZo:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a=r("h82J"),i=r("HSdq"),o=r("1z64"),s=function(){function e(e,t,r,i,s,c){this._clientApiExecutor=new o.a(e,"ClientApi.XrmFormBase.",i,r,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:r,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),n=e,this.pageId=i,this.contextToken=r,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,n.dispatch(Object(a.a)(this,i,r))}return Object.defineProperty(e.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ui_get",(function(){if(!e._ui){var t={id:e.pageId},r=Object(i.fb)(n.getState(),t,e.contextToken),a=r&&r.FormType,o=e._getUiType(a);e._ui=new o(n,e.contextToken,e.pageId,e,e._entityName,e._xrmControlFactory)}return e._ui}))},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t=this,r=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",(function(){return t.ui.controls.get(e)}),r)},e}()},Zdrd:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationtype.update";function o(e,t,r){return{type:"chart.visualizationtype.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(a.z),d=a.x+".updateVisualizationTypeAction";try{u.info("Update the chart visualization type"),t||(t=Object(n.k)(l(),e));var p=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"chartVisualizationType",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,p,r)),s.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var h="Update the chart visualization type failed with error : "+e.message;s.EventManager.ReportComponentFailure(d,Error(h))}}}}},aBa1:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("c/eZ"),a=r("AhDg"),i=r("9r0m"),o=r("lMVv"),s=r("gBKR"),c=r("7pqb"),l=r("t8f4"),u=r("r0s4"),d=c.b.AdvancedFindLookupResolverParameters;function p(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.async",execute:function(u,p,h){var m=u.dispatch,f=u.getState,b=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:d.PrimaryEntity,value:e},{name:d.Targets,value:t.join(",")});var v=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(v)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:d.EntityMetadataUnavailable,value:i}),a;var c='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or"><condition attribute="'+s.PrimaryNameAttribute+'" operator="like" value="%'+(t||"")+'%" /></filter></entity></fetch>',l=g(e,s,c,n);return a.push(l),a}}(m,r,f(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function h(e,t,r){var l=[];return{type:"advancedFind.lookup.retrieve.by.id.async",execute:function(u,p,h){var m=u.dispatch,f=u.getState,b=new a.a(i.a.newGuid().guid,h&&h.isPreloadCall);l.push({name:c.b.ActionType,value:"advancedFind.lookup.retrieve.async"},{name:c.b.ClientRequestId,value:b.RequestId()},{name:d.PrimaryEntity,value:e},{name:d.Targets,value:t.join(",")});var v=t.reduce((function(e,t){var r;return Object(n.__assign)(Object(n.__assign)({},e),((r={})[t]=[],r))}),{});return m(Object(s.e)(v)).then((function(){var e=function(e,t,r,n){return function(a,i){var s=Object(o.h)(r,i);if(!s||!s.EntityLogicalName||!s.PrimaryNameAttribute)return n.push({name:d.EntityMetadataUnavailable,value:i}),a;var c=t.filter((function(e){return!!e})).map((function(e){return'<condition attribute="'+s.PrimaryIdAttribute+'" operator="eq" value="'+e+'" />'})),l='<fetch version="1.0" mapping="logical" no-lock="false"><entity name="'+s.EntityLogicalName+'"><attribute name="'+s.PrimaryNameAttribute+'"/><attribute name="'+s.PrimaryIdAttribute+'"/><order attribute="'+s.PrimaryNameAttribute+'" descending="false" /><filter type="or">'+c+"</filter></entity></fetch>",u=g(e,s,l,n);return a.push(u),a}}(m,r,f(),l),n=t.reduce(e,[]);return Promise.all(n).then((function(e){return Promise.resolve([].concat.apply([],e))}))}))},getSuccessParameters:function(){return l},getFailureParameters:function(e,t){return l}}}function g(e,t,r,n){var a="?fetchXml="+Object(u.CrmUrlEncode)(r);return new Promise((function(r,i){e(Object(l.e)(t.EntityLogicalName,a,100)).then((function(e){var a=function(e,t){var r=[];t.value&&t.value.length>0&&t.value.forEach((function(t){r.push({id:t[e.PrimaryIdAttribute],displayName:t[e.PrimaryNameAttribute],entityLogicalName:(null==e?void 0:e.EntityLogicalName)||void 0,entityDisplayName:(null==e?void 0:e.DisplayName)||void 0})}));return r}(t,e);n.push({name:d.RetrieveRequestSuccess,value:"Retrieve Seccuess for "+t.EntityLogicalName+" Count: "+a.length}),r(a)}),(function(e){n.push({name:d.RetrieveRequestFail,value:"Failed to retrieve records for "+t.EntityLogicalName+" Error: "+e}),r([])}))}))}},bCrZ:function(e,t,r){"use strict";r.d(t,"f",(function(){return m})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return y})),r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return v}));var n=r("c/eZ"),a=r("9r0m"),i=r("Sscr"),o=r("uO/V"),s=r("nn4v"),c=r("Gemh"),l=r("cZkS"),u=r("qC0c"),d=r("U/bH"),p=r("jigW"),h="grid.initialize",g="grid.initialize.xrmready";function m(e,t,r){return{type:"grid.preinitialize.sync",sync:!0,execute:function(n,a){var i=n.dispatch,s=(n.getState,o.x+".gridPreInitializedAction");try{i(b(null,e,t,r,void 0,void 0,void 0,void 0,null));var c=[{name:"entityTypeName",value:e}];return a.EventManager.ReportComponentSuccess(s,c),Promise.resolve(void 0)}catch(t){var l="Failed for "+e+" with error "+t.message;return a.EventManager.ReportComponentFailure(s,Error(l)),Promise.resolve(void 0)}}}}function f(e,t,r,a,i,p,h,g,m){return e?{type:"grid.initialize.async",execute:function(f,v){var y=f.dispatch,_=f.getState,O=o.x+".gridInitializedAction";try{var S=null;Object(u.c)(_(),l.zb)&&(S=function(e,t,r){var a=Object(c.v)(e,t,r),i=Object(n.__assign)({},s.a);return a&&(a.filters&&(i.filters=a.filters),a.customFilter&&(i.customFilter=a.customFilter),a.pageNumber&&(i.pageNumber=a.pageNumber),a.pagingRefreshInput&&(i.pagingRefreshInput=a.pagingRefreshInput)),i}(_(),r,a)),y(b(e,t,r,a,i,p,h,g,S,m));var C=[];return C.push({name:"entityTypeName",value:t}),v.EventManager.ReportComponentSuccess(O,C),Object(u.c)(_(),l.L)&&y(Object(d.b)(r,a)),Promise.resolve(void 0)}catch(e){var I="Grid initialized failed for entity type "+t;return v.EventManager.ReportComponentFailure(O,Error(I)),Promise.reject(void 0)}}}:null}function b(e,t,r,c,l,u,d,g,m,f){var b=l&&l.Parameters?l.Parameters[o.j]:null;try{var v=!0;b&&(v="true"===b);var y=Object(i.u)(c),_={contextKey:y,initialDataSetState:Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},s.a),m),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:u,relationshipRoleOrdinal:d,useRollupView:g||!1,commandManagerId:f||Object(p.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:e&&e.viewId?a.a.toString(e.viewId):null},1:{Name:o.j,Value:v},2:{Name:o.u,Value:t}}}}})};return{type:h,payload:_,meta:{pageId:r,contextKey:y}}}catch(e){throw Error(e)}}function v(e,t,r,c){var l=Object(i.u)(c),u=a.a.tryParseOrNull(t),d={contextKey:l,initialDataSetState:Object(n.__assign)(Object(n.__assign)({},s.a),{viewId:u||null,fetchXml:null,commandManagerId:Object(p.d)(r,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:t||null},1:{Name:o.j,Value:!1},2:{Name:o.u,Value:e}}}}})};return{type:h,payload:d,meta:{pageId:r,contextKey:l}}}function y(e,t,r,n){return t(e.ScriptManager.getContainer(n).getEventManager().loadGridScripts(r,n))}},bH46:function(e,t,r){"use strict";r.d(t,"c",(function(){return p})),r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return h}));var n=r("9r0m"),a=r("vYfn"),i=r("i8/j"),o=r("F2uj"),s=r("gBKR"),c=r("VWqI"),l=r("j6Db"),u=r("+Xnp"),d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,r){return{type:"formandattribute.retrieve.async",execute:function(c,u){var p=c.dispatch,m=c.getState,f="Card"===r;return e.etn&&"activitypointer"===e.etn&&f?p(Object(s.f)("activitypointer",!1,d)).then((function(){for(var t=m(),r={},n=0,a=d;n<a.length;n++){var i=a[n],s=Object(o.a)(t,e.etn,i);s&&h(t,e.etn,i,s)&&(r[i]=s)}return g(t,e.etn,r,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:r}})):p(Object(a.b)(e,t,r)).then((function(a){var c={},d=null;return e.etn?p(Object(s.f)(e.etn,!0,[])).then((function(){var t=m();if(!n.a.isNullOrEmpty(a)&&(d=Object(i.j)(t,a))&&d.Attributes)for(var r in d.Attributes){var s=d.Attributes[r],l=Object(o.a)(t,e.etn,s);l&&h(t,e.etn,s,l)&&(c[s]=l)}return f&&g(t,e.etn,c,Object(o.d)(t,e.etn)),{formDescriptor:d,attributeDescriptors:c}})):(u.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}]),null)}),(function(e){var a=e.get_message();u.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:n.a.toString(t)},{name:"formType",value:r}])}))}}}function h(e,t,r,n){return Object(c.f)(e,t,r,u.a.CanRead)&&n&&n.IsValidForRead}function g(e,t,r,n){if(n)for(var a in n){var i=n[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||r[a]||!h(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(r[a]=i)}}},bJYk:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("9r0m"),a=r("sOTk"),i=r("Z1aD"),o=r("KQ+A"),s=r("t8f4"),c=r("QAhb"),l=r("lMVv"),u=r("WS0f"),d=r("riBC"),p=r("7EJx"),h=r("JlqV"),g=r("HSdq"),m=r("YEEA");function f(e,t,r,c){var f=[{name:"formId",value:e},{name:"pageName",value:r}];return{type:"form.change",execute:function(v,y,_){var O=v.dispatch,S=v.getState,C=S();if(Object(g.Eb)(C,t))return Promise.reject(Object(m.b)(C,t,2200000016));var I=Object(a.g)(C,t),j=I.entityTypeName,P=I.id,T=I.recordSetQueryKey,E=I.data,w=I.createFromRelationship,F=I.initWithEntity;f.push({name:"entityTypeName",value:j});var x=n.a.tryParse(e),A={entityTypeName:j,formId:x,id:c?n.a.tryParse(c):P,recordSetQueryKey:T,data:E,createFromRelationship:w,initWithEntity:F},N=x.guid.toString(),D='<MRUForm><Form Type="Main" Id="'+N+'" /></MRUForm>',k=Object(d.c)(C,j);return O(Object(i.a)(r,A,t,{replaceState:!0})).then((function(e){var t,r;if(0===e.status)if(Object(h.b)(S()))null==k||k===n.a.EMPTY?function(e,t,r,a,i,c,d,h){var g=Object(l.p)(a,e),m=Object(p.q)(a),f="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",v=String.format(f,g.toString(),m.guid.toString());i(Object(s.e)("userentityuisettings",v)).then((function(p){p.value&&p.value.length>0&&(r=p.value[0].userentityuisettingsid?new n.a(p.value[0].userentityuisettingsid):n.a.EMPTY),Object(u.a)(r)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r)?null!=r&&r!==n.a.EMPTY||function(e,t,r,a,i,c,d){var p=n.a.EMPTY,h=Object(l.p)(r,e),g="userentityuisettings";a(Object(s.b)(g,{objecttypecode:h,lastviewedformxml:t})).then((function(t){if(p=t,!(Object(u.a)(p)||Object(u.a)(i)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(p))){var r=d.TraceManager.getTracer("Forms.FormSelectorChange"),s="Created an entry for selected form successfully formid : "+i;r.info(s),a(Object(o.b)(e,i,p))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(i)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,i,p)),{};var r=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],n="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(n),void 0,r),d.TraceManager.getTracer("Forms.FormSelectorChange").error(n,r)}))}(e,t,a,i,c,d,h):b(e,t,r,a,i,c,d,h)})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,c,r)),{};var n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),h.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}(j,D,k,S(),O,x,_,y):b(j,D,k,S(),O,x,_,y);else{Object(u.a)(x)||Object(u.a)(j)||0===j.length||O(Object(o.b)(j,x,k));var a=null===(t=null==y?void 0:y.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),i="Selected form did not save in the UserEntityUiSetting table, for formid: "+x;null==a||a.info(i)}else if(1===e.status){a=null===(r=null==y?void 0:y.TraceManager)||void 0===r?void 0:r.getTracer("Forms.FormSelectorChange"),i="Could not change to form with id "+N+" due to a navigation failure or because navigation was cancelled";null==a||a.info(i,f)}return e}))},getFailureParameters:function(e,t){return f}}}function b(e,t,r,a,i,l,d,p){var h=new c.a("userentityuisettings",r);i(Object(s.f)(h,{lastviewedformxml:t})).then((function(){if(!(Object(u.a)(r)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||n.a.isNullOrEmpty(r))){var t=p.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+l;t.info(a),i(Object(o.b)(e,l,r))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,l,r)),{};var n=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),p.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)}))}},"bhC+":function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="form.setSelectedFormId";function a(e,t){return{type:n,payload:{formId:t},meta:{pageId:e}}}},c0jI:function(e,t,r){"use strict";r.d(t,"g",(function(){return _})),r.d(t,"i",(function(){return O})),r.d(t,"h",(function(){return S})),r.d(t,"e",(function(){return C})),r.d(t,"f",(function(){return I})),r.d(t,"a",(function(){return j})),r.d(t,"c",(function(){return T})),r.d(t,"b",(function(){return w})),r.d(t,"d",(function(){return P}));var n=r("c/eZ"),a=r("uO/V"),i=r("Gemh"),o=r("sOTk");function s(e,t,r,n){var a,i;return{type:"update.grid.configuration",payload:((a={})[t]=((i={})[r]=e,i),a),meta:{pageId:n}}}function c(e,t,r){var n;return{type:"update.views.configuration",payload:((n={})[t]=e,n),meta:{pageId:r}}}var l=r("RXRQ"),u=r("U0B9"),d=r("2OIc"),p=r("i8/j"),h=r("9r0m"),g=r("RlP9"),m=r("S2mk"),f=r("T2Xs"),b=r("j6Db"),v=r("OTOS");function y(e,t){var r=Object(n.__assign)({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){var a=!1;for(var i in e.CustomControls)if(j(e.CustomControls[i],e.CustomControls[t])&&i!==t.toString()){a=!0;break}if(!a){var o=-1;r[o]?o--:r[o.toString()]=e.CustomControls[t]}}return r[t]=null,r}function _(e,t,r,a,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p,h){var g,m,v=p.dispatch,y=p.getState,_=y(),O=Object(u.b)(_),S=Object(i.k)(_,e,t),C={UniqueId:S?S.UniqueId:null,CustomControls:(g={},g[O]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:O}),g),FormLibraries:S?S.FormLibraries:null,EventHandlers:S?S.EventHandlers:null},I=Object(o.g)(_,e).entityTypeName;if(d){var j=Object(i.T)(_,e,t);v(c({UniqueId:null,CustomControls:(m={},m[O]=null,m),FormLibraries:null,EventHandlers:null},j.guid,e))}v(Object(l.c)(r.CustomControlId)).then((function(){v(s(C,I,a,e))}),(function(t){var n=Object(f.b)(y(),r.CustomControlId);h.EventManager.ReportComponentFailure(n+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:I},{name:"customControlId",value:r.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:a},{name:"config",value:JSON.stringify(r)}])}))}}}function O(e,t,r,a,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p){var h,m=p.dispatch,f=(0,p.getState)(),b=Object(u.b)(f),v=Object(i.T)(f,e,t),_=Object(g.d)(f,v),O={UniqueId:_?_.UniqueId:null,CustomControls:(h={},h[b]=Object(n.__assign)(Object(n.__assign)({},r),{FormFactor:b}),h),FormLibraries:_?_.FormLibraries:null,EventHandlers:_?_.EventHandlers:null},S=Object(o.g)(f,e).entityTypeName;if(d){var C=Object(i.k)(f,e,t);if(C&&C.CustomControls&&C.CustomControls[b]){var I={UniqueId:C.UniqueId,CustomControls:y(C,b),FormLibraries:C.FormLibraries,EventHandlers:C.EventHandlers};m(s(I,S,a,e))}}m(Object(l.c)(r.CustomControlId)).then((function(){m(c(O,v.guid,e))}))}}}function S(e,t,r){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute:function(a){var i,o=a.dispatch,c=(0,a.getState)(),h=Object(u.b)(c),g=Object(v.b)(c,e),m=Object(p.b)(c,e,g,r),f=Object(d.b)(c,m.UniqueId,g);if(f&&f.CustomControls){var b={UniqueId:m.UniqueId,CustomControls:(i={},i[h]=Object(n.__assign)(Object(n.__assign)({},t),{FormFactor:h}),i),FormLibraries:f.FormLibraries,EventHandlers:f.EventHandlers};o(Object(l.c)(t.CustomControlId)).then((function(){o(s(b,g.guid,f.UniqueId,e))}))}}}}function C(e,t,r,a,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute:function(o){var c,d=o.dispatch,p=(0,o.getState)(),h=Object(u.b)(p),g={UniqueId:i.UniqueId,CustomControls:(c={},c[h]=Object(n.__assign)(Object(n.__assign)({},a),{FormFactor:h}),c),FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};d(Object(l.c)(a.CustomControlId)).then((function(){d(s(g,t,r,e))}))}}}function I(e,t,r,a,i,o,d){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute:function(p){var h,g=p.dispatch,m=(0,p.getState)(),f=Object(u.b)(m),b={UniqueId:o.UniqueId,CustomControls:(h={},h[f]=Object(n.__assign)(Object(n.__assign)({},i),{FormFactor:f}),h),FormLibraries:o.FormLibraries,EventHandlers:o.EventHandlers};if(d&&d.CustomControls&&d.CustomControls[f]){var v={UniqueId:d.UniqueId,CustomControls:y(d,f),FormLibraries:d.FormLibraries,EventHandlers:d.EventHandlers};g(s(v,t,r,e))}g(Object(l.c)(i.CustomControlId)).then((function(){g(c(b,a.guid,e))}))}}}function j(e,t){if(e&&t){var r=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,r){var n,a;if(t&&r&&t!==r){if(t instanceof Array&&r instanceof Array&&t.length!==r.length)return!1;for(var i in t)if(t[i]!==r[i]){if("function"==typeof t[i])continue;if(t[i]&&r[i]&&"object"==typeof t[i]&&"object"==typeof r[i]){if(e(t[i],r[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(n=t[i])||void 0===n?void 0:n.toString())===(null===(a=r[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(var n in e.Children)r=r&&j(e.Children[n],t.Children[n]);return r}return!1}return r&&e.Children===t.Children}return!!e==!!t}function P(e,t,r,n,a,i,o,s){var c=t?t.TraceManager.getTracer("customcontrol"):null;return e(T(r,n,i.configuration,i,i.contextString,s).map((function(e){return e.configuration.DisplayNameKey}))).catch((function(e){return c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()}))}function T(e,t,r,n,i,o){var s=[];if(null==o)return s;if(i===a.h.CUSTOM&&n.configuration.isDefaultConfig)return s;var c=i===a.h.GRID||i===a.h.ASSOCIATEDGRID?Object(m.u)(n&&n.controlId,n&&n.gridEntityTypeName,n&&h.a.toString(n.viewId)):Object(m.x)(n&&n.controlId,n&&n.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&E(s,e,"GRID_CONFIG"),t&&t.CustomControls&&E(s,t,"VIEW_CONFIG"),s}function E(e,t,r){for(var n in t.CustomControls)if(t.CustomControls[n]&&!t.CustomControls[n].isDefaultConfig){for(var a=!1,i=0;i<e.length;i++)if(j(e[i].configuration,t.CustomControls[n])){a=!0;break}a||e.push({configuration:t.CustomControls[n],formFactor:n,configurationType:r})}}function w(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},cQE4:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,r){var a=Object(n.cb)(e,t,r);return a?a.footer:null}},cm3g:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e){this._value=null,this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}()},cqI9:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="chart.visualizationid.update";function o(e,t,r){return{type:"chart.visualizationid.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(a.z),d=a.x+".updateVisualizationIdAction";try{u.info("Updating the chart visualization id"),t||(t=Object(n.k)(l(),e));var p=Object(n.v)(t);return c(function(e,t,r){return{type:i,payload:{name:"VisualizationId",value:r},meta:{pageId:e,dataSetContextKey:t}}}(e,p,r)),s.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var h="Updatation of the chart visualization id failed with error : "+e.message;s.EventManager.ReportComponentFailure(d,Error(h))}}}}},"d+WZ":function(e,t,r){"use strict";r.r(t),r.d(t,"Dashboard",(function(){return hi}));var n={};r.r(n),r.d(n,"GLOBAL_FILTER_CANCEL",(function(){return Ge})),r.d(n,"GLOBAL_FILTER_CLEAR",(function(){return Ue})),r.d(n,"GLOBAL_FILTER_CLOSE_FILTER_PANEL",(function(){return ze})),r.d(n,"GLOBAL_FILTER_FILTERS",(function(){return qe})),r.d(n,"GLOBAL_FILTER_OPEN_FILTER_PANEL",(function(){return Xe})),r.d(n,"GLOBAL_FILTER_NO_ATTRIBUTES",(function(){return He})),r.d(n,"GLOBAL_FILTER_EXPAND_ALL",(function(){return Qe})),r.d(n,"GLOBAL_FILTER_COLLAPSE_ALL",(function(){return Ye})),r.d(n,"GLOBAL_FILTER_APPLY",(function(){return Ke})),r.d(n,"GLOBAL_FILTER_CLEAR_BUTTON",(function(){return Je})),r.d(n,"GLOBAL_FILTER_CLOSE_FILTER_PANEL_BUTTON",(function(){return We})),r.d(n,"GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_SUCCESS",(function(){return Ze})),r.d(n,"GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_ERROR",(function(){return $e})),r.d(n,"globalFilterLabelList",(function(){return et}));var a={};r.r(a),r.d(a,"visualFilterLabelList",(function(){return nt})),r.d(a,"VISUAL_FILTER_EXPAND",(function(){return tt})),r.d(a,"VISUAL_FILTER_COLLAPSE",(function(){return rt}));var i={};r.r(i),r.d(i,"streamTileSwitcherLabelList",(function(){return ot})),r.d(i,"SWITCH_TO_TILE_VIEW",(function(){return at})),r.d(i,"SWITCH_TO_STREAM_VIEW",(function(){return it}));var o={};r.r(o),r.d(o,"REFRESH",(function(){return st})),r.d(o,"OPEN_IN_POWERBI",(function(){return ct})),r.d(o,"SET_AS_DEFAULT",(function(){return lt})),r.d(o,"UNSET_DEFAULT",(function(){return ut})),r.d(o,"OPEN_ENTITY_GRID_LABEL",(function(){return dt})),r.d(o,"YAMMER_LABEL_IN_DASHBOARDS",(function(){return pt})),r.d(o,"EDIT_DASHBOARD",(function(){return ht})),r.d(o,"DELETE_DASHBOARD",(function(){return gt})),r.d(o,"SHARE_DASHBOARD",(function(){return mt})),r.d(o,"ASSIGN_DASHBOARD",(function(){return ft})),r.d(o,"CREATE_NEW_DASHBOARD",(function(){return bt})),r.d(o,"CREATE_NEW_DASHBOARD_TOOLTIP",(function(){return vt})),r.d(o,"CREATE_POWERBI_DASHBOARD",(function(){return yt})),r.d(o,"CREATE_POWERBI_DASHBOARD_TOOLTIP",(function(){return _t})),r.d(o,"CREATE_DYNAMICS_DASHBOARD",(function(){return Ot})),r.d(o,"CREATE_DYNAMICS_DASHBOARD_TOOLTIP",(function(){return St})),r.d(o,"SAVE_AS_DASHBOARD",(function(){return Ct})),r.d(o,"dashboardRibbonLabelList",(function(){return It}));var s=r("WH9N"),c=r("c/eZ"),l=r("nuS9"),u=r("9r0m"),d=r("4E+q"),p=r("YWpA"),h=r("vf7d"),g=r("sOTk"),m=r("NJzV"),f=r("S2mk"),b=r("T4u8"),v=r("Ww2r"),y=r("i8/j"),_=r("EcZf"),O=r("Sscr"),S=r("hadW"),C=r("F2uj"),I=r("lMVv"),j=r("G7N+"),P=r("znb3"),T=r("tWl5"),E=r("1iwa"),w=r("WS0f"),F=r("HSdq"),x=r("2OIc"),A=r("aPRd"),N=r("wV3W"),D=r("GCVK"),k=r("VWqI"),M=r("EGsq"),R=r("CIm2"),L=r("6FBX"),B=r("s2by"),V=r("Gemh"),G=r("OTOS"),U=r("qC0c"),z=r("cZkS"),q="5850fc36-8596-45fe-b607-fe81d0c453fd",X=function(){function e(e,t,r){this._descriptor=e,this.Id=this._descriptor.Id,this._pageId=r,this._descriptor.LogicalEntityName!==L.Bb&&0!==this._descriptor.Type&&2!==this._descriptor.Type||(this._appState=t)}return Object.defineProperty(e.prototype,"EntityLogicalName",{get:function(){switch(this._descriptor.Type){case 0:case 2:return L.Bb}return this._descriptor.LogicalEntityName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ViewId",{get:function(){switch(this._descriptor.Type){case 0:return this._descriptor.QueueViewId;case 2:return this._descriptor.QueueViewIdForSavedQuery}return this._descriptor.EntityViewId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"SavedQueueFilterId",{get:function(){return 2===this._descriptor.Type&&this._descriptor.SavedQueryId?this._descriptor.SavedQueryId.toLowerCase()!==q?this._descriptor.SavedQueryId.toLowerCase():R.a:0===this._descriptor.Type&&this._descriptor.QueueId?this._descriptor.QueueId:this._descriptor.LogicalEntityName===L.Bb?R.a:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queueStreamType",{get:function(){switch(this._descriptor.Type){case 0:return 1;case 1:return 0}switch(this._descriptor.SavedQueryId.toLowerCase()){case q:return 2;case"e611d950-6bab-477c-a5a3-7e9a447b326d":return 3;case"436e2293-da8f-4ef9-a1e6-fff25a5beb22":return 4}return 0},enumerable:!1,configurable:!0}),e.create=function(t,r,n){var a=new e(r,t,n);switch(r.Type){case 0:case 2:var i=Object(I.h)(t,r.LogicalEntityName);a._queueObjectTypeCode=i&&""+i.ObjectTypeCode||"0"}return a},e.makeCreate=function(t,r,n){return function(a){var i=new e(a,t,n);switch(a.Type){case 0:case 2:i._queueObjectTypeCode=r[a.LogicalEntityName]||"0"}return i}},e.prototype.createStreamFilter=function(e,t,r,n,a,i){var o,s=this._getFilterConditions(),l=r&&n&&a&&this._getEntityViewQueueItemConditions(r,n,a,i);if(s.length>0&&s.length>0&&(e=Object(c.__assign)(Object(c.__assign)({},e),{conditions:e.conditions.concat(s)})),l){var u=l.filter;u&&((e=Object(c.__assign)({},e)).filters?e.filters=e.filters.concat([u]):e.filters=[u]),(null===(o=l.linkEntities)||void 0===o?void 0:o.length)>0&&(t=t.concat(l.linkEntities))}return{filter:e,linkEntities:t}},e.prototype._getEntityViewQueueItemConditions=function(e,t,r,n){var a;if(n=this._clearOldState(n),r&&n){var i=void 0;if(1===this._descriptor.Type&&this._descriptor.LogicalEntityName===L.Bb)i=this._descriptor.LogicalEntityName;else{if(0!==this._descriptor.Type&&2!==this._descriptor.Type)return this._filterAndLinkEntities;i=L.Bb}var o=Object(G.b)(n,this._pageId),s=Object(O.d)(n,o),c=Object(O.o)(s,e,t,r),l=Object(V.C)(n,this._pageId,c),u=Object(U.c)(n,z.Zc),d=Object(B.a)(i,null===(a=n.user)||void 0===a?void 0:a.userId,c,u),p=d&&d.getFilterAndLinkedEntities(l&&void 0!==l.activityOrQueueFilterValue?l.activityOrQueueFilterValue:R.a,l&&!l.activityOrQueue);this._filterAndLinkEntities=p}return this._filterAndLinkEntities},e.prototype._clearOldState=function(e){return e?this._appState=null:e=this._appState,e},e.prototype._getFilterConditions=function(){var e=[];switch(this._descriptor.Type){case 0:case 2:e.push({attributeName:"objecttypecode",conditionOperator:0,value:this._queueObjectTypeCode})}return e},e.prototype.getQueryStateKey=function(){var e=this._queueStreamType,t=[this._descriptor.LogicalEntityName,e];return 1===e&&t.push(this._descriptor.QueueId),t},e}(),W=r("6q56"),H=r("JECh"),Q=r("RlP9"),Y=r("8xrh"),K=r("PQ2H"),J=r("7EJx"),Z=r("/V8d"),$=r("pOv+");function ee(){var e,t={},r={};return function(n,a,i){u.a.equals(e,i)||(e=i,r={});var o=!1,s=Object(y.j)(n,i),c=Ce((function(){return n}),a,i,!0),l={},d=function(e){var t=c[e];if(!function(e){if(e.hasChart&&!e.hasGrid)return!1;return!0}(t))return"continue";var i=t.entityLogicalName,d=t.viewId,p=Object(Q.c)(n,u.a.tryParseOrNull(d)),h=null,g=null;if(function(e,t,r,n){if(!r)return!1;if(t.hasGrid||4&t.streamMode){var a=Object(I.h)(e,n);if(!a||a.Initialized!==j.a.Initialized)return!1}if(t.cardFormId&&(!t.streamMode||4&t.streamMode)&&"activitypointer"!==n){var i=u.a.equals(t.cardFormId,$.a)?Object(y.h)(e,n,Object(K.a)(11)):t.cardFormId;if(!i||!u.a.isNullOrEmpty(i)&&!Object(y.j)(e,i))return!1}return!0}(n,t,p,i)){g=[];for(var m=0,f=h=Object(Z.d)(n,a,s,t,p,i);m<f.length;m++){var b=f[m],v={Alias:b,Name:b};g.push(v)}}l[e]=g,o||r.hasOwnProperty(e)&&(null!==r[e]||null===h)&&(null===r[e]||null!==h&&r[e].length===h.length&&!r[e].some((function(e){return-1===h.indexOf(e)})))||(o=!0),r[e]=h};for(var p in c)d(p);return o&&(t=l),t}}function te(e,t,r,n,a,i,o){var s=Object(g.g)(e,t),l=s.appliedFilter,u=s.dateRangeTimeFrame,d=s.dateRangeStartDate,p=s.dateRangeEndDate,h=l&&JSON.parse(l),m={conditions:Object(c.__spreadArrays)(re(h,n),function(e,t){var r=[],n=Object(J.a)(e);n&&n.FilterExpression&&n.FilterExpression.conditions&&n.FilterExpression.conditions.length>0&&n.EntityLogicalName===t&&(r=re(n.FilterExpression,t));return r}(e,n),function(e,t,r,n,a,i){var o=Object(b.a)(e,t),s=Se(e,t);if(o!==r||!s)return[];if("9"===n){return[{attributeName:s,conditionOperator:27,value:a},{attributeName:s,conditionOperator:26,value:i}]}var c=function(e){var t=new Date,r=new Date;switch(e){case"0":r=t;break;case"1":t.setDate(t.getDate()-1),r=t;break;case"2":t.setDate(0===t.getDay()?t.getDate()-6:t.getDate()-t.getDay()+1),0!==r.getDay()&&r.setDate(r.getDate()+7-r.getDay());break;case"3":t.setDate(0===t.getDay()?t.getDate()-13:t.getDate()-t.getDay()-6),r.setDate(0===r.getDay()?r.getDate()-7:r.getDate()-r.getDay());break;case"4":t.setDate(1),r.setMonth(r.getMonth()+1),r.setDate(0);break;case"5":t.setDate(1),t.setMonth(t.getMonth()-1),r.setDate(0);break;case"6":t.setDate(1);break;case"7":t.setDate(1),t.setMonth(3*Math.floor(t.getMonth()/3)),r.setDate(1),r.setMonth(t.getMonth()+3),r.setDate(0);break;case"8":t.setDate(1),t.setMonth(3*Math.floor(t.getMonth()/3)-3),r.setDate(1),r.setMonth(t.getMonth()+3),r.setDate(0),r.setFullYear(t.getFullYear())}return{startDate:t,endDate:r}}(n||Oe(e,t)),l=c.startDate,u=c.endDate,d={attributeName:s,conditionOperator:27,value:l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()},p={attributeName:s,conditionOperator:26,value:u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate()};return[d,p]}(e,r,n,u,d,p)),filterOperator:0,filters:function e(t,r){var n=[];if(t&&t.filters)for(var a=0,i=t.filters;a<i.length;a++){var o=i[a],s=re(o,r),c=e(o,r);(s.length||c.length)&&n.push({conditions:s,filterOperator:o.filterOperator,filters:c})}return n}(h,n)};if(a){var f=X.create(e,a,t).createStreamFilter(m,[],i,a.Id,o,e),v=f&&f.filter;if(v&&(v.conditions.length>0||v.filters.length>0))return f}else if(m.conditions.length>0||m.conditions.length>0)return{filter:m,linkEntities:null};return null}function re(e,t){var r=[];if(e&&e.conditions)for(var n in e.conditions){var a=e.conditions[n];a.entityName===t&&r.push(a)}return r}function ne(e,t,r,n){var a,i=Object(J.q)(e),o=null;if(t&&i&&r){var s=Object(U.c)(e,z.Zc);o=Object(B.a)(t,i,null,s).getFilterAndLinkedEntities(r,!0)}if(!o&&n)return n;if(o&&n){if(n.filter){var c=n.filter,l={conditions:[],filterOperator:0,filters:[o.filter,c]};o.filter=l}n.linkEntities&&(a=o.linkEntities).push.apply(a,n.linkEntities)}return o}var ae=r("JlqV"),ie=r("T35U"),oe=r("Tk0/"),se=r("JX21"),ce=r("/SyX"),le=r("+Xnp"),ue=r("uOa9"),de="EE9078C8-6946-4E2C-B8F8-35E65F4BE6A8",pe=new u.a("06375649-c143-495e-a496-c962e5b4488e"),he=new u.a("FD2A7985-3187-444e-908D-6624B21F69C0"),ge=new u.a("9FDF5F91-88B1-47f4-AD53-C11EFC01A01D"),me=S.a.guid.toUpperCase(),fe="MscrmControls.Containers.DashboardControl",be="MscrmControls.Containers.BoundDashboardControl",ve=["msdyn_/personalwall.htm"];function ye(e,t){var r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.DashboardCategory&&0===r.TabAttributes.DashboardCategory.indexOf("1")}function _e(e,t){var r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.DashboardCategory&&0===r.TabAttributes.DashboardCategory.indexOf("2")}function Oe(e,t){var r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.TimeFrame}function Se(e,t){var r=Object(y.j)(e,t);return r&&r.TabAttributes&&r.TabAttributes.FilterBy}function Ce(e,t,r,n,a,i){var o;void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===i&&(i=!1);var s=Object(y.j)(e(),r),l=Object(g.g)(e(),t).updatedControlParameters,d=Object(O.d)(e(),r),p=!!Object(b.a)(e(),r);return Object(W.b)(e(),t,r,((o={})[me]=function(t){return!i&&Object(W.h)(e(),s,t)},o[_.a]=function(){return!i},o[de]=function(){return!0},o),(function(i){var o=function(e,t){if(t&&t[e.Name])return Object(c.__assign)(Object(c.__assign)({},e.Parameters),t[e.Name]);return e.Parameters}(i,l),h=o&&o[0]&&o[0].StreamObjects&&o[0].StreamObjects.StreamObjectCollection;if(h){for(var g=o[0].StreamObjects.ShowAsTiles,m=[],f=function(n){var a=i.Name+n.Id,l=X.create(e(),n,t),u=l.EntityLogicalName,p=n,h=te(e(),t,r,u,p,i.Name,!0),f={hasChart:!1,hasGrid:!0,gridType:0,recordsPerPage:25,customQueryStateKeyParts:l.getQueryStateKey(),getCustomSorting:function(t,r){return function(e,t,r){var n=[{name:"modifiedon",sortDirection:1}],a=Object(Y.x)(e,t,r);if(!Object(Y.c)(n,a))return n}(e(),t,r)},getCustomFilter:function(){return ne(e(),u,l.SavedQueueFilterId,h)},contextToken:Object(O.o)(d,i.Name,n.Id,!0),streamMode:2|(g?0:1),streamId:n.Id,control:i,controlParameters:o,entityLogicalName:u,viewId:l.ViewId,savedQueueFilterId:l.SavedQueueFilterId};if(m.push({name:a+!0,control:f}),!g){var b=Object(c.__assign)(Object(c.__assign)({},f),{ribbonContext:H.i,cardFormId:Object(W.a)(e(),s,i),customQueryStateKeyParts:f.customQueryStateKeyParts.concat("x"),contextToken:Object(O.o)(d,i.Name,n.Id,!1),streamMode:5});m.push({name:a+!1,control:b})}},b=0,v=h;b<v.length;b++){f(v[b])}return m}var y,_,S=n&&Object(W.i)(e(),s,i,o),C=n&&Object(W.g)(e(),s,i,o),I=C&&(p?function(){return te(e(),t,r,o.TargetEntityType)}:function(){return function(e){if(e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters.length>0){var t=e.ChartDrillDownParameters,r=t[t.length-1].filterExpression,n=JSON.parse(r),a=[];n&&n.conditions&&(a=n.conditions);var i=[];if(a)for(var o=0,s=a;o<s.length;o++){var c=s[o];c.linkEntityExpressions&&(i=i.concat(c.linkEntityExpressions))}return{filter:{conditions:a,filterOperator:0},linkEntities:i}}return null}(o)});return S&&(y=(y=o.SavedQueryOnQueue)?u.a.fromExternalGuid(y).guid:R.a,_=function(){return ne(e(),o.TargetEntityType,y)}),{hasChart:C,chartType:Object(W.f)(o),viewType:Object(W.e)(o),sectionIndex:C&&a&&Ie(s,i.Name),getCustomFilter:C?I:_,hasGrid:S,recordsPerPage:S&&o.RecordsPerPage&&+o.RecordsPerPage,cardFormId:S&&Object(W.a)(e(),s,i),ribbonContext:S&&H.i,contextToken:Object(O.p)(d,i.Name),control:i,controlParameters:o,entityLogicalName:o.TargetEntityType,viewId:o.ViewId,savedQueueFilterId:y}}))}function Ie(e,t){if(e.Sections)for(var r in e.Sections){var n=e.Sections[r],a=0;if(n.Rows)for(var i=0,o=n.Rows;i<o.length;i++){var s=o[i];if(s.Cells)for(var c=0,l=s.Cells;c<l.length;c++){if(l[c].ControlName===t)return a;a++}}}}function je(e,t,r){var n=Ce((function(){return e}),r,t),a={};for(var i in n){var o=n[i];a[i]=o.contextToken}return a}function Pe(e,t,r,n){var a,i,o,s=Object(y.d)(e,t,r),c=Object(y.j)(e,t);if(s)for(var l in s){var u=s[l];switch(u.ClassId.guid.toUpperCase()){case me:if(!Object(W.h)(e,c,u))break;case _.a:n(u.Parameters.TargetEntityType,u);break;case de:var d=null===(o=null===(i=null===(a=u.Parameters)||void 0===a?void 0:a[0])||void 0===i?void 0:i.StreamObjects)||void 0===o?void 0:o.StreamObjectCollection;if(d)for(var p in d){var h=d[p];n(h.LogicalEntityName,h)}}}}function Te(e,t,r,n){void 0===n&&(n=!0);var a=[];return Pe(e,t,r,(function(t,r){var i=r.Id;(function(e,t,r){var n=Object(I.h)(e,t);if((null==n?void 0:n.Initialized)===j.a.Initialized&&!n.IsEnabledInUnifiedInterface)return!0;if(!r){return!n||n.Initialized===j.a.Error}return!1})(e,t,n)&&a.push(i)})),a}function Ee(e,t,r){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];var i=Object(y.d)(e,t,r);if(!i)return[];var o=[],s=function(e){var t=i[e];n.find((function(e){return u.a.equals(t.ClassId,e)}))&&o.push(t)};for(var c in i)s(c);return o}function we(e,t){if(e&&e.options)for(var r=u.a.toString(t),n=0,a=e.options;n<a.length;n++){var i=a[n];if(i.value===r)return i}}function Fe(){var e,t,r,n=null,a=null,i=1031..toString(),o=1030..toString(),s=1032..toString(),c=1035..toString(),l=1034..toString(),d=[l,c],p=(e=null,t=null,r=Object(v.h)(),function(n,a){var i=r(n,a.labelList);if(i!==e){e=i;var o=[{id:1030..toString(),name:Object(v.c)(i,a.SYSTEM_DASHBOARD_LABEL_ID)},{id:1031..toString(),name:Object(v.c)(i,a.USER_DASHBOARD_LABEL_ID)}];t=Object(U.a)(n,z.Uc,z.h)?o.reverse():o}return t});return function(e,t,r){var c=t?Object(b.g)(e,t):Object(b.c)(e),h=c?Object.keys(c):[];if(h.length>0&&(!n||a!==c)){if((L=p(e,D))&&L.length>0){a=c;for(var g=h.sort((function(e,t){var r=c[e].DisplayName.toUpperCase(),n=c[t].DisplayName.toUpperCase();return r<n?-1:r>n?1:0})),m=!1,f={},v=!Object(U.a)(e,z.Zb,z.h)||Object(ue.a)(e),y=0,_=g;y<_.length;y++){var O=_[y],S=c[O];if((!S.Id||!Object(b.i)(S.Id))&&(S.Type!==l||v||u.a.equals(r,new u.a(O)))){var C=Object(se.c)(S);m=m||C;var I=C?i:o;f[I]||(f[I]=[]);var j={value:O,text:S.DisplayName,categoryId:I};S.Type===s?j.iconType=P.a.InteractiveDashboard:-1!==d.indexOf(S.Type)?j.iconType=P.a.OpenInPowerBI:(j.iconCategory=0,j.iconType=T.a.Dashboard),f[I].push(j)}}var E=[],w=Object(U.a)(e,z.Uc,z.h),F=w?f[i]:f[o],x=w?f[o]:f[i];F&&E.push.apply(E,F),x&&E.push.apply(E,x);var A=L;m||(A=A.filter((function(e){return e.id!==i}))),n={options:E,categories:A}}}else if(n){for(var N=n.categories,k=[],M=0,R=N;M<R.length;M++){(q=R[M]).name||k.push(q.id)}if(k.length>0){var L,B={};if((L=p(e,D))&&L.length>0)for(var V=0,G=L;V<G.length;V++){var q=G[V];-1!==k.indexOf(q.id)&&(B[q.id]=q.name)}for(var X=[],W=0,H=N;W<H.length;W++){q=H[W];X.push({id:q.id,name:B[q.id]||q.name})}n={options:n.options,categories:X}}}return n}}function xe(e,t){var r=[],n=Object(C.d)(e,t);if(n)for(var a in n){var i=n[a];i&&i.IsGlobalFilterEnabled&&i.IsValidForRead&&Object(k.f)(e,t,i.LogicalName,le.a.CanRead)&&r.push(i)}return r}function Ae(e){switch(e.Type){case"entityname":case"picklist":case"multiselectpicklist":case"boolean":case"status":case"state":return"MscrmControls.MultiSelectPicklist.UpdMSPicklistControl";case"decimal":case"double":case"integer":case"money":return"MscrmControls.Slider.LinearRangeSliderControl";case"customer":case"lookup":case"owner":case"partylist":return"MscrmControls.FieldControls.SimpleLookupControl"}return null}function Ne(e,t,r,n){var a={},i=Object(x.e)(e,fe);i&&(a[fe]=i),a=Object.assign(a,Object(F.db)(e,t,r,!0,l(3)),function(e,t,r){var n={},a=ye(e,r),i=_e(e,r);if(a||i){var o=[be,"MscrmControls.DateRangeControl.DateRangeFilterControl"];if(function(e,t){var r=Object(g.g)(e,t).appliedFilter,n=r&&JSON.parse(r);if(n&&(n.conditions&&n.conditions.length||n.filters&&n.filters.length))return!0;return!1}(e,t)&&o.push("MscrmControls.AppliedFilters.AppliedFilters"),i)Object(A.c)(e)<Object(N.a)(e).sizes.Breakpoints.DimensionL&&o.push("MscrmControls.CarouselControl.GenericCarouselControl");for(var s=0,c=o;s<c.length;s++){var l=c[s],u=Object(x.e)(e,l);u&&(n[u.CustomControlId]=u)}}return n}(e,t,r));var o=Object(F.db)(e,t,r,!0,l(2)),s={};for(var c in o)a[c]||(s[c]=o[c]);return De(e,t,r,a),De(e,t,r,s),{inViewManifests:a,outOfViewManifests:s};function l(e){return function(t,r,a){var i=Object(y.d)(t,r,a),o={};for(var s in i){var c=i[s];if(!u.a.equals(u.a.EMPTY,c.ClassId)){var l=!1;if(c.ClassId.guid.toUpperCase()===de){var d=c.Parameters&&c.Parameters[0]&&c.Parameters[0].StreamObjects&&c.Parameters[0].StreamObjects.StreamObjectCollection;if(d)for(var p in d){var h=d[p];if(l=(n({control:c,streamId:h.Id})&e)===e)break}}else l=(n({control:c})&e)===e;l&&(o[s]=c)}}return o}}}function De(e,t,r,n){n.hasOwnProperty("MscrmControls.WebResource.WebResourceHtmlControl")&&0===function(e,t,r){var n=[],a=Object(y.d)(e,r,t);for(var i in a){var o=a[i],s=Me(o),c=s.isSupported,l=s.isWebResource;c&&l&&n.push(o.Id)}return n}(e,t,r).length&&delete n["MscrmControls.WebResource.WebResourceHtmlControl"],n.hasOwnProperty("MscrmControls.FieldControls.DummyControl")&&delete n["MscrmControls.FieldControls.DummyControl"];var a=ye(e,r),i=_e(e,r);(a||i)&&(Object(A.c)(e)<Object(N.a)(e).sizes.Breakpoints.DimensionS?delete n["MscrmControls.Grid.ReadOnlyGrid"]:a&&delete n["MscrmControls.KPICard.KPICardControl"],a&&delete n["MscrmControls.Chart.ChartControl"])}function ke(e,t,r,n){void 0===n&&(n=!0);var a=Te(e,t,r,n),i=Object(y.d)(e,t,r),o=[];if(i)for(var s in i){var c=i[s];Object(w.a)(c.Id)||o.push(c.Id)}return o.filter((function(e){return a.indexOf(e)<0})).filter((function(n){return function(e,t,r){var n=[],a=Object(y.d)(e,t,r);for(var i in a){var o=a[i],s=Me(o),c=s.isSupported,l=s.isWebResource;!c&&l&&n.push(o.Id)}return n}(e,t,r).indexOf(n)<0})).length}function Me(e){var t=e.Parameters&&e.Parameters.Url;if(t=t&&t.toLowerCase()){for(var r=0,n=ve;r<n.length;r++){var a=n[r];if(t.length>=a.length&&t.length-a.length===t.lastIndexOf(a))return{isSupported:!1,isWebResource:!0}}return{isSupported:!0,isWebResource:!0}}return{isWebResource:!1}}function Re(e){return Object(ae.b)(e)&&Object(U.c)(e,z.J)}var Le=r("6Tlt"),Be=r("Wg6j"),Ve=r("XIN1"),Ge="GlobalFilter_Cancel",Ue="GlobalFilter_Clear",ze="GlobalFilter_CloseFilterPanel",qe="GlobalFilter_Filters",Xe="GlobalFilter_OpenFilterPanel_UClient",We="GlobalFilter_CloseFilterPanel_UClient",He="GlobalFilter_No_Attributes",Qe="GlobalFilter_ExpandAll",Ye="GlobalFilter_CollapseAll",Ke="GlobalFilter_Apply",Je="SliderControl_ClearButton",Ze="GlobalFilter_SaveFilter_Toast_Delete_Success",$e="GlobalFilter_SaveFilter_Toast_Delete_Error",et=[Ge,Ue,ze,qe,Xe,He,Qe,Ye,Ke,Je,We,Ze,$e],tt="VisualFilter_Expand_UClient",rt="VisualFilter_Collapse_UClient",nt=[tt,rt],at="Queue_Panel_Switch_TileView_Text",it="Queue_Panel_Switch_StreamView_Text",ot=[at,it],st="Ribbon.DashboardTab.Actions.Refresh.Label",ct="Ribbon.DashboardTab.Actions.OpenInPbi.Label",lt="Ribbon.DashboardTab.Actions.UserDefault.Label",ut="Ribbon.DashboardTab.Actions.ClearDefault.Label",dt="Display_Entity_Grid_Page",pt="Ribbon.DashboardTab.Actions.YammerButton",ht="Ribbon.DashboardTab.Management.Edit.Label",gt="Ribbon.DashboardTab.Management.Delete.Label",mt="Ribbon.DashboardTab.Actions.Share.Label",ft="Ribbon.DashboardTab.Actions.Assign.Label",bt="Ribbon.DashboardTab.Management.New.Label",vt="Ribbon.DashboardTab.Management.New.ToolTipDescription",yt="Ribbon.DashboardTab.Management.PowerBIDashboard.Label",_t="Ribbon.DashboardTab.Management.PowerBIDashboard.ToolTipDescription",Ot="Ribbon.DashboardTab.Management.CRMDashboard.Label",St="Ribbon.DashboardTab.Management.CRMDashboard.ToolTipDescription",Ct="Ribbon.DashboardTab.Management.SaveAs.Label",It=[st,ct,lt,ut,dt,pt,ht,gt,mt,ft,bt,vt,yt,_t,Ot,St,Ct],jt=r("0OS1"),Pt=r("vO+w");function Tt(e){return function(t,r){return e&&r?Object(c.__assign)(Object(c.__assign)({},t),r):t}}function Et(e){return parseFloat(window.getComputedStyle(document.documentElement).fontSize)*parseFloat(e)}var wt=r("fQ3D"),Ft=r("akzq"),xt=r("evh6"),At=r("QAhb"),Nt=r("DRVD"),Dt=r.n(Nt),kt=r("t8f4"),Mt=r("FHVK"),Rt=r("VnuK"),Lt=r("8egQ"),Bt=r("7pqb"),Vt=r("BFwB"),Gt=r("VnpK");function Ut(e){return{type:"userquery.retrievefilterstate.async",execute:function(t,r){var n=t.dispatch,a=t.getState,i="?$filter=querytype eq 524288 and returnedtypecode eq '"+e+"'&$select=userqueryid,fetchxml,name",o=u.a.toString(Object(J.j)(a()));return n(Object(kt.e)("userquery",i)).then((function(t){var r=t,i=null;t&&t.value&&o&&t.value.forEach((function(e){if(e.userqueryid!==o);else{var t=e.fetchxml;i=Object(Gt.i)(t)}}));var s={EntityLogicalName:e,FilterExpression:i};n(function(e,t,r,n){var a=Object(J.x)(e),i=Object(c.__assign)({},a),o=null;t&&t.value&&(o=t.value);var s=i.userSettings.savedFilters;s||(s={});s[n]=o,i.userSettings.savedFilters=s,r&&r.FilterExpression&&(i.userSettings.defaultSavedFilter=r);var l={userState:i};return{type:Lt.b,payload:l}}(a(),r,s,e))}),(function(e){r.EventManager.ReportComponentFailure("SaveFilterRetrieveMultiple",e)}))},getFailureParameters:function(e,t){return[{name:Bt.b.DashboardId,value:"RetrieveSavedFilters"}]}}}function zt(e){return{type:"userquery.deletefilterstate.async",execute:function(t,r){var a,i,o,s=t.dispatch,l=t.getState,d=Dt.a.createEvent("savedFilterDelete","DeleteSavedFilters.Actions").startStopwatch(),p=new At.a("userquery",new u.a(e.userQueryId)),h=s(Object(kt.c)(p)),g=(a=l(),i=n,o=Object(v.e)(a,i.globalFilterLabelList),{deleteSuccessMessage:Object(v.c)(o,i.GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_SUCCESS),deleteErrorMessage:Object(v.c)(o,i.GLOBAL_FILTER_SAVEFILTER_TOAST_DELETE_ERROR)}),m=new Vt.a("uci_globalfilter_savefilter_delete");return h.then((function(t){d(),s(function(e,t){var r=Object(J.x)(e),n=Object(c.__assign)({},r),a=t.entityName,i=n.userSettings.savedFilters;i[a]=i&&i[a]&&i[a].filter((function(e){return e.userqueryid!==t.userQueryId})),n.userSettings.savedFilters[a]=i[a];var o={userState:n};return{type:Lt.b,payload:o}}(l(),e)),qt(s,p,!0,Object(Mt.a)(g.deleteSuccessMessage,e.filterName)),m.addEventParameter("SaveFilters",e.filterName+" - "+e.userQueryId),r.EventManager.ReportEvent(m)}),(function(t){d(),qt(s,p,!1,Object(Mt.a)(g.deleteErrorMessage,e.filterName)),r.EventManager.ReportComponentFailure("SaveFilterDelete",e.userQueryId+" - "+t)}))}}}function qt(e,t,r,n){var a={id:"savedFilterDelete_"+t.id.guid,type:1,level:r?1:2,message:n};e(Object(Rt.b)(a))}function Xt(e){return{type:"userquery.updatefilterstate.async",execute:function(t,r){var n=t.dispatch,a=t.getState,i=Dt.a.createEvent("setDefaultSavedFilter","DefaultSavedFiltersUpdate.Actions").startStopwatch(),o=Object(J.q)(a()),s=new At.a("usersettings",o),l=e.userSettingData,d=n(Object(kt.f)(s,l.data)),p=l&&l.data&&l.data.selectedglobalfilterid;p=p||"";var h=new Vt.a("uci_globalfilter_savefilter_pin_unpin");return d.then((function(e){i(),n(function(e,t,r){var n=Object(J.x)(e),a=Object(c.__assign)({},n),i=a.userSettings.savedFilters,o=i&&i[r]&&i[r].find((function(e){return e.userqueryid===t})),s=o&&o.fetchxml;a.userSettings.selectedGlobalFilterId=t?new u.a(t):u.a.EMPTY,a.userSettings.defaultSavedFilter||(a.userSettings.defaultSavedFilter={});a.userSettings.defaultSavedFilter.EntityLogicalName=r,a.userSettings.defaultSavedFilter.FilterExpression=Object(Gt.i)(s);var l={userState:a};return{type:Lt.b,payload:l}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(a(),p,l.entityName)),h.addEventParameter("SaveFilters",p),r.EventManager.ReportEvent(h)}),(function(e){i(),r.EventManager.ReportComponentFailure("SaveFilterDefault",p+" - "+e)}))},getFailureParameters:function(t,r){return[{name:Bt.b.DashboardId,value:e.userSettingData.data.selectedglobalfilterid}]}}}function Wt(e){return{type:"dashboard.setdefault.async",execute:function(t){var r=t.dispatch,n=t.getState;e||(e=u.a.EMPTY);var a=Object(J.q)(n()),i=new At.a("usersettings",a);return r(Object(kt.f)(i,{defaultdashboardid:e===u.a.EMPTY?null:e.guid.toUpperCase()})).then((function(){return r(function(e,t){var r=Object(J.x)(t),n=Object(c.__assign)({},r);n.userSettings.defaultDashboardId=e===u.a.EMPTY?null:e;var a={userState:n};return{type:Lt.b,payload:a}}(e,n()))}))},getFailureParameters:function(t,r){return[{name:Bt.b.DashboardId,value:e&&e.guid}]}}}var Ht=r("NxDw"),Qt=r("/eNh");var Yt,Kt=r("zpQF"),Jt=r("XjtF"),Zt=r("gBKR");function $t(e){return{type:"loadGlobalFilterCustomControlResources.dashboardAction.async",getFailureParameters:function(){return[{name:Bt.b.EntityName,value:e}]},execute:function(t,r){for(var n=t.dispatch,a=t.getState,i=function(e,t){var r={},n=Object(x.e)(e,"MscrmControls.GlobalFilter.GlobalFilterControl");n&&(r["MscrmControls.GlobalFilter.GlobalFilterControl"]=n);for(var a=0,i=xe(e,t);a<i.length;a++){var o=Ae(i[a]),s=o&&Object(x.e)(e,o);s&&(r[o]=s)}return Object.keys(r).map((function(e){return r[e]}))}(a(),e),o=0,s=i;o<s.length;o++){var c=s[o];n(Object(Jt.a)(c))}for(var l=[],u=function(e,t){for(var r=[],n=0,a=xe(e,t);n<a.length;n++){var i=a[n];if("MscrmControls.FieldControls.SimpleLookupControl"===Ae(i)&&i.Targets)for(var o=0,s=i.Targets;o<s.length;o++){var c=s[o];-1===r.indexOf(c)&&r.push(c)}}return r}(a(),e),d=0,p=u;d<p.length;d++){var h=p[d];h!==e&&-1===l.indexOf(h)&&n(Object(Zt.f)(h,!0,[]))}return Promise.resolve()}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Unbound=0]="Unbound",e[e.Bound=1]="Bound",e[e.TierOne=2]="TierOne",e[e.TierTwo=4]="TierTwo"}(Yt||(Yt={}));var er=function(){function e(){this._firstGlobalFilterOpen=!0}return e.prototype.haveResourceStringsChanged=function(e){return!(this._globalFilterCommandLabels&&this._visualFilterCommandLabels&&this._streamTileSwitcherCommandLabels&&this._globalFilterCommandLabels.expand===e.globalFilterCommandLabels.expand&&this._globalFilterCommandLabels.collapse===e.globalFilterCommandLabels.collapse&&this._visualFilterCommandLabels.expand===e.visualFilterCommandLabels.expand&&this._visualFilterCommandLabels.collapse===e.visualFilterCommandLabels.collapse&&this._streamTileSwitcherCommandLabels.switchToTileView===e.streamTileSwitcherCommandLabels.switchToTileView&&this._streamTileSwitcherCommandLabels.switchToStreamView===e.streamTileSwitcherCommandLabels.switchToStreamView)},e.prototype.updateResourceStrings=function(e){this._globalFilterCommandLabels=e.globalFilterCommandLabels,this._visualFilterCommandLabels=e.visualFilterCommandLabels,this._streamTileSwitcherCommandLabels=e.streamTileSwitcherCommandLabels},e.prototype.resetCommands=function(e,t,r,n){t.ShowVisualFilters=!1,t.ToggleGlobalFilterFlyout=void 0,t.TileView=!1,r.ShowVisualFilters=!1,r.ToggleGlobalFilterFlyout=!1,r.TileView=!1,this._firstGlobalFilterOpen=!0,e.dashboardType&Yt.Bound&&n()},e.prototype.needsRefresh=function(e){return this._currentCommandBarType!==e.dashboardType},e.prototype.getCommandButtons=function(e,t,r,n,a,i){var o=e();this._currentCommandBarType=o.dashboardType;var s=[];if(o.isServerOffline)return s;var c=!!(this._currentCommandBarType&Yt.Bound),l=u.a.isNullOrEmpty(o.formId)&&!u.a.isNullOrEmpty(o.selectedDashboardId)&&we(o.dashboardSelectorItems,o.selectedDashboardId);if(l&&(c=l.iconType===P.a.InteractiveDashboard),c){var d=o.isEntityBoundDashboard,p=this._currentCommandBarType&Yt.TierOne||d&&!(this._currentCommandBarType&Yt.TierTwo);p&&s.push(this._createToggleVisualFiltersButton(e,t,a)),s.push(this._createGlobalFilterButton(e,t,r,n,a)),p&&!i&&s.push(this._createStreamTileSwitcherButton(e,t,a)),d&&s.push({Icon:"Default",DisplayText:o.openEntityGrid,Id:"OpenEntityGrid",execute:function(){return e().openGridPage(e().entityLogicalName)}})}return s},e.prototype._createToggleVisualFiltersButton=function(e,t,r){var n=e().dashboardInput,a=e().visualFilterCommandLabels,i=a&&(n&&n.showVisualFilters?a.collapse:a.expand)||"",o=n&&n.showVisualFilters?"HideVisualFilter":"VisualFilter";return t.ShowVisualFilters=n&&n.showVisualFilters,{Icon:o,DisplayText:i,Tooltip:{title:i},Id:"ShowVisualFilters",execute:{type:"dashboard.visualfilter",execute:function(a){var i=a.dispatch;r(),n=e().dashboardInput,t.ShowVisualFilters=!(n&&n.showVisualFilters);var o=Object(c.__assign)(Object(c.__assign)({},n),{showVisualFilters:t.ShowVisualFilters});return i(Object(Kt.b)(o,e().id)),Promise.resolve()}}}},e.prototype._createGlobalFilterButton=function(e,t,r,n,a){var i=this;t.GlobalFilterFlyoutAnchorId="DashboardGlobalFilterAnchor";var o=e().globalFilterCommandLabels,s=o&&(r().ToggleGlobalFilterFlyout?o.collapse:o.expand)||"";return{Icon:"GlobalFilter",DisplayText:s,Tooltip:{title:s},Id:"GlobalFilterCommandBarButton",execute:{type:"dashboard.globalfilter",execute:function(o){var s=o.dispatch,c=o.getState;return i._firstGlobalFilterOpen&&(i._firstGlobalFilterOpen=!1,s($t(Object(b.a)(c(),e().formId)))),a(),t.ToggleGlobalFilterFlyout=!r().ToggleGlobalFilterFlyout,n({ToggleGlobalFilterFlyout:t.ToggleGlobalFilterFlyout}),Promise.resolve()}}}},e.prototype._createStreamTileSwitcherButton=function(e,t,r){var n=e().dashboardInput,a=n&&n.showTileView?"TripleColumn":"Tiles",i=e().streamTileSwitcherCommandLabels,o=i&&(n&&n.showTileView?i.switchToStreamView:i.switchToTileView)||"";return t.TileView=n&&n.showTileView,{Icon:a,DisplayText:o,Tooltip:{title:o},Id:"StreamTileViewSwitcher",execute:{type:"dashboard.tileview",execute:function(a){var i=a.dispatch;r(),n=e().dashboardInput,t.TileView=!(n&&n.showTileView);var o=Object(c.__assign)(Object(c.__assign)({},n),{showTileView:t.TileView});return i(Object(Kt.b)(o,e().id)),Promise.resolve()}}}},e}(),tr=r("4pqm"),rr=r("s5BY"),nr=r("wNCw"),ar=r("+D0h"),ir=r("90WD"),or=r("+96U"),sr=r("5KPK"),cr=r("UTiY"),lr=r("/j9Z"),ur=r("plWV"),dr=r("9CHn");function pr(e,t){var r="DashboardCommands.SaveAsDashboard",n=[];return n.push({name:Bt.g.ComponentName,value:r}),n.push({name:Bt.b.DashboardId,value:u.a.toString(e)}),{type:"dashboard.saveas",execute:function(a,i,o){var s=a.dispatch,c=(0,a.getState)();n.push({name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId});var l=Object(se.a)(c,e);if(l){var d={telemetryParameters:n,reportFailure:function(e,t,a){void 0===t&&(t=!0),void 0===a&&(a=null),t&&s(Object(dr.b)()),n.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure(r,a||e,"",n),s(Object(cr.b)(e||{}))}};(function(e,t,r,n,a){var i=""+Object(tr.b)()+Object(rr.a)(t,"/AdvancedFind/QueryProperties.aspx")+"?dType=1&feature=dashboard";r.telemetryParameters.push({name:"url",value:i});var o={windowPosition:"center",width:500,height:310},s={sName:n.DisplayName,sDescription:n.Description,sIsTabletEnabled:n.IsTabledEnabled};return e(Object(ur.b)(null)),e(Object(nr.a)(i,o,s,a)).then((function(t){return e(Object(dr.b)()),0===t.status?e(Object(ar.a)(t.pageId)).then((function(e){return e&&e.reason===ir.b&&e.value?e.value:null})):(r.reportFailure(t.error,!1),null)}))})(s,c,d,l,t).then((function(e){e&&function(e,t,r,n,a){var i=a.sName,o=a.sDescription,s=a.sIsTabletEnabled;e(Object(ur.b)(null));var c=Object(se.c)(n)?"userform":"systemform",l=new At.a(c,n.Id);return e(Object(kt.d)(l)).then((function(n){var a=function(e,t,r){var n,a,i=(new DOMParser).parseFromString(r,"text/xml");if(!Object(U.c)(e,"FCB.DisableUserFormXmlLabelTransform")){var o=Object(J.s)(e),s=null===(a=Object(M.x)(e))||void 0===a?void 0:a.languageCode;if((n=t.telemetryParameters).push.apply(n,[{name:"userLcid",value:o},{name:"orgLcid",value:s}]),!s)return t.reportFailure(null,!0,new lr.a("No org lcid")),null;!function(e,t,r){for(var n=r.querySelectorAll("labels"),a=0;a<n.length;a++){var i=n[a],o=i.querySelectorAll("label"),s=void 0;if(o.length>1?(e&&(s=i.querySelector("label[languagecode='"+e+"']")),s||e===t||(s=i.querySelector("label[languagecode='"+t+"']")),s||(s=o[0])):1===o.length&&(s=o[0]),s){s.setAttribute("languagecode",t.toString());for(var c=0;c<o.length;c++){var l=o[c];i.removeChild(l)}i.appendChild(s)}}}(o,s,i)}return function(e){for(var t=e.querySelectorAll("control"),r=0;r<t.length;r++){var n=t[r],a=u.a.tryParseOrNull(n.getAttribute("classid"));if(u.a.equals(a,he)){var i=n.querySelector("Security");if(i)i.textContent="true";else{var o=n.querySelector("parameters");o||(o=e.createElement("parameters"),n.appendChild(o));var s=e.createElement("<Security>true</Security>");o.appendChild(s)}}}}(i),(new XMLSerializer).serializeToString(i)}(t,r,n.formxml);if(!a)return null;var c={name:i,description:o,istabletenabled:s,type:n.type,formxml:a};return e(Object(kt.b)("userform",c)).then((function(t){return e(Object(dr.b)()),t}))})).catch(r.reportFailure)}(s,c,d,l,e).then((function(e){n.push({name:"newDashboardId",value:u.a.toString(e)}),u.a.isNullOrEmpty(e)||s(Object(sr.a)(null,e,null,null,or.b,!1,t)).then((function(){i.EventManager.ReportComponentSuccess(r)}))}))}))}return Promise.resolve()},getFailureParameters:function(e,t){return n.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),n}}}var hr=r("4tno"),gr=["Dashboard_LiveRegion_DateRangeFilter_Message","Dashboard_LiveRegion_Filter_Removed_Message","Dashboard_LiveRegion_GlobalFilter_Applied","Dashboard_LiveRegion_Initial_Message","Dashboard_LiveRegion_StreamView","Dashboard_LiveRegion_TileView","Dashboard_LiveRegion_VisualFilter_Applied","Dashboard_Tier2_TilesView_Title","Error.ReadOnlyEntity","Error.BoundDashboardOffline","Error.DashboardNoComponents","Error.DashboardUnsupportedComponents","Dashboard_Editor_Open_Title","Dashboard_Editor_Open_Message","Dashboard_Editor_Open_Confirm_Button","Dashboard_Header_Label"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function mr(e,t){var r="DashboardCommands.EditPowerBIDashboard",n=[];return n.push({name:Bt.g.ComponentName,value:r}),n.push({name:Bt.b.DashboardId,value:u.a.toString(t)}),{type:"powerbidashboard.edit",execute:function(a,i,o){var s=a.dispatch,c=a.getState;try{n.push({name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId},{name:Bt.b.DashboardCommandsParameters.IsPowerBIDashboard,value:!0});var l=u.a.isNullOrEmpty(t),d={uciCallback:function(r){var n=l?new u.a(r):t;s(zn(e,n,l))}};if(!l){var p=Object(oe.a)(c(),t);if(p){var h=Object(se.a)(c(),t).IsTabledEnabled;Object.assign(d,{DashboardId:p.PowerBIDashboardId,GroupId:p.PowerBIGroupId,isTabletEnabled:h,CrmDashboardId:u.a.toString(t)}),n.push({name:Bt.b.DashboardCommandsParameters.PowerBIDashboardId,value:p.PowerBIDashboardId},{name:Bt.b.DashboardCommandsParameters.PowerBIGroupId,value:p.PowerBIGroupId})}}var g=""+Object(tr.b)()+Object(rr.a)(c(),"/tools/dashboardeditor/dialogs/Powerbidashboard.aspx")+"?dType=1&mode=edit";return n.push({name:Bt.b.LegacyDialogUrl,value:g}),Object(ur.b)(null),s(Object(nr.a)(g,{width:800,height:480},d,e)).then((function(e){return Object(dr.b)(),i.EventManager.ReportComponentSuccess(r),e}))}catch(e){return n.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure(r,e,"",n),Promise.reject(e)}},getFailureParameters:function(e,t){return n.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),n}}}var fr=r("sMXu"),br=r("RYq1"),vr=r("mGpW"),yr=r("perk"),_r=r("6JRL");function Or(e,t){return{type:"dashboard.setLoadStatus",payload:t,meta:{pageId:e}}}var Sr=function(){function e(e,t,r,n){this._finalResult={status:5},this._resultPromises=[],this._context=e,this._pageId=t,this._dispatch=r,this._getTelemetryParameters=n}return e.prototype.setDashboardLoadResult=function(e,t){var r=this;if(null!=e){("number"==typeof e||e instanceof Number)&&(e={status:e,error:t});var n=e;if(n.then){var a=n.then((function(e){return r._setDashboardLoadResultInternal(e)})).catch((function(e){return r._setDashboardLoadResultInternal({status:-1,error:e})}));this._resultPromises.push(a)}else{var i=e;this._setDashboardLoadResultInternal(i)}}},e.prototype._setDashboardLoadResultInternal=function(e){e&&5!==e.status&&(this._finalResult=e)},e.prototype.finalizeDashboardLoadResult=function(){var e=this;return 0===this._resultPromises.length?this._finalizeDashboardLoadResultInternal():Promise.all(this._resultPromises).then((function(){return e._finalizeDashboardLoadResultInternal()}))},e.prototype._finalizeDashboardLoadResultInternal=function(){var e=this._finalResult,t=e.status,r=e.error;return this._reportDashboardLoadResult(t,r),this._setErrorInfoInState(t),Promise.resolve()},e.prototype._reportDashboardLoadResult=function(e,t){var r=this._getTelemetryParameters&&this._getTelemetryParameters();if(-1===e){var n=t;t&&("string"==typeof t||t instanceof String)&&(n=Object(_r.d)(t?t.toString():"Error in finalize dashboard load result internal",2415919107));var a=r&&0!==r.length?void 0:"Supply telemetry parameters";this._context.EventManager.ReportComponentFailure("Dashboard.initializeAction",Error(n&&n.message),a,r)}else this._context.EventManager.ReportComponentSuccess("Dashboard.initializeAction",r)},e.prototype._setErrorInfoInState=function(e){if(this._dispatch(Or(this._pageId,e)),5!==e)switch(e){case 0:this._dispatch(Object(vr.e)([yr.UCI_DISABLED_ENTITY_ERROR]));break;case 1:this._dispatch(Object(vr.e)(["Error.ReadOnlyEntity"]));break;case 2:this._dispatch(Object(vr.e)(["Error.BoundDashboardOffline"]));break;case 3:this._dispatch(Object(vr.e)(["Error.DashboardNoComponents"]));break;case 4:this._dispatch(Object(vr.e)(["Error.DashboardUnsupportedComponents"]))}},e}(),Cr=r("Pm+b"),Ir=r("zmaG"),jr=r.n(Ir),Pr=r("vYfn"),Tr=r("M/UD"),Er=r("0+L4"),wr=r("So/t"),Fr={systemuser:[null],lead:["d228d73e-e56e-48b3-ab95-0a06b1397b03","95192c4e-f96e-4771-b10a-e6421c908533"],contact:["3d22ab88-96c8-4b3f-a533-d4827e2925c9","cdbb9298-3b2e-41f3-8f4a-0168d6b09fc4"],account:["fb65cc73-181c-468b-9bb3-82ecde306991","76b81f10-2a08-4f1a-9454-ee38bea94eb5"]},xr=Object(K.a)(6);function Ar(e,t){if(t&&Object(b.i)(t))return{type:"mailApp.prefetchRegardingForm",execute:function(t,r){return new Tr.a(r,t).getExternalContextProperty("MAIL_CONTEXT","TRACK_STATUS").then((function(r){var n=t.dispatch,a=t.getState;r&&r.crmRegardingObjectType&&function(e,t,r){var n=Object(I.m)(t(),r);if(n)return Promise.resolve(n);var a="LogicalName",i="$filter=ObjectTypeCode eq "+r,o=new Er.e(i,[a]);return e(Object(wr.b)(o)).then((function(e){return e.json().then((function(e){var t,r,n=null===(r=null===(t=null==e?void 0:e.value)||void 0===t?void 0:t[0])||void 0===r?void 0:r[a];return n?Promise.resolve(n):Promise.reject(new Error("Entity name is null"))}))}))}(n,a,r.crmRegardingObjectType).then((function(t){t&&!Fr[t]&&Nr(a,e,n,t,null,xr)}))})),Promise.resolve()}}}function Nr(e,t,r,n,a,i){r(Object(Pr.b)(new At.a(n),a,i)).then((function(n){var a=Object(F.db)(e(),t,n,!0);for(var i in a){var o=a[i];r(Object(Jt.a)(o))}}))}var Dr=r("7z0H"),kr=r("U0B9"),Mr=2/(1+Math.sqrt(5)),Rr=function(){function e(){this._columns=-1,this._desiredColumns={}}return e.prototype.getSectionRowCount=function(e,t){return e},e.prototype.isReflow=function(e,t){return e&&e.requiresReflow||this._columns<this.getDesiredColumnCount(t)},e.prototype.getRowHeight=function(e){return this._defaultRowHeight},e.create=function(t,r,n,a,i){var o=new e;return o._form=t,o._formFactor=n,o._forbiddenControlIds=a||[],o._defaultRowHeight=i,o.setColumns(r),o},e.prototype.createDashboardLayout=function(e){for(var t=[],r=0,n=function(n){for(var i=0,o=0,s=a._form.Tabs.find((function(e){return e.Name===n})).Columns;o<s.length;o++)for(var c=0,l=s[o].SectionNames;c<l.length;c++){var u=l[c],d=a._form.Sections[u],p=a.createSectionLayout(d,e);p.offsetTop=r,t.push(p),i=Math.max(i,p.rowCount*a.getRowHeight(d))}r+=i},a=this,i=0,o=this._form.TabNames;i<o.length;i++){n(o[i])}return t},e.prototype.createSectionLayout=function(e,t){var r=this._createControlsInDesiredLayout(e);return this.isReflow(r,e)&&(r=this.reflowLayout(r.controls,e,t)),r},e.prototype.setColumns=function(e){var t=e!==this._columns;return this._columns=e,t&&(this._desiredColumns={}),t},e.prototype.getDesiredColumnCount=function(e){var t=e.Id.guid;if(!this._desiredColumns[t]){var r=0,n=e.Rows;if(n)for(var a=0;a<n.length;a++){for(var i=n[a],o=0,s=0;s<i.Cells.length;s++){o+=i.Cells[s].ColSpan}o>r&&(r=o)}this._desiredColumns[t]=Math.max(1,r)}return this._desiredColumns[t]},e.prototype._createControlsInDesiredLayout=function(e){for(var t=e.Rows,r=[],n=!1,a=t.length,i=0;i<t.length;i++){var o=t[i];if(o.Visible)for(var s=0,c=0;c<o.Cells.length;c++){var l=o.Cells[c];if("auto"===o.Height&&(l.RowSpan=1),l.ControlName&&this._form.Controls[l.ControlName]){var u=this._form.Controls[l.ControlName];if(!l.Visible&&5===this._form.FormType){var d=Object(x.a)(u,this._form,this._formFactor);if(!d||!d.ShouldOverrideControlVisible)continue;l.Visible=!0,u.Visible=!0}var p=Me(u),h=p.isSupported,g=p.isWebResource;if(h&&g||!g&&-1===this._forbiddenControlIds.indexOf(u.Id)){var m=this._getSubControls(u),f=Math.max(1,Math.floor(l.ColSpan/m.length));for(var b in m){if(!n)for(var v=0;v<f&&!(n=this._cellIsOccupied(r,i,s+v));v++);r.push({id:""+l.ControlName+(1===m.length?"":b),name:l.ControlName,componentIndex:+b,cell:l,row:i,rowHeight:o.Height,column:s,rowSpan:l.RowSpan,colSpan:f,canMemoize:!0}),s+=f}a=Math.max(a,i+l.RowSpan)}else n=!0}}}return{controls:r,rowCount:this.getSectionRowCount(a,e),requiresReflow:n}},e.prototype.reflowLayout=function(e,t,r){for(var n=[],a=0,i=0,o=0,s=Math.min(this._columns,this.getDesiredColumnCount(t)),c=r/s,l=0;l<e.length;l++){var u=e[l],d=l===e.length-1;if(u.row=a,u.column=i,u.colSpan>1){var p=!0;if(u.colSpan>s&&(u.colSpan=s),u.colSpan+u.column>s&&(p=!1),p)for(var h=u.colSpan;h>0;h--)if(this._cellIsOccupied(n,u.row,u.column+h)){p=!1;break}if(!p)for(;!p;){a++,u.row=a;for(var g=0;g<=s-u.colSpan;g++){u.column=g,p=!0;for(h=u.colSpan;h>=0;h--)if(this._cellIsOccupied(n,u.row,u.column+h)){p=!1;break}if(p)break}}}if(n.push(u),this._useGoldenRatio(u)){var m=this._getGoldenRatioHeight(t,u,c);u.rowSpan=Math.round(m/this.getRowHeight(t))}else u.rowSpan=this._getRowSpan(s,u,t);if(o=Math.max(o,u.row+u.rowSpan),!d&&((i=u.column+u.colSpan)>=s||this._cellIsOccupied(n,a,i))){for(;i<s&&this._cellIsOccupied(n,a,i);)i++;if(i>=s||this._cellIsOccupied(n,a,i))for(i=0,a++;this._cellIsOccupied(n,a,i);)++i>=s&&(i=0,a++)}}for(g=0;g<e.length;g++)for(u=e[g];u.colSpan+u.column<s&&!this._cellIsOccupied(n,u.row,u.column+u.colSpan);)u.colSpan++;return{controls:n,rowCount:this.getSectionRowCount(o,t)}},e.prototype._useGoldenRatio=function(e){var t=this._form.Controls[e.id];return t&&t.Parameters&&"Chart"===t.Parameters.ChartGridMode},e.prototype._getRowSpan=function(e,t,r){return t.rowSpan+0},e.prototype._getGoldenRatioHeight=function(e,t,r){var n=t.colSpan*r,a=t.rowSpan*this.getRowHeight(e);return a<n?a/n<n/(n+a)?Mr*n:a/n*n:n/a>=a/(n+a)?1/(n/a)*n:1/Mr*n},e.prototype._cellIsOccupied=function(e,t,r){for(var n in e){var a=e[n];if(t>=a.row&&t<a.row+a.rowSpan&&r>=a.column&&r<a.column+a.colSpan)return!0}return!1},e.prototype._getSubControls=function(e){if(u.a.equals(e.ClassId,new u.a(de))){var t=e.Parameters&&e.Parameters[0]&&e.Parameters[0].StreamObjects&&e.Parameters[0].StreamObjects.StreamObjectCollection;if(t){var r=[];for(var n in t){var a=t[n];-1===this._forbiddenControlIds.indexOf(a.Id)&&r.push(a)}return r}}return[e]},e}();function Lr(e,t,r,n,a){var i,o,s,c,l=!!Object(b.a)(t,r.Id),u=ye(t,r.Id),d=!1,p=!1,h=Te(t,r.Id,e);if(l){g=Object(A.c)(t),f=Object(N.a)(t);p=g>=f.sizes.Breakpoints.DimensionS&&!a,!u&&g<f.sizes.Breakpoints.DimensionL&&(c=g>=f.sizes.Breakpoints.DimensionM?2:1)}else if(!(d=Object(b.i)(r.Id))){var g=Object(A.c)(t),m=Object(kr.b)(t);switch(m){case kr.a.Phone:m=3;break;case kr.a.Tablet:m=2;break;case kr.a.Web:m=1}var f,v=Br(f=Object(N.a)(t),g),y=(1===v?0:Et(f.sizes.Measures.Measure300))+(2*Et(f.sizes.Measures.Measure125)+Et(f.sizes.Measures.Measure300))+Et(f.sizes.Measures.Measure100);s=Object(A.b)(t)-y,i=Rr.create(r,v,m,h,Et(""+f.sizes.Section.cellHeightInRem)),o=i.createDashboardLayout(g)}return function(e){var t={};return function(r){var a=r.streamId?r.streamId+r.streamMode:r.control.Id;return t.hasOwnProperty(a)||(t[a]=function(e,t){if(u&&!n&&"VisualFilters"===e.control.ParentSectionName)return 2;if(e.streamId&&-1!==h.indexOf(e.streamId))return 0;if(d)return 7;if(l)return e.hasOwnProperty("streamMode")?!(1&e.streamMode)||p&&4&e.streamMode||u&&!p&&2&e.streamMode?7:0:e.hasOwnProperty("sectionIndex")&&(!u||n)&&(void 0===c||e.sectionIndex<c)?7:3;for(var r=0,a=o;r<a.length;r++)for(var g=a[r],m=0,f=g.controls;m<f.length;m++){var b=f[m];if(b.name===e.control.Name)return g.offsetTop+b.row*i.getRowHeight(null)<s?e.hasGrid||e.hasChart?7:3:t}return 0}(r,e)),t[a]}}}function Br(e,t){var r=Et(e.sizes.Measures.Measure150),n=r;return Math.max(1,Math.floor((t-n)/(320+r)))}var Vr,Gr=r("F314"),Ur=r("19Zc"),zr=r("CCTC"),qr=function(){function e(e,t,r,n,a){this._callback=a,this._callbackCalled=!1,this._controlTypeCounts={},this._viewportRenderTime=0,this._controlsShouldRender=[],this._controlsShouldRenderCount=0,this._renderedControls=[];var i=Object(y.d)(e,r,t);if(i){var o=Ce((function(){return e}),t,r,!1,!1,!0),s={};for(var c in o){var l=(b=o[c]).control.Id;s[l]||(s[l]=[]),s[l].push(b)}for(var d in i){var p=i[d];if(d&&p&&!u.a.isNullOrEmpty(p.ClassId)&&p.Visible){var h=s[p.Id];if(h&&h.length>0)for(var g=[],m=0,f=h;m<f.length;m++){var b;1&n(b=f[m])&&(-1===g.indexOf(b.streamId)&&(this._controlsShouldRenderCount++,g.push(b.streamId)),this._controlsShouldRender.push(d+"_"+b.streamId+"_"+!!(2&b.streamMode)))}else 1&n({control:p})&&(this._controlsShouldRender.push(d),this._controlsShouldRenderCount++)}}}}return e.prototype.writeMarker=function(e,t,r){this._receivedEvent(e,t,r)},e.prototype.writeRetroactiveTimespan=function(e,t,r,n){this._receivedEvent(e,t+r,n)},e.prototype.startTimespan=function(e,t,r){var n=this;return function(a,i){n._receivedEvent(e,t+a,r)}},e.prototype._receivedEvent=function(e,t,r){if(!this._callbackCalled){var n=e.getName();if(n===zr.o){var a=this._getControlParameter(r,zr.l);if(this._controlsShouldRender.indexOf(a)>=0&&-1===this._renderedControls.indexOf(a)){this._viewportRenderTime<t&&(this._viewportRenderTime=t);var i=this._getControlParameter(r,zr.n);this._controlTypeCounts[i]?this._controlTypeCounts[i]++:this._controlTypeCounts[i]=1,this._renderedControls.push(a),this._renderedControls.length===this._controlsShouldRenderCount&&(this._callbackCalled=!0,this._callback(this._viewportRenderTime,this._controlTypeCounts))}}else 0===this._controlsShouldRenderCount&&n===zr.i&&(this._callbackCalled=!0,this._callback(t,this._controlTypeCounts))}},e.prototype._getControlParameter=function(e,t){var r=e[t];return r||null},e}();var Xr=r("RXRQ");var Wr=r("1z64"),Hr=r("+Z9T");function Qr(e){var t=[];return{type:"powerbidashboard.create",execute:function(r,n,a){var i=r.dispatch;return t.push({name:Bt.a.CorrelationId,value:a.correlationId},{name:Bt.a.ContextId,value:a.contextId}),i(mr(e)).then((function(e){e&&0===e.status?i(Object(ar.a)(e.pageId)).then((function(){n.EventManager.ReportComponentSuccess("DashboardCommand.PowerBiDialog")})):(t.push({name:Bt.a.ActionStack,value:a.stack}),n.EventManager.ReportComponentFailure("DashboardCommand.PowerBiDialog",e.error,"",t))}))},getFailureParameters:function(){return t}}}var Yr=r("zETL"),Kr=r("ildB"),Jr=r("3OsR"),Zr=r("I6xF");function $r(e,t){return{type:"dashboard.refresh",execute:function(r,n){var a=r.dispatch,i=(0,r.getState)(),o=je(i,e,t);for(var s in o){var c=o[s];a(Object(Yr.b)(t,c))}for(var l=0,u=function(e,t,r){return Ee(e,t,r,pe)}(i,e,t);l<u.length;l++){var d=u[l];a(Object(Kr.o)(d.LabelId,Jr.a.InitiateRefresh,1,null))}for(var p=function(e,t,r){return Ee(e,t,r,he,ge)}(i,e,t),h=Object(y.j)(i,e),g=0,m=p;g<m.length;g++){var f=m[g],b=Me(f),v=b.isSupported;b.isWebResource&&!v||en(i,n,t,h,f)}return a(Object(Zr.b)(t,"Refresh")),Promise.resolve()}}}function en(e,t,r,n,a){var i=Object(F.xb)(e,r,a.Name);if(!i){var o=n.Sections[a.ParentSectionName],s=u.a.toString(null==o?void 0:o.Id);i=Object(F.xb)(e,r,s+"_"+a.Name)}i?i.src=i.src:t.TraceManager.getTracer("dashboard.refresh").warn("Could not find iframe to refresh",[{name:"ControlName",value:a.Name},{name:"DashboardId",value:u.a.toString(n.Id)}])}var tn=r("KT6S"),rn=r("Xlzu"),nn=r("epR8"),an=r("zEjV"),on=r("Kn4q");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var sn=["Button_Label_Delete","Button_Label_Cancel","Button_Label_Assign","Dialog_Delete_Title","Dialog_Delete_Description","Dialog_Assign_Title","Dialog_Assign_DescriptionSingular","RelatedInformation_Category_FollowUp_Label_AssignTo","SystemCustomization.OwnershipType.UserOwned"],cn=r("12y7"),ln=r("KvcU"),un=r("+XB9"),dn=r("d/U0");function pn(e,t){var r=[],n="DashboardCommand.DeleteDashboard";return r.push({name:Bt.g.ComponentName,value:n}),r.push({name:Bt.b.DashboardId,value:u.a.toString(e)}),{type:"dashboard.delete",execute:function(a,i,o){var s=a.dispatch,c=a.getState;r.push({name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId});var l=c(),u=Object(v.b)(l,"Dialog_Delete_Title"),d=Object(I.h)(l,"userform"),p=String.format(Object(v.b)(l,"Dialog_Delete_Description"),(null==d?void 0:d.DisplayName)||"User Dashboard"),h=Object(v.b)(l,"Button_Label_Delete"),g=Object(v.b)(l,"Button_Label_Cancel");return s(Object(cn.a)(p,{},u,t,"",h,g)).then((function(a){return 0===a.status?s(Object(ar.a)(a.pageId)).then((function(a){var l;if(null===(l=null==a?void 0:a.value)||void 0===l?void 0:l.confirmed){s(Object(ur.b)(null));var u=new At.a("userform",e);s(Object(kt.c)(u)).then((function(){var r=Object(O.d)(c(),e);s(Object(dn.b)(t,!0,r)),s(Object(ln.c)(e,Object(ae.b)(c()))),s(Object(un.b)(u)),Promise.all([s(Object(tn.a)()),s({type:"usermetadataversion.retrieve.async",execute:function(e,t){var r=e.dispatch;return e.getState,r(Object(rn.b)(nn.a.UserMetadataVersion,null,null,null,!1,an.a.OnDemandWithoutContext,null,null,[],null,on.a.Remote)).catch(lr.b)}})]).then((function(){s(Object(or.d)(null,void 0,void 0,void 0,!0,!0)).then((function(e){s(Object(dr.b)()),s(Object(sr.a)(null,e,void 0,void 0,void 0,!0,t)),i.EventManager.ReportComponentSuccess(n)}))}))}),(function(a){s(Object(sr.a)(null,e,void 0,void 0,void 0,!1,t)),s(Object(dr.b)()),r.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure(n,a,"",r);var c=new lr.a(a.message,a.errorCode);s(Object(cr.b)(c,!0,t))}))}else i.EventManager.ReportComponentSuccess(n)})):Promise.reject(a.error)}))},getFailureParameters:function(e,t){return r.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),r}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function hn(e,t){var r="DashboardCommand.ShareDashboard",n=[];return n.push({name:Bt.g.ComponentName,value:r}),n.push({name:Bt.b.DashboardId,value:u.a.toString(e)}),{type:"dashboard.share",execute:function(a,i,o){var s=a.dispatch,c=(0,a.getState)(),l=Object(hr.i)(c),d=""+Object(tr.b)()+Object(rr.a)(c,"/_grid/cmds/dlg_share.aspx")+"?dType=1&iObjType="+1031..toString()+"&iTotal=1&sIds={"+u.a.toString(e)+"}";return l&&(d+="&appid="+l),new Promise((function(a){n.push({name:Bt.b.LegacyDialogUrl,value:d},{name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId});var c=[u.a.toString(e)];s(Object(ur.b)(null)),s(Object(nr.a)(d,{windowPosition:"center",width:885,height:500},c,t)).then((function(e){s(Object(dr.b)()),0===e.status?i.EventManager.ReportComponentSuccess(r):(n.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure(r,e.error,"",n))})),a()}))},getFailureParameters:function(e,t){return n.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),n}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var gn=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"Assign",operationType:0,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},Assignee:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}}}},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function mn(e,t){var r=[],n="DashboardCommand.AssignDashboard";return r.push({name:Bt.g.ComponentName,value:n}),r.push({name:Bt.b.DashboardId,value:u.a.toString(e)}),{type:"dashboard.assign",execute:function(a,i,o){var s,c=a.dispatch;r.push({name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId});var l=[new At.a("userform",e)],d=((s={}).entity_id=u.a.toString(e),s.entity_name="userform",s.entityTypeCode=1031..toString(),s.entity_records=l,s.selected_records_count=1,s.last_button_clicked="",s.owner_id="",s.owner_type="",s);return c(Object(Qt.b)("Assign",{},d,t)).then((function(a){return 0===a.status?c(Object(ar.a)(a.pageId)).then((function(a){var s;if("ok_id"===(null===(s=null==a?void 0:a.value)||void 0===s?void 0:s.last_button_clicked)){var l=a.value,u=l.owner_id,d=l.owner_type,p=l.entity_name,h=l.entity_id,g=new gn;g.Target={id:h,entityType:p},g.Assignee={id:u,entityType:d},c(Object(ur.b)(null)),c(Object(wr.b)(g)).then((function(e){e.ok&&c(Object(or.d)(null,void 0,void 0,void 0,!0,!0)).then((function(e){c(Object(sr.a)(null,e,void 0,void 0,void 0,!0,t)),c(Object(dr.b)())})),i.EventManager.ReportComponentSuccess(n)}),(function(a){c(Object(sr.a)(null,e,void 0,void 0,void 0,!1,t)),c(Object(dr.b)()),r.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure(n,a,"",r);var s=new lr.a(a.message,a.errorCode);c(Object(cr.b)(s,!0,t))}))}else i.EventManager.ReportComponentSuccess(n)})):Promise.reject(a.error)}))},getFailureParameters:function(e,t){return r.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),r}}}var fn,bn=r("As2E"),vn=function(){function e(e,t,r){var n=[{name:"store",value:e,isRequired:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutor=new Wr.a(e,"ClientApi.XrmDashboardCommands.",r,t,n),fn=e,this._pageId=r}return e.prototype._executeCommand=function(e,t,r){return this._clientApiExecutor.executeAsync(e,(function(){var e=t();return fn.dispatch(e)}),r)},e.prototype._executeDashboardIdCommand=function(e,t,r,n,a){var i=this;void 0===n&&(n=!1);var o=u.a.tryParseOrNull(t),s={name:"dashboardId",value:o&&t,isRequired:!0,isEventParam:!0,expectedDataType:"string"},l=Object(c.__spreadArrays)([s],a||[]);this._executeCommand(e,(function(){if(!n&&Object(b.a)(fn.getState(),o)){var t=i._clientApiExecutor.getComponentName(e);Object(Hr.j)(t,"isBoundDashboard")}return r(o)}),l)},e.prototype.createNewDashboard=function(){var e=this;this._executeCommand("createNewDashboard",(function(){return qn(e._pageId)}))},e.prototype.createNewPowerBIDashboard=function(){var e=this;this._executeCommand("createNewPowerBIDashboard",(function(){return Qr(e._pageId)}))},e.prototype.setUserDefaultDashboard=function(e){return this._executeCommand("setUserDefaultDashboard",(function(){return Wt(u.a.tryParseOrNull(e)||u.a.EMPTY)}))},e.prototype.refreshDashboard=function(e){var t=this;this._executeDashboardIdCommand("refreshDashboard",e,(function(e){return $r(e,t._pageId)}),!0)},e.prototype.saveDashboardAs=function(e){var t=this;this._executeDashboardIdCommand("saveDashboardAs",e,(function(e){return pr(e,t._pageId)}),!1)},e.prototype.editDashboard=function(e){var t=this;this._executeDashboardIdCommand("editDashboard",e,(function(e){return Un(t._pageId,e)}))},e.prototype.deleteDashboard=function(e){var t=this;this._executeDashboardIdCommand("deleteDashboard",e,(function(e){return pn(e,t._pageId)}),!1)},e.prototype.shareDashboard=function(e){var t=this;this._executeDashboardIdCommand("shareDashboard",e,(function(e){return hn(e,t._pageId)}),!1)},e.prototype.assignDashboard=function(e){var t=this;this._executeDashboardIdCommand("assignDashboard",e,(function(e){return mn(e,t._pageId)}),!1)},e.prototype.openInPowerBI=function(e){this._executeDashboardIdCommand("openInPowerBI",e,(function(e){return Object(bn.a)(e)}))},e}(),yn=r("LBS5"),_n=r("upK2"),On=r("NUwQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Sn(e,t,r){return void 0===r&&(r=!1),{type:"dashboard.setUpdatedControlParameters",sync:!0,execute:function(n){var a=n.getState,i=n.dispatch,o=Object(g.g)(a(),e),s=o.updatedControlParameters||{},l=Object(c.__assign)({},t),u=[];for(var d in l){u.push(d);var p=s[d],h=l[d];r?l[d]=Object(c.__assign)(Object(c.__assign)({},p),h):!Cn(h)&&Cn(p)&&(l[d]=Object(c.__assign)(Object(c.__assign)({},h),In(p)))}for(var d in s)if(-1===u.indexOf(d)){p=s[d];r?l[d]=p:Cn(p)&&(l[d]=In(p))}var m=Object(c.__assign)(Object(c.__assign)({},o),{updatedControlParameters:l});i(Object(Kt.b)(m,e))}}}function Cn(e){return e&&e.hasOwnProperty("FirstDataRequestType")}function In(e){var t;return(t={}).FirstDataRequestType=e.FirstDataRequestType,t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function jn(e,t,r){var n,a;return Sn(e,((n={})[t]=((a={}).FirstDataRequestType=r,a),n),!0)}function Pn(e,t,r,n,a,i){var o=function(e){var t={},r=function(){return[{name:Bt.b.RetrievedDashboardId,value:u.a.toString(t.retrievedId)},{name:Bt.b.DashboardTypeFlags,value:t.dashboardTypeFlags},{name:Bt.b.BoundDashboardEntity,value:t.boundDashboardEntity}]};return{parameters:t,initializeParameters:function(e,r){return e&&Object.assign(t,e),r&&Object.assign(t,r),t},getTelemetryParameters:function(){return Object(c.__spreadArrays)(Object(_n.a)(t,e),r())},getCommonKPIParameters:function(e){return t.boundDashboardEntity=Object(b.a)(e,t.retrievedId),t.dashboardTypeFlags=function(e,t){if(Object(b.i)(t))return 4;var r=0,n=Object(b.a)(e,t),a=Object(se.a)(e,t);if(n&&(r|=2,a||(a=Object(se.a)(e,t,n))&&(r|=64),ye(e,t)?r|=128:_e(e,t)&&(r|=256)),a){if(!n){if(Object(oe.b)(e,t)){r|=32;var i=Object(oe.a)(e,t);"1"===i.Type?r|=512:"2"===i.Type&&(r|=1024)}r|=1}Object(se.c)(a)?r|=8:r|=16}return r}(e,t.retrievedId),Object(On.c)(r())}}}(e),l=o.parameters,d=o.initializeParameters,p=o.getTelemetryParameters,h=o.getCommonKPIParameters,m="dashboard."+e+".async",f=function(){return r((function(e){return{type:m,getFailureParameters:p,execute:function(r,i){var o=r.dispatch,f=r.getState,v=function(e){return e&&o(e)},_=new Sr(i,t,v,p),S=_.setDashboardLoadResult.bind(_),C=function(){return _.finalizeDashboardLoadResult()},P=Object(g.g)(f(),t),T=d(P,e),E=T.dashboardId,F=T.retrievedId,A=T.error;u.a.isNullOrEmpty(F)||u.a.equals(E,F)||v(Object(Kt.b)(Object(c.__assign)(Object(c.__assign)({},P),{dashboardId:F}),t));var N=Object(O.d)(f(),F),D=n(f,v,i,t,N,l);if(A)return D(E),S(-1,A),C();var M=h(f());jr.a.addCommonKpiParameters(M,!0);var R=Object(y.j)(f(),F);return function(e,t,r,n){var a=r.retrievedId,i=r.boundDashboardEntity,o=!a||!t;if(Object(ae.b)(e)){if(o)return n(-1,"Could not retrieve dashboard."),!1}else if(o||i)return n(2,i?"Bound dashboard is not available while user is offline":"Sorry, Dashboard is not available while you're offline. Reconnect to see updated results"),!1;return!0}(f(),R,l,S)?(function(e,t,r,n,a,i,o,c,l,d,p){var h=c.dashboardId,g=c.retrievedId,m=c.etn,f=c.showVisualFilters,v=c.showTileView;m||(m=Object(b.a)(t(),g));var y=!!m;r(function(e,t){if(t&&Object(b.i)(t))return{type:"mailApp.prefetchRecipientForms",execute:function(t){var r=t.dispatch,n=t.getState,a=Object(hr.c)(n()),i=(a?a.entities:[]).map((function(e){return e&&e.LogicalName}));for(var o in Fr)if(-1!==i.indexOf(o))for(var s=0,c=Fr[o];s<c.length;s++){var l=c[s];Nr(n,e,r,o,l&&new u.a(l),xr)}return Promise.resolve()}}}(a,h));var _=r(function(e){if(e)return{type:"dashboard.checkEntity",execute:function(t){var r=t.dispatch,n=t.getState;return r(Object(Zt.f)(e,!1,[])).then((function(){var t=Object(I.h)(n(),e),r={status:5};if(t&&t.Initialized===j.a.Initialized){var a=!t.IsEnabledInUnifiedInterface,i=!Object(k.g)(n(),e,2,0);a?(r.status=0,r.error=e+" is not enabled for UCI"):i&&(r.status=1,r.error="User does not have "+e+" read privilege in UCI")}return r}))}}}(m));p(_);var O=r(Object(Dr.h)(g,a,i,null,ve)).then((function(){return d().then((function(){return r(Ar(a,h))})),null})).catch((function(e){return d(),Promise.reject(e)}));p(O);var S=Lr(a,t(),o,f,v),C=S(7),P=S(6),T=function(e,t,r,n){var a=Ce(e,r,n,!0,!0);for(var i in a){var o=a[i];o.savedQueueFilterId&&t(Object(Ur.k)(o.savedQueueFilterId,r,o.contextToken))}return a}(t,r,a,g),E=y&&function(e){for(var t in T){var r=T[t];if(e===r.entityLogicalName&&4&r.streamMode)return!0}return!1},F=y&&function(e,t,r){if(!Object(U.c)(e(),z.q))return null;var n,a=!1;return function(i,o){if(i.entityLogicalName!==r||a)return null;if(!n){var s=Object(J.i)(e());s&&s[r]?a=!0:n=t(Ut(r))}return n?(o.push(n),[n]):void 0}}(t,r,m);(function(e,t,r,n,a){var i=Object(ae.b)(e);for(var o in a){var s=a[o];if(s.hasChart){var c=4&n(s)&&i?2:1;t(jn(r,s.control.Name,c))}}})(t(),r,a,P,T),Object(Gr.a)(t,r,n.TraceManager.getTracer(e),n.EventManager,a,o,null,T,P,E,F,!1,!0),r(function(e,t,r){return{type:"dashboard.loadControlResources",execute:function(n){var a=n.dispatch,i=n.getState;return(Se(i(),t)&&!Object(x.e)(i(),be)?function(e){return a(Object(Xr.c)(be,null,!1)).then(e)}:function(e){return e()})((function(){var n=Ne(i(),e,t,r),o=n.inViewManifests,s=n.outOfViewManifests,c=function(e){for(var t in e){var r=e[t];r&&r.Properties&&r.Properties.Resources&&a(Object(Jt.a)(r))}};c(o),c(s)})),Promise.resolve()}}}(a,g,C)),function(e,t,r,n,a){Vr&&Dt.a.removeTransport(Vr),Vr=new qr(e,t,r,n,(function(e,t){Dt.a.removeTransport(Vr),Vr=null;var r=a(),n={PageName:s.a};n[Bt.b.PageInfraReadyParameters.RenderedControls]=t;for(var i=0,o=r;i<o.length;i++){var c=o[i];Object(w.a)(c.value)||(n[c.name]=c.value)}jr.a.addKeyPerformanceIndicator("PageInfraReady",n,e)})),Dt.a.registerTransport(Vr,[Ir.KPI_ZONE,"PageInfraReady",zr.d])}(t(),a,g,P,l),function(e,t,r,n){if(0===ke(e,r,t)){n(Te(e,r,t).length>0?4:3)}}(t(),a,g,p)}(m,f,v,i,t,N,R,l,p,D,S),a&&a(v,t,l),C()):(D(F||E),C())}}}))};return function(){return{type:"dashboard."+e+"Wrapper.async",getFailureParameters:p,execute:function(e){var t=e.getState,r=e.dispatch;return f(),i(t,r)}}}}function Tn(e,t,r,n,a,i){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];return function(s){var l=Re(e());return(l&&!n&&!s&&o?Promise.all(Object(c.__spreadArrays)(o,[i])):i).then((function(){l&&(n||(s||(s=Object(se.b)(e(),a)),n=Object(O.d)(e(),s)),t(En(n,r,a))),t(Object(Cr.a)(!0,r,n))}))}}function En(e,t,r){return Object(yn.a)(e,t,r,(function(e,t,r){return new vn(e,t,r)}))}var wn=r("FinE"),Fn=r("XNwl");function xn(e,t,r){return{type:"dashboard.setTitle",sync:!0,execute:function(n){var a=n.dispatch,i=n.getState,o=Object(b.b)(i(),t,null,r),s=o&&o.Name;if(!s){var c=Object(se.a)(i(),t,r);s=c&&c.DisplayName}a(Object(Fn.c)(e,s))}}}var An=r("xm8q"),Nn=r("okRr");function Dn(e,t){return{type:"dashboard.addToMRU",execute:function(r){var n=r.dispatch,a=r.getState,i=Object(se.a)(a(),e,t);if(t&&!e&&(e=i&&i.Id),i){var o=1030;Object(se.c)(i)&&(o=1031);var s=Object(I.m)(a(),o),c={RecordType:Nn.a.Entity,EntityTypeName:s,LastAccessed:new Date,ObjectId:e,Title:i.DisplayName,IconPath:Object(I.j)(a(),s,e)};n(Object(An.b)(c))}return Promise.resolve()}}}var kn=r("qVYL"),Mn=r("M8mM"),Rn=r("yxK9"),Ln=r("tcXs"),Bn=0;function Vn(e,t){var r,n=new Promise((function(e){return r=e}));return t=Object(c.__assign)(Object(c.__assign)({},t),{pageType:"dashboard"}),Pn("SwitchDashboard",e,(function(e){return n.then((function(t){var r=t[0],n=t[1];return r(e(n))}))}),Gn,null,(function(n,a){Object(Mn.d)(s.a,Object(On.c)(Object(_n.a)(t,"SwitchDashboard")));var i=t.dashboardId,o=t.etn;if(1===++Bn){var c=!!Object(b.b)(n(),i,null,o);jr.a.onNextIdleProcessing(function(e){return function(){var t,r=((t={})[Bt.x.PageName]=s.a,t[Bt.x.LoadType]=(e?3:1).toString(),t[Bt.b.PageLoadParameters.NavigationOrigin]=s.a,t);jr.a.addCommonKpiParameters(r),jr.a.addMetadataToTimeline(r),e&&Object(Rn.b)(),Bn=0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(c))}return a(Object(kn.a)(t)),a(Object(Kt.b)(t,e)),a(Object(wn.a)(t)).then((function(e){return r([a,e])})),a(xn(e,i,o)),a(Dn(i,o)),Promise.resolve()}))()}function Gn(e,t,r,n,a,i){var o=i.etn;r.ScriptManager.removeContainer(n,!0);var s=r.ScriptManager.initializeContainerForClientApi(n),c=Tn(e,t,n,a,o,s);return Re?function(e){return c(e).then((function(){t(Object(Ln.a)(n))}))}:c}function Un(e,t,r){var n=[];return n.push({name:Bt.g.ComponentName,value:"DashboardCommands.EditDashboard"}),n.push({name:Bt.b.DashboardId,value:u.a.toString(t)}),{type:"dashboard.edit",execute:function(a,i,o){var s=a.getState,c=a.dispatch;try{var l=s(),d=u.a.isNullOrEmpty(t);if(!d&&Object(oe.b)(l,t))return c(mr(e,t));n.push({name:Bt.a.CorrelationId,value:o.correlationId},{name:Bt.a.ContextId,value:o.contextId},{name:Bt.b.DashboardCommandsParameters.IsPowerBIDashboard,value:!1});var p="/main.aspx?extraqs=%26"+(d?"layoutId="+r:"formId="+u.a.toString(t))+"%26dashboardType=1031&pagetype=dashboardeditor",h=Object(rr.a)(s(),p);n.push({name:Bt.b.LegacyDialogUrl,value:h});var g=Object(A.c)(l),m=Object(A.b)(l),f={},b=Object(v.b)(l,"Dashboard_Editor_Open_Title"),y=Object(v.b)(l,"Dashboard_Editor_Open_Message"),_=Object(v.b)(l,"Dashboard_Editor_Open_Confirm_Button");f.text=b+"\n"+y,f.confirmButtonLabel=_;var O,S=window.open(h,"_blank","width="+g+", height="+m+", resizable=1, align-item=center, justify-content=center");S.IsHybridAF=!0;var C=function(r){var n;(n=r)&&n.origin===window.location.origin&&n.data&&n.data.formId&&(window.top.removeEventListener("message",C),O&&(S.close(),c(Object(br.e)(O)).then((function(){var n=d?new u.a(r.data.formId):t;c(zn(e,n,d))}))))};return c(Object(fr.a)(f,{height:180,width:360},e)).then((function(e){0===e.status&&(O=e.pageId,c(Object(ar.a)(O)).then((function(){O=null,window.top.removeEventListener("message",C)})))})),window.top.addEventListener("message",C),Promise.resolve()}catch(e){return n.push({name:Bt.a.ActionStack,value:o.stack}),i.EventManager.ReportComponentFailure("DashboardCommands.EditDashboard",e,"",n),Promise.reject(e)}},getFailureParameters:function(e,t){return n.push({name:Bt.b.DashboardCommandsParameters.Error,value:e},{name:Bt.b.DashboardCommandsParameters.Failure,value:t}),n}}}function zn(e,t,r){return{type:"dashboard.edit.navigate",execute:function(n){var a=n.dispatch;return r?a(Object(sr.a)(null,t,null,null,or.b,!1,e)):a(Object(or.d)(null,t,null,or.b,!1,!0)).then((function(t){return a(Vn(e,{dashboardId:t,type:or.b}))}))}}}function qn(e){var t=[];return{type:"dashboard.create",execute:function(r,n,a){var i=r.dispatch,o=r.getState;t.push({name:Bt.a.CorrelationId,value:a.correlationId},{name:Bt.a.ContextId,value:a.contextId});var s=Object(hr.i)(o()),c=""+Object(tr.b)()+Object(rr.a)(o(),"/tools/dashboardeditor/dialogs/dashboardlayoutdialog.aspx")+"?dType=1";s&&(c+="&appid="+s);return i(Object(nr.a)(c,{width:800,height:480},{uciCallback:function(t){return i(Un(e,null,t))}},e)).then((function(e){e&&0===e.status?n.EventManager.ReportComponentSuccess("DashboardCommand.NewDashboardDialog"):(t.push({name:Bt.a.ActionStack,value:a.stack}),n.EventManager.ReportComponentFailure("DashboardCommand.NewDashboardDialog",e.error,"",t))}))},getFailureParameters:function(){return t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Xn=function(){function e(){this._showSetAsDefaultButton=!1,this._isUserDashboard=!1}return e.prototype.haveResourceStringsChanged=function(e){return!this._ribbonLabels||this._ribbonLabels.refresh!==e.ribbonLabels.refresh||this._ribbonLabels.setAsDefault!==e.ribbonLabels.setAsDefault||this._ribbonLabels.unsetDefault!==e.ribbonLabels.unsetDefault||this._ribbonLabels.yammerLabelInDashboards!==e.ribbonLabels.yammerLabelInDashboards||this._ribbonLabels.editDashboard!==e.ribbonLabels.editDashboard||this._ribbonLabels.deleteDashboard!==e.ribbonLabels.deleteDashboard||this._ribbonLabels.shareDashboard!==e.ribbonLabels.shareDashboard||this._ribbonLabels.assignDashboard!==e.ribbonLabels.assignDashboard||this._ribbonLabels.createNewDashboard!==e.ribbonLabels.createNewDashboard||this._ribbonLabels.createNewDashboardTooltip!==e.ribbonLabels.createNewDashboardTooltip||this._ribbonLabels.createDynamicsDashboard!==e.ribbonLabels.createDynamicsDashboard||this._ribbonLabels.createDynamicsDashboardTooltip!==e.ribbonLabels.createDynamicsDashboardTooltip||this._ribbonLabels.createPowerBIDashboard!==e.ribbonLabels.createPowerBIDashboard||this._ribbonLabels.createPowerBIDashboardToolTip!==e.ribbonLabels.createPowerBIDashboardToolTip},e.prototype.updateResourceStrings=function(e){this._ribbonLabels=e.ribbonLabels},e.prototype.needsRefresh=function(e){if(this._memoizedDashboardId&&!u.a.equals(this._memoizedDashboardId,this._getDashboardId(e)))return!0;var t=this._checkForDashboardIds(e).hasPossibleDashboardId;if(this._isUserDashboard!==this._getIsUserDashboard(e,t))return!0;var r=!(e.isServerOffline||e.isEntityBoundDashboard||e.defaultDashboardId&&u.a.equals(e.defaultDashboardId,e.formId||u.a.EMPTY)),n=e.defaultDashboardId&&e.defaultDashboardId.guid;if(this._showSetAsDefaultButton!==r||this._defaultDashboardId!==n)return!0;var a=e.userDashboardPrivileges;if(this._memoizedUserDashboardPrivileges&&a){if(Object.keys(this._memoizedUserDashboardPrivileges).length!==Object.keys(a).length)return!0;for(var i in a)if(a[i]!==this._memoizedUserDashboardPrivileges[i])return!0}return!1},e.prototype.getCommandButtons=function(e,t){var r=[],n=e(),a=this._checkForDashboardIds(n),i=a.hasActualDashboardId,o=a.hasPossibleDashboardId;this._memoizedDashboardId=this._getDashboardId(n);var s=n.isEntityBoundDashboard;this._showSetAsDefaultButton=!(n.isServerOffline||s||n.defaultDashboardId&&u.a.equals(n.defaultDashboardId,this._getDashboardId(n))),this._defaultDashboardId=n.defaultDashboardId&&n.defaultDashboardId.guid,this._isUserDashboard=this._getIsUserDashboard(n,o);var c=function(e){return n.userDashboardPrivileges&&n.userDashboardPrivileges[e]};if(this._memoizedUserDashboardPrivileges=n.userDashboardPrivileges,!n.isRibbonCustomizable){var l=i||o;n.hybridButtonsOnUCIEnabled&&c(1)&&(l&&this._isUnboundDashboard(n,o)&&r.push(this._createSaveAsButton(e)),r.push(this._createNewDashboardFlyoutButton(e))),l&&(n.hybridButtonsOnUCIEnabled&&this._isUserDashboard&&(c(3)&&r.push(this._createEditButton(e)),c(4)&&r.push(this._createDeleteButton(e))),this._showSetAsDefaultButton?r.push(this._createTogglesetDefaultButton(e,t,!0)):n.isServerOffline||s||!n.isUnsetDefaultDashboardFeatureEnabled||r.push(this._createTogglesetDefaultButton(e,t,!1)),n.hybridButtonsOnUCIEnabled&&this._isUserDashboard&&(c(6)&&r.push(this._createShareButton(e)),c(5)&&r.push(this._createAssignButton(e))),r.push(this._createRefreshButton(e)))}return function(e){return!(e.isServerOffline||e.clientHostType!==Ht.a.Browser||e.isOnPremise||!e.yammerPostsOnUCIEnabled||null===e.yammerNetworkName||void 0===e.yammerNetworkName||null===e.yammerGroupId||void 0===e.yammerGroupId||null===e.yammerOAuthAccessTokenExpired||void 0===e.yammerOAuthAccessTokenExpired||!0===e.yammerOAuthAccessTokenExpired)}(n)&&r.push(this._createYammerButton(e)),r},e.prototype._checkForDashboardIds=function(e){var t=!u.a.isNullOrEmpty(e.formId);return{hasActualDashboardId:t,hasPossibleDashboardId:!t&&!u.a.isNullOrEmpty(e.selectedDashboardId)}},e.prototype._getDashboardId=function(e){return u.a.isNullOrEmpty(e.formId)?!u.a.isNullOrEmpty(e.selectedDashboardId)?e.selectedDashboardId:u.a.EMPTY:e.formId},e.prototype._isUnboundDashboard=function(e,t){var r=t&&we(e.dashboardSelectorItems,e.selectedDashboardId);return r?r.iconType!==P.a.InteractiveDashboard:e.dashboardType===Yt.Unbound},e.prototype._getIsUserDashboard=function(e,t){var r=t&&we(e.dashboardSelectorItems,e.selectedDashboardId);return r?r.categoryId===1031..toString():!e.isServerOffline&&e.isUserDashboard},e.prototype._createNewDashboardFlyoutButton=function(e){var t=[];return t.push(this._createNewDynamicsDashboardButton(e)),e().isPowerBiEnabled&&t.push(this._createNewPowerBIDashboard(e)),{Icon:"New",DisplayText:e().ribbonLabels.createNewDashboard,Tooltip:{title:e().ribbonLabels.createNewDashboardTooltip},Id:"CreateNewDashboardFlyout",WillOpenFlyout:!0,Children:t}},e.prototype._createNewDynamicsDashboardButton=function(e){return{Icon:"CardsDashboard",DisplayText:e().ribbonLabels.createDynamicsDashboard,Tooltip:{title:e().ribbonLabels.createDynamicsDashboardTooltip},Id:"CreateDynamicsDashboard",execute:qn(e().id)}},e.prototype._createNewPowerBIDashboard=function(e){return{Icon:"OpenInPowerBI",DisplayText:e().ribbonLabels.createPowerBIDashboard,Tooltip:{title:e().ribbonLabels.createPowerBIDashboardToolTip},Id:"CreatePowerBiDashboard",execute:Qr(e().id)}},e.prototype._createTogglesetDefaultButton=function(e,t,r){var n=r?e().isUnsetDefaultDashboardFeatureEnabled?"SetDefault":"Pin":"ClearDefault",a=r?e().ribbonLabels.setAsDefault:e().ribbonLabels.unsetDefault,i=r?this._getDashboardId(e()):u.a.EMPTY;return{Icon:n,DisplayText:a,Tooltip:{title:a},Id:"SetDefaultDashboard",execute:{type:"dashboard.setdefault.async",execute:function(e){return(0,e.dispatch)(Wt(i)).then((function(){return t(),Promise.resolve()}))}}}},e.prototype._createYammerButton=function(e){return{Icon:"YammerIcon",DisplayText:e().ribbonLabels.yammerLabelInDashboards,Tooltip:{title:e().ribbonLabels.yammerLabelInDashboards},Id:"YammerDashboard",execute:{type:"dashboard.yammer",execute:function(t){var r,n,a,i;return(0,t.dispatch)((r=e().yammerGroupId,n=e().yammerNetworkName,a=e().yammerPostMethod,i=e().id,{type:"dashboard.yammer",execute:function(e){var t=e.dispatch,o="",s="";null!=r&&(o=r.toString()),null!=a&&(s=a.toString());var c={param_feedType:"group",param_yammerNetwork:n,param_yammerGroupId:o,param_yammerPostMethod:s};t(Object(Qt.b)("YammerDialog",{height:2e3,width:500,windowPosition:"side"},c,i))}})),Promise.resolve(!0)}}}},e.prototype._createRefreshButton=function(e){return{Icon:"Refresh",DisplayText:e().ribbonLabels.refresh,Tooltip:{title:e().ribbonLabels.refresh},Id:"RefreshDashboard",execute:$r(this._getDashboardId(e()),e().id)}},e.prototype._createEditButton=function(e){return{Icon:"Edit",DisplayText:e().ribbonLabels.editDashboard,Tooltip:{title:e().ribbonLabels.editDashboard},Id:"EditDashboard",execute:e().isPowerBIDashboard?mr(e().id,this._getDashboardId(e())):Un(e().id,this._getDashboardId(e()))}},e.prototype._createDeleteButton=function(e){return{Icon:"Delete",DisplayText:e().ribbonLabels.deleteDashboard,Tooltip:{title:e().ribbonLabels.deleteDashboard},Id:"DeleteDashboard",execute:pn(this._getDashboardId(e()),e().id)}},e.prototype._createShareButton=function(e){return{Icon:"Share",DisplayText:e().ribbonLabels.shareDashboard,Tooltip:{title:e().ribbonLabels.shareDashboard},Id:"ShareDashboard",execute:hn(this._getDashboardId(e()),e().id)}},e.prototype._createAssignButton=function(e){return{Icon:"Assign",DisplayText:e().ribbonLabels.assignDashboard,Tooltip:{title:e().ribbonLabels.assignDashboard},Id:"AssignDashboard",execute:mn(this._getDashboardId(e()),e().id)}},e.prototype._createSaveAsButton=function(e){return{Icon:"SaveAndEdit",DisplayText:e().ribbonLabels.saveAsDashboard,Tooltip:{title:e().ribbonLabels.saveAsDashboard},Id:"SaveAsDashboard",execute:pr(this._getDashboardId(e()),e().id)}},e}(),Wn=function(){function e(){this._isPowerBIDashboard=!1}return e.prototype.haveResourceStringsChanged=function(e){return!this._ribbonLabels||this._ribbonLabels.openInPowerBI!==e.ribbonLabels.openInPowerBI},e.prototype.updateResourceStrings=function(e){this._ribbonLabels=e.ribbonLabels},e.prototype.needsRefresh=function(e){return this._isPowerBIDashboard!==e.isPowerBIDashboard||this._isPowerBIDashboard&&!u.a.equals(this._dashboardId,e.formId)},e.prototype.getCommandButtons=function(e){var t=e();this._isPowerBIDashboard=t.isPowerBIDashboard,this._dashboardId=t.formId;var r=[],n=u.a.isNullOrEmpty(t.formId)&&!u.a.isNullOrEmpty(t.selectedDashboardId)&&we(t.dashboardSelectorItems,t.selectedDashboardId);return n&&(this._isPowerBIDashboard=n.iconType===P.a.OpenInPowerBI),!t.isRibbonCustomizable&&this._isPowerBIDashboard&&r.push(this._createOpenInPowerBIButton(e)),r},e.prototype._createOpenInPowerBIButton=function(e){return{Icon:"OpenInPowerBI",DisplayText:e().ribbonLabels.openInPowerBI,Tooltip:{title:e().ribbonLabels.openInPowerBI},Id:"OpenInPowerBI",execute:Object(bn.a)(e().formId)}},e}(),Hn=r("JyJQ"),Qn=r("hPFj"),Yn=r("e9UD"),Kn=r("DgF7"),Jn=r("Wi7Z"),Zn=r("QJW6"),$n=r("Md8f"),ea=r("9S+1"),ta=r("TCzx"),ra=r("oVzJ"),na=r("ah4O"),aa=r("pJ3X"),ia=r("RB3d"),oa=r("MGMD");function sa(e){var t,r=e.isSingleColumnLayout,n=e.items,a=e.selectedId,i=e.style,o=e.entityLogicalName,s=e.pageId,p=e.onBeforeSwitch,h=Object(d.c)(),g=Object(d.d)(ra.b),m=Object(d.d)(J.g),f=Object(d.d)((function(e){return function(e,t){var r=Object(v.e)(e,t.labelList);return Object(v.c)(r,t.DASHBOARD_SELECTOR_TOOLTIP)}(e,D)})),b=Object(d.d)((function(e){return g||Object(U.c)(e,"FCB.AllowSwitchDashboard")})),y=Object(d.d)((function(e){return Object(U.a)(e,z.le,z.h)})),_=function(e){if(e!==a){for(var t=new u.a(e),r=or.a,i=0,c=n.options;i<c.length;i++){var l=c[i];if(l.value===e){l.categoryId===1031..toString()&&(r=or.b);break}}b?(p&&p(t),h(Vn(s,{dashboardId:t,etn:o,type:r}))):h(Object(sr.a)(null,t,null,o,r,!1,s))}};return n&&n.options.length>0&&n.categories?g?l.createElement(aa.c,{pageId:s},l.createElement(aa.k,{items:n.options,selectedItemId:a,onChange:_})):l.createElement(na.a,Object(c.__assign)({key:"DashboardSelector",id:"Dashboard_Selector",value:a,title:f,categories:n.categories,options:n.options,style:i.dashboardSelectorStyle,caretType:P.a.ChevronDownMed,caretStyle:r?i.dashboardSelectorCaretStyleMobile:i.dashboardSelectorCaretStyle,textStyle:r?i.dashboardSelectorTextStyleMobile:i.dashboardSelectorTextStyle,viewSelectorStyle:r?i.dashboardSelectorViewSelectorStyleMobile:i.dashboardSelectorViewSelectorStyle,onChange:_,createAccessibilityComponent:ia.a,createKeyboardShortcut:ia.b,parentCustomControlId:fe,isRTL:m,useHeader:!0},((t={})[oa.a.LearningPathDOMAttributeName]="Dashboard_Selector",t),{useViewSelectorV2:y})):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ca={Id:"Dashboard_DateRangeFilter",DomId:"Dashboard_DateRangeFilter",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1},la={FormFactor:2,CustomControlId:"MscrmControls.DateRangeControl.DateRangeFilterControl",Name:name,Version:"1.0.0",ShouldOverrideControlVisible:!1,Parameters:{value:{Type:"DateRange"}}};function ua(e){var t,r=e.children,n=Object(d.d)(ra.b),a={display:"flex",flexDirection:"row",backgroundColor:(t=Object(d.d)(N.a)).colors.BaseColor.White,paddingTop:t.sizes.Measures.Measure100,paddingBottom:t.sizes.Measures.Measure100,justifyContent:"space-between",width:"auto",minWidth:"0",paddingLeft:t.sizes.Measures.Measure100,paddingRight:t.sizes.Measures.Measure100};return n?l.createElement(p.a,{key:"dataRangeFilterContainer",id:"dataRangeFilterContainer",style:a},r):null}function da(e){var t,r=e.id,n=e.formId,a=e.isSingleColumnLayout,i=e.dashboardCachedColumns,o=e.dashboardCachedWdith,s=e.contextToken,u=Object(d.c)(),h=Object(d.d)(ra.b),f=Object(d.d)(A.c),v=Object(d.d)((function(e){return Object(g.g)(e,r)})),y=Object(d.d)((function(e){return Se(e,n)})),_=Object(d.d)((function(e){return function(e,t){var r=Se(e,t),n=Object(b.a)(e,t);if(r&&n){var a=Object(C.a)(e,n,r);if(a&&a.DisplayName)return a.DisplayName}return null}(e,n)})),O=Object(d.d)((function(e){return Oe(e,n)})),S=Object(d.d)((function(e){return Object(U.a)(e,z.Pd,z.h)})),I=Object(d.d)(J.g),j=Object(c.__assign)({display:"flex",alignItems:"center"},!a&&S&&((t={})[I?"marginLeft":"marginRight"]="24px",t));return Object.assign(la.Parameters,{DateRangeAttribute:{Type:"SingleLine.Text",Value:y,Usage:1,Static:!0},DateRangeTimeframe:{Type:"SingleLine.Text",Value:v.dateRangeTimeFrame?v.dateRangeTimeFrame:O,Usage:1,Static:!0},CustomTimeFrameStartDate:{Type:"SingleLine.Text",Value:v.dateRangeStartDate,Usage:1,Static:!0},CustomTimeFrameEndDate:{Type:"SingleLine.Text",Value:v.dateRangeEndDate,Usage:1,Static:!0},DisplayName:{Type:"SingleLine.Text",Value:_,Usage:1,Static:!0},DashboardColumns:{Type:"Whole.None",Value:a?1:i,Usage:1,Static:!0},DashboardWidth:{Type:"Whole.None",Value:o||f,Usage:1,Static:!0},NotifyOutputOnInitialRender:{Type:"Enum",Value:"no",Usage:1,Static:!0},DateRangeOutput:{Type:"SingleLine.Text",Primary:!0,Static:!1,Usage:2},TimeFrameOutput:{Type:"SingleLine.Text",Primary:!0,Static:!1,Usage:2}}),h&&(delete la.Parameters.DashboardWidth,delete la.Parameters.DashboardColumns),l.createElement(p.a,{key:"Dashboard_DateRangeFilterWrapper",style:j},l.createElement(m.c,{key:"Dashboard_DateRangeFilter",controlId:"Dashboard_DateRangeFilter",id:r,configuration:la,descriptor:ca,parentDefinedControlProps:pa((function(e){var t=e&&e.timeFrame,n=e&&e.filter,a=function(e){if(e&&e.length>=2){var t=27===e[0].conditionOperator?0:1;return e[t]&&e[t].value}}(n),i=function(e){if(e&&e.length>=2){var t=26===e[0].conditionOperator?0:1;return e[t]&&e[t].value}}(n),o=Object(c.__assign)(Object(c.__assign)({},v),{dateRangeTimeFrame:t,dateRangeStartDate:a,dateRangeEndDate:i});u(Object(Kt.b)(o,r))})),parentContextToken:s}))}function pa(e){return{eventListeners:[{eventname:"onFilterChanged",eventhandler:[e]}]}}var ha=r("CMWz");var ga=r("0CEd");function ma(e,t){return{type:"dashboard.retrieveEntityMetadataForDashboardControlsWithErrorEntityMetadata",execute:function(r){var n=r.getState,a=r.dispatch,i=function(e,t,r){var n=[];return Pe(e,t,r,(function(t){if(-1===n.indexOf(t)){var r=Object(I.h)(e,t);(null==r?void 0:r.Initialized)===j.a.Error&&n.push(t)}})),n}(n(),e,t);if(i.length>0){for(var o={},s={entities:{}},c=0,l=i;c<l.length;c++){var u=l[c];o[u]=[],s.entities[u]={Initialized:j.a.Uninitialized}}a(Object(ga.d)(s)),a(Object(Zt.e)(o))}return Promise.resolve()}}}var fa=r("c96h"),ba={width:0,height:0,columns:-1,deviceWidth:0,deviceHeight:0},va=function(e){function t(t){var r=e.call(this,t)||this;return r._CCF_descriptor={Id:"",Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,Parameters:{Dashboard:"",Width:ba.width,Height:ba.height,Columns:ba.columns,StringIds:gr,StreamRecordsPerPage:25,CreateDashboardLayoutBuilder:Rr.create,ToggleGlobalFilterFlyout:!1,CreateStreamControl:X.makeCreate}},r._dashboardCommands=new Xn,r._boundDashboardCommands=new er,r._powerBIDashboardCommands=new Wn,r._hadAnyDashboardIdForCommandBar=!1,r._onScroll=r._onScroll.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r._resetForDashboardSwitch=r._resetForDashboardSwitch.bind(r),r.state=r._getDefaultState(),r}return Object(c.__extends)(t,e),t.prototype._getDefaultState=function(){return{columns:ba.columns,allControlsRendered:!1,width:ba.width,height:ba.height,hideProgressIndicator:-1!==ba.columns}},t.prototype._getDashboardIdForHeaderComponents=function(e){return e||(e=this.props),!u.a.isNullOrEmpty(this.state.nextDashboardId)&&this.state.nextDashboardId||!u.a.isNullOrEmpty(e.formId)&&e.formId||e.selectedDashboardId},t.prototype._hasNextDashboardId=function(){return!u.a.isNullOrEmpty(this.state.nextDashboardId)&&!u.a.equals(this.state.nextDashboardId,this.props.formId)},t.prototype._resetForDashboardSwitch=function(e){Object.assign(this._CCF_descriptor.Parameters,{ScrollTop:0,ToggleGlobalFilterFlyout:void 0,ShowVisualFilters:!1,TileView:!1}),this.setState(Object.assign(this._getDefaultState(),{scrollTop:0,ToggleGlobalFilterFlyout:!1,ShowVisualFilters:!1,TileView:!1,nextDashboardId:e}))},Object.defineProperty(t.prototype,"_controlId",{get:function(){return this.props.isBoundDashboardControlSupported&&this.props.dashboardType&Yt.Bound?be:fe},enumerable:!1,configurable:!0}),t.prototype.componentWillReceiveProps=function(e){this._hasNextDashboardId()&&!u.a.equals(this.props.formId,e.formId)?this.setState({nextDashboardId:null}):(!Object(w.a)(this._currentPageId)&&this._currentPageId!==this.props.id&&this.state.allControlsRendered&&this.setState({allControlsRendered:!1}),(this._currentPageId===this.props.id&&this.props.dashboardType&Yt.Bound&&ya(this.props.refreshCounters,e.refreshCounters,!0)||this.props.id!==e.id&&u.a.equals(this.props.formId,e.formId))&&this.props.refreshDashboard(this.props.formId));var t=!!(e.dashboardType&Yt.Bound);if(!t){var r=this._getSelectedDashboardSelectorOption(e);t=r&&r.iconType===P.a.InteractiveDashboard}this.props.isServerOffline&&!e.isServerOffline?(e.retrieveUserDashboardPrivileges(),e.retrieveErroredEntityMetadata(e.formId),t&&2===e.dashboardLoadStatus&&e.switchDashboard(e.dashboardInput)):!this.props.isServerOffline&&e.isServerOffline&&t&&5===e.dashboardLoadStatus&&e.setDashboardOfflineError()},t.prototype.render=function(){var e=this._renderDashboardAccessibilityComponent("DashboardView"),t=ta.a.getInstance().get_IsBrowserIE()?"":Jn.r;if(this._isErrorPage=null!==this.props.dashboardLoadStatus&&void 0!==this.props.dashboardLoadStatus&&5!==this.props.dashboardLoadStatus,this._isErrorPage){var r=this._isErrorPage?this.props.dashboardErrorMessage||l.createElement(Hn.a,null):null;return l.createElement(p.a,{key:"dashboardRootError",id:"DashboardView",isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:this.props.dashboardViewStyle.dashboardErrorStyle},this._renderPageHeaderButtons(),this._isErrorPage&&this.props.dashboardErrorMessage?l.createElement(Qn.a,{id:"dashboardErrorContainer"+this.props.id,text:r,icon:P.a.DetailsPageClose,iconStyle:{fontSize:"4.5em",color:"red"}}):r,e)}var n=u.a.isNullOrEmpty(this.props.formId)||this._hasNextDashboardId();n||(this._CCF_config=Object(f.y)(this._controlId),this._setOutputLinking(),this._setForbiddenControls(),this.props.dashboardType&Yt.Bound&&this._setAppliedFilterInput(),this._setAdditionalDescriptorParameters());var a=Zn.a.getInstance().getDisableScrollStyle()||!this._isEdge()?"forceNewStackContextInert":"forceNewStackContext";return l.createElement(p.a,{key:"dashboardRoot",id:"DashboardView",testhooks:{id:"DashboardView"},isRequestedMeasuring:!0,onMeasuring:this.onMeasuring,style:this._getDashboardViewStyle(),explicitStyles:a},this._renderPageHeaderButtons(),l.createElement(h.a,{id:"DashboardScrollView",style:this.props.dashboardViewStyle.dashboardScrollViewStyle,role:t,onScroll:this._onScroll},this.props.isInMobileModeForOct2019&&l.createElement(aa.b,{id:"DashboardScrollView"}),!n&&this.state.hideProgressIndicator?this._renderDashboardControl():this._renderProgressIndicator(),e))},t.prototype._isEdge=function(){return ta.a.getInstance().get_IsBrowserEdge()},t.prototype._renderProgressIndicator=function(){return l.createElement(p.a,{key:"dashboardProgressIndicatorContainer",id:"dashboardProgressIndicatorContainer",style:this.props.dashboardProgressIndicatorStyle.progressIndicatorContainerStyleInternal},l.createElement(Yn.a,{key:"dashboard-progress-indicator",id:"dashboard-progress-indicator",testhooks:{id:"dashboard-progress-indicator"},style:this.props.dashboardProgressIndicatorStyle.dashboardProgressIndicatorStyle,progressType:"ring",displayDelay:2e3,active:!0}))},t.prototype._renderDashboardAccessibilityComponent=function(e){var t=e+"Accessibility",r=[];return this.props?r.push(l.createElement(Ft.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:"Dashboard_Selector"})):r.push(l.createElement(Ft.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0})),r},t.prototype._getDashboardViewStyle=function(){return this.props.dashboardViewStyle.dashboardViewStyle},t.prototype._renderDashboardControl=function(){var e=this._controlId;this._CCF_descriptor.Id=e,this._CCF_descriptor.Parameters.Dashboard=e;var t=l.createElement(m.c,{key:e,controlId:fe,id:this.props.id,configuration:this._CCF_config,descriptor:this._CCF_descriptor,parentContextToken:this.props.contextToken,parentDefinedControlProps:this._getParentDefinedProps(),themingData:this._getThemingData()});return this.props.dashboardType&Yt.Bound||this.props.isPowerBIDashboard?l.createElement(l.Fragment,null,l.createElement(ua,null,this._renderDateRangeControl()),l.createElement(p.a,{key:"boundDashboardRoot",id:"BoundDashboardView",style:this.props.dashboardViewStyle.boundDashboardViewStyle},t)):t},t.prototype._getThemingData=function(){return this._themingData&&this._themingData.defaultThemingData.cellHeightInRem===this.props.theme.sizes.Section.cellHeightInRem||(this._themingData={defaultThemingData:{cellHeightInRem:this.props.theme.sizes.Section.cellHeightInRem}}),this._themingData},t.prototype._getParentDefinedProps=function(){return this._parentDefinedProps||(this._parentDefinedProps={eventListeners:[{eventname:"globalfilterclose",eventhandler:[this._closeGlobalFlyout.bind(this)]},{eventname:"allControlsRendered",eventhandler:[this._allControlsRendered.bind(this)]},{eventname:"filtersApplied",eventhandler:[this._filtersApplied.bind(this)]},{eventname:"savedFilterDelete",eventhandler:[this._deleteSavedFilter.bind(this)]},{eventname:"defaultSavedFilterUpdate",eventhandler:[this._updateDefaultSavedFilter.bind(this)]},{eventname:"onFilterSaved",eventhandler:[this._onFilterSaved.bind(this)]},{eventname:"parametersUpdated",eventhandler:[this._parametersUpdated.bind(this)]}]}),this._parentDefinedProps},t.prototype._filtersApplied=function(e){this.props.setDashboardAppliedFilterAndLinkingInput(this.props.dashboardInput,e.appliedFilters,e.linkingInput)},t.prototype._deleteSavedFilter=function(e){this.props.savedFilterDelete(e)},t.prototype._updateDefaultSavedFilter=function(e){this.props.defaultSavedFilterUpdate(e)},t.prototype._onFilterSaved=function(e){this.props.filterSaved(e)},t.prototype._parametersUpdated=function(e){this.props.setUpdatedControlParameters(e)},t.prototype._closeGlobalFlyout=function(){this._setCommandBarNeedsRefresh(),this._CCF_descriptor.Parameters.ToggleGlobalFilterFlyout=void 0,this.setState({ToggleGlobalFilterFlyout:!1})},t.prototype._setOutputLinking=function(){this._CCF_config.Parameters.DateRangeCondition={Type:"SingleLine.Text",Primary:!0,ControlLinked:!0,Static:!1,Usage:1,Value:"Dashboard_DateRangeFilter.DateRangeOutput"};this._CCF_config.Parameters.DateRangeTimeFrame={Type:"SingleLine.Text",Primary:!0,ControlLinked:!0,Static:!1,Usage:1,Value:"Dashboard_DateRangeFilter.TimeFrameOutput"}},t.prototype._setForbiddenControls=function(){this._CCF_config.Parameters.ForbiddenControlIdList={Type:"SingleLine.Text",Primary:!0,ControlLinked:!1,Static:!0,Usage:1,Value:JSON.stringify(this.props.forbiddenUCIControls)}},t.prototype._setAppliedFilterInput=function(){var e={};e.appliedFilters=this.props.dashboardInput&&this.props.dashboardInput.appliedFilter,e.linkingInput=this.props.dashboardInput&&this.props.dashboardInput.linkingInput,this._CCF_config.Parameters.AppliedFilter={Type:"SingleLine.Text",Primary:!0,ControlLinked:!1,Static:!0,Usage:1,Value:JSON.stringify(e)}},t.prototype._setAdditionalDescriptorParameters=function(){this._CCF_descriptor.Parameters.RefreshCounters=this.props.refreshCounters,this._CCF_descriptor.Parameters.DataSetColumns=this.props.dataSetColumns},t.prototype._getColumns=function(e){var t=Br(this.props.theme,e);return 1===t&&this.props.dashboardType&Yt.Bound&&!this._isSingleColumnLayout()&&(t=2),t},t.prototype._allControlsRendered=function(e){var t=!!e.allControlsRendered;this.state.allControlsRendered!==t&&(t&&(this._CCF_descriptor.Parameters.ScrollTop=0),this.setState({allControlsRendered:t}))},t.prototype._onScroll=function(e){var t=this,r=e.target;this.state.allControlsRendered||this.props.dashboardType&Yt.Bound||!r||"DashboardScrollView"!==r.id||!Object(w.a)(this._handleOnScroll)||(this._handleOnScroll=setTimeout((function(){t._handleOnScroll=void 0;var e=r.scrollTop;Object(w.a)(e)||e===t.state.scrollTop||(t._CCF_descriptor.Parameters.ScrollTop=e,t.setState({scrollTop:e}))}),200))},t.prototype.onMeasuring=function(e,t){var r=document.getElementById("DashboardScrollView"),n=0;Object(w.a)(r)||(n=r.offsetWidth-r.clientWidth),e=Math.floor(e)-n,t=Math.floor(t);var a=!(ba.width!==e||this.props.dashboardType&Yt.Bound&&ba.height!==t);if(ba.width=e,ba.height=t,!a){var i=!1,o={},s=this._getColumns(e);ba.columns=s,o.hideProgressIndicator=!0,s!==this.state.columns&&(this._CCF_descriptor.Parameters.Columns=s,o.columns=s,i=!0),e!==this.state.width&&(this._CCF_descriptor.Parameters.Width=e,o.width=e,i=!0),t!==this.state.height&&(this._CCF_descriptor.Parameters.Height=t,o.height=t,this.props.dashboardType&Yt.Bound&&(i=!0)),i&&this.setState(o)}},t.prototype._renderConsoleAppBackButton=function(e){if(!this.props.shouldRenderBackButton)return null;var t={height:"3rem",borderWidth:"0 1px 0 0"};return e&&(t=Object(c.__assign)(Object(c.__assign)({},t),{borderWidth:0,backgroundColor:"transparent"})),l.createElement($n.a,{pageId:this.props.id,overwriteStyle:t})},t.prototype._renderCommandBar=function(){if(this._initializeCommandBar(),this.props.isInMobileModeForOct2019)return l.createElement(Le.a,{commandbarDisplayMode:Be.a.IconLabel,key:"DashboardCommandBar",addedCommandList:this._addedCommandList,iconPosition:Ve.a.Left,id:this.props.id,ribbonId:this.props.isRibbonCustomizable?"Dashboard:null":null,commandManagerId:this.props.id,isDashboardCommandBar:!0});var e=this._isSingleColumnLayout(),t=e?16:this.state.width,r=this.props.dashboardCommandBarStyle,n=e?r.dashboardCommandBarMobileStyle:r.dashboardCommandBarStyle,a=e?r.commandBarWrapperMobileStyle:r.commandBarWrapperStyle;return Object(Be.b)(this.props.commandBarRefreshProps,n,this._isSingleColumnLayout()),l.createElement(p.a,{id:"DashboardGlobalFilterAnchor",key:"DashboardGlobalFilterAnchor",style:a},this._isSingleColumnLayout()?null:this._renderConsoleAppBackButton(!1),l.createElement(Le.a,{commandbarDisplayMode:Be.a.IconLabel,key:"DashboardCommandBar",addedCommandList:this._addedCommandList,iconPosition:Ve.a.Left,id:this.props.id,width:t,ribbonId:this.props.isRibbonCustomizable?"Dashboard:null":null,commandManagerId:this.props.id,commandBarStyle:n,customCommandManagerStyle:r.customCommandManagerStyle,isDashboardCommandBar:!0}))},t.prototype._haveResourceStringsForCommandBarChanged=function(){return!!(this._dashboardCommands.haveResourceStringsChanged(this.props)||this._boundDashboardCommands.haveResourceStringsChanged(this.props)||this._powerBIDashboardCommands.haveResourceStringsChanged(this.props))&&(this._dashboardCommands.updateResourceStrings(this.props),this._boundDashboardCommands.updateResourceStrings(this.props),this._powerBIDashboardCommands.updateResourceStrings(this.props),!0)},t.prototype._initializeCommandBar=function(){var e,t,r,n=this,a=!u.a.isNullOrEmpty(this._getDashboardIdForHeaderComponents());if((this._haveResourceStringsForCommandBarChanged()||this._currentPageId!==this.props.id||this._hadAnyDashboardIdForCommandBar!==a)&&(this._currentPageId=this.props.id,this._hadAnyDashboardIdForCommandBar=a,this._commandBarNeedsRefresh=!0,this._boundDashboardCommands.resetCommands(this.props,this._CCF_descriptor.Parameters,this.state,this._setCommandBarNeedsRefresh.bind(this))),!this._addedCommandList||this._commandBarNeedsRefresh||this._dashboardCommands.needsRefresh(this.props)||this._boundDashboardCommands.needsRefresh(this.props)||this._powerBIDashboardCommands.needsRefresh(this.props)){this._commandBarNeedsRefresh=!1,this._addedCommandList=[];var i=this._boundDashboardCommands.getCommandButtons((function(){return n.props}),this._CCF_descriptor.Parameters,(function(){return n.state}),this.setState.bind(this),this._setCommandBarNeedsRefresh.bind(this),this._isSingleColumnLayout());(e=this._addedCommandList).push.apply(e,i);var o=this._dashboardCommands.getCommandButtons((function(){return n.props}),this._setCommandBarNeedsRefresh.bind(this));(t=this._addedCommandList).push.apply(t,o);var s=this._powerBIDashboardCommands.getCommandButtons((function(){return n.props}));(r=this._addedCommandList).push.apply(r,s)}},t.prototype._setCommandBarNeedsRefresh=function(){this._commandBarNeedsRefresh=!0},t.prototype._renderSelectorRow=function(){if(this._isErrorPage&&(!this.props.dashboardSelectorItems||0===Object.keys(this.props.dashboardSelectorItems).length))return null;var e,t=this._getSelectedDashboardSelectorOption();if(t&&(this._memoizedViewSelectorText&&this._memoizedViewSelectorText!==t.text&&(this._wrapViewSelector=!this._wrapViewSelector),this._memoizedViewSelectorText=t.text,e=l.createElement(sa,{style:this.props.dashboardSelectorStyle,isSingleColumnLayout:this._isSingleColumnLayout(),items:this.props.dashboardSelectorItems,selectedId:u.a.toString(this._getDashboardIdForHeaderComponents())||u.a.EMPTYSTRING,entityLogicalName:this.props.entityLogicalName,pageId:this.props.id,onBeforeSwitch:this._resetForDashboardSwitch})),this.props.isInMobileModeForOct2019)return e;this._wrapViewSelector&&(e=l.createElement(p.a,null,e));var r=[e];if(!this.props.isSuiterDashboard){var n=this._renderSelectorImage(t);r.unshift(n)}var a=[l.createElement(p.a,{key:"DashboardSelector",style:{display:"flex",flexDirection:"row",flex:"1 1 auto",minWidth:this._isSingleColumnLayout()?"0":void 0}},r)];return!this._isErrorPage&&this.props.dashboardType&Yt.Bound&&a.push(this._renderDateRangeControl()),l.createElement(p.a,{key:"selectorRow",style:this._isSingleColumnLayout()?this.props.dashboardSelectorStyle.dashboardSelectorRowStyleMobile:this.props.dashboardSelectorStyle.dashboardSelectorRowStyle},a)},t.prototype._getSelectedDashboardSelectorOption=function(e){return we((e||this.props).dashboardSelectorItems,this._getDashboardIdForHeaderComponents(e))},t.prototype._renderDateRangeControl=function(){return l.createElement(da,{id:this.props.id,formId:this.props.formId,isSingleColumnLayout:this._isSingleColumnLayout(),dashboardCachedColumns:this.state.columns,dashboardCachedWdith:this.state.width,contextToken:this.props.contextToken})},t.prototype._renderSelectorImage=function(e){var t=null;return e&&(t=e.iconType===T.a.Dashboard?l.createElement(wt.a,{type:e.iconType}):l.createElement(Ve.b,{type:e.iconType})),l.createElement(p.a,{key:"selectorImage",role:"img",accessibilityLabel:this.props.dashboardHeaderIcon,style:this._isSingleColumnLayout()?this.props.dashboardSelectorStyle.dashboardSelectorImageStyleMobile:this.props.dashboardSelectorStyle.dashboardSelectorImageStyle},t)},t.prototype._isSingleColumnLayout=function(){return this.props.dashboardType&Yt.Bound?this.props.deviceWidth<this.props.theme.sizes.Breakpoints.DimensionS||this.state.width&&this.state.width<this.props.theme.sizes.Breakpoints.DimensionS:1===this._getColumns(this.props.deviceWidth)||1===this.state.columns},t.prototype._renderPageHeaderButtons=function(){if(!this._isErrorPage&&Object(b.i)(this._getDashboardIdForHeaderComponents()))return null;var e=[this._renderCommandBar(),this._renderSelectorRow()],t=this.props.dashboardViewStyle.dashboardHeaderStyle;return this._isSingleColumnLayout()&&(t=this.props.dashboardViewStyle.dashboardHeaderMobileStyle,(e=e.reverse()).unshift(this._renderConsoleAppBackButton(!0))),this.props.isInMobileModeForOct2019?l.createElement(l.Fragment,null,e):l.createElement(p.a,{key:"headerButtonsWrapper"},l.createElement(p.a,{key:"headerButtons",style:t},e))},t}(l.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ya(e,t,r){void 0===r&&(r=!1);var n=Object.keys(t).length;if(n!==Object.keys(e).length)return!0;var a=0;for(var i in t)if(!e[i]&&0!==e[i]||e[i]!==t[i]){if(!r)return!0;a++}return!!r&&(0!==a&&a!==n)}va.displayName="DashboardRoot";var _a,Oa,Sa,Ca,Ia,ja,Pa,Ta,Ea,wa,Fa,xa,Aa,Na,Da,ka,Ma,Ra,La,Ba,Va,Ga,Ua,za,qa,Xa,Wa,Ha=Object(d.a)((Da=null,Ba=function(e,t,r,n){var a,i,o;if(!Da){var s=Tt(r),l=function(e,t,r,n){return{base:s(e,r),mobile:s(Object(c.__assign)(Object(c.__assign)({},e),t),Object(c.__assign)(Object(c.__assign)({},r),n))}},u=Object(Pt.b)(n)?Object(Pt.a)(n):null,d=s({backgroundColor:e.colors.BaseColor.White},{backgroundColor:void 0}),p=l({display:"flex",flexDirection:"row",backgroundColor:e.colors.BaseColor.White,paddingTop:e.sizes.Measures.Measure125,paddingBottom:e.sizes.Measures.Measure125,justifyContent:"space-between",width:"100%"},{paddingTop:e.sizes.Measures.Measure100,paddingBottom:e.sizes.Measures.Measure100,minWidth:"0"},{backgroundColor:void 0,paddingTop:"16px",paddingBottom:"16px",height:"24px"}),h=p.base,g=p.mobile,m=l({maxWidth:e.sizes.Measures.Measure300,width:"100%",height:e.sizes.Measures.Measure300,borderRadius:"50%",backgroundColor:"#3b79b7",justifyContent:"center",alignItems:"center",fontSize:"16px",color:e.colors.BaseColor.White,alignSelf:"center",marginRight:e.sizes.Measures.Measure100,marginLeft:e.sizes.Measures.Measure150},{maxWidth:e.sizes.Measures.Measure200,height:e.sizes.Measures.Measure200,marginRight:e.sizes.Measures.Measure050,marginLeft:e.sizes.Measures.Measure050}),f=m.base,b=m.mobile,v=l({whiteSpace:"nowrap",minWidth:"0",fontFamily:e.fontFamilies.Semilight,color:e.colors.BaseColor.Grey.Grey7,fontWeight:"normal",fontSize:e.fontSizes.Font200},{fontWeight:void 0,fontSize:e.fontSizes.Font150},{fontFamily:e.fontFamilies.Semibold,color:u?u.Components.Dashboard.ViewSelector.TextColor:"#323130",backgroundColor:u?u.Components.Dashboard.ViewSelector.ChevronBackgroundColor:void 0,fontSize:"20px",lineHeight:"37px",cursor:"pointer",marginBottom:"-8px",marginTop:"-8px"}),y=v.base,_=v.mobile,O=l({fontSize:"16px",display:"flex",flexDirection:"column",justifyContent:"center",minWidth:"16px",marginLeft:e.sizes.Measures.Measure125,marginRight:e.sizes.Measures.Measure150},{marginLeft:e.sizes.Measures.Measure100,marginRight:void 0},{fontSize:"12px",color:u?u.Components.Dashboard.ViewSelector.ChevronColor:"#323130",fontWeight:"bold",lineHeight:"24px",maxHeight:"16px",marginTop:"8px",marginBottom:"10px",marginLeft:t?"-5px":"8px",marginRight:t?"8px":"-5px",justifyContent:void 0}),S=O.base,C=O.mobile,I=l({cursor:"pointer",minWidth:"0",maxWidth:"calc( 7 * "+e.sizes.Measures.Measure500+" )",width:"auto",height:"100%"},((a={maxWidth:"100%",height:void 0})[t?"paddingLeft":"paddingRight"]=e.sizes.Measures.Measure050,a),((i={cursor:"default",marginTop:"-8px",marginBottom:"-8px",paddingTop:"8px",paddingBottom:"8px"})[t?"marginRight":"marginLeft"]="12px",i),((o={})[t?"marginRight":"marginLeft"]=void 0,o)),j=I.base,P=I.mobile;Da={dashboardSelectorStyle:d,dashboardSelectorRowStyle:h,dashboardSelectorRowStyleMobile:g,dashboardSelectorImageStyle:f,dashboardSelectorImageStyleMobile:b,dashboardSelectorTextStyle:y,dashboardSelectorTextStyleMobile:_,dashboardSelectorCaretStyle:S,dashboardSelectorCaretStyleMobile:C,dashboardSelectorViewSelectorStyle:j,dashboardSelectorViewSelectorStyleMobile:P}}return Da},ka=null,Va=function(e,t,r,n){if(!ka){var a=Object(Be.p)(t,null);a.container.marginLeft="0px",a.container.marginRight="0px",a.container.width="100%",a.container.backgroundColor=e.colors.MainThemeColor.MainColor1.Fill,a.listItemBody.text.color=jt.a.colors.MainThemeColor.MainColor1.Text,a.listItemBody.icon.color=jt.a.colors.MainThemeColor.MainColor1.Text,a.listItemBody.icon.fontSize="16px",a.listItemBody.iconWrapperStyles.color=jt.a.colors.MainThemeColor.MainColor1.Text,a.moreIcon.color=jt.a.colors.MainThemeColor.MainColor1.Text,a.splitbuttonicon.color=jt.a.colors.MainThemeColor.MainColor1.Text;var i={":hover":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill}},o={"[aria-expanded=true]":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:e.colors.MainThemeColor.MainColor3.Fill}};a.listItem=Object(c.__assign)(Object(c.__assign)({},a.listItem),o),a.splitbuttonOverflowButton=Object(c.__assign)(Object(c.__assign)({},a.splitbuttonOverflowButton),o),a.listItemBody.button=Object(c.__assign)(Object(c.__assign)({},a.listItemBody.button),i),a.overflowFlyoutMoreButton=Object(c.__assign)(Object(c.__assign)({},a.overflowFlyoutMoreButton),i),a.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=t?void 0:e.colors.MainThemeColor.MainColor1.Text,a.listItemBody.splitButtonChevronIconWrapper.borderRightColor=t?e.colors.MainThemeColor.MainColor1.Text:void 0;var s=Object(Be.p)(t,null);s.container.marginLeft="0px",s.container.marginRight="0px",s.container.width="100%",s.container.backgroundColor=n?void 0:e.colors.BaseColor.White,s.listItemBody.text.color=jt.a.colors.BaseColor.Grey.Grey7,s.listItemBody.icon.color=jt.a.colors.BaseColor.Grey.Grey7,s.listItemBody.icon.fontSize="16px",s.listItemBody.iconWrapperStyles.color=jt.a.colors.BaseColor.Grey.Grey7,s.moreIcon.color=jt.a.colors.BaseColor.Grey.Grey7,s.splitbuttonicon.color=jt.a.colors.BaseColor.Grey.Grey7,s.container.height=Et(e.sizes.Measures.Measure200),s.listItemBody.button=Object(c.__assign)(Object(c.__assign)({},a.listItemBody.button),{":hover":{backgroundColor:jt.a.colors.BaseColor.White}}),s.list.marginTop="0rem",s.list.marginBottom="0rem",s.listItem.height="100%",s.listItem.display="flex",s.listItem.alignItems="center",s.listItemBody.button.width="16px",s.moreIcon.marginRight="0rem",s.moreIcon.marginLeft="0rem",s.container.borderStyle="none",s.list.marginLeft="0rem",s.list.marginRight="0rem",s.listItem.marginLeft=0,s.container.height=Et(e.sizes.Measures.Measure200);var l={minHeight:e.sizes.Measures.Measure300,backgroundColor:e.colors.MainThemeColor.MainColor1.Fill,display:"flex"};if(r){var u=Object(Be.m)(null),d=u.border.width+" "+u.border.style+" "+u.colors.border+" !important",p=Et(l.minHeight)+parseInt(u.border.width,10)+"px";Object.assign(l,{backgroundColor:u.colors.background,borderBottom:d,minHeight:p,maxHeight:p,boxSizing:"border-box"})}var h=Tt(n)({minHeight:e.sizes.Measures.Measure200,display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:t?e.sizes.Measures.Measure150:e.sizes.Measures.Measure100,paddingRight:t?e.sizes.Measures.Measure100:e.sizes.Measures.Measure150,paddingBottom:e.sizes.Measures.Measure100,paddingTop:e.sizes.Measures.Measure100},{paddingTop:"16px",paddingBottom:"16px",minHeight:"24px",maxHeight:"24px"});ka={dashboardCommandBarStyle:a,dashboardCommandBarMobileStyle:s,customCommandManagerStyle:{width:"100%"},commandBarWrapperStyle:l,commandBarWrapperMobileStyle:h}}return ka},Ga=function(){var e=null;return function(t,r,n){if(!e){var a=n?"#FAF9F8":t.colors.BaseColor.Grey.Grey1,i={dashboardErrorStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",backgroundColor:a,width:"100%",height:"100%"},dashboardViewStyle:{display:"flex",flexDirection:"column",backgroundColor:a,width:"100%",height:"100%"},dashboardScrollViewStyle:{height:"100%",overflow:"auto",backgroundColor:a,paddingTop:"1px",marginTop:"-1px",flex:"1 1 0px"},boundDashboardViewStyle:{display:"flex",flex:"1"},dashboardHeaderStyle:{display:"flex",flex:"1 0 auto",flexDirection:"column",justifyContent:"space-between"},dashboardHeaderMobileStyle:{display:"flex",flex:"1 0 auto",backgroundColor:n?"#FAF9F8":t.colors.BaseColor.White,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},tabBackButtonStyle:{height:"43px",borderWidth:r?"0 0 1px 1px":"0 1px 1px 0"}};e=i}return e}}(),Ua=Fe(),za=function(){var e=null;return function(t,r){if(!e){var n={progressIndicatorContainerStyleFull:{flex:"1",display:"flex",alignItems:"center",position:"relative"},progressIndicatorContainerStyleInternal:{display:"flex",flexDirection:"row-reverse",alignItems:"flex-end",height:Object(A.b)(r)/2,width:Object(A.c)(r)/2},progressIndicatorStyle:{width:"100%",height:"100%",alignContent:"center",display:"flex",position:"relative",flexDirection:"column",justifyContent:"center"},dashboardProgressIndicatorStyle:{width:"50px",height:"50px"}};e=n}return e}}(),qa=ee(),Xa=Object(Be.s)(),Ra=[1,2],La=[{accessRight:ce.a.WriteAccess,privilege:3},{accessRight:ce.a.DeleteAccess,privilege:4},{accessRight:ce.a.AssignAccess,privilege:5},{accessRight:ce.a.ShareAccess,privilege:6}],Wa=function(e,t){for(var r={},n=!1,a=0,i=Ra;a<i.length;a++)c(i[a],!1);for(var o=0,s=La;o<s.length;o++)c(s[o],!0);return n&&(Ma=r),Ma;function c(a,i){var o=a,s=i?o.privilege:a,c=Object(k.g)(e,ie.c,s,0);if(c&&i){var l=o.accessRight;c=Object(k.h)(e,ie.c,t,l)}r[s]=c,Ma&&Ma[s]===c||(n=!0)}},function(e,t){var r,s,c=Object(G.b)(e,t.id),l=Object(g.g)(e,t.id),d=!Object(ae.b)(e),p=Object(Kn.a)(e),h=function(e){var t=Object(M.x)(e);return t&&null!==t.yammerNetworkName&&void 0!==t.yammerNetworkName&&t.yammerNetworkName?t.yammerNetworkName:null}(e),m=function(e){var t=Object(M.x)(e);return t&&null!==t.yammerGroupId&&void 0!==t.yammerGroupId?t.yammerGroupId:null}(e),f=function(e){var t=Object(M.x)(e);return t&&null!==t.yammerOAuthAccessTokenExpired&&void 0!==t.yammerOAuthAccessTokenExpired?t.yammerOAuthAccessTokenExpired:null}(e),y=function(e){var t=Object(M.x)(e);return t&&null!==t.yammerPostMethod&&void 0!==t.yammerPostMethod?t.yammerPostMethod:null}(e),_=Object(U.b)(e,"YammerPostsOnUCI"),S=function(e){return Object(Kn.a)(e)!==Ht.a.MobileApplication&&!function(e){var t=Object(ha.a)(e);return!(!t||!t.MAIL_CONTEXT)}(e)&&Object(ae.b)(e)&&Object(M.c)(e)&&Object(U.c)(e,z.f)&&Object(U.c)(e,z.Nb)}(e),C=l.dashboardId,I=l.etn,j=Object(fa.d)(e);c||C||!I||(c=Object(b.e)(e,I));var P=Object(J.w)(e),T=P&&P.usePathBasedUrls,w=P&&P.defaultDashboardId,F=Object(b.a)(e,c),D=!!F,k=D&&Object(x.e)(e,be),R=k&&k.ConstructorName===be,L=D&&ye(e,c),B=function(e,t){var r=Object(v.e)(e,t.globalFilterLabelList);return{expand:Object(v.c)(r,t.GLOBAL_FILTER_OPEN_FILTER_PANEL),collapse:Object(v.c)(r,t.GLOBAL_FILTER_CLOSE_FILTER_PANEL_BUTTON)}}(e,n);xa&&xa.expand===B.expand&&xa.collapse===B.collapse||(xa=B);var q=function(e,t){var r=Object(v.e)(e,t.visualFilterLabelList);return{expand:Object(v.c)(r,t.VISUAL_FILTER_EXPAND),collapse:Object(v.c)(r,t.VISUAL_FILTER_COLLAPSE)}}(e,a);Aa&&Aa.expand===q.expand&&Aa.collapse===q.collapse||(Aa=q);var X=function(e,t){var r=Object(v.e)(e,t.streamTileSwitcherLabelList);return{switchToTileView:Object(v.c)(r,t.SWITCH_TO_TILE_VIEW),switchToStreamView:Object(v.c)(r,t.SWITCH_TO_STREAM_VIEW)}}(e,i);Na&&Na.switchToTileView===X.switchToTileView&&Na.switchToStreamView===X.switchToStreamView||(Na=X);var W=function(e,t){var r=Object(v.e)(e,t.dashboardRibbonLabelList);return{refresh:Object(v.c)(r,t.REFRESH),yammerLabelInDashboards:Object(v.c)(r,t.YAMMER_LABEL_IN_DASHBOARDS),setAsDefault:Object(v.c)(r,t.SET_AS_DEFAULT),unsetDefault:Object(v.c)(r,t.UNSET_DEFAULT),openInPowerBI:Object(v.c)(r,t.OPEN_IN_POWERBI),openEntityGrid:Object(v.c)(r,t.OPEN_ENTITY_GRID_LABEL),editDashboard:Object(v.c)(r,t.EDIT_DASHBOARD),deleteDashboard:Object(v.c)(r,t.DELETE_DASHBOARD),shareDashboard:Object(v.c)(r,t.SHARE_DASHBOARD),assignDashboard:Object(v.c)(r,t.ASSIGN_DASHBOARD),createNewDashboard:Object(v.c)(r,t.CREATE_NEW_DASHBOARD),createNewDashboardTooltip:Object(v.c)(r,t.CREATE_NEW_DASHBOARD_TOOLTIP),createDynamicsDashboard:Object(v.c)(r,t.CREATE_DYNAMICS_DASHBOARD),createDynamicsDashboardTooltip:Object(v.c)(r,t.CREATE_DYNAMICS_DASHBOARD_TOOLTIP),createPowerBIDashboard:Object(v.c)(r,t.CREATE_POWERBI_DASHBOARD),createPowerBIDashboardToolTip:Object(v.c)(r,t.CREATE_POWERBI_DASHBOARD_TOOLTIP),saveAsDashboard:Object(v.c)(r,t.SAVE_AS_DASHBOARD)}}(e,o);Fa&&Fa.refresh===W.refresh&&Fa.setAsDefault===W.setAsDefault&&Fa.unsetDefault===W.unsetDefault&&Fa.openInPowerBI===W.openInPowerBI&&Fa.editDashboard===W.editDashboard&&Fa.deleteDashboard===W.deleteDashboard&&Fa.shareDashboard===W.shareDashboard&&Fa.assignDashboard===W.assignDashboard&&Fa.createNewDashboard===W.createNewDashboard&&Fa.createDynamicsDashboard===W.createDynamicsDashboard&&Fa.createPowerBIDashboard===W.createPowerBIDashboard&&Fa.saveAsDashboard===W.saveAsDashboard||(Fa=W);var H=Object(N.a)(e),Q=Object(J.g)(e);!F&&C&&(F=Object(b.a)(e,C));var Y=I||F||null,K=Wa(e,u.a.toString(C)),Z=!u.a.isNullOrEmpty(c)&&c||!u.a.isNullOrEmpty(C)&&C,$=Ua(e,I,Z),ee=Z||u.a.tryParseOrNull(null===(s=null===(r=null==$?void 0:$.options)||void 0===r?void 0:r[0])||void 0===s?void 0:s.value),te=ee;(!ja||!Pa||te&&Pa!==te.guid)&&(ja=Object(O.d)(e,te),Pa=te&&te.guid);var re=Object(U.a)(e,z.Pd,z.h);_a=Ba(H,Q,re,e),Oa=Va(H,Q,Object(ea.a)(e),re),Sa=Ga(H,Q,re),Ca=za(H,e);var ne=Object(ue.a)(e),ie=function(e,t,r){var n={},a=je(e,t,r);for(var i in a)n[a[i].controlName]=Object(V.N)(e,r,a[i]);return n}(e,c,t.id);Ia&&!ya(Ia,ie)||(Ia=ie);var ce=Te(e,c,t.id,!1);Ea&&!function(e,t){if(!t)return!0;if(e.length!==t.length)return!0;for(var r=0,n=t;r<n.length;r++){var a=n[r];if(-1===e.indexOf(a))return!0}return!1}(Ea,ce)||(Ea=ce);var le=function(e,t){var r=Object(E.a)(e,t);return r&&r.dashboardLoadStatus}(e,t.id);5===le&&0===ke(e,c,t.id,!1)&&(le=4);var de=function(e,t,r){var n;switch(t){case 0:return n=Object(v.e)(e,[yr.UCI_DISABLED_ENTITY_ERROR]),String.format(Object(v.c)(n,yr.UCI_DISABLED_ENTITY_ERROR),r);case 1:return n=Object(v.e)(e,["Error.ReadOnlyEntity"]),String.format(Object(v.c)(n,"Error.ReadOnlyEntity"),r);case 2:return n=Object(v.e)(e,["Error.BoundDashboardOffline"]),Object(v.c)(n,"Error.BoundDashboardOffline");case 3:return n=Object(v.e)(e,["Error.DashboardNoComponents"]),Object(v.c)(n,"Error.DashboardNoComponents");case 4:return n=Object(v.e)(e,["Error.DashboardUnsupportedComponents"]),Object(v.c)(n,"Error.DashboardUnsupportedComponents")}}(e,le,Y),pe=qa(e,t.id,c),he=Ta&&Ta!==t.id;(!1!==wa||he)&&(wa=Re(e));var ge=Object(A.c)(e),me=Object(A.b)(e);he&&(ba.deviceWidth!==ge||D&&ba.deviceHeight!==me)&&(ba.columns=-1,ba.width=0,ba.height=0),Ta=t.id,ba.deviceWidth=ge,ba.deviceHeight=me;var fe=Xa(e),ve=Object(se.c)(Object(se.a)(e,c,I)),Oe=Object(v.c)(Object(v.e)(e,["Dashboard_Editor_Open_Title"]),"Dashboard_Editor_Open_Title"),Se=Object(v.c)(Object(v.e)(e,["Dashboard_Editor_Open_Message"]),"Dashboard_Editor_Open_Message"),Ce=Object(v.c)(Object(v.e)(e,["Dashboard_Editor_Open_Confirm_Button"]),"Dashboard_Editor_Open_Confirm_Button"),Ie=Object(v.c)(Object(v.e)(e,["Dashboard_Header_Label"]),"Dashboard_Header_Label"),Pe=Object(U.c)(e,z.fe),Ee=(D&&Yt.Bound)|(L&&Yt.TierOne)|(_e(e,c)&&Yt.TierTwo),we=Object(ra.b)(e);return{formId:c,entityLogicalName:I,isUserDashboard:ve,dashboardSelectorItems:$,dashboardType:Ee,dashboardInput:l,globalFilterCommandLabels:xa,visualFilterCommandLabels:Aa,streamTileSwitcherCommandLabels:Na,dashboardSelectorStyle:_a,dashboardCommandBarStyle:Oa,dashboardViewStyle:Sa,dashboardProgressIndicatorStyle:Ca,isPowerBiEnabled:ne,userDashboardPrivileges:K,isPowerBIDashboard:Object(oe.b)(e,c),theme:H,refreshCounters:Ia,isEntityBoundDashboard:!!I,isBoundDashboardControlSupported:R,contextToken:ja,ribbonLabels:Fa,defaultDashboardId:w,openEntityGrid:W.openEntityGrid,forbiddenUCIControls:Ea,selectedDashboardId:ee,deviceWidth:ge,dataSetColumns:pe,dashboardLoadStatus:le,dashboardErrorMessage:de,isServerOffline:d,isOnPremise:T,clientHostType:p,isRibbonCustomizable:wa,yammerNetworkName:h,yammerGroupId:m,yammerOAuthAccessTokenExpired:f,yammerPostMethod:y,yammerPostsOnUCIEnabled:_,hybridButtonsOnUCIEnabled:S,commandBarRefreshProps:fe,dashboardEditorButtonText:Ce,dashboardEditorOpenMessage:Se,dashboardEditorOpenTitle:Oe,dashboardHeaderIcon:Ie,shouldRenderBackButton:j,isUnsetDefaultDashboardFeatureEnabled:Pe,isInMobileModeForOct2019:we,isSuiterDashboard:re}}),(function(e,t){return{openGridPage:function(r){e(Object(xt.a)(r,t.id))},refreshDashboard:function(r){return e($r(r,t.id))},setDashboardAppliedFilterAndLinkingInput:function(r,n,a){var i=Object(c.__assign)(Object(c.__assign)({},r),{appliedFilter:n,linkingInput:a});e(Object(Kt.b)(i,t.id))},setUpdatedControlParameters:function(r){e(Sn(t.id,r))},savedFilterDelete:function(t){e(zt(t))},defaultSavedFilterUpdate:function(t){e(Xt(t))},filterSaved:function(t){e(Ut(t.entityName))},retrieveUserDashboardPrivileges:function(){e(Object(Zt.f)(ie.c,!1,[]))},setDashboardOfflineError:function(){e(Or(t.id,2)),e(Object(vr.e)(["Error.BoundDashboardOffline"]))},switchDashboard:function(r){e(Vn(t.id,r))},retrieveErroredEntityMetadata:function(r){e(ma(r,t.id))}}}))(va);var Qa=r("dUXI"),Ya=r("fH/t"),Ka=r("tIxw"),Ja=r("455M"),Za=r("ZEX9"),$a=r("T2Xs"),ei="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDashboardSelector",ti=!1;function ri(){var e,t={},r=Object(v.h)();return function(n,a,i,o,s){if($a.a.info(i.controlId+"."+ei+": createGetDashboardData started"),o.Parameters[n].Type===Ja.a.Dashboard){var l={},u=!1,d=Object(G.b)(a,i.id),p=Object(g.g)(a,i.id),h=p.dashboardId,m=p.etn,f=p.updatedControlParameters,v=p.dateRangeTimeFrame,_=p.dateRangeStartDate,O=p.dateRangeEndDate;d||h||!m||(d=Object(b.e)(a,m));var S=Object(y.j)(a,d);if(S){var j=Object(b.a)(a,d),P=j&&Object(I.e)(a,j),T=S.TabAttributes&&S.TabAttributes.FilterBy,E=T&&Object(C.a)(a,j,T),w=E&&E.DisplayName,F=Object(b.h)(a,d),x=Object(U.a)(a,z.Zb,z.h),N=Object(se.a)(a,d,j),D=x&&Object(se.c)(N)&&!Object(ue.a)(a);l[n]={FormDescriptor:S,Columns:i.descriptor.Parameters.Columns,Width:i.descriptor.Parameters.Width,Height:i.descriptor.Parameters.Height,DeviceHeight:Object(A.b)(a),ShowVisualFilters:i.descriptor.Parameters.ShowVisualFilters,TileView:i.descriptor.Parameters.TileView,PrimaryEntity:j,PrimaryEntityPluralName:P,FilterByDisplayName:w,InitDateRangeTimeFrame:v,InitDateRangeStartDate:_,InitDateRangeEndDate:O,QueueEntityObjectTypeCodeByName:F,RefreshCounters:i.descriptor.Parameters.RefreshCounters,ScrollTop:i.descriptor.Parameters.ScrollTop||0,Strings:r(a,i.descriptor.Parameters.StringIds),UpdatedControlParameters:f,DataSetColumns:i.descriptor.Parameters.DataSetColumns,StreamRecordsPerPage:i.descriptor.Parameters.StreamRecordsPerPage,CreateDashboardLayoutBuilder:i.descriptor.Parameters.CreateDashboardLayoutBuilder,ShouldCreateGlobalFilter:ti||(ti=void 0!==i.descriptor.Parameters.ToggleGlobalFilterFlyout),CreateStreamControl:i.descriptor.Parameters.CreateStreamControl(a,F,i.id),DisablePowerBIEmbedding:D,Type:Ja.a.Dashboard,DefaultSavedFilter:Object(J.a)(a)};var k=!1;S&&(t.hasOwnProperty(n)&&t[n].FormDescriptor&&t[n].FormDescriptor.initialized===S.initialized&&t[n].FormDescriptor.Id.guid===S.Id.guid&&t[n].Columns===l[n].Columns&&t[n].Width===l[n].Width&&t[n].Height===l[n].Height&&t[n].DeviceHeight===l[n].DeviceHeight&&t[n].ShowVisualFilters===l[n].ShowVisualFilters&&t[n].TileView===l[n].TileView&&t[n].PrimaryEntity===l[n].PrimaryEntity&&t[n].PrimaryEntityPluralName===l[n].PrimaryEntityPluralName&&t[n].FilterByDisplayName===l[n].FilterByDisplayName&&t[n].ScrollTop===l[n].ScrollTop&&t[n].Strings===l[n].Strings&&t[n].UpdatedControlParameters===l[n].UpdatedControlParameters&&t[n].DataSetColumns===l[n].DataSetColumns&&t[n].StreamRecordsPerPage===l[n].StreamRecordsPerPage&&t[n].CreateDashboardLayoutBuilder===l[n].CreateDashboardLayoutBuilder&&t[n].ShouldCreateGlobalFilter===l[n].ShouldCreateGlobalFilter&&e===i.descriptor.Parameters.ToggleGlobalFilterFlyout&&t[n].DefaultSavedFilter===l[n].DefaultSavedFilter&&t[n].DisablePowerBIEmbedding===l[n].DisablePowerBIEmbedding&&!ni(t[n].QueueEntityObjectTypeCodeByName,l[n].QueueEntityObjectTypeCodeByName)&&!ni(t[n].RefreshCounters,l[n].RefreshCounters)||(k=!0)),u=k}return u&&(t=Object(c.__assign)(Object(c.__assign)({},t),l),e=i.descriptor.Parameters.ToggleGlobalFilterFlyout),$a.a.info(i.controlId+"."+ei+": createGetDashboardData finished"),t[n]}}}function ni(e,t){if(Object.keys(t).length!==Object.keys(e).length)return!0;for(var r in t){if(!e[r]&&0!==e[r])return!0;if(e[r]!==t[r])return!0}return!1}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ai(){var e={};return function(t,r,n,a,i){$a.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlGlobalFilterSelector: createGetGlobalFilterData started");var o=a.Parameters[t],s=n.descriptor.Parameters,l={},u=!1,d={},p={},h=o?o.Entities:null,g=o?o.DashboardWidth:null;if(h){for(var m=0,f=h;m<f.length;m++){var b=f[m],v=Object(I.f)(r,b);v&&(p[b]=v);var y=Object(C.d)(r,b);if(y)if(d[b]||(d[b]={}),o.AttributesByEntity&&o.AttributesByEntity[b])for(var _=0,O=o.AttributesByEntity[b];_<O.length;_++){var S=O[_];d[b][S]=y[S]}else for(var j in y){var P=y[j];P&&ii(r,b,j,P)&&P.IsGlobalFilterEnabled&&(d[b][j]=P)}}l[t]={Entities:h,DashboardWidth:g,PrimaryEntity:o.PrimaryEntity,EntityDisplayNames:p,AttributeDescriptorsByEntity:d,ToggleGlobalFilterFlyout:s&&s.ToggleGlobalFilterFlyout,GlobalFilterFlyoutAnchorId:s&&s.GlobalFilterFlyoutAnchorId,Type:Ja.a.GlobalFilter,ConvertFilterExpressionToFetchXml:Gt.j,ConvertFetchXmlToFilterExpression:Gt.i,SavedFilters:Object(J.i)(r),SelectedGlobalFilterId:Object(J.j)(r),DefaultSavedFilter:Object(J.a)(r)},e.hasOwnProperty(t)&&e[t].Entities&&!function(e,t){if(e.length!==t.length)return!0;for(var r=0,n=t;r<n.length;r++){var a=n[r];if(e.indexOf(a)<0)return!0}return!1}(e[t].Entities,h)&&e[t].DashboardWidth===g&&e[t].ToggleGlobalFilterFlyout===l[t].ToggleGlobalFilterFlyout&&e[t].GlobalFilterFlyoutAnchorId===l[t].GlobalFilterFlyoutAnchorId&&!function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!0;for(var r in t){if(!(r in e))return!0;if(Object.keys(e[r]).length!==Object.keys(t[r]).length)return!0;for(var n in t[r])if(!(n in e[r]))return!0}return!1}(e[t].AttributeDescriptorsByEntity,d)||(u=!0)}return u&&(e=Object(c.__assign)(Object(c.__assign)({},e),l)),$a.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlGlobalFilterSelector: createGetGlobalFilterData finished"),e[t]}}function ii(e,t,r,n){return Object(k.f)(e,t,r,le.a.CanRead)&&n&&n.IsValidForRead}var oi=r("u3BH");function si(e){return{type:"dashboard.retrieveDashboardSelectors.async",execute:function(t){var r=t.dispatch,n=(0,t.getState)(),a=2,i=e?Object(b.g)(n,e):Object(b.c)(n),o=i&&Object.keys(i);if(o&&o.length>0){var s=i[o[0]];a=Object(rn.d)(n,!0,s,(function(){return s}))}return 0!==a?r(function(e){return Object(rn.b)("dashboardselector",null,e,null,!0,an.a.OnDemandWithContext,null,null,[],null,on.a.LocalAndRemote)}(e)):Promise.resolve()}}}var ci=r("dEPU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function li(e,t,r,n,a,i){var o,s=i.etn,l=t(si(s)),u=t((o=Object(c.__spreadArrays)(D.labelList,It,sn,gr,nt,ot,et,Qa.A,yr.labelList,Ya.k,Ka.g,["ViewSelectorAllActivities"]),Object(vr.e)(o)));return function(e,t){Re(t)&&e(Object(ci.a)("Dashboard:null"));var r=Object(I.h)(t,ie.c);(r&&r.Privileges||Object(ae.b)(t))&&e(Object(Zt.f)(ie.c,!1,[]))}(t,e()),Tn(e,t,n,a,s,r.ScriptManager.initializeContainerForClientApi(n),l,u)}function ui(e,t,r){var n=r.retrievedId,a=r.etn;e(xn(t,n,a)),e(Dn(n,a)),Object(Za.b)(ri,Ja.a.Dashboard),Object(Za.b)(ai,Ja.a.GlobalFilter,Ja.a.AppliedFilters),Object(Za.b)(oi.a,Ja.a.PowerBI)}var di=r("52Se");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function pi(e,t){var r=e?"dashboard.setLoadStatus"===t.type?t.payload:e.dashboardLoadStatus:void 0,n=Object(c.__assign)(Object(c.__assign)({},Object(di.a)(e,t)),{dashboardLoadStatus:r});return Object.freeze(n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var hi=function(){function e(e,t){this._id=e,this._initializeAction=function(e,t){return Pn("PageNavigation",e,t,li,ui,(function(){return Promise.resolve()}))}(this._id,t)}return e.prototype.getName=function(){return s.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(e){return this._initializeAction(e)},e.prototype.getRootReducer=function(){return pi},e.prototype.getRootComponent=function(){return Ha},e.prototype.getCloseAction=function(e){},e}()},"d26+":function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("Sscr"),a=r("jigW"),i=r("uO/V"),o="dataset.update.fetchxml";function s(e,t,r){return{type:"dataset.update.fetchxml.async",execute:function(s,c){var l=s.dispatch,u=(s.getState,c.TraceManager.getTracer(i.z)),d=i.x+".updateFetchXMLAction";try{u.info("Updating the fetch xml for the grid."),l(function(e,t,r){var a=Object(n.y)(t),i=Object(n.v)(t);return{type:o,payload:r,meta:{pageId:e,contextKey:a,dataSetContextKey:i}}}(e,t,r));var p=Object(a.j)(r),h=[];return h.push({name:"fetchXML",value:p}),c.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}catch(e){var g="Updating the fetchxml for the grid with contextKey : "+Object(n.v)(t)+" failed with the error : "+e.message;c.EventManager.ReportComponentFailure(d,Error(g))}}}}},dWLV:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n,a=r("c/eZ"),i=r("ASFs"),o=r("nIt0"),s=Object(i.d)(((n={})[o.a]=function(e,t){return Object(a.__assign)({},t.payload.formlessControlOutputs)},n),{})},e2rP:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.commandbarvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},enCe:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ShowHeaderFieldsInSection.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:{showHeaderFieldsInSection:r},meta:{pageId:e,contextKey:i}}}},"fH/t":function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"j",(function(){return u})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return p})),r.d(t,"k",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Grid_Paging_Mask",a="Grid_StatusMessage_Mask",i="Grid_ItemsSelected_Mask",o="Grid_TotalCount_Mask",s="Grid_ToolTip_FirstPage",c="Grid_ToolTip_PreviousPage",l="Grid_ToolTip_NextPage",u="Grid_TotalCount_SpaceMask",d="Grid_TotalCount_Approximate",p="Grid_TotalCount_Exact",h=[n,a,i,o,s,c,l,u,d,p]},fTYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.tab.selectPrevious";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var r=Object(n.v)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:r}}}},g24L:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("jJRu"),a=r("aGOT"),i=r("Cfob");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e,t){return void 0===e&&(e=null),t.type===n.a?t.payload.snapshotId:t.type===i.a?t.payload:t.type===a.a?null:e}},gRWC:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="formSelector.visible";function a(e,t,r){return{type:n,payload:{visible:r},meta:{pageId:e,formId:t}}}},grpZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l}));var n=r("9r0m"),a=r("uQP8"),i=r("sOTk"),o=r("i8/j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,r){var n;void 0===r&&(r=!1);var s=Object(i.g)(e,t).entityTypeName,c=Object(o.n)(e,s);if(!r)return c;var l=Object(a.a)(e,t),u=null===(n=null==l?void 0:l.formSelector)||void 0===n?void 0:n.forms,d=c;if(u&&Object.keys(u).length>0)for(var p in d=new Object,c)u[p]&&!u[p].visible||(d[p]=c[p]);return d}function c(e,t,r){var s,c,l=Object(a.a)(e,t),u=n.a.toString(r);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;var d=Object(i.g)(e,t).entityTypeName;return!!Object(o.m)(e,d,r)||null}function l(e,t){var r,n=Object(a.a)(e,t);return null===(r=null==n?void 0:n.formSelector)||void 0===r?void 0:r.selectedFormId}},hE7j:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="control.setSrc";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(r);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},i6iy:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return f}));var n=r("cZkS"),a=r("9r0m"),i=r("Gemh"),o=r("qC0c"),s=r("Wye+"),c=r("UOiB"),l=r("olrR"),u=r("RlP9"),d=r("r2h9"),p=r("uO/V"),h=r("19Zc"),g=r("jigW");function m(e,t,r,m){return{type:"grid.quickfind.apply.async",execute:function(f,b){var v=f.dispatch,y=f.getState,_=b.TraceManager.getTracer(p.z),O=p.x+".QuickFilterAction";try{var S=y(),C=Object(i.F)(S,t,r,m);return function(e,t,r){return new Promise((function(n){var a=Object(u.a)(e,r,d.a.QUICKFIND_SEARCH);a?n(a):t(Object(l.a)(r,d.a.QUICKFIND_SEARCH,d.b.savedview)).then((function(e){n(e)}))}))}(S,v,C).then((function(l){_.info("Performing quick find on the grid ");var u=Object(i.T)(S,t,r,m),p=u,f=r.contextTokenType===c.a.SubGrid,C=!1;if(f&&r.controlName){var I=Object(i.hb)(y(),t,r,r.controlName);I&&(C=I.EnableViewPicker)}return Object(o.a)(y(),n.Nd)&&f&&!C||Object(g.l)(S)||(p=l),v(Object(h.n)(e,t,r)),v(Object(s.a)(t,r,m,a.a.toString(p),null,d.a.QUICKFIND_SEARCH)).then((function(){return b.EventManager.ReportComponentSuccess(O),u}))}))}catch(e){b.EventManager.ReportComponentFailure(O,Error("Unable to perform a quick find on the grid"))}}}}function f(e,t,r,n){return{type:"grid.quickfind.clear.async",execute:function(i,o){var c=i.dispatch,l=(i.getState,o.TraceManager.getTracer(p.z)),u=p.x+".QuickFilterAction";try{return l.info("Clearing quick find from the grid."),c(Object(h.n)("",t,r)),c(Object(s.a)(t,r,n,a.a.toString(e))).then((function(){o.EventManager.ReportComponentSuccess(u)}))}catch(e){o.EventManager.ReportComponentFailure(u,Error("Unable to clear quick find value for grid"))}}}}},ig6i:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=function(){function e(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}return Object.defineProperty(e.prototype,"etn",{get:function(){return this._etn},set:function(e){this._etn=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},set:function(e){this._attributeName=e},enumerable:!1,configurable:!0}),e}()},ixd0:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n,a=r("9r0m"),i=r("IiPO"),o=r("sOTk"),s=r("+Z9T"),c=r("ezfI"),l=r("bJYk"),u=r("gRWC"),d=r("grpZ"),p=function(){function e(e,t,r,a){this._id=e,this._label=t,n=r,this._pageId=a}return e.prototype.getId=function(){var e="ClientApi.XrmFormSelectorItem.getId";try{c.a.instance.reportCall(e);var t=a.a.toString(this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.getLabel=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label},e.prototype.getPageId=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId},e.prototype.setVisible=function(e){var t="ClientApi.XrmFormSelectorItem.setVisible";try{c.a.instance.reportCall(t),n.dispatch(Object(u.b)(this._pageId,a.a.toString(this._id),e)),c.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}},e.prototype.getVisible=function(){var e="ClientApi.XrmFormSelectorItem.getVisible";try{c.a.instance.reportCall(e);var t=Object(d.c)(n.getState(),this._pageId,this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.navigate=function(){var e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),c.a.instance.reportCall(e);var t=Object(o.g)(n.getState(),this._pageId),r=t&&t.id?t.id.guid:"",a=Object(o.l)(n.getState(),this._pageId);n.dispatch(Object(l.a)(this._id.guid,this._pageId,a,r)).then((function(){c.a.instance.reportSuccess(e)})).catch((function(t){return Object(s.d)(n,t,e+".changeForm")}))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e}()},jWor:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="navigation.item.defaultvalues";function a(e,t,r){return{type:n,payload:{allNavBarByRelationshipItems:t,currentLanguageId:r},meta:{pageId:e}}}},ksD2:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r("Sscr"),a=r("HSdq"),i=r("s0Zj"),o=r("ar+e"),s=r("B188"),c=r("4sax"),l=r("7pqb"),u=r("KzM6"),d="tab.visible";function p(e,t,r,p){return{type:"tab.visible.sync",sync:!0,execute:function(h,g){var m,f=h.dispatch,b=h.getState,v=b();f(function(e,t,r,a){var i=Object(n.v)(r);return{type:d,payload:a,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,r,p));var y=Object(a.wc)(v,{id:e},r),_=Object(o.e)(v,{id:e},r);if(y||(null==_?void 0:_.isSelected)||!p){if(y===t&&!p){var O=Object(a.fb)(v,{id:e},r),S=!1;if(O)for(var C=0,I=Object(a.m)(v,O);C<I.length;C++){var j=I[C];if(j.Id!==t&&Object(a.Kc)(v,j.Id,e,r)){S=!0,f(Object(i.b)(e,j.Id,r));break}}S||f(Object(i.b)(e,void 0,r))}}else f(Object(i.b)(e,t,r));if(Object(s.a)()){var P=b(),T=null===(m=null==g?void 0:g.TraceManager)||void 0===m?void 0:m.getTracer(""+l.k+l.r),E=Object(a.Kc)(v,t,e,r),w=Object(a.Kc)(P,t,e,r),F=Object(u.a)(P,e);F.push({name:"tabId",value:t}),F.push({name:"tabName",value:Object(a.Ic)(P,t,e,r)}),F.push({name:"tabLabel",value:Object(a.Hc)(P,t,e,r)}),F.push({name:"visible state before change",value:null==E?void 0:E.toString()}),F.push({name:"visible state after change",value:null==w?void 0:w.toString()}),F.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==T||T.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(F)}])}}}}},lFQy:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("9r0m"),a=r("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){var r,i={dataById:(r={},r[n.a.toString(t.id)]=e,r)};return{type:a.a,payload:i}}},ll2N:function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n,a=r("c/eZ"),i=r("1z64"),o=r("FlW1"),s=r("HSdq"),c=r("Zy0S"),l=r("+Z9T"),u=r("JCHT"),d=r("OmYs"),p=r("IiPO"),h=r("ezfI"),g=r("kvLG"),m=function(e){function t(t,r,a,o,s,c){var l=e.call(this,t,r,a,o)||this;return l._parent=s,n=t,l._formContext=c,l._iConnectedSectionProp={sectionName:l.name,id:l.pageId},l._clientApiExecutorTabSection=new i.a(t,"ClientApi.XrmTabSection.",a,r),l.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),l}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorTabSection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){var e=this;return this.clientApiExecutor.execute("controls",(function(t,r){if(!e._controls){var a=n.getState();e._controls=new c.a(t);var i=e.getControlsDescriptor(a);if(!i)return e._controls;for(var o in i){var s=e._formContext.ui.controls.get(o);if(s)e._controls.add(s.getName(),s);else{var l=r.slice();l.push({name:"controlKey",value:o}),g.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",l)}}}return e._controls}))},enumerable:!1,configurable:!0}),t.prototype.getParent=function(){return h.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent},t.prototype.getVisible=function(){var e="ClientApi.XrmTabSection.getVisible";try{h.a.instance.reportCall(e);var t=Object(s.tc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Visible:t;return h.a.instance.reportSuccess(e),r}catch(t){var a=p.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.getLabel=function(){var e="ClientApi.XrmTabSection.getLabel";try{h.a.instance.reportCall(e);var t=Object(s.rc)(n.getState(),this._iConnectedSectionProp,this.contextToken),r=Object(l.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return h.a.instance.reportSuccess(e),r}catch(t){var a=p.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._getSectionDescriptorValues=function(){try{return Object(s.qc)(n.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){var e=p.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}},t.prototype.getControlsDescriptor=function(e){try{return Object(s.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTabSection.setVisible";try{h.a.instance.reportCall(t),n.dispatch(Object(u.b)(this.pageId,this.contextToken,this.name,!0===e)),h.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTabSection.setLabel";Object(l.a)(e)&&Object(l.j)(t,"label");try{h.a.instance.reportCall(t),n.dispatch(Object(d.b)(this.pageId,this.contextToken,this.name,e)),h.a.instance.reportSuccess(t)}catch(e){var r=p.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,r),e}},t}(o.a)},lwSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="header.tabnavigatorvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},m8A1:function(e,t,r){"use strict";r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("HSdq"),a=r("sOTk"),i=r("gk6Q"),o=r("kvLG"),s=r("b1hT"),c=r("QAhb"),l=r("j+yI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,r,i){if(void 0===i&&(i=!1),!e)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(r).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;var u=function(e,t){var r=Object(a.g)(e,t);if(!r)return null;var n=r.entityTypeName,i=r.id;return new c.a(n,i)}(e,t),d=!Object(n.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(i||!Object(l.d)(e,u,t)),p=g(t,e);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),o.a.getInstance().eventManager.ReportComponentSuccess(r,p),d}function d(e,t,r,n){if(!e&&(o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",g(r,t.getState())),u(t.getState(),r,n))){o.a.getInstance().traceManager.getTracer(n).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",g(r,t.getState()));var s=Object(a.g)(t.getState(),r);return Object(i.b)(r,s)}return e}function p(e,t,r,n){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:r},{name:"XrmEntityIsNotNull",value:n}]}function h(e,t,r){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"getProcessManagerInvoked",value:r}]}function g(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)}]}},mPpC:function(e,t,r){"use strict";r.d(t,"b",(function(){return we})),r.d(t,"a",(function(){return Ee}));var n,a,i,o,s,c,l,u,d,p,h,g=r("+l2M"),m=r("sOTk"),f=r("c/eZ"),b=r("YCDx"),v=r("HSdq"),y=r("x6Ak"),_=r("IiPO"),O=r("ezfI"),S=function(e){function t(t,r,a,i,o,s){var c=e.call(this,t,r,a,i,o,s)||this;return n=t,c}return Object(f.__extends)(t,e),t.prototype.refresh=function(){var e="ClientApi.XrmControlTimer.refresh";try{O.a.instance.reportCall(e),n.dispatch(Object(y.b)(this.pageId,this.contextToken,this.name)),O.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getState=function(){var e="ClientApi.XrmControlTimer.getState";try{O.a.instance.reportCall(e);var t=Object(v.cb)(n.getState(),this.pageId,this.contextToken).controls[this.getName()].parameters.timerState;return O.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"},t}(b.a),C=r("Zz0a"),I=r("w/nD"),j=r("+Z9T"),P=r("gk6Q"),T=function(e){function t(t,r,n,i,o,s){var c=e.call(this,t,r,n,i,o,s)||this;return a=t,c.registerObserversForControlStateChange(),c}return Object(f.__extends)(t,e),t.prototype.addOnClick=function(e){var t="ClientApi.XrmControlButton.addOnClick";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),a.dispatch(Object(I.b)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnClick=function(e){var t="ClientApi.XrmControlButton.removeOnClick";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),a.dispatch(Object(I.w)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(P.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t}(b.a),E=r("1z64"),w=r("hE7j"),F=r("EGsq"),x=r("WACO"),A=function(e){function t(t,r,n,a,o,s){var c=e.call(this,t,r,n,a,o,s)||this;i=t;var l=[{name:"controlName",value:o,isEventParam:!0}];return c._clientApiExecutorWebResource=new E.a(t,"ClientApi.XrmControlWebResource.",n,r,l),c}return Object(f.__extends)(t,e),t.prototype.getSrc=function(){var e=this;return this._clientApiExecutorWebResource.execute("getSrc",(function(){var t=i.getState(),r=Object(F.t)(t)+Object(v.wb)(t,{controlName:e.name,id:e.pageId},e.contextToken);return Object(x.c)(t,e.pageId,e.name,e.contextToken,r)}))},t.prototype.getContentWindow=function(){var e=this;return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(function(t,r){var n=e.formContext.applicationContext.TraceManager.getTracer(t),a=function(){var t=Object(v.xb)(i.getState(),e.pageId,e.getName());if(t){var a=null;try{return"complete"===(a=t.contentWindow).document.readyState?Promise.resolve(a):(r.push({name:"readyState",value:a.document.readyState}),n.info("Frame content window not ready",r),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(e){return a?(r.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",r),Promise.resolve(a)):Promise.reject(e)}}else n.info("Frame DOM element not ready",r);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then((function(e){return Promise.resolve(e)})).catch((function(t){if(111!==t.errorCode)return Promise.reject(t);var o=e.contextToken,s=e.pageId,c=e.getName();return new Promise((function(e,t){var l=function(){Object(I.G)(o,s,l,c),a().then((function(t){e(t)})).catch((function(a){a.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",r),e(a.contentWindow)):t&&(111===a.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",r),t(new Error("Frame element could not be found."))):t(a))}))};i.dispatch(Object(I.l)(o,s,l,c))}))}))}))},t.prototype.getObject=function(){var e=this;return this._clientApiExecutorWebResource.execute("getObject",(function(){return Object(v.xb)(i.getState(),e.pageId,e.name)}))},t.prototype.setSrc=function(e){var t=this;return this._clientApiExecutorWebResource.execute("getControlType",(function(){Object(j.a)(e)||i.dispatch(Object(w.b)(t.pageId,t.name,t.contextToken,e))}))},t.prototype.getControlType=function(){return this._clientApiExecutorWebResource.execute("getControlType",(function(){return"webresource"}))},t.prototype.addOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",(function(){i.dispatch(Object(I.l)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t.prototype.removeOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",(function(){i.dispatch(Object(I.G)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t}(b.a),N=function(e){function t(t,r,n,a,i,s){var c=e.call(this,t,r,n,a,i,s)||this;return o=t,c}return Object(f.__extends)(t,e),t.prototype.getInitialUrl=function(){var e="ClientApi.XrmControlIFrame.getInitialUrl";try{O.a.instance.reportCall(e);var t=Object(v.sb)(o.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return O.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"},t.prototype.getSrc=function(){var e="ClientApi.XrmControlIFrame.getSrc";try{O.a.instance.reportCall(e);var t=o.getState(),r=this.getInitialUrl(),n=Object(x.c)(t,this.pageId,this.name,this.contextToken,r);return O.a.instance.reportSuccess(e),n}catch(t){var a=_.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,a),t}},t}(A),D=r("+P1Q"),k=r("Q60c"),M=r("slAZ"),R=r("AVer"),L=r("QItn"),B=r("9r0m"),V=r("YdIa"),G=function(e){function t(t,r,n,a,i,o){var c=e.call(this,t,r,n,a,i,o)||this;return s=t,c._clientApiExecutorLookup=new E.a(t,"ClientApi.XrmControlLookup.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),c}return Object(f.__extends)(t,e),t.prototype.addCustomView=function(e,t,r,n,a,i){var o=this;this._clientApiExecutorLookup.execute("addCustomView",(function(c,l){var u=B.a.tryParseOrNull(e);u||Object(j.k)(c,"guid","viewId",l),s.dispatch(Object(R.a)(o.pageId,o.name,u,t,o.contextToken,r,n,a)),i&&o.setDefaultView(e)}),[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:r,isRequired:!0},{name:"fetchXml",value:n,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])},t.prototype.addCustomFilter=function(e,t){var r="ClientApi.XrmControlLookup.addCustomFilter";Object(j.a)(e)&&Object(j.j)(r,"fetchXmlFilter"),Object(j.b)(e)||Object(j.l)(r);try{O.a.instance.reportCall(r),s.dispatch(Object(M.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),O.a.instance.reportSuccess(r)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(r,e,null,n),e}},Object.defineProperty(t.prototype,"disableMru",{get:function(){var e="ClientApi.XrmControlLookup.getDisableMru";try{O.a.instance.reportCall(e);var t=Object(v.x)(s.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return O.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},set:function(e){var t="ClientApi.XrmControlLookup.setDisableMru";try{O.a.instance.reportCall(t),s.dispatch(Object(L.b)(s.getState(),this.pageId,this.name,this.contextToken,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},enumerable:!1,configurable:!0}),t.prototype.startCustomFilter=function(){var e="ClientApi.XrmControlLookup.startCustomFilter";try{O.a.instance.reportCall(e),s.dispatch(Object(M.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),O.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.endCustomFilter=function(){var e="ClientApi.XrmControlLookup.endCustomFilter";try{O.a.instance.reportCall(e),s.dispatch(Object(M.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),O.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,r,null,t),r}},t.prototype.getDefaultView=function(){var e=this;return this._clientApiExecutorLookup.execute("getDefaultView",(function(){var t=Object(v.O)(s.getState(),e.pageId,e.name,e.contextToken);return t?B.a.externalGuid(new B.a(t)):null}))},t.prototype.setDefaultView=function(e){var t=this;this._clientApiExecutorLookup.execute("setDefaultView",(function(r,n){var a=B.a.tryParseOrNull(e);a||Object(j.k)(r,"guid","id",n),s.dispatch(Object(k.b)(t.pageId,t.name,t.contextToken,a))}),[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])},t.prototype.addOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),s.dispatch(Object(I.g)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.addPreSearch=function(e){var t="ClientApi.XrmControlLookup.addPreSearch";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),s.dispatch(Object(I.t)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),s.dispatch(Object(I.B)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removePreSearch=function(e){var t="ClientApi.XrmControlLookup.removePreSearch";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),s.dispatch(Object(I.O)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"},t.prototype.getEntityTypes=function(){var e="ClientApi.XrmControlLookup.getEntityTypes";try{O.a.instance.reportCall(e);var t=Object(v.Ob)(s.getState(),this.pageId,this.contextToken,this._dataFieldName);return O.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setEntityTypes=function(e){var t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(j.j)(t,"entityTypes");var r=[];try{O.a.instance.reportCall(t),e=Array.from(new Set(e));var n=Object(v.Pb)(s.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};n.forEach((function(e){a[e]=!0})),e.forEach((function(e){a[e]||r.push(e)}))}catch(e){throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t+".validation",e,null,i),e}r.length>0&&Object(j.h)(t,"entityType",r[0]);try{s.dispatch(Object(V.b)(this.pageId,this.contextToken,this._dataFieldName,e)),O.a.instance.reportSuccess(t)}catch(e){var i;throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,i),e}},Object.defineProperty(t.prototype,"_dataFieldName",{get:function(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name},enumerable:!1,configurable:!0}),t}(D.a),U=r("JFej"),z=r("Ini7"),q=r("FGem"),X=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;c=t;var l=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return s._clientApiExecutorOptionsetBase=new E.a(t,"ClientApi.XrmControlOptionSetBase.",n,r,l),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){var r=this;this._clientApiExecutorOptionsetBase.execute("addOption",(function(){var n=r._options.length;Object(j.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,c.dispatch(Object(U.b)(r.pageId,r.contextToken,r.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))}),[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])},t.prototype.clearOptions=function(){var e=this;this._clientApiExecutorOptionsetBase.execute("clearOptions",(function(){c.dispatch(Object(q.b)(e.pageId,e.contextToken,e.controlDescriptor.DataFieldName))}))},t.prototype.removeOption=function(e){var t=this;return this._clientApiExecutorOptionsetBase.execute("removeOption",(function(){c.dispatch(Object(z.b)(t.pageId,t.contextToken,t.controlDescriptor.DataFieldName,e))}),[{name:"value",value:e,isRequired:!0}])},t.prototype.getOptions=function(){var e=this;return this._clientApiExecutorOptionsetBase.execute("getOptions",(function(){return e._options}))},Object.defineProperty(t.prototype,"_options",{get:function(){var e=new Array,t=Object(v.B)(c.getState(),this.pageId,this.contextToken,this.name);if(t)for(var r in t.length&&e.push({text:"",value:NaN}),t)e.push({text:t[r].Label,value:t[r].Value});return e},enumerable:!1,configurable:!0}),t}(D.a),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"},t}(X),H=r("ABRM"),Q=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._isDateFormatDateTime=!1,l=t,s._clientApiExecutorDateTime=new E.a(t,"ClientApi.XrmControlDateTime.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s._clientApiExecutorDateTime.execute("constructor",(function(e,t){s._isDateFormatDateTime=s._getShowTime(e,t)}),null,!1),s}return Object(f.__extends)(t,e),t.prototype.getShowTime=function(){var e=this;return this._clientApiExecutorDateTime.execute("getShowTime",(function(t,r){return e._getShowTime(t,r)}))},t.prototype.setShowTime=function(e){var t=this;this._clientApiExecutorDateTime.execute("setShowTime",(function(r,n){if(t._getShowTime(r,n)!==e){var a=e&&t._isDateFormatDateTime?"datetime":"date";l.dispatch(Object(H.b)(t.pageId,t.contextToken,t.name,a))}}))},t.prototype._getShowTime=function(e,t){var r=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!r||"datetime"===r.Format},t}(D.a),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"},t}(X),K=r("455M"),J=r("Dlr/"),Z=r("Sscr"),$=r("7bez"),ee=r("h82J"),te=r("Gemh"),re=function(e){function t(t,r,n,a,i){var o=e.call(this,t,r,n,a,a.Name,i)||this,s=Object(Z.e)(r,a.Name);return t.dispatch(Object(ee.a)(o,n,s)),u=t,o._clientApiExecutorControlstream=new E.a(t,"ClientApi.XrmControlStream.",n,r),o}return Object(f.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorControlstream},enumerable:!1,configurable:!0}),t.prototype._getGridControls=function(){if(!this._underlyingGridControls){this._underlyingGridControls=[];var e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){var t=e.StreamObjectCollection;if(t)for(var r=t.ShowAsTiles?[!0,!1]:[!0],n=0,a=t;n<a.length;n++)for(var i=a[n],o=0,s=r;o<s.length;o++){var c=s[o],l=Object(Z.o)(this.contextToken,this.getName(),i.Id,c),d=new $.a(u,l,this.pageId,!1,3,!0,this.formContext.applicationContext,l.controlName);this._underlyingGridControls.push({contextToken:l,gridControl:d})}}}return this._underlyingGridControls},t.prototype.refresh=function(){var e=this;this.clientApiExecutor.execute("refresh",(function(){for(var t=[],r=0,n=e._getGridControls();r<n.length;r++){var a=n[r],i=a.contextToken,o=a.gridControl;if(Object(te.hb)(u.getState(),e.pageId,i,i.controlName))try{o.refresh()}catch(e){t.push(e)}}if(t.length>0){var s=Object(f.__spreadArrays)(_.a.getInstance().getEventParameters(e.contextToken),[{name:"count",value:t.length}]);Object(j.e)(e.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,s)}}))},t}(b.a),ne=r("QAhb"),ae=r("TV33"),ie=r("Y+r4"),oe=r("ks02"),se=r("uQP8"),ce=r("6JRL"),le=r("kvLG"),ue=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,a.Name,i)||this;return d=t,s._clientApiExecutor=new E.a(t,"ClientApi.XrmControlSubFormBase.",n,r,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),s._xrmControlFactory=o,s}return Object(f.__extends)(t,e),t.prototype.getParentComponent=function(){return Object(se.a)(d.getState(),this.pageId)},Object.defineProperty(t.prototype,"context",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",(function(){return e._form?e._form.context:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentFormContext",{get:function(){return this.formContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_form",{get:function(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ce.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);var e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;var t=this._getValueInternal(),r=Object(ae.d)(t);return e?(this._formInstance=d.dispatch(Object(ee.b)(this._subFormInstanceId,e)),this._formInstance||r&&r.length>0&&(this._formInstance=d.dispatch(this._createXrmForm(e,this._subFormInstanceId,r[0].entityType,new B.a(r[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance):(_.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),le.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null)},enumerable:!1,configurable:!0}),t.prototype._createXrmForm=function(e,t,r,n){var a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute:function(i,o){var s=new ie.a(i,{etn:r,id:n},a,e,t);s.applicationContext=o;var c=new oe.a(i,t);return s.context=c,s}}},Object.defineProperty(t.prototype,"_subFormControlContextToken",{get:function(){var e=this._getValueInternal(),t=Object(ae.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",(function(){return e._form?e._form.data:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",(function(){return e._form?e._form.ui:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){return O.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null},enumerable:!1,configurable:!0}),t.prototype.getControl=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",(function(){return t._form?t._form.getControl(e):null}))},t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",(function(){return t._form?t._form.getAttribute(e):null}))},t.prototype.getUrl=function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",(function(){return e._form?e._form.getUrl():null}))},t.prototype.refresh=function(){var e=this;this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",(function(){e.data&&e.data.refresh()}))},t.prototype._getValueInternal=function(){var e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),r=t?new ne.a(e,new B.a(t)):new ne.a(e),n=Object(v.ac)(d.getState(),this._subFormInstanceId,this.contextToken);return Object(v.X)(d.getState(),this._subFormInstanceId,this._subFormContextToken,n,r,this.controlDescriptor.DataFieldName)},t}(b.a),de=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return p=t,s}return Object(f.__extends)(t,e),t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.l)(this.contextToken,this.name,this._entityType)},t.prototype.getSubFormInstanceId=function(){return this.pageId},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._tryGetSubFormInstanceId=function(){},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this.pageId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e="ClientApi.XrmControlQuickForm.isLoaded";try{O.a.instance.reportCall(e);var t=Object(v.ic)(p.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return O.a.instance.reportSuccess(e),!!t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"},t}(ue),pe=function(e){function t(t,r,n,a,i,o){var s;return t||Object(j.j)("ClientApi.XrmStandardDataControl.constructor","store"),s=e.call(this,t,r,n,a,i,o)||this,h=t,s}return Object(f.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmStandardDataControl.getValue";try{O.a.instance.reportCall(e);var t=Object(v.F)(h.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return O.a.instance.reportSuccess(e),t}catch(t){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.addOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),h.dispatch(Object(I.e)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.removeOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(j.j)(t,"handler");try{O.a.instance.reportCall(t),h.dispatch(Object(I.z)(this.contextToken,this.pageId,this.name,e)),O.a.instance.reportSuccess(t)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.fireOnKeyPress=function(){var e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{O.a.instance.reportCall(e),h.dispatch(Object(I.R)(this.contextToken,this.pageId,this.name,this)),O.a.instance.reportSuccess(e)}catch(r){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,r,null,t),r}},t}(D.a),he=r("1PXy"),ge=r("lRv2"),me=r("QUnS"),fe=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"DependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"DependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"DependentOptionSet.setVisible",t)}))},t}(W),be=function(e){function t(t,r,n,a,i,o){var s=e.call(this,t,r,n,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,r,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setVisible",t)}))},t}(Y),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.setDisabled=function(e){var t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";O.a.instance.reportUsage(t),Object(j.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))},t}(pe),ye=r("F2uj"),_e=r("cZkS"),Oe=r("qC0c"),Se=r("2OIc"),Ce=r("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Ie,je,Pe=function(e){function t(t,r,n,a,i,o){var s,c,l=e.call(this,t,r,n,a,i,o)||this;return l._formInstanceId=null===(c=null===(s=l.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===c?void 0:c.formInstanceIdByControlName[l.controlDescriptor.Name],l._formComponentClientApiExecutor=new E.a(t,"ClientApi.XrmControlFormComponent.",l._formInstanceId),l._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),Ie=t,l}return Object(f.__extends)(t,e),t.prototype._tryGetSubFormInstanceId=function(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._getSubFormContextToken=function(e,t,r){return Object(Z.h)(r)},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this._formInstanceId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e=this;return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",(function(){return!!Object(v.yc)(Ie.getState(),e._subFormInstanceId,e._subFormControlContextToken)}))},t.prototype.setInitializationIntent=function(e){var t=this;void 0===e&&(e="fullload"),this._formComponentClientApiExecutor.execute("setInitializationIntent",(function(r){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n,a,i,o,s;"nothing"!==e&&"fullload"!==e&&Object(j.h)(r,e,"intent"),Ie.dispatch((n=t.pageId,a=t.name,i=t.contextToken,o=e,s=Object(Z.v)(i),{type:Ce.d,payload:o,meta:{pageId:n,controlName:a,contextKey:s}}))}),[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])},t.prototype.getControlType=function(){return O.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"},t}(ue),Te=r("HHlV"),Ee="3d180de6-b456-4d90-9d5a-9899936baf44",we=function(){function e(e,t){this._pageId=t,je=e}return e.prototype.createXrmControl=function(e,t,r,n,a){Object(j.g)(t,n,"control");try{a.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),a.push({name:"controlName",value:t?t.Name:""}),a.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),a.push({name:"pageId",value:this._pageId});var i=Object(m.l)(je.getState(),this._pageId);a.push({name:"pageType",value:i});var o=!1,s=null,c=this._getControlType(t,r,e,n,a);switch(c){case g.i.guid:s=new T(je,e,this._pageId,t,t.Name,r);break;case K.a.KbContent:case K.a.KbArticle:case g.C.guid:case g.I.guid:s=new N(je,e,this._pageId,t,t.Name,r);break;case K.a.LookupRegarding:case K.a.LookupCustomer:case K.a.LookupMultiEntity:case K.a.LookupOwner:case K.a.LookupSimple:case K.a.LookupPartyList:case g.M.guid:case g.fb.guid:case g.S.guid:case g.l.guid:if(Object(Oe.c)(je.getState(),_e.jb)){var l=Object(se.b)(je.getState(),this._pageId,e);if(Object(Se.c)(je.getState(),t.UniqueId,l)===Te.d){s=new Pe(je,e,this._pageId,t,r,this);break}}s=new G(je,e,this._pageId,t,t.Name,r);break;case K.a.OptionSet:case g.U.guid:if(1==Object(Oe.c)(je.getState(),_e.L)){var u=this._getEntityNameForControl(t,r);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new fe(je,e,this._pageId,t,t.Name,r);break}}case K.a.EntityNameOptionSet:case K.a.TwoOptions:case K.a.StatusOptionSet:case g.sb.guid:case g.K.guid:case g.W.guid:case g.V.guid:case g.hb.guid:case g.n.guid:case g.N.guid:s=new W(je,e,this._pageId,t,t.Name,r);break;case K.a.MultiSelectPicklist:case g.Q.guid:if(Object(Oe.c)(je.getState(),_e.L)){u=this._getEntityNameForControl(t,r);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new be(je,e,this._pageId,t,t.Name,r);break}}s=new Y(je,e,this._pageId,t,t.Name,r);break;case K.a.QuickForm:case g.cb.guid:case g.ab.guid:case g.Z.guid:var d=new de(je,e,this._pageId,t,r,this);r.ui.quickForms.add(t.Name,d);break;case K.a.SearchWidget:case K.a.ReferencePanelSearchWidget:case g.db.guid:case g.kb.guid:s=new C.a(je,e,this._pageId,t,t.Name,r);break;case K.a.TimelineWall:case g.qb.guid:(s=je.dispatch(Object(ee.f)(this._pageId,Object(Z.p)(e,t.Name))))||(s=new he.a(je,e,this._pageId,t,t.Name,t.LabelId,r,r.applicationContext));break;case K.a.DateAndTimeDateOnly:case K.a.DateAndTimeDateAndTime:case g.q.guid:s=new Q(je,e,this._pageId,t,t.Name,r);break;case K.a.Grid:case g.eb.guid:case g.E.guid:var p=Object(Z.p)(e,t.Name),h=je.dispatch(Object(ee.c)(this._pageId,p));h&&(h.getName||3!==h.getGridType()?s=h:(_.a.getInstance().reportFailure(n,new Error("Main grid found in cache - converting to a subgrid."),null,a),je.dispatch(Object(ee.h)(this._pageId,p)))),s||(s=new J.a(je,e,this._pageId,t.Name,Object(te.wb)(je.getState(),this._pageId,e,t.Name),r,t,r.applicationContext));break;case K.a.Timer:case g.rb.guid:s=new S(je,e,this._pageId,t,t.Name,r);break;case K.a.WebResourceHtmlControl:case g.ub.guid:case g.vb.guid:s=new A(je,e,this._pageId,t,t.Name,r);break;case g.mb.guid:s=new re(je,e,this._pageId,t,r);break;case g.z.guid:case g.G.guid:break;case Ee:if(Object(Oe.c)(je.getState(),_e.L)&&Object(ye.l)(je.getState(),e.entityTypeName,t.Name)){s=new ve(je,e,this._pageId,t,t.Name,r);break}case K.a.AppliedFilters:case K.a.BusinessProcessFlow:case K.a.Card:case K.a.Currency:case K.a.Dashboard:case K.a.Decimal:case K.a.EmailEngagementActions:case K.a.EmailEngagementRecipientActivity:case K.a.FP:case K.a.GlobalFilter:case K.a.MicrosoftFlow:case K.a.Multiple:case K.a.PowerBI:case K.a.ReferencePanel:case K.a.Search:case K.a.SingleLineAddress:case K.a.SingleLineEmail:case K.a.SingleLinePhone:case K.a.SingleLineText:case K.a.SingleLineTextArea:case K.a.SingleLineTickerSymbol:case K.a.SingleLineURL:case K.a.SocialInsightsControl:case K.a.WholeDuration:case K.a.WholeLanguage:case K.a.WholeNone:case K.a.WholeTimeZone:case g.a.guid:case g.b.guid:case g.c.guid:case g.d.guid:case g.e.guid:case g.f.guid:case g.g.guid:case g.h.guid:case g.j.guid:case g.k.guid:case g.m.guid:case g.p.guid:case g.r.guid:case g.s.guid:case g.t.guid:case g.u.guid:case g.v.guid:case g.w.guid:case g.x.guid:case g.y.guid:case g.A.guid:case g.B.guid:case g.D.guid:case g.H.guid:case g.J.guid:case g.L.guid:case g.O.guid:case g.P.guid:case g.R.guid:case g.T.guid:case g.X.guid:case g.Y.guid:case g.bb.guid:case g.gb.guid:case g.ib.guid:case g.jb.guid:case g.lb.guid:case g.mb.guid:case g.nb.guid:case g.ob.guid:case g.pb.guid:case g.tb.guid:case g.wb.guid:o=!0;default:s=t.DataFieldName?new pe(je,e,this._pageId,t,t.Name,r):new b.a(je,e,this._pageId,t,t.Name,r),o||(a.push({name:"controlType",value:c}),le.a.getInstance().traceManager.getTracer(n).error("Unknown Form Control",a))}return s}catch(e){return _.a.getInstance().reportFailure(n+".createXrmControl",e,null,a),null}},e.prototype._getControlType=function(e,t,r,n,a){if(B.a.equals(e.ClassId,g.o)){var i=this._getCustomControlType(e,t,r);return i||le.a.getInstance().traceManager.getTracer(n+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:i}),i}return e.ClassId.guid},e.prototype._getCustomControlType=function(e,t,r){var n,a,i,o=Object(se.b)(je.getState(),this._pageId,r),s=Object(ge.c)(je.getState(),e,o);if(!s){var c=Object(v.h)(),l=(null===(a=null===(n=t.data)||void 0===n?void 0:n.entity)||void 0===a?void 0:a.getEntityName())||"",u=c(je.getState(),e,this._pageId,o,l);if(u||(u=Object(me.a)(je.getState(),e,this._pageId,r)),null==u?void 0:u.Parameters)for(var d in u.Parameters)if(null===(i=u.Parameters[d])||void 0===i?void 0:i.Primary){s=u.Parameters[d].Type;break}}return s},e.prototype._getEntityNameForControl=function(e,t){var r="";if(e.Relationship)r=Object(v.T)(je.getState(),this._pageId,e.Relationship);else{var n=t.getAttribute(e.DataFieldName);n&&n.getParent()&&(r=n.getParent().getEntityName())}return r},e}()},mVnn:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var r=Object(n.Zb)(e,t);return r&&r.output?r.output.value:null}},"n+eO":function(e,t,r){"use strict";r.d(t,"a",(function(){return F}));var n=r("r0tX"),a=r("9r0m"),i=r("WS0f"),o=r("9rlF"),s=r("nbQV"),c=r("TCcM"),l=r("T576"),u=r("QAhb"),d=r("A/RO"),p=r("Kdvm"),h=r("4HtA"),g=r("r3Bs"),m=r("LdMy"),f=r("sOTk"),b=r("mLFd"),v=r("G7N+"),y=r("ed60"),_=r("uwKl"),O=r("DUDQ"),S=r("lFQy"),C=r("gk6Q"),I=r("HSdq"),j=r("pflg"),P=r("b1hT"),T=r("lMVv"),E=r("2ojE"),w=r("LhJP"),F=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e,Object(C.c)(e._instance)),e._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t,n){var a=this;return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=n,this._processManager=new h.a(e,t,n,new m.a,new g.a),this._businessProcessFlowWrapperIdentifierFactory=new p.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),r.e(49).then(r.bind(null,"pG8E")).then((function(e){var t=e.BusinessProcessPageWrapper;return a._businessProcessPerPageWrapper=new t(a._applicationContext,a._getState,a._dispatch),Promise.resolve()})))},e.prototype.getBusinessProcessFlowWrapper=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))},e.prototype.getProcessManager=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)},e.prototype.getCurrentProcessManagerWithoutInit=function(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);var t=Object(f.g)(this._getState(),e),r=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,n=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(E.a)(this._getState(),r,e,this._applicationContext);return n.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null},e.prototype.hasChanged=function(e,t,r,n){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,n)))return!0;if(!t)return!1;var a=new u.a(t.entityTypeName,t.id),o=Object(l.f)(e,a);return!Object(i.a)(o)&&(!r||o>r.instanceModifiedTimestamp)||this._needsDockedModeRefresh(r,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,r,n)},e.prototype._needsDockedModeRefresh=function(e,t){return this._processManager.getDisplayState()===n.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)},e.prototype._reloadData=function(e,t){var r=this,n=this._getState();this._pageId=e,this._pageInfo=t;var d=Object(f.g)(n,e);if(d){var p=d.id,h=new u.a(d.entityTypeName,p);if(this._processIdInState=Object(c.e)(n,h),Object(P.g)(n)&&(!Object(P.d)(n)||Object(P.c)(n,e))){var g=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(E.c)(w.e,g,this._applicationContext)}var m=Object(j.a)(d),b=Object(j.b)(d);if(a.a.equals(h.id,a.a.EMPTY)&&m&&b){var C=Object(s.b)(n,m),I=new u.a(C.businessProcessFlowUniqueName,b),F=Object(l.b)(n,I);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(F,d),void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,m,I,e)}if(this._processIdInState){C=Object(s.b)(n,this._processIdInState);if(!Object(i.a)(C)&&Object(v.b)(C.initialized)){I=new u.a(C.businessProcessFlowUniqueName,Object(c.f)(n,h)),F=Object(l.b)(n,I);if(a.a.equals(h.id,a.a.EMPTY)){var x=Object(P.b)(C);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(S.a)(null,I))),x&&x.stage&&x.stage.stageId){var A=Object(P.a)(x);return this._dispatch(Object(O.b)(I,A)),void this._processManager.initilaizeWithProcessAndFormEntity(A.fields,C,h,this._processIdInState,I,e)}}else if(Object(i.a)(F))return;var N=Object(T.h)(n,h.etn);if(N&&N.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,this._processIdInState,I,e);for(var D in F)if(Object(o.k)(F[D])&&F[D].reference&&F[D].reference.id&&F[D].reference.etn===h.etn&&(a.a.equals(F[D].reference.id,h.id)||a.a.equals(F[D].reference.id,a.a.EMPTY))&&Object(P.e)(D))return void this._processManager.initilaizeWithProcessAndFormEntity(F,C,h,this._processIdInState,I,e);var k=this._dispatch(Object(y.b)(a.a.EMPTY,h)),M=this._dispatch(Object(_.b)(a.a.EMPTY,h));Promise.all([k,M]).then((function(t){r._processManager.initilaizeWithFormEntityOnly(h,e)}))}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}},e.prototype._reloadDataIfRequired=function(e,t){var r=this._getState(),n=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=n;var i=null,o=!1;if(n&&(i=Object(c.b)(n)(r,n.etn))&&(o=i.refreshGlobalNavigationData),!Object(P.g)(r)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(P.g)(r)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(b.b)(!1,n)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){var s=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),l=this._processManager.getTelemetryParams();s.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",l)}this._reloadDataCount++}else this._reloadDataCount=0},e.prototype._hasProcessChanged=function(e){var t=this._processIdInState||a.a.EMPTY,r=this._getState(),n=new u.a(e.entityTypeName,e.id),i=Object(f.g)(r,this._pageId),o=Object(j.a)(i),l=a.a.equals(n.id,a.a.EMPTY)&&o?o:Object(c.e)(r,n)||a.a.EMPTY;if(!a.a.equals(l,t))return!0;if(a.a.equals(l,a.a.EMPTY))return!1;var d=Object(s.b)(r,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion},e.prototype._moveToNextStageForCrossEntityBPF=function(e,t){var r=e.activestageid,n=e.traversedpath,i=t.data.nextStageId;if(!i){var o=Object(j.a)(t),s=Object(j.b)(t);if(!a.a.equals(o,this._processManager.getProcessId())||!a.a.equals(s,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}a.a.equals(r.reference.id,new a.a(i))||(r.reference=new u.a("processstage",new a.a(i)),n.value=n.value+","+i,e.activestagestartedon.value=new Date)},e}()},n4BT:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="form.ViewPortSizes.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.v)(t);return{type:a,payload:{viewportWidth:r,viewportHeight:i},meta:{pageId:e,contextKey:o}}}},nIt0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("uO/V"),i=r("uQP8"),o="control.update.formlessControlOutputs";function s(e,t,r){return{type:"control.update.formlessControlOutputs.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(a.z),p=a.x+".formlessControlOutputsIdAction";try{if(!Object.keys(r).length)return Promise.resolve();var h=u(),g=Object(i.a)(h,e),m=Object(n.__assign)({},g.formlessControlOutputs),f=!1;for(var b in d.info("Updating the unbound output."),r){var v=r[b],y=t+"."+b;m[y]!==v&&(m[y]=v,f=!0)}return f&&l(function(e,t){return{type:o,payload:{formlessControlOutputs:t},meta:{pageId:e}}}(e,m)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var _="Updating the outbound outputs for the grid failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(_))}}}}},nn4v:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},"o0+l":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="attribute.submitmode";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r,i){var o=Object(n.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:r}}}},oUmu:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r("i8/j"),a=r("7z0H"),i="form.ui.metadata.update";function o(e,t,r){return{type:"form.ui.metadata.update.async",execute:function(o,s,c){var l=o.dispatch,u=(0,o.getState)(),d=Object(n.j)(u,e),p=Object(a.g)(u,d,e);return l(function(e,t,r,n){return{type:i,payload:{formId:e,formUIState:t},meta:{pageId:r,contextToken:n}}}(e,p,t,r)),Promise.resolve()}}}},oY7N:function(e,t,r){"use strict";r.d(t,"a",(function(){return Wt}));var n=r("c/eZ"),a=r("nuS9"),i=r("4fxQ"),o=r("D9ys"),s=r("4E+q"),c=r("YWpA"),l=r("hPFj"),u=r("H/hG"),d=r("e9UD"),p=r("znb3"),h=r("NJzV"),g=r("VnpK"),m=r("POU9"),f=r("vP/5"),b=r("0u+G"),v=r("uO/V"),y=2/(1+Math.sqrt(5)),_=function(e){function t(t){var r=e.call(this,t)||this;return r._memorizedDescriptor=null,r.onMeasuring=r.onMeasuring.bind(r),r.state={width:0,height:0},r}return Object(n.__extends)(t,e),t.prototype._getGoldenRatioHeight=function(e){return y*e},t.prototype.onMeasuring=function(e,t){var r=!1,n={};e!==this.state.width&&(n.width=e,r=!0),t!==this.state.height&&(n.height=t,r=!0),r&&this.setState(n)},t.prototype.render=function(){var e=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null;if(!this.props||!this.props.showChart||!this.props.configuration)return e&&e.info("Chart not rendered because the configuration is missing or show chart is set to false"),null;this._memorizedDescriptor&&this.props.chartId===this._memorizedDescriptor.Id||(this._memorizedDescriptor={Id:this.props.chartId,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1});var t,r,n=parseFloat(getComputedStyle(document.documentElement).fontSize),i=this._getTopAndBottomAdjustment(n),o=this._getLeftAndRightAdjustment(n);this.props.isLayoutVertical?(t=this.state.width-o,r=this._getGoldenRatioHeight(t),this.props.style.minHeight=r+i):(t=Math.max(this.state.width,320)-o,r=this.state.height-i);var s={minWidth:t.toString()+"px",minHeight:r.toString()+"px"},l={width:t>0?t:-1,height:r>0?r:-1,eventListeners:[{eventname:"onChartPaneClose",eventhandler:[this._closeChartPane.bind(this)]}]};return a.createElement(c.a,{key:"pageChart_"+this.props.id,testhooks:{id:"pageChart_"+this.props.id},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},a.createElement(c.a,{key:"pageChart_"+this.props.id+"_container",style:s},a.createElement(h.c,{key:this.props.chartId,controlId:this.props.chartId,id:this.props.id,configuration:this.props.configuration,descriptor:this._memorizedDescriptor,parentDefinedControlProps:l,parentContextToken:this.props.contextToken})))},t.prototype._closeChartPane=function(){this.props.closeChartPaneHandler(this.props.id,this.props.contextToken,!1)},t.prototype._getTopAndBottomAdjustment=function(e){var t=0;return this.props.style.borderTopWidth&&(t+=e*("string"==typeof this.props.style.borderTopWidth?parseFloat(this.props.style.borderTopWidth||"0px"):this.props.style.borderTopWidth)),this.props.style.paddingTop&&(t+=e*("string"==typeof this.props.style.paddingTop?parseFloat(this.props.style.paddingTop||"0px"):this.props.style.paddingTop)),this.props.style.borderTop&&(t+=1),this.props.style.borderBottom&&(t+=1),t},t.prototype._getLeftAndRightAdjustment=function(e){var t=0;return this.props.style.paddingLeft&&(t+=e*("string"==typeof this.props.style.paddingLeft?parseFloat(this.props.style.paddingLeft||"0px"):this.props.style.paddingLeft)),this.props.style.paddingRight&&(t+=e*("string"==typeof this.props.style.paddingRight?parseFloat(this.props.style.paddingRight||"0px"):this.props.style.paddingRight)),this.props.style.borderLeft&&(t+=1),this.props.style.borderRight&&(t+=1),t},t}(a.Component),O=r("9r0m"),S=r("ah4O"),C=r("RlP9"),I=r("r2h9"),j=r("RB3d"),P=r("perk"),T=r("Gemh"),E=r("pWlk"),w=r("olrR"),F=r("mGpW"),x=r("Ww2r"),A=r("gBKR"),N=r("lMVv"),D=r("G7N+"),k=r("hXUt"),M=r("5Fed"),R=r("Ev4I"),L=r("JlqV"),B=r("pJ3X"),V=r("oVzJ"),G=r("cZkS"),U=r("qC0c"),z=r("PMTb"),q=[],X=function(e){function t(t){var r=e.call(this,t)||this;return r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onChange=r._onChange.bind(r),r.props.entityTypeName.toLowerCase()===T.a&&(r.props.loadAllActivityTypes(t.activities),r.props.loadAllActivityResourceString()),r}return Object(n.__extends)(t,e),t.prototype._getEntityTypeNameFromViewId=function(e){return e&&this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[e]&&this.props.gridViewSelectorItems[e].relatedEntityName?this.props.gridViewSelectorItems[e].relatedEntityName:null},t.prototype._onChange=function(e){var t;this.props.isGridRoot&&this.props.pageToEditedViewMapId&&this.props.selectedViewId!==e&&this.props.removeEditedViewPageMap(null===(t=this.props.pageToEditedViewMapId)||void 0===t?void 0:t.guid,new O.a(this.props.selectedViewId)),this.props.onChange(e,this.props.entityTypeName===T.a?this._getEntityTypeNameFromViewId(e):this.props.entityTypeName)},t.prototype._isViewSelectorHidden=function(){return!(this.props.gridViewSelectorItems&&this.props.viewCategories&&this.props.selectedViewId)},t.prototype.render=function(){var e=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_TOOLTIP),t=this.props.contextString===v.h.GRID,r=t?this._onItemIconPointerDown:null,n=this.props.useViewSelectorV2?this.props.isPhone:this.props.isTablet,i=n?this.props.styleProps.textStyleMobile:this.props.styleProps.textStyle,o=n?this.props.styleProps.viewSelectorMobileStyle:this.props.styleProps.viewSelectorStyle,s=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null;if(this._isViewSelectorHidden())return s&&s.info("View Selector not rendered because view selector items or view categories or selected view is not available."),null;var c=[],l=!1;for(var u in this.props.gridViewSelectorItems){var d=this.props.gridViewSelectorItems[u];if(d){var h=d.isUserView;h&&(l=!0);var g=void 0;if(this.props.entityTypeName===T.a&&this.props.pinnedActivityView){var m=d;g=m.isPinned&&this.props.pinnedActivityView.PinnedEntity===m.relatedEntityName}else g=d.isPinned;var f=t?g?p.a.Pinned:p.a.Pin:null,b={":hover":{"::before":{content:g?'""':'""'}}};this.props.useViewSelectorV2&&Object.assign(b,{marginLeft:"8px",marginRight:"8px"});var y=t?b:null,_=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_DEFAULTVIEW),O=Object(x.c)(this.props.resourceStrings,P.VIEWSELECTOR_SETDEFAULTVIEW),C=t?g?_:O:null,E="";E=this.props.entityTypeName===T.a&&this.props.allActivitiesString&&this.props.shouldDisplayNestedViewSelector?(q.indexOf(d.relatedEntityName)+1).toString():h?I.b.userview.toString():I.b.savedview.toString();var w=d.name;u===this.props.selectedViewId&&this.props.isEdited&&(this.props.isRTL?w="*"+w:w+="*"),c.push({value:u,text:w,categoryId:E,iconType:f,iconTitle:C,iconStyle:y})}}if(this.props.selectedViewId&&this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId){var F=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_VIEWS_LABEL_ID);c.push({value:this.props.selectedViewId,text:F,categoryId:I.b.savedview.toString()})}var A=l?this.props.viewCategories:this.props.viewCategories.filter((function(e){return e.id!==I.b.userview.toString()}));return this.props.isGridRoot&&this.props.isInMobileModeForOct2019?a.createElement(B.c,{pageId:this.props.pageId},this.props.isAdvancedFindView?a.createElement(z.a,null,"New view"):a.createElement(B.k,{items:c,selectedItemId:this.props.selectedViewId,onChange:this._onChange})):this.props.isAdvancedFindView?a.createElement(z.a,{style:i},"New view"):a.createElement(S.a,{id:this.props.id,testhooks:{id:"ViewSelector_"+this.props.selectedViewId},value:this.props.selectedViewId,role:"presentation",title:e,categories:A,options:c,style:this.props.style,caretType:p.a.ChevronDownMed,caretStyle:this.props.styleProps.caretStyle,textStyle:i,viewSelectorStyle:o,onChange:this._onChange,onItemIconPointerDown:r,createAccessibilityComponent:j.a,createKeyboardShortcut:j.b,parentCustomControlId:this.props.id,rootZIndex:this.props.rootZIndex,isRTL:this.props.isRTL,useViewSelectorV2:this.props.useViewSelectorV2,placeItemIconOnRight:!0,useHeader:this.props.isGridRoot})},t.prototype.componentDidMount=function(){var e=this;if(this.props.viewIds?this.props.loadGridViewsByViewId(this.props.viewIds,this.props.entityTypeName):this.props.loadViewsByType(this.props.queryViewSelectorTypes,this.props.entityTypeName,this.props.gridViewSelectorItems),!this._isViewSelectorHidden()){var t=!1;if(this.props.selectedViewId&&""!==this.props.selectedViewId&&(this.props.gridViewSelectorItems&&this.props.gridViewSelectorItems[this.props.selectedViewId]||this.props.quickFindViewId&&this.props.quickFindViewId===this.props.selectedViewId)&&(t=!0),!t){if(this.props.viewIds)this.props.viewIds.find((function(t){return t.guid===e.props.selectedViewId}))&&(t=!0);this.props.defaultViewId&&this.props.defaultViewId.guid!==O.a.EMPTYSTRING&&this.props.onChange(this.props.defaultViewId.guid,this.props.entityTypeName)}}},t.prototype._onItemIconPointerDown=function(e){var t=this,r=e,n=e.iconType===p.a.Pinned,a=this.props.TraceManager&&this.props.TraceManager.getTracer?this.props.TraceManager.getTracer(v.z):null,i=e.categoryId,o=this.props.entityTypeName;if(this.props.entityTypeName===T.a){var s=this.props.gridViewSelectorItems;o=s&&s[e.value]?s[e.value].relatedEntityName:o,i=!(!s||!s[e.value])&&s[e.value].isUserView?I.b.userview.toString():I.b.savedview.toString()}a&&a.info("Toggle the the pin status for "+e.value+" for "+o+" entity"),this.props.onItemIconPointerDown(o,e.value,i,"",n).then((function(){if(a&&a.info("Resetting the pin status of all the options and toggle the pin status of the recently selected item"),!n&&t.props.entityTypeName===T.a){var i=t.props.gridViewSelectorItems[r.value];t.props.pinnedActivityView.PinnedEntity=i.relatedEntityName,t.props.pinnedActivityView.ViewId=new O.a(e.value),t.props.pinnedActivityView.ViewType=i.isUserView?I.b.userview:I.b.savedview}for(var o in t.props.gridViewSelectorItems)t.props.gridViewSelectorItems[o].isPinned=o===r.value&&!n;t.forceUpdate()}),(function(e){a&&a.error("Could not pin the selected view, pinning action failed with error "+e)}))},t}(a.Component);function W(e,t,r,n){var a=[];if(t===T.a&&n){var i=1;q.forEach((function(t){a.push({id:i.toString(),name:Object(N.f)(e,t)}),i++}))}else a=Object(T.mb)(e,r);return a}function H(e,t,r){var a;return t.forEach((function(t,i){var o=function(e,t,r){var n=Object(C.f)(e,t,r);n&&!Object(L.b)(e)&&Object(R.l)(e,t)&&(n=Object.keys(n).reduce((function(a,i){return(n[i].isAvailableInOffline||i===O.a.toString(Object(C.a)(e,t,r)))&&(a[i]=n[i]),a}),{}));return n}(e,r,t);o&&(a=Object(n.__assign)(Object(n.__assign)({},a),o))})),a}X.displayName="DataSetViewSelector";var Q=Object(s.a)((function(){var e=null,t=null,r=null,a={gridViewSelectorItems:null,viewCategories:null,allActivitiesString:null,activities:null,activityOptions:null,resourceStrings:null,quickFindViewId:null,styleProps:null},i=Object(E.a)(),o=Object(x.h)();return function(s,c){var l,u=o(s,P.labelList),d=O.a.toString(Object(C.a)(s,c.entityTypeName,I.a.QUICKFIND_SEARCH)),p=null,h=null,g=i(s,c.contextString);q=Object(T.B)(s);var m=!1;if(c.queryViewSelectorTypes&&c.queryViewSelectorTypes.length>0&&!c.viewIds){if(c.entityTypeName===T.a&&c.shouldDisplayNestedViewSelector?(q.forEach((function(e){var t=H(s,c.queryViewSelectorTypes,e);t&&(p=Object(n.__assign)(Object(n.__assign)({},p),t))})),h=Object(x.e)(s,["ViewSelectorAllActivities"])):p=H(s,c.queryViewSelectorTypes,c.entityTypeName),e)for(var f in p)if(!e[f]||e[f]!==p[f]){m=!0;break}}else if(c.viewIds){for(var b={},v=0;v<c.viewIds.length;v++){var y=Object(T.qb)(s,c.viewIds[v],c.id);if(y&&y.grid&&y.grid.rows){var _=e?e[y.viewId.guid]:void 0,S=!_||_.name!==y.title||_.queryType!==y.queryType;f=S?{name:y.title,queryType:y.queryType,isDefault:!1,isQuickFindQuery:!1,isUserView:y.isUserView}:_;Object.assign(b,((l={})[y.viewId.guid]=f,l)),m=m||S}}b&&(p=b)}return!p||e&&Object.keys(e).length===Object.keys(p).length||(m=!0),h&&a.allActivitiesString!==h.ViewSelectorAllActivities&&(m=!0),t!==d&&(m=!0),r!==g&&(m=!0),m&&(t=d,r=g,a={gridViewSelectorItems:e=p,viewCategories:W(s,c.entityTypeName,P,c.shouldDisplayNestedViewSelector),allActivitiesString:h&&h.ViewSelectorAllActivities,activities:null,activityOptions:null,resourceStrings:u,quickFindViewId:t,styleProps:r,isInMobileModeForOct2019:Object(V.b)(s),useViewSelectorV2:Object(U.a)(s,G.le,G.h)}),a}}),(function(e){return{loadViewsByType:function(t,r,n){var a=[];return t.forEach((function(t,i){t===I.a.MAIN_APPLICATION_VIEW&&n&&0!==Object.keys(n).length||a.push(e(Object(w.a)(r,t,void 0,void 0)))})),Promise.all(a)},loadAllActivityResourceString:function(){return e(Object(F.e)(["ViewSelectorAllActivities"]))},loadAllActivityTypes:function(t){var r=null;for(var n in t)t[n].Initialized!==D.a.Initialized&&(r||(r={}),r[n]=["DisplayName","ActivityTypeMask","IsVisibleInMobileClient"]);return r?e(Object(A.e)(r)):Promise.resolve()},loadGridViewsByViewId:function(t,r){var n=[];return t.forEach((function(t,a){n.push(e(Object(w.a)(r,void 0,void 0,t)))})),Promise.all(n)},openPopup:function(t){return e(Object(M.a)(t))},closePopup:function(t){return e(Object(k.a)(t))}}}))(X),Y=r("6Tlt"),K=r("Wg6j"),J=r("XIN1"),Z=r("r7Ib"),$=r("Md8f"),ee=r("5olG"),te=r("c96h"),re=42,ne=function(e){function t(t){var r=e.call(this,t)||this;return r.onMeasuring=r.onMeasuring.bind(r),r.state={commandbarWidth:0},r._lastCommandManagerId=t.commandManagerId,r}return Object(n.__extends)(t,e),t.prototype.onMeasuring=function(e){var t=e-((this.props.style.paddingLeft?"string"==typeof this.props.style.paddingLeft?Object(ee.e)(this.props.style.paddingLeft):this.props.style.paddingLeft:0)+(this.props.style.paddingRight?"string"==typeof this.props.style.paddingRight?Object(ee.e)(this.props.style.paddingRight):this.props.style.paddingRight:0))-(this.props.backButtonEnabled?re:0);t!==this.state.commandbarWidth&&this.setState({commandbarWidth:t})},t.prototype.componentDidUpdate=function(){this.props.commandManagerId!==this._lastCommandManagerId&&(this._lastCommandManagerId=this.props.commandManagerId,this.props.setCommandManagerId(this.props.pageId,this.props.commandManagerId,this.props.contextToken))},t.prototype._renderConsoleAppBackButton=function(){return this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.pageId}):null},t.prototype._renderNativeSubgridCommandBar=function(){return this.props.isNativeMode?a.createElement(B.e,{commandManagerId:this.props.commandManagerId,pageId:this.props.pageId}):null},t.prototype.render=function(){if(!this.props.pageId||!this.props.ribbonId||!this.props.commandManagerId)return null;var e=!this.state.commandbarWidth,t=a.createElement(Y.a,{commandBarStyle:this.props.commandbarStyles,width:this.state.commandbarWidth,commandbarDisplayMode:K.a.IconLabel,key:this.props.pageId,iconPosition:J.a.Left,commandManagerId:this.props.commandManagerId,id:this.props.pageId,ribbonId:this.props.ribbonId,relationshipType:this.props.relationshipType,addedCommandList:this.props.addedCommandList,appendedCommandList:this.props.appendedCommandList,contextToken:this.props.contextToken,metaDataLoadedResolve:this.props.metaDataLoadedResolve,isHidden:e,rootZIndex:this.props.rootZIndex,customControlType:this.props.customControlType,isNativeMode:this.props.isNativeMode});return this.props.isInMobileModeForOct2019&&this.props.isGridRoot?t:a.createElement(c.a,{key:"commandBar_"+this.props.pageId,testhooks:{id:"commandBar_"+this.props.pageId},style:this.props.style,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0},this._renderConsoleAppBackButton(),t,this._renderNativeSubgridCommandBar())},t}(a.Component);ne.displayName="DataSetCommandBar";var ae=Object(s.a)((function(){return function(e,t){var r=Object(V.b)(e);return{commandManagerId:Object(T.w)(e,t.pageId,t.contextToken)||t.commandManagerId,backButtonEnabled:Object(te.d)(e)&&t.isGridRoot&&!t.collapsed,isInMobileModeForOct2019:r}}}),(function(e){return{setCommandManagerId:function(t,r,n){t&&r&&n&&e(Object(Z.b)(t,r,n))}}}))(ne),ie=r("A6np"),oe=r("jigW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function se(e){if(e){var t=e.split(":");if(2===t.length)return t[1].split(",")}return[]}function ce(e){if(e&&e.filterOptions&&e.filterOptions.length>0){var t=e.filterOptions.filter((function(e){return e.isDefault})),r=e.userSetting,n=r&&r.defaultGridViews&&r.defaultGridViews[e.entityTypeName];n&&""!==n.QueueId&&(t=e.filterOptions.filter((function(e){return Object(T.bb)(n.QueueId).sort().join(",")===se(e.value).sort().join(",")})));var i=void 0,o=void 0;e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=Object(oe.f)(e.filterOptions,e.previousValue),o=e.previousValue),i||(t.length>0?(i=t[0].text,o=t[0].value):(i=e.filterOptions[0].text,o=e.filterOptions[0].value)),e.updateFilterValue(o);var s=Object(x.c)(e.resourceStrings,P.QUEUE_FILTER_LABEL),l=a.createElement(ie.a,{key:"gridFilter",testhooks:{id:"gridFilter_"+e},title:s,accessibilityLabel:s,defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,createKeyboardShortcut:j.b,freeTextMode:!0,suppressFreeTextChangeCallback:!0});return a.createElement(c.a,{key:"GridFilterView",style:e.style},l)}var u=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(v.z):null;return u&&u.info("Queue Filter not rendered because there are no filter options available"),null}var le=r("np0M"),ue=r("Oiu5"),de={Id:"toggleButtonControl",Label:null,Name:"toggleButtonControl",ShowLabel:!1,Visible:!0,Disabled:!1},pe={FormFactor:2,CustomControlId:"MscrmControls.FlipSwitch.FlipSwitchControl",Name:"MscrmControls.FlipSwitch.FlipSwitchControl",Version:"1.0.0",Parameters:{value:{Usage:3,Static:!1,Value:0,Type:"TwoOptions",Attributes:{DefaultValue:0,Options:null},Callback:null}},ShouldOverrideControlVisible:!1};function he(e,t){if(!e.isRollupViewSupported)return null;var r,i,o,s,c=function(e){var t=[];if(!Array.isArray(e))return t;for(var r=0;r<e.length;++r)t.push({Label:e[r],Value:r});return t}([Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_OFF),Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_ON)]),l=e.isOffline,u=(r=e.toggleValue,i=t,o=e.onToggleChange,s=c,Object(n.__assign)(Object(n.__assign)({},pe),{Parameters:{value:{Usage:3,Static:!1,Type:"TwoOptions",Value:r?1:0,Attributes:{DefaultValue:0,Options:s,DisplayName:i},Callback:o}}})),d=function(e,t){return Object(n.__assign)(Object(n.__assign)({},de),{Label:e,Disabled:t})}(t,l),p="rollup_view_switch_"+e.id;return a.createElement(h.c,{key:p,controlId:p,id:e.id,systemDefinedProperties:null,descriptor:d,configuration:u,formInfo:void 0,shouldRender:!0,parentContextToken:null,parentDefinedControlProps:void 0})}function ge(e,t,r,n,i){var o=e.theme,s=e.isRTL,l=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;return a.createElement(c.a,{key:"ActivityViewContainer",role:"presentation",style:e.activityViewContainerStyle},a.createElement(c.a,{key:"ActivityDueDateFilterView",style:l?e.activityTypeContainerStyle:e.containerStyle},[t,r]),i?a.createElement(c.a,{key:"ActivityTypeFilterView",style:e.activityTypeContainerStyle},[n,i]):null,function(e,t,r,n){if(!t)return;var i=Object(x.c)(e.resourceStrings,P.ROLLUPVIEW_SWITCH_LABEL),o={flex:"1 1 auto",marginLeft:r.sizes.Measures.Measure200,marginRight:r.sizes.Measures.Measure200,marginTop:r.sizes.Measures.Measure050,minWidth:"15rem"},s={whiteSpace:"nowrap",flex:"1 0 auto",marginRight:n?0:r.sizes.Measures.Measure100,marginLeft:n?r.sizes.Measures.Measure100:0};return a.createElement(c.a,{key:"RollupViewControlContainer",style:o},a.createElement(c.a,{key:"rollupViewFilterLabelView",style:s},i),he(e,i))}(e,e.isRollupViewSupported,o,s))}var me=Object(s.a)(void 0,(function(e){return{openPopup:function(t){return e(Object(M.a)(t))},closePopup:function(t){return e(Object(k.a)(t))}}}))((function(e){var t,n=e.TraceManager&&e.TraceManager.getTracer?e.TraceManager.getTracer(v.z):null,i="",o=e.isActivityManagementFeatureEnabled&&e.entityIsActivityType;if(e&&e.filterOptions&&e.filterOptions.length>0){var s=e.filterOptions.filter((function(e){return e.isDefault}));o&&(t=Object(ue.d)(e.filterOptions)),e.isGridPaginationStateFeatureEnabled&&null!=e.previousValue&&(i=o?e.previousValue:Object(oe.f)(e.filterOptions,e.previousValue)),i||(i=s.length>0?o?s[0].value:s[0].text:o?e.filterOptions[0].value:e.filterOptions[0].text)}var l=a.useState(i),d=l[0],p=l[1];if(e&&e.filterOptions&&e.filterOptions.length>0){var h=o?Object(x.c)(e.resourceStrings,e.dueDateFilterLabelResourceString):Object(x.c)(e.resourceStrings,e.entityFilterLabelResourceString),g=null;h&&(g=a.createElement(u.a,{key:"activityDueDateFilterLabel",style:o?e.activityMgmtLabelStyle:e.labelStyle}," ",h," "));var m=a.createElement(c.a,{key:"activityDueDateFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},g),f=a.createElement(ie.a,{key:"activityDueDateFilterComboBox",testhooks:{id:"activityDueDateFilterComboBox_"+e.id},id:"activityDueDateFilterComboBox",defaultValue:i,options:e.filterOptions,onChange:e.onFilterChange,createAccessibilityComponent:j.a,style:e.comboBoxStyle,textStyle:{flex:"1 0 auto",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"0px"},createKeyboardShortcut:j.b,openPopup:e.openPopup,closePopup:e.closePopup,parentCustomControlId:"activityDueDateFilterComboBox",rootZIndex:e.rootZIndex,accessibilityLabel:h,freeTextMode:!0,suppressFreeTextChangeCallback:!0});if(o&&(f=a.createElement(le.a,{key:"activityDueDateFilterComboBox",loader:function(){return Promise.all([r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(29),r.e(91)]).then(r.bind(null,"YDph")).then((function(e){return e.ComboBox}))},props:{selectedKey:d,key:"activityDueDateFilterComboBox",id:"activityDueDateFilterComboBox",options:t,onChange:function(t,r){p(r.key),e.onFilterChange(r.key)},style:e.dueDatecomboBoxStyle,ariaLabel:h,useComboBoxAsMenuWidth:!0,allowFreeform:!0}})),e.isActivityManagementFeatureEnabled&&!e.isOffline&&!e.isMobile&&e.gridEntityName===v.a){var b=null,y=Object(x.c)(e.resourceStrings,e.activityTypeFilterLabelResourceString);y&&(b=a.createElement(u.a,{key:"activityTypeFilterLabel",style:e.activityMgmtLabelStyle}," ",y," "));var _=a.createElement(c.a,{key:"activityTypeFilterLabelView",style:{alignItems:"center",justifyContent:"center"}},b),O=void 0;if(e.filterOptionsForActivityType&&e.filterOptionsForActivityType.length>0){n&&n.info("Activity Management Filter - Activity Type Filter Rendered with no. of options "+e.filterOptionsForActivityType.length);var S=Object(ue.c)(e.filterOptionsForActivityType);if(e.isActivityFilterSelectAllEnabled){var C=Object(x.c)(e.resourceStrings,P.ACTIVITYTYPE_SELECTALL),I=[];I.push({key:"selectAllKey",text:C}),S=I.concat(S)}var T=[];e.isGridPaginationStateFeatureEnabled&&null!=e.activityTypePreviousValues&&(T=Object(ue.b)(e.activityTypePreviousValues)),O=a.createElement(le.a,{key:"activityTypeFilterBox",loader:function(){return Promise.all([r.e(10),r.e(29),r.e(41)]).then(r.bind(null,"x3Jg")).then((function(e){return e.ActivityTypeCombobox}))},props:{key:"activityTypeFilterBox",id:"activityTypeFilterBox",selectedOptionKeys:T,onActivityTypeFilterClear:function(){e.onActivityTypeFilterClear()},onActivityTypeMenuDismissed:function(t){e.onActivityTypeChange(t)},options:S,ariaLabel:y,isRTL:e.isRTL,style:e.activityTypeContainerStyle,resourceStrings:e.resourceStrings,selectAllEnabled:e.isActivityFilterSelectAllEnabled}})}return ge(e,m,f,_,O)}return ge(e,m,f,null,null)}return n&&n.info("Activity Filter not rendered because there are no filter options available"),null})),fe=r("lU69"),be=r("gvL4"),ve=r("Smta"),ye=r("vTeb"),_e=r("evW+"),Oe=r("1AYO"),Se=r("19Zc"),Ce=r("wV3W"),Ie=r("vO+w");var je=r("rbxJ"),Pe=r("9rQ4"),Te=r("hl8w"),Ee=r("akzq"),we=r("Wi7Z"),Fe=r("B73A"),xe=r("E705"),Ae=r("YT7W"),Ne=r("TCzx"),De=function(e){function t(t){var r=e.call(this,t)||this;return r._cachedSelectedFilter="",r._onFilterChange=r._onFilterChange.bind(r),r._toggleJumpBarFlyout=r._toggleJumpBarFlyout.bind(r),r._closeJumpBarDomId="close-jumpbar-"+Object(fe.a)(),r._selectedFilterDomId="selected-filter-"+Object(fe.a)(),r.state={isFlyoutOpened:!1},r}return Object(n.__extends)(t,e),t.prototype._onOutsideClickHandler=function(e,t){var r=t.target,n=document.getElementById(e);r&&!n.contains(r)&&n!==r&&this._toggleJumpBarFlyout()},t.prototype.keyDownHandler=function(e){switch(e.EVENT.keyCode){case Pe.a.Escape:this._setIsFlyoutOpenedState(!1)}},t.prototype._toggleJumpBarFlyout=function(){this._setIsFlyoutOpenedState(!this.state.isFlyoutOpened)},t.prototype._setIsFlyoutOpenedState=function(e){this.setState({isFlyoutOpened:e}),Object(xe.g)(e)},t.prototype._filterGrid=function(e){var t,r=e.getAttribute("data-value");if(r!==this._cachedSelectedFilter&&(this.props.updateDataSetLoadingState(1),this._cachedSelectedFilter=r),1033===this.props.languageId&&r){var n=e.getAttribute("data-value").toUpperCase();n!==r&&(r=r+"|"+n)}t=this.props.dataSetFetchXml?Object(Te.c)(this.props.dataSetFetchXml,this.props.entityAttributeMetadata,this.props.primaryNameAttribute):this.props.primaryNameAttribute,this.props.applyGridFilter(Object(Te.b)(r,t),this.props.isGridRoot,this.props.contextToken),this._setIsFlyoutOpenedState(this.props.renderMobile&&!this.state.isFlyoutOpened)},t.prototype._onFilterChange=function(e){var t=e.target,r=e;("click"===e.type||r&&r.keyCode===Pe.a.Enter)&&(e.preventDefault(),t&&"a"===t.tagName.toLowerCase()&&(t=t.parentElement),this._filterGrid(t))},t.prototype._renderListItem=function(e,t,r){var i=Object(n.__assign)({},this.props.renderMobile?this.props.styles.listItemStyleMobile:this.props.styles.listItemStyle),o=Object(n.__assign)(Object(n.__assign)({},this.props.styles.hyperlinkStyle),this.props.renderMobile?this.props.styles.hyperlinkStyleMobile:null);return r.describedByElementId&&(i=Object.assign(i,this.props.renderMobile?this.props.styles.listItemSelectedStyleMobile:this.props.styles.listItemSelectedStyle),o=Object.assign(o,this.props.renderMobile?this.props.styles.hyperlinkSelectedStyleMobile:null)),a.createElement(ve.a,Object(n.__assign)({},r,{style:i}),a.createElement(ye.a,Object(n.__assign)({},e,{style:o}),t))},t.prototype._createKeyboardShortcuts=function(){var e=Object(x.c)(this.props.resourceStrings,P.CLOSE_JUMPBAR_ARIALABEL),t=this.keyDownHandler.bind(this),r=[],n=new Fe.a([Pe.a.Escape],t,!0,"",e);return r.push(n),r},t.prototype._renderJumpBarAlphabet=function(){var e=this,t=[],r=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET),n=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_INDICATOR),a=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_NUMBER_TOOLTIP),i=Ne.a.getInstance(),o=!!i&&i.get_IsIOS();return r.split(",").forEach((function(r){var i=Object(je.h)(r),s=i[0],c=i[1],l=s+"_listItem",u=s+"_link",d={id:l,key:l,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,c),role:we.q,onClick:e._onFilterChange,onKeyDown:e._onFilterChange,tabIndex:-1},p={id:u,key:u,testhooks:{id:u},tabIndex:-1,role:we.r,accessibilityHidden:!o,accessibilityLabel:o?String.format(P.FILTERBY_ARIALABEL,c):void 0};s===n&&(p.title=a,p.accessibilityLabel=P.NUMBER_ARIALABEL),e.props.selectedFilter!==s&&e.props.selectedFilter!==c||(d.describedByElementId=e._selectedFilterDomId,d.isSelected=!0,d.tabIndex=0),c&&(d.dataValue=c),t.push(e._renderListItem(p,s,d))})),t},t.prototype._renderJumpBarAll=function(){var e=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALL),t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALL_TITLE);this._allListItemDomId=e+"_listItem";var r=e+"_link",n=Ne.a.getInstance(),a=!!n&&n.get_IsIOS(),i={id:this._allListItemDomId,key:this._allListItemDomId,onClick:this._onFilterChange,onKeyDown:this._onFilterChange,role:we.q,tabIndex:-1,accessibilityLabel:String.format(P.FILTERBY_ARIALABEL,e)},o={id:r,key:r,testhooks:{id:r},tabIndex:-1,role:we.r,accessibilityHidden:!a,accessibilityLabel:a?String.format(P.FILTERBY_ARIALABEL,e):void 0,title:t};return this.props.selectedFilter&&this.props.selectedFilter!==e||(i.describedByElementId=this._selectedFilterDomId,i.isSelected=!0,i.tabIndex=0),this._renderListItem(o,e,i)},t.prototype._renderList=function(){var e=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE);return a.createElement(be.a,{id:"JumpBarItemsList",key:"JumpBarItemsList",testhooks:{id:"JumpBarItemsList"},title:e,role:we.j,onKeyDown:this._onJumpbarKeyDown.bind(this),style:Object(n.__assign)(Object(n.__assign)({},this.props.styles.jumpBarStyle),this.props.renderMobile?this.props.styles.jumpBarStyleMobile:null),accessibilityLabel:P.JUMPBAR_ARIALABEL},this._renderJumpBarAll(),this._renderJumpBarAlphabet())},t.prototype._onJumpbarKeyDown=function(e){var t=e.target;if(this.state.isFlyoutOpened){var r=9===e.keyCode,n=e.shiftKey;if(r){if(e.stopPropagation(),e.preventDefault(),n){if(t.id===this._closeJumpBarDomId)return void document.querySelector("#JumpBarItemsList").lastElementChild.focus();(i=t.previousElementSibling)?i.focus():t.id===this._allListItemDomId&&document.getElementById(this._closeJumpBarDomId).focus()}else{if(t.id===this._closeJumpBarDomId)return void document.getElementById(this._allListItemDomId).focus();if(t.parentElement&&t.parentElement.lastElementChild&&t.id===t.parentElement.lastElementChild.getAttribute("id"))return void document.getElementById(this._closeJumpBarDomId).focus();(a=t.nextElementSibling)&&a.focus()}return}}if(e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.LeftArrow||e.keyCode===Pe.a.RightArrow){e.stopPropagation(),e.preventDefault();var a,i,o=e.keyCode===Pe.a.DownArrow||e.keyCode===Pe.a.RightArrow,s=e.keyCode===Pe.a.UpArrow||e.keyCode===Pe.a.LeftArrow;if(o)return void((a=t.nextElementSibling)&&a.focus());if(s)return void((i=t.previousElementSibling)&&i.focus())}},t.prototype._renderJumpBarFlyout=function(e,t){var r="jumpbar-flyout_"+this.props.id,n=r+"Accessibility",i=[];return i.push(a.createElement(Ee.a,{key:n,rootElementId:r,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:this._createKeyboardShortcuts(),defaultFocusId:this._closeJumpBarDomId})),a.createElement(c.a,{role:we.e},a.createElement(Oe.a,{id:r,testhooks:{id:r},key:r,rootZIndex:this.props.rootZIndex,positionType:"relative",relativeToElementId:t,flyoutStyle:this.props.styles.jumpBarFlyoutStyle,flyoutDirection:this.props.isRTL?Oe.b.upleft:Oe.b.rightup,onOutsideClick:this._onOutsideClickHandler.bind(this,e)},a.createElement(_e.a,{key:"cancel",style:this.props.styles.closeButtonStyle,id:this._closeJumpBarDomId,onClick:this._toggleJumpBarFlyout,onKeyDown:this._onJumpbarKeyDown.bind(this),accessibilityLabel:P.CLOSE_JUMPBAR_ARIALABEL},a.createElement(u.a,{style:this.props.styles.closeButtonTextStyle},a.createElement(J.b,{type:p.a.Close}))),this._renderList()),i)},t.prototype._renderFlyoutButton=function(e){for(var t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_LETTER_TITLE),r=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET).split(","),n="",i=0;i<3;i++){n+=Object(je.h)(r[i+1])[0]}return a.createElement(_e.a,{id:e,accessibilityLabel:t,title:t,style:this.props.isMobile?this.props.styles.jumpBarButtonMobileStyle:this.props.styles.jumpBarButtonStyle,onClick:this._toggleJumpBarFlyout,testhooks:{id:e}},a.createElement(u.a,{style:this.props.styles.jumpBarButtonTextStyle},n))},t.prototype.render=function(){try{if(this.props.resourceStrings){var e="jumpBarRoot_"+this.props.id,t=e+"_"+this.props.uniqueId,r="jumpbarBtn_"+(this.props.uniqueId||this.props.id),n={position:"relative"};this.props.renderMobile&&Object.assign(n,{maxWidth:"100%"});var i={height:"0",width:"0"},o="flyoutRelativeElement"+this.props.controlKey;return a.createElement(c.a,{id:t,key:t,testhooks:{id:e},style:n},this.props.isRTL?null:a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}),this.props.renderMobile?this._renderFlyoutButton(r):this._renderList(),this.state.isFlyoutOpened?this._renderJumpBarFlyout(r,o):null,a.createElement(c.a,{style:{display:"none"},id:this._selectedFilterDomId,key:this._selectedFilterDomId,role:" "},P.SELECTEDFILTER_TEXT),this.props.isRTL?a.createElement(c.a,{id:o,style:i,role:"presentation","aria-hidden":"true"}):null)}return null}catch(e){return console.error(e.message),null}},t}(a.Component);var ke=Object(s.a)((function(){var e,t,r=null,n=null,a=null,i=Object(x.h)(),o=(e=null,t=null,function(r,n){var a,i,o,s,c,l,u,d,p,h,g,m,f,b,v,y,_,O,S,C,I,j,P,T,E,w,F,x,A,N,D,k,M,R,L=Object(Ce.a)(r),B=Object(Ie.b)(r)&&Object(U.a)(r,G.Fb,G.Lc)&&(null===(a=Object(Ie.a)(r))||void 0===a?void 0:a.Components)?Object(Ie.a)(r).Components:null;return t!==L&&(t=L,e={jumpBarStyle:{width:"100%",height:L.sizes.Measures.Measure300,display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",listStyleType:"none",backgroundColor:(null===(s=null===(o=null===(i=null==B?void 0:B.Grid)||void 0===i?void 0:i.Footer)||void 0===o?void 0:o.JumpBar)||void 0===s?void 0:s.BackgroundColor)||L.colors.BaseColor.Grey.Grey1,border:"1px solid transparent"},jumpBarButtonStyle:{display:"flex",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,color:(null===(u=null===(l=null===(c=null==B?void 0:B.Grid)||void 0===c?void 0:c.Footer)||void 0===l?void 0:l.JumpBar)||void 0===u?void 0:u.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonMobileStyle:{display:"flex",fontSize:L.fontSizes.Font100,fontFamily:L.fontFamilies.Regular,color:(null===(h=null===(p=null===(d=null==B?void 0:B.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.JumpBar)||void 0===h?void 0:h.TextColor)||L.colors.MainThemeColor.MainColor1.Fill,cursor:L.display.PointerCursorStyle,borderStyle:"none",backgroundColor:"transparent",padding:"0",marginLeft:L.sizes.Measures.Measure100,marginRight:L.sizes.Measures.Measure100,marginTop:L.sizes.Measures.Measure050,marginBottom:L.sizes.Measures.Measure050,maxWidth:"100%"},jumpBarButtonTextStyle:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},jumpBarFlyoutStyle:{border:L.borders.Border02,backgroundColor:L.colors.BaseColor.Grey.Grey1,overflowY:"auto",overflowX:"hidden"},closeButtonStyle:{position:"absolute",top:"0",right:"0",borderStyle:"none",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"transparent",cursor:L.display.PointerCursorStyle,padding:L.sizes.Measures.Measure100,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300},closeButtonTextStyle:{fontSize:"16px",color:L.colors.BaseColor.Grey.Grey7},jumpBarStyleMobile:{height:"auto",flexWrap:"wrap",display:"flex",alignItems:"center",justifyContent:"flex-start",paddingTop:L.sizes.Measures.Measure300,paddingRight:L.sizes.Measures.Measure050,paddingBottom:L.sizes.Measures.Measure150,paddingLeft:L.sizes.Measures.Measure300,maxWidth:"20rem"},listItemStyle:{textAlign:"center",position:"relative",height:L.sizes.Measures.Measure125},listItemSelectedStyle:{borderStyle:"solid",borderBottomColor:(null===(f=null===(m=null===(g=null==B?void 0:B.Grid)||void 0===g?void 0:g.Footer)||void 0===m?void 0:m.JumpBar)||void 0===f?void 0:f.SelectedColor)||L.colors.MainThemeColor.MainColor1.Fill,borderBottomWidth:L.sizes.Measures.Measure025},listItemStyleMobile:{display:"flex",alignItems:"center",justifyContent:"center",cursor:L.display.PointerCursorStyle,marginRight:L.sizes.Measures.Measure150,marginBottom:L.sizes.Measures.Measure150,width:L.sizes.Measures.Measure300,height:L.sizes.Measures.Measure300,border:L.borders.Border01,borderColor:(null===(y=null===(v=null===(b=null==B?void 0:B.Grid)||void 0===b?void 0:b.Footer)||void 0===v?void 0:v.JumpBar)||void 0===y?void 0:y.BorderColor)||L.colors.BaseColor.Blue.Blue3,backgroundColor:(null===(S=null===(O=null===(_=null==B?void 0:B.Grid)||void 0===_?void 0:_.Footer)||void 0===O?void 0:O.JumpBar)||void 0===S?void 0:S.BackgroundColorMobile)||L.colors.BaseColor.White,":nth-child(2)":{marginRight:"50%"},outlineOffset:"0px !important"},listItemSelectedStyleMobile:{borderColor:(null===(j=null===(I=null===(C=null==B?void 0:B.Grid)||void 0===C?void 0:C.Footer)||void 0===I?void 0:I.JumpBar)||void 0===j?void 0:j.SelectedBorderColor)||L.colors.BaseColor.Transparent,backgroundColor:(null===(E=null===(T=null===(P=null==B?void 0:B.Grid)||void 0===P?void 0:P.Footer)||void 0===T?void 0:T.JumpBar)||void 0===E?void 0:E.SelectedColorMobile)||L.colors.BaseColor.Grey.Grey2},hyperlinkStyle:{textDecoration:"none",textAlign:"center",fontSize:L.fontSizes.Font085,fontFamily:L.fontFamilies.Regular,whiteSpace:"nowrap",color:(null===(x=null===(F=null===(w=null==B?void 0:B.Grid)||void 0===w?void 0:w.Footer)||void 0===F?void 0:F.JumpBar)||void 0===x?void 0:x.LinkColor)||L.colors.BaseColor.Grey.Grey7},hyperlinkStyleMobile:{color:(null===(D=null===(N=null===(A=null==B?void 0:B.Grid)||void 0===A?void 0:A.Footer)||void 0===N?void 0:N.JumpBar)||void 0===D?void 0:D.LinkColor)||L.colors.BaseColor.Blue.Blue3},hyperlinkSelectedStyleMobile:{color:(null===(R=null===(M=null===(k=null==B?void 0:B.Grid)||void 0===k?void 0:k.Footer)||void 0===M?void 0:M.JumpBar)||void 0===R?void 0:R.SelectedBorderColor)||L.colors.BaseColor.Grey.Grey7}}),e});return function(e,t){var s=o(e,t);if(null===r&&(r=Object(N.E)(e,t.entityTypeName)),null==n&&(n=e.metadata.attributes[t.entityTypeName]),Object(U.a)(e,G.ac)){var c=Object(T.v)(e,t.id,t.contextToken);a=c&&c.fetchXml}return{resourceStrings:i(e,P.labelList),primaryNameAttribute:r,dataSetFetchXml:a,entityAttributeMetadata:n,styles:s}}}),(function(e,t){return{applyGridFilter:function(r,n,a){if(e(Object(Se.m)(r,t.id,a)),e(Object(Ae.b)(t.id,a,1)),n){var i=[{filterType:4,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(i,t.id),t.setResetPagingInfoForEnhancedPaging()}}}}))(De),Me=r("fH/t");var Re=r("4Q7K"),Le=r("3IUl"),Be=r("bc+P"),Ve=r("+6eZ"),Ge=r("Baft"),Ue=r("zETL"),ze=r("r0s4"),qe=function(e){function t(t){var r=e.call(this,t)||this;return r._goToFirstPage=r._goToFirstPage.bind(r),r._goToPreviousPage=r._goToPreviousPage.bind(r),r._goToNextPage=r._goToNextPage.bind(r),Object(x.c)(t.resourceStrings,Me.d)||t.retrieveResourceStrings(Me.k),r}return Object(n.__extends)(t,e),t.prototype._firstButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._nextButtonEnabled=function(e){return(!(this.props.currentPage===Math.floor(e.totalResultCount/e.pageSize))||!this.props.pagingInfo.isGridScrolledToBottom)&&e.hasNextPage},t.prototype._previousButtonEnabled=function(e){return this.props.currentPage>1},t.prototype._goToNextPage=function(e){this.props.updateDataSetLoadingState(1),this.props.incrementLastPage(),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage+1),this._setFooterButtonsFocus(e,!0)},t.prototype._goToPreviousPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.updatePageNumber(this.props.currentPage-1),this._setFooterButtonsFocus(e,!1)},t.prototype._goToFirstPage=function(e){this.props.updateDataSetLoadingState(1),this.props.setNewPageRequested(!0),this.props.setFirstPage(1),this.props.updatePageNumber(1),this._setFooterButtonsFocus(e,!1)},t.prototype._setFooterButtonsFocus=function(e,t){if(null!==e&&null!==e.currentTarget&&null!==e.currentTarget.parentElement&&null!==e.currentTarget.parentElement.children)if(t&&e.currentTarget.parentElement.children.length>=2&&null!==e.currentTarget.parentElement.children[1]){var r=e.currentTarget,n=e.currentTarget.parentElement.children[1];setTimeout((function(){r.disabled&&n.focus()}),500)}else if(!t&&null!==e.currentTarget.parentElement.lastElementChild){var a=e.currentTarget,i=e.currentTarget.parentElement.lastElementChild;setTimeout((function(){a.disabled&&i.focus()}),500)}},t.prototype._getResources=function(){if(this._loadFirstPage=this._loadFirstPage||Object(x.c)(this.props.resourceStrings,Me.d),this._loadNextPage=this._loadNextPage||Object(x.c)(this.props.resourceStrings,Me.e),this._loadPreviousPage=this._loadPreviousPage||Object(x.c)(this.props.resourceStrings,Me.f),!this._spaceResource){var e=Object(x.c)(this.props.resourceStrings,Me.j);this._spaceResource=Object(ze.CrmHtmlDecode)(e)}this._gridInfoResource=this._gridInfoResource||Object(x.c)(this.props.resourceStrings,Me.a),this._gridTotalCount=this._gridTotalCount||Object(x.c)(this.props.resourceStrings,Me.c),this._itemSelected=this._itemSelected||Object(x.c)(this.props.resourceStrings,Me.b),this._totalApproximate=this._totalApproximate||Object(x.c)(this.props.resourceStrings,Me.h),this._totalExact=this._totalExact||Object(x.c)(this.props.resourceStrings,Me.i)},t.prototype.render=function(){if(!this.props.pagingData)return null;var e=Object(Ve.a)(this.props.pagingData),t=0,r=0;e.totalResultCount&&(this.props.enhancedPagingDisabled?(t=e.pageSize*(this.props.currentPage-1)+1,r=this.props.currentPage*e.pageSize,-1!==e.totalResultCount&&this.props.currentPage*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))):(t=e.pageSize*(this.props.pagingInfo.firstPageNumber-1)+1,r=this.props.pagingInfo.lastPageNumber*e.pageSize,this.props.pagingInfo.pageShift>0&&(t+=this.props.pagingInfo.pageShift,r+=this.props.pagingInfo.pageShift),-1!==e.totalResultCount&&this.props.pagingInfo.lastPageNumber*e.pageSize>e.totalResultCount&&(r=e.totalResultCount,this.props.isServerOffline&&this.props.currentPage>1&&(r=e.pageSize*(this.props.currentPage-1)+e.totalResultCount))));var n=e.totalResultCount,i=this._firstButtonEnabled(e),o=this._nextButtonEnabled(e),s=this._previousButtonEnabled(e);this._getResources();var l=n;-1===n&&(l=r<this.props.gridTotalRecordsCountLimit?this.props.gridTotalRecordsCountLimit:r);var u="";u=-1===n?String.format(this._totalApproximate,this.props.isServerOffline?r:l):this.props.isServerOffline&&n>e.pageSize?String.format(this._totalApproximate,r):String.format(this._totalExact,this.props.isServerOffline?r:n);var d=String.format(this._gridTotalCount,this._spaceResource,u),p=this.props.selectedRowCount>0?String.format(this._itemSelected,this._spaceResource,this.props.selectedRowCount):null,h=Object(x.c)(this.props.resourceStrings,Me.g),g=String.format(h,this.props.currentPage),m=n/e.pageSize;return this.props.isServerOffline&&0!==this.props.currentPage&&(m=-1/e.pageSize),a.createElement(c.a,{style:this.props.styleProps.containerStyle},this._renderPagingText(t,r,d,p),this._renderPagingButtons(i,o,s,g,m))},t.prototype._renderPagingButtons=function(e,t,r,n,i){return(i<0||i>1)&&this.props.enhancedPagingDisabled?a.createElement(c.a,{style:this.props.styleProps.navigationPanelStyle},a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"loadFirstPage_"+this.props.id},accessibilityLabel:this._loadFirstPage,disabled:!e,tabIndex:0,onClick:this._goToFirstPage},a.createElement(J.b,{type:p.a.FirstPageButton})),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToPreviousPage_"+this.props.id},accessibilityLabel:this._loadPreviousPage,disabled:!r,tabIndex:0,onClick:this._goToPreviousPage},a.createElement(J.b,{type:p.a.BackButton})),a.createElement(u.a,{style:this.props.styleProps.pageNumberStyle,testhooks:{id:"pageNumber_"+this.props.id},role:we.a,notificationType:Ge.b},null!==this.props.currentPage?String.format(n,this.props.currentPage):null),a.createElement(_e.a,{style:this.props.styleProps.pagingButton,testhooks:{id:"moveToNextPage_"+this.props.id},accessibilityLabel:this._loadNextPage,disabled:!t,tabIndex:0,onClick:this._goToNextPage},a.createElement(J.b,{type:p.a.Forward}))):null},t.prototype._renderPagingText=function(e,t,r,n){if(!this.props.pagingTextDisabled&&this.props.shouldPagingTextRender&&this.props.gridTotalRecordsCountLimit)return a.createElement(c.a,{style:this.props.styleProps.pagingTextStyle,testhooks:{id:"pagingText"}},a.createElement(u.a,null,String.format(this._gridInfoResource,e,t,r,n)))},t}(a.Component);var Xe=Object(s.a)((function(){var e,t,r,a=null,i=Object(x.h)(),o=(e=null,t=null,r={containerStyle:{justifyContent:"space-between",alignItems:"center",width:"100%"},navigationPanelStyle:{flexDirection:"row"},pageNumberStyle:{whiteSpace:"nowrap"},pagingButton:{borderStyle:"none",display:"inline-block",backgroundColor:"transparent",fontSize:"16px"}},function(a,i){var o,s,c,l,u,d,p,h,g,m,f,b,v=Object(Ie.b)(a)&&Object(U.a)(a,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(a))||void 0===c?void 0:c.Components)?Object(Ie.a)(a).Components:null;if(e!==i){e=i;var y=Object(Ce.a)(a),_=a.user.userSettings.isRTL,O=Object(n.__assign)(Object(n.__assign)({},r.containerStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100}),S=Object(n.__assign)(Object(n.__assign)({},r.navigationPanelStyle),((o={})["margin"+(_?"Right":"Left")]="auto",o)),C=Object(n.__assign)(Object(n.__assign)({},r.pageNumberStyle),{marginRight:y.sizes.Measures.Measure100,marginLeft:y.sizes.Measures.Measure100,fontSize:y.fontSizes.Font085,fontFamily:y.fontFamilies.Regular,color:(null===(u=null===(l=null==v?void 0:v.Grid)||void 0===l?void 0:l.Footer)||void 0===u?void 0:u.TextColor)||y.colors.BaseColor.Grey.Grey7}),I=Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},r.pagingButton),{color:(null===(p=null===(d=null==v?void 0:v.Grid)||void 0===d?void 0:d.Footer)||void 0===p?void 0:p.IconColor)||y.colors.BaseColor.Blue.Blue3,marginLeft:y.sizes.Measures.Measure050,marginRight:y.sizes.Measures.Measure050,width:"0px",fontSize:y.fontSizes.Font085,"[disabled]":{color:(null===(m=null===(g=null===(h=null==v?void 0:v.Grid)||void 0===h?void 0:h.Footer)||void 0===g?void 0:g.Disabled)||void 0===m?void 0:m.IconColor)||y.colors.BaseColor.Grey.Grey5}}),_&&{transform:"scaleX(-1)"}),j=((s={})["margin"+(_?"Left":"Right")]="auto",s.fontSize=y.fontSizes.Font085,s.fontFamily=y.fontFamilies.Regular,s.color=(null===(b=null===(f=null==v?void 0:v.Grid)||void 0===f?void 0:f.Footer)||void 0===b?void 0:b.TextColor)||y.colors.BaseColor.Grey.Grey7,s);t=Object(n.__assign)(Object(n.__assign)({},r),{containerStyle:O,navigationPanelStyle:S,pagingButton:I,pageNumberStyle:C,pagingTextStyle:j})}return t});return function(e,t){var r=o(e,t.contextString),n=Object(T.fb)(e,t.id,t.contextToken),s=n?n.length:0,c=i(e,Me.k),l=Object(T.Y)(e,t.id,t.contextToken),u=Object(T.x)(e,t.id,t.contextToken);return a!==r&&(a=r),{selectedRowCount:s,resourceStrings:c,pagingData:l,currentPage:null===u?1:u,styleProps:a}}}),(function(e,t){return{retrieveResourceStrings:function(t){return e(Object(F.e)(t))},updatePageNumber:function(r){if(e(Object(Ae.b)(t.id,t.contextToken,r)),1===r&&t.enhancedPagingDisabled&&e(Object(Ue.b)(t.id,t.contextToken)),t.isGridRoot){var n=[{filterType:12,filterExpressionOrValue:r}];t.updateGridPaginationStateHandler(n,t.id)}return e(Object(Be.b)(t.id,t.contextToken,null)),e(Object(Le.b)(t.id,t.contextToken,[]))},setNewPageRequested:function(r){e(Object(Re.b)(t.id,t.contextToken,r))}}}))(qe),We=r("PBKq"),He=r("i6iy"),Qe=r("7EJx");var Ye=r("jf1O"),Ke=r("aPRd"),Je=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindInnerTextRef=null,r._searchBarFocusTriggered=!1,r._onTextInputChange=r._onTextInputChange.bind(r),r._onkeyDown=r._onkeyDown.bind(r),r._onButtonClick=r._onButtonClick.bind(r),r._focusTextInput=r._focusTextInput.bind(r),r.updateSearchTextAndFind=r.updateSearchTextAndFind.bind(r),r.props.isGridPaginationStateFeatureEnabled&&r.props&&r.props.gridInput&&r.props.gridInput.quickFindExpression?r.state={quickFindText:r.props.gridInput.quickFindExpression.trim(),currentViewId:r.props.currentViewIdToRestore,clearQuickFind:!0}:r.state={quickFindText:null,currentViewId:null,clearQuickFind:!1},r}return Object(n.__extends)(t,e),t.prototype.clearSearchBar=function(){this.setState({quickFindText:null,clearQuickFind:!1})},t.prototype.updateSearchTextAndFind=function(e,t){var r=this;this.setState({quickFindText:e},(function(){t&&r._applyQuickFind()}))},t.prototype._onButtonClick=function(e){this.props.updateDataSetLoadingState(1),this.state.clearQuickFind?this._clearQuickFind():this._applyQuickFind()},t.prototype._onkeyDown=function(e){e.keyCode===Pe.a.Enter&&(this.props.updateDataSetLoadingState(1),this._applyQuickFind())},t.prototype._onTextInputChange=function(e){var t=""===e;this.setState({quickFindText:e,clearQuickFind:t})},t.prototype._applyFilter=function(){var e=this._formatQuickFindText(),t=Object(Te.b)(e,this.props.primaryNameAttribute);this.props.applyGridFilter(t,this.props.contextToken)},t.prototype._clearFilter=function(){var e=this;this.setState({quickFindText:""},(function(){e._applyFilter()}))},t.prototype._formatQuickFindText=function(){return this.state.quickFindText.split("*").join("%").replace(/%?\s*$/,"%")},t.prototype._applyQuickFind=function(){var e=this;this.state.quickFindText&&""!==this.state.quickFindText.trim()?this.props.shouldUseFilter?(this._applyFilter(),this.setState({clearQuickFind:!0})):this.props.applyQuickFind(this.state.quickFindText,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName,this.props.isGridPaginationStateFeatureEnabled).then((function(t){e.setState({clearQuickFind:!0}),e.state.currentViewId||e.setState({currentViewId:t})})):this._clearQuickFind()},t.prototype._clearQuickFind=function(){var e=this;this.props.shouldUseFilter?(this._clearFilter(),this.setState({clearQuickFind:!1})):this.props.clearQuickFind(this.state.currentViewId,this.props.id,this.props.gridInput,this.props.contextToken,this.props.controlName).then((function(){e.setState({quickFindText:"",currentViewId:null,clearQuickFind:!1})}))},t.prototype._getPlaceholderText=function(){return this.props.isGridSearchCanUseCurrentViewFeatureEnabled?this.props.shouldGridSearchUseCurrentView?Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_SEARCH_THIS_VIEW):Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT_QUICK_FIND_VIEW):Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TEXT_BOX_PLACEHOLDER_TEXT)},t.prototype._createUniqueId=function(e){var t=this.props,r=t.contextToken,n=t.id;return r.controlName?e+"_"+r.controlName+"_"+n:e+"_"+n},t.prototype.render=function(){var e=this,t=this._getPlaceholderText(),r=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_CLEAR_BUTTON);if(this.props.showNewQuickFindSearchBarForMobile)return a.createElement(c.a,null,a.createElement(B.i,{placeholder:t,cancelText:Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_CANCEL_LABEL_ID),clearText:r,applyQuickFind:this._applyQuickFind,windowWidth:this.props.viewPortWidth,updateSearchTextAndFind:this.updateSearchTextAndFind,value:this.state.quickFindText,quickFindRNStyleProps:this.props.quickFindRNStyleProps}));var n=this._createUniqueId("quickFind_text"),i=this._createUniqueId("quickFind_button"),o=this._createUniqueId("quickFind_button_icon"),s=Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_TOOLTIP_APPLY_BUTTON),l=this.state&&this.state.clearQuickFind?r:s;return a.createElement(c.a,{style:this.props.styleProps.quickFindStyle,testhooks:{id:"data-set-quickFind-container"}},a.createElement(We.a,{id:n,key:n,ref:function(t){e._quickFindInnerTextRef=t},testhooks:{id:n},value:this.state&&this.state.quickFindText?this.state.quickFindText:null,accessibilityLabel:t,onChangeText:this._onTextInputChange,onKeyDown:this._onkeyDown,style:this.props.styleProps.inputStyle,placeholder:t}),a.createElement(_e.a,{id:i,key:i,testhooks:{id:i},accessibilityLabel:l,title:l,onClick:this._onButtonClick,tabIndex:0,style:this.props.styleProps.buttonStyle},a.createElement(J.b,{id:o,key:o,type:this.state&&this.state.clearQuickFind?p.a.Cancel:p.a.SearchButton,style:this.props.styleProps.buttonIconStyle})))},t.prototype._focusTextInput=function(){if(this.props.focusSearchBoxAfterRender&&!this._searchBarFocusTriggered){var e=i.findDOMNode(this._quickFindInnerTextRef);e&&(e.focus(),this._searchBarFocusTriggered=!0)}},t.prototype.componentDidMount=function(){this._focusTextInput()},t}(a.Component);Je.displayName="DataSetQuickFind";var Ze=Object(s.a)((function(){var e,t,r,a,i=null,o=null,s=null,c=(t=null,r=null,a={buttonStyle:{border:"none",padding:"0",backgroundColor:"transparent",flexDirection:"column","-webkit-appearance":"none"},inputStyle:{border:"none",backgroundColor:"transparent",width:"100%",minWidth:"0px","-webkit-appearance":"none","::-ms-clear":{display:"none"}},quickFindStyle:{borderWidth:"1px",borderStyle:"solid",display:"flex",flexDirection:"row",width:"100%"},buttonIconStyle:{fontWeight:"bold",marginTop:"auto",marginBottom:"auto",width:"100%"}},function(i,o){var s,c,l,u,d,p,h,g,m,f,b,v,y,_,O,S,C,I=Object(Qe.g)(i),j=Object(Ie.b)(i)&&Object(U.a)(i,G.Fb,G.Lc)&&(null===(c=Object(Ie.a)(i))||void 0===c?void 0:c.Components)?Object(Ie.a)(i).Components:null;if(j&&(a=Object.assign(a,{inputStyle:{color:null===(d=null===(u=null===(l=null==j?void 0:j.Grid)||void 0===l?void 0:l.ColumnHeader)||void 0===u?void 0:u.QuickFind)||void 0===d?void 0:d.TextColor,backgroundColor:null===(g=null===(h=null===(p=null==j?void 0:j.Grid)||void 0===p?void 0:p.ColumnHeader)||void 0===h?void 0:h.QuickFind)||void 0===g?void 0:g.BackgroundColor,borderColor:"transparent"},searchIconStyle:{color:null===(b=null===(f=null===(m=null==j?void 0:j.Grid)||void 0===m?void 0:m.ColumnHeader)||void 0===f?void 0:f.QuickFind)||void 0===b?void 0:b.IconColor},buttonIconStyle:{color:null===(_=null===(y=null===(v=null==j?void 0:j.Grid)||void 0===v?void 0:v.ColumnHeader)||void 0===y?void 0:y.QuickFind)||void 0===_?void 0:_.IconColor}})),t!==o||e!==I){t=o,e=I;var P=Object(Ce.a)(i),T=Object(n.__assign)(Object(n.__assign)({},a.buttonStyle),{":before":{content:"''",display:"inline-block",width:P.sizes.Measures.Measure250}}),E=Object(n.__assign)(Object(n.__assign)({},a.quickFindStyle),((s={borderColor:(null===(C=null===(S=null===(O=null==j?void 0:j.Grid)||void 0===O?void 0:O.ColumnHeader)||void 0===S?void 0:S.QuickFind)||void 0===C?void 0:C.BorderColor)||P.colors.BaseColor.Grey.Grey3})["padding"+(I?"Right":"Left")]=P.sizes.Measures.Measure025,s));r=Object(n.__assign)(Object(n.__assign)({},a),{buttonStyle:T,quickFindStyle:E})}return r}),l=Object(Ye.a)(),u=Object(x.h)(),d=null;return function(e,t){var r=c(e,t.contextString),n=l(e,t);s||(s=u(e,P.labelList)),i!==r&&(i=r),o!==n&&(o=n),d||(d=Object(U.c)(e,G.bd));var a=Object(U.a)(e,G.zb),p=null;a&&t.gridInput&&(p=(t.gridInput&&t.gridInput.viewId&&!O.a.isNullOrEmpty(t.gridInput.viewId)?t.gridInput.viewId:null)||Object(C.a)(e,t.entityTypeName,I.a.MAIN_APPLICATION_VIEW));return{quickFindText:"",currentViewId:null,clearQuickFind:!1,primaryNameAttribute:Object(N.E)(e,t.entityTypeName),styleProps:i,quickFindRNStyleProps:o,shouldUseFilter:!(Object(je.e)(t.contextString)||Object(je.d)(t.contextString)||Object(je.g)(t.contextString)&&d),resourceStrings:s,isGridPaginationStateFeatureEnabled:a,currentViewIdToRestore:p,shouldGridSearchUseCurrentView:Object(oe.l)(e),isGridSearchCanUseCurrentViewFeatureEnabled:Object(U.a)(e,G.Db,G.h),isQuickFindImprovementsFeatureEnabled:Object(U.a)(e,G.ad,G.tc),viewPortWidth:Object(Ke.c)(e)}}}),(function(e,t){return{applyQuickFind:function(r,n,a,i,o,s){if(a&&s){var c=[{filterType:1,filterExpressionOrValue:r}];a.entityTypeName===v.a&&c.push({filterType:2,filterExpressionOrValue:t.entityTypeName}),t.updateGridPaginationStateHandler(c,t.id),t.resetPagingInfoForEnhancedPaging()}return e(Object(He.a)(r,n,i,o))},clearQuickFind:function(r,n,a,i,o){if(a){t.updateGridPaginationStateHandler([{filterType:1,filterExpressionOrValue:null}],t.id)}return e(Object(He.b)(r,n,i,o))},applyGridFilter:function(r,n){e(Object(Se.n)(r,t.id,n))}}}),null,{forwardRef:!0})(Je);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var $e=function(e){return function(e,t,r,n,i,o){var s=(null==o?void 0:o.seeMoreTooltip)||Object(x.c)(t,P.SEE_MORE_TOOL_TIP),l=(null==o?void 0:o.seeMoreLabel)||Object(x.c)(t,P.SEE_MORE_LABEL),d=s;return(null==o?void 0:o.uniqueLabel)&&(d+=" "+o.uniqueLabel),a.createElement(c.a,{style:r},a.createElement(_e.a,{key:"seeMoreBtn",id:"seemore-btn",title:s,style:n,onClick:e,tabIndex:0,accessibilityLabel:d,describedByElementId:null},a.createElement(u.a,{style:i},l)))}(e.onSeeMoreClick,e.resourceStrings,e.containerStyle,e.buttonStyle,e.seeMoreTextStyle,e.localizedStrings)};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var et=r("s2by"),tt=r("/45f"),rt=r("sgPk"),nt=r("WS0f"),at=r("fE8x");var it=r("Cgjg"),ot=r("FPMG"),st=r("0bF2"),ct=r("bCrZ"),lt=r("Wye+"),ut=r("Ds7n"),dt=r("d26+"),pt=r("7oc5"),ht=r("tcXs"),gt=r("c0jI"),mt=r("t8f4"),ft=r("QAhb"),bt=r("8egQ");var vt=r("5cS+"),yt=r("whwt"),_t=r("ASFs"),Ot=r("Z46F"),St=r("LWFb"),Ct=r("kyRo"),It=r("buKK"),jt=r("+D0h"),Pt=r("6FBX"),Tt=r("LnR7"),Et=r("pLx/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function wt(e){return a.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(15),r.e(17),r.e(21),r.e(34)]).then(r.bind(null,"GDLi")).then((function(e){return e.DataSetExpressionBuilder}))},props:e})}wt.displayName="DataSetExpressionBuilderLazyLoadComponent";var Ft=r("/U1C"),xt=r("RrHr"),At=r("zpQF"),Nt=r("/0Gr"),Dt=r("TUxu"),kt=r("/j9Z"),Mt=r("VcAV"),Rt=r("swEE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Lt(e){return a.createElement(le.a,{loader:function(){return Promise.all([r.e(9),r.e(10),r.e(11),r.e(13),r.e(12),r.e(14),r.e(16),r.e(113),r.e(33)]).then(r.bind(null,"pnQ/")).then((function(e){return e.ColumnEditor}))},props:e})}Lt.displayName="ColumnEditorLazyLoadComponent";var Bt=r("2Sll"),Vt=r("ozuu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
Object(Bt.a)();var Gt=v.x+".DataSetHost",Ut=Gt+".AdvancedFind.Open",zt=Gt+".AdvancedFind.Discard",qt=function(e){function t(t){var r=e.call(this,t)||this;return r._quickFindCommandBarId="showQuickFind",r._changeVisualizationCommandBarId="changeVisualization",r._savedDefault=null,r._savedFormInfo=null,r._currentFilterValue=null,r._addedCommandListFromHost=[],r._addedCommandListFromControl=[],r._addedCommandListFromHostParent=[],r._memoizedConfiguration=null,r._memoizedResourceStrings=null,r._memoizedViewConfigurations=null,r._memoizedButtonList=null,r._parentSwitchVisualizationButton=null,r._keyIndex=0,r._width=0,r._height=0,r._isFirstRequestComplete=!1,r._isPreNavigationEventAttached=!1,r._offlineSqlQueryRetrieveState=0,r._dataSetQuickFindRef=a.createRef(),r._isSubGridFirstLoad=!1,r._minWidthForChartPlusGridReflow=640,r._isReflowLayoutVertical=!1,r._isSwitchVisualizationInitialized=!1,r._accessibilityId=1,r._incrementLastPage=function(){r.props.pageNumber===r.state.pagingInfo.lastPageNumber&&r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{lastPageNumber:r.state.pagingInfo.lastPageNumber+1})})},r._setFirstPage=function(e){r.setState({pagingInfo:Object(n.__assign)(Object(n.__assign)({},r.state.pagingInfo),{firstPageNumber:e})})},r._seeMorePopup=r._seeMorePopup.bind(r),r._onSendControlCommandsEventFired=r._onSendControlCommandsEventFired.bind(r),r._onSelectedOrderColumnChangeFired=r._onSelectedOrderColumnChangeFired.bind(r),r._onParentPagePreNavigationEventFired=r._onParentPagePreNavigationEventFired.bind(r),r._onFilterChange=r._onFilterChange.bind(r),r._onActivityTypeMenuDismissed=r._onActivityTypeMenuDismissed.bind(r),r._updateDataSetLoadingStateEvent=r._updateDataSetLoadingStateEvent.bind(r),r._updateFilterValue=r._updateFilterValue.bind(r),r._onRollupViewToggleChanged=r._onRollupViewToggleChanged.bind(r),r._onQuickFind=r._onQuickFind.bind(r),r._onItemIconPointerDown=r._onItemIconPointerDown.bind(r),r._onViewChanged=r._onViewChanged.bind(r),r._onControlLoadedError=r._onControlLoadedError.bind(r),r._updatePagingInfo=r._updatePagingInfo.bind(r),r._updateFilterExpressionStrings=r._updateFilterExpressionStrings.bind(r),r._configureDataSetControlParams=r._configureDataSetControlParams.bind(r),r._openManageDuplicatesDialog=r._openManageDuplicatesDialog.bind(r),r._showInnerError=r._showInnerError.bind(r),r._isInSeeMoreState=r._isInSeeMoreState.bind(r),r._getChartPaneText=r._getChartPaneText.bind(r),r.onMeasuring=r.onMeasuring.bind(r),r.closeFilterPanel=r.closeFilterPanel.bind(r),r._clearActivityTypeFilter=r._clearActivityTypeFilter.bind(r),r._updateCurrentPageNumber=r._updateCurrentPageNumber.bind(r),r._isNativePlatform=null!=t.platformType&&t.platformType===b.b.Native,r._currentPagingString=null,r._preSeeMoreCachedPagingString=null,r._boundOnRecordsSelected=null,r._pageNumberToRestoreForEnhancedPaging=r.props.pageNumberForEnhancedPaging,r._shouldResetPagingForEnhancedPaging=!1,r._previousSortingInfo=null,r._resetProcessedForEnhancedPaging=!0,r.state={quickFindVisibility:!1,addedCommandList:[],inSeeMoreState:!1,pagingInfo:{firstPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,lastPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,currentPageNumber:Object(nt.a)(r.props.pageNumberForEnhancedPaging)?1:r.props.pageNumberForEnhancedPaging,pageShift:0,isGridScrolledToBottom:!1},compositeControlInitState:D.a.Uninitialized,controlLoadErrorMessage:null,controlLoadInnerErrorMessage:null,loadingState:0,isFilterPanelOpen:!1,columnEditorPanelOpen:!1,isAdvancedFilterEdited:!1},r._parentDefinedProps={eventListeners:[{eventname:"sendgridcontrolcommandstohostcommandbar",eventhandler:[r._onSendControlCommandsEventFired]},{eventname:"onselectedordercolumnchange",eventhandler:[r._onSelectedOrderColumnChangeFired]},{eventname:"parentPagePreNavigation",eventhandler:[r._onParentPagePreNavigationEventFired]},{eventname:"sendpaginginfotopagingcontrol",eventhandler:[r._updatePagingInfo]},{eventname:"sendfilterexpressionstringstodatasethost",eventhandler:[r._updateFilterExpressionStrings]},{eventname:"updatedatasethostloadingstate",eventhandler:[r._updateDataSetLoadingStateEvent]},{eventname:"openmanageduplicatesdialog",eventhandler:[r._openManageDuplicatesDialog]},{eventname:"showinnererror",eventhandler:[r._showInnerError]},{eventname:"sendcurrentpagenumber",eventhandler:[r._updateCurrentPageNumber]}],containerStyleOverrides:{rootContainer:{flex:Object(je.e)(t.contextString)?"1 1 100%":"1 1 auto",minHeight:"0"}},onControlLoadedError:r._onControlLoadedError},r._seeMoreHelper=new f.a,r}return Object(n.__extends)(t,e),t.prototype._logInfo=function(e){this._tracer&&this._tracer.info(e)},t.prototype._updateDataSetLoadingStateEvent=function(e){this._updateDataSetLoadingState(e.value)},t.prototype._updateDataSetLoadingState=function(e,t){var r=this;void 0===t&&(t={}),(1===e&&this.props.featureControlProps.isGridProgressIndicatorFeatureEnabled||1!==e)&&(this.setState(Object.assign(t,{loadingState:e})),this._currentLoadingTimeoutIdentifier&&clearTimeout(this._currentLoadingTimeoutIdentifier),this._currentLoadingTimeoutIdentifier=null,1===e&&(this._currentLoadingTimeoutIdentifier=setTimeout((function(){r._updateDataSetLoadingState(2)}),3e4)))},t.prototype._openManageDuplicatesDialog=function(e){!this.props.isOffline&&e&&e.entityReference&&e.reject&&this.props.openManageDuplicatesDialog(e)},t.prototype._showInnerError=function(e){this.props.showInnerError(e)},t.prototype._updatePagingInfo=function(e){e&&e.currentPageNumber>0&&(this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this._resetProcessedForEnhancedPaging||1!==e.currentPageNumber||(this._resetProcessedForEnhancedPaging=!0,this._pageNumberToRestoreForEnhancedPaging=1),this.props.pageNumberForEnhancedPaging!==e.currentPageNumber&&this.props.updatePageNumberForEnhancedPaging(e.currentPageNumber,this.props.contextToken)),Object(_t.e)(this.state.pagingInfo,e)||this.setState({pagingInfo:e}))},t.prototype._updateCurrentPageNumber=function(e){e&&e.currentPageNumber>0&&this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,e.currentPageNumber)},t.prototype._updateFilterExpressionStrings=function(e){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&e&&(e.nativeFilterExpressionString||e.dataSetFilterExpressionString)){var t=[{filterType:5,filterExpressionOrValue:e.nativeFilterExpressionString},{filterType:6,filterExpressionOrValue:e.dataSetFilterExpressionString}];this.props.updateGridPaginationStateHandler(t,this.props.id),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1)}},t.prototype._setResetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this._shouldResetPagingForEnhancedPaging=!0)},t.prototype._resetPagingInfoForEnhancedPaging=function(){this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&this._isNativePlatform&&(this.setState({pagingInfo:{firstPageNumber:1,lastPageNumber:1,currentPageNumber:1,pageShift:0,isGridScrolledToBottom:!1}}),this._pageNumberToRestoreForEnhancedPaging=1)},t.prototype._onControlLoadedError=function(e){var t=e?e.message:null;this._logTelemetryData(t),this._setControlLoadError()},t.prototype._setControlLoadError=function(e){void 0===e&&(e=P.GRID_CONTROL_LOAD_ERROR),this.setState({controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,e)})},t.prototype._logTelemetryData=function(e){this._tracer&&this._tracer.error("Loading for the grid failed because of error :"+(e||"CustomControl_Calendar_ErrorView_DefaultMessage"))},t.prototype._renderTitle=function(){if(!this.props.descriptor)return null;var e=this.props.descriptor,t=e.ShowLabel,r=e.Name,n=e.Label,i=this._isWidthLessThanViewportSm()?this.props.styles.titleMobileStyle:this.props.styles.titleStyle;return t&&n?a.createElement(u.a,{key:r,semanticTag:"div",style:i},n):null},t.prototype.onMeasuring=function(e,t){if(this._height=t,!(Math.abs(this._width-e)<50)&&(this._width=e,!this._getCachedSize()||e!==this._getCachedSize().width||t&&t!==this._getCachedSize().height)){var r={},n=this._seeMoreHelper.shouldGivePoppedOutDimensions(!0),a=this._seeMoreHelper.getSeeMorePopupInfo(),i=n?a.endWidthInner:e,o=[];!this._isWidthInitialized()&&e>0&&(r.isWidthInitialized=!0,o.push("isWidthInitialized:"+r.isWidthInitialized));var s=i<=this.props.viewportSm;s!==this._isWidthLessThanViewportSm()&&(r.isWidthLessThanViewportSm=s,o.push("isWidthLessThanViewportSm:"+s));var c=i<=this.props.viewportM;c!==this._isWidthLessThanViewportM()&&(r.isWidthLessThanViewportM=c,o.push("isWidthLessThanViewportM:"+c));var l=i<this._minWidthForChartPlusGridReflow;l!==this._isWidthLessThanMinWidthForChartPlusGridReflow()&&(r.isWidthLessThanMinWidthForChartPlusGridReflow=l,o.push("isWidthLessThanMinWidthForChartPlusGridReflow:"+l));var u=this._jumpBarShouldRenderAsFlyout(i);u!==this._isJumpBarRenderingAsFlyout()&&(r.isJumpBarRenderingAsFlyout=u,o.push("isJumpBarRenderingAsFlyout:"+u));var d=i>480;d!==this._isWidthGreaterThan480()&&(r.isWidthGreaterThan480=d,o.push("isWidthGreaterThan480:"+d));var p=n?a.endHeightInner:t,h=p>240;h!==this._isHeightGreaterThan240()&&(r.isHeightGreaterThan240=h,o.push("isHeightGreaterThan240:"+h)),0!==e&&0!==t||this._tracer&&this._tracer.warn("The measuring service returned width or height as 0. The new dimensions are width is "+e+" and height is "+t);var g=!1,m=this.props.quickFindProps&&s&&!this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot();m!==this._showCommandBarButtonSearch()&&(r.showCommandBarButtonSearch=m,o.push("showCommandBarButtonSearch:"+m),g=!0);var f=Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString)&&this.props.featureControlProps.isChartOnAssociatedGridEnabled;if(f!==this._showCommandBarButtonShowChart()&&(r.showCommandBarButtonShowChart=f,o.push("showCommandBarButtonShowChart:"+f),g=!0),o.length>0){o.push("currentWidth:"+e),o.push("currentHeight:"+t),o.push("usePoppedOutDimensions:"+n),o.push("newWidth:"+i),o.push("newHeight:"+p),o.push("commandBarNeedsUpdate:"+g);var b=o.join(",");this._logInfo("onMeasuring change: "+b)}this._getCachedSize()&&this._getCachedSize().update&&(this._cachedSize=this._getCachedSize().update({width:e,height:t,isWidthInitialized:e>0,isWidthLessThanViewportSm:s,isWidthLessThanViewportM:c,isWidthLessThanMinWidthForChartPlusGridReflow:l,isJumpBarRenderingAsFlyout:u,isWidthGreaterThan480:d,isHeightGreaterThan240:h,showCommandBarButtonSearch:m,showCommandBarButtonShowChart:f}));var v=r;g&&(v=Object.assign(v,this._getUpdateAddedCommandList(m,f))),Object.keys(v).length&&this.setState(v)}},t.prototype._getUpdateAddedCommandList=function(e,t){var r=this;if(this._addedCommandListFromHost=[],e&&(this._logInfo("Adding search button to commandbar for DataSethost."),this._addedCommandListFromHost.push({Icon:"SearchButton",DisplayText:Object(x.c)(this.props.resourceStrings,P.QUICK_FIND_COMMANDBAR_TEXT),Id:this._quickFindCommandBarId,execute:this._onQuickFind})),this.props.isQueryMode){this._logInfo("Adding clear query button to commandbar for DataSethost.");var n=this._getClearQueryText();this._addedCommandListFromHost.push({Icon:"ClearDefault",DisplayText:n,Tooltip:{title:n},Id:"ClearQuery",execute:function(){return r.props.clearQuery()}})}if(!this.props.isOffline&&t){this._logInfo("Adding show chart button to commandbar for DataSethost.");var a=this._getChartPaneText();this._addedCommandListFromHost.push({Icon:"SelectChart",DisplayText:a,Tooltip:{title:a},Id:"ShowChartPane",execute:function(){return r.props.toggleChartPane(r.props.id,r.props.contextToken,!r.props.showChart)}})}return this._onAddedCommandListChange(!1)},t.prototype._onViewChanged=function(e,t,r){var n,a=this;void 0===r&&(r=!0),r&&this._updateDataSetLoadingState(1);var i=this.props.descriptor?this.props.descriptor.Id:null;this._logInfo("The view for the grid changed. The new view parameters for the view are - NewViewId : "+e+", EntityTypeName : "+t+"and ControlName : "+i),this._resetPagingInfoForEnhancedPaging(),null===(n=this._dataSetQuickFindRef.current)||void 0===n||n.clearSearchBar();var o=this.props.gridInput&&this.props.gridInput.entityTypeName.toLowerCase()===T.a;this.props.updateView(this.props.id,i,e,t,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken,this.props.userId,this.props.featureControlProps&&this.props.featureControlProps.isQueueFilterPerfUCIEnabled,o).then((function(){a.props.nonCompositionProps&&a.props.nonCompositionProps.setPageInputViewId&&a.props.nonCompositionProps.setPageInputViewId(e),a.state.controlLoadErrorMessage&&a.setState({controlLoadErrorMessage:null})}),(function(e){a._logInfo(e.message),a._setControlLoadError()}))},t.prototype._onItemIconPointerDown=function(e,t,r,n,a){this._logInfo("“Trying to set default view for user. The new view parameters for the view are - NewViewId : "+t+", EntityTypeName : "+e+", ViewType : "+r+"and Unpin  : "+a);var i=se(this._currentFilterValue);return this.props.updateUserDefaultGridView(e,t,r,n,i,a)},t.prototype._onQuickFind=function(){this.setState({quickFindVisibility:!this.state.quickFindVisibility})},t.prototype._getChartPaneText=function(){var e=this.props,t=e.resourceStrings;return e.showChart?Object(x.c)(t,P.CHARTS_HIDE_CHART_PANE_LABEL):Object(x.c)(t,P.CHARTS_SHOW_CHART_PANE_LABEL)},t.prototype._getClearQueryText=function(){return"Clear query"},t.prototype._updateFilterValue=function(e){this._currentFilterValue=e},t.prototype._onFilterChange=function(e,t){void 0===t&&(t=this.props.gridEntityTypeName),this._logInfo("Applying grid filter, the new value received is "+e),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this._updateFilterValue(e);var r=Object(et.a)(this.props.viewSelectorProps.entityTypeName,this.props.userId,this.props.contextToken,this.props.featureControlProps.isQueueFilterPerfUCIEnabled,this.props.entityIsActivityType).getFilterExpression(e,this.props.userSetting,t);this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyGridFilter(r,e,this.props.contextToken)},t.prototype._clearActivityTypeFilter=function(){this.props.applyActivityTypeFilter("","",this.props.contextToken)},t.prototype._onActivityTypeMenuDismissed=function(e){if(!this.props.isOffline){var t=e.join(","),r=function(e,t){if(null!=e){if(e.indexOf("selectAllKey")>-1||0===e.length||null!=t&&t.length===e.length)return null;for(var r=null,n=[],a=0;a<e.length;a++)n.push({attributeName:"activitytypecode",conditionOperator:0,value:e[a]});return n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}}(e,this.props.entityFilterProps.filterOptionsForActivityType),n=r?JSON.stringify(r):"";void 0===this.props.entityFilterProps.activityTypePreviousValues?this.props.applyActivityTypeFilter(n,t,this.props.contextToken):t!==this.props.entityFilterProps.activityTypePreviousValues&&this._shouldActivitySelectAllFilterFire(t,this.props.entityFilterProps.activityTypePreviousValues,this.props.entityFilterProps.isActivityFilterSelectAllEnabled)&&(this._logInfo("Applying activity type grid filter, the new value received is "+t),2===this.state.loadingState&&this._updateDataSetLoadingState(1),this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,1),this._setResetPagingInfoForEnhancedPaging(),this.props.applyActivityTypeFilter(n,t,this.props.contextToken));var a=[{name:"ActivityTypeFilterUsage",value:"Initiated"},{name:"SelectedActivityTypeFilterCount",value:e.length},{name:"ActivityTypeFilterDropDownCount",value:this.props.entityFilterProps.filterOptionsForActivityType.length}];this.context&&this.context.EventManager&&this.context.EventManager.ReportComponentSuccess&&this.context.EventManager.ReportComponentSuccess(Gt,a)}},t.prototype._shouldActivitySelectAllFilterFire=function(e,t,r){if(r){var n=!1,a=!1;return(t.indexOf("selectAllKey")>-1||""===t)&&(n=!0),(e.indexOf("selectAllKey")>-1||""===e)&&(a=!0),!(n&&a)}return!0},t.prototype._onRollupViewToggleChanged=function(e){this._logInfo("Toggling rollupView control, the new value received is "+e),this.props.toggleGridRollupView(e,this.props.contextToken)},t.prototype._updateFilterOnViewSelectorChange=function(e){this._logInfo("Updating dataset with the existing filter selection for activity pointer"),this._onFilterChange(this._currentFilterValue,e)},t.prototype._onSendControlCommandsEventFired=function(e){this._logInfo("Adding control commands to command bar. The command to be added are : "+e),e!==this._addedCommandListFromControl&&(this._addedCommandListFromControl=e,this._onAddedCommandListChange())},t.prototype._onSelectedOrderColumnChangeFired=function(e){if(this._logInfo("Updating jumpbar filter based on the selected order column"),this.props.featureControlProps.isJumpBarShouldHonorSortingFeatureEnabled&&this.props.jumpBarProps){var t=e.columnSortingName;t=Object(Te.d)(t,e.columnSortingType,e.primaryNameAttribute);var r=Object(Te.b)(this.props.jumpBarProps.selectedFilter,t);this.props.onSelectedOrderColumnChange(r,this.props.contextToken)}},t.prototype._onParentPagePreNavigationEventFired=function(e){var t=this;e&&Array.isArray(e)&&e.length>0&&!this._isPreNavigationEventAttached&&this.context&&this.context.Router&&this.context.Router.registerPreNavigationHandler&&(this._tracer&&this._tracer.info("Adding control preNavigation handlers to the router"),e.forEach((function(e){return t.context.Router.registerPreNavigationHandler((function(){try{return e()}catch(e){t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt,e,null,[{name:"subComponent",value:"onPreNavigation"}])}return Promise.resolve(!0)}))})),this._isPreNavigationEventAttached=!0)},t.prototype._createSwitchVisualization=function(e,t){var r=this;return function(){switch(r._keyIndex++,r.props.contextString){case v.h.ASSOCIATEDGRID:r.props.switchAssociatedGridVisualization(r.props.id,r.props.entityTypeName,r.props.controlId,r.props.viewId,e,r.props.nonCompositionProps&&r.props.nonCompositionProps.viewConfigurations,r.props.nonCompositionProps&&r.props.nonCompositionProps.gridConfigurations,"VIEW_CONFIG"===t);break;case v.h.SUBGRID:r.props.switchSubgridVisualization(r.props.id,e,r.props.controlId);break;case v.h.GRID:default:if(r.props.featureControlProps.isGridPaginationStateFeatureEnabled&&r.props.gridInput){r.props.updateGridPaginationStateHandler([{filterType:3,filterExpressionOrValue:null}],r.props.id),r.props.setCustomFilter("",0,r.props.id,r.props.contextToken)}"VIEW_CONFIG"===t?r.props.switchViewConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!1):r.props.switchHomepageConfiguration(r.props.id,r.props.contextToken,e,r.props.controlId,!0)}}},t.prototype._updateChangeVisualizationButtons=function(e){var t=this,r=this.props.nonCompositionProps&&this.props.nonCompositionProps.gridConfigurations,n=this.props.nonCompositionProps&&this.props.nonCompositionProps.viewConfigurations,a=!1;this._parentSwitchVisualizationButton||(this._parentSwitchVisualizationButton={Icon:"SelectChart",DisplayText:Object(x.c)(this.props.resourceStrings,P.SWITCH_VISUALIZATION_BUTTON_LABEL),Id:this._changeVisualizationCommandBarId+"-Parent",WillOpenFlyout:!0,Children:null}),this._memoizedConfiguration===this.props.updatedConfiguration&&this._memoizedViewConfigurations===n&&this._memoizedResourceStrings===this.props.switchVisualizationResourceStrings||this.props.switchVisualizationResourceStrings&&(this._memoizedConfiguration=this.props.updatedConfiguration,this._memoizedViewConfigurations=n,this._memoizedResourceStrings=this.props.switchVisualizationResourceStrings,this._memoizedButtonList=[],Object(gt.c)(r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e).forEach((function(r){if(!(Object(gt.a)(t.props.updatedConfiguration,r.configuration)||r.configuration.isDefaultConfig&&t.props.updatedConfiguration.isDefaultConfig||t.props.featureControlProps.isDisableEditableGridControlOnPhoneFeatureEnabled&&Object(oe.g)(r.configuration,parseInt(e,10)))){var n={Icon:"SelectChart",DisplayText:""+Object(gt.b)(t.props.switchVisualizationResourceStrings,r.configuration),Id:t._changeVisualizationCommandBarId+"-"+r.configuration.Name+"-"+r.formFactor,execute:t._createSwitchVisualization(r.configuration,r.configurationType),IsInFlyout:!0};t._memoizedButtonList.push(n),a=!0}}))),!this._isSwitchVisualizationInitialized&&this.props.commandBarProps&&(Object(gt.d)(this.props.retrieveControlResourceStringsForSwitchVisualization,this.context,r,n,this.props.updatedConfiguration,this.props,this.props.contextString,e),this._isSwitchVisualizationInitialized=!0),this._parentSwitchVisualizationButton.Children=this._memoizedButtonList,a&&this._onAddedCommandListChange()},t.prototype._onAddedCommandListChange=function(e){var t,r,n,a;void 0===e&&(e=!0);var i=[],o=[],s=(null===(r=null===(t=this._parentSwitchVisualizationButton)||void 0===t?void 0:t.Children)||void 0===r?void 0:r.length)>0;if(this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&o.push(this._parentSwitchVisualizationButton),o.push.apply(o,this._addedCommandListFromControl),o.push.apply(o,this._addedCommandListFromHost),(null===(a=null===(n=this.props.nonCompositionProps)||void 0===n?void 0:n.addedCommandListFromHostParent)||void 0===a?void 0:a.length)>0&&i.push.apply(i,this.props.nonCompositionProps.addedCommandListFromHostParent),!this.props.featureControlProps.isShowAsButtonFirstEnabled&&s&&i.push(this._parentSwitchVisualizationButton),!e)return{addedCommandList:o,appendedCommandList:i};this&&this.setState&&this.setState({addedCommandList:o,appendedCommandList:i})},t.prototype._seeMoreCallback=function(e){this.setState({inSeeMoreState:!this.state.inSeeMoreState})},t.prototype._seeMorePopup=function(e,t){void 0===t&&(t=!1),!0===e?(this._preSeeMoreCachedPagingString=this._currentPagingString,this._currentPagingString=null):(this._currentPagingString=this._preSeeMoreCachedPagingString,this._preSeeMoreCachedPagingString=null),this._keyIndex++,this._seeMoreHelper.seeMorePopup(this._getDataSetHostRootElement(),this._seeMoreCallback.bind(this),e,t,this.props.isRTL)},t.prototype._getDataSetHostRootElement=function(){return i.findDOMNode(this)},t.prototype._onRecordsSelectedCallback=function(e,t){this._logInfo("onRecordsSelected for DataSetHost. New selected rows are "+t);for(var r=[],n=0,a=t;n<a.length;n++){var i=a[n];r.push(new O.a(i))}if(this.props.markSelectedRows(this.props.id,this.props.contextToken,r),e){var o=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,o.TargetEntityType)}else this.props.markSelectedRelatedEntity(this.props.id,this.props.contextToken,null);this.props.isGridEditable&&t.length>0&&this.props.rowProperties(this.props.id,this.props.contextToken,r),this.props.isGridEditable&&(this._logInfo("Running onRecordSelect for EditableGrid"),this.props.runOnRecordSelect(this.props.id,this.props.contextToken,r)),!e&&this._onRecordsSelectedParent&&(this._logInfo("onRecordsSelected: Calling onRecordsSelected callback for the parent control"),this._onRecordsSelectedParent(t))},t.prototype.markGridFirstRequestComplete=function(){this._isFirstRequestComplete=!0},t.prototype._isDataSetHostKnownError=function(e){return!(!e||""===e)&&(-1!==e.indexOf(Ot.a.getHexErrorCodeFromInt(2415919120))||!(-1===e.indexOf(Ot.a.getHexErrorCodeFromInt(-2147093999))||this.props.offlineProps.isEntityAvailableForOffline&&this.props.offlineProps.isOfflineAvailableForUse))},t.prototype._onDataSetUpdateCallback=function(e){this._logInfo("DataSetUpdated for DataSetHost control");var t=[{name:"currentPagingString",value:e&&e.existedPagingString||""}];this.markGridFirstRequestComplete(),this._currentPagingString!==e.existedPagingString&&t.push({name:"previousPagingString",value:this._currentPagingString});var r=!1;e.error?(r=this._isDataSetHostKnownError(e.errorMessage)||!Object(Mt.b)(e.innerError),e.innerError&&t.push({name:"InnerErrorMessage",value:e.innerError}),this.context.EventManager.ReportComponentFailure(Gt,new Error(e.errorMessage||""),null,t)):this.context.EventManager.ReportComponentSuccess(Gt,t);var n={};if(r)n={compositeControlInitState:D.a.Error,controlLoadErrorMessage:e.errorMessage},e.innerError&&(n.controlLoadInnerErrorMessage=e.innerError);else{this.props.updateFetchXml(this.props.id,this.props.contextToken,e.fetchXmlInUse);var a=null;if(e.existedFilteringString){var i=JSON.parse(e.existedFilteringString);a=Object(g.j)(i,ze.CrmXmlEncode),this.props.setCustomFilter(a,0,this.props.id,this.props.contextToken)}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled){var o=[],s=!1,c=null;e.existedValidSortingArrayString&&(c=e.existedValidSortingArrayString);var l=!Object(nt.a)(c)&&JSON.parse(c);if(l&&l instanceof Array&&l.length>0&&c!==this.props.gridSortingInfo&&(this.props.gridInput&&o.push({filterType:7,filterExpressionOrValue:c}),s=!0),s){if(e.existedPagingString){var u=JSON.parse(e.existedPagingString);u.firstPageNumber&&(this.props.updateCurrentPageNumber(this.props.id,this.props.contextToken,u.firstPageNumber),this.props.gridInput&&this._setResetPagingInfoForEnhancedPaging())}this.props.gridInput&&this.props.updateGridPaginationStateHandler(o,this.props.id)}}this.props.updateQueryKey(e.newQueryKey,this.props.id,this.props.contextToken),this.props.updatePagingData(this.props.id,this.props.contextToken,e.existedPagingString),this.props.setNewPageRequested(this.props.id,this.props.contextToken,!1),this._logInfo("onDataSetUpdate: eventPagingString: "+e.existedPagingString),this._currentPagingString=e.existedPagingString}2!==this.state.loadingState?this._updateDataSetLoadingState(2,n):this.setState(n),this._accessibilityId++},t.prototype._configureDataSetControlParams=function(){if(this.props.updatedConfiguration){var e=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(e){!Object(nt.a)(e.onRecordsSelected)&&Object(nt.a)(this._onRecordsSelectedParent)&&e.onRecordsSelected!==this._boundOnRecordsSelected&&(this._onRecordsSelectedParent=e.onRecordsSelected),this._isFirstRequestComplete&&(e.FirstDataRequestType=0),Object(nt.a)(this._boundOnRecordsSelected)&&(this._boundOnRecordsSelected=this._onRecordsSelectedCallback.bind(this,!1)),e.onRecordsSelected=this._boundOnRecordsSelected,e.onDataSetUpdate=this._onDataSetUpdateCallback.bind(this);var t=this.props.descriptor,r=1,n=this.state.pagingInfo.lastPageNumber;this.props.isGridEditable||this._isNativePlatform?this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this._isNativePlatform&&(r=this.state.pagingInfo.firstPageNumber):(r=this.props.pageNumber,n=this.props.pageNumber);var a={firstPageNumber:r,lastPageNumber:n,pageSize:!this._isInSeeMoreState()&&t&&t.Parameters&&t.Parameters[v.q]&&parseInt(t.Parameters[v.q],10)||this.props.recordsPerPageSetting,pagingRefreshInput:this.props.pagingRefreshInput?this.props.pagingRefreshInput.toString():""},i=Object(Ve.a)(this._currentPagingString);if(i&&i.pageSize&&(this._logInfo("Updating pageSize based on _receivedPagingStringData.pageSize to "+i.pageSize),a.pageSize=i.pageSize),e.PagingInput={Static:!0,Value:JSON.stringify(a)},this.props.refreshCounter){var o=this.props.refreshCounter.toString();if(e.RefreshInput={Value:parseInt(o,10),Static:!0},!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)&&this.props.customFilter.source&&1===this.props.customFilter.source){var s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}}if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput){if(!Object(nt.a)(this.props.customFilter)&&!Object(nt.a)(this.props.customFilter.customFilterXml)){s=Object(g.i)(this.props.customFilter.customFilterXml);e.FilteringInput={Static:!0,Value:JSON.stringify(s)}}var c=!Object(nt.a)(this.props.gridSortingInfo)&&JSON.parse(this.props.gridSortingInfo),l=c&&c instanceof Array&&c.length>0,u=!Object(nt.a)(this._previousSortingInfo)&&JSON.parse(this._previousSortingInfo),d=u&&u instanceof Array&&u.length>0;(l||d&&this.props.gridSortingInfo!==this._previousSortingInfo)&&(this._previousSortingInfo=this.props.gridSortingInfo,e.SortingInput={Static:!0,Value:this.props.gridSortingInfo})}this.props.gridEntityTypeName&&(e.EntityName=this.props.gridEntityTypeName)}this._addExtraParametersToConfiguration();var p=this.props.updatedConfiguration.Parameters[this.props.nestedGridDatasetName];if(p&&(p.onRecordsSelected=this._onRecordsSelectedCallback.bind(this,!0),this.props.refreshCounter)){o=this.props.refreshCounter.toString();p.RefreshInput={Value:parseInt(o,10),Static:!0}}}},t.prototype._addExtraParametersToConfiguration=function(){if(this.props.featureControlProps.isGridPaginationStateFeatureEnabled&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.NativeFilterExpressionToRestore={Usage:1,Static:!0,Value:this.props.nativeFilterExpression},!Object(nt.a)(this._pageNumberToRestoreForEnhancedPaging))){var e=this._pageNumberToRestoreForEnhancedPaging;this._pageNumberToRestoreForEnhancedPaging>1&&(this._shouldResetPagingForEnhancedPaging||!this._resetProcessedForEnhancedPaging)&&(this._shouldResetPagingForEnhancedPaging=!1,this._resetProcessedForEnhancedPaging=!1,e=-1),this.props.updatedConfiguration.Parameters.PageNumberToRestore={Usage:1,Static:!0,Value:e}}this.props.lookupAttributeForRecordHierarchy&&this.props.gridInput&&(this.props.updatedConfiguration.Parameters.LookupAttributeNameForHierarchy={Usage:1,Static:!0,Value:this.props.lookupAttributeForRecordHierarchy})},t.prototype._renderAccessibilityNotification=function(e){var t,r=e+"_accessibility",n={left:"-3000%",width:"0%",height:"0%",position:"absolute"};this.props.featureControlProps.isAssociatedGridHeightEnabled&&(n.overflow="hidden");var i=Object(x.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),o=2===this.state.loadingState?null!==(t=this.props.notificationMessage)&&void 0!==t?t:"":i;return a.createElement(c.a,{key:r+"_"+this._accessibilityId,id:r,style:n,role:we.s,notificationType:Ge.b},o)},t.prototype._renderQuickFind=function(){var e=this._showNewQuickFindSearchBarForMobile();if(this.props.quickFindProps&&this._isWidthInitialized()){if(this._isWidthLessThanViewportSm()&&(this.state.quickFindVisibility||e)){var t=Object.assign(this.props.quickFindProps,{focusSearchBoxAfterRender:!0});return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindMobileStyle},a.createElement(Ze,Object(n.__assign)({},t,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef,showNewQuickFindSearchBarForMobile:e})))}if(!this._isWidthLessThanViewportSm())return Object(je.g)(this.props.contextString)?a.createElement(c.a,{style:this.props.styles.quickFindContainerStyle},this._getQuickFind()):this._getQuickFind()}return null},t.prototype._renderAdvancedFilter=function(){var e=this;return this._isWidthInitialized()&&this.props.showAdvancedFilter&&this.props.quickFindProps&&a.createElement(_e.a,{key:"openAdvancedFilter",id:"open-advanced-filter",iconType:"filter",title:Object(x.c)(this.props.resourceStrings,Ft.c.OpenAdvancedFiltersTitleAndAria),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){e._renderAdvancedFindPanel()},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,Ft.c.OpenAdvancedFiltersTitleAndAria)},a.createElement(J.b,{id:"filter",accessibilityHidden:!0,type:p.a.Filter}))},t.prototype._renderAdvancedFindPanel=function(){var e,t=this;this._updateDataSetLoadingState(1);var r=[{name:"entityName",value:this.props.entityTypeName},{name:"ViewId",value:null===(e=this.props.viewId)||void 0===e?void 0:e.guid}];this.props.retrieveRelatedEntitiesMetadata(this.props.entityTypeName).then((function(){t.setState({isFilterPanelOpen:!0}),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentSuccess(Ut,r)}),(function(e){t._tracer.error(null==e?void 0:e.message),t._updateDataSetLoadingState(2),t.context.EventManager.ReportComponentFailure(Ut,new Error(e),r)}))},t.prototype._renderDiscardChanges=function(){var e=this;if(this.props.showAdvancedFilter&&this.props.isViewEdited&&this._isWidthInitialized()&&!this.props.showColumnEditor)return a.createElement(_e.a,{key:"clearAdvancedFilter",id:"clear-advanced-filter",iconType:"clearFilter",title:Object(x.c)(this.props.resourceStrings,P.AdvancedFind_DiscardButton_Title),style:this.props.styles.advancedFilterButtonStyles,onClick:function(){var t;e.props.removeEditedViewPageMap(e.props.gridInput.pageToEditedViewMapId.guid,e.props.viewId),e._clearCustomFilterAndUpdateControlKeyIndex();var r=[{name:"entityName",value:e.props.entityTypeName},{name:"ViewId",value:null===(t=e.props.viewId)||void 0===t?void 0:t.guid}];e.context.EventManager.ReportComponentSuccess(zt,r)},tabIndex:0,accessibilityLabel:Object(x.c)(this.props.resourceStrings,P.AdvancedFilter_DiscardButton_AccessibilityLabel)},a.createElement(J.b,{id:"clearFilter",type:p.a.GlobalFilterClearAll}))},t.prototype._renderColumnEditor=function(){var e=this;if(this.props.showColumnEditor&&this._isWidthInitialized()){var t=Object(x.c)(this.props.resourceStrings,P.ColumnEditorButton);return a.createElement(Vt.a,{key:"columnEditorBtn",id:"columnEditor-btn",iconProps:{iconName:"ColumnOptions",style:{color:"black"}},title:t,"aria-label":t,onClick:function(){return e.setState({columnEditorPanelOpen:!0})},style:this.props.styles.columnEditorButtonStyle})}},t.prototype._clearCustomFilterAndUpdateControlKeyIndex=function(){var e=this;this.props.setCustomFilter("",0,this.props.id,this.props.contextToken).then((function(){e._keyIndex++,e._onViewChanged(e.props.viewId.guid,e.props.entityTypeName,!1)}))},t.prototype._getQuickFind=function(){return a.createElement(c.a,{key:"quickFind",style:this.props.styles.quickFindStyle},a.createElement(Ze,Object(n.__assign)({},this.props.quickFindProps,{updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,resetPagingInfoForEnhancedPaging:this._resetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),ref:this._dataSetQuickFindRef})))},t.prototype._renderViewSelector=function(){if(this.props.viewSelectorProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.viewSelectorOuterMobileStyle:this.props.styles.viewSelectorOuterStyle;return a.createElement(c.a,{key:"viewSelector",style:e},a.createElement(Q,Object(n.__assign)({isGridRoot:Object(je.e)(this.props.contextString)},this.props.viewSelectorProps,{isTablet:this._isWidthLessThanViewportM(),isPhone:this._isWidthLessThanViewportSm(),key:"dataSetHostView",onChange:this._onViewChanged,onItemIconPointerDown:this._onItemIconPointerDown,rootZIndex:this._isInSeeMoreState(),isRTL:this.props.isRTL,removeEditedViewPageMap:this.props.removeEditedViewPageMap})))}return this._renderTitle()},t.prototype._renderQueueFilter=function(){if((this.props.entityTypeName===Pt.Bb||this.props.entityTypeName===Tt.a)&&this.props.queueFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm()?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle;return a.createElement(ce,Object(n.__assign)({},this.props.queueFilterProps,{key:"queueFilter",onFilterChange:this._onFilterChange,updateFilterValue:this._updateFilterValue,resourceStrings:this.props.resourceStrings,style:e,isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled}))}return null},t.prototype._renderEntityFilter=function(){if(this.props.entityFilterProps&&this._isWidthInitialized()){var e=this._isWidthLessThanViewportSm(),t=e?this.props.styles.filterContainerMobileStyle:this.props.styles.filterContainerStyle,r=this.props.styles.activityTypeFilterContainerStyle;return a.createElement(me,Object(n.__assign)({},this.props.entityFilterProps,{onToggleChange:this._onRollupViewToggleChanged,key:"EntityFilterDataSet",onFilterChange:this._onFilterChange,onActivityTypeChange:this._onActivityTypeMenuDismissed,onActivityTypeFilterClear:this._clearActivityTypeFilter,gridEntityName:this.props.gridEntityTypeName,resourceStrings:this.props.resourceStrings,containerStyle:t,activityTypeContainerStyle:r,rootZIndex:this._isInSeeMoreState(),isGridPaginationStateFeatureEnabled:this.props.featureControlProps.isGridPaginationStateFeatureEnabled,isMobile:e}))}return null},t.prototype._renderDataSetChart=function(){return this.props.chartProps&&this._isWidthInitialized()?(this.props.chartProps.isLayoutVertical=this._isReflowLayoutVertical,a.createElement(_,Object(n.__assign)({},this.props.chartProps,{style:this._isReflowLayoutVertical?this._isWidthLessThanViewportSm()?this.props.styles.reflowChartMobileStyle:this.props.styles.reflowChartStyle:this.props.styles.chartStyle,key:"pageChartDataSet",closeChartPaneHandler:this.props.toggleChartPane}))):null},t.prototype._renderBackButtonForGridInMobile=function(){return this.props.commandBarProps&&this._isWidthInitialized()&&Object(je.e)(this.props.contextString)&&this._isWidthLessThanViewportSm()&&this.props.backButtonEnabled?a.createElement($.a,{pageId:this.props.id,overwriteStyle:{borderWidth:0,height:"auto",padding:0,margin:"-8px 0"}}):null},t.prototype._renderCommandBar=function(){var e=this;if(!this.props.commandBarProps||!this._isWidthInitialized())return null;this._commandBarLoadedPromise||(this._commandBarLoadedPromise=new Promise((function(t){e._commandBarLoadedResolve=t}))),this._commandManagerId=this._commandManagerId||this.props.commandBarProps.commandManagerId||Object(fe.a)();var t=this.props.styles.commandManagerContainerStyle,r=this.props.styles.commandBarStyle;this._isWidthLessThanViewportSm()&&(t=this.props.styles.commandManagerContainerMobileStyle,r=this.props.styles.commandBarMobileInnerStyle);var i=Object(je.e)(this.props.contextString);return Object(K.b)(this.props.commandBarRefreshProps,r,this._isWidthLessThanViewportSm(),t),a.createElement(ae,Object(n.__assign)({},this.props.commandBarProps,{key:"commandBarDataSet",addedCommandList:this.state.addedCommandList,appendedCommandList:this.state.appendedCommandList,metaDataLoadedResolve:this._commandBarLoadedResolve,commandManagerId:this._commandManagerId,style:t,commandbarStyles:r,rootZIndex:this._isInSeeMoreState(),customControlType:this.props.updatedConfiguration.CustomControlId,isGridRoot:i,collapsed:this._isWidthLessThanViewportSm(),isNativeMode:this._isNativeSubgrid()}))},t.prototype._renderFooter=function(){var e=!1;if(this.props.totalResultCount<=this.props.pageSize&&!this.props.totalRecordCountLimitExceeded&&Object(je.g)(this.props.contextString)&&!this._isInSeeMoreState()&&!this.props.jumpBarProps&&!(e=this._shouldRenderSeeMoreButton()))return this._logInfo("Hiding the footer for the subgrid because there is less than 2 pages of data"),null;if(this._isWidthInitialized()&&(this.props.jumpBarProps||this.props.pagingProps)){var t=this._isJumpBarRenderingAsFlyout()?this.props.styles.footerMobileStyle:this.props.isGridEditable?this.props.styles.footerEditableGridStyle:Object(n.__assign)(Object(n.__assign)({},this.props.styles.footerOuterStyle),this.props.jumpBarProps?this.props.styles.defaultFooterHeightStyle:this.props.styles.jumpBarLessFooterHeightStyle);if(!this.props.isGridEditable)return this._hideJumpbarForMobile()?null:a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},!e&&this._renderJumpBar(),a.createElement(c.a,{key:"dataSetPagingContainer_"+this.props.id,style:this.props.styles.footerPagingContainer},this._renderPaging(e),this._renderSeeMoreButton()));if(this.props.jumpBarProps)return a.createElement(c.a,{key:"dataSetFooter_"+this.props.id,style:t},this._renderJumpBar());this._logInfo("Hiding the footer for the editable grid because the jump bar props is null")}return this._logInfo("Hiding the footer for the grid because the width for the controld is 0 or the jump bar props is null or paging props is null"),null},t.prototype._jumpBarShouldRenderAsFlyout=function(e){var t=Object(x.c)(this.props.resourceStrings,P.JUMPBAR_ALPHABET);if(t){var r=t.split(","),n=e-100,a=this._isJumpBarRenderingAsFlyout()?.5:-.5;return!!r&&n/r.length<=32+a}return!1},t.prototype._renderJumpBar=function(){var e=null;return this._isJumpBarRenderingAsFlyout()&&(e=this.props.styles.jumpBarButtonContainerStyle),this.props.jumpBarProps?a.createElement(c.a,{key:"jumpBar_"+this.props.id,style:e},a.createElement(ke,Object(n.__assign)({},this.props.jumpBarProps,{rootZIndex:this._isInSeeMoreState(),controlKey:this.props.controlKey,renderMobile:this._isJumpBarRenderingAsFlyout(),isDeviceSizeSmall:!this._isWidthGreaterThan480(),isRTL:this.props.isRTL,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,setResetPagingInfoForEnhancedPaging:this._setResetPagingInfoForEnhancedPaging.bind(this),updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isMobile:this._isWidthLessThanViewportM()}))):null},t.prototype._renderPaging=function(e){var t=Object(je.f)(this.props),r=!this.props.hasCustomDataProvider&&Object(nt.a)(this.props.totalRecordCountLimitExceeded);return t&&this._logInfo("Hiding the paging button for the grid because the sharepoint grid does not support paging"),this.props.pagingProps?a.createElement(Xe,Object(n.__assign)({},this.props.pagingProps,{pagingInfo:this.state.pagingInfo,shouldPagingTextRender:!e,incrementLastPage:this._incrementLastPage,setFirstPage:this._setFirstPage,enhancedPagingDisabled:!e&&!t&&!this._isNativePlatform,pagingTextDisabled:r,gridTotalRecordsCountLimit:this.props.gridTotalRecordsCountLimit,isGridRoot:Object(je.e)(this.props.contextString),updateGridPaginationStateHandler:this.props.updateGridPaginationStateHandler,updateDataSetLoadingState:this._updateDataSetLoadingState.bind(this),isServerOffline:this.props.isOffline})):null},t.prototype.renderDataSetHostComponent=function(e,t,r,i,o){var s,u,d,g,f=this,b=[],y=this._isWidthLessThanViewportSm();this._isReflowLayoutVertical=!(!this._isWidthLessThanMinWidthForChartPlusGridReflow()||!this.props.chartProps);try{var _=this._getDataSetHostErrorMessage();if(Object(nt.a)(_)||this.state.compositeControlInitState===D.a.Initializing){if(this._isWidthInitialized()||Object(je.g)(this.props.contextString)&&this.state.compositeControlInitState!==D.a.Initializing){this._isShowChartChanged&&(this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart()),this._onAddedCommandListChange(),this._isShowChartChanged=!1);var O=(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.entityIsActivityType;y||Object(je.g)(this.props.contextString)?(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps||this.props.commandBarProps)&&(this.props.featureControlProps.isInMobileModeForOct2019&&Object(je.e)(this.props.contextString)&&(o=Object(n.__assign)(Object(n.__assign)({},o),{display:"none"})),b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderBackButtonForGridInMobile(),this._renderViewSelector(),this._renderCommandBar()],o),this._renderQuickFind(),O||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===v.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter()))):(b.push(this._renderCommandBar()),(this.props.viewSelectorProps||this.props.quickFindProps||this.props.entityFilterProps||this.props.queueFilterProps)&&b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector(),this._renderDiscardChanges(),this._renderColumnEditor(),this._renderAdvancedFilter(),this._renderQuickFind()],o),O||this.props.entityFilterProps&&this.props.entityFilterProps.isRollupViewSupported&&this.props.contextString===v.h.ASSOCIATEDGRID?this._renderEntityFilter():this._renderQueueFilter())));var S=this.props.chartProps&&this._isReflowLayoutVertical?this.props.styles.reflowdataSetContentBodyStyle:this.props.styles.dataSetContentBodyStyle;if(this.props.featureControlProps.isAssociatedGridHeightEnabled&&Object(je.d)(this.props.contextString)&&(S=Object(n.__assign)(Object(n.__assign)({},S),{flexBasis:"0px"})),this.props.chartProps&&!this._isReflowLayoutVertical&&this.props.featureControlProps.isSuiterChartEnabled||this._showNewQuickFindSearchBarForMobile()){S=Object(n.__assign)(Object(n.__assign)({},S),{borderTop:"1px solid #d8d8d8"})}var C=(null===(g=null===(d=null===(u=this.props)||void 0===u?void 0:u.configuration)||void 0===d?void 0:d.Parameters)||void 0===g?void 0:g.EnableSubGridAutoCollapse)&&this.props.configuration.Parameters.EnableSubGridAutoCollapse,I=C&&C.Value,j=this.props.featureControlProps.isSubGridAutoCollapseEnabled&&Object(je.g)(this.props.contextString)&&"true"===I;j&&0===this.props.totalResultCount&&(S=Object(n.__assign)(Object(n.__assign)({},S),{display:"none"})),this.props.featureControlProps.isSubGridRemoveMinHeightEnabled&&j&&(S=Object(n.__assign)(Object(n.__assign)({},S),{minHeight:"0px"}));var T=y&&Object(je.e)(this.props.contextString),E=this._parentDefinedProps;this.props.parentDefinedControlProps&&(E.height=this.props.parentDefinedControlProps.height>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.height:void 0,E.width=this.props.parentDefinedControlProps.width>0&&this._seeMoreHelper.getSeeMorePopupStatus()===m.b.NotInUse?this.props.parentDefinedControlProps.width:void 0,E.decorators=this.props.parentDefinedControlProps.decorators,E.propertyBagOverrides=this.props.parentDefinedControlProps.propertyBagOverrides),E.parentInSeeMoreMode=this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse,E.containerStyleOverrides=this._getCombinedContainerStyleOverrides();var w=null;this.props.chartProps&&this._isWidthInitialized()&&(w={width:"70%"});var F=Ne.a.getInstance().get_IsBrowserIE()?Object.assign(i,{flex:"1 1 100%"}):i;b.push(a.createElement(c.a,{key:"dataSetContentBody_"+this.props.id,style:S},this._renderDataSetChart(),a.createElement(c.a,{key:"dataSetBody_"+this.props.id,style:!0===this._isReflowLayoutVertical?this.props.styles.reflowGridStyle:Object.assign(F,w),className:this._isInSeeMoreState()?"seeMore":void 0,testhooks:{id:"data-set-body-container"}},a.createElement(h.c,{key:this.props.controlKey+this._keyIndex,controlId:this.props.controlId,id:this.props.id,formInfo:this._savedFormInfo,configuration:this.props.updatedConfiguration,descriptor:this.props.descriptor?this.props.descriptor:this._savedDefault,systemDefinedProperties:this.props.systemDefinedProperties,rowSpan:this.props.rowSpan,parentDefinedControlProps:E,parentContextToken:this.props.contextToken,contextString:this.props.contextString,externalCommandManagerId:this._commandManagerId,externalCommandPromise:this._commandBarLoadedPromise,shouldRender:this.props.nonCompositionProps?this.props.nonCompositionProps.shouldRender:void 0}),T?null:this._renderFooter()))),T&&b.push(this._renderFooter()),b.push(this._renderAccessibilityNotification(e)),b=b.concat(this._renderAccessibilityComponent(e))}}else if(2!==this.state.loadingState&&this._updateDataSetLoadingState(2),b.push(a.createElement(c.a,{key:"dataSetHeader_"+this.props.id,style:r},this._renderHeader([this._renderViewSelector()],o))),this._isWidthInitialized()){var A={fontSize:this._isHeightGreaterThan240()&&this._isWidthGreaterThan480()?"4.5em":"2em",color:"red"},N=Object(x.c)(this.props.resourceStrings,P.SEE_MORE_DETAILS);b.push(a.createElement(c.a,null,a.createElement(l.a,{id:"gridErrorContainer"+this.props.id,text:_,icon:p.a.DetailsPageClose,iconStyle:A}),this.state.controlLoadInnerErrorMessage&&!this._isDataSetHostKnownError(this.state.controlLoadErrorMessage)&&a.createElement(c.a,{style:{display:"flex",justifyContent:"center"}},a.createElement(ye.a,{key:"gridInnerErrorMessage",href:"#",accessibilityLabel:N,onClick:function(){f.props.showInnerError(f.state.controlLoadInnerErrorMessage)}},N))))}var k=Object(n.__assign)(Object(n.__assign)({},t),this.state.controlLoadInnerErrorMessage&&{backgroundColor:"#FFFFFF"});return a.createElement(c.a,{style:k,onMeasuring:this.onMeasuring,isRequestedMeasuring:!0,id:e,key:e,testhooks:(s={id:e},s[St.b]=this.props.previewId,s[St.c]=20,s),semanticTag:this.props.semanticTag},b)}catch(e){this._onControlLoadedError(e)}},t.prototype._getDataSetHostErrorMessage=function(){var e,t=null;if(this.props.hasReadRolePrivilege)if(this.props.isUCIEntity||this.props.hasCustomDataProvider)if(this.props.offlineProps.isOfflineSqlQueryAvailable)t=this.props.isOffline&&this.state.controlLoadErrorMessage&&!this.props.hasCustomDataProvider?this.props.offlineProps.isEntityAvailableForOffline?this.props.offlineProps.isOfflineAvailableForUse?this.state.controlLoadErrorMessage:Object(x.c)(this.props.resourceStrings,P.OFFLINE_NOT_READY_FOR_USE):Object(x.c)(this.props.resourceStrings,P.ENTITY_NOT_AVAILABLE_IN_PROFILE):this.state.controlLoadErrorMessage;else{var r="";this.props.offlineProps.offlineErrorMessageKey&&(r=Object(x.c)(this.props.resourceStrings,this.props.offlineProps.offlineErrorMessageKey)),r||(r=Object(x.c)(this.props.resourceStrings,P.VIEW_NOTAVAILABLE_IN_OFFLINE)),t=r}else{var n=this.props.entityDisplayName?this.props.entityDisplayName:this.props.entityTypeName,a=Object(x.c)(this.props.resourceStrings,P.UCI_DISABLED_ENTITY_ERROR);t=String.format(a,n)}else t=Object(x.c)(this.props.resourceStrings,P.READ_PRIVILEGE_VIOLATION_KEY);return Object(nt.a)(t)||null===(e=this._tracer)||void 0===e||e.error(Gt+"._getDataSetHostErrorMessage : "+t,this.props.isOffline&&this.props.offlineProps.offlineGridErrorTelemetryParams),t},t.prototype._renderHeader=function(e,t){void 0===e&&(e=[]);var r=(e||[]).filter((function(e){return!!e}));return r.length?a.createElement(c.a,{key:"dataSetHeaderInner_"+this.props.id,style:t},r):null},t.prototype._getParentDefinedPropsDecoratorValue=function(e){return this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.decorators&&this.props.parentDefinedControlProps.decorators[e]},t.prototype._shouldRenderSeeMoreButton=function(){return this._getParentDefinedPropsDecoratorValue("ShowSeeMore")&&!!this.props.totalResultCount},t.prototype._renderSeeMoreButton=function(){var e=Object(je.g)(this.props.contextString),t=Object(je.d)(this.props.contextString),r=this._seeMoreHelper.getSeeMorePopupStatus(),n=Object(je.f)(this.props);return!((e||t)&&!n)||r===m.b.PopFadeIn||r===m.b.PoppedOut||r===m.b.ReturnFadeOutAndMove||this.props.totalResultCount>=0&&this.props.totalResultCount<=this.props.pageSize&&!this._shouldRenderSeeMoreButton()||!this._isNativePlatform?(this._logInfo("Hiding the See more button for the grid because the grid does not support see more or there is less than 2 pages of data"),null):a.createElement($e,{onSeeMoreClick:this._seeMorePopup.bind(this,!0,!1),resourceStrings:this.props.resourceStrings,containerStyle:this.props.styles.seeMoreButtonContainerStyle,buttonStyle:this.props.styles.seeMoreButtonStyle,seeMoreTextStyle:this.props.styles.seeMoreButtonTextStyle,localizedStrings:this._getSeeMoreLocalizedStrings()})},t.prototype._getSeeMoreLocalizedStrings=function(){var e=null;return this.props.viewSelectorProps&&this.props.viewSelectorProps.title?e=this.props.viewSelectorProps.title:this.props.descriptor.ShowLabel&&this.props.descriptor.Label?e=this.props.descriptor.Label:this.props.entityDisplayName&&(e=this.props.entityDisplayName),this._isNativeSubgrid()?{uniqueLabel:e,seeMoreLabel:Object(x.c)(this.props.resourceStrings,P.SEE_ALL_LABEL),seeMoreTooltip:Object(x.c)(this.props.resourceStrings,P.SEE_ALL_TOOL_TIP)}:{uniqueLabel:e}},t.prototype._isStreamOnSuiterDashboard=function(){return this.props.featureControlProps.isSuiterDashboardEnabled&&Object(je.g)(this.props.contextString)&&this.props.configuration&&this.props.configuration.Parameters&&this.props.configuration.Parameters.UseDefaultCardFormForList&&this.props.configuration.Parameters.UseDefaultCardFormForList.Value},t.prototype._renderProgressIndicator=function(){var e="datasethost-progress-indicator";this.props.descriptor&&(e+="-"+this.props.descriptor.Id);var t=Object(n.__assign)({},this.props.styles.dataSetChangingProgressIndicatorContainerStyle),r=this.props.styles.progressIndicatorContainerStyle;return 1===this.state.loadingState?(t.width=this._width,t.height=Math.max(this._height,100)):0===this.state.loadingState&&this._isStreamOnSuiterDashboard()&&(r=Object(n.__assign)(Object(n.__assign)({},r),{borderBottom:"none"})),a.createElement(c.a,{key:"progressIndicatorContainer",id:"progressIndicatorContainer",style:0===this.state.loadingState?r:t},a.createElement(c.a,{key:"progressIndicator",id:"progressIndicator",style:0===this.state.loadingState?this.props.styles.progressIndicatorStyle:this.props.styles.dataSetChangingProgressIndicatorStyle},a.createElement(d.a,{key:e,id:e,testhooks:{id:e},style:this.props.styles.datasethostProgressIndicatorStyle,progressType:"ring",displayDelay:0===this.state.loadingState&&2e3,active:!0})))},t.prototype.componentWillUnmount=function(){this._seeMoreHelper&&this._seeMoreHelper.destroy(),clearTimeout(this._statusTimeout),this._statusTimeout=null},Object.defineProperty(t.prototype,"_tracer",{get:function(){return this.context?this.context.TraceManager.getTracer(v.z):null},enumerable:!1,configurable:!0}),t.prototype._updateStatus=function(e){var t=this;this.state.statusMessage===e||this._isSubGridFirstLoad||(clearTimeout(this._statusTimeout),this._statusTimeout=setTimeout((function(){return t.setState({statusMessage:e})}),1e3))},t.prototype.render=function(){var e,t,r,i,o,s=this;if(Object(nt.a)(this.props.updatedConfiguration))return this._logInfo("DataSetHost not rendered. Configuration is null"),null;if(!this.props.isInitialized&&this.props.contextToken&&this.props.primaryDataSetName&&this.state.compositeControlInitState!==D.a.Error){var l=this.props.updatedConfiguration.Parameters[this.props.primaryDataSetName];if(!l)return this._logInfo("DataSetHost not rendered. DataSet is not initialized and configuration does not contain primary dataset name."),null;if(this.state.compositeControlInitState===D.a.Uninitialized){this.setState({compositeControlInitState:D.a.Initializing});var d=this.props.viewId?this.props.viewId:l.ViewId?O.a.parse(l.ViewId):null,p=this.props.gridEntityTypeName||l.TargetEntityType||l.EntityName;if(!p&&!this.props.hasCustomDataProvider)return this._tracer&&this._tracer.error("DataSetHost not rendered. Reason: entityName unknown"),null;this.props&&this.props.hasCustomDataProvider&&this._logInfo("render: Initializing DataSetHost, id "+this.props.controlId+", for custom data provider"),this._logInfo("Initializing grid for "+d+" view and "+p+" entity."),this.props.initializeGrid(d,p,this.props.commandBarProps&&this.props.commandBarProps.commandManagerId,this.props.contextToken).then((function(){s._logInfo("Initialized grid for "+d+" view and "+p+" entity."),s.setState({compositeControlInitState:D.a.Initialized})}),(function(e){var t=e instanceof Error?e.message:e;-1!==tt.c.indexOf(t)?s._setControlLoadError(t):s._tracer&&s._tracer.error("Grid initialization failed. Reason: "+t),s.setState({compositeControlInitState:D.a.Error})}))}return this._logInfo("DataSetHost not rendered. Either state is not initialized or resource strings are not initialized"),null}if(this.props&&this.props.nonCompositionProps&&this.props.nonCompositionProps.addedCommandListFromHostParent&&this._addedCommandListFromHostParent!==this.props.nonCompositionProps.addedCommandListFromHostParent&&(this._addedCommandListFromHostParent=this.props.nonCompositionProps.addedCommandListFromHostParent,this._onAddedCommandListChange()),this.props.descriptor&&this.props.descriptor.Parameters){var h=this.props.descriptor.Parameters[v.c];if(this._isWidthLessThanViewportSm()&&h&&"false"===h)return this._logInfo("DataSetHost not rendered. Available on phone is set to false"),null}this._configureDataSetControlParams(),this._updateViewSelectorProps(this.props),!this.props.viewId||!(null===(e=this.props.nonCompositionProps)||void 0===e?void 0:e.setPageInputViewId)||this.props.viewId.guid===(null===(r=null===(t=this.props.gridInput)||void 0===t?void 0:t.viewId)||void 0===r?void 0:r.guid)&&(null===(i=this.props.gridInput)||void 0===i?void 0:i.viewType)||this.props.savedQueryType===I.a.QUICKFIND_SEARCH||this.props.nonCompositionProps.setPageInputViewId(this.props.viewId.guid),this._savedDefault&&this.props.controlId===this._savedDefault.Id||(this._savedDefault={Id:this.props.controlId,HasContext:!0,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1}),this.props.formInfo&&(this._savedFormInfo=this.props.formInfo,null!=this.props.ribbonId&&(this._savedFormInfo.RibbonId=this.props.ribbonId));var g=this.props.descriptor&&this.props.descriptor.DomId&&this.props.descriptor.Id?this.props.descriptor.DomId.includes(this.props.descriptor.Id)?this.props.descriptor.DomId:this.props.descriptor.Id:this.props.id,f="dataSetRoot_"+g,b=this.props.styles,y=b.containerStyle,_=b.headerStyle,S=this.props.styles,C=S.rootStyle,j=S.headerInnerStyle,P=S.bodyStyle;this._updateChangeVisualizationButtons(this.props.updatedConfiguration.FormFactor.toString());var T=y,E={shadowStyle:null,innerStyle:null,outerStyle:null};this._isWidthLessThanViewportSm()&&(P=this.props.styles.bodyMobileStyle,j=this.props.styles.headerInnerMobileStyle);var w=this._seeMoreHelper.getSeeMorePopupStatus(),F=this._seeMoreHelper.getSeeMorePopupInfo();w!==m.b.NotInUse&&(E=m.a.getCustomControlFancyPopoutStyles(this.props.renderer,w,F),w!==m.b.ReturnFadeIn&&(T={height:F.startHeight,width:F.startWidth},C=Object(n.__assign)(Object(n.__assign)({},C),{height:F.endHeightInner-48})));var x=this.renderDataSetHostComponent(f,C,_,P,j),A=(this._getDataSetHostRootElement(),this._seeMorePopup.bind(this,!1)),N=this.props.isRTL,k=function(e,t,r,n,i,o,s,l){void 0===l&&(l=!1);var u=i||o,d="DataSetHostContainer";return a.createElement(c.a,{key:d,id:d+"_"+s,style:u,testhooks:{id:d}},e.renderCloseButton(n,!0,!1,l),e.renderSpacer(!0,!1),t)}(this._seeMoreHelper,x,0,A,E.innerStyle,C,f,N),M=Object(n.__assign)({},E.outerStyle?E.outerStyle:C);0===this.state.loadingState?(M.visibility="hidden",M.maxHeight="0"):1===this.state.loadingState&&(M=Object(n.__assign)(Object(n.__assign)({},M),{opacity:"0.6",pointerEvents:"none",minHeight:this._height}));var R=function(e,t,r,n){var i=t||{width:"100%"},o=n?we.e:null;return a.createElement(c.a,{key:"DataSetHostOuterContainer",id:r+"_outer",style:i,role:o},e)}(k,M,f,(null===(o=this._seeMoreHelper)||void 0===o?void 0:o.getSeeMorePopupStatus())!==m.b.NotInUse),L=function(e,t){return t=t||{display:"none"},a.createElement(c.a,{key:"shadow",id:e?e+"shadow":null,style:t})}(f,E.shadowStyle),B="datassethost_root_view_"+g+"_"+f,V=Ne.a.getInstance().get_IsBrowserIE()&&Object(je.g)(this.props.contextString)?{overflow:"visible"}:{},G=this.props.styles.mobileSubGridContainerStyles,U=Object.assign(T,V);return this._isNativePlatform&&Object(je.g)(this.props.contextString)&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled&&(U=Object(n.__assign)(Object(n.__assign)({},U),G)),a.createElement(c.a,{key:B,style:U},a.createElement(u.a,{role:we.s,notificationType:Ge.b,style:{left:"-3000%",width:"0%",height:"0%",position:"absolute"}},this.state.statusMessage),L,R,this.props.showAdvancedFilter&&this.state.isFilterPanelOpen&&a.createElement(wt,{controlId:this.props.controlId,controlKey:this.props.controlKey,id:this.props.id,contextToken:this.props.contextToken,entityTypeName:this.props.entityTypeName,fetchXML:this.props.fetchXML,filterPanelOpen:this.state.isFilterPanelOpen,viewId:this.props.viewId,gridInput:this.props.gridInput,updateFetchXml:this.props.updateFetchXml,updatePageInput:this.props.updatePageInput,closeFilterPanel:this.closeFilterPanel,onViewChanged:this._onViewChanged,setAdvancedPanelApplyClick:function(){s._clearCustomFilterAndUpdateControlKeyIndex(),s.setState({isAdvancedFilterEdited:!0})},originalView:this.props.originalView,resourceStrings:this.props.resourceStrings,telemetryMonitorAdvancedFindDiscard:zt,resetAdvancedFilter:function(){return s.setState({isAdvancedFilterEdited:!1})}}),this.props.showColumnEditor&&a.createElement(Lt,{entityTypeName:this.props.entityTypeName,onViewChanged:this._onViewChanged,columnEditorPanelOpen:this.state.columnEditorPanelOpen,columnEditorPanelDismiss:function(){return s.setState({columnEditorPanelOpen:!1})},viewId:this.props.viewId,pageId:this.props.id,gridInput:this.props.gridInput,updatePageInput:this.props.updatePageInput,fetchXML:this.props.fetchXML,isAdvancedFindFilterEdited:this.state.isAdvancedFilterEdited}),2!==this.state.loadingState?this._renderProgressIndicator():null)},t.prototype.componentDidMount=function(){this._getUpdateAddedCommandList(this._showCommandBarButtonSearch(),this._showCommandBarButtonShowChart())},t.prototype.closeFilterPanel=function(){this.setState({isFilterPanelOpen:!1})},t.prototype.componentWillReceiveProps=function(e){var t=this;(Object(je.e)(this.props.contextString)||Object(je.g)(this.props.contextString)||Object(je.d)(this.props.contextString))&&!this.props.isOffline&&e.isOffline&&0===this._offlineSqlQueryRetrieveState&&this.props.offlineProps.isEmptyOfflineSqlQuery&&(this._offlineSqlQueryRetrieveState=1,this.props.retrieveView(this.props.entityTypeName,this.props.savedQueryType,this.props.viewType,this.props.viewId,!1).then((function(){t._offlineSqlQueryRetrieveState=2;var e=[{name:"scenario",value:"Called retrieveView"},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:O.a.toString(t.props.viewId)}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentSuccess&&t.context.EventManager.ReportComponentSuccess(Gt+".componentWillReceiveProps",e)})).catch((function(e){t._offlineSqlQueryRetrieveState=2;var r=[{name:"scenario",value:"Called retrieveView"},{name:"error",value:e&&e.message},{name:"entityTypeName",value:t.props.entityTypeName},{name:"viewId",value:O.a.toString(t.props.viewId)},{name:"viewType",value:t.props.viewType},{name:"savedQueryType",value:t.props.savedQueryType}];t.context&&t.context.EventManager&&t.context.EventManager.ReportComponentFailure&&t.context.EventManager.ReportComponentFailure(Gt+".componentWillReceiveProps",e,null,r)}))),this._isShowChartChanged=this.props.showChart!==e.showChart},t.prototype.shouldComponentUpdate=function(e){return this.props.entityTypeName===T.a&&this.props.gridEntityTypeName!==e.gridEntityTypeName&&this._currentFilterValue?(this._updateFilterOnViewSelectorChange(e.gridEntityTypeName),!1):1!==this._offlineSqlQueryRetrieveState&&(0!==e.refreshCounter&&this.props.refreshCounter!==e.refreshCounter&&2===this.state.loadingState&&this._updateDataSetLoadingState(1),!0)},t.prototype.componentDidUpdate=function(){this._seeMoreHelper.getSeeMorePopupStatus()!==m.b.NotInUse&&this._seeMoreHelper.checkOnPopupStatus(!0,!1,this._getDataSetHostRootElement());var e=Object(x.c)(this.props.resourceStrings,P.GRID_LOADING_PLACEHOLDER).replace("{0}",this.props.entityDisplayName),t=2===this.state.loadingState?this.props.notificationMessage:e;Object(je.g)(this.props.contextString)&&(0===this.state.loadingState?this._isSubGridFirstLoad=!0:1===this.state.loadingState&&(this._isSubGridFirstLoad=!1)),this._updateStatus(t)},t.prototype._renderAccessibilityComponent=function(e){var t=e+"Accessibility";if(Object(je.e)(this.props.contextString)){var r=[];if(this.props.viewSelectorProps){var n=this.props.viewSelectorProps.id;r.push(a.createElement(Ee.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0,defaultFocusId:n}))}else r.push(a.createElement(Ee.a,{key:t,rootElementId:e,isModal:!1,shouldManageFocus:!0}));return r}return null},t.prototype._isInSeeMoreState=function(){var e=this._seeMoreHelper.getSeeMorePopupStatus();return e!==m.b.NotInUse&&e!==m.b.ReturnFadeOutAndMove&&e!==m.b.ReturnFadeIn},t.prototype._isNativeSubgrid=function(){return Object(je.g)(this.props.contextString)&&this.props.clientHostSubtype===Rt.a.Phone&&this.props.featureControlProps.isInMobileModeForOct2019&&this.props.featureControlProps.isInMobileModeForApril2020&&this.props.featureControlProps.isSubgridImprovementsEnabled},t.prototype._getCombinedContainerStyleOverrides=function(){var e=this._parentDefinedProps.containerStyleOverrides,t=this.props.parentDefinedControlProps&&this.props.parentDefinedControlProps.containerStyleOverrides;return Object.assign(e,t,{rootContainer:Object.assign(e.rootContainer,{flex:Object(je.e)(this.props.contextString)||this._isInSeeMoreState()?"1 1 100%":"1 1 auto"},t&&t.rootContainer),primaryInnerContainer:this._isInSeeMoreState()?{flex:"1 1 100%",minHeight:"0"}:{}})},t.prototype._updateViewSelectorProps=function(e){if(e.descriptor&&e.viewSelectorProps&&e.descriptor.Parameters){var t=e.descriptor.Parameters[v.B],r=t?t.toString().split(","):null,n=r?r.map((function(e){return O.a.tryParse(e)})):null;e.viewSelectorProps.viewIds=n||null}},t.prototype._getCachedSize=function(){return this._cachedSize||(this._cachedSize=this.props.cachedSize),this._cachedSize},t.prototype._isWidthInitialized=function(){return this.state.isWidthInitialized||this._getCachedSize()&&this._getCachedSize().isWidthInitialized||!1},t.prototype._isWidthLessThanViewportSm=function(){return this.state.isWidthLessThanViewportSm||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportSm||!1},t.prototype._isWidthLessThanViewportM=function(){return this.state.isWidthLessThanViewportM||this._getCachedSize()&&this._getCachedSize().isWidthLessThanViewportM||!1},t.prototype._isWidthLessThanMinWidthForChartPlusGridReflow=function(){return this.state.isWidthLessThanMinWidthForChartPlusGridReflow||this._getCachedSize()&&this._getCachedSize().isWidthLessThanMinWidthForChartPlusGridReflow||!1},t.prototype._isWidthGreaterThan480=function(){return this.state.isWidthGreaterThan480||this._getCachedSize()&&this._getCachedSize().isWidthGreaterThan480||!1},t.prototype._isHeightGreaterThan240=function(){return this.state.isHeightGreaterThan240||this._getCachedSize()&&this._getCachedSize().isHeightGreaterThan240||!1},t.prototype._showCommandBarButtonSearch=function(){return this.state.showCommandBarButtonSearch||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonSearch||!1},t.prototype._showCommandBarButtonShowChart=function(){return this.state.showCommandBarButtonShowChart||this._getCachedSize()&&this._getCachedSize().showCommandBarButtonShowChart||!1},t.prototype._isJumpBarRenderingAsFlyout=function(){return this.state.isJumpBarRenderingAsFlyout||this._getCachedSize()&&this._getCachedSize().isJumpBarRenderingAsFlyout||!1},t.prototype._hideJumpbarForMobile=function(){return this.props.featureControlProps.isJumpbarFeatureForMobileEnabled&&this._isWidthLessThanViewportSm()&&(Object(je.e)(this.props.contextString)||Object(je.d)(this.props.contextString))&&this.props.featureControlProps.isInMobileModeForApril2020},t.prototype._showNewQuickFindSearchBarForMobile=function(){var e,t;return this._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot()&&this._isWidthLessThanViewportSm()&&((null===(e=this.props.configuration)||void 0===e?void 0:e.CustomControlId)===v.p||(null===(t=this.props.configuration)||void 0===t?void 0:t.Name)===v.m)},t.prototype._checkIfMobileImprovementsEnabledForQuickFindSearchOnGridRoot=function(){return this.props.featureControlProps.isQuickFindImprovementsEnabled&&this.props.featureControlProps.isInMobileModeForApril2020&&Object(je.e)(this.props.contextString)},t}(a.Component);function Xt(e,t){return a.createElement(qt,Object(n.__assign)({},e,{renderer:t.renderer}))}qt.displayName="DataSetHost",qt.contextType=Ct.a,Xt.contextTypes={renderer:o.object};var Wt=Object(s.a)(je.i,(function(e,t){return{initializeGrid:function(r,n,a,i){var o=rt.a.fromXmlAndSql("","",r).getQueryState(),s=t.descriptor&&t.descriptor.Parameters?t.descriptor.Parameters[v.r]:null,c=t.descriptor&&t.descriptor.Parameters&&t.descriptor.Parameters[v.s]?parseInt(t.descriptor.Parameters[v.s],10):null;a||(a=Object(oe.c)(t.id,i));var l=e(Object(ct.d)(o,n,t.id,i,t.descriptor,s,c,void 0,a)),u=e(Object(vt.b)(n,r,t.id)),d=e(Object(F.e)(P.labelList));return Promise.all([l,d,u])},removeEditedViewPageMap:function(t,r){return e(Object(xt.c)(t,r.guid))},updatePageInput:function(t,r){return e(Object(At.b)(t,r))},updateView:function(r,n,a,i,o,s,c,l,u){var d=e(Object(lt.a)(r,s,n,a,i)).then((function(){return e(Object(ht.a)(r,o))})),p=O.a.tryParseOrNull(a),h=e(Object(vt.b)(i,p,r)),g=Promise.resolve(null);if(u){var m=Object(et.a)(i,c,s,l,!0);g=e(m.getFilterOptionsAction())}return Promise.all([d,h,g]).then((function(){if(Object(je.e)(t.contextString)){t.updateGridPaginationStateHandler([{filterType:0,filterExpressionOrValue:null}],t.id)}e(Object(Se.m)("",r,s)),e(Object(Se.n)("",r,s)),e(Object(Se.j)("",r,s)),e(Object(it.b)("",0,r,s))}))},retrieveView:function(t,r,n,a,i){return e(Object(w.a)(t,r,n,a,!1))},markSelectedRows:function(t,r,n){return e(Object(Le.b)(t,r,n))},markSelectedRelatedEntity:function(t,r,n){return e(Object(Be.b)(t,r,n))},rowProperties:function(t,r,n){return e(Object(ut.b)(t,r,n))},updateFetchXml:function(t,r,n){return e(Object(dt.b)(t,r,n))},applyGridFilter:function(r,n,a){if(Object(je.e)(t.contextString)){var i=[{filterType:8,filterExpressionOrValue:r},{filterType:11,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Se.k)(n,t.id,a)),e(Object(Se.l)(r,t.id,a))},applyActivityTypeFilter:function(r,n,a){if(Object(je.e)(t.contextString)){var i=[{filterType:9,filterExpressionOrValue:r},{filterType:10,filterExpressionOrValue:n}];t.updateGridPaginationStateHandler(i,t.id)}e(Object(Se.h)(n,t.id,a)),e(Object(Se.i)(r,t.id,a))},onSelectedOrderColumnChange:function(r,n){e(Object(Se.o)(r,t.id,n))},toggleGridRollupView:function(r,n){e(Object(pt.b)(r,t.id,n))},updatePagingData:function(t,r,n){return e(Object(ot.b)(t,r,n))},updateQueryKey:function(t,r,n){e(Object(st.b)(t,r,n))},setCustomFilter:function(t,r,n,a){return e(Object(it.b)(t,r,n,a))},runOnRecordSelect:function(r,n,a){e(function(e,t,r,n,a){return{type:"dataset.run.on.record.select",sync:!0,execute:function(a,i){var o=a.dispatch,s=a.getState,c=i.TraceManager.getTracer(v.z),l=v.x+".RunOnRecordAction";try{if(i&&i.ScriptManager){var u=i.ScriptManager.getContainer(e);if(u&&n&&1===n.length){var d=Object(at.c)(s()),p=Object(at.b)(s());d&&(o(u.getEventManager().addGridOnRecordSelectHandlers(t)),o(u.getEventManager().addGridOnChangeHandlers(t))),(d||p)&&o(u.getEventManager().runOnRecordSelect(t,r)),c.info("Triggered the action for {0} selected records"+n.length),i.EventManager.ReportComponentSuccess(l)}}}catch(e){var h="Triggered action for selected records failed with error : "+e.message;i.EventManager.ReportComponentFailure(l,Error(h))}}}}(r,n,n.controlName?n.controlName:"entity_control",a,Object(je.e)(t.contextString)||Object(je.g)(t.contextString)))},retrieveRelatedEntitiesMetadata:function(t){return e(Object(Nt.a)(t))},switchHomepageConfiguration:function(t,r,n,a,i){e(Object(gt.g)(t,r,n,a,i))},switchViewConfiguration:function(t,r,n,a,i){e(Object(gt.i)(t,r,n,a,i))},switchSubgridVisualization:function(t,r,n){e(Object(gt.h)(t,r,n))},switchAssociatedGridVisualization:function(t,r,n,a,i,o,s,c){e(c?Object(gt.f)(t,r,n,a,i,o,s):Object(gt.e)(t,r,n,i,s))},toggleChartPane:function(t,r,n){e(Object(yt.b)(t,r,n))},clearQuery:function(){e(Object(Et.a)())},updateUserDefaultGridView:function(t,r,n,a,i,o){return e(function(e,t,r,n,a,i){return{type:"grid.update.userdefaultview",execute:function(o,s){var c=s.TraceManager.getTracer(v.z),l=v.x+".updateUserDefaultGridViewAction";try{c.info("Updating the user default view for the grid.");var u=o.getState(),d=new ft.a("usersettings",Object(Qe.q)(u)),p=Object(N.h)(u,e);if(!d||!p.ObjectTypeCode)return Promise.resolve();i&&(t="",r="",a=[],n="");for(var h=[],g=0,m=a;g<m.length;g++){var f=m[g],b=O.a.tryParse(f),y=O.a.externalGuid(b);h.push(y)}var _=String.format("<DefaultGridViews><DefaultGridView><EntityTypeCode>{0}</EntityTypeCode><ChildEntityName>{1}</ChildEntityName><QueueId>{2}</QueueId><ViewId>{3}</ViewId><ViewType>{4}</ViewType></DefaultGridView></DefaultGridViews>",p.ObjectTypeCode,n||"",1===h.length?h.toString():"",O.a.externalGuid(O.a.tryParse(t)),r);o.dispatch(Object(mt.f)(d,{personalizationsettings:_}));var S={ViewId:t,ViewType:+r,QueueId:a.toString()};return o.dispatch(Object(bt.f)(S,e)),s.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(e){var C="Failed to update user default grid view with error : "+e.message;s.EventManager.ReportComponentFailure(l,Error(C))}}}}(t,r,n,a,i,o))},updateCurrentPageNumber:function(t,r,n){return e(Object(Ae.b)(t,r,n))},setNewPageRequested:function(t,r,n){e(Object(Re.b)(t,r,n))},retrieveControlResourceStringsForSwitchVisualization:function(t){var r=t.filter((function(e){return null!=e}));return e(Object(F.e)(r))},updatePageNumberForEnhancedPaging:function(e){if(Object(je.e)(t.contextString)){var r=[{filterType:12,filterExpressionOrValue:e}];t.updateGridPaginationStateHandler(r,t.id)}},openManageDuplicatesDialog:function(t){e(Object(It.a)(null,null,ft.a.fromExternalEntityReference(t.entityReference))).then((function(r){if(0===r.status)return e(Object(jt.a)(r.pageId)).then((function(e){"ignore_save"===e.value.param_lastButtonClicked&&t.reject()}))}))},showInnerError:function(r){var n=new kt.a(r,null,null,null,null,{stack:r+" "+(new Error).stack,message:r});e(Object(Dt.a)(t.id,n))}}}))(Xt)},otMa:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"d",(function(){return d}));var n=r("rn9m"),a=r("Roat"),i=r("U56z"),o="customcontrol.propertybag.device.isoperationavailable";function s(){return{type:o,execute:function(e,t){return new n.a(t,e).isOperationAvailable(i.b.getBarcodeValue.name)},sync:!0}}function c(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.takePicture.name)},sync:!0}}function l(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureVideo.name)},sync:!0}}function u(){return{type:o,execute:function(e,t){return new a.a(t,e).isOperationAvailable(i.f.captureAudio.name)},sync:!0}}function d(){return{type:o,execute:function(){return!1},sync:!0}}},"pLx/":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("Z1aD"),a=r("45T4");function i(e,t){return Object(n.a)(a.a,{},t,e)}},r0tX:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;r.d(t,"a",(function(){return n})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(n||(n={}))},r3Bs:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n=function(){function e(e,t){this._traversedPath=e,this._stageId=t}return Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stageId",{get:function(){return this._stageId},set:function(e){this._stageId=e},enumerable:!1,configurable:!0}),e}(),a=r("3INI"),i=r("9r0m"),o=function(){function e(){}return Object.defineProperty(e.prototype,"globalPathAndActiveStage",{get:function(){return this._globalPathAndActiveStage},set:function(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntityIdsByEntityLogicalName",{get:function(){return this._navigationEntityIdsByEntityLogicalName},enumerable:!1,configurable:!0}),e.prototype.InitGlobalPathAndActiveStage=function(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)},e.prototype.UpdateGlobalPathAndActiveStage=function(e,t){this.globalPathAndActiveStage=new n(new a.a(e),t)},e.prototype._updateNavigationDictionary=function(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(var t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}},e}()},r7Ib:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("Sscr"),a=r("uO/V"),i="grid.setCommandManagerId";function o(e,t,r){return{type:"grid.setCommandManagerId.async",execute:function(o,s){var c=o.dispatch,l=(o.getState,s.TraceManager.getTracer(a.z)),u=a.x+".setCommandManagerIdAction";try{l.info("Updating the command manager id for the grid.");var d=Object(n.v)(r);return c(function(e,t,r){return{type:i,payload:t,meta:{pageId:e,dataSetContextKey:r}}}(e,t,d)),s.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){var p="Updating the command manager id for the grid failed with error : "+e.message;s.EventManager.ReportComponentFailure(u,Error(p))}}}}},rbxJ:function(e,t,r){"use strict";r.d(t,"i",(function(){return pe})),r.d(t,"g",(function(){return ne})),r.d(t,"e",(function(){return ae})),r.d(t,"d",(function(){return ie})),r.d(t,"f",(function(){return ge})),r.d(t,"h",(function(){return me})),r.d(t,"c",(function(){return se})),r.d(t,"a",(function(){return de})),r.d(t,"b",(function(){return ue}));var n=r("c/eZ"),a=r("9r0m"),i=r("swEE"),o=r("NxDw"),s=r("G7N+"),c=r("S2mk"),l=r("UOiB"),u=r("Fas2"),d=r("r2h9"),p=r("lMVv"),h=r("7EJx"),g=r("EGsq"),m=r("Ww2r"),f=r("RlP9"),b=r("z9yS"),v=r("uO/V"),y=r("Gemh"),_=r("Sscr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function O(){var e=null,t=null,r=null;return function(n,a){var i=a.parentContextToken,o=a.contextString,s=function(e,t){var r=t.parentContextToken;switch(t.contextString){case v.h.ASSOCIATEDGRID:var n=Object(y.gb)(e,t,r);return _.a(r,n.relationshipName,n.ordinal);case v.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(r,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);var a=_.p(r,t.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=se(e,t,i,a),a;case v.h.GRID:return _.k(e,t.id);case v.h.CUSTOM:return _.c(r,t.controlId);default:return r}}(n,a);return(r!==o||S(e,s)||S(t,i))&&(e=s,t=i,r=o),e}}function S(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var C=r("jf1O"),I=r("perk"),j=r("/3Li"),P=r("0u+G"),T=r("wV3W"),E=r("DgF7"),w=r("Wg6j"),F=r("WS0f"),x=r("VWqI"),A=r("Ev4I"),N=r("JlqV"),D=r("cZkS"),k=r("qC0c"),M=r("c0jI"),R=r("jigW"),L=r("sOTk"),B=r("7pqb"),V=r("s2by"),G=r("VnpK"),U=r("CIm2"),z=r("+6eZ"),q=r("3/zo"),X=r("oVzJ"),W=r("2OIc"),H=r("/V8d"),Q=r("M6d0"),Y=r("Oiu5"),K=r("/U1C"),J=r("W51q"),Z=r("c56u"),$=r("F2uj"),ee=r("HF9s"),te=r("c96h"),re=r("TCzx");function ne(e){return e===v.h.SUBGRID}function ae(e){return e===v.h.GRID}function ie(e){return e===v.h.ASSOCIATEDGRID}function oe(e){switch(e){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return"div";case v.h.GRID:default:return"section"}}function se(e,t,r,n){var a=r?Object(p.G)(e,r,n.relationshipName):null;if(null===a&&t.descriptor&&t.descriptor.Parameters){var i=t.descriptor.Parameters[v.F.RELATIONSHIP_NAME],o=t.descriptor.Parameters[v.F.TARGET_ENTITY_TYPE];i&&r?a=Object(p.G)(e,r,i):i&&o&&(a=Object(p.G)(e,o,i))}return a}function ce(){var e=null,t=null;return function(r){return e!==r.contextString&&(e=r.contextString,t=function(e){switch(e.contextString){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return[d.a.SUB_GRID,d.a.MAIN_APPLICATION_VIEW];case v.h.GRID:return e.isAdvancedFindView?[d.a.ADVANCED_SEARCH]:[d.a.MAIN_APPLICATION_VIEW];default:return[d.a.MAIN_APPLICATION_VIEW]}}(r)),t}}function le(e){return e&&[e.CustomControlId,e.Name].some((function(e){return-1!==H.a.indexOf(e)}))}function ue(e,t,r){if(!e||!e.contextTokenType||e.contextTokenType!==l.a.AssociatedGrid&&e.contextTokenType!==l.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return le(r);case"displayQuickFind":case"displayViewSelector":return!0}return null}function de(){var e=null,t=null;return function(r,n,a){if(e&&t===n.CustomControlId)return e;var i=n&&n.CustomControlId?n.CustomControlId:null;if(!i)return null;var o=Object(y.ab)(r,i),s=Object(W.e)(r,i);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){var c=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:c.hasOwnProperty("displayChart")?c.displayChart:ue(a,"displayChart",n),displayCommandBar:c.hasOwnProperty("displayCommandBar")?c.displayCommandBar:ue(a,"displayCommandBar",n),displayIndex:c.hasOwnProperty("displayIndex")?c.displayIndex:ue(a,"displayIndex",n),displayQuickFind:c.hasOwnProperty("displayQuickFind")?c.displayQuickFind:ue(a,"displayQuickFind",n),displayViewSelector:c.hasOwnProperty("displayViewSelector")?c.displayViewSelector:ue(a,"displayViewSelector",n)},t=n.CustomControlId}return e}}function pe(){var e,t,r,l,_,S,G,W,H,ue,de,pe,ge,ve,ye,_e,Oe,Se,Ce,Ie,je,Pe,Te,Ee,we,Fe,xe,Ae,Ne,De,ke,Me,Re,Le,Be,Ve,Ge=null,Ue=null,ze=null,qe=null,Xe="",We=null,He=null,Qe=null,Ye=null,Ke=null,Je=null,Ze=null,$e=null,et=(t=null,function(e,r,n,a){var i=t;switch(Object(F.b)(a)&&(a=r.contextString),a){case v.h.ASSOCIATEDGRID:i=Object(u.b)(n);break;case v.h.SUBGRID:i=Object(u.l)(n);break;case v.h.GRID:default:i=Object(u.h)(n)}return i!==t&&(t=i),t}),tt=Object(C.a)(),rt=O(),nt=(r=null,_=null,l=function(e,t,r){var n,i,s,l,u;if(Object(y.ib)(e,t.id,r)){n=Object(y.T)(e,t.id,r);var d=Object(y.qb)(e,n,t.id);i=d&&d.entityLogicalName,u=d&&d.isUserView,s=Object(y.r)(e,t.id,r,i),l=Object(y.s)(e,t.id,r)!==b.a.savedvisualization}else{var p=Object(y.ab)(e,t.configuration.CustomControlId);if(p){var h=t.configuration.Parameters[p];h&&(n=h.ViewId&&new a.a(h.ViewId),i=h.TargetEntityType,s=h.VisualizationId&&new a.a(h.VisualizationId),l=!(!h.IsUserChart||"true"!==h.IsUserChart),u=!(!h.IsUserView||"true"!==h.IsUserView))}}if(!a.a.isNullOrEmpty(n)&&s&&i){var g=Object(y.q)(e,t.id,r),m=Object(y.p)(e,t.id,r),f=Object(y.C)(e,t.id,r),O=he(e,t,r,f,!0),S=Object(y.N)(e,t.id,r),C=e.user&&e.user.userId,I=Object(k.c)(e,D.Zc),j=Object(V.a)(i,C,r,I),P=j&&j.getFilterAndLinkedEntities(f&&f.activityOrQueueFilterValue?f.activityOrQueueFilterValue:void 0),T=P&&null!==P.linkEntities?JSON.stringify(P.linkEntities):null,w=Object(k.a)(e,D.Od,D.h),F=!w||w&&Object(E.a)(e)===o.a.MobileApplication,x=w,A=ie(t.contextString)?Object(c.p)(v.d,i,a.a.toString(n),a.a.toString(s),r.relationshipName,S,l,u,O,T,x):Object(c.t)(v.d,i,a.a.toString(n),a.a.toString(s),S,g,l,m,u,O,T,F,x);if(_){var N=A&&A.CustomControlId?A.CustomControlId:null;if((L=Object(y.ab)(e,N))&&A.Parameters[L]){var M=A.Parameters[L],R=_.Parameters[L];M.ViewId===R.ViewId&&M.VisualizationId===R.VisualizationId&&M.EntityName===R.EntityName&&M.HighchartFilterExpression===R.HighchartFilterExpression&&M.ChartDrillDownParameters===R.ChartDrillDownParameters&&M.ExtraFilters===R.ExtraFilters||(_=A)}}else _=A}else if(_&&i&&!s){var L;N=_.CustomControlId,(L=Object(y.ab)(e,N))&&_.Parameters[L]&&i!==(R=_.Parameters[L]).EntityName&&(_=null)}return _},function(e,t,n){var a=l(e,t,n),i=t.id;return r&&r.configuration===a&&r.id===i||(r={configuration:a,id:i,chartId:v.d,showChart:!0,contextToken:n}),r}),at=(S=null,function(e,t,r,n,a,i){var o=i.commandBarStyle,s=t.id,c=se(e,t,r&&r.parentContextToken?r.parentContextToken.entityTypeName:null,r),l=Object(y.w)(e,s,r);return S&&S.commandManagerId===l&&S.pageId===s&&S.ribbonId===a&&S.relationshipType===c&&S.contextToken===r&&S.style===o||(S={commandManagerId:l,pageId:s,ribbonId:a,relationshipType:c,contextToken:r,style:o}),S}),it=(G=null,W=ce(),function(e,t,r,n,i,o){var s,c=o.viewSelectorStyle,l=a.a.toString(i),u=W(t),p=Object(y.nb)(t.id,l),g=ae(t.contextString),m=g,b=t.contextString,v=Object(y.Z)(e),_=Object(h.g)(e),O=Object(y.qb)(e,i,t.id),S=O?O.title:null,C=d.a.MAIN_APPLICATION_VIEW;ne(b)?C=d.a.SUB_GRID:g&&t.isAdvancedFindView&&(C=d.a.ADVANCED_SEARCH);var I=Object(f.a)(e,n,C),j=I||a.a.EMPTY,P=Object(L.g)(e,null==t?void 0:t.id),T=Object(y.rb)(e,null===(s=null==P?void 0:P.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==i?void 0:i.guid);return G&&G.id===p&&G.entityTypeName===n&&G.selectedViewId===l&&G.queryViewSelectorTypes===u&&G.shouldDisplayNestedViewSelector===m&&G.isRTL===_&&G.defaultViewId===j&&G.isEdited===!!T||(G={id:p,pageId:t.id,title:S,entityTypeName:n,selectedViewId:l,style:c,queryViewSelectorTypes:u,shouldDisplayNestedViewSelector:m,contextString:b,pinnedActivityView:v,isRTL:_,defaultViewId:j,isAdvancedFindView:t.isQueryMode&&t.isAdvancedFindView,isEdited:!!T,pageToEditedViewMapId:null==P?void 0:P.pageToEditedViewMapId}),G}),ot=(H=null,function(e,t,r,n,a){var i=t.id,o=Object(y.G)(e,t),s=Object(h.w)(e),c=a.filterComboStyle,l=Object(L.g)(e,i).entityFilterValue;return H&&H.id===i&&H.entityTypeName===n&&H.filterOptions===o&&H.comboBoxStyle===c&&H.userSetting===s&&l===H.previousValue||(H={id:i,filterOptions:o,entityTypeName:n,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:s,style:null,comboBoxStyle:c,previousValue:l}),H}),st=(ue=null,function(e,t,r,a,i){var o=t.id,s=Object(y.G)(e,t,a),c=Object(Y.a)(e),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,d=i.activityTypeComboBoxStyles,p=Object(R.h)(e,r.relationshipName,ie(t.contextString)),g=!Object(N.b)(e),m=Object(y.kb)(e,o,r),f=Object(h.g)(e),b=Object(T.a)(e),v=Object(L.g)(e,o),_=v.entityFilterValue,O=v.activityTypeFilterValue,S=Object(k.a)(e,D.a,D.h),C=Object(k.a)(e,D.a,D.Lc),j=Object(y.ub)(e,a),P=Object(k.c)(e,D.Zc),E=Object(V.a)(a,e.user.userId,r,P,j),w=E&&E.getFilterLabelResourceKey(),F=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,x=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!ue||ue.id!==o||ue.entityTypeName!==a||ue.filterOptions!==s||ue.comboBoxStyle!==l||ue.dueDatecomboBoxStyle!==u||ue.activityTypecomboBoxStyle!==d||ue.labelStyle!==i.filterLabelStyle||ue.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||ue.isActivityManagementFeatureEnabled!==S||ue.filterOptionsForActivityType!==c||ue.isRollupViewSupported!==p||ue.isOffline!==g||ue.toggleValue!==m||ue.isRTL!==f||ue.theme!==b||ue.previousValue!==_||ue.activityTypePreviousValues!==O||ue.isActivityFilterSelectAllEnabled!==C||ue.entityIsActivityType!==j){var A={isRollupViewSupported:p,isOffline:g,toggleValue:m,onToggleChange:null,isRTL:f,theme:b};ue=Object(n.__assign)({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:O,isActivityManagementFeatureEnabled:S,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:w,activityTypeFilterLabelResourceString:F,dueDateFilterLabelResourceString:x,isActivityFilterSelectAllEnabled:C,isRTL:f,entityIsActivityType:j},A)}return ue}),ct=(de=null,pe=[1041,2052,3076,1028,1042],function(e,t,r,n,a,i){var o=e.id,s=e.descriptor&&e.descriptor.Id?e.descriptor.Id:null,c=a?JSON.parse(a).conditions[0]:null,l=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){var r=me(e.split(",")[0]),n=r[1].split("|");if(n&&t===n[0])return r[1]}return t}(Object(m.c)(i,I.JUMPBAR_ALPHABET),c);return pe.indexOf(n)>-1?de=null:de&&de.id===o&&de.contextToken===t&&de.entityTypeName===r&&de.selectedFilter===l||(de={id:o,uniqueId:s,contextToken:t,entityTypeName:r,selectedFilter:l,languageId:n}),de}),lt=(ge=null,function(e,t,r,n){var a=e.id,i=e.contextString;return ge&&ge.id===a&&ge.contextToken===t&&ge.entityTypeName===r&&ge.gridInput===n||(ge={id:a,contextToken:t,entityTypeName:r,contextString:i,gridInput:n}),ge}),ut=(ve=null,function(e,t,r){var n=e.id,a=e.contextString;return ve&&ve.id===n&&ve.contextToken===t||(ve={id:n,contextToken:t,contextString:a}),ve}),dt=Object(m.h)(),pt=(Oe=null,Se=null,je=null,De={useSkypeProtocol:Ce={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},gridPageNumber:Ie={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},isNewPageRequested:Pe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},enhancedPagingDisabled:Te={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},isActivityTypeFilterDisabled:Ee={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},showAddNewCommand:we={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptySubgridIconAndTextChanges:Fe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptyGridChangesIfQuickFindImprovementsEnabled:xe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},headerDialogOnTop:Ae={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},headerDialogPreventDismissOnScroll:Ne={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1}},function(e,t,r){var a=Object(E.e)(e),s=Object(g.x)(e).useSkypeProtocol,c=Object(y.x)(e,t.id,r),l=Object(y.X)(e,t.id,r);l||je===c||(je=c),ye||(ye=Object(j.a)(e),_e=null!=ye&&ye===P.b.Native);var u=!_e,d=Object(k.a)(e,D.a,D.h),p=t.systemDefinedProperties,h=c!==je&&l,m=u!==Te.Value,f=!1;d&&(ie(t.contextString)||ae(t.contextString))&&(f=!0);var b=!1;Object(X.a)(e)&&ne(t.contextString)&&(b=!0);var v=!1;Object(X.a)(e)&&Object(k.c)(e,D.Md)&&ne(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication&&(v=!0);var _=!1;if(Object(X.a)(e)&&Object(k.c)(e,D.ad)&&ae(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication){var O=Object(y.C)(e,t.id,r);(null==O?void 0:O.quickFind)&&(_=!0)}var S=!ae(t.contextString)&&i.a.Tablet===a,C=i.a.Tablet===a&&!ie(t.contextString)||"Web"===Object(E.k)(e)&&!re.a.getInstance().get_IsAndroid()&&!re.a.getInstance().get_IsWindows()&&!re.a.getInstance().get_isIPhone();if(a!==Oe||s!==Se||h||m||l!==Pe.Value||f!==Ee.Value||b!==we.Value||v!==Fe.Value||_!==xe.Value||S!==Ae.Value||C!==Ne.Value){Oe=a,Se=s,Ie.Value=c,je=c,Pe.Value=l,Te.Value=u,Ee.Value=f,we.Value=b,Fe.Value=v,xe.Value=_,Ae.Value=S,Ne.Value=C;var I=null==Oe?s:null;(I!==Ce.Value||h||m)&&(Ce.Value=I,De=Object(n.__assign)(Object(n.__assign)({},p),{useSkypeProtocol:Ce,gridPageNumber:Ie,isNewPageRequested:Pe,enhancedPagingDisabled:Te,isActivityTypeFilterDisabled:Ee,showAddNewCommand:we,emptySubgridIconAndTextChanges:Fe,emptyGridChangesIfQuickFindImprovementsEnabled:xe,headerDialogOnTop:Ae,headerDialogPreventDismissOnScroll:Ne}))}return De}),ht=(ke=null,Me=null,function(e,t,r){return e&&(Me&&ke===e&&!r||(Me=Object(n.__assign)({},e),e.Parameters&&(Me.Parameters=Object(n.__assign)({},e.Parameters),t&&e.Parameters[t]&&(Me.Parameters[t]=Object(n.__assign)({},e.Parameters[t]),e.Parameters[t].Columns&&(Me.Parameters[t].Columns=e.Parameters[t].Columns.slice(0)))),ke=e)),Me}),gt=Object(w.s)(),mt=(Re=[],function(e,t,r,n,a,i,o,s,c,l,u){return Re&&Re.length&&Re.splice(0,Re.length),Re.push({name:B.b.IsGridRoot,value:e},{name:B.b.IsSubGrid,value:t},{name:B.b.IsAssociatedGrid,value:r},{name:B.b.EntityName,value:n},{name:B.b.ViewId,value:a},{name:B.b.IsEmptyFetch,value:i},{name:B.b.IsEmptyOfflineSqlQuery,value:o},{name:B.b.IsValidFetchXmlForOfflineUsage,value:s},{name:B.b.IsEntityAvailableForOfflineUsage,value:c},{name:B.b.OfflineConfigurationErrorCode,value:l},{name:B.b.RelatedEntityUnavailableOffline,value:u}),Re}),ft=(Le=null,function(e){return Le||(Le={isGridPaginationStateFeatureEnabled:Object(k.a)(e,D.zb),isAssociatedGridHeightEnabled:Object(R.e)(e),isChartOnAssociatedGridEnabled:Object(k.a)(e,D.x,D.h,D.i),isGridProgressIndicatorFeatureEnabled:Object(k.a)(e,D.Ab),isInMobileModeForOct2019:Object(X.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(k.a)(e,D.ac),isJumpbarFeatureForMobileEnabled:Object(k.c)(e,D.Kb),isSuiterChartEnabled:Object(k.a)(e,D.Od,D.h),isSuiterDashboardEnabled:Object(k.a)(e,D.Pd,D.h),isAdvancedFindEnabled:Object(J.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(k.c)(e,D.O),isInMobileModeForApril2020:Object(X.a)(e),isSubgridImprovementsEnabled:Object(k.c)(e,D.Md),isSubGridAutoCollapseEnabled:Object(k.a)(e,D.Jd,D.Lc),isSubGridRemoveMinHeightEnabled:Object(k.a)(e,D.Ld,D.Lc),isQuickFindImprovementsEnabled:Object(k.c)(e,D.ad),isShowAsButtonFirstEnabled:Object(k.c)(e,D.Bd),isColumnEditorButtonEnabled:Object(y.tb)(e),isQueueFilterPerfUCIEnabled:Object(k.c)(e,D.Zc)}),Le}),bt=(Be={fetchXML:null,entityName:null,isOffline:null},Ve={error:!1,errorCode:null,relatedEntityUnavailableOffline:null},function(e,t,r,n){if(Be.entityName!==r||Be.fetchXML!==t||Be.isOffline!==n)if(Object(A.k)(r)){var a=Object(A.b)(e,t);Ve={error:a.error,errorCode:a.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:a.relatedEntityUnavailableOffline},Be={fetchXML:t,entityName:r,isOffline:n}}else Ve={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},Be={fetchXML:t,entityName:r,isOffline:n};return Ve});return function(t,r){var i,o=Object(h.w)(t),c=rt(t,r),l=Object(y.v)(t,r.id,c),u=c.relationshipName,b=c.roleOrd,_=Object(y.N)(t,r.id,c),O=Object(y.I)(t,r.id,c),S=Object(y.x)(t,r.id,c),C=r.descriptor,w=be.bind(null,r,C),B=r.configuration,G=B&&B.CustomControlId?B.CustomControlId:null,X=Object(j.a)(t),W=Object(E.e)(t),H=Object(y.ab)(t,G)||(r.contextString===v.h.CUSTOM?v.g:null),Y=ae(r.contextString),J=ft(t),re=Object(y.A)(t,c,r),se=null,ce=!1,ue=null,de=Object(y.t)(t,r.id,c),pe=Object(y.C)(t,r.id,c);Y&&(se=Object(L.g)(t,r.id),J.isGridPaginationStateFeatureEnabled&&((ue=se.gridSortingInfo)&&(Object(F.a)(Ye)||Ye!==ue)&&(Ye=ue,ce=!0),de&&(Object(F.a)(Ke)||Ke!==de.customFilterXml)&&(Ke=de.customFilterXml,ce=!0)),(pe&&Object(F.a)(Je)||Je!==pe)&&(Je=pe,ce=!0));var ge=ht(B,H,ce),me=ge&&ge.Parameters?ge.Parameters[H]:null,ve=ie(r.contextString),ye=ne(r.contextString),_e=!Object(N.b)(t),Oe=Object(y.jb)(t,c,r),Se=me&&!!me.DataProvider,Ce=me&&!!me.BoundViewParams,Ie=Object(g.x)(t),je=Ie&&Ie.gridTotalRecordCountLimit?Ie.gridTotalRecordCountLimit:5e3,Pe=Object(y.ib)(t,r.id,c),Te=le(r.configuration),Ee=le(r.configuration);if(null!=r.nonCompositionProps){var we=B&&B.FormFactor&&B.FormFactor.toString(),Fe=Object(M.c)(r.nonCompositionProps.gridConfigurations,r.nonCompositionProps.viewConfigurations,B,null,v.h.GRID,we).map((function(e){return e.configuration.DisplayNameKey})),xe=dt(t,Fe);(!Qe&&""!==Object(m.c)(xe,Fe[0])||Qe!==xe)&&(Qe=xe)}var Ae=!!l,Ne=Object(y.T)(t,r.id,c)||(C&&C.Parameters&&C.Parameters.ViewId?a.a.parse(C.Parameters.ViewId):null),De=Object(y.qb)(t,Ne,r.id),ke=(null==De?void 0:De.isUserView)?d.b.userview:d.b.savedview,Me=null==De?void 0:De.queryType,Re=null==De?void 0:De.entityLogicalName;Re&&Re!==ze&&(ze=Re);var Le=Object(p.h)(t,ze),Be=!_e&&X===P.b.Web&&Y&&J.isAdvancedFindEnabled&&(null==Le?void 0:Le.IsValidForAdvancedFind);if(!He||e!==Be){var Ve=Object(n.__spreadArrays)(I.labelList);Be&&(Ve=Object(n.__spreadArrays)(Ve,[K.c.OpenAdvancedFiltersTitleAndAria]));var vt=dt(t,Ve);""!==Object(m.c)(vt,I.JUMPBAR_ALL_TITLE)?(He=vt,e=Be):Ae=!1}var yt=Object(y.W)(t,G);yt&&yt!==We&&(We=yt);var _t=tt(t,r);le(r.configuration)&&(Object.assign(_t.bodyStyle,{flexDirection:"column"}),Object.assign(_t.bodyMobileStyle,{flexDirection:"column"}));var Ot=Object(y.F)(t,r.id,c)||(C&&C.Parameters&&C.Parameters[v.u]?C.Parameters[v.u]:null),St=Ot;Y&&(St=se.entityTypeName);var Ct=Object(x.b)(t,Ot);Le&&Le.Initialized===s.a.Initialized||Se||Ce||(Ae=!1);var It=Le?Le.DisplayName:"",jt=Object(g.t)(t),Pt=Object(p.i)(t,Ot),Tt=!(De&&De.fetchXML),Et=De&&De.viewId,wt=bt(t,Tt?"":De.fetchXML,ze,_e),Ft=!Tt&&!wt.error,xt=null!=De&&Object(F.b)(De.offlineSqlQuery),At=Object(A.l)(t,ze),Nt=mt(Y,ye,ve,ze,Et?Et.guid:null,Tt,xt,Ft,At,wt.error&&wt.errorCode||"",wt.error&&wt.relatedEntityUnavailableOffline||""),Dt=!((Y||ve||ye)&&De&&De.fetchXML&&_e&&At)||!xt&&Ft,kt="";if(Dt?At||(kt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):xt?kt=I.SQL_QUERY_NOT_AVAILABLE:wt.error&&(kt=wt.errorCode),me){me.TargetEntityType&&Ot!==me.TargetEntityType&&(Ot=me.TargetEntityType),me.ExtraFilters=he(t,r,c,pe,!1);var Mt=function(e,t,r,n,a){var i=[],o=Object(y.q)(e,t.id,r);if(o){var s=JSON.parse(o);if(s.conditions)for(var c=0,l=s.conditions;c<l.length;c++){var u=l[c];u.linkEntityExpressions&&(i=i.concat(u.linkEntityExpressions))}}var d=e.user&&e.user.userId,p=Object(k.c)(e,D.Zc),h=Object(y.ub)(e,n),g=Object(V.a)(n,d,r,p,h),m=g&&g.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:U.a,a&&!a.activityOrQueue);m&&m.linkEntities&&(i=i.concat(m.linkEntities));return(m=m||{filter:null,linkEntities:null}).linkEntities=i,m}(t,r,c,Ot,pe);if(Mt&&Mt.filter&&(me.ExtraFilters?me.ExtraFilters.push(JSON.stringify(Mt.filter)):me.ExtraFilters=[JSON.stringify(Mt.filter)]),Mt&&Mt.linkEntities&&Mt.linkEntities.length>0){var Rt={Static:!0,Value:Object(z.b)(Mt.linkEntities)};if(me.LinkingInput){Rt=me.LinkingInput;var Lt=Object(z.a)(me.LinkingInput.Value);if(Lt){var Bt=new q.a;Lt.forEach((function(e){Bt.addLinkedEntity(e)})),Mt.linkEntities.forEach((function(e){Bt.addLinkedEntity(e)})),Rt.Value=Object(z.b)(Bt.getLinkedEntities())}}me.LinkingInput=Rt}if(Ne){var Vt=a.a.toString(Ne);Vt!==me.ViewId&&(me.ViewId=Vt)}else Ne=a.a.tryParseOrNull(me.ViewId);(C&&C.Parameters?"false"===C.Parameters[v.F.ENABLE_CONTEXTUALACTIONS]:null)&&(ge.Parameters[v.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}Ot&&Ot!==qe&&(qe=Ot);var Gt=Object(p.r)(t,Ot)&&r.contextString===v.h.GRID?y.a:Ot,Ut=me&&me.CommandBarContext,zt=et(t,r,Gt,Ut),qt=function(e,t,r){var n=Object(y.qb)(e,t,r);return n&&n.grid&&n.grid.rows&&n.grid.rows[0]&&n.grid.rows[0].cells}(t,Ne,r.id),Xt=null==qt?void 0:qt.map((function(e){return e.name})),Wt=null==Ue?void 0:Ue.map((function(e){return e.name}));(JSON.stringify(Xt)!==JSON.stringify(Wt)||(Ne&&Ne.guid)!==(Ge&&Ge.guid)||u===Ze&&b!==$e)&&(Ge=Ne,$e=b,Xe=(C&&C.Id?C.Id:"")+(new Date).getTime(),Ue=qt),u&&u!==Ze&&(Ze=u);var Ht=Object(y.o)(t,Ot),Qt=Ht?Ht.lookupAttribute:null;me&&(function(e,t,r,n,a,i,o){var s=Object(p.h)(e,n);if(s&&le(t.configuration)){var c=v.b;r.Columns||(r.Columns=[]),n!==y.a||a&&a.some((function(e){return e.name===c}))||r.Columns.find((function(e){return e.Name===c}))||r.Columns.push({Alias:c,DataType:"",Type:"",Name:c});var l=s&&s.PrimaryNameAttribute,u=a&&a.some((function(e){return e.name===l}));if(!l||u||r.Columns.some((function(e){return e.Name===l}))||r.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(t.configuration.Parameters)){var d=Object(R.a)(s.PrimaryImageAttribute);d&&!r.Columns.find((function(e){return e.Name===d}))&&r.Columns.push({Alias:Q.d,DataType:"SingleLine.Text",Type:"",Name:d}),Object(k.a)(e,D.ub)&&i&&o&&(r.Columns.find((function(e){return e.Name===y.c}))||r.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),r.Columns.find((function(e){return e.Name===i}))||r.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(t,r,me,Ot,Ue,Qt,!Object(F.a)(se)),function(e,t,r,n,a){if(!Object(y.vb)(t.configuration.Parameters))return;(null==a?void 0:a.some((function(t){var r;return(null===(r=Object($.a)(e,n,t.name))||void 0===r?void 0:r.Type)===ee.a.moneyType})))&&(r.Columns.some((function(e){return e.Alias===v.A}))||r.Columns.push({Alias:v.A,DataType:"Lookup.Simple",Type:"",Name:Q.w}))}(t,r,me,Ot,Ue));var Yt=!Ot||(Object(x.i)(Ot)||Object(x.g)(t,Ot,2,0)&&function(e,t){var r=!0;t&&t.forEach((function(t){if(t.relatedEntityName&&!(r=Object(x.g)(e,t.relatedEntityName,2,0)))return!1}));return r}(t,Ue)),Kt=Object(y.Y)(t,r.id,c),Jt=Kt?JSON.parse(Kt):null,Zt=Jt?Jt.totalResultCount:null,$t=Jt?Jt.pageSize:null,er=null!==Zt&&Zt>-1?0===Zt?Object(m.c)(He,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Zt):"",tr=gt(t,Y),rr=!(null!=X&&X===P.b.Native),nr=Object(y.rb)(t,null===(i=null==se?void 0:se.pageToEditedViewMapId)||void 0===i?void 0:i.guid,null==Ne?void 0:Ne.guid),ar={isEmptyOfflineSqlQuery:xt,isEntityAvailableForOffline:At,isOfflineSqlQueryAvailable:Dt,offlineErrorMessageKey:kt,isOfflineAvailableForUse:Object(Z.w)(t),offlineGridErrorTelemetryParams:Nt},ir=Object(te.d)(t),or=Object(f.c)(t,Ge),sr=!_e&&X===P.b.Web&&Y&&J.isColumnEditorButtonEnabled&&!ve&&!ye,cr=Object(y.ub)(t,Ot);return{showAdvancedFilter:Be,isViewEdited:!!nr,isInitialized:Ae,viewId:Ge,customFilter:de,gridEntityTypeName:ze,chartEntityTypeName:ze,isUCIEntity:Ct,totalRecordCountLimitExceeded:Oe,chartProps:Pe?nt(t,r,c):null,viewDescriptor:De,commandBarProps:w(v.E.COMMANDBAR_ENABLED,!0,v.F.ENABLE_CONTEXTUALACTIONS,H,!0)?at(t,r,c,C,zt,_t):null,viewSelectorProps:St&&w(v.E.VIEWSELECTOR_ENABLED,!0,v.F.ENABLE_VIEW_PICKER,H)?it(t,r,c,St,Ge,_t):null,queueFilterProps:B&&w(null,!0,v.F.ENABLE_QUEUEFILTER,H)?ot(t,r,c,Ot,_t):null,entityFilterProps:_e||!cr&&!Object(R.h)(t,Ze,ve)?null:st(t,r,c,Ot,_t),jumpBarProps:w(v.E.JUMPBAR_ENABLED,Te,v.F.ENABLE_JUMPBAR,H)&&fe(r)?ct(r,c,Ot,o.languageId,pe?pe.jumpBar:null,He):null,quickFindProps:w(v.E.QUICKFIND_ENABLED,!0,v.F.ENABLE_QUICKFIND,H)?lt(r,c,Ot,se):null,pagingProps:w(v.E.PAGING_ENABLED,Ee,null,H)?ut(r,c,Ot):null,contextToken:c,controlKey:Xe,styles:_t,refreshCounter:_,pagingRefreshInput:O,pageNumber:S,ribbonId:zt,semanticTag:oe(r.contextString),recordsPerPageSetting:Object(h.h)(t),userSetting:o,hasReadRolePrivilege:Yt,resourceStrings:He,switchVisualizationResourceStrings:Qe,entityTypeName:qe,primaryDataSetName:H,nestedGridDatasetName:We,viewportSm:Object(T.a)(t).sizes.Breakpoints.DimensionS,viewportM:Object(T.a)(t).sizes.Breakpoints.DimensionM,systemDefinedProperties:pt(t,r,c),platformType:Object(j.a)(t),isGridEditable:Object(y.vb)(B?B.Parameters:null),notificationMessage:er,totalResultCount:Zt,pageSize:$t,offlineProps:ar,isRTL:Object(h.g)(t),entityDisplayName:It,isOffline:_e,showChart:Pe,entityIconVectorName:Pt,webResourceUrl:jt,hasCustomDataProvider:Se,commandBarRefreshProps:tr,updatedConfiguration:ge,offlineGridErrorTelemetryParams:Nt,gridInput:se,gridTotalRecordsCountLimit:je,gridSortingInfo:ue,nativeFilterExpression:J.isGridPaginationStateFeatureEnabled&&se?se.nativeFilterExpression:null,pageNumberForEnhancedPaging:J.isGridPaginationStateFeatureEnabled&&!rr&&se?se.gridPageNumber:null,userId:t.user&&t.user.userId||null,lookupAttributeForRecordHierarchy:Qt,fetchXML:re,viewType:ke,savedQueryType:Me,featureControlProps:J,clientHostSubtype:W,backButtonEnabled:ir,originalView:or,showColumnEditor:sr,entityIsActivityType:cr}}}function he(e,t,r,n,a){if(!n)return[];var i=ae(t.contextString),o=ie(t.contextString),s=ne(t.contextString)&&Object(k.c)(e,D.bd),c=[];for(var l in n)c.push([l,n[l]]);var u=c.reduce((function(e,t){var r=t[0],n=t[1];return(i||o||s)&&"quickFind"===r||("activityOrQueueFilterValue"===r||"activityTypeSelectedValues"===r)||!n||e.push(n),e}),[]);if(a){var d=Object(y.t)(e,t.id,r);if(d&&d.customFilterXml){var p=Object(G.i)(d.customFilterXml),h=JSON.stringify(p);h&&u.push(h)}}else{var g=Object(y.q)(e,t.id,r);g&&u.push(g)}return u}function ge(e){var t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function me(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));var t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function fe(e){var t,r,n;return"no"!==(null===(n=null===(r=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===r?void 0:r.EnableJumpBar)||void 0===n?void 0:n.Value)}function be(e,t,r,n,a,i,o){var s=e.dataSetUIOptions,c=n;if(o=!!Object(F.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){var l=e.configuration.Parameters[i];l&&l[v.f]&&(s=l[v.f])}var u=t&&t.Parameters&&t.Parameters[a]?"true"===t.Parameters[a]:o;return s&&r&&!Object(F.a)(s[r])&&(c=s[r]),c&&u}},slAZ:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"e",(function(){return l}));var n=r("Sscr"),a="controls.addCustomFilter",i="controls.startCustomFilter",o="controls.endCustomFilter";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(e,t,r,i,o){var s=Object(n.v)(i);return{type:a,payload:{customFilter:o,entityLogicalName:r},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,r){var a=Object(n.v)(r);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}function l(e,t,r){var a=Object(n.v)(r);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}},u3BH:function(e,t,r){"use strict";r.d(t,"a",(function(){return E}));var n=r("sOTk"),a=r("uOa9"),i=r("Sscr"),o=r("QAhb"),s=r("HSdq"),c=r("qC0c"),l=r("cZkS"),u=r("EGsq"),d=r("aPRd"),p=r("wV3W"),h=r("yHpA"),g=r("9rlF"),m=r("9r0m"),f=r("TV33"),b=r("H9Ho"),v=r("uQP8"),y=r("OTOS"),_=r("T2Xs"),O=r("7pqb"),S=function(){function e(e){this.previousReturn={EnableInMobile:!1,PowerBIGroupId:"",PowerBIDashboardId:"",PowerBIReportId:"",PowerBIFilter:"",TileId:"",TileUrl:"",PowerBIType:0,IsPowerBIEnabled:!1,FirstPartyIntegrationSiteUrl:"",PowerBISignedInState:"",setPowerBISignedInState:P,beginSecureSessionForResource:P},this._propKey=e}return e.prototype.linkToParameter=function(e,t){var r=this,n=t.setPowerBISignedInState;e.setPowerBISignedInState=function(e){return n(r._pageId,e)};var a=t.beginSecureSessionForResource;e.beginSecureSessionForResource=a},e.prototype.retrievePowerBIObject=function(e,t,r,g){var m,f;this._pageId=t.id;var b,S,T,E=t.descriptor.Parameters,w=Object(a.b)(e),F=r.Parameters[this._propKey],x=Object(u.z)(e);Object(c.c)(e,l.Wc)&&(S=E.PowerBIReportId,T=F.PowerBIReportId,E.PowerBIFilter&&(b=function(e,t,r){var a=Object(n.g)(e,t),c=a.entityTypeName,l=a.id,u=Object(i.j)(e,t),d=Object(s.ac)(e,t,u),p=new o.a(c,l);try{var g=JSON.parse(r),m=g.Filter,f=g.Alias;for(var b in f){var v=f[b],y=Object(h.d)(e,d,p,v),S=y&&j(y)||null;if(Array.isArray(S)){var P=S.map((function(e){return I(e,!1)})).join(",");m=m.split(b).join(P)}else m=C(m,[{placeholder:'"'+b+'"',value:I(S,!0)},{placeholder:"'"+b+"'",value:null===S?I(S,!0):"'"+encodeURIComponent(S)+"'"},{placeholder:b,value:I(S,!1)}])}return m}catch(e){return void _.a.error(O.w,[{name:"errorCategory",value:"PowerBIFilter"},{name:"errorMessage",value:null==e?void 0:e.message},{name:"callstack",value:null==e?void 0:e.stack},{name:"filter",value:r}])}}(e,this._pageId,E.PowerBIFilter)));var A=Object(v.a)(e,this._pageId).powerBISignedInState,N=Object(y.b)(e,this._pageId),D=Object(d.c)(e),k=Object(p.a)(e);return this.previousReturn={EnableInMobile:"true"===(null===(m=F.EnableInMobile)||void 0===m?void 0:m.toString().toLowerCase())||"true"===(null===(f=E.EnableInMobile)||void 0===f?void 0:f.toString().toLowerCase()),PowerBIGroupId:F.PowerBIGroupId||E.PowerBIGroupId,PowerBIDashboardId:F.PowerBIDashboardId||E.PowerBIDashboardId,PowerBIReportId:T||S,PowerBIFilter:b,TileId:F.TileId||E.TileId,TileUrl:F.TileUrl||E.TileUrl,PowerBIType:parseInt(F.PowerBIType,10)||parseInt(E.Type,10)||0,IsPowerBIEnabled:w.isPowerBIEnabled,FirstPartyIntegrationSiteUrl:w.firstPartyIntegrationSiteUrl,PowerBISignedInState:A,Tenant:x,ForceMobile:D<=k.sizes.Breakpoints.DimensionS,FormId:N,setPowerBISignedInState:P,beginSecureSessionForResource:P},this.previousReturn},e.prototype.getLatestData=function(){return this.previousReturn},e}();function C(e,t,r){void 0===r&&(r=0);var n=t[r],a=n.placeholder,i=n.value,o=e.split(a),s=r+1;if(s<t.length)for(var c in o)o[c]=C(o[c],t,s);return e=o.join(i)}function I(e,t){if(!t&&(null==e?void 0:e.length)>0){var r=Number(e);if(!isNaN(r)&&r.toString()===e)return JSON.stringify(r)}return JSON.stringify(e)}function j(e){if(Object(g.i)(e))return e.valueString;if(Object(g.g)(e))return m.a.toString(e.id);if(Object(g.k)(e))return e.reference&&m.a.toString(e.reference.id);if(Object(g.j)(e))return!Object(b.a)(e.value)&&e.value.toString();if(Object(g.h)(e)){var t=Object(f.h)(e);if(t)return t.map((function(e){return m.a.toString(m.a.fromExternalGuid(e.id))}))}else if(Object(g.f)(e)&&e.innerValue)return j(e.innerValue)}function P(){throw new Error("Not Replaced")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var T="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlPowerBISelector";function E(){return function(e,t,r,n,a){_.a.info(r.controlId+"."+T+": createGetPowerBIData started");var i=new S(e);return i.retrievePowerBIObject(t,r,n,a),_.a.info(r.controlId+"."+T+": createGetPowerBIData finished"),i}}},uCYK:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="footer.visible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.v)(t);return{type:a,payload:r,meta:{pageId:e,contextKey:i}}}},vqdi:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var n=r("OROb"),a=r("lMVv"),i=r("sgPk"),o=r("C8Q/"),s=r("ig6i"),c=r("cm3g"),l=r("9r0m"),u=r("HSdq"),d=r("Sscr"),p=r("sOTk"),h=r("Gemh"),g=r("0hZT"),m=r("fE8x"),f=r("r454"),b=r("cZkS"),v=r("qC0c"),y=r("EcZf"),_=r("YEEA");function O(e,t,r,O,S,C,I,j){return void 0===I&&(I=!1),{type:"embeddedEntity.save",execute:function(O,P){var T,E=O.getState(),w=new l.a(r),F=Object(d.f)(j,w,t);switch(Object(p.l)(E,e)){case g.a:T=Object(h.R)(E,e,F);break;default:T=Object(u.ac)(E,e,F)}var x=Object(m.c)(E),A=Object(m.b)(E);if((x||A)&&"Dashboard"!==Object(p.l)(E,e)){var N=P.ScriptManager.getContainer(e).getEventManager();if(O.dispatch(N.runOnSave(j,1,null,r)))return Promise.reject(Object(_.b)(E,e,2200000005,""))}return O.dispatch(Object(n.c)(T,I,S)).then((function(n){var u=Object(h.qb)(E,new l.a(C),e),d=Object(a.h)(E,t),p=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,O.getState);return p.where(new o.a("eq",new s.a(t,d.PrimaryIdAttribute),new c.a(r))),O.dispatch(Object(y.d)(p.getQueryState())).then((function(){return n}))})).catch((function(e){return Object(v.a)(E,b.xb)&&T&&O.dispatch(Object(f.b)(T,!1)),Promise.reject(e)}))}}}},w82B:function(e,t,r){"use strict";r.d(t,"a",(function(){return P}));var n=r("cZkS"),a=r("9r0m"),i=r("G7N+"),o=r("9LTA"),s=r("8Fmj"),c=r("7dGM"),l=r("dUXI"),u=r("y5DA"),d=r("gBKR"),p=r("mGpW"),h=r("olrR"),g=r("Ww2r"),m=r("RlP9"),f=r("kl3Z"),b=r("+Z9T"),v=r("vUcA"),y=r("Z46F"),_=r("WS0f"),O=r("KDdL"),S=r("8ADW");function C(e,t,r){return{type:"chartData.retrieve.preReq_async",execute:function(n,C){var I=n.dispatch,j=n.getState,P=j(),T=S.b+".chartData.retrieve.preReq_async",E=e.visualizationId,w=e.viewId;return I(Object(h.a)(t,void 0,e.viewType,w)).then((function(){P=j();var n=Object(m.c)(P,w);if(!function(e,t,n,a){if(!n||!n.fetchXML)return Object(u.a)(e,t,Object(g.b)(e,l.g),a,r),!1;return!0}(P,I,n,e))return Promise.resolve(null);var h=I(Object(s.a)(t,e.visualizationType,E)),b=I(Object(p.e)(l.A));return Promise.all([h,b]).then((function(){var t,s;P=j();var h=Object(c.a)(P,E);if(function(e){if(e&&e.WebResourceId)return!0;return!1}(h))return Object(o.d)(P,I,a.a.toString(e.visualizationId),a.a.toString(e.viewId),r),Promise.resolve(e);if(!function(e,t,n,a){if(n){if(n.initialized===i.a.Error){var o=Object(v.a)(n.errorCode)||l.u;return t(Object(p.e)([o])).then((function(){var n=Object(g.b)(e,o);Object(u.a)(e,t,n,a,r)}),(function(){Object(u.a)(e,t,Object(g.b)(e,l.u),a,r)})),!1}return!!n.DataDescription||(Object(u.a)(e,t,Object(g.b)(e,l.o),a,r),!1)}return!1}(P,I,h,e))return Promise.resolve(null);e.initialized||(e.initialize(h.DataDescription,n.fetchXML,h.PresentationDescription,n.title,n.entityLogicalName,h.Name,h.PrimaryEntityTypeCode,!1),e.setupAggregationQueries());var m={},b=e.dataDefinition.allAttributeNamesByEntity;Array.from(b.keys()).map((function(e){var t=Array.from(b.get(e).keys());m[e]=t}));var y=Object(f.c)(n).filter((function(e){return-1===e.indexOf(".")}));if(y&&y.length>0){var S=n.entityLogicalName;S in m?(t=m[S]).push.apply(t,y):m[S]=y}try{var w=h.PresentationDescription,F=Object(O.a)(w);if(!Object(_.b)(w)&&F.length>0){var x=n.entityLogicalName,A=[];A.push(function(e,t){var r=t[2]?t[2].toLowerCase():"";if(r.substring(0,e.length)!==e)return"";return r.substring(e.length+1,r.length)}(x,F)),x in m?(s=m[x]).push.apply(s,A):m[x]=A}}catch(e){var N="Failed to retrieve entity metadata attributes for Chart Series with error : "+e.message;C.EventManager.ReportComponentFailure(T,Error(N))}return I(Object(d.e)(m)).then((function(){return e}))}),(function(t){return Object(u.b)(t.getNegativeErrorCode(),j(),I,Object(g.b)(j(),l.q),e,r),Promise.resolve(null)}))}),(function(t){var n=t&&!Object(b.a)(t.errorCode)&&t.errorCode,a=Object(v.a)(n),i=a?Object(g.b)(P,a):"retrieve chart failed. error code: "+y.a.getHexErrorCodeFromInt(n);return Object(u.a)(P,I,i,e,r),Promise.resolve(null)}))}}}var I=r("Fpc+"),j=r("qC0c");function P(e,t,r,s){return void 0===s&&(s=!1),{type:"chartData.retrieve.async",execute:function(l,u){var d=l.dispatch,p=l.getState,h=[];try{h.push({name:S.g,value:a.a.toString(e.viewId)}),h.push({name:S.h,value:a.a.toString(e.visualizationId)});var g=p(),m=e.visualizationId,f=a.a.toString(m),b=e.viewId,v=a.a.toString(b);if(!Object(O.b)(p,d,u,h,e,t,r))return Promise.resolve();var y=void 0,_=Object(j.c)(g,n.rd);return((y=_?Object(c.e)(g,e.getStorageKey()):Object(c.d)(g,f,v))===i.a.Initialized&&Object(c.b)(g,f,v)||y===i.a.Initializing)&&!s?Promise.resolve():(d(_?Object(O.d)(e.getStorageKey(),I.c):Object(O.c)(f,v,I.c)),d(C(e,t,r)).then((function(e){if(!e||e.isWebResourceChart)return Promise.resolve();var n=e;return d(Object(o.b)(n,t,r))})))}catch(e){return u.EventManager.ReportComponentFailure(O.f+".retrieveChartData",Error(e),S.b,h),Promise.reject(e)}}}}},whwt:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return y}));var n=r("Sscr"),a=r("uO/V"),i=r("8Fmj"),o=r("RlP9"),s=r("9r0m"),c=r("Gemh"),l=r("7dGM"),u=r("lMVv"),d=r("Zdrd"),p=r("cqI9"),h=r("z9yS"),g=r("mGpW"),m=r("dUXI"),f=r("JlqV"),b=r("zETL"),v="chart.showChart.update";function y(e,t,r){return{type:"chart.showChart.update.async",execute:function(v,y){var O=v.dispatch,S=v.getState,C=y.TraceManager.getTracer(a.z),I=a.x+".updateShowChartAction";try{C.info("Updating the show chart"),t||(t=Object(n.k)(S(),e));var j=S(),P=Object(n.v)(t),T=Object(c.T)(j,e,t),E=Object(o.c)(j,T),w=E&&E.entityLogicalName,F=Object(c.r)(j,e,t,w),x=Object(c.s)(j,e,t),A=Object(l.a)(j,F),N=A&&A.PrimaryEntityTypeCode,D=N&&Object(u.m)(j,parseInt(N,10));w&&D&&w!==D&&(F=null,x=h.a.savedvisualization);var k=Object(l.i)(j,w);if(F&&k&&k.chartTypes&&Object.keys(k.chartTypes).length>0){var M=s.a.toString(F);x=M in k.chartTypes[h.a[h.a.savedvisualization]]?h.a.savedvisualization:h.a.uservisualization}return r?Object(f.b)(S())?(O(Object(g.e)(m.A)).then((function(){O(Object(i.a)(w,x,F)).then((function(r){return s.a.isNullOrEmpty(r)?(x=h.a.uservisualization,O(Object(d.b)(e,t,x)).then((function(){return O(Object(i.a)(w,x,F)).then((function(e){return Promise.resolve(e)}))}))):Promise.resolve(r)})).then((function(n){var a=s.a.toString(n);Promise.all([O(Object(p.b)(e,t,a)),O(Object(d.b)(e,t,x)),O(_(e,P,r))]).then((function(){return y.EventManager.ReportComponentSuccess(I),O(Object(b.b)(e,t)),Promise.resolve()}))}))})).catch((function(e){return y.EventManager.ReportComponentFailure(I,Error("Retrieve resource strings for chart failed")),Promise.reject(e)})),Promise.resolve()):Promise.resolve():(O(_(e,P,r)),y.EventManager.ReportComponentSuccess(I),Promise.resolve())}catch(e){var R="Update the show chart failed with error : "+e.message;y.EventManager.ReportComponentFailure(I,Error(R))}}}}function _(e,t,r){return{type:v,payload:{name:"showChart",value:r},meta:{pageId:e,dataSetContextKey:t}}}},x6Ak:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r("Sscr"),a="refresh.timer";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,r){var i=Object(n.x)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:i,controlName:r}}}},xirW:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));var n=r("UOiB"),a=r("Sscr"),i=r("krRo"),o="attribute.notification.update";function s(e,t,r,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute:function(e,l){e.dispatch(function(e,t,r,s){if(s&&s.contextTokenType&&s.contextTokenType===n.a.GridRow)return Object(i.d)(e,s,t,r);var c=Object(a.x)(s);return{type:o,payload:r,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,r,s,c))}}}},y5DA:function(e,t,r){"use strict";r.d(t,"c",(function(){return d})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return h}));var n=r("9LTA"),a=r("Ww2r"),i=r("dUXI"),o=r("BuSU"),s=r("Je7O"),c=r("cZkS"),l=r("qC0c"),u=r("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,r,n,o){var s=null;if(s=Object(a.b)(e,i.q),"function"==typeof r.get_ErrorCode)switch(r.get_ErrorCode()){case-2147093999:s=Object(a.b)(e,i.r);break;case-2147220960:s=Object(a.b)(e,i.o);break;case-2147164125:s=Object(a.b)(e,i.a);break;case-2147164130:case-2147164126:s=Object(a.b)(e,i.j);break;case-2147217149:s=Object(a.b)(e,i.i);break;case-2147217098:s=Object(a.b)(e,i.x);break;case-2147220969:case-2147187962:s=Object(a.b)(e,i.p);break;default:r.get_Message()&&(s=s+" "+r.get_Message())}p(e,t,s,n,o)}function p(e,t,r,a,i){var d;d=function(e){var t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(r),Object(l.c)(e,c.rd)?(t(Object(n.a)(a.getStorageKey(),d)),Object(n.e)(e,t,a.getStorageKey(),i)):(t(Object(n.c)(u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(n.d)(e,t,u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,i))}function h(e,t,r,n,o,s){p(t,r,-2147220960===e?Object(a.b)(t,i.o):n,o,s)}},ya7l:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("4Tx6"),a=r("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,r,i,o,s,c,l){var u={powerBIEmbedUrl:t,powerBIGroupId:r,powerBIDashboardId:i,powerBITileId:o,powerBIReportId:s,powerBIReportUrl:c,powerBIComponentTypeCode:l};return Object(a.a)(n.a,u,e,{target:"dialog"})}},zvr0:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));var n=r("c/eZ"),a=r("Sscr"),i=r("uQP8"),o="control.update.unboundOutputs";function s(e,t,r,s){return{type:"control.update.unboundOutputs.async",execute:function(c){var l=c.dispatch,u=c.getState;if(!Object.keys(s).length)return Promise.resolve();var d=u(),p=Object(i.a)(d,e),h=!1,g=Object(a.v)(r),m=Object(n.__assign)({},p.forms[g].controlUnboundOutputs);for(var f in s){var b=s[f],v=t+"."+f;m[v]!==b&&(m[v]=b,h=!0)}return h&&l(function(e,t,r){return{type:o,payload:{controlUnboundOutputs:r},meta:{pageId:e,contextKey:t}}}(e,g,m)),Promise.resolve()}}}}}]),window.bundleExecutionMarkers["scripts/es5/dashboardpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();