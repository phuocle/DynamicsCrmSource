(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/multisession.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[85],{nt4s:function(e,t,n){"use strict";n.r(t),n.d(t,"XrmAppSessions",(function(){return ae})),n.d(t,"TabList",(function(){return Ge})),n.d(t,"MultiSessionNavigationHandler",(function(){return Qe})),n.d(t,"SessionTabEventManager",(function(){return nt})),n.d(t,"NavigateBackButton",(function(){return at})),n.d(t,"createTabWithPageInput",(function(){return Q})),n.d(t,"getFocusedSessionId",(function(){return f.c})),n.d(t,"updateHomeSessionTitleAction",(function(){return I}));var i=n("+Z9T"),s=n("IQrP"),o=n("Z1aD"),r=n("cn0Y"),a=n("pKlA"),c=n("jzXk"),u=n("QOfD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){return Object.keys(Object(u.c)(e)).length<s.A}var p=n("6JRL"),d=n("MWeR"),b=n("OdhZ"),h=n("Fo9t"),f=n("DNkP"),y=n("VK1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e){var t=[{name:"pageType",value:e.pageType},{name:"canBeClosed",value:!!e.canBeClosed},{name:"hasTitle",value:!!e.title},{name:"hasIcon",value:!!e.icon},{name:"isFocused",value:e.isFocused},{name:"isFocusRequested",value:!!e.isFocusRequested},{name:"hasIconTitle",value:!!e.iconTitle}];return{type:s.k,execute:function(n,i){var c=n.dispatch,v=n.getState,_={sessionId:Object(f.c)(v()),tabId:Object(y.b)(v())},m=c(function(e,t){return{type:s.l,sync:!0,execute:function(n,i){var o=n.dispatch,r=(0,n.getState)();if(!l(r)){var a=Object.keys(Object(u.c)(r)).length;throw Object(p.d)("Cannot create session",a===s.A?2415919113:2415919107,[{name:"numberSession",value:a}])}var c=function(e){return{type:s.j,payload:{canBeClosed:e.canBeClosed,sessionId:Object(d.d)(),tabId:Object(d.e)(),title:e.title,icon:e.icon,iconTitle:e.iconTitle,isFocused:e.isFocused,isFocusRequested:e.isFocusRequested}}}(e);return t.push({name:"sessionId",value:c.payload.sessionId}),t.push({name:"anchorTabId",value:c.payload.tabId}),o(Object(b.b)(c.payload.tabId,!0)),o(c),{sessionId:c.payload.sessionId,tabId:c.payload.tabId}}}}(e,t));return c(g(m,_,e,a.a.Before)).then((function(){return c(function(e,t){return{type:s.Z,execute:function(n,i){var s=n.dispatch,a={source:r.b.Unknown,targetBrowsingContext:t};return s(Object(o.a)(e.pageType,e.pageInput,void 0,a)).then((function(t){!1!==e.isFocused&&0===t.status&&Object(h.c)(i.Router,[])}))}}}(e,m.tabId))})).then((function(){return c(g(m,_,e,a.a.After))})).then((function(){return m}))},getInitialParameters:function(e){return Object(c.b)(e,t)},getFailureParameters:function(e,n,i){return Object(c.b)(i,t)},getSuccessParameters:function(e,n){var i=e.sessionId;return Object(c.b)(n,t,i)}}}function g(e,t,n,i){return{type:s.q,execute:function(s,o){s.dispatch,s.getState;var r=[o.SessionTabEventManager.executeHandlersAsync(a.b.SessionCreated,i,{sessionId:e.sessionId}),o.SessionTabEventManager.executeHandlersAsync(a.b.TabCreated,i,{sessionId:e.sessionId,tabId:e.tabId})];return!1!==n.isFocused&&(r.push(o.SessionTabEventManager.executeHandlersAsync(a.b.SessionSwitched,i,{previousSessionId:t.sessionId,newSessionId:e.sessionId})),r.push(o.SessionTabEventManager.executeHandlersAsync(a.b.TabSwitched,i,{previousSessionId:t.sessionId,previousTabId:t.tabId,sessionId:e.sessionId,tabId:e.tabId}))),Promise.all(r)}}}var _=n("Ww2r");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function m(e,t){var n=[{name:"sessionId",value:e},{name:"canBeClosed",value:!!t}];return{type:s.fb,sync:!0,execute:function(n){var i=n.dispatch,o=n.getState;if(Object(f.a)(o())===e)throw Object(p.d)("Cannot make default session closeable",2415919119,[{name:"SessionId",value:e}]);i(function(e,t){return{type:s.eb,payload:{sessionId:e,canBeClosed:t}}}(e,t))},getFailureParameters:function(e,t,i,s){return n},getSuccessParameters:function(e,t,i){return n}}}function I(){return{type:s.db,sync:!0,execute:function(e){var t=e.dispatch,n=e.getState,i=Object(_.h)()(n(),[s.y]),o=Object(_.c)(i,s.y);t(x(Object(f.a)(n()),o))}}}function x(e,t){return{type:s.mb,payload:{sessionId:e,title:t}}}function S(e,t){var n=[{name:"sessionId",value:e},{name:"isFocusRequested",value:t}];return{type:s.hb,sync:!0,execute:function(i){var o=i.dispatch,r=i.getState;Object(f.c)(r())!==e?o(function(e,t){return{type:s.gb,payload:{sessionId:e,isFocusRequested:t}}}(e,t)):n.push({name:"canceled",value:!0})},getFailureParameters:function(e,t,i,s){return n},getSuccessParameters:function(e,t,i){return n}}}function T(e,t){var n=[{name:"sessionId",value:e},{name:"hasIcon",value:!!t}];return{type:s.jb,sync:!0,execute:function(n){var i=n.dispatch;n.getState;return i(function(e,t){return{type:s.ib,payload:{sessionId:e,icon:t}}}(e,t))},getFailureParameters:function(e,t,i,s){return n},getSuccessParameters:function(e,t,i){return n}}}function O(e,t){var n=[{name:"sessionId",value:e},{name:"hasIconTitle",value:!!t}];return{type:s.lb,sync:!0,execute:function(n){var i=n.dispatch;n.getState;return i(function(e,t){return{type:s.kb,payload:{sessionId:e,iconTitle:t}}}(e,t))},getFailureParameters:function(e,t,i,s){return n},getSuccessParameters:function(e,t,i){return n}}}var C=n("IfCW"),j=n("c/eZ"),E=n("dG8J"),A=n("l+dh"),w=n("sOTk"),B=n("fW82"),k=n("r529");var F,P=n("Tb61"),R=n("7ipg"),D=function(){function e(e,t){Object(i.g)(t,"ClientApi.XrmAppTabHistory.constructor","store"),F=t,this._tabId=e,this._clientApiExecutor=new R.b(t,"ClientApi.XrmAppTabHistory.")}return e.prototype.back=function(){var e=this;return this._clientApiExecutor.executeAsync("back",(function(){return F.dispatch((t=e._tabId,Object(j.__assign)({type:s.V,execute:function(e,n){var i=e.dispatch,s=(e.getState,{targetBrowsingContext:t});if(n.Router.getHistoryManager().GetHistoryLength(s)<=1)throw Object(p.d)("There are no pages to go back to for this tab",2415919117,[{name:"tabId",value:t}]);return i(Object(k.b)(s))}},Object(c.a)(t,[{name:"tabId",value:t}])))).then((function(){}));var t}))},e.prototype.clear=function(){var e=this;return this._clientApiExecutor.execute("clear",(function(){return F.dispatch(Object(P.b)(e._tabId))}))},e}(),H=n("XNwl"),L=n("zmaG"),M=n.n(L),N=n("7pqb"),q=n("KzL8"),W=n("Nw1z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function V(e,t){var n=[{name:"sessionId",value:e},{name:"tabId",value:t}];return{type:s.x,sync:!0,execute:function(i,o){var r=i.dispatch,c=(0,i.getState)(),l=Object(f.c)(c),d=Object(y.a)(c).id;if(l!==e)throw Object(p.d)("Cannot switch to a tab for a session that is not in focus",2415919115,[{name:"sessionId",value:e},{name:"tabId",value:t}]);if(d!==t){if(-1===Object(u.a)(c,e).tabs.indexOf(t))throw Object(p.d)("Tab being switched to is not in session",2415919116,[{name:"sessionId",value:e},{name:"tabId",value:t}]);return r(function(e,t){return{type:s.w,sync:!0,execute:function(n,i){var o,r=n.dispatch,a=n.getState,c=a(),u=Object(q.a)(c,t),l=Object(w.g)(c,u.pageId);M.a.addKeyPerformanceIndicatorOnIdle("FocusTab",((o={})[N.x.PageName]=l?l.pageType:"",o)),r(function(e,t){return{type:s.v,payload:{sessionId:e,tabId:t}}}(e,t)),Object(h.c)(i.Router,Object(W.a)(a(),u.id));var p=Object(A.c)(c,t);Object(H.b)(p)}}}(e,t)),o.SessionTabEventManager.executeHandlersAsync(a.b.TabSwitched,a.a.Before,{sessionId:e,tabId:t,previousSessionId:l,previousTabId:d}).then((function(){return o.SessionTabEventManager.executeHandlersAsync(a.b.TabSwitched,a.a.After,{sessionId:e,tabId:t,previousSessionId:l,previousTabId:d})}))}n.push({name:"canceled",value:!0})},getInitialParameters:function(t){return Object(c.b)(t,n,e)},getFailureParameters:function(t,i,s,o){return Object(c.b)(s,n,e)},getSuccessParameters:function(t,i,s){return Object(c.b)(i,n,e)}}}var X=n("FkAa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(e,t){var n=[{name:"tabId",value:e},{name:"canBeClosed",value:!!t}];return{type:s.pb,sync:!0,execute:function(n,i){var o=n.dispatch,r=n.getState;if(Object(u.b)(r(),e).anchorTabId===e)throw Object(p.d)("Cannot make anchor tab closeable",2415919118,[{name:"TabId",value:e}]);o(function(e,t){return{type:s.ob,payload:{tabId:e,canBeClosed:t}}}(e,t))},getFailureParameters:function(e,t,i,s){return n},getSuccessParameters:function(e,t,i){return n}}}function G(e,t){return{type:s.rb,sync:!0,execute:function(n,i){var o=n.dispatch,r=n.getState;o(function(e,t){return{type:s.qb,payload:{tabId:e,title:t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t));var a=Object(q.a)(r(),e);a.pageId&&o(Object(H.c)(a.pageId,t))}}}var z=function(){function e(e,t,n){Object(i.g)(n,"ClientApi.XrmAppTab.constructor","store"),this._store=n,this._sessionId=t,this._tabId=e,Object(A.b)(this._store.getState(),e),this._clientApiExecutor=new R.b(n,"ClientApi.XrmAppTab.")}return Object.defineProperty(e.prototype,"tabId",{get:function(){var e=this;return this._clientApiExecutor.execute("tabId_get",(function(){return e._tabId}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var e=this;return this._clientApiExecutor.execute("title_get",(function(){var t=e._store.getState();return Object(A.c)(t,e._tabId)}))},set:function(e){var t=this;this._clientApiExecutor.execute("title_set",(function(){t._store.dispatch(G(t._tabId,e))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canClose",{get:function(){var e=this;return this._clientApiExecutor.execute("canClose_get",(function(){return Object(A.b)(e._store.getState(),e._tabId).canBeClosed}))},set:function(e){var t=this;this._clientApiExecutor.execute("canClose_set",(function(){t._store.dispatch(K(t._tabId,e))}),[{name:"value",value:e,isRequired:!0}])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentUrl",{get:function(){var e=this;return this._clientApiExecutor.execute("currentUrl_get",(function(){var t=e._store.getState(),n=Object(q.a)(t,e._tabId).pageId,i=Object(w.l)(t,n),s=Object(w.g)(t,n);return e._store.dispatch(Object(B.b)(i,s))}))},enumerable:!1,configurable:!0}),e.prototype.focus=function(){var e=this;return this._clientApiExecutor.execute("focus",(function(){return e._store.dispatch(V(e._sessionId,e._tabId))}))},e.prototype.close=function(){var e=this;return this._clientApiExecutor.executeAsync("close",(function(){return e._store.dispatch(Object(E.a)(e._sessionId,e._tabId))}))},Object.defineProperty(e.prototype,"history",{get:function(){var e=this;return this._clientApiExecutor.execute("history_get",(function(){return e._history||(e._history=new D(e._tabId,e._store)),e._history}))},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){var e=this;return this._clientApiExecutor.executeAsync("refresh",(function(){var t=e._store.getState(),n=Object(q.a)(t,e._tabId).pageId,i=Object(w.g)(t,n),s=Object(w.l)(t,n),a={replaceState:!0,source:r.b.Xrm,targetBrowsingContext:e._tabId};return e._store.dispatch(Object(o.a)(s,Object(j.__assign)({},i),n,a)).then((function(){}))}))},e.prototype.navigateTo=function(e){var t=Object(q.a)(this._store.getState(),this._tabId).pageId,n={source:r.b.Xrm,targetBrowsingContext:this._tabId};return Object(X.i)(this._store,this._clientApiExecutor,e,"navigateTo",n,void 0,void 0,t).then((function(){}))},e.prototype.getParentSessionId=function(){var e=this;return this._clientApiExecutor.execute("getParentSessionId",(function(){return e._sessionId}))},e}(),U=n("Zy0S");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Z(e,t){return t?Object(u.a)(e,t).tabs.length<s.B:null}var J=n("ZVHh"),Y=n("JYPj");function Q(e,t,n){var i=[{name:"pageType",value:e},{name:"sessionId",value:n.sessionId},{name:"canBeClosed",value:!!n.canBeClosed},{name:"hasTitle",value:!!n.title},{name:"isTitleStatic",value:!!n.isTitleStatic},{name:"isFocused",value:n.isFocused}];return{type:s.o,execute:function(s,a){var c=s.dispatch,u=(s.getState,{source:r.b.Unknown}),l=Object(o.a)(e,t,void 0,u);return c($(n,l,u,i))},getInitialParameters:function(e){return Object(c.b)(e,i,n.sessionId)},getFailureParameters:function(e,t,s,o){return Object(c.b)(s,i,n.sessionId)},getSuccessParameters:function(e,t,s){return Object(c.b)(t,i,n.sessionId)}}}function $(e,t,n,i){return{type:s.m,execute:function(o,r){var c=o.dispatch,l=(0,o.getState)();if(!Z(l,e.sessionId)){var f=Object(u.a)(l,e.sessionId).tabs.length;throw Object(p.d)("Cannot create tab",s.B===f?2415919112:2415919107,[{name:"numberTab",value:f}])}var v=function(e){return{type:s.n,payload:{tabId:Object(d.e)(),sessionId:e.sessionId,canBeClosed:e.canBeClosed,title:e.title,isTitleStatic:e.isTitleStatic,isFocused:e.isFocused}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e),g=Object(y.b)(l),_=v.payload.tabId;return i.push({name:"tabId",value:_}),c(Object(b.b)(_,!0)),c(v),n.targetBrowsingContext=_,c(ee(e,_,g,a.a.Before)).then((function(){return c(t)})).then((function(t){!1!==e.isFocused&&0===t.status&&Object(h.c)(r.Router,[])})).then((function(){return c(ee(e,_,g,a.a.After))})).then((function(){return _}))}}}function ee(e,t,n,i){return{type:s.r,execute:function(s,o){s.dispatch,s.getState;return o.SessionTabEventManager.executeHandlersAsync(a.b.TabCreated,i,{sessionId:e.sessionId,tabId:t}).then((function(){if(!1!==e.isFocused)return o.SessionTabEventManager.executeHandlersAsync(a.b.TabSwitched,i,{sessionId:e.sessionId,tabId:t,previousSessionId:e.sessionId,previousTabId:n})}))}}}var te,ne,ie,se=function(){function e(e,t,n){Object(i.g)(e,"ClientApi.XrmAppTabs.constructor","store"),Object(u.a)(e.getState(),n),te=e,this._sessionId=n,this._clientApiExecutor=new R.b(e,"ClientApi.XrmAppTabs.")}return e.prototype.getTab=function(e){var t=this;return this._clientApiExecutor.execute("getTab",(function(){return new z(e,t._sessionId,te)}),[{name:"tabId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.getFocusedTab=function(){var e=this;return this._clientApiExecutor.execute("getFocusedTab",(function(){var t=Object(u.a)(te.getState(),e._sessionId);return new z(t.focusedTabId,e._sessionId,te)}))},e.prototype.canCreateTab=function(){var e=this;return this._clientApiExecutor.execute("canCreateTab",(function(){return Z(te.getState(),e._sessionId)}))},e.prototype.createTab=function(e){var t=this;return this._clientApiExecutor.execute("createTab",(function(){var n=Object(X.d)(e.pageInput),i=Object(X.e)(e.pageInput),s={sessionId:t._sessionId,canBeClosed:e.options&&e.options.canBeClosed,title:e.options&&e.options.title,isTitleStatic:e.options&&!!e.options.title,isFocused:e.options&&e.options.isFocused};return te.dispatch(Q(i,n,s))}),[{name:"input",value:e,isRequired:!0}])},e.prototype.getAll=function(){var e=this;return this._clientApiExecutor.execute("getAll",(function(t){var n=Object(u.a)(te.getState(),e._sessionId),i=new U.a(t);return n.tabs.forEach((function(t){i.add(t,new z(t,e._sessionId,te))})),i}))},e}(),oe=n("1gba"),re=function(){function e(e,t,n){Object(i.g)(t,"ClientApi.XrmAppSession.constructor","store"),Object(u.a)(t.getState(),e),ne=t,ie=n,this._sessionId=e,this._clientApiExecutor=new R.b(t,"ClientApi.XrmAppSession.")}return Object.defineProperty(e.prototype,"sessionId",{get:function(){var e=this;return this._clientApiExecutor.execute("sessionId_get",(function(){return e._sessionId}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var e=this;return this._clientApiExecutor.execute("title_get",(function(){return Object(u.a)(ne.getState(),e._sessionId).title}))},set:function(e){var t=this;this._clientApiExecutor.execute("title_set",(function(){var n,i,o;ne.dispatch((n=t._sessionId,o=[{name:"sessionId",value:n},{name:"hasTitle",value:!!(i=e)}],{type:s.nb,sync:!0,execute:function(e){var t=e.dispatch,s=e.getState;if(Object(f.a)(s())===n)throw Object(p.d)("Cannot set default session title",2415919122,[{name:"SessionId",value:n}]);return t(x(n,i))},getFailureParameters:function(e,t,n,i){return o},getSuccessParameters:function(e,t,n){return o}}))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canClose",{get:function(){var e=this;return this._clientApiExecutor.execute("canClose_get",(function(){return Object(u.a)(ne.getState(),e._sessionId).canBeClosed}))},set:function(e){var t=this;this._clientApiExecutor.execute("canClose_set",(function(){ne.dispatch(m(t._sessionId,e))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDefault",{get:function(){var e=this;return this._clientApiExecutor.execute("isDefault_get",(function(){return Object(f.a)(ne.getState())===e._sessionId}))},enumerable:!1,configurable:!0}),e.prototype.focus=function(){var e=this;return this._clientApiExecutor.executeAsync("focus",(function(){return ne.dispatch(Object(oe.a)(e._sessionId))}))},e.prototype.requestFocus=function(){var e=this;return this._clientApiExecutor.execute("requestFocus",(function(){return ne.dispatch(S(e._sessionId,!0))}))},e.prototype.close=function(){var e=this;return this._clientApiExecutor.executeAsync("close",(function(){return ne.dispatch(Object(C.a)(e._sessionId))}))},Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(){return e._tabs||(e._tabs=new se(ne,ie,e._sessionId)),e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconPath",{get:function(){var e=this;return this._clientApiExecutor.execute("iconPath_get",(function(){return Object(u.a)(ne.getState(),e._sessionId).icon}))},set:function(e){var t=this;this._clientApiExecutor.execute("iconPath_set",(function(){ne.dispatch(T(t._sessionId,e))}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconTitle",{get:function(){var e=this;return this._clientApiExecutor.execute("iconTitle_get",(function(){return Object(u.a)(ne.getState(),e._sessionId).iconTitle}))},set:function(e){var t=this;this._clientApiExecutor.execute("iconTitle_set",(function(){ne.dispatch(O(t._sessionId,e))}))},enumerable:!1,configurable:!0}),e}(),ae=function(){function e(e,t){Object(i.g)(e,"ClientApi.XrmAppSessions.constructor","store"),Object(i.g)(t,"ClientApi.XrmAppSessions.constructor","context"),this._applicationContext=t,this._store=e,this._clientApiExecutor=new R.b(e,"ClientApi.XrmAppSessions.")}return e.prototype.getSession=function(e){var t=this;return this._clientApiExecutor.execute("getSession",(function(){return new re(e,t._store,t._applicationContext)}),[{name:"sessionId",value:e,isRequired:!0}])},e.prototype.getFocusedSession=function(){var e=this;return this._clientApiExecutor.execute("getFocusedSession",(function(){var t=Object(f.c)(e._store.getState());return new re(t,e._store,e._applicationContext)}))},e.prototype.canCreateSession=function(){var e=this;return this._clientApiExecutor.execute("canCreateSession",(function(){return l(e._store.getState())}))},e.prototype.createSession=function(e){var t=this;return this._clientApiExecutor.executeAsync("createSession",(function(){var n={pageType:Object(X.e)(e.pageInput),pageInput:Object(X.d)(e.pageInput),canBeClosed:e.options&&e.options.canBeClosed,title:e.options&&e.options.title,icon:e.options&&e.options.iconPath,iconTitle:e.options&&e.options.iconTitle,isFocused:e.options&&e.options.isFocused,isFocusRequested:e.options&&e.options.isFocusRequested};return t._store.dispatch(v(n)).then((function(e){return e.sessionId}))}),[{name:"input",value:e,isRequired:!0},{name:"input.pageInput",value:null==e?void 0:e.pageInput,isRequired:!0}])},e.prototype.getAll=function(){var e=this;return this._clientApiExecutor.execute("getAll",(function(t){var n=new U.a(t);return Object.keys(e._store.getState().sessions).forEach((function(t){n.add(t,new re(t,e._store,e._applicationContext))})),n}))},e.prototype.addOnAfterSessionCreate=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterSessionCreate",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.SessionCreated,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterSessionCreate=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterSessionCreate",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.SessionCreated,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnAfterSessionClose=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterSessionClose",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.SessionClosed,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterSessionClose=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterSessionClose",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.SessionClosed,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnAfterSessionSwitch=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterSessionSwitch",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.SessionSwitched,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterSessionSwitch=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterSessionSwitch",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.SessionSwitched,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnAfterTabCreate=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterTabCreate",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.TabCreated,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterTabCreate=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterTabCreate",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.TabCreated,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnAfterTabClose=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterTabClose",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.TabClosed,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterTabClose=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterTabClose",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.TabClosed,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnAfterTabSwitch=function(e){var t=this;return this._clientApiExecutor.execute("addOnAfterTabSwitch",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.TabSwitched,a.a.After,e)}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnAfterTabSwitch=function(e){var t=this;return this._clientApiExecutor.execute("removeOnAfterTabSwitch",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.TabSwitched,a.a.After,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0}])},e.prototype.addOnBeforeSessionCreate=function(e){var t=this;return this._clientApiExecutor.execute("addOnBeforeSessionCreate",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.SessionCreated,a.a.Before,e)}),[{name:"handler",value:e,isRequired:!0,expectedDataType:"function"}])},e.prototype.removeOnBeforeSessionCreate=function(e){var t=this;return this._clientApiExecutor.execute("removeOnBeforeSessionCreate",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.SessionCreated,a.a.Before,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])},e.prototype.addOnBeforeSessionSwitch=function(e){var t=this;return this._clientApiExecutor.execute("addOnBeforeSessionSwitch",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.SessionSwitched,a.a.Before,e)}),[{name:"handler",value:e,isRequired:!0,expectedDataType:"function"}])},e.prototype.removeOnBeforeSessionSwitch=function(e){var t=this;return this._clientApiExecutor.execute("removeOnBeforeSessionSwitch",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.SessionSwitched,a.a.Before,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])},e.prototype.addOnBeforeTabCreate=function(e){var t=this;return this._clientApiExecutor.execute("addOnBeforeTabCreate",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.TabCreated,a.a.Before,e)}),[{name:"handler",value:e,isRequired:!0,expectedDataType:"function"}])},e.prototype.removeOnBeforeTabCreate=function(e){var t=this;return this._clientApiExecutor.execute("removeOnBeforeTabCreate",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.TabCreated,a.a.Before,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])},e.prototype.addOnBeforeTabSwitch=function(e){var t=this;return this._clientApiExecutor.execute("addOnBeforeTabSwitch",(function(){return t._applicationContext.SessionTabEventManager.addHandler(a.b.TabSwitched,a.a.Before,e)}),[{name:"handler",value:e,isRequired:!0,expectedDataType:"function"}])},e.prototype.removeOnBeforeTabSwitch=function(e){var t=this;return this._clientApiExecutor.execute("removeOnBeforeTabSwitch",(function(){t._applicationContext.SessionTabEventManager.removeHandler(a.b.TabSwitched,a.a.Before,e)}),[{name:"handlerId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"string"}])},e}(),ce=n("nuS9"),ue=n("4fxQ"),le=n("4E+q"),pe=n("YWpA"),de=n("Wg6j"),be=n("/3Li"),he=n("JlqV"),fe=n("GDI2"),ye=n("EitS"),ve=n("p1Sq"),ge=n("lU69"),_e=n("EGsq"),me=n("Wi7Z"),Ie=n("gvL4"),xe=n("1AYO"),Se=n("Smta"),Te=n("evW+"),Oe=n("H/hG"),Ce=n("zrMA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function je(e,t){return ce.createElement(Oe.a,{key:"new-tab-flyout-list-icon-"+t.Id,className:"svgIcon",style:e.style.iconWrapperStyles},function(e){return Object(Ce.a)({title:e.item.Tooltip||e.item.DisplayText,icon:e.item.Icon,styles:e.style.icon})}(e))}function Ee(e){return ce.createElement(Se.a,{id:e.item.Id,key:e.item.Id,style:e.style.itemWrapper,tabIndex:-1,title:e.item.DisplayText,accessibilityLabel:e.item.DisplayText,role:me.n,onClick:function(t){return function(e,t){e.onClick(t,e.item)}(e,t)},testhooks:{id:"new-tab-item-"+e.item.DisplayText}},ce.createElement(Te.a,{style:e.style.button,tabIndex:-1},ce.createElement(Oe.a,{style:e.style.buttonContentStyle},je(e,e.item),function(e,t){return ce.createElement(Oe.a,{tabIndex:-1,key:"new-tab-flyout-list-buttontext-"+t.Id,style:e.style.text},t.DisplayText)}(e,e.item))))}var Ae=n("PXs8"),we=function(e){function t(t){var n=e.call(this,t)||this;return n._keyboardHandler=n._keyboardHandler.bind(n),n}return Object(j.__extends)(t,e),t.prototype.render=function(){var e=this;return ce.createElement(xe.a,{id:this.props.flyoutId,key:this.props.flyoutId,positionType:"relative",relativeToElementId:this.props.relativeToElementId,flyoutStyle:this.props.style.flyoutStyle,flyoutDirection:xe.b.down,onOutsideClick:this.props.onCloseFlyoutRequest},ce.createElement(Ie.a,{style:this.props.style.flyoutListStyles,key:this.props.flyoutId+"_list",role:me.l,ref:Ae.c,onKeyDown:this._keyboardHandler},this.props.items.map((function(t,n){return ce.createElement(Ee,{key:e.props.flyoutId+"_item_"+n,item:t,style:e.props.style.flyoutListItemStyle,webresourcePath:e.props.webresourcePath,onClick:e.props.itemClick})}))),ce.createElement(pe.a,{style:this.props.style.bottomTextStyle},this.props.footerText))},t.prototype._keyboardHandler=function(e){Object(Ae.b)(e)||this.props.onCloseFlyoutRequest(),e.preventDefault()},t}(ce.Component),Be=n("0OS1"),ke=n("w2s3"),Fe=Object(de.h)("New",!1,!0,Be.a.colors.BaseColor.Black,{width:"100%"},null,null),Pe=function(e){function t(t){var n=e.call(this,t)||this;return n.state={flyoutVisible:!1},n._toggleFlyout=n._toggleFlyout.bind(n),n._onItemClick=n._onItemClick.bind(n),n._onCloseFlyoutRequest=n._onCloseFlyoutRequest.bind(n),n}return Object(j.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.style.buttonStyle;return this.state.flyoutVisible&&(t=Object(j.__assign)(Object(j.__assign)({},this.props.style.buttonStyle),this.props.style.buttonStyleActive)),ce.createElement(pe.a,null,ce.createElement(Te.a,{ref:function(t){return e._newTabButtonRef=t},id:s.W,style:t,onClick:this._toggleFlyout,tabIndex:0,accessibilityLabel:this.props.newTabAccessibilityLabel,title:this.props.newTabTooltip,accessibilityExpanded:this.state.flyoutVisible,accessibilityHasPopup:!0,ownsElementId:this.state.flyoutVisible?s.W+"_flyout":void 0,testhooks:{id:"create-new-tab-button"}},Fe),this.state.flyoutVisible&&ce.createElement(we,{flyoutId:s.W+"_flyout",relativeToElementId:s.W,items:this.props.sitemapMenu,style:this.props.style,webresourcePath:this.props.webResourcePath,onCloseFlyoutRequest:this._onCloseFlyoutRequest,footerText:this.props.informationLabel,itemClick:this._onItemClick}))},t.prototype._onCloseFlyoutRequest=function(e){if(e&&e.target){e.target.id!==s.W&&this._toggleFlyout()}else{this._toggleFlyout();var t=ue.findDOMNode(this._newTabButtonRef);t&&t.focus()}},t.prototype._toggleFlyout=function(){this.setState({flyoutVisible:!this.state.flyoutVisible})},t.prototype._onItemClick=function(e,t){this._toggleFlyout(),this.props.itemClick(t)},t}(ce.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Re=Object(le.a)((function(){var e,t,n=(e=null,t=null,function(n){var i=Object(he.b)(n);if(!t||e!==i){e=i;var o=Object(fe.b)(n);t=function(e,t){var n=[];for(var i in t.Areas)if(i!==ke.d){var s=t.Areas[i];for(var o in s.Groups){var r=s.Groups[o],a=Object(ve.b)(r);n=n.concat(a)}}return n}(0,o).map((function(e){var t=ye.c.FromStateItem(e,n);return{Id:Object(ge.a)(),Icon:t.icon,DisplayText:t.title.toString(),Tooltip:t.title,execute:function(t){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */return function(e,t){var n=[{name:"sessionId",value:t},{name:"url",value:Object(Y.a)(e.Url)},{name:"entity",value:e.Entity}];return{type:s.p,execute:function(i,s){var o=i.dispatch,a=(i.getState,{source:r.b.SiteMap}),c=Object(J.c)(e,!1,void 0,a);return o($({sessionId:t},c,a,n))},getInitialParameters:function(e){return Object(c.b)(e,n,t)},getFailureParameters:function(e,i,s){return Object(c.b)(s,n,t)},getSuccessParameters:function(e,i){return Object(c.b)(i,n,t)}}}(e,t)}}}))}return t});return function(e,t){return{platformType:Object(be.a)(e),sitemapMenu:n(e),webResourcePath:Object(_e.t)(e)}}}),(function(e,t){return{itemClick:function(n){var i=n.execute;e(i(t.sessionId))}}}))(Pe),De=n("XIN1"),He=n("znb3"),Le=n("9rQ4"),Me=function(e){function t(t){var n=e.call(this,t)||this;return n._cacheTitle="",n.state={isKeyboardFocused:!1},n._onFocus=n._onFocus.bind(n),n._onBlur=n._onBlur.bind(n),n._onTabClick=n._onTabClick.bind(n),n._onCloseClick=n._onCloseClick.bind(n),n._keyDownHandler=n._keyDownHandler.bind(n),n._onCloseButtonKeyDown=n._onCloseButtonKeyDown.bind(n),n}return Object(j.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.title&&(this._cacheTitle=this.props.title)},t.prototype.render=function(){var e=this.props.style.tabHeaderStyle;this.props.isFocusedTab&&(e=Object(j.__assign)(Object(j.__assign)({},this.props.style.tabHeaderStyle),this.props.style.selectedTabHeaderStyle));var t=this.props.title||this._cacheTitle||this.props.tabLoadingLabel;return ce.createElement(Se.a,{id:"tab-wrapper-"+this.props.tab.id,key:"tab-wrapper-"+this.props.tab.id,style:e,onClick:this._onTabClick,onKeyDown:this._keyDownHandler,onFocus:this._onFocus,onBlur:this._onBlur,tabIndex:this.props.isFocusedTab||this.state.isKeyboardFocused?0:-1,role:me.t,isSelected:this.props.isFocusedTab,accessibilityLabel:this._getaccessibilityLabel(),controlsElementId:this.props.isFocusedTab?"tabcontent":void 0},ce.createElement(pe.a,{key:"tab-wrapper-inner-"+this.props.tab.id,style:this.props.style.tabHeaderInnerStyle,className:this.props.isFocusedTab?"tab-header-inner focused":"tab-header-inner",testhooks:{id:this.props.tab.id}},ce.createElement(Oe.a,{key:"tab-title-"+this.props.tab.id,style:this.props.style.textTitleStyle,title:t},t),this.props.tab.canBeClosed&&this._renderCloseButton()))},t.prototype._renderCloseButton=function(){var e=this.props.title||this._cacheTitle,t=String.format(this.props.closeTabAccessibility,e);return ce.createElement(pe.a,{key:"close-tab-"+this.props.tab.id,className:this.state.isKeyboardFocused?"close-button focused":"close-button",style:this.props.style.closeButtonStyle,onClick:this._onCloseClick,onKeyDown:this._onCloseButtonKeyDown,tabIndex:0,accessibilityLabel:t,title:this.props.closeTabTooltip,role:me.d,testhooks:{id:"close-tab-"+this.props.tab.id}},ce.createElement(De.b,{type:He.a.Close,style:{padding:3}}))},t.prototype._onFocus=function(e){this.setState({isKeyboardFocused:!0}),this.props.onFocusIn(this.props.tab.id)},t.prototype._onBlur=function(e){e.relatedTarget&&e.relatedTarget.classList.contains("close-button")||this.setState({isKeyboardFocused:!1})},t.prototype._onCloseClick=function(e){this.props.tab.canBeClosed&&this.props.closeTab(this.props.sessionId,this.props.tab.id),e.stopPropagation()},t.prototype._onCloseButtonKeyDown=function(e){e.keyCode!==Le.a.Space&&e.keyCode!==Le.a.Enter||(e.stopPropagation(),this.props.tab.canBeClosed&&this.props.closeTab(this.props.sessionId,this.props.tab.id))},t.prototype._keyDownHandler=function(e){e.keyCode===Le.a.Space||e.keyCode===Le.a.Enter?!this.props.isFocusedTab&&this.props.setFocusTab(this.props.sessionId,this.props.tab.id):e.keyCode!==Le.a.Delete&&e.keyCode!==Le.a.Backspace||this.props.tab.canBeClosed&&this.props.closeTab(this.props.sessionId,this.props.tab.id)},t.prototype._onTabClick=function(){!this.props.isFocusedTab&&this.props.setFocusTab(this.props.sessionId,this.props.tab.id)},t.prototype._getaccessibilityLabel=function(){var e=this.props.title||this._cacheTitle||this.props.tabLoadingLabel;return this.props.tab.canBeClosed&&(e+=this.props.closeTabDescribedBy),e},t}(ce.Component),Ne=n("mDeH"),qe=n("7EJx"),We=n("XXef"),Ve=n("E705"),Xe=n("VnpK"),Ke=function(e){function t(t){var n=e.call(this,t)||this;return n._keyboardHandler=n._keyboardHandler.bind(n),n.scrollToLeft=n.scrollToLeft.bind(n),n.scrollToRight=n.scrollToRight.bind(n),n.closeTab=n.closeTab.bind(n),n.setFocusTab=n.setFocusTab.bind(n),n.state={scrollLeftButtonDisable:!0,scrolRightButtonDisable:!0,scrollButtonVisible:!1},n}return Object(j.__extends)(t,e),t.prototype.render=function(){var e,t,n=this,i=this.props.isRTL?"borderRight":"borderLeft",o=this.props.isRTL?"borderLeft":"borderRight",r="1px solid #c2c2c2",a=Object(j.__assign)(Object(j.__assign)({},this.props.flyoutStyle.buttonStyle),((e={width:"2rem"})[o]=r,e[i]="0",e.boxShadow=this.props.isRTL?"rgba(0, 0, 0, 0.1) -2px 0 8px":"rgba(0, 0, 0, 0.1) 2px 0 8px",e)),c=Object(j.__assign)(Object(j.__assign)({},this.props.flyoutStyle.buttonStyle),{width:"2rem",borderLeft:r,borderRight:r});this.props.tabs.findIndex((function(e){return e.id===n.props.focusedTabId}))!==this.props.tabs.length-1&&Object.assign(c,((t={})[o]=r,t[i]="0",t.boxShadow=this.props.isRTL?"rgba(0, 0, 0, 0.1) 2px 0 8px":"rgba(0, 0, 0, 0.1) -2px 0 8px",t));var u=Object(_.c)(this.props.resourceStrings,s.R),l=Object(_.c)(this.props.resourceStrings,s.S),p=Object(_.c)(this.props.resourceStrings,s.U),d=Object(_.c)(this.props.resourceStrings,s.I),b=Object(_.c)(this.props.resourceStrings,s.G),h=Object(_.c)(this.props.resourceStrings,s.H);return ce.createElement(pe.a,{key:"tabListContainerView",style:this.props.style.tabHeaderContainerStyle},this.state.scrollButtonVisible&&ce.createElement(Te.a,{key:"tabNavigationLeft",title:u,accessibilityLabel:u,style:a,onClick:this.scrollToLeft,tabIndex:0,disabled:this.state.scrollLeftButtonDisable},Object(de.h)(this.props.isRTL?"RightChevron":"LeftChevron",!1,!0,Be.a.colors.BaseColor.Black,{width:"100%"},null,null,u)),ce.createElement(Ie.a,{key:"tabListWrapper",ref:function(e){return n._wrapperRef=e},style:this.props.style.tabHeaderWraperStyle,role:me.u,onKeyDown:this._keyboardHandler},this.props.tabs.map((function(e){return ce.createElement(Me,{key:"tab-"+e.id,tab:e,title:n.props.tabTitles[e.id],sessionId:n.props.sessionId,isFocusedTab:e.id===n.props.focusedTabId,style:n.props.style,closeTab:n.closeTab,setFocusTab:n.setFocusTab,isRTL:n.props.isRTL,tabLoadingLabel:p,closeTabAccessibility:b,closeTabTooltip:d,closeTabDescribedBy:h,onFocusIn:function(e){return n._focusItemIndex=n.props.tabs.findIndex((function(t){return t.id===e}))}})}))),this.state.scrollButtonVisible&&ce.createElement(Te.a,{key:"tabNavigationRight",title:l,accessibilityLabel:l,style:c,onClick:this.scrollToRight,tabIndex:0,disabled:this.state.scrolRightButtonDisable},Object(de.h)(this.props.isRTL?"LeftChevron":"RightChevron",!1,!0,Be.a.colors.BaseColor.Black,{width:"100%"},null,null,l)),this.props.canCreateNewTab&&ce.createElement(Re,{sessionId:this.props.sessionId,style:this.props.flyoutStyle,newTabTooltip:Object(_.c)(this.props.resourceStrings,s.P),newTabAccessibilityLabel:Object(_.c)(this.props.resourceStrings,s.O),informationLabel:Object(_.c)(this.props.resourceStrings,s.N)}))},t.prototype._keyboardHandler=function(e){switch(Object(Ve.e)(e)){case Le.a.LeftArrow:var t=this._getPreviousElement();t&&t.focus(),e.preventDefault(),e.stopPropagation();break;case Le.a.RightArrow:var n=this._getNextElement();n&&n.focus(),e.preventDefault(),e.stopPropagation();break;case Le.a.Home:var i=this._getFirstElement();i&&i.focus(),e.preventDefault(),e.stopPropagation();break;case Le.a.End:var s=this._getLastElement();s&&s.focus(),e.preventDefault(),e.stopPropagation()}},t.prototype._getNextElement=function(){var e=ue.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=(this._focusItemIndex+1)%e.childNodes.length,e.childNodes[this._focusItemIndex]):null},t.prototype._getPreviousElement=function(){var e=ue.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex<=0&&(this._focusItemIndex=e.childNodes.length),this._focusItemIndex--,e.childNodes[this._focusItemIndex]):null},t.prototype._getFirstElement=function(){var e=ue.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=0,e.childNodes[this._focusItemIndex]):null},t.prototype._getLastElement=function(){var e=ue.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=e.childNodes.length-1,e.childNodes[this._focusItemIndex]):null},t.prototype.componentDidUpdate=function(e){var t=ue.findDOMNode(this._wrapperRef),n=t?t.offsetWidth:0;this.props.focusedTabId===e.focusedTabId&&n===this._clientWidth||(this._clientWidth=n,this._updateFocusTabPosition())},t.prototype._updateFocusTabPosition=function(){var e=this,t=ue.findDOMNode(this._wrapperRef),n=this.props.tabs.findIndex((function(t){return t.id===e.props.focusedTabId}));if(t&&t.childNodes&&!(t.childNodes.length<=n)&&t.childNodes[n]){var i=t.scrollLeft,o=t.scrollWidth,r=t.offsetWidth;1===this.props.tabs.length||o-this._clientWidth<=1?(this.state.scrollButtonVisible&&this.setState({scrollButtonVisible:!1}),t.classList.add("no-tab-navigation")):(this.state.scrollButtonVisible||this.setState({scrollButtonVisible:!0}),t.classList.remove("no-tab-navigation"));for(var a=0,c=0;c<n;c++)a+=s.cb;var u=0,l=0;if(s.bb<this._clientWidth){var p=(this._clientWidth-s.bb)/2;p>s.cb/2&&(p=s.cb/2),n<this.props.tabs.length-1&&(u=p),n>0&&(l=-p)}var d=i;a+l-i<=0?(d=a+l,t.scrollLeft=d):a+u+s.bb-i>this._clientWidth&&(d=a+u+s.bb-this._clientWidth,t.scrollLeft=d),this._updateNavigationButtonStatus(d,o,r)}},t.prototype.scrollToLeft=function(){this._scrollTabList(!0)},t.prototype.scrollToRight=function(){this._scrollTabList(!1)},t.prototype._scrollTabList=function(e){var t=ue.findDOMNode(this._wrapperRef);if(t&&t.childNodes&&t.childNodes.length){var n=t.scrollLeft,i=t.scrollWidth,o=t.offsetWidth,r=n;(r+=e?-1*s.cb:s.cb)<0?r=0:r>i-o&&(r=i-o),t.scrollLeft=r,this._updateNavigationButtonStatus(r,i,o)}},t.prototype._updateNavigationButtonStatus=function(e,t,n){this.setState({scrollLeftButtonDisable:0===e,scrolRightButtonDisable:e===t-n})},t.prototype.closeTab=function(e,t){var n=this;this.props.closeTab(e,t).then((function(e){var t=ue.findDOMNode(n._wrapperRef);!t||!t.childNodes||t.childNodes.length<=n._focusItemIndex||(n._focusItemIndex=e?0:n._focusItemIndex,t.childNodes[n._focusItemIndex].focus())}))},t.prototype.setFocusTab=function(e,t){this.props.setFocusTab(e,t)},t}(ce.Component);var Ge=Object(le.a)((function(){var e=Object(_.h)();return function(t,n){var i=Object(f.b)(t)||{},o=Object(A.d)(t,i.id),r={};o.forEach((function(e){r[e.id]=Object(A.c)(t,e.id)}));var a=e(t,[s.N,s.O,s.P,s.R,s.S,s.U,s.G,s.H,s.I]),c=Object(qe.g)(t),u=Object(Xe.n)();return{tabs:o,tabTitles:r,focusedTabId:i.focusedTabId,sessionId:i.id,style:Object(Ne.a)(c,u).tabStyle,flyoutStyle:Object(Ne.a)(c,u).flyoutStyle,canCreateNewTab:Z(t,i.id),canPerformBackNavigation:Object(We.a)(t,i.focusedTabId),isRTL:c,resourceStrings:a}}}),(function(e,t){return{closeTab:function(t,n){return e(Object(E.a)(t,n))},setFocusTab:function(t,n){return e(V(t,n))}}}))(Ke),ze=n("ipde"),Ue=n("Ykgg");var Ze=n("Z46F"),Je=n("mGpW"),Ye=n("sMXu"),Qe=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._makeRouterMultiSessionAware(),i}return Object(j.__extends)(t,e),t.prototype.handleClosePageInternal=function(e){var t=Object(A.a)(this.store.getState(),e.targetBrowsingContext);if(t.canBeClosed)return this.store.dispatch(Object(E.a)(Object(u.b)(this.store.getState(),t.id).id,t.id)),!0},t.prototype.handleNavigationInternal=function(e,t,n,i,s,o,r){return this.shouldPerformCtrlKeyAction(n,i)?this._navigateInNewTab(e,s,r):this.shouldPerformShiftKeyAction(n,i)?this._navigateInNewSession(e,s,r):Promise.resolve(void 0)},t.prototype._makeRouterMultiSessionAware=function(){this.context.Router.setHistoryManager(new Ue.a(this.store,this.context.TraceManager))},t.prototype._navigateInNewTab=function(e,t,n){var i=this;return t.dispatch(function(e){return{type:"router.navigateInNewTab",execute:function(t,n){var i={sessionId:Object(f.c)(t.getState())};return t.dispatch(Q(e.pageName,e.input,i)).then((function(e){return Object(q.a)(t.getState(),e).pageId}))}}}(e)).then((function(e){return{status:0,pageId:e}}),(function(e){return i._showErrorDialogByCode(t.getState,t.dispatch,e,2415919112,n).then((function(){return Promise.reject({status:1,error:e})}))}))},t.prototype._navigateInNewSession=function(e,t,n){var i=this;return t.dispatch(function(e){return{type:"router.navigateInNewSession",execute:function(t,n){var i={pageType:e.pageName,pageInput:e.input};return t.dispatch(v(i)).then((function(e){return Object(q.a)(t.getState(),e.tabId).pageId}))}}}(e)).then((function(e){return{status:0,pageId:e}}),(function(e){return i._showErrorDialogByCode(t.getState,t.dispatch,e,2415919113,n).then((function(){return Promise.reject({status:1,error:e})}))}))},t.prototype._showErrorDialogByCode=function(e,t,n,i,s){return n.errorCode===i?this._showErrorDialog(e,t,i,s):Promise.resolve()},t.prototype._showErrorDialog=function(e,t,n,i){var s="0x"+Ze.a.getHexErrorCodeFromInt(n),o="Error_Title_"+s,r="Error_Message_"+s,a=[o,r];return t(Object(Je.e)(a)).then((function(){var n=Object(_.h)()(e(),a),s=Object(_.c)(n,o),c=Object(_.c)(n,r);return t(Object(Ye.a)({title:s,text:c},{},i))}))},t}(ze.a),$e=n("eCq5"),et=n("9r0m"),tt=function(){function e(e,t){this._preventDefault=t||!1,this._inputArguments=e}return e.prototype.isDefaultPrevented=function(){return this._preventDefault},e.prototype.preventDefault=function(){this._preventDefault=!0},e.prototype.getInputArguments=function(){return this._inputArguments},e}(),nt=function(){function e(e){this._handlers=new Map,this._store=e,this._initializeHandlers()}return e.prototype._initializeHandlersForStages=function(e){var t=this;this._handlers.set(e,new Map),Object.keys(a.a).forEach((function(n){t._handlers.get(e).set(n,new Map)}))},e.prototype._initializeHandlers=function(){var e=this;Object.keys(a.b).forEach((function(t){return e._initializeHandlersForStages(t)}))},e.prototype.addHandler=function(e,t,n){var i=et.a.newGuid().guid;return this._handlers.get(e).get(t).set(i,n),i},e.prototype.removeHandler=function(e,t,n){this._handlers.get(e).get(t).delete(n)},e.prototype.executeHandlersAsync=function(e,t,n){var i=this,s=this._store.getState(),o=Object(q.d)(s).pageId,r=this._handlers.get(e).get(t);if(!r)return Promise.resolve(!0);var a=0;return Array.from(r.entries()).reduce((function(e,t){return e.then((function(e){var s=new tt(n,!e),r=new $e.a(i._store,o,null,a++,s,void 0);try{t[1](r)}catch(e){}return e&&!s.isDefaultPrevented()}))}),Promise.resolve(!0))},e}(),it=n("zk4A"),st=n("wV3W"),ot=n("yZTI"),rt=n("vO+w");var at=Object(le.a)((function(e,t){var n,i,o,r=Object(q.b)(e,t.pageId),a=r&&r.id,c=Object(st.a)(e),u=Object(rt.b)(e)?Object(rt.a)(e):null,l=Object(qe.g)(e),p=r&&!Object(ot.e)(e,r.id),d=null!==(n=null==u?void 0:u.Components.CommandBar.Command.TextColor)&&void 0!==n?n:c.colors.BaseColor.Grey.Grey7,b=null!==(i=null==u?void 0:u.Components.CommandBar.BackgroundColor)&&void 0!==i?i:"white",h=null!==(o=null==u?void 0:u.Components.CommandBar.Command.Hover.BackgroundColor)&&void 0!==o?o:"lightgray",f=h,y={borderStyle:"solid",backgroundColor:b,margin:0,width:c.sizes.Measures.Measure300,height:c.sizes.Measures.Measure300,borderWidth:l?"0 0 0 1px":"0 1px 0 0",borderColor:f,lineHeight:c.sizes.Measures.Measure300,textAlign:"center",flex:"0 0 auto",borderBottomColor:f,alignItems:"center"};return{accessibilityLabel:Object(_.b)(e,s.L),tooltip:Object(_.b)(e,s.M),tabId:a,isEnabled:p,enabledStyle:Object(j.__assign)(Object(j.__assign)({},y),{color:d,cursor:"pointer",":hover":{backgroundColor:h}}),disabledStyle:Object(j.__assign)(Object(j.__assign)({},y),{color:c.colors.BaseColor.Grey.Grey3,cursor:"default"})}}),(function(e){return{navigateBackInTab:function(t){e(Object(it.a)({targetBrowsingContext:t}))}}}))((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return ce.createElement(Te.a,{id:"navigateBackButton"+e.tabId,testhooks:{id:"navigateBackButton"+e.tabId},style:Object(j.__assign)(Object(j.__assign)({},e.isEnabled?e.enabledStyle:e.disabledStyle),e.overwriteStyle),onClick:function(){return e.navigateBackInTab(e.tabId)},accessibilityLabel:e.accessibilityLabel,title:e.tooltip,disabled:!e.isEnabled},ce.createElement(De.b,{type:He.a.BackButton,style:{width:"100%"}}))}));
/**
 * Public interface of the MultiSession feature. This feature is dynamically loaded.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */}}]),window.bundleExecutionMarkers["scripts/es5/multisession.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();