(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/officewaffle.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[92],{"4CKj":function(e,t,n){"use strict";n.r(t),n.d(t,"OfficeWaffle",(function(){return R}));var r=n("c/eZ"),a=n("nuS9"),i=n("evW+"),o=n("H/hG"),s=n("znb3"),c=n("XIN1"),f=n("4E+q"),l=n("wV3W"),u=n("YWpA"),d=n("lU69"),p=n("Zh8V"),h=n("9rQ4"),v=n("mGpW"),b=n("Ww2r"),g=n("7cIM"),m=n("qC0c"),_=n("EGsq"),O=n("7EJx");var w=n("kyRo"),W=n("hEjd"),E=n("O+GR"),T=n("VnpK"),j=n("mTVg"),y=n("vO+w"),C=Object(d.a)(),S=Object(d.a)(),x=Object(d.a)(),k=Object(d.a)(),M="Web.NavBar.AppSwitcher_Caption",H=[M];var I={color:"#FFF",fontSize:"16px",width:"100%",textAlign:"center"};function D(e){return{display:"block",position:"absolute",top:0,zIndex:2567,transition:"visibility 0s linear "+(e?0:.5)+"s,opacity 0.5s linear",visibility:e?"visible":"hidden",opacity:e?1:0}}var L=function(e){function t(t,n){var r=e.call(this,t)||this;return r._waffleToggleTimer=null,r._isOfficeDataLoaded=!1,r._keyDownHandler=r._keyDownHandler.bind(r),r._onMouseEnterHandler=r._onMouseEnterHandler.bind(r),r._onMouseLeaveHandler=r._onMouseLeaveHandler.bind(r),r._clearWaffleTimer=r._clearWaffleTimer.bind(r),r._onClickHandler=r._onClickHandler.bind(r),r._activateWaffle=r._activateWaffle.bind(r),r._deactivateWaffle=r._deactivateWaffle.bind(r),r._eventManager=n.EventManager,r.state={isWidgetOpen:!1},Object(b.c)(t.resourceStrings,M)||t.retrieveResourceStrings(H),r}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.isOfficeWaffleFCBEnabled&&this._loadOfficeData().then((function(t){try{var n=t&&JSON.parse(t);if(n)return e.context.AssetLoader.loadScript(n.js).then((function(){var t,r,a;t=n.navBarData,r=e._deactivateWaffle,a=e.props.setUserCultureInfo,window.O365Shell.SetData(JSON.parse(t)),window.O365Shell.RenderAsync({launcher:S,switcher:C},(function(){a()}),(function(){if(r){var e=document.getElementsByClassName("o365cs-nav-closeButton");e&&e.length&&e.item(0).addEventListener("click",(function(){r()}))}})),e._isOfficeDataLoaded=!0}));throw new Error("Failed to parse officeWaffleDataString")}catch(n){var r=[{name:"OfficeWaffleDataString",value:t}];e.context.EventManager.ReportComponentFailure("OfficeWaffle",n,void 0,r)}})).catch((function(t){var n=[];n.push({name:"Status",value:t.status}),n.push({name:"StatusText",value:t.statusText}),n.push({name:"ResponseText",value:t.responseText}),e.context.EventManager.ReportComponentFailure("OfficeWaffle",t,void 0,n)}))},t.prototype._loadOfficeData=function(){return new Promise((function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?e(n.responseText):t({statusText:n.statusText,status:n.status,responseText:n.responseText}))},n.open("GET","/Handlers/OfficeWaffleInfo.ashx",!0),n.send()}))},t.prototype._deactivateWaffle=function(){this.setState({isWidgetOpen:!1})},t.prototype._activateWaffle=function(){this.setState({isWidgetOpen:!0})},t.prototype._onClickHandler=function(){this._isOfficeDataLoaded?this.state.isWidgetOpen?(this._deactivateWaffle(),this._eventManager.ReportComponentSuccess("OfficeWaffle.Hide")):(this._activateWaffle(),this._eventManager.ReportComponentSuccess("OfficeWaffle.Show")):this.props.officePortalUrl?(this.props.openUrl(this.props.officePortalUrl),this._eventManager.ReportComponentSuccess("OfficeWaffle.NavigateOfficePortal.SiteWide")):(this.props.openUrl("https://go.microsoft.com/fwlink/?LinkID=246804"),this._eventManager.ReportComponentSuccess("OfficeWaffle.NavigateOfficePortal"))},t.prototype._clearWaffleTimer=function(){this._waffleToggleTimer&&(clearTimeout(this._waffleToggleTimer),this._waffleToggleTimer=null)},t.prototype._startWaffleTimer=function(e){var t=this;null===this._waffleToggleTimer&&(this._waffleToggleTimer=setTimeout((function(){t._waffleToggleTimer=null,t._waffleActive?t._startWaffleTimer(e):t._deactivateWaffle()}),e))},t.prototype._onMouseLeaveHandler=function(){this._waffleActive=!1,this._startWaffleTimer(500)},t.prototype._onMouseEnterHandler=function(){this._clearWaffleTimer(),this._waffleActive=!0},t.prototype._keyDownHandler=function(e){if(e.keyCode===h.a.Escape){this._deactivateWaffle();var t=document.getElementById(k);t&&t.focus()}},t.prototype._renderOfficeWaffle=function(e){var t,n={width:"1.143rem",height:"1.286rem"},i=Object(r.__assign)(Object(r.__assign)({},I),e?n:{});return t=e?a.createElement(j.a,{source:W.a,style:n,highContrast:this.props.isHighContrast,invert:!0}):a.createElement(c.b,{type:s.a.OfficeWaffle}),a.createElement(o.a,{style:i},t)},t.prototype.render=function(){var e,t,n,r,o,s=Object(b.c)(this.props.resourceStrings,M);return a.createElement(u.a,{onMouseLeave:this._onMouseLeaveHandler,onMouseEnter:this._onMouseEnterHandler,onKeyDown:this._keyDownHandler},a.createElement(i.a,{key:"button",id:k,testhooks:{id:"officewaffle"},style:(e=this.props,t=this.state.isWidgetOpen,n=function(e){var t=e.isPowerappsThemeEnabled,n=t?e.theme.colors.NavBar.NavBar1.Fill:"#00b7c3",r=t?e.theme.colors.NavBar.NavBar2.Fill:"#006e75";return{backgroundColor:n,backgroundHoverColor:r}}(e),r=n.backgroundColor,o=n.backgroundHoverColor,Object(p.e)({cursor:"pointer",borderWidth:0,backgroundColor:t?"#333333":r,width:e.theme.sizes.NavbarHeight,height:e.theme.sizes.NavbarHeight,display:"flex",alignItems:"center",justifyContent:"center",":focus":Object(p.d)(e.theme,e.designLanguage)},o)),title:s,accessibilityLabel:s,onClick:this._onClickHandler},this._renderOfficeWaffle(this.props.isPowerappsThemeEnabled)),a.createElement(u.a,{key:"widget",id:x,style:D(this.state.isWidgetOpen)},a.createElement(u.a,{id:C},a.createElement(u.a,{id:S}))))},t}(a.Component);L.contextType=w.a;var R=Object(f.a)((function(){var e=Object(b.h)();return function(t){var n=Object(l.a)(t),r=Object(y.b)(t)?Object(y.a)(t):null,a=e(t,H),i=Object(_.D)(t);return{theme:n,designLanguage:r,resourceStrings:a,isOfficeWaffleFCBEnabled:Object(m.b)(t,"OfficeWaffleMenu"),officePortalUrl:i,isPowerappsThemeEnabled:Object(E.h)(t),isHighContrast:Object(T.n)()}}}),(function(e){return{retrieveResourceStrings:function(t){return e(Object(v.e)(t))},openUrl:function(t){e(Object(g.a)(t))},setUserCultureInfo:function(){e({type:"set.user.culture.info",sync:!0,execute:function(e,t){try{var n=Object(O.w)(e.getState());if(!n)throw new Error("user Settings are not defined");var r=n.formatInfoCultureName,a=n.numberFormatInfo,i=n.dateFormatInfo;t.DataSource.setCurrentCultureInfo(r,a,i),t.EventManager.ReportComponentSuccess("SetUserCultureInfo",[{name:"formatInfoCultureName",value:r}])}catch(e){t.EventManager.ReportComponentFailure("SetUserCultureInfo",e)}}})}}}))(L)},hEjd:function(e,t,n){"use strict";t.a=n.p+"resources/images/OfficeWaffle.svg?v=1.4.9962-v91onpremise"},hp1u:function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return O}));var r=n("c/eZ"),a=n("nuS9"),i=n("uTTW"),o=n("S6oQ"),s=n("4E+q"),c=n("c56u"),f=n("JlqV"),l=n("EGsq"),u=n("EXRB"),d=n("7EJx"),p=n("s5BY");var h=n("kyRo"),v=n("XFxG"),b=n("8ul+"),g=n("qC0c"),m=n("cZkS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){return a.createElement(w,{imgSrc:e.source,render:function(t){return a.createElement(o.a,Object(r.__assign)({focusable:"false"},e,{source:t,altText:e.altText}))}})}function O(e){return a.createElement(w,{imgSrc:e.source,render:function(t){return a.createElement(i.a,Object(r.__assign)({},e,{source:t,altText:e.altText}))}})}function w(e){var t,n=e.imgSrc,r=e.render,i=a.useContext(h.a).AssetLoader,o=a.useState(n),_=o[0],O=o[1],w=function(e,t){return Object(s.d)((function(n){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */return function(e,t,n){var r=Object(c.w)(e),a=!Object(f.b)(e),i=Object(l.t)(e),o=Object(u.d)(e);return(r&&a||o)&&function(e,t,n){void 0===t&&(t="");var r="$webresource:",a="/webresources/",i=t.toLowerCase();return i.startsWith(r)?(n(t.substr(r.length)),!0):i.startsWith(a)?(n(t.substr(a.length)),!0):!!i.startsWith(e)&&(n(t.substr(e.length)),!0)}(i,t,n)}(n,e,t)}))}(n,(function(e){return t=e})),W=function(e){return Object(s.d)((function(t){return function(e,t){var n;if((null===(n=Object(d.w)(e))||void 0===n?void 0:n.usePathBasedUrls)&&t.toLowerCase().startsWith("/webresources/"))return Object(p.a)(e,t)}(t,e)}))}(n),E=Object(s.d)((function(e){return Object(g.b)(e,m.b)})),T=Object(s.d)(b.a);return a.useEffect((function(){w?i.loadOfflineWebResource(t).then((function(e){e&&O(v.a.createDataUri(v.b.Svg,e).toString())})):O(W||n)}),[w,W,n,t,i]),r(_,E&&T)}},mTVg:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("c/eZ"),a=n("nuS9"),i=n("TCzx"),o=n("hp1u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){var t=e.source,n=e.style;if(i.a.getInstance().get_IsBrowserIE()&&!e.useImgInIE||e.highContrast){var s=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},n),e.invert?{fill:"white"}:{}),e.highContrast?{fill:"windowText"}:{});return a.createElement(o.b,{source:t,style:s,fallbackToImage:!0,title:e.title,role:e.role,altText:e.altText})}var c=Object(r.__assign)(Object(r.__assign)({},n),e.invert?{filter:"invert(100%)"}:{});return a.createElement(o.a,{source:t,style:c,title:e.title,role:e.role,altText:e.altText})}}}]),window.bundleExecutionMarkers["scripts/es5/officewaffle.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();