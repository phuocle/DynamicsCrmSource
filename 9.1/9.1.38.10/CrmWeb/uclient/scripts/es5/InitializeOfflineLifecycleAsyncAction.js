(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/InitializeOfflineLifecycleAsyncAction.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[36,70],{"0z0R":function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var i=t("GUnN"),a=t("Ww2r"),r=t("JlqV"),c=t("kh6f"),o=t("mGpW"),s=t("Vm/X"),f=t("MLbG");function l(e,n){return{type:"offline.alert.dialog.async",execute:function(t,l){var u=t.dispatch,b=t.getState;if(Object(r.b)(b()))return c.c.info("Offline: Server is available"),Promise.resolve();var O=["Dialog_Button_Ok",e];return u(Object(o.e)(O)).then((function(){var t=Object(a.b)(b(),"Dialog_Button_Ok"),r=Object(a.b)(b(),e);return u(Object(f.a)(s.a,r,null,t,null,void 0,void 0,void 0,void 0,void 0,n)).then((function(e){return 0===e.status?(c.c.info("Offline: Alert dialog is created successfully with message "+r),Promise.resolve()):(c.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return c.c.error("Offline: Error in alert dialog creation "+Object(i.e)(e)),Promise.reject(e)}))}}}},"96h0":function(e,n,t){"use strict";t.r(n),t.d(n,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return P})),t.d(n,"initializeOfflineUpsyncProcessAsyncAction",(function(){return E}));var i=t("c/eZ"),a=t("H9DM"),r=t("GUnN"),c=t("Ww2r"),o=t("kh6f"),s=t("evh6"),f=t("MLbG"),l=t("+D0h"),u=t("mGpW"),b=t("Vm/X"),O=t("KjDZ"),d=t("WS0f");var p=t("hzb9"),y=t("pkDq"),v=t("rcZN"),S=t("ygXU"),j=t("iJR5"),h=t("VnuK"),m=t("qC0c"),g=t("cZkS"),_=t("US37"),D=t("ZaNp"),P="offline.upsync.process.async",w=null;function E(e){return void 0===e&&(e=!1),{type:P,execute:function(n,t){var a=n.dispatch,r=n.getState;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,c,o;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n=Object(v.b)(r()),e||n!==S.a.Completed?null==w?[3,2]:[4,w]:[2,Promise.resolve()];case 1:return i.sent(),[3,6];case 2:return i.trys.push([2,4,5,6]),[4,w=U(r,a,t)];case 3:return i.sent(),[3,6];case 4:throw(c=i.sent())instanceof j.a||(o=(null==c?void 0:c.message)||"Unexpected upsync error",c=j.a.FromMessage(o)),c;case 5:return w=null,[7];case 6:return[2]}}))}))}}}function A(e,n){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,a,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return Object(m.c)(e(),g.l)&&Object(D.e)(e())?(t=["offline_notification_reconnect_success_text"],[4,n(Object(u.e)(t))]):[3,2];case 1:i.sent(),a=Object(c.b)(e(),t[0]),r={id:"upsync_complete_toast",level:1,message:a,title:null,type:1,onCloseHandler:null},n(Object(_.b)(!1)),n(Object(h.b)(r)),i.label=2;case 2:return[2]}}))}))}function U(e,n,t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var v,S,j,h,m;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:v=new Date,S="Offline: Upsync",i.label=1;case 1:return i.trys.push([1,11,,12]),[4,t.OfflineProvider.hasItemsToUpsync().nativePromise()];case 2:if(!i.sent())return[3,9];o.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),n(Object(p.b)()),i.label=3;case 3:return i.trys.push([3,8,,9]),[4,t.OfflineProvider.startPlayback().nativePromise()];case 4:return j=i.sent(),n(Object(y.b)()),Object(d.a)(j)||0!==j.get_errorCount()?[3,6]:[4,A(e,n)];case 5:return i.sent(),o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict"),[3,7];case 6:o.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),n((g=String(j.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute:function(e,n){var t=e.dispatch,i=e.getState,a=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return t(Object(u.e)(a)).then((function(){var e=Object(c.e)(i(),a),n=Object(c.c)(e,"L_Show_Details_Text"),u=Object(c.c)(e,"Sync_Status_Error_Message"),p=Object(c.c)(e,"L_Last_Save_To_CRM_Server_Text"),y=Object(c.c)(e,"Sync_Status_Dialog_Title"),v=Object(c.c)(e,"Dialog_Button_Ok"),S=u+"\n"+p,j="";return j=Object(d.b)(O.a.get_OverallSyncErrorMessage())?S.replace("{0}",g):O.a.get_OverallSyncErrorMessage(),t(Object(f.a)(b.c,j,{},n,y,"",v)).then((function(e){return 0===e.status?t(Object(l.a)(e.pageId)).then((function(n){n.value.confirmed&&t(Object(s.a)("syncerror",e.pageId,null,null,null,null,null))})):(o.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return o.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(e)),Promise.reject(e)}))}})),i.label=7;case 7:return t.EventManager.ReportComponentSuccess(S),t.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+v),[2];case 8:return h=i.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),n(Object(a.b)()),t.EventManager.ReportComponentFailure(S,h),t.EventManager.ReportComponentPerformance(S,"Time Taken in ms",+new Date-+v),[2,Promise.reject(h)];case 9:return o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),n(Object(y.b)()),[4,A(e,n)];case 10:return i.sent(),[3,12];case 11:return m=i.sent(),o.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),[2,Promise.reject(m)];case 12:return[2]}var g}))}))}},AqHJ:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="offline.set.reinitializeoffline";function a(e){return{type:i,payload:{reInitializeOffline:e}}}},GBfE:function(e,n,t){"use strict";t.r(n),t.d(n,"initializeOfflineLifecycleAsyncAction",(function(){return U}));var i=t("nlyT"),a=t("pkDq"),r=t("GUnN"),c=t("c56u"),o=t("9r0m"),s=t("96h0"),f=t("He+0"),l=t("/j9Z"),u=t("gKZ6"),b=t("x9BS"),O=t("kh6f"),d=t("gFjC"),p=t("xC+Q"),y=t("L+41"),v=t("5iz+");var S=t("EGsq"),j=t("hRGi"),h=t("BvBP"),m=t("pdOk"),g=t("H/RR"),_=t("AX1v");function D(){return{type:"offline.save.sessionstate",execute:function(e,n){var t=(0,e.getState)(),i=Object(c.p)(t),a={},s={},f={},l={},u=[];return i!==_.a.Disabled?(s[g.a.OfflineProfileIdKey]=o.a.toString(j.c(t)),s[g.a.OfflineProfileVersionKey]=j.d(t),s[g.a.OfflineProfileAvailableEntitiesKey]=j.b(t),a[g.a.norsyncServerConnectionStringKey]=h.c(t),a[g.a.isTrialOrganizationKey]=h.b(t).toString(),a[g.a.isMocaOfflineFCBEnabledKey]=h.a(t).toString(),O.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+g.a.OfflineProfileDataKey),u.push(n.DataSource.saveSessionState(g.a.OfflineProfileDataKey,s,!1)),O.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+g.a.offlineDatabaseInformationKey),u.push(n.DataSource.saveSessionState(g.a.offlineDatabaseInformationKey,a,!1))):(O.c.info("Offline: OfflineSaveSessionState: Clearing the Session State"),u.push(n.DataSource.deleteSessionState(g.a.OfflineProfileDataKey)),u.push(n.DataSource.deleteSessionState(g.a.offlineDatabaseInformationKey)),u.push(n.DataSource.deleteSessionState(g.a.OfflineEntityPluralNamesKey)),u.push(n.DataSource.deleteSessionState(g.a.OfflinePrimaryAvailableEntitiesKey)),u.push(n.DataSource.deleteSessionState(m.a))),l[g.a.isMobileOfflineOptedInKey]=i.toString(),O.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+g.a.isMobileOfflineOptedInKey),u.push(n.DataSource.saveSessionState(g.a.isMobileOfflineOptedInKey,l,!1)),f[g.a.OfflineDatabaseKey]=Object(c.d)(t),O.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+g.a.OfflineDatabaseKey),u.push(n.DataSource.saveSessionState(g.a.OfflineDatabaseKey,f,!1)),Promise.all(u).then((function(){return O.c.info("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Complete"),Promise.resolve()})).catch((function(e){return O.c.error("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Failed"+Object(r.e)(e)),Promise.reject(e)}))}}}var P=t("WS0f"),w=t("JlqV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(e,n,t,a,r){var s=Object(S.m)(n),u=Object(j.e)(n),b=Object(c.p)(n),d=Object(j.c)(n);s&&b!==_.a.Disabled&&(d&&d!==o.a.EMPTY&&u?(b===_.a.Default&&t(Object(f.b)(_.a.Enabled)),t(function(e,n){return{type:"offline.schedule.datasync.async",execute:function(t,a){var r=t.dispatch,o=t.getState,s=a.OfflineProvider,f=Object(c.d)(o());if(Object(P.a)(f)){var u=Object(w.b)(o())?y.a.Initializing:y.a.NotAvailable;O.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to "+u),r(Object(i.c)(u,v.a.None))}else O.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to Available."),r(Object(i.c)(y.a.Available,v.a.None));return O.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: Schedule Periodic Sync Job started."),s.schedulePeriodicSyncJob(e,n).nativePromise().catch(l.b)}}}(a,r)),O.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is : mobileOfflineOptStatus =  "+b)):(t(Object(i.c)(y.a.NotAvailable,v.a.ProfileUnavailable)),O.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is set to "+y.a.NotAvailable)))}function A(e,n,t,a,o){var s;Object(c.c)(n)?(O.c.warn("OfflineWrapper: OfflineInitDataSync: Deleting the existing offline database as isDBCleanNeeded is true "+Object(c.d)(n)),t((s=Object(c.d)(n),{type:"offline.database.delete.async",execute:function(e,n){var t=e.dispatch;return e.getState,n.OfflineProvider.cleanUpDatabases(s).nativePromise().then((function(){t(Object(b.b)("")),t(Object(i.c)(y.a.NotAvailable,v.a.None)),t(Object(u.b)(!1)),t(Object(p.b)(null)),t(Object(d.b)(null,null,null))})).catch((function(e){return O.c.error("Offline.databaseDeleteAction: OfflineProvider.cleanUpDatabases failed with error:"+Object(r.e)(e)),Promise.reject(e)}))}})).then((function(){E(0,n,t,a,o),t(D())}),l.b)):(O.c.warn("OfflineWrapper: OfflineInitDataSync: perform offline data sync "),E(0,n,t,a,o),t(D()))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function U(e,n){return{type:"offline.init.lifecycle.async",execute:function(t,f){var l=t.dispatch,u=t.getState;return f.OfflineProvider.initializeOfflineDataSource(f.DataSource.get_UserContext()).nativePromise().then((function(){var t=u(),r=Object(w.b)(t),b=Object(c.d)(t);if(Object(c.p)(u())===_.a.Disabled||null===b||""===b||o.a.equals(o.a.parse(b),o.a.EMPTY)||l(Object(i.c)(y.a.Available,v.a.None)),null!=b){var O=function(){return!r||l(Object(s.initializeOfflineUpsyncProcessAsyncAction)()).then((function(){return A(0,u(),l,e,n),!0}))};return f.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(O,O)}return r&&(l(Object(a.b)()),A(0,u(),l,e,n)),!0})).catch((function(e){return O.c.error("OFFLINE : initializeOfflineLifecycleAsyncAction Failed"+Object(r.e)(e)),Promise.reject(e)}))}}}},H9DM:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var i=t("ygXU"),a="offline.upsync.pending";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(){var e={upSyncStatus:i.a.Pending};return{type:a,payload:e}}},"He+0":function(e,n,t){"use strict";t.d(n,"a",(function(){return O})),t.d(n,"b",(function(){return p})),t.d(n,"c",(function(){return d}));var i=t("AX1v"),a=t("gKZ6"),r=t("nlyT"),c=t("AqHJ"),o=t("kh6f"),s=t("L+41"),f=t("5iz+");var l=t("0z0R"),u=t("c56u"),b=t("JlqV"),O="offline.opt.status";function d(e){return{type:"offline.opt.status.save",execute:function(n){var t=n.dispatch,O=(0,n.getState)(),d=Object(u.p)(O)===i.a.Enabled;if(e!==d)if(e)t(p(i.a.Enabled));else{if(!Object(b.b)(O))return t(Object(l.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(a.b)(!0)),e(p(i.a.Disabled)),o.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(r.c)(s.a.NotAvailable,f.a.None)),o.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+s.a.NotAvailable),e(Object(c.b)(!0)),o.c.info("Offline: offlineDisable: disableOffline: Completed")}(t)}return Promise.resolve()}}}function p(e){return{type:O,payload:{offlineFeatureStatus:e}}}},gFjC:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="offline.disabled.entities.update";function a(e,n,t){return{type:i,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:n,offlineDisabledPrimaryEntities:t}}}},gKZ6:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="offline.database.cleanup";function a(e){return{type:i,payload:{isDbCleanupNeeded:e}}}},hzb9:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var i=t("ygXU"),a="offline.upsync.start";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(){var e={upSyncStatus:i.a.InProgress};return{type:a,payload:e}}},pkDq:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}));var i=t("ygXU"),a="offline.upsync.completed";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(){var e={upSyncStatus:i.a.Completed};return{type:a,payload:e}}},x9BS:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="offline.database.update";function a(e){return{type:i,payload:{existingDatabaseName:e}}}},"xC+Q":function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="offline.available.primary.entities.update";function a(e){return{type:i,payload:{offlineAvailablePrimaryEntities:e}}}}}]),window.bundleExecutionMarkers["scripts/es5/InitializeOfflineLifecycleAsyncAction.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();