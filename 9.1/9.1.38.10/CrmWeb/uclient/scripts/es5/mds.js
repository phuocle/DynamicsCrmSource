(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/mds.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[79,69],{"1J99":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.SendPriority=t.TracerLogLevel=void 0,function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose"}(t.TracerLogLevel||(t.TracerLogLevel={})),function(e){e[e.High=0]="High",e[e.Low=1]="Low"}(t.SendPriority||(t.SendPriority={}))},GJM4:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeAppHostClient",(function(){return h})),r.d(t,"getRootAppId",(function(){return _})),r.d(t,"getRootAppLogicalName",(function(){return O})),r.d(t,"runWindowOverrides",(function(){return E}));var n=r("c/eZ"),a=r("iyBA"),o=r("ULvN"),i=r("BZKE"),s=r("sTbl"),c=r("mePC"),u=r("9r0m"),l=r("7LuR"),d=r("4pqm"),f=r("7EJx"),p=r("mGpW"),v=r("Ww2r");function g(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function h(e){return{type:"apphostclient.initialize.async",execute:function(t,r){var a;return Object(n.__awaiter)(this,void 0,void 0,(function(){var d,h,O,E,y,w;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r.AppHostClient?[3,6]:Object(s.a)(t.getState())?[3,2]:(S=t.getState(),d=Object(s.e)(S)+"/apphost/clientsdk?version=1",[4,r.AssetLoader.loadScript(d)]);case 1:n.sent(),t.dispatch({type:i.a,payload:!0}),n.label=2;case 2:h=_(t.getState(),e),O={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:h,hostConfig:{correlationId:r.EventManager.getCurrentSessionId(),locale:Object(f.w)(t.getState()).formatInfoCultureName,source:"UCI"}},n.label=3;case 3:return n.trys.push([3,5,,6]),[4,b(r,O,9e4)];case 4:return n.sent(),r.AppHostClient.on("appHostClientErrorEvent",(j=t.dispatch,function(e){e&&e.errorInfo&&j(Object(c.b)({level:2,message:e.errorInfo.localizedMessage,id:u.a.newGuid().guid,type:2,showCloseButton:!0}))})),r.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){var r=t.notificationInfo.timeoutInMilliSec,n=u.a.newGuid().guid;e(Object(c.b)({level:g(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:n,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),r>0&&1e4!==r&&setTimeout((function(){e(Object(l.b)(n))}),r)}}}(t.dispatch)),t.dispatch({type:i.b,payload:{initialized:o.a.Initialized,error:void 0}}),[3,6];case 5:throw E=n.sent(),(null===(a=null==E?void 0:E.errorInfo)||void 0===a?void 0:a.code)?t.dispatch(m(E)):("Crm.GenericErrorMessage",y=["Crm.GenericErrorMessage"],t.dispatch(Object(p.e)(y)).then((function(){var e=Object(v.e)(t.getState(),y);t.dispatch(m({errorInfo:{code:"unknown",localizedMessage:Object(v.c)(e,"Crm.GenericErrorMessage"),timestamp:Date.now(),description:(null==E?void 0:E.message)||"Unknown error occured while initializing apphostclient"}}))}))),w=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}],r.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",E,void 0,w),E;case 6:return[2]}var j,S}))}))}}}function b(e,t,r){var n,a=new Promise((function(e,t){n=setTimeout((function(){return t({message:"PowerAppsHostingSdk.initializeAsync timed out"})}),r)})),o=PowerAppsHostingSdk.initializeAsync(t).then((function(t){clearTimeout(n),e.AppHostClient=t}));return Promise.race([o,a])}function m(e){return{type:i.c,payload:{initialized:o.a.Initialize_Failed,error:e}}}function _(e,t){return Object(a.e)(e,"rootAppId")||t}function O(e,t){return Object(a.b)(e,"appLogicalName")||t}function E(e){var t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;var r=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var e=this,n=arguments[0],a=arguments[1],o=arguments[2];if(!1===o){var i=[{name:"url",value:a}];t.error("Sync call attempted",i)}var s=arguments[1].indexOf("/webresources/");if(-1!==s){var c=a.slice(s+"/webresources/".length);a=Object(d.b)()+"/api/data/v9.0/webresourceset?$filter=name eq '"+c+"'&$select=content";var u=this.onload;this.onload=function(){var t;try{var r=JSON.parse(e.responseText);e._responseText=atob(null===(t=null==r?void 0:r.value[0])||void 0===t?void 0:t.content)}catch(e){}u(e)}}-1===a.indexOf("https://")&&(a=Object(d.b)()+a),r.call(this,n,a)},window.fetch=function(e){return new Promise((function(t,r){var n=new XMLHttpRequest;n.open(e.method,e.url),e.headers.forEach((function(e,t){n.setRequestHeader(t,e)})),n.onload=function(){var e=204===n.status?null:n.response||n.responseText,r=new Headers;n.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(e){var t=e.split(": ");r.append(t.shift(),t.join(": "))}));var a=new Response(e,{status:n.status,statusText:n.statusText,headers:r});t(a)},n.onerror=function(){r("Error")},e.text().then((function(e){n.send(e)}))}))}}},RNNy:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="systemuser",a="transactioncurrency"},YNHZ:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleTraceManager=void 0;var n=r("1J99"),a=r("Y0ua"),o=r("r1Pe"),i=function(){function e(){}return e.prototype.getTracer=function(e){return new o.ConsoleTracer(e||a.MDL_COMPONENT_NAME)},e.prototype.getLogLevel=function(e){return n.TracerLogLevel.Info},e.prototype.setLogLevel=function(e,t){},e.prototype.addDefaultTransport=function(e){},e.prototype.setTraceAreas=function(e){},e}();t.ConsoleTraceManager=i},krdR:function(e,t,r){"use strict";r.r(t),r.d(t,"initializeExpressionRuntime",(function(){return xr})),r.d(t,"initializeRetrieveMultipleCache",(function(){return Lr})),r.d(t,"initializeRetrieveCache",(function(){return Ur})),r.d(t,"execute",(function(){return kr})),r.d(t,"executeOData",(function(){return qr})),r.d(t,"retrieve",(function(){return Br})),r.d(t,"retrieveMultiple",(function(){return Zr})),r.d(t,"getClientMetadata",(function(){return $r})),r.d(t,"getUserContext",(function(){return tn}));var n=r("c/eZ"),a=r("iDqy"),o=r.n(a),i=r("u5k1"),s=r("YNHZ"),c=r("pqvw"),u=r("Wysk"),l=r("cZkS"),d=r("qC0c"),f=r("7pqb"),p=r("5Ez/"),v=r("QAhb"),g=r("9r0m"),h=r("WS0f"),b=r("j+Rs"),m=r("CqBl"),_=r("Ev4I"),O=r("L6jw"),E=r("stsV"),y=r("So/t"),w=r("Xlzu"),j=r("GJM4");function S(e){var t;return null===(t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e.metadata.rootCanvasApp}(e))||void 0===t?void 0:t.dataComponentApp}function R(e){var t;return null===(t=S(e))||void 0===t?void 0:t.name}function T(e){var t;return null===(t=S(e))||void 0===t?void 0:t.appMetadata}function C(e){var t;return null===(t=S(e))||void 0===t?void 0:t.dependencyInfo}var I=r("drK5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e,t){return{type:"retrieveDataComponentDependencyInfo.async",execute:function(r,a){var o=r.dispatch,i=r.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a,s,c,u,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(n.trys.push([0,3,,4]),r=i(),a=C(r))return[2];if(!e)throw new Error("Failed to get the url of data component metadata");return s=R(r)||"DataComponentApp",[4,fetch(e)];case 1:if(!(c=n.sent()).ok)throw new Error("Failed to fetch dependency info with statusCode "+c.status);return[4,c.json()];case 2:return a=n.sent(),o(Object(I.d)({dataComponentApp:{name:s,dependencyInfo:a}})),[3,4];case 3:throw u=n.sent(),l=u&&u.message?u.message:"Unexpected dependency info retrieval error",t.error("Failed to retrieve dependency info with error "+l),new Error(l);case 4:return[2]}}))}))}}}function P(e,t){var r=R(e);return Object(I.d)({dataComponentApp:{name:r,expressionRuntimeInitialized:t}})}var M=r("gBKR"),D=r("vt+k");r("bJoW"),r("KWhM"),r("U63D"),r("fQmn"),r("zdcu"),r("PhvO"),r("q+ld"),r("UtS4"),r("pk2X"),r("8wap"),r("c/Zm"),r("RW+Y"),r("/Q+U"),r("KRVQ"),r("MDAR"),r("/hD5"),r("JNvc"),r("9RRL"),r("A0z+"),r("E3G1"),r("0tkQ"),r("iIcs"),r("Ev0r");function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function L(e,t,r){return(L=A()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&H(a,r.prototype),a}).apply(null,arguments)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var k=Symbol("Comlink.proxy"),F=Symbol("Comlink.endpoint"),q=Symbol("Comlink.releaseProxy"),G=new WeakSet,z=new Map([["proxy",{canHandle:function(e){return e&&e[k]},serialize:function(e){var t=new MessageChannel,r=t.port1,n=t.port2;return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:self;r.addEventListener("message",(function n(a){if(a&&a.data){var o,i=Object.assign({path:[]},a.data),s=i.id,c=i.type,u=i.path,l=(a.data.argumentList||[]).map(Z);try{var d=u.slice(0,-1).reduce((function(e,t){return e[t]}),t),f=u.reduce((function(e,t){return e[t]}),t);switch(c){case 0:o=f;break;case 1:d[u.slice(-1)[0]]=Z(a.data.value),o=!0;break;case 2:o=f.apply(d,l);break;case 3:o=X(L(f,U(l)));break;case 4:var p=new MessageChannel,v=p.port1,g=p.port2;e(t,g),o=W(v,[v]);break;case 5:o=void 0}}catch(e){o=e,G.add(e)}Promise.resolve(o).catch((function(e){return G.add(e),e})).then((function(e){var t=x(K(e),2),a=t[0],o=t[1];r.postMessage(Object.assign(Object.assign({},a),{id:s}),o),5===c&&(r.removeEventListener("message",n),B(r))}))}})),r.start&&r.start()}(e,r),[n,[n]]},deserialize:function(e){return e.start(),V(e)}}],["throw",{canHandle:function(e){return G.has(e)},serialize:function(e){var t=e instanceof Error,r=e;return t&&(r={isError:t,message:e.message,stack:e.stack}),[r,[]]},deserialize:function(e){if(e.isError)throw Object.assign(new Error,e);throw e}}]]);function B(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function V(e){return function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=!1,a=new Proxy((function(){}),{get:function(o,i){if(J(n),i===q)return function(){return $(t,{type:5,path:r.map((function(e){return e.toString()}))}).then((function(){B(t),n=!0}))};if("then"===i){if(0===r.length)return{then:function(){return a}};var s=$(t,{type:0,path:r.map((function(e){return e.toString()}))}).then(Z);return s.then.bind(s)}return e(t,[].concat(U(r),[i]))},set:function(e,a,o){J(n);var i=x(K(o),2),s=i[0],c=i[1];return $(t,{type:1,path:[].concat(U(r),[a]).map((function(e){return e.toString()})),value:s},c).then(Z)},apply:function(a,o,i){J(n);var s=r[r.length-1];if(s===F)return $(t,{type:4}).then(Z);if("bind"===s)return e(t,r.slice(0,-1));var c=x(Y(i),2),u=c[0],l=c[1];return $(t,{type:2,path:r.map((function(e){return e.toString()})),argumentList:u},l).then(Z)},construct:function(e,a){J(n);var o=x(Y(a),2),i=o[0],s=o[1];return $(t,{type:3,path:r.map((function(e){return e.toString()})),argumentList:i},s).then(Z)}});return a}(e)}function J(e){if(e)throw new Error("Proxy has been released and is not useable")}function Y(e){var t,r=e.map(K);return[r.map((function(e){return e[0]})),(t=r.map((function(e){return e[1]})),Array.prototype.concat.apply([],t))]}var Q=new WeakMap;function W(e,t){return Q.set(e,t),e}function X(e){return Object.assign(e,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},k,!0))}function K(e){var t=!0,r=!1,n=void 0;try{for(var a,o=z[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=x(a.value,2),s=i[0],c=i[1];if(c.canHandle(e)){var u=x(c.serialize(e),2);return[{type:3,name:s,value:u[0]},u[1]]}}}catch(e){r=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw n}}return[{type:0,value:e},Q.get(e)||[]]}function Z(e){switch(e.type){case 3:return z.get(e.name).deserialize(e.value);case 0:return e.value}}function $(e,t,r){return new Promise((function(n){var a=new Array(4).fill(0).map((function(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)})).join("-");e.addEventListener("message",(function t(r){r.data&&r.data.id&&r.data.id===a&&(e.removeEventListener("message",t),n(r.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:a},t),r)}))}var ee=r("WJKI"),te=r("SK9B"),re=r("9PvT"),ne=r("lMVv"),ae=r("7WOp");function oe(e){if(!e)return null;var t=e.substring(e.lastIndexOf("/")+1),r=t.indexOf("("),n=t.indexOf("?"),a=-1;return r>0&&n>0?a=Math.min(r,r):r>0?a=r:n>0&&(a=n),a>0?t.substring(0,a):t}var ie=r("TCcM"),se=r("hFf+"),ce=r("t8f4"),ue=r("SApI"),le=r("H9Ho");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function de(e,t,r){var n=Object(ae.d)(r);if(t[n]){var a=Object(b.b)(t[n]);if(a)return new v.a(Object(ne.n)(e,a[0]),new g.a(a[1]))}return null}function fe(e,t,r){var n=Object(re.l)(r),a=Object(re.k)(n),o=t[n],i=t[a];return o&&i?new v.a(i,new g.a(o)):null}function pe(e,t,r){return t&&t[r]&&t[r].reference?t[r].reference:null}function ve(e,t,r,a,o){var i;return Object(n.__awaiter)(this,void 0,void 0,(function(){var s,c,u,l,d,f,p,v,g;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(s=function(e){switch(e.method){case"DELETE":return"OnDelete";case"PATCH":return"OnUpdate";case"POST":return"OnCreate";default:return null}}(r),c={},!(u=s&&(null===(i=null==a?void 0:a.queryOptions)||void 0===i?void 0:i[s])))return[3,2];for(f in l=[],d=[],u)(p=u[f=f]).dependencyType||(p.dependencyType="OldRecord"===f?D.c.ExistingData:D.c.NewData),l.push(ge(e,t,r,p,o)),d.push(f);return[4,Promise.all(l)];case 1:for(v=n.sent(),g=0;g<v.length;g++)c[d[g]]=v[g];n.label=2;case 2:return[2,c]}}))}))}function ge(e,t,r,a,o){return!a||Object(le.a)(a.dependencyType)?Promise.resolve({}):a.dependencyType===D.c.NewData?function(e,t,r,a,o){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return i={},s=r.body?JSON.parse(r.body):{},a.expands?(c=Object.entries(a.expands),[4,he(e,t,i,de,c,s,o)]):[3,2];case 1:i=n.sent(),n.label=2;case 2:return[2,i]}}))}))}(e,t,r,a,o):function(e,t,r,a,o,i){void 0===i&&(i=!0);return Object(n.__awaiter)(this,void 0,void 0,(function(){var s,c,u,l,d,f,p,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(!(s=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(!e||!t)return null;var r=t.substring(t.lastIndexOf("/")+1),n=r.indexOf("("),a=r.substring(0,n),o=r.substring(n+1,r.indexOf(")"));if(!a||!o)return null;var i=Object(ne.n)(e,a);return new v.a(i,new g.a(o))}(e,r.urlParameters)))throw new Error("Failed to get identifier from the urlParameters for old record");return c=Object(ie.h)(e,s.etn,s.id.guid),p=(a.selects||[]).map((function(e){return Object(re.g)(e)})),i&&c&&function(e,t){if(!(null==e?void 0:e.fields))return!1;for(var r=0,n=t;r<n.length;r++){var a=n[r];if(!e.fields.hasOwnProperty(a))return!1}return!0}(c,p)?(l=function(e,t,r,n){var a={};r.forEach((function(e){a[e]=t.fields[e]}));var o=se.a.recordDataToLegacyEntityRecord(e,t.identifier,a,null,n,ie.a.LastValid);return Object(ae.b)(e,o,1)}(e,c,p,o),u=c.fields,d=pe,f=a.expands?Object.entries(a.expands):[],[3,3]):[3,1];case 1:return[4,be(t,s,a,o,!0)];case 2:l=n.sent(),u=l,d=fe,f=a.expands?Object.entries(a.expands).filter((function(e){return e[1].expands})):[],n.label=3;case 3:return h=me(l,a),f.length>0?[4,he(e,t,h,d,f,u,o)]:[3,5];case 4:h=n.sent(),n.label=5;case 5:return[2,h]}}))}))}(e,t,r,a,o)}function he(e,t,r,a,o,i,s){return Object(n.__awaiter)(this,void 0,void 0,(function(){var c,u,l,d,f,p,v;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:c=0,u=o,n.label=1;case 1:return c<u.length?(l=u[c],d=l[0],f=l[1],(p=a(e,i,d))?[4,be(t,p,f,s)]:[3,3]):[3,5];case 2:return v=n.sent(),r[d]||(r[d]={}),Object.assign(r[d],me(v,f)),[3,4];case 3:s.warn(ft()+" Lookup record is not available for expand "+d),n.label=4;case 4:return c++,[3,1];case 5:return[2,r]}}))}))}function be(e,t,r,a,o){return void 0===o&&(o=!1),Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s,c,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(null===(i=function(e,t){void 0===t&&(t=!1);var r=e.selects||[];t&&e.expands&&(r=r.concat(Object.keys(e.expands).map((function(e){return Object(re.l)(e)}))));return function(e,t){var r=function(e){if(Object(le.a)(e))return"";var t=Object.entries(e).map((function(e){return[e[0],e[1].selects]})).filter((function(e){e[0];return!!e[1]})).map((function(e){return e[0]+"("+_e(e[1])+")"}));return t.length>0?"&$expand="+t.join(","):""}(t);if(0===e.length){if(""===r)return null;e.push(Object(re.l)(Object.keys(t)[0]))}return"?"+_e(e)+r}(r,e.expands)}(r,o)))return a.warn(ft()+" Return empty object for expand with empty selects and expands for entity("+t.id.guid+")"),[2,{}];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e(Object(ce.d)(t,i))];case 2:return[2,n.sent()];case 3:throw s=n.sent(),c=s&&s.message?s.message:"Unexpected retrieval error",u="Failed to retrieve entity "+t.etn+"("+t.id.guid+") with message: "+c,new Error(u);case 4:return[2]}}))}))}function me(e,t){var r={};return t.selects&&t.selects.forEach((function(t){if(!Object(le.a)(e[t])){if(Object(ue.f)(t)){var n=Object(re.k)(t);Object(le.a)(e)||(r[n]=e[n])}r[t]=e[t]}})),t.expands&&Object.keys(t.expands).forEach((function(n){if(!Object(le.a)(e[n])){var a=me(e[n],t.expands[n]);r[n]=a}})),r}function _e(e){return"$select="+e.join(",")}var Oe=r("THEJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ee(e){return null==e?void 0:e.webPlayerPackageDetails.host}var ye={getDataComponentDependencyInfo:function(e){var t;if(e){var r=e.webPlayerPackageDetails.host,n=e.webPlayerPackageDetails.queryString,a=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.metadata;if(r&&n&&a){var o=a.filter((function(e){return e.endsWith("dependencyInfo.json")}));if(o.length>0)return we(r,o[0],n)}}return null},getDataComponentScripts:function(e){var t,r,n;if(e){var a=Ee(e),o=e.webPlayerPackageDetails.queryString,i=null===(r=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.expressionRuntime)||void 0===r?void 0:r["/js/expressionruntime.js"],s=null===(n=null==e?void 0:e.dataComponentPackageDetails)||void 0===n?void 0:n.scripts;if(a&&o&&i&&s){var c=[i];return c=(c=c.concat(s.map((function(e){return we(a,e,o)})))).map((function(e){return function(e){var t=e.indexOf("://");if(t>0)return e.substr(t+1);return"//"+e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e)}))}}return null},getDataComponentPackageHostName:Ee};function we(e,t,r){return e.endsWith("/")||(e+="/"),r.startsWith("?")||(r="?"+r),""+e+t+r}function je(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r="",t||(t="batch_"+(new Date).getTime()),a=0,n.label=1;case 1:return a<e.length?(o=e[a],r+="--"+t+"\n",i="",Array.isArray(o)?[4,Se(s="changeset_"+t+"-"+a,o)]:[3,3]):[3,7];case 2:return i=n.sent(),r+="Content-Type: multipart/mixed;boundary="+s+"\n",[3,5];case 3:return[4,Re(o)];case 4:i=n.sent(),r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",n.label=5;case 5:r+="\n",r+=i,r+="\n",n.label=6;case 6:return a++,[3,1];case 7:return c="--"+t+"--\r\n\0",r.endsWith(c+"\n")?r=r.substr(0,r.length-1):r+=c,[2,function(e,t,r){var n,a=[].concat.apply([],e).filter((function(e){return!e.ok})),o=!0,i=200,s="OK";a.length>0&&(o=!1,i=a[0].status,s=a[0].statusText);return{ok:o,status:i,statusText:s,json:function(){return Promise.resolve(t||{})},text:function(){return Promise.resolve(t||"")},headers:new ee.a((n={},n[te.c.CONTENT_TYPE]="multipart/mixed;boundary="+r,n)),url:"$batch"}}(e,r,t)]}}))}))}function Se(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:r="",a=1,o=0,i=t,n.label=1;case 1:return o<i.length?(s=i[o],r+="--"+e+"\n",r+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",s.ok?r+="Content-ID: "+a+"\n":r+="Content-ID: "+s.headers.get("Content-ID"),a++,c=r+="\n",[4,Re(s)]):[3,4];case 2:r=c+n.sent(),r+="\n",n.label=3;case 3:return o++,[3,1];case 4:return[2,r+="--"+e+"--\n"]}}))}))}function Re(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t="HTTP/1.1 "+e.status+" "+e.statusText+"\n",e.headers.forEach((function(e,r){["REQ_ID","Content-Type","Preference-Applied","OData-EntityId","Location"].indexOf(r)>0&&(t+=r+": "+e+"\n")})),"application/json"!==e.headers.get("Content-Type")?[3,2]:[4,e.json()];case 1:r=n.sent(),t+="\n"+JSON.stringify(r),n.label=2;case 2:return[2,t]}}))}))}var Te=r("2IT6"),Ce=r("s5BY"),Ie=r("8ul+"),Ne=r("kKUv"),Pe=r("Ia1G"),Me=r("JlqV"),De=r("Kn4q"),xe=r("Auxa"),Ae=r("DgF7"),Le=r("4tno"),He=r("NxDw"),Ue=r("GUOP"),ke=r("6BA3"),Fe=r("k78Z"),qe=r("C8Q/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * NOTE: ODataBuilder should ONLY be referenced from other ModernDataLayer files and NOT from "generic" UCI files.
 *       This avoids having ODataBuilder being incorrectly bundled into app.js (which should only contains files needed for
 *       boot) If there is functionality needed else where, then those functions should be moved into there own file so the whole
 *       ODatabuilder does NOT need to be referenced.
 */
function Ge(e){return{type:"odatabuilder.fromquerystate.async",execute:function(t,r){var n,a,o=t.getState,i=r.TraceManager.getTracer(Oe.e.ODataBuilder);i.info(Ze()+" Create a SerializedRequest from Query State.");var s=e.viewId&&g.a.toString(e.viewId),c={urlParameters:Object(ne.o)(o(),e.entityLogicalName)+"?fetchXml="+encodeURIComponent(e.fetchXml),additionalHeaders:(n={},n[te.c.PREFER]=te.d.ANNOTATIONS,n[te.c.ACCEPT]=te.d.APPLICATION_JSON,n[te.c.SOURCE_ID]=s,n),method:"GET",additionalParameters:(a={},a[ke.a.TYPE]=ke.c.RETRIEVE_MULTIPLE,a[ke.a.SUB_TYPE]=e&&e.queryContext?e.queryContext:ke.b.RetrieveMultipleOther,a[Oe.b]=e.entityLogicalName,a)};try{!function(e,t,r){r.info(Ze()+" Adding hints to Serialized Request."),t.viewId&&(e.additionalHeaders[te.c.VIEW_ID_HINT]=g.a.toString(t.viewId));t.pageSize&&(e.additionalHeaders[te.c.PAGESIZE_HINT]=t.pageSize.toFixed());t.pageNumber&&(e.additionalHeaders[te.c.PAGE_NUMBER_HINT]=t.pageNumber.toFixed());t.searchString&&(e.additionalHeaders[te.c.SEARCH_HINT]=t.searchString);t.expression&&(e.additionalHeaders[te.c.FILTER_HINT]=Object(qe.c)(t.expression));t.sorts&&t.sorts.length>0&&(e.additionalHeaders[te.c.ORDERBY_HINT]=t.sorts.toString());t.selects&&t.selects.length>0&&(e.additionalHeaders[te.c.SELECT_HINT]=t.selects.toString());t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[te.c.LINK_HINT]=t.linkEntities.toString());t.contextFiltersAndIds&&t.contextFiltersAndIds.length>0&&(e.additionalHeaders[te.c.CONTEXT_FILTER]=t.contextFiltersAndIds.toString())}(c,e,i)}catch(e){i.error(Ze()+" Adding hints to the serialized request from the query state failed with error: "+(null==e?void 0:e.message)+".")}return Promise.resolve(Je(o(),r,c,i))}}}function ze(e,t){return{type:"odatabuilder.fromodatacontract.async",execute:function(r,a){var o=r.getState,i=r.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(r=a.TraceManager.getTracer(Oe.e.ODataBuilder)).info(Ze()+" Create a SerializedRequest from OData Contract."),s=o(),[4,Object(y.c)(e)];case 1:return n.sent(),"ExecuteMultiple"!==e.getMetadata().operationName?[3,3]:[4,i(Be(e,t))];case 2:return c=n.sent(),[3,4];case 3:(c=Object(Ne.a)(s,e)).expressionRuntimeSupportedRequest=function(e){var t;return!!(null===(t=S(e))||void 0===t?void 0:t.expressionRuntimeInitialized)}(s)&&function(e,t){return function(e){switch(e.method){case"DELETE":case"PATCH":return!0;case"POST":return"$batch"!==e.urlParameters;default:return!1}}(t)&&!!tt(e,t)}(s,c),n.label=4;case 4:return[2,Promise.resolve(Je(s,a,c,r))]}}))}))}}}function Be(e,t){return{type:"odatabuilder.fromexecutemutipleodatacontract.async",execute:function(r,a){var o=r.getState,i=r.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,a,s,c,u,l,d,f=this;return Object(n.__generator)(this,(function(p){switch(p.label){case 0:return r=e.requests,a=!1,s=t===De.a.Default&&Object(Fe.g)(o()),c=!1,u=r.map((function(e){return Object(n.__awaiter)(f,void 0,void 0,(function(){var t,r=this;return Object(n.__generator)(this,(function(u){switch(u.label){case 0:return Object(Ne.e)(e)?[4,i(ze(e))]:[3,2];case 1:return(t=u.sent()).expressionRuntimeSupportedRequest&&(a=!0),s&&(c=c||We(o(),t)),[2,t];case 2:if(Object(Ne.d)(e))return[2,Promise.all(e.map((function(e){return Object(n.__awaiter)(r,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,i(ze(e))];case 1:return(t=r.sent()).expressionRuntimeSupportedRequest&&(a=!0),s&&(c=c||We(o(),t)),[2,t]}}))}))})))];u.label=3;case 3:throw Error("value should be of type OData contract or Changeset")}}))}))})),[4,Promise.all(u)];case 1:return l=p.sent(),a?(d=Object(xe.b)("")).requests=l:d=Object(xe.a)(o(),l),d.expressionRuntimeSupportedRequest=a,s&&(c?(d.additionalHeaders[te.c.EXECUTION_HINT]=te.b.OFFLINE,d.additionalParameters[Oe.d]=!0):d.additionalHeaders[te.c.EXECUTION_HINT]=te.b.ONLINE),[2,d]}}))}))}}}function Ve(e,t){return{type:"odatabuilder.fromfunctionalodatacontract.async",execute:function(r,n){var a=r.getState,o=n.TraceManager.getTracer(Oe.e.ODataBuilder);o.info(Ze()+" Create a SerializedRequest from a functional OData Contract.");var i=Object(Pe.a)(a(),e);return Promise.resolve(Je(a(),n,i,o,t))}}}function Je(e,t,r,n,a){var o;n.info(Ze()+" Add Headers to Serialized Request"),Object(h.a)(r.additionalHeaders)&&(r.additionalHeaders={}),function(e,t,r){var n=Object(Ie.a)(e);if(n){var a="Bearer "+n;t.additionalHeaders[te.c.AUTHORIZATION_HEADER]=a}else r.warn(Ze()+" Authorization token is null or empty ")}(e,r,n),Object(h.a)(r.additionalHeaders[te.c.CONTENT_TYPE])&&(r.additionalHeaders[te.c.CONTENT_TYPE]=te.d.APPLICATION_JSON),Object(Te.d)(r);var i=Object(Le.i)(e);r.additionalHeaders[te.c.APP_ID]=null!=i?i:"";var s=Object(Le.m)(e);r.additionalHeaders[te.c.APP_NAME]=null!=s?s:"",r.additionalHeaders.hasOwnProperty(te.c.CLIENT_REQUEST_ID)||(r.additionalHeaders[te.c.CLIENT_REQUEST_ID]=g.a.newGuid().guid);var c=((o={})[te.c.SESSION_ID]=t.EventManager.getCurrentSessionId(),o[te.c.ACTIVITY_ID]=t.EventManager.getActivityId(),o);Object.assign(r.additionalHeaders,c);var u=Object(Ue.b)(e);r.additionalHeaders[te.c.OBJECT_ID]=null!=u?u:"";var l=Object(Ue.a)(e);r.additionalHeaders[te.c.TENANT_ID]=null!=l?l:"";var d=function(e,t){var r=Object(Ae.a)(e),n=Object(Ae.d)(e),a=r===He.a.Browser?n:n+" - "+Object(Ae.g)(e)+" - "+Object(Ae.j)(e);return"PowerApps-UCI/"+window.VERSION_NUMERIC_VALUE+" ("+a+"; AppName="+t+")"}(e,s);return r.additionalHeaders[te.c.USER_AGENT]=d,Qe(r,e,n,a),Ye(e,r),r}function Ye(e,t){if(!Object(h.a)(t.urlParameters)){var r=t.endpoint||te.e,n=Object(Ce.a)(e,r);t.urlParameters=""+n+t.urlParameters,t.urlParameters=t.urlParameters.replace(/\t|\r|\n/g,"")}}function Qe(e,t,r,n){var a="remote";Object(h.a)(n)||(n===De.a.Local?a="local":n===De.a.Remote?a="remote":r.warn(Ze()+" Unsupported retrieval strategy "+De.a[n]+". Falling back to "+a)),Object(h.a)(t)||Object(Me.b)(t)||(r.warn(Ze()+' ClientType overridden to be "local" in request\'s header'),a="local"),r.info(Ze()+" ClientType added to request's header is "+a),Object(h.a)(e.additionalHeaders)&&(e.additionalHeaders={}),e.additionalHeaders.clientType=a}function We(e,t){if(t.urlParameters.includes("$batch"))return!0;var r=function(e,t){var r=oe(t);return r&&Object(ne.n)(e,r)}(e,t.urlParameters);return r&&Object(_.l)(e,r)}function Xe(e,t,r){return{type:"odatabuilder.togcmresponse.async",execute:function(a,o){a.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(Te.g)(e,r)];case 1:return(a=n.sent()).Metadata?[2,Ke(a.Metadata,t,r)]:[2,a]}}))}))}}}function Ke(e,t,r){return r&&r.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse"),t?e&&e.OtherMetadata?function(e,t){t&&t.AppendCallStack("OdataBuilder.parseGetClientMetadataExResponse");e.OtherMetadata;var r=Object(n.__rest)(e,["OtherMetadata"]),a=JSON.parse(e.OtherMetadata);if(Object.assign(r,a),r.Entities){var o=[];r.Entities.forEach((function(e){var t=Object(n.__assign)(Object(n.__assign)({},e.EntityMetadata),e.AttributeNames);o.push(t)})),r.Entities=o}if(r.RelationshipNavigationEntities){var i=[];r.RelationshipNavigationEntities.forEach((function(e){var t=Object(n.__assign)(Object(n.__assign)({},e.EntityMetadata),e.AttributeNames);i.push(t)})),r.RelationshipNavigationEntities=i}return r}(e,r):[]:JSON.parse(e)}function Ze(e){return"["+(e||Oe.f.ODataBuilder)+"]"}function $e(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[te.c.CLIENT_REQUEST_ID])||Te.c.UNKNOWN}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function et(e){var t={};return e.forEach((function(e,r){t[r]=e})),t}function tt(e,t){var r=oe(t.urlParameters);return r?function(e,t){var r;return null===(r=C(e))||void 0===r?void 0:r[t]}(e,r):null}function rt(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,o,i,s,c,u,l,d,f,p,v,g,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:a=e.requests,o=[],i=nt(e),s=0,c=null,u=0,l=a,n.label=1;case 1:return u<l.length?(d=l[u],f=void 0,Array.isArray(d)?[3,3]:[4,at(d,t,r)]):[3,10];case 2:return(f=n.sent()).contextRetrievalFailure&&(c=f.contextRetrievalFailure),[3,8];case 3:p=d,v=[],g=0,n.label=4;case 4:return g<p.length?[4,at(p[g],t,r)]:[3,7];case 5:if((h=n.sent()).contextRetrievalFailure)return c=h.contextRetrievalFailure,s=g+1,[3,7];v.push(h),n.label=6;case 6:return g++,[3,4];case 7:f={requests:v},n.label=8;case 8:if(c)return[3,10];o.push(f),n.label=9;case 9:return u++,[3,1];case 10:return o.length>0&&(i.requests=o),c&&(i.contextRetrievalFailure=c,s>0&&(i.contextRetrievalFailure.contentID=s)),[2,i]}}))}))}function nt(e){var t=e.body?JSON.parse(e.body):{},r=(t.statecode,Object(n.__rest)(t,["statecode"]));return{url:"/"+e.urlParameters,method:e.method,headers:e.additionalHeaders,responseType:"json",bodyData:JSON.stringify(r)}}function at(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(a=nt(e),!(o=tt(t.getState(),e)))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,ve(t.getState(),t.dispatch,e,o,r)];case 2:return i=n.sent(),a.context=i,(s=[]).push({name:te.c.CLIENT_REQUEST_ID,value:$e(e)}),s.push({name:Oe.c.RUNTIME_CONTEXT,value:JSON.stringify(ot(a.context))}),r.warn(ft()+" ExpressionRuntime handling "+e.method+" request "+Te.c.trimUrl(a.url),s),[3,4];case 3:return c=n.sent(),a.contextRetrievalFailure={message:"The context building for the data component failed. Error Message: "+c.message},[3,4];case 4:return[2,a]}}))}))}function ot(e){var t={};for(var r in e){var n=e[r];t[r]=it(n)}return t}function it(e){var t=[];for(var r in e){var n=e[r],a="";a=n instanceof Object?r+"("+it(n)+")":r,t.push(a)}return t.join(",")}function st(e,t,r,a){var o,i=r||e.response,s=e.status>=200&&e.status<300;return a=a||te.d.APPLICATION_JSON,{ok:s,status:e.status,statusText:s?"OK":"",json:function(){return Promise.resolve(i||{})},text:function(){return Promise.resolve(i?JSON.stringify(i):"")},headers:new ee.a(Object(n.__assign)(Object(n.__assign)({},e.headers),(o={},o[te.c.CONTENT_TYPE]=a,o))),url:t.url}}function ct(e,t,r,n,a){var o;n.error(ft()+" "+e);var i={error:{code:-2147220891,message:e,innererror:{message:e}}},s=new ee.a(((o={})[te.c.CONTENT_TYPE]=te.d.APPLICATION_JSON,o));if(a)for(var c in a)s.has(c)||s.append(c,a[c]);return{ok:!1,status:t,statusText:"",json:function(){return Promise.resolve(i||{})},text:function(){return Promise.resolve(i?JSON.stringify(i):"")},headers:s,url:r}}function ut(e,t,r,a){var o;return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s,c,u,l,d,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return"POST"===e.method&&(null===(o=e.urlParameters)||void 0===o?void 0:o.includes("$batch"))&&e.requests?[4,rt(e,r,a)]:[3,4];case 1:return i=n.sent(),s=[],i.contextRetrievalFailure&&(c=void 0,i.contextRetrievalFailure.contentID&&(c={"Content-ID":""+i.contextRetrievalFailure.contentID}),u=ct(i.contextRetrievalFailure.message,500,i.url,a,c),i.contextRetrievalFailure.contentID?s.push([u]):s.push(u)),i.requests?(a.warn(ft()+" ExpressionRuntime handling batch request"),[4,t(i)]):[3,3];case 2:l=n.sent(),d=l.responses.map((function(e,t){var r=i.requests[t];if(e.hasOwnProperty("responses")){var n=r;return e.responses.map((function(e,t){return st(e,n.requests[t])}))}return st(e,r)})),s=l.status>=200&&l.status<300?d.concat(s):d,n.label=3;case 3:return 0===s.length?[2,ct("Failed to build batch response on empty response array",400,"$batch",a)]:[2,je(s)];case 4:return[4,at(e,r,a)];case 5:return(i=n.sent()).contextRetrievalFailure?[2,ct(i.contextRetrievalFailure.message,500,i.url,a)]:(a.warn(ft()+" ExpressionRuntime handling "+i.method+" request "+Te.c.trimUrl(i.url)),[4,t(i)]);case 6:return(f=n.sent())?[2,st(f,i)]:(a.warn(ft()+" ExpressionRuntime return null for "+i.method+" request "+Te.c.trimUrl(i.url)),[2,null])}}))}))}function lt(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,s,c,u,l,d,f,p,v,g=this;return Object(n.__generator)(this,(function(h){switch(h.label){case 0:return i=new Worker("/uclient/expressionruntimehost.js"),s=V(i),i.onerror=function(e){e.stopImmediatePropagation(),a.error(ft()+" Disabling ExpressionRuntime due to error: "+e.message,[{name:"ErrorEvent",value:JSON.stringify(e)}]),s=null},c=Object(j.getRootAppLogicalName)(r.getState()),u=Object(j.getRootAppId)(r.getState()),l=["Expressionruntime.js","init.js"],d="/uclient/DependencyInfo.json",f="uclient",c&&u?[4,r.dispatch(Object(j.initializeAppHostClient)(u))]:[3,3];case 1:return h.sent(),[4,r.dispatch({type:"initializeRootCanvasApp.async",execute:function(e,t){var r=e.dispatch,a=e.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,o,i;return Object(n.__generator)(this,(function(s){switch(s.label){case 0:return e=a(),o=Object(j.getRootAppLogicalName)(e),i=Object(j.getRootAppId)(e),o&&i?(r(Object(I.c)({dataComponentApp:{name:o,canvasappid:i}})),[4,r({type:"retrieveRootCanvasAppMetadata.async",execute:function(e,t){var r=e.dispatch,a=e.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var e,o,i,s,c;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(e=a(),o=T(e))return[2];i=R(e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.AppHostClient.getCanvasAppMetadataAsync(i,!0)];case 2:if(!(o=n.sent()))throw new Error("Invalid canvasAppMetadata");return r(Object(I.d)({dataComponentApp:{name:i,appMetadata:o}})),[3,4];case 3:throw s=n.sent(),c=[{name:"appName",value:i}],t.EventManager.ReportComponentFailure("ExpressionRuntime.retrieveCanvasAppMetadata",s,void 0,c),s;case 4:return[2]}}))}))}})]):[3,2];case 1:return s.sent(),[3,3];case 2:t.TraceManager.getTracer("RootCanvasApp").warn("Failed to initializeRootCanvasApp with invalid appId or appLogicalName."),s.label=3;case 3:return[2]}}))}))}})];case 2:h.sent(),p=T(r.getState()),l=ye.getDataComponentScripts(p),d=ye.getDataComponentDependencyInfo(p),f=ye.getDataComponentPackageHostName(p),h.label=3;case 3:return[4,r.dispatch(N(d,a))];case 4:return h.sent(),a.warn(ft()+" Start mer host with appName "+c+" and package host name "+f),null==s||s.start(e,l,X(function(e,t){var r=this;return function(a){return Object(n.__awaiter)(r,void 0,void 0,(function(){var r,o,i,s,c,u,l;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=a.url,o=a.method,i=a.headers,s={urlParameters:r,body:a.bodyData,method:o,expressionRuntimeCall:!0,additionalHeaders:dt(i)},[4,e(s)];case 1:return[4,(c=n.sent()).json()];case 2:return u=n.sent(),l=[{name:Te.c.CLIENT_REQUEST_ID,value:$e(s)}],t.warn(ft()+" Return response with status "+c.status+" for "+a.method+" request "+Te.c.trimUrl(r),l),[2,{headers:et(c.headers),responseType:"json",status:c.status,response:u}]}}))}))}}(t,a))),v=function(e){return Object(n.__awaiter)(g,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e()];case 1:return[2,r.sent()];case 2:throw t=r.sent(),a.error(ft()+" Expression runtime encountered error: "+t.message),t;case 3:return[2]}}))}))},[2,function(e){return v((function(){return Object(n.__awaiter)(g,void 0,void 0,(function(){var t,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return!s||e.expressionRuntimeCall?[2,null]:(t=o.a.trackWork("ExpressionRuntime"),[4,ut(e,s.executeRequest,r,a)]);case 1:return i=n.sent(),t(),[2,i]}}))}))}))}]}}))}))}function dt(e){for(var t={},r=0,n=[te.c.ACCEPT,te.c.PREFER,te.c.AUTO_DISASSOCIATE,te.c.IF_MATCH,te.c.MSCRM_SUPPRESS_DUPLICATION_DETECTION,te.c.MSCRM_RETURN_NOTIFICATIONS,te.c.CONTENT_TYPE,te.c.CLIENT_REQUEST_ID,te.c.SESSION_ID,te.c.ACTIVITY_ID,te.c.SOURCE_ID,te.c.VIEW_ID_HINT,te.c.PAGESIZE_HINT,te.c.PAGE_NUMBER_HINT,te.c.SEARCH_HINT,te.c.FILTER_HINT,te.c.ORDERBY_HINT,te.c.LINK_HINT,te.c.EXECUTION_HINT];r<n.length;r++){var a=n[r];e.hasOwnProperty(a)&&(t[a]=e[a])}return t[te.c.CONTENT_TYPE]||(t[te.c.CONTENT_TYPE]=te.d.APPLICATION_JSON),t}function ft(e){return"["+(e||Oe.f.ExpressionRuntimeHost)+"]"}var pt=r("epR8"),vt=r("/tbe"),gt=r("GvrC"),ht=r("YeRQ"),bt=r("zZKF"),mt=r("r/I7"),_t=r("GYKs"),Ot=r("89c1"),Et=r("CO6B"),yt=r("DDCA"),wt=r("mZy3"),jt=r("hpS+"),St=r("W8a2"),Rt=r("Yd2f"),Tt=r("zJxo"),Ct=r("i2G7"),It=r("F2uj"),Nt=r("o/ap"),Pt=r("k5Sn"),Mt=r("7EJx"),Dt=r("osVU"),xt=r("/j9Z"),At=r("3Cg9"),Lt=r("Cp76"),Ht=r("uA8J"),Ut=r("ak18"),kt=r("tGUD"),Ft=r("iJR5"),qt=r("AhDg"),Gt=r("en4/"),zt=r("LAqF"),Bt=r("dckq"),Vt=r("/MUN"),Jt=r("w9E1"),Yt=r("Wn9Y"),Qt=r("9MHR"),Wt=r("LLrp"),Xt=r("LPiH"),Kt=r("EaAa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Zt(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,a,o,i,s,c,u,l,d,f,p,v,g,h,b,m;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:for(n.trys.push([0,2,,3]),t="[MDL BrowserOffline]",r="SQL: ["+e.sqlStatements.toString()+"], params: ["+e.sqlParameters.toString()+"]",console.log(t+" executing "+r),a=Gt.a.get_DefaultInstance().get_LocalDataSource().get_localStore(),o=a.get_localStoreSchema(),i=[],s=[],c=0;c<e.sqlStatements.length;c++)u=e.sqlStatements[c],l=e.sqlParameters[c],d=$t(u,l,o),f=d.table,p=d.query,v=d.columns,s[c]=v,i.push(a.retrieveMultipleByQuery(p,f,null).nativePromise());return[4,Promise.all(i)];case 1:return g=n.sent(),h=0,b=g.map((function(e,t){var r=e.get_results();h+=r.length;var n={insertId:0,rowsAffected:r.length,columnNames:s[t],rows:r.map((function(e){return s[t].map((function(t){return function(e,t){switch(e){case"id":return t.get_key();case"json":return JSON.stringify(t.get_value());default:return t.get_value()[e]}}(t,e)}))}))};return{insertId:0,rowsAffected:r.length,columnNames:s[t],rows:new Vt.a(n)}})),console.log(t+" SUCCESS (total rows: "+h+") "+r),[2,b];case 2:throw m=n.sent(),Object(Yt.b)("Error executing SQL against indexed db",Qt.a.storage,e.sqlStatements.join("; ")),m;case 3:return[2]}}))}))}function $t(e,t,r){var n=e.match(/select (\*|[\w, ]+)\s*from \[?(\w+)\]?\s*(where (.*))?/i);if(!n)throw new Error("Unable to parse SQL: "+e);var a=n[2],o="*"===n[1]?["id","json"].concat(r.getSchemaFromObjectStoreName(a).get_indexes().map((function(e){return e.get_name()}))):n[1].split(",").map((function(e){return e.trim()}));return{table:a,query:function(e,t,r,n){var a=null;if((null==t?void 0:t.length)>0){var o=t.match(/\[?(\w+)\]?\s*(=|in)\s*\(?([?, ]+)\)?(\s*and\s*\[?(\w+)\]?\s*(=|in)\s*\(?([?, ]+)\)?)?/i);if(!o)throw new Error("Unable to parse whereClause: "+t);var i,s=o[1],c=0;if("="===o[2])i=r[c++];else{var u=rr(o[3],r,c);i=u.params,c=u.paramIndex}if(o[4]){var l,d=o[5];if("="===o[6])l=r[c++];else{u=rr(o[7],r,c);l=u.params,c=u.paramIndex}var f=n.getSchemaFromObjectStoreName(e).get_indexes().find((function(e){return e.get_name()===s+"_"+d||e.get_name()===l+"_"+i}));if(!f)throw new Error("No index found for columns "+s+" and "+d);var p=new Wt.a(f.get_name());a=f.get_name()===s+"_"+d?tr(p,i,l):tr(p,l,i)}else a="string"==typeof i?new Xt.a(new Wt.a(s),i):new Kt.a(new Wt.a(s),i);if(c!==r.length)throw new Error("Number of parameters provided does not match query: "+r.length)}return new Jt.a(a,[])}(a,n[4],t,r),columns:o}}function er(e,t){return e+"_"+t}function tr(e,t,r){return"string"==typeof t&&"string"==typeof r?new Xt.a(e,t+"_"+r):"object"==typeof t&&"string"==typeof r?new Kt.a(e,t.map((function(e){return er(e,r)}))):"string"==typeof t&&"object"==typeof r?new Kt.a(e,r.map((function(e){return er(t,e)}))):"object"==typeof t&&"object"==typeof r?new Kt.a(e,t.reduce((function(e,t){return e.concat(r.map((function(e){return er(t,e)})))}),[])):void 0}function rr(e,t,r){return{params:e.split(",").map((function(e){if(r>=t.length)throw new Error("Number of parameters provided does not match query: "+t.length);return t[r++]})),paramIndex:r}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var nr,ar=function(){function e(){}return e.prototype.ExecuteSqlStatementsOnOfflineDB=function(e){return Gt.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().ExecuteSqlStatements(e)},e.prototype.ExecuteSqlStatementsOnMetadataDB=function(e){var t=Gt.a.get_DefaultInstance().get_Store();if(Object(Fe.h)(t.getState()))return Zt(e);for(var r=[],n=new p.a,a=zt.a.get_Instance().get_sql(),o=new Bt.a(a,"MetadataRequest",!0),i=function(e){r.push({insertId:e.insertId,rowsAffected:e.rowsAffected,columnNames:e.columnNames,rows:new Vt.a(e)})},s=function(e){n.reject(Ft.a.fromErrorCodeAndMessage(e.code,e.message))},c=0;c<e.sqlStatements.length;c++)o.addRequest(e.sqlStatements[c],e.sqlParameters[c],i,s);return o.execute((function(){n.resolve(r)})),new Promise((function(e,t){n.then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},e}(),or=r("zEjV"),ir=r("jO8m"),sr=r("24ou"),cr=r("+Z9T"),ur=r("RNNy"),lr=r("Xv7p"),dr=r("MSdU"),fr=function(){function e(){}return e.prototype.getFormattedvalue=function(e,t,r,n,a){var o=Gt.a.get_DefaultInstance().get_Store().getState(),i=Object(It.d)(o,e);return Object(re.i)(o,i,t,r,n,Object(cr.a)(a)?null:new dr.a(ur.b,a))},e.prototype.parseIntegerValue=function(e){return lr.a.get_instance().parseIntegerValue(e)},e.prototype.parseDecimalValue=function(e,t){return lr.a.get_instance().parseDecimalValue(e,t)},e.prototype.parseInvariant=function(e,t){return Date.parseInvariant(e,t)},e}(),pr=r("96h0"),vr=r("tGD8"),gr=r("cgrB"),hr=r("4Vjv"),br=r("MTEH"),mr=r("fVus"),_r=r("Ye9X"),Or=r("LhLZ"),Er=r("7W7V"),yr=r("TNZ5"),wr=r("Eno9"),jr=r("yLgx"),Sr=r("4+rf"),Rr=r("RK8T"),Tr=r("65mv"),Cr=r("luwc"),Ir=r("gfkV"),Nr=r("X5oH"),Pr=r("hjYO"),Mr=r("xkx/"),Dr={Create:vt.a,Update:Tt.a,Delete:gt.a,ExecuteMultiple:ht.a};function xr(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,lt(e,an,t,r)];case 1:return(nr=n.sent())&&t.dispatch(P(t.getState(),!0)),[3,3];case 2:return a=n.sent(),t.dispatch(P(t.getState(),!1)),r.error("["+Oe.f.ExpressionRuntimeHost+"] Expression runtime failed to initialize: "+a.message),[3,3];case 3:return[2]}}))}))}var Ar=null;function Lr(){Ar=new ir.a}var Hr=null;function Ur(){Hr=new ir.a}function kr(e,t,r,a){return void 0===r&&(r=De.a.Default),void 0===a&&(a=[]),{type:"modernDataSource.execute.legacy.async",execute:function(o,i){var s=o.getState,c=o.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,u,l,d,f;return Object(n.__generator)(this,(function(p){switch(p.label){case 0:return(o=i.TraceManager.getTracer(Oe.e.ModernDataSource)).info(fn()+" Execute legacy request."),[4,Gr(t,e)];case 1:return u=p.sent(),[4,c(ze(u,r))];case 2:return[4,on(l=p.sent(),s,o,De.a.Default,i,!1,a)];case 3:return d=p.sent(),f=c(function(e,t){return{type:"modernDataSource.tolegacyresponse.async",execute:function(r){var a=r.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,o,i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=t.get_name(),Dr[r]?(o=Dr[r](e,t),[4,a(o)]):[3,2];case 1:return(i=n.sent())instanceof wr.a?[2,i]:[3,3];case 2:return[2,e];case 3:return[2]}}))}))}}}(d,e)),Fr(c,s(),u,l),[2,f]}}))}))}}}function Fr(e,t,r,n){var a;Mr.a.indexOf(r.getMetadata().operationName)>-1&&(null===(a=n.additionalParameters)||void 0===a?void 0:a[Oe.d])&&e(Object(pr.initializeOfflineUpsyncProcessAsyncAction)(!0))}function qr(e,t,r){return void 0===t&&(t=De.a.Default),void 0===r&&(r=[]),{type:"modernDataSource.execute.odata.async",execute:function(a,o){var i=a.getState,s=a.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,c,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(a=o.TraceManager.getTracer(Oe.e.ModernDataSource)).info(fn()+" Execute Odata request."),[4,s(ze(e,t))];case 1:return c=n.sent(),u=on(c,i,a,De.a.Default,o,!1,r),Fr(s,i(),e,c),[2,u]}}))}))}}}function Gr(e,t){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return t instanceof jr.a||t instanceof Nr.a||t instanceof Sr.a?[4,e.dispatch(zr(t))]:[3,2];case 1:return r.sent(),[2,Object(b.e)(e,t)];case 2:return[2]}}))}))}function zr(e){return{type:"RETRIEVE_ADDITIONAL_METADATA_FOR_LEGACY_REQUEST",execute:function(t,r){var n=t.dispatch,a=t.getState,o=function e(t,r,n){if(r instanceof Sr.a)for(var a=0,o=r.get_requests();a<o.length;a++){t=e(t,o[a],n)}else if(r instanceof jr.a||r instanceof Nr.a){var i=r.get_target(),s=Object(ie.c)(n,i);Object(y.a)(t,i.get_identifier().LogicalName,s)}return t}({},e,a());return n(Object(M.e)(o)).then((function(){var t=function e(t,r,n){if(r instanceof Sr.a)for(var a=0,o=r.get_requests();a<o.length;a++){t=e(t,o[a],n)}else if(r instanceof jr.a||r instanceof Nr.a)for(var i=r.get_target(),s=0,c=Object(ie.w)(n,i);s<c.length;s++){t[c[s]]=[]}return t}({},e,a());return Object.keys(t).length>0?n(Object(M.e)(t)):Promise.resolve()}))}}}function Br(e,t,r,a,o){return{type:"moderndatasource.retrieve.async",execute:function(i,s){var c=i.getState,u=i.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,l,d,f,h,b,O,E,y,w,j,S,R,T,C,I,N,P,M,D,x,A,L,H,U,k,F,q,G,z,B;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:if(i=s.TraceManager.getTracer(Oe.e.ModernDataSource),(l=[]).push({name:"EntityLogicalName",value:e.LogicalName}),l.push({name:"EntityRecordId",value:e.Id.toString()}),d=Hr&&Hr.get(e.get_key()))return i.info(fn()+" returning retrieve result from cache",l),[2,d.getPromise()];f=new p.a,Hr.put(e.get_key(),new sr.a(f,e.get_key(),"Retrieve")),h=v.a.fromLegacyEntityReference(e),(b=t instanceof gr.a?t.get_Columns():[])instanceof gr.a&&l.push({name:"ColumnSet",value:b.get_Columns().join(",")}),a&&l.push({name:"BPFRequest",value:a.toString()}),n.label=1;case 1:if(n.trys.push([1,15,,16]),O=c(),i.info(fn()+" Starting retrieve operation",l),r.AppendCallStack(fn()+".retrieve"),E=Object(Fe.g)(O)&&Object(_.l)(O,h.etn),Object(Me.b)(O)||!Object(m.isOfflineAvailableForUse)(O)||Object(_.l)(O,h.etn))return[3,2];throw G=new xt.a(Object(kt.a)(-2147093999),-2147093999,null,xt.a.fromErrorCode(O,-2147093987,h.id.guid,h.etn),null,null,null,l,null,null,r.get_Stack()),i.error(fn()+" Retrieve failed because entity is not available offline",l),f.reject(xt.a.toLegacyErrorStatus(G)),G;case 2:return!Object(Me.b)(O)&&Object(m.isOfflineAvailableForUse)(O)||E?(S=Object(ne.h)(O,h.etn)).IsBusinessProcessEnabled&&a?(y=new Ir.a(e,t,null,!1,null,o),U=[y,a],w=Jr,j=[f,h.etn,b,o],[4,Qr(U,i,c,u)]):[2,Yr(f,h,b,s,u,c,o,De.a.Local)]:[3,4];case 3:return[2,w.apply(void 0,j.concat([n.sent(),r,s,u,c,l,null,De.a.Local]))];case 4:if(!Object(Me.b)(O))return[3,13];if(S=Object(ne.h)(O,h.etn),!br.a.hasAccessRights(h.etn,s.DataSource.get_MetadataCache()))return[3,10];if(!S)throw G=new xt.a("Retrieve - Entity metadata not found."),i.error(fn()+" Retrieve failed when trying to get entity descriptor from state",l),z=xt.a.toLegacyErrorStatus(G),en(s,l,z,c(),Oe.e.ModernDataSource),f.reject(z),G;return S.IsChildEntity?(b&&b.length>0&&b.indexOf(S.ParentEntityReferencingAttribute)<0&&b.push(S.ParentEntityReferencingAttribute),[4,Yr(f,h,b,s,u,c,o,De.a.Remote)]):[3,8];case 5:return R=n.sent(),T=v.a.toLegacyEntityReference(R.getValue(S.ParentEntityReferencingAttribute)),C=[new Cr.a(T,new dr.a("systemuser",g.a.toLegacyGuid(Object(Mt.q)(c()))))],Wr(S,b,c,i,l)||((I=Ct.a.fromXml(Kr(T)).getQueryState()).entityLogicalName="principalobjectattributeaccess"),P=Vr,M=[h.etn,b,o],[4,Qr(C,i,c,u)];case 6:return[4,P.apply(void 0,M.concat([n.sent(),r,s,u,c,l,I,De.a.Remote]))];case 7:return N=n.sent(),R.set_accessRights(N.retrievePrincipalAccessResponse.get_accessRights()),N.retrieveUserSharedAttributePermissionsResponse&&R.set_userSharedAttributePrivileges(Xr(N.retrieveUserSharedAttributePermissionsResponse)),[2,f.resolve(R)];case 8:return D=[new Ir.a(e,t,null,!1,null,o),new Cr.a(e,new dr.a("systemuser",g.a.toLegacyGuid(Object(Mt.q)(c()))))],(S.IsBusinessProcessEnabled||S.IsBPFEntity)&&a&&D.push(a),x=Wr(S,b,c,i,l),A=void 0,x||((A=Ct.a.fromXml(Kr(e)).getQueryState()).entityLogicalName="principalobjectattributeaccess"),L=Jr,H=[f,h.etn,b,o],[4,Qr(D,i,c,u)];case 9:return[2,L.apply(void 0,H.concat([n.sent(),r,s,u,c,l,A,De.a.Remote]))];case 10:return S&&S.IsBusinessProcessEnabled&&a?(U=[new Ir.a(e,t,null,!1,null,o),a],F=Jr,q=[f,h.etn,b,o],[4,Qr(U,i,c,u)]):[2,Yr(f,h,b,s,u,c,o)];case 11:return[4,F.apply(void 0,q.concat([n.sent(),r,s,u,c,l,null,De.a.Remote]))];case 12:return(k=n.sent()).get_globalNavigationData()&&(k.fields[mr.a]=k.get_globalNavigationData().fields[mr.a].Id,k.fields[mr.c]=k.get_globalNavigationData().fields[mr.b],k.fields[mr.d]=k.get_globalNavigationData().fields[mr.d]),[2,f.resolve(k)];case 13:throw i.error(fn()+" Retrieve failed. Offline not ready for use and server is not available",l),G=xt.a.fromErrorCode(O,-2147093999),z=xt.a.toLegacyErrorStatus(G),f.reject(),en(s,l,z,c(),Oe.e.ModernDataSource,"Retrieve failed. Offline not ready for use and server is not available"),G;case 14:return[3,16];case 15:throw B=n.sent(),i.error(fn()+" Retrieve failed. Unexpected error",l),en(s,l,Ft.a.fromErrorCode(-2147015414),c(),Oe.e.ModernDataSource),f.reject(B),B;case 16:return[2]}}))}))}}}function Vr(e,t,r,a,o,i,s,c,u,l,d){return void 0===d&&(d=De.a.Default),Object(n.__awaiter)(this,void 0,void 0,(function(){var f,p,v,g,h,b,m,_,O,E,y,w,j,S,R,T,C,I,N;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return f=i.TraceManager.getTracer(Oe.e.ModernDataSource),(p=Object(xe.a)(c(),a)).urlParameters=Te.c.WEB_API_URL_FRAGMENT+p.urlParameters,[4,on(p,c,f,d,i)];case 1:return v=n.sent(),[4,Object(_t.b)(v)];case 2:return g=n.sent(),h=null,b=null,m=null,_=null,l?[4,s(Zr(l,o))]:[3,4];case 3:_=n.sent(),n.label=4;case 4:O="@odata.context",E=0,y=g,n.label=5;case 5:return E<y.length?(w=y[E]).ok?[4,w.json()]:(f.warn(fn()+" One of the results of a batch call returned error "+w.statusText,u),[3,12]):[3,13];case 6:return j=n.sent(),(S=j[O]).indexOf("RetrievePrincipalAccess")>0?[4,s(Object(wt.a)(w,null))]:[3,8];case 7:return h=n.sent(),[3,12];case 8:return S.indexOf("RetrieveProcessControlData")>0?[4,s(Object(jt.a)(w,null))]:[3,10];case 9:return m=n.sent(),[3,12];case 10:if(r&&t){for(R=[],T=0,C=r;T<C.length;T++)I=C[T],N=I.get_relationShipName(),R.push(N);t=t.concat(R)}return[4,s(Object(re.e)(j,e,t&&t.length>0?t:null,void 0,void 0,void 0,f,void 0,r))];case 11:b=n.sent(),n.label=12;case 12:return E++,[3,5];case 13:return[2,{retrieveResponse:b,retrieveProcessControlDataResponse:m,retrievePrincipalAccessResponse:h,retrieveUserSharedAttributePermissionsResponse:_}]}}))}))}function Jr(e,t,r,a,o,i,s,c,u,l,d,f){return void 0===f&&(f=De.a.Default),Object(n.__awaiter)(this,void 0,void 0,(function(){var p,v;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Vr(t,r,a,o,i,s,c,u,l,d,f)];case 1:return p=n.sent(),v=p.retrieveResponse,p.retrievePrincipalAccessResponse&&v.set_accessRights(p.retrievePrincipalAccessResponse.get_accessRights()),p.retrieveProcessControlDataResponse&&(v.set_entityRecordForProcess(p.retrieveProcessControlDataResponse.get_entity()),v.get_entityRecordForProcess()&&(v.get_entityRecordForProcess().mergeEntityRecordFields(v),v.mergeEntityRecordFields(v.get_entityRecordForProcess())),p.retrieveProcessControlDataResponse.get_globalNavigationData()&&p.retrieveProcessControlDataResponse.get_globalNavigationData().fields&&(v.set_globalNavigationData(p.retrieveProcessControlDataResponse.get_globalNavigationData()),Object(Me.b)(u())&&(v.get_globalNavigationData().fields.bpfDefinitionVersionNumber=p.retrieveProcessControlDataResponse.get_bpfDefinitionVersionNumber()))),p.retrieveUserSharedAttributePermissionsResponse&&v.set_userSharedAttributePrivileges(Xr(p.retrieveUserSharedAttributePermissionsResponse)),[2,e.resolve(v)]}}))}))}function Yr(e,t,r,a,o,i,s,c){return void 0===c&&(c=De.a.Default),Object(n.__awaiter)(this,void 0,void 0,(function(){var u,l,d,f,p,g,h;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),u=a.TraceManager.getTracer(Oe.e.ModernDataSource),[4,Qr([l=new Ir.a(v.a.toLegacyEntityReference(t),r&&r.length>0?new gr.a(r):new vr.a,null,!1,null,s)],u,i,o)];case 1:return d=n.sent(),null,d&&0!==d.length?[4,on(d[0],i,u,c,a)]:[2,null];case 2:return f=n.sent(),g=(p=e).resolve,[4,o(Object(re.f)(f,l))];case 3:return[2,g.apply(p,[n.sent().get_entity()])];case 4:return h=n.sent(),e.reject(h),[3,5];case 5:return[2]}}))}))}function Qr(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,o,i,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:t=[],r=0,o=e,n.label=1;case 1:return r<o.length?(i=o[r],s=null,i instanceof Sr.a?[4,a(Object(xe.c)(i))]:[3,3]):[3,13];case 2:return s=n.sent(),[3,11];case 3:return i instanceof Ir.a?[4,a(Object(Rt.c)(i))]:[3,5];case 4:return s=n.sent(),[3,11];case 5:return i instanceof Rr.a?[4,a(Object(St.a)(i))]:[3,7];case 6:return s=n.sent(),[3,11];case 7:return i instanceof Cr.a?[4,a(Object(yt.a)(i))]:[3,9];case 8:return s=n.sent(),[3,11];case 9:return i instanceof Tr.a?[4,a(Object(Ot.a)(i))]:[3,11];case 10:s=n.sent(),n.label=11;case 11:s.urlParameters=Te.c.WEB_API_URL_FRAGMENT+s.urlParameters,s&&t.push(s),n.label=12;case 12:return r++,[3,1];case 13:return[2,t]}}))}))}function Wr(e,t,r,n,a){try{var o=Object(It.j)(r(),e.EntityLogicalName,t),i=Object(Mt.n)(r()),s=!0;for(var c in o)if(o[c].IsSecured){var u=o[c].Id?i[o[c].Id.guid]:null;if(!u||!u.canRead||!u.canUpdate){s=!1;break}}return s}catch(e){return n.error(fn()+" Error occurred when checking secured attribute permissions",a),!1}}function Xr(e){for(var t={},r=0;r<e.get_count();r++){var n=e.get_item(r).getValue("attributeid"),a=1===e.get_item(r).getValue("readaccess").get_value(),o=1===e.get_item(r).getValue("updateaccess").get_value();if(n.toString()in t&&(a||o)){var i=new hr.a(n,!1,a||t[n.toString()].get_CanRead(),o||t[n.toString()].get_CanUpdate());t[n.toString()]=i}else n.toString()in t||(t[n.toString()]=new hr.a(n,!1,a,o))}return t}function Kr(e){return'<fetch distinct="false" no-lock="false" mapping="logical"><entity name="principalobjectattributeaccess"><attribute name="attributeid" /><attribute name="readaccess" /><attribute name="updateaccess" /><filter type="and"><condition attribute="objectid" operator="eq" value="'+e.Id+'" /><condition attribute="principalid" operator="eq-useroruserteams" /></filter></entity></fetch>'}function Zr(e,t){return{type:"moderndatasource.retrievemultiple.async",execute:function(r,a){var o=r.getState,i=r.dispatch;return Object(n.__awaiter)(this,void 0,void 0,(function(){var r,s,c,u,l,d,f,v,g,b,m,_,O,E,y,w;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(r=a.TraceManager.getTracer(Oe.e.ModernDataSource)).info(fn()+" Retrieve multiple is executing"),s=new p.a,c=Ar&&Ar.get(e.key),Object(h.a)(c)?(Ar.put(e.key,new sr.a(s,e.key,"RetrieveMultiple")),u=Object(At.l)(e.fetchXml),[4,i(Object(M.e)(u))]):[2,c.getPromise()];case 1:return n.sent(),[4,i(Ge(e))];case 2:l=n.sent(),d=Object(Et.d)(e.fetchXml),Object(h.a)(t)&&(f=$e(l),t=new qt.a(f,!1)),un(l,v=[]),Object(Ut.d)(l,v),n.label=3;case 3:return n.trys.push([3,6,,7]),[4,on(l,o,r,De.a.Default,a)];case 4:return g=n.sent(),[4,Object(Te.g)(g)];case 5:return b=n.sent(),m=Object(Et.a)(o(),e,d,b),[2,s.resolve(m)];case 6:return(_=n.sent())instanceof Ft.a&&-2147093999===_.get_ErrorCode()?(O=xt.a.fromErrorCode(o(),-2147093987,e.publicKey),E=new xt.a(Object(kt.a)(-2147093999),-2147093999,null,O,null,null,null,v,null,null,t.get_Stack()),y=_.get_Message()||"Not available for offline usage",r.warn(fn()+" "+y+" with key '"+e.publicKey+"' and entity "+e.entityLogicalName,v),[2,s.reject(Ft.a.fromGenericError(E))]):(w=fn()+" RetrieveMultiple with key "+e.publicKey+" failed with error "+(null==_?void 0:_.message)+".",r.error(w,v),en(a,v,_,o(),Oe.e.ModernDataSourceRM,w),[2,s.reject(_)]);case 7:return[2]}}))}))}}}function $r(e,t,r){return void 0===r&&(r=De.a.LocalAndRemote),{type:"moderndatasource.getclientmetadata.async",execute:function(a,o){var i=a.dispatch,s=a.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,c,u,f,p,v,b,m,_,y,w,j,S,R,T,C,I,N;return Object(n.__generator)(this,(function(P){switch(P.label){case 0:return(a=o.TraceManager.getTracer(Oe.e.ModernDataSource)).info(fn()+" Get Client Metadata is executing"),c=Object(pt.b)(e),!(u=s())&&e.MetadataType&&a.warn(fn()+" Trying to execute a "+e.MetadataType+" GCM call with depth "+e.DependencyDepth+" when state is null"),null===g.a.tryParseOrNull(Object(Le.i)(u))&&e.MetadataType===te.a&&(c.AppId=g.a.fromLegacyGuid(e.MetadataId)),f=Object(d.c)(u,l.Xb),(p=f?new bt.a:new mt.a).ClientMetadataQuery=c,[4,i(Ve(p,r))];case 1:if((v=P.sent()).urlParameters&&e.MetadataType!==pt.a.BusinessProcessFlow&&e.MetadataType!==pt.a.MetadataVersion&&e.MetadataType!==pt.a.UserMetadataVersion&&e.DependencyDepth!==or.a.UserContext&&(b=Object(Pt.a)(u),m=Object(Nt.a)(u),_=b.currentVersion?b.currentVersion:-1,y=m.currentVersion?m.currentVersion:-1,v.urlParameters=v.urlParameters+"&umv="+_.toString()+"&mv="+y.toString()),v.urlParameters=v.urlParameters+Te.c.API_FRAGMENT_9_1,Object(E.a)(u)&&(v.additionalHeaders.Consistency="Strong",i(Object(O.b)(!1))),w=o.DataSource.get_IsLocalDataSourceAvailable(),j=o.DataSource.get_IsServerAvailable(),S=[],Object(h.a)(t)&&(R=$e(v),t=new qt.a(R,!1)),S.push({name:"InputRetrievalStrategy",value:De.a[r]}),S.push({name:Te.c.REQUEST_DETAILS,value:JSON.stringify(e)}),S.push({name:"LocalDSAvailable",value:w}),S.push({name:"RemoteDSAvailable",value:j}),un(v,S),T=function(e,r){return Qe(e,s(),a,r),function(e,t,r,a,o,i,s,c,u){return Object(n.__awaiter)(this,void 0,void 0,(function(){var l,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:u.push({name:"FinalRetrievalStrategy",value:De.a[r]}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,on(e,t,i,r,s,!0)];case 2:return l=n.sent(),i.info(fn()+" MDL getClientMetadata received response",u),[4,o(Xe(l,a,c))];case 3:return[2,n.sent()];case 4:return d=n.sent(),i.error(fn()+" Get Client Metadata failed with error: "+Object(xt.d)(d),u),en(s,u,d,t(),Oe.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),[2,Promise.reject(d)];case 5:return[2]}}))}))}(e,s,r,f,i,a,o,t,S)},r!==De.a.LocalAndRemote)return[3,8];if(!w)return[3,6];P.label=2;case 2:return P.trys.push([2,4,,5]),[4,T(v,De.a.Local)];case 3:if(I=P.sent(),(Object(h.a)(I)||0===Object.keys(I).length)&&e.DependencyDepth!==D.b.UserContext)throw N=Ft.a.fromErrorCode(-2147093987);return[2,I];case 4:if(C=P.sent(),a.warn(fn()+" error in local data source GCM, retrying with remote data source. Error is: "+Object(xt.d)(C),S),j)return[2,T(v,De.a.Remote)];throw(N=Ft.a.fromErrorCode(-2147093999)).set_InnerError(C),N.set_Stack(t.get_Stack()),a.error(fn()+" remote data source is not available and error in local data source GCM",S),en(o,S,N,s(),Oe.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),N;case 5:return[3,7];case 6:if(j)return[2,T(v,De.a.Remote)];throw(N=Ft.a.fromErrorCode(-2147093999)).set_Stack(t.get_Stack()),a.error(fn()+" remote and local data sources are not available so error in GCM",S),en(o,S,N,s(),Oe.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),N;case 7:return[3,12];case 8:return r!==De.a.Local?[3,11]:w?[4,T(v,De.a.Local)]:[3,10];case 9:return I=P.sent(),!Object(h.a)(I)&&0!==Object.keys(I).length||e.DependencyDepth===D.b.UserContext?[2,I]:((N=Ft.a.fromErrorCode(-2147093987)).set_Stack(t.get_Stack()),a.error(fn()+" Not in local store "+e.MetadataType+" "+e.MetadataSubtype,S),[2,{}]);case 10:return a.warn(fn()+" local data source is not available and retrieval strategy is Local.",S),[2,{}];case 11:if(r===De.a.Remote&&j)return[2,T(v,De.a.Remote)];throw(N=Ft.a.fromErrorCode(-2147093999)).set_Stack(t.get_Stack()),a.error(fn()+" Remote data source is not available and retrieval strategy is remote, so error in GCM",S),en(o,S,N,s(),Oe.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),N;case 12:return[2]}}))}))}}}function en(e,t,r,n,a,o){var i=xt.a.fromLegacyErrorStatus(r,n);(t.push({name:Te.c.CRM_ERROR_CODE,value:i.errorCode}),Object(Ht.a)(a,i.errorCode))?e.EventManager.ReportComponentFailure(a,i,null,t):e.TraceManager.getTracer(a).error(fn()+" "+(o||r.get_Message()),t)}function tn(e){return{type:"moderndatasource.getusercontext.async",execute:function(t,r){var a=t.dispatch,o=t.getState;return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,i,s,c,u,l,d,f;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return(t=r.TraceManager.getTracer(Oe.e.ModernDataSource)).info(fn()+" Get User Context is executing"),i=o(),s=Object(Le.i)(i),c=new Er.a(null,null,null,null,[],!1,or.a.UserContext,null,[],g.a.toLegacyGuid(g.a.tryParseOrNull(s))),u=new qt.a(g.a.newGuid().guid),(l=[]).push({name:Te.c.CLIENT_REQUEST_ID,value:u.RequestId()}),l.push({name:"InputRetrievalStrategy",value:De.a[e]}),[4,a($r(c,u,e))];case 1:return(d=n.sent())&&d.UserContext&&d.UserContext[0]?Object.keys(d).length>1?(t.info(fn()+" UserContext call with strategy "+e+" returned additional metadata"),(f=Object(Dt.a)(d,null,null,i,null,null,t,s)).webResourcesContent=null,[4,a(Object(w.c)(f))]):[3,3]:(l.push({name:Te.c.OTHER_DETAILS,value:"UserContext call failed in MDL via "+De.a[e]}),t.error(fn()+" User Context was not returned from MDL. Strategy "+e,l),r.EventManager.ReportComponentFailure(Oe.e.ModernDataSourceUserContext,l),e===De.a.Local?[2,null]:[2,Promise.reject(new Or.a(null,"error","UserContext was not returned from GetClientMetadata call"))]);case 2:n.sent(),n.label=3;case 3:return l.push({name:Te.c.OTHER_DETAILS,value:"UserContext call succeeded in MDL via "+De.a[e]}),e===De.a.Local?(r.EventManager.ReportComponentSuccess(Oe.e.ModernDataSourceUserContext,l),[2,Pr.a.createFromObjectData(d.UserContext[0])]):(r.EventManager.ReportComponentSuccess(Oe.e.ModernDataSourceUserContext,l),[2,Object(_r.a)(d.UserContext[0])])}}))}))}}}function rn(e,t){return Object(m.getIsOfflineEnabled)(e)&&Object(m.isOfflineAvailableForUse)(e)&&We(e,t)}function nn(e){return Object(m.getIsOfflineEnabled)(e)?Object(m.isOfflineAvailableForUse)(e)?"related entity is not enabled for offline":"offline is not yet available":"the app is not offline enabled"}function an(e,t,r){var a,c;return Object(n.__awaiter)(this,void 0,void 0,(function(){var f,p,v,g,b;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return f=null==r?void 0:r.TraceManager.getTracer(Oe.e.ModernDataSource),p={TraceManager:null!==(a=null==r?void 0:r.TraceManager)&&void 0!==a?a:new s.ConsoleTraceManager,EventManager:null!==(c=null==r?void 0:r.EventManager)&&void 0!==c?c:new i.ConsoleEventManager,SqlExecutor:new ar,AdditionalParameters:{EnableDependency:!Object(h.a)(t)&&Object(d.c)(t(),l.oc)},Formatter:new fr},null==f||f.info(fn()+" Execute the request in Modern Data Layer Component"),v=new u.ODataExecutor(null,p),g=o.a.trackWork("MDS"),[4,v.execute(dn(e))];case 1:return b=n.sent(),g(),[2,b]}}))}))}function on(e,t,r,a,o,i,s){return void 0===a&&(a=De.a.Default),void 0===i&&(i=!1),void 0===s&&(s=[]),Object(n.__awaiter)(this,void 0,void 0,(function(){var u,f,p,v,g,h,b;return Object(n.__generator)(this,(function(m){switch(m.label){case 0:return u=performance.now(),function(e,t,r,a,o){var i;void 0===r&&(r=De.a.Default),void 0===a&&(a=!1);try{if(t.additionalHeaders[te.c.EXECUTION_HINT])return;var s=void 0;if(e)switch(r){case De.a.Local:if(!a&&!rn(e,t)){var c=nn(e);throw Ft.a.fromErrorCodeAndMessage(-2147093999,"Can't execute 'Offline' request as "+c)}s=te.b.OFFLINE;break;case De.a.Remote:if(!a&&!Object(Me.b)(e))throw Ft.a.FromMessage("Can't execute 'Online' request as server is NOT available");s=te.b.ONLINE;break;case De.a.Default:if(Object(Le.o)(e)&&Object(Me.b)(e)&&rn(e,t)){t.additionalHeaders.clientType=Oe.a.local;var u=((i={})[Oe.d]=!0,i);t.additionalParameters=t.additionalParameters?Object(n.__assign)(Object(n.__assign)({},t.additionalParameters),u):u,s=te.b.OFFLINE}else if(Object(Me.b)(e))s=te.b.ONLINE;else{if(!rn(e,t)){var l=nn(e);throw Ft.a.fromErrorCodeAndMessage(-2147093999,"Can't execute 'Default' request as the server is NOT available and "+l)}s=te.b.OFFLINE}break;default:throw Ft.a.FromMessage("Currently MDL does not support the strategy: "+r)}else s=r===De.a.Local?te.b.OFFLINE:te.b.ONLINE;t.additionalHeaders[te.c.EXECUTION_HINT]=s}catch(r){var d=[];throw un(t,d),en(o,d,r,e,Oe.e.ModernDataSource),r}}(t(),e,a,i,o),Object(d.c)(t(),l.yc)&&e.expressionRuntimeSupportedRequest?(un(e,f=[]),(v=nr)?[4,nr(e)]:[3,2]):[3,3];case 1:v=m.sent(),m.label=2;case 2:if(p=v)return r.warn(fn()+" Handling the response for expression run time case",f),[2,cn(t(),p,e,u,o,r,!0,f)];r.warn(fn()+" No Data Component handled this request - Response is Null",f),m.label=3;case 3:return g=e,(h=function(e){return"GET"===e.method&&"remote"===Object(c.getClientType)(dn(e))&&Object(ae.c)(e.urlParameters).length>Te.c.VERY_LONG_URL}(e))&&(s.push({name:"isConvertToBatchRequestNeeded",value:h}),g=function(e,t){var r=Object(xe.a)(e,[t]);return r.additionalHeaders=Object(n.__assign)(Object(n.__assign)({},t.additionalHeaders),r.additionalHeaders),Ye(e,r),r}(t(),e)),un(e,s),r.warn(fn()+" Skip Expression Runtime Component and send the request directly to Modern Data Layer",s),[4,an(g,t,o)];case 4:return b=m.sent(),h?[4,sn(b,r,s)]:[3,6];case 5:b=m.sent(),m.label=6;case 6:return[2,cn(t(),b,e,u,o,r,!1,s)]}}))}))}function sn(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(_t.b)(e)];case 1:return(a=n.sent())&&a.length>0?[2,a[0]]:(t.warn(fn()+" Invalid response list returned from parseBatchResponse",r),[2,e])}}))}))}function cn(e,t,r,a,o,i,s,c){return void 0===c&&(c=[]),Object(n.__awaiter)(this,void 0,void 0,(function(){var u,l,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return u=performance.now()-a,c.push({name:Te.c.RESPONSE_TIME,value:u}),function(e,t,r){var n=e.headers?Object(Lt.a)(e.headers,te.c.SERVER_REQUEST_ID):Te.c.UNKNOWN,a=e.status?e.status:null,o=e.type?e.type:null,i=e.statusText?e.statusText:null,s=e.url?Te.c.trimUrl(e.url):null,c=e.headers?Object(Lt.a)(e.headers,"Content-Length"):Te.c.UNKNOWN;t.push({name:Te.c.RESPONSE_URL,value:s}),t.push({name:Te.c.HTTP_STATUS_CODE,value:a}),t.push({name:Te.c.HTTP_RESPONSE_TYPE,value:o}),t.push({name:Te.c.HTTP_RESPONSE_STATUSTEXT,value:i}),t.push({name:Te.c.SERVER_REQUEST_ID,value:n}),t.push({name:Te.c.RESPONSE_SIZE_IN_BYTES,value:c}),t.push({name:Te.c.IS_BATCH_REQUEST,value:!1}),t.push({name:"IS_EXPRESSION_RUNTIME_REQUEST",value:r})}(t,c,s),t.ok?(o.EventManager.ReportComponentSuccess(Oe.e.ModernDataSource,c),[2,t]):[3,1];case 1:if(401!==t.status)return[3,6];null==i||i.error(fn()+" Modern Data Layer : 401 response from server.",c),l=Gt.a.get_DefaultInstance().get_RemoteCallRetryHandler(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,l.handleAuthError(r)];case 3:return n.sent(),null==i||i.error(fn()+" Modern Data Layer : 401 response from server, handleAuthError() was successful, retrying the request.",c),[2,an(r,(function(){return e}),o)];case 4:throw d=n.sent(),i&&i.error(fn()+" Error in 401 error handling",c),d;case 5:return[3,7];case 6:return t.url&&-1!==t.url.indexOf("$batch")||r&&r.urlParameters&&-1!==r.urlParameters.indexOf("$batch")?[2,Object(_t.b)(t).then((function(n){if(n){var a=n.find((function(e){return!e.ok}))||t;return ln(e,a,o,r,c,i)}throw new Or.a(t,t.statusText,"Batch request failed with http Status : "+t.status)}))]:(null==i||i.error(fn()+" Modern Data Layer component returns Error Response - Convert error to CRM Error.",c),[2,ln(e,t,o,r,c,i)]);case 7:return[2]}}))}))}function un(e,t){var r,n,a,o=Object(ke.e)(e);t.push({name:Te.c.CLIENT_REQUEST_ID,value:$e(e)}),t.push({name:Oe.c.CLIENT_TYPE,value:pn(e)}),t.push({name:Oe.c.OPERATION_TYPE,value:o.type}),t.push({name:Oe.c.OPERATION_SUB_TYPE,value:o.subType}),t.push({name:Oe.c.IS_OFFLINE_BY_DEFAULT_REQUEST,value:(null===(r=e.additionalParameters)||void 0===r?void 0:r[Oe.d])||!1}),t.push({name:Oe.c.ENTITY_NAME,value:(null===(n=e.additionalParameters)||void 0===n?void 0:n[Oe.b])||"Unknown"}),t.push({name:Oe.c.EXECUTION_HINT,value:(null===(a=e.additionalHeaders)||void 0===a?void 0:a[te.c.EXECUTION_HINT])||"Unknown"});var i=e.urlParameters?Te.c.trimUrl(e.urlParameters):null;t.push({name:Te.c.REQUEST_URL,value:i}),t.push({name:Te.c.REQUEST_METHOD,value:e.method||"Unknown"})}function ln(e,t,r,n,a,o){try{return t.text().then((function(i){var s,c=function(e,t,r,n){var a=null,o=e&&e.toLowerCase().indexOf("<!doctype html")>-1;a=o?Or.a.createFromHtml(e,t):new Or.a(t,t.statusText,e);var i=t.headers?Object(Lt.a)(t.headers,"Retry-After"):null;a.set_retryAfter(i);var s=t.headers?Object(Lt.a)(t.headers,"Content-ID"):null;if(s){var c=Number.parseInt(s,10);c>-1&&a.set_contentId(c)}var u=t.headers?Object(Lt.a)(t.headers,te.c.SERVER_REQUEST_ID):Te.c.UNKNOWN,l=$e(r);a.set_serverResponseId(u),a.set_clientRequestId(l);var d=t&&0===t.status;return a.set_isErrorInOffline(d),n.push({name:Te.c.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:o}),n.push({name:Te.c.IS_ERROR_IN_OFFLINE,value:d}),a}(i,t,n,a);Te.c.canLogDetailsOfRequest(t.url)&&(a.push({name:Te.c.ODATA_ERROR_RESPONSE_COMPLETE_TEXT,value:i}),a.push({name:Te.c.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE,value:JSON.stringify(c)}));var u=null,l=null,d=c&&c.get_message?c.get_message():null;if(c.get_organizationServiceFault&&c.get_organizationServiceFault()){l=c.get_organizationServiceFault().get_errorCode();try{null==d&&(d=c.get_error())}catch(e){a.push({name:Te.c.CRM_ERROR_RESPONSE_GET_ERROR,value:Te.c.FAILED})}try{var p=JSON.parse(c.get_error());u=p.error&&p.error.innererror?p.error.innererror.stacktrace:null}catch(e){a.push({name:Te.c.CRM_ERROR_RESPONSE_GET_ERROR_PARSING,value:Te.c.FAILED})}}var v=d||Te.c.REQUEST_FAILURE;n&&Te.c.isSearchRequest(n.endpoint)&&(v=Te.c.UCIMONITOR_ERROR_MESSAGE),a.push({name:Te.c.CRM_ERROR_CODE,value:l}),a.push({name:Te.c.CRM_CALL_STACK,value:u}),a.push({name:Te.c.CRM_ERROR_MESSAGE,value:v});var g,h,b=t?t.status:null;if(null===(s=n.additionalParameters)||void 0===s?void 0:s[Oe.d]){var m=void 0,O=void 0;g=n.urlParameters,(m=(h=g.indexOf("fetchXml="))>0?decodeURIComponent(g.substring(h+"fetchXml=".length)):null)&&(O=Object(_.b)(e,m)).error&&a.push({name:Oe.c.ERROR_DETAIL,value:"Linked entity is not available offline"},{name:f.b.RelatedEntityUnavailableOffline,value:O.relatedEntityUnavailableOffline})}if([400,404,500,503].indexOf(b)>-1&&Object(Ht.a)(Oe.e.ModernDataSource,l)){var E=new xt.a(v,l,null,null,null,null,null,a,null,null,null,null,null,null,b,c.get_clientRequestId(),c.get_serverResponseId());r.EventManager.ReportComponentFailure(Oe.e.ModernDataSource,E,void 0,a)}else o&&o.error(fn()+" "+v,a);var y=yr.a.GetErrorStatusFromErrorResponse(c);throw Object(Me.b)(e)&&!c.get_isErrorInOffline()||(y.set_ErrorCode(-2147093999),y.set_Message(Ft.a.fromErrorCode(-2147093999).get_Message()),y.set_InnerError(yr.a.GetErrorStatusFromErrorResponse(c))),y}))}catch(t){null==o||o.error(fn()+" Modern Data Layer component : Exception occurred while creating error response.",a);var i=-2147093999;throw Object(Me.b)(e)&&(i=-2147015419),Ft.a.fromErrorCode(i)}}function dn(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function fn(e){return"["+(e||Oe.f.ModernDataSource)+"]"}function pn(e){return e&&e.additionalHeaders?e.additionalHeaders.clientType||Oe.a.remote:Te.c.UNKNOWN}},r1Pe:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleTracer=void 0;var n=r("1J99"),a=r("Y0ua"),o=function(){function e(e){this._name=e}return e.prototype.log=function(e,t,r){console.log(t+": "+String(this._name+"                        ").slice(0,24)+" --- "+e+" \n "+(r?JSON.stringify(r):a.EVENT_PARAMETERS.EMPTY_STRING))},e.prototype.warn=function(e,t){this.log(e,"warn",t)},e.prototype.info=function(e,t){this.log(e,"info",t)},e.prototype.error=function(e,t){this.log(e,"error",t)},e.prototype.debug=function(e,t){this.log(e,"error",t)},e.prototype.getLogLevel=function(){return n.TracerLogLevel.Info},e}();t.ConsoleTracer=o},sTbl:function(e,t,r){"use strict";r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"d",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"a",(function(){return f}));var n=r("EGsq"),a=r("iyBA"),o=r("qC0c"),i=r("cZkS"),s=r("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e.appHostClient.initialized}function u(e){return e.appHostClient.error}function l(e){var t=Object(n.x)(e),r=t.geoName,s=t.isSovereignCloud;if(Object(o.c)(e,i.yc))return"Test";switch(null==r?void 0:r.toUpperCase()){case"TIP":var c=Object(a.b)(e,"canvashostenv");switch(null==c?void 0:c.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(s)return"Gcc";default:var u=Object(a.b)(e,"canvashostenv");switch(null==u?void 0:u.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function d(e){switch(l(e)){case"Local":return s.Endpoint.Local;case"Test":return s.Endpoint.Test;case"Int":return s.Endpoint.Int;case"Preprod":return s.Endpoint.Preprod;case"Gcc":return s.Endpoint.Gcc;case"GccHigh":return s.Endpoint.GccHigh;case"Preview":return s.Endpoint.Preview;default:return s.Endpoint.Prod}}function f(e){return e.appHostClient.bundleLoaded}},u5k1:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleEventManager=void 0;var n=r("Y0ua"),a=function(){function e(){}return e.prototype.getCurrentSessionId=function(){return""},e.prototype.getActivityId=function(){return""},e.prototype.ReportComponentPerformance=function(e,t,r,n,a){this._dispatchEvent("performance",e,t+": "+r,n)},e.prototype.ReportComponentSuccess=function(e,t){this._dispatchEvent("success",e,void 0,t)},e.prototype.ReportComponentFailure=function(e,t,r,n){this._dispatchEvent("failure",e,JSON.stringify(t),n)},e.prototype.ReportEvent=function(e,t){},e.prototype._dispatchEvent=function(e,t,r,a){console.log(e+": "+String(t+"                        ").slice(0,24)+" --- "+(r||n.EVENT_PARAMETERS.EMPTY_STRING)+" \n "+(a?JSON.stringify(a):n.EVENT_PARAMETERS.EMPTY_STRING))},e}();t.ConsoleEventManager=a}}]),window.bundleExecutionMarkers["scripts/es5/mds.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();