(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/offlinestatusdialogpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[95,36,38,40,70],{"+6eZ":function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){var t="";try{t=JSON.stringify(e)}catch(e){}return t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},"+P1Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("c/eZ"),a=n("gk6Q"),i=n("YCDx"),o=n("QAhb"),s=n("n1Ju"),c=function(e,t,n,r){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:n},{name:"Title",value:r}]},l=n("IiPO"),u=n("+Z9T"),d=n("HSdq"),p=n("F2uj"),g=n("c7nC"),h=n("9r0m"),m=n("H9Ho"),f=n("kvLG");var b,v=n("ezfI"),y=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._entityAttribute=null,b=t,s.registerObserversForControlStateChange(),s}return Object(r.__extends)(t,e),t.prototype.getAttribute=function(){var e="ClientApi.XrmDataControl.getAttribute";try{if(v.a.instance.reportCall(e),!this._entityAttribute){var t=void 0;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(t=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{var n=t?t.attributes:this.formContext.data.attributes;this._entityAttribute=n.get(this.controlDescriptor.DataFieldName)}}return v.a.instance.reportSuccess(e),this._entityAttribute}catch(t){var r=l.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.updateAttribute=function(e,t){var n="ClientApi.XrmDataControl.updateAttribute";try{if(v.a.instance.reportCall(n),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;var r=e.attributes;r&&(this._entityAttribute=r.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),v.a.instance.reportSuccess(n)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,a),e}},t.prototype.addNotification=function(e){var t="ClientApi.XrmDataControl.addNotification";try{if(v.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){var n={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):b.dispatch(Object(g.b)(this.pageId,this.getName(),!1,this.contextToken)),b.dispatch(Object(s.b)(this.pageId,this.getName(),n,this.contextToken)),v.a.instance.reportSuccess(t),!0}return v.a.instance.reportSuccess(t),!1}catch(e){var r=l.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype._clearControlNotification=function(e){var t=this,n=Object(d.A)(b.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(n){var r=Object.keys(n),a=null;if(e){if(!((a=n[e])&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(u.a)(e)||0===e.trim().length)&&r.forEach((function(e){a=n[e],t._clearNotification(a)}));return!0}return!1},t.prototype._clearNotification=function(e){e.actions=null,e.messages=null,e.notificationLevel=null,b.dispatch(Object(s.b)(this.pageId,this.name,e,this.contextToken))},t.prototype.clearNotification=function(e){var t="ClientApi.XrmDataControl.clearNotification";try{v.a.instance.reportCall(t);var n=!!this._clearControlNotification(e);return v.a.instance.reportSuccess(t),n}catch(e){var r=l.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(t,e,null,r),e}},t.prototype.setNotification=function(e,t){var n="ClientApi.XrmDataControl.setNotification";try{v.a.instance.reportCall(n);var r={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return v.a.instance.reportSuccess(n),this.addNotification(r)}catch(e){var a=l.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),l.a.getInstance().reportFailure(n,e,null,a),e}},t.prototype._isValidNotification=function(e){return!(!e||!e.messages||Object(m.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)},t.prototype._reportAddNotificationEvent=function(e){if(this._isValidNotification(e)){var t,n=e.messages[0],r=new c("Added",this.contextToken.entityTypeName,this.getName(),n);b.dispatch((t=r,{type:"report.xrm.event",execute:function(e,n){try{l.a.getInstance().reportEvent(t)}catch(e){var r="ClientApi.ReportXrmEventAction.reportXrmEvent";f.a.getInstance().eventManager.ReportComponentFailure(r,e),Object(u.j)(r,"XrmReporting")}return Promise.resolve()}}))}},t.prototype.getEntityReference=function(){var e=this.formContext.entityReference,t=e.id?new h.a(e.id):null;return new o.a(e.entityType,t)},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(a.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t.prototype.getAttrDescriptor=function(e,t,n){var r=this.getEntityReference().etn,a=Object(d.r)(b.getState(),r,this.name,this.pageId,this.contextToken);return a||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(f.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),(a=Object(p.a)(b.getState(),r,this.controlDescriptor.DataFieldName))||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:r}),n.reportFailure(e,new Error("Attribute descriptor was not found"),t))):n.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):n.reportFailure(e,new Error("Control descriptor was not found"),t)),a},t}(i.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"+r/t":function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"l",(function(){return a})),n.d(t,"k",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"p",(function(){return h})),n.d(t,"a",(function(){return m})),n.d(t,"h",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return v})),n.d(t,"q",(function(){return y}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="Web.NavBar.Home_Title",a="Web.NavBar.Search_Title",i="Web.NavBar.Relationship_Assistant_Caption",o="Web.NavBar.Quick_Create_Menu_Caption",s="Web.NavBar.Start_Task_Flow_Caption",c="Web.NavBar.Offline_Status_Caption",l="Web.NavBar.Immersive_Skype_Caption",u="Web.NavBar.Settings_Caption",d="Web.NavBar.User_Information_Caption",p="Web.NavBar.Help_Title",g="Web.NavBar.Go_Back",h="Web.NavBar.SiteMap",m="Web.NavBar.AdvancedFind_Title",f="Monitor.Monitor.Label",b="Web.NavBar.Home_Title",v="Web.NavBar.Home_Desc",y=[r,a,i,o,s,c,"Web.NavBar.See_Welcome_Screen_Caption",l,u,d,m,f,p,"Web.NavBar.Search_Title","Web.NavBar.Search_Desc","Web.NavBar.Settings_Title","Web.NavBar.Settings_Desc","Web.NavBar.Help_Title","Web.NavBar.Help_Desc",b,v,"Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.TaskFlow_Desc","Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.User_Information_Title","Web.NavBar.User_Information_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.OfflineStatus_Desc",g,"Web.NavBar.AdvancedFind_Title","Web.NavBar.AdvancedFind_Desc",h]},"/C1z":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("EGsq"),a=n("4pqm"),i=n("yZTI"),o=n("Fas2"),s=n("9r0m"),c=n("OTOS"),l=n("7EJx"),u=n("lMVv");function d(e){var t,n=Object(r.x)(e),d=Object(u.h)(e,p(e));if(t=d&&d.EntityHelpUrlEnabled&&d.EntityHelpUrl?d.EntityHelpUrl:Object(r.i)(e)){if(n&&n.globalAppendUrlParametersEnabled){var g=Object(i.c)(e);return function(e,t,n,r,i){var o=new a.a(e);o.searchParams.append("userlcid",t),n&&o.searchParams.append("typename",n);r&&(o.searchParams.append("entrypoint",r),i&&o.searchParams.append("formid",i));return o.toString()}(t,function(e){var t=Object(r.x)(e);return(Object(l.s)(e)||t.languageCode).toString()}(e),p(e),function(e,t){if("entityrecord"===Object(i.k)(e,t))return"form";if(Object(o.o)(e,t))return"hierarchychart";return""}(e,g),s.a.toString(Object(c.b)(e,g)))}return t}return"https://go.microsoft.com/fwlink/p/?linkid=846388"}function p(e){var t=new a.a(window.location.href);return t&&t.searchParams?t.searchParams.get("etn"):void 0}},"/U1C":function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("c/eZ"),a={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},i=Object.values(a),o={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},s=Object.values(o),c={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},l=Object.values(c),u={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},d=Object.values(u),p=Object(r.__spreadArrays)(i,s,d);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"/V8d":function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"e",(function(){return D})),n.d(t,"d",(function(){return B})),n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return R}));var r=n("c/eZ"),a=n("pOv+"),i=n("9r0m"),o=n("sgPk"),s=n("U0B9"),c=n("2OIc"),l=n("Gemh"),u=n("kl3Z"),d=n("lMVv"),p=n("bH46"),g=n("i8/j"),h=n("PQ2H"),m=n("8xrh"),f=n("WS0f"),b=n("7EJx"),v=n("vt+k"),y=n("QAhb"),_=n("HSdq"),C=n("yHpA"),S=n("hl8w"),O=n("RNNy"),I=n("F2uj"),j=n("uO/V"),P=n("qC0c"),x=n("cZkS"),E=n("jigW"),T=n("i2G7"),w=n("sOTk"),A=n("xkx/"),F=n("r2h9"),N=n("+l2M"),k=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],M=["Opportunity_ActivityPointers"];function D(e){var t,n=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(j.r)&&e.control.Parameters[j.r],r=[e.viewId,n,e.recordsPerPage,(t=e,t&&t.controlParameters&&t.controlParameters.ChartDrillDownParameters&&t.controlParameters.ChartDrillDownParameters.length>0)];return e.customQueryStateKeyParts&&r.push.apply(r,e.customQueryStateKeyParts),r.join("")}function R(e,t,n,r,a){var i=L(e,t,n,r,a);return function(t){var n=i(t);return n&&n.getQueryState(n instanceof o.a?void 0:e)}}function L(e,t,n,r,a){var c={};return function(u){var d=new i.a(u.viewId),p=Object(l.qb)(e(),d,t);if(!p)return null;var g=function(e,t,n){var r=t.fetchXML,a=null,i="TeamTemplateId";if(t.entityLogicalName===O.a&&e.controlParameters[i]){var o=e.controlParameters[i];if(r&&r.indexOf(o)<0){var s=n?n.guid:"",c=Object(S.a)(r,o,s);r=c.updatedFetchXml,a=c.filterString}}return{fetchXML:r,filterString:a}}(u,p,r),h=g.fetchXML;if(!h&&p.queryApi)return null;if(Object(E.l)(e())&&u.quickFindViewId){var j=new i.a(u.quickFindViewId),k=i.a.isNullOrEmpty(j)?null:Object(l.qb)(e(),j,t);Object(f.a)(k)||(h=function(e,t){var n=new DOMParser;if(e){for(var r=n.parseFromString(e.fetchXML,"text/xml"),a=n.parseFromString(t.fetchXML,"text/xml"),i=r.getElementsByTagName("filter"),o=0;o<i.length;o++)i[o].attributes&&i[o].attributes.getNamedItem("isquickfindfields")&&a.getElementsByTagName("entity")[0].appendChild(i[o]);return(new XMLSerializer).serializeToString(a)}return t.fetchXML}(k,p))}var D=e(),R=u.entityLogicalName,L=u.getCustomFilter&&u.getCustomFilter(),V=function(e,t,n,r,a){var o=a.controlParameters.RelationshipName;if(o){var s=r,c=null,u=null;if(a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;if(a.controlParameters.IsDataSetLookup)if(s=null==a.controlParameters.ParentRecordId?i.a.EMPTY:new i.a(a.controlParameters.ParentRecordId),a.controlParameters.DependentAttributeName)c=(u=a.controlParameters.DependentAttributeName).split(".")[1]||u;var d=Object(_.ac)(e,t,a.contextToken),p=new y.a(n,s),g=null,h=!1;Object(I.a)(e,n,c)?g=Object(C.d)(e,d,p,c):a.controlParameters.DependentAttributeType&&(h=a.controlParameters.DependentAttributeType===n&&a.controlParameters.DependentAttributeType!==a.entityLogicalName);var m=g;m&&m.reference?s=m.reference.id:!a.controlParameters.IsDataSetLookup&&null===c||null!==m&&null!==m.reference||!p||null===p.id||h||(s=null);var f=Object(l.kb)(e,t,a.contextToken),b=0,S=v.h.None;return f?(b=1,-1===M.indexOf(o)&&(S=v.h.Related)):(a.controlParameters.ShouldApplyContextFilter&&a.controlParameters.IsDataSetLookup||!a.controlParameters.IsDataSetLookup)&&(b=2),{type:b,rollupType:S,entityReference:p,contextId:s,relationshipName:o}}return null}(D,t,a||n&&n.EntityLogicalName,r,u),G=Object(m.p)(e(),R),W=function(e,t,n,r,a,o,s){var c,u=Object(w.g)(e,o),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(l.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),p=Object(l.qb)(e,s,o),g=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&i.a.equals(null===(c=t.control)||void 0===c?void 0:c.ClassId,N.E));return Object(A.e)(e)&&(g||Object(A.f)(e))&&!(1===(null==n?void 0:n.type))&&!(2===(null==n?void 0:n.type))&&!(r&&r.linkEntities&&Array.isArray(r.linkEntities)&&r.linkEntities.length>0)&&!a&&!(r&&r.filter&&Array.isArray(r.filter)&&r.filter.length>0)&&!d&&(null==p?void 0:p.queryType)!==F.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(D,u,V,L,G,t,d)?T.a.fromView(d,u.quickFindSearchString):o.a.fromXmlAndSql(h,p.offlineSqlQuery,d,u.quickFindSearchString,R,e);(null==g?void 0:g.filterString)&&r&&W.addExistingContextFilterToKey(i.a.toString(r),g.filterString);var z=Object(l.x)(e(),t,u.contextToken);z&&(W.pageNumber=z);var X=B(e(),t,n,u,p,R);X.length&&W.select.apply(W,X);var q=function(e,t,n,r,a,i){var o=null;if(!Object(P.a)(e,x.ub)||!i.hasGrid||1!==i.gridType)return null;var c=Object(l.j)(r)(e,t,i.contextToken),u=Object(s.b)(e),d=c&&c.CustomControls&&c.CustomControls[u]&&c.CustomControls[u].Parameters;if(!Object(l.vb)(d)&&(o=Object(l.o)(e,n))){var p=[],g=a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells;if(g)for(var h in g)g.hasOwnProperty(h)&&p.push(g[h].name);-1!==p.indexOf(o.lookupAttribute)&&(o.lookupAttribute=null),a&&a.fetchXML&&Object(E.b)(a.fetchXML)&&(o.primaryAttribute=null)}return o}(e(),t,R,d,p,u);q&&(q.lookupAttribute&&W.select(q.lookupAttribute),q.primaryAttribute&&W.addChildCountAttribute(q.primaryAttribute));var U=u.getCustomSorting&&u.getCustomSorting(p,c);if(U)for(var H=0,Y=U;H<Y.length;H++){var K=Y[H];W.orderBy(K.name,1===K.sortDirection)}if(V)switch(V.type){case 1:W.applyRollupContextFilter(V.entityReference,V.rollupType);break;case 2:var Q=Object(l.v)(D,t,u.contextToken);W.applyContextFilter(V.relationshipName,V.contextId,D,Q?Q.relationshipRoleOrdinal:void 0)}if(G&&W.where(G),L&&L.filter)if(Array.isArray(L.filter))for(var Z=0,J=L.filter;Z<J.length;Z++){var $=J[Z];W.where($,$.shouldReplace)}else!function(e){return!!(e&&e.operator&&e.terms)}($=L.filter)?W.where(Object(m.n)(L.filter,null)):W.where($,$.shouldReplace);if(L&&L.linkEntities)for(var ee=0,te=L.linkEntities;ee<te.length;ee++){var ne=te[ee];W.addLinkedEntity(ne,ne.attributes||[])}var re=u.recordsPerPage;if(re)W.pageSize=re;else{var ae=Object(b.h)(e());u.hasChart||Object(f.a)(ae)?W instanceof o.a&&W.setDefaultPageSize():W.pageSize=ae}return W}}function B(e,t,n,o,m,f){var b=Object(r.__spreadArrays)(function(e,t,n,r){if(0!==n.gridType)return[];var a="Grid",i=Object(s.b)(e),o=t&&Object(c.a)(n.control,t,i);o&&(a=Object(l.ab)(e,o.CustomControlId));return Object(u.b)(e,n.control.UniqueId,a,t&&t.Id,null,null,r)||[]}(e,n,o,m.viewId),function(e,t,n,r){if(1!==t.gridType)return[];return Object(u.a)(e,n,r)||[]}(e,o,f,m.viewId),function(e,t,n,r){var a=[],i=Object(d.h)(e,r);i&&(function(e,t,n){var r=Object(s.b)(e),a=t&&Object(c.a)(n.control,t,r);return a&&[a.CustomControlId&&a.Name].some((function(e){return-1!==k.indexOf(e)}))}(e,t,n)||n.hasGrid)&&("activitypointer"===r&&a.push("activitytypecode"),i.PrimaryNameAttribute&&a.push(i.PrimaryNameAttribute),Object(l.vb)(n.controlParameters)||i.PrimaryImageAttribute&&a.push(Object(E.a)(i.PrimaryImageAttribute)));return a}(e,n,o,f),function(e,t,n){var r=[];if(4&t.streamMode){r.push("modifiedon");var a=Object(I.d)(e,n);if(a)for(var i in a){var o=a[i];o.IsSortableEnabled&&"image"!==o.Type&&"multiselectpicklist"!==o.Type&&Object(p.b)(e,n,o.LogicalName,o)&&r.push(o.LogicalName)}}else 2&t.streamMode&&r.push("modifiedon");return r}(e,o,f),function(e,t,n,r){var o=[],s=n.cardFormId;if(s)if("activitypointer"===r)o.push.apply(o,p.a);else{var c=i.a.equals(s,a.a)?Object(g.h)(e,r,Object(h.a)(11)):s,l=Object(g.d)(e,c,t);if(l)for(var u in l){var d=l[u];d.DataFieldName&&o.push(d.DataFieldName)}}return o}(e,t,o,f),o.getCustomColumns?o.getCustomColumns():[]);if(b.length){var v=[],y=[],_=m&&m.grid&&m.grid.rows&&m.grid.rows[0]&&m.grid.rows[0].cells;if(_)for(var C in _)_.hasOwnProperty(C)&&y.push(_[C].name);for(var S in b){var O=b[S];-1===y.indexOf(O)&&-1===v.indexOf(O)&&v.push(O)}return v}return b}},"/W63":function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var r=n("ar+e"),a=n("VlhU"),i=n("bCrZ"),o=n("Gemh"),s=n("r2h9"),c=n("RlP9"),l=n("sgPk"),u=n("olrR"),d=n("uO/V"),p=n("7pqb"),g=n("s2by"),h=n("19Zc"),m=n("fE8x"),f=n("YrcW"),b=n("JlqV"),v=n("jigW"),y=n("G7N+"),_=n("qC0c"),C=n("cZkS"),S=n("5cS+"),O=n("gBKR"),I=d.x+"."+d.v;function j(e,t,n,r,a,s,u,d,p,m){var f=x(r,u,p),y=Object(c.c)(t,n);if(!y)return Promise.resolve(null);var S=l.a.fromXmlAndSql(y.fetchXML,y.offlineSqlQuery,n).getQueryState(),O=m||Object(o.db)(t,r,u),I=Object(v.c)(a,s),j=!1;Object(b.b)(t)&&Object(v.h)(t,s.relationshipName,!0)&&(j=!0);var E=Object(o.ub)(t,r);if(E||"activitypointer"===r||j){var T=t.user&&t.user.userId,w=Object(_.c)(t,C.Zc),A=Object(g.a)(r,T,s,w,E);return e(A.getFilterOptionsAction()).then((function(n){if(n&&n.length>0){var o=n.filter((function(e){return e.isDefault}));if(o&&o.length>0){var c=A.getFilterExpression(o[0].value);e(Object(h.l)(c,a,s))}}return e(Object(i.d)(S,r,a,s,null,u,O,j,I)).then((function(n){return P(e,n,t,r,a,f,d)}))}))}return e(Object(i.d)(S,r,a,s,null,u,O,void 0,I)).then((function(n){return P(e,n,t,r,a,f,d)}))}function P(e,t,n,r,a,s,c){var l=Object(m.c)(n),u=Object(m.b)(n);return(l||u)&&Object(o.sb)(n,r)&&Object(i.e)(c,e,r,a),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function x(e,t,n){return[{name:p.a.CorrelationId,value:n.correlationId},{name:p.a.ContextId,value:n.contextId},{name:p.a.ActionStack,value:n.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,n){var i=[{name:"EntityName",value:n.entityName}];return{type:"form.related.openGrid",execute:function(i,l,d){var g=i.dispatch,h=i.getState,m=h(),b=Object(r.e)(m,{id:e},t.parentContextToken),v=x(n.entityName,n.relationshipName,d);if(g(Object(a.b)(e,t,n)),null!==b&&b.id===n.id&&b.isSelected===n.isSelected&&b.relationshipName===n.relationshipName||g(Object(a.b)(e,t.parentContextToken,n)),g(Object(f.a)(e,n)),n&&!n.url){var P=function(e,t){return[{name:p.a.CorrelationId,value:e.correlationId},{name:p.a.ContextId,value:e.contextId},{name:p.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(d,n.entityName);if(!Object(o.v)(m,e,t)){g(Object(u.b)(n.entityName,s.a.MAIN_APPLICATION_VIEW));var E=Object(c.a)(m,n.entityName,s.a.SUB_GRID),T=Object(c.c)(m,E),w=Object(_.c)(m,C.Xc),A=!w||function(e,t){var n,r,a;if(!(null===(r=null===(n=null==t?void 0:t.grid)||void 0===n?void 0:n.rows)||void 0===r?void 0:r.length)||!(null===(a=e.metadata)||void 0===a?void 0:a.entities))return!0;var i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(var o=0;o<i.length;o++)if(i[o].relatedEntityName&&!e.metadata.entities[i[o].relatedEntityName])return!1;return!0}(m,T);return T&&T.initialized===y.a.Initialized&&A?(j(g,m,E,n.entityName,e,t,n.relationshipName,l,d,n.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),Promise.resolve(E)):g(Object(u.a)(n.entityName,s.a.SUB_GRID)).then((function(r){var a=Promise.resolve();if(w){var i=Object(S.a)(m,r,e);a=g(Object(O.e)(i))}return a.then((function(){var a=h();return j(g,a,r,n.entityName,e,t,n.relationshipName,l,d,n.ordinal).catch((function(e){l.EventManager.ReportComponentFailure(I,e,null,v)})),l.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",P),r}))}),(function(e){l.EventManager.ReportComponentFailure(I,e,null,v)}))}}return Promise.resolve(null)},getFailureParameters:function(e,t){return i}}}},"/lKk":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r=n("UGbr"),a=n("/j9Z"),i=n("71iK"),o=n("RYq1"),s=n("LFYt"),c=n("Ww2r"),l=n("HfRC"),u=n("yOMg"),d=n("VnuK"),p=n("rIXY"),g=n("Sscr"),h=n("HSdq"),m=n("yHpA"),f=n("zsi3"),b=n("+ieV"),v=n("Srej");function y(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute:function(t,n,y){var _=t.dispatch,C=(0,t.getState)(),S=Object(g.j)(C,e),O=Object(h.zb)(C,e,S),I=Object(h.ac)(C,e,S);if(!(!Object(m.g)(C,I)&&O&&Object.keys(O).length>0))return _(Object(r.e)(e,2)).then((function(t){var r=Object(h.Ib)(C,e),g=r?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(t){var m=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:t.etn}];return n.EventManager.ReportComponentSuccess(g,m),(r?Promise.resolve(e):_(Object(s.b)(e,t))).then((function(e){return _(Object(i.a)(t.etn)),function(e,t,n){var r="quickcreate_",a=Object(c.e)(t,[p.g,p.c]),i={actionLabel:Object(c.c)(a,p.g),eventHandler:function(){e(Object(l.a)(n)),e(Object(u.removeToastNotification)(r+n.id.guid))}},o=null,s={id:r+n.id.guid,type:1,level:1,message:Object(c.c)(a,p.c),title:null,action:i,onCloseHandler:o};e(Object(d.b)(s))}(_,C,t),_(Object(o.e)(e,"save")).then((function(){return t}))}))}return n.EventManager.ReportComponentSuccess(g,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new a.a("Record is not created"))}));for(var j in O){var P=O[j].label,x=O[j].errorMessage,E=_(Object(b.b)(P,x));_(Object(b.c)(S,e,E,f.a.error,Object(v.d)(e,j)))}}}}},"/wtJ":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("UOiB"),a=n("Sscr"),i=n("HSdq"),o=n("ObKm"),s=n("yHpA"),c=n("sOTk"),l=n("krRo"),u="attribute.precision";function d(e,t,n,d){return{type:"attribute.precision.update",sync:!0,execute:function(p,g){var h,m=p.dispatch,f=p.getState,b=f();m(function(e,t,n,i){if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)return Object(l.e)(e,t,n,i);var o=Object(a.x)(t);return{type:u,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}(e,t,n,d)),b=f();var v=null,y=null,_=null,C=null;if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)v=t.entityTypeName?t.entityTypeName:null,y=t.recordId?t.recordId:null,_=Object(a.t)(t),C=Object(a.r)(t);else{var S=Object(c.g)(b,e);v=S&&S.entityTypeName?S.entityTypeName:null,y=S&&S.id?S.id:null,_=null,C=t}var O=Object(i.ac)(b,e,t),I=Object(s.d)(b,O,{etn:v,id:y},n),j=((h={})[n]=I,h);m(Object(o.a)(e,j,!0,!0,v,y?y.guid:null,_,C))}}}},"0MLN":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="form.setLabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.v)(t);return{type:a,payload:{label:n},meta:{pageId:e,contextKey:i}}}},"0hCf":function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var r,a,i=n("HSdq"),o=n("yZTI"),s=n("Zy0S"),c=n("c/eZ"),l=n("FlW1"),u=n("ll2N"),d=n("s0Zj"),p=n("+Z9T"),g=n("w/nD"),h=n("ksD2"),m=n("A8fJ"),f=n("PLtI"),b=n("IiPO"),v=n("ezfI"),y=n("7ipg"),_=function(e){function t(t,n,a,i,o,s){var c=this;return Object(p.g)(o,"ClientApi.XrmTab.constructor","parent"),Object(p.g)(t,"ClientApi.XrmTab.constructor","store"),c=e.call(this,t,n,i,a)||this,r=t,c._parent=o,c._formContext=s,c._iConnectedTabProps={tabName:c.name,tabId:c._getTabId(),id:c.pageId,showTab:!0},c._clientApiExecutor=new y.b(r,"ClientApi.XrmTab.",n),c}return Object(c.__extends)(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){var e="ClientApi.XrmTab.sections";try{if(v.a.instance.reportCall(e),!this._sections){this._sections=new s.a(e);for(var t=r.getState(),n=Object(i.Gc)(t,this.pageId,this.name,this.contextToken),a=0;a<n.Columns.length;a++)for(var o=Object(i.p)(t,{id:this.pageId,tabName:n.Id,columnIndex:a},this.contextToken),c=null,l=0;l<o.SectionNames.length;l++)c=new u.a(r,this.contextToken,this.pageId,o.SectionNames[l],this,this._formContext),this._sections.add(c.getName(),c)}return v.a.instance.reportSuccess(e),this._sections}catch(t){var d=b.a.getInstance().getEventParameters(this.contextToken);throw d.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,d),t}},enumerable:!1,configurable:!0}),t.prototype.addTabStateChange=function(e){var t="ClientApi.XrmTab.addTabStateChange";Object(p.g)(e,t,"handler");try{v.a.instance.reportCall(t),r.dispatch(Object(g.s)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.removeTabStateChange=function(e){var t="ClientApi.XrmTab.removeTabStateChange";Object(p.g)(e,t,"handler");try{v.a.instance.reportCall(t),r.dispatch(Object(g.N)(this.contextToken,this.pageId,this.name,e)),v.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getDisplayState=function(){var e="ClientApi.XrmTab.getDisplayState";try{v.a.instance.reportCall(e);var t=Object(i.Dc)(r.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return v.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getParent=function(){return v.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent},t.prototype.setDisplayState=function(e){var t="ClientApi.XrmTab.setDisplayState";try{v.a.instance.reportCall(t);var n=!1;switch(e){case"collapsed":n=!0;break;case"expanded":n=!1;break;default:Object(p.h)(t,"TabDisplayState",e)}n||r.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess(t)}catch(e){var a=b.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.setFocus=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.setFocus"),r.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken)),v.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(t){var e=b.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",t,null,e),t}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTab.setVisible";try{v.a.instance.reportCall(t),r.dispatch(Object(h.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),v.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getLabel=function(){try{v.a.instance.reportCall("ClientApi.XrmTab.getLabel");var e=Object(i.Hc)(r.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return v.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){var t=b.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}},t.prototype.getVisible=function(){var e="ClientApi.XrmTab.getVisible";try{v.a.instance.reportCall(e);var t=Object(i.Kc)(r.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return v.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTab.setLabel";Object(p.g)(e,t,"label");try{v.a.instance.reportCall(t),r.dispatch(Object(f.b)(this.pageId,this.contextToken,this._getTabId(),e)),v.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),b.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype._getTabId=function(){var e=r.getState(),t=Object(i.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id},t.prototype.setContentType=function(e){var t=this;return this._clientApiExecutor.execute("setContentType",(function(){var n;switch(e){case"default":case"cardSections":n="cardSections";break;case"expandAvailableSpace":case"singleComponent":n="singleComponent";break;default:Object(p.h)("setContentType","TabContentType",e)}r.dispatch(Object(m.b)(t.pageId,t._getTabId(),t.contextToken,n))}),[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])},t.prototype.getContentType=function(){var e=this;return this._clientApiExecutor.execute("getContentType",(function(){var t;return null===(t=Object(i.Jc)(r.getState(),e._getTabId(),e._iConnectedTabProps.id,e.contextToken))||void 0===t?void 0:t.contentType}))},t}(l.a),C=n("9r0m"),S=n("tcXs"),O=n("UOiB"),I=n("i8/j"),j=n("sOTk"),P=n("/zIU"),x=n("1z64"),E=n("OTOS"),T=n("uQP8"),w=n("kvLG"),A=function(){function e(e,t,n,r,i,o,s){var c=Object(j.l)(e.getState(),n),l=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:n,isRequired:!0,isEventParam:!0},{name:"pageType",value:c,isEventParam:!0},{name:"formContext",value:r,isRequired:!0},{name:"entityName",value:i,isEventParam:!0},{name:"formSelectorType",value:s,isRequired:!0}];this._clientApiExecutor=new x.a(e,"ClientApi.XrmFormUIBase.",n,t,l),this._pageId=n,a=e,this._formContext=r,this._entityName=i,this._contextToken=t,this._formSelectorType=s,this.xrmControlFactory=o}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutor.execute("controls_get",(function(t,n){if(!e._controls){e._controls=new s.a(t);var r=(g=e.pageId,h=e.contextToken,m=e._controls,f=Object(T.b)(a.getState(),g,h),b=Object(E.b)(a.getState(),g),v=C.a.equals(f,b),y=Object(j.l)(a.getState(),g)===P.a.Dialog,_=Object(I.y)(a.getState(),f),S=_&&_.reduce((function(e,t){return e.add(t),e}),new Set),function(e,t){var n=Object(i.s)(a.getState(),{controlName:e,id:g},h),r=Object(i.Rc)(a.getState(),g,n);v&&r&&!y?S&&S.has(n.DataFieldName)&&Object(i.fd)(a.getState(),g,n,h)&&m.add(e,t):m.add(e,t)}),o=e.getFormDescriptor(t,n);if(o){var c={isEventParam:!0,name:"controlName",value:""},l={isEventParam:!0,name:"controlType",value:""};for(var u in n.push(c),n.push(l),o.Controls){var d=o.Controls[u];c.value=u,l.value=d&&d.ClassId?d.ClassId.guid:"";var p=e.xrmControlFactory.createXrmControl(e.contextToken,d,e._formContext,t,n);p&&r(p.getName(),p)}}}var g,h,m,f,b,v,y,_,S;return e._controls}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formSelector",{get:function(){var e=this;return this._clientApiExecutor.execute("formSelector_get",(function(t,n){if(!e._formSelector){var r=e.getFormDescriptor(t,n);r&&(e._formSelector=new e._formSelectorType(a,e._contextToken,r.Id,e._entityName,e._pageId))}return e._formSelector}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tabs",{get:function(){var e=this;return this._clientApiExecutor.execute("tabs_get",(function(t,n){if(!e._tabs){e._tabs=new s.a(t);var r=e.getFormDescriptor(t,n);if(r){var i=r.Tabs;for(var o in i){var c=new _(a,e._contextToken,i[o].Name,e._pageId,e,e._formContext);e._tabs.add(c.getName(),c)}}}return e._tabs}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),e.prototype.refreshRibbon=function(e){var t=this;void 0===e&&(e=!1),this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(S.a)(t._pageId,null,e))}))},Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formContext",{get:function(){var e=this;return this._clientApiExecutor.execute("formContext",(function(){return e._formContext}))},enumerable:!1,configurable:!0}),e.prototype.getControls=function(){if(!this._controls&&this.contextToken.contextTokenType===O.a.GridRow){var e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new s.a(e),this._controls}return this.controls},e.prototype.getFormDescriptor=function(e,t){var n=Object(i.fb)(a.getState(),{id:this._pageId},this._contextToken);if(!n){var r="Form descriptor not found";if(Object(o.n)(a.getState(),this._pageId))w.a.getInstance().traceManager.getTracer(e).error(r+": Page is dead",t);else if(this.contextToken.contextTokenType===O.a.GridRow)w.a.getInstance().traceManager.getTracer(e).error(r,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;var s=new Error(r);this._clientApiExecutor.reportFailure(e,s,t)}}return n},e}()},"0rak":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("Sscr"),a=n("uO/V"),i="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,n){return{type:"chart.drilldownparameters.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(a.z),p=a.x+".updateChartDrillDownParametersAction";try{d.info("Updating the chart drilldown parameters"),t||(t=Object(r.k)(u(),e));var g=Object(r.v)(t);return l(function(e,t,n){return{type:i,payload:{name:o,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,g,n)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Updatation of the chart drilldown parameters failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(h))}}}}},"0z0R":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("GUnN"),a=n("Ww2r"),i=n("JlqV"),o=n("kh6f"),s=n("mGpW"),c=n("Vm/X"),l=n("MLbG");function u(e,t){return{type:"offline.alert.dialog.async",execute:function(n,u){var d=n.dispatch,p=n.getState;if(Object(i.b)(p()))return o.c.info("Offline: Server is available"),Promise.resolve();var g=["Dialog_Button_Ok",e];return d(Object(s.e)(g)).then((function(){var n=Object(a.b)(p(),"Dialog_Button_Ok"),i=Object(a.b)(p(),e);return d(Object(l.a)(c.a,i,null,n,null,void 0,void 0,void 0,void 0,void 0,t)).then((function(e){return 0===e.status?(o.c.info("Offline: Alert dialog is created successfully with message "+i),Promise.resolve()):(o.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return o.c.error("Offline: Error in alert dialog creation "+Object(r.e)(e)),Promise.reject(e)}))}}}},"19Zc":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"l",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"h",(function(){return _})),n.d(t,"o",(function(){return h})),n.d(t,"j",(function(){return C}));var r=n("Sscr"),a=n("uO/V"),i=n("WS0f"),o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",p="grid.applyAdvancedFindFilter";function g(e,t,n,i){return{type:"grid.applyFilter.async",execute:function(o,s){var c=o.dispatch,l=s.TraceManager.getTracer(a.z),u=a.x+".applyGridFilterAction",d=Object(r.v)(i),p=[];p.push({name:a.n,value:e}),p.push({name:a.e,value:d});try{return l.info("Applying the filter expression to the grid. "),c(function(e,t,n,r){return{type:e,payload:t,meta:{pageId:n,dataSetContextKey:r}}}(e,t,n,d)),s.EventManager.ReportComponentSuccess(u,p),Promise.resolve()}catch(e){s.EventManager.ReportComponentFailure(u,Error("Applying the filter expression to the grid failed "),"",p)}}}}function h(e,t,n){var a=Object(r.v)(n);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:a}}}var m=function(e,t,n){return g(o,e,t,n)},f=function(e,t,n){return g(s,e,t,n)},b=function(e,t,n){return g(c,e,t,n)},v=function(e,t,n){return g(l,Object(i.a)(e)?e:e.trim(),t,n)},y=function(e,t,n){return g(u,e,t,n)},_=function(e,t,n){return g(d,e,t,n)},C=function(e,t,n){return g(p,e,t,n)}},"1PXy":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r,a=n("c/eZ"),i=n("1z64"),o=n("Gemh"),s=n("YCDx"),c=n("PZxu"),l=n("ildB"),u=n("3OsR"),d=n("+Z9T"),p=n("ME4N"),g=n("IiPO"),h=n("7bez"),m=n("h82J"),f=n("Sscr"),b=n("ezfI"),v=n("gBKR"),y=n("9r0m"),_="ClientApi.XrmControlTimeline.",C=function(e){function t(t,n,a,o,s,c,l,u){var d=e.call(this,t,n,a,o,s,l)||this;return d._defaultLabel=p.u.Timeline,r=t,d._applicationContext=u,d._controlId=c,d._traceManager=u.TraceManager,d._subgridToken=Object(f.p)(n,s),d._clientApiExecutorTimeline=new i.a(t,_,a,n),d._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:s,isEventParam:!0,expectedDataType:"string"}),d._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:c,isEventParam:!0,expectedDataType:"string"}),d._gridControl=new h.a(t,d._subgridToken,a,!1,3,!0,u,s),t.dispatch(Object(m.a)(d,a,d._subgridToken)),d}return Object(a.__extends)(t,e),t.prototype.getControlType=function(){return b.a.instance.reportUsage(_+"getControlType"),"timelinewall"},t.prototype.getName=function(){var e=this;return this.clientApiExecutor.execute("getName",(function(){return e.controlDescriptor&&e.controlDescriptor.Parameters&&e.controlDescriptor.Parameters[p.s.UClientUniqueName]?e.controlDescriptor.Parameters[p.s.UClientUniqueName]:p.u.Timeline}))},t.prototype.getLabel=function(){var e=_+"getLabel";try{b.a.instance.reportCall(e);var t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(d.a)(this.controlDescriptor.Parameters[p.s.Label])?this.controlDescriptor.Parameters[p.s.Label]:this._defaultLabel?this._defaultLabel:"";return b.a.instance.reportSuccess(e),t}catch(t){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setLabel=function(t){var n=_+"setLabel";try{b.a.instance.reportCall(n),e.prototype.setLabel.call(this,t),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[p.s.Label]=t:this._defaultLabel=t,b.a.instance.reportSuccess(n)}catch(e){var r=g.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(n,e,null,r),e}},t.prototype.openEmail=function(e){var t=_+"openEmail";try{b.a.instance.reportCall(t),r.dispatch(Object(l.t)(this._controlId,e)),r.dispatch(Object(l.o)(this._controlId,u.a.ContextualDialogEntity,2,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.refresh=function(e){var t=_+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{b.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[p.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[p.s.UClientActivities]=e.activities)),r.dispatch(Object(l.o)(this._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(t)}catch(e){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setTargetEntity=function(e,t,n){var a=this;void 0===n&&(n=!0);var i=_+"setTargetEntity";try{b.a.instance.reportCall(i);var o={etn:e,id:t,isAPI:!0},s={};return s[e]=[],r.dispatch(Object(l.v)(this._controlId,o)),r.dispatch(Object(v.e)(s)).catch((function(t){var n=g.a.getInstance().getEventParameters(a.contextToken);throw n.push({name:"controlName",value:a.getName()}),n.push({name:"entityName",value:e}),g.a.getInstance().reportFailure(i+"-retrieveEntities",t,null,n),t})).then((function(){n&&r.dispatch(Object(l.o)(a._controlId,u.a.InitiateRefresh,1,y.a.toString(y.a.newGuid()))),b.a.instance.reportSuccess(i)}))}catch(e){var c=g.a.getInstance().getEventParameters(this.contextToken);throw c.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(i,e,null,c),e}},t.prototype.getGrid=function(){var e=_+"getGrid";try{return b.a.instance.reportCall(e),this._grid||(this._grid=new c.a(r,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),b.a.instance.reportSuccess(e),this._grid}catch(n){var t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(r.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return b.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(r.getState(),e.pageId,e.contextToken)}))},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{b.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(n){var t=g.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),g.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getEntityName=function(){return b.a.instance.reportUsage(_+"getEntityName"),"activitypointer"},t.prototype.getUrl=function(){var e=g.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""},t.prototype.getFilterXml=function(){var e=_+"getFilterXml",t=g.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getFetchXml=function(){var e=_+"getFetchXml",t=g.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),""},t.prototype.getViewSelector=function(){var e=_+"getViewSelector",t=g.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.getTeamTemplateId=function(){return null},t.prototype.getRelationship=function(){var e=_+"getRelationship",t=g.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e),null},t.prototype.setFilterXml=function(e){var t=_+"setFilterXml",n=g.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),b.a.instance.reportUsage(t)},t.prototype.addOnLoad=function(e){var t=g.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),b.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")},t.prototype.removeOnLoad=function(e){var t=_+"removeOnLoad",n=g.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),b.a.instance.reportUsage(t)},t.prototype.openRelatedGrid=function(){var e=_+"openRelatedGrid",t=g.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),b.a.instance.reportUsage(e)},t}(s.a)},"2n3f":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("ZVHh"),a=n("GDI2"),i=n("jV4X");function o(e,t){return{type:"Navigate to sitemap area",execute:function(n,o){var c=Object(a.b)(n.getState()),l=e&&function(e,t){if(!t||!e||!e.AreaIds)return null;for(var n=e.Areas[t],r=0,a=n.GroupIds;r<a.length;r++)for(var o=a[r],c=n.Groups[o],l=0,u=c.SubAreaIds;l<u.length;l++){var d=u[l],p=c.SubAreas[d];if(!Object(i.f)(p)&&s(p))return p}return null}(c,e);if(l)return n.dispatch(Object(r.c)(l,!1,null,t))}}}function s(e){return!e.Url||!e.Url.toLowerCase().endsWith("msdyn_launchdesigner.html")}},"2ojE":function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("VcAV"),a=n("/j9Z"),i=n("yHpA"),o=n("LhJP"),s=n("9r0m"),c=n("TCcM"),l=n("T576"),u=n("sOTk"),d=n("WS0f");function p(e,t,n,r){var a=[];try{var i=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,o=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,d=i&&!s.a.equals(i,s.a.EMPTY)?function(e,t){var n=Object(l.a)(e,t);if(n)return n.businessProcessFlowProcessState;return null}(e,i):0,p=Object(u.l)(e,n),g={name:"ProcessId",value:i?s.a.toString(i):s.a.EMPTYGUIDSTRING},h={name:"ProcessInstanceId",value:o?s.a.toString(o):s.a.EMPTYGUIDSTRING},m={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},f={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},b={name:"ProcessState",value:d},v={name:"PageId",value:n||""},y={name:"PageType",value:p};a.push(g),a.push(h),a.push(m),a.push(f),a.push(b),a.push(v),a.push(y)}catch(e){r.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,a)}return a}function g(e,t,n){n.EventManager.ReportComponentSuccess(e,t)}function h(e,t,n,s,c,l,u){!function(e,t){if(!Object(r.c)(e)){var n=Object(a.c)(e);if(!Object(r.c)(n)){var i=n.errorCode;if(!Object(r.c)(i)){var o={name:"ErrorCode",value:"0x"+i.toString(16)};t.push(o)}}}}(t,s),function(e,t,n,s){if(!Object(r.c)(e)){var c=Object(a.c)(e);if(!Object(r.c)(c)&&!Object(r.c)(c.FaultedSnapshotId)){var l={name:o.p,value:c.FaultedSnapshotId};if(t.push(l),!Object(r.c)(n)&&!Object(r.c)(s)){var u=Object(i.c)(s,n);if(!Object(r.c)(u)){var p=u.snapshotId;if(!Object(r.c)(p)&&!Object(d.b)(p)&&p===c.FaultedSnapshotId){var g={name:o.q,value:"serverSideCurrentForm"};t.push(g)}}}}}}(t,s,l,u),c.EventManager.ReportComponentFailure(e,t,n,s)}},"3INI":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("90Ov"),a=n("WS0f"),i=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this._traversedPath},set:function(e){for(this._traversedPath=Object(r.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(r.a)(this._traversedPath)},enumerable:!1,configurable:!0}),e.getCandidateTraversedPathFromStagStep=function(e,t){t=Object(r.a)(t);var n=!1;if(!e||e.length)return null;for(var a=0;a<e.length;a++){var i=Object(r.a)(e[a].get_stageId());if("".concat(i,","),t===i){n=!0;break}}return n?"".substring(0,"".length-2):null},e.prototype.isInTraversedPath=function(e){return!Object(a.b)(e)&&this._traversedPath.indexOf(Object(r.a)(e))>-1},e}()},"3Ng8":function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("FlM9"),a=n("CUpQ"),i=n("HSdq"),o=n("ar+e"),s=n("l9yF");var c=[r.b];function l(e,t){var n=Object(i.Ib)(e,t)?a.u:a.t;return n=n.concat(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){var n=[];if(c)for(var r=0,a=c;r<a.length;r++){var i=a[r];n=n.concat(i(e,t))}return n}(e,t))}function u(){var e=[];return e=(e=(e=(e=e.concat(Object.values(o.a).map((function(e){return e.reason})))).concat(Object.values(o.b))).concat(Object.values(s.a))).concat(Object.values(i.b).map((function(e){return e.reason})))}},"4HtA":function(e,t,n){"use strict";n.d(t,"a",(function(){return ct}));var r,a=n("c/eZ"),i=n("DRVD"),o=n.n(i),s=n("sOTk"),c=n("r0tX"),l=n("6FBX"),u=n("UGbr"),d=n("UTiY"),p=n("c3W+"),g=n("EGdP"),h=n("/j9Z"),m=n("9r0m"),f=n("T576"),b=n("Y70o");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(r||(r={}));var v=function(){function e(e,t){this._getState=e,this._processId=t}return e.prototype.GenerateMessageForAction=function(e){var t="",n="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",a=this._getState(),i=Object(b.a)(a,n,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(b.a)(a,n,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(b.a)(a,n,"Crm_GenericErrorMessage");switch(e){case r.Completed:t=String.format(i,(new Date).toLocaleString());break;case r.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t},e.prototype.GetActionMetadata=function(e){var t,n=Object(f.a)(this._getState(),new m.a(this._processId.guid));return n&&n.businessProcessFlowActions&&n.businessProcessFlowActions[e]&&(t=n.businessProcessFlowActions[e]),t},e.prototype.InvokeProcessAction=function(e,t,n){return Xrm.Utility.invokeProcessActionInternal(e,n,t)},e}(),y=n("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(e){if(!e)return null;var t=function(e){var t=[];return e.forEach((function(e){var n={id:m.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(n)})),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function C(e,t,n,r){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:function(a,i){a.dispatch,a.getState;return function(e,t,n,r,a){return e.retrieveNavigationEntities(t,n,r,a,null).nativePromise().then(_,h.b)}(i.DataSource,e,t,n,r)}}}var S=n("mLFd"),O=n("GWjq"),I=n("phfH"),j=function(){function e(e,t){this.Target=e,this.NewProcess=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),P=function(){function e(e,t,n){this.Target=e,this.NewProcess=t,this.NewProcessInstance=n}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}},e}(),x=n("RVz9"),E=n("IBKq");function T(e,t,n,r,a,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:function(o,s){o.dispatch,o.getState;return function(e,t,n,r,a,i,o){var s=new E.a(m.a.toLegacyGuid(t.id),t.etn,m.a.toLegacyGuid(n.id),n.etn,m.a.toLegacyGuid(r),a,m.a.toLegacyGuid(i),m.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(s.DataSource,e,t,n,r,a,i)}}}var w=n("Ia1G"),A=function(){function e(e,t){this.EntityId=e,this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}},e}();var F=function(){function e(e,t){this.EntityLogicalName=e,this.AppModuleId=t}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}},e}(),N=n("4tno");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k,M=function(){function e(e,t,n){this._name=e,this._uniqueName=t,this._workflowId=n}return Object.defineProperty(e.prototype,"workflowId",{get:function(){return this._workflowId},set:function(e){this._workflowId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uniqueName",{get:function(){return this._uniqueName},set:function(e){this._uniqueName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),e}(),D=n("9rlF"),R=function(){function e(){}return Object.defineProperty(e.prototype,"activeStageId",{get:function(){return this._activeStageId},set:function(e){this._activeStageId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceId",{get:function(){return this._businessProcessInstanceId},set:function(e){this._businessProcessInstanceId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessInstanceName",{get:function(){return this._businessProcessInstanceName},set:function(e){this._businessProcessInstanceName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessState",{get:function(){return this._businessProcessState},set:function(e){this._businessProcessState=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessStatus",{get:function(){return this._businessProcessStatus},set:function(e){this._businessProcessStatus=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},set:function(e){this._navigationEntities=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bpfDefinitionVersionNumber",{get:function(){return this._bpfDefinitionVersionNumber},set:function(e){this._bpfDefinitionVersionNumber=e},enumerable:!1,configurable:!0}),e}(),L=n("3INI"),B=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryField",{get:function(){return this._primaryField},set:function(e){this._primaryField=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityTypeCode",{get:function(){return this._entityTypeCode},set:function(e){this._entityTypeCode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"entityLogicalName",{get:function(){return this._entityLogicalName},set:function(e){this._entityLogicalName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"primaryKeyName",{get:function(){return this._primaryKeyName},set:function(e){this._primaryKeyName=e},enumerable:!1,configurable:!0}),e}(),V=n("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(k||(k={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var G,W=function(){function e(e){this._stageManager=e,this._populateTraversedPath()}return e.prototype.getTraversedPath=function(){return this._traversedPath},e.prototype._populateTraversedPath=function(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path},e}(),z=n("7kKV"),X=n("AqA3"),q=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.invalid,r.stageInvalidReason=X.a.invalid,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),U=(function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.crossEntity,r.stageInvalidReason=X.a.crossEntity,Object.setPrototypeOf(r,t.prototype),r}Object(a.__extends)(t,e)}(Error),function(e){function t(n){var r=e.call(this,n)||this;return r.stageInvalidReason=X.a.unreachable,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error)),H=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.dirtyForm,r.stageInvalidReason=X.a.dirtyForm,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),Y=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.end,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),K=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.beginning,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),Q=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.stageGate,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),Z=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.invalidProcess,r.stageInvalidReason=X.a.invalidProcess,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),J=function(e){function t(n){var r=e.call(this,n)||this;return r.navigationStatus=z.a.dirtyForm,r.stageInvalidReason=X.a.dirtyForm,Object.setPrototypeOf(r,t.prototype),r}return Object(a.__extends)(t,e),t}(Error),$=n("QAhb"),ee=n("TVue"),te=n("rQCE"),ne=n("lFQy"),re=n("Jcuz"),ae=n("690X"),ie=n("eA/s"),oe=n("jJRu"),se=n("g9bv"),ce=n("r454"),le=n("OROb"),ue=n("qYad"),de=n("TCcM"),pe=n("cAHA"),ge=n("Sscr"),he=n("yHpA"),me=n("LteD"),fe=n("BFwB"),be=function(e){function t(t,n,r){var a=e.call(this,"BusinessProcessFlow_"+t)||this;return a.addEventParameter("ProcessId",n),a.addEventParameter("ProcessInstanceId",r),a}return Object(a.__extends)(t,e),t}(fe.a),ve=function(e){function t(t,n){return e.call(this,"Initialized",t,n)||this}return Object(a.__extends)(t,e),t}(be),ye=function(e){function t(t,n,r){var a=e.call(this,"SetActiveStageEvent",t,n)||this;return a.addEventParameter("ActiveStageId",r),a}return Object(a.__extends)(t,e),t}(be),_e=function(e){function t(t,n,r){var a=e.call(this,"DisplayStateEvent",t,n)||this;return a.addEventParameter("CurrentDisplayState",r),a}return Object(a.__extends)(t,e),t}(be),Ce=function(e){function t(t,n,r,a){var i=e.call(this,"StatusEvent",t,n)||this;return i.addEventParameter("ProcessStatus",r),i.addEventParameter("CurrentDisplayState",a),i}return Object(a.__extends)(t,e),t}(be),Se=n("txwV"),Oe=n("WS0f"),Ie=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}},e}(),je=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}},e}(),Pe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}},e}(),xe=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}},e}(),Ee=n("K1ho"),Te=n("ObKm"),we=n("uwKl"),Ae=n("ed60");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(G||(G={}));var Fe=n("2ojE"),Ne=n("LhJP"),ke=n("lMVv"),Me=n("GHPx"),De=n("h82J"),Re=n("VcAV"),Le=function(){function e(e,t){this._getState=e,this._applicationContext=t}return e.prototype.setBpfInstance=function(e){return this._processInstance=e,this},e.prototype.setBpfInstanceName=function(e){return this._processInstanceName=e,this},e.prototype.setProcess=function(e){return this._process=e,this},e.prototype.setProcessId=function(e){return this._processId=e,this},e.prototype.setFormEntity=function(e){return this._formEntity=e,this},e.prototype.GetFlowStepMetadata=function(e,t){var n=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),r=this._processId&&this._processId.guid||null,a=Object(f.a)(this._getState(),m.a.tryParse(r));if(Object(Re.c)(a))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+a),null;var i=a.businessProcessFlowFlows;if(Object(Re.c)(i))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;var o=i[e];return Object(Re.c)(i)?(n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o},e.prototype.openFlowWidget=function(e,t){if(m.a.tryParse(e.flowStepId)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);var n=this._populateFlowDialogParams(e,t),r={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",r,n)},e.prototype._populateFlowDialogParams=function(t,n){var r=this.GetFlowStepMetadata(t.flowStepId,this._applicationContext);if(Object(Re.c)(r))throw new Error("BPF Flow Step Failure: null metadata");var a={},i=r.flowId;if(Object(Re.c)(i))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){var o=[];o.push(this._processInstance.id.guid);var s=JSON.stringify(o);a.entity_ids=s}a.flow_id=i,a.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),a.bpf_step_id=t.flowStepId;var c=Xrm.Page.data.entity.getEntityName(),l=this._getState().metadata.entities[c].EntitySetName,u=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");a.entity_logical_collection_name=l,a.entity_logical_name=c,a.flows_destination_url=u,a.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");var d=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");a.flows_fpi_site_url=d+"&flowsEnableWidgetV2=true",a.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),a.flows_enable_widget_v2=!0,e.UpdateEventParameter(n,"flows_destination_url",u),e.UpdateEventParameter(n,"flow_id",i),Object(Re.c)(t.workflowLogId)||t.workflowLogId===m.a.EMPTY||(a.flows_wflog_id=m.a.toString(t.workflowLogId));var p=this._processInstance&&this._processInstance.id;if(Object(Re.c)(p)||p===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+p);a.bpf_instance_id=m.a.toString(p);var g=this._processInstance&&this._processInstance.etn;if(Object(Oe.b)(g))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+g);a.bpf_instance_entity_name=g;var h=this._processId&&this._processId.guid||null;if(m.a.tryParse(h)===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+h);a.bpf_definition_id=h,a.bpf_definition_entity_name="workflow";var f=this._process&&this._process.get_Name();if(Object(Oe.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+f);if(a.bpf_definition_name=f,Object(Oe.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);a.bpf_instance_name=this._processInstanceName;var b=t.selectedStage&&t.selectedStage.get_Description();if(Object(Oe.b)(b))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+b);a.bpf_flowstage_localized_name=b,a.bpf_flowstage_entity_name=c,a.bpf_flowstage_entity_collection_name=l;var v=this._formEntity&&this._formEntity.id;if(Object(Re.c)(v)||v===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+v);a.bpf_flowstage_entity_record_id=m.a.toString(v);var y=m.a.tryParseOrNull(t.activeStage&&t.activeStage.get_Id()||"");if(Object(Re.c)(y)||y===m.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+y);a.bpf_activestage_id=m.a.toString(y);var _=t.activeStage&&t.activeStage.get_Description();if(Object(Oe.b)(_))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+_);return a.bpf_activestage_localized_name=_,a.bpf_activestageentity_name="processstage",a},e.prototype._getLocalizedLabel=function(e){return Xrm.Utility.getResourceString("Main_system_library",e)},e.getTelemetryParamsForFlowStep=function(e,t,n,r,a){var i=a||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:n},l={name:"bpf_step_id",value:r};return i.push(o),i.push(s),i.push(c),i.push(l),i},e.UpdateEventParameter=function(e,t,n){e&&0!==e.length&&e.some((function(e){if(e.name===t)return e.value=n,!0}))},e}(),Be=n("qC0c"),Ve=n("pflg"),Ge=n("UWFM"),We=n("b1hT"),ze=n("tvev"),Xe=n("RK8T"),qe=n("xc1f"),Ue=n("yZTI"),He=n("UVKb"),Ye=n("j+yI"),Ke=n("OTOS"),Qe=n("uQP8"),Ze=n("lKeh"),Je=n("IQF2"),$e=n("buKK"),et=n("+D0h"),tt=n("YEEA"),nt=n("2nMH"),rt=o.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),at=o.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),it=o.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),ot=o.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),st=o.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager"),ct=function(){function e(e,t,n,r,a){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=n,this._stageMetadata=r,this._activeStageManager=a}return e.prototype.initilaizeWithProcessAndFormEntity=function(e,t,n,r,a,i){var o=this,s=rt.startStopwatch({processId:m.a.toString(r),processInstanceId:m.a.toString(a.id)});this._currentPageId=i,this._processId=r,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=n,this._currentBpfInstance=a,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);var c=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(c),this._stageMetadata.initializeDefaultPathManager(new W(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;var l={};if(this._isUserSelectedStage)l.selectedStageId=m.a.tryParseOrNull(this.getSelectedStageId());else{var u=this.getActiveStageId();this._isActiveStageInCurrentEntity(u)?l.selectedStageId=m.a.tryParseOrNull(u):l.selectedStageId=this._getDefaultSelectedStageId()||m.a.tryParseOrNull(u)}this._dispatch(Object(ne.a)(l,this._currentBpfInstance));var d=new ve(m.a.toString(r),m.a.toString(a.id));this._applicationContext.EventManager.ReportEvent(d),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then((function(e){e&&e.getEventManager().addOnProcessChangeEvent(o.getContextToken(),(function(){o._saveCrossEntityBpf()}))}))),Object(We.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new v(this._getState,r),this._flowStepManager=new Le(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(f.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(We.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var p=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.g).error("ProcessManager is initialized with current entity as null",p);Object(Fe.c)(Ne.g,p,this._applicationContext),s()},e.prototype._saveCrossEntityBpf=function(){var e=this._getState(),t=Object(s.g)(e,this._currentPageId),n=Object(Ve.a)(t),r=Object(Ve.b)(t);if(n&&r){var a=new $.a(t.data.parentrecordtype,new m.a(t.data.parentrecordid)),i=new $.a(t.entityTypeName,t.id);this._dispatch(Object(we.b)(n,i)),this._dispatch(Object(Ae.b)(r,i)),this.navigateToNextEntityForCrossEntityBpf(a,i,n,r)}},e.prototype.initilaizeWithFormEntityOnly=function(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(We.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(We.f)(this._getState())&&Ge.a.Instance.setProcessManagerByPageId(this._currentPageId,this);var n=this.getTelemetryParams();this._currentFormEntity||this._applicationContext.TraceManager.getTracer(Ne.f).error("ProcessManager is initialized with current entity as null",n);Object(Fe.c)(Ne.f,n,this._applicationContext)},e.prototype.setActiveProcess=function(e){var t=this;return new Promise((function(n,r){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new h.a("Current form entity is not initialized.",2147877745);return Object(Fe.b)(Ne.m,i,null,a,t._applicationContext,null,t._getState()),void r(new h.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);if(!o)return Object(Fe.c)(Ne.m,a,t._applicationContext),void r(new Error("Invalid process id"));if(m.a.isNullOrEmpty(t.getCurrentFormEntity().id))return Object(Fe.c)(Ne.m,a,t._applicationContext),void r(new h.a("Not supported on new records",2147877748));var s=new j({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(x.b)(s)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcess"),Object(Fe.c)(Ne.m,a,t._applicationContext),n()}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return r(e)})),Object(Fe.b)(Ne.m,e,null,a,t._applicationContext,null,t._getState())}))}))},e.prototype.setActiveProcessInstance=function(e){var t=this;return new Promise((function(n,r){var a=t.getTelemetryParams();if(!t.getCurrentFormEntity()){var i=new h.a("Current form entity is not initialized.",2147877745);return Object(Fe.b)(Ne.n,i,null,a,t._applicationContext,null,t._getState()),void r(new h.a("Current form entity is not initialized",2147877745))}var o=m.a.tryParseOrNull(e);o?t.getProcessInstances().then((function(e){if(e&&e.value){for(var a="",i=0,s=e.value;i<s.length;i++){var c=s[i];if(c&&c.businessprocessflowinstanceid&&c.businessprocessflowinstanceid.toLowerCase()===m.a.toString(o).toLowerCase()){a=c["a_processid_value".substring(1)];break}}if(Object(Oe.b)(a))r(new h.a("Supplied process instance does not match any existing instance on this entity",2147877744));else{var u=m.a.tryParseOrNull(a);if(u){var p=new P({id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn},{id:m.a.toString(u),entityType:l.fc},{id:m.a.toString(o),entityType:l.fc});t._dispatch(Object(x.b)(p)).then((function(){t._executePostEvent("runOnProcessChange","setActiveProcessInstance"),n(a)}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return r(e)}))}))}else r(new Error("Invalid process id"))}}else r(new Error("No process instances found for current entity"))}),(function(e){t._dispatch(Object(d.b)(e,!0)).then((function(){return r(e)}))})):r(new Error("Invalid process instance id"))}))},e.prototype.setCurrentInstance=function(e){this._currentBpfInstance=e},e.prototype.setStatus=function(e){var t=this;return new Promise((function(n,r){var a;if(e||r(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===V.a.Active)a=t.reactivateProcess();else if(e===V.a.Finished)a=t.completeProcess();else{if(e!==V.a.Aborted)return r(new Error("Invalid status passed to setStatus"));a=t.abandonProcess()}a.then((function(){var r=new Ce(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e,t.getDisplayState());t._applicationContext.EventManager.ReportEvent(r),n()}),(function(e){r(e)}))}))},e.prototype.setVisible=function(e){if(!(Object(Oe.a)(this._currentBpfInstance)||Object(Oe.a)(this._currentFormEntity)||Object(Oe.a)(this._currentFormEntity.etn))){var t=Object(ge.h)(this._currentFormEntity.etn);this._dispatch(Object(me.b)(this._currentPageId,Se.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}},e.prototype.isVisible=function(){if(!this._currentBpfInstance)return!1;var e=Object(ge.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:Se.a},e)},e.prototype.getCurrentFormEntity=function(){return this._currentFormEntity},e.prototype.getActiveStageEntityRef=function(){var e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,n=this._getNavigationEntityIdsByEntityLogicalName();return t&&n&&n.hasOwnProperty(t)?new $.a(t,n[t]):null},e.prototype.getProcess=function(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()},e.prototype.getProcessInstanceName=function(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this._currentBpfInstance)},e.prototype.getTraversedPath=function(){return Object(O.h)(this._getState(),this._currentBpfInstance)},e.prototype.getProcessId=function(){return this._processId},e.prototype.getVersion=function(){return this._version},e.prototype.getProcessInstanceId=function(){return this._currentBpfInstance&&this._currentBpfInstance.id},e.prototype.getBpfEntityLogicalName=function(){return this._currentBpfInstance&&this._currentBpfInstance.etn},e.prototype.getEntityStages=function(){return this._stageMetadata.getEntityStages()},e.prototype.getActiveStage=function(){return this._getStage(this.getActiveStageId())},e.prototype.getProcessInstances=function(){var e=this;return new Promise((function(t,n){var r,a;e._dispatch((r=e._currentFormEntity.id,a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute:function(e,t){e.dispatch;var n=e.getState,i=t.DataSource.get_WebAPIService(),o=new A(r,a),s=Object(w.a)(n(),o);return i.sendRequest(s).then((function(e){return e.json()}),h.b)}})).then((function(e){t(e)}),(function(e){n(e)}))}))},e.prototype.getSelectedStage=function(){return this._getStage(this.getSelectedStageId())},e.prototype.isCrossEntityNavigation=function(e){var t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;var n=this._stageMetadata.getStage(t);if(!n)return!1;var r=n.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&r&&r.get_EntityLogicalName()!==this._currentFormEntity.etn},e.prototype._isStageOnPath=function(e,t){for(var n=0,r=t;n<r.length;n++){var a=r[n];if(m.a.equals(a,e))return!0}return!1},e.prototype.getProcessState=function(){var e=Object(f.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null},e.prototype.getState=function(){if(this._currentBpfInstance){var e=Object(O.f)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getStatusName=function(){if(this._currentBpfInstance){var e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e)return e.label}return null},e.prototype.getStatus=function(){if(this._currentBpfInstance){var e=Object(O.g)(this._getState(),this._currentBpfInstance);if(e){var t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null},e.prototype.getActiveStageId=function(){if(this._currentBpfInstance){var e=this._currentBpfInstance&&Object(O.a)(this._getState(),this._currentBpfInstance);if(m.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){var t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=m.a.tryParseOrNull(t))}if(!m.a.isNullOrEmpty(e)){var n=this.getActivePath();if(n&&n.length>0)return this._isStageOnPath(e,n)?e.guid:n[0].guid}}return null},e.prototype.getActivePathStages=function(){var e=this.getActivePath();if(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=this._getStage(e[n].guid);return t}return null},e.prototype.getActivePath=function(){if(!this._currentBpfInstance)return null;var e=Object(I.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e},e.prototype.getDisplayState=function(){return this._currentBpfInstance?Object(I.d)(this._getState())||c.a.getDefaultDisplayState():null},e.prototype.getSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()},e.prototype._getDefaultSelectedStageId=function(){if(!this._currentBpfInstance)return null;var e=Object(I.g)(this._getState(),m.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e},e.prototype._isActiveStageInCurrentEntity=function(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0},e.prototype.getStageMetadata=function(){return this._stageMetadata},e.prototype.isBusinessProcessAborted=function(){return this.getStatus()===V.a.Aborted},e.prototype.isBusinessProcessCompleted=function(){return this.getStatus()===V.a.Finished},e.prototype.moveToNextStage=function(){var e=this,t=this.getTelemetryParams(),n=new Promise((function(t,n){if(Object(Oe.a)(e._currentBpfInstance))return n(new h.a("Process Control does not exist on form.",2147877746));var r=e._stageMetadata.getNextStageId(e.getActiveStageId());if(r){t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._saveFormDataAndActiveStage(m.a.tryParseOrNull(r),0,"MoveToNextStage")})))}else n(new Y("Last stage in the active path reached. Next stage does not exist."))}));return n.then((function(){Object(Fe.c)(Ne.h,t,e._applicationContext)}),(function(n){e._shouldReportErrorAsSuccess(n)?Object(Fe.c)(Ne.h,t,e._applicationContext):Object(Fe.b)(Ne.h,n,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),n},e.prototype.moveToPreviousStage=function(){var e=this,t=this.getTelemetryParams(),n=new Promise((function(t,n){if(Object(Oe.a)(e._currentBpfInstance))return n(new h.a("Process Control does not exist on form.",2147877746));var r=e._stageMetadata.getPreviousStageId(e.getActiveStageId());if(!r)return n(new K("The first stage in the traversed path reached. Previous stage does not exist."));t(e._saveFormDataAndActiveStage(m.a.tryParseOrNull(r),1,"MoveToPreviousStage"))})).then((function(){e._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e.getActiveStageId())}));return n.then((function(){Object(Fe.c)(Ne.i,t,e._applicationContext)}),(function(n){e._shouldReportErrorAsSuccess(n)?Object(Fe.c)(Ne.i,t,e._applicationContext):Object(Fe.b)(Ne.i,n,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),n},e.prototype.setActiveStage=function(e){var t=this,n=at.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId()),stageId:e}),r=this.getTelemetryParams(),a=new Promise((function(n,r){var a=m.a.tryParseOrNull(e),i=t.getTraversedPath();if(Object(Oe.a)(t._currentBpfInstance))return r(new h.a("Process Control does not exist on form.",2147877746));if(!a)return r(new q("setActiveStage can only be called with a valid stage id"));if(!t._stageMetadata.getStage(a.guid))return r(new q("stage id does not exist on any path of the instance"));if(!i)return r(new q("Traversed Path is not present"));if(t.getActiveStageId()===a.guid)return n();var o=new L.a(i);if(!o||!o.isInTraversedPath(e))return r(t.getActivePath().some((function(e){return m.a.equals(e,a)}))?new q("The stage is not in traversed path. Only navigating backwards is supported."):new U("stage id does not exist on the current acitve path of the instance."));n(t._saveFormDataAndActiveStage(a,1,"SetActiveStage"))})).then((function(){var n=new ye(m.a.toString(t._processId),m.a.toString(t.getProcessInstanceId()),e);t._applicationContext.EventManager.ReportEvent(n),t._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)}));return a.then((function(){n(),Object(Fe.c)(Ne.o,r,t._applicationContext)}),(function(e){n(),t._shouldReportErrorAsSuccess(e)?Object(Fe.c)(Ne.o,r,t._applicationContext):Object(Fe.b)(Ne.o,e,null,r,t._applicationContext,t.getCurrentFormEntity(),t._getState())})),a},e.prototype.switchProcess=function(){},e.prototype.abandonProcess=function(){var e=this,t=this.getTelemetryParams(),n=new Promise((function(t,n){return Object(Oe.a)(e._currentBpfInstance)?n(new h.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessAborted()?t():void t(e._updateStateAndStatusOfProcess(V.a.Aborted,k.Inactive,"AbandonProcess"))}));return n.then((function(){Object(Fe.c)(Ne.a,t,e._applicationContext)}),(function(n){e._shouldReportErrorAsSuccess(n)?Object(Fe.c)(Ne.a,t,e._applicationContext):Object(Fe.b)(Ne.a,n,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),n},e.prototype.reactivateProcess=function(){var e=this,t=this.getTelemetryParams(),n=new Promise((function(t,n){return Object(Oe.a)(e._currentBpfInstance)?n(new h.a("Process Control does not exist on form.",2147877746)):e.getStatus()===V.a.Active?t():void t(e._updateStateAndStatusOfProcess(V.a.Active,k.Active,"ReactivateProcess"))}));return n.then((function(){Object(Fe.c)(Ne.j,t,e._applicationContext)}),(function(n){e._shouldReportErrorAsSuccess(n)?Object(Fe.c)(Ne.j,t,e._applicationContext):Object(Fe.b)(Ne.j,n,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),n},e.prototype.completeProcess=function(){var e=this,t=this.getTelemetryParams(),n=new Promise((function(t,n){return Object(Oe.a)(e._currentBpfInstance)?n(new h.a("Process Control does not exist on form.",2147877746)):e.isBusinessProcessCompleted()?t():m.a.tryParseOrNull(e._stageMetadata.getNextStageId(e.getActiveStageId()))?n(new h.a("Attempt to finish a process not on last stage.",2148081666)):void t(e._saveMainFormIfImmersiveBpfAndNewRecord().then((function(){return e._updateStateAndStatusOfProcess(V.a.Finished,k.Inactive,"CompleteProcess")})))}));return n.then((function(){Object(Fe.c)(Ne.c,t,e._applicationContext)}),(function(n){e._shouldReportErrorAsSuccess(n)?Object(Fe.c)(Ne.c,t,e._applicationContext):Object(Fe.b)(Ne.c,n,null,t,e._applicationContext,e.getCurrentFormEntity(),e._getState())})),n},e.prototype._shouldReportErrorAsSuccess=function(e){return e instanceof Z||(e instanceof Q||(e instanceof Y||(e instanceof K||(e instanceof q||(e instanceof U||e instanceof J)))))},e.prototype.triggerActionStepClick=function(e){var t=this;if(Object(Oe.b)(e)){var n=new Error("BPF Action Step Failure: null ControlId");throw Object(Fe.b)(Ne.b,n,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),n}var r=this._actionStepManager.GetActionMetadata(e);if(Object(Oe.a)(r)){n=new Error("BPF Action Step Failure: null metadata");throw Object(Fe.b)(Ne.b,n,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),n}var a=this._getState();if(Object(Oe.a)(a)){n=new Error("BPF Action Step Failure: null state");throw Object(Fe.b)(Ne.b,n,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),n}var i=this._getTelemetryParamsForActionStep(r.actionType,e,r.actionId);try{var o=new m.a(r.actionId);if(r.actionType===G.AsyncWorkflow||r.actionType===G.SyncWorkflow){var s=[this._processId.guid,m.a.toString(this.getProcessInstanceId()),o.guid].map((function(e){var t=new je;return t.Type="System.String",t.Value=e,t})),c=new Pe;c.Keys=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],c.Values=s,c.Count=3,c.IsReadOnly=!0;var l=new xe;l.Arguments=c;var u=new Ie;u.EntityId=this._currentFormEntity.id,u.InputArguments=l,u.entity={id:r.workflowId,entityType:"workflow"},this.UpdateActionLog(o,1),this._dispatch(Object(x.b)(u)).then((function(){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2)),Object(Fe.c)(Ne.b,i,t._applicationContext)}),(function(n){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Fe.b)(Ne.b,n,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(n,!0)).then()}))}else if(r.actionType===G.ProcessAction){var p=function(n){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3)),Object(Fe.b)(Ne.b,n,null,i,t._applicationContext,t.getCurrentFormEntity(),t._getState()),t._dispatch(Object(d.b)(n,!0)).then()},g=function(n){Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,2,t._actionStepManager.GenerateMessageForAction(2));var a=n.get_outputParameters();r.outputBindings.forEach((function(e){if(e.parameterName in a){var n=a[e.parameterName],r=e.boundAttributeName,i={};i[r]={key:r,value:n},t._dispatch(Object(Te.a)(t._currentPageId,i,!1,!0,t._currentFormEntity.etn,t._currentFormEntity.id.guid,null,t.getContextToken()))}})),Object(Fe.c)(Ne.b,i,t._applicationContext)},h={};r.inputBindings.forEach((function(e){var n=Object(D.c)(Object(de.j)(t._getState(),t.getCurrentFormEntity(),e.boundAttributeName));h["ProcessUnification_Arguments_"+e.parameterName]=n})),this._addInputParametersToParamList(r.inputParameters,h),this.UpdateActionLog(o,1),Xrm.Navigation.openDialog(r.workflowId,this._getDialogOptions(),h).then((function(n){if(n=n?n.parameters:{},t._filterInputArguments(n)){var a={id:m.a.toString(t.getCurrentFormEntity().id),entityType:t.getCurrentFormEntity().etn};n.Target=a,n.BusinessProcessFlowId=t._processId.guid,n.BusinessProcessFlowInstanceId=m.a.toString(t.getProcessInstanceId()),n.ActionStepId=r.actionId,t._actionStepManager.InvokeProcessAction(r.uniqueName,r,n).then(g,p)}else Object(Ee.a)(t._currentPageId,t.getContextToken(),e),t.UpdateActionLog(o,3,t._actionStepManager.GenerateMessageForAction(3))}),p)}}catch(e){throw 0===i.length&&(i=this.getTelemetryParams()),Object(Fe.b)(Ne.b,e,null,i,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}},e.prototype.triggerFlowStepClick=function(e,t){t=t;var n=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{var r=m.a.newGuid(),a={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:r};this._flowStepManager.openFlowWidget(a,n),this.UpdateActionLog(new m.a(e),1,void 0,r);var i=this.getActionLog(new m.a(e));this.createWorkflowLogRecord(i),Object(Fe.c)(Ne.d,n,this._applicationContext)}catch(e){Object(Fe.b)(Ne.d,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}},e.prototype.refreshFlowStepClick=function(e){var t=this,n=Le.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),r=this._dispatch(Object(He.a)(this._processId,this._currentBpfInstance));Promise.resolve(r).then((function(){t._updateProcessInstanceModifiedTime(),Object(Fe.c)(Ne.k,n,t._applicationContext)})).catch((function(e){Object(Fe.b)(Ne.k,e,null,n,t._applicationContext,t.getCurrentFormEntity(),t._getState())}))},e.prototype._addInputParametersToParamList=function(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var a=r[n];"ProcessUnification_Arguments_"+e[a].parameterName in t||(t["ProcessUnification_Arguments_"+e[a].parameterName]=null)}},e.prototype._filterInputArguments=function(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){for(var t in e){var n=e[t];if(t.startsWith("ProcessUnification_Arguments_"))e[t.substring("ProcessUnification_Arguments_".length,t.length)]=n;delete e[t]}return!0}return!1},e.prototype._getDialogOptions=function(){return{height:450,width:450,position:1}},e.prototype._createSnapshotRequest=function(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");var n=new $.a("processstage",e),r=this._calculateNewTraversedPath(e),a={activestageid:{reference:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:r,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(a,t)},e.prototype._addFieldsToBPFSnapshotForCreate=function(e,t){if(!e||!this._hasBpfInstance())return e;var n=Object(Ye.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return n&&(e[n.ReferencingAttribute]={reference:new $.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new $.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e},e.prototype.generateBPFInstanceSnapshotId=function(){if(this.isImmersiveBPF()||!Object(Be.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;var e=[],t=null;try{var n=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),r=Object(he.b)(this._getState(),n),a=r.identifier&&r.identifier.id||this._currentFormEntity.id,i=Object(s.g)(this._getState(),this._currentPageId);if(Object(Ye.e)(i))return Object(Ye.f)(this._getState(),n,a,this._dispatch),null;if(!this._hasBpfInstance()||m.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(Ye.d)(this._getState(),r.identifier,this._currentPageId))return Object(Ye.f)(this._getState(),n,a,this._dispatch),null;m.a.isNullOrEmpty(a)&&(a=m.a.newGuid(),Object(Ye.f)(this._getState(),n,a,this._dispatch)),t=this._createActiveStageSnapshot(m.a.tryParse(this.getActiveStageId()),a);var o=Object(he.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:o&&o.activeChanges&&Object.keys(o.activeChanges).map((function(e){return"Property: "+e})).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t},e.prototype._calculateNewTraversedPath=function(e){for(var t="",n=0,r=this.getActivePath();n<r.length;n++){var a=r[n];if(t+=","+a.guid,m.a.equals(a,e))return t.substring(1)}return(t+=","+e.guid).substring(1)},e.prototype._createActiveStageSnapshot=function(e,t){var n=this._createSnapshotRequest(e,t),r=ot.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),a=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(Oe.a)(a)){var i=Object(se.b)(this._getState(),a.snapshotId,n);return this._dispatch(i),a=Object(he.c)(this._getState(),this.getCurrentFormEntity()),r(),a.snapshotId}var o=Object(ge.h)(this._currentFormEntity.etn),s=Object(ge.x)(o),c=Object(oe.b)(this._getState(),this._currentBpfInstance,n,s,this._hasBpfInstance()?pe.a.Create:pe.a.Update),l=c.payload.snapshotId;return this._dispatch(c),r(),l},e.prototype._hasBpfInstance=function(){return!this._currentBpfInstance||m.a.isNullOrEmpty(this._currentBpfInstance.id)},e.prototype._updateStateAndStatusOfProcess=function(e,t,n){var r=this;return new Promise((function(a,i){var o=r._createStatusAndStateUpdateRequest(e,t),s=Object(he.c)(r._getState(),r.getCurrentFormEntity()),c=null;if(r.isImmersiveBPF()&&!Object(Oe.a)(s)){var l=Object(se.b)(r._getState(),s.snapshotId,o);r._dispatch(l),s=Object(he.c)(r._getState(),r.getCurrentFormEntity())}else{var u=Object(ge.h)(r.getCurrentFormEntity().etn),p=Object(ge.x)(u),g=Object(oe.b)(r._getState(),r._currentBpfInstance,o,p);c=g.payload.snapshotId,r._dispatch(g)}if(!r.executePreEvent("runOnPreProcessStatusChange",n,null,e))if(r._shouldPerformFormSave()){var m=r._validateSnapshot(s).then((function(){return r._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)})).then((function(){return r._saveFormEntityAndBPFEntitySnapshots(c,s,!1)})).then((function(){r._executePostEvent("runOnProcessStatusChange",n,null,e)})).catch((function(e){var t=Object(h.c)(e);return r._handleDuplicateDetection(t,c)})).catch((function(e){throw r._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e})).catch((function(e){r._dispatch(Object(d.b)(e,!0)).then((function(){return i(e)}))}));a(m)}else r._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then((function(){var t=null;t=r.isImmersiveBPF()&&!Object(Oe.a)(s)?s.snapshotId:c;r._dispatch(Object(le.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then((function(){r._dispatch(Object(ue.a)(r._currentPageId,r.getCurrentFormEntity(),r._getColumnsToRefresh())).then((function(){r._updateProcessInstanceModifiedTime(),r._executePostEvent("runOnProcessStatusChange",n,null,e)})),a()})).catch((function(e){r._dispatch(Object(d.b)(e,!0)).then((function(){return i(e)}))}))}));a()}))},e.prototype._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures=function(e){var t=this;return new Promise((function(n,r){if("CompleteProcess"===e||"MoveToNextStage"===e){var a=t.ValidateRequiredFieldsForNavigation();if(a&&!a.isValid)if("MoveToNextStage"===e)r(new Q("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return r(new Q("Unable to complete process as required fields have not been set"));r(new Error("validation failed for unexpected BPF operation: "+e))}}return n()}))},e.prototype._saveFormChangesBeforeNavigation=function(){var e=this;if(this._shouldPerformFormSave()){var t=Object(he.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(t).then((function(){return e._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")})).then((function(){var n=e._getColumnsToRefresh();return e._dispatch(Object(le.c)(t.snapshotId,!0,n))})).catch((function(n){return e._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(n,t.snapshotId),e._dispatch(Object(d.b)(n,!0))}))}return Promise.resolve()},e.prototype._shouldPerformFormSave=function(){var e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),n=this._getState();if(Object(y.kb)(n,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;var r=this._dispatch(Object(De.b)(this._currentPageId,this.getContextToken()));if(r&&r.data&&r.data.getIsDirty){var a=r.data.getIsDirty(),i={name:"shouldPerformMainFormSave",value:a};return t.push(i),e.info("Checking if main form save should be performed due to dirty form",t),a}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1},e.prototype._saveMainFormIfImmersiveBpfAndNewRecord=function(){var e=this,t=Object(s.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&t===qe.a&&m.a.isNullOrEmpty(this.getCurrentFormEntity().id)){return this._dispatch(Object(u.f)(this._currentPageId,t,!1,1,!1,!1)).then((function(t){e._currentFormEntity=t}))}return Promise.resolve(void 0)},e.prototype._validateSnapshot=function(e){var t=this;return new Promise((function(n,r){var a=t._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),i=t._getSnapshotStateTelemetryParams(e),o=t._currentPageId,s=t.getContextToken(),c=t._dispatch(t._getEventManager().runOnSave(s,1));for(var l in c&&(t._dispatch(Object(p.b)(o,s,2)),t._dispatch(Object(g.b)(o,s,!1)),a.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",i),r(new h.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737))),e.activeChanges){var u=e.activeChanges[l],d=t._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,l),m=Object(Oe.a)(d)?null:d.get_logicalName(),f=Object(Oe.a)(d)?ze.a.get_empty():d.get_id();if(Object(Oe.a)(u))return a.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+m+" with ID: "+f,i),r(new Error("Internal Client Error - null fieldValue"));var b=u.validationResult;if(Object(Oe.a)(b)){if(m===Me.c){a.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+m+" with ID: "+f,i);continue}return a.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+m+" with ID: "+f,i),r(new Error("Internal Client Error - null validatorResult"))}var v=b.isValueValid;if(Object(Oe.a)(v))return a.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+m+" with ID: "+f,i),r(new Error("Internal Client Error - null validationResult.isValidValue"));if(!v){var y={name:Ne.q,value:"clientSideCurrentForm"};return i.push(y),a.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+m+" with ID: "+f,i),r(new H("Unable to save form data due to validation errors"))}}return n(!0)}))},e.prototype._createStatusAndStateUpdateRequest=function(e,t){var n;return(n={}).statuscode={label:V.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},n.statecode={label:k[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},n},e.prototype.ValidateRequiredFieldsForNavigation=function(){for(var e=it.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),t=this._getState(),n=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),r=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a={emptySteps:[],errorSteps:[]},i=Object(he.c)(this._getState(),this.getCurrentFormEntity()),o=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),l=0,d=n;l<d.length;l++){var p=d[l];c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+p,o);var g=Object(de.j)(this._getState(),this.getCurrentFormEntity(),p);i&&i.activeChanges&&p in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+p,o),g=i.activeChanges[p]),Object(I.h)(g,this._getState(),this.getCurrentFormEntity().etn,p)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+p,o),a.emptySteps.push(p)):g.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+p,o),a.errorSteps.push(p))}for(var h=0,f=r;h<f.length;h++){var b=f[h],v=m.a.tryParse(b);if(m.a.isNullOrEmpty(v))c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+b,o);else{var _=this.getActionLog(v);if(_){var C=_.status;2!==C&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". The Flow Step Action Log has stauts of : "+C,o),a.errorSteps.push(b))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+b+". No action logs were found for this Flow Step",o),a.errorSteps.push(b)}}a.isValid=0===a.emptySteps.length&&0===a.errorSteps.length;var S=Object(Qe.a)(t,this._currentPageId);if(!Object(y.Gb)(S,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,o);var O=Object(s.l)(this._getState(),this._currentPageId);this._dispatch(Object(u.f)(this._currentPageId,O,!1,1,!1,!1)),a.isValid=!1}if(!a.isValid){var j=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(j,o)}return e(),a},e.prototype.setSelectedStage=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise((function(r,a){var i=m.a.tryParseOrNull(e);if(!i)return a("setSelectedStage can only be called with a valid stage id");var o={selectedStageId:i};n._updateBusinessProcessFlowData(n._currentBpfInstance,o),n._isUserSelectedStage=t,t&&n._executePostEvent("runOnStageSelected","setSelectedStage"),r()}))},e.prototype.setDisplayState=function(e){if(this._currentBpfInstance&&(e===c.a.collapsed||e===c.a.expanded||e===c.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);var t=new _e(m.a.toString(this._processId),m.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}},e.prototype.setActivePath=function(e){if(e&&0!==e.length){for(var t=[],n=0;n<e.length;n++)t[n]=new m.a(e[n]);var r={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,r)}},e.prototype.setBpfNavigationBehavior=function(e){var t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)},e.prototype.getBpfNavigationBehavior=function(){return this._currentBpfInstance&&Object(I.e)(this._getState(),this.getProcessInstanceId())},e.prototype.shouldReInitializeNavigationBehavior=function(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(Oe.a)(Object(I.b)(this._getState(),this.getProcessInstanceId()))||Object(I.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))},e.prototype.getBpfNavigationBehaviorAllowCreateNew=function(e){var t=this._currentBpfInstance&&Object(I.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)},e.prototype.createWorkflowLogRecord=function(e){var t;if(Object(Oe.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");var n=this._getState();if(Object(Oe.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");var r=n.metadata;if(Object(Oe.a)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");var a=r.entities;if(Object(Oe.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");var i=this._currentBpfInstance.etn;if(Object(Oe.b)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");var o=a[i];if(Object(Oe.a)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");var s=o.EntitySetName;if(Object(Oe.b)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");var c=Object(ke.z)(n,"workflowlog",o.EntityLogicalName,"asyncoperationid");if(Object(Oe.a)(c))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(Oe.b)(c.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");var l=c.ReferencingEntityNavigationPropertyName+"@odata.bind",u="/"+s+"("+e.processInstanceid.guid+")",d=((t={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid})[l]=u,t.activityname=e.processDefinitionid.guid,t.status=e.status,t);Xrm.WebApi.createRecord("workflowlog",d)},e.prototype._getTracer=function(){return Object(Oe.a)(this._applicationContext)||Object(Oe.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")},e.prototype._getDefaultActivePath=function(){var e=this._getTracer();if(Object(Oe.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;var t=this._stageMetadata.getDefaultPathManager();if(Object(Oe.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;var n=t.getDefaultPath();if(Object(Oe.a)(n))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;var r=[];for(var a in n){var i=m.a.parse(n[a]);r.push(i)}return r},e.prototype._updateBusinessProcessFlowData=function(e,t){e&&(this._dispatch(Object(ne.a)(t,e)),this._updateProcessInstanceModifiedTime())},e.prototype._updateDisplayState=function(e,t){this._dispatch(Object(re.a)(t,e)),this._updateProcessInstanceModifiedTime()},e.prototype.getForwardNavigationEntities=function(e,t,n,r){var a=this;return this._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(C(e,t,n,r||null))}))},e.prototype.navigateToNextEntity=function(e,t,n,r){var a=this;return new Promise((function(i,o){var s=a.ValidateRequiredFieldsForNavigation();if(s&&!s.isValid)return o(new Q("Unable to navigate to next stage as required fields have not been set"));var c=a._stageMetadata.getNextStageId(a.getActiveStageId());if(!c)return o(new Y("Last stage in the active path reached. Next stage does not exist."));var l=new m.a(c),u=a.getTraversedPath()+","+c;return a._saveFormChangesBeforeNavigation().then((function(){return a._dispatch(T(e,t,l,u,n,r))})).then((function(){return a.setSelectedStage(c)})).then((function(){a._executePostEvent("runOnStageChange","navigateToNextEntity",0),i()})).catch((function(e){a._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.navigateToNextEntityForCrossEntityBpf=function(e,t,n,r){var a=this;return new Promise((function(i,o){a._dispatch(T(e,t,new m.a(a.getActiveStageId()),a.getTraversedPath(),n,r)).then((function(){a._dispatch(Object(ie.b)(t,a._currentBpfInstance)),a._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),i()})).catch((function(e){a._dispatch(Object(d.b)(e,!0)).then((function(){return o(e)}))}))}))},e.prototype.getActiveStageActiveFor=function(){if(this._currentBpfInstance){var e=Object(O.b)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceActiveFor=function(){if(this._currentBpfInstance){var e=Object(O.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null},e.prototype.getBpfInstanceCompletedIn=function(){if(this._currentBpfInstance){var e=Object(O.d)(this._getState(),this._currentBpfInstance),t=Object(O.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null},e.prototype.getActionLogCollection=function(){return this._currentBpfInstance?Object(I.a)(this._getState(),this.getProcessInstanceId()):null},e.prototype.getActionLog=function(e){var t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null},e.prototype.UpdateActionLog=function(e,t,n,r){if(!this._currentBpfInstance)return null;var i=Object(I.a)(this._getState(),this.getProcessInstanceId()),o=i&&i[e.guid]?i[e.guid]:null,s=(m.a.EMPTY,{actionLogId:Object(Oe.a)(r)||r===m.a.EMPTY?o?o.actionLogId:m.a.newGuid():r,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:n}),c=Object(a.__assign)({},i);c[e.guid]=s;var l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"},e.prototype.getEnabledProcesses=function(){var e=this,t=[];return new Promise((function(n,r){var a;e._currentFormEntity&&e._currentFormEntity.etn?e._dispatch((a=e._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute:function(e,t){e.dispatch;var n=e.getState,r=t.DataSource.get_WebAPIService(),i=n(),o=m.a.tryParse(Object(N.i)(i)),s=new F(a,o),c=Object(w.a)(n(),s);return r.sendRequest(c).then((function(e){return e.json()}),h.b)}})).then((function(e){for(var r=0,a=e.value;r<a.length;r++){var i=a[r];t.push(new M(i.name,i.uniquename,i.workflowid))}n(t)}),(function(e){r(e)})):r(new h.a("Current Form Entity cannot be NULL",2147877745))}))},e.prototype.getNavigationEntities=function(){return this._activeStageManager.navigationEntities},e.prototype._getNavigationEntityIdsByEntityLogicalName=function(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName},e.prototype._updateGlobalActiveStage=function(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)},e.prototype._createGlobalNavigationData=function(e){var t=new R,n=Object(D.b)(e.activestageid);t.activeStageId=m.a.toString(n);var r=Object(D.c)(e.traversedpath);Object(Oe.b)(r)&&(r=L.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=r,t.navigationEntities=[];for(var a=0,i=this._getNavigationEntityTypesFromWorkflowObjectModel();a<i.length;a++){var o=i[a],s=new B;for(var c in s.entityLogicalName=o,s.id=m.a.EMPTY.guid,e)if(Object(D.k)(e[c])){var l=e[c],u=[];if(Object(Oe.a)(l.reference)||Object(Oe.a)(l.reference.etn))u.push({name:"entityReference.reference",value:"NULL"}),this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",u);l&&l.reference&&l.reference.etn===o&&(s.id=l.reference.id.guid)}t.navigationEntities.push(s)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(D.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(D.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(D.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(D.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(D.c)(e.bpfDefinitionVersioNumber)),t},e.prototype._getNavigationEntityTypesFromWorkflowObjectModel=function(){var e={};if(!Object(Oe.a)(this.getProcess()))for(var t=0;t<this.getProcess().get_Steps().get_Count();t++){var n=this.getProcess().get_Steps().get_item(t);if(n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){var r=n.get_Description();e[r]||(e[r]=r)}}return Object.keys(e)},e.prototype.reflow=function(e,t,n){var r=this._stageMetadata.getDefaultPathManager();if(t||n){if(t){t=new m.a(t).guid;var a=this.getTraversedPath(),i=this.getActiveStageId();a&&i&&(i===t||a.indexOf(t)<0)&&(r.updateDefaultPath(t,n),this._updateProcessInstanceModifiedTime())}}else this._reflowInternal()},e.prototype._reflowInternal=function(e,t){var n=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(n.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())},e.prototype.callPblToEvaluateBranching=function(e){var t=this,n=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");var r=Object(ee.a)(n,this._currentPageId);this.getScriptContainerPromise().then((function(n){r<te.a.EditReady&&n.getEventManager().addOnLoadEvent(t.getContextToken(),(function(){n.execute(e,[])})),r>=te.a.OnLoadReady&&n.execute(e,[])}))},e.prototype.update=function(e){!Object(Oe.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()},e.prototype.waitForOngoingWork=function(){return Je.a.getInstance().checkForOutstandingWork(this._getState())},e.prototype._getEventManager=function(){var e=this.getScriptContainer();return e?e.getEventManager():null},e.prototype.getScriptContainer=function(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;var e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e},e.prototype.getScriptContainerPromise=function(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")},e.prototype._executePostEvent=function(e,t,n,r){if(void 0===n&&(n=null),void 0===r&&(r=null),Object(Ue.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),V.a[r],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,n));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}},e.prototype.executePreEvent=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var a=!1;if(!Object(Ue.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":a=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),V.a[r],this));break;case"runOnPreStageChange":a=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,n))}return this._logTraceInfoForProcessPreEvent(a,e,t,t),a}return this._logTraceFailureForProcessEvent(t,e,e),a},e.prototype._saveFormDataAndActiveStage=function(e,t,n){var r=this,a=st.startStopwatch({processId:m.a.toString(this.getProcessId()),processInstanceId:m.a.toString(this.getProcessInstanceId())}),i=this.executePreEvent("runOnPreStageChange",n,t),o=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(!i){var s=new Promise((function(t,a){if(!e)return a(new q("Attemping to save invalid stage id"));for(var i,s,c=["traversedpath","activestageid","activestagestartedon","completedon"],l=r.getNavigationEntities(),u=Object(f.b)(r._getState(),r._currentBpfInstance),d=0,p=l;d<p.length;d++){var g=p[d];for(var m in u)if(m.includes(g.entityLogicalName)){c.push(m);break}}if(r._shouldPerformFormSave()){var b=r._getState();i=r._validateSnapshot(o).then((function(){return r._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)})).then((function(){return s=r._createActiveStageSnapshot(e),r._saveFormEntityAndBPFEntitySnapshots(s,o,!1)})).then((function(){var e=r.getCurrentFormEntity();r._dispatch(Object(nt.a)(r._currentPageId,b,r.getContextToken(),e.etn,e.id))})).catch((function(e){var t=Object(h.c)(e);return r._handleDuplicateDetection(t,s)}))}else i=r._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then((function(){return s=r._createActiveStageSnapshot(e),r._dispatch(Object(le.c)(s,!0,c,r._getRetrieveProcessControlDataRequest())).then((function(){r._dispatch(Object(ue.a)(r._currentPageId,r.getCurrentFormEntity(),r._getColumnsToRefresh(),r._getRetrieveProcessControlDataRequest())),r._dispatch(Object(S.b)(!0,r._currentFormEntity))}))}));t(i)})).then((function(){var e=r.getTraversedPath(),a=r.getActiveStageId();r._updateGlobalActiveStage(e,a),r.setSelectedStage(a),r._executePostEvent("runOnStageChange",n,t)}),(function(e){throw r._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}));return s.then(c,c),s}function c(){a()}},e.prototype._handleDuplicateDetection=function(e,t){var n=this;if(Object(tt.e)(e))return this._dispatch(Object($e.a)(this._currentPageId,e,this._currentFormEntity)).then((function(e){return 0===e.status?n._dispatch(Object(et.a)(e.pageId)).then((function(e){return e.value.param_lastButtonClicked===u.a?Promise.resolve("success"):Promise.resolve("aborted")})):Promise.resolve("noop")})).then((function(e){if("success"===e){var r=Object(he.c)(n._getState(),n.getCurrentFormEntity());return n._saveFormEntityAndBPFEntitySnapshots(t,r,!0)}}));throw e},e.prototype._saveFormEntityAndBPFEntitySnapshots=function(e,t,n){var r={};r[t.identifier.etn]=this._getColumnsToRefresh();var a=null;return a=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(le.d)(a,n,r,this._getRetrieveProcessControlDataRequest()))},e.prototype._logTraceInfoForProcessPreEvent=function(e,t,n,r){var a=this._applicationContext.TraceManager.getTracer(r),i=this.getTelemetryParams(),o={name:"BpfOperationName",value:n};i.push(o);var s={name:"eventName",value:t};i.push(s);var c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),a.info("BPF ProcessManager executed scripts registered to event "+t,i)},e.prototype._logTraceFailureForProcessEvent=function(e,t,n){var r=this._applicationContext.TraceManager.getTracer(n),a=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};a.push(i);a.push({name:"preventDefaultInvokedByWebResource",value:null});var o={name:"eventName",value:t};a.push(o);var s={name:"isPageDead",value:Object(Ue.n)(this._getState(),this._currentPageId)};a.push(s);var c={name:"currentPageId",value:this._currentPageId};a.push(c),r.error("BPF ProcessManager not able to to execute scripts registered on event "+t+" does not exist",a)},e.prototype._logTraceFailureForScriptContainer=function(){var e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});var n={name:"IsPageDead",value:Object(Ue.n)(this._getState(),this._currentPageId)};t.push(n);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)},e.prototype._getStage=function(e){var t=this,n=null;if(e){var r=this.getEntityStages();r&&r.some((function(r){for(var a=0;a<r.get_Steps().get_Count();a++){var i=r.get_Steps().get_item(a);if(t._equalsIgnoreCase(e,i.get_Id()))return n=i,!0}}))}return n},e.prototype.getContextToken=function(){return Object(ge.j)(this._getState(),this._currentPageId)},e.prototype._updateProcessInstanceModifiedTime=function(){this._dispatch(Object(ae.b)(this.getCurrentFormEntity()))},e.prototype._isSelectedStageControl=function(e){if(!Object(Oe.a)(this.getSelectedStage()))for(var t=this.getSelectedStage().get_Steps(),n=0;n<t.get_Count();n++)if(this._equalsIgnoreCase(t.get_item(n).get_Id(),e))return!0;return!1},e.prototype._equalsIgnoreCase=function(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()},e.prototype._getSnapshotStateTelemetryParams=function(e){var t=[];if(Object(Oe.a)(e))return t;var n={name:"mode",value:e.mode},r={name:"identifierId",value:Object(Oe.a)(e.identifier)||Object(Oe.a)(e.identifier.id)?null:m.a.toString(e.identifier.id)},a=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(Oe.a)(a)?null:m.a.fromLegacyGuid(a.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(Oe.a)(a)?null:a.get_objectTypeCode()},s={name:"activeChanges",value:Object(Oe.a)(a)?null:this._getIFieldValuesString(e.activeChanges,a.get_logicalName())},c={name:"lockedChanges",value:Object(Oe.a)(a)?null:this._getIFieldValuesString(e.lockedChanges,a.get_logicalName())};return t.push(n),t.push(i),t.push(o),t.push(r),t.push(s),t.push(c),t},e.prototype._getTelemetryParamsForActionStep=function(e,t,n){var r=this.getTelemetryParams(),a={name:"ActionStepType",value:e},i={name:"ControlId",value:t},o={name:"ActionStepId",value:n};return r.push(a),r.push(i),r.push(o),r},e.prototype.getTelemetryParams=function(){var e=[];try{var t={name:"ProcessId",value:m.a.toString(this.getProcessId())},n={name:"ProcessInstanceId",value:m.a.toString(this.getProcessInstanceId())},r={name:"ActiveStageId",value:this.getActiveStageId()},a={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},o={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?m.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},p={name:"PageType",value:Object(s.l)(this._getState(),this._currentPageId)},g={name:"SavedPageId",value:this._savedPageId},h={name:"SavedPageType",value:Object(s.l)(this._getState(),this._savedPageId)};if(Object(Be.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var f={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},b={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(f),e.push(b)}var v={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(n),e.push(r),e.push(i),e.push(o),e.push(a),e.push(c),e.push(l),e.push(u),e.push(d),e.push(p),e.push(g),e.push(h),e.push(v)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e},e.prototype._getIFieldValuesString=function(e,t){var n="";if(!Object(Oe.a)(e))for(var r in e)if(Object(Oe.a)(r))n+=String.format("[fieldName: {0}]",null);else{var a=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,r),i=e[r];if(Object(Oe.a)(i)||Object(Oe.a)(a))n+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(Oe.a)(i),Object(Oe.a)(a));else{var o="";Object(Oe.a)(i.timestamp)||(o=i.timestamp.toUTCString());var s="",c="",l=null,u=null;Object(Oe.a)(i.validationResult)||(s=i.validationResult.errorId,c=i.validationResult.errorMessage,l=i.validationResult.isOfflineSyncError,u=i.validationResult.isValueValid);var d=a.get_id();n+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",d,o,s,c,l,u)}}return n},e.prototype._getActivePathString=function(){var e=this.getActivePath(),t="";if(e&&e.length>0){for(var n=0;n<e.length-1;n++)t=t+e[n].guid+",";t+=e[e.length-1].guid}return t},e.prototype.isImmersiveBPF=function(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn},e.prototype._getColumnsToRefresh=function(){var e=Object(Ke.b)(this._getState(),this._currentPageId),t=Object(s.g)(this._getState(),this._currentPageId);if(Object(Oe.a)(t)){var n=Object(he.c)(this._getState(),this.getCurrentFormEntity()),r=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),a=this._getSnapshotStateTelemetryParams(n);return r.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",a),[]}var i=Object(ke.E)(this._getState(),t.entityTypeName),o=Object(u.g)(this._getState(),e,t,i,null);return o&&o.hasOwnProperty(t.entityTypeName)?o[t.entityTypeName]:[]},e.prototype._getRetrieveProcessControlDataRequest=function(){var e=this.getProcessId()&&!m.a.equals(this.getProcessId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!m.a.equals(this.getProcessInstanceId(),m.a.EMPTY)?$.a.toLegacyEntityReference(new $.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new Xe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new Xe.a($.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null},e.prototype.getCustomControlIndicator=function(){return this._customControlsPresent},e.prototype.setCustomControlIndicator=function(e){this._customControlsPresent=e},e.prototype.getFormXmlRenderingIndicator=function(){return this._renderedFromFormXml},e.prototype.setFormXmlRenderingIndicator=function(e){this._renderedFromFormXml=e},e.prototype.getInstanceModifiedTimestamp=function(){return this._instanceModifiedTimestamp},e.prototype.isBpfFormDescriptorValid=function(e,t,n,r){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Ze.f)(e,t,n,r)),this._isBpfFormValid},e.prototype._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure=function(e,t){var n=t;if(Object(Oe.a)(t)){var r=Object(h.c)(e);n=!Object(Oe.a)(r)&&r.FaultedSnapshotId}!Object(Oe.b)(n)&&this._dispatch(Object(ce.b)(n,!1));var a=Object(he.c)(this._getState(),this.getCurrentFormEntity());a&&!Object(Oe.a)(a.snapshotId)&&a.snapshotId!==n&&this._dispatch(Object(ce.b)(a.snapshotId,!1))},e}()},"5ZRb":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="Web.CommandBar.ErrorLoading_Message",a="Web.CommandBar.MoreCommands_ToolTip",i="Web.CommandBar.MoreCommandsForEntity_ToolTip",o="Command_Bar_Label",s=["Web.CommandBar.Loading_Message",r,a,i,o]},"5cS+":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var r=n("c/eZ"),a=n("9r0m"),i=n("gBKR"),o=n("r2h9"),s=n("/j9Z"),c=n("olrR"),l=n("uO/V"),u=n("/45f"),d=n("Gemh");function p(e,t,n){return{type:"datasethost.dependencies.retrieve.async",execute:function(p,h){var m=p.dispatch,f=p.getState,b=h.TraceManager.getTracer(l.z),v=l.x+".loadDataSetHostDependenciesAction";b.info("Retrieving view with ID "+a.a.toString(t)+" for "+e+" entity.");var y=Object(d.pb)(f(),e,t);return m(Object(c.a)(e,o.a.MAIN_APPLICATION_VIEW,y,t)).then((function(o){if(!o){var c="Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID "+a.a.toString(t)+" for "+e;return h.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.b))}var l=g(f(),t,n);return m(Object(i.e)(l)).then((function(){var n=[{name:"entityTypeName",value:e},{name:"viewId",value:a.a.toString(t)}];return h.EventManager.ReportComponentSuccess(v,n),Promise.resolve()})).catch((function(n){var i=[];for(var o in l)l[o].length&&(i=Object(r.__spreadArrays)(l[o],i));var c="Unable to retrieve DataSetHost dependencies for the grid for view with ID "+a.a.toString(t)+". Failed to retrieve entity with attributes "+i.join()+" for "+e;return h.EventManager.ReportComponentFailure(v,Error(c)),Promise.reject(new s.a(u.a))}))}))}}}function g(e,t,n){var r=Object(d.qb)(e,t,n),a={};if(r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells){var i=[];r.grid.rows[0].cells.forEach((function(e){if(!e.disableMetaDataBinding)if(e.relatedEntityName){if(e.name&&-1!==e.name.indexOf(".")){var t=e.name.split(".")[1];a[e.relatedEntityName]||(a[e.relatedEntityName]=[]),-1===a[e.relatedEntityName].indexOf(t)&&t&&a[e.relatedEntityName].push(t)}}else-1===i.indexOf(e.name)&&i.push(e.name)})),i.length>0&&(a[r.entityLogicalName]=i)}return a}},"766A":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="set.user.offline.status";function a(e){return{type:r,payload:{isUserSelectOffline:e}}}},"7bez":function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return A}));var r,a,i=n("1z64"),o=n("sOTk"),s=n("/zIU"),c=n("PZxu"),l=n("9r0m"),u=n("Wye+"),d=n("+Z9T"),p=n("Gemh"),g=n("IiPO"),h=n("HSdq"),m=n("/j9Z"),f=n("Sscr"),b=n("ezfI"),v=n("kvLG"),y=function(){function e(e,t,n,a,o){this._pageId=n,r=e,this._contextToken=t,this._controlName=a,this._gridType=o,this._clientApiExecutor=new i.a(e,"ClientApi.XrmViewSelector.",n,t,[{name:"controlName",value:a,isEventParam:!0},{name:"gridType",value:o,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}return e.prototype.setCurrentView=function(e){var t=this;this._clientApiExecutor.executeAsync("setCurrentView",(function(n,a){return e&&e.id?r.dispatch(Object(u.a)(t._pageId,t._contextToken,t._controlName,e.id)):(a.push({name:"validationError",value:"true"}),v.a.getInstance().traceManager.getTracer(n).error("View ID is required",a),Promise.resolve())}))},e.prototype.getCurrentView=function(){var e="ClientApi.XrmViewSelector.getCurrentView";try{b.a.instance.reportCall(e);var t=Object(p.hb)(r.getState(),this._pageId,this._contextToken,this._controlName),n=null,a=null;if(t)a=t.ViewId;else if(3===this._gridType){var i={id:this._pageId},o=Object(h.fb)(r.getState(),i,this._contextToken.parentContextToken);if(!(o&&o.Controls&&o.Controls[this._controlName]&&o.Controls[this._controlName].Parameters&&o.Controls[this._controlName].Parameters.ViewId)){var s=void 0;return o?o.Controls?o.Controls[this._controlName]?o.Controls[this._controlName].Parameters?o.Controls[this._controlName].Parameters.ViewId||(s="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):s="formDescriptor.Controls[this._controlName].Parameters is null or undefined":s="formDescriptor.Controls[this._controlName] is null or undefined":s="formDescriptor.Controls is null or undefined":s="formDescriptor is null or undefined",(v=g.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,new m.a(s),null,v),null}a=o.Controls[this._controlName].Parameters.ViewId}if(a){if(n=Object(p.qb)(r.getState(),l.a.parse(a),this._pageId)){var c={entityType:Object(p.ob)(r.getState(),a,this._pageId),id:l.a.externalGuid(n.viewId),name:n.title};return b.a.instance.reportSuccess(e),c}var u=[];return u.push({name:"controlName",value:this._controlName}),u.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),g.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,u),null}var d=[];return d.push({name:"controlName",value:this._controlName}),d.push({name:"contextKey",value:Object(f.v)(this._contextToken)}),g.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,d),null}catch(t){var v;throw(v=g.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,v),t}},e.prototype.isVisible=function(){var e="ClientApi.XrmViewSelector.isVisible";try{if(b.a.instance.reportCall(e),Object(d.a)(this._isVisible)){var t=Object(p.hb)(r.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{var n={id:this._pageId},a=Object(h.fb)(r.getState(),n,this._contextToken.parentContextToken);if(!(a&&a.Controls&&a.Controls[this._controlName]&&a.Controls[this._controlName].Parameters&&a.Controls[this._controlName].Parameters.EnableViewPicker))return(i=g.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,new m.a("FormDescriptor is null"),null,i),!1;this._isVisible=a.Controls[this._controlName].Parameters.EnableViewPicker}}return b.a.instance.reportSuccess(e),this._isVisible}catch(t){var i;throw(i=g.a.getInstance().getEventParameters(this._contextToken)).push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,i),t}},e}(),_=n("h82J"),C=n("fW82"),S=n("tcXs"),O=n("Cgjg"),I=n("lMVv"),j=n("r2h9"),P=n("gLMt"),x=n("qC0c"),E=n("cZkS"),T=n("Ka9P"),w=function(){function e(e,t,n,r,o,s,c,l){this._relationship=null;var u="ClientApi.XrmGridControl.constructor";e||Object(d.j)(u,"store"),t||Object(d.j)(u,"contextToken"),n||Object(d.j)(u,"pageId"),a=e,this._pageId=n,this._contextToken=t,this._controlName=l,this._isEditable=r,this._gridType=o,this._applicationContext=c,s||a.dispatch(Object(_.a)(this,n,t)),this._clientApiExecutor=new i.a(e,"ClientApi.XrmGridControl.",n,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:l,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:r,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:s,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:o,isEventParam:!0})}return Object.defineProperty(e.prototype,"_connectedControlProps",{get:function(){return{controlName:this._controlName,id:this._pageId}},enumerable:!1,configurable:!0}),e.prototype.setFilterXml=function(e){var t=this;this._clientApiExecutor.executeAsync("setFilterXml",(function(){var n=(new Date).getTime();return a.dispatch(Object(O.b)(e,1,t._pageId,t._contextToken,n))}))},e.prototype.getFilterXml=function(){var e="ClientApi.XrmGridControl.getFilterXml";try{b.a.instance.reportCall(e);var t=Object(p.u)(a.getState(),this._pageId,this._contextToken);return b.a.instance.reportSuccess(e),t}catch(t){var n=g.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getFetchXml=function(){var e="ClientApi.XrmGridControl.getFetchXml";try{b.a.instance.reportCall(e);var t=Object(p.A)(a.getState(),this._contextToken,{id:this._pageId});return b.a.instance.reportSuccess(e),t}catch(t){var n=g.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getGrid=function(){var e="ClientApi.XrmGridControl.getGrid";try{return b.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new c.a(a,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),b.a.instance.reportSuccess(e),this._grid}catch(n){var t=g.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,n,null,t),n}},e.prototype.getViewSelector=function(){var e="ClientApi.XrmGridControl.getViewSelector";try{return b.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(a,this._contextToken,this._pageId,this._controlName,this._gridType)),b.a.instance.reportSuccess(e),this._viewSelector}catch(n){var t=g.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,n,null,t),n}},e.prototype.getTeamTemplateId=function(){var e="ClientApi.XrmGridControl.getTeamTemplateId";try{b.a.instance.reportCall(e);var t=null,n=a.getState();if(Object(x.c)(n,E.c))if(this.getEntityName()&&3===this._gridType){var r=Object(h.fb)(n,this._connectedControlProps,this._contextToken.parentContextToken);r&&r.Controls&&r.Controls[this._controlName]&&r.Controls[this._controlName].Parameters&&r.Controls[this._controlName].Parameters.TeamTemplateId&&(t=r.Controls[this._controlName].Parameters.TeamTemplateId)}return b.a.instance.reportSuccess(e),t}catch(t){var i=g.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getEntityName=function(){var e=this;return this._clientApiExecutor.execute("getEntityName",(function(t,n){if(!e._entityName){if(e._entityName=Object(p.F)(a.getState(),e._pageId,e._contextToken,e._controlName),!e._entityName&&3===e._gridType){var r=Object(h.fb)(a.getState(),e._connectedControlProps,e._contextToken.parentContextToken);if(!(r&&r.Controls&&r.Controls[e._controlName]&&r.Controls[e._controlName].Parameters&&r.Controls[e._controlName].Parameters.TargetEntityType)){var i=void 0;return r?r.Controls?r.Controls[e._controlName]?r.Controls[e._controlName].Parameters?r.Controls[e._controlName].Parameters.TargetEntityType||(i="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):i="formDescriptor.Controls[this.name].Parameters is null or undefined":i="formDescriptor.Controls[this.name] is null or undefined":i="formDescriptor.Controls is null or undefined":i="formDescriptor is null or undefined",e._clientApiExecutor.reportFailure(t,new m.a(i),n),null}e._entityName=r.Controls[e._controlName].Parameters.TargetEntityType}if(!e._entityName)return e._clientApiExecutor.reportFailure(t,new m.a("Logical name of the entity type is coming as null or undefined."),n),null}return e._entityName}))},e.prototype.refresh=function(){var e=this;this._clientApiExecutor.executeAsync("refresh",(function(){return a.dispatch(Object(u.a)(e._pageId,e._contextToken,e._controlName))}))},e.prototype.refreshRibbon=function(){var e=this;this._clientApiExecutor.executeAsync("refreshRibbon",(function(){return a.dispatch(Object(S.a)(e._pageId,Object(p.w)(a.getState(),e._pageId,e._contextToken)))}))},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridControl.getUrl";try{b.a.instance.reportCall(t);var n,r=null,i=this._getCurrentView();r={entityTypeName:this.getEntityName()},i&&(r.viewType="savedquery"===i.entityType?j.b.savedview:j.b.userview,r.viewId=new l.a(i.id)),n=s.a.Grid;var o=null;if(1===e)o=a.dispatch(Object(C.a)(n,r));else{var c=Object(P.a)(a,this._pageId);o=a.dispatch(Object(C.c)(c,n,r))}return b.a.instance.reportSuccess(t),o}catch(e){var u=g.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(t,e,null,u),e}},e.prototype.getRecordSetQueryKey=function(){var e=this;return this._clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(p.cb)(a.getState(),e._contextToken,{id:e._pageId})}))},e.prototype.getGridType=function(){return b.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType},e.prototype.getRelationship=function(){var e=this;return this._clientApiExecutor.execute("getRelationship",(function(t,n){if(!e._relationship){var r=Object(p.v)(a.getState(),e._pageId,e._contextToken);if(r){var i=r.relationshipName;if(i&&(e._relationship=A(i,e.getEntityName()),r.relationshipRoleOrdinal)){var o=r.relationshipRoleOrdinal===T.a.Referencing?1:2;e._relationship.roleType=o}}else v.a.getInstance().traceManager.getTracer(t).error("Grid dataset was null",n)}return e._relationship}))},e.prototype.getParentForm=function(){var e="ClientApi.XrmGridControl.getParentForm";try{b.a.instance.reportCall(e);var t=this._contextToken&&this._contextToken.parentContextToken?a.dispatch(Object(_.b)(this._pageId,this._contextToken.parentContextToken)):null;return b.a.instance.reportSuccess(e),t}catch(t){var n=g.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),g.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getRollupType=function(){var e=this;return this._clientApiExecutor.execute("getRollupType",(function(){return Object(p.eb)(a.getState(),e._pageId,e._contextToken)}))},e.prototype._getCurrentView=function(){var e=null,t=this.getViewSelector().getCurrentView();if(t)return{entityType:e="savedquery"===t.entityType?"savedquery":"userquery",id:t.id};var n=Object(o.g)(a.getState(),this._pageId);if(n.viewType&&n.viewId){var r=n.viewId?l.a.externalGuid(n.viewId):void 0;if((e=n.viewType===j.b.savedview?"savedquery":"userquery")&&r)return{entityType:e,id:r}}return null},e}();function A(e,t){var n={};n.name=e;var r=Object(I.h)(a.getState(),t);if(r){var i=void 0;if(r.OneToManyRelationships&&r.OneToManyRelationships[e]?i=r.OneToManyRelationships[e]:r.ManyToOneRelationships&&r.ManyToOneRelationships[e]&&(i=r.ManyToOneRelationships[e]),i)n.attributeName=i.ReferencingAttribute,n.relationshipType=0,n.navigationPropertyName=i.ReferencingEntityNavigationPropertyName;else if(r.ManyToManyRelationships&&r.ManyToManyRelationships[e]){var o=r.ManyToManyRelationships[e];n.relationshipType=1,1===n.roleType?(n.attributeName=o.Entity1IntersectAttribute,n.navigationPropertyName=o.Entity1NavigationPropertyName):(n.attributeName=o.Entity2IntersectAttribute,n.navigationPropertyName=o.Entity2NavigationPropertyName)}}return n}},"7z0H":function(e,t,n){"use strict";n.d(t,"f",(function(){return _e})),n.d(t,"h",(function(){return re})),n.d(t,"i",(function(){return de})),n.d(t,"j",(function(){return pe})),n.d(t,"k",(function(){return ge})),n.d(t,"c",(function(){return oe})),n.d(t,"d",(function(){return se})),n.d(t,"a",(function(){return te})),n.d(t,"b",(function(){return ne})),n.d(t,"e",(function(){return ae})),n.d(t,"g",(function(){return ye}));var r=n("wQXd"),a=n("9r0m"),i=n("i8/j"),o=n("/j9Z"),s=n("HSdq"),c=n("2OIc"),l=n("sOTk"),u=n("QAhb"),d=n("F2uj"),p=n("7EJx"),g=n("ObKm"),h=n("CpQy"),m=n("gBKR"),f=n("jJRu"),b=n("cAHA"),v=n("lMVv"),y=n("TCcM"),_=n("GWjY"),C=n("DJ9D");var S=n("VWqI"),O=n("Cfob"),I=n("Qeyq"),j=n("r4Uk"),P=n("T2Xs"),x="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=n("aUuu"),T=n("Sscr"),w=n("mGpW"),A=n("RNNy"),F=n("WACO"),N=n("M6d0"),k=n("n+eO"),M=n("yHpA"),D=n("+l2M"),R=n("YHw6"),L=n("IfuP"),B=n("cL6R"),V=n("YEEA"),G=n("Ww2r"),W=n("EcZf"),z=n("BRt1"),X=n("U0B9"),q=n("jm5F"),U=n("TiXY"),H=n("wUng"),Y=n("cZkS"),K=n("qC0c"),Q=n("AfKB"),Z=n("455M"),J=n("ZEX9"),$=n("yZTI"),ee=n("uQP8"),te="form.initialize",ne="form.xrmready";function re(e,t,n,r,c){var h=[{name:"formId",value:a.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(T.v)(n)}];return{type:"form.initialize.async",execute:function(m,f,b){var y,_=m.dispatch,C=m.getState,O=C(),I=Object(l.g)(O,t),w=I.entityTypeName,A=I.data,M=I.recordSetQueryKey,L=f.TraceManager.getTracer("Forms.InitializeForm"),G=[];if(h.push({name:"isPreview",value:I&&I.isPreview}),h.push({name:"EntityName",value:I&&I.entityTypeName}),L.info("initializeForm started.",h),Object(J.b)(function(e){return function(){var t={},n={},r={};return function(a,i,o,s,c){P.a.info(x+o.controlId+": createGetTimelineWallData started");var l=!1;n.hasOwnProperty(a)&&n[a]||(n[a]=new j.a(e,a,o.id));var u=n[a],d=u.retrieveTimelineWallObject(i,o,s,c,e);r.hasOwnProperty(a)&&r[a]&&d===r[a]||(r[a]=d,l=!0);var p=u;return l&&(t[a]=p),P.a.info(x+o.controlId+": createGetTimelineWallData finished"),t[a]}}}(_),Z.a.TimelineWall),L.info("BusinessProcessWrapperManager.Instance.init started.",h),G.push(k.a.Instance.init(f,C,_).then((function(){return L.info("BusinessProcessWrapperManager.Instance.init completed.",h)}))),Object(S.a)(O,e))if(Object(l.m)(O,t)){if(!Object(S.g)(O,w,1,0)&&!(null==I?void 0:I.isPreview))return ie(22e8,_,L,b,O,t)}else if(!Object(S.g)(O,w,2,0))return ie(2147746342,_,L,b,O,t);var X=Object(i.j)(O,e),$=ye(O,X,e),ee=fe(O,w,X),te=function(e,t,n,r){var a={};if(t&&t.RelatedEntityAttributes&&r)for(var i in t.RelatedEntityAttributes){var o=Object(v.x)(e,r,i);if(o&&o.ReferencedEntity){var s={},c=be(e,o.ReferencedEntity,t.RelatedEntityAttributes[i]),l=Object(T.m)(n,i);a[Object(T.v)(l)]={attributes:c,submitModes:s}}}return a}(O,X,n,w),ne=Object(z.a)(O),re=Object(p.s)(O);for(var ae in Ce(O,_,e,$,ee,t,n,te,re),M&&!ne&&_(Object(W.g)(t,M)),L.info("Update quick view forms started.",h),X.InlineQuickForms){var oe=X.InlineQuickForms[ae];for(var se in oe){var de=oe[se],pe=Object(i.j)(O,de),ge=ye(O,pe,de),ve=fe(O,se,pe),_e=Object(T.l)(n,ae,se);Ce(O,_,e,ge,ve,t,_e,null,re)}}if(L.info("Update quick view forms completed.",h),A&&0!==Object.keys(A).length){var Se=I,Oe=Se.createFromEntity,Ie=Se.createFromRelationship,je=I.initWithEntity,Pe=Oe;!Pe&&je&&(Pe=je),y=function(e,t,n,r,i,c,p,h,m,f,b){n&&n.info("initializeFormWithDefaultValue started.",r);var y,_,C=Object(d.d)(e,c),S=null,O={},I=Object(l.m)(e,i),j=a.a.toString(h),P=[];j&&(S=Object(d.k)(e,j));for(var x=0,E=Object.keys(p);x<E.length;x++){var w=E[x];if("processid"!==w){var A=C[w];if(!A&&S&&(A=S[w]),A&&!A.AttributeOf){var F=A.Type;switch(F){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof p[w]){var k=ce(p,w,A);if(!k){ue(n,w);continue}if(O[w]=k,!a.a.equals(a.a.EMPTY,k.id)&&"owner"!==F&&I&&(f||b))if(_){var M=_.then((function(){return t(Object(q.b)(i,h)).then((function(){n&&n.info("updateSnapshotWithOptions completed (1).",r)}))}));P.push(M)}else _=me(e,t,k,c,i,n,r,f,b),P.push(_)}else{var D=void 0;(D=Array.isArray(p[w])?p[w][0]:p[w])&&D.id&&a.a.tryParseOrNull(D.id)&&D.entityType&&(O[w]=new u.a(D.entityType,new a.a(D.id),D.name))}break;case"partylist":var R=p[w],L=R,B=[];try{"string"==typeof R&&(L=JSON.parse(R));for(var G=0,W=L;G<W.length;G++){var z=W[G];B.push(new u.a(z.entityType,new a.a(z.id),z.name))}}catch(e){ue(n,w,"partylist")}O[w]=B;break;case"boolean":case"picklist":case"status":O[w]=p[w];break;case"uniqueidentifier":O[w]=new a.a(p[w]);break;default:O[w]=p[w]}}else if(-1!==w.indexOf(Q.d)||"_CreateFromId"===w){var X=null;if(-1!==w.indexOf(Q.d)&&(X=ce(p,Q.d,A)),!X&&"_CreateFromId"===w){var Z=Object(v.m)(e,p._CreateFromType),J=Object(v.h)(e,Z);J&&(X=le(Z,p._CreateFromId,J.DisplayName))}if(!X){ue(n,Q.d);continue}if(!y&&(y=X,I))if(_){M=_.then((function(){return t(Object(q.b)(i,h)).then((function(){n&&n.info("updateSnapshotWithOptions completed (2).",r)}))}));P.push(M)}else _=me(e,t,y,c,i,n,r,f,b),P.push(_);if(Object(v.h)(e,c).IsActivity&&-1===Object.keys(O).indexOf(N.t)&&Object(v.z)(e,c,y.etn,N.t)){var $=Object(s.ab)(e,i,m);$&&$[N.t]&&(O[N.t]=X)}}else{if(ue(n,w),Object(K.c)(e,Y.Rc))return Promise.reject(Object(V.b)(e,i,2200000009))}}}var ee=Object(K.c)(e,Y.L),te=O;ee&&(te=function(e,t,n,r,a){var i={},o=Object(T.w)(r),c=Object(s.P)(e,o,t,n);for(var l in a)if(c&&c.hasOwnProperty(l)){var u=Object(d.a)(e,t,l);if(!(u&&u.ParentPicklistLogicalName)&&!Object(U.a)(e,r,n,t,c,l,{name:l,value:0})){i[l]=a[l];var p=[];for(u&&u.ChildPicklistLogicalNames&&(p=p.concat(u.ChildPicklistLogicalNames));p&&p.length>0;){var g=p.pop();if(a.hasOwnProperty(g)){var h=Object(d.a)(e,t,g),m=JSON.parse(a[h.ParentPicklistLogicalName]),f=JSON.parse(a[g]);Object(H.a)(e,n,r,h,t,m,f)&&(i[g]=a[g],h.ChildPicklistLogicalNames&&h.ChildPicklistLogicalNames.length>0&&(p=p.concat(h.ChildPicklistLogicalNames)))}}}}else i[l]=a[l];return i}(e,c,i,m,O));var ne=he(te);if(P.length>0)return Promise.all(P).catch((function(e){if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)})).then((function(){return t(Object(g.a)(i,ne,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",r),Promise.resolve(null)}));return t(Object(g.a)(i,ne,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",r),Promise.resolve(null)}(C(),_,L,h,t,w,A,e,n,Pe,Ie)}if(X&&X.Controls&&X.Controls.notescontrol){var xe=Object(l.g)(O,t);L.info("loadTimelineConfigAndMetaData started.",h),_(Object(E.b)(X.Controls.notescontrol,xe,r)).then((function(){L.info("loadTimelineConfigAndMetaData completed.",h)}))}if(X&&X.Controls)for(var Ee in X.Controls)if(X.Controls[Ee]){if(X.Controls[Ee].Id&&X.Controls[Ee].Id.startsWith("WebResource"))for(var Te=0,we=X.Controls[Ee].Parameters;Te<we.length;Te++){var Ae=we[Te];if("Url"===Ae.Name){var Fe=!1;if(c)for(var Ne=0,ke=c;Ne<ke.length;Ne++){var Me=ke[Ne],De=Ae.Value&&Ae.Value.toLowerCase()||"";if(De.length>=Me.length&&De.length-Me.length===De.lastIndexOf(Me)){Fe=!0;break}}if(!Fe){var Re=Object(F.j)(O,Ae.Value);Re&&!Re.Name&&(L.info("retrieveWebResourceDescriptorByName started.",h),_(Object(B.c)(Ae.Value)).then((function(){L.info("retrieveWebResourceDescriptorByName completed.",h)})))}}}a.a.equals(X.Controls[Ee].ClassId,D.rb)&&O&&void 0===O.currentServerTime.serverTimeDiffInSeconds&&(L.info("retrieveServerTime started.",h),_(Object(R.b)(new u.a(w))).then((function(){L.info("retrieveServerTime completed.",h)})))}return null!=y?y:(L.info("initializeForm completed.",h),Promise.all(G))},getFailureParameters:function(e,t){return h}}}function ae(e,t,n,a,i,o,s){var c=t(Object(m.f)(o,!1,[])).then((function(){var n=Object(v.h)(e(),o);if(n.IsChildEntity){var r=Object(S.d)(e(),n);return t(Object(m.f)(r.EntityLogicalName,!1,[]))}})),u=function(){var i=e();if(!Object(S.b)(i,o))return ie(2200000001,t,n,a,i,s);var c=Object(S.c)(i,o),u=Object(r.d)(i);return c&&Object(l.m)(i,s)&&!u?ie(2200000002,t,n,a,i,s):void 0};return c?c.then(u):Promise.resolve(u())}function ie(e,t,n,r,a,i){var o=Object(V.d)(e);return t(Object(w.e)(o)).then((function(){var t=Object(V.c)(e);if(n){var s=[{name:"CorrelationId",value:r.correlationId},{name:"ContextId",value:r.contextId},{name:"ActionStack",value:r.stack}];n.debug(t,s)}var c=Object(G.e)(a,o),l=Object(G.c)(c,o[0]),u=Object(G.c)(c,o[1]);throw Object(V.b)(a,i,e,t,l,u)}))}function oe(e,t,n,r,a,i,o,c,h){h.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",h);var m=Object(d.d)(e,n);if(m){for(var f=function(e){return e&&e.OptionSet&&Object.keys(e.OptionSet).length>0},b=Object(l.g)(e,r).id,v=new u.a(n,b),y={},_=Object(s.ac)(e,r,o),C=function(t){var n=m[t];if(n&&(a.indexOf(t)>=0&&i.indexOf(t)>=0||f(n))&&!Object(s.X)(e,r,o,_,v,n.LogicalName)){switch(t){case N.q:var c=Object(p.q)(e),l=Object(p.t)(e);if(c&&l){var d=new u.a(A.a,c,l);y[t]=d}break;case N.w:if(!Object(M.d)(e,_,null,N.w)){var g=Object(p.b)(e);if(g){var h=new u.a(A.b,g.transactionCurrencyId,g.currencyName);y[t]=h}}}if(f(n)){var b=Object(M.d)(e,_,new u.a(n.EntityLogicalName),t),C=b?parseInt(b.valueString,10):null!=n.DefaultValue?n.DefaultValue:t===N.u?0:void 0;if(void 0===C||C<0||(y[t]=C),t===N.u&&-1!==a.indexOf(N.v)){var S=m[t];if(S&&S.OptionSet&&Object.keys(S.OptionSet).length>0){var O=n.OptionSet.find((function(e){return e.Value===C})),I=O?O.DefaultStatus:m[N.v].DefaultValue||0;I<0||(y[N.v]=I)}}}}},S=0,O=a.concat(i);S<O.length;S++){C(O[S])}var I=he(y);t(Object(g.a)(r,I,!0,!0)),c.info("autoPopulateFields completed.",h)}else c&&c.warn("attributes is null.",h)}function se(e,t,n,r,i,o,s){var c=Object(l.g)(e,r).id,d=new u.a(n,c),p={};if(a.a.isNullOrEmpty(d.id)&&!s)return function(e,t,n,r,i){var o=Object(y.d)(e,n);if(null!=o)return Promise.resolve(o);return t(Object(L.a)(a.a.EMPTY,new u.a(n,a.a.EMPTY))).then((function(e){return e&&e.businessProcessFlows?Promise.resolve(a.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)})).catch((function(e){var t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:n},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return r.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),r.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)}))}(e,t,n,i,o).then((function(e){e&&(p.processid=e.guid);var n=he(p);return t(Object(g.a)(r,n,!0,!0)),Promise.resolve()}));s&&(p.processid=s);var h=he(p);return t(Object(g.a)(r,h,!0,!0)),Promise.resolve()}function ce(e,t,n){var r=t;!t.match(/id$/i)&&t.indexOf(Q.d)>-1&&(r+="id");var i=e[r];if(null!=i){if(a.a.validate(i)){var o=i,s=e[t+"name"],c=e[t+"type"]||e[t+"target"];return!c&&n.Targets&&n.Targets.length>0&&(c=n.Targets[0]),le(c,o,s)}try{var l=JSON.parse(i);if(l)return le(l.entityType,l.id,l.name)}catch(e){}}return null}function le(e,t,n){if(e&&t&&a.a.validate(t)){var r=new a.a(t);if(!a.a.isNullOrEmpty(r))return new u.a(e,r,n)}return null}function ue(e,t,n){if(e){var r=[{name:"key",value:t},{name:"source",value:n}];e.warn("Value passed is not in correct syntax.",r)}}function de(e,t,n,r,a,i,o,s){return pe(e,t,n,r,i,o,s).then((function(){return ge(e,t,n,a,i,o,s)}))}function pe(e,t,n,r,a,i,o){return!Object(s.Eb)(e,a)&&Object($.n)(e,a)?(i&&i.warn("pageId"+a+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,a,2200000008,"Page has expired."))):(i&&i.info("loadScripts started.",o),n(t.ScriptManager.getContainer(a).getEventManager().loadScripts(r,a)).then((function(){i&&i.info("loadScripts completed",o)})))}function ge(e,t,n,r,a,i,o){if(Object(s.Eb)(e,a)||!Object($.n)(e,a)){i&&i.info("runFormOnLoadScripts started.",o);var c=t.ScriptManager.getContainer(a).getEventManager();n(c.addPblEvent(r)),n(c.runOnLoad(r,1)),n(c.runOnDataLoad(r,1)),i&&i.info("runFormOnLoadScripts completed.",o)}else i&&i.warn("pageId "+a+" is dead so won't run runFormOnLoadScripts",o)}function he(e){var t={};for(var n in e){var r={fieldName:n,value:e[n]};t[n]=r}return t}function me(e,t,n,r,a,i,s,c,l){var d=Object(T.j)(e,a),p=Object(T.x)(d);return i&&i.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,n,r,a){return{type:"snapshot.from.async",execute:function(i,s){var c=i.dispatch,l=i.getState,d=s.DataSource,p=u.a.toLegacyEntityReference(e),g=new _.a(p,t,C.a.All),S=d.execute(g,null).nativePromise(),O=null,I=null,j=null;return S.then((function(e){var n=e.get_entity();return O=Object(h.a)(n),I=O.fields,j=O.identifier,c(Object(m.f)(t,!1,Object.keys(O.fields)))}),(function(e){var n=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||n&&-2147217919===n.getNegativeErrorCode())&&r){var i=[];if(I={},r.etn){var s=Object(v.c)(l(),r.etn,t);if(s)for(var d=0,p=s;d<p.length;d++){var g=p[d];g.ReferencingAttribute&&i.push(g.ReferencingAttribute)}}else a&&i.push(a.attributeName);for(var h=0,f=i;h<f.length;h++){var b=f[h];if(!r.name&&r.id){var _=Object(y.h)(l(),r.etn,r.id.guid);if(_&&_.fields){var C=Object(v.E)(l(),r.etn),S=_.fields[C];S&&S.value||(S=_.fields.name),S&&S.value&&(r={etn:r.etn,id:r.id,name:S.value})}}I[b]={reference:r,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return j=new u.a(t),c(Object(m.f)(t,!1,i))}Object(o.b)(e)})).then((function(){var e=Object(f.b)(l(),j,I,n,b.a.Create),t=e.payload.snapshotId;return c(e),t}))}}}(n,r,p,c,l)).then((function(e){i&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(O.b)(a,e,d)).then((function(){i&&i.info("createAndSetDataSnapshotFrom completed.",s)}))}))}function fe(e,t,n){var r={};if(n&&n.Attributes&&t){var a=Object(F.d)(e,n.FormLibraries,[t]);if(n.Attributes||a){var i=[].concat(n.Attributes,a);-1===i.indexOf(N.u)&&i.push(N.u),r=be(e,t,i)}}return{attributes:r,submitModes:{}}}function be(e,t,n){var r={};if(n&&t)for(var a=0;a<n.length;a++){var i=n[a];if(i){var o=Object(s.L)(e,t,i);o&&(r[i]=o)}}return r}function ve(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function ye(e,t,n){var r={},a={},i={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0},u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames)for(var d=!1,p=0,g=Object(s.m)(e,t);p<g.length;p++){var h=g[p],m={collapsed:!!d||!(h.Expanded&&h.Visible),visible:h.Visible,label:h.Label,sectionNames:[],domId:h.DomId,showLabel:h.ShowLabel,contentType:null};switch(h.ContentType){case"expandAvailableSpace":case"singleComponent":m.contentType="singleComponent";break;default:m.contentType="cardSections"}d=d||h.Expanded&&h.Visible;var f=[];if(h.Columns)for(var b=0;b<h.Columns.length;b++){var v=h.Columns[b];if(v.SectionNames)for(var y=0;y<v.SectionNames.length;y++){var _=v.SectionNames[y];if(t.Sections[_]){var C=t.Sections[_];f.push(_);for(var S=[],O=0,j=t.Sections[_].Rows;O<j.length;O++)for(var P=0,x=j[O].Cells;P<x.length;P++){var E=x[P];E.ControlName&&S.push(E.ControlName)}var T={parentTabId:h.Id,visible:C.Visible,label:C.Label,controlNames:S,domId:C.DomId,semanticZoomDomId:C.SemanticZoomDomId};a[_]=T;for(var w=0;w<S.length;w++){var A=S[w];if(t.Controls[A]){var F=t.Controls[A],N=_e(F,_,!0),k=Object(c.a)(F,t,Object(X.b)(e));null!=k&&(N.visible=N.visible||k.ShouldOverrideControlVisible),Se(N),i[A]=N}}}}}if(h.Header)for(var M=0,D=h.Header;M<D.length;M++){i[(W=D[M]).Name]=_e(W,null,!0)}if(h.Footer)for(var R=0,L=h.Footer;R<L.length;R++){i[(H=L[R]).Name]=_e(H,null,!0)}m.sectionNames=f,r[h.Id]=m}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){var B=ve(t.Header);if(B)for(var V=0,G=B;V<G.length;V++){var W;i[(W=G[V]).Name]=_e(W,null,!0),Se(i[W.Name])}o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){var z=ve(t.Footer);if(z)for(var q=0,U=z;q<U.length;q++){var H;i[(H=U[q]).Name]=_e(H,null,!0),Se(i[H.Name])}l.visible=!1!==t.Footer.Visible}return{formId:n,tabs:r,sections:a,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:l}}function _e(e,t,n){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:n,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function Ce(e,t,n,r,i,o,c,l,u){void 0===l&&(l=null);var d=Object(s.cb)(e,o,c),p=Object(ee.a)(e,o);a.a.equals(null==d?void 0:d.formId,null==r?void 0:r.formId)&&a.a.equals(n,null==p?void 0:p.formId)||t(function(e,t,n,r,a,i,o){void 0===i&&(i=null);return{type:te,payload:{formId:e,formUIState:t,formMetadataState:n,relatedEntityMetadataState:i,currentLanguageId:o},meta:{pageId:r,contextToken:a}}}(n,r,i,o,c,l,u))}function Se(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},"8//c":function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return k}));var r=n("sOTk"),a=n("mGpW"),i=n("7z0H"),o=n("Pm+b"),s=n("jw+s"),c=n("Sscr"),l=n("NWJ/"),u=n("rQCE"),d=n("i8/j"),p=n("M6d0"),g=n("XNwl"),h=n("oj0s"),m=n("Srej"),f=n("Eoze"),b=n("9r0m"),v=n("lMVv");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t,n,r,a){!function(e,t,n){var r=Object(v.h)(e,t);r&&n.push({name:"IsCustomEntity",value:r.IsCustomEntity},{name:"IsActivityEntity",value:r.IsActivity})}(e,r,a),function(e,t,n,r){var a=Object(d.d)(e,n,t);if(a){var i=Object.keys(a);r.push({name:"NumControls",value:i.length})}}(e,t,n,a)}var _=n("/j9Z"),C=n("YEEA"),S=n("LBS5"),O=n("HSdq"),I=n("3NtJ"),j=n("GUnN"),P=n("TiXY"),x=n("cZkS"),E=n("qC0c"),T=n("OTOS"),w=n("j+yI"),A=n("dcAs"),F=n("B188");function N(e,t){return function(n){return M(e,t,n,"initialize.quickCreateFormAction.async")}}function k(e,t){return M(e,t,null,"initialize.quickCreateFormActionsaveandnew.async")}function M(e,t,n,v){var N=[{name:"RemoveScriptContainer",value:t}];return{type:v,execute:function(k,M,D){var R=k.dispatch,L=k.getState,B=L(),V=Object(r.g)(B,e),G=V.entityTypeName,W=V.formId,z=V.id,X=M.TraceManager.getTracer("Forms.QuickCreate.InitializeAction");N.push({name:"CorrelationId",value:D.correlationId},{name:"ContextId",value:D.contextId},{name:"ActionStack",value:D.stack},{name:"InitialFormId",value:b.a.toString(W)},{name:"EntityName",value:G},{name:"PageId",value:e},{name:"updatedFormId",value:b.a.toString(n&&n.updatedFormId)}),X.info("_initializeAction started.",N);var q=Object(c.j)(B,e);t&&M.ScriptManager.removeContainer(e,!0);var U=function(e,t,n,r,a,i,o){if(o){var s=Object(T.b)(a,i);return r.push({name:"skippedPreInitCodePath",value:o},{name:"newFormId",value:b.a.toString(s)}),s}if(r.push({name:"preInitResult",value:JSON.stringify(e)}),!e){var c="PreInitResult during QuickCreateForm is invalid for entity '"+t+"'";throw n.error(c,r),new _.a(c)}if(e.error)throw e.error;var l=e.updatedFormId;if(!l||b.a.equals(l,b.a.EMPTY)){c="Form descriptor is null or not defined";throw n.error(c,r),new _.a(c)}return r.push({name:"newFormId",value:b.a.toString(l)}),l}(n,G,X,N,B,e,"initialize.quickCreateFormActionsaveandnew.async"===v);return X.info("parallelizablePromises started.",N),function(e,t,n,r,o,c,l,u,d,p,g,m){g.info("retrieveResourceStrings started.",m);var f=e(Object(a.e)(s.d)).then((function(){g&&(m.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),g.info("retrieveResourceStrings completed.",m))})).catch((function(e){m.push({name:"loadResourceStringsPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));g&&g.info("initializeContainerForClientApi started.",m);var b=u.ScriptManager.initializeContainerForClientApi(r).then((function(){g&&g.info("initializeContainerForClientApi completed.",m),e(Object(S.b)(n,r,p,o))})).catch((function(e){m.push({name:"initializeClientApiContainerPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));g&&g.info("checkEntityEnabledForUCI started.",m);var v=Object(i.e)(t,e,g,l,o,p,r).then((function(){g&&g.info("checkEntityEnabledForUCI completed.",m)})).catch((function(e){m.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}));g&&g.info("loadFormDependencies started.",m);var y=e(Object(h.c)(c,p)).then((function(){g&&g.info("loadFormDependencies completed.",m)})).catch((function(e){m.push({name:"loadFormDependencies.Reason",value:Object(j.e)(e)}),Object(_.b)(e)})),C=Object(w.c)(t(),e,u,p,g,m);return Promise.all([f,b,v,y,C])}(R,L,q,e,z,U,D,M,0,G,X,N).then((function(){return X.info("parallelizablePromises completed.",N),R(Object(i.h)(U,e,q)).then((function(){var t=Object(d.j)(L(),U),n=Object(O.N)(L(),U);return R(Object(I.b)(e,q,n)),X.info("retrieveRecordDataForOrganization started.",N),R(Object(f.f)(t.FormLibraries)).then((function(){X.info("retrieveRecordDataForOrganization completed.",N),R(Object(o.a)(!0,e,q))})).then((function(){var n=[p.q,p.u,p.v,p.w];Object(i.c)(L(),R,G,e,n,t.Attributes,q,X,N)})).then((function(){return Object(E.c)(L(),x.L)&&R(Object(P.c)(G,e,q)),Object(E.c)(L(),x.nd)&&R(Object(l.b)(e,u.a.OnLoadReady)),Object(i.i)(L(),M,R,U,q,e,X,N)})).catch((function(e){N.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}))})).catch((function(e){N.push({name:"initializeForm.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}))})).catch((function(e){N.push({name:"initializeActionPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)})).then((function(){y(L(),e,W,G,N),M.EventManager.ReportComponentSuccess("Forms.QuickCreate.InitializeAction",N),X.info("_initializeAction completed.",N),R(Object(l.b)(e,u.a.FullLoad));var t=Object(m.c)(e,G,L(),q);t&&R(Object(g.c)(e,t)),function(e,t,n,r){Object(F.a)()&&e(Object(A.a)(t,n,r))}(R,e,q,G)})).catch((function(t){y(L(),e,W,G,N),Object(C.h)(L(),e,t,N,M,"Forms.QuickCreate.InitializeAction"),Object(_.b)(t)}))},getFailureParameters:function(e,t){return Object(C.a)(e,N),N}}}},"8ADW":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="Chart.Component",a="ViewId",i="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},"8Fmj":function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var r=n("9r0m"),a=n("G7N+"),i=n("KDdL"),o=n("7dGM"),s=n("8ADW"),c=n("z9yS"),l=n("Xlzu"),u=n("t8f4"),d=n("QAhb"),p=n("xhI+"),g=n("/j9Z"),h=n("Fpc+"),m=n("Kn4q"),f=n("zEjV"),b=n("S2mk"),v=n("cZkS"),y=n("qC0c");function _(e,t,n){void 0===t&&(t=c.a.savedvisualization);var p=[];return p.push({name:s.f,value:e}),p.push({name:s.i,value:t}),p.push({name:s.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute:function(h,b){var _=h.dispatch,C=h.getState;try{var O=m.a.LocalAndRemote,P=b.TraceManager.getTracer(s.d),T=b.DataSource,w=C(),A=n;if(P.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+n),!e){return b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error("entityTypeName is null"),s.d,p),Promise.reject("entityTypeName is null")}r.a.isNullOrEmpty(A)&&(A=Object(o.j)(w,e));var F=Object(y.c)(C(),v.A);if(!r.a.isNullOrEmpty(A)){var N=Object(o.f)(w,A),k=Object(o.g)(w,A);if(N===a.a.Initialized){if(function(){var n=Object(o.a)(w,A),r=function(e,t,n,r){var a=c.a[n],i=Object(o.i)(e,t);return i&&i.chartTypes&&i.chartTypes[a]&&i.chartTypes[a][r.guid]}(w,e,t,A),a=r&&!r.IsUserChart;switch(Object(l.d)(w,a,n,(function(){return r}))){case 1:O=m.a.Remote;break;case 2:_(function(e,t,n){var r=[];return r.push({name:"entityTypeName",value:t}),r.push({name:"visualizationType",value:n}),{type:"chartselector.retrieve.async",execute:function(e,a){var o=e.dispatch;e.getState;try{return o(Object(l.b)(c.a[n],null,t,null,!0,f.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(g.b)}catch(e){throw a.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),s.e,r),e}}}}(0,e,t))}}(),O!==m.a.LocalAndRemote)return I(_,T,e,A,t,O,b,p);if(F&&k===a.a.Uninitialized){var M=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",A),D=Object(o.a)(w,A);return _(S(A,a.a.Initialized)),_(Object(u.d)(M)).catch(g.b).then((function(e){return j(D,e),_(x(e)),b.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(A)}),(function(e){return E(_,e,A.guid,D,b,p),Promise.resolve(A)}))}return Promise.resolve(A)}return I(_,T,e,A,t,O,b,p)}return I(_,T,e,A,t,O,b,p)}catch(e){throw b.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,p),e}}}}function C(e){return{type:"chart.dependencies.update.async",execute:function(t,n){var a=t.dispatch,i=t.getState,s=[];for(var c in e)s.push(e[c]+":name");return s.length>0?a(Object(p.a)(s)).then((function(){var t=new Map,n=i();for(var s in e){var c=e[s],l=Object(o.a)(n,new r.a(c));l&&c&&n.metadata.labels&&n.metadata.labels[c]&&n.metadata.labels[c].name&&(l.Name=n.metadata.labels[c].name,t.set(c,l))}t.size>0&&a(function(e){var t={};return e.forEach((function(e,n){t[n]=e})),{type:"chart.descriptor.update",payload:{charts:t}}}(t))}),g.b):Promise.resolve()}}}function S(e,t){var n,i=r.a.isNullOrEmpty(e)?null:{charts:(n={},n[r.a.toString(e)]={initialized:t,oDataInitialized:a.a.Initializing},n)};return{type:h.f,payload:i}}function O(e,t,n,o,p){void 0===o&&(o=c.a.savedvisualization);var h=[];return h.push({name:s.f,value:t}),h.push({name:s.i,value:o}),h.push({name:s.h,value:r.a.toString(n)}),{type:"chart.retrieve.async",execute:function(e,s){var m=e.dispatch,b=e.getState;return Object(y.c)(b(),v.A)?n?function(e,t,n,o,s,p,h){var m=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(S(n,a.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,r.a.toLegacyGuid(n),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(g.b),e(Object(u.d)(m)).catch(g.c)]).then((function(t){return t[1].constructor===g.a?E(e,t[1],n.guid,t[0].charts[n.guid],p,h):(j(t[0].charts[n.guid],t[1]),e(x(t[1])),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]}))}(m,t,n,o,p,s,h):function(e,t,n,o,s,p,h){return e(Object(l.b)(c.a[o],null,t,r.a.toLegacyGuid(n),!0,f.a.OnDemandWithContext,null,null,[],null,s)).catch(g.b).then((function(t){var n=new r.a(Object.keys(t.charts)[0]),s=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(S(n,a.a.Initializing)),e(Object(u.d)(s)).catch(g.b).then((function(r){return j(t.charts[n.guid],r),e(x(r)),p.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t}),(function(r){return E(e,r,n.guid,t.charts[n.guid],p,h),t}))}))}(m,t,n,o,p,s,h):function(e,t,n,a,i){return e(Object(l.b)(c.a[a],null,t,r.a.toLegacyGuid(n),!0,f.a.OnDemandWithContext,null,null,[],null,i)).catch(g.b)}(m,t,n,o,p)}}}function I(e,t,n,o,c,l,u,d){var p,m,f;return e((p=o,f=r.a.isNullOrEmpty(p)?null:{charts:(m={},m[r.a.toString(p)]={initialized:a.a.Initializing},m)},{type:h.b,payload:f})),e(O(0,n,o,c,l)).then((function(t){t&&t.chartSelectors&&!t.chartSelectors[n]&&(t.chartSelectors[n]={initialized:a.a.Initialized,chartTypes:{}});var s=[];for(var c in t.charts)s.push(c);return e(C(s)).then((function(){return e(P(t)),r.a.isNullOrEmpty(o)&&(o=t.chartDefaults[n]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),o}),g.b)}),(function(t){var c,l,p=t&&!Object(b.j)(t.errorCode)&&t.errorCode,h={chartSelectors:(c={},c[n]={initialized:a.a.Initialized,chartTypes:{}},c)};if(e(P(h)),Object(b.j)(p))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),s.d,d),Object(g.b)(t);var m={charts:(l={},l[r.a.toString(o)]={initialized:a.a.Error,errorCode:p},l)};e(P(m))}))}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=a.a.Initialized}function P(e){return{type:h.b,payload:e}}function x(e){return{type:h.f,payload:e}}function E(e,t,n,r,o,c){var l;e(x({charts:(l={},l[n]={initialized:r.initialized,oDataInitialized:a.a.Error},l)})),o.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),s.c,c)}},"90Ov":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return Object(r.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},"96h0":function(e,t,n){"use strict";n.r(t),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return j})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return x}));var r=n("c/eZ"),a=n("H9DM"),i=n("GUnN"),o=n("Ww2r"),s=n("kh6f"),c=n("evh6"),l=n("MLbG"),u=n("+D0h"),d=n("mGpW"),p=n("Vm/X"),g=n("KjDZ"),h=n("WS0f");var m=n("hzb9"),f=n("pkDq"),b=n("rcZN"),v=n("ygXU"),y=n("iJR5"),_=n("VnuK"),C=n("qC0c"),S=n("cZkS"),O=n("US37"),I=n("ZaNp"),j="offline.upsync.process.async",P=null;function x(e){return void 0===e&&(e=!1),{type:j,execute:function(t,n){var a=t.dispatch,i=t.getState;return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,o,s;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return t=Object(b.b)(i()),e||t!==v.a.Completed?null==P?[3,2]:[4,P]:[2,Promise.resolve()];case 1:return r.sent(),[3,6];case 2:return r.trys.push([2,4,5,6]),[4,P=T(i,a,n)];case 3:return r.sent(),[3,6];case 4:throw(o=r.sent())instanceof y.a||(s=(null==o?void 0:o.message)||"Unexpected upsync error",o=y.a.FromMessage(s)),o;case 5:return P=null,[7];case 6:return[2]}}))}))}}}function E(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function(){var n,a,i;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return Object(C.c)(e(),S.l)&&Object(I.e)(e())?(n=["offline_notification_reconnect_success_text"],[4,t(Object(d.e)(n))]):[3,2];case 1:r.sent(),a=Object(o.b)(e(),n[0]),i={id:"upsync_complete_toast",level:1,message:a,title:null,type:1,onCloseHandler:null},t(Object(O.b)(!1)),t(Object(_.b)(i)),r.label=2;case 2:return[2]}}))}))}function T(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function(){var b,v,y,_,C;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:b=new Date,v="Offline: Upsync",r.label=1;case 1:return r.trys.push([1,11,,12]),[4,n.OfflineProvider.hasItemsToUpsync().nativePromise()];case 2:if(!r.sent())return[3,9];s.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),t(Object(m.b)()),r.label=3;case 3:return r.trys.push([3,8,,9]),[4,n.OfflineProvider.startPlayback().nativePromise()];case 4:return y=r.sent(),t(Object(f.b)()),Object(h.a)(y)||0!==y.get_errorCount()?[3,6]:[4,E(e,t)];case 5:return r.sent(),s.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict"),[3,7];case 6:s.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),t((S=String(y.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute:function(e,t){var n=e.dispatch,r=e.getState,a=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return n(Object(d.e)(a)).then((function(){var e=Object(o.e)(r(),a),t=Object(o.c)(e,"L_Show_Details_Text"),d=Object(o.c)(e,"Sync_Status_Error_Message"),m=Object(o.c)(e,"L_Last_Save_To_CRM_Server_Text"),f=Object(o.c)(e,"Sync_Status_Dialog_Title"),b=Object(o.c)(e,"Dialog_Button_Ok"),v=d+"\n"+m,y="";return y=Object(h.b)(g.a.get_OverallSyncErrorMessage())?v.replace("{0}",S):g.a.get_OverallSyncErrorMessage(),n(Object(l.a)(p.c,y,{},t,f,"",b)).then((function(e){return 0===e.status?n(Object(u.a)(e.pageId)).then((function(t){t.value.confirmed&&n(Object(c.a)("syncerror",e.pageId,null,null,null,null,null))})):(s.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e.error)),Promise.reject(e.error))}))})).catch((function(e){return s.c.error("Offline: Error in Sync error dialog creation "+Object(i.e)(e)),Promise.reject(e)}))}})),r.label=7;case 7:return n.EventManager.ReportComponentSuccess(v),n.EventManager.ReportComponentPerformance(v,"Time Taken in ms",+new Date-+b),[2];case 8:return _=r.sent(),s.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),t(Object(a.b)()),n.EventManager.ReportComponentFailure(v,_),n.EventManager.ReportComponentPerformance(v,"Time Taken in ms",+new Date-+b),[2,Promise.reject(_)];case 9:return s.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),t(Object(f.b)()),[4,E(e,t)];case 10:return r.sent(),[3,12];case 11:return C=r.sent(),s.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),[2,Promise.reject(C)];case 12:return[2]}var S}))}))}},"9LTA":function(e,t,n){"use strict";n.d(t,"b",(function(){return Se})),n.d(t,"d",(function(){return Oe})),n.d(t,"e",(function(){return Ie})),n.d(t,"c",(function(){return je})),n.d(t,"a",(function(){return Pe}));var r=n("0RbL"),a=n("9r0m"),i=n("G7N+"),o=n("KDdL"),s=n("c/eZ");var c=n("70DF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var l=n("QAhb"),u=n("VcAV"),d=n("+h4s"),p=function(){function e(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}return e.prototype.addAggregator=function(e,t,n,r,i){if(n>=c.a.DAY&&n<c.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,n,r,i);else if(n===c.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,r,i);else if(n===c.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,r,i);else{var o=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(o.FieldName=e,o.EntityName=r,o.LinkEntityExpressionArray=i,Object(u.c)(t))o.Value=null;else if(t instanceof l.a){var s=t;o.Value=s.id.guid,o.DisplayName=s.name,o.EntityLogicalName=s.etn}else t instanceof a.a?o.Value=a.a.toString(t):o.Value=t.toString();this._dataPointAggregators.push(o)}},e._daysInMonth=function(e,t){return new Date(e,t,0).getDate()},e.prototype._addDataPointFiscalPeriodAggregator=function(e,t,n,r){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(a.FiscalType="in-fiscal-period-and-year",a.FieldName=e,a.EntityName=n,a.LinkEntityExpressionArray=r,t){if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");var i=t.split("-");a.Year=Number(i[0]),a.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(a)}else this._dataPointFiscalPeriodAggregators.push(a)},e.prototype._addDataPointFiscalYearAggregator=function(e,t,n,r){var a=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(a.FiscalType="in-fiscal-year",a.FieldName=e,a.EntityName=n,a.LinkEntityExpressionArray=r,t){if("number"!=typeof t)throw new Error("value should be number");a.Year=Number(t),this._dataPointFiscalYearAggregators.push(a)}else this._dataPointFiscalYearAggregators.push(a)},e.prototype._addDateTimeRangeAggregatorInfo=function(e,t,n,r,a){var i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||c.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=r),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=a),n){case c.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case c.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case c.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case c.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case c.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(n,i.dateTimeAggregatorPrecision)},e.prototype._getDataPointDateTimeRangeAggregators=function(t,n){var r=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((function(a,i){var o,s={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};if(s.FieldName=a.dateTimeAggregatorFieldName,s.EntityName=a.dateTimeAggregatorEntityName,s.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:e._daysInMonth(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),s.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case c.a.DAY:g(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth(),s.MaxDate.getDate());break;case c.a.WEEK:n===d.a.FirstFullWeekOfTheYear&&(n=d.a.FirstDayOfTheYear);var l=Object(d.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,t,n),u=Object(d.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,t,n);if(u.setDate(u.getDate()-1),n===d.a.FirstDayOfTheYear)if(u>=new Date(a.dateTimeAggregatorYear+1,0,1))u=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){var p=new Date(a.dateTimeAggregatorYear,0,1);l<p&&(l=p)}s.MinDate=l,s.MaxDate=u,g(s.MaxDate),g(s.MinDate);break;case c.a.MONTH:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-1,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth())+1),g(s.MaxDate),g(s.MinDate);break;case c.a.QUARTER:s.MinDate=new Date(s.MaxDate.getFullYear(),s.MaxDate.getMonth()-3,e._daysInMonth(a.dateTimeAggregatorYear,s.MaxDate.getMonth()-2)+1),g(s.MaxDate),g(s.MinDate);break;case c.a.YEAR:g(s.MaxDate),s.MinDate=new Date(s.MaxDate.getFullYear()-1,s.MaxDate.getMonth(),s.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}r.push(s)}else r.push(s)})),r},e.prototype.getAggregators=function(e,t){var n=this._dataPointAggregators,r=this._getDataPointDateTimeRangeAggregators(e,t);return r&&r.length>0&&(n=n.concat(r)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(n=n.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(n=n.concat(this._dataPointFiscalYearAggregators)),n},e}();function g(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var h=n("Ww2r"),m=n("dUXI"),f=n("7EJx"),b=n("otJc"),v=n("yGoS"),y=n("EGsq"),_=n("F2uj"),C=n("uXKh"),S=n("sRkF");function O(e,t){var n=Object(_.a)(e,t.entity.entityName,t.attributeName),r=n?n.DisplayName:null;r||(r=t.attributeName);var a=r;if(t.dateTimeGrouping){var i=v.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();a=String.format(Object(h.b)(e,m.c),Object(h.b)(e,m.c+"."+i.toUpperCase()),r)}else t.hasAggregate&&t.aggregateType&&(a=String.format(Object(h.b)(e,m.d),Object(h.b)(e,m.d+"."+t.aggregateType.toUpperCase()),r));if(n&&"money"===n.Type){var o="",s=null,c=Object(y.x)(e);n.IsBaseCurrency?c&&c.baseCurrencyId&&c.transactionCurrencyById&&(s=c.transactionCurrencyById[c.baseCurrencyId.guid]):t.hasAggregate&&(s=Object(f.b)(e)),s&&(o=c&&c.currencyDisplayOption===C.a.CurrencyCode?s.currencyCode:s.currencySymbol),o&&(a=String.format(Object(h.b)(e,m.b),a,o))}return a}function I(e,t,n){return n>0?String.format(Object(h.b)(e,m.y),n,t):String.format(Object(h.b)(e,m.w),t)}function j(e,t,n,r,a){var i=a<1&&r>=1&&n<1,o=a<1&&r<1&&n>=1,s=r<1&&n<1;if(a>=1&&r<1&&n>=1){var c=new Date(t,n-1,a),l=Object(f.w)(e),u=l.formatInfoCultureName,d=l.numberFormatInfo,p=l.dateFormatInfo,g=new Sys.CultureInfo(u,d,p);return Object(b.s)(c,g,S.a.None)}return i?String.format(Object(h.b)(e,m.z),r,t):o?String.format("{0} {1}",function(e){var t=Object(h.b)(e,m.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[n-1],t):s?String(t):""}function P(e){return Object(h.b)(e,m.v)}var x=n("9rlF"),E=n("+Z9T");function T(e,t,n){var r=!1;return n&&n.groupAttribute&&n.groupAttribute.dateTimeGrouping&&(r=!0),{attribute:t,primaryGroupBy:n,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:r}}function w(e,t){var n=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(x.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]),r=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return j(e.state,a,r,-1,n)}(e,t);case c.a.WEEK:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]),r=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,r,-1,n,-1)}(e,t);case c.a.MONTH:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]),r=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return j(e.state,r,n,-1,-1)}(e,t);case c.a.QUARTER:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]),r=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,r,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case c.a.FISCAL_PERIOD:return function(e,t){return Object(x.e)(t.fields[e.aliasName])}(e,t);case c.a.YEAR:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]);return j(e.state,n,-1,-1,-1)}(e,t);case c.a.FISCAL_YEAR:return function(e,t){var n=Object(x.e)(t.fields[e.aliasName]);return I(e.state,n,-1)}(e,t);default:return Object(x.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return n||(n=(n=Object(x.c)(t.fields[e.aliasName]))||""),0===n.length?Object(h.b)(e.state,m.v):n}function A(e,t){if(!e.attribute||!Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return w(e,t);switch(Object(_.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":var n=Object(x.e)(t.fields[e.aliasName]);return n=Object(E.a)(n)?-1:Number(n);case"datetime":return function(e,t){var n=-1,r=-1,a=-1;switch(e.attribute.dateTimeGrouping.groupingType){case c.a.DAY:n=Object(x.e)(t.fields[e.aliasName]),r=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),a=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case c.a.MONTH:r=Object(x.e)(t.fields[e.aliasName]),a=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.YEAR:a=Object(x.e)(t.fields[e.aliasName]);break;case c.a.QUARTER:r=Object(x.e)(t.fields[e.aliasName]),a=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case c.a.WEEK:n=1+7*(Object(x.e)(t.fields[e.aliasName])-1),a=Object(x.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return w(e,t)}return new Date(a,r-1,n).getTime()}(e,t);default:return w(e,t)}}function F(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function N(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var k=function(e){function t(n,r,a){var i=e.call(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i.title=r,i.description=a,i}return Object(s.__extends)(t,e),t}(Error),M=n("qC0c"),D=n("cZkS"),R=n("glw0"),L=n("scgP"),B=n("WS0f");function V(){return this.point.formattedValue}function G(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}var W=function(){function e(){this.isInitialized=!1}return Object.defineProperty(e.prototype,"primaryGroupBy",{get:function(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"queryModel",{get:function(){return this._queryModel},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,n,r,a,i,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=n,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=r,this.chartPresentationXAxis=a,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0},e.prototype.setXAxisMajorGridAndMajorTickProperties=function(e,t){var n,r,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[t])||void 0===r?void 0:r.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.setYAxisMajorGridAndMajorTickProperties=function(e,t){var n,r,a,i,o,s,c,l;return void 0===t&&(t=0),e.AxisMajorGridColor=null===(r=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[t])||void 0===r?void 0:r.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e},e.prototype.retrieveChartArea3DStyle=function(){var e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e},e.prototype.retrieveChartAreaGradientStyle=function(){var e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e},e.prototype.setYAxisOppositeProperty=function(e){var t,n,r,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.Opposite=null===(a=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.setXAxisIsReversedProperty=function(e){var t,n,r,a;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.IsReversed=null===(a=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.IsReversed),e},e.prototype.retrieveChartYAxis=function(){var e=this,t=new Array(1);if(t[0]={},!this._queryModel.SeriesList)return t;for(var n=function(t,n,r){e.chartPresentationYAxis&&e.chartPresentationYAxis.length>n&&e.chartPresentationYAxis[n]&&e.chartPresentationYAxis[n].Title?t.Title=e.chartPresentationYAxis[n].Title:1===r&&(t.Title=e._queryModel.SeriesList[n].Title)},r=0,a=-1,i=-1,o=!1,s=!1,c=0;c<this.chartPresentationSeries.length;c++)this.chartPresentationSeries[c].SecondaryYAxis?(r++,i=-1===i?c:i,s=s||this.shouldDisableAllowDecimals(c)):(a=-1===a?c:a,o=o||this.shouldDisableAllowDecimals(c));return n(t[0],a,this.chartPresentationSeries.length-r),t[0].Opposite=!1,o&&(t[0].AllowDecimals=!1),0===r&&(t[0]=this.setYAxisOppositeProperty(t[0])),r>0&&(t[1]={},n(t[1],i,r),t[1].Opposite=!0,s&&(t[1].AllowDecimals=!1)),t.forEach((function(t,n){var r,a,i,o,s,c,l,u,d,p,g,h,m,f;t.Disabled=e.chartPresentationYAxis&&e.chartPresentationYAxis[n]&&e.chartPresentationYAxis[n].Disabled,t.LabelForeColor=null===(a=null===(r=e.chartPresentationYAxis)||void 0===r?void 0:r[n])||void 0===a?void 0:a.LabelForeColor,t.AxisLineColor=null===(o=null===(i=e.chartPresentationYAxis)||void 0===i?void 0:i[n])||void 0===o?void 0:o.AxisLineColor,t.AxisTitleForeColor=null===(c=null===(s=e.chartPresentationYAxis)||void 0===s?void 0:s[n])||void 0===c?void 0:c.AxisTitleForeColor,t.LabelDisabled=null===(u=null===(l=e.chartPresentationYAxis)||void 0===l?void 0:l[n])||void 0===u?void 0:u.LabelDisabled,t.AxisInterval=null===(p=null===(d=e.chartPresentationYAxis)||void 0===d?void 0:d[n])||void 0===p?void 0:p.AxisInterval,t.AxisMinimum=null===(h=null===(g=e.chartPresentationYAxis)||void 0===g?void 0:g[n])||void 0===h?void 0:h.AxisMinimum,t.AxisMaximum=null===(f=null===(m=e.chartPresentationYAxis)||void 0===m?void 0:m[n])||void 0===f?void 0:f.AxisMaximum,t=e.setYAxisMajorGridAndMajorTickProperties(t,n)})),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?t[0].FormatString=this.chartPresentationYAxis[0].FormatString:t[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),r>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?t[1].FormatString=this.chartPresentationYAxis[1].FormatString:t[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[i].measures[0].measureAttribute)),t},e.prototype._isChartCustomizationParityFCBEnabled=function(){return Object(M.a)(this.getState(),D.s,D.Lc,D.w)},e.prototype.retrieveChartAnnotations=function(){for(var e=new Array(this.chartPresentationAnnotationList.length),t=0;t<this.chartPresentationAnnotationList.length;t++){var n={};n.X=this.chartPresentationAnnotationList[t].X,n.Y=this.chartPresentationAnnotationList[t].Y,n.Text=this.chartPresentationAnnotationList[t].Text,n.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=n}return e},e.prototype.retrieveChartCategory=function(){var e,t,n,r,a,i,o=new Array(1),s=null;this.categoryColumn.length>0&&(s=T(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};for(var c=new Array(this.chartData.length),l=0;l<this.chartData.length;l++){var u=this.chartData[l];if(s){if(c[l]=w(s,u),"-1"===c[l])c[l]=Object(h.b)(this.getState(),m.f);else if(!s.isDateTimeChart&&"number"==typeof Object(x.e)(u.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){var d=Object(f.w)(this.getState());c[l]=Object(L.c)(Object(x.e)(u.fields[s.aliasName]),Object(b.d)(d),this.chartPresentationXAxis[0].FormatString)}}else c[l]=P(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,o[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o},e.prototype.retrieveChartCategoryTitle=function(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?O((t=e).state,t.attribute):"";var t},e.prototype.retrieveChartSeries=function(e){for(var t=new Array(this.chartPresentationSeries.length),n=function(n){var a=r.chartDataDescription.category.measureCollections[n].measures[0].measureAttribute,i=a.aliasName?a.aliasName:a.attributeName,o=r.chartPresentationSeries[n].IsValueShownAsLabel,s=r.chartPresentationSeries[n].LabelFormat,c=null;s&&Object(L.d)(s)&&(c=Object(L.g)(s));var l=!1;r.chartPresentationSeries[n].Label&&"#percent"===r.chartPresentationSeries[n].Label.toLowerCase()&&(l=!0);var u=!1;s&&z(r.chartPresentationSeries[n].ChartType)&&Object(L.e)(s)&&(u=!0);var d=null,p=O(r.getState(),a);t[n]=r.cloneBlueprintSeriesStyle(r.chartPresentationSeries[n]),r.chartPresentationSeries[n].SecondaryYAxis&&(t[n].YAxisNumber=1),r.primaryGroupBy&&((d=[]).push(r.primaryGroupBy.groupAttribute),r.primaryGroupBy.extendedGroupBys&&r.primaryGroupBy.extendedGroupBys.forEach((function(e){d.push(e)})));for(var g=new Array(r.chartData.length),h=i,m=0,v=0;v<r.chartData.length;v++){var y=r.chartData[v];g[v]=N();var _=Object(x.e)(y.fields[i]);if(g[v].Value=_||0,m+=_||0,s){var C=Object(f.w)(r.getState()),S=Object(b.d)(C);Object(L.f)(s)?g[v].FormattedValue=Object(R.b)(g[v].Value,r.chartPresentationSeries[n].LabelFormat,S):Object(L.d)(s)&&!u?g[v].FormattedValue=Object(L.a)(g[v].Value,c,S):g[v].FormattedValue=Object(x.c)(y.fields[h])||0}else g[v].FormattedValue=Object(x.c)(y.fields[h])||0;r.attachAggregators(g[v],y,d)}var I=F();o?(I.Enabled=!0,I.LabelFormatter=V):l&&(I.Enabled=!0,I.LabelFormatter=G(m)),I.Color=r.chartPresentationSeries[n].LabelForeColor,t[n].DataLabels=I,t[n].DataPoints=g,t[n].Title=r.getChartTitleFromPresentationSeries(p,n),t[n].XAxisNumber=e,t[n].HideInLegend=r.chartPresentationSeries[n].HideInLegend,t[n].Stack=r.chartPresentationSeries[n].Stack},r=this,a=0;a<this.chartPresentationSeries.length;a++)n(a);var i=Object(f.w)(this.getState()),o=Object(b.d)(i),s=this.chartPresentationSeries[0].IsValueShownAsLabel,c=this.chartPresentationSeries[0].LabelFormat;if(s&&z(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(c))for(var l=X(c,o),u=0;u<t[0].DataPoints.length;u++)l(0,u,0,t);return t},e.prototype.getChartTitleFromPresentationSeries=function(e,t){return void 0===t&&(t=0),Object(B.b)(this.chartPresentationSeries[t].LegendText)?Object(B.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText},e.prototype.shouldDisableAllowDecimals=function(e){var t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType},e.prototype.cloneBlueprintSeriesStyle=function(e){var t,n={DataPoints:t&&t.DataPoints||null,DataLabels:t&&t.DataLabels||null,ChartType:t&&t.ChartType||"line",YAxisNumber:t&&t.YAxisNumber||0,XAxisNumber:t&&t.XAxisNumber||0,Title:t&&t.Title||"",Color:t&&t.Color||"",BorderColor:t&&t.BorderColor||"",BorderWidth:t&&t.BorderWidth||0,CustomProperties:t&&t.CustomProperties||null,Stack:t&&t.Stack||null};return n.ChartType=e.ChartType,n.Color=e.Color,n.BorderColor=e.BorderColor,n.BorderWidth=e.BorderWidth,n.CustomProperties=e.CustomProperties,n},e.prototype.attachAggregators=function(t,n,r){if(r){for(var a=new p,i=function(t){var i=r[t],o=new Array;i.entity.baseEntity&&i.entity.baseEntity.linkedEntities&&i.entity.baseEntity.linkedEntities.forEach((function(e){var t,n={name:t&&t.name||null,from:t&&t.from||null,to:t&&t.to||null,linkType:t&&t.linkType||null,alias:t&&t.alias||null};n.name=e.entityName,n.from=e.linkFromAttribute,n.to=e.linkToAttribute,n.linkType=e.joinType.toString(),n.alias=e.alias,o.push(n)})),a.addAggregator(i.attributeName,Object(x.e)(n.fields[e._getFieldName(i)]),i.dateTimeGrouping?i.dateTimeGrouping.groupingType:-1,i.entity.entityName,o)},o=0;o<r.length;o++)i(o);var s=Object(f.w)(this.getState()),c=this._getFirstDayOfWeekFromUserSettings(s),l=this._getCalendarWeekRuleFromUserSettings(s);t.Aggregators=a.getAggregators(c,l)}},e.prototype._getFirstDayOfWeekFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0},e.prototype._getCalendarWeekRuleFromUserSettings=function(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0},e.prototype.getFormatterPropertiesForAttribute=function(e){return Object(b.z)(this.getState(),Object(_.a)(this.getState(),e.entity.entityName,e.attributeName))},e._getFieldName=function(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName},e.prototype.isChartDrillable=function(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(var e=0,t=this.chartDataDescription.category.measureCollections;e<t.length;e++)for(var n=0,r=t[e].secondaryGroupBys;n<r.length;n++){var a=r[n];if(!this._isGroupByDrillable(a))return!1}return!!this.chartDataDescription.entityExpression.hasAggregate},e.prototype._isGroupByDrillable=function(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))},e.prototype._isAttributeDrillable=function(e){var t,n=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,r=null==e?void 0:e.attributeName;return"memo"!==Object(_.b)(r,n,this.getState())},e.prototype._validateChartAggregateAttributes=function(){for(var e,t,n,r,a=0;a<(null===(n=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===n?void 0:n.length);a++){var i=this.chartDataDescription.entityExpression.aggregateAttributes[a],o=null===(r=null==i?void 0:i.entity)||void 0===r?void 0:r.entityName,s=null==i?void 0:i.attributeName,c=Object(_.b)(s,o,this.getState());if(!("date"!==c&&"datetime"!==c||"min"!==i.aggregateType&&"max"!==i.aggregateType)){var l=String.format(Object(h.b)(this.getState(),m.h),s);throw new k("ChartError",l,l)}}},e}();function z(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function X(e,t){return function n(r,a,i,o){if(r===o.length)return i;var s=o[r].DataPoints[a];return i=n(++r,a,i+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(L.a)(s.Value/i*100,Object(L.g)(e),t)),i}}var q=n("lMVv"),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){var e,t,n,r;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");var a=new Array(0),i=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&a.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(var c=0;c<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;c++)a.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[c]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");for(var l=this._addSecondaryGroupByToFieldAggregators(s,a),u=s.measures[0].measureAttribute,d=u.aliasName?u.aliasName:u.attributeName,p=d,g=o.primaryGroupBy.groupAttribute,h=T(this.getState(),this._getGroupByAttribute(g,o.primaryGroupBy),o.primaryGroupBy),m=new Array,v=new Array,y=new Map,_=0;_<this.chartData.length;_++){var C=w(h,D=this.chartData[_]),S=w(l,D),O=void 0;O=null==S?S=P(this.getState()):A(l,D),i.set(O,S),v.indexOf(C)<0&&v.push(C),m.indexOf(O)<0&&m.push(O)}m.forEach((function(e){var t=new Array(v.length);y.set(e,t)}));var I=Object(f.w)(this.getState()),j=this.chartPresentationSeries[0].LabelFormat,k=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(k=!0);var M=!1;j&&z(this.chartPresentationSeries[0].ChartType)&&Object(L.e)(j)&&(M=!0);for(_=0;_<this.chartData.length;_++){var D,B=A(l,D=this.chartData[_]);Object(E.a)(B)&&(B=P(this.getState()));var W=y.get(B),q=(C=w(h,D),v.indexOf(C));if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(v[q]=Object(L.c)(Object(x.e)(D.fields[h.aliasName]),Object(b.d)(I),this.chartPresentationXAxis[0].FormatString)),W[q]=N(),W[q].Value=Object(x.e)(D.fields[d]),j){var U=Object(b.d)(I);Object(L.f)(j)?W[q].FormattedValue=Object(R.b)(W[_].Value,j,U):Object(L.d)(j)&&!M?W[q].FormattedValue=Object(L.a)(W[q].Value,Object(L.g)(j),U):W[q].FormattedValue=Object(x.c)(D.fields[p])||0}else W[q].FormattedValue=Object(x.c)(D.fields[p])||0;this.attachAggregators(W[q],D,a)}m.forEach((function(e){for(var t=y.get(e),n=0;n<v.length;n++)t[n]||(t[n]=N())}));var H=new Array(1);H[0]={},H[0].Title=this.retrieveChartCategoryTitle(h),H[0].Values=v,H[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,H[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,H[0].AxisTitleForeColor=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.AxisTitleForeColor,H[0].LabelDisabled=null===(r=this.chartPresentationXAxis[0])||void 0===r?void 0:r.LabelDisabled,H[0]=this.setXAxisMajorGridAndMajorTickProperties(H[0]),H[0]=this.setXAxisIsReversedProperty(H[0]),this._sortComparisonCodes(s,m);for(var Y=new Array(m.length),K=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,Q=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,Z=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,J=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name),$=function(e){var t=m[e];if(Y[e]=ee.cloneBlueprintSeriesStyle(ee.chartPresentationSeries[0]),Y[e].Title=J||i.get(t),Y[e].DataPoints=y.get(t),Y[e].HideInLegend=Z,K)(n=F()).Enabled=!0,n.LabelFormatter=V,Y[e].DataLabels=n,n.Color=Q;else if(k){var n,r=0;Y[e].DataPoints.forEach((function(e){r+=e&&e.Value?e.Value:0})),(n=F()).Enabled=!0,n.LabelFormatter=G(r),Y[e].DataLabels=n,n.Color=Q}},ee=this,te=0;te<m.length;te++)$(te);if(K&&M)for(var ne=X(j,U=Object(b.d)(I)),re=0;re<H[0].Values.length;re++)ne(0,re,0,Y);this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=H,this.queryModel.YAxes=this._retrieveChartYAxis(u),this.queryModel.SeriesList=Y,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()},t.prototype._sortComparisonCodes=function(e,t){e.secondaryGroupBys[0].descending?t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)})):t.sort((function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t)}))},t.prototype._getGroupByAttribute=function(e,t){return e.attributeName!==Object(q.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e},t.prototype._addSecondaryGroupByToFieldAggregators=function(e,t){var n=e.secondaryGroupBys[0].groupAttribute,r=T(this.getState(),this._getGroupByAttribute(n,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(n&&t.push(n),e.secondaryGroupBys[0].extendedGroupBys)for(var a=0;a<e.secondaryGroupBys[0].extendedGroupBys.length;a++)t.push(e.secondaryGroupBys[0].extendedGroupBys[a]);return r},t.prototype._retrieveChartYAxis=function(e){var t,n,r,a,i,o,s,c,l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=O(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(n=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.LabelDisabled),l[0].AxisInterval=null===(a=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[0])||void 0===a?void 0:a.AxisInterval,l[0].AxisMinimum=null===(o=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l},t}(W),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t.prototype.retrieveChartCategory=function(){var e,t,n,r,a,i,o,s,c=new Array(1);if(this.chartData.length<1)return c;var l=this.primaryGroupBy.groupAttribute;c[0]={};var u=new Array(this.chartData.length),d=T(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(r=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===r?void 0:r.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(var p=0;p<this.chartData.length;p++){var g=this.chartData[p];u[p]=w(d,g),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[p]!==Object(h.b)(d.state,m.v)&&(u[p]=Object(L.b)(new Date(u[p]),Object(b.d)(Object(f.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c},t}(W),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.parse=function(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())},t}(W);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var K=n("Je7O");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Q(e){var t={};try{if(e){var n=/\w+=\w+/;e.split(/\s*,\s*/).forEach((function(e){if(e&&n.test(e)){var r=e.split("="),a=r[0],i=r[1];t[a]=i}}))}}catch(t){throw"Failed to parse chart custom properties, value: "+e+" "}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var Z=n("S2mk"),J=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $(e,t,n){var r=(new DOMParser).parseFromString(t,"text/xml");return function(e,t){var n=e.getElementsByTagName("parsererror");if(n&&n.length>0)throw new k("ChartError",Object(h.b)(t,m.t),Object(h.b)(t,m.s))}(r,e),{chartPresentationSeries:ee(e,r,n),chartPresentationLegendList:re(r),colorsList:ne(r),chartPresentationArea3DStyle:ce(r),chartPresentationAreaGradientStyle:le(r),chartPresentationXAxis:ie(r),chartPresentationYAxis:oe(r),chartPresentationAnnotationList:ae(r)}}function ee(e,t,n){for(var r=new Array,a=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer,o=0;o<a.length;o++){var s=a[o],c={},l=s.getAttribute("ChartType")||"Column";if(-1===J.indexOf(l.toUpperCase()))throw new k("ChartError",Object(h.b)(e,m.t),Object(h.b)(e,m.t));c.ChartType=l;var u=s.getAttribute("Color");c.Color=u?ue(u):null;var d=s.getAttribute("LegendText");c.LegendText=d||null;var p=s.getAttribute("CustomProperties");c.CustomProperties=Q(p);var g=s.getAttribute("BorderColor");c.BorderColor=g?ue(g):null;var f=s.getAttribute("BorderWidth");c.BorderWidth=f?Number(f):null;var b=s.getAttribute("IsValueShownAsLabel");c.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,c.Label=s.getAttribute("Label");var v=s.getAttribute("YAxisType");c.SecondaryYAxis=v&&"secondary"===v.toLowerCase();var y=s.getAttribute("IsVisibleInLegend");c.HideInLegend=y&&"false"===y.toLowerCase();var _=s.getAttribute("LabelForeColor");c.LabelForeColor=_?ue(_):null,c.LabelFormat=s.getAttribute("LabelFormat");var C=te(e,s.outerHTML||i.serializeToString(s),n);c.Name=C||null,c.Stack=c.CustomProperties.StackedGroupName,r.push(c)}return r}function te(e,t,n){var r=Object(o.a)(t);if(Object(Z.j)(r)||r.length<5)return"";var a=r[2].toLowerCase(),i=r[4],s="",c=a.substring(0,n.length);if(c!==n)return"";var l=a.substring(n.length+1,a.length),u=Object(_.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter((function(e){return e.Value.toString().toLowerCase()===i.toLowerCase()}))[0].Label),s}function ne(e){var t=new Array,n=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==n&&n.split(";").forEach((function(e){if(e){var n=ue(e);t.push(n)}})),t}function re(e){for(var t=new Array,n=e.querySelectorAll("Chart Legends Legend"),r=0;r<n.length;r++){var a={},i=n[r].getAttribute("Enabled");a.Enabled=null===i||"True"===i,t.push(a)}return t}function ae(e){for(var t=new Array,n=e.querySelectorAll("Chart Annotations TextAnnotation"),r=0;r<n.length;r++){var a=n[r],i={},o=a.getAttribute("X");i.X=o?Number(o):null;var s=a.getAttribute("Y");i.Y=s?Number(s):null,i.Text=a.getAttribute("Text");var c=a.getAttribute("ForeColor");i.ForeColor=c?ue(c):null,t.push(i)}return t}function ie(e){for(var t=new Array,n=e.querySelectorAll("Chart ChartAreas ChartArea AxisX"),r=0;r<n.length;r++){var a=n[r],i={};se(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=a.getAttribute("Title");var o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){var s=null==o?void 0:o.getAttribute("ForeColor"),c=null==o?void 0:o.getAttribute("Enabled");i.LabelForeColor=s?ue(s):null,i.LabelDisabled=c&&"false"===c.toLowerCase(),i.FormatString=o.getAttribute("Format")}var l=a.getAttribute("Enabled"),u=a.getAttribute("LineColor"),d=a.getAttribute("TitleForeColor");i.Disabled=l&&"false"===l.toLowerCase(),i.AxisLineColor=u?ue(u):null,i.AxisTitleForeColor=d?ue(d):null,i.Disabled=l&&"false"===l.toLowerCase();var p=a.getAttribute("IsReversed");i.IsReversed=p&&"true"===p.toLowerCase(),t.push(i)}return t}function oe(e){var t=new Array,n=function(e,n){var r,a,i={};if(e){var o=e;i.Title=o.getAttribute("Title"),se(i,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);var s=o.getAttribute("Enabled");i.Disabled=s&&"false"===s.toLowerCase();var c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;var d=o.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(i.FormatString=d[0].getAttribute("Format"));var p=null===(r=null==d?void 0:d[0])||void 0===r?void 0:r.getAttribute("ForeColor");i.LabelForeColor=p?ue(p):null;var g=null===(a=null==d?void 0:d[0])||void 0===a?void 0:a.getAttribute("Enabled");i.LabelDisabled=g&&"false"===g.toLowerCase();var h=o.getAttribute("LineColor");i.AxisLineColor=h?ue(h):null;var m=o.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?ue(m):null,t.splice(n,0,i)}else t.splice(n,0,i)},r=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return r&&n(r[0],0),(r=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"))&&n(r[0],1),t}function se(e,t,n){if(e){if(t){var r=t.getAttribute("LineColor"),a=t.getAttribute("Enabled");e.AxisMajorGridColor=r?ue(r):null,e.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(n){var i=n.getAttribute("LineColor"),o=n.getAttribute("Enabled");e.AxisMajorTickMarkColor=i?ue(i):null,e.AxisMajorTickMarkEnabled=o&&"true"===o.toLowerCase()}return e}}function ce(e){var t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),n={};return n.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),n}function le(e){var t=e.querySelector("Chart ChartAreas ChartArea"),n={};return n.BackColor=t?t.getAttribute("BackColor"):"",n.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",n.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",n}function ue(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){var t=[];e.split(",").forEach((function(e){return t.push(e.trim())}));var n=t.shift(),r=parseFloat(n)/255,a=t.slice();return a.push(r.toString()),String.format("rgba({0})",a.join(","))}return e}var de=n("BuSU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function pe(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ge=function(){function e(e,t,n,r,a,i,o,s){this._getState=e,this._chartData=a,this._viewRecord=t,this._visualizationRecord=n,this._chartDataDescription=r,this._chartPresentationXML=i,this._drilldownChartType=o,this._entityLogicalName=s}return e.prototype.buildChartModel=function(){if(this._chartQueryModel=Object(de.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof k))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel},e.prototype._buildDataEmptyMessage=function(){var e=Object(h.b)(this._getState(),m.m),t=pe();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new K.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)},e.prototype._buildErrorMessage=function(e){this._chartQueryModel.Title=pe(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new K.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)},e.prototype._buildChartHeading=function(){var e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=pe(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()},e.prototype._buildChartPresentation=function(){var e,t=this;this._chartPresentationParser=$(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach((function(e){e.ChartType=t._drilldownChartType})),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList},e.prototype._buildChart=function(){this._chartParserType=this._getChartParserType();var e=function(e){var t=null;switch(e){case 2:t=new U;break;case 3:t=new H;break;case 1:default:t=new Y}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()},e.prototype._getChartParserType=function(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1},e}(),he=n("8ADW"),me=n("y5DA"),fe=n("kKaT"),be=n("TbLg"),ve=n("z8lM"),ye=n("Fpc+"),_e=n("ZZrQ"),Ce=n("AhDg");function Se(e,t,n){return{type:"chartData.retrieve.core.async",execute:function(r,i,s){var c=r.dispatch,l=r.getState,u=[];try{var d=l();if(!Object(o.b)(l,c,i,u,e,t,n,!0))return Promise.resolve();var p=new _e.a(e.fetchXml);p.set_NoLock(!0),p.set_PageSize(e.dataDefinition.entityExpression.top);var g=function(e){var t={};if(null!=e){var n=new _e.a(e);n.set_PageSize(0),n.set_NoLock(!0),t[""]=n}return t}(e.viewXml);return function(e,t,n,r){var i=new Ce.a(a.a.toString(a.a.newGuid()),r&&r.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,n,i).nativePromise()}(i.DataSource,p,g,s).then((function(r){var i=function(t,n,r){var a=new xe(e.viewTitle,e.viewEntityLogicalName),i=new xe(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(ve.a)(t);Object(o.e)(s,c,n());var l=e;return new ge(n,a,i,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,r).buildChartModel()}(r,l,t);Object(M.c)(d,D.rd)?(c(Pe(e.getStorageKey(),i)),Ie(d,c,e.getStorageKey(),n)):(c(je(a.a.toString(e.visualizationId),a.a.toString(e.viewId),i)),Oe(d,c,a.a.toString(e.visualizationId),a.a.toString(e.viewId),n))})).catch((function(t){Object(me.c)(d,c,t,e,n)}))}catch(e){return i.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),he.b,u),Promise.reject(e)}}}}function Oe(e,t,n,i,o){if(e){var s=new a.a(n),c=a.a.toString(s),l=new a.a(i),u=a.a.toString(l),d={},p={};if(p[u]=function(e,t,n,a){if(!e)return null;if(a&&""!==a){var i=Object(be.c)(e,t,n),o=i&&i.slice();return Object(r.a)(o,a)}return null}(e,c,u,o),p[u]){d[c]=p;var g={entities:null,lists:null,charts:d};t(Object(fe.b)(g))}}}function Ie(e,t,n,a){if(e){var i={};if(i[n]=function(e,t,n){if(!e)return null;if(n){var a=Object(be.b)(e,t),i=a&&a.slice();return Object(r.a)(i,n)}return null}(e,n,a),i[n]){var o={entities:null,lists:null,charts:null,chartData:i};t(Object(fe.b)(o))}}}function je(e,t,n){var r,o,s=new a.a(e),c=a.a.toString(s),l=new a.a(t),u=a.a.toString(l),d={charts:(r={},r[c]=(o={},o[u]={initialized:i.a.Initialized,chartConfigObject:n},o),r)};return{type:ye.d,payload:d}}function Pe(e,t){var n,r={chartData:(n={},n[e]={initialized:i.a.Initialized,chartConfigObject:t},n)};return{type:ye.d,payload:r}}var xe=function(){function e(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}return e.prototype.get_DisplayName=function(){return this._displayName},e.prototype.get_AssociatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e}()},"A/RO":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r,a=n("9r0m"),i=n("/eCp");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(r||(r={}));var o=n("nbQV"),s=n("lKeh"),c=n("QAhb"),l=n("VnpK"),u=n("S2mk"),d=n("F2uj"),p=n("T576"),g=n("HSdq"),h=n("Sscr"),m=n("lMVv"),f=n("WS0f"),b=n("qC0c"),v=n("U0B9"),y=n("sOTk"),_=n("MSdU"),C=n("r0s4"),S=function(){function e(e,t,n){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=n}return e.prototype.generate=function(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null},e.prototype._getBusinessProcessFlowWrapper=function(e,t){var n=this._getState(),r=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!r||!t||!t.getProcessId())return null;var i=t.getCurrentFormEntity(),c=Object(y.g)(n,e);this._navigationEntities=t.getNavigationEntities();var l=Object(p.f)(n,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(n,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(r.data.activePath,r.activeStageId,r.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:r.activeStageId,selectedStageId:r.data.selectedStageId,activePath:r.data.activePath,displayState:r.displayState,currentEntity:new _.a(i.etn,a.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(g.Lb)(n,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:r.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}},e.prototype._getStages=function(e,t,n,r,i){var o=this;if(!e||0===e.length)return null;var s={},c=[];return e.forEach((function(e,l){s[e.guid]=l;var u=a.a.equals(e,n),d=o._getStageWrapper(e,u,t,s,r,i);d&&c.push(d)})),c},e.prototype._getStageWrapper=function(e,t,n,r,i,o){var c=this,l=Object(s.c)(this._getState(),o.getProcessId(),e);if(!l)return null;var u=t&&this._getSteps(l,i,o)||[];if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var d="BusinessProcessFlow.CustomControlConfiguration",p=this._context.TraceManager.getTracer(d),g=Object(s.a)(this._getState(),o.getProcessId(),p);if(!Object(f.a)(g)&&!Object(f.a)(g.ControlConfigurations)){var h=o.getTelemetryParams();if(h.push({name:"BPFEntityFormId",value:g.Id.guid},{name:"BPFEntityFormType",value:g.FormType}),Object(f.a)(g.ControlConfigurations)||h.push({name:"CustomControls",value:Object.keys(g.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),g,p))try{if(!Object(f.a)(g.ControlConfigurations)){var v=Object(s.b)(g,p),y=g.ControlConfigurations,_=this._getNonDefaultControlConfiguration(y);if(Object(b.c)(this._getState(),"FCB.EnableBPFCCPhase3")){var C=this._buildStepsFromFormXml(l,g,_,h,i,o);C&&C.length>0&&(u=C,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(d,h))}else Object(f.a)(v)||Object.keys(v).forEach((function(e){if(v[e].ParentCellId){var t=new a.a(v[e].ParentCellId);if((l&&l.stage&&l.stage.steps?l.stage.steps.map((function(e){return e.stepId.guid})).indexOf(t.guid):-1)>=0&&t){var n=[];n.push({name:"StepId",value:t.guid},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),p.info("Non-default control found for step",n);var r=null;_&&v[e].UniqueId&&(o.setFormXmlRenderingIndicator(!0),r=_[v[e].UniqueId]?_[v[e].UniqueId]:null);var i={attributeName:v[e].DataFieldName,isRequired:c._getIsStepRequired(t.guid,l),name:v[e].Label,stepId:new a.a(t.guid),stepType:"field",attributeType:c._getMetadataTypeByAttribute(l.entityLogicalName,v[e].DataFieldName),controlName:"header_process_"+v[e].Label,isVisible:v[e].Visible,isControlDisabled:v[e].Disabled,nonDefaultConfiguration:r};u.push(i),Object(f.a)(i.stepId.guid)||i.stepId.guid===a.a.EMPTY.guid||h.push({name:"StepId",value:i.stepId.guid}),h.push({name:"AttributeName",value:i.attributeName},{name:"AttributeType",value:i.attributeType},{name:"IsRequired",value:i.isRequired},{name:"NonDefaultControlUniqueId",value:v[e].UniqueId}),Object(f.a)(r)?c._context.EventManager.ReportComponentFailure(d,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,h):(o.setCustomControlIndicator(!0),h.push({name:"CustomControlId",value:r.CustomControlId}),!Object(f.a)(r.Name)&&r.Name.indexOf("MscrmControls")>=0&&h.push({name:"CustomControlName",value:r.Name}),c._context.EventManager.ReportComponentSuccess(d,h))}}}))}}catch(e){p.error("Message: "+e.message+", Stack: "+e.stack,h),this._context.EventManager.ReportComponentFailure(d,e,null,h)}else this._context.EventManager.ReportComponentFailure(d,new Error("Invalid FormXML - Fallback invoked"),null,h)}}return{id:l.stage.stageId,name:l.stage.stageDisplayName,entityName:l.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),l.entityLogicalName)||l.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(l.entityLogicalName),referencingAttributeName:l.referencingAttributeName,status:this._getStageStatus(r[e.guid],r[n.guid],o),steps:u}},e.prototype._buildStepsFromFormXml=function(e,t,n,r,i,o){var s=this,c=[],l=t.Controls;return!Object(f.a)(l)&&this._areStepsValid(e,t,r)&&Object.keys(l).forEach((function(u){if(!Object(f.a)(l[u])&&l[u].ParentCellId){var d=new a.a(l[u].ParentCellId),p=t.Tabs.find((function(e){return e.Id===l[u].ParentTabId}));if(p&&!Object(f.a)(p.RawTabId)&&e.stage.stageId.guid===new a.a(p.RawTabId).guid){var h=null;n&&l[u].UniqueId!==a.a.EMPTY.guid&&(h=n[l[u].UniqueId]?n[l[u].UniqueId]:null);var m=s._retrieveControlName(l[u],e.stage.steps),b=s._getUIControl(i,m),v={attributeName:l[u].DataFieldName,isRequired:l[u].IsRequired,name:s._retrieveStepLabel(l[u],b,e.stage.steps),stepId:new a.a(d.guid),stepType:s._getStepTypeFromControlKey(u),attributeType:s._getMetadataTypeByAttribute(e.entityLogicalName,l[u].DataFieldName),controlName:m,isVisible:b&&!Object(f.a)(b.visible)?b.visible:l[u].Visible,isControlDisabled:l[u].Disabled||Object(g.t)(s._getState(),{id:i,controlName:m},o.getContextToken()),viewId:b&&b.parameters&&b.parameters.defaultviewid?b.parameters.defaultviewid:null,nonDefaultConfiguration:Object(f.a)(h)?null:h};v.config=s._getConfig(t,o,l[u],i,r),v.viewId&&v.config&&v.config.Parameters&&v.config.Parameters.value&&(v.config.Parameters.value.ViewId=v.viewId,b&&b.customFilter&&b.customFilter.length>0&&(s._applyLookupFilter(v,b),v.config.Parameters.value.ExtraFilters=v.extraFilters)),c.push(v),r.push({name:"StepId",value:v.stepId.guid},{name:"AttributeName",value:v.attributeName},{name:"AttributeType",value:v.attributeType},{name:"IsRequired",value:v.isRequired},{name:"NonDefaultControlUniqueId",value:l[u].UniqueId}),Object(f.a)(h)||l[u].UniqueId===a.a.EMPTY.guid||(o.setCustomControlIndicator(!0),r.push({name:"CustomControlId",value:h.CustomControlId}),!Object(f.a)(h.Name)&&h.Name.indexOf("MscrmControls")>=0&&r.push({name:"CustomControlName",value:h.Name}))}}})),c},e.prototype._areStepsValid=function(e,t,n){if(!(Object(f.a)(t)||Object(f.a)(e)||Object(f.a)(e.stage)||Object(f.a)(e.stage.stageId))){var r=t.Controls,i=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(f.a)(r)){if(Object.keys(r).forEach((function(e){if(!Object(f.a)(r[e].ParentCellId)){var n=new a.a(r[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find((function(t){return t.Id===r[e].ParentTabId}));if(!Object(f.a)(o)&&!Object(f.a)(o.RawTabId)){var c=new a.a(o.RawTabId).guid.toLowerCase();i===c&&s.indexOf(n)<0&&s.push(n)}}})),o.length!==s.length)return n.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(var c=0;c<o.length;c++)if(s.indexOf(o[c].stepId.guid.toLowerCase())<0)return n.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[c].stepId.guid.toLowerCase()}),!1;return!0}}return!1},e.prototype._retrieveStepLabel=function(e,t,n){if(!Object(f.a)(t)&&!Object(f.a)(t.label)&&""!==t.label)return t.label;if(!Object(f.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(f.a)(n)&&n.length>0)for(var r=0,i=n;r<i.length;r++){var o=i[r];if(o.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.a)(o.label)&&""!==o.label)return o.label}return""},e.prototype._retrieveControlName=function(e,t){if(!Object(f.a)(t)&&t.length>0)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.stepId.guid===new a.a(e.ParentCellId).guid&&!Object(f.b)(i.controlName))return i.controlName}return Object(f.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName},e.prototype._getConfig=function(e,t,n,r,a){try{var i=Object(g.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();a.push({name:"ControlDescriptorName",value:n&&n.Name});var c=i(this._getState(),n,r,o,s&&s.name,!1);return a.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){a.push({name:"CCFControlConfigError",value:e})}return null},e.prototype._getStageStatus=function(e,t,n){return null==t||e<t?r.Completed:e===t?n.getStatus()===i.a.Finished?r.Completed:r.Active:r.Inactive},e.prototype._getSteps=function(e,t,n){var r=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(var a=0,i=e.stage.steps;a<i.length;a++){var o=i[a],c=this._getUIControl(t,o.controlName),l=null;if(o.name&&o.stepType&&"field"===o.stepType.toLowerCase()){if(!(l=this._getMetadataTypeByAttribute(e.entityLogicalName,o.name)))continue;if(Object(b.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){var u=this._context.TraceManager.getTracer("BpfCustomControlSupport"),d=Object(s.a)(this._getState(),n.getProcessId(),u);if(!Object(f.a)(d)&&!Object(f.a)(d.ControlConfigurations)&&n.isBpfFormDescriptorValid(this._getState(),n.getProcessId(),d,u)){var p=Object(s.b)(d,u),h=this._getNonDefaultControlStepIds(p);if(!Object(f.a)(h)&&h.map((function(e){return e.guid})).indexOf(o.stepId.guid)>=0)continue}}}var m=this._getState(),v={attributeName:o.name,controlName:o.controlName,isRequired:o.required,isVisible:!c||c.visible,name:c?c.label:o.label,stepId:o.stepId,stepType:o.stepType,attributeType:l,viewId:c&&c.parameters&&c.parameters.defaultviewid?c.parameters.defaultviewid:o.viewId,isControlDisabled:Object(g.t)(m,{id:t,controlName:o.controlName},n.getContextToken())};v.viewId&&c&&c.customFilter&&c.customFilter&&c.customFilter.length>0&&this._applyLookupFilter(v,c),r.push(v)}return r},e.prototype._applyLookupFilter=function(e,t){var n;n=!1;var r=[];if(e&&t){for(var a=0;a<t.customFilter.length;a++){if("END_FLAG"===t.customFilter[a].customFilter){n=!0;break}if("START_FLAG"!==t.customFilter[a].customFilter){var i=Object(l.i)(Object(C.CrmHtmlDecode)(t.customFilter[a].customFilter));i&&(i.conditions&&i.conditions.length>0||i.filters&&i.filters.length>0)&&r.push(JSON.stringify(i))}}n?(this._memorizedExtraFilters=r,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}},e.prototype._getMetadataTypeByAttribute=function(e,t){var n=this._getState(),r=Object(d.a)(n,e,t);if(!r)return null;var a=r.Type+"."+r.Format;return Object(u.n)(a)},e.prototype._getActions=function(e){return{completeProcess:function(){return e.completeProcess()},moveNext:function(){return e.moveToNextStage()},movePrevious:function(){return e.moveToPreviousStage()},setActiveStage:function(t){return e.setActiveStage(t.guid)},setSelectedStage:function(t,n){void 0===n&&(n=!1),e.setSelectedStage(t?t.guid:null,n)},triggerActionStepClick:function(t){e.triggerActionStepClick(t)},triggerFlowStepClick:function(t,n){e.triggerFlowStepClick(t,n)},refreshFlowStepClick:function(t){e.refreshFlowStepClick(t)},setDisplayState:function(t){e.setDisplayState(t)},getForwardNavigationEntities:function(t,n,r,a){return e.getForwardNavigationEntities(t,n,r,a)},navigateToNextEntity:function(t,n,r,a){return e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(n),r,a)},executePreEvent:function(t,n,r,a){return e.executePreEvent(t,n,r,a)},validateRequiredFieldsForNavigation:function(){return e.ValidateRequiredFieldsForNavigation()},waitForOngoingWork:function(){return e.waitForOngoingWork()},getActiveStageActiveFor:function(){return e.getActiveStageActiveFor()},getBpfInstanceActiveFor:function(){return e.getBpfInstanceActiveFor()},getBpfInstanceCompletedIn:function(){return e.getBpfInstanceCompletedIn()},getBpfNavigationBehavior:function(){return e.getBpfNavigationBehavior()},setBpfNavigationBehavior:function(t){e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:function(t){return e.getBpfNavigationBehaviorAllowCreateNew(t)},getActiveStage:function(){var t=e.getContextToken(),n=e.getScriptContainer().getEventManager().getClientApiForm(t);return n?n.data.process.getActiveStage():null}}},e.prototype._getRelatedEntityReference=function(e){if(!this._navigationEntities)return null;var t=this._navigationEntities.find((function(t){return t.entityLogicalName===e}));return t?new _.a(t.entityLogicalName,a.a.toLegacyGuid(a.a.parse(t.id))):null},e.prototype._getUIControl=function(e,t){if(t){var n=this._getState(),r=Object(h.j)(n,e),a={controlName:t,id:e};return Object(g.Mc)(this._getState(),a,r)}return null},e.prototype._getNonDefaultControlConfiguration=function(e){var t={};if(e)for(var n=Object.keys(e),r=0;r<n.length;r++){var a,i=Object(v.b)(this._getState());(a=e[n[r]].CustomControls[i])&&(t[n[r]]={FormFactor:a.FormFactor,CustomControlId:a.CustomControlId,Name:a.Name,Version:a.Version,Parameters:a.Parameters,ShouldOverrideControlVisible:a.ShouldOverrideControlVisible,DisplayNameKey:a.DisplayNameKey})}return t},e.prototype._getNonDefaultControlStepIds=function(e){var t=[];return e&&Object.keys(e).forEach((function(n){e[n].ParentCellId&&t.push(new a.a(e[n].ParentCellId))})),t},e.prototype._getIsStepRequired=function(e,t){var n=t.stage.steps,r=n?n.map((function(e){return e.stepId.guid})).indexOf(e):-1;return r>=0&&!Object(f.a)(n[r].required)&&n[r].required},e.prototype._getStepTypeFromControlKey=function(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"},e}()},A8fJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="tab.contentType";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.v)(n);return{type:a,payload:i,meta:{pageId:e,tabId:t,contextKey:o}}}},ABRM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.format";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},AVer:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n("G7N+"),a=n("Sscr"),i=n("c56u"),o=n("kJGL"),s=n("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n,i,o,c,u,d){var p,g=Object(a.v)(o),h=function(e,t){var n;if(!e)return null;var r=new DOMParser,a=e?r.parseFromString(e,"text/xml"):null;if(!a)return null;var i=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!i)return null;for(var o=i,s=[],c=0;c<o.length;c++)if(o[c].getAttribute){for(var u=o[c]?o[c].children?o[c].children:o[c].childNodes:void 0,d=[],p=null,g=0;g<u.length;g++){var h=u[g];if(h.getAttribute){var m=h.getAttribute("name"),f=void 0;f=(n=l(m,p,r,t)).relatedEntityName,p=n.fetchXmlDocument,d.push({name:m,width:parseInt(h.getAttribute("width"),10),relatedEntityName:f,disableMetaDataBinding:"1"===h.getAttribute("disableMetaDataBinding"),labelId:h.getAttribute("labelId"),isHidden:"1"===h.getAttribute("isHidden"),disableSorting:"1"===h.getAttribute("disableSorting"),addedBy:h.getAttribute("addedBy"),desc:h.getAttribute("desc"),cellType:h.getAttribute("cellType"),imageProviderWebresource:h.getAttribute("imageProviderWebresource"),imageProviderFunctionName:h.getAttribute("imageProviderFunctionName")})}}var b={name:o[c].getAttribute("name"),id:o[c].getAttribute("id"),cells:d,multiObjectIdField:o[c].getAttribute("multiObjectIdField"),layoutStyle:o[c].getAttribute("multiObjectIdField")};s.push(b)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:s,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),m={initialized:r.a.Initialized,viewId:n,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:h,isCustomView:!0};return{type:s.a,payload:{views:(p={},p[n.guid]=m,p)},meta:{pageId:e,controlName:t,contextKey:g}}}function l(e,t,n,r){var a="";if(e.indexOf(".")>0){var i=e.split(".")[0];t||(t=n.parseFromString(r,"text/xml"));var o=t.querySelector('link-entity[alias="'+i+'"]');o&&(a=o.getAttribute("name")||"")}return{relatedEntityName:a,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:function(t,n){return(Object(i.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then((function(t){return e.offlineSqlQuery=t}))}}}},AqHJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="offline.set.reinitializeoffline";function a(e){return{type:r,payload:{reInitializeOffline:e}}}},BWVO:function(e,t,n){"use strict";n.d(t,"a",(function(){return Me})),n.d(t,"b",(function(){return De}));var r,a,i,o,s,c,l,u,d,p=n("1z64"),g=n("9r0m"),h=n("9rlF"),m=n("QAhb"),f=n("ezfI"),b=n("F2uj"),v=n("iutC"),y=n("yHpA"),_=n("FuJ2"),C=n("o0+l"),S=n("HSdq"),O=n("5jMY"),I=n("Zy0S"),j=n("ObKm"),P=n("w/nD"),x=n("+Z9T"),E=n("IiPO"),T=n("Sscr"),w=n("lMVv"),A=n("zsi3"),F=n("xirW"),N=n("hCnb"),k=n("2p2B"),M=n("uQP8"),D=n("r0s4"),R=n("Srej"),L="ClientApi.XrmEntityAttribute.",B=function(){function e(e,t,n,a,i,o){r=e,this._clientApiExecutorAttribute=new p.a(e,L,n,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:a,isEventParam:!0});var s=this._clientApiExecutorAttribute.getComponentName("constructor");a||Object(x.j)(s,"attributeName"),e||Object(x.j)(s,"store"),n||Object(x.j)(s,"pageId"),t||Object(x.j)(s,"contextToken"),o||Object(x.j)(s,"xrmFormUi"),this._attributeName=a,this._parentEntity=i,this._pageId=n,this.xrmFormUi=o,this._contextToken=t}return Object.defineProperty(e.prototype,"controls",{get:function(){var e=this;return this._clientApiExecutorAttribute.execute("controls",(function(t,n){if(!e._controls){e._controls=new I.a(t);var a=Object(S.z)(r.getState(),e._pageId,e.contextToken,e._attributeName);if(a){e.xrmFormUi.getControls();for(var i=e.xrmFormUi.controls,o=0;o<a.length;o++){var s=a[o],c=i.get(s);c&&e._controls.add(s,c)}}}return e._controls}))},enumerable:!1,configurable:!0}),e.prototype.addOnChange=function(e){var t=L+"addOnChange";e||Object(x.j)(t,"handler");try{f.a.instance.reportCall(t),r.dispatch(Object(P.a)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.fireOnChange=function(){var e=L+"fireOnChange";try{f.a.instance.reportCall(e),r.dispatch(Object(P.P)(this.contextToken,this._pageId,this.getName())),f.a.instance.reportSuccess(e)}catch(n){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,n,null,t),n}},e.prototype.getAttributeType=function(){var e=L+"getAttributeType";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().Type;return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getFormat=function(){var e=this;return this._clientApiExecutorAttribute.execute("getFormat",(function(){var t=e.getAttrDescriptor();if(!t||!t.Format)return null;var n=t.Format.toLowerCase(),r=n;switch(e.getAttrDescriptor().Type){case"string":"text"===r||"email"===r||"phone"===r||"url"===r||"tickersymbol"===r||"1"!==n&&"2"!==n||(r="textarea");break;case"integer":"duration"!==r&&(r="none");break;case"lookup":"0"===n&&(r="none");break;case"memo":"2"!==n&&"1"!==n||(r="textarea");break;default:"0"===n?r="none":void 0===r&&(r=null)}return r}))},e.prototype.getIsDirty=function(){var e=L+"getIsDirty";try{f.a.instance.reportCall(e);var t=Object(S.Jb)(r.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(y.e)(r.getState(),Object(S.ac)(r.getState(),this.getPageId(),this.dataContextToken),this.getName());return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getName=function(){return f.a.instance.reportUsage(L+"getName"),this._attributeName},e.prototype.getParent=function(){return f.a.instance.reportUsage(L+"getParent"),this._parentEntity},e.prototype.getRequiredLevel=function(){var e=L+"getRequiredLevel";try{f.a.instance.reportCall(e);var t=Object(S.pc)(r.getState(),this._pageId,this.dataContextToken,this.getName()),n=void 0;switch(t){case 2:case 1:n="required";break;case-1:case 0:n="none";break;case 3:n="recommended";break;default:Object(x.h)(e,"RequiredLevel",t)}return f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getSubmitMode=function(){var e=L+"getSubmitMode";try{f.a.instance.reportCall(e);var t=Object(S.zc)(r.getState(),this._pageId,this.contextToken,this.getName()),n=void 0;switch(t){case O.a.Dirty:n="dirty";break;case O.a.Always:n="always";break;case O.a.Never:n="never";break;default:Object(x.h)(e,"SubmitMode",t)}return f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getUserPrivilege=function(){var e=L+"getUserPrivilege";try{f.a.instance.reportCall(e);var t=null;if(r.getState()&&this._parentEntity&&this._attributeName){var n=Object(v.a)(r.getState(),this._parentEntity.getEntityName(),g.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);n&&(t={canCreate:n.canCreate,canRead:n.canRead,canUpdate:n.canUpdate})}return f.a.instance.reportSuccess(e),t}catch(t){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.getValue=function(){var e=L+"getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=null;return Object(x.a)(t)||(Object(h.j)(t)?n=t.value:Object(x.k)(e,"isPlainValue","value")),f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.removeOnChange=function(e){var t=L+"removeOnChange";e||Object(x.j)(t,"handler");try{f.a.instance.reportCall(t),r.dispatch(Object(P.v)(this.contextToken,this._pageId,this.getName(),e)),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setRequiredLevel=function(e){var t=L+"setRequiredLevel";e||Object(x.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(x.h)(t,"RequiredLevel",e);try{f.a.instance.reportCall(t);var n=void 0;switch(e){case"none":n=0;break;case"recommended":n=3;break;case"required":n=2}r.dispatch(Object(_.b)(this._pageId,this.dataContextToken,this._attributeName,n)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setSubmitMode=function(e){var t=L+"setSubmitMode";e||Object(x.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(x.h)(t,"SubmitMode",e);try{f.a.instance.reportCall(t);var n=void 0;switch(e){case"dirty":n=O.a.Dirty;break;case"always":n=O.a.Always;break;case"never":n=O.a.Never}r.dispatch(Object(C.b)(this._pageId,this.contextToken,this.getName(),n)),f.a.instance.reportSuccess(t)}catch(e){var a=E.a.getInstance().getEventParameters(this._contextToken);throw a.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,a),e}},e.prototype.setValue=function(e){var t=L+"setValue";try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setIsValid=function(e,t){var n=this;return this._clientApiExecutorAttribute.execute("setIsValid",(function(a,i){e?(r.dispatch(Object(N.b)(n._pageId,n._attributeName,!0,n.contextToken)),r.dispatch(Object(k.b)(n.contextToken,n._pageId,Object(R.d)(n._pageId,n._attributeName))),r.dispatch(Object(F.b)(r.getState(),n._pageId,n._attributeName,null,n.contextToken))):n._addNotification(t)}))},e.prototype._addNotification=function(e){r.dispatch(Object(N.b)(this._pageId,this._attributeName,!1,this.contextToken));var t={messages:[e],notificationLevel:A.a.error};r.dispatch(Object(F.b)(r.getState(),this._pageId,this._attributeName,t,this.contextToken))},e.prototype.isValid=function(){var e=L+"isValid";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=this.getParent();if(n){var a=Object(w.h)(r.getState(),n.getEntityName());if(a&&a.PrimaryIdAttribute!==this.getName()&&n.getId()!==g.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(x.a)(t))return f.a.instance.reportSuccess(e),!1}var i=!0;return this.hasErrorNotification()?i=!1:t&&t.validationResult&&(i=t.validationResult.isValueValid),f.a.instance.reportSuccess(e),i}catch(t){var o=E.a.getInstance().getEventParameters(this._contextToken);throw o.push({name:"attributeName",value:this._attributeName}),E.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.hasErrorNotification=function(){var e=Object(T.v)(this.contextToken),t=r.getState(),n=Object(M.a)(t,this._pageId);return!(!n.forms||!n.forms[e]||!n.forms[e].invalidControls&&!n.forms[e].invalidAttributes)&&(!0===n.forms[e].invalidControls[this.getName()]||!0===n.forms[e].invalidAttributes[this.getName()])},e.prototype.getPageId=function(){return this._pageId},e.prototype.getAttrDescriptor=function(){if(this.getParent()){var e=Object(S.r)(r.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(b.a)(r.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(S.Nc)(r.getState(),this.getPageId(),this.getName())},e.prototype.getDataXmlInternal=function(){var e="";return e=e+"<"+Object(D.CrmXmlEncode)(this.getName())+">"+Object(D.CrmXmlEncode)(this.getValue())+"</"+Object(D.CrmXmlEncode)(this.getName())+">"},e.prototype.setValueInternal=function(e){var t=this.getName(),n={};n[t]={fieldName:t,value:e},r.dispatch(Object(j.a)(this._pageId,n,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(T.t)(this._contextToken),this.contextToken))},Object.defineProperty(e.prototype,"parentEntityReference",{get:function(){var e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new m.a(e,new g.a(t)):new m.a(e)},enumerable:!1,configurable:!0}),e.prototype.getValueInternal=function(){var e=Object(S.ac)(r.getState(),this.getPageId(),this.dataContextToken);return Object(S.X)(r.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,r.dispatch)},Object.defineProperty(e.prototype,"contextToken",{get:function(){return Object(T.r)(this._contextToken)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataContextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}(),V=n("c/eZ"),G=n("TCcM"),W=n("TV33"),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getOption=function(e){var t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(x.a)(e))return null;var n="number"==typeof e?e:parseInt(e,10);isNaN(n)&&Object(x.k)(t,"number","value");try{f.a.instance.reportCall(t);for(var r=this.getAttrDescriptor().OptionSet,a=null,i=0;i<r.length;i++)r[i].Value===e&&(a={text:r[i].Label,value:r[i].Value});return f.a.instance.reportSuccess(t),a}catch(e){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e),e}},t.prototype.getOptions=function(){var e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().OptionSet.map((function(e){return{text:e.Label,value:e.Value}}));return f.a.instance.reportSuccess(e),t}catch(t){throw E.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t),t}},t}(B),X=function(e){function t(t,n,r,i,o,s){var c=e.call(this,t,n,r,i,o,s)||this;return a=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(a.getState(),this.parentEntityReference,this.getName()),n=t?parseInt(t.valueString,10):null;return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeBoolean.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(W.a)(t);return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(x.a)(e)||"boolean"!=typeof e&&Object(x.k)(t,"boolean","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"},t}(z),q=function(e){function t(t,n,r,a,o,s){var c=e.call(this,t,n,r,a,o,s)||this;return i=t,c}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(i.getState(),this.parentEntityReference,this.getName()),n=Object(W.e)(t);return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getSelectedOption=function(){var e=this,t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{f.a.instance.reportCall(t);var n=null,r=this.getValue();return r&&(n=[],r.forEach((function(t){var r=e.getOption(t);r&&n.push(r)}))),f.a.instance.reportSuccess(t),n}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{f.a.instance.reportCall(e);var t=null,n=this.getSelectedOption();return n&&(t=[],n.forEach((function(e){t.push(e.text)}))),f.a.instance.reportSuccess(e),t}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=null;return t&&(n=Object(W.e)(t)),f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{f.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},t}(z),U=n("otJc"),H=n("dl9j"),Y=n("+h4s"),K=n("sRkF"),Q=function(e){function t(t,n,r,a,i,s){var c=e.call(this,t,n,r,a,i,s)||this;return o=t,c}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));var t=Object(D.CrmXmlEncode)(this.getName()),n="";return n+="<"+t+">",n+=""+(null===e?"":Object(D.CrmXmlEncode)(e.format("s"))),n+="</"+t+">"},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=null;if(Object(h.j)(t)&&!Object(x.a)(t.formatted)){var r=this.getAttrDescriptor();n=Object(W.b)(o.getState(),r,t)}return f.a.instance.reportSuccess(e),n}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._userSettings=function(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new H.a(o)},t.prototype.getUtcValue=function(){var e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{f.a.instance.reportCall(e);var t=this.getValue();return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(x.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(x.k)(t,"Date","value");try{if(f.a.instance.reportCall(t),Object(x.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){var n=new Date,r=this.getAttrDescriptor(),a=Object(U.z)(o.getState(),r),i=6e4*this._userSettings().getTimeZoneOffsetMinutes(),s=Object(Y.o)(new Date(n.getFullYear(),n.getMonth(),n.getDate()),a.userSettings.timeZoneAdjusters)-Object(Y.o)(e,a.userSettings.timeZoneAdjusters),c=6e4*e.getTimezoneOffset(),l=null;switch(a.controlAttributes.Behavior){case K.a.UserLocal:l=new Date(e.getTime()+c+i-s);break;default:l=new Date(e.getTime())}this.setValueInternal(l)}f.a.instance.reportSuccess(t)}catch(e){var u=E.a.getInstance().getEventParameters(this.contextToken);throw u.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,u),e}},t.prototype.setUtcValue=function(e){var t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{f.a.instance.reportCall(t),this.setValue(e),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"},t}(B),Z=function(e){function t(t,n,r,a,i,o){var c=e.call(this,t,n,r,a,i,o)||this;return s=t,c}return Object(V.__extends)(t,e),t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1},t.prototype.getDataXmlInternal=function(){var e=this.getValue(),t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{var n=Object(D.CrmXmlEncode)(this.getName());t+="<"+n+">",t+="</"+n+">"}return t.toString()},t.prototype.getLookupDataXml=function(e,t){var n=Object(D.CrmXmlEncode)(e),r="<"+n,a=this.getEntityTypeCode(t.entityType);return a>0&&(r+=' type="'+Object(D.CrmXmlAttributeEncode)(a.toString())+'"'),t.entityType&&(r+=' typeName="'+Object(D.CrmXmlAttributeEncode)(t.entityType)+'"'),Object(x.a)(t.name)||(r+=' name="'+Object(D.CrmXmlAttributeEncode)(t.name)+'"'),r+=">"+Object(D.CrmXmlEncode)(t.id)+"</"+n+">"},t.prototype.getEntityTypeCode=function(e){return Object(w.p)(s.getState(),e)},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeLookup.setValue",n=null;if(e&&Array.isArray(e)&&e.length>0){e.length>1?Object(x.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?g.a.tryParseOrNull(e[0].id)||Object(x.h)(t,"guid",e[0].id):Object(x.j)(t,"value[0].id"):Object(x.j)(t,"value[0].entityType");var r=void 0;try{r=Object(S.Ob)(s.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getLookupTargets",e,null,a),e}if(r)if(!(r.indexOf(e[0].entityType)>-1))(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"actualValue",value:e[0].entityType}),Object(x.k)(t,"entityType","value[0].entityType",a);try{f.a.instance.reportCall(t),r?r.indexOf(e[0].entityType)>-1&&(n=new m.a(e[0].entityType,new g.a(e[0].id),e[0].name),this.setValueInternal(n)):this.setValueInternal(n),f.a.instance.reportSuccess(t)}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}}else this.setValueInternal(n)},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeLookup.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(W.d)(t);return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"},t}(B),J=n("/wtJ"),$=n("kvLG"),ee=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return c=t,s._clientApiExecutorAttributeNumber=new p.a(t,"ClientApi.XrmEntityAttributeNumber.",r,n,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getMax=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMax",(function(){return e.getAttrDescriptor().MaxValue}))},t.prototype.getMin=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getMin",(function(){return e.getAttrDescriptor().MinValue}))},t.prototype.getPrecision=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getPrecision",(function(){return Object(S.k)(c.getState(),e.getPageId(),e.dataContextToken,e.getName())}))},t.prototype.setPrecision=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setPrecision",(function(n,r){"integer"===t.getAttributeType()&&Object(x.e)(n,"setPrecision is not valid on integer attributes",void 0,r);var a=Object(b.a)(c.getState(),t.getParent().getEntityName(),t.getName());(e<0||e>a.Precision)&&(r.push({name:"metadataPrecision",value:a.Precision}),Object(x.h)(n,"precision",e.toString(),r)),c.dispatch(Object(J.b)(t.getPageId(),t.dataContextToken,t.getName(),e))}),[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeNumber.execute("getValue",(function(){var t=e.getValueInternal();return Object(W.f)(t,e.getAttributeType(),e.getPrecision())}))},t.prototype.setValue=function(e){var t=this;return this._clientApiExecutorAttributeNumber.execute("setValue",(function(){t.setValueInternal(e)}),[{name:"value",value:e,expectedDataType:"number"}])},t.prototype.getAttributeType=function(){var t=this;return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(function(n,r){var a=t.getAttrDescriptor().Type;switch(a){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return r.push({name:"attributeType",value:a}),a?t._clientApiExecutorAttributeNumber.reportFailure(n,new Error("Unexpected number attribute type."),r):$.a.getInstance().traceManager.getTracer(n).error("Number attribute type was not defined in metadata.",r),e.prototype.getAttributeType.call(t)}}))},t}(B),te=n("sOTk"),ne=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return l=t,s}return Object(V.__extends)(t,e),t.prototype.getInitialValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{f.a.instance.reportCall(e);var t=Object(G.j)(l.getState(),this.parentEntityReference,this.getName()),n=Object(te.m)(l.getState(),this.getPageId()),r=void 0;if(n){var a=this.getAttrDescriptor();r=Object(W.g)(t)||a&&a.DefaultFormValue?a.DefaultFormValue:null}else r=Object(W.g)(t);return f.a.instance.reportSuccess(e),r}catch(t){var i=E.a.getInstance().getEventParameters(this.contextToken);throw i.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},t.prototype.getSelectedOption=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{f.a.instance.reportCall(e);var t=this.getOption(this.getValue());return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getText=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getText";try{f.a.instance.reportCall(e);var t=this.getSelectedOption(),n=null;return t&&(n=t.text),f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(W.g)(t),r=Object(x.a)(n)?Object(W.f)(t,this.getAttributeType(),0):n;return f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(x.k)(t,"number","value");var n=!1;try{if(e&&this.getParent()){var r=this.getAttrDescriptor();for(var a in r.OptionSet)if(e===r.OptionSet[a].Value){n=!0;break}}else n=!0}catch(e){throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,i),e}n||Object(x.h)(t,"OptionSetValue",e);try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var i;throw(i=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,i),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"},t}(z),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getMaxLength=function(){var e="ClientApi.XrmEntityAttributeString.getMaxLength";try{f.a.instance.reportCall(e);var t=this.getAttrDescriptor().MaxLength;return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeString.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(W.i)(t);return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeString.setValue";Object(x.a)(e)||"string"!=typeof e&&Object(x.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getAttributeType=function(){var t="ClientApi.XrmEntityAttributeString.getAttributeType";try{f.a.instance.reportCall(t);var n=void 0,r=this.getAttrDescriptor().Type;switch(r){case"memo":n="memo";break;case"string":n="string";break;default:(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),a.push({name:"attributeType",value:r}),E.a.getInstance().reportFailure(t,new Error("Unexpected string attribute type."),null,a),n=e.prototype.getAttributeType.call(this)}return f.a.instance.reportSuccess(t),n}catch(e){var a;throw(a=E.a.getInstance().getEventParameters(this.contextToken)).push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,a),e}},t}(B),ae=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._clientApiExecutor=new p.a(t,"ClientApi.XrmEntityAttributeUniqueIdentifier.",r,n),s._clientApiExecutor.addEventParameter({name:"attributeName",value:a,isEventParam:!0}),s}return Object(V.__extends)(t,e),t.prototype.setValue=function(e){var t=this;this._clientApiExecutor.execute("setValue",(function(){t.setValueInternal(g.a.tryParseOrNull(e))}),[{name:"value",value:e,expectedDataType:"guid"}])},t.prototype.getValue=function(){var e=this;return this._clientApiExecutor.execute("getValue",(function(){var t=e.getValueInternal();return Object(W.j)(t)}))},t.prototype.getAttributeType=function(){return this._clientApiExecutor.execute("getAttributeType",(function(){return"string"}))},t}(B),ie=n("nVTU"),oe=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return u=t,s}return Object(V.__extends)(t,e),t.prototype.getDataXmlInternal=function(){var e=this,t=Object(D.CrmXmlEncode)(this.getName()),n=this.getValue(),r="";return r+="<"+t+">",n.forEach((function(t){r+="<activityparty>",r+=e.getLookupDataXml("partyid",t),r+="</activityparty>"})),(r+="</"+t+">").toString()},t.prototype.setValue=function(e){var t,n="ClientApi.XrmEntityAttributePartyList.setValue",r=E.a.getInstance().getEventParameters(this.contextToken);r.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(x.k)(n,"LookupValue[]","value",r));var a=new Array;try{t=Object(S.Ob)(u.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw E.a.getInstance().reportFailure(n+".getLookupTargets",e,null,r),e}e&&t&&(t.push("unresolvedaddress"),e.forEach((function(e){t.indexOf(e.entityType)>-1||(r.push({name:"entityType",value:e.entityType}),Object(x.e)(n,'LookupValue[] with invalid entity type. Entity type "'+e.entityType+'" is invalid.',"LookupValue[] with invalid entity type",r))})));try{f.a.instance.reportCall(n),e?(t?e.forEach((function(e){t.indexOf(e.entityType)>-1&&a.push(new ie.a(e.entityType,e.id,e.name))})):e.forEach((function(e){a.push(new ie.a(e.entityType,e.id,e.name))})),this.setValueInternal(a)):this.setValueInternal([]),f.a.instance.reportSuccess(n)}catch(e){throw E.a.getInstance().reportFailure(n,e,null,r),e}},t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributePartyList.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(W.h)(t);return f.a.instance.reportSuccess(e),n}catch(t){var r=E.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},t.prototype.getIsPartyList=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0},t}(Z),se=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._clientApiExecutorAttributeFile=new p.a(t,"ClientApi.XrmEntityFile.",r,n,[{name:"attributeName",value:a,isEventParam:!0}]),s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e=this;return this._clientApiExecutorAttributeFile.execute("getValue",(function(){var t=e.getValueInternal();return Object(W.c)(t)}))},t.prototype.setValue=function(e){var t=this;this._clientApiExecutorAttributeFile.execute("setValue",(function(){t.setValueInternal(e)}))},t}(B),ce=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return d=t,s}return Object(V.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmEntityAttributeEntityName.getValue";try{f.a.instance.reportCall(e);var t=this.getValueInternal(),n=Object(b.a)(d.getState(),this.getParent().getEntityName(),this.getName()),r=null;return n.IsEntityReferenceStored&&Object(h.j)(t)&&(r=t.value),f.a.instance.reportSuccess(e),r}catch(t){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.setValue=function(e){var t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(x.a)(e)||"string"==typeof e||Object(x.k)(t,"string","value");try{f.a.instance.reportCall(t),this.setValueInternal(e),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getAttributeType=function(){return f.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"},t}(B),le=n("r529"),ue=n("Xia5"),de=n("jJRu"),pe=n("Cfob"),ge=n("cAHA"),he=n("8aRo"),me=n("+P1Q"),fe=n("qYad"),be=n("9qYn"),ve=n("yZTI"),ye=n("Z1aD"),_e=n("xc1f"),Ce=n("Gemh");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Se(e,t,n,r){var a=Object(S.z)(e,t,n,r,n.relationshipName);if(!a||0===a.length)return!0;for(var i=0;i<a.length;i++)if(!Object(S.t)(e,{controlName:a[i],id:t},n))return!0;return!1}function Oe(e,t,n,r,a,i){if(!Object(Ce.K)(e,t,n,r,null==i?void 0:i.id))return!1;var o=Object(Ce.y)(e,n,t);if(!a||!o)return!1;if(o&&0===o[r])return!1;if(null===a.ParentPicklistLogicalName)return!0;var s=Object(S.ac)(e,t,n),c=Object(S.X)(e,t,n,s,i,a.ParentPicklistLogicalName);return!(!c||!c.label)}var Ie,je,Pe,xe=n("UOiB"),Ee=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return Ie=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var n,r="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";try{f.a.instance.reportCall(r),n=this.contextToken.contextTokenType===xe.a.MainGrid||this.contextToken.contextTokenType===xe.a.SubGrid||this.contextToken.contextTokenType===xe.a.AssociatedGrid?Oe(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(r)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(r,e,null,a),e}n?e.prototype.setValue.call(this,t):Object(x.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")},t}(ne),Te=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return je=t,s}return Object(V.__extends)(t,e),t.prototype.setValue=function(t){var n,r="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";try{f.a.instance.reportCall(r),n=this.contextToken.contextTokenType===xe.a.MainGrid||this.contextToken.contextTokenType===xe.a.SubGrid||this.contextToken.contextTokenType===xe.a.AssociatedGrid?Oe(je.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):Se(je.getState(),this.getPageId(),this.contextToken,this.getName()),f.a.instance.reportSuccess(r)}catch(e){var a=E.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"attributeName",value:this.getName()}),E.a.getInstance().reportFailure(r,e,null,a),e}n?e.prototype.setValue.call(this,t):Object(x.e)(r,"Can not execute setValue for dependent option set attribute since it is disabled.")},t}(q),we=n("cZkS"),Ae=n("qC0c"),Fe=n("3ZuC"),Ne=n("WVwd"),ke=n("RK8T"),Me=function(){function e(e,t,n,r,a,i,o,s){Pe=e;var c=[{name:"pageId",value:n,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:a,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:r,isRequired:!0}];this._clientApiExecutor=new p.a(e,"ClientApi.XrmEntity.",n,t,c),this._pageId=n,this._xrmForm=r,this._contextToken=t,this._entityType=a,this._entityId=i,this._getAttributeNames=o,this._applicationContext=s}return Object.defineProperty(e.prototype,"attributes",{get:function(){var e=this;return this._clientApiExecutor.execute("attributes",(function(t,n){if(!e._attributes){e._attributes=new I.a(t);var r=e._getAttributeNames(e._applicationContext,e._contextToken,e._pageId);if(!r)return e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was null or undefined"),n),e._attributes;0===r.length&&e._clientApiExecutor.reportFailure(t,new Error("Entity attribute names array was empty."),n),r.forEach((function(t){var n=Object(b.a)(Pe.getState(),e.getEntityName(),t);if(n){var r=De(Pe,e._contextToken,e._pageId,t,e,e._xrmForm.ui,n);e._attributes.add(t,r)}}))}return e._attributes}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relatedEntities",{get:function(){var t=this,n="ClientApi.XrmEntity.relatedEntities";try{if(f.a.instance.reportCall(n),!this._relatedEntities){this._relatedEntities=new I.a(n);var r=Object(S.oc)(Pe.getState(),{id:this._pageId},this._contextToken);for(var a in r)if(r[a]){var i=Object(T.m)(this._contextToken,a),o=new e(Pe,i,this._pageId,this._xrmForm,r[a].etn,r[a].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(a,o),this._updateControl(o,a)}var s=Object(S.nc)(Pe.getState(),{id:this._pageId}),c={};for(var a in s){var l=s[a];c[l.referencingAttribute]||(c[l.referencingAttribute]={}),c[l.referencingAttribute][l.referencedEntity]=a}var u=function(n){Pe.dispatch(Object(P.a)(d._contextToken,d._pageId,n,(function(r){for(var a in c[n]){var i=t._relatedEntities.get(c[n][a]);i&&t._relatedEntities.remove(i)}var o=r.getEventSource().getValue();if(o&&o.length>0){var s=o[0],l=c[n][s.entityType],u=Object(T.m)(t._contextToken,l),d=new e(Pe,u,t._pageId,t._xrmForm,s.entityType,g.a.tryParse(s.id),t._getAttributeNames,t._applicationContext);t._relatedEntities.add(l,d),t._updateControl(d,l)}}),!0))},d=this;for(var p in c)u(p)}return f.a.instance.reportSuccess(n),this._relatedEntities}catch(e){var h=E.a.getInstance().getEventParameters(this._contextToken);throw h.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(n,e,null,h),e}},enumerable:!1,configurable:!0}),e.prototype._updateControl=function(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach((function(n){n instanceof me.a&&n.updateAttribute(e,t)}))},e.prototype.addOnSave=function(e){var t="ClientApi.XrmEntity.addOnSave";e||Object(x.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.o)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getDataXml=function(){var e="ClientApi.XrmEntity.getDataXml";try{f.a.instance.reportCall(e);var t="";return this.attributes.forEach((function(e){e.getIsDirty()&&(t+=e.getDataXmlInternal())})),t="<"+Object(D.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(D.CrmXmlEncode)(this.getEntityName())+">",f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getEntityReference=function(){var e="ClientApi.XrmEntity.getEntityReference";try{f.a.instance.reportCall(e);var t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return f.a.instance.reportSuccess(e),t}catch(t){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getEntityName=function(){var e="ClientApi.XrmEntity.getEntityName";try{return f.a.instance.reportCall(e),f.a.instance.reportSuccess(e),this._entityType}catch(n){var t=E.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,n,null,t),n}},e.prototype.getId=function(){var e="ClientApi.XrmEntity.getId";try{if(f.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===g.a.EMPTYGUIDSTRING){var t=Object(te.i)(Pe.getState(),this._pageId);if(t&&t.value){var n=t.value;this._entityId=n.id}else{var r=Object(S.ac)(Pe.getState(),this._pageId,this._contextToken);if(r){var a=Object(y.b)(Pe.getState(),r);a&&a.identifier&&(this._entityId=a.identifier.id)}}}return this._entityId&&this._entityId.guid===g.a.EMPTYGUIDSTRING?(f.a.instance.reportSuccess(e),g.a.EMPTYSTRING):(f.a.instance.reportSuccess(e),g.a.externalGuid(this._entityId))}catch(t){var i=E.a.getInstance().getEventParameters(this._contextToken);throw i.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,i),t}},e.prototype.getPrimaryAttributeValue=function(){var e=this;return this._clientApiExecutor.execute("getPrimaryAttributeValue",(function(t,n){var r="",a=Object(w.h)(Pe.getState(),e.getEntityName());if(a){if(!a.PrimaryNameAttribute)return r="PrimaryNameAttribute was not defined",$.a.getInstance().traceManager.getTracer(t).error(r,n),"";var i=Object(S.ac)(Pe.getState(),e._pageId,e._contextToken),o=e.getId()?new m.a(e.getEntityName(),new g.a(e.getId())):new m.a(e.getEntityName()),s=Object(S.X)(Pe.getState(),e._pageId,e._contextToken,i,o,a.PrimaryNameAttribute);if(!s)return"";if(Object(h.j)(s))return s.value;r="PrimaryAttribute value was not an IPlainValue"}else r="Entity descriptor could not be retrieved.";return E.a.getInstance().reportFailure(t,new Error(r),null,n),""}))},e.prototype.getIsDirty=function(){var e="ClientApi.XrmEntity.getIsDirty";try{f.a.instance.reportCall(e);for(var t=0;t<this.attributes.getLength();t++){var n=this.attributes.get(t);if("never"!==n.getSubmitMode()&&n.getIsDirty())return f.a.instance.reportSuccess(e),!0}for(t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return f.a.instance.reportSuccess(e),!0}return f.a.instance.reportSuccess(e),!1}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.removeOnSave=function(e){var t="ClientApi.XrmEntity.removeOnSave";e||Object(x.j)(t,"handler");try{f.a.instance.reportCall(t),Pe.dispatch(Object(P.J)(this._contextToken,this._pageId,e)),f.a.instance.reportSuccess(t)}catch(e){var n=E.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.save=function(e){var t=this;this._clientApiExecutor.executeAsync("save",(function(n,r){var a=1;if(e)if("string"==typeof e)switch(e){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else e.saveMode&&(a=e.saveMode);var i=Pe.getState();return Object(Ne.b)(t._pageId,Pe,a,r,t._contextToken,t,!1,"saveandclose"!==e).then((function(n){return t._performAfterSaveLogic(i,n,e)}))}))},e.prototype.isValid=function(){var e="ClientApi.XrmEntity.isValid";try{if(f.a.instance.reportCall(e),this.attributes)for(var t=0;t<this.attributes.getLength();t++){var n=this.attributes.get(t);if(this._attributeHasActiveControl(n)&&!n.isValid()||n.hasErrorNotification())return f.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return f.a.instance.reportSuccess(e),!1;return f.a.instance.reportSuccess(e),!0}catch(t){var r=E.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.setRecordId=function(e){var t=this,n="ClientApi.XrmEntity.setRecordId";e||Object(x.j)(n,"id");try{if(f.a.instance.reportCall(n),this.getId()&&this._entityId.guid!==g.a.EMPTYGUIDSTRING)f.a.instance.reportSuccess(n);else{var r=g.a.tryParse(e);g.a.isNullOrEmpty(r)&&Object(x.j)(n,"id");var a=Pe.getState(),i=Object(S.ac)(a,this._pageId,this._contextToken),o=Object(T.x)(this._contextToken);if(i){var s=new m.a(this.getEntityName(),r);Pe.dispatch(Object(ue.b)(i,s)),f.a.instance.reportSuccess(n)}else{var c=Object(de.b)(a,new m.a(this.getEntityName(),r),{},o,ge.a.Create),l=c.payload.snapshotId;Pe.dispatch(c),Pe.dispatch(Object(pe.b)(this._pageId,l,this._contextToken)).then((function(){f.a.instance.reportSuccess(n)})).catch((function(e){var r=E.a.getInstance().getEventParameters(t._contextToken);r.push({name:"entityName",value:t.getEntityName()}),E.a.getInstance().reportFailure(n+".setDataSnapshotId",e,null,r)}))}}}catch(e){var u=E.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityName",value:this.getEntityName()}),E.a.getInstance().reportFailure(n,e,null,u),e}},e.prototype.refresh=function(){var e=this,t="ClientApi.XrmEntity.refresh";try{if(f.a.instance.reportCall(t),this.getId()){for(var n=new m.a(this.getEntityName(),new g.a(this.getId())),r=[],a=[],i=0;i<this.attributes.getLength();i++)a.push(this.attributes.get(i).getName());var o=Object(he.a)(Pe.getState(),n.etn);if(o&&a.push.apply(a,o),r.push(Pe.dispatch(Object(fe.a)(this._pageId,n,a,new ke.a(m.a.toLegacyEntityReference(n),null,null)))),this.relatedEntities)for(i=0;i<this.relatedEntities.getLength();i++)r.push(this.relatedEntities.get(i).refresh());return Promise.all(r).then((function(){Object(be.b)(e),f.a.instance.reportSuccess(t)})).catch((function(n){var r=E.a.getInstance().getEventParameters(e._contextToken);return r.push({name:"entityName",value:e.getEntityName()}),Object(x.d)(Pe,n,t,r)}))}return f.a.instance.reportSuccess(t),Promise.resolve(null)}catch(e){var s=E.a.getInstance().getEventParameters(this._contextToken);return s.push({name:"entityName",value:this.getEntityName()}),Object(x.d)(Pe,e,t,s)}},e.prototype._attributeHasActiveControl=function(e){if(e&&e.controls)for(var t=e.controls.getLength(),n=0;n<t;n++)if(!e.controls.get(n).getDisabled())return!0;return!1},e.prototype._performAfterSaveLogic=function(e,t,n){var r=Object(S.kb)(Pe.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||r)if(Object(be.b)(this),"saveandclose"===n){if(!Object(be.a)(Object(ve.b)(Pe.getState())===this._pageId)){var a=Object(S.Kb)(e,this._pageId),i=Object(S.Ib)(e,this._pageId);if(!a&&!i){var o=Object(Fe.a)(Pe.getState(),this._pageId);return Pe.dispatch(Object(le.b)(o))}}}else if("saveandnew"===n){var s={entityTypeName:this.getEntityName()};return Pe.dispatch(Object(ye.a)(_e.a,s,this._pageId))}return Promise.resolve()},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function De(e,t,n,r,a,i,o){var s=null;switch(o.Type){case"datetime":s=new Q(e,t,n,r,a,i);break;case"decimal":case"double":case"integer":case"money":s=new ee(e,t,n,r,a,i);break;case"lookup":case"owner":case"customer":s=new Z(e,t,n,r,a,i);break;case"partylist":s=new oe(e,t,n,r,a,i);break;case"memo":case"string":s=new re(e,t,n,r,a,i);break;case"picklist":if(Object(Ae.c)(e.getState(),we.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,r)){s=new Ee(e,t,n,r,a,i);break}case"optionset":case"state":case"status":s=new ne(e,t,n,r,a,i);break;case"boolean":s=new X(e,t,n,r,a,i);break;case"entityname":s=new ce(e,t,n,r,a,i);break;case"uniqueidentifier":s=new ae(e,t,n,r,a,i);break;case"multiselectpicklist":s=Object(Ae.c)(e.getState(),we.L)&&Object(b.l)(e.getState(),o.EntityLogicalName,r)?new Te(e,t,n,r,a,i):new q(e,t,n,r,a,i);break;case"file":s=new se(e,t,n,r,a,i);break;default:s=new B(e,t,n,r,a,i)}return s}},BuSU:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}n.d(t,"a",(function(){return r}))},CILi:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n("c/eZ"),a=n("t8U/"),i=n("lU69"),o=n("qIF7"),s=n("Ww2r"),c=n("CCCZ"),l=n("VWqI"),u=n("lMVv"),d=n("w2s3"),p=n("DgF7"),g=n("NxDw"),h=n("JlqV"),m=n("Ev4I"),f=n("EGsq");function b(){var e=[],t=Object(s.h)();return function(n){var b,v,y,_,C=t(n,c.b),S=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=Object(a.a)(e);if(!t)return null;var n=Object(h.b)(e),i={};for(var o in t.quickCreateMenuItems)if(Object(l.g)(e,o,1,0)){var s=Object(u.h)(e,o);if("email"===o&&s&&s.IsReadOnlyInMobileClient&&Object(p.a)(e)===g.a.MobileApplication)continue;if(!n&&!Object(m.l)(e,s.EntityLogicalName))continue;i[o]=Object(r.__assign)(Object(r.__assign)({},t.quickCreateMenuItems[o]),{icon:s&&s.IconVectorName?"$webresource:"+Object(f.t)(e)+s.IconVectorName:s.EntityIcon})}return{initialized:Object(a.b)(e),quickCreateMenuItems:i}}(n);if(!S||!C[c.a])return null;for(var O=S.quickCreateMenuItems,I=[],j=[],P={},x=0,E=Object.keys(O);x<E.length;x++){P[(A=O[E[x]]).entityDisplayName]=A}for(var T=0,w=Object.keys(P).sort();T<w.length;T++){var A,F={Icon:(A=P[w[T]]).icon?A.icon:" ",DisplayText:A.entityDisplayName,Id:Object(i.a)(),DataId:d.i+"_"+A.entityLogicalName,execute:Object(o.b)(A.entityLogicalName,void 0,null,null),Tooltip:{title:A.entityDisplayName,description:""!==A.formDescription?A.formDescription:null}};A.isActivity?I.push(F):j.push(F)}if(I.length>0){var N=Object(s.c)(C,c.a);j.unshift({DisplayText:N,Id:Object(i.a)(),DataId:d.i+"_"+N,Children:I,WillOpenFlyout:!0,IsInFlyout:!0})}if(0===j.length)return null;if(e.length!==j.length)e=j;else for(var k=0;k<e.length;k++)(null===(b=e[k])||void 0===b?void 0:b.Children)&&(null===(v=j[k])||void 0===v?void 0:v.Children)&&(null===(y=e[k])||void 0===y?void 0:y.Children.length)!==(null===(_=j[k])||void 0===_?void 0:_.Children.length)&&(e=j);return e}}},Cgjg:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Sscr"),a=n("uO/V"),i="grid.setCustomFilter";function o(e,t,n,o,s){return{type:"grid.setCustomFilter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,l.TraceManager.getTracer(a.z)),p=a.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),u(function(e,t,n,a,o){var s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}var c=Object(r.y)(a),l=Object(r.v)(a);return{type:i,payload:s,meta:{pageId:n,contextKey:c,dataSetContextKey:l}}}(e,t,n,o,s)),l.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){l.EventManager.ReportComponentFailure(p,Error("Adding a custom filter for the grid failed"))}}}}},Cmbl:function(e,t,n){"use strict";n.d(t,"y",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"N",(function(){return s})),n.d(t,"E",(function(){return c})),n.d(t,"G",(function(){return l})),n.d(t,"F",(function(){return u})),n.d(t,"L",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"M",(function(){return g})),n.d(t,"O",(function(){return h})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"I",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"H",(function(){return _})),n.d(t,"z",(function(){return C})),n.d(t,"r",(function(){return S})),n.d(t,"q",(function(){return O})),n.d(t,"B",(function(){return I})),n.d(t,"C",(function(){return j})),n.d(t,"D",(function(){return P})),n.d(t,"A",(function(){return x})),n.d(t,"J",(function(){return E})),n.d(t,"o",(function(){return T})),n.d(t,"n",(function(){return w})),n.d(t,"p",(function(){return A})),n.d(t,"i",(function(){return F})),n.d(t,"f",(function(){return N})),n.d(t,"k",(function(){return k})),n.d(t,"h",(function(){return M})),n.d(t,"j",(function(){return D})),n.d(t,"g",(function(){return R})),n.d(t,"t",(function(){return L})),n.d(t,"s",(function(){return B})),n.d(t,"u",(function(){return V})),n.d(t,"w",(function(){return G})),n.d(t,"x",(function(){return W})),n.d(t,"v",(function(){return z})),n.d(t,"K",(function(){return X}));var r=n("bick"),a="Offline_Status_Dialog_Title",i="Button_Label_Close",o="Button_Label_Download_Offline_Metadata",s="Status_Label",c="Learn_More_Label",l="Learn_More_Link_Label",u="Learn_More_Link_Accessibility_Label",d="progress_cancelButton_Label",p="Download_Progress_Spinner_Label",g="MoCA_OWA_Client_Download_Metadata_Message",h="ToggleOption_title",m="Accessibility_Switch_On",f="Accessibility_Switch_Off",b="Available_Entities_Label",v="Not_Available_Entities_Label",y="Available_Entities_Aria_Label",_="Not_Available_Entities_Aria_Label",C="CustomControl_OfflineEntities_InitialDataDownLoadErrorMessage",S="CustomControl_OfflineEntities_EstimatedTimeLeftLabel",O="Entity_Header_Label",I="Last_Sync_Date_Label",j="Last_Sync_Date_Today_Label",P="Last_Sync_Date_Yesterday_Label",x="Last_Sync_Date_At_Label",E="OutlookClient_Progress",T="D365_UCI_OfflineStatus_Suspended_Label_Text",w="D365_UCI_OfflineStatus_Pending_Label_Text",A="D365_UCI_OfflineStatus_Waiting_Label_Text",F="D365_UCI_OfflineStatus_Insufficient_Storage_Label_Text",N="D365_UCI_OfflineStatus_Storage_Issue_Error_Text",k="D365_UCI_OfflineStatus_Service_Error_Label_Text",M="D365_UCI_OfflineStatus_Something_Went_Wrong_Error_Text",D="D365_UCI_OfflineStatus_Network_Connectivity_Label_Text",R="D365_UCI_OfflineStatus_Network_Issue_Error_Text",L="D365_UCI_OfflineStatus_Files_Downloading_Count_Label_Text",B="D365_UCI_OfflineStatus_Availabe_Files_Label_Text",V="D365_UCI_OfflineStatus_Completed_Label_Text",G="D365_UCI_OfflineStatus_Error_Label_Text",W="D365_UCI_OfflineStatus_Update_Offline_Data_Button_Text",z="D365_UCI_OfflineStatus_Downloading_Label_Text",X=[a,i,s,c,l,h,m,f,r.f,r.d,d,p,g,o,b,v,y,_,C,S,O,I,j,P,x,E,"SystemCustomization.type.file.label",T,w,A,F,N,k,M,D,R,L,B,"D365_UCI_OfflineStatus_Progress_Label_Text","D365_UCI_OfflineStatus_Status_Label_Text",V,G,W,"D365_UCI_OfflineStatus_Offline_Data_Ready_To_Use_Syncing_Now_Text","D365_UCI_OfflineStatus_Offline_File_Ready_To_Use_Text",z];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},DJr2:function(e,t,n){"use strict";n.r(t),n.d(t,"openOfflineStatusDialogAction",(function(){return C}));var r=n("c/eZ"),a=n("qC0c"),i=n("Cmbl"),o=n("mGpW"),s=n("7pqb"),c=n("/8AH"),l=n("Z1aD");var u=n("Ev4I"),d=n("+6eZ"),p=n("Ww2r"),g=n("JlqV"),h=n("hSyu"),m=n("/eNh"),f=n("cZkS"),b=n("c56u"),v=n("ouFk"),y=n("Ghzy"),_=n("k78Z");function C(e){var t=this;return void 0===e&&(e=!1),{type:"Offline Status Dialog",execute:function(n,s){var c=n.dispatch,l=n.getState;return Object(r.__awaiter)(t,void 0,void 0,(function(){var t;return Object(r.__generator)(this,(function(n){switch(n.label){case 0:return t=Object(r.__spreadArrays)(["L_Offline_Available","L_Offline_Not_Available","L_Initializing","L_OfflineProfile_Not_Available","L_Offline_DB_Not_Available","L_Sync_Failure","L_Upgrade_Client","L_Metadata_Changed_Text","L_Metadata_Changed"],i.K),[4,c(Object(o.e)(t))];case 1:return n.sent(),e||Object(a.c)(l(),f.je)||Object(_.h)(l())?[2,S(c,l,s)]:[2,O(c,l,s)]}}))}))}}}function S(e,t,n){var r=t(),a=[{name:s.b.OfflineStatusPageParameters.OfflineStatus,value:Object(b.t)(r)}];return e(function(e,t,n){var r=[{name:"dialogName",value:e},{name:"dialogHeight",value:t.height},{name:"dialogWidth",value:t.width},{name:"dialogPosition",value:t.position},{name:"dialogWindowPosition",value:t.windowPosition}];return{type:"form.offlineStatusForm",execute:function(e,r,a){var i=e.dispatch,o=(e.getState,{dialogOptions:t});return i(Object(l.a)(c.a,o,n))},getFailureParameters:function(e,t){return r}}}("OfflineStatus",{shouldSupportRTL:!0})).then((function(){n.EventManager.ReportComponentSuccess("Offline.OpenOfflineStatusDialog",a)}))}function O(e,t,n){n.TraceManager.getTracer("Offline").warn("Open OfflineStatusDialog");for(var r=t(),a=Object(b.t)(r),i=Object(b.s)(r),o=Object(u.g)(r),c=Object(u.i)(r)||[],l={},f={},_=0,C=o?Object.keys(o):[];_<C.length;_++){var S=C[_],O=o[S];-1===c.indexOf(S)?l[S]=O:f[S]=O}var I={};I.offline_status=a?a.toString():"",I.offlinestatus_reason=i,I.offline_enabled_json_string=Object(d.b)({OfflineEntities:[l]}),I.offline_disabled_json_string=Object(d.b)({OfflineEntities:[f]}),I.offline_enable_string=Object(p.b)(r,"L_Offline_Available"),I.offline_disable_string=Object(p.b)(r,"L_Offline_Not_Available"),I.offlinemetadata_sync=Object(g.b)(r)&&v.a.SyncPendingFromServer===Object(h.c)(r)?"true":"false";var j=[{name:s.b.OfflineStatusPageParameters.CodeCacheState,value:Object(y.a)(r)},{name:s.b.OfflineStatusPageParameters.OfflineStatus,value:I.offline_status},{name:s.b.OfflineStatusPageParameters.OfflineStatusReason,value:I.offlinestatus_reason},{name:s.b.OfflineStatusPageParameters.OfflineEnabledEntities,value:Object(d.b)(l)},{name:s.b.OfflineStatusPageParameters.OfflineDisabledEntities,value:Object(d.b)(f)},{name:s.b.OfflineStatusPageParameters.OfflineMetadataDownloadRequired,value:I.offlinemetadata_sync}];return e(Object(m.b)("OfflineStatus",{windowPosition:"side"},I)).then((function(){n.EventManager.ReportComponentSuccess("Offline.OpenOfflineStatusDialog",j)}))}},"Dlr/":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r,a=n("c/eZ"),i=n("1z64"),o=n("Gemh"),s=n("9r0m"),c=n("YCDx"),l=n("w/nD"),u=n("Sscr"),d=n("/W63"),p=n("IiPO"),g=n("ar+e"),h=n("QUnS"),m=n("Ka9P"),f=n("7bez"),b=n("h82J"),v=n("ezfI"),y=n("kvLG"),_="ClientApi.XrmControlSubGrid.",C=function(e){function t(t,n,a,o,s,c,l,d){var p=e.call(this,t,n,a,l,o,c)||this;return p._relationship=null,r=t,p._subgridToken=Object(u.p)(n,o),p._clientApiExecutorSubGrid=new i.a(t,_,a,p._subgridToken),p.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),p.clientApiExecutor.addEventParameter({name:"isEditable",value:s,isEventParam:!0}),p._gridControl=new f.a(t,p._subgridToken,a,s,3,!0,d,o),t.dispatch(Object(b.a)(p,a,p._subgridToken)),p}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorSubGrid},enumerable:!1,configurable:!0}),t.prototype.setFilterXml=function(e){var t=_+"setFilterXml";try{v.a.instance.reportCall(t),this._gridControl.setFilterXml(e),v.a.instance.reportSuccess(t)}catch(e){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getFilterXml=function(){var e=_+"getFilterXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFilterXml();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.refresh=function(){var e=_+"refresh";try{v.a.instance.reportCall(e),this._gridControl.refresh(),v.a.instance.reportSuccess(e)}catch(n){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getFetchXml=function(){var e=_+"getFetchXml";try{v.a.instance.reportCall(e);var t=this._gridControl.getFetchXml();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getGrid=function(){var e=_+"getGrid";try{v.a.instance.reportCall(e);var t=this._gridControl.getGrid();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getViewSelector=function(){var e=_+"getViewSelector";try{v.a.instance.reportCall(e);var t=this._gridControl.getViewSelector();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getTeamTemplateId=function(){var e=_+"getTeamTemplateId";try{v.a.instance.reportCall(e);var t=this._gridControl.getTeamTemplateId();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.addOnLoad=function(e){var t=this;this.clientApiExecutor.execute("addOnLoad",(function(){r.dispatch(Object(l.d)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.removeOnLoad=function(e){var t=this;this.clientApiExecutor.execute("removeOnLoad",(function(){r.dispatch(Object(l.y)(t._subgridToken,t.pageId,e,t.name))}),[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])},t.prototype.getEntityName=function(){var e=_+"getEntityName";try{v.a.instance.reportCall(e);var t=this._gridControl.getEntityName();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getControlType=function(){var e=this;return this.clientApiExecutor.execute("getControlType",(function(){var t=Object(h.a)(r.getState(),e.controlDescriptor,e.pageId,e.contextToken);return t?"customsubgrid:"+t.Name:"subgrid"}))},t.prototype.getRelationship=function(){var e=this;return this.clientApiExecutor.execute("getRelationship",(function(t,n){var r,a;if(!e._relationship){if(null===(a=null===(r=e.controlDescriptor)||void 0===r?void 0:r.Parameters)||void 0===a?void 0:a.RelationshipName){var i=e.controlDescriptor.Parameters.RelationshipName,o=e.controlDescriptor.Parameters.RelationshipRoleOrdinal,s=e.controlDescriptor.Parameters.TargetEntityType;e._relationship=Object(f.b)(i,s),e._relationship.roleType=o}e._relationship||(e._relationship=e._gridControl.getRelationship())}return e._relationship}))},t.prototype.getRecordSetQueryKey=function(){var e=this;return this.clientApiExecutor.execute("getRecordSetQueryKey",(function(){return Object(o.cb)(r.getState(),e._subgridToken,{id:e.pageId})}))},t.prototype.getGridType=function(){return v.a.instance.reportUsage(_+"getGridType"),3},t.prototype.getRollupType=function(){var e=this;return this.clientApiExecutor.execute("getRollupType",(function(){return Object(o.eb)(r.getState(),e.pageId,e.contextToken)}))},t.prototype.openRelatedGrid=function(){var e=this;this.clientApiExecutor.executeAsync("openRelatedGrid",(function(t,n){var a=e.getRelationship();if(!a)return y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: the relationship was not retrieved from the inner grid.",n),Promise.resolve(s.a.EMPTY);for(var i=Object(g.c)(r.getState(),e.pageId),o=null,c=0;c<i.length;c++)if(i[c].relationshipName===a.name){o=i[c];break}if(!o)return n.push({name:"relationshipName",value:a.name}),y.a.getInstance().traceManager.getTracer(t).error("Can't open related grid: no relationship was found with the specified name.",n),Promise.resolve(s.a.EMPTY);var l={id:o.id,title:o.title,entityName:e.getEntityName(),relationshipName:a.name,isSelected:!0,show:o.show},p=Object(u.a)(e._subgridToken.parentContextToken,a.name,a.roleType?1===a.roleType?m.a.Referencing:m.a.AssociationEntity:void 0);return r.dispatch(Object(d.a)(e.pageId,p,l))}))},t.prototype.refreshRibbon=function(){var e=_+"refreshRibbon";try{v.a.instance.reportCall(e),this._gridControl.refreshRibbon(),v.a.instance.reportSuccess(e)}catch(n){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getUrl=function(){var e=_+"getUrl";try{v.a.instance.reportCall(e);var t=this._gridControl.getUrl();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getParentForm=function(){var e=_+"getParentForm";try{v.a.instance.reportCall(e);var t=this._gridControl.getParentForm();return v.a.instance.reportSuccess(e),t}catch(t){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),p.a.getInstance().reportFailure(e,t,null,n),t}},t}(c.a)},EZG4:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"e",(function(){return f}));var r=n("O+GR"),a=n("P7C7"),i=n("EitS"),o=r.e,s="Web.NavBar.Navigate_Dynamics365",c="Web.NavBar.Close_Site_Map",l="Web.NavBar.Favorites_And_Recent",u="Web.NavBar.All_Areas",d="Web.NavBar.NavigationTip",p="Available_Offline",g="Web.NavBar.Switch_App_Text",h="Not_Available_Offline",m="Web.NavBar.SiteMap",f=[o,r.c,r.d,a.a,a.b,a.c,a.d,g,s,c,l,u,d,r.a,r.b,p,h,m,i.b,i.a]},FGem:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.options.clear";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.x)(t);return{type:a,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:n}}}},FbjN:function(e,t,n){"use strict";function r(e,t){var n=function(e){return[e.colors.BaseColor.Blue.Blue3,e.colors.BaseColor.Orange.Orange5,e.colors.BaseColor.Teal.Teal5,e.colors.BaseColor.Clay.Clay4,e.colors.BaseColor.Violet.Violet4,e.colors.BaseColor.Blue.Blue4,e.colors.BaseColor.Red.Red5,e.colors.BaseColor.Yellow.Yellow5,e.colors.BaseColor.Pink.Pink5,e.colors.BaseColor.Green.Green5,e.colors.BaseColor.Purple.Purple2,e.colors.BaseColor.Blue.Blue5,e.colors.BaseColor.Clay.Clay5]}(t);return n[e%n.length]}function a(e){var t="";if(e)for(var n=e.split(" "),r=0;r<n.length&&t.length<2;r++)if(n[r].length>0){var a=n[r].charCodeAt(0);if(!(a>=97&&a<=122||a>=65&&a<=90)){t+=n[r].charAt(0);break}t+=n[r].charAt(0)}return t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},FlM9:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("qC0c"),a=n("cZkS"),i=n("sOTk"),o=n("/eNh"),s=n("t8f4"),c=n("QAhb");var l=n("Ww2r"),u=n("JlqV");function d(e,t,n,d,p){var m=Object(r.a)(e.getState(),a.F)&&Object(u.b)(e.getState()),f=Object(i.g)(e.getState(),n);return m&&f&&"connectionrole"===f.entityTypeName&&f.id?{Icon:"ConnectionRoleManageRecordType",DisplayText:Object(l.c)(p,g),Tooltip:{title:Object(l.c)(p,h),description:Object(l.c)(p,h)},Id:"manageRecordTypes",execute:function(){return t=e.dispatch,r=f.id,t(function(e,t){return{type:"open.manage.resource.type.dialog",execute:function(n,r,a){var i=n.dispatch,l=(n.getState,new c.a("connectionrole",e)),u=[{name:"recordId",value:e.guid}];return i(Object(s.d)(l,"?$expand=connection_role_connection_role_object_type_codes")).then((function(n){if(n&&n.connection_role_connection_role_object_type_codes){var a=n.connection_role_connection_role_object_type_codes,s=[],c=n.statecode;a.map((function(e){s.push({LogicalName:e.associatedobjecttypecode,connectionroleobjecttypecodeid:e.connectionroleobjecttypecodeid})}));var l={param_recordId:e,param_selectedEntities:JSON.stringify(s),param_stateCode:c},d={height:480,width:320};return i(Object(o.b)("ConnectionRoleManageRecordTypesDialog",d,l,t)).then((function(e){r.EventManager.ReportComponentSuccess("ConnectionRoleManageRecordTypesDialog",u)}))}}),(function(e){r.EventManager.ReportComponentFailure("ConnectionRoleManageRecordTypesDialog",e,null,u)}))}}}(r,n)).then((function(){return{}}));var t,r}}:null}function p(e,t){var n=Object(r.a)(e,a.F)&&Object(u.b)(e),o=Object(i.g)(e,t);return n&&o&&"connectionrole"===o.entityTypeName?m:[]}var g="ConnectionRole_EntityPickerMDD_Button_Label",h="ConnectionRole_EntityPickerMDD_Button_Description",m=[g,h]},FuJ2:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("sOTk"),a=n("UOiB"),i=n("Sscr"),o=n("krRo"),s=n("HSdq"),c=n("ObKm"),l=n("yHpA"),u=n("9rlF"),d="attribute.requiredLevel";function p(e,t,n,p){return{type:"attribute.requiredLevel.validation",sync:!0,execute:function(g,h){var m,f=g.getState();if(p!==Object(s.pc)(f,e,t,n)){g.dispatch(function(e,t,n,r){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(o.f)(e,t,n,r);var s=Object(i.x)(t);return{type:d,payload:r,meta:{pageId:e,contextKey:s,dataFieldName:n}}}(e,t,n,p));var b=Object(s.ac)(f,e,t),v=Object(l.b)(f,b);if((0===p||3===p)&&v&&v.activeChanges&&v.activeChanges[n]||t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow){var y=null,_=null,C=null,S=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)y=t.entityTypeName?t.entityTypeName:null,_=t.recordId?t.recordId:null,C=Object(i.t)(t),S=Object(i.r)(t);else{var O=Object(r.g)(f,e);y=O&&O.entityTypeName?O.entityTypeName:null,_=O&&O.id?O.id:null,C=null,S=t}var I=Object(l.d)(f,b,{etn:y,id:_},n);if(Object(s.Uc)(I)){var j=((m={})[n]={fieldName:n,value:I?I.formatted?I:Object(u.e)(I):I},m);g.dispatch(Object(c.a)(e,j,!0,!0,y,_?_.guid:null,C,S))}}}}}}},G9wF:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var r,a=n("c/eZ"),i=n("Zy0S"),o=n("ixd0"),s=n("i8/j"),c=n("9r0m"),l=n("1z64"),u=function(){function e(e,t,n,a,i,c,u){void 0===c&&(c=s.n),void 0===u&&(u=o.a),this._formId=n,r=e,this._entityName=a,this._pageId=i,this._getSelectorItems=c,this._selectorItemType=u,this._clientApiExecutor=new l.a(e,"ClientApi.XrmControlFormSelector.",i,t)}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._clientApiExecutor.execute("items_get",(function(t){if(!e._items){e._items=new i.a(t);var n=e._getSelectorItems(r.getState(),e._entityName);if(n)for(var a in n){var o=n[a],s=o.name||o.DisplayName,l=new e._selectorItemType(new c.a(a),s,r,e._pageId);e._items.add(l.getId(),l)}}return e._items}))},enumerable:!1,configurable:!0}),e.prototype.getCurrentItem=function(){var e=this;return this._clientApiExecutor.execute("getCurrentItem",(function(){for(var t=e.items,n=0;n<t.getLength();n++){var r=t.get(n);if(r.getId()===c.a.toString(e._formId))return r}return null}))},e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(u)},GBfE:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeOfflineLifecycleAsyncAction",(function(){return T}));var r=n("nlyT"),a=n("pkDq"),i=n("GUnN"),o=n("c56u"),s=n("9r0m"),c=n("96h0"),l=n("He+0"),u=n("/j9Z"),d=n("gKZ6"),p=n("x9BS"),g=n("kh6f"),h=n("gFjC"),m=n("xC+Q"),f=n("L+41"),b=n("5iz+");var v=n("EGsq"),y=n("hRGi"),_=n("BvBP"),C=n("pdOk"),S=n("H/RR"),O=n("AX1v");function I(){return{type:"offline.save.sessionstate",execute:function(e,t){var n=(0,e.getState)(),r=Object(o.p)(n),a={},c={},l={},u={},d=[];return r!==O.a.Disabled?(c[S.a.OfflineProfileIdKey]=s.a.toString(y.c(n)),c[S.a.OfflineProfileVersionKey]=y.d(n),c[S.a.OfflineProfileAvailableEntitiesKey]=y.b(n),a[S.a.norsyncServerConnectionStringKey]=_.c(n),a[S.a.isTrialOrganizationKey]=_.b(n).toString(),a[S.a.isMocaOfflineFCBEnabledKey]=_.a(n).toString(),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.OfflineProfileDataKey),d.push(t.DataSource.saveSessionState(S.a.OfflineProfileDataKey,c,!1)),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.offlineDatabaseInformationKey),d.push(t.DataSource.saveSessionState(S.a.offlineDatabaseInformationKey,a,!1))):(g.c.info("Offline: OfflineSaveSessionState: Clearing the Session State"),d.push(t.DataSource.deleteSessionState(S.a.OfflineProfileDataKey)),d.push(t.DataSource.deleteSessionState(S.a.offlineDatabaseInformationKey)),d.push(t.DataSource.deleteSessionState(S.a.OfflineEntityPluralNamesKey)),d.push(t.DataSource.deleteSessionState(S.a.OfflinePrimaryAvailableEntitiesKey)),d.push(t.DataSource.deleteSessionState(C.a))),u[S.a.isMobileOfflineOptedInKey]=r.toString(),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.isMobileOfflineOptedInKey),d.push(t.DataSource.saveSessionState(S.a.isMobileOfflineOptedInKey,u,!1)),l[S.a.OfflineDatabaseKey]=Object(o.d)(n),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.OfflineDatabaseKey),d.push(t.DataSource.saveSessionState(S.a.OfflineDatabaseKey,l,!1)),Promise.all(d).then((function(){return g.c.info("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Complete"),Promise.resolve()})).catch((function(e){return g.c.error("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Failed"+Object(i.e)(e)),Promise.reject(e)}))}}}var j=n("WS0f"),P=n("JlqV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function x(e,t,n,a,i){var c=Object(v.m)(t),d=Object(y.e)(t),p=Object(o.p)(t),h=Object(y.c)(t);c&&p!==O.a.Disabled&&(h&&h!==s.a.EMPTY&&d?(p===O.a.Default&&n(Object(l.b)(O.a.Enabled)),n(function(e,t){return{type:"offline.schedule.datasync.async",execute:function(n,a){var i=n.dispatch,s=n.getState,c=a.OfflineProvider,l=Object(o.d)(s());if(Object(j.a)(l)){var d=Object(P.b)(s())?f.a.Initializing:f.a.NotAvailable;g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to "+d),i(Object(r.c)(d,b.a.None))}else g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to Available."),i(Object(r.c)(f.a.Available,b.a.None));return g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: Schedule Periodic Sync Job started."),c.schedulePeriodicSyncJob(e,t).nativePromise().catch(u.b)}}}(a,i)),g.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is : mobileOfflineOptStatus =  "+p)):(n(Object(r.c)(f.a.NotAvailable,b.a.ProfileUnavailable)),g.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is set to "+f.a.NotAvailable)))}function E(e,t,n,a,s){var c;Object(o.c)(t)?(g.c.warn("OfflineWrapper: OfflineInitDataSync: Deleting the existing offline database as isDBCleanNeeded is true "+Object(o.d)(t)),n((c=Object(o.d)(t),{type:"offline.database.delete.async",execute:function(e,t){var n=e.dispatch;return e.getState,t.OfflineProvider.cleanUpDatabases(c).nativePromise().then((function(){n(Object(p.b)("")),n(Object(r.c)(f.a.NotAvailable,b.a.None)),n(Object(d.b)(!1)),n(Object(m.b)(null)),n(Object(h.b)(null,null,null))})).catch((function(e){return g.c.error("Offline.databaseDeleteAction: OfflineProvider.cleanUpDatabases failed with error:"+Object(i.e)(e)),Promise.reject(e)}))}})).then((function(){x(0,t,n,a,s),n(I())}),u.b)):(g.c.warn("OfflineWrapper: OfflineInitDataSync: perform offline data sync "),x(0,t,n,a,s),n(I()))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function T(e,t){return{type:"offline.init.lifecycle.async",execute:function(n,l){var u=n.dispatch,d=n.getState;return l.OfflineProvider.initializeOfflineDataSource(l.DataSource.get_UserContext()).nativePromise().then((function(){var n=d(),i=Object(P.b)(n),p=Object(o.d)(n);if(Object(o.p)(d())===O.a.Disabled||null===p||""===p||s.a.equals(s.a.parse(p),s.a.EMPTY)||u(Object(r.c)(f.a.Available,b.a.None)),null!=p){var g=function(){return!i||u(Object(c.initializeOfflineUpsyncProcessAsyncAction)()).then((function(){return E(0,d(),u,e,t),!0}))};return l.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(g,g)}return i&&(u(Object(a.b)()),E(0,d(),u,e,t)),!0})).catch((function(e){return g.c.error("OFFLINE : initializeOfflineLifecycleAsyncAction Failed"+Object(i.e)(e)),Promise.reject(e)}))}}}},GtH6:function(e,t,n){"use strict";n.r(t),n.d(t,"GreetingLabel",(function(){return o})),n.d(t,"OfflineStatusDialog",(function(){return De})),n.d(t,"DRILLDOWN_STYLE",(function(){return pa})),n.d(t,"NavigationBarStyleContext",(function(){return ga})),n.d(t,"NavigationBarStringContext",(function(){return ha})),n.d(t,"useNavigationBarStringContextValue",(function(){return fa})),n.d(t,"NavigationBar",(function(){return ba})),n.d(t,"StackNavigator",(function(){return Vc})),n.d(t,"ViewSelector",(function(){return zc})),n.d(t,"NavigationBarPageTitle",(function(){return Sr})),n.d(t,"FillNativeNavigationBar",(function(){return Or})),n.d(t,"ProvidePageScrollContext",(function(){return Uc})),n.d(t,"FullScreenModal",(function(){return Yc})),n.d(t,"QuickCreateFormWithNativeHeader",(function(){return il})),n.d(t,"ConfirmDialog",(function(){return pc})),n.d(t,"PageScrollContext",(function(){return Ve})),n.d(t,"ConnectToPageScrollContext",(function(){return ze})),n.d(t,"NativeSubgridCommandbarWrapper",(function(){return cl})),n.d(t,"QuickFindSearchBar",(function(){return gl}));var r=n("nuS9"),a=n("WziN"),i=n("pyUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return r.createElement(a.a,null,r.createElement(i.a,null,"Hello, ",e.title,"!"))}var s=n("c/eZ"),c=n("Cmbl"),l=n("cZkS"),u=n("4E+q"),d=n("GYXq"),p=n("l1Zb"),g=n("EZ4w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(){var e=r.createRef();return r.useEffect((function(){e.current.setNativeProps({tabindex:0})})),e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var m=g.a.create({containerStyle:{flexDirection:"column"},statusStyle:{fontWeight:"600",fontSize:16,color:"#333333"},messageStyle:{fontSize:14,lineHeight:16,color:"#666666",paddingBottom:15},linkStyle:{color:"blue",textDecorationLine:"underline"}}),f=r.memo((function(e){var t=e.statusLabel,n=e.statusText,o=e.statusMessage,s=e.helpLabel,c=e.helpLinkLabel,l=e.helpLinkHandler,u=e.helpLinkAccessibilityLabel,d=h(),p=l&&c&&r.createElement(i.a,{style:m.linkStyle,onPress:l,accessibilityRole:"link",ref:d,accessibilityLabel:u},c);return r.createElement(a.a,{style:m.containerStyle},r.createElement(i.a,{style:m.statusStyle},t,": ",n),r.createElement(i.a,{style:m.messageStyle},o),r.createElement(i.a,{style:m.messageStyle},s," ",p))})),b=n("dEZ0");var v=g.a.create({button:{textAlign:"center",color:"#FFF",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#0078D4",borderRadius:2,fontSize:14,lineHeight:19},buttonContainer:{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row",justifyContent:"center",backgroundColor:"#FFF",bottom:0,left:0,width:"100%",paddingTop:21,borderTopColor:"#D8D8D8",borderStyle:"solid",borderTopWidth:1}}),y=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.isMetadataDownloadRequired,n=e.downloadOfflineMetadataHandler,i=e.downloadOfflineMetadataButtonLabel;return t?r.createElement(a.a,{style:v.buttonContainer},r.createElement(b.a,{title:i,accessibilityLabel:i,accessibilityComponentType:"button",accessibilityTraits:"button",style:v.button,onPress:n})):null})),_=n("kprl"),C=n("pMJD");var S=g.a.create({closeButtonStyle:{height:"2.5rem",width:"2.5rem",borderWidth:0,backgroundColor:"transparent",justifyContent:"center",alignItems:"center",paddingLeft:"0.625rem",paddingRight:"0.625rem"},closeButtonTextStyle:{color:"#333",fontSize:14}}),O=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return r.createElement(_.b,{onPress:e.closeHandler,icon:C.a.CancelFilter,size:S.closeButtonTextStyle.fontSize,color:S.closeButtonTextStyle.color,style:S.closeButtonStyle,accessibilityLabel:e.label})})),I=n("RQTs");var j=g.a.create({button:{textAlign:"center",color:"#666666",paddingTop:6,paddingBottom:7,backgroundColor:"#FFFFFF",borderRadius:2,borderColor:"#444444",borderWidth:1,fontSize:14,lineHeight:19,alignSelf:"stretch"},progressContainer:{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"column",justifyContent:"center",backgroundColor:"#FFF",bottom:0,left:0,width:"100%",paddingTop:21,borderTopColor:"#D8D8D8",borderStyle:"solid",borderTopWidth:1},progressGif:{height:250,width:250},textContainer:{marginBottom:24,marginTop:24,justifyContent:"center",alignItems:"center"}}),P=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.onClickCancelDownloadButton,n=e.labelCancelButton,o=e.labelProgress,s=e.progressSpinnerLabel,c=e.showSpinner;return r.createElement(a.a,{style:j.progressContainer,accessibilityLabel:o},c&&r.createElement(I.a,{size:"small",color:"#A8A8AC",accessibilityComponentType:"none",accessibilityLabel:s}),r.createElement(a.a,{style:j.textContainer},r.createElement(i.a,{style:{color:"inherit"},accessibilityLabel:o},o)),r.createElement(b.a,{title:n,accessibilityLabel:n,accessibilityComponentType:"button",accessibilityTraits:"button",style:j.button,onPress:t}))})),x=n("OyOX"),E=n("dD0b");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function T(e){var t=e.toggleSwitchOn,n=e.isDisabled,a=e.onchange,i=e.accessibilityLabel,o=e.accessibilityOnLabel,s=e.accessibilityOffLabel,c=function(e){return e?"checked":"unchecked"},l=new x.a.Value(t?1:0),u=(t?o:s).replace("{0}",i),d=r.useState(c(t))[1],p=r.useCallback((function(){var e={toValue:t?0:1,duration:300};x.a.timing(l,e).start((function(){d(c(!t)),a(!t)}))}),[l,a,t]);return r.createElement(E.a,{disabled:n,onPress:p,accessibilityRole:"switch",accessibilityLabel:u,accessibilityState:{disabled:n,checked:t},accessibilityStates:[c(t)],activeOpacity:.5},r.createElement(x.a.View,{style:[w.baseContainer,{backgroundColor:l.interpolate({inputRange:[0,1],outputRange:["white","#0078D4"]}),borderColor:l.interpolate({inputRange:[0,1],outputRange:["#666666","#0078D4"]})}]},r.createElement(x.a.View,{style:[w.circleStyle,{backgroundColor:l.interpolate({inputRange:[0,1],outputRange:["#666666","white"]}),transform:[{translateX:l.interpolate({inputRange:[0,1],outputRange:[0,20]})}]},w.buttonStyle]})))}var w=g.a.create({baseContainer:{flexDirection:"row",alignItems:"center",width:40,height:20,borderRadius:10,borderColor:"#666666",borderWidth:2,backgroundColor:"white",padding:4},circleStyle:{width:10,height:10,borderRadius:5,backgroundColor:"#666666"},buttonStyle:{alignItems:"center",justifyContent:"center",position:"absolute"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var A=g.a.create({touchableContainer:{flexDirection:"row",justifyContent:"space-between",paddingTop:15,paddingBottom:10,alignItems:"flex-start",flexGrow:1},textContainer:{flexDirection:"row",alignItems:"center"},buttonTextStyle:{fontSize:16,paddingLeft:13,color:"#666666"}}),F=r.memo((function(e){var t=e.onChangeToggleOption,n=e.labelToggleOption,o=e.toggleSwitchOn,s=e.isDisabledToggleOption,c=e.accessibilityOnLabel,l=e.accessibilityOffLabel;return r.createElement(a.a,{style:[A.touchableContainer,{opacity:s?.5:1}],accessibilityLabel:n},r.createElement(a.a,{style:A.textContainer,accessibilityElementsHidden:!0,importantForAccessibility:"no-hide-descendants"},r.createElement(_.a,{icon:C.a.NetworkOffline,size:A.buttonTextStyle.fontSize,color:"#818181",type:0}),r.createElement(i.a,{style:A.buttonTextStyle},n)),r.createElement(T,{toggleSwitchOn:o,isDisabled:s,onchange:t,accessibilityLabel:n,accessibilityOnLabel:c,accessibilityOffLabel:l}))})),N=n("ITQc");var k=function(e){return r.createElement(N.a,{role:"cell",style:M.rowItem},r.createElement(i.a,{style:M.rowItemText},e.text))},M=g.a.create({row:{flexDirection:"row",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},rowItem:{flex:1,alignSelf:"stretch",minWidth:0,paddingRight:5},rowItemText:{fontSize:14,color:"#333333",lineHeight:16}}),D=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.entityName,n=e.entityLastSyncValue;return r.createElement(N.a,{role:"row",style:M.row,key:t},r.createElement(k,{text:t}),r.createElement(k,{text:n}))}));var R=function(e){return r.createElement(N.a,{role:"columnheader",style:L.headerRowItem},r.createElement(i.a,{style:L.headerRowItemText,numberOfLines:1,ellipsizeMode:"tail"},e.text))},L=g.a.create({table:{flexShrink:1},headerRowGroup:{flexDirection:"row",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},headerRowItem:{flex:1,alignSelf:"stretch"},headerRowItemText:{fontSize:12,lineHeight:14,color:"#666666"},entitiesRowGroup:{flexShrink:1,overflowY:"auto"}}),B=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.headerLabels,n=e.data;return r.createElement(N.a,{role:"table",style:L.table},r.createElement(N.a,{role:"rowgroup"},r.createElement(N.a,{role:"row",style:L.headerRowGroup},r.createElement(R,{text:t.entity}),r.createElement(R,{text:t.lastSyncValue}))),r.createElement(N.a,{role:"rowgroup",style:L.entitiesRowGroup},Object.keys(n).map((function(e){return r.createElement(D,{key:e,entityName:e,entityLastSyncValue:n[e]})}))))}));var V=g.a.create({container:{flexDirection:"column",flexGrow:0,flexShrink:1,flexBasis:"auto"},summaryLine:{flexDirection:"row",paddingTop:15,paddingBottom:10,alignItems:"center"},summaryLineLabel:{paddingLeft:13,paddingRight:13,flex:1,fontSize:16},collapseButton:{alignContent:"flex-end"}}),G=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.icon,n=e.isCollapsedDefault,o=e.data,s=e.listNameTemplate,c=e.buttonAriaLabel,l=e.headerLabels,u=e.isForcedSyncInProgress,d=r.useState(n),p=d[0],g=d[1],h=r.useCallback((function(){return g(!p)}),[p]),m=s.replace("{0}",Object.keys(o).length.toString());return r.createElement(a.a,{style:[V.container,{minHeight:p?"46px":"150px"}]},r.createElement(E.a,{style:V.summaryLine,onPress:h,accessibilityRole:"listbox","aria-expanded":!p,"aria-haspopup":"false","aria-label":c+". "+m},u?r.createElement(I.a,{size:"small",color:"#A8A8AC",accessibilityComponentType:"none",style:[{transform:[{scale:.8}]}]}):r.createElement(_.a,{icon:t,size:V.summaryLineLabel.fontSize,color:"#000000",type:0}),r.createElement(i.a,{style:V.summaryLineLabel,numberOfLines:1,ellipsizeMode:"tail"},m),r.createElement(a.a,{style:V.collapseButton},r.createElement(_.a,{icon:p?C.a.DropdownArrow:C.a.ChevronUp,size:V.summaryLineLabel.fontSize,color:"#333333",type:0}))),!p&&r.createElement(B,{headerLabels:l,data:o}))})),W=n("akzq"),z=n("LAqF");var X={animated:!0,showHideTransition:"slide",hidden:!1},q=function(){function e(){var e=this;this._stack=[],this._updateStatusBarTimeout=null,this._updateStatusBar=function(){if(e._updateStatusBarTimeout=null,e._stack.length>0){var t=e._stack[e._stack.length-1];n=t.props,(r=z.a.get_Instance().get_device()).get_IsAvailable()&&r.postMessage(JSON.stringify({name:"changeStatusBar",props:n}))}var n,r}}return e.prototype.add=function(e,t){this._stack.push({id:e,props:Object(s.__assign)(Object(s.__assign)({},X),t)}),this._debounceUpdateStatusBar()},e.prototype.update=function(e,t){this._stack=this._stack.map((function(n){return n.id===e?Object(s.__assign)(Object(s.__assign)({},n),{props:Object(s.__assign)(Object(s.__assign)({},X),t)}):n})),this._debounceUpdateStatusBar()},e.prototype.remove=function(e){this._stack=this._stack.filter((function(t){return t.id!==e})),this._debounceUpdateStatusBar()},e.prototype._debounceUpdateStatusBar=function(){this._updateStatusBarTimeout&&clearTimeout(this._updateStatusBarTimeout),this._updateStatusBarTimeout=setTimeout(this._updateStatusBar,50)},e}(),U=0,H=new q,Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._uniqueID="statusBar_"+U++,t}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){H.add(this._uniqueID,this.props)},t.prototype.componentDidUpdate=function(){H.update(this._uniqueID,this.props)},t.prototype.componentWillUnmount=function(){H.remove(this._uniqueID)},t.prototype.render=function(){return null},t}(r.PureComponent),K=n("np0M"),Q=r.memo((function(e){var t=e.offlineStatusAvailableEntitiesListProps.data,o=e.offlineStatusNotAvailableEntitiesListProps.data;return r.createElement(d.a,{style:{backgroundColor:"#FFFFFF"}},r.createElement(Y,{barStyle:"dark-content",backgroundColor:"#FFFFFF"}),r.createElement(a.a,{nativeID:"OfflineStatusDialogPresentation",style:[ee.rootStyle,{paddingLeft:e.isMainFormDialog?0:$,paddingTop:e.isMainFormDialog?0:$}],accessibilityLabel:e.title},r.createElement(a.a,{style:ee.dialogHeaderContainerStyle},r.createElement(i.a,{style:ee.dialogHeaderStyle,numberOfLines:1},e.title),r.createElement(O,{closeHandler:e.closeHandler,label:e.closeButtonLabel})),r.createElement(f,Object(s.__assign)({},e.offlineStatusDescriptionProps)),e.isForceSyncOfflineDataFeatureEnabled&&e.isFirstSyncCompleted&&r.createElement(N.a,{role:"cell",style:{alignSelf:"flex-start"}},r.createElement(b.a,{title:e.updateOfflineDataButtonLabel,disabled:e.isForcedSyncInProgress,onPress:e.forcedOfflineDataUpdateHandler,accessibilityLabel:e.updateOfflineDataButtonLabel,accessibilityComponentType:"button",accessibilityTraits:"button",style:e.isForcedSyncInProgress?ee.buttonDisabled:ee.buttonEnabled})),t&&Object.keys(t).length>0&&r.createElement(G,Object(s.__assign)({},e.offlineStatusAvailableEntitiesListProps)),o&&Object.keys(o).length>0&&r.createElement(G,Object(s.__assign)({},e.offlineStatusNotAvailableEntitiesListProps)),e.isOfflineFileDownloadFeatureEnabled&&e.isFirstSyncCompleted&&e.offlineStatusFileDownloadStatusListProps.isFileDownloadProgressVisible&&r.createElement(K.a,{loader:function(){return n.e(39).then(n.bind(null,"g/2i")).then((function(e){return e.OfflineStatusFileDownloadStatusList}))},props:Object(s.__assign)({},e.offlineStatusFileDownloadStatusListProps)}),e.isOfflineStatusToggleVisible&&r.createElement(F,Object(s.__assign)({},e.offlineStatusToggleOptionProps)),(e.isProgressVisible||e.isForcedSyncInProgress)&&r.createElement(P,Object(s.__assign)({},e.offlineStatusDownloadProgressProps)),r.createElement(y,Object(s.__assign)({},e.downloadOfflineMetadataButtonProps)),r.createElement(W.a,{key:"accessibilityComponent",rootElementId:"OfflineStatusDialogPresentation",shouldManageFocus:!0,isModal:!0})))})),Z=p.a.get("window"),J=Math.round(Z.width),$=J<=480?14:21,ee=g.a.create({dialogHeaderContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"1.25rem"},dialogHeaderStyle:{overflow:"hidden",marginTop:0,marginBottom:0,fontSize:17,fontWeight:"600",color:"#333"},rootStyle:{flexWrap:"nowrap",display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#FFFFFF",paddingBottom:$,paddingRight:$,width:J<500?J:500,alignSelf:"flex-end"},buttonEnabled:{textAlign:"center",color:"#FFF",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#0078D4",borderRadius:2,fontSize:14,lineHeight:19,paddingLeft:16,paddingRight:16},buttonDisabled:{textAlign:"center",color:"#ACACAC",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#F1F1F1",borderRadius:2,fontSize:14,lineHeight:19,paddingLeft:16,paddingRight:16}}),te=n("Ww2r"),ne=n("RYq1"),re=n("HSdq"),ae=n("I0a0"),ie=n("c56u"),oe=n("Ev4I"),se=n("JlqV"),ce=n("pdOk"),le=n("hSyu"),ue=n("766A"),de=n("rzA0"),pe=n("bick"),ge=n("qC0c"),he=n("L+41"),me=n("nlyT"),fe=n("GUnN"),be=n("5iz+"),ve=n("ouFk"),ye=n("7pqb"),_e=n("717U");var Ce,Se=n("BvBP"),Oe=n("otJc"),Ie=n("0ifx");function je(e,t,n,r){var a={},i={};return e&&Object.keys(e).forEach((function(o,s){var c=function(e,t,n){var r=t.notAvailableLabel,a=t.downloadErrorLabel,i=t.estimatedTimeLeftLabel,o=t.lastSyncDateTodayLabel,s=t.lastSyncDateYesterdayLabel,c=t.lastSyncDateAtLabel,l=r;if(null!=e&&void 0!==e.initialdatadownloadstatus&&null!==e.initialdatadownloadstatus){var u=parseInt(e.initialdatadownloadstatus,10);if(!isNaN(u))switch(u){case Ce.Failed:l=a;break;case Ce.Completed:if(e.lastdatasynctime){var d=null,p=Date.parse(e.lastdatasynctime);(d=isNaN(p)?Object(Ie.b)(e.lastdatasynctime,"yyyy-MM-dd HH:mm:ss",n):new Date(p))&&(l=Object(Oe.g)(d,o,s,c,n))}break;default:if(void 0!==e.initialdatadownloadetainminutes&&null!==e.initialdatadownloadetainminutes){var g=void 0,h=void 0,m=parseInt(e.initialdatadownloadetainminutes,10);isNaN(m)||(h=Math.floor(m/60),g=m%60,l=i.replace("{0}",h.toString()).replace("{1}",g.toString()))}}}return l}(e[o],n,r);t&&t.indexOf(o)>=0?i[e[o].displayname]=c:a[e[o].displayname]=c})),{availableEntitiesListData:a,notAvailableEntitiesListData:i}}!function(e){e[e.Pending=0]="Pending",e[e.Completed=1]="Completed",e[e.NotTracked=2]="NotTracked",e[e.InProgress=3]="InProgress",e[e.Failed=4]="Failed"}(Ce||(Ce={}));var Pe=n("7EJx"),xe=n("gPja"),Ee=n("H/RR"),Te=n("7cIM"),we=n("kyRo"),Ae=n("L3gy"),Fe=n("Ed0P"),Ne=n("GBfE"),ke=n("lMVv"),Me=n("4tno");var De=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=this,n=e.id,a=Object(u.c)(),i=Object(ae.a)(c.K),o=Object(u.d)((function(e){return Object(ge.c)(e,l.l)})),d=Object(u.d)((function(e){return Object(ge.c)(e,l.Ed)})),p=Object(u.d)((function(e){return Object(ge.c)(e,l.ib)})),g=Object(te.c)(i,pe.f),h=Object(te.c)(i,pe.d),m=r.useContext(we.a),f=r.useCallback((function(e){return Object(s.__awaiter)(t,void 0,void 0,(function(){var t,n;return Object(s.__generator)(this,(function(r){switch(r.label){case 0:return(n={})[Ee.a.IsUserSelectOffline]=e,t=n,a(Object(xe.a)(Ee.a.IsUserSelectOffline,t,!1)),e?[3,2]:[4,a(Object(de.g)(null,g,h,o))];case 1:return r.sent(),[3,3];case 2:m.DataSource&&m.DataSource.set_IsServerAvailable(!1),r.label=3;case 3:return a(Object(ue.b)(e)),[2]}}))}))}),[m.DataSource,a,o,h,g]),b=Object(u.d)((function(e){return Object(re.Ib)(e,n)})),v=Object(u.d)((function(e){return Object(ie.i)(e)})),y=Object(u.d)((function(e){return Object(ie.l)(e)})),_=Object(te.c)(i,c.y),S=Object(te.c)(i,c.e),O=r.useCallback((function(e){e.preventDefault(),a(Object(ne.e)(n))}),[a,n]),I=Object(u.d)(se.b),j=Object(u.d)(ie.q),P=Object(u.d)(ie.e),x=Object(u.d)(Se.e),E=I&&x&&j===he.a.Initializing,T={statusLabel:Object(te.c)(i,c.N),statusText:Object(u.d)(ie.t),statusMessage:Object(u.d)(ie.s),helpLabel:Object(te.c)(i,c.E),helpLinkLabel:Object(te.c)(i,c.G),helpLinkAccessibilityLabel:Object(te.c)(i,c.F),helpLinkHandler:function(){return a(Object(Te.a)("https://go.microsoft.com/fwlink/?linkid=2103926"))}},w=Object(u.d)(ie.q),A={toggleSwitchOn:Object(u.d)(ie.v),isDisabledToggleOption:w!==he.a.Available,labelToggleOption:Object(te.c)(i,c.O),onChangeToggleOption:f,accessibilityOnLabel:Object(te.c)(i,c.b),accessibilityOffLabel:Object(te.c)(i,c.a)},F=Object(u.d)(le.c),N=Object(u.d)(ie.a);r.useEffect((function(){N&&a(Object(Ae.a)())}),[N,a]);var k=r.useCallback((function(){a(Object(ce.h)())}),[a]),M=r.useCallback((function(){a(Object(Ne.initializeOfflineLifecycleAsyncAction)(!0))}),[a]),D={downloadOfflineMetadataButtonLabel:Object(te.c)(i,c.l),isMetadataDownloadRequired:I&&ve.a.SyncPendingFromServer===F,downloadOfflineMetadataHandler:k},R=r.useCallback((function(){a({type:"offline.cancel.sync",execute:function(e,t){var n=e.dispatch,r=e.getState,a=t.OfflineProvider,i=t.TraceManager.getTracer(ce.f),o=[];return a.cancelSync().nativePromise().then((function(){var e=r(),a=Object(ie.i)(e),s=Object(ie.l)(e);if(o.push({name:ye.b.IsForcedSync,value:a}),a||s)i.warn("OfflineCancelSyncAction.cancelSync: Successfully canceled forced sync",o),n(Object(_e.e)(!1));else{var c=he.a.NotAvailable;n(Object(me.c)(c,be.a.None)),o.push({name:ye.b.OfflineStatus,value:c});var l=ve.a.SyncPendingFromServer;n(Object(ce.i)({syncStatus:l,metadataAvailable:!1})),Object(ce.j)(t,ce.c,!1),o.push({name:ce.c,value:!1}),Object(ce.j)(t,ce.d,l),o.push({name:ce.d,value:l})}i.warn("OfflineCancelSyncAction.cancelSync: Successfully",o)})).catch((function(e){return o.push({name:ye.b.ErrorMessage,value:Object(fe.e)(e)}),i.error("OfflineCancelSyncAction.cancelSync: Failure.",o),Promise.reject(e)}))}})}),[a]),L={labelProgress:Object(te.c)(i,c.M),labelCancelButton:Object(te.c)(i,c.L),progressSpinnerLabel:Object(te.c)(i,c.m),onClickCancelDownloadButton:R,showSpinner:!v},B={notAvailableLabel:Object(te.c)(i,"L_Offline_Not_Available"),downloadErrorLabel:Object(te.c)(i,c.z),estimatedTimeLeftLabel:Object(te.c)(i,c.r),lastSyncDateTodayLabel:Object(te.c)(i,c.C),lastSyncDateYesterdayLabel:Object(te.c)(i,c.D),lastSyncDateAtLabel:Object(te.c)(i,c.A)},V={networkConnectivityErrorTitle:Object(te.c)(i,c.j),insufficientStorageErrorTitle:Object(te.c)(i,c.i),serviceErrorErrorTitle:Object(te.c)(i,c.k),networkConnectivityErrorMessage:Object(te.c)(i,c.g),insufficientStorageErrorMessage:Object(te.c)(i,c.f),serviceErrorErrorMessage:Object(te.c)(i,c.h)},G={downloading:Object(te.c)(i,c.v),pending:Object(te.c)(i,c.n),waiting:Object(te.c)(i,c.p),completed:Object(te.c)(i,c.u),error:Object(te.c)(i,c.w),suspended:Object(te.c)(i,c.o)},W=Object(u.d)(oe.g),z=Object(u.d)(oe.i),X=Object(u.d)(Pe.w),q=je(W,z,B,Object(Oe.d)(X)),U=q.availableEntitiesListData,H=q.notAvailableEntitiesListData,Y={entity:Object(te.c)(i,c.q),lastSyncValue:Object(te.c)(i,c.B)},K={entity:Object(te.c)(i,c.q),progress:Object(te.c)(i,c.J),status:Object(te.c)(i,c.N)},Z={icon:C.a.SetDefault,isCollapsedDefault:!0,listNameTemplate:Object(te.c)(i,c.d),buttonAriaLabel:Object(te.c)(i,c.c),data:U,headerLabels:Y,isForcedSyncInProgress:v},J={icon:C.a.MarkAsLost,isCollapsedDefault:!0,listNameTemplate:Object(te.c)(i,c.I),buttonAriaLabel:Object(te.c)(i,c.H),data:H,headerLabels:Y,isForcedSyncInProgress:v},$=Object(Fe.h)(P),ee=Object(u.d)((function(e){return Object(ke.t)(e,$)}));P.totalProgress!==Fe.d&&(P=Object(Fe.i)(P,ee));var Ce={downloadedFileCount:Object(te.c)(i,c.t),availableFileCount:Object(te.c)(i,c.s)},Ie={isFileDownloadProgressVisible:!!P&&P.totalProgress!==Fe.d,isCollapsedDefault:!0,listHeaderLabels:Ce,data:P,headerLabels:K,statusLabels:G,errorLabels:V,closeButtonLabel:S},De=!Object(u.d)(Me.o);return r.createElement(Q,{title:_,closeButtonLabel:S,closeHandler:O,isMainFormDialog:b,isProgressVisible:E,isOfflineFileDownloadFeatureEnabled:d,isForceSyncOfflineDataFeatureEnabled:p,offlineStatusDescriptionProps:T,offlineStatusAvailableEntitiesListProps:Z,offlineStatusNotAvailableEntitiesListProps:J,offlineStatusToggleOptionProps:A,offlineStatusDownloadProgressProps:L,downloadOfflineMetadataButtonProps:D,offlineStatusFileDownloadStatusListProps:Ie,forcedOfflineDataUpdateHandler:M,isForcedSyncInProgress:v,isFirstSyncCompleted:y,updateOfflineDataButtonLabel:Object(te.c)(i,c.x),isOfflineStatusToggleVisible:De})})),Re=n("E+3N"),Le=n("wul+"),Be=n("oVzJ"),Ve=r.createContext({scroll:void 0,onScroll:void 0,scrollEnd:void 0,onScrollEnd:void 0,nativeHeaderHeight:0,setNativeHeaderHeight:void 0});function Ge(e,t){void 0===t&&(t=8);var n=-1;return function(){for(var r=this,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];-1===n&&(n=setTimeout((function(){n=-1,e.apply(r,a)}),t))}}function We(e){var t=r.useContext(Ve),n=t.scroll,a=t.scrollEnd;r.useEffect((function(){var t=document.getElementById(e);if(t){var r=function(){return Math.max(0,t.scrollTop)},i=function(e,t){void 0===t&&(t=100);var n=-1,r=function(){return clearTimeout(n)};return[function(){r(),n=setTimeout(e,t)},r]}((function(){return a(r())})),o=i[0],s=i[1],c=0,l=!1,u=Ge((function(){l=!0,s(),c=r()})),d=Ge((function(){l=!1,o(),n(r(),0,0)})),p=Ge((function(){var e=r();n(e,c,c-e),!l&&o()}));t.addEventListener("touchstart",u),t.addEventListener("touchend",d),t.addEventListener("touchcancel",d),t.addEventListener("scroll",p);return n(0,0,0),function(){t.removeEventListener("touchstart",u),t.removeEventListener("touchend",d),t.removeEventListener("touchcancel",d),t.removeEventListener("scroll",p),s()}}}),[e,n,a])}function ze(e){var t=e.id;return Object(u.d)(Be.b)?r.createElement(Xe,{id:t}):null}function Xe(e){We(e.id);var t=r.useContext(Ve).nativeHeaderHeight;return r.createElement(d.a,{style:{paddingHorizontal:0,paddingBottom:0}},r.createElement(a.a,{style:{width:"100%",height:t}}))}var qe=n("7qYC"),Ue=n("tlts"),He=n("TCzx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ye(e){return e[Ke()]}function Ke(){return"web"===Ue.a.OS&&He.a.getInstance().get_IsAndroid()?"android":"web"===Ue.a.OS&&He.a.getInstance().get_IsIOS()||"web"===Ue.a.OS?"ios":Ue.a.OS}var Qe=n("uS8n");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ze(e){var t=e.children,n=e.top,o=e.left,s=e.onPress,c=e.shouldRenderTooltip,l=e.text;return c?r.createElement(a.a,{style:Je.wrapperView},r.createElement(a.a,{style:Je.childrenBorder},t),r.createElement(Qe.a,null,r.createElement(qe.a,{onPress:s},r.createElement(a.a,{style:[Je.tooltipWrapper,{top:n,left:o}]},r.createElement(a.a,{style:Je.triangle}),r.createElement(a.a,{style:Je.tooltipBox},r.createElement(i.a,{style:Je.text},l)))))):t}var Je=g.a.create({wrapperView:{position:"relative"},childrenBorder:Object(s.__assign)({},Ye({ios:{borderColor:"#222222",borderRadius:8,borderWidth:1}})),triangle:Object(s.__assign)({width:0,height:0,borderColor:"transparent",borderBottomColor:"#222222",borderBottomWidth:7,borderLeftWidth:7,borderRightWidth:7,marginLeft:13},Ye({android:{display:"none"}})),tooltipBox:Object(s.__assign)({padding:13},Ye({ios:{backgroundColor:"#222222",borderRadius:8,shadowColor:"rgba(0, 0, 0, 0.24)",shadowOffset:{height:2,width:0},shadowRadius:4},android:{backgroundColor:"rgba(97, 97, 97, 0.9)",borderRadius:2,textAlign:"center"}})),text:{color:"#FFF",fontSize:15},tooltipWrapper:Object(s.__assign)({position:"absolute"},Ye({ios:{width:250},android:{width:200}}))});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function $e(e){var t=r.useContext(ga);return r.createElement(E.a,{accessibilityLabel:e.label,"aria-haspopup":e.accessibilityHaspopup,accessibilityRole:"button","data-id":e.id,testID:e.label,style:Object(s.__assign)(Object(s.__assign)({},e.style),{width:44,height:44,padding:12}),onPress:e.onPress,onLongPress:e.onLongPress},r.createElement(_.a,{icon:e.icon,size:20,color:t.headerIconColor,flipInRtl:e.flipInRtl}))}function et(e){var t=e.openSearchPage,n=r.useContext(ha).searchLabel;return r.createElement($e,{onPress:t,style:{alignSelf:"flex-end",marginRight:"4px"},icon:C.a.SearchButton,label:n})}function tt(e){var t=e.openCreateMenu,n=r.useContext(ha).quickCreateMenuLabel;return r.createElement($e,{onPress:t,icon:C.a.New,label:n})}function nt(e){var t=e.openGlobalCommandsFlyout,n=r.useContext(ha).moreCommands;return r.createElement($e,{onPress:t,icon:C.a.MoreVertical,label:n})}function rt(e){var t=e.toggleSiteMap,n=e.sitemapButtonLabel;return r.createElement($e,{onPress:t,icon:C.a.Details,id:"navbutton",label:n,accessibilityHaspopup:!0})}function at(e){var t=e.navigateBack,n=e.navigateBackToRoot,a=e.backButtonTooltip,i=r.useContext(ha).backLabel,o="android"===Ke();return r.createElement(Ze,{text:a.text,onPress:a.onPress,shouldRenderTooltip:a.shouldRenderTooltip,top:o?6:45,left:o?59:6.7},r.createElement($e,{onPress:t,onLongPress:n,icon:C.a.LeftArrowHead,label:i,flipInRtl:!0}))}var it=n("sOTk"),ot=n("v/Fs");function st(e){return"NavigationBar.PageHeader"+e}var ct=n("bKPb"),lt=n("uO/V"),ut=["dashboard","entitylist","entityrecord"],dt=["dashboard","entityrecord","entitylist"],pt={isDirty:!1},gt=r.createContext(pt);function ht(e){var t=e.pageId,n=e.baseContext,a=e.children,i=Object(ot.c)(t),o=Object(ot.b)(t),c=r.useMemo((function(){return Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},n),i),{additionalSaveActions:o})}),[o,n,i]);return r.createElement(gt.Provider,{value:c},a)}var mt=[ct.W];function ft(e){var t=e.baseContext,n=e.children,a=Object(ae.a)(mt),i=r.useMemo((function(){return Object(s.__assign)(Object(s.__assign)({},t),{title:a[ct.W],pageDirty:!1})}),[t,a]);return r.createElement(gt.Provider,{value:i},n)}function bt(e){var t=e.baseContext,n=e.children,a=r.useMemo((function(){return Object(s.__assign)(Object(s.__assign)({},t),{headerType:2})}),[t]);return r.createElement(gt.Provider,{value:a},n)}function vt(e){var t=e.pageId,n=e.children,a=Object(u.d)((function(e){return Object(it.k)(e,{id:t})})),i=Object(u.d)((function(e){return Object(it.b)(e,t)})),o=a?-1!==ut.indexOf(a)&&st(t):"placeholder",c=-1!==dt.indexOf(a),d=r.useMemo((function(){return Object(s.__assign)(Object(s.__assign)({},pt),{pageContentId:o,headerType:c?0:1,pageType:a})}),[o,c,a]),p=!1;return Object(u.d)((function(e){return Object(ge.c)(e,l.tc)&&Object(ge.c)(e,l.D)}))&&i===lt.p||(p="entitylist"===a),null===a||p?r.createElement(bt,{baseContext:d},n):"entityrecord"===a?r.createElement(ht,{baseContext:d,pageId:t},n):"search"===a?r.createElement(ft,{baseContext:d},n):r.createElement(gt.Provider,{value:d},n)}var yt=n("4fxQ"),_t=n("v7n7"),Ct=n.n(_t);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function St(e){e.preventDefault()}function Ot(e){return r.createElement(a.a,Object(s.__assign)({},e,{onTouchStart:St,onTouchMove:St,onTouchCancel:St}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function It(e){var t=e.top,n=e.onClose,i=e.children,o=p.a.get("window"),s=.6*o.height,c=o.height,l=o.width,u="android"===Ke(),d=r.useState(!0),g=d[0],h=d[1],m=r.useState(new x.a.Value(0))[0];r.useEffect((function(){return x.a.timing(m,{toValue:.4,duration:100}).start()}),[m]);var f=r.useCallback((function(){x.a.timing(m,{toValue:0,duration:100}).start(),h(!1)}),[m]),b=r.useCallback((function(e){var n=yt.findDOMNode(e);if(n){var r=n.parentElement.parentElement;r.style.clip="rect("+t+"px, auto, auto, auto)",r.style.zIndex="1"}}),[t]);return r.createElement(r.Fragment,null,r.createElement(x.a.View,{style:[Pt.fullscreen,Pt.backdrop,{width:l,height:c,opacity:m},!u&&{top:t}]}),r.createElement(Qe.a,null,r.createElement(Ot,{key:"backdrop",style:[Pt.fullscreen,{width:l,height:c}]}),r.createElement(qe.a,{onPress:f},r.createElement(a.a,{style:[Pt.fullscreen,{width:l,height:c}]}))),r.createElement(Ct.a,{key:"flyout",onModalHide:n,animationIn:u?"slideInUp":"slideInDown",animationInTiming:300,animationOut:u?"slideOutDown":"slideOutUp",swipeThreshold:80,swipeDirection:"up",onSwipe:f,isVisible:g,backdropColor:"rgba(0,0,0,0)",onBackdropPress:f,style:[Pt.root,!u&&{marginTop:t}]},u&&r.createElement(a.a,{key:"drag",style:Pt.drawerHead}),i(s),!u&&r.createElement(a.a,{ref:b,key:"drag",style:Pt.drawerHead},r.createElement(a.a,{style:Pt.draggableWidget}))))}function jt(){var e=r.useState(null),t=e[0],n=e[1],a=r.useState(0),i=a[0],o=a[1];return{anchorPoint:i,updateAnchorPoint:r.useCallback((function(){if(t){var e=yt.findDOMNode(t);if(e){var n=e.getBoundingClientRect().bottom;o(n)}}}),[t]),setAnchorPoint:n}}var Pt=g.a.create({fullscreen:{position:"fixed",top:0,left:0},backdrop:{backgroundColor:"black",opacity:.4},root:Object(s.__assign)({width:"100%",height:"auto",margin:0,display:"flex",flexDirection:"column"},Ye({ios:{justifyContent:"flex-start"},android:{justifyContent:"flex-end"}})),drawerHead:Object(s.__assign)(Object(s.__assign)({},Ye({ios:{borderBottomLeftRadius:14,borderBottomRightRadius:14},android:{borderTopLeftRadius:14,borderTopRightRadius:14}})),{height:20,backgroundColor:"white",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.0516)",display:"flex",flexDirection:"column",alignItems:"center"}),draggableWidget:{marginTop:8,width:36,height:4,backgroundColor:"#D2D0CE",borderRadius:2}}),xt=n("LXYY"),Et=n("F/sP"),Tt=n("yZTI"),wt=n("kRDR"),At=n("hZR7"),Ft=n("N2KO"),Nt=n("QS6j"),kt=n("+Z9T");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Mt(e){return e.CommandType===Ft.b||e.CommandType===Ft.c}function Dt(e){return e&&e.IsInjectedCommand&&(!Object(kt.a)(e.Execute)||!Object(kt.a)(e.ExecuteInjectedPopulationQueryCommand))}function Rt(e){if(!e)return!1;var t=Mt(e);return!t&&!!e.Command||t&&!!e.PopulateQueryCommand}function Lt(e,t){var n=Ft.a,r=[];return e.Children&&e.Children.length>0&&(n=e.execute?Ft.c:Ft.b,r=e.Children.map((function(e){return Lt(e,t)}))),{Id:e.Id,IsInjectedCommand:!0,CommandType:n,CommandManagerId:t,Command:e.Id,DataId:e.DataId,LabelText:e.DisplayText,Icon:e.Icon,Tooltip:e.Tooltip,Children:r,Execute:e.execute,ExecuteInjectedPopulationQueryCommand:e.executeInjectedPopulationQueryCommand,IsGlobalCommand:t===wt.d}}function Bt(e,t,n,r){void 0===n&&(n=!1);var a=[];if(!n){if(e.ControlType===Ft.c||e.ControlType===Ft.b){var i=e.Menu;i&&i.MenuSection.forEach((function(e){var n,r;null===(r=null===(n=null==e?void 0:e.Item)||void 0===n?void 0:n.Items)||void 0===r||r.forEach((function(e){a.push(Bt(e,t))}))}))}e.ControlType===Ft.c&&function(e,t,n){if(n){for(var r=e.Command.split("|"),a=n.Commands,i=a[r[0]]?a[r[0]][r[r.length-1]].Actions:null,o=0;o<t.length;o++){var s=t[o].Command.split("|");if(Vt(i,a[s[0]]?a[s[0]][s[s.length-1]].Actions:null))return!1}return!0}return void 0===t.find((function(t){return t.Command===e.Command}))}(e,a,r)&&a.unshift(Bt(e,t,!0))}return{Id:e.Id,CommandManagerId:t,CommandType:n?Ft.a:e.ControlType,Command:e.Command,LabelText:e.LabelText,IsInjectedCommand:!1,Icon:e.ModernImage,Tooltip:void 0!==e.ToolTipTitle?e.ToolTipTitle:"",Children:a,PopulateQueryCommand:e.PopulateQueryCommand,CommandingControl:e.ControlType!==Ft.c?e:null,IsGlobalCommand:t===wt.d}}function Vt(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length)return!1;e.sort(),t.sort();for(var n=0;n<e.length;n++){if(e[n].ActionType!==t[n].ActionType)return!1;switch(e[n].ActionType){case 3:var r=e[n].Attributes,a=t[n].Attributes;if(Wt(r.Library)!==Wt(a.Library))return!1;if(Gt(r.FunctionName)!==Gt(a.FunctionName))return!1;break;case 1:if(e[n].Attributes!==t[n].Attributes)return!1;break;default:return!1}}return!0}function Gt(e){return e&&e.endsWith("Legacy")?e.substr(0,e.length-6):e}function Wt(e){return e&&e.toLowerCase().startsWith("$webresource:")?e.substr(13):e}var zt=n("8vWI"),Xt=n("YWpA"),qt=n("haDr"),Ut=n("4PNl"),Ht=r.forwardRef((function(e,t){return r.createElement(Ut.a,Object(s.__assign)({},e,{style:[Qt.scrollView,e.style],contentContainerStyle:[Qt.contentContainerStyle,e.contentContainerStyle],ref:t}),r.createElement(d.a,{style:Qt.content},e.children),!e.disableShortContentBounce&&r.createElement(a.a,{style:Qt.scrollViewBouncingHelper}))}));function Yt(e){return r.createElement(Ht,Object(s.__assign)({},e))}function Kt(e){return r.createElement(Ht,Object(s.__assign)({disableShortContentBounce:!0},e))}var Qt=g.a.create({scrollView:{flex:1},contentContainerStyle:{flexGrow:1,flexShrink:0},content:{flexGrow:1,flexShrink:0,paddingTop:0},scrollViewBouncingHelper:{flex:0,height:1,marginBottom:-1}}),Zt=n("ipvx"),Jt=n.p+"resources/images/AndroidBack.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function $t(e){var t=e.id,n=e.displayText,i=e.flyoutCommand,o=e.visible,c=e.setCommandBarStatus,l=e.setFlyoutCommand,u=e.modalStyles,d=e.headerComponent,p=e.isCommandDrawer,g=e.flyoutOptions,h=e.webResourcePath,m=e.executeCommand,f=r.useState([]),b=f[0],v=f[1],y=b&&0===b.length,_=y?i:b[b.length-1],C=p?un.drawerModalContainer:un.flyoutModalContainer,S={};p&&(S={swipeThreshold:100,swipeDirection:"down",onSwipe:en(v,c)});var O=p?"CommandDrawer":"CommandFlyout";return r.createElement(Ct.a,Object(s.__assign)({key:t,isVisible:o,backdropOpacity:.3,onBackdropPress:en(v,c)},p?S:Zt.a,{style:u||un.flyoutModal}),r.createElement(Xt.a,{id:O},r.createElement(a.a,{style:C},p&&r.createElement(an,{isHeaderRendered:!!d}),d||!p&&r.createElement(rn,{showBackButton:!y,label:n||_&&_.LabelText,onBackButtonClick:sn(b,v)}),r.createElement(tn,{id:t,commandStack:b,currentCommand:_,setFlyoutCommand:l,setCommandStack:v,setCommandBarStatus:c,isCommandDrawer:p,flyoutOptions:g,webResourcePath:h,executeCommand:m}))),r.createElement(W.a,{key:"CommandAccessibilityComponent",rootElementId:O,shouldManageFocus:!0,isModal:!0}))}function en(e,t){return function(){t(Tn.none)}}function tn(e){e.id;var t=e.commandStack,n=e.currentCommand,i=e.setFlyoutCommand,o=e.setCommandStack,s=e.setCommandBarStatus,c=e.isCommandDrawer,l=e.flyoutOptions,u=e.webResourcePath,d=e.executeCommand,g=r.useContext(rr).loading;if(!n)return null;var h=c?[n.Children,!1]:l(n),m=h[0],f=h[1],b={maxHeight:.6*p.a.get("window").height};return f?r.createElement(a.a,{style:b},r.createElement(on,{text:g})):r.createElement(a.a,{style:c?[un.drawerContent,b]:b},r.createElement(nn,{isCommandDrawer:c,commandStack:t,setCommandStack:o,setFlyoutCommand:i,setCommandBarStatus:s,data:m,webResourcePath:u,executeCommand:d}))}function nn(e){var t=e.isCommandDrawer,n=e.commandStack,i=e.setCommandStack,o=e.setFlyoutCommand,c=e.setCommandBarStatus,l=e.data,u=e.webResourcePath,d=e.executeCommand,p=r.useContext(rr).noOptionsAvailable,g=[];return l.length>0&&g.push({title:null,data:Object(s.__spreadArrays)(l)}),r.createElement(zt.a,Object(s.__assign)({accessibilityRole:"menu",accessibilityLabel:qt.a,stickySectionHeadersEnabled:!1,ListEmptyComponent:function(){return r.createElement(on,{text:p})}},t&&{renderScrollComponent:Kt},{renderItem:function(e){var a=e.item;return r.createElement(sr,{key:a.Id,id:a.Id,commandControl:a,displayText:a.LabelText,isFlyoutCommand:Mt(a),icon:a.Icon,isRegularCommand:!0,webResourcePath:u,commandClickHandler:Mt(a)?cn(a,t,n,i,c,o):en(0,c),executeCommand:d,accessibilityLabel:a.Tooltip,accessibilityRole:"menuitem"})},sections:g,keyExtractor:function(e,t){return e.id+" | "+e.command+" | "+t},ItemSeparatorComponent:function(){return r.createElement(a.a,{style:un.separator})}}))}function rn(e){var t=e.showBackButton,n=e.label,o=e.onBackButtonClick,s="android"===Ke(),c=null,l=null,u=r.useContext(rr).back;return t&&(c=r.createElement(E.a,{onPress:o,accessibilityLabel:u,accessibilityRole:"button"},r.createElement(a.a,{style:un.flyoutHeaderBackButtonContainer},s?r.createElement(_.a,{icon:Jt,size:16,color:"#605E5C",type:1}):r.createElement(_.a,{icon:C.a.LeftChevron,size:20,color:"#2266E3",type:0}))),l=!s&&r.createElement(E.a,{disabled:!0},r.createElement(a.a,{style:un.flyoutHeaderBackButtonContainer},r.createElement(_.a,{icon:C.a.LeftChevron,size:20,color:"transparent",type:0})))),r.createElement(a.a,{style:un.flyoutHeaderContainer},c,r.createElement(i.a,{style:c?dn.flyoutHeaderTextWithBackButton:un.flyoutHeaderText},n),l)}function an(e){var t=e.isHeaderRendered;return r.createElement(a.a,{style:t?ln.handleBarContainer:ln.handleBarContainerWithoutHeader},r.createElement(a.a,{style:ln.handleBar}))}function on(e){var t=e.text;return r.createElement(sr,{id:"PlaceHolderCommand_"+t,commandControl:null,displayText:t,isFlyoutCommand:!1,icon:null,isRegularCommand:!0,commandClickHandler:null,disabled:!0,executeCommand:null,accessibilityLabel:t,accessibilityRole:"button"})}function sn(e,t){return function(){var n=Object(s.__spreadArrays)(e);n.pop(),t(n)}}function cn(e,t,n,r,a,i){return function(){t?(i(e),a(Tn.flyoutOpened)):r(Object(s.__spreadArrays)(n,[e]))}}var ln=g.a.create({handleBar:Object(s.__assign)({width:36,height:4,borderRadius:2,marginTop:8},Ye({ios:{backgroundColor:"#D2D0CE"},android:{backgroundColor:"transparent"}})),handleBarContainer:{alignItems:"center",backgroundColor:"#F3F2F1",height:20,borderTopLeftRadius:14,borderTopRightRadius:14},handleBarContainerWithoutHeader:Object(s.__assign)({alignItems:"center"},Ye({android:{backgroundColor:"#FFFFFF",height:15,borderTopLeftRadius:8,borderTopRightRadius:8},ios:{backgroundColor:"#FFFFFF",height:20,borderTopLeftRadius:14,borderTopRightRadius:14}}))}),un=g.a.create({flyoutModal:Object(s.__assign)({},Ye({android:{margin:0,padding:64}})),flyoutModalContainer:Object(s.__assign)({},Ye({ios:{borderRadius:14,backgroundColor:"#ffffff"},android:{borderRadius:2,backgroundColor:"#FAFAFA",paddingBottom:12,shadowOffset:{width:0,height:11},shadowColor:"#000000",shadowOpacity:.2,shadowRadius:15}})),drawerModalContainer:{borderTopLeftRadius:14,borderTopRightRadius:14,backgroundColor:"#ffffff"},flyoutHeaderContainer:Object(s.__assign)({display:"flex",flexDirection:"row",justifyContent:"space-between"},Ye({ios:{height:44,borderBottomColor:"#C8C8C8",borderBottomWidth:xt.a,alignItems:"center"}})),flyoutHeaderBackButtonContainer:Object(s.__assign)({width:50,alignItems:"center"},Ye({ios:{height:50,justifyContent:"center"},android:{height:"100%",paddingTop:28}})),flyoutHeaderText:Object(s.__assign)({},Ye({ios:{fontSize:17,lineHeight:22,flex:1,textAlign:"center",alignSelf:"center"},android:{fontSize:20,lineHeight:22,flex:1,textAlign:"left",alignSelf:"center",fontWeight:"500",margin:24,marginBottom:12}})),drawerContent:{minHeight:88},separator:Object(s.__assign)({},Ye({ios:{height:xt.a,backgroundColor:"#C8C8C8",marginLeft:62}}))}),dn=g.a.create({flyoutHeaderTextWithBackButton:g.a.flatten([un.flyoutHeaderText,Ye({android:{marginLeft:4}})])});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function pn(e){var t=e.headerCommandControls,n=e.overflowListCommandControls,a=e.commandBarStatus,i=e.setCommandBarStatus,o=e.setFlyoutCommand,s=e.flyoutOptions,c=e.webResourcePath,l=e.executeCommand,u=t&&t.length&&r.createElement(gn,{commands:t,setCommandBarStatus:i,setFlyoutCommand:o,webResourcePath:c,executeCommand:l});return r.createElement($t,{id:"CommandDrawer",flyoutCommand:{Children:n},visible:a===Tn.drawerExpanded,setCommandBarStatus:i,setFlyoutCommand:o,isCommandDrawer:!0,headerComponent:u,modalStyles:mn.commandDrawerModal,flyoutOptions:s,webResourcePath:c,executeCommand:l})}function gn(e){var t=e.commands,n=e.setCommandBarStatus,i=e.setFlyoutCommand,o=e.webResourcePath,s=e.executeCommand;return r.createElement(a.a,{style:mn.globalCommandBar},r.createElement(Et.a,{accessibilityRole:"menu",accessibilityLabel:qt.a,data:t,renderItem:hn(n,i,o,s),horizontal:!0,keyExtractor:function(e){return e.Id}}))}function hn(e,t,n,a){return function(i){var o=i.item,s=Mt(o);return r.createElement(sr,{key:o.Id,id:o.Id,commandControl:o,displayText:o.LabelText,icon:o.Icon,isFlyoutCommand:s,isRegularCommand:!1,webResourcePath:n,commandClickHandler:s?Ln(e,t,o):function(){return e(Tn.none)},executeCommand:a,accessibilityLabel:o.Tooltip,accessibilityRole:"menuitem"})}}var mn=g.a.create({commandDrawerModal:{justifyContent:"flex-end",margin:0},globalCommandBar:{justifyContent:"space-around",alignItems:"flex-start",backgroundColor:"#F3F2F1",borderBottomColor:"#C8C8C8",borderBottomWidth:xt.a,paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function fn(e,t,n){var a=r.useState(n),i=a[0],o=a[1];return r.useEffect((function(){var r=e.addListener((function(e){var n=e.value;return o(t(n))}));return o(n),function(){return e.removeListener(r)}}),[e,n,t]),i}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function bn(){return"android"===Ke()}function vn(){return"android"===Ke()}var yn=n("ucY0"),_n=n("Js03"),Cn=n.p+"resources/images/AndroidActions.svg?v=1.4.9962-v91onpremise",Sn=n("Wi7Z"),On={get sliderSize(){return p.a.get("window").width-30},get endPosition(){return 0},get startPosition(){return(yn.a.isRTL?-1:1)*(p.a.get("window").width-30-58)},get sliderCenter(){return p.a.get("window").width/2}};function In(e,t){return x.a.spring(e,{toValue:t}).start()}function jn(e){var t=e.children,n=r.useRef(new x.a.Value(On.startPosition)).current,i=r.useRef(function(e){var t=function(t,n){e.flattenOffset();var r=t.nativeEvent.pageX,a=Math.abs(n.vx)>1,i=n.vx<0,o=a?i:r<On.sliderCenter;(yn.a.isRTL?!o:o)?In(e,On.endPosition):In(e,On.startPosition)};return _n.a.create({onStartShouldSetPanResponder:function(){return!0},onMoveShouldSetPanResponder:function(){return!0},onPanResponderTerminationRequest:function(){return!0},onPanResponderGrant:function(){e.setOffset(e._value),e.setValue(0)},onPanResponderMove:x.a.event([null,{dx:e}]),onPanResponderRelease:t,onPanResponderTerminate:t})}(n)).current;return r.createElement(a.a,{style:[wn.sliderContainer,{width:On.sliderSize}],pointerEvents:"box-none"},r.createElement(x.a.View,Object(s.__assign)({pointerEvents:"auto"},i.panHandlers,{style:(wn.floatingButtonContainer,[{width:58,transform:[{translateX:n}]}])}),t))}function Pn(e){var t=e.onClick,n=e.paddingBottom,i=e.accessibilityLabel;return r.createElement(a.a,{style:[wn.positionView,{height:p.a.get("window").height,width:p.a.get("window").width,paddingBottom:n}],pointerEvents:"box-none"},r.createElement(jn,null,r.createElement(E.a,{onPress:t,style:wn.buttonContainer,accessibilityLabel:i,accessibilityRole:Sn.d,testID:"floating-command-button"},r.createElement(_.a,{icon:Cn,type:1,color:"#FFF",size:24}))))}function xn(e){var t=e.onClick,n=r.useContext(rr).actions;return r.createElement(Le.a,{name:"floating-commanding-slot"},r.createElement(Pn,{onClick:t,accessibilityLabel:n}))}function En(e){var t=e.paddingBottom;return r.createElement(Le.c,{name:"floating-commanding-slot",fillChildProps:{paddingBottom:t}})}var Tn,wn=g.a.create({sliderContainer:{width:"100%",marginBottom:11.25},floatingButtonContainer:{width:58},positionView:{justifyContent:"flex-end",alignItems:"center",position:"absolute"},buttonContainer:{alignItems:"center",width:58,height:58,justifyContent:"center",backgroundColor:"#002050",borderRadius:48,shadowColor:"#000",shadowOpacity:.25,shadowOffset:{height:1,width:0},shadowRadius:4}}),An=n("U5ei"),Fn=function(){function e(e){this._dispatch=e}return e.prototype.registerFlyout=function(e,t){this._dispatch(Object(An.d)(e,t))},e.prototype.unregisterFlyout=function(e){this._dispatch(Object(An.c)(e))},e}(),Nn=r.createContext({});!function(e){e[e.none=0]="none",e[e.flyoutOpened=1]="flyoutOpened",e[e.drawerExpanded=2]="drawerExpanded"}(Tn||(Tn={}));var kn=r.memo((function(e){var t=e.commandManagerInitialized,n=e.globalCommands,a=e.pageLevelCommands,i=e.flyoutOptions,o=e.executeCommand,c=e.webResourcePath,l=e.hideCommandBar,u=e.setCommandShelfRendered,d=r.useState(),p=d[0],g=d[1],h=r.useState(Tn.none),m=h[0],f=h[1],b=function(e,t){return r.useMemo((function(){return function(e,t){if(e=e||[],vn())return[[],e,[]];t=t||[];var n=[],r=e.length,a=Object(s.__spreadArrays)(e,t);if(a.length<=4)return[a,[],[]];if(n.push.apply(n,a.slice(0,3)),r<=3)return[n,t.slice(3-r),[]];return[n,e.slice(3),t]}(e,t)}),[e,t])}(a,n),v=b[0],y=b[1],_=b[2],C=r.useCallback((function(){return f(Tn.drawerExpanded)}),[]),S=bn();return r.createElement(r.Fragment,null,S?t&&!l&&a&&a.length>0&&r.createElement(xn,{onClick:C}):r.createElement(Dn,{setCommandShelfRendered:u,primaryCommandControls:v,executeCommand:o,setFlyoutCommand:g,commandBarStatus:m,setCommandBarStatus:f,webResourcePath:c,hideCommandBar:l,commandManagerInitialized:t,showMoreButton:!(!y||!y.length)}),r.createElement(Mn,{flyoutCommandId:"native-command-bar",flyoutCommand:p,setFlyoutCommand:g,commandBarStatus:m,setCommandBarStatus:f,flyoutOptions:i,headerCommandControls:_,overflowListCommandControls:y,webResourcePath:c,executeCommand:o}))}));var Mn=r.memo((function(e){var t=e.flyoutCommandId,n=e.flyoutCommand,a=e.setFlyoutCommand,i=e.commandBarStatus,o=e.setCommandBarStatus,s=e.flyoutOptions,c=e.headerCommandControls,l=e.overflowListCommandControls,u=e.webResourcePath,d=e.executeCommand,p=r.useContext(Nn).NativeFlyoutManager,g=r.useCallback((function(){return o(Tn.none)}),[o]);return r.useEffect((function(){return i===Tn.none?p.unregisterFlyout(t):p.registerFlyout(t,g),function(){return p.unregisterFlyout(t)}}),[g,i,t,p]),r.createElement(r.Fragment,null,r.createElement($t,{id:"CommandFlyout",key:$t+(n&&n.Id),flyoutCommand:n,visible:i===Tn.flyoutOpened,setCommandBarStatus:o,setFlyoutCommand:a,flyoutOptions:s,webResourcePath:u,executeCommand:d}),r.createElement(pn,{headerCommandControls:c,overflowListCommandControls:l,commandBarStatus:i,setCommandBarStatus:o,setFlyoutCommand:a,flyoutOptions:s,webResourcePath:u,executeCommand:d}))}));function Dn(e){var t=e.primaryCommandControls,n=e.executeCommand,i=e.setFlyoutCommand,o=e.commandBarStatus,s=e.setCommandBarStatus,c=e.webResourcePath,l=e.hideCommandBar,u=e.commandManagerInitialized,p=e.showMoreButton,g=e.setCommandShelfRendered,h=r.useState(),m=h[0],f=h[1],b=function(e,t){var n=r.useState(new x.a.Value(0))[0],a=n.interpolate({inputRange:[0,1],outputRange:["0%","101%"]}),i=r.useMemo((function(){return new x.a.Value(t)}),[t]),o=r.useCallback((function(e){return 1===e}),[]),s=fn(n,o,e),c=r.useCallback((function(){x.a.timing(n,{toValue:1}).start(),x.a.timing(i,{toValue:0}).start()}),[n,i]),l=r.useCallback((function(){x.a.timing(n,{toValue:0}).start(),x.a.timing(i,{toValue:t}).start()}),[n,i,t]);return r.useEffect((function(){e&&!s?c():!e&&s&&l()}),[e,s,c,l]),{isCollapsed:s,animatedHeight:i,translation:a}}(l,m),v=b.isCollapsed,y=b.animatedHeight,_=b.translation;return r.useEffect((function(){return g(u||!v),function(){return g(!1)}}),[u,v,g]),u?r.createElement(x.a.View,{accessibilityLabel:qt.a,accessibilityRole:"menubar",onLayout:function(e){var t=e.nativeEvent.layout.height;!m&&t>0&&f(t)},style:{height:y,transform:[{translateY:_}]}},r.createElement(Rn,{primaryCommandControls:t,executeCommand:n,setFlyoutCommand:i,commandBarStatus:o,setCommandBarStatus:s,webResourcePath:c,isCollapsed:v,showMoreButton:p})):v?null:r.createElement(d.a,{style:Bn.commandBar},r.createElement(a.a,{style:Bn.commandBarContent}))}function Rn(e){var t=e.primaryCommandControls,n=e.executeCommand,i=e.setFlyoutCommand,o=e.setCommandBarStatus,s=e.webResourcePath,c=e.isCollapsed,l=e.showMoreButton,u=r.useContext(rr),p=u.more,g=u.moreCommands;return!c&&r.createElement(d.a,{key:"ReactNativeCommandBar",style:Bn.commandBar},r.createElement(a.a,{style:Bn.commandBarContent},t.map((function(e){var t=Mt(e);return r.createElement(sr,{key:e.Id,id:e.Id,commandControl:e,displayText:e.LabelText,icon:e.Icon,isFlyoutCommand:t,isRegularCommand:!1,webResourcePath:s,commandClickHandler:t&&Ln(o,i,e),executeCommand:n,accessibilityLabel:e.Tooltip,accessibilityRole:"menuitem"})})),l&&r.createElement(sr,{key:"more_commands_id",id:"more_commands_id",commandControl:null,displayText:p,icon:"More",isFlyoutCommand:!1,isRegularCommand:!1,webResourcePath:s,commandClickHandler:function(){return o(Tn.drawerExpanded)},executeCommand:null,accessibilityLabel:g,accessibilityRole:"menuitem"})))}function Ln(e,t,n){return function(){t(n),e(Tn.flyoutOpened)}}var Bn=g.a.create({commandBar:{borderTopColor:"#C8C8C8",borderTopWidth:xt.a,backgroundColor:"#F3F2F1",paddingTop:0},commandBarContent:{height:86,flexDirection:"row"}}),Vn=n("EGsq"),Gn=n("3nmE"),Wn=n("nBkV"),zn=n("Fas2"),Xn=n("RImw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function qn(e){var t=Object(u.c)(),n=Object(u.d)(Tt.c),a=e.CommandManagerId,i=Object(u.d)((function(t){return Object(Wn.a)(t,a,e.Id)})),o=function(e,t){var n=r.useMemo((function(){return function(e,t){if(e&&(e.ExecuteInjectedPopulationQueryCommand||e.PopulateQueryCommand)){var n=[];return e.CommandType===Ft.c&&n.push(e.Children[0]),t&&t.MenuSection.forEach((function(t){var r,a;null===(a=null===(r=null==t?void 0:t.Item)||void 0===r?void 0:r.Items)||void 0===a||a.forEach((function(t){n.push(Bt(t,e.CommandManagerId))}))})),n}return e.Children||[]}(e,t)}),[e,t]),a=r.useMemo((function(){return function(e,t){var n;return e&&t&&t.length>0&&(n=t?t.filter((function(t){return t.Id!==e.Id&&!!t.CommandingControl})).reduce((function(e,t){return e.concat(t.CommandingControl)}),[]):[]),n}(e,n)}),[e,n]);return[n,a]}(e,i),s=o[0],c=o[1],l=Object(u.d)((function(e){return Object(Xn.c)(e,a)})),d=l&&l.SelectedItems&&l.SelectedItems.length>0,p=Object(u.d)((function(e){return Object(zn.e)(e,c,n,a,d)}));return r.useEffect((function(){c&&c.length>0&&t(function(e,t,n){return Object(Nt.d)(e,t,n,null)}(c,n,a))}),[t,c,n,a]),r.useMemo((function(){return[s?s.filter((function(t){return t.Id===e.Id||t.IsInjectedCommand||p[Object(zn.i)(t.Id,null==l?void 0:l.ContextEntityLogicalName)]})):[],e&&!e.IsInjectedCommand&&0===Object.keys(p||{}).length]}),[s,e,p,l])}var Un=n("e2pn"),Hn=n("odkg"),Yn=n("Sscr"),Kn=n("ASFs"),Qn=n("WS0f");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Zn(e,t){var n=Object(u.c)();return r.useCallback((function(r){if((i=r)&&Dt(i)||Rt(i)){var a=r.IsGlobalCommand?e:t;n(function(e,t){var n=Mt(t);if(Dt(t)){var r=t.Execute?t.Execute:t.ExecuteInjectedPopulationQueryCommand,a=t.Id;return e(null,t.DataId?t.DataId:t.Command,a,t.IsInjectedCommand,r)}if(Rt(t)){var i=n?t.PopulateQueryCommand.split("|"):t.Command.split("|");if(a=t.Id,4===i.length)return e(""===i[0]?"null":i[0],i[3],a)}}(a,r))}var i}),[n,e,t])}function Jn(e,t){var n=Object(u.d)((function(t){return Object(Hn.b)(t,e)})),a=null==n?void 0:n.ribbonId,i=Object(u.d)((function(e){return Object(zn.j)(e,a)})),o=Object(u.d)((function(e){return Object(Tt.c)(e)}));Object(Qn.b)(t)&&(t=o);var s=null==n?void 0:n.contextToken,c=null==n?void 0:n.ruleContext,l=s?Object(Yn.v)(s):null;return{executeCommand:function(e,t,n,a,i){return r.useCallback((function(r,o,s,c,l){return Object(Un.a)(e,a,r,o,s,t,n,i,c,l)}),[n,i,t,e,a])}(i,t,e,c,l),commands:function(e,t,n,a){var i=Object(u.d)((function(e){return{isOnline:Object(se.b)(e),pageIsHierarchy:Object(zn.o)(e,t)}}),Kn.e),o=i.isOnline,s=i.pageIsHierarchy;return r.useMemo((function(){var t,r,i,c;if(!a)return[];for(var l=[],u=0,d=null!==(t=a.addedCommandList)&&void 0!==t?t:[];u<d.length;u++){var p=d[u];l.push(Lt(p,e))}for(var g=Object(zn.a)(n,!1),h=(null!==(i=null===(r=a.ruleContext)||void 0===r?void 0:r.SelectedItems)&&void 0!==i?i:[]).length>0,m=0,f=g;m<f.length;m++){var b=(p=f[m])&&Object(zn.i)(p.Id,Object(Xn.a)(null==a?void 0:a.ribbonId));Object(zn.n)(b,a,h,o,s)&&l.push(Bt(p,e,!1,n))}for(var v=0,y=null!==(c=a.appendedCommandList)&&void 0!==c?c:[];v<y.length;v++){p=y[v];l.push(Lt(p,e))}return l}),[e,a,o,s,n])}(e,t,i,n)}}var $n=n("pdGj"),er=n("Gemh"),tr=n("2OIc"),nr=n("rbxJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var rr=r.createContext({}),ar=r.createContext({IconToSVGMapping:Gn.a});function ir(e){var t,n,a,i,o,s,c,l=e.setCommandShelfRendered,u=(t=Object(ae.a)(At.f.concat("MenuItem_Label_Actions")),n=t[At.c],a=t[At.d],i=t[At.a],o=t[At.e],s=t[At.b],c=t.MenuItem_Label_Actions,r.useMemo((function(){return{more:n,moreCommands:a,back:i,noOptionsAvailable:o,loading:s,actions:c}}),[n,a,i,o,s,c]));return r.createElement(ar.Provider,{value:{IconToSVGMapping:Gn.a}},r.createElement(rr.Provider,{value:u},r.createElement(or,{setCommandShelfRendered:l})))}function or(e){var t=e.setCommandShelfRendered,n=Jn(wt.d),a=n.executeCommand,i=n.commands,o=Object(u.d)((function(e){return Object(Tt.c)(e)})),s=function(e){var t=Object(u.d)((function(t){return Object(it.k)(t,{id:e})})),n=Object(ot.d)(e).isDirty;return r=t,["search"].indexOf(r)>=0||function(e){return["create","quickcreate","entity","entityrecord"].indexOf(e)>=0}(t)&&n;var r}(o),c=function(e){var t=Object(u.d)((function(e){return Object($n.a)(e,wt.d)})),n=Object(u.d)((function(t){return Object($n.a)(t,e)})),a=(l=Object(u.d)((function(t){return Object(it.k)(t,{id:e})})),["entitylist","view"].indexOf(l)>=0),i=Object(u.d)((function(t){return a&&function(e,t){var n=Object(er.ab)(e,lt.m),r=Object(tr.e)(e,lt.m);if(n&&r&&r.Properties.DataSetDefinitions&&r.Properties.DataSetDefinitions[n]&&r.Properties.DataSetDefinitions[n].CDSDataSetOptions){var a=r.Properties.DataSetDefinitions[n].CDSDataSetOptions,i=Yn.k(e,t);return a.hasOwnProperty(lt.E.COMMANDBAR_ENABLED)?a.displayCommandBar:Object(nr.b)(i,lt.E.COMMANDBAR_ENABLED,null)}return!1}(t,e)})),o=r.useState(!1),s=o[0],c=o[1];var l;return r.useEffect((function(){var e=setTimeout((function(){return c(!0)}),5e3);return function(){return clearTimeout(e)}}),[]),t&&(n||i||s)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(o),l=Jn(o),d=l.executeCommand,p=l.commands,g=Zn(a,d),h=Object(u.d)(Vn.t);return p&&p.length>0||i&&i.length>0?r.createElement(kn,{commandManagerInitialized:c,globalCommands:i,pageLevelCommands:p,flyoutOptions:qn,executeCommand:g,webResourcePath:h,hideCommandBar:s,setCommandShelfRendered:t}):null}function sr(e){var t=e.id,n=e.commandControl,i=e.displayText,o=e.icon,s=e.isRegularCommand,c=e.disabled,l=e.commandClickHandler,u=e.webResourcePath,d=e.executeCommand,g=e.accessibilityLabel,h=e.accessibilityRole,m=s?dr:pr;return r.createElement(E.a,{testID:"command-button-"+t,key:t,onPress:lr(l,n,d),disabled:c,accessibilityLabel:g,accessibilityRole:h},r.createElement(a.a,{style:[m.commandContainer,{width:.25*p.a.get("window").width}]},r.createElement(cr,{containerStyle:m.commandIconContainer,icon:o,webResourcePath:u}),r.createElement(ur,{styles:m,displayText:i,isRegularCommand:s})))}function cr(e){var t=e.containerStyle,n=e.icon,i=e.webResourcePath,o=e.color||"#002050",s=r.createElement(_.a,{icon:C.a.Puzzle,size:20,color:o,type:0}),c=r.useContext(ar).IconToSVGMapping;if(n&&-1!==n.indexOf("$webresource:")){var l=Object(Vn.a)(i,n);s=r.createElement(_.a,{icon:l,size:20,color:o,type:1})}else n&&(c&&c[n]?s=r.createElement(_.a,{icon:c[n],size:20,color:o,type:1}):C.a&&C.a[n]&&(s=r.createElement(_.a,{icon:C.a[n],size:20,color:o,type:0})));return r.createElement(a.a,{style:t},s)}function lr(e,t,n){return function(){n&&n(t),e&&e()}}function ur(e){var t=e.styles,n=e.displayText,o=e.isRegularCommand,s=1,c=t.commandLabelContainer;return o||(s=2),r.createElement(a.a,{style:c},r.createElement(i.a,{numberOfLines:s,style:t.commandLabel},n))}var dr=g.a.create({commandContainer:{display:"flex",flex:1,flexDirection:"row",alignItems:"center"},commandIconContainer:{alignItems:"center",justifyContent:"center",marginLeft:21,marginRight:21,paddingVertical:12},commandLabelContainer:Object(s.__assign)({flexDirection:"row",height:"100%",flexGrow:2},Ye({ios:{paddingVertical:11},android:{paddingVertical:12}})),commandLabel:{textAlign:"left",fontSize:17,letterSpacing:-.408,color:"#323130",lineHeight:22},flyoutChevronContainer:{marginLeft:"auto",marginRight:21}}),pr=g.a.create({commandContainer:{flex:1,flexDirection:"column",alignItems:"center",justifyContent:"flex-start",flexGrow:1,marginTop:8,marginBottom:"center"},commandIconContainer:{alignItems:"center",justifyContent:"center",width:40,height:40,borderRadius:20,backgroundColor:"white",borderWidth:.5,borderStyle:"solid",borderColor:"rgba(0, 32, 80, 0.35)",marginLeft:5,marginRight:5},commandLabelContainer:{flexDirection:"row",width:"80%",alignItems:"center",justifyContent:"center",marginTop:4,marginBottom:8,height:26},commandLabel:{flex:1,fontSize:11,letterSpacing:.012,color:"#002050",textAlign:"center",lineHeight:13}}),gr=r.createContext({});function hr(e){var t=e.item,n=e.isSelected,o=e.hasChildren,s=e.onChange,c=e.onItemPress,l=r.useContext(gr),u=r.useCallback((function(e){c&&c(e),s(t.value)}),[t.value,s,c]);return r.createElement(E.a,{accessibilityRole:"button",testID:t.text,style:n?l.itemWrapperSelected:l.itemWrapper,onPress:u},t.icon&&r.createElement(cr,{icon:t.icon,containerStyle:l.commandIconContainer,color:l.listItemIcon.color}),r.createElement(i.a,{numberOfLines:1,style:n?[l.title,{color:"#2266E3"}]:l.title},t.text),o&&r.createElement(_.b,{onPress:u,icon:C.a.Arrow,size:16,color:"#000",flipInRtl:!0,style:l.icon}),n&&r.createElement(a.a,{style:l.selectedIconWrapper},r.createElement(_.a,{icon:C.a.ForwardDisable,size:20,color:"#2266E3"})))}function mr(e){var t=e.goBack,n=r.useContext(ha).backLabel,o=r.useContext(gr);return r.createElement(r.Fragment,null,r.createElement(E.a,{accessibilityLabel:n,accessibilityRole:"button",style:[o.itemWrapper,o.backWrapper],onPress:t},r.createElement(_.b,{onPress:t,icon:C.a.LeftArrowHead,size:16,color:"#000",flipInRtl:!0,style:o.icon}),r.createElement(i.a,{numberOfLines:1,style:o.title},n)),r.createElement(a.a,{style:o.separator}))}function fr(e){var t=e.items,n=e.selectedItem,i=e.onChange,o=e.onItemPress,s=e.maxHeight,c=r.useContext(gr),l=r.useState(t),u=l[0],d=l[1];return r.createElement(a.a,{style:[c.list,{maxHeight:s}]},r.createElement(Et.a,{key:"list",data:u,renderItem:function(e){var t=e.item;return r.createElement(hr,{item:t,hasChildren:!!t.items,isSelected:t.value===n,onChange:t.items?function(){return d(t.items)}:i,onItemPress:o})},keyExtractor:function(e){return e.value},ListHeaderComponent:u!==t&&r.createElement(mr,{key:"back",goBack:function(){return d(t)}}),ItemSeparatorComponent:function(){return r.createElement(a.a,{style:c.separator})}}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var br=0;function vr(e){var t=e.top,n=e.items,a=e.selectedItem,i=e.onChange,o=e.onItemPress,s=e.close,c=r.useMemo((function(){return"drawer_id_"+ ++br}),[]),l=r.useContext(Nn).NativeFlyoutManager;return r.useEffect((function(){return l.registerFlyout(c,s),function(){return l.unregisterFlyout(c)}}),[s,c,l]),r.createElement(It,{top:t,onClose:s},(function(e){return r.createElement(gr.Provider,{value:yr},r.createElement(fr,{items:n,top:t,maxHeight:e,selectedItem:a,onChange:i,onItemPress:o,close:s}))}))}var yr=g.a.create({list:{backgroundColor:"white"},itemWrapper:{display:"flex",flexDirection:"row",height:50,backgroundColor:"white",paddingLeft:16,paddingRight:16,alignItems:"center"},itemWrapperSelected:{display:"flex",flexDirection:"row",height:50,backgroundColor:"white",paddingLeft:16,alignItems:"center"},backWrapper:{paddingLeft:4},title:{fontSize:17,color:"black",flexGrow:1},separator:Object(s.__assign)({},Ye({ios:{height:xt.a,backgroundColor:"#C8C8C8",marginLeft:"16px"}})),icon:{display:"flex",width:44,height:50,alignItems:"center",justifyContent:"center"},selectedIconWrapper:Object(s.__assign)({},Ye({ios:{height:44,width:44,alignItems:"center",justifyContent:"center"},android:{display:"none"}})),listItemIcon:{color:"#002050"},commandIconContainer:{}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _r(e){var t=e.top,n=e.definition,a=e.setIsOpen;return n&&r.createElement(vr,{top:t,items:n.items,selectedItem:null,onChange:function(e){n.executables[e](),a(!1)},onItemPress:function(e){e.preventDefault(),e.stopPropagation()},close:function(){return a(!1)}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Cr(e,t){var n=r.useState(e),a=n[0],i=n[1],o=r.useCallback((function(e){t&&t(e),i(e)}),[t]),s=r.useCallback((function(){return o(!a)}),[o,a]);return[a,s,o]}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Sr(e){var t=e.title,n=e.titleStyle,a=e.numberOfLines;return r.createElement(i.a,{numberOfLines:a||1,style:n},t)}function Or(e){var t=e.pageId,n=e.children;return r.createElement(Le.a,{name:st(t)},n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ir(e){var t=e.style,n=e.isHeaderCollapsed,i=e.opacity,o=e.children;return r.createElement(a.a,{pointerEvents:n?"auto":"none",accessibilityElementsHidden:!n,importantForAccessibility:n?"auto":"no-hide-descendants",style:[Er.pageSlotContainer,t],testID:"page-title-container"},r.createElement(x.a.View,{style:[Er.titleContainer,{opacity:i}]},o))}function jr(){var e=r.useContext(ga);return r.useMemo((function(){return{color:e.textColor,fontSize:17,textAlign:"center"}}),[e.textColor])}function Pr(e){var t=e.pageContentId,n=e.isHeaderCollapsed,a=e.opacity,i=jr();return r.createElement(Ir,{isHeaderCollapsed:n,opacity:a},r.createElement(Le.c,{name:t,fillChildProps:{titleStyle:i}}))}function xr(e){var t=e.title,n=e.isHeaderCollapsed,a=e.opacity,i=jr();return r.createElement(Ir,{style:Er.plainContainer,isHeaderCollapsed:n,opacity:a},r.createElement(Sr,{title:t,titleStyle:i}))}var Er=g.a.create({pageSlotContainer:{flexGrow:1,flexBasis:0,flexDirection:"row",justifyContent:"center",padding:"11px",marginLeft:"44px"},titleContainer:{maxWidth:"100%"},plainContainer:{marginRight:"88px"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Tr(e){var t=e.top,n=e.saveActions,a=e.close,i=r.useMemo((function(){return n.map((function(e,t){return{text:e.label,value:t.toString()}}))}),[n]),o=r.useCallback((function(e){a(),n[e].save()}),[a,n]);return r.createElement(vr,{top:t,items:i,onChange:o,close:a,selectedItem:null})}function wr(e){var t=e.pageContentId,n=e.isHeaderCollapsed,a=e.isInCreateMode,i=e.opacity,o=e.save,s=e.discard,c=e.toggleSaveFlyoutOpen,l=r.useContext(ha);return r.createElement(r.Fragment,null,r.createElement(b.a,{onPress:s,title:l.discard,style:Ar.discard}),r.createElement(Pr,{pageContentId:t,isHeaderCollapsed:n,opacity:i}),a&&r.createElement(_.b,{onPress:c,icon:C.a.More,size:17,color:"#605E5C",style:Ar.more}),r.createElement(b.a,{onPress:o,title:l.save,style:Ar.save}))}var Ar=g.a.create({more:{fontSize:17,alignSelf:"center",marginRight:8,padding:13.5,width:44,height:44},discard:{paddingLeft:16},save:{paddingRight:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Fr(e){var t=e.title,n=e.pageContentId,a=e.isHeaderCollapsed,i=e.opacity,o=e.toggleSiteMap,s=e.navigateBack,c=e.navigateBackToRoot,l=e.openSearchPage,u=e.openCreateMenu,d=e.backButtonTooltip,p=e.toggleGlobalCommandsFlyout,g=r.useContext(ha).sitemapLabel,h=!!t,m=vn(),f=l?r.createElement(et,{openSearchPage:l}):null;return r.createElement(r.Fragment,null,s?r.createElement(at,{backButtonTooltip:d,navigateBack:s,navigateBackToRoot:c}):r.createElement(rt,{toggleSiteMap:o,sitemapButtonLabel:g}),h?r.createElement(xr,{title:t,isHeaderCollapsed:a,opacity:i}):r.createElement(r.Fragment,null,r.createElement(Pr,{pageContentId:n,isHeaderCollapsed:a,opacity:i}),f,r.createElement(tt,{openCreateMenu:u}),m&&p&&r.createElement(nt,{openGlobalCommandsFlyout:p})))}function Nr(e){var t=r.useContext(gt),n=t.title,i=t.isDirty,o=t.isInCreateMode,c=t.save,l=t.discard,u=t.additionalSaveActions,d=jt(),p=d.anchorPoint,g=d.setAnchorPoint,h=d.updateAnchorPoint,m=Cr(!1,h),f=m[0],b=m[1],v=m[2],y=Cr(!1,h),_=y[0],C=y[1],S=y[2];return r.createElement(a.a,{ref:g,style:kr.container},i?r.createElement(wr,{pageContentId:e.pageContentId,isHeaderCollapsed:e.isHeaderCollapsed,opacity:e.opacity,save:c,discard:l,isInCreateMode:o,toggleSaveFlyoutOpen:C}):r.createElement(Fr,Object(s.__assign)({},e,{title:n,openCreateMenu:b})),f&&r.createElement(_r,{top:p,definition:e.definition,setIsOpen:v}),_&&r.createElement(Tr,{top:p,saveActions:u,close:function(){return S(!1)}}))}var kr=g.a.create({container:{display:"flex",flexDirection:"row",height:44,paddingLeft:4}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Mr(e){var t=e.style,n=e.children,i=e.onSizeChange,o=r.createRef();return r.useLayoutEffect((function(){var e=yt.findDOMNode(o.current);if(e){var t=new MutationObserver((function(){var t=e.getBoundingClientRect(),n=t.width,r=t.height;i(n,r)}));return t.observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),function(){return t.disconnect()}}}),[i,o]),r.createElement(a.a,{ref:o,style:[t,Dr.view]},n)}var Dr=g.a.create({view:{position:"absolute",transform:[{translateX:yn.a.isRTL?1e3:-1e3,translateY:-1e3}]}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Rr(e){var t=e.style,n=e.children,a=e.duration,i=Object(s.__rest)(e,["style","children","duration"]),o=r.useState(new x.a.Value(0))[0];return r.useEffect((function(){x.a.timing(o,{toValue:1,duration:150}).start(),a&&setTimeout((function(){x.a.timing(o,{toValue:0,duration:150}).start()}),a-150)}),[a,o]),r.createElement(x.a.View,Object(s.__assign)({style:[t,{opacity:o}]},i),n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Lr=x.a.createAnimatedComponent(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t.prototype.render=function(){return r.createElement(d.a,Object(s.__assign)({},this.props))},t}(r.PureComponent));function Br(e){var t=e.pageContentId,n=e.isHeaderCollapsed,a=e.opacity,i=e.onDynamicContentHeightChange,o={numberOfLines:3,titleStyle:{color:r.useContext(ga).textColor,fontSize:20,fontWeight:600}},s=r.useContext(gt).pageType,c="entityrecord"===s||"entity"===s,l=[Vr.defaultWrapper,c&&{minHeight:void 0,paddingLeft:"20px",paddingRight:"16px",marginTop:void 0}],u=c;return r.createElement(r.Fragment,null,r.createElement(x.a.View,{accessibilityElementsHidden:n,importForAccessibility:n&&"no-hide-descendants",style:[l,{opacity:a,transform:[{translateY:a.interpolate({inputRange:[0,1],outputRange:["-100%","0%"],extrapolate:"clamp"})}]},n&&{display:"none"}]},r.createElement(Le.c,{name:t,fillChildProps:o})),r.createElement(Mr,{style:l,onSizeChange:function(e,t){return i(u?t:52)}},r.createElement(Le.c,{name:t,fillChildProps:o})))}var Vr=g.a.create({defaultWrapper:{maxWidth:p.a.get("window").width,minHeight:"44px",paddingLeft:"16px",paddingRight:"8px",paddingBottom:"8px",marginTop:"8px",display:"flex",flexDirection:"row",alignItems:"center"}});function Gr(e){var t=e.toggleSiteMap,n=e.navigateBack,a=e.navigateBackToRoot,i=e.openSearchPage,o=e.quickCreateMenu,s=e.backButtonTooltip,c=e.toggleGlobalCommandsFlyout,l=r.useContext(gt),u=l.pageContentId,d=l.headerType,p=r.useContext(ga),g=function(e){var t=r.useContext(Ve),n=t.onScroll,a=t.onScrollEnd,i=t.nativeHeaderHeight,o=t.setNativeHeaderHeight,s=Math.max(i-44,0),c=r.useMemo((function(){return new x.a.Value(s)}),[s]),l=44+s,u=r.useCallback((function(e){return e<1}),[]),d=fn(c,u,!1),p=r.useCallback((function(){return x.a.timing(c,{toValue:s,duration:100}).start()}),[s,c]),g=r.useCallback((function(){return x.a.timing(c,{toValue:0,duration:100}).start()}),[c]);r.useEffect((function(){return n((function(e,t,n){if(e<=l){var r=n-Math.max(0,t-l),a=t<l/2;n<0&&a?c.setValue(s+r):n>0&&!a&&c.setValue(r)}}))}),[g,p,s,l,c,n]),r.useEffect((function(){return a((function(e){e<l/2?p():g()}))}),[g,p,l,a]);var h=1===e?44:l;return 0===e&&(h=c.interpolate({inputRange:[0,s],outputRange:[45,l+1],extrapolate:"clamp"})),{isCollapsed:1===e||d,setBottomHeight:function(e){return o(e+44)},headerHeight:h,topOpacity:0===e?c.interpolate({inputRange:[0,s],outputRange:[1,0],easing:Re.a.cubic,extrapolate:"clamp"}):1===e?1:0,bottomOpacity:c.interpolate({inputRange:[0,s],outputRange:[0,1],extrapolate:"clamp"})}}(d),h=g.headerHeight,m=g.isCollapsed,f=g.topOpacity,b=g.bottomOpacity,v=g.setBottomHeight;return r.createElement(Lr,{style:[{display:"flex",flexDirection:"column",backgroundColor:p.headerColor,paddingBottom:0,order:-1},0===d&&{position:"absolute",top:0,left:0,right:0}]},r.createElement(x.a.View,{style:{display:"flex",flexDirection:"column",height:h}},r.createElement(Nr,{pageContentId:u,toggleSiteMap:t,navigateBack:n,navigateBackToRoot:a,openSearchPage:i,definition:o,isHeaderCollapsed:m,backButtonTooltip:s,opacity:f,toggleGlobalCommandsFlyout:c}),1!==d&&r.createElement(Br,{pageContentId:u,isHeaderCollapsed:m,onDynamicContentHeightChange:v,opacity:b}),m&&n&&r.createElement(Rr,{style:Wr.bottomBorder})))}var Wr=g.a.create({bottomBorder:{width:"100%",flexBasis:xt.a,backgroundColor:"#C8C8C8"}}),zr=n("12n8"),Xr=n("CUpQ"),qr={get viewPortWidth(){return p.a.get("window").width},get swipeWidthToClose(){return.3*p.a.get("window").width},get sidebarWidth(){var e=84*p.a.get("window").width/100;return e>Ur?Ur:e},animationDuration:400,animationEasing:Re.a.out(Re.a.exp),overlayMaxOpacity:.7,tolerance:10},Ur=350,Hr=r.createContext({openAnimationProgress:new x.a.Value(0),toggleSidebar:function(){},closeSidebar:function(e){}}),Yr=function(e){function t(t){var n=e.call(this,t)||this;return n._panResponder=null,n._sidebarContext={openAnimationProgress:new x.a.Value(0),toggleSidebar:function(){n.props.isDisabled||(n.props.isOpen?n._animateToClosed():n._animatedToOpened())},closeSidebar:function(e){n.props.isDisabled||n.props.isOpen&&n._animateToClosed(e)}},n._isCurrentlySliding=!1,n._onStartShouldSetPanResponder=function(e,t){return!n.props.isDisabled&&n.props.isOpen},n._onMoveShouldSetPanResponder=function(e,t){if(n.props.isDisabled)return!1;if(!n.props.isOpen){if(n.props.isRTL){if(qr.viewPortWidth-t.moveX>40)return!1}else if(t.moveX>40)return!1;return!0}return t.dx>qr.tolerance||t.dx<-1*qr.tolerance||void 0},n._onPanResponderMove=function(e,t){var r=e.nativeEvent.pageX,a=n.props.isOpen,i=n._sidebarContext.openAnimationProgress,o=t.x0;if(a){if(n.props.isRTL?o<r:o>r){n._isCurrentlySliding=!0;var s=(n.props.isRTL?qr.sidebarWidth-t.dx:qr.sidebarWidth+t.dx)/qr.sidebarWidth;i.setValue(s)}}else if(n.props.isRTL?qr.viewPortWidth-o<40:o<40){n._isCurrentlySliding=!0;s=n.props.isRTL?(qr.viewPortWidth-r)/qr.sidebarWidth:r/qr.sidebarWidth;i.setValue(s),n.state.shouldShowOverlay||n.setState({shouldShowOverlay:!0})}},n._onPanResponderRelease=function(e,t){var r=n.props.isOpen,a=n.props.isRTL?t.x0-e.nativeEvent.pageX:e.nativeEvent.pageX-t.x0;if(n._isCurrentlySliding){var i=Math.abs(t.vx)>1,o=n.props.isRTL?t.vx>0:t.vx<0,s=n.props.isRTL?qr.viewPortWidth-t.x0+a:t.x0+a;(r?o&&i||-1*a>qr.swipeWidthToClose:!i&&s<qr.swipeWidthToClose)?n._animateToClosed():n._animatedToOpened(),n._isCurrentlySliding=!1}else(n.props.isRTL?t.x0<qr.viewPortWidth-qr.sidebarWidth:t.x0>qr.sidebarWidth&&r)&&n._animateToClosed()},n._animate=function(e,t){return x.a.timing(e,{toValue:t,duration:qr.animationDuration,easing:qr.animationEasing})},n._animatedToOpened=function(){n.state.shouldShowOverlay||n.setState({shouldShowOverlay:!0}),n._animate(n._sidebarContext.openAnimationProgress,1).start((function(){n.props.setExpandedState(!0,!0,n._sidebarContext.closeSidebar),n._sidebarContext.openAnimationProgress.setValue(1)}))},n._animateToClosed=function(e){n._animate(n._sidebarContext.openAnimationProgress,0).start((function(){n.props.setExpandedState(!1,!e,n._sidebarContext.closeSidebar),n.setState({shouldShowOverlay:!1}),e&&e()}))},n.state={shouldShowOverlay:!1},n._panResponder=_n.a.create({onStartShouldSetPanResponder:n._onStartShouldSetPanResponder,onMoveShouldSetPanResponder:n._onMoveShouldSetPanResponder,onPanResponderMove:n._onPanResponderMove,onPanResponderRelease:n._onPanResponderRelease}),n}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=this.state.shouldShowOverlay,t=this._sidebarContext.openAnimationProgress,n=this.props,i=n.children,o=n.menuContent,c=n.isDisabled;return r.createElement(Hr.Provider,{value:this._sidebarContext},r.createElement(a.a,Object(s.__assign)({style:Kr.container},!c&&this._panResponder.panHandlers),r.createElement(a.a,{style:{flexGrow:1},pointerEvents:e||this.props.isModalOpen?"none":"auto",importantForAccessibility:e||this.props.isModalOpen?"no-hide-descendants":"auto"},i),r.createElement(Qe.a,null,r.createElement(r.Fragment,null,r.createElement(x.a.View,{pointerEvents:e?"auto":"none",style:[Kr.overlay,{opacity:t}]}),r.createElement(x.a.View,{style:[[Kr.sidebar,{width:qr.sidebarWidth}],{transform:[{translateX:t.interpolate({inputRange:[0,1],outputRange:this.props.isRTL?["101%","0%"]:["-101%","0%"],extrapolate:"clamp"})}]}]},o)))))},t}(r.PureComponent),Kr=g.a.create({container:{width:"100%",height:"100%",position:"relative",backgroundColor:"#ffffff"},sidebar:{height:"100%",position:"absolute",top:0,backgroundColor:"#ffffff",backfaceVisibility:"hidden"},overlay:{width:"100%",height:"100%",position:"absolute",left:0,top:0,opacity:0,backgroundColor:"rgba(0,0,0,0.75)"}}),Qr=n("efG+"),Zr=n("CILi"),Jr=n("xlXv");function $r(){var e=r.useMemo((function(){return Object(Zr.a)()}),[]),t=Object(u.c)(),n=Object(u.d)(e);return r.useEffect((function(){n||t(Object(Jr.a)())}),[n,t]),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return r.useMemo((function(){var n={},r=t&&t.map((function(t){return t.Children?{text:t.DisplayText,items:t.Children.map((function(t){return n[t.Id]=function(){return e(t.execute)},{text:t.DisplayText,value:t.Id}}))}:(n[t.Id]=function(){return e(t.execute)},{text:t.DisplayText,value:t.Id})}));return{executables:n,items:r}}),[t,e])}(t,n)}var ea=n("Xvr5"),ta=n("g8xT"),na=["UCI_LongPressHome_Hint"];var ra=n("+r/t");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function aa(e){var t=e.top,n=e.right,i=e.width,o=e.onClose,s=e.children;return r.createElement(Qe.a,{key:"portal"},r.createElement(Ot,{key:"backdrop",style:[ia.fullscreen]}),r.createElement(qe.a,{onPress:o},r.createElement(a.a,{style:[ia.fullscreen]})),r.createElement(a.a,{key:"flyout",style:[ia.root,{top:t,right:n,width:i}]},s))}var ia=g.a.create({fullscreen:{position:"absolute",top:0,left:0,right:0,bottom:0},root:{position:"absolute",width:"100%",height:"auto",margin:0,display:"flex",boxShadow:"0px 5px 6px rgba(0, 0, 0, 0.2), 0px 3px 16px rgba(0, 0, 0, 0.12), 0px 9px 12px rgba(0, 0, 0, 0.14)"}}),oa=0;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function sa(e){var t=e.top,n=e.right,a=e.width,i=e.maxHeight,o=e.items,s=e.selectedItem,c=e.onChange,l=e.close,u=r.useMemo((function(){return"flyout_id_"+ ++oa}),[]),d=r.useContext(Nn).NativeFlyoutManager;r.useEffect((function(){return d.registerFlyout(u,l),function(){return d.unregisterFlyout(u)}}),[l,u,d]);return r.createElement(aa,{top:t,right:n,width:a,onClose:l},r.createElement(gr.Provider,{value:ca},r.createElement(fr,{items:o,top:t,maxHeight:i,selectedItem:s,onChange:c,onItemPress:function(e){e.preventDefault(),e.stopPropagation()},close:l})))}var ca=g.a.create({list:{backgroundColor:"#FAFAFA"},itemWrapper:{display:"flex",flexDirection:"row",height:50,alignItems:"center",paddingRight:10},itemWrapperSelected:{display:"flex",flexDirection:"row",height:50,alignItems:"center"},backWrapper:{paddingLeft:4},title:{fontSize:16,color:"black",flexGrow:1},separator:{},icon:{display:"flex",width:44,height:50,alignItems:"center",justifyContent:"center"},selectedIconWrapper:{height:44,width:44,alignItems:"center",justifyContent:"center"},listItemIcon:{color:"#002050",fontSize:20},commandIconContainer:{alignItems:"center",justifyContent:"center",width:40}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function la(e){var t=e.close,n=e.executeCommand,a=e.globalCommands,i=r.useMemo((function(){return function e(t){if(!t||!t.length)return null;return t.map((function(t,n){return{text:t.LabelText,value:n.toString(),icon:t.Icon,items:e(t.Children)}}))}(a)}),[]),o=r.useCallback((function(e){t(),n(a[e])}),[t,n,a]);return r.createElement(sa,{top:4,right:4,width:205,items:i,onChange:o,close:t,selectedItem:null})}var ua=n("hgSA"),da=Object(s.__assign)({headerIconColor:"white",textColor:"white"},Ye({ios:{headerColor:"#002050"},android:{headerColor:"#001433"}})),pa={headerColor:"#FFF",headerIconColor:"#605E5C",textColor:"black"},ga=r.createContext({}),ha=r.createContext({}),ma=[Qr.A,Xr.c,Xr.b,"Web.NavBar.Back_Caption",ct.U,ra.j,At.d];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function fa(){var e=Object(ae.a)(ma);return r.useMemo((function(){return{save:e[Xr.c],discard:e[Xr.b],sitemapLabel:e[Qr.A],backLabel:e["Web.NavBar.Back_Caption"],searchLabel:e[ct.U],quickCreateMenuLabel:e[ra.j],moreCommands:e[At.d]}}),[e])}var ba=r.memo((function(e){var t=e.isRootPage,n=e.navigateBack,a=e.navigateBackToRoot,i=e.routeIndex,o=Object(u.c)(),s=r.useContext(Hr),c=$r(),d=fa(),p=Object(u.d)((function(e){return Object(ge.c)(e,l.Mb)})),g=r.useCallback((function(){return o(Object(zr.a)(""))}),[o]),h=function(e){var t=Object(u.c)(),n=r.useCallback((function(){return t(Object(ta.c)())}),[t]),a=Object(u.d)(ea.c);e<3&&(a=!1);var i=Object(ae.a)(na),o=i&&Object(te.c)(i,"UCI_LongPressHome_Hint")||"Press and hold to go home. Tap to dismiss this message";return r.useMemo((function(){return{onPress:n,shouldRenderTooltip:a,text:o}}),[o,n,a])}(i),m=Cr(!1),f=m[0],b=m[1],v=m[2],y=function(){var e=Jn(wt.d),t=e.executeCommand,n=e.commands;return[Zn(t,null),n]}(),_=y[0],C=y[1];return r.createElement(ha.Provider,{value:d},r.createElement(ga.Provider,{value:t?da:pa},r.createElement(Y,{backgroundColor:t?da.headerColor:pa.headerColor,barStyle:t?"light-content":"dark-content",animated:!0}),r.createElement(Gr,{toggleSiteMap:s.toggleSidebar,toggleGlobalCommandsFlyout:C&&!!C.length&&b,navigateBack:!t&&n,navigateBackToRoot:a,openSearchPage:p?null:g,quickCreateMenu:c,backButtonTooltip:h}),f&&r.createElement(ua.a,{name:"GlobalCommandsFlyout"},r.createElement(la,{executeCommand:_,globalCommands:C,close:function(){return v(!1)}}))))})),va=n("r529"),ya=n("KzL8"),_a=n("A+5I"),Ca=n("FOhB"),Sa=n("JyJQ");function Oa(e){var t=e.pageId,n=e.definition,i=e.isTopPage,o=null;if(e.error)o=r.createElement(Sa.a,null);else if(i&&n){var s=n.getRootComponent();o=r.createElement(Ca.a,{pageType:n.getName(),pageId:t},r.createElement(s,{id:t}))}return r.createElement(a.a,{style:ja.wrapper},o)}function Ia(e){return!e.isCommandShelfRendered||bn()?r.createElement(_a.a,{globalNotificationsViewStyle:{marginBottom:"env(safe-area-inset-bottom)"}}):r.createElement(_a.a,{key:"globalNotificationList"})}var ja=g.a.create({wrapper:{flexGrow:1,flexBasis:0,userSelect:"auto",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}}),Pa=r.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=e.pageId,n=e.isRootPage,a=e.isTopPage,i=e.displayPage,o=e.definition,s=e.routeIndex,c=e.navigateBack,l=e.navigateBackToRoot,u=e.error,d=r.useState(0),p=d[0],g=d[1],h=r.useState(!1),m=h[0],f=h[1];return r.createElement(r.Fragment,null,r.createElement(Oa,{key:t,pageId:t,definition:i&&o,isTopPage:a,error:u}),a&&r.createElement(ua.a,{name:"GlobalNotificationBar"},r.createElement(x.a.View,{onLayout:function(e){var t=e.nativeEvent.layout.height;p!==t&&g(t)}},r.createElement(Ia,{key:"globalNotificationList",isCommandShelfRendered:m}))),a&&r.createElement(ua.a,{name:"NativeCommandManager"},r.createElement(ir,{key:"commanding",setCommandShelfRendered:f})),r.createElement(En,{paddingBottom:p}),r.createElement(ba,{isRootPage:n,navigateBack:c,navigateBackToRoot:l,routeIndex:s}))})),xa=function(e){function t(t){var n=e.call(this,t)||this;return n._isCurrentlySwiping=!1,n._pageAnimationProgress=new x.a.Value(0),n._shouldSetPanResponder=function(e){if(!n.props.canSwipeBack)return!1;var t=e.nativeEvent.pageX;return!((yn.a.isRTL?p.a.get("window").width-t:t)>50)&&n.props.isActive},n._keepPageOnScreen=function(){n._animate(0,(function(){}))},n._closePageAndNavigateBack=function(){n._closePage(n.props.onBeforeNavigateBack,n.props.onNavigateBack)},n._closePageAndNavigateToRoot=function(){n._closePage((function(){return n.props.onBeforeNavigateBack(!0)}),(function(){return n.props.onNavigateBack(!0)}))},n._closePage=function(e,t){n.props.isRootPage||e().then((function(e){e?n._animate(1,(function(){t(),n._pageAnimationProgress.setValue(0)})):n._keepPageOnScreen()}))},n.state={displayPage:t.isRootPage},n._panResponder=_n.a.create({onStartShouldSetPanResponder:n._shouldSetPanResponder,onMoveShouldSetPanResponder:n._shouldSetPanResponder,onPanResponderGrant:function(e,t){n._isCurrentlySwiping=!0},onPanResponderMove:function(e,t){var r=p.a.get("window").width,a=(yn.a.isRTL?r+t.dx:t.dx)/r;n._pageAnimationProgress.setValue(yn.a.isRTL?1-a:a)},onPanResponderTerminationRequest:function(e,t){return!0},onPanResponderRelease:function(e,t){if(n._isCurrentlySwiping){var r=yn.a.isRTL,a=Math.abs(t.vx)>.8,i=r?t.vx<0:t.vx>0,o=p.a.get("window").width/2;i&&a||(r?t.moveX<=o:t.moveX>=o)?n._closePageAndNavigateBack():n._keepPageOnScreen()}n._isCurrentlySwiping=!1},onPanResponderTerminate:function(e,t){}}),n}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this._pageAnimationProgress.setValue(1),this.props.isRootPage?this._pageAnimationProgress.setValue(0):this._animate(0,(function(){e._pageAnimationProgress.setValue(0),e.setState({displayPage:!0})}),400)},t.prototype._animate=function(e,t,n){void 0===n&&(n=200),x.a.timing(this._pageAnimationProgress,{toValue:e,duration:n,easing:Re.a.out(Re.a.exp)}).start(t)},t.prototype.render=function(){var e=this.props,t=e.canSwipeBack,n=e.isNextOnStack,i=e.isTopPage,o=e.isActive,c=e.isRootPage,l=e.route,u=e.definition,d=e.error,p=yn.a.isRTL;if(!c&&!n&&!o)return null;var h=p?-1:1;return r.createElement(a.a,Object(s.__assign)({},o&&t&&this._panResponder.panHandlers,{style:g.a.absoluteFill}),r.createElement(x.a.View,{style:[Ea.pageContainer,{transform:[{translateX:this._pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:n?[-10*h+"%","0%"]:["0%",100*h+"%"],extrapolate:"clamp"})}]}]},r.createElement(vt,{pageId:l},r.createElement(Pa,{error:d,pageId:l,isRootPage:c,definition:this.state.displayPage&&u,isTopPage:i,displayPage:this.state.displayPage,navigateBack:this._closePageAndNavigateBack,navigateBackToRoot:this._closePageAndNavigateToRoot,routeIndex:this.props.routeIndex}))),!o&&r.createElement(x.a.View,{pointerEvents:"none",style:[Ea.darkOverlay,{opacity:this._pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:[1,0],extrapolate:"clamp"})}]}))},t}(r.Component),Ea=g.a.create({pageContainer:Object(s.__assign)(Object(s.__assign)({},g.a.absoluteFillObject),{boxShadow:"0px 0px 20px rgba(0,0,0,0.35)",backgroundColor:"#ffffff"}),darkOverlay:Object(s.__assign)(Object(s.__assign)({},g.a.absoluteFillObject),{backgroundColor:"rgba(0,0,0,0.2)"})}),Ta=n("uGUB");function wa(e){var t=e.commandPaneDescriptor,n=e.closeSitemap;return t?r.createElement(a.a,{key:"sitemap-commands",style:Aa.sitemapCommandPaneSafeAreaView,accessibilityRole:"toolbar",accessibilityLabel:t.commandsLabel},r.createElement(a.a,{key:"sitemap-commands-upper"},r.createElement(_.b,{size:1,icon:C.a.Cancel,color:"transparent",onPress:function(){return n()},"data-keyboard-tab":"first",accessibilityRole:"button",key:"hidden",accessibilityLabel:t.hiddenButtonLabel,style:Aa.hiddenIcon,testID:"sitemap-close"}),t.upperCommands&&t.upperCommands.map((function(e,t){return r.createElement(_.b,{icon:e.icon.value,color:"#777777",size:20,type:e.icon.type,key:t,onPress:function(){n(e.action)},accessibilityLabel:e.label,style:Aa.upperCommandIconView,"aria-haspopup":!0,accessibilityRole:"button",testID:"sitemap-command-"+e.label})}))),r.createElement(a.a,{key:"sitemap-commands-lower"},t.lowerCommands&&t.lowerCommands.map((function(e,t){return r.createElement(_.b,{key:t,icon:e.icon.value,color:"#E1E1E1",size:"android"===Ke()?22:25,type:e.icon.type,onPress:function(){n(e.action)},accessibilityLabel:e.label,style:Aa.lowerCommandIconView,"aria-haspopup":!0,accessibilityRole:"button",testID:"sitemap-command-"+e.label})})))):null}var Aa=g.a.create({upperCommandIconView:{backgroundColor:"#E1E1E1",height:42,width:42,alignItems:"center",justifyContent:"center",borderRadius:42,borderStyle:"solid",borderWidth:.5,borderColor:"rgba(142, 142, 146, 0.5)",marginVertical:10},lowerCommandIconView:{height:50,width:50,alignItems:"center",justifyContent:"center"},sitemapCommandPaneSafeAreaView:{alignItems:"center",flexDirection:"column",height:"100%",justifyContent:"space-between",width:64},hiddenIcon:{position:"absolute",opacity:0}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Fa(e){var t=e.areaSwitcherDescriptor;if(!t)return null;var n=t.action,o=t.title,s=t.titleInitials,c=t.titleColor,l=t.areaCount,u=t.label;return l<=1?null:r.createElement(E.a,{"data-keyboard-tab":"last",onPress:n,style:Na.wrapperView,accessibilityRole:"button","aria-haspopup":!0,accessibilityLabel:u,testID:"sitemap-area-switcher","data-id":"sitemap-areaSwitcher-expand-btn"},r.createElement(a.a,{style:[Na.leftIconView,{backgroundColor:c}]},r.createElement(i.a,{style:Na.leftIconText},s)),r.createElement(a.a,{style:Na.titleView},r.createElement(i.a,{numberOfLines:1,style:Na.titleText},o),r.createElement(a.a,{style:Na.rightIconView},r.createElement(_.a,{icon:C.a.ScrollUpDown,size:12,color:"#605E5C",fontWeight:"600"}))))}var Na=g.a.create({wrapperView:{backgroundColor:"#FFFFFF",alignItems:"center",flexDirection:"row",height:44,alignSelf:"flex-end",width:"100%"},leftIconView:{alignItems:"center",justifyContent:"center",height:25,width:25,marginStart:16,marginEnd:10,borderRadius:4},leftIconText:{color:"#FFFFFF",fontSize:17},titleView:{flexDirection:"row",justifyContent:"space-between",flexGrow:1,maxWidth:"CALC(100% - 51px)"},rightIconView:{marginHorizontal:18,justifyContent:"center"},titleText:{color:"#323130",fontSize:17,fontWeight:"500",maxWidth:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ka(e){var t=e.subArea,n=h();if(!t)return null;var o=t.title,s=t.icon,c=t.subAction;return r.createElement(E.a,{onPress:t.action,style:[Ra.sitemapSubAreaWrapperView,Ra.sitemapSubAreaWrapperViewHomePane],accessibilityLabel:o,testID:"sitemap-subarea-home"},r.createElement(a.a,{style:Ra.homePaneRowView},r.createElement(a.a,{style:Ra.sitemapSubAreaIconView},r.createElement(_.a,{type:s.type,icon:s.value,color:"#828282",size:19})),r.createElement(i.a,{style:[Ra.subAreaTitle,{maxWidth:"calc(100% - 48px)"}]},o)),c?r.createElement(E.a,{onPress:c.action,style:Ra.subActionTouchableOpacity,accessibilityRole:"link",accessibilityLabel:c.title,accessible:!0,ref:n,testID:"sitemap-subarea-apps"},r.createElement(a.a,{style:Ra.subActionTitleWrapper},r.createElement(i.a,{style:Ra.subActionTitle},c.title)),r.createElement(a.a,{style:Ra.subActionIconWrapper},r.createElement(_.a,{size:15,icon:c.icon.value,type:c.icon.type,color:"#2266E3",flipInRtl:c.icon.flipInRtl,fontWeight:"600"}))):null)}function Ma(e){var t=e.subArea,n=e.isSelected,o=e.forceAccessible;if(!t)return null;var s=t.title,c=t.icon,l=n?"#2266E3":"#828282",u=n?"#2266E3":"#323130";return r.createElement(E.a,{"data-keyboard-nav":!0,onPress:t.action,style:Ra.sitemapSubAreaWrapperView,accessibilityLabel:s,"aria-selected":n,accessible:n||o,accessibilityState:{selected:n},testID:"sitemap-subarea-"+t.id,"data-id":"sitemap-entity-"+t.id},r.createElement(a.a,{style:Ra.sitemapSubAreaIconView},r.createElement(_.a,{type:c.type,icon:c.value,color:l,size:19})),r.createElement(i.a,{numberOfLines:1,style:[Ra.subAreaTitle,{color:u}]},s))}function Da(e){var t=e.subAreaList,n=t.selectedSubAreaId;return r.createElement(zt.a,{renderScrollComponent:Yt,sections:t.subAreaList,renderItem:function(e){var a=e.item;return a.subAction?r.createElement(ka,{subArea:a}):r.createElement(Ma,{subArea:a,isSelected:n===a.id,forceAccessible:!n&&a.id===t.subAreaList[1].data[0].id})},renderSectionHeader:function(e){var t=e.section;return t.title&&r.createElement(i.a,{style:Ra.subAreaListText},t.title)},keyExtractor:function(e){return e.id},stickySectionHeadersEnabled:!1})}var Ra=g.a.create({sitemapSubAreaWrapperView:{width:"100%",height:44,flexDirection:"row",alignItems:"center"},sitemapSubAreaWrapperViewHomePane:{justifyContent:"space-between"},sitemapSubAreaIconView:{width:48,height:"100%",alignItems:"center",justifyContent:"center"},subAreaListText:{color:"#212121",paddingHorizontal:16,paddingTop:13,paddingBottom:13,fontSize:15,width:"100%",borderTopColor:"#E6E6E6",borderTopWidth:.5},subActionTouchableOpacity:{height:"100%",alignItems:"center",marginEnd:12,flexDirection:"row",flexGrow:0,flexShrink:1,flexWrap:"wrap",overflow:"hidden",minWidth:75,justifyContent:"flex-end"},homePaneRowView:{flexDirection:"row",flexGrow:0,flexShrink:1,alignItems:"center",height:"100%",overflow:"hidden",minWidth:125},subActionTitle:{color:"#2266E3",fontSize:15,fontWeight:"500",textAlign:"right",maxHeight:"100%",maxWidth:"100%"},subActionTitleWrapper:{height:"100%",justifyContent:"center",maxWidth:"100%"},subActionIconWrapper:{marginStart:5},subAreaTitle:{lineHeight:20,fontSize:14,flexGrow:0,color:"#323130",marginRight:15,maxHeight:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function La(e){var t=e.subAreaList,n=e.commandPaneDescriptor,i=e.areaSwitcherDescriptor,o=e.isSitemapOpen,s=e.closeSitemap;if(!t)return null;var c="android"!==Ke()&&o;return r.createElement(a.a,{style:Ba.sitemapPresentationWrapperView,accessibilityState:{disabled:!o},"aria-hidden":!o,accessibilityLabel:t.navigationLabel,accessibilityRole:"menubar"},c&&r.createElement(Y,{hidden:!0}),r.createElement(d.a,{key:"command-pane-safe-area",style:Ba.commandPaneSafeAreaView},r.createElement(wa,{commandPaneDescriptor:n,closeSitemap:s})),r.createElement(d.a,{key:"sub-list-safe-area",style:Ba.sitemapPresentationSafeAreaView},r.createElement(Da,{key:"sub-area-list",subAreaList:t}),r.createElement(a.a,{key:"area-switcher-border",style:Ba.areaSwitcherTopBorder}),r.createElement(Fa,{key:"area-switcher",areaSwitcherDescriptor:i})))}var Ba=g.a.create({sitemapPresentationWrapperView:{flex:1,backgroundColor:"#e0e0e1",alignItems:"center",flexDirection:"row",height:"100%"},sitemapPresentationSafeAreaView:{flex:1,backgroundColor:"#FFFFFF",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingRight:0,paddingLeft:0},areaSwitcherTopBorder:{backgroundColor:"rgba(0, 0, 0, 0.05)",width:"100%",height:1},commandPaneSafeAreaView:{backgroundColor:"#F1F1F1",height:"100%",paddingRight:0}}),Va=n("GDI2"),Ga=n("3y+0"),Wa=n("cn0Y"),za=n("ZVHh"),Xa=n("m2it"),qa=n("UchK"),Ua=n("Cjse"),Ha=n("EZG4");function Ya(e){return e.VectorIcon?{type:1,value:e.VectorIcon}:{type:0,value:Object(Xa.b)(e.Entity,e.Url)}}function Ka(e,t,n){return e?{id:e.Id,title:e.Titles&&e.Titles.length&&e.Titles[0].Title,data:e.SubAreaIds.map((function(r){return function(e,t,n){return e?{id:e.Id,title:e.Titles&&e.Titles.length&&e.Titles[0].Title,icon:Ya(e),action:function(){t(Object(za.c)(e,!0,(function(){return n()}),{source:Wa.b.SiteMap}))}}:null}(e.SubAreas[r],t,n)}))}:null}var Qa=n.p+"resources/images/NativeHelp.svg?v=1.4.9962-v91onpremise",Za=n.p+"resources/images/NativeSettings.svg?v=1.4.9962-v91onpremise",Ja=n.p+"resources/images/NativeCloud.svg?v=1.4.9962-v91onpremise",$a=n.p+"resources/images/AndroidHelp.svg?v=1.4.9962-v91onpremise",ei=n.p+"resources/images/AndroidSettings.svg?v=1.4.9962-v91onpremise",ti=n.p+"resources/images/AndroidCloud.svg?v=1.4.9962-v91onpremise",ni=n("a/Ab"),ri=n("eAhn"),ai=n("bDDd"),ii=n("/C1z");var oi=n("DJr2"),si=n("5ZRb"),ci=n("zE7W");function li(e,t){return[{label:Object(te.c)(t,ra.o),icon:{type:0,value:C.a.MembersIcon},action:function(){return e(Object(An.d)(ni.c))}},{label:Object(te.c)(t,Qr.s),icon:{type:0,value:C.a.Recent},action:function(){return e(Object(An.d)(ni.d))}},{label:Object(te.c)(t,Qr.l),icon:{type:0,value:C.a.Pinned},action:function(){return e(Object(An.d)(ni.b))}}]}function ui(e,t){return[{label:Object(te.c)(t,ra.c),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?$a:Qa},action:function(){return e({type:"sitemap.help.action",sync:!0,execute:function(e){var t=e.dispatch,n=e.getState;Object(ri.a)(n())?t(Object(ai.b)()):t(Object(Te.a)(Object(ii.a)(n())))}})}},{label:Object(te.c)(t,ra.i),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?ti:Ja},action:function(){return e(Object(oi.openOfflineStatusDialogAction)(!0))}},{label:Object(te.c)(t,ra.m),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?ei:Za},action:function(){return e(Object(An.d)(ni.e))}}]}var di=n("1W5w"),pi=n("2n3f"),gi=n("wV3W"),hi=n("FbjN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function mi(e){var t=e.closeIcon,n=e.closeButtonLabel,a=e.onClosePressed;if("android"===Ke())return r.createElement(_.b,{key:"icon-button",icon:Jt,type:1,color:"#000000",size:16,flipInRtl:!0,onPress:a,accessibilityLabel:n,style:vi.nativeModalChromeTouchableOpacity,testID:"native-modal-close"});var i=t||C.a.CancelFilter;return r.createElement(_.b,{key:"icon-button",icon:i,color:"#605E5C",size:16,flipInRtl:!0,onPress:a,accessibilityLabel:n,style:vi.nativeModalChromeTouchableOpacity,testID:"native-modal-close"})}function fi(e){var t=e.closeIcon,n=e.onClosePressed,o=e.title,s=e.closeButtonLabel,c=e.children;return r.createElement(a.a,{style:vi.nativeModalChromeSafeAreaView,accessibilityRole:"dialog","aria-modal":!0,accessibilityLabel:o},r.createElement(Y,{barStyle:"dark-content",backgroundColor:"#FFF"}),r.createElement(d.a,{style:vi.nativeModalChromeTitleViewContainer},r.createElement(a.a,{style:vi.nativeModalChromeTitleView},r.createElement(mi,{closeIcon:t,onClosePressed:n,closeButtonLabel:s}),r.createElement(i.a,{key:"text",style:vi.nativeModalChromeTitleText,testID:"native-modal-title"},o),r.createElement(a.a,{key:"view",style:vi.nativeModalChromeSubActionView}))),r.createElement(Ht,null,c))}var bi="android"===Ke()?56:44,vi=g.a.create({nativeModalChromeSafeAreaView:Object(s.__assign)({flex:1},Ye({android:{backgroundColor:"#FFF"},ios:{backgroundColor:"#F3F2F1"}})),nativeModalChromeTitleViewContainer:{paddingBottom:0,backgroundColor:"#FFFFFF",borderBottomColor:"#C8C8C8",borderBottomWidth:xt.a,position:"relative",zIndex:1,shadowRadius:1,shadowColor:"rgba(0,0,0,0)"},nativeModalChromeTitleView:Object(s.__assign)({flexDirection:"row",height:bi,alignItems:"center",flex:0,flexBasis:bi,justifyContent:"space-between"},Ye({android:{justifyContent:"flex-start"}})),nativeModalChromeTouchableOpacity:{height:bi,width:bi,justifyContent:"center",alignItems:"center"},nativeModalChromeTitleText:Object(s.__assign)({fontWeight:"500",color:"#000",fontSize:17},Ye({android:{color:"#605E5C",fontSize:20,marginLeft:16}})),nativeModalChromeSubActionView:{height:bi,width:bi}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function yi(){return r.createElement(a.a,{style:_i.separatorWrapper},r.createElement(a.a,{style:_i.separator}))}var _i=g.a.create({separator:Object(s.__assign)({height:0,borderBottomColor:"#E6E6E6",borderBottomWidth:xt.a,marginStart:16},Ye({android:{marginHorizontal:16}})),separatorWrapper:{backgroundColor:"#FFF"}}),Ci=n.p+"resources/images/AndroidCheckmark.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Si(){return"android"===Ke()?r.createElement(_.a,{color:"#0078D4",size:17,icon:Ci,type:1}):r.createElement(_.a,{color:"#2266E3",size:17,icon:C.a.ForwardDisable})}function Oi(e){var t=e.area;return r.createElement(E.a,{onPress:t.action,style:ji.rowWrapperView,accessibilityRole:"menuitem",accessibilityState:{checked:t.isSelected},accessibilityLabel:t.title,"aria-checked":t.isSelected,testID:"sitemap-area-"+t.title,"data-id":"areaswitcherflyout-"+t.id},r.createElement(i.a,{numberOfLines:1,style:t.isSelected?ji.rowTextStyleSelected:ji.rowTextStyle},t.title),t.isSelected?r.createElement(Si,null):null)}function Ii(e){var t=e.title,n=e.closeAction,a=e.areaList,i=e.closeButtonLabel;return r.createElement(fi,{title:t,onClosePressed:n,closeButtonLabel:i},r.createElement(Et.a,{accessibilityRole:"menu",accessibilityLabel:t,data:a,renderItem:function(e){var t=e.item;return r.createElement(Oi,{area:t})},ItemSeparatorComponent:function(e){return r.createElement(yi,null)}}))}var ji=g.a.create({rowWrapperView:Object(s.__assign)({flexDirection:"row",height:50,alignContent:"center",alignItems:"center",paddingHorizontal:16,backgroundColor:"#FFFFFF",justifyContent:"space-between"},Ye({android:{height:47.5}})),rowTextStyle:{fontSize:17,color:"#323130"},rowTextStyleSelected:{fontSize:17,color:"#2266E3"},separator:{height:1,backgroundColor:"rgba(0, 0, 0, 0.1)",marginStart:16},separatorFinal:{height:1,backgroundColor:"rgba(0, 0, 0, 0.1)",marginStart:0},separatorWrapper:{backgroundColor:"#FFF"}}),Pi=n("0Td4"),xi=n("pJ3X");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ei(e){var t=e.modalId,n=e.children,a=Object(u.d)((function(e){return Object(Pi.b)(e,t)})),i=Object(u.c)(),o=r.useCallback((function(){return i(Object(An.c)(t))}),[i,t]);return r.createElement(xi.d,{closeAction:o,id:t,isModalOpen:a},n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Ti,wi,Ai=[Qr.h,Qr.i,ci.b],Fi=function(e,t){var n=Object(Ga.b)(e);if(!Ti||wi!==n){var r=Object(Va.b)(e);if(!r)return Ti;var a=r.AreaIds.map((function(e){var a=r.Areas[e];return{title:a.Titles&&a.Titles[0].Title,isSelected:e===n,action:function(){t(Object(di.d)(a.Id)),t(Object(pi.a)(a.Id,Wa.b.SiteMapSubArea)),t(Object(An.c)(ni.a))},id:a.Id}}));wi=n,Ti=a}return Ti};function Ni(){var e=Object(u.c)(),t=Object(ae.a)(Ai),n=Object(u.d)((function(t){return Fi(t,e)})),a=r.useCallback((function(){return e(Object(An.c)(ni.a))}),[e]),i=Object(te.c)(t,Qr.h),o=Object(te.c)(t,ci.b);return r.createElement(Ei,{modalId:ni.a},r.createElement(Ii,{title:i,closeAction:a,areaList:n,closeButtonLabel:o}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ki(e){var t=e.emptyViewDescriptor;return r.createElement(a.a,{style:Ri.emptyView},r.createElement(_.a,{icon:t.icon,size:80,color:"rgba(0, 20, 51, 0.2)"}),r.createElement(i.a,{style:Ri.emptyViewTitle},t.title),r.createElement(i.a,{style:Ri.emptyViewText},t.text))}function Mi(e){var t=e.recentItem,n=e.handleAction,o=e.handleSubAction,s=e.resourceStrings,c=e.getAriaLabel,l=r.useCallback((function(){return n(t)}),[n,t]),u=r.useCallback((function(){return o(t)}),[o,t]);return r.createElement(r.Fragment,null,r.createElement(a.a,{style:Ri.renderRowWrapper},r.createElement(E.a,{style:Ri.touchableOpacity,onPress:l,accessibilityRole:"menuitem",accessibilityLabel:t.Title,testID:"recent-"+t.ObjectId},r.createElement(i.a,{numberOfLines:1,style:Ri.renderRowTitleText},t.Title)),r.createElement(_.b,{color:"#2266E3",size:17,icon:t.PinStatus?C.a.Unpin:C.a.Pinned,onPress:u,style:Ri.renderRowSubActionView,accessibilityLabel:c(s,t),accessibilityRole:"button",testID:"recent-pin-"+t.ObjectId})))}function Di(e){var t=e.recents,n=e.title,a=e.closeAction,i=e.closeButtonLabel,o=e.handleAction,s=e.handleSubAction,c=e.resourceStrings,l=e.getAriaLabel,u=e.emptyViewDescriptor;return r.createElement(fi,{title:n,onClosePressed:a,closeButtonLabel:i},r.createElement(Et.a,{data:t,accessibilityRole:"menu",keyExtractor:function(e){return e.ObjectId.guid},renderItem:function(e){var t=e.item;return r.createElement(Mi,{recentItem:t,handleAction:o,handleSubAction:s,resourceStrings:c,getAriaLabel:l})},ItemSeparatorComponent:function(e){return r.createElement(yi,null)},ListEmptyComponent:r.createElement(ki,{emptyViewDescriptor:u})}))}var Ri=g.a.create({emptyView:{marginTop:92,alignItems:"center"},emptyViewTitle:{color:"#000000",fontSize:17,marginTop:36,fontWeight:"500",textAlign:"center"},emptyViewText:{color:"#8E8E8E",fontSize:15,marginTop:12,marginHorizontal:52,textAlign:"center"},touchableOpacity:{flexDirection:"row",height:"100%",alignItems:"center",flexGrow:1,flexShrink:1,paddingStart:16},renderRowWrapper:Object(s.__assign)({flexDirection:"row",alignContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",justifyContent:"space-between"},Ye({ios:{height:50},android:{height:47.5}})),renderRowTitleText:Object(s.__assign)({fontSize:17},Ye({ios:{color:"#323130"},android:{color:"#222222"}})),renderRowSubActionView:{width:48,height:"100%",alignItems:"center",justifyContent:"center"}}),Li=n("pWhJ"),Bi=n("Ff8i"),Vi=n("q+pN");function Gi(e){return{type:"sitemap.pin.unpin.recent",sync:!0,execute:function(t){var n=t.dispatch;t.getState;n(e.PinStatus?Object(Vi.d)(e):Object(Vi.c)(e))}}}var Wi=n("E705"),zi=n("miNs"),Xi=n("lU69"),qi=Object(Xi.a)();function Ui(e){return e&&"true"===e.getAttribute("data-keyboard-nav")}function Hi(e,t){e&&(t&&(t.tabIndex=-1),e.tabIndex=0,e.focus())}function Yi(e){var t=e.children,n=e.closeSitemap,a=r.createRef();return r.createElement(r.Fragment,null,r.createElement(Xt.a,{id:qi,key:"SitemapAccessibilityManager",ref:a,style:Ki.viewStyle,onKeyDown:function(e){!function(e,t,n){void 0===t&&(t=document);var r=e.target;if(r)switch(Object(Wi.e)(e.nativeEvent)){case zi.a.DownArrow:Ui(r)&&Hi(function(e){var t=e.parentElement.nextElementSibling;if(!t)return null;var n=t.querySelector('[data-keyboard-nav="true"]');if(n)return n;var r=t.nextElementSibling&&t.nextElementSibling.nextElementSibling;return r&&r.querySelector('[data-keyboard-nav="true"]')}(r),r);break;case zi.a.UpArrow:Ui(r)&&Hi(function(e){var t=e.parentElement.previousElementSibling;if(!t)return null;var n=t.querySelector('[data-keyboard-nav="true"]');if(n)return n;var r=t.nextElementSibling&&t.previousElementSibling.previousElementSibling;return r&&r.querySelector('[data-keyboard-nav="true"]')}(r),r);break;case zi.a.Tab:if(e.shiftKey){if("first"===r.getAttribute("data-keyboard-tab")){var a=t.querySelector('[data-keyboard-tab="last"]');a&&(a.focus(),e.preventDefault())}}else if("last"===r.getAttribute("data-keyboard-tab")){var i=t.querySelector('[data-keyboard-tab="first"]');i&&(i.focus(),e.preventDefault())}break;case zi.a.Escape:n()}}(e,a.current&&yt.findDOMNode(a.current),n)}},t),r.createElement(W.a,{key:"accessibilityComponent"+qi,rootElementId:qi,shouldManageFocus:!0,isModal:!0}))}var Ki={viewStyle:{height:"100%"}},Qi=[Qr.s,Qr.l,Qr.r,Qr.z,ci.b,Qr.k,Qr.j];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Zi(e,t){var n=Object(te.c)(e,Qr.l),r=Object(te.c)(e,t.PinStatus?Qr.z:Qr.r);return String.format(r,n)}function Ji(e){var t=e.closeSitemap,n=Object(u.c)(),a=Object(u.d)((function(e){return Object(Li.a)(e,20)}),Kn.e),i=Object(u.d)(Bi.g,Kn.e),o=Object(ae.a)(Qi),s=r.useCallback((function(){return n(Object(An.c)(ni.d))}),[n]),c=r.useCallback((function(){return n(Object(An.c)(ni.b))}),[n]),l=r.useCallback((function(e){return n(function(e,t){return{type:"sitemap.navigate.recent",sync:!0,execute:function(n){var r=n.dispatch;r(Object(za.d)(e,!0,(function(){r(Object(An.c)(ni.d)),r(Object(An.c)(ni.b)),t()}),Wa.b.Other))}}}(e,t))}),[t,n]),d=r.useCallback((function(e){return n(Gi(e))}),[n]),p=r.useCallback((function(e){var t,r,a;n(Gi(e)),e===i[i.length-1]&&(t=ni.b,r=document.getElementById(t),(a=r&&r.querySelector('[tabindex="0"]'))&&a.focus())}),[n,i]),g=Object(te.c)(o,ci.b),h=r.useMemo((function(){return function(e){var t=Object(te.c)(e,Qr.s),n=Object(te.c)(e,Qr.j),r=n&&t&&String.format(n,t);return{icon:C.a.Pinned,title:Object(te.c)(e,Qr.l),text:r}}(o)}),[o]),m=r.useMemo((function(){return function(e){return{icon:C.a.Recent,title:Object(te.c)(e,Qr.s),text:Object(te.c)(e,Qr.k)}}(o)}),[o]);return r.createElement(r.Fragment,null,r.createElement(Ei,{modalId:ni.b},r.createElement(Di,{recents:i,title:Object(te.c)(o,Qr.l),closeAction:c,handleAction:l,handleSubAction:p,resourceStrings:o,closeButtonLabel:g,getAriaLabel:Zi,emptyViewDescriptor:h})),r.createElement(Ei,{modalId:ni.d},r.createElement(Di,{recents:a,title:Object(te.c)(o,Qr.s),closeAction:s,handleAction:l,handleSubAction:d,resourceStrings:o,closeButtonLabel:g,getAriaLabel:Zi,emptyViewDescriptor:m})))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var $i,eo,to,no,ro,ao,io,oo=[ra.f,Qr.s,Qr.l,ra.m,ra.o,ra.c,ra.i,Ha.h,Qr.a,si.d,ci.b],so=function(e,t,n,r,a,i){var o=!1;return eo===e&&to===t&&no===n&&ro===r&&ao===a&&Object(Kn.e)(io,i)||(eo=e,to=t,no=n,ro=r,ao=a,io=i,o=!0),o},co=function(){var e,t,n;return function(r,a,i){var o=Object(Ga.b)(r),s=Object(Ga.c)(r);if(!e||t!==o||n!==s){var c=Object(te.b)(r,Ha.h),l=Object(Va.b)(r);if(!l)return e;var u=l.Areas[o],d=u.GroupIds.map((function(e){return Ka(u.Groups[e],a,i)})),p=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){return{id:"sitemap-home-group",title:void 0,data:[{id:"sitemap-home-subarea",icon:{type:0,value:C.a.Home},title:Object(te.b)(t,ra.f),action:function(){e(Object(qa.b)()),n()},subAction:{title:Object(te.b)(t,Qr.a),icon:{type:0,value:C.a.Forward,flipInRtl:!0},action:function(){e(Object(Ua.a)(void 0,{source:Wa.b.SiteMap})),n()}}}]}}(a,r,i);d.unshift(p),t=o,n=s,e={subAreaList:d,navigationLabel:c,selectedSubAreaId:s}}return e}}(),lo=function(){var e,t;return function(n,r){var a=Object(Ga.b)(n);if(!e||t!==a){var i=Object(gi.a)(n),o=Object(Va.b)(n);if(!o)return e;var s=o.Areas[a],c=s.Titles&&s.Titles.length&&s.Titles[0].Title,l=o.AreaIds.indexOf(a),u=String.format(Object(te.b)(n,Qr.i)||"",c);t=a,e={title:c,label:u,action:function(){return r(Object(An.d)(ni.a))},titleInitials:Object(hi.b)(c),titleColor:Object(hi.a)(l,i),areaCount:o.AreaIds.length}}return e}}();function uo(e){var t=e.closeSitemap,n=Object(u.c)(),a=Object(ae.a)(oo),i=Object(u.d)((function(e){return co(e,n,t)})),o=Object(u.d)((function(e){return lo(e,n)})),s=r.useMemo((function(){return function(e,t){return{hiddenButtonLabel:Object(te.c)(t,ci.b),upperCommands:li(e,t),lowerCommands:ui(e,t),commandsLabel:Object(te.c)(t,si.d)||qt.a}}(n,a)}),[n,a]),c=1===Object(u.d)(Ga.d);return so(i,o,c,t,n,a)&&($i=r.createElement(La,{subAreaList:i,commandPaneDescriptor:s,areaSwitcherDescriptor:o,isSitemapOpen:c,closeSitemap:t})),$i}function po(){var e=r.useContext(Hr);return r.createElement(r.Fragment,null,r.createElement(Yi,{closeSitemap:e.closeSidebar},r.createElement(uo,{closeSitemap:e.closeSidebar})),r.createElement(Ji,{closeSitemap:e.closeSidebar}),r.createElement(Ni,null))}var go=n("5Fed"),ho=n("hXUt");function mo(e){var t=e.children,n=e.menuContent,a=Object(u.c)(),i=Object(u.d)(Pe.g),o=1===Object(u.d)(Ga.d),s=r.useCallback((function(e,t,n){a(Object(di.f)(e?1:0)),t&&function(e){if(e){var t=document.querySelector('[data-keyboard-tab="first"]');t&&t.focus()}else{var n=document.querySelector('[data-id="navbutton"]');n&&n.focus()}}(e),a(e?Object(go.a)("sidebar_popup_id",n):Object(ho.a)("sidebar_popup_id"))}),[a]),c=Object(u.d)(Pi.a);return r.createElement(Yr,{isModalOpen:c,setExpandedState:s,isOpen:o,isRTL:i,menuContent:n,isDisabled:c},t)}var fo=n("NxDw"),bo=n("DgF7"),vo=n("CcDq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function yo(e,t){return!(!e||!t)&&(Object(bo.a)(t.getState())!==fo.a.Browser&&new vo.a(e,t).isOperationAvailableAndEnabled("navigateBackOutOfApp"))}function _o(e,t){e&&t&&new vo.a(e,t).navigateBackOutOfApp()}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Co="Settings_NativeApp_General_TermsOfUse",So="Settings_NativeApp_General_SessionDetails",Oo="Settings_NativeApp_Alert_Ok",Io="Settings_NativeApp_Screen_Close",jo=["Settings_NativeApp_SettingsScreenTitle","Settings_NativeApp_ProfileScreenTitle","Settings_NativeApp_Personal","Settings_NativeApp_Personal_TimeZone","Settings_NativeApp_Personal_RecordsPerPage","Settings_NativeApp_Personal_Calendar","Settings_NativeApp_Personal_CalendarDefaultView","Settings_NativeApp_Personal_CalendarView_Day","Settings_NativeApp_Personal_CalendarView_Week","Settings_NativeApp_Personal_CalendarView_Month","Settings_Privacy_Statement_Link_Online","Settings_NativeApp_Personal_WorkHours","Settings_NativeApp_Personal_WorkHours_Start","Settings_NativeApp_Personal_WorkHours_End","Settings_NativeApp_Device_Camera","Settings_NativeApp_Device","Settings_NativeApp_General","Settings_NativeApp_Device","Settings_NativeApp_Device_ImageResolution","Settings_NativeApp_Device_ImageResolution_Default","Settings_NativeApp_Device_LocationAndContent","Settings_NativeApp_Device_LocationAndContent_LegalNotice","Settings_NativeApp_Device_Microphone","Settings_NativeApp_Device_OfflineSync","Settings_NativeApp_Device_SavePhoto","Settings_NativeApp_Device_IncreaseToastDuration","Settings_NativeApp_Device_Video","Settings_NativeApp_General",Co,"Settings_NativeApp_General_PrivacyStatement",So,"Settings_NativeApp_Status_Init","Settings_NativeApp_Status_InitError","Settings_NativeApp_Status_Offline","Settings_NativeApp_Status_SaveError"],Po=["Settings_NativeApp_Alert_Title",Oo,"Settings_NativeApp_Alert_Cancel"],xo=n("HCuy"),Eo=n("tJMA"),To=n("8XVy"),wo=r.createElement(_.a,{icon:C.a.MembersIcon,size:38,color:"#777"}),Ao=function(e){var t=e.source?r.createElement(To.a,{style:Fo.picture,source:{uri:e.source}}):wo;return r.createElement(a.a,{style:Fo.pictureShadow},r.createElement(a.a,{style:Fo.pictureFrame},t))},Fo=g.a.create({pictureShadow:{marginTop:70,width:70,height:70,borderRadius:35,shadowColor:"#000",shadowOffset:{width:0,height:0},shadowRadius:1,shadowOpacity:.16},pictureFrame:{width:70,height:70,borderWidth:1,borderColor:"#c7c7cc",borderRadius:35,overflow:"hidden",backgroundColor:"#d1d1d6",justifyContent:"center",alignItems:"center"},picture:{width:70,height:70}}),No=g.a.create({container:{flex:1,alignItems:"stretch",justifyContent:"center"},innerContainer:{alignItems:"center",justifyContent:"center"},name:{fontSize:17,lineHeight:22,color:"#000",fontWeight:"600",marginTop:24},email:{fontSize:12,lineHeight:20,color:"#605E5C",marginTop:10},org:{fontSize:12,lineHeight:20,color:"#000",marginBottom:48},buttonContainer:{marginBottom:10,minWidth:275,minHeight:44,backgroundColor:"#fff",borderWidth:1,borderColor:"#e1e1e1",borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:0},shadowRadius:3,shadowOpacity:.1,alignItems:"center",justifyContent:"center"},buttonText:{color:"#ff3b30",lineHeight:15,fontSize:13,textAlign:"center"}}),ko=r.memo((function(e){var t=e.email,n=e.imageUri,o=e.name,s=e.onReconfigure,c=e.onSignOut,l=e.organizationName,u=e.reconfigureLabel,d=e.signOutLabel;return r.createElement(a.a,{style:No.container},r.createElement(a.a,{style:No.innerContainer},r.createElement(Ao,{source:n}),r.createElement(i.a,{style:No.name},o),r.createElement(i.a,{style:No.email},t),r.createElement(i.a,{style:No.org},l),r.createElement(E.a,{style:No.buttonContainer,onPress:c},r.createElement(i.a,{style:No.buttonText},d)),r.createElement(E.a,{style:No.buttonContainer,onPress:s},r.createElement(i.a,{style:No.buttonText},u))))})),Mo=[Eo.a,Eo.b],Do=r.memo((function(){var e=Object(u.c)(),t=r.useCallback((function(){return e(Object(xo.b)())}),[e]),n=r.useCallback((function(){return e(Object(xo.c)())}),[e]),a=Object(ae.a)(Mo),i={email:"",imageUri:"",name:Object(u.d)(Pe.t),organizationName:Object(u.d)(Vn.w),onSignOut:n,onReconfigure:t,reconfigureLabel:Object(te.c)(a,Eo.b),signOutLabel:Object(te.c)(a,Eo.a)};return r.createElement(ko,Object(s.__assign)({},i))})),Ro=["Settings_NativeApp_ProfileScreenTitle",Io],Lo=function(){var e=Object(u.c)(),t=Object(u.e)(),n=r.useContext(we.a),a=r.useCallback((function(){e(Object(An.c)(ni.c)),yo(n,t)&&_o(n,t)}),[e,t,n]),i=Object(ae.a)(Ro),o=Object(te.c)(i,"Settings_NativeApp_ProfileScreenTitle"),s=Object(te.c)(i,Io);return r.createElement(Ei,{modalId:ni.c},r.createElement(fi,{title:o,onClosePressed:a,closeButtonLabel:s},r.createElement(Do,null)))},Bo=function(e){function t(t){var n=e.call(this,t)||this;return n._isCurrentlySwiping=!1,n._keepPageOnScreen=function(){n._animate(1)},n._closePageAndNavigateBack=function(){n._animate(0,200,n.props.onNavigateBack)},n.state={pageAnimationProgress:new x.a.Value(0)},n._panResponder=_n.a.create({onStartShouldSetPanResponder:function(e){return!(e.nativeEvent.pageX>50)},onMoveShouldSetPanResponder:function(e){return!(e.nativeEvent.pageX>50)},onPanResponderGrant:function(e,t){n._isCurrentlySwiping=!0},onPanResponderMove:function(e,t){var r=p.a.get("window").width,a=1-t.dx/r;n.state.pageAnimationProgress.setValue(a)},onPanResponderTerminationRequest:function(e,t){return!0},onPanResponderRelease:function(e,t){if(n._isCurrentlySwiping){var r=Math.abs(t.vx)>.8,a=t.vx>0,i=p.a.get("window").width;a&&r||t.moveX>=i/2?n._closePageAndNavigateBack():n._keepPageOnScreen()}n._isCurrentlySwiping=!1},onPanResponderTerminate:function(e,t){}}),n}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){this._animate(1,400)},t.prototype._animate=function(e,t,n){void 0===t&&(t=200),x.a.timing(this.state.pageAnimationProgress,{toValue:e,duration:t,easing:Re.a.out(Re.a.exp)}).start((function(){n&&n({finished:!0})}))},t.prototype.render=function(){var e=this.props,t=e.backButtonLabel,n=e.children,i=e.title;return r.createElement(a.a,Object(s.__assign)({},this._panResponder.panHandlers,{style:g.a.absoluteFill}),r.createElement(x.a.View,{pointerEvents:"none",style:[Vo.darkOverlay,{opacity:this.state.pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:[0,1],extrapolate:"clamp"})}]}),r.createElement(x.a.View,{style:[Vo.pageContainer,{transform:[{translateX:this.state.pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:["100%","0%"],extrapolate:"clamp"})}]}]},r.createElement(fi,{closeIcon:C.a.LeftChevron,title:i,onClosePressed:this._closePageAndNavigateBack,closeButtonLabel:t},n)))},t}(r.Component),Vo=g.a.create({pageContainer:Object(s.__assign)(Object(s.__assign)({},g.a.absoluteFillObject),{boxShadow:"0px 0px 20px rgba(0,0,0,0.35)",backgroundColor:"#ffffff",zIndex:1}),darkOverlay:Object(s.__assign)(Object(s.__assign)({},g.a.absoluteFillObject),{backgroundColor:"rgba(0,0,0,0.2)",position:"absolute",top:0,left:0})}),Go=n("TmQE"),Wo=n("fvre"),zo=n("RBt5"),Xo=n("mjNO"),qo=function(){return r.createElement(a.a,{style:Uo.view,importantForAccessibility:"no-hide-descendants",accessibilityElementsHidden:!1},r.createElement(To.a,{source:{uri:'data:image/svg+xml;utf8,<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.22494 7.22494C9.52487 6.92502 10.0111 6.92502 10.3111 7.22494L14.9577 11.8716C15.2576 12.1715 15.2576 12.6578 14.9577 12.9577L10.3111 17.6043C10.0111 17.9043 9.52487 17.9043 9.22494 17.6043C8.92502 17.3044 8.92502 16.8181 9.22494 16.5182L12.975 12.7682C13.1702 12.5729 13.1702 12.2564 12.975 12.0611L9.22494 8.31107C8.92502 8.01115 8.92502 7.52487 9.22494 7.22494Z" fill="#C4C4C6"/></svg>'},style:Uo.image}))},Uo=g.a.create({view:{width:24,height:24,marginEnd:6},image:{width:24,height:24}});function Ho(e){var t=e.isFirst;return r.createElement(a.a,{style:[ns.topBorderContainer,{paddingStart:t?0:16}]},r.createElement(a.a,{style:ns.topBorder}))}function Yo(){return r.createElement(a.a,{style:ns.bottomBorder})}function Ko(e){var t=e.subtitle;return r.createElement(a.a,{style:ns.titleContainer},r.createElement(Qo,Object(s.__assign)({},e)),t?r.createElement(Zo,Object(s.__assign)({},e)):null)}function Qo(e){var t=e.disabled,n=e.label,o=e.value,s=e.labelStyle;return r.createElement(a.a,{style:ns.labelContainer},r.createElement(i.a,{style:[ns.label,s,t?ns.disabledLabel:{}],numberOfLines:1},n),o?r.createElement(i.a,{style:[ns.value,t?ns.disabledValue:{}],numberOfLines:1},o):null)}function Zo(e){var t=e.disabled,n=e.subtitle;return r.createElement(i.a,{style:[ns.subtitle,t?ns.disabledSubtitle:{}],numberOfLines:1},n)}function Jo(e){var t=e.renderAccessory;return r.createElement(a.a,{style:ns.accessoryContainer},t())}function $o(){return r.createElement(a.a,{style:ns.spacer})}function es(e){var t=e.disabled,n=e.onPress,i=e.showDisclosureIndicator,o=e.renderAccessory,c=e.label,l=void 0!==n,u=r.createElement(a.a,{style:ns.buttonContent},r.createElement(Ko,Object(s.__assign)({},e)),o&&r.createElement(Jo,Object(s.__assign)({},e)),i?r.createElement(qo,null):r.createElement($o,null));if(!l)return u;var d={accessible:!0,accessibilityLabel:c,accessibilityRole:"button"};return r.createElement(Xo.a,Object(s.__assign)({style:[ns.button],disabled:t,onPress:n,underlayColor:"#d9d9d9"},d),u)}function ts(e){var t=e.subtitle,n=e.isFirst,i=e.isLast,o={height:t?51:41};return r.createElement(a.a,{style:[ns.container,o]},r.createElement(Ho,{isFirst:n}),r.createElement(es,Object(s.__assign)({},e)),i&&r.createElement(Yo,null))}var ns=g.a.create({container:{backgroundColor:"transparent",alignItems:"stretch"},topBorderContainer:{alignSelf:"stretch",height:xt.a,backgroundColor:"#fff"},topBorder:{flex:1,backgroundColor:"#c7c7c9"},button:{flex:1,backgroundColor:"#fff"},buttonContent:{flex:1,flexDirection:"row",paddingStart:16,alignItems:"center",backgroundColor:"#fff"},highlight:{backgroundColor:"#d9d9d9"},titleContainer:{flex:1,justifyContent:"space-around",alignSelf:"stretch"},labelContainer:{flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row"},label:{color:"#000",fontSize:15,flexGrow:1,flexShrink:0},disabledLabel:{color:"#8e8e93"},value:{fontSize:15,color:"#8e8e93",textAlign:"right",flexGrow:1,flexShrink:1,marginStart:15},disabledValue:{color:"#aeaeb2"},subtitle:{color:"#8e8e93",fontSize:13},disabledSubtitle:{color:"#aeaeb2"},accessoryContainer:{marginStart:15},spacer:{width:10},bottomBorder:{alignSelf:"stretch",height:xt.a,backgroundColor:"#c7c7c9"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function rs(e){var t=e.render,n=e.isFirst,i=e.isLast,o=e.contentStyle;return r.createElement(a.a,{style:as.container},r.createElement(Ho,{isFirst:n}),r.createElement(a.a,{style:[as.content,o]},t()),i&&r.createElement(Yo,null))}var as=g.a.create({container:{backgroundColor:"transparent",alignItems:"stretch",minHeight:40},content:{flex:1,backgroundColor:"#fff",justifyContent:"center",paddingStart:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function is(e){var t=e.message;return r.createElement(a.a,{style:os.container},r.createElement(a.a,{style:os.toast},r.createElement(i.a,{style:os.text},t)))}var os=g.a.create({text:{fontSize:14,color:"#FFFFFF"},toast:{backgroundColor:"#222222",borderRadius:4,height:50,width:"100%",justifyContent:"center",paddingHorizontal:15},container:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"flex-end",zIndex:99999,padding:10}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ss(e){var t=e.type;switch(t){case 0:case 1:return r.createElement(I.a,{size:36,color:"#FFF"});case 2:case 3:return r.createElement(a.a,null,r.createElement(_.a,{color:"#FFF",size:36,icon:2===t?C.a.CheckMark:C.a.Cancel}));default:return null}}function cs(e){var t=e.text;return t?r.createElement(i.a,{style:ds.text},t):null}function ls(e){var t=e.useFadeInView,n=e.duration,i=e.children;return t?r.createElement(Rr,{duration:n,style:ds.overlay,pointerEvents:"box-none"},i):r.createElement(a.a,{style:ds.overlay,pointerEvents:"box-none"},i)}function us(e){var t=e.type,n=e.title,i=e.duration,o=e.closeAction,s=e.blockTouch,c=e.displayDelay,l="ios"===Ke();r.useEffect((function(){i&&o&&setTimeout((function(){return o()}),i)}),[o,i,t]);var u=r.useState(!c),d=u[0],p=u[1];return r.useEffect((function(){c&&setTimeout((function(){return p(!0)}),c)}),[c]),d?l||0===t?r.createElement(ls,{useFadeInView:s,duration:i},r.createElement(a.a,{style:n?ds.container:ds.containerNoTitle},r.createElement(ss,{type:t}),r.createElement(cs,{text:n})),s?r.createElement(Ot,{style:ds.touchBlocker}):null):r.createElement(is,{message:n}):null}var ds=g.a.create({overlay:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"center",zIndex:99999},touchBlocker:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0)"},container:{paddingTop:20,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:4,width:108,height:108,alignItems:"center"},containerNoTitle:{padding:0,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:4,width:100,height:100,alignItems:"center",justifyContent:"center"},text:{marginTop:12,fontSize:17,color:"#FFF",textAlign:"center"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ps(e){var t=e.title,n=e.textStyle;return r.createElement(i.a,{key:t,style:[fs.title,n],numberOfLines:1},t)}function gs(e){var t=e.section,n=e.textStyle,o=t.footer;if("function"==typeof o){var s=t.key+"-footer";return r.createElement(a.a,{key:s,style:fs.footerContainer},o())}return r.createElement(i.a,{key:o,style:[fs.footer,n]},o)}function hs(){return r.createElement(us,{type:0,blockTouch:!1})}function ms(e){var t=e.busy,n=e.disabled,i=e.textStyle,o=e.section,c=o.title,l=o.rows,u=o.footer,d=l.map((function(a,i){var o=0===i,c=i===l.length-1;if("CUSTOM"===a.type){var u={key:""+i,render:a.render,disabled:e.disabled||e.busy,isFirst:o,isLast:c};return r.createElement(rs,Object(s.__assign)({},u))}var d=Object(s.__assign)(Object(s.__assign)({},a),{isFirst:o,isLast:c,disabled:n||t});return r.createElement(ts,Object(s.__assign)({key:i},d))}));return r.createElement(a.a,{style:fs.container},c&&r.createElement(ps,{key:c,textStyle:i,title:c}),d,u?r.createElement(gs,Object(s.__assign)({key:"footer"},e)):null,t&&r.createElement(hs,null))}var fs=g.a.create({container:{alignItems:"stretch",marginBottom:28,position:"relative"},title:{marginStart:16,marginBottom:8,color:"#636366",fontSize:12,lineHeight:14},footerContainer:{alignSelf:"stretch"},footer:{marginTop:8,fontSize:12,color:"#636366",marginHorizontal:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function bs(e){var t=e.textStyle,n=e.title;return r.createElement(i.a,{key:n,style:[ys.title,t],numberOfLines:1},n)}function vs(e){var t=e.section,n=e.textStyle;return r.createElement(a.a,{key:t.key,style:ys.container},t.title&&r.createElement(bs,{textStyle:n,title:t.title}),t.render())}var ys=g.a.create({container:{alignItems:"stretch",marginBottom:40,position:"relative"},title:{marginStart:16,marginBottom:8,color:"#636366",fontSize:12,lineHeight:14}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _s(e){var t=e.data,n=e.textStyle,a=e.scrollViewProps,i=e.style,o=e.disabled,c=e.busy,l=t.map((function(e,t){switch(e.type){case"CUSTOM":return r.createElement(vs,{key:"custom-"+t.toString(),section:e,textStyle:n,disabled:e.disabled||o,busy:e.busy||c});case"SECTION":return r.createElement(ms,{key:e.title||t,section:e,textStyle:n,disabled:e.disabled||o,busy:e.busy||c})}}));return r.createElement(Ut.a,Object(s.__assign)({},a,{style:[Cs.scrollview,i]}),l)}var Cs=g.a.create({scrollview:{flex:1,alignSelf:"stretch",paddingTop:24}}),Ss=n("2CeA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Os(e){var t=e.values,n=e.enabled,o=e.selectedIndex,s=e.onChange,c=e.label,l=!n,u=100/t.length+"%";return r.createElement(a.a,{style:[Ps.container,Ps.webContainer,l?Ps.webContainerDisabled:{}],accessible:!0,accessibilityLabel:c,accessibilityRole:"radiogroup"},t.map((function(e,n){var a=o===n,c=0===n,d=n===t.length-1,p=[Ps.button,{width:u},c?Ps.buttonFirst:{},d?Ps.buttonLast:{},a?Ps.buttonSelected:{}],g=a?"checked":"unchecked";return r.createElement(Xo.a,{key:n,disabled:l,style:p,onPress:function(){return!a&&s(n)},underlayColor:"#cadef6",accessibilityRole:"radio",accessibilityStates:[g]},r.createElement(i.a,{numberOfLines:1,style:[Ps.text,a?Ps.textSelected:{}]},e))})))}function Is(e){var t=e.values,n=e.enabled,i=e.selectedIndex,o=e.onChange;return r.createElement(a.a,{style:Ps.container},r.createElement(Ss.a,{values:t,selectedIndex:i,onChange:function(e){var t=e.nativeEvent.selectedSegmentIndex;o(t)},enabled:n}))}function js(e){return"web"===Ue.a.OS?r.createElement(Os,Object(s.__assign)({},e)):r.createElement(Is,Object(s.__assign)({},e))}var Ps=g.a.create({container:{marginHorizontal:16},webContainer:{display:"flex",flexDirection:"row"},webContainerDisabled:{opacity:.5},button:{alignItems:"center",justifyContent:"center",flexDirection:"row",borderColor:"#007aff",borderWidth:xt.a,borderEndWidth:0,paddingHorizontal:4,overflow:"hidden"},buttonFirst:{borderTopStartRadius:5,borderBottomStartRadius:5},buttonLast:{borderEndWidth:xt.a,borderTopEndRadius:5,borderBottomEndRadius:5},buttonSelected:{backgroundColor:"#007aff"},text:{color:"#007aff",fontSize:13,lineHeight:28},textSelected:{color:"#fff",opacity:.95}}),xs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderDefaultView=function(){var e=t.props,n=e.defaultCalendarView,a=e.isOffline,i=e.onChangeDefaultCalendarView,o=e.strings,c={values:[o.day,o.week,o.month],selectedIndex:n,onChange:i,enabled:!a};return r.createElement(js,Object(s.__assign)({},c))},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=this._generateSettingsData();return r.createElement(_s,{data:e})},t.prototype._generateSettingsData=function(){var e=this.props,t=e.endTime,n=e.isOffline,a=e.onChangeEndTime,i=e.onChangeStartTime,o=e.startTime,s=e.strings,c=e.timeOptions;return[{type:"CUSTOM",title:s.defaultViewTitle,render:this._renderDefaultView},{type:"SECTION",title:s.workHoursTitle,rows:[{type:"ROW",label:s.startTime,renderAccessory:function(){return r.createElement(zo.a,{accessibilityLabel:s.startTime,selectedValue:o,onValueChange:i,enabled:!n,style:Es.picker},c.map((function(e){return r.createElement(zo.a.Item,{key:e.value,label:e.label,value:e.value})})))}},{type:"ROW",label:s.endTime,renderAccessory:function(){return r.createElement(zo.a,{accessibilityLabel:s.endTime,selectedValue:t,onValueChange:a,enabled:!n,style:Es.picker},c.map((function(e){return r.createElement(zo.a.Item,{key:e.value,label:e.label,value:e.value})})))}}]}]},t}(r.Component),Es=g.a.create({picker:{fontSize:15,alignContent:"flex-end",borderWidth:0,backgroundColor:"transparent",appearance:"none"}}),Ts=[{value:"00:00",label:"12:00 AM"},{value:"00:30",label:"12:30 AM"},{value:"01:00",label:"1:00 AM"},{value:"01:30",label:"1:30 AM"},{value:"02:00",label:"2:00 AM"},{value:"02:30",label:"2:30 AM"},{value:"03:00",label:"3:00 AM"},{value:"03:30",label:"3:30 AM"},{value:"04:00",label:"4:00 AM"},{value:"04:30",label:"4:30 AM"},{value:"05:00",label:"5:00 AM"},{value:"05:30",label:"5:30 AM"},{value:"06:00",label:"6:00 AM"},{value:"06:30",label:"6:30 AM"},{value:"07:00",label:"7:00 AM"},{value:"07:30",label:"7:30 AM"},{value:"08:00",label:"8:00 AM"},{value:"08:30",label:"8:30 AM"},{value:"09:00",label:"9:00 AM"},{value:"09:30",label:"9:30 AM"},{value:"10:00",label:"10:00 AM"},{value:"10:30",label:"10:30 AM"},{value:"11:00",label:"11:00 AM"},{value:"11:30",label:"11:30 AM"},{value:"12:00",label:"12:00 PM"},{value:"12:30",label:"12:30 PM"},{value:"13:00",label:"1:00 PM"},{value:"13:30",label:"1:30 PM"},{value:"14:00",label:"2:00 PM"},{value:"14:30",label:"2:30 PM"},{value:"15:00",label:"3:00 PM"},{value:"15:30",label:"3:30 PM"},{value:"16:00",label:"4:00 PM"},{value:"16:30",label:"4:30 PM"},{value:"17:00",label:"5:00 PM"},{value:"17:30",label:"5:30 PM"},{value:"18:00",label:"6:00 PM"},{value:"18:30",label:"6:30 PM"},{value:"19:00",label:"7:00 PM"},{value:"19:30",label:"7:30 PM"},{value:"20:00",label:"8:00 PM"},{value:"20:30",label:"8:30 PM"},{value:"21:00",label:"9:00 PM"},{value:"21:30",label:"9:30 PM"},{value:"22:00",label:"10:00 PM"},{value:"22:30",label:"10:30 PM"},{value:"23:00",label:"11:00 PM"},{value:"23:30",label:"11:30 PM"}];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ws=r.memo((function(){var e=Object(u.c)(),t=r.useCallback((function(t){e(Object(Go.c)({defaultCalendarView:t}))}),[e]),n=r.useCallback((function(t){e(Object(Go.c)({workDayStartTime:t}))}),[e]),a=r.useCallback((function(t){e(Object(Go.c)({workDayStopTime:t}))}),[e]),i=Object(ae.a)(jo),o=Object(u.d)(Wo.b),c=Object(u.d)(Pe.w),l=!1;c&&c.dateFormatInfo.ShortTimePattern&&(l="H"===c.dateFormatInfo.ShortTimePattern[0]);var d=!Object(u.d)(se.b),p={defaultCalendarView:o.defaultCalendarView,endTime:o.workDayStopTime,isOffline:d,onChangeDefaultCalendarView:t,onChangeEndTime:a,onChangeStartTime:n,startTime:o.workDayStartTime,strings:{defaultViewTitle:Object(te.c)(i,"Settings_NativeApp_Personal_CalendarDefaultView"),day:Object(te.c)(i,"Settings_NativeApp_Personal_CalendarView_Day"),week:Object(te.c)(i,"Settings_NativeApp_Personal_CalendarView_Week"),month:Object(te.c)(i,"Settings_NativeApp_Personal_CalendarView_Month"),workHoursTitle:Object(te.c)(i,"Settings_NativeApp_Personal_WorkHours"),startTime:Object(te.c)(i,"Settings_NativeApp_Personal_WorkHours_Start"),endTime:Object(te.c)(i,"Settings_NativeApp_Personal_WorkHours_End")},timeOptions:l?Ts.map((function(e){return{label:e.value,value:e.value}})):Ts};return r.createElement(xs,Object(s.__assign)({},p))})),As=n("fMeW"),Fs=n("yPdn"),Ns=n("sTlq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ks(e){var t=e.disabled,n=e.selected,o=e.index,s=e.item,c=e.onChange,l=s.label,u=n?"checked":"unchecked";return r.createElement(Xo.a,{key:o,underlayColor:"#d9d9d9",onPress:function(){return c(s)},disabled:t,style:[Rs.button,t?Rs.disabled:{}],accessibilityRole:"radio",accessibilityStates:[u]},r.createElement(a.a,{style:[Rs.item,0===o?Rs.firstItem:{}]},r.createElement(i.a,{numberOfLines:1,style:[Rs.text,n?Rs.selected:{}]},l),n&&r.createElement(i.a,{importantForAccessibility:"no-hide-descendants",style:Rs.checkmark},"✓")))}function Ms(e){var t=e.items,n=e.disabled,a=e.onChange,i=e.selectedValue,o=e.label;return r.createElement(Ut.a,{style:Rs.scrollView,accessible:!0,accessibilityLabel:o,accessibilityRole:"radiogroup"},t.map((function(e,t){var o={item:e,selected:e.value===i,index:t,onChange:a,disabled:n};return r.createElement(ks,Object(s.__assign)({key:t},o))})))}var Ds,Rs=g.a.create({scrollView:{backgroundColor:"#fff"},scrollViewBorder:{height:xt.a,backgroundColor:"#c7c7c9"},button:{paddingStart:16},disabled:{opacity:.5},item:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderTopWidth:xt.a,borderColor:"#c7c7c9",height:40,paddingEnd:10},firstItem:{borderColor:"transparent"},text:{fontSize:15,flexGrow:1,flexShrink:1},selected:{color:"#007aff"},checkmark:{fontSize:15,color:"#007aff",marginStart:15,marginEnd:6}}),Ls=["Settings_NativeApp_Device_ImageResolution","Settings_NativeApp_Device_ImageResolution_Default"],Bs=((Ds={})[As.a.Res640x480]="640 x 480",Ds[As.a.Res1024x768]="1024 x 768",Ds[As.a.Res1600x1200]="1600 x 1200",Ds[As.a.Res2048x1536]="2048 x 1536",Ds[As.a.Res2592x1936]="2592 x 1936",Ds);function Vs(e){var t=[{label:e,value:As.a.DeviceDefault.toString()}];return Object.keys(Bs).forEach((function(n){var r=parseInt(n,10);t.push({label:Gs(r,e),value:n})})),t}function Gs(e,t){if(e===As.a.DeviceDefault)return t;var n=Bs[e];if(!n)throw new Error("Unrecognized image resolution "+e);return n}var Ws=r.memo((function(){var e=Object(u.c)(),t=Object(ae.a)(Ls),n=Object(te.c)(t,"Settings_NativeApp_Device_ImageResolution"),a=Object(te.c)(t,"Settings_NativeApp_Device_ImageResolution_Default"),i=r.useCallback((function(t){var n={camera:{featureName:"camera",imageRes:parseInt(t.value,10)}};e(Object(Ns.a)(n))}),[e]);return r.createElement(Ms,{selectedValue:Object(u.d)(Fs.b)+"",items:Vs(a),onChange:i,label:n})})),zs=["Settings_NativeApp_Personal_RecordsPerPage"],Xs=[{label:"25",value:"25"},{label:"50",value:"50"},{label:"75",value:"75"},{label:"100",value:"100"},{label:"250",value:"250"}],qs=r.memo((function(){var e=Object(u.c)(),t=Object(ae.a)(zs),n=r.useCallback((function(t){var n=parseInt(t.value,10);e(Object(Go.c)({recordsPerPage:n}))}),[e]),a=!Object(u.d)(se.b);return r.createElement(Ms,{selectedValue:Object(u.d)(Wo.b).recordsPerPage+"",items:Xs,onChange:n,label:Object(te.c)(t,"Settings_NativeApp_Personal_RecordsPerPage"),disabled:a})})),Us=function(e){return r.createElement(a.a,{style:Hs.container},r.createElement(i.a,{style:[Hs.label,Hs.text]},e.label),r.createElement(i.a,{style:Hs.text},e.value))},Hs=g.a.create({container:{alignItems:"center",marginBottom:16},label:{fontWeight:"600"},text:{textAlign:"center",fontSize:13,lineHeight:16,userSelect:"all"}}),Ys=g.a.create({scrollableContent:{flex:1,alignItems:"center",paddingTop:60,paddingLeft:16,paddingRight:16,paddingBottom:16},productName:{fontSize:17,lineHeight:22,fontWeight:"600",marginBottom:9},version:{fontSize:13,lineHeight:16,fontWeight:"600",textAlign:"center"},detailsContainer:{marginTop:31,marginBottom:31}}),Ks=r.memo((function(e){var t=e.details,n=e.productName,o=e.updatesDescription;return r.createElement(Ut.a,null,r.createElement(a.a,{style:Ys.scrollableContent},r.createElement(i.a,{style:Ys.productName},n),r.createElement(i.a,{style:Ys.version},o),r.createElement(a.a,{style:Ys.detailsContainer},t.map((function(e){var t=e.label,n=e.value;return r.createElement(Us,{key:t+n,label:t,value:n})})))))})),Qs=n("TXh4"),Zs=n("KReh"),Js=r.memo((function(){var e=Object(ae.a)(Zs.a),t=r.useContext(we.a),n=[Object(u.d)((function(t){return Qs.h(t,e)}),u.b),Object(u.d)((function(t){return Qs.a(t,e)}),u.b),Qs.c(e),Object(u.d)((function(t){return Qs.e(t,e)}),u.b),Qs.i(t,e),Qs.d(t,e)],a={productName:Object(u.d)((function(t){return Qs.f(t,e)})),updatesDescription:Object(u.d)((function(t){return Qs.g(t,e)})),details:n};return r.createElement(Ks,Object(s.__assign)({},a))})),$s=["Settings_NativeApp_Personal_TimeZone"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ec(e,t){var n=e.bias,r=t.bias;if(n!==r)return n-r;var a=e.timeZoneCode,i=t.timeZoneCode;return a!==i?a-i:0}var tc=r.memo((function(){var e,t=Object(u.c)(),n=Object(ae.a)($s),a=r.useCallback((function(e){var n=parseInt(e.value,10);if(isNaN(n))throw new Error("Invalid time zone code: "+e.value);t(Object(Go.c)({timeZoneCode:n}))}),[t]),i=(e=Object(u.d)(Pe.m),Object.keys(e).map((function(t){return e[t]})).sort(ec).map((function(e){return{label:e.userInterfaceName,value:""+e.timeZoneCode}}))),o=!Object(u.d)(se.b);return r.createElement(Ms,{selectedValue:""+Object(u.d)(Wo.b).timeZoneCode,items:i,onChange:a,label:Object(te.c)(n,"Settings_NativeApp_Personal_TimeZone"),disabled:o})})),nc=n("Ii3V"),rc=n("Oze0"),ac=n("AX1v"),ic=n("He+0"),oc=n("JYE5"),sc=n("iuag");function cc(e){var t=e.value,n=e.onValueChange,a=e.label,i=e.disabled,o=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},uc.container),t&&uc.containerOn),i&&uc.containerDisabled),c=Object(s.__assign)(Object(s.__assign)({},uc.slider),t&&uc.sliderOn);return r.createElement("div",{style:o},r.createElement("input",{"aria-label":a,checked:t,disabled:i,onChange:function(e){var t=e.target;n(t.checked)},style:uc.checkbox,type:"checkbox"}),r.createElement("div",{style:c}))}function lc(e){return"web"===Ue.a.OS?r.createElement(cc,Object(s.__assign)({},e)):r.createElement(sc.a,Object(s.__assign)({},e))}var uc={container:{borderWidth:2,borderStyle:"solid",borderRadius:14,boxSizing:"border-box",height:28,width:46,position:"relative",userSelect:"none",cursor:"pointer",opacity:1,backgroundColor:"#fff",borderColor:"#e6e6e6",transition:"background-color 0.2s, border-color 0.2s"},containerOn:{backgroundColor:"#34c759",borderColor:"#34c759"},containerDisabled:{opacity:.5,cursor:"default"},slider:{backgroundColor:"#fff",borderRadius:"100%",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.3), 0px 5px 10px rgba(0, 0, 0, 0.1)",display:"flex",position:"relative",left:0,height:24,width:24,transition:"left 0.2s"},sliderOn:{left:18},checkbox:{opacity:0,position:"absolute",zIndex:999,top:0,margin:0,height:"100%",width:"100%"}},dc=n("jM+9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function pc(e){var t=e.title,n=e.message,i=e.cancelLabel,o=e.cancel,s=e.confirmLabel,c=e.confirm;return r.createElement(dc.a,{title:t,message:n,contentHeight:96,buttons:function(e){return r.createElement(a.a,{style:gc.buttonContainer},r.createElement(a.a,{style:gc.separator}),r.createElement(b.a,{title:i,onPress:function(){return e(o)},style:hc}),r.createElement(a.a,{style:gc.separator}),r.createElement(b.a,{title:s,onPress:function(){return e(c)},style:gc.button,textStyle:{fontWeight:"500"}}))}})}var gc=g.a.create({buttonContainer:{flexDirection:"column",flexGrow:0,flexBasis:"auto",height:88},button:{flexBasis:0,flexGrow:1,flexDirection:"row",alignItems:"center",alignSelf:"stretch",justifyContent:"center",height:44},separator:{width:"100%",height:xt.a,backgroundColor:dc.b}}),hc=g.a.flatten([gc.button,{color:"#FF3B30"}]),mc=function(e){function t(t){var n=e.call(this,t)||this;return n._confirmChangeSetting=function(e,t){t?n.setState({settingForConfirmation:e,showConfirmationDialog:!0}):n.props.onSettingChange(e,t)},n._onConfirmedAllow=function(){n.props.onSettingChange(n.state.settingForConfirmation,!0),n._hideConfirmationDialog()},n._hideConfirmationDialog=function(){n.setState({settingForConfirmation:null,showConfirmationDialog:!1})},n.state={settingForConfirmation:null,showConfirmationDialog:!1},n}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=this.props.strings,t=e.alertCancel,n=e.alertOk,i=e.alertTitle,o=e.confirmAllowUserContent;return r.createElement(r.Fragment,null,r.createElement(a.a,{style:fc.container},r.createElement(_s,{style:fc.settings,data:this._generateSettingsData()})),this.state.showConfirmationDialog&&r.createElement(pc,{cancel:this._hideConfirmationDialog,cancelLabel:t,confirm:this._onConfirmedAllow,confirmLabel:n,message:o,title:i}))},t.prototype._generateSettingsData=function(){return[this._generateOrgSectionData(),this._generateDeviceSectionData(),this._generateGeneralSectionData()]},t.prototype._generateOrgSectionData=function(){var e=this.props,t=e.didFailInitPersonalSettings,n=e.isBusy,r=e.isOffline,a=e.organizationName,i=e.recordsPerPage,o=e.showCalendar,s=e.showRecordsPerPagePicker,c=e.showTimeZonePicker,l=e.strings,u=e.timeZone,d=n||r||t,p={type:"SECTION",title:l.orgSettingsTitle.replace("{0}",a),disabled:d,busy:n,rows:[{type:"ROW",label:l.timeZone,value:d?null:u,showDisclosureIndicator:!0,onPress:d?null:c},{type:"ROW",label:l.calendar,showDisclosureIndicator:!0,onPress:d?null:o},{type:"ROW",label:l.recordsPerPage,value:d?null:i.toString(),showDisclosureIndicator:!0,onPress:d?null:s}]};if(d){var g="";r?g=l.statusOffline:t&&(g=l.statusInitError),p.footer=g}return p},t.prototype._generateDeviceSectionData=function(){var e=this,t=this.props,n=t.allowCamera,a=t.allowCameraRoll,i=t.allowLocation,o=t.allowMicrophone,s=t.allowOfflineSync,c=t.allowVideo,l=t.canWorkOffline,u=t.longToastDuration,d=t.onSettingChange,p=t.photoResolution,g=t.showPhotoResolutionPicker,h=t.strings,m=function(e){return d("camera",e)},f=function(e){return d("cameraRoll",e)},b=function(t){return e._confirmChangeSetting("geolocation",t)},v=function(e){return d("longToastDuration",e)},y=function(t){return e._confirmChangeSetting("microphone",t)},_=function(e){return d("offlineSync",e)},C=function(t){return e._confirmChangeSetting("video",t)},S=[{type:"ROW",label:h.location,renderAccessory:function(){return r.createElement(lc,{value:i,label:h.location,onValueChange:b})}},{type:"ROW",label:h.camera,renderAccessory:function(){return r.createElement(lc,{value:n,label:h.camera,onValueChange:m})}},{type:"ROW",label:h.photoLibrary,renderAccessory:function(){return r.createElement(lc,{value:a,label:h.photoLibrary,onValueChange:f})}},{type:"ROW",label:h.photoResolution,value:p.toString(),showDisclosureIndicator:!0,onPress:g},{type:"ROW",label:h.video,renderAccessory:function(){return r.createElement(lc,{value:c,label:h.video,onValueChange:C})}},{type:"ROW",label:h.microphone,renderAccessory:function(){return r.createElement(lc,{value:o,label:h.microphone,onValueChange:y})}},{type:"ROW",label:h.longToastDuration,renderAccessory:function(){return r.createElement(lc,{value:u,label:h.longToastDuration,onValueChange:v})}}];return l&&S.push({type:"ROW",label:h.offlineSync,renderAccessory:function(){return r.createElement(lc,{value:s,label:h.offlineSync,onValueChange:_})}}),{type:"SECTION",title:h.deviceSettingsTitle,rows:S}},t.prototype._generateGeneralSectionData=function(){var e=this.props,t=e.onPrivacyStatementPress,n=e.onTermsOfUsePress,r=e.strings;return{type:"SECTION",title:r.generalSettingsTitle,rows:[{type:"ROW",label:r.termsOfUse,onPress:n},{type:"ROW",label:r.privacyStatement,onPress:t},{type:"ROW",label:r.sessionDetails,showDisclosureIndicator:!0,onPress:this.props.showSessionDetails}]}},t}(r.PureComponent),fc=g.a.create({container:{flex:1,alignItems:"stretch",justifyContent:"flex-start"},settings:{flexBasis:"auto"},itemTitle:{color:"#323130"},itemTitleDisabled:{color:"#a19f9d"},itemValue:{fontSize:18,color:"#a19f9d",backgroundColor:"#f0f"},spinnerOverlay:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"center"},spinnerContainer:{position:"absolute",padding:16,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:8}}),bc=n("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function vc(e){var t=Object(ie.p)(e),n=!bc.a.isNullOrEmpty(Object(Pe.e)(e)),r=t!==ac.a.Default,a=Object(ie.q)(e)!==he.a.Initializing,i=Object(Se.a)(e);return n&&r&&a&&i}function yc(e){return Object(Fs.e)(e,"camera")}function _c(e){return Object(Fs.e)(e,"geolocation")}function Cc(e){return Object(Fs.e)(e,"microphone")}function Sc(e){return Object(Fs.e)(e,"video")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Oc=Object(s.__spreadArrays)(jo,Po,[oc.i,oc.l,oc.m,oc.n,oc.o]);var Ic=r.memo((function(e){var t=r.useState(!1),n=t[0],a=t[1],i=r.useState(!1),o=i[0],c=i[1],l=Object(u.c)(),d=Object(ae.a)(Oc),p=r.useCallback((function(e,t){return function(e,t,n){var r={};switch(t){case"camera":case"geolocation":case"microphone":case"video":r[t]={featureName:t,isEnabled:n},e(Object(Ns.a)(r));break;case"cameraRoll":r.camera={featureName:"camera",savePhoto:n},e(Object(Ns.a)(r));break;case"offlineSync":e(Object(ic.c)(n));break;case"longToastDuration":var a={toastNotification:{toastNotificationDisplaySpeed:n?rc.a.Slow:rc.a.Normal}};e(Object(nc.b)(a));break;default:throw new Error("Unrecognized setting: "+t)}}(l,e,t)}),[l]);r.useEffect((function(){a(!0),l(Object(Go.b)()).then((function(){return a(!1)})).catch((function(e){c(!0),a(!1)}))}),[l]);var g,h=Object(u.d)(Wo.b),m=h.defaultCalendarView,f=h.recordsPerPage,b=h.timeZoneCode,v=h.workDayStartTime,y=h.workDayStopTime,_=Object(u.d)(Pe.m),C=_[b]&&_[b].userInterfaceName||"",S=Object(u.d)(ie.p)===ac.a.Enabled,O=Object(u.d)(Wo.a).toastNotificationDisplaySpeed===rc.a.Slow,I=Object(u.d)(Vn.B)||(g=d,Object(te.c)(g,oc.i)),j=r.useCallback((function(){return l(Object(Te.a)(I))}),[l,I]),P=function(e){var t=He.a.getInstance(),n=oc.o;t.get_IsIOS()&&t.get_isIPad()?n=oc.n:t.get_IsAndroid()&&(n=t.get_IsAndroidPhone()?oc.m:oc.l);return"https://"+Object(te.c)(e,n)}(d),x=r.useCallback((function(){return l(Object(Te.a)(P))}),[l,P]),E={allowCamera:Object(u.d)(yc),allowCameraRoll:Object(u.d)(Fs.f),allowLocation:Object(u.d)(_c),allowMicrophone:Object(u.d)(Cc),allowOfflineSync:S,allowVideo:Object(u.d)(Sc),canWorkOffline:Object(u.d)(vc),defaultCalendarView:m,didFailInitPersonalSettings:o,isBusy:n,longToastDuration:O,isOffline:!Object(u.d)(se.b),onPrivacyStatementPress:j,onSettingChange:p,onTermsOfUsePress:x,organizationName:Object(u.d)(Vn.w),photoResolution:Gs(Object(u.d)(Fs.b),Object(te.c)(d,"Settings_NativeApp_Device_ImageResolution_Default")),recordsPerPage:f,showCalendar:e.onNavigateToCalendar,showPhotoResolutionPicker:e.onNavigateToPhotoResolutionPicker,showRecordsPerPagePicker:e.onNavigateToRecordsPerPagePicker,showSessionDetails:e.onNavigateToSessionDetails,showTimeZonePicker:e.onNavigateToTimeZonePicker,strings:{alertCancel:Object(te.c)(d,"Settings_NativeApp_Alert_Cancel"),alertOk:Object(te.c)(d,Oo),alertTitle:Object(te.c)(d,"Settings_NativeApp_Alert_Title"),calendar:Object(te.c)(d,"Settings_NativeApp_Personal_Calendar"),camera:Object(te.c)(d,"Settings_NativeApp_Device_Camera"),confirmAllowUserContent:Object(te.c)(d,"Settings_NativeApp_Device_LocationAndContent_LegalNotice"),deviceSettingsTitle:Object(te.c)(d,"Settings_NativeApp_Device"),generalSettingsTitle:Object(te.c)(d,"Settings_NativeApp_General"),location:Object(te.c)(d,"Settings_NativeApp_Device_LocationAndContent"),longToastDuration:Object(te.c)(d,"Settings_NativeApp_Device_IncreaseToastDuration"),microphone:Object(te.c)(d,"Settings_NativeApp_Device_Microphone"),offlineSync:Object(te.c)(d,"Settings_NativeApp_Device_OfflineSync"),orgSettingsTitle:Object(te.c)(d,"Settings_NativeApp_Personal"),photoLibrary:Object(te.c)(d,"Settings_NativeApp_Device_SavePhoto"),photoResolution:Object(te.c)(d,"Settings_NativeApp_Device_ImageResolution"),privacyStatement:Object(te.c)(d,"Settings_NativeApp_General_PrivacyStatement"),recordsPerPage:Object(te.c)(d,"Settings_NativeApp_Personal_RecordsPerPage"),sessionDetails:Object(te.c)(d,So),statusInitError:Object(te.c)(d,"Settings_NativeApp_Status_InitError"),statusOffline:Object(te.c)(d,"Settings_NativeApp_Status_Offline"),termsOfUse:Object(te.c)(d,Co),timeZone:Object(te.c)(d,"Settings_NativeApp_Personal_TimeZone"),video:Object(te.c)(d,"Settings_NativeApp_Device_Video")},timeZone:C,workDayStartTime:v,workDayStopTime:y};return r.createElement(mc,Object(s.__assign)({},E))})),jc=Object(s.__spreadArrays)(jo,["Settings_NativeApp_Screen_Back",Io]),Pc="#"+ni.e+' > [role="dialog"]',xc=function(){var e=r.useState(!1),t=e[0],n=e[1],a=r.useState(!1),i=a[0],o=a[1],s=r.useState(!1),c=s[0],l=s[1],d=r.useState(!1),p=d[0],g=d[1],h=r.useState(!1),m=h[0],f=h[1],b=Object(u.c)(),v=Object(u.e)(),y=r.useContext(we.a),_=r.useCallback((function(){b(Object(An.c)(ni.e)),yo(y,v)&&_o(y,v)}),[b,v,y]),C=r.useCallback((function(){return l(!0)}),[]),S=r.useCallback((function(){return l(!1)}),[]),O=r.useCallback((function(){return g(!0)}),[]),I=r.useCallback((function(){return g(!1)}),[]),j=r.useCallback((function(){return n(!0)}),[]),P=r.useCallback((function(){return n(!1)}),[]),x=r.useCallback((function(){return o(!0)}),[]),E=r.useCallback((function(){return o(!1)}),[]),T=r.useCallback((function(){return f(!0)}),[]),w=r.useCallback((function(){return f(!1)}),[]),A=Object(ae.a)(jc),F=Object(te.c)(A,"Settings_NativeApp_SettingsScreenTitle"),N=Object(te.c)(A,"Settings_NativeApp_Personal_Calendar"),k=Object(te.c)(A,So),M=Object(te.c)(A,"Settings_NativeApp_Device_ImageResolution"),D=Object(te.c)(A,"Settings_NativeApp_Personal_RecordsPerPage"),R=Object(te.c)(A,"Settings_NativeApp_Personal_TimeZone"),L=Object(te.c)(A,"Settings_NativeApp_Screen_Back"),B=Object(te.c)(A,Io);return r.useEffect((function(){Ec(N,i)}),[i]),r.useEffect((function(){Ec(k,t)}),[t]),r.useEffect((function(){Ec(M,c)}),[c]),r.useEffect((function(){Ec(D,p)}),[p]),r.useEffect((function(){Ec(R,m)}),[m]),r.createElement(Ei,{modalId:ni.e},r.createElement(fi,{title:F,onClosePressed:_,closeButtonLabel:B},r.createElement(Ic,{onNavigateToCalendar:x,onNavigateToSessionDetails:j,onNavigateToPhotoResolutionPicker:C,onNavigateToRecordsPerPagePicker:O,onNavigateToTimeZonePicker:T})),i&&r.createElement(Bo,{title:N,backButtonLabel:L,onNavigateBack:E},r.createElement(ws,null)),t&&r.createElement(Bo,{title:k,backButtonLabel:L,onNavigateBack:P},r.createElement(Js,null)),c&&r.createElement(Bo,{title:M,backButtonLabel:L,onNavigateBack:S},r.createElement(Ws,null)),p&&r.createElement(Bo,{title:D,backButtonLabel:L,onNavigateBack:I},r.createElement(qs,null)),m&&r.createElement(Bo,{title:R,backButtonLabel:L,onNavigateBack:w},r.createElement(tc,null)))};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ec(e,t){t?function(e){var t=document.getElementById(ni.e);if(!t||!e)return;var n=t.querySelector('[aria-label="'+e+'"][role=dialog] [role=button]');n&&n.focus()}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e):function(e){var t=document.getElementById(ni.e);if(!t||!e)return;var n=t.querySelector('[aria-label="'+e+'"][role=button]');n&&n.focus()}(e);var n=document.querySelector(Pc);n&&n.setAttribute("aria-hidden",t.toString())}var Tc=function(e){function t(t){var n=e.call(this,t)||this;return n._backNavigations=0,n._onBeforeNavigateBack=function(e){return void 0===e&&(e=!1),n.setState({isNavigatingToRoot:e}),n.props.preNavigateBack({targetBrowsingContext:n.props.browsingContextId})},n._onNavigateBack=function(e){void 0===e&&(e=!1),n.props.navigateBack(e&&{backToRoot:!0,targetBrowsingContext:n.props.browsingContextId}),Object(Ta.a)(),n.setState({isNavigatingToRoot:!1})},n.state={isNavigatingToRoot:!1},n}return Object(s.__extends)(t,e),t.prototype.componentDidUpdate=function(e){e.pageStack&&(this.props.pageStack.length===e.pageStack.length-1?3==++this._backNavigations&&(this._backNavigations=0,this.props.userNavigatedBackMultipleTimes()):this.props.pageStack.length===e.pageStack.length+1&&(this._backNavigations=0))},t.prototype.render=function(){var e=this,t=this.state.isNavigatingToRoot,n=this.props,i=n.canNavigateBackToHost,o=n.pageStack,s=n.pageDefinitions,c=n.currentPageError,l=o.length-1;return r.createElement(a.a,{style:Ac.container},o.map((function(n,a){var o=0===a&&!i,u="android"===Ke()||o||i&&0===a;return r.createElement(r.Fragment,{key:a},r.createElement(wc,{shouldRenderSidebar:o},r.createElement(xa,{key:a,canSwipeBack:!u,error:c&&a===l,isRootPage:o,isTopPage:a===l,isActive:a===l,isNextOnStack:t?0===a:a===l-1,route:n,definition:s[n],onBeforeNavigateBack:e._onBeforeNavigateBack,onNavigateBack:e._onNavigateBack,routeIndex:a})),e.props.isNavigating?r.createElement(us,{type:0,blockTouch:!0,displayDelay:1e3}):null)})),r.createElement(Lo,null),r.createElement(xc,null))},t}(r.PureComponent);function wc(e){var t=e.children;return e.shouldRenderSidebar?r.createElement(mo,{menuContent:r.createElement(po,null)},t):t}var Ac=g.a.create({container:{flex:1}});function Fc(e){if(e.appShellState&&e.appShellState.indicatorNotificationState){var t=e.appShellState.indicatorNotificationState.indicatorNotifications;return t&&t[0]}return null}var Nc=n("VEVe"),kc=["UCI_Progress_Failure","UCI_Progress_Saving","UCI_Progress_Success","UCI_Progress_Loading"];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Mc(e,t){switch(t){case 1:return Object(te.c)(e,"UCI_Progress_Failure");case 0:return Object(te.c)(e,"UCI_Progress_Success");default:return null}}function Dc(e){switch(e){case 1:return 3;case 0:return 2;default:return null}}function Rc(e){var t=e.topPageId,n=Object(u.c)(),a=Object(ae.a)(kc),i=Object(u.d)((function(e){return Object(re.jb)(e,t)})),o=Object(u.d)(Fc),s=r.useCallback((function(){o&&n(Object(Nc.d)(o.id))}),[n,o]);return i?r.createElement(us,{key:"saving",type:1,title:Object(te.c)(a,"UCI_Progress_Saving")}):o?r.createElement(us,{key:o.id,closeAction:s,duration:2e3,type:Dc(o.type),title:Mc(a,o.type)}):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Lc=!1;function Bc(){var e=r.useRef(null),t=e.current;return r.useEffect((function(){if(!Lc&&null!=t){var e=yt.findDOMNode(t);if(e){var n=e.className,r=document.getElementById("react-native-stylesheet");if(r){for(var a="",i=r.sheet.rules,o=i.length,s=0;s<o;s++){var c=i[s];if(c.selectorText.indexOf(n)>-1){a=c.selectorText.trim(),c.style.removeProperty("z-index");break}}if(""!==a){var l=document.createElement("style");document.head.appendChild(l);var u=l.sheet;u.insertRule('\ndiv[id$="_innerPopup"] > div {\n\tmax-height: calc(100% - env(safe-area-inset-top)) !important;\n\tmargin-top: env(safe-area-inset-top) !important;\n}'),u.insertRule('\nbody > section[openedpopups][id*="Lookup"] {\n  margin-top: env(safe-area-inset-top) !important;\n}'),u.insertRule("\n#cardfeedcontainerwrapper {\n  padding-top: env(safe-area-inset-top);\n  margin-left: 0 !important;\n}"),u.insertRule('\ndiv[role="dialog"]:not('+a+") {\n  border-top: env(safe-area-inset-top) solid rgba(0,0,0,0);\n  -webkit-clip-path: inset(env(safe-area-inset-top) 0 0 0);\n  clip-path: inset(env(safe-area-inset-top) 0 0 0);\n}"),u.insertRule("\ndiv#__flyoutRootNode_tbxMenu > div > div {\n  margin-top: env(safe-area-inset-top);\n}"),u.insertRule("\n@media (max-width: 480px) {\ndiv#toastNotificationRoot {\t\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tmargin-top: env(safe-area-inset-top);\n}\n}"),u.insertRule("\ndiv#popupNotificationListRoot {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tmargin-top: env(safe-area-inset-top);\n}"),Lc=!0}}}}}),[t]),r.createElement(a.a,{ref:e,style:{display:"none"}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Vc(e){var t=e.pageDefinitions,n=Object(u.c)(),a=r.useCallback((function(e){n(Object(va.a)(e))}),[n]),i=r.useCallback((function(e){return n(Object(va.c)(e))}),[n]),o=Object(u.d)((function(e){return Object(ya.d)(e).history.map((function(e){return e.state.pageId}))}),u.b),s=Object(u.d)(Tt.f),c=Object(u.d)(ya.e),l=Object(u.d)(Tt.h),d=r.useCallback((function(){return n(Object(ta.e)())}),[n]),p=Object(u.d)(Tt.g),g=r.useMemo((function(){return new Fn(n)}),[n]),h=Object(u.e)(),m=r.useContext(we.a);return r.createElement(r.Fragment,null,r.createElement(Bc,null),r.createElement(Nn.Provider,{value:{NativeFlyoutManager:g}},r.createElement(Tc,{currentPageError:l,pageStack:o,pageDefinitions:t,navigateBack:a,preNavigateBack:i,browsingContextId:c,userNavigatedBackMultipleTimes:d,isNavigating:p,canNavigateBackToHost:yo(m,h)})),r.createElement(Rc,{topPageId:s}))}var Gc=n.p+"resources/images/ChevronDown.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Wc(e){var t=e.text,n=e.style;return r.createElement(a.a,{style:{display:"flex",flexDirection:"row"}},r.createElement(i.a,{numberOfLines:1,style:n},t),r.createElement(a.a,{style:{paddingLeft:8,paddingTop:4,flexGrow:0,flexBasis:"auto",alignSelf:"center"}},r.createElement(_.a,{type:1,icon:Gc,size:16,color:n.color||"#FFF"})))}var zc=r.memo((function(e){var t=e.items,n=e.selectedItemId,a=e.onChange,i=e.titleStyle,o=jt(),s=o.anchorPoint,c=o.updateAnchorPoint,l=o.setAnchorPoint,u=Cr(!1,c),d=u[0],p=u[1],g=u[2],h=t.find((function(e){return e.value===n}));return h?r.createElement(r.Fragment,null,r.createElement(E.a,{ref:l,onPress:p,style:Xc.container},r.createElement(Wc,{text:h.text,style:i})),d&&r.createElement(vr,{top:s+8,items:t,selectedItem:h.value,onChange:function(e){a(e),g(!1)},close:function(){return g(!1)}})):null})),Xc=g.a.create({container:{maxWidth:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function qc(){var e=r.useState([]),t=e[0],n=e[1];return[t,r.useCallback((function(e){return n((function(t){return Object(s.__spreadArrays)(t,[e])})),function(){return n((function(t){return t.filter((function(t){return t!==e}))}))}}),[])]}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Uc(e){var t=e.children,n=qc(),a=n[0],i=n[1],o=qc(),s=o[0],c=o[1],l=r.useState(44),u=l[0],d=l[1],p=r.useMemo((function(){return{scroll:function(e,t,n){return a.map((function(r){return r(e,t,n)}))},onScroll:i,scrollEnd:function(e){return s.map((function(t){return t(e)}))},onScrollEnd:c,nativeHeaderHeight:u,setNativeHeaderHeight:d}}),[c,i,u,s,a]);return r.createElement(Ve.Provider,{value:p},t)}var Hc=n("B73A");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Yc(e){var t=e.children,n=e.id,a=e.isModalOpen,i=e.closeAction,o=e.onShow,s=r.useState(a),c=s[0],l=s[1],u=r.useCallback((function(){o&&o(),l(!0)}),[l,o]),d=r.useCallback((function(){l(!1)}),[l]);return c||a?r.createElement(Ct.a,{onModalShow:u,onModalHide:d,animationIn:"slideInUp",animationInTiming:300,animationOut:"slideOutDown",isVisible:a,style:Kc.modal},r.createElement(Xt.a,{key:"flyout",id:n,style:{flexDirection:"column",flexGrow:1,maxHeight:"100%"}},t),r.createElement(W.a,{key:"accessibilityComponent",rootElementId:n,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:[new Hc.a([zi.a.Escape],(function(){return i()}),!0,void 0,void 0)]})):null}var Kc=g.a.create({modal:{margin:0}}),Qc=n("mVnn"),Zc=n("/lKk"),Jc=n("KZbu"),$c=n("SgZb"),el=n("xc1f"),tl=n("Z1aD");var nl=[Xr.n,Xr.o];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function rl(e){var t=e.quickCreateForm,n=e.closeAction,i=r.useState(!1),o=i[0],s=i[1],c=r.useCallback((function(){window.requestAnimationFrame((function(){return s(!0)}))}),[s]);return r.createElement(Yc,{id:"qcf",isModalOpen:!0,closeAction:n,onShow:c},r.createElement(Y,{barStyle:"dark-content",backgroundColor:"#FFF"}),r.createElement(Gr,null),r.createElement(a.a,{style:al.formBodyContainer},o&&t))}var al=g.a.create({formBodyContainer:{flexGrow:1,flexShrink:1,height:"100%",backgroundColor:"#ffffff"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function il(e){var t=e.pageId,n=e.quickCreateForm,a=fa(),i=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){var t=Object(u.c)(),n=Object(u.d)((function(t){return Object(Qc.a)(t,e)})),a=r.useCallback((function(){return t(Object(Zc.a)(e))}),[t,e]),i=r.useCallback((function(){return t(Object(Jc.a)(e,n))}),[t,n,e]);return r.useMemo((function(){return{isDirty:!0,isInCreateMode:!0,save:a,discard:i}}),[i,a])}(t),o=function(e){var t=Object(u.c)(),n=Object(u.d)((function(t){return Object(it.g)(t,e)})),a=Object(ae.a)(nl);return r.useMemo((function(){return[{save:function(){return t(Object(Zc.a)(e)).then((function(n){return t(Object(tl.a)(el.a,{entityTypeName:n.etn,id:n.id},e))}))},label:a[Xr.o]},{save:function(){return t(Object($c.a)(n,e))},label:a[Xr.n]}]}),[t,e,n,a])}(t),c=Object(u.c)(),l=r.useMemo((function(){return new Fn(c)}),[c]),d=r.useMemo((function(){return Object(s.__assign)(Object(s.__assign)({},i),{pageContentId:st(t),supportsScrolling:!1,additionalSaveActions:o})}),[o,t,i]);return r.createElement(ha.Provider,{value:a},r.createElement(ga.Provider,{value:pa},r.createElement(Nn.Provider,{value:{NativeFlyoutManager:l}},r.createElement(gt.Provider,{value:d},r.createElement(rl,{quickCreateForm:n,closeAction:i.discard})))))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ol(e){var t=e.flyoutCommand,n=e.setFlyoutCommand,a=e.commandBarStatus,i=e.setCommandBarStatus,o=e.flyoutOptions,s=e.overflowListCommandControls,c=e.webResourcePath,l=e.moreCommands,u=e.executeCommand;return r.createElement(r.Fragment,null,r.createElement(E.a,{onPress:function(){a===Tn.none?i(Tn.drawerExpanded):i(Tn.none)},style:sl.commandOverflowButtonStyle,accessibilityRole:"button",accessibilityLabel:l,testID:"open-command-drawer"},r.createElement(_.a,{icon:C.a.More,color:"#605E5C",size:16})),r.createElement(Mn,{flyoutCommandId:"native-subgrid-command-bar",flyoutCommand:t,setFlyoutCommand:n,commandBarStatus:a,setCommandBarStatus:i,flyoutOptions:o,headerCommandControls:null,overflowListCommandControls:s,webResourcePath:c,executeCommand:u}))}var sl=g.a.create({commandOverflowButtonStyle:{alignItems:"center",justifyContent:"center",width:16,height:16,backgroundColor:"#F8F8F8",margin:10}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function cl(e){var t=e.commandManagerId,n=e.pageId,a=r.useState(),i=a[0],o=a[1],s=r.useState(Tn.none),c=s[0],l=s[1],d=Object(u.d)(Vn.t),p=Object(ae.a)(At.f)[At.d],g=Jn(t,n),h=g.executeCommand,m=g.commands,f=Zn(null,h),b=Object(u.c)(),v=r.useMemo((function(){return new Fn(b)}),[b]);return r.createElement(Nn.Provider,{value:{NativeFlyoutManager:v}},r.createElement(ol,{flyoutCommand:i,setFlyoutCommand:o,commandBarStatus:c,setCommandBarStatus:l,flyoutOptions:qn,overflowListCommandControls:m,webResourcePath:d,moreCommands:p,executeCommand:f}))}var ll=n("M6R7"),ul=n("Ee48"),dl=n("xQln"),pl=x.a.createAnimatedComponent(ll.a),gl=function(e){function t(t){var n=e.call(this,t)||this;return n._barWidth=n.props.windowWidth,n._defaultInput=n.props.value&&n.props.value.length>0?n.props.value:"",n._quickFindRNContainnerStyles=n.props.quickFindRNStyleProps.quickFindRNContainerStyle,n._searchBarHeight=n._quickFindRNContainnerStyles.height,n._searchBarPadding=n._quickFindRNContainnerStyles.paddingTop,n._inputHeight=+n._searchBarHeight-2*+n._searchBarPadding,n._editable=!0,n._keyboardShouldPersist=!1,n._cancelButtonWidth=64,n._searchIconCollapseMargin=n._barWidth/4+5,n._searchIconExpandedMargin=26,n._searchExecuted=n._defaultInput.length>0,n._animatedIconSearch=new x.a.Value(n._searchIconCollapseMargin),n._animatedIconClear=new x.a.Value(0),n._animatedInputBarWidth=new x.a.Value(n._barWidth),n._animatedCancelBtn=new x.a.Value(0),n._animatedCancelBtnWidth=new x.a.Value(0),n._onFocus=function(){n.setState({expanded:!0}),n._expandAnimation()},n._onClear=function(){n.state.expanded&&(n.setState({keyword:""},(function(){n.props.updateSearchTextAndFind(null,!1)})),x.a.timing(n._animatedIconClear,{toValue:0,duration:200}).start())},n._onCancel=function(){n.state.expanded&&(n.setState({keyword:""},(function(){n.props.updateSearchTextAndFind(null,n._searchExecuted),n._searchExecuted=!1})),n.setState({expanded:!1}),n._collapseAnimation())},n._expandAnimation=function(){x.a.parallel([x.a.timing(n._animatedInputBarWidth,{toValue:n._barWidth-n._cancelButtonWidth,duration:200}),x.a.timing(n._animatedCancelBtn,{toValue:1,duration:200}),x.a.timing(n._animatedIconSearch,{toValue:n._searchIconExpandedMargin,duration:100}),x.a.timing(n._animatedIconClear,{toValue:n.state.keyword.length>0?1:0,duration:200}),x.a.timing(n._animatedCancelBtnWidth,{toValue:n._cancelButtonWidth,duration:200})]).start()},n._collapseAnimation=function(){x.a.parallel([x.a.timing(n._animatedInputBarWidth,{toValue:n._barWidth,duration:200}),x.a.timing(n._animatedCancelBtn,{toValue:0,duration:200}),!1===n._keyboardShouldPersist?x.a.timing(n._animatedIconSearch,{toValue:n._searchIconCollapseMargin,duration:200}):null,x.a.timing(n._animatedIconClear,{toValue:0,duration:200}),x.a.timing(n._animatedCancelBtnWidth,{toValue:0,duration:200})]).start()},n.state={keyword:n._defaultInput,expanded:!1},n._onFocus=n._onFocus.bind(n),n._onChangeText=n._onChangeText.bind(n),n._onSearch=n._onSearch.bind(n),n._onClear=n._onClear.bind(n),n._onCancel=n._onCancel.bind(n),n._expandAnimation=n._expandAnimation.bind(n),n._collapseAnimation=n._collapseAnimation.bind(n),n._placeholder=n.props.placeholder,n._cancelText=n.props.cancelText,n}return Object(s.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.value&&this.props.value.length>0&&this._onFocus()},t.prototype._onChangeText=function(e){var t=this;this.setState({keyword:e},(function(){t.props.updateSearchTextAndFind(e,!1)})),x.a.timing(this._animatedIconClear,{toValue:e.length>0?1:0,duration:200}).start()},t.prototype._onSearch=function(e){this._searchExecuted=!0,this.props.updateSearchTextAndFind(e.nativeEvent.text,!0)},t.prototype.render=function(){return r.createElement(x.a.View,{style:this.props.quickFindRNStyleProps.quickFindRNContainerStyle,onPress:this._onFocus},r.createElement(qe.a,{onPress:this._onFocus},r.createElement(x.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNIconSearch,{left:this._animatedIconSearch}]},r.createElement(_.a,{type:1,icon:ul.a,size:20,color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color}))),r.createElement(pl,{style:[this.props.quickFindRNStyleProps.quickFindRNInputStyle,{color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color},this._inputHeight&&{height:this._inputHeight},{width:this._animatedInputBarWidth},this.state.expanded?{textAlign:"left"}:{textAlign:"center"}],editable:this._editable,value:this.state.keyword,onChangeText:this._onChangeText,placeholder:this._placeholder,placeholderTextColor:this.props.quickFindRNStyleProps.quickFindRNPlaceholderColor.color,onSubmitEditing:this._onSearch,autoCorrect:!1,blurOnSubmit:!0,returnKeyType:"search",keyboardType:"default",keyboardAppearance:"default",onFocus:this._onFocus,onPress:this._onFocus,underlineColorAndroid:"transparent",accessibilityTraits:"search",accessibilityLabel:this._placeholder}),r.createElement(qe.a,{onPress:this._onClear,accessibilityLabel:this.props.clearText},r.createElement(x.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNIconClear,{opacity:this._animatedIconClear},{pointerEvents:this.state.expanded?"auto":"none"}]},r.createElement(_.a,{type:1,icon:dl.a,size:16,color:this.props.quickFindRNStyleProps.quickFindRNClearIconColor.color}))),r.createElement(x.a.View,{style:{width:this._animatedCancelBtnWidth}},r.createElement(E.a,{onPress:this._onCancel},r.createElement(x.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNCancelButton,{width:this._animatedCancelBtnWidth},{opacity:this._animatedCancelBtn},{pointerEvents:this.state.expanded?"auto":"none"}]},r.createElement(i.a,{style:{fontSize:17,color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color}},this._cancelText)))))},t}(r.PureComponent)},GueY:function(e,t,n){"use strict";n.d(t,"a",(function(){return te}));var r=n("c/eZ"),a=n("1z64"),i=n("HSdq"),o=n("ezfI"),s=n("Zy0S"),c=n("+ieV"),l=n("2p2B"),u=n("0MLN"),d=n("9r0m"),p=n("G9wF"),g=n("ar+e"),h=n("PhZR"),m=n("YOvo"),f=n("+Z9T"),b=n("IiPO"),v=n("/W63"),y=n("s0Zj"),_=n("Sscr");var C,S,O,I,j,P,x=n("7EJx"),E=function(){function e(e,t,n,r){var a="ClientApi.XrmNavigationItem.constructor";e||Object(f.j)(a,"store"),n||Object(f.j)(a,"pageId"),t||Object(f.j)(a,"contextToken"),Object(f.a)(r)&&Object(f.j)(a,"id"),C=e,this._pageId=n,this._id=r,this._contextToken=t}return e.prototype.getId=function(){return o.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id},e.prototype.getLabel=function(){var e="ClientApi.XrmNavigationItem.getLabel";try{o.a.instance.reportCall(e);var t=Object(i.Rb)(C.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmNavigationItem.getVisible";try{o.a.instance.reportCall(e);var t=Object(i.Ub)(C.getState(),this._pageId,this._id);return o.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setFocus=function(){var e,t,n,r="ClientApi.XrmNavigationItem.setFocus";try{o.a.instance.reportCall(r),C.dispatch((e=this._pageId,t=this._contextToken,n=this._id,{type:"forms.selectnavigationtab",sync:!0,execute:function(r,a,i){var o=r.dispatch,s=r.getState,c=Object(g.d)(s(),e,n);if(c){c.isSelected=!0;var l=Object(_.a)(t,c.relationshipName,c.ordinal);o(Object(y.b)(e,void 0,t)),o(Object(v.a)(e,l,c))}else a.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),o.a.instance.reportSuccess(r)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(r,e,null,a),e}},e.prototype.setLabel=function(e){var t="ClientApi.XrmNavigationItem.setLabel";try{if(o.a.instance.reportCall(t),!Object(f.a)(e)){var n=Object(x.s)(C.getState());C.dispatch(Object(h.b)(this._pageId,this._id,e,n))}o.a.instance.reportSuccess(t)}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmNavigationItem.setVisible";try{o.a.instance.reportCall(t),C.dispatch(Object(m.b)(this._pageId,this._id,!0===e)),o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e}(),T=function(){function e(e,t,n){n||Object(f.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(f.j)("ClientApi.XrmFormNavigation.constructor","store"),S=e,this._pageId=n,this._contextToken=t}return Object.defineProperty(e.prototype,"items",{get:function(){var e=this,t="ClientApi.XrmFormNavigation.items";try{if(o.a.instance.reportCall(t),!this._items){this._items=new s.a(t);var n=Object(g.f)()(S.getState(),{id:this._pageId});n&&n.forEach((function(t){t&&t.relatedItems&&t.relatedItems.forEach((function(t){t&&t.id&&e._items.add(t.id,new E(S,e._contextToken,e._pageId,t.id))}))}))}return o.a.instance.reportSuccess(t),this._items}catch(e){var r=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,r),e}},enumerable:!1,configurable:!0}),e}(),w=n("ll2N"),A=n("oPeH"),F=n("e2rP"),N=n("SdPQ"),k=n("lwSE"),M=n("7ipg"),D=function(e){function t(n,r,a,i){var o=e.call(this,n,r,a,t.NAME,null,i)||this;return O=n,o._clientApiExecutor=new M.b(O,"ClientApi.XrmHeaderSection.",r),o}return Object(r.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""},t.prototype.getVisible=function(){return o.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")},t.prototype.setVisible=function(e){o.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")},t.prototype.getControlsDescriptor=function(e){var t=Object(i.tb)(e,{id:this.pageId},this.contextToken),n={};if(t)for(var r=0;r<t.length;r++){var a=t[r];n[a.Name]=a}return n},t.prototype.setCommandBarVisible=function(e){var t=this;this._clientApiExecutor.execute("setCommandBarVisible",(function(){O.dispatch(Object(F.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getCommandBarVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(A.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.commandBarVisible}))},t.prototype.setBodyVisible=function(e){var t=this;this._clientApiExecutor.execute("setBodyVisible",(function(){O.dispatch(Object(N.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getBodyVisible=function(){var e=this;return this._clientApiExecutor.execute("getCommandBarVisible",(function(){var t;return null===(t=Object(A.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.bodyVisible}))},t.prototype.setTabNavigatorVisible=function(e){var t=this;this._clientApiExecutor.execute("setTabNavigatorVisible",(function(){O.dispatch(Object(k.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getTabNavigatorVisible=function(){var e=this;return this._clientApiExecutor.execute("getTabNavigatorVisible",(function(){var t;return null===(t=Object(A.f)(O.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.tabNavigatorVisible}))},t.NAME="Header",t}(w.a),R=n("cQE4"),L=n("uCYK"),B=function(e){function t(n,r,a,i){var o=e.call(this,n,r,a,t.NAME,null,i)||this;return I=n,o._clientApiExecutor=new M.b(I,"ClientApi.XrmFooterSection.",r),o}return Object(r.__extends)(t,e),t.prototype.getLabel=function(){return o.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""},t.prototype.getVisible=function(){var e=this;return this._clientApiExecutor.execute("getVisible",(function(){var t;return null===(t=Object(R.a)(I.getState(),e.pageId,e.contextToken))||void 0===t?void 0:t.visible}))},t.prototype.setLabel=function(e){o.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")},t.prototype.setVisible=function(e){var t=this;this._clientApiExecutor.execute("setVisible",(function(){I.dispatch(Object(L.b)(t.pageId,t.contextToken,e))}),[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])},t.prototype.getControlsDescriptor=function(e){var t=Object(i.Z)(e,{id:this.pageId},this.contextToken),n={};if(t)for(var r=0;r<t.length;r++){var a=t[r];n[a.Name]=a}return n},t.NAME="Footer",t}(w.a),V=n("RYq1"),G=n("sOTk"),W=n("gk6Q"),z=n("m8A1"),X=n("03gN"),q=n("kvLG"),U=function(){function e(e,t,n,r){var a="ClientApi.XrmProcessControlUI.constructor";r||Object(f.j)(a,"entity"),t||Object(f.j)(a,"contextToken"),n||Object(f.j)(a,"pageId"),e||Object(f.j)(a,"store"),j=e,this._pageId=n;var i=!1;if(Object(z.d)(j.getState(),this._pageId,a)){var o=Object(G.g)(j.getState(),this._pageId);this._processManager=Object(W.b)(this._pageId,o),i=!0}this._contextToken=t;var s=Object(z.b)(n,e.getState(),i);q.a.getInstance().eventManager.ReportComponentSuccess(a,s)}return e.prototype.getDisplayState=function(){var e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(o.a.instance.reportCall(e),!Object(z.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getDisplayState();return o.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getVisible=function(){var e="ClientApi.XrmProcessControlUI.getVisible";try{if(o.a.instance.reportCall(e),!Object(z.d)(j.getState(),this._pageId,e))return o.a.instance.reportSuccess(e),!1;var t=this._getProcessManager().isVisible();return o.a.instance.reportSuccess(e),t}catch(t){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.setDisplayState=function(e){var t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(o.a.instance.reportCall(t),!Object(z.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);e!==X.a.collapsed&&e!==X.a.expanded&&e!==X.a.floating||this._getProcessManager().setDisplayState(e),o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.setVisible=function(e){var t="ClientApi.XrmProcessControlUI.setVisible";try{if(o.a.instance.reportCall(t),!Object(z.d)(j.getState(),this._pageId,t))return void o.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),o.a.instance.reportSuccess(t)}catch(e){var n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.reflow=function(e,t,n){var r="ClientApi.XrmProcessControlUI.reflow";try{if(o.a.instance.reportCall(r),!Object(z.d)(j.getState(),this._pageId,r))return void o.a.instance.reportSuccess(r);this._getProcessManager().reflow(e,t,n),o.a.instance.reportSuccess(r)}catch(e){var a=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(r,e,null,a),e}},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(z.c)(this._processManager,j,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager},e}(),H=n("w/nD"),Y=n("UGbr"),K=n("yHpA"),Q=n("cAHA"),Z=n("9qYn"),J=n("yZTI"),$=n("0hCf"),ee=n("zPLw"),te=function(e){function t(t,n,r,i,o,s){var c=this;return P=t,(c=e.call(this,t,n,r,i,o,s,p.a)||this)._clientApiExecutorFormUI=new a.a(t,"ClientApi.XrmFormUI.",r,n),c._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:o,isEventParam:!0}),c}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"headerSection",{get:function(){var e="ClientApi.XrmFormUI.headerSection";try{return o.a.instance.reportCall(e),this._headerSection||(this._headerSection=new D(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerSection",{get:function(){var e="ClientApi.XrmFormUI.footerSection";try{return o.a.instance.reportCall(e),this._footerSection||(this._footerSection=new B(P,this.contextToken,this.pageId,this.formContext)),o.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.addControls=function(e){var t=b.a.getInstance().getEventParameters(this.contextToken),n={name:"controlName",value:""};for(var r in t.push(n),e)if(e[r]){n.value=r;var a=this.xrmControlFactory.createXrmControl(this.contextToken,e[r],this.formContext,"ClientApi.XrmFormUI.addControls",t);a&&this.controls.add(a.getName(),a)}},Object.defineProperty(t.prototype,"navigation",{get:function(){var e="ClientApi.XrmFormUI.navigation";try{return o.a.instance.reportCall(e),this._navigation||(this._navigation=new T(P,this.contextToken,this.pageId)),o.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"process",{get:function(){var e="ClientApi.XrmFormUI.process_get";try{o.a.instance.reportCall(e);var t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new U(P,this.contextToken,this.pageId,this.formContext.data.entity));var n=Object(z.a)(this.pageId,P.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return q.a.getInstance().eventManager.ReportComponentSuccess(e,n),o.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}},set:function(e){var t=Object(z.a)(this.pageId,P.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));q.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickForms",{get:function(){var e="ClientApi.XrmFormUI.quickForms";try{return o.a.instance.reportCall(e),this._quickForms||(this._quickForms=new s.a(e),this.controls),o.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}},enumerable:!1,configurable:!0}),t.prototype.clearFormNotification=function(e){var t="ClientApi.XrmFormUI.clearFormNotification";try{o.a.instance.reportCall(t);var n=P.dispatch(Object(l.b)(this.contextToken,this.pageId,e));return o.a.instance.reportSuccess(t),n}catch(e){throw this._reportFailure(t,e)}},t.prototype.close=function(){try{o.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(Z.a)(Object(J.b)(P.getState())===this.pageId)||P.dispatch(Object(V.e)(this.pageId)),o.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}},t.prototype.getFormType=function(){var e=this;return this._clientApiExecutorFormUI.execute("getFormType",(function(t,n){var r=e.getFormDescriptor(t,n);if(r){var a=e.formContext;if(a&&a.data&&a.data.entity&&Object(i.Lb)(P.getState(),a.data.entity.getEntityName(),d.a.tryParse(a.data.entity.getId())))return 4;if(Object(i.kb)(P.getState(),{id:e.pageId},e.contextToken))return 3;if(6===r.FormType)return 3;var o=Object(i.ac)(P.getState(),e.pageId,e.contextToken);if(o){var s=Object(K.b)(P.getState(),o);return s?s.mode===Q.a.Create?1:2:(n.push({name:"snapshotID",value:o}),e._clientApiExecutorFormUI.reportFailure(t+".getSnapshot",new Error("Snapshot is null or undefined"),n),0)}return a&&a.data&&a.data.entity&&!d.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0}))},t.prototype.isDialog=function(){var e=this;return this._clientApiExecutorFormUI.execute("isDialog",(function(){return Object(G.f)(P.getState(),e.pageId)}))},t.prototype.getViewPortHeight=function(){var e="ClientApi.XrmFormUI.getViewPortHeight";try{o.a.instance.reportCall(e);var t=Object(i.qb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.getViewPortWidth=function(){var e="ClientApi.XrmFormUI.getViewPortWidth";try{o.a.instance.reportCall(e);var t=Object(i.rb)(P.getState(),{id:this.pageId},this.contextToken);return o.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}},t.prototype.setFormEntityName=function(e){var t="ClientApi.XrmFormUI.setFormEntityName";Object(f.g)(e,t,"name");try{o.a.instance.reportCall(t),P.dispatch(Object(u.b)(this.pageId,this.contextToken,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.setFormNotification=function(e,t,n,r,a){var i=this;return this._clientApiExecutorFormUI.execute("setFormNotification",(function(o,s){var l;switch(Object(f.a)(n)&&(n="Random_String_"+Math.random()),t){case"ERROR":l=ee.a;break;case"WARNING":l=ee.e;break;case"INFORMATION":case"INFO":l=ee.b;break;default:Object(f.h)(o,"notificationLevel",t,s)}return!Object(f.a)(e)&&"string"==typeof e&&(P.dispatch(Object(c.c)(i.contextToken,i.pageId,e,l,n,r,a)),!0)}))},t.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormUI.addOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormUI.removeOnLoad";Object(f.g)(e,t,"handler");try{o.a.instance.reportCall(t),P.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),o.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}},t.prototype.refresh=function(){var e=this,t="ClientApi.XrmFormUI.refresh";try{o.a.instance.reportCall(t);var n=Object(G.l)(P.getState(),this.pageId);return P.dispatch(Object(Y.f)(this.pageId,n,!0,1,!0,!0)).then((function(n){return Object(Z.b)(e.formContext.data.entity),o.a.instance.reportSuccess(t),n})).catch((function(n){var r=b.a.getInstance().getEventParameters(e.contextToken);return Object(f.d)(P,n,t+".saveFormAndNavigate",r)}))}catch(e){var r=b.a.getInstance().getEventParameters(this.contextToken);return Object(f.d)(P,e,t,r)}},t.prototype._reportFailure=function(e,t){var n=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,n),t},t}($.a);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},H9DM:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("ygXU"),a="offline.upsync.pending";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:r.a.Pending};return{type:a,payload:e}}},"He+0":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return h}));var r=n("AX1v"),a=n("gKZ6"),i=n("nlyT"),o=n("AqHJ"),s=n("kh6f"),c=n("L+41"),l=n("5iz+");var u=n("0z0R"),d=n("c56u"),p=n("JlqV"),g="offline.opt.status";function h(e){return{type:"offline.opt.status.save",execute:function(t){var n=t.dispatch,g=(0,t.getState)(),h=Object(d.p)(g)===r.a.Enabled;if(e!==h)if(e)n(m(r.a.Enabled));else{if(!Object(p.b)(g))return n(Object(u.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(a.b)(!0)),e(m(r.a.Disabled)),s.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(i.c)(c.a.NotAvailable,l.a.None)),s.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+c.a.NotAvailable),e(Object(o.b)(!0)),s.c.info("Offline: offlineDisable: disableOffline: Completed")}(n)}return Promise.resolve()}}}function m(e){return{type:g,payload:{offlineFeatureStatus:e}}}},HfRC:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("xc1f"),a=n("Z1aD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u){var d={entityTypeName:e.etn,id:e.id,formId:n,data:i,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(a.a)(r.a,d,t)}},ITQc:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("c/eZ"),a=n("nuS9"),i=n("4fxQ"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this._updateDOMAttributes()},t.prototype.componentDidUpdate=function(){this._updateDOMAttributes()},t.prototype._updateDOMAttributes=function(){var e=i.findDOMNode(this);if(null!=e){var t=this.props,n=(t.children,t.style,t.className,Object(r.__rest)(t,["children","style","className"]));Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])}))}},t.prototype.render=function(){return a.Children.only(this.props.children)},t}(a.PureComponent),s=n("WziN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){var t=e.role,n=e.style,i=e.children,c=Object(r.__rest)(e,["role","style","children"]);return a.createElement(o,{role:t},a.createElement(s.a,Object(r.__assign)({style:n},c),i))}},Ini7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.removeOption";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},JFej:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.option.add";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i,o){var s=Object(r.x)(t);return{type:a,payload:{option:i,index:o},meta:{pageId:e,contextKey:s,dataFieldName:n}}}},JYE5:function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"r",(function(){return s})),n.d(t,"j",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return _})),n.d(t,"p",(function(){return C})),n.d(t,"q",(function(){return S})),n.d(t,"s",(function(){return j}));var r=n("c/eZ"),a=n("NxDw"),i="PersonalisationSettingHeader",o="Settings_Mobile_Settings",s="Settings_ToastNotification_Title",c="Web.NavBar.SettingsOpenNavTour_Caption",l="Settings_About",u="Settings_Privacy_Statement",d="Settings_Privacy_Statement_Link",p="Settings_Privacy_Statement_Link_Online",g="Settings_Advanced_Admin_Settings_Preview",h="Settings_Customization",m="Settings_Advanced_Settings",f="Settings_License_Terms",b="Settings_License_Terms_Link_IPad",v="Settings_License_Terms_Link_IPhone",y="Settings_License_Terms_Link_Android",_="Settings_License_Terms_Link_AndroidPhone",C="Settings_License_Terms_Link_Windows",S="Settings_License_Terms_Link_WindowsPhone",O=[i,o,s,"Settings_App_Page",c,l,"Web.NavBar.SettingsLearningPath_OptIn_Caption","Web.NavBar.SettingsLearningPath_OptOut_Caption",u,d,p,f,b,v,y,_,C,S],I=Object(r.__spreadArrays)(O,[g,h,m]);function j(e){return e===a.a.Browser?I:O}},Jcuz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var n={displayState:e};return{type:r.c,payload:n}}},Je7O:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r=function(){function e(){}return e.prototype.get_ErrorType=function(){return this._errorType},e.prototype.set_ErrorType=function(e){this._errorType=e},e.prototype.get_ErrorDescription=function(){return this._errorDescription},e.prototype.set_ErrorDescription=function(e){this._errorDescription=e},e}()},KDdL:function(e,t,n){"use strict";n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return v}));var r=n("9r0m"),a=n("G7N+"),i=n("dUXI"),o=n("8ADW"),s=n("y5DA"),c=n("lMVv"),l=n("Ww2r"),u=n("JlqV"),d=n("9rlF"),p=n("F2uj"),g=o.a;function h(e,t,n,a,d,p,h,m){return void 0===m&&(m=!1),function(e,t,n){if(!r.a.toString(n.viewId)){var a="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(g+".retrieveChartData",Error(a),o.d,t),new Error(a)}return!0}(n,a,d)&&function(e,t,n,a,o){if(!r.a.toString(n.visualizationId)||r.a.toString(n.visualizationId)===r.a.EMPTYGUIDSTRING){var u=e(),d=Object(l.b)(u,i.n),p=Object(c.f)(u,a)||a,g=String.format(d,p);return Object(s.a)(u,t,g,n,o),!1}return!0}(e,t,d,p,h)&&function(e,t,n,r){var a=e();if(!Object(u.b)(a)){var o=Object(l.b)(a,i.r);return Object(s.a)(a,t,o,n,r),!1}return!0}(e,t,d,h)&&function(e,t,n,r){if(n.isRollUpView){var a=e(),o=Object(l.b)(a,i.j);return Object(s.a)(a,t,o,n,r),!1}return!0}(e,t,d,h)&&(!m||function(e,t,n,r){if(!n.viewXml){var a=Object(l.b)(e(),i.g);return Object(s.a)(e(),t,a,n,r),!1}return!0}(e,t,d,h)&&function(e,t,n,r){if(!n.fetchXml){var a=Object(l.b)(e(),i.o);return Object(s.a)(e(),t,a,n,r),!1}return!0}(e,t,d,h))}function m(e,t,n){var i,o,s=new r.a(e),c=r.a.toString(s),l=new r.a(t),u=r.a.toString(l);return{type:n,payload:{charts:(i={},i[c]=(o={},o[u]={initialized:a.a.Initializing},o),i)}}}function f(e,t){var n;return{type:t,payload:{chartData:(n={},n[e]={initialized:a.a.Initializing},n)}}}function b(e,t,n){var r,a=null===(r=null==e?void 0:e.category)||void 0===r?void 0:r.primaryGroupBy,i=null==a?void 0:a.groupAttribute;if(function(e,t){var n;if(!e)return!1;var r=null===(n=null==e?void 0:e.entity)||void 0===n?void 0:n.entityName,a=null==e?void 0:e.attributeName,i=Object(p.b)(a,r,t);return"picklist"===i||"state"===i||"status"===i}(i,n)&&e.isOrderPresentOnPrimaryGroupBy()){var o=i.aliasName,s=new y(o);t.sort(s.comparator),a.descending&&t.reverse()}}function v(e){var t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,n=e.match(new RegExp(t,"g")),r=[];return n&&n.forEach((function(e){r=e.match(new RegExp(t,"m"))})),r}var y=function(){function e(e){var t=this;this._primaryGroupByAttributeAlias=null,this.comparator=function(e,n){return t._getRawValue(e)-t._getRawValue(n)},this._primaryGroupByAttributeAlias=e}return e.prototype._getRawValue=function(e){if(this._primaryGroupByAttributeAlias in e.fields){var t=e.fields[this._primaryGroupByAttributeAlias],n=Object(d.e)(t);return parseInt(n,10)}return-1},e}()},KReh:function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"h",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"p",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"a",(function(){return _}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="Settings_Server_Version",a="Settings_App_Version",i="Settings_Client_Version",o="Settings_Server_Version_Format",s="Settings_Org_Name",c="Settings_Brand_Title",l="Brand_PowerApps",u="Settings_Client_Session_Id",d="Settings_Host_Session_Id",p="Settings_Host_Context_Id",g="Settings_Host_Version",h="Settings_ExternalCorrelation_Id",m="Settings_Current_Time",f="Settings_Preview_Notification",b="Settings_Oct2019_Preview_Notification",v="Settings_Apr2020_Preview_Notification",y="Settings_Oct2020_Preview_Notification",_=[r,a,i,"Settings_Privacy_Statement","Settings_License_Terms",o,s,c,l,"Settings_Privacy_Statement_Link","Settings_Privacy_Statement_Link_Online",u,d,p,g,h,m,f,b,v,y]},KZbu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("Sscr"),a=n("HSdq"),i=n("1Tfq"),o=n("RYq1"),s=n("71iK"),c=n("IQF2");function l(e,t){return{type:"cancel.quickCreateFormAction.async",execute:function(n,o){var s=n.dispatch,l=n.getState,d=l(),p=Object(r.j)(l(),e);return c.a.getInstance().checkForOutstandingWork(l()).then((function(){if(Object(a.Nb)(d,e,p))return s(Object(i.a)(e)).then((function(n){if(!n)return Promise.resolve({});u(s,e,t)}));u(s,e,t)}))}}}function u(e,t,n){if(n&&n.length>0){e(Object(o.e)(t,"save"));for(var r=[n[0].etn],a=1;a<n.length;a++){for(var i=!1,c=0;c<r.length;c++)r[c]===n[a].etn&&(i=!0);i||r.push(n[a].etn)}for(c=0;c<r.length;c++)e(Object(s.a)(r[c]))}else e(Object(o.e)(t))}},Kdvm:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("9r0m"),a=function(){function e(){}return e.prototype.generate=function(e,t){return t&&t.getProcessId()?{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:r.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:r.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}:null},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},LBS5:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return N})),n.d(t,"c",(function(){return D})),n.d(t,"e",(function(){return R})),n.d(t,"d",(function(){return L}));var r,a,i=n("TJkj"),o=n("UOiB"),s=n("kvLG"),c=n("mPpC"),l=n("Y+r4"),u=n("c/eZ"),d=n("ZOZo"),p=n("0hCf"),g=n("G9wF"),h=n("T4u8"),m=n("9r0m"),f=n("ixd0"),b=n("JX21"),v=n("1z64"),y=n("5KPK"),_=function(e){function t(t,n,a,i){var o=e.call(this,t,n,a,i)||this;return o._dashboardId=t,r=a,o._clientApiExecutor=new v.a(a,"ClientApi.XrmDashboardSelectorItem.",i),o}return Object(u.__extends)(t,e),t.prototype._getEventParams=function(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:m.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])},Object.defineProperty(t.prototype,"isBoundDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isBoundDashboard_get",(function(){var t=Object(b.a)(r.getState(),e._dashboardId);return!t||1032==+t.Type}),this._getEventParams())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUserDashboard",{get:function(){var e=this;return this._clientApiExecutor.execute("isUserDashboard_get",(function(){var t=Object(b.a)(r.getState(),e._dashboardId);return Object(b.c)(t)}),this._getEventParams())},enumerable:!1,configurable:!0}),t.prototype.navigate=function(){var e=this;this._clientApiExecutor.executeAsync("navigate",(function(){return r.dispatch(Object(y.a)(null,e._dashboardId,null,null,null,null,e.getPageId()))}),this._getEventParams())},t}(f.a),C=function(e){function t(t,n,r,a,i){var o=h.c;if(a){var s=t.getState(),c=Object(h.g)(s,a);c&&c[r.guid]&&(o=h.g)}return e.call(this,t,n,r,a,i,o,_)||this}return Object(u.__extends)(t,e),t}(g.b),S=function(e){function t(t,n,r,a,i,o){return e.call(this,t,n,r,a,i,o,C)||this}return Object(u.__extends)(t,e),t}(p.a),O=function(e){function t(t,n,r,i,o,s){var c=e.call(this,t,n&&n.etn,i,o,(function(){return S}),r)||this;return a=t,c._getCommands=s,c._apiExecutor=new v.a(t,"ClientApi.XrmDashboard.",o,i),c}return Object(u.__extends)(t,e),Object.defineProperty(t.prototype,"commands",{get:function(){var e=this;return this._apiExecutor.execute("commands_get",(function(){return e._commands||(e._commands=e._getCommands(a,e.contextToken,e.pageId))}))},enumerable:!1,configurable:!0}),t}(d.a),I=n("7bez"),j=n("Dlr/"),P=n("1PXy"),x=n("h82J"),E=n("HSdq"),T=n("IiPO"),w=n("ks02"),A=n("+Z9T"),F=n("W1TM");function N(e,t,n,r){return M((function(n,a){return new O(n,a,new c.b(n,t),e,t,r)}),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,n,!1)}function k(e,t,n,r){return M((function(n,r){return new l.a(n,r,new c.b(n,t),e,t)}),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,n,!0,r)}function M(e,t,n,r,a,o,c,l){return{type:t,sync:!0,execute:function(t,u){Object(A.g)(r,n,"contextToken"),Object(A.g)(a,n,"pageId"),c&&Object(A.g)(o,n,"entityTypeName");try{var d=t.dispatch(Object(x.b)(a,r));if(!d){(d=e(t,{etn:o,id:l})).applicationContext=u;var p=new w.a(t,a);if(d.context=p,!r.parentContextToken){var g=u.ClientApiManager.getClientApiEntry(a);Object(i.b)("form.initialization",(function(){g.xrmInstance.Page=d})),g.primaryContextToken=r}}return d}catch(e){var h=T.a.getInstance().getEventParameters(r);throw h.push({name:"entityTypeName",value:o}),s.a.getInstance().eventManager.ReportComponentFailure(n,e,null,h),e}}}}function D(e,t,n,r,a){var i="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute:function(c,l){Object(A.g)(e,i,"contextToken"),Object(A.g)(t,i,"pageId");try{var u=c.dispatch(Object(x.c)(t,e));if(!u){if(3===r){var d=Object(E.s)(c.getState(),{id:t,controlName:a},e.parentContextToken);if(d){var p=c.dispatch(Object(x.b)(t,e.parentContextToken));return new j.a(c,e.parentContextToken,t,a,n,p,d,l)}(g=T.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),g.push({name:"gridType",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(i,new Error("Control descriptor could not be found for subgrid control"),null,g)}if(u=new I.a(c,e,t,n,r,!1,l,a),!e.parentContextToken&&e.contextTokenType===o.a.MainGrid)l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}return u}catch(t){var g;throw(g=T.a.getInstance().getEventParameters(e)).push({name:"controlName",value:a}),g.push({name:"gridType",value:r}),s.a.getInstance().eventManager.ReportComponentFailure(i,t,null,g),t}}}}function R(e,t,n,r){var a="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute:function(i,o){Object(A.g)(e,a,"contextToken"),Object(A.g)(t,a,"pageId"),Object(A.g)(n,a,"controlName"),Object(A.g)(r,a,"controlId");try{var c=i.dispatch(Object(x.b)(t,e.parentContextToken)),l=null;switch(n){case"notescontrol":if(!(l=i.dispatch(Object(x.f)(t,e)))){var u=Object(E.s)(i.getState(),{id:t,controlName:n},e.parentContextToken);l=new P.a(i,e.parentContextToken,t,u,n,r,c,o)}break;default:(d=T.a.getInstance().getEventParameters(e)).push({name:"controlName",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(a,new Error("Failed to create and return the control"),null,d)}return l}catch(t){var d;throw(d=T.a.getInstance().getEventParameters(e)).push({name:"controlName",value:n}),s.a.getInstance().eventManager.ReportComponentFailure(a,t,null,d),t}}}}function L(e,t){var n="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute:function(r,a){Object(A.g)(e,n,"contextToken"),Object(A.g)(t,n,"pageId");try{var i=r.dispatch(Object(x.g)(t,e));if(!i&&(i=new F.a(r,e,t),!e.parentContextToken)){var o=a.ClientApiManager.getClientApiEntry(t);o.xrmInstance.Page=i,o.primaryContextToken=e}return i}catch(t){var c=T.a.getInstance().getEventParameters(e);throw s.a.getInstance().eventManager.ReportComponentFailure(n,t,null,c),t}}}}},LFYt:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n("mVnn"),a="quickCreateForm.output";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){return{type:"quickCreateForm.output.async",execute:function(n){var i=n.dispatch,o=n.getState,s=Object(r.a)(o(),e)||[];return s.push(t),i(function(e,t){return{type:a,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,s)),Promise.resolve(e)}}}},LXYY:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("ZYGP"),a=n("tlts"),i=n("EZ4w"),o=r.a.roundToNearestPixel(.4);0===o&&(o=1/r.a.get());var s=parseFloat(o.toFixed(2))+"px",c="web"===a.a.OS?s:i.a.hairlineWidth},LdMy:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n("90Ov"),a=n("WS0f"),i=function(){function e(){}return Object.defineProperty(e.prototype,"invocationSource",{get:function(){return this._invocationSource},set:function(e){this._invocationSource=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"workflowStep",{get:function(){return this._workflowStep},set:function(e){this._workflowStep=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},set:function(e){this._businessProcessFlowVisitor=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentEntityName",{get:function(){return this._currentEntityName},set:function(e){this._currentEntityName=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"processManager",{get:function(){return this._processManager},set:function(e){this._processManager=e},enumerable:!1,configurable:!0}),e.prototype.getStageStep=function(e){if(Object(a.b)(e)||!this._businessProcessFlowVisitor)return null;var t=this._businessProcessFlowVisitor.get_stagesById()[Object(r.a)(e)];return t||null},e}(),o=n("c/eZ"),s=function(e){function t(t){return e.call(this,Object(r.a)(t))||this}return Object(o.__extends)(t,e),t}(function(){function e(e){this.value=e,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e.prototype.getNext=function(){return this._next},e.prototype.setNext=function(e){this._next=e},e}()),c=function(){function e(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}return e.prototype.find=function(e,t){if(e=Object(r.a)(e),t){for(var n in this._rootNodesValue)if(e===this._rootNodesValue[n])return this._rootNodes[n];return null}for(var n in this._rootNodes){var a=this._rootNodes[n];if(a.value===e)return a;for(;null!=a.getNext();)if((a=a.getNext()).value===e)return a}return null},e.prototype.getNode=function(e){return this._rootNodes[e]},e.prototype.setNode=function(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value},e.prototype.getDefaultPath=function(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray},e.prototype.addAfter=function(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new s(null)):this._addAfterInternal(e,t)},e.prototype.getDefaultPathHash=function(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash},e.prototype._ensureLatestDefaultPathIsCalculated=function(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())},e.prototype._recaculateDefaultPath=function(){this._defaultPathArray=[];for(var e=0;e<this._rootNodes.length;e++){var t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){var n=t.getNext();n.value&&(this._defaultPathArray[this._defaultPathArray.length]=n.value),t=n}}return this._defaultPathArray},e.prototype._addAfterInternal=function(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1},e.prototype._generateDefaultPathCalculatedTimeHash=function(){var e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e},e}(),l=function(){function e(){}return e.prototype.pathChanged=function(e){this._handler&&!Object(a.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)},e.prototype.getHandler=function(){return this._handler},e.prototype.setHandler=function(e){this._handler=e},e}(),u=function(){function e(e,t){this._nextStage=t,this._parentStage=e}return Object.defineProperty(e.prototype,"parentStage",{get:function(){return this._parentStage},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextStage",{get:function(){return this._nextStage},enumerable:!1,configurable:!0}),e}(),d=function(){function e(e,t,n){this._context=e,this._defaultPath=t,this._staticPath=n}return e.prototype.calculate=function(){for(var e=this._startingNodeInDefaultPath(),t=0;t<this._staticPath.length;t++){var n=this._staticPath[t];if(this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(n)){var r=this._defaultPath.find(n,!0);r?e=r:(this._defaultPath.addAfter(e,new s(n)),e=e.getNext())}}this._lastEvaluatedNode=e},e.prototype.getLastEvaluatedNodeInDefaultPath=function(){return this._lastEvaluatedNode},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._startingNodeInDefaultPath=function(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode},e}(),p=function(){function e(e,t){this._defaultPath=t,this._context=e}return e.prototype.calculate=function(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()},e.prototype.getLastDefaultNode=function(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_staticPathToDefaultPathCalculator",{get:function(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new d(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),g=function(){function e(e,t){this._context=e,this._defaultPath=t}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()},Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),e.prototype.getLastCalculatedDefaultNode=function(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null},e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraveresedStages=function(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_traversedDefaultPathCalculator",{get:function(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new p(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e){this.context=e}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._stageStep},set:function(e){this._stageStep=e},enumerable:!1,configurable:!0}),e.prototype.tryExecute=function(){var e=Object(r.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)},e}(),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)},t.prototype._sanitizeGuidForFunctionName=function(e){if(Object(a.b)(e))return e;for(e=Object(r.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e},t}(h),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.executeCondition=function(){var e=Object(r.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(t){var n=t.findElseBranch(),a=null;if(n&&n.get_Steps().get_Count()>0)a=n.get_Steps().get_item(0).get_stageId();this._invokeReflowFunction(e,a)}},t.prototype._invokeReflowFunction=function(e,t){this.context.processManager.reflow(!1,e,t)},t}(h),b=function(){function e(){}return e.prototype.getStageCommand=function(e,t){var n=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(r.a)(t.get_stageId())];return e.currentEntityName!==n.get_EntityLogicalName()?new f(e):new m(e)},e}(),v=function(){function e(e,t,n){this._defaultPath=t,this._cascadeUpdate=n,this._context=e,this._businessRuleCommandFactory=new b}return e.prototype.handleChange=function(e,t){var n=this._defaultPath.find(e,!1);if(null!=n){var r=Object(a.b)(t)?null:t,i=new s(r);this._defaultPath.addAfter(n,i),r&&this.triggerSubsequentDefaultPathCalculation(i)}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(e){var t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){var n=this._context.getStageStep(t).get_nextStageId();if(!n)return;var r=this._defaultPath.find(n,!0);if(r)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(r));this._defaultPath.addAfter(e,new s(n)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}},e.prototype._tryExecuteConditionForStage=function(e){var t=this._context.invocationSource;try{this._context.invocationSource="internal";var n=this._context.getStageStep(e.value),r=this._businessRuleCommandFactory.getStageCommand(this._context,n);if(r.stage=n,!r.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1},e}(),y=function(){function e(e,t,n){this._context=e,this._listener=t,this._defaultPath=n}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startNode},set:function(e){this._startNode=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!0)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),_=function(){function e(e,t,n){this._context=e,this._listener=t,this._initialDefaultPath=n}return e.prototype.calculate=function(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()},Object.defineProperty(e.prototype,"startingNodeInDefaultPath",{get:function(){return this._startingNodeInDefaultPath},set:function(e){this._startingNodeInDefaultPath=e},enumerable:!1,configurable:!0}),e.prototype.getDefaultPath=function(){return this._defaultPath},e.prototype._calculateForTraversedStages=function(){this._defaultPath=this._initialDefaultPath},e.prototype._calculateForNonTraversedStages=function(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()},Object.defineProperty(e.prototype,"_nonTraversedDefaultPathCalculator",{get:function(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator},enumerable:!1,configurable:!0}),e}(),C=function(){function e(e,t,n){this._context=e,this._changeListener=t,this._defaultPath=n}return e.prototype.calculate=function(){var e=this._pathChangeHandler;this._changeListener.setHandler(e)},e.prototype.getDefaultPath=function(){return this._defaultPath},Object.defineProperty(e.prototype,"_pathChangeHandler",{get:function(){return this.__pathChangeHandler||(this.__pathChangeHandler=new v(this._context,this._defaultPath,!1)),this.__pathChangeHandler},enumerable:!1,configurable:!0}),e}(),S=n("9r0m"),O=function(){function e(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new l,this._initializeDefaultPathFromRootStages()}return e.prototype.initializeComplete=function(){var e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();var t=this._context.processManager.getSelectedStageId(),n=this._context.processManager.getActivePath(),r=!Object(a.a)(t)&&!Object(a.a)(n),i=r&&n.findIndex((function(e){return e.guid.toString()===t}))<0,o=r&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())},e.prototype.updateDefaultPath=function(e,t){if(e){var n=null;if("internal"!==this._context.invocationSource&&(n=this.defaultPathHash()),this._changeListener.pathChanged(new u(e,t)),"internal"!==this._context.invocationSource)if(n!==this.defaultPathHash()){var r=this.getDefaultPath();this._context.processManager.setActivePath(r)}}},e.prototype.triggerSubsequentDefaultPathCalculation=function(e){if(!!S.a.tryParseOrNull(e)&&!!this.getDefaultPath().find((function(t){return t.toLowerCase()===e.toLowerCase()}))){var t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new s(e)),"internal"!==this._context.invocationSource)if(t!==this.defaultPathHash()){var n=this.getDefaultPath();this._context.processManager.setActivePath(n)}}},e.prototype.getDefaultPath=function(){return this._defaultPath.getDefaultPath()},e.prototype.defaultPathHash=function(){return this._defaultPath.getDefaultPathHash()},e.prototype.getNextStage=function(e){var t=this.getDefaultPath(),n=t.indexOf(Object(r.a)(e));return-1!==n&&n<t.length-1?t[n+1]:null},e.prototype.getPreviousStage=function(e){var t=this.getDefaultPath(),n=t.indexOf(Object(r.a)(e));return n<=0?null:t[n-1]},e.prototype._initializeDefaultPathFromRootStages=function(){this._defaultPath=new c;var e=this._context.businessProcessFlowVisitor.get_firstLevelStages(),t=0;for(var n in e)this._defaultPath.setNode(t,new s(n)),t++},e.prototype._initializeTraversedPath=function(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()},e.prototype._initializeNonTraversedPath=function(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()},Object.defineProperty(e.prototype,"_loadTimeDefaultPathCalculator",{get:function(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new g(this._context,this._defaultPath)),this._loadTimePathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_afterLoadPathCalculator",{get:function(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_runTimePathCalculator",{get:function(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new C(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator},enumerable:!1,configurable:!0}),e}(),I=n("HSdq"),j=function(){function e(){}return e.prototype.setPrimaryModel=function(e){this._primaryModelName=e},e.prototype.getDefaultPathManager=function(){return this._defaultPathManager},e.prototype.setObjectModel=function(e){var t=this,n=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),r={};e.businessProcessFlowEntities.forEach((function(e){if(t._isRelationshipStep(e)){var a=t._createRelationshipCollectionStep(n,e);a&&n.appendStep(a)}else{var i=t._createEntity(n,e);i&&(n.appendStep(i),r.hasOwnProperty(i.get_EntityLogicalName())||(r[i.get_EntityLogicalName()]=!0))}})),n.set_Name(e.businessProcessFlowName),n.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=n,this._initializeVisitor()},e.prototype.initializeDefaultPathManager=function(e,t){var n=new i;n.processManager=t,n.businessProcessFlowVisitor=this._businessProcessFlowVisitor,n.workflowStep=this._processObjectModel,n.currentEntityName=this._primaryModelName,this._defaultPathManager=new O(e,n),this._defaultPathManager.initializeComplete()},Object.defineProperty(e.prototype,"businessProcessFlowVisitor",{get:function(){return this._businessProcessFlowVisitor},enumerable:!1,configurable:!0}),e.prototype.getEntityStages=function(){if(!this._processObjectModel)return null;var e=this._processObjectModel.get_Steps(),t=[];if(e){for(var n=0;n<e.get_Count();n++){var r=e.get_item(n);r&&r instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(n))}return t}return null},e.prototype.getRequiredFlowStepsForStage=function(e,t,n,r){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);this._isFlowStep(c)&&c.get_isProcessRequired()&&a.push(c.get_Id())}return a},e.prototype.getRequiredAttributesForStage=function(e,t,n,r){var a=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");var o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(var s=0;s<o.get_Count();s++)if(o.get_item(s)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var c=o.get_item(s);if(!this._isActionStep(c)&&!this._isFlowStep(c))if(c.get_isProcessRequired())a.push(c.get_Description());else{var l=this._getDataFieldNameFromStepStep(c);l&&this._isRequiredAttribute(l,t,n,r)&&a.push(c.get_Description())}}return a},e.prototype._getDataFieldNameFromStepStep=function(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){var t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null},e.prototype._isRequiredAttribute=function(e,t,n,r){return null!=e&&2===Object(I.pc)(r,t,n,e)},e.prototype._isFlowStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0;return!1},e.prototype._isActionStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0;return!1},e.prototype._isControlStep=function(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0&&e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0;return!1},e.prototype._initializeVisitor=function(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)},e.prototype._isRelationshipStep=function(e){return!(!e||!e.hasOwnProperty("relationships"))},e.prototype._createEntity=function(e,t){var n=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);n.set_Name(t.entityLogicalName),n.set_Description(t.entityDisplayName),n.set_relationshipName(t.relationshipName),n.set_attributeName(t.referencingAttributeName),n.set_parent(e);var r=this._createStage(e,t.stage);n&&r&&n.appendStep(r);for(var a=0;a<t.stage.steps.length;a++){var i=this._createStep(e,t.stage.steps[a]);i&&r.appendStep(i)}var o=this._createConditionStep(e,r,t.stage);return o&&r.appendStep(o),n},e.prototype._createRelationshipCollectionStep=function(e,t){var n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(n.set_workflow(e),t.relationships)for(var r=0;r<t.relationships.length;r++){var a=this._createRelationshipStep(e,t.relationships[r]);n.appendStep(a)}return n},e.prototype._createRelationshipStep=function(e,t){var n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return n.set_workflow(e),n.set_sourceStageId(t.sourceStageId.guid),n.set_targetStageId(t.targetStageId.guid),n.set_attributeName(t.attributeName),n.set_relationshipName(t.relationshipName),n},e.prototype._createStage=function(e,t){var n=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return n.set_Id(t.stageId.guid),n.set_stageId(t.stageId.guid),n.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),n.set_stageCategory(t.stageCategory),n},e.prototype._createStep=function(e,t){var n="action"===t.stepType.toLowerCase()?t.label:t.name,r=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,n||"dummy");r.set_isProcessRequired(t.required),r.set_Name(t.label),r.set_Id(t.stepId?t.stepId.guid:""),r.set_workflow(e);var a=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(a.set_dataFieldName(n),"action"===t.stepType.toLowerCase()){var i=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);i.set_Name(n),i.set_actionControl(a),r.appendStep(i)}else if("modernflow"===t.stepType.toLowerCase()){var o=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);o.set_Name(n),o.set_flowControl(a),r.appendStep(o)}else r.appendStep(a);return r},e.prototype._createConditionStep=function(e,t,n){if(!n.conditionJson)return null;var r=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return r.set_parent(t),r.initializeFromDynamic(JSON.parse(n.conditionJson)),r.fixLinks(),r},e.prototype.getProcessObjectModel=function(){return this._processObjectModel},e.prototype.getStage=function(e){return Object(a.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null},e.prototype.getPreviousStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e.prototype.getNextStageId=function(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){var t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null},e}()},LhJP:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"o",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"q",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="BusinessProcessFlow.MoveToNextStage",a="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",p="BusinessProcessFlow.SetActiveProcessInstance",g="BusinessProcessFlow.ActionStep",h="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",f="BusinessProcessFlow.RenderProcessControl",b="BusinessProcessFlow.HideProcessControlForUciOffline",v="SaveFailureReason",y="faultedSnapshotId"},Nhrb:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n("Sscr"),a=n("uO/V"),i="control.update.parameter";function o(e,t,n,o,s){return{type:"control.update.parameter.async",execute:function(c,l){var u=c.dispatch,d=(c.getState,a.x+".updateControlParameterAction");u(function(e,t,n,o,s){var c=Object(r.v)(s);return{type:i,payload:{name:n,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:a.o}}}(e,0,n,o,s));var p=[];return p.push({name:"controlName",value:t}),p.push({name:"paramName",value:""+n}),l.EventManager.ReportComponentSuccess(d,p),Promise.resolve()}}}},NiE3:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n("cZkS"),a=n("qC0c"),i=n("oVzJ"),o=n("DgF7"),s=n("NxDw"),c=n("i8/j"),l=n("455M"),u=n("uO/V");function d(e,t){return Object(a.c)(e,r.Md)&&Object(i.a)(e)&&0===t&&Object(o.a)(e)===s.a.MobileApplication}function p(e,t,n,r){var a,i=Object(c.b)(e,t,n,r),o=null===(a=null==i?void 0:i.ClassId)||void 0===a?void 0:a.guid;return o&&l.a.ClassIdControlMap[o.toLowerCase()]===u.t}},Oiu5:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n("Gemh");function a(e){var t=Object(r.m)(e),n=e&&e.metadata?e.metadata.entities:null,a=[];return n?(t.forEach((function(e){if(4200!==n[e].ObjectTypeCode){var t=function(e){var t=e.DisplayName,n=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:n}}(n[e]);a.push(t)}})),a.sort(i)):a}function i(e,t){var n=e.entityDisplayName,r=t.entityDisplayName,a=0;return n>r?a=1:n<r&&(a=-1),a}function o(e){for(var t=[],n=0;n<e.length;n++){var r={key:e[n].objectTypeCode,text:e[n].entityDisplayName};t.push(r)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map((function(e){return{key:e.value,text:e.text}})):[]}},OmYs:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="section.label";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,sectionName:n}}}},PLtI:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="tab.setlabel";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.v)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,tabId:n}}}},PZxu:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r,a=n("Gemh"),i=n("Zy0S"),o=n("XJ3n"),s=n("+Z9T"),c=n("Sscr"),l=n("9r0m"),u=n("TCcM"),d=n("QAhb"),p=n("9rlF"),g=n("IiPO"),h=n("w/nD"),m=n("ezfI"),f=n("/j9Z"),b=n("kvLG"),v=function(){function e(e,t,n,a,i,o,c){var l="ClientApi.XrmControlGrid.constructor";if(a||Object(s.j)(l,"pageId"),n||Object(s.j)(l,"contextToken"),e||Object(s.j)(l,"store"),i||Object(s.j)(l,"gridEntity"),Object(s.a)(o)&&Object(s.j)(l,"isEditable"),r=e,this._applicationContext=t,this._contextToken=n,this._pageId=a,this._gridEntityName=i,this.controlName=c,this._isEditable=o,!this._contextToken.contextTokenType){var u=g.a.getInstance().getEventParameters(this._contextToken);u.push({name:"controlName",value:this.controlName}),u.push({name:"gridEntityName",value:this._gridEntityName}),g.a.getInstance().reportFailure(l,new f.a("context token passed to grids with empty context token type"),null,u)}}return Object.defineProperty(e.prototype,"_isEditable",{get:function(){var e=Object(a.V)(r.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){var t=g.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure("ClientApi.XrmControlGrid._isEditable_get",new f.a("control configuration parameters not found"),null,t),this._isGridEditable}return e},set:function(e){this._isGridEditable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applicationContext",{get:function(){return m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext},set:function(e){m.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")},enumerable:!1,configurable:!0}),e.prototype.getTotalRecordCount=function(){var e="ClientApi.XrmControlGrid.getTotalRecordCount";try{m.a.instance.reportCall(e);var t=Object(a.Y)(r.getState(),this._pageId,this._contextToken);if(t){var n=JSON.parse(t),i=n&&n.totalResultCount?n.totalResultCount:0;return m.a.instance.reportSuccess(e),i}return m.a.instance.reportSuccess(e),0}catch(t){var o=g.a.getInstance().getEventParameters(this.contextToken);throw o.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(e,t,null,o),t}},e.prototype.getRows=function(){var e="ClientApi.XrmControlGrid.getRows";try{m.a.instance.reportCall(e);var t=new i.a(e),n=r.getState(),s=Object(a.H)(n,this.contextToken,{id:this.pageId});if(s)for(var l=0;l<s.length;l++){var u=s[l].identifier.id,d=this._getRowEntityName(s[l],u),p=new o.a(r,this._applicationContext,Object(c.f)(this.contextToken,u,d),this.pageId,d,u),h=s[l].identifier.id.guid;t.add(h,p)}return m.a.instance.reportSuccess(e),t}catch(t){var f=g.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.getSelectedRows=function(){var e="ClientApi.XrmControlGrid.getSelectedRows";try{m.a.instance.reportCall(e);var t=new i.a(e),n=Object(a.fb)(r.getState(),this.pageId,this.contextToken);if(n)for(var s=Object(a.Q)(r.getState(),this.pageId,this.contextToken),d=function(e){var i=void 0;if(s)i=s;else{var d=r.getState(),g=Object(a.v)(d,p.pageId,p.contextToken),h=(g&&g.queryKey&&Object(u.q)(d,g.queryKey,null,null,!0)||[]).find((function(t){return t.identifier&&l.a.equals(t.identifier.id,n[e])}));i=p._getRowEntityName(h,n[e])}var m=new o.a(r,p._applicationContext,Object(c.f)(p.contextToken,n[e],i),p.pageId,i,n[e]),f=n[e].guid;t.add(f,m)},p=this,h=0;h<n.length;h++)d(h);return m.a.instance.reportSuccess(e),t}catch(t){var f=g.a.getInstance().getEventParameters(this.contextToken);throw f.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(e,t,null,f),t}},e.prototype.addOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),r.dispatch(Object(h.m)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(t,e,null,n),e}}},e.prototype.removeOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(s.j)(t,"handler");try{m.a.instance.reportCall(t),r.dispatch(Object(h.H)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(t,e,null,n),e}}},e.prototype.runOnRecordSelect=function(e){var t="ClientApi.XrmControlGrid.runOnRecordSelect";try{m.a.instance.reportCall(t),this._isEditable&&r.dispatch(Object(h.T)(this.contextToken,this.pageId,e,this.controlName)),m.a.instance.reportSuccess(t)}catch(e){var n=g.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),g.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype._getRowEntityName=function(e,t){var n=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===n){var a=Object(u.j)(r.getState(),new d.a(this._gridEntityName,t),"activitytypecode");if(Object(p.j)(a))return a.value}return n},Object.defineProperty(e.prototype,"pageId",{get:function(){return this._pageId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"contextToken",{get:function(){return this._contextToken},enumerable:!1,configurable:!0}),e}()},PhZR:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="navigation.item.label";function a(e,t,n,a){return{type:r,payload:{label:n,currentLanguageId:a},meta:{pageId:e,navigationItemId:t}}}},"Pm+b":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("7z0H"),a=n("bCrZ"),i=n("Sscr");function o(e,t,n){var a=Object(i.v)(n),o={xrmReady:e};return{type:r.b,payload:o,meta:{pageId:t,contextKey:a}}}function s(e,t,n){var r=Object(i.u)(n),o={xrmReady:e};return{type:a.b,payload:o,meta:{pageId:t,contextKey:r}}}},Q60c:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="controls.DefaultView";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.v)(n);return{type:a,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},QItn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="control.mrudisabled";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i,o){var s=Object(r.v)(i);return{type:a,payload:o,meta:{pageId:t,controlName:n,contextKey:s}}}},Qeyq:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){return{tabId:"",navigationStack:[]}}n.d(t,"a",(function(){return r}))},SdPQ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="header.bodyvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},SgZb:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("c/eZ"),a=n("HSdq"),i=n("+ieV"),o=n("zsi3"),s=n("yHpA"),c=n("Sscr"),l=n("UGbr"),u=n("LFYt"),d=n("71iK"),p=n("p5Y6"),g=n("zpQF"),h=n("8//c"),m=n("Srej");function f(e,t){return{type:"saveAndNew.quickCreateFormAction.async",execute:function(n,f,b){var v=n.dispatch,y=(0,n.getState)(),_=Object(c.j)(y,t),C=Object(a.zb)(y,t,_),S=Object(a.ac)(y,t,_);if(Object(s.g)(y,S)||!C)return v(Object(l.e)(t,59)).then((function(n){var i=Object(a.Ib)(y,t),o=i?"Forms.MainFormDialogRoot.SaveAndNew":"Forms.QuickCreateFormRoot.SaveAndNew";if(n){var s=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:n.etn}];return f.EventManager.ReportComponentSuccess(o,s),(i?Promise.resolve(t):v(Object(u.b)(t,n))).then((function(a){return v(Object(d.a)(n.etn)),v(Object(p.a)(a)).then((function(){var a=Object(r.__assign)(Object(r.__assign)({},e),{id:null});return v(Object(g.b)(a,t)),v(Object(h.b)(t,!0)),n}))}))}f.TraceManager.getTracer().error("Record is not created",[{name:"isEntityRefNull",value:!0}])})).catch((function(e){f.TraceManager.getTracer().error("Record is not created",e)}));for(var O in C){var I=C[O].label,j=C[O].errorMessage,P=v(Object(i.b)(I,j));v(Object(i.c)(_,t,P,o.a.error,Object(m.d)(t,O)))}}}}},TCDU:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("1Tfq"),a=n("aGOT"),i=n("HSdq"),o=n("kk/C"),s=n("OTOS"),c=n("Sscr"),l=n("yHpA"),u=n("2p2B"),d=n("Srej");function p(e){return{type:"handle.unsaved.changes.async",execute:function(t,n,p){var g=t.dispatch,h=t.getState;return g(Object(r.a)(e)).then((function(t){if(t){for(var n=Object(s.a)(h(),e),r=n.map((function(e){return Object(c.j)(h(),e)})),p=0;p<n.length;p++){for(var m=n[p],f=r[p],b=Object(i.ac)(h(),m,f),v=Object(l.b)(h(),b),y=0,_=(null==v?void 0:v.activeChanges)?Object.keys(v.activeChanges):[];y<_.length;y++){var C=_[y];g(Object(u.b)(f,m,Object(d.d)(m,C)))}g(Object(a.c)(m,b,f)),g(Object(o.d)(m,f))}return!0}return!1}))}}}},TXh4:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return C})),n.d(t,"b",(function(){return _}));var r=n("EGsq"),a=n("KReh"),i=n("Ww2r"),o=n("DgF7"),s=n("7icM"),c=n("cZkS"),l=n("qC0c"),u=n("nyD2"),d=n("7EJx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t){return{label:Object(i.c)(t,a.b),value:Object(o.j)(e)}}function g(e){return{label:Object(i.c)(e,a.f),value:window.VERSION_NUMERIC_VALUE}}function h(e,t){var n=Object(i.c)(t,a.h),r=Object(s.a)(e);return{label:n,value:r?r.externalCorrelationId:""}}function m(e,t){return{label:Object(i.c)(t,a.n),value:Object(r.y)(e).organizationName}}function f(e,t){var n,o=null===(n=Object(r.x)(e))||void 0===n?void 0:n.isCrmOrg,s=Object(i.c)(t,o?a.d:a.o);return Object(u.b)(e,s)}function b(e,t){if(!Object(d.w)(e).isLive)return"";var n=function(e){var t=Object(l.c)(e,c.Lc),n=Object(l.c)(e,c.h),r=Object(l.c)(e,c.Kc),i=Object(l.c)(e,c.Yc);if(t)return a.m;if(n)return a.c;if(r)return a.l;if(i)return a.p;return null}(e);return n?Object(i.c)(t,n):""}function v(e,t){var n=Object(i.c)(t,a.q),o=Object(r.y)(e).serverVersion;return{label:n,value:Object(i.c)(t,a.r).replace("{0}",o).replace(" (DB {1})","")}}function y(e,t){return{label:Object(i.c)(t,a.e),value:e.EventManager.getCurrentSessionId()}}function _(e,t){var n=Object(o.h)(e);if(!n)return[];var r=n.ShimContextId,s=n.ShimSessionId,c=n.ShimVersion;return[{label:Object(i.c)(t,a.i),value:r},{label:Object(i.c)(t,a.j),value:s},{label:Object(i.c)(t,a.k),value:c}]}function C(e){var t=Object(i.c)(e,a.g),n=new Date;return{label:t,value:"{0} {1}".replace("{0}",n.toLocaleDateString()).replace("{1}",n.toLocaleTimeString())}}},"U/bH":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n("Sscr"),a=n("uO/V"),i=n("Gemh"),o=n("VWqI"),s=n("EwXg"),c=n("BFwB"),l=n("+Xnp"),u="dataset.dependentoptionset.column.status";function d(e,t){var n=[];return{type:"dependentoptionset.column.status",sync:!0,execute:function(o,l,d){var m=o.dispatch,f=o.getState,b=l.TraceManager.getTracer(a.z),v=a.x+".SetDependentOptionSetColumnStatusAction";l.TraceManager.setLogLevel(s.a.Info,v);try{var y=Object(r.v)(t),_=f(),C=null,S=Object(i.Q)(f(),e,t),O={};if(S)C=S;else{var I=Object(i.S)(f(),{id:e},t);I&&I.entityLogicalName&&(C=I.entityLogicalName)}if(C){n.push({name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:C}),b.info("Executing initialize dependent option set column status action in grid.",n);var j={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},P=[],x=0,E=Object(i.z)(_,t,C,e);for(var T in E){var w=E[T];if(null===w.ParentPicklistLogicalName){var A={name:T,value:0};p(_,t,e,C,E,T,A)?g(E,T,O,j):(h(E,T,O),x++,P.push(A))}else void 0===E[w.ParentPicklistLogicalName]&&g(E,T,O,j)}var F={name:"NumCompleteDependentOptionSetChainsInGrid",value:x},N={name:"CompleteChainsMaxDepthInGrid",value:P};n.push(F,j,N);var k=new c.a(v);k.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",x),k.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",j.value),k.addEventParameter("CompleteChainsMaxDepthInGrid",P),l.EventManager.ReportEvent(k),l.EventManager.ReportComponentSuccess(v),b.info("Executed initialize dependent option set column status action successfully.",n)}Object.keys(O).length>0&&m(function(e,t,n){return{type:u,payload:n,meta:{pageId:e,dataSetContextKey:t}}}(e,y,O))}catch(e){l.EventManager.ReportComponentFailure(v,Error("creating dependent option set column status node in state tree failed."))}}}}function p(e,t,n,r,a,i,s){if(void 0===a[i])return!0;if(function(e,t,n,r,a){if(!Object(o.f)(e,a,r,l.a.CanUpdate)||!n[r].IsValidForUpdate)return!0;return!1}(e,0,a,i,r))return!0;var c=a[i].ChildPicklistLogicalNames;if(null!==c)for(var u=0;u<c.length;u++){var d={name:i,value:0};if(p(e,t,n,r,a,c[u],d))return!0;s.value=Math.max(s.value,d.value)}return s.value=s.value+1,!1}function g(e,t,n,r){if(void 0!==e[t]){n[t]=0,r.value=r.value+1;var a=e[t].ChildPicklistLogicalNames;if(a)for(var i=0;i<a.length;i++)g(e,a[i],n,r)}}function h(e,t,n){n[t]=1;var r=e[t].ChildPicklistLogicalNames;if(r)for(var a=0;a<r.length;a++)h(e,r[a],n)}},UVKb:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r,a=n("qC0c"),i=n("lFQy"),o=n("t8f4"),s=n("Y70o"),c=n("WS0f"),l="ProcessControl_ActionExecuter_ExecutionTimeTooltip",u="ProcessControl_ActionExecuter_ErrorMessageTooltip",d="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";function p(e){switch(e){case r.InProgress:case r.Waiting:return 1;case r.Succeeded:return 2;case r.Failed:case r.Canceled:return 3;default:return 0}}function g(e,t,n,a){var i="";if(Object(c.b)(e)||(i=String.format(a[l],new Date(e).toLocaleString())),n===r.Failed){var o=Object(c.b)(t)?a.Crm_GenericErrorMessage:t;i+="\n"+String.format(a[u],o)}return""===i?t:i}function h(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute:function(n,r){var c=n.dispatch,h=n.getState,m=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),f=h();if(function(e){return Object(a.b)(e,"BpfActionSupportActionQuerying")}(f))return c(Object(o.e)("workflowlog",m)).then((function(e){if(e.value&&e.value.length){var n={};n[l]=Object(s.a)(f,d,l),n[u]=Object(s.a)(f,d,u),n.Crm_GenericErrorMessage=Object(s.a)(f,d,"Crm_GenericErrorMessage");var r={};e.value.forEach((function(e){if(e.stepname&&-1===Object.keys(r).indexOf(e.stepname)){var t={actionLogId:e.workflowlogid,status:p(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:g(e.modifiedon,e.message,e.status,n)};r[e.stepname]=t}}));var a={actionLogCollection:r};return c(Object(i.a)(a,t))}}))}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(r||(r={}))},W51q:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("qC0c"),a=n("cZkS"),i=n("7EJx");function o(e){return!!Object(r.a)(e,a.S,a.h)&&(!!Object(r.a)(e,a.d,a.Lc)||1033===Object(i.s)(e))}},WVwd:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q})),n.d(t,"b",(function(){return Z}));var r,a,i,o=n("9r0m"),s=n("HSdq"),c=n("BWVO"),l=n("7ipg"),u=n("1z64"),d=n("QAhb"),p=n("/eCp"),g=n("TCcM"),h=n("nbQV"),m=n("IiPO"),f=n("+Z9T"),b=n("ezfI"),v=function(){function e(e,t,n){var r="ClientApi.XrmProcessStep.constructor";t||Object(f.j)(r,"step"),n||Object(f.j)(r,"processManager"),e||Object(f.j)(r,"store"),this._step=t,this._processManager=n}return e.prototype.isRequired=function(){var e="ClientApi.XrmProcessStep.isRequired";try{b.a.instance.reportCall(e);var t=this._step.get_isProcessRequired();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getAttribute=function(){var e="ClientApi.XrmProcessStep.getAttribute";try{if(b.a.instance.reportCall(e),!this._attribute){var t=this._step.get_Steps().get_item(0);this._attribute=!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return b.a.instance.reportSuccess(e),this._attribute}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStep.getName";try{b.a.instance.reportCall(e);var t=this._step.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getProgress=function(){var e="ClientApi.XrmProcessStep.getProgress";try{b.a.instance.reportCall(e);var t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0))if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){var n=this._processManager.getActionLog(new o.a(this._step.get_Id()));n&&(t=n.status),t=0}return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.setProgress=function(e,t){var n="ClientApi.XrmProcessStep.setProgress";try{b.a.instance.reportCall(n);var r="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:r=this._setProgressInternal(e,t)}return b.a.instance.reportSuccess(n),r}catch(e){throw m.a.getInstance().reportFailure(n,e),e}},e.prototype._setProgressInternal=function(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)&&this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){var n=this._processManager.UpdateActionLog(new o.a(this._step.get_Id()),e,t);if(n)return n}return"invalid"},e}(),y=n("Zy0S"),_=function(){function e(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}return Object.defineProperty(e.prototype,"allowCreateNew",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew},set:function(e){var t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{b.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),b.a.instance.reportSuccess(t)}catch(e){throw m.a.getInstance().reportFailure(t,e),e}},enumerable:!1,configurable:!0}),e}(),C=function(){function e(e,t,n,a,i){r=e,this._entityTypeName=n,this._activeStageId=a,this._stageStep=t,new _(e,i),i&&(this._processManager=i)}return e.prototype.getCategory=function(){var e="ClientApi.XrmProcessStage.getCategory";try{b.a.instance.reportCall(e);var t=this._stageStep.get_stageCategory(),n={getValue:function(){var e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return b.a.instance.reportSuccess(e),n}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmProcessStage.getId";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getEntityName=function(){return b.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessStage.getStatus";try{b.a.instance.reportCall(e);var t=this.getId()===this._activeStageId?"active":"inactive";return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getName=function(){var e="ClientApi.XrmProcessStage.getName";try{b.a.instance.reportCall(e);var t=this._stageStep.get_Description();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getSteps=function(){var e="ClientApi.XrmProcessStage.getSteps";try{if(b.a.instance.reportCall(e),!this._steps&&(this._steps=new y.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(var t=0;t<this._stageStep.get_Steps().get_Count();t++){var n=this._stageStep.get_Steps().get_item(t);if(n instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){var a=n.get_Steps().get_item(0);a&&(a instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||a instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(n.get_Id(),new v(r,n,this._processManager))}}return b.a.instance.reportSuccess(e),this._steps}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getNavigationBehavior=function(){var e="ClientApi.XrmProcessStage.getNavigationBehavior";try{b.a.instance.reportCall(e);var t=this._processManager.getBpfNavigationBehavior();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),S=function(){function e(e,t,n,r,i){var o="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(f.j)(o,"workflowStep"),r||Object(f.j)(o,"activeStageId"),i||Object(f.j)(o,"processManager"),e||Object(f.j)(o,"store"),Object(f.a)(n)&&Object(f.j)(o,"isRendered"),a=e,this._isRendered=n,this._workflowStep=t,this._activeStageId=r,this._processManager=i}return e.prototype.getName=function(){var e="ClientApi.XrmBusinessProcessFlow.getName";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Name();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.getId=function(){var e="ClientApi.XrmBusinessProcessFlow.getId";try{b.a.instance.reportCall(e);var t=this._workflowStep.get_Id();return b.a.instance.reportSuccess(e),t}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e.prototype.isRendered=function(){return b.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered},e.prototype.getStages=function(){var e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(b.a.instance.reportCall(e),!this._stages){this._stages=new y.a(e);for(var t=0;t<this._workflowStep.get_Steps().get_Count();t++){var n=this._workflowStep.get_Steps().get_item(t);if(n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep)for(var r=n,i=0;i<r.get_Steps().get_Count();i++){var o=r.get_Steps().get_item(i);this._stages.add(o.get_Id(),new C(a,o,r.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}return b.a.instance.reportSuccess(e),this._stages}catch(t){throw m.a.getInstance().reportFailure(e,t),t}},e}(),O=n("w/nD"),I=n("JBkQ"),j=n("7kKV"),P=n("AqA3");!function(e){e.success="success",e.invalid="invalid"}(i||(i={}));var x,E,T=n("m8A1"),w=n("BvBP"),A=n("c56u"),F=n("JlqV"),N=n("kvLG"),k=n("sOTk"),M=n("b1hT"),D=n("l9h5"),R=n("Z1aD"),L=n("xc1f"),B=function(){function e(e,t,n,r,a){this._clientApiExecutor=new u.a(e,"ClientApi.XrmProcessControlData.",n,t);var i=this._clientApiExecutor.getComponentName("constructor");n||Object(f.j)(i,"pageId"),r||Object(f.j)(i,"entity"),t||Object(f.j)(i,"contextToken"),e||Object(f.j)(i,"store"),x=e,this._pageId=n,this._entity=r;var s=!1;Object(T.d)(x.getState(),this._pageId,i,!0)&&(this._processManager=a,s=!0),this._contextToken=t;var c=r.getEntityReference();this._entityRef=new d.a(c.entityType,o.a.tryParseOrNull(c.id),c.name);var l=Object(T.b)(n,e.getState(),s);N.a.getInstance().eventManager.ReportComponentSuccess(i,l)}return e.prototype.getActiveProcess=function(){var e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcess(),n=null;if(t){var r=this._getProcessManager().getActiveStageId();n=new S(x,t,!0,r,this._getProcessManager())}return b.a.instance.reportSuccess(e),n}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.setStatus=function(e,t){var n=this,r="ClientApi.XrmProcessControlData.setStatus";try{if(b.a.instance.reportCall(r),!Object(T.d)(x.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);if(!e||this.getStatus()&&e===this.getStatus())return void b.a.instance.reportSuccess(r);var a;if(e===I.a.active)a=p.a.Active;else if(e===I.a.finished)a=p.a.Finished;else{if(e!==I.a.aborted)return void b.a.instance.reportSuccess(r);a=p.a.Aborted}this._getProcessManager().setStatus(a).then((function(){n._callback(t,e,r),b.a.instance.reportSuccess(r)})).catch((function(t){var a=m.a.getInstance().getEventParameters(n._contextToken);return a.push({name:"newStatus",value:e}),Object(f.d)(x,t,r,a)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,i),e}},e.prototype.getStatus=function(){var e="ClientApi.XrmProcessControlData.getStatus";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return b.a.instance.reportSuccess(e),t}catch(t){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}},e.prototype.getInstanceName=function(){var e="ClientApi.XrmProcessControlData.getInstanceName";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceName();if(!t){var n=Object(g.e)(x.getState(),this._entityRef);t=Object(h.c)(x.getState(),n)}return b.a.instance.reportSuccess(e),t}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getInstanceId=function(){var e="ClientApi.XrmProcessControlData.getInstanceId";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getProcessInstanceId(),n=t?o.a.toString(t):null;return b.a.instance.reportSuccess(e),n}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getProcessInstances=function(e){var t=this,n="ClientApi.XrmProcessControlData.getProcessInstances";try{if(b.a.instance.reportCall(n),!Object(T.d)(x.getState(),this._pageId,n)||Object(M.g)(x.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then((function(r){if(r&&r.value&&r.value.length>0){var a={};r.value.forEach((function(e){e.businessprocessflowinstanceid&&(a[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:t._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})})),Object(l.c)(n,[],(function(){e(a)}))}b.a.instance.reportSuccess(n)})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(x,e,n+".getProcessInstances",r)}))}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,r),e}},e.prototype.setActiveProcess=function(e,t){var n=this;this._clientApiExecutor.executeAsync("setActiveProcess",(function(r,a){var s=o.a.tryParseOrNull(e),c=Object(k.m)(x.getState(),n._pageId);if(s&&o.a.equals(s,o.a.EMPTY)){if(c){var l=new d.a(n._entity.getEntityName(),o.a.EMPTY);return x.dispatch(Object(D.b)(!0,l)),N.a.getInstance().eventManager.ReportComponentSuccess(r,a),Promise.resolve().then((function(){return n._callback(t,i.success,r,a),Promise.resolve()})).catch((function(e){return n._callback(t,i.invalid,r,a),Promise.reject(e)}))}return Promise.resolve().then((function(){return n._callback(t,i.invalid,r,a),Promise.resolve()}))}if(!Object(T.d)(x.getState(),n._pageId,r,!0)||Object(M.g)(x.getState()))return Promise.resolve();return(c?Promise.resolve():n._getProcessManager().setActiveProcess(e)).then((function(){n._callback(t,i.success,r,a);var o=n.getActiveProcess();return o&&o.getId().toUpperCase()===e.toUpperCase()||n._reloadPage(r,n._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()})).catch((function(e){return n._callback(t,i.invalid,r,a),Promise.reject(e)}))}),[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.setActiveProcessInstance=function(e,t){var n=this;this._clientApiExecutor.executeAsync("setActiveProcessInstance",(function(r,a){return!Object(T.d)(x.getState(),n._pageId,r)||Object(M.g)(x.getState())?Promise.resolve():n._getProcessManager().setActiveProcessInstance(e).then((function(o){return n._callback(t,i.success,r,a),n.getInstanceId()!==e&&n._reloadPage(r,n._getProcessManager().getCurrentFormEntity(),o,e),Promise.resolve()})).catch((function(e){return n._callback(t,i.invalid,r,a),Promise.reject(e)}))}),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])},e.prototype.getEnabledProcesses=function(e){var t=this,n="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(b.a.instance.reportCall(n),!Object(T.d)(x.getState(),this._pageId,n,!0))return void b.a.instance.reportSuccess(n);var r=x.getState();if(Object(w.g)(r)&&Object(A.w)(r)&&!Object(F.b)(r)){var a={};return void("function"==typeof e&&Object(l.c)(n,[],(function(){e(a)})))}this._getProcessManager().getEnabledProcesses().then((function(t){var r={};t&&t.length>0&&t.forEach((function(e){r[e.workflowId]=e.name})),"function"==typeof e&&Object(l.c)(n,[],(function(){e(r)})),b.a.instance.reportSuccess(n)})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(x,e,n+".getEnabledProcesses",r)}))}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,i),e}},e.prototype.switchProcess=function(){var e="ClientApi.XrmProcessControlData.switchProcess";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e)||Object(M.g)(x.getState()))return;this._getProcessManager().switchProcess(),b.a.instance.reportSuccess(e)}catch(n){var t=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,n,null,t),n}},e.prototype.abandonProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.abandonProcess";try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t)||Object(k.m)(x.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().abandonProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(n){var r=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(x,n,t+".abandonProcess",r)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.reactivateProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.reactivateProcess";try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t)||Object(k.m)(x.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().reactivateProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(n){var r=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(x,n,t+".reactivateProcess",r)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.completeProcess=function(){var e=this,t="ClientApi.XrmProcessControlData.completeProcess";try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t)||Object(k.m)(x.getState(),this._pageId))return void b.a.instance.reportSuccess(t);this._getProcessManager().completeProcess().then((function(){b.a.instance.reportSuccess(t)})).catch((function(n){var r=m.a.getInstance().getEventParameters(e._contextToken);return Object(f.d)(x,n,t+".completeProcess",r)}))}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.getActiveStage=function(){var e="ClientApi.XrmProcessControlData.getActiveStage";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getActiveStage(),n=null;return t&&(n=new C(x,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),b.a.instance.reportSuccess(e),n}catch(t){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,r),t}},e.prototype.getActivePath=function(){var e=this,t="ClientApi.XrmProcessControlData.getActivePath";try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return b.a.instance.reportSuccess(t),null;var n=this._getProcessManager().getActivePathStages(),r=null;if(n){var a=this._getProcessManager().getActiveStageId(),i=new y.a(t);n.forEach((function(t){var n=t.get_parent().get_EntityLogicalName();i.add(t.get_stageId(),new C(x,t,n,a,e._getProcessManager()))})),r=i}return b.a.instance.reportSuccess(t),r}catch(e){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,o),e}},e.prototype.setActiveStage=function(e,t){var n=this,r="ClientApi.XrmProcessControlData.setActiveStage";try{if(b.a.instance.reportCall(r),this._entity.getIsDirty()||Object(k.m)(x.getState(),this._pageId))b.a.instance.reportSuccess(r),this._callback(t,j.a.dirtyForm,r);else{if(!Object(T.d)(x.getState(),this._pageId,r))return void b.a.instance.reportSuccess(r);this._getProcessManager().setActiveStage(e).then((function(){n._callback(t,n._getStageInvalidReason(null),r),n._loadActiveStageEntity(r),b.a.instance.reportSuccess(r)})).catch((function(e){n._callback(t,e?n._getStageInvalidReason(e):P.a.invalid,r)}))}}catch(e){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,a),e}},e.prototype.moveNext=function(e){var t=this,n="ClientApi.XrmProcessControlData.moveNext";try{if(b.a.instance.reportCall(n),this._entity.getIsDirty()||Object(k.m)(x.getState(),this._pageId))b.a.instance.reportSuccess(n),this._callback(e,j.a.dirtyForm,n);else{if(!Object(T.d)(x.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);if(this._getProcessManager().isCrossEntityNavigation(!0))return this._callback(e,j.a.crossEntity,n),void b.a.instance.reportSuccess(n);this._getProcessManager().moveToNextStage().then((function(){t._callback(e,t._getNavigationStatus(null),n),b.a.instance.reportSuccess(n)})).catch((function(r){var a=r?t._getNavigationStatus(r):j.a.invalid;if(t._callback(e,a,n),a===j.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(x,r,n+".moveToNextStage",i)}b.a.instance.reportSuccess(n)}))}}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,r),e}},e.prototype.movePrevious=function(e){var t=this,n="ClientApi.XrmProcessControlData.movePrevious";try{if(b.a.instance.reportCall(n),this._entity.getIsDirty()||Object(k.m)(x.getState(),this._pageId))b.a.instance.reportSuccess(n),this._callback(e,j.a.dirtyForm,n);else{if(!Object(T.d)(x.getState(),this._pageId,n))return void b.a.instance.reportSuccess(n);if(Object(M.g)(x.getState())&&this._getProcessManager().isCrossEntityNavigation(!1))return this._callback(e,j.a.crossEntity,n),void b.a.instance.reportSuccess(n);this._getProcessManager().moveToPreviousStage().then((function(){t._callback(e,t._getNavigationStatus(null),n),t._loadActiveStageEntity(n),b.a.instance.reportSuccess(n)})).catch((function(r){var a=r?t._getNavigationStatus(r):j.a.invalid;if(t._callback(e,a,n),a===j.a.invalid){var i=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(x,r,n+".moveToPreviousStage",i)}b.a.instance.reportSuccess(n)}))}}catch(e){var r=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(n,e,null,r),e}},e.prototype.getSelectedStage=function(){var e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(b.a.instance.reportCall(e),!Object(T.d)(x.getState(),this._pageId,e))return b.a.instance.reportSuccess(e),null;var t=this._getProcessManager().getSelectedStage(),n=null;if(t){var r=this._getProcessManager().getActiveStageId();n=new C(x,t,this._getProcessManager().getCurrentFormEntity().etn,r,this._getProcessManager())}return b.a.instance.reportSuccess(e),n}catch(t){var a=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,a),t}},e.prototype.addOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.q)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.addOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.j)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.L)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnPreStageChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.E)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.addOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.r)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnStageSelected=function(e){var t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.M)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.addOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.k)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.addOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.i)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(f.j)(t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.F)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnPreProcessStatusChange=function(e){var t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(f.g)(e,t,"handler");try{if(b.a.instance.reportCall(t),!Object(T.d)(x.getState(),this._pageId,t))return void b.a.instance.reportSuccess(t);x.dispatch(Object(O.D)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype._getStageInvalidReason=function(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success},e.prototype._getNavigationStatus=function(e){return e?e.navigationStatus||j.a.invalid:j.a.success},e.prototype._convertToXrmProcessInstanceStatus=function(e){if(e){if(e===p.a.Active)return I.a.active;if(e===p.a.Finished)return I.a.finished;if(e===p.a.Aborted)return I.a.aborted}return null},e.prototype._callback=function(e,t,n,r){var a=n+".Callback";r||(r=m.a.getInstance().getEventParameters(this._contextToken)),r.push({name:"Status",value:t}),Object(l.c)(a,r,(function(){"function"==typeof e&&e(t)}))},e.prototype._reloadPage=function(e,t,n,r){if(t){var a=Object(k.m)(x.getState(),this._pageId),i={entityTypeName:t.etn,id:a?void 0:t.id,processId:n,processInstanceId:r};x.dispatch(Object(R.a)(L.a,i,this._pageId,{target:"inline"})).then((function(t){if(0!==t.status)return Object(f.d)(x,t.error,e+".navigateTo.INavigationFailure")})).catch((function(t){return Object(f.d)(x,t,e+".navigateTo.")}))}},e.prototype._loadActiveStageEntity=function(e){var t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())},e.prototype._getProcessManager=function(){return this._processManager||(this._processManager=Object(T.c)(this._processManager,x,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager},e}(),V=n("UGbr"),G=n("TCDU"),W=n("UOiB"),z=n("/j9Z"),X=n("9qYn"),q=n("ObKm"),U=n("/lKk"),H=n("gk6Q"),Y=n("vqdi"),K=n("Gemh"),Q=function(){function e(e,t,n,r,a){this._entity=null;var i="ClientApi.XrmFormData.constructor";e||Object(f.j)(i,"store"),n||Object(f.j)(i,"pageId"),t||Object(f.j)(i,"contextToken"),r||Object(f.j)(i,"formContext"),E=e,this._pageId=n,this._formContext=r,this._contextToken=t,this._entity=a}return Object.defineProperty(e.prototype,"entity",{get:function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"process",{get:function(){var e="ClientApi.XrmFormData.process_get";try{var t=Object(M.f)(E.getState());b.a.instance.reportCall(e);var n=!!this._process;if((!t&&!this._process||t)&&this._entity){var r=Object(k.g)(E.getState(),this._pageId),a=Object(H.b)(this._pageId,r);this._entity&&(this._process=new B(E,this._contextToken,this._pageId,this.entity,a))}b.a.instance.reportSuccess(e);var i=Object(T.a)(this._pageId,E.getState(),n,!!this._entity);return N.a.getInstance().eventManager.ReportComponentSuccess(e,i),this._process}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},set:function(e){var t=Object(T.a)(this._pageId,E.getState(),!!this._process,!!this._entity);N.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e},enumerable:!1,configurable:!0}),e.prototype.getEntity=function(){return b.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity},e.prototype.getIsDirty=function(){var e,t,n,r="ClientApi.XrmFormData.getIsDirty";try{b.a.instance.reportCall(r);var a=!1;if(this._entity&&this._entity.getIsDirty())a=!0;else{for(var i=0;i<this.attributes.getLength();i++){var o=this.attributes.get(i);if("never"!==o.getSubmitMode()&&o.getIsDirty()){a=!0;break}}if(!a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(i=0;i<this._formContext.ui.controls.getLength();i++){var s=this._formContext.ui.controls.get(i);if("formcomponent"===s.getControlType()&&s.isLoaded()&&(null===(n=s.data)||void 0===n?void 0:n.getIsDirty())){a=!0;break}}}return b.a.instance.reportSuccess(r),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,c),e}},Object.defineProperty(e.prototype,"attributes",{get:function(){var e="ClientApi.XrmFormData.attributes";try{if(b.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new y.a(e);var t=Object(s.Oc)(E.getState(),this._pageId);if(t)for(var n in t){var r=t[n],a=n,i=Object(c.b)(E,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,r);this._unboundAttributes.add(i.getName(),i)}}return b.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){var o=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(e,t,null,o),t}},enumerable:!1,configurable:!0}),e.prototype._refreshEntity=function(e){var t=this;return this.entity.refresh().then((function(){Object(V.d)(E.dispatch,t._contextToken,t._pageId),e&&E.dispatch(Object(O.Q)(t._contextToken,t._pageId,3,t.entity)),Object(X.b)(t.entity)}))},e.prototype.refresh=function(e){var t=this,n="ClientApi.XrmFormData.refresh";try{if(b.a.instance.reportCall(n),this.entity){var r=Object(s.kb)(E.getState(),{id:this._pageId},this._contextToken);return!r&&e&&this.entity.getIsDirty()?this.save().then((function(e){return b.a.instance.reportSuccess(n),{}})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,n+".save",r)})):!r&&this.entity.getIsDirty()?E.dispatch(Object(G.a)(this._pageId)).then((function(e){if(e)return t._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(n),{}})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,n+".handleUnsavedChanges.refreshEntity",r)}))})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,n+".handleUnsavedChanges",r)})):this._refreshEntity(!0).then((function(){return b.a.instance.reportSuccess(n),{}})).catch((function(e){var r=m.a.getInstance().getEventParameters(t._contextToken);return Object(f.d)(E,e,n+".handleUnsavedChanges.refreshEntity",r)}))}var a=new z.a("Refresh action cannot be executed since form entity is null",2147746581);return N.a.getInstance().traceManager.getTracer(n).info("Refreshing on a non entity page"),Object(f.d)(E,a,n+".entity")}catch(e){var i=m.a.getInstance().getEventParameters(this._contextToken);return Object(f.d)(E,e,n,i)}},e.prototype.save=function(e){var t=this,n="ClientApi.XrmFormData.save",r=m.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){var a=new z.a("Save action cannot be executed since form entity is null",2147746581);return Object(f.d)(E,a,n+".entity")}try{b.a.instance.reportCall(n);var i=1;return e&&e.saveMode&&(i=e.saveMode),Z(this._pageId,E,i,r,this._contextToken,this.entity,!0,!0).then((function(e){if(e){var a={entityType:e.etn,id:o.a.toString(e.id),name:e.name};return Object(s.Kb)(E.getState(),t._pageId)?(b.a.instance.reportSuccess(n),{savedEntityReference:a}):t._refreshEntity(!1).then((function(){return b.a.instance.reportSuccess(n),{savedEntityReference:a}})).catch((function(e){return Object(f.d)(E,e,n+".refresh",r)}))}if(Object(s.kb)(E.getState(),{id:t._pageId},t._contextToken)||!t.entity.getIsDirty()){var i=t.entity.getEntityReference();return b.a.instance.reportSuccess(n),{savedEntityReference:i}}var c=new z.a("Save action was not executed and the form is dirty.",2147879192);return Object(f.d)(E,c,n+".NoReference",null,!1)})).catch((function(e){if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){var a=t.entity.getEntityReference();return b.a.instance.reportSuccess(n),Promise.resolve({savedEntityReference:a})}return Object(f.d)(E,e,n,r)}))}catch(e){return Object(f.d)(E,e,n,r)}},e.prototype.isValid=function(){var e,t,n,r="ClientApi.XrmFormData.isValid";try{b.a.instance.reportCall(r);var a=!0;if(this.entity&&!this.entity.isValid())a=!1;else if(this.attributes)for(var i=0;i<this.attributes.getLength();i++)if(!this.attributes.get(i).isValid()){a=!1;break}if(a&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(var o=0;o<this._formContext.ui.controls.getLength();o++){var s=this._formContext.ui.controls.get(o);if("formcomponent"===s.getControlType()&&s.isLoaded()&&!(null===(n=s.data)||void 0===n?void 0:n.isValid())){a=!1;break}}return a||E.dispatch(Object(q.b)(this._pageId,this._contextToken)),b.a.instance.reportSuccess(r),a}catch(e){var c=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(r,e,null,c),e}},e.prototype.addOnLoad=function(e){var t="ClientApi.XrmFormData.addOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),E.dispatch(Object(O.c)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e.prototype.removeOnLoad=function(e){var t="ClientApi.XrmFormData.removeOnLoad";e||Object(f.j)(t,"handler");try{b.a.instance.reportCall(t),E.dispatch(Object(O.x)(this._contextToken,this._pageId,e)),b.a.instance.reportSuccess(t)}catch(e){var n=m.a.getInstance().getEventParameters(this._contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}},e}();function Z(e,t,n,r,a,i,c,l){var u=t.getState(),d=o.a.tryParseOrNull(i.getId());if(a.contextTokenType===W.a.GridRow){var p=[],g=Object(K.T)(u,e,a.parentContextToken,a.parentContextToken.controlName);return i.attributes.forEach((function(e){return p.push(e.getName())})),r.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(Y.a)(e,i.getEntityName(),null==d?void 0:d.guid,null,p,null==g?void 0:g.guid,!1,a.parentContextToken))}if(Object(s.Kb)(u,e))return r.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(U.a)(e));if(d&&!o.a.equals(d,o.a.EMPTY))return r.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(V.e)(e,n));var h=Object(k.l)(t.getState(),e);return r.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(V.f)(e,h,l,n,!1,c))}},"Wye+":function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n("Gemh"),a=n("Nhrb");var i=n("/j9Z"),o=n("9r0m"),s=n("G7N+"),c=n("olrR"),l=n("RlP9"),u=n("r2h9"),d=n("8Fmj"),p=n("cqI9"),g=n("7dGM"),h=n("lMVv"),m=n("JlqV"),f=n("z9yS"),b=n("uO/V"),v=n("Yc9S"),y=n("0rak");var _=n("zETL"),C=n("3IUl"),S=n("bc+P"),O=n("xm8q"),I=n("okRr"),j=n("U/bH"),P=n("cZkS"),x=n("qC0c"),E=n("VcAV");function T(e,t,n,T,A,F){return{type:"grid.refresh.async",execute:function(N,k){var M=N.dispatch,D=N.getState,R=k.TraceManager.getTracer(b.z),L=b.x+".refreshGridAction";try{var B=D(),V=o.a.tryParseOrNull(T);if(V){var G=F||(n?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,n,a,d,p,g,h){var f=Object(r.qb)(t,h,n);if(f&&f.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(f.offlineSqlQuery)))return Promise.resolve(h);var b=p||Object(r.F)(t,n,a,d),v=Object(l.f)(t,b,g),y=Object(l.f)(t,b,u.a.MAIN_APPLICATION_VIEW),_=v&&v[o.a.toString(h)]&&v[o.a.toString(h)].isUserView?u.b.userview:u.b.savedview;y&&y[o.a.toString(h)]&&y[o.a.toString(h)].isUserView&&(_=u.b.userview);return e(Object(c.a)(b,g,_,h)).then((function(e){if(!e)throw new i.a("View retrieval failed");return e}))}(M,B,e,t,n,A,G,V).then((function(i){R.info("Refreshing the grid with new view id - {0}"+V);var c=Object(r.T)(B,e,t);M(function(e,t,n,r){return Object(a.b)(e,t,"ViewId",n,r)}(e,n,T,t)),function(e,t,n,a,i,c,u,d,p){var g=function(e,t,n,a,i){return e||Object(r.F)(t,n,a,i)}(n,e,i,c,u),h=Object(r.qb)(e,a,i);if(h&&h.initialized===s.a.Initialized){var m=Object(l.f)(e,g,d),f=m&&m[o.a.toString(a)]&&m[o.a.toString(a)].isUserView;if(g===b.a&&(g=h.entityLogicalName?h.entityLogicalName:g),!h.title){var v=[];v.push({name:"view.title",value:"View title doesn't contains value"}),v.push({name:"ViewId",value:"ViewId: "+a}),v.push({name:"View",value:w(h)}),v.push({name:"entityTypeName",value:g}),p.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",v)}var y={RecordType:I.a.Grid,EntityTypeName:g,LastAccessed:new Date,ObjectId:a,IsUserView:f,Title:h.title};t(Object(O.b)(y))}}(D(),M,A,i,e,t,n,G,k),Object(x.c)(D(),P.L)&&M(Object(j.b)(e,t)),A&&M(function(e,t,n,r){return Object(a.b)(e,t,"TargetEntityType",n,r)}(e,n,A,t)),M(Object(_.b)(e,t)),M(Object(C.b)(e,t,[])),M(Object(S.b)(e,t,null));var E=[];if(A&&E.push({name:"entityName",value:A}),!Object(r.ib)(B,e,t))return k.EventManager.ReportComponentSuccess(L,E),Promise.resolve();M(function(e,t,n,a,i,s){return{type:"chart.refresh.async",execute:function(c,_){var C=c.dispatch,S=c.getState,O=b.x+".refreshChartAction",I=S();if(!n)return Promise.resolve();if(!Object(m.b)(I))return Promise.resolve();var j=Object(l.c)(I,n);if(!(i=j&&j.entityLogicalName?j.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(C(Object(y.c)(e,t,[])),C(Object(v.c)(e,t,"{}"))),!o.a.equals(a,n)){C(Object(y.c)(e,t,[])),C(Object(v.c)(e,t,"{}"));var P=Object(r.r)(I,e,t,i),x=Object(g.a)(I,P),E=x&&x.PrimaryEntityTypeCode,T=E&&Object(h.m)(I,parseInt(E,10));if(T&&i!==T)return C(Object(d.a)(i,f.a.savedvisualization)).then((function(n){var r=o.a.toString(n);return r||(r=o.a.EMPTYGUIDSTRING),C(Object(p.b)(e,t,r)).then((function(){_.EventManager.ReportComponentSuccess(O)}))}))}return _.EventManager.ReportComponentSuccess(O),Promise.resolve()}}}(e,t,V,c,A,F)).then((function(){return M(Object(_.b)(e,t)),k.EventManager.ReportComponentSuccess(L,E),Promise.resolve()})).catch((function(e){return k.EventManager.ReportComponentFailure(L,Error(e)),Promise.resolve()}))}))}if(Object(r.v)(D(),e,t)){R.info("Refreshing the grid."),M(Object(_.b)(e,t)),M(Object(C.b)(e,t,[])),M(Object(S.b)(e,t,null));var W=[];A&&W.push({name:"entityName",value:A}),k.EventManager.ReportComponentSuccess(L,W)}return Promise.resolve()}catch(e){var z="Refresh action for grid failed";e&&e.message&&(z+="with the error message as : "+e.message),k.EventManager.ReportComponentFailure(L,Error(z))}}}}function w(e){if(!e)return"View is "+e;var t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},XJ3n:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var r,a=n("fW82"),i=n("9r0m"),o=n("+Z9T"),s=n("BWVO"),c=n("WVwd"),l=n("/zIU"),u=n("GueY"),d=n("Gemh"),p=n("IiPO"),g=n("mPpC"),h=n("ks02"),m=n("FoZz"),f=n("sOTk"),b=n("gLMt"),v=n("ezfI"),y=function(){function e(e,t,n,a,i,s){var c="ClientApi.XrmGridRow.constructor";e||Object(o.j)(c,"store"),a||Object(o.j)(c,"pageId"),n||Object(o.j)(c,"contextToken"),i||Object(o.j)(c,"entityType"),s||Object(o.j)(c,"entityId"),r=e,this._applicationContext=t,this._pageId=a,this._contextToken=n,this._entityType=i,this._entityId=s}return Object.defineProperty(e.prototype,"applicationContext",{get:function(){return v.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e="ClientApi.XrmGridRow.context";try{return v.a.instance.reportCall(e),this._globalContext||(this._globalContext=new h.a(r,this._pageId)),v.a.instance.reportSuccess(e),this._globalContext}catch(n){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(e,n,null,t),n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){var e=this,t="ClientApi.XrmGridRow.data";try{if(v.a.instance.reportCall(t),!this._data){var n=new s.a(r,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new c.a(r,this._contextToken,this._pageId,this,n);var a=new g.b(r,this._pageId),o=[],l={isEventParam:!0,name:"attributeName",value:""};o.push(l),n.attributes.forEach((function(n){var r=n.getName();l.value=r;var s={Id:r,Label:null,Name:r,ShowLabel:!1,Visible:!0,ClassId:new i.a(g.a),Disabled:!1,DataFieldName:r},c=a.createXrmControl(e._contextToken,s,e,t,o);c&&n.controls.add(c.getName(),c)}))}return v.a.instance.reportSuccess(t),this._data}catch(e){var u=p.a.getInstance().getEventParameters(this._contextToken);throw u.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,u),e}},enumerable:!1,configurable:!0}),e.prototype.getData=function(){try{return v.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",t,null,e),t}},Object.defineProperty(e.prototype,"ui",{get:function(){try{if(v.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){var e=new g.b(r,this._pageId);this._ui=new u.a(r,this._contextToken,this._pageId,this,this._entityType,e)}return v.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){var t=p.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t="ClientApi.XrmGridRow.getControl";try{v.a.instance.reportCall(t);var n=this.ui.controls.get(e);return v.a.instance.reportSuccess(t),n}catch(e){var r=p.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getAttribute=function(e){var t="ClientApi.XrmGridRow.getAttribute";try{if(v.a.instance.reportCall(t),this.data.entity){var n=this.data.entity.attributes.get(e);return v.a.instance.reportSuccess(t),n}return v.a.instance.reportSuccess(t),null}catch(e){var r=p.a.getInstance().getEventParameters(this._contextToken);throw r.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,r),e}},e.prototype.getUrl=function(e){var t="ClientApi.XrmGridRow.getUrl";try{v.a.instance.reportCall(t);var n=this.data.entity.getEntityReference();this._internal=new m.a(r,this._applicationContext,this.context,this._pageId);var o=Object(f.g)(r.getState(),this._pageId),s={entityTypeName:n.entityType,etn:n.name,id:i.a.fromExternalGuid(n.id),entityTypeCode:this._internal.getEntityCode(n.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:o.recordSetQueryKey};if(1===e){var c=r.dispatch(Object(a.a)(l.a.EditForm,s));return v.a.instance.reportSuccess(t),c}var u=Object(b.a)(r,this._pageId),d=r.dispatch(Object(a.c)(u,l.a.EditForm,s));return v.a.instance.reportSuccess(t),d}catch(e){var g=p.a.getInstance().getEventParameters(this._contextToken);throw g.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure(t,e,null,g),e}},Object.defineProperty(e.prototype,"entityReference",{get:function(){try{return this.data.entity.getEntityReference()}catch(t){var e=p.a.getInstance().getEventParameters(this._contextToken);throw e.push({name:"entityType",value:this._entityType}),p.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",t,null,e),t}},enumerable:!1,configurable:!0}),e}();function _(e,t,n){var a=Object(d.D)(r.getState(),{id:n},t.parentContextToken);return a||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"Y+r4":function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r,a,i=n("c/eZ"),o=n("1z64"),s=n("fW82"),c=n("sOTk"),l=n("BWVO"),u=n("WVwd"),d=n("ezfI"),p=n("/zIU"),g=n("GueY"),h=n("HSdq"),m=n("3NtJ"),f=n("fTYK"),b=n("+Z9T"),v=n("IiPO"),y=function(e){function t(t,n,a,i,o,s){var c=e.call(this,t,n,a,i,o,s)||this;return r=t,c}return Object(i.__extends)(t,e),t.prototype.getDefaultNextPageName=function(){var e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{d.a.instance.reportCall(e);var t=Object(h.M)(r.getState(),this.pageId,this.contextToken);return d.a.instance.reportSuccess(e),t}catch(t){var n=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.movePrevious=function(){var e="ClientApi.XrmNavigableFormUi.movePrevious";try{d.a.instance.reportCall(e),r.dispatch(Object(f.b)(this.pageId,this.contextToken)),d.a.instance.reportSuccess(e)}catch(n){var t=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.moveTo=function(e){var t,n="ClientApi.XrmNavigableFormUi.moveTo";try{if(d.a.instance.reportCall(n),e&&this.tabs){var a=Object(h.Gc)(r.getState(),this.pageId,e,this.contextToken);(t=this.tabs.get(null==a?void 0:a.Name))&&r.dispatch(Object(m.b)(this.pageId,this.contextToken,null==a?void 0:a.Id))}d.a.instance.reportSuccess(n)}catch(e){var i=v.a.getInstance().getEventParameters(this.contextToken);throw v.a.getInstance().reportFailure(n,e,null,i),e}t||Object(b.h)(n,"pageName",e)},Object.defineProperty(t.prototype,"taskProcess",{get:function(){return d.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this},enumerable:!1,configurable:!0}),t}(g.a),_=n("9r0m"),C=n("FoZz"),S=n("gLMt"),O=n("ZOZo"),I=n("WS0f"),j=function(e){function t(t,n,r,i,s){var c=this,l=[{name:"pageId",value:s,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return(c=e.call(this,t,n&&n.etn,i,s,(function(e){return 10===e||12===e?y:g.a}),r)||this)._clientApiExecutorForm=new o.a(t,"ClientApi.XrmForm.",s,i,l),a=t,c._entityReference=n,c}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"applicationContext",{get:function(){return this._applicationContext},set:function(e){this._applicationContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){try{return d.a.instance.reportCall("ClientApi.XrmForm.context"),d.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}},set:function(e){this._globalContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){var e=this;return this._clientApiExecutorForm.execute("entityReference_get",(function(){return{id:_.a.externalGuid(e._entityReference.id),entityType:e._entityReference.etn}}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){try{if(d.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){var e=void 0,t=Object(c.l)(a.getState(),this.pageId);t!==p.a.Dialog&&t!==p.a.ModalDialog&&this._entityReference&&(e=new l.a(a,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,P,this._applicationContext)),this._data=new u.a(a,this.contextToken,this.pageId,this,e)}return d.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}},enumerable:!1,configurable:!0}),t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutorForm.execute("getAttribute",(function(){var n,r,a=null;return t.data&&t.data.entity&&(a=t.data.entity.attributes.get(e)),a?Object(I.a)(e)&&(a=a.concat(t.data.attributes.get(e))):a=null===(r=null===(n=t.data)||void 0===n?void 0:n.attributes)||void 0===r?void 0:r.get(e),a}))},t.prototype.getUrl=function(e){try{d.a.instance.reportCall("ClientApi.XrmForm.getUrl");var t=null,n=null;if(this.contextToken.parentContextToken){var r=this.data.entity.getEntityReference(),i={entityTypeName:r.entityType,etn:r.name,id:_.a.fromExternalGuid(r.id)};t=p.a.EditForm,n=i}else t=Object(c.l)(a.getState(),this.pageId),n=Object(c.g)(a.getState(),this.pageId);switch(t){case p.a.EditForm:var o=new C.a(a,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,etn:n.etn,id:n.id,entityTypeCode:o.getEntityCode(n.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:n.recordSetQueryKey};break;case p.a.Grid:o=new C.a(a,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,pageType:n.pageType,entityTypeCode:o.getEntityCode(n.entityTypeName)}}var l=null;if(1===e)l=a.dispatch(Object(s.a)(t,n));else{var u=Object(S.a)(a,this.pageId);l=a.dispatch(Object(s.c)(u,t,n))}return d.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),l}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}},t.prototype._reportFailure=function(e,t){var n=v.a.getInstance().getEventParameters(this.contextToken);return n.push({name:"entityName",value:this._entityReference.etn}),v.a.getInstance().reportFailure(e,t,null,n),t},t}(O.a);function P(e,t,n){var r=Object(h.bb)(a.getState(),n,t);return r||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),r}},YOvo:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="navigation.item.visibility";function a(e,t,n){return{type:r,payload:{show:n},meta:{pageId:e,navigationItemId:t}}}},Yc9S:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n("Sscr"),a=n("uO/V"),i="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,n){return{type:"chart.filterexpression.update.async",execute:function(s,c){var l=s.dispatch,u=s.getState,d=c.TraceManager.getTracer(a.z),p=a.x+".updateFilterExpressionAction";try{d.info("Updating the chart filter expression"),t||(t=Object(r.k)(u(),e));var g=Object(r.v)(t);return l(function(e,t,n){return{type:i,payload:{name:o,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,g,n)),c.EventManager.ReportComponentSuccess(p),Promise.resolve()}catch(e){var h="Updatation of the chart filter expression failed with error : "+e.message;c.EventManager.ReportComponentFailure(p,Error(h))}}}}},YdIa:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.targets.set";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},ZOZo:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n("h82J"),i=n("HSdq"),o=n("1z64"),s=function(){function e(e,t,n,i,s,c){this._clientApiExecutor=new o.a(e,"ClientApi.XrmFormBase.",i,n,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:i,isRequired:!0,isEventParam:!0},{name:"contextToken",value:n,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),r=e,this.pageId=i,this.contextToken=n,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,r.dispatch(Object(a.a)(this,i,n))}return Object.defineProperty(e.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ui_get",(function(){if(!e._ui){var t={id:e.pageId},n=Object(i.fb)(r.getState(),t,e.contextToken),a=n&&n.FormType,o=e._getUiType(a);e._ui=new o(r,e.contextToken,e.pageId,e,e._entityName,e._xrmControlFactory)}return e._ui}))},enumerable:!1,configurable:!0}),e.prototype.getControl=function(e){var t=this,n=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",(function(){return t.ui.controls.get(e)}),n)},e}()},"a/Ab":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="areaSwitcherModal",a="recentsListModal",i="profileModal",o="pinnedListModal",s="settingsModal"},bCrZ:function(e,t,n){"use strict";n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return v}));var r=n("c/eZ"),a=n("9r0m"),i=n("Sscr"),o=n("uO/V"),s=n("nn4v"),c=n("Gemh"),l=n("cZkS"),u=n("qC0c"),d=n("U/bH"),p=n("jigW"),g="grid.initialize",h="grid.initialize.xrmready";function m(e,t,n){return{type:"grid.preinitialize.sync",sync:!0,execute:function(r,a){var i=r.dispatch,s=(r.getState,o.x+".gridPreInitializedAction");try{i(b(null,e,t,n,void 0,void 0,void 0,void 0,null));var c=[{name:"entityTypeName",value:e}];return a.EventManager.ReportComponentSuccess(s,c),Promise.resolve(void 0)}catch(t){var l="Failed for "+e+" with error "+t.message;return a.EventManager.ReportComponentFailure(s,Error(l)),Promise.resolve(void 0)}}}}function f(e,t,n,a,i,p,g,h,m){return e?{type:"grid.initialize.async",execute:function(f,v){var y=f.dispatch,_=f.getState,C=o.x+".gridInitializedAction";try{var S=null;Object(u.c)(_(),l.zb)&&(S=function(e,t,n){var a=Object(c.v)(e,t,n),i=Object(r.__assign)({},s.a);return a&&(a.filters&&(i.filters=a.filters),a.customFilter&&(i.customFilter=a.customFilter),a.pageNumber&&(i.pageNumber=a.pageNumber),a.pagingRefreshInput&&(i.pagingRefreshInput=a.pagingRefreshInput)),i}(_(),n,a)),y(b(e,t,n,a,i,p,g,h,S,m));var O=[];return O.push({name:"entityTypeName",value:t}),v.EventManager.ReportComponentSuccess(C,O),Object(u.c)(_(),l.L)&&y(Object(d.b)(n,a)),Promise.resolve(void 0)}catch(e){var I="Grid initialized failed for entity type "+t;return v.EventManager.ReportComponentFailure(C,Error(I)),Promise.reject(void 0)}}}:null}function b(e,t,n,c,l,u,d,h,m,f){var b=l&&l.Parameters?l.Parameters[o.j]:null;try{var v=!0;b&&(v="true"===b);var y=Object(i.u)(c),_={contextKey:y,initialDataSetState:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.a),m),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:u,relationshipRoleOrdinal:d,useRollupView:h||!1,commandManagerId:f||Object(p.d)(n,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:e&&e.viewId?a.a.toString(e.viewId):null},1:{Name:o.j,Value:v},2:{Name:o.u,Value:t}}}}})};return{type:g,payload:_,meta:{pageId:n,contextKey:y}}}catch(e){throw Error(e)}}function v(e,t,n,c){var l=Object(i.u)(c),u=a.a.tryParseOrNull(t),d={contextKey:l,initialDataSetState:Object(r.__assign)(Object(r.__assign)({},s.a),{viewId:u||null,fetchXml:null,commandManagerId:Object(p.d)(n,c),controls:{homepageGrid:{parameters:{0:{Name:o.C,Value:t||null},1:{Name:o.j,Value:!1},2:{Name:o.u,Value:e}}}}})};return{type:g,payload:d,meta:{pageId:n,contextKey:l}}}function y(e,t,n,r){return t(e.ScriptManager.getContainer(r).getEventManager().loadGridScripts(n,r))}},bH46:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var r=n("9r0m"),a=n("vYfn"),i=n("i8/j"),o=n("F2uj"),s=n("gBKR"),c=n("VWqI"),l=n("j6Db"),u=n("+Xnp"),d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function p(e,t,n){return{type:"formandattribute.retrieve.async",execute:function(c,u){var p=c.dispatch,m=c.getState,f="Card"===n;return e.etn&&"activitypointer"===e.etn&&f?p(Object(s.f)("activitypointer",!1,d)).then((function(){for(var t=m(),n={},r=0,a=d;r<a.length;r++){var i=a[r],s=Object(o.a)(t,e.etn,i);s&&g(t,e.etn,i,s)&&(n[i]=s)}return h(t,e.etn,n,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:n}})):p(Object(a.b)(e,t,n)).then((function(a){var c={},d=null;return e.etn?p(Object(s.f)(e.etn,!0,[])).then((function(){var t=m();if(!r.a.isNullOrEmpty(a)&&(d=Object(i.j)(t,a))&&d.Attributes)for(var n in d.Attributes){var s=d.Attributes[n],l=Object(o.a)(t,e.etn,s);l&&g(t,e.etn,s,l)&&(c[s]=l)}return f&&h(t,e.etn,c,Object(o.d)(t,e.etn)),{formDescriptor:d,attributeDescriptors:c}})):(u.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:n}]),null)}),(function(e){var a=e.get_message();u.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(a),a,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:r.a.toString(t)},{name:"formType",value:n}])}))}}}function g(e,t,n,r){return Object(c.f)(e,t,n,u.a.CanRead)&&r&&r.IsValidForRead}function h(e,t,n,r){if(r)for(var a in r){var i=r[a];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||n[a]||!g(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(n[a]=i)}}},bJYk:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("9r0m"),a=n("sOTk"),i=n("Z1aD"),o=n("KQ+A"),s=n("t8f4"),c=n("QAhb"),l=n("lMVv"),u=n("WS0f"),d=n("riBC"),p=n("7EJx"),g=n("JlqV"),h=n("HSdq"),m=n("YEEA");function f(e,t,n,c){var f=[{name:"formId",value:e},{name:"pageName",value:n}];return{type:"form.change",execute:function(v,y,_){var C=v.dispatch,S=v.getState,O=S();if(Object(h.Eb)(O,t))return Promise.reject(Object(m.b)(O,t,2200000016));var I=Object(a.g)(O,t),j=I.entityTypeName,P=I.id,x=I.recordSetQueryKey,E=I.data,T=I.createFromRelationship,w=I.initWithEntity;f.push({name:"entityTypeName",value:j});var A=r.a.tryParse(e),F={entityTypeName:j,formId:A,id:c?r.a.tryParse(c):P,recordSetQueryKey:x,data:E,createFromRelationship:T,initWithEntity:w},N=A.guid.toString(),k='<MRUForm><Form Type="Main" Id="'+N+'" /></MRUForm>',M=Object(d.c)(O,j);return C(Object(i.a)(n,F,t,{replaceState:!0})).then((function(e){var t,n;if(0===e.status)if(Object(g.b)(S()))null==M||M===r.a.EMPTY?function(e,t,n,a,i,c,d,g){var h=Object(l.p)(a,e),m=Object(p.q)(a),f="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",v=String.format(f,h.toString(),m.guid.toString());i(Object(s.e)("userentityuisettings",v)).then((function(p){p.value&&p.value.length>0&&(n=p.value[0].userentityuisettingsid?new r.a(p.value[0].userentityuisettingsid):r.a.EMPTY),Object(u.a)(n)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(n)?null!=n&&n!==r.a.EMPTY||function(e,t,n,a,i,c,d){var p=r.a.EMPTY,g=Object(l.p)(n,e),h="userentityuisettings";a(Object(s.b)(h,{objecttypecode:g,lastviewedformxml:t})).then((function(t){if(p=t,!(Object(u.a)(p)||Object(u.a)(i)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(p))){var n=d.TraceManager.getTracer("Forms.FormSelectorChange"),s="Created an entry for selected form successfully formid : "+i;n.info(s),a(Object(o.b)(e,i,p))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(i)||Object(u.a)(e)||0===e.length||a(Object(o.b)(e,i,p)),{};var n=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],r="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(r,n)}))}(e,t,a,i,c,d,g):b(e,t,n,a,i,c,d,g)})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,c,n)),{};var r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;g.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,r),g.TraceManager.getTracer("Forms.FormSelectorChange").error(a,r)}))}(j,k,M,S(),C,A,_,y):b(j,k,M,S(),C,A,_,y);else{Object(u.a)(A)||Object(u.a)(j)||0===j.length||C(Object(o.b)(j,A,M));var a=null===(t=null==y?void 0:y.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),i="Selected form did not save in the UserEntityUiSetting table, for formid: "+A;null==a||a.info(i)}else if(1===e.status){a=null===(n=null==y?void 0:y.TraceManager)||void 0===n?void 0:n.getTracer("Forms.FormSelectorChange"),i="Could not change to form with id "+N+" due to a navigation failure or because navigation was cancelled";null==a||a.info(i,f)}return e}))},getFailureParameters:function(e,t){return f}}}function b(e,t,n,a,i,l,d,p){var g=new c.a("userentityuisettings",n);i(Object(s.f)(g,{lastviewedformxml:t})).then((function(){if(!(Object(u.a)(n)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||r.a.isNullOrEmpty(n))){var t=p.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+l;t.info(a),i(Object(o.b)(e,l,n))}})).catch((function(t){if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,l,n)),{};var r=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataUpdate, for formid: "+l;p.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,r),p.TraceManager.getTracer("Forms.FormSelectorChange").error(a,r)}))}},c0jI:function(e,t,n){"use strict";n.d(t,"g",(function(){return _})),n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return I})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return x})),n.d(t,"b",(function(){return T})),n.d(t,"d",(function(){return P}));var r=n("c/eZ"),a=n("uO/V"),i=n("Gemh"),o=n("sOTk");function s(e,t,n,r){var a,i;return{type:"update.grid.configuration",payload:((a={})[t]=((i={})[n]=e,i),a),meta:{pageId:r}}}function c(e,t,n){var r;return{type:"update.views.configuration",payload:((r={})[t]=e,r),meta:{pageId:n}}}var l=n("RXRQ"),u=n("U0B9"),d=n("2OIc"),p=n("i8/j"),g=n("9r0m"),h=n("RlP9"),m=n("S2mk"),f=n("T2Xs"),b=n("j6Db"),v=n("OTOS");function y(e,t){var n=Object(r.__assign)({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){var a=!1;for(var i in e.CustomControls)if(j(e.CustomControls[i],e.CustomControls[t])&&i!==t.toString()){a=!0;break}if(!a){var o=-1;n[o]?o--:n[o.toString()]=e.CustomControls[t]}}return n[t]=null,n}function _(e,t,n,a,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p,g){var h,m,v=p.dispatch,y=p.getState,_=y(),C=Object(u.b)(_),S=Object(i.k)(_,e,t),O={UniqueId:S?S.UniqueId:null,CustomControls:(h={},h[C]=Object(r.__assign)(Object(r.__assign)({},n),{FormFactor:C}),h),FormLibraries:S?S.FormLibraries:null,EventHandlers:S?S.EventHandlers:null},I=Object(o.g)(_,e).entityTypeName;if(d){var j=Object(i.T)(_,e,t);v(c({UniqueId:null,CustomControls:(m={},m[C]=null,m),FormLibraries:null,EventHandlers:null},j.guid,e))}v(Object(l.c)(n.CustomControlId)).then((function(){v(s(O,I,a,e))}),(function(t){var r=Object(f.b)(y(),n.CustomControlId);g.EventManager.ReportComponentFailure(r+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:I},{name:"customControlId",value:n.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:a},{name:"config",value:JSON.stringify(n)}])}))}}}function C(e,t,n,a,d){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute:function(p){var g,m=p.dispatch,f=(0,p.getState)(),b=Object(u.b)(f),v=Object(i.T)(f,e,t),_=Object(h.d)(f,v),C={UniqueId:_?_.UniqueId:null,CustomControls:(g={},g[b]=Object(r.__assign)(Object(r.__assign)({},n),{FormFactor:b}),g),FormLibraries:_?_.FormLibraries:null,EventHandlers:_?_.EventHandlers:null},S=Object(o.g)(f,e).entityTypeName;if(d){var O=Object(i.k)(f,e,t);if(O&&O.CustomControls&&O.CustomControls[b]){var I={UniqueId:O.UniqueId,CustomControls:y(O,b),FormLibraries:O.FormLibraries,EventHandlers:O.EventHandlers};m(s(I,S,a,e))}}m(Object(l.c)(n.CustomControlId)).then((function(){m(c(C,v.guid,e))}))}}}function S(e,t,n){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute:function(a){var i,o=a.dispatch,c=(0,a.getState)(),g=Object(u.b)(c),h=Object(v.b)(c,e),m=Object(p.b)(c,e,h,n),f=Object(d.b)(c,m.UniqueId,h);if(f&&f.CustomControls){var b={UniqueId:m.UniqueId,CustomControls:(i={},i[g]=Object(r.__assign)(Object(r.__assign)({},t),{FormFactor:g}),i),FormLibraries:f.FormLibraries,EventHandlers:f.EventHandlers};o(Object(l.c)(t.CustomControlId)).then((function(){o(s(b,h.guid,f.UniqueId,e))}))}}}}function O(e,t,n,a,i){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute:function(o){var c,d=o.dispatch,p=(0,o.getState)(),g=Object(u.b)(p),h={UniqueId:i.UniqueId,CustomControls:(c={},c[g]=Object(r.__assign)(Object(r.__assign)({},a),{FormFactor:g}),c),FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};d(Object(l.c)(a.CustomControlId)).then((function(){d(s(h,t,n,e))}))}}}function I(e,t,n,a,i,o,d){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute:function(p){var g,h=p.dispatch,m=(0,p.getState)(),f=Object(u.b)(m),b={UniqueId:o.UniqueId,CustomControls:(g={},g[f]=Object(r.__assign)(Object(r.__assign)({},i),{FormFactor:f}),g),FormLibraries:o.FormLibraries,EventHandlers:o.EventHandlers};if(d&&d.CustomControls&&d.CustomControls[f]){var v={UniqueId:d.UniqueId,CustomControls:y(d,f),FormLibraries:d.FormLibraries,EventHandlers:d.EventHandlers};h(s(v,t,n,e))}h(Object(l.c)(i.CustomControlId)).then((function(){h(c(b,a.guid,e))}))}}}function j(e,t){if(e&&t){var n=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,n){var r,a;if(t&&n&&t!==n){if(t instanceof Array&&n instanceof Array&&t.length!==n.length)return!1;for(var i in t)if(t[i]!==n[i]){if("function"==typeof t[i])continue;if(t[i]&&n[i]&&"object"==typeof t[i]&&"object"==typeof n[i]){if(e(t[i],n[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(r=t[i])||void 0===r?void 0:r.toString())===(null===(a=n[i])||void 0===a?void 0:a.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(var r in e.Children)n=n&&j(e.Children[r],t.Children[r]);return n}return!1}return n&&e.Children===t.Children}return!!e==!!t}function P(e,t,n,r,a,i,o,s){var c=t?t.TraceManager.getTracer("customcontrol"):null;return e(x(n,r,i.configuration,i,i.contextString,s).map((function(e){return e.configuration.DisplayNameKey}))).catch((function(e){return c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()}))}function x(e,t,n,r,i,o){var s=[];if(null==o)return s;if(i===a.h.CUSTOM&&r.configuration.isDefaultConfig)return s;var c=i===a.h.GRID||i===a.h.ASSOCIATEDGRID?Object(m.u)(r&&r.controlId,r&&r.gridEntityTypeName,r&&g.a.toString(r.viewId)):Object(m.x)(r&&r.controlId,r&&r.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&E(s,e,"GRID_CONFIG"),t&&t.CustomControls&&E(s,t,"VIEW_CONFIG"),s}function E(e,t,n){for(var r in t.CustomControls)if(t.CustomControls[r]&&!t.CustomControls[r].isDefaultConfig){for(var a=!1,i=0;i<e.length;i++)if(j(e[i].configuration,t.CustomControls[r])){a=!0;break}a||e.push({configuration:t.CustomControls[r],formFactor:r,configurationType:n})}}function T(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},cQE4:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t,n){var a=Object(r.cb)(e,t,n);return a?a.footer:null}},cm3g:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e){this._value=null,this._value=e}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}()},cqI9:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n("Sscr"),a=n("uO/V"),i="chart.visualizationid.update";function o(e,t,n){return{type:"chart.visualizationid.update.async",execute:function(o,s){var c=o.dispatch,l=o.getState,u=s.TraceManager.getTracer(a.z),d=a.x+".updateVisualizationIdAction";try{u.info("Updating the chart visualization id"),t||(t=Object(r.k)(l(),e));var p=Object(r.v)(t);return c(function(e,t,n){return{type:i,payload:{name:"VisualizationId",value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,p,n)),s.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){var g="Updatation of the chart visualization id failed with error : "+e.message;s.EventManager.ReportComponentFailure(d,Error(g))}}}}},dEZ0:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("c/eZ"),a=n("nuS9"),i=n("dD0b"),o=n("pyUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){var t=e.title,n=e.textStyle,s=Object(r.__rest)(e,["title","textStyle"]);return a.createElement(i.a,Object(r.__assign)({accessibilityRole:"button",accessibilityLabel:t},s),a.createElement(o.a,{style:[l.text,n]},t))}function c(e){return a.createElement(s,Object(r.__assign)({},e,{style:[l.button,e.style]}))}var l=n("EZ4w").a.create({button:{color:"#2266E3",alignSelf:"center"},text:{color:"inherit",fontSize:17}})},dcAs:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("c/eZ"),a=n("7pqb"),i=n("Ww2r"),o=n("3Ng8"),s=n("mGpW"),c=n("HSdq"),l=n("F2uj");function u(e,t,n){return{type:"formChecker.ControlState.async",execute:function(u,d){var p,g,h=u.dispatch,m=u.getState;return Object(r.__awaiter)(this,void 0,void 0,(function(){var u,f,b,v,y,_,C,S,O,I,j,P,x,E,T;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return u=m(),f=null===(p=null==d?void 0:d.TraceManager)||void 0===p?void 0:p.getTracer(""+a.k+a.l),b=Object(c.eb)(u,e,t),v=Object(o.b)(),b&&f?[4,h(Object(s.e)(v))]:[2,Promise.resolve()];case 1:for(S in r.sent(),y=m(),_=Object(i.e)(y,v),C=[],b)(O=b[S])&&(I={id:e,controlName:S},j=Object(c.v)(y,I,t),P=(null==j?void 0:j.reason)?Object(i.c)(_,j.reason):null,x=O.labelSource?Object(i.c)(_,O.labelSource):null,E=O.dataFieldName?Object(l.a)(y,n,null==O?void 0:O.dataFieldName):null,T={"Control Name":S,"Control Label":Object(c.w)(y,I,t),"Control Label Source":"["+O.labelSource+"]"+(x?": "+x:""),Attribute:null==E?void 0:E.LogicalName,Disabled:null===(g=null==j?void 0:j.disabled)||void 0===g?void 0:g.toString(),"Disabled State Reason":"["+(null==j?void 0:j.reason)+"]"+(P?": "+P:"")},C.push(T));return f.warn(a.n,[{name:a.v,value:a.l},{name:a.l,value:JSON.stringify(C)}]),[2]}}))}))}}}},e2rP:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="header.commandbarvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},fTYK:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="form.tab.selectPrevious";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t){var n=Object(r.v)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:n}}}},fvre:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Oze0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e){return e&&e.userSettings?e.userSettings.userAccessibilitySettings.toastNotification:{toastNotificationDisplaySpeed:r.a.Normal}}function i(e){return e.userSettings.personalSettingsForMobileApp}},gFjC:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="offline.disabled.entities.update";function a(e,t,n){return{type:r,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:t,offlineDisabledPrimaryEntities:n}}}},gKZ6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="offline.database.cleanup";function a(e){return{type:r,payload:{isDbCleanupNeeded:e}}}},gRWC:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="formSelector.visible";function a(e,t,n){return{type:r,payload:{visible:n},meta:{pageId:e,formId:t}}}},grpZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n("9r0m"),a=n("uQP8"),i=n("sOTk"),o=n("i8/j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n){var r;void 0===n&&(n=!1);var s=Object(i.g)(e,t).entityTypeName,c=Object(o.n)(e,s);if(!n)return c;var l=Object(a.a)(e,t),u=null===(r=null==l?void 0:l.formSelector)||void 0===r?void 0:r.forms,d=c;if(u&&Object.keys(u).length>0)for(var p in d=new Object,c)u[p]&&!u[p].visible||(d[p]=c[p]);return d}function c(e,t,n){var s,c,l=Object(a.a)(e,t),u=r.a.toString(n);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;var d=Object(i.g)(e,t).entityTypeName;return!!Object(o.m)(e,d,n)||null}function l(e,t){var n,r=Object(a.a)(e,t);return null===(n=null==r?void 0:r.formSelector)||void 0===n?void 0:n.selectedFormId}},hE7j:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="control.setSrc";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.v)(n);return{type:a,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},haDr:function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return w}));var r=n("c/eZ"),a=n("nuS9"),i=n("mZYw"),o=n("YWpA"),s=n("4E+q"),c=n("gvL4"),l=n("Wi7Z"),u=n("9rQ4"),d=n("4fxQ"),p=n("Wg6j"),g=n("MGMD"),h=n("lMVv"),m=n("5ZFm"),f=n("Fas2"),b=n("RImw"),v=n("Ww2r"),y=n("5ZRb"),_=n("N2KO"),C=n("kRDR"),S=n("T/iA"),O=n("7EJx"),I=n("qC0c"),j=n("cZkS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var P="Commands",x=!1,E=function(e){function t(t){var n=e.call(this,t)||this;return n._isGlobalComandBar=!1,n._allCommandButtonsTabable=!1,n._selectedIndex=-1,n._selectedId="",n._allControls=[],n._allRenderingMenuItems=[],n._keyboardHandler=n._keyboardHandler.bind(n),n._keyboardFocusHandler=n._keyboardFocusHandler.bind(n),n._isGlobalComandBar=t.commandManagerId.startsWith(C.d),n._allCommandButtonsTabable=n._isGlobalComandBar,n._onCommandBarMeasure=n._onCommandBarMeasure.bind(n),n}return Object(r.__extends)(t,e),t.prototype._init=function(){this._initialized||(this._initialized=!0,this._extractButtons(this.props))},t.prototype._needResetIndex=function(){return!this._allCommandButtonsTabable&&(!!d.findDOMNode(this._commandBarItems)&&(!this._selectedId||!document.getElementById(this._selectedId)))},t.prototype._moveIndex=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var r=d.findDOMNode(this._commandBarItems);if(r){!this._allCommandButtonsTabable&&r.querySelectorAll("[tabindex='0']").forEach((function(e){return e.setAttribute("tabindex","-1")}));var a=r.childNodes[e];if(a){if(t&&this._isSplitButton(e)){var i=a.querySelector("[aria-haspopup='true']");a=i||a}this._selectedIndex=e,this._selectedId=a.id,(n||r.contains(document.activeElement))&&a.focus(),!this._allCommandButtonsTabable&&a.setAttribute("tabindex","0")}}},t.prototype._isSplitButton=function(e){return this._allRenderingMenuItems.length>e&&this._allControls[e].ControlType===_.c},t.prototype._generateControl=function(e){var t=this,n=_.a,r=null;return e.Children&&e.Children.length>0&&(n=e.execute?_.c:_.b,r=e.Children.map((function(e){return t._generateControl(e)}))),{Command:e.Id,Id:e.Id,DataId:e.DataId,ControlType:n,DisplayText:e.DisplayText,execute:e.execute,executeInjectedPopulationQueryCommand:e.executeInjectedPopulationQueryCommand,Icon:e.Icon,isInjectedCommand:!0,WillOpenFlyout:e.WillOpenFlyout,IsInFlyout:e.IsInFlyout,ToolTipTitle:void 0!==e.Tooltip?e.Tooltip.title:"",ToolTipDescription:void 0!==e.Tooltip?e.Tooltip.description:"",ChildInjectedControls:r,dataLPId:e.dataLPId,accessibilityExpanded:e.accessibilityExpanded,controlsElementId:e.controlsElementId,ownsElementId:e.ownsElementId}},t.prototype._getLearningPathId=function(e){var t="commandbar-";if(e.ribbonId)t+=e.ribbonId;else if(e.commandManagerId){var n=(t+=e.commandManagerId).indexOf(":");n>-1&&(t=t.substring(n+1))}return t},t.prototype.componentWillReceiveProps=function(e){var t,n,r;if(!0!==(null===(n=null===(t=this.props)||void 0===t?void 0:t.ribbonDescriptor)||void 0===n?void 0:n.Localized)||!0===(null===(r=null==e?void 0:e.ribbonDescriptor)||void 0===r?void 0:r.Localized)){var a=this._areMenuLengthPropsChanged(e,this.props)||!this._areButtonsEqualInProps(e,this.props);this._extractButtons(e,a)}},t.prototype._areButtonsEqualInProps=function(e,t){return e.menuControlMapping===t.menuControlMapping&&this._areControlListsEqual(e.addedCommandList,t.addedCommandList)&&this._areControlListsEqual(e.appendedCommandList,t.appendedCommandList)},t.prototype._areControlListsEqual=function(e,t){return null==e||null==t?null==e&&null==t:e.length===t.length&&e.every((function(e,n){return e.Id===t[n].Id&&e.DisplayText===t[n].DisplayText}))},t.prototype._areMenuLengthPropsChanged=function(e,t){return e.width!==t.width||e.iconPosition!==t.iconPosition||e.commandbarDisplayMode!==t.commandbarDisplayMode||e.mainMenuLength!==t.mainMenuLength},t.prototype._extractButtons=function(e,t){void 0===t&&(t=!0),this._updateAllControls(e),this._updateRenderingMenuItems(e),t&&(this._mainMenuLength=Object(S.c)(e.width,e.commandBarStyle,this._allControls,e.iconPosition,e.isRTL,e.commandbarDisplayMode,e.mainMenuLength,e.forceUseOfMainMenuLength,x),this._allCommandButtonsTabable||(this._selectedId=void 0))},t.prototype._updateAllControls=function(e){var t=this;if(this._allControls=[],e.addedCommandList&&e.addedCommandList.forEach((function(e){t._allControls.push(t._generateControl(e))})),e.ribbonDescriptor&&e.ribbonDescriptor.Layout){var n=new Array;e.ribbonDescriptor.Layout.Tabs.Tab&&(n=n.concat(e.ribbonDescriptor.Layout.Tabs.Tab)),e.ribbonDescriptor.Layout.ContextualTabs.Tab&&(n=n.concat(e.ribbonDescriptor.Layout.ContextualTabs.Tab)),n.forEach((function(n){n&&n.Groups&&n.Groups.Group&&n.Groups.Group.forEach((function(n){n.Controls.Items.forEach((function(n){var r=n?Object(f.i)(n.Id,Object(b.a)(e.ribbonId)):null;n&&r&&e.menuControlMapping[r]&&t._allControls.push(n)}))}))}))}e.appendedCommandList&&e.appendedCommandList.forEach((function(e){t._allControls.push(t._generateControl(e))}))},t.prototype._updateRenderingMenuItems=function(e){var t=this;this._allRenderingMenuItems=[];var n=e.selectedRecords&&e.selectedRecords.length>0;this._allControls.forEach((function(r,a){var i={RootButtonId:null,contextKey:e.contextKey,areRecordsSelected:n,isFlyoutControl:!1,commandManagerId:e.commandManagerId,control:r,iconPosition:e.iconPosition,flyoutDepth:0,commandBarStyle:e.commandBarStyle,isMainView:!0,executeCommand:e.executeCommand,ribbonId:e.ribbonId,pageId:e.pageId,commandbarDisplayMode:e.commandbarDisplayMode,updateMainViewKeyboardIndex:t._updateSelectedIndex(a),hideFlyoutButtonChevron:e.hideFlyoutButtonChevron,isCommandBarRefresh:e.isCommandBarRefresh,rootZIndex:e.rootZIndex},o=Object(p.f)(r,i,t._allRenderingMenuItems.length,t._allCommandButtonsTabable,e.entityDisplayName,e.entityDisplayCollectionName);t._allRenderingMenuItems.push(o)}))},t.prototype.render=function(){var e=this;this._init(),this._numberMainMenuControls=0,this._numberOverflowControls=0;var t=[],n=[];if(this._allRenderingMenuItems.forEach((function(t){n.length<e._mainMenuLength&&(n.push(t),e._numberMainMenuControls++)})),this._allControls.length>this._mainMenuLength)for(var o=this._mainMenuLength;o<this._allControls.length;o++)this._addControlToMoreMenu(this._allControls[o],t);var s=this.props.selectedRecords&&this.props.selectedRecords.length>0;if(this._numberOverflowControls>0){var c=Object(v.c)(this.props.resourceStrings,y.c),l=Object(v.c)(this.props.resourceStrings,y.b),u=this.props.entityDisplayName?String.format(l,this.props.entityDisplayName):c,d=Object(p.i)({ToolTipTitle:u,OverflowIcon:this.props.useVerticalMoreIcon?"MoreVertical":"More"},C.f),g=Object(p.e)(d,this.props.commandManagerId,this.props.contextKey),h=Object(r.__assign)({},this.props.commandBarStyle);h.listItemBody=Object(r.__assign)({},h.listItemBody),h.listItemBody.button=Object(r.__assign)(Object(r.__assign)({},h.listItemBody.button),{paddingLeft:0,paddingRight:0}),n.push(a.createElement(i.a,{contextKey:this.props.contextKey,areRecordsSelected:s,isOverflowFlyoutMoreButton:!0,commandbarDisplayMode:this.props.commandbarDisplayMode,isFlyoutControl:!1,flyoutDepth:0,commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,accessibilityLabel:u,key:g,id:g,tabIndex:this._allCommandButtonsTabable?0:-1,ariaOwnsElementId:g+"_flyout",RootButtonId:g,menuItems:t,control:d,iconPosition:this.props.iconPosition,commandBarStyle:h,isMainView:!0,executeCommand:this.props.executeCommand,ribbonId:this.props.ribbonId,updateMainViewKeyboardIndex:this._updateSelectedIndex(this._numberMainMenuControls),isCommandBarRefresh:this.props.isCommandBarRefresh,rootZIndex:this.props.rootZIndex})),this._numberMainMenuControls++}return this._getMarkupOfCommandBar(n,this.props)},t.prototype._onCommandBarMeasure=function(){var e=d.findDOMNode(this._commandBarItems);if(e){var t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){if(e){var t=getComputedStyle(e),n=parseInt(t.fontSize,10),r=parseFloat(t.letterSpacing),a=parseFloat(t.wordSpacing);return r>=.12*n&&a>=.16*n}}(e);x!==t&&(x=t,this._extractButtons(this.props),this.forceUpdate())}},t.prototype._getMarkupOfCommandBar=function(e,t){var n,i=this,s="$commandBarInfo"+t.commandManagerId,u="$commandBarItemsList"+t.commandManagerId;return e.length>0?a.createElement(o.a,{style:this._transformContainerStyle(t),key:s,isRequestedMeasuring:!0,onMeasuring:this._onCommandBarMeasure},a.createElement(c.a,{ref:function(e){i._commandBarItems=e,i._needResetIndex()&&i._moveIndex(0,!1,!1)},testhooks:(n={id:"CommandBar"},n[g.a.LearningPathDOMAttributeSuffix]=this._getLearningPathId(t),n),accessibilityLabel:P,key:u,role:l.m,style:Object(r.__assign)(Object(r.__assign)({},t.commandBarStyle.list),{listStyleType:"none",flexShrink:"0"}),onKeyDown:this._keyboardHandler,onFocus:this._keyboardFocusHandler},e)):null},t.prototype._transformContainerStyle=function(e){var t=e.commandBarStyle.container;return e.height&&(t=Object(r.__assign)(Object(r.__assign)({},t),{maxHeight:e.height+"px",overflowY:"auto"})),t},t.prototype._addControlToMoreMenu=function(e,t){t.push(e),this._numberOverflowControls++},t.prototype._updateSelectedIndex=function(e){var t=this;return function(){t._selectedIndex=e,!t._isGlobalComandBar&&t._moveIndex(e,!1,!1)}},t.prototype._getBrightnessFromRGB=function(e,t,n){return Math.round((299*e+587*t+114*n)/1e3)},t.prototype._keyboardFocusHandler=function(e){var t=e.target,n=document.getElementById(t.id);if(n&&n.style){var r="";do{r=window.getComputedStyle(t).backgroundColor,t=t.parentElement}while(("rgba(0, 0, 0, 0)"===r||"transparent"===r)&&t);if(-1!==r.indexOf("rgb")){var a=r.split(/[()]+/)[1].split(",");n.style.outlineColor=this._getBrightnessFromRGB(parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10))>125?"#666666":"#FFFFFF"}}if(!this._isGlobalComandBar){var i=d.findDOMNode(this._commandBarItems),o=i&&i.children;if(o)for(var s=0;s<o.length;s++)""!==o[s].id&&o[s].id===e.target.id&&s!==this._selectedIndex&&this._moveIndex(s)}},t.prototype._keyboardHandler=function(e){if(e.keyCode===u.a.Enter)return e.stopPropagation(),e.preventDefault(),void e.target.click();if(!this._isGlobalComandBar){var t=!this.props.isRTL&&e.keyCode===u.a.RightArrow||this.props.isRTL&&e.keyCode===u.a.LeftArrow;!this.props.isRTL&&e.keyCode===u.a.LeftArrow||this.props.isRTL&&e.keyCode===u.a.RightArrow?this._moveIndex(T(this._selectedIndex-1,this._numberMainMenuControls),!0):t&&this._moveIndex(T(this._selectedIndex+1,this._numberMainMenuControls),!1)}},t}(a.Component);function T(e,t){return(e%t+t)%t}E.displayName="CommandBar";var w=Object(s.a)((function(){var e=Object(m.g)(),t=Object(v.h)();return function(n,r){var a=e(n,r),i=r.ribbonId?r.ribbonId.split(":"):null,o=i&&i.length>1?i[i.length-1]:null,s=Object(h.h)(n,o);return{menuControlMapping:a,entityDisplayName:s&&s.DisplayName?s.DisplayName:"",entityDisplayCollectionName:s&&s.DisplayCollectionName?s.DisplayCollectionName:"",resourceStrings:t(n,y.e),isRTL:Object(O.g)(n),useVerticalMoreIcon:Object(I.a)(n,j.ke,j.h)&&Object(p.r)("MoreVertical")}}}))(E)},hzb9:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("ygXU"),a="offline.upsync.start";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:r.a.InProgress};return{type:a,payload:e}}},ig6i:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}return Object.defineProperty(e.prototype,"etn",{get:function(){return this._etn},set:function(e){this._etn=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributeName",{get:function(){return this._attributeName},set:function(e){this._attributeName=e},enumerable:!1,configurable:!0}),e}()},ipvx:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r={animationIn:{from:{scale:1.05},to:{scale:1}},animationOut:{from:{opacity:1},to:{opacity:0}},animationInTiming:200,animationOutTiming:150}},ixd0:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r,a=n("9r0m"),i=n("IiPO"),o=n("sOTk"),s=n("+Z9T"),c=n("ezfI"),l=n("bJYk"),u=n("gRWC"),d=n("grpZ"),p=function(){function e(e,t,n,a){this._id=e,this._label=t,r=n,this._pageId=a}return e.prototype.getId=function(){var e="ClientApi.XrmFormSelectorItem.getId";try{c.a.instance.reportCall(e);var t=a.a.toString(this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.getLabel=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label},e.prototype.getPageId=function(){return c.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId},e.prototype.setVisible=function(e){var t="ClientApi.XrmFormSelectorItem.setVisible";try{c.a.instance.reportCall(t),r.dispatch(Object(u.b)(this._pageId,a.a.toString(this._id),e)),c.a.instance.reportSuccess(t)}catch(e){throw i.a.getInstance().reportFailure(t,e),e}},e.prototype.getVisible=function(){var e="ClientApi.XrmFormSelectorItem.getVisible";try{c.a.instance.reportCall(e);var t=Object(d.c)(r.getState(),this._pageId,this._id);return c.a.instance.reportSuccess(e),t}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e.prototype.navigate=function(){var e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(s.j)(e,"PageId"),c.a.instance.reportCall(e);var t=Object(o.g)(r.getState(),this._pageId),n=t&&t.id?t.id.guid:"",a=Object(o.l)(r.getState(),this._pageId);r.dispatch(Object(l.a)(this._id.guid,this._pageId,a,n)).then((function(){c.a.instance.reportSuccess(e)})).catch((function(t){return Object(s.d)(r,t,e+".changeForm")}))}catch(t){throw i.a.getInstance().reportFailure(e,t),t}},e}()},"jM+9":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h}));var r=n("c/eZ"),a=n("nuS9"),i=n("WziN"),o=n("pyUm"),s=n("4PNl"),c=n("EZ4w"),l=n("v7n7"),u=n.n(l),d=n("LXYY"),p=n("ipvx");function g(e){var t=e.title,n=e.message,c=e.buttons,l=e.contentHeight,d=a.useState(!0),g=d[0],h=d[1],f=a.useState(null),b=f[0],v=f[1],y=a.useCallback((function(e){h(!1),v((function(t){return e}))}),[]);return a.createElement(u.a,Object(r.__assign)({},p.a,{backdropOpacity:.4,onModalHide:function(){return b&&b()},isVisible:g,style:m.modal}),a.createElement(i.a,{style:m.dialog},a.createElement(i.a,{style:[m.textContainer,{height:l}]},a.createElement(o.a,{style:m.title,numberOfLines:1},t),a.createElement(s.a,{style:m.messageContainer},a.createElement(o.a,{style:m.message},n))),c(y)))}var h="#C8C8C8",m=c.a.create({modal:{flexDirection:"column",flexGrow:1,justifyContent:"center"},dialog:{width:270,minHeight:140,maxHeight:"100%",flexGrow:0,alignSelf:"center",borderRadius:14,backgroundColor:"#E8E8E8"},textContainer:{flex:1,paddingTop:17,alignItems:"center",borderBottomWidth:d.a,borderBottomColor:h},title:{fontSize:17,fontWeight:"bold"},message:{marginTop:1,fontSize:13,paddingLeft:13,paddingRight:13,textAlign:"center"},messageContainer:{flex:1}})},jf1O:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("c/eZ"),a=n("uO/V"),i=n("0OS1"),o=n("Wg6j"),s=n("7EJx");function c(e,t,n,c){var l=Object(s.g)(e),u=Object(o.p)(l,null),d=null,p={"[aria-expanded=true]":{backgroundColor:c?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:c?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill}};switch(t.contextString){case a.h.GRID:u.container.backgroundColor=c?n.colors.BaseColor.White:n.colors.MainThemeColor.MainColor1.Fill,u.container.marginLeft="0px",u.container.marginRight="0px",u.listItemBody.text.color=c?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,u.listItemBody.icon.color=c?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,u.listItemBody.iconWrapperStyles.color=c?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,u.moreIcon.color=c?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,u.splitbuttonicon.color=c?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,d={":hover":{backgroundColor:c?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill}},u.splitbuttonOverflowButton=Object(r.__assign)(Object(r.__assign)({},u.splitbuttonOverflowButton),p),u.listItem=Object(r.__assign)(Object(r.__assign)({},u.listItem),p),u.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=l?void 0:n.colors.MainThemeColor.MainColor1.Text,u.listItemBody.splitButtonChevronIconWrapper.borderRightColor=l?n.colors.MainThemeColor.MainColor1.Text:void 0,u.overflowFlyoutMoreButton=Object(r.__assign)(Object(r.__assign)({},u.overflowFlyoutMoreButton),d),c&&(u.list.marginTop="0px",u.list.marginBottom="0px",u.listItem.height="100%",u.listItem.alignItems="center",u.listItemBody.button.width=n.sizes.Measures.Measure300,u.moreIcon.marginRight=n.sizes.Measures.Measure100,u.moreIcon.marginLeft=n.sizes.Measures.Measure100,u.container.borderStyle="none",u.list.marginLeft="0px",u.list.marginRight="0px");break;case a.h.SUBGRID:case a.h.ASSOCIATEDGRID:default:u.container.backgroundColor="transparent",u.container.marginTop=t.contextString!==a.h.SUBGRID?"10px":"0px",u.container.marginLeft="0px",u.container.marginRight="0px",u.listItemBody.text.color=i.a.colors.BaseColor.Grey.Grey7,u.listItemBody.iconWrapperStyles.color=i.a.colors.BaseColor.Grey.Grey7,u.listItemBody.icon.color=i.a.colors.BaseColor.Grey.Grey7,u.moreIcon.color=i.a.colors.BaseColor.Grey.Grey7,u.splitbuttonicon.color=i.a.colors.BaseColor.Grey.Grey7,u.listItem.color=i.a.colors.BaseColor.Grey.Grey7,u.list.marginLeft="0px",u.list.marginRight="0px",d={":hover":{backgroundColor:i.a.colors.BaseColor.Grey.Grey2}},u.overflowFlyoutMoreButton=Object(r.__assign)(Object(r.__assign)({},u.overflowFlyoutMoreButton),d)}return null!=d&&(u.listItemBody.button=Object(r.__assign)(Object(r.__assign)({},u.listItemBody.button),d)),u}var l=n("aPRd"),u=n("wV3W"),d=n("qC0c"),p=n("cZkS"),g=n("TCzx"),h=n("vO+w"),m=n("NiE3");function f(){var e,t,n=null,i=null,o=g.a.getInstance().get_IsBrowserIE(),f={display:"flex",width:"100%",boxSizing:"border-box"};f=o?Object.assign(f,{flex:"1 1 100%"}):f;var b={justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",width:"100%",paddingBottom:"5px"};b=o?Object.assign(b,{flex:"1 1 100%"}):b;var v={border:"none",background:"none",fontSize:"1rem",padding:"0px 12px 0px 12px",display:"flex",alignItems:"center"},y={containerStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",maxWidth:"100%",overflow:"auto"},rootStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",minWidth:"100%",minHeight:0},headerStyle:{width:"100%",flexWrap:"wrap",flexShrink:0,"-webkit-transform":"translate3d(0,0,0)"},headerInnerStyle:f,headerInnerMobileStyle:{display:"flex"},quickFindStyle:{flex:"0 1 auto",marginTop:"auto",marginBottom:"auto"},quickFindContainerStyle:{display:"flex"},quickFindMobileStyle:{justifyContent:"space-between"},quickFindRNInputStyle:{justifyContent:"center"},dataSetContentBodyStyle:{display:"flex",flex:"1 1 auto",flexDirection:"row",overflowY:"hidden",overflowX:"hidden","@media (max-height: 560px)":{flex:"1 0 auto"}},reflowdataSetContentBodyStyle:{display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",flex:"1 1 auto",minHeight:"12rem"},bodyStyle:{display:"flex",flex:"1 1 auto",overflow:"hidden",minWidth:"0%"},bodyMobileStyle:{display:"flex",flex:"1 1 auto",maxWidth:"100%",minWidth:"0%"},chartStyle:{minWidth:"320px",width:"30%",display:"flex"},reflowChartStyle:{minWidth:"100%",width:"100%",display:"flex",flex:"0 0 auto"},reflowChartMobileStyle:{minWidth:"100%",width:"100%",display:"flex",flex:"0 0 auto"},reflowGridStyle:{minHeight:"250px",display:"flex",flexDirection:"column",maxWidth:"100%",flex:"1 1 auto"},viewSelectorOuterStyle:{marginRight:"auto",minWidth:"0",flex:"auto"},viewSelectorOuterMobileStyle:{marginRight:"auto",minWidth:"0",flex:"auto"},viewSelectorStyle:{display:"flex",flex:"1",flexDirection:"row",minWidth:"0"},titleStyle:{display:"flex",flex:"1",marginTop:"auto",marginBottom:"auto",whiteSpace:"nowrap"},titleMobileStyle:{display:"flex",flex:"1",marginTop:"auto",marginBottom:"auto",whiteSpace:"nowrap"},commandManagerContainerStyle:{display:"flex"},commandManagerContainerMobileStyle:{flex:"1",flexDirection:"row-reverse"},filterComboStyle:{boxSizing:"border-box",backgroundColor:"transparent",marginTop:"auto",marginBottom:"auto"},filterContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:"22rem"},activityTypeFilterContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:"22rem"},filterContainerMobileStyle:{justifyContent:"space-between"},filterLabelStyle:{cursor:"default"},activityMgmtLabelStyle:{cursor:"default"},jumpBarButtonContainerStyle:{display:"flex",alignItems:"center",backgroundColor:"transparent",minWidth:"0"},footerStyle:{display:"flex",position:"relative"},footerOuterStyle:{marginTop:"auto",display:"flex",flexDirection:"column"},footerMobileStyle:{marginTop:"auto",display:"flex",flexDirection:"row",justifyContent:"space-between"},footerPagingContainer:{display:"flex",flex:"1 1 auto"},dataSetChangingProgressIndicatorContainerStyle:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",position:"absolute",display:"flex"},dataSetChangingProgressIndicatorStyle:{position:"relative",display:"flex",alignContent:"center",justifyContent:"center"},progressIndicatorContainerStyle:{flex:"1 1 auto",display:"flex",alignItems:"center",position:"relative"},progressIndicatorStyle:{width:"100%",height:200,alignContent:"center",display:"flex",position:"relative",flexDirection:"column",justifyContent:"center"},datasethostProgressIndicatorStyle:{width:"40px",height:"40px"},seeMoreButtonContainerStyle:{justifyContent:"flex-end",backgroundColor:"transparent",flexDirection:"row",display:"flex",flex:"0 0 auto",alignItems:"center"},seeMoreButtonStyle:{height:"100%",borderStyle:"none",backgroundColor:"transparent",alignItems:"center",padding:0,cursor:"pointer"},activityViewContainerStyle:b,dueDateComboBoxStyles:{boxSizing:"border-box",backgroundColor:"transparent",width:"17rem",height:"2.53rem",padding:"1px",borderRadius:"2px"},activityTypeComboBoxStyles:{boxSizing:"border-box",backgroundColor:"transparent",width:"17rem",height:"2.53rem",padding:"1px",borderRadius:"2px"},mobileSubGridContainerStyles:{borderColor:"#C8C8C8",borderWidth:"1px",borderStyle:"solid",width:"100%",borderRight:"0px",borderLeft:"0px"},columnEditorButtonStyle:{marginTop:"8px"}};return function(o,g){var f,b,_,C,S,O,I,j,P,x,E,T,w,A,F,N,k,M,D,R,L,B,V,G,W,z,X,q,U,H,Y,K,Q,Z,J,$,ee,te,ne,re,ae,ie,oe,se,ce,le,ue,de,pe,ge,he,me,fe,be,ve,ye,_e,Ce,Se=Object(s.g)(o),Oe=Object(d.a)(o,p.le,p.h),Ie=Object(h.b)(o)&&Object(d.a)(o,p.Fb,p.Lc),je=Object(d.a)(o,p.Od,p.h),Pe=Object(l.c)(o),xe=Ie&&(null===(T=Object(h.a)(o))||void 0===T?void 0:T.Components)?Object(h.a)(o).Components:null;if(n!==g.contextString||e!==Se||t!==Pe){n=g.contextString,e=Se,t=Pe;var Ee=Object(u.a)(o),Te=void 0,we=void 0,Ae=void 0,Fe=void 0,Ne=void 0,ke=void 0,Me=void 0,De=void 0,Re=void 0,Le=void 0,Be=void 0,Ve=void 0,Ge=void 0,We=void 0,ze=void 0,Xe=void 0,qe=void 0,Ue=void 0,He=void 0,Ye=void 0,Ke=void 0,Qe=void 0,Ze=void 0,Je=void 0,$e=Object(r.__assign)(Object(r.__assign)({},y.titleStyle),((f={})["padding"+(Se?"Left":"Right")]=Ee.sizes.Measures.Measure125,f.color=(null===(A=null===(w=null==xe?void 0:xe.Grid)||void 0===w?void 0:w.ColumnHeader)||void 0===A?void 0:A.TextColor)||Ee.colors.BaseColor.Grey.Grey7,f.fontFamily=Ee.fontFamilies.Regular,f.minHeight=Ee.sizes.Measures.Measure300,f.lineHeight=Ee.sizes.Measures.Measure300,f)),et=$e,tt=void 0,nt=void 0,rt=void 0,at=void 0,it=void 0,ot=void 0,st=void 0,ct=Object(r.__assign)(Object(r.__assign)({},y.filterLabelStyle),((b={})["margin"+(Se?"Left":"Right")]=Ee.sizes.Measures.Measure015,b)),lt=Object(r.__assign)(Object(r.__assign)({},y.activityMgmtLabelStyle),((_={})["padding"+(Se?"Left":"Right")]="8px",_["margin"+(Se?"Left":"Right")]=Ee.sizes.Measures.Measure015,_)),ut=void 0,dt=void 0,pt=void 0,gt=Object(r.__assign)(Object(r.__assign)({},y.footerPagingContainer),xe?{backgroundColor:xe.Grid.Footer.BackgroundColor}:{}),ht="border-box";switch(n){case a.h.GRID:Te=Object(r.__assign)(Object(r.__assign)({},y.headerStyle),{marginBottom:"0px",backgroundColor:(null===(N=null===(F=null==xe?void 0:xe.Grid)||void 0===F?void 0:F.ColumnHeader)||void 0===N?void 0:N.BackgroundColor)||Ee.colors.BaseColor.White}),we=Object(r.__assign)(Object(r.__assign)({},y.headerInnerStyle),{marginLeft:Oe||Se?void 0:Ee.sizes.Measures.Measure150,marginRight:Oe||!Se?void 0:Ee.sizes.Measures.Measure150,marginTop:"0px",marginBottom:"0px",height:"56px",lineHeight:"56px",minHeight:"56px"}),Ae=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.headerInnerMobileStyle),{marginLeft:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure100,marginTop:Ee.sizes.Measures.Measure125,height:Ee.sizes.Measures.Measure300,lineHeight:Ee.sizes.Measures.Measure300,minHeight:Ee.sizes.Measures.Measure300,width:"calc(100% - "+Ee.sizes.Measures.Measure100+")"}),Oe&&{marginLeft:void 0,marginRight:void 0,marginTop:void 0,paddingTop:"16px",paddingBottom:"16px",minHeight:"24px",maxHeight:"24px"}),Fe=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerStyle),{width:"100%",height:Ee.sizes.Measures.Measure300,minHeight:Ee.sizes.Measures.Measure300,backgroundColor:Ee.colors.MainThemeColor.MainColor1.Fill,flex:"0 1 auto",marginLeft:"0",marginRight:"0"}),Ne=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerMobileStyle),{maxWidth:"25%"}),Oe&&{maxWidth:void 0,marginBottom:"-8px",marginTop:"-8px"}),ke=c(o,g,Ee),Me=function(e,t,n){return c(e,t,n,!0)}(o,g,Ee),at=Object(r.__assign)(Object(r.__assign)({},y.filterContainerStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",marginTop:"0",marginBottom:"5px",marginRight:Se?"20px":"0",marginLeft:Se?"0":"20px",height:Ee.sizes.Measures.Measure250}),it=Object(r.__assign)(Object(r.__assign)({},y.activityTypefilterContainerStyle),{justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",marginTop:"0",marginBottom:"5px",marginRight:Se?"20px":"0",marginLeft:Se?"0":"20px",height:Ee.sizes.Measures.Measure250}),ot=Object(r.__assign)(Object(r.__assign)({},y.filterContainerMobileStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",marginTop:Ee.sizes.Measures.Measure025,marginLeft:Se?"0":Ee.sizes.Measures.Measure100,marginRight:Se?Ee.sizes.Measures.Measure100:"0",marginBottom:Ee.sizes.Measures.Measure100,width:"100%"}),st=Object(r.__assign)(Object(r.__assign)({},y.filterComboStyle),{border:Ee.borders.Border02,borderColor:Ee.colors.BaseColor.Grey.Grey3,lineHeight:Ee.sizes.Measures.Measure250}),Ye=Object(r.__assign)(Object(r.__assign)({},y.dataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}),Ke=je?Object(r.__assign)(Object(r.__assign)({},y.reflowdataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}):Object(r.__assign)(Object(r.__assign)({},y.reflowdataSetContentBodyStyle),{marginLeft:Ee.sizes.Measures.Measure050,marginRight:Ee.sizes.Measures.Measure050,marginBottom:Ee.sizes.Measures.Measure050}),Qe=je?Object(r.__assign)(Object(r.__assign)({},y.chartStyle),((C={boxSizing:ht})["border"+(Se?"Left":"Right")]=Ee.borders.Border02,C.borderBottom=Ee.borders.Border02,C.paddingLeft=Ee.sizes.Measures.Measure150,C.paddingRight=Ee.sizes.Measures.Measure150,C.backgroundColor=Ee.colors.BaseColor.White,C)):Object(r.__assign)(Object(r.__assign)({},y.chartStyle),{boxSizing:ht,borderRight:Ee.borders.Border02,borderBottom:Ee.borders.Border02,borderLeft:Ee.borders.Border02,borderTopWidth:Ee.sizes.Measures.Measure025,borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",marginRight:Ee.sizes.Measures.Measure150,paddingTop:Ee.sizes.Measures.Measure025,paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,backgroundColor:Ee.colors.BaseColor.White}),tt=je?Object(r.__assign)(Object(r.__assign)({},y.reflowChartStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,paddingLeft:Ee.sizes.Measures.Measure150,paddingRight:Ee.sizes.Measures.Measure150,backgroundColor:Ee.colors.BaseColor.White}):Object(r.__assign)(Object(r.__assign)({},y.reflowChartStyle),{boxSizing:ht,borderRight:Ee.borders.Border02,borderBottom:Ee.borders.Border02,borderLeft:Ee.borders.Border02,borderTopWidth:Ee.sizes.Measures.Measure025,borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,paddingTop:Ee.sizes.Measures.Measure025,marginBottom:Ee.sizes.Measures.Measure050,borderTopStyle:"solid",paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,backgroundColor:Ee.colors.BaseColor.White}),nt=je?Object(r.__assign)(Object(r.__assign)({},y.reflowChartMobileStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,backgroundColor:Ee.colors.BaseColor.White}):Object(r.__assign)(Object(r.__assign)({},y.reflowChartMobileStyle),{boxSizing:ht,borderRight:Ee.borders.Border02,borderBottom:Ee.borders.Border02,borderLeft:Ee.borders.Border02,borderTopWidth:Ee.sizes.Measures.Measure025,borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,paddingTop:Ee.sizes.Measures.Measure025,marginBottom:Ee.sizes.Measures.Measure050,borderTopStyle:"solid",paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,backgroundColor:Ee.colors.BaseColor.White}),rt=je?Object(r.__assign)(Object(r.__assign)({},y.reflowGridStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,backgroundColor:(null===(M=null===(k=null==xe?void 0:xe.Grid)||void 0===k?void 0:k.Cell)||void 0===M?void 0:M.BackgroundColor)||Ee.colors.BaseColor.White}):Object(r.__assign)(Object(r.__assign)({},y.reflowGridStyle),{boxSizing:ht,borderRight:Ee.borders.Border02,borderBottom:Ee.borders.Border02,borderLeft:Ee.borders.Border02,paddingTop:Ee.sizes.Measures.Measure025,backgroundColor:(null===(R=null===(D=null==xe?void 0:xe.Grid)||void 0===D?void 0:D.Cell)||void 0===R?void 0:R.BackgroundColor)||Ee.colors.BaseColor.White,borderTopWidth:Ee.sizes.Measures.Measure025,borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid"}),Ze=Object(r.__assign)(Object(r.__assign)({},y.bodyStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,borderTopWidth:"0px",borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:xe?xe.Grid.Cell.BackgroundColor:Ee.colors.BaseColor.White}),Je=Object(r.__assign)(Object(r.__assign)({},y.bodyMobileStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,borderTopWidth:"0px",borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(B=null===(L=null==xe?void 0:xe.Grid)||void 0===L?void 0:L.Cell)||void 0===B?void 0:B.BackgroundColor)||Ee.colors.BaseColor.White,minHeight:Ee.sizes.Measures.Measure450}),De=Object(r.__assign)(Object(r.__assign)({},y.quickFindStyle),{height:Ee.sizes.Measures.Measure250,lineHeight:Ee.sizes.Measures.Measure250,backgroundColor:(null===(W=null===(G=null===(V=null==xe?void 0:xe.Grid)||void 0===V?void 0:V.ColumnHeader)||void 0===G?void 0:G.QuickFind)||void 0===W?void 0:W.BackgroundColor)||Ee.colors.BaseColor.White,marginLeft:Se?Oe?"32px":Ee.sizes.Measures.Measure150:Ee.sizes.Measures.Measure075,marginRight:Se?Ee.sizes.Measures.Measure075:Oe?"32px":Ee.sizes.Measures.Measure150,marginTop:"10px"}),Re=Object(r.__assign)({},y.quickFindStyle),Le=Object(d.c)(o,p.ad)?Object(r.__assign)(Object(r.__assign)({},y.quickFindMobileStyle),{height:Ee.sizes.Measures.Measure400,lineHeight:Ee.sizes.Measures.Measure250,marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,backgroundColor:(null===(q=null===(X=null===(z=null==xe?void 0:xe.Grid)||void 0===z?void 0:z.ColumnHeader)||void 0===X?void 0:X.QuickFind)||void 0===q?void 0:q.BackgroundColor)||Ee.colors.BaseColor.White,width:"100%"}):Object(r.__assign)(Object(r.__assign)({},y.quickFindMobileStyle),{height:Ee.sizes.Measures.Measure250,lineHeight:Ee.sizes.Measures.Measure250,marginTop:Ee.sizes.Measures.Measure025,marginLeft:Ee.sizes.Measures.Measure050,marginRight:Ee.sizes.Measures.Measure050,marginBottom:Ee.sizes.Measures.Measure100,backgroundColor:(null===(Y=null===(H=null===(U=null==xe?void 0:xe.Grid)||void 0===U?void 0:U.ColumnHeader)||void 0===H?void 0:H.QuickFind)||void 0===Y?void 0:Y.BackgroundColor)||Ee.colors.BaseColor.White,width:"100%"}),Be=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNContainerStyle),{backgroundColor:(null===(Q=null===(K=null==xe?void 0:xe.Grid)||void 0===K?void 0:K.ColumnHeader)||void 0===Q?void 0:Q.BackgroundColor)||Ee.colors.BaseColor.White,height:56,flexDirection:"row",alignItems:"center",paddingTop:10,paddingBottom:10,width:"100%",maxWidth:Pe}),Ve=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNInputStyle),{textAlignmentsVertical:"center",paddingRight:Ee.sizes.Measures.Measure225,paddingLeft:Ee.sizes.Measures.Measure225,backgroundColor:"#f1f1f1",borderRadius:10,fontSize:Ee.fontSizes.FontL,flex:1}),Ge=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNIconSearch),{height:20,width:20}),We=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNIconClear),{left:"-24px",height:16,width:16}),ze=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNCancelButton),{justifyContent:"space-around",alignItems:Se?"flex-start":"flex-end",right:Ee.sizes.Measures.Measure1143,backgroundColor:"transparent",height:56}),Xe=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNCancelButtonText),{fontSize:Ee.fontSizes.FontL,color:"#6e6e6e"}),qe=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNUserInputColor),{color:"#6e6e6e"}),Ue=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNClearIconColor),{color:"#919191"}),He=Object(r.__assign)(Object(r.__assign)({},y.quickFindRNPlaceholderColor),{color:"#8e8e8e"}),dt=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterStyle),{minWidth:"40%"}),Oe&&{display:"flex",flexDirection:"row",justifyContent:"space-between",paddingTop:"16px",paddingBottom:"16px",height:"24px"}),pt=Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterMobileStyle),{minWidth:"50%",maxWidth:"calc(100% - "+Ee.sizes.Measures.Measure700+")"}),$e=Object.assign($e,{fontSize:"20px",minWidth:"40%"}),et=Object.assign(et,{fontSize:Ee.fontSizes.Font125,minWidth:"70%"});var mt=((S={height:Ee.sizes.Measures.Measure300,minHeight:Ee.sizes.Measures.Measure300,width:Ee.sizes.Measures.Measure300,minWidth:Ee.sizes.Measures.Measure300})["margin"+(Se?"Left":"Right")]=Ee.sizes.Measures.Measure100,S.backgroundColor=Ee.colors.MainThemeColor.MainColor1.Fill,S.borderRadius="50%",S.flex="0 0 auto",S),ft={height:Ee.sizes.Measures.Measure200,minHeight:Ee.sizes.Measures.Measure200,width:Ee.sizes.Measures.Measure200,minWidth:Ee.sizes.Measures.Measure200,margin:"auto"},bt={color:Ee.colors.BaseColor.White,fontSize:Ee.sizes.Measures.Measure1143,display:"inline-block",width:Ee.sizes.Measures.Measure300,minWidth:Ee.sizes.Measures.Measure300,textAlign:"center"},vt=((O={})["margin"+(Se?"Left":"Right")]=Ee.sizes.Measures.Measure100,O),yt={minHeight:Ee.sizes.Measures.Measure300,minWidth:Ee.sizes.Measures.Measure300,height:Ee.sizes.Measures.Measure300,width:Ee.sizes.Measures.Measure300,margin:0,borderRadius:"50%",flex:"0 0 100",display:"flex"};i=Object(r.__assign)(Object(r.__assign)({},y),{headerStyle:Te,headerInnerStyle:we,headerInnerMobileStyle:Ae,commandManagerContainerStyle:Fe,commandManagerContainerMobileStyle:Ne,commandBarStyle:ke,commandBarMobileInnerStyle:Me,filterContainerStyle:at,activityTypeFilterContainerStyle:it,filterContainerMobileStyle:ot,bodyStyle:Ze,bodyMobileStyle:Je,chartStyle:Qe,dataSetContentBodyStyle:Ye,quickFindStyle:De,quickFindContainerStyle:Re,quickFindMobileStyle:Le,quickFindRNContainerStyle:Be,quickFindRNInputStyle:Ve,quickFindRNIconSearch:Ge,quickFindRNIconClear:We,quickFindRNCancelButton:ze,quickFindRNCancelButtonText:Xe,quickFindRNUserInputColor:qe,quickFindRNClearIconColor:Ue,quickFindRNPlaceholderColor:He,entityIconOuterStyle:mt,entityIconStyle:bt,entityImageOuterStyle:yt,entityImageInnerStyle:ft,entityImageContainerStyle:vt,titleStyle:$e,titleMobileStyle:et,reflowChartStyle:tt,reflowChartMobileStyle:nt,reflowGridStyle:rt,reflowdataSetContentBodyStyle:Ke,viewSelectorOuterStyle:dt,viewSelectorOuterMobileStyle:pt,filterComboStyle:st,filterLabelStyle:ct,footerPagingContainer:gt,activityMgmtLabelStyle:lt});break;case a.h.SUBGRID:var _t=Object(m.b)(o,0),Ct=_t?"#F8F8F8":Ee.colors.BaseColor.White;Ct=(null===(J=null===(Z=null==xe?void 0:xe.Grid)||void 0===Z?void 0:Z.ColumnHeader)||void 0===J?void 0:J.BackgroundColor)||Ct,Te=Object(r.__assign)(Object(r.__assign)({},y.headerStyle),{backgroundColor:Ct}),we=Object(r.__assign)(Object(r.__assign)({},y.headerInnerStyle),{borderBottom:Ee.borders.Border02}),Ae=Object(r.__assign)(Object(r.__assign)({},y.headerInnerMobileStyle),{borderBottom:Ee.borders.Border02,maxWidth:"100%",width:"100%"}),Fe=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerStyle),((I={flex:"1 1 100%",marginLeft:"0px",marginRight:"0px",flexDirection:"row-reverse",maxWidth:"35%"})["margin"+(Se?"Right":"Left")]="auto",I)),Ne=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerMobileStyle),((j={flex:"1 1 100%",maxWidth:"35%"})["margin"+(Se?"Right":"Left")]="auto",j)),ke=c(o,g,Ee),Me=c(o,g,Ee),at=Object(r.__assign)(Object(r.__assign)({},y.filterContainerStyle),{marginTop:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure150,marginBottom:Ee.sizes.Measures.Measure100,marginLeft:Ee.sizes.Measures.Measure150,paddingLeft:Ee.sizes.Measures.Measure100,height:Ee.sizes.Measures.Measure250}),ot=Object(r.__assign)(Object(r.__assign)({},y.filterContainerMobileStyle),{marginTop:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure150,marginBottom:Ee.sizes.Measures.Measure100,marginLeft:Ee.sizes.Measures.Measure150,width:"100%"}),st=Object(r.__assign)(Object(r.__assign)({},y.filterComboStyle),{border:Ee.borders.Border02,borderColor:Ee.colors.BaseColor.Grey.Grey3,lineHeight:Ee.sizes.Measures.Measure250}),De=Object(r.__assign)(Object(r.__assign)({},y.quickFindStyle),{height:Ee.sizes.Measures.Measure250,minHeight:Ee.sizes.Measures.Measure250,backgroundColor:(null===(te=null===(ee=null===($=null==xe?void 0:xe.Grid)||void 0===$?void 0:$.ColumnHeader)||void 0===ee?void 0:ee.QuickFind)||void 0===te?void 0:te.BackgroundColor)||Ee.colors.BaseColor.White,marginLeft:"0px",marginTop:"6px",marginBottom:"0px"}),Re=Object(r.__assign)(Object(r.__assign)({},y.quickFindStyle),{display:"flex",flexDirection:"row-reverse",flex:"1 1 auto"}),Le=Object(r.__assign)(Object(r.__assign)({},y.quickFindMobileStyle),{height:Ee.sizes.Measures.Measure250,minHeight:Ee.sizes.Measures.Measure250,marginTop:Ee.sizes.Measures.Measure150,marginBottom:Ee.sizes.Measures.Measure150,marginLeft:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure100,backgroundColor:(null===(re=null===(ne=null==xe?void 0:xe.Grid.ColumnHeader)||void 0===ne?void 0:ne.QuickFind)||void 0===re?void 0:re.BackgroundColor)||Ee.colors.BaseColor.White,width:"100%"}),$e=Object.assign($e,{fontSize:Ee.fontSizes.Font100,fontFamily:Ee.fontFamilies.Semibold,minWidth:"60%",maxWidth:"69%",textOverflow:"ellipsis",overflow:"hidden"}),_t&&($e=Object.assign($e,y.titleStyle,((P={})["padding"+(Se?"Right":"Left")]="10px",P.height="39px",P))),et=$e,ut=Object(r.__assign)(Object(r.__assign)({},y.progressIndicatorContainerStyle),{height:Pe<=Ee.sizes.Breakpoints.DimensionS?148..toString()+"px":200..toString()+"px",borderBottom:Ee.borders.Border02}),dt=Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterStyle),{minWidth:"50%"}),pt=Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterMobileStyle),{minWidth:"60%",maxWidth:"calc(100% - "+Ee.sizes.Measures.Measure400+")"}),i=Object(r.__assign)(Object(r.__assign)({},y),{headerStyle:Te,headerInnerStyle:we,headerInnerMobileStyle:Ae,commandManagerContainerStyle:Fe,commandManagerContainerMobileStyle:Ne,commandBarStyle:ke,commandBarMobileInnerStyle:Me,filterContainerStyle:at,filterContainerMobileStyle:ot,filterComboStyle:st,filterLabelStyle:ct,activityMgmtLabelStyle:lt,quickFindStyle:De,quickFindContainerStyle:Re,quickFindMobileStyle:Le,titleStyle:$e,titleMobileStyle:et,progressIndicatorContainerStyle:ut,viewSelectorOuterStyle:dt,viewSelectorOuterMobileStyle:pt});break;case a.h.ASSOCIATEDGRID:Te=Object(r.__assign)(Object(r.__assign)({},y.headerStyle),{marginBottom:"0px",backgroundColor:(null===(ie=null===(ae=null==xe?void 0:xe.Grid)||void 0===ae?void 0:ae.ColumnHeader)||void 0===ie?void 0:ie.BackgroundColor)||"transparent"}),we=Object(r.__assign)(Object(r.__assign)({},y.headerInnerStyle),{paddingLeft:Ee.sizes.Measures.Measure200,paddingRight:Ee.sizes.Measures.Measure200,paddingTop:"0px",paddingBottom:"0px",lineHeight:Ee.sizes.Measures.Measure300,backgroundColor:(null===(se=null===(oe=null==xe?void 0:xe.Grid)||void 0===oe?void 0:oe.ColumnHeader)||void 0===se?void 0:se.BackgroundColor)||Ee.colors.BaseColor.White}),Ae=Object(r.__assign)(Object(r.__assign)({},y.headerInnerMobileStyle),{marginLeft:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure100,marginTop:Ee.sizes.Measures.Measure125,marginBottom:Ee.sizes.Measures.Measure075,lineHeight:Ee.sizes.Measures.Measure300,width:"calc(100% - "+Ee.sizes.Measures.Measure200+")"}),Fe=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerStyle),{flex:"0 1 auto",paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,minHeight:Ee.sizes.Measures.Measure300,backgroundColor:Ee.colors.BaseColor.White}),Ne=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerMobileStyle),((x={maxWidth:"35%"})["margin"+(Se?"Right":"Left")]="auto",x)),ke=c(o,g,Ee),Me=c(o,g,Ee),at=Object(r.__assign)(Object(r.__assign)({},y.filterContainerStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",marginTop:"4px",marginBottom:"4px",marginRight:Se?"20px":"0px",marginLeft:Se?"0px":"20px"}),it=Object(r.__assign)(Object(r.__assign)({},y.activityTypefilterContainerStyle),{justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",marginTop:"4px",marginBottom:"4px",marginRight:Se?"20px":"0px",marginLeft:Se?"0px":"20px"}),ot=Object(r.__assign)(Object(r.__assign)({},y.filterContainerMobileStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:Ee.colors.BaseColor.Grey.Grey5,fontSize:Ee.fontSizes.Font100,minWidth:"15rem",height:Ee.sizes.Measures.Measure250,lineHeight:Ee.sizes.Measures.Measure250,marginTop:Ee.sizes.Measures.Measure025,marginLeft:Se?"0":Ee.sizes.Measures.Measure100,marginRight:Se?Ee.sizes.Measures.Measure100:"0",marginBottom:Ee.sizes.Measures.Measure050,width:"100%"}),st=Object(r.__assign)(Object(r.__assign)({},y.filterComboStyle),{border:Ee.borders.Border02,borderColor:Ee.colors.BaseColor.Grey.Grey3,lineHeight:Ee.sizes.Measures.Measure250}),De=Object(r.__assign)(Object(r.__assign)({},y.quickFindStyle),{height:Ee.sizes.Measures.Measure250,backgroundColor:(null===(ue=null===(le=null===(ce=null==xe?void 0:xe.Grid)||void 0===ce?void 0:ce.ColumnHeader)||void 0===le?void 0:le.QuickFind)||void 0===ue?void 0:ue.BackgroundColor)||Ee.colors.BaseColor.White,marginLeft:Ee.sizes.Measures.Measure200,marginTop:Ee.sizes.Measures.Measure025}),Re=Object(r.__assign)({},y.quickFindStyle),Le=Object(r.__assign)(Object(r.__assign)({},y.quickFindMobileStyle),{height:Ee.sizes.Measures.Measure250,marginTop:Ee.sizes.Measures.Measure025,marginLeft:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure100,marginBottom:Ee.sizes.Measures.Measure050,backgroundColor:(null===(ge=null===(pe=null===(de=null==xe?void 0:xe.Grid)||void 0===de?void 0:de.ColumnHeader)||void 0===pe?void 0:pe.QuickFind)||void 0===ge?void 0:ge.BackgroundColor)||Ee.colors.BaseColor.White,width:"100%"}),Ye=Object(r.__assign)(Object(r.__assign)({},y.dataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px"}),Ke=Object(r.__assign)(Object(r.__assign)({},y.reflowdataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}),Qe=Object(r.__assign)(Object(r.__assign)({},y.chartStyle),((E={boxSizing:ht})["border"+(Se?"Left":"Right")]=Ee.borders.Border02,E.paddingLeft=Ee.sizes.Measures.Measure200,E.paddingRight=Ee.sizes.Measures.Measure200,E.backgroundColor=Ee.colors.BaseColor.White,E)),tt=Object(r.__assign)(Object(r.__assign)({},y.reflowChartStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,paddingLeft:Ee.sizes.Measures.Measure200,paddingRight:Ee.sizes.Measures.Measure200,backgroundColor:Ee.colors.BaseColor.White}),nt=Object(r.__assign)(Object(r.__assign)({},y.reflowChartMobileStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,paddingLeft:Ee.sizes.Measures.Measure100,paddingRight:Ee.sizes.Measures.Measure100,backgroundColor:Ee.colors.BaseColor.White}),rt=Object(r.__assign)(Object(r.__assign)({},y.reflowGridStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,backgroundColor:Ee.colors.BaseColor.White}),Ze=Object(r.__assign)(Object(r.__assign)({},y.bodyStyle),{boxSizing:ht,borderTopWidth:"0px",borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(me=null===(he=null==xe?void 0:xe.Grid)||void 0===he?void 0:he.Cell)||void 0===me?void 0:me.BackgroundColor)||Ee.colors.BaseColor.White}),Je=Object(r.__assign)(Object(r.__assign)({},y.bodyMobileStyle),{boxSizing:ht,borderBottom:Ee.borders.Border02,borderTopWidth:"0px",borderTopColor:Ee.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(be=null===(fe=null==xe?void 0:xe.Grid)||void 0===fe?void 0:fe.Cell)||void 0===be?void 0:be.BackgroundColor)||Ee.colors.BaseColor.White}),dt=Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterStyle),{minWidth:"40%"}),pt=Object(r.__assign)(Object(r.__assign)({},y.viewSelectorOuterMobileStyle),{minWidth:"60%",maxWidth:"calc(100% - "+Ee.sizes.Measures.Measure400+")"}),$e=Object.assign($e,{fontSize:Ee.fontSizes.Font150,minWidth:"40%"}),et=Object.assign(et,{fontSize:Ee.fontSizes.Font125,minWidth:"60%"}),i=Object(r.__assign)(Object(r.__assign)({},y),{headerStyle:Te,headerInnerStyle:we,headerInnerMobileStyle:Ae,commandManagerContainerStyle:Fe,commandManagerContainerMobileStyle:Ne,commandBarStyle:ke,commandBarMobileInnerStyle:Me,quickFindStyle:De,quickFindContainerStyle:Re,quickFindMobileStyle:Le,chartStyle:Qe,dataSetContentBodyStyle:Ye,reflowdataSetContentBodyStyle:Ke,titleStyle:$e,titleMobileStyle:et,reflowChartStyle:tt,reflowChartMobileStyle:nt,reflowGridStyle:rt,bodyStyle:Ze,bodyMobileStyle:Je,viewSelectorOuterStyle:dt,viewSelectorOuterMobileStyle:pt,filterComboStyle:st,filterContainerStyle:at,activityTypeFilterContainerStyle:it,filterContainerMobileStyle:ot,filterLabelStyle:ct,footerPagingContainer:gt,activityMgmtLabelStyle:lt});break;default:Fe=Object(r.__assign)(Object(r.__assign)({},y.commandManagerContainerStyle),{flex:"0 1 auto",marginLeft:"0",marginRight:"0",minHeight:Ee.sizes.Measures.Measure300,backgroundColor:Ee.colors.BaseColor.White,maxWidth:"35%"}),ke=c(o,g,Ee),Me=c(o,g,Ee),i=Object(r.__assign)(Object(r.__assign)({},y),{commandManagerContainerStyle:Fe,commandBarStyle:ke,commandBarMobileInnerStyle:Me})}var St=Object(r.__assign)(Object(r.__assign)({},y.footerStyle),{backgroundColor:(null===(ye=null===(ve=null==xe?void 0:xe.Grid)||void 0===ve?void 0:ve.Footer)||void 0===ye?void 0:ye.BackgroundColor)||Ee.colors.BaseColor.White,height:Ee.sizes.Measures.Measure300,minHeight:Ee.sizes.Measures.Measure300}),Ot=Object(r.__assign)(Object(r.__assign)({},y.footerMobileStyle),{borderTop:Ee.borders.Border02,backgroundColor:(null===(Ce=null===(_e=null==xe?void 0:xe.Grid)||void 0===_e?void 0:_e.Footer)||void 0===Ce?void 0:Ce.BackgroundColor)||Ee.colors.BaseColor.White,height:Ee.sizes.Measures.Measure300,minHeight:Ee.sizes.Measures.Measure300}),It=Object(r.__assign)(Object(r.__assign)({},y.footerOuterStyle),{minHeight:Ee.sizes.Measures.Measure300,height:Ee.sizes.Measures.Measure300}),jt={marginTop:Ee.sizes.Measures.Measure300,marginRight:Ee.sizes.Measures.Measure200,marginLeft:Ee.sizes.Measures.Measure200},Pt={color:Ee.colors.BaseColor.Blue.Blue3,display:"flex",lineHeight:Ee.sizes.Measures.Measure100,whiteSpace:"nowrap"},xt=Object(r.__assign)(Object(r.__assign)({},y.seeMoreButtonContainerStyle),{marginLeft:Ee.sizes.Measures.Measure100,marginRight:Ee.sizes.Measures.Measure100}),Et={minHeight:Ee.sizes.Measures.Measure600,height:Ee.sizes.Measures.Measure600},Tt={minHeight:Ee.sizes.Measures.Measure300,height:Ee.sizes.Measures.Measure300},wt=Object(r.__assign)(Object(r.__assign)({},y.activityViewContainerStyle),{paddingRight:Se?0:Ee.sizes.Measures.Measure200,paddingLeft:Se?Ee.sizes.Measures.Measure200:0});i=Object(r.__assign)(Object(r.__assign)({},i),{footerStyle:St,footerMobileStyle:Ot,footerEditableGridStyle:It,gridErrorStyle:jt,seeMoreButtonTextStyle:Pt,seeMoreButtonContainerStyle:xt,defaultFooterHeightStyle:Et,jumpBarLessFooterHeightStyle:Tt,activityViewContainerStyle:wt,advancedFilterButtonStyles:v})}return i}}},"jw+s":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return h}));var r=n("tIxw"),a=n("2rJs"),i=n("QSLN"),o=n("Ro59"),s=n("rIXY"),c=n("RndP"),l=n("/0Sa"),u=n("CUpQ"),d="Role_Editor_Row_Name_Quick_Create",p="PageLoadingMessage",g="SharePoint.Form.Saving",h=["Button_Label_Close",d,p,g].concat(r.g,a.m,i.o,o.f,c.c,s.h,l.b,[u.g,u.f],[u.d])},kprl:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n("c/eZ"),a=n("nuS9"),i=n("ucY0"),o=n("pyUm"),s=n("dD0b"),c=n("hp1u");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){var t=e.icon,n=e.size,r=e.color,s=e.type,l=e.flipInRtl,u=e.fontWeight;return t?1===s?a.createElement(c.b,{source:t,style:{fill:r,height:n,width:n,transform:"scaleX("+(l&&i.a.isRTL?-1:1)+")"}}):a.createElement(o.a,{style:{fontFamily:"CRM MDL2",fontSize:n,color:r,transform:[{scaleX:l&&i.a.isRTL?-1:1}],fontWeight:u}},t):null}function u(e){var t=e.size,n=e.color,i=e.icon,o=e.type,c=Object(r.__rest)(e,["size","color","icon","type"]);return a.createElement(s.a,Object(r.__assign)({accessibilityRole:"button"},c),a.createElement(l,{icon:i,size:t,color:n,type:o}))}},ksD2:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var r=n("Sscr"),a=n("HSdq"),i=n("s0Zj"),o=n("ar+e"),s=n("B188"),c=n("4sax"),l=n("7pqb"),u=n("KzM6"),d="tab.visible";function p(e,t,n,p){return{type:"tab.visible.sync",sync:!0,execute:function(g,h){var m,f=g.dispatch,b=g.getState,v=b();f(function(e,t,n,a){var i=Object(r.v)(n);return{type:d,payload:a,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,n,p));var y=Object(a.wc)(v,{id:e},n),_=Object(o.e)(v,{id:e},n);if(y||(null==_?void 0:_.isSelected)||!p){if(y===t&&!p){var C=Object(a.fb)(v,{id:e},n),S=!1;if(C)for(var O=0,I=Object(a.m)(v,C);O<I.length;O++){var j=I[O];if(j.Id!==t&&Object(a.Kc)(v,j.Id,e,n)){S=!0,f(Object(i.b)(e,j.Id,n));break}}S||f(Object(i.b)(e,void 0,n))}}else f(Object(i.b)(e,t,n));if(Object(s.a)()){var P=b(),x=null===(m=null==h?void 0:h.TraceManager)||void 0===m?void 0:m.getTracer(""+l.k+l.r),E=Object(a.Kc)(v,t,e,n),T=Object(a.Kc)(P,t,e,n),w=Object(u.a)(P,e);w.push({name:"tabId",value:t}),w.push({name:"tabName",value:Object(a.Ic)(P,t,e,n)}),w.push({name:"tabLabel",value:Object(a.Hc)(P,t,e,n)}),w.push({name:"visible state before change",value:null==E?void 0:E.toString()}),w.push({name:"visible state after change",value:null==T?void 0:T.toString()}),w.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==x||x.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(w)}])}}}}},lFQy:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("9r0m"),a=n("5fD4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){var n,i={dataById:(n={},n[r.a.toString(t.id)]=e,n)};return{type:a.a,payload:i}}},ll2N:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,a=n("c/eZ"),i=n("1z64"),o=n("FlW1"),s=n("HSdq"),c=n("Zy0S"),l=n("+Z9T"),u=n("JCHT"),d=n("OmYs"),p=n("IiPO"),g=n("ezfI"),h=n("kvLG"),m=function(e){function t(t,n,a,o,s,c){var l=e.call(this,t,n,a,o)||this;return l._parent=s,r=t,l._formContext=c,l._iConnectedSectionProp={sectionName:l.name,id:l.pageId},l._clientApiExecutorTabSection=new i.a(t,"ClientApi.XrmTabSection.",a,n),l.clientApiExecutor.addEventParameter({name:"controlName",value:o,isEventParam:!0}),l}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorTabSection},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){var e=this;return this.clientApiExecutor.execute("controls",(function(t,n){if(!e._controls){var a=r.getState();e._controls=new c.a(t);var i=e.getControlsDescriptor(a);if(!i)return e._controls;for(var o in i){var s=e._formContext.ui.controls.get(o);if(s)e._controls.add(s.getName(),s);else{var l=n.slice();l.push({name:"controlKey",value:o}),h.a.getInstance().traceManager.getTracer(t).warn("Section control was not found in the form controls collection",l)}}}return e._controls}))},enumerable:!1,configurable:!0}),t.prototype.getParent=function(){return g.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent},t.prototype.getVisible=function(){var e="ClientApi.XrmTabSection.getVisible";try{g.a.instance.reportCall(e);var t=Object(s.tc)(r.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(l.a)(t)?this._getSectionDescriptorValues().Visible:t;return g.a.instance.reportSuccess(e),n}catch(t){var a=p.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype.getLabel=function(){var e="ClientApi.XrmTabSection.getLabel";try{g.a.instance.reportCall(e);var t=Object(s.rc)(r.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(l.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return g.a.instance.reportSuccess(e),n}catch(t){var a=p.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,a),t}},t.prototype._getSectionDescriptorValues=function(){try{return Object(s.qc)(r.getState(),this._iConnectedSectionProp,this.contextToken)}catch(t){var e=p.a.getInstance().getEventParameters(this.contextToken);throw e.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",t,null,e),t}},t.prototype.getControlsDescriptor=function(e){try{return Object(s.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){var t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}},t.prototype.setVisible=function(e){var t="ClientApi.XrmTabSection.setVisible";try{g.a.instance.reportCall(t),r.dispatch(Object(u.b)(this.pageId,this.contextToken,this.name,!0===e)),g.a.instance.reportSuccess(t)}catch(e){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.setLabel=function(e){var t="ClientApi.XrmTabSection.setLabel";Object(l.a)(e)&&Object(l.j)(t,"label");try{g.a.instance.reportCall(t),r.dispatch(Object(d.b)(this.pageId,this.contextToken,this.name,e)),g.a.instance.reportSuccess(t)}catch(e){var n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}},t}(o.a)},lwSE:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="header.tabnavigatorvisible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},m8A1:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n("HSdq"),a=n("sOTk"),i=n("gk6Q"),o=n("kvLG"),s=n("b1hT"),c=n("QAhb"),l=n("j+yI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,i){if(void 0===i&&(i=!1),!e)return o.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;var u=function(e,t){var n=Object(a.g)(e,t);if(!n)return null;var r=n.entityTypeName,i=n.id;return new c.a(r,i)}(e,t),d=!Object(r.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(i||!Object(l.d)(e,u,t)),p=h(t,e);return p.push({name:"xrmProcessControlClientApiIsSupported",value:d}),o.a.getInstance().eventManager.ReportComponentSuccess(n,p),d}function d(e,t,n,r){if(!e&&(o.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",h(n,t.getState())),u(t.getState(),n,r))){o.a.getInstance().traceManager.getTracer(r).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",h(n,t.getState()));var s=Object(a.g)(t.getState(),n);return Object(i.b)(n,s)}return e}function p(e,t,n,r){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:n},{name:"XrmEntityIsNotNull",value:r}]}function g(e,t,n){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)},{name:"getProcessManagerInvoked",value:n}]}function h(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(a.l)(t,e)}]}},mPpC:function(e,t,n){"use strict";n.d(t,"b",(function(){return Te})),n.d(t,"a",(function(){return Ee}));var r,a,i,o,s,c,l,u,d,p,g,h=n("+l2M"),m=n("sOTk"),f=n("c/eZ"),b=n("YCDx"),v=n("HSdq"),y=n("x6Ak"),_=n("IiPO"),C=n("ezfI"),S=function(e){function t(t,n,a,i,o,s){var c=e.call(this,t,n,a,i,o,s)||this;return r=t,c}return Object(f.__extends)(t,e),t.prototype.refresh=function(){var e="ClientApi.XrmControlTimer.refresh";try{C.a.instance.reportCall(e),r.dispatch(Object(y.b)(this.pageId,this.contextToken,this.name)),C.a.instance.reportSuccess(e)}catch(n){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getState=function(){var e="ClientApi.XrmControlTimer.getState";try{C.a.instance.reportCall(e);var t=Object(v.cb)(r.getState(),this.pageId,this.contextToken).controls[this.getName()].parameters.timerState;return C.a.instance.reportSuccess(e),t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"},t}(b.a),O=n("Zz0a"),I=n("w/nD"),j=n("+Z9T"),P=n("gk6Q"),x=function(e){function t(t,n,r,i,o,s){var c=e.call(this,t,n,r,i,o,s)||this;return a=t,c.registerObserversForControlStateChange(),c}return Object(f.__extends)(t,e),t.prototype.addOnClick=function(e){var t="ClientApi.XrmControlButton.addOnClick";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),a.dispatch(Object(I.b)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.removeOnClick=function(e){var t="ClientApi.XrmControlButton.removeOnClick";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),a.dispatch(Object(I.w)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"},t.prototype.registerObserversForControlStateChange=function(){if(this.getName().startsWith("header_process")){var e=Object(P.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}},t}(b.a),E=n("1z64"),T=n("hE7j"),w=n("EGsq"),A=n("WACO"),F=function(e){function t(t,n,r,a,o,s){var c=e.call(this,t,n,r,a,o,s)||this;i=t;var l=[{name:"controlName",value:o,isEventParam:!0}];return c._clientApiExecutorWebResource=new E.a(t,"ClientApi.XrmControlWebResource.",r,n,l),c}return Object(f.__extends)(t,e),t.prototype.getSrc=function(){var e=this;return this._clientApiExecutorWebResource.execute("getSrc",(function(){var t=i.getState(),n=Object(w.t)(t)+Object(v.wb)(t,{controlName:e.name,id:e.pageId},e.contextToken);return Object(A.c)(t,e.pageId,e.name,e.contextToken,n)}))},t.prototype.getContentWindow=function(){var e=this;return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(function(t,n){var r=e.formContext.applicationContext.TraceManager.getTracer(t),a=function(){var t=Object(v.xb)(i.getState(),e.pageId,e.getName());if(t){var a=null;try{return"complete"===(a=t.contentWindow).document.readyState?Promise.resolve(a):(n.push({name:"readyState",value:a.document.readyState}),r.info("Frame content window not ready",n),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(e){return a?(n.push({name:"Error",value:e.message}),r.warn("Error getting Frame content window readyState",n),Promise.resolve(a)):Promise.reject(e)}}else r.info("Frame DOM element not ready",n);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then((function(e){return Promise.resolve(e)})).catch((function(t){if(111!==t.errorCode)return Promise.reject(t);var o=e.contextToken,s=e.pageId,c=e.getName();return new Promise((function(e,t){var l=function(){Object(I.G)(o,s,l,c),a().then((function(t){e(t)})).catch((function(a){a.contentWindow?(r.err("Frame content window readyState should be complete after OnReadyStateComplete",n),e(a.contentWindow)):t&&(111===a.errorCode?(r.err("Frame Element not found after OnReadyStateComplete",n),t(new Error("Frame element could not be found."))):t(a))}))};i.dispatch(Object(I.l)(o,s,l,c))}))}))}))},t.prototype.getObject=function(){var e=this;return this._clientApiExecutorWebResource.execute("getObject",(function(){return Object(v.xb)(i.getState(),e.pageId,e.name)}))},t.prototype.setSrc=function(e){var t=this;return this._clientApiExecutorWebResource.execute("getControlType",(function(){Object(j.a)(e)||i.dispatch(Object(T.b)(t.pageId,t.name,t.contextToken,e))}))},t.prototype.getControlType=function(){return this._clientApiExecutorWebResource.execute("getControlType",(function(){return"webresource"}))},t.prototype.addOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",(function(){i.dispatch(Object(I.l)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t.prototype.removeOnReadyStateComplete=function(e){var t=this;return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",(function(){i.dispatch(Object(I.G)(t.contextToken,t.pageId,e,t.getName()))}),[{name:"handler",value:e,isRequired:!0}])},t}(b.a),N=function(e){function t(t,n,r,a,i,s){var c=e.call(this,t,n,r,a,i,s)||this;return o=t,c}return Object(f.__extends)(t,e),t.prototype.getInitialUrl=function(){var e="ClientApi.XrmControlIFrame.getInitialUrl";try{C.a.instance.reportCall(e);var t=Object(v.sb)(o.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return C.a.instance.reportSuccess(e),t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"},t.prototype.getSrc=function(){var e="ClientApi.XrmControlIFrame.getSrc";try{C.a.instance.reportCall(e);var t=o.getState(),n=this.getInitialUrl(),r=Object(A.c)(t,this.pageId,this.name,this.contextToken,n);return C.a.instance.reportSuccess(e),r}catch(t){var a=_.a.getInstance().getEventParameters(this.contextToken);throw a.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,a),t}},t}(F),k=n("+P1Q"),M=n("Q60c"),D=n("slAZ"),R=n("AVer"),L=n("QItn"),B=n("9r0m"),V=n("YdIa"),G=function(e){function t(t,n,r,a,i,o){var c=e.call(this,t,n,r,a,i,o)||this;return s=t,c._clientApiExecutorLookup=new E.a(t,"ClientApi.XrmControlLookup.",r,n,[{name:"controlName",value:i,isEventParam:!0}]),c}return Object(f.__extends)(t,e),t.prototype.addCustomView=function(e,t,n,r,a,i){var o=this;this._clientApiExecutorLookup.execute("addCustomView",(function(c,l){var u=B.a.tryParseOrNull(e);u||Object(j.k)(c,"guid","viewId",l),s.dispatch(Object(R.a)(o.pageId,o.name,u,t,o.contextToken,n,r,a)),i&&o.setDefaultView(e)}),[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:n,isRequired:!0},{name:"fetchXml",value:r,isRequired:!0},{name:"layoutXml",value:a,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])},t.prototype.addCustomFilter=function(e,t){var n="ClientApi.XrmControlLookup.addCustomFilter";Object(j.a)(e)&&Object(j.j)(n,"fetchXmlFilter"),Object(j.b)(e)||Object(j.l)(n);try{C.a.instance.reportCall(n),s.dispatch(Object(D.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),C.a.instance.reportSuccess(n)}catch(e){var r=_.a.getInstance().getEventParameters(this.contextToken);throw r.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(n,e,null,r),e}},Object.defineProperty(t.prototype,"disableMru",{get:function(){var e="ClientApi.XrmControlLookup.getDisableMru";try{C.a.instance.reportCall(e);var t=Object(v.x)(s.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return C.a.instance.reportSuccess(e),t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,n),t}},set:function(e){var t="ClientApi.XrmControlLookup.setDisableMru";try{C.a.instance.reportCall(t),s.dispatch(Object(L.b)(s.getState(),this.pageId,this.name,this.contextToken,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},enumerable:!1,configurable:!0}),t.prototype.startCustomFilter=function(){var e="ClientApi.XrmControlLookup.startCustomFilter";try{C.a.instance.reportCall(e),s.dispatch(Object(D.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),C.a.instance.reportSuccess(e)}catch(n){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.endCustomFilter=function(){var e="ClientApi.XrmControlLookup.endCustomFilter";try{C.a.instance.reportCall(e),s.dispatch(Object(D.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),C.a.instance.reportSuccess(e)}catch(n){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,n,null,t),n}},t.prototype.getDefaultView=function(){var e=this;return this._clientApiExecutorLookup.execute("getDefaultView",(function(){var t=Object(v.O)(s.getState(),e.pageId,e.name,e.contextToken);return t?B.a.externalGuid(new B.a(t)):null}))},t.prototype.setDefaultView=function(e){var t=this;this._clientApiExecutorLookup.execute("setDefaultView",(function(n,r){var a=B.a.tryParseOrNull(e);a||Object(j.k)(n,"guid","id",r),s.dispatch(Object(M.b)(t.pageId,t.name,t.contextToken,a))}),[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])},t.prototype.addOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),s.dispatch(Object(I.g)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.addPreSearch=function(e){var t="ClientApi.XrmControlLookup.addPreSearch";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),s.dispatch(Object(I.t)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.removeOnLookupTagClick=function(e){var t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),s.dispatch(Object(I.B)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.removePreSearch=function(e){var t="ClientApi.XrmControlLookup.removePreSearch";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),s.dispatch(Object(I.O)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"},t.prototype.getEntityTypes=function(){var e="ClientApi.XrmControlLookup.getEntityTypes";try{C.a.instance.reportCall(e);var t=Object(v.Ob)(s.getState(),this.pageId,this.contextToken,this._dataFieldName);return C.a.instance.reportSuccess(e),t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.setEntityTypes=function(e){var t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(j.j)(t,"entityTypes");var n=[];try{C.a.instance.reportCall(t),e=Array.from(new Set(e));var r=Object(v.Pb)(s.getState(),this.pageId,this.contextToken,this._dataFieldName),a={};r.forEach((function(e){a[e]=!0})),e.forEach((function(e){a[e]||n.push(e)}))}catch(e){throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t+".validation",e,null,i),e}n.length>0&&Object(j.h)(t,"entityType",n[0]);try{s.dispatch(Object(V.b)(this.pageId,this.contextToken,this._dataFieldName,e)),C.a.instance.reportSuccess(t)}catch(e){var i;throw(i=_.a.getInstance().getEventParameters(this.contextToken)).push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(t,e,null,i),e}},Object.defineProperty(t.prototype,"_dataFieldName",{get:function(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name},enumerable:!1,configurable:!0}),t}(k.a),W=n("JFej"),z=n("Ini7"),X=n("FGem"),q=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;c=t;var l=[{name:"controlName",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];return s._clientApiExecutorOptionsetBase=new E.a(t,"ClientApi.XrmControlOptionSetBase.",r,n,l),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){var n=this;this._clientApiExecutorOptionsetBase.execute("addOption",(function(){var r=n._options.length;Object(j.a)(t)||isNaN(t)||t>=r?t=r:t<=0?t=0:t-=1,c.dispatch(Object(W.b)(n.pageId,n.contextToken,n.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))}),[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])},t.prototype.clearOptions=function(){var e=this;this._clientApiExecutorOptionsetBase.execute("clearOptions",(function(){c.dispatch(Object(X.b)(e.pageId,e.contextToken,e.controlDescriptor.DataFieldName))}))},t.prototype.removeOption=function(e){var t=this;return this._clientApiExecutorOptionsetBase.execute("removeOption",(function(){c.dispatch(Object(z.b)(t.pageId,t.contextToken,t.controlDescriptor.DataFieldName,e))}),[{name:"value",value:e,isRequired:!0}])},t.prototype.getOptions=function(){var e=this;return this._clientApiExecutorOptionsetBase.execute("getOptions",(function(){return e._options}))},Object.defineProperty(t.prototype,"_options",{get:function(){var e=new Array,t=Object(v.B)(c.getState(),this.pageId,this.contextToken,this.name);if(t)for(var n in t.length&&e.push({text:"",value:NaN}),t)e.push({text:t[n].Label,value:t[n].Value});return e},enumerable:!1,configurable:!0}),t}(k.a),U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"},t}(q),H=n("ABRM"),Y=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._isDateFormatDateTime=!1,l=t,s._clientApiExecutorDateTime=new E.a(t,"ClientApi.XrmControlDateTime.",r,n,[{name:"controlName",value:i,isEventParam:!0}]),s._clientApiExecutorDateTime.execute("constructor",(function(e,t){s._isDateFormatDateTime=s._getShowTime(e,t)}),null,!1),s}return Object(f.__extends)(t,e),t.prototype.getShowTime=function(){var e=this;return this._clientApiExecutorDateTime.execute("getShowTime",(function(t,n){return e._getShowTime(t,n)}))},t.prototype.setShowTime=function(e){var t=this;this._clientApiExecutorDateTime.execute("setShowTime",(function(n,r){if(t._getShowTime(n,r)!==e){var a=e&&t._isDateFormatDateTime?"datetime":"date";l.dispatch(Object(H.b)(t.pageId,t.contextToken,t.name,a))}}))},t.prototype._getShowTime=function(e,t){var n=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!n||"datetime"===n.Format},t}(k.a),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"},t}(q),Q=n("455M"),Z=n("Dlr/"),J=n("Sscr"),$=n("7bez"),ee=n("h82J"),te=n("Gemh"),ne=function(e){function t(t,n,r,a,i){var o=e.call(this,t,n,r,a,a.Name,i)||this,s=Object(J.e)(n,a.Name);return t.dispatch(Object(ee.a)(o,r,s)),u=t,o._clientApiExecutorControlstream=new E.a(t,"ClientApi.XrmControlStream.",r,n),o}return Object(f.__extends)(t,e),Object.defineProperty(t.prototype,"clientApiExecutor",{get:function(){return this._clientApiExecutorControlstream},enumerable:!1,configurable:!0}),t.prototype._getGridControls=function(){if(!this._underlyingGridControls){this._underlyingGridControls=[];var e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){var t=e.StreamObjectCollection;if(t)for(var n=t.ShowAsTiles?[!0,!1]:[!0],r=0,a=t;r<a.length;r++)for(var i=a[r],o=0,s=n;o<s.length;o++){var c=s[o],l=Object(J.o)(this.contextToken,this.getName(),i.Id,c),d=new $.a(u,l,this.pageId,!1,3,!0,this.formContext.applicationContext,l.controlName);this._underlyingGridControls.push({contextToken:l,gridControl:d})}}}return this._underlyingGridControls},t.prototype.refresh=function(){var e=this;this.clientApiExecutor.execute("refresh",(function(){for(var t=[],n=0,r=e._getGridControls();n<r.length;n++){var a=r[n],i=a.contextToken,o=a.gridControl;if(Object(te.hb)(u.getState(),e.pageId,i,i.controlName))try{o.refresh()}catch(e){t.push(e)}}if(t.length>0){var s=Object(f.__spreadArrays)(_.a.getInstance().getEventParameters(e.contextToken),[{name:"count",value:t.length}]);Object(j.e)(e.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,s)}}))},t}(b.a),re=n("QAhb"),ae=n("TV33"),ie=n("Y+r4"),oe=n("ks02"),se=n("uQP8"),ce=n("6JRL"),le=n("kvLG"),ue=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,a.Name,i)||this;return d=t,s._clientApiExecutor=new E.a(t,"ClientApi.XrmControlSubFormBase.",r,n,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),s._xrmControlFactory=o,s}return Object(f.__extends)(t,e),t.prototype.getParentComponent=function(){return Object(se.a)(d.getState(),this.pageId)},Object.defineProperty(t.prototype,"context",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",(function(){return e._form?e._form.context:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentFormContext",{get:function(){return this.formContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_form",{get:function(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(ce.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);var e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;var t=this._getValueInternal(),n=Object(ae.d)(t);return e?(this._formInstance=d.dispatch(Object(ee.b)(this._subFormInstanceId,e)),this._formInstance||n&&n.length>0&&(this._formInstance=d.dispatch(this._createXrmForm(e,this._subFormInstanceId,n[0].entityType,new B.a(n[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance):(_.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),le.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null)},enumerable:!1,configurable:!0}),t.prototype._createXrmForm=function(e,t,n,r){var a=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute:function(i,o){var s=new ie.a(i,{etn:n,id:r},a,e,t);s.applicationContext=o;var c=new oe.a(i,t);return s.context=c,s}}},Object.defineProperty(t.prototype,"_subFormControlContextToken",{get:function(){var e=this._getValueInternal(),t=Object(ae.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(d.dispatch(Object(ee.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",(function(){return e._form?e._form.data:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",(function(){return e._form?e._form.ui:null}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entityReference",{get:function(){return C.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null},enumerable:!1,configurable:!0}),t.prototype.getControl=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",(function(){return t._form?t._form.getControl(e):null}))},t.prototype.getAttribute=function(e){var t=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",(function(){return t._form?t._form.getAttribute(e):null}))},t.prototype.getUrl=function(){var e=this;return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",(function(){return e._form?e._form.getUrl():null}))},t.prototype.refresh=function(){var e=this;this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",(function(){e.data&&e.data.refresh()}))},t.prototype._getValueInternal=function(){var e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),n=t?new re.a(e,new B.a(t)):new re.a(e),r=Object(v.ac)(d.getState(),this._subFormInstanceId,this.contextToken);return Object(v.X)(d.getState(),this._subFormInstanceId,this._subFormContextToken,r,n,this.controlDescriptor.DataFieldName)},t}(b.a),de=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return p=t,s}return Object(f.__extends)(t,e),t.prototype._getSubFormContextToken=function(e,t,n){return Object(J.l)(this.contextToken,this.name,this._entityType)},t.prototype.getSubFormInstanceId=function(){return this.pageId},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._tryGetSubFormInstanceId=function(){},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this.pageId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e="ClientApi.XrmControlQuickForm.isLoaded";try{C.a.instance.reportCall(e);var t=Object(v.ic)(p.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return C.a.instance.reportSuccess(e),!!t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),_.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"},t}(ue),pe=function(e){function t(t,n,r,a,i,o){var s;return t||Object(j.j)("ClientApi.XrmStandardDataControl.constructor","store"),s=e.call(this,t,n,r,a,i,o)||this,g=t,s}return Object(f.__extends)(t,e),t.prototype.getValue=function(){var e="ClientApi.XrmStandardDataControl.getValue";try{C.a.instance.reportCall(e);var t=Object(v.F)(g.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return C.a.instance.reportSuccess(e),t}catch(t){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,t,null,n),t}},t.prototype.addOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),g.dispatch(Object(I.e)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.removeOnKeyPress=function(e){var t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(j.j)(t,"handler");try{C.a.instance.reportCall(t),g.dispatch(Object(I.z)(this.contextToken,this.pageId,this.name,e)),C.a.instance.reportSuccess(t)}catch(e){var n=_.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(t,e,null,n),e}},t.prototype.fireOnKeyPress=function(){var e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{C.a.instance.reportCall(e),g.dispatch(Object(I.R)(this.contextToken,this.pageId,this.name,this)),C.a.instance.reportSuccess(e)}catch(n){var t=_.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),_.a.getInstance().reportFailure(e,n,null,t),n}},t}(k.a),ge=n("1PXy"),he=n("lRv2"),me=n("QUnS"),fe=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlDependentOptionSet.",r,n,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"DependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"DependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"DependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"DependentOptionSet.setVisible",t)}))},t}(U),be=function(e){function t(t,n,r,a,i,o){var s=e.call(this,t,n,r,a,i,o)||this;return s._clientApiExecutorDependentOptionSet=new E.a(t,"ClientApi.XrmControlMultiSelectDependentOptionSet.",r,n,[{name:"controlName",value:i,isEventParam:!0}]),s}return Object(f.__extends)(t,e),t.prototype.addOption=function(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.addOption",t)}))},t.prototype.clearOptions=function(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)}))},t.prototype.removeOption=function(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.removeOption",t)}))},t.prototype.setDisabled=function(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)}))},t.prototype.setVisible=function(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(function(e,t){Object(j.i)(e,"MultiSelectDependentOptionSet.setVisible",t)}))},t}(K),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.setDisabled=function(e){var t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";C.a.instance.reportUsage(t),Object(j.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))},t}(pe),ye=n("F2uj"),_e=n("cZkS"),Ce=n("qC0c"),Se=n("2OIc"),Oe=n("tNVD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var Ie,je,Pe=function(e){function t(t,n,r,a,i,o){var s,c,l=e.call(this,t,n,r,a,i,o)||this;return l._formInstanceId=null===(c=null===(s=l.getParentComponent())||void 0===s?void 0:s.formInstances)||void 0===c?void 0:c.formInstanceIdByControlName[l.controlDescriptor.Name],l._formComponentClientApiExecutor=new E.a(t,"ClientApi.XrmControlFormComponent.",l._formInstanceId),l._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),Ie=t,l}return Object(f.__extends)(t,e),t.prototype._tryGetSubFormInstanceId=function(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])},t.prototype._isSubFormMetadataLoaded=function(){return!!this._subFormInstanceId},t.prototype._getSubFormContextToken=function(e,t,n){return Object(J.h)(n)},Object.defineProperty(t.prototype,"_subFormInstanceId",{get:function(){return this._formInstanceId},enumerable:!1,configurable:!0}),t.prototype.isLoaded=function(){var e=this;return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",(function(){return!!Object(v.yc)(Ie.getState(),e._subFormInstanceId,e._subFormControlContextToken)}))},t.prototype.setInitializationIntent=function(e){var t=this;void 0===e&&(e="fullload"),this._formComponentClientApiExecutor.execute("setInitializationIntent",(function(n){
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,a,i,o,s;"nothing"!==e&&"fullload"!==e&&Object(j.h)(n,e,"intent"),Ie.dispatch((r=t.pageId,a=t.name,i=t.contextToken,o=e,s=Object(J.v)(i),{type:Oe.d,payload:o,meta:{pageId:r,controlName:a,contextKey:s}}))}),[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])},t.prototype.getControlType=function(){return C.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"},t}(ue),xe=n("HHlV"),Ee="3d180de6-b456-4d90-9d5a-9899936baf44",Te=function(){function e(e,t){this._pageId=t,je=e}return e.prototype.createXrmControl=function(e,t,n,r,a){Object(j.g)(t,r,"control");try{a.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),a.push({name:"controlName",value:t?t.Name:""}),a.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),a.push({name:"pageId",value:this._pageId});var i=Object(m.l)(je.getState(),this._pageId);a.push({name:"pageType",value:i});var o=!1,s=null,c=this._getControlType(t,n,e,r,a);switch(c){case h.i.guid:s=new x(je,e,this._pageId,t,t.Name,n);break;case Q.a.KbContent:case Q.a.KbArticle:case h.C.guid:case h.I.guid:s=new N(je,e,this._pageId,t,t.Name,n);break;case Q.a.LookupRegarding:case Q.a.LookupCustomer:case Q.a.LookupMultiEntity:case Q.a.LookupOwner:case Q.a.LookupSimple:case Q.a.LookupPartyList:case h.M.guid:case h.fb.guid:case h.S.guid:case h.l.guid:if(Object(Ce.c)(je.getState(),_e.jb)){var l=Object(se.b)(je.getState(),this._pageId,e);if(Object(Se.c)(je.getState(),t.UniqueId,l)===xe.d){s=new Pe(je,e,this._pageId,t,n,this);break}}s=new G(je,e,this._pageId,t,t.Name,n);break;case Q.a.OptionSet:case h.U.guid:if(1==Object(Ce.c)(je.getState(),_e.L)){var u=this._getEntityNameForControl(t,n);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new fe(je,e,this._pageId,t,t.Name,n);break}}case Q.a.EntityNameOptionSet:case Q.a.TwoOptions:case Q.a.StatusOptionSet:case h.sb.guid:case h.K.guid:case h.W.guid:case h.V.guid:case h.hb.guid:case h.n.guid:case h.N.guid:s=new U(je,e,this._pageId,t,t.Name,n);break;case Q.a.MultiSelectPicklist:case h.Q.guid:if(Object(Ce.c)(je.getState(),_e.L)){u=this._getEntityNameForControl(t,n);if(Object(ye.l)(je.getState(),u,t.DataFieldName)){s=new be(je,e,this._pageId,t,t.Name,n);break}}s=new K(je,e,this._pageId,t,t.Name,n);break;case Q.a.QuickForm:case h.cb.guid:case h.ab.guid:case h.Z.guid:var d=new de(je,e,this._pageId,t,n,this);n.ui.quickForms.add(t.Name,d);break;case Q.a.SearchWidget:case Q.a.ReferencePanelSearchWidget:case h.db.guid:case h.kb.guid:s=new O.a(je,e,this._pageId,t,t.Name,n);break;case Q.a.TimelineWall:case h.qb.guid:(s=je.dispatch(Object(ee.f)(this._pageId,Object(J.p)(e,t.Name))))||(s=new ge.a(je,e,this._pageId,t,t.Name,t.LabelId,n,n.applicationContext));break;case Q.a.DateAndTimeDateOnly:case Q.a.DateAndTimeDateAndTime:case h.q.guid:s=new Y(je,e,this._pageId,t,t.Name,n);break;case Q.a.Grid:case h.eb.guid:case h.E.guid:var p=Object(J.p)(e,t.Name),g=je.dispatch(Object(ee.c)(this._pageId,p));g&&(g.getName||3!==g.getGridType()?s=g:(_.a.getInstance().reportFailure(r,new Error("Main grid found in cache - converting to a subgrid."),null,a),je.dispatch(Object(ee.h)(this._pageId,p)))),s||(s=new Z.a(je,e,this._pageId,t.Name,Object(te.wb)(je.getState(),this._pageId,e,t.Name),n,t,n.applicationContext));break;case Q.a.Timer:case h.rb.guid:s=new S(je,e,this._pageId,t,t.Name,n);break;case Q.a.WebResourceHtmlControl:case h.ub.guid:case h.vb.guid:s=new F(je,e,this._pageId,t,t.Name,n);break;case h.mb.guid:s=new ne(je,e,this._pageId,t,n);break;case h.z.guid:case h.G.guid:break;case Ee:if(Object(Ce.c)(je.getState(),_e.L)&&Object(ye.l)(je.getState(),e.entityTypeName,t.Name)){s=new ve(je,e,this._pageId,t,t.Name,n);break}case Q.a.AppliedFilters:case Q.a.BusinessProcessFlow:case Q.a.Card:case Q.a.Currency:case Q.a.Dashboard:case Q.a.Decimal:case Q.a.EmailEngagementActions:case Q.a.EmailEngagementRecipientActivity:case Q.a.FP:case Q.a.GlobalFilter:case Q.a.MicrosoftFlow:case Q.a.Multiple:case Q.a.PowerBI:case Q.a.ReferencePanel:case Q.a.Search:case Q.a.SingleLineAddress:case Q.a.SingleLineEmail:case Q.a.SingleLinePhone:case Q.a.SingleLineText:case Q.a.SingleLineTextArea:case Q.a.SingleLineTickerSymbol:case Q.a.SingleLineURL:case Q.a.SocialInsightsControl:case Q.a.WholeDuration:case Q.a.WholeLanguage:case Q.a.WholeNone:case Q.a.WholeTimeZone:case h.a.guid:case h.b.guid:case h.c.guid:case h.d.guid:case h.e.guid:case h.f.guid:case h.g.guid:case h.h.guid:case h.j.guid:case h.k.guid:case h.m.guid:case h.p.guid:case h.r.guid:case h.s.guid:case h.t.guid:case h.u.guid:case h.v.guid:case h.w.guid:case h.x.guid:case h.y.guid:case h.A.guid:case h.B.guid:case h.D.guid:case h.H.guid:case h.J.guid:case h.L.guid:case h.O.guid:case h.P.guid:case h.R.guid:case h.T.guid:case h.X.guid:case h.Y.guid:case h.bb.guid:case h.gb.guid:case h.ib.guid:case h.jb.guid:case h.lb.guid:case h.mb.guid:case h.nb.guid:case h.ob.guid:case h.pb.guid:case h.tb.guid:case h.wb.guid:o=!0;default:s=t.DataFieldName?new pe(je,e,this._pageId,t,t.Name,n):new b.a(je,e,this._pageId,t,t.Name,n),o||(a.push({name:"controlType",value:c}),le.a.getInstance().traceManager.getTracer(r).error("Unknown Form Control",a))}return s}catch(e){return _.a.getInstance().reportFailure(r+".createXrmControl",e,null,a),null}},e.prototype._getControlType=function(e,t,n,r,a){if(B.a.equals(e.ClassId,h.o)){var i=this._getCustomControlType(e,t,n);return i||le.a.getInstance().traceManager.getTracer(r+".controlPrimaryType").error("Control primary type could not be determined",a),a.push({name:"manifestControlType",value:i}),i}return e.ClassId.guid},e.prototype._getCustomControlType=function(e,t,n){var r,a,i,o=Object(se.b)(je.getState(),this._pageId,n),s=Object(he.c)(je.getState(),e,o);if(!s){var c=Object(v.h)(),l=(null===(a=null===(r=t.data)||void 0===r?void 0:r.entity)||void 0===a?void 0:a.getEntityName())||"",u=c(je.getState(),e,this._pageId,o,l);if(u||(u=Object(me.a)(je.getState(),e,this._pageId,n)),null==u?void 0:u.Parameters)for(var d in u.Parameters)if(null===(i=u.Parameters[d])||void 0===i?void 0:i.Primary){s=u.Parameters[d].Type;break}}return s},e.prototype._getEntityNameForControl=function(e,t){var n="";if(e.Relationship)n=Object(v.T)(je.getState(),this._pageId,e.Relationship);else{var r=t.getAttribute(e.DataFieldName);r&&r.getParent()&&(n=r.getParent().getEntityName())}return n},e}()},mVnn:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("HSdq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function a(e,t){var n=Object(r.Zb)(e,t);return n&&n.output?n.output.value:null}},"n+eO":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n("r0tX"),a=n("9r0m"),i=n("WS0f"),o=n("9rlF"),s=n("nbQV"),c=n("TCcM"),l=n("T576"),u=n("QAhb"),d=n("A/RO"),p=n("Kdvm"),g=n("4HtA"),h=n("r3Bs"),m=n("LdMy"),f=n("sOTk"),b=n("mLFd"),v=n("G7N+"),y=n("ed60"),_=n("uwKl"),C=n("DUDQ"),S=n("lFQy"),O=n("gk6Q"),I=n("HSdq"),j=n("pflg"),P=n("b1hT"),x=n("lMVv"),E=n("2ojE"),T=n("LhJP"),w=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return e._instance||(e._instance=new e,Object(O.c)(e._instance)),e._instance},enumerable:!1,configurable:!0}),e.prototype.init=function(e,t,r){var a=this;return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=r,this._processManager=new g.a(e,t,r,new m.a,new h.a),this._businessProcessFlowWrapperIdentifierFactory=new p.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),n.e(49).then(n.bind(null,"pG8E")).then((function(e){var t=e.BusinessProcessPageWrapper;return a._businessProcessPerPageWrapper=new t(a._applicationContext,a._getState,a._dispatch),Promise.resolve()})))},e.prototype.getBusinessProcessFlowWrapper=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))},e.prototype.getProcessManager=function(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)},e.prototype.getCurrentProcessManagerWithoutInit=function(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);var t=Object(f.g)(this._getState(),e),n=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,r=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),a=Object(E.a)(this._getState(),n,e,this._applicationContext);return r.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",a),null},e.prototype.hasChanged=function(e,t,n,r){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,r)))return!0;if(!t)return!1;var a=new u.a(t.entityTypeName,t.id),o=Object(l.f)(e,a);return!Object(i.a)(o)&&(!n||o>n.instanceModifiedTimestamp)||this._needsDockedModeRefresh(n,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,n,r)},e.prototype._needsDockedModeRefresh=function(e,t){return this._processManager.getDisplayState()===r.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)},e.prototype._reloadData=function(e,t){var n=this,r=this._getState();this._pageId=e,this._pageInfo=t;var d=Object(f.g)(r,e);if(d){var p=d.id,g=new u.a(d.entityTypeName,p);if(this._processIdInState=Object(c.e)(r,g),Object(P.g)(r)&&(!Object(P.d)(r)||Object(P.c)(r,e))){var h=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(g,e),void Object(E.c)(T.e,h,this._applicationContext)}var m=Object(j.a)(d),b=Object(j.b)(d);if(a.a.equals(g.id,a.a.EMPTY)&&m&&b){var O=Object(s.b)(r,m),I=new u.a(O.businessProcessFlowUniqueName,b),w=Object(l.b)(r,I);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(g)||this._lastPageEntityFromCrossEntity.etn===g.etn||this._moveToNextStageForCrossEntityBPF(w,d),void this._processManager.initilaizeWithProcessAndFormEntity(w,O,g,m,I,e)}if(this._processIdInState){O=Object(s.b)(r,this._processIdInState);if(!Object(i.a)(O)&&Object(v.b)(O.initialized)){I=new u.a(O.businessProcessFlowUniqueName,Object(c.f)(r,g)),w=Object(l.b)(r,I);if(a.a.equals(g.id,a.a.EMPTY)){var A=Object(P.b)(O);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(S.a)(null,I))),A&&A.stage&&A.stage.stageId){var F=Object(P.a)(A);return this._dispatch(Object(C.b)(I,F)),void this._processManager.initilaizeWithProcessAndFormEntity(F.fields,O,g,this._processIdInState,I,e)}}else if(Object(i.a)(w))return;var N=Object(x.h)(r,g.etn);if(N&&N.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(w,O,g,this._processIdInState,I,e);for(var k in w)if(Object(o.k)(w[k])&&w[k].reference&&w[k].reference.id&&w[k].reference.etn===g.etn&&(a.a.equals(w[k].reference.id,g.id)||a.a.equals(w[k].reference.id,a.a.EMPTY))&&Object(P.e)(k))return void this._processManager.initilaizeWithProcessAndFormEntity(w,O,g,this._processIdInState,I,e);var M=this._dispatch(Object(y.b)(a.a.EMPTY,g)),D=this._dispatch(Object(_.b)(a.a.EMPTY,g));Promise.all([M,D]).then((function(t){n._processManager.initilaizeWithFormEntityOnly(g,e)}))}else this._processManager.initilaizeWithFormEntityOnly(g,e)}else this._processManager.initilaizeWithFormEntityOnly(g,e)}},e.prototype._reloadDataIfRequired=function(e,t){var n=this._getState(),r=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=r;var i=null,o=!1;if(r&&(i=Object(c.b)(r)(n,r.etn))&&(o=i.refreshGlobalNavigationData),!Object(P.g)(n)&&(!this._pageInfo||!a.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(P.g)(n)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(b.b)(!1,r)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){var s=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),l=this._processManager.getTelemetryParams();s.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",l)}this._reloadDataCount++}else this._reloadDataCount=0},e.prototype._hasProcessChanged=function(e){var t=this._processIdInState||a.a.EMPTY,n=this._getState(),r=new u.a(e.entityTypeName,e.id),i=Object(f.g)(n,this._pageId),o=Object(j.a)(i),l=a.a.equals(r.id,a.a.EMPTY)&&o?o:Object(c.e)(n,r)||a.a.EMPTY;if(!a.a.equals(l,t))return!0;if(a.a.equals(l,a.a.EMPTY))return!1;var d=Object(s.b)(n,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion},e.prototype._moveToNextStageForCrossEntityBPF=function(e,t){var n=e.activestageid,r=e.traversedpath,i=t.data.nextStageId;if(!i){var o=Object(j.a)(t),s=Object(j.b)(t);if(!a.a.equals(o,this._processManager.getProcessId())||!a.a.equals(s,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}a.a.equals(n.reference.id,new a.a(i))||(n.reference=new u.a("processstage",new a.a(i)),r.value=r.value+","+i,e.activestagestartedon.value=new Date)},e}()},nn4v:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},nzwm:function(e,t,n){"use strict";n.r(t),n.d(t,"OfflineStatusDialogForm",(function(){return c}));var r=n("/8AH"),a=n("NWJ/"),i=n("rQCE");function o(e){return{type:"initialize.offlineStatusDialog.async",execute:function(t){return(0,t.dispatch)(Object(a.b)(e,i.a.FullLoad)),Promise.resolve()}}}var s=n("GtH6"),c=function(){function e(e){this._id=e,this._initializeAction=o}return e.prototype.getName=function(){return r.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return this._initializeAction(this.getId())},e.prototype.getRootReducer=function(){return function(e,t){}},e.prototype.getRootComponent=function(){return s.OfflineStatusDialog},e.prototype.getCloseAction=function(e){},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},"o0+l":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="attribute.submitmode";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n,i){var o=Object(r.x)(t);return{type:a,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},p5Y6:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("HSdq"),a=n("aGOT"),i=n("Sscr");function o(e){return{type:"form.cancel.async",execute:function(t){var n=t.dispatch,o=t.getState,s=Object(i.j)(o(),e),c=Object(r.ac)(o(),e,s);return n(Object(a.c)(e,c,s)),Promise.resolve()}}}},pMJD:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.Expanded="",e.UpArrowHead="",e.LeftArrowHead="",e.Collapsed="",e.Edit="",e.Save="",e.Delete="",e.Remove="",e.Add="",e.Cancel="",e.HandClick="",e.Accept="",e.More="",e.Forward="",e.Favorite="",e.Placeholder="",e.RatingFull="",e.RatingEmpty="",e.Options="",e.Manage="",e.Settings="",e.Find="",e.Help="",e.ViewNotifications="",e.StageAdvance="",e.CheckMark="",e.Locked="",e.Lock="",e.MoreOptions="",e.ContactInfo="",e.Pin="",e.Unpin="",e.Refresh="",e.Details="",e.VisualFilter="",e.GlobalFilter="",e.Diamond="",e.ApplyFilter="",e.CancelFilter="",e.StreamView="",e.TileView="",e.Import="",e.Tools="",e.Attach="",e.Filter="",e.Copy="",e.HighPriority="",e.ReduceTile="",e.ExpandTile="",e.GlobalFilterExpand="",e.GlobalFilterCollapse="▷",e.Clear="",e.Post="",e.OneNote="",e.Home="",e.SetAsHome="",e.BackButton="",e.BackButtonWithoutBorder="",e.UpArrow="",e.DownArrow="",e.SetActiveButton="",e.SearchButton="",e.ForwardButton="",e.Mail="",e.CheckedMail="",e.FailedMail="",e.Phone="",e.Chat="",e.OpenPane="",e.ClosePane="",e.AddFriend="",e.Arrow="",e.DropdownArrow="",e.FlsLocked="",e.LinkArticle="",e.UnlinkArticle="",e.CopyLink="",e.EmailLink="",e.Share="",e.Assign="",e.Connect="",e.Opportunity="",e.Appointment="",e.Task="",e.Case="",e.PhoneCallIncoming="",e.PhoneCallOutgoing="",e.EmailIncoming="",e.EmailOutgoing="",e.SendEmail="",e.ApplyTemplate="",e.InsertKbArticle="",e.SendSelected="",e.SaveAndClose="",e.ReplyEmail="",e.ReplyAllEmail="",e.ForwardEmail="",e.Close="",e.Activate="",e.DeActivate="",e.DeleteBulk="",e.SocialActivityIncoming="",e.SocialActivityOutgoing="",e.CustomActivity="",e.SystemPost="",e.Convert="",e.MarkAsWon="",e.MarkAsLost="",e.SetRegarding="",e.SaveAsComplete="",e.SwitchProcess="",e.Recalculate="",e.SendDirectEmail="",e.OpenMailbox="",e.ReOpenOpportunity="",e.ReactivateLead="",e.Disqualify="",e.Qualify="",e.SelectView="",e.SelectChart="",e.OpenInBrowser="",e.NewAppointment="",e.NewRecurringAppointment="",e.NewPhoneCall="",e.NewTask="",e.NewEmail="",e.AddExisting="",e.SaveAndEdit="",e.Default="",e.ScrollRight="»",e.ScrollLeft="«",e.SaveAndRunRoutingRule="",e.RunRoutingRule="",e.ResolveCase="",e.CancelCase="",e.ReactivateCase="",e.AddToQueue="",e.CreateChildCase="",e.QueueItemRoute="",e.QueueItemRelease="",e.QueueItemRemove="",e.QueueItemPick="",e.Drilldown="",e.PopOverButton="",e.ExitButton="",e.ExportToExcel="",e.WordTemplates="",e.DocumentTemplates="",e.OpenInPowerBI="",e.OpenPowerBIReport="",e.OpenDelve="",e.ArticleLink="",e.ArchiveArticle="",e.ApproveArticle="",e.DiscardArticle="",e.Minor="",e.Major="",e.PublishKnowledgeArticle="",e.RelateArticle="",e.RelateProduct="",e.RestoreArticle="",e.RevertToDraftArticle="",e.Translate="",e.UpdateArticle="",e.RemoveFilter="",e.Article="",e.Graph="",e.CSR="",e.MembersIcon="",e.QueueIcon="",e.SiteMap="",e.NormalPriority="",e.LowPriority="",e.ViewIcon="",e.RecentCases="",e.KBRecords="",e.NumberOfViews="",e.ResizeHandle="",e.TaskBasedFlow="",e.InformationIcon="",e.PencilIcon="",e.ErrorIcon="",e.SuccessIcon="",e.OptionsetIcon="",e.NotificationIcon="",e.PanelHeaderImportDataIcon="",e.SidePanelUpload="",e.New="",e.DetailsPageClose="",e.SettingsListIcon="",e.ListIcon="",e.ForwardDisable="",e.PdfIconFile="",e.PresentationFile="",e.OneNoteFile="",e.AccessFile="",e.VisioFile="",e.ProjectFile="",e.Plus="",e.ChevronDown="",e.ChevronUp="",e.HappySmiley="",e.SadSmiley="",e.CaseResolution="",e.CampaignResolution="",e.ServiceActivity="",e.Notes="",e.Audio="",e.Camera="",e.Video="",e.Image="",e.Html="",e.SharePointEditDocument="",e.SharePointDeleteDocument="",e.SharePointCheckoutDocument="",e.SharePointCheckinDocument="",e.SharePointEditDocumentProperties="",e.SharePointDiscardCheckoutDocument="",e.SharePointNewDocument="",e.SharePointNewWordDocument="",e.SharePointNewExcelDocument="",e.SharePointNewPowerPointDocument="",e.SharePointNewOneNoteDocument="",e.SharePointUploadDocument="",e.SharePointChangeLocation="",e.SharePointAddDocumentLocation="",e.SharePointEditLocation="",e.SharePointOpenLocation="",e.SharePointOpenDocument="",e.SendByEmail="",e.CreateQuote="",e.Reply="",e.Warning="",e.Play="",e.ExpandButton="",e.AssociatedArticle="",e.DisassociatedArticle="",e.GlobalFilterClearAll="",e.GlobalFilterExpandedRow="",e.GlobalFilterCollapsedRow="",e.RelationshipAssistant="",e.AutomaticSuggestions="",e.SemanticZoom="",e.SemanticZoomMirrored="",e.BackwardButton="",e.MultiSelect="",e.MultiSelectMirrored="",e.Spinning="",e.RetireProduct="",e.AddProduct="",e.OfflineStatus="",e.Abandon="",e.Reactivate="",e.FinishStage="",e.SortButton="",e.Flows="",e.OpenEntityRecord="",e.View="",e.CreateView="",e.EditView="",e.GuestUser="",e.History="",e.SelectButton="",e.SelectButtonRTL="",e.ReassignRecords="",e.ManageRoles="",e.JoinTeams="",e.ChangeManager="",e.AddMembers="",e.RemoveMembers="",e.Download="",e.SetAsDefaultView="",e.Pinned="",e.DistributionList="",e.MergeRecords="",e.AssociateChildCase="",e.SetAsDefault="",e.ConvertKnowledgeArticle="",e.Messenger="",e.AssociateCategory="",e.OfficeWaffle="",e.TripleColumn="",e.Tiles="",e.HideVisualFilter="",e.InteractiveDashboard="",e.Dynamics365="",e.SalesLiterature="",e.LockPricing="",e.CreateInvoice="",e.FulfillOrder="",e.CancelInvoice="",e.ActivateQuote="",e.InvoicePaid="",e.GetProducts="",e.UnlockPricing="",e.Checkbox="",e.CheckboxComposite="",e.RightChevron="",e.LeftChevron="",e.BackToStart="",e.UntrackedEmail="",e.OpenEmail="",e.GlobalFilterCollapsedRowRTL="",e.CancelOrder="",e.URL="",e.Ticker="",e.UseCurrentPricing="",e.Process="",e.FirstPageButton="",e.LinkedInLogo="",e.Health="",e.Family="",e.Sports="",e.Entertainment="",e.OOF="",e.CarouselView="",e.HeartEmpty="",e.HeartFilled="",e.Follow="",e.RunQuery="",e.GroupAnd="",e.GroupOr="",e.Ungroup="",e.HideInSimpleMode="",e.ShowInSimpleMode="",e.PinnedSolid="",e.FilterSolid="",e.Bot="",e.SystemDocumentTemplates="",e.MyDocumentTemplates="",e.ViewAllMyDocumentTemplates="",e.EnableSecurityRoles="",e.DocumentTemplateUpload="",e.DocumentTemplateEdit="",e.DocumentTemplateActivate="",e.DocumentTemplateDeactivate="",e.YammerIcon="",e.StopIcon="",e.ReplaceContentIcon="",e.CloseDateComingSoon="",e.NearbyCustomers="",e.RelevantNews="",e.UpcomingMeeting="",e.RecentMeeting="",e.ReminderWithCall="",e.CardsTask="",e.CardsQuote="",e.CardsOpportunity="",e.CardsInvoice="",e.CardsDashboard="",e.CardsLeads="",e.OpportunityNoActivity="",e.CaseNoActivity="",e.CompetitorMentioned="",e.MeetingRequest="",e.MissedCloseDate="",e.IssueDetection="",e.NoActivityWithAccount="",e.YesNo="",e.AgendaActivityServiceAppointment="",e.AgendaActivityFax="",e.UpcomingFlight="",e.OpportunityAtRiskSentiment="",e.IconDue="",e.AddProductFamily="",e.AddProductBundle="",e.ProductPublish="",e.CloneProduct="",e.CloseGoal="",e.AlignWithFiscalPeriod="",e.ProductUpsell="",e.SubscriptionAdd="",e.RefreshDevice="",e.ScatterChart="",e.BarChartHorizontal="",e.BarChartVertical="",e.FunnelChart="",e.PieDouble="",e.AdvFind="",e.AALinkedInLogo="",e.SendAndClose="",e.DoubleChevronLeft="",e.DoubleChevronRight="",e.AreaChart="",e.DonutChart="",e.TagChart="",e.Teaser="",e.Clone="",e.AreaChartMirrored="",e.BarChartHorizontalMirrored="",e.BarChartVerticalMirrored="",e.Recent="",e.SharePointIcon="",e.OneDriveIcon="",e.FolderSharedIcon="",e.MSTeamsIcon="",e.ScrollUpDown="",e.SendToCTI="",e.Letter="",e.Fax="",e.NewLetter="",e.NewFax="",e.LetterIncoming="",e.LetterOutoing="",e.FaxIncoming="",e.FaxOutgoing="",e.CreatePersonalView="",e.ViewHierarchy="",e.ProductPreview="",e.AddTerritoryMember="",e.RemoveTerritoryMember="",e.Report="",e.NewServiceActivity="",e.Recurrence="",e.EditSeries="",e.EndSeries="",e.EditDefaultFilter="",e.QueueItemDetail="",e.ThumbsUp="",e.ThumbsDown="",e.Lead="",e.TableLink="",e.TableGroup="",e.ClearDefault="",e.SetDefault="",e.SaveFilterToNewPersonalView="",e.SaveFilterToCurrentPersonalView="",e.Expand="",e.ChromeMinimize="",e.ChromeMaximize="",e.ConnectionRoleManageRecordType="",e.Sync="",e.ThumbsUpSolid="",e.ThumbsDownSolid="",e.msdyn_enhancedsla="",e.msdyn_enhancedslakpi="",e.msdyn_enhancedslakipiinstance="",e.CreateOrder="",e.Revise="",e.CloseQuote="",e.CommandChecker="",e.Puzzle="",e.NetworkOffline="",e.MoreVertical="",e.ThunderBolt="",e.Monitor="",e.Error=""}(r||(r={}))},pWhJ:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e,t){return void 0===t&&(t=10),e.recentItems&&e.recentItems.recentItems.sort((function(e,t){return t.LastAccessed-e.LastAccessed})).slice(0,t)}},pkDq:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("ygXU"),a="offline.upsync.completed";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(){var e={upSyncStatus:r.a.Completed};return{type:a,payload:e}}},r0tX:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;n.d(t,"a",(function(){return r})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(r||(r={}))},r3Bs:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r=function(){function e(e,t){this._traversedPath=e,this._stageId=t}return Object.defineProperty(e.prototype,"traversedPath",{get:function(){return this._traversedPath},set:function(e){this._traversedPath=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stageId",{get:function(){return this._stageId},set:function(e){this._stageId=e},enumerable:!1,configurable:!0}),e}(),a=n("3INI"),i=n("9r0m"),o=function(){function e(){}return Object.defineProperty(e.prototype,"globalPathAndActiveStage",{get:function(){return this._globalPathAndActiveStage},set:function(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntities",{get:function(){return this._navigationEntities},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"navigationEntityIdsByEntityLogicalName",{get:function(){return this._navigationEntityIdsByEntityLogicalName},enumerable:!1,configurable:!0}),e.prototype.InitGlobalPathAndActiveStage=function(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)},e.prototype.UpdateGlobalPathAndActiveStage=function(e,t){this.globalPathAndActiveStage=new r(new a.a(e),t)},e.prototype._updateNavigationDictionary=function(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(var t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}},e}()},rbxJ:function(e,t,n){"use strict";n.d(t,"i",(function(){return pe})),n.d(t,"g",(function(){return re})),n.d(t,"e",(function(){return ae})),n.d(t,"d",(function(){return ie})),n.d(t,"f",(function(){return he})),n.d(t,"h",(function(){return me})),n.d(t,"c",(function(){return se})),n.d(t,"a",(function(){return de})),n.d(t,"b",(function(){return ue}));var r=n("c/eZ"),a=n("9r0m"),i=n("swEE"),o=n("NxDw"),s=n("G7N+"),c=n("S2mk"),l=n("UOiB"),u=n("Fas2"),d=n("r2h9"),p=n("lMVv"),g=n("7EJx"),h=n("EGsq"),m=n("Ww2r"),f=n("RlP9"),b=n("z9yS"),v=n("uO/V"),y=n("Gemh"),_=n("Sscr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function C(){var e=null,t=null,n=null;return function(r,a){var i=a.parentContextToken,o=a.contextString,s=function(e,t){var n=t.parentContextToken;switch(t.contextString){case v.h.ASSOCIATEDGRID:var r=Object(y.gb)(e,t,n);return _.a(n,r.relationshipName,r.ordinal);case v.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return _.o(n,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);var a=_.p(n,t.descriptor.Name),i=a&&a.parentContextToken?a.parentContextToken.entityTypeName:null;return a.relationshipType=se(e,t,i,a),a;case v.h.GRID:return _.k(e,t.id);case v.h.CUSTOM:return _.c(n,t.controlId);default:return n}}(r,a);return(n!==o||S(e,s)||S(t,i))&&(e=s,t=i,n=o),e}}function S(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var O=n("jf1O"),I=n("perk"),j=n("/3Li"),P=n("0u+G"),x=n("wV3W"),E=n("DgF7"),T=n("Wg6j"),w=n("WS0f"),A=n("VWqI"),F=n("Ev4I"),N=n("JlqV"),k=n("cZkS"),M=n("qC0c"),D=n("c0jI"),R=n("jigW"),L=n("sOTk"),B=n("7pqb"),V=n("s2by"),G=n("VnpK"),W=n("CIm2"),z=n("+6eZ"),X=n("3/zo"),q=n("oVzJ"),U=n("2OIc"),H=n("/V8d"),Y=n("M6d0"),K=n("Oiu5"),Q=n("/U1C"),Z=n("W51q"),J=n("c56u"),$=n("F2uj"),ee=n("HF9s"),te=n("c96h"),ne=n("TCzx");function re(e){return e===v.h.SUBGRID}function ae(e){return e===v.h.GRID}function ie(e){return e===v.h.ASSOCIATEDGRID}function oe(e){switch(e){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return"div";case v.h.GRID:default:return"section"}}function se(e,t,n,r){var a=n?Object(p.G)(e,n,r.relationshipName):null;if(null===a&&t.descriptor&&t.descriptor.Parameters){var i=t.descriptor.Parameters[v.F.RELATIONSHIP_NAME],o=t.descriptor.Parameters[v.F.TARGET_ENTITY_TYPE];i&&n?a=Object(p.G)(e,n,i):i&&o&&(a=Object(p.G)(e,o,i))}return a}function ce(){var e=null,t=null;return function(n){return e!==n.contextString&&(e=n.contextString,t=function(e){switch(e.contextString){case v.h.ASSOCIATEDGRID:case v.h.SUBGRID:return[d.a.SUB_GRID,d.a.MAIN_APPLICATION_VIEW];case v.h.GRID:return e.isAdvancedFindView?[d.a.ADVANCED_SEARCH]:[d.a.MAIN_APPLICATION_VIEW];default:return[d.a.MAIN_APPLICATION_VIEW]}}(n)),t}}function le(e){return e&&[e.CustomControlId,e.Name].some((function(e){return-1!==H.a.indexOf(e)}))}function ue(e,t,n){if(!e||!e.contextTokenType||e.contextTokenType!==l.a.AssociatedGrid&&e.contextTokenType!==l.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return le(n);case"displayQuickFind":case"displayViewSelector":return!0}return null}function de(){var e=null,t=null;return function(n,r,a){if(e&&t===r.CustomControlId)return e;var i=r&&r.CustomControlId?r.CustomControlId:null;if(!i)return null;var o=Object(y.ab)(n,i),s=Object(U.e)(n,i);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){var c=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:c.hasOwnProperty("displayChart")?c.displayChart:ue(a,"displayChart",r),displayCommandBar:c.hasOwnProperty("displayCommandBar")?c.displayCommandBar:ue(a,"displayCommandBar",r),displayIndex:c.hasOwnProperty("displayIndex")?c.displayIndex:ue(a,"displayIndex",r),displayQuickFind:c.hasOwnProperty("displayQuickFind")?c.displayQuickFind:ue(a,"displayQuickFind",r),displayViewSelector:c.hasOwnProperty("displayViewSelector")?c.displayViewSelector:ue(a,"displayViewSelector",r)},t=r.CustomControlId}return e}}function pe(){var e,t,n,l,_,S,G,U,H,ue,de,pe,he,ve,ye,_e,Ce,Se,Oe,Ie,je,Pe,xe,Ee,Te,we,Ae,Fe,Ne,ke,Me,De,Re,Le,Be,Ve,Ge=null,We=null,ze=null,Xe=null,qe="",Ue=null,He=null,Ye=null,Ke=null,Qe=null,Ze=null,Je=null,$e=null,et=(t=null,function(e,n,r,a){var i=t;switch(Object(w.b)(a)&&(a=n.contextString),a){case v.h.ASSOCIATEDGRID:i=Object(u.b)(r);break;case v.h.SUBGRID:i=Object(u.l)(r);break;case v.h.GRID:default:i=Object(u.h)(r)}return i!==t&&(t=i),t}),tt=Object(O.a)(),nt=C(),rt=(n=null,_=null,l=function(e,t,n){var r,i,s,l,u;if(Object(y.ib)(e,t.id,n)){r=Object(y.T)(e,t.id,n);var d=Object(y.qb)(e,r,t.id);i=d&&d.entityLogicalName,u=d&&d.isUserView,s=Object(y.r)(e,t.id,n,i),l=Object(y.s)(e,t.id,n)!==b.a.savedvisualization}else{var p=Object(y.ab)(e,t.configuration.CustomControlId);if(p){var g=t.configuration.Parameters[p];g&&(r=g.ViewId&&new a.a(g.ViewId),i=g.TargetEntityType,s=g.VisualizationId&&new a.a(g.VisualizationId),l=!(!g.IsUserChart||"true"!==g.IsUserChart),u=!(!g.IsUserView||"true"!==g.IsUserView))}}if(!a.a.isNullOrEmpty(r)&&s&&i){var h=Object(y.q)(e,t.id,n),m=Object(y.p)(e,t.id,n),f=Object(y.C)(e,t.id,n),C=ge(e,t,n,f,!0),S=Object(y.N)(e,t.id,n),O=e.user&&e.user.userId,I=Object(M.c)(e,k.Zc),j=Object(V.a)(i,O,n,I),P=j&&j.getFilterAndLinkedEntities(f&&f.activityOrQueueFilterValue?f.activityOrQueueFilterValue:void 0),x=P&&null!==P.linkEntities?JSON.stringify(P.linkEntities):null,T=Object(M.a)(e,k.Od,k.h),w=!T||T&&Object(E.a)(e)===o.a.MobileApplication,A=T,F=ie(t.contextString)?Object(c.p)(v.d,i,a.a.toString(r),a.a.toString(s),n.relationshipName,S,l,u,C,x,A):Object(c.t)(v.d,i,a.a.toString(r),a.a.toString(s),S,h,l,m,u,C,x,w,A);if(_){var N=F&&F.CustomControlId?F.CustomControlId:null;if((L=Object(y.ab)(e,N))&&F.Parameters[L]){var D=F.Parameters[L],R=_.Parameters[L];D.ViewId===R.ViewId&&D.VisualizationId===R.VisualizationId&&D.EntityName===R.EntityName&&D.HighchartFilterExpression===R.HighchartFilterExpression&&D.ChartDrillDownParameters===R.ChartDrillDownParameters&&D.ExtraFilters===R.ExtraFilters||(_=F)}}else _=F}else if(_&&i&&!s){var L;N=_.CustomControlId,(L=Object(y.ab)(e,N))&&_.Parameters[L]&&i!==(R=_.Parameters[L]).EntityName&&(_=null)}return _},function(e,t,r){var a=l(e,t,r),i=t.id;return n&&n.configuration===a&&n.id===i||(n={configuration:a,id:i,chartId:v.d,showChart:!0,contextToken:r}),n}),at=(S=null,function(e,t,n,r,a,i){var o=i.commandBarStyle,s=t.id,c=se(e,t,n&&n.parentContextToken?n.parentContextToken.entityTypeName:null,n),l=Object(y.w)(e,s,n);return S&&S.commandManagerId===l&&S.pageId===s&&S.ribbonId===a&&S.relationshipType===c&&S.contextToken===n&&S.style===o||(S={commandManagerId:l,pageId:s,ribbonId:a,relationshipType:c,contextToken:n,style:o}),S}),it=(G=null,U=ce(),function(e,t,n,r,i,o){var s,c=o.viewSelectorStyle,l=a.a.toString(i),u=U(t),p=Object(y.nb)(t.id,l),h=ae(t.contextString),m=h,b=t.contextString,v=Object(y.Z)(e),_=Object(g.g)(e),C=Object(y.qb)(e,i,t.id),S=C?C.title:null,O=d.a.MAIN_APPLICATION_VIEW;re(b)?O=d.a.SUB_GRID:h&&t.isAdvancedFindView&&(O=d.a.ADVANCED_SEARCH);var I=Object(f.a)(e,r,O),j=I||a.a.EMPTY,P=Object(L.g)(e,null==t?void 0:t.id),x=Object(y.rb)(e,null===(s=null==P?void 0:P.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==i?void 0:i.guid);return G&&G.id===p&&G.entityTypeName===r&&G.selectedViewId===l&&G.queryViewSelectorTypes===u&&G.shouldDisplayNestedViewSelector===m&&G.isRTL===_&&G.defaultViewId===j&&G.isEdited===!!x||(G={id:p,pageId:t.id,title:S,entityTypeName:r,selectedViewId:l,style:c,queryViewSelectorTypes:u,shouldDisplayNestedViewSelector:m,contextString:b,pinnedActivityView:v,isRTL:_,defaultViewId:j,isAdvancedFindView:t.isQueryMode&&t.isAdvancedFindView,isEdited:!!x,pageToEditedViewMapId:null==P?void 0:P.pageToEditedViewMapId}),G}),ot=(H=null,function(e,t,n,r,a){var i=t.id,o=Object(y.G)(e,t),s=Object(g.w)(e),c=a.filterComboStyle,l=Object(L.g)(e,i).entityFilterValue;return H&&H.id===i&&H.entityTypeName===r&&H.filterOptions===o&&H.comboBoxStyle===c&&H.userSetting===s&&l===H.previousValue||(H={id:i,filterOptions:o,entityTypeName:r,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:s,style:null,comboBoxStyle:c,previousValue:l}),H}),st=(ue=null,function(e,t,n,a,i){var o=t.id,s=Object(y.G)(e,t,a),c=Object(K.a)(e),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,d=i.activityTypeComboBoxStyles,p=Object(R.h)(e,n.relationshipName,ie(t.contextString)),h=!Object(N.b)(e),m=Object(y.kb)(e,o,n),f=Object(g.g)(e),b=Object(x.a)(e),v=Object(L.g)(e,o),_=v.entityFilterValue,C=v.activityTypeFilterValue,S=Object(M.a)(e,k.a,k.h),O=Object(M.a)(e,k.a,k.Lc),j=Object(y.ub)(e,a),P=Object(M.c)(e,k.Zc),E=Object(V.a)(a,e.user.userId,n,P,j),T=E&&E.getFilterLabelResourceKey(),w=I.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,A=I.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!ue||ue.id!==o||ue.entityTypeName!==a||ue.filterOptions!==s||ue.comboBoxStyle!==l||ue.dueDatecomboBoxStyle!==u||ue.activityTypecomboBoxStyle!==d||ue.labelStyle!==i.filterLabelStyle||ue.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||ue.isActivityManagementFeatureEnabled!==S||ue.filterOptionsForActivityType!==c||ue.isRollupViewSupported!==p||ue.isOffline!==h||ue.toggleValue!==m||ue.isRTL!==f||ue.theme!==b||ue.previousValue!==_||ue.activityTypePreviousValues!==C||ue.isActivityFilterSelectAllEnabled!==O||ue.entityIsActivityType!==j){var F={isRollupViewSupported:p,isOffline:h,toggleValue:m,onToggleChange:null,isRTL:f,theme:b};ue=Object(r.__assign)({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:a,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:C,isActivityManagementFeatureEnabled:S,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:T,activityTypeFilterLabelResourceString:w,dueDateFilterLabelResourceString:A,isActivityFilterSelectAllEnabled:O,isRTL:f,entityIsActivityType:j},F)}return ue}),ct=(de=null,pe=[1041,2052,3076,1028,1042],function(e,t,n,r,a,i){var o=e.id,s=e.descriptor&&e.descriptor.Id?e.descriptor.Id:null,c=a?JSON.parse(a).conditions[0]:null,l=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){var n=me(e.split(",")[0]),r=n[1].split("|");if(r&&t===r[0])return n[1]}return t}(Object(m.c)(i,I.JUMPBAR_ALPHABET),c);return pe.indexOf(r)>-1?de=null:de&&de.id===o&&de.contextToken===t&&de.entityTypeName===n&&de.selectedFilter===l||(de={id:o,uniqueId:s,contextToken:t,entityTypeName:n,selectedFilter:l,languageId:r}),de}),lt=(he=null,function(e,t,n,r){var a=e.id,i=e.contextString;return he&&he.id===a&&he.contextToken===t&&he.entityTypeName===n&&he.gridInput===r||(he={id:a,contextToken:t,entityTypeName:n,contextString:i,gridInput:r}),he}),ut=(ve=null,function(e,t,n){var r=e.id,a=e.contextString;return ve&&ve.id===r&&ve.contextToken===t||(ve={id:r,contextToken:t,contextString:a}),ve}),dt=Object(m.h)(),pt=(Ce=null,Se=null,je=null,ke={useSkypeProtocol:Oe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},gridPageNumber:Ie={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},isNewPageRequested:Pe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},enhancedPagingDisabled:xe={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},isActivityTypeFilterDisabled:Ee={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},showAddNewCommand:Te={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptySubgridIconAndTextChanges:we={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},emptyGridChangesIfQuickFindImprovementsEnabled:Ae={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},headerDialogOnTop:Fe={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},headerDialogPreventDismissOnScroll:Ne={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1}},function(e,t,n){var a=Object(E.e)(e),s=Object(h.x)(e).useSkypeProtocol,c=Object(y.x)(e,t.id,n),l=Object(y.X)(e,t.id,n);l||je===c||(je=c),ye||(ye=Object(j.a)(e),_e=null!=ye&&ye===P.b.Native);var u=!_e,d=Object(M.a)(e,k.a,k.h),p=t.systemDefinedProperties,g=c!==je&&l,m=u!==xe.Value,f=!1;d&&(ie(t.contextString)||ae(t.contextString))&&(f=!0);var b=!1;Object(q.a)(e)&&re(t.contextString)&&(b=!0);var v=!1;Object(q.a)(e)&&Object(M.c)(e,k.Md)&&re(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication&&(v=!0);var _=!1;if(Object(q.a)(e)&&Object(M.c)(e,k.ad)&&ae(t.contextString)&&Object(E.a)(e)===o.a.MobileApplication){var C=Object(y.C)(e,t.id,n);(null==C?void 0:C.quickFind)&&(_=!0)}var S=!ae(t.contextString)&&i.a.Tablet===a,O=i.a.Tablet===a&&!ie(t.contextString)||"Web"===Object(E.k)(e)&&!ne.a.getInstance().get_IsAndroid()&&!ne.a.getInstance().get_IsWindows()&&!ne.a.getInstance().get_isIPhone();if(a!==Ce||s!==Se||g||m||l!==Pe.Value||f!==Ee.Value||b!==Te.Value||v!==we.Value||_!==Ae.Value||S!==Fe.Value||O!==Ne.Value){Ce=a,Se=s,Ie.Value=c,je=c,Pe.Value=l,xe.Value=u,Ee.Value=f,Te.Value=b,we.Value=v,Ae.Value=_,Fe.Value=S,Ne.Value=O;var I=null==Ce?s:null;(I!==Oe.Value||g||m)&&(Oe.Value=I,ke=Object(r.__assign)(Object(r.__assign)({},p),{useSkypeProtocol:Oe,gridPageNumber:Ie,isNewPageRequested:Pe,enhancedPagingDisabled:xe,isActivityTypeFilterDisabled:Ee,showAddNewCommand:Te,emptySubgridIconAndTextChanges:we,emptyGridChangesIfQuickFindImprovementsEnabled:Ae,headerDialogOnTop:Fe,headerDialogPreventDismissOnScroll:Ne}))}return ke}),gt=(Me=null,De=null,function(e,t,n){return e&&(De&&Me===e&&!n||(De=Object(r.__assign)({},e),e.Parameters&&(De.Parameters=Object(r.__assign)({},e.Parameters),t&&e.Parameters[t]&&(De.Parameters[t]=Object(r.__assign)({},e.Parameters[t]),e.Parameters[t].Columns&&(De.Parameters[t].Columns=e.Parameters[t].Columns.slice(0)))),Me=e)),De}),ht=Object(T.s)(),mt=(Re=[],function(e,t,n,r,a,i,o,s,c,l,u){return Re&&Re.length&&Re.splice(0,Re.length),Re.push({name:B.b.IsGridRoot,value:e},{name:B.b.IsSubGrid,value:t},{name:B.b.IsAssociatedGrid,value:n},{name:B.b.EntityName,value:r},{name:B.b.ViewId,value:a},{name:B.b.IsEmptyFetch,value:i},{name:B.b.IsEmptyOfflineSqlQuery,value:o},{name:B.b.IsValidFetchXmlForOfflineUsage,value:s},{name:B.b.IsEntityAvailableForOfflineUsage,value:c},{name:B.b.OfflineConfigurationErrorCode,value:l},{name:B.b.RelatedEntityUnavailableOffline,value:u}),Re}),ft=(Le=null,function(e){return Le||(Le={isGridPaginationStateFeatureEnabled:Object(M.a)(e,k.zb),isAssociatedGridHeightEnabled:Object(R.e)(e),isChartOnAssociatedGridEnabled:Object(M.a)(e,k.x,k.h,k.i),isGridProgressIndicatorFeatureEnabled:Object(M.a)(e,k.Ab),isInMobileModeForOct2019:Object(q.b)(e),isJumpBarShouldHonorSortingFeatureEnabled:Object(M.a)(e,k.ac),isJumpbarFeatureForMobileEnabled:Object(M.c)(e,k.Kb),isSuiterChartEnabled:Object(M.a)(e,k.Od,k.h),isSuiterDashboardEnabled:Object(M.a)(e,k.Pd,k.h),isAdvancedFindEnabled:Object(Z.a)(e),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(M.c)(e,k.O),isInMobileModeForApril2020:Object(q.a)(e),isSubgridImprovementsEnabled:Object(M.c)(e,k.Md),isSubGridAutoCollapseEnabled:Object(M.a)(e,k.Jd,k.Lc),isSubGridRemoveMinHeightEnabled:Object(M.a)(e,k.Ld,k.Lc),isQuickFindImprovementsEnabled:Object(M.c)(e,k.ad),isShowAsButtonFirstEnabled:Object(M.c)(e,k.Bd),isColumnEditorButtonEnabled:Object(y.tb)(e),isQueueFilterPerfUCIEnabled:Object(M.c)(e,k.Zc)}),Le}),bt=(Be={fetchXML:null,entityName:null,isOffline:null},Ve={error:!1,errorCode:null,relatedEntityUnavailableOffline:null},function(e,t,n,r){if(Be.entityName!==n||Be.fetchXML!==t||Be.isOffline!==r)if(Object(F.k)(n)){var a=Object(F.b)(e,t);Ve={error:a.error,errorCode:a.error?I.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:a.relatedEntityUnavailableOffline},Be={fetchXML:t,entityName:n,isOffline:r}}else Ve={error:!0,errorCode:I.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},Be={fetchXML:t,entityName:n,isOffline:r};return Ve});return function(t,n){var i,o=Object(g.w)(t),c=nt(t,n),l=Object(y.v)(t,n.id,c),u=c.relationshipName,b=c.roleOrd,_=Object(y.N)(t,n.id,c),C=Object(y.I)(t,n.id,c),S=Object(y.x)(t,n.id,c),O=n.descriptor,T=be.bind(null,n,O),B=n.configuration,G=B&&B.CustomControlId?B.CustomControlId:null,q=Object(j.a)(t),U=Object(E.e)(t),H=Object(y.ab)(t,G)||(n.contextString===v.h.CUSTOM?v.g:null),K=ae(n.contextString),Z=ft(t),ne=Object(y.A)(t,c,n),se=null,ce=!1,ue=null,de=Object(y.t)(t,n.id,c),pe=Object(y.C)(t,n.id,c);K&&(se=Object(L.g)(t,n.id),Z.isGridPaginationStateFeatureEnabled&&((ue=se.gridSortingInfo)&&(Object(w.a)(Ke)||Ke!==ue)&&(Ke=ue,ce=!0),de&&(Object(w.a)(Qe)||Qe!==de.customFilterXml)&&(Qe=de.customFilterXml,ce=!0)),(pe&&Object(w.a)(Ze)||Ze!==pe)&&(Ze=pe,ce=!0));var he=gt(B,H,ce),me=he&&he.Parameters?he.Parameters[H]:null,ve=ie(n.contextString),ye=re(n.contextString),_e=!Object(N.b)(t),Ce=Object(y.jb)(t,c,n),Se=me&&!!me.DataProvider,Oe=me&&!!me.BoundViewParams,Ie=Object(h.x)(t),je=Ie&&Ie.gridTotalRecordCountLimit?Ie.gridTotalRecordCountLimit:5e3,Pe=Object(y.ib)(t,n.id,c),xe=le(n.configuration),Ee=le(n.configuration);if(null!=n.nonCompositionProps){var Te=B&&B.FormFactor&&B.FormFactor.toString(),we=Object(D.c)(n.nonCompositionProps.gridConfigurations,n.nonCompositionProps.viewConfigurations,B,null,v.h.GRID,Te).map((function(e){return e.configuration.DisplayNameKey})),Ae=dt(t,we);(!Ye&&""!==Object(m.c)(Ae,we[0])||Ye!==Ae)&&(Ye=Ae)}var Fe=!!l,Ne=Object(y.T)(t,n.id,c)||(O&&O.Parameters&&O.Parameters.ViewId?a.a.parse(O.Parameters.ViewId):null),ke=Object(y.qb)(t,Ne,n.id),Me=(null==ke?void 0:ke.isUserView)?d.b.userview:d.b.savedview,De=null==ke?void 0:ke.queryType,Re=null==ke?void 0:ke.entityLogicalName;Re&&Re!==ze&&(ze=Re);var Le=Object(p.h)(t,ze),Be=!_e&&q===P.b.Web&&K&&Z.isAdvancedFindEnabled&&(null==Le?void 0:Le.IsValidForAdvancedFind);if(!He||e!==Be){var Ve=Object(r.__spreadArrays)(I.labelList);Be&&(Ve=Object(r.__spreadArrays)(Ve,[Q.c.OpenAdvancedFiltersTitleAndAria]));var vt=dt(t,Ve);""!==Object(m.c)(vt,I.JUMPBAR_ALL_TITLE)?(He=vt,e=Be):Fe=!1}var yt=Object(y.W)(t,G);yt&&yt!==Ue&&(Ue=yt);var _t=tt(t,n);le(n.configuration)&&(Object.assign(_t.bodyStyle,{flexDirection:"column"}),Object.assign(_t.bodyMobileStyle,{flexDirection:"column"}));var Ct=Object(y.F)(t,n.id,c)||(O&&O.Parameters&&O.Parameters[v.u]?O.Parameters[v.u]:null),St=Ct;K&&(St=se.entityTypeName);var Ot=Object(A.b)(t,Ct);Le&&Le.Initialized===s.a.Initialized||Se||Oe||(Fe=!1);var It=Le?Le.DisplayName:"",jt=Object(h.t)(t),Pt=Object(p.i)(t,Ct),xt=!(ke&&ke.fetchXML),Et=ke&&ke.viewId,Tt=bt(t,xt?"":ke.fetchXML,ze,_e),wt=!xt&&!Tt.error,At=null!=ke&&Object(w.b)(ke.offlineSqlQuery),Ft=Object(F.l)(t,ze),Nt=mt(K,ye,ve,ze,Et?Et.guid:null,xt,At,wt,Ft,Tt.error&&Tt.errorCode||"",Tt.error&&Tt.relatedEntityUnavailableOffline||""),kt=!((K||ve||ye)&&ke&&ke.fetchXML&&_e&&Ft)||!At&&wt,Mt="";if(kt?Ft||(Mt=I.ENTITY_NOT_AVAILABLE_IN_PROFILE):At?Mt=I.SQL_QUERY_NOT_AVAILABLE:Tt.error&&(Mt=Tt.errorCode),me){me.TargetEntityType&&Ct!==me.TargetEntityType&&(Ct=me.TargetEntityType),me.ExtraFilters=ge(t,n,c,pe,!1);var Dt=function(e,t,n,r,a){var i=[],o=Object(y.q)(e,t.id,n);if(o){var s=JSON.parse(o);if(s.conditions)for(var c=0,l=s.conditions;c<l.length;c++){var u=l[c];u.linkEntityExpressions&&(i=i.concat(u.linkEntityExpressions))}}var d=e.user&&e.user.userId,p=Object(M.c)(e,k.Zc),g=Object(y.ub)(e,r),h=Object(V.a)(r,d,n,p,g),m=h&&h.getFilterAndLinkedEntities(a&&void 0!==a.activityOrQueueFilterValue?a.activityOrQueueFilterValue:W.a,a&&!a.activityOrQueue);m&&m.linkEntities&&(i=i.concat(m.linkEntities));return(m=m||{filter:null,linkEntities:null}).linkEntities=i,m}(t,n,c,Ct,pe);if(Dt&&Dt.filter&&(me.ExtraFilters?me.ExtraFilters.push(JSON.stringify(Dt.filter)):me.ExtraFilters=[JSON.stringify(Dt.filter)]),Dt&&Dt.linkEntities&&Dt.linkEntities.length>0){var Rt={Static:!0,Value:Object(z.b)(Dt.linkEntities)};if(me.LinkingInput){Rt=me.LinkingInput;var Lt=Object(z.a)(me.LinkingInput.Value);if(Lt){var Bt=new X.a;Lt.forEach((function(e){Bt.addLinkedEntity(e)})),Dt.linkEntities.forEach((function(e){Bt.addLinkedEntity(e)})),Rt.Value=Object(z.b)(Bt.getLinkedEntities())}}me.LinkingInput=Rt}if(Ne){var Vt=a.a.toString(Ne);Vt!==me.ViewId&&(me.ViewId=Vt)}else Ne=a.a.tryParseOrNull(me.ViewId);(O&&O.Parameters?"false"===O.Parameters[v.F.ENABLE_CONTEXTUALACTIONS]:null)&&(he.Parameters[v.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}Ct&&Ct!==Xe&&(Xe=Ct);var Gt=Object(p.r)(t,Ct)&&n.contextString===v.h.GRID?y.a:Ct,Wt=me&&me.CommandBarContext,zt=et(t,n,Gt,Wt),Xt=function(e,t,n){var r=Object(y.qb)(e,t,n);return r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells}(t,Ne,n.id),qt=null==Xt?void 0:Xt.map((function(e){return e.name})),Ut=null==We?void 0:We.map((function(e){return e.name}));(JSON.stringify(qt)!==JSON.stringify(Ut)||(Ne&&Ne.guid)!==(Ge&&Ge.guid)||u===Je&&b!==$e)&&(Ge=Ne,$e=b,qe=(O&&O.Id?O.Id:"")+(new Date).getTime(),We=Xt),u&&u!==Je&&(Je=u);var Ht=Object(y.o)(t,Ct),Yt=Ht?Ht.lookupAttribute:null;me&&(function(e,t,n,r,a,i,o){var s=Object(p.h)(e,r);if(s&&le(t.configuration)){var c=v.b;n.Columns||(n.Columns=[]),r!==y.a||a&&a.some((function(e){return e.name===c}))||n.Columns.find((function(e){return e.Name===c}))||n.Columns.push({Alias:c,DataType:"",Type:"",Name:c});var l=s&&s.PrimaryNameAttribute,u=a&&a.some((function(e){return e.name===l}));if(!l||u||n.Columns.some((function(e){return e.Name===l}))||n.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(t.configuration.Parameters)){var d=Object(R.a)(s.PrimaryImageAttribute);d&&!n.Columns.find((function(e){return e.Name===d}))&&n.Columns.push({Alias:Y.d,DataType:"SingleLine.Text",Type:"",Name:d}),Object(M.a)(e,k.ub)&&i&&o&&(n.Columns.find((function(e){return e.Name===y.c}))||n.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),n.Columns.find((function(e){return e.Name===i}))||n.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(t,n,me,Ct,We,Yt,!Object(w.a)(se)),function(e,t,n,r,a){if(!Object(y.vb)(t.configuration.Parameters))return;(null==a?void 0:a.some((function(t){var n;return(null===(n=Object($.a)(e,r,t.name))||void 0===n?void 0:n.Type)===ee.a.moneyType})))&&(n.Columns.some((function(e){return e.Alias===v.A}))||n.Columns.push({Alias:v.A,DataType:"Lookup.Simple",Type:"",Name:Y.w}))}(t,n,me,Ct,We));var Kt=!Ct||(Object(A.i)(Ct)||Object(A.g)(t,Ct,2,0)&&function(e,t){var n=!0;t&&t.forEach((function(t){if(t.relatedEntityName&&!(n=Object(A.g)(e,t.relatedEntityName,2,0)))return!1}));return n}(t,We)),Qt=Object(y.Y)(t,n.id,c),Zt=Qt?JSON.parse(Qt):null,Jt=Zt?Zt.totalResultCount:null,$t=Zt?Zt.pageSize:null,en=null!==Jt&&Jt>-1?0===Jt?Object(m.c)(He,I.NO_DATA_AVAILABLE):String.format(I.X_RECORDS_PRESENT,Jt):"",tn=ht(t,K),nn=!(null!=q&&q===P.b.Native),rn=Object(y.rb)(t,null===(i=null==se?void 0:se.pageToEditedViewMapId)||void 0===i?void 0:i.guid,null==Ne?void 0:Ne.guid),an={isEmptyOfflineSqlQuery:At,isEntityAvailableForOffline:Ft,isOfflineSqlQueryAvailable:kt,offlineErrorMessageKey:Mt,isOfflineAvailableForUse:Object(J.w)(t),offlineGridErrorTelemetryParams:Nt},on=Object(te.d)(t),sn=Object(f.c)(t,Ge),cn=!_e&&q===P.b.Web&&K&&Z.isColumnEditorButtonEnabled&&!ve&&!ye,ln=Object(y.ub)(t,Ct);return{showAdvancedFilter:Be,isViewEdited:!!rn,isInitialized:Fe,viewId:Ge,customFilter:de,gridEntityTypeName:ze,chartEntityTypeName:ze,isUCIEntity:Ot,totalRecordCountLimitExceeded:Ce,chartProps:Pe?rt(t,n,c):null,viewDescriptor:ke,commandBarProps:T(v.E.COMMANDBAR_ENABLED,!0,v.F.ENABLE_CONTEXTUALACTIONS,H,!0)?at(t,n,c,O,zt,_t):null,viewSelectorProps:St&&T(v.E.VIEWSELECTOR_ENABLED,!0,v.F.ENABLE_VIEW_PICKER,H)?it(t,n,c,St,Ge,_t):null,queueFilterProps:B&&T(null,!0,v.F.ENABLE_QUEUEFILTER,H)?ot(t,n,c,Ct,_t):null,entityFilterProps:_e||!ln&&!Object(R.h)(t,Je,ve)?null:st(t,n,c,Ct,_t),jumpBarProps:T(v.E.JUMPBAR_ENABLED,xe,v.F.ENABLE_JUMPBAR,H)&&fe(n)?ct(n,c,Ct,o.languageId,pe?pe.jumpBar:null,He):null,quickFindProps:T(v.E.QUICKFIND_ENABLED,!0,v.F.ENABLE_QUICKFIND,H)?lt(n,c,Ct,se):null,pagingProps:T(v.E.PAGING_ENABLED,Ee,null,H)?ut(n,c,Ct):null,contextToken:c,controlKey:qe,styles:_t,refreshCounter:_,pagingRefreshInput:C,pageNumber:S,ribbonId:zt,semanticTag:oe(n.contextString),recordsPerPageSetting:Object(g.h)(t),userSetting:o,hasReadRolePrivilege:Kt,resourceStrings:He,switchVisualizationResourceStrings:Ye,entityTypeName:Xe,primaryDataSetName:H,nestedGridDatasetName:Ue,viewportSm:Object(x.a)(t).sizes.Breakpoints.DimensionS,viewportM:Object(x.a)(t).sizes.Breakpoints.DimensionM,systemDefinedProperties:pt(t,n,c),platformType:Object(j.a)(t),isGridEditable:Object(y.vb)(B?B.Parameters:null),notificationMessage:en,totalResultCount:Jt,pageSize:$t,offlineProps:an,isRTL:Object(g.g)(t),entityDisplayName:It,isOffline:_e,showChart:Pe,entityIconVectorName:Pt,webResourceUrl:jt,hasCustomDataProvider:Se,commandBarRefreshProps:tn,updatedConfiguration:he,offlineGridErrorTelemetryParams:Nt,gridInput:se,gridTotalRecordsCountLimit:je,gridSortingInfo:ue,nativeFilterExpression:Z.isGridPaginationStateFeatureEnabled&&se?se.nativeFilterExpression:null,pageNumberForEnhancedPaging:Z.isGridPaginationStateFeatureEnabled&&!nn&&se?se.gridPageNumber:null,userId:t.user&&t.user.userId||null,lookupAttributeForRecordHierarchy:Yt,fetchXML:ne,viewType:Me,savedQueryType:De,featureControlProps:Z,clientHostSubtype:U,backButtonEnabled:on,originalView:sn,showColumnEditor:cn,entityIsActivityType:ln}}}function ge(e,t,n,r,a){if(!r)return[];var i=ae(t.contextString),o=ie(t.contextString),s=re(t.contextString)&&Object(M.c)(e,k.bd),c=[];for(var l in r)c.push([l,r[l]]);var u=c.reduce((function(e,t){var n=t[0],r=t[1];return(i||o||s)&&"quickFind"===n||("activityOrQueueFilterValue"===n||"activityTypeSelectedValues"===n)||!r||e.push(r),e}),[]);if(a){var d=Object(y.t)(e,t.id,n);if(d&&d.customFilterXml){var p=Object(G.i)(d.customFilterXml),g=JSON.stringify(p);g&&u.push(g)}}else{var h=Object(y.q)(e,t.id,n);h&&u.push(h)}return u}function he(e){var t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function me(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));var t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function fe(e){var t,n,r;return"no"!==(null===(r=null===(n=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===n?void 0:n.EnableJumpBar)||void 0===r?void 0:r.Value)}function be(e,t,n,r,a,i,o){var s=e.dataSetUIOptions,c=r;if(o=!!Object(w.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){var l=e.configuration.Parameters[i];l&&l[v.f]&&(s=l[v.f])}var u=t&&t.Parameters&&t.Parameters[a]?"true"===t.Parameters[a]:o;return s&&n&&!Object(w.a)(s[n])&&(c=s[n]),c&&u}},sTlq:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("c/eZ"),a=n("CqlH"),i=n("yPdn"),o=n("eeUB");function s(e){return{type:"save.deviceSettingsDialog.async",sync:!0,execute:function(t,n){var s=t.dispatch,c=t.getState,l=Object(i.a)(c()),u={};Object.keys(l).forEach((function(t){u[t]=Object(r.__assign)(Object(r.__assign)({},l[t]),e[t])})),s(Object(o.b)(u)),n.DataSource.saveSessionState(a.a,u,!0)}}}},slAZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l}));var r=n("Sscr"),a="controls.addCustomFilter",i="controls.startCustomFilter",o="controls.endCustomFilter";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function s(e,t,n,i,o){var s=Object(r.v)(i);return{type:a,payload:{customFilter:o,entityLogicalName:n},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,n){var a=Object(r.v)(n);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}function l(e,t,n){var a=Object(r.v)(n);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:a}}}},tJMA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="Settings_Signout",a="Settings_Reconfigure",i=["Web.NavBar.UserInfoEditImage_Caption",r,a]},uCYK:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="footer.visible";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.v)(t);return{type:a,payload:n,meta:{pageId:e,contextKey:i}}}},"v/Fs":function(e,t,n){"use strict";n.d(t,"c",(function(){return y})),n.d(t,"d",(function(){return _})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return S}));var r=n("4E+q"),a=n("3/Bp"),i=n("nuS9"),o=n("2p2B"),s=n("sOTk"),c=n("UGbr"),l=n("9r0m"),u=n("xc1f"),d=n("Sscr"),p=n("HSdq"),g=n("TCDU"),h=n("r529"),m=n("Z1aD"),f=n("I0a0"),b=n("CUpQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function v(e,t){return e(Object(c.e)(t,1))}function y(e){var t=Object(r.c)(),n=Object(r.d)((function(t){return Object(d.j)(t,e)}),r.b),p=Object(r.d)((function(t){return Object(s.g)(t,e)})),m=_(e),f=m.isInCreateMode,b=m.isDirty,y=i.useCallback((function(){t(Object(o.b)(n,e,a.b)),p&&p.id&&!l.a.isNullOrEmpty(p.id)?v(t,e):t(Object(c.f)(e,u.a,!0,1,!1)).then((function(r){r&&Object(c.d)(t,n,e)}))}),[n,t,e,p]),C=i.useCallback((function(){t(f?Object(h.b)():Object(g.a)(e))}),[t,f,e]);return i.useMemo((function(){return{save:y,discard:C,isInCreateMode:f,isDirty:b}}),[C,b,f,y])}function _(e){var t=Object(r.d)((function(t){return Object(s.m)(t,e)})),n=Object(r.d)((function(n){return t||Object(p.Nb)(n,e,Object(d.j)(n,e))}));return{isInCreateMode:t,isDirty:n}}function C(e){var t=Object(r.c)(),n=Object(f.a)([b.n])[b.n],a=Object(r.d)((function(t){return Object(s.g)(t,e)})).entityTypeName;return i.useMemo((function(){return[{save:function(){return v(t,e).then((function(){return t(Object(m.a)(u.a,{entityTypeName:a},e))}))},label:n}]}),[t,a,e,n])}function S(e){var t=e.pageId,n=e.children,r=y(t);return n(r.save,r.isDirty)}},vqdi:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var r=n("OROb"),a=n("lMVv"),i=n("sgPk"),o=n("C8Q/"),s=n("ig6i"),c=n("cm3g"),l=n("9r0m"),u=n("HSdq"),d=n("Sscr"),p=n("sOTk"),g=n("Gemh"),h=n("0hZT"),m=n("fE8x"),f=n("r454"),b=n("cZkS"),v=n("qC0c"),y=n("EcZf"),_=n("YEEA");function C(e,t,n,C,S,O,I,j){return void 0===I&&(I=!1),{type:"embeddedEntity.save",execute:function(C,P){var x,E=C.getState(),T=new l.a(n),w=Object(d.f)(j,T,t);switch(Object(p.l)(E,e)){case h.a:x=Object(g.R)(E,e,w);break;default:x=Object(u.ac)(E,e,w)}var A=Object(m.c)(E),F=Object(m.b)(E);if((A||F)&&"Dashboard"!==Object(p.l)(E,e)){var N=P.ScriptManager.getContainer(e).getEventManager();if(C.dispatch(N.runOnSave(j,1,null,n)))return Promise.reject(Object(_.b)(E,e,2200000005,""))}return C.dispatch(Object(r.c)(x,I,S)).then((function(r){var u=Object(g.qb)(E,new l.a(O),e),d=Object(a.h)(E,t),p=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,C.getState);return p.where(new o.a("eq",new s.a(t,d.PrimaryIdAttribute),new c.a(n))),C.dispatch(Object(y.d)(p.getQueryState())).then((function(){return r}))})).catch((function(e){return Object(v.a)(E,b.xb)&&x&&C.dispatch(Object(f.b)(x,!1)),Promise.reject(e)}))}}}},x6Ak:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("Sscr"),a="refresh.timer";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function i(e,t,n){var i=Object(r.x)(t);return{type:a,payload:null,meta:{pageId:e,contextKey:i,controlName:n}}}},x9BS:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="offline.database.update";function a(e){return{type:r,payload:{existingDatabaseName:e}}}},"xC+Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r="offline.available.primary.entities.update";function a(e){return{type:r,payload:{offlineAvailablePrimaryEntities:e}}}},xirW:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n("UOiB"),a=n("Sscr"),i=n("krRo"),o="attribute.notification.update";function s(e,t,n,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute:function(e,l){e.dispatch(function(e,t,n,s){if(s&&s.contextTokenType&&s.contextTokenType===r.a.GridRow)return Object(i.d)(e,s,t,n);var c=Object(a.x)(s);return{type:o,payload:n,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,n,s,c))}}}},y5DA:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var r=n("9LTA"),a=n("Ww2r"),i=n("dUXI"),o=n("BuSU"),s=n("Je7O"),c=n("cZkS"),l=n("qC0c"),u=n("9r0m");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,n,r,o){var s=null;if(s=Object(a.b)(e,i.q),"function"==typeof n.get_ErrorCode)switch(n.get_ErrorCode()){case-2147093999:s=Object(a.b)(e,i.r);break;case-2147220960:s=Object(a.b)(e,i.o);break;case-2147164125:s=Object(a.b)(e,i.a);break;case-2147164130:case-2147164126:s=Object(a.b)(e,i.j);break;case-2147217149:s=Object(a.b)(e,i.i);break;case-2147217098:s=Object(a.b)(e,i.x);break;case-2147220969:case-2147187962:s=Object(a.b)(e,i.p);break;default:n.get_Message()&&(s=s+" "+n.get_Message())}p(e,t,s,r,o)}function p(e,t,n,a,i){var d;d=function(e){var t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(n),Object(l.c)(e,c.rd)?(t(Object(r.a)(a.getStorageKey(),d)),Object(r.e)(e,t,a.getStorageKey(),i)):(t(Object(r.c)(u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(r.d)(e,t,u.a.toString(a.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(a.viewId)||u.a.EMPTYGUIDSTRING,i))}function g(e,t,n,r,o,s){p(t,n,-2147220960===e?Object(a.b)(t,i.o):r,o,s)}}}]),window.bundleExecutionMarkers["scripts/es5/offlinestatusdialogpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();