(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/27.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[27],{"++AH":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveMultipleResponseHandler=void 0;var i=r("bOB9"),o=r("r9V9"),s=r("Y0ua"),u=r("Ag5+"),l=r("+1in");function c(e){return e?"["+e+"]":"["+s.FILE_PREFIX.RetrieveMultipleResponseHandler+"]"}t.retrieveMultipleResponseHandler=function(e,t,r,s,d,p){return void 0===p&&(p=[]),a(this,void 0,void 0,(function(){var a,f,y,h,m,b,v,g,E,T,_,S,O,N,M;return n(this,(function(n){switch(n.label){case 0:return a=e.url,f=[],y="",[4,u.getEntityNameFromUrl(e.url,t,r,p)];case 1:if(h=n.sent(),m=0,b=0,v=!1,g=!1,T={},!((E=s)&&E.length>0))return[3,6];_=[],d&&d[i.ADDITIONAL_PARAMETERS.PageSize]?m=d[i.ADDITIONAL_PARAMETERS.PageSize]:r.warn(c()+" Paging size is not passed in additional parameters",o.addEventParameters(p,f)),E[0].rows.length>m&&(v=!0,g=!0),b=E[0].rows.length,S=0,n.label=2;case 2:return S<E[0].rows.length?(O=E[0].rows.item(S),N={},M=!1,l.headerContainsPreferAnnotation(e)&&(M=!0),O?[4,l.getFormattedRecordData(t,O,h,M)]:[3,4]):[3,5];case 3:N=n.sent(),_.push(N),n.label=4;case 4:return S++,[3,2];case 5:T["@Microsoft.Dynamics.CRM.totalrecordcount"]=E[0].rows.length,T["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]=g,T["@Microsoft.Dynamics.CRM.morerecords"]=v,T.value=_,y=JSON.stringify(T),n.label=6;case 6:return f.push({name:"NoOfRecordsReturned",value:b}),f.push({name:"TotalRecordCountLimitExceeded",value:g}),f.push({name:"MoreRecords",value:v}),f.push({name:"PageSize",value:m}),t.EventManager.ReportComponentSuccess(c(),o.addEventParameters(p,f)),[2,l.buildOdataResponse(i.HTTP_STATUS_CODES.Ok,a,new Headers,y)]}}))}))}},"+1in":function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFormattedRecordData=t.getOptionSetMatchingValue=t.buildErrorResponse=t.buildOdataResponse=t.headerContainsPreferReturnRepresentation=t.headerContainsPreferAnnotation=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i=r("bOB9"),o=r("pqvw"),s=r("Y0ua"),u=r("i2et"),l=r("Z84h");function c(e,t,r,a){return{status:e,ok:(n=e,n>=200&&n<=299),statusText:"",headers:r,url:t,clone:function(){return Object.assign({},this)},json:function(){return Promise.resolve(a?JSON.parse(a):null)},text:function(){return Promise.resolve(a||"")}};var n}function d(e){return e+"@OData.Community.Display.V1.FormattedValue"}function p(e,t){return e.find((function(e){return e.Value===t}))}t.headerContainsPreferAnnotation=function(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(i.HEADER_VALUES.ANNOTATIONS))},t.headerContainsPreferReturnRepresentation=function(e){return!!(e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(i.HEADER_VALUES.PREFER_REPRESENTATION))},t.buildOdataResponse=c,t.buildErrorResponse=function(e,t,r,a){var n={},s={};s[i.STRING_CONSTANTS.ErrorCode]=r.code?r.code:i.ErrorCode.DataSourceOfflineErrorCode,s[i.STRING_CONSTANTS.Message]=r.message,s[i.STRING_CONSTANTS.StackTrace]=r.stack;var u={};u[i.STRING_CONSTANTS.ErrorCode]=r.code,u[i.STRING_CONSTANTS.Message]=r.message,u[i.STRING_CONSTANTS.StackTrace]=r.stack,s[i.STRING_CONSTANTS.InnerError]=u,n.error=s;var l=JSON.stringify(n);return o.isNullOrUndefined(a)&&(a=new Headers),c(e,t,a,l)},t.getOptionSetMatchingValue=p,t.getFormattedRecordData=function(e,t,r,i,c){return void 0===c&&(c=[]),a(this,void 0,void 0,(function(){var a,f,y,h,m,b;return n(this,(function(n){switch(n.label){case 0:return a=e.TraceManager.getTracer(s.COMPONENT_NAMES.ResponseHandler),[4,l.getAttributeTypes(e,[],r)];case 1:return f=n.sent(),[4,l.getAttributesMetadata(e,r,[])];case 2:for(b in y=n.sent(),h={},m=function(n){if(n){var s=t[n];if(!o.isNullOrUndefined(s))if(-1!==n.search("!")){var l=function(e){if(-1!==e.search("!")){var t=e.split("!"),r=t[0],a=t[1],n="_"+r+"_value";return"id"===a?n:"name"===a?d(n):"logicalname"===a?n+"@Microsoft.Dynamics.CRM.lookuplogicalname":e}return e}(n);h[l]=s}else{var m=f[n],b=d(n);switch(m){case u.AttributeType.Decimal:case u.AttributeType.Integer:case u.AttributeType.BigInt:case u.AttributeType.DateTime:case u.AttributeType.Double:case u.AttributeType.Money:h[n]=s;var v=null;m===u.AttributeType.Money&&t["transactioncurrencyid!id"]&&(v=t["transactioncurrencyid!id"]),i&&(e.Formatter?h[b]=e.Formatter.getFormattedvalue(r,n,m,s,v):(a.error("Formatter is not available when returnAnnotationsFormat = true",c),h[b]=s));break;case u.AttributeType.MultiSelectPickList:if(h[n]=s,i&&!o.isNullOrUndefined(y[n])&&!o.isNullOrUndefined(y[n].OptionSet)){var g=y[n].OptionSet,E=s.split(","),T=[];E.forEach((function(e){var t=g.find((function(t){return String(t.Value)===e.trim()}));t&&t.Label&&T.push(t.Label)}));var _=T.length>0?T.join("; "):void 0;h[b]=_}break;case u.AttributeType.Status:case u.AttributeType.State:case u.AttributeType.Boolean:case u.AttributeType.PickList:if(o.isNullOrUndefined(s)||m!==u.AttributeType.Boolean?h[n]=s:h[n]=0!==s,!o.isNullOrUndefined(s)&&i&&!o.isNullOrUndefined(y[n])&&!o.isNullOrUndefined(y[n].OptionSet)){var S=y[n].OptionSet;if(!o.isNullOrUndefined(S)&&S.length>0){var O=p(S,s);o.isNullOrUndefined(O)||(h[b]=O.Label)}}break;case u.AttributeType.PartyList:h[n]=s;break;case u.AttributeType.String:case u.AttributeType.UniqueIdentifier:case u.AttributeType.Memo:h[n]=s;break;default:h[n]=s,a.warn("Default case for formatter values. key = "+n+", attributeType = "+m)}}}},t)m(b);return[2,h]}}))}))}},"0X9q":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCache=void 0;var a=r("Y0ua"),n=function(){function e(e){this._promiseCache={},this._tracer=e.TraceManager.getTracer(a.COMPONENT_NAMES.ODataExecutor)}return e.prototype.contains=function(e){return this._promiseCache[e]?(this._tracer.info(i()+" Promise in cache"),!0):(this._tracer.info(i()+" Promise not in cache"),!1)},e.prototype.get=function(e){return this._tracer.info(i()+" --- Get Promise Key"),this._promiseCache[e]},e.prototype.put=function(e,t){this._tracer.info(i()+" --- Put Promise key"),this._promiseCache[e]=t},e.prototype.remove=function(e){this._tracer.info(i()+" --- Remove Promise key"),delete this._promiseCache[e]},e}();function i(e){return e?"["+e+"]":"["+a.FILE_PREFIX.PromiseCache+"]"}t.PromiseCache=n},"1txY":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.findRootNodes=void 0;var o=r("r9V9"),s=r("pqvw"),u=r("Ct6E"),l=r("Y0ua"),c=r("XGkY"),d=r("lMa+"),p=r("Z84h"),f=r("jD1M"),y=r("VDnG"),h=r("pq07"),m=r("Vnn7"),b=r("U8Nn"),v=r("stS6");function g(e,t,r,a){var n,o,s,u;void 0===a&&(a=[]);var l={};try{for(var c=i(t),d=c.next();!d.done;d=c.next()){var p=d.value;if(Array.isArray(p))try{for(var f=(s=void 0,i(p)),y=f.next();!y.done;y=f.next()){E(e,y.value,l,a)}}catch(e){s={error:e}}finally{try{y&&!y.done&&(u=f.return)&&u.call(f)}finally{if(s)throw s.error}}else E(e,p,l,a)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return e.info(U()+" found "+Object.keys(l).length+" root nodes for "+r.MetadataType+":"+r.MetadataSubtype),l}function E(e,t,r,a){void 0===a&&(a=[]);var n="",i="",o=u.MetadataType.none,l=!0;if(function(e){return Object.keys(e).indexOf("metadatatype")>=0}(t))o=(t=t).metadatatype,i=t.id,s.isNullOrUndefinedOrEmptyString(t.sourceid)||(l=!1,n=t.sourceid);else if(function(e){return Object.keys(e).indexOf("userid")>=0}(t))i=f.USER_CONTEXT_KEY,o=u.MetadataType.userContext;else{if(t=t,s.isNullOrUndefined(t.Id))return void e.error(U()+" Entity Descriptor with missing ID found",a);i=s.isNullOrUndefined(t.EntityLogicalName)?"":t.EntityLogicalName,o=u.MetadataType.entity}r[i]={dependenciesFetched:l,queryGenerated:!1,sourceId:n,id:i,metadataType:o}}function T(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,o,l,d;return n(this,(function(n){return a=h.getLegacyMetadataTypeForQuery(r.MetadataType,r.MetadataSubtype),o=a.subtype,l=a.type,d="",r.MetadataId&&(d=r.MetadataId.toString()),r.MetadataType===u.QueriedMetadataType.entity?[2,S(e,r)]:r.MetadataType===u.QueriedMetadataType.savedView||r.MetadataType===u.QueriedMetadataType.form||r.MetadataType===u.QueriedMetadataType.workspace||r.MetadataType===u.QueriedMetadataType.systemWorkspace||r.MetadataType===u.QueriedMetadataType.userWorkspace||r.MetadataType===u.QueriedMetadataType.savedVisualization?[2,L(e,t,r,i)]:r.MetadataType===u.QueriedMetadataType.dialog||r.MetadataType===u.QueriedMetadataType.taskBasedFlow?[2,_(e,l,r,t,i)]:(l===u.MetadataType.resourceString||l===u.MetadataType.label)&&r.MetadataNames&&r.MetadataNames.length>0?[2,O(e,l,r,t,i)]:(l===u.MetadataType.optionSet||l===u.MetadataType.webResource||l===u.MetadataType.webResourceDescriptor||l===u.MetadataType.complexControl)&&r.MetadataNames&&r.MetadataNames.length>0?[2,M(e,l,r,t,i)]:l===u.MetadataType.command&&r.MetadataNames&&r.MetadataNames.length>0?[2,P(e,r,t,i)]:l!==u.MetadataType.appModule||s.isNullOrUndefinedOrEmptyString(d)?l===u.MetadataType.appModuleOfflineMetadata?[2,N(e,t,i)]:!s.isNullOrUndefinedOrEmptyString(d)||l!==u.MetadataType.resourceString&&r.MetadataNames&&r.MetadataNames.length>0||l===u.MetadataType.taskBasedFlowGlobalMenu||l===u.MetadataType.quickCreateMenu||l===u.MetadataType.searchConfiguration||l===u.MetadataType.siteMap?[2,I(e,l,r,t,i)]:l===u.MetadataType.isActivityFlags?[2,C(e,t,i)]:l===u.MetadataType.viewSelector?[2,A(e,l,o,r,t,i)]:l===u.MetadataType.homePageConfiguration?[2,R(e,r,t,i)]:l===u.MetadataType.none&&o===u.MetadataSubtype.none&&s.isNullOrUndefinedOrEmptyString(r.EntityLogicalName)&&f.LegacyDependencyDepth[r.DependencyDepth]===f.LegacyDependencyDepth.UserContext?[2,[{userid:c.Guid.EMPTY}]]:[2,D(e,l,o,r,t,i)]:[2,w(e,r,t,i)]}))}))}function _(e,t,r,i,l){return void 0===l&&(l=[]),a(this,void 0,void 0,(function(){var a,c,d,p,f,h,m,b,g;return n(this,(function(n){switch(n.label){case 0:if(a=[],c=[],s.isNullOrUndefined(r.MetadataNames)||!(r.MetadataNames.length>0))return[3,7];d=r.MetadataNames,p=0,n.label=1;case 1:return p<d.length?(f=v.createLocalStoreId("",t,"",d[p]),[4,y.retrieveApplicationMetadata(e,f)]):[3,6];case 2:return h=n.sent(),(c=[]).push({name:"MetadataType",value:u.MetadataType[t]}),c.push({name:"DialogKey",value:f}),h?[3,3]:(i.error(U()+" Unable to find the dialog root "+f+" for type "+u.MetadataType[t],o.addEventParameters(l,c)),[3,5]);case 3:return a.push(h),m=h.data.FormId,b=v.createLocalStoreId("",u.MetadataType.form,m,""),[4,y.retrieveApplicationMetadata(e,b)];case 4:(g=n.sent())?a.push(g):(c.push({name:"FormKey",value:b}),i.warn(U()+" Unable to find dependent form metadata for dialog: "+f+" form: "+b+" for type "+u.MetadataType[t],o.addEventParameters(l,c))),n.label=5;case 5:return++p,[3,1];case 6:return[3,8];case 7:i.error(U()+" Dialog metadata requested without MetadataNames",o.addEventParameters(l,c)),n.label=8;case 8:return[2,a]}}))}))}function S(e,t){var r,a,n=t.MetadataSubtype.replace(/\\\"/g,'"'),o=JSON.parse(n),s=[];try{for(var u=i(Object.keys(o)),l=u.next();!l.done;l=u.next()){var c=l.value;s.push(p.getEntityMetadata(e,c))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return Promise.all(s)}function O(e,t,r,l,c){return void 0===c&&(c=[]),a(this,void 0,void 0,(function(){var a,d,p,f,h,m,g,E,T,_,S;return n(this,(function(n){switch(n.label){case 0:a=[],r.MetadataNames=function(e){var t,r;e.sort();var a=[],n="";try{for(var o=i(e),s=o.next();!s.done;s=o.next()){var u=s.value;u!==n&&(n=u,a.push(u))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return a}(r.MetadataNames),d=[];try{for(p=i(r.MetadataNames),f=p.next();!f.done;f=p.next())h=f.value,a=[],t===u.MetadataType.label?(m=h.split(":"))&&2===m.length?d.push(v.createLocalStoreId("",t,m[0],m[1])):(a.push({name:"MetadataName",value:h}),l.error(U()+" Invalid label name "+h,o.addEventParameters(c,a))):d.push(v.createLocalStoreId("",t,"",h))}catch(e){_={error:e}}finally{try{f&&!f.done&&(S=p.return)&&S.call(p)}finally{if(_)throw _.error}}return g=t===u.MetadataType.resourceString,0!==d.length?[3,1]:[2,[]];case 1:return[4,y.retrieveMultipleApplicationMetadataByKeys(e,b.KeyPath.get_id(),d)];case 2:return E=n.sent(),g&&E.length!==d.length&&(T=function(e,t){var r,a,n,o,u=t.filter((function(e){return e})).map((function(e){return e.data.Key})),l="";try{for(var c=i(e.MetadataNames),d=c.next();!d.done;d=c.next()){var p=d.value,f=!1;try{for(var y=(n=void 0,i(u)),h=y.next();!h.done;h=y.next()){if(p===h.value){f=!0;break}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=y.return)&&o.call(y)}finally{if(n)throw n.error}}f||(l=s.isNullOrUndefinedOrEmptyString(l)?p:l+", "+p)}}catch(e){r={error:e}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return l}(r,E),a.push({name:"MissingKeys",value:T}),l.error(U()+" Not able to find "+(d.length-E.length)+" keys out of "+d.length+" of type "+u.MetadataType[t]+", Missing Keys "+T,o.addEventParameters(c,a))),[2,E]}}))}))}function N(e,t,r){return void 0===r&&(r=[]),a(this,void 0,void 0,(function(){var a,i,o;return n(this,(function(n){switch(n.label){case 0:a=v.createLocalStoreId("",u.MetadataType.appModuleOfflineMetadata,"","",0),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,a)];case 2:return(i=n.sent())?[2,[i]]:[2,[]];case 3:throw o=n.sent(),t.error(U()+" Error when attempting to retrieve application metadata for type "+u.MetadataType[u.MetadataType.appModuleOfflineMetadata]+" "+a+" "+o.message,r),o;case 4:return[2]}}))}))}function M(e,t,r,l,c){return void 0===c&&(c=[]),a(this,void 0,void 0,(function(){var a,d,p,f,h,m,b,g,E,T,_;return n(this,(function(n){switch(n.label){case 0:a=[],n.label=1;case 1:n.trys.push([1,8,9,10]),d=i(r.MetadataNames),p=d.next(),n.label=2;case 2:if(p.done)return[3,7];f=p.value,h=v.createLocalStoreId(r.EntityLogicalName,t,"",f),(m=[]).push({name:"MetadataIdString",value:h}),n.label=3;case 3:return n.trys.push([3,5,,6]),[4,y.retrieveApplicationMetadata(e,h)];case 4:return b=n.sent(),m.push({name:"MetadataType",value:u.MetadataType[t]}),s.isNullOrUndefinedOrEmpty(b)?l.error(U()+" Not able to find some of the keys for type "+u.MetadataType[t]+" "+h,o.addEventParameters(c,m)):a.push(b),[3,6];case 5:throw g=n.sent(),l.error(U()+" "+(g.message||"Failed to Retrieve resource metadata"),o.addEventParameters(c,m)),g;case 6:return p=d.next(),[3,2];case 7:return[3,10];case 8:return E=n.sent(),T={error:E},[3,10];case 9:try{p&&!p.done&&(_=d.return)&&_.call(d)}finally{if(T)throw T.error}return[7];case 10:return[2,a]}}))}))}function P(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,l,c,d;return n(this,(function(n){switch(n.label){case 0:a=v.createLocalStoreId(t.EntityLogicalName,u.MetadataType.command,"",t.MetadataNames[0]),(l=[]).push({name:"MetadataIdString",value:a}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,a)];case 2:return c=n.sent(),s.isNullOrUndefinedOrEmpty(c)?(r.error(U()+" Not able to find the key "+a+" for type "+u.MetadataType[u.MetadataType.command],o.addEventParameters(i,l)),[2,[]]):[2,[c]];case 3:throw d=n.sent(),r.error(U()+" Error when retrieving command metadata "+t.MetadataNames[0],o.addEventParameters(i,l)),d;case 4:return[2]}}))}))}function w(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,l,c,p,f;return n(this,(function(n){switch(n.label){case 0:a=t.AppId&&t.AppId!==d.LegacyGuid.get_empty().toString()?t.AppId.toString():t.MetadataId.toString(),l=v.createLocalStoreId(t.EntityLogicalName,u.MetadataType.appModule,s.isNullOrUndefinedOrEmptyString(t.MetadataId)?"":t.MetadataId.toString(),s.isNullOrUndefined(t.MetadataNames)?"":t.MetadataNames[0],0,a),(c=[]).push({name:"MetadataIdString",value:l}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,l)];case 2:return p=n.sent(),s.isNullOrUndefinedOrEmpty(p)?(r.error(U()+" Not able to find the key "+l+" for type "+u.MetadataType[u.MetadataType.appModule],o.addEventParameters(i,c)),[2,[]]):[2,[p]];case 3:throw f=n.sent(),r.error(U()+" Error when retrieving app module metadata for appID: "+a+". "+f.message,o.addEventParameters(i,c)),f;case 4:return[2]}}))}))}function C(e,t,r){return void 0===r&&(r=[]),a(this,void 0,void 0,(function(){var a,i,l,c,d;return n(this,(function(n){switch(n.label){case 0:a=v.createLocalStoreId("",u.MetadataType.isActivityFlags,"",f.ENTITY_DEFINITIONS_TYPE),(i=[]).push({name:"MetadataIdString",value:a}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,a)];case 2:if(l=n.sent(),s.isNullOrUndefinedOrEmpty(l))throw c="GetClientMetadata: Not able to find the key "+a+" for type "+u.MetadataType[u.MetadataType.isActivityFlags],t.error(U()+" "+c,o.addEventParameters(r,i)),new Error(c);return[2,[l]];case 3:throw d=n.sent(),t.error(U()+" Error when retrieving activity flag metadata. "+d.message,o.addEventParameters(r,i)),d;case 4:return[2]}}))}))}function I(e,t,r,i,l){return void 0===l&&(l=[]),a(this,void 0,void 0,(function(){var a,c,p,f,h;return n(this,(function(n){switch(n.label){case 0:a="",c=[],r.MetadataId&&(a=r.MetadataId.toString()),p=r.AppId&&r.AppId!==d.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0,a=v.createLocalStoreId(r.EntityLogicalName,t,a,s.isNullOrUndefined(r.MetadataNames)?"":r.MetadataNames[0],0,p),c.push({name:"MetadataIdString",value:a}),c.push({name:"AppId",value:p||""}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,a)];case 2:return f=n.sent(),s.isNullOrUndefinedOrEmpty(f)?(i.error(U()+" Not able to find the key "+a+" for type "+u.MetadataType[t],o.addEventParameters(l,c)),[2,[]]):[2,[f]];case 3:throw h=n.sent(),i.error(U()+" Error when attempting to retrieve application metadata for type "+u.MetadataType[t]+" "+a+" "+h.message,o.addEventParameters(l,c)),h;case 4:return[2]}}))}))}function A(e,t,r,i,l,c){return void 0===c&&(c=[]),a(this,void 0,void 0,(function(){var a,p,f,h,m;return n(this,(function(n){switch(n.label){case 0:a=[],p=i.AppId&&i.AppId!==d.LegacyGuid.get_empty().toString()?i.AppId.toString():i.MetadataId?i.MetadataId.toString():void 0,f=v.createLocalStoreId(i.EntityLogicalName,u.MetadataType.viewSelector,"","",r,p),a.push({name:"MetadataIdString",value:f}),a.push({name:"AppId",value:p||""}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,f)];case 2:return h=n.sent(),s.isNullOrUndefinedOrEmpty(h)?(l.error(U()+" Not able to find the key "+f+" for type "+u.MetadataType[t],o.addEventParameters(c,a)),[2,[]]):[2,[h]];case 3:throw m=n.sent(),l.error(U()+" Error when retrieving view selector metadata for entity "+i.EntityLogicalName+" and appid "+p+". "+m.message,o.addEventParameters(c,a)),m;case 4:return[2]}}))}))}function R(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,l,c,d;return n(this,(function(n){switch(n.label){case 0:a=v.createLocalStoreId(t.EntityLogicalName,u.MetadataType.homePageConfiguration,"","",0,""),(l=[]).push({name:"MetadataIdString",value:a}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveApplicationMetadata(e,a)];case 2:return c=n.sent(),s.isNullOrUndefinedOrEmpty(c)?(r.error(U()+" Not able to find the key "+a+" for type "+u.MetadataType[u.MetadataType.homePageConfiguration],o.addEventParameters(i,l)),[2,[]]):[2,[c]];case 3:throw d=n.sent(),r.error(U()+" Error when retrieving home page configuration metadata. "+d.message,o.addEventParameters(i,l)),d;case 4:return[2]}}))}))}function D(e,t,r,i,o,s){return void 0===s&&(s=[]),a(this,void 0,void 0,(function(){var a,l,c,d;return n(this,(function(n){switch(n.label){case 0:a="",i.MetadataId&&(a=i.MetadataId.toString()),l=new m.ApplicationMetadataQuery(t,f.FormFactor.Desktop,i.EntityLogicalName,0,i.GetDefault,a,r,void 0),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,y.retrieveMultipleApplicationMetadataByQuery(e,l)];case 2:return(c=n.sent())&&c.length?[2,c]:(o.warn(U()+" Not able to find the key "+a+" for type "+u.MetadataType[t],s),[2,[]]);case 3:throw d=n.sent(),o.error(U()+" error retrieving metadata by query for "+a+". "+d.message,s),d;case 4:return[2]}}))}))}function L(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,o,l;return n(this,(function(n){if(a=f.METADATA_TYPE_TO_KEYS[r.MetadataType],!s.isNullOrUndefined(r.MetadataId)||r.MetadataNames&&r.MetadataNames.length)return f.LegacyDependencyDepth[r.DependencyDepth]===f.LegacyDependencyDepth.OnDemandWithContext?[2,Promise.all(F(e,t,r,a,i)).then((function(e){return k(t,e,a,i)}))]:(o=a.slice(1,a.length),l=x(e,r,o),[2,Promise.all(l).then((function(e){return k(t,e,o,i)}))]);if(s.isNullOrUndefined(r.GetDefault)||!r.GetDefault)throw new Error("A query with empty MetadataId and non-true GetDefault parameters is considered invalid.");if(s.isNullOrUndefined(r.EntityLogicalName)&&r.MetadataType!==u.QueriedMetadataType.workspace&&r.MetadataType!==u.QueriedMetadataType.systemWorkspace&&r.MetadataType!==u.QueriedMetadataType.userWorkspace)throw new Error("This query requests defaults and/or selectors, but does not specify the context. This query is considered invalid.");return[2,Promise.all(F(e,t,r,a,i)).then((function(e){if(s.isNullOrUndefined(e)||e.length<2)throw new Error("The local store does not contain metadata fragments or selectors for the specified query.");var t=e[0][0],n=a[0],i=function(e){var t=e.data.SelectorItems;if(!s.isNullOrUndefined(t)&&t.length>0){for(var r=0;r<t.length;r++){var a=t[r];if(a.IsDefault)return a}return t[0]}return{}}(t);if(s.isNullOrUndefined(i))throw new Error("The default selector item cannot be found.");for(var o=[],u=1;u<e.length;++u)for(var l=e[u],c=a[u],d=0;d<l.length;d++){var p=l[d];i[n.uniqueKey]===p.data[c.uniqueKey]&&o.push(p)}return f.LegacyDependencyDepth[r.DependencyDepth]===f.LegacyDependencyDepth.OnDemandWithContext&&o.push(t),o}))]}))}))}function F(e,t,r,i,o){void 0===o&&(o=[]);var l=h.getLegacySubtype(r.MetadataType,r.MetadataSubtype),c=i[0],p=[];if(s.isNullOrUndefined(r.EntityLogicalName)&&r.MetadataType!==u.QueriedMetadataType.workspace&&r.MetadataType!==u.QueriedMetadataType.systemWorkspace&&r.MetadataType!==u.QueriedMetadataType.userWorkspace){var b=new m.ApplicationMetadataQuery(c.metadataType,f.FormFactor.Desktop,"",0,!1,"",l),g=y.retrieveMultipleApplicationMetadataByQuery(e,b);p.push(g)}else{var E=v.createLocalStoreId(r.EntityLogicalName,c.metadataType,"","",l,r.AppId&&r.AppId!==d.LegacyGuid.get_empty().toString()?r.AppId.toString():void 0);p.push(function(e,t,r,i,o){void 0===o&&(o=[]);return a(this,void 0,void 0,(function(){var a,l;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,y.retrieveApplicationMetadata(e,r)];case 1:return a=n.sent(),s.isNullOrUndefinedOrEmpty(a)?(t.error(U()+" Not able to find the key "+r+" for type "+u.MetadataType[i],o),[2,[]]):[2,[a]];case 2:throw l=n.sent(),t.error(U()+" Error when retrieving application metadata for id "+r+". "+l.message,o),l;case 3:return[2]}}))}))}(e,t,E,c.metadataType,o))}return p=x(e,r,i.slice(1,i.length),p)}function x(e,t,r,a){s.isNullOrUndefined(a)&&(a=[]);for(var n=h.getLegacySubtype(t.MetadataType,t.MetadataSubtype),i=0;i<r.length;++i){var o=r[i].metadataType,u=t.MetadataId?new m.ApplicationMetadataQuery(o,f.FormFactor.Desktop,t.EntityLogicalName,0,!1,t.MetadataId.toString()):new m.ApplicationMetadataQuery(o,f.FormFactor.Desktop,t.EntityLogicalName,0,!1,void 0,n);a.push(y.retrieveMultipleApplicationMetadataByQuery(e,u))}return a}function k(e,t,r,a){void 0===a&&(a=[]);var n=[];if(s.isNullOrUndefined(t)||!t.length)return e.error(U()+" The local store does not contain metadata fragments or selectors for the specified query.",o.addEventParameters(a,n)),[];for(var i=[],u=[],l=0;l<t.length;++l)for(var c=t[l],d=r[l],p=0;p<c.length;p++){var f=c[p];i.push(f),u.push(d.payloadKey)}for(l=0;l<r.length;++l){d=r[l];if((n=[]).push({name:"PayLoadKey",value:d.payloadKey}),-1===u.indexOf(d.payloadKey)){var y=new Error("The local store does not contain "+d.payloadKey+" requested metadata.");throw e.warn(U()+" "+y.message,o.addEventParameters(a,n)),y}}return i}function U(e){return e?"["+e+"]":"["+l.FILE_PREFIX.RootFinder+"]"}t.findRootNodes=function(e,t,r,i){return void 0===i&&(i=[]),a(this,void 0,void 0,(function(){var a,s,u;return n(this,(function(n){switch(n.label){case 0:(a=[]).push({name:"ClientMetadataQuery",value:JSON.stringify(r)}),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,T(e,t,r,i)];case 2:return s=n.sent(),[2,g(t,s,r,i)];case 3:return u=n.sent(),o.addErrorInformationToEventParameters(u,a),t.error(U()+" Error when attempting to find root nodes.",o.addEventParameters(i,a)),[3,4];case 4:return[2,{}]}}))}))}},"2C7J":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.FieldFormatValue=void 0,function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(t.FieldFormatValue||(t.FieldFormatValue={}))},"2JPV":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateCreateRequests=void 0;var i=r("bOB9"),o=r("Z84h"),s=r("Ag5+"),u=r("kwGv");function l(e,t,r,l,c){return void 0===c&&(c=[]),a(this,void 0,void 0,(function(){var a,d;return n(this,(function(n){switch(n.label){case 0:return a=function(e){var t,r={sqlStatements:[],sqlParameters:new Array,additionalParameters:(t={},t[i.ADDITIONAL_PARAMETERS.RecordId]=e.id.guid.toString(),t)},a="",n="",o=[],s=0;for(var l in e.values)if(l){var c=s>0?",":"";a+=c+"["+l+"]",n+=c+"?",o.push(e.values[l]),s+=1}return r.sqlStatements.push(u.CLAUSE.insert+u.Punctuation.space+u.CLAUSE.into+u.Punctuation.space+u.Punctuation.openSQBracket+e.entityLogicalName+u.Punctuation.closeSQBracket+u.Punctuation.space+u.Punctuation.openParenthesis+a+u.Punctuation.closeParenthesis+u.Punctuation.space+u.CLAUSE.values+u.Punctuation.space+u.Punctuation.openParenthesis+n+u.Punctuation.closeParenthesis),r.sqlParameters.push(o),r}(r),[4,o.getEntityMetadata(t,l)];case 1:return(d=n.sent()).IsActivity?[4,s.getInsertActivityPartySQLQueryRequests(t,r,a,c)]:[3,3];case 2:a=n.sent(),n.label=3;case 3:return d&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(i.HEADER_VALUES.PREFER_REPRESENTATION)&&(a=s.appendRetrieveQuery(t,a,l,r.id,d.PrimaryIdAttribute,c)),[2,a]}}))}))}t.generateCreateRequests=function(e,t,r,i){return void 0===i&&(i={}),a(this,void 0,void 0,(function(){var a,c,d,p,f;return n(this,(function(n){switch(n.label){case 0:return a=i.commonEventParameters||[],[4,s.getEntityNameFromUrl(e.url,t,r,a)];case 1:return c=n.sent(),[4,o.getAttributeTypes(t,[],c,a)];case 2:return d=n.sent(),[4,s.getColumnsFromRequestJSON(e.body,d,c,t,r,a)];case 3:return p=n.sent(),[4,s.createEntityRecord(c,p,u.SqlOperation.create,t,r,a,i)];case 4:return f=n.sent(),[2,l(e,t,f,c,a)]}}))}))}},"5OKj":function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getCreateOperationResponseData=t.createResponseHandler=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i=r("bOB9"),o=r("ZRE3"),s=r("Y0ua"),u=r("Ag5+"),l=r("+1in");function c(e,t,r,i,o){return void 0===o&&(o=[]),a(this,void 0,void 0,(function(){var a,s,c,d,p,f;return n(this,(function(n){switch(n.label){case 0:return a="",s=i,c={},l.headerContainsPreferReturnRepresentation(e)&&s&&s.length>1&&s[1].rows.length>0?(d=s[1].rows.item(0))?[4,u.getEntityNameFromUrl(e.url,t,r,o)]:[3,3]:[3,3];case 1:return p=n.sent(),f=!1,l.headerContainsPreferAnnotation(e)&&(f=!0),[4,l.getFormattedRecordData(t,d,p,f)];case 2:c=n.sent(),a=JSON.stringify(c),n.label=3;case 3:return[2,a]}}))}))}function d(e){return e?"["+e+"]":"["+s.FILE_PREFIX.CreateResponseHandler+"]"}t.createResponseHandler=function(e,t,r,s,u,p){return void 0===p&&(p=[]),a(this,void 0,void 0,(function(){var a,f,y,h,m,b;return n(this,(function(n){switch(n.label){case 0:return a=e.url,y="",h=null,u&&u[i.ADDITIONAL_PARAMETERS.RecordId]&&(h=u[i.ADDITIONAL_PARAMETERS.RecordId]),m=new Headers,null==h?[3,2]:(b=e.url+"("+h+")",m.append(i.HEADER.ODADTA_ENTITY_ID,b),r.info(d()+" Processing the create response"),[4,c(e,t,r,s,p)]);case 1:return y=n.sent(),f=l.buildOdataResponse(i.HTTP_STATUS_CODES.NoContent,a,m,y),[3,3];case 2:r.error(d()+" Guid returned from sql executor is null",p),f=l.buildErrorResponse(i.HTTP_STATUS_CODES.Unknown,a,new o.LocalError("Guid returned from sql executor is null")),n.label=3;case 3:return[2,f]}}))}))},t.getCreateOperationResponseData=c},"5whO":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.LongRequestInterceptor=void 0;var s=r("r9V9"),u=r("pqvw"),l=r("Y0ua"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){var t,r,a,n,i,c,d,p;return o(this,(function(o){switch(o.label){case 0:return t=e.request,1800,r=u.encodeURIComponentForOData(t.url),a="GET"===t.method&&r.length>1800,n=this.applicationContext.TraceManager.getTracer(l.COMPONENT_NAMES.RemoteODataExecutor),i=e.executionContext?e.executionContext.commonEventParameters:[],(c=[]).push({name:"UrlRequestLength",value:r.length}),n.info(this.getLongRequestInterceptorPrefix()+" Start Execute Remote Request ",s.addEventParameters(i,c)),a&&(t=u.buildBatchRequest([t]),n.warn(this.getLongRequestInterceptorPrefix()+" Built batch request for long request",s.addEventParameters(i,c))),[4,e.proceed(t)];case 1:return d=o.sent(),a?[4,u.parseBatchResponse(d)]:[3,3];case 2:p=o.sent(),d=p[0],n.warn(this.getLongRequestInterceptorPrefix()+" Parsed batch request for long request",s.addEventParameters(i,c)),o.label=3;case 3:return n.info(this.getLongRequestInterceptorPrefix()+" Finish Execute Remote Request",s.addEventParameters(i,c)),[2,d]}}))}))},t.prototype.getLongRequestInterceptorPrefix=function(e){return e?"["+e+"]":"["+l.FILE_PREFIX.LongRequestInterceptor+"]"},t}(r("lHlh").Interceptor);t.LongRequestInterceptor=c},"6Use":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.toNumberAttributeType=t.fromNumberAttributeType=t.fromDbAttributeTypes=t.toDbAttributeTypes=t.NumberAttributeType=void 0;var a,n=r("pqvw"),i=r("i2et");function o(e){switch(e){case a.Boolean:return i.AttributeType.Boolean;case a.Customer:return i.AttributeType.Customer;case a.DateTime:return i.AttributeType.DateTime;case a.Decimal:return i.AttributeType.Decimal;case a.Double:return i.AttributeType.Double;case a.Integer:return i.AttributeType.Integer;case a.Lookup:return i.AttributeType.Lookup;case a.Memo:return i.AttributeType.Memo;case a.Money:return i.AttributeType.Money;case a.Owner:return i.AttributeType.Owner;case a.PartyList:return i.AttributeType.PartyList;case a.Picklist:return i.AttributeType.PickList;case a.State:return i.AttributeType.State;case a.Status:return i.AttributeType.Status;case a.String:return i.AttributeType.String;case a.UniqueIdentifier:return i.AttributeType.UniqueIdentifier;case a.CalendarRules:return i.AttributeType.CalendarRules;case a.Virtual:return i.AttributeType.Virtual;case a.BigInt:return i.AttributeType.BigInt;case a.ManagedProperty:return i.AttributeType.ManagedProperty;case a.EntityName:return i.AttributeType.EntityName;case a.AliasedValue:return i.AttributeType.AliasedValue;case a.EntityImage:return i.AttributeType.EntityImage;case a.MultiSelectPicklist:return i.AttributeType.MultiSelectPickList;case a.File:return i.AttributeType.File;case a.NavigationProperty:return i.AttributeType.NavigationProperty;default:return i.AttributeType.Unknown}}function s(e){switch(e){case i.AttributeType.Boolean:return a.Boolean;case i.AttributeType.Customer:return a.Customer;case i.AttributeType.DateTime:return a.DateTime;case i.AttributeType.Decimal:return a.Decimal;case i.AttributeType.Double:return a.Double;case i.AttributeType.Integer:return a.Integer;case i.AttributeType.Lookup:return a.Lookup;case i.AttributeType.Memo:return a.Memo;case i.AttributeType.Money:return a.Money;case i.AttributeType.Owner:return a.Owner;case i.AttributeType.PartyList:return a.PartyList;case i.AttributeType.PickList:return a.Picklist;case i.AttributeType.State:return a.State;case i.AttributeType.Status:return a.Status;case i.AttributeType.String:return a.String;case i.AttributeType.UniqueIdentifier:return a.UniqueIdentifier;case i.AttributeType.CalendarRules:return a.CalendarRules;case i.AttributeType.Virtual:return a.Virtual;case i.AttributeType.BigInt:return a.BigInt;case i.AttributeType.ManagedProperty:return a.ManagedProperty;case i.AttributeType.EntityName:return a.EntityName;case i.AttributeType.AliasedValue:return a.AliasedValue;case i.AttributeType.EntityImage:return a.EntityImage;case i.AttributeType.MultiSelectPickList:return a.MultiSelectPicklist;case i.AttributeType.File:return a.File;case i.AttributeType.NavigationProperty:return a.NavigationProperty;default:return a.Unknown}}!function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(a=t.NumberAttributeType||(t.NumberAttributeType={})),t.toDbAttributeTypes=function(e){return n.mapToValues(e,(function(e){return s(e)}))},t.fromDbAttributeTypes=function(e){return n.mapToValues(e,(function(e){return o(e)}))},t.fromNumberAttributeType=o,t.toNumberAttributeType=s},"7EEb":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityMetadata=void 0;var n=r("pqvw"),i=r("lMa+"),o=r("cxea"),s=function(){function e(e,t,r,o,s,u,l,c,d,p,f,y,h,m,b,v,g,E,T,_,S,O,N,M,P,w,C,I,A,R,D,L,F,x,k,U,q,V,B,Q,G,H,j,Y,K,W,X,z,J,Z,$,ee){var te,re;this._objectTypeCode=0,this._hasChanged=!1,this._isActivity=!1,this._isReadOnlyForMobileClient=!1,this._isVisibleInMobileClient=!1,this._isOfflineInMobileClient=!1,this._isOptimisticConcurrencyEnabled=!1,this._isChildEntity=!1,this._primaryKeyName="",this._autoRouteToOwnerQueue=!1,this._canTriggerWorkflow=!1,this._displayCollectionName="",this._description="",this._isValidForAdvancedFind=!1,this._isMailMergeEnabled=!1,this._isConnectionsEnabled=!1,this._isCustomizable=!1,this._isActivityParty=!1,this._isImportable=!1,this._isEnabledForCharts=!1,this._isCustomEntity=!1,this._isStateModelAware=!1,this._enforceStateTransitions=!1,this._activityTypeMask=0,this._ownershipType=0,this._isCollaboration=!1,this._hasSecuredAttributes=!1,this._hasStateCode=!1,this._isBusinessProcessEnabled=!1,this._isDocumentManagementEnabled=!1,this._isOneNoteIntegrationEnabled=!1,this._isMSTeamsIntegrationEnabled=!1,this._isIntersect=!1,this._hasActivities=!1,this._isInteractionCentricEnabled=!1,this._isQuickCreateEnabled=!1,this._entityClientSetting={AllowMainFormDialogForCreate:!1,AllowMainFormDialogForEdit:!1},this._isKnowledgeManagementEnabled=!1,this._isDocumentRecommendationsEnabled=!1,this._hasNotes=!1,this._usesBusinessDataLabelTable=!1,this._isBPFEntity=!1,this._oneToManyRelationships=[],this._manyToOneRelationships=[],this._manyToManyRelationships=[],this._dataProviderId=i.LegacyGuid.get_empty(),this._versionNumber=0,this._overallVersionNumber=0,n.throwOnNullOrUndefinedArgument(e,"id"),n.throwOnNullOrUndefinedArgument(t,"logicalName"),this._id=e,this._logicalName=t,this._displayName=r,this._entitySetName=o,this._objectTypeCode=s,this._primaryIdAttribute=u,this._primaryNameAttribute=l,this._primaryImageAttribute=c,this._isReadOnlyForMobileClient=p,this._isVisibleInMobileClient=f,this._isOfflineInMobileClient=y,this._isOptimisticConcurrencyEnabled=h,this._hasChanged=m,this._isActivity=b,this._isChildEntity=v,this._parentEntityLogicalName=g,this._parentEntityReferencingAttribute=E,this._isValidForAdvancedFind=T,this._isMailMergeEnabled=_,this._isConnectionsEnabled=S,this._isCustomizable=O,this._isActivityParty=N,this._isImportable=M,this._isEnabledForCharts=P,this._isCustomEntity=w,this._isStateModelAware=C,this._enforceStateTransitions=I,this._isCollaboration=A,this._activityTypeMask=R,this._ownershipType=D,this._hasSecuredAttributes=L,this._hasStateCode=F,this._isBusinessProcessEnabled=x,this._isDocumentManagementEnabled=k,this._isOneNoteIntegrationEnabled=U,this._isMSTeamsIntegrationEnabled=q,this._hasActivities=V,this._entityColor=B,this._isInteractionCentricEnabled=Q,this._isQuickCreateEnabled=G,this._entityClientSetting=H,this._isKnowledgeManagementEnabled=j,this._isDocumentRecommendationsEnabled=Y,this._isIntersect=K,this._hasNotes=W,this._usesBusinessDataLabelTable=X,this._iconVectorName=z,this._isBPFEntity=J,this._versionNumber=Z,this._overallVersionNumber=$,this._attributeNames=ee,this._privilegesByType={};try{for(var ae=a(d),ne=ae.next();!ne.done;ne=ae.next()){var ie=ne.value;this._privilegesByType[ie.get_privilegeTypeKey()]=ie}}catch(e){te={error:e}}finally{try{ne&&!ne.done&&(re=ae.return)&&re.call(ae)}finally{if(te)throw te.error}}}return e.extractKey=function(t){return i.LegacyGuid.createFromObjectData(t[e._idPath]).toString()},e.createFromObjectData=function(t){n.isNullOrUndefinedOrEmptyString(t.MetadataId)||(t=e.createFromOData(t).getObjectData());var r=i.LegacyGuid.createFromObjectData(t[e._idPath]),a=t[e.logicalNamePath],s=t.displayname,u=t.entitysetname,l=t.objecttypecode,c=t.primaryidattribute,d=t.primarynameattribute,p=t.primaryimageattribute,f=t.isreadonlyformobileclient,y=t.isvisibleinmobileclient,h=t.isofflineinmobileclient,m=t.isoptimisticconcurrencyenabled,b=t.haschanged,v=t.isactivity,g=t.ischildentity,E=t.parententitylogicalname,T=t.parententityreferencingattribute,_=t.isvalidforadvancedfind,S=t.ismailmergeenabled,O=t.isconnectionsenabled,N=t.iscustomizable,M=t.isactivityparty,P=t.isimportable,w=t.isenabledforcharts,C=t.iscustomentity,I=t.isstatemodelaware,A=t.enforcestatetransitions,R=t.iscollaboration,D=t.activitytypemask,L=t.ownershiptype,F=t.hassecuredattributes,x=t.hasstatecode,k=t.isbusinessprocessenabled,U=t.isdocumentmanagementenabled,q=t.isonenoteintegrationenabled,V=t.ismsteamsintegrationenabled,B=t.hasactivities,Q=t.entitycolor,G=t.isinteractioncentricenabled,H=t.isQuickCreateEnabled,j=t.entityClientSetting,Y=t.isKnowledgeManagementEnabled,K=t.IsDocumentRecommendationsEnabled,W=t.isIntersect,X=t.hasnotes,z=t.usesBusinessDataLabelTable,J=t.iconVectorName,Z=t.isbpfentity,$=n.isNullOrUndefinedOrEmptyString(t.dataProviderId)?i.LegacyGuid.get_empty():i.LegacyGuid.tryCreate(t.dataProviderId),ee=t.primaryKeyName,te=t.autoRouteToOwnerQueue,re=t.canTriggerWorkflow,ae=t.displayCollectionName,ne=t.description,ie=t.oneToManyRelationships,oe=t.manyToOneRelationships,se=t.manyToManyRelationships,ue=-1,le=-1;t.VersionNumber&&(ue=t.VersionNumber),t.OverallVersionNumber&&(le=t.OverallVersionNumber);var ce=t.AttributeNames,de=new e(r,a,s,u,l,c,d,p,t.privileges.map((function(e){return o.SecurityPrivilegeMetadata.createFromObjectData(e)})),f,y,h,m,b,v,g,E,T,_,S,O,N,M,P,w,C,I,A,R,D,L,F,x,k,U,q,V,B,Q,G,H,j,Y,K,W,X,z,J,Z,ue,le,ce);return de._primaryKeyName=ee,de._autoRouteToOwnerQueue=te,de._canTriggerWorkflow=re,de._displayCollectionName=ae,de._description=ne,de._dataProviderId=$,de._oneToManyRelationships=ie,de._manyToManyRelationships=se,de._manyToOneRelationships=oe,de},e.getLabelString=function(e){return n.isNullOrUndefined(e.UserLocalizedLabel)?"":e.UserLocalizedLabel.Label},e.convertToLabel=function(e){var t={UserLocalizedLabel:{}};return t.UserLocalizedLabel.Label=e,t},e.createFromOData=function(t){var r=i.LegacyGuid.tryCreate(t.MetadataId),a=t.LogicalName,s=e.getLabelString(t.DisplayName),u=t.EntitySetName,l=t.ObjectTypeCode,c=t.PrimaryIdAttribute,d=t.IconVectorName,p=t.PrimaryKeyName,f=t.AutoRouteToOwnerQueue,y=t.CanTriggerWorkflow,h=t.PrimaryNameAttribute,m=t.PrimaryImageAttribute,b=t.IsReadOnlyInMobileClient,v=t.IsVisibleInMobileClient,g=t.IsOfflineInMobileClient,E=t.IsOptimisticConcurrencyEnabled,T=t.HasChanged,_=t.IsActivity,S=t.IsChildEntity,O=t.ParentEntityLogicalName,N=t.ParentEntityReferencingAttribute,M=t.IsValidForAdvancedFind,P=t.IsMailMergeEnabled,w=t.IsConnectionsEnabled,C=t.IsCustomizable,I=t.IsActivityParty,A=t.IsImportable,R=t.IsEnabledForCharts,D=t.IsCustomEntity,L=t.IsStateModelAware,F=t.EnforceStateTransitions,x=t.IsValidForQueue,k=t.ActivityTypeMask,U=t.OwnershipType,q=t.IsBusinessProcessEnabled,V=t.IsDocumentManagementEnabled,B=t.IsOneNoteIntegrationEnabled,Q=t.IsMSTeamsIntegrationEnabled,G=t.EntityColor,H=t.IsInteractionCentricEnabled,j=t.IsQuickCreateEnabled,Y=t.entityClientSetting,K=t.IsKnowledgeManagementEnabled,W=t.IsDocumentManagementEnabled,X=t.IsBPFEntity,z=t.OneToManyRelationships,J=t.ManyToOneRelationships,Z=t.ManyToManyRelationships,$=e.getLabelString(t.DisplayCollectionName),ee=e.getLabelString(t.Description),te=n.isNullOrUndefinedOrEmptyString(t.DataProviderId)?i.LegacyGuid.get_empty():i.LegacyGuid.tryCreate(t.DataProviderId),re=-1,ae=-1;t.VersionNumber&&(re=t.VersionNumber),t.OverallVersionNumber&&(ae=t.OverallVersionNumber);for(var ne=!1,ie=t.AttributeNames,oe=0;oe<ie.length;oe++)if("statecode"===ie[oe]){ne=!0;break}var se=t.IsIntersect,ue=new e(r,a,s,u,l,c,h,m,t.Privileges.map((function(e){return o.SecurityPrivilegeMetadata.createFromOData(e)})),b,v,g,E,T,_,S,O,N,M,P,w,C,I,A,R,D,L,F,x,k,U,!1,ne,q,V,B,Q,!1,G,H,j,Y,K,W,se,!1,!1,d,X,re,ae,ie);return ue._primaryKeyName=p,ue._autoRouteToOwnerQueue=f,ue._canTriggerWorkflow=y,ue._displayCollectionName=$,ue._description=ee,ue._dataProviderId=te,ue._oneToManyRelationships=z,ue._manyToOneRelationships=J,ue._manyToManyRelationships=Z,ue},e.prototype.get_attributeNames=function(){return this._attributeNames},e.prototype.get_id=function(){return this._id},e.prototype.get_logicalName=function(){return this._logicalName},e.prototype.get_displayName=function(){return this._displayName},e.prototype.set_entitySetName=function(e){return this._entitySetName=e,e},e.prototype.get_objectTypeCode=function(){return this._objectTypeCode},e.prototype.get_primaryIdAttribute=function(){return this._primaryIdAttribute},e.prototype.get_primaryNameAttribute=function(){return this._primaryNameAttribute},e.prototype.get_isOptimisticConcurrencyEnabled=function(){return this._isOptimisticConcurrencyEnabled},e.prototype.get_isActivity=function(){switch(this._logicalName){case"phonecall":case"email":case"task":case"appointment":case"activitypointer":return!0;default:return this._isActivity}},e.prototype.get_isChildEntity=function(){return this._isChildEntity},e.prototype.get_parentEntityLogicalName=function(){return this._parentEntityLogicalName},e.prototype.get_parentEntityReferencingAttribute=function(){return this._parentEntityReferencingAttribute},e.prototype.get_isCustomEntity=function(){return this._isCustomEntity},e.prototype.get_activityTypeMask=function(){return this._activityTypeMask},e.prototype.get_ownershipType=function(){return this._ownershipType},e.prototype.get_hasSecuredAttributes=function(){return this._hasSecuredAttributes},e.prototype.get_hasStateCode=function(){return this._hasStateCode},e.prototype.get_isBusinessProcessEnabled=function(){return this._isBusinessProcessEnabled},e.prototype.get_isIntersect=function(){return this._isIntersect},e.prototype.get_usesBusinessDataLabelTable=function(){return this._usesBusinessDataLabelTable},e.prototype.get_isBPFEntity=function(){return this._isBPFEntity},e.prototype.getEntityCanBeUsedInBusinessProcess=function(){return this._isBusinessProcessEnabled||this._isBPFEntity},e.prototype.getODataObject=function(){var t={},r=this._id.toString();for(var a in t.Id=r,t.MetadataId=r,t.LogicalName=this._logicalName,t.DisplayName=e.convertToLabel(this._displayName),t.EntitySetName=this._entitySetName,t.ObjectTypeCode=this._objectTypeCode,t.PrimaryKeyName=this._primaryKeyName,t.AutoRouteToOwnerQueue=this._autoRouteToOwnerQueue,t.CanTriggerWorkflow=this._canTriggerWorkflow,t.Description=e.convertToLabel(this._description),t.DisplayCollectionName=e.convertToLabel(this._displayCollectionName),t.PrimaryIdAttribute=this._primaryIdAttribute,t.PrimaryNameAttribute=this._primaryNameAttribute,t.PrimaryImageAttribute=this._primaryImageAttribute,t.IsReadOnlyInMobileClient=this._isReadOnlyForMobileClient,t.IsVisibleInMobileClient=this._isVisibleInMobileClient,t.IsOfflineInMobileClient=this._isOfflineInMobileClient,t.IsOptimisticConcurrencyEnabled=this._isOptimisticConcurrencyEnabled,t.HasChanged=this._hasChanged,t.IsActivity=this._isActivity,t.IsChildEntity=this._isChildEntity,t.ParentEntityLogicalName=this._parentEntityLogicalName,t.ParentEntityReferencingAttribute=this._parentEntityReferencingAttribute,t.IsValidForAdvancedFind=this._isValidForAdvancedFind,t.IsMailMergeEnabled=this._isMailMergeEnabled,t.IsConnectionsEnabled=this._isConnectionsEnabled,t.IsCustomizable=this._isCustomizable,t.IsActivityParty=this._isActivityParty,t.IsImportable=this._isImportable,t.IsEnabledForCharts=this._isEnabledForCharts,t.IsCustomEntity=this._isCustomEntity,t.IsStateModelAware=this._isStateModelAware,t.EnforceStateTransitions=this._enforceStateTransitions,t.IsValidForQueue=this._isCollaboration,t.ActivityTypeMask=this._activityTypeMask,t.OwnershipType=this._ownershipType,t.HasStateCode=this._hasStateCode,t.IsBusinessProcessEnabled=this._isBusinessProcessEnabled,t.IsDocumentManagementEnabled=this._isDocumentManagementEnabled,t.EntityColor=this._entityColor,t.IsInteractionCentricEnabled=this._isInteractionCentricEnabled,t.isQuickCreateEnabled=this._isQuickCreateEnabled,t.entityClientSetting=this._entityClientSetting,t.IsKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,t.OneToManyRelationships=this._oneToManyRelationships,t.ManyToOneRelationships=this._manyToOneRelationships,t.ManyToManyRelationships=this._manyToManyRelationships,t.IconVectorName=this._iconVectorName,t.IsBPFEntity=this._isBPFEntity,t.DataProviderId=this._dataProviderId?this._dataProviderId.toString():"",t.IsDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,t.IsIntersect=this._isIntersect,t.IsMSTeamsIntegrationEnabled=this._isMSTeamsIntegrationEnabled,t.VersionNumber=this._versionNumber,t.OverallVersionNumber=this._overallVersionNumber,t.AttributeNames=this._attributeNames,t.Privileges=[],this._privilegesByType)this._privilegesByType.hasOwnProperty(a)&&t.Privileges.push(this._privilegesByType[a].getODataObject());return t},e.prototype.getObjectData=function(){var t={};t[e._idPath]=this._id.getObjectData(),t[e.logicalNamePath]=this._logicalName,t.displayname=this._displayName,t.entitysetname=this._entitySetName,t.objecttypecode=this._objectTypeCode,t.primaryidattribute=this._primaryIdAttribute,t.primarykeyname=this._primaryKeyName,t.displayCollectionName=this._displayCollectionName,t.autoRouteToOwnerQueue=this._autoRouteToOwnerQueue,t.canTriggerWorkflow=this._canTriggerWorkflow,t.primarynameattribute=this._primaryNameAttribute,t.primaryimageattribute=this._primaryImageAttribute,t.description=this._description,t.oneToManyRelationships=this._oneToManyRelationships,t.manyToOneRelationships=this._manyToOneRelationships,t.manyToManyRelationships=this._manyToManyRelationships,t.isreadonlyformobileclient=this._isReadOnlyForMobileClient,t.isvisibleinmobileclient=this._isVisibleInMobileClient,t.isofflineinmobileclient=this._isOfflineInMobileClient,t.isoptimisticconcurrencyenabled=this._isOptimisticConcurrencyEnabled,t.haschanged=this._hasChanged,t.isactivity=this._isActivity,t.ischildentity=this._isChildEntity,t.parententitylogicalname=this._parentEntityLogicalName,t.parententityreferencingattribute=this._parentEntityReferencingAttribute,t.isvalidforadvancedfind=this._isValidForAdvancedFind,t.ismailmergeenabled=this._isMailMergeEnabled,t.isconnectionsenabled=this._isConnectionsEnabled,t.iscustomizable=this._isCustomizable,t.isactivityparty=this._isActivityParty,t.isimportable=this._isImportable,t.isenabledforcharts=this._isEnabledForCharts,t.iscustomentity=this._isCustomEntity,t.isstatemodelaware=this._isStateModelAware,t.enforcestatetransitions=this._enforceStateTransitions,t.iscollaboration=this._isCollaboration,t.activitytypemask=this._activityTypeMask,t.ownershiptype=this._ownershipType,t.hassecuredattributes=this._hasSecuredAttributes,t.hasstatecode=this._hasStateCode,t.isbusinessprocessenabled=this._isBusinessProcessEnabled,t.isdocumentmanagementenabled=this._isDocumentManagementEnabled,t.isonenoteintegrationenabled=this._isOneNoteIntegrationEnabled,t.ismsteamsintegrationenabled=this._isMSTeamsIntegrationEnabled,t.hasactivities=this._hasActivities,t.entitycolor=this._entityColor,t.isinteractioncentricenabled=this._isInteractionCentricEnabled,t.isQuickCreateEnabled=this._isQuickCreateEnabled,t.entityClientSetting=this._entityClientSetting,t.isKnowledgeManagementEnabled=this._isKnowledgeManagementEnabled,t.isDocumentRecommendationsEnabled=this._isDocumentRecommendationsEnabled,t.isIntersect=this._isIntersect,t.hasnotes=this._hasNotes,t.iconVectorName=this._iconVectorName,t.usesBusinessDataLabelTable=this._usesBusinessDataLabelTable,t.isbpfentity=this._isBPFEntity,t.dataProviderId=this._dataProviderId?this._dataProviderId.toString():"",t.VersionNumber=this._versionNumber,t.OverallVersionNumber=this._overallVersionNumber,t.AttributeNames=this._attributeNames;var r=[],a=this._privilegesByType;for(var n in a)if(a.hasOwnProperty(n)){var i={key:n,value:a[n]};r.push(i.value.getObjectData())}return t.privileges=r,t},e.logicalNamePath="logicalname",e._idPath="id",e}();t.EntityMetadata=s},"88gK":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFields=t.stateAndStatusFields=t.defaultFieldsForCreate=t.participationTypeNames=t.participationTypeValue=t.participationMasks=t.isRegularActivity=t.activityParty=t.addressUsed=t.partyObjectTypeCode=t.isPartyDeleted=t.ownerParty=t.value=t.objectTypeCode=t.objectId=t.name=t.logicalName=t.id=t.fullNameComponents=t.fullName=t.middleName=t.lastName=t.firstName=t.ownerId=t.createdBy=t.createdOn=t.statusCode=t.stateCode=t.versionNumber=t.partyId=t.activityPartyId=t.activityTypeCode=t.activityId=t.modifiedBy=t.modifiedOn=t.systemUser=t.columnDelimiter=void 0,
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
t.columnDelimiter="!",t.systemUser="systemuser",t.modifiedOn="modifiedon",t.modifiedBy="modifiedby",t.activityId="activityid",t.activityTypeCode="activitytypecode",t.activityPartyId="activitypartyid",t.partyId="partyid",t.versionNumber="versionnumber",t.stateCode="statecode",t.statusCode="statuscode",t.createdOn="createdon",t.createdBy="createdby",t.ownerId="ownerid",t.firstName="firstname",t.lastName="lastname",t.middleName="middlename",t.fullName="fullname",t.fullNameComponents=[t.firstName,t.middleName,t.lastName],t.id="id",t.logicalName="logicalname",t.name="name",t.objectId="objectid",t.objectTypeCode="objecttypecode",t.value="value",t.ownerParty="owner",t.isPartyDeleted="ispartydeleted",t.partyObjectTypeCode="partyobjecttypecode",t.addressUsed="addressused",t.activityParty="activityparty",t.isRegularActivity="isregularactivity",t.participationMasks="participationtypemask",t.participationTypeValue={from:"1",to:"2",cc:"3",bcc:"4",requiredattendees:"5",optionalattendees:"6",organizer:"7",regarding:"8",owner:"9",resources:"10",customer:"11",partner:"12"},t.participationTypeNames={1:"from",2:"to",3:"cc",4:"bcc",5:"requiredattendees",6:"optionalattendees",7:"organizer",8:"regarding",9:"owner",10:"resources",11:"customer",12:"partner"},t.defaultFieldsForCreate=[t.createdOn,t.createdBy,t.ownerId,t.modifiedOn,t.modifiedBy],t.stateAndStatusFields=[t.stateCode,t.statusCode],t.defaultFields=[t.modifiedOn,t.modifiedBy]},"9Qps":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.addBPFColumns=void 0;var o=r("pqvw"),s=r("Y0ua"),u=r("XGkY"),l=r("Z84h"),c=r("faKr"),d=r("SbZb");function p(e,t,r,i,s){return a(this,void 0,void 0,(function(){var a,p,y,h,m,b,v;return n(this,(function(n){switch(n.label){case 0:return[4,l.isFeatureEnabled(r,"EnableBPFOffline")];case 1:return n.sent()&&t&&!o.isNullOrUndefined(e)?[4,c.parseBPFRequest(e,r,s)]:[2,null];case 2:return[4,f(a=n.sent(),i,r,s)];case 3:if(p=n.sent(),o.isNullOrUndefined(p)||!p.length)return[2,null];y=[],null===a.processId||u.Guid.isNullOrEmpty(a.processId)||null===a.processInstanceId||u.Guid.isNullOrEmpty(a.processInstanceId)?p.forEach((function(e){y.push(d.retrieveBPFRecordByProcess(a.target,e,r,i,s)),i.info(g()+"  'Retriev multiple BPF instances "+JSON.stringify(a),s)})):(y.push(d.retrieveBPFRecordById(a.processInstanceId,p[0],i,r,s)),i.info(g()+" Retrieve BPF instance from "+p[0]+" "+JSON.stringify(a),s)),n.label=4;case 4:return n.trys.push([4,6,,7]),[4,Promise.all(y)];case 5:return h=n.sent(),m=new Date("1700-01-01T00:00:00Z"),b={entityLogicalName:"",id:u.Guid.EMPTY,modifiedon:m,primaryIdAttribute:"",primaryIdValue:u.Guid.EMPTY},h.forEach((function(e){if(null!==e){var t=e.modifiedon;(null===m||t>m)&&(b=e,m=t)}})),i.error(g()+" Successfully retrieved multiple BPF instances",s),[2,b];case 6:throw v=n.sent(),i.error(g()+" Error when attempting to retrieve global navigation data",s),v;case 7:return[2]}}))}))}function f(e,t,r,i){return a(this,void 0,void 0,(function(){var a,s,l,c,p,f,y;return n(this,(function(n){switch(n.label){case 0:if(o.isNullOrUndefined(e))return[2,[]];if(null===e.processId||u.Guid.isNullOrEmpty(e.processId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h(e.processId,r,t,i)];case 2:return a=n.sent(),o.isNullOrUndefinedOrEmptyString(a)?(t.warn(g()+" Unique name not found for "+e.processId,i),[2,[]]):[2,[a]];case 3:return n.sent(),t.warn(g()+" Error while retriving bpf unique names by process id "+e.processId,i),[3,4];case 4:return o.isNullOrUndefined(e.target)||o.isNullOrUndefinedOrEmptyString(e.target)?(t.warn(g()+" BPF request must have participating entity logical name",i),[2,[]]):(s=function(e){return o.isNullOrUndefined(e.AdditionalParameters)||o.isNullOrUndefined(e.AdditionalParameters.AppId)?u.Guid.EMPTY:u.Guid.tryParse(e.AdditionalParameters.AppId)}(r),l={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:e.target.entityLogicalName,MetadataId:null,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:s.guid,IsPreloadCall:!1},[4,d.retrieveMetadataByQuery(r,l,t,i)]);case 5:return c=n.sent(),o.isNullOrUndefined(c)||0===c.length?[2,[]]:(p=c[0].data,!o.isNullOrUndefined(p)&&p.SelectorItems&&(f=p.SelectorItems,!o.isNullOrUndefined(f)&&f.length>0)?(y=f.map((function(e){return e.UniqueName})),t.info(g()+" Successfully retrieve all BPF uniquenames for participating entity "+e.target),[2,y]):[2,[]])}}))}))}function y(e,t,r,s,l){return a(this,void 0,void 0,(function(){var a,c,d,p,f,y,h,b,v,E,T,_,S;return n(this,(function(n){switch(n.label){case 0:return a=[],e?[4,m(e,t,u.Guid.EMPTY,r,s,l)]:(r.info(g()+" processID is null in get business process flow control data"),[2,a]);case 1:if(c=n.sent(),o.isNullOrUndefined(c)||o.isNullOrUndefined(c.data))throw new Error("Retrieved empty BPF metadata for");d=c.data;try{for(p=i(d.BusinessProcessFlowEntities),f=p.next();!f.done;f=p.next())if((y=f.value).EntityLogicalName===t)try{for(_=void 0,h=i(y.Stage.Steps),b=h.next();!b.done;b=h.next())v=b.value,o.isNullOrUndefinedOrEmptyString(v.Name)||a.push(v.Name)}catch(e){_={error:e}}finally{try{b&&!b.done&&(S=h.return)&&S.call(h)}finally{if(_)throw _.error}}}catch(e){E={error:e}}finally{try{f&&!f.done&&(T=p.return)&&T.call(p)}finally{if(E)throw E.error}}return[2,a]}}))}))}function h(e,t,r,i){return a(this,void 0,void 0,(function(){var a,s,u,l;return n(this,(function(n){switch(n.label){case 0:a={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:"workflow",MetadataId:e.guid,MetadataNames:[],GetDefault:!1,DependencyDepth:"OnDemandWithContext",ChangedAfter:null,Exclude:[],AppId:null,IsPreloadCall:!1},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,d.retrieveMetadataByQuery(t,a,r,i)[0]];case 2:return s=n.sent(),u=null,l=s.data,o.isNullOrUndefined(l)||o.isNullOrUndefined(l.BusinessProcessFlowUniqueName)||(u=l.BusinessProcessFlowUniqueName),r.info(g()+" Successfully retrieve uniquename for BPF  "+e.guid),[2,u];case 3:return n.sent(),[2,null];case 4:return[2]}}))}))}function m(e,t,r,i,o,s){return a(this,void 0,void 0,(function(){var c;return n(this,(function(d){switch(d.label){case 0:return u.Guid.isNullOrEmpty(e)?(t&&r||i.error(g()+" The entityLogicalName must be either Workflow or participating entity name."),[4,l.isFeatureEnabled(o,"EnableBPFOffline")]):[3,2];case 1:return d.sent()?(c=function(e,t,r,i){return a(this,void 0,void 0,(function(){var a,o;return n(this,(function(n){switch(n.label){case 0:return[4,b(t,r,i)];case 1:if(a=n.sent(),!(o=a.data)||!o.SelectorItems||!o.SelectorItems[0]||u.Guid.isNullOrEmpty(o.SelectorItems[0].Id))throw t.error(g()+" unable to find default BPF step for "+e,i),new Error("Unable to find default bpf step for "+e);return[2,v("workflow",o.SelectorItems[0].Id,t,r,i)]}}))}))}(t,i,o,s),[3,3]):[2,Promise.resolve(null)];case 2:c=v(t="workflow",e,i,o,s),d.label=3;case 3:return[4,c];case 4:return[2,d.sent()]}}))}))}function b(e,t,r){return a(this,void 0,void 0,(function(){var a,i;return n(this,(function(n){switch(n.label){case 0:return a={MetadataType:"bpfselector",MetadataSubtype:null,EntityLogicalName:null,MetadataId:null,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},[4,d.retrieveMetadataByQuery(t,a,e,r)];case 1:if(i=n.sent(),o.isNullOrUndefined(i)||0===i.length)throw e.error(g()+" error when fetching bpf selector",r),new Error("error when fetching bpf selector");return[2,i[0]]}}))}))}function v(e,t,r,i,s){return a(this,void 0,void 0,(function(){var e,a;return n(this,(function(n){switch(n.label){case 0:return e={MetadataType:"businessprocessflow",MetadataSubtype:null,EntityLogicalName:null,MetadataId:t.guid,GetDefault:!1,DependencyDepth:"OnDemandWithoutContext",ChangedAfter:null,Exclude:[],MetadataNames:[],AppId:null,IsPreloadCall:!1},[4,d.retrieveMetadataByQuery(i,e,r,s)];case 1:if(a=n.sent(),o.isNullOrUndefined(a)||0===a.length)throw r.error(g()+" error when fetching bpf",s),new Error("error when fetching bpf");return[2,a[0]]}}))}))}function g(e){return e?"["+e+"]":"["+s.FILE_PREFIX.RetrieveGenerator+"]"}t.addBPFColumns=function(e,t,r,s,l,c,d){return a(this,void 0,void 0,(function(){var a,f,h,m,b,v,E,T;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,p(r,!!s.IsBusinessProcessEnabled&&s.IsBusinessProcessEnabled,l,c,d)];case 1:return a=n.sent(),[4,y(o.isNullOrUndefined(a)||u.Guid.isNullOrEmpty(a.id)?null:a.id,e,c,l,d)];case 2:if(f=n.sent(),!o.isNullOrUndefined(f)&&f.length)try{for(h=i(f),m=h.next();!m.done;m=h.next())b=m.value,-1===t.indexOf(b)&&t.push(b)}catch(e){E={error:e}}finally{try{m&&!m.done&&(T=h.return)&&T.call(h)}finally{if(E)throw E.error}}return[2,a];case 3:return v=n.sent(),c.error(g()+" something went wrong when adding BPF columns "+v.message,d),[2,null];case 4:return[2]}}))}))}},"Ag5+":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},l=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.populateDefaultFieldsForOperation=t.populateRecordWithData=t.getInsertActivityPartySQLQueryRequests=t.appendRetrieveQuery=t.getColumnsFromRequestJSON=t.getEntityIdFromUrl=t.getEntityNameFromUrl=t.extractAdditionalColumnNames=t.getFieldSQLRepresentation=t.isRegularActivityObject=t.createEntityRecord=t.isSpecialAttribute=t.getAttributeName=void 0;var d=r("bOB9"),p=r("pqvw"),f=r("ZRE3"),y=r("Y0ua"),h=r("i2et"),m=r("XGkY"),b=r("Z84h"),v=r("cVT3"),g=r("N6bD"),E=i(r("88gK")),T=r("kwGv"),_=r("VDnG"),S=r("wNBc"),O=r("YoDU");function N(e,t,r,a,n,i,u,l){return void 0===l&&(l={}),o(this,void 0,void 0,(function(){var a,o,c,d,f,y,m,v,g,S,N;return s(this,(function(s){switch(s.label){case 0:a=0,s.label=1;case 1:if(!(a<t.columnNames.length))return[3,10];if(o=M(t.columnNames[a]),r[o]!==h.AttributeType.PartyList)return[3,4];if(p.isNullOrUndefined(e.activityParties)&&(e.activityParties=[]),null===(y=t.columnValues[a].match(/([a-z_]+)\((.*)\)/i)))throw m="Parsing a party list attribute "+t.columnNames[a]+" failed: "+t.columnValues[a],i.error(k()+" "+m,u),new Error(m);return[4,b.getEntityLogicalName(n,y[1],u)];case 2:return c=s.sent(),f=(d=e.activityParties).push,N={partyId:y[2]},[4,_.getPartyName(n,c,y[2],l)];case 3:return f.apply(d,[(N.partyName=s.sent(),N.partyLogicalName=c,N.participationType=E.participationTypeValue[o],N)]),[3,9];case 4:return r[o]!==h.AttributeType.Owner&&r[o]!==h.AttributeType.Lookup&&r[o]!==h.AttributeType.Customer?[3,8]:t.columnValues[a]&&""!==t.columnValues[a].trim()?[3,5]:(O.setFieldValue(e,o+E.columnDelimiter+E.id,T.DEFAULT.EmptyString,h.AttributeType.UniqueIdentifier),O.setFieldValue(e,o+E.columnDelimiter+E.logicalName,T.DEFAULT.EmptyString,h.AttributeType.String),O.setFieldValue(e,o+E.columnDelimiter+E.name,T.DEFAULT.EmptyString,h.AttributeType.String),[3,7]);case 5:if(null===(y=t.columnValues[a].match(/([a-z_]+)\((.*)\)(\/(.*)):?/i)))throw m="Parsing a lookup or customer reference attribute "+t.columnNames[a]+" failed: "+t.columnValues[a],i.error(k()+" "+m,u),new Error(m);return O.setFieldValue(e,o+E.columnDelimiter+E.id,D(h.AttributeType.UniqueIdentifier,y[2]),h.AttributeType.UniqueIdentifier),v=O.setFieldValue,g=[e,o+E.columnDelimiter+E.logicalName],[4,b.getEntityLogicalName(n,y[1],u)];case 6:v.apply(void 0,g.concat([s.sent(),h.AttributeType.String])),S=T.DEFAULT.EmptyString,5!==y.length||p.isNullOrUndefinedOrEmptyString(y[4])?i.warn("{"+k()+"} Display name not passed for "+o+" of type "+r[o]+". Setting it as empty string",u):S=y[4],O.setFieldValue(e,o+E.columnDelimiter+E.name,S,h.AttributeType.String),s.label=7;case 7:return[3,9];case 8:O.setFieldValue(e,o,D(r[o],t.columnValues[a]),r[o]),s.label=9;case 9:return a++,[3,1];case 10:return[2,e]}}))}))}function M(e){var t=e;return e.startsWith("_")&&e.endsWith("_value")&&(t=e.substr(1,e.length-7)),t}function P(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,u,l;return s(this,(function(s){switch(s.label){case 0:return n={},[4,b.getAttributesMetadata(r,e,t,a)];case 1:for(o in i=s.sent())p.isNullOrUndefined(i[o])||((u=i[o]).Type!==h.AttributeType.Boolean||p.isNullOrUndefined(u.DefaultValue)?u.Type!==h.AttributeType.PickList||p.isNullOrUndefined(u.DefaultFormValue)||-1!==(l=u.DefaultFormValue)&&(n[u.LogicalName]=l):u.DefaultValue?n[u.LogicalName]=1:n[u.LogicalName]=0);return[2,n]}}))}))}function w(e,t,r,a,n,i){return void 0===n&&(n=[]),void 0===i&&(i={}),o(this,void 0,void 0,(function(){var o,u,d,f,y,m,g,_,N,M,P,w,I,A,D,L,F,x,k,U,q,V,B,Q,G,H,j,Y,K;return s(this,(function(s){switch(s.label){case 0:if(o=[],t===T.SqlOperation.create){(u=E.defaultFieldsForCreate).push.apply(u,l(E.stateAndStatusFields)),(d=u.indexOf(E.ownerId))>=0&&!p.isNullOrUndefined(r)&&!p.isNullOrUndefined(r.OwnershipType)&&r.OwnershipType.valueOf()===v.OwnershipTypes.OrganizationOwned&&u.splice(d,1);try{for(f=c(u),y=f.next();!y.done;y=f.next())m=y.value,e.values[m]||o.push(m)}catch(e){Q={error:e}}finally{try{y&&!y.done&&(G=f.return)&&G.call(f)}finally{if(Q)throw Q.error}}!p.isNullOrUndefined(r)&&r.IsActivity&&(e.values[E.activityTypeCode]||O.setFieldValue(e,E.activityTypeCode,r.EntityLogicalName,h.AttributeType.String),e.values[E.isRegularActivity]||O.setFieldValue(e,E.isRegularActivity,R(r.ObjectTypeCode,r.ActivityTypeMask)?"1":"0",h.AttributeType.Boolean))}if(t!==T.SqlOperation.create&&t!==T.SqlOperation.update)return[3,8];try{for(g=c(E.defaultFields),_=g.next();!_.done;_=g.next())N=_.value,e.values[N]||(o[o.length]=N)}catch(e){H={error:e}}finally{try{_&&!_.done&&(j=g.return)&&j.call(g)}finally{if(H)throw H.error}}return[4,b.getAttributesMetadata(a,e.entityLogicalName,[],n)];case 1:if(M=s.sent(),p.isNullOrUndefined(M)||!function(e,t){if(e[t])return!0;return!1}(M,E.fullName))return[3,7];for(w in P=[],e.values)P.push(w);I=0,s.label=2;case 2:return I<P.length?(A=P[I],E.fullNameComponents.indexOf(A)>=0&&!e.values[E.fullName]?(D={},t!==T.SqlOperation.update?[3,4]:[4,C(a,e,r,i,n)]):[3,6]):[3,7];case 3:D=s.sent(),s.label=4;case 4:return D[E.firstName]=p.isNullOrUndefinedOrEmptyString(e.values[E.firstName])?D[E.firstName]:e.values[E.firstName],D[E.middleName]=p.isNullOrUndefinedOrEmptyString(e.values[E.middleName])?D[E.middleName]:e.values[E.middleName],D[E.lastName]=p.isNullOrUndefinedOrEmptyString(e.values[E.lastName])?D[E.lastName]:e.values[E.lastName],L=O.setFieldValue,F=[e,E.fullName],x=S.generateFullName,[4,b.getfullnameconventioncode(a,n)];case 5:return L.apply(void 0,F.concat([x.apply(void 0,[s.sent(),D[E.firstName],D[E.middleName],D[E.lastName]]),h.AttributeType.String])),[3,7];case 6:return I++,[3,2];case 7:if(t===T.SqlOperation.create){k=Object.keys(M);try{for(U=c(k),q=U.next();!q.done;q=U.next())V=q.value,M[V]&&(B=M[V],(!p.isNullOrUndefined(B.DefaultValue)||!p.isNullOrUndefined(B.DefaultFormValue))&&p.isNullOrUndefined(e.values[B.LogicalName])&&o.indexOf(B.LogicalName)<0&&(o[o.length]=B.LogicalName))}catch(e){Y={error:e}}finally{try{q&&!q.done&&(K=U.return)&&K.call(U)}finally{if(Y)throw Y.error}}}return[2,o];case 8:return[2,o]}}))}))}function C(e,t,r,a,n){return void 0===a&&(a={}),void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var i,o,u,l;return s(this,(function(s){switch(s.label){case 0:i=e.TraceManager.getTracer(y.COMPONENT_NAMES.SQLGenerator),o={sqlStatements:[T.CLAUSE.select+T.Punctuation.space+E.firstName+T.Punctuation.comma+E.middleName+T.Punctuation.comma+E.lastName+T.Punctuation.space+T.CLAUSE.from+T.Punctuation.space+t.entityLogicalName+T.Punctuation.space+T.CLAUSE.where+T.Punctuation.space+r.PrimaryIdAttribute+T.Punctuation.equal+T.CLAUSE.placeholder],sqlParameters:[[t.id.guid]]},s.label=1;case 1:return s.trys.push([1,3,,4]),[4,g.ExecuteSQLBatch(o,e,void 0,a)];case 2:return u=s.sent(),p.isNullOrUndefined(u)||1!==u.length?[3,4]:[2,u[0].rows.item(0)];case 3:return l=s.sent(),i.error(k()+" Unable to get name parts for "+t.entityLogicalName+" from DB. Error: "+l.errorMessage,n),[3,4];case 4:return[2,{}]}}))}))}function I(e,t,r,a,n,i){return void 0===n&&(n=[]),void 0===i&&(i={}),o(this,void 0,void 0,(function(){var o;return s(this,(function(s){switch(s.label){case 0:return[4,w(t,a,r,e,n,i)];case 1:return o=s.sent(),[4,A(t,o,r,e,n)];case 2:return[2,t=s.sent()]}}))}))}function A(e,t,r,a,n){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var i,o,u,l,c,d;return s(this,(function(f){switch(f.label){case 0:return[4,b.getAttributesMetadata(a,e.entityLogicalName,t,n)];case 1:for(l in i=f.sent(),o=function(o){var u,l,c,d,f,y,m;return s(this,(function(s){switch(s.label){case 0:if(p.isNullOrUndefined(i[o]))return[2,"continue"];if(u=i[o],p.isNullOrUndefined(u))return[2,"continue"];switch(u.LogicalName){case E.stateCode:return[3,1];case E.statusCode:return[3,2];case E.createdOn:case E.modifiedOn:return[3,3];case E.createdBy:case E.modifiedBy:case E.ownerId:return[3,4]}return[3,8];case 1:return r.HasStateCode&&O.setFieldValue(e,u.LogicalName,p.isNullOrUndefined(u.DefaultFormValue)?0:u.DefaultFormValue,h.AttributeType.State),-1===t.indexOf(E.statusCode)||p.isNullOrUndefined(e.values[E.stateCode])||(l=e.values[E.stateCode][E.value],c=0,u&&u.OptionSet&&Object.keys(u.OptionSet).length>0&&(d=u.OptionSet.find((function(e){return e.Value===l})),f=d?d.DefaultStatus:0,c=f),O.setFieldValue(e,E.statusCode,c,h.AttributeType.Status)),[3,9];case 2:return[3,9];case 3:return O.setFieldValue(e,u.LogicalName,new Date(Date.now()),h.AttributeType.DateTime),[3,9];case 4:return u.LogicalName!==E.ownerId||!p.isNullOrUndefined(r.OwnershipType)&&r.OwnershipType.valueOf()===v.OwnershipTypes.UserOwned?[4,b.getUserId(a,n)]:[3,7];case 5:return y=s.sent(),[4,b.getUserName(a,n)];case 6:if(m=s.sent(),p.isNullOrUndefinedOrEmpty(y))throw new Error("User ID fetched from metadata cache was empty");if(p.isNullOrUndefinedOrEmpty(m))throw new Error("User Name fetched from metadata cache was empty");O.setFieldValue(e,u.LogicalName+E.columnDelimiter+E.id,p.isNullOrUndefinedOrEmpty(y)?null:y,h.AttributeType.UniqueIdentifier),O.setFieldValue(e,u.LogicalName+E.columnDelimiter+E.logicalName,E.systemUser,h.AttributeType.String),O.setFieldValue(e,u.LogicalName+E.columnDelimiter+E.name,p.isNullOrUndefinedOrEmpty(m)?null:m,h.AttributeType.String),s.label=7;case 7:return[3,9];case 8:return u.Type!==h.AttributeType.PickList||p.isNullOrUndefined(u.DefaultFormValue)||O.setFieldValue(e,u.LogicalName,u.DefaultFormValue,u.Type),u.Type||!u.DefaultFormValue&&!u.DefaultValue||O.setFieldValue(e,u.LogicalName,p.isNullOrUndefined(u.DefaultFormValue)?u.DefaultValue?1:0:u.DefaultFormValue,u.Type),[3,9];case 9:return[2]}}))},u=[],i)u.push(l);c=0,f.label=2;case 2:return c<u.length?(d=u[c],[5,o(d)]):[3,5];case 3:f.sent(),f.label=4;case 4:return c++,[3,2];case 5:return[2,e]}}))}))}function R(e,t){switch(e){case T.OpportunityClose:case T.OrderClose:case T.QuoteClose:case T.IncidentResolution:case T.BulkOperation:case T.RecurringAppointmentMaster:return!1;default:return!!t}}function D(e,t){switch(e){case h.AttributeType.UniqueIdentifier:return m.Guid.parse(t).guid;case h.AttributeType.PickList:case h.AttributeType.State:case h.AttributeType.Status:return t;case h.AttributeType.Boolean:return!0===t?"1":"0";case h.AttributeType.DateTime:return t;case h.AttributeType.PartyList:throw Error("No SQL representation for party list");case h.AttributeType.Owner:case h.AttributeType.Lookup:case h.AttributeType.Customer:throw Error("No SQL representation for complex types");default:return t}}function L(e){switch(e){case h.AttributeType.PickList:return null;default:return T.DEFAULT.EmptyString}}function F(e,t,r,a,n,i){var o,s,u=t[e];n.info(k+" Found "+u.length+" activity parties",i);try{for(var l=c(u),d=l.next();!d.done;d=l.next()){var p=d.value;for(var f in p)f.indexOf("@odata.bind")>0?a.push(p[f]):"participationtypemask"===f&&r.push(E.participationTypeNames[p[f]])}}catch(e){o={error:e}}finally{try{d&&!d.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}function x(e,t,r,a,n,i,o,s){var u=e.split("@odata.bind")[0],l=p.isNullOrUndefinedOrEmptyString(t[e])?t[e]:t[e]+"/"+(t[u+"@OData.Community.Display.V1.FormattedValue"]||T.DEFAULT.EmptyString),c=!1;if(r&&r.ManyToOneRelationships)for(var y in r.ManyToOneRelationships){var h=r.ManyToOneRelationships[y];if(h.ReferencingEntityNavigationPropertyName===u&&h.ReferencingAttribute){n.push(h.ReferencingAttribute),i.push(l),c=!0;break}}if(!c){var m=new f.LocalError(k()+" No navigation properties found for attribute "+u+" in entity "+r.EntityLogicalName,d.ErrorCode.UnknownBadRequestError,(new Error).stack);throw o.error(m.message,s),m}}function k(e){return e?"["+e+"]":"["+y.FILE_PREFIX.Common+"]"}t.createEntityRecord=function(e,t,r,a,n,i,u){return void 0===u&&(u={}),o(this,void 0,void 0,(function(){var o,l,c,d,f,y,h,v,g;return s(this,(function(s){switch(s.label){case 0:return[4,b.getAttributeTypes(a,[],e,i)];case 1:return o=s.sent(),[4,P(e,[],a,i)];case 2:return l=s.sent(),[4,N(c={id:m.Guid.newGuid(),entityLogicalName:e,attributeTypes:o,values:l},t,o,r,a,n,i,u)];case 3:return c=s.sent(),[4,b.getEntityMetadata(a,e)];case 4:return d=s.sent(),[4,I(a,c,d,r,i,u)];case 5:if(c=s.sent(),e===T.AnnotationEntityLogicalName&&r===T.SqlOperation.create&&Object.keys(c.values).indexOf(E.objectId)>=0&&(f=c.values[E.objectId],p.isNullOrUndefined(f)||(c.values[E.objectTypeCode]=f)),c.values[E.versionNumber]="0",r!==T.SqlOperation.create)return[3,8];if(!d.PrimaryIdAttribute)throw y="entity metadata does not have primary id attribute",n.error(k()+" "+y,i),new Error(y);return d.PrimaryIdAttribute in c.values||(c.values[d.PrimaryIdAttribute]=c.id.guid),p.isNullOrUndefined(d)||!d.IsActivity?[3,8]:(p.isNullOrUndefined(c.activityParties)&&(c.activityParties=[]),v=(h=c.activityParties).push,g={},[4,b.getUserId(a,i)]);case 6:return g.partyId=s.sent(),[4,b.getUserName(a,i)];case 7:v.apply(h,[(g.partyName=s.sent(),g.partyLogicalName=E.systemUser,g.participationType=E.participationTypeValue.owner,g)]),s.label=8;case 8:return[2,c]}}))}))},t.populateRecordWithData=N,t.getAttributeName=M,t.populateDefaultFieldsForOperation=I,t.isRegularActivityObject=R,t.getFieldSQLRepresentation=D,t.extractAdditionalColumnNames=function(e){return e.split(",")},t.getEntityNameFromUrl=function(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o;return s(this,(function(s){switch(s.label){case 0:if(!e)throw r.error(k()+" Error when attempting to extract entity name from URL",a),new Error("Empty url is not valid");return n=e.split("/"),i=n[n.length-1].split("(")[0],o=i.split("?")[0],[4,b.getEntityLogicalName(t,o,a)];case 1:return[2,s.sent()]}}))}))},t.getEntityIdFromUrl=function(e,t,r){if(void 0===r&&(r=[]),!e)throw t.error(k()+" Error when attempting to extract entity name from URL",r),new Error("Empty url is not valid");var a=e.split("/"),n=a[a.length-1].split("(")[1];if(p.isNullOrUndefinedOrEmptyString(n))return null;var i=n.split(")")[0];return m.Guid.parse(i)},t.getColumnsFromRequestJSON=function(e,t,r,a,n,i){return void 0===i&&(i=[]),o(this,void 0,void 0,(function(){var o,u,l,c,d;return s(this,(function(s){switch(s.label){case 0:if(p.isNullOrUndefinedOrEmptyString(e)||p.isNullOrUndefinedOrEmpty(t))throw"Invalid request. Empty request body",n.error(k()+" Invalid request. Empty request body",i),new Error("Invalid request. Empty request body");return o=JSON.parse(e),u=[],l=[],[4,b.getEntityMetadata(a,r)];case 1:for(d in c=s.sent(),o)d.indexOf("@odata.bind")>0?x(d,o,c,t,u,l,n,i):d.indexOf("activity_parties")>0?F(d,o,u,l,n,i):-1===d.toLowerCase().indexOf("@odata")&&(u.push(d),l.push(p.isNullOrUndefined(o[d])?L(t[d]):o[d]));return[2,{columnNames:u,columnValues:l}]}}))}))},t.appendRetrieveQuery=function(e,t,r,a,n,i){void 0===i&&(i=[]);var o=e.TraceManager.getTracer(y.COMPONENT_NAMES.SQLGenerator);if(p.isNullOrUndefinedOrEmptyString(n)||m.Guid.equals(a,m.Guid.EMPTY))return o.error(k()+" Invalid parameters when creating query for "+d.HEADER_VALUES.PREFER_REPRESENTATION,i),t;var s="select * from "+r+" where "+n+"=?";t.sqlStatements.push(s);var u=[];return u.push(a.guid.toString()),t.sqlParameters.push(u),t},t.getInsertActivityPartySQLQueryRequests=function(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,u,l,d,f;return s(this,(function(s){switch(s.label){case 0:return p.isNullOrUndefined(t.activityParties)?[3,2]:[4,b.getAttributesMetadata(e,E.activityParty,[E.isPartyDeleted],a)];case 1:n=s.sent(),i=p.isNullOrUndefined(n)||p.isNullOrUndefined(n[E.isPartyDeleted])?"0":n[E.isPartyDeleted].DefaultValue?"1":"0";try{for(o=c(t.activityParties),u=o.next();!u.done;u=o.next())l=u.value,r.sqlStatements.push(T.CLAUSE.insert+T.Punctuation.space+T.CLAUSE.into+T.Punctuation.space+T.Punctuation.openSQBracket+E.activityParty+T.Punctuation.closeSQBracket+T.Punctuation.space+T.Punctuation.openParenthesis+T.Punctuation.openSQBracket+E.activityPartyId+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.activityId+T.Punctuation.exclamation+E.id+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.activityId+T.Punctuation.exclamation+E.name+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.activityId+T.Punctuation.exclamation+E.logicalName+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.participationMasks+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.partyId+T.Punctuation.exclamation+E.id+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.partyId+T.Punctuation.exclamation+E.name+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.partyId+T.Punctuation.exclamation+E.logicalName+T.Punctuation.closeSQBracket+T.Punctuation.comma+T.Punctuation.openSQBracket+E.isPartyDeleted+T.Punctuation.closeSQBracket+T.Punctuation.closeParenthesis+T.Punctuation.space+T.CLAUSE.values+T.Punctuation.space+T.Punctuation.openParenthesis+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.comma+T.Punctuation.question+T.Punctuation.closeParenthesis),r.sqlParameters.push([m.Guid.newGuid().guid,t.id.guid,p.isNullOrUndefinedOrEmptyString(t.values[E.name])?"":t.values[E.name],t.entityLogicalName,l.participationType,l.partyId,l.partyName,l.partyLogicalName,i])}catch(e){d={error:e}}finally{try{u&&!u.done&&(f=o.return)&&f.call(o)}finally{if(d)throw d.error}}s.label=2;case 2:return[2,r]}}))}))},t.isSpecialAttribute=function(e,t,r,a,n){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var i,o;return s(this,(function(s){switch(s.label){case 0:return[4,b.getAttributesMetadata(e,t,[],n)];case 1:return i=s.sent(),p.isNullOrUndefinedOrEmpty(i)?(o="Unable to get attribute metadata descriptor that associated to entity: "+t,a.warn(k()+" "+o,n),[2,Promise.reject(o)]):!i[r]||i[r].Type!==h.AttributeType.Lookup&&i[r].Type!==h.AttributeType.Customer&&i[r].Type!==h.AttributeType.Owner?[2,!1]:[2,!0]}}))}))}},Co9g:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataClient=void 0;var a=r("h2cw"),n=r("0X9q"),i=r("HSxJ"),o=r("xeDM"),s=r("bxig"),u=r("K2G/"),l=function(){function e(e,t){this.applicationContext=t,this._timeout=e&&e.timeout||3e5,this._policyManager=e&&e.PolicyManager||new a.PolicyManager(this.applicationContext),this._retryCount=e&&e.RetryCount||3,this._promiseCache=new n.PromiseCache(this.applicationContext),this._customizedInterceptors=[],this.interceptors=[]}return e.prototype.build=function(){return this.interceptors.push(new s.PromiseCacheInterceptor(this._promiseCache,this.applicationContext)),this.interceptors.push(new u.TimeoutInterceptor(this._timeout,this.applicationContext)),this.interceptors=this.interceptors.concat(this._customizedInterceptors),this.interceptors.push(new o.PolicyRetryInterceptor(this._policyManager,this._retryCount,this.applicationContext)),this.interceptors.push(this.executeRequestInterceptor),this},e.prototype.describe=function(){var e=[];return this.interceptors.forEach((function(t){e.push(t.constructor.name)})),e},e.prototype.setExecuteRequestInterceptor=function(e){return this.executeRequestInterceptor=e,this},e.prototype.addInterceptor=function(e){return this._customizedInterceptors.push(e),this},e.prototype.execute=function(e,t){return new i.Chain(this.applicationContext,this.interceptors,e,0,t).proceed()},e}();t.ODataClient=l},Ct6E:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.QueriedMetadataType=t.MetadataSubtype=t.MetadataType=t.ApplicationMetadataType=void 0,function(e){e[e.all=0]="all",e[e.systemApplicationMetadata=1]="systemApplicationMetadata",e[e.userApplicationMetadata=2]="userApplicationMetadata"}(a||(a={})),t.ApplicationMetadataType=a,function(e){e[e.none=0]="none",e[e.workspace=1]="workspace",e[e.form=2]="form",e[e.component=3]="component",e[e.entityCard=4]="entityCard",e[e.quickCreateForm=5]="quickCreateForm",e[e.customization=6]="customization",e[e.listQuery=7]="listQuery",e[e.grid=8]="grid",e[e.command=9]="command",e[e.siteMap=10]="siteMap",e[e.list=11]="list",e[e.dialog=12]="dialog",e[e.gridForm=13]="gridForm",e[e.inlineCreateForm=14]="inlineCreateForm",e[e.processControl=15]="processControl",e[e.fetchXml=16]="fetchXml",e[e.chartDrilldownForm=17]="chartDrilldownForm",e[e.entity=18]="entity",e[e.attribute=19]="attribute",e[e.webResource=20]="webResource",e[e.applicationMetadata=21]="applicationMetadata",e[e.mainFormDialog=22]="mainFormDialog",e[e.chart=23]="chart",e[e.uiStrings=24]="uiStrings",e[e.businessLogic=25]="businessLogic",e[e.searchPage=26]="searchPage",e[e.globalApplicationMetadata=27]="globalApplicationMetadata",e[e.applicationMetadataUserContext=28]="applicationMetadataUserContext",e[e.staticJSFile=29]="staticJSFile",e[e.layoutXml=30]="layoutXml",e[e.draftsPage=31]="draftsPage",e[e.duplicateRecordsPage=32]="duplicateRecordsPage",e[e.applicationMetadataSettings=33]="applicationMetadataSettings",e[e.senderFormPage=34]="senderFormPage",e[e.setRegarding=35]="setRegarding",e[e.senderCreateFormPage=36]="senderCreateFormPage",e[e.interactionCentricWorkspace=37]="interactionCentricWorkspace",e[e.taskBasedFlowGlobalMenu=38]="taskBasedFlowGlobalMenu",e[e.taskBasedFlow=39]="taskBasedFlow",e[e.interactionCentricForm=40]="interactionCentricForm",e[e.cardForm=41]="cardForm",e[e.controlConfiguration=42]="controlConfiguration",e[e.commandXaml=43]="commandXaml",e[e.documentTemplate=44]="documentTemplate",e[e.viewSelector=45]="viewSelector",e[e.customControl=46]="customControl",e[e.formSelector=47]="formSelector",e[e.resourceString=48]="resourceString",e[e.savedQueryVisualization=49]="savedQueryVisualization",e[e.label=50]="label",e[e.userView=51]="userView",e[e.savedView=52]="savedView",e[e.viewDefault=53]="viewDefault",e[e.homePageConfiguration=54]="homePageConfiguration",e[e.optionSet=56]="optionSet",e[e.quickCreateMenu=57]="quickCreateMenu",e[e.userContext=58]="userContext",e[e.businessProcessFlow=59]="businessProcessFlow",e[e.searchConfiguration=60]="searchConfiguration",e[e.userQueryVisualization=61]="userQueryVisualization",e[e.visualizationSelector=62]="visualizationSelector",e[e.dashboardSelector=63]="dashboardSelector",e[e.overallMetadataVersion=64]="overallMetadataVersion",e[e.appModule=65]="appModule",e[e.complexControl=66]="complexControl",e[e.displayString=67]="displayString",e[e.webResourceDescriptor=68]="webResourceDescriptor",e[e.isActivityFlags=69]="isActivityFlags",e[e.appModuleOfflineMetadata=70]="appModuleOfflineMetadata",e[e.appModuleSelector=71]="appModuleSelector",e[e.bpfSelector=72]="bpfSelector",e[e.dependencies=73]="dependencies"}(n||(n={})),t.MetadataType=n,function(e){e.entity="entity",e.savedView="savedview",e.form="form",e.workspace="workspace",e.systemWorkspace="systemworkspace",e.userWorkspace="userworkspace",e.savedVisualization="savedvisualization",e.dialog="dialog",e.taskBasedFlow="taskbasedflow",e.customControl="customcontrol",e.complexControl="complexcontrol",e.formSelector="formselector",e.viewSelector="viewselector",e.ribbon="ribbon"}(i||(i={})),t.QueriedMetadataType=i,function(e){e[e.none=0]="none",e[e.main=1]="main",e[e.appointment=2]="appointment",e[e.hardcoded=3]="hardcoded",e[e.miniCampaignBO=4]="miniCampaignBO",e[e.preview=5]="preview",e[e.dashboard=6]="dashboard",e[e.quick=7]="quick",e[e.quickCreate=8]="quickCreate",e[e.mobile=9]="mobile",e[e.read=10]="read",e[e.card=11]="card",e[e.dialog=12]="dialog",e[e.taskBased=14]="taskBased",e[e.interactionCentricDashboard=15]="interactionCentricDashboard",e[e.advancedSearch=16]="advancedSearch",e[e.subGrid=17]="subGrid",e[e.quickFindSearch=18]="quickFindSearch",e[e.reporting=19]="reporting",e[e.offlineFilters=20]="offlineFilters",e[e.maSearch=21]="maSearch",e[e.lookup=22]="lookup",e[e.smAppointmentBook=23]="smAppointmentBook",e[e.outlookFilters=24]="outlookFilters",e[e.addressbookFilters=25]="addressbookFilters",e[e.savedQueryTypeOther=26]="savedQueryTypeOther",e[e.interactiveWorkFlow=27]="interactiveWorkFlow",e[e.offlineTemplate=28]="offlineTemplate",e[e.outlookTemplate=29]="outlookTemplate",e[e.customDefined=30]="customDefined",e[e.jScript=31]="jScript",e[e.css=32]="css",e[e.png=33]="png",e[e.jpg=34]="jpg",e[e.gif=35]="gif",e[e.advancedFind=36]="advancedFind"}(o||(o={})),t.MetadataSubtype=o},E2wc:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ODataClientManager=void 0;var a=r("bOB9"),n=r("r9V9"),i=r("pqvw"),o=r("Y0ua"),s=r("rPIE"),u=r("rLPd"),l=function(){function e(e,t){this._remoteODataClient=new u.RemoteODataClientManager(e,t),this._localODataClient=new s.LocalODataClientManager(e,t),this._applicationContext=t}return e.prototype.getODataClient=function(e){var t=this._applicationContext.TraceManager.getTracer(o.COMPONENT_NAMES.ODataExecutor),r=[];return n.addRequestDetailsToEventParameters(e,r),i.getClientType(e,t,r)===a.CLIENT_TYPE.local?(t.warn(this.getODataClientManagerPrefix()+" Execute request with local ODataClient",r),this._localODataClient.getLocalODataClient(e,r)):(t.warn(this.getODataClientManagerPrefix()+" Execute request with remote ODataClient",r),this._remoteODataClient.getRemoteODataClient(e))},e.prototype.getODataClientManagerPrefix=function(e){return e?"["+e+"]":"["+o.FILE_PREFIX.ODataClientManager+"]"},e}();t.ODataClientManager=l},Euvu:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpExecuteInterceptor=void 0;var s=r("r9V9"),u=r("pqvw"),l=r("Y0ua"),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.execute=function(e){return i(this,void 0,void 0,(function(){var t,r,a,n,i,c,d,p;return o(this,(function(o){switch(o.label){case 0:if(t=new Headers,r=e.additionalHeaders,a=this.applicationContext.TraceManager.getTracer(l.COMPONENT_NAMES.RemoteODataExecutor),n=[],s.addRequestDetailsToEventParameters(e,n),r)for(i in r)u.getHttpHeader(t,i)&&t.delete(i),t.append(i,r[i]);c=new Request(e.url,{method:e.method,credentials:"same-origin",headers:t,body:e.body}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(c)];case 2:return[2,o.sent()];case 3:return d=o.sent(),p=d&&d.message?d.message:"failed to fetch",d.message=p,s.addErrorInformationToEventParameters(d,n),a.error(this.getHttpExecutorInterceptorPrefix()+" "+p,n),[2,u.buildODataResponseFromError(d,e.url)];case 4:return[2]}}))}))},t.prototype.getHttpExecutorInterceptorPrefix=function(e){return e?"["+e+"]":"["+l.FILE_PREFIX.HttpExecutorInterceptor+"]"},t}(r("kPQX").ExecuteRequestInterceptor);t.HttpExecuteInterceptor=c},FhB6:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.select=void 0;var o=r("r9V9"),s=r("pqvw"),u=r("Y0ua"),l=r("Ag5+"),c=r("kwGv");function d(e,t,r,o,s,u){return void 0===u&&(u=[]),a(this,void 0,void 0,(function(){var a,d,p,f,y,h,m,b;return n(this,(function(n){switch(n.label){case 0:n.trys.push([0,5,6,7]),a=i(r),d=a.next(),n.label=1;case 1:return d.done?[3,4]:(p=d.value,t.length>0&&(t+=c.Punctuation.comma+c.Punctuation.space+c.Punctuation.doubleQuote),[4,l.isSpecialAttribute(e,o,p,s,u)]);case 2:f=n.sent(),y=o+"0",f?t=function(e,t,r){for(var a=["id","logicalname","name"],n=0;n<a.length;n++){var i=""+r+c.Punctuation.exclamation+a[n];e+=t+c.Punctuation.doubleQuote+c.Punctuation.dot+c.Punctuation.openSQBracket+i+c.Punctuation.closeSQBracket+c.Punctuation.space+c.CLAUSE.as+c.Punctuation.space+c.Punctuation.doubleQuote+i+c.Punctuation.doubleQuote,n<a.length-1&&(e+=c.Punctuation.comma+c.Punctuation.space+c.Punctuation.doubleQuote)}return e}(t,y,p):t+=y+c.Punctuation.doubleQuote+c.Punctuation.dot+c.Punctuation.openSQBracket+p+c.Punctuation.closeSQBracket+c.Punctuation.space+c.CLAUSE.as+c.Punctuation.space+c.Punctuation.doubleQuote+p+c.Punctuation.doubleQuote,n.label=3;case 3:return d=a.next(),[3,1];case 4:return[3,7];case 5:return h=n.sent(),m={error:h},[3,7];case 6:try{d&&!d.done&&(b=a.return)&&b.call(a)}finally{if(m)throw m.error}return[7];case 7:return[2,t]}}))}))}function p(e){return e?"["+e+"]":"["+u.FILE_PREFIX.ApplySelectSQLGenerator+"]"}t.select=function(e,t,r,i,u,l){return void 0===l&&(l=[]),a(this,void 0,void 0,(function(){var a,f,y,h,m,b,v,g,E;return n(this,(function(n){switch(n.label){case 0:if((a=[]).push({name:"SQLStatement",value:t}),a.push({name:"columnNames",value:r?r.toString():""}),s.isNullOrUndefinedOrEmptyString(t)||!r||0===r.length)throw u.error(p()+" "+c.ERROR_STRING.invalidParameter,o.addEventParameters(l,a)),new Error(c.ERROR_STRING.invalidParameter);if(f=t.lastIndexOf(c.OFFLINE_SQL_TOKEN.SELECT_START),y=t.lastIndexOf(c.OFFLINE_SQL_TOKEN.SELECT_END),-1===f&&-1===y)throw h="Cannot find Select SQL Token - Execute SQL Query Processing Sort Without Tokens",u.error(p()+" "+h,o.addEventParameters(l,a)),new Error(h);return m=t.substr(0,f),b=t.substr(f,y-f),v=t.lastIndexOf(c.OFFLINE_SQL_TOKEN.FROM_START),g="",-1!==v&&(g=t.substr(v)),[4,d(e,b,r,i,u,l)];case 1:return E=n.sent(),t=m+E+c.OFFLINE_SQL_TOKEN.SELECT_END+c.Punctuation.space+c.Punctuation.space+g,u.info(p()+" SQL Query with SELECT Clause:\n "+t),[2,t]}}))}))}},FnTd:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.extractDeleteIdFromURL=t.generateDeleteRequests=void 0;var i=r("r9V9"),o=r("pqvw"),s=r("Y0ua"),u=r("Z84h"),l=r("Ag5+"),c=r("kwGv"),d=r("88gK"),p=r("Nd0y");function f(e){var t="";return o.isNullOrUndefinedOrEmptyString(e)||(t=e.substring(e.lastIndexOf("(")+1,e.length-1)),t}function y(e,t,r,a,n){void 0===n&&(n=[]);var s=[];if(s.push({name:"logicalName",value:e}),s.push({name:"attribute",value:t}),o.isNullOrUndefinedOrEmptyString(e)||o.isNullOrUndefinedOrEmptyString(t))throw a.error(h()+" "+c.ERROR_STRING.invalidParameter,i.addEventParameters(n,s)),new Error(c.ERROR_STRING.invalidParameter);return c.CLAUSE.delete+c.Punctuation.space+c.CLAUSE.from+c.Punctuation.space+c.Punctuation.openSQBracket+e+c.Punctuation.closeSQBracket+c.Punctuation.space+c.CLAUSE.where+c.Punctuation.space+c.Punctuation.openSQBracket+t+c.Punctuation.closeSQBracket+c.Punctuation.space+c.Punctuation.equal+c.Punctuation.space+c.Punctuation.question+c.Punctuation.space+c.CLAUSE.collateNoCase}function h(e){return e?"["+e+"]":"["+s.FILE_PREFIX.DeleteGenerator+"]"}t.generateDeleteRequests=function(e,t,r,s){return void 0===s&&(s={}),a(this,void 0,void 0,(function(){var a,m,b,v,g,E,T;return n(this,(function(n){switch(n.label){case 0:return a=s.commonEventParameters||[],m=[],[4,l.getEntityNameFromUrl(e.url,t,r,a)];case 1:return b=n.sent(),[4,u.getEntityMetadata(t,b)];case 2:if(!(v=n.sent())||!v.PrimaryIdAttribute)throw r.error(h()+" "+c.ERROR_STRING.primaryIdAttribute,a),new Error(c.ERROR_STRING.primaryIdAttribute);if(g=f(e.url),m.push({name:g,value:g}),o.isNullOrUndefinedOrEmptyString(g))throw r.error(h()+" "+c.ERROR_STRING.referencedId,i.addEventParameters(a,m)),new Error(c.ERROR_STRING.referencedId);return(E={sqlStatements:[],sqlParameters:[[g],[g]]}).sqlStatements.push(p.generateSimpleSelectStatement(b,v.PrimaryIdAttribute,t,r,a)),E.sqlStatements.push(y(b,v.PrimaryIdAttribute,t,r,a)),v.IsActivity&&(T=d.activityId+c.Punctuation.exclamation+"id",E.sqlStatements.push(y(d.activityParty,T,t,r,a)),E.sqlParameters.push([g])),r.info(h()+" SQL Query Request: \n  SQL Statement: "+E.sqlStatements),[2,Promise.resolve(E)]}}))}))},t.extractDeleteIdFromURL=f},"H+3G":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRequestType=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var a=r("bOB9"),n=r("r9V9"),i=r("Y0ua"),o={};o[a.HTTP_REQUEST_METHOD.Post]={Batch:a.OPERATION.Batch,Create:a.OPERATION.Create},o[a.HTTP_REQUEST_METHOD.Get]={GetClientMetadata:a.OPERATION.GetClientMetadata,RetrieveMultiple:a.OPERATION.RetrieveMultiple,Retrieve:a.OPERATION.Retrieve},o[a.HTTP_REQUEST_METHOD.Patch]={Patch:a.OPERATION.Update},o[a.HTTP_REQUEST_METHOD.Delete]={Delete:a.OPERATION.Delete},t.getRequestType=function(e,t){var r=t?t.TraceManager.getTracer(i.COMPONENT_NAMES.UrlParserHandler):null,s=[];n.addRequestDetailsToEventParameters(e,s,a.UNKNOWN);var u,l="";switch(e.method){case a.HTTP_REQUEST_METHOD.Post:l=-1!==e.url.indexOf("/$batch")?o[e.method].Batch:o[e.method].Create;break;case a.HTTP_REQUEST_METHOD.Get:if(e.url.match("/GetClientMetadata"))l=o[e.method].GetClientMetadata;else{var c=e.url.indexOf("("),d=e.url.indexOf("?");-1===c&&-1===d&&(l=o[e.method].RetrieveMultiple),l=-1!==c&&-1!==d?c<d?o[e.method].Retrieve:o[e.method].RetrieveMultiple:-1===c?o[e.method].RetrieveMultiple:o[e.method].Retrieve}break;case a.HTTP_REQUEST_METHOD.Patch:l=o[e.method].Patch;break;case a.HTTP_REQUEST_METHOD.Delete:l=o[e.method].Delete;break;default:if(r)throw r.error((u?"["+u+"]":"["+i.FILE_PREFIX.UrlParserHandler+"]")+" Request type is not supported",s),new Error("Request type is not supported");l=a.UNKNOWN}return l}},H08m:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.batchResponseHandler=void 0;var o=r("bOB9"),s=r("pqvw"),u=r("+1in"),l=r("H+3G"),c=r("jUuM"),d=r("RTgy"),p=r("Vj0X"),f=/--batch_.*/;function y(e,t,r,i,o,s){return void 0===o&&(o=[]),a(this,void 0,void 0,(function(){var a,u,l,f,y,h;return n(this,(function(n){switch(n.label){case 0:if(a=e&&e.length>0?e[0]:void 0,s&&s.BPFEntityLogicalName&&(y=s&&s.BPFQueryIndex?s.BPFQueryIndex:1,u=e&&e.length>1?e[y]:void 0),!a)throw new Error("Unsupported offline batch request");return[4,p.getEntityResponseData(a,t,r,i,o,s)];case 1:return l=n.sent(),[4,p.retrieveResponseHandler(a,t,r,i,o,s)];case 2:return f=n.sent(),u?(y=s&&s.BPFQueryIndex?s.BPFQueryIndex:1,[4,d.bpfResponseHandler(u,t,r,i&&i.length>y?i.slice(y,y+1):[],l,o,s)]):[3,5];case 3:return h=n.sent(),[4,c.buildBatchResponse([f,h])];case 4:return[2,n.sent()];case 5:return[4,c.buildBatchResponse([f])];case 6:return[2,n.sent()]}}))}))}t.batchResponseHandler=function(e,t,r,c,d,p){return void 0===d&&(d=[]),a(this,void 0,void 0,(function(){var a,h;return n(this,(function(n){switch(n.label){case 0:return a=e.url,function(e,t){var r,a;try{for(var n=i(e),s=n.next();!s.done;s=n.next()){var u=s.value;if(l.getRequestType(u,t)===o.OPERATION.Retrieve)return!0}}catch(e){r={error:e}}finally{try{s&&!s.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return!1}(h=function(e){var t,r,a,n,o=e.body,u=[];if(s.isNullOrUndefinedOrEmptyString(o))return u;var l=o.split(f);try{for(var c=i(l),d=c.next();!d.done;d=c.next()){var p=d.value,y="",h="",m={};if(0!==p.trim().length){var b=p.split("\n");try{for(var v=(a=void 0,i(b)),g=v.next();!g.done;g=v.next()){var E=g.value;if(0!==E.trim().length&&/\S/.test(E.trim()))if((E=E.trim()).startsWith("GET")||E.startsWith("PUT")||E.startsWith("PATCH")||E.startsWith("POST")||E.startsWith("DELETE")){var T=E.split(/\s+/);y=T[0],h=T[1]}else{var _=E.split(":");if(s.isNullOrUndefined(_)||_.length<2)continue;m[_[0].trim()]=_[1].trim()}}}catch(e){a={error:e}}finally{try{g&&!g.done&&(n=v.return)&&n.call(v)}finally{if(a)throw a.error}}s.isNullOrUndefinedOrEmptyString(h)||s.isNullOrUndefinedOrEmptyString(y)||u.push({url:h,method:y,additionalHeaders:m})}}}catch(e){t={error:e}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return u}(e),t)?[4,y(h,t,r,c,d,p)]:[3,2];case 1:return[2,n.sent()];case 2:return[2,u.buildOdataResponse(o.HTTP_STATUS_CODES.NoContent,a)]}}))}))}},HJUa:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileRequestInterceptor=void 0;var s=r("Y0ua"),u=r("H+3G"),l=r("lHlh"),c=r("T8OU"),d=r("TtpI"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){var t,r,a,n,i,l,p,y,h;return o(this,(function(o){switch(o.label){case 0:t=e.executionContext||{},r=e.request,a=t.requestType||u.getRequestType(r,this.applicationContext),n=this.applicationContext.TraceManager.getTracer(s.COMPONENT_NAMES.LocalODataExecutor),i=t.commonEventParameters||[],n.info(f()+" File Executor is processing"),o.label=1;case 1:return o.trys.push([1,3,,5]),[4,c.ExecuteFileRequest(r,this.applicationContext,t)];case 2:return l=o.sent(),[3,5];case 3:return y=o.sent(),h={name:y.name?y.name:"File Executor",message:y.message?y.message:JSON.stringify(y)},[4,d.responseHandler(r,a,this.applicationContext,void 0,h,void 0,t)];case 4:return p=o.sent(),n.error(f()+" File Local OData Client return back error response \n status code: "+p.status+"\n error message: "+p.statusText,i),[2,p];case 5:return n.info(f()+" Response Handler is processing"),[4,d.responseHandler(r,a,this.applicationContext,l,void 0,void 0,t)];case 6:return p=o.sent(),n.info(f()+" File Local OData Client return back response\n status code: "+p.status+"\n url: "+p.url),[2,p]}}))}))},t}(l.Interceptor);function f(e){return e?"["+e+"]":"["+s.FILE_PREFIX.FileRequestInterceptor+"]"}t.FileRequestInterceptor=p},HSxJ:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Chain=void 0;var i=function(){function e(e,t,r,a,n){this._applicationContext=e,this._interceptors=t,this._index=a||0,this._call=0,this.request=r,this.executionContext=n||{}}return e.prototype.proceed=function(t){return a(this,void 0,void 0,(function(){var r,a,i;return n(this,(function(n){switch(n.label){case 0:return this._index<this._interceptors.length?(t||(t=this.request),this._call+=1,r=new e(this._applicationContext,this._interceptors,t,this._index+1,this.executionContext),[4,(a=this._interceptors[this._index]).intercept(r)]):[3,2];case 1:return i=n.sent(),1!==r._call&&this._index+1!==this._interceptors.length?[2,Promise.reject(new Error("interceptor "+a.constructor.name+" must call proceed() at least once"))]:[2,i];case 2:return[2,Promise.reject(new Error("Interceptor out of range"))]}}))}))},e.prototype.clone=function(t){return new e(this._applicationContext,this._interceptors,t||this.request,this._index,this.executionContext)},e.prototype.terminate=function(){this._call+=1},e}();t.Chain=i},J0xV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceControl=void 0;var a=function(){function e(){this._startMarker=new Map,this._perfMeasure=new Map,this._perfStatistic=new Map}return e.prototype.startMarker=function(e){this._startMarker.set(e,this.getTimeNow())},e.prototype.endMarker=function(e){var t=this.getTimeNow(),r=0;try{this._startMarker.has(e)&&(r=this._startMarker.get(e)||r);var a=t-r,n={name:e,startTime:r,endTime:t,duration:a};this.updatedStatistic(e,a),this._perfMeasure.set(e,n)}catch(e){return}},e.prototype.getTimeNow=function(){return performance.now()},e.prototype.getPerformanceEntry=function(e){try{if(this._perfMeasure.has(e)&&this._perfStatistic.has(e)){var t=this._perfMeasure.get(e),r=this._perfStatistic.get(e);if(t&&r)return{name:e,performanceMeasure:t,performanceStatistic:r}}}catch(e){return null}return null},e.prototype.updatedStatistic=function(e,t){var r=t,a=1,n=t,i={};try{if(this._perfStatistic.has(e)){var o=this._perfStatistic.get(e);a=o?o.count+a:a,n=(r=o?o.totalDuration+t:t)/a}i={name:e,count:a,totalDuration:r,averageDuration:n},this._perfStatistic.set(e,i)}catch(e){return}},e}();t.PerformanceControl=a},"K2G/":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.TimeoutInterceptor=void 0;var i=r("Y0ua"),o=function(e){function t(t,r){var a=e.call(this,r)||this;return a._t=t,a._timeout=0,a._eventParameters=[],a}return n(t,e),t.prototype.intercept=function(e){var t=this;this._eventParameters=e.executionContext?e.executionContext.commonEventParameters:this._eventParameters;var r=Promise.race([this.timeOut(),e.proceed()]);return r.then((function(){clearTimeout(t._timeout)}),(function(){clearTimeout(t._timeout)})),r},t.prototype.timeOut=function(){var e=this;return new Promise((function(t,r){e.tracer.info(e.getTimeoutInterceptorPrefix()+" Set time out with time "+e._t);var a=e;e._timeout=window.setTimeout((function(){e.tracer.error(e.getTimeoutInterceptorPrefix()+" Timeout with time "+a._t,e._eventParameters),r(new Error("request failed with timeout"))}),e._t)}))},t.prototype.getTimeoutInterceptorPrefix=function(e){return e?"["+e+"]":"["+i.FILE_PREFIX.TimeoutInterceptor+"]"},t}(r("lHlh").Interceptor);t.TimeoutInterceptor=o},LP2S:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.OptionSetMetadata=void 0;var a=r("pqvw"),n=r("mdZd"),i=function(){function e(t){this._optionsInDisplayOrder=t,this._options=e._CreateDictionaryFromOptionsInDisplayOrder(t)}return e.createFromObjectData=function(t){var r=t&&t.optionsindisplayorder?t.optionsindisplayorder:{};return new e(a.mapToValues(r,(function(e){return n.OptionMetadata.createFromObjectData(e)})))},e.createFromOData=function(t){for(var r={},a=0;a<t.length;++a){var i=n.OptionMetadata.createFromOData(t[a]);r[a.toString()]=i}return new e(r)},e._CreateDictionaryFromOptionsInDisplayOrder=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var a={key:r,value:e[r]}.value;t[a.get_ValueString()]=a}return t},e.prototype.get_options=function(){return this._options},e.prototype.get_optionsInDisplayOrder=function(){return this._optionsInDisplayOrder},e.prototype.getObjectData=function(){return a.isNullOrUndefined(this._optionsInDisplayOrder)?{}:{optionsindisplayorder:a.mapToValues(this._optionsInDisplayOrder,(function(e){return e.getObjectData()}))}},e.prototype.getODataObject=function(){if(a.isNullOrUndefined(this.get_optionsInDisplayOrder()))return{};var e={},t=[],r=this.get_optionsInDisplayOrder();for(var n in r)if(r.hasOwnProperty(n)){var i={key:n,value:r[n]};t.push(i.value.getODataObject())}return e.Options=t,e},e}();t.OptionSetMetadata=i},MTQe:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.uploadResponseHandler=void 0;var a=r("bOB9"),n=r("+1in");t.uploadResponseHandler=function(e,t,r,i,o){var s=e.url;return n.buildOdataResponse(a.HTTP_STATUS_CODES.NoContent,s)}},Mq3F:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},o=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.populateQuickFindSql=t.rightToLeftMark=t.leftToRightMark=t.SearchCriteria=void 0;var s,u=r("pqvw"),l=r("Z84h"),c=r("kwGv"),d=r("uIhV"),p=r("Y0ua");function f(e,t,r,a,n,i){if(0===t.length){var o="Could not locate the QuickFInd tokens in SQL query";throw n.error(b()+" "+o,i),new Error(o)}v(t),v(r);var s=t[t.length-1].split("where");if(0===s.length){o="The QuickFind query does not contain 'WHERE' clause";throw n.error(b()+" "+o,i),new Error(o)}var u=s[0]+(r.length>0?" where "+r.join(" OR "):"");return e.replace(t[t.length-1],u)}function y(e,t,r,a){for(var n=0;n<r.length;n++){var i=r[n].match(new RegExp("({\\d})"));if(i){var o=h(i[1]);m(t,r,e,n,i[1],o in a,o in a?a[o].toString():null)}}}function h(e){var t="";switch(e){case"{4}":t=s[s.float];break;case"{3}":t=s[s.dateTime];break;case"{2}":t=s[s.currency];break;case"{1}":t=s[s.integer];break;case"{0}":t=s[0]}return t}function m(e,t,r,a,n,i,o){if(i){var s=n?n.replace("}","\\}").replace("{","\\{"):n,u=new RegExp(s,"g"),l=t[a].replace(u,o);e&&(r[a]=r[a].replace(t[a],l)),t[a]=l}else t[a]="",e&&(r[a]="")}function b(e){return e?"["+e+"]":"["+p.FILE_PREFIX.QuickFindSQLGenerator+"]"}function v(e){for(var t=0;t<e.length;t++)u.isNullOrUndefinedOrEmptyString(e[t])&&(e.splice(t,1),t--)}!function(e){e[e.string=0]="string",e[e.integer=1]="integer",e[e.currency=2]="currency",e[e.dateTime=3]="dateTime",e[e.float=4]="float"}(s=t.SearchCriteria||(t.SearchCriteria={})),t.leftToRightMark="",t.rightToLeftMark="",t.populateQuickFindSql=function(e,t,r,i,p,h){return a(this,void 0,void 0,(function(){var a,m,v,g,E,T,_,S;return n(this,(function(n){switch(n.label){case 0:return a=h.commonEventParameters,(m=function(e,t,r,a){var n=d.getQueryTokenRegex(c.OFFLINE_SQL_TOKEN.QUICKFIND_START,c.OFFLINE_SQL_TOKEN.QUICKFIND_END),i=e.match(n);if(i&&i.length>0)return i[1];var o="Could not locate the QuickFind tokens in SQL query";throw r.error(b()+" "+o,a.commonEventParameters),new Error(o)}(e,0,p,h))?[4,l.getEntityMetadata(i,r,a)]:(v="No internal QuickFind query found:\n"+e,p.error(b()+" "+v,a),[2,Promise.reject(v)]);case 1:if(g=n.sent(),E=m.split("UNION"),T=function(e){var t=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE [\\S\\s]* IN \\(SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)\\)","i"),r=new RegExp("SELECT [\\S\\s]* FROM [\\S\\s]* WHERE ([\\S\\s]*)","i"),a=[],n=[],i={},s=e[e.length-1].match(r);s&&n.push.apply(n,o(s[1].split("OR")));for(var u=0;u<e.length-1;u++)(s=e[u].match(t))||(s=e[u].match(r)),s?a.push(s[1]):a.push("");return i.lookup=a,i.other=n,i}(E),_=T.lookup?T.lookup:[],S=T.other?T.other:[],!_.length&&!S.length){if(!g.PrimaryNameAttribute)return p.warn(b()+" Could not extract search conditions from the QuickFind query:\n"+e,a),[2,e];m="SELECT "+g.PrimaryNameAttribute+" FROM "+r+" WHERE "+g.PrimaryNameAttribute+" LIKE {0}"}return"*"===t?(E.splice(0,_.length),_.length=0,S.length=0,[2,f(e,E,S,i,p,a)]):(function(e,t,r,a,n,i,o){var l=u.trimWildCards(e);e=u.convertSearchStringToSQL(e),e=u.handleEscapeCharacters(e);var c={};if(c[s[0]]="'"+e+"'",!n.Formatter){var d="Formatter is not available";throw i.error(b()+" "+d,o),new Error(d)}var p=n.Formatter.parseIntegerValue(l);!isNaN(p)&&isFinite(p)&&p.toString()===l&&(c[s[s.integer]]=p.toString());var f=n.Formatter.parseDecimalValue(l);!isNaN(f)&&isFinite(f)&&(c[s[s.float]]=c[s[s.currency]]=f.toString());var h=n.Formatter?n.Formatter.parseInvariant(l):new Date(l);h&&(c[s[s.dateTime]]="'"+h.toString()+"'"),y(t,!0,r,c),y(t,!1,a,c)}(t,E,_,S,i,p,a),[2,f(e,E,S,i,p,a)])}}))}))}},N6bD:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteSQLBatch=t.DefaultSqlExecutor=void 0;var i=r("bOB9"),o=r("r9V9"),s=r("pqvw"),u=r("Y0ua"),l=function(){function e(){}return e.prototype.ExecuteSqlStatementsOnOfflineDB=function(e){return new Promise((function(e,t){}))},e.prototype.ExecuteSqlStatementsOnMetadataDB=function(e){return new Promise((function(e,t){}))},e}();function c(e){return e?"["+e+"]":"["+u.FILE_PREFIX.SQLExecutor+"]"}t.DefaultSqlExecutor=l,t.ExecuteSQLBatch=function(e,t,r,l){return void 0===l&&(l={}),a(this,void 0,void 0,(function(){var a,d,p,f;return n(this,(function(n){return a=t.TraceManager.getTracer(u.COMPONENT_NAMES.SQLExecutor),d=l.commonEventParameters||[],(p=[]).push({name:"NoOfSQLStatements",value:e&&e.sqlStatements?e.sqlStatements.length:0}),a.info(c()+" ExecuteSQLBatch - starting ExecuteSQLBatch",o.addEventParameters(d,p)),f=null,r===i.OPERATION.GetClientMetadata?(l.performanceControl&&l.performanceControl.startMarker(u.FILE_PREFIX.MetadataSQLExecutor),f=t.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(e)):(l.performanceControl&&l.performanceControl.startMarker(u.FILE_PREFIX.DataSQLExecutor),f=t.SqlExecutor.ExecuteSqlStatementsOnOfflineDB(e)),[2,f.then((function(e){return a.info(c()+" SQL Executor successfully completed",p),l.performanceControl&&(r===i.OPERATION.GetClientMetadata?l.performanceControl.endMarker(u.FILE_PREFIX.MetadataSQLExecutor):l.performanceControl.endMarker(u.FILE_PREFIX.DataSQLExecutor)),Promise.resolve(e)})).catch((function(e){var t=s.convertErrorToLocalError(e),r=t.message;return t.message=o.extractSqlErrorMessage(r),o.addErrorInformationToEventParameters(e,p),p.push({name:u.EVENT_PARAMETERS.SQL_ERROR_CODE,value:t.code||i.ErrorCode.UnknownUnexpectedGenericError}),p.push({name:u.EVENT_PARAMETERS.SQL_ERROR_MESSAGE,value:r}),a.error(c()+" Error on SQL Executor rejecting with data source offline error code",o.addEventParameters(d,p)),Promise.reject(t)}))]}))}))}},NbWf:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.updateResponseHandler=void 0;var a=r("bOB9"),n=r("pqvw"),i=r("ZRE3"),o=r("Y0ua"),s=r("+1in");t.updateResponseHandler=function(e,t,r,u,l){var c,d;if(void 0===l&&(l=[]),n.isNullOrUndefined(u)||!n.isNullOrUndefined(u[0])&&u[0].rows.length){var p=new Headers;p.append(a.HEADER.ODADTA_ENTITY_ID,e.url),c=s.buildOdataResponse(a.HTTP_STATUS_CODES.NoContent,e.url,p)}else r.error((d?"["+d+"]":"["+o.FILE_PREFIX.UpdateResponseHandler+"]")+" You cannot update this record because it doesn't exist in the offline mode",l),c=s.buildErrorResponse(a.HTTP_STATUS_CODES.BadRequest,e.url,new i.LocalError("You cannot update this record because it doesn't exist in the offline mode",a.ErrorCode.CannotUpdateOnlineRecord));return c}},Nd0y:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.generateSimpleSelectStatement=void 0;var a=r("r9V9"),n=r("pqvw"),i=r("Y0ua"),o=r("kwGv");t.generateSimpleSelectStatement=function(e,t,r,s,u){void 0===u&&(u=[]);var l,c=[];if(c.push({name:"logicalName",value:e}),c.push({name:"attribute",value:t}),n.isNullOrUndefinedOrEmptyString(e)||n.isNullOrUndefinedOrEmptyString(t))throw s.error((l?"["+l+"]":"["+i.FILE_PREFIX.SQLModifier+"]")+" "+o.ERROR_STRING.invalidParameter,a.addEventParameters(u,c)),new Error(o.ERROR_STRING.invalidParameter);return o.CLAUSE.select+o.Punctuation.space+o.Punctuation.openSQBracket+t+o.Punctuation.closeSQBracket+o.Punctuation.space+o.CLAUSE.from+o.Punctuation.space+o.Punctuation.openSQBracket+e+o.Punctuation.closeSQBracket+o.Punctuation.space+o.CLAUSE.where+o.Punctuation.space+o.Punctuation.openSQBracket+t+o.Punctuation.closeSQBracket+o.Punctuation.space+o.Punctuation.equal+o.Punctuation.space+o.Punctuation.question+o.Punctuation.space+o.CLAUSE.collateNoCase}},PY9Y:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.SQLLocalODataClient=void 0;var i=r("Co9g"),o=r("zydU"),s=function(e){function t(t,r){var a=e.call(this,t,r)||this;return a.setExecuteRequestInterceptor(new o.SQLRequestInterceptor(a.applicationContext)).build(),a}return n(t,e),t}(i.ODataClient);t.SQLLocalODataClient=s},RTgy:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBPFResponseData=t.bpfResponseHandler=void 0;var i=r("bOB9"),o=r("r9V9"),s=r("pqvw"),u=r("ZRE3"),l=r("Y0ua"),c=r("+1in");function d(e,t,r,i,s,u,l){return void 0===u&&(u=[]),a(this,void 0,void 0,(function(){var r,a,d,f,y,h,m;return n(this,(function(n){switch(n.label){case 0:return r="",a={},d=[],(f=l?l.BPFEntityLogicalName:"")&&0!==f.length?(d.push({name:"EntityLogicalName",value:f}),(y=i[0].rows.item(0))?(h=!1,c.headerContainsPreferAnnotation(e)&&(h=!0),[4,c.getFormattedRecordData(t,y,f,h)]):[3,2]):[2,""];case 1:a=n.sent(),t.EventManager.ReportComponentSuccess(p(),o.addEventParameters(u,d)),m={},a["@odata.type"]=f,m.GlobalNavigationData=a,s&&(m.Entity=s),m["@odata.context"]=e.url,r=JSON.stringify(m),n.label=2;case 2:return[2,r]}}))}))}function p(e){return e?"["+e+"]":"["+l.FILE_PREFIX.BPFResponseHandler+"]"}t.bpfResponseHandler=function(e,t,r,o,l,f,y){return void 0===f&&(f=[]),a(this,void 0,void 0,(function(){var a,h,m,b;return n(this,(function(n){switch(n.label){case 0:return h=new Headers,r.info(p()+" Processing the retrieve response",f),h.set(i.HEADER.CONTENT_TYPE,i.HEADER_VALUES.APPLICATION_JSON),(m=o)&&m.length>0?[4,d(e,t,r,m,l,f,y)]:[3,2];case 1:return b=n.sent(),s.isNullOrUndefinedOrEmptyString(b)?(r.error(p()+" No response retrieved from offline DB for this request",f),a=c.buildErrorResponse(i.HTTP_STATUS_CODES.Unknown,e.url,new u.LocalError("No response retrieved from offline DB for this request"),h)):a=c.buildOdataResponse(i.HTTP_STATUS_CODES.Ok,e.url,h,b),[3,3];case 2:r.error(p()+" No response retrieved from offline DB for this request",f),a=c.buildErrorResponse(i.HTTP_STATUS_CODES.Unknown,e.url,new u.LocalError("No response retrieved from offline DB for this request"),h),n.label=3;case 3:return[2,a]}}))}))},t.getBPFResponseData=d},Rd2O:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function a(e){var r=new Date(Date.now()),a=r.getTimezoneOffset()*t.MILLISECONDS_IN_MINUTE,n=e.timezoneutcoffsetminutes*t.MILLISECONDS_IN_MINUTE;return new Date(r.getTime()+a+n)}function n(e,t){if(!t)return 0;var r=null,a=new Date(e.getTime());a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);for(var n=0;n<t.length;n++){var o=t[n].datestart,s=t[n].dateend;if(a>=o&&a<=s){r=t[n];break}}return r?i(r,e):0}function i(e,t){var r=t.getFullYear(),a=o(e.daylightstart,r),n=o(e.daylightend,r);if(n<a){if(t>a||t<n)return e.delta}else if(t>a&&t<n)return e.delta;return 0}function o(e,t){if(e.isfixeddaterule)return new Date(t,e.month,e.day,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds());var r,a=7*e.week-6,n=new Date(t,e.month,1).getDay();return(r=n>e.dayofweek?a+(7-n+e.dayofweek):a+(e.dayofweek-n))>function(e,t){if(/8|3|5|10/.test(e.toString()))return 30;if(1!==e)return 31;return function(e){return e%4==0&&e%100!=0||e%400==0}(t)?29:28}(e.month,t)&&(r-=7),new Date(t,e.month,r,e.timeofday.getHours(),e.timeofday.getMinutes(),e.timeofday.getSeconds())}function s(e){return t=e.getFullYear(),r=e.getMonth()+1,a=e.getDate(),n=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),s=e.getMilliseconds(),"'"+t+"-"+(r<10?"0"+r:r)+"-"+(a<10?"0"+a:a)+" "+(n<10?"0"+n:n)+":"+(i<10?"0"+i:i)+":"+(o<10?"0"+o:o)+"."+(s<100?s<10?"00"+s:"0"+s:s)+"'";var t,r,a,n,i,o,s}function u(e,r){var a=e.timezoneutcoffsetminutes*t.MILLISECONDS_IN_MINUTE;return a+=n(r,l(e.timezoneadjusters)),new Date(r.getTime()-a)}function l(e){return e.map((function(e){return{datestart:new Date(e.datestart),dateend:new Date(e.dateend),daylightstart:{day:e.daylightstart.day,month:e.daylightstart.month,dayofweek:e.daylightstart.dayofweek,week:e.daylightstart.week,timeofday:new Date(e.daylightstart.timeofday),isfixeddaterule:e.daylightstart.isfixeddaterule},delta:e.delta,daylightend:{day:e.daylightend.day,month:e.daylightend.month,dayofweek:e.daylightend.dayofweek,week:e.daylightend.week,timeofday:new Date(e.daylightend.timeofday),isfixeddaterule:e.daylightend.isfixeddaterule}}}))}function c(e){return e.setHours(0,0,0,0),e}function d(e){var t=c(e);return t.setDate(1),t}function p(e){return Math.trunc(e.timezoneutcoffsetminutes/60)}function f(e){return e.timezoneutcoffsetminutes%60}function y(e,t){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return r.setDate(e.getDate()+t),r}Object.defineProperty(t,"__esModule",{value:!0}),t.addDays=t.getWorkWeekStartDateFromUserSettings=t.getUtcMinuteOffset=t.getUtcHourOffset=t.getUserTimeZoneMinuteOffset=t.getUserTimeZoneHourOffset=t.getStartOfYear=t.getStartOfMonth=t.getStartOfDay=t.getStartOfHour=t.convertTimeZoneAjusterDateValue=t.convertLocalTimeToUTCTimeForUserLocalFromUserSettings=t.getUTCTimeForUserLocal=t.getDateTimeFormat=t.getConstraintByYear=t.getLocalAdjustmentFromDate=t.getDSTAdjustment=t.getUserCurrentDateTimeFromUserSettings=t.getUserDateTimeNowFromUserSettings=t.MILLISECONDS_IN_MINUTE=void 0,t.MILLISECONDS_IN_MINUTE=6e4,t.getUserDateTimeNowFromUserSettings=function(e){var t=a(e),r=n(t,l(e.timezoneadjusters));return new Date(t.getTime()+r)},t.getUserCurrentDateTimeFromUserSettings=a,t.getDSTAdjustment=n,t.getLocalAdjustmentFromDate=i,t.getConstraintByYear=o,t.getDateTimeFormat=s,t.getUTCTimeForUserLocal=function(e,t){return s(u(e,t))},t.convertLocalTimeToUTCTimeForUserLocalFromUserSettings=u,t.convertTimeZoneAjusterDateValue=l,t.getStartOfHour=function(e){return e.setMinutes(0,0,0),e},t.getStartOfDay=c,t.getStartOfMonth=d,t.getStartOfYear=function(e){var t=d(e);return t.setMonth(0),t},t.getUserTimeZoneHourOffset=p,t.getUserTimeZoneMinuteOffset=f,t.getUtcHourOffset=function(e){return-1*p(e)},t.getUtcMinuteOffset=function(e){return-1*f(e)},t.getWorkWeekStartDateFromUserSettings=function(e,t){try{var r=e.datetimeformatinfo.FirstDayOfWeek;return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0)).getDay()<r?y(t,r-t.getDay()-7):y(t,r-t.getDay())}catch(e){throw new Error("Failed to getWorkWeekStartDateFromUserSettings "+e)}},t.addDays=y},SbZb:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveBPFRecordByProcess=t.retrieveBPFRecordById=t.retrieveMetadataByQuery=t.retrieveLocalEntities=t.constructBPFRecord=void 0;var l=r("bOB9"),c=r("pqvw"),d=r("Ct6E"),p=r("Y0ua"),f=r("i2et"),y=r("XGkY"),h=r("Z84h"),m=r("N6bD"),b=i(r("88gK")),v=r("kwGv"),g=r("jD1M"),E=r("VDnG"),T=r("pq07"),_=r("Vnn7");function S(e,t,r){return o(this,void 0,void 0,(function(){var a,n,i,o,l,d,p,y,m;return s(this,(function(s){switch(s.label){case 0:return[4,h.getAttributesMetadata(r,e,[])];case 1:a=s.sent(),n=null,(i=[]).push("createdby"),i.push("modifiedby"),i.push("createdonbehalfbyname"),i.push("modifiedonbehalfbyname");try{for(o=u(Object.keys(a)),l=o.next();!l.done;l=o.next())if(d=l.value,p=a[d],!(i.indexOf(p.LogicalName)>=0||p.Type!==f.AttributeType.Lookup||c.isNullOrUndefined(p.Targets)||1!==p.Targets.length||p.Targets[0]!==t)){if(!p.IsCustomAttribute){n=p;break}p.LogicalName.startsWith("bpf_")&&(c.isNullOrUndefined(n)||n.ColumnNumber&&p.ColumnNumber&&n.ColumnNumber>p.ColumnNumber)&&(n=p)}}catch(e){y={error:e}}finally{try{l&&!l.done&&(m=o.return)&&m.call(o)}finally{if(y)throw y.error}}if(c.isNullOrUndefined(n))throw Error("OfflineDataStore.getEntityIdAttributeFromBpfEntity.Fail : Cannot find an attribute that matches the lookup target in the entity ");return[2,n.LogicalName]}}))}))}function O(e,t,r,a){return o(this,void 0,void 0,(function(){var n,i,o;return s(this,(function(s){switch(s.label){case 0:return n=v.CLAUSE.select+" "+v.Punctuation.asterisk+" "+v.CLAUSE.from+" "+e+" "+t,(i={sqlStatements:[],sqlParameters:[]}).sqlStatements.push(n),i.sqlParameters.push(r),[4,m.ExecuteSQLBatch(i,a,l.OPERATION.Retrieve)];case 1:if(o=s.sent(),!c.isNullOrUndefined(o)&&o.length>0)return[2,o[0]];throw new Error("results is null")}}))}))}function N(e,t,r,a){return o(this,void 0,void 0,(function(){var n,i,o,u;return s(this,(function(s){switch(s.label){case 0:if(c.isNullOrUndefined(t))return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,h.getEntityMetadata(r,e,a)];case 2:return n=s.sent(),i=n.PrimaryIdAttribute?n.PrimaryIdAttribute:"",o=y.Guid.tryParse(t["processid!id"]),u=new Date(t.modifiedon),[2,{entityLogicalName:e,id:o,modifiedon:u,primaryIdAttribute:i,primaryIdValue:y.Guid.tryParse(t[i])}];case 3:throw s.sent(),new Error("Error when forming a BPF record");case 4:throw new Error("Error when forming a BPF record")}}))}))}function M(e){return e?"["+e+"]":"["+p.FILE_PREFIX.RetrieveGenerator+"]"}t.retrieveBPFRecordByProcess=function(e,t,r,a,n){return o(this,void 0,void 0,(function(){var i,o,u;return s(this,(function(s){switch(s.label){case 0:return[4,S(t,e.entityLogicalName,r)];case 1:return i=s.sent(),o=v.CLAUSE.where+" "+v.Punctuation.openSQBracket+(i+b.columnDelimiter+b.id)+v.Punctuation.closeSQBracket+" "+v.Punctuation.equal+" "+v.Punctuation.question+" "+v.CLAUSE.orderBy+" "+b.modifiedOn+" "+v.SORT.DESC,[4,O(t,o,[e.id.guid],r)];case 2:return u=s.sent(),!c.isNullOrUndefined(u.rows)&&u.rows.length>0?(a.info(M()+" BPF data present for "+t,n),[2,N(t,u.rows.item(0),r,n)]):(a.info(M()+" No BPF instance found for "+t,n),[2,null])}}))}))},t.retrieveLocalEntities=O,t.constructBPFRecord=N,t.retrieveMetadataByQuery=function(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,u,l,c,p;return s(this,(function(s){switch(s.label){case 0:n=T.getLegacyMetadataTypeForQuery(t.MetadataType,t.MetadataSubtype),i=n.subtype,o=n.type,u="",t.MetadataId&&(u=t.MetadataId.toString()),l=new _.ApplicationMetadataQuery(o,g.FormFactor.Desktop,t.EntityLogicalName,0,t.GetDefault,u,i,void 0),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,E.retrieveMultipleApplicationMetadataByQuery(e,l)];case 2:return(c=s.sent())&&c.length?[2,c]:(r.warn(M()+" Not able to find the key "+u+" for type "+d.MetadataType[o],a),[2,[]]);case 3:throw p=s.sent(),r.error(M()+" error retrieving metadata by query for "+u+". "+p.message,a),p;case 4:return[2]}}))}))},t.retrieveBPFRecordById=function(e,t,r,a,n){return o(this,void 0,void 0,(function(){var i,o;return s(this,(function(s){switch(s.label){case 0:return i="WHERE [businessprocessflowinstanceid]="+v.Punctuation.question,[4,O(t,i,[e.guid],a)];case 1:return o=s.sent(),!c.isNullOrUndefined(o.rows)&&o.rows.length>0?(r.info(M()+" data present for "+t,n),[4,N(t,o.rows.item(0),a,n)]):[3,3];case 2:return[2,s.sent()];case 3:return r.info(M()+" No BPF instance found for "+t,n),[2,null]}}))}))}},Stju:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.deleteResponseHandler=void 0;var a=r("bOB9"),n=r("r9V9"),i=r("pqvw"),o=r("ZRE3"),s=r("Y0ua"),u=r("+1in");t.deleteResponseHandler=function(e,t,r,l,c){void 0===c&&(c=[]);var d,p,f=e.url,y=[];if(i.isNullOrUndefined(l)||!i.isNullOrUndefined(l[0])&&l[0].rows.length)d=u.buildOdataResponse(a.HTTP_STATUS_CODES.NoContent,f,new Headers);else{var h=new o.LocalError("You cannot delete this record because it doesn't exist in the offline mode",a.ErrorCode.CannotDeleteOnlineRecord);n.addErrorInformationToEventParameters(h,y),r.error((p?"["+p+"]":"["+s.FILE_PREFIX.DeleteResponseHandler+"]")+" You cannot delete this record because it doesn't exist in the offline mode",n.addEventParameters(c,y)),d=u.buildErrorResponse(a.HTTP_STATUS_CODES.BadRequest,e.url,h)}return d}},T8OU:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteFileRequest=void 0;var a=r("Y0ua");function n(e){return e?"["+e+"]":"["+a.FILE_PREFIX.FileExecutor+"]"}t.ExecuteFileRequest=function(e,t,r){void 0===r&&(r={});var i=t.TraceManager.getTracer(a.COMPONENT_NAMES.FileExecutor);return new Promise((function(e,t){try{return i.info(n()+" ExecuteFileRequest - File Executor successfully completed"),e({})}catch(e){return i.error(n()+" ExecuteFileRequest - Failed to get query from File Executor"),t(new Error("Query Generation throws error"))}}))}},TYeF:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.generateBatchRequests=void 0;var o=r("bOB9"),s=r("pqvw"),u=r("H+3G"),l=r("nN45"),c=/--batch_.*/;function d(e,t,r,i){return a(this,void 0,void 0,(function(){var a,o;return n(this,(function(n){if(a=e&&e.length>0?e[0]:void 0,o=e&&e.length>1?e[1]:void 0,!a)throw new Error("Unsupported offline batch request");return[2,l.generateRetrieveRequest(a,r,t,i,o)]}))}))}t.generateBatchRequests=function(e,t,r,l){return void 0===l&&(l={}),a(this,void 0,void 0,(function(){var a;return n(this,(function(n){switch(n.label){case 0:return function(e,t){var r,a;try{for(var n=i(e),s=n.next();!s.done;s=n.next()){var l=s.value;if(u.getRequestType(l,t)===o.OPERATION.Retrieve)return!0}}catch(e){r={error:e}}finally{try{s&&!s.done&&(a=n.return)&&a.call(n)}finally{if(r)throw r.error}}return!1}(a=function(e){var t,r,a,n,o=e.body,u=[];if(s.isNullOrUndefinedOrEmptyString(o))return u;var l=o.split(c);try{for(var d=i(l),p=d.next();!p.done;p=d.next()){var f=p.value,y="",h="",m={};if(0!==f.trim().length){var b=f.split("\n");try{for(var v=(a=void 0,i(b)),g=v.next();!g.done;g=v.next()){var E=g.value;if(0!==E.trim().length&&/\S/.test(E.trim()))if((E=E.trim()).startsWith("GET")||E.startsWith("PUT")||E.startsWith("PATCH")||E.startsWith("POST")||E.startsWith("DELETE")){var T=E.split(/\s+/);y=T[0],h=T[1]}else{var _=E.split(":");if(s.isNullOrUndefined(_)||_.length<2)continue;m[_[0].trim()]=_[1].trim()}}}catch(e){a={error:e}}finally{try{g&&!g.done&&(n=v.return)&&n.call(v)}finally{if(a)throw a.error}}s.isNullOrUndefinedOrEmptyString(h)||s.isNullOrUndefinedOrEmptyString(y)||u.push({url:h,method:y,additionalHeaders:m})}}}catch(e){t={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}return u}(e),t)?[4,d(a,r,t,l)]:[3,2];case 1:return[2,n.sent()];case 2:throw new Error("Unsupported offline batch request")}}))}))}},TtpI:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.responseHandler=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i=r("bOB9"),o=r("Y0ua"),s=r("H08m"),u=r("5OKj"),l=r("Stju"),c=r("YWuQ"),d=r("+1in"),p=r("++AH"),f=r("Vj0X"),y=r("NbWf"),h=r("MTQe");t.responseHandler=function(e,t,r,m,b,v,g){return void 0===g&&(g={}),a(this,void 0,void 0,(function(){var a,E,T;return n(this,(function(n){switch(n.label){case 0:return g.performanceControl&&g.performanceControl.startMarker(o.FILE_PREFIX.ResponseHandler),E=r.TraceManager.getTracer(o.COMPONENT_NAMES.ResponseHandler),T=g.commonEventParameters||[],b?(E.info((_?"["+_+"]":"["+o.FILE_PREFIX.ResponseHandler+"]")+" Executing error response handler",T),a=d.buildErrorResponse(i.HTTP_STATUS_CODES.InternalServerError,e.url,b),[3,16]):[3,1];case 1:switch(t){case i.OPERATION.Create:return[3,2];case i.OPERATION.Batch:return[3,4];case i.OPERATION.Update:return[3,6];case i.OPERATION.Retrieve:return[3,7];case i.OPERATION.RetrieveMultiple:return[3,9];case i.OPERATION.GetClientMetadata:return[3,11];case i.OPERATION.Delete:return[3,13];case i.OPERATION.Upload:return[3,14]}return[3,15];case 2:return[4,u.createResponseHandler(e,r,E,m,v,T)];case 3:return a=n.sent(),[3,16];case 4:return[4,s.batchResponseHandler(e,r,E,m,T,v)];case 5:return a=n.sent(),[3,16];case 6:return a=y.updateResponseHandler(e,r,E,m,T),[3,16];case 7:return[4,f.retrieveResponseHandler(e,r,E,m,T,v)];case 8:return a=n.sent(),[3,16];case 9:return[4,p.retrieveMultipleResponseHandler(e,r,E,m,v,T)];case 10:return a=n.sent(),[3,16];case 11:return[4,c.getClientMetadataResponseHandler(e,r,E,m,T,v)];case 12:return a=n.sent(),[3,16];case 13:return a=l.deleteResponseHandler(e,r,E,m,T),[3,16];case 14:return a=h.uploadResponseHandler(e,r,E,m),[3,16];case 15:return a=d.buildOdataResponse(i.HTTP_STATUS_CODES.BadRequest,e.url),[3,16];case 16:return g.performanceControl&&g.performanceControl.endMarker(o.FILE_PREFIX.ResponseHandler),[2,a]}var _}))}))}},U8Nn:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.KeyPath=void 0;var a=r("pqvw"),n=function(){function e(e){if(a.isNullOrUndefinedOrEmptyString(e))throw new Error("Undefined path parameter to KeyPath");this._path=e}return e.get_id=function(){return e._id},e.prototype.get_path=function(){return this._path},e._id=new e("id"),e}();t.KeyPath=n},VDnG:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},s=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getPartyName=t.retrieveMultipleApplicationMetadataByKeys=t.retrieveMultipleApplicationMetadataByQuery=t.retrieveApplicationMetadata=t.retrieveMultipleApplicationMetadata=void 0;var u=r("bOB9"),l=r("pqvw"),c=r("mklL"),d=r("Z84h"),p=r("N6bD"),f=r("zydU"),y=r("jD1M"),h=r("U8Nn");function m(e,t,r){var a="SELECT "+y.MetadataFields.METADATA_TYPE+", "+y.MetadataFields.JSON+" from "+y.APPLICATION_METADATA_STORE+" where "+t+" = ?";e.sqlStatements.push(a),e.sqlParameters.push([r])}function b(e,t){var r;f.shouldCacheMetadataRows(e)&&!l.isNullOrUndefined(t)&&Array.isArray(t)&&t.length>0&&(l.isNullOrUndefined(e.AdditionalParameters)&&(e.AdditionalParameters={}),!l.isNullOrUndefined(e.AdditionalParameters.response)&&Array.isArray(e.AdditionalParameters.response)?e.AdditionalParameters.response=(r=e.AdditionalParameters.response).push.apply(r,s(t)):e.AdditionalParameters.response=t)}t.getPartyName=function(e,t,r,i){return void 0===i&&(i={}),a(this,void 0,void 0,(function(){var a,o,s,l,c;return n(this,(function(n){switch(n.label){case 0:return[4,d.getEntityMetadata(e,t)];case 1:return a=n.sent(),o=a.PrimaryNameAttribute,s=a.PrimaryIdAttribute,o&&s?(l={sqlStatements:["SELECT "+o+" FROM "+t+" WHERE "+s+" = ?"],sqlParameters:[[r]]},[4,p.ExecuteSQLBatch(l,e,u.OPERATION.Retrieve,i)]):[2,""];case 2:return!(c=n.sent())||c.length<=0||!c[0].rows||!c[0].rows.item||c[0].rows.item.length<=0||!o?[2,""]:[2,c[0].rows.item(0)[o]]}}))}))},t.retrieveMultipleApplicationMetadata=function(e,t,r,o){return void 0===o&&(o={}),a(this,void 0,void 0,(function(){var a,s,c,d,f,v,g,E,T,_,S,O,N,M;return n(this,(function(n){switch(n.label){case 0:a={sqlStatements:[],sqlParameters:[]},s=[],c=l.isNullOrUndefinedOrEmptyString(r)?h.KeyPath.get_id().get_path():r;try{for(d=i(t),f=d.next();!f.done;f=d.next())v=f.value,m(a,c,v)}catch(e){S={error:e}}finally{try{f&&!f.done&&(O=d.return)&&O.call(d)}finally{if(S)throw S.error}}return[4,p.ExecuteSQLBatch(a,e,u.OPERATION.GetClientMetadata,o)];case 1:g=n.sent(),b(e,g);try{for(E=i(g),T=E.next();!T.done;T=E.next())(_=T.value).rows.length>0&&s.push(JSON.parse(_.rows.item(0)[y.MetadataFields.JSON]))}catch(e){N={error:e}}finally{try{T&&!T.done&&(M=E.return)&&M.call(E)}finally{if(N)throw N.error}}return[2,s]}}))}))},t.retrieveApplicationMetadata=function(e,t,r){return a(this,void 0,void 0,(function(){var a,o,s,u,d,p,f;return n(this,(function(n){switch(n.label){case 0:return a="SELECT "+y.MetadataFields.METADATA_TYPE+", "+y.MetadataFields.JSON+" FROM "+y.APPLICATION_METADATA_STORE+" WHERE "+(l.isNullOrUndefinedOrEmptyString(r)?h.KeyPath.get_id().get_path():r)+" = ?",[4,c.getSqlResults(e,a,[t])];case 1:o=n.sent(),b(e,o);try{for(s=i(o),u=s.next();!u.done;u=s.next())if((d=u.value).rows.length>0)return[2,JSON.parse(d.rows.item(0)[y.MetadataFields.JSON])]}catch(e){p={error:e}}finally{try{u&&!u.done&&(f=s.return)&&f.call(s)}finally{if(p)throw p.error}}return[2,{}]}}))}))},t.retrieveMultipleApplicationMetadataByQuery=function(e,t){return a(this,void 0,void 0,(function(){var r,a,i,o,s,u;return n(this,(function(n){switch(n.label){case 0:return m(r={sqlStatements:[],sqlParameters:[]},t.get_keyPath().get_path(),t.get_keyValue().toString()),[4,c.getBatchSqlResults(e,r)];case 1:for(a=n.sent(),b(e,a),i=[],o=0;o<a.length;o++)if(a[o].rows.length>0)for(s=0;s<a[o].rows.length;s++)u=JSON.parse(a[o].rows.item(s)[y.MetadataFields.JSON]),t.checkApplicationMetadata(u)&&i.push(u);return[2,i]}}))}))},t.retrieveMultipleApplicationMetadataByKeys=function(e,t,r){return a(this,void 0,void 0,(function(){var a,i,o,u,d,p,f;return n(this,(function(n){switch(n.label){case 0:for(a=[],i="",p=0;p<r.length;p++)i+=" ?,";return i.length>0&&(i=i.substr(0,i.length-1)),o={sqlStatements:[],sqlParameters:[]},u="SELECT "+y.MetadataFields.JSON+" FROM "+y.APPLICATION_METADATA_STORE+" WHERE "+t.get_path()+" IN ("+i+")",o.sqlStatements.push(u),o.sqlParameters.push(s(r)),[4,c.getBatchSqlResults(e,o)];case 1:if(d=n.sent(),b(e,d),!l.isNullOrUndefined(d)&&d.length>0)for(p=0;p<d[0].rows.length;p++)f=JSON.parse(d[0].rows.item(p)[y.MetadataFields.JSON]),a.push(f);return[2,a]}}))}))}},VF39:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.color=t.allowedStatusTransitions=t.defaultStatus=t.state=t.value=t.label=t.delimiter=void 0;var a=r("2C7J");function n(e){return t.delimiter+a.FieldFormatValue[e]}t.delimiter="!",t.label=n(a.FieldFormatValue.Label),t.value=n(a.FieldFormatValue.Value),t.state=n(a.FieldFormatValue.State),t.defaultStatus=n(a.FieldFormatValue.DefaultStatus),t.allowedStatusTransitions=n(a.FieldFormatValue.AllowedStatusTransitions),t.color=n(a.FieldFormatValue.Color)},VejF:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath=t.metadataTypeNormalizedDisplayNameKeyPath=t.metadataTypeAssociatedEntityLogicalNameKeyPath=t.metadataTypeSourceIdKeyPath=t.sourceIdKeyPath=t.metadataTypeKeyPath=void 0;var a=r("pqvw"),n=r("jD1M"),i=r("U8Nn"),o=new i.KeyPath(n.MetadataFields.METADATA_TYPE);t.metadataTypeKeyPath=o;var s=new i.KeyPath(n.MetadataFields.SOURCE_ID);t.sourceIdKeyPath=s;var u=new i.KeyPath(n.MetadataFields.METADATA_TYPE+a.COMPOSITE_INDEX_DELIMITER+n.MetadataFields.SOURCE_ID);t.metadataTypeSourceIdKeyPath=u;var l=new i.KeyPath(n.MetadataFields.METADATA_TYPE+a.COMPOSITE_INDEX_DELIMITER+n.MetadataFields.ASSOCIATED_ENTITY_LOGICAL_NAME);t.metadataTypeAssociatedEntityLogicalNameKeyPath=l;var c=new i.KeyPath(n.MetadataFields.METADATA_TYPE+a.COMPOSITE_INDEX_DELIMITER+n.MetadataFields.METADATA_SUBTYPE+a.COMPOSITE_INDEX_DELIMITER+n.MetadataFields.ASSOCIATED_ENTITY_LOGICAL_NAME);t.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath=c;var d=new i.KeyPath(n.MetadataFields.METADATA_TYPE+a.COMPOSITE_INDEX_DELIMITER+n.MetadataFields.DISPLAY_NAME);t.metadataTypeNormalizedDisplayNameKeyPath=d},Vj0X:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getEntityResponseData=t.retrieveResponseHandler=void 0;var u=r("bOB9"),l=r("r9V9"),c=r("ZRE3"),d=r("Y0ua"),p=r("Ag5+"),f=i(r("88gK")),y=r("+1in");function h(e,t,r,a,n,i){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var o;return s(this,(function(s){switch(s.label){case 0:return"",[4,m(e,t,r,a,n,i)];case 1:return(o=s.sent())["@odata.context"]=e.url,[2,JSON.stringify(o)]}}))}))}function m(e,t,r,a,n,i){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var c,d,h,m,g;return s(this,(function(E){switch(E.label){case 0:return c={},d=[],[4,p.getEntityNameFromUrl(e.url,t,r,n)];case 1:return h=E.sent(),d.push({name:"EntityLogicalName",value:h}),(m=a[0].rows.item(0))?(g=!1,y.headerContainsPreferAnnotation(e)&&(g=!0),[4,y.getFormattedRecordData(t,m,h,g)]):[3,5];case 2:return(c=E.sent())["@odata.type"]=h,i&&i.ContainsActivityPartyQuery&&function(e,t,r,a,n){o(this,void 0,void 0,(function(){var i,o,u,l,c,d;return s(this,(function(s){switch(s.label){case 0:if(!(t.length>0))return[3,5];i={},o=0,s.label=1;case 1:return o<t.length?[4,y.getFormattedRecordData(n,t.item(o),f.activityParty,a)]:[3,4];case 2:u=s.sent(),i[u[f.participationMasks]]?i[u[f.participationMasks]].push(u):i[u[f.participationMasks]]=[u],s.label=3;case 3:return o++,[3,1];case 4:for(l in i)i[l]&&r[+l]&&(c=i[l],d=r[+l],e[d]={entities:c,morerecords:!1,totalrecordcount:c.length,totalRecordCountLimitExceeded:!1});s.label=5;case 5:return[2,e]}}))}))}(c,a[i.ActivityPartyQueryIndex].rows,i.ParticipationMasks,g,t),i&&i[u.EXPAND_PROPERTIES]?[4,b(c,a,g,t,i)]:[3,4];case 3:E.sent(),E.label=4;case 4:return t.EventManager.ReportComponentSuccess(v(),l.addEventParameters(n,d)),[3,6];case 5:r.error(v()+" No response retrieved from offline DB for this request",n),E.label=6;case 6:return[2,c]}}))}))}function b(e,t,r,a,n){return o(this,void 0,void 0,(function(){var i,o,l,c,d,p,f,h,m,b,v;return s(this,(function(s){switch(s.label){case 0:i=0,s.label=1;case 1:if(!(i<n[u.EXPAND_PROPERTIES].length))return[3,8];if(o=n[u.EXPAND_PROPERTIES][i],l=o.ExpandPropertyName,c=o.ExpandValueType,d=o.ExpandQueryIndex,p=o.ReferencedOrReferencingEntityName,!(f=t[d].rows))return[3,7];if(c!==u.EXPAND_VALUES.MULTI_VALUE)return[3,5];h=0,m=[],s.label=2;case 2:return h<f.length?(b=f.item(h),[4,y.getFormattedRecordData(a,b,p,r)]):[3,4];case 3:return v=s.sent(),m.push(v),h++,[3,2];case 4:return e[l]=m,[3,7];case 5:return b=f.item(0),[4,y.getFormattedRecordData(a,b,p,r)];case 6:v=s.sent(),e[l]=v,s.label=7;case 7:return i++,[3,1];case 8:return[2]}}))}))}function v(e){return e?"["+e+"]":"["+d.FILE_PREFIX.BPFResponseHandler+"]"}t.retrieveResponseHandler=function(e,t,r,a,n,i){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var o,l,d,p;return s(this,(function(s){switch(s.label){case 0:return(l=new Headers).set(u.HEADER.CONTENT_TYPE,u.HEADER_VALUES.APPLICATION_JSON),r.info(v()+" Processing the retrieve response",n),(d=a)&&d.length>0?[4,h(e,t,r,d,n,i)]:[3,2];case 1:return p=s.sent(),o=y.buildOdataResponse(u.HTTP_STATUS_CODES.Ok,e.url,l,p),[3,3];case 2:r.error(v()+" No response retrieved from offline DB for this request",n),o=y.buildErrorResponse(u.HTTP_STATUS_CODES.Unknown,e.url,new c.LocalError("No response retrieved from offline DB for this request")),s.label=3;case 3:return[2,o]}}))}))},t.getEntityResponseData=m},Vnn7:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ApplicationMetadataQuery=void 0;var a=r("pqvw"),n=r("Ct6E"),i=r("VejF"),o=function(){function e(e,t,r,i,o,s,u,l){if(this._metadataType=0,this._metadataSubtype=0,this._formFactor=0,this._isDefault=!1,this._applicationMetadataType=0,this._isDefaultSpecified=!1,!e)throw new Error("Invalid application metadata type");this._metadataType=e,this._formFactor=t,this._associatedEntityLogicalName=r,this._applicationMetadataType=a.isNullOrUndefined(i)?n.ApplicationMetadataType.systemApplicationMetadata:i,this._isDefaultSpecified=!a.isNullOrUndefined(o),this._isDefault=!!this._isDefaultSpecified&&o,this._sourceId=s||"",this._metadataSubtype=u||0,this._normalizedDisplayName=l||""}return e.prototype.checkApplicationMetadata=function(e){return(!this.get_metadataType()||e.metadatatype===this.get_metadataType())&&(!(!a.isNullOrUndefined(this.get_metadataSubtype())&&this.get_metadataSubtype()!==n.MetadataSubtype.none&&e.metadatasubtype!==this.get_metadataSubtype())&&(!(!a.isNullOrUndefinedOrEmptyString(this.get_sourceId())&&e.sourceid!==this.get_sourceId())&&(!(!a.isNullOrUndefinedOrEmptyString(this.get_associatedEntityLogicalName())&&e.associatedentitylogicalname!==this.get_associatedEntityLogicalName())&&(!(this.get_formFactor()>0&&e.formfactor!==this.get_formFactor())&&(!(this._isDefaultSpecified&&this._isDefault&&a.isNullOrUndefined(e.isdefault||!e.isdefault))&&(!(this._applicationMetadataType===n.ApplicationMetadataType.userApplicationMetadata&&!e.isuserrecord)&&!(!a.isNullOrUndefinedOrEmptyString(this.get_normalizedDisplayName())&&this.get_normalizedDisplayName()!==e.displayname.toUpperCase())))))))},e.prototype.get_keyPath=function(){return a.isNullOrUndefinedOrEmptyString(this.get_sourceId())?a.isNullOrUndefinedOrEmptyString(this.get_normalizedDisplayName())?a.isNullOrUndefinedOrEmptyString(this.get_associatedEntityLogicalName())||a.isNullOrUndefined(this.get_metadataSubtype())?a.isNullOrUndefinedOrEmptyString(this.get_associatedEntityLogicalName())?i.metadataTypeKeyPath:i.metadataTypeAssociatedEntityLogicalNameKeyPath:i.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath:i.metadataTypeNormalizedDisplayNameKeyPath:i.metadataTypeSourceIdKeyPath},e.prototype.get_keyValue=function(){var e=this.get_metadataType().toString(),t=this.get_keyPath();if(t===i.metadataTypeSourceIdKeyPath)return e+a.COMPOSITE_INDEX_DELIMITER+this.get_sourceId();if(t===i.metadataTypeAssociatedEntityLogicalNameKeyPath)return e+a.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName();if(t===i.metadataTypeMetadataSubtypeAssociatedEntityLogicalNameKeyPath){var r=this.get_metadataSubtype().toString();return e+a.COMPOSITE_INDEX_DELIMITER+r+a.COMPOSITE_INDEX_DELIMITER+this.get_associatedEntityLogicalName()}return t===i.metadataTypeNormalizedDisplayNameKeyPath?e+a.COMPOSITE_INDEX_DELIMITER+this.get_normalizedDisplayName():this.get_metadataType()},e.prototype.get_metadataType=function(){return this._metadataType},e.prototype.get_metadataSubtype=function(){return this._metadataSubtype},e.prototype.get_formFactor=function(){return this._formFactor},e.prototype.get_associatedEntityLogicalName=function(){return this._associatedEntityLogicalName},e.prototype.get_sourceId=function(){return this._sourceId},e.prototype.get_normalizedDisplayName=function(){return this._normalizedDisplayName},e}();t.ApplicationMetadataQuery=o},Wysk:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ODataExecutor=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i=r("bOB9"),o=r("r9V9"),s=r("r9V9"),u=r("pqvw"),l=r("J0xV"),c=r("Y0ua"),d=r("H+3G"),p=r("E2wc"),f=function(){function e(e,t){this._applicationContext=t,this._oDataClientManager=new p.ODataClientManager(e||{},this._applicationContext)}return e.prototype.execute=function(e){return a(this,void 0,void 0,(function(){var t,r,a,p,f,y,h,m,b,v,g,E,T,_;return n(this,(function(n){switch(n.label){case 0:(t=new l.PerformanceControl).startMarker(c.FILE_PREFIX.ODataExecutor),r=this._applicationContext.TraceManager.getTracer(c.COMPONENT_NAMES.ODataExecutor),a=[],s.addRequestDetailsToEventParameters(e,a),n.label=1;case 1:return n.trys.push([1,6,,7]),p=this._oDataClientManager.getODataClient(e),f=d.getRequestType(e,this._applicationContext),y={requestType:f,commonEventParameters:a,performanceControl:t},[4,p.execute(e,y)];case 2:return h=n.sent(),m=h.clone(),t.endMarker(c.FILE_PREFIX.ODataExecutor),h.ok?(o.addResponseDetailsToEventParameters(m,a),b=u.getClientType(e,r,a),v=[c.FILE_PREFIX.ODataExecutor,c.FILE_PREFIX.ResponseHandler],b===i.CLIENT_TYPE.local&&(v=v.concat([c.FILE_PREFIX.SQLGenerator,c.FILE_PREFIX.MetadataSQLExecutor,c.FILE_PREFIX.DataSQLExecutor])),o.addExecutionTimeDetails(t,v,a),this._applicationContext.EventManager.ReportComponentSuccess(c.COMPONENT_NAMES.ODataExecutor,a),[3,5]):[3,3];case 3:return[4,o.addResponseErrorInformationToEventParameters(m,a)];case 4:if(a=n.sent(),g=h.status,r.warn("["+c.FILE_PREFIX.ODataExecutor+"] Request returns Error Response with status code: "+g,a),i.UNEXPECTED_STATUS_CODE.includes(g)){for(_="Request Failed",E=0;E<a.length;E++)if(a[E].name===c.EVENT_PARAMETERS.ERROR_MESSAGE&&a[E].value!==c.EVENT_PARAMETERS.EMPTY_STRING){_=a[E].value;break}this._applicationContext.EventManager.ReportComponentFailure(c.COMPONENT_NAMES.ODataExecutor,new Error(_),void 0,a)}n.label=5;case 5:return[2,h];case 6:return T=n.sent(),_=T&&T.message?T.message:"OData Request Failed",T&&(T.message=_),o.addErrorInformationToEventParameters(T,a),r.error("["+c.FILE_PREFIX.ODataExecutor+"] "+_,a),this._applicationContext.EventManager.ReportComponentFailure(c.COMPONENT_NAMES.ODataExecutor,new Error(_),void 0,a),[2,u.buildODataResponseFromError(T,e.url)];case 7:return[2]}}))}))},e}();t.ODataExecutor=f},XGkY:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Guid=void 0;var a=r("Y0ua"),n=r("i2et"),i=r("lMa+"),o=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,s=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/,u=function(){function e(t,r){if(void 0===r&&(r=!1),r)this.guid=t;else{var a=e._formatGuidString(t);if(!a)throw new Error(t+" is not a valid Guid value.");this.guid=a}Object.freeze(this)}return e.externalGuid=function(t){return t&&t.guid?"{"+t.guid.toUpperCase()+"}":e.EMPTYSTRING},e.fromExternalGuid=function(t,r){return typeof t===n.AttributeType.String&&t.trim().length>0?new e(t.replace(/[\{\}]/gi,"")):(r&&r.warn(a.FILE_PREFIX.Common+" Empty string or invalid object used to form GUID. Returning empty GUID."),e.EMPTY)},e.validate=function(e){return null!=e&&null!==o.exec(e)},e.toString=function(e){return e?e.guid:null},e.tryParse=function(t){return e.tryParseOrNull(t)||e.EMPTY},e.tryParseOrNull=function(t){var r=e._formatGuidString(t);return r?new e(r,!0):null},e.parse=function(t){return new e(t)},e.toLegacyGuid=function(e){return e?i.LegacyGuid.createFromFormattedGuidStringAndSkipParsing(e.guid):null},e.fromLegacyGuid=function(t){if(t){var r=t.toString();if(r)return new e(r,!0)}return null},e.equals=function(t,r){return null==t||null==r?t===r:e.toString(t)===e.toString(r)},e.isNullOrEmpty=function(t){return!t||e.equals(t,e.EMPTY)},e.newGuid=function(){for(var t="",r=0;r<36;r++)if(14===r)t+="4";else if(8===r||13===r||18===r||23===r)t+="-";else if(19===r){var a=Math.floor(16*Math.random());t+="0123456789abcdef".substr(3&a|8,1)}else t+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new e(t,!0)},e._formatGuidString=function(e){if(!e||"string"!=typeof e)return null;e=e.toLowerCase();var t=o.exec(e);if(t)return t[1].length!==t[8].length?null:t[2];var r=s.exec(e);return r?r.filter((function(e,t){return t>0})).join("-"):null},e.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",e.EMPTY=new e(e.EMPTYGUIDSTRING,!0),e.EMPTYSTRING="",e}();t.Guid=u},Y0ua:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.ScenarioType=t.EVENT_PARAMETERS=t.COMPONENT_NAMES=t.FILE_PREFIX=t.MDL_COMPONENT_NAME=void 0,t.MDL_COMPONENT_NAME="ModernDataLayer",t.FILE_PREFIX={GetSqlResults:"GetSqlResults",MetadataCache:"MetadataCache",SQLGenerator:"SQLGenerator",PolicyManager:"PolicyManager",PromiseCache:"PromiseCache",CreateResponseHandler:"CreateResponseHandler",DeleteResponseHandler:"DeleteResponseHandler",GetClientMetadataResponseHandler:"GetClientMetadataResponseHandler",UpdateResponseHandler:"UpdateResponseHandler",RetrieveResponseHandler:"RetrieveResponseHandler",BPFResponseHandler:"BPFResponseHandler",RetrieveMultipleResponseHandler:"RetrieveMultipleResponseHandler",FileExecutor:"FileExecutor",QueryGenerator:"QueryGenerator",ResponseHandler:"ResponseHandler",SQLExecutor:"SQLExecutor",UrlParserHandler:"UrlParserHandler",LocalODataClientManager:"LocalODataClientManager",ODataClientManager:"ODataClientManager",ODataExecutor:"ODataExecutor",DeleteGenerator:"DeleteGenerator",RetrieveMultipleGenerator:"RetrieveMultipleGenerator",SQLModifier:"SQLModifier",UpdateGenerator:"UpdateGenerator",PolicyRetryInterceptor:"PolicyRetryInterceptor",TimeoutInterceptor:"TimeoutInterceptor",ExecuteRequestInterceptor:"ExecuteRequestInterceptor",RequestResponseInterceptor:"RequestResponseInterceptor",LongRequestInterceptor:"LongRequestInterceptor",FileRequestInterceptor:"FileRequestInterceptor",SQLRequestInterceptor:"SQLRequestInterceptor",HttpExecutorInterceptor:"HttpExecutorInterceptor",PromiseCacheInterceptor:"PromiseCacheInterceptor",GCMGenerator:"GCMGenerator",Common:"Common",RootFinder:"RootFinder",MetadataSQLExecutor:"MetadataSQLExecutor",DataSQLExecutor:"DataSQLExecutor",CreateGenerator:"CreateGenerator",QuickFindSQLGenerator:"QuickFindSQLGenerator",MergeQuickFindSQLGenerator:"MergeQuickFindSQLGenerator",RetrieveGenerator:"RetrieveGenerator",ApplyFilterSQLGenerator:"ApplyFilterSQLGenerator",ApplyFinalModifiedSQLGenerator:"ApplyFinalModifiedSQLGenerator",ApplySelectSQLGenerator:"ApplySelectSQLGenerator",ApplyOrderBySQLGenerator:"ApplyOrderBySQLGenerator"},t.COMPONENT_NAMES={ODataExecutor:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.ODataExecutor,RemoteODataExecutor:t.MDL_COMPONENT_NAME+".RemoteODataExecutor",LocalODataExecutor:t.MDL_COMPONENT_NAME+".LocalODataExecutor",SQLExecutor:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.SQLExecutor,FileExecutor:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.FileExecutor,SQLGenerator:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.QueryGenerator,ResponseHandler:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.ResponseHandler,UrlParserHandler:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.UrlParserHandler,MetadataCache:t.MDL_COMPONENT_NAME+"."+t.FILE_PREFIX.MetadataCache},t.EVENT_PARAMETERS={HTTP_STATUS_CODE:"HTTP-Status-Code",HTTP_RESPONSE_TYPE:"HTTP-Response-Type",HTTP_RESPONSE_STATUS_TEXT:"HTTP-Response-Status-Text",RESPONSE_URL:"Response-Url",RESPONSE_SIZE_IN_BYTES:"Response-Size-In-Bytes",ERROR_CODE:"Error-Code",ERROR_MESSAGE:"Error-Message",ERROR_STACK:"Error-Stack",ERROR_COMPLETE_TEXT:"Error-Complete-Text",CLIENT_TYPE:"Client-Type",RESPONSE_TIME:"Response-Time",CLIENT_REQUEST_ID:"Client-Request-Id",SERVER_REQUEST_ID:"Server-Request-Id",OPERATION_TYPE:"Operation-Type",END_POINT:"EndPoint",METHOD:"Method",EMPTY_STRING:"",SQL_ERROR_CODE:"SqlErrorCode",SQL_ERROR_MESSAGE:"SqlErrorMessage"},function(e){e.Create="Create",e.Delete="Delete",e.Load="Load",e.Update="Update"}(t.ScenarioType||(t.ScenarioType={}))},Y4g1:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateSQL=void 0;var i=r("bOB9"),o=r("Y0ua"),s=r("H+3G"),u=r("TYeF"),l=r("2JPV"),c=r("FnTd"),d=r("uit8"),p=r("nN45"),f=r("f9xj"),y=r("k++F");function h(e){return e?"["+e+"]":"["+o.FILE_PREFIX.SQLGenerator+"]"}t.generateSQL=function(e,t,r){return void 0===r&&(r={}),a(this,void 0,void 0,(function(){var a,m,b;return n(this,(function(n){switch(a=t.TraceManager.getTracer(o.COMPONENT_NAMES.SQLGenerator),m=r.commonEventParameters||[],a.info(h()+" Query Generator start processing.",m),s.getRequestType(e,t)){case i.OPERATION.Create:return[2,l.generateCreateRequests(e,t,a,r)];case i.OPERATION.RetrieveMultiple:return[2,f.generateRetrieveMultipleRequests(e,t,a,r)];case i.OPERATION.Update:return[2,y.generateUpdateRequests(e,t,a,r)];case i.OPERATION.Delete:return[2,c.generateDeleteRequests(e,t,a,r)];case i.OPERATION.GetClientMetadata:return[2,d.generateGCMRequests(e,t,a,r)];case i.OPERATION.Retrieve:return[2,p.generateRetrieveRequest(e,t,a,r)];case i.OPERATION.Batch:return[2,u.generateBatchRequests(e,t,a,r)];default:throw b="Unsupported request type",a.error(h()+" Query Generator Failed with "+b,m),new Error(b)}return[2]}))}))}},YWuQ:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getGCMOperationResponseData=t.getClientMetadataResponseHandler=void 0;var i=r("bOB9"),o=r("r9V9"),s=r("pqvw"),u=r("Ct6E"),l=r("Y0ua"),c=r("jD1M"),d=r("uit8"),p=r("+1in");function f(e,t){var r;if(s.isUserContextMetadataRequest(t))r="UserContext";else switch(e){case u.MetadataType.none:r="none";break;case u.MetadataType.workspace:r="Dashboards";break;case u.MetadataType.form:r="Forms";break;case u.MetadataType.component:r="Component";break;case u.MetadataType.entityCard:r="EntityCard";break;case u.MetadataType.quickCreateForm:r="QuickCreateForm";break;case u.MetadataType.customization:r="Customization";break;case u.MetadataType.listQuery:r="ListQuery";break;case u.MetadataType.grid:r="Grid";break;case u.MetadataType.command:r="Ribbons";break;case u.MetadataType.siteMap:r="Sitemap";break;case u.MetadataType.list:r="List";break;case u.MetadataType.dialog:r="Dialogs";break;case u.MetadataType.gridForm:r="GridForm";break;case u.MetadataType.inlineCreateForm:r="InlineCreateForm";break;case u.MetadataType.processControl:r="ProcessControl";break;case u.MetadataType.fetchXml:r="FetchXml";break;case u.MetadataType.chartDrilldownForm:r="ChartDrilldownForm";break;case u.MetadataType.entity:r="Entities";break;case u.MetadataType.attribute:r="Attributes";break;case u.MetadataType.webResource:r="WebResourcesContent";break;case u.MetadataType.applicationMetadata:r="ApplicationMetadata";break;case u.MetadataType.mainFormDialog:r="QuickEditForm";break;case u.MetadataType.chart:r="Chart";break;case u.MetadataType.uiStrings:r="UIStrings";break;case u.MetadataType.businessLogic:r="BusinessLogic";break;case u.MetadataType.searchPage:r="SearchPage";break;case u.MetadataType.globalApplicationMetadata:r="GlobalApplicationMetadata";break;case u.MetadataType.applicationMetadataUserContext:r="ApplicationMetadataUserContext";break;case u.MetadataType.staticJSFile:r="StaticJSFile";break;case u.MetadataType.layoutXml:r="LayoutXml";break;case u.MetadataType.draftsPage:r="DraftsPage";break;case u.MetadataType.duplicateRecordsPage:r="DuplicateRecordsPage";break;case u.MetadataType.applicationMetadataSettings:r="ApplicationMetadataSettings";break;case u.MetadataType.senderFormPage:r="SenderFormPage";break;case u.MetadataType.setRegarding:r="SetRegarding";break;case u.MetadataType.senderCreateFormPage:r="SenderCreateFormPage";break;case u.MetadataType.interactionCentricWorkspace:r="Dashboards";break;case u.MetadataType.taskBasedFlowGlobalMenu:r="TaskBasedFlowGlobalMenu";break;case u.MetadataType.taskBasedFlow:r="TaskBasedFlows";break;case u.MetadataType.interactionCentricForm:r="InteractionCentricForm";break;case u.MetadataType.cardForm:r="CardForm";break;case u.MetadataType.controlConfiguration:r="ControlConfiguration";break;case u.MetadataType.commandXaml:r="CommandXaml";break;case u.MetadataType.documentTemplate:r="DocumentTemplate";break;case u.MetadataType.viewSelector:r="ViewSelectors";break;case u.MetadataType.customControl:r="CustomControls";break;case u.MetadataType.formSelector:r="FormSelectors";break;case u.MetadataType.resourceString:r="ResourceStrings";break;case u.MetadataType.savedQueryVisualization:r="SavedQueryVisualizations";break;case u.MetadataType.label:r="Labels";break;case u.MetadataType.userView:case u.MetadataType.savedView:r="Views";break;case u.MetadataType.viewDefault:r="ViewDefault";break;case u.MetadataType.homePageConfiguration:r="CustomControlConfigurations";break;case u.MetadataType.optionSet:r="OptionSets";break;case u.MetadataType.quickCreateMenu:r="QuickCreateMenu";break;case u.MetadataType.userContext:r="UserContext";break;case u.MetadataType.businessProcessFlow:r="BusinessProcessFlowMetadata";break;case u.MetadataType.searchConfiguration:r="Search";break;case u.MetadataType.userQueryVisualization:r="UserQueryVisualizations";break;case u.MetadataType.visualizationSelector:r="VisualizationSelectors";break;case u.MetadataType.dashboardSelector:r="DashboardSelectors";break;case u.MetadataType.overallMetadataVersion:r="MetadataVersion";break;case u.MetadataType.appModule:r="AppModulePublished";break;case u.MetadataType.complexControl:r="ComplexControls";break;case u.MetadataType.displayString:r="DisplayStrings";break;case u.MetadataType.webResourceDescriptor:r="WebResources";break;case u.MetadataType.isActivityFlags:r="IsActivityFlags";break;case u.MetadataType.appModuleOfflineMetadata:r="AppModules";break;case u.MetadataType.appModuleSelector:r="AppModuleSelector";break;case u.MetadataType.bpfSelector:r="BPFSelectors";break;case u.MetadataType.dependencies:r="dependencies"}return r}function y(e,t,r){var a,n=JSON.parse(e);if(s.isUserContextMetadataRequest(r))a=n;else switch(t){case u.MetadataType.attribute:case u.MetadataType.entity:a=n;break;case u.MetadataType.searchConfiguration:a=n.data.Search;break;case u.MetadataType.quickCreateMenu:a=n.data.QuickCreateMenu;break;default:a=n.data}return a}function h(e){switch(e){case u.MetadataType.quickCreateMenu:case u.MetadataType.searchConfiguration:return!0;default:return!1}}function m(e,t,r,i,l,c){return void 0===l&&(l=[]),a(this,void 0,void 0,(function(){var e,a,p,m,g,E,T,_,S,O,N,M,P,w;return n(this,(function(n){if("",e=i,a={},p={},m=[],g=d.extractClientMetadataQuery(t,r),m.push({name:"RequestUrl",value:t.url}),m.push({name:"MetadataType",value:g.MetadataType}),m.push({name:"DependencyDepth",value:g.DependencyDepth}),m.push({name:"MetadataSubtype",value:g.MetadataSubtype}),r.info(v()+" Executing getGCMOperationResponseData",o.addEventParameters(l,m)),e&&e.length>0)for(E=0;E<e.length;E++)if((m=[]).push({name:"NoOfResponsesReturnedFromDb",value:e.length}),m.push({name:"Index",value:E}),m.push({name:"RequestUrl",value:t.url}),e[E]&&e[E].rows.length>0)for(T=0;T<e[E].rows.length;T++)(_=e[E].rows.item(T))&&_.json?(S=_.json,O=JSON.parse(S),void 0,M=b(_,O,E,c),N=f(M,g),m.push({name:"MetadataType",value:M}),s.isNullOrUndefined(N)?r.error(v()+" MetadataTypeKey evaluated to be null or empty",o.addEventParameters(l,m)):(m.push({name:"MetadataTypeKey",value:N}),P=y(S,M,g),h(M)?(r.info(v()+" Creating response node for current MetaDataType."+N+". Taking response as it is as the response is already in required format",o.addEventParameters(l,m)),p[N]=P):p[N]?(M===u.MetadataType.resourceString?((w=p[N][0]).push(P),p[N]=[w]):p[N].push(P),m.push({name:"NoOfMetadataForThisMetadataTypeKey",value:p[N].length}),r.info(v()+" Adding response for current MetaDataType."+N,o.addEventParameters(l,m))):(p[N]=[P],M===u.MetadataType.resourceString&&(p[N]=[p[N]]),m.push({name:"NoOfMetadataForThisMetadataTypeKey",value:1}),r.info(v()+" Creating new response node for current MetaDataType."+N,o.addEventParameters(l,m))))):r.warn(v()+" Response returned from offline db has empty json.",o.addEventParameters(l,m));else r.warn(v()+" Response returned from offline db is empty at current index.",o.addEventParameters(l,m));else r.warn(v()+" Response returned from offline db is empty",o.addEventParameters(l,m));return a.Metadata=JSON.stringify(p),[2,JSON.stringify(a)]}))}))}function b(e,t,r,a){u.MetadataType.none;return e.metadatatype?e.metadatatype:t.metadatatype?t.metadatatype:a&&a[c.MetadataFields.METADATA_TYPE]&&Array.isArray(a[c.MetadataFields.METADATA_TYPE])&&r<a[c.MetadataFields.METADATA_TYPE].length?a[c.MetadataFields.METADATA_TYPE][r]:u.MetadataType.entity}function v(e){return e?"["+e+"]":"["+l.FILE_PREFIX.GetClientMetadataResponseHandler+"]"}t.getClientMetadataResponseHandler=function(e,t,r,o,s,u){return void 0===s&&(s=[]),a(this,void 0,void 0,(function(){var a,l;return n(this,(function(n){switch(n.label){case 0:return a=e.url,r.info(v()+" Executing getClientMetadataResponseHandler."),[4,m(t,e,r,o,s,u)];case 1:return l=n.sent(),[2,p.buildOdataResponse(i.HTTP_STATUS_CODES.Ok,a,new Headers,l)]}}))}))},t.getGCMOperationResponseData=m},YoDU:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.setFieldValue=void 0,t.setFieldValue=function(e,t,r,a){e.values[t]=r,t in e.attributeTypes||(e.attributeTypes[t]=a)}},Z84h:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.getUserContextResults=t.getAttributesSqlResults=t.getEntitySqlResults=t.getViewSqlResults=t.fromNumberAttributeType=t.getAttributesMetadata=t.populateAllEntityMetadata=t.getEntityMetadata=t.getViewMetadata=t.isFeatureEnabled=t.getUserName=t.getUserId=t.getLanguageCode=t.getfullnameconventioncode=t.getOrganizationSettings=t.getUserSettings=t.getAttributeTypes=t.getEntityLogicalName=t.metadataCache=void 0;var d=r("pqvw"),p=r("ZRE3"),f=r("Y0ua"),y=r("kwGv"),h=r("onZ8"),m=r("i2et"),b=i(r("rMjw")),v=r("uCvz"),g=r("7EEb"),E=r("mklL"),T=r("XGkY"),_=r("6Use");function S(e,t,r){if(void 0===r&&(r=[]),!d.isNullOrUndefined(e))for(var a in e)if(a){var n=e[a];if(n&&n.EntitySetName===t)return n.EntityLogicalName}return null}function O(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o;return s(this,(function(s){switch(s.label){case 0:a.push({name:"entity",value:r}),n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),s.label=1;case 1:return s.trys.push([1,5,,6]),t.metadataCache.entities&&t.metadataCache.entities[r]?[3,3]:[4,x(e,r,a)];case 2:return s.sent(),t.metadataCache.entities&&t.metadataCache.entities[r]?[2,t.metadataCache.entities[r]]:(i="Entity metadata is not available",n.error(he()+" "+i,a),[2,Promise.reject(new p.LocalError(i))]);case 3:return[2,t.metadataCache.entities[r]];case 4:return[3,6];case 5:return o=s.sent(),n.error(he()+" "+o.message,a),[2,Promise.reject(o)];case 6:return[2]}}))}))}function N(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n,i,o,u,l,c,y,h,m,b,v,T;return s(this,(function(s){switch(s.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,se(e,r)];case 1:if(n=s.sent(),i=0,o={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},"SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",d.isNullOrUndefined(n)||!(n.length>0))return[3,3];for(i=0;i<n.length;i++)u=n.item(i),l=u.logicalname,c=[l],o.sqlStatements.push("SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?"),o.sqlParameters.push(c);return[4,E.getBatchSqlResults(e,o)];case 2:if(!(y=s.sent())||!y.length)throw T="requested entity metadata not found",a.error(he()+" "+T,r),new Error(T);for(i=0;i<y.length;i++)h=y[i].rows.item(0),m=JSON.parse(h.json),b=g.EntityMetadata.createFromObjectData(m),k(v=b.getODataObject(),v.LogicalName);return[2,t.metadataCache.entities];case 3:return T="No entities returned from entity metadata db when populating all entity metadata",a.error(he()+" "+T,r),[2,Promise.reject(new p.LocalError(T))]}}))}))}function M(e,r,a,n){return void 0===n&&(n=[]),o(this,void 0,void 0,(function(){var i;return s(this,(function(u){i=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return[2,P(e,r,a).then((function(i){return function(e,t,r,a){void 0===a&&(a=[]);return o(this,void 0,void 0,(function(){var n,i,o,u,l;return s(this,(function(s){switch(s.label){case 0:return n={},r.length?[4,oe(e,t,r,a)]:[3,2];case 1:if((i=s.sent())&&Object.keys(i).length>0)for(o in i)i.hasOwnProperty(o)&&(u=i[o],l=w(u),n[o]=l);s.label=2;case 2:return[2,n]}}))}))}(e,r,i,n).then((function(e){if(t.metadataCache.attributes[r]=Object.assign({},t.metadataCache.attributes[r],e),a&&a.length){var n={};return a.forEach((function(e){n[e]=t.metadataCache.attributes[r][e]})),n}return t.metadataCache.attributes[r]}))}))]}catch(e){return i.error(he()+" Error when fetching attribute metadata for "+r+" "+e.message,n),[2,Promise.reject(e)]}return[2]}))}))}function P(e,r,a){return o(this,void 0,void 0,(function(){var n,i,o,u,l,d;return s(this,(function(s){switch(s.label){case 0:return n=c(a),[4,O(e,r)];case 1:for(i=s.sent(),o=i.AttributeNames,a&&a.length||(n=o),o.indexOf("statecode")>=0&&n.indexOf("statecode")<0&&n.push("statecode"),o.indexOf("statuscode")>=0&&n.indexOf("statuscode")<0&&n.push("statuscode"),u=t.metadataCache.attributes&&t.metadataCache.attributes[r]?t.metadataCache.attributes[r]:{},l=[],d=0;d<n.length;d++)u[n[d]]||l.push(n[d]);return[2,l]}}))}))}function w(e){var t=e,r=v.DateTimeFieldBehavior.None;if(t.DateTimeBehavior)for(var a in t.DateTimeBehavior)if(t.DateTimeBehavior.hasOwnProperty(a))switch(t.DateTimeBehavior[a]){case"None":r=v.DateTimeFieldBehavior.None;break;case"DateOnly":r=v.DateTimeFieldBehavior.DateOnly;break;case"TimeZoneIndependent":r=v.DateTimeFieldBehavior.TimeZoneIndependent;break;case"UserLocal":r=v.DateTimeFieldBehavior.UserLocal;break;default:r=v.DateTimeFieldBehavior.None}return{LogicalName:e.LogicalName,Id:T.Guid.tryParseOrNull(e.MetadataId),EntityLogicalName:t.EntityLogicalName,Type:L(e),DisplayName:z(t.DisplayName),Description:z(t.Description),IsGlobalFilterEnabled:!!t.IsGlobalFilterEnabled&&t.IsGlobalFilterEnabled.Value,IsSecured:t.IsSecured,IsSortableEnabled:!!t.IsSortableEnabled&&t.IsSortableEnabled.Value,IsEntityReferenceStored:t.IsEntityReferenceStored,IsValidForAdvancedFind:!!t.IsValidForAdvancedFind&&t.IsValidForAdvancedFind.Value,IsValidForCreate:t.IsValidForCreate,IsValidForRead:t.IsValidForRead,IsValidForUpdate:t.IsValidForUpdate,IsRetrievable:t.IsRetrievable,IsCustomAttribute:t.IsCustomAttribute,ColumnNumber:t.ColumnNumber,MaxLength:t.MaxLength,MinValue:t.MinValue,MaxValue:t.MaxValue,Precision:t.Precision,PrecisionSource:t.PrecisionSource,Format:R(t),Behavior:r,DefaultFormValue:t.DefaultFormValue,DefaultValue:"boolean"==typeof t.DefaultValue?t.DefaultValue:t.DefaultFormValue,IsBaseCurrency:t.IsBaseCurrency,Targets:t.Targets,AttributeOf:t.AttributeOf,HasChanged:t.HasChanged,ImeMode:A(t.ImeMode),OptionSetId:t.OptionSet&&t.OptionSet.MetadataId?t.OptionSet.MetadataId:null,OptionSetName:t.OptionSet&&t.OptionSet.Name?t.OptionSet.Name:null,OptionSetType:t.OptionSet?t.OptionSet.OptionSetType:null,OptionSet:C(t.OptionSet),ParentPicklistLogicalName:t.OptionSet&&t.ParentPicklistLogicalName?t.ParentPicklistLogicalName:null,ChildPicklistLogicalNames:t.OptionSet&&t.ChildPicklistLogicalNames?t.ChildPicklistLogicalNames:null,RequiredLevel:F(t.RequiredLevel),SourceType:t.SourceType,SourceTypeMask:t.SourceTypeMask,InheritsFrom:t.InheritsFrom,CanBeSecuredForCreate:t.CanBeSecuredForCreate,CanBeSecuredForRead:t.CanBeSecuredForRead,CanBeSecuredForUpdate:t.CanBeSecuredForUpdate}}function C(e){var t,r,a=[];if(e&&(a=[],e.FalseOption&&a.push(I(e.FalseOption)),e.TrueOption&&a.push(I(e.TrueOption)),e.Options)){var n=e.Options;try{for(var i=u(n),o=i.next();!o.done;o=i.next()){var s=o.value;a.push(I(s))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}}return a}function I(e){var t=e.TransitionData;return{Color:e.Color,Label:z(e.Label),Value:e.Value,DefaultStatus:e.DefaultStatus,State:e.State,TransitionData:t?[]:null,InvariantName:e.InvariantName,ParentValues:e.ParentValues}}function A(e){if("string"!=typeof e)return"number"==typeof e?e:null;switch(e){case"Auto":return 0;case"Inactive":return 1;case"Active":return 2;case"Disabled":return 3;default:return null}}function R(e){var t=e,r=t.FormatName?t.FormatName.Value:null;return function(e,t,r){if(t)return t;var a="";if(null==r)a=r;else if(e&&e===m.AttributeType.DateTime)switch(r){case y.DateTimeFormat.DateOnly:a=m.AttributeType.Date;break;case y.DateTimeFormat.DateAndTime:a=m.AttributeType.DateTime;break;default:a=r.toString()}else a=r.toString();return a}(D(t.AttributeType),r,t.Format)}function D(e){switch(e){case _.NumberAttributeType.Boolean:return m.AttributeType.Boolean;case _.NumberAttributeType.Customer:return m.AttributeType.Customer;case _.NumberAttributeType.DateTime:return m.AttributeType.DateTime;case _.NumberAttributeType.Decimal:return m.AttributeType.Decimal;case _.NumberAttributeType.Double:return m.AttributeType.Double;case _.NumberAttributeType.Integer:return m.AttributeType.Integer;case _.NumberAttributeType.Lookup:return m.AttributeType.Lookup;case _.NumberAttributeType.Memo:return m.AttributeType.Memo;case _.NumberAttributeType.Money:return m.AttributeType.Money;case _.NumberAttributeType.Owner:return m.AttributeType.Owner;case _.NumberAttributeType.PartyList:return m.AttributeType.PartyList;case _.NumberAttributeType.Picklist:return m.AttributeType.PickList;case _.NumberAttributeType.State:return m.AttributeType.State;case _.NumberAttributeType.Status:return m.AttributeType.Status;case _.NumberAttributeType.String:return m.AttributeType.String;case _.NumberAttributeType.UniqueIdentifier:return m.AttributeType.UniqueIdentifier;case _.NumberAttributeType.CalendarRules:return m.AttributeType.CalendarRules;case _.NumberAttributeType.Virtual:return m.AttributeType.Virtual;case _.NumberAttributeType.BigInt:return m.AttributeType.BigInt;case _.NumberAttributeType.ManagedProperty:return m.AttributeType.ManagedProperty;case _.NumberAttributeType.EntityName:return m.AttributeType.EntityName;case _.NumberAttributeType.AliasedValue:return m.AttributeType.AliasedValue;case _.NumberAttributeType.EntityImage:return m.AttributeType.EntityImage;case _.NumberAttributeType.MultiSelectPicklist:return m.AttributeType.MultiSelectPickList;case _.NumberAttributeType.File:return m.AttributeType.File;case _.NumberAttributeType.NavigationProperty:return m.AttributeType.NavigationProperty;default:return m.AttributeType.Unknown}}function L(e){if(!e)return m.AttributeType.Unknown;var t=m.AttributeType.Unknown;return"AttributeTypeName"in e&&e.AttributeTypeName.Value?t=e.AttributeTypeName.Value.replace(/Type/g,""):"AttributeType"in e&&e.AttributeType&&"string"==typeof e.AttributeType&&(t=e.AttributeType),t?"Float"===t?m.AttributeType.Double:t.toLowerCase():m.AttributeType.Unknown}function F(e){if(!d.isNullOrUndefined(e)){var t=void 0;if("string"==typeof(t=d.isNullOrUndefined(e.Value)?e:e.Value))switch(e){case"None":return b.AttributeRequiredLevel.None;case"SystemRequired":return b.AttributeRequiredLevel.SystemRequired;case"ApplicationRequired":return b.AttributeRequiredLevel.ApplicationRequired;case"Recommended":return b.AttributeRequiredLevel.Recommended;default:return b.AttributeRequiredLevel.Unknown}if("number"==typeof t)return t}return-1}function x(e,t,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n;return s(this,(function(i){switch(i.label){case 0:return[4,ue(e,t,r)];case 1:return(a=i.sent())?[4,k(a,t)]:[3,3];case 2:n=i.sent(),i.label=3;case 3:return[2,n]}}))}))}function k(e,r){return o(this,void 0,void 0,(function(){var a,n;return s(this,(function(i){return a={Id:T.Guid.tryParseOrNull(e.Id),EntityLogicalName:e.LogicalName,DisplayName:z(e.DisplayName),EntitySetName:e.EntitySetName,PrimaryKeyName:e.PrimaryIdAttribute,ObjectTypeCode:e.ObjectTypeCode,PrimaryIdAttribute:e.PrimaryIdAttribute,PrimaryNameAttribute:e.PrimaryNameAttribute,PrimaryImageAttribute:e.PrimaryImageAttribute,EntityColor:e.EntityColor,ActivityTypeMask:e.ActivityTypeMask,AutoRouteToOwnerQueue:e.AutoRouteToOwnerQueue,DisplayCollectionName:z(e.DisplayCollectionName),CanTriggerWorkflow:e.CanTriggerWorkflow,Description:z(e.Description),IsDocumentManagementEnabled:e.IsDocumentManagementEnabled,IsOneNoteIntegrationEnabled:e.IsOneNoteIntegrationEnabled,IsMSTeamsIntegrationEnabled:e.IsMSTeamsIntegrationEnabled,IsDocumentRecommendationsEnabled:e.IsDocumentRecommendationsEnabled,IsInteractionCentricEnabled:e.IsInteractionCentricEnabled,IsKnowledgeManagementEnabled:e.IsKnowledgeManagementEnabled,IsActivity:e.IsActivity,IsActivityParty:e.IsActivityParty,IsChildEntity:e.IsChildEntity,IsCollaboration:$(e.IsValidForQueue),IsConnectionsEnabled:$(e.IsConnectionsEnabled),IsCustomEntity:e.IsCustomEntity,IsBusinessProcessEnabled:e.IsBusinessProcessEnabled,IsCustomizable:$(e.IsCustomizable),IsOptimisticConcurrencyEnabled:e.IsOptimisticConcurrencyEnabled,IsImportable:e.IsImportable,IsIntersect:e.IsIntersect,IsMailMergeEnabled:$(e.IsMailMergeEnabled),IsEnabledForCharts:e.IsEnabledForCharts,IsValidForAdvancedFind:e.IsValidForAdvancedFind,IsVisibleInMobileClient:$(e.IsVisibleInMobileClient),IsReadOnlyInMobileClient:$(e.IsReadOnlyInMobileClient),IsOfflineInMobileClient:$(e.IsOfflineInMobileClient),IsQuickCreateEnabled:e.IsQuickCreateEnabled,EntityClientSetting:e.EntityClientSetting,OwnershipType:e.OwnershipType,HasChanged:e.HasChanged,HasStateCode:X(e),IsStateModelAware:e.IsStateModelAware,EnforceStateTransitions:e.EnforceStateTransitions,Privileges:e.Privileges||[],IconVectorName:e.IconVectorName,IsBPFEntity:e.IsBPFEntity,DataProviderId:T.Guid.tryParseOrNull(e.DataProviderId),IsEnabledInUnifiedInterface:!!d.isNullOrUndefined(e.IsVisibleInMobileClient)||(e.IsVisibleInMobileClient.Value||e.IsVisibleInMobileClient.CanBeChanged),VersionNumber:e.VersionNumber,OverallVersionNumber:e.OverallVersionNumber,AttributeNames:e.AttributeNames,IsAuditEnabled:e.IsAuditEnabled},e.OneToManyRelationships&&(a.OneToManyRelationships=W(e.OneToManyRelationships,!1,Y),a.HasActivities=U(e.OneToManyRelationships,"activitypointer","regardingobjectid"),a.HasNotes=U(e.OneToManyRelationships,"annotation","objectid")),e.ManyToOneRelationships&&(a.ManyToOneRelationships=W(e.ManyToOneRelationships,!1,Y)),e.ManyToManyRelationships&&(a.ManyToManyRelationships=W(e.ManyToManyRelationships,!1,K)),t.metadataCache.entities=Object.assign({},t.metadataCache.entities,((n={})[r]=a,n)),[2,a]}))}))}function U(e,t,r){var a,n;try{for(var i=u(e),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.ReferencingEntity===t&&s.ReferencingAttribute===r)return!0}}catch(e){a={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return!1}function q(e,t){return d.isNullOrUndefined(e)?null:{Behavior:t?V(e.Behavior):e.Behavior,Group:t?B(e.Group):e.Group,Label:z(e.Label),Order:e.Order,AvailableOffline:e.AvailableOffline,Icon:e.Icon,IsCustomizable:e.IsCustomizable,MenuId:e.MenuId,QueryApi:e.QueryApi,ViewId:T.Guid.tryParseOrNull(e.ViewId),ExtensionData:e.ExtensionData}}function V(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"UseCollectionName":return 0;case"UseLabel":return 1;case"DoNotDisplay":return 2;default:return 0}}function B(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"Details":return 0;case"Sales":return 1;case"Service":return 2;case"Marketing":return 3;default:return 0}}function Q(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"NoCascade":return 0;case"Cascade":return 1;case"Active":return 2;case"UserOwned":return 3;case"RemoveLink":return 4;case"Restrict":return 5;default:return 0}}function G(e){if("string"!=typeof e)return"number"==typeof e?e:0;switch(e){case"None":return 0;case"Append":return 1;case"ParentChild":return 2;case"Pointer":return 4;case"Inheritance":return 8;default:return 0}}function H(e){if("string"!=typeof e)return"number"==typeof e?e:-1;switch(e){case"OneToManyRelationship":return 0;case"ManyToManyRelationship":return 1;default:return-1}}function j(e,t){return{IsCustomRelationship:e.IsCustomRelationship,IsCustomizable:$(e.IsCustomizable),IsValidForAdvancedFind:e.IsValidForAdvancedFind,SchemaName:e.SchemaName,SecurityTypes:t?G(e.SecurityTypes):e.SecurityTypes,IsManaged:e.IsManaged,RelationshipType:t?H(e.RelationshipType):e.RelationshipType,IntroducedVersion:e.IntroducedVersion}}function Y(e,t){var r=q(e.AssociatedMenuConfiguration,t),a=function(e,t){return t?{Assign:Q(e.Assign),Delete:Q(e.Delete),Merge:Q(e.Merge),Reparent:Q(e.Reparent),Share:Q(e.Share),Unshare:Q(e.Unshare),ExtensionData:Q(e.ExtensionData)}:{Assign:e.Assign,Delete:e.Delete,Merge:e.Merge,Reparent:e.Reparent,Share:e.Share,Unshare:e.Unshare,ExtensionData:e.ExtensionData}}(e.CascadeConfiguration,t);return Object.assign({AssociatedMenuConfiguration:r,CascadeConfiguration:a,ReferencedAttribute:e.ReferencedAttribute,ReferencedEntity:e.ReferencedEntity,ReferencingAttribute:e.ReferencingAttribute,ReferencingEntity:e.ReferencingEntity,IsHierarchical:e.IsHierarchical,ReferencedEntityNavigationPropertyName:e.ReferencedEntityNavigationPropertyName,ReferencingEntityNavigationPropertyName:e.ReferencingEntityNavigationPropertyName},j(e,t))}function K(e,t){return Object.assign({Entity1AssociatedMenuConfiguration:q(e.Entity1AssociatedMenuConfiguration,t),Entity2AssociatedMenuConfiguration:q(e.Entity2AssociatedMenuConfiguration,t),Entity1LogicalName:e.Entity1LogicalName,Entity2LogicalName:e.Entity2LogicalName,IntersectEntityName:e.IntersectEntityName,Entity1IntersectAttribute:e.Entity1IntersectAttribute,Entity2IntersectAttribute:e.Entity2IntersectAttribute,Entity1NavigationPropertyName:e.Entity1NavigationPropertyName,Entity2NavigationPropertyName:e.Entity2NavigationPropertyName},j(e,t))}function W(e,t,r){var a,n;if(!e)return null;var i={};try{for(var o=u(e),s=o.next();!s.done;s=o.next()){var l=s.value,c=r(l,t);i[l.SchemaName]=c}}catch(e){a={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return i}function X(e){var t,r;if(!e||!e.AttributeNames)return!1;try{for(var a=u(e.AttributeNames),n=a.next();!n.done;n=a.next()){if("statecode"===n.value.toLowerCase())return!0}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return!1}function z(e){return e&&e.UserLocalizedLabel?e.UserLocalizedLabel.Label:null}function J(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n;return s(this,(function(i){switch(i.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return i.sent(),d.isNullOrUndefined(t.metadataCache.userContext.userSettings)||d.isNullOrUndefined(t.metadataCache.userContext.userSettings.timezoneutcoffsetminutes)||d.isNullOrUndefinedOrEmpty(t.metadataCache.userContext.userSettings.datetimeformatinfo)||d.isNullOrUndefinedOrEmpty(t.metadataCache.userContext.userSettings.timezoneadjusters)||d.isNullOrUndefined(t.metadataCache.userContext.userSettings.languageid)?(n="UserSettings is empty or does not contains all required dependencies",a.error(he()+" "+n,r),[2,Promise.reject(new p.LocalError(n))]):[2,t.metadataCache.userContext.userSettings]}}))}))}function Z(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n;return s(this,(function(i){switch(i.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return i.sent(),d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings)||d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings.fullnameconventioncode)||d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings.languageCode)?(n="OrganizationSettings is empty or does not contains all required dependencies",a.error(he()+" "+n,r),[2,Promise.reject(new p.LocalError(n))]):[2,t.metadataCache.userContext.organizationSettings]}}))}))}function $(e){return e?e.Value:null}function ee(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n;return s(this,(function(i){switch(i.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return i.sent(),d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings)||d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings.fullnameconventioncode)?(n="fullnameconventioncode is empty",a.error(he()+" "+n,r),[2,Promise.reject(new p.LocalError(n))]):[2,t.metadataCache.userContext.organizationSettings.fullnameconventioncode]}}))}))}function te(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){switch(n.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return n.sent(),d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings)||d.isNullOrUndefined(t.metadataCache.userContext.organizationSettings.languageCode)?("languageCode is empty",a.warn(he()+" languageCode is empty",r),[2,Promise.reject(new p.LocalError("languageCode is empty"))]):[2,t.metadataCache.userContext.organizationSettings.languageCode]}}))}))}function re(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){switch(n.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return n.sent(),d.isNullOrUndefined(t.metadataCache.userContext.userid)?("userid is empty",a.error(he()+" userid is empty",r),[2,Promise.reject(new p.LocalError("userid is empty"))]):[2,T.Guid.toString(t.metadataCache.userContext.userid)]}}))}))}function ae(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){switch(n.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,r)];case 1:return n.sent(),d.isNullOrUndefined(t.metadataCache.userContext.username)?("username is empty",a.error(he()+" username is empty",r),[2,Promise.reject(new p.LocalError("username is empty"))]):[2,t.metadataCache.userContext.username]}}))}))}function ne(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,le(e,a)];case 1:return i.sent(),d.isNullOrUndefined(t.metadataCache.userContext.fcbContext)||d.isNullOrUndefined(t.metadataCache.userContext.fcbContext[r])?(n.error(he()+" The fcbContext for "+r+" is empty, return False value.",a),[2,!1]):[2,t.metadataCache.userContext.fcbContext[r].value]}}))}))}function ie(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o;return s(this,(function(s){switch(s.label){case 0:return[4,ce(e,r,a)];case 1:return n=s.sent(),i={viewId:new T.Guid(n.ViewId),fetchXML:n.FetchXml,entityLogicalName:n.EntityLogicalName,queryApi:n.QueryApi,columnXML:n.ColumnXml,title:n.Title,idColumName:n.IdColumnName,queryType:n.QueryType,layoutXML:n.LayoutXml,offlineSqlQuery:n.OfflineSqlQuery?n.OfflineSqlQuery:null,versionNumber:n.VersionNumber,OverallVersionNumber:n.OverallVersionNumber,OverallUserVersionNumber:n.OverallUserVersionNumber,isUserView:n.IsUserView},t.metadataCache.views=Object.assign({},t.metadataCache.views,((o={})[r]=i,o)),[2,i]}}))}))}function oe(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,u,l,c,d,p,y;return s(this,(function(s){switch(s.label){case 0:return n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,fe(e,t,r)];case 1:if(!(i=s.sent())||!i.length)throw y="requested attributes metadata not found for entity = "+t+", attributes = "+r.join(),n.error(he()+" "+y,a),new Error(y);for(i.length>1&&(y="Results[] returned from getAttributesSqlResults() has length = "+i.length,n.error(he()+" "+y,a)),o={},u=i[0],l=0;l<u.rows.length;l++){c=u.rows.item(l),d=JSON.parse(c.json);try{p=h.AttributeMetadata.createFromObjectData(d),o[p.get_logicalName()]=p.getODataObject()}catch(e){throw y="Error when fetching attribute '"+r[l]+"' metadata for "+t+" "+e.message,n.error(he()+" "+y,a),e}}return[2,o]}}))}))}function se(e,t){return void 0===t&&(t=[]),o(this,void 0,void 0,(function(){var r,a,n,i;return s(this,(function(o){switch(o.label){case 0:return r=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),"select logicalname from entitymetadata",a=[],[4,E.getSqlResults(e,"select logicalname from entitymetadata",a)];case 1:if(!(n=o.sent())||!n.length)throw i="requested  metadata not found for entity",r.error(he()+" "+i,t),new Error(i);return[2,n[0].rows]}}))}))}function ue(e,t,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n,i,o,u,l,c;return s(this,(function(s){switch(s.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,pe(e,t)];case 1:if(!(n=s.sent())||!n.length)throw i="requested entity metadata not found for entity = "+t,a.error(he()+" "+i,r),new Error(i);return n[0].rows&&n[0].rows.length>0&&(u=n[0].rows.item(0),l=JSON.parse(u.json),c=g.EntityMetadata.createFromObjectData(l),o=c.getODataObject()),[2,o]}}))}))}function le(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n,i,o,u;return s(this,(function(s){switch(s.label){case 0:return[4,ye(e)];case 1:return a=s.sent(),n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),d.isNullOrUndefined(a)||d.isNullOrUndefined(a[0])||d.isNullOrUndefined(a[0].rows)||d.isNullOrUndefined(a[0].rows.item(0))?(u="user context returned from Database is empty",n.error(he()+" "+u,r),[2,Promise.reject(new p.LocalError(u))]):(i=a[0].rows.item(0),o=JSON.parse(i.json),t.metadataCache.userContext=Object.assign({},t.metadataCache.userContext,{userid:new T.Guid(o.userid.rawguid),username:o.username,fcbContext:o.fcbcontext,userSettings:o.usersettings,organizationSettings:o.organizationsettings}),[2,o])}}))}))}function ce(e,t,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a,n,i,o,u;return s(this,(function(s){switch(s.label){case 0:return a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),[4,de(e,t)];case 1:if(!(n=s.sent())||!n.length)throw i="requested view metadata not found, ViewId = "+t,a.error(he()+" "+i,r),new Error(i);return o=n[0].rows.item(0),u=JSON.parse(o.json),[2,u.data]}}))}))}function de(e,t){return o(this,void 0,void 0,(function(){var r;return s(this,(function(a){switch(a.label){case 0:return"select * from applicationmetadata where id = ?",r=[d.getViewLocalStoreId(t)],[4,E.getSqlResults(e,"select * from applicationmetadata where id = ?",r)];case 1:return[2,a.sent()]}}))}))}function pe(e,t){return o(this,void 0,void 0,(function(){var r;return s(this,(function(a){switch(a.label){case 0:return"SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",r=[t],[4,E.getSqlResults(e,"SELECT id, json FROM [entitymetadata] WHERE [logicalname] = ?",r)];case 1:return[2,a.sent()]}}))}))}function fe(e,t,r){return o(this,void 0,void 0,(function(){var a,n,i;return s(this,(function(o){switch(o.label){case 0:for(a="select * from attributemetadata where entitylogicalname = ? and logicalname in (",n=0;n<r.length-1;n++)a+="?,";return a+="?)",i=c([t],r),[4,E.getSqlResults(e,a,i)];case 1:return[2,o.sent()]}}))}))}function ye(e){return o(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return"select * from usercontext",t=[],[4,E.getSqlResults(e,"select * from usercontext",t)];case 1:return[2,r.sent()]}}))}))}function he(e){return e?"["+e+"]":"["+f.FILE_PREFIX.MetadataCache+"]"}t.metadataCache={views:{},entities:{},attributes:{},userContext:{}},t.getEntityLogicalName=function(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,u;return s(this,(function(s){switch(s.label){case 0:return n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),i=t.metadataCache.entities,o=S(i,r,a),d.isNullOrUndefined(o)?[4,N(e,a)]:[3,2];case 1:return s.sent(),i=t.metadataCache.entities,o=S(i,r,a),d.isNullOrUndefined(o)?(u="Entity "+r+" not found in offline metadata",n.error(he()+" "+u,a),[2,Promise.reject(new p.LocalError(u))]):[2,o];case 2:return[2,o]}}))}))},t.getAttributeTypes=function(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i,o,l,c,p,y,h,m,b,v,g,E,T;return s(this,(function(s){switch(s.label){case 0:return n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),i={},[4,M(e,r,t,a)];case 1:if(o=s.sent(),d.isNullOrUndefined(o))n.warn(he()+" Retrieved null or undefined attribute metadata",a);else if(o&&Object.keys(o).length>0)if(t.length>0)try{for(l=u(t),c=l.next();!c.done;c=l.next())m=c.value,o[m]&&(b=o[m],i[m]=b.Type)}catch(e){v={error:e}}finally{try{c&&!c.done&&(g=l.return)&&g.call(l)}finally{if(v)throw v.error}}else{p=Object.keys(o);try{for(y=u(p),h=y.next();!h.done;h=y.next())m=h.value,o[m]&&(b=o[m],i[m]=b.Type)}catch(e){E={error:e}}finally{try{h&&!h.done&&(T=y.return)&&T.call(y)}finally{if(E)throw E.error}}}return[2,i]}}))}))},t.getUserSettings=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.userSettings&&t.metadataCache.userContext.userSettings.timezoneutcoffsetminutes&&t.metadataCache.userContext.userSettings.languageid&&!d.isNullOrUndefinedOrEmpty(t.metadataCache.userContext.userSettings.datetimeformatinfo)&&!d.isNullOrUndefinedOrEmpty(t.metadataCache.userContext.userSettings.timezoneadjusters)?[2,t.metadataCache.userContext.userSettings]:[2,J(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.getOrganizationSettings=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.organizationSettings&&t.metadataCache.userContext.organizationSettings.fullnameconventioncode&&t.metadataCache.userContext.organizationSettings.languageCode?[2,t.metadataCache.userContext.organizationSettings]:[2,Z(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.getfullnameconventioncode=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.organizationSettings&&t.metadataCache.userContext.organizationSettings.fullnameconventioncode?[2,t.metadataCache.userContext.organizationSettings.fullnameconventioncode]:[2,ee(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.getLanguageCode=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.organizationSettings&&t.metadataCache.userContext.organizationSettings.languageCode?[2,t.metadataCache.userContext.organizationSettings.languageCode]:[2,te(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.getUserId=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.userid?[2,T.Guid.toString(t.metadataCache.userContext.userid)]:[2,re(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.getUserName=function(e,r){return void 0===r&&(r=[]),o(this,void 0,void 0,(function(){var a;return s(this,(function(n){a=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.userContext&&t.metadataCache.userContext.username?[2,t.metadataCache.userContext.username]:[2,ae(e,r)]}catch(e){return a.error(he()+" "+e.message,r),[2,Promise.reject(e)]}return[2]}))}))},t.isFeatureEnabled=function(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n,i;return s(this,(function(o){switch(o.label){case 0:return n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache),t.metadataCache.userContext&&t.metadataCache.userContext.fcbContext&&t.metadataCache.userContext.fcbContext[r]?[3,2]:[4,ne(e,r,a)];case 1:return i=o.sent(),[3,3];case 2:i=t.metadataCache.userContext.fcbContext[r].value,o.label=3;case 3:return n.info(he()+" The fcbContext for "+r+" return "+i+" value."),[2,i]}}))}))},t.getViewMetadata=function(e,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){var n;return s(this,(function(i){n=e.TraceManager.getTracer(f.COMPONENT_NAMES.MetadataCache);try{return t.metadataCache.views&&t.metadataCache.views[r]?[2,t.metadataCache.views[r]]:[2,ie(e,r,a)]}catch(e){return n.error(he()+" "+e.message,a),[2,Promise.reject(e)]}return[2]}))}))},t.getEntityMetadata=O,t.populateAllEntityMetadata=N,t.getAttributesMetadata=M,t.fromNumberAttributeType=D,t.getViewSqlResults=de,t.getEntitySqlResults=pe,t.getAttributesSqlResults=fe,t.getUserContextResults=ye},ZRE3:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LocalError=void 0;var a=function(e,t,r,a){this.message=e,this.code=t,this.stack=r,this.name=a};t.LocalError=a},bOB9:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DEVICE_FILE_PATH=t.FILE_ATTACHMENT=t.EXPAND_PROPERTIES=t.EXPAND_VALUES=t.ADDITIONAL_PARAMETERS=t.FileQuerySupportedList=t.SQLQuerySupportedList=t.HTTP_STATUS_CODES=t.HTTP_REQUEST_METHOD=t.OPERATION=t.EXECUTION_HINTS=t.CLIENT_TYPE=t.UNKNOWN=t.COMPOSITE_INDEX_DELIMITER=t.STRING_CONSTANTS=t.WEB_API_URL_FRAGMENT=t.APP_ENTITY=t.ErrorCode=t.HEADER_VALUES=t.HEADER=t.HINT=t.UNEXPECTED_STATUS_CODE=void 0;var a={Create:"Create",Batch:"Batch",Retrieve:"Retrieve",RetrieveMultiple:"RetrieveMultiple",GetClientMetadata:"GetClientMetadata",Update:"Update",Delete:"Delete",Download:"Download",Upload:"Upload"};t.OPERATION=a;t.HTTP_REQUEST_METHOD={Post:"POST",Get:"GET",Patch:"PATCH",Delete:"DELETE"};var n=[a.Create,a.Delete,a.Batch,a.GetClientMetadata,a.Update,a.Retrieve,a.RetrieveMultiple];t.SQLQuerySupportedList=n;var i=[a.Download,a.Upload];t.FileQuerySupportedList=i;var o={Ok:200,Accepted:202,NoContent:204,PartialContent:206,BadRequest:400,Unauthorized:401,NotFound:404,Unknown:420,InternalServerError:500,ServiceUnavailable:503};t.HTTP_STATUS_CODES=o,t.UNEXPECTED_STATUS_CODE=[o.BadRequest,o.InternalServerError,o.NotFound,o.ServiceUnavailable];t.ADDITIONAL_PARAMETERS={RecordId:"RecordId",PageSize:"PageSize",MetadataTypes:"MetadataTypes"},t.HINT={select:"x-ms-mdl-select",pageSize:"x-ms-mdl-pageSize",pageNumber:"x-ms-mdl-pageNumber",filter:"x-ms-mdl-filter",linkEntity:"x-ms-mdl-link",viewId:"x-ms-mdl-viewId",rawFetch:"x-ms-mdl-rawFetchXml",mergeQuickFind:"x-ms-mdl-mergeQuickFind",contextFilter:"x-ms-mdl-contextFilter",executionStrategy:"x-ms-mdl-execution-hints",search:"x-ms-mdl-search",orderBy:"x-ms-mdl-orderby"},t.HEADER={ACCEPT:"Accept",PREFER:"Prefer",AUTO_DISASSOCIATE:"AutoDisassociate",IF_MATCH:"If-match",MSCRM_SUPPRESS_DUPLICATION_DETECTION:"MSCRM.SuppressDuplicateDetection",MSCRM_RETURN_NOTIFICATIONS:"MSCRM.ReturnNotifications",APP_ENTITY:"appmodules",AUTHORIZATION:"Authorization",CONTENT_TYPE:"Content-Type",ODADTA_ENTITY_ID:"OData-EntityId",CONTENT_LENGTH:"Content-Length",CLIENT_REQUEST_ID:"x-ms-client-request-id",SERVER_REQUEST_ID:"x-ms-service-request-id",SESSION_ID:"x-ms-client-session-id",ACTIVITY_ID:"x-ms-correlation-id",SOURCE_ID:"x-ms-source-id",USER_AGENT:"x-ms-user-agent",APP_ID:"x-ms-app-id",APP_NAME:"x-ms-app-name",OBJECT_ID:"x-ms-sw-objectid",TENANT_ID:"x-ms-sw-tenantid",CONTENT_ID:"Content-ID",CONTENT_TRANSFER_ENCODING:"Content-Transfer-Encoding",PREFERENCE_APPLIED:"Preference-Applied",LOCATION:"Location",REQ_ID:"REQ_ID"},t.HEADER_VALUES={APPLICATION_JSON:"application/json",APPLICATION_HTTP:"application/http",BINARY:"binary",ANNOTATIONS:'odata.include-annotations="*"',PREFER_REPRESENTATION:"return=representation"},t.ErrorCode={CannotUpdateOnlineRecord:-2147093980,CannotDeleteOnlineRecord:-2147093944,DataSourceOfflineErrorCode:-2147093999,UnknownUnexpectedGenericError:-2147015414,UnknownBadRequestError:-2147015424},t.APP_ENTITY="appmodules",t.WEB_API_URL_FRAGMENT="/api/data/v9.0/",t.STRING_CONSTANTS={ErrorCode:"code",Message:"message",StackTrace:"stacktrace",InnerError:"innererror"},t.COMPOSITE_INDEX_DELIMITER="_",t.UNKNOWN="Unknown",t.CLIENT_TYPE={local:"local",remote:"remote"},t.EXECUTION_HINTS={ONLINE:"Online",OFFLINE:"Offline"},t.EXPAND_VALUES={MULTI_VALUE:"MultiValue",SINGLE_VALUE:"SingleValue"},t.EXPAND_PROPERTIES="ExpandProperties",t.FILE_ATTACHMENT="fileattachment",t.DEVICE_FILE_PATH="devicefilepath"},bxig:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseCacheInterceptor=void 0;var s=function(e){function t(t,r){var a=e.call(this,r)||this;return a._promiseCache=t,a}return n(t,e),t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){var t,r,a=this;return o(this,(function(n){return t=e.request,this._promiseCache.contains(t.url)?(e.terminate(),[2,this._promiseCache.get(t.url)]):(r=e.proceed(),this._promiseCache.put(t.url,r),r.then((function(){a._promiseCache.remove(t.url)}),(function(){a._promiseCache.remove(t.url)})),[2,r])}))}))},t}(r("lHlh").Interceptor);t.PromiseCacheInterceptor=s},cVT3:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OwnershipTypes=void 0,function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(t.OwnershipTypes||(t.OwnershipTypes={}))},cxea:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.SecurityPrivilegeMetadata=void 0;var a=r("pqvw"),n=r("lMa+"),i=function(){function e(e,t,r,n,i,o,s){this._privilegeType=0,this._canBeBasic=!1,this._canBeLocal=!1,this._canBeDeep=!1,this._canBeGlobal=!1,a.throwOnNullOrUndefinedArgument(e,"name"),a.throwOnNullOrUndefinedArgument(t,"privilegeId"),this._name=e,this._privilegeId=t,this._privilegeType=r,this._canBeBasic=n,this._canBeLocal=i,this._canBeDeep=o,this._canBeGlobal=s}return e.getPrivilegeTypeKey=function(e){return e.toString()},e.createFromObjectData=function(t){return new e(t.name,n.LegacyGuid.createFromObjectData(t.privilegeid),t.privilegetype,t.canbebasic,t.canbelocal,t.canbedeep,t.canbeglobal)},e.createFromOData=function(t){return new e(t.Name,n.LegacyGuid.tryCreate(t.PrivilegeId),t.PrivilegeType,t.CanBeBasic,t.CanBeLocal,t.CanBeDeep,t.CanBeGlobal)},e.prototype.get_privilegeId=function(){return this._privilegeId},e.prototype.get_privilegeType=function(){return this._privilegeType},e.prototype.get_privilegeTypeKey=function(){return e.getPrivilegeTypeKey(this.get_privilegeType())},e.prototype.get_canBeGlobal=function(){return this._canBeGlobal},e.prototype.getObjectData=function(){var e={};return e.name=this._name,e.privilegeid=this._privilegeId.getObjectData(),e.privilegetype=this._privilegeType,e.canbebasic=this._canBeBasic,e.canbelocal=this._canBeLocal,e.canbedeep=this._canBeDeep,e.canbeglobal=this.get_canBeGlobal(),e},e.prototype.getODataObject=function(){var e={};return e.Name=this._name,e.PrivilegeId=this._privilegeId.toString(),e.PrivilegeType=this._privilegeType,e.CanBeBasic=this._canBeBasic,e.CanBeLocal=this._canBeLocal,e.CanBeDeep=this._canBeDeep,e.CanBeGlobal=this.get_canBeGlobal(),e},e}();t.SecurityPrivilegeMetadata=i},f9xj:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateRetrieveMultipleRequests=void 0;var i=r("bOB9"),o=r("r9V9"),s=r("pqvw"),u=r("ZRE3"),l=r("Y0ua"),c=r("Z84h"),d=r("Ag5+"),p=r("kwGv"),f=r("Mq3F"),y=r("kkhr"),h=r("FhB6"),m=r("wr4e"),b=r("kLZw");function v(e,t,r,u,l,d){return void 0===d&&(d=[]),a(this,void 0,void 0,(function(){var t,a,f,y;return n(this,(function(n){switch(n.label){case 0:return t=[],e=b.addLimitClause(e,Number(u[i.HINT.pageSize]||p.DEFAULT.PageSize),Number(u[i.HINT.pageNumber]||p.DEFAULT.PageNumber)),[4,c.getUserId(r,d)];case 1:a=n.sent(),t.push({name:"UserId",value:a}),s.isNullOrUndefinedOrEmptyString(a)?l.warn(g()+" userId is null or empty",o.addEventParameters(d,t)):e=b.substituteUserIdPlaceHolder(a,e,l,d),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,b.substituteDateTimePlaceholders(r,e,l,d)];case 3:return e=n.sent(),[3,5];case 4:return f=n.sent(),y=s.getErrorMessage(f)||"Failed to substitute date time placeholder",l.warn(g()+" "+y,o.addEventParameters(d,t)),[3,5];case 5:return[4,b.substituteUserLanguage(r,e,l,d)];case 6:return[2,e=n.sent()]}}))}))}function g(e){return e?"["+e+"]":"["+l.FILE_PREFIX.RetrieveMultipleGenerator+"]"}t.generateRetrieveMultipleRequests=function(e,t,r,s){return void 0===s&&(s={}),a(this,void 0,void 0,(function(){var a,l,b,E,T,_,S,O,N,M,P,w,C,I,A;return n(this,(function(n){switch(n.label){case 0:return a=s.commonEventParameters||[],l=[],r.info(g()+" Building SQL Query For RetrieveMultipleRecords is processing",o.addEventParameters(a,l)),[4,d.getEntityNameFromUrl(e.url,t,r,a)];case 1:return b=n.sent(),[4,c.isFeatureEnabled(t,p.FCB_CONSTANTS.SqlTokensAvailable,a)];case 2:return E=n.sent(),l.push({name:"sqlTokensSwitch",value:E}),E?e.additionalHeaders?(T=void 0,_={sqlStatements:[],sqlParameters:[],additionalParameters:(A={},A[i.ADDITIONAL_PARAMETERS.PageSize]=e.additionalHeaders[i.HINT.pageSize]||p.DEFAULT.PageSize,A)},e.additionalHeaders[i.HINT.viewId]?(S=e.additionalHeaders[i.HINT.viewId],[4,c.getViewMetadata(t,S,a)]):[3,14]):[3,17]:(w="Offline SQL Token Switch is OFF - Legacy SQL generator is not supported in Modern Data Layer",r.error(g()+" "+w,o.addEventParameters(a,l)),[2,Promise.reject(new u.LocalError(w))]);case 3:return O=n.sent(),(T=O.offlineSqlQuery)?e.additionalHeaders[i.HINT.mergeQuickFind]?(N=e.additionalHeaders[i.HINT.mergeQuickFind],[4,c.getViewMetadata(t,N,a)]):[3,7]:(l.push({name:"ViewId",value:S}),w="Raw offline sql from metadata cache is null",r.error(g()+" "+w,o.addEventParameters(a,l)),[2,Promise.reject(new u.LocalError(w))]);case 4:return M=n.sent(),(P=M.offlineSqlQuery)?[3,5]:(l.push({name:"mergeQuickFindViewId",value:N}),w="Failed to merge offline lookup since quick find sql from metadata cache is null for this view id "+N,r.error(g()+" "+w,o.addEventParameters(a,l)),[2,Promise.reject(new u.LocalError(w))]);case 5:return[4,y.mergeQueries(T,P,t,r,s)];case 6:T=n.sent(),n.label=7;case 7:return e.additionalHeaders[i.HINT.search]?(C=e.additionalHeaders[i.HINT.search],[4,f.populateQuickFindSql(T,C,b,t,r,s)]):[3,9];case 8:T=n.sent(),n.label=9;case 9:return e.additionalHeaders[i.HINT.select]?[4,h.select(t,T,d.extractAdditionalColumnNames(e.additionalHeaders[i.HINT.select]),b,r,a)]:[3,11];case 10:T=n.sent(),n.label=11;case 11:return e.additionalHeaders[i.HINT.orderBy]?[4,m.sort(t,T,d.extractAdditionalColumnNames(e.additionalHeaders[i.HINT.orderBy]),b,r,a)]:[3,13];case 12:T=n.sent(),n.label=13;case 13:return[3,15];case 14:return I="Retrieve Multiple For Client Api are not supported yet",r.error(g()+" "+I+"}",o.addEventParameters(a,l)),[2,Promise.reject(new u.LocalError(I))];case 15:return[4,v(T,b,t,e.additionalHeaders,r,a)];case 16:return T=n.sent(),_.sqlStatements.push(T),[2,_];case 17:return I="Failed to build the SQL Query For RetrieveMultiple - Cannot find request additional headers",r.error(g()+" "+I,o.addEventParameters(a,l)),[2,Promise.reject(new u.LocalError(I))]}}))}))}},faKr:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.parseBPFRequest=void 0;var o=r("XGkY"),s=r("Z84h"),u=r("pqvw");t.parseBPFRequest=function(e,t,r){return a(this,void 0,void 0,(function(){var a,l,c,d,p,f,y,h,m,b,v,g,E,T,_,S,O;return n(this,(function(n){switch(n.label){case 0:if(a={target:{entityLogicalName:"",id:o.Guid.EMPTY},processId:o.Guid.EMPTY,processInstanceId:o.Guid.EMPTY},u.isNullOrUndefined(e.url.match("/api/data/(.*)/RetrieveProcessControlData"))||-1===e.url.indexOf("?"))throw new Error("Incorrect BPF request url");if(l=e.url.split(/\?(.+)/),!(c=l[0].match(/\/api\/data\/.*\/RetrieveProcessControlData\((.*)\)/))||c.length<2)throw new Error("Incorrect BPF request url");d=c[1].split(","),p={};try{for(f=i(d),y=f.next();!y.done;y=f.next())h=y.value,m=h.split("="),p[m[0]]=m[1]}catch(e){S={error:e}}finally{try{y&&!y.done&&(O=f.return)&&O.call(f)}finally{if(S)throw S.error}}return b=new URLSearchParams(l[1]),(v=b.get(p.ProcessId))&&(a.processId=o.Guid.tryParse(v)),(g=b.get(p.ProcessInstanceId))&&(a.processInstanceId=o.Guid.tryParse(g)),(E=b.get(p.Target))?(T=E.split(":")[1].match(/\"(.*)\((.*)\)\"/))&&3===T.length?(_=a.target,[4,s.getEntityLogicalName(t,T[1],r)]):[3,2]:[3,2];case 1:_.entityLogicalName=n.sent(),a.target.id=o.Guid.tryParse(T[2]),n.label=2;case 2:return[2,a]}}))}))}},h2cw:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyManager=void 0;var i=r("Y0ua"),o=function(){function e(e,t){this._policies=[],t&&this.addRetryPolicies(t),this._tracer=e.TraceManager.getTracer(i.COMPONENT_NAMES.ODataExecutor)}return e.prototype.addRetryPolicy=function(e){var t=this;e.action||(e.action=function(e){return a(t,void 0,void 0,(function(){return n(this,(function(t){return[2,e]}))}))}),this._policies.push(e)},e.prototype.addRetryPolicies=function(e){var t=this;e&&e.length>0&&e.forEach((function(e){t.addRetryPolicy(e)}))},e.prototype.getRetryPolicy=function(e){for(var t=0;t<this._policies.length;t++){var r=this._policies[t];if(r.condition(e)&&r.action)return this._tracer.info(((a=void 0)?"["+a+"]":"["+i.FILE_PREFIX.PolicyManager+"]")+" Fit Policy "+r.name),r}var a;return null},e}();t.PolicyManager=o},"hO/k":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.FileLocalODataClient=void 0;var i=r("Co9g"),o=r("HJUa"),s=function(e){function t(t,r){var a=e.call(this,t,r)||this;return a.setExecuteRequestInterceptor(new o.FileRequestInterceptor(a.applicationContext)).build(),a}return n(t,e),t}(i.ODataClient);t.FileLocalODataClient=s},i2et:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeType=void 0,function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(t.AttributeType||(t.AttributeType={}))},jD1M:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.USER_CONTEXT_KEY=t.USER_CONTEXT_STORE=t.APPLICATION_METADATA_DEPENDENCY_VIEW=t.ENTITY_DEFINITIONS_TYPE=t.ENTITY_METADATA_STORE=t.APPLICATION_METADATA_STORE=t.MetadataFields=t.APPLICATION_METADATA_VERSION_STAMP_KEY=t.FormFactor=t.LegacyDependencyDepth=t.METADATA_TYPE_TO_KEYS=void 0;var a,n,i=r("Ct6E"),o={};t.METADATA_TYPE_TO_KEYS=o,o.form=[{metadataType:i.MetadataType.formSelector,uniqueKey:"Id",payloadKey:"FormSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"}],o.savedview=[{metadataType:i.MetadataType.viewSelector,uniqueKey:"ViewId",payloadKey:"ViewSelectors"},{metadataType:i.MetadataType.savedView,uniqueKey:"ViewId",payloadKey:"Views"}],o.workspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.systemworkspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.userworkspace=[{metadataType:i.MetadataType.dashboardSelector,uniqueKey:"Id",payloadKey:"DashboardSelectors"},{metadataType:i.MetadataType.form,uniqueKey:"FormId",payloadKey:"Forms"},{metadataType:i.MetadataType.workspace,uniqueKey:"FormId",payloadKey:"Dashboards"},{metadataType:i.MetadataType.interactionCentricWorkspace,uniqueKey:"FormId",payloadKey:"Dashboards"}],o.savedvisualization=[{metadataType:i.MetadataType.visualizationSelector,uniqueKey:"Id",payloadKey:"VisualizationSelectors"},{metadataType:i.MetadataType.savedQueryVisualization,uniqueKey:"Id",payloadKey:"SavedQueryVisualizations"}],function(e){e[e.Unknown=0]="Unknown",e[e.OnDemandWithContext=1]="OnDemandWithContext",e[e.OnDemandWithoutContext=2]="OnDemandWithoutContext",e[e.OnDemandContextOnly=3]="OnDemandContextOnly",e[e.Offline=4]="Offline",e[e.Mobile=5]="Mobile",e[e.UserContext=6]="UserContext"}(a||(a={})),t.LegacyDependencyDepth=a,function(e){e[e.None=0]="None",e[e.Slate=1]="Slate",e[e.Phone=2]="Phone",e[e.Desktop=3]="Desktop",e[e.MailApp=4]="MailApp"}(n||(n={})),t.FormFactor=n;var s;t.APPLICATION_METADATA_VERSION_STAMP_KEY="applicationmetadataversionstamp",function(e){e.METADATA_TYPE="metadatatype",e.SOURCE_ID="sourceid",e.ASSOCIATED_ENTITY_LOGICAL_NAME="associatedentitylogicalname",e.METADATA_SUBTYPE="metadatasubtype",e.DISPLAY_NAME="displayname",e.JSON="json"}(s||(s={})),t.MetadataFields=s;t.APPLICATION_METADATA_STORE="applicationmetadata";t.APPLICATION_METADATA_DEPENDENCY_VIEW="metadatadependency";t.ENTITY_METADATA_STORE="entitymetadata";t.USER_CONTEXT_STORE="usercontext";t.USER_CONTEXT_KEY="contextkey";t.ENTITY_DEFINITIONS_TYPE="entitydefinitionstype"},jEjT:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.getExpandTermTokens=t.getRequestedColumns=void 0;var l=r("pqvw"),c=r("Y0ua"),d=r("i2et"),p=r("Ag5+"),f=r("kwGv"),y=i(r("88gK"));function h(e){return e?"["+e+"]":"["+c.FILE_PREFIX.RetrieveGenerator+"]"}t.getRequestedColumns=function(e,t,r,a){return o(this,void 0,void 0,(function(){var n,i,o,c,f,m,b,v,g,E;return s(this,(function(s){if(n=[],i=[],l.isNullOrUndefinedOrEmptyString(e))throw r.error(h()+" Empty URL for retrieve request",a),new Error("Empty url for retrieve request");-1===e.indexOf("?")?r.info(h()+" No $select parameter. Returning all columns for entity",a):(o=new URLSearchParams(e.split(/\?(.+)/)[1]),c=o.get("$select"),l.isNullOrUndefinedOrEmptyString(c)?r.info(h()+" No $select parameter. Returning all columns for entity",a):i=c.split(",")),i&&0!==i.length||r.info(h()+" No $select parameter. Returning all columns for entity",a);try{for(f=u(i),m=f.next();!m.done;m=f.next())b=m.value,v=p.getAttributeName(b),t[v]===d.AttributeType.Owner||t[v]===d.AttributeType.Lookup||t[v]===d.AttributeType.Customer?(n.push(v+y.columnDelimiter+y.id),n.push(v+y.columnDelimiter+y.name),n.push(v+y.columnDelimiter+y.logicalName)):n.push(v)}catch(e){g={error:e}}finally{try{m&&!m.done&&(E=f.return)&&E.call(f)}finally{if(g)throw g.error}}return r.info(h()+" requested for "+n.length+" columns",a),[2,n]}))}))},t.getExpandTermTokens=function(e,t,r){return o(this,void 0,void 0,(function(){var a,n,i,o,c,d,p,y,m,b,v,g;return s(this,(function(s){if(a={},!e||-1===e.indexOf("?")||-1===e.indexOf("$expand"))return t.info(h()+" Url is empty or does not contain $expand parameter",r),[2,a];if(n=new URLSearchParams(e.split(/\?(.+)/)[1]),i=n.get("$expand"),l.isNullOrUndefinedOrEmptyString(i))return[2,a];o=/([a-zA-Z0-9_]+)\(\$filter=Microsoft\.Dynamics\.CRM\.In\(PropertyName='([a-z0-9_,]+)',PropertyValues=\[(.*)\]\)\)?/,c=/([a-zA-Z0-9_]+)(\(\$select=([a-z0-9_,]+)\)?)?/,d=i.split("),");try{for(p=u(d),y=p.next();!y.done;y=p.next())m=y.value,b=m.match(o),l.isNullOrUndefined(b)?(b=m.match(c),l.isNullOrUndefined(b)||(b.length<3||l.isNullOrUndefinedOrEmptyString(b[3])?a[b[1]]={values:[],clause:f.CLAUSE.select}:a[b[1]]={values:b[3].split(","),clause:f.CLAUSE.select})):a[b[1]]={values:b[3].split(",").map((function(e){return e.replace(/['"]+/g,"")})),clause:f.CLAUSE.in,propertyName:b[2]}}catch(e){v={error:e}}finally{try{y&&!y.done&&(g=p.return)&&g.call(p)}finally{if(v)throw v.error}}return[2,a]}))}))}},jUuM:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.buildBatchResponse=void 0;var o=r("bOB9"),s=r("+1in");function u(e,t){return a(this,void 0,void 0,(function(){var r,a,s,u,c,d,p,f,y;return n(this,(function(n){switch(n.label){case 0:r="",a=1,n.label=1;case 1:n.trys.push([1,6,7,8]),s=i(t),u=s.next(),n.label=2;case 2:return u.done?[3,5]:(c=u.value,r+="--"+e+"\n",r+=o.HEADER.CONTENT_TYPE+": "+o.HEADER_VALUES.APPLICATION_HTTP+"\n"+o.HEADER.CONTENT_TRANSFER_ENCODING+": "+o.HEADER_VALUES.BINARY+"\n",c.ok?r+=o.HEADER.CONTENT_ID+": "+a+"\n":r+=o.HEADER.CONTENT_ID+": "+c.headers.get(o.HEADER.CONTENT_ID),a++,d=r+="\n",[4,l(c)]);case 3:r=d+n.sent(),r+="\n",n.label=4;case 4:return u=s.next(),[3,2];case 5:return[3,8];case 6:return p=n.sent(),f={error:p},[3,8];case 7:try{u&&!u.done&&(y=s.return)&&y.call(s)}finally{if(f)throw f.error}return[7];case 8:return[2,r+="--"+e+"--\n"]}}))}))}function l(e){return a(this,void 0,void 0,(function(){var t,r;return n(this,(function(a){switch(a.label){case 0:return t="HTTP/1.1 "+e.status+" "+e.statusText+"\n",[o.HEADER.REQ_ID,o.HEADER.CONTENT_TYPE,o.HEADER.PREFERENCE_APPLIED,o.HEADER.ODADTA_ENTITY_ID,o.HEADER.LOCATION].forEach((function(r){e.headers.has(r)&&(t+=r+": "+e.headers.get(r))})),e.headers.get(o.HEADER.CONTENT_TYPE)!==o.HEADER_VALUES.APPLICATION_JSON?[3,2]:[4,e.json()];case 1:r=a.sent(),t+="\n\n"+JSON.stringify(r),a.label=2;case 2:return[2,t]}}))}))}t.buildBatchResponse=function(e,t){return a(this,void 0,void 0,(function(){var r,a,i,c,d,p;return n(this,(function(n){switch(n.label){case 0:r="",t||(t="batch_"+(new Date).getTime()),a=0,n.label=1;case 1:return a<e.length?(i=e[a],r+="--"+t+"\n",c="",Array.isArray(i)?[4,u(d="changeset_"+t+"-"+a,i)]:[3,3]):[3,7];case 2:return c=n.sent(),r+=o.HEADER.CONTENT_TYPE+": multipart/mixed;boundary="+d+"\n",[3,5];case 3:return[4,l(i)];case 4:c=n.sent(),r+=o.HEADER.CONTENT_TYPE+": "+o.HEADER_VALUES.APPLICATION_HTTP+"\n"+o.HEADER.CONTENT_TRANSFER_ENCODING+": "+o.HEADER_VALUES.BINARY+"\n",n.label=5;case 5:r+="\n",r+=c,r+="\n",n.label=6;case 6:return a++,[3,1];case 7:return p="--"+t+"--\r\n\0",r.endsWith(p+"\n")?r=r.substr(0,r.length-1):r+=p,[2,function(e,t,r){var a=[];a.concat(e.filter((function(e){return!e.ok&&e.status!==o.HTTP_STATUS_CODES.Unknown})));var n=!0;a.length>0&&(n=!1);var i=new Headers;return i.set(o.HEADER.CONTENT_TYPE,"multipart/mixed;boundary="+r),s.buildOdataResponse(n?o.HTTP_STATUS_CODES.Ok:o.HTTP_STATUS_CODES.InternalServerError,"$batch",i,t)}(e,r,t)]}}))}))}},"k++F":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateUpdateRequests=void 0;var u=r("bOB9"),l=r("pqvw"),c=r("Y0ua"),d=r("Z84h"),p=r("Ag5+"),f=r("kwGv"),y=i(r("88gK")),h=r("Nd0y");function m(e,t,r,a,n,i,c){return void 0===c&&(c=[]),o(this,void 0,void 0,(function(){var o,d;return s(this,(function(s){switch(s.label){case 0:if(!a||!a.PrimaryIdAttribute)throw new Error(f.ERROR_STRING.primaryIdAttribute);return(o={sqlStatements:[],sqlParameters:[],additionalParameters:(d={},d[u.ADDITIONAL_PARAMETERS.RecordId]=r.id.guid.toString(),d)}).sqlStatements.push(h.generateSimpleSelectStatement(n,a.PrimaryIdAttribute,t,i,c)),o.sqlParameters.push([r.id.guid]),o=function(e,t,r,a,n,i){void 0===i&&(i=[]);if(l.isNullOrUndefinedOrEmptyString(n)||l.isNullOrUndefined(t))throw a.error(v()+" Invalid parameters when creating update query",i),new Error("Invalid parameters for update query generation");var o="",s=[],u=0;for(var c in t.values){if(!l.isNullOrUndefinedOrEmptyString(c))o+=(u>0?",":"")+"["+c+"] = ?",s.push(t.values[c]),u+=1}!l.isNullOrUndefinedOrEmptyString(o)&&s.length>0&&(e.sqlStatements.push(f.CLAUSE.update+f.Punctuation.space+t.entityLogicalName+f.Punctuation.space+f.CLAUSE.set+f.Punctuation.space+o+f.Punctuation.space+f.CLAUSE.where+f.Punctuation.space+n+f.Punctuation.equal+f.Punctuation.question+f.Punctuation.space+f.CLAUSE.collateNoCase),s.push(t.id.guid),e.sqlParameters.push(s));return e}(o,r,0,i,a.PrimaryIdAttribute,c),a.IsActivity?[4,b(t,r,o,c)]:[3,2];case 1:o=s.sent(),s.label=2;case 2:return a&&e&&e.additionalHeaders&&e.additionalHeaders.Prefer&&-1!==e.additionalHeaders.Prefer.indexOf(u.HEADER_VALUES.PREFER_REPRESENTATION)&&(o=p.appendRetrieveQuery(t,o,n,r.id,a.PrimaryIdAttribute,c)),[2,o]}}))}))}function b(e,t,r,a){return void 0===a&&(a=[]),o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return l.isNullOrUndefined(t.activityParties)?[3,2]:(r=function(e,t){if(l.isNullOrUndefined(e.activityParties))return t;return t.sqlStatements.push(f.CLAUSE.delete+f.Punctuation.space+f.CLAUSE.from+f.Punctuation.space+f.Punctuation.openSQBracket+y.activityParty+f.Punctuation.closeSQBracket+f.Punctuation.space+f.CLAUSE.where+f.Punctuation.space+f.Punctuation.openSQBracket+y.activityId+y.columnDelimiter+y.id+f.Punctuation.closeSQBracket+f.Punctuation.space+f.Punctuation.equal+f.Punctuation.space+f.Punctuation.question+f.Punctuation.space+f.CLAUSE.collateNoCase),t.sqlParameters.push([e.id.guid]),t}(t,r),[4,p.getInsertActivityPartySQLQueryRequests(e,t,r,a)]);case 1:r=n.sent(),n.label=2;case 2:return[2,r]}}))}))}function v(e){return e?"["+e+"]":"["+c.FILE_PREFIX.UpdateGenerator+"]"}t.generateUpdateRequests=function(e,t,r,a){return void 0===a&&(a={}),o(this,void 0,void 0,(function(){var n,i,o,u,c,y,h,b;return s(this,(function(s){switch(s.label){case 0:return n=a.commonEventParameters||[],[4,p.getEntityNameFromUrl(e.url,t,r,n)];case 1:return i=s.sent(),[4,d.getAttributeTypes(t,[],i,n)];case 2:return o=s.sent(),[4,p.getColumnsFromRequestJSON(e.body,o,i,t,r,n)];case 3:if(u=s.sent(),c=p.getEntityIdFromUrl(e.url,r,n),l.isNullOrUndefined(c))throw y=new Error("Update Generator was unable to extract GUID from url"),r.error(v()+" "+y.message,n),y;return h={id:c,entityLogicalName:i,attributeTypes:o,values:{}},[4,d.getEntityMetadata(t,i)];case 4:return b=s.sent(),[4,p.populateRecordWithData(h,u,o,f.SqlOperation.update,t,r,n,a)];case 5:return h=s.sent(),[4,p.populateDefaultFieldsForOperation(t,h,b,f.SqlOperation.update,n,a)];case 6:return h=s.sent(),[2,m(e,t,h,b,i,r,n)]}}))}))}},kLZw:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.substituteDateTimePlaceholders=t.substituteUserLanguage=t.substituteUserIdPlaceHolder=t.addLimitClause=void 0;var i=r("pqvw"),o=r("Y0ua"),s=r("i2et"),u=r("kwGv"),l=r("Z84h"),c=r("Rd2O");function d(e){return e?"["+e+"]":"["+o.FILE_PREFIX.ApplyFinalModifiedSQLGenerator+"]"}t.addLimitClause=function(e,t,r){var a=1+t,n=t*(r-1);return e=e+u.Punctuation.space+u.CLAUSE.limit+u.Punctuation.space+a+u.Punctuation.space+u.CLAUSE.offset+u.Punctuation.space+n},t.substituteUserIdPlaceHolder=function(e,t,r,a){if(void 0===a&&(a=[]),typeof t===s.AttributeType.String&&t.trim().length>0)return t=t.replace('"!eq-userid!"',u.Punctuation.singleQuote+e+u.Punctuation.singleQuote+u.Punctuation.space+u.CLAUSE.collateNoCase);var n=d()+" attempted to substitute user id placeholder in empty sql statement";throw r.error(n,a),new Error(n)},t.substituteUserLanguage=function(e,t,r,o){return void 0===o&&(o=[]),a(this,void 0,void 0,(function(){var a,s,u,c,p;return n(this,(function(n){switch(n.label){case 0:a="6",n.label=1;case 1:return n.trys.push([1,4,,5]),[4,l.getUserSettings(e,o)];case 2:return s=n.sent(),[4,l.getLanguageCode(e,o)];case 3:return u=n.sent(),t=(t=(t=(t=t.replace("@LanguageId0",s.languageid.toString())).replace("@LanguageId1",u.toString())).replace("@ObjectColumnName0",a)).replace("@ObjectColumnName1",a),[3,5];case 4:return c=n.sent(),p="Failed to substitueUserLanguage with "+(i.getErrorMessage(c)||"Unknown"),r.warn(d()+" "+p,o),[3,5];case 5:return[2,t]}}))}))},t.substituteDateTimePlaceholders=function(e,t,r,o){return void 0===o&&(o=[]),a(this,void 0,void 0,(function(){var a,s,p,f;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,l.getUserSettings(e,o)];case 1:return a=n.sent(),s=c.getUserDateTimeNowFromUserSettings(a),[2,t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(u.DATE_TIME_CONSTANTS.startOfCurrentHourUTC,c.getUTCTimeForUserLocal(a,c.getStartOfHour(s)))).replace(u.DATE_TIME_CONSTANTS.startOfTodayUTC,c.getUTCTimeForUserLocal(a,c.getStartOfDay(s)))).replace(u.DATE_TIME_CONSTANTS.startOfWorkWeekUTC,c.getUTCTimeForUserLocal(a,c.getWorkWeekStartDateFromUserSettings(a,s)))).replace(u.DATE_TIME_CONSTANTS.startOfMonthUTC,c.getUTCTimeForUserLocal(a,c.getStartOfMonth(s)))).replace(u.DATE_TIME_CONSTANTS.startOfYearUTC,c.getUTCTimeForUserLocal(a,c.getStartOfYear(s)))).replace(u.DATE_TIME_CONSTANTS.userTimezoneHourOffset,c.getUserTimeZoneHourOffset(a).toString())).replace(u.DATE_TIME_CONSTANTS.userTimezoneMinuteOffset,c.getUserTimeZoneMinuteOffset(a).toString())).replace(u.DATE_TIME_CONSTANTS.UTCHourOffset,c.getUtcHourOffset(a).toString())).replace(u.DATE_TIME_CONSTANTS.UTCMinuteOffset,c.getUtcMinuteOffset(a).toString())];case 2:throw p=n.sent(),f=i.getErrorMessage(p)||"Failed to substitute date time placeholder",r.warn(d()+" "+f,o),new Error(f);case 3:return[2]}}))}))}},kPQX:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteRequestInterceptor=void 0;var s=r("Y0ua"),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.execute=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(e){throw new Error("execute function is not implemented")}))}))},t.prototype.preprocessing=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,e]}))}))},t.prototype.postprocessing=function(e,t){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,e]}))}))},t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){var t,r,a;return o(this,(function(n){switch(n.label){case 0:return t=e.request,[4,this.preprocessing(t)];case 1:return r=n.sent(),this.tracer.info(this.getExecuteRequestInterceptorPrefix()+" Execute request start "+r.url),[4,this.execute(r)];case 2:return a=n.sent(),this.tracer.info(this.getExecuteRequestInterceptorPrefix()+" Execute request finish "+a.status),[4,this.postprocessing(a,t)];case 3:return[2,n.sent()]}}))}))},t.prototype.getExecuteRequestInterceptorPrefix=function(e){return e?"["+e+"]":"["+s.FILE_PREFIX.ExecuteRequestInterceptor+"]"},t}(r("lHlh").Interceptor);t.ExecuteRequestInterceptor=u},kkhr:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeQueries=void 0;var i=r("kwGv"),o=r("uIhV"),s=r("Y0ua"),u=r("ZRE3");function l(e,t,r,a){void 0===a&&(a=!0);var n=o.getQueryTokenRegex(t,r),i=e.match(n);return i&&i.length>0?a?""+t+i[1]+r:i[1]:null}function c(e){return e?"["+e+"]":"["+s.FILE_PREFIX.MergeQuickFindSQLGenerator+"]"}t.mergeQueries=function(e,t,r,o,s){return a(this,void 0,void 0,(function(){var r,a,d,p,f,y,h,m;return n(this,(function(n){return r=s.commonEventParameters||[],e&&t?(d=l(e,i.OFFLINE_SQL_TOKEN.SELECT_START,i.OFFLINE_SQL_TOKEN.FROM_END))?(f=l(t,i.OFFLINE_SQL_TOKEN.CTE_START,i.OFFLINE_SQL_TOKEN.CTE_END),y=l(t,i.OFFLINE_SQL_TOKEN.WHERE_START,i.OFFLINE_SQL_TOKEN.WHERE_END,!1),(h=l(e,i.OFFLINE_SQL_TOKEN.WHERE_START,i.OFFLINE_SQL_TOKEN.WHERE_END,!1))?(h=h.toLowerCase().replace("where",""),y=""+i.OFFLINE_SQL_TOKEN.WHERE_START+y):y=""+i.OFFLINE_SQL_TOKEN.WHERE_START+y+i.OFFLINE_SQL_TOKEN.WHERE_END,m=l(t,i.OFFLINE_SQL_TOKEN.ORDERBY_START,i.OFFLINE_SQL_TOKEN.ORDERBY_END),a=f?f+" "+d+" "+y:d+" "+y,h&&(a+=" and ("+h+")"+i.OFFLINE_SQL_TOKEN.WHERE_END),m&&(a+=" "+m),[2,a]):(p="Failed to merge lookup query:\n"+e+"\nwith quick find query:\n"+t+"\nsince no viewQuerySelectPart found",o.error(c()+" "+p,r),[2,Promise.reject(new u.LocalError(p))]):(p="Lookup view sql query or quick find sql query is empty",o.error(c()+" "+p,r),[2,Promise.reject(new u.LocalError(p))])}))}))}},knOV:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExecuteOfflineSqlGenerator=void 0;var a=r("Y4g1");t.ExecuteOfflineSqlGenerator=function(e,t,r){return void 0===r&&(r={}),a.generateSQL(e,t,r)}},kwGv:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DATE_TIME_CONSTANTS=t.CLAUSE=t.ERROR_STRING=t.FCB_CONSTANTS=t.DEFAULT=t.OFFLINE_SQL_TOKEN=t.Punctuation=t.SORT=t.RecurringAppointmentMaster=t.QuoteClose=t.OrderClose=t.OpportunityClose=t.IncidentResolution=t.BulkOperation=t.DateTimeFormat=t.SqlOperation=t.FullNameConventionCode=t.AnnotationEntityLogicalName=t.NumberAttributeType=t.FieldFormatValue=void 0,function(e){e[e.Raw=0]="Raw",e[e.Numeric=1]="Numeric",e[e.Label=2]="Label",e[e.Value=3]="Value",e[e.State=4]="State",e[e.Id=5]="Id",e[e.Name=6]="Name",e[e.LogicalName=7]="LogicalName",e[e.AllowedStatusTransitions=8]="AllowedStatusTransitions",e[e.DefaultStatus=9]="DefaultStatus",e[e.Color=10]="Color"}(t.FieldFormatValue||(t.FieldFormatValue={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.UniqueIdentifier=15]="UniqueIdentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(t.NumberAttributeType||(t.NumberAttributeType={})),t.AnnotationEntityLogicalName="annotation",function(e){e[e.lastFirst=0]="lastFirst",e[e.firstLast=1]="firstLast",e[e.lastFirstMiddleInitial=2]="lastFirstMiddleInitial",e[e.firstMiddleInitialLast=3]="firstMiddleInitialLast",e[e.lastFirstMiddle=4]="lastFirstMiddle",e[e.firstMiddleLast=5]="firstMiddleLast",e[e.lastSpaceFirst=6]="lastSpaceFirst",e[e.lastNoSpaceFirst=7]="lastNoSpaceFirst"}(t.FullNameConventionCode||(t.FullNameConventionCode={})),function(e){e[e.create=0]="create",e[e.update=1]="update",e[e.delete=3]="delete"}(t.SqlOperation||(t.SqlOperation={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(t.DateTimeFormat||(t.DateTimeFormat={})),t.BulkOperation=4406,t.IncidentResolution=4206,t.OpportunityClose=4208,t.OrderClose=4209,t.QuoteClose=4211,t.RecurringAppointmentMaster=4251,t.SORT={ASC:"asc",DESC:"desc"},t.Punctuation={dot:".",closeSQBracket:"]",comma:",",doubleQuote:'"',openSQBracket:"[",singleQuote:"'",space:" ",exclamation:"!",equal:"=",question:"?",openParenthesis:"(",closeParenthesis:")",asterisk:"*"},t.OFFLINE_SQL_TOKEN={QUICKFIND_START:"/*QuickFindStart*/",QUICKFIND_END:"/*QuickFindEnd*/",SELECT_START:"/*SelectStart*/",SELECT_END:"/*SelectEnd*/",FROM_START:"/*FromStart*/",FROM_END:"/*FromEnd*/",CTE_START:"/*CTEStart*/",CTE_END:"/*CTEEnd*/",WHERE_START:"/*WhereStart*/",WHERE_END:"/*WhereEnd*/",ORDERBY_START:"/*OrderByStart*/",ORDERBY_END:"/*OrderByEnd*/"},t.DEFAULT={PageSize:"25",PageNumber:"1",EmptyString:""},t.FCB_CONSTANTS={SqlTokensAvailable:"UseOfflineSqlTokens",MdlUsesDependencyInformation:"MDLUsesDependencyInformation"},t.ERROR_STRING={primaryIdAttribute:"Entity metadata does not have primary id attribute",referencedId:"Missing ID of the referenced entity record.",invalidParameter:"Invalid parameters"},t.CLAUSE={insert:"INSERT",select:"SELECT",update:"UPDATE",set:"SET",where:"WHERE",delete:"DELETE",orderBy:"ORDER BY",collateNoCase:"COLLATE NOCASE",limit:"LIMIT",offset:"OFFSET",from:"FROM",as:"AS",in:"IN",and:"AND",into:"INTO",values:"VALUES",placeholder:"?"},t.DATE_TIME_CONSTANTS={startOfCurrentHourUTC:"'!start-of-current-hour-utc!'",startOfTodayUTC:"'!start-of-today-utc!'",startOfWorkWeekUTC:"'!start-of-work-week-utc!'",startOfMonthUTC:"'!start-of-month-utc!'",startOfYearUTC:"'!start-of-year-utc!'",userTimezoneHourOffset:"!user-timezone-hour-offset!",userTimezoneMinuteOffset:"!user-timezone-minute-offset!",UTCHourOffset:"!utc-hour-offset!",UTCMinuteOffset:"!utc-minute-offset!"}},lHlh:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.Interceptor=void 0;var a=r("Y0ua"),n=function(e){this.applicationContext=e,this.tracer=e.TraceManager.getTracer(a.COMPONENT_NAMES.ODataExecutor)};t.Interceptor=n},"lMa+":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyGuid=void 0;var a=r("pqvw"),n=r("i2et"),i=function(){function e(t,r){if(this._formattedGuid="",r)this._rawGuid=t;else if(this._rawGuid=e._GetParsedString(t),a.isNullOrUndefinedOrEmptyString(this._rawGuid))throw new Error("Not a valid guid")}return e.get_empty=function(){return e._empty||(e._empty=new e("00000000000000000000000000000000",!0))},e.createFromObjectData=function(t){return new e(t.rawguid)},e.tryCreate=function(t){var r=e._GetParsedString(t);return a.isNullOrUndefinedOrEmptyString(r)?e.get_empty():new e(r)},e.createFromFormattedGuidStringAndSkipParsing=function(t){return typeof t!==n.AttributeType.String||a.isNullOrUndefinedOrEmptyString(t)?e.get_empty():new e(t.replace(e._get_GuidStripperPattern(),""),!0)},e.isNullOrEmpty=function(t){return!(!a.isNullOrUndefined(t)&&t.length)||!!new e(t).equals(e._empty)},e.newGuid=function(){for(var t=0;t<36;t++)if(14!==t){if(8!==t&&13!==t&&18!==t&&23!==t){if(19===t){var r=Math.floor(16*Math.random());"0123456789abcdef".substr(3&r|8,1)}"".concat("0123456789abcdef".substr(Math.floor(16*Math.random()),1))}}else"".concat("4");return new e("".toString(),!0)},e._get_BraceAndHyphenGuidVerifierPattern=function(){return e._braceAndHyphenGuidVerifierPattern||(e._braceAndHyphenGuidVerifierPattern=new RegExp("^{(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}}$"))},e._get_GuidStripperPattern=function(){return e._guidStripperPattern||(e._guidStripperPattern=new RegExp("{|}|-","g"))},e._get_HyphenGuidVerifierPattern=function(){return e._hyphenGuidVerifierPattern||(e._hyphenGuidVerifierPattern=new RegExp("^(\\d|[a-f]){8}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){4}-(\\d|[a-f]){12}$"))},e._get_ContiguousGuidVerifierPattern=function(){return e._contiguousGuidVerifierPattern||(e._contiguousGuidVerifierPattern=new RegExp("^(\\d|[a-f]){32}$"))},e._GetParsedString=function(t){return a.isNullOrUndefinedOrEmptyString(t)?"":(t=t.toLowerCase(),e._get_HyphenGuidVerifierPattern().test(t)||e._get_BraceAndHyphenGuidVerifierPattern().test(t)?t.replace(e._get_GuidStripperPattern(),""):e._get_ContiguousGuidVerifierPattern().test(t)?t:"")},e.prototype.getObjectData=function(){return{rawguid:this._rawGuid}},e.prototype.equals=function(t){if(t instanceof e)return t._rawGuid===this._rawGuid;if("string"==typeof t)try{return new e(t)._rawGuid===this._rawGuid}catch(e){return!1}return!1},e.prototype.toString=function(){return this._formattedGuid||(this._formattedGuid=this._rawGuid.substring(0,8)+"-"+this._rawGuid.substring(8,12)+"-"+this._rawGuid.substring(12,16)+"-"+this._rawGuid.substring(16,20)+"-"+this._rawGuid.substring(20,32)),this._formattedGuid},e}();t.LegacyGuid=i,i.__typeName="Microsoft.Crm.Client.Core.Framework.Guid"},mdZd:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.OptionMetadata=void 0;var o=i(r("VF39")),s=function(){function e(e,t,r,a,n,i,o){this._val=0,this._state=0,this._defaultStatus=0,this._label=e,this._val=t,this._state=r,this._defaultStatus=a,this._allowedStatusTransitions=n,this._color=i,this._invariantName=o}return e.createFromPicklistItem=function(t){if(t instanceof e)return t;return new e(t.get_Label(),Number(t.get_ValueString()),-1,-1,[],"","")},e.createFromObjectData=function(t){return new e(t.label,t.value,"state"in t?t.state:-1,"defaultstatus"in t?t.defaultstatus:-1,"allowedstatustransitions"in t?t.allowedstatustransitions:[],"color"in t?t.color:"",t.invariantname)},e.createFromOData=function(t){return new e(t.Label,t.Value,"State"in t?t.State:-1,"DefaultStatus"in t?t.DefaultStatus:-1,"TransitionData"in t?t.TransitionData:[],"Color"in t?t.Color:"",t.Description)},e.prototype.get_Label=function(){return this._label},e.prototype.set_Label=function(e){return this._label=e,e},e.prototype.get_ValueString=function(){return this._val.toString()},e.prototype.get_allowedStatusTransitions=function(){return this._allowedStatusTransitions},e.prototype.get_color=function(){return this._color},e.prototype.get_value=function(){return this._val},e.prototype.get_state=function(){return this._state},e.prototype.get_defaultStatus=function(){return this._defaultStatus},e.prototype.get_invariantName=function(){return this._invariantName},e.prototype.getObjectData=function(){return{label:this._label,value:this._val,state:this._state,defaultstatus:this._defaultStatus,allowedstatustransitions:this._allowedStatusTransitions,color:this._color,invariantname:this._invariantName}},e.prototype.getODataObject=function(){return{Value:this._val,Color:this._color,Label:this._label,DefaultStatus:this._defaultStatus,State:this._state,TransitionData:this._allowedStatusTransitions,InvariantName:this._invariantName}},e.prototype.getValue=function(e){if(e===o.label||"label"===e)return this.get_Label();if(e===o.value||"value"===e)return this.get_value();if(e===o.state||"state"===e)return this.get_state();if(e===o.defaultStatus||"defaultstatus"===e)return this._defaultStatus;if(e===o.allowedStatusTransitions||"allowedstatustransitions"===e)return this.get_allowedStatusTransitions();if(e===o.color||"color"===e)return this.get_color();throw new Error("fieldName = ${fieldName} is out of range")},e}();t.OptionMetadata=s,s.__typeName="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.OptionMetadata"},mklL:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBatchSqlResults=t.getSqlResults=void 0;var i=r("bOB9"),o=r("pqvw"),s=r("Y0ua");function u(e){return e?"["+e+"]":"["+s.FILE_PREFIX.GetSqlResults+"]"}t.getSqlResults=function(e,t,r){return a(this,void 0,void 0,(function(){var a,l,c;return n(this,(function(n){return a=e.TraceManager.getTracer(s.COMPONENT_NAMES.MetadataCache),l=[],a.info(u()+" Starting getSqlResults"),(c={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}}).sqlStatements.push(t),c.sqlParameters.push(r),[2,e.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(c).then((function(e){return a.info(u()+" Completed getSqlResults"),e})).catch((function(e){var t=o.convertErrorToLocalError(e);return l.push({name:i.STRING_CONSTANTS.Message,value:t.message}),l.push({name:i.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:i.UNKNOWN}),l.push({name:i.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:i.UNKNOWN}),a.error(u()+" Exception in getSqlResults. Error message = "+e.message,l),Promise.reject(t)}))]}))}))},t.getBatchSqlResults=function(e,t){return a(this,void 0,void 0,(function(){var r,a;return n(this,(function(n){return r=e.TraceManager.getTracer(s.COMPONENT_NAMES.MetadataCache),(a=[]).push({name:"NoOfSQLStatements",value:t&&t.sqlStatements?t.sqlStatements.length:0}),r.info(u()+" Starting getBatchSqlResults. ",a),[2,e.SqlExecutor.ExecuteSqlStatementsOnMetadataDB(t).then((function(e){return r.info(u()+" Completed getBatchSqlResults",a),e})).catch((function(e){var t=o.convertErrorToLocalError(e);return a.push({name:i.STRING_CONSTANTS.Message,value:t.message}),a.push({name:i.STRING_CONSTANTS.ErrorCode,value:t.code?t.code:i.UNKNOWN}),a.push({name:i.STRING_CONSTANTS.StackTrace,value:t.stack?t.stack:i.UNKNOWN}),r.error(u()+" Exception in getBatchSqlResults. Error message = "+e.message,a),Promise.reject(t)}))]}))}))}},nN45:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},o=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=this&&this.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,n,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},c=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e};Object.defineProperty(t,"__esModule",{value:!0}),t.generateRetrieveRequest=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var d=r("pqvw"),p=r("Y0ua"),f=r("i2et"),y=r("Z84h"),h=r("Ag5+"),m=r("kwGv"),b=i(r("88gK")),v=r("9Qps"),g=r("jEjT"),E=r("bOB9");function T(e,t){var r,a;if(d.isNullOrUndefined(t)||0===t.length)return t;var n=[e.PrimaryIdAttribute,e.PrimaryNameAttribute];try{for(var i=u(n),o=i.next();!o.done;o=i.next()){var s=o.value;d.isNullOrUndefined(s)||-1!==t.indexOf(s)||t.push(s)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return t}function _(e,t,r,a,n,i,u){return o(this,void 0,void 0,(function(){var o,l,c,p;return s(this,(function(s){switch(s.label){case 0:if(!(Object.keys(r).length>0))return[3,4];for(l in d.isNullOrUndefined(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters[E.EXPAND_PROPERTIES]=[],n.info(A()+" Requested for expansions",i),o=[],r)o.push(l);c=0,s.label=1;case 1:return c<o.length?(p=o[c],[4,S(e,p,r[p],t,a,u)]):[3,4];case 2:a=s.sent(),s.label=3;case 3:return c++,[3,1];case 4:return[2,a]}}))}))}function S(e,t,r,a,n,i){return o(this,void 0,void 0,(function(){var o,u,l,c,p,f,y,h,m;return s(this,(function(s){switch(s.label){case 0:if(d.isNullOrUndefined(n.additionalParameters)&&(n.additionalParameters={}),o=!1,!a.OneToManyRelationships)return[3,4];for(l in u=[],a.OneToManyRelationships)u.push(l);c=0,s.label=1;case 1:return c<u.length?(h=u[c],(m=a.OneToManyRelationships[h]).ReferencedEntityNavigationPropertyName!==t?[3,3]:(o=!0,[4,O(m,e,t,r,a,n,i)])):[3,4];case 2:s.sent(),s.label=3;case 3:return c++,[3,1];case 4:if(o||!a.ManyToOneRelationships)return[3,8];for(f in p=[],a.ManyToOneRelationships)p.push(f);y=0,s.label=5;case 5:return y<p.length?(h=p[y],(m=a.ManyToOneRelationships[h]).ReferencingEntityNavigationPropertyName!==t?[3,7]:[4,N(m,e,t,r,a,n,i)]):[3,8];case 6:s.sent(),s.label=7;case 7:return y++,[3,5];case 8:return[2,n]}}))}))}function O(e,t,r,a,n,i,u){return o(this,void 0,void 0,(function(){var o,l,p,f,h,b,v,g,T,_;return s(this,(function(s){switch(s.label){case 0:return d.isNullOrUndefined(i.additionalParameters)&&(i.additionalParameters={}),d.isNullOrUndefined(i.additionalParameters[E.EXPAND_PROPERTIES])&&(i.additionalParameters[E.EXPAND_PROPERTIES]=[]),o=e.ReferencedAttribute,l=e.ReferencingAttribute,p=e.ReferencingEntity,[4,y.getAttributeTypes(u,[],p)];case 1:return f=s.sent(),h=M(f,l),b={ExpandValueType:E.EXPAND_VALUES.MULTI_VALUE,ExpandPropertyName:r,ExpandQueryIndex:i.sqlStatements.length,ReferencedOrReferencingEntityName:p},i.additionalParameters[E.EXPAND_PROPERTIES].push(b),a.clause!==m.CLAUSE.select?[3,4]:(v="*",a.values.length>0?[4,y.getEntityMetadata(u,p)]:[3,3]);case 2:g=s.sent(),(T=g.PrimaryIdAttribute)&&a.values.push(T),p===E.FILE_ATTACHMENT&&a.values.push(E.DEVICE_FILE_PATH),v=a.values.map((function(e){return"["+M(f,e)+"]"})).join(","),s.label=3;case 3:return i.sqlStatements.push("SELECT "+v+" FROM ["+p+"] WHERE ["+h+"] = (SELECT ["+o+"] FROM ["+n.EntityLogicalName+"] WHERE ["+n.PrimaryIdAttribute+"]=?)"),i.sqlParameters.push([t.guid]),[3,5];case 4:a.clause===m.CLAUSE.in&&(_=(_="?,".repeat(a.values.length)).substring(0,_.length-1),i.sqlStatements.push("SELECT * FROM ["+p+"] WHERE ["+a.propertyName+"] IN ("+_+") AND ["+h+"]=(SELECT ["+o+"] FROM ["+n.EntityLogicalName+"] WHERE ["+n.PrimaryIdAttribute+"]=?)"),i.sqlParameters.push(c(a.values,[t.guid]))),s.label=5;case 5:return[2]}}))}))}function N(e,t,r,a,n,i,u){return o(this,void 0,void 0,(function(){var o,l,p,f,h,b,v,g,T,_;return s(this,(function(s){switch(s.label){case 0:return d.isNullOrUndefined(i.additionalParameters)&&(i.additionalParameters={}),d.isNullOrUndefined(i.additionalParameters[E.EXPAND_PROPERTIES])&&(i.additionalParameters[E.EXPAND_PROPERTIES]=[]),o=e.ReferencedAttribute,l=e.ReferencingAttribute,p=e.ReferencedEntity,[4,y.getAttributeTypes(u,[],p)];case 1:return f=s.sent(),h=M(f,o),b={ExpandValueType:E.EXPAND_VALUES.SINGLE_VALUE,ExpandPropertyName:r,ExpandQueryIndex:i.sqlStatements.length,ReferencedOrReferencingEntityName:p},i.additionalParameters[E.EXPAND_PROPERTIES].push(b),a.clause!==m.CLAUSE.select?[3,4]:(v="*",a.values.length>0?[4,y.getEntityMetadata(u,p)]:[3,3]);case 2:g=s.sent(),(T=g.PrimaryIdAttribute)&&a.values.push(T),v=a.values.map((function(e){return"["+M(f,e)+"]"})).join(","),s.label=3;case 3:return i.sqlStatements.push("SELECT "+v+" FROM ["+p+"] WHERE ["+h+"] = (SELECT ["+l+"] FROM ["+n.EntityLogicalName+"] WHERE ["+n.PrimaryIdAttribute+"]=?)"),i.sqlParameters.push([t.guid]),[3,5];case 4:a.clause===m.CLAUSE.in&&(_=(_="?,".repeat(a.values.length)).substring(0,_.length-1),i.sqlStatements.push("SELECT * FROM ["+p+"] WHERE ["+h+"] = (SELECT ["+l+"] FROM ["+n.EntityLogicalName+"] WHERE ["+n.PrimaryIdAttribute+"]=?) AND ["+a.propertyName+"] IN ("+_+")"),i.sqlParameters.push(c([t.guid],a.values))),s.label=5;case 5:return[2]}}))}))}function M(e,t){var r=h.getAttributeName(t),a=e[r];return a===f.AttributeType.Owner||a===f.AttributeType.Lookup||a===f.AttributeType.Customer?""+r+b.columnDelimiter+b.id:r}function P(e,t){return o(this,void 0,void 0,(function(){var r;return s(this,(function(a){return d.isNullOrUndefinedOrEmptyString(e.entityLogicalName)||(r=m.CLAUSE.select+" "+m.Punctuation.asterisk+" "+m.CLAUSE.from+" ["+e.entityLogicalName+"] "+m.CLAUSE.where+" ["+e.primaryIdAttribute+"]"+m.Punctuation.equal+m.CLAUSE.placeholder,t.sqlStatements.push(r),t.sqlParameters.push([e.primaryIdValue.guid]),d.isNullOrUndefined(t.additionalParameters)&&(t.additionalParameters={}),t.additionalParameters.BPFEntityLogicalName=e.entityLogicalName,t.additionalParameters.BPFQueryIndex=t.sqlStatements.length-1),[2,t]}))}))}function w(e,t,r,a,n){return o(this,void 0,void 0,(function(){var i,o,u,l;return s(this,(function(s){for(u in i=!1,o={},t)t[u]===f.AttributeType.PartyList&&(o[b.participationTypeValue[u]]=u,i=!0);return i?(a.info(A()+" Attempting to retrieve "+o.length+" activity parties",n.commonEventParameters),l=[b.participationMasks,b.activityId+m.Punctuation.exclamation+b.id,b.activityId+m.Punctuation.exclamation+b.name,b.activityId+m.Punctuation.exclamation+b.logicalName,b.activityPartyId,b.partyId+m.Punctuation.exclamation+b.id,b.partyId+m.Punctuation.exclamation+b.name,b.partyId+m.Punctuation.exclamation+b.logicalName,b.isPartyDeleted,b.partyObjectTypeCode,b.addressUsed],[2,C(e,l,o,r,a,n)]):(a.warn(A()+" Activity entity does not have party type attributes",n.commonEventParameters),[2,r])}))}))}function C(e,t,r,a,n,i){if(d.isNullOrUndefined(t)||0===t.length)return n.error(A()+" Empty list of columns received. Not generating activity party query",i.commonEventParameters),a;for(var o="",s=0;s<t.length;s++)o+=m.Punctuation.openSQBracket+t[s]+m.Punctuation.closeSQBracket+m.Punctuation.comma;o=o.substr(0,o.length-1);var u=(""+m.CLAUSE.placeholder+m.Punctuation.comma).repeat(Object.keys(r).length);u=u.substr(0,u.length-1);var l=m.Punctuation.openSQBracket+b.activityId+b.columnDelimiter+b.id+m.Punctuation.closeSQBracket+m.Punctuation.equal+m.Punctuation.question+m.Punctuation.space+m.CLAUSE.and+m.Punctuation.space+m.Punctuation.openSQBracket+b.participationMasks+m.Punctuation.closeSQBracket+m.Punctuation.space+m.CLAUSE.in+m.Punctuation.space+m.Punctuation.openParenthesis+u+m.Punctuation.closeParenthesis,p=m.CLAUSE.select+m.Punctuation.space+o+m.Punctuation.space+m.CLAUSE.from+m.Punctuation.space+m.Punctuation.openSQBracket+b.activityParty+m.Punctuation.closeSQBracket+m.Punctuation.space+m.CLAUSE.where+m.Punctuation.space+l+m.CLAUSE.collateNoCase+m.Punctuation.space+m.CLAUSE.orderBy+m.Punctuation.space+m.Punctuation.openSQBracket+b.participationMasks+m.Punctuation.closeSQBracket;return a.sqlStatements.push(p),a.sqlParameters.push(c([e.guid.toString()],Object.keys(r))),d.isNullOrUndefined(a.additionalParameters)&&(a.additionalParameters={}),a.additionalParameters.ContainsActivityPartyQuery=!0,a.additionalParameters.ParticipationMasks=r,a.additionalParameters.ActivityPartyQueryIndex=a.sqlStatements.length-1,a}function I(e,t,r,a,n,i,u){return o(this,void 0,void 0,(function(){var o,l,c,p;return s(this,(function(s){switch(s.label){case 0:return o={sqlStatements:[],sqlParameters:new Array,additionalParameters:{}},l=t.PrimaryIdAttribute,[4,y.getAttributeTypes(u,[],e,i)];case 1:if(c=s.sent(),d.isNullOrUndefinedOrEmptyString(l))throw n.error(A()+" Invalid parameters when generating RETRIEVE query",i),new Error("Invalid primary id attribute");return p="",p=d.isNullOrUndefined(a)||0===a.length?m.Punctuation.asterisk:a.map((function(e){return"["+M(c,e)+"]"})).join(""+m.Punctuation.comma+m.Punctuation.space),o.sqlStatements.push(m.CLAUSE.select+m.Punctuation.space+p+m.Punctuation.space+m.CLAUSE.from+m.Punctuation.space+m.Punctuation.openSQBracket+e+m.Punctuation.closeSQBracket+m.Punctuation.space+m.CLAUSE.where+m.Punctuation.space+m.Punctuation.openSQBracket+l+m.Punctuation.closeSQBracket+m.Punctuation.equal+m.Punctuation.space+m.Punctuation.question+m.Punctuation.space+m.CLAUSE.collateNoCase),o.sqlParameters.push([r.guid]),[2,o]}}))}))}function A(e){return e?"["+e+"]":"["+p.FILE_PREFIX.RetrieveGenerator+"]"}t.generateRetrieveRequest=function(e,t,r,a,n){return void 0===a&&(a={}),o(this,void 0,void 0,(function(){var i,o,u,l,c,p,f,m,b,E;return s(this,(function(s){switch(s.label){case 0:return i=a.commonEventParameters||[],[4,h.getEntityNameFromUrl(e.url,t,r,i)];case 1:if(o=s.sent(),u=h.getEntityIdFromUrl(e.url,r,i),d.isNullOrUndefined(u))throw l=new Error("Retrieve Generator was unable to extract GUID from url"),r.error(A()+" "+l.message,i),l;return[4,y.getEntityMetadata(t,o)];case 2:return c=s.sent(),[4,y.getAttributeTypes(t,[],o,i)];case 3:return p=s.sent(),[4,g.getRequestedColumns(e.url,p,r,i)];case 4:return f=s.sent(),[4,T(c,f)];case 5:return s.sent(),m=null,d.isNullOrUndefined(n)?[3,7]:[4,v.addBPFColumns(o,f,n,c,t,r,i)];case 6:m=s.sent(),s.label=7;case 7:return[4,I(o,c,u,f,r,i,t)];case 8:return b=s.sent(),d.isNullOrUndefined(m)?[3,10]:[4,P(m,b)];case 9:b=s.sent(),s.label=10;case 10:return c.IsActivity?[4,w(u,p,b,r,a)]:[3,12];case 11:b=s.sent(),s.label=12;case 12:return[4,g.getExpandTermTokens(e.url,r,i)];case 13:return E=s.sent(),Object.keys(E).length>0?[4,_(u,c,E,b,r,i,t)]:[3,15];case 14:b=s.sent(),s.label=15;case 15:return[2,b]}}))}))}},onZ8:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMetadata=void 0;var a=r("pqvw"),n=r("i2et"),i=r("7EEb"),o=r("lMa+"),s=r("6Use"),u=r("LP2S"),l=function(){function e(e,t,r,i,o,s,u,l,c,d,p,f,y,h,m,b,v,g,E,T,_,S,O,N,M,P,w,C,I,A,R){this._type=n.AttributeType.Boolean,this._sourceType=0,this._formatName="",this._attributeTypeName="",this._description="",this._columnNumber=0,this._sourceTypeMask=0,this._isSecured=!1,this._isValidForCreate=!1,this._isValidForRead=!1,this._isValidForUpdate=!1,this._requiredLevel=0,this._maxLength=0,this._minValue=0,this._maxValue=0,this._precision=0,this._precisionSource=0,this._behavior=0,this._defaultFormValue=0,this._defaultValue=!1,this._isBaseCurrency=!1,this._hasChanged=!1,this._isSortableEnabled=!1,this._imeMode=0,this._isLocalizable=!1,this._isCustomAttribute=!1,a.throwOnNullOrUndefinedArgument(e,"logicalName"),a.throwOnNullOrUndefinedArgument(t,"id"),a.throwOnNullOrUndefinedArgument(i,"type"),a.throwOnNullOrUndefinedArgument(d,"requiredLevel"),a.throwOnNullOrUndefinedArgument(s,"isSecured"),a.throwOnNullOrUndefinedArgument(u,"isValidForCreate"),a.throwOnNullOrUndefinedArgument(l,"isValidForRead"),a.throwOnNullOrUndefinedArgument(c,"isValidForUpdate"),this._logicalName=e,this._id=t,this._entityLogicalName=r,this._type=i,this._sourceType=C||0,this._displayName=o,this._isSecured=s,this._isValidForCreate=u,this._isValidForRead=l,this._isValidForUpdate=c,this._requiredLevel=d,this._maxLength=p,this._minValue=f,this._maxValue=y,this._precision=h,this._precisionSource=m,this._format=b,this._behavior=v,this._defaultFormValue=g,this._defaultValue=E,this._optionSet=T,this._targets=S,this._isBaseCurrency=_,this._attributeOf=O,this._hasChanged=N,this._isSortableEnabled=P||!1,this._imeMode=M||0,this._inheritsFrom=w||"",this._isLocalizable=I||!1,this._isCustomAttribute=A||!1,this._columnNumber=R||0}return e.extractKey=function(e){return o.LegacyGuid.createFromObjectData(e.id).toString()},e.addValueWrapper=function(e){var t={};return t.Value=e,t},e.removeValueWrapper=function(e){return e?e.Value:null},e.createFromObjectData=function(t){a.isNullOrUndefinedOrEmptyString(t.MetadataId)||(t=e.createFromODataResponse(t).getObjectData());var r=new e(t.logicalname,o.LegacyGuid.createFromObjectData(t.id),t.entitylogicalname,s.fromNumberAttributeType(t.type),t.displayname,t.issecured,t.isvalidforcreate,t.isvalidforread,t.isvalidforupdate,t.requiredlevel,t.maxlength,t.minvalue,t.maxvalue,t.precision,t.precisionsource,t.format,t.behavior,t.defaultformvalue,t.defaultvalue,u.OptionSetMetadata.createFromObjectData(t.optionset),t.isbasecurrency,t.targets,t.attributeof,t.haschanged,t.imemode,t.issortableenabled,t.inheritsfrom,t.sourcetype,t.islocalizable,t.IsCustomAttribute,t.columnNumber);return r._formatName=t.formatName,r._description=t.description,r._sourceTypeMask=t.sourceTypeMask,r._attributeTypeName=t.attributeTypeName,r},e.createFromODataResponse=function(t){var r=t.LogicalName,n=o.LegacyGuid.tryCreate(t.MetadataId),l=t.EntityLogicalName,c=s.fromNumberAttributeType(t.AttributeType),d=e.removeValueWrapper(t.AttributeTypeName),p=new RegExp("Type","g");if(a.isNullOrUndefinedOrEmptyString(d))throw new Error("Null or empty attribute type name in attribute metadata for entity "+l+" attribute type "+c);"float"===(d=d.replace(p,"").toLowerCase())&&(d="double");var f,y=t.SourceType,h=i.EntityMetadata.getLabelString(t.Description),m=i.EntityMetadata.getLabelString(t.DisplayName),b=e.removeValueWrapper(t.RequiredLevel);f="string"==typeof b?a.loadRequiredLevelFromCrmSoap(b):b;var v=t.IsSecured,g=t.IsValidForCreate,E=t.IsValidForUpdate,T=t.IsValidForRead,_=t.ColumnNumber,S=t.SourceTypeMask,O=t.MaxLength,N=t.MinValue,M=t.MaxValue,P=t.Precision,w=t.PrecisionSource,C=t.Format,I=null;a.isNullOrUndefined(C)||(I=C.toString());var A=e.removeValueWrapper(t.FormatName),R=e.removeValueWrapper(t.DateTimeBehavior),D=0;a.isNullOrUndefined(R)||(D=a.loadBehaviorFromCrmSoap(R));var L=t.DefaultFormValue,F=t.DefaultValue,x=t.IsBaseCurrency,k=t.AttributeOf,U=t.HasChanged,q=e.removeValueWrapper(t.IsSortableEnabled),V=t.ImeMode,B=t.InheritsFrom,Q=t.IsLocalizable,G=t.IsCustomAttribute,H=null,j=t.OptionSet;if(!a.isNullOrUndefined(j)){var Y=j.Options;if(a.isNullOrUndefined(Y)){var K=j.TrueOption,W=[j.FalseOption,K];H=u.OptionSetMetadata.createFromOData(W)}else H=u.OptionSetMetadata.createFromOData(Y)}var X=new e(r,n,l,c,m,v,g,T,E,f,O,N,M,P,w,I,D,L,F,H,x,t.Targets,k,U,V,q,B,y,Q,G,_);return X._formatName=A,X._description=h,X._sourceTypeMask=S,X._attributeTypeName=d,X},e.prototype.get_id=function(){return this._id},e.prototype.get_logicalName=function(){return this._logicalName},e.prototype.get_entityLogicalName=function(){return this._entityLogicalName},e.prototype.get_type=function(){return this._type},e.prototype.get_sourceType=function(){return this._sourceType},e.prototype.get_displayName=function(){return this._displayName},e.prototype.get_isValidForCreate=function(){return this._isValidForCreate},e.prototype.get_isSecured=function(){return this._isSecured},e.prototype.get_isValidForUpdate=function(){return this._isValidForUpdate},e.prototype.get_isValidForRead=function(){return this._isValidForRead},e.prototype.get_requiredLevel=function(){return this._requiredLevel},e.prototype.get_maxLength=function(){return this._maxLength},e.prototype.get_minValue=function(){return this._minValue},e.prototype.get_maxValue=function(){return this._maxValue},e.prototype.get_precision=function(){return this._precision},e.prototype.get_precisionSource=function(){return this._precisionSource},e.prototype.get_format=function(){return this._format},e.prototype.get_formatName=function(){return this._formatName},e.prototype.get_behavior=function(){return this._behavior},e.prototype.get_isBaseCurrency=function(){return this._isBaseCurrency},e.prototype.get_defaultFormValue=function(){return this._defaultFormValue},e.prototype.get_defaultValue=function(){return this._defaultValue},e.prototype.get_optionSet=function(){return this._optionSet},e.prototype.get_targets=function(){return this._targets},e.prototype.get_attributeOf=function(){return this._attributeOf},e.prototype.get_hasChanged=function(){return this._hasChanged},e.prototype.get_isSortableEnabled=function(){return this._isSortableEnabled},e.prototype.get_imeMode=function(){return this._imeMode},e.prototype.get_inheritsFrom=function(){return this._inheritsFrom},e.prototype.get_isLocalizable=function(){return this._isLocalizable},e.prototype.get_isCustomAttribute=function(){return this._isCustomAttribute},e.prototype.get_columnNumber=function(){return this._columnNumber},e.prototype.getObjectData=function(){var t;return(t={})[e.logicalNamePath]=this._logicalName,t.id=this._id.getObjectData(),t[e.entityLogicalNamePath]=this._entityLogicalName,t[e.entityAttributeLogicalNamesPath]=this._entityLogicalName+a.COMPOSITE_INDEX_DELIMITER+this._logicalName,t.type=s.toNumberAttributeType(this._type),t.sourcetype=this._sourceType,t.displayname=this._displayName,t.issecured=this._isSecured,t.issortableenabled=this._isSortableEnabled,t.isvalidforcreate=this._isValidForCreate,t.isvalidforupdate=this._isValidForUpdate,t.isvalidforread=this._isValidForRead,t.requiredlevel=this._requiredLevel,t.maxlength=this._maxLength,t.minvalue=this._minValue,t.maxvalue=this._maxValue,t.precision=this._precision,t.precisionsource=this._precisionSource,t.defaultformvalue=this._defaultFormValue,t.defaultvalue=this._defaultValue,t.format=this._format,t.behavior=this._behavior,t.isbasecurrency=this._isBaseCurrency,t.attributeof=this._attributeOf,t.haschanged=this._hasChanged,t.imemode=this._imeMode,t.inheritsfrom=this._inheritsFrom,t.islocalizable=this._isLocalizable,t.formatName=this._formatName,t.description=this._description,t.columnNumber=this._columnNumber,t.sourceTypeMask=this._sourceTypeMask,t.attributeTypeName=this._attributeTypeName,t.IsCustomAttribute=this._isCustomAttribute,t.optionset=a.isNullOrUndefined(this._optionSet)?void 0:this._optionSet.getObjectData(),t.targets=a.isNullOrUndefined(this._targets)?void 0:this._targets,t},e.prototype.getODataObject=function(){return{LogicalName:this._logicalName,MetadataId:this._id.toString(),EntityLogicalName:this._entityLogicalName,EntityAttributeLogicalNames:this._entityLogicalName+a.COMPOSITE_INDEX_DELIMITER+this._logicalName,AttributeType:s.toNumberAttributeType(this._type),AttributeTypeName:e.addValueWrapper(("double"===this._attributeTypeName?"Float":this._attributeTypeName)+"Type"),Description:i.EntityMetadata.convertToLabel(this._description),ColumnNumber:this._columnNumber,FormatName:e.addValueWrapper(this._formatName),SourceTypeMask:this._sourceTypeMask,OptionSet:!a.isNullOrUndefined(this._optionSet)&&this._optionSet.getODataObject(),SourceType:this._sourceType,DisplayName:i.EntityMetadata.convertToLabel(this._displayName),IsSecured:this._isSecured,IsSortableEnabled:e.addValueWrapper(this._isSortableEnabled),IsValidForCreate:this._isValidForCreate,IsValidForUpdate:this._isValidForUpdate,IsValidForRead:this._isValidForRead,RequiredLevel:e.addValueWrapper(this._requiredLevel),MaxLength:this._maxLength,MinValue:this._minValue,MaxValue:this._maxValue,Precision:this._precision,PrecisionSource:this._precisionSource,DefaultFormValue:this._defaultFormValue,DefaultValue:this._defaultValue,Format:!a.isNullOrUndefined(this._format)&&parseInt(this._format,10),DateTimeBehavior:e.addValueWrapper(a.behaviorToCrmSoap(this._behavior)),IsBaseCurrency:this._isBaseCurrency,AttributeOf:this._attributeOf,HasChanged:this._hasChanged,ImeMode:this._imeMode,InheritsFrom:this._inheritsFrom,IsLocalizable:this._isLocalizable,IsCustomAttribute:this._isCustomAttribute,Targets:!a.isNullOrUndefined(this._targets)&&this._targets}},e.entityLogicalNamePath="entitylogicalname",e.logicalNamePath="logicalname",e.entityAttributeLogicalNamesPath="entitylogicalname_logicalname",e}();t.AttributeMetadata=l},pq07:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.getLegacySubtype=t.getLegacyMetadataTypeForQuery=void 0;var a=r("pqvw"),n=r("Ct6E");function i(e,t){var r;switch(e){case"form":case"formselector":case"dashboardselector":r=function(e){var t=n.MetadataSubtype.none;if(!a.isNullOrUndefined(e))switch(e.toLowerCase()){case"appointmentbook":t=n.MetadataSubtype.appointment;break;case"hardcoded":t=n.MetadataSubtype.hardcoded;break;case"main":t=n.MetadataSubtype.main;break;case"minicampaignbo":t=n.MetadataSubtype.miniCampaignBO;break;case"preview":t=n.MetadataSubtype.preview;break;case"dashboard":t=n.MetadataSubtype.dashboard;break;case"quick":t=n.MetadataSubtype.quick;break;case"mobile":t=n.MetadataSubtype.mobile;break;case"read":t=n.MetadataSubtype.read;break;case"quickcreate":t=n.MetadataSubtype.quickCreate;break;case"dialog":t=n.MetadataSubtype.dialog;break;case"card":t=n.MetadataSubtype.card;break;case"taskbasedform":t=n.MetadataSubtype.taskBased;break;case"interactioncentricdashboard":t=n.MetadataSubtype.interactionCentricDashboard;break;default:t=n.MetadataSubtype.none}return t}(t);break;case"viewselector":case"savedview":case"userview":r=function(e){var t=n.MetadataSubtype.none;if(!a.isNullOrUndefined(e))switch(e.toUpperCase()){case"MAIN_APPLICATION_VIEW":t=n.MetadataSubtype.main;break;case"ADVANCED_SEARCH":t=n.MetadataSubtype.advancedSearch;break;case"SUB_GRID":t=n.MetadataSubtype.subGrid;break;case"QUICKFIND_SEARCH":t=n.MetadataSubtype.quickFindSearch;break;case"REPORTING":t=n.MetadataSubtype.reporting;break;case"OFFLINE_FILTERS":t=n.MetadataSubtype.offlineFilters;break;case"MA_SEARCH":t=n.MetadataSubtype.maSearch;break;case"LOOKUP_VIEW":t=n.MetadataSubtype.lookup;break;case"SM_APPOINTMENTBOOK_VIEW":t=n.MetadataSubtype.smAppointmentBook;break;case"OUTLOOK_FILTERS":t=n.MetadataSubtype.outlookFilters;break;case"ADDRESSBOOK_FILTERS":t=n.MetadataSubtype.addressbookFilters;break;case"SAVEDQUERYTYPE_OTHER":t=n.MetadataSubtype.savedQueryTypeOther;break;case"INTERACTIVE_WORKFLOW_VIEW":t=n.MetadataSubtype.interactiveWorkFlow;break;case"OFFLINE_TEMPLATE":t=n.MetadataSubtype.offlineTemplate;break;case"OUTLOOK_TEMPLATE":t=n.MetadataSubtype.outlookTemplate;break;case"CUSTOM_DEFINED_VIEW":t=n.MetadataSubtype.customDefined;break;default:t=n.MetadataSubtype.none}return t}(t);break;case"workspace":case"systemworkspace":case"userworkspace":r=n.MetadataSubtype.dashboard;break;case"webresource":r=function(e){var t=0;if(!a.isNullOrUndefined(e))switch(e.toUpperCase()){case"HTML":t=10;break;case"CSS":t=6;break;case"JSCRIPT":t=5;break;case"XML":t=11;break;case"PNG":t=7;break;case"JPG":t=8;break;case"RESX":t=12;break;case"GIF":case"SILVERLIGHT":case"XSL":case"ICO":default:t=0}return t}(t);break;default:r=n.MetadataSubtype.none}return r}t.getLegacyMetadataTypeForQuery=function(e,t){switch(e){case"form":return{type:n.MetadataType.form,subtype:i("form",t)};case"workspace":case"systemworkspace":case"userworkspace":return{type:n.MetadataType.workspace,subtype:i(e,"dashboard")};case"formselector":return{type:n.MetadataType.formSelector,subtype:i(e,t)};case"bpfselector":return{type:n.MetadataType.bpfSelector,subtype:n.MetadataSubtype.none};case"dashboardselector":return{type:n.MetadataType.dashboardSelector,subtype:i(e,"dashboard")};case"search":return{type:n.MetadataType.searchConfiguration,subtype:n.MetadataSubtype.none};case"customcontrol":return{type:n.MetadataType.customControl,subtype:n.MetadataSubtype.none};case"resourcestring":return{type:n.MetadataType.resourceString,subtype:n.MetadataSubtype.none};case"visualizationselector":return{type:n.MetadataType.visualizationSelector,subtype:n.MetadataSubtype.none};case"savedvisualization":return{type:n.MetadataType.savedQueryVisualization,subtype:n.MetadataSubtype.none};case"uservisualization":return{type:n.MetadataType.userQueryVisualization,subtype:n.MetadataSubtype.none};case"label":return{type:n.MetadataType.label,subtype:n.MetadataSubtype.none};case"displaystring":return{type:n.MetadataType.displayString,subtype:n.MetadataSubtype.none};case"webresource":return{type:n.MetadataType.webResource,subtype:i(e,t)};case"webresourcedescriptor":return{type:n.MetadataType.webResourceDescriptor,subtype:n.MetadataSubtype.none};case"customcontroldefaultconfig":return{type:n.MetadataType.homePageConfiguration,subtype:n.MetadataSubtype.none};case"optionset":return{type:n.MetadataType.optionSet,subtype:n.MetadataSubtype.none};case"quickcreatemenu":return{type:n.MetadataType.quickCreateMenu,subtype:n.MetadataSubtype.none};case"businessprocessflow":return{type:n.MetadataType.businessProcessFlow,subtype:n.MetadataSubtype.none};case"dialog":return{type:n.MetadataType.dialog,subtype:n.MetadataSubtype.none};case"taskbasedflow":return{type:n.MetadataType.taskBasedFlow,subtype:n.MetadataSubtype.none};case"taskbasedflowglobalmenu":return{type:n.MetadataType.taskBasedFlowGlobalMenu,subtype:n.MetadataSubtype.none};case"sitemap":return{type:n.MetadataType.siteMap,subtype:n.MetadataSubtype.none};case"viewselector":return{type:n.MetadataType.viewSelector,subtype:i(e,t)};case"savedview":return{type:n.MetadataType.savedView,subtype:i(e,t)};case"userview":return{type:n.MetadataType.userView,subtype:i(e,t)};case"ribbon":return{type:n.MetadataType.command,subtype:n.MetadataSubtype.none};case"appmodules":return{type:n.MetadataType.appModule,subtype:n.MetadataSubtype.none};case"appmoduleselector":return{type:n.MetadataType.appModuleSelector,subtype:n.MetadataSubtype.none};case"metadataversion":return{type:n.MetadataType.overallMetadataVersion,subtype:n.MetadataSubtype.none};case"complexcontrol":return{type:n.MetadataType.complexControl,subtype:n.MetadataSubtype.none};case"isactivityflags":return{type:n.MetadataType.isActivityFlags,subtype:n.MetadataSubtype.none};case"appmoduleofflinemetadata":return{type:n.MetadataType.appModuleOfflineMetadata,subtype:n.MetadataSubtype.none};case"dependencies":return{type:n.MetadataType.dependencies,subtype:n.MetadataSubtype.none};default:return{type:n.MetadataType.none,subtype:n.MetadataSubtype.none}}},t.getLegacySubtype=i},pqvw:function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.convertErrorToLocalError=t.isUserContextMetadataRequest=t.getViewLocalStoreId=t.isNullOrUndefinedOrEmpty=t.buildODataResponseFromError=t.isNullOrUndefinedOrEmptyString=t.isNullOrUndefined=t.getHttpHeader=t.parseBatchResponse=t.buildBatchRequest=t.encodeURIComponentForOData=t.COMPOSITE_INDEX_DELIMITER=t.trimWildCards=t.handleEscapeCharacters=t.convertSearchStringToSQL=t.getErrorMessage=t.getClientType=t.loadRequiredLevelFromCrmSoap=t.behaviorToCrmSoap=t.loadBehaviorFromCrmSoap=t.throwOnNullOrUndefinedArgument=t.mapToValues=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var i=r("i2et"),o=r("uCvz"),s=r("w8X2"),u=r("+1in"),l=r("bOB9");Object.defineProperty(t,"COMPOSITE_INDEX_DELIMITER",{enumerable:!0,get:function(){return l.COMPOSITE_INDEX_DELIMITER}});var c=r("ZRE3"),d=r("Ct6E");function p(e){return null==e}function f(e){return p(e)||y(e)||0===Object.keys(e).length}function y(e){return!!p(e)||typeof e===i.AttributeType.String&&""===e.trim()}function h(e){return!f(e)&&void 0!==e.get_Message}t.mapToValues=function(e,t){return e?Object.keys(e).reduce((function(r,a){return r[a]=t(e[a]),r}),{}):{}},t.throwOnNullOrUndefinedArgument=function(e,t){if(p(e))throw Error("Argument = ${argumentName} can't be null or undefined")},t.loadBehaviorFromCrmSoap=function(e){switch(e){case"None":return o.DateTimeFieldBehavior.None;case"UserLocal":return o.DateTimeFieldBehavior.UserLocal;case"DateOnly":return o.DateTimeFieldBehavior.DateOnly;case"TimeZoneIndependent":return o.DateTimeFieldBehavior.TimeZoneIndependent;default:return o.DateTimeFieldBehavior.UserLocal}},t.behaviorToCrmSoap=function(e){switch(e){case o.DateTimeFieldBehavior.None:return"None";case o.DateTimeFieldBehavior.UserLocal:return"UserLocal";case o.DateTimeFieldBehavior.DateOnly:return"DateOnly";case o.DateTimeFieldBehavior.TimeZoneIndependent:return"TimeZoneIndependent";default:return"UserLocal"}},t.loadRequiredLevelFromCrmSoap=function(e){switch(e){case"None":return s.RequiredLevel.none;case"ApplicationRequired":return s.RequiredLevel.applicationRequired;case"Recommended":return s.RequiredLevel.recommended;case"SystemRequired":return s.RequiredLevel.systemRequired;default:return s.RequiredLevel.unknown}},t.encodeURIComponentForOData=function(e){return e},t.buildBatchRequest=function(e){return e[0]},t.parseBatchResponse=function(e){return a(this,void 0,void 0,(function(){return n(this,(function(t){return[2,[e]]}))}))},t.getHttpHeader=function(e,t){if(!e)return null;var r=e.get(t);return r||(r=e.get(t.toLowerCase())),r},t.isNullOrUndefined=p,t.isNullOrUndefinedOrEmpty=f,t.isNullOrUndefinedOrEmptyString=y,t.getViewLocalStoreId=function(e){return d.MetadataType.savedView+l.COMPOSITE_INDEX_DELIMITER+e},t.buildODataResponseFromError=function(e,t,r){var a=r||0,n=e?e.message:"Unknown Error",i=e?e.stack:void 0,o=e?e.name:void 0;return u.buildErrorResponse(a,t,new c.LocalError(n,void 0,i,o))},t.isUserContextMetadataRequest=function(e){return!(p(e)||!p(e.MetadataType)||p(e.DependencyDepth)||"usercontext"!==e.DependencyDepth.toLowerCase())},t.getClientType=function(e,t,r){void 0===r&&(r=[]);var a=l.CLIENT_TYPE.remote;return e&&e.additionalHeaders?e.additionalHeaders.clientType&&[l.CLIENT_TYPE.local,l.CLIENT_TYPE.remote].includes(e.additionalHeaders.clientType)?a=e.additionalHeaders.clientType:e.additionalHeaders[l.HINT.executionStrategy]&&[l.EXECUTION_HINTS.OFFLINE,l.EXECUTION_HINTS.ONLINE].includes(e.additionalHeaders[l.HINT.executionStrategy])?a=e.additionalHeaders[l.HINT.executionStrategy]===l.EXECUTION_HINTS.OFFLINE?l.CLIENT_TYPE.local:l.CLIENT_TYPE.remote:t&&t.warn("[Utils.getClientType] Unsupported execution strategy, default to remote client",r):t&&t.warn("[Utils.getClientType] No execution strategy provided, default to remote client",r),a},t.convertErrorToLocalError=function(e){var t=l.UNKNOWN,r=l.ErrorCode.UnknownUnexpectedGenericError,a=l.UNKNOWN;return p(e)||(h(e)?(t=y(e._message)?t:e._message,r=y(e._errorCode)?r:e._errorCode,a=y(e._stack)?a:e._stack):(t=y(e.message)?t:e.message,a=y(e.stack)?a:e.stack)),new c.LocalError(t,r,a)},t.getErrorMessage=function(e){return h(e)?e._message?e._message:null:e?e.message?e.message:e:null},t.convertSearchStringToSQL=function(e){for(var t=[],r=0;r<e.length;r++)switch(e.charAt(r)){case"[":t.push("[[]");break;case"_":t.push("[_]");break;case"%":t.push("[%]");break;case"*":t.push("%");break;default:t.push(e.charAt(r))}return e.length&&e.endsWith("*")||t.push("%"),t.join("")},t.handleEscapeCharacters=function(e){return e.replace("'","''")},t.trimWildCards=function(e){var t=e;return t?("*"===t[0]&&(t=t.substring(1)),"*"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t):t}},r9V9:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.extractSqlErrorMessage=t.addExecutionTimeDetails=t.canLogDetailsOfRequest=t.addResponseErrorInformationToEventParameters=t.addErrorInformationToEventParameters=t.addResponseDetailsToEventParameters=t.addRequestDetailsToEventParameters=t.addEventParameters=void 0;var o=r("H+3G"),s=r("bOB9"),u=r("Y0ua"),l=r("pqvw");function c(e,t){var r=e.status||u.EVENT_PARAMETERS.EMPTY_STRING,a=e.statusText||u.EVENT_PARAMETERS.EMPTY_STRING;if(!l.isNullOrUndefined(e.headers)){var n=e.headers,i=l.getHttpHeader(n,s.HEADER.SERVER_REQUEST_ID)||u.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:u.EVENT_PARAMETERS.SERVER_REQUEST_ID,value:i});var o=l.getHttpHeader(n,s.HEADER.CONTENT_LENGTH)||u.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:u.EVENT_PARAMETERS.RESPONSE_SIZE_IN_BYTES,value:o})}t.push({name:u.EVENT_PARAMETERS.HTTP_STATUS_CODE,value:r}),t.push({name:u.EVENT_PARAMETERS.HTTP_RESPONSE_STATUS_TEXT,value:a})}function d(e,t,r){void 0===r&&(r=!1),l.isNullOrUndefined(e)||(t.push({name:u.EVENT_PARAMETERS.ERROR_CODE,value:e[s.STRING_CONSTANTS.ErrorCode]||u.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:u.EVENT_PARAMETERS.ERROR_STACK,value:e[s.STRING_CONSTANTS.StackTrace]||u.EVENT_PARAMETERS.EMPTY_STRING}),t.push({name:u.EVENT_PARAMETERS.ERROR_MESSAGE,value:e[s.STRING_CONSTANTS.Message]||u.EVENT_PARAMETERS.EMPTY_STRING}),r&&t.push({name:u.EVENT_PARAMETERS.ERROR_COMPLETE_TEXT,value:JSON.stringify(e)}))}function p(e){return!l.isNullOrUndefinedOrEmptyString(e)&&(-1!==e.indexOf("GetClientMetadata")||-1!==e.indexOf("EntityDefinitions")||-1!==e.indexOf("SyncClientMetadata"))}t.addEventParameters=function(e,t){return void 0===t&&(t=[]),t.concat(e)},t.addRequestDetailsToEventParameters=function(e,t,r){var a=e&&e.additionalHeaders?e.additionalHeaders[s.HEADER.CLIENT_REQUEST_ID]:u.EVENT_PARAMETERS.EMPTY_STRING;t.push({name:u.EVENT_PARAMETERS.CLIENT_REQUEST_ID,value:a}),t.push({name:u.EVENT_PARAMETERS.END_POINT,value:e.endpoint||s.UNKNOWN}),t.push({name:u.EVENT_PARAMETERS.METHOD,value:e.method||s.UNKNOWN});var n=l.getClientType(e);t.push({name:u.EVENT_PARAMETERS.CLIENT_TYPE,value:n}),r=r||o.getRequestType(e),t.push({name:u.EVENT_PARAMETERS.OPERATION_TYPE,value:""+r})},t.addResponseDetailsToEventParameters=c,t.addErrorInformationToEventParameters=d,t.addResponseErrorInformationToEventParameters=function(e,t){return a(this,void 0,void 0,(function(){var r,a,i,o;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.text()];case 1:return r=n.sent(),a=JSON.parse(r),i=a.error||{},o=p(e.url),d(i,t,o),c(e,t),[2,t];case 2:return n.sent(),[2,t];case 3:return[2]}}))}))},t.canLogDetailsOfRequest=p,t.addExecutionTimeDetails=function(e,t,r){for(var a in t){var n=e.getPerformanceEntry(t[a]);n&&n.performanceMeasure&&n.performanceStatistic&&(1===n.performanceStatistic.count?(r.push({name:t[a]+"-startTime",value:n.performanceMeasure.startTime||0}),r.push({name:t[a]+"-endTime",value:n.performanceMeasure.endTime||0})):n.performanceStatistic.count>1&&(r.push({name:t[a]+"-totalDuration",value:n.performanceStatistic.totalDuration||0}),r.push({name:t[a]+"-averageDuration",value:n.performanceStatistic.averageDuration||0}),r.push({name:t[a]+"-executionCount",value:n.performanceStatistic.count||0})))}},t.extractSqlErrorMessage=function(e){var t,r,a="";try{if(!l.isNullOrUndefinedOrEmptyString(e)){var n=JSON.parse(e);if(!l.isNullOrUndefinedOrEmpty(n.results))try{for(var o=i(n.results),s=o.next();!s.done;s=o.next()){var u=s.value;u.result&&(Array.isArray(u.result)&&u.result.length>0&&!l.isNullOrUndefinedOrEmptyString(u.result[0].message)?a=a+u.result[0].message+";\n":l.isNullOrUndefinedOrEmptyString(u.result.message)||(a=a+u.result.message+";\n"))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}}}catch(t){a=e}return a}},rLPd:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteODataClientManager=void 0;var a=r("Co9g"),n=r("Euvu"),i=r("5whO"),o=function(){function e(e,t){this._applicationContext=t,this._HttpODataClient=new a.ODataClient(e,this._applicationContext).addInterceptor(new i.LongRequestInterceptor(this._applicationContext)).setExecuteRequestInterceptor(new n.HttpExecuteInterceptor(this._applicationContext)).build()}return e.prototype.getRemoteODataClient=function(e){return this._HttpODataClient},e}();t.RemoteODataClientManager=o},rMjw:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeType=t.EntityKeyIndexStatus=t.PrivilegeType=t.CascadeType=t.OwnershipTypes=t.AssociatedMenuGroup=t.AssociatedMenuBehavior=t.RelationshipType=t.SecurityTypes=t.AttributeRequiredLevel=t.AttributeTypeCode=t.StringFormat=t.ImeMode=t.DateTimeFormat=t.OptionSetType=void 0,function(e){e[e.Picklist=0]="Picklist",e[e.State=1]="State",e[e.Status=2]="Status",e[e.Boolean=3]="Boolean"}(t.OptionSetType||(t.OptionSetType={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateAndTime=1]="DateAndTime"}(t.DateTimeFormat||(t.DateTimeFormat={})),function(e){e[e.Auto=0]="Auto",e[e.Inactive=1]="Inactive",e[e.Active=2]="Active",e[e.Disabled=3]="Disabled"}(t.ImeMode||(t.ImeMode={})),function(e){e[e.Email=0]="Email",e[e.Text=1]="Text",e[e.TextArea=2]="TextArea",e[e.Url=3]="Url",e[e.TickerSymbol=4]="TickerSymbol",e[e.PhoneticGuide=5]="PhoneticGuide",e[e.VersionNumber=6]="VersionNumber",e[e.Phone=7]="Phone"}(t.StringFormat||(t.StringFormat={})),function(e){e[e.Boolean=0]="Boolean",e[e.Customer=1]="Customer",e[e.DateTime=2]="DateTime",e[e.Decimal=3]="Decimal",e[e.Double=4]="Double",e[e.Integer=5]="Integer",e[e.Lookup=6]="Lookup",e[e.Memo=7]="Memo",e[e.Money=8]="Money",e[e.Owner=9]="Owner",e[e.PartyList=10]="PartyList",e[e.Picklist=11]="Picklist",e[e.State=12]="State",e[e.Status=13]="Status",e[e.String=14]="String",e[e.Uniqueidentifier=15]="Uniqueidentifier",e[e.CalendarRules=16]="CalendarRules",e[e.Virtual=17]="Virtual",e[e.BigInt=18]="BigInt",e[e.ManagedProperty=19]="ManagedProperty",e[e.EntityName=20]="EntityName",e[e.AliasedValue=21]="AliasedValue",e[e.ArrayOfString=22]="ArrayOfString",e[e.EntityImage=23]="EntityImage",e[e.MultiSelectPicklist=24]="MultiSelectPicklist",e[e.File=25]="File",e[e.NavigationProperty=26]="NavigationProperty"}(t.AttributeTypeCode||(t.AttributeTypeCode={})),function(e){e[e.None=0]="None",e[e.SystemRequired=1]="SystemRequired",e[e.ApplicationRequired=2]="ApplicationRequired",e[e.Recommended=3]="Recommended",e[e.Unknown=-1]="Unknown"}(t.AttributeRequiredLevel||(t.AttributeRequiredLevel={})),function(e){e[e.None=0]="None",e[e.Append=1]="Append",e[e.ParentChild=2]="ParentChild",e[e.Pointer=4]="Pointer",e[e.Inheritance=8]="Inheritance"}(t.SecurityTypes||(t.SecurityTypes={})),function(e){e[e.OneToManyRelationship=0]="OneToManyRelationship",e[e.ManyToManyRelationship=1]="ManyToManyRelationship",e[e.ManyToOneRelationship=2]="ManyToOneRelationship",e[e.None=-1]="None"}(t.RelationshipType||(t.RelationshipType={})),function(e){e[e.UseCollectionName=0]="UseCollectionName",e[e.UseLabel=1]="UseLabel",e[e.DoNotDisplay=2]="DoNotDisplay"}(t.AssociatedMenuBehavior||(t.AssociatedMenuBehavior={})),function(e){e[e.Details=0]="Details",e[e.Sales=1]="Sales",e[e.Service=2]="Service",e[e.Marketing=3]="Marketing"}(t.AssociatedMenuGroup||(t.AssociatedMenuGroup={})),function(e){e[e.None=0]="None",e[e.UserOwned=1]="UserOwned",e[e.TeamOwned=2]="TeamOwned",e[e.BusinessOwned=4]="BusinessOwned",e[e.OrganizationOwned=8]="OrganizationOwned",e[e.BusinessParented=16]="BusinessParented"}(t.OwnershipTypes||(t.OwnershipTypes={})),function(e){e[e.NoCascade=0]="NoCascade",e[e.Cascade=1]="Cascade",e[e.Active=2]="Active",e[e.UserOwned=3]="UserOwned",e[e.RemoveLink=4]="RemoveLink",e[e.Restrict=5]="Restrict"}(t.CascadeType||(t.CascadeType={})),function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Read=2]="Read",e[e.Write=3]="Write",e[e.Delete=4]="Delete",e[e.Assign=5]="Assign",e[e.Share=6]="Share",e[e.Append=7]="Append",e[e.AppendTo=8]="AppendTo"}(t.PrivilegeType||(t.PrivilegeType={})),function(e){e[e.Pending=0]="Pending",e[e.InProgress=1]="InProgress",e[e.Active=2]="Active",e[e.Failed=3]="Failed"}(t.EntityKeyIndexStatus||(t.EntityKeyIndexStatus={})),function(e){e.Boolean="boolean",e.Unknown="unknown",e.Customer="customer",e.Date="date",e.DateTime="datetime",e.Decimal="decimal",e.Double="double",e.Image="image",e.Integer="integer",e.Lookup="lookup",e.ManagedProperty="managedproperty",e.Memo="memo",e.Money="money",e.OptionSet="optionset",e.Owner="owner",e.PartyList="partylist",e.PickList="picklist",e.State="state",e.Status="status",e.String="string",e.UniqueIdentifier="uniqueidentifier",e.CalendarRules="calendarrules",e.Virtual="virtual",e.BigInt="bigint",e.EntityName="entityname",e.EntityImage="entityimage",e.AliasedValue="aliasedvalue",e.Regarding="regarding",e.MultiSelectPickList="multiselectpicklist",e.File="file",e.NavigationProperty="navigationproperty"}(t.AttributeType||(t.AttributeType={}))},rPIE:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.LocalODataClientManager=void 0;var a=r("bOB9"),n=r("Y0ua"),i=r("H+3G"),o=r("hO/k"),s=r("PY9Y"),u=function(){function e(e,t){this._applicationContext=t,this._sqlLocalODataClient=new s.SQLLocalODataClient(e,t),this._fileLocalODataClient=new o.FileLocalODataClient(e,t)}return e.prototype.getLocalODataClient=function(e,t){void 0===t&&(t=[]);var r,o=this._applicationContext.TraceManager.getTracer(n.COMPONENT_NAMES.ODataExecutor);if(r=i.getRequestType(e,this._applicationContext),o.info(l()+" URL Parser Handler returns "+r+" request type"),a.SQLQuerySupportedList.indexOf(r)>-1)return o.info(l()+" Local OData Client Manager called SQL Local Client"),this._sqlLocalODataClient;if(a.FileQuerySupportedList.indexOf(r)>-1)return o.info(l()+" Local OData Client Manager called File Local Client"),this._fileLocalODataClient;var s="No LocalODataClient type matched with request";throw o.error(l()+" "+s,t),new Error(s)},e}();function l(e){return e?"["+e+"]":"["+n.FILE_PREFIX.LocalODataClientManager+"]"}t.LocalODataClientManager=u},stS6:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalStoreId=void 0;var a=r("pqvw"),n=r("Ct6E"),i=r("jD1M");t.createLocalStoreId=function(e,t,r,o,s,u){var l="";e=a.isNullOrUndefined(e)?"":e,r=a.isNullOrUndefined(r)?"":r,o=a.isNullOrUndefined(o)?"":o,u=a.isNullOrUndefined(u)?"":u;var c=a.isNullOrUndefined(s)?"":s.toString();switch(t){case n.MetadataType.overallMetadataVersion:l=""+i.APPLICATION_METADATA_VERSION_STAMP_KEY;break;case n.MetadataType.quickCreateMenu:l=t+"_quickcreatemenu_"+u;break;case n.MetadataType.searchConfiguration:l=t+"_searchconfiguration";break;case n.MetadataType.taskBasedFlowGlobalMenu:l=t+"_taskbasedflowglobalmenu";break;case n.MetadataType.siteMap:l=t+"_sitemap_"+u;break;case n.MetadataType.appModule:l=t+"_appmodules_"+u;break;case n.MetadataType.appModuleOfflineMetadata:l=t+"_appmoduleofflinemetadata";break;case n.MetadataType.taskBasedFlow:case n.MetadataType.customControl:case n.MetadataType.resourceString:case n.MetadataType.complexControl:l=t+"_"+o;break;case n.MetadataType.dialog:l=t+"_"+o.toLowerCase();break;case n.MetadataType.label:l=t+"_"+r+"_"+o;break;case n.MetadataType.homePageConfiguration:l=t+"_"+e;break;case n.MetadataType.optionSet:l=t+"_"+(a.isNullOrUndefinedOrEmptyString(r)?o:r);break;case n.MetadataType.appModuleSelector:l=t+"_"+c;break;case n.MetadataType.viewSelector:case n.MetadataType.formSelector:case n.MetadataType.dashboardSelector:case n.MetadataType.visualizationSelector:l=t+"_"+e+"_"+c+"_"+u;break;case n.MetadataType.bpfSelector:l=t+"_"+e+"_"+u;break;case n.MetadataType.command:l=t+"_"+o+"_"+e;break;case n.MetadataType.isActivityFlags:case n.MetadataType.webResource:case n.MetadataType.webResourceDescriptor:l=t+"_"+o;break;case n.MetadataType.businessProcessFlow:case n.MetadataType.form:case n.MetadataType.savedQueryVisualization:case n.MetadataType.displayString:default:l=t+"_"+r}return l}},uCvz:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DateTimeFieldBehavior=void 0,function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(t.DateTimeFieldBehavior||(t.DateTimeFieldBehavior={}))},uIhV:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function a(e,t){if(!t||0===t.length)return e;var r=e;return t.forEach((function(e){var t=new RegExp("\\"+e,"g");r=r.replace(t,"\\"+e)})),r}Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryTokenRegex=t.regexEscapeQueryTokens=void 0,t.regexEscapeQueryTokens=a,t.getQueryTokenRegex=function(e,t){var r=a(e,["/","*"])+"([\\S\\s]*)"+a(t,["/","*"]);return new RegExp(r,"i")}},uit8:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.generateMetadataQueries=t.appendDependenciesAsCandidates=t.extractClientMetadataQuery=t.generateGCMRequests=void 0;var o=r("r9V9"),s=r("pqvw"),u=r("Ct6E"),l=r("Y0ua"),c=r("88gK"),d=r("jD1M"),p=r("VDnG"),f=r("1txY"),y=r("stS6");function h(e,t,r){void 0===r&&(r=[]);var a=[],n=e.url.match(/@ClientMetadataQuery=(.*\})/i);if(a.push({name:"url",value:e.url}),s.isNullOrUndefined(n)){var i="URL does not have a ClientMetadataQuery param";throw t.error(E()+" "+i,o.addEventParameters(r,a)),new Error(i)}return JSON.parse(decodeURIComponent(n[1]))}function m(e,t,r,o,l){return void 0===l&&(l={}),a(this,void 0,void 0,(function(){var a,c,d,f,h,m,b,v,g,T,_,S,O,N,M,P,w;return n(this,(function(n){switch(n.label){case 0:return a=Object.keys(t).filter((function(e){return!t[e].dependenciesFetched})),c=a.map((function(e){return y.createLocalStoreId(r,u.MetadataType.dependencies,t[e].sourceId,"")})),[4,p.retrieveMultipleApplicationMetadata(e,c,void 0,l)];case 1:(d=n.sent()).length<c.length&&(f=d.map((function(e){return e.id})),h=c.filter((function(e){return-1===f.indexOf(e)})),o.info(E()+" Some requested nodes do not have dependency records "+h));try{for(m=i(a),b=m.next();!b.done;b=m.next())v=b.value,t[v].dependenciesFetched=!0}catch(e){N={error:e}}finally{try{b&&!b.done&&(M=m.return)&&M.call(m)}finally{if(N)throw N.error}}for(g in d)if(!s.isNullOrUndefinedOrEmpty(d[g])&&!s.isNullOrUndefinedOrEmpty(d[g].data)){T=d[g];try{for(P=void 0,_=i(T.data.children),S=_.next();!S.done;S=_.next())O=S.value,t.hasOwnProperty(O)||(t[O]={dependenciesFetched:!1,queryGenerated:!1,sourceId:O,metadataType:u.MetadataType.none})}catch(e){P={error:e}}finally{try{S&&!S.done&&(w=_.return)&&w.call(_)}finally{if(P)throw P.error}}}return[2]}}))}))}function b(e,t,r,a){void 0===r&&(r=[]);var n={sqlStatements:[],sqlParameters:[]},i=[];for(var o in e)if(!s.isNullOrUndefined(e[o])){var u=e[o];a?g(u,n,t,r):v(u,n,i,t,r)}return t.info(E()+" Returning "+n.sqlStatements.length+" queries"),s.isNullOrUndefined(n.additionalParameters)&&(n.additionalParameters={}),n.additionalParameters[d.MetadataFields.METADATA_TYPE]=i,n}function v(e,t,r,a,n){void 0===n&&(n=[]),e.metadataType===u.MetadataType.userContext?(r.push(e.metadataType),t.sqlStatements.push("SELECT "+d.MetadataFields.JSON+" FROM "+d.USER_CONTEXT_STORE+" WHERE "+c.id+" = ?"),t.sqlParameters.push([e.id?e.id:d.USER_CONTEXT_KEY])):e.metadataType===u.MetadataType.entity?s.isNullOrUndefinedOrEmptyString(e.id)?a.warn(E()+" No ID found for candidate of type entity metadata. Skipping query generation",n):(r.push(e.metadataType),t.sqlStatements.push("SELECT "+c.id+", "+d.MetadataFields.JSON+" FROM ["+d.ENTITY_METADATA_STORE+"] WHERE ["+c.logicalName+"] = ?"),t.sqlParameters.push([e.id])):s.isNullOrUndefinedOrEmptyString(e.id)?a.warn(E()+" Invalid candidate - no ID found for candidate "+e.metadataType+". Skipping query generation",n):(r.push(e.metadataType),t.sqlStatements.push("SELECT "+d.MetadataFields.METADATA_TYPE+", "+d.MetadataFields.JSON+" FROM "+d.APPLICATION_METADATA_STORE+" WHERE "+c.id+" = ?"),t.sqlParameters.push([e.id]))}function g(e,t,r,a){void 0===a&&(a=[]),e.metadataType===u.MetadataType.userContext?(t.sqlStatements.push("SELECT "+d.MetadataFields.JSON+" FROM "+d.USER_CONTEXT_STORE+" WHERE "+c.id+" = ?"),t.sqlParameters.push([e.id?e.id:d.USER_CONTEXT_KEY])):s.isNullOrUndefinedOrEmptyString(e.sourceId)?s.isNullOrUndefinedOrEmptyString(e.id)?r.error(E()+" Invalid candidate - no ID or source ID for candidate "+e.metadataType+". Skipping query generation",a):(t.sqlStatements.push("SELECT "+d.MetadataFields.METADATA_TYPE+", "+d.MetadataFields.JSON+" FROM "+d.APPLICATION_METADATA_DEPENDENCY_VIEW+" WHERE "+c.id+" = ? AND "+d.MetadataFields.METADATA_TYPE+" <> ?"),t.sqlParameters.push([e.id,u.MetadataType.dependencies.toString()])):(t.sqlStatements.push("SELECT "+d.MetadataFields.METADATA_TYPE+", "+d.MetadataFields.JSON+" FROM "+d.APPLICATION_METADATA_DEPENDENCY_VIEW+" WHERE "+c.id+" = ? AND "+d.MetadataFields.METADATA_TYPE+" <> ?"),t.sqlParameters.push([e.sourceId,u.MetadataType.dependencies.toString()]))}function E(e){return e?"["+e+"]":"["+l.FILE_PREFIX.GCMGenerator+"]"}t.generateGCMRequests=function(e,t,r,i){return void 0===i&&(i={}),a(this,void 0,void 0,(function(){var a,o,l,c;return n(this,(function(n){switch(n.label){case 0:return a=i.commonEventParameters||[],o=h(e,r,a),[4,f.findRootNodes(t,r,o,a)];case 1:if(l=n.sent(),r.info(E()+" found root nodes "+Object.keys(l)+" for "+o.MetadataType),!(c=t.AdditionalParameters&&t.AdditionalParameters.EnableDependency)||-1===[u.QueriedMetadataType.form.toString(),u.QueriedMetadataType.entity.toString()].indexOf(o.MetadataType))return[3,4];n.label=2;case 2:return function(e){return Object.keys(e).some((function(t){return!e[t].dependenciesFetched}))}(l)?[4,m(t,l,o.EntityLogicalName,r,i)]:[3,4];case 3:return n.sent(),[3,2];case 4:return s.isNullOrUndefinedOrEmpty(l)?[3,6]:[4,b(l,r,a,c)];case 5:return[2,n.sent()];case 6:return[2,{sqlStatements:[],sqlParameters:[]}]}}))}))},t.extractClientMetadataQuery=h,t.appendDependenciesAsCandidates=m,t.generateMetadataQueries=b},w8X2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequiredLevel=void 0,function(e){e[e.unknown=-1]="unknown",e[e.none=0]="none",e[e.systemRequired=1]="systemRequired",e[e.applicationRequired=2]="applicationRequired",e[e.recommended=3]="recommended"}(t.RequiredLevel||(t.RequiredLevel={}))},wNBc:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateFullName=void 0;
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
var a=r("kwGv");t.generateFullName=function(e,t,r,n){t=t?t.trim():"",r=r?r.trim():"",n=n?n.trim():"";var i="";r.length>0&&(i=r.substring(0,1));var o="";switch(e){case 0:o=n.length>0&&t.length>0?n+", "+t:n+" "+t;break;case a.FullNameConventionCode.firstLast:o=t+" "+n;break;case a.FullNameConventionCode.lastFirstMiddleInitial:o=function(e,t,r){var a="";t.length>0&&(a=t);t.length>0&&(e.length>0||r.length>0)&&(a+=",");e.length>0&&(a=a+" "+e);r.length>0&&(a=a+" "+r+".");return a.toString().trim()}(t,n,i);break;case a.FullNameConventionCode.firstMiddleInitialLast:o=t,r.length>0&&(o=o+" "+i+"."),o=o+" "+n;break;case a.FullNameConventionCode.lastFirstMiddle:n.length>0&&(o=n),n.length>0&&(t.length>0||r.length>0)&&(o+=","),t.length>0&&(o=o+" "+t),r.length>0&&(o=o+" "+r);break;case a.FullNameConventionCode.firstMiddleLast:o=t,r.length>0&&(o=o+" "+r),o=o+" "+n;break;case a.FullNameConventionCode.lastSpaceFirst:o=n+" "+t;break;case a.FullNameConventionCode.lastNoSpaceFirst:o=n+t;break;default:o=n}return o.toString().trim()}},wr4e:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.sort=void 0;var o=r("r9V9"),s=r("pqvw"),u=r("Y0ua"),l=r("Ag5+"),c=r("kwGv");function d(e,t,r,s,u){return void 0===u&&(u=[]),a(this,void 0,void 0,(function(){var a,d,f,y,h,m,b,v,g,E,T,_,S,O,N;return n(this,(function(n){switch(n.label){case 0:a="",d="",f="",n.label=1;case 1:n.trys.push([1,8,9,10]),y=i(t),h=y.next(),n.label=2;case 2:return h.done?[3,7]:(m=h.value,(b=[]).push({name:"ColumnSortPair",value:m}),a.length>0&&(a+=c.Punctuation.comma+c.Punctuation.space+c.Punctuation.doubleQuote),v=m.trim().split(c.Punctuation.space),g=r+"0",2!==v.length?[3,4]:(d=v[0],2===(E=d.split(c.Punctuation.dot)).length&&(g=E[0],d=E[1]),[4,l.isSpecialAttribute(e,r,d,s,u)]));case 3:return T=n.sent(),d=T?c.Punctuation.openSQBracket+d+c.Punctuation.exclamation+"name"+c.Punctuation.closeSQBracket:d,f=v[1].toUpperCase(),[3,5];case 4:throw _="OrderBy hint contain invalid format",s.error(p+" "+_,o.addEventParameters(u,b)),new Error(_);case 5:a+=g+c.Punctuation.doubleQuote+c.Punctuation.dot+d+c.Punctuation.space+f,n.label=6;case 6:return h=y.next(),[3,2];case 7:return[3,10];case 8:return S=n.sent(),O={error:S},[3,10];case 9:try{h&&!h.done&&(N=y.return)&&N.call(y)}finally{if(O)throw O.error}return[7];case 10:return[2,a]}}))}))}function p(e){return e?"["+e+"]":"["+u.FILE_PREFIX.ApplyOrderBySQLGenerator+"]"}t.sort=function(e,t,r,i,u,l){return void 0===l&&(l=[]),a(this,void 0,void 0,(function(){var a,f,y,h,m,b;return n(this,(function(n){switch(n.label){case 0:if((a=[]).push({name:"SQLStatement",value:t}),a.push({name:"columnNames",value:r?r.toString():""}),s.isNullOrUndefinedOrEmptyString(t)||!r||0===r.length)throw u.error(p()+" "+c.ERROR_STRING.invalidParameter,o.addEventParameters(l,a)),new Error(c.ERROR_STRING.invalidParameter);if(f=t.lastIndexOf(c.OFFLINE_SQL_TOKEN.ORDERBY_START),y=t.lastIndexOf(c.OFFLINE_SQL_TOKEN.ORDERBY_END),-1===f&&-1===y)throw h="Cannot find SORT SQL Token - Execute SQL Query Processing Sort Without Tokens",u.error(p()+" "+h,o.addEventParameters(l,a)),new Error(h);return m=t.substr(0,f),[4,d(e,r,i,u,l)];case 1:return b=n.sent(),t=m+c.OFFLINE_SQL_TOKEN.ORDERBY_START+c.CLAUSE.orderBy+c.Punctuation.space+c.Punctuation.doubleQuote+b+c.OFFLINE_SQL_TOKEN.ORDERBY_END,u.info(p()+" SQL Query with Modified SORT Clause:\n "+t),[2,t]}}))}))}},xeDM:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyRetryInterceptor=void 0;var s=r("pqvw"),u=r("Y0ua"),l=function(e){function t(t,r,a){var n=e.call(this,a)||this;return n._retryCount=r,n._policyManager=t,n}return n(t,e),t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,this.executeWithPolicy(e)];case 1:return[2,t.sent()]}}))}))},t.prototype.executeWithPolicy=function(e){return i(this,void 0,void 0,(function(){var t,r,a,n,i,u,l,c,d,p;return o(this,(function(o){switch(o.label){case 0:t=e,r=0,a=0,o.label=1;case 1:return[4,this.timeout(a)];case 2:o.sent(),n=t.request,o.label=3;case 3:return o.trys.push([3,12,,13]),[4,t.proceed()];case 4:return i=o.sent(),r<this._retryCount?null==(u=this._policyManager.getRetryPolicy(i))?[3,8]:u.action?[4,u.action(n)]:[3,6]:[3,10];case 5:return c=o.sent(),[3,7];case 6:c=n,o.label=7;case 7:return l=c,t=e.clone(l),r++,this.tracer.info(this.getPolicyRetryInterceptorPrefix()+" Retry with count "+r),a=u.delay||0,[3,9];case 8:return[2,i];case 9:return[3,11];case 10:return[2,i];case 11:return[3,13];case 12:return d=o.sent(),p="Retry with count "+r+" failed",d.message=d&&d.message?d.message+"."+p:p,this.tracer.info(this.getPolicyRetryInterceptorPrefix()+" "+p),[2,s.buildODataResponseFromError(d,n.url)];case 13:return[3,1];case 14:return[2]}}))}))},t.prototype.getPolicyRetryInterceptorPrefix=function(e){return e?"["+e+"]":"["+u.FILE_PREFIX.PolicyRetryInterceptor+"]"},t.prototype.timeout=function(e){return i(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){t()}),e)}))]}))}))},t}(r("lHlh").Interceptor);t.PolicyRetryInterceptor=l},zydU:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var a,n=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,i){function o(e){try{u(a.next(e))}catch(e){i(e)}}function s(e){try{u(a.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,a,n,i,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,a&&(n=2&i[0]?a.return:i[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){o.label=i[1];break}if(6===i[0]&&o.label<n[1]){o.label=n[1],n=i;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(i);break}n[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.shouldCacheMetadataRows=t.SQLRequestInterceptor=void 0;var s=r("bOB9"),u=r("r9V9"),l=r("pqvw"),c=r("ZRE3"),d=r("Ct6E"),p=r("Y0ua"),f=r("H+3G"),y=r("uit8"),h=r("lHlh"),m=r("knOV"),b=r("TtpI"),v=r("N6bD"),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.intercept=function(e){return i(this,void 0,void 0,(function(){var t,r,a,n,i,h,g,_,S,O,N,M,P,w,C,I;return o(this,(function(o){switch(o.label){case 0:t=e.executionContext||{},r=e.request,a=t.requestType||f.getRequestType(r,this.applicationContext),n=this.applicationContext.TraceManager.getTracer(p.COMPONENT_NAMES.LocalODataExecutor),_="Query Generator",S="",O=null,N=t.commonEventParameters||[],M=[],a===s.OPERATION.GetClientMetadata&&(w=y.extractClientMetadataQuery(r,n,N),P=w.MetadataType,M.push({name:"MetadataType",value:P})),o.label=1;case 1:return o.trys.push([1,13,,15]),t.performanceControl&&t.performanceControl.startMarker(p.FILE_PREFIX.SQLGenerator),[4,m.ExecuteOfflineSqlGenerator(r,this.applicationContext,t)];case 2:return i=o.sent(),t.performanceControl&&t.performanceControl.endMarker(p.FILE_PREFIX.SQLGenerator),i&&i.sqlStatements&&i.sqlStatements.length>0?(_="SQL Executor",n.info(E()+" Query Generator Completed. SQL Executor is processing",u.addEventParameters(N,M)),O=i.additionalParameters,!function(e,t,r){if(l.isNullOrUndefinedOrEmptyString(r)||l.isNullOrUndefinedOrEmpty(e)||l.isNullOrUndefinedOrEmptyString(t))return!1;var a=d.QueriedMetadataType[r.toLowerCase()],n=[d.QueriedMetadataType.customControl,d.QueriedMetadataType.complexControl,d.QueriedMetadataType.formSelector,d.QueriedMetadataType.viewSelector,d.QueriedMetadataType.ribbon];return t===s.OPERATION.GetClientMetadata&&T(e)&&!l.isNullOrUndefined(e.AdditionalParameters)&&e.AdditionalParameters.response&&-1!==n.indexOf(a)}(this.applicationContext,a,P)||l.isNullOrUndefined(this.applicationContext.AdditionalParameters)?[3,3]:(h=this.applicationContext.AdditionalParameters.response,[3,5])):[3,10];case 3:return[4,v.ExecuteSQLBatch(i,this.applicationContext,a,t)];case 4:h=o.sent(),o.label=5;case 5:return h?(_="Response Handler",n.info(E()+" SQL Executor Completed.Response Handler is processing",M),[4,b.responseHandler(r,a,this.applicationContext,h,void 0,O,t)]):[3,7];case 6:return g=o.sent(),[3,9];case 7:return S="ExecuteSQLBatch returned empty sql response",n.warn(E()+" "+S,u.addEventParameters(N,M)),[4,b.responseHandler(r,a,this.applicationContext,void 0,void 0,void 0,t)];case 8:g=o.sent(),o.label=9;case 9:return[3,12];case 10:return n.warn(E()+" ExecuteOfflineSqlGenerator returned empty query, So will return empty response",u.addEventParameters(N,M)),[4,b.responseHandler(r,a,this.applicationContext,void 0,void 0,void 0,t)];case 11:g=o.sent(),o.label=12;case 12:return[3,15];case 13:return C=o.sent(),S=C.message?C.message:"Exception in SQLRequestInterceptor at operationStep - "+_,I=C.code,M.push({name:"OperationStep",value:_}),u.addErrorInformationToEventParameters(C,M),n.error(E()+" Exception in SQLRequestInterceptor",u.addEventParameters(N,M)),[4,b.responseHandler(r,a,this.applicationContext,void 0,new c.LocalError(S,I,C.stack,_),void 0,t)];case 14:return g=o.sent(),[3,15];case 15:return n.info(E()+" Exiting SQLRequestInterceptor and returning local OData response",u.addEventParameters(N,M)),[2,g]}}))}))},t}(h.Interceptor);function E(e){return e?"["+e+"]":"["+p.FILE_PREFIX.SQLRequestInterceptor+"]"}function T(e){return!l.isNullOrUndefined(e.AdditionalParameters)&&!0!==e.AdditionalParameters.EnableDependency}t.SQLRequestInterceptor=g,t.shouldCacheMetadataRows=T}}]),window.bundleExecutionMarkers["scripts/es5/27.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();