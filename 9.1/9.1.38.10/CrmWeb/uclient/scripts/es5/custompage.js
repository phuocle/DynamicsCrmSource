(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/custompage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[56,69],{C8PA:function(e,t,n){var i,o,r;o=[],void 0===(r="function"==typeof(i=function(){"use strict";var e,t,n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
return function(e){!function(e){var t=function(){function t(n,i){if(this.embeddingOptions=n,this.hostWindow=i,!n)throw new e.EmbeddingError("Options cannot be empty");if(this.embeddingOptions.hostName=this.embeddingOptions.hostName?this.ensureTrailingSlash(n.hostName):this._getHostName(),this.embeddingOptions.endpoint&&"INT"===this.embeddingOptions.endpoint?this.webplayerPathSegmentToUse=t.WebplayerCommonPathSegmentForInt:this.webplayerPathSegmentToUse=t.WebplayerCommonPathSegment,this.embeddingOptions.getAccessToken){if(!i)throw new e.EmbeddingError("Host window must be specified when using delegated token authentication");this._authHandler=this._accessTokenRequestHandler.bind(this),this.hostWindow.addEventListener("message",this._authHandler)}var o=n.hostName.match(/https:\/\/([a-z0-9\-\.]*[:0-9]*)/i);if(!o||o.length<2)throw new e.EmbeddingError("Host name is not of the correct format");var r="https://(?:([^s\\/]*).)?"+o[1];this.subDomainRegex=new RegExp(r,"i")}return t.prototype.dispose=function(){this._authHandler&&(this.hostWindow.removeEventListener("message",this._authHandler),this._authHandler=void 0)},t.prototype._accessTokenRequestHandler=function(t){if(this.validateMessageOrigin(t)){var n=t.data;if(n&&void 0!==n.api)switch(n.api){case e.RuntimeToSdkApi.GetAccessToken:var i=t.data,o={id:i.id,api:i.api,success:!1,accessToken:null,errorMessage:null,parentRequestId:""},r=function(e,n){void 0===n&&(n=""),o.success=!0,o.accessToken=e,o.parentRequestId=n,t.source&&t.source.postMessage(o,t.origin)},a=function(e,n){void 0===n&&(n=""),o.success=!1,o.errorMessage=e,o.parentRequestId=n,t.source&&t.source.postMessage(o,t.origin)};this.embeddingOptions.getAccessToken(i.audience,r,a,i.clientRequestId)}}},t.prototype.ensureTrailingSlash=function(e){return"/"!==e.charAt(e.length-1)?e+"/":e},t.prototype.validateMessageOrigin=function(e){var n=!1;return t.HostNameAllowList.forEach((function(t){e.origin===t&&(n=!0)})),n||!!this.subDomainRegex.exec(e.origin)},t.prototype._getHostName=function(){var t;switch(this.embeddingOptions.endpoint){case e.Endpoint.PROD:t="https://apps.powerapps.com/";break;case e.Endpoint.GCCMODERATE:t="https://apps.gov.powerapps.us/";break;case e.Endpoint.GCCHIGH:t="https://apps.high.powerapps.us/";break;case e.Endpoint.INT:t="https://apps.int.powerapps.com/";break;case e.Endpoint.TEST:t="https://apps.test.powerapps.com/";break;case e.Endpoint.DEV:t="https://apps.local.powerapps.com:44329/";break;default:t="https://apps.powerapps.com/"}return t},t.prototype.constructBaseUrl=function(e,n){void 0===n&&(n="");var i=this.embeddingOptions.hostName;return i+=e?t.BaseUrlSdkPathSegment:this.webplayerPathSegmentToUse+"/"+n,this.appendCoreEmbeddingParams(i)},t.prototype.appendCoreEmbeddingParams=function(e){var t=[];this.embeddingOptions.source&&t.push("source="+this.embeddingOptions.source),this.embeddingOptions.locale&&t.push("locale="+this.embeddingOptions.locale),this.embeddingOptions.externalCorrelationId&&t.push("correlationId="+encodeURIComponent(this.embeddingOptions.externalCorrelationId)),this.embeddingOptions.enableOnBehalfOf&&t.push("enableOnBehalfOf=true");var n=t.join("&");return n?-1!==e.indexOf("?")?e+"&"+n:e+"?"+n:e},t.WebplayerCommonPathSegment="webplayer",t.WebplayerCommonPathSegmentForInt="webplayer-int",t.HostNameAllowList=["https://apps.powerapps.com","https://apps.high.powerapps.us","https://apps.gov.powerapps.us","https://apps.preview.powerapps.com","https://apps.preprod.powerapps.com","https://apps.int.powerapps.com","https://apps.test.powerapps.com","https://apps.dev.powerapps.com","https://apps.local.powerapps.com:44329","https://apps.local.powerapps.com:44328"],t.BaseUrlSdkPathSegment="sdk/authoringmetadata",t}();e.CoreEmbedding=t}(e.Embedding||(e.Embedding={}))}(e||(e={})),function(e){!function(e){function t(e){return"object"==typeof e&&"number"==typeof e.api&&("string"==typeof e.id||void 0===e.id)}function n(e,t,n,i){var o=new XMLHttpRequest;return new Promise((function(r,a){o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?r(o):a({status:o.status,statusText:o.statusText}))},o.open(e,t,!0),n&&Object.keys(n).forEach((function(e){return o.setRequestHeader(e,n[e])})),"POST"===e&&i?(o.setRequestHeader("Content-Type","application/json"),o.send(i)):o.send()}))}!function(e){e.DEV="DEV",e.TEST="TEST",e.PROD="PROD",e.GCCMODERATE="GCCMODERATE",e.GCCHIGH="GCCHIGH",e.INT="INT"}(e.Endpoint||(e.Endpoint={})),function(e){e[e.GetAccessToken=0]="GetAccessToken"}(e.RuntimeToSdkApi||(e.RuntimeToSdkApi={})),e.isRuntimeToSdkRequest=t,e.sendXhr=n;var o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t}(Error);e.EmbeddingError=o,function(e){e.Table="Table",e.Record="Record"}(e.DataKind||(e.DataKind={})),function(e){e.String="s",e.Number="n",e.Boolean="b",e.Date="d",e.DateTime="D"}(e.DataType||(e.DataType={}))}(e.Embedding||(e.Embedding={}))}(e||(e={})),function(e){!function(e){!function(t){var n,i,o;function r(e,t){var r=e.logger,s=e.renderConsentPage;a(t)&&(n=e,i=t.data.appResourcePayload,o=!0,r.logOperationStart("WebPlayerRuntime.LoadingDisambiguationWithConsentService",t.data.initConsentServiceTimeStamp),s())}function a(e){return e&&e.data&&e.data.appResourcePayload&&"number"==typeof e.data.initConsentServiceTimeStamp}function s(e){o&&p(e)&&n.logger.logOperationEnd("WebPlayerRuntime.LoadingDisambiguationWithConsentService",e.data.consentDialogLoadedTimestamp)}function p(e){return e&&e.data&&"number"==typeof e.data.consentDialogLoadedTimestamp&&"AppPermissionDialog"===e.data.source}function c(){if(o){var t={api:e.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData,data:{appResources:i}};n.postMessageToConsentService(t),i=void 0}}t.initializeConsentService=r,t.onConsentServiceLoaded=s,t.sendPreloadDataToConsentService=c}(e.EmbeddingConsentFlowHelper||(e.EmbeddingConsentFlowHelper={}))}(e.Sdk||(e.Sdk={}))}(t||(t={})),function(e){!function(e){var t=function(){function e(e){this._metricsDictionary={},this._logCallback=e}return e.prototype.logOperationStart=function(e,t){this._metricsDictionary.hasOwnProperty(e)&&t||(this._metricsDictionary[e]={startTimeStamp:t,endTimeStamp:0})},e.prototype.logOperationEnd=function(e,t){if(this._metricsDictionary.hasOwnProperty(e)||!t){this._metricsDictionary[e].endTimeStamp=t;var n=this._metricsDictionary[e].endTimeStamp-this._metricsDictionary[e].startTimeStamp;this._logCallback({operationName:e,duration:n}),delete this._metricsDictionary[e]}},e}();e.EmbeddingLogger=t}(e.Sdk||(e.Sdk={}))}(t||(t={})),function(t){!function(t){function n(e){return"string"==typeof e.url}function i(t){return"string"==typeof t.requestParameters.url&&"string"==typeof t.requestParameters.method&&(!t.requestParameters.headers||"object"==typeof t.requestParameters.headers)&&(!t.requestParameters.retryable||"object"==typeof t.requestParameters.retryable)&&(!t.requestParameters.bodyData||"string"==typeof t.requestParameters.bodyData)&&e.Embedding.isRuntimeToSdkRequest(t)}function o(t){return"string"==typeof t.message&&""!==t.message&&null!==t.message&&(null===t.data||"object"==typeof t.data)&&e.Embedding.isRuntimeToSdkRequest(t)}!function(e){e[e.GetAccessToken=0]="GetAccessToken",e[e.AppLoaded=1]="AppLoaded",e[e.AppClosed=2]="AppClosed",e[e.AppFailed=3]="AppFailed",e[e.RequestHide=4]="RequestHide",e[e.EnableSave=5]="EnableSave",e[e.NewItem=6]="NewItem",e[e.EditItem=7]="EditItem",e[e.ViewItem=8]="ViewItem",e[e.SaveItem=9]="SaveItem",e[e.CancelEditItem=10]="CancelEditItem",e[e.SetProperty=20]="SetProperty",e[e.VisibilityChanged=21]="VisibilityChanged",e[e.ReadyToHandleMessages=22]="ReadyToHandleMessages",e[e.InteractionRequired=23]="InteractionRequired",e[e.SendTrigger=30]="SendTrigger",e[e.SendTriggerResponse=31]="SendTriggerResponse",e[e.SendTelemetryEvent=40]="SendTelemetryEvent",e[e.Log=41]="Log",e[e.DelegateLaunchUrl=42]="DelegateLaunchUrl",e[e.OpenConsentPage=43]="OpenConsentPage",e[e.CloseConsentPage=44]="CloseConsentPage",e[e.SetConsentResult=45]="SetConsentResult",e[e.OpenConnectorAuthPopup=46]="OpenConnectorAuthPopup",e[e.SetConnectorAuthResult=47]="SetConnectorAuthResult",e[e.GetPreloadConsentServiceData=48]="GetPreloadConsentServiceData"}(t.PowerAppsEmbeddingCallbackApi||(t.PowerAppsEmbeddingCallbackApi={})),t.isDelegateLaunchUrlEventCallBackParams=n,t.isAppToHostFunctionsEventCallBackParams=i,t.isAppToHostTelemetryEventCallBackParams=o}(t.Sdk||(t.Sdk={}))}(t||(t={})),function(t){!function(t){var n=function(e){function n(n,i){var o=e.call(this,n,i||window)||this;if(o.sdkVersion="1.3.34",o.appIdConst="/providers/Microsoft.PowerApps/apps/",o.eventListeners={},o.params="",!n.appId)throw new t.PowerAppsEmbeddingError("App Id cannot be empty");if(-1===n.appId.indexOf(o.appIdConst)&&(n.appId=o.appIdConst+n.appId),!n.containerId)throw new t.PowerAppsEmbeddingError("Container Id cannot be empty");if(o.containerElement=document.getElementById(n.containerId),!o.containerElement)throw new t.PowerAppsEmbeddingError("Container div does not exist");if(n.standAloneConsent&&!n.consentContainerId)throw new t.PowerAppsEmbeddingError("Container Id for consent service cannot be empty");if(n.consentContainerId&&(o.consentContainerElement=document.getElementById(n.consentContainerId),!o.consentContainerElement))throw new t.PowerAppsEmbeddingError("Container div for consent service does not exist");return o.options=n,o._onMessageReceived=o._onMessageReceived.bind(o),o._processConnectorAuthResult=o._processConnectorAuthResult.bind(o),o.queuedCdpData=[],o}return i(n,e),n.prototype.sendCdpData=function(e,t){if(t){var n={itemId:e,promise:t};this.sdkOrchestrator?this._sendCdpData(n):this.queuedCdpData.push(n)}},n.prototype.executeAction=function(e,n){if(void 0===n&&(n={}),!this.iframe)throw new Error("renderApp must be called before executeAction");var i,o=n&&n.itemId;switch(e){case"new":i={api:t.PowerAppsEmbeddingCallbackApi.NewItem,originalClickTime:n.originalClickTime};break;case"edit":if(!o)throw new TypeError("options must contain itemId");i={api:t.PowerAppsEmbeddingCallbackApi.EditItem,itemId:o};break;case"view":if(!o)throw new TypeError("options must contain itemId");i={api:t.PowerAppsEmbeddingCallbackApi.ViewItem,itemId:o,originalClickTime:n.originalClickTime};break;case"save":i={api:t.PowerAppsEmbeddingCallbackApi.SaveItem};break;case"cancel":i={api:t.PowerAppsEmbeddingCallbackApi.CancelEditItem};break;case"set-data":i={api:t.PowerAppsEmbeddingCallbackApi.SetProperty,hostType:"dynamic",propertyName:"Data",value:n.data};break;case"log":if(!n&&!n.parentRequestId)throw new TypeError("data must contain parentRequestId");i={api:t.PowerAppsEmbeddingCallbackApi.Log,data:n};break;default:throw new RangeError("Invalid action")}this.iframe.contentWindow.postMessage(i,"*")},n.prototype._constructUrl=function(e){void 0===e&&(e=!1);var t="",n=this._isCallingServiceFabricEndpoint();if(n){var i=decodeURIComponent(this.options.appId).replace(this.appIdConst,""),o=e?"consent":"play";t=this.options.appEnvironmentId?this.options.logicalAppName?""+this.options.hostName+o+"/e/"+this.options.appEnvironmentId+"/an/"+this.options.logicalAppName:""+this.options.hostName+o+"/e/"+this.options.appEnvironmentId+"/a/"+i:""+this.options.hostName+o+"/"+i,t=this.appendCoreEmbeddingParams(t);var r="default";this.options.enableAuthFlowProxy?r="authflowproxy":this.options.getAccessToken&&(r=this.options.enableOnBehalfOf?"onbehalfof":"override");var a=-1!==t.indexOf("?")?"&":"?";t=""+t+a+"authMode="+r,!e&&this.options.standAloneConsent&&(t+="&standAloneConsent=true"),e&&"function"==typeof this.options.openConnectorAuthPopup&&(t+="&openPopupByHost=true&connectorAuthCallbackUrl="+encodeURIComponent(window.location.protocol+"//"+window.location.host+"/webplayer/webClientAuthRedirect.html"))}else{var s="iframeapp";this.options.getAccessToken&&(s="embedapp"),a=-1!==(t=this.constructBaseUrl(n,s)).indexOf("?")?"&":"?",t=""+t+a+"appId="+encodeURIComponent(this.options.appId)}if(t+="&hideNavBar=true",this.options.tenantId&&(t+="&tenantId="+this.options.tenantId),this.options.appInfo&&this.options.appInfo.properties&&this.options.appInfo.properties.backgroundColor?t+="&screenColor="+encodeURIComponent(this.options.appInfo.properties.backgroundColor):this.options.splashScreenCssColor&&(t+="&screenColor="+encodeURIComponent(this.options.splashScreenCssColor)),this.options.delegateLaunchUrl&&(t+="&delegatelaunchurl=true"),this.options.hideAppSplashScreen&&(t+="&hideAppSplash=true"),this.options.packagePropertiesJson&&(t+="&packageProperties="+encodeURIComponent(this.options.packagePropertiesJson)),this.options.cachedFilesJson&&(t+="&skipIframeCreation=true"),t+="&sdkVersion="+this.sdkVersion,t+="&iframeContainerId="+this.options.containerId,this.options.locale&&(t+="&locale="+this.options.locale),this.options.parameters){for(var p in this.options.parameters)this.options.parameters.hasOwnProperty(p)&&(this.params+="&"+p+"="+encodeURIComponent(this.options.parameters[p]));t+=this.params}return this.options.useIntegrationEnvironment&&(t+="&overrideEnvironment=Tip1&overridePackager=Int"),this.options.embedderOrigin&&(t+="&embedderOrigin="+this.options.embedderOrigin),t},n.prototype._generateIframeSize=function(){if(this.options.appInfo&&this.options.appInfo.tags&&this.options.appInfo.tags.primaryDeviceWidth&&this.options.appInfo.tags.primaryDeviceHeight){var e=this.options.appInfo.tags.primaryDeviceHeight/this.options.appInfo.tags.primaryDeviceWidth;if(e>0){if(this.options.maxWidth){var t=(i=parseInt(this.options.maxWidth,10))*e;if(this.options.maxHeight){var n=parseInt(this.options.maxHeight,10);t>n&&(i=n/e,t=n)}return{width:i+"px",height:t+"px"}}var i;return this.options.maxHeight?{width:(i=(t=parseInt(this.options.maxHeight,10))/e)+"px",height:t+"px"}:e>1?{height:"100%",width:(i=100/e)+"%"}:{width:"100%",height:(t=100*e)+"%"}}return console.log("Aspect ratio is: "+e),this._generateIframeSizeWithNoAspectRatio()}return this._generateIframeSizeWithNoAspectRatio()},n.prototype._generateIframeSizeWithNoAspectRatio=function(){return{width:this.options.maxWidth?parseInt(this.options.maxWidth,10)+"px":"100%",height:this.options.maxHeight?parseInt(this.options.maxHeight,10)+"px":"100%"}},n.prototype.overrideWebPlayerPathSegment=function(e){this.webplayerPathSegmentToUse=e},n.prototype._fetchSDKMetadataAndLoad=function(){var e="";e=this._isCallingServiceFabricEndpoint()?this.options.hostName+"sdk/metadata":this.options.hostName+this.webplayerPathSegmentToUse+"/SDKMetadata";var t=this._injectSDKOrchestratorScriptAndRenderApp.bind(this),n=this._renderWebPlayerApp.bind(this),i=this._renderAppWithSdkOrchestrator.bind(this),o=new XMLHttpRequest;o.onload=function(){var e=!0;if(200===this.status){var r=o.responseText;try{var a=JSON.parse(r);a.defaultPublishedAppUrlTemplate&&a.orchestratorScriptLocation&&("undefined"!=typeof WebPlayerSDKOrchestrator?(e=!1,i(a)):(e=!1,t(a,a.orchestratorScriptLocation)))}catch(e){}}e&&n()},o.onerror=function(){n()},o.open("GET",e),o.send()},n.prototype._injectSDKOrchestratorScriptAndRenderApp=function(e,t){var n=document.createElement("SCRIPT");n.setAttribute("crossorigin","anonymous"),n.type="text/javascript",n.async=!1;var i=this._renderWebPlayerApp.bind(this),o=this._renderAppWithSdkOrchestrator.bind(this);n.addEventListener("error",(function(e){i()})),n.addEventListener("load",(function(t){o(e)})),document.head.appendChild(n),n.src=t},n.prototype._renderAppWithSdkOrchestrator=function(e){var t=this;window.addEventListener("message",this._onMessageReceived);var n=this._generateIframeSize();this.sdkOrchestrator=new WebPlayerSDKOrchestrator.SDKOrchestrator(this.containerElement,this._constructUrl(!1),e,this.options.cachedFilesJson,n.width,n.height,this.options.appId,this.options.packagePropertiesJson,this.params);var i=this.sdkOrchestrator.setupIframes();this.iframe=i.hostIframe,this.queuedCdpData.forEach((function(e){t._sendCdpData(e)})),this.queuedCdpData=[],this._initEmbeddingLogger(this.iframe)},n.prototype._sendCdpData=function(e){this.sdkOrchestrator.sendCdpData(e,this.options.overrideSendCdpDataApiEnabled)},n.prototype._renderWebPlayerApp=function(){var e=this._constructUrl(!1);this.iframe=this._createFrame(e),window.addEventListener("message",this._onMessageReceived),this.options.cachedFilesJson=null,this.iframe.name="webPlayer-iFrame",this.containerElement.appendChild(this.iframe),this.options.perceivedNodeQuerySelector&&(this.preceivedNodeToWatch=document.querySelector(this.options.perceivedNodeQuerySelector),this._trackEmbeddedPlayerVisibility()),this._initEmbeddingLogger(this.iframe)},n.prototype._initEmbeddingLogger=function(e){this.embeddingLogger=new t.EmbeddingLogger((function(n){var i={api:t.PowerAppsEmbeddingCallbackApi.Log,data:n};e.contentWindow.postMessage(i,"*")}))},n.prototype._renderConsentPage=function(){this.options.consentDialogOpenCloseHandler&&this.options.consentDialogOpenCloseHandler(!0);var e=this._constructUrl(!0);this.consentIframe=this._createFrame(e),this.consentIframe.name="consentService-iFrame",this.consentContainerElement.appendChild(this.consentIframe)},n.prototype._createFrame=function(e){var t=document.createElement("iframe");if(t.src=e,t.scrolling="no",t.setAttribute("allow","geolocation *; microphone *; camera *; fullscreen *;"),t.allowFullscreen=!0,!navigator.userAgent.match("Edge")){var n=["allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts","allow-forms","allow-orientation-lock"];t.sandbox&&t.sandbox.add?n.forEach((function(e){return t.sandbox.add(e)})):t.setAttribute("sandbox",n.join(" "))}var i=this._generateIframeSize();return t.width=i.width,t.height=i.height,t.style.boxSizing="border-box",t.style.border="none",t},n.prototype.renderApp=function(){this.options.cachedFilesJson&&!this.sdkOrchestrator?this._fetchSDKMetadataAndLoad():this.iframe||this.options.cachedFilesJson||this._renderWebPlayerApp()},n.prototype.dispose=function(){e.prototype.dispose.call(this),this.iframe&&!this.sdkOrchestrator&&(this.containerElement.removeChild(this.iframe),this.iframe=null),this.sdkOrchestrator&&this.sdkOrchestrator.dispose(),this._disposeConsentPage(),this.eventListeners={},window.removeEventListener("message",this._onMessageReceived)},n.prototype._disposeConsentPage=function(){this.consentIframe&&(this.consentContainerElement.removeChild(this.consentIframe),this.consentIframe=null,this.options.consentDialogOpenCloseHandler&&this.options.consentDialogOpenCloseHandler(!1))},n.prototype.addEventListener=function(e,t){if("function"!=typeof t)throw new TypeError("Event listener must be a function");this.eventListeners.hasOwnProperty(e)?this.eventListeners[e].push(t):this.eventListeners[e]=[t]},n.prototype.removeEventListener=function(e,t){if(this.eventListeners.hasOwnProperty(e)){var n=this.eventListeners[e].indexOf(t);-1!==n&&this.eventListeners[e].splice(n,1)}},n.prototype._fireEvent=function(e,t,n,i){if(this.eventListeners.hasOwnProperty(e)){var o=t;t=o.substring(o.lastIndexOf("/")+1),this.eventListeners[e].forEach((function(e){return e(t,o,n,i)}))}},n.prototype._onMessageReceived=function(e){var n=this;if(this.validateMessageOrigin(e)){var i=e.data;if(i&&void 0!==i.api){var o="";switch(i.api){case t.PowerAppsEmbeddingCallbackApi.AppLoaded:o="load";break;case t.PowerAppsEmbeddingCallbackApi.AppClosed:o="unload";break;case t.PowerAppsEmbeddingCallbackApi.AppFailed:o="error";break;case t.PowerAppsEmbeddingCallbackApi.EnableSave:o="enableSave";break;case t.PowerAppsEmbeddingCallbackApi.DelegateLaunchUrl:t.isDelegateLaunchUrlEventCallBackParams(i)&&(o="delegateLaunchUrl");break;case t.PowerAppsEmbeddingCallbackApi.RequestHide:o="requestHide";break;case t.PowerAppsEmbeddingCallbackApi.SendTrigger:t.isAppToHostFunctionsEventCallBackParams(i)&&(o="sendTrigger");break;case t.PowerAppsEmbeddingCallbackApi.ReadyToHandleMessages:return void(this.preceivedNodeToWatch&&this._reportEmbeddedPlayerVisibility());case t.PowerAppsEmbeddingCallbackApi.SendTelemetryEvent:t.isAppToHostTelemetryEventCallBackParams(i)&&(o="telemetry");break;case t.PowerAppsEmbeddingCallbackApi.InteractionRequired:o="interactionRequired",this.options.standAloneConsent&&i&&i.data&&"AppPermissionDialog"===i.data.source&&(t.EmbeddingConsentFlowHelper.onConsentServiceLoaded(i),this.options.consentDialogUserInteractionHandler&&this.options.consentDialogUserInteractionHandler());break;case t.PowerAppsEmbeddingCallbackApi.OpenConsentPage:t.EmbeddingConsentFlowHelper.initializeConsentService({logger:this.embeddingLogger,renderConsentPage:function(){n._renderConsentPage()},postMessageToConsentService:function(e){n.consentIframe&&n.consentIframe.contentWindow&&n.consentIframe.contentWindow.postMessage(e,"*")}},i);break;case t.PowerAppsEmbeddingCallbackApi.CloseConsentPage:this._disposeConsentPage();break;case t.PowerAppsEmbeddingCallbackApi.SetConsentResult:var r={api:t.PowerAppsEmbeddingCallbackApi.SetConsentResult,data:i.data};this.iframe.contentWindow.postMessage(r,"*");break;case t.PowerAppsEmbeddingCallbackApi.OpenConnectorAuthPopup:this.options.openConnectorAuthPopup(i.data,this._processConnectorAuthResult);break;case t.PowerAppsEmbeddingCallbackApi.GetPreloadConsentServiceData:t.EmbeddingConsentFlowHelper.sendPreloadDataToConsentService()}!o||i.appId&&i.appId.toLowerCase()!==this.options.appId.toLowerCase()||i.containerId&&i.containerId!==this.options.containerId||this._fireEvent(o,i.appId,i.containerId,i)}}},n.prototype._processConnectorAuthResult=function(e){if(e&&e.result){var n={api:t.PowerAppsEmbeddingCallbackApi.SetConnectorAuthResult,data:e};this.consentIframe.contentWindow.postMessage(n,"*")}},n.prototype._trackEmbeddedPlayerVisibility=function(){var e=this;"undefined"!=typeof MutationObserver&&new MutationObserver((function(t,n){t.some((function(t){return[e.containerElement,e.iframe].some((function(e){return t.target.contains(e)||t.target===e}))}))&&e._reportEmbeddedPlayerVisibility(n)})).observe(this.preceivedNodeToWatch,{attributes:!0,subtree:!1})},n.prototype._reportEmbeddedPlayerVisibility=function(e){var i=n._isElementOnScreen(this.iframe);this.isPlayerVisible!==i&&this.iframe&&(this.isPlayerVisible=i,this.iframe.contentWindow.postMessage({api:t.PowerAppsEmbeddingCallbackApi.VisibilityChanged,visible:this.isPlayerVisible},"*"),e&&e.disconnect())},n._isElementOnScreen=function(e){if(e){var t=function(e,t){return e.top<=t.top&&e.bottom>=t.bottom&&e.left<=t.left&&e.right>=t.right},n=e.offsetWidth+e.offsetHeight,i=-1===["hidden","collapsed"].indexOf(getComputedStyle(e).visibility),o=t(document.body.getBoundingClientRect(),e.getBoundingClientRect());return!!n&&i&&o}return!1},n.prototype._isCallingServiceFabricEndpoint=function(){return!!this.options.hostName&&/https:\/\/apps(\.\w+)?\.powerapps\.(com|us)/.test(this.options.hostName)},n}(e.Embedding.CoreEmbedding);t.PowerAppsEmbedding=n}(t.Sdk||(t.Sdk={}))}(t||(t={})),function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(Error);e.PowerAppsEmbeddingError=t}(e.Sdk||(e.Sdk={}))}(t||(t={})),t})?i.apply(t,o):i)||(e.exports=r)},GJM4:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeAppHostClient",(function(){return g})),n.d(t,"getRootAppId",(function(){return C})),n.d(t,"getRootAppLogicalName",(function(){return w})),n.d(t,"runWindowOverrides",(function(){return E}));var i=n("c/eZ"),o=n("iyBA"),r=n("ULvN"),a=n("BZKE"),s=n("sTbl"),p=n("mePC"),c=n("9r0m"),d=n("7LuR"),u=n("4pqm"),l=n("7EJx"),h=n("mGpW"),m=n("Ww2r");function f(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function g(e){return{type:"apphostclient.initialize.async",execute:function(t,n){var o;return Object(i.__awaiter)(this,void 0,void 0,(function(){var u,g,w,E,y,A;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return n.AppHostClient?[3,6]:Object(s.a)(t.getState())?[3,2]:(O=t.getState(),u=Object(s.e)(O)+"/apphost/clientsdk?version=1",[4,n.AssetLoader.loadScript(u)]);case 1:i.sent(),t.dispatch({type:a.a,payload:!0}),i.label=2;case 2:g=C(t.getState(),e),w={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:g,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(l.w)(t.getState()).formatInfoCultureName,source:"UCI"}},i.label=3;case 3:return i.trys.push([3,5,,6]),[4,b(n,w,9e4)];case 4:return i.sent(),n.AppHostClient.on("appHostClientErrorEvent",(I=t.dispatch,function(e){e&&e.errorInfo&&I(Object(p.b)({level:2,message:e.errorInfo.localizedMessage,id:c.a.newGuid().guid,type:2,showCloseButton:!0}))})),n.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){var n=t.notificationInfo.timeoutInMilliSec,i=c.a.newGuid().guid;e(Object(p.b)({level:f(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:i,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),n>0&&1e4!==n&&setTimeout((function(){e(Object(d.b)(i))}),n)}}}(t.dispatch)),t.dispatch({type:a.b,payload:{initialized:r.a.Initialized,error:void 0}}),[3,6];case 5:throw E=i.sent(),(null===(o=null==E?void 0:E.errorInfo)||void 0===o?void 0:o.code)?t.dispatch(v(E)):("Crm.GenericErrorMessage",y=["Crm.GenericErrorMessage"],t.dispatch(Object(h.e)(y)).then((function(){var e=Object(m.e)(t.getState(),y);t.dispatch(v({errorInfo:{code:"unknown",localizedMessage:Object(m.c)(e,"Crm.GenericErrorMessage"),timestamp:Date.now(),description:(null==E?void 0:E.message)||"Unknown error occured while initializing apphostclient"}}))}))),A=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}],n.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",E,void 0,A),E;case 6:return[2]}var I,O}))}))}}}function b(e,t,n){var i,o=new Promise((function(e,t){i=setTimeout((function(){return t({message:"PowerAppsHostingSdk.initializeAsync timed out"})}),n)})),r=PowerAppsHostingSdk.initializeAsync(t).then((function(t){clearTimeout(i),e.AppHostClient=t}));return Promise.race([r,o])}function v(e){return{type:a.c,payload:{initialized:r.a.Initialize_Failed,error:e}}}function C(e,t){return Object(o.e)(e,"rootAppId")||t}function w(e,t){return Object(o.b)(e,"appLogicalName")||t}function E(e){var t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;var n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){var e=this,i=arguments[0],o=arguments[1],r=arguments[2];if(!1===r){var a=[{name:"url",value:o}];t.error("Sync call attempted",a)}var s=arguments[1].indexOf("/webresources/");if(-1!==s){var p=o.slice(s+"/webresources/".length);o=Object(u.b)()+"/api/data/v9.0/webresourceset?$filter=name eq '"+p+"'&$select=content";var c=this.onload;this.onload=function(){var t;try{var n=JSON.parse(e.responseText);e._responseText=atob(null===(t=null==n?void 0:n.value[0])||void 0===t?void 0:t.content)}catch(e){}c(e)}}-1===o.indexOf("https://")&&(o=Object(u.b)()+o),n.call(this,i,o)},window.fetch=function(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open(e.method,e.url),e.headers.forEach((function(e,t){i.setRequestHeader(t,e)})),i.onload=function(){var e=204===i.status?null:i.response||i.responseText,n=new Headers;i.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((function(e){var t=e.split(": ");n.append(t.shift(),t.join(": "))}));var o=new Response(e,{status:i.status,statusText:i.statusText,headers:n});t(o)},i.onerror=function(){n("Error")},e.text().then((function(e){i.send(e)}))}))}}},p0q8:function(e,t,n){"use strict";n.r(t),n.d(t,"CustomPage",(function(){return B}));var i=n("c/eZ"),o=n("FINr"),r=n("nuS9"),a=n("4fxQ"),s=n("YWpA"),p=n("4E+q"),c=n("6ebE"),d=n("C8PA"),u=n("sOTk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t){return e.metadata.canvasapps[t]}var h=n("cZkS"),m=n("qC0c"),f=n("kyRo"),g=n("ASFs"),b=n("ULvN"),v=n("B188"),C=n("sTbl"),w=n("RYq1"),E=n("MLbG"),y=n("Vm/X"),A=n("mGpW"),I=n("Ww2r"),O=n("+D0h");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function P(e,t){return{type:"HANDLE_CUSTOMPAGE_INIT_ERROR",execute:function(n,o){var r,a,s=n.dispatch,p=n.getState;return Object(i.__awaiter)(this,void 0,void 0,(function(){var n,c,d,u,l,h,m,f,g,b,v,C,P,S,k,_,T,R,L,D,H,j,x,M,N;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:n={type:"error"},"Web.Dialog.ErrorCode_Caption",l="Crm.GenericErrorMessage",g=[c="Button_Label_OK","Web.Dialog.ErrorCode_Caption",d="L_Show_Details_Text",h="L_Client_Session_Id",m="L_Server_Activity_Id",f="L_Current_Time",u="Error_Title_Generic"],b=null===(r=null==t?void 0:t.errorInfo)||void 0===r?void 0:r.localizedMessage,v=[u,l],i.label=1;case 1:return i.trys.push([1,7,,10]),[4,s(Object(A.e)(g))];case 2:return i.sent(),x=Object(I.e)(p(),g),C=Object(I.c)(x,u),b=b||C,P=Object(I.c)(x,c),S=Object(I.c)(x,d),k=Object(I.c)(x,h),_=Object(I.c)(x,f),T=Object(I.c)(x,m),R=k.replace("{0}",o.EventManager.getCurrentSessionId()),L=T.replace("{0}",o.EventManager.getActivityId()),D=_.replace("{0}",""+new Date),H=[b,R,L,D],[4,s(Object(E.a)(y.d,b,n,P,C,b,P,S,H,!0,e,void 0))];case 3:return 0!==(j=i.sent()).status?[3,5]:[4,s(Object(O.a)(j.pageId))];case 4:return i.sent(),o.TraceManager.getTracer("CUSTOMPAGE_ERROR_TRACER_CATEGORY").error(b,[{name:"code",value:null===(a=null==t?void 0:t.errorInfo)||void 0===a?void 0:a.code},{name:"errordetails",value:null==t?void 0:t.errorInfo.description},{name:"timestamp",value:null==t?void 0:t.errorInfo.timestamp}]),s(Object(w.e)(e,"dismiss")),[3,6];case 5:throw j.error;case 6:return[3,10];case 7:return i.sent(),t&&t.errorInfo&&o.TraceManager.getTracer("CUSTOMPAGE_ERROR_TRACER_CATEGORY").error(b,[{name:"code",value:t.errorInfo.code},{name:"errordetails",value:t.errorInfo.description},{name:"timestamp",value:t.errorInfo.timestamp}]),[4,s(Object(A.e)(v))];case 8:return i.sent(),x=Object(I.e)(p(),v),M=Object(I.c)(x,u),N=Object(I.c)(x,l),[4,s(Object(E.a)(y.d,"",n,"",M,N))];case 9:return i.sent(),s(Object(w.e)(e,"dismiss")),[3,10];case 10:return[2]}}))}))}}}var S=n("HvZf"),k=n("9r0m"),_=n("zPLw"),T=n("iI6B"),R=n("aPRd"),L=n("np0M"),D={marginTop:0,borderTop:"1px solid #E8EAEC",borderBottom:"1px solid #D8D8D8"};var H=Object(p.a)((function(){var e,t;return function(n,i){var o=Object(u.h)(n,i.id);t!==o&&(t=o,e=Object.values(t));var r=Object(R.c)(n);return{notificationList:e,viewPortWidth:r}}}))((function(e){return e.notificationList&&e.notificationList.length>0?r.createElement(L.a,{loader:function(){return Promise.all([n.e(30),n.e(46)]).then(n.bind(null,"hurf")).then((function(e){return e.BarNotificationList}))},props:{id:"page-notification-list",domWidth:e.viewPortWidth,notificationList:e.notificationList,customStyle:D}}):null})),j=n("3ZuC"),x={display:"flex",flexDirection:"column",flex:"1",maxWidth:"100%",overflow:"hidden",height:"100%"},M={width:"100%",height:"100%"};function N(e){var t;switch(null===(t=null==e?void 0:e.notificationInfo)||void 0===t?void 0:t.notificationType){case"error":return _.a;case"success":return _.d;case"warning":return _.e;case"info":default:return _.b}}function W(e){var t=this,n=e.id,o=Object(p.d)((function(e){var t,i=Object(u.g)(e,n);return{canvasAppName:i.name,appId:null===(t=l(e,i.name))||void 0===t?void 0:t.canvasappid,recordId:i.recordId,entityName:i.entityName}}),g.e),w=o.canvasAppName,E=o.appId,y=o.recordId,A=o.entityName,I=Object(p.d)(C.e),O=Object(p.c)(),R="custompage_"+n+"_"+E,L=r.useRef(null),D=Object(p.d)((function(e){return Object(m.c)(e,h.Ad)})),W=Object(p.d)(C.c),q=Object(p.d)(C.b),U=r.useContext(f.a).Router,G=Object(p.d)((function(e){return Object(j.a)(e,n)})),B=U.getHistoryManager().GetHistoryLength(G)>1,F=Object(p.e)(),z=r.useContext(f.a),V=r.useRef(new c.a(F,n,z)),J=r.useContext(f.a).AppHostClient,K=Object(v.b)(),X=K.u&&K.s&&{mep:K.u,mss:K.s};return r.useLayoutEffect((function(){if(void 0!==E){if(D){var e,o=L.current,r=!1,s=function(e,t){return function(n){if(n&&n.errorInfo){var i=k.a.newGuid().guid;e(Object(S.b)({Level:_.a,Message:n.errorInfo.localizedMessage,UniqueId:i,CloseAction:Object(T.b)(i,t)},t))}}}(O,n),p=function(e,t){return function(n){if(n&&n.notificationInfo){var i=n.notificationInfo.timeoutInMilliSec,o=k.a.newGuid().guid;e(Object(S.b)({Level:N(n),Message:n.notificationInfo.message,UniqueId:o,CloseAction:Object(T.b)(o,t)},t)),i>0&&1e4!==i&&setTimeout((function(){e(Object(T.b)(o,t))}),i)}}}(O,n);return Object(i.__awaiter)(t,void 0,void 0,(function(){var t,c,d,u;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:if(W===b.a.Initialize_Failed)return O(P(n,q)),[2];if(W===b.a.Not_Initialized)return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,J.getCanvasAppAsync(w)];case 2:return e=i.sent(),r?[2]:(e.on("canvasAppRuntimeError",s),e.on("canvasAppNotification",p),t=a.findDOMNode(o),c=void 0,(y||A||B)&&(c={},y&&(c.recordId=y),A&&(c.entityName=A),B&&(c.canNavigateBack=B)),d={containerDiv:t,rootAppServices:{Xrm:V.current},params:c},[4,e.renderAsync(d)]);case 3:return i.sent(),[3,5];case 4:return u=i.sent(),O(P(n,u)),[3,5];case 5:return[2]}}))})),function(){r=!0,e&&(e.off("canvasAppRuntimeError",s),e.off("canvasAppNotification",p),e.dispose())}}var c=new d.Sdk.PowerAppsEmbedding({appId:E,containerId:R,hostName:I,parameters:X});return c.renderApp(),function(){return c.dispose()}}}),[R,I,D,E,w,W,J,L,X,y,A,O,n,q,B,V]),r.createElement(s.a,{style:x},r.createElement(H,{id:n}),r.createElement(s.a,{id:R,ref:L,style:M}))}var q=n("t8f4"),U=n("6JRL");var G=n("GJM4"),B=function(){function e(e){this._id=e}return e.prototype.getName=function(){return o.a},e.prototype.getId=function(){return this._id},e.prototype.getInitializationAction=function(){return e=this._id,{type:"custompage.initialize",execute:function(t){var n=t.dispatch,o=t.getState;return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r,a,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t=o(),r=Object(u.g)(t,e).name,l(t,r)?[2]:[4,n(Object(q.e)("canvasapp","?$filter=name eq '"+encodeURIComponent(r)+"'&$select=canvasappid,displayname"))];case 1:if(a=i.sent(),!(s=a.value[0]))throw Object(U.d)("Cannot find page with specified name",void 0,[{name:"pageName",value:r}]);return n(function(e){return{type:"metadata.canvasapp.add",payload:e}}({name:r,canvasappid:s.canvasappid,displayname:s.displayname})),Object(m.c)(t,h.Ad)&&n(Object(G.initializeAppHostClient)(s.canvasappid)),[2]}}))}))}};var e},e.prototype.getRootReducer=function(){return function(e){return e}},e.prototype.getRootComponent=function(){return W},e.prototype.getCloseAction=function(e){},e}();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */},sTbl:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return l}));var i=n("EGsq"),o=n("iyBA"),r=n("qC0c"),a=n("cZkS"),s=n("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e){return e.appHostClient.initialized}function c(e){return e.appHostClient.error}function d(e){var t=Object(i.x)(e),n=t.geoName,s=t.isSovereignCloud;if(Object(r.c)(e,a.yc))return"Test";switch(null==n?void 0:n.toUpperCase()){case"TIP":var p=Object(o.b)(e,"canvashostenv");switch(null==p?void 0:p.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(s)return"Gcc";default:var c=Object(o.b)(e,"canvashostenv");switch(null==c?void 0:c.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function u(e){switch(d(e)){case"Local":return s.Endpoint.Local;case"Test":return s.Endpoint.Test;case"Int":return s.Endpoint.Int;case"Preprod":return s.Endpoint.Preprod;case"Gcc":return s.Endpoint.Gcc;case"GccHigh":return s.Endpoint.GccHigh;case"Preview":return s.Endpoint.Preview;default:return s.Endpoint.Prod}}function l(e){return e.appHostClient.bundleLoaded}},zPLw:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return p}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i="SUCCESS",o="ERROR",r="WARNING",a="INFORMATION",s="LOCKED",p=new Set([s])}}]),window.bundleExecutionMarkers["scripts/es5/custompage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();