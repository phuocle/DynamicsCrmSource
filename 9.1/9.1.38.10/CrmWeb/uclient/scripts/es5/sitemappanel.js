(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/sitemappanel.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[104],{"+r/t":function(e,t,o){"use strict";o.d(t,"d",(function(){return n})),o.d(t,"l",(function(){return r})),o.d(t,"k",(function(){return i})),o.d(t,"j",(function(){return s})),o.d(t,"n",(function(){return a})),o.d(t,"i",(function(){return l})),o.d(t,"g",(function(){return c})),o.d(t,"m",(function(){return p})),o.d(t,"o",(function(){return u})),o.d(t,"c",(function(){return d})),o.d(t,"b",(function(){return h})),o.d(t,"p",(function(){return y})),o.d(t,"a",(function(){return f})),o.d(t,"h",(function(){return b})),o.d(t,"f",(function(){return m})),o.d(t,"e",(function(){return g})),o.d(t,"q",(function(){return S}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n="Web.NavBar.Home_Title",r="Web.NavBar.Search_Title",i="Web.NavBar.Relationship_Assistant_Caption",s="Web.NavBar.Quick_Create_Menu_Caption",a="Web.NavBar.Start_Task_Flow_Caption",l="Web.NavBar.Offline_Status_Caption",c="Web.NavBar.Immersive_Skype_Caption",p="Web.NavBar.Settings_Caption",u="Web.NavBar.User_Information_Caption",d="Web.NavBar.Help_Title",h="Web.NavBar.Go_Back",y="Web.NavBar.SiteMap",f="Web.NavBar.AdvancedFind_Title",b="Monitor.Monitor.Label",m="Web.NavBar.Home_Title",g="Web.NavBar.Home_Desc",S=[n,r,i,s,a,l,"Web.NavBar.See_Welcome_Screen_Caption",c,p,u,f,b,d,"Web.NavBar.Search_Title","Web.NavBar.Search_Desc","Web.NavBar.Settings_Title","Web.NavBar.Settings_Desc","Web.NavBar.Help_Title","Web.NavBar.Help_Desc",m,g,"Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.TaskFlow_Desc","Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.User_Information_Title","Web.NavBar.User_Information_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.OfflineStatus_Desc",h,"Web.NavBar.AdvancedFind_Title","Web.NavBar.AdvancedFind_Desc",y]},"2n3f":function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o("ZVHh"),r=o("GDI2"),i=o("jV4X");function s(e,t){return{type:"Navigate to sitemap area",execute:function(o,s){var l=Object(r.b)(o.getState()),c=e&&function(e,t){if(!t||!e||!e.AreaIds)return null;for(var o=e.Areas[t],n=0,r=o.GroupIds;n<r.length;n++)for(var s=r[n],l=o.Groups[s],c=0,p=l.SubAreaIds;c<p.length;c++){var u=p[c],d=l.SubAreas[u];if(!Object(i.f)(d)&&a(d))return d}return null}(l,e);if(c)return o.dispatch(Object(n.c)(c,!1,null,t))}}}function a(e){return!e.Url||!e.Url.toLowerCase().endsWith("msdyn_launchdesigner.html")}},FbjN:function(e,t,o){"use strict";function n(e,t){var o=function(e){return[e.colors.BaseColor.Blue.Blue3,e.colors.BaseColor.Orange.Orange5,e.colors.BaseColor.Teal.Teal5,e.colors.BaseColor.Clay.Clay4,e.colors.BaseColor.Violet.Violet4,e.colors.BaseColor.Blue.Blue4,e.colors.BaseColor.Red.Red5,e.colors.BaseColor.Yellow.Yellow5,e.colors.BaseColor.Pink.Pink5,e.colors.BaseColor.Green.Green5,e.colors.BaseColor.Purple.Purple2,e.colors.BaseColor.Blue.Blue5,e.colors.BaseColor.Clay.Clay5]}(t);return o[e%o.length]}function r(e){var t="";if(e)for(var o=e.split(" "),n=0;n<o.length&&t.length<2;n++)if(o[n].length>0){var r=o[n].charCodeAt(0);if(!(r>=97&&r<=122||r>=65&&r<=90)){t+=o[n].charAt(0);break}t+=o[n].charAt(0)}return t}o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return r}))},Uzd8:function(e,t,o){"use strict";o.r(t),o.d(t,"_SitemapPanel",(function(){return Rt})),o.d(t,"SitemapPanel",(function(){return Bt})),o.d(t,"mapDispatchToProps",(function(){return Tt})),o.d(t,"makeMapStateToProps",(function(){return Nt})),o.d(t,"sitemapPanelActionInspector",(function(){return Lt})),o.d(t,"SessionPanel",(function(){return Yt})),o.d(t,"SitemapRecentsFlyout",(function(){return no}));var n=o("c/eZ"),r=o("nuS9"),i=o("4fxQ"),s=o("YWpA"),a=o("4E+q"),l=o("GDI2"),c=o("Wi7Z"),p=o("lU69"),u=o("evW+"),d=o("p1Sq"),h=o("H/hG"),y=o("znb3"),f=o("XIN1"),b=o("9rQ4"),m=o("PXs8"),g=o("MGMD"),S=o("1AYO"),v=o("Smta"),_=o("gvL4"),w=o("Zh8V"),I=o("7EJx"),E=o("wV3W"),C=o("QVns"),M=o("efG+"),k=o("Ww2r"),O=o("ahsv"),A=o("vO+w"),x=o("w2s3");function R(e,t,o){return{cursor:"default",marginLeft:o?"0px":t.sizes.Measures.Measure300,marginRight:o?t.sizes.Measures.Measure300:"0px",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,color:e?e.Components.Navigation.Selected.TextColor:t.colors.BaseColor.Grey.Grey7,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"flex",flexDirection:"row"}}function N(e,t){return{color:e?e.Components.Navigation.Selected.TextColor:void 0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontSize:t.fontSizes.Font100,fontFamily:t.fontFamilies.Normal,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"inline-block",alignItems:"center"}}function T(e,t){return{color:e?e.Components.Navigation.Selected.IconColor:void 0,fontFamily:"CRM MDL2",fontSize:"16px",width:"16px",minWidth:"16px",height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,marginLeft:t.sizes.Measures.Measure100,display:"flex",alignItems:"center"}}function B(e){O.a.flyOutEnter()}function D(e){O.a.exitFlyOut()}var j=Object(a.a)((function(){return function(e,t){var o=Object(E.a)(e),n=Object(I.g)(e);return{theme:o,designLanguage:Object(A.b)(e)?Object(A.a)(e):null,isRTL:n}}}))((function(e){var t,o,i,a,l={onMouseLeave:D,onMouseEnter:B};return r.createElement(S.a,Object(n.__assign)({key:"flyout",positionType:"relative",relativeToElementId:e.relativeToElementId,flyoutDirection:e.flyoutDirection,flyoutStyle:(o=e.designLanguage,i=e.theme,a=e.flyoutWidth,{backgroundColor:o?o.Components.Navigation.Selected.BackgroundColor:i.colors.BaseColor.White,boxShadow:"0px 8px 10px rgba(0,0,0,0.1)",maxHeight:"23.75em",overFlowY:"auto",width:a,display:"flex",flexDirection:"column"}),onOutsideClick:function(t){return function(e,t){var o=t.target,n=document.getElementById("areaSwitcherId");o&&!n.contains(o)&&n!==o&&e.closeFlyout()}(e,t)},id:e.id,testhooks:(t={},t[g.a.LearningPathDOMAttributeSuffix]="sitemap-area-switcher-flyout",t)},l),r.createElement(s.a,null,r.createElement(h.a,{style:R(e.designLanguage,e.theme,e.isRTL),role:c.r},Object(k.c)(e.resourceStrings,M.h))),r.createElement(_.a,{onKeyDown:e.keyDownHandler,ref:m.c,role:c.l,accessibilityLabel:Object(k.c)(e.resourceStrings,M.h)},function(e,t,o){return(t=t.filter((function(e){return e.Id!==x.d})))&&t.length?t.map((function(t,n){var i,s,a,l,p;return r.createElement(v.a,{key:n,style:(s=e.designLanguage,a=e.theme,l=s?s.Components.Navigation.Rest.BackgroundColor:a.colors.BaseColor.Grey.Grey3,p=s?s.Components.Navigation.Rest.TextColor:a.colors.BaseColor.Grey.Grey1,Object(w.e)({color:Object(C.e)(p),cursor:"pointer",display:"flex",flexDirection:"row"},l)),tabIndex:-1,accessibilityChecked:o===t.Id,role:c.o,testhooks:(i={id:"areaswitcherflyout-"+t.Id},i[g.a.LearningPathDOMAttributeSuffix]="sitemap-areaswitcherflyout-"+t.Id,i),onClick:function(o){e.selectArea(t.Id),e.closeFlyout(o)}},r.createElement(h.a,{style:T(e.designLanguage,e.theme)},o===t.Id?r.createElement(f.b,{type:y.a.CheckMark}):null),r.createElement(h.a,{title:t.Titles[0].Title,style:N(e.designLanguage,e.theme)},t.Titles[0].Title))})):[]}(e,e.siteMapItems,e.selectedAreaId)))})),L=o("/Hzt"),F=o("FbjN");function P(e,t){return{textAlign:"center",justifyContent:"center",textTransform:"uppercase",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:"12px",lineHeight:t.sizes.Measures.Measure175,width:t.sizes.Measures.Measure200,height:t.sizes.Measures.Measure200,borderRadius:"2px",border:"none",color:e?e.Components.Navigation.Rest.Hover.IconColor:t.colors.BaseColor.White}}function H(e,t,o){return{height:t.sizes.Measures.Measure200,fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:t.sizes.Measures.Measure100,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.TextColor:t.colors.BaseColor.Grey.Grey7,textAlign:o?"right":"left",marginLeft:o?"0px":t.sizes.Measures.Measure050,marginRight:o?t.sizes.Measures.Measure050:"0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",flexGrow:1}}function K(e,t,o){return{fontSize:"16px",lineSize:"19px",alignContent:"flex-end",width:"16px",height:t.sizes.Measures.Measure200,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.IconColor:t.colors.BaseColor.Grey.Grey7,marginRight:o?"0px":"6px",marginLeft:o?"6px":"0px"}}var z={flexShrink:0},W=function(e){function t(t){var o=e.call(this,t)||this;return o._areaSwitcherFlyoutId=Object(p.a)(),o._areaSwitcherButtonRef=null,o._getAreaSwitcherButtonRef=o._getAreaSwitcherButtonRef.bind(o),o._toggleAreaSwitcherFlyout=o._toggleAreaSwitcherFlyout.bind(o),o.keyDownHandler=o.keyDownHandler.bind(o),o.state={},o}return Object(n.__extends)(t,e),t.prototype._toggleAreaSwitcherFlyout=function(){this.setState({isAreaSwitcherFlyoutVisible:!this.state.isAreaSwitcherFlyoutVisible}),O.a.session&&(this.state.isAreaSwitcherFlyoutVisible?(O.a.exitFlyOut(),O.a.session.addEvent(L.a.collapseAreaSwitcher)):(O.a.flyOutEnter(),O.a.session.addEvent(L.a.expandAreaSwitcher)))},t.prototype._getAreaSwitcherButtonRef=function(e){this._areaSwitcherButtonRef=e},t.prototype.keyDownHandler=function(e){var t=this;Object(m.b)(e)||this.setState({isAreaSwitcherFlyoutVisible:!1}),e.keyCode!==b.a.Enter&&e.keyCode!==b.a.Escape||requestAnimationFrame((function(){t._areaSwitcherButtonRef&&t._focusOnAreaSwitcher()}))},t.prototype._focusOnAreaSwitcher=function(){var e=i.findDOMNode(this._areaSwitcherButtonRef);e&&e.focus()},t.prototype._renderAreaSwitcher=function(){var e;if(!this.props.selectedAreaId)return null;for(var t,o,i=Object(d.a)(this.props.siteMap),a=r.createElement(j,{id:this._areaSwitcherFlyoutId,siteMapItems:i,flyoutDirection:0===this.props.panelState?this.props.isRTL?S.b.left:S.b.right:S.b.up,selectArea:this.props.selectArea,selectedAreaId:this.props.selectedAreaId,relativeToElementId:"areaSwitcherContainer",closeFlyout:this._toggleAreaSwitcherFlyout,keyDownHandler:this.keyDownHandler,resourceStrings:this.props.resourceStrings,flyoutWidth:this.props.flyoutWidth}),l=this.props.designLanguage,p=0;p<i.length;p++)this.props.selectedAreaId===i[p].Id&&(t=i[p].Titles[0].Title,o=Object(n.__assign)(Object(n.__assign)({},P(l,this.props.theme)),{backgroundColor:Object(F.a)(p,this.props.theme)}));var b,m=Object(n.__assign)(Object(n.__assign)({},{backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",display:"flex",alignItems:"center",margin:(b=this.props.theme).sizes.Measures.Measure050+" 8px",flexDirection:"row",justifyContent:"flex-start",height:b.sizes.Measures.Measure200,padding:0,borderRadius:"3px",width:"100%",overflow:"hidden"}),{":hover":this.state.isAreaSwitcherFlyoutVisible?null:{backgroundColor:l?l.Components.Navigation.Rest.Hover.BackgroundColor:this.props.theme.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)"}}),v=String.format(Object(k.c)(this.props.resourceStrings,M.i),t);return r.createElement(s.a,{key:"expand-options",style:z,id:"areaSwitcherContainer",role:c.r},r.createElement(u.a,{key:"expand-options-button",title:v,accessibilityLabel:v,onClick:this._toggleAreaSwitcherFlyout,style:m,id:"areaSwitcherId",accessibilityExpanded:!!this.state.isAreaSwitcherFlyoutVisible,accessibilityHasPopup:!0,ref:this._getAreaSwitcherButtonRef,testhooks:(e={id:"sitemap-areaSwitcher-expand-btn"},e[g.a.LearningPathDOMAttributeSuffix]="sitemap-areaSwitcher-expand-btn",e)},r.createElement(s.a,{style:{display:"flex"}},r.createElement(s.a,{semanticTag:"span",style:o},Object(F.b)(t))),0===this.props.panelState?null:r.createElement(h.a,{style:H(l,this.props.theme,this.props.isRTL)}," ",t),0===this.props.panelState?null:r.createElement(h.a,{key:"down-chevron",style:K(l,this.props.theme,this.props.isRTL)},r.createElement(f.b,{type:y.a.ScrollUpDown}))),this.state.isAreaSwitcherFlyoutVisible?a:null)},t.prototype.render=function(){if(this.props.siteMap&&this.props.siteMap.AreaIds.length<2)return null;var e=this.props.designLanguage,t=e?e.Components.Navigation.Selected.BackgroundColor:this.props.theme.colors.BaseColor.White,o=e?e.Components.Navigation.Rest.BackgroundColor:this.props.theme.colors.BaseColor.Grey.Grey1,i=Object(n.__assign)(Object(n.__assign)({},
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){var o=e?e.Components.Navigation.Rest.Focus.BorderColor:t.colors.BaseColor.Grey.Grey3;return{width:"100%",height:t.sizes.Measures.Measure100,display:"block",minHeight:t.sizes.NavButtonHeight,borderTop:"1px solid "+o}}(e,this.props.theme)),{backgroundColor:this.state.isAreaSwitcherFlyoutVisible?t:o});return r.createElement(s.a,{style:i,role:c.r},this._renderAreaSwitcher())},t}(r.Component),G=o("eGYM"),U=o("uTTW"),q=o("cn0Y"),V=o("ZVHh"),Z=o("Ev4I"),Q=o("Ff8i"),X=o("P7C7"),Y=o("mTVg"),J=o("7sMj"),$=o("EZG4"),ee=o("VnpK");function te(e){var t=Object(E.a)(e);return{entryWrap:{flexGrow:1,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionWrapStyle:{position:"relative",left:"0px",right:"0px",flexGrow:0,flexShrink:0},entrySubActionIconStyles:{fontSize:t.fontSizes.Font125},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:t.colors.SiteMap.RefreshedBarItemIcon,alignItems:"center"}}}function oe(e,t,o,n){var r=t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,i=t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text;return{display:"flex",width:"100%",height:e.sizes.Measures.Measure250,justifyContent:"space-between",paddingLeft:n?e.sizes.Measures.Measure100:"8px",paddingRight:n?"8px":e.sizes.Measures.Measure100,":hover":{backgroundColor:r,color:i,position:"relative",transition:"background-color 200ms",zIndex:1}}}function ne(e,t,o,r){var i={width:"100%",display:"flex",alignItems:"center",cursor:"pointer",color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted "+(t?t.Components.Navigation.Rest.Focus.BorderColor:"white")},":focus > :first-child > :first-child":{visibility:"visible"},":hover > :first-child > :first-child":{visibility:"visible"}};if(r&&r.isMouseOnRow){var s={":hover":{backgroundColor:t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,color:t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text,position:"relative",transition:"background-color 200ms",zIndex:1}};return Object(n.__assign)(Object(n.__assign)({},i),s)}return i}function re(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t?0:"8px",marginRight:t?"8px":0,fontFamily:e.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}function ie(e,t){var o=t.colors.SiteMap.EntityOfflineStatusIcon;return{fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",lineHeight:"16px",marginLeft:"auto",width:t.sizes.SiteMap.EntityOfflineStatusIconWidth,color:e===Z.a.Enabled?o.Enabled:o.Disabled,fontSize:t.fontSizes.SiteMapOfflineStatusIcon,flexShrink:0}}function se(e,t){return{display:"flex",paddingLeft:0,justifyContent:"space-between",height:e.sizes.Measures.Measure250,alignItems:"center",overflowX:"hidden",flex:"auto"}}var ae=o("kyRo"),le=o("E705"),ce=o("TCzx"),pe=o("qJTl"),ue=o("c96h"),de=function(e){function t(t,o){var n=e.call(this,t)||this;if(n._onSubActionClickHandler=n._onSubActionClickHandler.bind(n),n._onClickHandler=n._onClickHandler.bind(n),n._onMouseEnter=n._onMouseEnter.bind(n),n._onMouseLeave=n._onMouseLeave.bind(n),n._onSubActionButtonMouseEnter=n._onSubActionButtonMouseEnter.bind(n),n._onSubActionButtonMouseLeave=n._onSubActionButtonMouseLeave.bind(n),n.onKeyDownHandler=n.onKeyDownHandler.bind(n),n.onSubAtionKeyDownHandler=n.onSubAtionKeyDownHandler.bind(n),n._onFocus=n._onFocus.bind(n),n._onBlur=n._onBlur.bind(n),n._toggleSitemap=n._toggleSitemap.bind(n),n.state={isMouseOnRow:!1,isMouseOnButton:!1,isKeyboardFocused:!1},n._traceManager=o.TraceManager,!n._traceManager)throw new Error("TraceManager is null");return n}return Object(n.__extends)(t,e),t.prototype._toggleSitemap=function(){this.props.isSitemapInFlyout&&this.props.toggleSitemap()},t.prototype._onClickHandler=function(e){void 0===e&&(e=null),e&&e.stopPropagation(),this.props.execute(this.props.entry.onClickHandler(!0,this._toggleSitemap,q.b.SiteMap,V.d))},t.prototype._onMouseEnter=function(e){void 0===e&&(e=null),this.setState((function(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{isMouseOnRow:!0})}))},t.prototype._onMouseLeave=function(e){void 0===e&&(e=null),this.setState((function(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{isMouseOnRow:!1})}))},t.prototype._onFocus=function(e){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId),e.preventDefault(),e.stopPropagation()},t.prototype._onBlur=function(e){e.target!==i.findDOMNode(this._subButtonRef)&&this.setState({isKeyboardFocused:!1})},t.prototype._onSubActionButtonMouseEnter=function(e){void 0===e&&(e=null),this.setState((function(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{isMouseOnButton:!0})}))},t.prototype._onSubActionButtonMouseLeave=function(e){void 0===e&&(e=null),this.setState((function(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{isMouseOnButton:!1})}))},t.prototype._focusOnRootElement=function(){var e=this.props.sitemapRowId;if(e){var t=document.getElementById(e),o=!t.nextSibling;window.setTimeout((function(){o&&(t=document.getElementById(e)),t&&t.parentElement.parentElement.parentElement.focus()}))}},t.prototype.onKeyDownHandler=function(e){var t=e.target;switch(Object(le.e)(e.nativeEvent)){case b.a.Enter:e.stopPropagation(),e.preventDefault(),this._onClickHandler();break;case b.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case b.a.UpArrow:t&&!t.previousElementSibling&&t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.parentElement&&(t.parentElement.parentElement.parentElement.focus(),e.stopPropagation(),e.preventDefault());break;case b.a.LeftArrow:case b.a.RightArrow:e.stopPropagation(),e.preventDefault();var o=i.findDOMNode(this._subButtonRef);o&&o.focus()}},t.prototype.onSubAtionKeyDownHandler=function(e){switch(Object(le.e)(e.nativeEvent)){case b.a.Enter:case b.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case b.a.LeftArrow:case b.a.RightArrow:case b.a.UpArrow:case b.a.DownArrow:e.stopPropagation(),e.preventDefault();var t=i.findDOMNode(this._itemRef);t&&t.focus()}},t.prototype._onSubActionClickHandler=function(e){void 0===e&&(e=null),e&&e.stopPropagation();var t=this.props.entry.subActionDescriptor.onClickHandler;t&&this.props.execute(t()),this._focusOnRootElement()},t.prototype.render=function(){var e,t=this,o=this.props,i=o.entry,a=o.theme,l=o.customStyles,c=o.isTabIndexZero,p=o.describedByElementId;if(!i)return this._traceManager.getTracer(x.l).error("SubAreaDescriptor passed in to SitemapPinnableRow is null",[{name:"describedByElementId",value:p}]),null;var u,d=l.entryWrap,y=re(a,this.props.isRTL),f=!1;i instanceof X.e&&(y=Object(n.__assign)(Object(n.__assign)({},re(a,this.props.isRTL)),l.entryTitleStyle),f=!0,u=i.pinStatus);var b=i.title,m=i.subActionDescriptor;if(void 0===u)b=m&&m.narratorTitle&&String.format(m.narratorTitle,i.title);else{var S=u?Object(k.c)(this.props.resourceStrings,M.m):Object(k.c)(this.props.resourceStrings,M.x);b=String.format(S,i.title)}var _=null;m&&m.dropdownInfo&&(_=m.dropdownInfo.isOpened);var w=!ce.a.getInstance().get_IsIOS(),I=this.props.designLanguage;return r.createElement(v.a,{key:"sitemap-sitemapAreaEntry-listItem",style:ne(this.props.theme,I,0,this.state),onClick:this._onClickHandler,accessibilityLabel:b,title:i.title,dataText:i.title,tabIndex:c?0:-1,onKeyDown:this.onKeyDownHandler,onFocus:this._onFocus,onBlur:this._onBlur,id:this.props.sitemapRowId,testhooks:(e={id:this.props.sitemapRowId},e[g.a.LearningPathDOMAttributeSuffix]="sitemap-entity-"+i.id,e),describedByElementId:p,accessibilityExpanded:_,ref:function(e){return t._itemRef=e}},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,style:this._addContrastRule(oe(this.props.theme,I,this.state,this.props.isRTL),i,this.props.theme,!0)},this._renderSubAction(this.props.theme,I,this.state),r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:se(this.props.theme,this.props.isRTL),accessibilityHidden:w},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:d},r.createElement(h.a,{key:"sitemap-sitemapAreaEntry-text",style:y},i.title)),this._renderOfflineStatusIcon(f,i.title))),this._getNarratorElement(p,m))},t.prototype._getNarratorElement=function(e,t){return e&&""!==e?r.createElement(h.a,{key:e,id:e,style:{display:"none"},accessibilityLabel:t&&t.subactionAccessibilityLabel||""}," ",t&&t.subactionAccessibilityLabel||""," "):null},t.prototype._getIcon=function(e,t){if(e)switch(e.type){case f.b:return r.createElement(f.b,{type:Number(e.value),style:t});case U.a:return r.createElement(Y.a,{source:e.value,style:t,highContrast:this.props.isHighContrast,useImgInIE:!0});case J.a:return r.createElement(J.a,{entityReference:e.entityReference,hasPrimaryImageField:e.hasPrimaryImageField,imageSrc:e.imageSrc,accessibilityHidden:!0,entityPrimaryField:e.entityPrimaryField,customEntityIcon:e.customEntityIcon,style:this.props.customStyles.entryImageStyle});case"CssIcon":var o=Object(n.__assign)(Object(n.__assign)({},e.value),t);return r.createElement(h.a,{style:o});case null:return e.value}},t.prototype._renderOfflineStatusIcon=function(e,t){var o=this.props.entityOfflineStatus;if(o===Z.a.NotAvailable||e)return null;var n="",i="";return o===Z.a.Enabled?(n=Object(k.c)(this.props.resourceStrings,$.b),i=t+"-"+$.b):(n=Object(k.c)(this.props.resourceStrings,$.g),i=t+"-"+$.g),r.createElement(h.a,{key:"sitemap-offlineStatus-icon",style:ie(o,this.props.theme),accessibilityLabel:n,testhooks:{id:i}},G.b[Z.a[o]])},t.prototype._renderSubAction=function(e,t,o){var i,a=this,l=this.props,c=l.entry,p=o&&o.isMouseOnButton,d=l.customStyles.entrySubActionIconStyles,y=l.customStyles.entrySubActionButtonStyle;if(p){var f={":hover":{backgroundColor:t?t.Components.Navigation.Rest.BackgroundColor:e.colors.SiteMap.RefreshedPinUnpinFill}};y=Object(n.__assign)(Object(n.__assign)({},l.customStyles.entrySubActionButtonStyle),f)}if(i=Object(n.__assign)(Object(n.__assign)({},l.customStyles.entrySubActionWrapStyle),{visibility:this.state.isKeyboardFocused?"visible":"hidden"}),!c.subActionDescriptor)return r.createElement(s.a,{style:i},r.createElement(u.a,{style:y,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,tabIndex:-1},r.createElement(h.a,{style:d},this._renderSubActionIcon())));var b=null;return c.subActionDescriptor.dropdownInfo&&(b=c.subActionDescriptor.dropdownInfo.isOpened),r.createElement(s.a,{style:i},r.createElement(u.a,{onClick:this._onSubActionClickHandler,style:y,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,onKeyDown:this.onSubAtionKeyDownHandler,ref:function(e){return a._subButtonRef=e},tabIndex:-1,testhooks:{id:"sitemap-area-entry-subaction-btn"},accessibilityLabel:c.subActionDescriptor.narratorTitle,describedByElementId:this.props.sitemapRowId,accessibilityExpanded:b,title:c.subActionDescriptor.narratorTitle},r.createElement(h.a,{style:d},this._renderSubActionIcon())))},t.prototype._renderSubActionIcon=function(){var e=this.props.entry,t=function(e){var t="16px";return e.subActionDescriptor&&!e.subActionDescriptor.dropdownInfo||(t="12px"),{width:t,height:t,fontSize:t,paddingRight:"0px"}}(e);if(!e.subActionDescriptor){var o={type:f.b,value:"200"};return this._getIcon(o,t)}return this._getIcon(e.subActionDescriptor.icon,t)},t.prototype._addContrastRule=function(e,t,o,n){var r=t.icon.type;if(!r||r!==U.a||this.props.isHighContrast)return e;var i=n?o.colors.NavBar.NavBar1.Fill.toString():o.colors.QuickLaunchBar;return Object(w.c)(e,i,n,o.colors.SiteMap.RefreshedGroupText)},t}(r.Component);de.contextType=ae.a;var he=Object(a.a)((function(){var e=null,t=null;return function(o,n){var r=n?n.entry:null,i=r?Object(Z.e)(o,r.entityTypeName):Z.a.NotAvailable,s=!e||null===t,a=i===t,l=Object(ue.e)(o),c=Object(A.b)(o)?Object(A.a)(o):null;return!s&&a||(t=i,e={theme:Object(E.a)(o),designLanguage:c,customStyles:te(o),entityOfflineStatus:i,resourceStrings:Object(k.e)(o,[$.b,$.g,M.l,M.m,M.x]),isRTL:Object(I.g)(o),isHighContrast:Object(ee.n)(),isSitemapInFlyout:l}),e}}),(function(e){return{execute:function(t){e(t)},toggleSitemap:function(){e(Object(pe.b)())}}}))(de),ye=o("9r0m"),fe=o("pWhJ"),be=o("e5L/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function me(e){return e?"sitemap-entity-"+e.id:""}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ge(e,t,o){var n=t&&t.length?t.length:null,r=o?"auto":"0px";return o&&n&&(r="calc("+n+" * "+e.sizes.Measures.Measure250+")"),{overflow:"hidden",height:r,width:"100%",paddingTop:1,paddingBottom:1,transitionProperty:"height",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.16,0.67,0.12,0.99)",transitionDelay:"0ms"}}function Se(e){return{display:"inline-block",fontSize:"1rem",color:e.colors.BaseColor.Grey.Grey5,marginLeft:e.sizes.Measures.Measure100,marginRight:e.sizes.Measures.Measure100,marginTop:e.sizes.Measures.Measure050,fontFamily:e.fontFamilies.Regular}}var ve=function(e){function t(o){var n=e.call(this,o)||this;n._noItemsId=t._NO_ITEMS_ID_PART+o.relativeToEntryId;var r=ye.a.newGuid().guid;return n._describeAreaId="sitemap-sitemapDropDown-group-"+r.toString()+"-narrator",n.keyDownHandler=n.keyDownHandler.bind(n),n}return Object(n.__extends)(t,e),t.prototype.keyDownHandler=function(e){var t=e.target;if(t)switch(Object(le.e)(e.nativeEvent)){case b.a.DownArrow:e.stopPropagation(),e.preventDefault();var o=t.nextElementSibling;o&&o.focus();break;case b.a.UpArrow:e.stopPropagation(),e.preventDefault();var n=t.previousElementSibling;n&&n.focus();break;case b.a.Home:if(t.parentElement){e.stopPropagation(),e.preventDefault();var r=t.parentElement.firstElementChild;r&&r.focus()}break;case b.a.End:if(t.parentElement){e.stopPropagation(),e.preventDefault();var i=t.parentElement.lastElementChild;i&&i.focus()}}},t.prototype._renderSitemapDropdown=function(e){if(!e)return null;var o=this.props,n=o.theme,i=o.accessibilityLabel,s=o.dropdownRecents;if(!s||0===s.length){var a=this.props.relativeToEntryId===be.c?Object(k.c)(this.props.resourceStrings,M.k):String.format(Object(k.c)(this.props.resourceStrings,M.j),Object(k.c)(this.props.resourceStrings,M.s));return r.createElement(v.a,{key:t._NO_ITEMS_LISTITEM_KEY,style:{width:"100%",display:"flex",cursor:"pointer",backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted white"}},role:c.r},r.createElement(h.a,{key:this._noItemsId,testhooks:{id:this._noItemsId},style:Se(n),role:c.r},a))}return r.createElement(_.a,{key:"sitemap-sitemapDropDown-"+this.props.parentEntryId,style:{overflow:"hidden",listStyleType:"none",display:"block",width:"100%","> li > *":{boxSizing:"border-box"}},accessibilityLabel:i},this._renderRecentItems(s))},t.prototype._renderRecentItems=function(e){var t=this;return e.map((function(e,o){var n=me(e);return r.createElement(he,{key:o,entry:e,isTabIndexZero:!!t.props.isNewSitemapKeyboardMode&&t.props.focusedRowId===n,describedByElementId:0===o?t._describeAreaId:"",sitemapRowId:n,onKeyboardFocus:t.props.onKeyboardFocus})}))},t.prototype.render=function(){var e=this.props.dropdownOpened&&this.props.parentEntryId===this.props.relativeToEntryId;return r.createElement(s.a,{style:ge(this.props.theme,this.props.dropdownRecents,e),onKeyDown:this.props.isNewSitemapKeyboardMode?void 0:this.keyDownHandler},this._renderSitemapDropdown(e))},t._NO_ITEMS_ID_PART="sitemap-sitemapdropdown-noitems-",t._NO_ITEMS_LISTITEM_KEY=t._NO_ITEMS_ID_PART+"-listItem",t}(r.Component);ve.displayName="SitemapRecentsDropdown";var _e=Object(a.a)((function(){var e=null;return function(t){var o,n,r=Object(Q.c)(t),i=r&&r.isOpened;if(i){o=r.relativeToEntryId;var s=null;r.relativeToEntryId===be.c?s=Object(fe.a)(t):r.relativeToEntryId===be.a&&(s=Object(Q.g)(t)),n=s?s.map((function(e){return X.e.FromStateItem(e,!0,t)})):[]}if(e){if(!i&&!e.dropdownOpened)return e;if(o===e.relativeToEntryId&&n.length===e.dropdownRecents.length)if(n.every((function(t,o){return t.title===e.dropdownRecents[o].title&&t.pinStatus===e.dropdownRecents[o].pinStatus})))return e}return e={theme:Object(E.a)(t),dropdownOpened:i,relativeToEntryId:o,dropdownRecents:n,resourceStrings:Object(k.e)(t,[M.s,M.k,M.j])}}}))(ve),we=o("0OS1");function Ie(e,t){var o=e?e.Components.Navigation.Rest.IconColor:t.colors.SiteMap.RefreshedBarItemIcon;return{entryWrap:{flexGrow:1,overflow:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionIconStyles:{fontSize:t.fontSizes.Font150},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:o,alignItems:"center",paddingLeft:"0px",paddingRight:"0px"}}}function Ee(e,t,o){if(o){var n=e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,r=e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill;return{display:"flex",width:"100%",height:t.sizes.Measures.Measure250,minHeight:t.sizes.Measures.Measure250,color:n,backgroundColor:r,justifyContent:"space-between",":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}var i=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,s=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill,a=e?e.Components.Navigation.Rest.Hover.TextColor:i;return{display:"flex",width:"100%",height:t.sizes.Measures.Measure250,minHeight:t.sizes.Measures.Measure250,color:i,justifyContent:"space-between",":hover":{color:a,backgroundColor:s,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}function Ce(e,t,o){var n=o.colors.SiteMap.EntityOfflineStatusIcon;return{fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",lineHeight:"16px",marginLeft:"auto",width:o.sizes.SiteMap.EntityOfflineStatusIconWidth,color:t===Z.a.Enabled?n.Enabled:n.Disabled,fontSize:o.fontSizes.SiteMapOfflineStatusIcon,flexShrink:0}}function Me(e,t,o){return{display:"flex",paddingLeft:o?0:t.sizes.Measures.Measure025,paddingRight:o?t.sizes.Measures.Measure025:0,justifyContent:"space-between",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"}}function ke(e,t,o,n){var r=e?e.Components.Navigation.Selected.PivotColor:"#0066FF",i=e?r:t.borders.Border06;return{display:"inline-block",height:t.sizes.Measures.Measure150,marginLeft:o?"6.5px":"none",marginRight:o?"none":"6.5px",borderLeft:i,borderRight:i,borderRadius:t.borders.Border06Radius,opacity:n?1:0,transition:"opacity 200ms;",backgroundColor:r}}function Oe(e,t,o){if(o){var n=e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,r=e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString();return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:n,backgroundColor:r,":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}var i=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,s=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString(),a=e?e.Components.Navigation.Rest.Hover.TextColor:t.colors.SiteMap.RefreshedGroupText;return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:i,backgroundColor:"transparent",":hover":{color:a,backgroundColor:s,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}var Ae={display:"flex",width:"100%",justifyContent:"space-between"},xe={flexGrow:0,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"},Re=o("zrMA"),Ne=o("mGpW"),Te=o("Cjse"),Be={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",margin:"auto"},De={fontSize:"14px",height:21};function je(e,t){var o,n=t?"paddingRight":"paddingLeft";return(o={fontFamily:"CRM MDL2",fontSize:"14px",width:"16px",height:e.sizes.Measures.Measure150,display:"flex",alignItems:"center"})[n]=5,o}var Le=function(e){function t(t,o){var n=e.call(this,t)||this;return n._onClickHandler=n._onClickHandler.bind(n),n._onKeyDownHander=n._onKeyDownHander.bind(n),M.w.some((function(e){return!Object(k.c)(t.resourceStrings,e)}))&&t.retrieveResourceStrings(M.w),n}return Object(n.__extends)(t,e),t.prototype._onClickHandler=function(e){this.props.openAppsDialog(),e.preventDefault(),e.stopPropagation()},t.prototype._onKeyDownHander=function(e){e.keyCode!==b.a.Enter&&e.keyCode!==b.a.Space||e.target.click()},t.prototype.render=function(){var e,t,o,n=Object(k.c)(this.props.resourceStrings,M.b),i=Object(k.c)(this.props.resourceStrings,M.a);return r.createElement(u.a,{id:x.g,style:(e=this.props.theme,t=this.props.overwriteStyle,o={display:"block",cursor:"pointer",backgroundColor:"transparent",height:42,width:80,borderStyle:"none",flexShrink:0,":hover":{"> div":{backgroundColor:e.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",borderRadius:"2px"}},padding:6,color:"#2266E3",fontWeight:400},t&&Object.assign(o,t),o),onClick:this._onClickHandler,onKeyDown:this._onKeyDownHander,accessibilityLabel:n,title:n},r.createElement(s.a,{style:Be},r.createElement(h.a,{style:De},i),r.createElement(h.a,{style:je(this.props.theme,this.props.isRTL)},r.createElement(f.b,{type:this.props.isRTL?y.a.BackButtonWithoutBorder:y.a.Forward}))))},t}(r.Component);Le.contextType=ae.b;var Fe=Object(a.a)((function(){var e=Object(k.h)();return function(t){var o=e(t,M.w);return{theme:Object(E.a)(t),resourceStrings:o,isRTL:Object(I.g)(t)}}}),(function(e){return{retrieveResourceStrings:function(t){return e(Object(Ne.e)(t))},openAppsDialog:function(){return e(Object(Te.b)())}}}))(Le),Pe=function(e){function t(t,o){var n=e.call(this,t)||this;return n._tracer=null,n._tracer=o.TraceManager.getTracer(x.l),n.state={isKeyboardFocused:!1,forceHideTooltip:!1},n._onKeyboardFocus=n._onKeyboardFocus.bind(n),n._onKeyboardBlur=n._onKeyboardBlur.bind(n),n._onPointerEnter=n._onPointerEnter.bind(n),n._onPointerLeave=n._onPointerLeave.bind(n),n._onKeyDownHandler=n._onKeyDownHandler.bind(n),n._onClickHandler=n._onClickHandler.bind(n),n._onSubActionClickHandler=n._onSubActionClickHandler.bind(n),n._closeSitemapDuringNavigation=n._closeSitemapDuringNavigation.bind(n),n}return Object(n.__extends)(t,e),t.prototype.render=function(){return 0===this.props.panelState?this._renderRowForCollapsedSitemap():this._renderRowForExtendedSitemap()},t.prototype._closeSitemapDuringNavigation=function(){this.props.isSitemapInFlyout&&this.props.toggleSiteMap()},t.prototype._onClickHandler=function(e){var t=this;void 0===e&&(e=null),e&&e.stopPropagation(),this.props.execute(this.props.entry.onClickHandler(!0,(function(){return t._closeSitemapDuringNavigation()}),q.b.SiteMapSubArea,V.c))},t.prototype._onPointerEnter=function(){this.props.onPointerEnter&&this.props.onPointerEnter(this.props.entry.id)},t.prototype._onPointerLeave=function(){this.props.onPointerLeave&&this.props.onPointerLeave(this.props.entry.id)},t.prototype._onKeyboardFocus=function(){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId)},t.prototype._onKeyboardBlur=function(e){this.setState({forceHideTooltip:!1,isKeyboardFocused:!1})},t.prototype._focus=function(){var e=this.props.sitemapRowId;if(this.props.sitemapRowId){var t=document.getElementById(e),o=!t.nextSibling;window.setTimeout((function(){o&&(t=document.getElementById(e)),t&&t.focus()}))}},t.prototype._onKeyDownHandler=function(e){var t=e.target;switch(Object(le.e)(e.nativeEvent)){case b.a.Enter:e.stopPropagation(),e.preventDefault(),this._onClickHandler();break;case b.a.Space:e.stopPropagation(),e.preventDefault(),this.props.entry.subActionDescriptor?this._onSubActionClickHandler():this._onClickHandler();break;case b.a.RightArrow:this.props.entry.subActionDescriptor&&this.props.entry.subActionDescriptor.dropdownInfo&&(this.props.entry.subActionDescriptor.dropdownInfo.isOpened?this._focusToFirstChild(t):this._onSubActionClickHandler(null));break;case b.a.LeftArrow:this.props.entry.subActionDescriptor&&this.props.entry.subActionDescriptor.dropdownInfo&&this.props.entry.subActionDescriptor.dropdownInfo.isOpened&&this._onSubActionClickHandler(null);break;case b.a.Escape:if(0===this.props.panelState){var o=i.findDOMNode(this._wrapperRef);o&&o.focus(),this.setState({forceHideTooltip:!0})}break;case b.a.DownArrow:this._focusToFirstChild(t)}},t.prototype._focusToFirstChild=function(e){if(e&&e.children.length>1&&e.children[1].children.length>0&&e.children[1].children[0].children.length>0){var t=e.children[1].children[0].children[0];t&&t.focus()}},t.prototype._onSubActionClickHandler=function(e){void 0===e&&(e=null),e&&e.stopPropagation();var t=this.props.entry.subActionDescriptor.onClickHandler;t&&this.props.execute(t()),this._focus()},t.prototype._renderRowForExtendedSitemap=function(){var e,t=this.props,o=t.entry,n=t.isTabIndexZero,i=t.describedByElementId,s=t.accessibilityRole;if(!o)return this._tracer.error("SubAreaDescriptor passed in to SitemapRow is null",[{name:"panelState",value:this.props.panelState},{name:"describedByElementId",value:i}]),null;var a=o.title,l=o.subActionDescriptor;l&&l.narratorTitle&&(a=String.format(l.narratorTitle,o.title));var c,p,u=null;return l&&l.dropdownInfo&&(u=l.dropdownInfo.isOpened),r.createElement(v.a,{key:"sitemap-sitemapAreaEntry-listItem",style:(c=this.props.designLanguage,p=this.props.theme,{width:"100%",minHeight:"35px",display:"flex",alignItems:"center",cursor:"pointer",color:c?c.Components.Navigation.Selected.PivotColor:p.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+(c?c.Components.Navigation.Selected.Focus.BorderColor:p.colors.BaseColor.Grey.Grey5),outlineOffset:"-1px"}}),onClick:this._onClickHandler,accessibilityLabel:a,title:o.tooltip||o.title,dataText:o.title,tabIndex:n?0:-1,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,id:this.props.sitemapRowId,testhooks:(e={id:this.props.sitemapRowId},e[g.a.LearningPathDOMAttributeSuffix]="sitemap-entity-"+o.id,e),describedByElementId:i,accessibilityExpanded:u,role:s,isSelected:this.props.entry.isSelected},this._renderRowContent(),this._renderDropdown())},t.prototype._renderRowContent=function(){var e,t=this.props,o=t.entry,i=t.designLanguage,a=t.theme,l=t.customStyles.entryWrap,c={color:(e=i)?e.Components.Navigation.Rest.IconColor:void 0,width:"16px",minWidth:"16px",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"},p=Object(n.__assign)({},c),u=function(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontFamily:t.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}(0,a),d=!ce.a.getInstance().get_IsIOS();return r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",style:this._addContrastRule(Ee(this.props.designLanguage,this.props.theme,o.isSelected),o,this.props.theme,!0)},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:Me(this.props.designLanguage,this.props.theme,this.props.isRTL),accessibilityHidden:d},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:ke(this.props.designLanguage,this.props.theme,this.props.isRTL,o.isSelected),accessibilityHidden:d}),r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:l},r.createElement(h.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule(p,o,this.props.theme)},this._renderIcon()),r.createElement(h.a,{key:"sitemap-sitemapAreaEntry-text",style:u},o.title)),this._renderOfflineStatusIcon(o.title)),this._renderAppsButton(),this._renderSubAction())},t.prototype._renderIcon=function(){var e=this.props.entry,t={width:this.props.theme.sizes.Icon.MinWidth,height:this.props.theme.sizes.Icon.MinHeight,verticalAlign:"middle"};return this._getIcon(e.icon,t)},t.prototype._getIcon=function(e,t){if(e){var o=this.props.entry.tooltip||this.props.entry.title;return Object(Re.a)({title:o,icon:e,styles:t,isHighContrast:this.props.isHighContrast,customStyles:this.props.customStyles})}},t.prototype._renderOfflineStatusIcon=function(e){var t=this.props.entityOfflineStatus;if(t===Z.a.NotAvailable)return null;var o="",n="";return t===Z.a.Enabled?(o=Object(k.c)(this.props.resourceStrings,$.b),n=e+"-"+$.b):(o=Object(k.c)(this.props.resourceStrings,$.g),n=e+"-"+$.g),r.createElement(h.a,{key:"sitemap-offlineStatus-icon",style:Ce(this.props.designLanguage,t,this.props.theme),accessibilityLabel:o,testhooks:{id:n}},G.b[Z.a[t]])},t.prototype._renderSubAction=function(){var e,t,o,i=this.props.entry,a=this.props.customStyles.entrySubActionIconStyles,l=this.props.customStyles.entrySubActionButtonStyle;return i.subActionDescriptor?(e=Object(n.__assign)(Object(n.__assign)({},(this.props.designLanguage,t=this.props.theme,{marginLeft:(o=this.props.isRTL)?t.sizes.Measures.Measure100:"0px",marginRight:o?"0px":t.sizes.Measures.Measure100,position:"relative",flexGrow:0,flexShrink:0})),i.subActionDescriptor.icon.dynamicStyles),r.createElement(s.a,{style:e},r.createElement(s.a,{onClick:this._onSubActionClickHandler,style:l,testhooks:{id:"sitemap-area-entry-subaction-btn"},title:i.subActionDescriptor.toolTip},r.createElement(h.a,{style:a},this._renderSubActionIcon())))):null},t.prototype._renderAppsButton=function(){return this.props.renderAppsButton?r.createElement(Fe,{key:"sitemap-apps",overwriteStyle:{height:"100%",padding:0}}):null},t.prototype._renderSubActionIcon=function(){var e,t=this.props.entry,o={width:"16px",height:"16px",fontSize:"16px"};if(!t.subActionDescriptor){var n={type:f.b,value:"200"};return this._getIcon(n,o)}return e=t.subActionDescriptor.icon,this._getIcon(e,o)},t.prototype._renderDropdown=function(){var e=this.props.entry;return e.subActionDescriptor&&e.subActionDescriptor.dropdownInfo?r.createElement(_e,{key:"sitemap-sitemapAreaEntry-recentsDropdown",parentEntryId:e.id,accessibilityLabel:e.title.toString(),isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,focusedRowId:this.props.focusedRowId,onKeyboardFocus:this.props.onKeyboardFocus}):null},t.prototype._renderRowForCollapsedSitemap=function(){var e,t,o,n,i=this,a=this.props,l=a.entry,c=a.accessibilityRole;return r.createElement(v.a,{ref:function(e){return i._wrapperRef=e},key:"sitemap-sitemapAreaEntry-listItem",style:this._addContrastRule(Oe(this.props.designLanguage,this.props.theme,this.props.entry.isSelected),l,this.props.theme,!0),onClick:this._onClickHandler,accessibilityLabel:l.title,dataText:l.title,testhooks:(e={id:"quick-launch-entity-"+l.id},e[g.a.LearningPathDOMAttributeSuffix]="sitemap-ql-entity-"+l.id,e),tabIndex:this.props.isTabIndexZero?0:-1,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,title:l.title,role:c,onPointerEnter:this._onPointerEnter},r.createElement(s.a,{key:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-anchor-"+this.props.entry.id,style:{width:0,height:"100%"}}),r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:Ae,accessibilityHidden:!0},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:(this.props.designLanguage,o=this.props.theme,n=this.props.isRTL,{display:"flex",paddingLeft:n?0:o.sizes.Measures.Measure025,paddingRight:n?o.sizes.Measures.Measure025:0,justifyContent:"flex-start",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"}),accessibilityHidden:!0},r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:ke(this.props.designLanguage,this.props.theme,this.props.isRTL,this.props.entry.isSelected),accessibilityHidden:!0}),r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:xe,title:l.tooltip?l.tooltip:l.title},r.createElement(h.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule((t=this.props.designLanguage,this.props.theme,{color:t?t.Components.Navigation.Rest.IconColor:void 0,fontFamily:"Dyn CRM Symbol",textAlign:"center",width:"100%",fontSize:"16px",flexShrink:0,display:"flex",justifyContent:"center"}),l,this.props.theme)},this._renderIcon())))),(this.props.isHovered||this.state.isKeyboardFocused)&&!this.state.forceHideTooltip&&this._renderItemFlyout())},t.prototype._renderItemFlyout=function(){var e=this.props.entry.title,t=this.props.entry.subActionDescriptor;t&&t.narratorTitle&&(e=String.format(t.narratorTitle,this.props.entry.title));var o,i,s,a,l,c={onPointerLeave:this._onPointerLeave,onClick:this._onClickHandler,accessibilityLabel:e};return r.createElement(S.a,Object(n.__assign)({positionType:"relative",relativeToElementId:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-"+this.props.entry.id,key:"quick-launch-flyout-"+this.props.entry.id,flyoutDirection:this.props.isRTL?S.b.left:S.b.right,onOutsideClick:this._onPointerLeave,flyoutStyle:(o=this.props.designLanguage,i=this.props.theme,s=o?o.Components.Navigation.Rest.Hover.TextColor:i.colors.SiteMap.RefreshedRow.Text,a=o?o.Components.Navigation.Rest.Hover.BackgroundColor:i.colors.BaseColor.White,l=o?o.Components.Navigation.Rest.Focus.BorderColor:i.colors.BaseColor.Grey.Grey5,{width:"16rem",minHeight:"35px",display:"flex",alignItems:"center",cursor:"pointer",color:s,backgroundColor:a,boxShadow:we.a.shadows.Shadow01,flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+l,outlineOffset:"-1px"}})},c),this._renderRowContent())},t.prototype._addContrastRule=function(e,t,o,n){var r=t.icon.type;if(!r||r!==U.a||this.props.isHighContrast)return e;var i=n?o.colors.SiteMap.RefreshedRow.Fill.toString():o.colors.SiteMap.RefreshedDefault;return Object(w.c)(e,i,n,o.colors.SiteMap.RefreshedGroupText)},t}(r.Component);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */Pe.contextType=ae.a;var He=Object(a.a)((function(){var e=null,t=null;return function(o,n){var r=n?n.entry:null,i=r?Object(Z.e)(o,r.entityTypeName):Z.a.NotAvailable,s=!e||null===t,a=i===t,l=Object(ue.e)(o);if(s||!a){t=i;var c=Object(E.a)(o),p=Object(A.b)(o)?Object(A.a)(o):null;e={theme:c,designLanguage:p,customStyles:Ie(p,c),entityOfflineStatus:i,resourceStrings:Object(k.e)(o,[$.b,$.g]),isRTL:Object(I.g)(o),isHighContrast:Object(ee.n)(),isSitemapInFlyout:l}}return e}}),(function(e){return{execute:function(t){e(t)}}}))(Pe);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ke(e,t,o){return{color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedGroupText,display:"flex",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Weighted,fontWeight:e.sizes.FontWeights.Semibold,minHeight:e.sizes.Measures.Measure250,height:"auto",marginTop:e.sizes.Measures.Measure025,marginBottom:e.sizes.Measures.Measure025,alignItems:"center",justifyContent:"flex-start",marginLeft:o?e.sizes.Measures.Measure050:e.sizes.Measures.Measure100,marginRight:o?e.sizes.Measures.Measure100:e.sizes.Measures.Measure050}}function ze(e,t,o,n,r){var i={flexGrow:0};if(n||1!==o||(i.marginBottom=e.sizes.Measures.Measure100),!r&&0===o){var s=t?t.Components.Navigation.Rest.DividerColor:e.colors.SiteMap.CollapsedGroupSeparator;i.borderTop="1px solid "+s}return i}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var We=function(e){function t(t){var o=e.call(this,t)||this;return o._uniqueId=ye.a.newGuid().guid,o._labelId="sitemap-sitemapAreaGroup-group-"+o._uniqueId,o._describeAreaId=o._labelId+"-narrator",o}return Object(n.__extends)(t,e),t.prototype._renderSitemapAreaEntries=function(){var e=this,t=this.props,o=t.sitemapGroup,n=t.index,i=t.isNewSitemapKeyboardMode,s=0===n,a=!1,l=this.context.toggleSiteMap;return o.entries.map((function(t,o){var n;t.subActionDescriptor&&!a&&(a=!0,n=e._describeAreaId);var p=me(t);return r.createElement(He,{key:o,entry:t,toggleSiteMap:l,isTabIndexZero:i?e.props.focusedRowId===p:s&&0===o,describedByElementId:n,panelState:e.props.panelState,accessibilityRole:c.x,isHovered:e.props.hoveredRowId===t.id,sitemapRowId:p,isNewSitemapKeyboardMode:i,onPointerEnter:e.props.onRowPointerEnter,onPointerLeave:e.props.onRowPointerLeave,onKeyboardFocus:e.props.onKeyboardFocus})}))},t.prototype.render=function(){var e=this.props,t=e.sitemapGroup,o=e.theme,n=e.isRTL,i=e.isTablet,s=e.isLastGroup,a=t.title,l=i?{listStyleType:"none",flexDirection:"column",width:"270px"}:{listStyleType:"none",flexDirection:"column",flexShrink:0},p=this.props.designLanguage,u=ze(o,p,this.props.panelState,s,!1),d=a.replace(" ","");return r.createElement(v.a,{key:"sitemap-sitemapAreaGroup-listItem",style:u,accessibilityLabel:d,accessibilityExpanded:!0,role:c.x},1===this.props.panelState&&r.createElement(h.a,{key:this._labelId,testhooks:{id:"sitemap-sitemapAreaGroup-"+d},style:Ke(o,p,n),role:c.r}," ",a),r.createElement(h.a,{key:this._describeAreaId,id:this._describeAreaId,style:{display:"none"},accessibilityLabel:t.narratorTitle||""}," ",t.narratorTitle||""," "),r.createElement(_.a,{key:"sitemap-sitemapAreaGroup-groupList",accessibilityLabel:a,style:l,role:c.h},this._renderSitemapAreaEntries()))},t}(r.Component);We.contextType=ae.b;var Ge=o("O+GR"),Ue=o("JlqV"),qe=o("/3Li"),Ve=o("0u+G"),Ze=o("aPRd"),Qe=function(){function e(e){void 0===e&&(e=null),this._entityNavBar=document.getElementById(x.k),this._currElement=e}return e.prototype._isElementExpanded=function(e){return!(!e||"true"!==e.getAttribute("aria-expanded")&&"true"!==e.getAttribute("data-expanded"))},e.prototype._getParents=function(e){for(var t=[],o=e;o&&o.parentElement;)o=o.parentElement,t.push(o);return t},e.prototype.getNextSibling=function(e,t){if(void 0===e&&(e=this._currElement),void 0===t&&(t=!0),!e)return null;var o=e.nextElementSibling,n=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&o)return o;if(t&&this._isElementExpanded(e))o=e.getElementsByTagName("li")[0];else if(!o&&this._isElementExpanded(n[2]))o=this.getNextSibling(n[2],!1);else if(!o&&n[1]){var r=n[1].nextElementSibling,i=r?r.getElementsByTagName("li"):null;o=i?i[0]:null}return o},e.prototype.getPrevSibling=function(e){if(void 0===e&&(e=this._currElement),!e)return null;var t=e.previousElementSibling,o=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&t)return t;if(this._isElementExpanded(t)){var n=t.getElementsByTagName("li");if(n.length)return n[n.length-1]}if(t)return t;if(this._isElementExpanded(o[2]))return o[2];if(o[1]){var r=o[1].previousElementSibling,i=r?r.getElementsByTagName("li"):null;if(i&&i.length)return i[i.length-1]}return null},e.prototype.getFirstItemOfEntityNavBar=function(){var e=this._entityNavBar?this._entityNavBar.firstChild:null,t=e?e.getElementsByTagName("li"):null;return t?t[0]:null},e.prototype.getLastItemofEntityNavBar=function(){var e=this._entityNavBar?this._entityNavBar.lastChild:null,t=e?e.getElementsByTagName("li"):null;return t&&t.length?t[t.length-1]:null},e}();var Xe=function(e){function t(t){var o=e.call(this,t)||this;return o.onKeyDownHandler=o.onKeyDownHandler.bind(o),o}return Object(n.__extends)(t,e),t.prototype._renderGroups=function(){var e=this,t=this.props,o=t.entryGroups,n=t.isRTL,i=t.isTablet;if(!o)return null;var s=o.length;return o.map((function(o,a){return r.createElement(We,{key:a,sitemapGroup:o,index:a,theme:t.theme,designLanguage:t.designLanguage,isRTL:n,isLastGroup:a===s-1,isTablet:i,panelState:e.props.panelState,hoveredRowId:e.props.hoveredRowId,isNewSitemapKeyboardMode:e.props.isNewSitemapKeyboardMode,focusedRowId:e.props.focusedRowId,onRowPointerEnter:e.props.onRowPointerEnter,onRowPointerLeave:e.props.onRowPointerLeave,onKeyboardFocus:e.props.onKeyboardFocus})}))},t.prototype.render=function(){return this.props.isNewSitemapKeyboardMode?this._renderGroups():r.createElement(v.a,{key:"sitemap-pane",role:c.x},r.createElement(_.a,{key:x.k,id:x.k,style:(e=this.props,{display:"block",width:"100%",listStyleType:"none",paddingTop:0===e.panelState?"0px":e.theme.sizes.Measures.Measure150,paddingBottom:e.theme.sizes.Measures.Measure150}),onKeyDown:this.onKeyDownHandler,role:c.h},this._renderGroups()));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var e},t.prototype.onKeyDownHandler=function(e){var t=e.target,o=new Qe(t),n=document.getElementById(x.k);switch(Object(le.e)(e.nativeEvent)){case b.a.DownArrow:n&&n.contains(t)&&(Ye(o.getNextSibling()),e.preventDefault());break;case b.a.UpArrow:n.contains(t)&&(Ye(o.getPrevSibling()),e.preventDefault());break;case b.a.Home:n.contains(t)&&Ye(o.getFirstItemOfEntityNavBar());break;case b.a.End:n.contains(t)&&Ye(o.getLastItemofEntityNavBar())}},t}(r.Component);function Ye(e){e&&e.focus()}function Je(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.title===t.title){var o=e.subActionDescriptor||null,n=t.subActionDescriptor||null;return e.isSelected===t.isSelected&&JSON.stringify(o)===JSON.stringify(n)}return!1}var $e=Object(a.a)((function(){var e=null,t=null,o=null;return function(n,r){var i,s=Object(Ue.b)(n),a=Object(qe.a)(n),l=Object(Ze.c)(n),c=Object(E.a)(n);if(!t||!e||o!==s)return t=r.areaId,o=s,e={entryGroups:Object(Ge.l)(n,r.areaId),isRTL:Object(I.g)(n),isTablet:a===Ve.b.Native&&l>c.sizes.Breakpoints.DimensionS};if(r.areaId===t){i=Object(Ge.l)(n,r.areaId);for(var p=!1,u=function(t){var o=e.entryGroups.find((function(e){return e.title===i[t].title}));if(!o||i[t].entries.length!==o.entries.length)return p=!0,"break";for(var n=0;n<i[t].entries.length;n++){if(!Je(i[t].entries[n],o.entries[n])){p=!0;break}}},d=0;d<i.length;d++){if("break"===u(d))break}if(!p)return e}return t=r.areaId,o=s,e={entryGroups:i||Object(Ge.l)(n,r.areaId),isRTL:Object(I.g)(n),isTablet:a===Ve.b.Native&&l>c.sizes.Breakpoints.DimensionS}}}))(Xe),et=o("50Zs"),tt=o("ADO8"),ot=o("Yseb"),nt=o("aimL"),rt=o("uvl8"),it=o("UchK"),st=o("+r/t"),at=o("pLx/"),lt=o("cZkS"),ct=o("yZTI"),pt=o("sOTk"),ut=o("45T4"),dt=o("qC0c"),ht="Home_8E2112DC-AD90-40F5-BEBE-0A8D80785D75",yt={type:f.b,value:y.a.Home.toString()},ft={type:f.b,value:y.a.Recent.toString()},bt={type:f.b,value:y.a.Pinned.toString()},mt={type:f.b,value:y.a.RunQuery.toString()};function gt(e){return r.createElement(_.a,{key:"sitemap-sitemapAreaGroup-groupList",style:{listStyleType:"none",flexDirection:"column",flexShrink:0},role:c.h},function(e){var t={id:ht,entityTypeName:null,title:Object(nt.c)(e.resourceStrings,st.f),tooltip:Object(nt.c)(e.resourceStrings,st.e),icon:e.homeIcon,onClickHandler:function(){return Object(it.b)()}};r.useEffect((function(){!e.focusedRowId&&e.onKeyboardFocus&&e.isNewSitemapKeyboardMode&&e.onKeyboardFocus(me(t))}),[t,e]);var o=me(t);return r.createElement(He,{key:ht,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===o,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,accessibilityRole:c.x,isHovered:e.hoveredRowId===t.id,focusedRowId:e.focusedRowId,sitemapRowId:o,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus,renderAppsButton:e.shouldRenderAppsButton})}(e),function(e){if(0===e.panelState)return null;var t={id:be.c,entityTypeName:null,title:Object(nt.c)(e.resourceStrings,M.s),tooltip:Object(nt.c)(e.resourceStrings,M.v),icon:e.recentIcon,children:null,subActionDescriptor:e.recentSubAction,onClickHandler:function(){return Object(rt.b)(e.recentSubAction.dropdownInfo)}},o=me(t);return r.createElement(He,{key:be.c,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===o,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:o,accessibilityRole:c.x,onKeyboardFocus:e.onKeyboardFocus})}(e),function(e){if(0===e.panelState)return null;var t={id:be.a,entityTypeName:null,title:Object(nt.c)(e.resourceStrings,M.l),tooltip:Object(nt.c)(e.resourceStrings,M.p),icon:e.pinnedIcon,children:null,subActionDescriptor:e.pinnedSubAction,onClickHandler:function(){return Object(rt.b)(e.pinnedSubAction.dropdownInfo)}},o=me(t);return r.createElement(He,{key:be.a,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===o,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:o,accessibilityRole:c.x,onKeyboardFocus:e.onKeyboardFocus})}(e),function(e){if(e.isQueryPageEnabled){var t={id:be.b,entityTypeName:null,title:"Query",tooltip:"Query tooltip",icon:e.queryIcon,isSelected:e.isQuerySelected,onClickHandler:function(){return Object(at.a)()}},o=me(t);return r.createElement(He,{key:be.b,entry:t,panelState:e.panelState,accessibilityRole:c.x,isHovered:e.hoveredRowId===t.id,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:o,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===o,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus})}}(e))}function St(e,t,o){var n,r=t===be.c,i={isOpened:!1,entityTypeName:r?"Recent_C66859D8-C5F1-4C29-AB31-D1F1F522C6B8":"Pinned_0F52083C-5DA1-41B2-88A7-937955C71021",relativeToEntryId:t},s=Object(Q.c)(e);s&&s.entityTypeName===i.entityTypeName&&s.relativeToEntryId===i.relativeToEntryId&&(i.isOpened=s.isOpened),n=r?i.isOpened?M.t:M.u:i.isOpened?M.n:M.o;var a=Object(nt.c)(o,n);return{icon:{type:f.b,value:(i.isOpened?y.a.ChevronUp:y.a.ChevronDown).toString()},onClickHandler:function(){return Object(rt.b)(i)},dropdownInfo:i,toolTip:a}}gt.displayName="SitemapHomePane";var vt=Object(a.a)((function(){var e,t,o=Object(k.h)();return function(n,r){var i=o(n,[st.f,st.e,M.l,Ge.d,M.s,M.v,M.p,M.u,M.t,M.o,M.n]),s=St(n,be.c,i),a=St(n,be.a,i);e&&s.dropdownInfo.isOpened===e.dropdownInfo.isOpened||(e=s),t&&a.dropdownInfo.isOpened===t.dropdownInfo.isOpened||(t=a);var l=Object(dt.a)(n,lt.ab,lt.h),c=Object(ct.c)(n),p=Object(pt.l)(n,c),u=Object(pt.g)(n,c),d=p===ut.a||u&&u.isQueryMode,h=Object(ue.c)(n);return{homeIcon:yt,recentIcon:ft,recentSubAction:e,pinnedIcon:bt,pinnedSubAction:t,queryIcon:mt,isQueryPageEnabled:l,isQuerySelected:d,resourceStrings:i,shouldRenderAppsButton:h}}}))(gt),_t=o("3y+0"),wt=o("1W5w"),It=o("2n3f"),Et=o("1GLu"),Ct=o("miNs"),Mt=o("akzq"),kt=o("dMNk"),Ot=o("wQXd"),At=Object(p.a)(),xt=Object(p.a)(),Rt=function(e){function t(t){var o=e.call(this,t)||this;return o._updateSitemapBodyPanelContainerRef=o._updateSitemapBodyPanelContainerRef.bind(o),o._onRowPointerEnter=o._onRowPointerEnter.bind(o),o._onRowPointerLeave=o._onRowPointerLeave.bind(o),o._onKeyboardFocus=o._onKeyboardFocus.bind(o),o._globalKeyboadHandler=o._globalKeyboadHandler.bind(o),o._onOutsideClickHandler=o._onOutsideClickHandler.bind(o),o.onKeyDownHandler=o.onKeyDownHandler.bind(o),o.selectArea=o.selectArea.bind(o),o.state={hoveredRowId:void 0,focusedRowId:void 0},M.w.some((function(e){return!Object(k.c)(t.resourceStrings,e)}))&&t.retrieveResourceStrings(M.w),o}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this._globalKeyboadHandler)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._globalKeyboadHandler)},t.prototype.onKeyDownHandler=function(e){var t=e.target,o=new Qe(t),n=document.getElementById("siteMapPanelBodyDiv");switch(Object(le.e)(e.nativeEvent)){case Ct.a.DownArrow:n&&n.contains(t)&&(this._focusNotNull(o.getNextSibling()),e.preventDefault());break;case Ct.a.UpArrow:n.contains(t)&&(this._focusNotNull(o.getPrevSibling()),e.preventDefault());break;case Ct.a.Home:n.contains(t)&&this._focusNotNull(o.getFirstItemOfEntityNavBar());break;case Ct.a.End:n.contains(t)&&this._focusNotNull(o.getLastItemofEntityNavBar())}},t.prototype._focusNotNull=function(e){e&&e.focus()},t.prototype._globalKeyboadHandler=function(e){switch(Object(le.e)(e)){case Ct.a.Escape:this.setState({hoveredRowId:void 0})}},t.prototype.selectArea=function(e){this.props.selectedAreaId!==e&&(this.props.selectArea(e,this.props.siteMap),this.props.navigateToArea(e),this.setState({focusedRowId:void 0}))},t.prototype.componentDidUpdate=function(e,t){if(0===this.props.panelState&&1===e.panelState||e.selectedAreaId!==this.props.selectedAreaId){var o=i.findDOMNode(this._sitemapBodyContainer);o&&(o.scrollTop=0)}},t.prototype._mouseEnter=function(){O.a.SessionStart()},t.prototype._mouseExit=function(){O.a.SessionEnd()},t.prototype._renderSiteMap=function(){return r.createElement(s.a,{id:At,testhooks:{id:"navbar-container"},onMouseEnter:this._mouseEnter.bind(this),onMouseLeave:this._mouseExit.bind(this),semanticTag:"nav",role:c.p,accessibilityLabel:Object(k.c)(this.props.resourceStrings,M.g),style:this._getContainerStyle()},this.renderPanelHeader(),this.renderPanelBody(),this.renderPanelFooter())},t.prototype.renderPanelHeader=function(){return this.props.renderToggleButton?r.createElement(s.a,{key:"sitemap-header",style:{display:"flex",width:"100%",justifyContent:"space-between"}},r.createElement(ot.a,{key:"sitemap-toogle"})):null},t.prototype.renderPanelBody=function(){var e=this.props.designLanguage;return r.createElement(s.a,{key:"sitemap-panel-body",style:this._getsitemapPanelBodyDivStyle(),ref:this._updateSitemapBodyPanelContainerRef,id:"siteMapPanelBodyDiv"},r.createElement(_.a,{key:"sitemap-group-list",id:this.props.isNewSitemapKeyboardMode?x.k:void 0,labelledByElementId:x.g,role:c.w,style:{flexDirection:"column",listStyleType:"none",width:"100%"},onKeyDown:this.props.isNewSitemapKeyboardMode?this.onKeyDownHandler:void 0},r.createElement(v.a,{key:"sitemap-homepane",role:c.x,style:ze(this.props.theme,e,this.props.panelState,!1,!0)},r.createElement(vt,{key:"sitemap-navBar-areaPaneStaticNavBar",theme:this.props.theme,panelState:this.props.panelState,hoveredRowId:this.state.hoveredRowId,focusedRowId:this.state.focusedRowId,isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,onKeyboardFocus:this.props.isNewSitemapKeyboardMode?this._onKeyboardFocus:void 0,onRowPointerEnter:this._onRowPointerEnter,onRowPointerLeave:this._onRowPointerLeave})),this.props.selectedAreaId&&r.createElement($e,{key:"sitemap-navBar-areaPaneNavBar",areaId:this.props.selectedAreaId,theme:this.props.theme,designLanguage:e,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,hoveredRowId:this.state.hoveredRowId,focusedRowId:this.state.focusedRowId,isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,onKeyboardFocus:this.props.isNewSitemapKeyboardMode?this._onKeyboardFocus:void 0,onRowPointerEnter:this._onRowPointerEnter,onRowPointerLeave:this._onRowPointerLeave})))},t.prototype.renderPanelFooter=function(){var e=this.props.siteMap;return r.createElement(W,{siteMap:e,theme:this.props.theme,designLanguage:this.props.designLanguage,selectedAreaId:this.props.selectedAreaId,selectArea:this.selectArea,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,isRTL:this.props.isRTL,flyoutWidth:this.props.isInFlyoutMode?this.props.sitemapWidth:this.props.theme.sizes.SiteMap.RefreshedWidth})},t.prototype.render=function(){if(this.props.isSitemapPanelHidden)return null;if(this.props.isInFlyoutMode)return 1!==this.props.panelState?null:r.createElement(S.a,{id:xt,accessibilityModal:!0,positionType:"absolute",flyoutStyle:{width:this.props.sitemapWidth,minWidth:this.props.theme.sizes.SiteMap.RefreshedWidth},position:this._getFlyoutPosition(),onOutsideClick:this._onOutsideClickHandler},this._renderSiteMap(),r.createElement(Mt.a,{key:"accessibilityComponent",rootElementId:xt,shouldManageFocus:!0,isModal:!0}));var e=document.getElementById(tt.a);return e&&i.createPortal(this._renderSiteMap(),e)},t.prototype._onOutsideClickHandler=function(e){var t=e.target,o=document.getElementById(x.g);t&&!o.contains(t)&&o!==t&&this.props.toggleSitemap()},t.prototype._onRowPointerEnter=function(e){this.setState({hoveredRowId:e})},t.prototype._onRowPointerLeave=function(e){this.state.hoveredRowId===e&&this.setState({hoveredRowId:void 0})},t.prototype._getFlyoutPosition=function(){var e={bottom:0,top:this.props.headerHeight,left:0};return this.props.isRTL&&(e.left=void 0,e.right=0),e},t.prototype._onKeyboardFocus=function(e){this.state.focusedRowId!==e&&this.setState({focusedRowId:e})},t.prototype._getsitemapPanelBodyDivStyle=function(){return{overflowY:0===this.props.panelState?"hidden":"auto",overflowX:"hidden",flexGrow:1}},t.prototype._getContainerStyle=function(){var e=this.props,t=e.theme,o=e.isRTL,n=e.isEmbedded,r=this.props.designLanguage,i=n||o,s=n||!o;return{height:"100%",width:this._getContainerWidth(),flexDirection:"column",backgroundColor:r?r.Components.Navigation.Rest.BackgroundColor:t.colors.SiteMap.RefreshedDefault,borderLeft:i?t.borders.Border02:"none",borderRight:s?t.borders.Border02:"none",position:"relative"}},t.prototype._getContainerWidth=function(){return this.props.isInFlyoutMode?"100%":this.props.sitemapWidth},t.prototype._updateSitemapBodyPanelContainerRef=function(e){this._sitemapBodyContainer=e},t}(r.Component);function Nt(){var e=Object(k.h)();return function(t){var o=Object(l.b)(t),n=Object(E.a)(t),r=Object(A.b)(t)?Object(A.a)(t):null,i=e(t,M.w),s=Object(I.g)(t),a=Object(et.b)(t),c=Object(et.c)(t);return{siteMap:o,theme:n,designLanguage:r,resourceStrings:i,isRTL:s,isSitemapPanelHidden:a||c,selectedAreaId:Object(_t.a)(t),navigationType:Object(Et.a)(t),renderToggleButton:Object(ue.f)(t),panelState:Object(_t.d)(t),isInFlyoutMode:Object(ue.e)(t),sitemapWidth:Object(ue.a)(t),headerHeight:Object(kt.a)(t),isNewSitemapKeyboardMode:Object(ue.b)(t),isEmbedded:Object(Ot.c)(t)}}}function Tt(e){return{retrieveResourceStrings:function(t){return e(Object(Ne.e)(t))},navigateToArea:function(t){e(Object(It.a)(t,q.b.SiteMapSubArea))},selectArea:function(t,o){e(Object(wt.d)(t,o))},toggleSitemap:function(){e(Object(pe.b)())}}}Rt.displayName="SitemapPanel",Rt.contextType=ae.a;var Bt=Object(a.a)(Nt,Tt)(Rt),Dt=o("sjUi"),jt=o("y0Lt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Lt(e,t){if(t.type===Dt.b){var o=t;if(o.meta.source!==q.b.SiteMapSubArea){var n=e.getState(),r=Object(jt.a)(n,o.payload.__pageName,o.payload.input);r&&r.area&&r.subArea?(e.dispatch(Object(wt.d)(r.area.Id)),e.dispatch(Object(wt.e)(r.subArea.Id))):(e.dispatch(Object(wt.e)(null)),!Object(_t.a)(n)&&e.dispatch(Object(wt.d)(Object(_t.b)(n))))}}}var Ft=o("QOfD"),Pt=o("IfCW"),Ht=o("Wg6j"),Kt=function(e){function t(t){var o=e.call(this,t)||this;return o.state={isKeyboardFocused:!1,forceHideTooltip:!1},o._onKeyboardFocus=o._onKeyboardFocus.bind(o),o._onKeyboardBlur=o._onKeyboardBlur.bind(o),o._onSessionClick=o._onSessionClick.bind(o),o._onCloseClick=o._onCloseClick.bind(o),o._keyDownHandler=o._keyDownHandler.bind(o),o._onCloseButtonKeyDown=o._onCloseButtonKeyDown.bind(o),o._onPointerEnter=o._onPointerEnter.bind(o),o._onPointerLeave=o._onPointerLeave.bind(o),o}return Object(n.__extends)(t,e),t.prototype.render=function(){var e=this.props.style.sessionStyle;return this.props.isFocused&&(e=Object(n.__assign)(Object(n.__assign)({},e),this.props.style.selectedSessionStyle)),0===this.props.containerState?this._renderCollapsedContent(e):this._renderExpandedContent(e)},t.prototype._onPointerEnter=function(){this.props.onPointerEnter(this.props.session.id)},t.prototype._onPointerLeave=function(e){this.props.onPointerLeave(this.props.session.id)},t.prototype._getTitle=function(){return this.props.session.title||this.props.firstAnchorTabTitle||this.props.newSessionTitle},t.prototype._renderExpandedContent=function(e){var t=this;return r.createElement(v.a,{ref:function(e){return t._wrapperRef=e},key:"sessionContainer-"+this.props.session.id,id:"sessionContainer-"+this.props.session.id,onClick:this._onSessionClick,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,onKeyDown:this._keyDownHandler,isSelected:this.props.isFocused,tabIndex:this.props.isFocused||this.state.isKeyboardFocused?0:-1,accessibilityLabel:this._getAccessibilityLabel(),role:c.x,style:e,testhooks:{id:this.props.session.id}},this._renderIcon(),this._renderActivityIndicator(),this._renderSessionTitle(),this._renderCloseButton())},t.prototype._renderCollapsedContent=function(e){var t=this,o=Object(n.__assign)(Object(n.__assign)({},e),{paddingRight:0,paddingLeft:0});return r.createElement(v.a,{ref:function(e){return t._wrapperRef=e},key:"sessionContainer-"+this.props.session.id,id:"sessionContainer-"+this.props.session.id,onClick:this._onSessionClick,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,onKeyDown:this._keyDownHandler,isSelected:this.props.isFocused,tabIndex:this.props.isFocused||this.state.isKeyboardFocused?0:-1,accessibilityLabel:this._getAccessibilityLabel(),role:c.x,style:o,testhooks:{id:this.props.session.id},onPointerEnter:this._onPointerEnter},r.createElement(s.a,{key:"session-flyout-anchor-"+this.props.session.id,id:"session-flyout-anchor-"+this.props.session.id,style:{width:0,height:"100%"}}),this._renderIcon(),this._renderActivityIndicator(),(this.props.isHovered||this.state.isKeyboardFocused)&&!this.state.forceHideTooltip&&this._renderItemFlyout(e))},t.prototype._renderItemFlyout=function(e){var t=Object(n.__assign)(Object(n.__assign)({},e),this.props.style.flyoutStyle),o={onPointerLeave:this._onPointerLeave,onClick:this._onSessionClick,tabIndex:0};return r.createElement(S.a,Object(n.__assign)({positionType:"relative",relativeToElementId:"session-flyout-anchor-"+this.props.session.id,id:"session-flyout-"+this.props.session.id,key:"session-flyout-"+this.props.session.id,flyoutDirection:S.b.right,onOutsideClick:this._onPointerLeave,flyoutStyle:t},o),this._renderIcon(),this._renderActivityIndicator(),this._renderCloseButton(),this._renderSessionTitle())},t.prototype._renderIcon=function(){var e={display:"flex",flexShrink:0,width:we.a.sizes.SiteMap.RefreshedWidthCollapsed},t=this.props.isFocused?{}:{margin:"0 8px"},o=Object(n.__assign)(Object(n.__assign)({},this.props.style.iconStyle),t),i=this._getTitle();if(this.props.isDefault)return o=Object.assign(o,{fontSize:we.a.fontSizes.Font125}),r.createElement(s.a,{style:e,accessibilityHidden:!0},this._renderFocusedSessionIndicator(),r.createElement(h.a,{style:this.props.style.iconWraperStyle,key:"entityImage-"+this.props.session.id,title:i},Object(Ht.h)("Home",!1,!0,void 0,o,null,null,this._getTitle())));if(this.props.session.icon){var a=Object(n.__assign)({width:we.a.sizes.Icon.MaxWidth,height:we.a.sizes.Icon.MaxHeight},t);return r.createElement(s.a,{style:e},this._renderFocusedSessionIndicator(),r.createElement(U.a,{source:this.props.session.icon,title:this.props.session.iconTitle,altText:this.props.session.iconTitle,style:a}))}o=Object.assign(o,{fontSize:we.a.fontSizes.Font075,fontWeight:"bold",color:we.a.colors.BaseColor.White});var l=this.props.session.title||this.props.firstAnchorTabTitle;return r.createElement(s.a,{style:e,accessibilityHidden:!0},this._renderFocusedSessionIndicator(),r.createElement(J.a,{entityReference:{entityName:"",Id:""},customEntityIcon:null,entityPrimaryField:l,hasPrimaryImageField:!0,imageSrc:null,sipUrl:null,wrapperStyle:null,presenceIndicatorSize:3,key:"entityImage-"+this.props.session.id,alt:l,style:o,title:i}))},t.prototype._renderFocusedSessionIndicator=function(){return this.props.isFocused&&r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:this.props.style.focusedSessionIndicatorStyle,accessibilityHidden:!0})},t.prototype._renderSessionTitle=function(){var e=this._getTitle();return r.createElement(h.a,{key:"session-title-"+this.props.session.id,style:this.props.style.textTitleStyle,title:e},e)},t.prototype._onKeyboardFocus=function(){this.setState({isKeyboardFocused:!0}),this.props.onFocusIn(this.props.session.id)},t.prototype._onKeyboardBlur=function(e){var t=e.relatedTarget?e.relatedTarget:document.activeElement,o=t&&t.id==="close-session-"+this.props.session.id;this.setState({forceHideTooltip:!1,isKeyboardFocused:o})},t.prototype._renderCloseButton=function(){var e=this,t=String.format(this.props.closeSessionAriaLabel,this._getTitle());return this.props.session.canBeClosed&&r.createElement(s.a,{ref:function(t){return e._closeRef=t},tabIndex:0,id:"close-session-"+this.props.session.id,key:"close-session-"+this.props.session.id,className:this.state.isKeyboardFocused?"close-button focused":"close-button",style:this.props.style.closeButtonStyle,onClick:this._onCloseClick,onKeyDown:this._onCloseButtonKeyDown,accessibilityLabel:t,title:this.props.closeSessionTooltip,testhooks:{id:"close-session-"+this.props.session.id},role:c.d},r.createElement(f.b,{type:y.a.RemoveFilter,style:{fontSize:"16px",padding:6}}))},t.prototype._keyDownHandler=function(e){switch(Object(le.e)(e)){case b.a.Space:case b.a.Enter:!this.props.isFocused&&this.props.focusSession(this.props.session.id);break;case b.a.Delete:case b.a.Backspace:this.props.session.canBeClosed&&this.props.closeSession(this.props.session.id);break;case b.a.Escape:0===this.props.containerState&&(this._focusToSessionElement(),this.setState({forceHideTooltip:!0}));break;case b.a.LeftArrow:case b.a.RightArrow:var t=i.findDOMNode(this._closeRef);t&&t.focus()}},t.prototype._focusToSessionElement=function(){var e=i.findDOMNode(this._wrapperRef);e&&e.focus()},t.prototype._onCloseClick=function(e){this._focusToSessionElement(),this.props.session.canBeClosed&&this.props.closeSession(this.props.session.id),e.stopPropagation()},t.prototype._onCloseButtonKeyDown=function(e){e.keyCode!==b.a.Space&&e.keyCode!==b.a.Enter||(event.target.click(),e.stopPropagation()),e.keyCode===b.a.Tab&&0===this.props.containerState&&e.preventDefault()},t.prototype._onSessionClick=function(){!this.props.isFocused&&this.props.focusSession(this.props.session.id)},t.prototype._renderActivityIndicator=function(){return!this.props.isFocused&&this.props.session.isFocusRequested&&r.createElement(s.a,{key:"sitemap-sitemapAreaEntry-indicator",style:this.props.style.indicatorStyle,accessibilityHidden:!0,testhooks:{id:this.props.session.id+"-indicator"}})},t.prototype._getAccessibilityLabel=function(){var e=this._getTitle();return this.props.session.iconTitle&&(e+=" "+this.props.session.iconTitle),this.props.session.isFocusRequested&&(e+=" "+this.props.activityIndicatorDescribedBy),this.props.session.canBeClosed&&(e+=" "+this.props.closeSessionDescribedBy),e},t}(r.Component),zt=o("mDeH"),Wt=o("DNkP"),Gt=o("IQrP"),Ut=o("1gba"),qt=o("l+dh"),Vt=o("XXef"),Zt=function(e){function t(t){var o=e.call(this,t)||this;return o._focusSession=o._focusSession.bind(o),o._closeSession=o._closeSession.bind(o),o._onPointerEnter=o._onPointerEnter.bind(o),o._onPointerLeave=o._onPointerLeave.bind(o),o.state={hoveredSessionId:void 0},o._keyboardHandler=o._keyboardHandler.bind(o),o._globalKeyboadHandler=o._globalKeyboadHandler.bind(o),o}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this._globalKeyboadHandler)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._globalKeyboadHandler)},t.prototype.render=function(){var e=this;return r.createElement(s.a,{key:"session-list-id",style:{width:"100%"}},r.createElement(_.a,{id:"session-list-id",role:c.w,ref:function(t){return e._wrapperRef=t},style:this.props.style.sessionListStyle,onKeyDown:this._keyboardHandler},this._renderSessions()),this._renderFocusRequestedSessionAccessibility())},t.prototype._renderSessions=function(){var e=this,t=Object(nt.c)(this.props.resourceStrings,Gt.T),o=Object(nt.c)(this.props.resourceStrings,Gt.D),n=Object(nt.c)(this.props.resourceStrings,Gt.F),i=Object(nt.c)(this.props.resourceStrings,Gt.E),s=Object(nt.c)(this.props.resourceStrings,Gt.C);return Object.keys(this.props.sessions).map((function(a,l){return r.createElement(Kt,{key:"session-"+a,session:e.props.sessions[a],firstAnchorTabTitle:e.props.firstAnchorTabTitles[a],isFocused:a===e.props.focusedSessionId,isDefault:a===e.props.defaultSessionId,style:e.props.style,containerState:e.props.panelState,focusSession:e._focusSession,closeSession:e._closeSession,isRTL:e.props.isRTL,onPointerEnter:e._onPointerEnter,onPointerLeave:e._onPointerLeave,isHovered:e.state.hoveredSessionId===a,newSessionTitle:t,closeSessionTooltip:n,activityIndicatorDescribedBy:s,closeSessionAriaLabel:o,closeSessionDescribedBy:i,onFocusIn:function(t){e._focusItemIndex=Object.keys(e.props.sessions).findIndex((function(e){return e===t}))}})}))},t.prototype._renderFocusRequestedSessionAccessibility=function(){var e=this,t=Object(nt.c)(this.props.resourceStrings,Gt.C);return r.createElement(s.a,{key:"SessionFocusRequested_Accessibility",accessibilityLive:"polite",accessibilityAtomic:"true",style:{width:0,height:0,overflow:"hidden"}},Object.keys(this.props.sessions).map((function(o){var n=e.props.sessions[o],i=e.props.isRTL?t+" "+n.title:n.title+" "+t;return n.isFocusRequested&&r.createElement(h.a,{id:"accessibility_"+n.id},i)})))},t.prototype._keyboardHandler=function(e){switch(Object(le.e)(e)){case b.a.UpArrow:var t=this._getPreviousElement();t&&t.focus(),e.preventDefault(),e.stopPropagation();break;case b.a.DownArrow:var o=this._getNextElement();o&&o.focus(),e.preventDefault(),e.stopPropagation();break;case b.a.Home:var n=this._getFirstElement();n&&n.focus(),e.preventDefault(),e.stopPropagation();break;case b.a.End:var r=this._getLastElement();r&&r.focus(),e.preventDefault(),e.stopPropagation()}},t.prototype._globalKeyboadHandler=function(e){switch(Object(le.e)(e)){case b.a.Escape:this.setState({hoveredSessionId:void 0})}},t.prototype._getNextElement=function(){var e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=(this._focusItemIndex+1)%e.childNodes.length,e.childNodes[this._focusItemIndex]):null},t.prototype._getPreviousElement=function(){var e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex<=0&&(this._focusItemIndex=e.childNodes.length),this._focusItemIndex--,e.childNodes[this._focusItemIndex]):null},t.prototype._getFirstElement=function(){var e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=0,e.childNodes[this._focusItemIndex]):null},t.prototype._getLastElement=function(){var e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=e.childNodes.length-1,e.childNodes[this._focusItemIndex]):null},t.prototype._closeSession=function(e){this.props.closeSession(e)},t.prototype._focusSession=function(e){e!==this.props.focusedSessionId&&this.props.focusSession(e)},t.prototype._onPointerEnter=function(e){this.setState({hoveredSessionId:e})},t.prototype._onPointerLeave=function(e){this.state.hoveredSessionId===e&&this.setState({hoveredSessionId:void 0})},t}(r.Component);var Qt=Object(a.a)((function(){var e=Object(k.h)(),t={};return function(o,r){var i=Object(Ft.c)(o);Object.keys(i).forEach((function(e){var r,s=Object(Vt.b)(o,i[e].anchorTabId);(!t[e]||(null==s?void 0:s.length)<=1)&&(t=Object(n.__assign)(Object(n.__assign)({},t),((r={})[e]=Object(qt.c)(o,i[e].anchorTabId),r)))}));var s=Object(Wt.c)(o),a=Object(Wt.a)(o),l=e(o,[Gt.F,Gt.E,Gt.D,Gt.T,Gt.C]),c=Object(I.g)(o),p=Object(ee.n)();return{sessions:i,firstAnchorTabTitles:t,focusedSessionId:s,defaultSessionId:a,resourceStrings:l,style:Object(zt.a)(c,p).sessionStyle,isRTL:c}}}),(function(e){return{closeSession:function(t){return e(Object(Pt.a)(t))},focusSession:function(t){return e(Object(Ut.a)(t))}}}))(Zt),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.renderPanelBody=function(){return r.createElement(Qt,{maxSessions:Gt.A,panelState:this.props.panelState})},t.prototype.renderPanelFooter=function(){return null},t}(Rt),Yt=Object(a.a)(Nt,Tt)(Xt),Jt=o("Hn5x"),$t=o("v3xZ"),eo=Object(p.a)();
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var to={overflowX:"hidden",paddingLeft:"50px",paddingRight:"15px",listStyleType:"none",display:"block"},oo=function(e){function t(t){var o=e.call(this,t)||this;return o.onOutsideClickHandler=o.onOutsideClickHandler.bind(o),o.closeSiteMap=o.closeSiteMap.bind(o),o}return Object(n.__extends)(t,e),t.prototype.onOutsideClickHandler=function(){this.props.execute(Object($t.b)())},t.prototype.closeSiteMap=function(){this.props.isOpened&&(this.onOutsideClickHandler(),this.props.toggleSiteMap())},t.prototype._renderSitemapRecentsFlyout=function(){return r.createElement(s.a,null,r.createElement(S.a,{key:"overflow-flyout",positionType:"relative",relativeToElementId:"sitemap-entity-"+this.props.relativeToEntryId,flyoutDirection:S.b.down,flyoutStyle:(e=this.props.theme,t=this.props.platformType,{width:t===Ve.b.Web?"calc("+e.sizes.SiteMap.Width+" - 20px)":"100%",marginBottom:"6px",paddingTop:"2px",paddingBottom:"2px",backgroundColor:e.colors.SiteMap.Default,zIndex:50}),onOutsideClick:this.onOutsideClickHandler,id:eo+this.props.relativeToEntryId},r.createElement(_.a,{key:"sitemap-sitemapAreaEntry-recent",style:to},this._renderRecentItems(this.props.flyoutRecents,this.closeSiteMap))));var e,t},t.prototype._renderRecentItems=function(e,t){return e.map((function(e,o){return r.createElement(Jt.a,{key:o,entry:e,toggleSiteMap:t,isTabIndexZero:!1})}))},t.prototype.render=function(){return this.props.flyoutVisible&&this.props.isOpened&&this.props.flyoutRecents.length?this._renderSitemapRecentsFlyout():null},t}(r.Component);var no=Object(a.a)((function(e){var t,o,n=Object(E.a)(e),r=Object(qe.a)(e),i=Object(Q.d)(e),s=i&&i.isVisible;return s&&(t=i.relativeToEntryId,o=Object(Q.e)(e,i.entityTypeName).map((function(e){return X.e.FromStateItem(e)}))),{flyoutVisible:s,relativeToEntryId:t,flyoutRecents:o,theme:n,platformType:r}}),(function(e){return{execute:function(t){e(t)}}}))(oo);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Index of all needed sitemap panel imports for delay loading sitemap panel code.
 */},aimL:function(e,t,o){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;o.d(t,"b",(function(){return n})),o.d(t,"a",(function(){return r})),o.d(t,"c",(function(){return i})),function(e){e.LS_PUBLISHED_APPS="AppModuleLandingPage.PublishedAppsFilterText",e.LS_SEARCH_MY_APPS="AppModuleLandingPage.SearchMyApps",e.LS_NO_APPS="AppModuleLandingPage.NoApps",e.LS_MISSING_APPS_CHANGE_CRITERIA="AppModuleLandingPage.NoAppsFoundChangeSearchCriteriaText",e.LS_NO_OFFLINE_APPS="AppModuleLandingPage.NoOfflineApps",e.LS_NO_MATCHING_SEARCH="AppModuleLandingPage.NoMatchingSearch",e.LS_MY_APPS="App_Modules_SubArea_Title"}(n||(n={}));var r=[n.LS_PUBLISHED_APPS,n.LS_SEARCH_MY_APPS,n.LS_NO_APPS,n.LS_MISSING_APPS_CHANGE_CRITERIA,n.LS_NO_OFFLINE_APPS,n.LS_NO_MATCHING_SEARCH,n.LS_MY_APPS];function i(e,t){return e&&e[t]?e[t]:t}},miNs:function(e,t,o){"use strict";var n;o.d(t,"a",(function(){return n})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.Capslock=20]="Capslock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(n||(n={}))},"pLx/":function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var n=o("Z1aD"),r=o("45T4");function i(e,t){return Object(n.a)(r.a,{},t,e)}},pWhJ:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));function n(e,t){return void 0===t&&(t=10),e.recentItems&&e.recentItems.recentItems.sort((function(e,t){return t.LastAccessed-e.LastAccessed})).slice(0,t)}},y0Lt:function(e,t,o){"use strict";o.d(t,"b",(function(){return S})),o.d(t,"a",(function(){return b}));var n=o("0hZT"),r=o("xc1f"),i=o("WH9N"),s=o("45T4"),a=o("2xGA"),l=o("fNHa"),c=o("GDI2"),p=o("lMVv"),u=o("3y+0"),d=o("L8Ie"),h=o("AwM4"),y=o("ZVHh"),f=o("EGsq");function b(e,t,o){var u;if(!o||!t)return null;var y,f=Object(c.b)(e);if(!f)return null;if(o.isQueryMode)return null;switch(t){case n.a:var b=o;y=v(e,f,b.entityTypeName,null===(u=b.viewId)||void 0===u?void 0:u.guid);break;case r.a:y=function(e,t,o){var n=Object(p.r)(e,o.entityTypeName),r=o.entityTypeName,i=[k(r),M(r)];o.formId&&i.unshift(function(e,t){var o=new RegExp("[&\\?]formId="+t+"\\b","i");return function(t){return x(t.Url)&&t.Url.search("[&\\?]etn="+e+"\\b")>=0&&t.Url.search(o)>=0}}(r,o.formId.guid));return w(e,t,i)||n&&w(e,t,[M("activitypointer")])}(e,f,o);break;case i.a:y=function(e,t,o){var n=o.dashboardId;if(o.etn)return v(e,t,o.etn);var r=m(e,t),i=g(e,t),s=i&&A(i);return function(e,t,o,n){var r=null,i=o;if(o){r=n;for(var s=0,a=o.GroupIds;s<a.length;s++)for(var l=a[s],c=0,p=(g=o.Groups[l]).SubAreaIds;c<p.length;c++){var u=p[c];if(A(_=g.SubAreas[u])&&(r||(r=_),t&&(_.DefaultDashboard===t||_.Url&&_.Url.toLowerCase().includes(t))))return{subArea:_,area:o}}if(r)return{subArea:r,area:o}}for(var d=0,h=e.AreaIds;d<h.length;d++)for(var y=h[d],f=e.Areas[y],b=0,m=f.GroupIds;b<m.length;b++){l=m[b];for(var g,S=0,v=(g=f.Groups[l]).SubAreaIds;S<v.length;S++){var _;u=v[S];if(A(_=g.SubAreas[u])){if(t&&(_.DefaultDashboard===t||_.Url&&_.Url.toLowerCase().includes(t)))return{area:f,subArea:_};r||(r=_,i=f)}}}return{subArea:r,area:i}}(t,n?n.guid:null,r,s&&i)}(e,f,o);break;case s.a:y={subArea:null,area:m(e,f)};break;case l.a:y=function(e,t,o){var n=o.customControlId;return w(e,t,[C(n)])}(e,f,o);break;case a.a:y=_(e,f,o.webresourceName);break;case d.a:y=function(e,t,o){var n=o&&o.uniqueName;return w(e,t,[O(n)])}(e,f,o);break;case h.a:y=_(e,f,"msdyn_appmanagementcontrol")}return y}function m(e,t){var o=Object(u.a)(e);return o&&t&&t.Areas&&t.Areas[o]}function g(e,t){var o=m(e,t),n=Object(u.c)(e);if(o)for(var r=0,i=o.GroupIds;r<i.length;r++)for(var s=i[r],a=o.Groups[s],l=0,c=a.SubAreaIds;l<c.length;l++){var p=c[l],d=a.SubAreas[p];if(d.Id===n)return d}return null}function S(e,t){var o=m(e,t),n=g(e,t);return o&&n?{area:o,subArea:n}:null}function v(e,t,o,n){var r=[k(o),M(o)];return n&&r.unshift(function(e,t){var o=new RegExp("[&\\?]viewId="+t+"\\b","i");return function(t){return x(t.Url)&&t.Url.search("[&\\?]etn="+e+"\\b")>=0&&t.Url.search(o)>=0}}(o,n)),w(e,t,r)}function _(e,t,o){return w(e,t,[E(Object(f.t)(e),o)])}function w(e,t,o){for(var n=m(e,t),r=g(e,t),i=0,s=o;i<s.length;i++){var a=s[i];if(n&&r&&a(r))return{area:n,subArea:r}}for(var l=0,c=o;l<c.length;l++){var p=I(n,a=c[l]);if(p)return p;for(var u=0,d=t.AreaIds;u<d.length;u++){var h=d[u];if(p=I(t.Areas[h],a))return p}}return null}function I(e,t){if(!e||!e.GroupIds)return null;for(var o=0,n=e.GroupIds;o<n.length;o++)for(var r=n[o],i=e.Groups[r],s=0,a=i.SubAreaIds;s<a.length;s++){var l=a[s],c=i.SubAreas[l];if(t(c))return{area:e,subArea:c}}return null}function E(e,t){var o=e.toLowerCase(),n=t.toLowerCase();return function(e){var t=e.Url.toLowerCase();if(t.includes(o)&&t.substring(o.length)===n)return!0;return!1}}function C(e){var t="controlname="+e.toLowerCase(),o=new RegExp("\\b"+t+"\\b");return function(e){var t=e.Url.toLowerCase();return o.test(t)}}function M(e){return function(t){return t.Entity===e||x(t.Url)&&t.Url.search("[&\\?]etn="+e+"\\b")>=0}}function k(e){return function(t){return t.Entity===e||x(t.Url)&&t.Url.search("[&\\?]etn="+e+"\\b")>=0&&-1===t.Url.search(/[&\\?]viewId=/i)&&-1===t.Url.search(/[&\\?]formId=/i)}}function O(e){return function(t){return t.DynamicPage===e}}function A(e){return Object(y.b)(e)||e.Url&&e.Url.toLowerCase().includes("pagetype=dashboard")}function x(e){return e&&/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e)}}}]),window.bundleExecutionMarkers["scripts/es5/sitemappanel.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();