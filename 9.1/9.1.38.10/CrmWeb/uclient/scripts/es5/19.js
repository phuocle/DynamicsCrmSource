(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/19.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[19],{"+I9j":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultTelemetryUtil=void 0;var n=function(){function e(e){this._cordovaChannel=e}return e.prototype.trackEvent=function(e,t){this._cordovaChannel.sendMessage("PublishedAppTelemetry","trackEvent",[e,t])},e.prototype.trackException=function(e,t){this._cordovaChannel.sendMessage("PublishedAppTelemetry","trackException",[e,t])},e}();t.DefaultTelemetryUtil=n},"+kCY":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r("694r"),a=r("7HGc"),s=r("p9nC"),c=function(e){function t(t,r,n,o,i,s,c){var p=e.call(this)||this;return p._splitPackageDetails=t,p._zipPackageDetails=r,p._packageDetails=n,p._resourceDetails=o,p._eventLogger=i,p._fallbackStaticContentProxy=s,p._staticContentUrl=c,p._splitPackageDetails&&(p._splitPackageResolver=new a.SplitPackagePathResolver(p._splitPackageDetails,p._eventLogger,p._fallbackStaticContentProxy,p._staticContentUrl)),p._zipPackageDetails&&(p._zipRootPath=p._zipPackageDetails.rootPath),p.setProxyPath(p._packageDetails.proxyPath),p}return o(t,e),t.prototype.isSharedPath=function(e){if(this._resourceDetails&&this._resourceDetails.resourceMap&&this._resourceDetails.resourceMap[e])return!0;if(this._splitPackageResolver)return this._splitPackageResolver.isSharedPath(e);var t;return t=0===e.indexOf("webplayerBVT.443617b8.0025.4713.a75d.baa9b3daf757/"),!s.DefaultPathResolver.isPathToInitFile(e)&&(0===(e=e.toLowerCase()).indexOf("controls/")||0===e.indexOf("opensource/")||0===e.indexOf("ctrllib/")||0===e.indexOf("images/")||0===e.indexOf("css/")||0===e.indexOf("publish/")||t||-1!==e.indexOf(".resjson"))},t.prototype.resolveSharedPath=function(e){return this._resourceDetails&&this._resourceDetails.resourceMap&&this._resourceDetails.resourceMap[e]?this._resourceDetails.resourceMap[e]:this._splitPackageResolver?this._splitPackageResolver.resolveSharedPath(e):(0!==e.indexOf(this._zipRootPath)&&(e=this._zipRootPath+e),s.DefaultPathResolver.addStaticContentProxyPathIfNeeded(e,this._fallbackStaticContentProxy,this._staticContentUrl))},t.prototype.resolveAppPath=function(e){return this._packageDetails&&(this._packageDetails.queryString&&-1===e.indexOf(this._packageDetails.queryString)&&(e+=this._packageDetails.queryString),this._packageDetails.host&&-1===e.indexOf(this._packageDetails.host))?this._packageDetails.host+e:e},t}(i.BaseWebPlayerPathResolver);t.WebPlayerPathResolver=c},"/JvV":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this._disposal=[],this._handlers=[],this.handleError=this.handleError.bind(this),window&&(window.addEventListener("error",this.handleError),this._disposal.push((function(){window.removeEventListener("error",e.handleError)})))}return e.prototype.addHandler=function(e){return this._handlers.push(e),this},e.prototype.dispose=function(){this._disposal.forEach((function(e){return e()})),this._disposal=[],this._handlers=[]},e.prototype.handleError=function(e){"string"==typeof e&&(e=new ErrorEvent("error",{message:e})),this._handlers.forEach((function(t){return t(e)}))},e}();t.GlobalErrorHandler=n},"0hda":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.PublishedAppServiceWorkerConstants={clientIdSearchParamName:"clientId"}},"1Td8":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("rerI"),o=r("Yg39"),i=function(){function e(e,t,r,n,o){void 0===o&&(o=!0),this._cordovaLoader=e,this._performanceHelper=t,this._eventLogger=r,this._htmlHelper=n,this._enableGetAppDetailsFromParser=o,this._webplayerServerConfigMessageTimeout=4e3,this._appDetailsRetrieverPrefix="AppDetailsRetriever.",this._callbacksArray=[],this._isInProgress=!1}return e.prototype.getAppDetails=function(e){this._isInProgress?this._callbacksArray.push(e):(this._isInProgress=!0,this._callbacksArray.push(e),this._getAppDetailsInternal())},e.prototype._getAppDetailsInternal=function(){var e=this,t=[];t.push({execute:function(t,r){e._getAppDetailsFromCordova(t,r)}}),this._enableGetAppDetailsFromParser&&t.push({execute:function(t,r){e._getAppDetailsFromParser(t,r)}}),o.first(t,(function(t){e._processSuccessScenarios(t)}),(function(t){e._processFailureScenarios(t[0])}))},e.prototype._getAppDetailsFromParser=function(e,t){var r=this,o=void 0,i=function(a){if(a.data&&"getWebPlayerServerConfig"===a.data.command){if(window.removeEventListener("message",i),o=a.data.config,!r._isResponseDataValid(o)){var s=new Error("Invalid server config received. Users may not be authenticated yet.");return r._eventLogger.logEvent(r._appDetailsRetrieverPrefix+"InitParser.Unauthenticated.Failure",s.message),void t(s)}r._eventLogger.logEvent(r._appDetailsRetrieverPrefix+"InitParser.Success","Successfully get the valid config");var c={appId:o.AppId,cdnPath:o.CdnUrl,webPlayerProxyUrl:void 0,isPublishedAppExternalToHost:r._isPublishedAppExternalToHost(o),publishedAppHasCachedFiles:r._hasCachedFiles(o),isWebPlayer:!!o,isWebPlayerBVT:!1},p=new n.LoaderPublishedAppMetadataParser(r._eventLogger,c);p.setAppDetails(o.PublishedAppConfig.IndexWebHtmlUrl,o.PublishedAppConfig.IndexWebHtmlUrl,o.PublishedAppConfig.AppPackageResourcesKind,JSON.parse(o.PublishedAppConfig.DocumentVersion),o.PublishedAppConfig.AppVersion,null),p.getAppDetails({onSuccess:e,onFailure:t},!1)}};window.addEventListener("message",i),this._eventLogger.logEvent(this._appDetailsRetrieverPrefix+"InitParser.InProgress","Sent post message to get the server config"),this._htmlHelper.postMessageToParent({command:"getWebPlayerServerConfig"}),setTimeout((function(){if(!o){var e=new Error("Post message lost ! The player side may not subscribe the app's iframe properly.");r._eventLogger.logEvent(r._appDetailsRetrieverPrefix+"InitParser.Timeout.Failure",e.message),t(e)}}),this._webplayerServerConfigMessageTimeout)},e.prototype._isResponseDataValid=function(e){var t,r;return!!((null===(t=null==e?void 0:e.PublishedAppConfig)||void 0===t?void 0:t.IndexWebHtmlUrl)&&(null===(r=null==e?void 0:e.PublishedAppConfig)||void 0===r?void 0:r.AppPackageResourcesKind)&&(null==e?void 0:e.AppId)&&(null==e?void 0:e.CdnUrl))},e.prototype._isPublishedAppExternalToHost=function(e){var t;return!!(null===(t=null==e?void 0:e.PublishedAppConfig)||void 0===t?void 0:t.SkipIframeCreation)},e.prototype._hasCachedFiles=function(e){var t;return!!(null===(t=null==e?void 0:e.PublishedAppConfig)||void 0===t?void 0:t.HasCachedFiles)},e.prototype._getAppDetailsFromCordova=function(e,t){var r=this;this._eventLogger.logEvent(this._appDetailsRetrieverPrefix+"GetAppMetadataFromCordova","Getting the app metadata through cordova exec"),this._cordovaLoader.load((function(){r._performanceHelper.mark("getAppDetailStart"),r._cordovaLoader.makeCordovaRequest((function(t){r._performanceHelper.measureFromMark("getAppDetailsTime","getAppDetailStart"),e(t)}),(function(e){t(e)}),"AppDependenciesResolver","getAppDetails"),r._eventLogger.logEvent("_getAppDetails","GetAppDetails requested")}))},e.prototype._processSuccessScenarios=function(e){this._isInProgress=!1;for(var t=this._callbacksArray.length,r=0;r<t;r++){this._callbacksArray.shift().onAppDetailsReceived(e)}},e.prototype._processFailureScenarios=function(e){this._isInProgress=!1;for(var t=this._callbacksArray.length,r=0;r<t;r++){this._callbacksArray.shift().onFailure(e)}},e}();t.AppDetailsRetriever=i},"1lt1":function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
n(r("RfvM")),n(r("O4aM")),n(r("b+CK")),n(r("C2F7")),n(r("ar2V")),n(r("YJsD")),n(r("OQaO"))},"2J/a":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r("v2e7"),s=r("T4K4"),c=r("wIJ5"),p=r("tPh+"),l=r("DNTp"),u=r("sHKn"),d=function(){function e(e,t,r,n,o){this._appLogicalName=e,this._cordovaLoader=t,this._globalErrorHandler=r,this._eventLogger=n,this._cachedAntiCSRFToken=o}return e.prototype.renderAsync=function(e){return o(this,void 0,void 0,(function(){var t,r,o,d,f,h,v,g,_,m,y,b,w,P=this;return i(this,(function(i){switch(i.label){case 0:if(!e)throw new Error("Config is null or undefined");if(t=e.containerDiv,r=e.params,!t)throw new Error("Container DOM not provided to render published app in");return this.dispose(),o=this,[4,this._createAndAppendIFrameAsync(t)];case 1:if(o._iframe=i.sent(),d=new a.HtmlHelper(this._iframe.contentWindow),f=new c.UrlParameterDictionary("",this._getPublishedIFrameHash(r)),h=new s.PerformanceHelper(this._iframe.contentWindow),v=new p.PublishedAppServiceWorkerManager((function(e){var t=e.error,r=t?n(n({},e),{error:t.toString()}):e;try{P._eventLogger.logEvent(e.eventName,JSON.stringify(r))}catch(t){P._eventLogger.logEvent(e.eventName,e.message)}}),f.getParameter(c.serviceWorkerUrlKey),{scope:"/"}),g={},_=f.getParameter(c.featureGatesKey))try{g=JSON.parse(_)}catch(e){this._eventLogger.logError("LoaderStart.FeatureGatesParsingFailure",e)}return[4,this._getAppDetailsAsync()];case 2:if(!(m=i.sent())||!m.appId)throw new Error("app logical name "+this._appLogicalName+" app metadata is corrupted !");return y={appId:m.appId,appLogicalName:this._appLogicalName},b=this._createCordovaObject(y),this._iframe.contentWindow.Cordova=b,w=new l.CanvasAppLoader(new u.CanvasAppCordovaLoader(b),d,h,this._onLoaderComplete.bind(this),f,this._globalErrorHandler,this._eventLogger,m,v,g,this._iframe.contentWindow),this._preparePublishedAppIFrame(w,r),w.start(),[2]}}))}))},e.prototype.dispose=function(){var e;null===(e=this._iframe)||void 0===e||e.parentNode.removeChild(this._iframe),this._iframe=null},e.prototype._onLoaderComplete=function(){this._iframe,this._iframe.contentWindow.VersionSupportPlugin=function(e,t){return new VersionSupportPlugin(e,t)}(this._iframe.contentWindow.Core,this._iframe.contentWindow.AppMagic),this._iframe.contentWindow.AppMagic.start()},e.prototype._preparePublishedAppIFrame=function(e,t){this._iframe.contentDocument.body.style.backgroundColor="transparent";var r=this._iframe.contentDocument.createElement("DIV");r.id="publishedCanvasContainer";var n=this._iframe.contentDocument.createElement("DIV");n.id="publishedCanvas",r.appendChild(n),this._iframe.contentDocument.body.appendChild(r),this._iframe.contentWindow.PublishedAppLoader=e,this._iframe.contentWindow.location.hash=this._getPublishedIFrameHash(t)},e.prototype._createAndAppendIFrameAsync=function(e){return new Promise((function(t,r){var n=document.createElement("IFRAME"),o="publishedCanvasContainer_"+Date.now();n.name=o,n.id=o,n.style.height="100%",n.style.width="100%",n.onload=function(){t(n)},n.onerror=function(){r("Failed to create iframe element for PublishedAppIFrame")},e.appendChild(n)}))},e.prototype._getPublishedIFrameHash=function(e){var t={hideNavBar:!0,antiCSRFToken:this._cachedAntiCSRFToken};if(e){for(var r=[],n=0,o=Object.keys(e);n<o.length;n++){var i=o[n];r.push(encodeURIComponent(i)+"="+encodeURIComponent(e[i]))}t[c.paramsQueryKey]=r.join("&")}return encodeURIComponent(JSON.stringify(t))},e.prototype._getAppDetailsAsync=function(){var e=this;return new Promise((function(t,r){var n=e._cordovaLoader.getCordovaObject();if(!n)throw new Error("Cordova instance does not exist");n.exec((function(e){t(e)}),(function(e){r(e)}),"AppModuleService","getCanvasAppMetadata",[e._appLogicalName,!0])}))},e.prototype._createCordovaObject=function(e){var t=this._cordovaLoader.getCordovaObject();if(!t)throw new Error("Cordova instance does not exist");var r=Object.create(t),n=t.exec;return r.exec=function(t,r,o,i,a){var s;return"AppLifecycle"===o&&"showToastMessage"===i?(Core.Environment.getBrowserId()===Core.Environment.BrowserId.InternetExplorer?(s=document.createEvent("CustomEvent")).initCustomEvent("canvasAppToast",!0,!1,{canvasAppId:e.appId,type:a[0],message:a[1][0],timeout:[2],preventDuplicates:a[3]}):s=new CustomEvent("canvasAppToast",{bubbles:!0,cancelable:!1,detail:{canvasAppId:e.appId,type:a[0],message:a[1][0],timeout:[2],preventDuplicates:a[3]}}),void window.dispatchEvent(s)):n(t,r,o,i,a,e)},r},e}();t.CanvasAppContainer=d},"4B+e":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},"5yX5":function(e,t,r){"use strict";window.performance.mark&&window.performance.mark("webPlayerCordovaIframeLoadStart");var n=void 0,o=void 0,i=[];function a(e){var t=function(){};t.prototype=e;var r=new t;if(t.bind)for(var n in e)"function"==typeof e[n]?r[n]=e[n].bind(e):function(t){utils.defineGetterSetter(r,n,(function(){return e[t]}))}(n);return r}!function(){var t,r,s,c,p;s={},c=[],p={},t=function(e){if(!s[e])throw"module "+e+" not found";if(e in p)throw"Cycle in require graph: "+c.slice(p[e]).join("->")+"->"+e;if(s[e].factory)try{return p[e]=c.length,c.push(e),function(e){var r=e.factory;return e.exports={},delete e.factory,r((function(r){var n=r;return"."===r.charAt(0)&&(n=e.id.slice(0,e.id.lastIndexOf("."))+"."+r.slice(2)),t(n)}),e.exports,e),e.exports}(s[e])}finally{delete p[e],c.pop()}return s[e].exports},(r=function(e,t){if(s[e])throw"module "+e+" already defined";s[e]={id:e,factory:t}}).remove=function(e){delete s[e]},r.moduleMap=s,"function"==typeof t&&(e.exports.require=t,e.exports.define=r),r("cordova",(function(e,t,n){var o=e("cordova/channel"),i=e("cordova/platform"),a=document.addEventListener,s=document.removeEventListener,c=window.addEventListener,p=window.removeEventListener,l={},u={};function d(e,t){var r=document.createEvent("Events");if(r.initEvent(e,!1,!1),t)for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}document.addEventListener=function(e,t,r){var n=e.toLowerCase();void 0!==l[n]?l[n].subscribe(t):a.call(document,e,t,r)},window.addEventListener=function(e,t,r){var n=e.toLowerCase();void 0!==u[n]?u[n].subscribe(t):c.call(window,e,t,r)},document.removeEventListener=function(e,t,r){var n=e.toLowerCase();void 0!==l[n]?l[n].unsubscribe(t):s.call(document,e,t,r)},window.removeEventListener=function(e,t,r){var n=e.toLowerCase();void 0!==u[n]?u[n].unsubscribe(t):p.call(window,e,t,r)};var f={define:r,require:e,version:"3.6.0",platformVersion:"3.6.0",platformId:i.id,addWindowEventHandler:function(e){return u[e]=o.create(e)},addStickyDocumentEventHandler:function(e){return l[e]=o.createSticky(e)},addDocumentEventHandler:function(e){return l[e]=o.create(e)},removeWindowEventHandler:function(e){delete u[e]},removeDocumentEventHandler:function(e){delete l[e]},getOriginalHandlers:function(){return{document:{addEventListener:a,removeEventListener:s},window:{addEventListener:c,removeEventListener:p}}},fireDocumentEvent:function(e,t,r){var n=d(e,t);void 0!==l[e]?r?l[e].fire(n):setTimeout((function(){"deviceready"==e&&document.dispatchEvent(n),l[e].fire(n)}),0):document.dispatchEvent(n)},fireWindowEvent:function(e,t){var r=d(e,t);void 0!==u[e]?setTimeout((function(){u[e].fire(r)}),0):window.dispatchEvent(r)},callbackId:Math.floor(2e9*Math.random()),callbacks:{},callbackStatus:{NO_RESULT:0,OK:1,CLASS_NOT_FOUND_EXCEPTION:2,ILLEGAL_ACCESS_EXCEPTION:3,INSTANTIATION_EXCEPTION:4,MALFORMED_URL_EXCEPTION:5,IO_EXCEPTION:6,INVALID_ACTION:7,JSON_EXCEPTION:8,ERROR:9},callbackSuccess:function(e,t){f.callbackFromNative(e,!0,t.status,[t.message],t.keepCallback)},callbackError:function(e,t){f.callbackFromNative(e,!1,t.status,[t.message],t.keepCallback)},callbackFromNative:function(e,t,r,n,o){try{var i=f.callbacks[e];if(i){if(t&&r==f.callbackStatus.OK){if(n&&n[0])for(var a in Object.setPrototypeOf(n[0],Object.getPrototypeOf(i.success.prototype)),n[0])n[0][a]&&n[0].hasOwnProperty(a)&&Object.setPrototypeOf(n[0][a],Object.getPrototypeOf(i.success.prototype));i.success&&i.success.apply(null,n)}else t||i.fail&&i.fail.apply(null,n);o||delete f.callbacks[e]}}catch(r){var s="Error in "+(t?"Success":"Error")+" callbackId: "+e+" : "+r;throw console&&console.log&&console.log(s),f.fireWindowEvent("cordovacallbackerror",{message:s}),r}},addConstructor:function(e){o.onCordovaReady.subscribe((function(){try{e()}catch(e){console.log("Failed to run constructor: "+e)}}))}};n.exports=f})),r("cordova/argscheck",(function(e,t,r){e("cordova/exec");var n=e("cordova/utils"),o=r.exports,i={A:"Array",D:"Date",N:"Number",S:"String",F:"Function",O:"Object"};o.checkArgs=function(e,t,r,a){if(o.enableChecks){for(var s,c,p,l=null,u=0;u<e.length;++u){var d=e.charAt(u),f=d.toUpperCase(),h=r[u];if("*"!=d&&(s=n.typeName(h),(null!=h||d!=f)&&s!=i[f])){l="Expected "+i[f];break}}if(l)throw l+=", but got "+s+".",l='Wrong type for parameter "'+(c=a||r.callee,p=u,/.*?\((.*?)\)/.exec(c)[1].split(", ")[p]+'" of ')+t+": "+l,"undefined"==typeof jasmine&&console.error(l),TypeError(l)}},o.getValue=function(e,t){return void 0===e?t:e},o.enableChecks=!0})),r("cordova/base64",(function(e,t,r){var n=t;n.fromArrayBuffer=function(e){return function(e){for(var t,r=e.byteLength,n="",o=a(),s=0;s<r-2;s+=3)n+=o[(t=(e[s]<<16)+(e[s+1]<<8)+e[s+2])>>12],n+=o[4095&t];r-s==2?(n+=o[(t=(e[s]<<16)+(e[s+1]<<8))>>12],n+=i[(4095&t)>>6],n+="="):r-s==1&&(n+=o[(t=e[s]<<16)>>12],n+="==");return n}(new Uint8Array(e))},n.toArrayBuffer=function(e){for(var t="undefined"!=typeof atob?atob(e):new Buffer(e,"base64").toString("binary"),r=new ArrayBuffer(t.length),n=new Uint8Array(r),o=0,i=t.length;o<i;o++)n[o]=t.charCodeAt(o);return r};var o,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(){o=[];for(var e=0;e<64;e++)for(var t=0;t<64;t++)o[64*e+t]=i[e]+i[t];return a=function(){return o},o}})),r("cordova/builder",(function(e,t,r){var n=e("cordova/utils");function o(e,r,o){t.replaceHookForTesting(e,r);var i=!1;try{e[r]=o}catch(e){i=!0}(i||e[r]!==o)&&n.defineGetter(e,r,(function(){return o}))}function i(e,t,r,i){i?n.defineGetter(e,t,(function(){return console.log(i),delete e[t],o(e,t,r),r})):o(e,t,r)}function a(t,r,o,c){!function(e,t,r){for(var n in e)e.hasOwnProperty(n)&&t.apply(r,[e[n],n])}(r,(function(r,p){try{var l=r.path?e(r.path):{};o?(void 0===t[p]?i(t,p,l,r.deprecated):void 0!==r.path&&(c?s(t[p],l):i(t,p,l,r.deprecated)),l=t[p]):void 0===t[p]?i(t,p,l,r.deprecated):l=t[p],r.children&&a(l,r.children,o,c)}catch(e){n.alert("Exception building Cordova JS globals: "+e+' for key "'+p+'"')}}))}function s(e,t){for(var r in t)t.hasOwnProperty(r)&&(e.prototype&&e.prototype.constructor===e?o(e.prototype,r,t[r]):"object"==typeof t[r]&&"object"==typeof e[r]?s(e[r],t[r]):o(e,r,t[r]))}t.buildIntoButDoNotClobber=function(e,t){a(t,e,!1,!1)},t.buildIntoAndClobber=function(e,t){a(t,e,!0,!1)},t.buildIntoAndMerge=function(e,t){a(t,e,!0,!0)},t.recursiveMerge=s,t.assignOrWrapInDeprecateGetter=i,t.replaceHookForTesting=function(){}})),r("cordova/channel",(function(e,t,r){var n=e("cordova/utils"),o=1,i=function(e,t){this.type=e,this.handlers={},this.state=t?1:0,this.fireArgs=null,this.numHandlers=0,this.onHasSubscribersChange=null},a={join:function(e,t){for(var r=t.length,n=r,o=function(){--n||e()},i=0;i<r;i++){if(0===t[i].state)throw Error("Can only use join with sticky channels.");t[i].subscribe(o)}r||e()},create:function(e){return a[e]=new i(e,!1)},createSticky:function(e){return a[e]=new i(e,!0)},deviceReadyChannelsArray:[],deviceReadyChannelsMap:{},waitForInitialization:function(e){},initializationComplete:function(e){var t=this.deviceReadyChannelsMap[e];t&&t.fire()}};function s(e){if("function"!=typeof e)throw"Function required as first argument!"}i.prototype.subscribe=function(e,t){if(s(e),2!=this.state){var r=e,i=e.observer_guid;"object"==typeof t&&(r=n.close(t,e)),i||(i=""+o++),r.observer_guid=i,e.observer_guid=i,this.handlers[i]||(this.handlers[i]=r,this.numHandlers++,1==this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())}else e.apply(t||this,this.fireArgs)},i.prototype.unsubscribe=function(e){s(e);var t=e.observer_guid;this.handlers[t]&&(delete this.handlers[t],this.numHandlers--,0===this.numHandlers&&this.onHasSubscribersChange&&this.onHasSubscribersChange())},i.prototype.fire=function(e){var t=Array.prototype.slice.call(arguments);if(1==this.state&&(this.state=2,this.fireArgs=t),this.numHandlers){var r=[];for(var n in this.handlers)r.push(this.handlers[n]);for(var o=0;o<r.length;++o)r[o].apply(this,t);2==this.state&&this.numHandlers&&(this.numHandlers=0,this.handlers={},this.onHasSubscribersChange&&this.onHasSubscribersChange())}},a.createSticky("onDOMContentLoaded"),a.createSticky("onNativeReady"),a.createSticky("onCordovaReady"),a.createSticky("onPluginsReady"),a.createSticky("onDeviceReady"),a.create("onResume"),a.create("onPause"),a.waitForInitialization("onCordovaReady"),a.waitForInitialization("onDOMContentLoaded"),r.exports=a})),r("cordova/exec",(function(e,t,r){var a=e("cordova");window.addEventListener("message",(function(e){var t=e.data;if(t&&"boolean"==typeof t.isPluginCall&&t.isPluginCall){var r=t.callbackId,n=t.status,o=t.args,i=t.keepCallback,s=0===n||1===n;a.callbackFromNative(r,s,n,o,i)}}),!1),r.exports=function(){var e,t,r,s,c,p,l=null;t=arguments[1],r=arguments[2],s=arguments[3],p=arguments[5],l="INVALID",c=(c=arguments[4])||[],((e=arguments[0])||t)&&(l=r+a.callbackId++,a.callbacks[l]={success:e,fail:t});var u={isPluginCall:!0,callbackId:l,service:r,action:s,actionArgs:c,antiCSRFToken:o,commandContext:p};n?n.postMessage(u,"*"):i.push(u)}})),r("cordova/initCommunicationChannel",(function(e,t,r){r.exports=function(){n=window.frames[arguments[0]],o=arguments[1];for(var e=0;e<i.length;e++){var t=i[e];t.antiCSRFToken=o,n.postMessage(i[e],"*")}}})),r("cordova/exec/proxy",(function(e,t,r){var n={};r.exports={add:function(e,t){return console.log("adding proxy for "+e),n[e]=t,t},remove:function(e){var t=n[e];return delete n[e],n[e]=null,t},get:function(e,t){return n[e]?n[e][t]:null}}})),r("cordova/init",(function(e,t,r){var n=e("cordova/channel"),o=e("cordova"),i=e("cordova/modulemapper"),s=e("cordova/platform"),c=e("cordova/pluginloader"),p=(e("cordova/utils"),[n.onNativeReady,n.onPluginsReady]);function l(e){for(var t=0;t<e.length;++t)2!=e[t].state&&console.log("Channel not fired: "+e[t].type)}window.setTimeout((function(){2!=n.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),l(p),l(n.deviceReadyChannelsArray))}),5e3),window.navigator&&Object.defineProperty(window,"navigator",a),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(e){this.log("warn: "+e)}),n.onPause=o.addDocumentEventHandler("pause"),n.onResume=o.addDocumentEventHandler("resume"),n.onDeviceReady=o.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?n.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",(function(){n.onDOMContentLoaded.fire()}),!1),window._nativeReady&&n.onNativeReady.fire(),i.clobbers("cordova","cordova"),i.clobbers("cordova/exec","cordova.exec"),i.clobbers("cordova/exec","Cordova.exec"),i.clobbers("cordova/initCommunicationChannel","cordova.initCommunicationChannel"),i.clobbers("cordova/initCommunicationChannel","Cordova.initCommunicationChannel"),s.bootstrap&&s.bootstrap(),setTimeout((function(){c.load((function(){n.onPluginsReady.fire()}))}),0),n.join((function(){i.mapModules(window),s.initialize&&s.initialize(),n.onCordovaReady.fire(),n.join((function(){e("cordova").fireDocumentEvent("deviceready")}),n.deviceReadyChannelsArray)}),p)})),r("cordova/init_b",(function(e,t,r){var n=e("cordova/channel"),o=e("cordova"),i=e("cordova/platform"),s=(e("cordova/utils"),[n.onDOMContentLoaded,n.onNativeReady]);function c(e){for(var t=0;t<e.length;++t)2!=e[t].state&&console.log("Channel not fired: "+e[t].type)}o.exec=e("cordova/exec"),window.setTimeout((function(){2!=n.onDeviceReady.state&&(console.log("deviceready has not fired after 5 seconds."),c(s),c(n.deviceReadyChannelsArray))}),5e3),window.navigator&&Object.defineProperty(window,"navigator",a),window.console||(window.console={log:function(){}}),window.console.warn||(window.console.warn=function(e){this.log("warn: "+e)}),n.onPause=o.addDocumentEventHandler("pause"),n.onResume=o.addDocumentEventHandler("resume"),n.onDeviceReady=o.addStickyDocumentEventHandler("deviceready"),"complete"==document.readyState||"interactive"==document.readyState?n.onDOMContentLoaded.fire():document.addEventListener("DOMContentLoaded",(function(){n.onDOMContentLoaded.fire()}),!1),window._nativeReady&&n.onNativeReady.fire(),i.bootstrap&&i.bootstrap(),n.join((function(){i.initialize&&i.initialize(),n.onCordovaReady.fire(),n.join((function(){e("cordova").fireDocumentEvent("deviceready")}),n.deviceReadyChannelsArray)}),s)})),r("cordova/modulemapper",(function(e,t,n){var o,i,s=e("cordova/builder"),c=r.moduleMap;function p(e,t,r,n){if(!(t in c))throw new Error("Module "+t+" does not exist.");o.push(e,t,r),n&&(i[r]=n)}function l(e,t){if(!e)return t;for(var r,n=e.split("."),o=t,i=0;r=n[i];++i)"navigator"===r?Object.defineProperty(o,"navigator",a):o=o[r]=o[r]||{};return o}t.reset=function(){o=[],i={}},t.clobbers=function(e,t,r){p("c",e,t,r)},t.merges=function(e,t,r){p("m",e,t,r)},t.defaults=function(e,t,r){p("d",e,t,r)},t.runs=function(e){p("r",e,null)},t.mapModules=function(t){var r={};t.CDV_origSymbols=r;for(var n=0,a=o.length;n<a;n+=3){var c=o[n],p=o[n+1],u=e(p);if("r"!=c){var d=o[n+2],f=d.lastIndexOf("."),h=d.substr(0,f),v=d.substr(f+1),g=d in i?"Access made to deprecated symbol: "+d+". "+g:null,_=l(h,t),m=_[v];"m"==c&&m?s.recursiveMerge(m,u):("d"==c&&!m||"d"!=c)&&(d in r||(r[d]=m),s.assignOrWrapInDeprecateGetter(_,v,u,g))}}},t.getOriginalSymbol=function(e,t){var r=e.CDV_origSymbols;if(r&&t in r)return r[t];for(var n=t.split("."),o=e,i=0;i<n.length;++i)o=o&&o[n[i]];return o},t.reset()})),r("cordova/platform",(function(e,t,r){r.exports={id:"iframe",bootstrap:function(){e("cordova/channel").onNativeReady.fire()}}})),r("cordova/pluginloader",(function(e,t,n){var o=e("cordova/modulemapper");e("cordova/urlutil");function i(e,n,o,i){i=i||o,e in r.moduleMap?o():t.injectScript(n,(function(){e in r.moduleMap?o():i()}),i)}function a(e,t,r){var n=t.length;if(n)for(var a=0;a<t.length;a++)i(t[a].id,e+t[a].file,s);else r();function s(){--n||function(e,t){for(var r,n=0;r=e[n];n++){if(r.clobbers&&r.clobbers.length)for(var i=0;i<r.clobbers.length;i++)o.clobbers(r.id,r.clobbers[i]);if(r.merges&&r.merges.length)for(var a=0;a<r.merges.length;a++)o.merges(r.id,r.merges[a]);r.runs&&o.runs(r.id)}t()}(t,r)}}function s(){var e=function(){for(var e=null,t=document.getElementsByTagName("script"),r=t.length-1;r>-1;r--){var n=t[r].src.replace(/\?.*$/,"").toLocaleLowerCase();if(n.indexOf("cordova.js")==n.length-"cordova.js".length){e=n;break}}return e}();if(null===e)return null;return e.substring(0,e.length-"/cordova.js".length)+"/"}function c(t,r){a(t,e("cordova/plugin_list"),r)}t.injectScript=function(e,t,r){var n=document.createElement("script");n.async=!1,n.onload=t,n.onerror=r,n.src=e,document.head.appendChild(n)},t.load=function(e){var t=s();window.performance.mark&&window.performance.mark("injecting-cordovaPluginsFile-start");var r=c.bind(null,t,e);i("cordova/plugin_list",t+"cordova_plugins.js",(function(){window.performance.mark&&window.performance.measure&&(window.performance.mark("injecting-cordovaPluginsFile-end"),window.performance.measure("injecting-cordovaPluginsFile","injecting-cordovaPluginsFile-start","injecting-cordovaPluginsFile-end")),r()}),e)}})),r("cordova/urlutil",(function(e,t,r){t.makeAbsolute=function(e){var t=document.createElement("a");return t.href=e,t.href}})),r("cordova/utils",(function(e,t,r){var n,o=t;function i(e){for(var t="",r=0;r<e;r++){var n=parseInt(256*Math.random(),10).toString(16);1==n.length&&(n="0"+n),t+=n}return t}o.defineGetterSetter=function(e,t,r,n){if(Object.defineProperty){var o={get:r,configurable:!0};n&&(o.set=n),Object.defineProperty(e,t,o)}else e.__defineGetter__(t,r),n&&e.__defineSetter__(t,n)},o.asyncConvertBlobToArrayBuffer=function(e,t,r){var n=new FileReader;n.onload=function(){t(this.result)},n.onerror=function(e){r(e)},n.readAsArrayBuffer(e)},o.defineGetter=o.defineGetterSetter,o.arrayIndexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var r=e.length,n=0;n<r;++n)if(e[n]==t)return n;return-1},o.arrayRemove=function(e,t){var r=o.arrayIndexOf(e,t);return-1!=r&&e.splice(r,1),-1!=r},o.typeName=function(e){return Object.prototype.toString.call(e).slice(8,-1)},o.isArray=function(e){return"Array"==o.typeName(e)},o.isDate=function(e){return"Date"==o.typeName(e)},o.clone=function(e){if(!e||"function"==typeof e||o.isDate(e)||"object"!=typeof e)return e;var t,r;if(o.isArray(e)){for(t=[],r=0;r<e.length;++r)t.push(o.clone(e[r]));return t}for(r in t={},e)r in t&&t[r]==e[r]||(t[r]=o.clone(e[r]));return t},o.close=function(e,t,r){return void 0===r?function(){return t.apply(e,arguments)}:function(){return t.apply(e,r)}},o.createUUID=function(){return i(4)+"-"+i(2)+"-"+i(2)+"-"+i(2)+"-"+i(6)},o.extend=(n=function(){},function(e,t){n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e.prototype.constructor=e}),o.alert=function(e){console&&console.log&&console.log(e)},o.setupEventPipelineForPlugin=function(t,r){var n={},o=!1;t.subscribeToEvent=function(t,i){o||(e("cordova/exec")((function(e){var t=n[e._eventName];t&&t.forEach((function(t){t(e._eventObject)}))}),null,r,"initializeEventHandlingFunctionality",[]),o=!0),n[t]||(n[t]=[]),n[t].push(i)},t.unsubscribeFromEvent=function(e,t){if(n[e]){var r=n[e].indexOf(t);r>-1&&n[e].splice(r,1)}},t.eventPipelineAvailable=!0}})),window.cordova=t("cordova"),t("cordova/init")}(),cordova.define("cordova/plugin_list",(function(e,t,r){r.exports=[{file:"plugins/com.microsoft.plugins.versionsupport/www/VersionSupportPlugin.js",id:"com.microsoft.plugins.versionsupport.VersionSupportPlugin",clobbers:["VersionSupportPlugin"]},{file:"../../openSource/modified/iframePlugins/cordova-plugin-network-information/www/network.js",id:"cordova-plugin-network-information.network",clobbers:["navigator.connection","navigator.network.connection"]},{file:"../../openSource/modified/iframePlugins/cordova-plugin-network-information/www/Connection.js",id:"cordova-plugin-network-information.Connection",clobbers:["Connection"]},{file:"../../openSource/modified/iframePlugins/cordova-plugin-device-motion/www/Acceleration.js",id:"cordova-plugin-device-motion.Acceleration",clobbers:["Acceleration"]},{file:"../../openSource/modified/iframePlugins/cordova-plugin-device-motion/www/accelerometer.js",id:"cordova-plugin-device-motion.accelerometer",clobbers:["navigator.accelerometer"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/XMLHttpRequest.js",id:"com.microsoft.siena.xmlhttprequest.XMLHttpRequest",clobbers:["routedXHR"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/ResponseHeaderParser.js",id:"com.microsoft.siena.xmlhttprequest.ResponseHeaderParser",clobbers:["ResponseHeaderParser"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/XMLHttpRequestExecutorFactory.js",id:"com.microsoft.siena.xmlhttprequest.XMLHttpRequestExecutorFactory",clobbers:["XMLHttpRequestExecutorFactory"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/LocalXMLHttpRequestExecutor.js",id:"com.microsoft.siena.xmlhttprequest.LocalXMLHttpRequestExecutor",clobbers:["LocalXMLHttpRequestExecutor"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/RemoteXMLHttpRequestExecutor.js",id:"com.microsoft.siena.xmlhttprequest.RemoteXMLHttpRequestExecutor",clobbers:["RemoteXMLHttpRequestExecutor"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/RemoteXMLHttpResponseForwarder.js",id:"com.microsoft.siena.xmlhttprequest.RemoteXMLHttpResponseForwarder",clobbers:["RemoteXMLHttpResponseForwarder"]},{file:"plugins/com.microsoft.siena.xmlhttprequest/www/LocalXhrUrlMapper.js",id:"com.microsoft.siena.xmlhttprequest.LocalXhrUrlMapper",clobbers:["LocalXhrUrlMapper"]}],r.exports.metadata={"cordova-plugin-file":"4.2.0","cordova-plugin-device":"1.1.3-dev","cordova-plugin-network-information":"1.0.0","cordova-plugin-device-motion":"1.0.0"}})),cordova.define("com.microsoft.plugins.versionsupport.VersionSupportPlugin",(function(e,t,r){
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=e("cordova/exec");e("cordova");function o(t,r){this.Core=t,this.AppMagic=r;var n=e("cordova/utils");n.setupEventPipelineForPlugin&&n.setupEventPipelineForPlugin(this,"VersionSupportPlugin")}o.prototype.exchangePluginManagerVersion=function(){if(void 0!==this.AppMagic.Runtime.App.Plugins.PluginVersionManager){var e=this.Core.Promise?this.Core.Promise.createCompletablePromise():this.Core.PromiseUtils.createCompletablePromise(),t=this.Core.Loader.ObjectFactory.instance.getSingleton(this.AppMagic.Runtime.App.Plugins.PluginVersionManager.singletonKey);t.setAppPluginManagerVersion();var r=t.getAppPluginManagerVersion();return n((function(r){console.log("exchangePluginManagerVersion succeeded"),t.setClientPluginManagerVersion(r),e.complete(r)}),(function(t){console.log("exchangePluginManagerVersion failed"+t),e.error("VersionSupportPlugin didn't work for the following : "+t)}),"VersionSupport","exchangePluginManagerVersion",[r]),e.promise}},o.prototype.exchangeAllPluginVersions=function(){if(void 0!==this.AppMagic.Runtime.App.Plugins.PluginVersionManager){var e=this.Core.Promise?this.Core.Promise.createCompletablePromise():this.Core.PromiseUtils.createCompletablePromise(),t=this.Core.Loader.ObjectFactory.instance.getSingleton(this.AppMagic.Runtime.App.Plugins.PluginVersionManager.singletonKey);t.setAppPluginVersionHashTable();var r=t.getAllAppPluginVersions();return n((function(r){console.log("exchangeAllPluginVersions succeeded"),t.setClientPluginVersionHashTable(r),e.complete(r)}),(function(t){console.log("exchangeAllPluginVersions failed"+t),e.error("VersionSupportPlugin didn't work for the following : "+t)}),"VersionSupport","exchangeAllPluginVersions",[r]),e.promise}},r.exports=o})),cordova.define("cordova-plugin-network-information.network",(function(e,t,r){var n=e("cordova/exec"),o=e("cordova"),i=e("cordova/channel"),a=e("cordova/utils");function s(){this.type="unknown"}"browser"!==o.platformId&&"undefined"!=typeof navigator&&a.defineGetter(navigator,"onLine",(function(){return"none"!=this.connection.type})),s.prototype.getInfo=function(e,t){n(e,t,"NetworkStatus","getConnectionInfo",[])};var c=new s,p=null;i.createSticky("onCordovaConnectionReady"),i.waitForInitialization("onCordovaConnectionReady"),i.onCordovaReady.subscribe((function(){c.getInfo((function(e){c.type=e,"none"===e?p=setTimeout((function(){o.fireDocumentEvent("offline"),p=null}),500):(null!==p&&(clearTimeout(p),p=null),o.fireDocumentEvent("online")),2!==i.onCordovaConnectionReady.state&&i.onCordovaConnectionReady.fire()}),(function(e){2!==i.onCordovaConnectionReady.state&&i.onCordovaConnectionReady.fire(),console.log("Error initializing Network Connection: "+e)}))})),r.exports=c})),cordova.define("cordova-plugin-network-information.Connection",(function(e,t,r){r.exports={UNKNOWN:"unknown",ETHERNET:"ethernet",WIFI:"wifi",CELL_2G:"2g",CELL_3G:"3g",CELL_4G:"4g",CELL:"cellular",NONE:"none"}})),cordova.define("cordova-plugin-device-motion.Acceleration",(function(e,t,r){r.exports=function(e,t,r,n){this.x=e,this.y=t,this.z=r,this.timestamp=n||(new Date).getTime()}})),cordova.define("cordova-plugin-device-motion.accelerometer",(function(e,t,r){var n=e("cordova/argscheck"),o=e("cordova/utils"),i=e("cordova/exec"),a=e("./Acceleration"),s=!1,c={},p=[],l=null;function u(){i((function(e){var t=p.slice(0);l=new a(e.x,e.y,e.z,e.timestamp);for(var r=0,n=t.length;r<n;r++)t[r].win(l)}),(function(e){for(var t=p.slice(0),r=0,n=t.length;r<n;r++)t[r].fail(e)}),"Accelerometer","start",[]),s=!0}function d(e,t){return{win:e,fail:t}}function f(e){var t=p.indexOf(e);t>-1&&(p.splice(t,1),0===p.length&&(i(null,null,"Accelerometer","stop",[]),s=!1))}var h={getCurrentAcceleration:function(e,t,r){var o;n.checkArgs("fFO","accelerometer.getCurrentAcceleration",arguments);var i=function(t){f(o),e(t)},a=function(e){f(o),t&&t(e)};o=d(i,a),p.push(o),s||u()},watchAcceleration:function(e,t,r){n.checkArgs("fFO","accelerometer.watchAcceleration",arguments);var i=r&&r.frequency&&"number"==typeof r.frequency?r.frequency:1e4,a=o.createUUID(),h=d((function(){}),(function(e){f(h),t&&t(e)}));return p.push(h),c[a]={timer:window.setInterval((function(){l&&e(l)}),i),listeners:h},s?l&&e(l):u(),a},clearWatch:function(e){e&&c[e]&&(window.clearInterval(c[e].timer),f(c[e].listeners),delete c[e])}};r.exports=h})),cordova.define("com.microsoft.siena.xmlhttprequest.XMLHttpRequest",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=window.XMLHttpRequest,o=e("cordova/utils"),i=e("com.microsoft.siena.xmlhttprequest.XMLHttpRequestExecutorFactory"),a=["set-cookie","set-cookie2"],s=function(){this._method=null,this._url=null,this._user=null,this._password=null,this._requestHeaders=Object.create(null),this._responseType="text",this._parsedResponseHeaders=null,this._readyState=null,this._response=null,this._responseText=null,this._status=null,this._statusText=null,this._isAborted=!1};o.defineGetter(s.prototype,"UNSENT",(function(){return 0})),o.defineGetter(s.prototype,"OPENED",(function(){return 1})),o.defineGetter(s.prototype,"HEADERS_RECEIVED",(function(){return 2})),o.defineGetter(s.prototype,"LOADING",(function(){return 3})),o.defineGetter(s.prototype,"DONE",(function(){return 4})),o.defineGetter(s.prototype,"readyState",(function(){return this._readyState})),o.defineGetter(s.prototype,"response",(function(){return this._response})),o.defineGetter(s.prototype,"responseText",(function(){return this._responseText})),o.defineGetter(s.prototype,"status",(function(){return this._status})),o.defineGetter(s.prototype,"statusText",(function(){return this._statusText})),o.defineGetterSetter(s.prototype,"onreadystatechange",(function(){return this._onreadystatechange}),(function(e){this._onreadystatechange=e})),o.defineGetterSetter(s.prototype,"responseType",(function(){return this._responseType}),(function(e){if(e||(e="text"),!this._canHandleResponseType(e))throw"responseType you requested is not supported.";this._responseType=e})),s.prototype.open=function(e,t,r,n,o){if(this._method=e,this._url=t,!1===r)throw"Synchronous XHR is not supported.";this._user=n,this._password=o},s.prototype.addEventListener=function(e,t){switch(e){case"load":this.onload=t;break;case"error":this.onerror=t}},s.prototype._canHandleResponseType=function(e){return"blob"===(e=e.toLowerCase())||"arraybuffer"===e||"json"===e||"text"===e},s.prototype.send=function(e){if(!this._canSendData(e))throw"Unsupported data type.";i.getRequestExecutor(this._url,new n).executeRequest(this._method,this._url,this._sendReadyStateResponse.bind(this),{responseType:this._responseType,overriddenRequestHeaders:this._requestHeaders,data:e,user:this._user,password:this._password})},s.prototype.getAllResponseHeaders=function(){if(this._parsedResponseHeaders){var e=[];for(var t in this._parsedResponseHeaders)-1===a.indexOf(t)&&e.push(t+": "+this._parsedResponseHeaders[t]);return e.join("\r\n")}return null},s.prototype.getResponseHeader=function(e){if(!this._parsedResponseHeaders||-1!==a.indexOf(e))return null;if(!e||!e.toLowerCase)return null;e=e.toLowerCase();var t=this._parsedResponseHeaders[e];return t||null},s.prototype.setRequestHeader=function(e,t){this._requestHeaders[e]=t},s.prototype.abort=function(){this._isAborted=!0},s.prototype.overrideMimeType=function(){throw"overrideMimeType is not supported."},s.prototype._canSendData=function(e){return e instanceof Blob||e instanceof ArrayBuffer||e instanceof Uint8Array||void 0===e||"string"==typeof e||null===e},s.prototype._sendReadyStateResponse=function(e){this._readyState=e.readyState,this._status=e.status,this._statusText=e.statusText,this._parsedResponseHeaders=e.allHeaders;var t=e.response;if("json"===this._responseType&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){}this._response=t,this._responseText=e.responseText,this.onreadystatechange&&!this._isAborted&&this.onreadystatechange(this),e.readyState===this.DONE&&this.onload&&!this._isAborted&&this.onload(this)},"x-ms-webview"===cordova.platformId||"iframe"===cordova.platformId?r.exports=s:r.exports=n,"ios"===cordova.platformId&&(r.exports=s)})),cordova.define("com.microsoft.siena.xmlhttprequest.ResponseHeaderParser",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=function(){};n.prototype.parseResponseHeader=function(e){var t=Object.create(null);return e?(e.split("\r\n").forEach((function(e){var r=e.indexOf(":");if(r>=0){var n=e.substring(0,r),o=e.substring(r+1,e.length);n=n.toLowerCase().trim(),o=o.trim();var i=t[n];i&&(o=i+", "+o),t[n]=o}})),t):t},r.exports=new n})),cordova.define("com.microsoft.siena.xmlhttprequest.XMLHttpRequestExecutorFactory",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=e("com.microsoft.siena.xmlhttprequest.LocalXMLHttpRequestExecutor"),o=e("com.microsoft.siena.xmlhttprequest.RemoteXMLHttpRequestExecutor");"ios"===cordova.platformId&&(o=e("com.microsoft.siena.xmlhttprequest.RemoteXMLHttpRequestExecutor_iOS"));var i=function(){};i.prototype.getRequestExecutor=function(e,t){e=e.toLowerCase();var r=!1;"iframe"===cordova.platformId&&(r=-1!==e.indexOf("localhost:")||-1!==e.indexOf("127.0.0.1:")||-1!==e.indexOf("[::1]:"));var i=0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("ms-appdata://");return(i=!r&&i)?new o:new n(t)},r.exports=new i})),cordova.define("com.microsoft.siena.xmlhttprequest.LocalXMLHttpRequestExecutor",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=e("com.microsoft.siena.xmlhttprequest.ResponseHeaderParser"),o=e("com.microsoft.siena.xmlhttprequest.LocalXhrUrlMapper"),i=function(e){this._originalXMLHttpRequest=e,this._localUrlMapperInstance=new o};i.prototype.executeRequest=function(e,t,r,o){var i=this;if(o=o||Object.create(null),t=this._localUrlMapperInstance.resolveUrl(t),this._originalXMLHttpRequest.onreadystatechange=function(){var e=n.parseResponseHeader(i._originalXMLHttpRequest.getAllResponseHeaders()),t=null;try{t=i._originalXMLHttpRequest.responseText}catch(e){console.log(e)}var o={readyState:i._originalXMLHttpRequest.readyState,responseText:t,response:i._originalXMLHttpRequest.response,status:i._originalXMLHttpRequest.status,statusText:i._originalXMLHttpRequest.statusText,allHeaders:e};r&&r(o)},this._originalXMLHttpRequest.open(e,t,!0,o.user,o.password),this._originalXMLHttpRequest.responseType=o.responseType,o.overriddenRequestHeaders){var a=o.overriddenRequestHeaders;Object.keys(a).forEach((function(e){i._originalXMLHttpRequest.setRequestHeader(e,a[e])}))}this._originalXMLHttpRequest.send(o.data)},r.exports=i})),cordova.define("com.microsoft.siena.xmlhttprequest.RemoteXMLHttpRequestExecutor",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=e("cordova/exec"),o=e("com.microsoft.siena.xmlhttprequest.RemoteXMLHttpResponseForwarder"),i=e("com.microsoft.siena.xmlhttprequest.ResponseHeaderParser"),a=0,s=function(){this._globalRequestId=a++,this._subRequestId=0,this._requestToCallback=Object.create(null)};s.prototype.executeRequest=function(e,t,r,i){this._subRequestId++;var a=this._globalRequestId+"_"+this._subRequestId;this._requestToCallback[a]=r,o.registerReadyStateChangeListener(a,this._handleResponse.bind(this)),n((function(){}),(function(){console.log("Error when trying to remotely execute XHR")}),"CrossDomainXMLHttpRequest","executeRequest",[a,e,t,i,i.data])},s.prototype._handleResponse=function(e){var t=this._convertArrayToResult(e),r=t.requestId;this._requestToCallback[r](t)},s.prototype._convertArrayToResult=function(e){var t=i.parseResponseHeader(e[5]);return{requestId:e[0],readyState:e[1],response:e[2],status:e[3],statusText:e[4],allHeaders:t,responseText:e[6]}},r.exports=s})),cordova.define("com.microsoft.siena.xmlhttprequest.RemoteXMLHttpResponseForwarder",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=e("cordova/utils"),o=function(){this._requestToHandler=Object.create(null),n.setupEventPipelineForPlugin&&(n.setupEventPipelineForPlugin(this,"CrossDomainXMLHttpRequest"),this.subscribeToEvent("onreadystatechange",this._onreadystatechange.bind(this)))};o.prototype._onreadystatechange=function(e){var t=e[0],r=this._requestToHandler[t];r&&r(e)},o.prototype.registerReadyStateChangeListener=function(e,t){this._requestToHandler[e]=t},o.prototype.unregisterReadyStateChangeListener=function(e){this._requestToHandler[e]=null},r.exports=new o})),cordova.define("com.microsoft.siena.xmlhttprequest.LocalXhrUrlMapper",(function(e,t,r){
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=function(e){this._mappings=e||window._localXhrMappings||{}};n.prototype.resolveUrl=function(e){for(var t in this._mappings)if(this._mappings.hasOwnProperty(t)){var r="file://"+t,n=this.getHostUrl()+this._mappings[t];if(0===e.indexOf("file:////")&&(e=e.replace("file:////","file:///private")),0===e.indexOf(r))return e=e.replace(r,n)}return e},n.prototype.getHostUrl=function(){var e=window.location.href.split("/");return e[0]+"//"+e[2]},r.exports=n}))},"694r":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return o(t,e),t.prototype.setProxyPath=function(e){this._proxyPath=e},t.prototype.resolveBlobPath=function(e){var t=e.substr(5);return"blob:"+(t=navigator.userAgent.match("Firefox")||navigator.userAgent.match("Safari")?t:t.replace(/:/gi,"%3A"))},t.prototype.resolveProxyPath=function(e){if(this._proxyPath&&-1===e.toLowerCase().indexOf(this._proxyPath.toLowerCase())){e=e.trim();for(var r=0;r<t._proxyRegexToSkip.length;r++){if(t._proxyRegexToSkip[r].test(e))return e}return this._proxyPath+encodeURIComponent(e)}return e},t._proxyRegexToSkip=[new RegExp(/^https:\/\/[\w\.\-]*\.logic\.azure\.com:443\/[\w]*/),new RegExp(/^https:\/\/[\w\.\-]*\.sharepoint\.com\/[\w]*/)],t}(r("p9nC").DefaultPathResolver);t.BaseWebPlayerPathResolver=i},"7/xZ":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.GenericEventEmitter=void 0;var n=r("GFE8"),o=function(){function e(){this._emitter=new n.EventEmitter}return e.prototype.on=function(e,t){this._emitter.on(e,t)},e.prototype.off=function(e,t){this._emitter.off(e,t)},e.prototype.emit=function(e,t){this._emitter.emit(e,t)},e.prototype.dispose=function(){this._emitter.removeAllListeners()},e}();t.GenericEventEmitter=o},"7HGc":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r("p9nC"),a=function(e){function t(t,r,n,o){var i=e.call(this)||this;return i._details=t,i._eventLogger=r,i._fallbackStaticContentProxy=n,i._staticContentUrl=o,i._remappedPaths={},i}return o(t,e),t.prototype.isSharedPath=function(e){var t=e;if(0===t.indexOf(".\\resources\\")&&-1!==t.indexOf(".resjson")){var r=(t=t.substring(1)).split("\\");t="";for(var n=0;n<r.length;n++)r[n].length>0&&(t+="/"+r[n])}return t=t.toLocaleLowerCase(),this._details.appDependencies[t]?(this._remappedPaths[e]=this._fixUrlForFallback(this._details.appDependencies[t]),!0):(t="/"+t,this._details.appDependencies[t]?(this._remappedPaths[e]=this._fixUrlForFallback(this._details.appDependencies[t]),!0):(this._details.nonSharedAppResources&&-1!==this._details.nonSharedAppResources.indexOf(e)||this.logPathNotResolved(e,"SplitPackagePathResolver",this._eventLogger),!1))},t.prototype._fixUrlForFallback=function(e){return i.DefaultPathResolver.addStaticContentProxyPathIfNeeded(e,this._fallbackStaticContentProxy,this._staticContentUrl)},t.prototype.resolveSharedPath=function(e){var t=this._remappedPaths[e];return t||this.isSharedPath(e)&&(t=this._remappedPaths[e]),t},t}(i.DefaultPathResolver);t.SplitPackagePathResolver=a},"7zYp":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r("DNn8"))},"8UAK":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r("tVVD")),n(r("0hda"))},B1BM:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n,o=r("wIJ5");!function(e){e[e.NotLoaded=0]="NotLoaded",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(n||(n={}));var i=function(){function e(e,t,r,i,a){this._urlParameterDictionary=e,this._htmlHelper=t,this._performanceHelper=r,this._eventLogger=i,this._cordovaObjectGetter=a,this._onCordovaLoadedCallbacks=[],this._loaderPath=this._urlParameterDictionary.getParameter(o.loaderKey),this._loadingState=n.NotLoaded}return e.prototype.load=function(e){var t=this;switch(this._loadingState){case n.Loading:return void this._onCordovaLoadedCallbacks.push(e);case n.Loaded:return void e();case n.NotLoaded:this._loadingState=n.Loading,this._onCordovaLoadedCallbacks.push(e),this._loadCordova((function(){t._loadingState=n.Loaded;for(var e=t._onCordovaLoadedCallbacks.length,r=0;r<e;r++){t._onCordovaLoadedCallbacks.shift()()}}))}},e.prototype._loadCordova=function(e){var t=this;if(this._performanceHelper.mark("cordovaLoadStart"),this._htmlHelper.addEventListener("deviceready",(function(){t._performanceHelper.measureFromMark("cordovaLoadTime","cordovaLoadStart"),t._eventLogger.logEvent("_onCordovaLoaded","Cordova load complete"),e()}),!1),"undefined"==typeof cordova){var r=this._loaderPath.replace("js/WebPlayer.Loader.js","iframeCordovaResources/cordova.js");this._htmlHelper.addScriptTag(r)}},e.prototype.makeCordovaRequest=function(e,t,r,n,i){if("undefined"==typeof cordova){var a={isPluginCall:!0,callbackId:"undefinedCordova",service:"AppLifecycle",action:"notifyAppFailed",actionArgs:["Cordova is undefined"],antiCSRFToken:this._urlParameterDictionary.getParameter(o.antiCSRFTokenKey)};this._htmlHelper.postMessageToParent(a)}else"function"==typeof cordova.exec&&cordova.exec(e,t,r,n,i)},e.prototype.getCordovaObject=function(){return this._cordovaObjectGetter?this._cordovaObjectGetter():window.cordova},e}();t.CordovaLoader=i},BHIv:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.createCanvasAppRuntimeErrorEvent=t.createAppHostRuntimeErrorEvent=t.createGetCanvasAppError=t.createRenderCanvasAppError=t.createGetAppMetadataError=void 0;var n=r("ynQx");t.createGetAppMetadataError=function(e){return new n.DefaultAppHostClientError({code:"getCanvasAppMetadataError",localizedMessage:"Error occurred during getting app metadata",description:e.message,timestamp:Date.now()})},t.createRenderCanvasAppError=function(e,t){return new n.DefaultAppHostClientError({code:"renderCanvasAppError",localizedMessage:"Error occurred during rendering the canvas app",description:e.message,timestamp:Date.now()},t)},t.createGetCanvasAppError=function(e){return new n.DefaultAppHostClientError({code:"getCanvasAppError",localizedMessage:"Error occurred during getting the canvas app",description:e,timestamp:Date.now()})},t.createAppHostRuntimeErrorEvent=function(e){return{errorInfo:{code:"runtimeAppHostError",localizedMessage:"Error occurred from the AppHost",description:e,timestamp:Date.now()}}},t.createCanvasAppRuntimeErrorEvent=function(e){return{errorInfo:{code:"runtimeCanvasAppError",localizedMessage:"Error occurred from the canvas app",description:e,timestamp:Date.now()}}}},C2F7:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),t.parseControlsListFromManifest=function(e){var t=[],r=e.controls;for(var n in r)n&&t.push(n.toLowerCase());return t},t.getAppDependencies=function(e){var t={};e.staticDependencies.forEach((function(e){t[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl}));var r=e.controlDependencies;for(var n in r)n&&r[n].forEach((function(e){e&&e.sourcePath&&(t[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl)}));return t},t.getAppSpecificResources=function(e){var t=[];return(null==e?void 0:e.app)&&(t=e.app),t},t.getDataComponentExpressionRuntime=function(e){var t,r={};return(null===(t=null==e?void 0:e.dataComponentDependencies)||void 0===t?void 0:t.expressionRuntime)&&e.dataComponentDependencies.expressionRuntime.forEach((function(e){r[e.sourcePath.toLocaleLowerCase()]=e.sourceUrl})),r},t.getDataComponentAppSpecificResources=function(e,t){var r,n=[];return(null===(r=null==e?void 0:e.dataComponentDependencies)||void 0===r?void 0:r[t])&&(n=e.dataComponentDependencies[t]),n},t.parseIndexHtml=function(e){for(var t,r,n,o,i=(new DOMParser).parseFromString(e,"text/html").head.getElementsByTagName("script"),a=[],s=0;s<i.length;s++){var c=i[s].text;-1!==c.indexOf("AppResources")?t=i[s].innerText:-1!==c.indexOf("AppPrefetchResources")?r=i[s].innerText:-1!==c.indexOf("LanguageSpecificResources")?n=i[s].innerText:-1!==c.indexOf("PowerAppsTitle")?o=i[s].innerText:a.push(i[s].outerHTML)}return{appResourcesScript:t,prefetchAppResourcesScript:r,languageResourcesScript:n,powerAppsTitleScript:o,headerScripts:a}}},DNTp:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,r,n,o,i,a,s,c,p,l,u){void 0===u&&(u=window);var d=e.call(this,t,r,n,o,i,a,s,null,p,l,u)||this;return d._appDetails=c,d}return o(t,e),t.prototype._getAppDetails=function(){this._processGetAppDetailsResponse(this._appDetails)},t}(r("mWmx").PublishedAppLoader);t.CanvasAppLoader=i},DNn8:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.MessageResponseSuccess="MessageResponseSuccess",e.MessageResponseError="MessageResponseError",e.Telemetry="Telemetry"}(t.ServiceWorkerMessageType||(t.ServiceWorkerMessageType={}))},Dwgu:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasAppCordovaEventInterceptor=t.routeCanvasAppCordovaRequest=void 0;var a=i(r("xjCR")),s=r("F10/"),c={applifecycle:["showtoastmessage","notifyappfailed","notifyapploaded"],runtimefunctionsplugin:["exitappasync"]},p={showtoastmessage:function(e){return{eventType:"canvasAppNotification",message:{notificationInfo:s.parseCanvasAppCordovaNotificationArgs(e),appHostInfo:a.getSingleton("AppHostInfo")}}},notifyappfailed:function(e){return{eventType:"canvasAppRuntimeError",message:s.parseCanvasAppCordovaErrorArgs(e)}},exitappasync:function(e){return{eventType:"canvasAppExitEvent",message:s.parseCanvasAppCordovaExitArgs(e)}},notifyapploaded:function(e){return{}}};t.routeCanvasAppCordovaRequest=function(e){if(!e)return null;var t=e.serviceName,r=e.actionName,n=e.args,o=t.toLowerCase(),i=r.toLowerCase(),a=c[o];if(!a||-1===a.indexOf(i))return null;try{return(0,p[i])(n)}catch(e){return null}};var l=function(){function e(e,t){this._canvasAppEventEmitter=e,this._nextInterceptor=t}return e.prototype.process=function(e){var r=t.routeCanvasAppCordovaRequest(e);return r&&(r.eventType&&r.message&&this._canvasAppEventEmitter.emit(r.eventType,r.message),e=null),this._nextInterceptor?this._nextInterceptor.process(e):e},e}();t.CanvasAppCordovaEventInterceptor=l},"F10/":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.parseUnsafeCordovaParameters=t.parseNotificationInfoFromAppHost=t.parseCanvasAppCordovaExitArgs=t.parseCanvasAppCordovaErrorArgs=t.parseCanvasAppCordovaNotificationArgs=t.parseCanvasAppMetadata=void 0;var n=r("FNbs"),o=r("BHIv");t.parseCanvasAppMetadata=function(e){var t=e,r=null==t?void 0:t.packageKind;if((null==t?void 0:t.appId)&&(null==t?void 0:t.appVersion)&&(null==t?void 0:t.webPlayerPackageDetails)&&(null==t?void 0:t.scriptPackageDetails)&&(r===n.PackageKind.split&&(null==t?void 0:t.splitPackageDetails)||r===n.PackageKind.zip&&(null==t?void 0:t.webPlayerZipDetails)))return t;throw new Error("Canvas app metadata is invalid")},t.parseCanvasAppCordovaNotificationArgs=function(e){if(!e)throw new Error("Canvas app Cordova notification args is null or undefined.");var t=e;if("string"==typeof t[0]&&"number"==typeof t[2]&&"boolean"==typeof t[3]){var r=void 0;return t[1]&&Array.isArray(t[1])&&(r=t[1].length>2?t[1][2]:t[1][0].replace("</div>","").replace("<div>","")),{notificationType:t[0],message:r,timeoutInMilliSec:t[2],preventDuplicates:t[3]}}throw new Error("Canvas app Cordova notification input data is invalid.")},t.parseCanvasAppCordovaErrorArgs=function(e){if(!e)throw new Error("Canvas app Cordova error args is null or undefined.");var t=e;return"string"==typeof t[0]?o.createCanvasAppRuntimeErrorEvent(t[0]):o.createCanvasAppRuntimeErrorEvent("Unknown error")},t.parseCanvasAppCordovaExitArgs=function(e){if(!e)throw new Error("Canvas app Cordova exit args is null or undefined.");var t=e;if("boolean"==typeof t[0])return{logout:t[0]};throw new Error("Canvas app Cordova exit args is invalid.")},t.parseNotificationInfoFromAppHost=function(e,t){if(!e||!e.toastMessage)throw new Error("Shared App Host notification input parameter is invalid.");var r;return e.toastMessage.linkClickHandlerKeys&&(r=new Array,e.toastMessage.linkClickHandlerKeys.forEach((function(n){null==r||r.push((function(){t.sendMessage({iframeId:e.iframeId,requestId:e.requestId,linkClickHandlerKey:n})}))}))),{notificationType:e.toastMessage.toastType,message:e.toastMessage.message,timeoutInMilliSec:e.toastMessage.timeout||1e5,preventDuplicates:!1,clickHandler:function(){t.sendMessage({iframeId:e.iframeId,requestId:e.requestId})},buttonClickHandlers:r}},t.parseUnsafeCordovaParameters=function(e){if(!e)return null;var t=e.serviceName,r=e.actionName,n=e.successCallback,o=e.errorCallback,i=e.args,a=e.commandContext;if("string"!=typeof t||"string"!=typeof r||n&&"function"!=typeof n||o&&"function"!=typeof o)throw new Error("Canvas app Cordova payload is invalid.");return{successCallback:n,errorCallback:o,serviceName:t,actionName:r,args:i,commandContext:a}}},FNbs:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.PowerAppsSharedAppHostIframeId=t.PackageKind=t.AuthMode=t.Endpoint=void 0,function(e){e.Local="https://apps.local.powerapps.com:44329",e.Test="https://apps.test.powerapps.com",e.Int="https://apps.int.powerapps.com",e.Preprod="https://apps.preprod.powerapps.com",e.Preview="https://apps.preview.powerapps.com",e.Prod="https://apps.powerapps.com",e.Gcc="https://apps.gov.powerapps.us",e.GccHigh="https://apps.high.powerapps.us"}(t.Endpoint||(t.Endpoint={})),function(e){e[e.Default=0]="Default",e[e.AuthFlowProxy=5]="AuthFlowProxy"}(t.AuthMode||(t.AuthMode={})),function(e){e[e.split=0]="split",e[e.zip=1]="zip",e[e.unknown=2]="unknown"}(t.PackageKind||(t.PackageKind={})),t.PowerAppsSharedAppHostIframeId="PowerAppsSharedAppHostIframe"},GFE8:function(e,t,r){"use strict";var n,o="object"==typeof Reflect?Reflect:null,i=o&&"function"==typeof o.apply?o.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function p(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var o,i,a,s;if(p(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),a=i[t]),void 0===a)a=i[t]=r,++e._eventsCount;else if("function"==typeof a?a=i[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(o=l(e))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=d.bind(n);return o.listener=r,n.wrapFn=o,o}function h(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):g(o,o.length)}function v(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else{var p=c.length,l=g(c,p);for(r=0;r<p;++r)i(l[r],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return p(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return p(t),this.prependListener(e,f(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,o,i,a;if(p(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){a=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},s.prototype.listenerCount=v,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},IVto:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.validateAppHostClientConfig=void 0;var n=r("xxPY"),o=[n.AuthMode.Default,n.AuthMode.AuthFlowProxy];t.validateAppHostClientConfig=function(e){if(!e)throw new Error("The AppHostClientConfig is null or undefined");var t=e.authMode;if(null==t||-1===o.indexOf(t))throw new Error("AuthMode is null, undefined or invalid")}},O4aM:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.split=0]="split",e[e.zip=1]="zip",e[e.unknown=2]="unknown"}(t.PackageKind||(t.PackageKind={}))},OQaO:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("1lt1"),o=function(){function e(e){this._config=e}return e.prototype.getWebPlayerZipDetails=function(e,t,r){var o=null;if(t===n.PackageKind.zip){var i=this._config.cdnPath,a=null;r&&(i=this._config.debugConfig.publishedAppResourceUrl,a=this._config.debugConfig.publishedAppResourceHash),"/"!==i.charAt(i.length-1)&&(i+="/"),null===a&&(a=e.hash),o={rootPath:i+=a+"/PlayerResources/"}}return o},e.prototype.getSplitPackageDetails=function(e,t){return t===n.PackageKind.split?{appDependencies:n.getAppDependencies(e),nonSharedAppResources:n.getAppSpecificResources(e)}:null},e.prototype.getDataComponentPackageDetails=function(e,t){return t===n.PackageKind.split&&(null==e?void 0:e.dataComponentDependencies)?{expressionRuntime:n.getDataComponentExpressionRuntime(e),scripts:n.getDataComponentAppSpecificResources(e,"scripts"),metadata:n.getDataComponentAppSpecificResources(e,"metadata")}:void 0},e.prototype.generateWebPlayerResourceDetails=function(){var e={};if(void 0!==window.ResourceLoader){e["js/MessageWorker.js"]=window.ResourceLoader.mapResourceUrl(document,"js/MessageWorker.js")}return{resourceMap:e}},e.prototype.generateWebPlayerDetails=function(e){var t=(e=e.split("#")[0]).split("?")[1],r=n.AppIndexWebFileName+"?";return e.indexOf(r)>=0?{host:e.replace(r,"").replace(t,""),queryString:"?"+t,proxyPath:this._config.webPlayerProxyUrl,timeUntilSASRenewalInMs:n.BasePublishedAppMetadataParser.getTimeUntilSASRenewalInMs(e)}:{host:e.replace(n.AppIndexWebFileName,""),queryString:"",proxyPath:this._config.webPlayerProxyUrl}},e.prototype.generateScriptPackageDetails=function(e,t){var r=n.parseIndexHtml(e);return{appResources:null==r?void 0:r.appResourcesScript,appLoadLinkResources:null==r?void 0:r.prefetchAppResourcesScript,languageSpecificResources:null==r?void 0:r.languageResourcesScript,powerAppsTitle:null==r?void 0:r.powerAppsTitleScript,headerScripts:null==r?void 0:r.headerScripts,updatedHash:t}},e.prototype.parseControlsListFromManifest=function(e){return n.parseControlsListFromManifest(e)},e}();t.AppMetadataResponseProcessor=o},OnJ6:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.initializeAsync=void 0;var i=r("uL4f");t.initializeAsync=function(e){return n(void 0,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,i.DefaultAppHostClient.initializeAsync(e)];case 1:return[2,t.sent()]}}))}))}},P6Pi:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0})},QIic:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&a(t,e,r);return s(t,e),t},p=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCanvasAppContainer=void 0;var d=r("YOZL"),f=r("BHIv"),h=r("7/xZ"),v=r("ZU/D"),g=c(r("xjCR")),_=r("Dwgu"),m=r("uguB"),y=function(e){function t(t,r,n,o,i){var a=e.call(this)||this;return a._appLogicalName=t,a._cordovaLoader=r,a._globalErrorHandler=n,a._eventLogger=o,a._telemetryUtil=i,a._cordovaInterceptor=new m.CordovaPayloadValidateInterceptor(new _.CanvasAppCordovaEventInterceptor(a)),a.renderAsync=a.renderAsync.bind(a),a._canvasAppRenderStartTime=0,a}return o(t,e),Object.defineProperty(t.prototype,"canvasAppInfo",{get:function(){return this._canvasAppInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderResolver",{get:function(){return this._renderResolver},enumerable:!1,configurable:!0}),t.prototype.renderAsync=function(e){var t;return p(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,p,u=this;return l(this,(function(l){switch(l.label){case 0:if(l.trys.push([0,2,,3]),!e)throw new Error("The config is null or undefined");if(r=e.containerDiv,n=e.params,!r)throw new Error("The containerDiv is null or undefined");return this._canvasAppRenderStartTime=Date.now(),[4,Promise.all([this._getAppDetailsAsync(),v.createCanvasAppIFrameAsync(r)])];case 1:if(o=l.sent(),i=o[0],this._iframe=o[1],!i||!i.appId)throw new Error("app logical name "+this._appLogicalName+" app metadata is corrupted.");if(!this._iframe.contentWindow)throw new Error("The content window inside the app iframe is undefined");return this._canvasAppInfo={appId:i.appId,containerDivId:r.id,appLogicalName:this._appLogicalName},a={appId:i.appId,appLogicalName:this._appLogicalName},s=this._createCordovaObject(a),this._iframe.contentWindow.Cordova=s,this._iframe.contentWindow.cordova=s,c=this._createCanvasAppLoader({contentWindow:this._iframe.contentWindow,canvasAppCordovaInstance:s,canvasAppMetadata:i},n),this._preparePublishedAppIFrame(c,n),[2,new Promise((function(e,t){u._renderResolver=e,u._renderRejecter=t,c.start()}))];case 2:throw p=l.sent(),this._telemetryUtil.trackException(p,{childCanvasAppId:null===(t=this._canvasAppInfo)||void 0===t?void 0:t.appId,childCanvasAppLogicalName:this._appLogicalName,message:"AppHostClientSDK.renderAsync failed"}),f.createRenderCanvasAppError(p,this._canvasAppInfo);case 3:return[2]}}))}))},t.prototype.dispose=function(){var t,r;try{null===(r=null===(t=this._iframe)||void 0===t?void 0:t.parentNode)||void 0===r||r.removeChild(this._iframe),this._iframe=null,e.prototype.dispose.call(this)}catch(e){}},t.prototype._createCanvasAppLoader=function(e,t){var r=this,n=e.contentWindow,o=e.canvasAppCordovaInstance,a=e.canvasAppMetadata,s=new d.HtmlHelper(n),c=new d.UrlParameterDictionary("",this._getPublishedIFrameHash(t)),p=new d.PerformanceHelper(n),l=new d.PublishedAppServiceWorkerManager((function(e){var t=e.error,n=t?i(i({},e),{error:t.toString()}):e;try{r._eventLogger.logEvent(e.eventName,JSON.stringify(n))}catch(t){r._eventLogger.logEvent(e.eventName,e.message)}}),c.getParameter(d.serviceWorkerUrlKey),{scope:"/"}),u={},f=c.getParameter(d.featureGatesKey);if(f)try{u=JSON.parse(f)}catch(e){this._eventLogger.logError("LoaderStart.FeatureGatesParsingFailure",e)}return new d.CanvasAppLoader(new d.CanvasAppCordovaLoader(o),s,p,this._onLoaderComplete.bind(this),c,this._globalErrorHandler,this._eventLogger,a,l,u,n)},t.prototype._preparePublishedAppIFrame=function(e,t){var r,n;if(!(null===(r=this._iframe)||void 0===r?void 0:r.contentDocument)||!(null===(n=this._iframe)||void 0===n?void 0:n.contentWindow))throw new Error("the contentDocument inside the iFrame is undefined");this._iframe.contentDocument.body.style.backgroundColor="transparent";var o=this._iframe.contentDocument.createElement("DIV");o.id="publishedCanvasContainer";var i=this._iframe.contentDocument.createElement("DIV");i.id="responsiveScalingCanvasHost",i.setAttribute("style","position: absolute; overflow: visible; width: 100vw; height: 100vh;");var a=this._iframe.contentDocument.createElement("DIV");a.id="publishedCanvas",i.appendChild(a),o.appendChild(i),this._iframe.contentDocument.body.appendChild(o),this._iframe.contentWindow.PublishedAppLoader=e,this._iframe.contentWindow.location.hash=this._getPublishedIFrameHash(t)},t.prototype._getPublishedIFrameHash=function(e){var t,r,n={hideNavBar:!0,antiCSRFToken:g.getSingleton("antiCSRFToken")};if(e){var o=[];try{for(var i=u(Object.keys(e)),a=i.next();!a.done;a=i.next()){var s=a.value;o.push(encodeURIComponent(s)+"="+encodeURIComponent(e[s]))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}n[d.paramsQueryKey]=o.join("&")}return encodeURIComponent(JSON.stringify(n))},t.prototype._getAppDetailsAsync=function(){var e=this;return new Promise((function(t,r){var n=e._cordovaLoader.getCordovaObject();if(!n)throw new Error("Cordova instance does not exist");n.exec((function(e){t(e)}),(function(e){r(e)}),"AppModuleService","getCanvasAppMetadata",[e._appLogicalName,!0])}))},t.prototype._createCordovaObject=function(e){var t=this,r=this._cordovaLoader.getCordovaObject();if(!r)throw new Error("Cordova instance does not exist");var n=Object.create(r),o=r.exec;return n.exec=function(r,n,i,a,s){var c=t._cordovaInterceptor.process({successCallback:r,errorCallback:n,serviceName:i,actionName:a,args:s,commandContext:e});if(c)return o(c.successCallback,c.errorCallback,c.serviceName,c.actionName,c.args,c.commandContext)},n},t.prototype._onLoaderComplete=function(){var e,t,r,n;if(!this._iframe||!this._iframe.contentWindow)throw null===(e=this._renderRejecter)||void 0===e||e.call(this),f.createRenderCanvasAppError(new Error("the iframe or the content window inside the iframe is null or undefined"));this._iframe.contentWindow.VersionSupportPlugin=function(e,t){return new VersionSupportPlugin(e,t)}(this._iframe.contentWindow.Core,this._iframe.contentWindow.AppMagic),null===(t=this._renderResolver)||void 0===t||t.call(this);var o=Date.now()-this._canvasAppRenderStartTime;this._telemetryUtil.trackEvent("AppHostClientSDK.canvasAppLoadComplete",{childCanvasAppId:null===(r=this._canvasAppInfo)||void 0===r?void 0:r.appId,childCanvasAppLogicalName:null===(n=this._canvasAppInfo)||void 0===n?void 0:n.appLogicalName,customPageLoadTime:o}),this._iframe.contentWindow.AppMagic.start();var i=this._iframe.contentWindow.document.createEvent("Events");i.initEvent("deviceready",!1,!1),this._iframe.contentWindow.document.dispatchEvent(i)},t}(h.GenericEventEmitter);t.DefaultCanvasAppContainer=y},QebW:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultIframeChannel=void 0;var i=function(e){function t(){var t=e.call(this)||this;return t._iframeMessageHandler=t._onMessageReceive.bind(t),window.addEventListener("message",t._iframeMessageHandler),t}return o(t,e),t.prototype.initializeAsync=function(e){var t=this;return this._initializePromise||(this._appHostIframeId=e,this._initializePromise=new Promise((function(e,r){t._initializePromiseResolve=e,t._initializePromiseReject=r}))),this._initializePromise},t.prototype.dispose=function(){this._initializePromise&&(window.removeEventListener("message",this._iframeMessageHandler),e.prototype.dispose.call(this))},t.prototype.sendMessage=function(e){var t;this._appHostSource&&this._appHostOrigin&&(null===(t=this._appHostSource)||void 0===t||t.postMessage(e,this._appHostOrigin))},t.prototype._onMessageReceive=function(e){try{var t=e.data;if(!t)return;var r=t.messageType;"initCommunication"===r?this._acknowledgeInitMessage(e):this.emit(r,t)}catch(e){}},t.prototype._acknowledgeInitMessage=function(e){var t=e.data;if(t.antiCSRFToken){if(this._appHostIframeId&&this._isFromHostIframe(t)){var r={messageType:"initCommunication",antiCSRFToken:t.antiCSRFToken,iframeIdToSendMessagesTo:"self"};this._appHostSource=e.source,this._appHostOrigin=e.origin,this.sendMessage(r),this._initializePromiseResolve&&this._initializePromiseResolve(t.antiCSRFToken)}}else this._initializePromiseReject&&this._initializePromiseReject("CsrfToken is empty")},t.prototype._isFromHostIframe=function(e){return e.iframeId===this._appHostIframeId},t}(r("7/xZ").GenericEventEmitter);t.DefaultIframeChannel=i,t.default=i},RfvM:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),t.SignedExpiryUrlParamKey="se",t.ManifestFileName="manifest.json",t.AppIndexWebFileName="index.web.html",function(e){e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable"}(t.HttpStatusCode||(t.HttpStatusCode={})),function(e){e.PublishedAppGetAppDetails="PublishedAppGetAppDetails",e.WebPlayerDownloadManifest="WebPlayerDownloadManifest",e.WebPlayerDownloadManifestRetry="WebPlayerDownloadManifestRetry",e.WebPlayerDownloadIndex="WebPlayerDownloadIndex",e.WebPlayerDownloadIndexRetry="WebPlayerDownloadIndexRetry"}(t.ScenarioName||(t.ScenarioName={}))},T4K4:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("p9nC"),o=function(){function e(e){this._batches={},this._targetWindow=e||window}return e.prototype.registerBatchScriptLoadMeasurement=function(e,t,r){this._batches[e]={startMarkerName:t,numberOfScripts:r}},e.prototype.markResourceInBatchAsLoaded=function(e){this._batches[e].numberOfScripts--,0===this._batches[e].numberOfScripts&&(this.measureFromMark(e,this._batches[e].startMarkerName),delete this._batches[e])},e.prototype.mark=function(e){this._targetWindow.performance.mark&&this._targetWindow.performance.mark(e)},e.prototype.measure=function(e,t,r){this._targetWindow.performance.measure&&this._targetWindow.performance.measure(e,t,r)},e.prototype.measureFromMark=function(e,t){if(this._targetWindow.performance.measure&&this._targetWindow.performance.mark){var r=t+"_End";this._targetWindow.performance.mark(r),this._targetWindow.performance.measure(name,t,r)}},e.prototype.getPerfData=function(e){var t={};try{this.measureFromMark("appMagicTime","appMagicStart")}catch(e){}if(this._targetWindow.performance.timing&&(t.publishedAppNavigationStart=this._targetWindow.performance.timing.navigationStart,t.publishedAppLoadEventEnd=this._targetWindow.performance.timing.loadEventEnd),this._targetWindow.performance.getEntriesByType){for(var r=this._targetWindow.performance.getEntriesByType("measure"),o=0;o<r.length;o++)switch(r[o].name){case"cordovaLoadTime":t.publishedAppCordovaLoadTime=r[o].duration,t.publishedAppCordovaLoadStart=r[o].startTime;break;case"getAppDetailsTime":t.publishedAppGetAppDetailsTime=r[o].duration,t.publishedAppGetAppDetailsStart=r[o].startTime;break;case"manageServiceWorkerTime":t.publishedAppManageServiceWorkerTime=r[o].duration,t.publishedAppManageServiceWorkerStart=r[o].startTime;break;case"preloadedScriptsLoadTime":t.publishedAppPreloadedScriptsLoadTime=r[o].duration,t.publishedAppPreloadedScriptsLoadStart=r[o].startTime;break;case"uniqueScriptLoadTime":t.publishedAppUniqueScriptLoadTime=r[o].duration,t.publishedAppUniqueScriptLoadStart=r[o].startTime;break;case"appMagicTime":t.publishedAppAppMagicTime=r[o].duration,t.publishedAppAppMagicStart=r[o].startTime}var i=this._targetWindow.performance.getEntriesByType("resource");if(e){var a=e.map((function(e){return i.filter((function(t){if(t.name.indexOf(e)>-1)return t})).pop()}));a&&(t.publishedAppScriptPerf=a)}for(o=0;o<i.length;o++){var s=i[o];if(!s)break;-1===s.name.indexOf("/cordova.js")?-1===s.name.indexOf(".js")?n.DefaultPathResolver.isPathToInitFile(s.name)?t.publishedAppLastScriptLoadEnd?t.publishedAppLastScriptLoadEnd<s.responseEnd&&(t.publishedAppLastScriptLoadEnd=s.responseEnd):t.publishedAppLastScriptLoadEnd=s.responseEnd:(-1!==s.name.indexOf("cordova_plugins.js")&&(t.publishedAppCordovaPluginsLoadStart=s.startTime),-1!==s.name.indexOf("/plugins/")&&(t.publishedAppCordovaPluginLastScriptLoadTime?t.publishedAppCordovaPluginLastScriptLoadTime<s.responseEnd&&(t.publishedAppCordovaPluginLastScriptLoadTime=s.responseEnd):t.publishedAppCordovaPluginLastScriptLoadTime=s.responseEnd),-1!==s.name.indexOf(".resjson")&&(t.publishedAppStringLoadStart?t.publishedAppStringLoadStart>s.startTime&&(t.publishedAppStringLoadStart=s.startTime):t.publishedAppStringLoadStart=s.startTime,t.publishedAppStringLoadEnd?t.publishedAppStringLoadEnd<s.responseEnd&&(t.publishedAppStringLoadEnd=s.responseEnd):t.publishedAppStringLoadEnd=s.responseEnd)):t.publishedAppFirstScriptLoadStart?t.publishedAppFirstScriptLoadStart>s.startTime&&(t.publishedAppFirstScriptLoadStart=s.startTime):t.publishedAppFirstScriptLoadStart=s.startTime:t.publishedAppCordovaJsLoadStart=s.startTime}}return t},e}();t.PerformanceHelper=o},YJsD:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._fetchResource=e,this._callbackArray=[],this._isDownloading=!1,this._cacheResource=void 0}return e.prototype.downloadResource=function(e,t,r){if(!this._isDownloading)return r?(this._cacheResource=void 0,void this._downloadResourceImpl(e,t,r)):void(this._cacheResource?t.onSuccess(this._cacheResource):this._downloadResourceImpl(e,t));this._callbackArray.push(t)},e.prototype._downloadResourceImpl=function(e,t,r){var n=this;this._callbackArray.push(t),this._isDownloading=!0,this._fetchResource(e,{onSuccess:function(e){n._cacheResource=e,n._isDownloading=!1;for(var t=n._callbackArray.length,r=0;r<t;r++){n._callbackArray.shift().onSuccess(e)}},onFailure:function(e){n._isDownloading=!1;for(var t=n._callbackArray.length,r=0;r<t;r++){n._callbackArray.shift().onFailure(e)}}},r)},e}();t.PublishedAppMetadataDownloader=n},YOZL:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("T4K4");t.PerformanceHelper=n.PerformanceHelper;var o=r("wIJ5");t.UrlParameterDictionary=o.UrlParameterDictionary,t.serviceWorkerUrlKey=o.serviceWorkerUrlKey,t.featureGatesKey=o.featureGatesKey,t.paramsQueryKey=o.paramsQueryKey;var i=r("v2e7");t.HtmlHelper=i.HtmlHelper;var a=r("yaqW");t.EventLogger=a.EventLogger;var s=r("B1BM");t.CordovaLoader=s.CordovaLoader;var c=r("/JvV");t.GlobalErrorHandler=c.GlobalErrorHandler;var p=r("mWmx");t.PublishedAppLoader=p.PublishedAppLoader;var l=r("2J/a");t.CanvasAppContainer=l.CanvasAppContainer;var u=r("sHKn");t.CanvasAppCordovaLoader=u.CanvasAppCordovaLoader;var d=r("DNTp");t.CanvasAppLoader=d.CanvasAppLoader;var f=r("hnwM");t.CanvasAppMetadataRetriever=f.CanvasAppMetadataRetriever;var h=r("tPh+");t.PublishedAppServiceWorkerManager=h.PublishedAppServiceWorkerManager},Yg39:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),t.first=function(e,t,r){var n=!1,o=e.length,i=[],a=0;e.forEach((function(e,s){e.execute((function(e){n||(n=!0,t(e))}),(function(e){n||(i[s]=e,++a==o&&r(i))}))}))}},"ZU/D":function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.createCanvasAppIFrameAsync=t.createAppHostIframeElement=void 0;var n=r("xxPY");t.createAppHostIframeElement=function(e){var t=document.createElement("iframe");if(t.style.display="none",t.addEventListener("load",(function(){t.style.display=""})),t.src=e,t.scrolling="no",t.setAttribute("allow","geolocation *; microphone *; camera *; fullscreen *"),t.id=n.PowerAppsSharedAppHostIframeId,t.name=n.PowerAppsSharedAppHostIframeId,t.setAttribute("style","position:absolute;left:0;right:0;bottom:0;top:0;width:0;height:0"),t.allowFullscreen=!0,!navigator.userAgent.match("Edge")){var r=["allow-popups","allow-popups-to-escape-sandbox","allow-same-origin","allow-scripts","allow-forms","allow-orientation-lock"];t.sandbox&&t.sandbox.add?r.forEach((function(e){return t.sandbox.add(e)})):t.setAttribute("sandbox",r.join(" "))}return t.style.boxSizing="border-box",t.style.border="none",t},t.createCanvasAppIFrameAsync=function(e){return new Promise((function(t,r){var n=document.createElement("IFRAME"),o="publishedCanvasContainer_"+Date.now();n.name=o,n.id=o,n.style.height="100%",n.style.width="100%",n.onload=function(){t(n)},n.onerror=function(){r("Failed to create iframe element for PublishedAppIFrame")},e.appendChild(n)}))}},aQ8v:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&i(t,e,r);return a(t,e),t},c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},p=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultAppHostClient=void 0;var l=r("YOZL"),u=r("xxPY"),d=r("IVto"),f=r("BHIv"),h=r("v8SN"),v=r("nMzY"),g=r("QebW"),_=r("+I9j"),m=r("7/xZ"),y=r("ZU/D"),b=s(r("xjCR")),w=s(r("F10/")),P=function(e){function t(t,r,n){var o=e.call(this)||this;return o._iframeChannel=t,o._cordovaChannel=r,o._config=n,o._onIframeErrorReceived=function(e){var t,r=(null===(t=null==e?void 0:e.sharedAppHostError)||void 0===t?void 0:t.message)?e.sharedAppHostError.message:"Unknown error details",n=f.createAppHostRuntimeErrorEvent(r);o.emit("appHostClientErrorEvent",n)},o._onIframeNotificationReceived=function(e){try{var t=w.parseNotificationInfoFromAppHost(e,o._iframeChannel),r={appHostInfo:b.getSingleton("AppHostInfo"),notificationInfo:t};o.emit("appHostClientNotification",r)}catch(e){b.getSingleton("EventLogger").logError("DefaultAppHostClient._onIframeNotificationReceived",e)}},o._disposableComponents=[],o._disposableComponents.push(o._iframeChannel),o._disposableComponents.push(o._cordovaChannel),o._antiCsrfToken="",o.getCanvasAppAsync=o.getCanvasAppAsync.bind(o),o}return o(t,e),t.initializeAsync=function(e){return c(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return p(this,(function(p){switch(p.label){case 0:if(document.getElementById(u.PowerAppsSharedAppHostIframeId))throw new Error("The appHostClient iframe already exists");return d.validateAppHostClientConfig(e),r=new l.UrlParameterDictionary("",""),n=new l.HtmlHelper(window),o=new l.PerformanceHelper(window),a=new l.EventLogger((function(){return i})),i=new l.CordovaLoader(r,n,o,a),b.register("UrlParameterDictionary",r),b.register("HtmlHelper",n),b.register("PerformanceHelper",o),b.register("EventLogger",a),b.register("CordovaLoader",i),b.register("GlobalErrorHandler",new l.GlobalErrorHandler),b.register("AppHostInfo",{rootAppId:e._rootAppId}),s=new v.DefaultCordovaChannel(b.getSingleton("CordovaLoader")),b.register("TelemetryUtil",new _.DefaultTelemetryUtil(s)),[4,(c=new t(new g.DefaultIframeChannel,s,e)).initializeAsync(e._rootAppId)];case 1:return p.sent(),[2,c]}}))}))},t.prototype.initializeAsync=function(e){return c(this,void 0,void 0,(function(){return p(this,(function(t){return this._initializePromise||(this._initializePromise=this._initializeAsync(e)),[2,this._initializePromise]}))}))},t.prototype.getCanvasAppMetadataAsync=function(e,t){return c(this,void 0,void 0,(function(){var r,n,o,i,a;return p(this,(function(s){switch(s.label){case 0:if(!this._initializePromise)throw f.createGetAppMetadataError(new Error("Please make sure the initialization is completed first."));if(!e)throw f.createGetAppMetadataError(new Error("appLogicalName should not be undefined or null."));return r=Date.now(),[4,this._initializePromise];case 1:return s.sent(),[4,this._cordovaChannel.sendMessage("AppModuleService","getCanvasAppMetadata",[e,!!t])];case 2:n=s.sent(),o=b.getSingleton("TelemetryUtil");try{return i=w.parseCanvasAppMetadata(n),a=Date.now()-r,o.trackEvent("AppHostClientSDK.getCanvasAppMetadataAsync",{childCanvasAppLogicalName:e,forceRefresh:t,message:"AppHostClientSDK.getCanvasAppMetadataAsync succeeded",callDuration:a}),[2,i]}catch(n){throw a=Date.now()-r,o.trackException(n,{childCanvasAppLogicalName:e,forceRefresh:t,message:"AppHostClientSDK.getCanvasAppMetadataAsync failed",callDuration:a}),f.createGetAppMetadataError(n)}return[2]}}))}))},t.prototype.getCanvasAppAsync=function(e){return c(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:if(!this._initializePromise)throw f.createGetCanvasAppError("Please make sure the initialization is completed first.");if(!e)throw f.createGetCanvasAppError("appLogicalName should not be undefined or null");return[4,this._initializePromise];case 1:return t.sent(),[2,new h.DefaultCanvasAppContainer(e,b.getSingleton("CordovaLoader"),b.getSingleton("GlobalErrorHandler"),b.getSingleton("EventLogger"),b.getSingleton("TelemetryUtil"))]}}))}))},t.prototype.dispose=function(){this._initializePromise&&(this._disposableComponents.forEach((function(e){e.dispose()})),this._appHostIframe&&(this._appHostIframe=void 0),e.prototype.dispose.call(this))},t.prototype._initializeAsync=function(e){return c(this,void 0,void 0,(function(){var t,r,n,o;return p(this,(function(i){switch(i.label){case 0:if(t=Date.now(),r=this._constructAppHostUrl(e),this._appHostIframe=y.createAppHostIframeElement(r),!this._appHostIframe)throw new Error("Fail to create te app host iframe");return document.body.appendChild(this._appHostIframe),n=this,[4,this._initializeIframeCommunication(this._appHostIframe.id)];case 1:if(n._antiCsrfToken=i.sent(),""===this._antiCsrfToken)throw new Error("Token should not be an empty string. Initialization failed !");return b.register("antiCSRFToken",this._antiCsrfToken),[4,this._cordovaChannel.initializeAsync(this._appHostIframe.id,this._antiCsrfToken)];case 2:return i.sent(),o=Date.now()-t,this._cordovaChannel.sendMessage("AppLifecycle","notifyAppLoaded",["",{rootAppId:e,sharedAppHostLoadTime:o}]),[2]}}))}))},t.prototype._initializeIframeCommunication=function(e){return c(this,void 0,void 0,(function(){return p(this,(function(t){switch(t.label){case 0:return this._iframeChannel.on("sendError",this._onIframeErrorReceived),this._iframeChannel.on("sendToast",this._onIframeNotificationReceived),[4,this._iframeChannel.initializeAsync(e)];case 1:return[2,t.sent()]}}))}))},t.prototype._constructAppHostUrl=function(e){var t,r,n={skipIframeCreation:"true",hideNavBar:"true",hostMode:"0",authMode:""+this._config.authMode,correlationId:(null===(t=this._config.hostConfig)||void 0===t?void 0:t.correlationId)||""},o=new URLSearchParams(n),i=null!==(r=this._config.endpoint)&&void 0!==r?r:u.Endpoint.Local;return""+(e?i+"/play/"+e+"?":i+"/play?")+o.toString()},t}(m.GenericEventEmitter);t.DefaultAppHostClient=P,t.default=P},ar2V:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("1lt1"),o=function(){function e(e,t){this._indexHtmlDownloader=e.indexHtmlDownloader,this._manifestJsonDownloader=e.manifestJsonDownloader,this._telemetryLogger=e.telemetryLogger,this._appMetadataResponseProcessor=e.appMetadataResponseProcessor,this._config=t,this._isInDebugMode=this._checkIfUsingDebugConfig(this._config.debugConfig)}return e.prototype._checkIfUsingDebugConfig=function(e){return e&&"string"==typeof e.publishedAppResourceHash&&"string"==typeof e.publishedAppResourceUrl},e.prototype.setAppDetails=function(e,t,r,o,i,a){this._appVersion=i,this._updatedHash=a,this._primaryWebPlayerPackageUrl=e,this._secondaryWebPlayerPackageUrl=t,this._packageKind=this._getPackageKindConfig(r,{isInDebugMode:this._isInDebugMode,isWebPlayerBVT:this._config.isWebPlayerBVT}),this._primaryWebPlayerManifestUrl=this._primaryWebPlayerPackageUrl.replace(n.AppIndexWebFileName,n.ManifestFileName),this._secondaryWebPlayerManifestUrl=this._secondaryWebPlayerPackageUrl.replace(n.AppIndexWebFileName,n.ManifestFileName),this._currentWebPlayerPackageUrl=this._primaryWebPlayerPackageUrl,this._currentWebPlayerManifestUrl=this._primaryWebPlayerManifestUrl,this._overrideSVGUpdateFunction=!o||o.minor<18e3&&o.major<3,this._overrideSVGUpdateFunction&&this._telemetryLogger.trackActivityEvent("WebPlayer.SVGUpdate.OverrideFunction"),this._isAppMetadataSet=!0},e.prototype.getAppDetails=function(e,t){var r=this;if(!this._config.isWebPlayer)throw this._telemetryLogger.error("PublishedAppMetadataParser.getAppDetails","GetAppDetails should only be called in web player"),"Not supported";this._isAppMetadataSet||e.onFailure(new Error("Please make sure you call setAppDetails first"));var o,i,a,s,c,p,l=this._telemetryLogger.startScenario(n.ScenarioName.PublishedAppGetAppDetails,new Date,{});this._telemetryLogger.updateOpenAppData({playerResourcesSplitEnabled:this._packageKind===n.PackageKind.split});var u=this._generateEmptyError(),d=this._generateEmptyError(),f=n.ProcessState.NotStart,h=n.ProcessState.NotStart;f=n.ProcessState.InProgress,this._downloadResourceImpl("manifest",{onSuccess:function(t){if(o=r._appMetadataResponseProcessor.getWebPlayerZipDetails(t,r._packageKind,r._isInDebugMode),i=r._appMetadataResponseProcessor.getSplitPackageDetails(t,r._packageKind),a=r._appMetadataResponseProcessor.generateWebPlayerDetails(r._currentWebPlayerPackageUrl),s=r._appMetadataResponseProcessor.generateWebPlayerResourceDetails(),p=r._appMetadataResponseProcessor.getDataComponentPackageDetails(t,r._packageKind),f=n.ProcessState.Processed,h===n.ProcessState.Processed){r._telemetryLogger.endScenario(l);var v={packageKind:r._packageKind,webPlayerZipDetails:o,webPlayerPackageDetails:a,webPlayerResourceDetails:s,splitPackageDetails:i,scriptPackageDetails:c,overrideSVGUpdateFunction:r._overrideSVGUpdateFunction,appVersion:r._appVersion,appId:r._config.appId};p&&(v.dataComponentPackageDetails=p),e.onSuccess(v)}else h===n.ProcessState.Error&&(r._telemetryLogger.failScenario(l,{}),e.onFailure(r._mergeErrorMessage(u,d)))},onFailure:function(t){u=t,f=n.ProcessState.Error,h!==n.ProcessState.Processed&&h!==n.ProcessState.Error||(r._telemetryLogger.failScenario(l,{}),e.onFailure(r._mergeErrorMessage(u,d)))}},t,!0),h=n.ProcessState.InProgress,this._downloadResourceImpl("index",{onSuccess:function(t){if(c=r._appMetadataResponseProcessor.generateScriptPackageDetails(t,r._updatedHash),h=n.ProcessState.Processed,f===n.ProcessState.Processed){r._telemetryLogger.endScenario(l);var v={packageKind:r._packageKind,webPlayerZipDetails:o,webPlayerPackageDetails:a,webPlayerResourceDetails:s,splitPackageDetails:i,scriptPackageDetails:c,overrideSVGUpdateFunction:r._overrideSVGUpdateFunction,appVersion:r._appVersion,appId:r._config.appId};p&&(v.dataComponentPackageDetails=p),e.onSuccess(v)}else f===n.ProcessState.Error&&(r._telemetryLogger.failScenario(l,{}),e.onFailure(r._mergeErrorMessage(u,d)))},onFailure:function(t){d=t,h=n.ProcessState.Error,f!==n.ProcessState.Processed&&f!==n.ProcessState.Error||(r._telemetryLogger.failScenario(l,{}),e.onFailure(r._mergeErrorMessage(u,d)))}},t,!0)},e.prototype._generateEmptyError=function(){var e=new Error;return e.name="",e.message="",e.stack="",e},e.prototype._mergeErrorMessage=function(e,t){var r=new Error;return r.name="Failed to get and parse appMetadata",r.message=e.message+"\n"+t.message,r.stack=e.stack+"\n"+t.stack,r},e.prototype.getAppControls=function(e,t){var r=this;this._downloadResourceImpl("manifest",{onSuccess:function(t){var n=r._appMetadataResponseProcessor.parseControlsListFromManifest(t);e.onSuccess(n)},onFailure:function(t){e.onFailure(t)}},t,!0)},e.prototype.getAppDependencies=function(e,t){this._downloadResourceImpl("manifest",{onSuccess:function(t){e.onSuccess(t)},onFailure:function(t){e.onFailure(t)}},t,!0)},e.prototype._downloadResourceImpl=function(e,t,r,o){var i=this,a="index"===e?n.ScenarioName.WebPlayerDownloadIndex:n.ScenarioName.WebPlayerDownloadManifest;o?"index"===e?this._currentWebPlayerPackageUrl=this._primaryWebPlayerPackageUrl:this._currentWebPlayerManifestUrl=this._primaryWebPlayerManifestUrl:"index"===e?this._currentWebPlayerPackageUrl=this._secondaryWebPlayerPackageUrl:this._currentWebPlayerManifestUrl=this._secondaryWebPlayerManifestUrl;var s="index"===e?this._indexHtmlDownloader:this._manifestJsonDownloader,c=this._telemetryLogger.startScenario(a,new Date),p={url:"index"===e?this._currentWebPlayerPackageUrl:this._currentWebPlayerManifestUrl,method:"GET"};s.downloadResource(p,{onSuccess:function(e){i._telemetryLogger.endScenario(c),t.onSuccess(e)},onFailure:function(r){var n="index"===e?"Failed to download indexWebHtml":"Failed to download manifest";i._telemetryLogger.failScenario(c,{message:n}),o?i._downloadResourceImpl(e,t,!0,!1):t.onFailure(r)}},r)},e._getSASKeyExpiryDate=function(e){var t=this.getUrlParams(e,n.SignedExpiryUrlParamKey);return new Date(decodeURIComponent(t))},e.getUrlParams=function(e,t){var r=new RegExp("[?&]"+t+"=([^&#]*)").exec(e);return null==r?null:decodeURI(r[1])||null},e.isSASKeyExpired=function(e){var t=this._getSASKeyExpiryDate(e);return(new Date).getTime()>t.getTime()},e.getTimeUntilSASRenewalInMs=function(e){var t=288e5,r=this._getSASKeyExpiryDate(e).getTime()-(new Date).getTime();r<t&&(t=r);var n=t-6e5;return n<=0?0:n},e.prototype._getPackageKindConfig=function(e,t){var r;return r=n.PackageKind.zip,t.isWebPlayerBVT||t.isInDebugMode||(r="split"===(null==e?void 0:e.toLocaleLowerCase())?n.PackageKind.split:n.PackageKind.zip),r},e}();t.BasePublishedAppMetadataParser=o},"b+CK":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NotStart=0]="NotStart",e[e.InProgress=1]="InProgress",e[e.Processed=2]="Processed",e[e.Error=3]="Error"}(t.ProcessState||(t.ProcessState={}))},"e5/K":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=r("fy70"),s=r("7zYp"),c=function(){function e(t,r,o,i){var c=this;if(void 0===i&&(i=navigator),this._logEvent=t,this._serviceWorkerScriptUrl=r,this._serviceWorkerRegistrationOptions=o,this._navigator=i,this._isMessageTimedOut=!1,this.handleMessageTimeout=function(e){return function(){c._isMessageTimedOut=!0,c._disposeMessageTimeout(),e(a.ServiceWorkerManagerResult.MessageTimeout,new Error("Message to service worker timed out."))}},this.handleMessageFromServiceWorker=function(e,t){return function(r){c._disposeMessageTimeout();var o=Date.now(),i=null==r?void 0:r.data;if(i){var p=n({},i);if(i.messageType===s.ServiceWorkerMessageType.MessageResponseSuccess||i.messageType===s.ServiceWorkerMessageType.MessageResponseError){var l=i.sendStart;p.metrics={timeForServiceWorkerToReceiveAndProcessMessageInMs:l-t,timeForManagerToReceiveMessageInMs:o-l}}if(c._logEvent(p),!c._isMessageTimedOut)switch(i.messageType){case s.ServiceWorkerMessageType.MessageResponseError:e(a.ServiceWorkerManagerResult.Error,new Error(i.message));break;case s.ServiceWorkerMessageType.MessageResponseSuccess:e(a.ServiceWorkerManagerResult.SentMessage)}}else e(a.ServiceWorkerManagerResult.Error,new Error("Service worker responded with no data."))}},!(t instanceof Function))throw new Error(e._className+"._logEvent must be of type function.");this._messageChannel=new MessageChannel}return e.prototype.isBrowserSupportingServiceWorkers=function(){return"serviceWorker"in this._navigator},e.prototype.registerServiceWorkerAsync=function(){return o(this,void 0,void 0,(function(){var t;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this._navigator.serviceWorker.register(this._serviceWorkerScriptUrl,this._serviceWorkerRegistrationOptions)];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),this._logEvent({messageType:s.ServiceWorkerMessageType.Telemetry,eventName:e._className+".registerServiceWorkerAsync.failure",message:"Failed to register service worker: ("+this._serviceWorkerScriptUrl+").",error:t}),[3,3];case 3:return[2]}}))}))},e.prototype.unregisterServiceWorkersAsync=function(e){return o(this,void 0,void 0,(function(){var t,r,n,o;return i(this,(function(i){switch(i.label){case 0:if(!this.isBrowserSupportingServiceWorkers())return e(a.ServiceWorkerManagerResult.Error,new Error("Service workers are not supported by this browser.")),[2];i.label=1;case 1:return i.trys.push([1,9,,10]),[4,this._navigator.serviceWorker.getRegistrations()];case 2:return 0!==(t=i.sent()).length?[3,3]:(e(a.ServiceWorkerManagerResult.UnregisteredNothing),[3,8]);case 3:r=0,n=t,i.label=4;case 4:return r<n.length?[4,n[r].unregister()]:[3,7];case 5:i.sent(),i.label=6;case 6:return r++,[3,4];case 7:e(a.ServiceWorkerManagerResult.Unregistered),i.label=8;case 8:return[3,10];case 9:return o=i.sent(),e(a.ServiceWorkerManagerResult.Error,o),[3,10];case 10:return[2]}}))}))},e.prototype._sendMessageToServiceWorker=function(t,r,n){r?(this._isMessageTimedOut=!1,this._messageChannel.port1.onmessage=this.handleMessageFromServiceWorker(n,Date.now()),r.postMessage(t,[this._messageChannel.port2]),this._messageTimeoutHandle=setTimeout(this.handleMessageTimeout(n),e._messageTimeoutMilliseconds)):n(a.ServiceWorkerManagerResult.Error,new Error("Service worker is undefined."))},e.prototype._disposeMessageTimeout=function(){this._messageTimeoutHandle&&(clearTimeout(this._messageTimeoutHandle),this._messageTimeoutHandle=null)},e._className="ServiceWorkerManager",e._messageTimeoutMilliseconds=5e3,e}();t.ServiceWorkerManager=c},fy70:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DisabledAndNotRegistered="DisabledAndNotRegistered",e.Error="Error",e.Ignore="Ignore",e.MessageTimeout="MessageTimeout",e.NotSupported="NotSupported",e.Registering="Registering",e.SentMessage="SentMessage",e.Unregistered="Unregistered",e.UnregisteredNothing="UnregisteredNothing"}(t.ServiceWorkerManagerResult||(t.ServiceWorkerManagerResult={}))},hnwM:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,r,n,o,i){var a=e.call(this,r,n,o,i)||this;if(a._appLogicalName=t,!t)throw new Error("App logical name not provided");return a}return o(t,e),t.prototype._getAppDetailsInternal=function(){var e=this;this._cordovaLoader.load((function(){e._performanceHelper.mark("getAppDetailStart"),e._cordovaLoader.makeCordovaRequest((function(t){e._performanceHelper.measureFromMark("getAppDetailsTime","getAppDetailStart"),e._processSuccessScenarios(t)}),(function(t){e._processFailureScenarios(t)}),"AppModuleService","getCanvasAppMetadata",[e._appLogicalName]),e._eventLogger.logEvent("_getAppDetails","GetAppDetails requested")}))},t}(r("1Td8").AppDetailsRetriever);t.CanvasAppMetadataRetriever=i},iFou:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),t.generate128BitUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){return function(e,t){var r=(e+16*Math.random())%16|0;return("x"===t?r:3&r|8).toString(16)}(e,t)}))},t.setSearchParameterWithoutRefresh=function(e,t,r){var n;try{n=new URL(r.location.href)}catch(e){return}if(!e||!t)throw new Error("ServiceWorkerManagerUtil.setSearchParameterWithoutRefresh.invalidParameters: name: "+e+", value: "+t);n.searchParams.set(e,t);var o=n.toString();r.history.replaceState({path:o},"",o)}},kYtC:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r("p9nC"),a=function(e){function t(t,r,n,o){var i=e.call(this)||this;return i._preloadResourceDetails=t,i._eventLogger=r,i._staticContentFallbackProxy=n,i._staticContentUrl=o,i._paths={},i._parseAppResources(),i._parseLocaleSpecificResources(),i}return o(t,e),t.prototype._parseAppResources=function(){for(var e=0;e<AppResources.length;e++)this._paths[AppResources[e].url]=this._fixPath(AppResources[e].src)},t.prototype._parseLocaleSpecificResources=function(){for(var e=0;e<LocaleSpecificResources.length;e++){var t="."+LocaleSpecificResources[e].url.split("/").join("\\");this._paths[t]=this._fixPath(LocaleSpecificResources[e].src)}},t.prototype._fixPath=function(e){var t=e.replace("_CDN_PATH_",this._preloadResourceDetails.cdnPath);return i.DefaultPathResolver.addStaticContentProxyPathIfNeeded(t,this._staticContentFallbackProxy,this._staticContentUrl)},t.prototype.isSharedPath=function(e){return!!this._paths[e]},t.prototype.resolveSharedPath=function(e){return this._paths[e]||this.logPathNotResolved(e,"PreloadResourcesPathResolver",this._eventLogger),this._paths[e]},t}(i.DefaultPathResolver);t.PreloadResourcesPathResolver=a},mWmx:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=r("+kCY"),o=r("wIJ5"),i=r("1lt1"),a=r("kYtC"),s=function(){function e(t,r,n,i,a,s,c,p,l,u,d){var f=this;void 0===d&&(d=window),this._cordovaLoader=t,this._htmlHelper=r,this._performanceHelper=n,this._onLoaderComplete=i,this._urlParameterDictionary=a,this._globalErrorHandler=s,this._eventLogger=c,this._appDetailsRetriever=p,this._publishedAppServiceWorkerManager=l,this._featureGates=u,this._targetWindow=d,this._eightHoursInMs=288e5,this._isAppLoaded=!1,this._loggingUrls=[],this._nonWindowsSpecificStyles=["css/fonts.css"],this._remainingAppPrefetchResourcesToLoad=[],this._savedConflicts=[],this._manageServiceWorkerCallback=function(t,r){f._performanceHelper.mark("manageServiceWorkerEnd"),f._performanceHelper.measure("manageServiceWorkerTime","manageServiceWorkerStart","manageServiceWorkerEnd"),r?f._eventLogger.logError(e._className+"._manageServiceWorkerCallback.failure",r):f._eventLogger.logEvent(e._className+"._manageServiceWorkerCallback.success",t),f._loadAppResources(f._targetWindow.AppResources)},this._totalScriptsToBeLoaded=0,this._numberOfScriptsLoaded=0,this._errors=[],this._injectedScripts={};var h=this._urlParameterDictionary.getParameter(o.fallbackStaticContentKey);this._fallbackToStaticContentProxy="true"===h,this._reloadWithStaticContentProxyInProgress=!1,this._fallbackToStaticContentProxy&&(this._fallbackStaticContentProxy=this._urlParameterDictionary.getParameter(o.staticContentProxyKey)),this._staticContentUrl=this._urlParameterDictionary.getParameter(o.staticContentUrlKey),this._globalErrorHandler&&this._globalErrorHandler.addHandler((function(e){return f._handleGlobalError(e)})),this._targetWindow.top===this._targetWindow.parent&&this._injectPrintCSS()}return e.prototype.start=function(){var e=this,t=parseInt(this._urlParameterDictionary.getParameter("packagePropertiesVersion"),10);(t=isNaN(t)?0:t)>=2&&this._preloadResourcesIfCDNExists(),this._getAppDetails(),this._cordovaLoader.load((function(){e._notifyAppIndexLoaded(),t<2&&e._preloadResourcesIfCDNExists()}))},e.prototype._getAppDetails=function(){var e=this;this._appDetailsRetriever.getAppDetails({onAppDetailsReceived:function(t){e._cordovaLoader.load((function(){return e._processGetAppDetailsResponse(t)}))},onFailure:function(t){e._notifyAppFailed(t.name,t.message)}})},e.prototype._preloadResourcesIfCDNExists=function(){var e=this._urlParameterDictionary.getParameter(o.cdnUrlKey);e&&this._preloadResources({cdnPath:e})},e.prototype.isWebPlayerLoader=function(){return!0},e.prototype.isReactNativeLoader=function(){return!1},e.prototype.getPerformanceJsonData=function(){return this._isAppLoaded=!0,this._dismissSpinner(),this._getPerfDataString()},e.prototype._dismissSpinner=function(){if(!this._targetWindow.PublishedAppLoader_supportsSpinner){var e=this._targetWindow.document.querySelector("#screenLoadingPlaceholder .spinnerOverlay");e&&e.parentElement&&e.parentElement.removeChild(e)}},e.prototype._resolveSharedPath=function(e){return this._pathResolver.resolveSharedPath(e)},e.prototype._resolveAppPathWithCallback=function(e,t){this._pathResolver.resolveAppPathWithCallback(e,t)},e.prototype._resolveAppPath=function(e){return this._pathResolver.resolveAppPath(e)},e.prototype._resolveAppResourcePathWithCallback=function(e,t){e.isShared?t(this._resolveSharedPath(e.url)):this._resolveAppPathWithCallback(e.url,t)},e.prototype.resolveAppAssetPath=function(e){var t=this._tryResolveAppAssetPath(e);return t||this._resolveAppPath(e)},e.prototype.resolveAppAssetPathWithCallback=function(e,t){var r=this._tryResolveAppAssetPath(e);r?t(r):this._resolveAppPathWithCallback(e,t)},e.prototype.createProxyPath=function(e){return this._pathResolver.resolveProxyPath(e)},e.prototype.loadRemainingPrefetchResources=function(){this._remainingAppPrefetchResourcesToLoad.length>0&&this._loadAppLoadLinkResources(this._remainingAppPrefetchResourcesToLoad)},e.prototype._tryResolveAppAssetPath=function(e){if(!e)return this._handleErrorInResolveAppAssetPath("path is undefined","undefined"),null;if("function"!=typeof e.indexOf)return this._handleErrorInResolveAppAssetPath("The path object does not support indexOf function",typeof e),null;var t=e.toLowerCase();return 0===t.indexOf("appres://")?this._pathResolver.resolveAppResPath(e):0===t.indexOf("http:")||0===e.indexOf("https:")?this._pathResolver.resolveHttpsPath(e):0===t.indexOf("blob:")?this._pathResolver.resolveBlobPath(e):0===t.indexOf("data:")?this._pathResolver.resolveDataPath(e):this._pathResolver.isSharedPath(e)?this._resolveSharedPath(e):null},e.prototype._processGetAppDetailsResponseDefault=function(e){var t=this;if(this._config.packageKind===i.PackageKind.split&&!this._config.splitPackageDetails||this._config.packageKind===i.PackageKind.zip&&!this._config.webPlayerZipDetails)return this._notifyAppFailed("Missing app details",JSON.stringify(e)),!1;this._pathResolver=new n.WebPlayerPathResolver(this._config.splitPackageDetails,this._config.webPlayerZipDetails,this._config.webPlayerPackageDetails,this._config.webPlayerResourceDetails,this._eventLogger,this._fallbackStaticContentProxy,this._staticContentUrl),this._config.scriptPackageDetails&&(this._config.scriptPackageDetails.headerScripts&&this._htmlHelper.addHeaderScripts(this._config.scriptPackageDetails.headerScripts),this._config.scriptPackageDetails.updatedHash&&this._htmlHelper.updateHash(this._config.scriptPackageDetails.updatedHash),this._config.scriptPackageDetails.appResources?(this._htmlHelper.runAndRemoveScript(this._config.scriptPackageDetails.appResources),this._eventLogger.logEvent("_processGetAppDetailsResponseDefault","Second set of files received")):this._notifyAppFailed("Missing app resources",JSON.stringify(e)),this._config.scriptPackageDetails.appLoadLinkResources&&this._htmlHelper.runAndRemoveScript(this._config.scriptPackageDetails.appLoadLinkResources,(function(e){t._notifyAppFailed("Malformed app load link resources for preload scenario",t._config.scriptPackageDetails.appLoadLinkResources)})),this._config.scriptPackageDetails.languageSpecificResources&&this._htmlHelper.runAndRemoveScript(this._config.scriptPackageDetails.languageSpecificResources),this._config.scriptPackageDetails.powerAppsTitle&&this._htmlHelper.runAndRemoveScript(this._config.scriptPackageDetails.powerAppsTitle));var r=this._targetWindow.AppResources.filter((function(e){return e.isScript&&-1===e.url.indexOf("cordova.js")}));return this._checkForConflictingScripts(r),this._manageServiceWorkerAndLoadAppResources(),this._targetWindow.LanguageSpecificResources&&this._loadLanguageSpecificResources(this._targetWindow.LanguageSpecificResources),this._targetWindow.PowerAppsTitle&&(this._targetWindow.document.title=this._targetWindow.PowerAppsTitle),this._startInitialResourcePreloadAndPrefetch(),!0},e.prototype._processGetAppDetailsResponse=function(e){if(this._config=e,this._config.webPlayerPackageDetails){if(this._processGetAppDetailsResponseInternal(e)){var t=this._config.webPlayerPackageDetails.timeUntilSASRenewalInMs;null!=t&&this._setSASKeyRefreshTimer(t),this._eventLogger.logEvent("_getAppDetails","GetAppDetails succeeded")}}else this._notifyAppFailed("Missing app details",JSON.stringify(e))},e.prototype._processGetAppDetailsResponseInternal=function(e){return this._processGetAppDetailsResponseDefault(e)},e.prototype._setSASKeyRefreshTimer=function(e){var t=this;this._sasRefreshTimer&&clearTimeout(this._sasRefreshTimer),this._sasRefreshTimer=setTimeout((function(){t._renewSASKey(t._eightHoursInMs)}),e)},e.prototype._renewSASKey=function(e){var t=this;this._cordovaLoader.makeCordovaRequest((function(e){t._setSASKeyRefreshTimer(t._eightHoursInMs),t._config.webPlayerPackageDetails=e,t._pathResolver=new n.WebPlayerPathResolver(t._config.splitPackageDetails,t._config.webPlayerZipDetails,t._config.webPlayerPackageDetails,t._config.webPlayerResourceDetails,t._eventLogger)}),(function(e){}),"AppDependenciesResolver","refreshWebPlayerPackageDetails")},e.prototype._preloadResources=function(e){var t=this;if(this._targetWindow.AppResources){void 0===typeof window.cordova&&(window.cordova={platformId:"iframe"}),this._pathResolver=new a.PreloadResourcesPathResolver(e,this._eventLogger,this._fallbackStaticContentProxy,this._staticContentUrl);var r=this._targetWindow.AppResources.filter((function(e){return e.isScript&&-1===e.url.indexOf("cordova.js")})),n=this._targetWindow.AppResources.filter((function(e){return!e.isScript}));this._checkForConflictingScripts(r,e.cdnPath);for(var o=[],i=[],s=0;s<n.length;s++)o.push(this._resolveSharedPath(n[s].url));o=o.concat(this._getPlatformSpecificStyleUrls()),this._htmlHelper.addStyleSheetLinkTags(o),this._totalScriptsToBeLoaded=r.length,this._performanceHelper.mark("sharedScriptLoadStart"),this._performanceHelper.registerBatchScriptLoadMeasurement("preloadedScriptsLoadTime","sharedScriptLoadStart",r.length);for(s=0;s<r.length;s++)i.push(this._resolveSharedPath(r[s].url));this._htmlHelper.addScriptTags(i,(function(){t._performanceHelper.markResourceInBatchAsLoaded("preloadedScriptsLoadTime")}),(function(e){t._notifyAppFailedWithScriptErrors(e)})),this._loggingUrls=this._loggingUrls.concat(i,o),this._eventLogger.logEvent("_preloadResources","Initial published app load complete")}},e.prototype._checkForConflictingScripts=function(t,r){var n=this;t.forEach((function(t){var o,i;if(t.isScript&&t.src){var a=t.url.replace(/^(\/)/,""),s=t.src;if(r&&(s=s.replace(/_CDN_PATH_/,r)),n._injectedScripts[a]&&n._injectedScripts[a]!==s){var c={injectedResource:n._injectedScripts[a],conflictingResource:JSON.stringify(t)};void 0!==n._targetWindow.Core&&(null===(i=null===(o=n._targetWindow.Core.Telemetry)||void 0===o?void 0:o.Log)||void 0===i?void 0:i.trackErrorEvent)?(n._savedConflicts.length>0&&(n._savedConflicts.forEach((function(t){n._targetWindow.Core.Telemetry.Log.trackErrorEvent(e._className+"._checkForConflictingScripts",t)})),n._savedConflicts=[]),n._targetWindow.Core.Telemetry.Log.trackErrorEvent(e._className+"._checkForConflictingScripts",c)):n._savedConflicts.push(c)}else n._injectedScripts[a]||(n._injectedScripts[a]=s)}})),this._eventLogger.logEvent("_checkForConflictingScripts","Initial js files injected")},e.prototype._createLoadResource=function(e){return{url:e.src,category:"fetch",mimeType:"application/octet-stream",rel:"preload"}},e.prototype._loadLanguageSpecificResources=function(e){var t;t=e.map(this._createLoadResource),this._htmlHelper.addLoadLinkTags(t)},e.prototype._manageServiceWorkerAndLoadAppResources=function(){var e,t;this._performanceHelper.mark("manageServiceWorkerStart"),this._publishedAppServiceWorkerManager.start({appId:null===(e=this._config)||void 0===e?void 0:e.appId,appVersion:null===(t=this._config)||void 0===t?void 0:t.appVersion},this._manageServiceWorkerCallback,!!this._featureGates.publishedAppServiceWorker)},e.prototype._loadAppResources=function(e){for(var t=this,r=e.filter((function(e){return e.isScript&&-1===e.url.indexOf("cordova.js")})),n=e.filter((function(e){return!e.isScript})),o=0,i=0,a={},s={},c=function(e,c,p){if(c?(o++,a[p]=e):(i++,s[p]=e),o===r.length&&i===n.length){for(var l=[],u=0;u<o;u++)l.push(a[u]);var d=[];for(u=0;u<i;u++)d.push(s[u]);d=d.concat(t._getPlatformSpecificStyleUrls()),t._htmlHelper.addStyleSheetLinkTags(d),t._htmlHelper.addScriptTags(l,(function(){t._onResourceLoaded()}),(function(e){t._onScriptError(e)})),t._loggingUrls=t._loggingUrls.concat(l,d)}},p=function(e){l._resolveAppResourcePathWithCallback(n[e],(function(t){c(t,!1,e)}))},l=this,u=0;u<n.length;u++)p(u);this._totalScriptsToBeLoaded=r.length,this._performanceHelper.mark("uniqueScriptLoadStart");var d=function(e){f._resolveAppResourcePathWithCallback(r[e],(function(t){c(t,!0,e)}))},f=this;for(u=0;u<r.length;u++)d(u);this._eventLogger.logEvent("_loadAppResources","Second set of files received")},e.prototype._startInitialResourcePreloadAndPrefetch=function(){var e=this,t=this._targetWindow.AppPrefetchResources;if(t){var r=0,n=[];t.forEach((function(t){"prefetch"!==t.rel?n.push(t):r<3?(n.push(t),r++):e._remainingAppPrefetchResourcesToLoad.push(t)})),this._loadAppLoadLinkResources(n)}},e.prototype._loadAppLoadLinkResources=function(e){for(var t=this,r=[],n=function(n){o._resolveAppResourcePathWithCallback(e[n],(function(o){!function(n,o){t._loggingUrls.push(n),r.push({url:n,category:o.isScript?"script":"style",mimeType:o.isScript?"text/javascript":"text/css",rel:o.rel}),e.length===r.length&&t._htmlHelper.addLoadLinkTags(r)}(o,e[n])}))},o=this,i=0;i<e.length;i++)n(i)},e.prototype._getPlatformSpecificStyleUrls=function(){var e=this;return(this._targetWindow.navigator.userAgent.indexOf("Windows")>-1?[]:this._nonWindowsSpecificStyles).map((function(t){return e._resolveSharedPath(t)}))},e.prototype._checkAndNotifyIfAppLoadFailed=function(){this._errors.length>0&&this._notifyAppFailedWithScriptErrors(JSON.stringify(this._errors))},e.prototype._notifyAppFailedWithScriptErrors=function(t){this._fallbackToStaticContentProxy||e.isIE()?this._notifyAppFailed("Error loading script",t):this._reloadWithStaticContent()},e.isIE=function(){return null!=navigator.userAgent.match("Trident")},e.prototype._onScriptError=function(e){this._errors.push(e),this._checkAndNotifyIfAppLoadFailed()},e.prototype._overrides=function(){this._config.overrideSVGUpdateFunction&&this._overrideSVGUpdateFunction(),this._overrideEnvironmentValueFunction()},e.prototype._overrideSVGUpdateFunction=function(){var e=this._targetWindow.Core.Knockout.BindingHandlers.InlineSVG.update,t=this._targetWindow;this._targetWindow.Core.Knockout.BindingHandlers.InlineSVG.update=function(r,n){var o=t.medialize.URI.domain;t.medialize.URI.prototype.domain=function(){return console.log("Override SVG function called"),t.document.domain};try{e(r,n)}finally{t.medialize.URI.prototype.domain=o}}},e.prototype._overrideEnvironmentValueFunction=function(){if(1===this._targetWindow.Core.Environment.compareVersionNumber("3.18045.0",this._targetWindow.Core.Environment.Version.VERSION_NUMBER)){var e=this._urlParameterDictionary.getParameter(o.paramsQueryKey);if(e){var t=new o.UrlParameterDictionary(e,"").dictionary;this._targetWindow.AppMagic.AuthoringTool.Runtime.setEnvironmentValue=function(e,r){t[e]=r},this._targetWindow.AppMagic.AuthoringTool.Runtime.getEnvironmentValue=function(e){return t[e]}}}},e.prototype._onResourceLoaded=function(){this._numberOfScriptsLoaded++,this._numberOfScriptsLoaded===this._totalScriptsToBeLoaded?(this._performanceHelper.mark("appMagicStart"),this._performanceHelper.measure("uniqueScriptLoadTime","uniqueScriptLoadStart","appMagicStart"),this._overrides(),this._onLoaderComplete()):this._checkAndNotifyIfAppLoadFailed()},e.prototype._getPerfDataString=function(){var e=this._loggingUrls.filter((function(e,t,r){return t===r.indexOf(e)}));return JSON.stringify(this._performanceHelper.getPerfData(e))},e.prototype._notifyAppIndexLoaded=function(){this._cordovaLoader.makeCordovaRequest((function(e){}),(function(e){}),"AppLifecycle","notifyAppIndexLoaded")},e.prototype._notifyAppFailed=function(e,t){this._reloadWithStaticContentProxyInProgress||(this._cordovaLoader.makeCordovaRequest((function(e){}),(function(e){}),"AppLifecycle","notifyAppFailed",[e,t,"",this._getPerfDataString()]),this._eventLogger.logEvent("_notifyAppFailed","GetAppDetails request failed"))},e.prototype._reloadWithStaticContent=function(){if(!this._reloadWithStaticContentProxyInProgress){this._reloadWithStaticContentProxyInProgress=!0;var e=this._targetWindow.location.hash.substring(1),t=JSON.parse(decodeURIComponent(e));t[o.fallbackStaticContentKey]="true";var r=encodeURIComponent(JSON.stringify(t));this._targetWindow.location.replace(this._targetWindow.location.href.replace(e,r)),this._targetWindow.location.reload()}},e.prototype._handleGlobalError=function(t){var r=t.error||{},n=r.message||t.message||"",o=r.stack;if("PCFNonImplementedError"!==r.name){var i=t.message.toLocaleLowerCase(),a=!this._isAppLoaded&&this._fallbackToStaticContentProxy;["script error","script error."].forEach((function(e){a=a&&i!==e}));var s=a?"PowerAppsClient.Error":e._className+".ScriptError";"undefined"!=typeof Core&&Core.Telemetry&&Core.Telemetry.Log&&(Core.Telemetry.Log.trackEvent(s,{operationName:"GlobalErrorHandler:UnhandledError",colno:t.colno,lineno:t.lineno,message:n,source:t.filename,stackTrace:o,didTriggerNotifyAppFailed:a}),Core.Telemetry.Log.flush()),a?(this._cordovaLoader.makeCordovaRequest((function(){}),(function(){}),"AppLifecycle","notifyAppFailed",["GlobalErrorHandler: "+n,o]),this._globalErrorHandler.dispose()):this._fallbackStaticContentProxy||this._reloadWithStaticContent()}},e.prototype._handleErrorInResolveAppAssetPath=function(t,r){this._eventLogger.logEvent("PowerAppsClient.Error",JSON.stringify({operationName:e._className+".resolveAppAssetPath",message:t,pathObjectType:r})),this._isAppLoaded||this._notifyAppFailed(e._className+".resolveAppAssetPath: "+t,"pathObjectType: "+r)},e.prototype._injectPrintCSS=function(){var e=this._targetWindow.document.createElement("STYLE");e.type="text/css",e.id="printedPublishedApp",e.media="print",this._targetWindow.document.head.appendChild(e),e.sheet.insertRule("@media print {\n                #publishedCanvas {\n                    transform: translate(-20%, -20%) scale(0.6)  !important;\n                }\n            }",0)},e._className="PublishedAppLoader",e}();t.PublishedAppLoader=s},nMzY:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCordovaChannel=void 0;var c=function(){function e(e){this._cordovaLoader=e}return e.prototype.initializeAsync=function(e,t){return a(this,void 0,void 0,(function(){var n=this;return s(this,(function(o){switch(o.label){case 0:return this._initializePromise=new Promise((function(e){n._initializePromiseResolve=e})),[4,Promise.resolve().then((function(){return i(r("5yX5"))}))];case 1:return o.sent(),this._cordovaLoader.load((function(){n._initializePromiseResolve&&(cordova.initCommunicationChannel(e,t),n._initializePromiseResolve())})),[4,this._initializePromise];case 2:return o.sent(),[2]}}))}))},e.prototype.sendMessage=function(e,t,r){return new Promise((function(n,o){cordova.exec((function(e){return n(e)}),(function(e){return o(e)}),e,t,r)}))},e.prototype.dispose=function(){throw new Error("Method not implemented.")},e}();t.DefaultCordovaChannel=c},p9nC:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.resolveAppResPath=function(e){return e},e.prototype.resolveHttpsPath=function(e){return e},e.prototype.resolveBlobPath=function(e){return e},e.prototype.resolveDataPath=function(e){return e},e.prototype.isSharedPath=function(e){return!1},e.prototype.resolveSharedPath=function(e){return e},e.prototype.resolveAppPath=function(e){return e},e.prototype.resolveProxyPath=function(e){return e},e.isPathToInitFile=function(e){return-1!==e.search(/js\/init(Screen_[0-9]+)?.js$/)},e.addStaticContentProxyPathIfNeeded=function(e,t,r,n){if(void 0===n&&(n=window.location.href),!t)return e;if(r&&n.indexOf("/preloadindex?preloadIndexPath=")>0){var o=e.split("/"),i=o[0]+"//"+o[2];return e=e.replace(i,r)}return t+encodeURIComponent(e)},e.prototype.resolveAppPathWithCallback=function(e,t){t(this.resolveAppPath(e))},e.prototype.setPackageDetails=function(e){throw new Error("Not implemented")},e.prototype.logPathNotResolved=function(e,t,r){var n={targetPath:e,pathResolver:t};r.logEvent("ResourcePathResolution",JSON.stringify(n))},e}();t.DefaultPathResolver=n},rerI:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=r("1lt1"),s=function(){function e(e){this._eventLogger=e,this._seqCount=0,this._perfMetrics={}}return e.prototype.startScenario=function(e,t,r){var n=this._seqCount.toString(),o=t.getTime();return this._perfMetrics[n]={scenarioName:e,startTimestamp:o},this._eventLogger.logEvent("LoaderPublishedAppMetadataParser."+e+".InProgress","startTime: "+o),this._seqCount++,n},e.prototype.endScenario=function(e,t){var r=this._perfMetrics[e];if(!r)return this._eventLogger.logEvent("LoaderPublishedAppMetadataParser.ScenarioNotExist","endScenario() should not be called as scenario "+e+" not exist"),-1;var n=this._processScenarioData(r,t);return this._eventLogger.logEvent("LoaderPublishedAppMetadataParser."+r.scenarioName+".Success",JSON.stringify(n)),delete this._perfMetrics[e],n.elapsedTime?n.elapsedTime:-1},e.prototype.failScenario=function(e,t){var r=this._perfMetrics[e];if(r){var n=this._processScenarioData(r,t);this._eventLogger.logEvent("LoaderPublishedAppMetadataParser."+r.scenarioName+".Failure",JSON.stringify(n)),delete this._perfMetrics[e]}else this._eventLogger.logEvent("LoaderPublishedAppMetadataParser.ScenarioNotExist","failScenario() should not be called as scenario "+e+" not exist")},e.prototype._processScenarioData=function(e,t){var r={},n=Date.now();return r.endTime=n,r.elapsedTime=n-e.startTimestamp,i(i({},r),{customScenarioData:t})},e.prototype.updateOpenAppData=function(e){},e.prototype.trackActivityEvent=function(e,t){var r=this._parseDataToStr(t);this._eventLogger.logEvent(e,r)},e.prototype.trackErrorEvent=function(e,t,r){var n=this._parseDataToStr(t);this._eventLogger.logEvent(e,n)},e.prototype.error=function(e,t){this._eventLogger.logEvent(e,t)},e.prototype._parseDataToStr=function(e){try{return"string"==typeof e?e:JSON.stringify(e)}catch(e){return e.message}},e}(),c=function(e){function t(t,r){var n=e.call(this,{indexHtmlDownloader:new a.PublishedAppMetadataDownloader((function(e,t){return n._sendHttpTextResponse(e,t)})),manifestJsonDownloader:new a.PublishedAppMetadataDownloader((function(e,t){return n._sendHttpJsonResponse(e,t)})),telemetryLogger:new s(t),appMetadataResponseProcessor:new a.AppMetadataResponseProcessor(r)},r)||this;return n}return o(t,e),t.prototype._sendHttpTextResponse=function(e,t){this._sendHttpResponseImpl(e,t,(function(e){return e}))},t.prototype._sendHttpJsonResponse=function(e,t){this._sendHttpResponseImpl(e,t,(function(e){try{return JSON.parse(e)}catch(e){throw e}}))},t.prototype._sendHttpResponseImpl=function(e,t,r){var n=new XMLHttpRequest;n.onload=function(){if(200===n.status)try{t.onSuccess(r(n.responseText))}catch(e){t.onFailure(new Error(e))}else t.onFailure(new Error(n.statusText))};var o=function(){t.onFailure(new Error("XMLHttpRequest Error: "+this.status+" - "+this.statusText))};n.onerror=o,n.ontimeout=o,n.onabort=o,n.open(e.method,e.url,!0),n.send()},t}(a.BasePublishedAppMetadataParser);t.LoaderPublishedAppMetadataParser=c},sHKn:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){if(this._canvasAppCordovaObj=e,!this._canvasAppCordovaObj)throw new Error("Please ensure the cordova instance for the canvasApp is defined")}return e.prototype.getCordovaObject=function(){return this._canvasAppCordovaObj},e.prototype.load=function(e){e()},e.prototype.makeCordovaRequest=function(e,t,r,n,o){this._canvasAppCordovaObj.exec(e,t,r,n,o)},e}();t.CanvasAppCordovaLoader=n},"tPh+":function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=r("e5/K"),c=r("fy70"),p=r("8UAK"),l=r("iFou"),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isStartCalled=!1,t}return o(t,e),t.prototype.start=function(e,t,r){void 0===r&&(r=!0),this.isBrowserSupportingServiceWorkers()?this._startAsync(e,t,r):t(c.ServiceWorkerManagerResult.NotSupported)},t.prototype._startAsync=function(e,t,r){return i(this,void 0,void 0,(function(){var n,o;return a(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),this._isStartCalled?(t(c.ServiceWorkerManagerResult.Ignore),[2]):(this._isStartCalled=!0,n=this._navigator.serviceWorker.controller,r||n?r?[3,2]:[4,this.unregisterServiceWorkersAsync(t)]:(t(c.ServiceWorkerManagerResult.DisabledAndNotRegistered),[2]));case 1:return i.sent(),[2];case 2:return this._serviceWorkerScriptUrl?this.isAppInfoValid(e)?((null==n?void 0:n.scriptURL)===this._serviceWorkerScriptUrl?this._sendAppInfoToServiceWorker(e,n,t):(this.registerServiceWorkerAsync(),t(c.ServiceWorkerManagerResult.Registering)),[3,4]):(t(c.ServiceWorkerManagerResult.Error,new Error("App info is invalid ("+JSON.stringify(e)+").")),[2]):(t(c.ServiceWorkerManagerResult.Error,new Error("Script URL is invalid ("+this._serviceWorkerScriptUrl+").")),[2]);case 3:return o=i.sent(),t(c.ServiceWorkerManagerResult.Error,o),[3,4];case 4:return[2]}}))}))},t.prototype.isAppInfoValid=function(e){return!!(null==e?void 0:e.appId)&&!!(null==e?void 0:e.appVersion)},t.prototype._sendAppInfoToServiceWorker=function(e,t,r){l.setSearchParameterWithoutRefresh(p.PublishedAppServiceWorkerConstants.clientIdSearchParamName,l.generate128BitUUID(),window),this._sendMessageToServiceWorker({command:p.PublishedAppServiceWorkerCommands.sendAppInfo,appInfo:e},t,r)},t}(s.ServiceWorkerManager);t.PublishedAppServiceWorkerManager=u},tVVD:function(e,t,r){"use strict";
/*!
* Copyright (C) Microsoft Corporation. All rights reserved.
*/Object.defineProperty(t,"__esModule",{value:!0}),t.PublishedAppServiceWorkerCommands={sendAppInfo:"sendAppInfo"}},twWZ:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
o(r("xxPY"),t)},uL4f:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
o(r("uwPH"),t),o(r("aQ8v"),t)},uguB:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPayloadValidateInterceptor=void 0;var n=r("F10/"),o=function(){function e(e){this._nextInterceptor=e}return e.prototype.process=function(e){var t=null;try{t=n.parseUnsafeCordovaParameters(e)}catch(e){}return this._nextInterceptor?this._nextInterceptor.process(t):t},e}();t.CordovaPayloadValidateInterceptor=o},uwPH:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */Object.defineProperty(t,"__esModule",{value:!0})},v2e7:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.loading=0]="loading",e[e.success=1]="success",e[e.error=2]="error"}(n=t.LoadedScriptTagStatus||(t.LoadedScriptTagStatus={}));var o=function(){function e(e){void 0===e&&(e=window),this._loadedStyleSheetLinkTags=[],this._loadedLoadLinkTags=[],this._loadedScriptTags={},this._targetDocument=e.document,this._targetWindow=e}return e.prototype.addStyleSheetLinkTags=function(e){for(var t=this._targetDocument.createDocumentFragment(),r=0;r<e.length;r++)this.addStyleSheetLinkTag(e[r],t);this._targetDocument.head.appendChild(t)},e.prototype.addStyleSheetLinkTag=function(e,t){if(-1===this._loadedStyleSheetLinkTags.indexOf(e)){var r=this._targetDocument.createElement("LINK");r.type="text/css",r.href=e,r.rel="stylesheet",t?t.appendChild(r):this._targetDocument.head.appendChild(r),this._loadedStyleSheetLinkTags.push(e)}},e.prototype.addLoadLinkTags=function(e){for(var t=this._targetDocument.createDocumentFragment(),r=0;r<e.length;r++)this.addLoadLinkTag(e[r],t);this._targetDocument.head.appendChild(t)},e.prototype.addLoadLinkTag=function(e,t){if(-1===this._loadedLoadLinkTags.indexOf(e.url)){if("script"===e.category){if(this._loadedScriptTags[e.url])return}else if(-1!==this._loadedStyleSheetLinkTags.indexOf(e.url))return;var r=this._targetDocument.createElement("SCRIPT");r.setAttribute("crossorigin","anonymous"),r.type=e.mimeType,r.src=e.url;var n=this._targetDocument.createElement("LINK");n.rel=e.rel?e.rel:"prefetch",n.href=e.url,n.type=e.mimeType,n.setAttribute("as",e.category),n.setAttribute("crossorigin","anonymous"),t?t.appendChild(n):this._targetDocument.head.appendChild(n),this._loadedLoadLinkTags.push(e.url)}},e.prototype.addScriptTags=function(e,t,r){for(var n=this._targetDocument.createDocumentFragment(),o=0;o<e.length;o++)this.addScriptTag(e[o],t,r,n);this._targetDocument.head.appendChild(n)},e.prototype.addScriptTag=function(e,t,r,o){var i=this,a=this._loadedScriptTags[e];if(a)a.status===n.loading?(t&&a.successCallbacks.push(t),r&&a.errorCallbacks.push(r)):a.status===n.error?r&&r(e):t&&t();else{var s=this._targetDocument.createElement("LINK");s.rel="preload",s.href=e,s.setAttribute("as","script"),s.setAttribute("crossorigin","anonymous"),o&&o.appendChild(s);var c=this._targetDocument.createElement("SCRIPT");c.setAttribute("crossorigin","anonymous"),c.type="text/javascript",c.async=!1;var p={status:n.loading,errorCallbacks:[],successCallbacks:[]};t&&p.successCallbacks.push(t),r&&p.errorCallbacks.push(r),this._loadedScriptTags[e]=p,c.addEventListener("error",(function(t){var r=i._loadedScriptTags[e];r.status=n.error;for(var o=0;o<r.errorCallbacks.length;o++)r.errorCallbacks[o](t.srcElement.src)})),c.addEventListener("load",(function(t){var r=i._loadedScriptTags[e];r.status=n.success;for(var o=0;o<r.successCallbacks.length;o++)r.successCallbacks[o](t)})),o?o.appendChild(c):this._targetDocument.head.appendChild(c),c.src=e}},e.prototype.addHeaderScripts=function(e){var t=this;e.forEach((function(e){t.addHeaderScript(e)}))},e.prototype.addHeaderScript=function(e){this._targetDocument.head.insertAdjacentHTML("beforeend",e)},e.prototype.postMessageToParent=function(e){this._targetWindow.parent.postMessage(e,this._targetDocument.referrer)},e.prototype.addEventListener=function(e,t,r){this._targetDocument.addEventListener(e,t,r)},e.prototype.runAndRemoveScript=function(e,t){var r=document.createElement("script");r.textContent=e,this._targetDocument.body.appendChild(r),t&&r.addEventListener("error",(function(e){t(e)})),this._targetDocument.body.removeChild(r)},e.prototype.updateHash=function(e){this._targetWindow.location.href.indexOf("about:blank")>-1?this._targetWindow.location.hash=e:this._targetWindow.location.replace("#"+e)},e}();t.HtmlHelper=o},v8SN:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */
o(r("Dwgu"),t),o(r("uguB"),t),o(r("QIic"),t)},wIJ5:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0}),t.loaderKey="loader",t.antiCSRFTokenKey="antiCSRFToken",t.cdnUrlKey="cdnUrl",t.paramsQueryKey="paramsQuery",t.iframeModeKey="iframeMode",t.staticContentProxyKey="staticContentProxy",t.fallbackStaticContentKey="fallbackStaticContent",t.staticContentUrlKey="staticContentUrl",t.serviceWorkerUrlKey="serviceWorkerUrl",t.featureGatesKey="featureGates";var n=function(){function e(e,t){this._dictionary={},this._dictionary=this.parseQueryParameter(e);var r=decodeURIComponent(t);if(null!==r&&""!==r){var n=JSON.parse(r);for(var o in n)this._dictionary[o]=n[o]}}return e.prototype.parseQueryParameter=function(e){var t={};if(!e)return t;for(var r=e.split("&"),n=0;n<r.length;n++){var o=r[n].split("=");2===o.length&&(t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]))}return t},e.prototype.getParameter=function(e){return this._dictionary[e]},Object.defineProperty(e.prototype,"dictionary",{get:function(){return this._dictionary},enumerable:!0,configurable:!0}),e}();t.UrlParameterDictionary=n},xjCR:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getSingleton=t.register=void 0;var o={};t.register=function(e,t){o[e]=t},t.getSingleton=function(e){var t=o[e];if(!t)throw new Error("Please make sure register this singleton first before accessing it");return t},t.dispose=function(){var e,t;try{for(var r=n(Object.getOwnPropertyNames(o)),i=r.next();!i.done;i=r.next()){var a=i.value;delete o[a]}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}},xxPY:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r("FNbs"),t),o(r("P6Pi"),t),o(r("OnJ6"),t),o(r("4B+e"),t)},yaqW:function(e,t,r){"use strict";
//!
//! Copyright (C) Microsoft Corporation.  All rights reserved.
//!
Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._getCordovaLoader=e}return e.prototype.logEvent=function(t,r){var n,o={operationName:e._operationName+"."+t,message:r};"undefined"!=typeof Core&&(null===(n=Core.Telemetry)||void 0===n?void 0:n.Log)?Core.Telemetry.Log.trackEvent(e._eventName,o):this._logWithCordova(o)},e.prototype.logError=function(t,r){var n,o=e._operationName+"."+t;if("undefined"!=typeof Core&&(null===(n=Core.Telemetry)||void 0===n?void 0:n.Log)){var i={operationName:o,error:r};Core.Telemetry.Log.trackErrorEvent(e._eventName,i)}else{i={operationName:o,error:JSON.stringify(r,Object.getOwnPropertyNames(r))};this._logWithCordova(i)}},e.prototype._logWithCordova=function(t){var r,n=this;this._cordovaLoader||(this._cordovaLoader=this._getCordovaLoader()),null===(r=this._cordovaLoader)||void 0===r||r.load((function(){n._cordovaLoader.makeCordovaRequest((function(){}),(function(){}),e._serviceName,"trackEvent",[e._eventName,t])}))},e.stringify=function(e){try{return JSON.stringify(e)}catch(e){return}},e._operationName="PowerAppsClient",e._eventName="PowerAppsClient.WebPlayer.Load",e._serviceName="PublishedAppTelemetry",e}();t.EventLogger=n},ynQx:function(e,t,r){"use strict";
/*!
 * Copyright (C) Microsoft Corporation. All rights reserved.
 */var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultAppHostClientError=void 0;var i=function(e){function t(t,r){var n=e.call(this,t.localizedMessage)||this;return n.errorInfo=t,n.canvasAppInfo=r,n}return o(t,e),t}(Error);t.DefaultAppHostClientError=i}}]),window.bundleExecutionMarkers["scripts/es5/19.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();