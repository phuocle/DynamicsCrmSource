(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/es5/sidepanel.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[103],{aHX0:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i,a=n("CGM5"),o=n("HMYz"),s=n("iDZS"),r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n._iframeElement=null,n._origin=null,n._onLoad=n._onLoad.bind(n),n._origin=n._normalizeUrl(t.src),n}return r(t,e),t.prototype._normalizeUrl=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad(),this.props.onReadyStateComplete&&this.props.onReadyStateComplete()},t.prototype.getElementName=function(){return"iframe"},t.prototype.getElementProps=function(){var e={src:this.props.src,title:this.props.title,onLoad:this._onLoad};return this.props.security&&(e.security=this.props.security,e.sandbox=""),this.props.scrolling&&(e.scrolling=this.props.scrolling),this.props.allow&&(e.allow=this.props.allow),this.props.name&&(e.name=this.props.name),e.ref=this._registerIframeElement.bind(this),e},t.prototype.componentWillReceiveProps=function(){this._resetEventHandlers()},t.prototype._resetEventHandlers=function(){window.removeEventListener("message",this._receiveMessageHandler,!1),this._receiveMessageHandler=null,this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(void 0)},t.prototype._registerIframeElement=function(e){this._iframeElement=e,this._iframeElement?(this._receiveMessageHandler=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessageHandler,!1),this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(this._sendMessage.bind(this))):this._resetEventHandlers()},t.prototype.componentWillUnmount=function(){this._resetEventHandlers()},t.prototype._receiveMessage=function(e){this._iframeElement&&e.source===this._iframeElement.contentWindow&&this._normalizeUrl(e.origin)===this._origin&&this.props.onMessage&&this.props.onMessage(e)},t.prototype._sendMessage=function(e){this._iframeElement&&this._iframeElement.contentWindow.postMessage(e,this._origin)},t.displayName="IFrame",t}(a.a),d=o.connect(s.a)(l)},oqzX:function(e,t,n){"use strict";n.r(t),n.d(t,"XrmAppPanel",(function(){return S})),n.d(t,"SidePanel",(function(){return me})),n.d(t,"loadSidePanelWithPageInput",(function(){return _e})),n.d(t,"loadSidePanelWithUrl",(function(){return Ie})),n.d(t,"setPanelOptions",(function(){return P})),n.d(t,"getPanelWidth",(function(){return b}));var i=n("+Z9T"),a=n("jBV3"),o=n("C2aM"),s=n("PAQF"),r=n("6JRL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e){switch(e){case 1:case 2:return}throw Object(r.d)("Invalid panel position",2415919121,[{name:"position",value:e}])}function d(e){switch(e){case 0:case 1:case 2:return}throw Object(r.d)("Invalid panel state",2415919121,[{name:"state",value:e}])}function p(e){if(!e)throw Object(r.d)("Invalid width",2415919121,[{name:"width",value:e}]);if(!/^\d+(\.\d+)?(px|%)?$/.test(e))throw Object(r.d)("Invalid width",2415919121,[{name:"width",value:e}])}function c(e){return 2===e?s.o:s.m}function u(e){return 1===e?s.l:void 0}var h=0;function g(){return"sidePanel-"+h++}function f(e,t,n){var i=Object(o.c)(e,t);if(i&&(i.type===a.b.IFrame||!n))throw Object(r.d)("Cannot create SidePanel. Only 1 sidepanel in each position",2415919107)}function P(e,t){return{type:s.f,sync:!0,execute:function(n,i){var a,c=n.dispatch,u=(0,n.getState)(),h=Object(o.d)(u,e);t.sidePanelPosition&&(null===(a=h.option)||void 0===a?void 0:a.sidePanelPosition)!==t.sidePanelPosition&&function(e,t,n){var i=Object(o.c)(e,n);if(i&&i.sidePanelId!==t)throw Object(r.d)("Cannot update SidePanel position. Only 1 sidepanel in each position",2415919107)}(u,h.sidePanelId,t.sidePanelPosition),t.sidePanelState&&d(t.sidePanelState),t.sidePanelPosition&&l(t.sidePanelPosition),t.sidePanelWidth&&p(t.sidePanelWidth);try{t.sidePanelWidth&&localStorage.setItem(s.q,t.sidePanelWidth+"px"),t.sidePanelState&&localStorage.setItem(s.n,t.sidePanelState.toString())}catch(e){}c(function(e,t){return{type:s.g,payload:{sidePanelId:e,option:t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t))}}}function b(e,t){var n=Object(o.d)(e,t);if(2===n.option.sidePanelState)return 0;if(0===n.option.sidePanelState)return c(n.option.sidePanelPosition);var i=n.option.sidePanelWidth,a=u(n.option.sidePanelState);if(i){var s=function(e){var t;if(!(e.indexOf("%")>-1))return parseInt(e,10);var n=document.getElementById("mainContent"),i=n?n.offsetWidth:0;t=+e.substring(0,e.indexOf("%"))/100*i;return t}(i.toLowerCase());return s>a?s:a}return a}var m=n("TMat"),v=n("Hp3w"),_=n("lU69"),y=n("7ipg"),S=function(){function e(e,t,n){var a="ClientApi.XrmAppPanel.constructor";Object(i.g)(e,a,"store"),Object(i.g)(t,a,"context"),Object(i.g)(n,a,"sidePanelId"),Object(o.d)(e.getState(),n),this._store=e,this._applicationContext=t,this._sidePanelId=n,this._clientApiExecutor=new y.b(e,"ClientApi.XrmAppPanel."),this._onChannelMessageRecieved=this._onChannelMessageRecieved.bind(this),this._subscriberChannel=this._applicationContext.ChannelManager.createChannel(Object(_.a)(),this._onChannelMessageRecieved),this._subscriberChannel.subscribeTo(n)}return Object.defineProperty(e.prototype,"position",{get:function(){var e=this;return this._clientApiExecutor.execute("position_get",(function(){return Object(o.d)(e._store.getState(),e._sidePanelId).option.sidePanelPosition}))},set:function(e){var t=this;this._clientApiExecutor.execute("position_set",(function(){t._store.dispatch(P(t._sidePanelId,{sidePanelPosition:e}))}),[{name:"panelPosition",value:e,isRequired:!0}])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){var e=this;return this._clientApiExecutor.execute("state_get",(function(){return Object(o.d)(e._store.getState(),e._sidePanelId).option.sidePanelState}))},set:function(e){var t=this;this._clientApiExecutor.execute("state_set",(function(){t._store.dispatch(P(t._sidePanelId,{sidePanelState:e}))}),[{name:"panelState",value:e,isRequired:!0}])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){var e=this;return this._clientApiExecutor.execute("title_get",(function(){return Object(o.d)(e._store.getState(),e._sidePanelId).option.sidePanelTitle||""}))},set:function(e){var t=this;this._clientApiExecutor.execute("title_set",(function(){t._store.dispatch(P(t._sidePanelId,{sidePanelTitle:e}))}),[{name:"panelTitle",value:e,isRequired:!0}])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){var e=this;return this._clientApiExecutor.execute("url_get",(function(){var t=Object(o.d)(e._store.getState(),e._sidePanelId);return t.type===a.b.IFrame?t.sidePanelURL:""}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){var e=this;return this._clientApiExecutor.execute("width_get",(function(){return b(e._store.getState(),e._sidePanelId)}))},set:function(e){var t=this;this._clientApiExecutor.execute("width_set",(function(){t._store.dispatch(P(t._sidePanelId,{sidePanelWidth:e.toString()+"px"}))}),[{name:"panelWidth",value:e,isRequired:!0}])},enumerable:!1,configurable:!0}),e.prototype._onChannelMessageRecieved=function(e,t){if(this._sidePanelId===t)switch(e.type){case m.a.PostMessage:var n={message:e.data.data,origin:e.data.origin};this._store.dispatch(Object(v.k)(this._sidePanelId,this,n));break;case m.a.SizeChange:this._store.dispatch(Object(v.l)(this._sidePanelId,this));break;case m.a.StateChange:this._store.dispatch(Object(v.m)(this._sidePanelId,this))}},e.prototype.postMessage=function(e){var t=this;this._clientApiExecutor.execute("postMessage",(function(){t._applicationContext.ChannelManager.sendMessage(t._subscriberChannel,t._sidePanelId,e)}),[{name:"message",value:e,isRequired:!0}])},e.prototype.addOnMessageReceived=function(e){var t=this;this._clientApiExecutor.execute("addOnMessageReceived",(function(){t._store.dispatch(Object(v.c)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnMessageReceived=function(e){var t=this;this._clientApiExecutor.execute("removeOnMessageReceived",(function(){t._store.dispatch(Object(v.h)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.addOnSizeChange=function(e){var t=this;this._clientApiExecutor.execute("addOnSizeChange",(function(){t._store.dispatch(Object(v.d)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnSizeChange=function(e){var t=this;this._clientApiExecutor.execute("removeOnSizeChange",(function(){t._store.dispatch(Object(v.i)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.addOnStateChange=function(e){var t=this;this._clientApiExecutor.execute("addOnStateChange",(function(){t._store.dispatch(Object(v.e)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e.prototype.removeOnStateChange=function(e){var t=this;this._clientApiExecutor.execute("removeOnStateChange",(function(){t._store.dispatch(Object(v.j)(t._sidePanelId,e))}),[{name:"handler",value:e,isRequired:!0}])},e}(),C=n("c/eZ"),x=n("nuS9"),I=n("YWpA"),O=n("4E+q");var w,M,E,j,L,T,R,k=n("B73A"),B=n("akzq"),D=n("9rQ4"),H=n("0OS1"),W=null;function z(e,t,n,i,a,o,r,l,d,p){if(null!==W&&w!==n&&M!==i&&E!==e&&j!==a&&L!==o&&T!==r)return W;w=n,M=i,E=e,j=a,L=o,T=r,R=l;var h=function(){var e;e=0===M?c(w)+"px":T||s.p;return e}(),g=u(M);W={panel:A(h,g,d,p),topSession:{display:"flex",flexShrink:0,height:H.a.sizes.Measures.Measure300,width:L?h:"100%",minWidth:g,borderBottom:"1px solid rgb(216, 216, 216)",background:"#EFEFEF"},bottomSession:{height:"100%",display:"flex",flexDirection:"column",width:L?h:"100%",minWidth:g,background:"#ffffff"},sideTitle:{width:s.o,height:"100%",cursor:"pointer",":hover":{background:"#d8d8d8"}},titleTextStyle:{width:"100%",paddingLeft:14,lineHeight:H.a.sizes.Measures.Measure300,overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block",fontSize:16},buttonStyle:{height:H.a.sizes.Measures.Measure300,width:s.o,background:"transparent",color:"inherit",border:"none",lineHeight:H.a.sizes.Measures.Measure300,cursor:"pointer",":hover":{background:"#d8d8d8"}}};var f="solid 1px #D8D8D8";return 0===i&&(1===n?(Object.assign(W.panel,{borderLeft:p?f:0,borderRight:p?f:0,borderTop:p?f:0,"border-top-left-radius":"5px","border-top-right-radius":"5px","box-shadow":"rgb(102, 102, 102, 0.2) 0 -4px 8px",overflow:"hidden"}),Object.assign(W.bottomSession,{borderLeft:f,borderRight:f})):W.panel.borderLeft=p?f:0),W}function A(e,t,n,i){var a,o,r="",l="",d="solid 1px #D8D8D8";return 1===M&&(2===w?E?l=d:r=d:E?r=d:l=d),o=2===M?{display:"none"}:{width:e,minWidth:t,maxWidth:"100%",height:"100%",order:R,borderLeft:r,borderRight:l,boxSizing:"content-box",display:"flex",flexDirection:"column",borderTop:i&&d},0===M&&1===w&&Object.assign(o,((a={position:"absolute",height:j?43:88,bottom:0})[E?"right":"left"]=7+n*(s.m+7),a)),L&&1===M&&Object.assign(o,{position:"absolute",width:"100%",top:0,bottom:0,left:0,right:0,alignItems:1===w?"flex-start":"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"}),o}var F=n("Wi7Z"),U=n("kyRo"),q=n("evW+"),J=n("XIN1"),N=n("Wg6j"),X=n("H/hG"),Z=n("znb3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Y(e){var t="",n=1===e.position,i=0===e.sidePanelState;return t=n?i?"ChromeMaximize":"ChromeMinimize":i?e.isRTL?"RightChevron":"LeftChevron":e.isRTL?"LeftChevron":"RightChevron",x.createElement(q.a,{key:"sidePanelExpandedCollapseButton",accessibilityExpanded:!i,accessibilityLabel:e.expandCollapseButtonLabel,title:e.expandCollapseButtonLabel,style:e.style,onClick:e.onClick,testhooks:{id:"expand-collapse-button-sidepanel"}},x.createElement(J.b,{type:Object(N.q)(t),style:{width:"100%"}}))}function K(e){return x.createElement(q.a,{key:"sidePanelCloseButton",accessibilityLabel:e.closeButtonLabel,title:e.closeButtonLabel,style:e.style,onClick:e.onClick,testhooks:{id:"expand-collapse-button-sidepanel"}},x.createElement(J.b,{type:Z.a.Close,style:{width:"100%"}}))}function V(e){var t=Object(C.__assign)(Object(C.__assign)({},e.style),e.defaultCollapsedBehavior?{height:"100%",borderBottom:""}:{height:"3rmb",borderBottom:"1px solid transparent"});return x.createElement(I.a,{style:t,onClick:e.onClick,key:"sidePanelRightCollapse"},x.createElement(Y,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.state,isRTL:e.isRTL,style:e.buttonStyle,position:e.position}),e.defaultCollapsedBehavior&&x.createElement(I.a,{key:"sidePanelTitle",style:{width:300,margin:5,top:44,"transform-origin":"left top",transform:e.isRTL?"translateX(275px) translateY(300px) rotate(-90deg)":"translatex(27px) rotate(90deg)","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap",position:"absolute",display:"block"}},e.sidePanelTitle))}function G(e){if(e.canBeCollapsed&&!e.canBeClosed){var t=Object(C.__assign)(Object(C.__assign)({},e.topSessionStyle),{cursor:"pointer",":hover":{background:"#d8d8d8"}});return x.createElement(I.a,{style:t,key:"sidePanelHeader",onClick:e.onTogglePanelHandler},x.createElement(X.a,{style:e.titleTextStyle},e.sidePanelTitle),x.createElement(Y,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.panelState,isRTL:e.isRTL,style:e.buttonStyle,position:e.panelPosition}))}return x.createElement(I.a,{style:e.topSessionStyle,key:"sidePanelHeader"},x.createElement(X.a,{style:e.titleTextStyle},e.sidePanelTitle),e.canBeClosed&&x.createElement(K,{closeButtonLabel:e.closeButtonLabel,style:e.buttonStyle,position:e.panelPosition,onClick:e.onClosePanelHandler}),e.canBeCollapsed&&x.createElement(Y,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.panelState,isRTL:e.isRTL,style:e.buttonStyle,onClick:e.onTogglePanelHandler,position:e.panelPosition}))}var Q=n("KzL8"),$=n("OdhZ"),ee=n("RYq1");function te(e){return{type:s.b,payload:{sidePanelId:e}}}var ne=n("7EJx"),ie=n("AUYt"),ae=n("e9UD"),oe=n("+8KT"),se=n("wV3W"),re=n("yZTI"),le=function(e){function t(t,n){var i=e.call(this,t)||this;return i.state={errorPopupData:null},i}return Object(C.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;if(e.error!==this.props.error){var n=this.context.EventManager.getActivityId(),i=this.context.EventManager.getCurrentSessionId();this.props.error&&this.props.getErrorPopupData(this.props.error,n,i).then((function(e){t.setState({errorPopupData:e})}))}},t.prototype.render=function(){if(this.state.errorPopupData)return x.createElement(ie.a,{errorPopupDescriptor:this.state.errorPopupData.errorPopupDescriptor,theme:this.props.theme,isViewportSmall:!0,okButtonLabel:this.state.errorPopupData.okButtonLabel,onOkHandler:function(){}});var e=this.props.pageId?this.props.router.getPage(this.props.pageId):null;return e?x.createElement(e,{key:this.props.pageId,id:this.props.pageId}):x.createElement(ae.a,{key:"progressIndicator",id:"boot-loading-indicator",progressType:"ring",displayDelay:1e3,active:!0,style:{display:"flex"}})},t}(x.Component);le.getDerivedStateFromProps=function(e){return e.error?null:{errorPopupData:null}},le.contextType=U.a;var de=Object(O.a)((function(e,t){return{error:Object(re.i)(e,t.browsingContextId),pageId:Object(Q.a)(e,t.browsingContextId).pageId,theme:Object(se.a)(e)}}),(function(e){return{getErrorPopupData:function(t,n,i){return e({type:"GET_ERROR_POPUP_DATA",execute:function(a){var o=a.getState;return Object(oe.a)(t,e,o,{activityId:n,sessionId:i})}})}}}))(le),pe=n("aHX0"),ce={width:"100%",height:"100%",display:"block"};function ue(e){return x.createElement(pe.a,{id:e.iframeContainerId,key:e.iframeContainerId,title:e.iframeContainerId,style:ce,src:e.sidePanelUrl,onMessage:e.onIframeMessage,registerSendMessageHandler:e.registerIframeSendMessageHandler,allow:"microphone; camera; geolocation"})}var he=n("VnpK"),ge=n("sOTk"),fe=n("MWeR"),Pe={height:"100%",flex:"1"},be=function(e){function t(t,n){var i=e.call(this,t)||this;return i._communicationChannel=null,i._shortcutHandler=function(e){var t=document.querySelector('[data-id="'+s.i+'"]');t&&t.focus()},i._onTogglePanelHandler=i._onTogglePanelHandler.bind(i),i._registerIframeSendMessageHandler=i._registerIframeSendMessageHandler.bind(i),i._onChannelMessageRecieved=i._onChannelMessageRecieved.bind(i),i._onIframeMessage=i._onIframeMessage.bind(i),i._onFlyoutBackgroudClick=i._onFlyoutBackgroudClick.bind(i),i._windowResized=i._windowResized.bind(i),i._domId=s.i+"_"+i.props.sidePanelId,i._communicationChannel=n.ChannelManager.getChannel(t.sidePanelId),i._communicationChannel.setOnMesseageReceivedHandler(i._onChannelMessageRecieved),i}return Object(C.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.setSidePanelLoadStateComplete(this.props.sidePanelId),this._sendMessage(m.a.LoadCompleted,null),window.addEventListener("resize",this._windowResized)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._windowResized),this._sendIframeMessageHandler=null},t.prototype.componentDidUpdate=function(e){e.panelData.option.sidePanelState!==this.props.panelData.option.sidePanelState&&this._sendMessage(m.a.StateChange,null),e.panelData.option.sidePanelWidth!==this.props.panelData.option.sidePanelWidth&&this._sendMessage(m.a.SizeChange,null)},t.prototype.render=function(){var e=this;if(!this.props.panelData||void 0===this.props.panelData.sidePanelLoadState||this.props.panelData.sidePanelLoadState===a.a.NotStarted)return null;var t=this.props.panelData.option,n=0===t.sidePanelState,i=1===t.sidePanelState,o=1===t.sidePanelPosition;n&&t.sidePanelDefaultCollapsedBehavior?Object.assign(Pe,{visibility:"hidden",height:0}):Object.assign(Pe,{visibility:"visible",height:"100%"});var s=!!t.canBeCollapsed,r=!!t.canBeClosed,l=!!t.showTitle,d=Object(he.n)(),p=z(this.props.isRTL,0,t.sidePanelPosition,t.sidePanelState,t.sidePanelDefaultCollapsedBehavior,this.props.forcedFlyout,t.sidePanelWidth,this.props.flexOrder,this.props.leftCollapsedOrder,d),c=n?this.props.sidePanelExpandButtonLabel:this.props.sidePanelCollapseButtonLabel,u=String.format(this.props.isRTL?"{1} {0}":"{0} {1}",c,this.props.title||this.props.sidePanelLabel),h=String.format(this.props.isRTL?"{1} {0}":"{0} {1}",this.props.closeButtonLabel,this.props.title||this.props.sidePanelLabel),g=l&&i||l&&o&&n,f=l&&n&&!o;return x.createElement(I.a,{tabIndex:-1,key:this._domId,id:this._domId,testhooks:{id:this._domId},accessibilityLabel:this.props.sidePanelLabel,style:p.panel,role:F.r,onClick:this._onFlyoutBackgroudClick},x.createElement(B.a,{key:"sidePanelAccessibility",keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),g&&x.createElement(G,{key:"SidePanelHorizontalPanelTitle",titleTextStyle:p.titleTextStyle,buttonStyle:p.buttonStyle,topSessionStyle:p.topSession,isRTL:this.props.isRTL,panelPosition:t.sidePanelPosition,panelState:t.sidePanelState,canBeClosed:r,canBeCollapsed:s,sidePanelTitle:this.props.title,closeButtonLabel:h,expandCollapseButtonLabel:u,onTogglePanelHandler:this._onTogglePanelHandler,onClosePanelHandler:function(){return e.props.closePanel(e.props.sidePanelId)}}),x.createElement(I.a,{style:p.bottomSession,key:"sidePanelBody"},f&&x.createElement(V,{sidePanelTitle:this.props.title,isRTL:this.props.isRTL,style:p.sideTitle,buttonStyle:p.buttonStyle,position:t.sidePanelPosition,state:t.sidePanelState,expandCollapseButtonLabel:u,onClick:this._onTogglePanelHandler,defaultCollapsedBehavior:t.sidePanelDefaultCollapsedBehavior}),x.createElement(I.a,{style:Pe,key:"sidePanelContent"},this.props.panelData.type===a.b.Page&&x.createElement(de,{router:this.props.router,browsingContextId:this.props.panelData.browsingContextId}),this.props.panelData.type===a.b.IFrame&&x.createElement(ue,{sidePanelId:this.props.sidePanelId,sidePanelUrl:this.props.panelData.sidePanelURL,legacyPanel:this.props.panelData.legacyPanel,iframeContainerId:this.props.panelData.legacyPanel?"SidePanelIFrame":"IFrame-"+this.props.sidePanelId,onIframeMessage:this._onIframeMessage,registerIframeSendMessageHandler:this._registerIframeSendMessageHandler}))))},t.prototype._onFlyoutBackgroudClick=function(e){this.props.forcedFlyout&&1===this.props.panelData.option.sidePanelState&&e.target.id===this._domId&&this._onTogglePanelHandler()},t.prototype._onTogglePanelHandler=function(){1===this.props.panelData.option.sidePanelState?this.props.setPanelState(this.props.sidePanelId,0):this.props.setPanelState(this.props.sidePanelId,1)},t.prototype._registerIframeSendMessageHandler=function(e){this._sendIframeMessageHandler=e},t.prototype._onIframeMessage=function(e){var t={data:e.data,origin:e.origin};this._sendMessage(m.a.PostMessage,t)},t.prototype._windowResized=function(){this._sendMessage(m.a.SizeChange,null)},t.prototype._onChannelMessageRecieved=function(e,t){if(!this._sendIframeMessageHandler)throw new Error("Send Message Handler was null");this._sendIframeMessageHandler(e)},t.prototype._sendMessage=function(e,t){var n={type:e,data:t,senderId:this.props.sidePanelId};this._communicationChannel.sendToSubscribers(n)},t.prototype._createKeyboardShortcuts=function(){var e=this._shortcutHandler.bind(this),t=[],n=new k.a([D.a.Ctrl,D.a.Shift,D.a.Period],e,!0,"Side Panel","Set focus on side panel");return t.push(n),t},t}(x.Component);be.contextType=U.a;var me=Object(O.a)((function(e,t){var n,i=Object(o.d)(e,t.sidePanelId),s=null===(n=i.option)||void 0===n?void 0:n.sidePanelTitle;if(!s&&i.type===a.b.Page){var r=Object(Q.a)(e,i.browsingContextId);s=Object(fe.c)(Object(ge.j)(e,r.pageId))}return{title:s,panelData:i,isRTL:Object(ne.g)(e)}}),(function(e){return{setSidePanelLoadStateComplete:function(t){return e(function(e){var t={sidePanelId:e};return{type:s.e,payload:t}}(t))},closePanel:function(t){return e(function(e){return{type:s.a,execute:function(t,n){var i=t.dispatch,s=t.getState,r=Object(o.d)(s(),e);if(r.type===a.b.Page){var l=Object(Q.a)(s(),r.browsingContextId);return i(Object(ee.e)(l.pageId,"close sidepanel",!1)).then((function(){var t=n.ChannelManager.getChannel(e);return n.ChannelManager.destroyChannel(t),i(Object($.a)(r.browsingContextId)),i(te(e)),!0}))}return i(te(e)),Promise.resolve(!0)}}}(t))},setPanelState:function(t,n){return e(P(t,{sidePanelState:n}))}}}))(be),ve=n("Z1aD");function _e(e,t,n,i,r,l,d,p,c,u,h,b){void 0===p&&(p=!0),void 0===c&&(c=!1),void 0===u&&(u=!0),void 0===h&&(h=!1),void 0===b&&(b=!0);var m=[];return{type:s.c,execute:function(v,_){var y=v.dispatch,S=v.getState;f(S(),Ce(r),p),m.push({name:"inputPayload",value:JSON.stringify({pageType:e,pageInput:t,panelPosition:r,initialWidth:i,panelState:l,sidePanelDefaultCollapsedBehavior:d,replaceIfExisted:p,canBeClosed:c,canBeCollapsed:u,isTitleStatic:h,showTitle:b})}),null==d&&(d=!0);var x,I={sidePanelTitle:n||"",sidePanelDefaultCollapsedBehavior:d,sidePanelState:Se(l),sidePanelWidth:ye(i),sidePanelPosition:Ce(r),canBeClosed:c,canBeCollapsed:u,isTitleStatic:h,showTitle:b},O="",w="",M=p?Object(o.a)(S(),I.sidePanelPosition):null;if(M)y(P(O=w=M.sidePanelId,I));else{O=w=g(),y(Object($.b)(w,!1)),M={sidePanelId:O,type:a.b.Page,browsingContextId:w,option:I},_.ChannelManager.createChannel(O,null),y((x=M,{type:s.d,payload:x}));var E=Object(C.__rest)(I,["sidePanelTitle"]),j=Object(C.__assign)(Object(C.__assign)({},M),{option:E});m.push({name:"payload",value:JSON.stringify(j)})}return y(Object(ve.a)(e,t,void 0,{targetBrowsingContext:w})).then((function(){return M}))},getFailureParameters:function(e,t,n,i){return m},getSuccessParameters:function(e,t,n){return m}}}function ye(e){return null!=e&&p(e.toString()),null!=e?e.toString()+"px":s.p}function Se(e){return null!=e&&d(e),null==e&&(e=1),e}function Ce(e){return null!=e&&l(e),null==e&&(e=2),e}var xe=n("JYPj");function Ie(e,t,n,i,o,r,l,d,p,c,u){void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=!0),void 0===c&&(c=!1),void 0===u&&(u=!0);var h=[];return{type:s.c,execute:function(P,b){var v=P.dispatch;f((0,P.getState)(),Me(i),!1);var y=g();h.push({name:"inputPayload",value:JSON.stringify({url:Object(xe.a)(e),sidePanelId:y,panelPosition:i,initialWidth:n,panelState:o,sidePanelDefaultCollapsedBehavior:r})}),null==r&&(r=!0);var S={sidePanelId:y,sidePanelURL:e,type:a.b.IFrame,option:{sidePanelTitle:t,sidePanelDefaultCollapsedBehavior:r,sidePanelState:we(o),sidePanelWidth:Oe(n),sidePanelPosition:Me(i),canBeClosed:d,canBeCollapsed:p,isTitleStatic:c,showTitle:u},legacyPanel:l};b.ChannelManager.createChannel(y,null),v(function(e){return{type:s.d,payload:e}}
/**
 * Public interface of the MultiSession feature. This feature is dynamically loaded.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(S));var x=S.option,I=(x.sidePanelTitle,Object(C.__rest)(x,["sidePanelTitle"])),O=Object(C.__assign)(Object(C.__assign)({},S),{sidePanelURL:Object(xe.a)(S.sidePanelURL),option:I});return h.push({name:"payload",value:JSON.stringify(O)}),new Promise((function(e){var t=b.ChannelManager.createChannel(Object(_.a)(),(function(n,i){i===y&&n.type===m.a.LoadCompleted&&(b.ChannelManager.destroyChannel(t),S.sidePanelLoadState=a.a.Completed,e(S))}));t.subscribeTo(y)}))},getFailureParameters:function(e,t,n,i){return h},getSuccessParameters:function(e,t,n){return h}}}function Oe(e){var t;if(null!=e&&p(e.toString()),null!=e){t=e.toString()+"px";try{localStorage.setItem(s.q,t)}catch(e){}}else{var n=void 0;try{p(n=localStorage.getItem(s.q))}catch(e){n=void 0}t=n||s.p}return t}function we(e){if(null!=e&&d(e),null!=e)try{localStorage.setItem(s.n,e.toString())}catch(e){}else{var t=void 0;try{t=localStorage.getItem(s.n),d(parseInt(t,10))}catch(e){t=void 0}e=void 0!==t?parseInt(t,10):1}return e}function Me(e){return null!=e&&l(e),null==e&&(e=2),e}}}]),window.bundleExecutionMarkers["scripts/es5/sidepanel.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();