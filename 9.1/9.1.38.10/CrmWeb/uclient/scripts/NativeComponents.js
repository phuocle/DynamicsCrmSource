(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/NativeComponents.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[37,35,39,69],{"+Ljw":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return l}));var a=n("SAYH"),r=n("jq7Z"),i=n("arV0"),o=n("y60j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,n=!1){var a;const{entityTypeName:s}=Object(i.g)(e,t),c=Object(o.n)(e,s);if(!n)return c;const l=Object(r.a)(e,t),u=null===(a=null==l?void 0:l.formSelector)||void 0===a?void 0:a.forms;let d=c;if(u&&Object.keys(u).length>0){d=new Object;for(const e in c)u[e]&&!u[e].visible||(d[e]=c[e])}return d}function c(e,t,n){var s,c;const l=Object(r.a)(e,t),u=a.a.toString(n);if(null===(c=null===(s=null==l?void 0:l.formSelector)||void 0===s?void 0:s.forms)||void 0===c?void 0:c[u])return l.formSelector.forms[u].visible;const{entityTypeName:d}=Object(i.g)(e,t);return!!Object(o.m)(e,d,n)||null}function l(e,t){var n;const a=Object(r.a)(e,t);return null===(n=null==a?void 0:a.formSelector)||void 0===n?void 0:n.selectedFormId}},"+aj2":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n("bq0x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="quickCreateForm.output";function i(e,t){return{type:"quickCreateForm.output.async",execute({dispatch:n,getState:i}){const o=Object(a.a)(i(),e)||[];return o.push(t),n(function(e,t){return{type:r,payload:{reason:"close",value:t},meta:{pageId:e}}}(e,o)),Promise.resolve(e)}}}},"/5se":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="controls.DefaultView";function i(e,t,n,i){const o=Object(a.v)(n);return{type:r,payload:i.guid,meta:{pageId:e,controlName:t,contextKey:o}}}},"/q/W":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("SoKF"),r=n("RrRQ"),i=n("i1f0"),o=n("4UCL"),s=n("zmL5"),c=n("dHD5"),l=n("bT7G"),u=n("jTSi"),d=n("O7zD");function h(e){return{type:"handle.unsaved.changes.async",execute:({dispatch:t,getState:n},h,g)=>t(Object(a.a)(e)).then(a=>{if(a){const a=Object(s.a)(n(),e),h=a.map(e=>Object(c.j)(n(),e));for(let e=0;e<a.length;e++){const s=a[e],c=h[e],g=Object(i.ac)(n(),s,c),p=Object(l.b)(n(),g),m=(null==p?void 0:p.activeChanges)?Object.keys(p.activeChanges):[];for(const e of m)t(Object(u.b)(c,s,Object(d.d)(s,e)));t(Object(r.c)(s,g,c)),t(Object(o.d)(s,c))}return!0}return!1})}}},"/q65":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.targets.set";function i(e,t,n,i){const o=Object(a.x)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},"0L4T":function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));var a=n("j2fa"),r=n("YxC/"),i=n("GEBM"),o=n("z8iZ"),s=n("DAWX"),c=n("3/02"),l=n("Lyxw"),u=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function d(e,t,n,a,o){let s=null;if(s=Object(r.b)(e,i.q),"function"==typeof n.get_ErrorCode)switch(n.get_ErrorCode()){case-2147093999:s=Object(r.b)(e,i.r);break;case-2147220960:s=Object(r.b)(e,i.o);break;case-2147164125:s=Object(r.b)(e,i.a);break;case-2147164130:case-2147164126:s=Object(r.b)(e,i.j);break;case-2147217149:s=Object(r.b)(e,i.i);break;case-2147217098:s=Object(r.b)(e,i.x);break;case-2147220969:case-2147187962:s=Object(r.b)(e,i.p);break;default:n.get_Message()&&(s=s+" "+n.get_Message())}h(e,t,s,a,o)}function h(e,t,n,r,i){let d=null;d=function(e){const t=Object(o.a)();return t.ErrorInformation=new s.a,t.ErrorInformation.set_ErrorDescription(e),t}(n),Object(l.c)(e,c.rd)?(t(Object(a.a)(r.getStorageKey(),d)),Object(a.e)(e,t,r.getStorageKey(),i)):(t(Object(a.c)(u.a.toString(r.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(r.viewId)||u.a.EMPTYGUIDSTRING,d)),Object(a.d)(e,t,u.a.toString(r.visualizationId)||u.a.EMPTYGUIDSTRING,u.a.toString(r.viewId)||u.a.EMPTYGUIDSTRING,i))}function g(e,t,n,a,o,s){h(t,n,-2147220960===e?Object(r.b)(t,i.o):a,o,s)}},"0PSL":function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a,r=n("SAYH"),i=n("hvSt");!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive",e[e.Completed=2]="Completed"}(a||(a={}));var o=n("CPoS"),s=n("xMtD"),c=n("odYE"),l=n("VnpK"),u=n("S2mk"),d=n("LbMF"),h=n("+nNZ"),g=n("i1f0"),p=n("dHD5"),m=n("iZ7K"),b=n("504W"),f=n("Lyxw"),y=n("9fGf"),C=n("arV0"),_=n("WRF3"),v=n("fU7K");class S{constructor(e,t,n){this._memorizedExtraFilters=[],this._getState=e,this._businessProcessFlowWrapperIdentifierFactory=t,this._context=n}generate(e,t){return t?this._getBusinessProcessFlowWrapper(e,t):null}_getBusinessProcessFlowWrapper(e,t){const n=this._getState(),a=this._businessProcessFlowWrapperIdentifierFactory.generate(e,t);if(!a||!t||!t.getProcessId())return null;const i=t.getCurrentFormEntity(),c=Object(C.g)(n,e);this._navigationEntities=t.getNavigationEntities();const l=Object(h.f)(n,i);return{id:t.getProcessId(),instanceId:t.getProcessInstanceId(),name:Object(o.c)(n,t.getProcessId()),bpfEntityLogicalName:t.getBpfEntityLogicalName(),stages:this._getStages(a.data.activePath,a.activeStageId,a.data.selectedStageId,e,t),relationships:Object(s.e)(this._getState(),t.getProcessId()),activeStageId:a.activeStageId,selectedStageId:a.data.selectedStageId,activePath:a.data.activePath,displayState:a.displayState,currentEntity:new _.a(i.etn,r.a.toLegacyGuid(i.id)),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),statusName:t.getStatusName(),isFormInactive:Object(g.Lb)(n,c.entityTypeName,c.id),delegates:this._getActions(t),isVisible:t.isVisible(),actionLogs:a.data.actionLogCollection,instanceModifiedTimestamp:l,instanceName:t.getProcessInstanceName(),isCustomControlsPresent:t.getCustomControlIndicator(),isRenderedFromFormXml:t.getFormXmlRenderingIndicator(),isImmersiveBPF:t.isImmersiveBPF()}}_getStages(e,t,n,a,i){if(!e||0===e.length)return null;const o={},s=[];return e.forEach((e,c)=>{o[e.guid]=c;const l=r.a.equals(e,n),u=this._getStageWrapper(e,l,t,o,a,i);u&&s.push(u)}),s}_getStageWrapper(e,t,n,a,i,o){const c=Object(s.c)(this._getState(),o.getProcessId(),e);if(!c)return null;let l=t&&this._getSteps(c,i,o)||[];if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BusinessProcessFlow.CustomControlConfiguration",t=this._context.TraceManager.getTracer(e),n=Object(s.a)(this._getState(),o.getProcessId(),t);if(!Object(b.a)(n)&&!Object(b.a)(n.ControlConfigurations)){const a=o.getTelemetryParams();if(a.push({name:"BPFEntityFormId",value:n.Id.guid},{name:"BPFEntityFormType",value:n.FormType}),Object(b.a)(n.ControlConfigurations)||a.push({name:"CustomControls",value:Object.keys(n.ControlConfigurations).length}),o.isBpfFormDescriptorValid(this._getState(),o.getProcessId(),n,t))try{if(!Object(b.a)(n.ControlConfigurations)){const u=Object(s.b)(n,t),d=n.ControlConfigurations,h=this._getNonDefaultControlConfiguration(d);if(Object(f.c)(this._getState(),"FCB.EnableBPFCCPhase3")){const t=this._buildStepsFromFormXml(c,n,h,a,i,o);t&&t.length>0&&(l=t,o.setFormXmlRenderingIndicator(!0),this._context.EventManager.ReportComponentSuccess(e,a))}else Object(b.a)(u)||Object.keys(u).forEach(n=>{if(u[n].ParentCellId){const i=new r.a(u[n].ParentCellId);if((c&&c.stage&&c.stage.steps?c.stage.steps.map(e=>e.stepId.guid).indexOf(i.guid):-1)>=0&&i){const s=[];s.push({name:"StepId",value:i.guid},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),t.info("Non-default control found for step",s);let d=null;h&&u[n].UniqueId&&(o.setFormXmlRenderingIndicator(!0),d=h[u[n].UniqueId]?h[u[n].UniqueId]:null);const g={attributeName:u[n].DataFieldName,isRequired:this._getIsStepRequired(i.guid,c),name:u[n].Label,stepId:new r.a(i.guid),stepType:"field",attributeType:this._getMetadataTypeByAttribute(c.entityLogicalName,u[n].DataFieldName),controlName:"header_process_"+u[n].Label,isVisible:u[n].Visible,isControlDisabled:u[n].Disabled,nonDefaultConfiguration:d};l.push(g),Object(b.a)(g.stepId.guid)||g.stepId.guid===r.a.EMPTY.guid||a.push({name:"StepId",value:g.stepId.guid}),a.push({name:"AttributeName",value:g.attributeName},{name:"AttributeType",value:g.attributeType},{name:"IsRequired",value:g.isRequired},{name:"NonDefaultControlUniqueId",value:u[n].UniqueId}),Object(b.a)(d)?this._context.EventManager.ReportComponentFailure(e,new Error("CustomControlConfiguration is null or undefined even though the BPF entity form XML is valid and contains non-default custom control descriptors"),null,a):(o.setCustomControlIndicator(!0),a.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&a.push({name:"CustomControlName",value:d.Name}),this._context.EventManager.ReportComponentSuccess(e,a))}}})}}catch(n){t.error(`Message: ${n.message}, Stack: ${n.stack}`,a),this._context.EventManager.ReportComponentFailure(e,n,null,a)}else this._context.EventManager.ReportComponentFailure(e,new Error("Invalid FormXML - Fallback invoked"),null,a)}}return{id:c.stage.stageId,name:c.stage.stageDisplayName,entityName:c.entityLogicalName,entityDisplayName:Object(m.f)(this._getState(),c.entityLogicalName)||c.entityDisplayName,relatedEntityReference:this._getRelatedEntityReference(c.entityLogicalName),referencingAttributeName:c.referencingAttributeName,status:this._getStageStatus(a[e.guid],a[n.guid],o),steps:l}}_buildStepsFromFormXml(e,t,n,a,i,o){const s=[],c=t.Controls;return!Object(b.a)(c)&&this._areStepsValid(e,t,a)&&Object.keys(c).forEach(l=>{if(!Object(b.a)(c[l])&&c[l].ParentCellId){const u=new r.a(c[l].ParentCellId),d=t.Tabs.find(e=>e.Id===c[l].ParentTabId);if(d&&!Object(b.a)(d.RawTabId)&&e.stage.stageId.guid===new r.a(d.RawTabId).guid){let d=null;n&&c[l].UniqueId!==r.a.EMPTY.guid&&(d=n[c[l].UniqueId]?n[c[l].UniqueId]:null);const h=this._retrieveControlName(c[l],e.stage.steps),p=this._getUIControl(i,h),m={attributeName:c[l].DataFieldName,isRequired:c[l].IsRequired,name:this._retrieveStepLabel(c[l],p,e.stage.steps),stepId:new r.a(u.guid),stepType:this._getStepTypeFromControlKey(l),attributeType:this._getMetadataTypeByAttribute(e.entityLogicalName,c[l].DataFieldName),controlName:h,isVisible:p&&!Object(b.a)(p.visible)?p.visible:c[l].Visible,isControlDisabled:c[l].Disabled||Object(g.t)(this._getState(),{id:i,controlName:h},o.getContextToken()),viewId:p&&p.parameters&&p.parameters.defaultviewid?p.parameters.defaultviewid:null,nonDefaultConfiguration:Object(b.a)(d)?null:d};m.config=this._getConfig(t,o,c[l],i,a),m.viewId&&m.config&&m.config.Parameters&&m.config.Parameters.value&&(m.config.Parameters.value.ViewId=m.viewId,p&&p.customFilter&&p.customFilter.length>0&&(this._applyLookupFilter(m,p),m.config.Parameters.value.ExtraFilters=m.extraFilters)),s.push(m),a.push({name:"StepId",value:m.stepId.guid},{name:"AttributeName",value:m.attributeName},{name:"AttributeType",value:m.attributeType},{name:"IsRequired",value:m.isRequired},{name:"NonDefaultControlUniqueId",value:c[l].UniqueId}),Object(b.a)(d)||c[l].UniqueId===r.a.EMPTY.guid||(o.setCustomControlIndicator(!0),a.push({name:"CustomControlId",value:d.CustomControlId}),!Object(b.a)(d.Name)&&d.Name.indexOf("MscrmControls")>=0&&a.push({name:"CustomControlName",value:d.Name}))}}}),s}_areStepsValid(e,t,n){if(!(Object(b.a)(t)||Object(b.a)(e)||Object(b.a)(e.stage)||Object(b.a)(e.stage.stageId))){const a=t.Controls,i=e.stage.stageId.guid.toLowerCase(),o=e.stage.steps,s=[];if(!Object(b.a)(a)){if(Object.keys(a).forEach(e=>{if(!Object(b.a)(a[e].ParentCellId)){const n=new r.a(a[e].ParentCellId).guid.toLowerCase(),o=t.Tabs.find(t=>t.Id===a[e].ParentTabId);if(!Object(b.a)(o)&&!Object(b.a)(o.RawTabId)){const e=new r.a(o.RawTabId).guid.toLowerCase();i===e&&s.indexOf(n)<0&&s.push(n)}}}),o.length!==s.length)return n.push({name:"StepFallback",value:"No. of steps in BPF stage don't match no. of cells in corresponding tab"},{name:"BPFStageStepCount",value:o.length},{name:"TabCellCount",value:s.length}),!1;for(let e=0;e<o.length;e++)if(s.indexOf(o[e].stepId.guid.toLowerCase())<0)return n.push({name:"StepFallback",value:"BPF stage stepId does not match corresponding tab's cellId"},{name:"MissingBPFStepId",value:o[e].stepId.guid.toLowerCase()}),!1;return!0}}return!1}_retrieveStepLabel(e,t,n){if(!Object(b.a)(t)&&!Object(b.a)(t.label)&&""!==t.label)return t.label;if(!Object(b.a)(e.Label)&&""!==e.Label)return e.Label;if(!Object(b.a)(n)&&n.length>0)for(const t of n)if(t.stepId.guid===new r.a(e.ParentCellId).guid&&!Object(b.a)(t.label)&&""!==t.label)return t.label;return""}_retrieveControlName(e,t){if(!Object(b.a)(t)&&t.length>0)for(const n of t)if(n.stepId.guid===new r.a(e.ParentCellId).guid&&!Object(b.b)(n.controlName))return n.controlName;return Object(b.a)(e.DataFieldName)||""===e.DataFieldName?"":"header_process_"+e.DataFieldName}_getConfig(e,t,n,a,r){try{const i=Object(g.h)(),o=e&&e.Id,s=t.getCurrentFormEntity();r.push({name:"ControlDescriptorName",value:n&&n.Name});const c=i(this._getState(),n,a,o,s&&s.name,!1);return r.push({name:"CCFControlConfigID",value:c&&c.CustomControlId},{name:"CCFControlConfigName",value:c&&c.Name},{name:"CCFControlConfigParams",value:c&&c.Parameters&&Object.keys(c.Parameters).join(",")}),c}catch(e){r.push({name:"CCFControlConfigError",value:e})}return null}_getStageStatus(e,t,n){if(null==t||e<t)return a.Completed;if(e===t){return n.getStatus()===i.a.Finished?a.Completed:a.Active}return a.Inactive}_getSteps(e,t,n){const a=[];if(!e.stage||!e.stage.steps||0===e.stage.steps.length)return null;for(const r of e.stage.steps){const i=this._getUIControl(t,r.controlName);let o=null;if(r.name&&r.stepType&&"field"===r.stepType.toLowerCase()){if(o=this._getMetadataTypeByAttribute(e.entityLogicalName,r.name),!o)continue;if(Object(f.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const e="BpfCustomControlSupport",t=this._context.TraceManager.getTracer(e),a=Object(s.a)(this._getState(),n.getProcessId(),t);if(!Object(b.a)(a)&&!Object(b.a)(a.ControlConfigurations)&&n.isBpfFormDescriptorValid(this._getState(),n.getProcessId(),a,t)){const e=Object(s.b)(a,t),n=this._getNonDefaultControlStepIds(e);if(!Object(b.a)(n)&&n.map(e=>e.guid).indexOf(r.stepId.guid)>=0)continue}}}const c=this._getState(),l={attributeName:r.name,controlName:r.controlName,isRequired:r.required,isVisible:!i||i.visible,name:i?i.label:r.label,stepId:r.stepId,stepType:r.stepType,attributeType:o,viewId:i&&i.parameters&&i.parameters.defaultviewid?i.parameters.defaultviewid:r.viewId,isControlDisabled:Object(g.t)(c,{id:t,controlName:r.controlName},n.getContextToken())};l.viewId&&i&&i.customFilter&&i.customFilter&&i.customFilter.length>0&&this._applyLookupFilter(l,i),a.push(l)}return a}_applyLookupFilter(e,t){let n;n=!1;const a=[];if(e&&t){for(let e=0;e<t.customFilter.length;e++){if("END_FLAG"===t.customFilter[e].customFilter){n=!0;break}if("START_FLAG"!==t.customFilter[e].customFilter){const n=Object(l.i)(Object(v.CrmHtmlDecode)(t.customFilter[e].customFilter));n&&(n.conditions&&n.conditions.length>0||n.filters&&n.filters.length>0)&&a.push(JSON.stringify(n))}}n?(this._memorizedExtraFilters=a,e.extraFilters=this._memorizedExtraFilters):e.extraFilters=this._memorizedExtraFilters?this._memorizedExtraFilters:[]}}_getMetadataTypeByAttribute(e,t){const n=this._getState(),a=Object(d.a)(n,e,t);if(!a)return null;const r=`${a.Type}.${a.Format}`;return Object(u.n)(r)}_getActions(e){return{completeProcess:()=>e.completeProcess(),moveNext:()=>e.moveToNextStage(),movePrevious:()=>e.moveToPreviousStage(),setActiveStage:t=>e.setActiveStage(t.guid),setSelectedStage:(t,n=!1)=>{e.setSelectedStage(t?t.guid:null,n)},triggerActionStepClick:t=>{e.triggerActionStepClick(t)},triggerFlowStepClick:(t,n)=>{e.triggerFlowStepClick(t,n)},refreshFlowStepClick:t=>{e.refreshFlowStepClick(t)},setDisplayState:t=>{e.setDisplayState(t)},getForwardNavigationEntities:(t,n,a,r)=>e.getForwardNavigationEntities(t,n,a,r),navigateToNextEntity:(t,n,a,r)=>e.navigateToNextEntity(c.a.fromLegacyEntityReference(t),c.a.fromLegacyEntityReference(n),a,r),executePreEvent:(t,n,a,r)=>e.executePreEvent(t,n,a,r),validateRequiredFieldsForNavigation:()=>e.ValidateRequiredFieldsForNavigation(),waitForOngoingWork:()=>e.waitForOngoingWork(),getActiveStageActiveFor:()=>e.getActiveStageActiveFor(),getBpfInstanceActiveFor:()=>e.getBpfInstanceActiveFor(),getBpfInstanceCompletedIn:()=>e.getBpfInstanceCompletedIn(),getBpfNavigationBehavior:()=>e.getBpfNavigationBehavior(),setBpfNavigationBehavior:t=>{e.setBpfNavigationBehavior(t)},getBpfNavigationBehaviorAllowCreateNew:t=>e.getBpfNavigationBehaviorAllowCreateNew(t),getActiveStage:()=>{const t=e.getContextToken(),n=e.getScriptContainer().getEventManager().getClientApiForm(t);return n?n.data.process.getActiveStage():null}}}_getRelatedEntityReference(e){if(!this._navigationEntities)return null;const t=this._navigationEntities.find(t=>t.entityLogicalName===e);return t?new _.a(t.entityLogicalName,r.a.toLegacyGuid(r.a.parse(t.id))):null}_getUIControl(e,t){if(t){const n=this._getState(),a=Object(p.j)(n,e),r={controlName:t,id:e};return Object(g.Mc)(this._getState(),r,a)}return null}_getNonDefaultControlConfiguration(e){const t={};if(e){const n=Object.keys(e);for(let a=0;a<n.length;a++){let r=null;const i=Object(y.b)(this._getState());r=e[n[a]].CustomControls[i],r&&(t[n[a]]={FormFactor:r.FormFactor,CustomControlId:r.CustomControlId,Name:r.Name,Version:r.Version,Parameters:r.Parameters,ShouldOverrideControlVisible:r.ShouldOverrideControlVisible,DisplayNameKey:r.DisplayNameKey})}}return t}_getNonDefaultControlStepIds(e){const t=[];return e&&Object.keys(e).forEach(n=>{e[n].ParentCellId&&t.push(new r.a(e[n].ParentCellId))}),t}_getIsStepRequired(e,t){const n=t.stage.steps,a=n?n.map(e=>e.stepId.guid).indexOf(e):-1;return a>=0&&!Object(b.a)(n[a].required)&&n[a].required}_getStepTypeFromControlKey(e){return e.endsWith("_actionstep")?"action":e.endsWith("_flowstep")?"modernflow":"field"}}},"0U+K":function(e,t,n){"use strict";function a(e,t){const n=function(e){return[e.colors.BaseColor.Blue.Blue3,e.colors.BaseColor.Orange.Orange5,e.colors.BaseColor.Teal.Teal5,e.colors.BaseColor.Clay.Clay4,e.colors.BaseColor.Violet.Violet4,e.colors.BaseColor.Blue.Blue4,e.colors.BaseColor.Red.Red5,e.colors.BaseColor.Yellow.Yellow5,e.colors.BaseColor.Pink.Pink5,e.colors.BaseColor.Green.Green5,e.colors.BaseColor.Purple.Purple2,e.colors.BaseColor.Blue.Blue5,e.colors.BaseColor.Clay.Clay5]}(t);return n[e%n.length]}function r(e){let t="";if(e)for(let n=e.split(" "),a=0;a<n.length&&t.length<2;a++)if(n[a].length>0){const e=n[a].charCodeAt(0);if(!(e>=97&&e<=122||e>=65&&e<=90)){t+=n[a].charAt(0);break}t+=n[a].charAt(0)}return t}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},"0YTt":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={animationIn:{from:{scale:1.05},to:{scale:1}},animationOut:{from:{opacity:1},to:{opacity:0}},animationInTiming:200,animationOutTiming:150}},"0jo4":function(e,t,n){"use strict";n.r(t),n.d(t,"GreetingLabel",(function(){return o})),n.d(t,"OfflineStatusDialog",(function(){return ke})),n.d(t,"DRILLDOWN_STYLE",(function(){return dr})),n.d(t,"NavigationBarStyleContext",(function(){return hr})),n.d(t,"NavigationBarStringContext",(function(){return gr})),n.d(t,"useNavigationBarStringContextValue",(function(){return mr})),n.d(t,"NavigationBar",(function(){return br})),n.d(t,"StackNavigator",(function(){return Tc})),n.d(t,"ViewSelector",(function(){return Nc})),n.d(t,"NavigationBarPageTitle",(function(){return _a})),n.d(t,"FillNativeNavigationBar",(function(){return va})),n.d(t,"ProvidePageScrollContext",(function(){return Dc})),n.d(t,"FullScreenModal",(function(){return Lc})),n.d(t,"QuickCreateFormWithNativeHeader",(function(){return Kc})),n.d(t,"ConfirmDialog",(function(){return nc})),n.d(t,"PageScrollContext",(function(){return Le})),n.d(t,"ConnectToPageScrollContext",(function(){return Ge})),n.d(t,"NativeSubgridCommandbarWrapper",(function(){return Jc})),n.d(t,"QuickFindSearchBar",(function(){return al}));var a=n("nuS9"),r=n("WziN"),i=n("pyUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function o(e){return a.createElement(r.a,null,a.createElement(i.a,null,"Hello, ",e.title,"!"))}var s=n("qkkp"),c=n("3/02"),l=n("u+q+"),u=n("GYXq"),d=n("l1Zb"),h=n("EZ4w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function g(){const e=a.createRef();return a.useEffect(()=>{e.current.setNativeProps({tabindex:0})}),e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const p=h.a.create({containerStyle:{flexDirection:"column"},statusStyle:{fontWeight:"600",fontSize:16,color:"#333333"},messageStyle:{fontSize:14,lineHeight:16,color:"#666666",paddingBottom:15},linkStyle:{color:"blue",textDecorationLine:"underline"}}),m=a.memo((function({statusLabel:e,statusText:t,statusMessage:n,helpLabel:o,helpLinkLabel:s,helpLinkHandler:c,helpLinkAccessibilityLabel:l}){const u=g(),d=c&&s&&a.createElement(i.a,{style:p.linkStyle,onPress:c,accessibilityRole:"link",ref:u,accessibilityLabel:l},s);return a.createElement(r.a,{style:p.containerStyle},a.createElement(i.a,{style:p.statusStyle},e,": ",t),a.createElement(i.a,{style:p.messageStyle},n),a.createElement(i.a,{style:p.messageStyle},o," ",d))}));var b=n("Jcgi");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const f=h.a.create({button:{textAlign:"center",color:"#FFF",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#0078D4",borderRadius:2,fontSize:14,lineHeight:19},buttonContainer:{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row",justifyContent:"center",backgroundColor:"#FFF",bottom:0,left:0,width:"100%",paddingTop:21,borderTopColor:"#D8D8D8",borderStyle:"solid",borderTopWidth:1}}),y=a.memo((function({isMetadataDownloadRequired:e,downloadOfflineMetadataHandler:t,downloadOfflineMetadataButtonLabel:n}){return e?a.createElement(r.a,{style:f.buttonContainer},a.createElement(b.a,{title:n,accessibilityLabel:n,accessibilityComponentType:"button",accessibilityTraits:"button",style:f.button,onPress:t})):null}));var C=n("NdUn"),_=n("pUMQ");const v=h.a.create({closeButtonStyle:{height:"2.5rem",width:"2.5rem",borderWidth:0,backgroundColor:"transparent",justifyContent:"center",alignItems:"center",paddingLeft:"0.625rem",paddingRight:"0.625rem"},closeButtonTextStyle:{color:"#333",fontSize:14}}),S=a.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return a.createElement(C.b,{onPress:e.closeHandler,icon:_.a.CancelFilter,size:v.closeButtonTextStyle.fontSize,color:v.closeButtonTextStyle.color,style:v.closeButtonStyle,accessibilityLabel:e.label})}));var O=n("RQTs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const I=h.a.create({button:{textAlign:"center",color:"#666666",paddingTop:6,paddingBottom:7,backgroundColor:"#FFFFFF",borderRadius:2,borderColor:"#444444",borderWidth:1,fontSize:14,lineHeight:19,alignSelf:"stretch"},progressContainer:{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"column",justifyContent:"center",backgroundColor:"#FFF",bottom:0,left:0,width:"100%",paddingTop:21,borderTopColor:"#D8D8D8",borderStyle:"solid",borderTopWidth:1},progressGif:{height:250,width:250},textContainer:{marginBottom:24,marginTop:24,justifyContent:"center",alignItems:"center"}}),j=a.memo((function({onClickCancelDownloadButton:e,labelCancelButton:t,labelProgress:n,progressSpinnerLabel:o,showSpinner:s}){return a.createElement(r.a,{style:I.progressContainer,accessibilityLabel:n},s&&a.createElement(O.a,{size:"small",color:"#A8A8AC",accessibilityComponentType:"none",accessibilityLabel:o}),a.createElement(r.a,{style:I.textContainer},a.createElement(i.a,{style:{color:"inherit"},accessibilityLabel:n},n)),a.createElement(b.a,{title:t,accessibilityLabel:t,accessibilityComponentType:"button",accessibilityTraits:"button",style:I.button,onPress:e}))}));var P=n("OyOX"),x=n("dD0b");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function E(e){const{toggleSwitchOn:t,isDisabled:n,onchange:r,accessibilityLabel:i,accessibilityOnLabel:o,accessibilityOffLabel:s}=e,c=e=>e?"checked":"unchecked",l=new P.a.Value(t?1:0),u=(t?o:s).replace("{0}",i),[,d]=a.useState(c(t)),h=a.useCallback(()=>{const e={toValue:t?0:1,duration:300};P.a.timing(l,e).start(()=>{d(c(!t)),r(!t)})},[l,r,t]);return a.createElement(x.a,{disabled:n,onPress:h,accessibilityRole:"switch",accessibilityLabel:u,accessibilityState:{disabled:n,checked:t},accessibilityStates:[c(t)],activeOpacity:.5},a.createElement(P.a.View,{style:[w.baseContainer,{backgroundColor:l.interpolate({inputRange:[0,1],outputRange:["white","#0078D4"]}),borderColor:l.interpolate({inputRange:[0,1],outputRange:["#666666","#0078D4"]})}]},a.createElement(P.a.View,{style:[w.circleStyle,{backgroundColor:l.interpolate({inputRange:[0,1],outputRange:["#666666","white"]}),transform:[{translateX:l.interpolate({inputRange:[0,1],outputRange:[0,20]})}]},w.buttonStyle]})))}const w=h.a.create({baseContainer:{flexDirection:"row",alignItems:"center",width:40,height:20,borderRadius:10,borderColor:"#666666",borderWidth:2,backgroundColor:"white",padding:4},circleStyle:{width:10,height:10,borderRadius:5,backgroundColor:"#666666"},buttonStyle:{alignItems:"center",justifyContent:"center",position:"absolute"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const T=h.a.create({touchableContainer:{flexDirection:"row",justifyContent:"space-between",paddingTop:15,paddingBottom:10,alignItems:"flex-start",flexGrow:1},textContainer:{flexDirection:"row",alignItems:"center"},buttonTextStyle:{fontSize:16,paddingLeft:13,color:"#666666"}}),A=a.memo((function(e){const{onChangeToggleOption:t,labelToggleOption:n,toggleSwitchOn:o,isDisabledToggleOption:s,accessibilityOnLabel:c,accessibilityOffLabel:l}=e;return a.createElement(r.a,{style:[T.touchableContainer,{opacity:s?.5:1}],accessibilityLabel:n},a.createElement(r.a,{style:T.textContainer,accessibilityElementsHidden:!0,importantForAccessibility:"no-hide-descendants"},a.createElement(C.a,{icon:_.a.NetworkOffline,size:T.buttonTextStyle.fontSize,color:"#818181",type:0}),a.createElement(i.a,{style:T.buttonTextStyle},n)),a.createElement(E,{toggleSwitchOn:o,isDisabled:s,onchange:t,accessibilityLabel:n,accessibilityOnLabel:c,accessibilityOffLabel:l}))}));var F=n("G0lj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const N=e=>a.createElement(F.a,{role:"cell",style:k.rowItem},a.createElement(i.a,{style:k.rowItemText},e.text)),k=h.a.create({row:{flexDirection:"row",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},rowItem:{flex:1,alignSelf:"stretch",minWidth:0,paddingRight:5},rowItemText:{fontSize:14,color:"#333333",lineHeight:16}}),M=a.memo((function({entityName:e,entityLastSyncValue:t}){return a.createElement(F.a,{role:"row",style:k.row,key:e},a.createElement(N,{text:e}),a.createElement(N,{text:t}))}));const D=e=>a.createElement(F.a,{role:"columnheader",style:R.headerRowItem},a.createElement(i.a,{style:R.headerRowItemText,numberOfLines:1,ellipsizeMode:"tail"},e.text)),R=h.a.create({table:{flexShrink:1},headerRowGroup:{flexDirection:"row",marginBottom:8,paddingBottom:8,borderBottomWidth:1,borderBottomColor:"#D8D8D8"},headerRowItem:{flex:1,alignSelf:"stretch"},headerRowItemText:{fontSize:12,lineHeight:14,color:"#666666"},entitiesRowGroup:{flexShrink:1,overflowY:"auto"}}),L=a.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({headerLabels:e,data:t}){return a.createElement(F.a,{role:"table",style:R.table},a.createElement(F.a,{role:"rowgroup"},a.createElement(F.a,{role:"row",style:R.headerRowGroup},a.createElement(D,{text:e.entity}),a.createElement(D,{text:e.lastSyncValue}))),a.createElement(F.a,{role:"rowgroup",style:R.entitiesRowGroup},Object.keys(t).map(e=>a.createElement(M,{key:e,entityName:e,entityLastSyncValue:t[e]}))))}));const B=h.a.create({container:{flexDirection:"column",flexGrow:0,flexShrink:1,flexBasis:"auto"},summaryLine:{flexDirection:"row",paddingTop:15,paddingBottom:10,alignItems:"center"},summaryLineLabel:{paddingLeft:13,paddingRight:13,flex:1,fontSize:16},collapseButton:{alignContent:"flex-end"}}),V=a.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({icon:e,isCollapsedDefault:t,data:n,listNameTemplate:o,buttonAriaLabel:s,headerLabels:c,isForcedSyncInProgress:l}){const[u,d]=a.useState(t),h=a.useCallback(()=>d(!u),[u]),g=o.replace("{0}",Object.keys(n).length.toString());return a.createElement(r.a,{style:[B.container,{minHeight:u?"46px":"150px"}]},a.createElement(x.a,{style:B.summaryLine,onPress:h,accessibilityRole:"listbox","aria-expanded":!u,"aria-haspopup":"false","aria-label":s+". "+g},l?a.createElement(O.a,{size:"small",color:"#A8A8AC",accessibilityComponentType:"none",style:[{transform:[{scale:.8}]}]}):a.createElement(C.a,{icon:e,size:B.summaryLineLabel.fontSize,color:"#000000",type:0}),a.createElement(i.a,{style:B.summaryLineLabel,numberOfLines:1,ellipsizeMode:"tail"},g),a.createElement(r.a,{style:B.collapseButton},a.createElement(C.a,{icon:u?_.a.DropdownArrow:_.a.ChevronUp,size:B.summaryLineLabel.fontSize,color:"#333333",type:0}))),!u&&a.createElement(L,{headerLabels:c,data:n}))}));var G=n("FhVi"),z=n("a475");const W={animated:!0,showHideTransition:"slide",hidden:!1};let X=0;const H=new class{constructor(){this._stack=[],this._updateStatusBarTimeout=null,this._updateStatusBar=()=>{if(this._updateStatusBarTimeout=null,this._stack.length>0){!function(e){const t=z.a.get_Instance().get_device();t.get_IsAvailable()&&t.postMessage(JSON.stringify({name:"changeStatusBar",props:e}))}(this._stack[this._stack.length-1].props)}}}add(e,t){this._stack.push({id:e,props:Object.assign(Object.assign({},W),t)}),this._debounceUpdateStatusBar()}update(e,t){this._stack=this._stack.map(n=>n.id===e?Object.assign(Object.assign({},n),{props:Object.assign(Object.assign({},W),t)}):n),this._debounceUpdateStatusBar()}remove(e){this._stack=this._stack.filter(t=>t.id!==e),this._debounceUpdateStatusBar()}_debounceUpdateStatusBar(){this._updateStatusBarTimeout&&clearTimeout(this._updateStatusBarTimeout),this._updateStatusBarTimeout=setTimeout(this._updateStatusBar,50)}};class U extends a.PureComponent{constructor(){super(...arguments),this._uniqueID="statusBar_"+X++}componentDidMount(){H.add(this._uniqueID,this.props)}componentDidUpdate(){H.update(this._uniqueID,this.props)}componentWillUnmount(){H.remove(this._uniqueID)}render(){return null}}var q=n("KOTC");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Y=a.memo(e=>{const t=e.offlineStatusAvailableEntitiesListProps.data,o=e.offlineStatusNotAvailableEntitiesListProps.data;return a.createElement(u.a,{style:{backgroundColor:"#FFFFFF"}},a.createElement(U,{barStyle:"dark-content",backgroundColor:"#FFFFFF"}),a.createElement(r.a,{nativeID:"OfflineStatusDialogPresentation",style:[J.rootStyle,{paddingLeft:e.isMainFormDialog?0:Z,paddingTop:e.isMainFormDialog?0:Z}],accessibilityLabel:e.title},a.createElement(r.a,{style:J.dialogHeaderContainerStyle},a.createElement(i.a,{style:J.dialogHeaderStyle,numberOfLines:1},e.title),a.createElement(S,{closeHandler:e.closeHandler,label:e.closeButtonLabel})),a.createElement(m,Object.assign({},e.offlineStatusDescriptionProps)),e.isForceSyncOfflineDataFeatureEnabled&&e.isFirstSyncCompleted&&a.createElement(F.a,{role:"cell",style:{alignSelf:"flex-start"}},a.createElement(b.a,{title:e.updateOfflineDataButtonLabel,disabled:e.isForcedSyncInProgress,onPress:e.forcedOfflineDataUpdateHandler,accessibilityLabel:e.updateOfflineDataButtonLabel,accessibilityComponentType:"button",accessibilityTraits:"button",style:e.isForcedSyncInProgress?J.buttonDisabled:J.buttonEnabled})),t&&Object.keys(t).length>0&&a.createElement(V,Object.assign({},e.offlineStatusAvailableEntitiesListProps)),o&&Object.keys(o).length>0&&a.createElement(V,Object.assign({},e.offlineStatusNotAvailableEntitiesListProps)),e.isOfflineFileDownloadFeatureEnabled&&e.isFirstSyncCompleted&&e.offlineStatusFileDownloadStatusListProps.isFileDownloadProgressVisible&&a.createElement(q.a,{loader:()=>n.e(38).then(n.bind(null,"bEpu")).then(e=>e.OfflineStatusFileDownloadStatusList),props:Object.assign({},e.offlineStatusFileDownloadStatusListProps)}),e.isOfflineStatusToggleVisible&&a.createElement(A,Object.assign({},e.offlineStatusToggleOptionProps)),(e.isProgressVisible||e.isForcedSyncInProgress)&&a.createElement(j,Object.assign({},e.offlineStatusDownloadProgressProps)),a.createElement(y,Object.assign({},e.downloadOfflineMetadataButtonProps)),a.createElement(G.a,{key:"accessibilityComponent",rootElementId:"OfflineStatusDialogPresentation",shouldManageFocus:!0,isModal:!0})))}),K=d.a.get("window"),Q=Math.round(K.width),Z=Q<=480?14:21,J=h.a.create({dialogHeaderContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"1.25rem"},dialogHeaderStyle:{overflow:"hidden",marginTop:0,marginBottom:0,fontSize:17,fontWeight:"600",color:"#333"},rootStyle:{flexWrap:"nowrap",display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#FFFFFF",paddingBottom:Z,paddingRight:Z,width:Q<500?Q:500,alignSelf:"flex-end"},buttonEnabled:{textAlign:"center",color:"#FFF",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#0078D4",borderRadius:2,fontSize:14,lineHeight:19,paddingLeft:16,paddingRight:16},buttonDisabled:{textAlign:"center",color:"#ACACAC",paddingTop:6,paddingBottom:7,flex:1,backgroundColor:"#F1F1F1",borderRadius:2,fontSize:14,lineHeight:19,paddingLeft:16,paddingRight:16}});var $=n("YxC/"),ee=n("gQ5I"),te=n("i1f0"),ne=n("z0a7"),ae=n("37s6"),re=n("sZ+8"),ie=n("69Qu"),oe=n("yRo8"),se=n("smSa"),ce=n("GLaK"),le=n("83Lp"),ue=n("JhlA"),de=n("Lyxw"),he=n("eZ32"),ge=n("Rj8P"),pe=n("TBkx"),me=n("8CLP"),be=n("RADj"),fe=n("pEXn"),ye=n("6lVV");var Ce,_e=n("iF9X"),ve=n("Xd5/"),Se=n("lcrw");function Oe(e,t,n,a){const r={},i={};return e&&Object.keys(e).forEach((o,s)=>{const c=function(e,t,n){const{notAvailableLabel:a,downloadErrorLabel:r,estimatedTimeLeftLabel:i,lastSyncDateTodayLabel:o,lastSyncDateYesterdayLabel:s,lastSyncDateAtLabel:c}=t;let l=a;if(null!=e&&void 0!==e.initialdatadownloadstatus&&null!==e.initialdatadownloadstatus){const t=parseInt(e.initialdatadownloadstatus,10);if(!isNaN(t))switch(t){case Ce.Failed:l=r;break;case Ce.Completed:if(e.lastdatasynctime){let t=null;const a=Date.parse(e.lastdatasynctime);t=isNaN(a)?Object(Se.b)(e.lastdatasynctime,"yyyy-MM-dd HH:mm:ss",n):new Date(a),t&&(l=Object(ve.g)(t,o,s,c,n))}break;default:if(void 0!==e.initialdatadownloadetainminutes&&null!==e.initialdatadownloadetainminutes){let t,n;const a=parseInt(e.initialdatadownloadetainminutes,10);isNaN(a)||(n=Math.floor(a/60),t=a%60,l=i.replace("{0}",n.toString()).replace("{1}",t.toString()))}}}return l}(e[o],n,a);t&&t.indexOf(o)>=0?i[e[o].displayname]=c:r[e[o].displayname]=c}),{availableEntitiesListData:r,notAvailableEntitiesListData:i}}!function(e){e[e.Pending=0]="Pending",e[e.Completed=1]="Completed",e[e.NotTracked=2]="NotTracked",e[e.InProgress=3]="InProgress",e[e.Failed=4]="Failed"}(Ce||(Ce={}));var Ie=n("IqkD"),je=n("GdzE"),Pe=n("ml6Y"),xe=n("d4He"),Ee=n("QBtP"),we=n("UGwp"),Te=n("8f6m"),Ae=n("WTtv"),Fe=n("iZ7K"),Ne=n("E5IU");const ke=a.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({id:e}){const t=Object(l.c)(),n=Object(ne.a)(s.K),r=Object(l.d)(e=>Object(de.c)(e,c.l)),i=Object(l.d)(e=>Object(de.c)(e,c.Ed)),o=Object(l.d)(e=>Object(de.c)(e,c.ib)),u=Object($.c)(n,ue.f),d=Object($.c)(n,ue.d),h=a.useContext(Ee.a),g=a.useCallback(async e=>{const n={[Pe.a.IsUserSelectOffline]:e};t(Object(je.a)(Pe.a.IsUserSelectOffline,n,!1)),e?h.DataSource&&h.DataSource.set_IsServerAvailable(!1):await t(Object(le.g)(null,u,d,r)),t(Object(ce.b)(e))},[h.DataSource,t,r,d,u]),p=Object(l.d)(t=>Object(te.Ib)(t,e)),m=Object(l.d)(e=>Object(ae.i)(e)),b=Object(l.d)(e=>Object(ae.l)(e)),f=Object($.c)(n,s.y),y=Object($.c)(n,s.e),C=a.useCallback(n=>{n.preventDefault(),t(Object(ee.e)(e))},[t,e]),v=Object(l.d)(ie.b),S=Object(l.d)(ae.q);let O=Object(l.d)(ae.e);const I=Object(l.d)(_e.e),j=v&&I&&S===he.a.Initializing,P={statusLabel:Object($.c)(n,s.N),statusText:Object(l.d)(ae.t),statusMessage:Object(l.d)(ae.s),helpLabel:Object($.c)(n,s.E),helpLinkLabel:Object($.c)(n,s.G),helpLinkAccessibilityLabel:Object($.c)(n,s.F),helpLinkHandler:()=>t(Object(xe.a)("https://go.microsoft.com/fwlink/?linkid=2103926"))},x=Object(l.d)(ae.q),E={toggleSwitchOn:Object(l.d)(ae.v),isDisabledToggleOption:x!==he.a.Available,labelToggleOption:Object($.c)(n,s.O),onChangeToggleOption:g,accessibilityOnLabel:Object($.c)(n,s.b),accessibilityOffLabel:Object($.c)(n,s.a)},w=Object(l.d)(se.c),T=Object(l.d)(ae.a);a.useEffect(()=>{T&&t(Object(we.a)())},[T,t]);const A=a.useCallback(()=>{t(Object(oe.h)())},[t]),F=a.useCallback(()=>{t(Object(Ae.initializeOfflineLifecycleAsyncAction)(!0))},[t]),N={downloadOfflineMetadataButtonLabel:Object($.c)(n,s.l),isMetadataDownloadRequired:v&&be.a.SyncPendingFromServer===w,downloadOfflineMetadataHandler:A},k=a.useCallback(()=>{t({type:"offline.cancel.sync",execute({dispatch:e,getState:t},n){const a=n.OfflineProvider,r=n.TraceManager.getTracer(oe.f),i=[];return a.cancelSync().nativePromise().then(()=>{const a=t(),o=Object(ae.i)(a),s=Object(ae.l)(a);if(i.push({name:fe.b.IsForcedSync,value:o}),o||s)r.warn("OfflineCancelSyncAction.cancelSync: Successfully canceled forced sync",i),e(Object(ye.e)(!1));else{const t=he.a.NotAvailable;e(Object(ge.c)(t,me.a.None)),i.push({name:fe.b.OfflineStatus,value:t});const a=!1,r=be.a.SyncPendingFromServer;e(Object(oe.i)({syncStatus:r,metadataAvailable:a})),Object(oe.j)(n,oe.c,a),i.push({name:oe.c,value:a}),Object(oe.j)(n,oe.d,r),i.push({name:oe.d,value:r})}r.warn("OfflineCancelSyncAction.cancelSync: Successfully",i)}).catch(e=>(i.push({name:fe.b.ErrorMessage,value:Object(pe.e)(e)}),r.error("OfflineCancelSyncAction.cancelSync: Failure.",i),Promise.reject(e)))}})},[t]),M={labelProgress:Object($.c)(n,s.M),labelCancelButton:Object($.c)(n,s.L),progressSpinnerLabel:Object($.c)(n,s.m),onClickCancelDownloadButton:k,showSpinner:!m},D={notAvailableLabel:Object($.c)(n,"L_Offline_Not_Available"),downloadErrorLabel:Object($.c)(n,s.z),estimatedTimeLeftLabel:Object($.c)(n,s.r),lastSyncDateTodayLabel:Object($.c)(n,s.C),lastSyncDateYesterdayLabel:Object($.c)(n,s.D),lastSyncDateAtLabel:Object($.c)(n,s.A)},R={networkConnectivityErrorTitle:Object($.c)(n,s.j),insufficientStorageErrorTitle:Object($.c)(n,s.i),serviceErrorErrorTitle:Object($.c)(n,s.k),networkConnectivityErrorMessage:Object($.c)(n,s.g),insufficientStorageErrorMessage:Object($.c)(n,s.f),serviceErrorErrorMessage:Object($.c)(n,s.h)},L={downloading:Object($.c)(n,s.v),pending:Object($.c)(n,s.n),waiting:Object($.c)(n,s.p),completed:Object($.c)(n,s.u),error:Object($.c)(n,s.w),suspended:Object($.c)(n,s.o)},B=Object(l.d)(re.g),V=Object(l.d)(re.i),G=Object(l.d)(Ie.w),z=Object(ve.d)(G),{availableEntitiesListData:W,notAvailableEntitiesListData:X}=Oe(B,V,D,z),H={entity:Object($.c)(n,s.q),lastSyncValue:Object($.c)(n,s.B)},U={entity:Object($.c)(n,s.q),progress:Object($.c)(n,s.J),status:Object($.c)(n,s.N)},q={icon:_.a.SetDefault,isCollapsedDefault:!0,listNameTemplate:Object($.c)(n,s.d),buttonAriaLabel:Object($.c)(n,s.c),data:W,headerLabels:H,isForcedSyncInProgress:m},K={icon:_.a.MarkAsLost,isCollapsedDefault:!0,listNameTemplate:Object($.c)(n,s.I),buttonAriaLabel:Object($.c)(n,s.H),data:X,headerLabels:H,isForcedSyncInProgress:m},Q=Object(Te.h)(O),Z=Object(l.d)(e=>Object(Fe.t)(e,Q));O.totalProgress!==Te.d&&(O=Object(Te.i)(O,Z));const J={downloadedFileCount:Object($.c)(n,s.t),availableFileCount:Object($.c)(n,s.s)},Ce={isFileDownloadProgressVisible:!!O&&O.totalProgress!==Te.d,isCollapsedDefault:!0,listHeaderLabels:J,data:O,headerLabels:U,statusLabels:L,errorLabels:R,closeButtonLabel:y},Se=!Object(l.d)(Ne.o);return a.createElement(Y,{title:f,closeButtonLabel:y,closeHandler:C,isMainFormDialog:p,isProgressVisible:j,isOfflineFileDownloadFeatureEnabled:i,isForceSyncOfflineDataFeatureEnabled:o,offlineStatusDescriptionProps:P,offlineStatusAvailableEntitiesListProps:q,offlineStatusNotAvailableEntitiesListProps:K,offlineStatusToggleOptionProps:E,offlineStatusDownloadProgressProps:M,downloadOfflineMetadataButtonProps:N,offlineStatusFileDownloadStatusListProps:Ce,forcedOfflineDataUpdateHandler:F,isForcedSyncInProgress:m,isFirstSyncCompleted:b,updateOfflineDataButtonLabel:Object($.c)(n,s.x),isOfflineStatusToggleVisible:Se})}));var Me=n("E+3N"),De=n("wul+"),Re=n("0kGT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Le=a.createContext({scroll:void 0,onScroll:void 0,scrollEnd:void 0,onScrollEnd:void 0,nativeHeaderHeight:0,setNativeHeaderHeight:void 0});function Be(e,t=8){let n=-1;return function(...a){-1===n&&(n=setTimeout(()=>{n=-1,e.apply(this,a)},t))}}function Ve(e){const{scroll:t,scrollEnd:n}=a.useContext(Le);a.useEffect(()=>{const a=document.getElementById(e);if(!a)return;const r=()=>Math.max(0,a.scrollTop),[i,o]=function(e,t=100){let n=-1;const a=()=>clearTimeout(n);return[()=>{a(),n=setTimeout(e,t)},a]}(()=>n(r()));let s=0,c=!1;const l=Be(()=>{c=!0,o(),s=r()}),u=Be(()=>{c=!1,i(),t(r(),0,0)}),d=Be(()=>{const e=r();t(e,s,s-e),!c&&i()});a.addEventListener("touchstart",l),a.addEventListener("touchend",u),a.addEventListener("touchcancel",u),a.addEventListener("scroll",d);return t(0,0,0),()=>{a.removeEventListener("touchstart",l),a.removeEventListener("touchend",u),a.removeEventListener("touchcancel",u),a.removeEventListener("scroll",d),o()}},[e,t,n])}function Ge({id:e}){return Object(l.d)(Re.b)?a.createElement(ze,{id:e}):null}function ze({id:e}){Ve(e);const{nativeHeaderHeight:t}=a.useContext(Le);return a.createElement(u.a,{style:{paddingHorizontal:0,paddingBottom:0}},a.createElement(r.a,{style:{width:"100%",height:t}}))}var We=n("7qYC"),Xe=n("tlts"),He=n("H4dV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Ue(e){return e[qe()]}function qe(){return"web"===Xe.a.OS&&He.a.getInstance().get_IsAndroid()?"android":"web"===Xe.a.OS&&He.a.getInstance().get_IsIOS()||"web"===Xe.a.OS?"ios":Xe.a.OS}var Ye=n("rwix");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ke({children:e,top:t,left:n,onPress:o,shouldRenderTooltip:s,text:c}){return s?a.createElement(r.a,{style:Qe.wrapperView},a.createElement(r.a,{style:Qe.childrenBorder},e),a.createElement(Ye.a,null,a.createElement(We.a,{onPress:o},a.createElement(r.a,{style:[Qe.tooltipWrapper,{top:t,left:n}]},a.createElement(r.a,{style:Qe.triangle}),a.createElement(r.a,{style:Qe.tooltipBox},a.createElement(i.a,{style:Qe.text},c)))))):e}const Qe=h.a.create({wrapperView:{position:"relative"},childrenBorder:Object.assign({},Ue({ios:{borderColor:"#222222",borderRadius:8,borderWidth:1}})),triangle:Object.assign({width:0,height:0,borderColor:"transparent",borderBottomColor:"#222222",borderBottomWidth:7,borderLeftWidth:7,borderRightWidth:7,marginLeft:13},Ue({android:{display:"none"}})),tooltipBox:Object.assign({padding:13},Ue({ios:{backgroundColor:"#222222",borderRadius:8,shadowColor:"rgba(0, 0, 0, 0.24)",shadowOffset:{height:2,width:0},shadowRadius:4},android:{backgroundColor:"rgba(97, 97, 97, 0.9)",borderRadius:2,textAlign:"center"}})),text:{color:"#FFF",fontSize:15},tooltipWrapper:Object.assign({position:"absolute"},Ue({ios:{width:250},android:{width:200}}))});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ze(e){const t=a.useContext(hr);return a.createElement(x.a,{accessibilityLabel:e.label,"aria-haspopup":e.accessibilityHaspopup,accessibilityRole:"button","data-id":e.id,testID:e.label,style:Object.assign(Object.assign({},e.style),{width:44,height:44,padding:12}),onPress:e.onPress,onLongPress:e.onLongPress},a.createElement(C.a,{icon:e.icon,size:20,color:t.headerIconColor,flipInRtl:e.flipInRtl}))}function Je({openSearchPage:e}){const t=a.useContext(gr).searchLabel;return a.createElement(Ze,{onPress:e,style:{alignSelf:"flex-end",marginRight:"4px"},icon:_.a.SearchButton,label:t})}function $e({openCreateMenu:e}){const t=a.useContext(gr).quickCreateMenuLabel;return a.createElement(Ze,{onPress:e,icon:_.a.New,label:t})}function et({openGlobalCommandsFlyout:e}){const t=a.useContext(gr).moreCommands;return a.createElement(Ze,{onPress:e,icon:_.a.MoreVertical,label:t})}function tt({toggleSiteMap:e,sitemapButtonLabel:t}){return a.createElement(Ze,{onPress:e,icon:_.a.Details,id:"navbutton",label:t,accessibilityHaspopup:!0})}function nt({navigateBack:e,navigateBackToRoot:t,backButtonTooltip:n}){const r=a.useContext(gr).backLabel,i="android"===qe();return a.createElement(Ke,{text:n.text,onPress:n.onPress,shouldRenderTooltip:n.shouldRenderTooltip,top:i?6:45,left:i?59:6.7},a.createElement(Ze,{onPress:e,onLongPress:t,icon:_.a.LeftArrowHead,label:r,flipInRtl:!0}))}var at=n("arV0"),rt=n("NPmm");function it(e){return"NavigationBar.PageHeader"+e}var ot=n("yzZr"),st=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ct=["dashboard","entitylist","entityrecord"],lt=["dashboard","entityrecord","entitylist"],ut={isDirty:!1},dt=a.createContext(ut);function ht({pageId:e,baseContext:t,children:n}){const r=Object(rt.c)(e),i=Object(rt.b)(e),o=a.useMemo(()=>Object.assign(Object.assign(Object.assign({},t),r),{additionalSaveActions:i}),[i,t,r]);return a.createElement(dt.Provider,{value:o},n)}const gt=[ot.W];function pt({baseContext:e,children:t}){const n=Object(ne.a)(gt),r=a.useMemo(()=>Object.assign(Object.assign({},e),{title:n[ot.W],pageDirty:!1}),[e,n]);return a.createElement(dt.Provider,{value:r},t)}function mt({baseContext:e,children:t}){const n=a.useMemo(()=>Object.assign(Object.assign({},e),{headerType:2}),[e]);return a.createElement(dt.Provider,{value:n},t)}function bt({pageId:e,children:t}){const n=Object(l.d)(t=>Object(at.k)(t,{id:e})),r=Object(l.d)(t=>Object(at.b)(t,e)),i=n?-1!==ct.indexOf(n)&&it(e):"placeholder",o=-1!==lt.indexOf(n),s=a.useMemo(()=>Object.assign(Object.assign({},ut),{pageContentId:i,headerType:o?0:1,pageType:n}),[i,o,n]);let u=!1;return Object(l.d)(e=>Object(de.c)(e,c.tc)&&Object(de.c)(e,c.D))&&r===st.p||(u="entitylist"===n),null===n||u?a.createElement(mt,{baseContext:s},t):"entityrecord"===n?a.createElement(ht,{baseContext:s,pageId:e},t):"search"===n?a.createElement(pt,{baseContext:s},t):a.createElement(dt.Provider,{value:s},t)}var ft=n("4fxQ"),yt=n("v7n7"),Ct=n.n(yt);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _t(e){e.preventDefault()}function vt(e){return a.createElement(r.a,Object.assign({},e,{onTouchStart:_t,onTouchMove:_t,onTouchCancel:_t}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function St({top:e,onClose:t,children:n}){const i=d.a.get("window"),o=.6*i.height,s=i.height,c=i.width,l="android"===qe(),[u,h]=a.useState(!0),[g]=a.useState(new P.a.Value(0));a.useEffect(()=>P.a.timing(g,{toValue:.4,duration:100}).start(),[g]);const p=a.useCallback(()=>{P.a.timing(g,{toValue:0,duration:100}).start(),h(!1)},[g]),m=a.useCallback(t=>{const n=ft.findDOMNode(t);if(n){const t=n.parentElement.parentElement;t.style.clip=`rect(${e}px, auto, auto, auto)`,t.style.zIndex="1"}},[e]);return a.createElement(a.Fragment,null,a.createElement(P.a.View,{style:[It.fullscreen,It.backdrop,{width:c,height:s,opacity:g},!l&&{top:e}]}),a.createElement(Ye.a,null,a.createElement(vt,{key:"backdrop",style:[It.fullscreen,{width:c,height:s}]}),a.createElement(We.a,{onPress:p},a.createElement(r.a,{style:[It.fullscreen,{width:c,height:s}]}))),a.createElement(Ct.a,{key:"flyout",onModalHide:t,animationIn:l?"slideInUp":"slideInDown",animationInTiming:300,animationOut:l?"slideOutDown":"slideOutUp",swipeThreshold:80,swipeDirection:"up",onSwipe:p,isVisible:u,backdropColor:"rgba(0,0,0,0)",onBackdropPress:p,style:[It.root,!l&&{marginTop:e}]},l&&a.createElement(r.a,{key:"drag",style:It.drawerHead}),n(o),!l&&a.createElement(r.a,{ref:m,key:"drag",style:It.drawerHead},a.createElement(r.a,{style:It.draggableWidget}))))}function Ot(){const[e,t]=a.useState(null),[n,r]=a.useState(0);return{anchorPoint:n,updateAnchorPoint:a.useCallback(()=>{if(e){const t=ft.findDOMNode(e);if(t){const{bottom:e}=t.getBoundingClientRect();r(e)}}},[e]),setAnchorPoint:t}}const It=h.a.create({fullscreen:{position:"fixed",top:0,left:0},backdrop:{backgroundColor:"black",opacity:.4},root:Object.assign({width:"100%",height:"auto",margin:0,display:"flex",flexDirection:"column"},Ue({ios:{justifyContent:"flex-start"},android:{justifyContent:"flex-end"}})),drawerHead:Object.assign(Object.assign({},Ue({ios:{borderBottomLeftRadius:14,borderBottomRightRadius:14},android:{borderTopLeftRadius:14,borderTopRightRadius:14}})),{height:20,backgroundColor:"white",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.0516)",display:"flex",flexDirection:"column",alignItems:"center"}),draggableWidget:{marginTop:8,width:36,height:4,backgroundColor:"#D2D0CE",borderRadius:2}});var jt=n("Fw7Z"),Pt=n("F/sP"),xt=n("pF61"),Et=n("mpSO"),wt=n("HKBt"),Tt=n("GAI+"),At=n("6hHv"),Ft=n("16wZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Nt(e){return e.CommandType===Tt.b||e.CommandType===Tt.c}function kt(e){return e&&e.IsInjectedCommand&&(!Object(Ft.a)(e.Execute)||!Object(Ft.a)(e.ExecuteInjectedPopulationQueryCommand))}function Mt(e){if(!e)return!1;const t=Nt(e);return!t&&!!e.Command||t&&!!e.PopulateQueryCommand}function Dt(e,t){let n=Tt.a,a=[];return e.Children&&e.Children.length>0&&(n=e.execute?Tt.c:Tt.b,a=e.Children.map(e=>Dt(e,t))),{Id:e.Id,IsInjectedCommand:!0,CommandType:n,CommandManagerId:t,Command:e.Id,DataId:e.DataId,LabelText:e.DisplayText,Icon:e.Icon,Tooltip:e.Tooltip,Children:a,Execute:e.execute,ExecuteInjectedPopulationQueryCommand:e.executeInjectedPopulationQueryCommand,IsGlobalCommand:t===Et.d}}function Rt(e,t,n=!1,a){const r=[];if(!n){if(e.ControlType===Tt.c||e.ControlType===Tt.b){const n=e.Menu;n&&n.MenuSection.forEach(e=>{var n,a;null===(a=null===(n=null==e?void 0:e.Item)||void 0===n?void 0:n.Items)||void 0===a||a.forEach(e=>{r.push(Rt(e,t))})})}e.ControlType===Tt.c&&function(e,t,n){if(n){const a=e.Command.split("|"),r=n.Commands,i=r[a[0]]?r[a[0]][a[a.length-1]].Actions:null;for(let e=0;e<t.length;e++){const n=t[e].Command.split("|");if(Lt(i,r[n[0]]?r[n[0]][n[n.length-1]].Actions:null))return!1}return!0}return void 0===t.find(t=>t.Command===e.Command)}(e,r,a)&&r.unshift(Rt(e,t,!0))}return{Id:e.Id,CommandManagerId:t,CommandType:n?Tt.a:e.ControlType,Command:e.Command,LabelText:e.LabelText,IsInjectedCommand:!1,Icon:e.ModernImage,Tooltip:void 0!==e.ToolTipTitle?e.ToolTipTitle:"",Children:r,PopulateQueryCommand:e.PopulateQueryCommand,CommandingControl:e.ControlType!==Tt.c?e:null,IsGlobalCommand:t===Et.d}}function Lt(e=[],t=[]){if(e.length!==t.length)return!1;e.sort(),t.sort();for(let n=0;n<e.length;n++){if(e[n].ActionType!==t[n].ActionType)return!1;switch(e[n].ActionType){case 3:const a=e[n].Attributes,r=t[n].Attributes;if(Vt(a.Library)!==Vt(r.Library))return!1;if(Bt(a.FunctionName)!==Bt(r.FunctionName))return!1;break;case 1:if(e[n].Attributes!==t[n].Attributes)return!1;break;default:return!1}}return!0}function Bt(e){return e&&e.endsWith("Legacy")?e.substr(0,e.length-6):e}function Vt(e){return e&&e.toLowerCase().startsWith("$webresource:")?e.substr(13):e}var Gt=n("8vWI"),zt=n("YWpA"),Wt=n("XA60"),Xt=n("4PNl");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ht=a.forwardRef((e,t)=>a.createElement(Xt.a,Object.assign({},e,{style:[Yt.scrollView,e.style],contentContainerStyle:[Yt.contentContainerStyle,e.contentContainerStyle],ref:t}),a.createElement(u.a,{style:Yt.content},e.children),!e.disableShortContentBounce&&a.createElement(r.a,{style:Yt.scrollViewBouncingHelper})));function Ut(e){return a.createElement(Ht,Object.assign({},e))}function qt(e){return a.createElement(Ht,Object.assign({disableShortContentBounce:!0},e))}const Yt=h.a.create({scrollView:{flex:1},contentContainerStyle:{flexGrow:1,flexShrink:0},content:{flexGrow:1,flexShrink:0,paddingTop:0},scrollViewBouncingHelper:{flex:0,height:1,marginBottom:-1}});var Kt=n("0YTt"),Qt=n.p+"resources/images/AndroidBack.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Zt({id:e,displayText:t,flyoutCommand:n,visible:i,setCommandBarStatus:o,setFlyoutCommand:s,modalStyles:c,headerComponent:l,isCommandDrawer:u,flyoutOptions:d,webResourcePath:h,executeCommand:g}){const[p,m]=a.useState([]),b=p&&0===p.length,f=b?n:p[p.length-1],y=u?cn.drawerModalContainer:cn.flyoutModalContainer;let C={};u&&(C={swipeThreshold:100,swipeDirection:"down",onSwipe:Jt(m,o)});const _=u?"CommandDrawer":"CommandFlyout";return a.createElement(Ct.a,Object.assign({key:e,isVisible:i,backdropOpacity:.3,onBackdropPress:Jt(m,o)},u?C:Kt.a,{style:c||cn.flyoutModal}),a.createElement(zt.a,{id:_},a.createElement(r.a,{style:y},u&&a.createElement(nn,{isHeaderRendered:!!l}),l||!u&&a.createElement(tn,{showBackButton:!b,label:t||f&&f.LabelText,onBackButtonClick:rn(p,m)}),a.createElement($t,{id:e,commandStack:p,currentCommand:f,setFlyoutCommand:s,setCommandStack:m,setCommandBarStatus:o,isCommandDrawer:u,flyoutOptions:d,webResourcePath:h,executeCommand:g}))),a.createElement(G.a,{key:"CommandAccessibilityComponent",rootElementId:_,shouldManageFocus:!0,isModal:!0}))}function Jt(e,t){return()=>{t(An.none)}}function $t({id:e,commandStack:t,currentCommand:n,setFlyoutCommand:i,setCommandStack:o,setCommandBarStatus:s,isCommandDrawer:c,flyoutOptions:l,webResourcePath:u,executeCommand:h}){const g=a.useContext(ta).loading;if(!n)return null;const[p,m]=c?[n.Children,!1]:l(n),b={maxHeight:.6*d.a.get("window").height};return m?a.createElement(r.a,{style:b},a.createElement(an,{text:g})):a.createElement(r.a,{style:c?[cn.drawerContent,b]:b},a.createElement(en,{isCommandDrawer:c,commandStack:t,setCommandStack:o,setFlyoutCommand:i,setCommandBarStatus:s,data:p,webResourcePath:u,executeCommand:h}))}function en({isCommandDrawer:e,commandStack:t,setCommandStack:n,setFlyoutCommand:i,setCommandBarStatus:o,data:s,webResourcePath:c,executeCommand:l}){const u=a.useContext(ta).noOptionsAvailable,d=[];return s.length>0&&d.push({title:null,data:[...s]}),a.createElement(Gt.a,Object.assign({accessibilityRole:"menu",accessibilityLabel:Wt.a,stickySectionHeadersEnabled:!1,ListEmptyComponent:()=>a.createElement(an,{text:u})},e&&{renderScrollComponent:qt},{renderItem:({item:r})=>a.createElement(ia,{key:r.Id,id:r.Id,commandControl:r,displayText:r.LabelText,isFlyoutCommand:Nt(r),icon:r.Icon,isRegularCommand:!0,webResourcePath:c,commandClickHandler:Nt(r)?on(r,e,t,n,o,i):Jt(0,o),executeCommand:l,accessibilityLabel:r.Tooltip,accessibilityRole:"menuitem"}),sections:d,keyExtractor:(e,t)=>`${e.id} | ${e.command} | ${t}`,ItemSeparatorComponent:()=>a.createElement(r.a,{style:cn.separator})}))}function tn({showBackButton:e,label:t,onBackButtonClick:n}){const o="android"===qe();let s=null,c=null;const l=a.useContext(ta).back;return e&&(s=a.createElement(x.a,{onPress:n,accessibilityLabel:l,accessibilityRole:"button"},a.createElement(r.a,{style:cn.flyoutHeaderBackButtonContainer},o?a.createElement(C.a,{icon:Qt,size:16,color:"#605E5C",type:1}):a.createElement(C.a,{icon:_.a.LeftChevron,size:20,color:"#2266E3",type:0}))),c=!o&&a.createElement(x.a,{disabled:!0},a.createElement(r.a,{style:cn.flyoutHeaderBackButtonContainer},a.createElement(C.a,{icon:_.a.LeftChevron,size:20,color:"transparent",type:0})))),a.createElement(r.a,{style:cn.flyoutHeaderContainer},s,a.createElement(i.a,{style:s?ln.flyoutHeaderTextWithBackButton:cn.flyoutHeaderText},t),c)}function nn({isHeaderRendered:e}){return a.createElement(r.a,{style:e?sn.handleBarContainer:sn.handleBarContainerWithoutHeader},a.createElement(r.a,{style:sn.handleBar}))}function an({text:e}){return a.createElement(ia,{id:"PlaceHolderCommand_"+e,commandControl:null,displayText:e,isFlyoutCommand:!1,icon:null,isRegularCommand:!0,commandClickHandler:null,disabled:!0,executeCommand:null,accessibilityLabel:e,accessibilityRole:"button"})}function rn(e,t){return()=>{const n=[...e];n.pop(),t(n)}}function on(e,t,n,a,r,i){return()=>{t?(i(e),r(An.flyoutOpened)):a([...n,e])}}const sn=h.a.create({handleBar:Object.assign({width:36,height:4,borderRadius:2,marginTop:8},Ue({ios:{backgroundColor:"#D2D0CE"},android:{backgroundColor:"transparent"}})),handleBarContainer:{alignItems:"center",backgroundColor:"#F3F2F1",height:20,borderTopLeftRadius:14,borderTopRightRadius:14},handleBarContainerWithoutHeader:Object.assign({alignItems:"center"},Ue({android:{backgroundColor:"#FFFFFF",height:15,borderTopLeftRadius:8,borderTopRightRadius:8},ios:{backgroundColor:"#FFFFFF",height:20,borderTopLeftRadius:14,borderTopRightRadius:14}}))}),cn=h.a.create({flyoutModal:Object.assign({},Ue({android:{margin:0,padding:64}})),flyoutModalContainer:Object.assign({},Ue({ios:{borderRadius:14,backgroundColor:"#ffffff"},android:{borderRadius:2,backgroundColor:"#FAFAFA",paddingBottom:12,shadowOffset:{width:0,height:11},shadowColor:"#000000",shadowOpacity:.2,shadowRadius:15}})),drawerModalContainer:{borderTopLeftRadius:14,borderTopRightRadius:14,backgroundColor:"#ffffff"},flyoutHeaderContainer:Object.assign({display:"flex",flexDirection:"row",justifyContent:"space-between"},Ue({ios:{height:44,borderBottomColor:"#C8C8C8",borderBottomWidth:jt.a,alignItems:"center"}})),flyoutHeaderBackButtonContainer:Object.assign({width:50,alignItems:"center"},Ue({ios:{height:50,justifyContent:"center"},android:{height:"100%",paddingTop:28}})),flyoutHeaderText:Object.assign({},Ue({ios:{fontSize:17,lineHeight:22,flex:1,textAlign:"center",alignSelf:"center"},android:{fontSize:20,lineHeight:22,flex:1,textAlign:"left",alignSelf:"center",fontWeight:"500",margin:24,marginBottom:12}})),drawerContent:{minHeight:88},separator:Object.assign({},Ue({ios:{height:jt.a,backgroundColor:"#C8C8C8",marginLeft:62}}))}),ln=h.a.create({flyoutHeaderTextWithBackButton:h.a.flatten([cn.flyoutHeaderText,Ue({android:{marginLeft:4}})])});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function un({headerCommandControls:e,overflowListCommandControls:t,commandBarStatus:n,setCommandBarStatus:r,setFlyoutCommand:i,flyoutOptions:o,webResourcePath:s,executeCommand:c}){const l=e&&e.length&&a.createElement(dn,{commands:e,setCommandBarStatus:r,setFlyoutCommand:i,webResourcePath:s,executeCommand:c});return a.createElement(Zt,{id:"CommandDrawer",flyoutCommand:{Children:t},visible:n===An.drawerExpanded,setCommandBarStatus:r,setFlyoutCommand:i,isCommandDrawer:!0,headerComponent:l,modalStyles:gn.commandDrawerModal,flyoutOptions:o,webResourcePath:s,executeCommand:c})}function dn({commands:e,setCommandBarStatus:t,setFlyoutCommand:n,webResourcePath:i,executeCommand:o}){return a.createElement(r.a,{style:gn.globalCommandBar},a.createElement(Pt.a,{accessibilityRole:"menu",accessibilityLabel:Wt.a,data:e,renderItem:hn(t,n,i,o),horizontal:!0,keyExtractor:e=>e.Id}))}function hn(e,t,n,r){return({item:i})=>{const o=Nt(i);return a.createElement(ia,{key:i.Id,id:i.Id,commandControl:i,displayText:i.LabelText,icon:i.Icon,isFlyoutCommand:o,isRegularCommand:!1,webResourcePath:n,commandClickHandler:o?Dn(e,t,i):()=>e(An.none),executeCommand:r,accessibilityLabel:i.Tooltip,accessibilityRole:"menuitem"})}}const gn=h.a.create({commandDrawerModal:{justifyContent:"flex-end",margin:0},globalCommandBar:{justifyContent:"space-around",alignItems:"flex-start",backgroundColor:"#F3F2F1",borderBottomColor:"#C8C8C8",borderBottomWidth:jt.a,paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function pn(e,t,n){const[r,i]=a.useState(n);return a.useEffect(()=>{const a=e.addListener(({value:e})=>i(t(e)));return i(n),()=>e.removeListener(a)},[e,n,t]),r}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function mn(){return"android"===qe()}function bn(){return"android"===qe()}var fn=n("ucY0"),yn=n("Js03"),Cn=n.p+"resources/images/AndroidActions.svg?v=1.4.9962-v91onpremise",_n=n("Afz2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vn={get sliderSize(){return d.a.get("window").width-30},get endPosition(){return 0},get startPosition(){return(fn.a.isRTL?-1:1)*(d.a.get("window").width-30-58)},get sliderCenter(){return d.a.get("window").width/2}};function Sn(e,t){return P.a.spring(e,{toValue:t}).start()}function On({children:e}){const t=a.useRef(new P.a.Value(vn.startPosition)).current,n=a.useRef(function(e){const t=(t,n)=>{e.flattenOffset();const a=t.nativeEvent.pageX,r=Math.abs(n.vx)>1,i=n.vx<0,o=r?i:a<vn.sliderCenter;(fn.a.isRTL?!o:o)?Sn(e,vn.endPosition):Sn(e,vn.startPosition)};return yn.a.create({onStartShouldSetPanResponder:()=>!0,onMoveShouldSetPanResponder:()=>!0,onPanResponderTerminationRequest:()=>!0,onPanResponderGrant:()=>{e.setOffset(e._value),e.setValue(0)},onPanResponderMove:P.a.event([null,{dx:e}]),onPanResponderRelease:t,onPanResponderTerminate:t})}(t)).current;return a.createElement(r.a,{style:[xn.sliderContainer,{width:vn.sliderSize}],pointerEvents:"box-none"},a.createElement(P.a.View,Object.assign({pointerEvents:"auto"},n.panHandlers,{style:(xn.floatingButtonContainer,[{width:58,transform:[{translateX:t}]}])}),e))}function In({onClick:e,paddingBottom:t,accessibilityLabel:n}){return a.createElement(r.a,{style:[xn.positionView,{height:d.a.get("window").height,width:d.a.get("window").width,paddingBottom:t}],pointerEvents:"box-none"},a.createElement(On,null,a.createElement(x.a,{onPress:e,style:xn.buttonContainer,accessibilityLabel:n,accessibilityRole:_n.d,testID:"floating-command-button"},a.createElement(C.a,{icon:Cn,type:1,color:"#FFF",size:24}))))}function jn({onClick:e}){const{actions:t}=a.useContext(ta);return a.createElement(De.a,{name:"floating-commanding-slot"},a.createElement(In,{onClick:e,accessibilityLabel:t}))}function Pn({paddingBottom:e}){return a.createElement(De.c,{name:"floating-commanding-slot",fillChildProps:{paddingBottom:e}})}const xn=h.a.create({sliderContainer:{width:"100%",marginBottom:11.25},floatingButtonContainer:{width:58},positionView:{justifyContent:"flex-end",alignItems:"center",position:"absolute"},buttonContainer:{alignItems:"center",width:58,height:58,justifyContent:"center",backgroundColor:"#002050",borderRadius:48,shadowColor:"#000",shadowOpacity:.25,shadowOffset:{height:1,width:0},shadowRadius:4}});var En=n("eagp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class wn{constructor(e){this._dispatch=e}registerFlyout(e,t){this._dispatch(Object(En.d)(e,t))}unregisterFlyout(e){this._dispatch(Object(En.c)(e))}}const Tn=a.createContext({});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var An;!function(e){e[e.none=0]="none",e[e.flyoutOpened=1]="flyoutOpened",e[e.drawerExpanded=2]="drawerExpanded"}(An||(An={}));const Fn=a.memo((function({commandManagerInitialized:e,globalCommands:t,pageLevelCommands:n,flyoutOptions:r,executeCommand:i,webResourcePath:o,hideCommandBar:s,setCommandShelfRendered:c}){const[l,u]=a.useState(),[d,h]=a.useState(An.none),[g,p,m]=function(e,t){return a.useMemo(()=>function(e,t){if(e=e||[],bn())return[[],e,[]];t=t||[];const n=[],a=e.length,r=[...e,...t];if(r.length<=4)return[r,[],[]];if(n.push(...r.slice(0,3)),a<=3)return[n,t.slice(3-a),[]];return[n,e.slice(3),t]}(e,t),[e,t])}(n,t),b=a.useCallback(()=>h(An.drawerExpanded),[]),f=mn();return a.createElement(a.Fragment,null,f?e&&!s&&n&&n.length>0&&a.createElement(jn,{onClick:b}):a.createElement(kn,{setCommandShelfRendered:c,primaryCommandControls:g,executeCommand:i,setFlyoutCommand:u,commandBarStatus:d,setCommandBarStatus:h,webResourcePath:o,hideCommandBar:s,commandManagerInitialized:e,showMoreButton:!(!p||!p.length)}),a.createElement(Nn,{flyoutCommandId:"native-command-bar",flyoutCommand:l,setFlyoutCommand:u,commandBarStatus:d,setCommandBarStatus:h,flyoutOptions:r,headerCommandControls:m,overflowListCommandControls:p,webResourcePath:o,executeCommand:i}))}));const Nn=a.memo((function({flyoutCommandId:e,flyoutCommand:t,setFlyoutCommand:n,commandBarStatus:r,setCommandBarStatus:i,flyoutOptions:o,headerCommandControls:s,overflowListCommandControls:c,webResourcePath:l,executeCommand:u}){const d=a.useContext(Tn).NativeFlyoutManager,h=a.useCallback(()=>i(An.none),[i]);return a.useEffect(()=>(r===An.none?d.unregisterFlyout(e):d.registerFlyout(e,h),()=>d.unregisterFlyout(e)),[h,r,e,d]),a.createElement(a.Fragment,null,a.createElement(Zt,{id:"CommandFlyout",key:Zt+(t&&t.Id),flyoutCommand:t,visible:r===An.flyoutOpened,setCommandBarStatus:i,setFlyoutCommand:n,flyoutOptions:o,webResourcePath:l,executeCommand:u}),a.createElement(un,{headerCommandControls:s,overflowListCommandControls:c,commandBarStatus:r,setCommandBarStatus:i,setFlyoutCommand:n,flyoutOptions:o,webResourcePath:l,executeCommand:u}))}));function kn({primaryCommandControls:e,executeCommand:t,setFlyoutCommand:n,commandBarStatus:i,setCommandBarStatus:o,webResourcePath:s,hideCommandBar:c,commandManagerInitialized:l,showMoreButton:d,setCommandShelfRendered:h}){const[g,p]=a.useState(),{isCollapsed:m,animatedHeight:b,translation:f}=function(e,t){const[n]=a.useState(new P.a.Value(0)),r=n.interpolate({inputRange:[0,1],outputRange:["0%","101%"]}),i=a.useMemo(()=>new P.a.Value(t),[t]),o=a.useCallback(e=>1===e,[]),s=pn(n,o,e),c=a.useCallback(()=>{P.a.timing(n,{toValue:1}).start(),P.a.timing(i,{toValue:0}).start()},[n,i]),l=a.useCallback(()=>{P.a.timing(n,{toValue:0}).start(),P.a.timing(i,{toValue:t}).start()},[n,i,t]);return a.useEffect(()=>{e&&!s?c():!e&&s&&l()},[e,s,c,l]),{isCollapsed:s,animatedHeight:i,translation:r}}(c,g);return a.useEffect(()=>(h(l||!m),()=>h(!1)),[l,m,h]),l?a.createElement(P.a.View,{accessibilityLabel:Wt.a,accessibilityRole:"menubar",onLayout:e=>{const{height:t}=e.nativeEvent.layout;!g&&t>0&&p(t)},style:{height:b,transform:[{translateY:f}]}},a.createElement(Mn,{primaryCommandControls:e,executeCommand:t,setFlyoutCommand:n,commandBarStatus:i,setCommandBarStatus:o,webResourcePath:s,isCollapsed:m,showMoreButton:d})):m?null:a.createElement(u.a,{style:Rn.commandBar},a.createElement(r.a,{style:Rn.commandBarContent}))}function Mn({primaryCommandControls:e,executeCommand:t,setFlyoutCommand:n,setCommandBarStatus:i,webResourcePath:o,isCollapsed:s,showMoreButton:c}){const{more:l,moreCommands:d}=a.useContext(ta);return!s&&a.createElement(u.a,{key:"ReactNativeCommandBar",style:Rn.commandBar},a.createElement(r.a,{style:Rn.commandBarContent},e.map(e=>{const r=Nt(e);return a.createElement(ia,{key:e.Id,id:e.Id,commandControl:e,displayText:e.LabelText,icon:e.Icon,isFlyoutCommand:r,isRegularCommand:!1,webResourcePath:o,commandClickHandler:r&&Dn(i,n,e),executeCommand:t,accessibilityLabel:e.Tooltip,accessibilityRole:"menuitem"})}),c&&a.createElement(ia,{key:"more_commands_id",id:"more_commands_id",commandControl:null,displayText:l,icon:"More",isFlyoutCommand:!1,isRegularCommand:!1,webResourcePath:o,commandClickHandler:()=>i(An.drawerExpanded),executeCommand:null,accessibilityLabel:d,accessibilityRole:"menuitem"})))}function Dn(e,t,n){return()=>{t(n),e(An.flyoutOpened)}}const Rn=h.a.create({commandBar:{borderTopColor:"#C8C8C8",borderTopWidth:jt.a,backgroundColor:"#F3F2F1",paddingTop:0},commandBarContent:{height:86,flexDirection:"row"}});var Ln=n("NjDY"),Bn=n("W1zc"),Vn=n("RD1j"),Gn=n("ILmX"),zn=n("wgH2");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Wn(e){const t=Object(l.c)(),n=Object(l.d)(xt.c),r=e.CommandManagerId,i=Object(l.d)(t=>Object(Vn.a)(t,r,e.Id)),[o,s]=function(e,t){const n=a.useMemo(()=>function(e,t){if(e&&(e.ExecuteInjectedPopulationQueryCommand||e.PopulateQueryCommand)){const n=[];return e.CommandType===Tt.c&&n.push(e.Children[0]),t&&t.MenuSection.forEach(t=>{var a,r;null===(r=null===(a=null==t?void 0:t.Item)||void 0===a?void 0:a.Items)||void 0===r||r.forEach(t=>{n.push(Rt(t,e.CommandManagerId))})}),n}return e.Children||[]}(e,t),[e,t]),r=a.useMemo(()=>function(e,t){let n;return e&&t&&t.length>0&&(n=t?t.filter(t=>t.Id!==e.Id&&!!t.CommandingControl).reduce((e,t)=>e.concat(t.CommandingControl),[]):[]),n}(e,n),[e,n]);return[n,r]}(e,i),c=Object(l.d)(e=>Object(zn.c)(e,r)),u=c&&c.SelectedItems&&c.SelectedItems.length>0,d=Object(l.d)(e=>Object(Gn.e)(e,s,n,r,u));return a.useEffect(()=>{s&&s.length>0&&t(function(e,t,n){return Object(At.d)(e,t,n,null)}(s,n,r))},[t,s,n,r]),a.useMemo(()=>[o?o.filter(t=>t.Id===e.Id||t.IsInjectedCommand||d[Object(Gn.i)(t.Id,null==c?void 0:c.ContextEntityLogicalName)]):[],e&&!e.IsInjectedCommand&&0===Object.keys(d||{}).length],[o,e,d,c])}var Xn=n("ZdjS"),Hn=n("UIlN"),Un=n("dHD5"),qn=n("2YQW"),Yn=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Kn(e,t){const n=Object(l.c)();return a.useCallback(a=>{if((r=a)&&kt(r)||Mt(r)){const r=a.IsGlobalCommand?e:t;n(function(e,t){const n=Nt(t);if(kt(t)){const n=t.Execute?t.Execute:t.ExecuteInjectedPopulationQueryCommand,a=t.Id;return e(null,t.DataId?t.DataId:t.Command,a,t.IsInjectedCommand,n)}if(Mt(t)){const a=n?t.PopulateQueryCommand.split("|"):t.Command.split("|"),r=t.Id;if(4===a.length)return e(""===a[0]?"null":a[0],a[3],r)}}(r,a))}var r},[n,e,t])}function Qn(e,t){const n=Object(l.d)(t=>Object(Hn.b)(t,e)),r=null==n?void 0:n.ribbonId,i=Object(l.d)(e=>Object(Gn.j)(e,r)),o=Object(l.d)(e=>Object(xt.c)(e));Object(Yn.b)(t)&&(t=o);const s=null==n?void 0:n.contextToken,c=null==n?void 0:n.ruleContext,u=s?Object(Un.v)(s):null;return{executeCommand:function(e,t,n,r,i){return a.useCallback((a,o,s,c,l)=>Object(Xn.a)(e,r,a,o,s,t,n,i,c,l),[n,i,t,e,r])}(i,t,e,c,u),commands:function(e,t,n,r){const{isOnline:i,pageIsHierarchy:o}=Object(l.d)(e=>({isOnline:Object(ie.b)(e),pageIsHierarchy:Object(Gn.o)(e,t)}),qn.e);return a.useMemo(()=>{var t,a,s,c;if(!r)return[];const l=[],u=null!==(t=r.addedCommandList)&&void 0!==t?t:[];for(const t of u)l.push(Dt(t,e));const d=Object(Gn.a)(n,!1),h=(null!==(s=null===(a=r.ruleContext)||void 0===a?void 0:a.SelectedItems)&&void 0!==s?s:[]).length>0;for(const t of d){const a=t&&Object(Gn.i)(t.Id,Object(zn.a)(null==r?void 0:r.ribbonId));Object(Gn.n)(a,r,h,i,o)&&l.push(Rt(t,e,!1,n))}const g=null!==(c=r.appendedCommandList)&&void 0!==c?c:[];for(const t of g)l.push(Dt(t,e));return l},[e,r,i,o,n])}(e,t,i,n)}}var Zn=n("GT4X"),Jn=n("P6DH"),$n=n("Z/4N"),ea=n("kC0I");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const ta=a.createContext({}),na=a.createContext({IconToSVGMapping:Bn.a});function aa({setCommandShelfRendered:e}){const t=function(){const e=Object(ne.a)(wt.f.concat("MenuItem_Label_Actions")),t=e[wt.c],n=e[wt.d],r=e[wt.a],i=e[wt.e],o=e[wt.b],s=e.MenuItem_Label_Actions;return a.useMemo(()=>({more:t,moreCommands:n,back:r,noOptionsAvailable:i,loading:o,actions:s}),[t,n,r,i,o,s])}();return a.createElement(na.Provider,{value:{IconToSVGMapping:Bn.a}},a.createElement(ta.Provider,{value:t},a.createElement(ra,{setCommandShelfRendered:e})))}function ra({setCommandShelfRendered:e}){const{executeCommand:t,commands:n}=Qn(Et.d),r=Object(l.d)(e=>Object(xt.c)(e)),i=function(e){const t=Object(l.d)(t=>Object(at.k)(t,{id:e})),{isDirty:n}=Object(rt.d)(e);return a=t,["search"].indexOf(a)>=0||function(e){return["create","quickcreate","entity","entityrecord"].indexOf(e)>=0}(t)&&n;var a}(r),o=function(e){const t=Object(l.d)(e=>Object(Zn.a)(e,Et.d)),n=Object(l.d)(t=>Object(Zn.a)(t,e)),r=(c=Object(l.d)(t=>Object(at.k)(t,{id:e})),["entitylist","view"].indexOf(c)>=0),i=Object(l.d)(t=>r&&function(e,t){const n=Object(Jn.ab)(e,st.m),a=Object($n.e)(e,st.m);if(n&&a&&a.Properties.DataSetDefinitions&&a.Properties.DataSetDefinitions[n]&&a.Properties.DataSetDefinitions[n].CDSDataSetOptions){const r=a.Properties.DataSetDefinitions[n].CDSDataSetOptions,i=Un.k(e,t);return r.hasOwnProperty(st.E.COMMANDBAR_ENABLED)?r.displayCommandBar:Object(ea.b)(i,st.E.COMMANDBAR_ENABLED,null)}return!1}(t,e)),[o,s]=a.useState(!1);var c;return a.useEffect(()=>{const e=setTimeout(()=>s(!0),5e3);return()=>clearTimeout(e)},[]),t&&(n||i||o)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(r),{executeCommand:s,commands:c}=Qn(r),u=Kn(t,s),d=Object(l.d)(Ln.t);return c&&c.length>0||n&&n.length>0?a.createElement(Fn,{commandManagerInitialized:o,globalCommands:n,pageLevelCommands:c,flyoutOptions:Wn,executeCommand:u,webResourcePath:d,hideCommandBar:i,setCommandShelfRendered:e}):null}function ia({id:e,commandControl:t,displayText:n,icon:i,isRegularCommand:o,disabled:s,commandClickHandler:c,webResourcePath:l,executeCommand:u,accessibilityLabel:h,accessibilityRole:g}){const p=o?la:ua;return a.createElement(x.a,{testID:"command-button-"+e,key:e,onPress:sa(c,t,u),disabled:s,accessibilityLabel:h,accessibilityRole:g},a.createElement(r.a,{style:[p.commandContainer,{width:.25*d.a.get("window").width}]},a.createElement(oa,{containerStyle:p.commandIconContainer,icon:i,webResourcePath:l}),a.createElement(ca,{styles:p,displayText:n,isRegularCommand:o})))}function oa({containerStyle:e,icon:t,webResourcePath:n,color:i}){const o=i||"#002050";let s=a.createElement(C.a,{icon:_.a.Puzzle,size:20,color:o,type:0});const c=a.useContext(na).IconToSVGMapping;if(t&&-1!==t.indexOf("$webresource:")){const e=Object(Ln.a)(n,t);s=a.createElement(C.a,{icon:e,size:20,color:o,type:1})}else t&&(c&&c[t]?s=a.createElement(C.a,{icon:c[t],size:20,color:o,type:1}):_.a&&_.a[t]&&(s=a.createElement(C.a,{icon:_.a[t],size:20,color:o,type:0})));return a.createElement(r.a,{style:e},s)}function sa(e,t,n){return()=>{n&&n(t),e&&e()}}function ca({styles:e,displayText:t,isRegularCommand:n}){let o=1;const s=e.commandLabelContainer;return n||(o=2),a.createElement(r.a,{style:s},a.createElement(i.a,{numberOfLines:o,style:e.commandLabel},t))}const la=h.a.create({commandContainer:{display:"flex",flex:1,flexDirection:"row",alignItems:"center"},commandIconContainer:{alignItems:"center",justifyContent:"center",marginLeft:21,marginRight:21,paddingVertical:12},commandLabelContainer:Object.assign({flexDirection:"row",height:"100%",flexGrow:2},Ue({ios:{paddingVertical:11},android:{paddingVertical:12}})),commandLabel:{textAlign:"left",fontSize:17,letterSpacing:-.408,color:"#323130",lineHeight:22},flyoutChevronContainer:{marginLeft:"auto",marginRight:21}}),ua=h.a.create({commandContainer:{flex:1,flexDirection:"column",alignItems:"center",justifyContent:"flex-start",flexGrow:1,marginTop:8,marginBottom:"center"},commandIconContainer:{alignItems:"center",justifyContent:"center",width:40,height:40,borderRadius:20,backgroundColor:"white",borderWidth:.5,borderStyle:"solid",borderColor:"rgba(0, 32, 80, 0.35)",marginLeft:5,marginRight:5},commandLabelContainer:{flexDirection:"row",width:"80%",alignItems:"center",justifyContent:"center",marginTop:4,marginBottom:8,height:26},commandLabel:{flex:1,fontSize:11,letterSpacing:.012,color:"#002050",textAlign:"center",lineHeight:13}}),da=a.createContext({});function ha({item:e,isSelected:t,hasChildren:n,onChange:o,onItemPress:s}){const c=a.useContext(da),l=a.useCallback(t=>{s&&s(t),o(e.value)},[e.value,o,s]);return a.createElement(x.a,{accessibilityRole:"button",testID:e.text,style:t?c.itemWrapperSelected:c.itemWrapper,onPress:l},e.icon&&a.createElement(oa,{icon:e.icon,containerStyle:c.commandIconContainer,color:c.listItemIcon.color}),a.createElement(i.a,{numberOfLines:1,style:t?[c.title,{color:"#2266E3"}]:c.title},e.text),n&&a.createElement(C.b,{onPress:l,icon:_.a.Arrow,size:16,color:"#000",flipInRtl:!0,style:c.icon}),t&&a.createElement(r.a,{style:c.selectedIconWrapper},a.createElement(C.a,{icon:_.a.ForwardDisable,size:20,color:"#2266E3"})))}function ga({goBack:e}){const t=a.useContext(gr).backLabel,n=a.useContext(da);return a.createElement(a.Fragment,null,a.createElement(x.a,{accessibilityLabel:t,accessibilityRole:"button",style:[n.itemWrapper,n.backWrapper],onPress:e},a.createElement(C.b,{onPress:e,icon:_.a.LeftArrowHead,size:16,color:"#000",flipInRtl:!0,style:n.icon}),a.createElement(i.a,{numberOfLines:1,style:n.title},t)),a.createElement(r.a,{style:n.separator}))}function pa({items:e,selectedItem:t,onChange:n,onItemPress:i,maxHeight:o}){const s=a.useContext(da),[c,l]=a.useState(e);return a.createElement(r.a,{style:[s.list,{maxHeight:o}]},a.createElement(Pt.a,{key:"list",data:c,renderItem:e=>{const r=e.item;return a.createElement(ha,{item:r,hasChildren:!!r.items,isSelected:r.value===t,onChange:r.items?()=>l(r.items):n,onItemPress:i})},keyExtractor:e=>e.value,ListHeaderComponent:c!==e&&a.createElement(ga,{key:"back",goBack:()=>l(e)}),ItemSeparatorComponent:()=>a.createElement(r.a,{style:s.separator})}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ma=0;function ba({top:e,items:t,selectedItem:n,onChange:r,onItemPress:i,close:o}){const s=a.useMemo(()=>"drawer_id_"+ ++ma,[]),c=a.useContext(Tn).NativeFlyoutManager;return a.useEffect(()=>(c.registerFlyout(s,o),()=>c.unregisterFlyout(s)),[o,s,c]),a.createElement(St,{top:e,onClose:o},s=>a.createElement(da.Provider,{value:fa},a.createElement(pa,{items:t,top:e,maxHeight:s,selectedItem:n,onChange:r,onItemPress:i,close:o})))}const fa=h.a.create({list:{backgroundColor:"white"},itemWrapper:{display:"flex",flexDirection:"row",height:50,backgroundColor:"white",paddingLeft:16,paddingRight:16,alignItems:"center"},itemWrapperSelected:{display:"flex",flexDirection:"row",height:50,backgroundColor:"white",paddingLeft:16,alignItems:"center"},backWrapper:{paddingLeft:4},title:{fontSize:17,color:"black",flexGrow:1},separator:Object.assign({},Ue({ios:{height:jt.a,backgroundColor:"#C8C8C8",marginLeft:"16px"}})),icon:{display:"flex",width:44,height:50,alignItems:"center",justifyContent:"center"},selectedIconWrapper:Object.assign({},Ue({ios:{height:44,width:44,alignItems:"center",justifyContent:"center"},android:{display:"none"}})),listItemIcon:{color:"#002050"},commandIconContainer:{}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ya({top:e,definition:t,setIsOpen:n}){return t&&a.createElement(ba,{top:e,items:t.items,selectedItem:null,onChange:e=>{t.executables[e](),n(!1)},onItemPress:e=>{e.preventDefault(),e.stopPropagation()},close:()=>n(!1)})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ca(e,t){const[n,r]=a.useState(e),i=a.useCallback(e=>{t&&t(e),r(e)},[t]),o=a.useCallback(()=>i(!n),[i,n]);return[n,o,i]}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function _a({title:e,titleStyle:t,numberOfLines:n}){return a.createElement(i.a,{numberOfLines:n||1,style:t},e)}function va({pageId:e,children:t}){return a.createElement(De.a,{name:it(e)},t)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Sa({style:e,isHeaderCollapsed:t,opacity:n,children:i}){return a.createElement(r.a,{pointerEvents:t?"auto":"none",accessibilityElementsHidden:!t,importantForAccessibility:t?"auto":"no-hide-descendants",style:[Pa.pageSlotContainer,e],testID:"page-title-container"},a.createElement(P.a.View,{style:[Pa.titleContainer,{opacity:n}]},i))}function Oa(){const e=a.useContext(hr);return a.useMemo(()=>({color:e.textColor,fontSize:17,textAlign:"center"}),[e.textColor])}function Ia({pageContentId:e,isHeaderCollapsed:t,opacity:n}){const r=Oa();return a.createElement(Sa,{isHeaderCollapsed:t,opacity:n},a.createElement(De.c,{name:e,fillChildProps:{titleStyle:r}}))}function ja({title:e,isHeaderCollapsed:t,opacity:n}){const r=Oa();return a.createElement(Sa,{style:Pa.plainContainer,isHeaderCollapsed:t,opacity:n},a.createElement(_a,{title:e,titleStyle:r}))}const Pa=h.a.create({pageSlotContainer:{flexGrow:1,flexBasis:0,flexDirection:"row",justifyContent:"center",padding:"11px",marginLeft:"44px"},titleContainer:{maxWidth:"100%"},plainContainer:{marginRight:"88px"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function xa({top:e,saveActions:t,close:n}){const r=a.useMemo(()=>t.map((e,t)=>({text:e.label,value:t.toString()})),[t]),i=a.useCallback(e=>{n(),t[e].save()},[n,t]);return a.createElement(ba,{top:e,items:r,onChange:i,close:n,selectedItem:null})}function Ea({pageContentId:e,isHeaderCollapsed:t,isInCreateMode:n,opacity:r,save:i,discard:o,toggleSaveFlyoutOpen:s}){const c=a.useContext(gr);return a.createElement(a.Fragment,null,a.createElement(b.a,{onPress:o,title:c.discard,style:wa.discard}),a.createElement(Ia,{pageContentId:e,isHeaderCollapsed:t,opacity:r}),n&&a.createElement(C.b,{onPress:s,icon:_.a.More,size:17,color:"#605E5C",style:wa.more}),a.createElement(b.a,{onPress:i,title:c.save,style:wa.save}))}const wa=h.a.create({more:{fontSize:17,alignSelf:"center",marginRight:8,padding:13.5,width:44,height:44},discard:{paddingLeft:16},save:{paddingRight:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ta({title:e,pageContentId:t,isHeaderCollapsed:n,opacity:r,toggleSiteMap:i,navigateBack:o,navigateBackToRoot:s,openSearchPage:c,openCreateMenu:l,backButtonTooltip:u,toggleGlobalCommandsFlyout:d}){const h=a.useContext(gr).sitemapLabel,g=!!e,p=bn(),m=c?a.createElement(Je,{openSearchPage:c}):null;return a.createElement(a.Fragment,null,o?a.createElement(nt,{backButtonTooltip:u,navigateBack:o,navigateBackToRoot:s}):a.createElement(tt,{toggleSiteMap:i,sitemapButtonLabel:h}),g?a.createElement(ja,{title:e,isHeaderCollapsed:n,opacity:r}):a.createElement(a.Fragment,null,a.createElement(Ia,{pageContentId:t,isHeaderCollapsed:n,opacity:r}),m,a.createElement($e,{openCreateMenu:l}),p&&d&&a.createElement(et,{openGlobalCommandsFlyout:d})))}function Aa(e){const{title:t,isDirty:n,isInCreateMode:i,save:o,discard:s,additionalSaveActions:c}=a.useContext(dt),{anchorPoint:l,setAnchorPoint:u,updateAnchorPoint:d}=Ot(),[h,g,p]=Ca(!1,d),[m,b,f]=Ca(!1,d);return a.createElement(r.a,{ref:u,style:Fa.container},n?a.createElement(Ea,{pageContentId:e.pageContentId,isHeaderCollapsed:e.isHeaderCollapsed,opacity:e.opacity,save:o,discard:s,isInCreateMode:i,toggleSaveFlyoutOpen:b}):a.createElement(Ta,Object.assign({},e,{title:t,openCreateMenu:g})),h&&a.createElement(ya,{top:l,definition:e.definition,setIsOpen:p}),m&&a.createElement(xa,{top:l,saveActions:c,close:()=>f(!1)}))}const Fa=h.a.create({container:{display:"flex",flexDirection:"row",height:44,paddingLeft:4}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Na({style:e,children:t,onSizeChange:n}){const i=a.createRef();return a.useLayoutEffect(()=>{const e=ft.findDOMNode(i.current);if(e){const t=new MutationObserver(()=>{const{width:t,height:a}=e.getBoundingClientRect();n(t,a)});return t.observe(e,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),()=>t.disconnect()}},[n,i]),a.createElement(r.a,{ref:i,style:[e,ka.view]},t)}const ka=h.a.create({view:{position:"absolute",transform:[{translateX:fn.a.isRTL?1e3:-1e3,translateY:-1e3}]}});var Ma=n("c/eZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Da(e){var{style:t,children:n,duration:r}=e,i=Object(Ma.__rest)(e,["style","children","duration"]);const[o]=a.useState(new P.a.Value(0));return a.useEffect(()=>{P.a.timing(o,{toValue:1,duration:150}).start(),r&&setTimeout(()=>{P.a.timing(o,{toValue:0,duration:150}).start()},r-150)},[r,o]),a.createElement(P.a.View,Object.assign({style:[t,{opacity:o}]},i),n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ra=P.a.createAnimatedComponent(class extends a.PureComponent{render(){return a.createElement(u.a,Object.assign({},this.props))}});function La({pageContentId:e,isHeaderCollapsed:t,opacity:n,onDynamicContentHeightChange:r}){const i={numberOfLines:3,titleStyle:{color:a.useContext(hr).textColor,fontSize:20,fontWeight:600}},{pageType:o}=a.useContext(dt),s="entityrecord"===o||"entity"===o,c=[Ba.defaultWrapper,s&&{minHeight:void 0,paddingLeft:"20px",paddingRight:"16px",marginTop:void 0}],l=s;return a.createElement(a.Fragment,null,a.createElement(P.a.View,{accessibilityElementsHidden:t,importForAccessibility:t&&"no-hide-descendants",style:[c,{opacity:n,transform:[{translateY:n.interpolate({inputRange:[0,1],outputRange:["-100%","0%"],extrapolate:"clamp"})}]},t&&{display:"none"}]},a.createElement(De.c,{name:e,fillChildProps:i})),a.createElement(Na,{style:c,onSizeChange:(e,t)=>r(l?t:52)},a.createElement(De.c,{name:e,fillChildProps:i})))}const Ba=h.a.create({defaultWrapper:{maxWidth:d.a.get("window").width,minHeight:"44px",paddingLeft:"16px",paddingRight:"8px",paddingBottom:"8px",marginTop:"8px",display:"flex",flexDirection:"row",alignItems:"center"}});function Va({toggleSiteMap:e,navigateBack:t,navigateBackToRoot:n,openSearchPage:r,quickCreateMenu:i,backButtonTooltip:o,toggleGlobalCommandsFlyout:s}){const{pageContentId:c,headerType:l}=a.useContext(dt),u=a.useContext(hr),{headerHeight:d,isCollapsed:h,topOpacity:g,bottomOpacity:p,setBottomHeight:m}=function(e){const{onScroll:t,onScrollEnd:n,nativeHeaderHeight:r,setNativeHeaderHeight:i}=a.useContext(Le),o=Math.max(r-44,0),s=a.useMemo(()=>new P.a.Value(o),[o]),c=44+o,l=a.useCallback(e=>e<1,[]),u=pn(s,l,!1),d=a.useCallback(()=>P.a.timing(s,{toValue:o,duration:100}).start(),[o,s]),h=a.useCallback(()=>P.a.timing(s,{toValue:0,duration:100}).start(),[s]);a.useEffect(()=>t((e,t,n)=>{if(e<=c){const e=n-Math.max(0,t-c),a=t<c/2;n<0&&a?s.setValue(o+e):n>0&&!a&&s.setValue(e)}}),[h,d,o,c,s,t]),a.useEffect(()=>n(e=>{e<c/2?d():h()}),[h,d,c,n]);let g=1===e?44:c;return 0===e&&(g=s.interpolate({inputRange:[0,o],outputRange:[45,c+1],extrapolate:"clamp"})),{isCollapsed:1===e||u,setBottomHeight:e=>i(e+44),headerHeight:g,topOpacity:0===e?s.interpolate({inputRange:[0,o],outputRange:[1,0],easing:Me.a.cubic,extrapolate:"clamp"}):1===e?1:0,bottomOpacity:s.interpolate({inputRange:[0,o],outputRange:[0,1],extrapolate:"clamp"})}}(l);return a.createElement(Ra,{style:[{display:"flex",flexDirection:"column",backgroundColor:u.headerColor,paddingBottom:0,order:-1},0===l&&{position:"absolute",top:0,left:0,right:0}]},a.createElement(P.a.View,{style:{display:"flex",flexDirection:"column",height:d}},a.createElement(Aa,{pageContentId:c,toggleSiteMap:e,navigateBack:t,navigateBackToRoot:n,openSearchPage:r,definition:i,isHeaderCollapsed:h,backButtonTooltip:o,opacity:g,toggleGlobalCommandsFlyout:s}),1!==l&&a.createElement(La,{pageContentId:c,isHeaderCollapsed:h,onDynamicContentHeightChange:m,opacity:p}),h&&t&&a.createElement(Da,{style:Ga.bottomBorder})))}const Ga=h.a.create({bottomBorder:{width:"100%",flexBasis:jt.a,backgroundColor:"#C8C8C8"}});var za=n("lYcl"),Wa=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Xa={get viewPortWidth(){return d.a.get("window").width},get swipeWidthToClose(){return.3*d.a.get("window").width},get sidebarWidth(){const e=84*d.a.get("window").width/100;return e>Ha?Ha:e},animationDuration:400,animationEasing:Me.a.out(Me.a.exp),overlayMaxOpacity:.7,tolerance:10},Ha=350,Ua=a.createContext({openAnimationProgress:new P.a.Value(0),toggleSidebar:()=>{},closeSidebar:e=>{}});class qa extends a.PureComponent{constructor(e){super(e),this._panResponder=null,this._sidebarContext={openAnimationProgress:new P.a.Value(0),toggleSidebar:()=>{this.props.isDisabled||(this.props.isOpen?this._animateToClosed():this._animatedToOpened())},closeSidebar:e=>{this.props.isDisabled||this.props.isOpen&&this._animateToClosed(e)}},this._isCurrentlySliding=!1,this._onStartShouldSetPanResponder=(e,t)=>!this.props.isDisabled&&this.props.isOpen,this._onMoveShouldSetPanResponder=(e,t)=>{if(this.props.isDisabled)return!1;if(!this.props.isOpen){if(this.props.isRTL){if(Xa.viewPortWidth-t.moveX>40)return!1}else if(t.moveX>40)return!1;return!0}return t.dx>Xa.tolerance||t.dx<-1*Xa.tolerance||void 0},this._onPanResponderMove=(e,t)=>{const{pageX:n}=e.nativeEvent,{isOpen:a}=this.props,{openAnimationProgress:r}=this._sidebarContext,i=t.x0;if(a){if(this.props.isRTL?i<n:i>n){this._isCurrentlySliding=!0;const e=(this.props.isRTL?Xa.sidebarWidth-t.dx:Xa.sidebarWidth+t.dx)/Xa.sidebarWidth;r.setValue(e)}}else{if(this.props.isRTL?Xa.viewPortWidth-i<40:i<40){this._isCurrentlySliding=!0;const e=this.props.isRTL?(Xa.viewPortWidth-n)/Xa.sidebarWidth:n/Xa.sidebarWidth;r.setValue(e),this.state.shouldShowOverlay||this.setState({shouldShowOverlay:!0})}}},this._onPanResponderRelease=(e,t)=>{const{isOpen:n}=this.props,a=this.props.isRTL?t.x0-e.nativeEvent.pageX:e.nativeEvent.pageX-t.x0;if(this._isCurrentlySliding){const e=Math.abs(t.vx)>1,r=this.props.isRTL?t.vx>0:t.vx<0,i=this.props.isRTL?Xa.viewPortWidth-t.x0+a:t.x0+a;(n?r&&e||-1*a>Xa.swipeWidthToClose:!e&&i<Xa.swipeWidthToClose)?this._animateToClosed():this._animatedToOpened(),this._isCurrentlySliding=!1}else(this.props.isRTL?t.x0<Xa.viewPortWidth-Xa.sidebarWidth:t.x0>Xa.sidebarWidth&&n)&&this._animateToClosed()},this._animate=(e,t)=>P.a.timing(e,{toValue:t,duration:Xa.animationDuration,easing:Xa.animationEasing}),this._animatedToOpened=()=>{this.state.shouldShowOverlay||this.setState({shouldShowOverlay:!0}),this._animate(this._sidebarContext.openAnimationProgress,1).start(()=>{this.props.setExpandedState(!0,!0,this._sidebarContext.closeSidebar),this._sidebarContext.openAnimationProgress.setValue(1)})},this._animateToClosed=e=>{this._animate(this._sidebarContext.openAnimationProgress,0).start(()=>{this.props.setExpandedState(!1,!e,this._sidebarContext.closeSidebar),this.setState({shouldShowOverlay:!1}),e&&e()})},this.state={shouldShowOverlay:!1},this._panResponder=yn.a.create({onStartShouldSetPanResponder:this._onStartShouldSetPanResponder,onMoveShouldSetPanResponder:this._onMoveShouldSetPanResponder,onPanResponderMove:this._onPanResponderMove,onPanResponderRelease:this._onPanResponderRelease})}render(){const{shouldShowOverlay:e}=this.state,{openAnimationProgress:t}=this._sidebarContext,{children:n,menuContent:i,isDisabled:o}=this.props;return a.createElement(Ua.Provider,{value:this._sidebarContext},a.createElement(r.a,Object.assign({style:Ya.container},!o&&this._panResponder.panHandlers),a.createElement(r.a,{style:{flexGrow:1},pointerEvents:e||this.props.isModalOpen?"none":"auto",importantForAccessibility:e||this.props.isModalOpen?"no-hide-descendants":"auto"},n),a.createElement(Ye.a,null,a.createElement(a.Fragment,null,a.createElement(P.a.View,{pointerEvents:e?"auto":"none",style:[Ya.overlay,{opacity:t}]}),a.createElement(P.a.View,{style:[[Ya.sidebar,{width:Xa.sidebarWidth}],{transform:[{translateX:t.interpolate({inputRange:[0,1],outputRange:this.props.isRTL?["101%","0%"]:["-101%","0%"],extrapolate:"clamp"})}]}]},i)))))}}const Ya=h.a.create({container:{width:"100%",height:"100%",position:"relative",backgroundColor:"#ffffff"},sidebar:{height:"100%",position:"absolute",top:0,backgroundColor:"#ffffff",backfaceVisibility:"hidden"},overlay:{width:"100%",height:"100%",position:"absolute",left:0,top:0,opacity:0,backgroundColor:"rgba(0,0,0,0.75)"}});var Ka=n("ws6F"),Qa=n("6Djt"),Za=n("0GT3");function Ja(){const e=a.useMemo(()=>Object(Qa.a)(),[]),t=Object(l.c)(),n=Object(l.d)(e);return a.useEffect(()=>{n||t(Object(Za.a)())},[n,t]),
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){return a.useMemo(()=>{const n={},a=t&&t.map(t=>t.Children?{text:t.DisplayText,items:t.Children.map(t=>(n[t.Id]=()=>e(t.execute),{text:t.DisplayText,value:t.Id}))}:(n[t.Id]=()=>e(t.execute),{text:t.DisplayText,value:t.Id}));return{executables:n,items:a}},[t,e])}(t,n)}var $a=n("GP49"),er=n("VnTQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const tr=["UCI_LongPressHome_Hint"];var nr=n("46jN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ar({top:e,right:t,width:n,onClose:i,children:o}){return a.createElement(Ye.a,{key:"portal"},a.createElement(vt,{key:"backdrop",style:[rr.fullscreen]}),a.createElement(We.a,{onPress:i},a.createElement(r.a,{style:[rr.fullscreen]})),a.createElement(r.a,{key:"flyout",style:[rr.root,{top:e,right:t,width:n}]},o))}const rr=h.a.create({fullscreen:{position:"absolute",top:0,left:0,right:0,bottom:0},root:{position:"absolute",width:"100%",height:"auto",margin:0,display:"flex",boxShadow:"0px 5px 6px rgba(0, 0, 0, 0.2), 0px 3px 16px rgba(0, 0, 0, 0.12), 0px 9px 12px rgba(0, 0, 0, 0.14)"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ir=0;function or({top:e,right:t,width:n,maxHeight:r,items:i,selectedItem:o,onChange:s,close:c}){const l=a.useMemo(()=>"flyout_id_"+ ++ir,[]),u=a.useContext(Tn).NativeFlyoutManager;a.useEffect(()=>(u.registerFlyout(l,c),()=>u.unregisterFlyout(l)),[c,l,u]);return a.createElement(ar,{top:e,right:t,width:n,onClose:c},a.createElement(da.Provider,{value:sr},a.createElement(pa,{items:i,top:e,maxHeight:r,selectedItem:o,onChange:s,onItemPress:e=>{e.preventDefault(),e.stopPropagation()},close:c})))}const sr=h.a.create({list:{backgroundColor:"#FAFAFA"},itemWrapper:{display:"flex",flexDirection:"row",height:50,alignItems:"center",paddingRight:10},itemWrapperSelected:{display:"flex",flexDirection:"row",height:50,alignItems:"center"},backWrapper:{paddingLeft:4},title:{fontSize:16,color:"black",flexGrow:1},separator:{},icon:{display:"flex",width:44,height:50,alignItems:"center",justifyContent:"center"},selectedIconWrapper:{height:44,width:44,alignItems:"center",justifyContent:"center"},listItemIcon:{color:"#002050",fontSize:20},commandIconContainer:{alignItems:"center",justifyContent:"center",width:40}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function cr({close:e,executeCommand:t,globalCommands:n}){const r=a.useMemo(()=>function e(t){if(!t||!t.length)return null;return t.map((t,n)=>({text:t.LabelText,value:n.toString(),icon:t.Icon,items:e(t.Children)}))}(n),[]),i=a.useCallback(a=>{e(),t(n[a])},[e,t,n]);return a.createElement(or,{top:4,right:4,width:205,items:r,onChange:i,close:e,selectedItem:null})}var lr=n("SEva");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ur=Object.assign({headerIconColor:"white",textColor:"white"},Ue({ios:{headerColor:"#002050"},android:{headerColor:"#001433"}})),dr={headerColor:"#FFF",headerIconColor:"#605E5C",textColor:"black"},hr=a.createContext({}),gr=a.createContext({}),pr=[Ka.A,Wa.c,Wa.b,"Web.NavBar.Back_Caption",ot.U,nr.j,wt.d];function mr(){const e=Object(ne.a)(pr);return a.useMemo(()=>({save:e[Wa.c],discard:e[Wa.b],sitemapLabel:e[Ka.A],backLabel:e["Web.NavBar.Back_Caption"],searchLabel:e[ot.U],quickCreateMenuLabel:e[nr.j],moreCommands:e[wt.d]}),[e])}const br=a.memo((function({isRootPage:e,navigateBack:t,navigateBackToRoot:n,routeIndex:r}){const i=Object(l.c)(),o=a.useContext(Ua),s=Ja(),u=mr(),d=Object(l.d)(e=>Object(de.c)(e,c.Mb)),h=a.useCallback(()=>i(Object(za.a)("")),[i]),g=function(e){const t=Object(l.c)(),n=a.useCallback(()=>t(Object(er.c)()),[t]);let r=Object(l.d)($a.c);e<3&&(r=!1);const i=Object(ne.a)(tr),o=i&&Object($.c)(i,"UCI_LongPressHome_Hint")||"Press and hold to go home. Tap to dismiss this message";return a.useMemo(()=>({onPress:n,shouldRenderTooltip:r,text:o}),[o,n,r])}(r),[p,m,b]=Ca(!1),[f,y]=function(){const{executeCommand:e,commands:t}=Qn(Et.d);return[Kn(e,null),t]}();return a.createElement(gr.Provider,{value:u},a.createElement(hr.Provider,{value:e?ur:dr},a.createElement(U,{backgroundColor:e?ur.headerColor:dr.headerColor,barStyle:e?"light-content":"dark-content",animated:!0}),a.createElement(Va,{toggleSiteMap:o.toggleSidebar,toggleGlobalCommandsFlyout:y&&!!y.length&&m,navigateBack:!e&&t,navigateBackToRoot:n,openSearchPage:d?null:h,quickCreateMenu:s,backButtonTooltip:g}),p&&a.createElement(lr.a,{name:"GlobalCommandsFlyout"},a.createElement(cr,{executeCommand:f,globalCommands:y,close:()=>b(!1)}))))}));var fr=n("aOhN"),yr=n("oT5e"),Cr=n("PrIm"),_r=n("eIlw"),vr=n("bUa6");function Sr({pageId:e,definition:t,isTopPage:n,error:i}){let o=null;if(i)o=a.createElement(vr.a,null);else if(n&&t){const n=t.getRootComponent();o=a.createElement(_r.a,{pageType:t.getName(),pageId:e},a.createElement(n,{id:e}))}return a.createElement(r.a,{style:Ir.wrapper},o)}function Or({isCommandShelfRendered:e}){return!e||mn()?a.createElement(Cr.a,{globalNotificationsViewStyle:{marginBottom:"env(safe-area-inset-bottom)"}}):a.createElement(Cr.a,{key:"globalNotificationList"})}const Ir=h.a.create({wrapper:{flexGrow:1,flexBasis:0,userSelect:"auto",paddingLeft:"env(safe-area-inset-left)",paddingRight:"env(safe-area-inset-right)"}}),jr=a.memo((
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function({pageId:e,isRootPage:t,isTopPage:n,displayPage:r,definition:i,routeIndex:o,navigateBack:s,navigateBackToRoot:c,error:l}){const[u,d]=a.useState(0),[h,g]=a.useState(!1);return a.createElement(a.Fragment,null,a.createElement(Sr,{key:e,pageId:e,definition:r&&i,isTopPage:n,error:l}),n&&a.createElement(lr.a,{name:"GlobalNotificationBar"},a.createElement(P.a.View,{onLayout:e=>{const{height:t}=e.nativeEvent.layout;u!==t&&d(t)}},a.createElement(Or,{key:"globalNotificationList",isCommandShelfRendered:h}))),n&&a.createElement(lr.a,{name:"NativeCommandManager"},a.createElement(aa,{key:"commanding",setCommandShelfRendered:g})),a.createElement(Pn,{paddingBottom:u}),a.createElement(br,{isRootPage:t,navigateBack:s,navigateBackToRoot:c,routeIndex:o}))}));class Pr extends a.Component{constructor(e){super(e),this._isCurrentlySwiping=!1,this._pageAnimationProgress=new P.a.Value(0),this._shouldSetPanResponder=e=>{if(!this.props.canSwipeBack)return!1;const{pageX:t}=e.nativeEvent;return!((fn.a.isRTL?d.a.get("window").width-t:t)>50)&&this.props.isActive},this._keepPageOnScreen=()=>{this._animate(0,()=>{})},this._closePageAndNavigateBack=()=>{this._closePage(this.props.onBeforeNavigateBack,this.props.onNavigateBack)},this._closePageAndNavigateToRoot=()=>{this._closePage(()=>this.props.onBeforeNavigateBack(!0),()=>this.props.onNavigateBack(!0))},this._closePage=(e,t)=>{this.props.isRootPage||e().then(e=>{e?this._animate(1,()=>{t(),this._pageAnimationProgress.setValue(0)}):this._keepPageOnScreen()})},this.state={displayPage:e.isRootPage},this._panResponder=yn.a.create({onStartShouldSetPanResponder:this._shouldSetPanResponder,onMoveShouldSetPanResponder:this._shouldSetPanResponder,onPanResponderGrant:(e,t)=>{this._isCurrentlySwiping=!0},onPanResponderMove:(e,t)=>{const n=d.a.get("window").width,a=(fn.a.isRTL?n+t.dx:t.dx)/n;this._pageAnimationProgress.setValue(fn.a.isRTL?1-a:a)},onPanResponderTerminationRequest:(e,t)=>!0,onPanResponderRelease:(e,t)=>{if(this._isCurrentlySwiping){const{isRTL:e}=fn.a,n=Math.abs(t.vx)>.8,a=e?t.vx<0:t.vx>0,r=d.a.get("window").width/2;a&&n||(e?t.moveX<=r:t.moveX>=r)?this._closePageAndNavigateBack():this._keepPageOnScreen()}this._isCurrentlySwiping=!1},onPanResponderTerminate:(e,t)=>{}})}componentDidMount(){this._pageAnimationProgress.setValue(1),this.props.isRootPage?this._pageAnimationProgress.setValue(0):this._animate(0,()=>{this._pageAnimationProgress.setValue(0),this.setState({displayPage:!0})},400)}_animate(e,t,n=200){P.a.timing(this._pageAnimationProgress,{toValue:e,duration:n,easing:Me.a.out(Me.a.exp)}).start(t)}render(){const{canSwipeBack:e,isNextOnStack:t,isTopPage:n,isActive:i,isRootPage:o,route:s,definition:c,error:l}=this.props,{isRTL:u}=fn.a;if(!o&&!t&&!i)return null;const d=u?-1:1;return a.createElement(r.a,Object.assign({},i&&e&&this._panResponder.panHandlers,{style:h.a.absoluteFill}),a.createElement(P.a.View,{style:[xr.pageContainer,{transform:[{translateX:this._pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:t?[-10*d+"%","0%"]:["0%",100*d+"%"],extrapolate:"clamp"})}]}]},a.createElement(bt,{pageId:s},a.createElement(jr,{error:l,pageId:s,isRootPage:o,definition:this.state.displayPage&&c,isTopPage:n,displayPage:this.state.displayPage,navigateBack:this._closePageAndNavigateBack,navigateBackToRoot:this._closePageAndNavigateToRoot,routeIndex:this.props.routeIndex}))),!i&&a.createElement(P.a.View,{pointerEvents:"none",style:[xr.darkOverlay,{opacity:this._pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:[1,0],extrapolate:"clamp"})}]}))}}const xr=h.a.create({pageContainer:Object.assign(Object.assign({},h.a.absoluteFillObject),{boxShadow:"0px 0px 20px rgba(0,0,0,0.35)",backgroundColor:"#ffffff"}),darkOverlay:Object.assign(Object.assign({},h.a.absoluteFillObject),{backgroundColor:"rgba(0,0,0,0.2)"})});var Er=n("llMO");function wr({commandPaneDescriptor:e,closeSitemap:t}){return e?a.createElement(r.a,{key:"sitemap-commands",style:Tr.sitemapCommandPaneSafeAreaView,accessibilityRole:"toolbar",accessibilityLabel:e.commandsLabel},a.createElement(r.a,{key:"sitemap-commands-upper"},a.createElement(C.b,{size:1,icon:_.a.Cancel,color:"transparent",onPress:()=>t(),"data-keyboard-tab":"first",accessibilityRole:"button",key:"hidden",accessibilityLabel:e.hiddenButtonLabel,style:Tr.hiddenIcon,testID:"sitemap-close"}),e.upperCommands&&e.upperCommands.map((e,n)=>a.createElement(C.b,{icon:e.icon.value,color:"#777777",size:20,type:e.icon.type,key:n,onPress:()=>{t(e.action)},accessibilityLabel:e.label,style:Tr.upperCommandIconView,"aria-haspopup":!0,accessibilityRole:"button",testID:"sitemap-command-"+e.label}))),a.createElement(r.a,{key:"sitemap-commands-lower"},e.lowerCommands&&e.lowerCommands.map((e,n)=>a.createElement(C.b,{key:n,icon:e.icon.value,color:"#E1E1E1",size:"android"===qe()?22:25,type:e.icon.type,onPress:()=>{t(e.action)},accessibilityLabel:e.label,style:Tr.lowerCommandIconView,"aria-haspopup":!0,accessibilityRole:"button",testID:"sitemap-command-"+e.label})))):null}const Tr=h.a.create({upperCommandIconView:{backgroundColor:"#E1E1E1",height:42,width:42,alignItems:"center",justifyContent:"center",borderRadius:42,borderStyle:"solid",borderWidth:.5,borderColor:"rgba(142, 142, 146, 0.5)",marginVertical:10},lowerCommandIconView:{height:50,width:50,alignItems:"center",justifyContent:"center"},sitemapCommandPaneSafeAreaView:{alignItems:"center",flexDirection:"column",height:"100%",justifyContent:"space-between",width:64},hiddenIcon:{position:"absolute",opacity:0}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ar({areaSwitcherDescriptor:e}){if(!e)return null;const{action:t,title:n,titleInitials:o,titleColor:s,areaCount:c,label:l}=e;return c<=1?null:a.createElement(x.a,{"data-keyboard-tab":"last",onPress:t,style:Fr.wrapperView,accessibilityRole:"button","aria-haspopup":!0,accessibilityLabel:l,testID:"sitemap-area-switcher","data-id":"sitemap-areaSwitcher-expand-btn"},a.createElement(r.a,{style:[Fr.leftIconView,{backgroundColor:s}]},a.createElement(i.a,{style:Fr.leftIconText},o)),a.createElement(r.a,{style:Fr.titleView},a.createElement(i.a,{numberOfLines:1,style:Fr.titleText},n),a.createElement(r.a,{style:Fr.rightIconView},a.createElement(C.a,{icon:_.a.ScrollUpDown,size:12,color:"#605E5C",fontWeight:"600"}))))}const Fr=h.a.create({wrapperView:{backgroundColor:"#FFFFFF",alignItems:"center",flexDirection:"row",height:44,alignSelf:"flex-end",width:"100%"},leftIconView:{alignItems:"center",justifyContent:"center",height:25,width:25,marginStart:16,marginEnd:10,borderRadius:4},leftIconText:{color:"#FFFFFF",fontSize:17},titleView:{flexDirection:"row",justifyContent:"space-between",flexGrow:1,maxWidth:"CALC(100% - 51px)"},rightIconView:{marginHorizontal:18,justifyContent:"center"},titleText:{color:"#323130",fontSize:17,fontWeight:"500",maxWidth:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Nr({subArea:e}){const t=g();if(!e)return null;const{title:n,icon:o,subAction:s}=e;return a.createElement(x.a,{onPress:e.action,style:[Dr.sitemapSubAreaWrapperView,Dr.sitemapSubAreaWrapperViewHomePane],accessibilityLabel:n,testID:"sitemap-subarea-home"},a.createElement(r.a,{style:Dr.homePaneRowView},a.createElement(r.a,{style:Dr.sitemapSubAreaIconView},a.createElement(C.a,{type:o.type,icon:o.value,color:"#828282",size:19})),a.createElement(i.a,{style:[Dr.subAreaTitle,{maxWidth:"calc(100% - 48px)"}]},n)),s?a.createElement(x.a,{onPress:s.action,style:Dr.subActionTouchableOpacity,accessibilityRole:"link",accessibilityLabel:s.title,accessible:!0,ref:t,testID:"sitemap-subarea-apps"},a.createElement(r.a,{style:Dr.subActionTitleWrapper},a.createElement(i.a,{style:Dr.subActionTitle},s.title)),a.createElement(r.a,{style:Dr.subActionIconWrapper},a.createElement(C.a,{size:15,icon:s.icon.value,type:s.icon.type,color:"#2266E3",flipInRtl:s.icon.flipInRtl,fontWeight:"600"}))):null)}function kr({subArea:e,isSelected:t,forceAccessible:n}){if(!e)return null;const{title:o,icon:s}=e,c=t?"#2266E3":"#828282",l=t?"#2266E3":"#323130";return a.createElement(x.a,{"data-keyboard-nav":!0,onPress:e.action,style:Dr.sitemapSubAreaWrapperView,accessibilityLabel:o,"aria-selected":t,accessible:t||n,accessibilityState:{selected:t},testID:"sitemap-subarea-"+e.id,"data-id":"sitemap-entity-"+e.id},a.createElement(r.a,{style:Dr.sitemapSubAreaIconView},a.createElement(C.a,{type:s.type,icon:s.value,color:c,size:19})),a.createElement(i.a,{numberOfLines:1,style:[Dr.subAreaTitle,{color:l}]},o))}function Mr({subAreaList:e}){const{selectedSubAreaId:t}=e;return a.createElement(Gt.a,{renderScrollComponent:Ut,sections:e.subAreaList,renderItem:({item:n})=>n.subAction?a.createElement(Nr,{subArea:n}):a.createElement(kr,{subArea:n,isSelected:t===n.id,forceAccessible:!t&&n.id===e.subAreaList[1].data[0].id}),renderSectionHeader:({section:e})=>e.title&&a.createElement(i.a,{style:Dr.subAreaListText},e.title),keyExtractor:e=>e.id,stickySectionHeadersEnabled:!1})}const Dr=h.a.create({sitemapSubAreaWrapperView:{width:"100%",height:44,flexDirection:"row",alignItems:"center"},sitemapSubAreaWrapperViewHomePane:{justifyContent:"space-between"},sitemapSubAreaIconView:{width:48,height:"100%",alignItems:"center",justifyContent:"center"},subAreaListText:{color:"#212121",paddingHorizontal:16,paddingTop:13,paddingBottom:13,fontSize:15,width:"100%",borderTopColor:"#E6E6E6",borderTopWidth:.5},subActionTouchableOpacity:{height:"100%",alignItems:"center",marginEnd:12,flexDirection:"row",flexGrow:0,flexShrink:1,flexWrap:"wrap",overflow:"hidden",minWidth:75,justifyContent:"flex-end"},homePaneRowView:{flexDirection:"row",flexGrow:0,flexShrink:1,alignItems:"center",height:"100%",overflow:"hidden",minWidth:125},subActionTitle:{color:"#2266E3",fontSize:15,fontWeight:"500",textAlign:"right",maxHeight:"100%",maxWidth:"100%"},subActionTitleWrapper:{height:"100%",justifyContent:"center",maxWidth:"100%"},subActionIconWrapper:{marginStart:5},subAreaTitle:{lineHeight:20,fontSize:14,flexGrow:0,color:"#323130",marginRight:15,maxHeight:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Rr({subAreaList:e,commandPaneDescriptor:t,areaSwitcherDescriptor:n,isSitemapOpen:i,closeSitemap:o}){if(!e)return null;const s="android"!==qe()&&i;return a.createElement(r.a,{style:Lr.sitemapPresentationWrapperView,accessibilityState:{disabled:!i},"aria-hidden":!i,accessibilityLabel:e.navigationLabel,accessibilityRole:"menubar"},s&&a.createElement(U,{hidden:!0}),a.createElement(u.a,{key:"command-pane-safe-area",style:Lr.commandPaneSafeAreaView},a.createElement(wr,{commandPaneDescriptor:t,closeSitemap:o})),a.createElement(u.a,{key:"sub-list-safe-area",style:Lr.sitemapPresentationSafeAreaView},a.createElement(Mr,{key:"sub-area-list",subAreaList:e}),a.createElement(r.a,{key:"area-switcher-border",style:Lr.areaSwitcherTopBorder}),a.createElement(Ar,{key:"area-switcher",areaSwitcherDescriptor:n})))}const Lr=h.a.create({sitemapPresentationWrapperView:{flex:1,backgroundColor:"#e0e0e1",alignItems:"center",flexDirection:"row",height:"100%"},sitemapPresentationSafeAreaView:{flex:1,backgroundColor:"#FFFFFF",flexDirection:"column",height:"100%",justifyContent:"space-between",paddingRight:0,paddingLeft:0},areaSwitcherTopBorder:{backgroundColor:"rgba(0, 0, 0, 0.05)",width:"100%",height:1},commandPaneSafeAreaView:{backgroundColor:"#F1F1F1",height:"100%",paddingRight:0}});var Br=n("2FbK"),Vr=n("uZvv"),Gr=n("D+Bz"),zr=n("fWyz"),Wr=n("SFgX"),Xr=n("QbIY"),Hr=n("wRZP"),Ur=n("oLPm");function qr(e){if(e.VectorIcon)return{type:1,value:e.VectorIcon};return{type:0,value:Object(Wr.b)(e.Entity,e.Url)}}function Yr(e,t,n){return e?{id:e.Id,title:e.Titles&&e.Titles.length&&e.Titles[0].Title,data:e.SubAreaIds.map(a=>function(e,t,n){return e?{id:e.Id,title:e.Titles&&e.Titles.length&&e.Titles[0].Title,icon:qr(e),action:()=>{t(Object(zr.c)(e,!0,()=>n(),{source:Gr.b.SiteMap}))}}:null}(e.SubAreas[a],t,n))}:null}var Kr=n.p+"resources/images/NativeHelp.svg?v=1.4.9962-v91onpremise",Qr=n.p+"resources/images/NativeSettings.svg?v=1.4.9962-v91onpremise",Zr=n.p+"resources/images/NativeCloud.svg?v=1.4.9962-v91onpremise",Jr=n.p+"resources/images/AndroidHelp.svg?v=1.4.9962-v91onpremise",$r=n.p+"resources/images/AndroidSettings.svg?v=1.4.9962-v91onpremise",ei=n.p+"resources/images/AndroidCloud.svg?v=1.4.9962-v91onpremise",ti=n("v77L"),ni=n("1Ibc"),ai=n("d/SG"),ri=n("f9Qq");var ii=n("rrts"),oi=n("VZXL"),si=n("olZa");function ci(e,t){return[{label:Object($.c)(t,nr.o),icon:{type:0,value:_.a.MembersIcon},action:()=>e(Object(En.d)(ti.c))},{label:Object($.c)(t,Ka.s),icon:{type:0,value:_.a.Recent},action:()=>e(Object(En.d)(ti.d))},{label:Object($.c)(t,Ka.l),icon:{type:0,value:_.a.Pinned},action:()=>e(Object(En.d)(ti.b))}]}function li(e,t){return[{label:Object($.c)(t,nr.c),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?Jr:Kr},action:()=>e({type:"sitemap.help.action",sync:!0,execute({dispatch:e,getState:t}){Object(ni.a)(t())?e(Object(ai.b)()):e(Object(xe.a)(Object(ri.a)(t())))}})},{label:Object($.c)(t,nr.i),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?ei:Zr},action:()=>e(Object(ii.openOfflineStatusDialogAction)(!0))},{label:Object($.c)(t,nr.m),icon:{type:1,value:He.a.getInstance().get_IsAndroid()?$r:Qr},action:()=>e(Object(En.d)(ti.e))}]}var ui=n("0FMG"),di=n("uMsf"),hi=n("unFF"),gi=n("0U+K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function pi({closeIcon:e,closeButtonLabel:t,onClosePressed:n}){if("android"===qe())return a.createElement(C.b,{key:"icon-button",icon:Qt,type:1,color:"#000000",size:16,flipInRtl:!0,onPress:n,accessibilityLabel:t,style:fi.nativeModalChromeTouchableOpacity,testID:"native-modal-close"});const r=e||_.a.CancelFilter;return a.createElement(C.b,{key:"icon-button",icon:r,color:"#605E5C",size:16,flipInRtl:!0,onPress:n,accessibilityLabel:t,style:fi.nativeModalChromeTouchableOpacity,testID:"native-modal-close"})}function mi({closeIcon:e,onClosePressed:t,title:n,closeButtonLabel:o,children:s}){return a.createElement(r.a,{style:fi.nativeModalChromeSafeAreaView,accessibilityRole:"dialog","aria-modal":!0,accessibilityLabel:n},a.createElement(U,{barStyle:"dark-content",backgroundColor:"#FFF"}),a.createElement(u.a,{style:fi.nativeModalChromeTitleViewContainer},a.createElement(r.a,{style:fi.nativeModalChromeTitleView},a.createElement(pi,{closeIcon:e,onClosePressed:t,closeButtonLabel:o}),a.createElement(i.a,{key:"text",style:fi.nativeModalChromeTitleText,testID:"native-modal-title"},n),a.createElement(r.a,{key:"view",style:fi.nativeModalChromeSubActionView}))),a.createElement(Ht,null,s))}const bi="android"===qe()?56:44,fi=h.a.create({nativeModalChromeSafeAreaView:Object.assign({flex:1},Ue({android:{backgroundColor:"#FFF"},ios:{backgroundColor:"#F3F2F1"}})),nativeModalChromeTitleViewContainer:{paddingBottom:0,backgroundColor:"#FFFFFF",borderBottomColor:"#C8C8C8",borderBottomWidth:jt.a,position:"relative",zIndex:1,shadowRadius:1,shadowColor:"rgba(0,0,0,0)"},nativeModalChromeTitleView:Object.assign({flexDirection:"row",height:bi,alignItems:"center",flex:0,flexBasis:bi,justifyContent:"space-between"},Ue({android:{justifyContent:"flex-start"}})),nativeModalChromeTouchableOpacity:{height:bi,width:bi,justifyContent:"center",alignItems:"center"},nativeModalChromeTitleText:Object.assign({fontWeight:"500",color:"#000",fontSize:17},Ue({android:{color:"#605E5C",fontSize:20,marginLeft:16}})),nativeModalChromeSubActionView:{height:bi,width:bi}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function yi(){return a.createElement(r.a,{style:Ci.separatorWrapper},a.createElement(r.a,{style:Ci.separator}))}const Ci=h.a.create({separator:Object.assign({height:0,borderBottomColor:"#E6E6E6",borderBottomWidth:jt.a,marginStart:16},Ue({android:{marginHorizontal:16}})),separatorWrapper:{backgroundColor:"#FFF"}});var _i=n.p+"resources/images/AndroidCheckmark.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function vi(){return"android"===qe()?a.createElement(C.a,{color:"#0078D4",size:17,icon:_i,type:1}):a.createElement(C.a,{color:"#2266E3",size:17,icon:_.a.ForwardDisable})}function Si({area:e}){return a.createElement(x.a,{onPress:e.action,style:Ii.rowWrapperView,accessibilityRole:"menuitem",accessibilityState:{checked:e.isSelected},accessibilityLabel:e.title,"aria-checked":e.isSelected,testID:"sitemap-area-"+e.title,"data-id":"areaswitcherflyout-"+e.id},a.createElement(i.a,{numberOfLines:1,style:e.isSelected?Ii.rowTextStyleSelected:Ii.rowTextStyle},e.title),e.isSelected?a.createElement(vi,null):null)}function Oi({title:e,closeAction:t,areaList:n,closeButtonLabel:r}){return a.createElement(mi,{title:e,onClosePressed:t,closeButtonLabel:r},a.createElement(Pt.a,{accessibilityRole:"menu",accessibilityLabel:e,data:n,renderItem:({item:e})=>a.createElement(Si,{area:e}),ItemSeparatorComponent:e=>a.createElement(yi,null)}))}const Ii=h.a.create({rowWrapperView:Object.assign({flexDirection:"row",height:50,alignContent:"center",alignItems:"center",paddingHorizontal:16,backgroundColor:"#FFFFFF",justifyContent:"space-between"},Ue({android:{height:47.5}})),rowTextStyle:{fontSize:17,color:"#323130"},rowTextStyleSelected:{fontSize:17,color:"#2266E3"},separator:{height:1,backgroundColor:"rgba(0, 0, 0, 0.1)",marginStart:16},separatorFinal:{height:1,backgroundColor:"rgba(0, 0, 0, 0.1)",marginStart:0},separatorWrapper:{backgroundColor:"#FFF"}});var ji=n("M8lA"),Pi=n("RJiR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function xi({modalId:e,children:t}){const n=Object(l.d)(t=>Object(ji.b)(t,e)),r=Object(l.c)(),i=a.useCallback(()=>r(Object(En.c)(e)),[r,e]);return a.createElement(Pi.d,{closeAction:i,id:e,isModalOpen:n},t)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ei=[Ka.h,Ka.i,si.b],wi=function(){let e,t;return(n,a)=>{const r=Object(Vr.b)(n);if(!e||t!==r){const i=Object(Br.b)(n);if(!i)return e;const o=i.AreaIds.map(e=>{const t=i.Areas[e];return{title:t.Titles&&t.Titles[0].Title,isSelected:e===r,action:()=>{a(Object(ui.d)(t.Id)),a(Object(di.a)(t.Id,Gr.b.SiteMapSubArea)),a(Object(En.c)(ti.a))},id:t.Id}});t=r,e=o}return e}}();function Ti(){const e=Object(l.c)(),t=Object(ne.a)(Ei),n=Object(l.d)(t=>wi(t,e)),r=a.useCallback(()=>e(Object(En.c)(ti.a)),[e]),i=Object($.c)(t,Ka.h),o=Object($.c)(t,si.b);return a.createElement(xi,{modalId:ti.a},a.createElement(Oi,{title:i,closeAction:r,areaList:n,closeButtonLabel:o}))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ai({emptyViewDescriptor:e}){return a.createElement(r.a,{style:ki.emptyView},a.createElement(C.a,{icon:e.icon,size:80,color:"rgba(0, 20, 51, 0.2)"}),a.createElement(i.a,{style:ki.emptyViewTitle},e.title),a.createElement(i.a,{style:ki.emptyViewText},e.text))}function Fi({recentItem:e,handleAction:t,handleSubAction:n,resourceStrings:o,getAriaLabel:s}){const c=a.useCallback(()=>t(e),[t,e]),l=a.useCallback(()=>n(e),[n,e]);return a.createElement(a.Fragment,null,a.createElement(r.a,{style:ki.renderRowWrapper},a.createElement(x.a,{style:ki.touchableOpacity,onPress:c,accessibilityRole:"menuitem",accessibilityLabel:e.Title,testID:"recent-"+e.ObjectId},a.createElement(i.a,{numberOfLines:1,style:ki.renderRowTitleText},e.Title)),a.createElement(C.b,{color:"#2266E3",size:17,icon:e.PinStatus?_.a.Unpin:_.a.Pinned,onPress:l,style:ki.renderRowSubActionView,accessibilityLabel:s(o,e),accessibilityRole:"button",testID:"recent-pin-"+e.ObjectId})))}function Ni({recents:e,title:t,closeAction:n,closeButtonLabel:r,handleAction:i,handleSubAction:o,resourceStrings:s,getAriaLabel:c,emptyViewDescriptor:l}){return a.createElement(mi,{title:t,onClosePressed:n,closeButtonLabel:r},a.createElement(Pt.a,{data:e,accessibilityRole:"menu",keyExtractor:e=>e.ObjectId.guid,renderItem:({item:e})=>a.createElement(Fi,{recentItem:e,handleAction:i,handleSubAction:o,resourceStrings:s,getAriaLabel:c}),ItemSeparatorComponent:e=>a.createElement(yi,null),ListEmptyComponent:a.createElement(Ai,{emptyViewDescriptor:l})}))}const ki=h.a.create({emptyView:{marginTop:92,alignItems:"center"},emptyViewTitle:{color:"#000000",fontSize:17,marginTop:36,fontWeight:"500",textAlign:"center"},emptyViewText:{color:"#8E8E8E",fontSize:15,marginTop:12,marginHorizontal:52,textAlign:"center"},touchableOpacity:{flexDirection:"row",height:"100%",alignItems:"center",flexGrow:1,flexShrink:1,paddingStart:16},renderRowWrapper:Object.assign({flexDirection:"row",alignContent:"center",alignItems:"center",backgroundColor:"#FFFFFF",justifyContent:"space-between"},Ue({ios:{height:50},android:{height:47.5}})),renderRowTitleText:Object.assign({fontSize:17},Ue({ios:{color:"#323130"},android:{color:"#222222"}})),renderRowSubActionView:{width:48,height:"100%",alignItems:"center",justifyContent:"center"}});var Mi=n("QfU7"),Di=n("Xi8U"),Ri=n("A2T2");function Li(e){return{type:"sitemap.pin.unpin.recent",sync:!0,execute({dispatch:t,getState:n}){t(e.PinStatus?Object(Ri.d)(e):Object(Ri.c)(e))}}}var Bi=n("cz9j"),Vi=n("miNs"),Gi=n("nJrx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zi=Object(Gi.a)();function Wi(e){return e&&"true"===e.getAttribute("data-keyboard-nav")}function Xi(e,t){e&&(t&&(t.tabIndex=-1),e.tabIndex=0,e.focus())}function Hi({children:e,closeSitemap:t}){const n=a.createRef();return a.createElement(a.Fragment,null,a.createElement(zt.a,{id:zi,key:"SitemapAccessibilityManager",ref:n,style:Ui.viewStyle,onKeyDown:e=>{!function(e,t=document,n){const a=e.target;if(!a)return;switch(Object(Bi.e)(e.nativeEvent)){case Vi.a.DownArrow:Wi(a)&&Xi(function(e){const t=e.parentElement.nextElementSibling;if(!t)return null;const n=t.querySelector('[data-keyboard-nav="true"]');if(n)return n;const a=t.nextElementSibling&&t.nextElementSibling.nextElementSibling;return a&&a.querySelector('[data-keyboard-nav="true"]')}(a),a);break;case Vi.a.UpArrow:Wi(a)&&Xi(function(e){const t=e.parentElement.previousElementSibling;if(!t)return null;const n=t.querySelector('[data-keyboard-nav="true"]');if(n)return n;const a=t.nextElementSibling&&t.previousElementSibling.previousElementSibling;return a&&a.querySelector('[data-keyboard-nav="true"]')}(a),a);break;case Vi.a.Tab:if(e.shiftKey){if("first"===a.getAttribute("data-keyboard-tab")){const n=t.querySelector('[data-keyboard-tab="last"]');n&&(n.focus(),e.preventDefault())}}else if("last"===a.getAttribute("data-keyboard-tab")){const n=t.querySelector('[data-keyboard-tab="first"]');n&&(n.focus(),e.preventDefault())}break;case Vi.a.Escape:n()}}(e,n.current&&ft.findDOMNode(n.current),t)}},e),a.createElement(G.a,{key:"accessibilityComponent"+zi,rootElementId:zi,shouldManageFocus:!0,isModal:!0}))}const Ui={viewStyle:{height:"100%"}},qi=[Ka.s,Ka.l,Ka.r,Ka.z,si.b,Ka.k,Ka.j];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Yi(e,t){const n=Object($.c)(e,Ka.l),a=Object($.c)(e,t.PinStatus?Ka.z:Ka.r);return String.format(a,n)}function Ki({closeSitemap:e}){const t=Object(l.c)(),n=Object(l.d)(e=>Object(Mi.a)(e,20),qn.e),r=Object(l.d)(Di.g,qn.e),i=Object(ne.a)(qi),o=a.useCallback(()=>t(Object(En.c)(ti.d)),[t]),s=a.useCallback(()=>t(Object(En.c)(ti.b)),[t]),c=a.useCallback(n=>t(function(e,t){return{type:"sitemap.navigate.recent",sync:!0,execute({dispatch:n}){n(Object(zr.d)(e,!0,()=>{n(Object(En.c)(ti.d)),n(Object(En.c)(ti.b)),t()},Gr.b.Other))}}}(n,e)),[e,t]),u=a.useCallback(e=>t(Li(e)),[t]),d=a.useCallback(e=>{t(Li(e)),e===r[r.length-1]&&function(e){const t=document.getElementById(e),n=t&&t.querySelector('[tabindex="0"]');n&&n.focus()}(ti.b)},[t,r]),h=Object($.c)(i,si.b),g=a.useMemo(()=>function(e){const t=Object($.c)(e,Ka.s),n=Object($.c)(e,Ka.j),a=n&&t&&String.format(n,t);return{icon:_.a.Pinned,title:Object($.c)(e,Ka.l),text:a}}(i),[i]),p=a.useMemo(()=>function(e){return{icon:_.a.Recent,title:Object($.c)(e,Ka.s),text:Object($.c)(e,Ka.k)}}(i),[i]);return a.createElement(a.Fragment,null,a.createElement(xi,{modalId:ti.b},a.createElement(Ni,{recents:r,title:Object($.c)(i,Ka.l),closeAction:s,handleAction:c,handleSubAction:d,resourceStrings:i,closeButtonLabel:h,getAriaLabel:Yi,emptyViewDescriptor:g})),a.createElement(xi,{modalId:ti.d},a.createElement(Ni,{recents:n,title:Object($.c)(i,Ka.s),closeAction:o,handleAction:c,handleSubAction:u,resourceStrings:i,closeButtonLabel:h,getAriaLabel:Yi,emptyViewDescriptor:p})))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Qi=[nr.f,Ka.s,Ka.l,nr.m,nr.o,nr.c,nr.i,Ur.h,Ka.a,oi.d,si.b];let Zi;const Ji=function(){let e,t,n,a,r,i;return(o,s,c,l,u,d)=>{let h=!1;return e===o&&t===s&&n===c&&a===l&&r===u&&Object(qn.e)(i,d)||(e=o,t=s,n=c,a=l,r=u,i=d,h=!0),h}}(),$i=function(){let e,t,n;return(a,r,i)=>{const o=Object(Vr.b)(a),s=Object(Vr.c)(a);if(!e||t!==o||n!==s){const c=Object($.b)(a,Ur.h),l=Object(Br.b)(a);if(!l)return e;const u=l.Areas[o],d=u.GroupIds.map(e=>Yr(u.Groups[e],r,i)),h=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n){return{id:"sitemap-home-group",title:void 0,data:[{id:"sitemap-home-subarea",icon:{type:0,value:_.a.Home},title:Object($.b)(t,nr.f),action:()=>{e(Object(Xr.b)()),n()},subAction:{title:Object($.b)(t,Ka.a),icon:{type:0,value:_.a.Forward,flipInRtl:!0},action:()=>{e(Object(Hr.a)(void 0,{source:Gr.b.SiteMap})),n()}}}]}}(r,a,i);d.unshift(h),t=o,n=s,e={subAreaList:d,navigationLabel:c,selectedSubAreaId:s}}return e}}(),eo=function(){let e,t;return(n,a)=>{const r=Object(Vr.b)(n);if(!e||t!==r){const i=Object(hi.a)(n),o=Object(Br.b)(n);if(!o)return e;const s=o.Areas[r],c=s.Titles&&s.Titles.length&&s.Titles[0].Title,l=o.AreaIds.indexOf(r),u=String.format(Object($.b)(n,Ka.i)||"",c);t=r,e={title:c,label:u,action:()=>a(Object(En.d)(ti.a)),titleInitials:Object(gi.b)(c),titleColor:Object(gi.a)(l,i),areaCount:o.AreaIds.length}}return e}}();function to({closeSitemap:e}){const t=Object(l.c)(),n=Object(ne.a)(Qi),r=Object(l.d)(n=>$i(n,t,e)),i=Object(l.d)(e=>eo(e,t)),o=a.useMemo(()=>function(e,t){return{hiddenButtonLabel:Object($.c)(t,si.b),upperCommands:ci(e,t),lowerCommands:li(e,t),commandsLabel:Object($.c)(t,oi.d)||Wt.a}}(t,n),[t,n]),s=1===Object(l.d)(Vr.d);return Ji(r,i,s,e,t,n)&&(Zi=a.createElement(Rr,{subAreaList:r,commandPaneDescriptor:o,areaSwitcherDescriptor:i,isSitemapOpen:s,closeSitemap:e})),Zi}function no(){const e=a.useContext(Ua);return a.createElement(a.Fragment,null,a.createElement(Hi,{closeSitemap:e.closeSidebar},a.createElement(to,{closeSitemap:e.closeSidebar})),a.createElement(Ki,{closeSitemap:e.closeSidebar}),a.createElement(Ti,null))}var ao=n("tOh6"),ro=n("OmkB");function io({children:e,menuContent:t}){const n=Object(l.c)(),r=Object(l.d)(Ie.g),i=1===Object(l.d)(Vr.d),o=a.useCallback((e,t,a)=>{n(Object(ui.f)(e?1:0)),t&&function(e){if(e){const e=document.querySelector('[data-keyboard-tab="first"]');e&&e.focus()}else{const e=document.querySelector('[data-id="navbutton"]');e&&e.focus()}}(e),n(e?Object(ao.a)("sidebar_popup_id",a):Object(ro.a)("sidebar_popup_id"))},[n]),s=Object(l.d)(ji.a);return a.createElement(qa,{isModalOpen:s,setExpandedState:o,isOpen:i,isRTL:r,menuContent:t,isDisabled:s},e)}var oo=n("w1eR"),so=n("GYEz"),co=n("F1Lu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function lo(e,t){if(!e||!t)return!1;if(Object(so.a)(t.getState())===oo.a.Browser)return!1;return new co.a(e,t).isOperationAvailableAndEnabled("navigateBackOutOfApp")}function uo(e,t){if(!e||!t)return;new co.a(e,t).navigateBackOutOfApp()}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ho="Settings_NativeApp_General_TermsOfUse",go="Settings_NativeApp_General_SessionDetails",po="Settings_NativeApp_Alert_Ok",mo="Settings_NativeApp_Screen_Close",bo=["Settings_NativeApp_SettingsScreenTitle","Settings_NativeApp_ProfileScreenTitle","Settings_NativeApp_Personal","Settings_NativeApp_Personal_TimeZone","Settings_NativeApp_Personal_RecordsPerPage","Settings_NativeApp_Personal_Calendar","Settings_NativeApp_Personal_CalendarDefaultView","Settings_NativeApp_Personal_CalendarView_Day","Settings_NativeApp_Personal_CalendarView_Week","Settings_NativeApp_Personal_CalendarView_Month","Settings_Privacy_Statement_Link_Online","Settings_NativeApp_Personal_WorkHours","Settings_NativeApp_Personal_WorkHours_Start","Settings_NativeApp_Personal_WorkHours_End","Settings_NativeApp_Device_Camera","Settings_NativeApp_Device","Settings_NativeApp_General","Settings_NativeApp_Device","Settings_NativeApp_Device_ImageResolution","Settings_NativeApp_Device_ImageResolution_Default","Settings_NativeApp_Device_LocationAndContent","Settings_NativeApp_Device_LocationAndContent_LegalNotice","Settings_NativeApp_Device_Microphone","Settings_NativeApp_Device_OfflineSync","Settings_NativeApp_Device_SavePhoto","Settings_NativeApp_Device_IncreaseToastDuration","Settings_NativeApp_Device_Video","Settings_NativeApp_General",ho,"Settings_NativeApp_General_PrivacyStatement",go,"Settings_NativeApp_Status_Init","Settings_NativeApp_Status_InitError","Settings_NativeApp_Status_Offline","Settings_NativeApp_Status_SaveError"],fo=["Settings_NativeApp_Alert_Title",po,"Settings_NativeApp_Alert_Cancel"];var yo=n("wO8k"),Co=n("QP40"),_o=n("8XVy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const vo=a.createElement(C.a,{icon:_.a.MembersIcon,size:38,color:"#777"}),So=e=>{const t=e.source?a.createElement(_o.a,{style:Oo.picture,source:{uri:e.source}}):vo;return a.createElement(r.a,{style:Oo.pictureShadow},a.createElement(r.a,{style:Oo.pictureFrame},t))},Oo=h.a.create({pictureShadow:{marginTop:70,width:70,height:70,borderRadius:35,shadowColor:"#000",shadowOffset:{width:0,height:0},shadowRadius:1,shadowOpacity:.16},pictureFrame:{width:70,height:70,borderWidth:1,borderColor:"#c7c7cc",borderRadius:35,overflow:"hidden",backgroundColor:"#d1d1d6",justifyContent:"center",alignItems:"center"},picture:{width:70,height:70}}),Io=h.a.create({container:{flex:1,alignItems:"stretch",justifyContent:"center"},innerContainer:{alignItems:"center",justifyContent:"center"},name:{fontSize:17,lineHeight:22,color:"#000",fontWeight:"600",marginTop:24},email:{fontSize:12,lineHeight:20,color:"#605E5C",marginTop:10},org:{fontSize:12,lineHeight:20,color:"#000",marginBottom:48},buttonContainer:{marginBottom:10,minWidth:275,minHeight:44,backgroundColor:"#fff",borderWidth:1,borderColor:"#e1e1e1",borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:0},shadowRadius:3,shadowOpacity:.1,alignItems:"center",justifyContent:"center"},buttonText:{color:"#ff3b30",lineHeight:15,fontSize:13,textAlign:"center"}}),jo=a.memo(e=>{const{email:t,imageUri:n,name:o,onReconfigure:s,onSignOut:c,organizationName:l,reconfigureLabel:u,signOutLabel:d}=e;return a.createElement(r.a,{style:Io.container},a.createElement(r.a,{style:Io.innerContainer},a.createElement(So,{source:n}),a.createElement(i.a,{style:Io.name},o),a.createElement(i.a,{style:Io.email},t),a.createElement(i.a,{style:Io.org},l),a.createElement(x.a,{style:Io.buttonContainer,onPress:c},a.createElement(i.a,{style:Io.buttonText},d)),a.createElement(x.a,{style:Io.buttonContainer,onPress:s},a.createElement(i.a,{style:Io.buttonText},u))))}),Po=[Co.a,Co.b],xo=a.memo(()=>{const e=Object(l.c)(),t=a.useCallback(()=>e(Object(yo.b)()),[e]),n=a.useCallback(()=>e(Object(yo.c)()),[e]),r=Object(ne.a)(Po),i={email:"",imageUri:"",name:Object(l.d)(Ie.t),organizationName:Object(l.d)(Ln.w),onSignOut:n,onReconfigure:t,reconfigureLabel:Object($.c)(r,Co.b),signOutLabel:Object($.c)(r,Co.a)};return a.createElement(jo,Object.assign({},i))}),Eo=["Settings_NativeApp_ProfileScreenTitle",mo],wo=()=>{const e=Object(l.c)(),t=Object(l.e)(),n=a.useContext(Ee.a),r=a.useCallback(()=>{e(Object(En.c)(ti.c)),lo(n,t)&&uo(n,t)},[e,t,n]),i=Object(ne.a)(Eo),o=Object($.c)(i,"Settings_NativeApp_ProfileScreenTitle"),s=Object($.c)(i,mo);return a.createElement(xi,{modalId:ti.c},a.createElement(mi,{title:o,onClosePressed:r,closeButtonLabel:s},a.createElement(xo,null)))};class To extends a.Component{constructor(e){super(e),this._isCurrentlySwiping=!1,this._keepPageOnScreen=()=>{this._animate(1)},this._closePageAndNavigateBack=()=>{this._animate(0,200,this.props.onNavigateBack)},this.state={pageAnimationProgress:new P.a.Value(0)},this._panResponder=yn.a.create({onStartShouldSetPanResponder:e=>!(e.nativeEvent.pageX>50),onMoveShouldSetPanResponder:e=>!(e.nativeEvent.pageX>50),onPanResponderGrant:(e,t)=>{this._isCurrentlySwiping=!0},onPanResponderMove:(e,t)=>{const n=d.a.get("window").width,a=1-t.dx/n;this.state.pageAnimationProgress.setValue(a)},onPanResponderTerminationRequest:(e,t)=>!0,onPanResponderRelease:(e,t)=>{if(this._isCurrentlySwiping){const e=Math.abs(t.vx)>.8,n=t.vx>0,a=d.a.get("window").width;n&&e||t.moveX>=a/2?this._closePageAndNavigateBack():this._keepPageOnScreen()}this._isCurrentlySwiping=!1},onPanResponderTerminate:(e,t)=>{}})}componentDidMount(){this._animate(1,400)}_animate(e,t=200,n){P.a.timing(this.state.pageAnimationProgress,{toValue:e,duration:t,easing:Me.a.out(Me.a.exp)}).start(()=>{n&&n({finished:!0})})}render(){const{backButtonLabel:e,children:t,title:n}=this.props;return a.createElement(r.a,Object.assign({},this._panResponder.panHandlers,{style:h.a.absoluteFill}),a.createElement(P.a.View,{pointerEvents:"none",style:[Ao.darkOverlay,{opacity:this.state.pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:[0,1],extrapolate:"clamp"})}]}),a.createElement(P.a.View,{style:[Ao.pageContainer,{transform:[{translateX:this.state.pageAnimationProgress.interpolate({inputRange:[0,1],outputRange:["100%","0%"],extrapolate:"clamp"})}]}]},a.createElement(mi,{closeIcon:_.a.LeftChevron,title:n,onClosePressed:this._closePageAndNavigateBack,closeButtonLabel:e},t)))}}const Ao=h.a.create({pageContainer:Object.assign(Object.assign({},h.a.absoluteFillObject),{boxShadow:"0px 0px 20px rgba(0,0,0,0.35)",backgroundColor:"#ffffff",zIndex:1}),darkOverlay:Object.assign(Object.assign({},h.a.absoluteFillObject),{backgroundColor:"rgba(0,0,0,0.2)",position:"absolute",top:0,left:0})});var Fo=n("omKH"),No=n("6sVS"),ko=n("RBt5"),Mo=n("mjNO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Do=()=>a.createElement(r.a,{style:Ro.view,importantForAccessibility:"no-hide-descendants",accessibilityElementsHidden:!1},a.createElement(_o.a,{source:{uri:'data:image/svg+xml;utf8,<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.22494 7.22494C9.52487 6.92502 10.0111 6.92502 10.3111 7.22494L14.9577 11.8716C15.2576 12.1715 15.2576 12.6578 14.9577 12.9577L10.3111 17.6043C10.0111 17.9043 9.52487 17.9043 9.22494 17.6043C8.92502 17.3044 8.92502 16.8181 9.22494 16.5182L12.975 12.7682C13.1702 12.5729 13.1702 12.2564 12.975 12.0611L9.22494 8.31107C8.92502 8.01115 8.92502 7.52487 9.22494 7.22494Z" fill="#C4C4C6"/></svg>'},style:Ro.image})),Ro=h.a.create({view:{width:24,height:24,marginEnd:6},image:{width:24,height:24}});function Lo({isFirst:e}){return a.createElement(r.a,{style:[qo.topBorderContainer,{paddingStart:e?0:16}]},a.createElement(r.a,{style:qo.topBorder}))}function Bo(){return a.createElement(r.a,{style:qo.bottomBorder})}function Vo(e){const{subtitle:t}=e;return a.createElement(r.a,{style:qo.titleContainer},a.createElement(Go,Object.assign({},e)),t?a.createElement(zo,Object.assign({},e)):null)}function Go(e){const{disabled:t,label:n,value:o,labelStyle:s}=e;return a.createElement(r.a,{style:qo.labelContainer},a.createElement(i.a,{style:[qo.label,s,t?qo.disabledLabel:{}],numberOfLines:1},n),o?a.createElement(i.a,{style:[qo.value,t?qo.disabledValue:{}],numberOfLines:1},o):null)}function zo(e){const{disabled:t,subtitle:n}=e;return a.createElement(i.a,{style:[qo.subtitle,t?qo.disabledSubtitle:{}],numberOfLines:1},n)}function Wo(e){const{renderAccessory:t}=e;return a.createElement(r.a,{style:qo.accessoryContainer},t())}function Xo(){return a.createElement(r.a,{style:qo.spacer})}function Ho(e){const{disabled:t,onPress:n,showDisclosureIndicator:i,renderAccessory:o,label:s}=e,c=void 0!==n,l=a.createElement(r.a,{style:qo.buttonContent},a.createElement(Vo,Object.assign({},e)),o&&a.createElement(Wo,Object.assign({},e)),i?a.createElement(Do,null):a.createElement(Xo,null));if(!c)return l;const u={accessible:!0,accessibilityLabel:s,accessibilityRole:"button"};return a.createElement(Mo.a,Object.assign({style:[qo.button],disabled:t,onPress:n,underlayColor:"#d9d9d9"},u),l)}function Uo(e){const{subtitle:t,isFirst:n,isLast:i}=e,o={height:t?51:41};return a.createElement(r.a,{style:[qo.container,o]},a.createElement(Lo,{isFirst:n}),a.createElement(Ho,Object.assign({},e)),i&&a.createElement(Bo,null))}const qo=h.a.create({container:{backgroundColor:"transparent",alignItems:"stretch"},topBorderContainer:{alignSelf:"stretch",height:jt.a,backgroundColor:"#fff"},topBorder:{flex:1,backgroundColor:"#c7c7c9"},button:{flex:1,backgroundColor:"#fff"},buttonContent:{flex:1,flexDirection:"row",paddingStart:16,alignItems:"center",backgroundColor:"#fff"},highlight:{backgroundColor:"#d9d9d9"},titleContainer:{flex:1,justifyContent:"space-around",alignSelf:"stretch"},labelContainer:{flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row"},label:{color:"#000",fontSize:15,flexGrow:1,flexShrink:0},disabledLabel:{color:"#8e8e93"},value:{fontSize:15,color:"#8e8e93",textAlign:"right",flexGrow:1,flexShrink:1,marginStart:15},disabledValue:{color:"#aeaeb2"},subtitle:{color:"#8e8e93",fontSize:13},disabledSubtitle:{color:"#aeaeb2"},accessoryContainer:{marginStart:15},spacer:{width:10},bottomBorder:{alignSelf:"stretch",height:jt.a,backgroundColor:"#c7c7c9"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Yo(e){const{render:t,isFirst:n,isLast:i,contentStyle:o}=e;return a.createElement(r.a,{style:Ko.container},a.createElement(Lo,{isFirst:n}),a.createElement(r.a,{style:[Ko.content,o]},t()),i&&a.createElement(Bo,null))}const Ko=h.a.create({container:{backgroundColor:"transparent",alignItems:"stretch",minHeight:40},content:{flex:1,backgroundColor:"#fff",justifyContent:"center",paddingStart:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Qo({message:e}){return a.createElement(r.a,{style:Zo.container},a.createElement(r.a,{style:Zo.toast},a.createElement(i.a,{style:Zo.text},e)))}const Zo=h.a.create({text:{fontSize:14,color:"#FFFFFF"},toast:{backgroundColor:"#222222",borderRadius:4,height:50,width:"100%",justifyContent:"center",paddingHorizontal:15},container:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"flex-end",zIndex:99999,padding:10}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Jo({type:e}){switch(e){case 0:case 1:return a.createElement(O.a,{size:36,color:"#FFF"});case 2:case 3:return a.createElement(r.a,null,a.createElement(C.a,{color:"#FFF",size:36,icon:2===e?_.a.CheckMark:_.a.Cancel}));default:return null}}function $o({text:e}){return e?a.createElement(i.a,{style:ns.text},e):null}function es({useFadeInView:e,duration:t,children:n}){return e?a.createElement(Da,{duration:t,style:ns.overlay,pointerEvents:"box-none"},n):a.createElement(r.a,{style:ns.overlay,pointerEvents:"box-none"},n)}function ts({type:e,title:t,duration:n,closeAction:i,blockTouch:o,displayDelay:s}){const c="ios"===qe();a.useEffect(()=>{n&&i&&setTimeout(()=>i(),n)},[i,n,e]);const[l,u]=a.useState(!s);return a.useEffect(()=>{s&&setTimeout(()=>u(!0),s)},[s]),l?c||0===e?a.createElement(es,{useFadeInView:o,duration:n},a.createElement(r.a,{style:t?ns.container:ns.containerNoTitle},a.createElement(Jo,{type:e}),a.createElement($o,{text:t})),o?a.createElement(vt,{style:ns.touchBlocker}):null):a.createElement(Qo,{message:t}):null}const ns=h.a.create({overlay:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"center",zIndex:99999},touchBlocker:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0)"},container:{paddingTop:20,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:4,width:108,height:108,alignItems:"center"},containerNoTitle:{padding:0,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:4,width:100,height:100,alignItems:"center",justifyContent:"center"},text:{marginTop:12,fontSize:17,color:"#FFF",textAlign:"center"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function as({title:e,textStyle:t}){return a.createElement(i.a,{key:e,style:[ss.title,t],numberOfLines:1},e)}function rs(e){const{section:t,textStyle:n}=e,o=t.footer;if("function"==typeof o){const e=t.key+"-footer";return a.createElement(r.a,{key:e,style:ss.footerContainer},o())}return a.createElement(i.a,{key:o,style:[ss.footer,n]},o)}function is(){return a.createElement(ts,{type:0,blockTouch:!1})}function os(e){const{busy:t,disabled:n,textStyle:i}=e,{title:o,rows:s,footer:c}=e.section,l=s.map((r,i)=>{const o=0===i,c=i===s.length-1;if("CUSTOM"===r.type){const t={key:""+i,render:r.render,disabled:e.disabled||e.busy,isFirst:o,isLast:c};return a.createElement(Yo,Object.assign({},t))}const l=Object.assign(Object.assign({},r),{isFirst:o,isLast:c,disabled:n||t});return a.createElement(Uo,Object.assign({key:i},l))});return a.createElement(r.a,{style:ss.container},o&&a.createElement(as,{key:o,textStyle:i,title:o}),l,c?a.createElement(rs,Object.assign({key:"footer"},e)):null,t&&a.createElement(is,null))}const ss=h.a.create({container:{alignItems:"stretch",marginBottom:28,position:"relative"},title:{marginStart:16,marginBottom:8,color:"#636366",fontSize:12,lineHeight:14},footerContainer:{alignSelf:"stretch"},footer:{marginTop:8,fontSize:12,color:"#636366",marginHorizontal:16}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function cs({textStyle:e,title:t}){return a.createElement(i.a,{key:t,style:[us.title,e],numberOfLines:1},t)}function ls(e){const{section:t,textStyle:n}=e;return a.createElement(r.a,{key:t.key,style:us.container},t.title&&a.createElement(cs,{textStyle:n,title:t.title}),t.render())}const us=h.a.create({container:{alignItems:"stretch",marginBottom:40,position:"relative"},title:{marginStart:16,marginBottom:8,color:"#636366",fontSize:12,lineHeight:14}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ds(e){const{data:t,textStyle:n,scrollViewProps:r,style:i,disabled:o,busy:s}=e,c=t.map((e,t)=>{switch(e.type){case"CUSTOM":return a.createElement(ls,{key:"custom-"+t.toString(),section:e,textStyle:n,disabled:e.disabled||o,busy:e.busy||s});case"SECTION":return a.createElement(os,{key:e.title||t,section:e,textStyle:n,disabled:e.disabled||o,busy:e.busy||s})}});return a.createElement(Xt.a,Object.assign({},r,{style:[hs.scrollview,i]}),c)}const hs=h.a.create({scrollview:{flex:1,alignSelf:"stretch",paddingTop:24}});var gs=n("2CeA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ps(e){const{values:t,enabled:n,selectedIndex:o,onChange:s,label:c}=e,l=!n,u=100/t.length+"%";return a.createElement(r.a,{style:[fs.container,fs.webContainer,l?fs.webContainerDisabled:{}],accessible:!0,accessibilityLabel:c,accessibilityRole:"radiogroup"},t.map((e,n)=>{const r=o===n,c=0===n,d=n===t.length-1,h=[fs.button,{width:u},c?fs.buttonFirst:{},d?fs.buttonLast:{},r?fs.buttonSelected:{}],g=r?"checked":"unchecked";return a.createElement(Mo.a,{key:n,disabled:l,style:h,onPress:()=>!r&&s(n),underlayColor:"#cadef6",accessibilityRole:"radio",accessibilityStates:[g]},a.createElement(i.a,{numberOfLines:1,style:[fs.text,r?fs.textSelected:{}]},e))}))}function ms(e){const{values:t,enabled:n,selectedIndex:i,onChange:o}=e;return a.createElement(r.a,{style:fs.container},a.createElement(gs.a,{values:t,selectedIndex:i,onChange:e=>{const t=e.nativeEvent.selectedSegmentIndex;o(t)},enabled:n}))}function bs(e){return"web"===Xe.a.OS?a.createElement(ps,Object.assign({},e)):a.createElement(ms,Object.assign({},e))}const fs=h.a.create({container:{marginHorizontal:16},webContainer:{display:"flex",flexDirection:"row"},webContainerDisabled:{opacity:.5},button:{alignItems:"center",justifyContent:"center",flexDirection:"row",borderColor:"#007aff",borderWidth:jt.a,borderEndWidth:0,paddingHorizontal:4,overflow:"hidden"},buttonFirst:{borderTopStartRadius:5,borderBottomStartRadius:5},buttonLast:{borderEndWidth:jt.a,borderTopEndRadius:5,borderBottomEndRadius:5},buttonSelected:{backgroundColor:"#007aff"},text:{color:"#007aff",fontSize:13,lineHeight:28},textSelected:{color:"#fff",opacity:.95}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ys extends a.Component{constructor(){super(...arguments),this._renderDefaultView=()=>{const{defaultCalendarView:e,isOffline:t,onChangeDefaultCalendarView:n,strings:r}=this.props,i={values:[r.day,r.week,r.month],selectedIndex:e,onChange:n,enabled:!t};return a.createElement(bs,Object.assign({},i))}}render(){const e=this._generateSettingsData();return a.createElement(ds,{data:e})}_generateSettingsData(){const{endTime:e,isOffline:t,onChangeEndTime:n,onChangeStartTime:r,startTime:i,strings:o,timeOptions:s}=this.props;return[{type:"CUSTOM",title:o.defaultViewTitle,render:this._renderDefaultView},{type:"SECTION",title:o.workHoursTitle,rows:[{type:"ROW",label:o.startTime,renderAccessory:()=>a.createElement(ko.a,{accessibilityLabel:o.startTime,selectedValue:i,onValueChange:r,enabled:!t,style:Cs.picker},s.map(e=>a.createElement(ko.a.Item,{key:e.value,label:e.label,value:e.value})))},{type:"ROW",label:o.endTime,renderAccessory:()=>a.createElement(ko.a,{accessibilityLabel:o.endTime,selectedValue:e,onValueChange:n,enabled:!t,style:Cs.picker},s.map(e=>a.createElement(ko.a.Item,{key:e.value,label:e.label,value:e.value})))}]}]}}const Cs=h.a.create({picker:{fontSize:15,alignContent:"flex-end",borderWidth:0,backgroundColor:"transparent",appearance:"none"}}),_s=[{value:"00:00",label:"12:00 AM"},{value:"00:30",label:"12:30 AM"},{value:"01:00",label:"1:00 AM"},{value:"01:30",label:"1:30 AM"},{value:"02:00",label:"2:00 AM"},{value:"02:30",label:"2:30 AM"},{value:"03:00",label:"3:00 AM"},{value:"03:30",label:"3:30 AM"},{value:"04:00",label:"4:00 AM"},{value:"04:30",label:"4:30 AM"},{value:"05:00",label:"5:00 AM"},{value:"05:30",label:"5:30 AM"},{value:"06:00",label:"6:00 AM"},{value:"06:30",label:"6:30 AM"},{value:"07:00",label:"7:00 AM"},{value:"07:30",label:"7:30 AM"},{value:"08:00",label:"8:00 AM"},{value:"08:30",label:"8:30 AM"},{value:"09:00",label:"9:00 AM"},{value:"09:30",label:"9:30 AM"},{value:"10:00",label:"10:00 AM"},{value:"10:30",label:"10:30 AM"},{value:"11:00",label:"11:00 AM"},{value:"11:30",label:"11:30 AM"},{value:"12:00",label:"12:00 PM"},{value:"12:30",label:"12:30 PM"},{value:"13:00",label:"1:00 PM"},{value:"13:30",label:"1:30 PM"},{value:"14:00",label:"2:00 PM"},{value:"14:30",label:"2:30 PM"},{value:"15:00",label:"3:00 PM"},{value:"15:30",label:"3:30 PM"},{value:"16:00",label:"4:00 PM"},{value:"16:30",label:"4:30 PM"},{value:"17:00",label:"5:00 PM"},{value:"17:30",label:"5:30 PM"},{value:"18:00",label:"6:00 PM"},{value:"18:30",label:"6:30 PM"},{value:"19:00",label:"7:00 PM"},{value:"19:30",label:"7:30 PM"},{value:"20:00",label:"8:00 PM"},{value:"20:30",label:"8:30 PM"},{value:"21:00",label:"9:00 PM"},{value:"21:30",label:"9:30 PM"},{value:"22:00",label:"10:00 PM"},{value:"22:30",label:"10:30 PM"},{value:"23:00",label:"11:00 PM"},{value:"23:30",label:"11:30 PM"}];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const vs=a.memo(()=>{const e=Object(l.c)(),t=a.useCallback(t=>{e(Object(Fo.c)({defaultCalendarView:t}))},[e]),n=a.useCallback(t=>{e(Object(Fo.c)({workDayStartTime:t}))},[e]),r=a.useCallback(t=>{e(Object(Fo.c)({workDayStopTime:t}))},[e]),i=Object(ne.a)(bo),o=Object(l.d)(No.b),s=Object(l.d)(Ie.w);let c=!1;s&&s.dateFormatInfo.ShortTimePattern&&(c="H"===s.dateFormatInfo.ShortTimePattern[0]);const u=!Object(l.d)(ie.b),d={defaultCalendarView:o.defaultCalendarView,endTime:o.workDayStopTime,isOffline:u,onChangeDefaultCalendarView:t,onChangeEndTime:r,onChangeStartTime:n,startTime:o.workDayStartTime,strings:{defaultViewTitle:Object($.c)(i,"Settings_NativeApp_Personal_CalendarDefaultView"),day:Object($.c)(i,"Settings_NativeApp_Personal_CalendarView_Day"),week:Object($.c)(i,"Settings_NativeApp_Personal_CalendarView_Week"),month:Object($.c)(i,"Settings_NativeApp_Personal_CalendarView_Month"),workHoursTitle:Object($.c)(i,"Settings_NativeApp_Personal_WorkHours"),startTime:Object($.c)(i,"Settings_NativeApp_Personal_WorkHours_Start"),endTime:Object($.c)(i,"Settings_NativeApp_Personal_WorkHours_End")},timeOptions:c?_s.map(e=>({label:e.value,value:e.value})):_s};return a.createElement(ys,Object.assign({},d))});var Ss=n("CEpr"),Os=n("d5d1"),Is=n("BpXX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function js(e){const{disabled:t,selected:n,index:o,item:s,onChange:c}=e,{label:l}=s,u=n?"checked":"unchecked";return a.createElement(Mo.a,{key:o,underlayColor:"#d9d9d9",onPress:()=>c(s),disabled:t,style:[xs.button,t?xs.disabled:{}],accessibilityRole:"radio",accessibilityStates:[u]},a.createElement(r.a,{style:[xs.item,0===o?xs.firstItem:{}]},a.createElement(i.a,{numberOfLines:1,style:[xs.text,n?xs.selected:{}]},l),n&&a.createElement(i.a,{importantForAccessibility:"no-hide-descendants",style:xs.checkmark},"✓")))}function Ps(e){const{items:t,disabled:n,onChange:r,selectedValue:i,label:o}=e;return a.createElement(Xt.a,{style:xs.scrollView,accessible:!0,accessibilityLabel:o,accessibilityRole:"radiogroup"},t.map((e,t)=>{const o={item:e,selected:e.value===i,index:t,onChange:r,disabled:n};return a.createElement(js,Object.assign({key:t},o))}))}const xs=h.a.create({scrollView:{backgroundColor:"#fff"},scrollViewBorder:{height:jt.a,backgroundColor:"#c7c7c9"},button:{paddingStart:16},disabled:{opacity:.5},item:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderTopWidth:jt.a,borderColor:"#c7c7c9",height:40,paddingEnd:10},firstItem:{borderColor:"transparent"},text:{fontSize:15,flexGrow:1,flexShrink:1},selected:{color:"#007aff"},checkmark:{fontSize:15,color:"#007aff",marginStart:15,marginEnd:6}}),Es=["Settings_NativeApp_Device_ImageResolution","Settings_NativeApp_Device_ImageResolution_Default"],ws={[Ss.a.Res640x480]:"640 x 480",[Ss.a.Res1024x768]:"1024 x 768",[Ss.a.Res1600x1200]:"1600 x 1200",[Ss.a.Res2048x1536]:"2048 x 1536",[Ss.a.Res2592x1936]:"2592 x 1936"};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Ts(e){const t=[{label:e,value:Ss.a.DeviceDefault.toString()}];return Object.keys(ws).forEach(n=>{const a=parseInt(n,10);t.push({label:As(a,e),value:n})}),t}function As(e,t){if(e===Ss.a.DeviceDefault)return t;const n=ws[e];if(!n)throw new Error("Unrecognized image resolution "+e);return n}const Fs=a.memo(()=>{const e=Object(l.c)(),t=Object(ne.a)(Es),n=Object($.c)(t,"Settings_NativeApp_Device_ImageResolution"),r=Object($.c)(t,"Settings_NativeApp_Device_ImageResolution_Default"),i=a.useCallback(t=>{const n={camera:{featureName:"camera",imageRes:parseInt(t.value,10)}};e(Object(Is.a)(n))},[e]);return a.createElement(Ps,{selectedValue:Object(l.d)(Os.b)+"",items:Ts(r),onChange:i,label:n})}),Ns=["Settings_NativeApp_Personal_RecordsPerPage"],ks=[{label:"25",value:"25"},{label:"50",value:"50"},{label:"75",value:"75"},{label:"100",value:"100"},{label:"250",value:"250"}],Ms=a.memo(()=>{const e=Object(l.c)(),t=Object(ne.a)(Ns),n=a.useCallback(t=>{const n=parseInt(t.value,10);e(Object(Fo.c)({recordsPerPage:n}))},[e]),r=!Object(l.d)(ie.b);return a.createElement(Ps,{selectedValue:Object(l.d)(No.b).recordsPerPage+"",items:ks,onChange:n,label:Object($.c)(t,"Settings_NativeApp_Personal_RecordsPerPage"),disabled:r})}),Ds=e=>a.createElement(r.a,{style:Rs.container},a.createElement(i.a,{style:[Rs.label,Rs.text]},e.label),a.createElement(i.a,{style:Rs.text},e.value)),Rs=h.a.create({container:{alignItems:"center",marginBottom:16},label:{fontWeight:"600"},text:{textAlign:"center",fontSize:13,lineHeight:16,userSelect:"all"}}),Ls=h.a.create({scrollableContent:{flex:1,alignItems:"center",paddingTop:60,paddingLeft:16,paddingRight:16,paddingBottom:16},productName:{fontSize:17,lineHeight:22,fontWeight:"600",marginBottom:9},version:{fontSize:13,lineHeight:16,fontWeight:"600",textAlign:"center"},detailsContainer:{marginTop:31,marginBottom:31}}),Bs=a.memo(e=>{const{details:t,productName:n,updatesDescription:o}=e;return a.createElement(Xt.a,null,a.createElement(r.a,{style:Ls.scrollableContent},a.createElement(i.a,{style:Ls.productName},n),a.createElement(i.a,{style:Ls.version},o),a.createElement(r.a,{style:Ls.detailsContainer},t.map(({label:e,value:t})=>a.createElement(Ds,{key:e+t,label:e,value:t})))))});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var Vs=n("hSpC"),Gs=n("Pr02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const zs=a.memo(()=>{const e=Object(ne.a)(Gs.a),t=a.useContext(Ee.a),n=[Object(l.d)(t=>Vs.h(t,e),l.b),Object(l.d)(t=>Vs.a(t,e),l.b),Vs.c(e),Object(l.d)(t=>Vs.e(t,e),l.b),Vs.i(t,e),Vs.d(t,e)],r={productName:Object(l.d)(t=>Vs.f(t,e)),updatesDescription:Object(l.d)(t=>Vs.g(t,e)),details:n};return a.createElement(Bs,Object.assign({},r))}),Ws=["Settings_NativeApp_Personal_TimeZone"];function Xs(e,t){const n=e.bias,a=t.bias;if(n!==a)return n-a;const r=e.timeZoneCode,i=t.timeZoneCode;return r!==i?r-i:0}const Hs=a.memo(()=>{const e=Object(l.c)(),t=Object(ne.a)(Ws),n=a.useCallback(t=>{const n=parseInt(t.value,10);if(isNaN(n))throw new Error("Invalid time zone code: "+t.value);e(Object(Fo.c)({timeZoneCode:n}))},[e]),r=(i=Object(l.d)(Ie.m),Object.keys(i).map(e=>i[e]).sort(Xs).map(e=>({label:e.userInterfaceName,value:""+e.timeZoneCode})));var i;const o=!Object(l.d)(ie.b);return a.createElement(Ps,{selectedValue:""+Object(l.d)(No.b).timeZoneCode,items:r,onChange:n,label:Object($.c)(t,"Settings_NativeApp_Personal_TimeZone"),disabled:o})});var Us=n("ORpD"),qs=n("3I29"),Ys=n("8Mff"),Ks=n("e+ib"),Qs=n("NAQz"),Zs=n("iuag");function Js(e){const{value:t,onValueChange:n,label:r,disabled:i}=e,o=Object.assign(Object.assign(Object.assign({},ec.container),t&&ec.containerOn),i&&ec.containerDisabled),s=Object.assign(Object.assign({},ec.slider),t&&ec.sliderOn);return a.createElement("div",{style:o},a.createElement("input",{"aria-label":r,checked:t,disabled:i,onChange:e=>{const t=e.target;n(t.checked)},style:ec.checkbox,type:"checkbox"}),a.createElement("div",{style:s}))}function $s(e){return"web"===Xe.a.OS?a.createElement(Js,Object.assign({},e)):a.createElement(Zs.a,Object.assign({},e))}const ec={container:{borderWidth:2,borderStyle:"solid",borderRadius:14,boxSizing:"border-box",height:28,width:46,position:"relative",userSelect:"none",cursor:"pointer",opacity:1,backgroundColor:"#fff",borderColor:"#e6e6e6",transition:"background-color 0.2s, border-color 0.2s"},containerOn:{backgroundColor:"#34c759",borderColor:"#34c759"},containerDisabled:{opacity:.5,cursor:"default"},slider:{backgroundColor:"#fff",borderRadius:"100%",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.3), 0px 5px 10px rgba(0, 0, 0, 0.1)",display:"flex",position:"relative",left:0,height:24,width:24,transition:"left 0.2s"},sliderOn:{left:18},checkbox:{opacity:0,position:"absolute",zIndex:999,top:0,margin:0,height:"100%",width:"100%"}};var tc=n("2o7a");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function nc({title:e,message:t,cancelLabel:n,cancel:i,confirmLabel:o,confirm:s}){return a.createElement(tc.a,{title:e,message:t,contentHeight:96,buttons:e=>a.createElement(r.a,{style:ac.buttonContainer},a.createElement(r.a,{style:ac.separator}),a.createElement(b.a,{title:n,onPress:()=>e(i),style:rc}),a.createElement(r.a,{style:ac.separator}),a.createElement(b.a,{title:o,onPress:()=>e(s),style:ac.button,textStyle:{fontWeight:"500"}}))})}const ac=h.a.create({buttonContainer:{flexDirection:"column",flexGrow:0,flexBasis:"auto",height:88},button:{flexBasis:0,flexGrow:1,flexDirection:"row",alignItems:"center",alignSelf:"stretch",justifyContent:"center",height:44},separator:{width:"100%",height:jt.a,backgroundColor:tc.b}}),rc=h.a.flatten([ac.button,{color:"#FF3B30"}]);class ic extends a.PureComponent{constructor(e){super(e),this._confirmChangeSetting=(e,t)=>{t?this.setState({settingForConfirmation:e,showConfirmationDialog:!0}):this.props.onSettingChange(e,t)},this._onConfirmedAllow=()=>{this.props.onSettingChange(this.state.settingForConfirmation,!0),this._hideConfirmationDialog()},this._hideConfirmationDialog=()=>{this.setState({settingForConfirmation:null,showConfirmationDialog:!1})},this.state={settingForConfirmation:null,showConfirmationDialog:!1}}render(){const{alertCancel:e,alertOk:t,alertTitle:n,confirmAllowUserContent:i}=this.props.strings;return a.createElement(a.Fragment,null,a.createElement(r.a,{style:oc.container},a.createElement(ds,{style:oc.settings,data:this._generateSettingsData()})),this.state.showConfirmationDialog&&a.createElement(nc,{cancel:this._hideConfirmationDialog,cancelLabel:e,confirm:this._onConfirmedAllow,confirmLabel:t,message:i,title:n}))}_generateSettingsData(){return[this._generateOrgSectionData(),this._generateDeviceSectionData(),this._generateGeneralSectionData()]}_generateOrgSectionData(){const{didFailInitPersonalSettings:e,isBusy:t,isOffline:n,organizationName:a,recordsPerPage:r,showCalendar:i,showRecordsPerPagePicker:o,showTimeZonePicker:s,strings:c,timeZone:l}=this.props,u=t||n||e,d={type:"SECTION",title:c.orgSettingsTitle.replace("{0}",a),disabled:u,busy:t,rows:[{type:"ROW",label:c.timeZone,value:u?null:l,showDisclosureIndicator:!0,onPress:u?null:s},{type:"ROW",label:c.calendar,showDisclosureIndicator:!0,onPress:u?null:i},{type:"ROW",label:c.recordsPerPage,value:u?null:r.toString(),showDisclosureIndicator:!0,onPress:u?null:o}]};if(u){let t="";n?t=c.statusOffline:e&&(t=c.statusInitError),d.footer=t}return d}_generateDeviceSectionData(){const{allowCamera:e,allowCameraRoll:t,allowLocation:n,allowMicrophone:r,allowOfflineSync:i,allowVideo:o,canWorkOffline:s,longToastDuration:c,onSettingChange:l,photoResolution:u,showPhotoResolutionPicker:d,strings:h}=this.props,g=e=>l("camera",e),p=e=>l("cameraRoll",e),m=e=>this._confirmChangeSetting("geolocation",e),b=e=>l("longToastDuration",e),f=e=>this._confirmChangeSetting("microphone",e),y=e=>l("offlineSync",e),C=e=>this._confirmChangeSetting("video",e),_=[{type:"ROW",label:h.location,renderAccessory:()=>a.createElement($s,{value:n,label:h.location,onValueChange:m})},{type:"ROW",label:h.camera,renderAccessory:()=>a.createElement($s,{value:e,label:h.camera,onValueChange:g})},{type:"ROW",label:h.photoLibrary,renderAccessory:()=>a.createElement($s,{value:t,label:h.photoLibrary,onValueChange:p})},{type:"ROW",label:h.photoResolution,value:u.toString(),showDisclosureIndicator:!0,onPress:d},{type:"ROW",label:h.video,renderAccessory:()=>a.createElement($s,{value:o,label:h.video,onValueChange:C})},{type:"ROW",label:h.microphone,renderAccessory:()=>a.createElement($s,{value:r,label:h.microphone,onValueChange:f})},{type:"ROW",label:h.longToastDuration,renderAccessory:()=>a.createElement($s,{value:c,label:h.longToastDuration,onValueChange:b})}];return s&&_.push({type:"ROW",label:h.offlineSync,renderAccessory:()=>a.createElement($s,{value:i,label:h.offlineSync,onValueChange:y})}),{type:"SECTION",title:h.deviceSettingsTitle,rows:_}}_generateGeneralSectionData(){const{onPrivacyStatementPress:e,onTermsOfUsePress:t,strings:n}=this.props;return{type:"SECTION",title:n.generalSettingsTitle,rows:[{type:"ROW",label:n.termsOfUse,onPress:t},{type:"ROW",label:n.privacyStatement,onPress:e},{type:"ROW",label:n.sessionDetails,showDisclosureIndicator:!0,onPress:this.props.showSessionDetails}]}}}const oc=h.a.create({container:{flex:1,alignItems:"stretch",justifyContent:"flex-start"},settings:{flexBasis:"auto"},itemTitle:{color:"#323130"},itemTitleDisabled:{color:"#a19f9d"},itemValue:{fontSize:18,color:"#a19f9d",backgroundColor:"#f0f"},spinnerOverlay:{position:"absolute",left:0,right:0,top:0,bottom:0,alignItems:"center",justifyContent:"center"},spinnerContainer:{position:"absolute",padding:16,backgroundColor:"rgba(51, 51, 51, 0.9)",borderRadius:8}});var sc=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function cc(e){const t=Object(ae.p)(e),n=!sc.a.isNullOrEmpty(Object(Ie.e)(e)),a=t!==Ys.a.Default,r=Object(ae.q)(e)!==he.a.Initializing,i=Object(_e.a)(e);return n&&a&&r&&i}function lc(e){return Object(Os.e)(e,"camera")}function uc(e){return Object(Os.e)(e,"geolocation")}function dc(e){return Object(Os.e)(e,"microphone")}function hc(e){return Object(Os.e)(e,"video")}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const gc=[...bo,...fo,Qs.i,Qs.l,Qs.m,Qs.n,Qs.o];const pc=a.memo(e=>{const[t,n]=a.useState(!1),[r,i]=a.useState(!1),o=Object(l.c)(),s=Object(ne.a)(gc),c=a.useCallback((e,t)=>function(e,t,n){const a={};switch(t){case"camera":case"geolocation":case"microphone":case"video":a[t]={featureName:t,isEnabled:n},e(Object(Is.a)(a));break;case"cameraRoll":a.camera={featureName:"camera",savePhoto:n},e(Object(Is.a)(a));break;case"offlineSync":e(Object(Ks.c)(n));break;case"longToastDuration":const r={toastNotification:{toastNotificationDisplaySpeed:n?qs.a.Slow:qs.a.Normal}};e(Object(Us.b)(r));break;default:throw new Error("Unrecognized setting: "+t)}}(o,e,t),[o]);a.useEffect(()=>{n(!0),o(Object(Fo.b)()).then(()=>n(!1)).catch(e=>{i(!0),n(!1)})},[o]);const{defaultCalendarView:u,recordsPerPage:d,timeZoneCode:h,workDayStartTime:g,workDayStopTime:p}=Object(l.d)(No.b),m=Object(l.d)(Ie.m),b=m[h]&&m[h].userInterfaceName||"",f=Object(l.d)(ae.p)===Ys.a.Enabled,y=Object(l.d)(No.a).toastNotificationDisplaySpeed===qs.a.Slow,C=Object(l.d)(Ln.B)||(_=s,Object($.c)(_,Qs.i));var _;const v=a.useCallback(()=>o(Object(xe.a)(C)),[o,C]),S=function(e){const t=He.a.getInstance();let n=Qs.o;t.get_IsIOS()&&t.get_isIPad()?n=Qs.n:t.get_IsAndroid()&&(n=t.get_IsAndroidPhone()?Qs.m:Qs.l);return"https://"+Object($.c)(e,n)}(s),O=a.useCallback(()=>o(Object(xe.a)(S)),[o,S]),I={allowCamera:Object(l.d)(lc),allowCameraRoll:Object(l.d)(Os.f),allowLocation:Object(l.d)(uc),allowMicrophone:Object(l.d)(dc),allowOfflineSync:f,allowVideo:Object(l.d)(hc),canWorkOffline:Object(l.d)(cc),defaultCalendarView:u,didFailInitPersonalSettings:r,isBusy:t,longToastDuration:y,isOffline:!Object(l.d)(ie.b),onPrivacyStatementPress:v,onSettingChange:c,onTermsOfUsePress:O,organizationName:Object(l.d)(Ln.w),photoResolution:As(Object(l.d)(Os.b),Object($.c)(s,"Settings_NativeApp_Device_ImageResolution_Default")),recordsPerPage:d,showCalendar:e.onNavigateToCalendar,showPhotoResolutionPicker:e.onNavigateToPhotoResolutionPicker,showRecordsPerPagePicker:e.onNavigateToRecordsPerPagePicker,showSessionDetails:e.onNavigateToSessionDetails,showTimeZonePicker:e.onNavigateToTimeZonePicker,strings:{alertCancel:Object($.c)(s,"Settings_NativeApp_Alert_Cancel"),alertOk:Object($.c)(s,po),alertTitle:Object($.c)(s,"Settings_NativeApp_Alert_Title"),calendar:Object($.c)(s,"Settings_NativeApp_Personal_Calendar"),camera:Object($.c)(s,"Settings_NativeApp_Device_Camera"),confirmAllowUserContent:Object($.c)(s,"Settings_NativeApp_Device_LocationAndContent_LegalNotice"),deviceSettingsTitle:Object($.c)(s,"Settings_NativeApp_Device"),generalSettingsTitle:Object($.c)(s,"Settings_NativeApp_General"),location:Object($.c)(s,"Settings_NativeApp_Device_LocationAndContent"),longToastDuration:Object($.c)(s,"Settings_NativeApp_Device_IncreaseToastDuration"),microphone:Object($.c)(s,"Settings_NativeApp_Device_Microphone"),offlineSync:Object($.c)(s,"Settings_NativeApp_Device_OfflineSync"),orgSettingsTitle:Object($.c)(s,"Settings_NativeApp_Personal"),photoLibrary:Object($.c)(s,"Settings_NativeApp_Device_SavePhoto"),photoResolution:Object($.c)(s,"Settings_NativeApp_Device_ImageResolution"),privacyStatement:Object($.c)(s,"Settings_NativeApp_General_PrivacyStatement"),recordsPerPage:Object($.c)(s,"Settings_NativeApp_Personal_RecordsPerPage"),sessionDetails:Object($.c)(s,go),statusInitError:Object($.c)(s,"Settings_NativeApp_Status_InitError"),statusOffline:Object($.c)(s,"Settings_NativeApp_Status_Offline"),termsOfUse:Object($.c)(s,ho),timeZone:Object($.c)(s,"Settings_NativeApp_Personal_TimeZone"),video:Object($.c)(s,"Settings_NativeApp_Device_Video")},timeZone:b,workDayStartTime:g,workDayStopTime:p};return a.createElement(ic,Object.assign({},I))}),mc=[...bo,"Settings_NativeApp_Screen_Back",mo],bc=`#${ti.e} > [role="dialog"]`,fc=()=>{const[e,t]=a.useState(!1),[n,r]=a.useState(!1),[i,o]=a.useState(!1),[s,c]=a.useState(!1),[u,d]=a.useState(!1),h=Object(l.c)(),g=Object(l.e)(),p=a.useContext(Ee.a),m=a.useCallback(()=>{h(Object(En.c)(ti.e)),lo(p,g)&&uo(p,g)},[h,g,p]),b=a.useCallback(()=>o(!0),[]),f=a.useCallback(()=>o(!1),[]),y=a.useCallback(()=>c(!0),[]),C=a.useCallback(()=>c(!1),[]),_=a.useCallback(()=>t(!0),[]),v=a.useCallback(()=>t(!1),[]),S=a.useCallback(()=>r(!0),[]),O=a.useCallback(()=>r(!1),[]),I=a.useCallback(()=>d(!0),[]),j=a.useCallback(()=>d(!1),[]),P=Object(ne.a)(mc),x=Object($.c)(P,"Settings_NativeApp_SettingsScreenTitle"),E=Object($.c)(P,"Settings_NativeApp_Personal_Calendar"),w=Object($.c)(P,go),T=Object($.c)(P,"Settings_NativeApp_Device_ImageResolution"),A=Object($.c)(P,"Settings_NativeApp_Personal_RecordsPerPage"),F=Object($.c)(P,"Settings_NativeApp_Personal_TimeZone"),N=Object($.c)(P,"Settings_NativeApp_Screen_Back"),k=Object($.c)(P,mo);return a.useEffect(()=>{yc(E,n)},[n]),a.useEffect(()=>{yc(w,e)},[e]),a.useEffect(()=>{yc(T,i)},[i]),a.useEffect(()=>{yc(A,s)},[s]),a.useEffect(()=>{yc(F,u)},[u]),a.createElement(xi,{modalId:ti.e},a.createElement(mi,{title:x,onClosePressed:m,closeButtonLabel:k},a.createElement(pc,{onNavigateToCalendar:S,onNavigateToSessionDetails:_,onNavigateToPhotoResolutionPicker:b,onNavigateToRecordsPerPagePicker:y,onNavigateToTimeZonePicker:I})),n&&a.createElement(To,{title:E,backButtonLabel:N,onNavigateBack:O},a.createElement(vs,null)),e&&a.createElement(To,{title:w,backButtonLabel:N,onNavigateBack:v},a.createElement(zs,null)),i&&a.createElement(To,{title:T,backButtonLabel:N,onNavigateBack:f},a.createElement(Fs,null)),s&&a.createElement(To,{title:A,backButtonLabel:N,onNavigateBack:C},a.createElement(Ms,null)),u&&a.createElement(To,{title:F,backButtonLabel:N,onNavigateBack:j},a.createElement(Hs,null)))};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function yc(e,t){t?function(e){const t=document.getElementById(ti.e);if(!t||!e)return;const n=t.querySelector(`[aria-label="${e}"][role=dialog] [role=button]`);n&&n.focus()}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e):function(e){const t=document.getElementById(ti.e);if(!t||!e)return;const n=t.querySelector(`[aria-label="${e}"][role=button]`);n&&n.focus()}(e);const n=document.querySelector(bc);n&&n.setAttribute("aria-hidden",t.toString())}class Cc extends a.PureComponent{constructor(e){super(e),this._backNavigations=0,this._onBeforeNavigateBack=(e=!1)=>(this.setState({isNavigatingToRoot:e}),this.props.preNavigateBack({targetBrowsingContext:this.props.browsingContextId})),this._onNavigateBack=(e=!1)=>{this.props.navigateBack(e&&{backToRoot:!0,targetBrowsingContext:this.props.browsingContextId}),Object(Er.a)(),this.setState({isNavigatingToRoot:!1})},this.state={isNavigatingToRoot:!1}}componentDidUpdate(e){e.pageStack&&(this.props.pageStack.length===e.pageStack.length-1?3==++this._backNavigations&&(this._backNavigations=0,this.props.userNavigatedBackMultipleTimes()):this.props.pageStack.length===e.pageStack.length+1&&(this._backNavigations=0))}render(){const{isNavigatingToRoot:e}=this.state,{canNavigateBackToHost:t,pageStack:n,pageDefinitions:i,currentPageError:o}=this.props,s=n.length-1;return a.createElement(r.a,{style:vc.container},n.map((n,r)=>{const c=0===r&&!t,l="android"===qe()||c||t&&0===r;return a.createElement(a.Fragment,{key:r},a.createElement(_c,{shouldRenderSidebar:c},a.createElement(Pr,{key:r,canSwipeBack:!l,error:o&&r===s,isRootPage:c,isTopPage:r===s,isActive:r===s,isNextOnStack:e?0===r:r===s-1,route:n,definition:i[n],onBeforeNavigateBack:this._onBeforeNavigateBack,onNavigateBack:this._onNavigateBack,routeIndex:r})),this.props.isNavigating?a.createElement(ts,{type:0,blockTouch:!0,displayDelay:1e3}):null)}),a.createElement(wo,null),a.createElement(fc,null))}}function _c({children:e,shouldRenderSidebar:t}){return t?a.createElement(io,{menuContent:a.createElement(no,null)},e):e}const vc=h.a.create({container:{flex:1}});function Sc(e){if(e.appShellState&&e.appShellState.indicatorNotificationState){const t=e.appShellState.indicatorNotificationState.indicatorNotifications;return t&&t[0]}return null}var Oc=n("Zn5P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Ic=["UCI_Progress_Failure","UCI_Progress_Saving","UCI_Progress_Success","UCI_Progress_Loading"];function jc(e,t){switch(t){case 1:return Object($.c)(e,"UCI_Progress_Failure");case 0:return Object($.c)(e,"UCI_Progress_Success");default:return null}}function Pc(e){switch(e){case 1:return 3;case 0:return 2;default:return null}}function xc({topPageId:e}){const t=Object(l.c)(),n=Object(ne.a)(Ic),r=Object(l.d)(t=>Object(te.jb)(t,e)),i=Object(l.d)(Sc),o=a.useCallback(()=>{i&&t(Object(Oc.d)(i.id))},[t,i]);return r?a.createElement(ts,{key:"saving",type:1,title:Object($.c)(n,"UCI_Progress_Saving")}):i?a.createElement(ts,{key:i.id,closeAction:o,duration:2e3,type:Pc(i.type),title:jc(n,i.type)}):null}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ec=!1;function wc(){const e=a.useRef(null),t=e.current;return a.useEffect(()=>{if(Ec||null==t)return;const e=ft.findDOMNode(t);if(!e)return;const n=e.className,a=document.getElementById("react-native-stylesheet");if(a){let e="";const t=a.sheet.rules,r=t.length;for(let a=0;a<r;a++){const r=t[a];if(r.selectorText.indexOf(n)>-1){e=r.selectorText.trim(),r.style.removeProperty("z-index");break}}if(""!==e){const t=document.createElement("style");document.head.appendChild(t);const n=t.sheet;n.insertRule('\ndiv[id$="_innerPopup"] > div {\n\tmax-height: calc(100% - env(safe-area-inset-top)) !important;\n\tmargin-top: env(safe-area-inset-top) !important;\n}'),n.insertRule('\nbody > section[openedpopups][id*="Lookup"] {\n  margin-top: env(safe-area-inset-top) !important;\n}'),n.insertRule("\n#cardfeedcontainerwrapper {\n  padding-top: env(safe-area-inset-top);\n  margin-left: 0 !important;\n}"),n.insertRule(`\ndiv[role="dialog"]:not(${e}) {\n  border-top: env(safe-area-inset-top) solid rgba(0,0,0,0);\n  -webkit-clip-path: inset(env(safe-area-inset-top) 0 0 0);\n  clip-path: inset(env(safe-area-inset-top) 0 0 0);\n}`),n.insertRule("\ndiv#__flyoutRootNode_tbxMenu > div > div {\n  margin-top: env(safe-area-inset-top);\n}"),n.insertRule("\n@media (max-width: 480px) {\ndiv#toastNotificationRoot {\t\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tmargin-top: env(safe-area-inset-top);\n}\n}"),n.insertRule("\ndiv#popupNotificationListRoot {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tmargin-top: env(safe-area-inset-top);\n}"),Ec=!0}}},[t]),a.createElement(r.a,{ref:e,style:{display:"none"}})}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Tc({pageDefinitions:e}){const t=Object(l.c)(),n=a.useCallback(e=>{t(Object(fr.a)(e))},[t]),r=a.useCallback(e=>t(Object(fr.c)(e)),[t]),i=Object(l.d)(e=>Object(yr.d)(e).history.map(e=>e.state.pageId),l.b),o=Object(l.d)(xt.f),s=Object(l.d)(yr.e),c=Object(l.d)(xt.h),u=a.useCallback(()=>t(Object(er.e)()),[t]),d=Object(l.d)(xt.g),h=a.useMemo(()=>new wn(t),[t]),g=Object(l.e)(),p=a.useContext(Ee.a);return a.createElement(a.Fragment,null,a.createElement(wc,null),a.createElement(Tn.Provider,{value:{NativeFlyoutManager:h}},a.createElement(Cc,{currentPageError:c,pageStack:i,pageDefinitions:e,navigateBack:n,preNavigateBack:r,browsingContextId:s,userNavigatedBackMultipleTimes:u,isNavigating:d,canNavigateBackToHost:lo(p,g)})),a.createElement(xc,{topPageId:o}))}var Ac=n.p+"resources/images/ChevronDown.svg?v=1.4.9962-v91onpremise";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Fc({text:e,style:t}){return a.createElement(r.a,{style:{display:"flex",flexDirection:"row"}},a.createElement(i.a,{numberOfLines:1,style:t},e),a.createElement(r.a,{style:{paddingLeft:8,paddingTop:4,flexGrow:0,flexBasis:"auto",alignSelf:"center"}},a.createElement(C.a,{type:1,icon:Ac,size:16,color:t.color||"#FFF"})))}const Nc=a.memo((function({items:e,selectedItemId:t,onChange:n,titleStyle:r}){const{anchorPoint:i,updateAnchorPoint:o,setAnchorPoint:s}=Ot(),[c,l,u]=Ca(!1,o),d=e.find(e=>e.value===t);return d?a.createElement(a.Fragment,null,a.createElement(x.a,{ref:s,onPress:l,style:kc.container},a.createElement(Fc,{text:d.text,style:r})),c&&a.createElement(ba,{top:i+8,items:e,selectedItem:d.value,onChange:e=>{n(e),u(!1)},close:()=>u(!1)})):null})),kc=h.a.create({container:{maxWidth:"100%"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Mc(){const[e,t]=a.useState([]);return[e,a.useCallback(e=>(t(t=>[...t,e]),()=>t(t=>t.filter(t=>t!==e))),[])]}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Dc({children:e}){const[t,n]=Mc(),[r,i]=Mc(),[o,s]=a.useState(44),c=a.useMemo(()=>({scroll:(e,n,a)=>t.map(t=>t(e,n,a)),onScroll:n,scrollEnd:e=>r.map(t=>t(e)),onScrollEnd:i,nativeHeaderHeight:o,setNativeHeaderHeight:s}),[i,n,o,r,t]);return a.createElement(Le.Provider,{value:c},e)}var Rc=n("Gilj");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Lc({children:e,id:t,isModalOpen:n,closeAction:r,onShow:i}){const[o,s]=a.useState(n),c=a.useCallback(()=>{i&&i(),s(!0)},[s,i]),l=a.useCallback(()=>{s(!1)},[s]);return o||n?a.createElement(Ct.a,{onModalShow:c,onModalHide:l,animationIn:"slideInUp",animationInTiming:300,animationOut:"slideOutDown",isVisible:n,style:Bc.modal},a.createElement(zt.a,{key:"flyout",id:t,style:{flexDirection:"column",flexGrow:1,maxHeight:"100%"}},e),a.createElement(G.a,{key:"accessibilityComponent",rootElementId:t,shouldManageFocus:!0,isModal:!0,keyboardShortcuts:[new Rc.a([Vi.a.Escape],()=>r(),!0,void 0,void 0)]})):null}const Bc=h.a.create({modal:{margin:0}});var Vc=n("bq0x"),Gc=n("HhsT"),zc=n("9gu/"),Wc=n("1yY9"),Xc=n("cfbi"),Hc=n("ruPX");const Uc=[Wa.n,Wa.o];
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function qc({quickCreateForm:e,closeAction:t}){const[n,i]=a.useState(!1),o=a.useCallback(()=>{window.requestAnimationFrame(()=>i(!0))},[i]);return a.createElement(Lc,{id:"qcf",isModalOpen:!0,closeAction:t,onShow:o},a.createElement(U,{barStyle:"dark-content",backgroundColor:"#FFF"}),a.createElement(Va,null),a.createElement(r.a,{style:Yc.formBodyContainer},n&&e))}const Yc=h.a.create({formBodyContainer:{flexGrow:1,flexShrink:1,height:"100%",backgroundColor:"#ffffff"}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Kc({pageId:e,quickCreateForm:t}){const n=mr(),r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(l.c)(),n=Object(l.d)(t=>Object(Vc.a)(t,e)),r=a.useCallback(()=>t(Object(Gc.a)(e)),[t,e]),i=a.useCallback(()=>t(Object(zc.a)(e,n)),[t,n,e]);return a.useMemo(()=>({isDirty:!0,isInCreateMode:!0,save:r,discard:i}),[i,r])}(e),i=function(e){const t=Object(l.c)(),n=Object(l.d)(t=>Object(at.g)(t,e)),r=Object(ne.a)(Uc);return a.useMemo(()=>[{save:()=>t(Object(Gc.a)(e)).then(n=>t(Object(Hc.a)(Xc.a,{entityTypeName:n.etn,id:n.id},e))),label:r[Wa.o]},{save:()=>t(Object(Wc.a)(n,e)),label:r[Wa.n]}],[t,e,n,r])}(e),o=Object(l.c)(),s=a.useMemo(()=>new wn(o),[o]),c=a.useMemo(()=>Object.assign(Object.assign({},r),{pageContentId:it(e),supportsScrolling:!1,additionalSaveActions:i}),[i,e,r]);return a.createElement(gr.Provider,{value:n},a.createElement(hr.Provider,{value:dr},a.createElement(Tn.Provider,{value:{NativeFlyoutManager:s}},a.createElement(dt.Provider,{value:c},a.createElement(qc,{quickCreateForm:t,closeAction:r.discard})))))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Qc({flyoutCommand:e,setFlyoutCommand:t,commandBarStatus:n,setCommandBarStatus:r,flyoutOptions:i,overflowListCommandControls:o,webResourcePath:s,moreCommands:c,executeCommand:l}){return a.createElement(a.Fragment,null,a.createElement(x.a,{onPress:()=>{n===An.none?r(An.drawerExpanded):r(An.none)},style:Zc.commandOverflowButtonStyle,accessibilityRole:"button",accessibilityLabel:c,testID:"open-command-drawer"},a.createElement(C.a,{icon:_.a.More,color:"#605E5C",size:16})),a.createElement(Nn,{flyoutCommandId:"native-subgrid-command-bar",flyoutCommand:e,setFlyoutCommand:t,commandBarStatus:n,setCommandBarStatus:r,flyoutOptions:i,headerCommandControls:null,overflowListCommandControls:o,webResourcePath:s,executeCommand:l}))}const Zc=h.a.create({commandOverflowButtonStyle:{alignItems:"center",justifyContent:"center",width:16,height:16,backgroundColor:"#F8F8F8",margin:10}});
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Jc({commandManagerId:e,pageId:t}){const[n,r]=a.useState(),[i,o]=a.useState(An.none),s=Object(l.d)(Ln.t),c=Object(ne.a)(wt.f)[wt.d],{executeCommand:u,commands:d}=Qn(e,t),h=Kn(null,u),g=Object(l.c)(),p=a.useMemo(()=>new wn(g),[g]);return a.createElement(Tn.Provider,{value:{NativeFlyoutManager:p}},a.createElement(Qc,{flyoutCommand:n,setFlyoutCommand:r,commandBarStatus:i,setCommandBarStatus:o,flyoutOptions:Wn,overflowListCommandControls:d,webResourcePath:s,moreCommands:c,executeCommand:h}))}var $c=n("M6R7"),el=n("Ee48"),tl=n("xQln");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const nl=P.a.createAnimatedComponent($c.a);class al extends a.PureComponent{constructor(e){super(e),this._barWidth=this.props.windowWidth,this._defaultInput=this.props.value&&this.props.value.length>0?this.props.value:"",this._quickFindRNContainnerStyles=this.props.quickFindRNStyleProps.quickFindRNContainerStyle,this._searchBarHeight=this._quickFindRNContainnerStyles.height,this._searchBarPadding=this._quickFindRNContainnerStyles.paddingTop,this._inputHeight=+this._searchBarHeight-2*+this._searchBarPadding,this._editable=!0,this._keyboardShouldPersist=!1,this._cancelButtonWidth=64,this._searchIconCollapseMargin=this._barWidth/4+5,this._searchIconExpandedMargin=26,this._searchExecuted=this._defaultInput.length>0,this._animatedIconSearch=new P.a.Value(this._searchIconCollapseMargin),this._animatedIconClear=new P.a.Value(0),this._animatedInputBarWidth=new P.a.Value(this._barWidth),this._animatedCancelBtn=new P.a.Value(0),this._animatedCancelBtnWidth=new P.a.Value(0),this._onFocus=()=>{this.setState({expanded:!0}),this._expandAnimation()},this._onClear=()=>{this.state.expanded&&(this.setState({keyword:""},()=>{this.props.updateSearchTextAndFind(null,!1)}),P.a.timing(this._animatedIconClear,{toValue:0,duration:200}).start())},this._onCancel=()=>{this.state.expanded&&(this.setState({keyword:""},()=>{this.props.updateSearchTextAndFind(null,this._searchExecuted),this._searchExecuted=!1}),this.setState({expanded:!1}),this._collapseAnimation())},this._expandAnimation=()=>{P.a.parallel([P.a.timing(this._animatedInputBarWidth,{toValue:this._barWidth-this._cancelButtonWidth,duration:200}),P.a.timing(this._animatedCancelBtn,{toValue:1,duration:200}),P.a.timing(this._animatedIconSearch,{toValue:this._searchIconExpandedMargin,duration:100}),P.a.timing(this._animatedIconClear,{toValue:this.state.keyword.length>0?1:0,duration:200}),P.a.timing(this._animatedCancelBtnWidth,{toValue:this._cancelButtonWidth,duration:200})]).start()},this._collapseAnimation=()=>{P.a.parallel([P.a.timing(this._animatedInputBarWidth,{toValue:this._barWidth,duration:200}),P.a.timing(this._animatedCancelBtn,{toValue:0,duration:200}),!1===this._keyboardShouldPersist?P.a.timing(this._animatedIconSearch,{toValue:this._searchIconCollapseMargin,duration:200}):null,P.a.timing(this._animatedIconClear,{toValue:0,duration:200}),P.a.timing(this._animatedCancelBtnWidth,{toValue:0,duration:200})]).start()},this.state={keyword:this._defaultInput,expanded:!1},this._onFocus=this._onFocus.bind(this),this._onChangeText=this._onChangeText.bind(this),this._onSearch=this._onSearch.bind(this),this._onClear=this._onClear.bind(this),this._onCancel=this._onCancel.bind(this),this._expandAnimation=this._expandAnimation.bind(this),this._collapseAnimation=this._collapseAnimation.bind(this),this._placeholder=this.props.placeholder,this._cancelText=this.props.cancelText}componentDidMount(){this.props.value&&this.props.value.length>0&&this._onFocus()}_onChangeText(e){this.setState({keyword:e},()=>{this.props.updateSearchTextAndFind(e,!1)}),P.a.timing(this._animatedIconClear,{toValue:e.length>0?1:0,duration:200}).start()}_onSearch(e){this._searchExecuted=!0,this.props.updateSearchTextAndFind(e.nativeEvent.text,!0)}render(){return a.createElement(P.a.View,{style:this.props.quickFindRNStyleProps.quickFindRNContainerStyle,onPress:this._onFocus},a.createElement(We.a,{onPress:this._onFocus},a.createElement(P.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNIconSearch,{left:this._animatedIconSearch}]},a.createElement(C.a,{type:1,icon:el.a,size:20,color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color}))),a.createElement(nl,{style:[this.props.quickFindRNStyleProps.quickFindRNInputStyle,{color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color},this._inputHeight&&{height:this._inputHeight},{width:this._animatedInputBarWidth},this.state.expanded?{textAlign:"left"}:{textAlign:"center"}],editable:this._editable,value:this.state.keyword,onChangeText:this._onChangeText,placeholder:this._placeholder,placeholderTextColor:this.props.quickFindRNStyleProps.quickFindRNPlaceholderColor.color,onSubmitEditing:this._onSearch,autoCorrect:!1,blurOnSubmit:!0,returnKeyType:"search",keyboardType:"default",keyboardAppearance:"default",onFocus:this._onFocus,onPress:this._onFocus,underlineColorAndroid:"transparent",accessibilityTraits:"search",accessibilityLabel:this._placeholder}),a.createElement(We.a,{onPress:this._onClear,accessibilityLabel:this.props.clearText},a.createElement(P.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNIconClear,{opacity:this._animatedIconClear},{pointerEvents:this.state.expanded?"auto":"none"}]},a.createElement(C.a,{type:1,icon:tl.a,size:16,color:this.props.quickFindRNStyleProps.quickFindRNClearIconColor.color}))),a.createElement(P.a.View,{style:{width:this._animatedCancelBtnWidth}},a.createElement(x.a,{onPress:this._onCancel},a.createElement(P.a.View,{style:[this.props.quickFindRNStyleProps.quickFindRNCancelButton,{width:this._animatedCancelBtnWidth},{opacity:this._animatedCancelBtn},{pointerEvents:this.state.expanded?"auto":"none"}]},a.createElement(i.a,{style:{fontSize:17,color:this.props.quickFindRNStyleProps.quickFindRNUserInputColor.color}},this._cancelText)))))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * This file is used for re-exporting all the react-native components
 * to be bundled by webpack into one JS file.
 */},"1yY9":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("i1f0"),r=n("Bj/n"),i=n("3tOH"),o=n("bT7G"),s=n("dHD5"),c=n("uNLT"),l=n("+aj2"),u=n("cUbT"),d=n("wBG+"),h=n("Tz6o"),g=n("yq1L"),p=n("O7zD");function m(e,t){return{type:"saveAndNew.quickCreateFormAction.async",execute({dispatch:n,getState:m},b,f){const y=m(),C=Object(s.j)(y,t),_=Object(a.zb)(y,t,C),v=Object(a.ac)(y,t,C);if(Object(o.g)(y,v)||!_)return n(Object(c.e)(t,59)).then(r=>{const i=Object(a.Ib)(y,t),o=i?"Forms.MainFormDialogRoot.SaveAndNew":"Forms.QuickCreateFormRoot.SaveAndNew";if(r){const a=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:r.etn}];b.EventManager.ReportComponentSuccess(o,a);return(i?Promise.resolve(t):n(Object(l.b)(t,r))).then(a=>(n(Object(u.a)(r.etn)),n(Object(d.a)(a)).then(()=>{const a=Object.assign(Object.assign({},e),{id:null});return n(Object(h.b)(a,t)),n(Object(g.b)(t,!0)),r})))}b.TraceManager.getTracer().error("Record is not created",[{name:"isEntityRefNull",value:!0}])}).catch(e=>{b.TraceManager.getTracer().error("Record is not created",e)});for(const e in _){const a=_[e].label,o=_[e].errorMessage,s=n(Object(r.b)(a,o));n(Object(r.c)(C,t,s,i.a.error,Object(p.d)(t,e)))}}}}},"23K5":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class r{generate(e,t){if(!t||!t.getProcessId())return null;return{businessProcessFlowInstanceId:t.getProcessInstanceId(),activeStageId:a.a.tryParseOrNull(t.getActiveStageId()),displayState:t.getDisplayState(),processState:t.getProcessState(),state:t.getState(),status:t.getStatus(),isVisible:t.isVisible(),data:{activePath:t.getActivePath(),selectedStageId:a.a.tryParseOrNull(t.getSelectedStageId()),businessProcessFlowId:t.getProcessId(),actionLogCollection:t.getActionLogCollection(),processNavigationBehavior:{navigationBehavior:t.getBpfNavigationBehavior()}}}}}},"2o7a":function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));var a=n("nuS9"),r=n("WziN"),i=n("pyUm"),o=n("4PNl"),s=n("EZ4w"),c=n("v7n7"),l=n.n(c),u=n("Fw7Z"),d=n("0YTt");function h({title:e,message:t,buttons:n,contentHeight:s}){const[c,u]=a.useState(!0),[h,g]=a.useState(null),m=a.useCallback(e=>{u(!1),g(t=>e)},[]);return a.createElement(l.a,Object.assign({},d.a,{backdropOpacity:.4,onModalHide:()=>h&&h(),isVisible:c,style:p.modal}),a.createElement(r.a,{style:p.dialog},a.createElement(r.a,{style:[p.textContainer,{height:s}]},a.createElement(i.a,{style:p.title,numberOfLines:1},e),a.createElement(o.a,{style:p.messageContainer},a.createElement(i.a,{style:p.message},t))),n(m)))}const g="#C8C8C8",p=s.a.create({modal:{flexDirection:"column",flexGrow:1,justifyContent:"center"},dialog:{width:270,minHeight:140,maxHeight:"100%",flexGrow:0,alignSelf:"center",borderRadius:14,backgroundColor:"#E8E8E8"},textContainer:{flex:1,paddingTop:17,alignItems:"center",borderBottomWidth:u.a,borderBottomColor:g},title:{fontSize:17,fontWeight:"bold"},message:{marginTop:1,fontSize:13,paddingLeft:13,paddingRight:13,textAlign:"center"},messageContainer:{flex:1}})},"33Bq":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return p}));var a=n("CpcI"),r=n("xy1J"),i=n("09gH"),o=n("sptG"),s=n("FdXt"),c=n("bJSG"),l=n("8Jtx"),u=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="Role_Editor_Row_Name_Quick_Create",h="PageLoadingMessage",g="SharePoint.Form.Saving",p=["Button_Label_Close",d,h,g].concat(a.g,r.m,i.o,o.f,c.c,s.h,l.b,[u.g,u.f],[u.d])},"3MuQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="section.label";function i(e,t,n,i){const o=Object(a.v)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,sectionName:n}}}},"3c9R":function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n("jRy5"),r=n("dHD5"),i=n("i1f0"),o=n("mIxf"),s=n("bT7G"),c=n("arV0"),l=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const u="attribute.precision";function d(e,t,n,d){return{type:"attribute.precision.update",sync:!0,execute({dispatch:h,getState:g},p){let m=g();h(function(e,t,n,i){if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)return Object(l.e)(e,t,n,i);const o=Object(r.x)(t);return{type:u,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}(e,t,n,d)),m=g();let b=null,f=null,y=null,C=null;if(t&&t.contextTokenType&&t.contextTokenType===a.a.GridRow)b=t.entityTypeName?t.entityTypeName:null,f=t.recordId?t.recordId:null,y=Object(r.t)(t),C=Object(r.r)(t);else{const n=Object(c.g)(m,e);b=n&&n.entityTypeName?n.entityTypeName:null,f=n&&n.id?n.id:null,y=null,C=t}const _=Object(i.ac)(m,e,t),v=Object(s.d)(m,_,{etn:b,id:f},n),S={[n]:v};h(Object(o.a)(e,S,!0,!0,b,f?f.guid:null,y,C))}}}},"46jN":function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"l",(function(){return r})),n.d(t,"k",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"p",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return y})),n.d(t,"q",(function(){return C}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Web.NavBar.Home_Title",r="Web.NavBar.Search_Title",i="Web.NavBar.Relationship_Assistant_Caption",o="Web.NavBar.Quick_Create_Menu_Caption",s="Web.NavBar.Start_Task_Flow_Caption",c="Web.NavBar.Offline_Status_Caption",l="Web.NavBar.Immersive_Skype_Caption",u="Web.NavBar.Settings_Caption",d="Web.NavBar.User_Information_Caption",h="Web.NavBar.Help_Title",g="Web.NavBar.Go_Back",p="Web.NavBar.SiteMap",m="Web.NavBar.AdvancedFind_Title",b="Monitor.Monitor.Label",f="Web.NavBar.Home_Title",y="Web.NavBar.Home_Desc",C=[a,r,i,o,s,c,"Web.NavBar.See_Welcome_Screen_Caption",l,u,d,m,b,h,"Web.NavBar.Search_Title","Web.NavBar.Search_Desc","Web.NavBar.Settings_Title","Web.NavBar.Settings_Desc","Web.NavBar.Help_Title","Web.NavBar.Help_Desc",f,y,"Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.TaskFlow_Desc","Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.User_Information_Title","Web.NavBar.User_Information_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.OfflineStatus_Desc",g,"Web.NavBar.AdvancedFind_Title","Web.NavBar.AdvancedFind_Desc",p]},"4U8P":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="header.commandbarvisible";function i(e,t,n){const i=Object(a.v)(t);return{type:r,payload:n,meta:{pageId:e,contextKey:i}}}},"53SR":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("SAYH"),r=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){const n={dataById:{[a.a.toString(t.id)]:e}};return{type:r.a,payload:n}}},"5O6t":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("BFlg"),r=n("zVFX"),i=n("o0iw"),o=n("IqkD");function s(e,t,n,s){const c=Object(o.g)(e),l=Object(i.p)(c,null);let u=null;const d={"[aria-expanded=true]":{backgroundColor:s?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:s?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill}};switch(t.contextString){case a.h.GRID:l.container.backgroundColor=s?n.colors.BaseColor.White:n.colors.MainThemeColor.MainColor1.Fill,l.container.marginLeft="0px",l.container.marginRight="0px",l.listItemBody.text.color=s?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,l.listItemBody.icon.color=s?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,l.listItemBody.iconWrapperStyles.color=s?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,l.moreIcon.color=s?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,l.splitbuttonicon.color=s?n.colors.BaseColor.Grey.Grey7:n.colors.MainThemeColor.MainColor1.Text,u={":hover":{backgroundColor:s?n.colors.BaseColor.Grey.Grey2:n.colors.MainThemeColor.MainColor3.Fill}},l.splitbuttonOverflowButton=Object.assign(Object.assign({},l.splitbuttonOverflowButton),d),l.listItem=Object.assign(Object.assign({},l.listItem),d),l.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=c?void 0:n.colors.MainThemeColor.MainColor1.Text,l.listItemBody.splitButtonChevronIconWrapper.borderRightColor=c?n.colors.MainThemeColor.MainColor1.Text:void 0,l.overflowFlyoutMoreButton=Object.assign(Object.assign({},l.overflowFlyoutMoreButton),u),s&&(l.list.marginTop="0px",l.list.marginBottom="0px",l.listItem.height="100%",l.listItem.alignItems="center",l.listItemBody.button.width=n.sizes.Measures.Measure300,l.moreIcon.marginRight=n.sizes.Measures.Measure100,l.moreIcon.marginLeft=n.sizes.Measures.Measure100,l.container.borderStyle="none",l.list.marginLeft="0px",l.list.marginRight="0px");break;case a.h.SUBGRID:case a.h.ASSOCIATEDGRID:default:l.container.backgroundColor="transparent",l.container.marginTop=t.contextString!==a.h.SUBGRID?"10px":"0px",l.container.marginLeft="0px",l.container.marginRight="0px",l.listItemBody.text.color=r.a.colors.BaseColor.Grey.Grey7,l.listItemBody.iconWrapperStyles.color=r.a.colors.BaseColor.Grey.Grey7,l.listItemBody.icon.color=r.a.colors.BaseColor.Grey.Grey7,l.moreIcon.color=r.a.colors.BaseColor.Grey.Grey7,l.splitbuttonicon.color=r.a.colors.BaseColor.Grey.Grey7,l.listItem.color=r.a.colors.BaseColor.Grey.Grey7,l.list.marginLeft="0px",l.list.marginRight="0px",u={":hover":{backgroundColor:r.a.colors.BaseColor.Grey.Grey2}},l.overflowFlyoutMoreButton=Object.assign(Object.assign({},l.overflowFlyoutMoreButton),u)}return null!=u&&(l.listItemBody.button=Object.assign(Object.assign({},l.listItemBody.button),u)),l}var c=n("b8TU"),l=n("unFF"),u=n("Lyxw"),d=n("3/02"),h=n("H4dV"),g=n("tJ+6"),p=n("TQn4");function m(){let e,t,n=null,r=null;const i=h.a.getInstance().get_IsBrowserIE();let m={display:"flex",width:"100%",boxSizing:"border-box"};m=i?Object.assign(m,{flex:"1 1 100%"}):m;let b={justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",width:"100%",paddingBottom:"5px"};b=i?Object.assign(b,{flex:"1 1 100%"}):b;const f={border:"none",background:"none",fontSize:"1rem",padding:"0px 12px 0px 12px",display:"flex",alignItems:"center"},y={containerStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",maxWidth:"100%",overflow:"auto"},rootStyle:{display:"flex",flex:"1 1 auto",flexDirection:"column",minWidth:"100%",minHeight:0},headerStyle:{width:"100%",flexWrap:"wrap",flexShrink:0,"-webkit-transform":"translate3d(0,0,0)"},headerInnerStyle:m,headerInnerMobileStyle:{display:"flex"},quickFindStyle:{flex:"0 1 auto",marginTop:"auto",marginBottom:"auto"},quickFindContainerStyle:{display:"flex"},quickFindMobileStyle:{justifyContent:"space-between"},quickFindRNInputStyle:{justifyContent:"center"},dataSetContentBodyStyle:{display:"flex",flex:"1 1 auto",flexDirection:"row",overflowY:"hidden",overflowX:"hidden","@media (max-height: 560px)":{flex:"1 0 auto"}},reflowdataSetContentBodyStyle:{display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",flex:"1 1 auto",minHeight:"12rem"},bodyStyle:{display:"flex",flex:"1 1 auto",overflow:"hidden",minWidth:"0%"},bodyMobileStyle:{display:"flex",flex:"1 1 auto",maxWidth:"100%",minWidth:"0%"},chartStyle:{minWidth:"320px",width:"30%",display:"flex"},reflowChartStyle:{minWidth:"100%",width:"100%",display:"flex",flex:"0 0 auto"},reflowChartMobileStyle:{minWidth:"100%",width:"100%",display:"flex",flex:"0 0 auto"},reflowGridStyle:{minHeight:"250px",display:"flex",flexDirection:"column",maxWidth:"100%",flex:"1 1 auto"},viewSelectorOuterStyle:{marginRight:"auto",minWidth:"0",flex:"auto"},viewSelectorOuterMobileStyle:{marginRight:"auto",minWidth:"0",flex:"auto"},viewSelectorStyle:{display:"flex",flex:"1",flexDirection:"row",minWidth:"0"},titleStyle:{display:"flex",flex:"1",marginTop:"auto",marginBottom:"auto",whiteSpace:"nowrap"},titleMobileStyle:{display:"flex",flex:"1",marginTop:"auto",marginBottom:"auto",whiteSpace:"nowrap"},commandManagerContainerStyle:{display:"flex"},commandManagerContainerMobileStyle:{flex:"1",flexDirection:"row-reverse"},filterComboStyle:{boxSizing:"border-box",backgroundColor:"transparent",marginTop:"auto",marginBottom:"auto"},filterContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:"22rem"},activityTypeFilterContainerStyle:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:"22rem"},filterContainerMobileStyle:{justifyContent:"space-between"},filterLabelStyle:{cursor:"default"},activityMgmtLabelStyle:{cursor:"default"},jumpBarButtonContainerStyle:{display:"flex",alignItems:"center",backgroundColor:"transparent",minWidth:"0"},footerStyle:{display:"flex",position:"relative"},footerOuterStyle:{marginTop:"auto",display:"flex",flexDirection:"column"},footerMobileStyle:{marginTop:"auto",display:"flex",flexDirection:"row",justifyContent:"space-between"},footerPagingContainer:{display:"flex",flex:"1 1 auto"},dataSetChangingProgressIndicatorContainerStyle:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",position:"absolute",display:"flex"},dataSetChangingProgressIndicatorStyle:{position:"relative",display:"flex",alignContent:"center",justifyContent:"center"},progressIndicatorContainerStyle:{flex:"1 1 auto",display:"flex",alignItems:"center",position:"relative"},progressIndicatorStyle:{width:"100%",height:200,alignContent:"center",display:"flex",position:"relative",flexDirection:"column",justifyContent:"center"},datasethostProgressIndicatorStyle:{width:"40px",height:"40px"},seeMoreButtonContainerStyle:{justifyContent:"flex-end",backgroundColor:"transparent",flexDirection:"row",display:"flex",flex:"0 0 auto",alignItems:"center"},seeMoreButtonStyle:{height:"100%",borderStyle:"none",backgroundColor:"transparent",alignItems:"center",padding:0,cursor:"pointer"},activityViewContainerStyle:b,dueDateComboBoxStyles:{boxSizing:"border-box",backgroundColor:"transparent",width:"17rem",height:"2.53rem",padding:"1px",borderRadius:"2px"},activityTypeComboBoxStyles:{boxSizing:"border-box",backgroundColor:"transparent",width:"17rem",height:"2.53rem",padding:"1px",borderRadius:"2px"},mobileSubGridContainerStyles:{borderColor:"#C8C8C8",borderWidth:"1px",borderStyle:"solid",width:"100%",borderRight:"0px",borderLeft:"0px"},columnEditorButtonStyle:{marginTop:"8px"}};return function(i,h){var m,b,C,_,v,S,O,I,j,P,x,E,w,T,A,F,N,k,M,D,R,L,B,V,G,z,W,X,H,U,q,Y,K,Q,Z,J,$,ee,te,ne,ae,re,ie,oe,se,ce,le;const ue=Object(o.g)(i),de=Object(u.a)(i,d.le,d.h),he=Object(g.b)(i)&&Object(u.a)(i,d.Fb,d.Lc),ge=Object(u.a)(i,d.Od,d.h),pe=Object(c.c)(i),me=he&&(null===(m=Object(g.a)(i))||void 0===m?void 0:m.Components)?Object(g.a)(i).Components:null;if(n!==h.contextString||e!==ue||t!==pe){n=h.contextString,e=ue,t=pe;const o=Object(l.a)(i);let c,g,m,he,be,fe,ye,Ce,_e,ve,Se,Oe,Ie,je,Pe,xe,Ee,we,Te,Ae,Fe,Ne,ke,Me,De,Re,Le,Be,Ve,Ge,ze,We=Object.assign(Object.assign({},y.titleStyle),{["padding"+(ue?"Left":"Right")]:o.sizes.Measures.Measure125,color:(null===(C=null===(b=null==me?void 0:me.Grid)||void 0===b?void 0:b.ColumnHeader)||void 0===C?void 0:C.TextColor)||o.colors.BaseColor.Grey.Grey7,fontFamily:o.fontFamilies.Regular,minHeight:o.sizes.Measures.Measure300,lineHeight:o.sizes.Measures.Measure300}),Xe=We;const He=Object.assign(Object.assign({},y.filterLabelStyle),{["margin"+(ue?"Left":"Right")]:o.sizes.Measures.Measure015}),Ue=Object.assign(Object.assign({},y.activityMgmtLabelStyle),{["padding"+(ue?"Left":"Right")]:"8px",["margin"+(ue?"Left":"Right")]:o.sizes.Measures.Measure015});let qe,Ye,Ke;const Qe=Object.assign(Object.assign({},y.footerPagingContainer),me?{backgroundColor:me.Grid.Footer.BackgroundColor}:{}),Ze="border-box";switch(n){case a.h.GRID:c=Object.assign(Object.assign({},y.headerStyle),{marginBottom:"0px",backgroundColor:(null===(v=null===(_=null==me?void 0:me.Grid)||void 0===_?void 0:_.ColumnHeader)||void 0===v?void 0:v.BackgroundColor)||o.colors.BaseColor.White}),g=Object.assign(Object.assign({},y.headerInnerStyle),{marginLeft:de||ue?void 0:o.sizes.Measures.Measure150,marginRight:de||!ue?void 0:o.sizes.Measures.Measure150,marginTop:"0px",marginBottom:"0px",height:"56px",lineHeight:"56px",minHeight:"56px"}),m=Object.assign(Object.assign(Object.assign({},y.headerInnerMobileStyle),{marginLeft:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure100,marginTop:o.sizes.Measures.Measure125,height:o.sizes.Measures.Measure300,lineHeight:o.sizes.Measures.Measure300,minHeight:o.sizes.Measures.Measure300,width:"calc(100% - "+o.sizes.Measures.Measure100+")"}),de&&{marginLeft:void 0,marginRight:void 0,marginTop:void 0,paddingTop:"16px",paddingBottom:"16px",minHeight:"24px",maxHeight:"24px"}),he=Object.assign(Object.assign({},y.commandManagerContainerStyle),{width:"100%",height:o.sizes.Measures.Measure300,minHeight:o.sizes.Measures.Measure300,backgroundColor:o.colors.MainThemeColor.MainColor1.Fill,flex:"0 1 auto",marginLeft:"0",marginRight:"0"}),be=Object.assign(Object.assign(Object.assign({},y.commandManagerContainerMobileStyle),{maxWidth:"25%"}),de&&{maxWidth:void 0,marginBottom:"-8px",marginTop:"-8px"}),fe=s(i,h,o),ye=function(e,t,n){return s(e,t,n,!0)}(i,h,o),Be=Object.assign(Object.assign({},y.filterContainerStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",marginTop:"0",marginBottom:"5px",marginRight:ue?"20px":"0",marginLeft:ue?"0":"20px",height:o.sizes.Measures.Measure250}),Ve=Object.assign(Object.assign({},y.activityTypefilterContainerStyle),{justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",marginTop:"0",marginBottom:"5px",marginRight:ue?"20px":"0",marginLeft:ue?"0":"20px",height:o.sizes.Measures.Measure250}),Ge=Object.assign(Object.assign({},y.filterContainerMobileStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",marginTop:o.sizes.Measures.Measure025,marginLeft:ue?"0":o.sizes.Measures.Measure100,marginRight:ue?o.sizes.Measures.Measure100:"0",marginBottom:o.sizes.Measures.Measure100,width:"100%"}),ze=Object.assign(Object.assign({},y.filterComboStyle),{border:o.borders.Border02,borderColor:o.colors.BaseColor.Grey.Grey3,lineHeight:o.sizes.Measures.Measure250}),Ae=Object.assign(Object.assign({},y.dataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}),Fe=ge?Object.assign(Object.assign({},y.reflowdataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}):Object.assign(Object.assign({},y.reflowdataSetContentBodyStyle),{marginLeft:o.sizes.Measures.Measure050,marginRight:o.sizes.Measures.Measure050,marginBottom:o.sizes.Measures.Measure050}),Ne=ge?Object.assign(Object.assign({},y.chartStyle),{boxSizing:Ze,["border"+(ue?"Left":"Right")]:o.borders.Border02,borderBottom:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure150,paddingRight:o.sizes.Measures.Measure150,backgroundColor:o.colors.BaseColor.White}):Object.assign(Object.assign({},y.chartStyle),{boxSizing:Ze,borderRight:o.borders.Border02,borderBottom:o.borders.Border02,borderLeft:o.borders.Border02,borderTopWidth:o.sizes.Measures.Measure025,borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",marginRight:o.sizes.Measures.Measure150,paddingTop:o.sizes.Measures.Measure025,paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.BaseColor.White}),De=ge?Object.assign(Object.assign({},y.reflowChartStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure150,paddingRight:o.sizes.Measures.Measure150,backgroundColor:o.colors.BaseColor.White}):Object.assign(Object.assign({},y.reflowChartStyle),{boxSizing:Ze,borderRight:o.borders.Border02,borderBottom:o.borders.Border02,borderLeft:o.borders.Border02,borderTopWidth:o.sizes.Measures.Measure025,borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,paddingTop:o.sizes.Measures.Measure025,marginBottom:o.sizes.Measures.Measure050,borderTopStyle:"solid",paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.BaseColor.White}),Re=ge?Object.assign(Object.assign({},y.reflowChartMobileStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.BaseColor.White}):Object.assign(Object.assign({},y.reflowChartMobileStyle),{boxSizing:Ze,borderRight:o.borders.Border02,borderBottom:o.borders.Border02,borderLeft:o.borders.Border02,borderTopWidth:o.sizes.Measures.Measure025,borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,paddingTop:o.sizes.Measures.Measure025,marginBottom:o.sizes.Measures.Measure050,borderTopStyle:"solid",paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.BaseColor.White}),Le=ge?Object.assign(Object.assign({},y.reflowGridStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,backgroundColor:(null===(O=null===(S=null==me?void 0:me.Grid)||void 0===S?void 0:S.Cell)||void 0===O?void 0:O.BackgroundColor)||o.colors.BaseColor.White}):Object.assign(Object.assign({},y.reflowGridStyle),{boxSizing:Ze,borderRight:o.borders.Border02,borderBottom:o.borders.Border02,borderLeft:o.borders.Border02,paddingTop:o.sizes.Measures.Measure025,backgroundColor:(null===(j=null===(I=null==me?void 0:me.Grid)||void 0===I?void 0:I.Cell)||void 0===j?void 0:j.BackgroundColor)||o.colors.BaseColor.White,borderTopWidth:o.sizes.Measures.Measure025,borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid"}),ke=Object.assign(Object.assign({},y.bodyStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,borderTopWidth:"0px",borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:me?me.Grid.Cell.BackgroundColor:o.colors.BaseColor.White}),Me=Object.assign(Object.assign({},y.bodyMobileStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,borderTopWidth:"0px",borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(x=null===(P=null==me?void 0:me.Grid)||void 0===P?void 0:P.Cell)||void 0===x?void 0:x.BackgroundColor)||o.colors.BaseColor.White,minHeight:o.sizes.Measures.Measure450}),Ce=Object.assign(Object.assign({},y.quickFindStyle),{height:o.sizes.Measures.Measure250,lineHeight:o.sizes.Measures.Measure250,backgroundColor:(null===(T=null===(w=null===(E=null==me?void 0:me.Grid)||void 0===E?void 0:E.ColumnHeader)||void 0===w?void 0:w.QuickFind)||void 0===T?void 0:T.BackgroundColor)||o.colors.BaseColor.White,marginLeft:ue?de?"32px":o.sizes.Measures.Measure150:o.sizes.Measures.Measure075,marginRight:ue?o.sizes.Measures.Measure075:de?"32px":o.sizes.Measures.Measure150,marginTop:"10px"}),_e=Object.assign({},y.quickFindStyle);ve=Object(u.c)(i,d.ad)?Object.assign(Object.assign({},y.quickFindMobileStyle),{height:o.sizes.Measures.Measure400,lineHeight:o.sizes.Measures.Measure250,marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,backgroundColor:(null===(N=null===(F=null===(A=null==me?void 0:me.Grid)||void 0===A?void 0:A.ColumnHeader)||void 0===F?void 0:F.QuickFind)||void 0===N?void 0:N.BackgroundColor)||o.colors.BaseColor.White,width:"100%"}):Object.assign(Object.assign({},y.quickFindMobileStyle),{height:o.sizes.Measures.Measure250,lineHeight:o.sizes.Measures.Measure250,marginTop:o.sizes.Measures.Measure025,marginLeft:o.sizes.Measures.Measure050,marginRight:o.sizes.Measures.Measure050,marginBottom:o.sizes.Measures.Measure100,backgroundColor:(null===(D=null===(M=null===(k=null==me?void 0:me.Grid)||void 0===k?void 0:k.ColumnHeader)||void 0===M?void 0:M.QuickFind)||void 0===D?void 0:D.BackgroundColor)||o.colors.BaseColor.White,width:"100%"}),Se=Object.assign(Object.assign({},y.quickFindRNContainerStyle),{backgroundColor:(null===(L=null===(R=null==me?void 0:me.Grid)||void 0===R?void 0:R.ColumnHeader)||void 0===L?void 0:L.BackgroundColor)||o.colors.BaseColor.White,height:56,flexDirection:"row",alignItems:"center",paddingTop:10,paddingBottom:10,width:"100%",maxWidth:pe}),Oe=Object.assign(Object.assign({},y.quickFindRNInputStyle),{textAlignmentsVertical:"center",paddingRight:o.sizes.Measures.Measure225,paddingLeft:o.sizes.Measures.Measure225,backgroundColor:"#f1f1f1",borderRadius:10,fontSize:o.fontSizes.FontL,flex:1}),Ie=Object.assign(Object.assign({},y.quickFindRNIconSearch),{height:20,width:20}),je=Object.assign(Object.assign({},y.quickFindRNIconClear),{left:"-24px",height:16,width:16}),Pe=Object.assign(Object.assign({},y.quickFindRNCancelButton),{justifyContent:"space-around",alignItems:ue?"flex-start":"flex-end",right:o.sizes.Measures.Measure1143,backgroundColor:"transparent",height:56}),xe=Object.assign(Object.assign({},y.quickFindRNCancelButtonText),{fontSize:o.fontSizes.FontL,color:"#6e6e6e"}),Ee=Object.assign(Object.assign({},y.quickFindRNUserInputColor),{color:"#6e6e6e"}),we=Object.assign(Object.assign({},y.quickFindRNClearIconColor),{color:"#919191"}),Te=Object.assign(Object.assign({},y.quickFindRNPlaceholderColor),{color:"#8e8e8e"}),Ye=Object.assign(Object.assign(Object.assign({},y.viewSelectorOuterStyle),{minWidth:"40%"}),de&&{display:"flex",flexDirection:"row",justifyContent:"space-between",paddingTop:"16px",paddingBottom:"16px",height:"24px"}),Ke=Object.assign(Object.assign({},y.viewSelectorOuterMobileStyle),{minWidth:"50%",maxWidth:"calc(100% - "+o.sizes.Measures.Measure700+")"}),We=Object.assign(We,{fontSize:"20px",minWidth:"40%"}),Xe=Object.assign(Xe,{fontSize:o.fontSizes.Font125,minWidth:"70%"});const e={height:o.sizes.Measures.Measure300,minHeight:o.sizes.Measures.Measure300,width:o.sizes.Measures.Measure300,minWidth:o.sizes.Measures.Measure300,["margin"+(ue?"Left":"Right")]:o.sizes.Measures.Measure100,backgroundColor:o.colors.MainThemeColor.MainColor1.Fill,borderRadius:"50%",flex:"0 0 auto"},t={height:o.sizes.Measures.Measure200,minHeight:o.sizes.Measures.Measure200,width:o.sizes.Measures.Measure200,minWidth:o.sizes.Measures.Measure200,margin:"auto"},n={color:o.colors.BaseColor.White,fontSize:o.sizes.Measures.Measure1143,display:"inline-block",width:o.sizes.Measures.Measure300,minWidth:o.sizes.Measures.Measure300,textAlign:"center"},l={["margin"+(ue?"Left":"Right")]:o.sizes.Measures.Measure100},b={minHeight:o.sizes.Measures.Measure300,minWidth:o.sizes.Measures.Measure300,height:o.sizes.Measures.Measure300,width:o.sizes.Measures.Measure300,margin:0,borderRadius:"50%",flex:"0 0 100",display:"flex"};r=Object.assign(Object.assign({},y),{headerStyle:c,headerInnerStyle:g,headerInnerMobileStyle:m,commandManagerContainerStyle:he,commandManagerContainerMobileStyle:be,commandBarStyle:fe,commandBarMobileInnerStyle:ye,filterContainerStyle:Be,activityTypeFilterContainerStyle:Ve,filterContainerMobileStyle:Ge,bodyStyle:ke,bodyMobileStyle:Me,chartStyle:Ne,dataSetContentBodyStyle:Ae,quickFindStyle:Ce,quickFindContainerStyle:_e,quickFindMobileStyle:ve,quickFindRNContainerStyle:Se,quickFindRNInputStyle:Oe,quickFindRNIconSearch:Ie,quickFindRNIconClear:je,quickFindRNCancelButton:Pe,quickFindRNCancelButtonText:xe,quickFindRNUserInputColor:Ee,quickFindRNClearIconColor:we,quickFindRNPlaceholderColor:Te,entityIconOuterStyle:e,entityIconStyle:n,entityImageOuterStyle:b,entityImageInnerStyle:t,entityImageContainerStyle:l,titleStyle:We,titleMobileStyle:Xe,reflowChartStyle:De,reflowChartMobileStyle:Re,reflowGridStyle:Le,reflowdataSetContentBodyStyle:Fe,viewSelectorOuterStyle:Ye,viewSelectorOuterMobileStyle:Ke,filterComboStyle:ze,filterLabelStyle:He,footerPagingContainer:Qe,activityMgmtLabelStyle:Ue});break;case a.h.SUBGRID:const f=Object(p.b)(i,0);let C=f?"#F8F8F8":o.colors.BaseColor.White;C=(null===(V=null===(B=null==me?void 0:me.Grid)||void 0===B?void 0:B.ColumnHeader)||void 0===V?void 0:V.BackgroundColor)||C,c=Object.assign(Object.assign({},y.headerStyle),{backgroundColor:C}),g=Object.assign(Object.assign({},y.headerInnerStyle),{borderBottom:o.borders.Border02}),m=Object.assign(Object.assign({},y.headerInnerMobileStyle),{borderBottom:o.borders.Border02,maxWidth:"100%",width:"100%"}),he=Object.assign(Object.assign({},y.commandManagerContainerStyle),{flex:"1 1 100%",marginLeft:"0px",marginRight:"0px",flexDirection:"row-reverse",maxWidth:"35%",["margin"+(ue?"Right":"Left")]:"auto"}),be=Object.assign(Object.assign({},y.commandManagerContainerMobileStyle),{flex:"1 1 100%",maxWidth:"35%",["margin"+(ue?"Right":"Left")]:"auto"}),fe=s(i,h,o),ye=s(i,h,o),Be=Object.assign(Object.assign({},y.filterContainerStyle),{marginTop:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure150,marginBottom:o.sizes.Measures.Measure100,marginLeft:o.sizes.Measures.Measure150,paddingLeft:o.sizes.Measures.Measure100,height:o.sizes.Measures.Measure250}),Ge=Object.assign(Object.assign({},y.filterContainerMobileStyle),{marginTop:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure150,marginBottom:o.sizes.Measures.Measure100,marginLeft:o.sizes.Measures.Measure150,width:"100%"}),ze=Object.assign(Object.assign({},y.filterComboStyle),{border:o.borders.Border02,borderColor:o.colors.BaseColor.Grey.Grey3,lineHeight:o.sizes.Measures.Measure250}),Ce=Object.assign(Object.assign({},y.quickFindStyle),{height:o.sizes.Measures.Measure250,minHeight:o.sizes.Measures.Measure250,backgroundColor:(null===(W=null===(z=null===(G=null==me?void 0:me.Grid)||void 0===G?void 0:G.ColumnHeader)||void 0===z?void 0:z.QuickFind)||void 0===W?void 0:W.BackgroundColor)||o.colors.BaseColor.White,marginLeft:"0px",marginTop:"6px",marginBottom:"0px"}),_e=Object.assign(Object.assign({},y.quickFindStyle),{display:"flex",flexDirection:"row-reverse",flex:"1 1 auto"}),ve=Object.assign(Object.assign({},y.quickFindMobileStyle),{height:o.sizes.Measures.Measure250,minHeight:o.sizes.Measures.Measure250,marginTop:o.sizes.Measures.Measure150,marginBottom:o.sizes.Measures.Measure150,marginLeft:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure100,backgroundColor:(null===(H=null===(X=null==me?void 0:me.Grid.ColumnHeader)||void 0===X?void 0:X.QuickFind)||void 0===H?void 0:H.BackgroundColor)||o.colors.BaseColor.White,width:"100%"}),We=Object.assign(We,{fontSize:o.fontSizes.Font100,fontFamily:o.fontFamilies.Semibold,minWidth:"60%",maxWidth:"69%",textOverflow:"ellipsis",overflow:"hidden"}),f&&(We=Object.assign(We,y.titleStyle,{["padding"+(ue?"Right":"Left")]:"10px",height:"39px"})),Xe=We,qe=Object.assign(Object.assign({},y.progressIndicatorContainerStyle),{height:pe<=o.sizes.Breakpoints.DimensionS?148..toString()+"px":200..toString()+"px",borderBottom:o.borders.Border02}),Ye=Object.assign(Object.assign({},y.viewSelectorOuterStyle),{minWidth:"50%"}),Ke=Object.assign(Object.assign({},y.viewSelectorOuterMobileStyle),{minWidth:"60%",maxWidth:"calc(100% - "+o.sizes.Measures.Measure400+")"}),r=Object.assign(Object.assign({},y),{headerStyle:c,headerInnerStyle:g,headerInnerMobileStyle:m,commandManagerContainerStyle:he,commandManagerContainerMobileStyle:be,commandBarStyle:fe,commandBarMobileInnerStyle:ye,filterContainerStyle:Be,filterContainerMobileStyle:Ge,filterComboStyle:ze,filterLabelStyle:He,activityMgmtLabelStyle:Ue,quickFindStyle:Ce,quickFindContainerStyle:_e,quickFindMobileStyle:ve,titleStyle:We,titleMobileStyle:Xe,progressIndicatorContainerStyle:qe,viewSelectorOuterStyle:Ye,viewSelectorOuterMobileStyle:Ke});break;case a.h.ASSOCIATEDGRID:c=Object.assign(Object.assign({},y.headerStyle),{marginBottom:"0px",backgroundColor:(null===(q=null===(U=null==me?void 0:me.Grid)||void 0===U?void 0:U.ColumnHeader)||void 0===q?void 0:q.BackgroundColor)||"transparent"}),g=Object.assign(Object.assign({},y.headerInnerStyle),{paddingLeft:o.sizes.Measures.Measure200,paddingRight:o.sizes.Measures.Measure200,paddingTop:"0px",paddingBottom:"0px",lineHeight:o.sizes.Measures.Measure300,backgroundColor:(null===(K=null===(Y=null==me?void 0:me.Grid)||void 0===Y?void 0:Y.ColumnHeader)||void 0===K?void 0:K.BackgroundColor)||o.colors.BaseColor.White}),m=Object.assign(Object.assign({},y.headerInnerMobileStyle),{marginLeft:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure100,marginTop:o.sizes.Measures.Measure125,marginBottom:o.sizes.Measures.Measure075,lineHeight:o.sizes.Measures.Measure300,width:"calc(100% - "+o.sizes.Measures.Measure200+")"}),he=Object.assign(Object.assign({},y.commandManagerContainerStyle),{flex:"0 1 auto",paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,minHeight:o.sizes.Measures.Measure300,backgroundColor:o.colors.BaseColor.White}),be=Object.assign(Object.assign({},y.commandManagerContainerMobileStyle),{maxWidth:"35%",["margin"+(ue?"Right":"Left")]:"auto"}),fe=s(i,h,o),ye=s(i,h,o),Be=Object.assign(Object.assign({},y.filterContainerStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",marginTop:"4px",marginBottom:"4px",marginRight:ue?"20px":"0px",marginLeft:ue?"0px":"20px"}),Ve=Object.assign(Object.assign({},y.activityTypefilterContainerStyle),{justifyContent:"flex-start",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",marginTop:"4px",marginBottom:"4px",marginRight:ue?"20px":"0px",marginLeft:ue?"0px":"20px"}),Ge=Object.assign(Object.assign({},y.filterContainerMobileStyle),{justifyContent:"space-between",flexWrap:"wrap",flexDirection:"row",color:o.colors.BaseColor.Grey.Grey5,fontSize:o.fontSizes.Font100,minWidth:"15rem",height:o.sizes.Measures.Measure250,lineHeight:o.sizes.Measures.Measure250,marginTop:o.sizes.Measures.Measure025,marginLeft:ue?"0":o.sizes.Measures.Measure100,marginRight:ue?o.sizes.Measures.Measure100:"0",marginBottom:o.sizes.Measures.Measure050,width:"100%"}),ze=Object.assign(Object.assign({},y.filterComboStyle),{border:o.borders.Border02,borderColor:o.colors.BaseColor.Grey.Grey3,lineHeight:o.sizes.Measures.Measure250}),Ce=Object.assign(Object.assign({},y.quickFindStyle),{height:o.sizes.Measures.Measure250,backgroundColor:(null===(J=null===(Z=null===(Q=null==me?void 0:me.Grid)||void 0===Q?void 0:Q.ColumnHeader)||void 0===Z?void 0:Z.QuickFind)||void 0===J?void 0:J.BackgroundColor)||o.colors.BaseColor.White,marginLeft:o.sizes.Measures.Measure200,marginTop:o.sizes.Measures.Measure025}),_e=Object.assign({},y.quickFindStyle),ve=Object.assign(Object.assign({},y.quickFindMobileStyle),{height:o.sizes.Measures.Measure250,marginTop:o.sizes.Measures.Measure025,marginLeft:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure100,marginBottom:o.sizes.Measures.Measure050,backgroundColor:(null===(te=null===(ee=null===($=null==me?void 0:me.Grid)||void 0===$?void 0:$.ColumnHeader)||void 0===ee?void 0:ee.QuickFind)||void 0===te?void 0:te.BackgroundColor)||o.colors.BaseColor.White,width:"100%"}),Ae=Object.assign(Object.assign({},y.dataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px"}),Fe=Object.assign(Object.assign({},y.reflowdataSetContentBodyStyle),{marginLeft:"0px",marginRight:"0px",marginBottom:"0px"}),Ne=Object.assign(Object.assign({},y.chartStyle),{boxSizing:Ze,["border"+(ue?"Left":"Right")]:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure200,paddingRight:o.sizes.Measures.Measure200,backgroundColor:o.colors.BaseColor.White}),De=Object.assign(Object.assign({},y.reflowChartStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure200,paddingRight:o.sizes.Measures.Measure200,backgroundColor:o.colors.BaseColor.White}),Re=Object.assign(Object.assign({},y.reflowChartMobileStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,paddingLeft:o.sizes.Measures.Measure100,paddingRight:o.sizes.Measures.Measure100,backgroundColor:o.colors.BaseColor.White}),Le=Object.assign(Object.assign({},y.reflowGridStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,backgroundColor:o.colors.BaseColor.White}),ke=Object.assign(Object.assign({},y.bodyStyle),{boxSizing:Ze,borderTopWidth:"0px",borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(ae=null===(ne=null==me?void 0:me.Grid)||void 0===ne?void 0:ne.Cell)||void 0===ae?void 0:ae.BackgroundColor)||o.colors.BaseColor.White}),Me=Object.assign(Object.assign({},y.bodyMobileStyle),{boxSizing:Ze,borderBottom:o.borders.Border02,borderTopWidth:"0px",borderTopColor:o.colors.MainThemeColor.MainColor1.Fill,borderTopStyle:"solid",paddingTop:"0px",backgroundColor:(null===(ie=null===(re=null==me?void 0:me.Grid)||void 0===re?void 0:re.Cell)||void 0===ie?void 0:ie.BackgroundColor)||o.colors.BaseColor.White}),Ye=Object.assign(Object.assign({},y.viewSelectorOuterStyle),{minWidth:"40%"}),Ke=Object.assign(Object.assign({},y.viewSelectorOuterMobileStyle),{minWidth:"60%",maxWidth:"calc(100% - "+o.sizes.Measures.Measure400+")"}),We=Object.assign(We,{fontSize:o.fontSizes.Font150,minWidth:"40%"}),Xe=Object.assign(Xe,{fontSize:o.fontSizes.Font125,minWidth:"60%"}),r=Object.assign(Object.assign({},y),{headerStyle:c,headerInnerStyle:g,headerInnerMobileStyle:m,commandManagerContainerStyle:he,commandManagerContainerMobileStyle:be,commandBarStyle:fe,commandBarMobileInnerStyle:ye,quickFindStyle:Ce,quickFindContainerStyle:_e,quickFindMobileStyle:ve,chartStyle:Ne,dataSetContentBodyStyle:Ae,reflowdataSetContentBodyStyle:Fe,titleStyle:We,titleMobileStyle:Xe,reflowChartStyle:De,reflowChartMobileStyle:Re,reflowGridStyle:Le,bodyStyle:ke,bodyMobileStyle:Me,viewSelectorOuterStyle:Ye,viewSelectorOuterMobileStyle:Ke,filterComboStyle:ze,filterContainerStyle:Be,activityTypeFilterContainerStyle:Ve,filterContainerMobileStyle:Ge,filterLabelStyle:He,footerPagingContainer:Qe,activityMgmtLabelStyle:Ue});break;default:he=Object.assign(Object.assign({},y.commandManagerContainerStyle),{flex:"0 1 auto",marginLeft:"0",marginRight:"0",minHeight:o.sizes.Measures.Measure300,backgroundColor:o.colors.BaseColor.White,maxWidth:"35%"}),fe=s(i,h,o),ye=s(i,h,o),r=Object.assign(Object.assign({},y),{commandManagerContainerStyle:he,commandBarStyle:fe,commandBarMobileInnerStyle:ye})}const Je=Object.assign(Object.assign({},y.footerStyle),{backgroundColor:(null===(se=null===(oe=null==me?void 0:me.Grid)||void 0===oe?void 0:oe.Footer)||void 0===se?void 0:se.BackgroundColor)||o.colors.BaseColor.White,height:o.sizes.Measures.Measure300,minHeight:o.sizes.Measures.Measure300}),$e=Object.assign(Object.assign({},y.footerMobileStyle),{borderTop:o.borders.Border02,backgroundColor:(null===(le=null===(ce=null==me?void 0:me.Grid)||void 0===ce?void 0:ce.Footer)||void 0===le?void 0:le.BackgroundColor)||o.colors.BaseColor.White,height:o.sizes.Measures.Measure300,minHeight:o.sizes.Measures.Measure300}),et=Object.assign(Object.assign({},y.footerOuterStyle),{minHeight:o.sizes.Measures.Measure300,height:o.sizes.Measures.Measure300}),tt={marginTop:o.sizes.Measures.Measure300,marginRight:o.sizes.Measures.Measure200,marginLeft:o.sizes.Measures.Measure200},nt={color:o.colors.BaseColor.Blue.Blue3,display:"flex",lineHeight:o.sizes.Measures.Measure100,whiteSpace:"nowrap"},at=Object.assign(Object.assign({},y.seeMoreButtonContainerStyle),{marginLeft:o.sizes.Measures.Measure100,marginRight:o.sizes.Measures.Measure100}),rt={minHeight:o.sizes.Measures.Measure600,height:o.sizes.Measures.Measure600},it={minHeight:o.sizes.Measures.Measure300,height:o.sizes.Measures.Measure300},ot=Object.assign(Object.assign({},y.activityViewContainerStyle),{paddingRight:ue?0:o.sizes.Measures.Measure200,paddingLeft:ue?o.sizes.Measures.Measure200:0});r=Object.assign(Object.assign({},r),{footerStyle:Je,footerMobileStyle:$e,footerEditableGridStyle:et,gridErrorStyle:tt,seeMoreButtonTextStyle:nt,seeMoreButtonContainerStyle:at,defaultFooterHeightStyle:rt,jumpBarLessFooterHeightStyle:it,activityViewContainerStyle:ot,advancedFilterButtonStyles:f})}return r}}},"5iTp":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e,t,n){const r=Object(a.cb)(e,t,n);return r?r.footer:null}},"6Djt":function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("dUiZ"),r=n("nJrx"),i=n("BMZr"),o=n("YxC/"),s=n("BR3n"),c=n("3hnk"),l=n("iZ7K"),u=n("d6Hx"),d=n("GYEz"),h=n("w1eR"),g=n("69Qu"),p=n("sZ+8"),m=n("NjDY");function b(){let e=[];const t=Object(o.h)();return function(n){var b,f,y,C;const _=t(n,s.b),v=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(a.a)(e);if(!t)return null;const n=Object(g.b)(e),r={};for(const a in t.quickCreateMenuItems)if(Object(c.g)(e,a,1,0)){const i=Object(l.h)(e,a);if("email"===a&&i&&i.IsReadOnlyInMobileClient&&Object(d.a)(e)===h.a.MobileApplication)continue;if(!n&&!Object(p.l)(e,i.EntityLogicalName))continue;r[a]=Object.assign(Object.assign({},t.quickCreateMenuItems[a]),{icon:i&&i.IconVectorName?"$webresource:"+Object(m.t)(e)+i.IconVectorName:i.EntityIcon})}return{initialized:Object(a.b)(e),quickCreateMenuItems:r}}(n);if(!v||!_[s.a])return null;const S=v.quickCreateMenuItems,O=Object.keys(S),I=[],j=[],P={};for(const e of O){const t=S[e];P[t.entityDisplayName]=t}const x=Object.keys(P).sort();for(const e of x){const t=P[e],n={Icon:t.icon?t.icon:" ",DisplayText:t.entityDisplayName,Id:Object(r.a)(),DataId:`${u.i}_${t.entityLogicalName}`,execute:Object(i.b)(t.entityLogicalName,void 0,null,null),Tooltip:{title:t.entityDisplayName,description:""!==t.formDescription?t.formDescription:null}};t.isActivity?I.push(n):j.push(n)}if(I.length>0){const e=Object(o.c)(_,s.a);j.unshift({DisplayText:e,Id:Object(r.a)(),DataId:`${u.i}_${e}`,Children:I,WillOpenFlyout:!0,IsInFlyout:!0})}if(0===j.length)return null;if(e.length!==j.length)e=j;else for(let t=0;t<e.length;t++)(null===(b=e[t])||void 0===b?void 0:b.Children)&&(null===(f=j[t])||void 0===f?void 0:f.Children)&&(null===(y=e[t])||void 0===y?void 0:y.Children.length)!==(null===(C=j[t])||void 0===C?void 0:C.Children.length)&&(e=j);return e}}},"6Qf/":function(e,t,n){"use strict";n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return y})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return f}));var a=n("SAYH"),r=n("dHD5"),i=n("BFlg"),o=n("ZJsz"),s=n("P6DH"),c=n("3/02"),l=n("Lyxw"),u=n("ujVH"),d=n("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const h="grid.initialize",g="grid.initialize.xrmready";function p(e,t,n){return{type:"grid.preinitialize.sync",sync:!0,execute({dispatch:a,getState:r},o){const s=i.x+".gridPreInitializedAction";try{a(b(null,e,t,n,void 0,void 0,void 0,void 0,null));const r=[{name:"entityTypeName",value:e}];return o.EventManager.ReportComponentSuccess(s,r),Promise.resolve(void 0)}catch(t){const n="Failed for "+e+" with error "+t.message;return o.EventManager.ReportComponentFailure(s,Error(n)),Promise.resolve(void 0)}}}}function m(e,t,n,a,r,d,h,g,p){return e?{type:"grid.initialize.async",execute({dispatch:m,getState:f},y){const C=i.x+".gridInitializedAction";try{let i=null;Object(l.c)(f(),c.zb)&&(i=function(e,t,n){const a=Object(s.v)(e,t,n),r=Object.assign({},o.a);return a&&(a.filters&&(r.filters=a.filters),a.customFilter&&(r.customFilter=a.customFilter),a.pageNumber&&(r.pageNumber=a.pageNumber),a.pagingRefreshInput&&(r.pagingRefreshInput=a.pagingRefreshInput)),r}(f(),n,a)),m(b(e,t,n,a,r,d,h,g,i,p));const _=[];_.push({name:"entityTypeName",value:t}),y.EventManager.ReportComponentSuccess(C,_);return Object(l.c)(f(),c.L)&&m(Object(u.b)(n,a)),Promise.resolve(void 0)}catch(e){const n="Grid initialized failed for entity type "+t;return y.EventManager.ReportComponentFailure(C,Error(n)),Promise.reject(void 0)}}}:null}function b(e,t,n,s,c,l,u,g,p,m){const b=c&&c.Parameters?c.Parameters[i.j]:null;try{let c=!0;b&&(c="true"===b);const f=Object(r.u)(s),y={contextKey:f,initialDataSetState:Object.assign(Object.assign(Object.assign({},o.a),p),{viewId:e?e.viewId:null,fetchXml:e?e.fetchXml:null,relationshipName:l,relationshipRoleOrdinal:u,useRollupView:g||!1,commandManagerId:m||Object(d.d)(n,s),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:e&&e.viewId?a.a.toString(e.viewId):null},1:{Name:i.j,Value:c},2:{Name:i.u,Value:t}}}}})};return{type:h,payload:y,meta:{pageId:n,contextKey:f}}}catch(e){throw Error(e)}}function f(e,t,n,s){const c=Object(r.u)(s),l=a.a.tryParseOrNull(t),u={contextKey:c,initialDataSetState:Object.assign(Object.assign({},o.a),{viewId:l||null,fetchXml:null,commandManagerId:Object(d.d)(n,s),controls:{homepageGrid:{parameters:{0:{Name:i.C,Value:t||null},1:{Name:i.j,Value:!1},2:{Name:i.u,Value:e}}}}})};return{type:h,payload:u,meta:{pageId:n,contextKey:c}}}function y(e,t,n,a){return t(e.ScriptManager.getContainer(a).getEventManager().loadGridScripts(n,a))}},"6sVS":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("3I29");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e){return e&&e.userSettings?e.userSettings.userAccessibilitySettings.toastNotification:{toastNotificationDisplaySpeed:a.a.Normal}}function i(e){return e.userSettings.personalSettingsForMobileApp}},"6u68":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="offline.upsync.pending";function i(){const e={upSyncStatus:a.a.Pending};return{type:r,payload:e}}},"7+p5":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("Lyxw"),r=n("3/02"),i=n("IqkD");function o(e){if(Object(a.a)(e,r.S,r.h)){return!!Object(a.a)(e,r.d,r.Lc)||1033===Object(i.s)(e)}return!1}},"7TDv":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="formSelector.visible";function r(e,t,n){return{type:a,payload:{visible:n},meta:{pageId:e,formId:t}}}},"7k+e":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n("dHD5"),r=n("BFlg");const i="chart.drilldownparameters.update",o="ChartDrillDownParameters";function s(e,t,n){return{type:"chart.drilldownparameters.update.async",execute({dispatch:s,getState:c},l){const u=l.TraceManager.getTracer(r.z),d=r.x+".updateChartDrillDownParametersAction";try{u.info("Updating the chart drilldown parameters"),t||(t=Object(a.k)(c(),e));const r=Object(a.v)(t);return s(function(e,t,n){return{type:i,payload:{name:o,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,r,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart drilldown parameters failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},"8O0c":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("Lyxw"),r=n("53SR"),i=n("Nb1E"),o=n("7tM0"),s=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="ProcessControl_ActionExecuter_ExecutionTimeTooltip",l="ProcessControl_ActionExecuter_ErrorMessageTooltip",u="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources";var d;function h(e){switch(e){case d.InProgress:case d.Waiting:return 1;case d.Succeeded:return 2;case d.Failed:case d.Canceled:return 3;default:return 0}}function g(e,t,n,a){let r="";if(Object(s.b)(e)||(r=String.format(a[c],new Date(e).toLocaleString())),n===d.Failed){const e=Object(s.b)(t)?a.Crm_GenericErrorMessage:t;r+="\n"+String.format(a[l],e)}return""===r?t:r}function p(e,t){return{type:"businessProcessFlow.actionLogs.retrieve",execute({dispatch:n,getState:s},d){const p=String.format("?$select=workflowlogid,message,status,modifiedon,stepname,activityname,_asyncoperationid_value&$filter=activityname%20eq%20'{0}'%20and%20_asyncoperationid_value%20eq%20{1}&$orderby=modifiedon%20desc&$top=500",e.guid,t.id.guid),m=s();if(function(e){return Object(a.b)(e,"BpfActionSupportActionQuerying")}(m))return n(Object(i.e)("workflowlog",p)).then(e=>{if(e.value&&e.value.length){const a={};a[c]=Object(o.a)(m,u,c),a[l]=Object(o.a)(m,u,l),a.Crm_GenericErrorMessage=Object(o.a)(m,u,"Crm_GenericErrorMessage");const i={};e.value.forEach(e=>{if(e.stepname&&-1===Object.keys(i).indexOf(e.stepname)){const t={actionLogId:e.workflowlogid,status:h(e.status),modifiedOn:e.modifiedon,stepId:e.stepname,processDefinitionid:e.activityname,processInstanceid:e._asyncoperationid_value,message:g(e.modifiedon,e.message,e.status,a)};i[e.stepname]=t}});const s={actionLogCollection:i};return n(Object(r.a)(s,t))}})}}}!function(e){e[e.InProgress=1]="InProgress",e[e.Succeeded=2]="Succeeded",e[e.Failed=3]="Failed",e[e.Canceled=4]="Canceled",e[e.Waiting=5]="Waiting"}(d||(d={}))},"91Ew":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.option.add";function i(e,t,n,i,o){const s=Object(a.x)(t);return{type:r,payload:{option:i,index:o},meta:{pageId:e,contextKey:s,dataFieldName:n}}}},"95wm":function(e,t,n){"use strict";n.d(t,"f",(function(){return g})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return y}));var a=n("SAYH"),r=n("eXjw"),i=n("GEBM"),o=n("haag"),s=n("0L4T"),c=n("iZ7K"),l=n("YxC/"),u=n("69Qu"),d=n("WPtp"),h=n("LbMF");const g=o.a;function p(e,t,n,r,d,h,p,m=!1){return function(e,t,n){if(!a.a.toString(n.viewId)){const n="viewid is required to call retrieve chart data";throw e.EventManager.ReportComponentFailure(g+".retrieveChartData",Error(n),o.d,t),new Error(n)}return!0}(n,r,d)&&function(e,t,n,r,o){if(!a.a.toString(n.visualizationId)||a.a.toString(n.visualizationId)===a.a.EMPTYGUIDSTRING){const a=e(),u=Object(l.b)(a,i.n),d=Object(c.f)(a,r)||r,h=String.format(u,d);return Object(s.a)(a,t,h,n,o),!1}return!0}(e,t,d,h,p)&&function(e,t,n,a){const r=e();if(!Object(u.b)(r)){const e=Object(l.b)(r,i.r);return Object(s.a)(r,t,e,n,a),!1}return!0}(e,t,d,p)&&function(e,t,n,a){if(n.isRollUpView){const r=e(),o=Object(l.b)(r,i.j);return Object(s.a)(r,t,o,n,a),!1}return!0}(e,t,d,p)&&(!m||function(e,t,n,a){if(!n.viewXml){const r=Object(l.b)(e(),i.g);return Object(s.a)(e(),t,r,n,a),!1}return!0}(e,t,d,p)&&function(e,t,n,a){if(!n.fetchXml){const r=Object(l.b)(e(),i.o);return Object(s.a)(e(),t,r,n,a),!1}return!0}(e,t,d,p))}function m(e,t,n){const i=new a.a(e),o=a.a.toString(i),s=new a.a(t);return{type:n,payload:{charts:{[o]:{[a.a.toString(s)]:{initialized:r.a.Initializing}}}}}}function b(e,t){return{type:t,payload:{chartData:{[e]:{initialized:r.a.Initializing}}}}}function f(e,t,n){var a;const r=null===(a=null==e?void 0:e.category)||void 0===a?void 0:a.primaryGroupBy,i=null==r?void 0:r.groupAttribute;if(!function(e,t){var n;if(!e)return!1;const a=null===(n=null==e?void 0:e.entity)||void 0===n?void 0:n.entityName,r=null==e?void 0:e.attributeName,i=Object(h.b)(r,a,t);return"picklist"===i||"state"===i||"status"===i}(i,n))return;if(!e.isOrderPresentOnPrimaryGroupBy())return;const o=i.aliasName,s=new C(o);t.sort(s.comparator),r.descending&&t.reverse()}function y(e){const t=/(Name=\"o\:)(\w+)(,)(\d+)(\")/,n=e.match(new RegExp(t,"g"));let a=[];return n&&n.forEach(e=>{a=e.match(new RegExp(t,"m"))}),a}class C{constructor(e){this._primaryGroupByAttributeAlias=null,this.comparator=(e,t)=>this._getRawValue(e)-this._getRawValue(t),this._primaryGroupByAttributeAlias=e}_getRawValue(e){if(this._primaryGroupByAttributeAlias in e.fields){const t=e.fields[this._primaryGroupByAttributeAlias],n=Object(d.e)(t);return parseInt(n,10)}return-1}}},"9NSo":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="form.setLabel";function i(e,t,n){const i=Object(a.v)(t);return{type:r,payload:{label:n},meta:{pageId:e,contextKey:i}}}},"9bCE":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="offline.database.cleanup";function r(e){return{type:a,payload:{isDbCleanupNeeded:e}}}},"9gu/":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("dHD5"),r=n("i1f0"),i=n("SoKF"),o=n("gQ5I"),s=n("cUbT"),c=n("7Sr4");function l(e,t){return{type:"cancel.quickCreateFormAction.async",execute({dispatch:n,getState:o},s){const l=o(),d=Object(a.j)(o(),e);return c.a.getInstance().checkForOutstandingWork(o()).then(()=>{if(Object(r.Nb)(l,e,d)){return n(Object(i.a)(e)).then(a=>{if(!a)return Promise.resolve({});u(n,e,t)})}u(n,e,t)})}}}function u(e,t,n){if(n&&n.length>0){e(Object(o.e)(t,"save"));const a=[n[0].etn];for(let e=1;e<n.length;e++){let t=!1;for(let r=0;r<a.length;r++)a[r]===n[e].etn&&(t=!0);t||a.push(n[e].etn)}for(let t=0;t<a.length;t++)e(Object(s.a)(a[t]))}else e(Object(o.e)(t))}},"9i5P":function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n("OQLa"),r=n("SAYH"),i=n("16wZ"),o=n("UqyN"),s=n("L8zx"),c=n("3yqi"),l=n("EOIL"),u=n("P6DH"),d=n("qshH"),h=n("9ksH"),g=n("E7fB"),p=n("n6Qt"),m=n("arV0"),b=n("deGN"),f=n("ZIjf");let y;class C{constructor(e,t,n,a,r,o){const s="ClientApi.XrmGridRow.constructor";e||Object(i.j)(s,"store"),a||Object(i.j)(s,"pageId"),n||Object(i.j)(s,"contextToken"),r||Object(i.j)(s,"entityType"),o||Object(i.j)(s,"entityId"),y=e,this._applicationContext=t,this._pageId=a,this._contextToken=n,this._entityType=r,this._entityId=o}get applicationContext(){return f.a.instance.reportUsage("ClientApi.XrmGridRow.applicationContext_get"),this._applicationContext}get context(){const e="ClientApi.XrmGridRow.context";try{return f.a.instance.reportCall(e),this._globalContext||(this._globalContext=new g.a(y,this._pageId)),f.a.instance.reportSuccess(e),this._globalContext}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}get data(){const e="ClientApi.XrmGridRow.data";try{if(f.a.instance.reportCall(e),!this._data){const t=new o.a(y,this._contextToken,this._pageId,this,this._entityType,this._entityId,_,this._applicationContext);this._data=new s.a(y,this._contextToken,this._pageId,this,t);const n=new h.b(y,this._pageId),a=[],i={isEventParam:!0,name:"attributeName",value:""};a.push(i),t.attributes.forEach(t=>{const o=t.getName();i.value=o;const s={Id:o,Label:null,Name:o,ShowLabel:!1,Visible:!0,ClassId:new r.a(h.a),Disabled:!1,DataFieldName:o},c=n.createXrmControl(this._contextToken,s,this,e,a);c&&t.controls.add(c.getName(),c)})}return f.a.instance.reportSuccess(e),this._data}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(e,t,null,n),t}}getData(){try{return f.a.instance.reportUsage("ClientApi.XrmGridRow.getData"),this.data}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.getData",e,null,t),e}}get ui(){try{if(f.a.instance.reportCall("ClientApi.XrmGridRow.ui"),!this._ui){const e=new h.b(y,this._pageId);this._ui=new l.a(y,this._contextToken,this._pageId,this,this._entityType,e)}return f.a.instance.reportSuccess("ClientApi.XrmGridRow.ui"),this._ui}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.ui",e,null,t),e}}getControl(e){const t="ClientApi.XrmGridRow.getControl";try{f.a.instance.reportCall(t);const n=this.ui.controls.get(e);return f.a.instance.reportSuccess(t),n}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getAttribute(e){const t="ClientApi.XrmGridRow.getAttribute";try{if(f.a.instance.reportCall(t),this.data.entity){const n=this.data.entity.attributes.get(e);return f.a.instance.reportSuccess(t),n}return f.a.instance.reportSuccess(t),null}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}getUrl(e){const t="ClientApi.XrmGridRow.getUrl";try{f.a.instance.reportCall(t);const n=this.data.entity.getEntityReference();this._internal=new p.a(y,this._applicationContext,this.context,this._pageId);const i=Object(m.g)(y.getState(),this._pageId),o={entityTypeName:n.entityType,etn:n.name,id:r.a.fromExternalGuid(n.id),entityTypeCode:this._internal.getEntityCode(n.entityType),languageId:this.context.userSettings.languageId,recordSetQueryKey:i.recordSetQueryKey};if(1===e){const e=y.dispatch(Object(a.a)(c.a.EditForm,o));return f.a.instance.reportSuccess(t),e}const s=Object(b.a)(y,this._pageId),l=y.dispatch(Object(a.c)(s,c.a.EditForm,o));return f.a.instance.reportSuccess(t),l}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure(t,e,null,n),e}}get entityReference(){try{return this.data.entity.getEntityReference()}catch(e){const t=d.a.getInstance().getEventParameters(this._contextToken);throw t.push({name:"entityType",value:this._entityType}),d.a.getInstance().reportFailure("ClientApi.XrmGridRow.entityReference",e,null,t),e}}}function _(e,t,n){const a=Object(u.D)(y.getState(),{id:n},t.parentContextToken);return a||(e.TraceManager.getTracer("ClientApi.XrmGridRow.getAttributeNames").error("Grid attributes was null"),[])}},"9ksH":function(e,t,n){"use strict";n.d(t,"b",(function(){return Ee})),n.d(t,"a",(function(){return Pe}));var a=n("AF/G"),r=n("arV0"),i=n("HcnX"),o=n("i1f0"),s=n("TsER"),c=n("qshH"),l=n("ZIjf");let u;class d extends i.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),u=e}refresh(){const e="ClientApi.XrmControlTimer.refresh";try{l.a.instance.reportCall(e),u.dispatch(Object(s.b)(this.pageId,this.contextToken,this.name)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getState(){const e="ClientApi.XrmControlTimer.getState";try{l.a.instance.reportCall(e);const t=Object(o.cb)(u.getState(),this.pageId,this.contextToken),n=t.controls[this.getName()].parameters.timerState;return l.a.instance.reportSuccess(e),n}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlTimer.getControlType"),"timercontrol"}}var h=n("lJW1"),g=n("1kth"),p=n("16wZ"),m=n("PUjk");let b;class f extends i.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),b=e,this.registerObserversForControlStateChange()}addOnClick(e){const t="ClientApi.XrmControlButton.addOnClick";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(g.b)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnClick(e){const t="ClientApi.XrmControlButton.removeOnClick";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),b.dispatch(Object(g.w)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlButton.getControlType"),"button"}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(m.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}}var y=n("0nOn"),C=n("yl9a"),_=n("NjDY"),v=n("3mEc");let S;class O extends i.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),S=e;const o=[{name:"controlName",value:r,isEventParam:!0}];this._clientApiExecutorWebResource=new y.a(e,"ClientApi.XrmControlWebResource.",n,t,o)}getSrc(){return this._clientApiExecutorWebResource.execute("getSrc",()=>{const e=S.getState(),t=Object(_.t)(e)+Object(o.wb)(e,{controlName:this.name,id:this.pageId},this.contextToken);return Object(v.c)(e,this.pageId,this.name,this.contextToken,t)})}getContentWindow(){return this._clientApiExecutorWebResource.executeAsync("getContentWindow",(e,t)=>{const n=this.formContext.applicationContext.TraceManager.getTracer(e),a=()=>{const e=Object(o.xb)(S.getState(),this.pageId,this.getName());if(e){let a=null;try{return a=e.contentWindow,"complete"===a.document.readyState?Promise.resolve(a):(t.push({name:"readyState",value:a.document.readyState}),n.info("Frame content window not ready",t),Promise.reject({message:"Frame element not ready.",errorCode:111,contentWindow:a}))}catch(e){return a?(t.push({name:"Error",value:e.message}),n.warn("Error getting Frame content window readyState",t),Promise.resolve(a)):Promise.reject(e)}}else n.info("Frame DOM element not ready",t);return Promise.reject({message:"Frame element could not be found.",errorCode:111})};return a().then(e=>Promise.resolve(e)).catch(e=>{if(111!==e.errorCode)return Promise.reject(e);const r=this.contextToken,i=this.pageId,o=this.getName();return new Promise((e,s)=>{const c=()=>{Object(g.G)(r,i,c,o),a().then(t=>{e(t)}).catch(a=>{a.contentWindow?(n.err("Frame content window readyState should be complete after OnReadyStateComplete",t),e(a.contentWindow)):s&&(111===a.errorCode?(n.err("Frame Element not found after OnReadyStateComplete",t),s(new Error("Frame element could not be found."))):s(a))})};S.dispatch(Object(g.l)(r,i,c,o))})})})}getObject(){return this._clientApiExecutorWebResource.execute("getObject",()=>Object(o.xb)(S.getState(),this.pageId,this.name))}setSrc(e){return this._clientApiExecutorWebResource.execute("getControlType",()=>{Object(p.a)(e)||S.dispatch(Object(C.b)(this.pageId,this.name,this.contextToken,e))})}getControlType(){return this._clientApiExecutorWebResource.execute("getControlType",()=>"webresource")}addOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("addOnReadyStateComplete",()=>{S.dispatch(Object(g.l)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}removeOnReadyStateComplete(e){return this._clientApiExecutorWebResource.execute("removeOnReadyStateComplete",()=>{S.dispatch(Object(g.G)(this.contextToken,this.pageId,e,this.getName()))},[{name:"handler",value:e,isRequired:!0}])}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let I;class j extends O{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),I=e}getInitialUrl(){const e="ClientApi.XrmControlIFrame.getInitialUrl";try{l.a.instance.reportCall(e);const t=Object(o.sb)(I.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlIFrame.getControlType"),"iframe"}getSrc(){const e="ClientApi.XrmControlIFrame.getSrc";try{l.a.instance.reportCall(e);const t=I.getState(),n=this.getInitialUrl(),a=Object(v.c)(t,this.pageId,this.name,this.contextToken,n);return l.a.instance.reportSuccess(e),a}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}}var P=n("bGh0"),x=n("/5se"),E=n("xorU"),w=n("fREn"),T=n("hA8P"),A=n("SAYH"),F=n("/q65");let N;class k extends P.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),N=e,this._clientApiExecutorLookup=new y.a(e,"ClientApi.XrmControlLookup.",n,t,[{name:"controlName",value:r,isEventParam:!0}])}addCustomView(e,t,n,a,r,i){this._clientApiExecutorLookup.execute("addCustomView",(o,s)=>{const c=A.a.tryParseOrNull(e);c||Object(p.k)(o,"guid","viewId",s),N.dispatch(Object(w.a)(this.pageId,this.name,c,t,this.contextToken,n,a,r)),i&&this.setDefaultView(e)},[{name:"viewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"},{name:"entityLogicalName",value:t,isRequired:!0,isEventParam:!0},{name:"viewDisplayName",value:n,isRequired:!0},{name:"fetchXml",value:a,isRequired:!0},{name:"layoutXml",value:r,isRequired:!0},{name:"isDefault",value:i,isRequired:!0}])}addCustomFilter(e,t){const n="ClientApi.XrmControlLookup.addCustomFilter";Object(p.a)(e)&&Object(p.j)(n,"fetchXmlFilter"),Object(p.b)(e)||Object(p.l)(n);try{l.a.instance.reportCall(n),N.dispatch(Object(E.d)(this.pageId,this.name,t,this.contextToken,e)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}get disableMru(){const e="ClientApi.XrmControlLookup.getDisableMru";try{l.a.instance.reportCall(e);const t=Object(o.x)(N.getState(),{id:this.pageId,controlName:this.name},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}set disableMru(e){const t="ClientApi.XrmControlLookup.setDisableMru";try{l.a.instance.reportCall(t),N.dispatch(Object(T.b)(N.getState(),this.pageId,this.name,this.contextToken,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}startCustomFilter(){const e="ClientApi.XrmControlLookup.startCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.f)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}endCustomFilter(){const e="ClientApi.XrmControlLookup.endCustomFilter";try{l.a.instance.reportCall(e),N.dispatch(Object(E.e)(this.pageId,this.name,this.contextToken)),this.controlStateObservable.notifyObservers(this.controlDescriptor),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getDefaultView(){return this._clientApiExecutorLookup.execute("getDefaultView",()=>{const e=Object(o.O)(N.getState(),this.pageId,this.name,this.contextToken);return e?A.a.externalGuid(new A.a(e)):null})}setDefaultView(e){this._clientApiExecutorLookup.execute("setDefaultView",(t,n)=>{const a=A.a.tryParseOrNull(e);a||Object(p.k)(t,"guid","id",n),N.dispatch(Object(x.b)(this.pageId,this.name,this.contextToken,a))},[{name:"defaultViewId",value:e,isRequired:!0,isEventParam:!0,expectedDataType:"guid"}])}addOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.addOnLookupTagClick";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(g.g)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}addPreSearch(e){const t="ClientApi.XrmControlLookup.addPreSearch";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(g.t)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnLookupTagClick(e){const t="ClientApi.XrmControlLookup.removeOnLookupTagClick";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(g.B)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}removePreSearch(e){const t="ClientApi.XrmControlLookup.removePreSearch";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),N.dispatch(Object(g.O)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlLookup.getControlType"),"lookup"}getEntityTypes(){const e="ClientApi.XrmControlLookup.getEntityTypes";try{l.a.instance.reportCall(e);const t=Object(o.Ob)(N.getState(),this.pageId,this.contextToken,this._dataFieldName);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}setEntityTypes(e){const t="ClientApi.XrmControlLookup.setEntityTypes";e||Object(p.j)(t,"entityTypes");const n=[];try{l.a.instance.reportCall(t),e=Array.from(new Set(e));const a=Object(o.Pb)(N.getState(),this.pageId,this.contextToken,this._dataFieldName),r={};a.forEach(e=>{r[e]=!0}),e.forEach(e=>{r[e]||n.push(e)})}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t+".validation",e,null,n),e}n.length>0&&Object(p.h)(t,"entityType",n[0]);try{N.dispatch(Object(F.b)(this.pageId,this.contextToken,this._dataFieldName,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}get _dataFieldName(){return this.controlDescriptor&&this.controlDescriptor.DataFieldName?this.controlDescriptor.DataFieldName:this.name}}var M=n("91Ew"),D=n("KnyI"),R=n("tvJg");let L;class B extends P.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),L=e;const o=[{name:"controlName",value:r,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorOptionsetBase=new y.a(e,"ClientApi.XrmControlOptionSetBase.",n,t,o)}addOption(e,t){this._clientApiExecutorOptionsetBase.execute("addOption",()=>{const n=this._options.length;Object(p.a)(t)||isNaN(t)||t>=n?t=n:t<=0?t=0:t-=1,L.dispatch(Object(M.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,{Color:null,Label:e.text,Value:e.value},t))},[{name:"optionSetItem",value:e,isRequired:!0},{name:"optionSetItem.value",value:null==e?void 0:e.value,isRequired:!0,expectedDataType:"number"}])}clearOptions(){this._clientApiExecutorOptionsetBase.execute("clearOptions",()=>{L.dispatch(Object(R.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName))})}removeOption(e){return this._clientApiExecutorOptionsetBase.execute("removeOption",()=>{L.dispatch(Object(D.b)(this.pageId,this.contextToken,this.controlDescriptor.DataFieldName,e))},[{name:"value",value:e,isRequired:!0}])}getOptions(){return this._clientApiExecutorOptionsetBase.execute("getOptions",()=>this._options)}get _options(){const e=new Array,t=Object(o.B)(L.getState(),this.pageId,this.contextToken,this.name);if(t){t.length&&e.push({text:"",value:NaN});for(const n in t)e.push({text:t[n].Label,value:t[n].Value})}return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class V extends B{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlOptionSet.getControlType"),"optionset"}}var G=n("cf3Y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let z;class W extends P.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),this._isDateFormatDateTime=!1,z=e,this._clientApiExecutorDateTime=new y.a(e,"ClientApi.XrmControlDateTime.",n,t,[{name:"controlName",value:r,isEventParam:!0}]),this._clientApiExecutorDateTime.execute("constructor",(e,t)=>{this._isDateFormatDateTime=this._getShowTime(e,t)},null,!1)}getShowTime(){return this._clientApiExecutorDateTime.execute("getShowTime",(e,t)=>this._getShowTime(e,t))}setShowTime(e){this._clientApiExecutorDateTime.execute("setShowTime",(t,n)=>{if(this._getShowTime(t,n)!==e){const t=e&&this._isDateFormatDateTime?"datetime":"date";z.dispatch(Object(G.b)(this.pageId,this.contextToken,this.name,t))}})}_getShowTime(e,t){const n=this.getAttrDescriptor(e,t,this._clientApiExecutorDateTime);return!n||"datetime"===n.Format}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class X extends B{getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlMultiSelectOptionSet.getControlType"),"multiselectoptionset"}}var H=n("455M"),U=n("zgeC"),q=n("dHD5"),Y=n("HAeo"),K=n("ghNp"),Q=n("P6DH");let Z;class J extends i.a{constructor(e,t,n,a,r){super(e,t,n,a,a.Name,r);const i=Object(q.e)(t,a.Name);e.dispatch(Object(K.a)(this,n,i)),Z=e,this._clientApiExecutorControlstream=new y.a(e,"ClientApi.XrmControlStream.",n,t)}get clientApiExecutor(){return this._clientApiExecutorControlstream}_getGridControls(){if(!this._underlyingGridControls){this._underlyingGridControls=[];const e=this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[0]&&this.controlDescriptor.Parameters[0].StreamObjects;if(e){const t=e.StreamObjectCollection;if(t){const e=t.ShowAsTiles?[!0,!1]:[!0];for(const n of t)for(const t of e){const e=Object(q.o)(this.contextToken,this.getName(),n.Id,t),a=new Y.a(Z,e,this.pageId,!1,3,!0,this.formContext.applicationContext,e.controlName);this._underlyingGridControls.push({contextToken:e,gridControl:a})}}}}return this._underlyingGridControls}refresh(){this.clientApiExecutor.execute("refresh",()=>{const e=[];for(const{contextToken:t,gridControl:n}of this._getGridControls()){if(Object(Q.hb)(Z.getState(),this.pageId,t,t.controlName))try{n.refresh()}catch(t){e.push(t)}}if(e.length>0){const t=[...c.a.getInstance().getEventParameters(this.contextToken),{name:"count",value:e.length}];Object(p.e)(this.clientApiExecutor.getComponentName("refresh"),"Some grids in stream failed to refresh",null,t)}})}}var $=n("odYE"),ee=n("6QGX"),te=n("tpZ5"),ne=n("E7fB"),ae=n("jq7Z"),re=n("zsAz"),ie=n("IaGr");let oe;class se extends i.a{constructor(e,t,n,a,r,i){super(e,t,n,a,a.Name,r),oe=e,this._clientApiExecutor=new y.a(e,"ClientApi.XrmControlSubFormBase.",n,t,[{name:"controlName",value:null==a?void 0:a.Name,isEventParam:!0}]),this._xrmControlFactory=i}getParentComponent(){return Object(ae.a)(oe.getState(),this.pageId)}get context(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.context",()=>this._form?this._form.context:null)}get _parentFormContext(){return this.formContext}get _form(){if(this._tryGetSubFormInstanceId(),!this._isSubFormMetadataLoaded())throw Object(re.d)("SUBFORM_METADATA_NOT_LOADED",2415919107);const e=this._subFormControlContextToken;if(e&&this._formInstance)return this._formInstance;const t=this._getValueInternal(),n=Object(ee.d)(t);if(e)return this._formInstance=oe.dispatch(Object(K.b)(this._subFormInstanceId,e)),this._formInstance||n&&n.length>0&&(this._formInstance=oe.dispatch(this._createXrmForm(e,this._subFormInstanceId,n[0].entityType,new A.a(n[0].id)))),this._formInstance&&!this._formInstance.context&&(this._formInstance.context=this._parentFormContext.context),this._formInstance;return c.a.getInstance().getEventParameters(this.contextToken).push({name:"controlName",value:this.getName()}),ie.a.getInstance().traceManager.getTracer("ClientApi.XrmControlSubFormBase._form").info("XrmControlSubForm._form is null"),null}_createXrmForm(e,t,n,a){const r=this._xrmControlFactory;return{type:"clientapi.create.xrmform",sync:!0,execute(i,o){const s=new te.a(i,{etn:n,id:a},r,e,t);s.applicationContext=o;const c=new ne.a(i,t);return s.context=c,s}}}get _subFormControlContextToken(){const e=this._getValueInternal(),t=Object(ee.d)(e);return t&&t[0]&&t[0].id?this._entityRecordId!==t[0].id&&(this._entityType=t[0].entityType,this._entityRecordId=t[0].id,this._subFormContextToken&&oe.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=this._getSubFormContextToken(this.contextToken,this.name,this._entityType),this._formInstance=null):this._subFormContextToken&&(oe.dispatch(Object(K.h)(this._subFormInstanceId,this._subFormContextToken)),this._subFormContextToken=void 0,this._entityType=void 0,this._entityRecordId=void 0,this._formInstance=null),this._subFormContextToken}get data(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.data",()=>this._form?this._form.data:null)}get ui(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.ui",()=>this._form?this._form.ui:null)}get entityReference(){return l.a.instance.reportUsage("ClientApi.XrmControlSubFormBase.entityReference"),null}getControl(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getControl",()=>this._form?this._form.getControl(e):null)}getAttribute(e){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getAttribute",()=>this._form?this._form.getAttribute(e):null)}getUrl(){return this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.getUrl",()=>this._form?this._form.getUrl():null)}refresh(){this._clientApiExecutor.execute("ClientApi.XrmControlSubFormBase.refresh",()=>{this.data&&this.data.refresh()})}_getValueInternal(){const e=this._parentFormContext.data.entity.getEntityName(),t=this._parentFormContext.data.entity.getId(),n=t?new $.a(e,new A.a(t)):new $.a(e),a=Object(o.ac)(oe.getState(),this._subFormInstanceId,this.contextToken);return Object(o.X)(oe.getState(),this._subFormInstanceId,this._subFormContextToken,a,n,this.controlDescriptor.DataFieldName)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ce;class le extends se{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),ce=e}_getSubFormContextToken(e,t,n){return Object(q.l)(this.contextToken,this.name,this._entityType)}getSubFormInstanceId(){return this.pageId}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_tryGetSubFormInstanceId(){}get _subFormInstanceId(){return this.pageId}isLoaded(){const e="ClientApi.XrmControlQuickForm.isLoaded";try{l.a.instance.reportCall(e);const t=Object(o.ic)(ce.getState(),this.getSubFormInstanceId(),this._subFormControlContextToken);return l.a.instance.reportSuccess(e),!!t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlQuickForm.getControlType"),"quickform"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ue;class de extends P.a{constructor(e,t,n,a,r,i){e||Object(p.j)("ClientApi.XrmStandardDataControl.constructor","store"),super(e,t,n,a,r,i),ue=e}getValue(){const e="ClientApi.XrmStandardDataControl.getValue";try{l.a.instance.reportCall(e);const t=Object(o.F)(ue.getState(),{controlName:this.name,id:this.pageId},this.contextToken);return l.a.instance.reportSuccess(e),t}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}addOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.addOnKeyPress";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(g.e)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}removeOnKeyPress(e){const t="ClientApi.XrmStandardDataControl.removeOnKeyPress";e||Object(p.j)(t,"handler");try{l.a.instance.reportCall(t),ue.dispatch(Object(g.z)(this.contextToken,this.pageId,this.name,e)),l.a.instance.reportSuccess(t)}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(t,e,null,n),e}}fireOnKeyPress(){const e="ClientApi.XrmStandardDataControl.fireOnKeyPress";try{l.a.instance.reportCall(e),ue.dispatch(Object(g.R)(this.contextToken,this.pageId,this.name,this)),l.a.instance.reportSuccess(e)}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),c.a.getInstance().reportFailure(e,t,null,n),t}}}var he=n("ywwS"),ge=n("VqBP"),pe=n("w92Z");class me extends V{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),this._clientApiExecutorDependentOptionSet=new y.a(e,"ClientApi.XrmControlDependentOptionSet.",n,t,[{name:"controlName",value:r,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(p.i)(e,"DependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(p.i)(e,"DependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(p.i)(e,"DependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(p.i)(e,"DependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(p.i)(e,"DependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends X{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),this._clientApiExecutorDependentOptionSet=new y.a(e,"ClientApi.XrmControlMultiSelectDependentOptionSet.",n,t,[{name:"controlName",value:r,isEventParam:!0}])}addOption(e,t){return this._clientApiExecutorDependentOptionSet.execute("addOption",(e,t)=>{Object(p.i)(e,"MultiSelectDependentOptionSet.addOption",t)})}clearOptions(){return this._clientApiExecutorDependentOptionSet.execute("clearOptions",(e,t)=>{Object(p.i)(e,"MultiSelectDependentOptionSet.clearOptions",t)})}removeOption(e){return this._clientApiExecutorDependentOptionSet.execute("removeOption",(e,t)=>{Object(p.i)(e,"MultiSelectDependentOptionSet.removeOption",t)})}setDisabled(e){return this._clientApiExecutorDependentOptionSet.execute("setDisabled",(e,t)=>{Object(p.i)(e,"MultiSelectDependentOptionSet.setDisabled",t)})}setVisible(e){return this._clientApiExecutorDependentOptionSet.execute("setVisible",(e,t)=>{Object(p.i)(e,"MultiSelectDependentOptionSet.setVisible",t)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fe extends de{setDisabled(e){const t="ClientApi.XrmDependentOptionSetGridControl.setDisabled";l.a.instance.reportUsage(t),Object(p.e)(t,String.format("Can not execute {0} for dependent option set control","setDisabled"))}}var ye=n("LbMF"),Ce=n("3/02"),_e=n("Lyxw"),ve=n("Z/4N"),Se=n("BoVI");let Oe;class Ie extends se{constructor(e,t,n,a,r,i){var o,s;super(e,t,n,a,r,i),this._formInstanceId=null===(s=null===(o=this.getParentComponent())||void 0===o?void 0:o.formInstances)||void 0===s?void 0:s.formInstanceIdByControlName[this.controlDescriptor.Name],this._formComponentClientApiExecutor=new y.a(e,"ClientApi.XrmControlFormComponent.",this._formInstanceId),this._formComponentClientApiExecutor.addEventParameter({name:"controlName",value:a.Name,isEventParam:!0}),Oe=e}_tryGetSubFormInstanceId(){var e,t;this._formInstanceId||(this._formInstanceId=null===(t=null===(e=this.getParentComponent())||void 0===e?void 0:e.formInstances)||void 0===t?void 0:t.formInstanceIdByControlName[this.controlDescriptor.Name])}_isSubFormMetadataLoaded(){return!!this._subFormInstanceId}_getSubFormContextToken(e,t,n){return Object(q.h)(n)}get _subFormInstanceId(){return this._formInstanceId}isLoaded(){return this._isSubFormMetadataLoaded()&&this._formComponentClientApiExecutor.execute("ClientApi.XrmControlFormComponent.isLoaded",()=>!!Object(o.yc)(Oe.getState(),this._subFormInstanceId,this._subFormControlContextToken))}setInitializationIntent(e="fullload"){this._formComponentClientApiExecutor.execute("setInitializationIntent",t=>{"nothing"!==e&&"fullload"!==e&&Object(p.h)(t,e,"intent"),Oe.dispatch(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,n,a){const r=Object(q.v)(n);return{type:Se.d,payload:a,meta:{pageId:e,controlName:t,contextKey:r}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(this.pageId,this.name,this.contextToken,e))},[{name:"intent",value:e,isEventParam:!0,expectedDataType:"string"}])}getControlType(){return l.a.instance.reportUsage("ClientApi.XrmControlFormComponent.getControlType"),"formcomponent"}}var je=n("CYtR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Pe="3d180de6-b456-4d90-9d5a-9899936baf44";let xe;class Ee{constructor(e,t){this._pageId=t,xe=e}createXrmControl(e,t,n,o,s){Object(p.g)(t,o,"control");try{s.push({name:"controlClassId",value:t&&t.ClassId?t.ClassId.guid:""}),s.push({name:"controlName",value:t?t.Name:""}),s.push({name:"controlDataFieldName",value:t?t.DataFieldName:""}),s.push({name:"pageId",value:this._pageId});const l=Object(r.l)(xe.getState(),this._pageId);s.push({name:"pageType",value:l});let u=!1,g=null,p=!1;const m=this._getControlType(t,n,e,o,s);switch(m){case a.i.guid:g=new f(xe,e,this._pageId,t,t.Name,n);break;case H.a.KbContent:case H.a.KbArticle:case a.C.guid:case a.I.guid:g=new j(xe,e,this._pageId,t,t.Name,n);break;case H.a.LookupRegarding:case H.a.LookupCustomer:case H.a.LookupMultiEntity:case H.a.LookupOwner:case H.a.LookupSimple:case H.a.LookupPartyList:case a.M.guid:case a.fb.guid:case a.S.guid:case a.l.guid:if(Object(_e.c)(xe.getState(),Ce.jb)){const a=Object(ae.b)(xe.getState(),this._pageId,e);if(Object(ve.c)(xe.getState(),t.UniqueId,a)===je.d){g=new Ie(xe,e,this._pageId,t,n,this);break}}g=new k(xe,e,this._pageId,t,t.Name,n);break;case H.a.OptionSet:case a.U.guid:if(p=Object(_e.c)(xe.getState(),Ce.L),1==p){const a=this._getEntityNameForControl(t,n);if(Object(ye.l)(xe.getState(),a,t.DataFieldName)){g=new me(xe,e,this._pageId,t,t.Name,n);break}}case H.a.EntityNameOptionSet:case H.a.TwoOptions:case H.a.StatusOptionSet:case a.sb.guid:case a.K.guid:case a.W.guid:case a.V.guid:case a.hb.guid:case a.n.guid:case a.N.guid:g=new V(xe,e,this._pageId,t,t.Name,n);break;case H.a.MultiSelectPicklist:case a.Q.guid:if(p=Object(_e.c)(xe.getState(),Ce.L),p){const a=this._getEntityNameForControl(t,n);if(Object(ye.l)(xe.getState(),a,t.DataFieldName)){g=new be(xe,e,this._pageId,t,t.Name,n);break}}g=new X(xe,e,this._pageId,t,t.Name,n);break;case H.a.QuickForm:case a.cb.guid:case a.ab.guid:case a.Z.guid:const r=new le(xe,e,this._pageId,t,n,this);n.ui.quickForms.add(t.Name,r);break;case H.a.SearchWidget:case H.a.ReferencePanelSearchWidget:case a.db.guid:case a.kb.guid:g=new h.a(xe,e,this._pageId,t,t.Name,n);break;case H.a.TimelineWall:case a.qb.guid:g=xe.dispatch(Object(K.f)(this._pageId,Object(q.p)(e,t.Name))),g||(g=new he.a(xe,e,this._pageId,t,t.Name,t.LabelId,n,n.applicationContext));break;case H.a.DateAndTimeDateOnly:case H.a.DateAndTimeDateAndTime:case a.q.guid:g=new W(xe,e,this._pageId,t,t.Name,n);break;case H.a.Grid:case a.eb.guid:case a.E.guid:const l=Object(q.p)(e,t.Name),b=xe.dispatch(Object(K.c)(this._pageId,l));b&&(b.getName||3!==b.getGridType()?g=b:(c.a.getInstance().reportFailure(o,new Error("Main grid found in cache - converting to a subgrid."),null,s),xe.dispatch(Object(K.h)(this._pageId,l)))),g||(g=new U.a(xe,e,this._pageId,t.Name,Object(Q.wb)(xe.getState(),this._pageId,e,t.Name),n,t,n.applicationContext));break;case H.a.Timer:case a.rb.guid:g=new d(xe,e,this._pageId,t,t.Name,n);break;case H.a.WebResourceHtmlControl:case a.ub.guid:case a.vb.guid:g=new O(xe,e,this._pageId,t,t.Name,n);break;case a.mb.guid:g=new J(xe,e,this._pageId,t,n);break;case a.z.guid:case a.G.guid:break;case Pe:if(p=Object(_e.c)(xe.getState(),Ce.L),p&&Object(ye.l)(xe.getState(),e.entityTypeName,t.Name)){g=new fe(xe,e,this._pageId,t,t.Name,n);break}case H.a.AppliedFilters:case H.a.BusinessProcessFlow:case H.a.Card:case H.a.Currency:case H.a.Dashboard:case H.a.Decimal:case H.a.EmailEngagementActions:case H.a.EmailEngagementRecipientActivity:case H.a.FP:case H.a.GlobalFilter:case H.a.MicrosoftFlow:case H.a.Multiple:case H.a.PowerBI:case H.a.ReferencePanel:case H.a.Search:case H.a.SingleLineAddress:case H.a.SingleLineEmail:case H.a.SingleLinePhone:case H.a.SingleLineText:case H.a.SingleLineTextArea:case H.a.SingleLineTickerSymbol:case H.a.SingleLineURL:case H.a.SocialInsightsControl:case H.a.WholeDuration:case H.a.WholeLanguage:case H.a.WholeNone:case H.a.WholeTimeZone:case a.a.guid:case a.b.guid:case a.c.guid:case a.d.guid:case a.e.guid:case a.f.guid:case a.g.guid:case a.h.guid:case a.j.guid:case a.k.guid:case a.m.guid:case a.p.guid:case a.r.guid:case a.s.guid:case a.t.guid:case a.u.guid:case a.v.guid:case a.w.guid:case a.x.guid:case a.y.guid:case a.A.guid:case a.B.guid:case a.D.guid:case a.H.guid:case a.J.guid:case a.L.guid:case a.O.guid:case a.P.guid:case a.R.guid:case a.T.guid:case a.X.guid:case a.Y.guid:case a.bb.guid:case a.gb.guid:case a.ib.guid:case a.jb.guid:case a.lb.guid:case a.mb.guid:case a.nb.guid:case a.ob.guid:case a.pb.guid:case a.tb.guid:case a.wb.guid:u=!0;default:g=t.DataFieldName?new de(xe,e,this._pageId,t,t.Name,n):new i.a(xe,e,this._pageId,t,t.Name,n),u||(s.push({name:"controlType",value:m}),ie.a.getInstance().traceManager.getTracer(o).error("Unknown Form Control",s))}return g}catch(e){return c.a.getInstance().reportFailure(o+".createXrmControl",e,null,s),null}}_getControlType(e,t,n,r,i){if(A.a.equals(e.ClassId,a.o)){const a=this._getCustomControlType(e,t,n);return a||ie.a.getInstance().traceManager.getTracer(r+".controlPrimaryType").error("Control primary type could not be determined",i),i.push({name:"manifestControlType",value:a}),a}return e.ClassId.guid}_getCustomControlType(e,t,n){var a,r,i;const s=Object(ae.b)(xe.getState(),this._pageId,n);let c=Object(ge.c)(xe.getState(),e,s);if(!c){const l=Object(o.h)(),u=(null===(r=null===(a=t.data)||void 0===a?void 0:a.entity)||void 0===r?void 0:r.getEntityName())||"";let d=l(xe.getState(),e,this._pageId,s,u);if(d||(d=Object(pe.a)(xe.getState(),e,this._pageId,n)),null==d?void 0:d.Parameters)for(const e in d.Parameters)if(null===(i=d.Parameters[e])||void 0===i?void 0:i.Primary){c=d.Parameters[e].Type;break}}return c}_getEntityNameForControl(e,t){let n="";if(e.Relationship)n=Object(o.T)(xe.getState(),this._pageId,e.Relationship);else{const a=t.getAttribute(e.DataFieldName);a&&a.getParent()&&(n=a.getParent().getEntityName())}return n}}},AE7n:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n("YYhu"),r=n("iZ7K"),i=n("vNXc"),o=n("q/4y"),s=n("GxhD"),c=n("hQd/"),l=n("SAYH"),u=n("i1f0"),d=n("dHD5"),h=n("arV0"),g=n("P6DH"),p=n("fILV"),m=n("aF0N"),b=n("P+kM"),f=n("3/02"),y=n("Lyxw"),C=n("HfZT"),_=n("E8F2");function v(e,t,n,v,S,O,I=!1,j){return{type:"embeddedEntity.save",execute(v,P){const x=v.getState(),E=new l.a(n),w=Object(d.f)(j,E,t);let T;switch(Object(h.l)(x,e)){case p.a:T=Object(g.R)(x,e,w);break;default:T=Object(u.ac)(x,e,w)}const A=Object(m.c)(x),F=Object(m.b)(x);if((A||F)&&"Dashboard"!==Object(h.l)(x,e)){const t=P.ScriptManager.getContainer(e).getEventManager();if(v.dispatch(t.runOnSave(j,1,null,n)))return Promise.reject(Object(_.b)(x,e,2200000005,""))}return v.dispatch(Object(a.c)(T,I,S)).then(a=>{const u=Object(g.qb)(x,new l.a(O),e),d=Object(r.h)(x,t),h=i.a.fromXmlAndSql(u.fetchXML,u.offlineSqlQuery,u.viewId,null,u.entityLogicalName,v.getState);return h.where(new o.a("eq",new s.a(t,d.PrimaryIdAttribute),new c.a(n))),v.dispatch(Object(C.d)(h.getQueryState())).then(()=>a)}).catch(e=>(Object(y.a)(x,f.xb)&&T&&v.dispatch(Object(b.b)(T,!1)),Promise.reject(e)))}}}},AbXy:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("P6DH"),r=n("Sbn7"),i=n("9i5P"),o=n("16wZ"),s=n("dHD5"),c=n("SAYH"),l=n("5Oca"),u=n("odYE"),d=n("WPtp"),h=n("qshH"),g=n("1kth"),p=n("ZIjf"),m=n("Uv1Y"),b=n("IaGr");let f;class y{constructor(e,t,n,a,r,i,s){const c="ClientApi.XrmControlGrid.constructor";if(a||Object(o.j)(c,"pageId"),n||Object(o.j)(c,"contextToken"),e||Object(o.j)(c,"store"),r||Object(o.j)(c,"gridEntity"),Object(o.a)(i)&&Object(o.j)(c,"isEditable"),f=e,this._applicationContext=t,this._contextToken=n,this._pageId=a,this._gridEntityName=r,this.controlName=s,this._isEditable=i,!this._contextToken.contextTokenType){const e=h.a.getInstance().getEventParameters(this._contextToken);e.push({name:"controlName",value:this.controlName}),e.push({name:"gridEntityName",value:this._gridEntityName}),h.a.getInstance().reportFailure(c,new m.a("context token passed to grids with empty context token type"),null,e)}}get _isEditable(){const e=Object(a.V)(f.getState(),this._pageId,this._gridEntityName,this._contextToken,this.controlName);if(null===e){const e="ClientApi.XrmControlGrid._isEditable_get",t=h.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this.controlName}),t.push({name:"gridEntityName",value:this._gridEntityName}),b.a.getInstance().eventManager.ReportComponentFailure(e,new m.a("control configuration parameters not found"),null,t),this._isGridEditable}return e}set _isEditable(e){this._isGridEditable=e}get applicationContext(){return p.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_get"),this._applicationContext}set applicationContext(e){p.a.instance.reportUsage("ClientApi.XrmControlGrid.applicationContext_set")}getTotalRecordCount(){const e="ClientApi.XrmControlGrid.getTotalRecordCount";try{p.a.instance.reportCall(e);const t=Object(a.Y)(f.getState(),this._pageId,this._contextToken);if(t){const n=JSON.parse(t),a=n&&n.totalResultCount?n.totalResultCount:0;return p.a.instance.reportSuccess(e),a}return p.a.instance.reportSuccess(e),0}catch(t){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,n),t}}getRows(){const e="ClientApi.XrmControlGrid.getRows";try{p.a.instance.reportCall(e);const t=new r.a(e),n=f.getState(),o=Object(a.H)(n,this.contextToken,{id:this.pageId});if(o)for(let e=0;e<o.length;e++){const n=o[e].identifier.id,a=this._getRowEntityName(o[e],n),r=new i.a(f,this._applicationContext,Object(s.f)(this.contextToken,n,a),this.pageId,a,n),c=o[e].identifier.id.guid;t.add(c,r)}return p.a.instance.reportSuccess(e),t}catch(t){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedRows(){const e="ClientApi.XrmControlGrid.getSelectedRows";try{p.a.instance.reportCall(e);const t=new r.a(e),n=Object(a.fb)(f.getState(),this.pageId,this.contextToken);if(n){const e=Object(a.Q)(f.getState(),this.pageId,this.contextToken);for(let r=0;r<n.length;r++){let o;if(e)o=e;else{const e=f.getState(),t=Object(a.v)(e,this.pageId,this.contextToken),i=(t&&t.queryKey&&Object(l.q)(e,t.queryKey,null,null,!0)||[]).find(e=>e.identifier&&c.a.equals(e.identifier.id,n[r]));o=this._getRowEntityName(i,n[r])}const u=new i.a(f,this._applicationContext,Object(s.f)(this.contextToken,n[r],o),this.pageId,o,n[r]),d=n[r].guid;t.add(d,u)}}return p.a.instance.reportSuccess(e),t}catch(t){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(e,t,null,n),t}}addOnRecordSelect(e){const t="ClientApi.XrmControlGrid.addOnRecordSelect";if(this._isEditable){e||Object(o.j)(t,"handler");try{p.a.instance.reportCall(t),f.dispatch(Object(g.m)(this.contextToken,this.pageId,e,this.controlName)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}}removeOnRecordSelect(e){const t="ClientApi.XrmControlGrid.removeOnRecordSelect";if(this._isEditable){e||Object(o.j)(t,"handler");try{p.a.instance.reportCall(t),f.dispatch(Object(g.H)(this.contextToken,this.pageId,e,this.controlName)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}}runOnRecordSelect(e){const t="ClientApi.XrmControlGrid.runOnRecordSelect";try{p.a.instance.reportCall(t),this._isEditable&&f.dispatch(Object(g.T)(this.contextToken,this.pageId,e,this.controlName)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.controlName}),h.a.getInstance().reportFailure(t,e,null,n),e}}_getRowEntityName(e,t){const n=e&&e.identifier?e.identifier.etn:this._gridEntityName;if("activitypointer"===n){const e="activitytypecode",n=Object(l.j)(f.getState(),new u.a(this._gridEntityName,t),e);if(Object(d.j)(n))return n.value}return n}get pageId(){return this._pageId}get contextToken(){return this._contextToken}}},B9jE:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n("P6DH"),r=n("Utin");var i=n("Uv1Y"),o=n("SAYH"),s=n("eXjw"),c=n("a72m"),l=n("KBcj"),u=n("d0w6"),d=n("dQnL"),h=n("WK+4"),g=n("CngE"),p=n("iZ7K"),m=n("69Qu"),b=n("BzGi"),f=n("BFlg"),y=n("s+OO"),C=n("7k+e");var _=n("LAGg"),v=n("RrRu"),S=n("jRHm"),O=n("uCpV"),I=n("X37l"),j=n("ujVH"),P=n("3/02"),x=n("Lyxw"),E=n("VcAV");function w(e,t,n,w,A,F){return{type:"grid.refresh.async",execute({dispatch:N,getState:k},M){const D=M.TraceManager.getTracer(f.z),R=f.x+".refreshGridAction";try{const L=k(),B=o.a.tryParseOrNull(w);if(B){const V=F||(n?u.a.SUB_GRID:u.a.MAIN_APPLICATION_VIEW);return function(e,t,n,r,d,h,g,p){const b=Object(a.qb)(t,p,n);if(b&&b.initialized===s.a.Initialized&&(Object(m.b)(t)||!Object(E.b)(b.offlineSqlQuery)))return Promise.resolve(p);const f=h||Object(a.F)(t,n,r,d),y=Object(l.f)(t,f,g),C=Object(l.f)(t,f,u.a.MAIN_APPLICATION_VIEW);let _=y&&y[o.a.toString(p)]&&y[o.a.toString(p)].isUserView?u.b.userview:u.b.savedview;C&&C[o.a.toString(p)]&&C[o.a.toString(p)].isUserView&&(_=u.b.userview);return e(Object(c.a)(f,g,_,p)).then(e=>{if(!e)throw new i.a("View retrieval failed");return e})}(N,L,e,t,n,A,V,B).then(i=>{D.info("Refreshing the grid with new view id - {0}"+B);const c=Object(a.T)(L,e,t);N(function(e,t,n,a){return Object(r.b)(e,t,"ViewId",n,a)}(e,n,w,t)),function(e,t,n,r,i,c,u,d,h){let g=function(e,t,n,r,i){return e||Object(a.F)(t,n,r,i)}(n,e,i,c,u);const p=Object(a.qb)(e,r,i);if(p&&p.initialized===s.a.Initialized){const n=Object(l.f)(e,g,d),a=n&&n[o.a.toString(r)]&&n[o.a.toString(r)].isUserView;if(g===f.a&&(g=p.entityLogicalName?p.entityLogicalName:g),!p.title){const e=[];e.push({name:"view.title",value:"View title doesn't contains value"}),e.push({name:"ViewId",value:"ViewId: "+r}),e.push({name:"View",value:T(p)}),e.push({name:"entityTypeName",value:g}),h.EventManager.ReportComponentFailure("RefreshGrid",new Error("Title for recent item is null or empty."),"Analyze event parameters to understand why title is empty.",e)}const i={RecordType:I.a.Grid,EntityTypeName:g,LastAccessed:new Date,ObjectId:r,IsUserView:a,Title:p.title};t(Object(O.b)(i))}}(k(),N,A,i,e,t,n,V,M);Object(x.c)(k(),P.L)&&N(Object(j.b)(e,t)),A&&N(function(e,t,n,a){return Object(r.b)(e,t,"TargetEntityType",n,a)}(e,n,A,t)),N(Object(_.b)(e,t)),N(Object(v.b)(e,t,[])),N(Object(S.b)(e,t,null));const E=[];if(A&&E.push({name:"entityName",value:A}),!Object(a.ib)(L,e,t))return M.EventManager.ReportComponentSuccess(R,E),Promise.resolve();N(function(e,t,n,r,i,s){return{type:"chart.refresh.async",execute({dispatch:c,getState:_},v){const S=f.x+".refreshChartAction",O=_();if(!n)return Promise.resolve();if(!Object(m.b)(O))return Promise.resolve();const I=Object(l.c)(O,n);if(!(i=I&&I.entityLogicalName?I.entityLogicalName:null))return Promise.resolve();if(s===u.a.QUICKFIND_SEARCH&&(c(Object(C.c)(e,t,[])),c(Object(y.c)(e,t,"{}"))),!o.a.equals(r,n)){c(Object(C.c)(e,t,[])),c(Object(y.c)(e,t,"{}"));const n=Object(a.r)(O,e,t,i),r=Object(g.a)(O,n),s=r&&r.PrimaryEntityTypeCode,l=s&&Object(p.m)(O,parseInt(s,10));if(l&&i!==l)return c(Object(d.a)(i,b.a.savedvisualization)).then(n=>{let a=o.a.toString(n);return a||(a=o.a.EMPTYGUIDSTRING),c(Object(h.b)(e,t,a)).then(()=>{v.EventManager.ReportComponentSuccess(S)})})}return v.EventManager.ReportComponentSuccess(S),Promise.resolve()}}}(e,t,B,c,A,F)).then(()=>(N(Object(_.b)(e,t)),M.EventManager.ReportComponentSuccess(R,E),Promise.resolve())).catch(e=>(M.EventManager.ReportComponentFailure(R,Error(e)),Promise.resolve()))})}if(Object(a.v)(k(),e,t)){D.info("Refreshing the grid."),N(Object(_.b)(e,t)),N(Object(v.b)(e,t,[])),N(Object(S.b)(e,t,null));const n=[];A&&n.push({name:"entityName",value:A}),M.EventManager.ReportComponentSuccess(R,n)}return Promise.resolve()}catch(e){let t="Refresh action for grid failed";e&&e.message&&(t+="with the error message as : "+e.message),M.EventManager.ReportComponentFailure(R,Error(t))}}}}function T(e){if(!e)return"View is "+e;const t={initialized:e.initialized,viewId:e.viewId,entityLogicalName:e.entityLogicalName,queryApi:e.queryApi,columnXML:e.columnXML,idColumName:e.idColumName,queryType:e.queryType,layoutXML:e.layoutXML,isUserView:e.isUserView,versionNumber:e.versionNumber,OverallVersionNumber:e.OverallVersionNumber,OverallUserVersionNumber:e.OverallUserVersionNumber};return JSON.stringify(t)}},BpXX:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("gNtT"),r=n("d5d1"),i=n("wJNo");function o(e){return{type:"save.deviceSettingsDialog.async",sync:!0,execute({dispatch:t,getState:n},o){const s=Object(r.a)(n()),c={};Object.keys(s).forEach(t=>{c[t]=Object.assign(Object.assign({},s[t]),e[t])}),t(Object(i.b)(c));o.DataSource.saveSessionState(a.a,c,!0)}}}},COKI:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n("i1f0"),r=n("pF61"),i=n("Sbn7"),o=n("ScMg"),s=n("ldWj"),c=n("TYIz"),l=n("16wZ"),u=n("1kth"),d=n("mhYf"),h=n("PbI6"),g=n("FHmp"),p=n("qshH"),m=n("ZIjf"),b=n("ABCl");let f;class y extends o.a{constructor(e,t,n,a,r,i){Object(l.g)(r,"ClientApi.XrmTab.constructor","parent"),Object(l.g)(e,"ClientApi.XrmTab.constructor","store"),super(e,t,a,n),f=e,this._parent=r,this._formContext=i,this._iConnectedTabProps={tabName:this.name,tabId:this._getTabId(),id:this.pageId,showTab:!0},this._clientApiExecutor=new b.b(f,"ClientApi.XrmTab.",t)}get sections(){const e="ClientApi.XrmTab.sections";try{if(m.a.instance.reportCall(e),!this._sections){this._sections=new i.a(e);const t=f.getState(),n=Object(a.Gc)(t,this.pageId,this.name,this.contextToken);for(let e=0;e<n.Columns.length;e++){const r=Object(a.p)(t,{id:this.pageId,tabName:n.Id,columnIndex:e},this.contextToken);let i=null;for(let e=0;e<r.SectionNames.length;e++)i=new s.a(f,this.contextToken,this.pageId,r.SectionNames[e],this,this._formContext),this._sections.add(i.getName(),i)}}return m.a.instance.reportSuccess(e),this._sections}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}addTabStateChange(e){const t="ClientApi.XrmTab.addTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),f.dispatch(Object(u.s)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}removeTabStateChange(e){const t="ClientApi.XrmTab.removeTabStateChange";Object(l.g)(e,t,"handler");try{m.a.instance.reportCall(t),f.dispatch(Object(u.N)(this.contextToken,this.pageId,this.name,e)),m.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}getDisplayState(){const e="ClientApi.XrmTab.getDisplayState";try{m.a.instance.reportCall(e);const t=Object(a.Dc)(f.getState(),this._getTabId(),this.pageId,this.contextToken)?"collapsed":"expanded";return m.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}getParent(){return m.a.instance.reportUsage("ClientApi.XrmTab.getParent"),this._parent}setDisplayState(e){const t="ClientApi.XrmTab.setDisplayState";try{m.a.instance.reportCall(t);let n=!1;switch(e){case"collapsed":n=!0;break;case"expanded":n=!1;break;default:Object(l.h)(t,"TabDisplayState",e)}n||f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}setFocus(){try{m.a.instance.reportCall("ClientApi.XrmTab.setFocus"),f.dispatch(Object(c.b)(this.pageId,this._getTabId(),this.contextToken)),m.a.instance.reportSuccess("ClientApi.XrmTab.setFocus")}catch(e){const t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTab.setFocus",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTab.setVisible";try{m.a.instance.reportCall(t),f.dispatch(Object(d.b)(this.pageId,this._getTabId(),this.contextToken,!0===e)),m.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}getLabel(){try{m.a.instance.reportCall("ClientApi.XrmTab.getLabel");const e=Object(a.Hc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken)||"";return m.a.instance.reportSuccess("ClientApi.XrmTab.getLabel"),e}catch(e){const t=p.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure("ClientApi.XrmTab.getLabel",e,null,t),e}}getVisible(){const e="ClientApi.XrmTab.getVisible";try{m.a.instance.reportCall(e);const t=Object(a.Kc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(e){const t="ClientApi.XrmTab.setLabel";Object(l.g)(e,t,"label");try{m.a.instance.reportCall(t),f.dispatch(Object(g.b)(this.pageId,this.contextToken,this._getTabId(),e)),m.a.instance.reportSuccess(t)}catch(e){const n=p.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),p.a.getInstance().reportFailure(t,e,null,n),e}}_getTabId(){const e=f.getState(),t=Object(a.Gc)(e,this.pageId,this.name,this.contextToken);if(t&&t.Id)return t.Id}setContentType(e){return this._clientApiExecutor.execute("setContentType",()=>{let t;switch(e){case"default":case"cardSections":t="cardSections";break;case"expandAvailableSpace":case"singleComponent":t="singleComponent";break;default:Object(l.h)("setContentType","TabContentType",e)}f.dispatch(Object(h.b)(this.pageId,this._getTabId(),this.contextToken,t))},[{name:"tabContentType",value:e,isRequired:!0,expectedDataType:"string"}])}getContentType(){return this._clientApiExecutor.execute("getContentType",()=>{var e;return null===(e=Object(a.Jc)(f.getState(),this._getTabId(),this._iConnectedTabProps.id,this.contextToken))||void 0===e?void 0:e.contentType})}}var C=n("SAYH"),_=n("rQHy"),v=n("jRy5"),S=n("y60j"),O=n("arV0"),I=n("3yqi"),j=n("0nOn"),P=n("zmL5"),x=n("jq7Z"),E=n("IaGr");let w;class T{constructor(e,t,n,a,r,i,o){const s=Object(O.l)(e.getState(),n),c=[{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"pageId",value:n,isRequired:!0,isEventParam:!0},{name:"pageType",value:s,isEventParam:!0},{name:"formContext",value:a,isRequired:!0},{name:"entityName",value:r,isEventParam:!0},{name:"formSelectorType",value:o,isRequired:!0}];this._clientApiExecutor=new j.a(e,"ClientApi.XrmFormUIBase.",n,t,c),this._pageId=n,w=e,this._formContext=a,this._entityName=r,this._contextToken=t,this._formSelectorType=o,this.xrmControlFactory=i}get controls(){return this._clientApiExecutor.execute("controls_get",(e,t)=>{if(!this._controls){this._controls=new i.a(e);const n=function(e,t,n){const r=Object(x.b)(w.getState(),e,t),i=Object(P.b)(w.getState(),e),o=C.a.equals(r,i),s=Object(O.l)(w.getState(),e)===I.a.Dialog,c=Object(S.y)(w.getState(),r),l=c&&c.reduce((e,t)=>(e.add(t),e),new Set);return(r,i)=>{const c=Object(a.s)(w.getState(),{controlName:r,id:e},t),u=Object(a.Rc)(w.getState(),e,c);o&&u&&!s?l&&l.has(c.DataFieldName)&&Object(a.fd)(w.getState(),e,c,t)&&n.add(r,i):n.add(r,i)}}(this.pageId,this.contextToken,this._controls),r=this.getFormDescriptor(e,t);if(r){const a={isEventParam:!0,name:"controlName",value:""},i={isEventParam:!0,name:"controlType",value:""};t.push(a),t.push(i);for(const o in r.Controls){const s=r.Controls[o];a.value=o,i.value=s&&s.ClassId?s.ClassId.guid:"";const c=this.xrmControlFactory.createXrmControl(this.contextToken,s,this._formContext,e,t);c&&n(c.getName(),c)}}}return this._controls})}get formSelector(){return this._clientApiExecutor.execute("formSelector_get",(e,t)=>{if(!this._formSelector){const n=this.getFormDescriptor(e,t);n&&(this._formSelector=new this._formSelectorType(w,this._contextToken,n.Id,this._entityName,this._pageId))}return this._formSelector})}get tabs(){return this._clientApiExecutor.execute("tabs_get",(e,t)=>{if(!this._tabs){this._tabs=new i.a(e);const n=this.getFormDescriptor(e,t);if(n){const e=n.Tabs;for(const t in e){const n=new y(w,this._contextToken,e[t].Name,this._pageId,this,this._formContext);this._tabs.add(n.getName(),n)}}}return this._tabs})}get pageId(){return this._pageId}refreshRibbon(e=!1){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(_.a)(this._pageId,null,e)))}get contextToken(){return this._contextToken}get formContext(){return this._clientApiExecutor.execute("formContext",()=>this._formContext)}getControls(){if(!this._controls&&this.contextToken.contextTokenType===v.a.GridRow){const e=this._clientApiExecutor.getComponentName("getControls");return this._controls=new i.a(e),this._controls}return this.controls}getFormDescriptor(e,t){const n=Object(a.fb)(w.getState(),{id:this._pageId},this._contextToken);if(!n){const n="Form descriptor not found";if(Object(r.n)(w.getState(),this._pageId))E.a.getInstance().traceManager.getTracer(e).error(n+": Page is dead",t);else if(this.contextToken.contextTokenType===v.a.GridRow)E.a.getInstance().traceManager.getTracer(e).error(n,t);else{if(!this._clientApiExecutor.isPageReadyForClientAPIAccess())return null;const a=new Error(n);this._clientApiExecutor.reportFailure(e,a,t)}}return n}}},CbNq:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c}));var a=n("P6DH");function r(e){const t=Object(a.m)(e),n=e&&e.metadata?e.metadata.entities:null,r=[];return n?(t.forEach(e=>{if(4200!==n[e].ObjectTypeCode){const t=function(e){const t=e.DisplayName,n=e.ObjectTypeCode.toString();return{entityDisplayName:t,objectTypeCode:n}}(n[e]);r.push(t)}}),r.sort(i)):r}function i(e,t){const n=e.entityDisplayName,a=t.entityDisplayName;let r=0;return n>a?r=1:n<a&&(r=-1),r}function o(e){const t=[];for(let n=0;n<e.length;n++){const a={key:e[n].objectTypeCode,text:e[n].entityDisplayName};t.push(a)}return t}function s(e){return e?e.split(","):[]}function c(e){return e?e.map(e=>({key:e.value,text:e.text})):[]}},Co7m:function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n("TAjd"),r=n("SAYH"),i=n("504W"),o=n("WPtp"),s=n("CPoS"),c=n("5Oca"),l=n("+nNZ"),u=n("odYE"),d=n("0PSL"),h=n("23K5"),g=n("bJaF"),p=n("KGWS"),m=n("ccIw"),b=n("arV0"),f=n("rodW"),y=n("eXjw"),C=n("k1f1"),_=n("AFlp"),v=n("c7jw"),S=n("53SR"),O=n("PUjk"),I=n("i1f0"),j=n("7LBy"),P=n("2Ct/"),x=n("iZ7K"),E=n("D4Jo"),w=n("JF0K");class T{static get Instance(){return T._instance||(T._instance=new T,Object(O.c)(T._instance)),T._instance}init(e,t,a){return this._getState&&this._businessProcessPerPageWrapper?Promise.resolve():(this._applicationContext=e,this._reloadDataCount=0,this._getState=t,this._dispatch=a,this._processManager=new g.a(e,t,a,new m.a,new p.a),this._businessProcessFlowWrapperIdentifierFactory=new h.a,this._businessProcessFlowWrapperFactory=new d.a(t,this._businessProcessFlowWrapperIdentifierFactory,e),n.e(48).then(n.bind(null,"esKF")).then(({BusinessProcessPageWrapper:e})=>(this._businessProcessPerPageWrapper=new e(this._applicationContext,this._getState,this._dispatch),Promise.resolve())))}getBusinessProcessFlowWrapper(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getBusinessProcessFlowWrapper(e,t):(this._reloadDataIfRequired(e,t),this._businessProcessFlowWrapperFactory.generate(e,this._processManager))}getProcessManager(e,t){return Object(P.f)(this._getState())?this._businessProcessPerPageWrapper.getProcessManager(e,t):(this._reloadDataIfRequired(e,t),this._processManager)}getCurrentProcessManagerWithoutInit(e){if(!Object(P.f)(this._getState()))return this._processManager;if(this._businessProcessPerPageWrapper)return this._businessProcessPerPageWrapper.getCurrentProcessManagerWithoutInit(e);const t=Object(b.g)(this._getState(),e),n=t&&t.entityTypeName?new u.a(t.entityTypeName,t.id):null,a=this._applicationContext.TraceManager.getTracer("BusinessProcessWrapperManager.GetProcessManagerWithoutinit"),r=Object(E.a)(this._getState(),n,e,this._applicationContext);return a.warn("BusinessProcessWrapperManager: BusinessProcessPerPageWrapper is not initialized",r),null}hasChanged(e,t,n,a){if(!Object(P.f)(this._getState())){if(Object(P.g)(e)&&(!Object(P.d)(e)||Object(P.c)(e,a)))return!0;if(!t)return!1;const r=new u.a(t.entityTypeName,t.id),o=Object(l.f)(e,r);return!Object(i.a)(o)&&(!n||o>n.instanceModifiedTimestamp)||this._needsDockedModeRefresh(n,t)}return this._businessProcessPerPageWrapper.hasChanged(e,t,n,a)}_needsDockedModeRefresh(e,t){return this._processManager.getDisplayState()===a.a.expanded&&e.isFormInactive!==Object(I.Lb)(this._getState(),t.entityTypeName,t.id)}_reloadData(e,t){const n=this._getState();this._pageId=e,this._pageInfo=t;const a=Object(b.g)(n,e);if(!a)return;const d=a.id,h=new u.a(a.entityTypeName,d);if(this._processIdInState=Object(c.e)(n,h),Object(P.g)(n)&&(!Object(P.d)(n)||Object(P.c)(n,e))){const t=this._processManager.getTelemetryParams();return this._processManager.isVisible()&&this._processManager.setVisible(!1),this._processManager.initilaizeWithFormEntityOnly(h,e),void Object(E.c)(w.e,t,this._applicationContext)}const g=Object(j.a)(a),p=Object(j.b)(a);if(r.a.equals(h.id,r.a.EMPTY)&&g&&p){const t=Object(s.b)(n,g),r=new u.a(t.businessProcessFlowUniqueName,p),o=Object(l.b)(n,r);return Object(i.a)(this._lastPageEntityFromCrossEntity)||Object(i.a)(h)||this._lastPageEntityFromCrossEntity.etn===h.etn||this._moveToNextStageForCrossEntityBPF(o,a),void this._processManager.initilaizeWithProcessAndFormEntity(o,t,h,g,r,e)}if(this._processIdInState){const t=Object(s.b)(n,this._processIdInState);if(!Object(i.a)(t)&&Object(y.b)(t.initialized)){const a=new u.a(t.businessProcessFlowUniqueName,Object(c.f)(n,h)),s=Object(l.b)(n,a);if(r.a.equals(h.id,r.a.EMPTY)){const n=Object(P.b)(t);if(this._lastPageIdInNewForm!==e&&(this._lastPageIdInNewForm=e,this._dispatch(Object(S.a)(null,a))),n&&n.stage&&n.stage.stageId){const r=Object(P.a)(n);return this._dispatch(Object(v.b)(a,r)),void this._processManager.initilaizeWithProcessAndFormEntity(r.fields,t,h,this._processIdInState,a,e)}}else if(Object(i.a)(s))return;const d=Object(x.h)(n,h.etn);if(d&&d.IsBPFEntity)return void this._processManager.initilaizeWithProcessAndFormEntity(s,t,h,this._processIdInState,a,e);for(const n in s)if(Object(o.k)(s[n])&&s[n].reference&&s[n].reference.id&&s[n].reference.etn===h.etn&&(r.a.equals(s[n].reference.id,h.id)||r.a.equals(s[n].reference.id,r.a.EMPTY))&&Object(P.e)(n))return void this._processManager.initilaizeWithProcessAndFormEntity(s,t,h,this._processIdInState,a,e);const g=this._dispatch(Object(C.b)(r.a.EMPTY,h)),p=this._dispatch(Object(_.b)(r.a.EMPTY,h));Promise.all([g,p]).then(t=>{this._processManager.initilaizeWithFormEntityOnly(h,e)})}else this._processManager.initilaizeWithFormEntityOnly(h,e)}else this._processManager.initilaizeWithFormEntityOnly(h,e)}_reloadDataIfRequired(e,t){const n=this._getState(),a=this._processManager.getCurrentFormEntity();this._lastPageEntityFromCrossEntity=a;let i=null,o=!1;if(a&&(i=Object(c.b)(a)(n,a.etn),i&&(o=i.refreshGlobalNavigationData)),!Object(P.g)(n)&&(!this._pageInfo||!r.a.equals(this._pageInfo.id,t.id)||this._pageId!==e||this._hasProcessChanged(t)||o)||Object(P.g)(n)&&this._processManager.getProcessId()){if(i&&i.refreshGlobalNavigationData&&this._dispatch(Object(f.b)(!1,a)),this._reloadDataCount<30)this._reloadData(e,t);else if(this._pageId!==e&&(this._reloadDataCount=0),30===this._reloadDataCount){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ReachMaxBpfReloadDataCount"),t=this._processManager.getTelemetryParams();e.error("Max BPF reloadData count reached limit of 30. Root cause may be infinite loop when rendering the ProcessControl.",t)}this._reloadDataCount++}else this._reloadDataCount=0}_hasProcessChanged(e){const t=this._processIdInState||r.a.EMPTY,n=this._getState(),a=new u.a(e.entityTypeName,e.id),i=Object(b.g)(n,this._pageId),o=Object(j.a)(i),l=r.a.equals(a.id,r.a.EMPTY)&&o?o:Object(c.e)(n,a)||r.a.EMPTY;if(!r.a.equals(l,t))return!0;if(r.a.equals(l,r.a.EMPTY))return!1;const d=Object(s.b)(n,l);return!!d&&this._processManager.getVersion()<d.businessProcessFlowProcessVersion}_moveToNextStageForCrossEntityBPF(e,t){const n=e.activestageid,a=e.traversedpath;let i=t.data.nextStageId;if(!i){const e=Object(j.a)(t),n=Object(j.b)(t);if(!r.a.equals(e,this._processManager.getProcessId())||!r.a.equals(n,this._processManager.getProcessInstanceId()))return;i=this._processManager.getStageMetadata().getNextStageId(this._processManager.getActiveStageId())}if(!r.a.equals(n.reference.id,new r.a(i))){n.reference=new u.a("processstage",new r.a(i)),a.value=a.value+","+i;e.activestagestartedon.value=new Date}}}},D4Jo:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return p}));var a=n("VcAV"),r=n("Uv1Y"),i=n("bT7G"),o=n("JF0K"),s=n("SAYH"),c=n("5Oca"),l=n("+nNZ"),u=n("arV0"),d=n("504W");function h(e,t,n,a){const r=[];try{const a=t&&Object(c.e)(e,t)?Object(c.e)(e,t):s.a.EMPTY,i=t&&Object(c.f)(e,t)?Object(c.f)(e,t):s.a.EMPTY,o=a&&!s.a.equals(a,s.a.EMPTY)?function(e,t){const n=Object(l.a)(e,t);if(n)return n.businessProcessFlowProcessState;return null}(e,a):0,d=Object(u.l)(e,n),h={name:"ProcessId",value:a?s.a.toString(a):s.a.EMPTYGUIDSTRING},g={name:"ProcessInstanceId",value:i?s.a.toString(i):s.a.EMPTYGUIDSTRING},p={name:"CurrentFormEntityType",value:t&&t.etn?t.etn:""},m={name:"CurrentFormEntityId",value:t&&t.id?s.a.toString(t.id):""},b={name:"ProcessState",value:o},f={name:"PageId",value:n||""},y={name:"PageType",value:d};r.push(h),r.push(g),r.push(p),r.push(m),r.push(b),r.push(f),r.push(y)}catch(e){a.TraceManager.getTracer("BusinessProcessFlow.TelemetryGeneration").error("Exception while generating businessprocess telemetry parameters: "+e.message,r)}return r}function g(e,t,n){n.EventManager.ReportComponentSuccess(e,t)}function p(e,t,n,s,c,l,u){!function(e,t){if(!Object(a.c)(e)){const n=Object(r.c)(e);if(!Object(a.c)(n)){const e=n.errorCode;if(!Object(a.c)(e)){const n={name:"ErrorCode",value:"0x"+e.toString(16)};t.push(n)}}}}(t,s),function(e,t,n,s){if(!Object(a.c)(e)){const c=Object(r.c)(e);if(!Object(a.c)(c)&&!Object(a.c)(c.FaultedSnapshotId)){const e={name:o.p,value:c.FaultedSnapshotId};if(t.push(e),!Object(a.c)(n)&&!Object(a.c)(s)){const e=Object(i.c)(s,n);if(!Object(a.c)(e)){const n=e.snapshotId;if(!Object(a.c)(n)&&!Object(d.b)(n)&&n===c.FaultedSnapshotId){const e={name:o.q,value:"serverSideCurrentForm"};t.push(e)}}}}}}(t,s,l,u),c.EventManager.ReportComponentFailure(e,t,n,s)}},DAWX:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{get_ErrorType(){return this._errorType}set_ErrorType(e){this._errorType=e}get_ErrorDescription(){return this._errorDescription}set_ErrorDescription(e){this._errorDescription=e}}},EOIL:function(e,t,n){"use strict";n.d(t,"a",(function(){return ee}));var a=n("0nOn"),r=n("i1f0"),i=n("ZIjf"),o=n("Sbn7"),s=n("Bj/n"),c=n("jTSi"),l=n("9NSo"),u=n("SAYH"),d=n("uOtn"),h=n("+zjj"),g=n("N+Ya"),p=n("dIqG"),m=n("16wZ"),b=n("qshH"),f=n("meVR"),y=n("TYIz"),C=n("dHD5");var _=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let v;class S{constructor(e,t,n,a){const r="ClientApi.XrmNavigationItem.constructor";e||Object(m.j)(r,"store"),n||Object(m.j)(r,"pageId"),t||Object(m.j)(r,"contextToken"),Object(m.a)(a)&&Object(m.j)(r,"id"),v=e,this._pageId=n,this._id=a,this._contextToken=t}getId(){return i.a.instance.reportUsage("ClientApi.XrmNavigationItem.getId"),this._id}getLabel(){const e="ClientApi.XrmNavigationItem.getLabel";try{i.a.instance.reportCall(e);const t=Object(r.Rb)(v.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}getVisible(){const e="ClientApi.XrmNavigationItem.getVisible";try{i.a.instance.reportCall(e);const t=Object(r.Ub)(v.getState(),this._pageId,this._id);return i.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setFocus(){const e="ClientApi.XrmNavigationItem.setFocus";try{i.a.instance.reportCall(e),v.dispatch((t=this._pageId,n=this._contextToken,a=this._id,{type:"forms.selectnavigationtab",sync:!0,execute({dispatch:e,getState:r},i,o){const s=Object(h.d)(r(),t,a);if(s){s.isSelected=!0;const a=Object(C.a)(n,s.relationshipName,s.ordinal);e(Object(y.b)(t,void 0,n)),e(Object(f.a)(t,a,s))}else i.TraceManager.getTracer("Forms.SelectNavigationTab").error("Could not find relatedEntityInfo to select")}})),i.a.instance.reportSuccess(e)}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}var t,n,a}setLabel(e){const t="ClientApi.XrmNavigationItem.setLabel";try{if(i.a.instance.reportCall(t),!Object(m.a)(e)){const t=Object(_.s)(v.getState());v.dispatch(Object(g.b)(this._pageId,this._id,e,t))}i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setVisible(e){const t="ClientApi.XrmNavigationItem.setVisible";try{i.a.instance.reportCall(t),v.dispatch(Object(p.b)(this._pageId,this._id,!0===e)),i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let O;class I{constructor(e,t,n){n||Object(m.j)("ClientApi.XrmFormNavigation.constructor","pageId"),e||Object(m.j)("ClientApi.XrmFormNavigation.constructor","store"),O=e,this._pageId=n,this._contextToken=t}get items(){const e="ClientApi.XrmFormNavigation.items";try{if(i.a.instance.reportCall(e),!this._items){this._items=new o.a(e);const t=Object(h.f)()(O.getState(),{id:this._pageId});t&&t.forEach(e=>{e&&e.relatedItems&&e.relatedItems.forEach(e=>{e&&e.id&&this._items.add(e.id,new S(O,this._contextToken,this._pageId,e.id))})})}return i.a.instance.reportSuccess(e),this._items}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}}var j=n("ldWj"),P=n("PidC"),x=n("4U8P"),E=n("NtHU"),w=n("FhIR"),T=n("ABCl");let A;class F extends j.a{constructor(e,t,n,a){super(e,t,n,F.NAME,null,a),A=e,this._clientApiExecutor=new T.b(A,"ClientApi.XrmHeaderSection.",t)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getLabel"),""}getVisible(){return i.a.instance.reportUsage("ClientApi.XrmHeaderSection.getVisible"),!0}setLabel(e){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setLabel")}setVisible(e){i.a.instance.reportUsage("ClientApi.XrmHeaderSection.setVisible")}getControlsDescriptor(e){const t=Object(r.tb)(e,{id:this.pageId},this.contextToken),n={};if(t)for(let e=0;e<t.length;e++){const a=t[e];n[a.Name]=a}return n}setCommandBarVisible(e){this._clientApiExecutor.execute("setCommandBarVisible",()=>{A.dispatch(Object(x.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getCommandBarVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(A.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.commandBarVisible})}setBodyVisible(e){this._clientApiExecutor.execute("setBodyVisible",()=>{A.dispatch(Object(E.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getBodyVisible(){return this._clientApiExecutor.execute("getCommandBarVisible",()=>{var e;return null===(e=Object(P.f)(A.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.bodyVisible})}setTabNavigatorVisible(e){this._clientApiExecutor.execute("setTabNavigatorVisible",()=>{A.dispatch(Object(w.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getTabNavigatorVisible(){return this._clientApiExecutor.execute("getTabNavigatorVisible",()=>{var e;return null===(e=Object(P.f)(A.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.tabNavigatorVisible})}}F.NAME="Header";var N=n("5iTp"),k=n("m+2h");let M;class D extends j.a{constructor(e,t,n,a){super(e,t,n,D.NAME,null,a),M=e,this._clientApiExecutor=new T.b(M,"ClientApi.XrmFooterSection.",t)}getLabel(){return i.a.instance.reportUsage("ClientApi.XrmFooterSection.getLabel"),""}getVisible(){return this._clientApiExecutor.execute("getVisible",()=>{var e;return null===(e=Object(N.a)(M.getState(),this.pageId,this.contextToken))||void 0===e?void 0:e.visible})}setLabel(e){i.a.instance.reportUsage("ClientApi.XrmFooterSection.setLabel")}setVisible(e){this._clientApiExecutor.execute("setVisible",()=>{M.dispatch(Object(k.b)(this.pageId,this.contextToken,e))},[{name:"visible",value:e,isRequired:!0,expectedDataType:"boolean"}])}getControlsDescriptor(e){const t=Object(r.Z)(e,{id:this.pageId},this.contextToken),n={};if(t)for(let e=0;e<t.length;e++){const a=t[e];n[a.Name]=a}return n}}D.NAME="Footer";var R=n("gQ5I"),L=n("arV0"),B=n("PUjk"),V=n("r/aD"),G=n("bpBl"),z=n("IaGr");let W;class X{constructor(e,t,n,a){const r="ClientApi.XrmProcessControlUI.constructor";a||Object(m.j)(r,"entity"),t||Object(m.j)(r,"contextToken"),n||Object(m.j)(r,"pageId"),e||Object(m.j)(r,"store"),W=e,this._pageId=n;let i=!1;if(Object(V.d)(W.getState(),this._pageId,r)){const e=Object(L.g)(W.getState(),this._pageId);this._processManager=Object(B.b)(this._pageId,e),i=!0}this._contextToken=t;const o=Object(V.b)(n,e.getState(),i);z.a.getInstance().eventManager.ReportComponentSuccess(r,o)}getDisplayState(){const e="ClientApi.XrmProcessControlUI.getDisplayState";try{if(i.a.instance.reportCall(e),!Object(V.d)(W.getState(),this._pageId,e))return i.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getDisplayState();return i.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}getVisible(){const e="ClientApi.XrmProcessControlUI.getVisible";try{if(i.a.instance.reportCall(e),!Object(V.d)(W.getState(),this._pageId,e))return i.a.instance.reportSuccess(e),!1;const t=this._getProcessManager().isVisible();return i.a.instance.reportSuccess(e),t}catch(t){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(e,t,null,n),t}}setDisplayState(e){const t="ClientApi.XrmProcessControlUI.setDisplayState";try{if(i.a.instance.reportCall(t),!Object(V.d)(W.getState(),this._pageId,t))return void i.a.instance.reportSuccess(t);e!==G.a.collapsed&&e!==G.a.expanded&&e!==G.a.floating||this._getProcessManager().setDisplayState(e),i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}setVisible(e){const t="ClientApi.XrmProcessControlUI.setVisible";try{if(i.a.instance.reportCall(t),!Object(V.d)(W.getState(),this._pageId,t))return void i.a.instance.reportSuccess(t);this._getProcessManager().setVisible(e),i.a.instance.reportSuccess(t)}catch(e){const n=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(t,e,null,n),e}}reflow(e,t,n){const a="ClientApi.XrmProcessControlUI.reflow";try{if(i.a.instance.reportCall(a),!Object(V.d)(W.getState(),this._pageId,a))return void i.a.instance.reportSuccess(a);this._getProcessManager().reflow(e,t,n),i.a.instance.reportSuccess(a)}catch(e){const t=b.a.getInstance().getEventParameters(this._contextToken);throw b.a.getInstance().reportFailure(a,e,null,t),e}}_getProcessManager(){return this._processManager||(this._processManager=Object(V.c)(this._processManager,W,this._pageId,"ClientApi.XrmProcessControlUI.getProcessManager")),this._processManager}}var H=n("1kth"),U=n("uNLT"),q=n("bT7G"),Y=n("Dea/"),K=n("Fij2"),Q=n("pF61"),Z=n("COKI"),J=n("zJiL");let $;class ee extends Z.a{constructor(e,t,n,r,i,o){$=e,super(e,t,n,r,i,o,d.a),this._clientApiExecutorFormUI=new a.a(e,"ClientApi.XrmFormUI.",n,t),this._clientApiExecutorFormUI.addEventParameter({name:"entityName",value:i,isEventParam:!0})}get headerSection(){const e="ClientApi.XrmFormUI.headerSection";try{return i.a.instance.reportCall(e),this._headerSection||(this._headerSection=new F($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(e),this._headerSection}catch(t){throw this._reportFailure(e,t)}}get footerSection(){const e="ClientApi.XrmFormUI.footerSection";try{return i.a.instance.reportCall(e),this._footerSection||(this._footerSection=new D($,this.contextToken,this.pageId,this.formContext)),i.a.instance.reportSuccess(e),this._footerSection}catch(t){throw this._reportFailure(e,t)}}addControls(e){const t=b.a.getInstance().getEventParameters(this.contextToken),n={name:"controlName",value:""};t.push(n);for(const a in e)if(e[a]){n.value=a;const r=this.xrmControlFactory.createXrmControl(this.contextToken,e[a],this.formContext,"ClientApi.XrmFormUI.addControls",t);r&&this.controls.add(r.getName(),r)}}get navigation(){const e="ClientApi.XrmFormUI.navigation";try{return i.a.instance.reportCall(e),this._navigation||(this._navigation=new I($,this.contextToken,this.pageId)),i.a.instance.reportSuccess(e),this._navigation}catch(t){throw this._reportFailure(e,t)}}get process(){const e="ClientApi.XrmFormUI.process_get";try{i.a.instance.reportCall(e);const t=!!this._process;!this._process&&this.formContext.data&&this.formContext.data.entity&&(this._process=new X($,this.contextToken,this.pageId,this.formContext.data.entity));const n=Object(V.a)(this.pageId,$.getState(),t,!(!this.formContext.data||!this.formContext.data.entity));return z.a.getInstance().eventManager.ReportComponentSuccess(e,n),i.a.instance.reportSuccess(e),this._process}catch(t){throw this._reportFailure(e,t)}}set process(e){const t=Object(V.a)(this.pageId,$.getState(),!!this._process,!(!this.formContext.data||!this.formContext.data.entity));z.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormUI.process_set",t),this._process=e}get quickForms(){const e="ClientApi.XrmFormUI.quickForms";try{return i.a.instance.reportCall(e),this._quickForms||(this._quickForms=new o.a(e),this.controls),i.a.instance.reportSuccess(e),this._quickForms}catch(t){throw this._reportFailure(e,t)}}clearFormNotification(e){const t="ClientApi.XrmFormUI.clearFormNotification";try{i.a.instance.reportCall(t);const n=$.dispatch(Object(c.b)(this.contextToken,this.pageId,e));return i.a.instance.reportSuccess(t),n}catch(e){throw this._reportFailure(t,e)}}close(){try{i.a.instance.reportCall("ClientApi.XrmFormUI.close"),Object(K.a)(Object(Q.b)($.getState())===this.pageId)||$.dispatch(Object(R.e)(this.pageId)),i.a.instance.reportSuccess("ClientApi.XrmFormUI.close")}catch(e){throw this._reportFailure("ClientApi.XrmFormUI.close",e)}}getFormType(){return this._clientApiExecutorFormUI.execute("getFormType",(e,t)=>{const n=this.getFormDescriptor(e,t);if(n){const a=this.formContext;if(a&&a.data&&a.data.entity&&Object(r.Lb)($.getState(),a.data.entity.getEntityName(),u.a.tryParse(a.data.entity.getId())))return 4;if(Object(r.kb)($.getState(),{id:this.pageId},this.contextToken))return 3;if(6===n.FormType)return 3;const i=Object(r.ac)($.getState(),this.pageId,this.contextToken);if(i){const n=Object(q.b)($.getState(),i);return n?n.mode===Y.a.Create?1:2:(t.push({name:"snapshotID",value:i}),this._clientApiExecutorFormUI.reportFailure(e+".getSnapshot",new Error("Snapshot is null or undefined"),t),0)}return a&&a.data&&a.data.entity&&!u.a.tryParseOrNull(a.data.entity.getId())?1:2}return 0})}isDialog(){return this._clientApiExecutorFormUI.execute("isDialog",()=>Object(L.f)($.getState(),this.pageId))}getViewPortHeight(){const e="ClientApi.XrmFormUI.getViewPortHeight";try{i.a.instance.reportCall(e);const t=Object(r.qb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}getViewPortWidth(){const e="ClientApi.XrmFormUI.getViewPortWidth";try{i.a.instance.reportCall(e);const t=Object(r.rb)($.getState(),{id:this.pageId},this.contextToken);return i.a.instance.reportSuccess(e),t}catch(t){throw this._reportFailure(e,t)}}setFormEntityName(e){const t="ClientApi.XrmFormUI.setFormEntityName";Object(m.g)(e,t,"name");try{i.a.instance.reportCall(t),$.dispatch(Object(l.b)(this.pageId,this.contextToken,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}setFormNotification(e,t,n,a,r){return this._clientApiExecutorFormUI.execute("setFormNotification",(i,o)=>{let c;switch(Object(m.a)(n)&&(n="Random_String_"+Math.random()),t){case"ERROR":c=J.a;break;case"WARNING":c=J.e;break;case"INFORMATION":case"INFO":c=J.b;break;default:Object(m.h)(i,"notificationLevel",t,o)}return!Object(m.a)(e)&&"string"==typeof e&&($.dispatch(Object(s.c)(this.contextToken,this.pageId,e,c,n,a,r)),!0)})}addOnLoad(e){const t="ClientApi.XrmFormUI.addOnLoad";Object(m.g)(e,t,"handler");try{i.a.instance.reportCall(t),$.dispatch(Object(H.f)(this.contextToken,this.pageId,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}removeOnLoad(e){const t="ClientApi.XrmFormUI.removeOnLoad";Object(m.g)(e,t,"handler");try{i.a.instance.reportCall(t),$.dispatch(Object(H.A)(this.contextToken,this.pageId,e)),i.a.instance.reportSuccess(t)}catch(e){throw this._reportFailure(t,e)}}refresh(){const e="ClientApi.XrmFormUI.refresh";try{i.a.instance.reportCall(e);const t=Object(L.l)($.getState(),this.pageId);return $.dispatch(Object(U.f)(this.pageId,t,!0,1,!0,!0)).then(t=>(Object(K.b)(this.formContext.data.entity),i.a.instance.reportSuccess(e),t)).catch(t=>{const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e+".saveFormAndNavigate",n)})}catch(t){const n=b.a.getInstance().getEventParameters(this.contextToken);return Object(m.d)($,t,e,n)}}_reportFailure(e,t){const n=b.a.getInstance().getEventParameters(this.contextToken);return b.a.getInstance().reportFailure(e,t,null,n),t}}},"Eh/Y":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="offline.database.update";function r(e){return{type:a,payload:{existingDatabaseName:e}}}},FHmp:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="tab.setlabel";function i(e,t,n,i){const o=Object(a.v)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,tabId:n}}}},FhIR:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="header.tabnavigatorvisible";function i(e,t,n){const i=Object(a.v)(t);return{type:r,payload:n,meta:{pageId:e,contextKey:i}}}},Fw7Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("ZYGP"),r=n("tlts"),i=n("EZ4w");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let o=a.a.roundToNearestPixel(.4);0===o&&(o=1/a.a.get());const s=parseFloat(o.toFixed(2))+"px",c="web"===r.a.OS?s:i.a.hairlineWidth},G0J3:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n("ghNp"),r=n("i1f0"),i=n("0nOn");let o;class s{constructor(e,t,n,r,s,c){this._clientApiExecutor=new i.a(e,"ClientApi.XrmFormBase.",r,n,[{name:"store",value:e,isRequired:!0},{name:"entityName",value:this._entityName,isEventParam:!0},{name:"pageId",value:r,isRequired:!0,isEventParam:!0},{name:"contextToken",value:n,isRequired:!0},{name:"getUiType",value:s,isRequired:!0}]),o=e,this.pageId=r,this.contextToken=n,this._entityName=t,this._getUiType=s,this._xrmControlFactory=c,o.dispatch(Object(a.a)(this,r,n))}get ui(){return this._clientApiExecutor.execute("ui_get",()=>{if(!this._ui){const e={id:this.pageId},t=Object(r.fb)(o.getState(),e,this.contextToken),n=t&&t.FormType,a=this._getUiType(n);this._ui=new a(o,this.contextToken,this.pageId,this,this._entityName,this._xrmControlFactory)}return this._ui})}getControl(e){const t=[{name:"entityName",value:this._entityName,isRequired:!1,isEventParam:!0}];return this._clientApiExecutor.execute("getControl",()=>this.ui.controls.get(e),t)}}},G0lj:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("c/eZ"),r=n("nuS9"),i=n("4fxQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends r.PureComponent{componentDidMount(){this._updateDOMAttributes()}componentDidUpdate(){this._updateDOMAttributes()}_updateDOMAttributes(){const e=i.findDOMNode(this);if(null==e)return;const t=this.props,{children:n,style:r,className:o}=t,s=Object(a.__rest)(t,["children","style","className"]);Object.keys(s).forEach(t=>{e.setAttribute(t,s[t])})}render(){return r.Children.only(this.props.children)}}var s=n("WziN");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function c(e){var{role:t,style:n,children:i}=e,c=Object(a.__rest)(e,["role","style","children"]);return r.createElement(o,{role:t},r.createElement(s.a,Object.assign({style:n},c),i))}},GLaK:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="set.user.offline.status";function r(e){return{type:a,payload:{isUserSelectOffline:e}}}},GxhD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(e,t){this._etn=null,this._attributeName=null,this._etn=e,this._attributeName=t}get etn(){return this._etn}set etn(e){this._etn=e}get attributeName(){return this._attributeName}set attributeName(e){this._attributeName=e}}},HAeo:function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return A}));var a=n("0nOn"),r=n("arV0"),i=n("3yqi"),o=n("AbXy"),s=n("SAYH"),c=n("B9jE"),l=n("16wZ"),u=n("P6DH"),d=n("qshH"),h=n("i1f0"),g=n("Uv1Y"),p=n("dHD5"),m=n("ZIjf"),b=n("IaGr");let f;class y{constructor(e,t,n,r,i){this._pageId=n,f=e,this._contextToken=t,this._controlName=r,this._gridType=i,this._clientApiExecutor=new a.a(e,"ClientApi.XrmViewSelector.",n,t,[{name:"controlName",value:r,isEventParam:!0},{name:"gridType",value:i,isEventParam:!0,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"store",value:e,isRequired:!0}])}setCurrentView(e){this._clientApiExecutor.executeAsync("setCurrentView",(t,n)=>e&&e.id?f.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName,e.id)):(n.push({name:"validationError",value:"true"}),b.a.getInstance().traceManager.getTracer(t).error("View ID is required",n),Promise.resolve()))}getCurrentView(){const e="ClientApi.XrmViewSelector.getCurrentView";try{m.a.instance.reportCall(e);const t=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);let n=null,a=null;if(t)a=t.ViewId;else if(3===this._gridType){const t={id:this._pageId},n=Object(h.fb)(f.getState(),t,this._contextToken.parentContextToken),r="ViewId";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[r])){let t;n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[r]||(t="formDescriptor.Controls[this._controlName].Parameters[propertyViewId] is null or undefined"):t="formDescriptor.Controls[this._controlName].Parameters is null or undefined":t="formDescriptor.Controls[this._controlName] is null or undefined":t="formDescriptor.Controls is null or undefined":t="formDescriptor is null or undefined";const a=d.a.getInstance().getEventParameters(this._contextToken);return a.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new g.a(t),null,a),null}a=n.Controls[this._controlName].Parameters[r]}if(a){if(n=Object(u.qb)(f.getState(),s.a.parse(a),this._pageId),n){const t={entityType:Object(u.ob)(f.getState(),a,this._pageId),id:s.a.externalGuid(n.viewId),name:n.title};return m.a.instance.reportSuccess(e),t}const t=[];return t.push({name:"controlName",value:this._controlName}),t.push({name:"contextKey",value:Object(p.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("ViewDescriptor is coming as null"),null,t),null}const r=[];return r.push({name:"controlName",value:this._controlName}),r.push({name:"contextKey",value:Object(p.v)(this._contextToken)}),d.a.getInstance().reportFailure(e,new Error("viewId is coming as null or undefined"),null,r),null}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}isVisible(){const e="ClientApi.XrmViewSelector.isVisible";try{if(m.a.instance.reportCall(e),Object(l.a)(this._isVisible)){const t=Object(u.hb)(f.getState(),this._pageId,this._contextToken,this._controlName);if(t)this._isVisible=t.EnableViewPicker;else{const t={id:this._pageId},n=Object(h.fb)(f.getState(),t,this._contextToken.parentContextToken),a="EnableViewPicker";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[a])){const t=d.a.getInstance().getEventParameters(this._contextToken);return t.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,new g.a("FormDescriptor is null"),null,t),!1}this._isVisible=n.Controls[this._controlName].Parameters[a]}}return m.a.instance.reportSuccess(e),this._isVisible}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}}var C=n("ghNp"),_=n("OQLa"),v=n("rQHy"),S=n("iOrn"),O=n("iZ7K"),I=n("d0w6"),j=n("deGN"),P=n("Lyxw"),x=n("3/02"),E=n("whN/");let w;class T{constructor(e,t,n,r,i,o,s,c){this._relationship=null;const u="ClientApi.XrmGridControl.constructor";e||Object(l.j)(u,"store"),t||Object(l.j)(u,"contextToken"),n||Object(l.j)(u,"pageId"),w=e,this._pageId=n,this._contextToken=t,this._controlName=c,this._isEditable=r,this._gridType=i,this._applicationContext=s,o||w.dispatch(Object(C.a)(this,n,t)),this._clientApiExecutor=new a.a(e,"ClientApi.XrmGridControl.",n,t),this._clientApiExecutor.addEventParameter({name:"controlName",value:c,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isEditable",value:r,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"isCallFromSubgrid",value:o,isEventParam:!0}),this._clientApiExecutor.addEventParameter({name:"gridType",value:i,isEventParam:!0})}get _connectedControlProps(){return{controlName:this._controlName,id:this._pageId}}setFilterXml(e){this._clientApiExecutor.executeAsync("setFilterXml",()=>{const t=(new Date).getTime();return w.dispatch(Object(S.b)(e,1,this._pageId,this._contextToken,t))})}getFilterXml(){const e="ClientApi.XrmGridControl.getFilterXml";try{m.a.instance.reportCall(e);const t=Object(u.u)(w.getState(),this._pageId,this._contextToken);return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getFetchXml(){const e="ClientApi.XrmGridControl.getFetchXml";try{m.a.instance.reportCall(e);const t=Object(u.A)(w.getState(),this._contextToken,{id:this._pageId});return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getGrid(){const e="ClientApi.XrmGridControl.getGrid";try{return m.a.instance.reportCall(e),!this._grid&&this.getEntityName()&&(this._grid=new o.a(w,this._applicationContext,this._contextToken,this._pageId,this.getEntityName(),this._isEditable,this._controlName)),m.a.instance.reportSuccess(e),this._grid}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getViewSelector(){const e="ClientApi.XrmGridControl.getViewSelector";try{return m.a.instance.reportCall(e),this._viewSelector||(this._viewSelector=new y(w,this._contextToken,this._pageId,this._controlName,this._gridType)),m.a.instance.reportSuccess(e),this._viewSelector}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getTeamTemplateId(){const e="ClientApi.XrmGridControl.getTeamTemplateId";try{m.a.instance.reportCall(e);let t=null;const n=w.getState();if(Object(P.c)(n,x.c)){if(this.getEntityName()&&3===this._gridType){const e=Object(h.fb)(n,this._connectedControlProps,this._contextToken.parentContextToken),a="TeamTemplateId";e&&e.Controls&&e.Controls[this._controlName]&&e.Controls[this._controlName].Parameters&&e.Controls[this._controlName].Parameters[a]&&(t=e.Controls[this._controlName].Parameters[a])}}return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){return this._clientApiExecutor.execute("getEntityName",(e,t)=>{if(!this._entityName){if(this._entityName=Object(u.F)(w.getState(),this._pageId,this._contextToken,this._controlName),!this._entityName&&3===this._gridType){const n=Object(h.fb)(w.getState(),this._connectedControlProps,this._contextToken.parentContextToken),a="TargetEntityType";if(!(n&&n.Controls&&n.Controls[this._controlName]&&n.Controls[this._controlName].Parameters&&n.Controls[this._controlName].Parameters[a])){let r;return n?n.Controls?n.Controls[this._controlName]?n.Controls[this._controlName].Parameters?n.Controls[this._controlName].Parameters[a]||(r="formDescriptor.Controls[this.name].Parameters[targetEntityType] is null or undefined"):r="formDescriptor.Controls[this.name].Parameters is null or undefined":r="formDescriptor.Controls[this.name] is null or undefined":r="formDescriptor.Controls is null or undefined":r="formDescriptor is null or undefined",this._clientApiExecutor.reportFailure(e,new g.a(r),t),null}this._entityName=n.Controls[this._controlName].Parameters[a]}if(!this._entityName)return this._clientApiExecutor.reportFailure(e,new g.a("Logical name of the entity type is coming as null or undefined."),t),null}return this._entityName})}refresh(){this._clientApiExecutor.executeAsync("refresh",()=>w.dispatch(Object(c.a)(this._pageId,this._contextToken,this._controlName)))}refreshRibbon(){this._clientApiExecutor.executeAsync("refreshRibbon",()=>w.dispatch(Object(v.a)(this._pageId,Object(u.w)(w.getState(),this._pageId,this._contextToken))))}getUrl(e){const t="ClientApi.XrmGridControl.getUrl";try{m.a.instance.reportCall(t);let n=null,a=null;const r=this._getCurrentView();a={entityTypeName:this.getEntityName()},r&&(a.viewType="savedquery"===r.entityType?I.b.savedview:I.b.userview,a.viewId=new s.a(r.id)),n=i.a.Grid;let o=null;if(1===e)o=w.dispatch(Object(_.a)(n,a));else{const e=Object(j.a)(w,this._pageId);o=w.dispatch(Object(_.c)(e,n,a))}return m.a.instance.reportSuccess(t),o}catch(e){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(t,e,null,n),e}}getRecordSetQueryKey(){return this._clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(u.cb)(w.getState(),this._contextToken,{id:this._pageId}))}getGridType(){return m.a.instance.reportUsage("ClientApi.XrmGridControl.getGridType"),this._gridType}getRelationship(){return this._clientApiExecutor.execute("getRelationship",(e,t)=>{if(!this._relationship){const n=Object(u.v)(w.getState(),this._pageId,this._contextToken);if(n){const e=n.relationshipName;if(e&&(this._relationship=A(e,this.getEntityName()),n.relationshipRoleOrdinal)){const e=n.relationshipRoleOrdinal===E.a.Referencing?1:2;this._relationship.roleType=e}}else b.a.getInstance().traceManager.getTracer(e).error("Grid dataset was null",t)}return this._relationship})}getParentForm(){const e="ClientApi.XrmGridControl.getParentForm";try{m.a.instance.reportCall(e);const t=this._contextToken&&this._contextToken.parentContextToken?w.dispatch(Object(C.b)(this._pageId,this._contextToken.parentContextToken)):null;return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"controlName",value:this._controlName}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRollupType(){return this._clientApiExecutor.execute("getRollupType",()=>Object(u.eb)(w.getState(),this._pageId,this._contextToken))}_getCurrentView(){let e=null;const t=this.getViewSelector().getCurrentView();if(t)return e="savedquery"===t.entityType?"savedquery":"userquery",{entityType:e,id:t.id};const n=Object(r.g)(w.getState(),this._pageId);if(n.viewType&&n.viewId){const t=n.viewId?s.a.externalGuid(n.viewId):void 0;if(e=n.viewType===I.b.savedview?"savedquery":"userquery",e&&t)return{entityType:e,id:t}}return null}}function A(e,t){const n={};n.name=e;const a=Object(O.h)(w.getState(),t);if(a){let t;if(a.OneToManyRelationships&&a.OneToManyRelationships[e]?t=a.OneToManyRelationships[e]:a.ManyToOneRelationships&&a.ManyToOneRelationships[e]&&(t=a.ManyToOneRelationships[e]),t)n.attributeName=t.ReferencingAttribute,n.relationshipType=0,n.navigationPropertyName=t.ReferencingEntityNavigationPropertyName;else if(a.ManyToManyRelationships&&a.ManyToManyRelationships[e]){const t=a.ManyToManyRelationships[e];n.relationshipType=1,1===n.roleType?(n.attributeName=t.Entity1IntersectAttribute,n.navigationPropertyName=t.Entity1NavigationPropertyName):(n.attributeName=t.Entity2IntersectAttribute,n.navigationPropertyName=t.Entity2NavigationPropertyName)}}return n}},HhsT:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n("uNLT"),r=n("Uv1Y"),i=n("cUbT"),o=n("gQ5I"),s=n("+aj2"),c=n("YxC/"),l=n("ZUzm"),u=n("sHzf"),d=n("bvqZ"),h=n("FdXt"),g=n("dHD5"),p=n("i1f0"),m=n("bT7G"),b=n("3tOH"),f=n("Bj/n"),y=n("O7zD");function C(e){return{type:"saveAndClose.saveAndCloseFormDialogAction.async",execute({dispatch:t,getState:n},C,_){const v=n(),S=Object(g.j)(v,e),O=Object(p.zb)(v,e,S),I=Object(p.ac)(v,e,S);if(!(!Object(m.g)(v,I)&&O&&Object.keys(O).length>0))return t(Object(a.e)(e,2)).then(n=>{const a=Object(p.Ib)(v,e),g=a?"Forms.MainFormDialogRoot.SaveAndClose":"Forms.QuickCreateFormRoot.SaveAndClose";if(n){const r=[{name:"isEntityRefNull",value:!1},{name:"entityTypeName",value:n.etn}];C.EventManager.ReportComponentSuccess(g,r);return(a?Promise.resolve(e):t(Object(s.b)(e,n))).then(e=>(t(Object(i.a)(n.etn)),function(e,t,n){const a="quickcreate_",r=Object(c.e)(t,[h.g,h.c]),i={actionLabel:Object(c.c)(r,h.g),eventHandler:()=>{e(Object(l.a)(n)),e(Object(u.removeToastNotification)(a+n.id.guid))}},o=null,s={id:a+n.id.guid,type:1,level:1,message:Object(c.c)(r,h.c),title:null,action:i,onCloseHandler:o};e(Object(d.b)(s))}(t,v,n),t(Object(o.e)(e,"save")).then(()=>n)))}return C.EventManager.ReportComponentSuccess(g,[{name:"isEntityRefNull",value:!0}]),Promise.reject(new r.a("Record is not created"))});for(const n in O){const a=O[n].label,r=O[n].errorMessage,i=t(Object(f.b)(a,r));t(Object(f.c)(S,e,i,b.a.error,Object(y.d)(e,n)))}}}}},JF0K:function(e,t,n){"use strict";n.d(t,"h",(function(){return a})),n.d(t,"i",(function(){return r})),n.d(t,"o",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return b})),n.d(t,"e",(function(){return f})),n.d(t,"q",(function(){return y})),n.d(t,"p",(function(){return C})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return h}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="BusinessProcessFlow.MoveToNextStage",r="BusinessProcessFlow.MoveToPreviousStage",i="BusinessProcessFlow.SetActiveStage",o="BusinessProcessFlow.AbandonProcess",s="BusinessProcessFlow.ReactivateProcess",c="BusinessProcessFlow.CompleteProcess",l="BusinessProcessFlow.InitilaizeWithFormEntityOnly",u="BusinessProcessFlow.InitilaizeWithProcessAndFormEntity",d="BusinessProcessFlow.SetActiveProcess",h="BusinessProcessFlow.SetActiveProcessInstance",g="BusinessProcessFlow.ActionStep",p="BusinessProcessFlow.FlowStepWidget",m="BusinessProcessFlow.RefreshFlowStep",b="BusinessProcessFlow.RenderProcessControl",f="BusinessProcessFlow.HideProcessControlForUciOffline",y="SaveFailureReason",C="faultedSnapshotId"},Jcgi:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n("c/eZ"),r=n("nuS9"),i=n("dD0b"),o=n("pyUm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e){const{title:t,textStyle:n}=e,s=Object(a.__rest)(e,["title","textStyle"]);return r.createElement(i.a,Object.assign({accessibilityRole:"button",accessibilityLabel:t},s),r.createElement(o.a,{style:[l.text,n]},t))}function c(e){return r.createElement(s,Object.assign({},e,{style:[l.button,e.style]}))}const l=n("EZ4w").a.create({button:{color:"#2266E3",alignSelf:"center"},text:{color:"inherit",fontSize:17}})},KGWS:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{constructor(e,t){this._traversedPath=e,this._stageId=t}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get stageId(){return this._stageId}set stageId(e){this._stageId=e}}var r=n("sxfa"),i=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{get globalPathAndActiveStage(){return this._globalPathAndActiveStage}get navigationEntities(){return this._navigationEntities}get navigationEntityIdsByEntityLogicalName(){return this._navigationEntityIdsByEntityLogicalName}set globalPathAndActiveStage(e){(e||this._globalPathAndActiveStage||this._globalPathAndActiveStage.stageId===e.stageId)&&(this._globalPathAndActiveStage=e)}InitGlobalPathAndActiveStage(e){this._updateNavigationDictionary(e.navigationEntities),this.UpdateGlobalPathAndActiveStage(e.traversedPath,e.activeStageId)}UpdateGlobalPathAndActiveStage(e,t){this.globalPathAndActiveStage=new a(new r.a(e),t)}_updateNavigationDictionary(e){if(e){this._navigationEntities=e,this._navigationEntityIdsByEntityLogicalName={};for(let t=0;t<e.length;t++)this._navigationEntityIdsByEntityLogicalName[e[t].entityLogicalName]=new i.a(e[t].id)}}}},KnyI:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.removeOption";function i(e,t,n,i){const o=Object(a.x)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},L8zx:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q})),n.d(t,"b",(function(){return Z}));var a=n("SAYH"),r=n("i1f0"),i=n("UqyN"),o=n("ABCl"),s=n("0nOn"),c=n("odYE"),l=n("hvSt"),u=n("5Oca"),d=n("CPoS"),h=n("qshH"),g=n("16wZ"),p=n("ZIjf");class m{constructor(e,t,n){const a="ClientApi.XrmProcessStep.constructor";t||Object(g.j)(a,"step"),n||Object(g.j)(a,"processManager"),e||Object(g.j)(a,"store"),this._step=t,this._processManager=n}isRequired(){const e="ClientApi.XrmProcessStep.isRequired";try{p.a.instance.reportCall(e);const t=this._step.get_isProcessRequired();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getAttribute(){const e="ClientApi.XrmProcessStep.getAttribute";try{if(p.a.instance.reportCall(e),!this._attribute){const e=this._step.get_Steps().get_item(0);this._attribute=!e||e.get_isSystemControl()?null:e.get_dataFieldName()}return p.a.instance.reportSuccess(e),this._attribute}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStep.getName";try{p.a.instance.reportCall(e);const t=this._step.get_Name();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getProgress(){const e="ClientApi.XrmProcessStep.getProgress";try{p.a.instance.reportCall(e);let t=4;if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep&&this._processManager){const e=this._processManager.getActionLog(new a.a(this._step.get_Id()));e&&(t=e.status),t=0}}return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}setProgress(e,t){const n="ClientApi.XrmProcessStep.setProgress";try{p.a.instance.reportCall(n);let a="invalid";switch(e){case 0:case 1:case 2:case 3:case 4:a=this._setProgressInternal(e,t)}return p.a.instance.reportSuccess(n),a}catch(e){throw h.a.getInstance().reportFailure(n,e),e}}_setProgressInternal(e,t){if(this._step.get_Steps()&&this._step.get_Steps().get_item(0)){if(this._step.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep){const n=this._processManager.UpdateActionLog(new a.a(this._step.get_Id()),e,t);if(n)return n}}return"invalid"}}var b=n("Sbn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t){this._processManager=t,null!=this._processManager&&this._processManager.shouldReInitializeNavigationBehavior()&&this._processManager.setBpfNavigationBehavior(this)}get allowCreateNew(){return p.a.instance.reportUsage("ClientApi.XrmProcessNavigationBehavior.getAllowCreateNew"),this._allowCreateNew}set allowCreateNew(e){const t="ClientApi.XrmProcessNavigationBehavior.setAllowCreateNew";try{p.a.instance.reportCall(t),this._allowCreateNew=e,null!=this._processManager&&this._processManager.setBpfNavigationBehavior(this),p.a.instance.reportSuccess(t)}catch(e){throw h.a.getInstance().reportFailure(t,e),e}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let y;class C{constructor(e,t,n,a,r){y=e,this._entityTypeName=n,this._activeStageId=a,this._stageStep=t,new f(e,r),r&&(this._processManager=r)}getCategory(){const e="ClientApi.XrmProcessStage.getCategory";try{p.a.instance.reportCall(e);const t=this._stageStep.get_stageCategory(),n={getValue(){let e=parseInt(t,10);return Number.isNaN(e)&&(e=-1),e}};return p.a.instance.reportSuccess(e),n}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmProcessStage.getId";try{p.a.instance.reportCall(e);const t=this._stageStep.get_Id();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getEntityName(){return p.a.instance.reportUsage("ClientApi.XrmProcessStage.getEntityName"),this._entityTypeName}getStatus(){const e="ClientApi.XrmProcessStage.getStatus";try{p.a.instance.reportCall(e);const t=this.getId()===this._activeStageId?"active":"inactive";return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getName(){const e="ClientApi.XrmProcessStage.getName";try{p.a.instance.reportCall(e);const t=this._stageStep.get_Description();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getSteps(){const e="ClientApi.XrmProcessStage.getSteps";try{if(p.a.instance.reportCall(e),!this._steps&&(this._steps=new b.a(e),null!=this._stageStep.get_Steps()&&this._stageStep.get_Steps().get_Count()>0))for(let e=0;e<this._stageStep.get_Steps().get_Count();e++){const t=this._stageStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const e=t.get_Steps().get_item(0);e&&(e instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep||e instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)&&this._steps.add(t.get_Id(),new m(y,t,this._processManager))}}return p.a.instance.reportSuccess(e),this._steps}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getNavigationBehavior(){const e="ClientApi.XrmProcessStage.getNavigationBehavior";try{p.a.instance.reportCall(e);const t=this._processManager.getBpfNavigationBehavior();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let _;class v{constructor(e,t,n,a,r){const i="ClientApi.XrmBusinessProcessFlow.constructor";t||Object(g.j)(i,"workflowStep"),a||Object(g.j)(i,"activeStageId"),r||Object(g.j)(i,"processManager"),e||Object(g.j)(i,"store"),Object(g.a)(n)&&Object(g.j)(i,"isRendered"),_=e,this._isRendered=n,this._workflowStep=t,this._activeStageId=a,this._processManager=r}getName(){const e="ClientApi.XrmBusinessProcessFlow.getName";try{p.a.instance.reportCall(e);const t=this._workflowStep.get_Name();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}getId(){const e="ClientApi.XrmBusinessProcessFlow.getId";try{p.a.instance.reportCall(e);const t=this._workflowStep.get_Id();return p.a.instance.reportSuccess(e),t}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}isRendered(){return p.a.instance.reportUsage("ClientApi.XrmBusinessProcessFlow.isRendered"),this._isRendered}getStages(){const e="ClientApi.XrmBusinessProcessFlow.getStages";try{if(p.a.instance.reportCall(e),!this._stages){this._stages=new b.a(e);for(let e=0;e<this._workflowStep.get_Steps().get_Count();e++){const t=this._workflowStep.get_Steps().get_item(e);if(t instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep){const e=t;for(let t=0;t<e.get_Steps().get_Count();t++){const n=e.get_Steps().get_item(t);this._stages.add(n.get_Id(),new C(_,n,e.get_EntityLogicalName(),this._activeStageId,this._processManager))}}}}return p.a.instance.reportSuccess(e),this._stages}catch(t){throw h.a.getInstance().reportFailure(e,t),t}}}var S,O=n("1kth"),I=n("cZbt"),j=n("blB4"),P=n("UuJw");!function(e){e.success="success",e.invalid="invalid"}(S||(S={}));var x=n("r/aD"),E=n("iF9X"),w=n("37s6"),T=n("69Qu"),A=n("IaGr"),F=n("arV0"),N=n("2Ct/"),k=n("ycdb"),M=n("ruPX"),D=n("cfbi");let R;class L{constructor(e,t,n,r,i){this._clientApiExecutor=new s.a(e,"ClientApi.XrmProcessControlData.",n,t);const o=this._clientApiExecutor.getComponentName("constructor");n||Object(g.j)(o,"pageId"),r||Object(g.j)(o,"entity"),t||Object(g.j)(o,"contextToken"),e||Object(g.j)(o,"store"),R=e,this._pageId=n,this._entity=r;let l=!1;Object(x.d)(R.getState(),this._pageId,o,!0)&&(this._processManager=i,l=!0),this._contextToken=t;const u=r.getEntityReference();this._entityRef=new c.a(u.entityType,a.a.tryParseOrNull(u.id),u.name);const d=Object(x.b)(n,e.getState(),l);A.a.getInstance().eventManager.ReportComponentSuccess(o,d)}getActiveProcess(){const e="ClientApi.XrmProcessControlData.getActiveProcess";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcess();let n=null;if(t){const e=this._getProcessManager().getActiveStageId();n=new v(R,t,!0,e,this._getProcessManager())}return p.a.instance.reportSuccess(e),n}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}setStatus(e,t){const n="ClientApi.XrmProcessControlData.setStatus";try{if(p.a.instance.reportCall(n),!Object(x.d)(R.getState(),this._pageId,n))return void p.a.instance.reportSuccess(n);if(!e||this.getStatus()&&e===this.getStatus())return void p.a.instance.reportSuccess(n);let a;if(e===I.a.active)a=l.a.Active;else if(e===I.a.finished)a=l.a.Finished;else{if(e!==I.a.aborted)return void p.a.instance.reportSuccess(n);a=l.a.Aborted}this._getProcessManager().setStatus(a).then(()=>{this._callback(t,e,n),p.a.instance.reportSuccess(n)}).catch(t=>{const a=h.a.getInstance().getEventParameters(this._contextToken);return a.push({name:"newStatus",value:e}),Object(g.d)(R,t,n,a)})}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(n,e,null,t),e}}getStatus(){const e="ClientApi.XrmProcessControlData.getStatus";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._convertToXrmProcessInstanceStatus(this._getProcessManager().getStatus());return p.a.instance.reportSuccess(e),t}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}getInstanceName(){const e="ClientApi.XrmProcessControlData.getInstanceName";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;let t=this._getProcessManager().getProcessInstanceName();if(!t){const e=Object(u.e)(R.getState(),this._entityRef);t=Object(d.c)(R.getState(),e)}return p.a.instance.reportSuccess(e),t}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}getInstanceId(){const e="ClientApi.XrmProcessControlData.getInstanceId";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getProcessInstanceId(),n=t?a.a.toString(t):null;return p.a.instance.reportSuccess(e),n}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}getProcessInstances(e){const t="ClientApi.XrmProcessControlData.getProcessInstances";try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t)||Object(N.g)(R.getState()))return;"function"==typeof e&&this._getProcessManager().getProcessInstances().then(n=>{if(n&&n.value&&n.value.length>0){const a={};n.value.forEach(e=>{e.businessprocessflowinstanceid&&(a[e.businessprocessflowinstanceid]={CreatedOnDate:e.createdon?new Date(e.createdon):null,ProcessDefinitionID:e._processid_value,ProcessDefinitionName:e.name,ProcessInstanceID:e.businessprocessflowinstanceid,ProcessInstanceName:e.name,StatusCodeName:this._convertToXrmProcessInstanceStatus(e.Process_x002e_statuscode),CreatedOn:e.createdon?new Date(e.createdon).toLocaleDateString():"",ProcessDefintionID:e._processid_value,ProcessDefintionName:e.name})}),Object(o.c)(t,[],()=>{e(a)})}p.a.instance.reportSuccess(t)}).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,e,t+".getProcessInstances",n)})}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}setActiveProcess(e,t){this._clientApiExecutor.executeAsync("setActiveProcess",(n,r)=>{const i=a.a.tryParseOrNull(e),o=Object(F.m)(R.getState(),this._pageId);if(i&&a.a.equals(i,a.a.EMPTY)){if(o){const e=new c.a(this._entity.getEntityName(),a.a.EMPTY);return R.dispatch(Object(k.b)(!0,e)),A.a.getInstance().eventManager.ReportComponentSuccess(n,r),Promise.resolve().then(()=>(this._callback(t,S.success,n,r),Promise.resolve())).catch(e=>(this._callback(t,S.invalid,n,r),Promise.reject(e)))}return Promise.resolve().then(()=>(this._callback(t,S.invalid,n,r),Promise.resolve()))}if(!Object(x.d)(R.getState(),this._pageId,n,!0)||Object(N.g)(R.getState()))return Promise.resolve();let s=null;return s=o?Promise.resolve():this._getProcessManager().setActiveProcess(e),s.then(()=>{this._callback(t,S.success,n,r);const a=this.getActiveProcess();return a&&a.getId().toUpperCase()===e.toUpperCase()||this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),e),Promise.resolve()}).catch(e=>(this._callback(t,S.invalid,n,r),Promise.reject(e)))},[{name:"processId",value:e,isRequired:!0,expectedDataType:"guid"}])}setActiveProcessInstance(e,t){this._clientApiExecutor.executeAsync("setActiveProcessInstance",(n,a)=>!Object(x.d)(R.getState(),this._pageId,n)||Object(N.g)(R.getState())?Promise.resolve():this._getProcessManager().setActiveProcessInstance(e).then(r=>{this._callback(t,S.success,n,a);return this.getInstanceId()!==e&&this._reloadPage(n,this._getProcessManager().getCurrentFormEntity(),r,e),Promise.resolve()}).catch(e=>(this._callback(t,S.invalid,n,a),Promise.reject(e))),[{name:"processInstanceId",value:e,isRequired:!0,expectedDataType:"guid"}])}getEnabledProcesses(e){const t="ClientApi.XrmProcessControlData.getEnabledProcesses";try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t,!0))return void p.a.instance.reportSuccess(t);const n=R.getState();if(Object(E.g)(n)&&Object(w.w)(n)&&!Object(T.b)(n)){const n={};return void("function"==typeof e&&Object(o.c)(t,[],()=>{e(n)}))}this._getProcessManager().getEnabledProcesses().then(n=>{const a={};n&&n.length>0&&n.forEach(e=>{a[e.workflowId]=e.name}),"function"==typeof e&&Object(o.c)(t,[],()=>{e(a)}),p.a.instance.reportSuccess(t)}).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,e,t+".getEnabledProcesses",n)})}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}switchProcess(){const e="ClientApi.XrmProcessControlData.switchProcess";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e)||Object(N.g)(R.getState()))return;this._getProcessManager().switchProcess(),p.a.instance.reportSuccess(e)}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}abandonProcess(){const e="ClientApi.XrmProcessControlData.abandonProcess";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void p.a.instance.reportSuccess(e);this._getProcessManager().abandonProcess().then(()=>{p.a.instance.reportSuccess(e)}).catch(t=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,t,e+".abandonProcess",n)})}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}reactivateProcess(){const e="ClientApi.XrmProcessControlData.reactivateProcess";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void p.a.instance.reportSuccess(e);this._getProcessManager().reactivateProcess().then(()=>{p.a.instance.reportSuccess(e)}).catch(t=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,t,e+".reactivateProcess",n)})}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}completeProcess(){const e="ClientApi.XrmProcessControlData.completeProcess";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e)||Object(F.m)(R.getState(),this._pageId))return void p.a.instance.reportSuccess(e);this._getProcessManager().completeProcess().then(()=>{p.a.instance.reportSuccess(e)}).catch(t=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,t,e+".completeProcess",n)})}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}getActiveStage(){const e="ClientApi.XrmProcessControlData.getActiveStage";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActiveStage();let n=null;return t&&(n=new C(R,t,this._getProcessManager().getCurrentFormEntity().etn,t.get_Id(),this._getProcessManager())),p.a.instance.reportSuccess(e),n}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}getActivePath(){const e="ClientApi.XrmProcessControlData.getActivePath";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getActivePathStages();let n=null;if(t){const a=this._getProcessManager().getActiveStageId(),r=new b.a(e);t.forEach(e=>{const t=e.get_parent().get_EntityLogicalName();r.add(e.get_stageId(),new C(R,e,t,a,this._getProcessManager()))}),n=r}return p.a.instance.reportSuccess(e),n}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}setActiveStage(e,t){const n="ClientApi.XrmProcessControlData.setActiveStage";try{if(p.a.instance.reportCall(n),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))p.a.instance.reportSuccess(n),this._callback(t,j.a.dirtyForm,n);else{if(!Object(x.d)(R.getState(),this._pageId,n))return void p.a.instance.reportSuccess(n);this._getProcessManager().setActiveStage(e).then(()=>{this._callback(t,this._getStageInvalidReason(null),n),this._loadActiveStageEntity(n),p.a.instance.reportSuccess(n)}).catch(e=>{this._callback(t,e?this._getStageInvalidReason(e):P.a.invalid,n)})}}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(n,e,null,t),e}}moveNext(e){const t="ClientApi.XrmProcessControlData.moveNext";try{const n=!0;if(p.a.instance.reportCall(t),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))p.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);if(this._getProcessManager().isCrossEntityNavigation(n))return this._callback(e,j.a.crossEntity,t),void p.a.instance.reportSuccess(t);this._getProcessManager().moveToNextStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),p.a.instance.reportSuccess(t)}).catch(n=>{const a=n?this._getNavigationStatus(n):j.a.invalid;if(this._callback(e,a,t),a===j.a.invalid){const e=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,n,t+".moveToNextStage",e)}p.a.instance.reportSuccess(t)})}}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}movePrevious(e){const t="ClientApi.XrmProcessControlData.movePrevious";try{const n=!0;if(p.a.instance.reportCall(t),this._entity.getIsDirty()||Object(F.m)(R.getState(),this._pageId))p.a.instance.reportSuccess(t),this._callback(e,j.a.dirtyForm,t);else{if(!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);if(Object(N.g)(R.getState())&&this._getProcessManager().isCrossEntityNavigation(!n))return this._callback(e,j.a.crossEntity,t),void p.a.instance.reportSuccess(t);this._getProcessManager().moveToPreviousStage().then(()=>{this._callback(e,this._getNavigationStatus(null),t),this._loadActiveStageEntity(t),p.a.instance.reportSuccess(t)}).catch(n=>{const a=n?this._getNavigationStatus(n):j.a.invalid;if(this._callback(e,a,t),a===j.a.invalid){const e=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(R,n,t+".moveToPreviousStage",e)}p.a.instance.reportSuccess(t)})}}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}getSelectedStage(){const e="ClientApi.XrmProcessControlData.getSelectedStage";try{if(p.a.instance.reportCall(e),!Object(x.d)(R.getState(),this._pageId,e))return p.a.instance.reportSuccess(e),null;const t=this._getProcessManager().getSelectedStage();let n=null;if(t){const e=this._getProcessManager().getActiveStageId();n=new C(R,t,this._getProcessManager().getCurrentFormEntity().etn,e,this._getProcessManager())}return p.a.instance.reportSuccess(e),n}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}addOnStageChange(e){const t="ClientApi.XrmProcessControlData.addOnStageChange";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.q)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}addOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.addOnPreStageChange";Object(g.g)(e,t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.j)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnStageChange";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.L)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPreStageChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreStageChange";Object(g.g)(e,t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.E)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}addOnStageSelected(e){const t="ClientApi.XrmProcessControlData.addOnStageSelected";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.r)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnStageSelected(e){const t="ClientApi.XrmProcessControlData.removeOnStageSelected";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.M)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}addOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnProcessStatusChange";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.k)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}addOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.addOnPreProcessStatusChange";Object(g.g)(e,t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.i)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnProcessStatusChange";e||Object(g.j)(t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.F)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnPreProcessStatusChange(e){const t="ClientApi.XrmProcessControlData.removeOnPreProcessStatusChange";Object(g.g)(e,t,"handler");try{if(p.a.instance.reportCall(t),!Object(x.d)(R.getState(),this._pageId,t))return void p.a.instance.reportSuccess(t);R.dispatch(Object(O.D)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}_getStageInvalidReason(e){return e?e.stageInvalidReason||P.a.invalid:j.a.success}_getNavigationStatus(e){return e?e.navigationStatus||j.a.invalid:j.a.success}_convertToXrmProcessInstanceStatus(e){if(e){if(e===l.a.Active)return I.a.active;if(e===l.a.Finished)return I.a.finished;if(e===l.a.Aborted)return I.a.aborted}return null}_callback(e,t,n,a){const r=n+".Callback";a||(a=h.a.getInstance().getEventParameters(this._contextToken)),a.push({name:"Status",value:t}),Object(o.c)(r,a,()=>{"function"==typeof e&&e(t)})}_reloadPage(e,t,n,a){if(t){const r=Object(F.m)(R.getState(),this._pageId),i={entityTypeName:t.etn,id:r?void 0:t.id,processId:n,processInstanceId:a},o={target:"inline"};R.dispatch(Object(M.a)(D.a,i,this._pageId,o)).then(t=>{if(0!==t.status)return Object(g.d)(R,t.error,e+".navigateTo.INavigationFailure")}).catch(t=>Object(g.d)(R,t,e+".navigateTo."))}}_loadActiveStageEntity(e){const t=this._getProcessManager().getActiveStageEntityRef();t&&t.etn!==this._getProcessManager().getCurrentFormEntity().etn&&this._reloadPage(e,t,this.getActiveProcess().getId(),this.getInstanceId())}_getProcessManager(){return this._processManager||(this._processManager=Object(x.c)(this._processManager,R,this._pageId,"ClientApi.XrmProcessControlData.getProcessManager")),this._processManager}}var B=n("uNLT"),V=n("/q/W"),G=n("jRy5"),z=n("Uv1Y"),W=n("Fij2"),X=n("mIxf"),H=n("HhsT"),U=n("PUjk"),q=n("AE7n"),Y=n("P6DH");let K;class Q{constructor(e,t,n,a,r){this._entity=null;const i="ClientApi.XrmFormData.constructor";e||Object(g.j)(i,"store"),n||Object(g.j)(i,"pageId"),t||Object(g.j)(i,"contextToken"),a||Object(g.j)(i,"formContext"),K=e,this._pageId=n,this._formContext=a,this._contextToken=t,this._entity=r}get entity(){return p.a.instance.reportUsage("ClientApi.XrmFormData.entity"),this._entity}get process(){const e="ClientApi.XrmFormData.process_get";try{const t=Object(N.f)(K.getState());p.a.instance.reportCall(e);const n=!!this._process;if((!t&&!this._process||t)&&this._entity){const e=Object(F.g)(K.getState(),this._pageId),t=Object(U.b)(this._pageId,e);this._entity&&(this._process=new L(K,this._contextToken,this._pageId,this.entity,t))}p.a.instance.reportSuccess(e);const a=Object(x.a)(this._pageId,K.getState(),n,!!this._entity);return A.a.getInstance().eventManager.ReportComponentSuccess(e,a),this._process}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}set process(e){const t=Object(x.a)(this._pageId,K.getState(),!!this._process,!!this._entity);A.a.getInstance().eventManager.ReportComponentSuccess("ClientApi.XrmFormData.process_set",t),this._process=e}getEntity(){return p.a.instance.reportUsage("ClientApi.XrmFormData.getEntity"),this._entity}getIsDirty(){var e,t,n;const a="ClientApi.XrmFormData.getIsDirty";try{p.a.instance.reportCall(a);let r=!1;if(this._entity&&this._entity.getIsDirty())r=!0;else{for(let e=0;e<this.attributes.getLength();e++){const t=this.attributes.get(e);if("never"!==t.getSubmitMode()&&t.getIsDirty()){r=!0;break}}if(!r&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&(null===(n=t.data)||void 0===n?void 0:n.getIsDirty())){r=!0;break}}}return p.a.instance.reportSuccess(a),r}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(a,e,null,t),e}}get attributes(){const e="ClientApi.XrmFormData.attributes";try{if(p.a.instance.reportCall(e),!this._unboundAttributes){this._unboundAttributes=new b.a(e);const t=Object(r.Oc)(K.getState(),this._pageId);if(t)for(const e in t){const n=t[e],a=e,r=Object(i.b)(K,this._contextToken,this._pageId,a,this.entity,this._formContext.ui,n);this._unboundAttributes.add(r.getName(),r)}}return p.a.instance.reportSuccess(e),this._unboundAttributes}catch(t){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(e,t,null,n),t}}_refreshEntity(e){return this.entity.refresh().then(()=>{Object(B.d)(K.dispatch,this._contextToken,this._pageId),e&&K.dispatch(Object(O.Q)(this._contextToken,this._pageId,3,this.entity)),Object(W.b)(this.entity)})}refresh(e){const t="ClientApi.XrmFormData.refresh";try{if(p.a.instance.reportCall(t),this.entity){const n=Object(r.kb)(K.getState(),{id:this._pageId},this._contextToken);return!n&&e&&this.entity.getIsDirty()?this.save().then(e=>(p.a.instance.reportSuccess(t),{})).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(K,e,t+".save",n)}):!n&&this.entity.getIsDirty()?K.dispatch(Object(V.a)(this._pageId)).then(e=>{if(e)return this._refreshEntity(!0).then(()=>(p.a.instance.reportSuccess(t),{})).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(K,e,t+".handleUnsavedChanges.refreshEntity",n)})}).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(K,e,t+".handleUnsavedChanges",n)}):this._refreshEntity(!0).then(()=>(p.a.instance.reportSuccess(t),{})).catch(e=>{const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(K,e,t+".handleUnsavedChanges.refreshEntity",n)})}const n=new z.a("Refresh action cannot be executed since form entity is null",2147746581);return A.a.getInstance().traceManager.getTracer(t).info("Refreshing on a non entity page"),Object(g.d)(K,n,t+".entity")}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);return Object(g.d)(K,e,t,n)}}save(e){const t="ClientApi.XrmFormData.save",n=h.a.getInstance().getEventParameters(this._contextToken);if(!this._entity){const e=new z.a("Save action cannot be executed since form entity is null",2147746581);return Object(g.d)(K,e,t+".entity")}try{p.a.instance.reportCall(t);let i=1;e&&e.saveMode&&(i=e.saveMode);return Z(this._pageId,K,i,n,this._contextToken,this.entity,!0,!0).then(e=>{if(e){const i={entityType:e.etn,id:a.a.toString(e.id),name:e.name};return Object(r.Kb)(K.getState(),this._pageId)?(p.a.instance.reportSuccess(t),{savedEntityReference:i}):this._refreshEntity(!1).then(()=>(p.a.instance.reportSuccess(t),{savedEntityReference:i})).catch(e=>Object(g.d)(K,e,t+".refresh",n))}if(Object(r.kb)(K.getState(),{id:this._pageId},this._contextToken)||!this.entity.getIsDirty()){const e=this.entity.getEntityReference();return p.a.instance.reportSuccess(t),{savedEntityReference:e}}const i=new z.a("Save action was not executed and the form is dirty.",2147879192);return Object(g.d)(K,i,t+".NoReference",null,!1)}).catch(e=>{if(e&&(2200000006===e.errorCode||2200000004===e.errorCode)){const e=this.entity.getEntityReference();return p.a.instance.reportSuccess(t),Promise.resolve({savedEntityReference:e})}return Object(g.d)(K,e,t,n)})}catch(e){return Object(g.d)(K,e,t,n)}}isValid(){var e,t,n;const a="ClientApi.XrmFormData.isValid";try{p.a.instance.reportCall(a);let r=!0;if(this.entity&&!this.entity.isValid())r=!1;else if(this.attributes)for(let e=0;e<this.attributes.getLength();e++)if(!this.attributes.get(e).isValid()){r=!1;break}if(r&&(null===(t=null===(e=this._formContext)||void 0===e?void 0:e.ui)||void 0===t?void 0:t.controls))for(let e=0;e<this._formContext.ui.controls.getLength();e++){const t=this._formContext.ui.controls.get(e);if("formcomponent"===t.getControlType()&&t.isLoaded()&&!(null===(n=t.data)||void 0===n?void 0:n.isValid())){r=!1;break}}return r||K.dispatch(Object(X.b)(this._pageId,this._contextToken)),p.a.instance.reportSuccess(a),r}catch(e){const t=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(a,e,null,t),e}}addOnLoad(e){const t="ClientApi.XrmFormData.addOnLoad";e||Object(g.j)(t,"handler");try{p.a.instance.reportCall(t),K.dispatch(Object(O.c)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}removeOnLoad(e){const t="ClientApi.XrmFormData.removeOnLoad";e||Object(g.j)(t,"handler");try{p.a.instance.reportCall(t),K.dispatch(Object(O.x)(this._contextToken,this._pageId,e)),p.a.instance.reportSuccess(t)}catch(e){const n=h.a.getInstance().getEventParameters(this._contextToken);throw h.a.getInstance().reportFailure(t,e,null,n),e}}}function Z(e,t,n,i,o,s,c,l){const u=t.getState(),d=a.a.tryParseOrNull(s.getId());if(o.contextTokenType===G.a.GridRow){const n=[],a=Object(Y.T)(u,e,o.parentContextToken,o.parentContextToken.controlName);return s.attributes.forEach(e=>n.push(e.getName())),i.push({name:"functionName",value:"saveEmbeddedEntity"}),t.dispatch(Object(q.a)(e,s.getEntityName(),null==d?void 0:d.guid,null,n,null==a?void 0:a.guid,!1,o.parentContextToken))}if(Object(r.Kb)(u,e))return i.push({name:"functionName",value:"saveAndCloseFormDialogAction"}),t.dispatch(Object(H.a)(e));if(d&&!a.a.equals(d,a.a.EMPTY))return i.push({name:"functionName",value:"saveForm"}),t.dispatch(Object(B.e)(e,n));const h=Object(F.l)(t.getState(),e);return i.push({name:"functionName",value:"saveFormAndNavigate"}),t.dispatch(Object(B.f)(e,h,l,n,!1,c))}},LLfG:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.submitmode";function i(e,t,n,i){const o=Object(a.x)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},"N+Ya":function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="navigation.item.label";function r(e,t,n,r){return{type:a,payload:{label:n,currentLanguageId:r},meta:{pageId:e,navigationItemId:t}}}},NAQz:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"c",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return f})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return C})),n.d(t,"p",(function(){return _})),n.d(t,"q",(function(){return v})),n.d(t,"s",(function(){return I}));var a=n("w1eR");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="PersonalisationSettingHeader",i="Settings_Mobile_Settings",o="Settings_ToastNotification_Title",s="Web.NavBar.SettingsOpenNavTour_Caption",c="Settings_About",l="Settings_Privacy_Statement",u="Settings_Privacy_Statement_Link",d="Settings_Privacy_Statement_Link_Online",h="Settings_Advanced_Admin_Settings_Preview",g="Settings_Customization",p="Settings_Advanced_Settings",m="Settings_License_Terms",b="Settings_License_Terms_Link_IPad",f="Settings_License_Terms_Link_IPhone",y="Settings_License_Terms_Link_Android",C="Settings_License_Terms_Link_AndroidPhone",_="Settings_License_Terms_Link_Windows",v="Settings_License_Terms_Link_WindowsPhone",S=[r,i,o,"Settings_App_Page",s,c,"Web.NavBar.SettingsLearningPath_OptIn_Caption","Web.NavBar.SettingsLearningPath_OptOut_Caption",l,u,d,m,b,f,y,C,_,v],O=[...S,h,g,p];function I(e){return e===a.a.Browser?O:S}},NPmm:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return _})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return S}));var a=n("u+q+"),r=n("Zzxs"),i=n("nuS9"),o=n("jTSi"),s=n("arV0"),c=n("uNLT"),l=n("SAYH"),u=n("cfbi"),d=n("dHD5"),h=n("i1f0"),g=n("/q/W"),p=n("aOhN"),m=n("ruPX"),b=n("z0a7"),f=n("1fn7");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function y(e,t){return e(Object(c.e)(t,1))}function C(e){const t=Object(a.c)(),n=Object(a.d)(t=>Object(d.j)(t,e),a.b),h=Object(a.d)(t=>Object(s.g)(t,e)),{isInCreateMode:m,isDirty:b}=_(e),f=i.useCallback(()=>{t(Object(o.b)(n,e,r.b)),h&&h.id&&!l.a.isNullOrEmpty(h.id)?y(t,e):t(Object(c.f)(e,u.a,!0,1,!1)).then(a=>{a&&Object(c.d)(t,n,e)})},[n,t,e,h]),C=i.useCallback(()=>{t(m?Object(p.b)():Object(g.a)(e))},[t,m,e]);return i.useMemo(()=>({save:f,discard:C,isInCreateMode:m,isDirty:b}),[C,b,m,f])}function _(e){const t=Object(a.d)(t=>Object(s.m)(t,e)),n=Object(a.d)(n=>t||Object(h.Nb)(n,e,Object(d.j)(n,e)));return{isInCreateMode:t,isDirty:n}}function v(e){const t=Object(a.c)(),n=Object(b.a)([f.n])[f.n],{entityTypeName:r}=Object(a.d)(t=>Object(s.g)(t,e));return i.useMemo(()=>[{save:()=>y(t,e).then(()=>t(Object(m.a)(u.a,{entityTypeName:r},e))),label:n}],[t,r,e,n])}function S({pageId:e,children:t}){const{save:n,isDirty:a}=C(e);return t(n,a)}},NdUn:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n("c/eZ"),r=n("nuS9"),i=n("ucY0"),o=n("pyUm"),s=n("dD0b"),c=n("7Xh3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l({icon:e,size:t,color:n,type:a,flipInRtl:s,fontWeight:l}){return e?1===a?r.createElement(c.b,{source:e,style:{fill:n,height:t,width:t,transform:`scaleX(${s&&i.a.isRTL?-1:1})`}}):r.createElement(o.a,{style:{fontFamily:"CRM MDL2",fontSize:t,color:n,transform:[{scaleX:s&&i.a.isRTL?-1:1}],fontWeight:l}},e):null}function u(e){const{size:t,color:n,icon:i,type:o}=e,c=Object(a.__rest)(e,["size","color","icon","type"]);return r.createElement(s.a,Object.assign({accessibilityRole:"button"},c),r.createElement(l,{icon:i,size:t,color:n,type:o}))}},NtHU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="header.bodyvisible";function i(e,t,n){const i=Object(a.v)(t);return{type:r,payload:n,meta:{pageId:e,contextKey:i}}}},OWbt:function(e,t,n){"use strict";n.d(t,"f",(function(){return _e})),n.d(t,"h",(function(){return ae})),n.d(t,"i",(function(){return de})),n.d(t,"j",(function(){return he})),n.d(t,"k",(function(){return ge})),n.d(t,"c",(function(){return oe})),n.d(t,"d",(function(){return se})),n.d(t,"a",(function(){return te})),n.d(t,"b",(function(){return ne})),n.d(t,"e",(function(){return re})),n.d(t,"g",(function(){return Ce}));var a=n("4leG"),r=n("SAYH"),i=n("y60j"),o=n("Uv1Y"),s=n("i1f0"),c=n("Z/4N"),l=n("arV0"),u=n("odYE"),d=n("LbMF"),h=n("IqkD"),g=n("mIxf"),p=n("1qQb"),m=n("FZDd"),b=n("WY/A"),f=n("Dea/"),y=n("iZ7K"),C=n("5Oca"),_=n("Jj4w"),v=n("IVVt");var S=n("3hnk"),O=n("qTme"),I=n("dMZy"),j=n("lLEV"),P=n("5ZBI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const x="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlTimelineWallSelector";var E=n("E5qG"),w=n("dHD5"),T=n("EY5k"),A=n("YGjz"),F=n("3mEc"),N=n("8nT0"),k=n("Co7m"),M=n("bT7G"),D=n("AF/G"),R=n("1usl"),L=n("4Us1"),B=n("99zj"),V=n("E8F2"),G=n("YxC/"),z=n("HfZT"),W=n("74Tm"),X=n("9fGf"),H=n("/qEh"),U=n("ldGr"),q=n("NUHF"),Y=n("3/02"),K=n("Lyxw"),Q=n("N6E8"),Z=n("455M"),J=n("p8cR"),$=n("pF61"),ee=n("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const te="form.initialize",ne="form.xrmready";function ae(e,t,n,a,c){const p=[{name:"formId",value:r.a.toString(e)},{name:"pageId",value:t},{name:"contextKey",value:Object(w.v)(n)}];return{type:"form.initialize.async",execute({dispatch:m,getState:b},f,C){const _=b(),v=Object(l.g)(_,t),{entityTypeName:O,data:I,recordSetQueryKey:T}=v,A=f.TraceManager.getTracer("Forms.InitializeForm"),M=[];let L;if(p.push({name:"isPreview",value:v&&v.isPreview}),p.push({name:"EntityName",value:v&&v.entityTypeName}),A.info("initializeForm started.",p),Object(J.b)(function(e){return()=>{const t={},n={},a={};return(r,i,o,s,c)=>{P.a.info(x+o.controlId+": createGetTimelineWallData started");let l=!1;n.hasOwnProperty(r)&&n[r]||(n[r]=new j.a(e,r,o.id));const u=n[r],d=u.retrieveTimelineWallObject(i,o,s,c,e);a.hasOwnProperty(r)&&a[r]&&d===a[r]||(a[r]=d,l=!0);const h=u;return l&&(t[r]=h),P.a.info(x+o.controlId+": createGetTimelineWallData finished"),t[r]}}}(m),Z.a.TimelineWall),A.info("BusinessProcessWrapperManager.Instance.init started.",p),M.push(k.a.Instance.init(f,b,m).then(()=>A.info("BusinessProcessWrapperManager.Instance.init completed.",p))),Object(S.a)(_,e))if(Object(l.m)(_,t)){if(!Object(S.g)(_,O,1,0)&&!(null==v?void 0:v.isPreview))return ie(22e8,m,A,C,_,t)}else{if(!Object(S.g)(_,O,2,0))return ie(2147746342,m,A,C,_,t)}const G=Object(i.j)(_,e),X=Ce(_,G,e),$=be(_,O,G),ee=function(e,t,n,a){const r={};if(t&&t.RelatedEntityAttributes&&a)for(const i in t.RelatedEntityAttributes){const o=Object(y.x)(e,a,i);if(o&&o.ReferencedEntity){const a={},s=fe(e,o.ReferencedEntity,t.RelatedEntityAttributes[i]),c=Object(w.m)(n,i);r[Object(w.v)(c)]={attributes:s,submitModes:a}}}return r}(_,G,n,O),te=Object(W.a)(_),ne=Object(h.s)(_);ve(_,m,e,X,$,t,n,ee,ne),T&&!te&&m(Object(z.g)(t,T)),A.info("Update quick view forms started.",p);for(const a in G.InlineQuickForms){const r=G.InlineQuickForms[a];for(const o in r){const s=r[o],c=Object(i.j)(_,s),l=Ce(_,c,s),u=be(_,o,c),d=Object(w.l)(n,a,o);ve(_,m,e,l,u,t,d,null,ne)}}if(A.info("Update quick view forms completed.",p),I&&0!==Object.keys(I).length){const{createFromEntity:a,createFromRelationship:i}=v,{initWithEntity:c}=v;let h=a;!h&&c&&(h=c),L=function(e,t,n,a,i,c,h,p,m,b,f){n&&n.info("initializeFormWithDefaultValue started.",a);const C=Object(d.d)(e,c);let _=null;const v={},S=Object(l.m)(e,i),O=r.a.toString(p);let I,j;const P=[];O&&(_=Object(d.k)(e,O));for(const o of Object.keys(h)){if("processid"===o)continue;let l=C[o];if(!l&&_&&(l=_[o]),l&&!l.AttributeOf){const s=l.Type;switch(s){case"customer":case"owner":case"lookup":case"regarding":if("string"==typeof h[o]){const u=ce(h,o,l);if(!u){ue(n,o);continue}if(v[o]=u,!r.a.equals(r.a.EMPTY,u.id)&&"owner"!==s&&S&&(b||f))if(j){const e=j.then(()=>t(Object(H.b)(i,p)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (1).",a)}));P.push(e)}else j=me(e,t,u,c,i,n,a,b,f),P.push(j)}else{let e;e=Array.isArray(h[o])?h[o][0]:h[o],e&&e.id&&r.a.tryParseOrNull(e.id)&&e.entityType&&(v[o]=new u.a(e.entityType,new r.a(e.id),e.name))}break;case"partylist":const d=h[o];let g=d;const m=[];try{"string"==typeof d&&(g=JSON.parse(d));for(const e of g)m.push(new u.a(e.entityType,new r.a(e.id),e.name))}catch(e){ue(n,o,"partylist")}v[o]=m;break;case"boolean":case"picklist":case"status":v[o]=h[o];break;case"uniqueidentifier":v[o]=new r.a(h[o]);break;default:v[o]=h[o]}}else if(-1!==o.indexOf(Q.d)||"_CreateFromId"===o){let r=null;if(-1!==o.indexOf(Q.d)&&(r=ce(h,Q.d,l)),!r&&"_CreateFromId"===o){const t=Object(y.m)(e,h._CreateFromType),n=Object(y.h)(e,t);n&&(r=le(t,h._CreateFromId,n.DisplayName))}if(!r){ue(n,Q.d);continue}if(!I&&(I=r,S))if(j){const e=j.then(()=>t(Object(H.b)(i,p)).then(()=>{n&&n.info("updateSnapshotWithOptions completed (2).",a)}));P.push(e)}else j=me(e,t,I,c,i,n,a,b,f),P.push(j);if(Object(y.h)(e,c).IsActivity&&-1===Object.keys(v).indexOf(N.t)&&Object(y.z)(e,c,I.etn,N.t)){const t=Object(s.ab)(e,i,m);t&&t[N.t]&&(v[N.t]=r)}}else{ue(n,o);if(Object(K.c)(e,Y.Rc))return Promise.reject(Object(V.b)(e,i,2200000009))}}const x=Object(K.c)(e,Y.L);let E=v;x&&(E=function(e,t,n,a,r){const i={},o=Object(w.w)(a),c=Object(s.P)(e,o,t,n);for(const o in r){if(!c||!c.hasOwnProperty(o)){i[o]=r[o];continue}const s=Object(d.a)(e,t,o);if(!(s&&s.ParentPicklistLogicalName)&&!Object(U.a)(e,a,n,t,c,o,{name:o,value:0})){i[o]=r[o];let c=[];for(s&&s.ChildPicklistLogicalNames&&(c=c.concat(s.ChildPicklistLogicalNames));c&&c.length>0;){const o=c.pop();if(r.hasOwnProperty(o)){const s=Object(d.a)(e,t,o),l=JSON.parse(r[s.ParentPicklistLogicalName]),u=JSON.parse(r[o]);Object(q.a)(e,n,a,s,t,l,u)&&(i[o]=r[o],s.ChildPicklistLogicalNames&&s.ChildPicklistLogicalNames.length>0&&(c=c.concat(s.ChildPicklistLogicalNames)))}}}}return i}(e,c,i,m,v));const T=pe(E);if(P.length>0)return Promise.all(P).catch(e=>{if(2147749377===e.errorCode||-2147093999===e.errorCode)return Promise.resolve(null);Object(o.b)(e)}).then(()=>(t(Object(g.a)(i,T,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length > 0.",a),Promise.resolve(null)));return t(Object(g.a)(i,T,!0,!0)),n&&n.info("initializeFormWithDefaultValue completed at snapshotPromiseList.length == 0.",a),Promise.resolve(null)}(b(),m,A,p,t,O,I,e,n,h,i)}if(G&&G.Controls&&G.Controls.notescontrol){const e=Object(l.g)(_,t);A.info("loadTimelineConfigAndMetaData started.",p),m(Object(E.b)(G.Controls.notescontrol,e,a)).then(()=>{A.info("loadTimelineConfigAndMetaData completed.",p)})}if(G&&G.Controls)for(const e in G.Controls)if(G.Controls[e]){if(G.Controls[e].Id&&G.Controls[e].Id.startsWith("WebResource"))for(const t of G.Controls[e].Parameters)if("Url"===t.Name){let e=!1;if(c)for(const n of c){const a=t.Value&&t.Value.toLowerCase()||"";if(a.length>=n.length&&a.length-n.length===a.lastIndexOf(n)){e=!0;break}}if(!e){const e=Object(F.j)(_,t.Value);e&&!e.Name&&(A.info("retrieveWebResourceDescriptorByName started.",p),m(Object(B.c)(t.Value)).then(()=>{A.info("retrieveWebResourceDescriptorByName completed.",p)}))}}r.a.equals(G.Controls[e].ClassId,D.rb)&&_&&void 0===_.currentServerTime.serverTimeDiffInSeconds&&(A.info("retrieveServerTime started.",p),m(Object(R.b)(new u.a(O))).then(()=>{A.info("retrieveServerTime completed.",p)}))}return null!=L?L:(A.info("initializeForm completed.",p),Promise.all(M))},getFailureParameters:(e,t)=>p}}function re(e,t,n,r,i,o,s){const c=t(Object(m.f)(o,!1,[])).then(()=>{const n=Object(y.h)(e(),o);if(n.IsChildEntity){const a=Object(S.d)(e(),n);return t(Object(m.f)(a.EntityLogicalName,!1,[]))}}),u=()=>{const i=e();if(!Object(S.b)(i,o))return ie(2200000001,t,n,r,i,s);const c=Object(S.c)(i,o),u=Object(a.d)(i);return c&&Object(l.m)(i,s)&&!u?ie(2200000002,t,n,r,i,s):void 0};return c?c.then(u):Promise.resolve(u())}function ie(e,t,n,a,r,i){const o=Object(V.d)(e);return t(Object(T.e)(o)).then(()=>{const t=Object(V.c)(e);if(n){const e=[{name:"CorrelationId",value:a.correlationId},{name:"ContextId",value:a.contextId},{name:"ActionStack",value:a.stack}];n.debug(t,e)}const s=Object(G.e)(r,o),c=Object(G.c)(s,o[0]),l=Object(G.c)(s,o[1]);throw Object(V.b)(r,i,e,t,c,l)})}function oe(e,t,n,a,r,i,o,c,p){p.push({name:"AutoPopulateFieldsTimeStamp",value:Date.now()}),c&&c.info("autoPopulateFields started.",p);const m=Object(d.d)(e,n);if(!m)return void(c&&c.warn("attributes is null.",p));const b=e=>e&&e.OptionSet&&Object.keys(e.OptionSet).length>0,{id:f}=Object(l.g)(e,a),y=new u.a(n,f),C={},_=Object(s.ac)(e,a,o);for(const t of r.concat(i)){const n=m[t];if(n&&(r.indexOf(t)>=0&&i.indexOf(t)>=0||b(n))){if(!Object(s.X)(e,a,o,_,y,n.LogicalName)){switch(t){case N.q:const n=Object(h.q)(e),a=Object(h.t)(e);if(n&&a){const e=new u.a(A.a,n,a);C[t]=e}break;case N.w:if(!Object(M.d)(e,_,null,N.w)){const n=Object(h.b)(e);if(n){const e=new u.a(A.b,n.transactionCurrencyId,n.currencyName);C[t]=e}}}if(b(n)){const a=Object(M.d)(e,_,new u.a(n.EntityLogicalName),t),i=a?parseInt(a.valueString,10):null!=n.DefaultValue?n.DefaultValue:t===N.u?0:void 0;if(void 0===i||i<0||(C[t]=i),t===N.u&&-1!==r.indexOf(N.v)){const e=m[t];if(e&&e.OptionSet&&Object.keys(e.OptionSet).length>0){const e=n.OptionSet.find(e=>e.Value===i),t=e?e.DefaultStatus:m[N.v].DefaultValue||0;t<0||(C[N.v]=t)}}}}}}const v=pe(C);t(Object(g.a)(a,v,!0,!0)),c.info("autoPopulateFields completed.",p)}function se(e,t,n,a,i,o,s){const{id:c}=Object(l.g)(e,a),d=new u.a(n,c),h={};if(r.a.isNullOrEmpty(d.id)&&!s)return function(e,t,n,a,i){const o=Object(C.d)(e,n);if(null!=o)return Promise.resolve(o);return t(Object(L.a)(r.a.EMPTY,new u.a(n,r.a.EMPTY))).then(e=>e&&e.businessProcessFlows?Promise.resolve(r.a.tryParse(Object.keys(e.businessProcessFlows)[0])):Promise.resolve(null)).catch(e=>{const t=[{name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"entityName",value:n},{name:"reason",value:e&&e.message?e.message:JSON.stringify(e)}];return a.EventManager.ReportComponentFailure("Forms.InitializeForm",Error("Catch block of InitializeForm.retrieveBusinessProcessFlow"),void 0,t),a.TraceManager.getTracer("Forms.InitializeForm").error("Error while executing getBusinessProcessFlowDefaultIdForEntity in the retrieveBusinessProcessFlow promise.",t),Promise.resolve(null)})}(e,t,n,i,o).then(e=>{e&&(h.processid=e.guid);const n=pe(h);return t(Object(g.a)(a,n,!0,!0)),Promise.resolve()});s&&(h.processid=s);const p=pe(h);return t(Object(g.a)(a,p,!0,!0)),Promise.resolve()}function ce(e,t,n){let a=t;!t.match(/id$/i)&&t.indexOf(Q.d)>-1&&(a+="id");const i=e[a];if(null!=i){if(r.a.validate(i)){const a=i,r=e[t+"name"];let o=e[t+"type"]||e[t+"target"];return!o&&n.Targets&&n.Targets.length>0&&(o=n.Targets[0]),le(o,a,r)}try{const e=JSON.parse(i);if(e)return le(e.entityType,e.id,e.name)}catch(e){}}return null}function le(e,t,n){if(e&&t&&r.a.validate(t)){const a=new r.a(t);if(!r.a.isNullOrEmpty(a))return new u.a(e,a,n)}return null}function ue(e,t,n){if(e){const a=[{name:"key",value:t},{name:"source",value:n}];e.warn("Value passed is not in correct syntax.",a)}}function de(e,t,n,a,r,i,o,s){return he(e,t,n,a,i,o,s).then(()=>ge(e,t,n,r,i,o,s))}function he(e,t,n,a,r,i,o){if(!Object(s.Eb)(e,r)&&Object($.n)(e,r))return i&&i.warn("pageId"+r+" is dead so rejecting loadScripts"),Promise.reject(Object(V.b)(e,r,2200000008,"Page has expired."));i&&i.info("loadScripts started.",o);return n(t.ScriptManager.getContainer(r).getEventManager().loadScripts(a,r)).then(()=>{i&&i.info("loadScripts completed",o)})}function ge(e,t,n,a,r,i,o){if(!Object(s.Eb)(e,r)&&Object($.n)(e,r))return void(i&&i.warn("pageId "+r+" is dead so won't run runFormOnLoadScripts",o));i&&i.info("runFormOnLoadScripts started.",o);const c=t.ScriptManager.getContainer(r).getEventManager();n(c.addPblEvent(a)),n(c.runOnLoad(a,1)),n(c.runOnDataLoad(a,1)),i&&i.info("runFormOnLoadScripts completed.",o)}function pe(e){const t={};for(const n in e){const a={fieldName:n,value:e[n]};t[n]=a}return t}function me(e,t,n,a,r,i,s,c,l){const d=Object(w.j)(e,r),h=Object(w.x)(d);return i&&i.info("createAndSetDataSnapshotFrom started.",s),t(function(e,t,n,a,r){return{type:"snapshot.from.async",execute({dispatch:i,getState:s},c){const l=c.DataSource,d=u.a.toLegacyEntityReference(e),h=new _.a(d,t,v.a.All),g=l.execute(h,null).nativePromise();let S=null,O=null,I=null;return g.then(e=>{const n=e.get_entity();return S=Object(p.a)(n),O=S.fields,I=S.identifier,i(Object(m.f)(t,!1,Object.keys(S.fields)))},e=>{const n=Object(o.c)(e);if(e&&e.get_ErrorCode&&(-2147093999===e.get_ErrorCode()||n&&-2147217919===n.getNegativeErrorCode())&&a){const e=[];if(O={},a.etn){const n=Object(y.c)(s(),a.etn,t);if(n)for(const t of n)t.ReferencingAttribute&&e.push(t.ReferencingAttribute)}else r&&e.push(r.attributeName);for(const t of e){if(!a.name&&a.id){const e=Object(C.h)(s(),a.etn,a.id.guid);if(e&&e.fields){const t=Object(y.E)(s(),a.etn);let n=e.fields[t];n&&n.value||(n=e.fields.name),n&&n.value&&(a={etn:a.etn,id:a.id,name:n.value})}}O[t]={reference:a,timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}}return I=new u.a(t),i(Object(m.f)(t,!1,e))}Object(o.b)(e)}).then(()=>{const e=Object(b.b)(s(),I,O,n,f.a.Create),t=e.payload.snapshotId;return i(e),t})}}}(n,a,h,c,l)).then(e=>{i&&(s.push({name:"newSnapshotId",value:e?e.toString():"<null>"}),i.info("initializeCreateDataSnapshotFrom completed.",s)),t(Object(O.b)(r,e,d)).then(()=>{i&&i.info("createAndSetDataSnapshotFrom completed.",s)})})}function be(e,t,n){let a={};if(n&&n.Attributes&&t){const r=Object(F.d)(e,n.FormLibraries,[t]);if(n.Attributes||r){const i=[].concat(n.Attributes,r);-1===i.indexOf(N.u)&&i.push(N.u),a=fe(e,t,i)}}return{attributes:a,submitModes:{}}}function fe(e,t,n){const a={};if(n&&t)for(let r=0;r<n.length;r++){const i=n[r];if(i){const n=Object(s.L)(e,t,i);n&&(a[i]=n)}}return a}function ye(e){return Array.isArray(e)?e:e.Controls?e.Controls:null}function Ce(e,t,n){const a={},r={},i={},o={bodyVisible:!0,commandBarVisible:!0,tabNavigatorVisible:!0},l={visible:!0};let u={navBarAreas:{},navPaneIsvItems:{},navBarByRelationshipItems:{},navBarItems:{}};if(t&&t.Tabs&&t.TabNames){const n=Object(s.m)(e,t);let o=!1;for(const s of n){const n={collapsed:!!o||!(s.Expanded&&s.Visible),visible:s.Visible,label:s.Label,sectionNames:[],domId:s.DomId,showLabel:s.ShowLabel,contentType:null};switch(s.ContentType){case"expandAvailableSpace":case"singleComponent":n.contentType="singleComponent";break;default:n.contentType="cardSections"}o=o||s.Expanded&&s.Visible;const l=[];if(s.Columns)for(let n=0;n<s.Columns.length;n++){const a=s.Columns[n];if(a.SectionNames)for(let n=0;n<a.SectionNames.length;n++){const o=a.SectionNames[n];if(t.Sections[o]){const n=t.Sections[o];l.push(o);const a=[];for(const e of t.Sections[o].Rows)for(const t of e.Cells)t.ControlName&&a.push(t.ControlName);const u={parentTabId:s.Id,visible:n.Visible,label:n.Label,controlNames:a,domId:n.DomId,semanticZoomDomId:n.SemanticZoomDomId};r[o]=u;for(let n=0;n<a.length;n++){const r=a[n];if(t.Controls[r]){const n=t.Controls[r],a=_e(n,o,!0),s=Object(c.a)(n,t,Object(X.b)(e));null!=s&&(a.visible=a.visible||s.ShouldOverrideControlVisible),Se(a),i[r]=a}}}}}if(s.Header)for(const e of s.Header)i[e.Name]=_e(e,null,!0);if(s.Footer)for(const e of s.Footer)i[e.Name]=_e(e,null,!0);n.sectionNames=l,a[s.Id]=n}}if(t&&t.Navigation&&(u=t.Navigation),t&&t.Header){const e=ye(t.Header);if(e)for(const t of e)i[t.Name]=_e(t,null,!0),Se(i[t.Name]);o.bodyVisible=!1!==t.Header.BodyVisible,o.commandBarVisible=!1!==t.Header.CommandBarVisible,o.tabNavigatorVisible=!1!==t.Header.TabNavigatorVisible}if(t&&t.Footer){const e=ye(t.Footer);if(e)for(const t of e)i[t.Name]=_e(t,null,!0),Se(i[t.Name]);l.visible=!1!==t.Footer.Visible}return{formId:n,tabs:a,sections:r,controls:i,selectedTab:Object(I.a)(),selectedRelatedEntity:null,isSaving:!1,invalidControls:{},invalidAttributes:{},controlUnboundOutputs:{},inlineQuickForms:t&&t.InlineQuickForms?t.InlineQuickForms:null,xrmReady:!1,label:"",navigation:u,viewportWidth:0,viewportHeight:0,showHeaderFieldsInSection:!1,headerFieldsInFlyout:new Set,isAutoSaving:!1,header:o,footer:l}}function _e(e,t,n){return e?{parentSectionName:t,visible:e.Visible,label:e.Label,valid:n,labelSource:e.LabelSource,domId:e.DomId,parameters:e.Parameters,dataFieldName:e.DataFieldName,relationship:e.Relationship}:null}function ve(e,t,n,a,i,o,c,l=null,u){const d=Object(s.cb)(e,o,c),h=Object(ee.a)(e,o);r.a.equals(null==d?void 0:d.formId,null==a?void 0:a.formId)&&r.a.equals(n,null==h?void 0:h.formId)||t(function(e,t,n,a,r,i=null,o){return{type:te,payload:{formId:e,formUIState:t,formMetadataState:n,relatedEntityMetadataState:i,currentLanguageId:o},meta:{pageId:a,contextToken:r}}}(n,a,i,o,c,l,u))}function Se(e){e&&e.parameters&&e.parameters.DefaultViewId&&(e.parameters.defaultviewid=e.parameters.DefaultViewId)}},PbI6:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="tab.contentType";function i(e,t,n,i){const o=Object(a.v)(n);return{type:r,payload:i,meta:{pageId:e,tabId:t,contextKey:o}}}},Pr02:function(e,t,n){"use strict";n.d(t,"q",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"p",(function(){return b})),n.d(t,"l",(function(){return f})),n.d(t,"c",(function(){return y})),n.d(t,"m",(function(){return C})),n.d(t,"a",(function(){return _}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Settings_Server_Version",r="Settings_App_Version",i="Settings_Client_Version",o="Settings_Server_Version_Format",s="Settings_Org_Name",c="Settings_Brand_Title",l="Brand_PowerApps",u="Settings_Client_Session_Id",d="Settings_Host_Session_Id",h="Settings_Host_Context_Id",g="Settings_Host_Version",p="Settings_ExternalCorrelation_Id",m="Settings_Current_Time",b="Settings_Preview_Notification",f="Settings_Oct2019_Preview_Notification",y="Settings_Apr2020_Preview_Notification",C="Settings_Oct2020_Preview_Notification",_=[a,r,i,"Settings_Privacy_Statement","Settings_License_Terms",o,s,c,l,"Settings_Privacy_Statement_Link","Settings_Privacy_Statement_Link_Online",u,d,h,g,p,m,b,f,y,C]},QP40:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Settings_Signout",r="Settings_Reconfigure",i=["Web.NavBar.UserInfoEditImage_Caption",a,r]},QSjj:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="offline.disabled.entities.update";function r(e,t,n){return{type:a,payload:{offlineDisabledEntities:e,lastMetadataVersionUsedForValidation:t,offlineDisabledPrimaryEntities:n}}}},QfU7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));function a(e,t=10){return e.recentItems&&e.recentItems.recentItems.sort((e,t)=>t.LastAccessed-e.LastAccessed).slice(0,t)}},TAjd:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(t,"a",(function(){return a})),function(e){e.collapsed="collapsed",e.expanded="expanded",e.floating="floating",e.getDefaultDisplayState=function(){return e.collapsed}}(a||(a={}))},TQn4:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return h}));var a=n("3/02"),r=n("Lyxw"),i=n("0kGT"),o=n("GYEz"),s=n("w1eR"),c=n("y60j"),l=n("455M"),u=n("BFlg");function d(e,t){return Object(r.c)(e,a.Md)&&Object(i.a)(e)&&0===t&&Object(o.a)(e)===s.a.MobileApplication}function h(e,t,n,a){var r;const i=Object(c.b)(e,t,n,a),o=null===(r=null==i?void 0:i.ClassId)||void 0===r?void 0:r.guid;return o&&l.a.ClassIdControlMap[o.toLowerCase()]===u.t}},Tg1Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="form.tab.selectPrevious";function i(e,t){const n=Object(a.v)(t);return{type:r,payload:null,meta:{pageId:e,contextKey:n}}}},TsER:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="refresh.timer";function i(e,t,n){const i=Object(a.x)(t);return{type:r,payload:null,meta:{pageId:e,contextKey:i,controlName:n}}}},UqyN:function(e,t,n){"use strict";n.d(t,"a",(function(){return ke})),n.d(t,"b",(function(){return Me}));var a=n("0nOn"),r=n("SAYH"),i=n("WPtp"),o=n("odYE"),s=n("ZIjf"),c=n("LbMF"),l=n("UJfx"),u=n("bT7G"),d=n("mlKL"),h=n("LLfG"),g=n("i1f0"),p=n("BvQu"),m=n("Sbn7"),b=n("mIxf"),f=n("1kth"),y=n("16wZ"),C=n("qshH"),_=n("dHD5"),v=n("iZ7K"),S=n("3tOH"),O=n("z5LE"),I=n("3HPu"),j=n("jTSi"),P=n("jq7Z"),x=n("fU7K"),E=n("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w="ClientApi.XrmEntityAttribute.";let T;class A{constructor(e,t,n,r,i,o){T=e,this._clientApiExecutorAttribute=new a.a(e,w,n,t),this._clientApiExecutorAttribute.addEventParameter({name:"attributeName",value:r,isEventParam:!0});const s=this._clientApiExecutorAttribute.getComponentName("constructor");r||Object(y.j)(s,"attributeName"),e||Object(y.j)(s,"store"),n||Object(y.j)(s,"pageId"),t||Object(y.j)(s,"contextToken"),o||Object(y.j)(s,"xrmFormUi"),this._attributeName=r,this._parentEntity=i,this._pageId=n,this.xrmFormUi=o,this._contextToken=t}get controls(){return this._clientApiExecutorAttribute.execute("controls",(e,t)=>{if(!this._controls){this._controls=new m.a(e);const t=Object(g.z)(T.getState(),this._pageId,this.contextToken,this._attributeName);if(t){this.xrmFormUi.getControls();const e=this.xrmFormUi.controls;for(let n=0;n<t.length;n++){const a=t[n],r=e.get(a);r&&this._controls.add(a,r)}}}return this._controls})}addOnChange(e){const t=w+"addOnChange";e||Object(y.j)(t,"handler");try{s.a.instance.reportCall(t),T.dispatch(Object(f.a)(this.contextToken,this._pageId,this.getName(),e)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(t,e,null,n),e}}fireOnChange(){const e=w+"fireOnChange";try{s.a.instance.reportCall(e),T.dispatch(Object(f.P)(this.contextToken,this._pageId,this.getName())),s.a.instance.reportSuccess(e)}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){const e=w+"getAttributeType";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().Type;return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getFormat(){return this._clientApiExecutorAttribute.execute("getFormat",()=>{const e=this.getAttrDescriptor();if(!e||!e.Format)return null;const t=e.Format.toLowerCase();let n=t;switch(this.getAttrDescriptor().Type){case"string":"text"===n||"email"===n||"phone"===n||"url"===n||"tickersymbol"===n||"1"!==t&&"2"!==t||(n="textarea");break;case"integer":"duration"!==n&&(n="none");break;case"lookup":"0"===t&&(n="none");break;case"memo":"2"!==t&&"1"!==t||(n="textarea");break;default:"0"===t?n="none":void 0===n&&(n=null)}return n})}getIsDirty(){const e=w+"getIsDirty";try{s.a.instance.reportCall(e);const t=Object(g.Jb)(T.getState(),this.getPageId(),this.dataContextToken,this.getName())&&Object(u.e)(T.getState(),Object(g.ac)(T.getState(),this.getPageId(),this.dataContextToken),this.getName());return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getName(){return s.a.instance.reportUsage(w+"getName"),this._attributeName}getParent(){return s.a.instance.reportUsage(w+"getParent"),this._parentEntity}getRequiredLevel(){const e=w+"getRequiredLevel";try{s.a.instance.reportCall(e);const t=Object(g.pc)(T.getState(),this._pageId,this.dataContextToken,this.getName());let n;switch(t){case 2:case 1:n="required";break;case-1:case 0:n="none";break;case 3:n="recommended";break;default:Object(y.h)(e,"RequiredLevel",t)}return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getSubmitMode(){const e=w+"getSubmitMode";try{s.a.instance.reportCall(e);const t=Object(g.zc)(T.getState(),this._pageId,this.contextToken,this.getName());let n;switch(t){case p.a.Dirty:n="dirty";break;case p.a.Always:n="always";break;case p.a.Never:n="never";break;default:Object(y.h)(e,"SubmitMode",t)}return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getUserPrivilege(){const e=w+"getUserPrivilege";try{s.a.instance.reportCall(e);let t=null;if(T.getState()&&this._parentEntity&&this._attributeName){const e=Object(l.a)(T.getState(),this._parentEntity.getEntityName(),r.a.fromExternalGuid(this._parentEntity.getId()),this._attributeName);e&&(t={canCreate:e.canCreate,canRead:e.canRead,canUpdate:e.canUpdate})}return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e=w+"getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;return Object(y.a)(t)||(Object(i.j)(t)?n=t.value:Object(y.k)(e,"isPlainValue","value")),s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}removeOnChange(e){const t=w+"removeOnChange";e||Object(y.j)(t,"handler");try{s.a.instance.reportCall(t),T.dispatch(Object(f.v)(this.contextToken,this._pageId,this.getName(),e)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(t,e,null,n),e}}setRequiredLevel(e){const t=w+"setRequiredLevel";e||Object(y.j)(t,"requiredLevel"),"none"!==e&&"recommended"!==e&&"required"!==e&&Object(y.h)(t,"RequiredLevel",e);try{let n;switch(s.a.instance.reportCall(t),e){case"none":n=0;break;case"recommended":n=3;break;case"required":n=2}T.dispatch(Object(d.b)(this._pageId,this.dataContextToken,this._attributeName,n)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(t,e,null,n),e}}setSubmitMode(e){const t=w+"setSubmitMode";e||Object(y.j)(t,"mode"),"dirty"!==e&&"always"!==e&&"never"!==e&&Object(y.h)(t,"SubmitMode",e);try{let n;switch(s.a.instance.reportCall(t),e){case"dirty":n=p.a.Dirty;break;case"always":n=p.a.Always;break;case"never":n=p.a.Never}T.dispatch(Object(h.b)(this._pageId,this.contextToken,this.getName(),n)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(t,e,null,n),e}}setValue(e){const t=w+"setValue";try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(t,e,null,n),e}}setIsValid(e,t){return this._clientApiExecutorAttribute.execute("setIsValid",(n,a)=>{e?(T.dispatch(Object(I.b)(this._pageId,this._attributeName,!0,this.contextToken)),T.dispatch(Object(j.b)(this.contextToken,this._pageId,Object(E.d)(this._pageId,this._attributeName))),T.dispatch(Object(O.b)(T.getState(),this._pageId,this._attributeName,null,this.contextToken))):this._addNotification(t)})}_addNotification(e){T.dispatch(Object(I.b)(this._pageId,this._attributeName,!1,this.contextToken));const t={messages:[e],notificationLevel:S.a.error};T.dispatch(Object(O.b)(T.getState(),this._pageId,this._attributeName,t,this.contextToken))}isValid(){const e=w+"isValid";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=this.getParent();if(n){const a=Object(v.h)(T.getState(),n.getEntityName());if(a&&a.PrimaryIdAttribute!==this.getName()&&n.getId()!==r.a.EMPTYSTRING&&"required"===this.getRequiredLevel()&&Object(y.a)(t))return s.a.instance.reportSuccess(e),!1}let a=!0;return this.hasErrorNotification()?a=!1:t&&t.validationResult&&(a=t.validationResult.isValueValid),s.a.instance.reportSuccess(e),a}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"attributeName",value:this._attributeName}),C.a.getInstance().reportFailure(e,t,null,n),t}}hasErrorNotification(){const e=Object(_.v)(this.contextToken),t=T.getState(),n=Object(P.a)(t,this._pageId);if(n.forms&&n.forms[e]&&(n.forms[e].invalidControls||n.forms[e].invalidAttributes)){return!0===n.forms[e].invalidControls[this.getName()]||!0===n.forms[e].invalidAttributes[this.getName()]}return!1}getPageId(){return this._pageId}getAttrDescriptor(){if(this.getParent()){let e=Object(g.r)(T.getState(),this.getParent().getEntityName(),this.getName(),this._pageId,this.contextToken);return e||(e=Object(c.a)(T.getState(),this.getParent().getEntityName(),this.getName())),e}return Object(g.Nc)(T.getState(),this.getPageId(),this.getName())}getDataXmlInternal(){let e="";return e=e+"<"+Object(x.CrmXmlEncode)(this.getName())+">"+Object(x.CrmXmlEncode)(this.getValue())+"</"+Object(x.CrmXmlEncode)(this.getName())+">",e}setValueInternal(e){const t=this.getName(),n={};n[t]={fieldName:t,value:e},T.dispatch(Object(b.a)(this._pageId,n,!1,!0,this.getParent()?this.getParent().getEntityName():null,this.getParent()?this.getParent().getId():null,Object(_.t)(this._contextToken),this.contextToken))}get parentEntityReference(){let e,t;return this.getParent()?(e=this.getParent().getEntityName(),t=this.getParent().getId()):this.contextToken.formId&&(e=this.contextToken.formId.guid),t?new o.a(e,new r.a(t)):new o.a(e)}getValueInternal(){const e=Object(g.ac)(T.getState(),this.getPageId(),this.dataContextToken);return Object(g.X)(T.getState(),this._pageId,this._contextToken,e,this.parentEntityReference,this._attributeName,T.dispatch)}get contextToken(){return Object(_.r)(this._contextToken)}get dataContextToken(){return this._contextToken}}var F=n("5Oca"),N=n("6QGX");class k extends A{getOption(e){const t="ClientApi.XrmEntityAttributeOptionSetBase.getOption";if(Object(y.a)(e))return null;const n="number"==typeof e?e:parseInt(e,10);isNaN(n)&&Object(y.k)(t,"number","value");try{s.a.instance.reportCall(t);const n=this.getAttrDescriptor().OptionSet;let a=null;for(let t=0;t<n.length;t++)n[t].Value===e&&(a={text:n[t].Label,value:n[t].Value});return s.a.instance.reportSuccess(t),a}catch(e){throw C.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e),e}}getOptions(){const e="ClientApi.XrmEntityAttributeOptionSetBase.getOptions";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().OptionSet.map(e=>({text:e.Label,value:e.Value}));return s.a.instance.reportSuccess(e),t}catch(t){throw C.a.getInstance().getEventParameters(this.contextToken).push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let M,D;class R extends k{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),M=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeBoolean.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(M.getState(),this.parentEntityReference,this.getName()),n=t?parseInt(t.valueString,10):null;return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeBoolean.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(N.a)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeBoolean.setValue";Object(y.a)(e)||"boolean"!=typeof e&&Object(y.k)(t,"boolean","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeBoolean.getAttributeType"),"boolean"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends k{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),D=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(D.getState(),this.parentEntityReference,this.getName()),n=Object(N.e)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getSelectedOption";try{s.a.instance.reportCall(e);let t=null;const n=this.getValue();return n&&(t=[],n.forEach(e=>{const n=this.getOption(e);n&&t.push(n)})),s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getText(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getText";try{s.a.instance.reportCall(e);let t=null;const n=this.getSelectedOption();return n&&(t=[],n.forEach(e=>{t.push(e.text)})),s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeMultiSelectOptionSet.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;return t&&(n=Object(N.e)(t)),s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeMultiSelectOptionSet.getAttributeType"),"multiselectoptionset"}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectOptionSet.setValue";try{s.a.instance.reportCall(t),Array.isArray(e)?this.setValueInternal(e):this.setValueInternal([]),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}}var B=n("Xd5/"),V=n("xkcG"),G=n("MXaZ"),z=n("Ae6N");let W;class X extends A{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),W=e}getDataXmlInternal(){let e=this.getValue();null!==e&&(e=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()));const t=Object(x.CrmXmlEncode)(this.getName());let n="";return n+=`<${t}>`,n+=""+(null===e?"":Object(x.CrmXmlEncode)(e.format("s"))),n+=`</${t}>`,n}getValue(){const e="ClientApi.XrmEntityAttributeDateTime.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal();let n=null;if(Object(i.j)(t)&&!Object(y.a)(t.formatted)){const e=this.getAttrDescriptor();n=Object(N.b)(W.getState(),e,t)}return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}_userSettings(){return this.xrmFormUi.formContext.context?this.xrmFormUi.formContext.context.userSettings:new V.a(W)}getUtcValue(){const e="ClientApi.XrmEntityAttributeDateTime.getUtcValue";try{s.a.instance.reportCall(e);const t=this.getValue();return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setValue";Object(y.a)(e)||"[object Date]"!==Object.prototype.toString.call(e)&&Object(y.k)(t,"Date","value");try{if(s.a.instance.reportCall(t),Object(y.a)(e))this.setValueInternal(e);else if("[object Date]"===Object.prototype.toString.call(e)){const t=new Date,n=this.getAttrDescriptor(),a=Object(B.z)(W.getState(),n),r=6e4*this._userSettings().getTimeZoneOffsetMinutes(),i=Object(G.o)(new Date(t.getFullYear(),t.getMonth(),t.getDate()),a.userSettings.timeZoneAdjusters)-Object(G.o)(e,a.userSettings.timeZoneAdjusters),o=6e4*e.getTimezoneOffset();let s=null;switch(a.controlAttributes.Behavior){case z.a.UserLocal:s=new Date(e.getTime()+o+r-i);break;default:s=new Date(e.getTime())}this.setValueInternal(s)}s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}setUtcValue(e){const t="ClientApi.XrmEntityAttributeDateTime.setUtcValue";try{s.a.instance.reportCall(t),this.setValue(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeDateTime.getAttributeType"),"datetime"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let H;class U extends A{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),H=e}getIsPartyList(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getIsPartyList"),!1}getDataXmlInternal(){const e=this.getValue();let t="";if(null!==e&&e.length>0)t+=this.getLookupDataXml(this.getName(),e[0]);else{const e=Object(x.CrmXmlEncode)(this.getName());t+=`<${e}>`,t+=`</${e}>`}return t.toString()}getLookupDataXml(e,t){const n=Object(x.CrmXmlEncode)(e);let a="<"+n;const r=this.getEntityTypeCode(t.entityType);return r>0&&(a+=` type="${Object(x.CrmXmlAttributeEncode)(r.toString())}"`),t.entityType&&(a+=` typeName="${Object(x.CrmXmlAttributeEncode)(t.entityType)}"`),Object(y.a)(t.name)||(a+=` name="${Object(x.CrmXmlAttributeEncode)(t.name)}"`),a+=`>${Object(x.CrmXmlEncode)(t.id)}</${n}>`,a}getEntityTypeCode(e){return Object(v.p)(H.getState(),e)}setValue(e){const t="ClientApi.XrmEntityAttributeLookup.setValue";let n=null;if(e&&Array.isArray(e)&&e.length>0){let a;e.length>1?Object(y.k)(t,"LookupValue[] of size not more than one.","value"):e[0].entityType?e[0].id?r.a.tryParseOrNull(e[0].id)||Object(y.h)(t,"guid",e[0].id):Object(y.j)(t,"value[0].id"):Object(y.j)(t,"value[0].entityType");try{a=Object(g.Ob)(H.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t+".getLookupTargets",e,null,n),e}if(a&&!(a.indexOf(e[0].entityType)>-1)){const n=C.a.getInstance().getEventParameters(this.contextToken);n.push({name:"attributeName",value:this.getName()}),n.push({name:"actualValue",value:e[0].entityType}),Object(y.k)(t,"entityType","value[0].entityType",n)}try{s.a.instance.reportCall(t),a?a.indexOf(e[0].entityType)>-1&&(n=new o.a(e[0].entityType,new r.a(e[0].id),e[0].name),this.setValueInternal(n)):this.setValueInternal(n),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}else this.setValueInternal(n)}getValue(){const e="ClientApi.XrmEntityAttributeLookup.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(N.d)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeLookup.getAttributeType"),"lookup"}}var q=n("3c9R"),Y=n("IaGr");let K;class Q extends A{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),K=e,this._clientApiExecutorAttributeNumber=new a.a(e,"ClientApi.XrmEntityAttributeNumber.",n,t,[{name:"attributeName",value:r,isEventParam:!0}])}getMax(){return this._clientApiExecutorAttributeNumber.execute("getMax",()=>this.getAttrDescriptor().MaxValue)}getMin(){return this._clientApiExecutorAttributeNumber.execute("getMin",()=>this.getAttrDescriptor().MinValue)}getPrecision(){return this._clientApiExecutorAttributeNumber.execute("getPrecision",()=>Object(g.k)(K.getState(),this.getPageId(),this.dataContextToken,this.getName()))}setPrecision(e){return this._clientApiExecutorAttributeNumber.execute("setPrecision",(t,n)=>{"integer"===this.getAttributeType()&&Object(y.e)(t,"setPrecision is not valid on integer attributes",void 0,n);const a=Object(c.a)(K.getState(),this.getParent().getEntityName(),this.getName());(e<0||e>a.Precision)&&(n.push({name:"metadataPrecision",value:a.Precision}),Object(y.h)(t,"precision",e.toString(),n)),K.dispatch(Object(q.b)(this.getPageId(),this.dataContextToken,this.getName(),e))},[{name:"precision",value:e,isRequired:!0,expectedDataType:"number"}])}getValue(){return this._clientApiExecutorAttributeNumber.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.f)(e,this.getAttributeType(),this.getPrecision())})}setValue(e){return this._clientApiExecutorAttributeNumber.execute("setValue",()=>{this.setValueInternal(e)},[{name:"value",value:e,expectedDataType:"number"}])}getAttributeType(){return this._clientApiExecutorAttributeNumber.execute("getAttributeType",(e,t)=>{const n=this.getAttrDescriptor().Type;switch(n){case"decimal":return"decimal";case"double":return"double";case"integer":return"integer";case"money":return"money";default:return t.push({name:"attributeType",value:n}),n?this._clientApiExecutorAttributeNumber.reportFailure(e,new Error("Unexpected number attribute type."),t):Y.a.getInstance().traceManager.getTracer(e).error("Number attribute type was not defined in metadata.",t),super.getAttributeType()}})}}var Z=n("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let J;class $ extends k{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),J=e}getInitialValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getInitialValue";try{s.a.instance.reportCall(e);const t=Object(F.j)(J.getState(),this.parentEntityReference,this.getName());let n;if(Object(Z.m)(J.getState(),this.getPageId())){const e=this.getAttrDescriptor();n=Object(N.g)(t)||e&&e.DefaultFormValue?e.DefaultFormValue:null}else n=Object(N.g)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getSelectedOption(){const e="ClientApi.XrmEntityAttributeOptionSet.getSelectedOption";try{s.a.instance.reportCall(e);const t=this.getOption(this.getValue());return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getText(){const e="ClientApi.XrmEntityAttributeOptionSet.getText";try{s.a.instance.reportCall(e);const t=this.getSelectedOption();let n=null;return t&&(n=t.text),s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeOptionSet.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(N.g)(t),a=Object(y.a)(n)?Object(N.f)(t,this.getAttributeType(),0):n;return s.a.instance.reportSuccess(e),a}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeOptionSet.setValue";e&&isNaN(e)&&Object(y.k)(t,"number","value");let n=!1;try{if(e&&this.getParent()){const t=this.getAttrDescriptor();for(const a in t.OptionSet)if(e===t.OptionSet[a].Value){n=!0;break}}else n=!0}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t+".getAttributeDescriptor",e,null,n),e}n||Object(y.h)(t,"OptionSetValue",e);try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeOptionSet.getAttributeType"),"optionset"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ee extends A{getMaxLength(){const e="ClientApi.XrmEntityAttributeString.getMaxLength";try{s.a.instance.reportCall(e);const t=this.getAttrDescriptor().MaxLength;return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getValue(){const e="ClientApi.XrmEntityAttributeString.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(N.i)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeString.setValue";Object(y.a)(e)||"string"!=typeof e&&Object(y.k)(t,"string","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){const e="ClientApi.XrmEntityAttributeString.getAttributeType";try{let t;s.a.instance.reportCall(e);const n=this.getAttrDescriptor().Type;switch(n){case"memo":t="memo";break;case"string":t="string";break;default:const a=C.a.getInstance().getEventParameters(this.contextToken);a.push({name:"attributeName",value:this.getName()}),a.push({name:"attributeType",value:n}),C.a.getInstance().reportFailure(e,new Error("Unexpected string attribute type."),null,a),t=super.getAttributeType()}return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class te extends A{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this._clientApiExecutor=new a.a(e,"ClientApi.XrmEntityAttributeUniqueIdentifier.",n,t),this._clientApiExecutor.addEventParameter({name:"attributeName",value:r,isEventParam:!0})}setValue(e){this._clientApiExecutor.execute("setValue",()=>{this.setValueInternal(r.a.tryParseOrNull(e))},[{name:"value",value:e,expectedDataType:"guid"}])}getValue(){return this._clientApiExecutor.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.j)(e)})}getAttributeType(){return this._clientApiExecutor.execute("getAttributeType",()=>"string")}}var ne=n("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let ae;class re extends U{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),ae=e}getDataXmlInternal(){const e=Object(x.CrmXmlEncode)(this.getName()),t=this.getValue();let n="";return n+=`<${e}>`,t.forEach(e=>{n+="<activityparty>",n+=this.getLookupDataXml("partyid",e),n+="</activityparty>"}),n+=`</${e}>`,n.toString()}setValue(e){const t="ClientApi.XrmEntityAttributePartyList.setValue",n=C.a.getInstance().getEventParameters(this.contextToken);let a;n.push({name:"attributeName",value:this.getName()}),e&&(Array.isArray(e)||Object(y.k)(t,"LookupValue[]","value",n));const r=new Array;try{a=Object(g.Ob)(ae.getState(),this.getPageId(),this.dataContextToken,this.getName())}catch(e){throw C.a.getInstance().reportFailure(t+".getLookupTargets",e,null,n),e}e&&a&&(a.push("unresolvedaddress"),e.forEach(e=>{a.indexOf(e.entityType)>-1||(n.push({name:"entityType",value:e.entityType}),Object(y.e)(t,`LookupValue[] with invalid entity type. Entity type "${e.entityType}" is invalid.`,"LookupValue[] with invalid entity type",n))}));try{s.a.instance.reportCall(t),e?(a?e.forEach(e=>{a.indexOf(e.entityType)>-1&&r.push(new ne.a(e.entityType,e.id,e.name))}):e.forEach(e=>{r.push(new ne.a(e.entityType,e.id,e.name))}),this.setValueInternal(r)):this.setValueInternal([]),s.a.instance.reportSuccess(t)}catch(e){throw C.a.getInstance().reportFailure(t,e,null,n),e}}getValue(){const e="ClientApi.XrmEntityAttributePartyList.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(N.h)(t);return s.a.instance.reportSuccess(e),n}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getIsPartyList(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributePartyList.getIsPartyList"),!0}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ie extends A{constructor(e,t,n,r,i,o){super(e,t,n,r,i,o),this._clientApiExecutorAttributeFile=new a.a(e,"ClientApi.XrmEntityFile.",n,t,[{name:"attributeName",value:r,isEventParam:!0}])}getValue(){return this._clientApiExecutorAttributeFile.execute("getValue",()=>{const e=this.getValueInternal();return Object(N.c)(e)})}setValue(e){this._clientApiExecutorAttributeFile.execute("setValue",()=>{this.setValueInternal(e)})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let oe;class se extends A{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),oe=e}getValue(){const e="ClientApi.XrmEntityAttributeEntityName.getValue";try{s.a.instance.reportCall(e);const t=this.getValueInternal(),n=Object(c.a)(oe.getState(),this.getParent().getEntityName(),this.getName());let a=null;return n.IsEntityReferenceStored&&Object(i.j)(t)&&(a=t.value),s.a.instance.reportSuccess(e),a}catch(t){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setValue(e){const t="ClientApi.XrmEntityAttributeEntityName.setvalue";Object(y.a)(e)||"string"==typeof e||Object(y.k)(t,"string","value");try{s.a.instance.reportCall(t),this.setValueInternal(e),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getAttributeType(){return s.a.instance.reportUsage("ClientApi.XrmEntityAttributeEntityName.getAttributeType"),"entityname"}}var ce=n("aOhN"),le=n("Pcet"),ue=n("WY/A"),de=n("qTme"),he=n("Dea/"),ge=n("NPZ3"),pe=n("bGh0"),me=n("srnJ"),be=n("Fij2"),fe=n("pF61"),ye=n("ruPX"),Ce=n("cfbi"),_e=n("P6DH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function ve(e,t,n,a){const r=Object(g.z)(e,t,n,a,n.relationshipName);if(!r||0===r.length)return!0;for(let a=0;a<r.length;a++)if(!Object(g.t)(e,{controlName:r[a],id:t},n))return!0;return!1}function Se(e,t,n,a,r,i){if(!Object(_e.K)(e,t,n,a,null==i?void 0:i.id))return!1;const o=Object(_e.y)(e,n,t);if(!r||!o)return!1;if(o&&0===o[a])return!1;if(null===r.ParentPicklistLogicalName)return!0;const s=Object(g.ac)(e,t,n),c=Object(g.X)(e,t,n,s,i,r.ParentPicklistLogicalName);return!(!c||!c.label)}var Oe=n("jRy5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Ie;class je extends ${constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),Ie=e}setValue(e){const t="ClientApi.XrmEntityAttributeDependentOptionSet.setValue";let n;try{s.a.instance.reportCall(t),n=this.contextToken.contextTokenType===Oe.a.MainGrid||this.contextToken.contextTokenType===Oe.a.SubGrid||this.contextToken.contextTokenType===Oe.a.AssociatedGrid?Se(Ie.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):ve(Ie.getState(),this.getPageId(),this.contextToken,this.getName()),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}n?super.setValue(e):Object(y.e)("ClientApi.XrmEntityAttributeDependentOptionSet.setValue","Can not execute setValue for dependent option set attribute since it is disabled.")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let Pe;class xe extends L{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),Pe=e}setValue(e){const t="ClientApi.XrmEntityAttributeMultiSelectDependentOptionSet.setValue";let n;try{s.a.instance.reportCall(t),n=this.contextToken.contextTokenType===Oe.a.MainGrid||this.contextToken.contextTokenType===Oe.a.SubGrid||this.contextToken.contextTokenType===Oe.a.AssociatedGrid?Se(Pe.getState(),this.getPageId(),this.contextToken,this.getName(),this.getAttrDescriptor(),this.parentEntityReference):ve(Pe.getState(),this.getPageId(),this.contextToken,this.getName()),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"attributeName",value:this.getName()}),C.a.getInstance().reportFailure(t,e,null,n),e}n?super.setValue(e):Object(y.e)(t,"Can not execute setValue for dependent option set attribute since it is disabled.")}}var Ee=n("3/02"),we=n("Lyxw"),Te=n("QHx/"),Ae=n("L8zx"),Fe=n("Exmh");let Ne;class ke{constructor(e,t,n,r,i,o,s,c){Ne=e;const l=[{name:"pageId",value:n,isEventParam:!0,isRequired:!0,expectedDataType:"string"},{name:"entityType",value:i,isEventParam:!0,isRequired:!1,expectedDataType:"string"},{name:"store",value:e,isRequired:!0},{name:"contextToken",value:t,isRequired:!0},{name:"xrmForm",value:r,isRequired:!0}];this._clientApiExecutor=new a.a(e,"ClientApi.XrmEntity.",n,t,l),this._pageId=n,this._xrmForm=r,this._contextToken=t,this._entityType=i,this._entityId=o,this._getAttributeNames=s,this._applicationContext=c}get attributes(){return this._clientApiExecutor.execute("attributes",(e,t)=>{if(!this._attributes){this._attributes=new m.a(e);const n=this._getAttributeNames(this._applicationContext,this._contextToken,this._pageId);if(!n)return this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was null or undefined"),t),this._attributes;0===n.length&&this._clientApiExecutor.reportFailure(e,new Error("Entity attribute names array was empty."),t),n.forEach(e=>{const t=Object(c.a)(Ne.getState(),this.getEntityName(),e);if(t){const n=Me(Ne,this._contextToken,this._pageId,e,this,this._xrmForm.ui,t);this._attributes.add(e,n)}})}return this._attributes})}get relatedEntities(){const e="ClientApi.XrmEntity.relatedEntities";try{if(s.a.instance.reportCall(e),!this._relatedEntities){this._relatedEntities=new m.a(e);const t=Object(g.oc)(Ne.getState(),{id:this._pageId},this._contextToken);for(const e in t)if(t[e]){const n=Object(_.m)(this._contextToken,e),a=new ke(Ne,n,this._pageId,this._xrmForm,t[e].etn,t[e].id,this._getAttributeNames,this._applicationContext);this._relatedEntities.add(e,a),this._updateControl(a,e)}const n=Object(g.nc)(Ne.getState(),{id:this._pageId}),a={};for(const e in n){const t=n[e];a[t.referencingAttribute]||(a[t.referencingAttribute]={}),a[t.referencingAttribute][t.referencedEntity]=e}for(const e in a)Ne.dispatch(Object(f.a)(this._contextToken,this._pageId,e,t=>{for(const t in a[e]){const n=this._relatedEntities.get(a[e][t]);n&&this._relatedEntities.remove(n)}const n=t.getEventSource().getValue();if(n&&n.length>0){const t=n[0],i=a[e][t.entityType],o=Object(_.m)(this._contextToken,i),s=new ke(Ne,o,this._pageId,this._xrmForm,t.entityType,r.a.tryParse(t.id),this._getAttributeNames,this._applicationContext);this._relatedEntities.add(i,s),this._updateControl(s,i)}},!0))}return s.a.instance.reportSuccess(e),this._relatedEntities}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}_updateControl(e,t){this._xrmForm&&this._xrmForm.ui&&this._xrmForm.ui.controls&&this._xrmForm.ui.controls.forEach(n=>{n instanceof pe.a&&n.updateAttribute(e,t)})}addOnSave(e){const t="ClientApi.XrmEntity.addOnSave";e||Object(y.j)(t,"handler");try{s.a.instance.reportCall(t),Ne.dispatch(Object(f.o)(this._contextToken,this._pageId,e)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}getDataXml(){const e="ClientApi.XrmEntity.getDataXml";try{s.a.instance.reportCall(e);let t="";return this.attributes.forEach(e=>{e.getIsDirty()&&(t+=e.getDataXmlInternal())}),t="<"+Object(x.CrmXmlEncode)(this.getEntityName())+">"+t+"</"+Object(x.CrmXmlEncode)(this.getEntityName())+">",s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getEntityReference(){const e="ClientApi.XrmEntity.getEntityReference";try{s.a.instance.reportCall(e);const t={entityType:this.getEntityName(),id:this.getId(),name:this.getPrimaryAttributeValue()};return s.a.instance.reportSuccess(e),t}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){const e="ClientApi.XrmEntity.getEntityName";try{return s.a.instance.reportCall(e),s.a.instance.reportSuccess(e),this._entityType}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getId(){const e="ClientApi.XrmEntity.getId";try{if(s.a.instance.reportCall(e),!this._entityId||this._entityId&&this._entityId.guid===r.a.EMPTYGUIDSTRING){const e=Object(Z.i)(Ne.getState(),this._pageId);if(e&&e.value){const t=e.value;this._entityId=t.id}else{const e=Object(g.ac)(Ne.getState(),this._pageId,this._contextToken);if(e){const t=Object(u.b)(Ne.getState(),e);t&&t.identifier&&(this._entityId=t.identifier.id)}}}return this._entityId&&this._entityId.guid===r.a.EMPTYGUIDSTRING?(s.a.instance.reportSuccess(e),r.a.EMPTYSTRING):(s.a.instance.reportSuccess(e),r.a.externalGuid(this._entityId))}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}getPrimaryAttributeValue(){return this._clientApiExecutor.execute("getPrimaryAttributeValue",(e,t)=>{let n="";const a=Object(v.h)(Ne.getState(),this.getEntityName());if(a){if(!a.PrimaryNameAttribute)return n="PrimaryNameAttribute was not defined",Y.a.getInstance().traceManager.getTracer(e).error(n,t),"";{const e=Object(g.ac)(Ne.getState(),this._pageId,this._contextToken),t=this.getId()?new o.a(this.getEntityName(),new r.a(this.getId())):new o.a(this.getEntityName()),s=Object(g.X)(Ne.getState(),this._pageId,this._contextToken,e,t,a.PrimaryNameAttribute);if(!s)return"";if(Object(i.j)(s))return s.value;n="PrimaryAttribute value was not an IPlainValue"}}else n="Entity descriptor could not be retrieved.";return C.a.getInstance().reportFailure(e,new Error(n),null,t),""})}getIsDirty(){const e="ClientApi.XrmEntity.getIsDirty";try{s.a.instance.reportCall(e);for(let t=0;t<this.attributes.getLength();t++){const n=this.attributes.get(t);if("never"!==n.getSubmitMode()&&n.getIsDirty())return s.a.instance.reportSuccess(e),!0}for(let t=0;t<this.relatedEntities.getLength();t++){if(this.relatedEntities.get(t).getIsDirty())return s.a.instance.reportSuccess(e),!0}return s.a.instance.reportSuccess(e),!1}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}removeOnSave(e){const t="ClientApi.XrmEntity.removeOnSave";e||Object(y.j)(t,"handler");try{s.a.instance.reportCall(t),Ne.dispatch(Object(f.J)(this._contextToken,this._pageId,e)),s.a.instance.reportSuccess(t)}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}save(e){this._clientApiExecutor.executeAsync("save",(t,n)=>{let a=1;if(e)if("string"==typeof e)switch(e){case"save":a=1;break;case"saveandclose":a=2;break;case"saveandnew":a=59}else e.saveMode&&(a=e.saveMode);const r=Ne.getState();return Object(Ae.b)(this._pageId,Ne,a,n,this._contextToken,this,!1,"saveandclose"!==e).then(t=>this._performAfterSaveLogic(r,t,e))})}isValid(){const e="ClientApi.XrmEntity.isValid";try{if(s.a.instance.reportCall(e),this.attributes)for(let t=0;t<this.attributes.getLength();t++){const n=this.attributes.get(t);if(this._attributeHasActiveControl(n)&&!n.isValid()||n.hasErrorNotification())return s.a.instance.reportSuccess(e),!1}if(this.relatedEntities)for(let t=0;t<this.relatedEntities.getLength();t++)if(!this.relatedEntities.get(t).isValid())return s.a.instance.reportSuccess(e),!1;return s.a.instance.reportSuccess(e),!0}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(e,t,null,n),t}}setRecordId(e){const t="ClientApi.XrmEntity.setRecordId";e||Object(y.j)(t,"id");try{if(s.a.instance.reportCall(t),this.getId()&&this._entityId.guid!==r.a.EMPTYGUIDSTRING)s.a.instance.reportSuccess(t);else{const n=r.a.tryParse(e);r.a.isNullOrEmpty(n)&&Object(y.j)(t,"id");const a={},i=Ne.getState(),c=Object(g.ac)(i,this._pageId,this._contextToken),l=Object(_.x)(this._contextToken);if(c){const e=new o.a(this.getEntityName(),n);Ne.dispatch(Object(le.b)(c,e)),s.a.instance.reportSuccess(t)}else{const e=Object(ue.b)(i,new o.a(this.getEntityName(),n),a,l,he.a.Create),r=e.payload.snapshotId;Ne.dispatch(e),Ne.dispatch(Object(de.b)(this._pageId,r,this._contextToken)).then(()=>{s.a.instance.reportSuccess(t)}).catch(e=>{const n=C.a.getInstance().getEventParameters(this._contextToken);n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(t+".setDataSnapshotId",e,null,n)})}}}catch(e){const n=C.a.getInstance().getEventParameters(this._contextToken);throw n.push({name:"entityName",value:this.getEntityName()}),C.a.getInstance().reportFailure(t,e,null,n),e}}refresh(){const e="ClientApi.XrmEntity.refresh";try{if(s.a.instance.reportCall(e),this.getId()){const t=new o.a(this.getEntityName(),new r.a(this.getId())),n=[],a=[];for(let e=0;e<this.attributes.getLength();e++)a.push(this.attributes.get(e).getName());const i=Object(ge.a)(Ne.getState(),t.etn);if(i&&a.push(...i),n.push(Ne.dispatch(Object(me.a)(this._pageId,t,a,new Fe.a(o.a.toLegacyEntityReference(t),null,null)))),this.relatedEntities)for(let e=0;e<this.relatedEntities.getLength();e++)n.push(this.relatedEntities.get(e).refresh());return Promise.all(n).then(()=>{Object(be.b)(this),s.a.instance.reportSuccess(e)}).catch(t=>{const n=C.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Ne,t,e,n)})}return s.a.instance.reportSuccess(e),Promise.resolve(null)}catch(t){const n=C.a.getInstance().getEventParameters(this._contextToken);return n.push({name:"entityName",value:this.getEntityName()}),Object(y.d)(Ne,t,e,n)}}_attributeHasActiveControl(e){if(e&&e.controls){const t=e.controls.getLength();for(let n=0;n<t;n++)if(!e.controls.get(n).getDisabled())return!0}return!1}_performAfterSaveLogic(e,t,n){const a=Object(g.kb)(Ne.getState(),{id:this._pageId},this._contextToken);if(t||!this.getIsDirty()||a)if(Object(be.b)(this),"saveandclose"===n){if(!Object(be.a)(Object(fe.b)(Ne.getState())===this._pageId)){const t=Object(g.Kb)(e,this._pageId),n=Object(g.Ib)(e,this._pageId);if(!t&&!n){const e=Object(Te.a)(Ne.getState(),this._pageId);return Ne.dispatch(Object(ce.b)(e))}}}else if("saveandnew"===n){const e={entityTypeName:this.getEntityName()};return Ne.dispatch(Object(ye.a)(Ce.a,e,this._pageId))}return Promise.resolve()}}function Me(e,t,n,a,r,i,o){let s=null,l=!1;switch(o.Type){case"datetime":s=new X(e,t,n,a,r,i);break;case"decimal":case"double":case"integer":case"money":s=new Q(e,t,n,a,r,i);break;case"lookup":case"owner":case"customer":s=new U(e,t,n,a,r,i);break;case"partylist":s=new re(e,t,n,a,r,i);break;case"memo":case"string":s=new ee(e,t,n,a,r,i);break;case"picklist":if(l=Object(we.c)(e.getState(),Ee.L),l&&Object(c.l)(e.getState(),o.EntityLogicalName,a)){s=new je(e,t,n,a,r,i);break}case"optionset":case"state":case"status":s=new $(e,t,n,a,r,i);break;case"boolean":s=new R(e,t,n,a,r,i);break;case"entityname":s=new se(e,t,n,a,r,i);break;case"uniqueidentifier":s=new te(e,t,n,a,r,i);break;case"multiselectpicklist":l=Object(we.c)(e.getState(),Ee.L),s=l&&Object(c.l)(e.getState(),o.EntityLogicalName,a)?new xe(e,t,n,a,r,i):new L(e,t,n,a,r,i);break;case"file":s=new ie(e,t,n,a,r,i);break;default:s=new A(e,t,n,a,r,i)}return s}},Utin:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var a=n("dHD5"),r=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="control.update.parameter";function o(e,t,n,o,s){return{type:"control.update.parameter.async",execute({dispatch:c,getState:l},u){const d=r.x+".updateControlParameterAction";c(function(e,t,n,o,s){const c=Object(a.v)(s);return{type:i,payload:{name:n,value:o},meta:{pageId:e,dataSetContextKey:c,controlName:r.o}}}(e,0,n,o,s));const h=[];return h.push({name:"controlName",value:t}),h.push({name:"paramName",value:""+n}),u.EventManager.ReportComponentSuccess(d,h),Promise.resolve()}}}},VKvO:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="offline.upsync.completed";function i(){const e={upSyncStatus:a.a.Completed};return{type:r,payload:e}}},VZXL:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Web.CommandBar.ErrorLoading_Message",r="Web.CommandBar.MoreCommands_ToolTip",i="Web.CommandBar.MoreCommandsForEntity_ToolTip",o="Command_Bar_Label",s=["Web.CommandBar.Loading_Message",a,r,i,o]},"WK+4":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n("dHD5"),r=n("BFlg");const i="chart.visualizationid.update";function o(e,t,n){return{type:"chart.visualizationid.update.async",execute({dispatch:o,getState:s},c){const l=c.TraceManager.getTracer(r.z),u=r.x+".updateVisualizationIdAction";try{l.info("Updating the chart visualization id"),t||(t=Object(a.k)(s(),e));const r=Object(a.v)(t);return o(function(e,t,n){return{type:i,payload:{name:"VisualizationId",value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,r,n)),c.EventManager.ReportComponentSuccess(u),Promise.resolve()}catch(e){const t="Updatation of the chart visualization id failed with error : "+e.message;c.EventManager.ReportComponentFailure(u,Error(t))}}}}},WRDA:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e){return Object(a.b)(e)?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())}},WTtv:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeOfflineLifecycleAsyncAction",(function(){return w}));var a=n("Rj8P"),r=n("VKvO"),i=n("TBkx"),o=n("37s6"),s=n("SAYH"),c=n("zmAS"),l=n("e+ib"),u=n("Uv1Y"),d=n("9bCE"),h=n("Eh/Y"),g=n("Nzmy"),p=n("QSjj"),m=n("iOI1"),b=n("eZ32"),f=n("8CLP");var y=n("NjDY"),C=n("GL3b"),_=n("iF9X"),v=n("yRo8"),S=n("ml6Y"),O=n("8Mff");function I(){return{type:"offline.save.sessionstate",execute({getState:e},t){const n=e(),a=Object(o.p)(n),r={},c={},l={},u={},d=[];return a!==O.a.Disabled?(c[S.a.OfflineProfileIdKey]=s.a.toString(C.c(n)),c[S.a.OfflineProfileVersionKey]=C.d(n),c[S.a.OfflineProfileAvailableEntitiesKey]=C.b(n),r[S.a.norsyncServerConnectionStringKey]=_.c(n),r[S.a.isTrialOrganizationKey]=_.b(n).toString(),r[S.a.isMocaOfflineFCBEnabledKey]=_.a(n).toString(),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.OfflineProfileDataKey),d.push(t.DataSource.saveSessionState(S.a.OfflineProfileDataKey,c,!1)),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.offlineDatabaseInformationKey),d.push(t.DataSource.saveSessionState(S.a.offlineDatabaseInformationKey,r,!1))):(g.c.info("Offline: OfflineSaveSessionState: Clearing the Session State"),d.push(t.DataSource.deleteSessionState(S.a.OfflineProfileDataKey)),d.push(t.DataSource.deleteSessionState(S.a.offlineDatabaseInformationKey)),d.push(t.DataSource.deleteSessionState(S.a.OfflineEntityPluralNamesKey)),d.push(t.DataSource.deleteSessionState(S.a.OfflinePrimaryAvailableEntitiesKey)),d.push(t.DataSource.deleteSessionState(v.a))),u[S.a.isMobileOfflineOptedInKey]=a.toString(),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.isMobileOfflineOptedInKey),d.push(t.DataSource.saveSessionState(S.a.isMobileOfflineOptedInKey,u,!1)),l[S.a.OfflineDatabaseKey]=Object(o.d)(n),g.c.info("Offline: OfflineSaveSessionState: Saving information to the session state:"+S.a.OfflineDatabaseKey),d.push(t.DataSource.saveSessionState(S.a.OfflineDatabaseKey,l,!1)),Promise.all(d).then(()=>(g.c.info("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Complete"),Promise.resolve())).catch(e=>(g.c.error("Offline: OfflineSaveSessionState: SaveMobileofflineInformation: Failed"+Object(i.e)(e)),Promise.reject(e)))}}}var j=n("504W"),P=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function x(e,t,n,r,i){const c=Object(y.m)(t),d=Object(C.e)(t),h=Object(o.p)(t),p=Object(C.c)(t);c&&h!==O.a.Disabled&&(p&&p!==s.a.EMPTY&&d?(h===O.a.Default&&n(Object(l.b)(O.a.Enabled)),n(function(e,t){return{type:"offline.schedule.datasync.async",execute({dispatch:n,getState:r},i){const s=i.OfflineProvider,c=Object(o.d)(r());if(Object(j.a)(c)){const e=Object(P.b)(r())?b.a.Initializing:b.a.NotAvailable;g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to "+e),n(Object(a.c)(e,f.a.None))}else g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: The offline status has been set to Available."),n(Object(a.c)(b.a.Available,f.a.None));return g.c.info("OfflineDataSyncAsyncAction.startOfflineDataSync: Schedule Periodic Sync Job started."),s.schedulePeriodicSyncJob(e,t).nativePromise().catch(u.b)}}}(r,i)),g.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is : mobileOfflineOptStatus =  "+h)):(n(Object(a.c)(b.a.NotAvailable,f.a.ProfileUnavailable)),g.c.warn("Offline: OfflineWrapper: OfflinePerformDataSync: The offline feature status is set to "+b.a.NotAvailable)))}function E(e,t,n,r,s){var c;Object(o.c)(t)?(g.c.warn("OfflineWrapper: OfflineInitDataSync: Deleting the existing offline database as isDBCleanNeeded is true "+Object(o.d)(t)),n((c=Object(o.d)(t),{type:"offline.database.delete.async",execute:({dispatch:e,getState:t},n)=>n.OfflineProvider.cleanUpDatabases(c).nativePromise().then(()=>{e(Object(h.b)("")),e(Object(a.c)(b.a.NotAvailable,f.a.None)),e(Object(d.b)(!1)),e(Object(m.b)(null)),e(Object(p.b)(null,null,null))}).catch(e=>(g.c.error("Offline.databaseDeleteAction: OfflineProvider.cleanUpDatabases failed with error:"+Object(i.e)(e)),Promise.reject(e)))})).then(()=>{x(0,t,n,r,s),n(I())},u.b)):(g.c.warn("OfflineWrapper: OfflineInitDataSync: perform offline data sync "),x(0,t,n,r,s),n(I()))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e,t){return{type:"offline.init.lifecycle.async",execute:({dispatch:n,getState:l},u)=>u.OfflineProvider.initializeOfflineDataSource(u.DataSource.get_UserContext()).nativePromise().then(()=>{const i=l(),d=Object(P.b)(i),h=Object(o.d)(i);if(Object(o.p)(l())===O.a.Disabled||null===h||""===h||s.a.equals(s.a.parse(h),s.a.EMPTY)||n(Object(a.c)(b.a.Available,f.a.None)),null!=h){const a=()=>!d||n(Object(c.initializeOfflineUpsyncProcessAsyncAction)()).then(()=>(E(0,l(),n,e,t),!0));return u.OfflineProvider.calculateDisabledOfflineEntities().nativePromise().then(a,a)}return d&&(n(Object(r.b)()),E(0,l(),n,e,t)),!0}).catch(e=>(g.c.error("OFFLINE : initializeOfflineLifecycleAsyncAction Failed"+Object(i.e)(e)),Promise.reject(e)))}}},XA60:function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return w}));var a=n("nuS9"),r=n("Ij+U"),i=n("YWpA"),o=n("u+q+"),s=n("gvL4"),c=n("Afz2"),l=n("3rse"),u=n("4fxQ"),d=n("o0iw"),h=n("RiHV"),g=n("iZ7K"),p=n("cUMa"),m=n("ILmX"),b=n("wgH2"),f=n("YxC/"),y=n("VZXL"),C=n("GAI+"),_=n("mpSO"),v=n("CfXY"),S=n("IqkD"),O=n("Lyxw"),I=n("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const j="Commands";let P=!1;class x extends a.Component{constructor(e){super(e),this._isGlobalComandBar=!1,this._allCommandButtonsTabable=!1,this._selectedIndex=-1,this._selectedId="",this._allControls=[],this._allRenderingMenuItems=[],this._keyboardHandler=this._keyboardHandler.bind(this),this._keyboardFocusHandler=this._keyboardFocusHandler.bind(this),this._isGlobalComandBar=e.commandManagerId.startsWith(_.d),this._allCommandButtonsTabable=this._isGlobalComandBar,this._onCommandBarMeasure=this._onCommandBarMeasure.bind(this)}_init(){this._initialized||(this._initialized=!0,this._extractButtons(this.props))}_needResetIndex(){if(this._allCommandButtonsTabable)return!1;return!!u.findDOMNode(this._commandBarItems)&&(!this._selectedId||!document.getElementById(this._selectedId))}_moveIndex(e,t=!1,n=!0){const a=u.findDOMNode(this._commandBarItems);if(!a)return;!this._allCommandButtonsTabable&&a.querySelectorAll("[tabindex='0']").forEach(e=>e.setAttribute("tabindex","-1"));let r=a.childNodes[e];if(r){if(t&&this._isSplitButton(e)){const e=r.querySelector("[aria-haspopup='true']");r=e||r}this._selectedIndex=e,this._selectedId=r.id,(n||a.contains(document.activeElement))&&r.focus(),!this._allCommandButtonsTabable&&r.setAttribute("tabindex","0")}}_isSplitButton(e){return this._allRenderingMenuItems.length>e&&this._allControls[e].ControlType===C.c}_generateControl(e){let t=C.a,n=null;return e.Children&&e.Children.length>0&&(t=e.execute?C.c:C.b,n=e.Children.map(e=>this._generateControl(e))),{Command:e.Id,Id:e.Id,DataId:e.DataId,ControlType:t,DisplayText:e.DisplayText,execute:e.execute,executeInjectedPopulationQueryCommand:e.executeInjectedPopulationQueryCommand,Icon:e.Icon,isInjectedCommand:!0,WillOpenFlyout:e.WillOpenFlyout,IsInFlyout:e.IsInFlyout,ToolTipTitle:void 0!==e.Tooltip?e.Tooltip.title:"",ToolTipDescription:void 0!==e.Tooltip?e.Tooltip.description:"",ChildInjectedControls:n,dataLPId:e.dataLPId,accessibilityExpanded:e.accessibilityExpanded,controlsElementId:e.controlsElementId,ownsElementId:e.ownsElementId}}_getLearningPathId(e){let t="commandbar-";if(e.ribbonId)t+=e.ribbonId;else if(e.commandManagerId){t+=e.commandManagerId;const n=t.indexOf(":");n>-1&&(t=t.substring(n+1))}return t}componentWillReceiveProps(e){var t,n,a;if(!0===(null===(n=null===(t=this.props)||void 0===t?void 0:t.ribbonDescriptor)||void 0===n?void 0:n.Localized)&&!0!==(null===(a=null==e?void 0:e.ribbonDescriptor)||void 0===a?void 0:a.Localized))return;const r=this._areMenuLengthPropsChanged(e,this.props)||!this._areButtonsEqualInProps(e,this.props);this._extractButtons(e,r)}_areButtonsEqualInProps(e,t){return e.menuControlMapping===t.menuControlMapping&&this._areControlListsEqual(e.addedCommandList,t.addedCommandList)&&this._areControlListsEqual(e.appendedCommandList,t.appendedCommandList)}_areControlListsEqual(e,t){return null==e||null==t?null==e&&null==t:e.length===t.length&&e.every((e,n)=>e.Id===t[n].Id&&e.DisplayText===t[n].DisplayText)}_areMenuLengthPropsChanged(e,t){return e.width!==t.width||e.iconPosition!==t.iconPosition||e.commandbarDisplayMode!==t.commandbarDisplayMode||e.mainMenuLength!==t.mainMenuLength}_extractButtons(e,t=!0){this._updateAllControls(e),this._updateRenderingMenuItems(e),t&&(this._mainMenuLength=Object(v.c)(e.width,e.commandBarStyle,this._allControls,e.iconPosition,e.isRTL,e.commandbarDisplayMode,e.mainMenuLength,e.forceUseOfMainMenuLength,P),this._allCommandButtonsTabable||(this._selectedId=void 0))}_updateAllControls(e){if(this._allControls=[],e.addedCommandList&&e.addedCommandList.forEach(e=>{this._allControls.push(this._generateControl(e))}),e.ribbonDescriptor&&e.ribbonDescriptor.Layout){let t=new Array;e.ribbonDescriptor.Layout.Tabs.Tab&&(t=t.concat(e.ribbonDescriptor.Layout.Tabs.Tab)),e.ribbonDescriptor.Layout.ContextualTabs.Tab&&(t=t.concat(e.ribbonDescriptor.Layout.ContextualTabs.Tab)),t.forEach(t=>{t&&t.Groups&&t.Groups.Group&&t.Groups.Group.forEach(t=>{t.Controls.Items.forEach(t=>{const n=t?Object(m.i)(t.Id,Object(b.a)(e.ribbonId)):null;t&&n&&e.menuControlMapping[n]&&this._allControls.push(t)})})})}e.appendedCommandList&&e.appendedCommandList.forEach(e=>{this._allControls.push(this._generateControl(e))})}_updateRenderingMenuItems(e){this._allRenderingMenuItems=[];const t=e.selectedRecords&&e.selectedRecords.length>0;this._allControls.forEach((n,a)=>{const r={RootButtonId:null,contextKey:e.contextKey,areRecordsSelected:t,isFlyoutControl:!1,commandManagerId:e.commandManagerId,control:n,iconPosition:e.iconPosition,flyoutDepth:0,commandBarStyle:e.commandBarStyle,isMainView:!0,executeCommand:e.executeCommand,ribbonId:e.ribbonId,pageId:e.pageId,commandbarDisplayMode:e.commandbarDisplayMode,updateMainViewKeyboardIndex:this._updateSelectedIndex(a),hideFlyoutButtonChevron:e.hideFlyoutButtonChevron,isCommandBarRefresh:e.isCommandBarRefresh,rootZIndex:e.rootZIndex},i=Object(d.f)(n,r,this._allRenderingMenuItems.length,this._allCommandButtonsTabable,e.entityDisplayName,e.entityDisplayCollectionName);this._allRenderingMenuItems.push(i)})}render(){this._init(),this._numberMainMenuControls=0,this._numberOverflowControls=0;const e=[],t=[];if(this._allRenderingMenuItems.forEach(e=>{t.length<this._mainMenuLength&&(t.push(e),this._numberMainMenuControls++)}),this._allControls.length>this._mainMenuLength)for(let t=this._mainMenuLength;t<this._allControls.length;t++)this._addControlToMoreMenu(this._allControls[t],e);const n=this.props.selectedRecords&&this.props.selectedRecords.length>0;if(this._numberOverflowControls>0){const i=Object(f.c)(this.props.resourceStrings,y.c),o=Object(f.c)(this.props.resourceStrings,y.b),s=this.props.entityDisplayName?String.format(o,this.props.entityDisplayName):i,c=Object(d.i)({ToolTipTitle:s,OverflowIcon:this.props.useVerticalMoreIcon?"MoreVertical":"More"},_.f),l=Object(d.e)(c,this.props.commandManagerId,this.props.contextKey),u=Object.assign({},this.props.commandBarStyle);u.listItemBody=Object.assign({},u.listItemBody),u.listItemBody.button=Object.assign(Object.assign({},u.listItemBody.button),{paddingLeft:0,paddingRight:0}),t.push(a.createElement(r.a,{contextKey:this.props.contextKey,areRecordsSelected:n,isOverflowFlyoutMoreButton:!0,commandbarDisplayMode:this.props.commandbarDisplayMode,isFlyoutControl:!1,flyoutDepth:0,commandManagerId:this.props.commandManagerId,pageId:this.props.pageId,accessibilityLabel:s,key:l,id:l,tabIndex:this._allCommandButtonsTabable?0:-1,ariaOwnsElementId:l+"_flyout",RootButtonId:l,menuItems:e,control:c,iconPosition:this.props.iconPosition,commandBarStyle:u,isMainView:!0,executeCommand:this.props.executeCommand,ribbonId:this.props.ribbonId,updateMainViewKeyboardIndex:this._updateSelectedIndex(this._numberMainMenuControls),isCommandBarRefresh:this.props.isCommandBarRefresh,rootZIndex:this.props.rootZIndex})),this._numberMainMenuControls++}return this._getMarkupOfCommandBar(t,this.props)}_onCommandBarMeasure(){const e=u.findDOMNode(this._commandBarItems);if(e){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){if(e){const t=getComputedStyle(e),n=parseInt(t.fontSize,10),a=parseFloat(t.letterSpacing),r=parseFloat(t.wordSpacing);return a>=.12*n&&r>=.16*n}}(e);P!==t&&(P=t,this._extractButtons(this.props),this.forceUpdate())}}_getMarkupOfCommandBar(e,t){const n="$commandBarInfo"+t.commandManagerId,r="$commandBarItemsList"+t.commandManagerId;return e.length>0?a.createElement(i.a,{style:this._transformContainerStyle(t),key:n,isRequestedMeasuring:!0,onMeasuring:this._onCommandBarMeasure},a.createElement(s.a,{ref:e=>{this._commandBarItems=e,this._needResetIndex()&&this._moveIndex(0,!1,!1)},testhooks:{id:"CommandBar",[h.a.LearningPathDOMAttributeSuffix]:this._getLearningPathId(t)},accessibilityLabel:j,key:r,role:c.m,style:Object.assign(Object.assign({},t.commandBarStyle.list),{listStyleType:"none",flexShrink:"0"}),onKeyDown:this._keyboardHandler,onFocus:this._keyboardFocusHandler},e)):null}_transformContainerStyle(e){let t=e.commandBarStyle.container;return e.height&&(t=Object.assign(Object.assign({},t),{maxHeight:e.height+"px",overflowY:"auto"})),t}_addControlToMoreMenu(e,t){t.push(e),this._numberOverflowControls++}_updateSelectedIndex(e){return()=>{this._selectedIndex=e;!this._isGlobalComandBar&&this._moveIndex(e,!1,!1)}}_getBrightnessFromRGB(e,t,n){return Math.round((299*e+587*t+114*n)/1e3)}_keyboardFocusHandler(e){let t=e.target;const n=document.getElementById(t.id);if(n&&n.style){let e="";do{e=window.getComputedStyle(t).backgroundColor,t=t.parentElement}while(("rgba(0, 0, 0, 0)"===e||"transparent"===e)&&t);if(-1!==e.indexOf("rgb")){const t=e.split(/[()]+/)[1].split(",");n.style.outlineColor=this._getBrightnessFromRGB(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))>125?"#666666":"#FFFFFF"}}if(!this._isGlobalComandBar){const t=u.findDOMNode(this._commandBarItems),n=t&&t.children;if(n)for(let t=0;t<n.length;t++)""!==n[t].id&&n[t].id===e.target.id&&t!==this._selectedIndex&&this._moveIndex(t)}}_keyboardHandler(e){if(e.keyCode===l.a.Enter)return e.stopPropagation(),e.preventDefault(),void e.target.click();if(this._isGlobalComandBar)return;const t=!this.props.isRTL&&e.keyCode===l.a.RightArrow||this.props.isRTL&&e.keyCode===l.a.LeftArrow;!this.props.isRTL&&e.keyCode===l.a.LeftArrow||this.props.isRTL&&e.keyCode===l.a.RightArrow?this._moveIndex(E(this._selectedIndex-1,this._numberMainMenuControls),!0):t&&this._moveIndex(E(this._selectedIndex+1,this._numberMainMenuControls),!1)}}function E(e,t){return(e%t+t)%t}x.displayName="CommandBar";const w=Object(o.a)((function(){const e=Object(p.g)(),t=Object(f.h)();return function(n,a){const r=e(n,a),i=a.ribbonId?a.ribbonId.split(":"):null,o=i&&i.length>1?i[i.length-1]:null,s=Object(g.h)(n,o);return{menuControlMapping:r,entityDisplayName:s&&s.DisplayName?s.DisplayName:"",entityDisplayCollectionName:s&&s.DisplayCollectionName?s.DisplayCollectionName:"",resourceStrings:t(n,y.e),isRTL:Object(S.g)(n),useVerticalMoreIcon:Object(O.a)(n,I.ke,I.h)&&Object(d.r)("MoreVertical")}}}))(x)},XVSa:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("pEXn"),r=n("YxC/"),i=n("mHvI"),o=n("EY5k"),s=n("i1f0"),c=n("LbMF");function l(e,t,n){return{type:"formChecker.ControlState.async",async execute({dispatch:l,getState:u},d){var h,g;const p=u(),m=null===(h=null==d?void 0:d.TraceManager)||void 0===h?void 0:h.getTracer(`${a.k}${a.l}`),b=Object(s.eb)(p,e,t),f=Object(i.b)();if(!b||!m)return Promise.resolve();await l(Object(o.e)(f));const y=u(),C=Object(r.e)(y,f),_=[];for(const a in b){const i=b[a];if(i){const o={id:e,controlName:a},l=Object(s.v)(y,o,t),u=(null==l?void 0:l.reason)?Object(r.c)(C,l.reason):null,d=i.labelSource?Object(r.c)(C,i.labelSource):null,h=i.dataFieldName?Object(c.a)(y,n,null==i?void 0:i.dataFieldName):null,p={"Control Name":a,"Control Label":Object(s.w)(y,o,t),"Control Label Source":`[${i.labelSource}]`+(d?": "+d:""),Attribute:null==h?void 0:h.LogicalName,Disabled:null===(g=null==l?void 0:l.disabled)||void 0===g?void 0:g.toString(),"Disabled State Reason":`[${null==l?void 0:l.reason}]`+(u?": "+u:"")};_.push(p)}}m.warn(a.n,[{name:a.v,value:a.l},{name:a.l,value:JSON.stringify(_)}])}}}},XVX7:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n("OWbt"),r=n("6Qf/"),i=n("dHD5");function o(e,t,n){const r=Object(i.v)(n),o={xrmReady:e};return{type:a.b,payload:o,meta:{pageId:t,contextKey:r}}}function s(e,t,n){const a=Object(i.u)(n),o={xrmReady:e};return{type:r.b,payload:o,meta:{pageId:t,contextKey:a}}}},ZJsz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={queryKey:null,pageNumber:1,isNewPageRequested:!1,selectedRows:[],selectedRelatedEntity:null,filters:{},rowProperties:{records:[]},fetchXml:"",controls:{},refreshCounter:0,pagingRefreshInput:0,pagingData:"",relationshipName:null,relationshipRoleOrdinal:null,showChart:null,useRollupView:!1,chartVisualizationType:null,dependentOptionSetColumnStatus:{},chartDrillDownParameters:[]}},ZUzm:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("cfbi"),r=n("ruPX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t,n,i,o,s,c,l,u){const d={entityTypeName:e.etn,id:e.id,formId:n,data:i,processId:o,processInstanceId:s,selectedStageId:c,isCrossEntityNavigate:l,recordSetQueryKey:u};return Object(r.a)(a.a,d,t)}},Zw8F:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n("SAYH"),r=n("qshH"),i=n("arV0"),o=n("16wZ"),s=n("ZIjf"),c=n("rs6x"),l=n("7TDv"),u=n("+Ljw");let d;class h{constructor(e,t,n,a){this._id=e,this._label=t,d=n,this._pageId=a}getId(){const e="ClientApi.XrmFormSelectorItem.getId";try{s.a.instance.reportCall(e);const t=a.a.toString(this._id);return s.a.instance.reportSuccess(e),t}catch(t){throw r.a.getInstance().reportFailure(e,t),t}}getLabel(){return s.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getLabel"),this._label}getPageId(){return s.a.instance.reportUsage("ClientApi.XrmFormSelectorItem.getPageId"),this._pageId}setVisible(e){const t="ClientApi.XrmFormSelectorItem.setVisible";try{s.a.instance.reportCall(t),d.dispatch(Object(l.b)(this._pageId,a.a.toString(this._id),e)),s.a.instance.reportSuccess(t)}catch(e){throw r.a.getInstance().reportFailure(t,e),e}}getVisible(){const e="ClientApi.XrmFormSelectorItem.getVisible";try{s.a.instance.reportCall(e);const t=Object(u.c)(d.getState(),this._pageId,this._id);return s.a.instance.reportSuccess(e),t}catch(t){throw r.a.getInstance().reportFailure(e,t),t}}navigate(){const e="ClientApi.XrmFormSelectorItem.navigate";try{this._pageId||Object(o.j)(e,"PageId"),s.a.instance.reportCall(e);const t=Object(i.g)(d.getState(),this._pageId),n=t&&t.id?t.id.guid:"",a=Object(i.l)(d.getState(),this._pageId);d.dispatch(Object(c.a)(this._id.guid,this._pageId,a,n)).then(()=>{s.a.instance.reportSuccess(e)}).catch(t=>Object(o.d)(d,t,e+".changeForm"))}catch(t){throw r.a.getInstance().reportFailure(e,t),t}}}},"b41/":function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a={advancedFilters:"Grid_AdvancedFilter_AdvancedFilters",cancel:"GlobalFilter_Cancel",apply:"Button_Label_Apply",addButton:"Web.SFA.Workflow.Variables.Add",addRow:"MenuItem_Label_AddRow_SentenceCase",addGroup:"MenuItem_Label_AddGroup_SentenceCase",deleteExpression:"Web.SFA.Workflow.Variables.Delete",moveUpExpression:"Web._controls.listedit.buttons.MoveUp",moveDownExpression:"Web._controls.listedit.buttons.MoveDown_SentenceCas",makeGroup:"Grid_AdvancedFilter_MakeGroup",ungroup:"AF_MenuItem_UnGroup",andGroup:"AF_Text_And",orGroup:"AF_Text_Or_SentenceCase",addRelatedEntity:"MenuItem_Label_AddRelatedEntity_SentenceCase",relatedEntityPlaceholder:"Grid_AdvancedFilter_RelatedEntityPlaceholder",fieldPlaceholder:"Audit.Incontext.Filters.AttributesGroup",containsData:"Web._tools.search.search.js_12_8_SentenceCase",doesNotContainData:"Web._tools.search.search.js_12_9_SentenceCase",doesNotContainDataWarning:"Grid_AdvancedFilter_DoesNotContainDataWarning",manyToOne:"Grid_AdvancedFilter_ManyToOne",oneToMany:"Grid_AdvancedFilter_OneToMany",manyToMany:"Grid_AdvancedFilter_ManyToMany",noRelationships:"Grid_AdvancedFilter_NoRelationships",moreCommandsAriaLabel:"AF_Aria_MoreCommands",rowSelectorAriaLabel:"AF_Aria_RowSelector",groupSelectorAriaLabel:"AF_Aria_GroupSelector",groupExpandAriaLabel:"AF_MenuItem_Expand",groupCollapseAriaLabel:"AF_MenuItem_Collapse",groupExpandAriaDescription:"AF_Aria_GroupExpand",groupCollapseAriaDescription:"AF_Aria_GroupCollapse",errorQuickFind:"AF_Error_QuickFindView",errorMalformed:"Grid_AdvancedFilter_ErrorMalformed",invalidField:"Grid_AdvancedFilter_InvalidField",fieldSelectorControlLabel:"Grid_AdvancedFilter_FieldSelector",operatorSelectorControlLabel:"Web.SFA.Workflow.AssignValueDialog.Operator",errorFailedToLoad:"Grid_AdvancedFilter_FailedToLoad",fetchXmlConditionWarning:"Grid_AdvancedFilter_FetchXmlConditionWarning"},r=Object.values(a),i={contains:"SystemCustomization.BusinessRules.ConditionOperator.CONTAINS",doesNotContain:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTCONTAIN",beginsWith:"SystemCustomization.BusinessRules.ConditionOperator.BEGINSWITH",doesNotBeginWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTBEGINWITH",endsWith:"SystemCustomization.BusinessRules.ConditionOperator.ENDSWITH",doesNotEndWith:"SystemCustomization.BusinessRules.ConditionOperator.DOESNOTENDWITH",containsData:"SystemCustomization.BusinessRules.ConditionOperator.NOTNULL",doesNotContainData:"SystemCustomization.BusinessRules.ConditionOperator.ISNULL",equals:"CustomControl_Grid_Filtering_ConditionOperator_Equals",doesNotEqual:"CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",greaterThan:"CustomControl_Grid_Filtering_ConditionOperator_Greater",greaterThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",lessThan:"CustomControl_Grid_Filtering_ConditionOperator_Less",lessThanOrEqualTo:"CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",dateQuarter:"ViewDesigner.RecordFilter.quarter",dateFiscalYear:"FiscalYear_Format_String_NoSpace",on:"Web._tools.search.search.js_16_0",onOrAfter:"CustomControl_Grid_Filtering_ConditionOperator_OnOrAfter",onOrBefore:"ViewDesigner.RecordFilter.on_or_before",yesterday:"Web._tools.search.search.js_16_3",today:"Web._tools.search.search.js_16_4",tomorrow:"Web._tools.search.search.js_16_5",nextSevenDays:"Web._tools.search.search.js_16_6",lastSevenDays:"Web._tools.search.search.js_16_7_SentenceCase",nextWeek:"Web._tools.search.search.js_16_8_SentenceCase",lastWeek:"Web._tools.search.search.js_16_9_SentenceCase",thisWeek:"Web._tools.search.search.js_16_10_SentenceCase",nextMonth:"Web._tools.search.search.js_16_11_SentenceCase",lastMonth:"Web._tools.search.search.js_16_12_SentenceCase",thisMonth:"Web._tools.search.search.js_16_13_SentenceCase",nextYear:"Web._tools.search.search.js_16_14_SentenceCase",lastYear:"Web._tools.search.search.js_16_15_SentenceCase",thisYear:"Web._tools.search.search.js_16_16_SentenceCase",lastXHours:"AF_Option_LastXHours_SentenceCase",nextXHours:"AF_Option_NextXHours_SentenceCase",lastXDays:"AF_Option_LastXDays_SentenceCase",nextXDays:"AF_Option_NextXDays_SentenceCase",lastXWeeks:"AF_Option_LastXWeeks_SentenceCase",nextXWeeks:"AF_Option_NextXWeeks_SentenceCase",lastXMonths:"AF_Option_LastXMonths_SentenceCase",nextXMonths:"AF_Option_NextXMonths_SentenceCase",lastXYears:"AF_Option_LastXYears_SentenceCase",nextXYears:"AF_Option_NextXYears_SentenceCase",anyTime:"Search.Time.Range.Anytime",olderThanXMinutes:"AF_Option_OlderThanXMinutes_SentenceCase",olderThanXHours:"AF_Option_OlderThanXHours_SentenceCase",olderThanXDays:"AF_Option_OlderThanXDays_SentenceCase",olderThanXWeeks:"AF_Option_OlderThanXWeeks_SentenceCase",olderThanXMonths:"AF_Option_OlderThanXMonths_SentenceCase",olderThanXYears:"AF_Option_OlderThanXYears_SentenceCase",inFiscalYear:"AF_Option_InFiscalYear_SentenceCase",lastFiscalYear:"AF_Option_LastFiscalYear_SentenceCase",thisFiscalYear:"AF_Option_ThisFiscalYear_SentenceCase",nextFiscalYear:"AF_Option_NextFiscalYear_SentenceCase",lastXFiscalYears:"AF_Option_LastXFiscalYears_SentenceCase",nextXFiscalYears:"AF_Option_NextXFiscalYears_SentenceCase",inFiscalPeriod:"AF_Option_InFiscalPeriod_SentenceCase",lastFiscalPeriod:"AF_Option_LastFiscalPeriod_SentenceCase",thisFiscalPeriod:"AF_Option_ThisFiscalPeriod_SentenceCase",nextFiscalPeriod:"AF_Option_NextFiscalPeriod_SentenceCase",lastXFiscalPeriods:"AF_Option_LastXFiscalPeriods_SentenceCase",nextXFiscalPeriods:"AF_Option_NextXFiscalPeriods_SentenceCase",inFiscalPeriodAndYear:"AF_Option_InFiscalPeriodAndYear_SentenceCase",inOrAfterFiscalPeriodAndYear:"AF_Option_InOrAfterFiscalPeriod_SentenceCase",inOrBeforeFiscalPeriodAndYear:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase",containValues:"Web._tools.search.search.js_17_4_SentenceCase",doesNotContainValues:"Web._tools.search.search.js_17_5_SentenceCase",equalsCurrentUserLanguage:"AF_Option_EqUserLanguage_SentenceCase",isCurrentUser:"Web._tools.search.search.js_17_0_SentenceCase",notCurrentUser:"Web._tools.search.search.js_17_1_SentenceCase",isCurrentBusinessUnit:"Web._tools.search.search.js_19_1_SentenceCase",notCurrentBusinessUnit:"Web._tools.search.search.js_19_2_SentenceCase",under:"Web.SFA.Workflow.UnderOperator",notUnder:"Web.SFA.Workflow.NotUnderOperator",above:"ViewDesigner.RecordFilter.above",viewAll:"CustomControl_Calendar_ViewMore",aboveOrEqual:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase",underOrEqual:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase",isCurrentUserOrReportingHierarchy:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase",isCurrentUserAndTeamsOrReportingHierarchyAndTeams:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase",isCurrentUserTeams:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase",isCurrentUserOrTeams:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase",loadingResults:"Grid_AdvancedFilter_LoadingResults",noResults:"KMControl.SearchKMArticles.NoResults",errorNoValues:"AF_Error_NoValues",inputControlLabel:"Web.SFA.Workflow.AssignValueDialog.Value",removeButtonAriaLabel:"Dialog_Disassociate_Header",noValue:"Grid_AdvancedFilter_NoValue",minValue:"Grid_AdvancedFilter_MinValue",maxValue:"Grid_AdvancedFilter_MaxValue",maxPrecision:"Grid_AdvancedFilter_MaxPrecision",maxLength:"Grid_AdvancedFilter_MaxLength",incorrectDataType:"Grid_AdvancedFilter_IncorrectDataType",durationUnit:"Grid_AdvancedFilter_durationUnit"},o=Object.values(i),s={dropDownOptionsAll:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsAll",dropDownOptionsDefault:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsDefault",dropDownOptionsCustom:"Grid_AdvancedFilter_ColumnEditor_DropDownOptionsCustom",fieldContextMenuRemove:"Grid_AdvancedFilter_ColumnEditor_FieldContextMenuRemove",addColumn:"Grid_AdvancedFilter_ColumnEditor_AddColumn",editColumns:"Grid_AdvancedFilter_ColumnEditor_EditColumns",apply:"Grid_AdvancedFilter_ColumnEditor_Apply",cancel:"Grid_AdvancedFilter_ColumnEditor_Cancel",search:"Grid_AdvancedFilter_ColumnEditor_Search",related:"Grid_AdvancedFilter_ColumnEditor_Related",moveUp:"Grid_AdvancedFilter_ColumnEditor_MoveUp",moveDown:"Grid_AdvancedFilter_ColumnEditor_MoveDown",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault",close:"Grid_AdvancedFilter_ColumnEditor_Close",listAriaLabel:"Grid_AdvancedFilter_ColumnEditor_AttributesListLabel",columnEditor:"Grid_AdvancedFilter_ColumnEditor_ColumnEditor",saveAsNewView:"Grid_AdvancedFilter_ColumnEditor_SaveAsNewView",saveChangesToCurrentView:"Grid_AdvancedFilter_ColumnEditor_SaveChangesToCurrentView",noFieldsToDisplay:"Grid_AdvancedFilter_ColumnEditor_NoFieldsToDisplay",moreOptions:"Grid_AdvancedFilter_ColumnEditor_MoreOptions",dropdown:"Grid_AdvancedFilter_ColumnEditor_Dropdown"},c=Object.values(s),l={ApplyAdvancedFiltersTitle:"Grid_AdvancedFilter_ApplyAdvancedFiltersTitle",ApplyAdvancedFiltersAria:"Grid_AdvancedFilter_ApplyAdvancedFiltersAriaLabel",CancelEditingFiltersAria:"Grid_AdvancedFilter_CancelEditingAdvancedFiltersAriaLabel",OpenAdvancedFiltersTitleAndAria:"Grid_AdvancedFilter_OpenAdvancedFilterTitleAndAria",resetToDefault:"Grid_AdvancedFilter_ColumnEditor_ResetToDefault"},u=Object.values(l),d=[...r,...o,...u]},bGh0:function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("PUjk"),r=n("HcnX"),i=n("odYE"),o=n("Khp3");class s{constructor(e,t,n,a){this.eventName="BusinessRuleRecommendation_"+e,this.eventParameters=[{name:"EntityTypeName",value:t},{name:"FieldName",value:n},{name:"Title",value:a}]}}var c=n("qshH"),l=n("16wZ"),u=n("i1f0"),d=n("LbMF"),h=n("Qn2w"),g=n("SAYH"),p=n("uhZ3"),m=n("IaGr");var b=n("ZIjf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let f;class y extends r.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),this._entityAttribute=null,f=e,this.registerObserversForControlStateChange()}getAttribute(){const e="ClientApi.XrmDataControl.getAttribute";try{if(b.a.instance.reportCall(e),!this._entityAttribute){let e;if(this.formContext&&this.formContext.data&&this.formContext.data.entity&&(e=this.controlDescriptor&&this.controlDescriptor.Relationship?this.formContext.data.entity.relatedEntities.get(this.controlDescriptor.Relationship):this.formContext.data.entity),this.controlDescriptor&&this.controlDescriptor.DataFieldName&&this.formContext&&this.formContext.data)if(this.controlDescriptor.IsUnbound)this._entityAttribute=this.formContext.data.attributes.get(this.controlDescriptor.DataFieldName);else{const t=e?e.attributes:this.formContext.data.attributes;this._entityAttribute=t.get(this.controlDescriptor.DataFieldName)}}return b.a.instance.reportSuccess(e),this._entityAttribute}catch(t){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(e,t,null,n),t}}updateAttribute(e,t){const n="ClientApi.XrmDataControl.updateAttribute";try{if(b.a.instance.reportCall(n),e&&t&&this.controlDescriptor&&this.controlDescriptor.Relationship===t){this._entityAttribute=null;const t=e.attributes;t&&(this._entityAttribute=t.get(this.controlDescriptor.DataFieldName))}this._entityAttribute&&this._entityAttribute.controls.add(this.name,this),b.a.instance.reportSuccess(n)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}addNotification(e){const t="ClientApi.XrmDataControl.addNotification";try{if(b.a.instance.reportCall(t),this._isValidNotification(e)&&this.getVisible()){const n={uniqueId:e.uniqueId?e.uniqueId:"",messages:e.messages,notificationLevel:e.notificationLevel,actions:e.actions};return"RECOMMENDATION"===e.notificationLevel?this._reportAddNotificationEvent(e):f.dispatch(Object(h.b)(this.pageId,this.getName(),!1,this.contextToken)),f.dispatch(Object(o.b)(this.pageId,this.getName(),n,this.contextToken)),b.a.instance.reportSuccess(t),!0}return b.a.instance.reportSuccess(t),!1}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}_clearControlNotification(e){const t=Object(u.A)(f.getState(),{controlName:this.name,id:this.pageId},this.contextToken);if(t){const n=Object.keys(t);let a=null;if(e){if(a=t[e],!(a&&a.messages&&a.notificationLevel))return!1;this._clearNotification(a)}else(Object(l.a)(e)||0===e.trim().length)&&n.forEach(e=>{a=t[e],this._clearNotification(a)});return!0}return!1}_clearNotification(e){e.actions=null,e.messages=null,e.notificationLevel=null,f.dispatch(Object(o.b)(this.pageId,this.name,e,this.contextToken))}clearNotification(e){const t="ClientApi.XrmDataControl.clearNotification";try{b.a.instance.reportCall(t);const n=!!this._clearControlNotification(e);return b.a.instance.reportSuccess(t),n}catch(e){const n=c.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(t,e,null,n),e}}setNotification(e,t){const n="ClientApi.XrmDataControl.setNotification";try{b.a.instance.reportCall(n);const a={uniqueId:t,messages:[e],priority:0,notificationLevel:"ERROR",actions:[{actions:[function(){}],message:""}]};return b.a.instance.reportSuccess(n),this.addNotification(a)}catch(e){const t=c.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),c.a.getInstance().reportFailure(n,e,null,t),e}}_isValidNotification(e){return!(!e||!e.messages||Object(p.b)(e.messages[0]))&&("RECOMMENDATION"===e.notificationLevel||"ERROR"===e.notificationLevel)}_reportAddNotificationEvent(e){if(!this._isValidNotification(e))return;const t=e.messages[0],n=new s("Added",this.contextToken.entityTypeName,this.getName(),t);var a;f.dispatch((a=n,{type:"report.xrm.event",execute(e,t){try{c.a.getInstance().reportEvent(a)}catch(e){const t="ClientApi.ReportXrmEventAction.reportXrmEvent";m.a.getInstance().eventManager.ReportComponentFailure(t,e),Object(l.j)(t,"XrmReporting")}return Promise.resolve()}}))}getEntityReference(){const e=this.formContext.entityReference,t=e.id?new g.a(e.id):null;return new i.a(e.entityType,t)}registerObserversForControlStateChange(){if(this.getName().startsWith("header_process")){const e=Object(a.a)(this.pageId);e&&this.controlStateObservable.registerObserver(e)}}getAttrDescriptor(e,t,n){const a=this.getEntityReference().etn;let r=Object(u.r)(f.getState(),a,this.name,this.pageId,this.contextToken);return r||(this.controlDescriptor?this.controlDescriptor.DataFieldName?(m.a.getInstance().traceManager.getTracer(e).warn("ControlAttributeDescriptor was not found, falling back to the attribute descriptor.",t),r=Object(d.a)(f.getState(),a,this.controlDescriptor.DataFieldName),r||(t.push({name:"attributeName",value:this.controlDescriptor.DataFieldName}),t.push({name:"entityName",value:a}),n.reportFailure(e,new Error("Attribute descriptor was not found"),t))):n.reportFailure(e,new Error("Control descriptor did not have a DataFieldName"),t):n.reportFailure(e,new Error("Control descriptor was not found"),t)),r}}},bJaF:function(e,t,n){"use strict";n.d(t,"a",(function(){return st}));var a,r=n("DRVD"),i=n.n(r),o=n("arV0"),s=n("TAjd"),c=n("uNu9"),l=n("uNLT"),u=n("tT9w"),d=n("ofgb"),h=n("+hq9"),g=n("Uv1Y"),p=n("SAYH"),m=n("+nNZ"),b=n("7tM0");!function(e){e[e.None=0]="None",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Failure=3]="Failure",e[e.Invalid=4]="Invalid"}(a||(a={}));class f{constructor(e,t){this._getState=e,this._processId=t}GenerateMessageForAction(e){let t="";const n="cc_MscrmControls.Containers.ProcessBreadCrumb/strings/ProcessControlResources",r=this._getState(),i=Object(b.a)(r,n,"ProcessControl_ActionExecuter_ExecutionTimeTooltip"),o=Object(b.a)(r,n,"ProcessControl_ActionExecuter_ErrorMessageTooltip"),s=Object(b.a)(r,n,"Crm_GenericErrorMessage");switch(e){case a.Completed:t=String.format(i,(new Date).toLocaleString());break;case a.Failure:t=String.format(i,(new Date).toLocaleString())+"\n"+String.format(o,s)}return t}GetActionMetadata(e){const t=Object(m.a)(this._getState(),new p.a(this._processId.guid));let n;return t&&t.businessProcessFlowActions&&t.businessProcessFlowActions[e]&&(n=t.businessProcessFlowActions[e]),n}InvokeProcessAction(e,t,n){return Xrm.Utility.invokeProcessActionInternal(e,n,t)}}var y=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function C(e){if(!e)return null;const t=function(e){const t=[];return e.forEach(e=>{const n={id:p.a.tryParse(e.Id),primaryField:e.PrimaryField,entityTypeCode:e.EntityTypeCode,entityLogicalName:e.EntityLogicalName,primaryKeyName:e.PrimaryKeyName};t.push(n)}),t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e.NavigationEntities);return{entityDisplayName:e.EntityDisplayName,entityLogicalName:e.EntityLogicalName,entityTypeCode:e.entityTypeCode,showCreate:e.ShowCreate,navigationEntities:t}}function _(e,t,n,a){return{type:"businessProcessFlow.retrieveNavigationEntities.async",execute:({dispatch:r,getState:i},o)=>function(e,t,n,a,r){return e.retrieveNavigationEntities(t,n,a,r,null).nativePromise().then(C,g.b)}(o.DataSource,e,t,n,a)}}var v=n("rodW"),S=n("bCAK"),O=n("LFkE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class I{constructor(e,t){this.Target=e,this.NewProcess=t}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j{constructor(e,t,n){this.Target=e,this.NewProcess=t,this.NewProcessInstance=n}getMetadata(){return{boundParameter:null,parameterTypes:{Target:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcess:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5},NewProcessInstance:{typeName:"Microsoft.Dynamics.CRM.crmbaseentity",structuralProperty:5}},operationName:"SetProcess",operationType:0}}}var P=n("w72X"),x=n("EHQq");function E(e,t,n,a,r,i){return{type:"businessProcessFlow.navigateToNextEntity.async",execute:({dispatch:o,getState:s},c)=>function(e,t,n,a,r,i,o){const s=new x.a(p.a.toLegacyGuid(t.id),t.etn,p.a.toLegacyGuid(n.id),n.etn,p.a.toLegacyGuid(a),r,p.a.toLegacyGuid(i),p.a.toLegacyGuid(o));return e.execute(s,null).nativePromise()}(c.DataSource,e,t,n,a,r,i)}}var w=n("sNgR");class T{constructor(e,t){this.EntityId=e,this.EntityLogicalName=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationName:"RetrieveProcessInstances",operationType:1}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A{constructor(e,t){this.EntityLogicalName=e,this.AppModuleId=t}getMetadata(){return{boundParameter:null,parameterTypes:{EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},AppModuleId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"RetrieveFilteredProcesses",operationType:1}}}var F=n("E5IU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N{constructor(e,t,n){this._name=e,this._uniqueName=t,this._workflowId=n}get workflowId(){return this._workflowId}set workflowId(e){this._workflowId=e}get uniqueName(){return this._uniqueName}set uniqueName(e){this._uniqueName=e}get name(){return this._name}set name(e){this._name=e}}var k=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M{get activeStageId(){return this._activeStageId}set activeStageId(e){this._activeStageId=e}set businessProcessInstanceId(e){this._businessProcessInstanceId=e}get businessProcessInstanceId(){return this._businessProcessInstanceId}get businessProcessInstanceName(){return this._businessProcessInstanceName}set businessProcessInstanceName(e){this._businessProcessInstanceName=e}get businessProcessState(){return this._businessProcessState}set businessProcessState(e){this._businessProcessState=e}get businessProcessStatus(){return this._businessProcessStatus}set businessProcessStatus(e){this._businessProcessStatus=e}get navigationEntities(){return this._navigationEntities}set navigationEntities(e){this._navigationEntities=e}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}get bpfDefinitionVersionNumber(){return this._bpfDefinitionVersionNumber}set bpfDefinitionVersionNumber(e){this._bpfDefinitionVersionNumber=e}}var D=n("sxfa");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{get id(){return this._id}set id(e){this._id=e}get primaryField(){return this._primaryField}set primaryField(e){this._primaryField=e}get entityTypeCode(){return this._entityTypeCode}set entityTypeCode(e){this._entityTypeCode=e}get entityLogicalName(){return this._entityLogicalName}set entityLogicalName(e){this._entityLogicalName=e}get primaryKeyName(){return this._primaryKeyName}set primaryKeyName(e){this._primaryKeyName=e}}var L,B=n("hvSt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Active=0]="Active",e[e.Inactive=1]="Inactive"}(L||(L={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class V{constructor(e){this._stageManager=e,this._populateTraversedPath()}getTraversedPath(){return this._traversedPath}_populateTraversedPath(){this._traversedPath=this._stageManager.globalPathAndActiveStage.traversedPath.path}}var G=n("blB4"),z=n("UuJw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class W extends Error{constructor(e){super(e),this.navigationStatus=G.a.invalid,this.stageInvalidReason=z.a.invalid,Object.setPrototypeOf(this,W.prototype)}}Error;class X extends Error{constructor(e){super(e),this.stageInvalidReason=z.a.unreachable,Object.setPrototypeOf(this,X.prototype)}}class H extends Error{constructor(e){super(e),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=z.a.dirtyForm,Object.setPrototypeOf(this,H.prototype)}}class U extends Error{constructor(e){super(e),this.navigationStatus=G.a.end,Object.setPrototypeOf(this,U.prototype)}}class q extends Error{constructor(e){super(e),this.navigationStatus=G.a.beginning,Object.setPrototypeOf(this,q.prototype)}}class Y extends Error{constructor(e){super(e),this.navigationStatus=G.a.stageGate,Object.setPrototypeOf(this,Y.prototype)}}class K extends Error{constructor(e){super(e),this.navigationStatus=G.a.invalidProcess,this.stageInvalidReason=z.a.invalidProcess,Object.setPrototypeOf(this,K.prototype)}}class Q extends Error{constructor(e){super(e),this.navigationStatus=G.a.dirtyForm,this.stageInvalidReason=z.a.dirtyForm,Object.setPrototypeOf(this,Q.prototype)}}var Z=n("odYE"),J=n("mL5Q"),$=n("f/sd"),ee=n("53SR"),te=n("nexV"),ne=n("quej"),ae=n("ijzp"),re=n("WY/A"),ie=n("sX6v"),oe=n("P+kM"),se=n("YYhu"),ce=n("srnJ"),le=n("5Oca"),ue=n("Dea/"),de=n("dHD5"),he=n("bT7G"),ge=n("e3W2"),pe=n("WePp");class me extends pe.a{constructor(e,t,n){super("BusinessProcessFlow_"+e),this.addEventParameter("ProcessId",t),this.addEventParameter("ProcessInstanceId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class be extends me{constructor(e,t){super("Initialized",e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class fe extends me{constructor(e,t,n){super("SetActiveStageEvent",e,t),this.addEventParameter("ActiveStageId",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ye extends me{constructor(e,t,n){super("DisplayStateEvent",e,t),this.addEventParameter("CurrentDisplayState",n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ce extends me{constructor(e,t,n,a){super("StatusEvent",e,t),this.addEventParameter("ProcessStatus",n),this.addEventParameter("CurrentDisplayState",a)}}var _e=n("uzi5"),ve=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Se{getMetadata(){return{boundParameter:"entity",operationName:"ExecuteWorkflow",operationType:0,parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.workflow",structuralProperty:5},EntityId:{typeName:"Edm.Guid",structuralProperty:1},InputArguments:{typeName:"Microsoft.Dynamics.CRM.InputArgumentCollection",structuralProperty:2}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Oe{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Value:{typeName:"Edm.String",structuralProperty:1}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ie{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Count:{typeName:"Edm.Int32",structuralProperty:1},IsReadOnly:{typeName:"Edm.Boolean",structuralProperty:1},Keys:{typeName:"Edm.String",structuralProperty:4},Values:{typeName:"mscrm.AnyComplexType",structuralProperty:4}}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class je{getMetadata(){return{boundParameter:null,operationName:null,operationType:null,parameterTypes:{Arguments:{typeName:"Microsoft.Dynamics.CRM.InputArgument",structuralProperty:2}}}}}var Pe,xe=n("+XGO"),Ee=n("mIxf"),we=n("AFlp"),Te=n("k1f1");!function(e){e[e.ProcessAction=0]="ProcessAction",e[e.TaskFlow=1]="TaskFlow",e[e.SyncWorkflow=2]="SyncWorkflow",e[e.AsyncWorkflow=3]="AsyncWorkflow",e[e.MessageAction=4]="MessageAction"}(Pe||(Pe={}));var Ae=n("D4Jo"),Fe=n("JF0K"),Ne=n("iZ7K"),ke=n("JP46");var Me=n("ghNp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var De=n("VcAV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Re{constructor(e,t){this._getState=e,this._applicationContext=t}setBpfInstance(e){return this._processInstance=e,this}setBpfInstanceName(e){return this._processInstanceName=e,this}setProcess(e){return this._process=e,this}setProcessId(e){return this._processId=e,this}setFormEntity(e){return this._formEntity=e,this}GetFlowStepMetadata(e,t){const n=t.TraceManager.getTracer("businessProcessFlow.flowStepManager"),a=this._processId&&this._processId.guid||null,r=Object(m.a)(this._getState(),p.a.tryParse(a));if(Object(De.c)(r))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined bpfDescriptor: "+r),null;const i=r.businessProcessFlowFlows;if(Object(De.c)(i))return n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined businessProcessFlowFlows: "+i),null;const o=i[e];return Object(De.c)(i)?(n.warn("Failure in FlowStepManager GetFlowStepMetadata: IsNullOrUndefined flowStepDescriptor: "+o),null):o}openFlowWidget(e,t){if(p.a.tryParse(e.flowStepId)===p.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStepId: "+e.flowStepId);const n=this._populateFlowDialogParams(e,t),a={height:600,width:600};Xrm.Navigation.openDialog("MicrosoftFlowsDialog",a,n)}_populateFlowDialogParams(e,t){const n=this.GetFlowStepMetadata(e.flowStepId,this._applicationContext);if(Object(De.c)(n))throw new Error("BPF Flow Step Failure: null metadata");const a={},r=n.flowId;if(Object(De.c)(r))throw new Error("BPF Flow Step Failure: null metadata.flowId");if(!this._processInstance&&!this._processInstance.id){const e=[];e.push(this._processInstance.id.guid);const t=JSON.stringify(e);a.entity_ids=t}a.flow_id=r,a.org_unique_name=Xrm.Utility.getGlobalContext().getOrgUniqueName(),a.bpf_step_id=e.flowStepId;const i=Xrm.Page.data.entity.getEntityName(),o=this._getState().metadata.entities[i].EntitySetName,s=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowDestinationUrl");a.entity_logical_collection_name=o,a.entity_logical_name=i,a.flows_destination_url=s,a.dynamics365_access_token=sessionStorage.getItem("dynamics365AccessToken");const c=Xrm.Utility.getGlobalContext().getAdvancedConfigSetting("MicrosoftFlowFirstPartyIntegrationSiteUrl");a.flows_fpi_site_url=c+"&flowsEnableWidgetV2=true",a.flows_authentication_string=this._getLocalizedLabel("SystemCustomization.SystemSettingsDialog.PreviewTab.IsMicrosoftFlowEnabled.AuthenticateButton.Text"),a.flows_enable_widget_v2=!0,Re.UpdateEventParameter(t,"flows_destination_url",s),Re.UpdateEventParameter(t,"flow_id",r),Object(De.c)(e.workflowLogId)||e.workflowLogId===p.a.EMPTY||(a.flows_wflog_id=p.a.toString(e.workflowLogId));const l=this._processInstance&&this._processInstance.id;if(Object(De.c)(l)||l===p.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceId: "+l);a.bpf_instance_id=p.a.toString(l);const u=this._processInstance&&this._processInstance.etn;if(Object(ve.b)(u))throw new Error("BPF Flow Step On-Click Failure: null or empty processInstanceEntityLogicalName: "+u);a.bpf_instance_entity_name=u;const d=this._processId&&this._processId.guid||null;if(p.a.tryParse(d)===p.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty processId: "+d);a.bpf_definition_id=d,a.bpf_definition_entity_name="workflow";const h=this._process&&this._process.get_Name();if(Object(ve.b)(h))throw new Error("BPF Flow Step On-Click Failure: null or undefined bpfDefinitionName: "+h);if(a.bpf_definition_name=h,Object(ve.b)(this._processInstanceName))throw new Error("BPF Flow Step On-Click Failure: null or undefined processInstanceName: "+this._processInstanceName);a.bpf_instance_name=this._processInstanceName;const g=e.selectedStage&&e.selectedStage.get_Description();if(Object(ve.b)(g))throw new Error("BPF Flow Step On-Click Failure: null or undefined flowStageName: "+g);a.bpf_flowstage_localized_name=g,a.bpf_flowstage_entity_name=i,a.bpf_flowstage_entity_collection_name=o;const m=this._formEntity&&this._formEntity.id;if(Object(De.c)(m)||m===p.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty flowStageRecordId: "+m);a.bpf_flowstage_entity_record_id=p.a.toString(m);const b=p.a.tryParseOrNull(e.activeStage&&e.activeStage.get_Id()||"");if(Object(De.c)(b)||b===p.a.EMPTY)throw new Error("BPF Flow Step On-Click Failure: null or empty activeStageId: "+b);a.bpf_activestage_id=p.a.toString(b);const f=e.activeStage&&e.activeStage.get_Description();if(Object(ve.b)(f))throw new Error("BPF Flow Step On-Click Failure: null or undefined activeStageName: "+f);return a.bpf_activestage_localized_name=f,a.bpf_activestageentity_name="processstage",a}_getLocalizedLabel(e){return Xrm.Utility.getResourceString("Main_system_library",e)}static getTelemetryParamsForFlowStep(e,t,n,a,r){const i=r||[],o={name:"flow_id",value:e},s={name:"environment_id",value:t},c={name:"flows_destination_url",value:n},l={name:"bpf_step_id",value:a};return i.push(o),i.push(s),i.push(c),i.push(l),i}static UpdateEventParameter(e,t,n){e&&0!==e.length&&e.some(e=>{if(e.name===t)return e.value=n,!0})}}var Le=n("Lyxw"),Be=n("7LBy"),Ve=n("ftQm"),Ge=n("2Ct/"),ze=n("84PK"),We=n("Exmh"),Xe=n("cfbi"),He=n("pF61");var Ue=n("8O0c"),qe=n("g6bs"),Ye=n("zmL5"),Ke=n("jq7Z"),Qe=n("xMtD"),Ze=n("7Sr4"),Je=n("1uZV"),$e=n("tICD"),et=n("E8F2"),tt=n("UqQu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const nt=i.a.createEvent("Initialize","BusinessProcessFlow.ProcessManager"),at=i.a.createEvent("SetActiveStage","BusinessProcessFlow.ProcessManager"),rt=i.a.createEvent("ValidateRequiredFields","BusinessProcessFlow.ProcessManager"),it=i.a.createEvent("CreateActiveStageSnapshot","BusinessProcessFlow.ProcessManager"),ot=i.a.createEvent("SaveFormAndActiveStage","BusinessProcessFlow.ProcessManager");class st{constructor(e,t,n,a,r){this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isUserSelectedStage=!1,this._isBpfFormValid=null,this._applicationContext=e,this._getState=t,this._dispatch=n,this._stageMetadata=a,this._activeStageManager=r}initilaizeWithProcessAndFormEntity(e,t,n,a,r,i){const o=nt.startStopwatch({processId:p.a.toString(a),processInstanceId:p.a.toString(r.id)});this._currentPageId=i,this._processId=a,this._version=t.businessProcessFlowProcessVersion,this._currentFormEntity=n,this._currentBpfInstance=r,this._stageMetadata.setPrimaryModel(this._currentFormEntity.etn),this._stageMetadata.setObjectModel(t);const s=this._createGlobalNavigationData(e);this._activeStageManager.InitGlobalPathAndActiveStage(s),this._stageMetadata.initializeDefaultPathManager(new V(this._activeStageManager),this),this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null;const c={};if(this._isUserSelectedStage)c.selectedStageId=p.a.tryParseOrNull(this.getSelectedStageId());else{const e=this.getActiveStageId();this._isActiveStageInCurrentEntity(e)?c.selectedStageId=p.a.tryParseOrNull(e):c.selectedStageId=this._getDefaultSelectedStageId()||p.a.tryParseOrNull(e)}this._dispatch(Object(ee.a)(c,this._currentBpfInstance));const l=new be(p.a.toString(a),p.a.toString(r.id));this._applicationContext.EventManager.ReportEvent(l),this._savedPageId!==i&&(this._savedPageId=i,this.getScriptContainerPromise().then(e=>{e&&e.getEventManager().addOnProcessChangeEvent(this.getContextToken(),()=>{this._saveCrossEntityBpf()})})),Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),this._actionStepManager=new f(this._getState,a),this._flowStepManager=new Re(this._getState,this._applicationContext).setBpfInstance(this._currentBpfInstance).setProcess(this.getProcess()).setProcessId(this.getProcessId()).setFormEntity(this._currentFormEntity).setBpfInstanceName(this.getProcessInstanceName()),this._instanceModifiedTimestamp=Object(m.f)(this._getState(),this._currentFormEntity),this._instanceModifiedTimestamp||(this._instanceModifiedTimestamp=(new Date).getTime()),Object(Ge.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const u=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Fe.g).error("ProcessManager is initialized with current entity as null",u)}Object(Ae.c)(Fe.g,u,this._applicationContext),o()}_saveCrossEntityBpf(){const e=this._getState(),t=Object(o.g)(e,this._currentPageId),n=Object(Be.a)(t),a=Object(Be.b)(t);if(n&&a){const e=new Z.a(t.data.parentrecordtype,new p.a(t.data.parentrecordid)),r=new Z.a(t.entityTypeName,t.id);this._dispatch(Object(we.b)(n,r)),this._dispatch(Object(Te.b)(a,r)),this.navigateToNextEntityForCrossEntityBpf(e,r,n,a)}}initilaizeWithFormEntityOnly(e,t){this._currentPageId=t,this._currentFormEntity=e,this._processId=null,this._version=-1,this._currentBpfInstance=null,this._customControlsPresent=!1,this._renderedFromFormXml=!1,this._isBpfFormValid=null,Object(Ge.f)(this._getState())||this._updateProcessInstanceModifiedTime(),Object(Ge.f)(this._getState())&&Ve.a.Instance.setProcessManagerByPageId(this._currentPageId,this);const n=this.getTelemetryParams();if(!this._currentFormEntity){this._applicationContext.TraceManager.getTracer(Fe.f).error("ProcessManager is initialized with current entity as null",n)}Object(Ae.c)(Fe.f,n,this._applicationContext)}setActiveProcess(e){return new Promise((t,n)=>{const a=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new g.a("Current form entity is not initialized.",2147877745);return Object(Ae.b)(Fe.m,e,null,a,this._applicationContext,null,this._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}const r=p.a.tryParseOrNull(e);if(!r)return Object(Ae.c)(Fe.m,a,this._applicationContext),void n(new Error("Invalid process id"));if(p.a.isNullOrEmpty(this.getCurrentFormEntity().id))return Object(Ae.c)(Fe.m,a,this._applicationContext),void n(new g.a("Not supported on new records",2147877748));const i=new I({id:p.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:p.a.toString(r),entityType:c.fc});this._dispatch(Object(P.b)(i)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcess"),Object(Ae.c)(Fe.m,a,this._applicationContext),t()},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e)),Object(Ae.b)(Fe.m,e,null,a,this._applicationContext,null,this._getState())})})}setActiveProcessInstance(e){return new Promise((t,n)=>{const a=this.getTelemetryParams();if(!this.getCurrentFormEntity()){const e=new g.a("Current form entity is not initialized.",2147877745);return Object(Ae.b)(Fe.n,e,null,a,this._applicationContext,null,this._getState()),void n(new g.a("Current form entity is not initialized",2147877745))}const r=p.a.tryParseOrNull(e);r?this.getProcessInstances().then(e=>{if(!e||!e.value)return void n(new Error("No process instances found for current entity"));let a="";for(const t of e.value)if(t&&t.businessprocessflowinstanceid&&t.businessprocessflowinstanceid.toLowerCase()===p.a.toString(r).toLowerCase()){a=t["a_processid_value".substring(1)];break}if(Object(ve.b)(a))return void n(new g.a("Supplied process instance does not match any existing instance on this entity",2147877744));const i=p.a.tryParseOrNull(a);if(!i)return void n(new Error("Invalid process id"));const o=new j({id:p.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn},{id:p.a.toString(i),entityType:c.fc},{id:p.a.toString(r),entityType:c.fc});this._dispatch(Object(P.b)(o)).then(()=>{this._executePostEvent("runOnProcessChange","setActiveProcessInstance"),t(a)},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e))})},e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>n(e))}):n(new Error("Invalid process instance id"))})}setCurrentInstance(e){this._currentBpfInstance=e}setStatus(e){return new Promise((t,n)=>{let a;if(e||n(new Error("setStatus can only be called with a valid status (active, finished, aborted")),e===B.a.Active)a=this.reactivateProcess();else if(e===B.a.Finished)a=this.completeProcess();else{if(e!==B.a.Aborted)return n(new Error("Invalid status passed to setStatus"));a=this.abandonProcess()}a.then(()=>{const n=new Ce(p.a.toString(this._processId),p.a.toString(this.getProcessInstanceId()),e,this.getDisplayState());this._applicationContext.EventManager.ReportEvent(n),t()},e=>{n(e)})})}setVisible(e){if(Object(ve.a)(this._currentBpfInstance)||Object(ve.a)(this._currentFormEntity)||Object(ve.a)(this._currentFormEntity.etn))return;const t=Object(de.h)(this._currentFormEntity.etn);this._dispatch(Object(ge.b)(this._currentPageId,_e.a,t,!0===e)),this._updateProcessInstanceModifiedTime()}isVisible(){if(!this._currentBpfInstance)return!1;const e=Object(de.h)(this._currentFormEntity.etn);return!0===Object(y.G)(this._getState(),{id:this._currentPageId,controlName:_e.a},e)}getCurrentFormEntity(){return this._currentFormEntity}getActiveStageEntityRef(){const e=this._getStage(this.getActiveStageId()),t=e&&e.get_parent()&&e.get_parent().get_Name()||null,n=this._getNavigationEntityIdsByEntityLogicalName();return t&&n&&n.hasOwnProperty(t)?new Z.a(t,n[t]):null}getProcess(){return this._currentBpfInstance&&this._stageMetadata.getProcessObjectModel()}getProcessInstanceName(){return this._currentBpfInstance&&Object(S.e)(this._getState(),this._currentBpfInstance)}getTraversedPath(){return Object(S.h)(this._getState(),this._currentBpfInstance)}getProcessId(){return this._processId}getVersion(){return this._version}getProcessInstanceId(){return this._currentBpfInstance&&this._currentBpfInstance.id}getBpfEntityLogicalName(){return this._currentBpfInstance&&this._currentBpfInstance.etn}getEntityStages(){return this._stageMetadata.getEntityStages()}getActiveStage(){return this._getStage(this.getActiveStageId())}getProcessInstances(){return new Promise((e,t)=>{var n,a;this._dispatch((n=this._currentFormEntity.id,a=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveProcessInstancesRequest.async",execute({dispatch:e,getState:t},r){const i=r.DataSource.get_WebAPIService(),o=new T(n,a),s=Object(w.a)(t(),o);return i.sendRequest(s).then(e=>e.json(),g.b)}})).then(t=>{e(t)},e=>{t(e)})})}getSelectedStage(){return this._getStage(this.getSelectedStageId())}isCrossEntityNavigation(e){const t=e?this._stageMetadata.getNextStageId(this.getActiveStageId()):this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!t)return!1;const n=this._stageMetadata.getStage(t);if(!n)return!1;const a=n.get_parent();return this._currentFormEntity&&this._currentFormEntity.etn&&a&&a.get_EntityLogicalName()!==this._currentFormEntity.etn}_isStageOnPath(e,t){for(const n of t)if(p.a.equals(n,e))return!0;return!1}getProcessState(){const e=Object(m.a)(this._getState(),this.getProcessId());return e?e.businessProcessFlowProcessState:null}getState(){if(this._currentBpfInstance){const e=Object(S.f)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getStatusName(){if(this._currentBpfInstance){const e=Object(S.g)(this._getState(),this._currentBpfInstance);if(e){return e.label}}return null}getStatus(){if(this._currentBpfInstance){const e=Object(S.g)(this._getState(),this._currentBpfInstance);if(e){const t=parseInt(e.valueString,10);return isNaN(t)?null:t}}return null}getActiveStageId(){if(this._currentBpfInstance){let e=this._currentBpfInstance&&Object(S.a)(this._getState(),this._currentBpfInstance);if(p.a.isNullOrEmpty(e)&&this._currentBpfInstance&&this._activeStageManager&&this._activeStageManager.globalPathAndActiveStage){const t=this._activeStageManager.globalPathAndActiveStage.stageId;t&&(e=p.a.tryParseOrNull(t))}if(!p.a.isNullOrEmpty(e)){const t=this.getActivePath();if(t&&t.length>0)return this._isStageOnPath(e,t)?e.guid:t[0].guid}}return null}getActivePathStages(){const e=this.getActivePath();if(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=this._getStage(e[n].guid);return t}return null}getActivePath(){if(!this._currentBpfInstance)return null;let e=Object(O.c)(this._getState(),this.getProcessInstanceId());return e||(e=this._getDefaultActivePath()),e}getDisplayState(){return this._currentBpfInstance?Object(O.d)(this._getState())||s.a.getDefaultDisplayState():null}getSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(O.g)(this._getState(),this.getProcessInstanceId());return e?e.guid:this.getActiveStageId()}_getDefaultSelectedStageId(){if(!this._currentBpfInstance)return null;const e=Object(O.g)(this._getState(),p.a.EMPTY);return e&&!this._stageMetadata.getStage(e.guid)?null:e}_isActiveStageInCurrentEntity(e){try{return this._stageMetadata.getStage(e).get_parent().get_Name()===this._currentFormEntity.etn}catch(e){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager._isActiveStageInCurrentEntity",e)}return!0}getStageMetadata(){return this._stageMetadata}isBusinessProcessAborted(){return this.getStatus()===B.a.Aborted}isBusinessProcessCompleted(){return this.getStatus()===B.a.Finished}moveToNextStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(ve.a)(this._currentBpfInstance))return t(new g.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!n)return void t(new U("Last stage in the active path reached. Next stage does not exist."));e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._saveFormDataAndActiveStage(p.a.tryParseOrNull(n),0,"MoveToNextStage")))});return t.then(()=>{Object(Ae.c)(Fe.h,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(Ae.c)(Fe.h,e,this._applicationContext):Object(Ae.b)(Fe.h,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}moveToPreviousStage(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>{if(Object(ve.a)(this._currentBpfInstance))return t(new g.a("Process Control does not exist on form.",2147877746));const n=this._stageMetadata.getPreviousStageId(this.getActiveStageId());if(!n)return t(new q("The first stage in the traversed path reached. Previous stage does not exist."));e(this._saveFormDataAndActiveStage(p.a.tryParseOrNull(n),1,"MoveToPreviousStage"))}).then(()=>{this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(this.getActiveStageId())});return t.then(()=>{Object(Ae.c)(Fe.i,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(Ae.c)(Fe.i,e,this._applicationContext):Object(Ae.b)(Fe.i,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}setActiveStage(e){const t=at.startStopwatch({processId:p.a.toString(this.getProcessId()),processInstanceId:p.a.toString(this.getProcessInstanceId()),stageId:e}),n=this.getTelemetryParams(),a=new Promise((t,n)=>{const a=p.a.tryParseOrNull(e),r=this.getTraversedPath();if(Object(ve.a)(this._currentBpfInstance))return n(new g.a("Process Control does not exist on form.",2147877746));if(!a)return n(new W("setActiveStage can only be called with a valid stage id"));if(!this._stageMetadata.getStage(a.guid))return n(new W("stage id does not exist on any path of the instance"));if(!r)return n(new W("Traversed Path is not present"));if(this.getActiveStageId()===a.guid)return t();const i=new D.a(r);if(!i||!i.isInTraversedPath(e)){return n(this.getActivePath().some(e=>p.a.equals(e,a))?new W("The stage is not in traversed path. Only navigating backwards is supported."):new X("stage id does not exist on the current acitve path of the instance."))}t(this._saveFormDataAndActiveStage(a,1,"SetActiveStage"))}).then(()=>{const t=new fe(p.a.toString(this._processId),p.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t),this._stageMetadata.getDefaultPathManager().triggerSubsequentDefaultPathCalculation(e)});return a.then(()=>{t(),Object(Ae.c)(Fe.o,n,this._applicationContext)},e=>{t(),this._shouldReportErrorAsSuccess(e)?Object(Ae.c)(Fe.o,n,this._applicationContext):Object(Ae.b)(Fe.o,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),a}switchProcess(){}abandonProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(ve.a)(this._currentBpfInstance)?t(new g.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessAborted()?e():void e(this._updateStateAndStatusOfProcess(B.a.Aborted,L.Inactive,"AbandonProcess")));return t.then(()=>{Object(Ae.c)(Fe.a,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(Ae.c)(Fe.a,e,this._applicationContext):Object(Ae.b)(Fe.a,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}reactivateProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(ve.a)(this._currentBpfInstance)?t(new g.a("Process Control does not exist on form.",2147877746)):this.getStatus()===B.a.Active?e():void e(this._updateStateAndStatusOfProcess(B.a.Active,L.Active,"ReactivateProcess")));return t.then(()=>{Object(Ae.c)(Fe.j,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(Ae.c)(Fe.j,e,this._applicationContext):Object(Ae.b)(Fe.j,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}completeProcess(){const e=this.getTelemetryParams(),t=new Promise((e,t)=>Object(ve.a)(this._currentBpfInstance)?t(new g.a("Process Control does not exist on form.",2147877746)):this.isBusinessProcessCompleted()?e():p.a.tryParseOrNull(this._stageMetadata.getNextStageId(this.getActiveStageId()))?t(new g.a("Attempt to finish a process not on last stage.",2148081666)):void e(this._saveMainFormIfImmersiveBpfAndNewRecord().then(()=>this._updateStateAndStatusOfProcess(B.a.Finished,L.Inactive,"CompleteProcess"))));return t.then(()=>{Object(Ae.c)(Fe.c,e,this._applicationContext)},t=>{this._shouldReportErrorAsSuccess(t)?Object(Ae.c)(Fe.c,e,this._applicationContext):Object(Ae.b)(Fe.c,t,null,e,this._applicationContext,this.getCurrentFormEntity(),this._getState())}),t}_shouldReportErrorAsSuccess(e){return e instanceof K||(e instanceof Y||(e instanceof U||(e instanceof q||(e instanceof W||(e instanceof X||e instanceof Q)))))}triggerActionStepClick(e){if(Object(ve.b)(e)){const e=new Error("BPF Action Step Failure: null ControlId");throw Object(Ae.b)(Fe.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const t=this._actionStepManager.GetActionMetadata(e);if(Object(ve.a)(t)){const e=new Error("BPF Action Step Failure: null metadata");throw Object(Ae.b)(Fe.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}const n=this._getState();if(Object(ve.a)(n)){const e=new Error("BPF Action Step Failure: null state");throw Object(Ae.b)(Fe.b,e,null,this.getTelemetryParams(),this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}let a=this._getTelemetryParamsForActionStep(t.actionType,e,t.actionId);try{const n=new p.a(t.actionId);if(t.actionType===Pe.AsyncWorkflow||t.actionType===Pe.SyncWorkflow){const r=["BusinessProcessFlowId","BusinessProcessFlowInstanceId","ActionStepId"],i=[this._processId.guid,p.a.toString(this.getProcessInstanceId()),n.guid].map(e=>{const t=new Oe;return t.Type="System.String",t.Value=e,t}),o=new Ie;o.Keys=r,o.Values=i,o.Count=3,o.IsReadOnly=!0;const s=new je;s.Arguments=o;const c=new Se;c.EntityId=this._currentFormEntity.id,c.InputArguments=s,c.entity={id:t.workflowId,entityType:"workflow"},this.UpdateActionLog(n,1),this._dispatch(Object(P.b)(c)).then(()=>{Object(xe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2)),Object(Ae.c)(Fe.b,a,this._applicationContext)},t=>{Object(xe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(Ae.b)(Fe.b,t,null,a,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()})}else if(t.actionType===Pe.ProcessAction){const r=t=>{Object(xe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3)),Object(Ae.b)(Fe.b,t,null,a,this._applicationContext,this.getCurrentFormEntity(),this._getState()),this._dispatch(Object(u.b)(t,!0)).then()},i=r=>{Object(xe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,2,this._actionStepManager.GenerateMessageForAction(2));const i=r.get_outputParameters();t.outputBindings.forEach(e=>{if(e.parameterName in i){const t=i[e.parameterName],n=e.boundAttributeName,a={};a[n]={key:n,value:t},this._dispatch(Object(Ee.a)(this._currentPageId,a,!1,!0,this._currentFormEntity.etn,this._currentFormEntity.id.guid,null,this.getContextToken()))}}),Object(Ae.c)(Fe.b,a,this._applicationContext)},o=a=>{if(a=a?a.parameters:{},this._filterInputArguments(a)){const e={id:p.a.toString(this.getCurrentFormEntity().id),entityType:this.getCurrentFormEntity().etn};a.Target=e,a.BusinessProcessFlowId=this._processId.guid,a.BusinessProcessFlowInstanceId=p.a.toString(this.getProcessInstanceId()),a.ActionStepId=t.actionId,this._actionStepManager.InvokeProcessAction(t.uniqueName,t,a).then(i,r)}else Object(xe.a)(this._currentPageId,this.getContextToken(),e),this.UpdateActionLog(n,3,this._actionStepManager.GenerateMessageForAction(3))},s={};t.inputBindings.forEach(e=>{const t=Object(k.c)(Object(le.j)(this._getState(),this.getCurrentFormEntity(),e.boundAttributeName));s["ProcessUnification_Arguments_"+e.parameterName]=t}),this._addInputParametersToParamList(t.inputParameters,s),this.UpdateActionLog(n,1),Xrm.Navigation.openDialog(t.workflowId,this._getDialogOptions(),s).then(o,r)}}catch(e){throw 0===a.length&&(a=this.getTelemetryParams()),Object(Ae.b)(Fe.b,e,null,a,this._applicationContext,this.getCurrentFormEntity(),this._getState()),e}}triggerFlowStepClick(e,t){t=t;const n=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams());try{const t=p.a.newGuid(),a={activeStage:this.getActiveStage(),selectedStage:this.getSelectedStage(),flowStepId:e,workflowLogId:t};this._flowStepManager.openFlowWidget(a,n),this.UpdateActionLog(new p.a(e),1,void 0,t);const r=this.getActionLog(new p.a(e));this.createWorkflowLogRecord(r),Object(Ae.c)(Fe.d,n,this._applicationContext)}catch(e){Object(Ae.b)(Fe.d,e,null,n,this._applicationContext,this.getCurrentFormEntity(),this._getState())}}refreshFlowStepClick(e){const t=Re.getTelemetryParamsForFlowStep(null,null,null,e,this.getTelemetryParams()),n=this._dispatch(Object(Ue.a)(this._processId,this._currentBpfInstance));Promise.resolve(n).then(()=>{this._updateProcessInstanceModifiedTime(),Object(Ae.c)(Fe.k,t,this._applicationContext)}).catch(e=>{Object(Ae.b)(Fe.k,e,null,t,this._applicationContext,this.getCurrentFormEntity(),this._getState())})}_addInputParametersToParamList(e,t){for(const n of Object.keys(e))"ProcessUnification_Arguments_"+e[n].parameterName in t||(t["ProcessUnification_Arguments_"+e[n].parameterName]=null)}_filterInputArguments(e){if(e&&"last_button_clicked"in e&&"ok_id"===e.last_button_clicked){const t="ProcessUnification_Arguments_";for(const n in e){const a=e[n];if(n.startsWith(t)){e[n.substring(t.length,n.length)]=a}delete e[n]}return!0}return!1}_getDialogOptions(){return{height:450,width:450,position:1}}_createSnapshotRequest(e,t){if(!e)throw new Error("Active stage cannot be null or undefined.");const n=new Z.a("processstage",e),a=this._calculateNewTraversedPath(e),r={activestageid:{reference:n,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:e.guid}},traversedpath:{value:a,timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}}};return this._addFieldsToBPFSnapshotForCreate(r,t)}_addFieldsToBPFSnapshotForCreate(e,t){if(!e||!this._hasBpfInstance())return e;const n=Object(qe.b)(this._getState(),this._currentFormEntity.etn,this._currentBpfInstance.etn);return n&&(e[n.ReferencingAttribute]={reference:new Z.a(this._currentFormEntity.etn,t),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}),e.processid={reference:new Z.a("workflow",this.getProcessId()),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}},e}generateBPFInstanceSnapshotId(){if(this.isImmersiveBPF()||!Object(Le.c)(this._getState(),"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;let e=[],t=null;try{const n=Object(y.ac)(this._getState(),this._currentPageId,this.getContextToken()),a=Object(he.b)(this._getState(),n);let r=a.identifier&&a.identifier.id||this._currentFormEntity.id;const i=Object(o.g)(this._getState(),this._currentPageId);if(Object(qe.e)(i))return Object(qe.f)(this._getState(),n,r,this._dispatch),null;if(!this._hasBpfInstance()||p.a.isNullOrEmpty(this.getProcessId()))return null;if(e=this.getTelemetryParams(),Object(qe.d)(this._getState(),a.identifier,this._currentPageId))return Object(qe.f)(this._getState(),n,r,this._dispatch),null;p.a.isNullOrEmpty(r)&&(r=p.a.newGuid(),Object(qe.f)(this._getState(),n,r,this._dispatch)),t=this._createActiveStageSnapshot(p.a.tryParse(this.getActiveStageId()),r);const s=Object(he.b)(this._getState(),t);e.push({name:"SnapshotId",value:t}),e.push({name:"Snapshot active changes",value:s&&s.activeChanges&&Object.keys(s.activeChanges).map(e=>"Property: "+e).join("; ")}),this._applicationContext.EventManager.ReportComponentSuccess("ProcessManager.generateBPFInstanceSnapshotId",e)}catch(t){this._applicationContext.EventManager.ReportComponentFailure("ProcessManager.generateBPFInstanceSnapshotId",t,null,e)}return t}_calculateNewTraversedPath(e){let t="";for(const n of this.getActivePath())if(t+=","+n.guid,p.a.equals(n,e))return t.substring(1);return t+=","+e.guid,t.substring(1)}_createActiveStageSnapshot(e,t){const n=this._createSnapshotRequest(e,t),a=it.startStopwatch({processId:p.a.toString(this.getProcessId()),processInstanceId:p.a.toString(this.getProcessInstanceId())});let r=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(this.isImmersiveBPF()&&!Object(ve.a)(r)){const e=Object(ie.b)(this._getState(),r.snapshotId,n);return this._dispatch(e),r=Object(he.c)(this._getState(),this.getCurrentFormEntity()),a(),r.snapshotId}const i=Object(de.h)(this._currentFormEntity.etn),o=Object(de.x)(i),s=Object(re.b)(this._getState(),this._currentBpfInstance,n,o,this._hasBpfInstance()?ue.a.Create:ue.a.Update),c=s.payload.snapshotId;return this._dispatch(s),a(),c}_hasBpfInstance(){return!this._currentBpfInstance||p.a.isNullOrEmpty(this._currentBpfInstance.id)}_updateStateAndStatusOfProcess(e,t,n){return new Promise((a,r)=>{const i=this._createStatusAndStateUpdateRequest(e,t);let o=Object(he.c)(this._getState(),this.getCurrentFormEntity()),s=null;if(this.isImmersiveBPF()&&!Object(ve.a)(o)){const e=Object(ie.b)(this._getState(),o.snapshotId,i);this._dispatch(e),o=Object(he.c)(this._getState(),this.getCurrentFormEntity())}else{const e=Object(de.h)(this.getCurrentFormEntity().etn),t=Object(de.x)(e),n=Object(re.b)(this._getState(),this._currentBpfInstance,i,t);s=n.payload.snapshotId,this._dispatch(n)}if(!this.executePreEvent("runOnPreProcessStatusChange",n,null,e))if(this._shouldPerformFormSave()){const t=this._validateSnapshot(o).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>this._saveFormEntityAndBPFEntitySnapshots(s,o,!1)).then(()=>{this._executePostEvent("runOnProcessStatusChange",n,null,e)}).catch(e=>{const t=Object(g.c)(e);return this._handleDuplicateDetection(t,s)}).catch(e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>r(e))});a(t)}else this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>{let t=null;t=this.isImmersiveBPF()&&!Object(ve.a)(o)?o.snapshotId:s;this._dispatch(Object(se.c)(t,!0,["statuscode","statecode","activestagestartedon","completedon"])).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh())).then(()=>{this._updateProcessInstanceModifiedTime(),this._executePostEvent("runOnProcessStatusChange",n,null,e)}),a()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>r(e))})});a()})}_validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(e){return new Promise((t,n)=>{if("CompleteProcess"===e||"MoveToNextStage"===e){const t=this.ValidateRequiredFieldsForNavigation();if(t&&!t.isValid)if("MoveToNextStage"===e)n(new Y("Unable to navigate to next stage as required fields have not been set"));else{if("CompleteProcess"===e)return n(new Y("Unable to complete process as required fields have not been set"));n(new Error("validation failed for unexpected BPF operation: "+e))}}return t()})}_saveFormChangesBeforeNavigation(){if(this._shouldPerformFormSave()){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity());return this._validateSnapshot(e).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures("MoveToNextStage")).then(()=>{const t=this._getColumnsToRefresh();return this._dispatch(Object(se.c)(e.snapshotId,!0,t))}).catch(t=>(this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(t,e.snapshotId),this._dispatch(Object(u.b)(t,!0))))}return Promise.resolve()}_shouldPerformFormSave(){const e=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ShouldPerformFormSave"),t=this.getTelemetryParams(),n=this._getState();if(Object(y.kb)(n,{id:this._currentPageId},this.getContextToken()))return e.info("Skip main form save for BPF state or stage change due to read only form",t),!1;const a=this._dispatch(Object(Me.b)(this._currentPageId,this.getContextToken()));if(a&&a.data&&a.data.getIsDirty){const n=a.data.getIsDirty(),r={name:"shouldPerformMainFormSave",value:n};return t.push(r),e.info("Checking if main form save should be performed due to dirty form",t),n}return e.error("Unable to determine dirty state of main form - skipping save of main form",t),!1}_saveMainFormIfImmersiveBpfAndNewRecord(){const e=Object(o.l)(this._getState(),this._currentPageId);if(this.isImmersiveBPF()&&e===Xe.a&&p.a.isNullOrEmpty(this.getCurrentFormEntity().id)){const t=1;return this._dispatch(Object(l.f)(this._currentPageId,e,!1,t,!1,!1)).then(e=>{this._currentFormEntity=e})}return Promise.resolve(void 0)}_validateSnapshot(e){return new Promise((t,n)=>{const a=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation"),r=this._getSnapshotStateTelemetryParams(e),i=this._currentPageId,o=this.getContextToken();this._dispatch(this._getEventManager().runOnSave(o,1))&&(this._dispatch(Object(d.b)(i,o,2)),this._dispatch(Object(h.b)(i,o,!1)),a.warn("BPF ProcessManager: Unable to save form data due to web resource registered onSave invoking preventDefault",r),n(new g.a("Unable to save form data due to web resource registered onSave invoking preventDefault",2147877737)));for(const t in e.activeChanges){const i=e.activeChanges[t],o=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(e.identifier.etn,t),s=Object(ve.a)(o)?null:o.get_logicalName(),c=Object(ve.a)(o)?ze.a.get_empty():o.get_id();if(Object(ve.a)(i))return a.error("BPF ProcessManager: unexpected null or undefined fieldValue for attribute "+s+" with ID: "+c,r),n(new Error("Internal Client Error - null fieldValue"));const l=i.validationResult;if(Object(ve.a)(l)){if(s===ke.c){a.info("BPF ProcessManager: skipping formEntitySnapshot validation for atttribute: "+s+" with ID: "+c,r);continue}return a.error("BPF ProcessManager: unexpected null or undefined validationResult for atttribute: "+s+" with ID: "+c,r),n(new Error("Internal Client Error - null validatorResult"))}const u=l.isValueValid;if(Object(ve.a)(u))return a.error("BPF ProcessManager: unexpected null or undefined validationResult.isValidValue for atttribute: "+s+" with ID: "+c,r),n(new Error("Internal Client Error - null validationResult.isValidValue"));if(!u){const e={name:Fe.q,value:"clientSideCurrentForm"};return r.push(e),a.warn("BPF ProcessManager: unable to save form due to invalid value for attribute: "+s+" with ID: "+c,r),n(new H("Unable to save form data due to validation errors"))}}return t(!0)})}_createStatusAndStateUpdateRequest(e,t){return{statuscode:{label:B.a[e],valueString:e.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}},statecode:{label:L[t],valueString:t.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null}}}}ValidateRequiredFieldsForNavigation(){const e=rt.startStopwatch({processId:p.a.toString(this.getProcessId()),processInstanceId:p.a.toString(this.getProcessInstanceId())}),t=this._getState(),n=this._stageMetadata.getRequiredAttributesForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),a=this._stageMetadata.getRequiredFlowStepsForStage(this.getActiveStageId(),this._currentPageId,this.getContextToken(),t),r={emptySteps:[],errorSteps:[]},i=Object(he.c)(this._getState(),this.getCurrentFormEntity()),s=this._getSnapshotStateTelemetryParams(i),c=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SnapshotValidation");for(const e of n){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: validating attribute: "+e,s);let t=Object(le.j)(this._getState(),this.getCurrentFormEntity(),e);i&&i.activeChanges&&e in i.activeChanges&&(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: fieldIsDirty: "+e,s),t=i.activeChanges[e]);Object(O.h)(t,this._getState(),this.getCurrentFormEntity().etn,e)?(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: emptyField: "+e,s),r.emptySteps.push(e)):t.validationResult.isValueValid||(c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: !fieldValue.validationResult.isValueValid: "+e,s),r.errorSteps.push(e))}for(const e of a){const t=p.a.tryParse(e);if(p.a.isNullOrEmpty(t)){c.error("BPF ProcessManager ValidateRequiredFieldsForNavigation: invalid Flow Step ID GUID: "+e,s);continue}const n=this.getActionLog(t);if(n){const t=n.status;2!==t&&(c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". The Flow Step Action Log has stauts of : "+t,s),r.errorSteps.push(e))}else c.info("BPF ProcessManager ValidateRequiredFieldsForNavigation: Required Flow Step not completed for stepId "+e+". No action logs were found for this Flow Step",s),r.errorSteps.push(e)}r.isValid=0===r.emptySteps.length&&0===r.errorSteps.length;const u=Object(Ke.a)(t,this._currentPageId);if(!Object(y.Gb)(u,t,this._currentPageId,this.getContextToken())){c.warn("BPF ProcessManager ValidateRequiredFieldsForNavigation: form is not valid - "+this._currentPageId,s);const e=Object(o.l)(this._getState(),this._currentPageId);this._dispatch(Object(l.f)(this._currentPageId,e,!1,1,!1,!1)),r.isValid=!1}if(!r.isValid){const e=String.format("BPF ProcessManager: ValidateRequiredFieldsForNavigation returned invalid");c.warn(e,s)}return e(),r}setSelectedStage(e,t=!1){return new Promise((n,a)=>{const r=p.a.tryParseOrNull(e);if(!r)return a("setSelectedStage can only be called with a valid stage id");const i={selectedStageId:r};this._updateBusinessProcessFlowData(this._currentBpfInstance,i),this._isUserSelectedStage=t,t&&this._executePostEvent("runOnStageSelected","setSelectedStage"),n()})}setDisplayState(e){if(this._currentBpfInstance&&(e===s.a.collapsed||e===s.a.expanded||e===s.a.floating)){this._updateDisplayState(this._currentBpfInstance,e);const t=new ye(p.a.toString(this._processId),p.a.toString(this.getProcessInstanceId()),e);this._applicationContext.EventManager.ReportEvent(t)}}setActivePath(e){if(!e||0===e.length)return;const t=[];for(let n=0;n<e.length;n++)t[n]=new p.a(e[n]);const n={activePath:t};this._updateBusinessProcessFlowData(this._currentBpfInstance,n)}setBpfNavigationBehavior(e){const t={processNavigationBehavior:{navigationBehavior:e,navigationBehaviorPageId:this._currentPageId}};this._updateBusinessProcessFlowData(this._currentBpfInstance,t)}getBpfNavigationBehavior(){return this._currentBpfInstance&&Object(O.e)(this._getState(),this.getProcessInstanceId())}shouldReInitializeNavigationBehavior(){return!(!this._currentBpfInstance||!(null==this.getBpfNavigationBehavior()&&Object(ve.a)(Object(O.b)(this._getState(),this.getProcessInstanceId()))||Object(O.f)(this._getState(),this.getProcessInstanceId())!==this._currentPageId))}getBpfNavigationBehaviorAllowCreateNew(e){const t=this._currentBpfInstance&&Object(O.b)(this._getState(),this.getProcessInstanceId());return!t||!e||t(e)}createWorkflowLogRecord(e){if(Object(ve.a)(e))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined actionLog");const t=this._getState();if(Object(ve.a)(t))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined state");const n=t.metadata;if(Object(ve.a)(n))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined metadata");const a=n.entities;if(Object(ve.a)(a))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined entities");const r=this._currentBpfInstance.etn;if(Object(ve.b)(r))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entityLogicalName");const i=a[r];if(Object(ve.a)(i))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined bpfEntity");const o=i.EntitySetName;if(Object(ve.b)(o))throw new Error("BPF Create WorkflowLog Record Failure: null or empty entitySetName");const s=Object(Ne.z)(t,"workflowlog",i.EntityLogicalName,"asyncoperationid");if(Object(ve.a)(s))throw new Error("BPF Create WorkflowLog Record Failure: null or undefined relationshipMetadata");if(Object(ve.b)(s.ReferencingEntityNavigationPropertyName))throw new Error("BPF Create WorkflowLog Record Failure: null or empty relationshipMetadata.ReferencingEntityNavigationPropertyName");const c=s.ReferencingEntityNavigationPropertyName+"@odata.bind",l="/"+o+"("+e.processInstanceid.guid+")",u={workflowlogid:e.actionLogId.guid,stepname:e.stepId.guid,[c]:l,activityname:e.processDefinitionid.guid,status:e.status};Xrm.WebApi.createRecord("workflowlog",u)}_getTracer(){return Object(ve.a)(this._applicationContext)||Object(ve.a)(this._applicationContext.TraceManager)?null:this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManager")}_getDefaultActivePath(){const e=this._getTracer();if(Object(ve.a)(this._stageMetadata))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined _stageMetadata"),null;const t=this._stageMetadata.getDefaultPathManager();if(Object(ve.a)(t))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined defaultPathManager"),null;const n=t.getDefaultPath();if(Object(ve.a)(n))return e&&e.error("ProcessManager _getDefaultActivePath method: NullOrUndefined stringPath"),null;const a=[];for(const e in n){const t=p.a.parse(n[e]);a.push(t)}return a}_updateBusinessProcessFlowData(e,t){e&&(this._dispatch(Object(ee.a)(t,e)),this._updateProcessInstanceModifiedTime())}_updateDisplayState(e,t){this._dispatch(Object(te.a)(t,e)),this._updateProcessInstanceModifiedTime()}getForwardNavigationEntities(e,t,n,a){return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(_(e,t,n,a||null)))}navigateToNextEntity(e,t,n,a){return new Promise((r,i)=>{const o=this.ValidateRequiredFieldsForNavigation();if(o&&!o.isValid)return i(new Y("Unable to navigate to next stage as required fields have not been set"));const s=this._stageMetadata.getNextStageId(this.getActiveStageId());if(!s)return i(new U("Last stage in the active path reached. Next stage does not exist."));const c=new p.a(s),l=this.getTraversedPath()+","+s;return this._saveFormChangesBeforeNavigation().then(()=>this._dispatch(E(e,t,c,l,n,a))).then(()=>this.setSelectedStage(s)).then(()=>{this._executePostEvent("runOnStageChange","navigateToNextEntity",0),r()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))})})}navigateToNextEntityForCrossEntityBpf(e,t,n,a){return new Promise((r,i)=>{this._dispatch(E(e,t,new p.a(this.getActiveStageId()),this.getTraversedPath(),n,a)).then(()=>{this._dispatch(Object(ae.b)(t,this._currentBpfInstance)),this._executePostEvent("runOnStageChange","navigateToNextEntityForCrossEntityBpf",0),r()}).catch(e=>{this._dispatch(Object(u.b)(e,!0)).then(()=>i(e))})})}getActiveStageActiveFor(){if(this._currentBpfInstance){const e=Object(S.b)(this._getState(),this._currentBpfInstance);if(e){return(new Date).valueOf()-e.valueOf()}}return null}getBpfInstanceActiveFor(){if(this._currentBpfInstance){const e=Object(S.d)(this._getState(),this._currentBpfInstance);if(e)return(new Date).valueOf()-e.valueOf()}return null}getBpfInstanceCompletedIn(){if(this._currentBpfInstance){const e=Object(S.d)(this._getState(),this._currentBpfInstance),t=Object(S.c)(this._getState(),this._currentBpfInstance);if(t&&e)return t.valueOf()-e.valueOf()}return null}getActionLogCollection(){return this._currentBpfInstance?Object(O.a)(this._getState(),this.getProcessInstanceId()):null}getActionLog(e){const t=this.getActionLogCollection();return t&&t[e.guid]?t[e.guid]:null}UpdateActionLog(e,t,n,a){if(!this._currentBpfInstance)return null;const r=Object(O.a)(this._getState(),this.getProcessInstanceId()),i=r&&r[e.guid]?r[e.guid]:null;let o=p.a.EMPTY;o=Object(ve.a)(a)||a===p.a.EMPTY?i?i.actionLogId:p.a.newGuid():a;const s={actionLogId:o,status:t,modifiedOn:(new Date).toLocaleString(),stepId:e,processDefinitionid:this._processId,processInstanceid:this.getProcessInstanceId(),message:n},c=Object.assign({},r);c[e.guid]=s;const l={actionLogCollection:c};return this._updateBusinessProcessFlowData(this._currentBpfInstance,l),"success"}getEnabledProcesses(){const e=[];return new Promise((t,n)=>{var a;this._currentFormEntity&&this._currentFormEntity.etn?this._dispatch((a=this._currentFormEntity.etn,{type:"businessProcessFlow.retrieveFilteredProcesses.async",execute({dispatch:e,getState:t},n){const r=n.DataSource.get_WebAPIService(),i=t(),o=p.a.tryParse(Object(F.i)(i)),s=new A(a,o),c=Object(w.a)(t(),s);return r.sendRequest(c).then(e=>e.json(),g.b)}})).then(n=>{for(const t of n.value)e.push(new N(t.name,t.uniquename,t.workflowid));t(e)},e=>{n(e)}):n(new g.a("Current Form Entity cannot be NULL",2147877745))})}getNavigationEntities(){return this._activeStageManager.navigationEntities}_getNavigationEntityIdsByEntityLogicalName(){return this._activeStageManager.navigationEntityIdsByEntityLogicalName}_updateGlobalActiveStage(e,t){this._activeStageManager.UpdateGlobalPathAndActiveStage(e,t)}_createGlobalNavigationData(e){const t=new M,n=Object(k.b)(e.activestageid);t.activeStageId=p.a.toString(n);let a=Object(k.c)(e.traversedpath);Object(ve.b)(a)&&(a=D.a.getCandidateTraversedPathFromStagStep(this._stageMetadata.businessProcessFlowVisitor.get_stages(),t.activeStageId)),t.traversedPath=a,t.navigationEntities=[];const r=this._getNavigationEntityTypesFromWorkflowObjectModel();for(const n of r){const a=new R;a.entityLogicalName=n,a.id=p.a.EMPTY.guid;for(const t in e)if(Object(k.k)(e[t])){const r=e[t],i=[],o="NULL";if(Object(ve.a)(r.reference)||Object(ve.a)(r.reference.etn)){i.push({name:"entityReference.reference",value:o});this._applicationContext.TraceManager.getTracer("CreateGlobalNavigationData").info("Navigation entity should not be null .",i)}r&&r.reference&&r.reference.etn===n&&(a.id=r.reference.id.guid)}t.navigationEntities.push(a)}e.hasOwnProperty("businessprocessflowinstanceid")&&(t.businessProcessInstanceId=Object(k.c)(e.businessprocessflowinstanceid));e.hasOwnProperty("name")&&(t.businessProcessInstanceName=Object(k.c)(e.name));e.hasOwnProperty("statecode")&&(t.businessProcessState=Object(k.c)(e.statecode));e.hasOwnProperty("statuscode")&&(t.businessProcessStatus=Object(k.c)(e.statuscode));return e.hasOwnProperty("bpfDefinitionVersioNumber")&&(t.bpfDefinitionVersionNumber=Object(k.c)(e.bpfDefinitionVersioNumber)),t}_getNavigationEntityTypesFromWorkflowObjectModel(){const e={};if(!Object(ve.a)(this.getProcess()))for(let t=0;t<this.getProcess().get_Steps().get_Count();t++){const n=this.getProcess().get_Steps().get_item(t);if(!(n instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep))continue;const a=n.get_Description();e[a]||(e[a]=a)}return Object.keys(e)}reflow(e,t,n){const a=this._stageMetadata.getDefaultPathManager();if(!t&&!n)return void this._reflowInternal();if(!t)return;t=new p.a(t).guid;const r=this.getTraversedPath(),i=this.getActiveStageId();r&&i&&(i===t||r.indexOf(t)<0)&&(a.updateDefaultPath(t,n),this._updateProcessInstanceModifiedTime())}_reflowInternal(e,t){const n=this._stageMetadata.getDefaultPathManager();e||t||(t=this.getActiveStageId(),e=this._stageMetadata.getPreviousStageId(t)),e&&(n.updateDefaultPath(e,t),this._updateProcessInstanceModifiedTime())}callPblToEvaluateBranching(e){const t=this._getState();if(!this._currentPageId)throw new Error("The current page Id should not be null when callPblToEvaluateBranching has been called. Because the reflow logic should be triggered for a particular page.");const n=Object(J.a)(t,this._currentPageId);this.getScriptContainerPromise().then(t=>{n<$.a.EditReady&&t.getEventManager().addOnLoadEvent(this.getContextToken(),()=>{t.execute(e,[])}),n>=$.a.OnLoadReady&&t.execute(e,[])})}update(e){!Object(ve.a)(this._currentBpfInstance)&&this._isSelectedStageControl(e.Id)&&this._updateProcessInstanceModifiedTime()}waitForOngoingWork(){return Ze.a.getInstance().checkForOutstandingWork(this._getState())}_getEventManager(){const e=this.getScriptContainer();return e?e.getEventManager():null}getScriptContainer(){if(!this._applicationContext||!this._applicationContext.ScriptManager)return null;let e=null;try{e=this._applicationContext.ScriptManager.getContainer(this._currentPageId)}catch(e){this._logTraceFailureForScriptContainer()}return e}getScriptContainerPromise(){return this._applicationContext&&this._applicationContext.ScriptManager?this._applicationContext.ScriptManager.initializeContainer(this._currentPageId):Promise.reject("The current container should be created before invoking handlers.")}_executePostEvent(e,t,n=null,a=null){if(Object(He.n)(this._getState(),this._currentPageId)||!this._getEventManager())this._logTraceFailureForProcessEvent(t,e,e);else switch(e){case"runOnProcessChange":this._dispatch(this._getEventManager().runOnProcessChange(this.getContextToken(),this));break;case"runOnProcessStatusChange":this._dispatch(this._getEventManager().runOnProcessStatusChange(this.getContextToken(),B.a[a],this));break;case"runOnStageChange":this._dispatch(this._getEventManager().runOnStageChange(this.getContextToken(),this,n));break;case"runOnStageSelected":this._dispatch(this._getEventManager().runOnStageSelected(this.getContextToken(),this))}}executePreEvent(e,t,n=null,a=null){let r=!1;if(!Object(He.n)(this._getState(),this._currentPageId)&&this._getEventManager()){switch(e){case"runOnPreProcessStatusChange":r=this._dispatch(this._getEventManager().runOnPreProcessStatusChange(this.getContextToken(),B.a[a],this));break;case"runOnPreStageChange":r=this._dispatch(this._getEventManager().runOnPreStageChange(this.getContextToken(),this,n))}return this._logTraceInfoForProcessPreEvent(r,e,t,t),r}return this._logTraceFailureForProcessEvent(t,e,e),r}_saveFormDataAndActiveStage(e,t,n){const a=ot.startStopwatch({processId:p.a.toString(this.getProcessId()),processInstanceId:p.a.toString(this.getProcessInstanceId())}),r=this.executePreEvent("runOnPreStageChange",n,t),i=Object(he.c)(this._getState(),this.getCurrentFormEntity());if(!r){const a=new Promise((t,a)=>{if(!e)return a(new W("Attemping to save invalid stage id"));const r=["traversedpath","activestageid","activestagestartedon","completedon"],o=this.getNavigationEntities(),s=Object(m.b)(this._getState(),this._currentBpfInstance);for(const e of o)for(const t in s)if(t.includes(e.entityLogicalName)){r.push(t);break}let c,l;if(this._shouldPerformFormSave()){const t=this._getState();c=this._validateSnapshot(i).then(()=>this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n)).then(()=>(l=this._createActiveStageSnapshot(e),this._saveFormEntityAndBPFEntitySnapshots(l,i,!1))).then(()=>{const e=this.getCurrentFormEntity();this._dispatch(Object(tt.a)(this._currentPageId,t,this.getContextToken(),e.etn,e.id))}).catch(e=>{const t=Object(g.c)(e);return this._handleDuplicateDetection(t,l)})}else c=this._validateRequiredFieldsForNavigationOrStateChangeAndRejectOnFailures(n).then(()=>(l=this._createActiveStageSnapshot(e),this._dispatch(Object(se.c)(l,!0,r,this._getRetrieveProcessControlDataRequest())).then(()=>{this._dispatch(Object(ce.a)(this._currentPageId,this.getCurrentFormEntity(),this._getColumnsToRefresh(),this._getRetrieveProcessControlDataRequest())),this._dispatch(Object(v.b)(!0,this._currentFormEntity))})));t(c)}).then(()=>{const e=this.getTraversedPath(),a=this.getActiveStageId();this._updateGlobalActiveStage(e,a),this.setSelectedStage(a),this._executePostEvent("runOnStageChange",n,t)},e=>{throw this._unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e),e});return a.then(o,o),a}function o(){a()}}_handleDuplicateDetection(e,t){if(Object(et.e)(e)){return this._dispatch(Object(Je.a)(this._currentPageId,e,this._currentFormEntity)).then(e=>0===e.status?this._dispatch(Object($e.a)(e.pageId)).then(e=>e.value.param_lastButtonClicked===l.a?Promise.resolve("success"):Promise.resolve("aborted")):Promise.resolve("noop")).then(e=>{if("success"===e){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity());return this._saveFormEntityAndBPFEntitySnapshots(t,e,!0)}})}throw e}_saveFormEntityAndBPFEntitySnapshots(e,t,n){const a={};a[t.identifier.etn]=this._getColumnsToRefresh();let r=null;return r=this.isImmersiveBPF()?[t.snapshotId]:[t.snapshotId,e],this._dispatch(Object(se.d)(r,n,a,this._getRetrieveProcessControlDataRequest()))}_logTraceInfoForProcessPreEvent(e,t,n,a){const r=this._applicationContext.TraceManager.getTracer(a),i=this.getTelemetryParams(),o={name:"BpfOperationName",value:n};i.push(o);const s={name:"eventName",value:t};i.push(s);const c={name:"preventDefaultInvokedByWebResource",value:e};i.push(c),r.info("BPF ProcessManager executed scripts registered to event "+t,i)}_logTraceFailureForProcessEvent(e,t,n){const a=this._applicationContext.TraceManager.getTracer(n),r=this.getTelemetryParams(),i={name:"BpfOperationName",value:e};r.push(i);r.push({name:"preventDefaultInvokedByWebResource",value:null});const o={name:"eventName",value:t};r.push(o);const s={name:"isPageDead",value:Object(He.n)(this._getState(),this._currentPageId)};r.push(s);const c={name:"currentPageId",value:this._currentPageId};r.push(c),a.error(`BPF ProcessManager not able to to execute scripts registered on event ${t} does not exist`,r)}_logTraceFailureForScriptContainer(){const e=this._applicationContext.TraceManager.getTracer("GET_SCRIPT_CONTAINER"),t=this.getTelemetryParams();t.push({name:"BpfOperationName",value:"GetScriptContainer"});const n={name:"IsPageDead",value:Object(He.n)(this._getState(),this._currentPageId)};t.push(n);t.push({name:"IsSciptContainerAvailable",value:!1}),e.error("BPF ProcessManager not able to to execute scripts as the script container does not exist",t)}_getStage(e){let t=null;if(e){const n=this.getEntityStages();n&&n.some(n=>{for(let a=0;a<n.get_Steps().get_Count();a++){const r=n.get_Steps().get_item(a);if(this._equalsIgnoreCase(e,r.get_Id()))return t=r,!0}})}return t}getContextToken(){return Object(de.j)(this._getState(),this._currentPageId)}_updateProcessInstanceModifiedTime(){this._dispatch(Object(ne.b)(this.getCurrentFormEntity()))}_isSelectedStageControl(e){if(!Object(ve.a)(this.getSelectedStage())){const t=this.getSelectedStage().get_Steps();for(let n=0;n<t.get_Count();n++)if(this._equalsIgnoreCase(t.get_item(n).get_Id(),e))return!0}return!1}_equalsIgnoreCase(e,t){return!!e&&!!t&&e.toUpperCase()===t.toUpperCase()}_getSnapshotStateTelemetryParams(e){const t=[];if(Object(ve.a)(e))return t;const n={name:"mode",value:e.mode},a={name:"identifierId",value:Object(ve.a)(e.identifier)||Object(ve.a)(e.identifier.id)?null:p.a.toString(e.identifier.id)},r=this._applicationContext.DataSource.get_MetadataCache().getEntityMetadata(e.identifier.etn),i={name:"identifierEntityId",value:Object(ve.a)(r)?null:p.a.fromLegacyGuid(r.get_id()).guid},o={name:"identifierEntityObjectTypeCode",value:Object(ve.a)(r)?null:r.get_objectTypeCode()},s={name:"activeChanges",value:Object(ve.a)(r)?null:this._getIFieldValuesString(e.activeChanges,r.get_logicalName())},c={name:"lockedChanges",value:Object(ve.a)(r)?null:this._getIFieldValuesString(e.lockedChanges,r.get_logicalName())};return t.push(n),t.push(i),t.push(o),t.push(a),t.push(s),t.push(c),t}_getTelemetryParamsForActionStep(e,t,n){const a=this.getTelemetryParams(),r={name:"ActionStepType",value:e},i={name:"ControlId",value:t},o={name:"ActionStepId",value:n};return a.push(r),a.push(i),a.push(o),a}getTelemetryParams(){const e=[];try{const t={name:"ProcessId",value:p.a.toString(this.getProcessId())},n={name:"ProcessInstanceId",value:p.a.toString(this.getProcessInstanceId())},a={name:"ActiveStageId",value:this.getActiveStageId()},r={name:"SelectedStageId",value:this.getSelectedStageId()},i={name:"TraversedPath",value:this.getTraversedPath()},s={name:"ActivePath",value:this._getActivePathString()},c={name:"CurrentFormEntityType",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().etn?this.getCurrentFormEntity().etn:""},l={name:"CurrentFormEntityId",value:this.getCurrentFormEntity()&&this.getCurrentFormEntity().id?p.a.toString(this.getCurrentFormEntity().id):""},u={name:"ProcessState",value:this.getProcessState()},d={name:"PageId",value:this._currentPageId},h={name:"PageType",value:Object(o.l)(this._getState(),this._currentPageId)},g={name:"SavedPageId",value:this._savedPageId},m={name:"SavedPageType",value:Object(o.l)(this._getState(),this._savedPageId)};if(Object(Le.c)(this._getState(),"FCB.EnableBPFNonDefaultCustomControls")){const t={name:"CustomControlsPresent",value:this.getCustomControlIndicator()},n={name:"RenderedFromFormXML",value:this.getFormXmlRenderingIndicator()};e.push(t),e.push(n)}const b={name:"IsImmersiveBPF",value:this.isImmersiveBPF()};e.push(t),e.push(n),e.push(a),e.push(i),e.push(s),e.push(r),e.push(c),e.push(l),e.push(u),e.push(d),e.push(h),e.push(g),e.push(m),e.push(b)}catch(t){this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.ProcessManagerTelemetryGeneration").error("Exception while generating Process Manager telemetry parameters: "+t.message,e)}return e}_getIFieldValuesString(e,t){let n="";if(!Object(ve.a)(e))for(const a in e)if(Object(ve.a)(a))n+=String.format("[fieldName: {0}]",null);else{const r=this._applicationContext.DataSource.get_MetadataCache().getAttributeMetadata(t,a),i=e[a];if(Object(ve.a)(i)||Object(ve.a)(r))n+=String.format("[attributeId is null: {0}, attributeMetadata is null: {1}]",Object(ve.a)(i),Object(ve.a)(r));else{let e="";Object(ve.a)(i.timestamp)||(e=i.timestamp.toUTCString());let t="",a="",o=null,s=null;Object(ve.a)(i.validationResult)||(t=i.validationResult.errorId,a=i.validationResult.errorMessage,o=i.validationResult.isOfflineSyncError,s=i.validationResult.isValueValid);const c=r.get_id();n+=String.format("[attributeId: {0}, timeStamp: {1}, validationResultErrorId: {2}, validationResultErrorMessage: {3}, validationResultIsOfflineSyncError: {4}, validationResultIsValueValid: {5}]",c,e,t,a,o,s)}}return n}_getActivePathString(){const e=this.getActivePath();let t="";if(e&&e.length>0){for(let n=0;n<e.length-1;n++)t=t+e[n].guid+",";t+=e[e.length-1].guid}return t}isImmersiveBPF(){return this.getCurrentFormEntity()&&this._currentBpfInstance&&this.getCurrentFormEntity().etn===this._currentBpfInstance.etn}_getColumnsToRefresh(){const e=Object(Ye.b)(this._getState(),this._currentPageId),t=Object(o.g)(this._getState(),this._currentPageId);if(Object(ve.a)(t)){const e=Object(he.c)(this._getState(),this.getCurrentFormEntity()),t=this._applicationContext.TraceManager.getTracer("BusinessProcessFlow.SaveAndRefresh"),n=this._getSnapshotStateTelemetryParams(e);return t.warn("Columns To Refresh is not set as PageInput is null. Primary entity not refreshed after save",n),[]}const n=Object(Ne.E)(this._getState(),t.entityTypeName),a=Object(l.g)(this._getState(),e,t,n,null);return a&&a.hasOwnProperty(t.entityTypeName)?a[t.entityTypeName]:[]}_getRetrieveProcessControlDataRequest(){const e=this.getProcessId()&&!p.a.equals(this.getProcessId(),p.a.EMPTY)?Z.a.toLegacyEntityReference(new Z.a("businessprocessflowinstance",this.getProcessId())):null,t=this.getProcessInstanceId()&&!p.a.equals(this.getProcessInstanceId(),p.a.EMPTY)?Z.a.toLegacyEntityReference(new Z.a("businessprocessflowinstance",this.getProcessInstanceId())):null;return this.getCurrentFormEntity()&&e&&t?new We.a(Z.a.toLegacyEntityReference(this.getCurrentFormEntity()),e,t):this.getCurrentFormEntity()?new We.a(Z.a.toLegacyEntityReference(this.getCurrentFormEntity()),null,null):null}getCustomControlIndicator(){return this._customControlsPresent}setCustomControlIndicator(e){this._customControlsPresent=e}getFormXmlRenderingIndicator(){return this._renderedFromFormXml}setFormXmlRenderingIndicator(e){this._renderedFromFormXml=e}getInstanceModifiedTimestamp(){return this._instanceModifiedTimestamp}isBpfFormDescriptorValid(e,t,n,a){return null===this._isBpfFormValid&&(this._isBpfFormValid=Object(Qe.f)(e,t,n,a)),this._isBpfFormValid}_unlockPrimaryEntityActiveChangesIfMainFormSaveFailure(e,t){let n=t;if(Object(ve.a)(t)){const t=Object(g.c)(e);n=!Object(ve.a)(t)&&t.FaultedSnapshotId}!Object(ve.b)(n)&&this._dispatch(Object(oe.b)(n,!1));const a=Object(he.c)(this._getState(),this.getCurrentFormEntity());a&&!Object(ve.a)(a.snapshotId)&&a.snapshotId!==n&&this._dispatch(Object(oe.b)(a.snapshotId,!1))}}},bq0x:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e,t){const n=Object(a.Zb)(e,t);return n&&n.output?n.output.value:null}},ccIw:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n("WRDA"),r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{get invocationSource(){return this._invocationSource}set invocationSource(e){this._invocationSource=e}get workflowStep(){return this._workflowStep}set workflowStep(e){this._workflowStep=e}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}set businessProcessFlowVisitor(e){this._businessProcessFlowVisitor=e}get currentEntityName(){return this._currentEntityName}set currentEntityName(e){this._currentEntityName=e}get processManager(){return this._processManager}set processManager(e){this._processManager=e}getStageStep(e){if(Object(r.b)(e)||!this._businessProcessFlowVisitor)return null;const t=this._businessProcessFlowVisitor.get_stagesById()[Object(a.a)(e)];return t||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o extends
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class{constructor(e){this.value=e,this._next=null}get value(){return this._value}set value(e){this._value=e}getNext(){return this._next}setNext(e){this._next=e}}{constructor(e){super(Object(a.a)(e))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class s{constructor(){this._latestDefaultPathCalculated=!1,this._rootNodes=[],this._rootNodesValue=[],this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash()}find(e,t){if(e=Object(a.a)(e),t){for(const t in this._rootNodesValue)if(e===this._rootNodesValue[t])return this._rootNodes[t];return null}for(const t in this._rootNodes){let n=this._rootNodes[t];if(n.value===e)return n;for(;null!=n.getNext();)if(n=n.getNext(),n.value===e)return n}return null}getNode(e){return this._rootNodes[e]}setNode(e,t){this._latestDefaultPathCalculated=!1,this._rootNodes[e]=t,this._rootNodesValue[e]=t.value}getDefaultPath(){return this._ensureLatestDefaultPathIsCalculated(),this._defaultPathArray}addAfter(e,t){this.find(t.value,!0)?this._addAfterInternal(e,new o(null)):this._addAfterInternal(e,t)}getDefaultPathHash(){return this._ensureLatestDefaultPathIsCalculated(),this._lastDefaultPathCalculatedTimeHash}_ensureLatestDefaultPathIsCalculated(){this._latestDefaultPathCalculated||(this._defaultPathArray=this._recaculateDefaultPath(),this._latestDefaultPathCalculated=!0,this._lastDefaultPathCalculatedTimeHash=this._generateDefaultPathCalculatedTimeHash())}_recaculateDefaultPath(){this._defaultPathArray=[];for(let e=0;e<this._rootNodes.length;e++){let t=this._rootNodes[e];for(this._defaultPathArray[this._defaultPathArray.length]=t.value;t.getNext();){const e=t.getNext();e.value&&(this._defaultPathArray[this._defaultPathArray.length]=e.value),t=e}}return this._defaultPathArray}_addAfterInternal(e,t){e.setNext(t),this._latestDefaultPathCalculated=!1}_generateDefaultPathCalculatedTimeHash(){let e=Math.floor(1e4*Math.random());try{e=crypto.getRandomValues(new Uint32Array(1))[0]}catch(e){}return Date.now().toString()+e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class c{pathChanged(e){this._handler&&!Object(r.b)(e.parentStage)&&this._handler.handleChange(e.parentStage,e.nextStage)}getHandler(){return this._handler}setHandler(e){this._handler=e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class l{constructor(e,t){this._nextStage=t,this._parentStage=e}get parentStage(){return this._parentStage}get nextStage(){return this._nextStage}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class u{constructor(e,t,n){this._context=e,this._defaultPath=t,this._staticPath=n}calculate(){let e=this._startingNodeInDefaultPath();for(let t=0;t<this._staticPath.length;t++){const n=this._staticPath[t];if(!this._context.businessProcessFlowVisitor.get_stagesById().hasOwnProperty(n))continue;const a=this._defaultPath.find(n,!0);a?e=a:(this._defaultPath.addAfter(e,new o(n)),e=e.getNext())}this._lastEvaluatedNode=e}getLastEvaluatedNodeInDefaultPath(){return this._lastEvaluatedNode}getDefaultPath(){return this._defaultPath}_startingNodeInDefaultPath(){return this._startNode||(this._startNode=this._defaultPath.getNode(0)),this._startNode}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this._defaultPath=t,this._context=e}calculate(){this._staticPathToDefaultPathCalculator.calculate(),this._defaultPath=this._staticPathToDefaultPathCalculator.getDefaultPath()}getLastDefaultNode(){return this._staticPathToDefaultPathCalculator.getLastEvaluatedNodeInDefaultPath()}get traversedPath(){return this._traversedPath||(this._traversedPath=[]),this._traversedPath}set traversedPath(e){this._traversedPath=e}getDefaultPath(){return this._defaultPath}get _staticPathToDefaultPathCalculator(){return this.__staticPathToDefaultPathCalculator||(this.__staticPathToDefaultPathCalculator=new u(this._context,this._defaultPath,this._traversedPath)),this.__staticPathToDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h{constructor(e,t){this._context=e,this._defaultPath=t}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()&&this._calculateForTraveresedStages()}get traversedPath(){return this._traversedPath}set traversedPath(e){this._traversedPath=e}getLastCalculatedDefaultNode(){return this._traversedDefaultPathCalculator?this._traversedDefaultPathCalculator.getLastDefaultNode():null}getDefaultPath(){return this._defaultPath}_calculateForTraveresedStages(){this._traversedDefaultPathCalculator.traversedPath=this._traversedPath.split(","),this._traversedDefaultPathCalculator.calculate()}get _traversedDefaultPathCalculator(){return this.__traversedDefaultPathCalculator||(this.__traversedDefaultPathCalculator=new d(this._context,this._defaultPath)),this.__traversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class g{constructor(e){this.context=e}get stage(){return this._stageStep}set stage(e){this._stageStep=e}tryExecute(){const e=Object(a.a)(this.stage.get_stageId());return!!this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e]&&(this.executeCondition(),!0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p extends g{executeCondition(){const e="bpf_"+this._sanitizeGuidForFunctionName(this.stage.get_stageId());this.context.processManager.callPblToEvaluateBranching(e)}_sanitizeGuidForFunctionName(e){if(Object(r.b)(e))return e;for(e=Object(a.a)(e);e.indexOf("-")>-1;)e=e.replace("-","");return e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class m extends g{executeCondition(){const e=Object(a.a)(this.stage.get_stageId()),t=this.context.businessProcessFlowVisitor.get_conditionsByParentStageId()[e];if(!t)return;const n=t.findElseBranch();let r=null;if(n&&n.get_Steps().get_Count()>0){r=n.get_Steps().get_item(0).get_stageId()}this._invokeReflowFunction(e,r)}_invokeReflowFunction(e,t){this.context.processManager.reflow(!1,e,t)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class b{getStageCommand(e,t){const n=e.businessProcessFlowVisitor.get_parentEntityStepByStageId()[Object(a.a)(t.get_stageId())];return e.currentEntityName!==n.get_EntityLogicalName()?new m(e):new p(e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f{constructor(e,t,n){this._defaultPath=t,this._cascadeUpdate=n,this._context=e,this._businessRuleCommandFactory=new b}handleChange(e,t){const n=this._defaultPath.find(e,!1);if(null!=n){const e=Object(r.b)(t)?null:t,a=new o(e);this._defaultPath.addAfter(n,a),e&&this.triggerSubsequentDefaultPathCalculation(a)}}triggerSubsequentDefaultPathCalculation(e){if(!e)return;const t=e.value;if(t&&!this._tryExecuteConditionForStage(e)){const n=this._context.getStageStep(t).get_nextStageId();if(!n)return;const a=this._defaultPath.find(n,!0);if(a)return void(this._cascadeUpdate&&this.triggerSubsequentDefaultPathCalculation(a));this._defaultPath.addAfter(e,new o(n)),this.triggerSubsequentDefaultPathCalculation(e.getNext())}}_tryExecuteConditionForStage(e){const t=this._context.invocationSource;try{this._context.invocationSource="internal";const n=this._context.getStageStep(e.value),a=this._businessRuleCommandFactory.getStageCommand(this._context,n);if(a.stage=n,!a.tryExecute())return!1;if(e.getNext())return!0}finally{this._context.invocationSource=t}return!1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class y{constructor(e,t,n){this._context=e,this._listener=t,this._defaultPath=n}calculate(){const e=this._pathChangeHandler;this._listener.setHandler(e),e.triggerSubsequentDefaultPathCalculation(this._startNode)}get startingNodeInDefaultPath(){return this._startNode}set startingNodeInDefaultPath(e){this._startNode=e}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!0)),this.__pathChangeHandler}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class C{constructor(e,t,n){this._context=e,this._listener=t,this._initialDefaultPath=n}calculate(){this._context.businessProcessFlowVisitor.get_areConditionsPresent()||(this._defaultPath=this._initialDefaultPath),this._calculateForTraversedStages(),this._calculateForNonTraversedStages()}get startingNodeInDefaultPath(){return this._startingNodeInDefaultPath}set startingNodeInDefaultPath(e){this._startingNodeInDefaultPath=e}getDefaultPath(){return this._defaultPath}_calculateForTraversedStages(){this._defaultPath=this._initialDefaultPath}_calculateForNonTraversedStages(){this._nonTraversedDefaultPathCalculator.startingNodeInDefaultPath=this.startingNodeInDefaultPath,this._nonTraversedDefaultPathCalculator.calculate()}get _nonTraversedDefaultPathCalculator(){return this.__nonTraversedDefaultPathCalculator||(this.__nonTraversedDefaultPathCalculator=new y(this._context,this._listener,this._defaultPath)),this.__nonTraversedDefaultPathCalculator}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _{constructor(e,t,n){this._context=e,this._changeListener=t,this._defaultPath=n}calculate(){const e=this._pathChangeHandler;this._changeListener.setHandler(e)}getDefaultPath(){return this._defaultPath}get _pathChangeHandler(){return this.__pathChangeHandler||(this.__pathChangeHandler=new f(this._context,this._defaultPath,!1)),this.__pathChangeHandler}}var v=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S{constructor(e,t){this._context=t,this._traversedPathProvider=e,this._changeListener=new c,this._initializeDefaultPathFromRootStages()}initializeComplete(){const e=this.defaultPathHash();this._initializeTraversedPath(),this._initializeNonTraversedPath();const t=this._context.processManager.getSelectedStageId(),n=this._context.processManager.getActivePath(),a=!Object(r.a)(t)&&!Object(r.a)(n),i=a&&n.findIndex(e=>e.guid.toString()===t)<0,o=a&&this.getDefaultPath().indexOf(t)>=0;this.getDefaultPath()&&(e!==this.defaultPathHash()||i&&o)&&this._context.processManager.setActivePath(this.getDefaultPath())}updateDefaultPath(e,t){if(!e)return;let n=null;if("internal"!==this._context.invocationSource&&(n=this.defaultPathHash()),this._changeListener.pathChanged(new l(e,t)),"internal"!==this._context.invocationSource){if(n!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}triggerSubsequentDefaultPathCalculation(e){if(!(!!v.a.tryParseOrNull(e)&&!!this.getDefaultPath().find(t=>t.toLowerCase()===e.toLowerCase())))return;let t=null;if("internal"!==this._context.invocationSource&&(t=this.defaultPathHash()),this._changeListener.getHandler().triggerSubsequentDefaultPathCalculation(new o(e)),"internal"!==this._context.invocationSource){if(t!==this.defaultPathHash()){const e=this.getDefaultPath();this._context.processManager.setActivePath(e)}}}getDefaultPath(){return this._defaultPath.getDefaultPath()}defaultPathHash(){return this._defaultPath.getDefaultPathHash()}getNextStage(e){const t=this.getDefaultPath(),n=t.indexOf(Object(a.a)(e));return-1!==n&&n<t.length-1?t[n+1]:null}getPreviousStage(e){const t=this.getDefaultPath(),n=t.indexOf(Object(a.a)(e));return n<=0?null:t[n-1]}_initializeDefaultPathFromRootStages(){this._defaultPath=new s;const e=this._context.businessProcessFlowVisitor.get_firstLevelStages();let t=0;for(const n in e)this._defaultPath.setNode(t,new o(n)),t++}_initializeTraversedPath(){this._loadTimeDefaultPathCalculator.traversedPath=this._traversedPathProvider.getTraversedPath(),this._loadTimeDefaultPathCalculator.calculate(),this._defaultPath=this._loadTimeDefaultPathCalculator.getDefaultPath()}_initializeNonTraversedPath(){this._afterLoadPathCalculator.startingNodeInDefaultPath=this._loadTimeDefaultPathCalculator.getLastCalculatedDefaultNode(),this._afterLoadPathCalculator.calculate(),this._defaultPath=this._afterLoadPathCalculator.getDefaultPath(),this._runTimePathCalculator.calculate()}get _loadTimeDefaultPathCalculator(){return this._loadTimePathCalculator||(this._loadTimePathCalculator=new h(this._context,this._defaultPath)),this._loadTimePathCalculator}get _afterLoadPathCalculator(){return this.__afterLoadPathCalculator||(this.__afterLoadPathCalculator=new C(this._context,this._changeListener,this._defaultPath)),this.__afterLoadPathCalculator}get _runTimePathCalculator(){return this.__runTimePathCalculator||(this.__runTimePathCalculator=new _(this._context,this._changeListener,this._defaultPath)),this.__runTimePathCalculator}}var O=n("i1f0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class I{setPrimaryModel(e){this._primaryModelName=e}getDefaultPathManager(){return this._defaultPathManager}setObjectModel(e){const t=new Microsoft.Crm.Workflow.ObjectModel.WorkflowStep("",0),n={};e.businessProcessFlowEntities.forEach(e=>{if(this._isRelationshipStep(e)){const n=this._createRelationshipCollectionStep(t,e);n&&t.appendStep(n)}else{const a=this._createEntity(t,e);a&&(t.appendStep(a),n.hasOwnProperty(a.get_EntityLogicalName())||(n[a.get_EntityLogicalName()]=!0))}}),t.set_Name(e.businessProcessFlowName),t.set_Id(e.businessProcessFlowId?e.businessProcessFlowId.guid:""),this._processObjectModel=t,this._initializeVisitor()}initializeDefaultPathManager(e,t){const n=new i;n.processManager=t,n.businessProcessFlowVisitor=this._businessProcessFlowVisitor,n.workflowStep=this._processObjectModel,n.currentEntityName=this._primaryModelName,this._defaultPathManager=new S(e,n),this._defaultPathManager.initializeComplete()}get businessProcessFlowVisitor(){return this._businessProcessFlowVisitor}getEntityStages(){if(!this._processObjectModel)return null;const e=this._processObjectModel.get_Steps(),t=[];if(e){for(let n=0;n<e.get_Count();n++){const a=e.get_item(n);a&&a instanceof Microsoft.Crm.Workflow.ObjectModel.EntityStep&&(t[t.length]=e.get_item(n))}return t}return null}getRequiredFlowStepsForStage(e,t,n,a){const r=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");const o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(let e=0;e<o.get_Count();e++)if(o.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const t=o.get_item(e);this._isFlowStep(t)&&t.get_isProcessRequired()&&r.push(t.get_Id())}return r}getRequiredAttributesForStage(e,t,n,a){const r=[],i=this.getStage(e);if(!i)throw new Error(e+" is not a valid stage id.");const o=i.get_Steps();if(!o)throw new Error(e+" does not include valid steps");for(let e=0;e<o.get_Count();e++)if(o.get_item(e)instanceof Microsoft.Crm.Workflow.ObjectModel.StepStep){const i=o.get_item(e);if(!this._isActionStep(i)&&!this._isFlowStep(i))if(i.get_isProcessRequired())r.push(i.get_Description());else{const e=this._getDataFieldNameFromStepStep(i);e&&this._isRequiredAttribute(e,t,n,a)&&r.push(i.get_Description())}}return r}_getDataFieldNameFromStepStep(e){if(this._isActionStep(e)||this._isFlowStep(e))return null;if(this._isControlStep(e)){const t=e.get_Steps().get_item(0);return!t||t.get_isSystemControl()?null:t.get_dataFieldName()}return null}_isRequiredAttribute(e,t,n,a){if(null!=e){return 2===Object(O.pc)(a,t,n,e)}return!1}_isFlowStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.FlowStep)return!0}return!1}_isActionStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ActionStep)return!0}return!1}_isControlStep(e){if(e&&e.get_Steps()&&e.get_Steps().get_Count()>0){if(e.get_Steps().get_item(0)instanceof Microsoft.Crm.Workflow.ObjectModel.ControlStep)return!0}return!1}_initializeVisitor(){this._businessProcessFlowVisitor=new ProcessObjectModel.Visitors.BusinessProcessFlowVisitor,this._businessProcessFlowVisitor.visit(this._processObjectModel)}_isRelationshipStep(e){return!(!e||!e.hasOwnProperty("relationships"))}_createEntity(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.EntityStep(e,t.entityLogicalName);n.set_Name(t.entityLogicalName),n.set_Description(t.entityDisplayName),n.set_relationshipName(t.relationshipName),n.set_attributeName(t.referencingAttributeName),n.set_parent(e);const a=this._createStage(e,t.stage);n&&a&&n.appendStep(a);for(let n=0;n<t.stage.steps.length;n++){const r=this._createStep(e,t.stage.steps[n]);r&&a.appendStep(r)}const r=this._createConditionStep(e,a,t.stage);return r&&a.appendStep(r),n}_createRelationshipCollectionStep(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipCollectionStep(e);if(n.set_workflow(e),t.relationships)for(let a=0;a<t.relationships.length;a++){const r=this._createRelationshipStep(e,t.relationships[a]);n.appendStep(r)}return n}_createRelationshipStep(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.RelationshipStep(e);return n.set_workflow(e),n.set_sourceStageId(t.sourceStageId.guid),n.set_targetStageId(t.targetStageId.guid),n.set_attributeName(t.attributeName),n.set_relationshipName(t.relationshipName),n}_createStage(e,t){const n=new Microsoft.Crm.Workflow.ObjectModel.StageStep(e,t.stageDisplayName||"dummy");return n.set_Id(t.stageId.guid),n.set_stageId(t.stageId.guid),n.set_nextStageId(t.nextStageId?t.nextStageId.guid:""),n.set_stageCategory(t.stageCategory),n}_createStep(e,t){const n="action"===t.stepType.toLowerCase()?t.label:t.name,a=new Microsoft.Crm.Workflow.ObjectModel.StepStep(e,n||"dummy");a.set_isProcessRequired(t.required),a.set_Name(t.label),a.set_Id(t.stepId?t.stepId.guid:""),a.set_workflow(e);const r=new Microsoft.Crm.Workflow.ObjectModel.ControlStep(e);if(r.set_dataFieldName(n),"action"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.ActionStep(e);t.set_Name(n),t.set_actionControl(r),a.appendStep(t)}else if("modernflow"===t.stepType.toLowerCase()){const t=new Microsoft.Crm.Workflow.ObjectModel.FlowStep(e);t.set_Name(n),t.set_flowControl(r),a.appendStep(t)}else a.appendStep(r);return a}_createConditionStep(e,t,n){if(!n.conditionJson)return null;const a=new Microsoft.Crm.Workflow.ObjectModel.ConditionStep(e);return a.set_parent(t),a.initializeFromDynamic(JSON.parse(n.conditionJson)),a.fixLinks(),a}getProcessObjectModel(){return this._processObjectModel}getStage(e){return Object(r.a)(e)||!this._processObjectModel?null:this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(e)?this._businessProcessFlowVisitor.get_stagesById()[e]:null}getPreviousStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getPreviousStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}getNextStageId(e){if(this._defaultPathManager&&this._businessProcessFlowVisitor){const t=this._defaultPathManager.getNextStage(e);if(this._businessProcessFlowVisitor.get_stagesById().hasOwnProperty(t))return t}return null}}},cf3Y:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.format";function i(e,t,n,i){const o=Object(a.x)(t);return{type:r,payload:i,meta:{pageId:e,contextKey:o,dataFieldName:n}}}},dIqG:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="navigation.item.visibility";function r(e,t,n){return{type:a,payload:{show:n},meta:{pageId:e,navigationItemId:t}}}},dMZy:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(){return{tabId:"",navigationStack:[]}}n.d(t,"a",(function(){return a}))},dQnL:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n("SAYH"),r=n("eXjw"),i=n("95wm"),o=n("CngE"),s=n("haag"),c=n("BzGi"),l=n("K7RF"),u=n("Nb1E"),d=n("odYE"),h=n("2XFH"),g=n("Uv1Y"),p=n("Tezb"),m=n("/oKV"),b=n("iJGp"),f=n("S2mk"),y=n("3/02"),C=n("Lyxw");function _(e,t=c.a.savedvisualization,n){const h=[];return h.push({name:s.f,value:e}),h.push({name:s.i,value:t}),h.push({name:s.h,value:a.a.toString(n)}),{type:"chart.retrieve.async",execute({dispatch:p,getState:f},_){try{let v=m.a.LocalAndRemote;const O=_.TraceManager.getTracer(s.d),P=_.DataSource,w=f();let T=n;if(O.info(s.d+"entityTypeName:"+e+"visualizationType:"+t+"visualizationId:"+n),!e){const e="entityTypeName is null";return _.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,h),Promise.reject(e)}a.a.isNullOrEmpty(T)&&(T=Object(o.j)(w,e));const A=Object(C.c)(f(),y.A);if(!a.a.isNullOrEmpty(T)){const n=Object(o.f)(w,T),a=Object(o.g)(w,T),f=()=>{const n=Object(o.a)(w,T),a=function(e,t,n,a){const r=c.a[n],i=Object(o.i)(e,t);return i&&i.chartTypes&&i.chartTypes[r]&&i.chartTypes[r][a.guid]}(w,e,t,T),r=a&&!a.IsUserChart;switch(Object(l.d)(w,r,n,()=>a)){case 1:v=m.a.Remote;break;case 2:p(function(e,t,n){const a=[];return a.push({name:"entityTypeName",value:t}),a.push({name:"visualizationType",value:n}),{type:"chartselector.retrieve.async",execute({dispatch:e,getState:r},o){try{return e(Object(l.b)(c.a[n],null,t,null,!0,b.a.OnDemandWithContext,null,null,[],null,m.a.LocalAndRemote)).catch(g.b)}catch(e){throw o.EventManager.ReportComponentFailure(i.f+"._retrieveChartSelector",Error(e),s.e,a),e}}}}(0,e,t))}};if(n===r.a.Initialized){if(f(),v!==m.a.LocalAndRemote)return I(p,P,e,T,t,v,_,h);if(A&&a===r.a.Uninitialized){const e=new d.a(t===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",T),n=Object(o.a)(w,T);return p(S(T,r.a.Initialized)),p(Object(u.d)(e)).catch(g.b).then(e=>(j(n,e),p(x(e)),_.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),Promise.resolve(T)),e=>(E(p,e,T.guid,n,_,h),Promise.resolve(T)))}return Promise.resolve(T)}return I(p,P,e,T,t,v,_,h)}return I(p,P,e,T,t,v,_,h)}catch(e){throw _.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(e),s.d,h),e}}}}function v(e){return{type:"chart.dependencies.update.async",execute({dispatch:t,getState:n},r){const i=[];for(const t in e)i.push(e[t]+":name");if(i.length>0){return t(Object(h.a)(i)).then(()=>{const r=new Map,i=n();for(const t in e){const n=e[t],s=Object(o.a)(i,new a.a(n));s&&n&&i.metadata.labels&&i.metadata.labels[n]&&i.metadata.labels[n].name&&(s.Name=i.metadata.labels[n].name,r.set(n,s))}r.size>0&&t(function(e){const t={};e.forEach((e,n)=>{t[n]=e});return{type:"chart.descriptor.update",payload:{charts:t}}}(r))},g.b)}return Promise.resolve()}}}function S(e,t){const n=a.a.isNullOrEmpty(e)?null:{charts:{[a.a.toString(e)]:{initialized:t,oDataInitialized:r.a.Initializing}}};return{type:p.f,payload:n}}function O(e,t,n,o=c.a.savedvisualization,h){const p=[];return p.push({name:s.f,value:t}),p.push({name:s.i,value:o}),p.push({name:s.h,value:a.a.toString(n)}),{type:"chart.retrieve.async",execute:({dispatch:e,getState:s},m)=>Object(C.c)(s(),y.A)?n?function(e,t,n,o,s,h,p){const m=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(S(n,r.a.Initializing)),Promise.all([e(Object(l.b)(c.a[o],null,t,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,s)).catch(g.b),e(Object(u.d)(m)).catch(g.c)]).then(t=>(t[1].constructor===g.a?E(e,t[1],n.guid,t[0].charts[n.guid],h,p):(j(t[0].charts[n.guid],t[1]),e(x(t[1])),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData")),t[0]))}(e,t,n,o,h,m,p):function(e,t,n,o,s,h,p){return e(Object(l.b)(c.a[o],null,t,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,s)).catch(g.b).then(t=>{const n=new a.a(Object.keys(t.charts)[0]),s=new d.a(o===c.a.savedvisualization?"savedqueryvisualization":"userqueryvisualization",n);return e(S(n,r.a.Initializing)),e(Object(u.d)(s)).catch(g.b).then(a=>(j(t.charts[n.guid],a),e(x(a)),h.EventManager.ReportComponentSuccess(i.f+".retrieveChartOData"),t),a=>(E(e,a,n.guid,t.charts[n.guid],h,p),t))})}(e,t,n,o,h,m,p):function(e,t,n,r,i){return e(Object(l.b)(c.a[r],null,t,a.a.toLegacyGuid(n),!0,b.a.OnDemandWithContext,null,null,[],null,i)).catch(g.b)}(e,t,n,o,h)}}function I(e,t,n,o,c,l,u,d){return e(function(e){const t=a.a.isNullOrEmpty(e)?null:{charts:{[a.a.toString(e)]:{initialized:r.a.Initializing}}};return{type:p.b,payload:t}}(o)),e(O(0,n,o,c,l)).then(t=>{t&&t.chartSelectors&&!t.chartSelectors[n]&&(t.chartSelectors[n]={initialized:r.a.Initialized,chartTypes:{}});const s=[];for(const e in t.charts)s.push(e);return e(v(s)).then(()=>(e(P(t)),a.a.isNullOrEmpty(o)&&(o=t.chartDefaults[n]),u.EventManager.ReportComponentSuccess(i.f+".retrieveChart"),o),g.b)},t=>{const c=t&&!Object(f.j)(t.errorCode)&&t.errorCode,l={chartSelectors:{[n]:{initialized:r.a.Initialized,chartTypes:{}}}};if(e(P(l)),Object(f.j)(c))return u.EventManager.ReportComponentFailure(i.f+".retrieveChart",Error(t),s.d,d),Object(g.b)(t);{const t={charts:{[a.a.toString(o)]:{initialized:r.a.Error,errorCode:c}}};e(P(t))}})}function j(e,t){e.PresentationDescription=t.presentationdescription.replace(/(\r\n\s*)/g,""),e.oDataInitialized=r.a.Initialized}function P(e){return{type:p.b,payload:e}}function x(e){return{type:p.f,payload:e}}function E(e,t,n,a,o,c){e(x({charts:{[n]:{initialized:a.initialized,oDataInitialized:r.a.Error}}})),o.EventManager.ReportComponentFailure(i.f+".retrieveChartOData",Error(t),s.c,c)}},"e+ib":function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p}));var a=n("8Mff"),r=n("9bCE"),i=n("Rj8P"),o=n("qjwL"),s=n("Nzmy"),c=n("eZ32"),l=n("8CLP");var u=n("kQA8"),d=n("37s6"),h=n("69Qu");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const g="offline.opt.status";function p(e){return{type:"offline.opt.status.save",execute({dispatch:t,getState:n}){const g=n(),p=Object(d.p)(g)===a.a.Enabled;if(e!==p)if(e)t(m(a.a.Enabled));else{if(!Object(h.b)(g))return t(Object(u.a)("Settings_Offline_DisableSync_Information_Message",void 0));!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){e(Object(r.b)(!0)),e(m(a.a.Disabled)),s.c.info("Offline: OfflineDisable: disableOffline: The offline feature status is disabled"),e(Object(i.c)(c.a.NotAvailable,l.a.None)),s.c.info("Offline: OfflineDisable: disableOffline: The offline status is set to "+c.a.NotAvailable),e(Object(o.b)(!0)),s.c.info("Offline: offlineDisable: disableOffline: Completed")}(t)}return Promise.resolve()}}}function m(e){return{type:g,payload:{offlineFeatureStatus:e}}}},f9Qq:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n("NjDY"),r=n("9eA9"),i=n("pF61"),o=n("ILmX"),s=n("SAYH"),c=n("zmL5"),l=n("IqkD"),u=n("iZ7K");function d(e){const t=Object(a.x)(e),n=Object(u.h)(e,h(e));let d;if(d=n&&n.EntityHelpUrlEnabled&&n.EntityHelpUrl?n.EntityHelpUrl:Object(a.i)(e),d){if(t&&t.globalAppendUrlParametersEnabled){const t=Object(i.c)(e);return function(e,t,n,a,i){const o=new r.a(e);o.searchParams.append("userlcid",t),n&&o.searchParams.append("typename",n);a&&(o.searchParams.append("entrypoint",a),i&&o.searchParams.append("formid",i));return o.toString()}(d,function(e){const t=Object(a.x)(e);return(Object(l.s)(e)||t.languageCode).toString()}(e),h(e),function(e,t){if("entityrecord"===Object(i.k)(e,t))return"form";if(Object(o.o)(e,t))return"hierarchychart";return""}(e,t),s.a.toString(Object(c.b)(e,t)))}return d}return"https://go.microsoft.com/fwlink/p/?linkid=846388"}function h(e){const t=new r.a(window.location.href);return t&&t.searchParams?t.searchParams.get("etn"):void 0}},fREn:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var a=n("eXjw"),r=n("dHD5"),i=n("37s6"),o=n("a8zb"),s=n("BoVI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e,t,n,i,o,c,u,d){const h=Object(r.v)(o),g=function(e,t){if(!e)return null;const n=new DOMParser,a=e?n.parseFromString(e,"text/xml"):null;if(!a)return null;const r=a.documentElement?a.documentElement.children?a.documentElement.children:a.documentElement.childNodes:void 0;if(!r)return null;const i=r,o=[];for(let e=0;e<i.length;e++){if(!i[e].getAttribute)continue;const a=i[e]?i[e].children?i[e].children:i[e].childNodes:void 0,r=[];let s=null;for(let e=0;e<a.length;e++){const i=a[e];if(!i.getAttribute)continue;const o=i.getAttribute("name");let c;({relatedEntityName:c,fetchXmlDocument:s}=l(o,s,n,t)),r.push({name:o,width:parseInt(i.getAttribute("width"),10),relatedEntityName:c,disableMetaDataBinding:"1"===i.getAttribute("disableMetaDataBinding"),labelId:i.getAttribute("labelId"),isHidden:"1"===i.getAttribute("isHidden"),disableSorting:"1"===i.getAttribute("disableSorting"),addedBy:i.getAttribute("addedBy"),desc:i.getAttribute("desc"),cellType:i.getAttribute("cellType"),imageProviderWebresource:i.getAttribute("imageProviderWebresource"),imageProviderFunctionName:i.getAttribute("imageProviderFunctionName")})}const c={name:i[e].getAttribute("name"),id:i[e].getAttribute("id"),cells:r,multiObjectIdField:i[e].getAttribute("multiObjectIdField"),layoutStyle:i[e].getAttribute("multiObjectIdField")};o.push(c)}return{name:a.documentElement.getAttribute("name"),object:parseInt(a.documentElement.getAttribute("object"),10),rows:o,customControlDescriptions:null,jump:a.documentElement.getAttribute("jump"),select:"1"===a.documentElement.getAttribute("select"),icon:"1"===a.documentElement.getAttribute("icon"),preview:"1"===a.documentElement.getAttribute("preview"),iconRenderer:null}}(d,u),p={initialized:a.a.Initialized,viewId:n,fetchXML:u,entityLogicalName:i,title:c,layoutXML:d,grid:g,isCustomView:!0};return{type:s.a,payload:{views:{[n.guid]:p}},meta:{pageId:e,controlName:t,contextKey:h}}}function l(e,t,n,a){let r="";if(e.indexOf(".")>0){const i=e.split(".")[0];t||(t=n.parseFromString(a,"text/xml"));const o=t.querySelector('link-entity[alias="'+i+'"]');o&&(r=o.getAttribute("name")||"")}return{relatedEntityName:r,fetchXmlDocument:t}}function u(e){return{type:s.f,execute:(t,n)=>(Object(i.w)(t.getState())?o.a.createSqlfromFetchXMLAsync(t,e.fetchXML):Promise.resolve(null)).then(t=>e.offlineSqlQuery=t)}}},fyfl:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d}));var a=n("SAYH"),r=n("FZDd"),i=n("d0w6"),o=n("Uv1Y"),s=n("a72m"),c=n("BFlg"),l=n("kKLx"),u=n("P6DH");function d(e,t,n){return{type:"datasethost.dependencies.retrieve.async",execute({dispatch:d,getState:g},p){const m=p.TraceManager.getTracer(c.z),b=c.x+".loadDataSetHostDependenciesAction";m.info(`Retrieving view with ID ${a.a.toString(t)} for ${e} entity.`);const f=Object(u.pb)(g(),e,t);return d(Object(s.a)(e,i.a.MAIN_APPLICATION_VIEW,f,t)).then(i=>{if(!i){const n=`Unable to retrieve DataSetHost dependencies for the grid. Failed to retrieve view with ID ${a.a.toString(t)} for ${e}`;return p.EventManager.ReportComponentFailure(b,Error(n)),Promise.reject(new o.a(l.b))}const s=h(g(),t,n);return d(Object(r.e)(s)).then(()=>{const n=[{name:"entityTypeName",value:e},{name:"viewId",value:a.a.toString(t)}];return p.EventManager.ReportComponentSuccess(b,n),Promise.resolve()}).catch(n=>{let r=[];for(const e in s)s[e].length&&(r=[...s[e],...r]);const i=`Unable to retrieve DataSetHost dependencies for the grid for view with ID ${a.a.toString(t)}. Failed to retrieve entity with attributes ${r.join()} for ${e}`;return p.EventManager.ReportComponentFailure(b,Error(i)),Promise.reject(new o.a(l.a))})})}}}function h(e,t,n){const a=Object(u.qb)(e,t,n),r={};if(a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells){const e=[];a.grid.rows[0].cells.forEach(t=>{if(!t.disableMetaDataBinding)if(t.relatedEntityName){if(t.name&&-1!==t.name.indexOf(".")){const e=t.name.split(".")[1];r[t.relatedEntityName]||(r[t.relatedEntityName]=[]),-1===r[t.relatedEntityName].indexOf(e)&&e&&r[t.relatedEntityName].push(e)}}else-1===e.indexOf(t.name)&&e.push(t.name)}),e.length>0&&(r[a.entityLogicalName]=e)}return r}},hA8P:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="control.mrudisabled";function i(e,t,n,i,o){const s=Object(a.v)(i);return{type:r,payload:o,meta:{pageId:t,controlName:n,contextKey:s}}}},"hQd/":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));class a{constructor(e){this._value=null,this._value=e}get value(){return this._value}set value(e){this._value=e}}},hSDL:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"l",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"m",(function(){return f})),n.d(t,"n",(function(){return y})),n.d(t,"k",(function(){return C})),n.d(t,"h",(function(){return _})),n.d(t,"o",(function(){return p})),n.d(t,"j",(function(){return v}));var a=n("dHD5"),r=n("BFlg"),i=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="grid.applyFilter",s="grid.applyActivityTypeFilter",c="grid.applyJumpBarFilter",l="grid.applyQuickFindFilter",u="grid.applyFilterCurrentValue",d="grid.applyActivityTypeFilterCurrentValue",h="grid.applyAdvancedFindFilter";function g(e,t,n,i){return{type:"grid.applyFilter.async",execute({dispatch:o},s){const c=s.TraceManager.getTracer(r.z),l=r.x+".applyGridFilterAction",u=Object(a.v)(i),d=[];d.push({name:r.n,value:e}),d.push({name:r.e,value:u});try{return c.info("Applying the filter expression to the grid. "),o(function(e,t,n,a){return{type:e,payload:t,meta:{pageId:n,dataSetContextKey:a}}}(e,t,n,u)),s.EventManager.ReportComponentSuccess(l,d),Promise.resolve()}catch(e){const t="Applying the filter expression to the grid failed ";s.EventManager.ReportComponentFailure(l,Error(t),"",d)}}}}function p(e,t,n){const r=Object(a.v)(n);return{type:c,payload:e,meta:{pageId:t,dataSetContextKey:r}}}const m=(e,t,n)=>g(o,e,t,n),b=(e,t,n)=>g(s,e,t,n),f=(e,t,n)=>g(c,e,t,n),y=(e,t,n)=>g(l,Object(i.a)(e)?e:e.trim(),t,n),C=(e,t,n)=>g(u,e,t,n),_=(e,t,n)=>g(d,e,t,n),v=(e,t,n)=>g(h,e,t,n)},hSpC:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return y})),n.d(t,"i",(function(){return C})),n.d(t,"j",(function(){return v})),n.d(t,"b",(function(){return _}));var a=n("NjDY"),r=n("Pr02"),i=n("YxC/"),o=n("GYEz"),s=n("YPXd"),c=n("3/02"),l=n("Lyxw"),u=n("VL4U"),d=n("IqkD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function h(e,t){return{label:Object(i.c)(t,r.b),value:Object(o.j)(e)}}function g(e){return{label:Object(i.c)(e,r.f),value:window.VERSION_NUMERIC_VALUE}}function p(e,t){const n=Object(i.c)(t,r.h),a=Object(s.a)(e);return{label:n,value:a?a.externalCorrelationId:""}}function m(e,t){return{label:Object(i.c)(t,r.n),value:Object(a.y)(e).organizationName}}function b(e,t){var n;const o=null===(n=Object(a.x)(e))||void 0===n?void 0:n.isCrmOrg,s=Object(i.c)(t,o?r.d:r.o);return Object(u.b)(e,s)}function f(e,t){if(!Object(d.w)(e).isLive)return"";const n=function(e){const t=Object(l.c)(e,c.Lc),n=Object(l.c)(e,c.h),a=Object(l.c)(e,c.Kc),i=Object(l.c)(e,c.Yc);if(t)return r.m;if(n)return r.c;if(a)return r.l;if(i)return r.p;return null}(e);return n?Object(i.c)(t,n):""}function y(e,t){const n=Object(i.c)(t,r.q),o=Object(a.y)(e).serverVersion;return{label:n,value:Object(i.c)(t,r.r).replace("{0}",o).replace(" (DB {1})","")}}function C(e,t){return{label:Object(i.c)(t,r.e),value:e.EventManager.getCurrentSessionId()}}function _(e,t){const n=Object(o.h)(e);if(!n)return[];const{ShimContextId:a,ShimSessionId:s,ShimVersion:c}=n;return[{label:Object(i.c)(t,r.i),value:a},{label:Object(i.c)(t,r.j),value:s},{label:Object(i.c)(t,r.k),value:c}]}function v(e){const t=Object(i.c)(e,r.g),n=new Date;return{label:t,value:"{0} {1}".replace("{0}",n.toLocaleDateString()).replace("{1}",n.toLocaleTimeString())}}},haag:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="Chart.Component",r="ViewId",i="visualizationId",o="entity Type",s="chart visualization type",c="RETRIEVECHART",l="RETRIEVECHARTTS_RETRIEVECHARTSELECTOR",u="RETRIEVECHARTTS_RETRIEVECHARTDATA",d="RETRIEVECHARTTS_RETRIEVECHARTODATA"},iOI1:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="offline.available.primary.entities.update";function r(e){return{type:a,payload:{offlineAvailablePrimaryEntities:e}}}},iOrn:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var a=n("dHD5"),r=n("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="grid.setCustomFilter";function o(e,t,n,o,s){return{type:"grid.setCustomFilter.async",execute({dispatch:c,getState:l},u){const d=u.TraceManager.getTracer(r.z),h=r.x+".setCustomFilterAction";try{return d.info("Adding a custom filter for the grid. "),c(function(e,t,n,r,o){let s=null;if(null!=e){s={customFilterXml:e,source:t,timeStamp:o||null}}const c=Object(a.y)(r),l=Object(a.v)(r);return{type:i,payload:s,meta:{pageId:n,contextKey:c,dataSetContextKey:l}}}(e,t,n,o,s)),u.EventManager.ReportComponentSuccess(h),Promise.resolve()}catch(e){const t="Adding a custom filter for the grid failed";u.EventManager.ReportComponentFailure(h,Error(t))}}}}},j2fa:function(e,t,n){"use strict";n.d(t,"b",(function(){return ve})),n.d(t,"d",(function(){return Se})),n.d(t,"e",(function(){return Oe})),n.d(t,"c",(function(){return Ie})),n.d(t,"a",(function(){return je}));var a=n("Wgxh"),r=n("SAYH"),i=n("eXjw"),o=n("95wm");var s=n("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var c=n("odYE"),l=n("VcAV"),u=n("MXaZ");class d{constructor(){this._dataPointAggregators=new Array(0),this._dataPointDateTimeRangeAggregatorInfoMap=new Map,this._dataPointFiscalPeriodAggregators=new Array(0),this._dataPointFiscalYearAggregators=new Array(0)}addAggregator(e,t,n,a,i){if(n>=s.a.DAY&&n<s.a.FISCAL_PERIOD)this._addDateTimeRangeAggregatorInfo(e,t,n,a,i);else if(n===s.a.FISCAL_PERIOD)this._addDataPointFiscalPeriodAggregator(e,t,a,i);else if(n===s.a.FISCAL_YEAR)this._addDataPointFiscalYearAggregator(e,t,a,i);else{const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,Value:e&&e.Value||null,DisplayName:e&&e.DisplayName||null,EntityLogicalName:e&&e.EntityLogicalName||null}}();if(n.FieldName=e,n.EntityName=a,n.LinkEntityExpressionArray=i,Object(l.c)(t))n.Value=null;else if(t instanceof c.a){const e=t;n.Value=e.id.guid,n.DisplayName=e.name,n.EntityLogicalName=e.etn}else t instanceof r.a?n.Value=r.a.toString(t):n.Value=t.toString();this._dataPointAggregators.push(n)}}static _daysInMonth(e,t){return new Date(e,t,0).getDate()}_addDataPointFiscalPeriodAggregator(e,t,n,a){const r=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0,Period:e&&e.Period||0}}();if(r.FiscalType="in-fiscal-period-and-year",r.FieldName=e,r.EntityName=n,r.LinkEntityExpressionArray=a,!t)return void this._dataPointFiscalPeriodAggregators.push(r);if("string"!=typeof t)throw new Error("value should be string");if(t.indexOf("-")<=0)throw new Error("value should have xxxx-yy format");const i=t.split("-");r.Year=Number(i[0]),r.Period=Number(i[1]),this._dataPointFiscalPeriodAggregators.push(r)}_addDataPointFiscalYearAggregator(e,t,n,a){const r=function(e){return{FieldName:e&&e.FieldName||null,EntityName:e&&e.EntityName||null,LinkEntityExpressionArray:e&&e.LinkEntityExpressionArray||null,FiscalType:e&&e.FiscalType||null,Year:e&&e.Year||0}}();if(r.FiscalType="in-fiscal-year",r.FieldName=e,r.EntityName=n,r.LinkEntityExpressionArray=a,t){if("number"!=typeof t)throw new Error("value should be number");r.Year=Number(t),this._dataPointFiscalYearAggregators.push(r)}else this._dataPointFiscalYearAggregators.push(r)}_addDateTimeRangeAggregatorInfo(e,t,n,a,r){let i=null;switch(this._dataPointDateTimeRangeAggregatorInfoMap.has(e)?i=this._dataPointDateTimeRangeAggregatorInfoMap.get(e):(i=function(e){return{dateTimeAggregatorDay:(null==e?void 0:e.dateTimeAggregatorDay)||null,dateTimeAggregatorWeek:(null==e?void 0:e.dateTimeAggregatorWeek)||null,dateTimeAggregatorMonth:(null==e?void 0:e.dateTimeAggregatorMonth)||null,dateTimeAggregatorYear:(null==e?void 0:e.dateTimeAggregatorYear)||null,dateTimeAggregatorFieldName:(null==e?void 0:e.dateTimeAggregatorFieldName)||null,dateTimeAggregatorEntityName:(null==e?void 0:e.dateTimeAggregatorEntityName)||null,dateTimeAggregatorLinkEntityExpressionArr:(null==e?void 0:e.dateTimeAggregatorLinkEntityExpressionArr)||null,dateTimeAggregatorPrecision:(null==e?void 0:e.dateTimeAggregatorPrecision)||s.a.YEAR}}({dateTimeAggregatorFieldName:e}),this._dataPointDateTimeRangeAggregatorInfoMap.set(e,i)),i.dateTimeAggregatorEntityName||(i.dateTimeAggregatorEntityName=a),i.dateTimeAggregatorLinkEntityExpressionArr||(i.dateTimeAggregatorLinkEntityExpressionArr=r),n){case s.a.DAY:i.dateTimeAggregatorDay=Number(t);break;case s.a.WEEK:i.dateTimeAggregatorWeek=Number(t);break;case s.a.MONTH:i.dateTimeAggregatorMonth=Number(t);break;case s.a.QUARTER:i.dateTimeAggregatorMonth=3*Number(t);break;case s.a.YEAR:i.dateTimeAggregatorYear=Number(t);break;default:throw new Error("DateTime Group type not supported")}i.dateTimeAggregatorPrecision=Math.min(n,i.dateTimeAggregatorPrecision)}_getDataPointDateTimeRangeAggregators(e,t){const n=new Array(0);return 0===this._dataPointDateTimeRangeAggregatorInfoMap.size||this._dataPointDateTimeRangeAggregatorInfoMap.forEach((a,r)=>{const i={FieldName:(null==o?void 0:o.FieldName)||null,EntityName:(null==o?void 0:o.EntityName)||null,LinkEntityExpressionArray:(null==o?void 0:o.LinkEntityExpressionArray)||null,MinDate:(null==o?void 0:o.MinDate)||null,MaxDate:(null==o?void 0:o.MaxDate)||null};var o;if(i.FieldName=a.dateTimeAggregatorFieldName,i.EntityName=a.dateTimeAggregatorEntityName,i.LinkEntityExpressionArray=a.dateTimeAggregatorLinkEntityExpressionArr,a.dateTimeAggregatorYear){switch(a.dateTimeAggregatorMonth=a.dateTimeAggregatorMonth?a.dateTimeAggregatorMonth:12,a.dateTimeAggregatorDay=a.dateTimeAggregatorDay?a.dateTimeAggregatorDay:d._daysInMonth(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth),i.MaxDate=new Date(a.dateTimeAggregatorYear,a.dateTimeAggregatorMonth-1,a.dateTimeAggregatorDay),a.dateTimeAggregatorPrecision){case s.a.DAY:h(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth(),i.MaxDate.getDate());break;case s.a.WEEK:{t===u.a.FirstFullWeekOfTheYear&&(t=u.a.FirstDayOfTheYear);let n=Object(u.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek,e,t),r=Object(u.s)(a.dateTimeAggregatorYear,a.dateTimeAggregatorWeek+1,e,t);if(r.setDate(r.getDate()-1),t===u.a.FirstDayOfTheYear){if(r>=new Date(a.dateTimeAggregatorYear+1,0,1))r=new Date(a.dateTimeAggregatorYear+1,0,0);else if(1===a.dateTimeAggregatorWeek){const e=new Date(a.dateTimeAggregatorYear,0,1);n<e&&(n=e)}}i.MinDate=n,i.MaxDate=r,h(i.MaxDate),h(i.MinDate);break}case s.a.MONTH:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-1,d._daysInMonth(a.dateTimeAggregatorYear,i.MaxDate.getMonth())+1),h(i.MaxDate),h(i.MinDate);break;case s.a.QUARTER:i.MinDate=new Date(i.MaxDate.getFullYear(),i.MaxDate.getMonth()-3,d._daysInMonth(a.dateTimeAggregatorYear,i.MaxDate.getMonth()-2)+1),h(i.MaxDate),h(i.MinDate);break;case s.a.YEAR:h(i.MaxDate),i.MinDate=new Date(i.MaxDate.getFullYear()-1,i.MaxDate.getMonth(),i.MaxDate.getDate()+1);break;default:throw new Error("DateTime Group type not supported")}n.push(i)}else n.push(i)}),n}getAggregators(e,t){let n=this._dataPointAggregators;const a=this._getDataPointDateTimeRangeAggregators(e,t);return a&&a.length>0&&(n=n.concat(a)),this._dataPointFiscalPeriodAggregators&&this._dataPointFiscalPeriodAggregators.length>0&&(n=n.concat(this._dataPointFiscalPeriodAggregators)),this._dataPointFiscalYearAggregators&&this._dataPointFiscalYearAggregators.length>0&&(n=n.concat(this._dataPointFiscalYearAggregators)),n}}function h(e){e.getTimezoneOffset()<0&&e.setDate(e.getDate()+1)}var g=n("YxC/"),p=n("GEBM"),m=n("IqkD"),b=n("Xd5/"),f=n("nfCs"),y=n("NjDY"),C=n("LbMF"),_=n("S70w"),v=n("Ae6N");function S(e,t){const n=Object(C.a)(e,t.entity.entityName,t.attributeName);let a=n?n.DisplayName:null;a||(a=t.attributeName);let r=a;if(t.dateTimeGrouping){const n=f.c(t.dateTimeGrouping.groupingType).replace("-","").toUpperCase();r=String.format(Object(g.b)(e,p.c),Object(g.b)(e,`${p.c}.${n.toUpperCase()}`),a)}else t.hasAggregate&&t.aggregateType&&(r=String.format(Object(g.b)(e,p.d),Object(g.b)(e,`${p.d}.${t.aggregateType.toUpperCase()}`),a));if(n&&"money"===n.Type){let a="",i=null;const o=Object(y.x)(e);n.IsBaseCurrency?o&&o.baseCurrencyId&&o.transactionCurrencyById&&(i=o.transactionCurrencyById[o.baseCurrencyId.guid]):t.hasAggregate&&(i=Object(m.b)(e)),i&&(a=o&&o.currencyDisplayOption===_.a.CurrencyCode?i.currencyCode:i.currencySymbol),a&&(r=String.format(Object(g.b)(e,p.b),r,a))}return r}function O(e,t,n){return n>0?String.format(Object(g.b)(e,p.y),n,t):String.format(Object(g.b)(e,p.w),t)}function I(e,t,n,a,r){const i=r<1&&a>=1&&n<1,o=r<1&&a<1&&n>=1,s=a<1&&n<1;if(r>=1&&a<1&&n>=1){const a=new Date(t,n-1,r),{formatInfoCultureName:i,numberFormatInfo:o,dateFormatInfo:s}=Object(m.w)(e),c=new Sys.CultureInfo(i,o,s);return Object(b.s)(a,c,v.a.None)}return i?String.format(Object(g.b)(e,p.z),a,t):o?String.format("{0} {1}",function(e){const t=Object(g.b)(e,p.e).split(",");if(!t||12!==t.length)throw new Error("Expect 12 months! Actual: "+t.length);return t}(e)[n-1],t):s?String(t):""}function j(e){return Object(g.b)(e,p.v)}var P=n("WPtp"),x=n("16wZ");function E(e,t,n){let a=!1;n&&n.groupAttribute&&n.groupAttribute.dateTimeGrouping&&(a=!0);return{attribute:t,primaryGroupBy:n,aliasName:t.aliasName||t.attributeName,state:e,isDateTimeChart:a}}function w(e,t){let n=e.isDateTimeChart?function(e,t){if(!t.fields||!Object(P.c)(t.fields[e.aliasName]))return"";switch(e.attribute.dateTimeGrouping.groupingType){case s.a.DAY:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);return I(e.state,r,a,-1,n)}(e,t);case s.a.WEEK:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,a,-1,n,-1)}(e,t);case s.a.MONTH:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return I(e.state,a,n,-1,-1)}(e,t);case s.a.QUARTER:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);return O(e.state,a,n)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t);case s.a.FISCAL_PERIOD:return function(e,t){return Object(P.e)(t.fields[e.aliasName])}(e,t);case s.a.YEAR:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]);return I(e.state,n,-1,-1,-1)}(e,t);case s.a.FISCAL_YEAR:return function(e,t){const n=Object(P.e)(t.fields[e.aliasName]);return O(e.state,n,-1)}(e,t);default:return Object(P.c)(t.fields[e.attribute.attributeName])}}(e,t):null;return n||(n=Object(P.c)(t.fields[e.aliasName]),n=n||""),0===n.length?Object(g.b)(e.state,p.v):n}function T(e,t){if(!e.attribute||!Object(C.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName))return w(e,t);switch(Object(C.a)(e.state,e.attribute.entity.entityName,e.attribute.attributeName).Type){case"picklist":case"status":case"state":case"boolean":{let n=Object(P.e)(t.fields[e.aliasName]);return n=Object(x.a)(n)?-1:Number(n),n}case"datetime":return function(e,t){let n=-1,a=-1,r=-1;switch(e.attribute.dateTimeGrouping.groupingType){case s.a.DAY:n=Object(P.e)(t.fields[e.aliasName]),a=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[1].aliasName]);break;case s.a.MONTH:a=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case s.a.YEAR:r=Object(P.e)(t.fields[e.aliasName]);break;case s.a.QUARTER:a=Object(P.e)(t.fields[e.aliasName]),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;case s.a.WEEK:n=1+7*(Object(P.e)(t.fields[e.aliasName])-1),r=Object(P.e)(t.fields[e.primaryGroupBy.extendedGroupBys[0].aliasName]);break;default:return w(e,t)}return new Date(r,a-1,n).getTime()}(e,t);default:return w(e,t)}}function A(e){return{Enabled:e&&e.Enabled||!1,X:e&&e.X||0,Y:e&&e.Y||0,Align:e&&e.Align||"left",VerticalAlign:e&&e.VerticalAlign||"middle",LabelFormatter:e&&e.LabelFormatter||null,Color:e&&e.Color||""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function F(e){return{Value:e&&e.Value||0,FormattedValue:e&&e.FormattedValue||null,Aggregators:e&&e.Aggregators||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class N extends Error{constructor(e,t,n){super(e),Object.setPrototypeOf(this,N.prototype),this.title=t,this.description=n}}var k=n("Lyxw"),M=n("3/02"),D=n("zh0k"),R=n("hwt8"),L=n("504W");function B(){return this.point.formattedValue}function V(e){return function(){return Highcharts.numberFormat(parseFloat(this.point.y)/e*100)+"%"}}class G{constructor(){this.isInitialized=!1}get primaryGroupBy(){return this.chartDataDescription&&this.chartDataDescription.category&&this.chartDataDescription.category.primaryGroupBy}get queryModel(){return this._queryModel}initialize(e,t,n,a,r,i,o,s,c,l){this.getState=e,this.chartData=t,this.chartDataDescription=n,this.categoryColumn=this.chartDataDescription.categoryColumns,this.chartPresentationSeries=a,this.chartPresentationXAxis=r,this.chartPresentationYAxis=i,this.chartPresentationArea3DStyle=o,this.chartPresentationAreaGradientStyle=s,this._queryModel=c,this.chartPresentationAnnotationList=l,this._isChartCustomizationParityFCBEnabled()&&this._validateChartAggregateAttributes(),this.isInitialized=!0}setXAxisMajorGridAndMajorTickProperties(e,t=0){var n,a,r,i,o,s,c,l;return e.AxisMajorGridColor=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[t])||void 0===a?void 0:a.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationXAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}setYAxisMajorGridAndMajorTickProperties(e,t=0){var n,a,r,i,o,s,c,l;return e.AxisMajorGridColor=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[t])||void 0===a?void 0:a.AxisMajorGridColor,e.AxisMajorGridEnabled=null===(i=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===i?void 0:i.AxisMajorGridEnabled,e.AxisMajorTickMarkColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisMajorTickMarkColor,e.AxisMajorTickMarkEnabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.AxisMajorTickMarkEnabled,e}retrieveChartArea3DStyle(){const e={};return e.Enable3D=this.chartPresentationArea3DStyle.Enable3D,e}retrieveChartAreaGradientStyle(){const e={};return e.BackColor=this.chartPresentationAreaGradientStyle.BackColor,e.BackSecondaryColor=this.chartPresentationAreaGradientStyle.BackSecondaryColor,e.BackGradientStyle=this.chartPresentationAreaGradientStyle.BackGradientStyle,e}setYAxisOppositeProperty(e){var t,n,a,r;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.Opposite=null===(r=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.IsReversed),e}setXAxisIsReversedProperty(e){var t,n,a,r;return this._isChartCustomizationParityFCBEnabled()&&(null===(n=null===(t=this.chartPresentationXAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.IsReversed)&&(e.IsReversed=null===(r=null===(a=this.chartPresentationXAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.IsReversed),e}retrieveChartYAxis(){const e=new Array(1);if(e[0]={},!this._queryModel.SeriesList)return e;const t=(e,t,n)=>{this.chartPresentationYAxis&&this.chartPresentationYAxis.length>t&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Title?e.Title=this.chartPresentationYAxis[t].Title:1===n&&(e.Title=this._queryModel.SeriesList[t].Title)};let n=0,a=-1,r=-1,i=!1,o=!1;for(let e=0;e<this.chartPresentationSeries.length;e++)this.chartPresentationSeries[e].SecondaryYAxis?(n++,r=-1===r?e:r,o=o||this.shouldDisableAllowDecimals(e)):(a=-1===a?e:a,i=i||this.shouldDisableAllowDecimals(e));return t(e[0],a,this.chartPresentationSeries.length-n),e[0].Opposite=!1,i&&(e[0].AllowDecimals=!1),0===n&&(e[0]=this.setYAxisOppositeProperty(e[0])),n>0&&(e[1]={},t(e[1],r,n),e[1].Opposite=!0,o&&(e[1].AllowDecimals=!1)),e.forEach((e,t)=>{var n,a,r,i,o,s,c,l,u,d,h,g,p,m;e.Disabled=this.chartPresentationYAxis&&this.chartPresentationYAxis[t]&&this.chartPresentationYAxis[t].Disabled,e.LabelForeColor=null===(a=null===(n=this.chartPresentationYAxis)||void 0===n?void 0:n[t])||void 0===a?void 0:a.LabelForeColor,e.AxisLineColor=null===(i=null===(r=this.chartPresentationYAxis)||void 0===r?void 0:r[t])||void 0===i?void 0:i.AxisLineColor,e.AxisTitleForeColor=null===(s=null===(o=this.chartPresentationYAxis)||void 0===o?void 0:o[t])||void 0===s?void 0:s.AxisTitleForeColor,e.LabelDisabled=null===(l=null===(c=this.chartPresentationYAxis)||void 0===c?void 0:c[t])||void 0===l?void 0:l.LabelDisabled,e.AxisInterval=null===(d=null===(u=this.chartPresentationYAxis)||void 0===u?void 0:u[t])||void 0===d?void 0:d.AxisInterval,e.AxisMinimum=null===(g=null===(h=this.chartPresentationYAxis)||void 0===h?void 0:h[t])||void 0===g?void 0:g.AxisMinimum,e.AxisMaximum=null===(m=null===(p=this.chartPresentationYAxis)||void 0===p?void 0:p[t])||void 0===m?void 0:m.AxisMaximum,e=this.setYAxisMajorGridAndMajorTickProperties(e,t)}),this.chartPresentationYAxis&&this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].FormatString?e[0].FormatString=this.chartPresentationYAxis[0].FormatString:e[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),n>0&&(this.chartPresentationYAxis&&this.chartPresentationYAxis[1]&&this.chartPresentationYAxis[1].FormatString?e[1].FormatString=this.chartPresentationYAxis[1].FormatString:e[1].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[r].measures[0].measureAttribute)),e}_isChartCustomizationParityFCBEnabled(){return Object(k.a)(this.getState(),M.s,M.Lc,M.w)}retrieveChartAnnotations(){const e=new Array(this.chartPresentationAnnotationList.length);for(let t=0;t<this.chartPresentationAnnotationList.length;t++){const n={};n.X=this.chartPresentationAnnotationList[t].X,n.Y=this.chartPresentationAnnotationList[t].Y,n.Text=this.chartPresentationAnnotationList[t].Text,n.ForeColor=this.chartPresentationAnnotationList[t].ForeColor,e[t]=n}return e}retrieveChartCategory(){var e,t,n,a,r,i;const o=new Array(1);let s=null;this.categoryColumn.length>0&&(s=E(this.getState(),this.categoryColumn[0],this.chartDataDescription.category.primaryGroupBy)),o[0]={};const c=new Array(this.chartData.length);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];if(s){if(c[e]=w(s,t),"-1"===c[e])c[e]=Object(g.b)(this.getState(),p.f);else if(!s.isDateTimeChart&&"number"==typeof Object(P.e)(t.fields[s.aliasName])&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString){const n=Object(m.w)(this.getState());c[e]=Object(R.c)(Object(P.e)(t.fields[s.aliasName]),Object(b.d)(n),this.chartPresentationXAxis[0].FormatString)}}else c[e]=j(this.getState())}return o[0].Title=this.retrieveChartCategoryTitle(s),o[0].Values=c,o[0].Disabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].Disabled,o[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,o[0].AxisLineColor=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisLineColor,o[0].AxisTitleForeColor=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.AxisTitleForeColor,o[0].LabelDisabled=this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].LabelDisabled,o[0]=this.setXAxisMajorGridAndMajorTickProperties(o[0]),o[0]=this.setXAxisIsReversedProperty(o[0]),o}retrieveChartCategoryTitle(e){return this.chartPresentationXAxis&&this.chartPresentationXAxis.length>0&&this.chartPresentationXAxis[0].Title?this.chartPresentationXAxis[0].Title:e?S((t=e).state,t.attribute):"";var t}retrieveChartSeries(e){const t=new Array(this.chartPresentationSeries.length);for(let n=0;n<this.chartPresentationSeries.length;n++){const a=this.chartDataDescription.category.measureCollections[n].measures[0].measureAttribute,r=a.aliasName?a.aliasName:a.attributeName,i=this.chartPresentationSeries[n].IsValueShownAsLabel,o=this.chartPresentationSeries[n].LabelFormat;let s=null;o&&Object(R.d)(o)&&(s=Object(R.g)(o));let c=!1;this.chartPresentationSeries[n].Label&&"#percent"===this.chartPresentationSeries[n].Label.toLowerCase()&&(c=!0);let l=!1;o&&z(this.chartPresentationSeries[n].ChartType)&&Object(R.e)(o)&&(l=!0);let u=null;const d=S(this.getState(),a);t[n]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[n]),this.chartPresentationSeries[n].SecondaryYAxis&&(t[n].YAxisNumber=1),this.primaryGroupBy&&(u=[],u.push(this.primaryGroupBy.groupAttribute),this.primaryGroupBy.extendedGroupBys&&this.primaryGroupBy.extendedGroupBys.forEach(e=>{u.push(e)}));const h=new Array(this.chartData.length),g=r;let p=0;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];h[e]=F();const a=Object(P.e)(t.fields[r]);if(h[e].Value=a||0,p+=a||0,o){const a=Object(m.w)(this.getState()),r=Object(b.d)(a);Object(R.f)(o)?h[e].FormattedValue=Object(D.b)(h[e].Value,this.chartPresentationSeries[n].LabelFormat,r):Object(R.d)(o)&&!l?h[e].FormattedValue=Object(R.a)(h[e].Value,s,r):h[e].FormattedValue=Object(P.c)(t.fields[g])||0}else h[e].FormattedValue=Object(P.c)(t.fields[g])||0;this.attachAggregators(h[e],t,u)}const f=A();i?(f.Enabled=!0,f.LabelFormatter=B):c&&(f.Enabled=!0,f.LabelFormatter=V(p)),f.Color=this.chartPresentationSeries[n].LabelForeColor,t[n].DataLabels=f,t[n].DataPoints=h,t[n].Title=this.getChartTitleFromPresentationSeries(d,n),t[n].XAxisNumber=e,t[n].HideInLegend=this.chartPresentationSeries[n].HideInLegend,t[n].Stack=this.chartPresentationSeries[n].Stack}const n=Object(m.w)(this.getState()),a=Object(b.d)(n),r=this.chartPresentationSeries[0].IsValueShownAsLabel,i=this.chartPresentationSeries[0].LabelFormat;if(r&&z(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(i)){const e=W(i,a);for(let n=0;n<t[0].DataPoints.length;n++)e(0,n,0,t)}return t}getChartTitleFromPresentationSeries(e,t=0){return Object(L.b)(this.chartPresentationSeries[t].LegendText)?Object(L.b)(this.chartPresentationSeries[t].Name)?e:this.chartPresentationSeries[t].Name:this.chartPresentationSeries[t].LegendText}shouldDisableAllowDecimals(e){const t=this.chartDataDescription.category.measureCollections[e].measures[0].measureAttribute;return"count"===t.aggregateType||"countcolumn"===t.aggregateType}cloneBlueprintSeriesStyle(e){const t={DataPoints:n&&n.DataPoints||null,DataLabels:n&&n.DataLabels||null,ChartType:n&&n.ChartType||"line",YAxisNumber:n&&n.YAxisNumber||0,XAxisNumber:n&&n.XAxisNumber||0,Title:n&&n.Title||"",Color:n&&n.Color||"",BorderColor:n&&n.BorderColor||"",BorderWidth:n&&n.BorderWidth||0,CustomProperties:n&&n.CustomProperties||null,Stack:n&&n.Stack||null};
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var n;return t.ChartType=e.ChartType,t.Color=e.Color,t.BorderColor=e.BorderColor,t.BorderWidth=e.BorderWidth,t.CustomProperties=e.CustomProperties,t}attachAggregators(e,t,n){if(n){const a=new d;for(let e=0;e<n.length;e++){const r=n[e],i=new Array;r.entity.baseEntity&&r.entity.baseEntity.linkedEntities&&r.entity.baseEntity.linkedEntities.forEach(e=>{const t={name:n&&n.name||null,from:n&&n.from||null,to:n&&n.to||null,linkType:n&&n.linkType||null,alias:n&&n.alias||null};var n;t.name=e.entityName,t.from=e.linkFromAttribute,t.to=e.linkToAttribute,t.linkType=e.joinType.toString(),t.alias=e.alias,i.push(t)}),a.addAggregator(r.attributeName,Object(P.e)(t.fields[G._getFieldName(r)]),r.dateTimeGrouping?r.dateTimeGrouping.groupingType:-1,r.entity.entityName,i)}const r=Object(m.w)(this.getState()),i=this._getFirstDayOfWeekFromUserSettings(r),o=this._getCalendarWeekRuleFromUserSettings(r);e.Aggregators=a.getAggregators(i,o)}}_getFirstDayOfWeekFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.FirstDayOfWeek)||0}_getCalendarWeekRuleFromUserSettings(e){var t;return(null===(t=e.dateFormatInfo)||void 0===t?void 0:t.CalendarWeekRule)||0}getFormatterPropertiesForAttribute(e){return Object(b.z)(this.getState(),Object(C.a)(this.getState(),e.entity.entityName,e.attributeName))}static _getFieldName(e){return e.aliasName&&e.aliasName.trim()?e.aliasName:e.attributeName}isChartDrillable(){if(!this._isGroupByDrillable(this.chartDataDescription.category.primaryGroupBy))return!1;for(const e of this.chartDataDescription.category.measureCollections)for(const t of e.secondaryGroupBys)if(!this._isGroupByDrillable(t))return!1;return!!this.chartDataDescription.entityExpression.hasAggregate}_isGroupByDrillable(e){return!this.chartDataDescription.isGroupByFromNestedLinkEntity()&&(!(!e||!e.groupAttribute.hasGroupBy)&&this._isAttributeDrillable(e.groupAttribute))}_isAttributeDrillable(e){var t;const n=null===(t=null==e?void 0:e.entity)||void 0===t?void 0:t.entityName,a=null==e?void 0:e.attributeName;return"memo"!==Object(C.b)(a,n,this.getState())}_validateChartAggregateAttributes(){var e,t,n,a;for(let r=0;r<(null===(n=null===(t=null===(e=this.chartDataDescription)||void 0===e?void 0:e.entityExpression)||void 0===t?void 0:t.aggregateAttributes)||void 0===n?void 0:n.length);r++){const e=this.chartDataDescription.entityExpression.aggregateAttributes[r],t=null===(a=null==e?void 0:e.entity)||void 0===a?void 0:a.entityName,n=null==e?void 0:e.attributeName,i=Object(C.b)(n,t,this.getState());if(!("date"!==i&&"datetime"!==i||"min"!==e.aggregateType&&"max"!==e.aggregateType)){const e=String.format(Object(g.b)(this.getState(),p.h),n);throw new N("ChartError",e,e)}}}}function z(e){return!!e&&("stackedbar100"===e.toLowerCase()||"stackedcolumn100"===e.toLowerCase()||"stackedarea100"===e.toLowerCase())}function W(e,t){return function n(a,r,i,o){if(a===o.length)return i;const s=o[a].DataPoints[r];return i=n(++a,r,i+(s&&s.Value?s.Value:0),o),s&&s.Value&&(s.FormattedValue=Object(R.a)(s.Value/i*100,Object(R.g)(e),t)),i}}var X=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class H extends G{parse(){var e,t,n,a;if(!this.isInitialized)throw new Error("The instance of the ComparisonChartDataParser class is not properly initialized.");const r=new Array(0),i=new Map,o=this.chartDataDescription.category,s=o.measureCollections[0];if(s.secondaryGroupBys.length<=0)throw new Error("Comparison chart can only be plotted with secondary groups's");if(s.measures&&s.measures.length>0&&s.measures[0].parentCategory&&s.measures[0].parentCategory.primaryGroupBy&&(s.measures[0].parentCategory.primaryGroupBy.groupAttribute&&r.push(s.measures[0].parentCategory.primaryGroupBy.groupAttribute),s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys))for(let e=0;e<s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys.length;e++)r.push(s.measures[0].parentCategory.primaryGroupBy.extendedGroupBys[e]);if(1!==this.chartPresentationSeries.length)throw new Error("Comparison chart should have only one series");const c=this._addSecondaryGroupByToFieldAggregators(s,r),l=s.measures[0].measureAttribute,u=l.aliasName?l.aliasName:l.attributeName,d=u,h=o.primaryGroupBy.groupAttribute,g=E(this.getState(),this._getGroupByAttribute(h,o.primaryGroupBy),o.primaryGroupBy),p=new Array,f=new Array,y=new Map;for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e],n=w(g,t);let a,r=w(c,t);null==r?(r=j(this.getState()),a=r):a=T(c,t),i.set(a,r),f.indexOf(n)<0&&f.push(n),p.indexOf(a)<0&&p.push(a)}p.forEach(e=>{const t=new Array(f.length);y.set(e,t)});const C=Object(m.w)(this.getState()),_=this.chartPresentationSeries[0].LabelFormat;let v=!1;this.chartPresentationSeries[0].Label&&"#percent"===this.chartPresentationSeries[0].Label.toLowerCase()&&(v=!0);let S=!1;_&&z(this.chartPresentationSeries[0].ChartType)&&Object(R.e)(_)&&(S=!0);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];let n=T(c,t);Object(x.a)(n)&&(n=j(this.getState()));const a=y.get(n),i=w(g,t),o=f.indexOf(i);if(this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&(f[o]=Object(R.c)(Object(P.e)(t.fields[g.aliasName]),Object(b.d)(C),this.chartPresentationXAxis[0].FormatString)),a[o]=F(),a[o].Value=Object(P.e)(t.fields[u]),_){const n=Object(b.d)(C);Object(R.f)(_)?a[o].FormattedValue=Object(D.b)(a[e].Value,_,n):Object(R.d)(_)&&!S?a[o].FormattedValue=Object(R.a)(a[o].Value,Object(R.g)(_),n):a[o].FormattedValue=Object(P.c)(t.fields[d])||0}else a[o].FormattedValue=Object(P.c)(t.fields[d])||0;this.attachAggregators(a[o],t,r)}p.forEach(e=>{const t=y.get(e);for(let e=0;e<f.length;e++)t[e]||(t[e]=F())});const O=new Array(1);O[0]={},O[0].Title=this.retrieveChartCategoryTitle(g),O[0].Values=f,O[0].LabelForeColor=null===(e=this.chartPresentationXAxis[0])||void 0===e?void 0:e.LabelForeColor,O[0].AxisLineColor=null===(t=this.chartPresentationXAxis[0])||void 0===t?void 0:t.AxisLineColor,O[0].AxisTitleForeColor=null===(n=this.chartPresentationXAxis[0])||void 0===n?void 0:n.AxisTitleForeColor,O[0].LabelDisabled=null===(a=this.chartPresentationXAxis[0])||void 0===a?void 0:a.LabelDisabled,O[0]=this.setXAxisMajorGridAndMajorTickProperties(O[0]),O[0]=this.setXAxisIsReversedProperty(O[0]),this._sortComparisonCodes(s,p);const I=new Array(p.length),N=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].IsValueShownAsLabel,k=this.chartPresentationSeries[0]?this.chartPresentationSeries[0].LabelForeColor:null,M=this.chartPresentationSeries[0]&&this.chartPresentationSeries[0].HideInLegend,L=this.getChartTitleFromPresentationSeries(this.chartPresentationSeries[0].Name);for(let e=0;e<p.length;e++){const t=p[e];if(I[e]=this.cloneBlueprintSeriesStyle(this.chartPresentationSeries[0]),I[e].Title=L||i.get(t),I[e].DataPoints=y.get(t),I[e].HideInLegend=M,N){const t=A();t.Enabled=!0,t.LabelFormatter=B,I[e].DataLabels=t,t.Color=k}else if(v){let t=0;I[e].DataPoints.forEach(e=>{t+=e&&e.Value?e.Value:0});const n=A();n.Enabled=!0,n.LabelFormatter=V(t),I[e].DataLabels=n,n.Color=k}}if(N&&S){const e=W(_,Object(b.d)(C));for(let t=0;t<O[0].Values.length;t++)e(0,t,0,I)}this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=O,this.queryModel.YAxes=this._retrieveChartYAxis(l),this.queryModel.SeriesList=I,this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations()}_sortComparisonCodes(e,t){e.secondaryGroupBys[0].descending?t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?t-e:t.localeCompare(e)):t.sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e.localeCompare(t))}_getGroupByAttribute(e,t){return e.attributeName!==Object(X.h)(this.getState(),e.entity.entityName).PrimaryIdAttribute?e:t.extendedGroupBys&&t.extendedGroupBys.length>0?t.extendedGroupBys[0]:e}_addSecondaryGroupByToFieldAggregators(e,t){const n=e.secondaryGroupBys[0].groupAttribute,a=E(this.getState(),this._getGroupByAttribute(n,e.secondaryGroupBys[0]),e.secondaryGroupBys[0]);if(n&&t.push(n),e.secondaryGroupBys[0].extendedGroupBys)for(let n=0;n<e.secondaryGroupBys[0].extendedGroupBys.length;n++)t.push(e.secondaryGroupBys[0].extendedGroupBys[n]);return a}_retrieveChartYAxis(e){var t,n,a,r,i,o,s,c;const l=new Array(1);return l[0]={},this.chartPresentationYAxis&&this.chartPresentationYAxis.length>0&&this.chartPresentationYAxis[0].Title?l[0].Title=this.chartPresentationYAxis[0].Title:l[0].Title=S(this.getState(),e),this.chartPresentationYAxis[0].FormatString?l[0].FormatString=this.chartPresentationYAxis[0].FormatString:l[0].FormatterProperties=this.getFormatterPropertiesForAttribute(this.chartDataDescription.category.measureCollections[0].measures[0].measureAttribute),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelForeColor&&(l[0].LabelForeColor=this.chartPresentationYAxis[0].LabelForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisLineColor&&(l[0].AxisLineColor=this.chartPresentationYAxis[0].AxisLineColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].AxisTitleForeColor&&(l[0].AxisTitleForeColor=this.chartPresentationYAxis[0].AxisTitleForeColor),this.chartPresentationYAxis[0]&&this.chartPresentationYAxis[0].LabelDisabled&&(l[0].LabelDisabled=null===(n=null===(t=this.chartPresentationYAxis)||void 0===t?void 0:t[0])||void 0===n?void 0:n.LabelDisabled),l[0].AxisInterval=null===(r=null===(a=this.chartPresentationYAxis)||void 0===a?void 0:a[0])||void 0===r?void 0:r.AxisInterval,l[0].AxisMinimum=null===(o=null===(i=this.chartPresentationYAxis)||void 0===i?void 0:i[0])||void 0===o?void 0:o.AxisMinimum,l[0].AxisMaximum=null===(c=null===(s=this.chartPresentationYAxis)||void 0===s?void 0:s[0])||void 0===c?void 0:c.AxisMaximum,this.shouldDisableAllowDecimals(0)&&(l[0].AllowDecimals=!1),l[0]=this.setYAxisMajorGridAndMajorTickProperties(l[0]),l[0]=this.setYAxisOppositeProperty(l[0]),l}}class U extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the DateTimeChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}retrieveChartCategory(){var e,t,n,a,r,i,o,s;const c=new Array(1);if(this.chartData.length<1)return c;const l=this.primaryGroupBy.groupAttribute;c[0]={};const u=new Array(this.chartData.length),d=E(this.getState(),l,this.primaryGroupBy);c[0].Title=this.retrieveChartCategoryTitle(d),c[0].LabelForeColor=null===(t=null===(e=this.chartPresentationXAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.LabelForeColor,c[0].AxisLineColor=null===(a=null===(n=this.chartPresentationXAxis)||void 0===n?void 0:n[0])||void 0===a?void 0:a.AxisLineColor,c[0].AxisTitleForeColor=null===(i=null===(r=this.chartPresentationXAxis)||void 0===r?void 0:r[0])||void 0===i?void 0:i.AxisTitleForeColor,c[0].LabelDisabled=null===(s=null===(o=this.chartPresentationXAxis)||void 0===o?void 0:o[0])||void 0===s?void 0:s.LabelDisabled,c[0]=this.setXAxisMajorGridAndMajorTickProperties(c[0]),c[0]=this.setXAxisIsReversedProperty(c[0]);for(let e=0;e<this.chartData.length;e++){const t=this.chartData[e];u[e]=w(d,t),d.isDateTimeChart&&this.chartPresentationXAxis&&this.chartPresentationXAxis[0]&&this.chartPresentationXAxis[0].FormatString&&u[e]!==Object(g.b)(d.state,p.v)&&(u[e]=Object(R.b)(new Date(u[e]),Object(b.d)(Object(m.w)(this.getState())),this.chartPresentationXAxis[0].FormatString))}return c[0].Values=u,c}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class q extends G{parse(){if(!this.isInitialized)throw new Error("The instance of the NormalChartDataParser class is not properly initialized.");this.categoryColumn&&0!==this.categoryColumn.length&&(this.queryModel.Area3DStyle=this.retrieveChartArea3DStyle(),this.queryModel.AreaGradientStyle=this.retrieveChartAreaGradientStyle(),this.queryModel.XAxes=this.retrieveChartCategory(),this.queryModel.SeriesList=this.retrieveChartSeries(0),this.queryModel.YAxes=this.retrieveChartYAxis(),this.queryModel.EnableDrilldown=this.isChartDrillable(),this.queryModel.Annotations=this.retrieveChartAnnotations())}}var Y=n("DAWX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function K(e){const t={};try{if(e){const n=/\w+=\w+/;e.split(/\s*,\s*/).forEach(e=>{if(e&&n.test(e)){const[n,a]=e.split("=");t[n]=a}})}}catch(t){throw`Failed to parse chart custom properties, value: ${e} `}return{FunnelNeckHeight:t&&Number(t.FunnelNeckHeight)||0,FunnelNeckWidth:t&&Number(t.FunnelNeckWidth)||10,StackedGroupName:t&&t.StackedGroupName||null}}var Q=n("S2mk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Z=["COLUMN","STACKEDCOLUMN","STACKEDCOLUMN100","BAR","STACKEDBAR","STACKEDBAR100","AREA","STACKEDAREA","STACKEDAREA100","LINE","PIE","FUNNEL","TAG","DOUGHNUT","POINT"];function J(e,t,n){const a=(new DOMParser).parseFromString(t,"text/xml");!function(e,t){const n=e.getElementsByTagName("parsererror");if(n&&n.length>0)throw new N("ChartError",Object(g.b)(t,p.t),Object(g.b)(t,p.s))}(a,e);return{chartPresentationSeries:$(e,a,n),chartPresentationLegendList:ne(a),colorsList:te(a),chartPresentationArea3DStyle:se(a),chartPresentationAreaGradientStyle:ce(a),chartPresentationXAxis:re(a),chartPresentationYAxis:ie(a),chartPresentationAnnotationList:ae(a)}}function $(e,t,n){const a=new Array,r=t.querySelectorAll("Chart Series Series"),i=new XMLSerializer;for(let t=0;t<r.length;t++){const o=r[t],s={},c=o.getAttribute("ChartType")||"Column";if(-1===Z.indexOf(c.toUpperCase()))throw new N("ChartError",Object(g.b)(e,p.t),Object(g.b)(e,p.t));s.ChartType=c;const l=o.getAttribute("Color");s.Color=l?le(l):null;const u=o.getAttribute("LegendText");s.LegendText=u||null;const d=o.getAttribute("CustomProperties");s.CustomProperties=K(d);const h=o.getAttribute("BorderColor");s.BorderColor=h?le(h):null;const m=o.getAttribute("BorderWidth");s.BorderWidth=m?Number(m):null;const b=o.getAttribute("IsValueShownAsLabel");s.IsValueShownAsLabel=b&&"true"===b.toLowerCase()||!1,s.Label=o.getAttribute("Label");const f=o.getAttribute("YAxisType");s.SecondaryYAxis=f&&"secondary"===f.toLowerCase();const y=o.getAttribute("IsVisibleInLegend");s.HideInLegend=y&&"false"===y.toLowerCase();const C=o.getAttribute("LabelForeColor");s.LabelForeColor=C?le(C):null,s.LabelFormat=o.getAttribute("LabelFormat");const _=ee(e,o.outerHTML||i.serializeToString(o),n);s.Name=_||null,s.Stack=s.CustomProperties.StackedGroupName,a.push(s)}return a}function ee(e,t,n){const a=Object(o.a)(t);if(Object(Q.j)(a)||a.length<5)return"";const r=a[2].toLowerCase(),i=a[4];let s="";const c=r.substring(0,n.length);if(c!==n)return"";const l=r.substring(n.length+1,r.length),u=Object(C.a)(e,c,l);return u&&u.OptionSet&&(s=u.OptionSet.filter(e=>e.Value.toString().toLowerCase()===i.toLowerCase())[0].Label),s}function te(e){const t=new Array,n=e.querySelector("Chart").getAttribute("PaletteCustomColors");return null!==n&&n.split(";").forEach(e=>{if(e){const n=le(e);t.push(n)}}),t}function ne(e){const t=new Array,n=e.querySelectorAll("Chart Legends Legend");for(let e=0;e<n.length;e++){const a={},r=n[e].getAttribute("Enabled");a.Enabled=null===r||"True"===r,t.push(a)}return t}function ae(e){const t=new Array,n=e.querySelectorAll("Chart Annotations TextAnnotation");for(let e=0;e<n.length;e++){const a=n[e],r={},i=a.getAttribute("X");r.X=i?Number(i):null;const o=a.getAttribute("Y");r.Y=o?Number(o):null,r.Text=a.getAttribute("Text");const s=a.getAttribute("ForeColor");r.ForeColor=s?le(s):null,t.push(r)}return t}function re(e){const t=new Array,n=e.querySelectorAll("Chart ChartAreas ChartArea AxisX");for(let a=0;a<n.length;a++){const r=n[a],i={};oe(i,e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorGrid")[0],e.querySelectorAll("Chart ChartAreas ChartArea AxisX MajorTickMark")[0]),i.Title=r.getAttribute("Title");const o=e.querySelectorAll("Chart ChartAreas ChartArea AxisX LabelStyle")[0];if(o){const e=null==o?void 0:o.getAttribute("ForeColor"),t=null==o?void 0:o.getAttribute("Enabled");i.LabelForeColor=e?le(e):null,i.LabelDisabled=t&&"false"===t.toLowerCase(),i.FormatString=o.getAttribute("Format")}const s=r.getAttribute("Enabled"),c=r.getAttribute("LineColor"),l=r.getAttribute("TitleForeColor");i.Disabled=s&&"false"===s.toLowerCase(),i.AxisLineColor=c?le(c):null,i.AxisTitleForeColor=l?le(l):null,i.Disabled=s&&"false"===s.toLowerCase();const u=r.getAttribute("IsReversed");i.IsReversed=u&&"true"===u.toLowerCase(),t.push(i)}return t}function ie(e){const t=new Array,n=(e,n)=>{var a,r;const i={};if(!e)return void t.splice(n,0,i);const o=e;i.Title=o.getAttribute("Title");oe(i,o.querySelectorAll("MajorGrid")[0],o.querySelectorAll("MajorTickMark")[0]);const s=o.getAttribute("Enabled");i.Disabled=s&&"false"===s.toLowerCase();const c=o.getAttribute("Interval"),l=o.getAttribute("Minimum"),u=o.getAttribute("Maximum");i.AxisInterval=c?Number(c):null,i.AxisMinimum=l?Number(l):null,i.AxisMaximum=u?Number(u):null;const d=o.querySelectorAll("LabelStyle");d&&d[0]&&d[0].getAttribute("Format")&&(i.FormatString=d[0].getAttribute("Format"));const h=null===(a=null==d?void 0:d[0])||void 0===a?void 0:a.getAttribute("ForeColor");i.LabelForeColor=h?le(h):null;const g=null===(r=null==d?void 0:d[0])||void 0===r?void 0:r.getAttribute("Enabled");i.LabelDisabled=g&&"false"===g.toLowerCase();const p=o.getAttribute("LineColor");i.AxisLineColor=p?le(p):null;const m=o.getAttribute("TitleForeColor");i.AxisTitleForeColor=m?le(m):null,t.splice(n,0,i)};let a=e.querySelectorAll("Chart ChartAreas ChartArea AxisY");return a&&n(a[0],0),a=e.querySelectorAll("Chart ChartAreas ChartArea AxisY2"),a&&n(a[0],1),t}function oe(e,t,n){if(e){if(t){const n=t.getAttribute("LineColor"),a=t.getAttribute("Enabled");e.AxisMajorGridColor=n?le(n):null,e.AxisMajorGridEnabled=a&&"true"===a.toLowerCase()}if(n){const t=n.getAttribute("LineColor"),a=n.getAttribute("Enabled");e.AxisMajorTickMarkColor=t?le(t):null,e.AxisMajorTickMarkEnabled=a&&"true"===a.toLowerCase()}return e}}function se(e){const t=e.querySelector("Chart ChartAreas ChartArea Area3DStyle"),n={};return n.Enable3D=!!t&&"true"===t.getAttribute("Enable3D").toLowerCase(),n}function ce(e){const t=e.querySelector("Chart ChartAreas ChartArea"),n={};return n.BackColor=t?t.getAttribute("BackColor"):"",n.BackSecondaryColor=t?t.getAttribute("BackSecondaryColor"):"",n.BackGradientStyle=t?t.getAttribute("BackGradientStyle"):"",n}function le(e){if(!e)return null;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e=e.trim()))return String.format("rgb({0})",e);if(function(e){return/#[0-9a-fA-F]{6}/.test(e)}(e))return e;if(function(e){return/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,(\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])\s*,){2}\s*([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/.test(e)}(e)){const t=[];e.split(",").forEach(e=>t.push(e.trim()));const n=t.shift(),a=parseFloat(n)/255,r=t.slice();return r.push(a.toString()),String.format("rgba({0})",r.join(","))}return e}var ue=n("z8iZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function de(e){return{Text:e&&e.Text||"",HorizontalAlignment:e&&e.HorizontalAlignment||"center",VerticalAlignment:e&&e.VerticalAlignment||null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class he{constructor(e,t,n,a,r,i,o,s){this._getState=e,this._chartData=r,this._viewRecord=t,this._visualizationRecord=n,this._chartDataDescription=a,this._chartPresentationXML=i,this._drilldownChartType=o,this._entityLogicalName=s}buildChartModel(){if(this._chartQueryModel=Object(ue.a)(),this._chartData.length>0){this._buildChartHeading();try{this._buildChartPresentation(),this._buildChart()}catch(e){if(!(e instanceof N))throw e;this._buildErrorMessage(e)}}else this._buildDataEmptyMessage();return this._chartQueryModel}_buildDataEmptyMessage(){const e=Object(g.b)(this._getState(),p.m),t=de();t.Text=this._visualizationRecord&&this._visualizationRecord.get_DisplayName()?this._visualizationRecord.get_DisplayName():e,t.HorizontalAlignment="center",t.VerticalAlignment="middle",this._chartQueryModel.Title=t,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(null),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e)}_buildErrorMessage(e){this._chartQueryModel.Title=de(),this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName(),this._chartQueryModel.DisplayMode=1,this._chartQueryModel.ErrorInformation=new Y.a,this._chartQueryModel.ErrorInformation.set_ErrorType(e.title),this._chartQueryModel.ErrorInformation.set_ErrorDescription(e.description)}_buildChartHeading(){const e=this._visualizationRecord.get_DisplayName();this._chartQueryModel.Title=de(),this._chartQueryModel.Title.Text=e,this._chartQueryModel.SubTitle=this._viewRecord.get_DisplayName()}_buildChartPresentation(){var e;this._chartPresentationParser=J(this._getState(),this._chartPresentationXML,this._entityLogicalName),this._drilldownChartType&&this._chartPresentationParser.chartPresentationSeries.forEach(e=>{e.ChartType=this._drilldownChartType}),this._chartPresentationSeries=this._chartPresentationParser.chartPresentationSeries,this._chartPresentationXAxis=this._chartPresentationParser.chartPresentationXAxis,this._chartPresentationYAxis=this._chartPresentationParser.chartPresentationYAxis,this._chartPresentationAnnotationList=this._chartPresentationParser.chartPresentationAnnotationList,this._chartPresentationArea3DStyle=this._chartPresentationParser.chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle=this._chartPresentationParser.chartPresentationAreaGradientStyle,this._chartQueryModel.Legend={Enabled:e&&e.Enabled||!1},this._chartPresentationParser.chartPresentationLegendList.length>0?this._chartQueryModel.Legend.Enabled=this._chartPresentationParser.chartPresentationLegendList[0].Enabled:this._chartQueryModel.Legend.Enabled=!1,this._colors=this._chartPresentationParser.colorsList}_buildChart(){this._chartParserType=this._getChartParserType();const e=function(e){let t=null;switch(e){case 2:t=new H;break;case 3:t=new U;break;case 1:default:t=new q}return t}(this._chartParserType);e.initialize(this._getState,this._chartData,this._chartDataDescription,this._chartPresentationSeries,this._chartPresentationXAxis,this._chartPresentationYAxis,this._chartPresentationArea3DStyle,this._chartPresentationAreaGradientStyle,this._chartQueryModel,this._chartPresentationAnnotationList),this._chartQueryModel.Colors=this._colors,e.parse()}_getChartParserType(){return this._chartDataDescription.isComparisonChart?2:this._chartDataDescription.category.primaryGroupBy.groupAttribute.dateTimeGrouping?3:1}}var ge=n("haag"),pe=n("0L4T"),me=n("nxXM"),be=n("ddoO"),fe=n("q/7h"),ye=n("Tezb"),Ce=n("WF3G"),_e=n("4r2D");function ve(e,t,n){return{type:"chartData.retrieve.core.async",execute({dispatch:a,getState:i},s,c){const l=[];try{const u=i();if(!Object(o.b)(i,a,s,l,e,t,n,!0))return Promise.resolve();const d=new Ce.a(e.fetchXml);d.set_NoLock(!0),d.set_PageSize(e.dataDefinition.entityExpression.top);const h=function(e){const t={};if(null!=e){const n=new Ce.a(e);n.set_PageSize(0),n.set_NoLock(!0),t[""]=n}return t}(e.viewXml);return function(e,t,n,a){const i=new _e.a(r.a.toString(r.a.newGuid()),a&&a.isPreloadCall);return e.retrieveEntitiesForAggregateQuery(t,n,i).nativePromise()}(s.DataSource,d,h,c).then(s=>{const c=function(t,n,a){const r=new Pe(e.viewTitle,e.viewEntityLogicalName),i=new Pe(e.chartName,e.chartPrimaryEntityTypeCode),s=e.dataDefinition,c=Object(fe.a)(t);Object(o.e)(s,c,n());const l=e,u=new he(n,r,i,s,c,e.presentationXml,l.drillDownChartType?l.drillDownChartType:null,a);return u.buildChartModel()}(s,i,t);Object(k.c)(u,M.rd)?(a(je(e.getStorageKey(),c)),Oe(u,a,e.getStorageKey(),n)):(a(Ie(r.a.toString(e.visualizationId),r.a.toString(e.viewId),c)),Se(u,a,r.a.toString(e.visualizationId),r.a.toString(e.viewId),n))}).catch(t=>{Object(pe.c)(u,a,t,e,n)})}catch(e){return s.EventManager.ReportComponentFailure(o.f+".retrieveChartDataCore",Error(e),ge.b,l),Promise.reject(e)}}}}function Se(e,t,n,i,o){if(e){const s=new r.a(n),c=r.a.toString(s),l=new r.a(i),u=r.a.toString(l),d={},h={};if(h[u]=function(e,t,n,r){if(!e)return null;if(r&&""!==r){const i=Object(be.c)(e,t,n),o=i&&i.slice();return Object(a.a)(o,r)}return null}(e,c,u,o),h[u]){d[c]=h;const e={entities:null,lists:null,charts:d};t(Object(me.b)(e))}}}function Oe(e,t,n,r){if(e){const i={};if(i[n]=function(e,t,n){if(!e)return null;if(n){const r=Object(be.b)(e,t),i=r&&r.slice();return Object(a.a)(i,n)}return null}(e,n,r),i[n]){const e={entities:null,lists:null,charts:null,chartData:i};t(Object(me.b)(e))}}}function Ie(e,t,n){const a=new r.a(e),o=r.a.toString(a),s=new r.a(t),c={charts:{[o]:{[r.a.toString(s)]:{initialized:i.a.Initialized,chartConfigObject:n}}}};return{type:ye.d,payload:c}}function je(e,t){const n={chartData:{[e]:{initialized:i.a.Initialized,chartConfigObject:t}}};return{type:ye.d,payload:n}}class Pe{constructor(e,t){this._displayName=e,this._associatedEntityLogicalName=t,Object.freeze(this)}get_DisplayName(){return this._displayName}get_AssociatedEntityLogicalName(){return this._associatedEntityLogicalName}}},kC0I:function(e,t,n){"use strict";n.d(t,"i",(function(){return de})),n.d(t,"g",(function(){return ne})),n.d(t,"e",(function(){return ae})),n.d(t,"d",(function(){return re})),n.d(t,"f",(function(){return ge})),n.d(t,"h",(function(){return pe})),n.d(t,"c",(function(){return oe})),n.d(t,"a",(function(){return ue})),n.d(t,"b",(function(){return le}));var a=n("SAYH"),r=n("eOoD"),i=n("w1eR"),o=n("eXjw"),s=n("S2mk"),c=n("jRy5"),l=n("ILmX"),u=n("d0w6"),d=n("iZ7K"),h=n("IqkD"),g=n("NjDY"),p=n("YxC/"),m=n("KBcj"),b=n("BzGi"),f=n("BFlg"),y=n("P6DH"),C=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function _(){let e=null,t=null,n=null;return(a,r)=>{const i=r.parentContextToken,o=r.contextString,s=function(e,t){const n=t.parentContextToken;switch(t.contextString){case f.h.ASSOCIATEDGRID:const a=Object(y.gb)(e,t,n);return C.a(n,a.relationshipName,a.ordinal);case f.h.SUBGRID:if(t.descriptor&&t.descriptor.StreamId)return C.o(n,t.descriptor.Name,t.descriptor.StreamId,!!t.descriptor.IsTile);const r=C.p(n,t.descriptor.Name),i=r&&r.parentContextToken?r.parentContextToken.entityTypeName:null;return r.relationshipType=oe(e,t,i,r),r;case f.h.GRID:return C.k(e,t.id);case f.h.CUSTOM:return C.c(n,t.controlId);default:return n}}(a,r);return(n!==o||v(e,s)||v(t,i))&&(e=s,t=i,n=o),e}}function v(e,t){return e&&t?e.entityTypeName!==t.entityTypeName||e.controlName!==t.controlName||(e.formId&&e.formId.guid)!==(t.formId&&t.formId.guid)||(e.recordId&&e.recordId.guid)!==(t.recordId&&t.recordId.guid)||e.relationshipName!==t.relationshipName||e.roleOrd!==t.roleOrd:e!==t}var S=n("5O6t"),O=n("XvLr"),I=n("LzVy"),j=n("sclX"),P=n("unFF"),x=n("GYEz"),E=n("o0iw"),w=n("504W"),T=n("3hnk"),A=n("sZ+8"),F=n("69Qu"),N=n("3/02"),k=n("Lyxw"),M=n("kt5S"),D=n("jAuy"),R=n("arV0"),L=n("pEXn"),B=n("5R5s"),V=n("VnpK"),G=n("85o3"),z=n("lEp6"),W=n("YPtO"),X=n("0kGT"),H=n("Z/4N"),U=n("nIfK"),q=n("8nT0"),Y=n("CbNq"),K=n("b41/"),Q=n("7+p5"),Z=n("37s6"),J=n("LbMF"),$=n("SJlc"),ee=n("AVDU"),te=n("H4dV");function ne(e){return e===f.h.SUBGRID}function ae(e){return e===f.h.GRID}function re(e){return e===f.h.ASSOCIATEDGRID}function ie(e){switch(e){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return"div";case f.h.GRID:default:return"section"}}function oe(e,t,n,a){let r=n?Object(d.G)(e,n,a.relationshipName):null;if(null===r&&t.descriptor&&t.descriptor.Parameters){const a=t.descriptor.Parameters[f.F.RELATIONSHIP_NAME],i=t.descriptor.Parameters[f.F.TARGET_ENTITY_TYPE];a&&n?r=Object(d.G)(e,n,a):a&&i&&(r=Object(d.G)(e,i,a))}return r}function se(){let e=null,t=null;return n=>(e!==n.contextString&&(e=n.contextString,t=function(e){switch(e.contextString){case f.h.ASSOCIATEDGRID:case f.h.SUBGRID:return[u.a.SUB_GRID,u.a.MAIN_APPLICATION_VIEW];case f.h.GRID:return e.isAdvancedFindView?[u.a.ADVANCED_SEARCH]:[u.a.MAIN_APPLICATION_VIEW];default:return[u.a.MAIN_APPLICATION_VIEW]}}(n)),t)}function ce(e){return e&&[e.CustomControlId,e.Name].some(e=>-1!==U.a.indexOf(e))}function le(e,t,n){if(!e||!e.contextTokenType||e.contextTokenType!==c.a.AssociatedGrid&&e.contextTokenType!==c.a.MainGrid)return null;switch(t){case"displayChart":return!1;case"displayCommandBar":return!0;case"displayIndex":return ce(n);case"displayQuickFind":case"displayViewSelector":return!0}return null}function ue(){let e=null,t=null;return(n,a,r)=>{if(e&&t===a.CustomControlId)return e;const i=a&&a.CustomControlId?a.CustomControlId:null;if(!i)return null;const o=Object(y.ab)(n,i),s=Object(H.e)(n,i);if(o&&s&&s.Properties.DataSetDefinitions&&s.Properties.DataSetDefinitions[o]&&s.Properties.DataSetDefinitions[o].CDSDataSetOptions){const n=s.Properties.DataSetDefinitions[o].CDSDataSetOptions;e={displayChart:n.hasOwnProperty("displayChart")?n.displayChart:le(r,"displayChart",a),displayCommandBar:n.hasOwnProperty("displayCommandBar")?n.displayCommandBar:le(r,"displayCommandBar",a),displayIndex:n.hasOwnProperty("displayIndex")?n.displayIndex:le(r,"displayIndex",a),displayQuickFind:n.hasOwnProperty("displayQuickFind")?n.displayQuickFind:le(r,"displayQuickFind",a),displayViewSelector:n.hasOwnProperty("displayViewSelector")?n.displayViewSelector:le(r,"displayViewSelector",a)},t=a.CustomControlId}return e}}function de(){let e,t=null,n=null,c=null,C=null,v="",V=null,H=null,U=null,le=null,ue=null,de=null,ge=null,fe=null;const ye=function(){let e=null;return(t,n,a,r)=>{let i=e;switch(Object(w.b)(r)&&(r=n.contextString),r){case f.h.ASSOCIATEDGRID:i=Object(l.b)(a);break;case f.h.SUBGRID:i=Object(l.l)(a);break;case f.h.GRID:default:i=Object(l.h)(a)}return i!==e&&(e=i),e}}(),Ce=Object(S.a)(),_e=_(),ve=function(){let e=null;const t=function(){let e=null;return(t,n,r)=>{let o,c,l,u,d;if(Object(y.ib)(t,n.id,r)){o=Object(y.T)(t,n.id,r);const e=Object(y.qb)(t,o,n.id);c=e&&e.entityLogicalName,d=e&&e.isUserView,l=Object(y.r)(t,n.id,r,c),u=Object(y.s)(t,n.id,r)!==b.a.savedvisualization}else{const e=Object(y.ab)(t,n.configuration.CustomControlId);if(e){const t=n.configuration.Parameters[e];t&&(o=t.ViewId&&new a.a(t.ViewId),c=t.TargetEntityType,l=t.VisualizationId&&new a.a(t.VisualizationId),u=!(!t.IsUserChart||"true"!==t.IsUserChart),d=!(!t.IsUserView||"true"!==t.IsUserView))}}if(!a.a.isNullOrEmpty(o)&&l&&c){const h=Object(y.q)(t,n.id,r),g=Object(y.p)(t,n.id,r),p=Object(y.C)(t,n.id,r),m=he(t,n,r,p,!0),b=Object(y.N)(t,n.id,r),C=t.user&&t.user.userId,_=Object(k.c)(t,N.Zc),v=Object(B.a)(c,C,r,_),S=v&&v.getFilterAndLinkedEntities(p&&p.activityOrQueueFilterValue?p.activityOrQueueFilterValue:void 0),O=S&&null!==S.linkEntities?JSON.stringify(S.linkEntities):null,I=Object(k.a)(t,N.Od,N.h),j=!I||I&&Object(x.a)(t)===i.a.MobileApplication,P=I,E=re(n.contextString)?Object(s.p)(f.d,c,a.a.toString(o),a.a.toString(l),r.relationshipName,b,u,d,m,O,P):Object(s.t)(f.d,c,a.a.toString(o),a.a.toString(l),b,h,u,g,d,m,O,j,P);if(e){const n=E&&E.CustomControlId?E.CustomControlId:null,a=Object(y.ab)(t,n);if(a&&E.Parameters[a]){const t=E.Parameters[a],n=e.Parameters[a];t.ViewId===n.ViewId&&t.VisualizationId===n.VisualizationId&&t.EntityName===n.EntityName&&t.HighchartFilterExpression===n.HighchartFilterExpression&&t.ChartDrillDownParameters===n.ChartDrillDownParameters&&t.ExtraFilters===n.ExtraFilters||(e=E)}}else e=E}else if(e&&c&&!l){const n=e.CustomControlId,a=Object(y.ab)(t,n);a&&e.Parameters[a]&&c!==e.Parameters[a].EntityName&&(e=null)}return e}}();return(n,a,r)=>{const i=t(n,a,r),o=a.id;return e&&e.configuration===i&&e.id===o||(e={configuration:i,id:o,chartId:f.d,showChart:!0,contextToken:r}),e}}(),Se=function(){let e=null;return(t,n,a,r,i,o)=>{const s=o.commandBarStyle,c=n.id,l=oe(t,n,a&&a.parentContextToken?a.parentContextToken.entityTypeName:null,a),u=Object(y.w)(t,c,a);return e&&e.commandManagerId===u&&e.pageId===c&&e.ribbonId===i&&e.relationshipType===l&&e.contextToken===a&&e.style===s||(e={commandManagerId:u,pageId:c,ribbonId:i,relationshipType:l,contextToken:a,style:s}),e}}(),Oe=function(){let e=null;const t=se();return(n,r,i,o,s,c)=>{var l;const d=c.viewSelectorStyle,g=a.a.toString(s),p=t(r),b=Object(y.nb)(r.id,g),f=ae(r.contextString),C=f,_=r.contextString,v=Object(y.Z)(n),S=Object(h.g)(n),O=Object(y.qb)(n,s,r.id),I=O?O.title:null;let j=u.a.MAIN_APPLICATION_VIEW;ne(_)?j=u.a.SUB_GRID:f&&r.isAdvancedFindView&&(j=u.a.ADVANCED_SEARCH);const P=Object(m.a)(n,o,j),x=P||a.a.EMPTY,E=Object(R.g)(n,null==r?void 0:r.id),w=Object(y.rb)(n,null===(l=null==E?void 0:E.pageToEditedViewMapId)||void 0===l?void 0:l.guid,null==s?void 0:s.guid);return e&&e.id===b&&e.entityTypeName===o&&e.selectedViewId===g&&e.queryViewSelectorTypes===p&&e.shouldDisplayNestedViewSelector===C&&e.isRTL===S&&e.defaultViewId===x&&e.isEdited===!!w||(e={id:b,pageId:r.id,title:I,entityTypeName:o,selectedViewId:g,style:d,queryViewSelectorTypes:p,shouldDisplayNestedViewSelector:C,contextString:_,pinnedActivityView:v,isRTL:S,defaultViewId:x,isAdvancedFindView:r.isQueryMode&&r.isAdvancedFindView,isEdited:!!w,pageToEditedViewMapId:null==E?void 0:E.pageToEditedViewMapId}),e}}(),Ie=function(){let e=null;return(t,n,a,r,i)=>{const o=n.id,s=Object(y.G)(t,n),c=Object(h.w)(t),l=i.filterComboStyle,u=Object(R.g)(t,o).entityFilterValue;return e&&e.id===o&&e.entityTypeName===r&&e.filterOptions===s&&e.comboBoxStyle===l&&e.userSetting===c&&u===e.previousValue||(e={id:o,filterOptions:s,entityTypeName:r,updateFilterValue:null,onFilterChange:null,resourceStrings:null,userSetting:c,style:null,comboBoxStyle:l,previousValue:u}),e}}(),je=function(){let e=null;return(t,n,a,r,i)=>{const o=n.id,s=Object(y.G)(t,n,r),c=Object(Y.a)(t),l=i.filterComboStyle,u=i.dueDateComboBoxStyles,d=i.activityTypeComboBoxStyles,g=Object(D.h)(t,a.relationshipName,re(n.contextString)),p=!Object(F.b)(t),m=Object(y.kb)(t,o,a),b=Object(h.g)(t),f=Object(P.a)(t),C=Object(R.g)(t,o),_=C.entityFilterValue,v=C.activityTypeFilterValue,S=Object(k.a)(t,N.a,N.h),I=Object(k.a)(t,N.a,N.Lc),j=Object(y.ub)(t,r),x=Object(k.c)(t,N.Zc),E=Object(B.a)(r,t.user.userId,a,x,j),w=E&&E.getFilterLabelResourceKey(),T=O.ACTIVITY_MGMT_ACTIVITY_TYPE_LABEL,A=O.ACTIVITY_MGMT_DUE_DATE_LABEL;if(!e||e.id!==o||e.entityTypeName!==r||e.filterOptions!==s||e.comboBoxStyle!==l||e.dueDatecomboBoxStyle!==u||e.activityTypecomboBoxStyle!==d||e.labelStyle!==i.filterLabelStyle||e.activityMgmtLabelStyle!==i.activityMgmtLabelStyle||e.isActivityManagementFeatureEnabled!==S||e.filterOptionsForActivityType!==c||e.isRollupViewSupported!==g||e.isOffline!==p||e.toggleValue!==m||e.isRTL!==b||e.theme!==f||e.previousValue!==_||e.activityTypePreviousValues!==v||e.isActivityFilterSelectAllEnabled!==I||e.entityIsActivityType!==j){const t={isRollupViewSupported:g,isOffline:p,toggleValue:m,onToggleChange:null,isRTL:b,theme:f};e=Object.assign({id:o,filterOptions:s,filterOptionsForActivityType:c,entityTypeName:r,onFilterChange:null,onActivityTypeChange:null,onActivityTypeFilterClear:null,gridEntityName:null,resourceStrings:null,comboBoxStyle:l,dueDatecomboBoxStyle:u,activityTypecomboBoxStyle:d,containerStyle:null,activityTypeContainerStyle:null,labelStyle:i.filterLabelStyle,activityMgmtLabelStyle:i.activityMgmtLabelStyle,previousValue:_,activityTypePreviousValues:v,isActivityManagementFeatureEnabled:S,activityViewContainerStyle:i.activityViewContainerStyle,entityFilterLabelResourceString:w,activityTypeFilterLabelResourceString:T,dueDateFilterLabelResourceString:A,isActivityFilterSelectAllEnabled:I,isRTL:b,entityIsActivityType:j},t)}return e}}(),Pe=function(){let e=null;const t=[1041,2052,3076,1028,1042];return(n,a,r,i,o,s)=>{const c=n.id,l=n.descriptor&&n.descriptor.Id?n.descriptor.Id:null,u=o?JSON.parse(o).conditions[0]:null,d=function(e,t){if(t=t?t.value.replace("%","").toUpperCase():null,e){const n=pe(e.split(",")[0]),a=n[1].split("|");if(a&&t===a[0])return n[1]}return t}(Object(p.c)(s,O.JUMPBAR_ALPHABET),u);return t.indexOf(i)>-1?e=null:e&&e.id===c&&e.contextToken===a&&e.entityTypeName===r&&e.selectedFilter===d||(e={id:c,uniqueId:l,contextToken:a,entityTypeName:r,selectedFilter:d,languageId:i}),e}}(),xe=function(){let e=null;return(t,n,a,r)=>{const{id:i,contextString:o}=t;return e&&e.id===i&&e.contextToken===n&&e.entityTypeName===a&&e.gridInput===r||(e={id:i,contextToken:n,entityTypeName:a,contextString:o,gridInput:r}),e}}(),Ee=function(){let e=null;return(t,n,a)=>{const{id:r,contextString:i}=t;return e&&e.id===r&&e.contextToken===n||(e={id:r,contextToken:n,contextString:i}),e}}(),we=Object(p.h)(),Te=function(){let e=null,t=null;const n={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},a={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1};let o=null;const s={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},c={Type:"WholeNumber.None",Usage:1,Static:!0,Value:!1,Primary:!1},l={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},u={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},d={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},h={Type:"WholeNumber.None",Usage:1,Static:!0,Value:null,Primary:!1},p={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1},m={Type:"TwoOptions",Usage:1,Static:!0,Value:!1,Primary:!1};let b,f,C={useSkypeProtocol:n,gridPageNumber:a,isNewPageRequested:s,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:h,headerDialogOnTop:p,headerDialogPreventDismissOnScroll:m};return(_,v,S)=>{const O=Object(x.e)(_),P=Object(g.x)(_).useSkypeProtocol,E=Object(y.x)(_,v.id,S),w=Object(y.X)(_,v.id,S);w||o===E||(o=E),b||(b=Object(I.a)(_),f=null!=b&&b===j.b.Native);const T=!f,A=Object(k.a)(_,N.a,N.h),{systemDefinedProperties:F}=v,M=E!==o&&w,D=T!==c.Value;let R=!1;A&&(re(v.contextString)||ae(v.contextString))&&(R=!0);let L=!1;Object(X.a)(_)&&ne(v.contextString)&&(L=!0);let B=!1;Object(X.a)(_)&&Object(k.c)(_,N.Md)&&ne(v.contextString)&&Object(x.a)(_)===i.a.MobileApplication&&(B=!0);let V=!1;if(Object(X.a)(_)&&Object(k.c)(_,N.ad)&&ae(v.contextString)&&Object(x.a)(_)===i.a.MobileApplication){const e=Object(y.C)(_,v.id,S);(null==e?void 0:e.quickFind)&&(V=!0)}const G=!ae(v.contextString)&&r.a.Tablet===O,z=r.a.Tablet===O&&!re(v.contextString)||"Web"===Object(x.k)(_)&&!te.a.getInstance().get_IsAndroid()&&!te.a.getInstance().get_IsWindows()&&!te.a.getInstance().get_isIPhone();if(O!==e||P!==t||M||D||w!==s.Value||R!==l.Value||L!==u.Value||B!==d.Value||V!==h.Value||G!==p.Value||z!==m.Value){e=O,t=P,a.Value=E,o=E,s.Value=w,c.Value=T,l.Value=R,u.Value=L,d.Value=B,h.Value=V,p.Value=G,m.Value=z;const r=null==e?P:null;(r!==n.Value||M||D)&&(n.Value=r,C=Object.assign(Object.assign({},F),{useSkypeProtocol:n,gridPageNumber:a,isNewPageRequested:s,enhancedPagingDisabled:c,isActivityTypeFilterDisabled:l,showAddNewCommand:u,emptySubgridIconAndTextChanges:d,emptyGridChangesIfQuickFindImprovementsEnabled:h,headerDialogOnTop:p,headerDialogPreventDismissOnScroll:m}))}return C}}(),Ae=function(){let e=null,t=null;return(n,a,r)=>(n&&(t&&e===n&&!r||(t=Object.assign({},n),n.Parameters&&(t.Parameters=Object.assign({},n.Parameters),a&&n.Parameters[a]&&(t.Parameters[a]=Object.assign({},n.Parameters[a]),n.Parameters[a].Columns&&(t.Parameters[a].Columns=n.Parameters[a].Columns.slice(0)))),e=n)),t)}(),Fe=Object(E.s)(),Ne=function(){const e=[];return(t,n,a,r,i,o,s,c,l,u,d)=>(e&&e.length&&e.splice(0,e.length),e.push({name:L.b.IsGridRoot,value:t},{name:L.b.IsSubGrid,value:n},{name:L.b.IsAssociatedGrid,value:a},{name:L.b.EntityName,value:r},{name:L.b.ViewId,value:i},{name:L.b.IsEmptyFetch,value:o},{name:L.b.IsEmptyOfflineSqlQuery,value:s},{name:L.b.IsValidFetchXmlForOfflineUsage,value:c},{name:L.b.IsEntityAvailableForOfflineUsage,value:l},{name:L.b.OfflineConfigurationErrorCode,value:u},{name:L.b.RelatedEntityUnavailableOffline,value:d}),e)}(),ke=function(){let e=null;return t=>(e||(e={isGridPaginationStateFeatureEnabled:Object(k.a)(t,N.zb),isAssociatedGridHeightEnabled:Object(D.e)(t),isChartOnAssociatedGridEnabled:Object(k.a)(t,N.x,N.h,N.i),isGridProgressIndicatorFeatureEnabled:Object(k.a)(t,N.Ab),isInMobileModeForOct2019:Object(X.b)(t),isJumpBarShouldHonorSortingFeatureEnabled:Object(k.a)(t,N.ac),isJumpbarFeatureForMobileEnabled:Object(k.c)(t,N.Kb),isSuiterChartEnabled:Object(k.a)(t,N.Od,N.h),isSuiterDashboardEnabled:Object(k.a)(t,N.Pd,N.h),isAdvancedFindEnabled:Object(Q.a)(t),isDisableEditableGridControlOnPhoneFeatureEnabled:Object(k.c)(t,N.O),isInMobileModeForApril2020:Object(X.a)(t),isSubgridImprovementsEnabled:Object(k.c)(t,N.Md),isSubGridAutoCollapseEnabled:Object(k.a)(t,N.Jd,N.Lc),isSubGridRemoveMinHeightEnabled:Object(k.a)(t,N.Ld,N.Lc),isQuickFindImprovementsEnabled:Object(k.c)(t,N.ad),isShowAsButtonFirstEnabled:Object(k.c)(t,N.Bd),isColumnEditorButtonEnabled:Object(y.tb)(t),isQueueFilterPerfUCIEnabled:Object(k.c)(t,N.Zc)}),e)}(),Me=function(){let e={fetchXML:null,entityName:null,isOffline:null},t={error:!1,errorCode:null,relatedEntityUnavailableOffline:null};return function(n,a,r,i){if(e.entityName!==r||e.fetchXML!==a||e.isOffline!==i)if(Object(A.k)(r)){const o=Object(A.b)(n,a);t={error:o.error,errorCode:o.error?O.LINKED_ENTITY_NOT_SUPPORTED:null,relatedEntityUnavailableOffline:o.relatedEntityUnavailableOffline},e={fetchXML:a,entityName:r,isOffline:i}}else t={error:!0,errorCode:O.ACTIVITY_ENTITY_NOT_SUPPORTED_OFFLINE},e={fetchXML:a,entityName:r,isOffline:i};return t}}();return function(r,i){var s;const l=Object(h.w)(r),b=_e(r,i),_=Object(y.v)(r,i.id,b),S=b.relationshipName,E=b.roleOrd,L=Object(y.N)(r,i.id,b),X=Object(y.I)(r,i.id,b),Y=Object(y.x)(r,i.id,b),Q=i.descriptor,te=be.bind(null,i,Q),oe=i.configuration,se=oe&&oe.CustomControlId?oe.CustomControlId:null,pe=Object(I.a)(r),De=Object(x.e)(r),Re=Object(y.ab)(r,se)||(i.contextString===f.h.CUSTOM?f.g:null),Le=ae(i.contextString),Be=ke(r),Ve=Object(y.A)(r,b,i);let Ge=null,ze=!1,We=null;const Xe=Object(y.t)(r,i.id,b),He=Object(y.C)(r,i.id,b);Le&&(Ge=Object(R.g)(r,i.id),Be.isGridPaginationStateFeatureEnabled&&(We=Ge.gridSortingInfo,We&&(Object(w.a)(le)||le!==We)&&(le=We,ze=!0),Xe&&(Object(w.a)(ue)||ue!==Xe.customFilterXml)&&(ue=Xe.customFilterXml,ze=!0)),(He&&Object(w.a)(de)||de!==He)&&(de=He,ze=!0));const Ue=Ae(oe,Re,ze),qe=Ue&&Ue.Parameters?Ue.Parameters[Re]:null,Ye=re(i.contextString),Ke=ne(i.contextString),Qe=!Object(F.b)(r),Ze=Object(y.jb)(r,b,i),Je=qe&&!!qe.DataProvider,$e=qe&&!!qe.BoundViewParams,et=Object(g.x)(r),tt=et&&et.gridTotalRecordCountLimit?et.gridTotalRecordCountLimit:5e3,nt=Object(y.ib)(r,i.id,b),at=ce(i.configuration),rt=ce(i.configuration);if(null!=i.nonCompositionProps){const e=oe&&oe.FormFactor&&oe.FormFactor.toString(),t=Object(M.c)(i.nonCompositionProps.gridConfigurations,i.nonCompositionProps.viewConfigurations,oe,null,f.h.GRID,e).map(e=>e.configuration.DisplayNameKey),n=we(r,t);(!U&&""!==Object(p.c)(n,t[0])||U!==n)&&(U=n)}let it=!!_;let ot=Object(y.T)(r,i.id,b)||(Q&&Q.Parameters&&Q.Parameters.ViewId?a.a.parse(Q.Parameters.ViewId):null);const st=Object(y.qb)(r,ot,i.id),ct=(null==st?void 0:st.isUserView)?u.b.userview:u.b.savedview,lt=null==st?void 0:st.queryType,ut=null==st?void 0:st.entityLogicalName;ut&&ut!==c&&(c=ut);const dt=Object(d.h)(r,c),ht=!Qe&&pe===j.b.Web&&Le&&Be.isAdvancedFindEnabled&&(null==dt?void 0:dt.IsValidForAdvancedFind);if(!H||e!==ht){let t=[...O.labelList];ht&&(t=[...t,K.c.OpenAdvancedFiltersTitleAndAria]);const n=we(r,t);""!==Object(p.c)(n,O.JUMPBAR_ALL_TITLE)?(H=n,e=ht):it=!1}const gt=Object(y.W)(r,se);gt&&gt!==V&&(V=gt);const pt=Ce(r,i);ce(i.configuration)&&(Object.assign(pt.bodyStyle,{flexDirection:"column"}),Object.assign(pt.bodyMobileStyle,{flexDirection:"column"}));let mt=Object(y.F)(r,i.id,b)||(Q&&Q.Parameters&&Q.Parameters[f.u]?Q.Parameters[f.u]:null),bt=mt;Le&&(bt=Ge.entityTypeName);const ft=Object(T.b)(r,mt);dt&&dt.Initialized===o.a.Initialized||Je||$e||(it=!1);const yt=dt?dt.DisplayName:"",Ct=Object(g.t)(r),_t=Object(d.i)(r,mt),vt=!(st&&st.fetchXML),St=st&&st.viewId,Ot=Me(r,vt?"":st.fetchXML,c,Qe),It=!vt&&!Ot.error,jt=null!=st&&Object(w.b)(st.offlineSqlQuery),Pt=Object(A.l)(r,c),xt=Ne(Le,Ke,Ye,c,St?St.guid:null,vt,jt,It,Pt,Ot.error&&Ot.errorCode||"",Ot.error&&Ot.relatedEntityUnavailableOffline||""),Et=!((Le||Ye||Ke)&&st&&st.fetchXML&&Qe&&Pt)||!jt&&It;let wt="";if(Et?Pt||(wt=O.ENTITY_NOT_AVAILABLE_IN_PROFILE):jt?wt=O.SQL_QUERY_NOT_AVAILABLE:Ot.error&&(wt=Ot.errorCode),qe){qe.TargetEntityType&&mt!==qe.TargetEntityType&&(mt=qe.TargetEntityType),qe.ExtraFilters=he(r,i,b,He,!1);const e=function(e,t,n,a,r){let i=[];const o=Object(y.q)(e,t.id,n);if(o){const e=JSON.parse(o);if(e.conditions)for(const t of e.conditions)t.linkEntityExpressions&&(i=i.concat(t.linkEntityExpressions))}const s=e.user&&e.user.userId,c=Object(k.c)(e,N.Zc),l=Object(y.ub)(e,a),u=Object(B.a)(a,s,n,c,l);let d=u&&u.getFilterAndLinkedEntities(r&&void 0!==r.activityOrQueueFilterValue?r.activityOrQueueFilterValue:G.a,r&&!r.activityOrQueue);d&&d.linkEntities&&(i=i.concat(d.linkEntities));return d=d||{filter:null,linkEntities:null},d.linkEntities=i,d}(r,i,b,mt,He);if(e&&e.filter&&(qe.ExtraFilters?qe.ExtraFilters.push(JSON.stringify(e.filter)):qe.ExtraFilters=[JSON.stringify(e.filter)]),e&&e.linkEntities&&e.linkEntities.length>0){let t={Static:!0,Value:Object(z.b)(e.linkEntities)};if(qe.LinkingInput){t=qe.LinkingInput;const n=Object(z.a)(qe.LinkingInput.Value);if(n){const a=new W.a;n.forEach(e=>{a.addLinkedEntity(e)}),e.linkEntities.forEach(e=>{a.addLinkedEntity(e)}),t.Value=Object(z.b)(a.getLinkedEntities())}}qe.LinkingInput=t}if(ot){const e=a.a.toString(ot);e!==qe.ViewId&&(qe.ViewId=e)}else ot=a.a.tryParseOrNull(qe.ViewId);(Q&&Q.Parameters?"false"===Q.Parameters[f.F.ENABLE_CONTEXTUALACTIONS]:null)&&(Ue.Parameters[f.i]={Usage:1,Static:!0,Type:"Enum",Value:!1,Primary:!1})}mt&&mt!==C&&(C=mt);const Tt=Object(d.r)(r,mt)&&i.contextString===f.h.GRID?y.a:mt,At=qe&&qe.CommandBarContext,Ft=ye(r,i,Tt,At),Nt=function(e,t,n){const a=Object(y.qb)(e,t,n);return a&&a.grid&&a.grid.rows&&a.grid.rows[0]&&a.grid.rows[0].cells}(r,ot,i.id),kt=null==Nt?void 0:Nt.map(e=>e.name),Mt=null==n?void 0:n.map(e=>e.name);(JSON.stringify(kt)!==JSON.stringify(Mt)||(ot&&ot.guid)!==(t&&t.guid)||S===ge&&E!==fe)&&(t=ot,fe=E,v=(Q&&Q.Id?Q.Id:"")+(new Date).getTime(),n=Nt),S&&S!==ge&&(ge=S);const Dt=Object(y.o)(r,mt),Rt=Dt?Dt.lookupAttribute:null;qe&&(function(e,t,n,a,r,i,o){const s=Object(d.h)(e,a);if(s&&ce(t.configuration)){const c=f.b;n.Columns||(n.Columns=[]),a!==y.a||r&&r.some(e=>e.name===c)||n.Columns.find(e=>e.Name===c)||n.Columns.push({Alias:c,DataType:"",Type:"",Name:c});const l=s&&s.PrimaryNameAttribute,u=r&&r.some(e=>e.name===l);if(!l||u||n.Columns.some(e=>e.Name===l)||n.Columns.push({Alias:l,DataType:"",Type:"",Name:l}),!Object(y.vb)(t.configuration.Parameters)){const t=Object(D.a)(s.PrimaryImageAttribute);t&&!n.Columns.find(e=>e.Name===t)&&n.Columns.push({Alias:q.d,DataType:"SingleLine.Text",Type:"",Name:t}),Object(k.a)(e,N.ub)&&i&&o&&(n.Columns.find(e=>e.Name===y.c)||n.Columns.push({Alias:y.c,DataType:"Whole.None",Type:"",Name:y.c,PreventMetadataRequest:!0}),n.Columns.find(e=>e.Name===i)||n.Columns.push({Alias:i,DataType:"Lookup.Simple",Type:"",Name:i}))}}}(r,i,qe,mt,n,Rt,!Object(w.a)(Ge)),function(e,t,n,a,r){if(!Object(y.vb)(t.configuration.Parameters))return;(null==r?void 0:r.some(t=>{var n;return(null===(n=Object(J.a)(e,a,t.name))||void 0===n?void 0:n.Type)===$.a.moneyType}))&&(n.Columns.some(e=>e.Alias===f.A)||n.Columns.push({Alias:f.A,DataType:"Lookup.Simple",Type:"",Name:q.w}))}(r,i,qe,mt,n));const Lt=!mt||(Object(T.i)(mt)||Object(T.g)(r,mt,2,0)&&function(e,t){let n=!0;t&&t.forEach(t=>{if(t.relatedEntityName&&(n=Object(T.g)(e,t.relatedEntityName,2,0),!n))return!1});return n}(r,n)),Bt=Object(y.Y)(r,i.id,b),Vt=Bt?JSON.parse(Bt):null,Gt=Vt?Vt.totalResultCount:null,zt=Vt?Vt.pageSize:null,Wt=null!==Gt&&Gt>-1?0===Gt?Object(p.c)(H,O.NO_DATA_AVAILABLE):String.format(O.X_RECORDS_PRESENT,Gt):"",Xt=Fe(r,Le),Ht=!(null!=pe&&pe===j.b.Native),Ut=Object(y.rb)(r,null===(s=null==Ge?void 0:Ge.pageToEditedViewMapId)||void 0===s?void 0:s.guid,null==ot?void 0:ot.guid),qt={isEmptyOfflineSqlQuery:jt,isEntityAvailableForOffline:Pt,isOfflineSqlQueryAvailable:Et,offlineErrorMessageKey:wt,isOfflineAvailableForUse:Object(Z.w)(r),offlineGridErrorTelemetryParams:xt},Yt=Object(ee.d)(r),Kt=Object(m.c)(r,t),Qt=!Qe&&pe===j.b.Web&&Le&&Be.isColumnEditorButtonEnabled&&!Ye&&!Ke,Zt=Object(y.ub)(r,mt);return{showAdvancedFilter:ht,isViewEdited:!!Ut,isInitialized:it,viewId:t,customFilter:Xe,gridEntityTypeName:c,chartEntityTypeName:c,isUCIEntity:ft,totalRecordCountLimitExceeded:Ze,chartProps:nt?ve(r,i,b):null,viewDescriptor:st,commandBarProps:te(f.E.COMMANDBAR_ENABLED,!0,f.F.ENABLE_CONTEXTUALACTIONS,Re,!0)?Se(r,i,b,Q,Ft,pt):null,viewSelectorProps:bt&&te(f.E.VIEWSELECTOR_ENABLED,!0,f.F.ENABLE_VIEW_PICKER,Re)?Oe(r,i,b,bt,t,pt):null,queueFilterProps:oe&&te(null,!0,f.F.ENABLE_QUEUEFILTER,Re)?Ie(r,i,b,mt,pt):null,entityFilterProps:Qe||!Zt&&!Object(D.h)(r,ge,Ye)?null:je(r,i,b,mt,pt),jumpBarProps:te(f.E.JUMPBAR_ENABLED,at,f.F.ENABLE_JUMPBAR,Re)&&me(i)?Pe(i,b,mt,l.languageId,He?He.jumpBar:null,H):null,quickFindProps:te(f.E.QUICKFIND_ENABLED,!0,f.F.ENABLE_QUICKFIND,Re)?xe(i,b,mt,Ge):null,pagingProps:te(f.E.PAGING_ENABLED,rt,null,Re)?Ee(i,b,mt):null,contextToken:b,controlKey:v,styles:pt,refreshCounter:L,pagingRefreshInput:X,pageNumber:Y,ribbonId:Ft,semanticTag:ie(i.contextString),recordsPerPageSetting:Object(h.h)(r),userSetting:l,hasReadRolePrivilege:Lt,resourceStrings:H,switchVisualizationResourceStrings:U,entityTypeName:C,primaryDataSetName:Re,nestedGridDatasetName:V,viewportSm:Object(P.a)(r).sizes.Breakpoints.DimensionS,viewportM:Object(P.a)(r).sizes.Breakpoints.DimensionM,systemDefinedProperties:Te(r,i,b),platformType:Object(I.a)(r),isGridEditable:Object(y.vb)(oe?oe.Parameters:null),notificationMessage:Wt,totalResultCount:Gt,pageSize:zt,offlineProps:qt,isRTL:Object(h.g)(r),entityDisplayName:yt,isOffline:Qe,showChart:nt,entityIconVectorName:_t,webResourceUrl:Ct,hasCustomDataProvider:Je,commandBarRefreshProps:Xt,updatedConfiguration:Ue,offlineGridErrorTelemetryParams:xt,gridInput:Ge,gridTotalRecordsCountLimit:tt,gridSortingInfo:We,nativeFilterExpression:Be.isGridPaginationStateFeatureEnabled&&Ge?Ge.nativeFilterExpression:null,pageNumberForEnhancedPaging:Be.isGridPaginationStateFeatureEnabled&&!Ht&&Ge?Ge.gridPageNumber:null,userId:r.user&&r.user.userId||null,lookupAttributeForRecordHierarchy:Rt,fetchXML:Ve,viewType:ct,savedQueryType:lt,featureControlProps:Be,clientHostSubtype:De,backButtonEnabled:Yt,originalView:Kt,showColumnEditor:Qt,entityIsActivityType:Zt}}}function he(e,t,n,a,r){if(!a)return[];const i=ae(t.contextString),o=re(t.contextString),s=ne(t.contextString)&&Object(k.c)(e,N.bd),c=[];for(const e in a)c.push([e,a[e]]);const l=c.reduce((e,[t,n])=>((i||o||s)&&"quickFind"===t||("activityOrQueueFilterValue"===t||"activityTypeSelectedValues"===t)||!n||e.push(n),e),[]);if(r){const a=Object(y.t)(e,t.id,n);if(a&&a.customFilterXml){const e=Object(V.i)(a.customFilterXml),t=JSON.stringify(e);t&&l.push(t)}}else{const a=Object(y.q)(e,t.id,n);a&&l.push(a)}return l}function ge(e){let t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.CustomControlId;return t||(t=e.configuration&&"MscrmControls.SharepointAssociatedGrid.SharepointControl"===e.configuration.Name),t}function pe(e){if(!e&&"("!==e[0]||")"!==e[e.length-1])throw new Error(String.format("Resource string group must be in the format (A:a).  The format {0} is invalid.",e));const t=(e=(e=e.replace("(","")).replace(")","")).split(":");if(2!==t.length)throw new Error("Resource string group must have a search list defined.  E.g : (A:a).");return t}function me(e){var t,n,a;return"no"!==(null===(a=null===(n=null===(t=e.configuration)||void 0===t?void 0:t.Parameters)||void 0===n?void 0:n.EnableJumpBar)||void 0===a?void 0:a.Value)}function be(e,t,n,a,r,i,o){let s=e.dataSetUIOptions,c=a;if(o=!!Object(w.a)(o)||o,!s&&e.configuration&&e.configuration.Parameters){const t=e.configuration.Parameters[i];t&&t[f.f]&&(s=t[f.f])}const l=t&&t.Parameters&&t.Parameters[r]?"true"===t.Parameters[r]:o;return s&&n&&!Object(w.a)(s[n])&&(c=s[n]),c&&l}},kQA8:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n("TBkx"),r=n("YxC/"),i=n("69Qu"),o=n("Nzmy"),s=n("EY5k"),c=n("si7p"),l=n("pgSX");function u(e,t){return{type:"offline.alert.dialog.async",execute({dispatch:n,getState:u},d){if(Object(i.b)(u()))return o.c.info("Offline: Server is available"),Promise.resolve();const h=["Dialog_Button_Ok",e];return n(Object(s.e)(h)).then(()=>{const i=Object(r.b)(u(),"Dialog_Button_Ok"),s=Object(r.b)(u(),e);return n(Object(l.a)(c.a,s,null,i,null,void 0,void 0,void 0,void 0,void 0,t)).then(e=>0===e.status?(o.c.info("Offline: Alert dialog is created successfully with message "+s),Promise.resolve()):(o.c.error("Offline: Error in Sync error dialog creation "+Object(a.e)(e.error)),Promise.reject(e.error)))}).catch(e=>(o.c.error("Offline: Error in alert dialog creation "+Object(a.e)(e)),Promise.reject(e)))}}}},kt5S:function(e,t,n){"use strict";n.d(t,"g",(function(){return C})),n.d(t,"i",(function(){return _})),n.d(t,"h",(function(){return v})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return O})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return P})),n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return j}));var a=n("BFlg"),r=n("P6DH"),i=n("arV0");function o(e,t,n,a){return{type:"update.grid.configuration",payload:{[t]:{[n]:e}},meta:{pageId:a}}}function s(e,t,n){return{type:"update.views.configuration",payload:{[t]:e},meta:{pageId:n}}}var c=n("oOvK"),l=n("9fGf"),u=n("Z/4N"),d=n("y60j"),h=n("SAYH"),g=n("KBcj"),p=n("S2mk"),m=n("5ZBI"),b=n("j6Db"),f=n("zmL5");function y(e,t){const n=Object.assign({},e.CustomControls);if(e.CustomControls[t]&&!e.CustomControls[t].isDefaultConfig){let a=!1;for(const n in e.CustomControls)if(I(e.CustomControls[n],e.CustomControls[t])&&n!==t.toString()){a=!0;break}if(!a){let a=-1;n[a]?a--:n[a.toString()]=e.CustomControls[t]}}return n[t]=null,n}function C(e,t,n,a,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:h},g){const p=h(),f=Object(l.b)(p),y=Object(r.k)(p,e,t),C={UniqueId:y?y.UniqueId:null,CustomControls:{[f]:Object.assign(Object.assign({},n),{FormFactor:f})},FormLibraries:y?y.FormLibraries:null,EventHandlers:y?y.EventHandlers:null},{entityTypeName:_}=Object(i.g)(p,e);if(u){const n=Object(r.T)(p,e,t);d(s({UniqueId:null,CustomControls:{[f]:null},FormLibraries:null,EventHandlers:null},n.guid,e))}d(Object(c.c)(n.CustomControlId)).then(()=>{d(o(C,_,a,e))},t=>{const r=Object(m.b)(h(),n.CustomControlId);g.EventManager.ReportComponentFailure(r+".CustomControl.retrieveControlManifest",t,"retrieveControlManifest failure error message",[{name:"APIName",value:b.a+".Actions.SwitchVisualization"},{name:"entityTypeName",value:_},{name:"customControlId",value:n.CustomControlId},{name:"pageId",value:e},{name:"controlId",value:a},{name:"config",value:JSON.stringify(n)}])})}}}function _(e,t,n,a,u){return{type:"customcontrol.changevisualization.homepage",sync:!0,execute({dispatch:d,getState:h}){const p=h(),m=Object(l.b)(p),b=Object(r.T)(p,e,t),f=Object(g.d)(p,b),C={UniqueId:f?f.UniqueId:null,CustomControls:{[m]:Object.assign(Object.assign({},n),{FormFactor:m})},FormLibraries:f?f.FormLibraries:null,EventHandlers:f?f.EventHandlers:null},{entityTypeName:_}=Object(i.g)(p,e);if(u){const n=Object(r.k)(p,e,t);if(n&&n.CustomControls&&n.CustomControls[m]){const t={UniqueId:n.UniqueId,CustomControls:y(n,m),FormLibraries:n.FormLibraries,EventHandlers:n.EventHandlers};d(o(t,_,a,e))}}d(Object(c.c)(n.CustomControlId)).then(()=>{d(s(C,b.guid,e))})}}}function v(e,t,n){return{type:"customcontrol.changevisualization.subgrid",sync:!0,execute({dispatch:a,getState:r}){const i=r(),s=Object(l.b)(i),h=Object(f.b)(i,e),g=Object(d.b)(i,e,h,n),p=Object(u.b)(i,g.UniqueId,h);if(!p||!p.CustomControls)return;const m={UniqueId:g.UniqueId,CustomControls:{[s]:Object.assign(Object.assign({},t),{FormFactor:s})},FormLibraries:p.FormLibraries,EventHandlers:p.EventHandlers};a(Object(c.c)(t.CustomControlId)).then(()=>{a(o(m,h.guid,p.UniqueId,e))})}}}function S(e,t,n,a,r){return{type:"customcontrol.changevisualization.associatedgrid.grid",sync:!0,execute({dispatch:i,getState:s}){const u=s(),d=Object(l.b)(u),h={UniqueId:r.UniqueId,CustomControls:{[d]:Object.assign(Object.assign({},a),{FormFactor:d})},FormLibraries:r.FormLibraries,EventHandlers:r.EventHandlers};i(Object(c.c)(a.CustomControlId)).then(()=>{i(o(h,t,n,e))})}}}function O(e,t,n,a,r,i,u){return{type:"customcontrol.changevisualization.associatedgrid.view",sync:!0,execute({dispatch:d,getState:h}){const g=h(),p=Object(l.b)(g),m={UniqueId:i.UniqueId,CustomControls:{[p]:Object.assign(Object.assign({},r),{FormFactor:p})},FormLibraries:i.FormLibraries,EventHandlers:i.EventHandlers};if(u&&u.CustomControls&&u.CustomControls[p]){const a={UniqueId:u.UniqueId,CustomControls:y(u,p),FormLibraries:u.FormLibraries,EventHandlers:u.EventHandlers};d(o(a,t,n,e))}d(Object(c.c)(r.CustomControlId)).then(()=>{d(s(m,a.guid,e))})}}}function I(e,t){if(e&&t){let n=!!e==!!t&&e.CustomControlId===t.CustomControlId&&e.Name===t.Name&&e.ShouldOverrideControlVisible===t.ShouldOverrideControlVisible&&e.Version===t.Version&&e.isDefaultConfig===t.isDefaultConfig&&function e(t,n){var a,r;if(t&&n&&t!==n){if(t instanceof Array&&n instanceof Array&&t.length!==n.length)return!1;for(const i in t)if(t[i]!==n[i]){if("function"==typeof t[i])continue;if(t[i]&&n[i]&&"object"==typeof t[i]&&"object"==typeof n[i]){if(e(t[i],n[i]))continue;return!1}if("EnableViewPicker"===i)return(null===(a=t[i])||void 0===a?void 0:a.toString())===(null===(r=n[i])||void 0===r?void 0:r.toString());if("ExtraFilters"!==i&&"PagingInput"!==i&&"FilteringInput"!==i&&"RefreshInput"!==i&&"ViewId"!==i&&"EntityName"!==i&&"LinkingInput"!==i&&"FirstDataRequestType"!==i&&"NativeFilterExpressionToRestore"!==i&&"LookupAttributeNameForHierarchy"!==i&&"SortingInput"!==i&&"function"!=typeof t[i])return!1}}return!0}(e.Parameters,t.Parameters);if(e.Children&&t.Children){if(Object.keys(e.Children).length===Object.keys(t.Children).length){for(const a in e.Children)n=n&&I(e.Children[a],t.Children[a]);return n}return!1}return n&&e.Children===t.Children}return!!e==!!t}function j(e,t,n,a,r,i,o,s){const c=t?t.TraceManager.getTracer("customcontrol"):null;return e(P(n,a,i.configuration,i,i.contextString,s).map(e=>e.configuration.DisplayNameKey)).catch(e=>(c&&c.info("Resource retrieve failed: "+e.message),Promise.resolve()))}function P(e,t,n,r,i,o){const s=[];if(null==o)return s;if(i===a.h.CUSTOM&&r.configuration.isDefaultConfig)return s;const c=i===a.h.GRID||i===a.h.ASSOCIATEDGRID?Object(p.u)(r&&r.controlId,r&&r.gridEntityTypeName,r&&h.a.toString(r.viewId)):Object(p.x)(r&&r.controlId,r&&r.descriptor.Parameters);return s.push({configuration:c,formFactor:o,configurationType:null}),e&&e.CustomControls&&x(s,e,"GRID_CONFIG"),t&&t.CustomControls&&x(s,t,"VIEW_CONFIG"),s}function x(e,t,n){for(const a in t.CustomControls)if(t.CustomControls[a]&&!t.CustomControls[a].isDefaultConfig){let r=!1;for(let n=0;n<e.length;n++)if(I(e[n].configuration,t.CustomControls[a])){r=!0;break}r||e.push({configuration:t.CustomControls[a],formFactor:a,configurationType:n})}}function E(e,t){return null!=t.DisplayNameKey?null!=e&&null!=e[t.DisplayNameKey]?e[t.DisplayNameKey]:t.DisplayNameKey:"Grid"}},lEp6:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e){let t="";try{t=JSON.stringify(e)}catch(e){}return t}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},lSDC:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var a=n("Lyxw"),r=n("3/02"),i=n("arV0"),o=n("zu1I"),s=n("Nb1E"),c=n("odYE");var l=n("YxC/"),u=n("69Qu");function d(e,t,n,d,h){const m=Object(a.a)(e.getState(),r.F)&&Object(u.b)(e.getState()),b=Object(i.g)(e.getState(),n);if(m&&b&&"connectionrole"===b.entityTypeName&&b.id){return{Icon:"ConnectionRoleManageRecordType",DisplayText:Object(l.c)(h,g),Tooltip:{title:Object(l.c)(h,p),description:Object(l.c)(h,p)},Id:"manageRecordTypes",execute:()=>{return t=e.dispatch,a=b.id,t(function(e,t){return{type:"open.manage.resource.type.dialog",execute({dispatch:n,getState:a},r,i){const l=new c.a("connectionrole",e),u=[{name:"recordId",value:e.guid}];return n(Object(s.d)(l,"?$expand=connection_role_connection_role_object_type_codes")).then(a=>{if(a&&a.connection_role_connection_role_object_type_codes){const i=a.connection_role_connection_role_object_type_codes,s=[],c=a.statecode;i.map(e=>{s.push({LogicalName:e.associatedobjecttypecode,connectionroleobjecttypecodeid:e.connectionroleobjecttypecodeid})});const l={param_recordId:e,param_selectedEntities:JSON.stringify(s),param_stateCode:c},d={height:480,width:320};return n(Object(o.b)("ConnectionRoleManageRecordTypesDialog",d,l,t)).then(e=>{r.EventManager.ReportComponentSuccess("ConnectionRoleManageRecordTypesDialog",u)})}},e=>{r.EventManager.ReportComponentFailure("ConnectionRoleManageRecordTypesDialog",e,null,u)})}}}(a,n)).then(()=>({}));var t,a}}}return null}function h(e,t){const n=Object(a.a)(e,r.F)&&Object(u.b)(e),o=Object(i.g)(e,t);return n&&o&&"connectionrole"===o.entityTypeName?m:[]}const g="ConnectionRole_EntityPickerMDD_Button_Label",p="ConnectionRole_EntityPickerMDD_Button_Description",m=[g,p]},ldWj:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("0nOn"),r=n("ScMg"),i=n("i1f0"),o=n("Sbn7"),s=n("16wZ"),c=n("vlcQ"),l=n("3MuQ"),u=n("qshH"),d=n("ZIjf"),h=n("IaGr");let g;class p extends r.a{constructor(e,t,n,r,i,o){super(e,t,n,r),this._parent=i,g=e,this._formContext=o,this._iConnectedSectionProp={sectionName:this.name,id:this.pageId},this._clientApiExecutorTabSection=new a.a(e,"ClientApi.XrmTabSection.",n,t),this.clientApiExecutor.addEventParameter({name:"controlName",value:r,isEventParam:!0})}get clientApiExecutor(){return this._clientApiExecutorTabSection}get controls(){return this.clientApiExecutor.execute("controls",(e,t)=>{if(!this._controls){const n=g.getState();this._controls=new o.a(e);const a=this.getControlsDescriptor(n);if(!a)return this._controls;for(const n in a){const a=this._formContext.ui.controls.get(n);if(a)this._controls.add(a.getName(),a);else{const a=t.slice();a.push({name:"controlKey",value:n}),h.a.getInstance().traceManager.getTracer(e).warn("Section control was not found in the form controls collection",a)}}}return this._controls})}getParent(){return d.a.instance.reportUsage("ClientApi.XrmTabSection.getParent"),this._parent}getVisible(){const e="ClientApi.XrmTabSection.getVisible";try{d.a.instance.reportCall(e);const t=Object(i.tc)(g.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(s.a)(t)?this._getSectionDescriptorValues().Visible:t;return d.a.instance.reportSuccess(e),n}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}getLabel(){const e="ClientApi.XrmTabSection.getLabel";try{d.a.instance.reportCall(e);const t=Object(i.rc)(g.getState(),this._iConnectedSectionProp,this.contextToken),n=Object(s.a)(t)?this._getSectionDescriptorValues().Label?this._getSectionDescriptorValues().Label:"":t;return d.a.instance.reportSuccess(e),n}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}_getSectionDescriptorValues(){try{return Object(i.qc)(g.getState(),this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection._getSectionDescriptorValues",e,null,t),e}}getControlsDescriptor(e){try{return Object(i.H)(e,this._iConnectedSectionProp,this.contextToken)}catch(e){const t=u.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure("ClientApi.XrmTabSection.getControlsDescriptor",e,null,t),e}}setVisible(e){const t="ClientApi.XrmTabSection.setVisible";try{d.a.instance.reportCall(t),g.dispatch(Object(c.b)(this.pageId,this.contextToken,this.name,!0===e)),d.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}setLabel(e){const t="ClientApi.XrmTabSection.setLabel";Object(s.a)(e)&&Object(s.j)(t,"label");try{d.a.instance.reportCall(t),g.dispatch(Object(l.b)(this.pageId,this.contextToken,this.name,e)),d.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(t,e,null,n),e}}}},"m+2h":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="footer.visible";function i(e,t,n){const i=Object(a.v)(t);return{type:r,payload:n,meta:{pageId:e,contextKey:i}}}},mHvI:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n("lSDC"),r=n("1fn7"),i=n("i1f0"),o=n("+zjj"),s=n("lju1");const c=[a.b];function l(e,t){let n=Object(i.Ib)(e,t)?r.u:r.t;return n=n.concat(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){let n=[];if(c)for(const a of c)n=n.concat(a(e,t));return n}(e,t)),n}function u(){let e=[];return e=e.concat(Object.values(o.a).map(e=>e.reason)),e=e.concat(Object.values(o.b)),e=e.concat(Object.values(s.a)),e=e.concat(Object.values(i.b).map(e=>e.reason)),e}},meVR:function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n("+zjj"),r=n("+Ajx"),i=n("6Qf/"),o=n("P6DH"),s=n("d0w6"),c=n("KBcj"),l=n("vNXc"),u=n("a72m"),d=n("BFlg"),h=n("pEXn"),g=n("5R5s"),p=n("hSDL"),m=n("aF0N"),b=n("Ii8m"),f=n("69Qu"),y=n("jAuy"),C=n("eXjw"),_=n("Lyxw"),v=n("3/02"),S=n("fyfl"),O=n("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=`${d.x}.${d.v}`;function j(e,t,n,a,r,s,u,d,h,m){const b=x(a,u,h),C=Object(c.c)(t,n);if(!C)return Promise.resolve(null);const S=l.a.fromXmlAndSql(C.fetchXML,C.offlineSqlQuery,n).getQueryState(),O=m||Object(o.db)(t,a,u),I=Object(y.c)(r,s);let j=!1;Object(f.b)(t)&&Object(y.h)(t,s.relationshipName,!0)&&(j=!0);const E=Object(o.ub)(t,a);if(E||"activitypointer"===a||j){const n=t.user&&t.user.userId,o=Object(_.c)(t,v.Zc),c=Object(g.a)(a,n,s,o,E);return e(c.getFilterOptionsAction()).then(n=>{if(n&&n.length>0){const t=n.filter(e=>e.isDefault);if(t&&t.length>0){const n=c.getFilterExpression(t[0].value);e(Object(p.l)(n,r,s))}}return e(Object(i.d)(S,a,r,s,null,u,O,j,I)).then(n=>P(e,n,t,a,r,b,d))})}return e(Object(i.d)(S,a,r,s,null,u,O,void 0,I)).then(n=>P(e,n,t,a,r,b,d))}function P(e,t,n,a,r,s,c){const l=Object(m.c)(n),u=Object(m.b)(n);return(l||u)&&Object(o.sb)(n,a)&&Object(i.e)(c,e,a,r),c.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid.initializeRelatedGrid",s),c.EventManager.ReportComponentSuccess(I,s),t}function x(e,t,n){return[{name:h.a.CorrelationId,value:n.correlationId},{name:h.a.ContextId,value:n.contextId},{name:h.a.ActionStack,value:n.stack},{name:"entityName",value:e},{name:"relationshipName",value:t}]}function E(e,t,n){const i=[{name:"EntityName",value:n.entityName}];return{type:"form.related.openGrid",execute({dispatch:i,getState:l},d,g){const p=l(),m=Object(a.e)(p,{id:e},t.parentContextToken),f=x(n.entityName,n.relationshipName,g);if(i(Object(r.b)(e,t,n)),null!==m&&m.id===n.id&&m.isSelected===n.isSelected&&m.relationshipName===n.relationshipName||i(Object(r.b)(e,t.parentContextToken,n)),i(Object(b.a)(e,n)),n&&!n.url){const a=function(e,t){return[{name:h.a.CorrelationId,value:e.correlationId},{name:h.a.ContextId,value:e.contextId},{name:h.a.ActionStack,value:e.stack},{name:"hasViewId",value:!0},{name:"entityName",value:t}]}(g,n.entityName);if(!Object(o.v)(p,e,t)){i(Object(u.b)(n.entityName,s.a.MAIN_APPLICATION_VIEW));const r=Object(c.a)(p,n.entityName,s.a.SUB_GRID),o=Object(c.c)(p,r),h=Object(_.c)(p,v.Xc),m=!h||function(e,t){var n,a,r;if(!(null===(a=null===(n=null==t?void 0:t.grid)||void 0===n?void 0:n.rows)||void 0===a?void 0:a.length)||!(null===(r=e.metadata)||void 0===r?void 0:r.entities))return!0;const i=t.grid.rows[0].cells;if(!(null==i?void 0:i.length))return!0;for(let t=0;t<i.length;t++)if(i[t].relatedEntityName&&!e.metadata.entities[i[t].relatedEntityName])return!1;return!0}(p,o);return o&&o.initialized===C.a.Initialized&&m?(j(i,p,r,n.entityName,e,t,n.relationshipName,d,g,n.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(I,e,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",a),Promise.resolve(r)):i(Object(u.a)(n.entityName,s.a.SUB_GRID)).then(r=>{let o=Promise.resolve();if(h){const t=Object(S.a)(p,r,e);o=i(Object(O.e)(t))}return o.then(()=>{const o=l();return j(i,o,r,n.entityName,e,t,n.relationshipName,d,g,n.ordinal).catch(e=>{d.EventManager.ReportComponentFailure(I,e,null,f)}),d.EventManager.ReportComponentSuccess("Forms.OpenRelatedGrid",a),r})},e=>{d.EventManager.ReportComponentFailure(I,e,null,f)})}}return Promise.resolve(null)},getFailureParameters:(e,t)=>i}}},mhYf:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var a=n("dHD5"),r=n("i1f0"),i=n("TYIz"),o=n("+zjj"),s=n("wL2W"),c=n("4aOd"),l=n("pEXn"),u=n("tWr6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="tab.visible";function h(e,t,n,h){return{type:"tab.visible.sync",sync:!0,execute({dispatch:g,getState:p},m){var b;const f=p();g(function(e,t,n,r){const i=Object(a.v)(n);return{type:d,payload:r,meta:{pageId:e,tabId:t,contextKey:i}}}(e,t,n,h));const y=Object(r.wc)(f,{id:e},n),C=Object(o.e)(f,{id:e},n);if(y||(null==C?void 0:C.isSelected)||!h){if(y===t&&!h){const a=Object(r.fb)(f,{id:e},n);let o=!1;if(a){const s=Object(r.m)(f,a);for(const a of s)if(a.Id!==t&&Object(r.Kc)(f,a.Id,e,n)){o=!0,g(Object(i.b)(e,a.Id,n));break}}o||g(Object(i.b)(e,void 0,n))}}else g(Object(i.b)(e,t,n));if(Object(s.a)()){const a=p(),i=null===(b=null==m?void 0:m.TraceManager)||void 0===b?void 0:b.getTracer(`${l.k}${l.r}`),o=Object(r.Kc)(f,t,e,n),s=Object(r.Kc)(a,t,e,n),d=Object(u.a)(a,e);d.push({name:"tabId",value:t}),d.push({name:"tabName",value:Object(r.Ic)(a,t,e,n)}),d.push({name:"tabLabel",value:Object(r.Hc)(a,t,e,n)}),d.push({name:"visible state before change",value:null==o?void 0:o.toString()}),d.push({name:"visible state after change",value:null==s?void 0:s.toString()}),d.push({name:"callstack",value:new c.a(new Error).getStackTrace()}),null==i||i.warn(l.n,[{name:l.v,value:l.r+".visible"},{name:l.r,value:JSON.stringify(d)}])}}}}},mlKL:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var a=n("arV0"),r=n("jRy5"),i=n("dHD5"),o=n("ApeL"),s=n("i1f0"),c=n("mIxf"),l=n("bT7G"),u=n("WPtp");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d="attribute.requiredLevel";function h(e,t,n,h){return{type:"attribute.requiredLevel.validation",sync:!0,execute(g,p){const m=g.getState();if(h!==Object(s.pc)(m,e,t,n)){g.dispatch(function(e,t,n,a){if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)return Object(o.f)(e,t,n,a);const s=Object(i.x)(t);return{type:d,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:n}}}(e,t,n,h));const p=Object(s.ac)(m,e,t),b=Object(l.b)(m,p);if((0===h||3===h)&&b&&b.activeChanges&&b.activeChanges[n]||t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow){let o=null,d=null,h=null,b=null;if(t&&t.contextTokenType&&t.contextTokenType===r.a.GridRow)o=t.entityTypeName?t.entityTypeName:null,d=t.recordId?t.recordId:null,h=Object(i.t)(t),b=Object(i.r)(t);else{const n=Object(a.g)(m,e);o=n&&n.entityTypeName?n.entityTypeName:null,d=n&&n.id?n.id:null,h=null,b=t}const f=Object(l.d)(m,p,{etn:o,id:d},n);if(Object(s.Uc)(f)){const t={[n]:{fieldName:n,value:f?f.formatted?f:Object(u.e)(f):f}};g.dispatch(Object(c.a)(e,t,!0,!0,o,d?d.guid:null,h,b))}}}}}}},nIfK:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return L})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return D}));var a=n("Yx7Y"),r=n("SAYH"),i=n("vNXc"),o=n("9fGf"),s=n("Z/4N"),c=n("P6DH"),l=n("p/2N"),u=n("iZ7K"),d=n("sn0j"),h=n("y60j"),g=n("BJ7u"),p=n("JwRZ"),m=n("504W"),b=n("IqkD"),f=n("CB5L"),y=n("odYE"),C=n("i1f0"),_=n("bT7G"),v=n("00VO"),S=n("YGjz"),O=n("LbMF"),I=n("BFlg"),j=n("Lyxw"),P=n("3/02"),x=n("jAuy"),E=n("/Zy9"),w=n("arV0"),T=n("z+5+"),A=n("d0w6"),F=n("AF/G");const N=["MscrmControls.Grid.ReadOnlyGrid","MscrmControls.Grid.GridControl","MscrmControls.SharepointAssociatedGrid.SharepointControl","MscrmControls.MailApp.MailAppListControl"],k=["Opportunity_ActivityPointers"];function M(e){const t=e&&e.control&&e.control.Parameters&&e.control.Parameters.hasOwnProperty(I.r)&&e.control.Parameters[I.r],n=[e.viewId,t,e.recordsPerPage,(a=e,a&&a.controlParameters&&a.controlParameters.ChartDrillDownParameters&&a.controlParameters.ChartDrillDownParameters.length>0)];var a;return e.customQueryStateKeyParts&&n.push(...e.customQueryStateKeyParts),n.join("")}function D(e,t,n,a,r){const o=R(e,t,n,a,r);return t=>{const n=o(t);return n&&n.getQueryState(n instanceof i.a?void 0:e)}}function R(e,t,n,a,s){const l={};return u=>{const d=new r.a(u.viewId),h=Object(c.qb)(e(),d,t);if(!h)return null;const g=function(e,t,n){let a=t.fetchXML,r=null;const i="TeamTemplateId";if(t.entityLogicalName===S.a&&e.controlParameters[i]){const t=e.controlParameters[i];if(a&&a.indexOf(t)<0){const e=n?n.guid:"",i=Object(v.a)(a,t,e);a=i.updatedFetchXml,r=i.filterString}}return{fetchXML:a,filterString:r}}(u,h,a);let I=g.fetchXML;if(!I&&h.queryApi)return null;if(Object(x.l)(e())&&u.quickFindViewId){const n=new r.a(u.quickFindViewId),a=r.a.isNullOrEmpty(n)?null:Object(c.qb)(e(),n,t);Object(m.a)(a)||(I=function(e,t){const n=new DOMParser;if(e){const a=n.parseFromString(e.fetchXML,"text/xml"),r=n.parseFromString(t.fetchXML,"text/xml"),i=a.getElementsByTagName("filter");for(let e=0;e<i.length;e++)i[e].attributes&&i[e].attributes.getNamedItem("isquickfindfields")&&r.getElementsByTagName("entity")[0].appendChild(i[e]);return(new XMLSerializer).serializeToString(r)}return t.fetchXML}(a,h))}const N=e(),M=u.entityLogicalName,D=u.getCustomFilter&&u.getCustomFilter(),R=function(e,t,n,a,i){const o=i.controlParameters.RelationshipName;if(o){let s=a,l=null,u=null;if(i.controlParameters.DependentAttributeName){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}if(i.controlParameters.IsDataSetLookup&&(s=null==i.controlParameters.ParentRecordId?r.a.EMPTY:new r.a(i.controlParameters.ParentRecordId),i.controlParameters.DependentAttributeName)){u=i.controlParameters.DependentAttributeName;l=u.split(".")[1]||u}const d=Object(C.ac)(e,t,i.contextToken),h=new y.a(n,s);let g=null,p=!1;Object(O.a)(e,n,l)?g=Object(_.d)(e,d,h,l):i.controlParameters.DependentAttributeType&&(p=i.controlParameters.DependentAttributeType===n&&i.controlParameters.DependentAttributeType!==i.entityLogicalName);const m=g;m&&m.reference?s=m.reference.id:!i.controlParameters.IsDataSetLookup&&null===l||null!==m&&null!==m.reference||!h||null===h.id||p||(s=null);const b=Object(c.kb)(e,t,i.contextToken);let v=0,S=f.h.None;return b?(v=1,-1===k.indexOf(o)&&(S=f.h.Related)):(i.controlParameters.ShouldApplyContextFilter&&i.controlParameters.IsDataSetLookup||!i.controlParameters.IsDataSetLookup)&&(v=2),{type:v,rollupType:S,entityReference:h,contextId:s,relationshipName:o}}return null}(N,t,s||n&&n.EntityLogicalName,a,u),B=Object(p.p)(e(),M),V=function(e,t,n,a,i,o,s){var l;const u=Object(w.g)(e,o),d=!(!(null==u?void 0:u.pageToEditedViewMapId)||!Object(c.rb)(e,u.pageToEditedViewMapId.guid,s.guid)),h=Object(c.qb)(e,s,o),g=t.hasGrid&&(1===t.gridType||void 0===t.gridType&&r.a.equals(null===(l=t.control)||void 0===l?void 0:l.ClassId,F.E));return Object(T.e)(e)&&(g||Object(T.f)(e))&&!(1===(null==n?void 0:n.type))&&!(2===(null==n?void 0:n.type))&&!(a&&a.linkEntities&&Array.isArray(a.linkEntities)&&a.linkEntities.length>0)&&!i&&!(a&&a.filter&&Array.isArray(a.filter)&&a.filter.length>0)&&!d&&(null==h?void 0:h.queryType)!==A.a.QUICKFIND_SEARCH&&!t.quickFindViewId}(N,u,R,D,B,t,d)?E.a.fromView(d,u.quickFindSearchString):i.a.fromXmlAndSql(I,h.offlineSqlQuery,d,u.quickFindSearchString,M,e);(null==g?void 0:g.filterString)&&a&&V.addExistingContextFilterToKey(r.a.toString(a),g.filterString);const G=Object(c.x)(e(),t,u.contextToken);G&&(V.pageNumber=G);const z=L(e(),t,n,u,h,M);z.length&&V.select(...z);const W=function(e,t,n,a,r,i){let s=null;if(!Object(j.a)(e,P.ub)||!i.hasGrid||1!==i.gridType)return null;const l=Object(c.j)(a)(e,t,i.contextToken),u=Object(o.b)(e),d=l&&l.CustomControls&&l.CustomControls[u]&&l.CustomControls[u].Parameters;if(!Object(c.vb)(d)&&(s=Object(c.o)(e,n),s)){const e=[],t=r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells;if(t)for(const n in t)t.hasOwnProperty(n)&&e.push(t[n].name);-1!==e.indexOf(s.lookupAttribute)&&(s.lookupAttribute=null),r&&r.fetchXML&&Object(x.b)(r.fetchXML)&&(s.primaryAttribute=null)}return s}(e(),t,M,d,h,u);W&&(W.lookupAttribute&&V.select(W.lookupAttribute),W.primaryAttribute&&V.addChildCountAttribute(W.primaryAttribute));const X=u.getCustomSorting&&u.getCustomSorting(h,l);if(X)for(const e of X)V.orderBy(e.name,1===e.sortDirection);if(R)switch(R.type){case 1:V.applyRollupContextFilter(R.entityReference,R.rollupType);break;case 2:const e=Object(c.v)(N,t,u.contextToken);V.applyContextFilter(R.relationshipName,R.contextId,N,e?e.relationshipRoleOrdinal:void 0)}if(B&&V.where(B),D&&D.filter)if(Array.isArray(D.filter)){const e=D.filter;for(const t of e)V.where(t,t.shouldReplace)}else{const e=D.filter;!function(e){return!!(e&&e.operator&&e.terms)}(e)?V.where(Object(p.n)(D.filter,null)):V.where(e,e.shouldReplace)}if(D&&D.linkEntities)for(const e of D.linkEntities)V.addLinkedEntity(e,e.attributes||[]);const H=u.recordsPerPage;if(H)V.pageSize=H;else{const t=Object(b.h)(e());u.hasChart||Object(m.a)(t)?V instanceof i.a&&V.setDefaultPageSize():V.pageSize=t}return V}}function L(e,t,n,a,r,i){const o=[...B(e,n,a,r.viewId),...V(e,a,i,r.viewId),...G(e,n,a,i),...z(e,a,i),...W(e,t,a,i),...a.getCustomColumns?a.getCustomColumns():[]];if(o.length){const e=[],t=[],n=r&&r.grid&&r.grid.rows&&r.grid.rows[0]&&r.grid.rows[0].cells;if(n)for(const e in n)n.hasOwnProperty(e)&&t.push(n[e].name);for(const n in o){const a=o[n];-1===t.indexOf(a)&&-1===e.indexOf(a)&&e.push(a)}return e}return o}function B(e,t,n,a){if(0!==n.gridType)return[];let r="Grid";const i=Object(o.b)(e),u=t&&Object(s.a)(n.control,t,i);return u&&(r=Object(c.ab)(e,u.CustomControlId)),Object(l.b)(e,n.control.UniqueId,r,t&&t.Id,null,null,a)||[]}function V(e,t,n,a){return 1!==t.gridType?[]:Object(l.a)(e,n,a)||[]}function G(e,t,n,a){const r=[],i=Object(u.h)(e,a);return i&&(function(e,t,n){const a=Object(o.b)(e),r=t&&Object(s.a)(n.control,t,a);return r&&[r.CustomControlId&&r.Name].some(e=>-1!==N.indexOf(e))}(e,t,n)||n.hasGrid)&&("activitypointer"===a&&r.push("activitytypecode"),i.PrimaryNameAttribute&&r.push(i.PrimaryNameAttribute),Object(c.vb)(n.controlParameters)||i.PrimaryImageAttribute&&r.push(Object(x.a)(i.PrimaryImageAttribute))),r}function z(e,t,n){const a=[];if(4&t.streamMode){a.push("modifiedon");const t=Object(O.d)(e,n);if(t)for(const r in t){const i=t[r];i.IsSortableEnabled&&"image"!==i.Type&&"multiselectpicklist"!==i.Type&&Object(d.b)(e,n,i.LogicalName,i)&&a.push(i.LogicalName)}}else 2&t.streamMode&&a.push("modifiedon");return a}function W(e,t,n,i){const o=[],s=n.cardFormId;if(s)if("activitypointer"===i)o.push(...d.a);else{const n=r.a.equals(s,a.a)?Object(h.h)(e,i,Object(g.a)(11)):s,c=Object(h.d)(e,n,t);if(c)for(const e in c){const t=c[e];t.DataFieldName&&o.push(t.DataFieldName)}}return o}},nexV:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("Kvn0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function r(e,t){const n={displayState:e};return{type:a.c,payload:n}}},oLPm:function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"j",(function(){return g})),n.d(t,"g",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"e",(function(){return b}));var a=n("GWSs"),r=n("n/MI"),i=n("Wbnz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o=a.e,s="Web.NavBar.Navigate_Dynamics365",c="Web.NavBar.Close_Site_Map",l="Web.NavBar.Favorites_And_Recent",u="Web.NavBar.All_Areas",d="Web.NavBar.NavigationTip",h="Available_Offline",g="Web.NavBar.Switch_App_Text",p="Not_Available_Offline",m="Web.NavBar.SiteMap",b=[o,a.c,a.d,r.a,r.b,r.c,r.d,g,s,c,l,u,d,a.a,a.b,h,p,m,i.b,i.a]},pUMQ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;n.d(t,"a",(function(){return a})),function(e){e.Expanded="",e.UpArrowHead="",e.LeftArrowHead="",e.Collapsed="",e.Edit="",e.Save="",e.Delete="",e.Remove="",e.Add="",e.Cancel="",e.HandClick="",e.Accept="",e.More="",e.Forward="",e.Favorite="",e.Placeholder="",e.RatingFull="",e.RatingEmpty="",e.Options="",e.Manage="",e.Settings="",e.Find="",e.Help="",e.ViewNotifications="",e.StageAdvance="",e.CheckMark="",e.Locked="",e.Lock="",e.MoreOptions="",e.ContactInfo="",e.Pin="",e.Unpin="",e.Refresh="",e.Details="",e.VisualFilter="",e.GlobalFilter="",e.Diamond="",e.ApplyFilter="",e.CancelFilter="",e.StreamView="",e.TileView="",e.Import="",e.Tools="",e.Attach="",e.Filter="",e.Copy="",e.HighPriority="",e.ReduceTile="",e.ExpandTile="",e.GlobalFilterExpand="",e.GlobalFilterCollapse="▷",e.Clear="",e.Post="",e.OneNote="",e.Home="",e.SetAsHome="",e.BackButton="",e.BackButtonWithoutBorder="",e.UpArrow="",e.DownArrow="",e.SetActiveButton="",e.SearchButton="",e.ForwardButton="",e.Mail="",e.CheckedMail="",e.FailedMail="",e.Phone="",e.Chat="",e.OpenPane="",e.ClosePane="",e.AddFriend="",e.Arrow="",e.DropdownArrow="",e.FlsLocked="",e.LinkArticle="",e.UnlinkArticle="",e.CopyLink="",e.EmailLink="",e.Share="",e.Assign="",e.Connect="",e.Opportunity="",e.Appointment="",e.Task="",e.Case="",e.PhoneCallIncoming="",e.PhoneCallOutgoing="",e.EmailIncoming="",e.EmailOutgoing="",e.SendEmail="",e.ApplyTemplate="",e.InsertKbArticle="",e.SendSelected="",e.SaveAndClose="",e.ReplyEmail="",e.ReplyAllEmail="",e.ForwardEmail="",e.Close="",e.Activate="",e.DeActivate="",e.DeleteBulk="",e.SocialActivityIncoming="",e.SocialActivityOutgoing="",e.CustomActivity="",e.SystemPost="",e.Convert="",e.MarkAsWon="",e.MarkAsLost="",e.SetRegarding="",e.SaveAsComplete="",e.SwitchProcess="",e.Recalculate="",e.SendDirectEmail="",e.OpenMailbox="",e.ReOpenOpportunity="",e.ReactivateLead="",e.Disqualify="",e.Qualify="",e.SelectView="",e.SelectChart="",e.OpenInBrowser="",e.NewAppointment="",e.NewRecurringAppointment="",e.NewPhoneCall="",e.NewTask="",e.NewEmail="",e.AddExisting="",e.SaveAndEdit="",e.Default="",e.ScrollRight="»",e.ScrollLeft="«",e.SaveAndRunRoutingRule="",e.RunRoutingRule="",e.ResolveCase="",e.CancelCase="",e.ReactivateCase="",e.AddToQueue="",e.CreateChildCase="",e.QueueItemRoute="",e.QueueItemRelease="",e.QueueItemRemove="",e.QueueItemPick="",e.Drilldown="",e.PopOverButton="",e.ExitButton="",e.ExportToExcel="",e.WordTemplates="",e.DocumentTemplates="",e.OpenInPowerBI="",e.OpenPowerBIReport="",e.OpenDelve="",e.ArticleLink="",e.ArchiveArticle="",e.ApproveArticle="",e.DiscardArticle="",e.Minor="",e.Major="",e.PublishKnowledgeArticle="",e.RelateArticle="",e.RelateProduct="",e.RestoreArticle="",e.RevertToDraftArticle="",e.Translate="",e.UpdateArticle="",e.RemoveFilter="",e.Article="",e.Graph="",e.CSR="",e.MembersIcon="",e.QueueIcon="",e.SiteMap="",e.NormalPriority="",e.LowPriority="",e.ViewIcon="",e.RecentCases="",e.KBRecords="",e.NumberOfViews="",e.ResizeHandle="",e.TaskBasedFlow="",e.InformationIcon="",e.PencilIcon="",e.ErrorIcon="",e.SuccessIcon="",e.OptionsetIcon="",e.NotificationIcon="",e.PanelHeaderImportDataIcon="",e.SidePanelUpload="",e.New="",e.DetailsPageClose="",e.SettingsListIcon="",e.ListIcon="",e.ForwardDisable="",e.PdfIconFile="",e.PresentationFile="",e.OneNoteFile="",e.AccessFile="",e.VisioFile="",e.ProjectFile="",e.Plus="",e.ChevronDown="",e.ChevronUp="",e.HappySmiley="",e.SadSmiley="",e.CaseResolution="",e.CampaignResolution="",e.ServiceActivity="",e.Notes="",e.Audio="",e.Camera="",e.Video="",e.Image="",e.Html="",e.SharePointEditDocument="",e.SharePointDeleteDocument="",e.SharePointCheckoutDocument="",e.SharePointCheckinDocument="",e.SharePointEditDocumentProperties="",e.SharePointDiscardCheckoutDocument="",e.SharePointNewDocument="",e.SharePointNewWordDocument="",e.SharePointNewExcelDocument="",e.SharePointNewPowerPointDocument="",e.SharePointNewOneNoteDocument="",e.SharePointUploadDocument="",e.SharePointChangeLocation="",e.SharePointAddDocumentLocation="",e.SharePointEditLocation="",e.SharePointOpenLocation="",e.SharePointOpenDocument="",e.SendByEmail="",e.CreateQuote="",e.Reply="",e.Warning="",e.Play="",e.ExpandButton="",e.AssociatedArticle="",e.DisassociatedArticle="",e.GlobalFilterClearAll="",e.GlobalFilterExpandedRow="",e.GlobalFilterCollapsedRow="",e.RelationshipAssistant="",e.AutomaticSuggestions="",e.SemanticZoom="",e.SemanticZoomMirrored="",e.BackwardButton="",e.MultiSelect="",e.MultiSelectMirrored="",e.Spinning="",e.RetireProduct="",e.AddProduct="",e.OfflineStatus="",e.Abandon="",e.Reactivate="",e.FinishStage="",e.SortButton="",e.Flows="",e.OpenEntityRecord="",e.View="",e.CreateView="",e.EditView="",e.GuestUser="",e.History="",e.SelectButton="",e.SelectButtonRTL="",e.ReassignRecords="",e.ManageRoles="",e.JoinTeams="",e.ChangeManager="",e.AddMembers="",e.RemoveMembers="",e.Download="",e.SetAsDefaultView="",e.Pinned="",e.DistributionList="",e.MergeRecords="",e.AssociateChildCase="",e.SetAsDefault="",e.ConvertKnowledgeArticle="",e.Messenger="",e.AssociateCategory="",e.OfficeWaffle="",e.TripleColumn="",e.Tiles="",e.HideVisualFilter="",e.InteractiveDashboard="",e.Dynamics365="",e.SalesLiterature="",e.LockPricing="",e.CreateInvoice="",e.FulfillOrder="",e.CancelInvoice="",e.ActivateQuote="",e.InvoicePaid="",e.GetProducts="",e.UnlockPricing="",e.Checkbox="",e.CheckboxComposite="",e.RightChevron="",e.LeftChevron="",e.BackToStart="",e.UntrackedEmail="",e.OpenEmail="",e.GlobalFilterCollapsedRowRTL="",e.CancelOrder="",e.URL="",e.Ticker="",e.UseCurrentPricing="",e.Process="",e.FirstPageButton="",e.LinkedInLogo="",e.Health="",e.Family="",e.Sports="",e.Entertainment="",e.OOF="",e.CarouselView="",e.HeartEmpty="",e.HeartFilled="",e.Follow="",e.RunQuery="",e.GroupAnd="",e.GroupOr="",e.Ungroup="",e.HideInSimpleMode="",e.ShowInSimpleMode="",e.PinnedSolid="",e.FilterSolid="",e.Bot="",e.SystemDocumentTemplates="",e.MyDocumentTemplates="",e.ViewAllMyDocumentTemplates="",e.EnableSecurityRoles="",e.DocumentTemplateUpload="",e.DocumentTemplateEdit="",e.DocumentTemplateActivate="",e.DocumentTemplateDeactivate="",e.YammerIcon="",e.StopIcon="",e.ReplaceContentIcon="",e.CloseDateComingSoon="",e.NearbyCustomers="",e.RelevantNews="",e.UpcomingMeeting="",e.RecentMeeting="",e.ReminderWithCall="",e.CardsTask="",e.CardsQuote="",e.CardsOpportunity="",e.CardsInvoice="",e.CardsDashboard="",e.CardsLeads="",e.OpportunityNoActivity="",e.CaseNoActivity="",e.CompetitorMentioned="",e.MeetingRequest="",e.MissedCloseDate="",e.IssueDetection="",e.NoActivityWithAccount="",e.YesNo="",e.AgendaActivityServiceAppointment="",e.AgendaActivityFax="",e.UpcomingFlight="",e.OpportunityAtRiskSentiment="",e.IconDue="",e.AddProductFamily="",e.AddProductBundle="",e.ProductPublish="",e.CloneProduct="",e.CloseGoal="",e.AlignWithFiscalPeriod="",e.ProductUpsell="",e.SubscriptionAdd="",e.RefreshDevice="",e.ScatterChart="",e.BarChartHorizontal="",e.BarChartVertical="",e.FunnelChart="",e.PieDouble="",e.AdvFind="",e.AALinkedInLogo="",e.SendAndClose="",e.DoubleChevronLeft="",e.DoubleChevronRight="",e.AreaChart="",e.DonutChart="",e.TagChart="",e.Teaser="",e.Clone="",e.AreaChartMirrored="",e.BarChartHorizontalMirrored="",e.BarChartVerticalMirrored="",e.Recent="",e.SharePointIcon="",e.OneDriveIcon="",e.FolderSharedIcon="",e.MSTeamsIcon="",e.ScrollUpDown="",e.SendToCTI="",e.Letter="",e.Fax="",e.NewLetter="",e.NewFax="",e.LetterIncoming="",e.LetterOutoing="",e.FaxIncoming="",e.FaxOutgoing="",e.CreatePersonalView="",e.ViewHierarchy="",e.ProductPreview="",e.AddTerritoryMember="",e.RemoveTerritoryMember="",e.Report="",e.NewServiceActivity="",e.Recurrence="",e.EditSeries="",e.EndSeries="",e.EditDefaultFilter="",e.QueueItemDetail="",e.ThumbsUp="",e.ThumbsDown="",e.Lead="",e.TableLink="",e.TableGroup="",e.ClearDefault="",e.SetDefault="",e.SaveFilterToNewPersonalView="",e.SaveFilterToCurrentPersonalView="",e.Expand="",e.ChromeMinimize="",e.ChromeMaximize="",e.ConnectionRoleManageRecordType="",e.Sync="",e.ThumbsUpSolid="",e.ThumbsDownSolid="",e.msdyn_enhancedsla="",e.msdyn_enhancedslakpi="",e.msdyn_enhancedslakipiinstance="",e.CreateOrder="",e.Revise="",e.CloseQuote="",e.CommandChecker="",e.Puzzle="",e.NetworkOffline="",e.MoreVertical="",e.ThunderBolt="",e.Monitor="",e.Error=""}(a||(a={}))},pp6D:function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return F})),n.d(t,"c",(function(){return M})),n.d(t,"e",(function(){return D})),n.d(t,"d",(function(){return R}));var a=n("2yvP"),r=n("jRy5"),i=n("IaGr"),o=n("9ksH"),s=n("tpZ5"),c=n("G0J3"),l=n("COKI"),u=n("uOtn"),d=n("OtHk"),h=n("SAYH"),g=n("Zw8F"),p=n("pnQK"),m=n("0nOn"),b=n("+baL");let f;class y extends g.a{constructor(e,t,n,a){super(e,t,n,a),this._dashboardId=e,f=n,this._clientApiExecutor=new m.a(n,"ClientApi.XrmDashboardSelectorItem.",a)}_getEventParams(){return this._commonEventParams||(this._commonEventParams=[{name:"dashboardId",value:h.a.toString(this._dashboardId),isRequired:!1,isEventParam:!0}])}get isBoundDashboard(){return this._clientApiExecutor.execute("isBoundDashboard_get",()=>{const e=Object(p.a)(f.getState(),this._dashboardId);return!e||1032==+e.Type},this._getEventParams())}get isUserDashboard(){return this._clientApiExecutor.execute("isUserDashboard_get",()=>{const e=Object(p.a)(f.getState(),this._dashboardId);return Object(p.c)(e)},this._getEventParams())}navigate(){this._clientApiExecutor.executeAsync("navigate",()=>f.dispatch(Object(b.a)(null,this._dashboardId,null,null,null,null,this.getPageId())),this._getEventParams())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class C extends u.b{constructor(e,t,n,a,r){let i=d.c;if(a){const t=e.getState(),r=Object(d.g)(t,a);r&&r[n.guid]&&(i=d.g)}super(e,t,n,a,r,i,y)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _ extends l.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i,C)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */let v;class S extends c.a{constructor(e,t,n,a,r,i){super(e,t&&t.etn,a,r,()=>_,n),v=e,this._getCommands=i,this._apiExecutor=new m.a(e,"ClientApi.XrmDashboard.",r,a)}get commands(){return this._apiExecutor.execute("commands_get",()=>this._commands||(this._commands=this._getCommands(v,this.contextToken,this.pageId)))}}var O=n("HAeo"),I=n("zgeC"),j=n("ywwS"),P=n("ghNp"),x=n("i1f0"),E=n("qshH"),w=n("E7fB"),T=n("16wZ"),A=n("T6Zt");function F(e,t,n,a){return k((n,r)=>new S(n,r,new o.b(n,t),e,t,a),"clientapi.create.xrmdashboard","ClientApi.XrmCommandObjectFactory.createXrmDashboard",e,t,n,!1)}function N(e,t,n,a){return k((n,a)=>new s.a(n,a,new o.b(n,t),e,t),"clientapi.create.xrmform","ClientApi.XrmCommandObjectFactory.createXrmForm",e,t,n,!0,a)}function k(e,t,n,r,o,s,c,l){return{type:t,sync:!0,execute(t,u){Object(T.g)(r,n,"contextToken"),Object(T.g)(o,n,"pageId"),c&&Object(T.g)(s,n,"entityTypeName");try{let n=t.dispatch(Object(P.b)(o,r));if(!n){n=e(t,{etn:s,id:l}),n.applicationContext=u;const i=new w.a(t,o);if(n.context=i,!r.parentContextToken){const e=u.ClientApiManager.getClientApiEntry(o);Object(a.b)("form.initialization",()=>{e.xrmInstance.Page=n}),e.primaryContextToken=r}}return n}catch(e){const t=E.a.getInstance().getEventParameters(r);throw t.push({name:"entityTypeName",value:s}),i.a.getInstance().eventManager.ReportComponentFailure(n,e,null,t),e}}}}function M(e,t,n,a,o){const s="ClientApi.XrmCommandObjectFactory.createXrmGrid";return{type:"clientapi.create.xrmgrid",sync:!0,execute(c,l){Object(T.g)(e,s,"contextToken"),Object(T.g)(t,s,"pageId");try{let u=c.dispatch(Object(P.c)(t,e));if(!u){if(3===a){const r=Object(x.s)(c.getState(),{id:t,controlName:o},e.parentContextToken);if(r){const a=c.dispatch(Object(P.b)(t,e.parentContextToken));return new I.a(c,e.parentContextToken,t,o,n,a,r,l)}const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:o}),u.push({name:"gridType",value:a}),i.a.getInstance().eventManager.ReportComponentFailure(s,new Error("Control descriptor could not be found for subgrid control"),null,u)}if(u=new O.a(c,e,t,n,a,!1,l,o),!e.parentContextToken&&e.contextTokenType===r.a.MainGrid){l.ClientApiManager.getClientApiEntry(t).primaryContextToken=e}}return u}catch(t){const n=E.a.getInstance().getEventParameters(e);throw n.push({name:"controlName",value:o}),n.push({name:"gridType",value:a}),i.a.getInstance().eventManager.ReportComponentFailure(s,t,null,n),t}}}}function D(e,t,n,a){const r="ClientApi.XrmCommandObjectFactory.registerNewControl";return{type:"clientapi.create.xrmTimeline",sync:!0,execute(o,s){Object(T.g)(e,r,"contextToken"),Object(T.g)(t,r,"pageId"),Object(T.g)(n,r,"controlName"),Object(T.g)(a,r,"controlId");try{const c=o.dispatch(Object(P.b)(t,e.parentContextToken));let l=null;switch(n){case"notescontrol":if(l=o.dispatch(Object(P.f)(t,e)),!l){const r=Object(x.s)(o.getState(),{id:t,controlName:n},e.parentContextToken);l=new j.a(o,e.parentContextToken,t,r,n,a,c,s)}break;default:const u=E.a.getInstance().getEventParameters(e);u.push({name:"controlName",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(r,new Error("Failed to create and return the control"),null,u)}return l}catch(t){const a=E.a.getInstance().getEventParameters(e);throw a.push({name:"controlName",value:n}),i.a.getInstance().eventManager.ReportComponentFailure(r,t,null,a),t}}}}function R(e,t){const n="ClientApi.XrmCommandObjectFactory.createXrmKBSearch";return{type:"clientapi.create.xrmkbsearch",sync:!0,execute(a,r){Object(T.g)(e,n,"contextToken"),Object(T.g)(t,n,"pageId");try{let n=a.dispatch(Object(P.g)(t,e));if(!n&&(n=new A.a(a,e,t),!e.parentContextToken)){const a=r.ClientApiManager.getClientApiEntry(t);a.xrmInstance.Page=n,a.primaryContextToken=e}return n}catch(t){const a=E.a.getInstance().getEventParameters(e);throw i.a.getInstance().eventManager.ReportComponentFailure(n,t,null,a),t}}}}},qjwL:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="offline.set.reinitializeoffline";function r(e){return{type:a,payload:{reInitializeOffline:e}}}},qkkp:function(e,t,n){"use strict";n.d(t,"y",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"N",(function(){return s})),n.d(t,"E",(function(){return c})),n.d(t,"G",(function(){return l})),n.d(t,"F",(function(){return u})),n.d(t,"L",(function(){return d})),n.d(t,"m",(function(){return h})),n.d(t,"M",(function(){return g})),n.d(t,"O",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"I",(function(){return y})),n.d(t,"c",(function(){return C})),n.d(t,"H",(function(){return _})),n.d(t,"z",(function(){return v})),n.d(t,"r",(function(){return S})),n.d(t,"q",(function(){return O})),n.d(t,"B",(function(){return I})),n.d(t,"C",(function(){return j})),n.d(t,"D",(function(){return P})),n.d(t,"A",(function(){return x})),n.d(t,"J",(function(){return E})),n.d(t,"o",(function(){return w})),n.d(t,"n",(function(){return T})),n.d(t,"p",(function(){return A})),n.d(t,"i",(function(){return F})),n.d(t,"f",(function(){return N})),n.d(t,"k",(function(){return k})),n.d(t,"h",(function(){return M})),n.d(t,"j",(function(){return D})),n.d(t,"g",(function(){return R})),n.d(t,"t",(function(){return L})),n.d(t,"s",(function(){return B})),n.d(t,"u",(function(){return V})),n.d(t,"w",(function(){return G})),n.d(t,"x",(function(){return z})),n.d(t,"v",(function(){return W})),n.d(t,"K",(function(){return X}));var a=n("JhlA");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="Offline_Status_Dialog_Title",i="Button_Label_Close",o="Button_Label_Download_Offline_Metadata",s="Status_Label",c="Learn_More_Label",l="Learn_More_Link_Label",u="Learn_More_Link_Accessibility_Label",d="progress_cancelButton_Label",h="Download_Progress_Spinner_Label",g="MoCA_OWA_Client_Download_Metadata_Message",p="ToggleOption_title",m="Accessibility_Switch_On",b="Accessibility_Switch_Off",f="Available_Entities_Label",y="Not_Available_Entities_Label",C="Available_Entities_Aria_Label",_="Not_Available_Entities_Aria_Label",v="CustomControl_OfflineEntities_InitialDataDownLoadErrorMessage",S="CustomControl_OfflineEntities_EstimatedTimeLeftLabel",O="Entity_Header_Label",I="Last_Sync_Date_Label",j="Last_Sync_Date_Today_Label",P="Last_Sync_Date_Yesterday_Label",x="Last_Sync_Date_At_Label",E="OutlookClient_Progress",w="D365_UCI_OfflineStatus_Suspended_Label_Text",T="D365_UCI_OfflineStatus_Pending_Label_Text",A="D365_UCI_OfflineStatus_Waiting_Label_Text",F="D365_UCI_OfflineStatus_Insufficient_Storage_Label_Text",N="D365_UCI_OfflineStatus_Storage_Issue_Error_Text",k="D365_UCI_OfflineStatus_Service_Error_Label_Text",M="D365_UCI_OfflineStatus_Something_Went_Wrong_Error_Text",D="D365_UCI_OfflineStatus_Network_Connectivity_Label_Text",R="D365_UCI_OfflineStatus_Network_Issue_Error_Text",L="D365_UCI_OfflineStatus_Files_Downloading_Count_Label_Text",B="D365_UCI_OfflineStatus_Availabe_Files_Label_Text",V="D365_UCI_OfflineStatus_Completed_Label_Text",G="D365_UCI_OfflineStatus_Error_Label_Text",z="D365_UCI_OfflineStatus_Update_Offline_Data_Button_Text",W="D365_UCI_OfflineStatus_Downloading_Label_Text",X=[r,i,s,c,l,p,m,b,a.f,a.d,d,h,g,o,f,y,C,_,v,S,O,I,j,P,x,E,"SystemCustomization.type.file.label",w,T,A,F,N,k,M,D,R,L,B,"D365_UCI_OfflineStatus_Progress_Label_Text","D365_UCI_OfflineStatus_Status_Label_Text",V,G,z,"D365_UCI_OfflineStatus_Offline_Data_Ready_To_Use_Syncing_Now_Text","D365_UCI_OfflineStatus_Offline_File_Ready_To_Use_Text",W]},"r/aD":function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return g}));var a=n("i1f0"),r=n("arV0"),i=n("PUjk"),o=n("IaGr"),s=n("2Ct/"),c=n("odYE"),l=n("g6bs");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,n,i=!1){if(!e)return o.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null state object"),!1;if(!t)return o.a.getInstance().traceManager.getTracer(n).error("isXrmProcessControlClientApiSupportedOnForm invoked with unexpected null pageId object"),!1;const u=function(e,t){const n=Object(r.g)(e,t);if(!n)return null;const{entityTypeName:a,id:i}=n;return new c.a(a,i)}(e,t),d=!Object(a.Kb)(e,t)&&(Object(s.d)(e)||!Object(s.g)(e))&&(i||!Object(l.d)(e,u,t)),h=p(t,e);return h.push({name:"xrmProcessControlClientApiIsSupported",value:d}),o.a.getInstance().eventManager.ReportComponentSuccess(n,h),d}function d(e,t,n,a){if(!e&&(o.a.getInstance().traceManager.getTracer(a).error("getProcessManagerWithJitInitIfNeeded invoked with unexpected null processManager",p(n,t.getState())),u(t.getState(),n,a))){o.a.getInstance().traceManager.getTracer(a).error("getProcessManagerWithJitInitIfNeeded invoking JIT initialization of process manager",p(n,t.getState()));const e=Object(r.g)(t.getState(),n);return Object(i.b)(n,e)}return e}function h(e,t,n,a){return[{name:"pageId",value:e},{name:"formType",value:Object(r.l)(t,e)},{name:"InitialXrmProcessControlIsNotNull",value:n},{name:"XrmEntityIsNotNull",value:a}]}function g(e,t,n){return[{name:"pageId",value:e},{name:"formType",value:Object(r.l)(t,e)},{name:"getProcessManagerInvoked",value:n}]}function p(e,t){return[{name:"pageId",value:e},{name:"formType",value:Object(r.l)(t,e)}]}},rrts:function(e,t,n){"use strict";n.r(t),n.d(t,"openOfflineStatusDialogAction",(function(){return _}));var a=n("Lyxw"),r=n("qkkp"),i=n("EY5k"),o=n("pEXn"),s=n("uAcA"),c=n("ruPX");var l=n("sZ+8"),u=n("lEp6"),d=n("YxC/"),h=n("69Qu"),g=n("smSa"),p=n("zu1I"),m=n("3/02"),b=n("37s6"),f=n("RADj"),y=n("ff1s"),C=n("17x/");function _(e=!1){return{type:"Offline Status Dialog",execute:async({dispatch:t,getState:n},_)=>{const v=["L_Offline_Available","L_Offline_Not_Available","L_Initializing","L_OfflineProfile_Not_Available","L_Offline_DB_Not_Available","L_Sync_Failure","L_Upgrade_Client","L_Metadata_Changed_Text","L_Metadata_Changed",...r.K];return await t(Object(i.e)(v)),e||Object(a.c)(n(),m.je)||Object(C.h)(n())?function(e,t,n){const a={shouldSupportRTL:!0},r=t(),i=[{name:o.b.OfflineStatusPageParameters.OfflineStatus,value:Object(b.t)(r)}];return e(function(e,t,n){const a=[{name:"dialogName",value:e},{name:"dialogHeight",value:t.height},{name:"dialogWidth",value:t.width},{name:"dialogPosition",value:t.position},{name:"dialogWindowPosition",value:t.windowPosition}];return{type:"form.offlineStatusForm",execute({dispatch:e,getState:a},r,i){const o={dialogOptions:t};return e(Object(c.a)(s.a,o,n))},getFailureParameters:(e,t)=>a}}("OfflineStatus",a)).then(()=>{n.EventManager.ReportComponentSuccess("Offline.OpenOfflineStatusDialog",i)})}(t,n,_):function(e,t,n){n.TraceManager.getTracer("Offline").warn("Open OfflineStatusDialog");const a="Offline.OpenOfflineStatusDialog",r=t(),i=Object(b.t)(r),s=Object(b.s)(r),c=Object(l.g)(r),m=Object(l.i)(r),C=c?Object.keys(c):[],_=m||[],v={},S={};for(const e of C){const t=c[e];-1===_.indexOf(e)?v[e]=t:S[e]=t}const O={};O.offline_status=i?i.toString():"",O.offlinestatus_reason=s,O.offline_enabled_json_string=Object(u.b)({OfflineEntities:[v]}),O.offline_disabled_json_string=Object(u.b)({OfflineEntities:[S]}),O.offline_enable_string=Object(d.b)(r,"L_Offline_Available"),O.offline_disable_string=Object(d.b)(r,"L_Offline_Not_Available"),O.offlinemetadata_sync=Object(h.b)(r)&&f.a.SyncPendingFromServer===Object(g.c)(r)?"true":"false";const I=[{name:o.b.OfflineStatusPageParameters.CodeCacheState,value:Object(y.a)(r)},{name:o.b.OfflineStatusPageParameters.OfflineStatus,value:O.offline_status},{name:o.b.OfflineStatusPageParameters.OfflineStatusReason,value:O.offlinestatus_reason},{name:o.b.OfflineStatusPageParameters.OfflineEnabledEntities,value:Object(u.b)(v)},{name:o.b.OfflineStatusPageParameters.OfflineDisabledEntities,value:Object(u.b)(S)},{name:o.b.OfflineStatusPageParameters.OfflineMetadataDownloadRequired,value:O.offlinemetadata_sync}],j={windowPosition:"side"};return e(Object(p.b)("OfflineStatus",j,O)).then(()=>{n.EventManager.ReportComponentSuccess(a,I)})}(t,n,_)}}}},rs6x:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n("SAYH"),r=n("arV0"),i=n("ruPX"),o=n("kX6F"),s=n("Nb1E"),c=n("odYE"),l=n("iZ7K"),u=n("504W"),d=n("lEFU"),h=n("IqkD"),g=n("69Qu"),p=n("i1f0"),m=n("E8F2");function b(e,t,n,c){const b=[{name:"formId",value:e},{name:"pageName",value:n}];return{type:"form.change",execute({dispatch:y,getState:C},_,v){const S=C();if(Object(p.Eb)(S,t))return Promise.reject(Object(m.b)(S,t,2200000016));const{entityTypeName:O,id:I,recordSetQueryKey:j,data:P,createFromRelationship:x,initWithEntity:E}=Object(r.g)(S,t);b.push({name:"entityTypeName",value:O});const w=a.a.tryParse(e),T={entityTypeName:O,formId:w,id:c?a.a.tryParse(c):I,recordSetQueryKey:j,data:P,createFromRelationship:x,initWithEntity:E},A=w.guid.toString(),F=`<MRUForm><Form Type="Main" Id="${A}" /></MRUForm>`,N=Object(d.c)(S,O);return y(Object(i.a)(n,T,t,{replaceState:!0})).then(e=>{var t,n;if(0===e.status)if(Object(g.b)(C()))null==N||N===a.a.EMPTY?function(e,t,n,r,i,c,d,g){const p=Object(l.p)(r,e),m=Object(h.q)(r),b="?$select=userentityuisettingsid&$filter=objecttypecode eq {0} and _ownerid_value eq '{1}'&$top=1",y=String.format(b,p.toString(),m.guid.toString());i(Object(s.e)("userentityuisettings",y)).then(h=>{h.value&&h.value.length>0&&(n=h.value[0].userentityuisettingsid?new a.a(h.value[0].userentityuisettingsid):a.a.EMPTY),Object(u.a)(n)||Object(u.a)(c)||Object(u.a)(e)||0===e.length||a.a.isNullOrEmpty(n)?null!=n&&n!==a.a.EMPTY||function(e,t,n,r,i,c,d){let h=a.a.EMPTY;const g=Object(l.p)(n,e),p="userentityuisettings";r(Object(s.b)(p,{objecttypecode:g,lastviewedformxml:t})).then(t=>{if(h=t,!(Object(u.a)(h)||Object(u.a)(i)||Object(u.a)(e)||0===e.length||a.a.isNullOrEmpty(h))){const t=d.TraceManager.getTracer("Forms.FormSelectorChange"),n="Created an entry for selected form successfully formid : "+i;t.info(n),r(Object(o.b)(e,i,h))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(i)||Object(u.a)(e)||0===e.length||r(Object(o.b)(e,i,h)),{};const n=[{name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],a="Catch block of ChangeForm.oDataCreate, for formid: "+i;d.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(a),void 0,n),d.TraceManager.getTracer("Forms.FormSelectorChange").error(a,n)})}(e,t,r,i,c,d,g):f(e,t,n,r,i,c,d,g)}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(c)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,c,n)),{};const a=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],r="Catch block of ChangeForm.oDataRetrieve, for formid: "+c;g.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,a),g.TraceManager.getTracer("Forms.FormSelectorChange").error(r,a)})}(O,F,N,C(),y,w,v,_):f(O,F,N,C(),y,w,v,_);else{Object(u.a)(w)||Object(u.a)(O)||0===O.length||y(Object(o.b)(O,w,N));const e=null===(t=null==_?void 0:_.TraceManager)||void 0===t?void 0:t.getTracer("Forms.FormSelectorChange"),n="Selected form did not save in the UserEntityUiSetting table, for formid: "+w;null==e||e.info(n)}else if(1===e.status){const e=null===(n=null==_?void 0:_.TraceManager)||void 0===n?void 0:n.getTracer("Forms.FormSelectorChange"),t=`Could not change to form with id ${A} due to a navigation failure or because navigation was cancelled`;null==e||e.info(t,b)}return e})},getFailureParameters:(e,t)=>b}}function f(e,t,n,r,i,l,d,h){const g=new c.a("userentityuisettings",n);i(Object(s.f)(g,{lastviewedformxml:t})).then(()=>{if(!(Object(u.a)(n)||Object(u.a)(l)||Object(u.a)(e)||0===e.length||a.a.isNullOrEmpty(n))){const t=h.TraceManager.getTracer("Forms.FormSelectorChange"),a="Updated selected form successfully to : "+l;t.info(a),i(Object(o.b)(e,l,n))}}).catch(t=>{if(-2147093999===t.errorCode)return Object(u.a)(l)||Object(u.a)(e)||0===e.length||i(Object(o.b)(e,l,n)),{};const a=[{name:"CorrelationId",value:d.correlationId},{name:"ContextId",value:d.contextId},{name:"ActionStack",value:d.stack},{name:"entityName",value:e},{name:"reason",value:t&&t.message?t.message:JSON.stringify(t)}],r="Catch block of ChangeForm.oDataUpdate, for formid: "+l;h.EventManager.ReportComponentFailure("Forms.FormSelectorChange",Error(r),void 0,a),h.TraceManager.getTracer("Forms.FormSelectorChange").error(r,a)})}},"s+OO":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var a=n("dHD5"),r=n("BFlg");const i="chart.filterexpression.update",o="ChartFilterExpression";function s(e,t,n){return{type:"chart.filterexpression.update.async",execute({dispatch:s,getState:c},l){const u=l.TraceManager.getTracer(r.z),d=r.x+".updateFilterExpressionAction";try{u.info("Updating the chart filter expression"),t||(t=Object(a.k)(c(),e));const r=Object(a.v)(t);return s(function(e,t,n){return{type:i,payload:{name:o,value:n},meta:{pageId:e,dataSetContextKey:t}}}(e,r,n)),l.EventManager.ReportComponentSuccess(d),Promise.resolve()}catch(e){const t="Updatation of the chart filter expression failed with error : "+e.message;l.EventManager.ReportComponentFailure(d,Error(t))}}}}},sn0j:function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var a=n("SAYH"),r=n("Lohl"),i=n("y60j"),o=n("LbMF"),s=n("FZDd"),c=n("3hnk"),l=n("j6Db"),u=n("qLnS");const d=["activitytypecode","prioritycode","scheduledend","subject","description","regardingobjectid","ownerid","createdon","statecode","modifiedon"];function h(e,t,n){return{type:"formandattribute.retrieve.async",execute({dispatch:c,getState:u},h){const m="Card"===n;return e.etn&&"activitypointer"===e.etn&&m?c(Object(s.f)("activitypointer",!1,d)).then(()=>{const t=u(),n={};for(const a of d){const r=Object(o.a)(t,e.etn,a);r&&g(t,e.etn,a,r)&&(n[a]=r)}return p(t,e.etn,n,Object(o.d)(t,e.etn)),{formDescriptor:null,attributeDescriptors:n}}):c(Object(r.b)(e,t,n)).then(r=>{const d={};let b=null;return e.etn?c(Object(s.f)(e.etn,!0,[])).then(()=>{const t=u();if(!a.a.isNullOrEmpty(r)&&(b=Object(i.j)(t,r),b&&b.Attributes))for(const n in b.Attributes){const a=b.Attributes[n],r=Object(o.a)(t,e.etn,a);r&&g(t,e.etn,a,r)&&(d[a]=r)}return m&&p(t,e.etn,d,Object(o.d)(t,e.etn)),{formDescriptor:b,attributeDescriptors:d}}):(h.EventManager.ReportComponentSuccess("Form.CustomControl.retrieveFormWithAttributes",[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:a.a.toString(t)},{name:"formType",value:n}]),null)},e=>{const r=e.get_message();h.EventManager.ReportComponentFailure("Form.CustomControl.retrieveFormWithAttributes",new Error(r),r,[{name:"APIName",value:l.a+".Actions.RetrieveFormWithAttributesAction"},{name:"formId",value:a.a.toString(t)},{name:"formType",value:n}])})}}}function g(e,t,n,a){return Object(c.f)(e,t,n,u.a.CanRead)&&a&&a.IsValidForRead}function p(e,t,n,a){if(a)for(const r in a){const i=a[r];!i.IsSortableEnabled&&"modifiedon"!==i.LogicalName||n[r]||!g(e,t,i.LogicalName,i)||"image"===i.Type||"multiselectpicklist"===i.Type||(n[r]=i)}}},sxfa:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("WRDA"),r=n("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class i{constructor(e){this.path=e}get path(){return this._traversedPath}set path(e){for(this._traversedPath=Object(a.a)(e);this._traversedPath&&this._traversedPath.indexOf("}")>0;)this._traversedPath=Object(a.a)(this._traversedPath)}static getCandidateTraversedPathFromStagStep(e,t){t=Object(a.a)(t);let n=!1;if(!e||e.length)return null;for(let r=0;r<e.length;r++){const i=Object(a.a)(e[r].get_stageId());if("".concat(i,","),t===i){n=!0;break}}return n?"".substring(0,"".length-2):null}isInTraversedPath(e){return!Object(r.b)(e)&&this._traversedPath.indexOf(Object(a.a)(e))>-1}}},tpZ5:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n("0nOn"),r=n("OQLa"),i=n("arV0"),o=n("UqyN"),s=n("L8zx"),c=n("ZIjf"),l=n("3yqi"),u=n("EOIL"),d=n("i1f0"),h=n("Bo7t"),g=n("Tg1Y"),p=n("16wZ"),m=n("qshH");let b;class f extends u.a{constructor(e,t,n,a,r,i){super(e,t,n,a,r,i),b=e}getDefaultNextPageName(){const e="ClientApi.XrmNavigableFormUi.getDefaultNextPageName";try{c.a.instance.reportCall(e);const t=Object(d.M)(b.getState(),this.pageId,this.contextToken);return c.a.instance.reportSuccess(e),t}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}}movePrevious(){const e="ClientApi.XrmNavigableFormUi.movePrevious";try{c.a.instance.reportCall(e),b.dispatch(Object(g.b)(this.pageId,this.contextToken)),c.a.instance.reportSuccess(e)}catch(t){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(e,t,null,n),t}}moveTo(e){const t="ClientApi.XrmNavigableFormUi.moveTo";let n;try{if(c.a.instance.reportCall(t),e&&this.tabs){const t=Object(d.Gc)(b.getState(),this.pageId,e,this.contextToken);n=this.tabs.get(null==t?void 0:t.Name),n&&b.dispatch(Object(h.b)(this.pageId,this.contextToken,null==t?void 0:t.Id))}c.a.instance.reportSuccess(t)}catch(e){const n=m.a.getInstance().getEventParameters(this.contextToken);throw m.a.getInstance().reportFailure(t,e,null,n),e}n||Object(p.h)(t,"pageName",e)}get taskProcess(){return c.a.instance.reportUsage("ClientApi.XrmNavigableFormUi.taskProcess"),this}}var y=n("SAYH"),C=n("n6Qt"),_=n("deGN"),v=n("G0J3"),S=n("504W");let O;class I extends v.a{constructor(e,t,n,r,i){super(e,t&&t.etn,r,i,e=>10===e||12===e?f:u.a,n);const o=[{name:"pageId",value:i,isRequired:!0,isEventParam:!0,expectedDataType:"string"}];this._clientApiExecutorForm=new a.a(e,"ClientApi.XrmForm.",i,r,o),O=e,this._entityReference=t}get applicationContext(){return this._applicationContext}set applicationContext(e){this._applicationContext=e}get context(){try{return c.a.instance.reportCall("ClientApi.XrmForm.context"),c.a.instance.reportSuccess("ClientApi.XrmForm.context"),this._globalContext}catch(e){throw this._reportFailure("ClientApi.XrmForm.context",e)}}set context(e){this._globalContext=e}get entityReference(){return this._clientApiExecutorForm.execute("entityReference_get",()=>({id:y.a.externalGuid(this._entityReference.id),entityType:this._entityReference.etn}))}get data(){try{if(c.a.instance.reportCall("ClientApi.XrmForm.data"),!this._data){let e;const t=Object(i.l)(O.getState(),this.pageId);t!==l.a.Dialog&&t!==l.a.ModalDialog&&this._entityReference&&(e=new o.a(O,this.contextToken,this.pageId,this,this._entityReference.etn,this._entityReference.id,j,this._applicationContext)),this._data=new s.a(O,this.contextToken,this.pageId,this,e)}return c.a.instance.reportSuccess("ClientApi.XrmForm.data"),this._data}catch(e){throw this._reportFailure("ClientApi.XrmForm.data",e)}}getAttribute(e){return this._clientApiExecutorForm.execute("getAttribute",()=>{var t,n;let a=null;return this.data&&this.data.entity&&(a=this.data.entity.attributes.get(e)),a?Object(S.a)(e)&&(a=a.concat(this.data.attributes.get(e))):a=null===(n=null===(t=this.data)||void 0===t?void 0:t.attributes)||void 0===n?void 0:n.get(e),a})}getUrl(e){try{c.a.instance.reportCall("ClientApi.XrmForm.getUrl");let t=null,n=null;if(this.contextToken.parentContextToken){const e=this.data.entity.getEntityReference(),a={entityTypeName:e.entityType,etn:e.name,id:y.a.fromExternalGuid(e.id)};t=l.a.EditForm,n=a}else t=Object(i.l)(O.getState(),this.pageId),n=Object(i.g)(O.getState(),this.pageId);switch(t){case l.a.EditForm:{const e=new C.a(O,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,etn:n.etn,id:n.id,entityTypeCode:e.getEntityCode(n.entityTypeName),languageId:this._globalContext.userSettings.languageId,recordSetQueryKey:n.recordSetQueryKey};break}case l.a.Grid:{const e=new C.a(O,this.applicationContext,this.context,this.pageId);n={entityTypeName:n.entityTypeName,pageType:n.pageType,entityTypeCode:e.getEntityCode(n.entityTypeName)};break}}let a=null;if(1===e)a=O.dispatch(Object(r.a)(t,n));else{const e=Object(_.a)(O,this.pageId);a=O.dispatch(Object(r.c)(e,t,n))}return c.a.instance.reportSuccess("ClientApi.XrmForm.getUrl"),a}catch(e){throw this._reportFailure("ClientApi.XrmForm.getUrl",e)}}_reportFailure(e,t){const n=m.a.getInstance().getEventParameters(this.contextToken);return n.push({name:"entityName",value:this._entityReference.etn}),m.a.getInstance().reportFailure(e,t,null,n),t}}function j(e,t,n){const a=Object(d.bb)(O.getState(),n,t);return a||e.TraceManager.getTracer("ClientApi.XrmForm.getAttributeNames").error("Form attributes was null"),a}},tvJg:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="attribute.options.clear";function i(e,t,n){const i=Object(a.x)(t);return{type:r,payload:void 0,meta:{pageId:e,contextKey:i,dataFieldName:n}}}},uMsf:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("fWyz"),r=n("2FbK"),i=n("RiEM");function o(e,t){return{type:"Navigate to sitemap area",execute(n,o){const c=Object(r.b)(n.getState()),l=e&&function(e,t){if(!t||!e||!e.AreaIds)return null;const n=e.Areas[t];for(const e of n.GroupIds){const t=n.Groups[e];for(const e of t.SubAreaIds){const n=t.SubAreas[e];if(!Object(i.f)(n)&&s(n))return n}}return null}(c,e);if(l)return n.dispatch(Object(a.c)(l,!1,null,t))}}}function s(e){return!e.Url||!e.Url.toLowerCase().endsWith("msdyn_launchdesigner.html")}},uOtn:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var a=n("Sbn7"),r=n("Zw8F"),i=n("y60j"),o=n("SAYH"),s=n("0nOn");let c;class l{constructor(e,t,n,a,o,l=i.n,u=r.a){this._formId=n,c=e,this._entityName=a,this._pageId=o,this._getSelectorItems=l,this._selectorItemType=u,this._clientApiExecutor=new s.a(e,"ClientApi.XrmControlFormSelector.",o,t)}get items(){return this._clientApiExecutor.execute("items_get",e=>{if(!this._items){this._items=new a.a(e);const t=this._getSelectorItems(c.getState(),this._entityName);if(t)for(const e in t){const n=t[e],a=n.name||n.DisplayName,r=new this._selectorItemType(new o.a(e),a,c,this._pageId);this._items.add(r.getId(),r)}}return this._items})}getCurrentItem(){return this._clientApiExecutor.execute("getCurrentItem",()=>{const e=this.items;for(let t=0;t<e.getLength();t++){const n=e.get(t);if(n.getId()===o.a.toString(this._formId))return n}return null})}}class u extends l{}},ujVH:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n("dHD5"),r=n("BFlg"),i=n("P6DH"),o=n("3hnk"),s=n("kWiz"),c=n("WePp"),l=n("qLnS");const u="dataset.dependentoptionset.column.status";function d(e,t){const n=[];return{type:"dependentoptionset.column.status",sync:!0,execute({dispatch:o,getState:l},d,m){const b=d.TraceManager.getTracer(r.z),f=r.x+".SetDependentOptionSetColumnStatusAction";d.TraceManager.setLogLevel(s.a.Info,f);try{const r=Object(a.v)(t),s=l();let y=null;const C=Object(i.Q)(l(),e,t),_={};if(C)y=C;else{const n=Object(i.S)(l(),{id:e},t);n&&n.entityLogicalName&&(y=n.entityLogicalName)}if(y){n.push({name:"CorrelationId",value:m.correlationId},{name:"ContextId",value:m.contextId},{name:"ActionStack",value:m.stack},{name:"PageId",value:e},{name:"EntityTypeName",value:y}),b.info("Executing initialize dependent option set column status action in grid.",n);const a={name:"NumPartialDependentOptionSetChainAttributesInGrid",value:0},r=[];let o=0;const l=Object(i.z)(s,t,y,e);for(const n in l){const i=l[n];if(null===i.ParentPicklistLogicalName){const i={name:n,value:0};h(s,t,e,y,l,n,i)?g(l,n,_,a):(p(l,n,_),o++,r.push(i))}else void 0===l[i.ParentPicklistLogicalName]&&g(l,n,_,a)}const u={name:"NumCompleteDependentOptionSetChainsInGrid",value:o},C={name:"CompleteChainsMaxDepthInGrid",value:r};n.push(u,a,C);const v=new c.a(f);v.addEventParameter("NumCompleteDependentOptionSetChainsInGrid",o),v.addEventParameter("NumPartialDependentOptionSetChainAttributesInGrid",a.value),v.addEventParameter("CompleteChainsMaxDepthInGrid",r),d.EventManager.ReportEvent(v),d.EventManager.ReportComponentSuccess(f),b.info("Executed initialize dependent option set column status action successfully.",n)}Object.keys(_).length>0&&o(function(e,t,n){return{type:u,payload:n,meta:{pageId:e,dataSetContextKey:t}}}(e,r,_))}catch(e){const t="creating dependent option set column status node in state tree failed.";d.EventManager.ReportComponentFailure(f,Error(t))}}}}function h(e,t,n,a,r,i,s){if(void 0===r[i])return!0;if(function(e,t,n,a,r){if(!Object(o.f)(e,r,a,l.a.CanUpdate)||!n[a].IsValidForUpdate)return!0;return!1}(e,0,r,i,a))return!0;const c=r[i].ChildPicklistLogicalNames;if(null!==c)for(let o=0;o<c.length;o++){const l={name:i,value:0};if(h(e,t,n,a,r,c[o],l))return!0;s.value=Math.max(s.value,l.value)}return s.value=s.value+1,!1}function g(e,t,n,a){if(void 0===e[t])return;n[t]=0,a.value=a.value+1;const r=e[t].ChildPicklistLogicalNames;if(r)for(let t=0;t<r.length;t++)g(e,r[t],n,a)}function p(e,t,n){n[t]=1;const a=e[t].ChildPicklistLogicalNames;if(a)for(let t=0;t<a.length;t++)p(e,a[t],n)}},v77L:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="areaSwitcherModal",r="recentsListModal",i="profileModal",o="pinnedListModal",s="settingsModal"},"wBG+":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("i1f0"),r=n("RrRQ"),i=n("dHD5");function o(e){return{type:"form.cancel.async",execute({dispatch:t,getState:n}){const o=Object(i.j)(n(),e),s=Object(a.ac)(n(),e,o);return t(Object(r.c)(e,s,o)),Promise.resolve()}}}},wje5:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("/D1P");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="offline.upsync.start";function i(){const e={upSyncStatus:a.a.InProgress};return{type:r,payload:e}}},xorU:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="controls.addCustomFilter",i="controls.startCustomFilter",o="controls.endCustomFilter";function s(e,t,n,i,o){const s=Object(a.v)(i);return{type:r,payload:{customFilter:o,entityLogicalName:n},meta:{pageId:e,controlName:t,contextKey:s}}}function c(e,t,n){const r=Object(a.v)(n);return{type:i,payload:{},meta:{pageId:e,controlName:t,contextKey:r}}}function l(e,t,n){const r=Object(a.v)(n);return{type:o,payload:{},meta:{pageId:e,controlName:t,contextKey:r}}}},yl9a:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=n("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const r="control.setSrc";function i(e,t,n,i){const o=Object(a.v)(n);return{type:r,payload:{Url:i,isCustomSrc:!0},meta:{pageId:e,controlName:t,contextKey:o}}}},yq1L:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return k}));var a=n("arV0"),r=n("EY5k"),i=n("OWbt"),o=n("XVX7"),s=n("33Bq"),c=n("dHD5"),l=n("MktZ"),u=n("f/sd"),d=n("y60j"),h=n("8nT0"),g=n("ZFRl"),p=n("Or4W"),m=n("O7zD"),b=n("lY/Z"),f=n("SAYH"),y=n("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function C(e,t,n,a,r){!function(e,t,n){const a=Object(y.h)(e,t);a&&n.push({name:"IsCustomEntity",value:a.IsCustomEntity},{name:"IsActivityEntity",value:a.IsActivity})}(e,a,r),function(e,t,n,a){const r=Object(d.d)(e,n,t);if(r){const e=Object.keys(r);a.push({name:"NumControls",value:e.length})}}(e,t,n,r)}var _=n("Uv1Y"),v=n("E8F2"),S=n("pp6D"),O=n("i1f0"),I=n("Bo7t"),j=n("TBkx"),P=n("ldGr"),x=n("3/02"),E=n("Lyxw"),w=n("zmL5"),T=n("g6bs"),A=n("XVSa"),F=n("wL2W");function N(e,t){return n=>M(e,t,n,"initialize.quickCreateFormAction.async")}function k(e,t){return M(e,t,null,"initialize.quickCreateFormActionsaveandnew.async")}function M(e,t,n,y){const N=[{name:"RemoveScriptContainer",value:t}];return{type:y,execute({dispatch:k,getState:M},D,R){const L=M(),B=Object(a.g)(L,e),{entityTypeName:V,formId:G,id:z}=B,W=D.TraceManager.getTracer("Forms.QuickCreate.InitializeAction");N.push({name:"CorrelationId",value:R.correlationId},{name:"ContextId",value:R.contextId},{name:"ActionStack",value:R.stack},{name:"InitialFormId",value:f.a.toString(G)},{name:"EntityName",value:V},{name:"PageId",value:e},{name:"updatedFormId",value:f.a.toString(n&&n.updatedFormId)}),W.info("_initializeAction started.",N);const X=Object(c.j)(L,e);if(t){D.ScriptManager.removeContainer(e,!0)}const H=function(e,t,n,a,r,i,o){if(o){const e=Object(w.b)(r,i);return a.push({name:"skippedPreInitCodePath",value:o},{name:"newFormId",value:f.a.toString(e)}),e}if(a.push({name:"preInitResult",value:JSON.stringify(e)}),!e){const e="PreInitResult during QuickCreateForm is invalid for entity '"+t+"'";throw n.error(e,a),new _.a(e)}if(e.error)throw e.error;const s=e.updatedFormId;if(!s||f.a.equals(s,f.a.EMPTY)){const e="Form descriptor is null or not defined";throw n.error(e,a),new _.a(e)}return a.push({name:"newFormId",value:f.a.toString(s)}),s}(n,V,W,N,L,e,"initialize.quickCreateFormActionsaveandnew.async"===y);W.info("parallelizablePromises started.",N);return function(e,t,n,a,o,c,l,u,d,h,g,m){g.info("retrieveResourceStrings started.",m);const b=e(Object(r.e)(s.d)).then(()=>{g&&(m.push({name:"RetrievedResourceStringsTimeStamp",value:Date.now()}),g.info("retrieveResourceStrings completed.",m))}).catch(e=>{m.push({name:"loadResourceStringsPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)});g&&g.info("initializeContainerForClientApi started.",m);const f=u.ScriptManager.initializeContainerForClientApi(a).then(()=>{g&&g.info("initializeContainerForClientApi completed.",m),e(Object(S.b)(n,a,h,o))}).catch(e=>{m.push({name:"initializeClientApiContainerPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)});g&&g.info("checkEntityEnabledForUCI started.",m);const y=Object(i.e)(t,e,g,l,o,h,a).then(()=>{g&&g.info("checkEntityEnabledForUCI completed.",m)}).catch(e=>{m.push({name:"checkEntityEnabledForUCIPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)});g&&g.info("loadFormDependencies started.",m);const C=e(Object(p.c)(c,h)).then(()=>{g&&g.info("loadFormDependencies completed.",m)}).catch(e=>{m.push({name:"loadFormDependencies.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}),v=Object(T.c)(t(),e,u,h,g,m);return Promise.all([b,f,y,C,v])}(k,M,X,e,z,H,R,D,0,V,W,N).then(()=>(W.info("parallelizablePromises completed.",N),k(Object(i.h)(H,e,X)).then(()=>{const t=Object(d.j)(M(),H),n=Object(O.N)(M(),H);k(Object(I.b)(e,X,n)),W.info("retrieveRecordDataForOrganization started.",N);return k(Object(b.f)(t.FormLibraries)).then(()=>{W.info("retrieveRecordDataForOrganization completed.",N),k(Object(o.a)(!0,e,X))}).then(()=>{const n=[h.q,h.u,h.v,h.w];Object(i.c)(M(),k,V,e,n,t.Attributes,X,W,N)}).then(()=>(Object(E.c)(M(),x.L)&&k(Object(P.c)(V,e,X)),Object(E.c)(M(),x.nd)&&k(Object(l.b)(e,u.a.OnLoadReady)),Object(i.i)(M(),D,k,H,X,e,W,N))).catch(e=>{N.push({name:"retrieveRecordDataForOrganization.Reason",value:Object(j.e)(e)}),Object(_.b)(e)})}).catch(e=>{N.push({name:"initializeForm.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}))).catch(e=>{N.push({name:"initializeActionPromise.Reason",value:Object(j.e)(e)}),Object(_.b)(e)}).then(()=>{C(M(),e,G,V,N),D.EventManager.ReportComponentSuccess("Forms.QuickCreate.InitializeAction",N),W.info("_initializeAction completed.",N),k(Object(l.b)(e,u.a.FullLoad));const t=Object(m.c)(e,V,M(),X);t&&k(Object(g.c)(e,t)),function(e,t,n,a){Object(F.a)()&&e(Object(A.a)(t,n,a))}(k,e,X,V)}).catch(t=>{C(M(),e,G,V,N),Object(v.h)(M(),e,t,N,D,"Forms.QuickCreate.InitializeAction"),Object(_.b)(t)})},getFailureParameters:(e,t)=>(Object(v.a)(e,N),N)}}},ywwS:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n("0nOn"),r=n("P6DH"),i=n("HcnX"),o=n("AbXy"),s=n("FETf"),c=n("LE5i"),l=n("16wZ"),u=n("NAAR"),d=n("qshH"),h=n("HAeo"),g=n("ghNp"),p=n("dHD5"),m=n("ZIjf"),b=n("FZDd"),f=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlTimeline.";let C;class _ extends i.a{constructor(e,t,n,r,i,o,s,c){super(e,t,n,r,i,s),this._defaultLabel=u.u.Timeline,C=e,this._applicationContext=c,this._controlId=o,this._traceManager=c.TraceManager,this._subgridToken=Object(p.p)(t,i),this._clientApiExecutorTimeline=new a.a(e,y,n,t),this._clientApiExecutorTimeline.addEventParameter({name:"controlName",value:i,isEventParam:!0,expectedDataType:"string"}),this._clientApiExecutorTimeline.addEventParameter({name:"controlId",value:o,isEventParam:!0,expectedDataType:"string"}),this._gridControl=new h.a(e,this._subgridToken,n,!1,3,!0,c,i),e.dispatch(Object(g.a)(this,n,this._subgridToken))}getControlType(){return m.a.instance.reportUsage(y+"getControlType"),"timelinewall"}getName(){return this.clientApiExecutor.execute("getName",()=>this.controlDescriptor&&this.controlDescriptor.Parameters&&this.controlDescriptor.Parameters[u.s.UClientUniqueName]?this.controlDescriptor.Parameters[u.s.UClientUniqueName]:u.u.Timeline)}getLabel(){const e=y+"getLabel";try{m.a.instance.reportCall(e);const t=this.controlDescriptor&&this.controlDescriptor.Parameters&&!Object(l.a)(this.controlDescriptor.Parameters[u.s.Label])?this.controlDescriptor.Parameters[u.s.Label]:this._defaultLabel?this._defaultLabel:"";return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}setLabel(e){const t=y+"setLabel";try{m.a.instance.reportCall(t),super.setLabel(e),this.controlDescriptor&&this.controlDescriptor.Parameters?this.controlDescriptor.Parameters[u.s.Label]=e:this._defaultLabel=e,m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}openEmail(e){const t=y+"openEmail";try{m.a.instance.reportCall(t),C.dispatch(Object(s.t)(this._controlId,e)),C.dispatch(Object(s.o)(this._controlId,c.a.ContextualDialogEntity,2,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}refresh(e){let t=y+"refresh";e&&e.modules&&(t+="-modules"),e&&e.activities&&(t+="-activities");try{m.a.instance.reportCall(t),e&&this.controlDescriptor&&this.controlDescriptor.Parameters&&(e.modules&&(this.controlDescriptor.Parameters[u.s.UClientModules]=e.modules),e.activities&&(this.controlDescriptor.Parameters[u.s.UClientActivities]=e.activities)),C.dispatch(Object(s.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(t)}catch(e){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(t,e,null,n),e}}setTargetEntity(e,t,n=!0){const a=y+"setTargetEntity";try{m.a.instance.reportCall(a);const r={etn:e,id:t,isAPI:!0},i={};return i[e]=[],C.dispatch(Object(s.v)(this._controlId,r)),C.dispatch(Object(b.e)(i)).catch(t=>{const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),n.push({name:"entityName",value:e}),d.a.getInstance().reportFailure(a+"-retrieveEntities",t,null,n),t}).then(()=>{n&&C.dispatch(Object(s.o)(this._controlId,c.a.InitiateRefresh,1,f.a.toString(f.a.newGuid()))),m.a.instance.reportSuccess(a)})}catch(e){const t=d.a.getInstance().getEventParameters(this.contextToken);throw t.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(a,e,null,t),e}}getGrid(){const e=y+"getGrid";try{return m.a.instance.reportCall(e),this._grid||(this._grid=new o.a(C,this._applicationContext,this._subgridToken,this.pageId,this.getEntityName(),!1,this.name)),m.a.instance.reportSuccess(e),this._grid}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(r.cb)(C.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return m.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(r.eb)(C.getState(),this.pageId,this.contextToken))}getParentForm(){const e=y+"getParentForm";try{m.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return m.a.instance.reportSuccess(e),t}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}refreshRibbon(){const e=y+"refreshRibbon";try{m.a.instance.reportCall(e),this._gridControl.refreshRibbon(),m.a.instance.reportSuccess(e)}catch(t){const n=d.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),d.a.getInstance().reportFailure(e,t,null,n),t}}getEntityName(){return m.a.instance.reportUsage(y+"getEntityName"),"activitypointer"}getUrl(){const e=d.a.getInstance().getEventParameters(this.contextToken);return e.push({name:"controlName",value:this.getName()}),e.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.getUrl").warn("Not Supported in Timeline control",e),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.getUrl"),""}getFilterXml(){const e=y+"getFilterXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getFetchXml(){const e=y+"getFetchXml",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),""}getViewSelector(){const e=y+"getViewSelector",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}getTeamTemplateId(){return null}getRelationship(){const e=y+"getRelationship",t=d.a.getInstance().getEventParameters(this.contextToken);return t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e),null}setFilterXml(e){const t=y+"setFilterXml",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(t)}addOnLoad(e){const t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer("ClientApi.XrmControlTimeline.addOnLoad").warn("Not Supported in Timeline control",t),m.a.instance.reportUsage("ClientApi.XrmControlTimeline.addOnLoad")}removeOnLoad(e){const t=y+"removeOnLoad",n=d.a.getInstance().getEventParameters(this.contextToken);n.push({name:"controlName",value:this.getName()}),n.push({name:"validationError",value:"true"}),this._traceManager.getTracer(t).warn("Not Supported in Timeline control",n),m.a.instance.reportUsage(t)}openRelatedGrid(){const e=y+"openRelatedGrid",t=d.a.getInstance().getEventParameters(this.contextToken);t.push({name:"controlName",value:this.getName()}),t.push({name:"validationError",value:"true"}),this._traceManager.getTracer(e).warn("Not Supported in Timeline control",t),m.a.instance.reportUsage(e)}}},z5LE:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var a=n("jRy5"),r=n("dHD5"),i=n("ApeL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="attribute.notification.update";function s(e,t,n,s,c){return{type:"attribute.notification.add.clear.form.notification",sync:!0,execute(e,l){e.dispatch(function(e,t,n,s){if(s&&s.contextTokenType&&s.contextTokenType===a.a.GridRow)return Object(i.d)(e,s,t,n);const c=Object(r.x)(s);return{type:o,payload:n,meta:{pageId:e,contextKey:c,dataFieldName:t}}}(t,n,s,c))}}}},z8iZ:function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e){return{Title:e&&e.Title||null,Legend:e&&e.Legend||null,Area3DStyle:e&&e.Area3DStyle||null,AreaGradientStyle:e&&e.AreaGradientStyle||null,XAxes:e&&e.XAxes||null,YAxes:e&&e.YAxes||null,SeriesList:e&&e.SeriesList||null,SubTitle:e&&e.SubTitle||null,Colors:e&&e.Colors||null,DisplayMode:e&&e.DisplayMode||0,ErrorInformation:e&&e.ErrorInformation||null,EnableDrilldown:e&&e.EnableDrilldown||!0,Annotations:e&&e.Annotations||null}}n.d(t,"a",(function(){return a}))},zgeC:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var a=n("0nOn"),r=n("P6DH"),i=n("SAYH"),o=n("HcnX"),s=n("1kth"),c=n("dHD5"),l=n("meVR"),u=n("qshH"),d=n("+zjj"),h=n("w92Z"),g=n("whN/"),p=n("HAeo"),m=n("ghNp"),b=n("ZIjf"),f=n("IaGr");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="ClientApi.XrmControlSubGrid.";let C;class _ extends o.a{constructor(e,t,n,r,i,o,s,l){super(e,t,n,s,r,o),this._relationship=null,C=e,this._subgridToken=Object(c.p)(t,r),this._clientApiExecutorSubGrid=new a.a(e,y,n,this._subgridToken),this.clientApiExecutor.addEventParameter({name:"controlName",value:r,isEventParam:!0}),this.clientApiExecutor.addEventParameter({name:"isEditable",value:i,isEventParam:!0}),this._gridControl=new p.a(e,this._subgridToken,n,i,3,!0,l,r),e.dispatch(Object(m.a)(this,n,this._subgridToken))}get clientApiExecutor(){return this._clientApiExecutorSubGrid}setFilterXml(e){const t=y+"setFilterXml";try{b.a.instance.reportCall(t),this._gridControl.setFilterXml(e),b.a.instance.reportSuccess(t)}catch(e){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(t,e,null,n),e}}getFilterXml(){const e=y+"getFilterXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFilterXml();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}refresh(){const e=y+"refresh";try{b.a.instance.reportCall(e),this._gridControl.refresh(),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getFetchXml(){const e=y+"getFetchXml";try{b.a.instance.reportCall(e);const t=this._gridControl.getFetchXml();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getGrid(){const e=y+"getGrid";try{b.a.instance.reportCall(e);const t=this._gridControl.getGrid();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getViewSelector(){const e=y+"getViewSelector";try{b.a.instance.reportCall(e);const t=this._gridControl.getViewSelector();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getTeamTemplateId(){const e=y+"getTeamTemplateId";try{b.a.instance.reportCall(e);const t=this._gridControl.getTeamTemplateId();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.name}),u.a.getInstance().reportFailure(e,t,null,n),t}}addOnLoad(e){this.clientApiExecutor.execute("addOnLoad",()=>{C.dispatch(Object(s.d)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}removeOnLoad(e){this.clientApiExecutor.execute("removeOnLoad",()=>{C.dispatch(Object(s.y)(this._subgridToken,this.pageId,e,this.name))},[{name:"handler",value:e,isRequired:!0,isEventParam:!1}])}getEntityName(){const e=y+"getEntityName";try{b.a.instance.reportCall(e);const t=this._gridControl.getEntityName();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getControlType(){return this.clientApiExecutor.execute("getControlType",()=>{const e=Object(h.a)(C.getState(),this.controlDescriptor,this.pageId,this.contextToken);return e?"customsubgrid:"+e.Name:"subgrid"})}getRelationship(){return this.clientApiExecutor.execute("getRelationship",(e,t)=>{var n,a;if(!this._relationship){if(null===(a=null===(n=this.controlDescriptor)||void 0===n?void 0:n.Parameters)||void 0===a?void 0:a.RelationshipName){const e=this.controlDescriptor.Parameters.RelationshipName,t=this.controlDescriptor.Parameters.RelationshipRoleOrdinal,n=this.controlDescriptor.Parameters.TargetEntityType;this._relationship=Object(p.b)(e,n),this._relationship.roleType=t}this._relationship||(this._relationship=this._gridControl.getRelationship())}return this._relationship})}getRecordSetQueryKey(){return this.clientApiExecutor.execute("getRecordSetQueryKey",()=>Object(r.cb)(C.getState(),this._subgridToken,{id:this.pageId}))}getGridType(){return b.a.instance.reportUsage(y+"getGridType"),3}getRollupType(){return this.clientApiExecutor.execute("getRollupType",()=>Object(r.eb)(C.getState(),this.pageId,this.contextToken))}openRelatedGrid(){this.clientApiExecutor.executeAsync("openRelatedGrid",(e,t)=>{const n=this.getRelationship();if(!n)return f.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: the relationship was not retrieved from the inner grid.",t),Promise.resolve(i.a.EMPTY);const a=Object(d.c)(C.getState(),this.pageId);let r=null;for(let e=0;e<a.length;e++)if(a[e].relationshipName===n.name){r=a[e];break}if(!r)return t.push({name:"relationshipName",value:n.name}),f.a.getInstance().traceManager.getTracer(e).error("Can't open related grid: no relationship was found with the specified name.",t),Promise.resolve(i.a.EMPTY);const o={id:r.id,title:r.title,entityName:this.getEntityName(),relationshipName:n.name,isSelected:!0,show:r.show},s=Object(c.a)(this._subgridToken.parentContextToken,n.name,n.roleType?1===n.roleType?g.a.Referencing:g.a.AssociationEntity:void 0);return C.dispatch(Object(l.a)(this.pageId,s,o))})}refreshRibbon(){const e=y+"refreshRibbon";try{b.a.instance.reportCall(e),this._gridControl.refreshRibbon(),b.a.instance.reportSuccess(e)}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getUrl(){const e=y+"getUrl";try{b.a.instance.reportCall(e);const t=this._gridControl.getUrl();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}getParentForm(){const e=y+"getParentForm";try{b.a.instance.reportCall(e);const t=this._gridControl.getParentForm();return b.a.instance.reportSuccess(e),t}catch(t){const n=u.a.getInstance().getEventParameters(this.contextToken);throw n.push({name:"controlName",value:this.getName()}),u.a.getInstance().reportFailure(e,t,null,n),t}}}},zmAS:function(e,t,n){"use strict";n.r(t),n.d(t,"OFFLINE_UPSYNC_HANDLE_ACTION",(function(){return I})),n.d(t,"initializeOfflineUpsyncProcessAsyncAction",(function(){return P}));var a=n("6u68"),r=n("TBkx"),i=n("YxC/"),o=n("Nzmy"),s=n("0uKS"),c=n("pgSX"),l=n("tICD"),u=n("EY5k"),d=n("si7p"),h=n("vONk"),g=n("504W");var p=n("wje5"),m=n("VKvO"),b=n("ybGo"),f=n("/D1P"),y=n("umme"),C=n("bvqZ"),_=n("Lyxw"),v=n("3/02"),S=n("xM/W"),O=n("6fj+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I="offline.upsync.process.async";let j=null;function P(e=!1){return{type:I,async execute({dispatch:t,getState:n},C){const _=Object(b.b)(n());if(!e&&_===f.a.Completed)return Promise.resolve();if(null!=j)await j;else try{await(j=async function(e,t,n){const b=new Date,f="Offline: Upsync";try{if(await n.OfflineProvider.hasItemsToUpsync().nativePromise()){o.c.info("OFFLINE : OfflineUpsyncHandler : Has Items To Upsync"),t(Object(p.b)());try{const a=await n.OfflineProvider.startPlayback().nativePromise();return t(Object(m.b)()),Object(g.a)(a)||0!==a.get_errorCount()?(o.c.warn("OFFLINE : OfflineUpsyncHandler : Upsync done with conflict"),t((y=String(a.get_lastSuccessfulSaveOnCrm()),{type:"offline.syncerror.dialog.async",execute({dispatch:e,getState:t},n){const a=["L_Show_Details_Text","Sync_Status_Error_Message","L_Last_Save_To_CRM_Server_Text","Sync_Status_Dialog_Title","Dialog_Button_Ok"];return e(Object(u.e)(a)).then(()=>{const n=Object(i.e)(t(),a),u=Object(i.c)(n,"L_Show_Details_Text"),p=Object(i.c)(n,"Sync_Status_Error_Message"),m=Object(i.c)(n,"L_Last_Save_To_CRM_Server_Text"),b=Object(i.c)(n,"Sync_Status_Dialog_Title"),f=Object(i.c)(n,"Dialog_Button_Ok"),C=p+"\n"+m;let _="";return _=Object(g.b)(h.a.get_OverallSyncErrorMessage())?C.replace("{0}",y):h.a.get_OverallSyncErrorMessage(),e(Object(c.a)(d.c,_,{},u,b,"",f)).then(t=>0===t.status?e(Object(l.a)(t.pageId)).then(n=>{n.value.confirmed&&e(Object(s.a)("syncerror",t.pageId,null,null,null,null,null))}):(o.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(t.error)),Promise.reject(t.error)))}).catch(e=>(o.c.error("Offline: Error in Sync error dialog creation "+Object(r.e)(e)),Promise.reject(e)))}}))):(await x(e,t),o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync done without conflict")),n.EventManager.ReportComponentSuccess(f),void n.EventManager.ReportComponentPerformance(f,"Time Taken in ms",+new Date-+b)}catch(e){return o.c.error("OFFLINE : OfflineUpsyncHandler : Upsync Error"),t(Object(a.b)()),n.EventManager.ReportComponentFailure(f,e),n.EventManager.ReportComponentPerformance(f,"Time Taken in ms",+new Date-+b),Promise.reject(e)}}o.c.info("OFFLINE : OfflineUpsyncHandler : Upsync has no items to sync"),t(Object(m.b)()),await x(e,t)}catch(e){return o.c.error("OFFLINE : OfflineUpsyncHandler : hasItemsToUpsync Handler Failed"),Promise.reject(e)}var y}(n,t,C))}catch(e){if(!(e instanceof y.a)){const t=(null==e?void 0:e.message)||"Unexpected upsync error";e=y.a.FromMessage(t)}throw e}finally{j=null}}}}async function x(e,t){if(Object(_.c)(e(),v.l)&&Object(O.e)(e())){const n=["offline_notification_reconnect_success_text"];await t(Object(u.e)(n));const a={id:"upsync_complete_toast",level:1,message:Object(i.b)(e(),n[0]),title:null,type:1,onCloseHandler:null};t(Object(S.b)(!1)),t(Object(C.b)(a))}}}}]),window.bundleExecutionMarkers["scripts/NativeComponents.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();