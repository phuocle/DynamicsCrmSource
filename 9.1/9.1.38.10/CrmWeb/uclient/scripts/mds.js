(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/mds.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[78,68],{CsVN:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeExpressionRuntime",(function(){return dn})),n.d(t,"initializeRetrieveMultipleCache",(function(){return pn})),n.d(t,"initializeRetrieveCache",(function(){return mn})),n.d(t,"execute",(function(){return hn})),n.d(t,"executeOData",(function(){return bn})),n.d(t,"retrieve",(function(){return On})),n.d(t,"retrieveMultiple",(function(){return Cn})),n.d(t,"getClientMetadata",(function(){return In})),n.d(t,"getUserContext",(function(){return Nn}));var a=n("iDqy"),r=n.n(a),o=n("u5k1"),s=n("YNHZ"),i=n("pqvw"),c=n("Wysk"),u=n("3/02"),l=n("Lyxw"),d=n("pEXn"),f=n("EW4s"),p=n("odYE"),g=n("SAYH"),m=n("504W"),h=n("5ZTD"),E=n("TwA0"),b=n("sZ+8"),O=n("Wiik"),v=n("x/BX"),w=n("aRLb"),y=n("K7RF"),R=n("wge3");function S(e){var t;return null===(t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){return e.metadata.rootCanvasApp}(e))||void 0===t?void 0:t.dataComponentApp}function _(e){var t;return null===(t=S(e))||void 0===t?void 0:t.name}function T(e){var t;return null===(t=S(e))||void 0===t?void 0:t.appMetadata}function C(e){var t;return null===(t=S(e))||void 0===t?void 0:t.dependencyInfo}var I=n("Datm");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function j(){return{type:"initializeRootCanvasApp.async",async execute({dispatch:e,getState:t},n){const a=t(),r=Object(R.getRootAppLogicalName)(a),o=Object(R.getRootAppId)(a);r&&o?(e(Object(I.c)({dataComponentApp:{name:r,canvasappid:o}})),await e({type:"retrieveRootCanvasAppMetadata.async",async execute({dispatch:e,getState:t},n){const a=t();let r=T(a);if(r)return;const o=_(a);try{if(r=await n.AppHostClient.getCanvasAppMetadataAsync(o,!0),!r)throw new Error("Invalid canvasAppMetadata");e(Object(I.d)({dataComponentApp:{name:o,appMetadata:r}}))}catch(e){const t=[{name:"appName",value:o}];throw n.EventManager.ReportComponentFailure("ExpressionRuntime.retrieveCanvasAppMetadata",e,void 0,t),e}}})):n.TraceManager.getTracer("RootCanvasApp").warn("Failed to initializeRootCanvasApp with invalid appId or appLogicalName.")}}}function N(e,t){const n=_(e);return Object(I.d)({dataComponentApp:{name:n,expressionRuntimeInitialized:t}})}var D=n("FZDd"),P=n("CB5L"),x=n("c/eZ"),M=n("Jl9H"),A=n("/GRh"),L=n("Rckk"),U=n("x0oY"),$=n("iZ7K"),H=n("uIhY");function F(e){if(!e)return null;const t=e.substring(e.lastIndexOf("/")+1),n=t.indexOf("("),a=t.indexOf("?");let r=-1;n>0&&a>0?r=Math.min(n,n):n>0?r=n:a>0&&(r=a);return r>0?t.substring(0,r):t}var k=n("5Oca"),q=n("HYaY"),G=n("Nb1E"),z=n("EXJz"),B=n("uhZ3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function Y(e,t,n){const a=Object(H.d)(n);if(t[a]){const n=Object(h.b)(t[a]);if(n)return new p.a(Object($.n)(e,n[0]),new g.a(n[1]))}return null}function X(e,t,n){const a=Object(U.l)(n),r=Object(U.k)(a),o=t[a],s=t[r];return o&&s?new p.a(s,new g.a(o)):null}function J(e,t,n){return t&&t[n]&&t[n].reference?t[n].reference:null}function Q(e,t,n,a,r){return!a||Object(B.a)(a.dependencyType)?Promise.resolve({}):a.dependencyType===P.c.NewData?async function(e,t,n,a,r){let o={};const s=n.body?JSON.parse(n.body):{};if(a.expands){const n=Object.entries(a.expands);o=await V(e,t,o,Y,n,s,r)}return o}(e,t,n,a,r):async function(e,t,n,a,r,o=!0){const s=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){if(!e||!t)return null;const n=t.substring(t.lastIndexOf("/")+1),a=n.indexOf("("),r=n.substring(0,a),o=n.substring(a+1,n.indexOf(")"));if(!r||!o)return null;const s=Object($.n)(e,r);return new p.a(s,new g.a(o))}(e,n.urlParameters);if(!s){throw new Error("Failed to get identifier from the urlParameters for old record")}const i=Object(k.h)(e,s.etn,s.id.guid);let c,u,l,d;const f=(a.selects||[]).map(e=>Object(U.g)(e));o&&i&&function(e,t){if(!(null==e?void 0:e.fields))return!1;for(const n of t)if(!e.fields.hasOwnProperty(n))return!1;return!0}(i,f)?(u=function(e,t,n,a){const r={};n.forEach(e=>{r[e]=t.fields[e]});const o=q.a.recordDataToLegacyEntityRecord(e,t.identifier,r,null,a,k.a.LastValid);return Object(H.b)(e,o,1)}(e,i,f,r),c=i.fields,l=J,d=a.expands?Object.entries(a.expands):[]):(u=await W(t,s,a,r,!0),c=u,l=X,d=a.expands?Object.entries(a.expands).filter(e=>e[1].expands):[]);let m=K(u,a);d.length>0&&(m=await V(e,t,m,l,d,c,r));return m}(e,t,n,a,r)}async function V(e,t,n,a,r,o,s){for(const i of r){const r=i[0],c=i[1],u=a(e,o,r);if(u){const e=await W(t,u,c,s);n[r]||(n[r]={}),Object.assign(n[r],K(e,c))}else s.warn(`${qe()} Lookup record is not available for expand ${r}`)}return n}async function W(e,t,n,a,r=!1){const o=function(e,t=!1){let n=e.selects||[];t&&e.expands&&(n=n.concat(Object.keys(e.expands).map(e=>Object(U.l)(e))));return function(e,t){const n=function(e){if(Object(B.a)(e))return"";const t=Object.entries(e).map(([e,t])=>[e,t.selects]).filter(([e,t])=>!!t).map(([e,t])=>`${e}(${Z(t)})`);return t.length>0?"&$expand="+t.join(","):""}(t);if(0===e.length){if(""===n)return null;e.push(Object(U.l)(Object.keys(t)[0]))}const a=Z(e);return`?${a}${n}`}(n,e.expands)}(n,r);if(null===o)return a.warn(`${qe()} Return empty object for expand with empty selects and expands for entity(${t.id.guid})`),{};try{return await e(Object(G.d)(t,o))}catch(e){const n=e&&e.message?e.message:"Unexpected retrieval error",a=`Failed to retrieve entity ${t.etn}(${t.id.guid}) with message: ${n}`;throw new Error(a)}}function K(e,t){const n={};return t.selects&&t.selects.forEach(t=>{if(!Object(B.a)(e[t])){if(Object(z.f)(t)){const a=Object(U.k)(t);Object(B.a)(e)||(n[a]=e[a])}n[t]=e[t]}}),t.expands&&Object.keys(t.expands).forEach(a=>{if(!Object(B.a)(e[a])){const r=K(e[a],t.expands[a]);n[a]=r}}),n}function Z(e){return"$select="+e.join(",")}var ee=n("Er26");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function te(e){return null==e?void 0:e.webPlayerPackageDetails.host}const ne={getDataComponentDependencyInfo:function(e){var t;if(e){const n=e.webPlayerPackageDetails.host,a=e.webPlayerPackageDetails.queryString,r=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.metadata;if(n&&a&&r){const e=r.filter(e=>e.endsWith("dependencyInfo.json"));if(e.length>0)return ae(n,e[0],a)}}return null},getDataComponentScripts:function(e){var t,n,a;if(e){const r=te(e),o=e.webPlayerPackageDetails.queryString,s=null===(n=null===(t=e.dataComponentPackageDetails)||void 0===t?void 0:t.expressionRuntime)||void 0===n?void 0:n["/js/expressionruntime.js"],i=null===(a=null==e?void 0:e.dataComponentPackageDetails)||void 0===a?void 0:a.scripts;if(r&&o&&s&&i){let e=[s];return e=e.concat(i.map(e=>ae(r,e,o))),e=e.map(e=>function(e){const t=e.indexOf("://");if(t>0)return e.substr(t+1);return"//"+e}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e)),e}}return null},getDataComponentPackageHostName:te};function ae(e,t,n){return e.endsWith("/")||(e+="/"),n.startsWith("?")||(n="?"+n),`${e}${t}${n}`}async function re(e,t){let n="";t||(t="batch_"+(new Date).getTime());for(let a=0;a<e.length;a++){const r=e[a];n+="--"+t+"\n";let o="";if(Array.isArray(r)){const e=r,s=`changeset_${t}-${a}`;o=await oe(s,e),n+=`Content-Type: multipart/mixed;boundary=${s}\n`}else{const e=r;o=await se(e),n+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n"}n+="\n",n+=o,n+="\n"}const a=`--${t}--\r\n\0`;n.endsWith(a+"\n")?n=n.substr(0,n.length-1):n+=a;return function(e,t,n){const a=[].concat(...e).filter(e=>!e.ok);let r=!0,o=200,s="OK";a.length>0&&(r=!1,o=a[0].status,s=a[0].statusText);return{ok:r,status:o,statusText:s,json:()=>Promise.resolve(t||{}),text:()=>Promise.resolve(t||""),headers:new A.a({[L.c.CONTENT_TYPE]:"multipart/mixed;boundary="+n}),url:"$batch"}}(e,n,t)}async function oe(e,t){let n="",a=1;for(const r of t)n+="--"+e+"\n",n+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",r.ok?n+="Content-ID: "+a+"\n":n+="Content-ID: "+r.headers.get("Content-ID"),a++,n+="\n",n+=await se(r),n+="\n";return n+="--"+e+"--\n",n}async function se(e){let t=`HTTP/1.1 ${e.status} ${e.statusText}\n`;if(e.headers.forEach((e,n)=>{["REQ_ID","Content-Type","Preference-Applied","OData-EntityId","Location"].indexOf(n)>0&&(t+=`${n}: ${e}\n`)}),"application/json"===e.headers.get("Content-Type")){const n=await e.json();t+="\n"+JSON.stringify(n)}return t}var ie=n("SRlt"),ce=n("NvOS"),ue=n("4N6w"),le=n("4ciL"),de=n("sNgR"),fe=n("69Qu"),pe=n("/oKV"),ge=n("l0Rp"),me=n("GYEz"),he=n("E5IU"),Ee=n("w1eR"),be=n("dj6u"),Oe=n("g22U"),ve=n("17x/"),we=n("q/4y");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * NOTE: ODataBuilder should ONLY be referenced from other ModernDataLayer files and NOT from "generic" UCI files.
 *       This avoids having ODataBuilder being incorrectly bundled into app.js (which should only contains files needed for
 *       boot) If there is functionality needed else where, then those functions should be moved into there own file so the whole
 *       ODatabuilder does NOT need to be referenced.
 */
function ye(e){return{type:"odatabuilder.fromquerystate.async",execute({getState:t},n){const a=n.TraceManager.getTracer(ee.e.ODataBuilder);a.info(je()+" Create a SerializedRequest from Query State.");const r=e.viewId&&g.a.toString(e.viewId),o={urlParameters:`${Object($.o)(t(),e.entityLogicalName)}?fetchXml=${encodeURIComponent(e.fetchXml)}`,additionalHeaders:{[L.c.PREFER]:L.d.ANNOTATIONS,[L.c.ACCEPT]:L.d.APPLICATION_JSON,[L.c.SOURCE_ID]:r},method:"GET",additionalParameters:{[Oe.a.TYPE]:Oe.c.RETRIEVE_MULTIPLE,[Oe.a.SUB_TYPE]:e&&e.queryContext?e.queryContext:Oe.b.RetrieveMultipleOther,[ee.b]:e.entityLogicalName}};try{!function(e,t,n){n.info(je()+" Adding hints to Serialized Request."),t.viewId&&(e.additionalHeaders[L.c.VIEW_ID_HINT]=g.a.toString(t.viewId));t.pageSize&&(e.additionalHeaders[L.c.PAGESIZE_HINT]=t.pageSize.toFixed());t.pageNumber&&(e.additionalHeaders[L.c.PAGE_NUMBER_HINT]=t.pageNumber.toFixed());t.searchString&&(e.additionalHeaders[L.c.SEARCH_HINT]=t.searchString);t.expression&&(e.additionalHeaders[L.c.FILTER_HINT]=Object(we.c)(t.expression));t.sorts&&t.sorts.length>0&&(e.additionalHeaders[L.c.ORDERBY_HINT]=t.sorts.toString());t.selects&&t.selects.length>0&&(e.additionalHeaders[L.c.SELECT_HINT]=t.selects.toString());t.linkEntities&&t.linkEntities.length>0&&(e.additionalHeaders[L.c.LINK_HINT]=t.linkEntities.toString());t.contextFiltersAndIds&&t.contextFiltersAndIds.length>0&&(e.additionalHeaders[L.c.CONTEXT_FILTER]=t.contextFiltersAndIds.toString())}(o,e,a)}catch(e){a.error(`${je()} Adding hints to the serialized request from the query state failed with error: ${null==e?void 0:e.message}.`)}return Promise.resolve(Se(t(),n,o,a))}}}function Re(e,t){return{type:"odatabuilder.fromodatacontract.async",async execute({getState:n,dispatch:a},r){const o=r.TraceManager.getTracer(ee.e.ODataBuilder);o.info(je()+" Create a SerializedRequest from OData Contract.");const s=n();let i;return await Object(w.c)(e),"ExecuteMultiple"===e.getMetadata().operationName?i=await a(function(e,t){return{type:"odatabuilder.fromexecutemutipleodatacontract.async",async execute({getState:n,dispatch:a},r){const o=e.requests;let s=!1;const i=t===pe.a.Default&&Object(ve.g)(n());let c=!1;const u=o.map(async e=>{if(Object(le.e)(e)){const t=await a(Re(e));return t.expressionRuntimeSupportedRequest&&(s=!0),i&&(c=c||Ce(n(),t)),t}if(Object(le.d)(e))return Promise.all(e.map(async e=>{const t=await a(Re(e));return t.expressionRuntimeSupportedRequest&&(s=!0),i&&(c=c||Ce(n(),t)),t}));throw Error("value should be of type OData contract or Changeset")}),l=await Promise.all(u);let d;return s?(d=Object(ge.b)(""),d.requests=l):d=Object(ge.a)(n(),l),d.expressionRuntimeSupportedRequest=s,i&&(c?(d.additionalHeaders[L.c.EXECUTION_HINT]=L.b.OFFLINE,d.additionalParameters[ee.d]=!0):d.additionalHeaders[L.c.EXECUTION_HINT]=L.b.ONLINE),d}}}(e,t)):(i=Object(le.a)(s,e),i.expressionRuntimeSupportedRequest=function(e){var t;return!!(null===(t=S(e))||void 0===t?void 0:t.expressionRuntimeInitialized)}(s)&&function(e,t){return function(e){switch(e.method){case"DELETE":case"PATCH":return!0;case"POST":return"$batch"!==e.urlParameters;default:return!1}}(t)&&!!Pe(e,t)}(s,i)),Promise.resolve(Se(s,r,i,o))}}}function Se(e,t,n,a,r){a.info(je()+" Add Headers to Serialized Request"),Object(m.a)(n.additionalHeaders)&&(n.additionalHeaders={}),function(e,t,n){const a=Object(ue.a)(e);if(a){const e="Bearer "+a;t.additionalHeaders[L.c.AUTHORIZATION_HEADER]=e}else n.warn(je()+" Authorization token is null or empty ")}(e,n,a),Object(m.a)(n.additionalHeaders[L.c.CONTENT_TYPE])&&(n.additionalHeaders[L.c.CONTENT_TYPE]=L.d.APPLICATION_JSON),Object(ie.d)(n);const o=Object(he.i)(e);n.additionalHeaders[L.c.APP_ID]=null!=o?o:"";const s=Object(he.m)(e);n.additionalHeaders[L.c.APP_NAME]=null!=s?s:"",n.additionalHeaders.hasOwnProperty(L.c.CLIENT_REQUEST_ID)||(n.additionalHeaders[L.c.CLIENT_REQUEST_ID]=g.a.newGuid().guid);const i={[L.c.SESSION_ID]:t.EventManager.getCurrentSessionId(),[L.c.ACTIVITY_ID]:t.EventManager.getActivityId()};Object.assign(n.additionalHeaders,i);const c=Object(be.b)(e);n.additionalHeaders[L.c.OBJECT_ID]=null!=c?c:"";const u=Object(be.a)(e);n.additionalHeaders[L.c.TENANT_ID]=null!=u?u:"";const l=function(e,t){const n=Object(me.a)(e),a=Object(me.d)(e),r=n===Ee.a.Browser?a:`${a} - ${Object(me.g)(e)} - ${Object(me.j)(e)}`;return`PowerApps-UCI/${window.VERSION_NUMERIC_VALUE} (${r}; AppName=${t})`}(e,s);return n.additionalHeaders[L.c.USER_AGENT]=l,Te(n,e,a,r),_e(e,n),n}function _e(e,t){if(!Object(m.a)(t.urlParameters)){const n=t.endpoint||L.e,a=Object(ce.a)(e,n);t.urlParameters=`${a}${t.urlParameters}`,t.urlParameters=t.urlParameters.replace(/\t|\r|\n/g,"")}}function Te(e,t,n,a){let r="remote";Object(m.a)(a)||(a===pe.a.Local?r="local":a===pe.a.Remote?r="remote":n.warn(`${je()} Unsupported retrieval strategy ${pe.a[a]}. Falling back to ${r}`)),Object(m.a)(t)||Object(fe.b)(t)||(n.warn(je()+' ClientType overridden to be "local" in request\'s header'),r="local"),n.info(`${je()} ClientType added to request's header is ${r}`),Object(m.a)(e.additionalHeaders)&&(e.additionalHeaders={}),e.additionalHeaders.clientType=r}function Ce(e,t){if(t.urlParameters.includes("$batch"))return!0;const n=function(e,t){const n=F(t);return n&&Object($.n)(e,n)}(e,t.urlParameters);return n&&Object(b.l)(e,n)}function Ie(e,t,n){return{type:"odatabuilder.togcmresponse.async",async execute({getState:a},r){const o=await Object(ie.g)(e,n);return o.Metadata?function(e,t,n){if(n&&n.AppendCallStack("OdataBuilder.parseGetClientMetadataResponse"),t)return e&&e.OtherMetadata?function(e,t){t&&t.AppendCallStack("OdataBuilder.parseGetClientMetadataExResponse");const{OtherMetadata:n}=e,a=Object(x.__rest)(e,["OtherMetadata"]),r=JSON.parse(e.OtherMetadata);if(Object.assign(a,r),a.Entities){const e=[];a.Entities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.Entities=e}if(a.RelationshipNavigationEntities){const e=[];a.RelationshipNavigationEntities.forEach(t=>{const n=Object.assign(Object.assign({},t.EntityMetadata),t.AttributeNames);e.push(n)}),a.RelationshipNavigationEntities=e}return a}(e,n):[];return JSON.parse(e)}(o.Metadata,t,n):o}}}function je(e){return`[${e||ee.f.ODataBuilder}]`}function Ne(e){var t;return(null===(t=null==e?void 0:e.additionalHeaders)||void 0===t?void 0:t[L.c.CLIENT_REQUEST_ID])||ie.c.UNKNOWN}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function De(e){const t={};return e.forEach((e,n)=>{t[n]=e}),t}function Pe(e,t){const n=F(t.urlParameters);return n?function(e,t){var n;return null===(n=C(e))||void 0===n?void 0:n[t]}(e,n):null}function xe(e){const t=e.body?JSON.parse(e.body):{},{statecode:n}=t,a=Object(x.__rest)(t,["statecode"]);return{url:"/"+e.urlParameters,method:e.method,headers:e.additionalHeaders,responseType:"json",bodyData:JSON.stringify(a)}}async function Me(e,t,n){const a=xe(e),r=Pe(t.getState(),e);if(r)try{const o=await async function(e,t,n,a,r){var o;const s=function(e){switch(e.method){case"DELETE":return"OnDelete";case"PATCH":return"OnUpdate";case"POST":return"OnCreate";default:return null}}(n),i={},c=s&&(null===(o=null==a?void 0:a.queryOptions)||void 0===o?void 0:o[s]);if(c){const a=[],o=[];for(let s in c){s=s;const i=c[s];i.dependencyType||(i.dependencyType="OldRecord"===s?P.c.ExistingData:P.c.NewData),a.push(Q(e,t,n,i,r)),o.push(s)}const s=await Promise.all(a);for(let e=0;e<s.length;e++)i[o[e]]=s[e]}return i}(t.getState(),t.dispatch,e,r,n);a.context=o;const s=[];s.push({name:L.c.CLIENT_REQUEST_ID,value:Ne(e)}),s.push({name:ee.c.RUNTIME_CONTEXT,value:JSON.stringify(Ae(a.context))}),n.warn(`${qe()} ExpressionRuntime handling ${e.method} request ${ie.c.trimUrl(a.url)}`,s)}catch(e){a.contextRetrievalFailure={message:"The context building for the data component failed. Error Message: "+e.message}}return a}function Ae(e){const t={};for(const n in e){const a=e[n];t[n]=Le(a)}return t}function Le(e){const t=[];for(const n in e){const a=e[n];let r="";r=a instanceof Object?`${n}(${Le(a)})`:n,t.push(r)}return t.join(",")}function Ue(e,t,n,a){const r=n||e.response,o=e.status>=200&&e.status<300;return a=a||L.d.APPLICATION_JSON,{ok:o,status:e.status,statusText:o?"OK":"",json:()=>Promise.resolve(r||{}),text:()=>Promise.resolve(r?JSON.stringify(r):""),headers:new A.a(Object.assign(Object.assign({},e.headers),{[L.c.CONTENT_TYPE]:a})),url:t.url}}function $e(e,t,n,a,r){a.error(`${qe()} ${e}`);const o={error:{code:-2147220891,message:e,innererror:{message:e}}},s=new A.a({[L.c.CONTENT_TYPE]:L.d.APPLICATION_JSON});if(r)for(const e in r)s.has(e)||s.append(e,r[e]);return{ok:!1,status:t,statusText:"",json:()=>Promise.resolve(o||{}),text:()=>Promise.resolve(o?JSON.stringify(o):""),headers:s,url:n}}async function He(e,t,n,a){var r;let o;if("POST"===e.method&&(null===(r=e.urlParameters)||void 0===r?void 0:r.includes("$batch"))&&e.requests){o=await async function(e,t,n){const a=e.requests,r=[],o=xe(e);let s=0,i=null;for(const e of a){let a;if(Array.isArray(e)){const r=e,o=[];for(let e=0;e<r.length;e++){const a=r[e],c=await Me(a,t,n);if(c.contextRetrievalFailure){i=c.contextRetrievalFailure,s=e+1;break}o.push(c)}a={requests:o}}else{const r=e;a=await Me(r,t,n),a.contextRetrievalFailure&&(i=a.contextRetrievalFailure)}if(i)break;r.push(a)}return r.length>0&&(o.requests=r),i&&(o.contextRetrievalFailure=i,s>0&&(o.contextRetrievalFailure.contentID=s)),o}(e,n,a);let r=[];if(o.contextRetrievalFailure){let e;o.contextRetrievalFailure.contentID&&(e={"Content-ID":""+o.contextRetrievalFailure.contentID});const t=$e(o.contextRetrievalFailure.message,500,o.url,a,e);o.contextRetrievalFailure.contentID?r.push([t]):r.push(t)}if(o.requests){a.warn(qe()+" ExpressionRuntime handling batch request");const e=await t(o),n=e.responses.map((e,t)=>{const n=o.requests[t];if(e.hasOwnProperty("responses")){const t=n;return e.responses.map((e,n)=>Ue(e,t.requests[n]))}return Ue(e,n)});r=e.status>=200&&e.status<300?n.concat(r):n}return 0===r.length?$e("Failed to build batch response on empty response array",400,"$batch",a):re(r)}if(o=await Me(e,n,a),o.contextRetrievalFailure)return $e(o.contextRetrievalFailure.message,500,o.url,a);a.warn(`${qe()} ExpressionRuntime handling ${o.method} request ${ie.c.trimUrl(o.url)}`);const s=await t(o);return s?Ue(s,o):(a.warn(`${qe()} ExpressionRuntime return null for ${o.method} request ${ie.c.trimUrl(o.url)}`),null)}async function Fe(e,t,n,a){const o=new Worker("/uclient/expressionruntimehost.js");let s=M.b(o);o.onerror=e=>{e.stopImmediatePropagation(),a.error(`${qe()} Disabling ExpressionRuntime due to error: ${e.message}`,[{name:"ErrorEvent",value:JSON.stringify(e)}]),s=null};const i=Object(R.getRootAppLogicalName)(n.getState()),c=Object(R.getRootAppId)(n.getState());let u=["Expressionruntime.js","init.js"],l="/uclient/DependencyInfo.json",d="uclient";if(i&&c){await n.dispatch(Object(R.initializeAppHostClient)(c)),await n.dispatch(j());const e=T(n.getState());u=ne.getDataComponentScripts(e),l=ne.getDataComponentDependencyInfo(e),d=ne.getDataComponentPackageHostName(e)}await n.dispatch(function(e,t){return{type:"retrieveDataComponentDependencyInfo.async",async execute({dispatch:n,getState:a},r){try{const t=a();let r=C(t);if(r)return;if(!e)throw new Error("Failed to get the url of data component metadata");const o=_(t)||"DataComponentApp",s=await fetch(e);if(!s.ok)throw new Error("Failed to fetch dependency info with statusCode "+s.status);r=await s.json(),n(Object(I.d)({dataComponentApp:{name:o,dependencyInfo:r}}))}catch(e){const n=e&&e.message?e.message:"Unexpected dependency info retrieval error";throw t.error("Failed to retrieve dependency info with error "+n),new Error(n)}}}}(l,a)),a.warn(`${qe()} Start mer host with appName ${i} and package host name ${d}`),null==s||s.start(e,u,M.a(function(e,t){return async n=>{const{url:a,method:r,headers:o}=n,s={urlParameters:a,body:n.bodyData,method:r,expressionRuntimeCall:!0,additionalHeaders:ke(o)},i=await e(s),c=await i.json(),u=[{name:ie.c.CLIENT_REQUEST_ID,value:Ne(s)}];return t.warn(`${qe()} Return response with status ${i.status} for ${n.method} request ${ie.c.trimUrl(a)}`,u),{headers:De(i.headers),responseType:"json",status:i.status,response:c}}}(t,a)));return e=>(async e=>{try{return await e()}catch(e){throw a.error(`${qe()} Expression runtime encountered error: ${e.message}`),e}})(async()=>{if(!s||e.expressionRuntimeCall)return null;const t=r.a.trackWork("ExpressionRuntime"),o=await He(e,s.executeRequest,n,a);return t(),o})}function ke(e){const t=[L.c.ACCEPT,L.c.PREFER,L.c.AUTO_DISASSOCIATE,L.c.IF_MATCH,L.c.MSCRM_SUPPRESS_DUPLICATION_DETECTION,L.c.MSCRM_RETURN_NOTIFICATIONS,L.c.CONTENT_TYPE,L.c.CLIENT_REQUEST_ID,L.c.SESSION_ID,L.c.ACTIVITY_ID,L.c.SOURCE_ID,L.c.VIEW_ID_HINT,L.c.PAGESIZE_HINT,L.c.PAGE_NUMBER_HINT,L.c.SEARCH_HINT,L.c.FILTER_HINT,L.c.ORDERBY_HINT,L.c.LINK_HINT,L.c.EXECUTION_HINT],n={};for(const a of t)e.hasOwnProperty(a)&&(n[a]=e[a]);return n[L.c.CONTENT_TYPE]||(n[L.c.CONTENT_TYPE]=L.d.APPLICATION_JSON),n}function qe(e){return`[${e||ee.f.ExpressionRuntimeHost}]`}var Ge=n("x/aW"),ze=n("QRGJ"),Be=n("JZmp"),Ye=n("Qu5s"),Xe=n("c0fp"),Je=n("UKgB"),Qe=n("eeMP"),Ve=n("zoUO"),We=n("tHtE"),Ke=n("n23X"),Ze=n("Cxkq"),et=n("OcZc"),tt=n("V0Yx"),nt=n("ATrR"),at=n("IuCO"),rt=n("/Zy9"),ot=n("LbMF"),st=n("BDhr"),it=n("wCzE"),ct=n("IqkD"),ut=n("5KQF"),lt=n("Uv1Y"),dt=n("TFb5"),ft=n("qAG9"),pt=n("7F2l"),gt=n("fYtF"),mt=n("uAlF"),ht=n("umme"),Et=n("4r2D"),bt=n("jZCH"),Ot=n("a475"),vt=n("m4ji"),wt=n("+Szo"),yt=n("iJxC"),Rt=n("ufH1"),St=n("Div0"),_t=n("UDbe"),Tt=n("BSGX"),Ct=n("hgKT");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
async function It(e){try{const t="[MDL BrowserOffline]",n=`SQL: [${e.sqlStatements.toString()}], params: [${e.sqlParameters.toString()}]`;console.log(`${t} executing ${n}`);const a=bt.a.get_DefaultInstance().get_LocalDataSource().get_localStore(),r=a.get_localStoreSchema(),o=[],s=[];for(let t=0;t<e.sqlStatements.length;t++){const n=e.sqlStatements[t],i=e.sqlParameters[t],{table:c,query:u,columns:l}=jt(n,i,r);s[t]=l,o.push(a.retrieveMultipleByQuery(u,c,null).nativePromise())}const i=await Promise.all(o);let c=0;const u=i.map((e,t)=>{const n=e.get_results();c+=n.length;const a={insertId:0,rowsAffected:n.length,columnNames:s[t],rows:n.map(e=>s[t].map(t=>function(e,t){switch(e){case"id":return t.get_key();case"json":return JSON.stringify(t.get_value());default:return t.get_value()[e]}}(t,e)))};return{insertId:0,rowsAffected:n.length,columnNames:s[t],rows:new wt.a(a)}});return console.log(`${t} SUCCESS (total rows: ${c}) ${n}`),u}catch(t){throw Object(Rt.b)("Error executing SQL against indexed db",St.a.storage,e.sqlStatements.join("; ")),t}}function jt(e,t,n){const a=e.match(/select (\*|[\w, ]+)\s*from \[?(\w+)\]?\s*(where (.*))?/i);if(!a)throw new Error("Unable to parse SQL: "+e);const r=a[2],o="*"===a[1]?["id","json"].concat(n.getSchemaFromObjectStoreName(r).get_indexes().map(e=>e.get_name())):a[1].split(",").map(e=>e.trim());return{table:r,query:function(e,t,n,a){let r=null;if((null==t?void 0:t.length)>0){const o=t.match(/\[?(\w+)\]?\s*(=|in)\s*\(?([?, ]+)\)?(\s*and\s*\[?(\w+)\]?\s*(=|in)\s*\(?([?, ]+)\)?)?/i);if(!o)throw new Error("Unable to parse whereClause: "+t);{const t=o[1];let s,i=0;if("="===o[2])s=n[i++];else{const e=Pt(o[3],n,i);s=e.params,i=e.paramIndex}if(o[4]){const c=o[5];let u;if("="===o[6])u=n[i++];else{const e=Pt(o[7],n,i);u=e.params,i=e.paramIndex}const l=a.getSchemaFromObjectStoreName(e).get_indexes().find(e=>e.get_name()===`${t}_${c}`||e.get_name()===`${u}_${s}`);if(!l)throw new Error(`No index found for columns ${t} and ${c}`);const d=new _t.a(l.get_name());r=l.get_name()===`${t}_${c}`?Dt(d,s,u):Dt(d,u,s)}else r="string"==typeof s?new Tt.a(new _t.a(t),s):new Ct.a(new _t.a(t),s);if(i!==n.length)throw new Error("Number of parameters provided does not match query: "+n.length)}}return new yt.a(r,[])}(r,a[4],t,n),columns:o}}function Nt(e,t){return`${e}_${t}`}function Dt(e,t,n){return"string"==typeof t&&"string"==typeof n?new Tt.a(e,`${t}_${n}`):"object"==typeof t&&"string"==typeof n?new Ct.a(e,t.map(e=>Nt(e,n))):"string"==typeof t&&"object"==typeof n?new Ct.a(e,n.map(e=>Nt(t,e))):"object"==typeof t&&"object"==typeof n?new Ct.a(e,t.reduce((e,t)=>e.concat(n.map(e=>Nt(t,e))),[])):void 0}function Pt(e,t,n){return{params:e.split(",").map(e=>{if(n>=t.length)throw new Error("Number of parameters provided does not match query: "+t.length);return t[n++]}),paramIndex:n}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class xt{ExecuteSqlStatementsOnOfflineDB(e){return bt.a.get_DefaultInstance().get_LocalDataSource().get_offlineDataStore().ExecuteSqlStatements(e)}ExecuteSqlStatementsOnMetadataDB(e){const t=bt.a.get_DefaultInstance().get_Store();if(Object(ve.h)(t.getState()))return It(e);const n=[],a=new f.a,r=Ot.a.get_Instance().get_sql(),o=new vt.a(r,"MetadataRequest",!0),s=function(e){n.push({insertId:e.insertId,rowsAffected:e.rowsAffected,columnNames:e.columnNames,rows:new wt.a(e)})},i=function(e){a.reject(ht.a.fromErrorCodeAndMessage(e.code,e.message))};for(let t=0;t<e.sqlStatements.length;t++)o.addRequest(e.sqlStatements[t],e.sqlParameters[t],s,i);return o.execute((function(){a.resolve(n)})),new Promise((e,t)=>{a.then(t=>e(t)).catch(e=>t(e))})}}var Mt=n("iJGp"),At=n("BSqk"),Lt=n("0lM4"),Ut=n("16wZ"),$t=n("YGjz"),Ht=n("WWG3"),Ft=n("WRF3");class kt{getFormattedvalue(e,t,n,a,r){const o=bt.a.get_DefaultInstance().get_Store().getState(),s=Object(ot.d)(o,e);return Object(U.i)(o,s,t,n,a,Object(Ut.a)(r)?null:new Ft.a($t.b,r))}parseIntegerValue(e){return Ht.a.get_instance().parseIntegerValue(e)}parseDecimalValue(e,t){return Ht.a.get_instance().parseDecimalValue(e,t)}parseInvariant(e,t){return Date.parseInvariant(e,t)}}var qt=n("zmAS"),Gt=n("2F73"),zt=n("XvL5"),Bt=n("rO1J"),Yt=n("2JG5"),Xt=n("UMB/"),Jt=n("ai6P"),Qt=n("JdSN"),Vt=n("0rLi"),Wt=n("hs84"),Kt=n("nxt5"),Zt=n("Xe7f"),en=n("hirD"),tn=n("Exmh"),nn=n("Mr6u"),an=n("QFnk"),rn=n("v3UX"),on=n("PF3G"),sn=n("3sOn"),cn=n("z+5+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const un={Create:ze.a,Update:at.a,Delete:Be.a,ExecuteMultiple:Ye.a};let ln;async function dn(e,t,n){try{ln=await Fe(e,xn,t,n),ln&&t.dispatch(N(t.getState(),!0))}catch(e){t.dispatch(N(t.getState(),!1)),n.error(`[${ee.f.ExpressionRuntimeHost}] Expression runtime failed to initialize: ${e.message}`)}}let fn=null;function pn(){fn=new At.a}let gn=null;function mn(){gn=new At.a}function hn(e,t,n=pe.a.Default,a=[]){return{type:"modernDataSource.execute.legacy.async",async execute({getState:r,dispatch:o},s){const i=s.TraceManager.getTracer(ee.e.ModernDataSource);i.info(Hn()+" Execute legacy request.");const c=await async function(e,t){if(t instanceof Zt.a||t instanceof on.a||t instanceof en.a)return await e.dispatch(function(e){return{type:"RETRIEVE_ADDITIONAL_METADATA_FOR_LEGACY_REQUEST",execute({dispatch:t,getState:n},a){const r=function e(t,n,a){if(n instanceof en.a)for(const r of n.get_requests())t=e(t,r,a);else if(n instanceof Zt.a||n instanceof on.a){const e=n.get_target(),r=Object(k.c)(a,e);Object(w.a)(t,e.get_identifier().LogicalName,r)}return t}({},e,n());return t(Object(D.e)(r)).then(()=>{const a=function e(t,n,a){if(n instanceof en.a)for(const r of n.get_requests())t=e(t,r,a);else if(n instanceof Zt.a||n instanceof on.a){const e=n.get_target(),r=Object(k.w)(a,e);for(const e of r)t[e]=[]}return t}({},e,n());return Object.keys(a).length>0?t(Object(D.e)(a)):Promise.resolve()})}}}(t)),Object(h.e)(e,t)}(t,e),u=await o(Re(c,n)),l=o(function(e,t){return{type:"modernDataSource.tolegacyresponse.async",async execute({dispatch:n}){const a=t.get_name();if(!un[a])return e;{const r=un[a](e,t),o=await n(r);if(o instanceof Kt.a)return o}}}}(await Mn(u,r,i,pe.a.Default,s,!1,a),e));return En(o,r(),c,u),l}}}function En(e,t,n,a){var r;cn.a.indexOf(n.getMetadata().operationName)>-1&&(null===(r=a.additionalParameters)||void 0===r?void 0:r[ee.d])&&e(Object(qt.initializeOfflineUpsyncProcessAsyncAction)(!0))}function bn(e,t=pe.a.Default,n=[]){return{type:"modernDataSource.execute.odata.async",async execute({getState:a,dispatch:r},o){const s=o.TraceManager.getTracer(ee.e.ModernDataSource);s.info(Hn()+" Execute Odata request.");const i=await r(Re(e,t)),c=Mn(i,a,s,pe.a.Default,o,!1,n);return En(r,a(),e,i),c}}}function On(e,t,n,a,r){return{type:"moderndatasource.retrieve.async",async execute({getState:o,dispatch:s},i){const c=i.TraceManager.getTracer(ee.e.ModernDataSource),u=[];u.push({name:"EntityLogicalName",value:e.LogicalName}),u.push({name:"EntityRecordId",value:e.Id.toString()});const l=gn&&gn.get(e.get_key());if(l)return c.info(Hn()+" returning retrieve result from cache",u),l.getPromise();const d=new f.a;gn.put(e.get_key(),new Lt.a(d,e.get_key(),"Retrieve"));const m=p.a.fromLegacyEntityReference(e),h=t instanceof zt.a?t.get_Columns():[];h instanceof zt.a&&u.push({name:"ColumnSet",value:h.get_Columns().join(",")}),a&&u.push({name:"BPFRequest",value:a.toString()});try{const l=o();c.info(Hn()+" Starting retrieve operation",u),n.AppendCallStack(Hn()+".retrieve");const f=Object(ve.g)(l)&&Object(b.l)(l,m.etn);if(Object(fe.b)(l)||!Object(E.isOfflineAvailableForUse)(l)||Object(b.l)(l,m.etn)){if(!Object(fe.b)(l)&&Object(E.isOfflineAvailableForUse)(l)||f){if(!Object($.h)(l,m.etn).IsBusinessProcessEnabled||!a)return yn(d,m,h,i,s,o,r,pe.a.Local);const f=[new rn.a(e,t,null,!1,null,r),a];return wn(d,m.etn,h,r,await Rn(f,c,o,s),n,i,s,o,u,null,pe.a.Local)}if(Object(fe.b)(l)){const f=Object($.h)(l,m.etn);if(Yt.a.hasAccessRights(m.etn,i.DataSource.get_MetadataCache())){if(!f){const e=new lt.a("Retrieve - Entity metadata not found.");c.error(Hn()+" Retrieve failed when trying to get entity descriptor from state",u);const t=lt.a.toLegacyErrorStatus(e);throw jn(i,u,t,o(),ee.e.ModernDataSource),d.reject(t),e}if(f.IsChildEntity){h&&h.length>0&&h.indexOf(f.ParentEntityReferencingAttribute)<0&&h.push(f.ParentEntityReferencingAttribute);const e=await yn(d,m,h,i,s,o,r,pe.a.Remote),t=p.a.toLegacyEntityReference(e.getValue(f.ParentEntityReferencingAttribute)),a=[new an.a(t,new Ft.a("systemuser",g.a.toLegacyGuid(Object(ct.q)(o()))))];let l;Sn(f,h,o,c,u)||(l=rt.a.fromXml(Tn(t)).getQueryState(),l.entityLogicalName="principalobjectattributeaccess");const E=await vn(m.etn,h,r,await Rn(a,c,o,s),n,i,s,o,u,l,pe.a.Remote);return e.set_accessRights(E.retrievePrincipalAccessResponse.get_accessRights()),E.retrieveUserSharedAttributePermissionsResponse&&e.set_userSharedAttributePrivileges(_n(E.retrieveUserSharedAttributePermissionsResponse)),d.resolve(e)}const l=[new rn.a(e,t,null,!1,null,r),new an.a(e,new Ft.a("systemuser",g.a.toLegacyGuid(Object(ct.q)(o()))))];(f.IsBusinessProcessEnabled||f.IsBPFEntity)&&a&&l.push(a);let E;return Sn(f,h,o,c,u)||(E=rt.a.fromXml(Tn(e)).getQueryState(),E.entityLogicalName="principalobjectattributeaccess"),wn(d,m.etn,h,r,await Rn(l,c,o,s),n,i,s,o,u,E,pe.a.Remote)}if(!f||!f.IsBusinessProcessEnabled||!a)return yn(d,m,h,i,s,o,r);const E=[new rn.a(e,t,null,!1,null,r),a],b=await wn(d,m.etn,h,r,await Rn(E,c,o,s),n,i,s,o,u,null,pe.a.Remote);return b.get_globalNavigationData()&&(b.fields[Xt.a]=b.get_globalNavigationData().fields[Xt.a].Id,b.fields[Xt.c]=b.get_globalNavigationData().fields[Xt.b],b.fields[Xt.d]=b.get_globalNavigationData().fields[Xt.d]),d.resolve(b)}{c.error(Hn()+" Retrieve failed. Offline not ready for use and server is not available",u);const e=lt.a.fromErrorCode(l,-2147093999),t=lt.a.toLegacyErrorStatus(e);throw d.reject(),jn(i,u,t,o(),ee.e.ModernDataSource,"Retrieve failed. Offline not ready for use and server is not available"),e}}{const e=new lt.a(Object(mt.a)(-2147093999),-2147093999,null,lt.a.fromErrorCode(l,-2147093987,m.id.guid,m.etn),null,null,null,u,null,null,n.get_Stack());throw c.error(Hn()+" Retrieve failed because entity is not available offline",u),d.reject(lt.a.toLegacyErrorStatus(e)),e}}catch(e){throw c.error(Hn()+" Retrieve failed. Unexpected error",u),jn(i,u,ht.a.fromErrorCode(-2147015414),o(),ee.e.ModernDataSource),d.reject(e),e}}}}async function vn(e,t,n,a,r,o,s,i,c,u,l=pe.a.Default){const d=o.TraceManager.getTracer(ee.e.ModernDataSource),f=Object(ge.a)(i(),a);f.urlParameters=ie.c.WEB_API_URL_FRAGMENT+f.urlParameters;const p=await Mn(f,i,d,l,o),g=await Object(Qe.b)(p);let m=null,h=null,E=null,b=null;u&&(b=await s(Cn(u,r)));for(const a of g){if(!a.ok){d.warn(`${Hn()} One of the results of a batch call returned error ${a.statusText}`,c);continue}const r=await a.json(),o=r["@odata.context"];if(o.indexOf("RetrievePrincipalAccess")>0)m=await s(Object(Ze.a)(a,null));else if(o.indexOf("RetrieveProcessControlData")>0)E=await s(Object(et.a)(a,null));else{if(n&&t){const e=[];for(const t of n){const n=t.get_relationShipName();e.push(n)}t=t.concat(e)}h=await s(Object(U.e)(r,e,t&&t.length>0?t:null,void 0,void 0,void 0,d,void 0,n))}}return{retrieveResponse:h,retrieveProcessControlDataResponse:E,retrievePrincipalAccessResponse:m,retrieveUserSharedAttributePermissionsResponse:b}}async function wn(e,t,n,a,r,o,s,i,c,u,l,d=pe.a.Default){const f=await vn(t,n,a,r,o,s,i,c,u,l,d),p=f.retrieveResponse;return f.retrievePrincipalAccessResponse&&p.set_accessRights(f.retrievePrincipalAccessResponse.get_accessRights()),f.retrieveProcessControlDataResponse&&(p.set_entityRecordForProcess(f.retrieveProcessControlDataResponse.get_entity()),p.get_entityRecordForProcess()&&(p.get_entityRecordForProcess().mergeEntityRecordFields(p),p.mergeEntityRecordFields(p.get_entityRecordForProcess())),f.retrieveProcessControlDataResponse.get_globalNavigationData()&&f.retrieveProcessControlDataResponse.get_globalNavigationData().fields&&(p.set_globalNavigationData(f.retrieveProcessControlDataResponse.get_globalNavigationData()),Object(fe.b)(c())&&(p.get_globalNavigationData().fields.bpfDefinitionVersionNumber=f.retrieveProcessControlDataResponse.get_bpfDefinitionVersionNumber()))),f.retrieveUserSharedAttributePermissionsResponse&&p.set_userSharedAttributePrivileges(_n(f.retrieveUserSharedAttributePermissionsResponse)),e.resolve(p)}async function yn(e,t,n,a,r,o,s,i=pe.a.Default){try{const c=a.TraceManager.getTracer(ee.e.ModernDataSource),u=new rn.a(p.a.toLegacyEntityReference(t),n&&n.length>0?new zt.a(n):new Gt.a,null,!1,null,s),l=await Rn([u],c,o,r);let d=null;if(!l||0===l.length)return null;d=l[0];const f=await Mn(d,o,c,i,a);return e.resolve((await r(Object(U.f)(f,u))).get_entity())}catch(t){e.reject(t)}}async function Rn(e,t,n,a){const r=[];for(const t of e){let e=null;t instanceof en.a?e=await a(Object(ge.c)(t)):t instanceof rn.a?e=await a(Object(nt.c)(t)):t instanceof tn.a?e=await a(Object(tt.a)(t)):t instanceof an.a?e=await a(Object(Ke.a)(t)):t instanceof nn.a&&(e=await a(Object(Ve.a)(t))),e.urlParameters=ie.c.WEB_API_URL_FRAGMENT+e.urlParameters,e&&r.push(e)}return r}function Sn(e,t,n,a,r){try{const a=Object(ot.j)(n(),e.EntityLogicalName,t),r=Object(ct.n)(n());let o=!0;for(const e in a)if(a[e].IsSecured){const t=a[e].Id?r[a[e].Id.guid]:null;if(!t||!t.canRead||!t.canUpdate){o=!1;break}}return o}catch(e){return a.error(Hn()+" Error occurred when checking secured attribute permissions",r),!1}}function _n(e){const t={};for(let n=0;n<e.get_count();n++){const a=e.get_item(n).getValue("attributeid"),r=1===e.get_item(n).getValue("readaccess").get_value(),o=1===e.get_item(n).getValue("updateaccess").get_value();if(a.toString()in t&&(r||o)){const e=new Bt.a(a,!1,r||t[a.toString()].get_CanRead(),o||t[a.toString()].get_CanUpdate());t[a.toString()]=e}else a.toString()in t||(t[a.toString()]=new Bt.a(a,!1,r,o))}return t}function Tn(e){return'<fetch distinct="false" no-lock="false" mapping="logical"><entity name="principalobjectattributeaccess"><attribute name="attributeid" /><attribute name="readaccess" /><attribute name="updateaccess" /><filter type="and"><condition attribute="objectid" operator="eq" value="'+e.Id+'" /><condition attribute="principalid" operator="eq-useroruserteams" /></filter></entity></fetch>'}function Cn(e,t){return{type:"moderndatasource.retrievemultiple.async",async execute({getState:n,dispatch:a},r){const o=r.TraceManager.getTracer(ee.e.ModernDataSource);o.info(Hn()+" Retrieve multiple is executing");const s=new f.a,i=fn&&fn.get(e.key);if(!Object(m.a)(i))return i.getPromise();fn.put(e.key,new Lt.a(s,e.key,"RetrieveMultiple"));const c=Object(dt.l)(e.fetchXml);await a(Object(D.e)(c));const u=await a(ye(e)),l=Object(We.d)(e.fetchXml);if(Object(m.a)(t)){const e=Ne(u);t=new Et.a(e,!1)}const d=[];Ln(u,d),Object(gt.d)(u,d);try{const t=await Mn(u,n,o,pe.a.Default,r),a=await Object(ie.g)(t),i=Object(We.a)(n(),e,l,a);return s.resolve(i)}catch(a){if(a instanceof ht.a&&-2147093999===a.get_ErrorCode()){const r=lt.a.fromErrorCode(n(),-2147093987,e.publicKey),i=new lt.a(Object(mt.a)(-2147093999),-2147093999,null,r,null,null,null,d,null,null,t.get_Stack()),c=a.get_Message()||"Not available for offline usage";return o.warn(`${Hn()} ${c} with key '${e.publicKey}' and entity ${e.entityLogicalName}`,d),s.reject(ht.a.fromGenericError(i))}const i=`${Hn()} RetrieveMultiple with key ${e.publicKey} failed with error ${null==a?void 0:a.message}.`;return o.error(i,d),jn(r,d,a,n(),ee.e.ModernDataSourceRM,i),s.reject(a)}}}}function In(e,t,n=pe.a.LocalAndRemote){return{type:"moderndatasource.getclientmetadata.async",async execute({dispatch:a,getState:r},o){const s=o.TraceManager.getTracer(ee.e.ModernDataSource);s.info(Hn()+" Get Client Metadata is executing");const i=Object(Ge.b)(e),c=r();!c&&e.MetadataType&&s.warn(`${Hn()} Trying to execute a ${e.MetadataType} GCM call with depth ${e.DependencyDepth} when state is null`);null===g.a.tryParseOrNull(Object(he.i)(c))&&e.MetadataType===L.a&&(i.AppId=g.a.fromLegacyGuid(e.MetadataId));const d=Object(l.c)(c,u.Xb),f=d?new Xe.a:new Je.a;f.ClientMetadataQuery=i;const p=await a(function(e,t){return{type:"odatabuilder.fromfunctionalodatacontract.async",execute({getState:n},a){const r=a.TraceManager.getTracer(ee.e.ODataBuilder);r.info(je()+" Create a SerializedRequest from a functional OData Contract.");const o=Object(de.a)(n(),e);return Promise.resolve(Se(n(),a,o,r,t))}}}(f,n));if(p.urlParameters&&e.MetadataType!==Ge.a.BusinessProcessFlow&&e.MetadataType!==Ge.a.MetadataVersion&&e.MetadataType!==Ge.a.UserMetadataVersion&&e.DependencyDepth!==Mt.a.UserContext){const e=Object(it.a)(c),t=Object(st.a)(c),n=e.currentVersion?e.currentVersion:-1,a=t.currentVersion?t.currentVersion:-1;p.urlParameters=p.urlParameters+`&umv=${n.toString()}&mv=${a.toString()}`}p.urlParameters=p.urlParameters+ie.c.API_FRAGMENT_9_1,Object(v.a)(c)&&(p.additionalHeaders.Consistency="Strong",a(Object(O.b)(!1)));const h=o.DataSource.get_IsLocalDataSourceAvailable(),E=o.DataSource.get_IsServerAvailable(),b=[];if(Object(m.a)(t)){const e=Ne(p);t=new Et.a(e,!1)}b.push({name:"InputRetrievalStrategy",value:pe.a[n]}),b.push({name:ie.c.REQUEST_DETAILS,value:JSON.stringify(e)}),b.push({name:"LocalDSAvailable",value:h}),b.push({name:"RemoteDSAvailable",value:E}),Ln(p,b);const w=(e,n)=>(Te(e,r(),s,n),async function(e,t,n,a,r,o,s,i,c){c.push({name:"FinalRetrievalStrategy",value:pe.a[n]});try{const u=await Mn(e,t,o,n,s,!0);o.info(Hn()+" MDL getClientMetadata received response",c);return await r(Ie(u,a,i))}catch(e){return o.error(`${Hn()} Get Client Metadata failed with error: ${Object(lt.d)(e)}`,c),jn(s,c,e,t(),ee.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),Promise.reject(e)}}(e,r,n,d,a,s,o,t,b));if(n!==pe.a.LocalAndRemote){if(n===pe.a.Local){if(h){const n=await w(p,pe.a.Local);if((Object(m.a)(n)||0===Object.keys(n).length)&&e.DependencyDepth!==P.b.UserContext){return ht.a.fromErrorCode(-2147093987).set_Stack(t.get_Stack()),s.error(`${Hn()} Not in local store ${e.MetadataType} ${e.MetadataSubtype}`,b),{}}return n}return s.warn(Hn()+" local data source is not available and retrieval strategy is Local.",b),{}}if(n===pe.a.Remote&&E)return w(p,pe.a.Remote);{const e=ht.a.fromErrorCode(-2147093999);throw e.set_Stack(t.get_Stack()),s.error(Hn()+" Remote data source is not available and retrieval strategy is remote, so error in GCM",b),jn(o,b,e,r(),ee.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),e}}if(!h){if(E)return w(p,pe.a.Remote);{const e=ht.a.fromErrorCode(-2147093999);throw e.set_Stack(t.get_Stack()),s.error(Hn()+" remote and local data sources are not available so error in GCM",b),jn(o,b,e,r(),ee.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),e}}try{const t=await w(p,pe.a.Local);if((Object(m.a)(t)||0===Object.keys(t).length)&&e.DependencyDepth!==P.b.UserContext){throw ht.a.fromErrorCode(-2147093987)}return t}catch(e){if(s.warn(`${Hn()} error in local data source GCM, retrying with remote data source. Error is: ${Object(lt.d)(e)}`,b),E)return w(p,pe.a.Remote);const n=ht.a.fromErrorCode(-2147093999);throw n.set_InnerError(e),n.set_Stack(t.get_Stack()),s.error(Hn()+" remote data source is not available and error in local data source GCM",b),jn(o,b,n,r(),ee.e.ModernDataSourceGCM,"getClientMetadata failed (known allowed error)"),n}}}}function jn(e,t,n,a,r,o){const s=lt.a.fromLegacyErrorStatus(n,a);if(t.push({name:ie.c.CRM_ERROR_CODE,value:s.errorCode}),Object(pt.a)(r,s.errorCode))e.EventManager.ReportComponentFailure(r,s,null,t);else{e.TraceManager.getTracer(r).error(`${Hn()} ${o||n.get_Message()}`,t)}}function Nn(e){return{type:"moderndatasource.getusercontext.async",async execute({dispatch:t,getState:n},a){const r=a.TraceManager.getTracer(ee.e.ModernDataSource);r.info(Hn()+" Get User Context is executing");const o=n(),s=Object(he.i)(o),i=new Vt.a(null,null,null,null,[],!1,Mt.a.UserContext,null,[],g.a.toLegacyGuid(g.a.tryParseOrNull(s))),c=new Et.a(g.a.newGuid().guid),u=[];u.push({name:ie.c.CLIENT_REQUEST_ID,value:c.RequestId()}),u.push({name:"InputRetrievalStrategy",value:pe.a[e]});const l=await t(In(i,c,e));if(!l||!l.UserContext||!l.UserContext[0])return u.push({name:ie.c.OTHER_DETAILS,value:"UserContext call failed in MDL via "+pe.a[e]}),r.error(`${Hn()} User Context was not returned from MDL. Strategy ${e}`,u),a.EventManager.ReportComponentFailure(ee.e.ModernDataSourceUserContext,u),e===pe.a.Local?null:Promise.reject(new Qt.a(null,"error","UserContext was not returned from GetClientMetadata call"));if(Object.keys(l).length>1){r.info(`${Hn()} UserContext call with strategy ${e} returned additional metadata`);const n=Object(ut.a)(l,null,null,o,null,null,r,s);n.webResourcesContent=null,await t(Object(y.c)(n))}return u.push({name:ie.c.OTHER_DETAILS,value:"UserContext call succeeded in MDL via "+pe.a[e]}),e===pe.a.Local?(a.EventManager.ReportComponentSuccess(ee.e.ModernDataSourceUserContext,u),sn.a.createFromObjectData(l.UserContext[0])):(a.EventManager.ReportComponentSuccess(ee.e.ModernDataSourceUserContext,u),Object(Jt.a)(l.UserContext[0]))}}}function Dn(e,t){return Object(E.getIsOfflineEnabled)(e)&&Object(E.isOfflineAvailableForUse)(e)&&Ce(e,t)}function Pn(e){return Object(E.getIsOfflineEnabled)(e)?Object(E.isOfflineAvailableForUse)(e)?"related entity is not enabled for offline":"offline is not yet available":"the app is not offline enabled"}async function xn(e,t,n){var a,i;const d=null==n?void 0:n.TraceManager.getTracer(ee.e.ModernDataSource),f={TraceManager:null!==(a=null==n?void 0:n.TraceManager)&&void 0!==a?a:new s.ConsoleTraceManager,EventManager:null!==(i=null==n?void 0:n.EventManager)&&void 0!==i?i:new o.ConsoleEventManager,SqlExecutor:new xt,AdditionalParameters:{EnableDependency:!Object(m.a)(t)&&Object(l.c)(t(),u.oc)},Formatter:new kt};null==d||d.info(Hn()+" Execute the request in Modern Data Layer Component");const p=new c.ODataExecutor(null,f),g=r.a.trackWork("MDS"),h=await p.execute($n(e));return g(),h}async function Mn(e,t,n,a=pe.a.Default,r,o=!1,s=[]){const c=performance.now();!function(e,t,n=pe.a.Default,a=!1,r){try{if(t.additionalHeaders[L.c.EXECUTION_HINT])return;let r;if(e)switch(n){case pe.a.Local:if(!a&&!Dn(e,t)){const t=Pn(e);throw ht.a.fromErrorCodeAndMessage(-2147093999,"Can't execute 'Offline' request as "+t)}r=L.b.OFFLINE;break;case pe.a.Remote:if(!a&&!Object(fe.b)(e))throw ht.a.FromMessage("Can't execute 'Online' request as server is NOT available");r=L.b.ONLINE;break;case pe.a.Default:if(Object(he.o)(e)&&Object(fe.b)(e)&&Dn(e,t)){t.additionalHeaders.clientType=ee.a.local;const e={[ee.d]:!0};t.additionalParameters=t.additionalParameters?Object.assign(Object.assign({},t.additionalParameters),e):e,r=L.b.OFFLINE}else if(Object(fe.b)(e))r=L.b.ONLINE;else{if(!Dn(e,t)){const t=Pn(e);throw ht.a.fromErrorCodeAndMessage(-2147093999,"Can't execute 'Default' request as the server is NOT available and "+t)}r=L.b.OFFLINE}break;default:throw ht.a.FromMessage("Currently MDL does not support the strategy: "+n)}else r=n===pe.a.Local?L.b.OFFLINE:L.b.ONLINE;t.additionalHeaders[L.c.EXECUTION_HINT]=r}catch(n){const a=[];throw Ln(t,a),jn(r,a,n,e,ee.e.ModernDataSource),n}}(t(),e,a,o,r);if(Object(l.c)(t(),u.yc)&&e.expressionRuntimeSupportedRequest){const a=[];Ln(e,a);const o=ln&&await ln(e);if(o)return n.warn(Hn()+" Handling the response for expression run time case",a),An(t(),o,e,c,r,n,!0,a);n.warn(Hn()+" No Data Component handled this request - Response is Null",a)}let d=e;const f=function(e){return"GET"===e.method&&"remote"===Object(i.getClientType)($n(e))&&Object(H.c)(e.urlParameters).length>ie.c.VERY_LONG_URL}(e);f&&(s.push({name:"isConvertToBatchRequestNeeded",value:f}),d=function(e,t){const n=Object(ge.a)(e,[t]);return n.additionalHeaders=Object.assign(Object.assign({},t.additionalHeaders),n.additionalHeaders),_e(e,n),n}(t(),e)),Ln(e,s),n.warn(Hn()+" Skip Expression Runtime Component and send the request directly to Modern Data Layer",s);let p=await xn(d,t,r);return f&&(p=await async function(e,t,n){const a=await Object(Qe.b)(e);if(a&&a.length>0)return a[0];return t.warn(Hn()+" Invalid response list returned from parseBatchResponse",n),e}(p,n,s)),An(t(),p,e,c,r,n,!1,s)}async function An(e,t,n,a,r,o,s,i=[]){const c=performance.now()-a;if(i.push({name:ie.c.RESPONSE_TIME,value:c}),function(e,t,n){const a=e.headers?Object(ft.a)(e.headers,L.c.SERVER_REQUEST_ID):ie.c.UNKNOWN,r=e.status?e.status:null,o=e.type?e.type:null,s=e.statusText?e.statusText:null,i=e.url?ie.c.trimUrl(e.url):null,c=e.headers?Object(ft.a)(e.headers,"Content-Length"):ie.c.UNKNOWN;t.push({name:ie.c.RESPONSE_URL,value:i}),t.push({name:ie.c.HTTP_STATUS_CODE,value:r}),t.push({name:ie.c.HTTP_RESPONSE_TYPE,value:o}),t.push({name:ie.c.HTTP_RESPONSE_STATUSTEXT,value:s}),t.push({name:ie.c.SERVER_REQUEST_ID,value:a}),t.push({name:ie.c.RESPONSE_SIZE_IN_BYTES,value:c}),t.push({name:ie.c.IS_BATCH_REQUEST,value:!1}),t.push({name:"IS_EXPRESSION_RUNTIME_REQUEST",value:n})}(t,i,s),t.ok)return r.EventManager.ReportComponentSuccess(ee.e.ModernDataSource,i),t;if(401!==t.status)return t.url&&-1!==t.url.indexOf("$batch")||n&&n.urlParameters&&-1!==n.urlParameters.indexOf("$batch")?Object(Qe.b)(t).then(a=>{if(a){const s=a.find(e=>!e.ok)||t;return Un(e,s,r,n,i,o)}let s=null;throw s=new Qt.a(t,t.statusText,"Batch request failed with http Status : "+t.status),s}):(null==o||o.error(Hn()+" Modern Data Layer component returns Error Response - Convert error to CRM Error.",i),Un(e,t,r,n,i,o));{null==o||o.error(Hn()+" Modern Data Layer : 401 response from server.",i);const t=bt.a.get_DefaultInstance().get_RemoteCallRetryHandler();try{return await t.handleAuthError(n),null==o||o.error(Hn()+" Modern Data Layer : 401 response from server, handleAuthError() was successful, retrying the request.",i),xn(n,()=>e,r)}catch(e){throw o&&o.error(Hn()+" Error in 401 error handling",i),e}}}function Ln(e,t){var n,a,r;const o=Object(Oe.e)(e);t.push({name:ie.c.CLIENT_REQUEST_ID,value:Ne(e)}),t.push({name:ee.c.CLIENT_TYPE,value:Fn(e)}),t.push({name:ee.c.OPERATION_TYPE,value:o.type}),t.push({name:ee.c.OPERATION_SUB_TYPE,value:o.subType}),t.push({name:ee.c.IS_OFFLINE_BY_DEFAULT_REQUEST,value:(null===(n=e.additionalParameters)||void 0===n?void 0:n[ee.d])||!1}),t.push({name:ee.c.ENTITY_NAME,value:(null===(a=e.additionalParameters)||void 0===a?void 0:a[ee.b])||"Unknown"}),t.push({name:ee.c.EXECUTION_HINT,value:(null===(r=e.additionalHeaders)||void 0===r?void 0:r[L.c.EXECUTION_HINT])||"Unknown"});const s=e.urlParameters?ie.c.trimUrl(e.urlParameters):null;t.push({name:ie.c.REQUEST_URL,value:s}),t.push({name:ie.c.REQUEST_METHOD,value:e.method||"Unknown"})}function Un(e,t,n,a,r,o){try{return t.text().then(s=>{var i;const c=function(e,t,n,a){let r=null;const o=e&&e.toLowerCase().indexOf("<!doctype html")>-1;r=o?Qt.a.createFromHtml(e,t):new Qt.a(t,t.statusText,e);const s=t.headers?Object(ft.a)(t.headers,"Retry-After"):null;r.set_retryAfter(s);const i=t.headers?Object(ft.a)(t.headers,"Content-ID"):null;if(i){const e=Number.parseInt(i,10);e>-1&&r.set_contentId(e)}const c=t.headers?Object(ft.a)(t.headers,L.c.SERVER_REQUEST_ID):ie.c.UNKNOWN,u=Ne(n);r.set_serverResponseId(c),r.set_clientRequestId(u);const l=t&&0===t.status;return r.set_isErrorInOffline(l),a.push({name:ie.c.ODATA_ERROR_RESPONSE_IS_HTML_TYPE,value:o}),a.push({name:ie.c.IS_ERROR_IN_OFFLINE,value:l}),r}(s,t,a,r);ie.c.canLogDetailsOfRequest(t.url)&&(r.push({name:ie.c.ODATA_ERROR_RESPONSE_COMPLETE_TEXT,value:s}),r.push({name:ie.c.CRM_ERROR_RESPONSE_COMPLETE_TEXT_FROM_ODATA_RESPONSE,value:JSON.stringify(c)}));let u=null,l=null,f=c&&c.get_message?c.get_message():null;if(c.get_organizationServiceFault&&c.get_organizationServiceFault()){l=c.get_organizationServiceFault().get_errorCode();try{null==f&&(f=c.get_error())}catch(e){r.push({name:ie.c.CRM_ERROR_RESPONSE_GET_ERROR,value:ie.c.FAILED})}try{const e=JSON.parse(c.get_error());u=e.error&&e.error.innererror?e.error.innererror.stacktrace:null}catch(e){r.push({name:ie.c.CRM_ERROR_RESPONSE_GET_ERROR_PARSING,value:ie.c.FAILED})}}let p=f||ie.c.REQUEST_FAILURE;a&&ie.c.isSearchRequest(a.endpoint)&&(p=ie.c.UCIMONITOR_ERROR_MESSAGE),r.push({name:ie.c.CRM_ERROR_CODE,value:l}),r.push({name:ie.c.CRM_CALL_STACK,value:u}),r.push({name:ie.c.CRM_ERROR_MESSAGE,value:p});const g=t?t.status:null;if(null===(i=a.additionalParameters)||void 0===i?void 0:i[ee.d]){let t,n;(t=function(e){const t=e.indexOf("fetchXml=");return t>0?decodeURIComponent(e.substring(t+"fetchXml=".length)):null}(a.urlParameters))&&(n=Object(b.b)(e,t)).error&&r.push({name:ee.c.ERROR_DETAIL,value:"Linked entity is not available offline"},{name:d.b.RelatedEntityUnavailableOffline,value:n.relatedEntityUnavailableOffline})}if([400,404,500,503].indexOf(g)>-1&&Object(pt.a)(ee.e.ModernDataSource,l)){const e=new lt.a(p,l,null,null,null,null,null,r,null,null,null,null,null,null,g,c.get_clientRequestId(),c.get_serverResponseId());n.EventManager.ReportComponentFailure(ee.e.ModernDataSource,e,void 0,r)}else o&&o.error(`${Hn()} ${p}`,r);const m=Wt.a.GetErrorStatusFromErrorResponse(c);throw Object(fe.b)(e)&&!c.get_isErrorInOffline()||(m.set_ErrorCode(-2147093999),m.set_Message(ht.a.fromErrorCode(-2147093999).get_Message()),m.set_InnerError(Wt.a.GetErrorStatusFromErrorResponse(c))),m})}catch(t){null==o||o.error(Hn()+" Modern Data Layer component : Exception occurred while creating error response.",r);let n=-2147093999;Object(fe.b)(e)&&(n=-2147015419);throw ht.a.fromErrorCode(n)}}function $n(e){return{url:e.urlParameters,method:e.method,additionalHeaders:e.additionalHeaders,body:e.body}}function Hn(e){return`[${e||ee.f.ModernDataSource}]`}function Fn(e){return e&&e.additionalHeaders?e.additionalHeaders.clientType||ee.a.remote:ie.c.UNKNOWN}},YGjz:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="systemuser",r="transactioncurrency"},sra9:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return f}));var a=n("NjDY"),r=n("hAdb"),o=n("Lyxw"),s=n("3/02"),i=n("twWZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function c(e){return e.appHostClient.initialized}function u(e){return e.appHostClient.error}function l(e){const{geoName:t,isSovereignCloud:n}=Object(a.x)(e);if(Object(o.c)(e,s.yc))return"Test";switch(null==t?void 0:t.toUpperCase()){case"TIP":const t=Object(r.b)(e,"canvashostenv");switch(null==t?void 0:t.toUpperCase()){case"LOCAL":return"Local";default:return"Test"}case"USG":return"GccHigh";case"NA":if(n)return"Gcc";default:const a=Object(r.b)(e,"canvashostenv");switch(null==a?void 0:a.toUpperCase()){case"PREVIEW":return"Preview";case"INT":return"Int";case"PREPROD":return"Preprod";default:return"Prod"}}}function d(e){switch(l(e)){case"Local":return i.Endpoint.Local;case"Test":return i.Endpoint.Test;case"Int":return i.Endpoint.Int;case"Preprod":return i.Endpoint.Preprod;case"Gcc":return i.Endpoint.Gcc;case"GccHigh":return i.Endpoint.GccHigh;case"Preview":return i.Endpoint.Preview;default:return i.Endpoint.Prod}}function f(e){return e.appHostClient.bundleLoaded}},wge3:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeAppHostClient",(function(){return m})),n.d(t,"getRootAppId",(function(){return E})),n.d(t,"getRootAppLogicalName",(function(){return b})),n.d(t,"runWindowOverrides",(function(){return O}));var a=n("hAdb"),r=n("7cfk"),o=n("P4TJ"),s=n("sra9"),i=n("eL04"),c=n("SAYH"),u=n("P+p9"),l=n("9eA9"),d=n("IqkD"),f=n("EY5k"),p=n("YxC/");function g(e){switch(e){case"error":return 2;case"success":return 1;case"warning":return 3;case"info":default:return 4}}function m(e){return{type:"apphostclient.initialize.async",async execute(t,n){var a,l,m;if(!n.AppHostClient){if(!Object(s.a)(t.getState())){const e=(m=t.getState(),Object(s.e)(m)+"/apphost/clientsdk?version=1");await n.AssetLoader.loadScript(e),t.dispatch({type:o.a,payload:!0})}const b=E(t.getState(),e),O={authMode:5,endpoint:Object(s.e)(t.getState()),_rootAppId:b,hostConfig:{correlationId:n.EventManager.getCurrentSessionId(),locale:Object(d.w)(t.getState()).formatInfoCultureName,source:"UCI"}};try{await function(e,t,n){let a;const r=new Promise((e,t)=>{a=setTimeout(()=>t({message:"PowerAppsHostingSdk.initializeAsync timed out"}),n)}),o=PowerAppsHostingSdk.initializeAsync(t).then(t=>{clearTimeout(a),e.AppHostClient=t});return Promise.race([o,r])}(n,O,9e4),n.AppHostClient.on("appHostClientErrorEvent",(l=t.dispatch,function(e){e&&e.errorInfo&&l(Object(i.b)({level:2,message:e.errorInfo.localizedMessage,id:c.a.newGuid().guid,type:2,showCloseButton:!0}))})),n.AppHostClient.on("appHostClientNotification",function(e){return function(t){if(t&&t.notificationInfo){const n=t.notificationInfo.timeoutInMilliSec,a=c.a.newGuid().guid;e(Object(i.b)({level:g(t.notificationInfo.notificationType),message:t.notificationInfo.message,id:a,type:2,showCloseButton:!0,onCloseHandler:t.notificationInfo.clickHandler})),n>0&&1e4!==n&&setTimeout(()=>{e(Object(u.b)(a))},n)}}}(t.dispatch)),t.dispatch({type:o.b,payload:{initialized:r.a.Initialized,error:void 0}})}catch(r){if(null===(a=null==r?void 0:r.errorInfo)||void 0===a?void 0:a.code)t.dispatch(h(r));else{const e="Crm.GenericErrorMessage",n=[e];t.dispatch(Object(f.e)(n)).then(()=>{const a=Object(p.e)(t.getState(),n);t.dispatch(h({errorInfo:{code:"unknown",localizedMessage:Object(p.c)(a,e),timestamp:Date.now(),description:(null==r?void 0:r.message)||"Unknown error occured while initializing apphostclient"}}))})}const o=[{name:"environment",value:Object(s.d)(t.getState())},{name:"appId",value:e}];throw n.EventManager.ReportComponentFailure("CustomPage.SharedAppHostInitialize",r,void 0,o),r}}}}}function h(e){return{type:o.c,payload:{initialized:r.a.Initialize_Failed,error:e}}}function E(e,t){return Object(a.e)(e,"rootAppId")||t}function b(e,t){return Object(a.b)(e,"appLogicalName")||t}function O(e){const t=e.TraceManager.getTracer("TrustedUCI");XMLHttpRequest=window.routedXHR;const n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){const e=arguments[0];let a=arguments[1];const r=arguments[2];if(!1===r){const e=[{name:"url",value:a}];t.error("Sync call attempted",e)}const o=arguments[1].indexOf("/webresources/");if(-1!==o){const e=a.slice(o+"/webresources/".length);a=`${Object(l.b)()}/api/data/v9.0/webresourceset?$filter=name eq '${e}'&$select=content`;const t=this.onload;this.onload=()=>{var e;try{const t=JSON.parse(this.responseText);this._responseText=atob(null===(e=null==t?void 0:t.value[0])||void 0===e?void 0:e.content)}catch(e){}t(this)}}-1===a.indexOf("https://")&&(a=Object(l.b)()+a),n.call(this,e,a)},window.fetch=e=>new Promise((t,n)=>{const a=new XMLHttpRequest;a.open(e.method,e.url),e.headers.forEach((e,t)=>{a.setRequestHeader(t,e)}),a.onload=function(){const e=204===a.status?null:a.response||a.responseText,n=new Headers;a.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(e=>{const t=e.split(": ");n.append(t.shift(),t.join(": "))});const r=new Response(e,{status:a.status,statusText:a.statusText,headers:n});t(r)},a.onerror=function(){n("Error")},e.text().then(e=>{a.send(e)})})}}}]),window.bundleExecutionMarkers["scripts/mds.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();