(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/4.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[4],{"+HfF":function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n("pgSX"),a=n("si7p"),o=n("ngeo"),i=n("YxC/"),s=n("EY5k"),l=n("tICD"),c=n("8MGk");function u(e,t){return{type:"commanding.script.error.dialog",execute(n,u,m){const d=t.errorCode?t.errorCode:-2140991205,p=t.errorFault.message,b=t.errorFault.stack,g="0x"+o.a.getHexErrorCodeFromInt(d),h="Error_Title_"+g,_="Error_Message_"+g,I=[h,_,"SolutionWizard.Button.Export.Tooltip","Button_Label_OK","Web.Dialog.ErrorCode_Caption","Error_Title_0x8004b056","Error_Title_0x80700000","L_Show_Details_Text","L_Client_Session_Id","L_Current_Time","L_Correlation_Id"];return n.dispatch(Object(s.e)(I)).then(()=>{const t=Object(i.e)(n.getState(),I),o=Object(i.c)(t,h);let s=Object(i.c)(t,_);const d=Object(i.c)(t,"SolutionWizard.Button.Export.Tooltip"),g=Object(i.c)(t,"Button_Label_OK"),C=Object(i.c)(t,"L_Show_Details_Text"),E=Object(i.c)(t,"L_Client_Session_Id"),v=Object(i.c)(t,"L_Current_Time"),N=Object(i.c)(t,"L_Correlation_Id");s=s.replace("\\r\\n{0}","");const L=E.replace("{0}",u.EventManager.getCurrentSessionId()),y=v.replace("{0}",""+new Date),f=N.replace("{0}",m.correlationId);n.dispatch(Object(r.a)(a.d,p,{type:"error"},d,o,s,g,C,[p,L,f,y],void 0,e)).then(e=>{if(0===e.status)return n.dispatch(Object(l.a)(e.pageId)).then(e=>{if(e&&e.value&&e.value.confirmed){const e={mimeType:"text/plain",fileName:"ErrorDetails.txt",fileContent:btoa(b),fileSize:b.length},t={openMode:2};new c.a(u,n).openFile(e,t)}});u.EventManager.ReportComponentFailure("Commanding.Actions.OpenJavaScriptErrorDialog",e.error)})})}}}},ZdjS:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n("2yvP"),a=n("TDVd"),o=n("NjDY"),i=n("IqkD"),s=n("9eA9"),l=n("iZ7K"),c=n("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u{openUrl(e,t,n,r){var a,u;if(e&&e.Address){const m=Object(o.x)(n),d=Object(o.w)(n),p=Object(i.w)(n),b=new s.a(e.Address);if(t.forEach(e=>{e.name&&b.searchParams.set(e.name,e.value)}),e.PassParameters&&(b.searchParams.set("orgname",d),b.searchParams.set("userlcid",p.languageId.toString()),b.searchParams.set("orglcid",m.languageCode.toString()),2===r.ContextType||5===r.ContextType)){const e=Object(l.p)(n,r.ContextEntityLogicalName).toString();b.searchParams.set("typename",r.ContextEntityLogicalName),b.searchParams.set("type",e);const t=(null===(a=null==r?void 0:r.EntityId)||void 0===a?void 0:a.guid)?null===(u=null==r?void 0:r.EntityId)||void 0===u?void 0:u.guid.toString():c.a.EMPTYGUIDSTRING;b.searchParams.set("id",t)}return window.open(b.href," ",e.WinParameters)}return null}}var m=n("M0zh");var d=n("3mEc"),p=n("lY/Z"),b=n("WePp");class g extends b.a{constructor(e,t,n,r,a,o,i){super("uci_commanding_command_execution"),super.addEventParameter("TimeTaken",new Date),super.addEventParameter("CommandType",e),super.addEventParameter("CommandId",t),super.addEventParameter("ControlId",n),super.addEventParameter("CommandManagerId",r),super.addEventParameter("PageId",a),super.addEventParameter("EntityName",o),super.addEventParameter("SelectedItemsCount",i)}}var h=n("pEXn"),_=n("Uv1Y"),I=n("+HfF"),C=n("eD3A"),E=n("sZ+8"),v=n("V6aM"),N=n("zmaG"),L=n.n(N),y=n("mlvZ");class f{constructor(){this.Items=null}}class T{constructor(){this.Alt=null,this.ControlType=null,this.Command=null,this.LabelText=null,this.Id=null,this.ModernImage=null,this.Menu=null}}class A{constructor(){this.Item=null,this.Title=null}}class w{constructor(){this.MenuSection=null,this.Id=null}}var M=n("eruq");class F{constructor(e){this._parsedXml=null,this._parsedXml=this._parseXMLFromString(e)}_parseXMLFromString(e){const t=Object(M.b)(e),n=Object(M.a)(t);let r=null;return n.hasChildNodes()&&(r=this.parseMenuFromXML(n.childNodes().get_item(0))),r}getParsedXml(){return this._parsedXml}parseMenuFromXML(e){let t=new w;if(e.get_tagName()===F._MENU_TAG){if(t.Id=e.getAttribute(F._ID_FIELD),t.MenuSection=new Array(0),e.hasChildNodes()){const n=e.childNodes();for(let e=0;e<n.get_count();e++)t.MenuSection.push(this.parseMenuSectionFromXML(n.get_item(e)))}}else t=null;return t}parseMenuSectionFromXML(e){let t=new A;return e.get_tagName()===F._MENUSECTION_TAG?(t.Title=e.getAttribute(F._TITLE_FIELD),e.hasChildNodes()?t.Item=this.parseItemFieldFromXML(e.childNodes().get_item(0)):t.Item=null):t=null,t}parseItemFieldFromXML(e){let t=new f;if(e.get_tagName()===F._CONTROL_TAG){if(t.Items=new Array(0),e.hasChildNodes()){const n=e.childNodes();for(let e=0;e<n.get_count();e++)t.Items.push(this.parseItemFromXML(n.get_item(e)))}}else t=null;return t}parseItemFromXML(e){let t=new T;switch(t.Alt=e.getAttribute(F._ALT_FIELD),t.ControlType=e.get_tagName(),t.Command=e.getAttribute(F._COMMAND_FIELD),t.LabelText=e.getAttribute(F._LABELTEXT_FIELD),t.Id=e.getAttribute(F._ID_FIELD),t.ModernImage=e.getAttribute(F._MODERNIMAGE_FIELD),e.get_tagName()){case F._BUTTON_TAG:t.Menu=null;break;case F._FLYOUTANCHOR_TAG:case F._SPLITBUTTON_TAG:e.hasChildNodes()?t.Menu=this.parseMenuFromXML(e.childNodes().get_item(0)):t.Menu=null;break;default:t=null}return t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function P(e,t,n,o,i,s,l,c,b,N){return{type:"runCommand",execute({dispatch:f,getState:T},A){const w=[];w.push({name:h.b.CommandingParameters.CommandType,value:n}),w.push({name:h.b.CommandingParameters.CommandId,value:o}),w.push({name:h.b.CommandingParameters.ControlId,value:i}),w.push({name:h.b.CommandingParameters.CommandManagerId,value:l});let M=null,P=-1,$=!1;const x=A.TraceManager.getTracer("Commanding"),S=`commandId: ${o}, commandType: ${n}, controlId: ${i}, commandManagerId: ${l}, pageId: ${s}, entityName: ${M}, selectedItems: ${P}.`;try{if(M=t&&t.EntityLogicalName?t.EntityLogicalName:null,P=t&&t.SelectedItems?t.SelectedItems.length:-1,w.push({name:h.b.CommandingParameters.PageId,value:s}),s||x.warn("Can't detect PageId for "+S),w.push({name:h.b.CommandingParameters.ExecuteWarningEntityName,value:M}),M||b||x.warn("Can't detect EntityName for "+S),w.push({name:h.b.CommandingParameters.SelectedItemsCount,value:P}),P>=0||b||x.warn("Can't calculate selectedItemsCount for "+S),x.debug("Executing "+S),A.EventManager.ReportEvent(new g(n,o,i,l,s,M,P)),e&&e.Commands&&!b){const b=e.Commands;let g=b[n]?b[n][o]:null;if(!g&&b[m.c]&&(g=b[m.c][o]),g){const e=g.Actions,b=e.filter(e=>1===e.ActionType);x.debug(`Found ${b.length} Url Actions.`),w.push({name:h.b.CommandingParameters.UrlActionCount,value:b.length}),b.forEach(e=>{const n=e.Attributes;x.debug(`Opening Url: ${n.Address} for url action.`);const r=(new a.a).evaluateParameters(e.Parameters,e.ActionType,t,s,i,T(),A,c,l);(new u).openUrl(n,r,T(),t)});const N=e.filter(e=>3===e.ActionType);x.debug(`Found ${N.length} Javascript Actions.`),w.push({name:h.b.CommandingParameters.JavascriptActionCount,value:N.length});const O=/^\$webresource:/i;let j=N.map(e=>{const t=e.Attributes;if(t.Library&&-1!==t.Library.search(O))return x.debug(`Found JavaScript action: ${t.FunctionName} on library: ${t.Library}.`),t.Library;throw x.error(`JavaScript Action Library: ${t.Library} is not a web resource and is not supported.`),w.push({name:"IsCustomizationError",value:"true"}),w.push({name:"ScriptActionFunctionName",value:t.FunctionName}),w.push({name:"ScriptActionLibraryName",value:t.Library}),$=!0,new Error(`Invalid JavaScript Action Library: ${t.Library} is not a web resource and is not supported.`)});w.push({name:h.b.CommandingParameters.LibraryCount,value:j.length}),x.debug(`Getting dependent web resources for ${j.length} libraries.`),j=Object(d.e)(T(),j),x.debug(`Total ${j.length} libraries found including dependent web resources.`);for(let e=0;e<j.length;++e){const t=j[e];j[e]=j[e].replace(O,""),x.debug(`Resolved library: ${t} to url: ${j[e]}.`)}const D=f(Object(p.f)(j)),R=Object(C.c)(A,f,l,s);x.debug(`Loading libraries ${j.join(",")} for pageId: ${s}.`);const X=R.then(e=>e.loadWebResourcesForAllContexts(j,t.WebResourcePath,3,e=>f(Object(v.a)(e)),!t.IsServerAvailable).then(()=>{x.debug(`Finished loading ${j.length} libraries for pageId: ${s}.`)}));return L.a.addKeyPerformanceIndicatorOnIdle("Commanding.Actions.ExecuteCommand",Object(y.c)(w)),Promise.all([D,X,R]).then(e=>{const u=e[2];N.forEach(e=>{const p=e.Attributes;x.debug(`Beginning execution of action: ${p.FunctionName} of library: ${p.Library}.`);const b=e.Parameters;x.debug(`Evaluating ${b.length} parameters of action: ${p.FunctionName} of library: ${p.Library}.`),w.push({name:"ScriptActionFunctionName",value:p.FunctionName}),w.push({name:"ScriptActionLibraryName",value:p.Library});const g=new a.a,C=[];g.evaluateParameters(b,e.ActionType,t,s,i,T(),A,c,l).forEach(e=>C.push(e.value)),x.debug(`Executing action: ${p.FunctionName} of library: ${p.Library}.`);try{const e=Object(d.j)(T(),p.Library),t={sourceName:"ribbon.command"};t.eventParameters=[{name:h.b.CommandingParameters.ControlId,value:i},{name:h.b.WebResourceParameterNames.FunctionName,value:p.FunctionName},{name:h.b.WebResourceParameterNames.WebResourceName,value:null==e?void 0:e.name},{name:h.b.WebResourceParameterNames.SolutionName,value:null==e?void 0:e.solutionName},{name:h.b.WebResourceParameterNames.PublisherName,value:null==e?void 0:e.publisherName}],Object(r.b)(t,()=>{u.execute(p.FunctionName,C,!1,{webResourceName:e&&e.name,solutionName:e&&e.solutionName,solutionVersion:e&&e.solutionVersion,publisherName:e&&e.publisherName,type:"CommandExecution"}),w.push({name:"ScriptActionSolutionName",value:null==e?void 0:e.solutionName}),w.push({name:"ScriptActionPublisherName",value:null==e?void 0:e.publisherName})})}catch(e){w.push({name:"IsCustomizationError",value:"true"}),x.error(`Failed to execute action: ${p.FunctionName} of library: ${p.Library} for commandId: ${o}, commandType: ${n}, controlId: ${i}, commandManagerId: ${l}, pageId: ${s}, entityName: ${M}, selectedItems: ${P} with error: ${e.Message}.`,w);const t=new _.a("",null,null,null,null,e);throw f(Object(I.a)(s,t)),e}const v=b.findIndex(e=>17===e.ParameterType);if(v>=0){x.debug(`Found xml injection parameter for action: ${p.FunctionName} of library: ${p.Library} at index: ${v}.`);const e=C[v],t="PopulationXML";x.debug(`Injecting xml for action: ${p.FunctionName} of library: ${p.Library}.`);const n=e[t];Promise.resolve(n).then(e=>{x.debug(`Processing injected xml for action: ${p.FunctionName} of library: ${p.Library}.`);let t=null;if("string"==typeof e)try{t=new F(e).getParsedXml()}catch(t){throw x.error(`Unable to parse injected xml: ${e} for action: ${p.FunctionName} of library: ${p.Library}.`),w.push({name:"IsCustomizationError",value:"true"}),t}else t=e;t?Object(m.v)(T,f,t,M,E.l).then(t=>{x.info(`Storing injected xml: ${e} for action: ${p.FunctionName} of library: ${p.Library}.`),f(function(e,t,n){const r={injectedXML:n};return{type:m.p,payload:r,meta:{commandManagerId:e,flyoutControlId:t}}}(l,i,t))}):x.warn(`Storing injected xml skipped as menu was invalid for action: ${p.FunctionName} of library: ${p.Library}.`)})}}),x.debug("Finished executing "+S),A.EventManager.ReportComponentSuccess("Commanding.Actions.ExecuteCommand",w)})}throw new Error("Invalid RibbonCommandDefinition")}if(!b||!N)throw new Error("Invalid RibbonDescriptor or RibbonDescriptor.Commands or injected command");w.push({name:"IsInjectedCommand",value:"true"}),N.type&&N.execute?f(N):N()}catch(e){if(x.error("Command execution failed for "+S),$){const t=new _.a("",null,null,null,null,e);f(Object(I.a)(s,t)),A.EventManager.ReportComponentSuccess("Commanding.Actions.ExecuteCommand",w)}else A.EventManager.ReportComponentFailure("Commanding.Actions.ExecuteCommand",e,"Check error details to know why execution failed.",w);throw e}}}}F._MENU_TAG="Menu",F._MENUSECTION_TAG="MenuSection",F._CONTROL_TAG="Controls",F._BUTTON_TAG="Button",F._FLYOUTANCHOR_TAG="FlyoutAnchor",F._SPLITBUTTON_TAG="SplitButton",F._COMMAND_FIELD="Command",F._LABELTEXT_FIELD="LabelText",F._ID_FIELD="Id",F._MODERNIMAGE_FIELD="ModernImage",F._TITLE_FIELD="Title",F._ALT_FIELD="Alt"}}]),window.bundleExecutionMarkers["scripts/4.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();