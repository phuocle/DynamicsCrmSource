(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/legacydialogpage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[72],{a0Rm:function(e,t,n){"use strict";n.r(t),n.d(t,"LegacyDialog",(function(){return h}));var o=n("RIJJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var i=n("nuS9"),s=n("YWpA"),r=n("u+q+"),a=n("aHX0"),l=n("gQ5I"),d=n("arV0");var c=n("3rse"),p=n("FhVi"),u=n("d5N6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class m extends i.Component{constructor(e){super(e),this._postMessageHandler=this._postMessageHandler.bind(this),this._onloadHandler=this._onloadHandler.bind(this),this._keyDownHandler=this._keyDownHandler.bind(this),window.addEventListener("message",this._postMessageHandler)}_postMessageHandler(e){if(e.data){let t=null;t="string"==typeof e.data?JSON.parse(e.data):e.data,t.command===u.c||t.message===u.c?this.props.closeDialog("close"):t.command!==u.b&&t.message!==u.b||(window.parent&&t.params&&(window.parent.LegacyDialogReturnValue=t.params),this.props.closeDialog(u.b))}}_onloadHandler(e){if(this._iframe){const e=this._iframe.contentWindow.document||this._iframe.contentDocument;let t;if(e){this._iframe.contentWindow.isUciLegacyDialog="true",e.querySelector(".ms-crm-RefreshDialog-Header")&&(t=e.querySelector(".ms-crm-RefreshDialog-Header-Title")),t&&t.focus(),e.body.addEventListener("keydown",this._keyDownHandler)}const n=window.document.getElementById(u.f);n&&t&&e.getElementById(t.id)&&n.setAttribute("title",e.getElementById(t.id).innerText)}}_keyDownHandler(e){e.keyCode!==c.a.LeftArrow&&e.keyCode!==c.a.UpArrow&&e.keyCode!==c.a.RightArrow&&e.keyCode!==c.a.DownArrow&&(e.keyCode===c.a.Escape&&(e.stopImmediatePropagation(),this.props.closeDialog("close")),this._firstFocusableElement&&this._lastFocusableElement||this._getFirstAndLastElement(),e.target===this._firstFocusableElement&&e.keyCode===c.a.Tab&&e.shiftKey?(e.stopPropagation(),e.preventDefault(),this._lastFocusableElement&&this._lastFocusableElement.focus()):e.target!==this._lastFocusableElement||e.keyCode!==c.a.Tab||e.shiftKey||(e.stopPropagation(),e.preventDefault(),this._firstFocusableElement.focus()))}_getFirstAndLastElement(){let e=null;this._iframe&&(e=this._iframe.contentDocument||this._iframe.contentWindow.document),this._firstFocusableElement=this._getFirstFocusableElement(e),this._lastFocusableElement=this._getLastFocusableElement(e)}_getFirstFocusableElement(e){let t;return e&&(t=e.querySelector(".ms-crm-RefreshDialog-FirstTopButton")),e&&!t&&(t=e.getElementById(u.g)),e&&!t&&(t=e.querySelector(".ms-crm-RefreshDialog-Header-Title")),t}_getLastFocusableElement(e){let t;if(e&&(t=e.getElementById("cmdDialogClear")),e&&!t)if(e.getElementById(u.a)&&"none"!==e.getElementById(u.a).style.display)t=e.getElementById(u.a);else{let n;const o=e.querySelectorAll("#tdDialogFooter");for(let e=0;e<o.length;e++)"none"!==o[e].parentElement.style.display&&(n=o[e]);if(n&&n.lastElementChild){const e=n.lastElementChild.id;t=n.parentElement.querySelector("#"+e)}}return e&&e.getElementById("btnRemoveValue")&&(t=e.getElementById("btnRemoveValue")),t}componentDidMount(){this.props.dialogArguments&&(window.InlineDialog_childDialogArguments=this.props.dialogArguments),window.parent?window.parent.IsUCI=!0:window.IsUCI=!0,this._iframe=document.getElementById(u.f),this._iframe.addEventListener("load",this._onloadHandler)}componentWillUnmount(){if(window.removeEventListener("message",this._postMessageHandler),this._iframe.removeEventListener("load",this._onloadHandler),window.parent?window.parent.IsUCI=void 0:window.IsUCI=void 0,this._iframe){const e=this._iframe.contentWindow&&this._iframe.contentWindow.document||this._iframe.contentDocument;e&&e.body.removeEventListener("keydown",this._keyDownHandler)}}render(){const e=[];return e.push(i.createElement(p.a,{key:"legacyDialogAccessibility",rootElementId:u.e,isModal:!1,shouldManageFocus:!0,defaultFocusId:u.e,overrideFocusId:u.e})),e.push(i.createElement(a.a,{src:this.props.url,id:u.f,style:{width:"100%",height:"100%"}})),i.createElement(s.a,{style:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},i.createElement(s.a,{key:"Inline_legacyDialog",role:"dialog",id:u.e,style:{width:this.props.dialogOptions.width,height:this.props.dialogOptions.height,maxHeight:"95%",maxWidth:"95%",borderWidth:"1px",borderColor:"transparent",borderStyle:"solid"}},e))}}const g=Object(r.a)((function(){return function(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const{dialogOptions:n}=Object(d.g)(e,t.id);return n}(e,t);return{url:function(e,t){const{url:n}=Object(d.g)(e,t.id);return n}(e,t),dialogOptions:n,dialogArguments:function(e,t){const{dialogArguments:n}=Object(d.g)(e,t.id);return n}(e,t)}}}),(function(e,t){return{closeDialog:n=>{e(Object(l.e)(t.id,n))}}}))(m);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class h{constructor(e){this._id=e}getName(){return o.a}getId(){return this._id}getInitializationAction(){return this._id,{type:"legacydialog.initialize.async",execute:({dispatch:e,getState:t},n)=>Promise.resolve()}}getRootReducer(){return e=>e}getRootComponent(){return g}getCloseAction(e){return{type:"close.legacyDialogAction.async",execute({dispatch:e,getState:t}){const n=window;if(n&&n.LegacyDialogReturnValue){const e=n.LegacyDialogReturnValue;return n.LegacyDialogReturnValue=void 0,Promise.resolve(e)}return Promise.resolve()}}}}},aHX0:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o,i=n("CGM5"),s=n("HMYz"),r=n("iDZS"),a=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(t){var n=e.call(this,t)||this;return n._iframeElement=null,n._origin=null,n._onLoad=n._onLoad.bind(n),n._origin=n._normalizeUrl(t.src),n}return a(t,e),t.prototype._normalizeUrl=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad(),this.props.onReadyStateComplete&&this.props.onReadyStateComplete()},t.prototype.getElementName=function(){return"iframe"},t.prototype.getElementProps=function(){var e={src:this.props.src,title:this.props.title,onLoad:this._onLoad};return this.props.security&&(e.security=this.props.security,e.sandbox=""),this.props.scrolling&&(e.scrolling=this.props.scrolling),this.props.allow&&(e.allow=this.props.allow),this.props.name&&(e.name=this.props.name),e.ref=this._registerIframeElement.bind(this),e},t.prototype.componentWillReceiveProps=function(){this._resetEventHandlers()},t.prototype._resetEventHandlers=function(){window.removeEventListener("message",this._receiveMessageHandler,!1),this._receiveMessageHandler=null,this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(void 0)},t.prototype._registerIframeElement=function(e){this._iframeElement=e,this._iframeElement?(this._receiveMessageHandler=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessageHandler,!1),this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(this._sendMessage.bind(this))):this._resetEventHandlers()},t.prototype.componentWillUnmount=function(){this._resetEventHandlers()},t.prototype._receiveMessage=function(e){this._iframeElement&&e.source===this._iframeElement.contentWindow&&this._normalizeUrl(e.origin)===this._origin&&this.props.onMessage&&this.props.onMessage(e)},t.prototype._sendMessage=function(e){this._iframeElement&&this._iframeElement.contentWindow.postMessage(e,this._origin)},t.displayName="IFrame",t}(i.a),d=s.connect(r.a)(l)}}]),window.bundleExecutionMarkers["scripts/legacydialogpage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();