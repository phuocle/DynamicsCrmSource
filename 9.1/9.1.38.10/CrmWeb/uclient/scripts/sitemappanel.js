(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/sitemappanel.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[103],{"0U+K":function(e,t,s){"use strict";function o(e,t){const s=function(e){return[e.colors.BaseColor.Blue.Blue3,e.colors.BaseColor.Orange.Orange5,e.colors.BaseColor.Teal.Teal5,e.colors.BaseColor.Clay.Clay4,e.colors.BaseColor.Violet.Violet4,e.colors.BaseColor.Blue.Blue4,e.colors.BaseColor.Red.Red5,e.colors.BaseColor.Yellow.Yellow5,e.colors.BaseColor.Pink.Pink5,e.colors.BaseColor.Green.Green5,e.colors.BaseColor.Purple.Purple2,e.colors.BaseColor.Blue.Blue5,e.colors.BaseColor.Clay.Clay5]}(t);return s[e%s.length]}function i(e){let t="";if(e)for(let s=e.split(" "),o=0;o<s.length&&t.length<2;o++)if(s[o].length>0){const e=s[o].charCodeAt(0);if(!(e>=97&&e<=122||e>=65&&e<=90)){t+=s[o].charAt(0);break}t+=s[o].charAt(0)}return t}s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return i}))},"46jN":function(e,t,s){"use strict";s.d(t,"d",(function(){return o})),s.d(t,"l",(function(){return i})),s.d(t,"k",(function(){return n})),s.d(t,"j",(function(){return r})),s.d(t,"n",(function(){return a})),s.d(t,"i",(function(){return l})),s.d(t,"g",(function(){return c})),s.d(t,"m",(function(){return d})),s.d(t,"o",(function(){return p})),s.d(t,"c",(function(){return u})),s.d(t,"b",(function(){return h})),s.d(t,"p",(function(){return b})),s.d(t,"a",(function(){return y})),s.d(t,"h",(function(){return m})),s.d(t,"f",(function(){return f})),s.d(t,"e",(function(){return g})),s.d(t,"q",(function(){return S}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const o="Web.NavBar.Home_Title",i="Web.NavBar.Search_Title",n="Web.NavBar.Relationship_Assistant_Caption",r="Web.NavBar.Quick_Create_Menu_Caption",a="Web.NavBar.Start_Task_Flow_Caption",l="Web.NavBar.Offline_Status_Caption",c="Web.NavBar.Immersive_Skype_Caption",d="Web.NavBar.Settings_Caption",p="Web.NavBar.User_Information_Caption",u="Web.NavBar.Help_Title",h="Web.NavBar.Go_Back",b="Web.NavBar.SiteMap",y="Web.NavBar.AdvancedFind_Title",m="Monitor.Monitor.Label",f="Web.NavBar.Home_Title",g="Web.NavBar.Home_Desc",S=[o,i,n,r,a,l,"Web.NavBar.See_Welcome_Screen_Caption",c,d,p,y,m,u,"Web.NavBar.Search_Title","Web.NavBar.Search_Desc","Web.NavBar.Settings_Title","Web.NavBar.Settings_Desc","Web.NavBar.Help_Title","Web.NavBar.Help_Desc",f,g,"Web.NavBar.Relationship_Assistant_Title","Web.NavBar.Relationship_Assistant_Desc","Web.NavBar.QuickCreateMenu_Title","Web.NavBar.QuickCreateMenu_Desc","Web.NavBar.TaskFlow_Title","Web.NavBar.TaskFlow_Desc","Web.NavBar.SeeWelcomeScreen_Title","Web.NavBar.SeeWelcomeScreen_Desc","Web.NavBar.ImmersiveSkype_Title","Web.NavBar.ImmersiveSkype_Desc","Web.NavBar.User_Information_Title","Web.NavBar.User_Information_Desc","Web.NavBar.OfflineStatus_Title","Web.NavBar.OfflineStatus_Desc",h,"Web.NavBar.AdvancedFind_Title","Web.NavBar.AdvancedFind_Desc",b]},PZ34:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var o=s("ruPX"),i=s("baQL");function n(e,t){return Object(o.a)(i.a,{},t,e)}},QfU7:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));function o(e,t=10){return e.recentItems&&e.recentItems.recentItems.sort((e,t)=>t.LastAccessed-e.LastAccessed).slice(0,t)}},kn9b:function(e,t,s){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var o;s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return n})),function(e){e.LS_PUBLISHED_APPS="AppModuleLandingPage.PublishedAppsFilterText",e.LS_SEARCH_MY_APPS="AppModuleLandingPage.SearchMyApps",e.LS_NO_APPS="AppModuleLandingPage.NoApps",e.LS_MISSING_APPS_CHANGE_CRITERIA="AppModuleLandingPage.NoAppsFoundChangeSearchCriteriaText",e.LS_NO_OFFLINE_APPS="AppModuleLandingPage.NoOfflineApps",e.LS_NO_MATCHING_SEARCH="AppModuleLandingPage.NoMatchingSearch",e.LS_MY_APPS="App_Modules_SubArea_Title"}(o||(o={}));const i=[o.LS_PUBLISHED_APPS,o.LS_SEARCH_MY_APPS,o.LS_NO_APPS,o.LS_MISSING_APPS_CHANGE_CRITERIA,o.LS_NO_OFFLINE_APPS,o.LS_NO_MATCHING_SEARCH,o.LS_MY_APPS];function n(e,t){return e&&e[t]?e[t]:t}},lq5R:function(e,t,s){"use strict";s.r(t),s.d(t,"_SitemapPanel",(function(){return Nt})),s.d(t,"SitemapPanel",(function(){return Ft})),s.d(t,"mapDispatchToProps",(function(){return Bt})),s.d(t,"makeMapStateToProps",(function(){return Tt})),s.d(t,"sitemapPanelActionInspector",(function(){return jt})),s.d(t,"SessionPanel",(function(){return Xt})),s.d(t,"SitemapRecentsFlyout",(function(){return os}));var o=s("nuS9"),i=s("4fxQ"),n=s("YWpA"),r=s("u+q+"),a=s("2FbK"),l=s("Afz2"),c=s("nJrx"),d=s("evW+"),p=s("7HpW"),u=s("H/hG"),h=s("znb3"),b=s("XIN1"),y=s("3rse"),m=s("3mNF"),f=s("RiHV"),g=s("1AYO"),S=s("Smta"),w=s("gvL4"),_=s("q43A"),v=s("IqkD"),I=s("unFF"),E=s("SocB"),C=s("ws6F"),k=s("YxC/"),M=s("GPkz"),A=s("tJ+6"),x=s("d6Hx");function R(e,t){const s=e?e.Components.Navigation.Rest.BackgroundColor:t.colors.BaseColor.Grey.Grey3,o=e?e.Components.Navigation.Rest.TextColor:t.colors.BaseColor.Grey.Grey1;return Object(_.e)({color:Object(E.e)(o),cursor:"pointer",display:"flex",flexDirection:"row"},s)}function O(e,t,s){return{cursor:"default",marginLeft:s?"0px":t.sizes.Measures.Measure300,marginRight:s?t.sizes.Measures.Measure300:"0px",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,color:e?e.Components.Navigation.Selected.TextColor:t.colors.BaseColor.Grey.Grey7,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"flex",flexDirection:"row"}}function N(e,t){return{color:e?e.Components.Navigation.Selected.TextColor:void 0,whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontSize:t.fontSizes.Font100,fontFamily:t.fontFamilies.Normal,height:t.sizes.Measures.Measure250,lineHeight:t.sizes.Measures.Measure250,display:"inline-block",alignItems:"center"}}function T(e){M.a.flyOutEnter()}function B(e){M.a.exitFlyOut()}const F=Object(r.a)((function(){return function(e,t){const s=Object(I.a)(e),o=Object(v.g)(e);return{theme:s,designLanguage:Object(A.b)(e)?Object(A.a)(e):null,isRTL:o}}}))((function(e){const t={onMouseLeave:B,onMouseEnter:T};return o.createElement(g.a,Object.assign({key:"flyout",positionType:"relative",relativeToElementId:e.relativeToElementId,flyoutDirection:e.flyoutDirection,flyoutStyle:(s=e.designLanguage,i=e.theme,r=e.flyoutWidth,{backgroundColor:s?s.Components.Navigation.Selected.BackgroundColor:i.colors.BaseColor.White,boxShadow:"0px 8px 10px rgba(0,0,0,0.1)",maxHeight:"23.75em",overFlowY:"auto",width:r,display:"flex",flexDirection:"column"}),onOutsideClick:t=>function(e,t){const s=t.target,o=document.getElementById("areaSwitcherId");s&&!o.contains(s)&&o!==s&&e.closeFlyout()}(e,t),id:e.id,testhooks:{[f.a.LearningPathDOMAttributeSuffix]:"sitemap-area-switcher-flyout"}},t),o.createElement(n.a,null,o.createElement(u.a,{style:O(e.designLanguage,e.theme,e.isRTL),role:l.r},Object(k.c)(e.resourceStrings,C.h))),o.createElement(w.a,{onKeyDown:e.keyDownHandler,ref:m.c,role:l.l,accessibilityLabel:Object(k.c)(e.resourceStrings,C.h)},function(e,t,s){return(t=t.filter(e=>e.Id!==x.d))&&t.length?t.map((t,i)=>{return o.createElement(S.a,{key:i,style:R(e.designLanguage,e.theme),tabIndex:-1,accessibilityChecked:s===t.Id,role:l.o,testhooks:{id:"areaswitcherflyout-"+t.Id,[f.a.LearningPathDOMAttributeSuffix]:"sitemap-areaswitcherflyout-"+t.Id},onClick:s=>{e.selectArea(t.Id),e.closeFlyout(s)}},o.createElement(u.a,{style:(n=e.designLanguage,r=e.theme,{color:n?n.Components.Navigation.Selected.IconColor:void 0,fontFamily:"CRM MDL2",fontSize:"16px",width:"16px",minWidth:"16px",height:r.sizes.Measures.Measure250,lineHeight:r.sizes.Measures.Measure250,marginLeft:r.sizes.Measures.Measure100,display:"flex",alignItems:"center"})},s===t.Id?o.createElement(b.b,{type:h.a.CheckMark}):null),o.createElement(u.a,{title:t.Titles[0].Title,style:N(e.designLanguage,e.theme)},t.Titles[0].Title));var n,r}):[]}(e,e.siteMapItems,e.selectedAreaId)));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var s,i,r}));var D=s("qu3G"),L=s("0U+K");function j(e,t){return{textAlign:"center",justifyContent:"center",textTransform:"uppercase",fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:"12px",lineHeight:t.sizes.Measures.Measure175,width:t.sizes.Measures.Measure200,height:t.sizes.Measures.Measure200,borderRadius:"2px",border:"none",color:e?e.Components.Navigation.Rest.Hover.IconColor:t.colors.BaseColor.White}}function P(e,t,s){return{height:t.sizes.Measures.Measure200,fontFamily:t.fontFamilies.Weighted,fontWeight:t.sizes.FontWeights.Semibold,fontSize:t.sizes.Measures.Measure100,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.TextColor:t.colors.BaseColor.Grey.Grey7,textAlign:s?"right":"left",marginLeft:s?"0px":t.sizes.Measures.Measure050,marginRight:s?t.sizes.Measures.Measure050:"0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden",flexGrow:1}}function H(e,t,s){return{fontSize:"16px",lineSize:"19px",alignContent:"flex-end",width:"16px",height:t.sizes.Measures.Measure200,lineHeight:t.sizes.Measures.Measure200,color:e?e.Components.Navigation.Rest.IconColor:t.colors.BaseColor.Grey.Grey7,marginRight:s?"0px":"6px",marginLeft:s?"6px":"0px"}}const K={flexShrink:0};class z extends o.Component{constructor(e){super(e),this._areaSwitcherFlyoutId=Object(c.a)(),this._areaSwitcherButtonRef=null,this._getAreaSwitcherButtonRef=this._getAreaSwitcherButtonRef.bind(this),this._toggleAreaSwitcherFlyout=this._toggleAreaSwitcherFlyout.bind(this),this.keyDownHandler=this.keyDownHandler.bind(this),this.state={}}_toggleAreaSwitcherFlyout(){this.setState({isAreaSwitcherFlyoutVisible:!this.state.isAreaSwitcherFlyoutVisible}),M.a.session&&(this.state.isAreaSwitcherFlyoutVisible?(M.a.exitFlyOut(),M.a.session.addEvent(D.a.collapseAreaSwitcher)):(M.a.flyOutEnter(),M.a.session.addEvent(D.a.expandAreaSwitcher)))}_getAreaSwitcherButtonRef(e){this._areaSwitcherButtonRef=e}keyDownHandler(e){Object(m.b)(e)||this.setState({isAreaSwitcherFlyoutVisible:!1}),e.keyCode!==y.a.Enter&&e.keyCode!==y.a.Escape||requestAnimationFrame(()=>{this._areaSwitcherButtonRef&&this._focusOnAreaSwitcher()})}_focusOnAreaSwitcher(){const e=i.findDOMNode(this._areaSwitcherButtonRef);e&&e.focus()}_renderAreaSwitcher(){if(!this.props.selectedAreaId)return null;const e=Object(p.a)(this.props.siteMap),t=o.createElement(F,{id:this._areaSwitcherFlyoutId,siteMapItems:e,flyoutDirection:0===this.props.panelState?this.props.isRTL?g.b.left:g.b.right:g.b.up,selectArea:this.props.selectArea,selectedAreaId:this.props.selectedAreaId,relativeToElementId:"areaSwitcherContainer",closeFlyout:this._toggleAreaSwitcherFlyout,keyDownHandler:this.keyDownHandler,resourceStrings:this.props.resourceStrings,flyoutWidth:this.props.flyoutWidth});let s,i;const r=this.props.designLanguage;for(let t=0;t<e.length;t++)this.props.selectedAreaId===e[t].Id&&(s=e[t].Titles[0].Title,i=Object.assign(Object.assign({},j(r,this.props.theme)),{backgroundColor:Object(L.a)(t,this.props.theme)}));const a=Object.assign(Object.assign({},{backgroundColor:"transparent",borderStyle:"none",cursor:"pointer",display:"flex",alignItems:"center",margin:(c=this.props.theme).sizes.Measures.Measure050+" 8px",flexDirection:"row",justifyContent:"flex-start",height:c.sizes.Measures.Measure200,padding:0,borderRadius:"3px",width:"100%",overflow:"hidden"}),{":hover":this.state.isAreaSwitcherFlyoutVisible?null:{backgroundColor:r?r.Components.Navigation.Rest.Hover.BackgroundColor:this.props.theme.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)"}});var c;const y=String.format(Object(k.c)(this.props.resourceStrings,C.i),s);return o.createElement(n.a,{key:"expand-options",style:K,id:"areaSwitcherContainer",role:l.r},o.createElement(d.a,{key:"expand-options-button",title:y,accessibilityLabel:y,onClick:this._toggleAreaSwitcherFlyout,style:a,id:"areaSwitcherId",accessibilityExpanded:!!this.state.isAreaSwitcherFlyoutVisible,accessibilityHasPopup:!0,ref:this._getAreaSwitcherButtonRef,testhooks:{id:"sitemap-areaSwitcher-expand-btn",[f.a.LearningPathDOMAttributeSuffix]:"sitemap-areaSwitcher-expand-btn"}},o.createElement(n.a,{style:{display:"flex"}},o.createElement(n.a,{semanticTag:"span",style:i},Object(L.b)(s))),0===this.props.panelState?null:o.createElement(u.a,{style:P(r,this.props.theme,this.props.isRTL)}," ",s),0===this.props.panelState?null:o.createElement(u.a,{key:"down-chevron",style:H(r,this.props.theme,this.props.isRTL)},o.createElement(b.b,{type:h.a.ScrollUpDown}))),this.state.isAreaSwitcherFlyoutVisible?t:null)}render(){if(this.props.siteMap&&this.props.siteMap.AreaIds.length<2)return null;const e=this.props.designLanguage,t=e?e.Components.Navigation.Selected.BackgroundColor:this.props.theme.colors.BaseColor.White,s=e?e.Components.Navigation.Rest.BackgroundColor:this.props.theme.colors.BaseColor.Grey.Grey1,i=Object.assign(Object.assign({},
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const s=e?e.Components.Navigation.Rest.Focus.BorderColor:t.colors.BaseColor.Grey.Grey3;return{width:"100%",height:t.sizes.Measures.Measure100,display:"block",minHeight:t.sizes.NavButtonHeight,borderTop:"1px solid "+s}}(e,this.props.theme)),{backgroundColor:this.state.isAreaSwitcherFlyoutVisible?t:s});return o.createElement(n.a,{style:i,role:l.r},this._renderAreaSwitcher())}}var W=s("dIye"),G=s("uTTW"),U=s("D+Bz"),Q=s("fWyz"),q=s("sZ+8"),V=s("Xi8U"),Y=s("n/MI"),Z=s("j+uO"),X=s("7sMj"),$=s("oLPm"),J=s("VnpK");function ee(e){const t=Object(I.a)(e);return{entryWrap:{flexGrow:1,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionWrapStyle:{position:"relative",left:"0px",right:"0px",flexGrow:0,flexShrink:0},entrySubActionIconStyles:{fontSize:t.fontSizes.Font125},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:t.colors.SiteMap.RefreshedBarItemIcon,alignItems:"center"}}}function te(e,t,s,o){const i=t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,n=t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text;return{display:"flex",width:"100%",height:e.sizes.Measures.Measure250,justifyContent:"space-between",paddingLeft:o?e.sizes.Measures.Measure100:"8px",paddingRight:o?"8px":e.sizes.Measures.Measure100,":hover":{backgroundColor:i,color:n,position:"relative",transition:"background-color 200ms",zIndex:1}}}function se(e,t,s,o){const i={width:"100%",display:"flex",alignItems:"center",cursor:"pointer",color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted "+(t?t.Components.Navigation.Rest.Focus.BorderColor:"white")},":focus > :first-child > :first-child":{visibility:"visible"},":hover > :first-child > :first-child":{visibility:"visible"}};if(o&&o.isMouseOnRow){const s={":hover":{backgroundColor:t?t.Components.Navigation.Rest.Hover.BackgroundColor:e.colors.SiteMap.RefreshedRow.Fill,color:t?t.Components.Navigation.Rest.Hover.TextColor:e.colors.SiteMap.RefreshedRow.Text,position:"relative",transition:"background-color 200ms",zIndex:1}};return Object.assign(Object.assign({},i),s)}return i}function oe(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t?0:"8px",marginRight:t?"8px":0,fontFamily:e.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}function ie(e,t){const s=t.colors.SiteMap.EntityOfflineStatusIcon;return{fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",lineHeight:"16px",marginLeft:"auto",width:t.sizes.SiteMap.EntityOfflineStatusIconWidth,color:e===q.a.Enabled?s.Enabled:s.Disabled,fontSize:t.fontSizes.SiteMapOfflineStatusIcon,flexShrink:0}}function ne(e,t){return{display:"flex",paddingLeft:0,justifyContent:"space-between",height:e.sizes.Measures.Measure250,alignItems:"center",overflowX:"hidden",flex:"auto"}}var re=s("QBtP"),ae=s("cz9j"),le=s("H4dV"),ce=s("3cEW"),de=s("AVDU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class pe extends o.Component{constructor(e,t){if(super(e),this._onSubActionClickHandler=this._onSubActionClickHandler.bind(this),this._onClickHandler=this._onClickHandler.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onMouseLeave=this._onMouseLeave.bind(this),this._onSubActionButtonMouseEnter=this._onSubActionButtonMouseEnter.bind(this),this._onSubActionButtonMouseLeave=this._onSubActionButtonMouseLeave.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this),this.onSubAtionKeyDownHandler=this.onSubAtionKeyDownHandler.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._toggleSitemap=this._toggleSitemap.bind(this),this.state={isMouseOnRow:!1,isMouseOnButton:!1,isKeyboardFocused:!1},this._traceManager=t.TraceManager,!this._traceManager)throw new Error("TraceManager is null")}_toggleSitemap(){this.props.isSitemapInFlyout&&this.props.toggleSitemap()}_onClickHandler(e=null){e&&e.stopPropagation(),this.props.execute(this.props.entry.onClickHandler(!0,this._toggleSitemap,U.b.SiteMap,Q.d))}_onMouseEnter(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnRow:!0}))}_onMouseLeave(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnRow:!1}))}_onFocus(e){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId),e.preventDefault(),e.stopPropagation()}_onBlur(e){e.target!==i.findDOMNode(this._subButtonRef)&&this.setState({isKeyboardFocused:!1})}_onSubActionButtonMouseEnter(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnButton:!0}))}_onSubActionButtonMouseLeave(e=null){this.setState((e,t)=>Object.assign(Object.assign({},e),{isMouseOnButton:!1}))}_focusOnRootElement(){const e=this.props.sitemapRowId;if(e){let t=document.getElementById(e);const s=!t.nextSibling;window.setTimeout(()=>{s&&(t=document.getElementById(e)),t&&t.parentElement.parentElement.parentElement.focus()})}}onKeyDownHandler(e){const t=e.target;switch(Object(ae.e)(e.nativeEvent)){case y.a.Enter:e.stopPropagation(),e.preventDefault(),this._onClickHandler();break;case y.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case y.a.UpArrow:t&&!t.previousElementSibling&&t.parentElement&&t.parentElement.parentElement&&t.parentElement.parentElement.parentElement&&(t.parentElement.parentElement.parentElement.focus(),e.stopPropagation(),e.preventDefault());break;case y.a.LeftArrow:case y.a.RightArrow:e.stopPropagation(),e.preventDefault();const s=i.findDOMNode(this._subButtonRef);s&&s.focus()}}onSubAtionKeyDownHandler(e){switch(Object(ae.e)(e.nativeEvent)){case y.a.Enter:case y.a.Space:e.stopPropagation(),e.preventDefault(),this._onSubActionClickHandler();break;case y.a.LeftArrow:case y.a.RightArrow:case y.a.UpArrow:case y.a.DownArrow:e.stopPropagation(),e.preventDefault();const t=i.findDOMNode(this._itemRef);t&&t.focus()}}_onSubActionClickHandler(e=null){e&&e.stopPropagation();const t=this.props.entry.subActionDescriptor.onClickHandler;t&&this.props.execute(t()),this._focusOnRootElement()}render(){const{entry:e,theme:t,customStyles:s,isTabIndexZero:i,describedByElementId:r}=this.props;if(!e)return this._traceManager.getTracer(x.l).error("SubAreaDescriptor passed in to SitemapPinnableRow is null",[{name:"describedByElementId",value:r}]),null;const a=s.entryWrap;let l,c=oe(t,this.props.isRTL),d=!1;e instanceof Y.e&&(c=Object.assign(Object.assign({},oe(t,this.props.isRTL)),s.entryTitleStyle),d=!0,l=e.pinStatus);let p=e.title;const{subActionDescriptor:h}=e;if(void 0===l)p=h&&h.narratorTitle&&String.format(h.narratorTitle,e.title);else{const t=l?Object(k.c)(this.props.resourceStrings,C.m):Object(k.c)(this.props.resourceStrings,C.x);p=String.format(t,e.title)}let b=null;h&&h.dropdownInfo&&(b=h.dropdownInfo.isOpened);const y=!le.a.getInstance().get_IsIOS(),m=this.props.designLanguage;return o.createElement(S.a,{key:"sitemap-sitemapAreaEntry-listItem",style:se(this.props.theme,m,0,this.state),onClick:this._onClickHandler,accessibilityLabel:p,title:e.title,dataText:e.title,tabIndex:i?0:-1,onKeyDown:this.onKeyDownHandler,onFocus:this._onFocus,onBlur:this._onBlur,id:this.props.sitemapRowId,testhooks:{id:this.props.sitemapRowId,[f.a.LearningPathDOMAttributeSuffix]:"sitemap-entity-"+e.id},describedByElementId:r,accessibilityExpanded:b,ref:e=>this._itemRef=e},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,style:this._addContrastRule(te(this.props.theme,m,this.state,this.props.isRTL),e,this.props.theme,!0)},this._renderSubAction(this.props.theme,m,this.state),o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:ne(this.props.theme,this.props.isRTL),accessibilityHidden:y},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:a},o.createElement(u.a,{key:"sitemap-sitemapAreaEntry-text",style:c},e.title)),this._renderOfflineStatusIcon(d,e.title))),this._getNarratorElement(r,h))}_getNarratorElement(e,t){return e&&""!==e?o.createElement(u.a,{key:e,id:e,style:{display:"none"},accessibilityLabel:t&&t.subactionAccessibilityLabel||""}," ",t&&t.subactionAccessibilityLabel||""," "):null}_getIcon(e,t){if(e)switch(e.type){case b.b:return o.createElement(b.b,{type:Number(e.value),style:t});case G.a:return o.createElement(Z.a,{source:e.value,style:t,highContrast:this.props.isHighContrast,useImgInIE:!0});case X.a:return o.createElement(X.a,{entityReference:e.entityReference,hasPrimaryImageField:e.hasPrimaryImageField,imageSrc:e.imageSrc,accessibilityHidden:!0,entityPrimaryField:e.entityPrimaryField,customEntityIcon:e.customEntityIcon,style:this.props.customStyles.entryImageStyle});case"CssIcon":const s=Object.assign(Object.assign({},e.value),t);return o.createElement(u.a,{style:s});case null:return e.value}}_renderOfflineStatusIcon(e,t){const s=this.props.entityOfflineStatus;if(s===q.a.NotAvailable||e)return null;let i="",n="";return s===q.a.Enabled?(i=Object(k.c)(this.props.resourceStrings,$.b),n=t+"-"+$.b):(i=Object(k.c)(this.props.resourceStrings,$.g),n=t+"-"+$.g),o.createElement(u.a,{key:"sitemap-offlineStatus-icon",style:ie(s,this.props.theme),accessibilityLabel:i,testhooks:{id:n}},W.b[q.a[s]])}_renderSubAction(e,t,s){const i=this.props,{entry:r}=i;let a=null;const l=s&&s.isMouseOnButton,c=i.customStyles.entrySubActionIconStyles;let p=i.customStyles.entrySubActionButtonStyle;if(l){const s={":hover":{backgroundColor:t?t.Components.Navigation.Rest.BackgroundColor:e.colors.SiteMap.RefreshedPinUnpinFill}};p=Object.assign(Object.assign({},i.customStyles.entrySubActionButtonStyle),s)}if(a=Object.assign(Object.assign({},i.customStyles.entrySubActionWrapStyle),{visibility:this.state.isKeyboardFocused?"visible":"hidden"}),!r.subActionDescriptor)return o.createElement(n.a,{style:a},o.createElement(d.a,{style:p,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,tabIndex:-1},o.createElement(u.a,{style:c},this._renderSubActionIcon())));let h=null;return r.subActionDescriptor.dropdownInfo&&(h=r.subActionDescriptor.dropdownInfo.isOpened),o.createElement(n.a,{style:a},o.createElement(d.a,{onClick:this._onSubActionClickHandler,style:p,onMouseEnter:this._onSubActionButtonMouseEnter,onMouseLeave:this._onSubActionButtonMouseLeave,onKeyDown:this.onSubAtionKeyDownHandler,ref:e=>this._subButtonRef=e,tabIndex:-1,testhooks:{id:"sitemap-area-entry-subaction-btn"},accessibilityLabel:r.subActionDescriptor.narratorTitle,describedByElementId:this.props.sitemapRowId,accessibilityExpanded:h,title:r.subActionDescriptor.narratorTitle},o.createElement(u.a,{style:c},this._renderSubActionIcon())))}_renderSubActionIcon(){const e=this.props,{entry:t}=e,s=function(e){let t="16px";return e.subActionDescriptor&&!e.subActionDescriptor.dropdownInfo||(t="12px"),{width:t,height:t,fontSize:t,paddingRight:"0px"}}(t);if(!t.subActionDescriptor){const e={type:b.b,value:"200"};return this._getIcon(e,s)}return this._getIcon(t.subActionDescriptor.icon,s)}_addContrastRule(e,t,s,o){const i=t.icon.type;if(!i||i!==G.a||this.props.isHighContrast)return e;const n=o?s.colors.NavBar.NavBar1.Fill.toString():s.colors.QuickLaunchBar;return Object(_.c)(e,n,o,s.colors.SiteMap.RefreshedGroupText)}}pe.contextType=re.a;const ue=Object(r.a)(()=>{let e=null,t=null;return(s,o)=>{const i=o?o.entry:null,n=i?Object(q.e)(s,i.entityTypeName):q.a.NotAvailable,r=!e||null===t,a=n===t,l=Object(de.e)(s),c=Object(A.b)(s)?Object(A.a)(s):null;return!r&&a||(t=n,e={theme:Object(I.a)(s),designLanguage:c,customStyles:ee(s),entityOfflineStatus:n,resourceStrings:Object(k.e)(s,[$.b,$.g,C.l,C.m,C.x]),isRTL:Object(v.g)(s),isHighContrast:Object(J.n)(),isSitemapInFlyout:l}),e}},(function(e){return{execute:t=>{e(t)},toggleSitemap:()=>{e(Object(ce.b)())}}}))(pe);var he=s("SAYH"),be=s("QfU7"),ye=s("YcFo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function me(e){return e?"sitemap-entity-"+e.id:""}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function fe(e,t,s){const o=t&&t.length?t.length:null;let i=s?"auto":"0px";return s&&o&&(i=`calc(${o} * ${e.sizes.Measures.Measure250})`),{overflow:"hidden",height:i,width:"100%",paddingTop:1,paddingBottom:1,transitionProperty:"height",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(0.16,0.67,0.12,0.99)",transitionDelay:"0ms"}}function ge(e){return{display:"inline-block",fontSize:"1rem",color:e.colors.BaseColor.Grey.Grey5,marginLeft:e.sizes.Measures.Measure100,marginRight:e.sizes.Measures.Measure100,marginTop:e.sizes.Measures.Measure050,fontFamily:e.fontFamilies.Regular}}class Se extends o.Component{constructor(e){super(e),this._noItemsId=Se._NO_ITEMS_ID_PART+e.relativeToEntryId;const t=he.a.newGuid().guid;this._describeAreaId="sitemap-sitemapDropDown-group-"+t.toString()+"-narrator",this.keyDownHandler=this.keyDownHandler.bind(this)}keyDownHandler(e){const t=e.target;if(t)switch(Object(ae.e)(e.nativeEvent)){case y.a.DownArrow:e.stopPropagation(),e.preventDefault();const s=t.nextElementSibling;s&&s.focus();break;case y.a.UpArrow:e.stopPropagation(),e.preventDefault();const o=t.previousElementSibling;o&&o.focus();break;case y.a.Home:if(t.parentElement){e.stopPropagation(),e.preventDefault();const s=t.parentElement.firstElementChild;s&&s.focus()}break;case y.a.End:if(t.parentElement){e.stopPropagation(),e.preventDefault();const s=t.parentElement.lastElementChild;s&&s.focus()}}}_renderSitemapDropdown(e){if(!e)return null;const{theme:t,accessibilityLabel:s,dropdownRecents:i}=this.props;if(!i||0===i.length){const e=this.props.relativeToEntryId===ye.c?Object(k.c)(this.props.resourceStrings,C.k):String.format(Object(k.c)(this.props.resourceStrings,C.j),Object(k.c)(this.props.resourceStrings,C.s));return o.createElement(S.a,{key:Se._NO_ITEMS_LISTITEM_KEY,style:{width:"100%",display:"flex",cursor:"pointer",backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"initial"},":focus > :first-child":{outline:"1px dotted white"}},role:l.r},o.createElement(u.a,{key:this._noItemsId,testhooks:{id:this._noItemsId},style:ge(t),role:l.r},e))}return o.createElement(w.a,{key:"sitemap-sitemapDropDown-"+this.props.parentEntryId,style:{overflow:"hidden",listStyleType:"none",display:"block",width:"100%","> li > *":{boxSizing:"border-box"}},accessibilityLabel:s},this._renderRecentItems(i))}_renderRecentItems(e){return e.map((e,t)=>{const s=me(e);return o.createElement(ue,{key:t,entry:e,isTabIndexZero:!!this.props.isNewSitemapKeyboardMode&&this.props.focusedRowId===s,describedByElementId:0===t?this._describeAreaId:"",sitemapRowId:s,onKeyboardFocus:this.props.onKeyboardFocus})})}render(){const e=this.props.dropdownOpened&&this.props.parentEntryId===this.props.relativeToEntryId;return o.createElement(n.a,{style:fe(this.props.theme,this.props.dropdownRecents,e),onKeyDown:this.props.isNewSitemapKeyboardMode?void 0:this.keyDownHandler},this._renderSitemapDropdown(e))}}Se._NO_ITEMS_ID_PART="sitemap-sitemapdropdown-noitems-",Se._NO_ITEMS_LISTITEM_KEY=Se._NO_ITEMS_ID_PART+"-listItem",Se.displayName="SitemapRecentsDropdown";const we=Object(r.a)((function(){let e=null;return t=>{let s,o;const i=Object(V.c)(t),n=i&&i.isOpened;if(n){s=i.relativeToEntryId;let e=null;i.relativeToEntryId===ye.c?e=Object(be.a)(t):i.relativeToEntryId===ye.a&&(e=Object(V.g)(t)),o=e?e.map(e=>Y.e.FromStateItem(e,!0,t)):[]}if(e){if(!n&&!e.dropdownOpened)return e;if(s===e.relativeToEntryId&&o.length===e.dropdownRecents.length){if(o.every((t,s)=>t.title===e.dropdownRecents[s].title&&t.pinStatus===e.dropdownRecents[s].pinStatus))return e}}return e={theme:Object(I.a)(t),dropdownOpened:n,relativeToEntryId:s,dropdownRecents:o,resourceStrings:Object(k.e)(t,[C.s,C.k,C.j])},e}}))(Se);var _e=s("zVFX");function ve(e,t){const s=e?e.Components.Navigation.Rest.IconColor:t.colors.SiteMap.RefreshedBarItemIcon;return{entryWrap:{flexGrow:1,overflow:"hidden",alignItems:"center",alignSelf:"stretch"},entryIconStyle:{width:t.sizes.Measures.Measure150},entryImageStyle:{textAlign:"center",fontWeight:"bold",fontSize:t.sizes.Measures.Measure075,lineHeight:t.sizes.Measures.Measure150,fontFamily:t.fontFamilies.Normal,width:t.sizes.Measures.Measure150,height:t.sizes.Measures.Measure150,borderRadius:"50%",color:t.colors.BaseColor.White},entryTitleStyle:{width:"inherit",overflow:"hidden"},entrySubActionIconStyles:{fontSize:t.fontSizes.Font150},entrySubActionButtonStyle:{borderStyle:"none",backgroundColor:"transparent",color:s,alignItems:"center",paddingLeft:"0px",paddingRight:"0px"}}}function Ie(e,t,s){if(s){const s=e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,o=e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill;return{display:"flex",width:"100%",height:t.sizes.Measures.Measure250,minHeight:t.sizes.Measures.Measure250,color:s,backgroundColor:o,justifyContent:"space-between",":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const o=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,i=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill,n=e?e.Components.Navigation.Rest.Hover.TextColor:o;return{display:"flex",width:"100%",height:t.sizes.Measures.Measure250,minHeight:t.sizes.Measures.Measure250,color:o,justifyContent:"space-between",":hover":{color:n,backgroundColor:i,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}function Ee(e,t){const s=e?e.Components.Navigation.Rest.Hover.TextColor:t.colors.SiteMap.RefreshedRow.Text,o=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.BaseColor.White,i=e?e.Components.Navigation.Rest.Focus.BorderColor:t.colors.BaseColor.Grey.Grey5;return{width:"16rem",minHeight:"35px",display:"flex",alignItems:"center",cursor:"pointer",color:s,backgroundColor:o,boxShadow:_e.a.shadows.Shadow01,flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+i,outlineOffset:"-1px"}}}function Ce(e,t,s){const o=s.colors.SiteMap.EntityOfflineStatusIcon;return{fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",lineHeight:"16px",marginLeft:"auto",width:s.sizes.SiteMap.EntityOfflineStatusIconWidth,color:t===q.a.Enabled?o.Enabled:o.Disabled,fontSize:s.fontSizes.SiteMapOfflineStatusIcon,flexShrink:0}}function ke(e,t,s){return{display:"flex",paddingLeft:s?0:t.sizes.Measures.Measure025,paddingRight:s?t.sizes.Measures.Measure025:0,justifyContent:"space-between",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"}}function Me(e,t,s,o){const i=e?e.Components.Navigation.Selected.PivotColor:"#0066FF",n=e?i:t.borders.Border06;return{display:"inline-block",height:t.sizes.Measures.Measure150,marginLeft:s?"6.5px":"none",marginRight:s?"none":"6.5px",borderLeft:n,borderRight:n,borderRadius:t.borders.Border06Radius,opacity:o?1:0,transition:"opacity 200ms;",backgroundColor:i}}function Ae(e,t,s){if(s){const s=e?e.Components.Navigation.Selected.TextColor:t.colors.SiteMap.RefreshedGroupText,o=e?e.Components.Navigation.Selected.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString();return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:s,backgroundColor:o,":hover":{boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const o=e?e.Components.Navigation.Rest.TextColor:t.colors.SiteMap.RefreshedGroupText,i=e?e.Components.Navigation.Rest.Hover.BackgroundColor:t.colors.SiteMap.RefreshedRow.Fill.toString(),n=e?e.Components.Navigation.Rest.Hover.TextColor:t.colors.SiteMap.RefreshedGroupText;return{width:t.sizes.SiteMap.RefreshedWidthCollapsed,height:t.sizes.Measures.Measure250,cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center",color:o,backgroundColor:"transparent",":hover":{color:n,backgroundColor:i,boxShadow:t.shadows.Shadow02,position:"relative",transition:"background-color 200ms"}}}const xe={display:"flex",width:"100%",justifyContent:"space-between"},Re={flexGrow:0,overflowX:"hidden",alignItems:"center",alignSelf:"stretch"};var Oe=s("WKLO"),Ne=s("EY5k"),Te=s("wRZP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Be={width:"100%",height:"100%",justifyContent:"center",alignItems:"center",margin:"auto"},Fe={fontSize:"14px",height:21};function De(e,t){const s=t?"paddingRight":"paddingLeft";return{fontFamily:"CRM MDL2",fontSize:"14px",width:"16px",height:e.sizes.Measures.Measure150,display:"flex",alignItems:"center",[s]:5}}function Le(e,t){const s={display:"block",cursor:"pointer",backgroundColor:"transparent",height:42,width:80,borderStyle:"none",flexShrink:0,":hover":{"> div":{backgroundColor:e.colors.BaseColor.White,boxShadow:"0px 4px 8px rgba(0,0,0,0.1)",borderRadius:"2px"}},padding:6,color:"#2266E3",fontWeight:400};return t&&Object.assign(s,t),s}class je extends o.Component{constructor(e,t){super(e),this._onClickHandler=this._onClickHandler.bind(this),this._onKeyDownHander=this._onKeyDownHander.bind(this),C.w.some(t=>!Object(k.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(C.w)}_onClickHandler(e){this.props.openAppsDialog(),e.preventDefault(),e.stopPropagation()}_onKeyDownHander(e){e.keyCode!==y.a.Enter&&e.keyCode!==y.a.Space||e.target.click()}render(){const e=Object(k.c)(this.props.resourceStrings,C.b),t=Object(k.c)(this.props.resourceStrings,C.a);return o.createElement(d.a,{id:x.g,style:Le(this.props.theme,this.props.overwriteStyle),onClick:this._onClickHandler,onKeyDown:this._onKeyDownHander,accessibilityLabel:e,title:e},o.createElement(n.a,{style:Be},o.createElement(u.a,{style:Fe},t),o.createElement(u.a,{style:De(this.props.theme,this.props.isRTL)},o.createElement(b.b,{type:this.props.isRTL?h.a.BackButtonWithoutBorder:h.a.Forward}))))}}je.contextType=re.b;const Pe=Object(r.a)((function(){const e=Object(k.h)();return t=>{const s=e(t,C.w);return{theme:Object(I.a)(t),resourceStrings:s,isRTL:Object(v.g)(t)}}}),(function(e){return{retrieveResourceStrings:t=>e(Object(Ne.e)(t)),openAppsDialog:()=>e(Object(Te.b)())}}))(je);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class He extends o.Component{constructor(e,t){super(e),this._tracer=null,this._tracer=t.TraceManager.getTracer(x.l),this.state={isKeyboardFocused:!1,forceHideTooltip:!1},this._onKeyboardFocus=this._onKeyboardFocus.bind(this),this._onKeyboardBlur=this._onKeyboardBlur.bind(this),this._onPointerEnter=this._onPointerEnter.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this._onKeyDownHandler=this._onKeyDownHandler.bind(this),this._onClickHandler=this._onClickHandler.bind(this),this._onSubActionClickHandler=this._onSubActionClickHandler.bind(this),this._closeSitemapDuringNavigation=this._closeSitemapDuringNavigation.bind(this)}render(){return 0===this.props.panelState?this._renderRowForCollapsedSitemap():this._renderRowForExtendedSitemap()}_closeSitemapDuringNavigation(){this.props.isSitemapInFlyout&&this.props.toggleSiteMap()}_onClickHandler(e=null){e&&e.stopPropagation(),this.props.execute(this.props.entry.onClickHandler(!0,()=>this._closeSitemapDuringNavigation(),U.b.SiteMapSubArea,Q.c))}_onPointerEnter(){this.props.onPointerEnter&&this.props.onPointerEnter(this.props.entry.id)}_onPointerLeave(){this.props.onPointerLeave&&this.props.onPointerLeave(this.props.entry.id)}_onKeyboardFocus(){this.setState({isKeyboardFocused:!0}),this.props.onKeyboardFocus&&this.props.onKeyboardFocus(this.props.sitemapRowId)}_onKeyboardBlur(e){this.setState({forceHideTooltip:!1,isKeyboardFocused:!1})}_focus(){const e=this.props.sitemapRowId;if(this.props.sitemapRowId){let t=document.getElementById(e);const s=!t.nextSibling;window.setTimeout(()=>{s&&(t=document.getElementById(e)),t&&t.focus()})}}_onKeyDownHandler(e){const t=e.target;switch(Object(ae.e)(e.nativeEvent)){case y.a.Enter:e.stopPropagation(),e.preventDefault(),this._onClickHandler();break;case y.a.Space:e.stopPropagation(),e.preventDefault(),this.props.entry.subActionDescriptor?this._onSubActionClickHandler():this._onClickHandler();break;case y.a.RightArrow:this.props.entry.subActionDescriptor&&this.props.entry.subActionDescriptor.dropdownInfo&&(this.props.entry.subActionDescriptor.dropdownInfo.isOpened?this._focusToFirstChild(t):this._onSubActionClickHandler(null));break;case y.a.LeftArrow:this.props.entry.subActionDescriptor&&this.props.entry.subActionDescriptor.dropdownInfo&&this.props.entry.subActionDescriptor.dropdownInfo.isOpened&&this._onSubActionClickHandler(null);break;case y.a.Escape:if(0===this.props.panelState){const e=i.findDOMNode(this._wrapperRef);e&&e.focus(),this.setState({forceHideTooltip:!0})}break;case y.a.DownArrow:this._focusToFirstChild(t)}}_focusToFirstChild(e){if(e&&e.children.length>1&&e.children[1].children.length>0&&e.children[1].children[0].children.length>0){const t=e.children[1].children[0].children[0];t&&t.focus()}}_onSubActionClickHandler(e=null){e&&e.stopPropagation();const t=this.props.entry.subActionDescriptor.onClickHandler;t&&this.props.execute(t()),this._focus()}_renderRowForExtendedSitemap(){const{entry:e,isTabIndexZero:t,describedByElementId:s,accessibilityRole:i}=this.props;if(!e)return this._tracer.error("SubAreaDescriptor passed in to SitemapRow is null",[{name:"panelState",value:this.props.panelState},{name:"describedByElementId",value:s}]),null;let n=e.title;const{subActionDescriptor:r}=e;r&&r.narratorTitle&&(n=String.format(r.narratorTitle,e.title));let a=null;return r&&r.dropdownInfo&&(a=r.dropdownInfo.isOpened),o.createElement(S.a,{key:"sitemap-sitemapAreaEntry-listItem",style:(l=this.props.designLanguage,c=this.props.theme,{width:"100%",minHeight:"35px",display:"flex",alignItems:"center",cursor:"pointer",color:l?l.Components.Navigation.Selected.PivotColor:c.colors.SiteMap.RefreshedRow.Text,backgroundColor:"transparent",flexDirection:"column",":focus":{outline:"none !important"},":focus > :first-child":{outline:"1px dotted "+(l?l.Components.Navigation.Selected.Focus.BorderColor:c.colors.BaseColor.Grey.Grey5),outlineOffset:"-1px"}}),onClick:this._onClickHandler,accessibilityLabel:n,title:e.tooltip||e.title,dataText:e.title,tabIndex:t?0:-1,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,id:this.props.sitemapRowId,testhooks:{id:this.props.sitemapRowId,[f.a.LearningPathDOMAttributeSuffix]:"sitemap-entity-"+e.id},describedByElementId:s,accessibilityExpanded:a,role:i,isSelected:this.props.entry.isSelected},this._renderRowContent(),this._renderDropdown());var l,c}_renderRowContent(){const{entry:e,designLanguage:t,theme:s,customStyles:i}=this.props,r=i.entryWrap,a={color:(l=t)?l.Components.Navigation.Rest.IconColor:void 0,width:"16px",minWidth:"16px",fontFamily:"Dyn CRM Symbol, Segoe MDL2 Assets",textAlign:"center",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center"};var l;const c=Object.assign({},a),d=function(e,t){return{display:"inline-block",alignItems:"center",fontSize:"1rem",marginLeft:t.sizes.Measures.Measure100,marginRight:t.sizes.Measures.Measure100,fontFamily:t.fontFamilies.Regular,whiteSpace:"nowrap",overflowX:"hidden",textOverflow:"ellipsis"}}(0,s),p=!le.a.getInstance().get_IsIOS();return o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",role:"presentation",style:this._addContrastRule(Ie(this.props.designLanguage,this.props.theme,e.isSelected),e,this.props.theme,!0)},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:ke(this.props.designLanguage,this.props.theme,this.props.isRTL),accessibilityHidden:p},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:Me(this.props.designLanguage,this.props.theme,this.props.isRTL,e.isSelected),accessibilityHidden:p}),o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-wrapIcon",style:r},o.createElement(u.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule(c,e,this.props.theme)},this._renderIcon()),o.createElement(u.a,{key:"sitemap-sitemapAreaEntry-text",style:d},e.title)),this._renderOfflineStatusIcon(e.title)),this._renderAppsButton(),this._renderSubAction())}_renderIcon(){const{entry:e}=this.props,t={width:this.props.theme.sizes.Icon.MinWidth,height:this.props.theme.sizes.Icon.MinHeight,verticalAlign:"middle"};return this._getIcon(e.icon,t)}_getIcon(e,t){if(!e)return;const s=this.props.entry.tooltip||this.props.entry.title;return Object(Oe.a)({title:s,icon:e,styles:t,isHighContrast:this.props.isHighContrast,customStyles:this.props.customStyles})}_renderOfflineStatusIcon(e){const t=this.props.entityOfflineStatus;if(t===q.a.NotAvailable)return null;let s="",i="";return t===q.a.Enabled?(s=Object(k.c)(this.props.resourceStrings,$.b),i=e+"-"+$.b):(s=Object(k.c)(this.props.resourceStrings,$.g),i=e+"-"+$.g),o.createElement(u.a,{key:"sitemap-offlineStatus-icon",style:Ce(this.props.designLanguage,t,this.props.theme),accessibilityLabel:s,testhooks:{id:i}},W.b[q.a[t]])}_renderSubAction(){const{entry:e}=this.props;let t=null;const s=this.props.customStyles.entrySubActionIconStyles,i=this.props.customStyles.entrySubActionButtonStyle;return e.subActionDescriptor?(t=Object.assign(Object.assign({},(this.props.designLanguage,r=this.props.theme,{marginLeft:(a=this.props.isRTL)?r.sizes.Measures.Measure100:"0px",marginRight:a?"0px":r.sizes.Measures.Measure100,position:"relative",flexGrow:0,flexShrink:0})),e.subActionDescriptor.icon.dynamicStyles),o.createElement(n.a,{style:t},o.createElement(n.a,{onClick:this._onSubActionClickHandler,style:i,testhooks:{id:"sitemap-area-entry-subaction-btn"},title:e.subActionDescriptor.toolTip},o.createElement(u.a,{style:s},this._renderSubActionIcon())))):null;var r,a}_renderAppsButton(){return this.props.renderAppsButton?o.createElement(Pe,{key:"sitemap-apps",overwriteStyle:{height:"100%",padding:0}}):null}_renderSubActionIcon(){const{entry:e}=this.props;let t=null;const s={width:"16px",height:"16px",fontSize:"16px"};if(!e.subActionDescriptor){const e={type:b.b,value:"200"};return this._getIcon(e,s)}return t=e.subActionDescriptor.icon,this._getIcon(t,s)}_renderDropdown(){const{entry:e}=this.props;return e.subActionDescriptor&&e.subActionDescriptor.dropdownInfo?o.createElement(we,{key:"sitemap-sitemapAreaEntry-recentsDropdown",parentEntryId:e.id,accessibilityLabel:e.title.toString(),isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,focusedRowId:this.props.focusedRowId,onKeyboardFocus:this.props.onKeyboardFocus}):null}_renderRowForCollapsedSitemap(){const{entry:e,accessibilityRole:t}=this.props;return o.createElement(S.a,{ref:e=>this._wrapperRef=e,key:"sitemap-sitemapAreaEntry-listItem",style:this._addContrastRule(Ae(this.props.designLanguage,this.props.theme,this.props.entry.isSelected),e,this.props.theme,!0),onClick:this._onClickHandler,accessibilityLabel:e.title,dataText:e.title,testhooks:{id:"quick-launch-entity-"+e.id,[f.a.LearningPathDOMAttributeSuffix]:"sitemap-ql-entity-"+e.id},tabIndex:this.props.isTabIndexZero?0:-1,onKeyDown:this._onKeyDownHandler,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,title:e.title,role:t,onPointerEnter:this._onPointerEnter},o.createElement(n.a,{key:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-anchor-"+this.props.entry.id,style:{width:0,height:"100%"}}),o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:xe,accessibilityHidden:!0},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:(this.props.designLanguage,i=this.props.theme,r=this.props.isRTL,{display:"flex",paddingLeft:r?0:i.sizes.Measures.Measure025,paddingRight:r?i.sizes.Measures.Measure025:0,justifyContent:"flex-start",height:"100%",alignItems:"center",overflowX:"hidden",flex:"auto"}),accessibilityHidden:!0},o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:Me(this.props.designLanguage,this.props.theme,this.props.isRTL,this.props.entry.isSelected),accessibilityHidden:!0}),o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-flexBox",style:Re,title:e.tooltip?e.tooltip:e.title},o.createElement(u.a,{key:"sitemap-sitemapAreaEntry-icon",className:"svgIcon",style:this._addContrastRule((s=this.props.designLanguage,this.props.theme,{color:s?s.Components.Navigation.Rest.IconColor:void 0,fontFamily:"Dyn CRM Symbol",textAlign:"center",width:"100%",fontSize:"16px",flexShrink:0,display:"flex",justifyContent:"center"}),e,this.props.theme)},this._renderIcon())))),(this.props.isHovered||this.state.isKeyboardFocused)&&!this.state.forceHideTooltip&&this._renderItemFlyout());var s,i,r}_renderItemFlyout(){let e=this.props.entry.title;const{subActionDescriptor:t}=this.props.entry;t&&t.narratorTitle&&(e=String.format(t.narratorTitle,this.props.entry.title));const s={onPointerLeave:this._onPointerLeave,onClick:this._onClickHandler,accessibilityLabel:e};return o.createElement(g.a,Object.assign({positionType:"relative",relativeToElementId:"quick-launch-flyout-anchor-"+this.props.entry.id,id:"quick-launch-flyout-"+this.props.entry.id,key:"quick-launch-flyout-"+this.props.entry.id,flyoutDirection:this.props.isRTL?g.b.left:g.b.right,onOutsideClick:this._onPointerLeave,flyoutStyle:Ee(this.props.designLanguage,this.props.theme)},s),this._renderRowContent())}_addContrastRule(e,t,s,o){const i=t.icon.type;if(!i||i!==G.a||this.props.isHighContrast)return e;const n=o?s.colors.SiteMap.RefreshedRow.Fill.toString():s.colors.SiteMap.RefreshedDefault;return Object(_.c)(e,n,o,s.colors.SiteMap.RefreshedGroupText)}}He.contextType=re.a;const Ke=Object(r.a)(()=>{let e=null,t=null;return(s,o)=>{const i=o?o.entry:null,n=i?Object(q.e)(s,i.entityTypeName):q.a.NotAvailable,r=!e||null===t,a=n===t,l=Object(de.e)(s);if(r||!a){t=n;const o=Object(I.a)(s),i=Object(A.b)(s)?Object(A.a)(s):null;e={theme:o,designLanguage:i,customStyles:ve(i,o),entityOfflineStatus:n,resourceStrings:Object(k.e)(s,[$.b,$.g]),isRTL:Object(v.g)(s),isHighContrast:Object(J.n)(),isSitemapInFlyout:l}}return e}},(function(e){return{execute:t=>{e(t)}}}))(He);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function ze(e,t,s){return{color:t?t.Components.Navigation.Rest.TextColor:e.colors.SiteMap.RefreshedGroupText,display:"flex",fontSize:e.fontSizes.Font100,fontFamily:e.fontFamilies.Weighted,fontWeight:e.sizes.FontWeights.Semibold,minHeight:e.sizes.Measures.Measure250,height:"auto",marginTop:e.sizes.Measures.Measure025,marginBottom:e.sizes.Measures.Measure025,alignItems:"center",justifyContent:"flex-start",marginLeft:s?e.sizes.Measures.Measure050:e.sizes.Measures.Measure100,marginRight:s?e.sizes.Measures.Measure100:e.sizes.Measures.Measure050}}function We(e,t,s,o,i){const n={flexGrow:0};if(o||1!==s||(n.marginBottom=e.sizes.Measures.Measure100),!i&&0===s){const s=t?t.Components.Navigation.Rest.DividerColor:e.colors.SiteMap.CollapsedGroupSeparator;n.borderTop="1px solid "+s}return n}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ge extends o.Component{constructor(e){super(e),this._uniqueId=he.a.newGuid().guid,this._labelId="sitemap-sitemapAreaGroup-group-"+this._uniqueId,this._describeAreaId=this._labelId+"-narrator"}_renderSitemapAreaEntries(){const{sitemapGroup:e,index:t,isNewSitemapKeyboardMode:s}=this.props,i=0===t;let n=!1;const{toggleSiteMap:r}=this.context;return e.entries.map((e,t)=>{let a;e.subActionDescriptor&&!n&&(n=!0,a=this._describeAreaId);const c=me(e);return o.createElement(Ke,{key:t,entry:e,toggleSiteMap:r,isTabIndexZero:s?this.props.focusedRowId===c:i&&0===t,describedByElementId:a,panelState:this.props.panelState,accessibilityRole:l.x,isHovered:this.props.hoveredRowId===e.id,sitemapRowId:c,isNewSitemapKeyboardMode:s,onPointerEnter:this.props.onRowPointerEnter,onPointerLeave:this.props.onRowPointerLeave,onKeyboardFocus:this.props.onKeyboardFocus})})}render(){const{sitemapGroup:e,theme:t,isRTL:s,isTablet:i,isLastGroup:n}=this.props,r=e.title,a=i?{listStyleType:"none",flexDirection:"column",width:"270px"}:{listStyleType:"none",flexDirection:"column",flexShrink:0},c=this.props.designLanguage,d=We(t,c,this.props.panelState,n,!1),p=r.replace(" ","");return o.createElement(S.a,{key:"sitemap-sitemapAreaGroup-listItem",style:d,accessibilityLabel:p,accessibilityExpanded:!0,role:l.x},1===this.props.panelState&&o.createElement(u.a,{key:this._labelId,testhooks:{id:"sitemap-sitemapAreaGroup-"+p},style:ze(t,c,s),role:l.r}," ",r),o.createElement(u.a,{key:this._describeAreaId,id:this._describeAreaId,style:{display:"none"},accessibilityLabel:e.narratorTitle||""}," ",e.narratorTitle||""," "),o.createElement(w.a,{key:"sitemap-sitemapAreaGroup-groupList",accessibilityLabel:r,style:a,role:l.h},this._renderSitemapAreaEntries()))}}Ge.contextType=re.b;var Ue=s("GWSs"),Qe=s("69Qu"),qe=s("LzVy"),Ve=s("sclX"),Ye=s("b8TU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Ze{constructor(e=null){this._entityNavBar=document.getElementById(x.k),this._currElement=e}_isElementExpanded(e){return!(!e||"true"!==e.getAttribute("aria-expanded")&&"true"!==e.getAttribute("data-expanded"))}_getParents(e){const t=[];let s=e;for(;s&&s.parentElement;)s=s.parentElement,t.push(s);return t}getNextSibling(e=this._currElement,t=!0){if(!e)return null;let s=e.nextElementSibling;const o=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&s)return s;if(t&&this._isElementExpanded(e))s=e.getElementsByTagName("li")[0];else if(!s&&this._isElementExpanded(o[2]))s=this.getNextSibling(o[2],!1);else if(!s&&o[1]){const e=o[1].nextElementSibling,t=e?e.getElementsByTagName("li"):null;s=t?t[0]:null}return s}getPrevSibling(e=this._currElement){if(!e)return null;const t=e.previousElementSibling,s=this._getParents(e);if(e.getAttribute("role")&&-1!==e.getAttribute("role").indexOf("tab")&&t)return t;if(this._isElementExpanded(t)){const e=t.getElementsByTagName("li");if(e.length)return e[e.length-1]}if(t)return t;if(this._isElementExpanded(s[2]))return s[2];if(s[1]){const e=s[1].previousElementSibling,t=e?e.getElementsByTagName("li"):null;if(t&&t.length)return t[t.length-1]}return null}getFirstItemOfEntityNavBar(){const e=this._entityNavBar?this._entityNavBar.firstChild:null,t=e?e.getElementsByTagName("li"):null;return t?t[0]:null}getLastItemofEntityNavBar(){const e=this._entityNavBar?this._entityNavBar.lastChild:null,t=e?e.getElementsByTagName("li"):null;return t&&t.length?t[t.length-1]:null}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Xe extends o.Component{constructor(e){super(e),this.onKeyDownHandler=this.onKeyDownHandler.bind(this)}_renderGroups(){const e=this.props,{entryGroups:t,isRTL:s,isTablet:i}=e;if(!t)return null;const n=t.length;return t.map((t,r)=>o.createElement(Ge,{key:r,sitemapGroup:t,index:r,theme:e.theme,designLanguage:e.designLanguage,isRTL:s,isLastGroup:r===n-1,isTablet:i,panelState:this.props.panelState,hoveredRowId:this.props.hoveredRowId,isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,focusedRowId:this.props.focusedRowId,onRowPointerEnter:this.props.onRowPointerEnter,onRowPointerLeave:this.props.onRowPointerLeave,onKeyboardFocus:this.props.onKeyboardFocus}))}render(){return this.props.isNewSitemapKeyboardMode?this._renderGroups():o.createElement(S.a,{key:"sitemap-pane",role:l.x},o.createElement(w.a,{key:x.k,id:x.k,style:(e=this.props,{display:"block",width:"100%",listStyleType:"none",paddingTop:0===e.panelState?"0px":e.theme.sizes.Measures.Measure150,paddingBottom:e.theme.sizes.Measures.Measure150}),onKeyDown:this.onKeyDownHandler,role:l.h},this._renderGroups()));var e}onKeyDownHandler(e){const t=e.target,s=new Ze(t),o=document.getElementById(x.k);switch(Object(ae.e)(e.nativeEvent)){case y.a.DownArrow:o&&o.contains(t)&&($e(s.getNextSibling()),e.preventDefault());break;case y.a.UpArrow:o.contains(t)&&($e(s.getPrevSibling()),e.preventDefault());break;case y.a.Home:o.contains(t)&&$e(s.getFirstItemOfEntityNavBar());break;case y.a.End:o.contains(t)&&$e(s.getLastItemofEntityNavBar())}}}function $e(e){e&&e.focus()}function Je(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.title===t.title){const s=e.subActionDescriptor||null,o=t.subActionDescriptor||null;return e.isSelected===t.isSelected&&JSON.stringify(s)===JSON.stringify(o)}return!1}const et=Object(r.a)(()=>{let e=null,t=null,s=null;return(o,i)=>{const n=Object(Qe.b)(o),r=Object(qe.a)(o),a=Object(Ye.c)(o),l=Object(I.a)(o);if(!t||!e||s!==n)return t=i.areaId,s=n,e={entryGroups:Object(Ue.l)(o,i.areaId),isRTL:Object(v.g)(o),isTablet:r===Ve.b.Native&&a>l.sizes.Breakpoints.DimensionS},e;let c;if(i.areaId===t){c=Object(Ue.l)(o,i.areaId);let t=!1;for(let s=0;s<c.length;s++){const o=e.entryGroups.find(e=>e.title===c[s].title);if(!o||c[s].entries.length!==o.entries.length){t=!0;break}for(let e=0;e<c[s].entries.length;e++){if(!Je(c[s].entries[e],o.entries[e])){t=!0;break}}}if(!t)return e}return t=i.areaId,s=n,e={entryGroups:c||Object(Ue.l)(o,i.areaId),isRTL:Object(v.g)(o),isTablet:r===Ve.b.Native&&a>l.sizes.Breakpoints.DimensionS},e}})(Xe);var tt=s("1S8a"),st=s("jzeE"),ot=s("gxvI"),it=s("kn9b"),nt=s("2bwe"),rt=s("QbIY"),at=s("46jN"),lt=s("PZ34"),ct=s("3/02"),dt=s("pF61"),pt=s("arV0"),ut=s("baQL"),ht=s("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const bt="Home_8E2112DC-AD90-40F5-BEBE-0A8D80785D75",yt={type:b.b,value:h.a.Home.toString()},mt={type:b.b,value:h.a.Recent.toString()},ft={type:b.b,value:h.a.Pinned.toString()},gt={type:b.b,value:h.a.RunQuery.toString()};function St(e){return o.createElement(w.a,{key:"sitemap-sitemapAreaGroup-groupList",style:{listStyleType:"none",flexDirection:"column",flexShrink:0},role:l.h},function(e){const t={id:bt,entityTypeName:null,title:Object(it.c)(e.resourceStrings,at.f),tooltip:Object(it.c)(e.resourceStrings,at.e),icon:e.homeIcon,onClickHandler:()=>Object(rt.b)()};o.useEffect(()=>{!e.focusedRowId&&e.onKeyboardFocus&&e.isNewSitemapKeyboardMode&&e.onKeyboardFocus(me(t))},[t,e]);const s=me(t);return o.createElement(Ke,{key:bt,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===s,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,accessibilityRole:l.x,isHovered:e.hoveredRowId===t.id,focusedRowId:e.focusedRowId,sitemapRowId:s,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus,renderAppsButton:e.shouldRenderAppsButton})}(e),function(e){if(0===e.panelState)return null;const t={id:ye.c,entityTypeName:null,title:Object(it.c)(e.resourceStrings,C.s),tooltip:Object(it.c)(e.resourceStrings,C.v),icon:e.recentIcon,children:null,subActionDescriptor:e.recentSubAction,onClickHandler:()=>Object(nt.b)(e.recentSubAction.dropdownInfo)},s=me(t);return o.createElement(Ke,{key:ye.c,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===s,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:s,accessibilityRole:l.x,onKeyboardFocus:e.onKeyboardFocus})}(e),function(e){if(0===e.panelState)return null;const t={id:ye.a,entityTypeName:null,title:Object(it.c)(e.resourceStrings,C.l),tooltip:Object(it.c)(e.resourceStrings,C.p),icon:e.pinnedIcon,children:null,subActionDescriptor:e.pinnedSubAction,onClickHandler:()=>Object(nt.b)(e.pinnedSubAction.dropdownInfo)},s=me(t);return o.createElement(Ke,{key:ye.a,entry:t,panelState:e.panelState,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===s,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:s,accessibilityRole:l.x,onKeyboardFocus:e.onKeyboardFocus})}(e),function(e){if(!e.isQueryPageEnabled)return;const t={id:ye.b,entityTypeName:null,title:"Query",tooltip:"Query tooltip",icon:e.queryIcon,isSelected:e.isQuerySelected,onClickHandler:()=>Object(lt.a)()},s=me(t);return o.createElement(Ke,{key:ye.b,entry:t,panelState:e.panelState,accessibilityRole:l.x,isHovered:e.hoveredRowId===t.id,isNewSitemapKeyboardMode:e.isNewSitemapKeyboardMode,focusedRowId:e.focusedRowId,sitemapRowId:s,isTabIndexZero:!e.isNewSitemapKeyboardMode||e.focusedRowId===s,onPointerEnter:e.onRowPointerEnter,onPointerLeave:e.onRowPointerLeave,onKeyboardFocus:e.onKeyboardFocus})}(e))}function wt(e,t,s){const o=t===ye.c,i={isOpened:!1,entityTypeName:o?"Recent_C66859D8-C5F1-4C29-AB31-D1F1F522C6B8":"Pinned_0F52083C-5DA1-41B2-88A7-937955C71021",relativeToEntryId:t},n=Object(V.c)(e);let r;n&&n.entityTypeName===i.entityTypeName&&n.relativeToEntryId===i.relativeToEntryId&&(i.isOpened=n.isOpened),r=o?i.isOpened?C.t:C.u:i.isOpened?C.n:C.o;const a=Object(it.c)(s,r);return{icon:{type:b.b,value:(i.isOpened?h.a.ChevronUp:h.a.ChevronDown).toString()},onClickHandler:()=>Object(nt.b)(i),dropdownInfo:i,toolTip:a}}St.displayName="SitemapHomePane";const _t=Object(r.a)((function(){const e=Object(k.h)();let t,s;return(o,i)=>{const n=e(o,[at.f,at.e,C.l,Ue.d,C.s,C.v,C.p,C.u,C.t,C.o,C.n]),r=wt(o,ye.c,n),a=wt(o,ye.a,n);t&&r.dropdownInfo.isOpened===t.dropdownInfo.isOpened||(t=r),s&&a.dropdownInfo.isOpened===s.dropdownInfo.isOpened||(s=a);const l=Object(ht.a)(o,ct.ab,ct.h),c=Object(dt.c)(o),d=Object(pt.l)(o,c),p=Object(pt.g)(o,c),u=d===ut.a||p&&p.isQueryMode,h=Object(de.c)(o);return{homeIcon:yt,recentIcon:mt,recentSubAction:t,pinnedIcon:ft,pinnedSubAction:s,queryIcon:gt,isQueryPageEnabled:l,isQuerySelected:u,resourceStrings:n,shouldRenderAppsButton:h}}}))(St);var vt=s("uZvv"),It=s("0FMG"),Et=s("uMsf"),Ct=s("Knfm"),kt=s("miNs"),Mt=s("FhVi"),At=s("CXmn"),xt=s("4leG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Rt=Object(c.a)(),Ot=Object(c.a)();class Nt extends o.Component{constructor(e){super(e),this._updateSitemapBodyPanelContainerRef=this._updateSitemapBodyPanelContainerRef.bind(this),this._onRowPointerEnter=this._onRowPointerEnter.bind(this),this._onRowPointerLeave=this._onRowPointerLeave.bind(this),this._onKeyboardFocus=this._onKeyboardFocus.bind(this),this._globalKeyboadHandler=this._globalKeyboadHandler.bind(this),this._onOutsideClickHandler=this._onOutsideClickHandler.bind(this),this.onKeyDownHandler=this.onKeyDownHandler.bind(this),this.selectArea=this.selectArea.bind(this),this.state={hoveredRowId:void 0,focusedRowId:void 0},C.w.some(t=>!Object(k.c)(e.resourceStrings,t))&&e.retrieveResourceStrings(C.w)}componentDidMount(){document.addEventListener("keydown",this._globalKeyboadHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._globalKeyboadHandler)}onKeyDownHandler(e){const t=e.target,s=new Ze(t),o=document.getElementById("siteMapPanelBodyDiv");switch(Object(ae.e)(e.nativeEvent)){case kt.a.DownArrow:o&&o.contains(t)&&(this._focusNotNull(s.getNextSibling()),e.preventDefault());break;case kt.a.UpArrow:o.contains(t)&&(this._focusNotNull(s.getPrevSibling()),e.preventDefault());break;case kt.a.Home:o.contains(t)&&this._focusNotNull(s.getFirstItemOfEntityNavBar());break;case kt.a.End:o.contains(t)&&this._focusNotNull(s.getLastItemofEntityNavBar())}}_focusNotNull(e){e&&e.focus()}_globalKeyboadHandler(e){switch(Object(ae.e)(e)){case kt.a.Escape:this.setState({hoveredRowId:void 0})}}selectArea(e){this.props.selectedAreaId!==e&&(this.props.selectArea(e,this.props.siteMap),this.props.navigateToArea(e),this.setState({focusedRowId:void 0}))}componentDidUpdate(e,t){if(0===this.props.panelState&&1===e.panelState||e.selectedAreaId!==this.props.selectedAreaId){const e=i.findDOMNode(this._sitemapBodyContainer);e&&(e.scrollTop=0)}}_mouseEnter(){M.a.SessionStart()}_mouseExit(){M.a.SessionEnd()}_renderSiteMap(){return o.createElement(n.a,{id:Rt,testhooks:{id:"navbar-container"},onMouseEnter:this._mouseEnter.bind(this),onMouseLeave:this._mouseExit.bind(this),semanticTag:"nav",role:l.p,accessibilityLabel:Object(k.c)(this.props.resourceStrings,C.g),style:this._getContainerStyle()},this.renderPanelHeader(),this.renderPanelBody(),this.renderPanelFooter())}renderPanelHeader(){return this.props.renderToggleButton?o.createElement(n.a,{key:"sitemap-header",style:{display:"flex",width:"100%",justifyContent:"space-between"}},o.createElement(ot.a,{key:"sitemap-toogle"})):null}renderPanelBody(){const e=this.props.designLanguage;return o.createElement(n.a,{key:"sitemap-panel-body",style:this._getsitemapPanelBodyDivStyle(),ref:this._updateSitemapBodyPanelContainerRef,id:"siteMapPanelBodyDiv"},o.createElement(w.a,{key:"sitemap-group-list",id:this.props.isNewSitemapKeyboardMode?x.k:void 0,labelledByElementId:x.g,role:l.w,style:{flexDirection:"column",listStyleType:"none",width:"100%"},onKeyDown:this.props.isNewSitemapKeyboardMode?this.onKeyDownHandler:void 0},o.createElement(S.a,{key:"sitemap-homepane",role:l.x,style:We(this.props.theme,e,this.props.panelState,!1,!0)},o.createElement(_t,{key:"sitemap-navBar-areaPaneStaticNavBar",theme:this.props.theme,panelState:this.props.panelState,hoveredRowId:this.state.hoveredRowId,focusedRowId:this.state.focusedRowId,isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,onKeyboardFocus:this.props.isNewSitemapKeyboardMode?this._onKeyboardFocus:void 0,onRowPointerEnter:this._onRowPointerEnter,onRowPointerLeave:this._onRowPointerLeave})),this.props.selectedAreaId&&o.createElement(et,{key:"sitemap-navBar-areaPaneNavBar",areaId:this.props.selectedAreaId,theme:this.props.theme,designLanguage:e,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,hoveredRowId:this.state.hoveredRowId,focusedRowId:this.state.focusedRowId,isNewSitemapKeyboardMode:this.props.isNewSitemapKeyboardMode,onKeyboardFocus:this.props.isNewSitemapKeyboardMode?this._onKeyboardFocus:void 0,onRowPointerEnter:this._onRowPointerEnter,onRowPointerLeave:this._onRowPointerLeave})))}renderPanelFooter(){const{siteMap:e}=this.props;return o.createElement(z,{siteMap:e,theme:this.props.theme,designLanguage:this.props.designLanguage,selectedAreaId:this.props.selectedAreaId,selectArea:this.selectArea,resourceStrings:this.props.resourceStrings,panelState:this.props.panelState,isRTL:this.props.isRTL,flyoutWidth:this.props.isInFlyoutMode?this.props.sitemapWidth:this.props.theme.sizes.SiteMap.RefreshedWidth})}render(){if(this.props.isSitemapPanelHidden)return null;if(this.props.isInFlyoutMode)return 1!==this.props.panelState?null:o.createElement(g.a,{id:Ot,accessibilityModal:!0,positionType:"absolute",flyoutStyle:{width:this.props.sitemapWidth,minWidth:this.props.theme.sizes.SiteMap.RefreshedWidth},position:this._getFlyoutPosition(),onOutsideClick:this._onOutsideClickHandler},this._renderSiteMap(),o.createElement(Mt.a,{key:"accessibilityComponent",rootElementId:Ot,shouldManageFocus:!0,isModal:!0}));const e=document.getElementById(st.a);return e&&i.createPortal(this._renderSiteMap(),e)}_onOutsideClickHandler(e){const t=e.target,s=document.getElementById(x.g);t&&!s.contains(t)&&s!==t&&this.props.toggleSitemap()}_onRowPointerEnter(e){this.setState({hoveredRowId:e})}_onRowPointerLeave(e){this.state.hoveredRowId===e&&this.setState({hoveredRowId:void 0})}_getFlyoutPosition(){const e={bottom:0,top:this.props.headerHeight,left:0};return this.props.isRTL&&(e.left=void 0,e.right=0),e}_onKeyboardFocus(e){this.state.focusedRowId!==e&&this.setState({focusedRowId:e})}_getsitemapPanelBodyDivStyle(){return{overflowY:0===this.props.panelState?"hidden":"auto",overflowX:"hidden",flexGrow:1}}_getContainerStyle(){const{theme:e,isRTL:t,isEmbedded:s}=this.props,o=this.props.designLanguage,i=s||t,n=s||!t;return{height:"100%",width:this._getContainerWidth(),flexDirection:"column",backgroundColor:o?o.Components.Navigation.Rest.BackgroundColor:e.colors.SiteMap.RefreshedDefault,borderLeft:i?e.borders.Border02:"none",borderRight:n?e.borders.Border02:"none",position:"relative"}}_getContainerWidth(){return this.props.isInFlyoutMode?"100%":this.props.sitemapWidth}_updateSitemapBodyPanelContainerRef(e){this._sitemapBodyContainer=e}}function Tt(){const e=Object(k.h)();return t=>{const s=Object(a.b)(t),o=Object(I.a)(t),i=Object(A.b)(t)?Object(A.a)(t):null,n=e(t,C.w),r=Object(v.g)(t),l=Object(tt.b)(t),c=Object(tt.c)(t);return{siteMap:s,theme:o,designLanguage:i,resourceStrings:n,isRTL:r,isSitemapPanelHidden:l||c,selectedAreaId:Object(vt.a)(t),navigationType:Object(Ct.a)(t),renderToggleButton:Object(de.f)(t),panelState:Object(vt.d)(t),isInFlyoutMode:Object(de.e)(t),sitemapWidth:Object(de.a)(t),headerHeight:Object(At.a)(t),isNewSitemapKeyboardMode:Object(de.b)(t),isEmbedded:Object(xt.c)(t)}}}function Bt(e){return{retrieveResourceStrings:t=>e(Object(Ne.e)(t)),navigateToArea:t=>{e(Object(Et.a)(t,U.b.SiteMapSubArea))},selectArea:(t,s)=>{e(Object(It.d)(t,s))},toggleSitemap:()=>{e(Object(ce.b)())}}}Nt.displayName="SitemapPanel",Nt.contextType=re.a;const Ft=Object(r.a)(Tt,Bt)(Nt);var Dt=s("ZuxC"),Lt=s("vYkK");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function jt(e,t){if(t.type===Dt.b){const s=t;if(s.meta.source!==U.b.SiteMapSubArea){const t=e.getState(),o=Object(Lt.a)(t,s.payload.__pageName,s.payload.input);o&&o.area&&o.subArea?(e.dispatch(Object(It.d)(o.area.Id)),e.dispatch(Object(It.e)(o.subArea.Id))):(e.dispatch(Object(It.e)(null)),!Object(vt.a)(t)&&e.dispatch(Object(It.d)(Object(vt.b)(t))))}}}var Pt=s("FoFY"),Ht=s("8sCk"),Kt=s("o0iw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class zt extends o.Component{constructor(e){super(e),this.state={isKeyboardFocused:!1,forceHideTooltip:!1},this._onKeyboardFocus=this._onKeyboardFocus.bind(this),this._onKeyboardBlur=this._onKeyboardBlur.bind(this),this._onSessionClick=this._onSessionClick.bind(this),this._onCloseClick=this._onCloseClick.bind(this),this._keyDownHandler=this._keyDownHandler.bind(this),this._onCloseButtonKeyDown=this._onCloseButtonKeyDown.bind(this),this._onPointerEnter=this._onPointerEnter.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this)}render(){let e=this.props.style.sessionStyle;return this.props.isFocused&&(e=Object.assign(Object.assign({},e),this.props.style.selectedSessionStyle)),0===this.props.containerState?this._renderCollapsedContent(e):this._renderExpandedContent(e)}_onPointerEnter(){this.props.onPointerEnter(this.props.session.id)}_onPointerLeave(e){this.props.onPointerLeave(this.props.session.id)}_getTitle(){return this.props.session.title||this.props.firstAnchorTabTitle||this.props.newSessionTitle}_renderExpandedContent(e){return o.createElement(S.a,{ref:e=>this._wrapperRef=e,key:"sessionContainer-"+this.props.session.id,id:"sessionContainer-"+this.props.session.id,onClick:this._onSessionClick,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,onKeyDown:this._keyDownHandler,isSelected:this.props.isFocused,tabIndex:this.props.isFocused||this.state.isKeyboardFocused?0:-1,accessibilityLabel:this._getAccessibilityLabel(),role:l.x,style:e,testhooks:{id:this.props.session.id}},this._renderIcon(),this._renderActivityIndicator(),this._renderSessionTitle(),this._renderCloseButton())}_renderCollapsedContent(e){const t=Object.assign(Object.assign({},e),{paddingRight:0,paddingLeft:0});return o.createElement(S.a,{ref:e=>this._wrapperRef=e,key:"sessionContainer-"+this.props.session.id,id:"sessionContainer-"+this.props.session.id,onClick:this._onSessionClick,onFocus:this._onKeyboardFocus,onBlur:this._onKeyboardBlur,onKeyDown:this._keyDownHandler,isSelected:this.props.isFocused,tabIndex:this.props.isFocused||this.state.isKeyboardFocused?0:-1,accessibilityLabel:this._getAccessibilityLabel(),role:l.x,style:t,testhooks:{id:this.props.session.id},onPointerEnter:this._onPointerEnter},o.createElement(n.a,{key:"session-flyout-anchor-"+this.props.session.id,id:"session-flyout-anchor-"+this.props.session.id,style:{width:0,height:"100%"}}),this._renderIcon(),this._renderActivityIndicator(),(this.props.isHovered||this.state.isKeyboardFocused)&&!this.state.forceHideTooltip&&this._renderItemFlyout(e))}_renderItemFlyout(e){const t=Object.assign(Object.assign({},e),this.props.style.flyoutStyle),s={onPointerLeave:this._onPointerLeave,onClick:this._onSessionClick,tabIndex:0};return o.createElement(g.a,Object.assign({positionType:"relative",relativeToElementId:"session-flyout-anchor-"+this.props.session.id,id:"session-flyout-"+this.props.session.id,key:"session-flyout-"+this.props.session.id,flyoutDirection:g.b.right,onOutsideClick:this._onPointerLeave,flyoutStyle:t},s),this._renderIcon(),this._renderActivityIndicator(),this._renderCloseButton(),this._renderSessionTitle())}_renderIcon(){const e={display:"flex",flexShrink:0,width:_e.a.sizes.SiteMap.RefreshedWidthCollapsed},t=this.props.isFocused?{}:{margin:"0 8px"};let s=Object.assign(Object.assign({},this.props.style.iconStyle),t);const i=this._getTitle();if(this.props.isDefault)return s=Object.assign(s,{fontSize:_e.a.fontSizes.Font125}),o.createElement(n.a,{style:e,accessibilityHidden:!0},this._renderFocusedSessionIndicator(),o.createElement(u.a,{style:this.props.style.iconWraperStyle,key:"entityImage-"+this.props.session.id,title:i},Object(Kt.h)("Home",!1,!0,void 0,s,null,null,this._getTitle())));if(this.props.session.icon){const s=Object.assign({width:_e.a.sizes.Icon.MaxWidth,height:_e.a.sizes.Icon.MaxHeight},t);return o.createElement(n.a,{style:e},this._renderFocusedSessionIndicator(),o.createElement(G.a,{source:this.props.session.icon,title:this.props.session.iconTitle,altText:this.props.session.iconTitle,style:s}))}s=Object.assign(s,{fontSize:_e.a.fontSizes.Font075,fontWeight:"bold",color:_e.a.colors.BaseColor.White});const r=this.props.session.title||this.props.firstAnchorTabTitle;return o.createElement(n.a,{style:e,accessibilityHidden:!0},this._renderFocusedSessionIndicator(),o.createElement(X.a,{entityReference:{entityName:"",Id:""},customEntityIcon:null,entityPrimaryField:r,hasPrimaryImageField:!0,imageSrc:null,sipUrl:null,wrapperStyle:null,presenceIndicatorSize:3,key:"entityImage-"+this.props.session.id,alt:r,style:s,title:i}))}_renderFocusedSessionIndicator(){return this.props.isFocused&&o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-inlineBlock",style:this.props.style.focusedSessionIndicatorStyle,accessibilityHidden:!0})}_renderSessionTitle(){const e=this._getTitle();return o.createElement(u.a,{key:"session-title-"+this.props.session.id,style:this.props.style.textTitleStyle,title:e},e)}_onKeyboardFocus(){this.setState({isKeyboardFocused:!0}),this.props.onFocusIn(this.props.session.id)}_onKeyboardBlur(e){const t=e.relatedTarget?e.relatedTarget:document.activeElement,s=t&&t.id==="close-session-"+this.props.session.id;this.setState({forceHideTooltip:!1,isKeyboardFocused:s})}_renderCloseButton(){const e=String.format(this.props.closeSessionAriaLabel,this._getTitle());return this.props.session.canBeClosed&&o.createElement(n.a,{ref:e=>this._closeRef=e,tabIndex:0,id:"close-session-"+this.props.session.id,key:"close-session-"+this.props.session.id,className:this.state.isKeyboardFocused?"close-button focused":"close-button",style:this.props.style.closeButtonStyle,onClick:this._onCloseClick,onKeyDown:this._onCloseButtonKeyDown,accessibilityLabel:e,title:this.props.closeSessionTooltip,testhooks:{id:"close-session-"+this.props.session.id},role:l.d},o.createElement(b.b,{type:h.a.RemoveFilter,style:{fontSize:"16px",padding:6}}))}_keyDownHandler(e){switch(Object(ae.e)(e)){case y.a.Space:case y.a.Enter:!this.props.isFocused&&this.props.focusSession(this.props.session.id);break;case y.a.Delete:case y.a.Backspace:this.props.session.canBeClosed&&this.props.closeSession(this.props.session.id);break;case y.a.Escape:0===this.props.containerState&&(this._focusToSessionElement(),this.setState({forceHideTooltip:!0}));break;case y.a.LeftArrow:case y.a.RightArrow:const e=i.findDOMNode(this._closeRef);e&&e.focus()}}_focusToSessionElement(){const e=i.findDOMNode(this._wrapperRef);e&&e.focus()}_onCloseClick(e){this._focusToSessionElement(),this.props.session.canBeClosed&&this.props.closeSession(this.props.session.id),e.stopPropagation()}_onCloseButtonKeyDown(e){e.keyCode!==y.a.Space&&e.keyCode!==y.a.Enter||(event.target.click(),e.stopPropagation()),e.keyCode===y.a.Tab&&0===this.props.containerState&&e.preventDefault()}_onSessionClick(){!this.props.isFocused&&this.props.focusSession(this.props.session.id)}_renderActivityIndicator(){return!this.props.isFocused&&this.props.session.isFocusRequested&&o.createElement(n.a,{key:"sitemap-sitemapAreaEntry-indicator",style:this.props.style.indicatorStyle,accessibilityHidden:!0,testhooks:{id:this.props.session.id+"-indicator"}})}_getAccessibilityLabel(){let e=this._getTitle();return this.props.session.iconTitle&&(e+=" "+this.props.session.iconTitle),this.props.session.isFocusRequested&&(e+=" "+this.props.activityIndicatorDescribedBy),this.props.session.canBeClosed&&(e+=" "+this.props.closeSessionDescribedBy),e}}var Wt=s("W6eV"),Gt=s("pulT"),Ut=s("txA/"),Qt=s("QJRG"),qt=s("QGYZ"),Vt=s("vCAJ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Yt extends o.Component{constructor(e){super(e),this._focusSession=this._focusSession.bind(this),this._closeSession=this._closeSession.bind(this),this._onPointerEnter=this._onPointerEnter.bind(this),this._onPointerLeave=this._onPointerLeave.bind(this),this.state={hoveredSessionId:void 0},this._keyboardHandler=this._keyboardHandler.bind(this),this._globalKeyboadHandler=this._globalKeyboadHandler.bind(this)}componentDidMount(){document.addEventListener("keydown",this._globalKeyboadHandler)}componentWillUnmount(){document.removeEventListener("keydown",this._globalKeyboadHandler)}render(){return o.createElement(n.a,{key:"session-list-id",style:{width:"100%"}},o.createElement(w.a,{id:"session-list-id",role:l.w,ref:e=>this._wrapperRef=e,style:this.props.style.sessionListStyle,onKeyDown:this._keyboardHandler},this._renderSessions()),this._renderFocusRequestedSessionAccessibility())}_renderSessions(){const e=Object(it.c)(this.props.resourceStrings,Ut.T),t=Object(it.c)(this.props.resourceStrings,Ut.D),s=Object(it.c)(this.props.resourceStrings,Ut.F),i=Object(it.c)(this.props.resourceStrings,Ut.E),n=Object(it.c)(this.props.resourceStrings,Ut.C);return Object.keys(this.props.sessions).map((r,a)=>o.createElement(zt,{key:"session-"+r,session:this.props.sessions[r],firstAnchorTabTitle:this.props.firstAnchorTabTitles[r],isFocused:r===this.props.focusedSessionId,isDefault:r===this.props.defaultSessionId,style:this.props.style,containerState:this.props.panelState,focusSession:this._focusSession,closeSession:this._closeSession,isRTL:this.props.isRTL,onPointerEnter:this._onPointerEnter,onPointerLeave:this._onPointerLeave,isHovered:this.state.hoveredSessionId===r,newSessionTitle:e,closeSessionTooltip:s,activityIndicatorDescribedBy:n,closeSessionAriaLabel:t,closeSessionDescribedBy:i,onFocusIn:e=>{this._focusItemIndex=Object.keys(this.props.sessions).findIndex(t=>t===e)}}))}_renderFocusRequestedSessionAccessibility(){const e=Object(it.c)(this.props.resourceStrings,Ut.C);return o.createElement(n.a,{key:"SessionFocusRequested_Accessibility",accessibilityLive:"polite",accessibilityAtomic:"true",style:{width:0,height:0,overflow:"hidden"}},Object.keys(this.props.sessions).map(t=>{const s=this.props.sessions[t],i=this.props.isRTL?`${e} ${s.title}`:`${s.title} ${e}`;return s.isFocusRequested&&o.createElement(u.a,{id:"accessibility_"+s.id},i)}))}_keyboardHandler(e){switch(Object(ae.e)(e)){case y.a.UpArrow:const t=this._getPreviousElement();t&&t.focus(),e.preventDefault(),e.stopPropagation();break;case y.a.DownArrow:const s=this._getNextElement();s&&s.focus(),e.preventDefault(),e.stopPropagation();break;case y.a.Home:const o=this._getFirstElement();o&&o.focus(),e.preventDefault(),e.stopPropagation();break;case y.a.End:const i=this._getLastElement();i&&i.focus(),e.preventDefault(),e.stopPropagation()}}_globalKeyboadHandler(e){switch(Object(ae.e)(e)){case y.a.Escape:this.setState({hoveredSessionId:void 0})}}_getNextElement(){const e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=(this._focusItemIndex+1)%e.childNodes.length,e.childNodes[this._focusItemIndex]):null}_getPreviousElement(){const e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex<=0&&(this._focusItemIndex=e.childNodes.length),this._focusItemIndex--,e.childNodes[this._focusItemIndex]):null}_getFirstElement(){const e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=0,e.childNodes[this._focusItemIndex]):null}_getLastElement(){const e=i.findDOMNode(this._wrapperRef);return e&&e.childNodes&&e.childNodes.length?(this._focusItemIndex=e.childNodes.length-1,e.childNodes[this._focusItemIndex]):null}_closeSession(e){this.props.closeSession(e)}_focusSession(e){e!==this.props.focusedSessionId&&this.props.focusSession(e)}_onPointerEnter(e){this.setState({hoveredSessionId:e})}_onPointerLeave(e){this.state.hoveredSessionId===e&&this.setState({hoveredSessionId:void 0})}}const Zt=Object(r.a)((function(){const e=Object(k.h)();let t={};return(s,o)=>{const i=Object(Pt.c)(s);Object.keys(i).forEach(e=>{const o=Object(Vt.b)(s,i[e].anchorTabId);(!t[e]||(null==o?void 0:o.length)<=1)&&(t=Object.assign(Object.assign({},t),{[e]:Object(qt.c)(s,i[e].anchorTabId)}))});const n=Object(Gt.c)(s),r=Object(Gt.a)(s),a=e(s,[Ut.F,Ut.E,Ut.D,Ut.T,Ut.C]),l=Object(v.g)(s),c=Object(J.n)();return{sessions:i,firstAnchorTabTitles:t,focusedSessionId:n,defaultSessionId:r,resourceStrings:a,style:Object(Wt.a)(l,c).sessionStyle,isRTL:l}}}),(function(e){return{closeSession:t=>e(Object(Ht.a)(t)),focusSession:t=>e(Object(Qt.a)(t))}}))(Yt);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const Xt=Object(r.a)(Tt,Bt)(class extends Nt{renderPanelBody(){return o.createElement(Zt,{maxSessions:Ut.A,panelState:this.props.panelState})}renderPanelFooter(){return null}});var $t=s("14bW"),Jt=s("mPrU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const es=Object(c.a)();const ts={overflowX:"hidden",paddingLeft:"50px",paddingRight:"15px",listStyleType:"none",display:"block"};class ss extends o.Component{constructor(e){super(e),this.onOutsideClickHandler=this.onOutsideClickHandler.bind(this),this.closeSiteMap=this.closeSiteMap.bind(this)}onOutsideClickHandler(){this.props.execute(Object(Jt.b)())}closeSiteMap(){this.props.isOpened&&(this.onOutsideClickHandler(),this.props.toggleSiteMap())}_renderSitemapRecentsFlyout(){return o.createElement(n.a,null,o.createElement(g.a,{key:"overflow-flyout",positionType:"relative",relativeToElementId:"sitemap-entity-"+this.props.relativeToEntryId,flyoutDirection:g.b.down,flyoutStyle:(e=this.props.theme,t=this.props.platformType,{width:t===Ve.b.Web?"calc("+e.sizes.SiteMap.Width+" - 20px)":"100%",marginBottom:"6px",paddingTop:"2px",paddingBottom:"2px",backgroundColor:e.colors.SiteMap.Default,zIndex:50}),onOutsideClick:this.onOutsideClickHandler,id:es+this.props.relativeToEntryId},o.createElement(w.a,{key:"sitemap-sitemapAreaEntry-recent",style:ts},this._renderRecentItems(this.props.flyoutRecents,this.closeSiteMap))));var e,t}_renderRecentItems(e,t){return e.map((e,s)=>o.createElement($t.a,{key:s,entry:e,toggleSiteMap:t,isTabIndexZero:!1}))}render(){return this.props.flyoutVisible&&this.props.isOpened&&this.props.flyoutRecents.length?this._renderSitemapRecentsFlyout():null}}const os=Object(r.a)((function(e){let t,s;const o=Object(I.a)(e),i=Object(qe.a)(e),n=Object(V.d)(e),r=n&&n.isVisible;return r&&(t=n.relativeToEntryId,s=Object(V.e)(e,n.entityTypeName).map(e=>Y.e.FromStateItem(e))),{flyoutVisible:r,relativeToEntryId:t,flyoutRecents:s,theme:o,platformType:i}}),(function(e){return{execute:t=>{e(t)}}}))(ss);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 *
 * Index of all needed sitemap panel imports for delay loading sitemap panel code.
 */},miNs:function(e,t,s){"use strict";var o;s.d(t,"a",(function(){return o})),function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.PauseBreak=19]="PauseBreak",e[e.Capslock=20]="Capslock",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num1=49]="Num1",e[e.Num2=50]="Num2",e[e.Num3=51]="Num3",e[e.Num4=52]="Num4",e[e.Num5=53]="Num5",e[e.Num6=54]="Num6",e[e.Num7=55]="Num7",e[e.Num8=56]="Num8",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.LeftWindowKey=91]="LeftWindowKey",e[e.RightWindowKey=92]="RightWindowKey",e[e.SelectKey=93]="SelectKey",e[e.NumPad0=96]="NumPad0",e[e.NumPad1=97]="NumPad1",e[e.NumPad2=98]="NumPad2",e[e.NumPad3=99]="NumPad3",e[e.NumPad4=100]="NumPad4",e[e.NumPad5=101]="NumPad5",e[e.NumPad6=102]="NumPad6",e[e.NumPad7=103]="NumPad7",e[e.NumPad8=104]="NumPad8",e[e.NumPad9=105]="NumPad9",e[e.Multiply=106]="Multiply",e[e.Add=107]="Add",e[e.Subtract=109]="Subtract",e[e.DecimalPoint=110]="DecimalPoint",e[e.Divide=111]="Divide",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NumLock=144]="NumLock",e[e.ScrollLock=145]="ScrollLock",e[e.SemiColon=186]="SemiColon",e[e.EqualSign=187]="EqualSign",e[e.Comma=188]="Comma",e[e.Dash=189]="Dash",e[e.Period=190]="Period",e[e.ForwardSlash=191]="ForwardSlash",e[e.GraveAccent=192]="GraveAccent",e[e.OpenBracket=219]="OpenBracket",e[e.BackSlash=220]="BackSlash",e[e.CloseBraket=221]="CloseBraket",e[e.SingleQuote=222]="SingleQuote"}(o||(o={}))},uMsf:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var o=s("fWyz"),i=s("2FbK"),n=s("RiEM");function r(e,t){return{type:"Navigate to sitemap area",execute(s,r){const l=Object(i.b)(s.getState()),c=e&&function(e,t){if(!t||!e||!e.AreaIds)return null;const s=e.Areas[t];for(const e of s.GroupIds){const t=s.Groups[e];for(const e of t.SubAreaIds){const s=t.SubAreas[e];if(!Object(n.f)(s)&&a(s))return s}}return null}(l,e);if(c)return s.dispatch(Object(o.c)(c,!1,null,t))}}}function a(e){return!e.Url||!e.Url.toLowerCase().endsWith("msdyn_launchdesigner.html")}},vYkK:function(e,t,s){"use strict";s.d(t,"b",(function(){return S})),s.d(t,"a",(function(){return m}));var o=s("fILV"),i=s("cfbi"),n=s("OKVy"),r=s("baQL"),a=s("fA3V"),l=s("Nk+G"),c=s("2FbK"),d=s("iZ7K"),p=s("uZvv"),u=s("FdB0"),h=s("UZFl"),b=s("fWyz"),y=s("NjDY");function m(e,t,s){var p;if(!s||!t)return null;const b=Object(c.b)(e);if(!b)return null;let y;if(s.isQueryMode)return null;switch(t){case o.a:const t=s;y=w(e,b,t.entityTypeName,null===(p=t.viewId)||void 0===p?void 0:p.guid);break;case i.a:y=function(e,t,s){const o=Object(d.r)(e,s.entityTypeName),i=s.entityTypeName,n=[M(i),k(i)];s.formId&&n.unshift(function(e,t){const s=new RegExp(`[&\\?]formId=${t}\\b`,"i");return t=>R(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&t.Url.search(s)>=0}(i,s.formId.guid));return v(e,t,n)||o&&v(e,t,[k("activitypointer")])}(e,b,s);break;case n.a:y=function(e,t,s){const o=s.dashboardId;if(s.etn)return w(e,t,s.etn);const i=f(e,t),n=g(e,t),r=n&&x(n);return function(e,t,s,o){let i=null,n=s;if(s){i=o;for(const e of s.GroupIds){const o=s.Groups[e];for(const e of o.SubAreaIds){const n=o.SubAreas[e];if(x(n)&&(i||(i=n),t&&(n.DefaultDashboard===t||n.Url&&n.Url.toLowerCase().includes(t))))return{subArea:n,area:s}}}if(i)return{subArea:i,area:s}}for(const s of e.AreaIds){const o=e.Areas[s];for(const e of o.GroupIds){const s=o.Groups[e];for(const e of s.SubAreaIds){const r=s.SubAreas[e];if(x(r)){if(t&&(r.DefaultDashboard===t||r.Url&&r.Url.toLowerCase().includes(t)))return{area:o,subArea:r};i||(i=r,n=o)}}}}return{subArea:i,area:n}}(t,o?o.guid:null,i,r&&n)}(e,b,s);break;case r.a:y={subArea:null,area:f(e,b)};break;case l.a:y=function(e,t,s){const o=s.customControlId;return v(e,t,[C(o)])}(e,b,s);break;case a.a:y=_(e,b,s.webresourceName);break;case u.a:y=function(e,t,s){const o=s&&s.uniqueName;return v(e,t,[A(o)])}(e,b,s);break;case h.a:y=_(e,b,"msdyn_appmanagementcontrol")}return y}function f(e,t){const s=Object(p.a)(e);return s&&t&&t.Areas&&t.Areas[s]}function g(e,t){const s=f(e,t),o=Object(p.c)(e);if(s)for(const e of s.GroupIds){const t=s.Groups[e];for(const e of t.SubAreaIds){const s=t.SubAreas[e];if(s.Id===o)return s}}return null}function S(e,t){const s=f(e,t),o=g(e,t);return s&&o?{area:s,subArea:o}:null}function w(e,t,s,o){const i=[M(s),k(s)];return o&&i.unshift(function(e,t){const s=new RegExp(`[&\\?]viewId=${t}\\b`,"i");return t=>R(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&t.Url.search(s)>=0}(s,o)),v(e,t,i)}function _(e,t,s){return v(e,t,[E(Object(y.t)(e),s)])}function v(e,t,s){const o=f(e,t),i=g(e,t);for(const e of s)if(o&&i&&e(i))return{area:o,subArea:i};for(const e of s){let s=I(o,e);if(s)return s;for(const o of t.AreaIds)if(s=I(t.Areas[o],e),s)return s}return null}function I(e,t){if(!e||!e.GroupIds)return null;for(const s of e.GroupIds){const o=e.Groups[s];for(const s of o.SubAreaIds){const i=o.SubAreas[s];if(t(i))return{area:e,subArea:i}}}return null}function E(e,t){const s=e.toLowerCase(),o=t.toLowerCase();return e=>{const t=e.Url.toLowerCase();if(t.includes(s)){if(t.substring(s.length)===o)return!0}return!1}}function C(e){const t="controlname="+e.toLowerCase(),s=new RegExp("\\b"+t+"\\b");return e=>{const t=e.Url.toLowerCase();return s.test(t)}}function k(e){return t=>t.Entity===e||R(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0}function M(e){return t=>t.Entity===e||R(t.Url)&&t.Url.search(`[&\\?]etn=${e}\\b`)>=0&&-1===t.Url.search(/[&\\?]viewId=/i)&&-1===t.Url.search(/[&\\?]formId=/i)}function A(e){return t=>t.DynamicPage===e}function x(e){return Object(b.b)(e)||e.Url&&e.Url.toLowerCase().includes("pagetype=dashboard")}function R(e){return e&&/^\/([0-9a-zA-Z_]+\/)?main.aspx/.test(e)}}}]),window.bundleExecutionMarkers["scripts/sitemappanel.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();