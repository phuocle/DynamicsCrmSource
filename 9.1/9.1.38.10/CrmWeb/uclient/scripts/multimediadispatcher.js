(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/multimediadispatcher.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[83],{"5b7D":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r("ZhaJ"),i=r("504W"),s=r("NMtn"),o=r("8uvO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class n extends a.a{constructor(e){super(),this._callback=null,Object(s.b)(e,"callback"),this._callback=e}get_exception(){return this.getValue(n._exceptionProperty)}call(){Object(i.a)(this.get_exception())||this._callback(this.get_exception())}}n._exceptionProperty=new o.a("errorInformation",Error,n,null)},"7aNy":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var a;r.d(t,"a",(function(){return a})),function(e){e[e.documentsLibrary=0]="documentsLibrary",e[e.computerFolder=1]="computerFolder",e[e.desktop=2]="desktop",e[e.downloads=3]="downloads",e[e.homeGroup=4]="homeGroup",e[e.musicLibrary=5]="musicLibrary",e[e.picturesLibrary=6]="picturesLibrary",e[e.videosLibrary=7]="videosLibrary"}(a||(a={}))},Qgan:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return n}));var a=r("nA3O"),i=r("8uvO");class s extends a.a{get_dataID(){return this.getValue(s._DataIDProperty)}set_dataID(e){return this.setValue(s._DataIDProperty,e),e}get_size(){return this.getValue(s._SizeProperty)}set_size(e){return this.setValue(s._SizeProperty,e),e}get_filename(){return this.getValue(s._FilenameProperty)}set_filename(e){return this.setValue(s._FilenameProperty,e),e}get_mimeType(){return this.getValue(s._MimeTypeProperty)}set_mimeType(e){return this.setValue(s._MimeTypeProperty,e),e}get_name(){return this.get_filename()}get_type(){return this.get_mimeType()}}s._DataIDProperty=new i.a("dataID",String,s),s._SizeProperty=new i.a("size",Number,s),s._FilenameProperty=new i.a("filename",String,s),s._MimeTypeProperty=new i.a("mimeType",String,s);class o extends s{get_fileContents(){return this.getValue(o._FileContentsProperty)}set_fileContents(e){return this.setValue(o._FileContentsProperty,e),e}}o._FileContentsProperty=new i.a("fileContents",String,o);class n extends s{get_resourceUrl(){return this.getValue(n._ResourceUrlProperty)}set_resourceUrl(e){return this.setValue(n._ResourceUrlProperty,e),e}}n._ResourceUrlProperty=new i.a("resourceUrl",String,n)},XLOu:function(e,t,r){"use strict";r.r(t),r.d(t,"MultimediaDispatcher",(function(){return N}));var a=r("EbwQ"),i=r("sJUk"),s=r("5b7D"),o=r("ZhaJ"),n=r("Qgan");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l extends o.a{constructor(e){super(),this._onGetDataSuccess=null,this._palDataFile=null,this._onGetDataSuccess=e}setValues(e){this._palDataFile=new n.a,this._palDataFile.setValues(e)}call(){this._onGetDataSuccess(this._palDataFile)}}var c=r("8uvO");class u extends i.a{constructor(e,t,r,a,i){super(),this.setValue(u._RequestTypeProperty,e),this.setValue(u._UriPathProperty,t),this.setValue(u._MaxUploadFileSizeProperty,r),this.setValue(u._OnMediaGetSuccessProperty,new l(a)),this.setValue(u._OnErrorProperty,new s.a(i))}get_methodName(){return"getMediaBytes"}}u._RequestTypeProperty=new c.a("requestType",String,u),u._UriPathProperty=new c.a("uriPath",String,u),u._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,u),u._OnMediaGetSuccessProperty=new c.a("onMediaGetSuccess",l,u),u._OnErrorProperty=new c.a("onError",s.a,u);class p extends i.a{constructor(e,t,r,a){super(),this.setValue(p._CropProperty,e),this.setValue(p._MaxUploadFileSizeProperty,t),this.setValue(p._OnGetDataSuccessProperty,new l(r)),this.setValue(p._OnErrorProperty,new s.a(a))}}p._CropProperty=new c.a("crop",Boolean,p),p._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,p),p._OnGetDataSuccessProperty=new c.a("onGetDataSuccess",l,p),p._OnErrorProperty=new c.a("onError",s.a,p);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class _ extends p{get_methodName(){return"getPhotoFromGallery"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class h extends o.a{constructor(e){super(),this._onSuccess=e}setValues(e){this._palDataFileUrl=new n.b,this._palDataFileUrl.setValues(e)}call(){this._onSuccess(this._palDataFileUrl)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d extends i.a{constructor(e,t,r,a){super(),this.setValue(d._AllowEditingProperty,e),this.setValue(d._MaxUploadFileSizeProperty,t),this.setValue(d._OnSuccessProperty,new h(r)),this.setValue(d._OnErrorProperty,new s.a(a))}get_methodName(){return"getPhotoUrlFromGallery"}}d._AllowEditingProperty=new c.a("allowEditing",Boolean,d),d._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,d),d._OnSuccessProperty=new c.a("onSuccess",h,d),d._OnErrorProperty=new c.a("onError",s.a,d);var y=r("M6xi"),P=r("Yb4o");class m extends P.a{constructor(){super(),this._items=[]}get_count(){return this._items.length}get_item(e){return this._items[e]}add(e){this.addInternal(e)}toArray(){const e=new Array(this.get_count());for(let t=0;t<this.get_count();t++)e[t]=this.get_item(t);return e}getValues(){return this}addInternal(e){this._items.push(e),this.firePropertyChanged(m.countProperty)}}m.countProperty="Count";var g=r("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e){const t=[];if("length"in e){const r=e;for(let e=0;e<r.length;e++)t.push(r[e])}else t.push(e);return t}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class F extends y.a{constructor(e,t,r){super(),this._itemType=null,this._collectionConverter=null,this._innerItemProperty=null,this._itemType=e,this._collectionConverter=t||y.a.defaultConverter,this._innerItemProperty=r}read(e,t){const r=new c.a(t.get_name()+".Item",this._itemType,t.get_ownerType()),a=new m,i=this._collectionConverter.read(e,t),s=(o=i,Object(g.a)(o)?[]:"String"in o?w(o.String):"values"in o&&o.hasOwnProperty("values")?w(o.values):w(o));var o;for(let e=0;e<s.length;e++){const t=this._innerItemProperty?s[e][this._innerItemProperty]:s[e],i=r.coerceToPropertyType(t);a.add(i)}return a}write(e,t,r){if(Object(g.a)(r))super.write(e,t,r);else{const a=[],i=r,s=new c.a(t.get_name()+".Item",this._itemType,t.get_ownerType());for(let e=0;e<i.get_count();e++){const t=s.coerceToJsonType(i.get_item(e));if(this._innerItemProperty){const r={};r[this._innerItemProperty]=t,a[e]=r}else a[e]=t}this._collectionConverter.write(e,t,a)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class S extends o.a{constructor(e){super(),this._onSuccessCallback=null,this._onSuccessCallback=e}get_dataFiles(){return this.getValue(S.DataFilesProperty)}call(){this._onSuccessCallback(this.get_dataFiles().toArray())}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var b;S.DataFilesProperty=new c.a("dataFiles",m,S),S.DataFilesProperty.set_jsonConverter(new F(n.a)),function(e){e[e.getPhotoFromGalleryFailed=-1]="getPhotoFromGalleryFailed",e[e.unableToOpenFile=0]="unableToOpenFile",e[e.applicationInSnapView=1]="applicationInSnapView",e[e.fileSizeBreached=2]="fileSizeBreached",e[e.fileSizeCannotBeZero=3]="fileSizeCannotBeZero",e[e.attachmentTypeBlocked=4]="attachmentTypeBlocked",e[e.filePickerCancelled=5]="filePickerCancelled"}(b||(b={}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class v extends o.a{constructor(e){super(),this._onErrorCallback=null,this._onErrorCallback=e}_get_ErrorCode(){return this.getValue(v._ErrorCodeProperty)}call(){this._onErrorCallback(this._get_ErrorCode())}}v._ErrorCodeProperty=new c.a("errorCode",b,v);var V=r("7aNy");class E extends i.a{constructor(e,t,r,a,i,s){super(),this.setValue(E._ShouldPickMultipleFilesProperty,e),this.setValue(E._FileFilterProperty,t),this.setValue(E._PickerLocationProperty,r),this.setValue(E._MaxUploadFileSizeProperty,a),this.setValue(E._OnSuccessCallbackProperty,new S(i)),this.setValue(E._OnErrorCallbackProperty,new v(s))}get_methodName(){return"openFilePicker"}}E._ShouldPickMultipleFilesProperty=new c.a("shouldPickMultipleFiles",Boolean,E),E._FileFilterProperty=new c.a("fileFilter",Array,E),E._PickerLocationProperty=new c.a("pickerLocation",V.a,E),E._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,E),E._OnSuccessCallbackProperty=new c.a("onSuccessCallback",S,E),E._OnErrorCallbackProperty=new c.a("onErrorCallback",v,E);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class k extends P.a{get_cameraAvailable(){return this.getValue(k._cameraAvailableProperty)}get_galleryAvailable(){return this.getValue(k._galleryAvailableProperty)}get_nativeFilePickerAvailable(){return this.getValue(k._nativeFilePickerAvailableProperty)}get_urlBasedMethodsAvailable(){return this.getValue(k._urlBasedMethodsAvailableProperty)}}k._cameraAvailableProperty=new c.a("CameraAvailable",Boolean,k,!1),k._galleryAvailableProperty=new c.a("GalleryAvailable",Boolean,k,!1),k._nativeFilePickerAvailableProperty=new c.a("NativeFilePickerAvailable",Boolean,k,!1),k._urlBasedMethodsAvailableProperty=new c.a("UrlBasedMethodsAvailable",Boolean,k,!1);var x=r("EW4s");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class f extends i.a{constructor(e,t,r){super(),this.setValue(f._MaxUploadFileSizeProperty,e),this.setValue(f._OnSuccessProperty,new h(t)),this.setValue(f._OnErrorProperty,new s.a(r))}}f._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,f),f._OnSuccessProperty=new c.a("onSuccess",h,f),f._OnErrorProperty=new c.a("onError",s.a,f);class U extends f{get_methodName(){return"captureVideo"}}class M extends f{get_methodName(){return"captureImage"}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class O extends o.a{constructor(e){super(),this._onSuccess=e}get_dataFileUrls(){return this.getValue(O.DataFileUrlsProperty)}call(){this._onSuccess(this.get_dataFileUrls().toArray())}}O.DataFileUrlsProperty=new c.a("dataFileUrls",m,O),O.DataFileUrlsProperty.set_jsonConverter(new F(n.b));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class C extends i.a{constructor(e,t,r,a,i,o){super(),this.setValue(C._AllowMultipleFilesProperty,e),this.setValue(C._FileFilterProperty,t),this.setValue(C._PickerLocationProperty,r),this.setValue(C._MaxUploadFileSizeProperty,a),this.setValue(C._OnSuccessProperty,new O(i)),this.setValue(C._OnErrorProperty,new s.a(o))}get_methodName(){return"openFilePickerForUrl"}}C._AllowMultipleFilesProperty=new c.a("allowMultipleFiles",Boolean,C),C._FileFilterProperty=new c.a("fileFilter",Array,C),C._PickerLocationProperty=new c.a("pickerLocation",V.a,C),C._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,C),C._OnSuccessProperty=new c.a("onSuccess",O,C),C._OnErrorProperty=new c.a("onError",s.a,C);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class D extends i.a{constructor(e,t,r,a,i){super(),this.setValue(D._RequestTypeProperty,e),this.setValue(D._UriPathProperty,t),this.setValue(D._MaxUploadFileSizeProperty,r),this.setValue(D._OnSuccessProperty,new h(a)),this.setValue(D._OnErrorProperty,new s.a(i))}get_methodName(){return"getMediaUrl"}}D._RequestTypeProperty=new c.a("requestType",String,D),D._UriPathProperty=new c.a("uriPath",String,D),D._MaxUploadFileSizeProperty=new c.a("maxUploadFileSize",Number,D),D._OnSuccessProperty=new c.a("onSuccess",h,D),D._OnErrorProperty=new c.a("onError",s.a,D);class N extends a.a{constructor(e){super(e),this._multimediaState=new k}get_namespaceName(){return"Multimedia"}get_multimediaState(){return this.get_state()}get_state(){return this._multimediaState}getPhotoFromGallery(e,t,r,a){const i=new _(e,t,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}getPhotoUrlFromGallery(e,t,r,a){const i=new d(e,t,r,a);this.callNativeMethod(this.get_version().get_currentVersion(),i)}openNativeFilePicker(e,t,r,a,i,s){const o=new E(e,t,r,a,i,s);this.callNativeMethod(this.get_version().get_currentVersion(),o)}openFilePickerForUrl(e,t,r,a,i,s){const o=new C(e,t,r,a,i,e=>{s(this._handleGenericPickFileError(e))});this.callNativeMethod(this.get_version().get_currentVersion(),o)}pickFile(e,t,r,a){if(this.get_multimediaState().get_galleryAvailable()){const e=e=>{this._ProcessAttachedFile([e]).then(e=>{r(e)},e=>{a(e)})},i=e=>{a(this._OnGetPhotoFromGalleryError(e))};this.getPhotoFromGallery(!1,t,e,i)}else if(this.get_multimediaState().get_nativeFilePickerAvailable()){const i=e=>{this._ProcessAttachedFile(e).then(e=>{r(e)},e=>{a(e)})},s=e=>{a(e)};this.openNativeFilePicker(e,["*"],V.a.picturesLibrary,t,i,s)}else a(0)}_ProcessAttachedFile(e){const t=new x.a;if(Object(g.a)(e))t.reject(0);else for(let r=0;r<e.length;r++)Object(g.a)(e[r])&&t.reject(0);return t.resolve(e),t}_OnGetPhotoFromGalleryError(e){const t=e.name;try{let e;if(t.startsWith(N._multimediaDispatcherError))e=t.substr(N._multimediaDispatcherError.length);else{if(!t.startsWith(N._imagePickerControllerError))throw Error.create("Unknown exception type encountered");e=t.substr(N._imagePickerControllerError.length)}switch(Number.parseInvariant(e)){case 1:return b.filePickerCancelled;case 5:return b.fileSizeBreached;case 2:case 3:case 4:default:return b.getPhotoFromGalleryFailed}}catch(e){throw Error.create("DEBUG MODE ERROR: Unknown error type sent back from the shim : "+t)}}getMediaBytes(e,t,r,a,i){const s=new u(e,t,r,a,i);this.callNativeMethod(this.get_version().get_currentVersion(),s)}getMediaUrl(e,t,r,a,i){const s=new D(e,t,r,a,i);this.callNativeMethod(this.get_version().get_currentVersion(),s)}captureImage(e,t,r){const a=new M(r,e,e=>{t(this._handleGenericPickFileError(e))});this.callNativeMethod(this.get_version().get_currentVersion(),a)}captureVideo(e,t,r){const a=new U(r,e,e=>{t(this._handleGenericPickFileError(e))});this.callNativeMethod(this.get_version().get_currentVersion(),a)}_handleGenericPickFileError(e){const t=e.name;try{let e;if(t.startsWith(N._multimediaDispatcherError))e=t.substr(N._multimediaDispatcherError.length);else{if(!t.startsWith(N._imagePickerControllerError))throw Error.create("Unknown exception type encountered");e=t.substr(N._imagePickerControllerError.length)}switch(Number.parseInvariant(e)){case 1:return b.filePickerCancelled;case 5:return b.fileSizeBreached;case 2:case 3:case 4:default:return b.unableToOpenFile}}catch(r){throw Error.create("DEBUG MODE ERROR: Unknown error type sent back from the shim : "+t+" Exception: "+JSON.stringify(e))}}}N._multimediaDispatcherError="MultimediaDispatcherErrorDomain",N._imagePickerControllerError="ImagePickerControllerError"}}]),window.bundleExecutionMarkers["scripts/multimediadispatcher.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();