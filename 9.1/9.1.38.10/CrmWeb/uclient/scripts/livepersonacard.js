(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/livepersonacard.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[73],{"9zTt":function(e,t,n){
/*! Version: 1.5.2; Third Party Notices: https://go.microsoft.com/fwlink/?linkid=855968 */
e.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=22)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(e,t,n,r,o){this.type=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=o}return e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r,o=n(3),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},s=n(20),u=function(){function e(e){this.bootstrapperConfig=e,this.ariaCdnUrl="https://res.delve.office.com/lpc/versionless/aria-webjs-sdk-1.6.0.min.js",this.logManager=void 0,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return i(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}}))}))},e.prototype.updateContextWithLokiDataAsync=function(e,t){return i(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[2,n];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}}))}))},e.prototype.getLoggerAsync=function(e){return i(this,void 0,void 0,(function(){var t,n;return a(this,(function(r){switch(r.label){case 0:return(t=this.loggers.get(e))?[3,2]:[4,this.getLogManagerAsync()];case 1:n=r.sent(),t=n.getLogger(e),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion",s),r.label=2;case 2:return[2,t]}}))}))},e.prototype.getLogManagerAsync=function(){return i(this,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:return e=this,(t=this.logManager||this.bootstrapperConfig.awtLogManager||window.AWTLogManager)?[3,2]:[4,this.getLogManagerFromCdnAsync()];case 1:t=n.sent(),n.label=2;case 2:return e.logManager=t,[2,this.logManager]}}))}))},e.prototype.getLogManagerFromCdnAsync=function(){return i(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,n.i(o.a)(this.ariaCdnUrl)];case 1:return t.sent(),window.AWTLogManager.initialize(e.AriaLPCBootstrapperTenantToken),[2,window.AWTLogManager]}}))}))},e.prototype.noOp=function(){},e}();u.AriaLPCBootstrapperTenantToken="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"},function(e,t,n){"use strict";function r(e,t){return new Promise((function(r,o){e?(n.i(i.a)(u,e),r(e)):t((function(e,t){e?(n.i(i.a)(u,e),r(e)):o(new a.a("GetAuthTokenError","Auth token is undefined",t))}),(function(e,t){o(new a.a("GetAuthTokenError",e,t))}))}))}function o(e){if(!e)throw Error("Empty AuthToken");var t=s(e);return{tenantId:t.tid,userAadId:t.oid,userPuid:t.puid,expirationTimeEpoch:t.exp}}t.a=r,t.b=o;var i=n(16),a=n(0),s=n(8),u=(n.n(s),"LokiAuthToken")},function(e,t,n){"use strict";function r(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,6]),[4,o(e)];case 1:return n.sent(),[3,6];case 2:return t=n.sent(),c<u?(c++,[4,r(e)]):[3,4];case 3:return n.sent(),[3,5];case 4:throw t.numberOfRetries=c,t;case 5:return[3,6];case 6:return[2]}}))}))}function o(e){return new Promise((function(t,n){var r=document.createElement("script");r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",(function(){t()})),r.addEventListener("error",(function(){n(new i.a("LoadScriptError","Unexpected error while loading script on page."))})),document.body.appendChild(r)}))}t.a=r;var i=n(0),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},u=2,c=0},function(e,t,n){"use strict";function r(e,t,r){if(!m&&v)return v;var o=h.a.getOrCreate(e);return m=!1,(v=new Promise((function(s,v){try{var m,y,w=new p.a;n.i(f.a)(e).then((function(){return n.i(c.a)(e.authToken,e.getAuthToken)})).then((function(t){return w.measureFromStart(p.b.getAuthToken),y=n.i(c.b)(t),e.tenantAadObjectId=y.tenantId,e.userAadObjectId=y.userAadId,e.userPuid=y.userPuid,n.i(u.a)(t,e)})).then((function(e){return w.measureFromStart(p.b.getLokiConfig),m=e,o.updateContextWithLokiDataAsync(m,h.a.AriaLPCBootstrapperTenantToken).catch((function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")}))})).then((function(){return n.i(d.a)(m)})).then((function(){return w.measureFromStart(p.b.getLpcBundles),n.i(l.a)(m,e,w)})).then((function(){var e=i(w.getAllTimings());e.RootCorrelationId=m.RootCorrelationId,o.logEventAsync({name:"initializeLivePersonaCard_success",properties:e},h.a.AriaLPCBootstrapperTenantToken),t&&t(),s()})).catch((function(e){var t=i(w.getAllTimings());o.logEventAsync({name:"initializeLivePersonaCard_failure",properties:g({},a(e),t)},h.a.AriaLPCBootstrapperTenantToken),r&&r("Failed to initialize Live Persona Card: "+e.type),v("Failed to initialize Live Persona Card: "+e.type)}))}catch(e){o.logEventAsync({name:"initializeLivePersonaCard_failure",properties:{IsCatastrophic:!0,Reason:e.toString()}},h.a.AriaLPCBootstrapperTenantToken),r&&r("Failed to initialize Live Persona Card: "+e.name+" "+e.message),v("Failed to initialize Live Persona Card: "+e.name+" "+e.message)}}))).catch((function(){setTimeout((function(){m=!0}),y)})),v}function o(e){return n.i(c.a)(e.authToken,e.getAuthToken).then((function(t){return n.i(u.a)(t,e)}))}function i(e){var t={};return Object.keys(e).forEach((function(n){t["Perf_"+n]=e[n].toString()})),t}function a(e){return{ErrorType:e.type,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLivePersonaCard=r,t.fetchLokiConfig=o;var s=n(5),u=(n.n(s),n(10)),c=n(2),l=n(12),d=n(11),f=n(18),p=n(15),h=n(1),g=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};n.i(s.polyfill)();var v,m=!1,y=3e5},function(e,t,n){(function(t,r){!function(t,n){e.exports=n()}(0,(function(){"use strict";function e(e){return"function"==typeof e||"object"==typeof e&&null!==e}function o(e){return"function"==typeof e}function i(e){N=e}function a(e){V=e}function s(){return void 0!==H?function(){H(c)}:u()}function u(){var e=setTimeout;return function(){return e(c,1)}}function c(){for(var e=0;e<G;e+=2)(0,Z[e])(Z[e+1]),Z[e]=void 0,Z[e+1]=void 0;G=0}function l(e,t){var n=arguments,r=this,o=new this.constructor(f);void 0===o[$]&&M(o);var i=r._state;return i?function(){var e=n[i-1];V((function(){return A(i,o,e,r._result)}))}():x(r,o,e,t),o}function d(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(f);return b(n,e),n}function f(){}function p(){return new TypeError("You cannot resolve a promise with itself")}function h(){return new TypeError("A promises callback cannot return that same promise.")}function g(e){try{return e.then}catch(e){return re.error=e,re}}function v(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function m(e,t,n){V((function(e){var r=!1,o=v(n,t,(function(n){r||(r=!0,t!==n?b(e,n):C(e,n))}),(function(t){r||(r=!0,P(e,t))}),"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,P(e,o))}),e)}function y(e,t){t._state===te?C(e,t._result):t._state===ne?P(e,t._result):x(t,void 0,(function(t){return b(e,t)}),(function(t){return P(e,t)}))}function w(e,t,n){t.constructor===e.constructor&&n===l&&t.constructor.resolve===d?y(e,t):n===re?(P(e,re.error),re.error=null):void 0===n?C(e,t):o(n)?m(e,t,n):C(e,t)}function b(t,n){t===n?P(t,p()):e(n)?w(t,n,g(n)):C(t,n)}function _(e){e._onerror&&e._onerror(e._result),I(e)}function C(e,t){e._state===ee&&(e._result=t,e._state=te,0!==e._subscribers.length&&V(I,e))}function P(e,t){e._state===ee&&(e._state=ne,e._result=t,V(_,e))}function x(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+te]=n,o[i+ne]=r,0===i&&e._state&&V(I,e)}function I(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+n],r?A(n,r,o,i):o(i);e._subscribers.length=0}}function k(){this.error=null}function T(e,t){try{return e(t)}catch(e){return oe.error=e,oe}}function A(e,t,n,r){var i=o(n),a=void 0,s=void 0,u=void 0,c=void 0;if(i){if((a=T(n,r))===oe?(c=!0,s=a.error,a.error=null):u=!0,t===a)return void P(t,h())}else a=r,u=!0;t._state!==ee||(i&&u?b(t,a):c?P(t,s):e===te?C(t,a):e===ne&&P(t,a))}function E(e,t){try{t((function(t){b(e,t)}),(function(t){P(e,t)}))}catch(t){P(e,t)}}function L(){return ie++}function M(e){e[$]=ie++,e._state=void 0,e._result=void 0,e._subscribers=[]}function O(e,t){this._instanceConstructor=e,this.promise=new e(f),this.promise[$]||M(this.promise),D(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&C(this.promise,this._result))):P(this.promise,F())}function F(){return new Error("Array Methods must be provided an Array")}function S(e){return new O(this,e).promise}function R(e){var t=this;return new t(D(e)?function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function j(e){var t=new this(f);return P(t,e),t}function z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(e){this[$]=L(),this._result=this._state=void 0,this._subscribers=[],f!==e&&("function"!=typeof e&&z(),this instanceof U?E(this,e):B())}function q(){var e=void 0;if(void 0!==r)e=r;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=U}var D=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},G=0,H=void 0,N=void 0,V=function(e,t){Z[G]=e,Z[G+1]=t,2===(G+=2)&&(N?N(c):Q())},W="undefined"!=typeof window?window:void 0,Y=W||{},X=Y.MutationObserver||Y.WebKitMutationObserver,J="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),K="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),Q=void 0;Q=J?function(){return t.nextTick(c)}:X?function(){var e=0,t=new X(c),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():K?function(){var e=new MessageChannel;return e.port1.onmessage=c,function(){return e.port2.postMessage(0)}}():void 0===W?function(){try{var e=n(21);return H=e.runOnLoop||e.runOnContext,s()}catch(e){return u()}}():u();var $=Math.random().toString(36).substring(16),ee=void 0,te=1,ne=2,re=new k,oe=new k,ie=0;return O.prototype._enumerate=function(){for(var e=this.length,t=this._input,n=0;this._state===ee&&n<e;n++)this._eachEntry(t[n],n)},O.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===d){var o=g(e);if(o===l&&e._state!==ee)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===U){var i=new n(f);w(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(r(e),t)},O.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===ee&&(this._remaining--,e===ne?P(r,n):this._result[t]=n),0===this._remaining&&C(r,this._result)},O.prototype._willSettleAt=function(e,t){var n=this;x(e,void 0,(function(e){return n._settledAt(te,t,e)}),(function(e){return n._settledAt(ne,t,e)}))},U.all=S,U.race=R,U.resolve=d,U.reject=j,U._setScheduler=i,U._setAsap=a,U._asap=V,U.prototype={constructor:U,then:l,catch:function(e){return this.then(null,e)}},U.polyfill=q,U.Promise=U,U}))}).call(t,n(9),n(19))},function(e,t){function n(e){this.message=e}function r(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,i,a=0,s=0,u="";i=t.charAt(s++);~i&&(r=a%4?64*r+i:i,a++%4)?u+=String.fromCharCode(255&r>>(-2*a&6)):0)i=o.indexOf(i);return u}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||r},function(e,t,n){function r(e){return decodeURIComponent(o(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}var o=n(6);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return r(t)}catch(e){return o(t)}}},function(e,t,n){"use strict";function r(e){this.message=e}var o=n(7);r.prototype=new Error,r.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(d===clearTimeout)return clearTimeout(e);if((d===r||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){g&&p&&(g=!1,p.length?h=p.concat(h):v=-1,h.length&&s())}function s(){if(!g){var e=o(a);g=!0;for(var t=h.length;t;){for(p=h,h=[];++v<t;)p&&p[v].run();v=-1,t=h.length}p=null,g=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,d,f=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{d="function"==typeof clearTimeout?clearTimeout:r}catch(e){d=r}}();var p,h=[],g=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new u(e,t)),1!==h.length||g||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";function r(e,t){return l(this,void 0,void 0,(function(){var i,a;return d(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,8]),[4,o(e,t)];case 1:return i=s.sent(),[3,8];case 2:return(a=s.sent()).statusCode&&401===a.statusCode?[4,n.i(c.a)(void 0,t.getAuthToken)]:[3,4];case 3:e=s.sent(),s.label=4;case 4:return y<m?(y++,[4,r(e,t)]):[3,6];case 5:return i=s.sent(),[3,7];case 6:throw a.numberOfRetries=y,a;case 7:return[3,8];case 8:return[2,i]}}))}))}function o(e,t){return new Promise((function(r,o){var c=new XMLHttpRequest,l=i(t);c.open("GET",l,!0),c.setRequestHeader("authToken",e),c.setRequestHeader("Accept","application/json");var d=n.i(s.a)();c.setRequestHeader("X-RootCorrelationId",d),c.setRequestHeader("X-CorrelationId",d),c.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),c.setRequestHeader("X-ClientType",t.clientType);var f=n.i(a.a)(g);f&&c.setRequestHeader(g,f),c.addEventListener("load",(function(){if(200===c.status)try{var e=JSON.parse(c.response);e.RootCorrelationId=d,e.LokiVersion=c.getResponseHeader("x-serverversion")||"",r(e)}catch(e){o(new u.a("GetLokiConfigError","Failed to parse initialization config.",d))}else o(new u.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+c.status,d,c.status))})),c.addEventListener("error",(function(){o(new u.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",d))})),c.addEventListener("timeout",(function(){o(new u.a("GetLokiConfigError","Loki config request timed out after "+h+" ms.",d))})),c.timeout=h,c.send()}))}function i(e){var t=n.i(a.a)(v)||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?f.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):p.replace("{0}",e.clientType).replace("{1}",t)}t.a=r;var a=n(14),s=n(13),u=n(0),c=n(2),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))},d=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;u;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,i=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(a=(a=u.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},f="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",p="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",h=6e4,g="LivePersonaCardVersionOverride",v="LivePersonaCardCultureOverride",m=2,y=0},function(e,t,n){"use strict";function r(e){var t,r=e.Resources[s];return t="OwaPeopleHub"===e.Workload?e.Resources[a]:e.Resources[i],Promise.all([n.i(o.a)(r),n.i(o.a)(t)])}t.a=r;var o=n(3),i="livepersonacard_with-react",a="livepersonacard_without-react",s="livepersonacardstrings"},function(e,t,n){"use strict";function r(e,t,n){return new Promise((function(r,i){setTimeout((function(){window.LPC||i(new a.a("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||i(new a.a("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));try{var s=o(e,t,n);window.LPC.start(s),r()}catch(e){i(new a.a("StartLivePersonaCardError",e.name+" "+e.message))}}),0)}))}function o(e,t,n){return{refreshAuthToken:i(t),logToExternalApplication:t.logMessage,logToExternalAria:function(e,n){s.a.getOrCreate(t).logEventAsync(e,n)},contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,performanceTimings:n.getAllTimings(),isDebug:!1,region:t.region,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,privateActionCallbacks:t.privateActionCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:t.tenantAadObjectId,userAadObjectId:t.userAadObjectId,userPuid:t.userPuid}}function i(e){return function(t){e.getAuthToken((function(e,n){t(e,"",n)}),(function(e,n){t("",e,n)}))}}t.a=r;var a=n(0),s=n(1)},function(e,t,n){"use strict";function r(){return o.replace(/[xy]/g,(function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)}))}t.a=r;var o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"},function(e,t,n){"use strict";function r(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}t.a=r},function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e.getAuthToken="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesFromStartDuration"}(r||(r={}));var o=function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.getAllTimings=function(){var e=this;if(window.performance&&"function"==typeof window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");t&&t.forEach((function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}}))}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";function r(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}t.a=r},function(e,t,n){"use strict";function r(e){return void 0===e||"string"!=typeof e||""===e||null===e}function o(e){return void 0===e||"function"!=typeof e}t.a=r,t.b=o},function(e,t,n){"use strict";function r(e){return new Promise((function(t,n){var r=o(e);r?n(new a.a("ValidateBootstrapperConfigError",r)):t()}))}function o(e){var t="";if(e){var r=[];n.i(i.a)(e.culture)&&r.push("culture"),n.i(i.a)(e.clientType)&&r.push("clientType"),n.i(i.a)(e.clientContextType)&&r.push("clientContextType"),n.i(i.a)(e.clientCorrelationId)&&r.push("clientCorrelationId"),n.i(i.b)(e.logMessage)&&r.push("logMessage"),n.i(i.b)(e.getAuthToken)&&r.push("getAuthToken"),r.length>0&&(t="Invalid required parameter(s): "+r.join(", ")+". Check the values and types you're passing."),e.region&&-1===s.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+s.join(", ")+" for pre-production environments.")}else t="Config must be defined.";return t}t.a=r;var i=n(17),a=n(0),s=["msit","df","ppe"]},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports="1.5.2"},function(e,t){},function(e,t,n){e.exports=n(4)}])},FVrQ:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeLivePersonaCard",(function(){return B}));var r=n("FdKt"),o=n("NjDY"),i=n("9eA9"),a=n("Lyxw"),s=n("3/02");function u(e){if(!e)return null;const t=new i.a(e);return t.protocol+"//"+t.host}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var c;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,n){const r=[{name:"complianceEnvironment",value:e.complianceEnvironment},{name:"culture",value:e.culture},{name:"firstPartyIntegrationOrigin",value:e.firstPartyIntegrationOrigin},{name:"region",value:e.region}];return t&&r.push({name:"lpcInitializationState",value:t.lpcInitializationState}),n&&(n.HostAppPersonaId&&r.push({name:"HostAppPersonaId",value:n.HostAppPersonaId}),n.PersonaType&&r.push({name:"PersonaType",value:n.PersonaType})),r}!function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(c||(c={}));var d,f,p=n("9zTt");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e.Home="Home",e.Business="Business",e.Other="Other"}(d||(d={})),function(e){e.Home="Home",e.Mobile="Mobile",e.Business="Business"}(f||(f={}));var h=n("5Oca"),g=n("WPtp"),v=n("lY/Z"),m=n("odYE"),y=n("SAYH"),w=n("SZCI"),b=n("DRVD"),_=n.n(b);
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C=["address1_composite","anniversary","birthdate","emailaddress1","entityimage_url","firstname","fullname","jobtitle","lastname","mobilephone","parentcustomerid","telephone1"];function P(e){if(e.fields.emailaddress1)return{Address:Object(g.c)(e.fields.emailaddress1),Kind:d.Business}}function x(e){return"tel:"+e}function I(e){const t=[];if(e.fields.mobilephone){const n=Object(g.c)(e.fields.mobilephone),r={PhoneNumber:n,PhoneUrl:x(n),Type:f.Mobile};t.push(r)}if(e.fields.telephone1){const n=Object(g.c)(e.fields.telephone1),r={PhoneNumber:Object(g.c)(e.fields.telephone1),PhoneUrl:x(n),Type:f.Business};t.push(r)}return t}function k(e){return{anniversary:e.fields.anniversary?Object(g.c)(e.fields.anniversary):void 0,birthday:e.fields.birthdate?Object(g.c)(e.fields.birthdate):void 0,company:e.fields.parentcustomerid?Object(g.c)(e.fields.parentcustomerid):void 0,displayName:e.fields.fullname?Object(g.c)(e.fields.fullname):void 0,email:P(e),kind:"Person",firstName:e.fields.firstname?Object(g.c)(e.fields.firstname):void 0,jobTitle:e.fields.jobtitle?Object(g.c)(e.fields.jobtitle):void 0,lastName:e.fields.lastname?Object(g.c)(e.fields.lastname):void 0,officeLocation:e.fields.address1_composite?Object(g.c)(e.fields.address1_composite):void 0,phoneNumbersAndUrls:I(e)}}function T(e){if(e){const t=e.split(":");if(2===t.length)return{logicalName:t[0],recordId:t[1]}}return null}function A(e,t,n){return e?e.PersonaType?!("External"===e.PersonaType&&!e.HostAppPersonaId)||(t.error("HostAppPersonaId is null or undefined for external contact in getDataCallback function",n),!1):(t.error("PersonaType null or undefined in getDataCallback function",n),!1):(t.error("PersonaIdentifiers null or undefined in getDataCallback function",n),!1)}function E(e,t,n,r){return{getPersonaInfo:(o,i)=>{const a=l(n,t,o);if(A(o,r,a)&&"External"===o.PersonaType){const n=T(o.HostAppPersonaId);if(!n)return void r.error("HostAppParams null for non null hostAppId",a);const s=_.a.createEvent("getDataCallback.getPersonaInfo",w.j).startStopwatch(),u=n.recordId;let c=Object(h.h)(e.getState(),"contact",u);const l=function(e){if(!e||!e.fields)return C;const t=[];for(const n of C)e.fields[n]||t.push(n);return t}(c);try{if(l.length>0){const t=new m.a("contact",new y.a(u));e.dispatch(Object(v.d)(t,l)).then(()=>{c=Object(h.h)(e.getState(),"contact",u),c&&c.fields&&i(k(c),void 0)})}else c&&c.fields&&i(k(c),void 0)}catch(e){t.EventManager.ReportComponentFailure("LivePersonaCard.GetDataCallback",e,"getPersonaInfo function failed.",a)}finally{s({missingFields:l.join()})}}},getAndPrefetchPersonaImageUri:(o,i,a)=>{const s=l(n,t,o);if(!A(o,r,s))return;const u=_.a.createEvent("getDataCallback.getAndPrefetchPersonaImageUri",w.j).startStopwatch();try{if("External"===o.PersonaType){const t=T(o.HostAppPersonaId);if(!t)return void r.error("HostAppParams null for non null hostAppId",s);const n=t.recordId;let a=Object(h.h)(e.getState(),"contact",n);if(a&&a.fields&&a.fields.entityimage_url)i(Object(g.c)(a.fields.entityimage_url));else{const t=new m.a("contact",new y.a(n));e.dispatch(Object(v.d)(t,["entityimage_url"])).then(()=>{a=Object(h.h)(e.getState(),"contact",n),a&&a.fields&&a.fields.entityimage_url&&i(Object(g.c)(a.fields.entityimage_url))})}}else"User"===o.PersonaType&&i(void 0)}catch(e){t.EventManager.ReportComponentFailure("LivePersonaCard.GetDataCallback",e,"getAndPrefetchPersonaImageUri function failed.",s)}finally{u({personaType:o.PersonaType})}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function L(e){return e&&void 0!==e.reason}function M(e){return e&&void 0!==e.message}function O(e){return e?M(e)?F(e.message):F(e):""}function F(e){return e&&"string"==typeof e?e.replace(/https?:\/\/[\n\S]+/g,"[REDACTED_URL]"):""}var S=n("mlvZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const R="LivePersonaCard.LivePersonaCardIntegrationProxy";class j{constructor(e,t,n,r){this._requestMap={},this._context=t,this._configuration=n,this._store=e,this._tracer=r}static initialize(e,t,n,r){if(!e)throw new Error("Argument store:IMiddlewareStore<IApplicationState> cannot be null or undefined.");if(!t)throw new Error("Argument context:IApplicationContext cannot be null or undefined.");if(!n)throw new Error("Argument configuration:ILivePersonaCardConfiguration cannot be null or undefined.");this._initialized?r.warn("LivePersonaCardIntegrationProxy: initialize() called when already initialized"):(this._instance=new j(e,t,n,r),this._instance._registerMessageListener(),this._initialized=!0,r.info("LivePersonaCardIntegrationProxy: initialized",l(n,t)))}_registerMessageListener(){this._tracer.info("LivePersonaCardIntegrationProxy: Registered message listener",l(this._configuration,this._context)),window.addEventListener("message",e=>{this._receiveMessage(e)})}_receiveMessage(e){try{if(t=this._configuration,n=e.origin,!t||!n||t.firstPartyIntegrationOrigin!==u(n))return void this._tracer.info("LivePersonaCardIntegrationProxy: Message from invalid origin, ignoring: "+e.origin,this._getEventParametersForOperation("_receiveMessage"));const r=e.data;if(!r)return void this._tracer.info("LivePersonaCardIntegrationProxy: Unrecognized message event data, ignoring",this._getEventParametersForOperation("_receiveMessage"));switch(r.method){case"LivePersonaCardAppLoaded":this._handleAppLoadedMessage(r);break;case"GetAuthToken":this._handleGetAuthTokenMessage(r);break;case"LivePersonaCardTelemetryInfo":this._handleTelemetryInfoMessage(r)}}catch(e){const t=this._getEventParametersForOperation("_receiveMessage");this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}var t,n;
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */}_getAuthToken(e,t,n,r){try{const o=_.a.createEvent("_getAuthToken",w.j),i={id:y.a.toString(y.a.newGuid()),createdOn:Date.now(),onSuccess:e,onFailure:t,bootstrap:n,retryCount:r||0,endStopwatch:o.startStopwatch()};this._requestMap[i.id]=i,this._makePostMessageCall(i)}catch(e){const t=this._getEventParametersForGetAuthTokenOperation("_getAuthToken",n,r);this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}}_handleTelemetryInfoMessage(e){const t=this._getEventParametersForLivePersonaCardMessage(e,"_handleTelemetryInfoMessage");this._context.EventManager.ReportComponentSuccess(R,t)}_handleAppLoadedMessage(e){const t=this._getEventParametersForLivePersonaCardMessage(e,"_handleAppLoadedMessage");try{if(e.isFailure)throw new Error(e.errorMessage||"");this._needsBootstrapping()?this._startBootstrap():this._tracer.warn("FirstPartyIntegration app reported successful load, bootstrapping not needed or already in progress",t),this._context.EventManager.ReportComponentSuccess(R,t)}catch(e){this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}}_handleGetAuthTokenMessage(e){const t=this._getEventParametersForLivePersonaCardMessage(e,"_handleGetAuthTokenMessage");try{if(!e.requestId||!e.isResponse)return void this._tracer.warn("Invalid response (no request ID, or not a response).",t);const r=this._requestMap[e.requestId];if(!r)throw new Error(`Response message with ID ${e.requestId} not found in request map.`);if(r.endStopwatch&&r.endStopwatch(Object(S.c)(t)),delete this._requestMap[r.id],t.push({name:"bootstrap",value:!!r.bootstrap}),t.push({name:"retryCount",value:r.retryCount||0}),this._isFailedRequestToBeRetried(e,r))return t.push({name:"retry",value:!0}),this._context.EventManager.ReportComponentFailure(R,new Error(e.errorMessage||""),"Check error details to know why execution failed.",t),void setTimeout(()=>{this._getAuthToken(r.onSuccess,r.onFailure,r.bootstrap,r.retryCount+1)},this._getBootstrapRetryIntervalInMilliseconds(r.retryCount));if(e.isFailure)throw r.onFailure(e.errorMessage,this._context.EventManager.getActivityId()),new Error(e.errorMessage||"");if(!(n=e.response)||void 0===n.token||!e.response.token)throw r.onFailure(e.errorMessage,this._context.EventManager.getActivityId()),new Error("Unable to retrieve token from response. Response was not marked as a failure.");r.onSuccess(e.response.token,this._context.EventManager.getActivityId()),this._context.EventManager.ReportComponentSuccess(R,t)}catch(e){this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}var n}_isFailedRequestToBeRetried(e,t){return e&&e.isFailure&&t&&t.bootstrap&&t.retryCount<2&&L(e.response)&&/(Authentication failed, please authenticate at the provided Url)|(Invalid Dynamics 365 user)|(Token renewal operation failed due to timeout)/i.test(M(e.response.reason)?e.response.reason.message||"":e.response.reason||"")}_getBootstrapRetryIntervalInMilliseconds(e){return 1e3*Math.pow(2,Math.max(0,e)+1)}_getEventParametersForOperation(e){const t=l(this._configuration,this._context);return e&&t.push({name:"operation",value:e}),t}_getEventParametersForGetAuthTokenOperation(e,t,n){const r=l(this._configuration,this._context);return r.push({name:"operation",value:e}),r.push({name:"bootstrap",value:!!t}),r.push({name:"retryCount",value:n||0}),r}_getEventParametersForGetAuthTokenRequest(e,t){const n=this._getEventParametersForOperation(t);return n.push({name:"request.id",value:e.id}),n.push({name:"request.createdOn",value:e.createdOn}),n.push({name:"request.bootstrap",value:e.bootstrap}),n}_getEventParametersForLivePersonaCardMessage(e,t){const n=this._getEventParametersForOperation(t);return n.push({name:"message.method",value:e.method}),n.push({name:"message.requestId",value:e.requestId}),n.push({name:"message.isResponse",value:e.isResponse}),n.push({name:"message.isFailure",value:e.isFailure}),n.push({name:"message.errorMessage",value:O(e.errorMessage)}),n.push({name:"message.errorSource",value:e.errorSource}),n.push({name:"message.adalErrorMessage",value:e.adalErrorMessage}),n.push({name:"message.telemetryInfoLogs",value:e.telemetryInfoLogs}),L(e.response)&&n.push({name:"message.response.reason",value:O(e.response.reason)}),n}_makePostMessageCall(e){const t=this._getEventParametersForGetAuthTokenRequest(e,"_makePostMessageCall");try{const n=document.getElementById("LivePersonaCard_FirstPartyIntegration_IFrame");if(!n||!n.contentWindow)throw new Error("Failed to retrieve integration iframe LivePersonaCard_FirstPartyIntegration_IFrame.");const r=this._configuration.firstPartyIntegrationOrigin;if(!r)throw new Error("firstPartyIntegrationOrigin is null or undefined.");const o={requestId:e.id,method:"GetAuthToken"};n.contentWindow.postMessage(o,r),this._tracer.debug("Made postMessage call to FirstPartyIntegration iframe for GetAuthToken request",t)}catch(e){this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}}_needsBootstrapping(){return this._context.lpcInitializationState!==c.Initializing&&this._context.lpcInitializationState!==c.Initialized}_startBootstrap(e){this._tracer.info("Starting bootstrap, setting LivePersonaCardInitializationState.Initializing, initializing LivePersonaCard",this._getEventParametersForOperation("_startBootstrap")),this._context.lpcInitializationState=c.Initializing,this._getAuthToken((e,t)=>{this._onBootstrapSuccess(e)},(e,t)=>{this._onBootstrapFailure(e)},!0)}_onBootstrapSuccess(e){this._tracer.info("Bootstrap token acquisition successful, initializing LivePersonaCard",this._getEventParametersForOperation("_onBootstrapSuccess"));try{Object(p.initializeLivePersonaCard)(this._getBootstrapperConfig(e),()=>{this._context.lpcInitializationState=c.Initialized;const e=this._getEventParametersForOperation("initializeLivePersonaCard.onSuccess");this._context.EventManager.ReportComponentSuccess(R,e)},e=>{this._context.lpcInitializationState=c.Failed;const t=new Error(e||""),n=this._getEventParametersForOperation("initializeLivePersonaCard.onFailure");this._context.EventManager.ReportComponentFailure(R,t,"Check error details to know why execution failed.",n)})}catch(e){const t=this._getEventParametersForOperation("_onBootstrapSuccess");this._context.EventManager.ReportComponentFailure(R,e,"Check error details to know why execution failed.",t)}}_onBootstrapFailure(e){this._context.lpcInitializationState=c.Failed;const t=new Error(e||""),n=this._getEventParametersForOperation("_onBootstrapFailure");this._context.EventManager.ReportComponentFailure(R,t,"Check error details to know why execution failed.",n)}_getBootstrapperConfig(e){return{culture:this._configuration.culture,region:this._configuration.region,clientType:"Dynamics365UCI",clientContextType:"Generic",clientCorrelationId:this._context.EventManager.getCurrentSessionId(),logMessage:this._getBootstrapperLogger(),getAuthToken:(e,t)=>this._getAuthToken(e,t),authToken:e,actionCallbacks:void 0,dataCallbacks:E(this._store,this._context,this._configuration,this._tracer)}}_getBootstrapperLogger(){return(e,t,n)=>{const r=[{name:"logType",value:e},{name:"logResultType",value:t},{name:"message",value:n}];if("Success"===t)this._context.EventManager.ReportComponentSuccess("LivePersonaCard.Logs",r);else{const e=new Error(n||"");this._context.EventManager.ReportComponentFailure("LivePersonaCard.Logs",e,"Check error details to know why execution failed.",r)}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function z(e,t){return{type:"livepersonacard.initialize.firstpartyintegration.sync",sync:!0,execute(n,r){j.initialize(n,r,e,t),function(e,t){const n=document.createElement("iframe");n.id=n.name="LivePersonaCard_FirstPartyIntegration_IFrame",n.height=n.width=n.frameBorder="0",n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex","-1"),n.setAttribute("src",encodeURI(e.firstPartyIntegrationUrl)),n.onerror=n=>{t.error("LivePersonaCard FirstPartyIntegration iframe.onerror: "+n,l(e))},document.body.appendChild(n),t.info("LivePersonaCard FirstPartyIntegration iframe created",l(e))}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t)}}}function B(){return{type:"livepersonacard.initialize.sync",sync:!0,execute(e,t){const n=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e){const t=Object(o.x)(e);if(!t||!t.enableLivePersonaCardUCI)return{enabled:!1};const n=Object(a.c)(e,s.gc)?function(e){return e?e+"&adalVerbose=true":null}(t.livePersonaCardFirstPartyIntegrationUrl):t.livePersonaCardFirstPartyIntegrationUrl;return{enabled:t.enableLivePersonaCardUCI,complianceEnvironment:t.livePersonaCardComplianceEnvironment,culture:t.livePersonaCardCulture,firstPartyIntegrationUrl:n,firstPartyIntegrationOrigin:u(t.livePersonaCardFirstPartyIntegrationUrl),region:t.livePersonaCardRegion,debug:!1}}(e.getState()),i=t.TraceManager.getTracer("LivePersonaCard");n&&n.enabled?(i.info("LivePersonaCard integration is enabled, initializing.",l(n,t)),Object(r.b)(()=>e.dispatch(z(n,i)),"Initialize LivePersonaCard")):i.info("LivePersonaCard integration is not enabled.")}}}}}]),window.bundleExecutionMarkers["scripts/livepersonacard.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();