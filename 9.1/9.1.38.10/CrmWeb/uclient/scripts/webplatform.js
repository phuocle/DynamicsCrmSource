(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/webplatform.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[108],{"4QP1":function(e,t,r){"use strict";r.r(t),r.d(t,"WebPlatform",(function(){return U}));var n=r("Qois");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const i={};class a{executeServiceOperation(e,t,r){return new Promise((t,r)=>{const i=e.getServiceName(),a=e.getOperationName();r({errorCode:n.a.ServiceAndOperationNotSupported,param:i+"."+a})})}static getAvailableServiceOperations(e){return null}}var o=r("NjDY"),s=r("H4dV");var l=r("5RA1"),c=r("uM6Y"),u=r("VkXQ"),p=r("r6hG"),d=r("zsAz");class m{executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case u.d.openFile.name:return this._openFile(e,t);case u.d.pickFile.name:let i;if(e.getParameters()&&e.getParameters()[0]&&(i=e.getParameters()[0]),null==i?void 0:i.useBinaryReader){return t.TraceManager.getTracer().error("pickFile with useBinaryReader=true is currently not supported on web platform"),new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"pickFile with useBinaryReader=true is currently not supported on web platform"})})}return this._pickFile(e,r)}return new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"FileManager."+i})})}_openFile(e,t){return new Promise((r,i)=>{const a=e.getParameters()[0],o=e.getParameters()[1].openMode,l=a.fileName,c=a.fileContent,u=t.TraceManager.getTracer();if(!a)return u.error("Parameter file is null or undefined"),i({errorCode:n.a.OpenDocumentErrorCodeGeneric});if(a.fileName||(a.fileName="Default_name_"+Date.now()),!a.mimeType)return u.error("Parameter file.mimeType is null or undefined"),i({errorCode:n.a.OpenDocumentErrorCodeGeneric});if(!a.fileContent)return u.error(`File ${a.fileName} doesnâ€™t have any content and cannot be opened.`),i({errorCode:n.a.OpenDocumentErrorCodeGeneric});const p=this._base64ToBlob(c,a.mimeType);switch(o){case 2:return window.navigator.msSaveBlob?window.navigator.msSaveBlob(p,l):s.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?this._saveBlobForSafari(p,i,u):this._saveOrOpenBlob(p,l),r();case 1:return window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(p,l):s.a.getInstance().get_IsMacSafariNotSupportAnchorDownload()?this._saveBlobForSafari(p,i,u):this._saveOrOpenBlob(p),r();default:return u.error("Unknown mode value for openFile operation"),i({errorCode:n.a.OpenDocumentErrorCodeGeneric})}})}_pickFile(e,t){return new Promise((r,n)=>{let i;e.getParameters()&&e.getParameters()[0]&&(i=e.getParameters()[0]);const a=!(!i||!i.allowMultipleFiles)&&i.allowMultipleFiles,s=i&&i.maximumAllowedFileSize&&i.maximumAllowedFileSize>0?i.maximumAllowedFileSize:Object(o.x)(t.getState()).maxUploadFileSize,l=i&&i.accept?i.accept:"*";this._pickFileInternal(t,a,s,l).then(e=>{document.body.removeChild(this._fileInput),r(e)},e=>{document.body.removeChild(this._fileInput),n(e)})})}_pickFileInternal(e,t,r,i){return new Promise((e,a)=>{const o=document.getElementById("filepickerid");o?(this._fileInput=o,this._fileInput.multiple=t,this._fileInput.accept=i):(this._fileInput=document.createElement("input"),this._fileInput.type="file",this._fileInput.id="filepickerid",this._fileInput.style.display="none",this._fileInput.multiple=t,this._fileInput.accept=i,this._fileInput.onchange=t=>{const i=t.target.files;for(let e=0;e<i.length;e++){if(i[e].size>r)return void a({errorCode:n.a.FilePickerErrorFileSizeBreached,param:r/1024});if(0===i[e].size)return void a({errorCode:n.a.FilePickerErrorFileSizeCannotBeZero})}const o=[];let s=0;for(let t=0;t<i.length;t++){const r=new FileReader;r.onload=()=>{const n=r.result,a=n.substring(n.indexOf(",")+1),c={fileName:i[t].name,mimeType:i[t].type,fileContent:a,fileSize:Math.ceil(a.length*l.a)};o.push(c),s++,s===i.length&&e(o)},r.onerror=e=>{const r=Object(d.d)("FileReader Error",n.a.FilePickerErrorUnableToOpenFile,[{name:"mimeType",value:i[t].type}]);r.innerError=e,a(r)},r.readAsDataURL(i[t])}},document.body.appendChild(this._fileInput)),this._fileInput.click()})}_base64ToBlob(e,t){const r=window.atob(e),n=r.length,i=new ArrayBuffer(n),a=new Uint8Array(i);for(let e=0;e<n;e++)a[e]=r.charCodeAt(e);return new Blob([i],{type:t})}_saveOrOpenBlob(e,t){const r=window.URL.createObjectURL(e);!
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t){const r=document.createElement("a");r.setAttribute("href",e),s.a.getInstance().get_IsMacSafari()||r.setAttribute("target","_blank"),t&&r.setAttribute("download",t),document.body.appendChild(r),r.click(),document.body.removeChild(r)}(r,t),window.URL.revokeObjectURL(r)}_saveBlobForSafari(e,t,r){const i=new FileReader;i.onloadend=()=>{let t=i.result,r=document.getElementById("__mscrm.safariopenfileiframe");r||(r=document.createElement("iframe"),r.style.display="none",document.body.appendChild(r),r.id="__mscrm.safariopenfileiframe"),(e.type.startsWith("text")||e.type.startsWith("image")||e.type.startsWith("application"))&&(t=t.replace(e.type,"application/octet-stream")),r.src=t},i.onerror=e=>(r.error("Something is wrong with buffer data. Error: "+e.toString()),t({errorCode:n.a.OpenDocumentErrorCodeGeneric})),i.readAsDataURL(e)}static getAvailableServiceOperations(){return Object(p.a)(c.d,u.d)}}var g=r("UwOy"),h=r("Knfm"),w=r("GEbX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class f{executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case u.g.navigateBackOutOfApp.name:return this._goToPreviousPage(t,r.getState());case u.g.openUri.name:return this._openUri(e);case u.g.canOpenUri.name:return Promise.resolve(!0)}return new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"FileManager."+i})})}_goToPreviousPage(e,t){return Object(g.e)(t)||Object(h.a)(t)===w.a.MultiSession?e.Router.navigateToDefault():(window.history.back(),Promise.resolve({status:0,pageId:null}))}_openUri(e){return new Promise((t,r)=>{const n=e.getParameters()[0],i=e.getParameters()[1];let a="";if(f._wellKnownProtocols.some(e=>n.startsWith(e)))return window.location.href=n,void t();i&&i.openInNewWindow&&(a=i.width?a+"width="+i.width+",":"",a=i.height?a+"height="+i.height+",":"",a+="resizable=1"),window.open(n,"_blank",a),t()})}static getAvailableServiceOperations(e){const t=Object.assign({},u.g);return delete t.switchApp,(Object(g.e)(e)||Object(h.a)(e)===w.a.MultiSession)&&delete t.navigateBackOutOfApp,Object(p.a)(c.g,t)}static _getWellKnownExternalProtocols(){const e=["mailto:","tel:"];return s.a.getInstance().get_IsMacSafari()?e:e.concat(["ms-word:","ms-excel:","ms-powerpoint:","onenote:","skype:"])}}f._wellKnownProtocols=f._getWellKnownExternalProtocols();var b=r("IqkD"),v=r("pgSX"),O=r("gQ5I"),_=r("si7p"),S=r("YxC/"),A=r("tICD"),y=r("JRzo"),P=r("ErQw"),C=r("uufl"),E=r("OpjU"),F=r("jZCH"),I=r("Uv1Y"),j=r("9eA9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class x{executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case u.i.signOut.name:return this._signOut(t,r);case u.i.handleAuthError.name:return this._handleAuthError(t,r)}return new Promise((e,t)=>{t({errorCode:n.a.ServiceAndOperationNotSupported,param:"UserAccount."+i})})}_signOut(e,t){return new Promise((r,n)=>{const i=[];i.push(F.a.get_DefaultInstance().clearAllData()),i.push(F.a.get_DefaultInstance().updateSecureContext()),Promise.all(i).then(()=>{e.Dispose();const n=Object(j.b)(),i=Object(b.w)(t.getState());window.location.href=i.isLive?`${n}/main.aspx?signout=1&redirect=${n}/main.aspx`:n+"/main.aspx?signout=1",r()},t=>{e.TraceManager.getTracer("SignOut").error("Signout failed, errorDetail: "+t.toString()),n({errorCode:-2147093993})})})}_handleAuthError(e,t){const r=e.TraceManager.getTracer("HandleAuthError");return Object(C.a)(t.getState())?(r.warn("Not showing autherror dialog. A reauth dialog is already showing"),Promise.resolve()):(t.dispatch(Object(E.b)(!0)),new Promise((e,n)=>{const i=Object(S.e)(t.getState(),y.o),a=i[y.d],o=i[y.a],s=i[y.m],l=i[y.g];t.dispatch(Object(v.a)(_.b,"",P.b,s,a,o,l)).then(i=>{if(0===i.status){const a=window.RegisterAuthExpiryReminder;return this._registerAuthCompleteHandler(i.pageId,t,a),t.dispatch(Object(A.a)(i.pageId)).then(i=>{if(i&&i.value&&i.value.confirmed)e();else{const e=[{name:"output_value",value:i&&i.value}];r.warn("User closed signin prompt without signing in",e),n(new I.a("User closed signin prompt without signing in",2415919124))}this._unregisterAuthCompleteHandler(a),t.dispatch(Object(E.b)(!1))}).catch(e=>{throw this._unregisterAuthCompleteHandler(a),e})}const a=[{name:"navigation_error_parameters",value:i.error&&i.error.errorParameters},{name:"navigation_error_message",value:i.error&&i.error.displayMessage}];r.warn("Failed to open signin dialog",a),n(new I.a("Failed to signin")),t.dispatch(Object(E.b)(!1))}).catch(e=>{r.warn("Failure when trying to open auth error handling dialog. Error: "+e),t.dispatch(Object(E.b)(!1)),n(e)})}))}_registerAuthCompleteHandler(e,t,r){window.RegisterAuthExpiryReminder=(...n)=>{r&&r.apply(null,n),null!==e&&t.dispatch(Object(O.e)(e))}}_unregisterAuthCompleteHandler(e){window.RegisterAuthExpiryReminder=e}static getAvailableServiceOperations(e){const t=Object(b.w)(e);if(t&&(t.isLive||!t.usePathBasedUrls))return Object(p.a)(c.i,{signOut:u.i.signOut,handleAuthError:u.i.handleAuthError})}}var k=r("9gmQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var B=r("SX+A"),R=r("sclX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class U{executeServiceOperation(e,t,r){return function(e){switch(e.getServiceName()){case c.d:return new m;case c.g:return new f;case c.i:return new x;default:return new a}}(e).executeServiceOperation(e,t,r)}addOnPlatformReady(e,t,r){!function(e,t){const r=[],n=t.getState();for(const e in i)r.push(a.getAvailableServiceOperations(e));r.push(f.getAvailableServiceOperations(n)),r.push(m.getAvailableServiceOperations()),r.push(x.getAvailableServiceOperations(n));const o={};for(let e=0;e<r.length;e++){const t=r[e];t&&(o[t.name]=t)}t.dispatch(Object(k.b)(o))}(0,r),r.dispatch(Object(B.d)(R.b.Web)),e()}}},"5RA1":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const n=.75},r6hG:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function n(e,t){return{name:e,operations:t}}r.d(t,"a",(function(){return n}))}}]),window.bundleExecutionMarkers["scripts/webplatform.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();