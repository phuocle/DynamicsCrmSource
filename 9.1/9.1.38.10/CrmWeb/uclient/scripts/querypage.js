(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/querypage.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[99],{Hv5K:function(e,t,i){"use strict";i.r(t),i.d(t,"Query",(function(){return P}));var o=i("u+q+"),s=i("nuS9"),r=i("YWpA"),n=i("o0iw"),a=i("2Sll"),l=i("42hY"),c=i("igP1"),d=i("YO7l"),u=i("PMTb"),y=i("xagu"),h=i("pF61");class p{getCommandButtons(e){return[this._createRunQueryButton(e),this._createSwitchToClassicButton(e)]}_createRunQueryButton(e){return{Icon:"Play",DisplayText:e().ribbonLabels.runQuery,Tooltip:{title:e().ribbonLabels.runQuery},Id:"RunQuery",execute:{type:"query.runquery",execute:({dispatch:t})=>e().runQuery()}}}_createSwitchToClassicButton(e){return{Icon:"OpenPane",DisplayText:e().ribbonLabels.switchToClassic,Tooltip:{title:e().ribbonLabels.switchToClassic},Id:"SwitchToClassic",execute:{type:"query.switchtoclassic",execute:({dispatch:t})=>e().switchToClassic()}}}}var m=i("UA/f"),w=i("6Cai");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class b extends s.Component{constructor(){super(...arguments),this.state={query:void 0}}render(){const{query:e}=this.state,t=this.props.options.filter(t=>{if(!e)return!0;return t.text.toLowerCase().indexOf(e.toLowerCase())>=0});return s.createElement(m.a,Object.assign({},this.props,{options:t,onRenderList:(t,i)=>s.createElement(s.Fragment,null,s.createElement(w.a,{value:e,underlined:!0,onChange:(e,t)=>this.setState({query:t})}),i(t))}))}}var g=i("Ki7F"),C=i("XIN1"),S=i("d0w6"),M=i("SAYH"),_=i("zVFX"),v=i("5O6t"),I=i("BFlg"),f=i("ZGH+");function x(e){return Object(f.c)()*parseFloat(e)}var B=i("b6Tl"),T=i("arV0"),V=i("unFF"),O=i("IqkD"),L=i("zzhk"),k=i("KBcj"),z=i("b8TU"),E=i("9eA9"),j=i("a72m"),R=i("0uKS"),D=i("iZ7K");Object(a.a)();class A extends s.Component{constructor(e){super(e),this._queryCommands=new p,this._entityDropdownList=[],this._onRenderOption=e=>s.createElement(r.a,null,e.data&&e.data.icon&&s.createElement(l.a,{style:this.props.queryStyles.viewStyle.dropdownIconStyle,iconName:e.data.icon,"aria-hidden":"true",title:this.props.localizedLabels.addNewView}),s.createElement(u.a,null,e.text)),this._onChangeEntitySelection=this._onChangeEntitySelection.bind(this),this._onChangeViewSelection=this._onChangeViewSelection.bind(this),this._onRunQuery=this._onRunQuery.bind(this),this._onSwitchToClassic=this._onSwitchToClassic.bind(this),this._collectSelectedViewDetails=this._collectSelectedViewDetails.bind(this),this._onRenderOption=this._onRenderOption.bind(this);for(const t in e.entities){const i=e.entities[t],o=i.DisplayName;o&&this._entityDropdownList.push({key:t,text:o,data:{entityId:i.Id,entityTypeName:t,entityTypeCode:i.ObjectTypeCode}})}let t;if(this._entityDropdownList.length){this._entityDropdownList.sort((e,t)=>e.key.localeCompare(t.key));const e=this._entityDropdownList[0];e.selected=!0,t=e.key,this.props.fetchViews(t)}this.state={selectedEntityName:t,selectedViewId:this._entityDropdownList.length?"add_new_view":void 0}}render(){const e=this.props.queryStyles.viewStyle,{options:t,shouldDisable:i}=this._generateViewDropdownOptions();return s.createElement(r.a,{key:"queryRoot",id:"QueryView",testhooks:{id:"QueryView"},style:e.viewStyle},this._renderPageHeaderButtons(),s.createElement(r.a,{key:"queryPageContents",style:e.viewContentsStyle},s.createElement(b,{label:this.props.localizedLabels.entity,options:this._entityDropdownList,onChange:this._onChangeEntitySelection,styles:e.dropdownStyle}),s.createElement(b,{label:this.props.localizedLabels.view,selectedKey:this.state.selectedViewId,disabled:i,options:t,onChange:this._onChangeViewSelection,styles:e.dropdownStyle,onRenderOption:this._onRenderOption}),s.createElement(c.a,{text:this.props.localizedLabels.runQuery,styles:e.buttonStyle,onClick:this._onRunQuery,disabled:!this.state.selectedEntityName||!this.state.selectedViewId})))}_renderPageHeaderButtons(){const e=[this._renderCommandBar(),this._renderSelectorRow()],t=this._isMobileStyle()?this.props.queryStyles.viewStyle.headerContainerMobileStyle:this.props.queryStyles.viewStyle.headerContainerStyle;return s.createElement(r.a,{key:"headerButtonsWrapper"},s.createElement(r.a,{key:"headerButtons",style:t},e))}_renderCommandBar(){this._initializeCommandBar();const e=this.props.queryStyles.commandBarStyles,t=this._isMobileStyle()?e.commandBarMobileStyle:e.commandBarStyle,i=this._isMobileStyle()?e.commandBarWrapperMobileStyle:e.commandBarWrapperStyle;return Object(n.b)(this.props.commandBarRefreshProps,t,!1),s.createElement(r.a,{id:"Query:null",key:"Query:null",style:i},s.createElement(g.a,{commandbarDisplayMode:n.a.IconLabel,key:"QueryCommandBar",addedCommandList:this._addedCommandList,iconPosition:C.a.Left,id:this.props.id,ribbonId:null,commandManagerId:this.props.id,commandBarStyle:t,customCommandManagerStyle:e.customCommandManagerStyle,isDashboardCommandBar:!0}))}_renderSelectorRow(){const e=this.props.queryStyles.headerStyle,t=this._isMobileStyle()?e.headerInnerMobileStyle:e.headerInnerStyle;return s.createElement(r.a,{key:"selectorRow",style:e.headerStyle},s.createElement(r.a,{key:"selectorRow",style:t},s.createElement(u.a,{style:this.props.queryStyles.viewSelectorStyle.textStyle},"Query")))}_initializeCommandBar(){this._addedCommandList=[];const e=this._queryCommands.getCommandButtons(()=>({ribbonLabels:this.props.ribbonLabels,runQuery:this._onRunQuery,switchToClassic:this._onSwitchToClassic}));this._addedCommandList.push(...e)}_onChangeEntitySelection(e,t,i){this.props.viewSelectors&&this.props.viewSelectors[t.key]||this.props.fetchViews(t.key),this.setState({selectedEntityName:t.key,selectedViewId:"add_new_view"})}_onChangeViewSelection(e,t,i){this.setState({selectedViewId:t.key})}_onRunQuery(){const e=this._collectSelectedViewDetails();if(e)return this.props.runQuery(this.state.selectedEntityName,e);console.error("No view selected!")}_onSwitchToClassic(){const e=this._collectSelectedViewDetails();if(!e)return void console.error("No view selected!");const t=this._entityDropdownList.find(e=>e.key===this.state.selectedEntityName);return this.props.openClassicAdvancedFind(t.data,e,this.props.viewPortWidth,this.props.viewPortHeight,this.props.crmBaseUrl)}_generateViewDropdownOptions(){const e=this.state.selectedEntityName;if(!this.state||!e)return{options:[],shouldDisable:!0};const t=this.props.viewSelectors&&this.props.viewSelectors[e];if(!t||!("MAIN_APPLICATION_VIEW"in t)||!("ADVANCED_SEARCH"in t))return{options:[{key:"loading_views",text:this.props.localizedLabels.loadingViews}],shouldDisable:!0};const i=[];i.push({key:"add_new_view",text:this.props.localizedLabels.addNewView,data:{icon:"Add"}});const o=t&&t[S.a[S.a.MAIN_APPLICATION_VIEW]],{myViews:s,systemViews:r}=this._getViewDropdownOptions(o);return s.length&&(i.push({key:"divider_1",text:"-",itemType:d.a.Divider}),i.push({key:"my_views",text:this.props.localizedLabels.myViews,itemType:d.a.Header}),i.push(...s)),r.length&&(i.push({key:"divider_1",text:"-",itemType:d.a.Divider}),i.push({key:"system_views",text:this.props.localizedLabels.systemViews,itemType:d.a.Header}),i.push(...r)),{options:i,shouldDisable:!1}}_getViewDropdownOptions(e){const t=[],i=[];for(const o in e){const s=e[o],r=s.name;r&&(s.isUserView?t.push({key:o,text:r}):i.push({key:o,text:r}))}return{myViews:t,systemViews:i}}_collectSelectedViewDetails(){if(!this.state.selectedViewId)return;const e=this.state.selectedEntityName,t=this.props.viewSelectors&&this.props.viewSelectors[e],i=t&&t[S.a[S.a.MAIN_APPLICATION_VIEW]];if("add_new_view"===this.state.selectedViewId){const t=this.props.defaultViewSelectors[e].ADVANCED_SEARCH;return{viewId:t,viewType:1039,isAdvancedFindView:!!t}}const o=i[this.state.selectedViewId];return{viewId:new M.a(this.state.selectedViewId),viewType:o.queryType,isAdvancedFindView:!1}}_isMobileStyle(){return!1}}const Q=Object(o.a)(function(){let e,t,i,o,s,r;const a=
//  * @license Copyright (c) Microsoft Corporation. All rights reserved.
function(){let e=null;return function(t,i,o){if(!e){const s=Object(n.p)(i,null);s.container.marginLeft="0px",s.container.marginRight="0px",s.container.width="100%",s.container.backgroundColor=t.colors.MainThemeColor.MainColor1.Fill,s.listItemBody.text.color=_.a.colors.MainThemeColor.MainColor1.Text,s.listItemBody.icon.color=_.a.colors.MainThemeColor.MainColor1.Text,s.listItemBody.icon.fontSize="16px",s.listItemBody.iconWrapperStyles.color=_.a.colors.MainThemeColor.MainColor1.Text,s.moreIcon.color=_.a.colors.MainThemeColor.MainColor1.Text,s.splitbuttonicon.color=_.a.colors.MainThemeColor.MainColor1.Text;const r={":hover":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill}},a={"[aria-expanded=true]":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill},"[data-expanded=true]":{backgroundColor:t.colors.MainThemeColor.MainColor3.Fill}};s.listItem=Object.assign(Object.assign({},s.listItem),a),s.splitbuttonOverflowButton=Object.assign(Object.assign({},s.splitbuttonOverflowButton),a),s.listItemBody.button=Object.assign(Object.assign({},s.listItemBody.button),r),s.overflowFlyoutMoreButton=Object.assign(Object.assign({},s.overflowFlyoutMoreButton),r),s.listItemBody.splitButtonChevronIconWrapper.borderLeftColor=i?void 0:t.colors.MainThemeColor.MainColor1.Text,s.listItemBody.splitButtonChevronIconWrapper.borderRightColor=i?t.colors.MainThemeColor.MainColor1.Text:void 0;const l=Object(n.p)(i,null);l.container.marginLeft="0px",l.container.marginRight="0px",l.container.width="100%",l.container.backgroundColor=t.colors.BaseColor.White,l.listItemBody.text.color=_.a.colors.BaseColor.Grey.Grey7,l.listItemBody.icon.color=_.a.colors.BaseColor.Grey.Grey7,l.listItemBody.icon.fontSize="16px",l.listItemBody.iconWrapperStyles.color=_.a.colors.BaseColor.Grey.Grey7,l.moreIcon.color=_.a.colors.BaseColor.Grey.Grey7,l.splitbuttonicon.color=_.a.colors.BaseColor.Grey.Grey7,l.container.height=x(t.sizes.Measures.Measure200),l.listItemBody.button=Object.assign(Object.assign({},s.listItemBody.button),{":hover":{backgroundColor:_.a.colors.BaseColor.White}}),l.list.marginTop="0rem",l.list.marginBottom="0rem",l.listItem.height="100%",l.listItem.display="flex",l.listItem.alignItems="center",l.listItemBody.button.width="16px",l.moreIcon.marginRight="0rem",l.moreIcon.marginLeft="0rem",l.container.borderStyle="none",l.list.marginLeft="0rem",l.list.marginRight="0rem",l.listItem.marginLeft=0,l.container.height=x(t.sizes.Measures.Measure200);const c={minHeight:t.sizes.Measures.Measure300,backgroundColor:t.colors.MainThemeColor.MainColor1.Fill,display:"flex"};if(o){const e=Object(n.m)(null),t=`${e.border.width} ${e.border.style} ${e.colors.border} !important`,i=x(c.minHeight)+parseInt(e.border.width,10)+"px";Object.assign(c,{backgroundColor:e.colors.background,borderBottom:t,minHeight:i,maxHeight:i,boxSizing:"border-box"})}const d={minHeight:t.sizes.Measures.Measure200,display:"flex",justifyContent:"center",alignItems:"center",paddingLeft:i?t.sizes.Measures.Measure150:t.sizes.Measures.Measure100,paddingRight:i?t.sizes.Measures.Measure100:t.sizes.Measures.Measure150,paddingBottom:t.sizes.Measures.Measure100,paddingTop:t.sizes.Measures.Measure100};e={commandBarStyle:s,commandBarMobileStyle:l,customCommandManagerStyle:{width:"100%"},commandBarWrapperStyle:c,commandBarWrapperMobileStyle:d}}return e}}(),l=function(){let e=null;return function(t,i){if(!e){const o={errorStyle:{display:"flex",flexDirection:"column",flex:"0 0 auto",backgroundColor:t.colors.BaseColor.Grey.Grey1,width:"100%",height:"100%"},viewStyle:{display:"flex",flexDirection:"column",backgroundColor:t.colors.BaseColor.White,width:"100%",height:"100%"},viewContentsStyle:{display:"flex",flexDirection:"column",width:"100%",height:"100%",marginLeft:i?t.sizes.Measures.Measure150:t.sizes.Measures.Measure100,marginRight:i?t.sizes.Measures.Measure100:t.sizes.Measures.Measure150},headerContainerStyle:{display:"flex",flex:"1 0 auto",flexDirection:"column",justifyContent:"space-between"},headerContainerMobileStyle:{display:"flex",flex:"1 0 auto",backgroundColor:t.colors.BaseColor.White,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},dropdownStyle:{root:{width:"80%",maxWidth:"250px",paddingLeft:i?t.sizes.Measures.Measure150:t.sizes.Measures.Measure100,paddingRight:i?t.sizes.Measures.Measure100:t.sizes.Measures.Measure150,paddingBottom:t.sizes.Measures.Measure100},caretDown:{color:"black"}},dropdownIconStyle:{marginRight:"8px",color:"rgb(0, 120, 212)"},buttonStyle:{root:{backgroundColor:t.colors.MainThemeColor.MainColor1.Fill,color:_.a.colors.MainThemeColor.MainColor1.Text,marginLeft:i?t.sizes.Measures.Measure150:t.sizes.Measures.Measure100,marginRight:i?t.sizes.Measures.Measure100:t.sizes.Measures.Measure150,marginTop:t.sizes.Measures.Measure150,maxWidth:"150px"}}};e=o}return e}}(),c=Object(B.a)(),d=function(){const e=Object(v.a)();return function(t,i){const o=e(t,{contextString:I.h.GRID});return{headerStyle:o.headerStyle,headerInnerStyle:o.headerInnerStyle,headerInnerMobileStyle:o.headerInnerMobileStyle}}}(),u=Object(n.s)();return(n,y)=>{const p=Object(T.g)(n,y.id),m={runQuery:"Run query",switchToClassic:"Switch to classic"},w={runQuery:"Run query",entity:"Entities",view:"Views",loadingViews:"Loading views...",addNewView:"Add new view",systemViews:"System views",myViews:"My views"};i&&i.runQuery===m.runQuery&&i.switchToClassic===m.switchToClassic||(i=m),o&&o.runQuery===w.runQuery&&o.entity===w.entity&&o.view===w.view&&o.loadingViews===w.loadingViews||(o=w);const b=Object(V.a)(n),g=Object(O.g)(n);e=a(b,g,Object(L.a)(n)),t=l(b,g),s=c(n,I.h.GRID),r=d(n,y);const C=u(n);return{queryInput:p,queryStyles:{commandBarStyles:e,headerStyle:r,viewStyle:t,viewSelectorStyle:s},ribbonLabels:i,localizedLabels:o,entities:Object(D.g)(n),viewSelectors:Object(k.h)(n),defaultViewSelectors:Object(k.b)(n),commandBarRefreshProps:C,viewPortWidth:Object(z.c)(n),viewPortHeight:Object(z.b)(n),crmBaseUrl:new E.a(Object(h.a)(n))}}}(),(function(e,t){return{fetchViews:t=>{e(Object(j.b)(t,S.a.MAIN_APPLICATION_VIEW)),e(Object(j.b)(t,S.a.ADVANCED_SEARCH))},runQuery:(i,o)=>e(Object(R.a)(i,t.id,void 0,void 0,void 0,void 0,void 0,void 0,o.viewType,void 0,{isQueryMode:!0,isAdvancedFindView:o.isAdvancedFindView})),openClassicAdvancedFind(e,t,i,o,s){const r=i<=1e3?1:(i-1e3)/2,n=o<=1e3?1:(o-700)/2,a=s.searchParams,l=encodeURI(`?&EntityCode=${e.entityTypeCode}&QueryId={${t.viewId.guid}}&${y.Z}=1039`);return a.set(y.v,l),a.set(y.H,"AdvancedFind"),window.open(s.href,"_blank",`width=1000, height=700, left=${r}, top=${n}, resizable=1, align-item=center, justify-content=center`).IsHybridAF=!0,Promise.resolve()}}}))(A);Q.displayName="QueryRoot";var N=i("ZFRl");function q(e,t){t(Object(N.c)(e,"Query"))}var F=i("baQL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class P{constructor(e){var t;this._id=e,this._initializeAction=(t=this._id,{type:"initialize.queryAction.async",execute:({dispatch:e,getState:i},o)=>Promise.all([void 0,q(t,e)])})}getName(){return F.a}getId(){return this._id}getInitializationAction(){return this._initializeAction}getRootReducer(){return e=>e}getRootComponent(){return Q}getCloseAction(e){}}}}]),window.bundleExecutionMarkers["scripts/querypage.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();