(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/nativeplatform.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[85],{"5RA1":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i=.75},"6SEs":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i;r.d(t,"a",(function(){return i})),function(e){e[e.None=0]="None",e[e.UnableToFindAnActivity=1]="UnableToFindAnActivity",e[e.UnableToFindTheDataID=2]="UnableToFindTheDataID",e[e.UnableToFindUIActivity=3]="UnableToFindUIActivity",e[e.EmptyUrl=4]="EmptyUrl",e[e.UnknownMimeType=5]="UnknownMimeType",e[e.InvalidLocalUrl=6]="InvalidLocalUrl",e[e.UnsupportedPlatform=7]="UnsupportedPlatform",e[e.UnableToOpenDocumentInteractionController=8]="UnableToOpenDocumentInteractionController"}(i||(i={}))},"7aNy":function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var i;r.d(t,"a",(function(){return i})),function(e){e[e.documentsLibrary=0]="documentsLibrary",e[e.computerFolder=1]="computerFolder",e[e.desktop=2]="desktop",e[e.downloads=3]="downloads",e[e.homeGroup=4]="homeGroup",e[e.musicLibrary=5]="musicLibrary",e[e.picturesLibrary=6]="picturesLibrary",e[e.videosLibrary=7]="videosLibrary"}(i||(i={}))},Qgan:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var i=r("nA3O"),n=r("8uvO");class o extends i.a{get_dataID(){return this.getValue(o._DataIDProperty)}set_dataID(e){return this.setValue(o._DataIDProperty,e),e}get_size(){return this.getValue(o._SizeProperty)}set_size(e){return this.setValue(o._SizeProperty,e),e}get_filename(){return this.getValue(o._FilenameProperty)}set_filename(e){return this.setValue(o._FilenameProperty,e),e}get_mimeType(){return this.getValue(o._MimeTypeProperty)}set_mimeType(e){return this.setValue(o._MimeTypeProperty,e),e}get_name(){return this.get_filename()}get_type(){return this.get_mimeType()}}o._DataIDProperty=new n.a("dataID",String,o),o._SizeProperty=new n.a("size",Number,o),o._FilenameProperty=new n.a("filename",String,o),o._MimeTypeProperty=new n.a("mimeType",String,o);class a extends o{get_fileContents(){return this.getValue(a._FileContentsProperty)}set_fileContents(e){return this.setValue(a._FileContentsProperty,e),e}}a._FileContentsProperty=new n.a("fileContents",String,a);class s extends o{get_resourceUrl(){return this.getValue(s._ResourceUrlProperty)}set_resourceUrl(e){return this.setValue(s._ResourceUrlProperty,e),e}}s._ResourceUrlProperty=new n.a("resourceUrl",String,s)},r6hG:function(e,t,r){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function i(e,t){return{name:e,operations:t}}r.d(t,"a",(function(){return i}))},v77L:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return s}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const i="areaSwitcherModal",n="recentsListModal",o="profileModal",a="pinnedListModal",s="settingsModal"},wCe8:function(e,t,r){"use strict";r.r(t),r.d(t,"NativePlatform",(function(){return kt}));var i=r("EAYf");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n{attachCallbacks(e,t,r){return e.push(t,r),e}}class o{attachCallbacks(e,t,r){return e.unshift(t,r),e}}function a(e,t){const r=e;let i="get_"+t,n=r[i];return n||(i="get_"+t.charAt(0).toLowerCase()+t.substring(1),n=r[i]),n?n.call(r):null}async function s(e,t){const r=a(e,t);if(r){const e=await r;let i="get_"+t+"State",n=e[i];if(n||(i="get_"+t.charAt(0).toLowerCase()+t.substring(1)+"State",n=e[i]),n)return n.call(e)}return null}var c=r("uM6Y"),l=r("VkXQ"),u=r("r6hG"),p=r("Qois");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const d={[c.a]:l.a,[c.c]:l.c,[c.h]:l.h};class h{constructor(e,t){this._bridge=e,this._callbackAttacher=t||new n}executeServiceOperation(e,t,r){return new Promise(async(t,r)=>{const i=e.getServiceName(),n=e.getOperationName(),o=e.getParameters().slice(),s=a(this._bridge,i);if(s){const e=await s,a=e[n];a?a.apply(e,this._callbackAttacher.attachCallbacks(o,t,r)):r({errorCode:p.a.ServiceAndOperationNotSupported,param:i+"."+n})}else r({errorCode:p.a.ServiceNotSupported,param:i})})}static getAvailableServiceOperations(e,t){if(e.willDispatcherBeAvailableFromDevice(t)){const e=d[t];if(e)return Object(u.a)(t,e)}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var m;!function(e){e[e.PluginCancelled=1]="PluginCancelled",e[e.FileSizeBreached=2]="FileSizeBreached",e[e.FileSizeCannotBeZero=3]="FileSizeCannotBeZero",e[e.CameraPluginError=4]="CameraPluginError",e[e.VideoCapturePluginError=5]="VideoCapturePluginError",e[e.AudioCapturePluginError=6]="AudioCapturePluginError",e[e.BarCodePluginError=7]="BarCodePluginError",e[e.GeoLocationPluginError=8]="GeoLocationPluginError",e[e.NoActivityToAudioCapture=9]="NoActivityToAudioCapture"}(m||(m={}));class g{constructor(e){this._defaultProvider=new h(e,new o)}executeServiceOperation(e,t,r){const n=e.getParameters().slice(),o=new i.a("CordovaMedia",e.getOperationName(),n);return this._defaultProvider.executeServiceOperation(o,t,r).then(e=>e,e=>e===m.PluginCancelled?Promise.reject({errorCode:p.a.PluginCancelled}):Promise.reject({errorCode:p.a.BarCodeCaptureFailed}))}static getAvailableServiceOperations(e){return Object(u.a)(c.b,l.b)}}var _,b=r("NjDY"),v=r("5RA1");!function(e){e[e.GetPhotoFromGalleryFailed=-1]="GetPhotoFromGalleryFailed",e[e.UnableToOpenFile=0]="UnableToOpenFile",e[e.ApplicationInSnapView=1]="ApplicationInSnapView",e[e.FileSizeBreached=2]="FileSizeBreached",e[e.FileSizeCannotBeZero=3]="FileSizeCannotBeZero",e[e.AttachmentTypeBlocked=4]="AttachmentTypeBlocked",e[e.FilePickerCancelled=5]="FilePickerCancelled"}(_||(_={}));var f=r("Qgan"),S=r("6SEs"),k=r("2qKp");function y(e){return new w(e.get_filename(),e.get_size(),e.get_mimeType(),e.get_resourceUrl())}class w{constructor(e,t,r,i){this.fileName=e,this.fileSize=t,this.mimeType=r,this.fileUrl=i}getBinaryReader(e){return new O(this.fileUrl,e)}get fileContent(){throw new Error("fileContent is not available. Use fileUrl and getBinaryReader() instead.")}}class O{constructor(e,t){this._fileUrl=e,this._currentIndex=0,(!t||t<1048576)&&(t=1048576),this._chunkSize=Math.floor(t)}getCurrentIndex(){return this._currentIndex}read(){return this._fetchBlobFromFileUrl().then(()=>new Promise(e=>{if(!this._blob||this._currentIndex>=this._blob.size)return void e(new T(!0,null));const t=this._currentIndex+this._chunkSize>this._blob.size?this._blob.size:this._currentIndex+this._chunkSize,r=this._blob.slice(this._currentIndex,t),i=new FileReader;i.onloadend=()=>{this._currentIndex=t;const r=i.result,n=new Uint8Array(r);e(new T(!1,n))},i.readAsArrayBuffer(r)}))}_fetchBlobFromFileUrl(){if(!this._fileUrl)throw new Error("_fetchBlobFromFileUrl: fileUrl is not available.");return this._blob?Promise.resolve():fetch(this._fileUrl).then(e=>e.ok?e.blob().then(e=>{this._blob=e},e=>Promise.reject(`_fetchBlobFromFileUrl: FAILED - couldn't read body from ${this._fileUrl}: ${JSON.stringify(e)}`)):Promise.reject(`_fetchBlobFromFileUrl: FAILED - received ${e.status} from ${this._fileUrl}`),e=>Promise.reject(`_fetchBlobFromFileUrl: FAILED - ${JSON.stringify(e)} from ${this._fileUrl}`))}}class T{constructor(e,t){this.done=e,this.value=t}}var P=r("7aNy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const A="Data",C="Document",F="Multimedia";class x{constructor(e){this._defaultProvider=new h(e)}executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case l.d.openFile.name:return this._openFile(e,t,r);case l.d.pickFile.name:let i;return e.getParameters()&&e.getParameters()[0]&&(i=e.getParameters()[0]),(null==i?void 0:i.useBinaryReader)?this._pickFileForUrl(e,t,r):this._pickFile(e,t,r)}return new Promise((e,t)=>{t({errorCode:p.a.ServiceAndOperationNotSupported,param:"FileManager."+i})})}_openFile(e,t,r){return new Promise((n,o)=>{const a=e.getParameters().slice()[0],s=t.TraceManager.getTracer();if(!a)return s.error("Parameter file is null or undefined"),o({errorCode:p.a.OpenDocumentErrorCodeGeneric});if(a.fileName||(a.fileName="Default_name_"+Date.now()),!a.mimeType)return s.error(`File ${Object(k.c)(a.fileName)} parameter file.mimeType is null or undefined`),o({errorCode:p.a.OpenDocumentErrorCodeGeneric});if(!a.fileContent)return s.error(`File ${Object(k.c)(a.fileName)} doesnâ€™t have any content and cannot be opened.`),o({errorCode:p.a.OpenDocumentErrorCodeGeneric});const c=[this._fileToPalDataFile(a)],l=new i.a("Data","saveDataFile",c);this._defaultProvider.executeServiceOperation(l,t,r).then(e=>{const n=[e,a.fileName,a.mimeType],o=new i.a("Document","openDocumentWithDataID",n);return this._defaultProvider.executeServiceOperation(o,t,r)},e=>{o({errorCode:p.a.SaveDataFileErrorOutOfSpace})}).then(e=>{switch(e===S.a.None&&n(),e){case S.a.UnableToFindAnActivity:s.error(`File ${Object(k.c)(a.fileName)} wasn't opened. Unable to find an activity to open the file.`),o({errorCode:p.a.NoApplicableAppFound});break;case S.a.UnableToFindTheDataID:o({errorCode:p.a.OpenDocumentErrorCodeUnableToFindTheDataId});break;default:s.error(`File ${Object(k.c)(a.fileName)} wasn't opened. ErrorCode: ${e.toString()}`),o({errorCode:p.a.OpenDocumentErrorCodeGeneric})}})})}_pickFileForUrl(e,t,r){const n=this._getPickFileOptions(e,r),o=P.a.documentsLibrary,a=[n.allowMultiple,n.fileFilter,o,n.fileSizeLimit],s=new i.a("Multimedia","openFilePickerForUrl",a),c=[];return this._defaultProvider.executeServiceOperation(s,t,r).then(e=>{for(let t=0;t<e.length;t++)c.push(y(e[t]));return c},e=>E(t,n.fileSizeLimit,e))}_pickFile(e,t,r){const n=this._getPickFileOptions(e,r),o=[],a=[n.allowMultiple,n.fileSizeLimit],s=new i.a("Multimedia","pickFile",a);return this._defaultProvider.executeServiceOperation(s,t,r).then(e=>{for(let t=0;t<e.length;t++)o.push(this._palDataFileToFile(e[t]));return o},e=>E(t,n.fileSizeLimit,e))}_getPickFileOptions(e,t){let r;e.getParameters()&&e.getParameters()[0]&&(r=e.getParameters()[0]);return{allowMultiple:!(!r||!(null==r?void 0:r.allowMultipleFiles)),fileSizeLimit:r&&r.maximumAllowedFileSize>0?r.maximumAllowedFileSize:Object(b.x)(t.getState()).maxUploadFileSize,fileFilter:r&&r.accept?[r.accept]:["*"]}}_fileToPalDataFile(e){const t=new f.a;return t.set_filename(e.fileName),t.set_mimeType(e.mimeType),t.set_fileContents(e.fileContent),e.fileSize&&t.set_size(e.fileSize),t}_palDataFileToFile(e){const t=e.get_fileContents();return{fileName:e.get_filename(),mimeType:e.get_mimeType(),fileContent:t,fileSize:Math.ceil(t.length*v.a)}}static getAvailableServiceOperations(e){const t=e.willDispatcherBeAvailableFromDevice(A)&&e.willDispatcherBeAvailableFromDevice(C),r=e.willDispatcherBeAvailableFromDevice(F);return t&&r?Object(u.a)(c.d,l.d):t?Object(u.a)(c.d,{openFile:l.d.openFile}):r?Object(u.a)(c.d,{pickFile:l.d.pickFile}):void 0}}function E(e,t,r){const i=e.TraceManager.getTracer();switch(r){case _.FilePickerCancelled:return Promise.reject({errorCode:p.a.PluginCancelled});case _.AttachmentTypeBlocked:return Promise.reject({errorCode:p.a.FilePickerErrorAttachmentTypeBlocked});case _.FileSizeBreached:return Promise.reject({errorCode:p.a.FilePickerErrorFileSizeBreached,param:t/1024});case _.FileSizeCannotBeZero:return Promise.reject({errorCode:p.a.FilePickerErrorFileSizeCannotBeZero});case _.GetPhotoFromGalleryFailed:return i.error("File picker get photo from gallery failed. ErrorCode: "+r.toString()),Promise.reject({errorCode:p.a.GetPhotoFromGalleryFailed});case _.ApplicationInSnapView:case _.UnableToOpenFile:default:return i.error("File picker unable to pick file. ErrorCode: "+r.toString()),Promise.reject({errorCode:p.a.FilePickerErrorUnableToOpenFile})}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class j{constructor(e){this._defaultProvider=new h(e,new o)}executeServiceOperation(e,t,r){if(navigator.geolocation&&navigator.userAgent&&!/Windows.*MSAppHost/i.test(navigator.userAgent))return new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,e=>{t({errorCode:p.a.GetGeoLocationFailed})},{maximumAge:0})});const n=e.getParameters().slice(),o=new i.a("CordovaMedia",e.getOperationName(),n);return this._defaultProvider.executeServiceOperation(o,t,r).then(e=>JSON.parse(e),e=>Promise.reject({errorCode:p.a.GetGeoLocationFailed}))}static getAvailableServiceOperations(e){return Object(u.a)(c.e,l.e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const N={[c.a]:{ready:"clientReady",initialized:"clientInitialized",bootError:"clientBootError"},[c.b]:{getBarcodeValue:"scanBarcode"},[c.c]:{getExternalContextProperty:"GetExternalContextProperty",invokeExternalContextAction:"InvokeExternalContextAction"},[c.d]:{openFile:"openFile",pickFile:"pickFile"},[c.e]:{getCurrentPosition:"getCurrentPosition"},[c.f]:{takePicture:"takePictureOnDevice",captureVideo:"captureVideoFromDevice",captureAudio:"captureAudioFromDevice"},[c.g]:{openUri:"openUri",updateBackBehavior:"updateBackBehavior",canOpenUri:"canOpenUri",openAuthPopup:"openAuthPopup",switchApp:"switchApp",navigateBackOutOfApp:"navigateBackOutOfApp"},[c.i]:{authenticate:"authenticate",beginSecureSessionForAuthFlow:"beginSecureSessionForAuthFlow",beginSecureSessionForResource:"beginSecureSessionForResource",beginSecureSessionForResourceWithPrompt:"beginSecureSessionForResourceWithPrompt",signOut:"signOut",reconfigure:"reconfigure",handleAuthError:"handleAuthError"},[c.h]:{exec:"exec",onSyncStart:"onSyncStart",onSyncComplete:"onSyncComplete",onSyncError:"onSyncError"}},I="CordovaMedia",U="Multimedia";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R{constructor(e){this._defaultProvider=new h(e,new o)}executeServiceOperation(e,t,r){const i=e.getOperationName();let n;switch(e.getParameters()&&e.getParameters()[1]&&(n=e.getParameters()[1]),i){case N[c.f].takePicture:return(null==n?void 0:n.useBinaryReader)?this._captureImageForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r);case N[c.f].captureVideo:return(null==n?void 0:n.useBinaryReader)?this._captureVideoForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r);case N[c.f].captureAudio:return(null==n?void 0:n.useBinaryReader)?this._captureAudioForUrl(e,t,r):this._executeCordovaMediaActions(e,t,r)}return new Promise((e,t)=>{t({errorCode:p.a.ServiceAndOperationNotSupported,param:"MediaContentManager"+i})})}_executeCordovaMediaActions(e,t,r){const n=e.getParameters().slice(),o=new i.a(I,e.getOperationName(),n);return this._defaultProvider.executeServiceOperation(o,t,r).then(e=>({fileName:e.get_filename(),mimeType:e.get_mimeType(),fileContent:e.get_fileContents(),fileSize:e.get_size()}),e=>this._handleCordovaPluginError(t,Object(b.x)(r.getState()).maxUploadFileSize,e))}_captureImageForUrl(e,t,r){const n=Object(b.x)(r.getState()).maxUploadFileSize,o=[n],a=new i.a(U,"captureImage",o);return this._defaultProvider.executeServiceOperation(a,t,r).then(e=>y(e),e=>E(t,n,e))}_captureVideoForUrl(e,t,r){const n=Object(b.x)(r.getState()).maxUploadFileSize,o=[n],a=new i.a(U,"captureVideo",o);return this._defaultProvider.executeServiceOperation(a,t,r).then(e=>y(e),e=>E(t,n,e))}_captureAudioForUrl(e,t,r){const n=Object(b.x)(r.getState()).maxUploadFileSize,o=["captureAudioWithFileUrl",{maxUploadFileSize:n}],a=new i.a(I,"captureAudioWithUrlFromDevice",o);return this._defaultProvider.executeServiceOperation(a,t,r).then(e=>y(e),e=>this._handleCordovaPluginError(t,n,e))}_handleCordovaPluginError(e,t,r){switch(r){case m.PluginCancelled:return Promise.reject({errorCode:p.a.PluginCancelled});case m.FileSizeBreached:return Promise.reject({errorCode:p.a.FilePickerErrorFileSizeBreached,param:t/1024});case m.CameraPluginError:return Promise.reject({errorCode:p.a.CameraCaptureFailed});case m.VideoCapturePluginError:return Promise.reject({errorCode:p.a.VideoCaptureFailed});case m.AudioCapturePluginError:return Promise.reject({errorCode:p.a.AudioCaptureFailed});case m.NoActivityToAudioCapture:return Promise.reject({errorCode:p.a.NoApplicableAppFound});default:return e.TraceManager.getTracer().error("Media content wasn't captured. ErrorCode: "+r.toString()),Promise.reject({errorCode:p.a.GenericError})}}static getAvailableServiceOperations(e){return Object(u.a)(c.f,l.f)}}var D=r("H4dV"),B=r("3/02"),M=r("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const z="Document",L="Network",q="Navigation",V={emailProtocol:"mailto:",skypeProtocol:"skype:",oneNoteProtocol:"onenote:",excelProtocol:"ms-excel:",wordProtocol:"ms-word:",powerPointProtocol:"ms-powerpoint:"};class G{constructor(e){this._bridge=e,this._defaultProvider=new h(e)}executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case l.g.openUri.name:return this._openUri(e,t,r);case l.g.updateBackBehavior.name:return this._updateBackBehavior(e,t,r);case l.g.navigateBackOutOfApp.name:return this._navigateBackToHost();case l.g.canOpenUri.name:return this._canOpenUri(e,t,r).then(e=>e.canOpenUrl);case l.g.openAuthPopup.name:return this._openAuthPopup(e,t,r);case l.g.switchApp.name:return this._switchApp(e,t,r);default:return Promise.reject({errorCode:p.a.ServiceAndOperationNotSupported,param:"NavigationManager."+i})}}_openUri(e,t,r){const n=e.getParameters().slice()[0];return this._canOpenUri(e,t,r).then(o=>{if(o.canOpenUrl&&!o.external){const e=new i.a(L,"openUrl",[n]);return this._defaultProvider.executeServiceOperation(e,t,r)}return this._openExternalUrl(e,t,r)},e=>(t.TraceManager.getTracer().error("CanOpenUrl failed for input URL "+n),Promise.reject({errorCode:p.a.GenericError})))}_updateBackBehavior(e,t,r){return new Promise((n,o)=>{const a=e.getParameters().slice()[0],s=new i.a(q,l.g.updateBackBehavior.name,[a]);this._execute(s,t,r),n()})}_navigateBackToHost(){const e=this._bridge.get_device();return e.get_IsAvailable()&&e.postMessage(JSON.stringify({name:"navigateBackToHost"})),Promise.resolve({status:0,pageId:null})}_canOpenUri(e,t,r){return new Promise((n,o)=>{if(Object(M.c)(r.getState(),B.Hc))return void n({canOpenUrl:!0,external:!this._bridge.willDispatcherBeAvailableFromDevice(L)});const a=e.getParameters().slice()[0],s=D.a.getInstance();if(!a){return t.TraceManager.getTracer().error("Parameter url is null or undefined."),o({errorCode:p.a.GenericError})}if(this._isProtocolWellKnown(a)&&(s.get_IsAndroid()||s.get_IsIOS())){const e=new i.a(L,"canOpenUrl",[a]);this._execute(e,t,r).then(e=>{n({canOpenUrl:e,external:!1})},()=>{o({errorCode:p.a.GenericError})})}else n({canOpenUrl:!0,external:!0})})}_openAuthPopup(e,t,r){return new Promise((n,o)=>{const a=e.getParameters().slice()[0];if(!a){return t.TraceManager.getTracer().error("Parameter url is null or undefined."),o({errorCode:p.a.GenericError})}const s=new i.a(L,"openAuthPopup",[a,e=>{n(e)}]);this._execute(s,t,r)})}_isProtocolWellKnown(e){for(const t in V)if(e.startsWith(V[t]))return!0;return!1}_openExternalUrl(e,t,r){const n=e.getParameters().slice(),o=new i.a(z,"openExternalUrl",n);return this._execute(o,t,r)}_switchApp(e,t,r){const n=e.getParameters().slice(),o=new i.a(q,e.getOperationName(),n);return this._execute(o,t,r)}_execute(e,t,r){return this._defaultProvider.executeServiceOperation(e,t,r)}static getAvailableServiceOperations(e){const t=D.a.getInstance(),r=t.get_IsAndroid()||t.get_IsIOS()?e.willDispatcherBeAvailableFromDevice(L)&&e.willDispatcherBeAvailableFromDevice(z):e.willDispatcherBeAvailableFromDevice(z),i=e.willDispatcherBeAvailableFromDevice(q),n=Object.assign({},l.g);r||(delete n.openUri,delete n.canOpenUri),i||delete n.updateBackBehavior;const o=e.get_application().get_applicationState();return o.get_hasAppList()||delete n.switchApp,o.get_canNavigateBackToHost()||delete n.navigateBackOutOfApp,Object(u.a)(c.g,n)}}var H,$=r("Uv1Y"),W=r("TBkx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class K{constructor(e){this._defaultProvider=new h(e)}executeServiceOperation(e,t,r){const i=e.getOperationName(),n=N[c.a];switch(i){case n[l.a.bootError.name]:return this._bootError(e,t,r);case n[l.a.initialized.name]:case n[l.a.ready.name]:return this._defaultProvider.executeServiceOperation(e,t,r)}return new Promise((e,t)=>{t({errorCode:p.a.ServiceAndOperationNotSupported,param:"Application."+i})})}_bootError(e,t,r){const n=e.getParameters().slice(),o=n[1],a=o.innerError?o.innerError.errorCode:null;t.TraceManager.getTracer("Boot.ShimError").error("Boot failed with error. ErrorMessage: "+o.message+" ErrorCode: "+o.errorCode+" InnerErrorCode: "+a+" Details: "+Object(W.e)(o));let s=o||new $.a("Error_Message_Generic_Mobile_Client");return 0!==s.errorCode&&"function"==typeof s.getNegativeErrorCode?s.errorCode=s.getNegativeErrorCode():s.innerError&&s.innerError.errorCode&&"function"==typeof s.innerError.getNegativeErrorCode&&(s.errorCode=s.innerError.getNegativeErrorCode()),s=0===s.errorCode?new $.a("Error_Message_Generic_Mobile_Client"):s,s.errorCode||(s.errorCode=0),n[1]=Object($.f)(s),e=new i.a(c.a,N[c.a][l.a.bootError.name],n),this._defaultProvider.executeServiceOperation(e,t,r)}static getAvailableServiceOperations(e){if(e.dispatchers[c.a].get_IsAvailable())return Object(u.a)(c.a,l.a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Success=0]="Success",e[e.UnexpectedError=1]="UnexpectedError",e[e.AuthorityNotFound=2]="AuthorityNotFound",e[e.InvalidResource=3]="InvalidResource",e[e.InvalidDomain=4]="InvalidDomain",e[e.UnsupportedPlatform=5]="UnsupportedPlatform",e[e.FeatureDisabled=6]="FeatureDisabled",e[e.InvalidOrigin=7]="InvalidOrigin"}(H||(H={}));var J=r("23jc"),Z=r("Zvo8"),Q=r("9eA9"),Y=r("jZCH"),X=r("7Gx7"),ee=r("g22U"),te=r("IqkD");class re{constructor(e,t){this._defaultProvider=new h(e),this._tokenProvider=t}executeServiceOperation(e,t,r){const i=e.getOperationName();switch(i){case l.i.authenticate.name:return this._authenticate(e,t,r);case l.i.beginSecureSessionForAuthFlow.name:return this._beginSecureSessionForAuthFlow(e,t,r,i);case l.i.beginSecureSessionForResource.name:return this._beginSecureSession(t,r,i,e.getParameters(),e=>Object(M.d)(r.getState(),"MobileClientBeginSecureSessionForResource")?p.a.BeginSecureSessionSilentFailed:e);case l.i.beginSecureSessionForResourceWithPrompt.name:return this._beginSecureSession(t,r,i,e.getParameters());case l.i.signOut.name:return this._signOut(t,r);case l.i.reconfigure.name:return this._reconfigure(t,r);case l.i.handleAuthError.name:return this._handleAuthError(t,r)}return new Promise((e,t)=>{t({errorCode:p.a.ServiceAndOperationNotSupported,param:"UserAccount."+i})})}_authenticate(e,t,r){Object(Z.a)("CrmNativeAuth",Object(Q.b)().substr(Object(Q.b)().indexOf(".")));const i=e.getParameters(),n=i&&i[0],o=this._tokenProvider.retrieveAuthToken(n);return o.then(()=>{this._setupCookie(t,r)}),o}_handleAuthError(e,t){const r=new i.a(c.i,l.i.authenticate.name,[!0]);return this._authenticate(r,e,t)}_beginSecureSessionForAuthFlow(e,t,r,i){const n=e.getParameters(),o=n[0];for(const e in o)void 0===o[e]&&(o[e]=null);return n[0]=new X.a(o),this._beginSecureSession(t,r,i,n)}_beginSecureSession(e,t,r,n,o){return new Promise((a,s)=>{const l=new i.a(c.i,r,[...n,(t,i)=>{if(t===H.Success)a(new Date(i));else{e.TraceManager.getTracer("Authentication").error(`${r} error, ErrorCode: ${t}, ErrorInfo: ${this._getErrorInfo(t)}`);const i=o?o(t):t;s({errorCode:i})}}]);this._defaultProvider.executeServiceOperation(l,e,t)})}_signOut(e,t){return new Promise((r,n)=>{const o=[];o.push(this._clearAuthCookie(e,t)),o.push(Y.a.get_DefaultInstance().clearAllData()),o.push(Y.a.get_DefaultInstance().updateSecureContext()),Promise.all(o).then(()=>{this._tokenProvider.clearAuthToken();const n=new i.a(c.i,l.i.signOut.name);this._defaultProvider.executeServiceOperation(n,e,t),r()},t=>{e.TraceManager.getTracer("SignOut").error("Signout failed, errorDetail: "+t.toString()),n({errorCode:-2147093993})})})}_reconfigure(e,t){return new Promise((r,n)=>{const o=[];o.push(this._clearAuthCookie(e,t)),o.push(Y.a.get_DefaultInstance().clearAllData()),o.push(Y.a.get_DefaultInstance().clearAllMetadata()),Promise.all(o).then(()=>{this._tokenProvider.clearAuthToken();const n=new i.a(c.i,l.i.reconfigure.name);this._defaultProvider.executeServiceOperation(n,e,t),r()},t=>{e.TraceManager.getTracer("Reconfigure").error("Reconfigure failed, errorDetail: "+t.toString()),n({errorCode:-2147093993})})})}_getErrorInfo(e){let t;switch(e){case H.AuthorityNotFound:t="The request failed as there is no oAuth authority in this session.";case H.InvalidResource:t="The session was requested for an unsupported resource.";case H.InvalidDomain:t="The session was requested for an unsupported domain.";case H.UnsupportedPlatform:t="The session was requested on an unsupported platform like ISH.";case H.FeatureDisabled:t="The app is running on a shim that doesnt support authenticated mashups";case H.UnexpectedError:default:t="The request failed due to unknown reasons."}return t}_setupCookie(e,t){if(!Object(te.w)(t.getState()).isLive)return void this._tokenProvider.setupCookieForOnPrem();const r=ee.c.ACTION,i={endpoint:"/nativewebsession/new",method:"POST",urlParameters:"",additionalParameters:{[ee.a.TYPE]:r,[ee.a.SUB_TYPE]:"SetupCookie"}};t.dispatch(Object(J.a)(i)).catch(t=>{e.EventManager.ReportComponentFailure("Authentication.NativeWebSession.New",t)})}_clearAuthCookie(e,t){return t.dispatch(Object(J.a)({endpoint:"/nativewebsession/end",method:"POST",urlParameters:""})).catch(t=>{e.EventManager.ReportComponentFailure("Authentication.NativeWebSession.End",t),Object(Z.a)("CrmNativeAuth",Object(Q.b)().substr(Object(Q.b)().indexOf(".")))})}static getAvailableServiceOperations(e,t){const r=e.dispatchers[c.i],i=Object(M.d)(t.getState(),"MobileClientBeginSecureSessionForResource");if(r.get_IsAvailable()){let e=l.i;i||(e=Object.assign({},l.i),delete e.beginSecureSessionForResource);return Object(M.d)(t.getState(),"MobileClientBeginSecureSessionForAuthFlow")||(e=Object.assign({},l.i),delete e.beginSecureSessionForAuthFlow),Object(u.a)(c.i,e)}}}var ie=r("9gmQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ne=r("iQAP");const oe={propertyName:"NativeFCBContext",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ne.b)(e[t]))}};var ae=r("uUCw");const se={propertyName:"version",dispatcherName:"Application",handler:function(e,t,r){const i=e.get_version(),n=e.get_build(),o=e.get_revision(),a=e.get_nativeRevision(),s=e.get_osVersion();r.dispatch(Object(ae.l)(i,n,o,a,s))}};const ce={propertyName:"installationId",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ae.i)(e.get_installationId()))}};const le={propertyName:"deviceModel",dispatcherName:"Device",handler:function(e,t,r){r.dispatch(Object(ae.h)(e.get_deviceModel()))}};var ue=r("xmKQ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const pe={propertyName:"AppId",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ue.b)(e[t]))}};const de={propertyName:"TelemetryEventsParams",dispatcherName:"Application",handler:function(e,t,r){r.dispatch(Object(ae.k)(e.get_telemetryEventsParams()))}};var he=r("zwYV");function me(e){return(t,r,i)=>e(t[r],i)}const ge={propertyName:"AvailableExternalContexts",dispatcherName:"ExternalContext",handler:me((function(e,t){e&&t.dispatch(Object(he.i)(e.reduce((e,t)=>Object.assign(e,{[t.id]:t}),{})))}))};const _e={propertyName:"KnownProperties",dispatcherName:"ExternalContext",handler:me((function(e,t){t.dispatch(Object(he.g)(e))}))};var be=r("DPfD");const ve={propertyName:"KnownPropertyUpdate",dispatcherName:"ExternalContext",handler:me((function(e,t){if(!e||!e.contextId||!e.propertyId)return;t.dispatch(Object(he.j)(e));const r=Object(be.b)(t.getState(),e.contextId,e.propertyId);r&&Array.isArray(r)&&r.forEach(t=>t(e.value))}))};var fe=r("db6h");function Se(e,t,r){r.dispatch(Object(fe.b)(t,e[t]))}const ke={propertyName:"CameraAvailable",dispatcherName:"Device",handler:Se},ye={propertyName:"MicrophoneAvailable",dispatcherName:"Device",handler:Se},we={propertyName:"GeolocationAvailable",dispatcherName:"Device",handler:Se};var Oe=r("Eq/9"),Te=r("7NKF");const Pe={dispatcherName:"Cordova",transformers:{FilesDownloadStatus:e=>{if(!e||"string"!=typeof e)return null;try{return{filesDownloadStatus:JSON.parse(e)}}catch(e){return null}}}},Ae={[Te.b]:Pe,[Te.a]:{dispatcherName:"Network",transformers:{BaseUrlForTemporaryData:null,BaseUrlForEntityData:null,BaseUrlForAppHost:null}}};const Ce=[oe,se,ce,le,pe,de,ge,_e,ve,ke,ye,we,...function(){const e=[];return Object.entries(Ae).forEach(([t,r])=>{Object.entries(r.transformers).forEach(([i,n])=>{e.push(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,r,i){return{propertyName:e,dispatcherName:t,handler(t,n,o){const a=t[n],s=i?i(a):{[e]:a};null!==s&&o.dispatch(Object(Oe.b)(r,s))}}}(i,r.dispatcherName,t,n))})}),e}()];var Fe=r("SSc5");const xe={eventName:"OnBackButtonPressed",dispatcherName:"Navigation",handler:function(e,t){t.dispatch(Object(Fe.a)())}};var Ee=r("QbIY");function je(){return{type:"router.reset.async",execute:({dispatch:e,getState:t},r)=>e({type:"router.reset.async",execute:({dispatch:e,getState:t},r)=>(r.Router.getHistoryManager().ClearHistory(),e(Object(Ee.a)()))})}}const Ne={eventName:"OnRouterReset",dispatcherName:"Navigation",handler:function(e,t){t.dispatch(je())}};var Ie=r("OEUm"),Ue=r("J+j6");const Re={eventName:"OnNativeApplicationEventsReceived",dispatcherName:"Logging",handler:function(e,t){Object(Ie.a)()&&Object(Ue.f)(e)}};var De=r("xAwK");const Be=[xe,Ne,Re,{eventName:"ReportPerformance",dispatcherName:"Application",handler:function(e,t){Object(De.a)({},[e])}}];var Me,ze=r("SX+A"),Le=r("eOoD"),qe=r("sclX"),Ve=r("F1Lu");!function(e){e[e.CloseShim=0]="CloseShim",e[e.CallAppCode=1]="CallAppCode"}(Me||(Me={}));var Ge=r("pF61"),He=r("ruPX"),$e=r("IKHO"),We=r("a475"),Ke=r("omgb"),Je=r("K9oF"),Ze=r("69Qu"),Qe=r("2mBq"),Ye=r("eruq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class Xe{constructor(){this._authToken=null,this._securityTokenResponse=null,this._tokenExpiry=null,this._objectId=null,this._tenantId=null}get_authToken(){return this._authToken}set_authToken(e){return this._authToken=e,e}get_securityTokenResponse(){return this._securityTokenResponse}set_securityTokenResponse(e){return this._securityTokenResponse=e,e}get_tokenExpiryUtcTime(){return this._tokenExpiry}set_tokenExpiryUtcTime(e){return this._tokenExpiry=e,e}get_objectId(){return this._objectId}set_objectId(e){return this._objectId=e,e}get_tenantId(){return this._tenantId}set_tenantId(e){return this._tenantId=e,e}}var et=r("ufH1"),tt=r("504W"),rt=r("Div0");class it extends Xe{constructor(e){super(),this._ParseTokenAndInitializeObject(e)}_ParseTokenAndInitializeObject(e){const t=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/AccessToken");this.set_authToken(t.get_innerText());const r=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/ExpiresOn").get_innerText();if(isNaN(r))this.set_tokenExpiryUtcTime(new Date(r)),Object(et.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",rt.a.authentication,"Create expiry time object from UTC datetime string: "+r);else{const e=parseInt(r,10);this.set_tokenExpiryUtcTime(new Date(e)),Object(et.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",rt.a.authentication,"Create expiry time object from ticks: "+r)}try{const t=this.get_authToken().split(".")[1].replace(new RegExp("-","g"),"+").replace(new RegExp("_","g"),"/"),i=JSON.parse(window.atob(t)),n=i.exp,o=new Date(1e3*parseInt(n,10));Object(tt.a)(this.get_tokenExpiryUtcTime())||"Invalid Date"===this.get_tokenExpiryUtcTime().toString()?(Object(et.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",rt.a.authentication,"Token expiry time parsed to invalid date. ExpiryTimeString: "+r+"ExpiryTimeFromTicks: "+o),this.set_tokenExpiryUtcTime(o)):Math.abs(this.get_tokenExpiryUtcTime().getTime()-o.getTime())>2e3&&Object(et.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",rt.a.authentication,"Token expiry time calculated from ticks not equal to token expiry time sent from shim. ExpiryTimeString: "+r+" TokenExpiryUtcTime: "+this.get_tokenExpiryUtcTime()+" TokenExpiryFromTicks: "+o);const a=i.oid||"";this.set_objectId(a);const s=i.tid||"";this.set_tenantId(s),this._setSecurityTokenResponse(e)}catch(e){Object(et.e)("OAuthSecurityTokenResponseObject._ParseTokenAndInitializeObject",rt.a.authentication,"Failed to extract expiry time or Ids from decoding auth token: "+e.message)}}_setSecurityTokenResponse(e){const t=e.selectSingleNode("/RequestOAuthSecurityTokenResponse/EncodedAccessToken").get_innerText();this.set_securityTokenResponse(`<t:RequestSecurityTokenResponse xmlns:t="http://schemas.xmlsoap.org/ws/2005/02/trust">\n\t\t\t<t:Lifetime>\n\t\t\t<wsu:Created xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">2013-05-21T00:58:40.544Z</wsu:Created>\n\t\t\t<wsu:Expires xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">2013-05-22T00:58:40.544Z</wsu:Expires>\n\t\t\t</t:Lifetime>\n\t\t\t<wsp:AppliesTo xmlns:wsp=""http://schemas.xmlsoap.org/ws/2004/09/policy"">\n\t\t\t<EndpointReference xmlns=""http://www.w3.org/2005/08/addressing"">\n\t\t\t<Address>https://kevinwhi9852org2.crm.crmlivetoday.com/</Address>\n\t\t\t</EndpointReference>\n\t\t\t</wsp:AppliesTo>\n\t\t\t<t:RequestedSecurityToken>\n\t\t\t<wsse:BinarySecurityToken wsu:Id=""_febfbc5a-99cf-4298-ae6f-7d752db4cb24-FECE4032DF73C0855F4B4BA9EAEB9E47"" ValueType=""urn:ietf:params:oauth:token-type:jwt"" EncodingType=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"" xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"">${t}</wsse:BinarySecurityToken>\n\t\t\t</t:RequestedSecurityToken>\n\t\t\t<t:TokenType>urn:ietf:params:oauth:token-type:jwt</t:TokenType>\n\t\t\t<t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>\n\t\t\t<t:KeyType>http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey</t:KeyType>\n\t\t\t</t:RequestSecurityTokenResponse>`)}}class nt extends Xe{constructor(e){super(),this._ParseTokenAndInitializeObject(e)}_ParseTokenAndInitializeObject(e){let t=!0;e.addNamespace("t","http://schemas.xmlsoap.org/ws/2005/02/trust"),e.addNamespace("wsu","http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"),e.addNamespace("xenc","http://www.w3.org/2001/04/xmlenc#"),e.addNamespace("wsp","http://schemas.xmlsoap.org/ws/2004/09/policy"),e.addNamespace("wsa","http://www.w3.org/2005/08/addressing");const r=e.selectSingleNode("/t:RequestSecurityTokenResponse/wsp:AppliesTo/wsa:EndpointReference/wsa:Address");r&&-1===r.get_innerText().indexOf("urn:")||(t=!1);const i=e.selectSingleNode("/t:RequestSecurityTokenResponse");this.set_securityTokenResponse(i.get_outerXml());const n=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken");if(this.set_authToken(n.childNodes().get_item(0).get_outerXml()),t){this.set_tokenExpiryUtcTime(new Date);if(e.selectSingleNode("/t:RequestSecurityTokenResponse/t:Lifetime")){const t=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:Lifetime/wsu:Expires").get_innerText();if(!Object(tt.b)(t))if(isNaN(t))this.set_tokenExpiryUtcTime(new Date(t));else{const e=parseInt(t,10);this.set_tokenExpiryUtcTime(new Date(e))}}}else{e.addNamespace("saml","urn:oasis:names:tc:SAML:1.0:assertion");const t=e.selectSingleNode("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken/saml:Assertion/saml:Conditions");if(t){const e=t.getAttribute("NotOnOrAfter").toString();Object(tt.b)(e)||this.set_tokenExpiryUtcTime(new Date(e))}}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var ot=r("fU7K");class at{constructor(e,t){this._tokenExpiryWindow=6e4,this._tokenExpiryTimer=-1,this._store=e,this._authInProgress=!1,this._tokenRetrievedCallbacks=[],this._tracer=t.TraceManager.getTracer("TokenProvider"),window.onOnPremCookieAvailable=this._onOnPremCookieAvailable.bind(this)}get _tokenTimeout(){return this._tokenExpiry.valueOf()-(new Date).valueOf()-this._tokenExpiryWindow}get tokenExpired(){return this._tokenTimeout<0}retrieveAuthToken(e=!1){return this._retrieveAuthTokenFromShim(e)}clearAuthToken(){this._authToken=null,this._store.dispatch(Object(Je.d)(null))}setupCookieForOnPrem(){const e=Object(Q.b)();document.getElementById("authToken").setAttribute("value",this._securityTokenResponse),document.getElementById("wctx").setAttribute("value",`ru=${Object(ot.CrmUrlEncode)(e)}/nga/main.aspx`);const t=document.getElementById("authForm");t.action=e,window.clearTimeout(this._cookieTimeoutTimer),this._cookieTimeoutTimer=window.setTimeout(()=>{this._tracer.error("On prem cookie setup, using legacy endpoint failed"),Object(et.b)("OnPrem_CookieSetup",rt.a.authentication,"Legacy cookie setup for onprem org timed out")},6e4),t.submit()}_onOnPremCookieAvailable(){window.clearTimeout(this._cookieTimeoutTimer),Object(et.c)("OnPrem_CookieSetup",rt.a.authentication,"Legacy cookie setup for onprem org successful")}_retrieveAuthTokenFromShim(e){if(this._authToken&&!this.tokenExpired&&!e)return Promise.resolve(!0);this._authToken=null,clearTimeout(this._tokenExpiryTimer);const t=new Promise((e,t)=>{this._tokenRetrievedCallbacks.push({successCallback:e,failureCallback:t})});return this._authInProgress||(this._authInProgress=!0,We.a.get_Instance().get_account().requestSecurityToken(e,this._parseSecurityTokenResponse.bind(this))),t}_parseSecurityTokenResponse(e,t,r,i,n){this._parseSecurityTokenResponseInternal(e,{authResultStatus:t,errorCode:r,errorDescription:i},n)}_parseSecurityTokenResponseInternal(e,t,r){if(this._authInProgress=!1,this._isErrorResponse(e))return void this._handleFailure(t);const i=function(e){e=Object(Qe.c)(e,"");const t=Object(Ye.b)(e),r=Object(Ye.a)(t);return r.selectSingleNode("/RequestOAuthSecurityTokenResponse/AccessToken")?new it(r):new nt(r)}(e);this._authToken=i.get_authToken(),this._tokenExpiry=i.get_tokenExpiryUtcTime();const n=i.get_objectId(),o=i.get_tenantId();this._securityTokenResponse=i.get_securityTokenResponse(),this._tokenExpiryTimer=window.setTimeout(()=>{Object(Ze.b)(this._store.getState())&&this.retrieveAuthToken(!0)},this._tokenTimeout),this._handleSuccess(n,o,r)}_isErrorResponse(e){return"AuthError"===e}_handleFailure(e){const t=[];e&&t.push({name:"description",value:e.errorDescription}),e&&t.push({name:"resultStatus",value:e.authResultStatus}),e&&t.push({name:"code",value:e.errorCode}),this._tracer.error("Token retrival failure",t);const r=0===e.authResultStatus?2147873354:2147873353,i=new $.a(e.errorDescription,r);this._tokenRetrievedCallbacks.forEach(e=>{e.failureCallback&&e.failureCallback(i)}),this._tokenRetrievedCallbacks=[]}_handleSuccess(e,t,r){this._store.dispatch(Object(Je.d)(this._authToken)),this._store.dispatch(Object(Je.e)(e)),this._store.dispatch(Object(Je.f)(t)),this._tokenRetrievedCallbacks.forEach(e=>{e.successCallback&&e.successCallback(r)}),this._tokenRetrievedCallbacks=[]}}var st=r("WkRo"),ct=r("2FbK"),lt=r("fWyz"),ut=r("Xi8U"),pt=r("A2T2"),dt=r("cfbi"),ht=r("nVeB"),mt=r("eagp"),gt=r("SAYH"),_t=r("17x/"),bt=r("v77L");async function vt(e,t,r){const i=JSON.parse(e),{operation:n,payload:o}=i;let a;switch(n){case"getRecentItems":a=function(e){const t={ok:!0,payload:Object(ut.h)(e.getState())};return Promise.resolve(t)}(t);break;case"getSiteMap":a=function(e){const t={ok:!0,payload:Object(ct.a)(e.getState())};return Promise.resolve(t)}(t);break;case"getSupportedVersions":a=Promise.resolve({ok:!0,payload:["1.0.0"]});break;case"lookup":a=function(e,t){const{entityTypes:r}=e;if(!r||!r.length)return Promise.reject(new Error("No entityTypes specified for lookup"));const i=Object(Ge.c)(t.getState());return Object(ht.a)(e,i,t.dispatch).then(e=>({ok:!0,payload:e}))}(o,t);break;case"openSettings":a=function(e){return e.dispatch(Object(mt.d)(bt.e)),Promise.resolve({ok:!0})}(t);break;case"openUserProfile":a=function(e){return e.dispatch(Object(mt.d)(bt.c)),Promise.resolve({ok:!0})}(t);break;case"navigateToEntity":{const{entityName:e,entityId:r}=o;a=function(e,t,r){const i={entityTypeName:e,id:new gt.a(t)};return r.dispatch(Object(He.a)(dt.a,i,void 0,{replaceState:!0})).then(e=>0!==e.status?ft(e.error):{ok:!0})}(e,r,t)}break;case"navigateToRecentItem":a=function(e,t){return t.dispatch(Object(lt.d)(e,!1,null,{replaceState:!0})).then(e=>0!==e.status?ft(e.error):{ok:!0})}(o,t);break;case"navigateToSiteMapItem":a=function(e,t){return t.dispatch(Object(lt.c)(e,!1,null,{replaceState:!0})).then(e=>0!==e.status?ft(e.error):{ok:!0})}(o,t);break;case"pinRecentItem":a=function(e,t){return t.dispatch(Object(pt.c)(e)),Promise.resolve({ok:!0})}(o,t);break;case"unpinRecentItem":a=function(e,t){return t.dispatch(Object(pt.d)(e)),Promise.resolve({ok:!0})}(o,t);break;case"getOfflineProfileStatus":a=function(e){const t={ok:!0,payload:Object(_t.a)(e.getState())};return Promise.resolve(t)}(t);break;default:a=Promise.resolve({ok:!1,errorMessage:"Unrecognized shell API operation: "+n})}try{St(n,await a,i.requestId,r)}catch(e){St(n,ft(e),i.requestId,r)}}function ft(e){let t=e.displayTitle?e.displayTitle+". ":"";return t+=e.displayMessage||"",t||(t=`${e.message}: ${e.stack}`),{ok:!1,errorMessage:t}}function St(e,t,r,i){const n=i.get_device(),o=n.get_IsAvailable(),{ok:a,errorMessage:s,payload:c}=t;if(o){const t={name:"shellApiResponse",version:"1.0.0",operation:e,requestId:r,ok:a,errorMessage:s,payload:c};n.postMessage(JSON.stringify(t))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class kt{constructor(e,t,r=!1){this._bridge=We.a.get_Instance(),r&&D.a.getInstance().get_IsIOS()&&this._bridge.forceDeviceReady(),this._dispatcherMethodNames=N,this._tokenProvider=new at(t,e)}get tokenProvider(){return this._tokenProvider}executeServiceOperation(e,t,r){const n=e.getServiceName(),o=e.getOperationName(),a=e.getParameters().slice(),s=this._dispatcherMethodNames[n];if(!s)return Promise.reject({errorCode:p.a.ServiceNotSupported,param:n});const l=s[o];if(!l)return Promise.reject({errorCode:p.a.ServiceAndOperationNotSupported,param:n+"."+o});const u=new i.a(n,l,a);return function(e,t,r){switch(e.getServiceName()){case c.i:return new re(t,r.tokenProvider);case c.b:return new g(t);case c.d:return new x(t);case c.e:return new j(t);case c.f:return new R(t);case c.g:return new G(t);case c.a:return new K(t);default:return new h(t)}}(e,this._bridge,this).executeServiceOperation(u,t,r)}addOnPlatformReady(e,t,r){const i=this._bridge;this._bridge.add_onReadyOrNow(async()=>{r.dispatch(Object(ze.d)(qe.b.Native)),r.dispatch(Object(ae.j)(this._getClientHostSubtype(t))),await this._subscribeToCustomEvents(i,r),await this._subscribeToPropertyChanged(i,r),this._subscribeToStateChanged(i,r),this._subscribeToBackButtonRouterEvent(t,r),this._subscribeToAppLinkChanged(i,r),this._subscribeToShellApiRequests(i,r),function(e,t,r){const i=[];for(const t in d)i.push(h.getAvailableServiceOperations(e,t));i.push(re.getAvailableServiceOperations(e,r)),i.push(g.getAvailableServiceOperations(e)),i.push(x.getAvailableServiceOperations(e)),i.push(j.getAvailableServiceOperations(e)),i.push(R.getAvailableServiceOperations(e)),i.push(G.getAvailableServiceOperations(e)),i.push(K.getAvailableServiceOperations(e));const n={};for(let e=0;e<i.length;e++){const t=i[e];t&&(n[t.name]=t)}r.dispatch(Object(ie.b)(n))}(i,0,r),e()})}_getClientHostSubtype(e){const t=Object($e.a)();switch(t){case Ke.a.Phone:return Le.a.Phone;case Ke.a.Slate:case Ke.a.MailApp:return Le.a.Tablet;default:return e.TraceManager.getTracer().error("Failed to initialize client host subtype: "+t),Le.a.Tablet}}async _subscribeToPropertyChanged(e,t){for(let r=0;r<Ce.length;r++){const i=Ce[r],n=s(e,i.dispatcherName);if(n){const e=await n;e.apcl.call(e,i.propertyName,(e,r)=>i.handler(e,r,t)),i.handler(e,i.propertyName,t)}}}async _subscribeToCustomEvents(e,t){for(let r=0;r<Be.length;r++){const i=Be[r],n=a(e,i.dispatcherName);if(n){const e=await n;e.addCustomEventHandler.call(e,i.eventName,e=>i.handler(e,t))}}}_subscribeToStateChanged(e,t){e.add_onActive(()=>{t.dispatch(Object(ze.c)(qe.a.Active))});e.add_onInactive(()=>{t.dispatch(Object(ze.c)(qe.a.Inactive))})}_subscribeToAppLinkChanged(e,t){e.add_onAppLink(e=>{let r=Object(Ge.a)(t.getState());"#"===r.slice(-1)&&(r=r.slice(0,-1)),t.dispatch(Object(He.a)(r+e))})}_subscribeToBackButtonRouterEvent(e,t){document.addEventListener("routerBackButtonChanged",()=>{const r=new Ve.a(e,t);r.isOperationAvailable("updateBackBehavior")&&(Object(st.b)(t.getState())?r.updateBackBehavior(Me.CallAppCode):r.updateBackBehavior(Me.CloseShim))},!1)}_subscribeToShellApiRequests(e,t){e.add_onShellApiRequest(r=>{vt(r,t,e)})}setDispatcherMethodNames(e){this._dispatcherMethodNames=e}}}}]),window.bundleExecutionMarkers["scripts/nativeplatform.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();