(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/5.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[5],{"+aBC":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("jq7Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e,t){return e+":"+t}function a(e,t,i,a){const s=n(i,a),o=Object(r.a)(e,t);return o&&o.customDataProviderOutputs&&o.customDataProviderOutputs[s]?o.customDataProviderOutputs[s]:null}},"+hq9":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="form.setIsAutoSaving";function a(e,t,i){const a=Object(r.v)(t);return{type:n,payload:{isAutoSaving:i},meta:{pageId:e,contextKey:a}}}},"/qEh":function(e,t,i){"use strict";i.d(t,"b",(function(){return b})),i.d(t,"a",(function(){return y}));var r=i("sX6v"),n=i("bT7G"),a=i("arV0"),s=i("odYE"),o=i("5Oca"),l=i("i1f0"),u=i("BvQu"),c=i("P+kM"),d=i("dHD5"),p=i("SAYH"),h=i("8nT0"),m=i("y60j"),g=i("7Sr4"),f=i("JP46");function b(e,t){const i=[];return{type:"snapshot.update.async",execute({dispatch:b,getState:y},v,O){const _=v.TraceManager.getTracer("Forms.UpdateSnapshot"),P=y(),S=Object(d.j)(P,e),w={},I={},{entityTypeName:j,id:C,processId:D}=Object(a.g)(P,e);i.push({name:"entityTypeName",value:j},{name:"id",value:p.a.toString(C)},{name:"processId",value:D}),_.info("updateSnapshotWithOptions started.",i);const E=Object(l.ac)(P,e,S);if(!E)return i.push({name:"CorrelationId",value:O.correlationId},{name:"ContextId",value:O.contextId},{name:"ActionStack",value:O.stack}),_.warn("Null/undefined snapshotId",i),Promise.resolve({unboundAttributes:w,attributesPendingUpdate:I});i.push({name:"snapshotId",value:E});const T=Object(l.Pc)(P,e,S);T.length>0&&i.push({name:"updateFieldNames",value:T.slice(0,15).toString()}),function(e,t,i,n){if(n){const a={[h.r]:{id:p.a.tryParse(n)}};e(Object(r.b)(t,i,a))}}(b,P,E,D);const F=[],N={},R=new s.a(j,C);return function(e,t,i,r,a,s,c,d,p){const h=Object(l.Ac)(e,t,r);if(null==h)d.warn("Null/undefined submitModesByFieldName",p);else if(0===Object.keys(h).length)d.warn("0 length submitModesByFieldName",p);else{p.push({name:"NumSubmitModesByFieldName",value:Object.keys(h).length});for(const t in h)if(h[t]===u.a.Always){if(Object(n.e)(e,i,t))continue;s[t]=Object(o.j)(e,a,t)}else h[t]===u.a.Never&&Object(n.e)(e,i,t)&&c.push(t)}}(P,e,E,S,R,N,F,_,i),function(e,t,i,r,a,s,o){let l=Object(m.l)(e,t);const u=new Set(Object(m.y)(e,t));l&&l.length>0&&u&&(l=l.filter(e=>!u.has(e)));if(l&&l.length>0){o.push({name:"NumUnboundAttributes",value:l.length});let t=0;for(let o=0;o<l.length;++o)if(Object(n.f)(e,i,l[o])){const u=Object(n.d)(e,i,r,l[o]);u&&(s[l[o]]=u),a.push(l[o]),++t}o.push({name:"NumUnboundAttributesProcessed",value:t})}}(P,t,E,R,F,w,i),function(e,t,i,r,a){const s=Array.from(g.a.getInstance().getAttributesPendingUpdate());if((null==s?void 0:s.length)>0)for(let o=0;o<s.length;++o)if(Object(n.f)(e,t,s[o])){const l=Object(n.d)(e,t,i,s[o]);l&&(a[s[o]]=l),r.push(s[o])}}(P,E,R,F,I),function(e,t,i){const r=Object(n.b)(e,t);if(r){const a=r.activeChanges&&Object.keys(r.activeChanges);if(null==a?void 0:a.length)for(const s of a){const a=Object(o.j)(e,r.identifier,s),l=Object(n.d)(e,t,r.identifier,s);Object(f.b)(a,l)||i.push(s)}}}(P,E,F),Object.keys(N).length&&b(Object(r.b)(P,E,N)),F.length&&b(Object(c.b)(E,!0,F)),v.EventManager.ReportComponentSuccess("Forms.UpdateSnapshot",i),Promise.resolve({unboundAttributes:w,attributesPendingUpdate:I})},getFailureParameters:(e,t)=>i}}function y(e,t,i){const s=t?Object.keys(t).length:0,o=i?Object.keys(i).length:0,u=[{name:"numUnboundAttributes",value:s}];return{type:"snapshot.update.addAttributesBack.async",execute({dispatch:c,getState:h},m,g){const f=h(),b=Object(d.j)(f,e),{entityTypeName:y,id:v,processId:O}=Object(a.g)(f,e);u.push({name:"entityTypeName",value:y},{name:"id",value:p.a.toString(v)},{name:"processId",value:O});const _=Object(l.ac)(f,e,b);if(u.push({name:"snapshotId",value:_}),_){if(s>0&&c(Object(r.b)(f,_,t)),o>0){const e=Object.keys(i).filter(e=>!Object(n.f)(f,_,e));if(e.length>0){const t={};e.forEach(e=>{t[e]=i[e]}),c(Object(r.b)(f,_,t))}}m.EventManager.ReportComponentSuccess("Forms.AddAttributesBackToSnapshot",u)}else u.push({name:"CorrelationId",value:g.correlationId},{name:"ContextId",value:g.contextId},{name:"ActionStack",value:g.stack}),m.EventManager.ReportComponentFailure("Forms.AddAttributesBackToSnapshot",new Error("Null/undefined snapshotId"),"Check Forms.UpdateSnapshot. If that succeeded, so should this.",u);return Promise.resolve()},getFailureParameters:(e,t)=>u}}},"00VO":function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){const i=[],r=e?e.split("|"):null;r&&r.forEach(e=>{i.push({attributeName:t,conditionOperator:6,value:e+"%"})});const n={conditions:i,filterOperator:1,filters:[]};return JSON.stringify(n)}function n(e,t,i){const r=new DOMParser,n=r.parseFromString(e,"text/xml"),a=n.getElementsByTagName("entity");if(a.length>0){const e=a[0],s="name";if(e.hasAttribute(s)&&"systemuser"===e.attributes.getNamedItem(s).value){const a=`<link-entity name="teammembership" to="systemuserid" from="systemuserid" link-type="inner">\n\t\t\t<link-entity name="team" to="teamid" from="teamid" link-type="inner">\n\t\t\t\t<filter type="and">\n\t\t\t\t<condition attribute="regardingobjectid" operator="eq" value="${i}"/>\n\t\t\t\t<condition attribute="teamtype" operator="eq" value="1" />\n\t\t\t\t<condition attribute="teamtemplateid" operator="eq" value="${t}"/>\n\t\t\t\t</filter>\n\t\t\t</link-entity>\n\t\t\t</link-entity>`,s=r.parseFromString(a,"text/xml");if(s.hasChildNodes()){e.appendChild(s.firstChild);return{updatedFetchXml:(new XMLSerializer).serializeToString(n.firstChild),filterString:a}}}}return{updatedFetchXml:e,filterString:""}}function a(e,t,i){let r=i;if(e){const n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("order");if(!n)return i;{let e=0,a=0;for(;a<n.length;a++)if(n[a].parentNode&&n[a].parentNode.localName&&"link-entity"!==n[a].parentNode.localName){e=a;break}if(a>=n.length)return i;const o=n[e];if(o){r=o.getAttribute("attribute");r=s(r,t[r].Type,i)}}}return r}function s(e,t,i){return e=function(e,t){"customer"!==e&&"lookup"!==e&&"owner"!==e||(t+="name");return t}(t,e),function(e){switch(e){case"string":case"memo":case"customer":case"lookup":case"owner":return!0;default:return!1}}(t)||(e=i),e}i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return s}))},"1HWW":function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return u}));var r=i("dHD5"),n=i("iF9X"),a=i("SAYH"),s=i("sZ+8"),o=i("69Qu");const l="has.offline.changes";function u(e,t){const i=[{name:"entityLogicalName",value:e}];return{type:"has.offline.changes.async",execute({dispatch:r,getState:l},u,c){const d=l(),p=Object(o.b)(d),h=Object(n.a)(d),m=Object(s.l)(d,e);return i.push({name:"CorrelationId",value:c.correlationId},{name:"ContextId",value:c.contextId},{name:"ActionStack",value:c.stack},{name:"isServerAvailableFromState",value:p},{name:"isMocaOfflineEnabled",value:h},{name:"isEntityAvailableForOffline",value:m}),!p&&h&&m?u.OfflineProvider.hasOfflineChanges(e,a.a.toLegacyGuid(t)).nativePromise().then(e=>(u.EventManager.ReportComponentSuccess("Forms.SetHasOfflineChanges.HasOfflineChanges",i),e)):(u.TraceManager.getTracer("Forms.SetHasOfflineChanges").warn("Not checking for offline changes.",i),Promise.resolve(!1))},getFailureParameters:(e,t)=>i}}function c(e,t,i){const n=Object(r.v)(t);return{type:l,payload:{hasOfflineChanges:i},meta:{pageId:e,contextKey:n}}}},"1uZV":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var r=i("SAYH"),n=i("zu1I"),a=i("i1f0"),s=i("bT7G"),o=i("dHD5"),l=i("YYhu"),u=i("uIhY"),c=i("iZ7K"),d=i("uNLT"),p=i("zmL5");function h(e,t,i){const h=[];return{type:"form.openManageDuplicatesDialog",execute({dispatch:m,getState:g},f,b){var y,v;const O=g(),_=i?Object(s.c)(O,i):Object(s.b)(O,Object(a.ac)(O,e,Object(o.j)(O,e)));if(_&&_.identifier){const i=f.TraceManager.getTracer(d.b),a=Object(l.b)(O,_,i);let s,o;const g=a.get_identifier(),P=g.LogicalName;try{s=Object(u.b)(O,a),o=Object.assign({"@odata.type":"#Microsoft.Dynamics.CRM."+P},s)}catch(e){const t=[{name:"CorrelationId",value:b.correlationId},{name:"ContextId",value:b.contextId},{name:"ActionStack",value:b.stack}];return f.EventManager.ReportComponentFailure("Forms.OpenManageDuplicatesDialog",Error(JSON.stringify(e)),void 0,t),Promise.resolve({status:1,error:e})}if(!r.a.isNullOrEmpty(r.a.fromLegacyGuid(g.Id))){o[Object(c.h)(O,P).PrimaryKeyName]=g.Id.toString()}const S=function(e){var t,i,r,n,a,s,o,l,u,c;const d=function(e){var t;const i=null===(t=null==e?void 0:e.errorFault)||void 0===t?void 0:t.get_innerFault();return null==i?void 0:i.get_message()}(e),p=d?null===(t=JSON.parse(d))||void 0===t?void 0:t.DuplicateAttributes:void 0,h=new DOMParser,m=p?h.parseFromString(p,"text/xml"):void 0;if((null===(n=null===(r=null===(i=null==m?void 0:m.getElementsByTagName("DuplicateValues"))||void 0===i?void 0:i[0])||void 0===r?void 0:r.children)||void 0===n?void 0:n.length)>0){const e={},t=m.getElementsByTagName("DuplicateValues")[0].children;for(let i=0;i<t.length;i++){const r=null===(s=null===(a=t[i])||void 0===a?void 0:a.getAttribute("key"))||void 0===s?void 0:s.toString(),n=null===(c=null===(u=null===(l=null===(o=t[i])||void 0===o?void 0:o.childNodes)||void 0===l?void 0:l[0])||void 0===u?void 0:u.nodeValue)||void 0===c?void 0:c.toString();r&&n&&(e[r]=n)}return e}return{}}(t),w={entity_record:Object.assign(Object.assign({},o),S)},I=Object(p.b)(O,e);h.push({name:"formId",value:null===(y=null==I?void 0:I.guid)||void 0===y?void 0:y.toString()},{name:"entityName",value:P},{name:"entityId",value:null===(v=null==g?void 0:g.Id)||void 0===v?void 0:v.toString()}),f.EventManager.ReportComponentSuccess("Forms.OpenManageDuplicatesDialog",h);const j={height:"600px",width:"800px"};return m(Object(n.b)("ManageDuplicates",j,w,e)).then(e=>(f.EventManager.ReportComponentSuccess("Forms.OpenManageDuplicatesDialog",h),e))}h.push({name:"SnapshotExists",value:null!=_}),f.TraceManager.getTracer("Forms.OpenManageDuplicatesDialog").warn("Null/undefined snapshot or snapshot.identifier.",h)},getFailureParameters:(e,t)=>h}}},"2ciq":function(e,t,i){"use strict";i.d(t,"d",(function(){return g})),i.d(t,"c",(function(){return b})),i.d(t,"a",(function(){return f})),i.d(t,"b",(function(){return y}));var r=i("455M"),n=i("Xd5/"),a=i("q6Ks"),s=i("IqkD"),o=i("LbMF"),l=i("WPtp"),u=i("dHD5"),c=i("odYE"),d=i("tJdb"),p=i("Ae6N"),h=i("5Oca"),m=i("jq7Z");function g(e,t,i,a,s,u,p,m,g){switch(a){case r.a.WholeTimeZone:return function(e,t){const i={},r=t.timeZoneDefinitionByCode;for(const e in r)if(r.hasOwnProperty(e)){const a=r[e];i[a.timeZoneCode]=n.w(a.timeZoneCode,t)}return e.TimeZoneByCode=i,e}(e,i);case r.a.WholeLanguage:return function(e,t,i){const r={},a=t.enabledLanguages;for(let e=0;e<a.length;e++){const t=a[e];r[t]=n.n(t,i)}return e.LanguageByCode=r,e}(e,t,s)}return u===d.a.Rollup?function(e,t,i,r){const a=Object(o.d)(t,i),s="_date",u="_state",d=new c.a(i,r),p=a[e.LogicalName];let m=p.LogicalName;p.IsBaseCurrency&&(m=m.substring(0,m.length-5));const g=Object(l.c)(Object(h.j)(t,d,m+s)),f=Object(l.c)(Object(h.j)(t,d,m+u)),b=Object(o.a)(t,i,e.LogicalName),y=n.z(t,b);return e.lastUpdatedValue=g?n.a(g,"date",y.cultureInfo,y):new Date(g),e.rollupStateValue=Number(f),e.rollupStateField=m+u,e.lastUpdatedField=m+s,e.calculatedFieldValid=!1,e.rollupValid=!0,e.recalculate=null,e}(e,p,m,g):e}function f(e,t,i,r,n){let a=!1;const s=new c.a(t,i),o=Object(h.y)(e,n,s,r.lastUpdatedField),l=Object(h.y)(e,n,s,r.rollupStateField);return(o>r.lastUpdatedValue||l!==r.rollupStateValue)&&(r.lastUpdatedValue=o,r.rollupStateValue=l,a=!0),a}function b(e,t,i,r,l,c){const d=e.formatted,h=Object(s.w)(t);let g=p.a.UserLocal;const f=Object(a.c)()(t).response;if(!f.formatInfoCultureName||!f.numberFormatInfo||!f.dateTimeFormatInfo)return d;const b=new Sys.CultureInfo(f.formatInfoCultureName,f.numberFormatInfo,f.dateTimeFormatInfo),y=Object(u.x)(c),v=Object(m.a)(t,i.id);if(!(v&&v.metadata&&v.metadata[y]&&v.metadata[y].attributes&&v.metadata[y].attributes[l]&&v.metadata[y].attributes[l].Format))return d;const O=Object(o.a)(t,c.entityTypeName,l),_=n.z(t,O),P=v.metadata[y].attributes[l].Format;let S=e.value;if(_.controlAttributes.Behavior===p.a.TimeZoneIndependent||_.controlAttributes.Behavior===p.a.DateOnly){g=p.a.None;const t=new Date(e.value);S=new Date(t.getTime()+6e4*t.getTimezoneOffset())}else S=n.D(d,_,b,_.controlAttributes.Format);return n.j(S,h,b,P,g)}function y(e,t){const i=e.Parameters[t];if(3===i.Usage){const e=i.Attributes;return e.LogicalName||e.EntityLogicalName}return i.Value}},"3HPu":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return n}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="form.invalidAttributes";function a(e,t,i,a){const s=Object(r.v)(a);return{type:n,payload:{attributeName:t,isValid:i},meta:{pageId:e,attributeName:t,contextKey:s}}}},"4DTG":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(e,t,i,r,n){Object.assign(this,e),this.getViewId=()=>t,this.getTargetEntityType=()=>r,this.getTitle=()=>i,this.addColumn=n}refresh(){throw new Error("Not Replaced")}getViewId(){throw new Error("Not Replaced")}getTargetEntityType(){throw new Error("Not Replaced")}setSelectedRecordIds(e){throw new Error("Not Replaced")}getSelectedRecordIds(){throw new Error("Not Replaced")}clearSelectedRecordIds(){throw new Error("Not Replaced")}retrieveRecordCommand(e,t,i,r,n){throw new Error("Not Replaced")}openDatasetItem(e){throw new Error("Not Replaced")}getTitle(){throw new Error("Not Replaced")}addColumn(e,t){throw new Error("Not Replaced")}getCellImageInfo(e,t){throw new Error("Not Replaced")}}},"4UCL":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return o}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="userUpdatedFields.add",a="userUpdatedFields.clear";function s(e,t,i){const a=Object(r.x)(t);return{type:n,payload:{fieldValues:i},meta:{pageId:e,contextKey:a}}}function o(e,t,i){const n=Object(r.x)(t);return{type:a,payload:{keepFields:i},meta:{pageId:e,contextKey:n}}}},"5R5s":function(e,t,i){"use strict";i.d(t,"a",(function(){return E}));var r=i("85o3"),n=i("YxC/");var a=i("w+N3"),s=i("EY5k");function o({dispatch:e,getState:t},i){return new Promise((i,r)=>{const o=e(Object(s.e)(a.c));Promise.all([o]).then(()=>{const e=function(e,t,i){const r=Object(n.e)(e,t),a={};if(i)for(const e in i)a[e]=Object(n.c)(r,i[e].filterLabel);return a}(t(),a.c,a.b),r=[];for(const t in a.b){const i={value:a.b[t].filterValue,text:e[t]};"all"===t&&(i.isDefault=!0),r.push(i)}i(r)})})}var l=i("PVDM"),u=i("Xd5/"),c=i("BFlg"),d=i("Ae6N");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t,i){let r,n,a=null;if(e)switch(e){default:case"All":break;case"Today":n=e,r="all";break;case"Overdue":case"Tomorrow":case"NextXDays;7":case"NextXDays;30":case"NextXDays;90":case"NextXMonths;6":case"NextXMonths;12":n=e,r="active"}if(n&&r){const s=function(e,t,i){if(!e||"All"===e)return null;let r=null;const n=[],a="scheduledend";if("inactive"!==t){const{formatInfoCultureName:t,numberFormatInfo:s,dateFormatInfo:o}=i,l=new Sys.CultureInfo(t,s,o),c=Object(u.t)(new Date,l,d.a.UserLocal,i.timeZoneUtcOffsetMinutes,i.timeZoneAdjusters);n.push({attributeName:a,conditionOperator:26,value:c}),"Overdue"!==e&&n.push(h(a,e)),"Tomorrow"===e&&n.push(h(a,"Today")),n&&n.length>0&&(r={conditions:n,filterOperator:1})}return r}(n,r,t),o=function(e,t,i){if("All"===e)return null;let r=null;const n=[],a={attributeName:"statecode",conditionOperator:0,value:"Open"},s={attributeName:"statecode",conditionOperator:0,value:"Completed"},o={attributeName:"statecode",conditionOperator:0,value:"Canceled"},l={attributeName:"statecode",conditionOperator:0,value:"Scheduled"};switch(t){default:case"active":switch(n.push(a),i){case"serviceappointment":case"appointment":case"recurringappointmentmaster":case c.a:n.push(l);break;case"email":n.push(s)}break;case"inactive":n.push(s),n.push(o);break;case"all":}n&&n.length>0&&(r={conditions:n,filterOperator:1});return r}(e,r,i),l=function(e,t){let i=null;if(t&&"All"!==t){const e=[h("actualend",t)];e&&e.length>0&&(i={conditions:e,filterOperator:0})}return i}(0,undefined),p=[];s&&p.push(s),o&&p.push(o),l&&p.push(l),a={filterOperator:0,conditions:null,filters:p}}else a={conditions:null,filterOperator:0,filters:[]};return a}function h(e,t){const i=t.split(";"),r=i.length>1?i[1]:"";return{attributeName:e,conditionOperator:m(i[0]),value:r}}function m(e){if(!e)return null;switch(e){case"Today":return 15;case"Tomorrow":return 16;case"Yesterday":return 14;case"NextXDays":return 34;case"NextXMonths":return 38;case"LastXDays":return 33;case"LastXMonths":return 37}}var g=i("lEp6"),f=i("uNu9"),b=i("FZDd"),y=i("LbMF"),v=i("jRy5"),O=i("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _="GridFilterOptionsKeyForValueAll";function P({dispatch:e,getState:t},i,r,o){if(o&&Object(O.h)(t(),o.relationshipName,o.contextTokenType===v.a.AssociatedGrid)){const i=e(Object(s.e)([a.a])),o=e(Object(b.f)(r,!1,["statecode"]));return Promise.all([i,o]).then(()=>{let e=[];const i=Object(y.a)(t(),r,"statecode");i&&i.OptionSet&&(e=i.OptionSet.map(e=>({value:e.Value.toString(),text:e.Label,isDefault:e.Value===i.DefaultValue})));const s=Object(n.e)(t(),[a.a]);return e.push({value:_,text:Object(n.c)(s,a.a)}),e})}return Promise.resolve([])}var S=i("XvLr");const w="queueid",I="statecode",j="scheduledend",C="statecode",D="msdyn_forecastdefinitionid";function E(e,t,i,n,a){if(!e)return null;let s=t&&t.guid;const u=(e,t=r.b)=>{const i=t.replace(/-/g,"");return e.concat(i)},d=()=>(s||(s=t&&t.guid),s),h=e=>({filterOperator:1,hint:"union",conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"0",entityAliasName:u("Q_Internal_",e)},{attributeName:"systemuserid",conditionOperator:0,value:d(),entityAliasName:u("M_Internal_",e)}]}),m=e=>{const t=[];return t.push({name:"queue",from:"queueid",to:"queueid",alias:u("Q_Internal_",e),linkType:n?"inner":"outer"}),t.push({name:"queuemembership",from:"queueid",to:"queueid",alias:u("M_Internal_",e),linkType:"outer"}),t},b=e=>{if(!e)return null;const t=e.split(":");t.length>1&&(e=t[1]);const i=e.toString();if(i===r.a)return h(i);if(i===r.e){return{filterOperator:1,conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"0",entityAliasName:u("Q_Internal_",i)}]}}if(i===r.d){return{filterOperator:0,conditions:[{attributeName:"queueviewtype",conditionOperator:0,value:"1",entityAliasName:u("Q_Internal_",i)},{attributeName:"systemuserid",conditionOperator:0,value:d(),entityAliasName:u("M_Internal_",i)}]}}const n=[],a={conditions:[],filterOperator:0},s=e.split(r.c);if(s.length){const e={attributeName:"queueid",conditionOperator:8,value:s};a.conditions.push(e)}n.push(a);const o=h(r.a);n.push(o);return{filterOperator:0,conditions:[],filters:n}};if(a||e.toLowerCase()===c.a)return{getAdditionalColumns:()=>[j,I],getFilterOptionsAction:()=>Object(r.i)(e,i,o),getFilterExpression:(e,t,i)=>{const r=p(e,t,i);return r?JSON.stringify(r):""},getFilterAndLinkedEntities:e=>null,getFilterLabelResourceKey:()=>S.ACTIVITY_DUE_DATE_FILTER_LABEL};switch(e.toLowerCase()){case"queueitem":return{getAdditionalColumns:()=>[w],getFilterOptionsAction:()=>Object(r.i)(e,i,r.j),getFilterExpression:e=>{const t=b(e);return t?Object(g.b)(t):null},getFilterAndLinkedEntities:(e,t)=>{if(null!=e){const i=e.split(":"),n=(e=i.length>1?i[1]:i[0]).toString();let a=null;if(t&&(a=b(n)),n===r.e){const e=[];return e.push({name:"queue",from:"queueid",to:"queueid",alias:u("Q_Internal_",n),linkType:"inner"}),{filter:a,linkEntities:e}}if(n===r.d){const e=[];return e.push({name:"queue",from:"queueid",to:"queueid",alias:u("Q_Internal_",n),linkType:"inner"}),e.push({name:"queuemembership",from:"queueid",to:"queueid",alias:u("M_Internal_",n),linkType:"inner"}),{filter:a,linkEntities:e}}return{filter:a,linkEntities:m(r.a)}}return null},getFilterLabelResourceKey:()=>S.QUEUE_FILTER_LABEL};case l.a:return{getAdditionalColumns:()=>[D],getFilterOptionsAction:()=>Object(r.i)(e,i,l.b),getFilterExpression:(e,t,i)=>{if(!e)return null;const r=e.indexOf(":");-1!==r&&(e=e.substring(r+1));const n=Object(l.c)(e,t,i);return n?JSON.stringify(n):""},getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>S.QUEUE_FILTER_LABEL};case f.ob:case f.ab:case f.bb:case f.Kb:case f.Cb:case f.C:return{getAdditionalColumns:()=>[C],getFilterOptionsAction:()=>Object(r.i)(e,i,P),getFilterExpression:(e,t,i)=>{if(!e)return null;const r=function(e,t,i){if(!e||e===_)return null;let r=null;const n=[];return n.push({attributeName:"statecode",conditionOperator:0,value:e}),n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}(e);return r?JSON.stringify(r):""},getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>S.GRID_FILTER_LABEL};default:return{getAdditionalColumns:()=>null,getFilterOptionsAction:()=>Object(r.i)(e,i,r.g),getFilterExpression:()=>null,getFilterAndLinkedEntities:()=>null,getFilterLabelResourceKey:()=>null}}}},"5ipV":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("4DTG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n extends r.a{constructor(e,t,i,r){super(e,t,i,r),Object.assign(this,e)}selectView(e){throw new Error("Not wrapped")}getRecentItems(){throw new Error("Not Replaced")}getLookupConfiguration(){throw new Error("Not Replaced")}getAllViews(){throw new Error("Not Replaced")}getDataSetParameter(e,t){throw new Error("Not Replaced")}getDefaultViewId(e){throw new Error("Not Replaced")}setMyRecordsOnlyFilter(e){throw new Error("Not Replaced")}sendLookupRequest(e,t,i,r,n){throw new Error("Not Replaced")}runPreSearch(){throw new Error("Not Replaced")}setRelatedFilter(e){throw new Error("Not Replaced")}}},"65OV":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("ILmX"),n=i("eD3A"),a=i("ZdjS"),s=i("wgH2"),o=i("odYE"),l=i("cUMa"),u=i("6hHv"),c=i("GT4X"),d=i("RD1j");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function p(e,t,i,p,m,g,f,b,y,v,O,_){if(!e||!e.commands||void 0===e.commands[i]||null===e.commands[i])return Promise.reject(void 0);const P=Object(r.k)(e,i),S=Object(s.c)(e,i);b&&m.length>0&&1===m.length&&m.map(e=>{e.etn!==S.EntityLogicalName&&(S.EntityId=e.id,S.EntityLogicalName=e.etn)});const w=Object.assign({},S);O&&(w.CustomControlType=O);const I=m.map(e=>({EntityReference:e})),j=S.SelectedItems.map(e=>e.EntityReference),C=!0===_||!1===_?_:!Object(l.a)(j,m,o.a.equals);return w.SelectedItems=I,function(e,t,i,n,a,s,o,l,d){if(n)return l(Object(u.e)(t,i,a,s,o)).then(t=>Object(r.c)(e,t,a,s,i.SelectedItems.length>0));const p=Object(c.d)(e,s);return Promise.resolve(Object(r.c)(e,p,a,s,i.SelectedItems.length>0))}(e,P,w,C,t,i,p,g).then(r=>{const s=[];if(f&&f.length>0)f.forEach(e=>{if(r[e]){const n=r[e].Priority;if(!y||null!=n){const n=Object(a.a)(P,w,r[e].CommandType,r[e].CommandId,r[e].ControlId,t,i,p),o={commandId:r[e].CommandId,commandButtonId:e,execute:n,label:r[e].LabelText,canExecute:r[e].CanExecute,shouldBeVisible:r[e].ShouldBeVisible,icon:r[e].Icon,tooltip:r[e].Tooltip,children:[]};s.push(o)}}});else if(v){(function(e,t,i,r,n,a,s){const o=[],l=[];let u=new Array;t.Layout.Tabs.Tab&&(u=u.concat(t.Layout.Tabs.Tab));t.Layout.ContextualTabs.Tab&&(u=u.concat(t.Layout.ContextualTabs.Tab));u.forEach(t=>{t&&t.Groups&&t.Groups.Group&&t.Groups.Group.forEach(t=>{t.Controls.Items.forEach(t=>{const i=Object(d.a)(e,a,t.Id);i&&((t=Object.assign({},t)).Menu=i),l.push(t)})})});for(;l.length>0;){const e=h(l.pop(),i,t,r,n,a,s);e&&o.push(e)}return o})(e,P,r,w,t,i,p).forEach(e=>{s.push(e)})}else for(const e in r)if(r[e].CanExecute){const o=r[e].Priority;if(!y||null!=o){const o=Object(a.a)(P,w,r[e].CommandType,r[e].CommandId,r[e].ControlId,t,i,p),l={commandId:r[e].CommandId,commandButtonId:e,execute:o,label:Object(n.b)(r[e].LabelText),canExecute:r[e].CanExecute,shouldBeVisible:r[e].ShouldBeVisible,icon:r[e].Icon,tooltip:r[e].Tooltip,children:[]};s.push(l)}}return y&&function(e,t){const i=[e];for(;i.length>0;){const e=i.pop();e.sort(t),e.forEach(e=>{e.children&&e.children.length>0&&i.push(e.children)})}}(s,(e,t)=>{const i=r[e.commandButtonId].Priority,n=r[t.commandButtonId].Priority;return i<n?-1:i>n?1:0}),s})}function h(e,t,i,s,o,l,u){let c=null;const d=e&&e.Id&&Object(r.i)(e.Id,null==s?void 0:s.ContextEntityLogicalName);if(e&&e.Id&&d&&t[d]){const r=Object(a.a)(i,s,t[d].CommandType,t[d].CommandId,t[d].ControlId,o,l,u);c={commandId:t[d].CommandId,commandButtonId:d,execute:r,label:Object(n.b)(t[d].LabelText),canExecute:t[d].CanExecute,shouldBeVisible:t[d].ShouldBeVisible,icon:t[d].Icon,tooltip:t[d].Tooltip,children:[],controlType:e.ControlType},"Menu"in e&&e.Menu&&e.Menu.MenuSection&&e.Menu.MenuSection.forEach(e=>{e.Item&&e.Item.Items&&e.Item.Items.forEach(e=>{const r=h(e,t,i,s,o,l,u);r&&c.children.push(r)})})}return c}},"7fV9":function(e,t,i){"use strict";i.d(t,"b",(function(){return ge})),i.d(t,"c",(function(){return fe})),i.d(t,"a",(function(){return be}));var r=i("SAYH"),n=i("WPtp"),a=i("VcAV"),s=i("nVTU");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class o{constructor(e,t,i,r=!1){this.getValue=this.getValue.bind(this),this.getFormattedValue=this.getFormattedValue.bind(this),this._record=e,this._columnAliasNameMap=t,this._setAttributesByAliasMap(),this._primaryFieldName=i,this._isDirty=r}getRecordId(){return r.a.toString(this._record.identifier.id)}getNamedReference(){if(this._entityReference)return this._entityReference;let e=this._record.identifier.name;e||(e=this.getFormattedValue(this._primaryFieldName));const t=this._record.fields.activitytypecode,i=t?t.value:this._record.identifier.etn;return this._entityReference=new s.a(i,this._record.identifier.id.guid,e),this._entityReference}_setAttributesByAliasMap(){const e={};let t;for(t in this._columnAliasNameMap)e[t]=this.getValue(t);Object.assign(this,e)}getValue(e){if(a.b(e))return null;a.b(this._columnAliasNameMap[e])||(e=this._columnAliasNameMap[e]);const t=this._record.fields[e];return a.c(t)?null:t.validationResult.isValueValid?Object(n.e)(t):t.validationResult.userInput}getFormattedValue(e){throw new Error("Not Linked")}setValue(e,t){throw new Error("Not Linked")}save(e){throw new Error("Not Linked")}isDirty(){return this._isDirty}isRecordValid(){for(const e in this._record.fields)if(!this.isValid(e))return!1;return!0}isEditable(e){throw new Error("Not Linked")}isSecured(e){throw new Error("Not Linked")}isReadable(e){throw new Error("Not Linked")}isValid(e){return!(this._record&&this._record.fields&&this._record.fields[e]&&this._record.fields[e].validationResult)||this._record.fields[e].validationResult.isValueValid}getValidationError(e){return this._record&&this._record.fields&&this._record.fields[e]&&this._record.fields[e].validationResult?this._record.fields[e].validationResult.errorMessage:null}getFieldRequiredLevel(e){throw new Error("Not Linked")}reformatValue(e){return""}getCurrencyDecimalPrecision(e){throw new Error("Not Linked")}}var l=i("JwRZ");class u{constructor(){this.getConvertedFilter=this.getConvertedFilter.bind(this),this.getFilter=this.getFilter.bind(this),this.setFilter=this.setFilter.bind(this),this.clearFilter=this.clearFilter.bind(this)}retrieveDataSetFiltering(){return{getFilter:this.getFilter.bind(this),setFilter:this.setFilter.bind(this),clearFilter:this.clearFilter.bind(this),aliasMap:Object.freeze(Object.assign({},this._columnAliasMapWithColumns)),canDisableRelationshipFilter:()=>!1}}setColumnAliasMapWithColumns(e){this._columnAliasMapWithColumns=e}extendColumnAliasMapWithColumns(e){this._columnAliasMapWithColumns&&e?Object.keys(e).forEach(t=>{t in this._columnAliasMapWithColumns||(this._columnAliasMapWithColumns[t]=e[t])}):this._columnAliasMapWithColumns=e}getRootFilterExpression(){return this._rootFilterExpression}calculateFilterExpression(){this._rootFilterExpression=Object(l.n)(this._existedFilterExpression,this._columnAliasMapWithColumns)}convertFilter(e){if(!e)return null;if(!this._columnAliasMapWithColumns||!Object.keys(this._columnAliasMapWithColumns).length)return e;const t=[],i=[];for(const i in e.conditions){const r=this._columnAliasMapWithColumns[e.conditions[i].attributeName]||e.conditions[i].attributeName;t.push(Object.assign(Object.assign({},e.conditions[i]),{attributeName:r}))}const r={conditions:t,filterOperator:e.filterOperator};for(const t in e.filters)i.push(this.convertFilter(e.filters[t]));return i.length&&(r.filters=i),r}getConvertedFilter(){return this._convertedFilterExpression}getFilter(){return this._existedFilterExpression}setFilter(e){this._convertedFilterExpression=this.convertFilter(e),this._existedFilterExpression=e}clearFilter(){this._existedFilterExpression=null,this._convertedFilterExpression=null,this._rootFilterExpression=null}getClientApiFilterTimeStamp(){return this._clientApiFilterTimeStamp}setClientApiFilterTimeStamp(e){this._clientApiFilterTimeStamp=e}}var c=i("YPtO");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e=1,t=1,i=!1,r=!1,n=0,a=25){this._currentPageFirstIndex=1,this._currentPageLastIndex=1,this._hasNextPage=!1,this._hasPreviousPage=!1,this._pageSize=25,this._totalResultCount=0,this._pagingSizeSettingSource=0,this._lastPageSizeFromView=-200,this._lastPageSizeFromParentPagingInput=-200,this.reset=this.reset.bind(this),this._currentPageFirstIndex=e,this._currentPageLastIndex=t,this._hasNextPage=i,this._hasPreviousPage=r,this._totalResultCount=n,this._pageSize=a}retrieveDataSetPaging(){const e=this._currentPageFirstIndex===this._currentPageLastIndex?this._currentPageFirstIndex:-100;return{totalResultCount:this._totalResultCount,firstPageNumber:e,lastPageNumber:e,pageSize:this._pageSize,setPageSize:this.setPageSize.bind(this,1),hasNextPage:this._hasNextPage,hasPreviousPage:this._hasPreviousPage,loadNextPage:null,loadPreviousPage:null,reset:null,loadExactPage:null}}reset(){this._currentPageFirstIndex=1,this._currentPageLastIndex=1}getPageFirstIndex(){return this._currentPageFirstIndex}getPageLastIndex(){return this._currentPageLastIndex}getHasNextPage(){return this._hasNextPage}getHasPreviousPage(){return this._hasPreviousPage}getPageSize(){return this._pageSize}setPageFirstIndex(e){this._currentPageFirstIndex=e}setPageLastIndex(e){this._currentPageLastIndex=e}setHasNextPage(e){this._hasNextPage=e}setHasPreviousPage(e){this._hasPreviousPage=e}setPageSize(e,t){switch(this._pageSize=t,this._pagingSizeSettingSource=e,e){case 1:break;case 2:this._lastPageSizeFromParentPagingInput=t;break;case 3:this._lastPageSizeFromView=t}}setTotalResultCount(e){this._totalResultCount=e}getLastPageSizeFromParentPagingInput(){return this._lastPageSizeFromParentPagingInput}getLastPageSizeFromView(){return this._lastPageSizeFromView}getPagingSizeSettingSource(){return this._pagingSizeSettingSource}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(){this._previousSortingArray=[],this._currentSortingArray=[],this.retrieveDataSetSorting=this.retrieveDataSetSorting.bind(this),this.getCurrentSortingArray=this.getCurrentSortingArray.bind(this),this.setColumnAliasMap=this.setColumnAliasMap.bind(this),this.extendColumnAliasMap=this.extendColumnAliasMap.bind(this)}retrieveDataSetSorting(){return this._currentSortingArray}getCurrentSortingArray(){return this._currentSortingArray}setColumnAliasMap(e){this._columnAliasMap=e}extendColumnAliasMap(e){this._columnAliasMap&&e?Object.keys(e).forEach(t=>{t in this._columnAliasMap||(this._columnAliasMap[t]=e[t])}):this._columnAliasMap=e}getValidSortingArray(){return this._previousSortingArray}updateSortingArrays(){let e=!1;e=Object(l.e)(this._currentSortingArray,this._previousSortingArray),e&&(this._previousSortingArray=Object(l.t)(this._currentSortingArray,this._columnAliasMap))}}var h=i("IqkD"),m=i("VnpK"),g=i("455M"),f=i("5Oca"),b=i("vNXc"),y=i("eXjw"),v=i("4DTG"),O=i("d0w6"),_=i("Uv1Y"),P=i("bT7G"),S=i("LbMF"),w=i("lEp6"),I=i("aFKs"),j=i("sozv"),C=i("i1f0"),D=i("+aBC"),E=i("arV0"),T=i("P6DH"),F=i("00VO"),N=i("fILV"),R=i("iZ7K"),A=i("odYE"),k=i("jRy5"),L=i("dHD5"),M=i("NjDY"),x=i("Z/4N"),V=i("5ZBI"),B=i("Xd5/"),U=i("YxC/"),z=i("504W"),W=i("uNu9"),q=i("j6Db"),G=i("R5Qn"),H=i("Lyxw"),K=i("3/02"),Q=i("YGjz"),Y=i("CB5L"),X=i("69Qu"),Z=i("2ciq"),$=i("4leG"),J=i("S2mk"),ee=i("s/8p"),te=i("x8sc");function ie(e,t,i){const r=Object(te.a)(t,["/","*"])+"([\\S\\s]*)"+Object(te.a)(i,["/","*"]),n=new RegExp(r,"i"),a=e.match(n);return a&&a.length>0?a[1]:null}function re(e,t){if(!e||!t)return null;const i=e.replace(/\sorder\s+by\s[\s\S]*$/i,"").match(/(select(?:[\s\S]*?))(?:where\s+([\s\S]*))?$/i);if(!i)return null;const r=i[1];if(!r)return null;const n=i[2],a=function(e){return/^\s*with\s/i.test(e)?function(e){const t=new RegExp(/(with[\s\S]*__QuickFindInternal__\]\))/i.source+"[\\s\\S]*"+/\swhere\s([\s\S]+\[__QuickFind__\]\))/i.source+"(?:[\\s\\S]*?)"+/(\s+order\s+by\s+(?:[\s\S]*?))?$/i.source,"i"),i=e.match(t);if(!i)return null;const r=i[1];if(!r)return null;const n=i[2];if(!n)return null;const a=i[3];return{with:r,in:n,orderBy:a}}(e):function(e){const t=/(\sorder\s+by\s+(?:[\s\S]*?))?$/i,i=e.match(t)[1];i&&(e=e.substring(0,e.indexOf(i)));const r=/^\s*select\s(?:[\s\S]*?)\sfrom\s(?:[\s\S]*?)where\s([\s\S]+)$/i,n=e.match(r)[1];if(!n)return null;return{in:n,orderBy:i}}(e)}(t),s=n?`(${n}) and (${a.in})`:a.in;return`${a.with||""} ${r} where ${s} ${a.orderBy||""}`}var ne=i("37s6"),ae=i("jAuy"),se=i("jq7Z"),oe=i("/Zy9"),le=i("RREX"),ue=i("8nT0"),ce=i("TFb5"),de=i("eruq"),pe=i("fYtF"),he=i("z+5+");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const me="MscrmControls.FieldControls.SimpleLookupControl",ge="dataset",fe="dataset_recordid_";class be{constructor(e,t=null,i){this._rerunMapStateToPropsTaskId=-1,this._shouldApplyContextFilter=!1,this.dataSetClass=0,this._viewBasedLinkedEntitiesKeys=[],this.previousDataSetParameter=null,this.previousEmptyParameter=null,this._previousDataSetRecords=null,this.previousRecords=null,this.previousSubParametersDefinition={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousSubParametersInput={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousAppliedSubParametersInput={sortingInput:null,filteringInput:null,extraFilters:null,pagingInput:null,refreshInput:null,linkingInput:null},this.previousOwnProps=null,this.linkedEntityParsed=!1,this.memoizedCurrentViewId=null,this.dataRequestedOnce=!1,this.dataFirstTimeSentAcknowledged=!1,this.forceApplyDataSetInputReturnNone=!1,this.firstDataRequestType=0,this.dataRequestedByControlInitialization=!0,this.previousInitState=y.a.Uninitialized,this._previousQueryKey=null,this._memoizedAdditionalColumnsInfo=null,this._memoizedViewColumnsInfo=null,this._memoizedAllColumnsInfo=null,this._additionalColumns=[],this._dataProvider=null,this._previousDataProviderReturn=null,this._selectedRecordIds=[],this._snapShotIdMap={},this.refreshingStatus=0,this._updatedDataSetPropertiesForLegacy={},this._updatedDataSetProperties={},this._queryBuilderForPaging=null,this.columnsForEmptyDataset=null,this._initialDataSetFetchEnabled=!0,this.entityLogicalNameFromView="",this._dataProviderRetrieveAction=0,this.extraFilters=[],this.lookupCustomFilters=[],this.viewIdDocumentDic={},this.isColumnFirstMetadataReady=!1,this._initialPageNumber=-1,this._relatedFilterEnabled=!0,this.meFilterEnabled=!1,this.gridRunOnLoad=this.gridRunOnLoad.bind(this),this.loadNextPage=this.loadNextPage.bind(this),this.loadExactPage=this.loadExactPage.bind(this),this.loadPreviousPage=this.loadPreviousPage.bind(this),this.resetPaging=this.resetPaging.bind(this),this.loadSpecificPage=this.loadSpecificPage.bind(this),this.addColumn=this.addColumn.bind(this),this.propKey=e,this.filteringObj=new u,this.linkedEntitiesObj=new c.a,this.pagingObj=new d,this.sortingObj=new p,this.previousDataSetDefinition=t,this._fieldDataSelector=Object(j.a)(),this.contextToken=i,this._additionalColumns=[]}getPreviousQueryKey(){return this._previousQueryKey}getLatestData(){return this.previousDataSetParameter}getUpdateFlag(){return this._needToRunLoad}getPropKey(){return this.propKey}setLookupDataSetAttributes(e,t){this._shouldApplyContextFilter=e,this._parentRecordContext=t}setRelatedFilter(e){this._relatedFilterEnabled=e}setSelectedRecordIds(e){this._selectedRecordIds=e,this.previousDataSetDefinition.onRecordsSelected&&this.previousDataSetDefinition.onRecordsSelected(this._selectedRecordIds)}getSelectedRecordIds(){const e=[];if(this._previousDataSetRecords)for(const t in this._selectedRecordIds)this._previousDataSetRecords[this._selectedRecordIds[t]]&&e.push(this._selectedRecordIds[t]);return e.length!==this._selectedRecordIds.length&&(this._selectedRecordIds=e),this._selectedRecordIds}clearSelectedRecordIds(){return this.setSelectedRecordIds([])}getParameterManifestType(){return g.a.Grid}getCurrentSnapshotIdMap(){return this._snapShotIdMap}clearCurrentSnapshotIdMap(){this._snapShotIdMap={}}isParameterOfDataSetType(e){return!!e&&e.Type===this.getParameterManifestType()}getRelationshipNameFromParameter(e){return e?e.RelationshipName:null}getLegacyUpdatedPropertiesDic(){return this._updatedDataSetPropertiesForLegacy}clearLegacyUpdatedPropertiesDic(){this._updatedDataSetPropertiesForLegacy={}}setLegacyUpdatedPropertiesDic(e,t){Object.assign(this._updatedDataSetPropertiesForLegacy,{[e]:!0})}getUpdatedPropertiesDic(){return this._updatedDataSetProperties}clearUpdatedPropertiesDic(){this._updatedDataSetProperties={}}setUpdatedPropertiesDic(e,t){Object.assign(this._updatedDataSetProperties,{[e]:!0})}getBoundEntityRecordId(e,t){if(t&&t.formInfo&&t.formInfo.RecordId)return new r.a(t.formInfo.RecordId);const i=Object(se.a)(e,t.id);let n=null;return i&&(n=i.input,n)?n.id:null}getBoundEntityName(e,t){if(t&&t.formInfo&&t.formInfo.EntityName)return t.formInfo.EntityName;const i=Object(se.a)(e,t.id);let r=null;return i&&(r=i.input,r)?r.entityTypeName:null}savePreviousOwnProps(e){this.previousOwnProps=e}retrievePropertyParameter(e,t,i,r,n,a){const s=Object.assign(Object.assign({},i),{Parameters:{[a]:n}});return this._fieldDataSelector(a,e,t,s,r,this.contextToken)}getPropertyParameterValue(e){return e&&e.raw}updatePreviousDataSetParameterDefinition(e,t){Object(l.y)(this.previousDataSetDefinition,e)&&(this._isColumnsetChanged=!0),this.previousDataSetDefinition=e,this._dataProvider=e.DataProvider?e.DataProvider:null,this._dataProvider&&0!==this._dataProviderRetrieveAction&&(this._dataProviderRetrieveAction=1),e.FirstDataRequestType?this.firstDataRequestType=e.FirstDataRequestType:a.c(t)||(this._initialDataSetFetchEnabled=this._isInitialDataSetFetchEnabled(t),this._initialDataSetFetchEnabled||(this.firstDataRequestType=1)),this.previousDataSetDefinition.LinkingInput?this.previousSubParametersDefinition.linkingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.LinkingInput),{Usage:1}):this.previousSubParametersDefinition.linkingInput=null,this.previousDataSetDefinition.SortingInput?this.previousSubParametersDefinition.sortingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.SortingInput),{Usage:1}):this.previousSubParametersDefinition.sortingInput=null,this.previousDataSetDefinition.FilteringInput?this.previousSubParametersDefinition.filteringInput=Object.assign(Object.assign({},this.previousDataSetDefinition.FilteringInput),{Usage:1}):this.previousSubParametersDefinition.filteringInput=null,this.previousDataSetDefinition.ExtraFilters?this.previousSubParametersDefinition.extraFilters=this.previousDataSetDefinition.ExtraFilters.slice(0):this.previousSubParametersDefinition.extraFilters=null,this.previousDataSetDefinition.PagingInput?this.previousSubParametersDefinition.pagingInput=Object.assign(Object.assign({},this.previousDataSetDefinition.PagingInput),{Usage:1}):this.previousSubParametersDefinition.pagingInput=null,this.previousDataSetDefinition.RefreshInput?this.previousSubParametersDefinition.refreshInput=Object.assign(Object.assign({},this.previousDataSetDefinition.RefreshInput),{Usage:1}):this.previousSubParametersDefinition.refreshInput=null}getSubParameterValues(e,t,i,r){let n=!1,s=null,o=null,l=null,u=null,c=null,d=null;if(this.previousSubParametersDefinition.linkingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.linkingInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.linkingInput,"linking"),o=this.getPropertyParameterValue(s);a!==o&&Object(w.a)(o)?(d=s,n=!0):d=this.previousSubParametersInput.linkingInput}if(this.previousSubParametersDefinition.sortingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.sortingInput),o=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.sortingInput,"sorting"),l=this.getPropertyParameterValue(o),u=Object(w.a)(l);a!==l&&u?(s=o,Object(m.b)(this.sortingObj.getValidSortingArray(),u)?(this.previousSubParametersInput.sortingInput=o,this.previousAppliedSubParametersInput.sortingInput=o):n=!0):s=this.previousSubParametersInput.sortingInput}if(this.previousSubParametersDefinition.filteringInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.filteringInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.filteringInput,"filtering"),l=this.getPropertyParameterValue(s),u=Object(w.a)(l);if(a!==l&&(""===l&&a||u))o=s,Object(m.a)(this.filteringObj.getFilter(),u)?(this.previousSubParametersInput.filteringInput=s,this.previousAppliedSubParametersInput.filteringInput=s):n=!0;else{const i=Object(T.t)(e,t.id,this.contextToken);a===l&&i&&i.source&&1===i.source&&i.timeStamp&&i.timeStamp!==this.filteringObj.getClientApiFilterTimeStamp()?(this.filteringObj.setClientApiFilterTimeStamp(i.timeStamp),o=Object.assign({},s),n=!0):o=this.previousSubParametersInput.filteringInput}}else if(!this.previousDataSetDefinition.FilteringInput){if(this.getPropertyParameterValue(this.previousSubParametersInput.filteringInput)){const a={Static:!0,Value:"",Usage:1};o=this.retrievePropertyParameter(e,t,i,r,a,"filtering"),n=!0}}if(this.previousSubParametersDefinition.extraFilters&&-1===t.controlId.indexOf("header_process")){const e=this.previousSubParametersInput.extraFilters&&this.previousSubParametersInput.extraFilters.length?this.previousSubParametersInput.extraFilters.join():"",t=this.previousSubParametersDefinition.extraFilters;e!==(t&&t.length?t.join():"")?(l=t,n=!0):l=this.previousSubParametersInput.extraFilters}if(this.previousSubParametersDefinition.pagingInput){const a=this.getPropertyParameterValue(this.previousSubParametersInput.pagingInput),s=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.pagingInput,"paging"),o=this.getPropertyParameterValue(s),l=!(!Object(w.a)(o)||!Object(w.a)(a)||Object(w.a)(o).PageRefreshInput===Object(w.a)(a).PageRefreshInput);if(a!==o&&Object(w.a)(o)||l){let e=!1;const t=Object(w.a)(o),i=Object(w.a)(a);if(t&&t.firstPageNumber===this.pagingObj.getPageFirstIndex()&&t.lastPageNumber===this.pagingObj.getPageLastIndex()&&t.pageSize===this.pagingObj.getPageSize()&&!l)n=!1,this.previousSubParametersInput.pagingInput=s,this.previousAppliedSubParametersInput.pagingInput=s,u=s;else if(t){const r=i&&i.pagingRefreshInput?i.pagingRefreshInput:"undefinedPagingRefreshInput";(this.isPagingSizeUpdated(t)||Object(m.y)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||this.pagingObj.getHasNextPage()&&Object(m.w)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||this.pagingObj.getHasPreviousPage()&&Object(m.x)(this.pagingObj.getPageFirstIndex(),t.firstPageNumber,this.pagingObj.getPageLastIndex(),t.lastPageNumber)||Object(m.v)(t.firstPageNumber,t.lastPageNumber,r,t.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex()))&&(!this.dataRequestedOnce&&Object(m.v)(t.firstPageNumber,t.lastPageNumber,r,t.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex())&&(this._initialPageNumber=t.firstPageNumber),e=!0),e?(u=s,n=!0):(a||(this.previousSubParametersInput.pagingInput={type:null,raw:this.previousSubParametersDefinition.pagingInput.Value,error:!1,errorMessage:null,security:null}),u=this.previousSubParametersInput.pagingInput)}}else u=this.previousSubParametersInput.pagingInput}if(this.previousSubParametersDefinition.refreshInput){const s=this.getPropertyParameterValue(this.previousSubParametersInput.refreshInput),o=this.retrievePropertyParameter(e,t,i,r,this.previousSubParametersDefinition.refreshInput,"refresh"),l=this.getPropertyParameterValue(o);s===l||a.c(l)?c=this.previousSubParametersInput.refreshInput:(c=o,n=!0)}return n?{sortingInput:s,filteringInput:o,extraFilters:l,pagingInput:u,refreshInput:c,linkingInput:d}:this.previousSubParametersInput}applySortingInput(e){const t=this.getPropertyParameterValue(e),i=Object(w.a)(t);if(i){const e=this.sortingObj.getCurrentSortingArray();e.splice(0),e.push(...i)}}applyLinkingInput(e){if(this.linkedEntitiesObj.length>0&&(this.linkedEntitiesObj.clear(),this._viewBasedLinkedEntitiesKeys.length>0&&(this.linkedEntityParsed=!1)),e){const t=this.getPropertyParameterValue(e),i=Object(w.a)(t);i&&i.forEach(e=>{this.linkedEntitiesObj.addLinkedEntity(e)})}}applyFilteringInput(e){const t=this.getPropertyParameterValue(e),i=""===t?t:Object(w.a)(t);i&&""!==i?this.filteringObj.setFilter(i):this.filteringObj.clearFilter()}applyExtraFiltersInput(e){this.extraFilters=e&&e.length?e.map(e=>{const t=Object(w.a)(e);return Object(l.n)(t,null)}).filter(e=>!a.c(e)):[]}isPagingSizeUpdated(e){const t=this.pagingObj.getLastPageSizeFromParentPagingInput();return e.pageSize&&e.pageSize!==this.pagingObj.getPageSize()&&(-200===t||t!==e.pageSize)}updatePagingSizeFromViewIfNeeded(e,t){if(-200!==this.pagingObj.getLastPageSizeFromView()||1===this.pagingObj.getPagingSizeSettingSource()||4===this.pagingObj.getPagingSizeSettingSource()||2===this.pagingObj.getPagingSizeSettingSource()&&this.pagingObj.getLastPageSizeFromParentPagingInput()!==t)return;const i=Object(l.B)(e,this.viewIdDocumentDic),r=i?i.getElementsByTagName("fetch"):null;if(!r||0===r.length)return;const n=r[0].getAttribute("count");let a=-200;n&&""!==n&&("string"==typeof n?a=parseInt(n,10):"number"==typeof n&&(a=n)),-200!==a&&this.pagingObj.setPageSize(3,a)}applyPagingInput(e,t){const i=this.getPropertyParameterValue(e),r=Object(w.a)(i)||{firstPageNumber:null,lastPageNumber:null,pageSize:null},n=this.getPropertyParameterValue(t),a=Object(w.a)(n)||{firstPageNumber:null,lastPageNumber:null,pageSize:null};this.isPagingSizeUpdated(a)?(this.pagingObj.reset(),this.pagingObj.setPageSize(2,a.pageSize),this._initialPageNumber>=1&&(this.pagingObj.setPageFirstIndex(this._initialPageNumber),this.pagingObj.setPageLastIndex(this._initialPageNumber))):(Object(m.y)(this.pagingObj.getPageFirstIndex(),a.firstPageNumber,this.pagingObj.getPageLastIndex(),a.lastPageNumber)||a.firstPageNumber===a.lastPageNumber&&r.pagingRefreshInput!==a.pagingRefreshInput)&&(this.pagingObj.setPageFirstIndex(a.firstPageNumber),this.pagingObj.setPageLastIndex(a.lastPageNumber)),this.previousDataSetParameter&&(this.previousDataSetParameter.paging=this.pagingObj.retrieveDataSetPaging())}updateEntityOwnColumnNames(e,t,i){let r=null;t.TargetEntityType?r=t.TargetEntityType:t.EntityName&&(r=t.EntityName),this._entityOwnColumnNames=this._getOwnEntityColumnNames(i.map(e=>e.name),Object(S.d)(e,r))}retrieveDataSetObjectFromStorage(e,t,i,n){const a=i.Parameters[this.propKey],s=this.updatedSubParameter(n),o=this.getCurrentViewId(a)||(this.shouldUseLookupService(e)&&this.lookupViewId?new r.a(this.lookupViewId):null),u=r.a.toString(o);let c=Object(T.qb)(e,o,t.id);if(!c&&this.shouldUseLookupService(e)){if(!this.lookupView||o&&!r.a.equals(this.lookupView.viewId,o))return this.generateEmptyDataSetParam(c?c.title:"")}else if(null===c||c.initialized!==y.a.Initialized||!Object(T.E)(e,c)||!Object(R.h)(e,c.entityLogicalName)||!this.getIsColumnFirstMetadataReady())return this.generateEmptyDataSetParam(c?c.title:"");!c&&this.shouldUseLookupService(e)&&this.lookupView&&(c=this.parseLookupViewDescriptorToViewDescriptor(this.lookupView));const d=this.getListRecordData(e,t,i);if(null===d)return 1===this.refreshingStatus||2===this.refreshingStatus?this.previousDataSetParameter:this.generateEmptyDataSetParam(c?c.title:"");if(!this.previousDataSetParameter||d!==this.previousDataSetParameter.records||3===this.refreshingStatus||4===this.refreshingStatus){const t=!1,i=null,n=null,s=this.shouldUseLookupService(e)&&this.lookupView&&r.a.equals(this.lookupView.viewId,c.viewId)?this.parseLookupColumnsToDataSetColumns(this.lookupView.columns):Object(l.m)(e,a,l.q,c,this.viewIdDocumentDic);this.addExtraColumns(s,e,c?c.entityLogicalName:null),this.addColumnsFromDataSetParameterForMetadataRetrieval(e,a,c);const o=this.previousInitState!==y.a.Initialized||3===this.refreshingStatus;this.setFilteringObjColumnAliasMap(s),this.setSortingObjColumnAliasMap(s),this.previousDataSetParameter=this.generateNewDatasetParam(o,s,t,n,i,d,u,c.title),a.Type===g.a.Grid&&this.updateEntityOwnColumnNames(e,a,s),3!==this.refreshingStatus&&4!==this.refreshingStatus||(this.setLegacyUpdatedPropertiesDic(ge,!0),4===this.refreshingStatus&&(this.refreshingStatus=0))}return s&&(this.previousDataSetParameter=Object.assign({},this.previousDataSetParameter)),this.previousDataSetParameter}updatedSubParameter(e){return this.previousSubParametersInput!==e&&(this.previousSubParametersInput=e,this.dataFirstTimeSentAcknowledged?this.forceApplyDataSetInputReturnNone=!1:this.forceApplyDataSetInputReturnNone=!0,!0)}addColumnsFromDataSetParameterForMetadataRetrieval(e,t,i){if(i&&i.initialized===y.a.Initialized&&t.Columns&&t.Columns.length>0){const r=Object(T.E)(e,i);t.Columns.forEach((e,t)=>{const i=r[e.Name];a.c(i)&&this.addColumn(e.Name)})}}addExtraColumns(e,t,i){this._additionalColumns&&this._additionalColumns.length>0&&this._additionalColumns.forEach(({name:i,alias:r},n)=>{if(a.c(r)){const r=e.filter(e=>e.name===i);if(!r||0===r.length){const r=this._createDataSetColumn(t,i);a.c(r)||e.push(r)}}else{const n=this.linkedEntitiesObj.getLinkedEntities();if(n&&n.length>0){let s=null;for(const e of n)if(e.alias===r){s=e.name;break}const o=this._createDataSetColumn(t,i,s,r);a.c(o)||e.push(o)}}}),this._addMandatoryColumns(e,t,i)}_getMandatoryColumnNames(e,t){if(this._dataProvider||!t)return[];const i=Object(R.h)(e,t),r=i&&i.PrimaryNameAttribute;return r?[r]:[]}_addMandatoryColumns(e,t,i){if(this._dataProvider||!i)return;const r=Object(R.h)(t,i),n=r&&r.PrimaryNameAttribute,a=!!n&&e&&e.findIndex(e=>e.name===n)>-1;n&&!a&&e.push({name:n,isHidden:!0,isPrimary:!0,displayName:"",order:0,dataType:"",alias:n,visualSizeFactor:1})}_createDataSetColumn(e,t,i,r){let n=null;const s=a.c(i)?this.getEntityTypeName():i,o=Object(S.d)(e,s);if(!a.c(o)){const e=o[t];if(!a.c(e)){let t=null;a.c(e.Type)||a.c(e.Format)||(t=Object(I.a)(e.Type,e.Format));const i={Alias:a.c(r)?e.LogicalName:`${r}.${e.LogicalName}`,DisplayName:e.DisplayName,DataType:t,Name:a.c(r)?e.LogicalName:`${r}.${e.LogicalName}`,Type:t,Format:e.Format};n=Object(l.q)(i,-1,-1,null,!1)}}return n}retrieveDataSetObjectFromDataProvider(e,t,i,n){const a=i.Parameters[this.propKey],s=this.updatedSubParameter(n),o=this.getCurrentViewId(a);let u,c;const d="function"==typeof this._dataProvider.getTitle?this._dataProvider.getTitle():"";if(o&&(u=r.a.toString(o),c=Object(T.qb)(e,o,t.id),null===c||c.initialized!==y.a.Initialized||!this.getIsColumnFirstMetadataReady()))return this.generateEmptyDataSetParam(c?c.title:d);const p=Object(D.b)(e,t.id,t.controlId,this.propKey);if(null===p)return this.generateEmptyDataSetParam(c?c.title:d);if(!this.previousDataSetParameter||p!==this._previousDataProviderReturn){this.error=!1;const t=this.error;this.errorMessage="";const i=this.errorMessage,r=this.innerError,n=!1;let s=this._dataProvider.getColumns();c?(s=Object(l.m)(e,a,l.q,c,this.viewIdDocumentDic),this.setFilteringObjColumnAliasMap(s),this.setSortingObjColumnAliasMap(s)):(this.setFilteringObjColumnAliasMap(null),this.setSortingObjColumnAliasMap(null)),this._previousDataProviderReturn=p;const o={};for(const e of p)o[e.getRecordId()]=e;this.setLegacyUpdatedPropertiesDic(ge,!0),this.setUpdatedPropertiesDic(ge,!0),this._postDataSetParameterProcessForDataProvider(),this.previousDataSetParameter=this.generateNewDatasetParam(n,s,t,i,r,o,u,c?c.title:d),this.triggerOnDataSetUpdateCallBack(!1,"","")}return s&&(this.previousDataSetParameter=Object.assign({},this.previousDataSetParameter)),this.previousDataSetParameter}_postDataSetParameterProcessForDataProvider(){if(this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()){const e=this._dataProvider.getPaging();e.hasOwnProperty("hasNextPage")&&this.pagingObj.setHasNextPage(e.hasNextPage),e.hasOwnProperty("hasPreviousPage")&&this.pagingObj.setHasPreviousPage(e.hasPreviousPage),e.hasOwnProperty("pageSize")&&this.pagingObj.setPageSize(4,e.pageSize),e.hasOwnProperty("totalResultCount")&&this.pagingObj.setTotalResultCount(e.totalResultCount)}this._dataProviderRetrieveAction=this._dataProvider?1:0}retrieveDataSetObject(e,t,i,n){this.savePreviousOwnProps(t),this.isOnlineStatus=Object(X.b)(e);const s=i.Parameters[this.propKey];if(this.isParameterOfDataSetType(s)){this.updatePreviousDataSetParameterDefinition(s,e);const o=this.getSubParameterValues(e,t,i,n);if(this.previousSubParametersInput.sortingInput!==o.sortingInput&&this.applySortingInput(o.sortingInput),this.previousSubParametersInput.linkingInput!==o.linkingInput&&this.applyLinkingInput(o.linkingInput),this.previousSubParametersInput.filteringInput!==o.filteringInput&&this.applyFilteringInput(o.filteringInput),this.previousSubParametersInput.extraFilters!==o.extraFilters&&this.applyExtraFiltersInput(o.extraFilters),this.previousSubParametersInput.pagingInput!==o.pagingInput&&this.applyPagingInput(this.previousSubParametersInput.pagingInput,o.pagingInput),this.previousSubParametersInput.refreshInput!==o.refreshInput&&(this.previousSubParametersInput.refreshInput=o.refreshInput),this.controlId=t.descriptor.parentFieldSectionItem?t.descriptor.parentFieldSectionItem:t.controlId,!this.lookupView&&this.shouldUseLookupService(e)){const r=Object(Z.b)(i,this.propKey);this.lookupMetadataKey=this.lookupMetadataKey||r?Object(G.f)(e,n.entityTypeName,r,t.id):null,this.lookupView=Object(G.a)(e,this.lookupMetadataKey,this.targetEntity||this.entityLogicalNameFromView),this.lookupView&&this.lookupView.viewId&&s.ViewId===this.lookupView.viewId.guid&&(this.lookupViewId=this.lookupView.viewId.guid,this.columnsForEmptyDataset=this.parseLookupColumnsToDataSetColumns(this.lookupView.columns))}if(a.c(this.columnsForEmptyDataset)){let i;const n=this.getCurrentViewId(s);this.shouldUseLookupService(e)&&this.lookupView&&(!n||r.a.equals(this.lookupView.viewId,n))||(n?(i=Object(T.qb)(e,n,t.id),!a.c(i)&&i.initialized===y.a.Initialized&&Object(T.E)(e,i)&&Object(R.h)(e,i.entityLogicalName)&&this.getIsColumnFirstMetadataReady()&&(this.columnsForEmptyDataset=Object(l.m)(e,s,l.q,i,this.viewIdDocumentDic),this.entityLogicalNameFromView=i.entityLogicalName,this._sortedColumnsOnView||(this._sortedColumnsOnView=Object(l.x)(e,i,this.viewIdDocumentDic),this.columnsForEmptyDataset&&this.columnsForEmptyDataset.length>0&&this._sortedColumnsOnView&&this._sortedColumnsOnView.length>0&&0===this.sortingObj.getCurrentSortingArray().length&&this.sortingObj.getCurrentSortingArray().push(...this._sortedColumnsOnView)),this.updatePagingSizeFromViewIfNeeded(i,Object(h.h)(e)))):this._dataProvider&&(this.columnsForEmptyDataset=this._dataProvider.getColumns()))}let u;return a.c(n)||(this.pageEtn=n.entityTypeName),u=this._dataProvider?this.retrieveDataSetObjectFromDataProvider(e,t,i,o):this.retrieveDataSetObjectFromStorage(e,t,i,o),this.linkedEntityParsed||this._parselinkedEntitiesFromView(e,i),u}return null}getIsColumnFirstMetadataReady(){return this.shouldUseLookupService()||this.isColumnFirstMetadataReady||1===this.dataSetClass||3===this.dataSetClass||2===this.firstDataRequestType&&this.dataFirstTimeSentAcknowledged}_parselinkedEntitiesFromView(e,t){const i=t.Parameters[this.propKey],r=this.previousOwnProps?this.previousOwnProps.id:null,n=this.getCurrentViewId(i),a=Object(T.qb)(e,n,r);this._parselinkedEntitiesFromViewDescriptor(a)}_parselinkedEntitiesFromViewDescriptor(e){if(e){this.linkedEntityParsed=!0;const t=Object(l.B)(e,this.viewIdDocumentDic);if(t){const e=t.getElementsByTagName("link-entity");if(!e||0===e.length)return;for(let t=0;t<e.length;t++){const i=this._generateLinkedEntityExpression(e[t]);this.linkedEntitiesObj.addLinkedEntity(i);const r=this._getLinkedEntityExpressionKey(i);-1===this._viewBasedLinkedEntitiesKeys.indexOf(r)&&this._viewBasedLinkedEntitiesKeys.push(r)}}}}_generateLinkedEntityExpression(e){if(!e)return null;const t=e.attributes,i=t.getNamedItem("alias")?t.getNamedItem("alias").value:null;return{name:t.getNamedItem("name")?t.getNamedItem("name").value:null,from:t.getNamedItem("from")?t.getNamedItem("from").value:null,to:t.getNamedItem("to")?t.getNamedItem("to").value:null,linkType:t.getNamedItem("link-type")?t.getNamedItem("link-type").value:null,alias:i}}_getOwnEntityColumnNames(e,t){const i=[];if(t){const r=Object.keys(t);e.forEach(e=>{-1!==r.indexOf(e)&&i.push(e)})}return i}_getLinkedEntityExpressionKey(e){return`${e.name}: ${e.alias}: ${e.from}: ${e.to}: ${e.linkType}`}linkToParameter(e,t){const i=t.refreshDataSetParameter;for(const i in e.records)this.linkRecordAPI(e.records[i],t);e.refresh=()=>{i(this,this.contextToken)},e.setSelectedRecordIds=this.setSelectedRecordIds.bind(this),e.getSelectedRecordIds=this.getSelectedRecordIds.bind(this),e.clearSelectedRecordIds=this.clearSelectedRecordIds.bind(this),this.linkPagingAPI(e.paging,t),e.openDatasetItem=t.openDatasetItem;const r={},n=[];e.columns.forEach(e=>{r[e.name]=e,n.push(e.name)}),e.getCellImageInfo=this._getCellConditionalImage.bind(this,e.records,t.loadWebResource,r,n)}_getCellConditionalImage(e,t,i,r,n,a,s){const o=i[n];return this.getConditionalImage(t,r,e[a],o.imageProviderWebresource,o.imageProviderFunctionName,s)}getConditionalImage(e,t,i,r,n,a){if(i&&r&&n&&"$webresource:"!==r){const s={};s["RowId"]=i.getRecordId(),t.forEach(e=>{s[e]=i.getFormattedValue(e),s[e+"_Value"]=i.getValue(e)});return e(r,this.previousOwnProps.id).then(async e=>{const t=await e.container.execute(n,[JSON.stringify(s),a]);return{Url:Array.isArray(t)&&t.length>0?t[0]&&t[0].startsWith("blob:")?t[0]:Object(M.a)(e.webResourcePath,t[0]):null,Tooltip:Array.isArray(t)&&t.length>1?t[1]:null}})}return Promise.resolve(null)}linkRecordAPI(e,t){e.setValue=this._recordSetValueAPI.bind(this,e,t.updateFieldValue),e.save=this._recordSaveAPI.bind(this,e,t.saveEmbeddedEntity)}linkPagingAPI(e,t){const i=t.refreshDataSetParameter;e.loadNextPage=this.loadNextPage.bind(this,i),e.loadPreviousPage=this.loadPreviousPage.bind(this,i),e.reset=this.resetPaging.bind(this,i),e.loadExactPage=this.loadExactPage.bind(this,i)}_getClosestParentWithContext(e){return e.descriptor&&e.descriptor.HasContext?e.controlId:e.parentDefinedControlProps&&e.parentDefinedControlProps.closestParentWithContext}_recordSetValueAPI(e,t,i,r){if(this.previousOwnProps){const n=this._getClosestParentWithContext(this.previousOwnProps),a=this.previousOwnProps.id,s=e.getRecordId();t(a,{[i]:{fieldName:i,type:0,value:r}},!1,e.getNamedReference().entityName,s,n,this.contextToken)}}_recordSaveAPI(e,t,i){const r=this._getClosestParentWithContext(this.previousOwnProps),n=this.previousOwnProps.id,a=e.getRecordId(),s=e.getNamedReference().entityName,o=this.previousDataSetDefinition.ViewId;return t(n,s,a,r,this._entityOwnColumnNames,o,i&&i.suppressDuplicateDetection,this.contextToken)}applyDataSetInputs(e){let t=0;if(this.previousSubParametersInput.pagingInput!==this.previousAppliedSubParametersInput.pagingInput){if(!this.previousSubParametersInput.pagingInput)return this.previousAppliedSubParametersInput.pagingInput=this.previousSubParametersInput.pagingInput,this.pagingObj.reset(),this.forceApplyDataSetInputReturnNone?(this.forceApplyDataSetInputReturnNone=!1,0):1;const e=this.getPropertyParameterValue(this.previousSubParametersInput.pagingInput),i=Object(w.a)(e);if(i){this.isPagingSizeUpdated(i)&&(this.pagingObj.setPageSize(2,i.pageSize),this.pagingObj.reset(),t=1),Object(m.w)(this.pagingObj.getPageFirstIndex(),i.firstPageNumber,this.pagingObj.getPageLastIndex(),i.lastPageNumber)&&(this.pagingObj.setPageFirstIndex(i.firstPageNumber),t=2),Object(m.x)(this.pagingObj.getPageFirstIndex(),i.firstPageNumber,this.pagingObj.getPageLastIndex(),i.lastPageNumber)&&(this.pagingObj.setPageLastIndex(i.lastPageNumber),t=3);const e=this.getPropertyParameterValue(this.previousAppliedSubParametersInput.pagingInput),r=Object(w.a)(e),n=r&&r.pagingRefreshInput?r.pagingRefreshInput:"undefinedPagingRefreshInput";Object(m.v)(i.firstPageNumber,i.lastPageNumber,n,i.pagingRefreshInput,this.pagingObj.getPageFirstIndex(),this.pagingObj.getPageLastIndex())&&(this.pagingObj.setPageFirstIndex(i.firstPageNumber),this.pagingObj.setPageLastIndex(i.lastPageNumber),t=6),this.previousAppliedSubParametersInput.pagingInput=this.previousSubParametersInput.pagingInput}}return this.previousSubParametersInput.sortingInput!==this.previousAppliedSubParametersInput.sortingInput&&(this.previousAppliedSubParametersInput.sortingInput=this.previousSubParametersInput.sortingInput,t=1),this.previousSubParametersInput.filteringInput!==this.previousAppliedSubParametersInput.filteringInput&&(this.previousAppliedSubParametersInput.filteringInput=this.previousSubParametersInput.filteringInput,t=1),this.previousSubParametersInput.extraFilters!==this.previousAppliedSubParametersInput.extraFilters&&(this.previousAppliedSubParametersInput.extraFilters=this.previousSubParametersInput.extraFilters,t=1),this.previousSubParametersInput.refreshInput!==this.previousAppliedSubParametersInput.refreshInput&&(this.previousAppliedSubParametersInput.refreshInput=this.previousSubParametersInput.refreshInput,t=1),this.forceApplyDataSetInputReturnNone?(this.forceApplyDataSetInputReturnNone=!1,0):t}setRefreshingStart(){0===this.refreshingStatus&&a.c(this._dataProvider)&&(this.refreshingStatus=1)}getCurrentViewId(e){if(!e)return this.dataSetClass,null;let t=e.ViewId;if(!t||t===r.a.toString(r.a.EMPTY)){if(!e.BoundViewParams||!this._isValidBoundParameterConfiguration(e.BoundViewParams))return null;this._boundViewParams={ViewId:e.BoundViewParams.ViewId,ViewDisplayName:e.BoundViewParams.ViewDisplayName,FetchXml:e.BoundViewParams.FetchXml,LayoutXml:e.BoundViewParams.LayoutXml,TargetEntityType:e.BoundViewParams.TargetEntityType},t=e.BoundViewParams.ViewId}return this.memoizedCurrentViewId&&r.a.toString(this.memoizedCurrentViewId)===t||(this.memoizedCurrentViewId=new r.a(t)),this.memoizedCurrentViewId}retrieveCurrentView(e,t){const i=this.previousOwnProps?this.previousOwnProps.id:null,n=this.getCurrentViewId(this.previousDataSetDefinition),a=Object(T.qb)(e(),n,i);return a&&r.a.equals(a.viewId,n)&&a.initialized===y.a.Initialized?Promise.resolve(a):this.shouldUseLookupService(e())&&this.lookupView&&(r.a.equals(this.lookupView.viewId,n)||!n)?Promise.resolve(this.parseLookupViewDescriptorToViewDescriptor(this.lookupView)):n?this.retrieveView(n,t).then(()=>Object(T.qb)(e(),n,i)):this.retrieveView(n,t).then(t=>Object(T.qb)(e(),t,i))}_isValidBoundParameterConfiguration(e){if(Object(z.b)(e.TargetEntityType)||Object(z.b)(e.FetchXml)||Object(z.b)(e.LayoutXml)||!r.a.validate(e.ViewId)||Object(z.b)(e.ViewDisplayName)){const e=q.a+"Models.DataSet.DataSetObjectWrapper.addCustomView";return V.a.error(e+": addCustomView, view parameters are not valid",this._getTelemetryParams(e)),!1}return!0}addCurrentBoundView(e,t){const i=new r.a(this._boundViewParams.ViewId);t(null,null,new r.a(this._boundViewParams.ViewId),this._boundViewParams.TargetEntityType,null,this._boundViewParams.ViewDisplayName,this._boundViewParams.FetchXml,this._boundViewParams.LayoutXml);const n=this.previousOwnProps?this.previousOwnProps.id:null,a=Object(T.qb)(e(),i,n);return a&&r.a.equals(a.viewId,i)?Promise.resolve(a):Promise.reject(new _.a("Could not add current bound view to state"))}retrieveCurrentBoundView(e,t){const i=this.getCurrentViewId(this.previousDataSetDefinition);if(i){const n=this.previousOwnProps?this.previousOwnProps.id:null,a=Object(T.qb)(e(),i,n);return a&&r.a.equals(a.viewId,i)?Promise.resolve(a):this.addCurrentBoundView(e,t)}}retrieveCurrentViewAndAssoicatedAttributes(e,t){return this.retrieveCurrentView(e,t.retrieveViewAction).then(i=>{const r=new Array,n=e(),a=this.getColumnsThatRequireMetadataToBeLoaded(i,n);for(const e in a)Object(l.z)(n,e,a[e])||r.push(t.getEntityMetadataAction(e,a[e]));return Promise.all(r).then(()=>(this.isColumnFirstMetadataReady=!0,Promise.resolve(i)))})}_processSortingArrays(e,t,i){return 0===i.length||this._sortedColumnsOnView&&0!==this._sortedColumnsOnView.length&&Object(l.c)(i,this._sortedColumnsOnView)?[]:i}createQueryBuilder(e,t){var i,n;const s=this.previousOwnProps?this.previousOwnProps.id:null,o=Object(T.C)(e(),s,this.contextToken);!a.b(this.lookupFilterString)&&this._quickFindView||(this.lookupFilterString=null);const u=e();let c=!0,d=!1;const p=!!this.contextToken&&this.contextToken.contextTokenType===k.a.SubGrid;this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters.EnableViewPicker&&(d="true"===this.previousOwnProps.descriptor.Parameters.EnableViewPicker),Object(H.a)(u,K.Nd)&&p&&!d||Object(ae.l)(u)&&!this._isCustomGrid()||(c=t.queryType===O.a.QUICKFIND_SEARCH);const h=this.lookupFilterString||(o&&o.quickFind&&c?o.quickFind:null);let m=t.fetchXML;const g=t.offlineSqlQuery;let f,y=!1,v="",_=!1;const w=Object(l.p)(u,t.entityLogicalName);if(this.lookupFilterString&&this._quickFindView){const i=this._addQuickFindFilterToFetchXml(this._quickFindView,m);let r=g;if(g&&this._quickFindView.offlineSqlQuery&&(r=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i){if(!t||!i)return null;let r=null;if(!Object(H.c)(e,K.Id))return re(t,i);const n=ie(t,ee.h,ee.c);if(!n)return re(t,i);const a=ie(i,ee.b,ee.a),s=ie(i,ee.j,ee.i);let o=ie(t,ee.j,ee.i);o&&(o=o.toLowerCase().replace("where",""));const l=ie(i,ee.e,ee.d);return r=a?`${a} ${n} ${s}`:`${n} ${s}`,o&&(r+=` and (${o})`),l&&(r+=" "+l),r}(u,g,this._quickFindView.offlineSqlQuery),!r)){const e=q.a+".Models.DataSet.DataSetObjectWrapper.createQueryBuilder",t=e+" failed to merge offline Lookup queries:\n"+`viewQuery:\n${g}\nquickFindQuery:\n${this._quickFindView.offlineSqlQuery}`;V.a.error(t,this._getTelemetryParams(e))}f=b.a.fromXmlAndSql(i,r,this._quickFindView.viewId,h,t.entityLogicalName,e),this.previousOwnProps.configuration.CustomControlId===me&&f.setQuickFindSearch(h)}else{let i=!1;o&&o.quickFind&&this.propKey!==be._DATASET_LOOKUP_PROP_KEY&&(Object(ae.l)(u)&&!this._isCustomGrid()||Object(H.a)(u,K.Nd)&&p&&!d)&&(m=this._addQuickFindFilterToFetchXml(this._quickFindView,m),i=!0);const r="TeamTemplateId";if(t.entityLogicalName===Q.a&&this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters[r]){const e=this.previousOwnProps.descriptor.Parameters[r];if(m&&m.indexOf(e)<0){const t=this.getBoundEntityRecordId(u,this.previousOwnProps),i=t?t.guid:"",{updatedFetchXml:r,filterString:n}=Object(F.a)(m,e,i);m=r,v=n,y=!0}}_=this._isModernQueryBuilder(u,t.viewId,s,y,w,h),_?f=oe.a.fromView(t.viewId):(f=b.a.fromXmlAndSql(m,g,t.viewId,h,t.entityLogicalName,e),i&&f.setQuickFindSearch(null==o?void 0:o.quickFind)),this.lookupFilterString=null}if(y){const e=r.a.toString(this.getBoundEntityRecordId(u,this.previousOwnProps));f.addExistingContextFilterToKey(e,v)}const I=this._getAdditionalColumns(t,this.previousDataSetDefinition,u),j=this.sortingObj.getValidSortingArray();if(j&&j.length>0){this._processSortingArrays(u,t,j).forEach(e=>{f.orderBy(e.name,1===e.sortDirection)})}const D=this.getRelationshipNameFromParameter(this.previousDataSetDefinition);if(D&&this._relatedFilterEnabled){let e=this.getBoundEntityRecordId(u,this.previousOwnProps),t=this.getBoundEntityName(u,this.previousOwnProps),i=null,n=null;this.previousOwnProps&&this.previousOwnProps.descriptor&&this.previousOwnProps.descriptor.Parameters&&this.previousOwnProps.descriptor.Parameters.DependentAttributeName&&(n=this.previousOwnProps.descriptor.Parameters.DependentAttributeName,i=n.split(".")[1]?n.split(".")[1]:n);let a=Object(C.ac)(u,s,this.contextToken),o=new A.a(t,e);if(this.propKey===be._DATASET_LOOKUP_PROP_KEY){const s=this.previousDataSetDefinition;this._parentRecordContext&&(e=this._parentRecordContext.parentRecordId?new r.a(this._parentRecordContext.parentRecordId):r.a.EMPTY,a=this.getRecordSnapshotId(u,this.previousOwnProps,this._parentRecordContext.parentRecordEntityTypeName,e),this._parentRecordContext.parentRecordEntityTypeName&&(t=this._parentRecordContext.parentRecordEntityTypeName,o=new A.a(this._parentRecordContext.parentRecordEntityTypeName,e))),s.DependentAttributeName&&(n=s.DependentAttributeName,i=n.split(".")[1]?n.split(".")[1]:n)}const l=Object(S.a)(u,t,i);let c=null,d=!1;const p=this.previousDataSetDefinition.DependentAttributeType;l?c=Object(P.d)(u,a,o,i):p&&(d=p===t&&p!==this.entityLogicalNameFromView);const h=c;h&&h.reference?e=h.reference.id:this.propKey!==be._DATASET_LOOKUP_PROP_KEY&&null===i||null!==h&&null!==h.reference||!o||null===o.id||d||(e=null),Object($.d)(u)&&null===e&&(e=r.a.EMPTY);if(Object(T.kb)(u,s,this.contextToken)){let e=Y.h.Related;"Opportunity_ActivityPointers"===D&&(e=Y.h.None),f.applyRollupContextFilter(o,e)}else if(this._shouldApplyContextFilter&&this.propKey===be._DATASET_LOOKUP_PROP_KEY||this.propKey!==be._DATASET_LOOKUP_PROP_KEY){const t=Object(T.v)(u,s,this.contextToken);try{f.applyContextFilter(D,e,u,t?t.relationshipRoleOrdinal:void 0)}catch(e){const t=q.a+".Models.DataSet.DataSetObjectWrapper.createQueryBuilder";V.a.error(`${t}: relationship parameter was not found in the state tree metadata for relationshipName "${D}"`,this._getTelemetryParams(t))}}}w&&f.where(w),this._updateQueryBuilderFiltering(f,h);for(const e of this.linkedEntitiesObj.getLinkedEntities()){if((null===(n=null===(i=this.previousOwnProps)||void 0===i?void 0:i.configuration)||void 0===n?void 0:n.CustomControlId)===me&&f.validateLinkedEntity(u,e),!this._isLinkEntityNeeded(e))continue;const t=[];if(this._additionalColumns&&this._additionalColumns.length>0)for(const i of this._additionalColumns)i.alias===e.alias&&-1===t.indexOf(i.name)&&t.push(i.name);f.addLinkedEntity(e,t)}f.pageSize=this.pagingObj.getPageSize();const E=I.slice(0);if(E&&E.length>0)for(let e=0;e<E.length;e++)if(E[e]===T.c){const i=Object(T.o)(u,t.entityLogicalName);i&&!Object(ae.b)(t.fetchXML)&&f.addChildCountAttribute(i.primaryAttribute),E.splice(e,1)}if(f.select(...E),_){f.pageSize=this.pagingObj.getPageSize();return f.getQueryState(e)}return f}_addQuickFindFilterToFetchXml(e,t){const i=new DOMParser;if(e){const r=i.parseFromString(e.fetchXML,"text/xml"),n=i.parseFromString(t,"text/xml"),a=r.getElementsByTagName("filter");for(let e=0;e<a.length;e++)a[e].attributes&&a[e].attributes.getNamedItem("isquickfindfields")&&n.getElementsByTagName("entity")[0].appendChild(a[e]);return(new XMLSerializer).serializeToString(n)}return t}_updateQueryBuilderFiltering(e,t){if(this.filteringObj.getRootFilterExpression()||this.extraFilters.length>0||this.lookupCustomFilters.length>0){const i=(new DOMParser).parseFromString(e.fetchXml,"text/xml").getElementsByTagName("filter");let r=!1;for(let e=0;e<i.length;e++)r=r||!Object(J.j)(i[e].getAttribute("hint"));const n=this.filteringObj.getRootFilterExpression();if(this.extraFilters.length>0||this.lookupCustomFilters.length>0){const i=this.extraFilters.slice(0);i.push(...this.lookupCustomFilters),!n||this.previousOwnProps.configuration.CustomControlId===me&&t||i.push(n);const a={operator:"and",terms:i};e.where(a,!0,r)}else!n||this.previousOwnProps.configuration.CustomControlId===me&&t||e.where(n,!0,r)}}_checkIfLinkedEntityHasAdditionalColumns(e){return!!this._additionalColumns.find(({name:t,alias:i},r,n)=>i===e.alias)}_isLinkEntityNeeded(e){return-1===this._viewBasedLinkedEntitiesKeys.indexOf(this._getLinkedEntityExpressionKey(e))||this._checkIfLinkedEntityHasAdditionalColumns(e)}_isModernQueryBuilder(e,t,i,r,n,a){var s,o;const l=Object(E.g)(e,i),u=!(!(null==l?void 0:l.pageToEditedViewMapId)||!Object(T.rb)(e,l.pageToEditedViewMapId.guid,t.guid)),c=this.getRelationshipNameFromParameter(this.previousDataSetDefinition),d=this.linkedEntitiesObj.length>0&&this.linkedEntitiesObj.getLinkedEntities().some(e=>this._isLinkEntityNeeded(e)),p=Object(T.qb)(e,t,i);return Object(he.e)(e)&&("MscrmControls.Grid.ReadOnlyGrid"===(null===(o=null===(s=this.previousOwnProps)||void 0===s?void 0:s.configuration)||void 0===o?void 0:o.CustomControlId)||Object(he.f)(e))&&!c&&!r&&!d&&!n&&!this.filteringObj.getRootFilterExpression()&&!(this.extraFilters.length>0)&&!(this.lookupCustomFilters.length>0)&&!u&&!a&&(null==p?void 0:p.queryType)!==O.a.QUICKFIND_SEARCH}_retrieveDataProviderRetrieveAction(){let e=this._dataProvider.refresh.bind(this._dataProvider);switch(this._dataProviderRetrieveAction){case 2:e=this._dataProvider.getPaging().loadNextPage.bind(this._dataProvider.getPaging());break;case 3:e=this._dataProvider.getPaging().loadPreviousPage.bind(this._dataProvider.getPaging());break;case 5:e=this._dataProvider.getPaging().reset.bind(this._dataProvider.getPaging());break;case 6:e=this._dataProvider.getPaging().loadExactPage.bind(this._dataProvider.getPaging(),this._exactPageNumberToBeLoaded)}return e}_refreshDataProvider(e,t){this._dataProvider.setSorting(this.sortingObj.getCurrentSortingArray()),this._dataProvider.setFiltering(this.filteringObj.getFilter()),this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().setPagingSize&&this._dataProvider.getPaging().setPagingSize(this.pagingObj.getPageSize()),this._initialPageNumber>1&&(this.pagingObj.setPageFirstIndex(this._initialPageNumber),this.pagingObj.setPageLastIndex(this._initialPageNumber),this._exactPageNumberToBeLoaded=this._initialPageNumber,this._dataProviderRetrieveAction=6,this._initialPageNumber=-1);const i=t.refreshCustomDataProviderAction(this.previousOwnProps.id,this.previousOwnProps.controlId,this.propKey,this._retrieveDataProviderRetrieveAction()),r=this.getCurrentViewId(this.previousDataSetDefinition),n=new Array;return n.push(i),r&&n.push(this.retrieveCurrentViewAndAssoicatedAttributes(e,t)),Promise.all(n)}refreshDataSet(e,t,i){const r=e(),n=this.previousOwnProps&&this.previousOwnProps.configuration?Object(V.b)(r,this.previousOwnProps.configuration.CustomControlId)||Object(V.b)(e(),this.previousOwnProps.configuration.Name):q.a,s=this.previousOwnProps?Object(E.l)(e(),this.previousOwnProps.id):"",o=q.a+".Models.DataSet.DataSetObjectWrapper.refreshDataSet",u=this.retrieveQuickFindView(e,t);if(!this.previousDataSetDefinition){const e=new Error("Refreshing not initialized DataSet parameter"),t=this._getTelemetryParams(o);throw i.EventManager.ReportComponentFailure(n,e,null,t),e}if(this._queryBuilderForPaging)return this.cachedQueryState=this._queryBuilderForPaging.getQueryState(Object(he.e)(r)?e:void 0),this.cachedQueryBuilder=this._queryBuilderForPaging,this._queryBuilderForPaging=null,t.retrieveGridDataAction(this.cachedQueryState).then(()=>(this.updateRefreshStatusToRequestBack(),this),r=>{const a=this._getTelemetryParams(o+".retrieveGridDataAction",s);return i.EventManager.ReportComponentFailure(n,r,null,a),this.handleRefreshError(e,this,r,t),this});if(this._additionalColumns&&this._additionalColumns.length>0&&(this.extendFilteringObjColumnAliasMap(this._additionalColumns),this.extendSortingObjColumnAliasMap(this._additionalColumns)),this.sortingObj.updateSortingArrays(),this.filteringObj.getFilter()&&this.filteringObj.calculateFilterExpression(),this.dataFirstTimeSentAcknowledged=!0,this._dataProvider)return this._refreshDataProvider(e,t).catch(r=>{const a=this._getTelemetryParams(o+"._refreshDataProvider",s);return i.EventManager.ReportComponentFailure(n,r,null,a),this.handleRefreshError(e,this,r,t),this});return(this._boundViewParams?this.retrieveCurrentBoundView(e,t.addCustomViewAction):this.retrieveCurrentView(e,t.retrieveViewAction)).then(r=>{const c=new Array;if(null==r||r.initialized!==y.a.Initialized)return V.a.error(o+": retrieveView, can not retrieve view's metadata",this._getTelemetryParams(o)),Promise.reject(new _.a("Can not retrieve view's metadata",2415919120));this.linkedEntityParsed||this._parselinkedEntitiesFromViewDescriptor(r);const d=this.getColumnsThatRequireMetadataToBeLoaded(r,e()),p=Object(S.i)(e(),r,this.getRelationshipNameFromParameter(this.previousDataSetDefinition));p&&!a.c(r.entityLogicalName)&&(a.c(d[r.entityLogicalName])&&(d[r.entityLogicalName]=[]),d[r.entityLogicalName].push(p));for(const i in d)Object(l.z)(e(),i,d[i])||c.push(t.getEntityMetadataAction(i,d[i]));const m=Object(l.u)();return m.length>0&&c.push(t.getAdditionalResourceStrings(m)),u&&c.push(u),r.isCustomView&&Object(ne.w)(e())&&(Object.isFrozen(r)&&(r=Object.assign({},r)),c.push(t.setOfflineQueryAction(r))),Promise.all(c).then(()=>{var a,l,u;this.isColumnFirstMetadataReady=!0,this.updatePagingSizeFromViewIfNeeded(r,Object(h.h)(e()));let c=Promise.resolve();const d=this.createQueryBuilder(e,r);return d instanceof b.a?(this.cachedQueryBuilder=d,this.cachedQueryState=this.cachedQueryBuilder.getQueryState(),c=this._extractErrorMessagesIfNeeded(this.cachedQueryBuilder,t,e)):(this.cachedQueryState=d,this.cachedQueryState.entityLogicalName=r.entityLogicalName,this.cachedQueryBuilder=oe.a.fromState(this.cachedQueryState)),this._initialPageNumber<=1?this.pagingObj.reset():(this.cachedQueryBuilder.pageNumber=this._initialPageNumber,this.cachedQueryState.pageNumber=this._initialPageNumber,this._initialPageNumber=-1),1===this.firstDataRequestType&&this.dataRequestedByControlInitialization&&(this.dataRequestedByControlInitialization=!1,Object(f.o)(e(),this.cachedQueryBuilder.getKey())===y.a.Initialized||!this._initialDataSetFetchEnabled)?(this.updateRefreshStatusToRequestBack(),c.then(()=>this)):(Object(pe.c)(this.cachedQueryState,null===(a=this.contextToken)||void 0===a?void 0:a.contextTokenType,null===(u=null===(l=this.previousOwnProps)||void 0===l?void 0:l.configuration)||void 0===u?void 0:u.CustomControlId),c.then(()=>t.retrieveGridDataAction(this.cachedQueryState).then(()=>(this.updateRefreshStatusToRequestBack(),this),r=>{const a=this._getTelemetryParams(o+".retrieveGridDataAction",s);return i.EventManager.ReportComponentFailure(n,r,null,a),this.handleRefreshError(e,this,r,t),this})))})}).catch(r=>{const a=this._getTelemetryParams(o+".viewRetrievePromise",s);return i.EventManager.ReportComponentFailure(n,r,null,a),this.handleRefreshError(e,this,r,t),this})}retrieveQuickFindView(e,t){let i;const r=e(),n=this.previousOwnProps?this.previousOwnProps.id:null;return this.previousOwnProps&&(i=Object(T.C)(r,n,this.contextToken)),this.shouldUseQuickFindViewForLookup(r)&&!a.b(this.lookupFilterString)||i&&i.quickFind?t.retrieveViewAction(this.targetEntity||this.entityLogicalNameFromView||this.getEntityTypeName(),O.a.QUICKFIND_SEARCH,O.b.savedview).then(t=>{this._quickFindView=Object(T.qb)(e(),t,n)}):null}_extractErrorMessagesIfNeeded(e,t,i){if(!(this.previousOwnProps&&this.previousOwnProps.configuration&&this.previousOwnProps.configuration.CustomControlId===me&&e&&e.containsError()))return Promise.resolve();const r=e.getErrors().filter(e=>!!e.message).map(e=>e.message);if(t.getAdditionalResourceStrings&&"function"==typeof i){const e=Object(U.e)(i(),r);if(Object.values(e).some(e=>!e))return t.getAdditionalResourceStrings(r)}return Promise.resolve()}_isInitialDataSetFetchEnabled(e){if(this.previousOwnProps&&this.previousOwnProps.configuration){const t=Object(x.e)(e,this.previousOwnProps.configuration.CustomControlId)||Object(x.e)(e,this.previousOwnProps.configuration.Name);if(!(a.c(t)||a.c(t.Properties.DataSetDefinitions)||a.c(t.Properties.DataSetDefinitions[this.propKey])||a.c(t.Properties.DataSetDefinitions[this.propKey].InitialDataSetFetch)))return t.Properties.DataSetDefinitions[this.propKey].InitialDataSetFetch}return!0}getColumnsThatRequireMetadataToBeLoaded(e,t){const i=this._getAllColumns(e,this.previousDataSetDefinition,t,!0),r={},n=new Set,s=this.previousDataSetDefinition;return a.c(s)||a.c(s.Columns)||s.Columns.forEach(e=>{!a.c(e.PreventMetadataRequest)&&e.PreventMetadataRequest&&n.add(e.Name)}),i.forEach(t=>{if(n.has(t));else if(-1!==t.indexOf(".")){let e;const i=this.linkedEntitiesObj.getLinkedEntities();if(i&&i.length>0&&i.forEach(i=>{i.alias===t.split(".")[0]&&(e=i.name)}),!a.c(e)){const i=t.split(".")[1];this._addColumnsToColumnDictionary(r,e,i)}}else this._addColumnsToColumnDictionary(r,e.entityLogicalName,t)}),this.linkedEntitiesObj.getLinkedEntities().forEach(t=>{const i=t.name,n=t.from;(null==e?void 0:e.entityLogicalName)&&i&&n&&this._addColumnsToColumnDictionary(r,i,n);const a=t.to;(null==e?void 0:e.entityLogicalName)&&i&&a&&this._addColumnsToColumnDictionary(r,e.entityLogicalName,a)}),r}_addColumnsToColumnDictionary(e,t,i){a.c(e[t])&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)}updateRefreshStatusToRequestBack(){this.refreshingStatus=4,this.previousOwnProps&&this.previousOwnProps.reRunMapStateMainProps&&(0===this.dataSetClass?this.previousOwnProps.reRunMapStateMainProps():2!==this.dataSetClass&&3!==this.dataSetClass||this._scheduleForceMapStateToProps(this.previousOwnProps.reRunMapStateMainProps))}setErrorStatus(e,t,i){var r;this.refreshingStatus=100,this.errorMessage=e,this.innerError=null===(r=null==i?void 0:i.innerError)||void 0===r?void 0:r.message,this.error=!0;const n=this.getLatestData();n&&(n.loading=!1,this.previousDataSetParameter.loading=!1,n.error=this.error,this.previousDataSetParameter.error=this.error,n.errorMessage=this.errorMessage,this.previousDataSetParameter.errorMessage=this.errorMessage,n.innerError=this.innerError,this.previousDataSetParameter.innerError=this.innerError),this.reRenderControlAction&&this.reRenderControlAction(),this.triggerOnDataSetUpdateCallBack(this.error,this.errorMessage,this.innerError)}setControlReRender(e){this.reRenderControlAction=e}handleRefreshError(e,t,i,r){let n;i&&i.reason?n=i.reason:i&&(n=i),n?this._retrieveLocalizedMessageAndSetErrorStatus(e,t,n,r):t.setErrorStatus("")}_retrieveLocalizedMessageAndSetErrorStatus(e,t,i,r){r.getLocalizedErrorMessage(i,this.previousOwnProps&&this.previousOwnProps.configuration&&this.previousOwnProps.configuration.CustomControlId).then(r=>{t.setErrorStatus(r,e,i)})}gridRunOnLoad(e){if(this._needToRunLoad&&this.previousOwnProps){this._needToRunLoad=!1;try{e(this.previousOwnProps.id,void 0,this.previousOwnProps.controlId)}catch(e){V.a.error(q.a+".Models.DataSet.DataSetObjectWrapper.gridRunOnLoad: gridRunOnLoad encountered error: "+e.message,[{name:"APIName",value:q.a+".Models.DataSet.DataSetObjectWrapper.gridRunOnLoad"}])}}}loadNextPage(e){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadNextPage&&(this._dataProviderRetrieveAction=2),this.loadSpecificPage(e,this.pagingObj.getHasNextPage(),this.pagingObj.getPageLastIndex()+1)}loadExactPage(e,t){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadNextPage&&(this._dataProviderRetrieveAction=6);const i=t||this.pagingObj.getPageFirstIndex();this.loadSpecificPage(e,!0,i,!0)}loadPreviousPage(e){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().loadPreviousPage&&(this._dataProviderRetrieveAction=3),this.loadSpecificPage(e,this.pagingObj.getHasPreviousPage(),this.pagingObj.getPageFirstIndex()-1)}resetPaging(e){this._dataProvider&&this._dataProvider.getPaging&&this._dataProvider.getPaging()&&this._dataProvider.getPaging().reset&&(this._dataProviderRetrieveAction=5);const t=1!==this.pagingObj.getPageFirstIndex();this.pagingObj.reset(),this.loadSpecificPage(e,t,1)}_updatePagingObject(e,t){e?(this.pagingObj.setPageLastIndex(t),this.pagingObj.setPageFirstIndex(t),this._exactPageNumberToBeLoaded=t):t-this.pagingObj.getPageLastIndex()==1?this.pagingObj.setPageLastIndex(t):this.pagingObj.getPageFirstIndex()-t==1&&this.pagingObj.setPageFirstIndex(t)}loadSpecificPage(e,t,i,r){if(!t)return;if(this._dataProvider&&0!==this._dataProviderRetrieveAction)return this._updatePagingObject(r,i),void e(this,this.contextToken);const n=this.cachedQueryBuilder;this.pagingObj.getPageSize()!==n.pageSize?(this.pagingObj.reset(),n.pageSize=this.pagingObj.getPageSize(),this.cachedQueryState=n.getQueryState(),i=1):this._updatePagingObject(r,i),n.pageNumber=i,this._queryBuilderForPaging=n,e(this,this.contextToken)}generateNewDatasetParam(e,t,i,r,n,a,s,o){const l=this.getEntityTypeName()||this.targetEntity;return new v.a({loading:e,columns:t,error:i,errorMessage:r,innerError:n,sortedRecordIds:Object.keys(a),records:a,sorting:this.sortingObj.retrieveDataSetSorting(),filtering:this.filteringObj.retrieveDataSetFiltering(),paging:this.pagingObj.retrieveDataSetPaging(),linking:this.linkedEntitiesObj.retrieveDataSetLinking()},s,o,l,this.addColumn)}generateEmptyDataSetParam(e=""){const t=this.shouldUseLookupService()&&this.lookupView?this.lookupView.viewId:this.getCurrentViewId(this.previousDataSetDefinition),i=r.a.toString(t);if(!this.previousEmptyParameter||i!==this.previousEmptyParameter.getViewId()||this.columnsForEmptyDataset&&this.previousEmptyParameter.columns.length!==this.columnsForEmptyDataset.length){const r=null!==t||null!==this._dataProvider;let n,a,s;this.columnsForEmptyDataset&&(this.setFilteringObjColumnAliasMap(this.columnsForEmptyDataset),this.setSortingObjColumnAliasMap(this.columnsForEmptyDataset)),100===this.refreshingStatus&&this.previousDataSetParameter&&this.previousDataSetParameter.error&&(n=this.previousDataSetParameter.error,a=this.previousDataSetParameter.errorMessage,s=this.previousDataSetParameter.innerError),this.previousEmptyParameter=this.generateNewDatasetParam(r,this.columnsForEmptyDataset?this.columnsForEmptyDataset:[],!1,null,null,{},i,e),n&&(this.previousEmptyParameter.error=n,this.previousEmptyParameter.errorMessage=a,this.previousEmptyParameter.innerError=s,this.previousEmptyParameter.loading=!1),this.previousDataSetParameter=this.previousEmptyParameter}return this.previousEmptyParameter}isValidParameterConfiguration(e){return!!(e.ViewId||this._dataProvider||e.BoundViewParams)}addColumn(e,t){a.c(e)||this._additionalColumns.find(({name:i,alias:r},n,a)=>i===e&&r===t)||(this._additionalColumns.push({name:e,alias:t}),this._isColumnsetChanged=!0)}generateEmptyParam(){return this.generateEmptyDataSetParam()}getRecordSnapshotId(e,t,i,r){const n=this._getClosestParentWithContext(t),a=this.previousOwnProps.id;let s;switch(Object(E.l)(e,a)){case N.a:{const t=Object(L.f)(this.contextToken,r,i);s=Object(T.R)(e,a,t);break}default:if(n){const t=Object(L.f)(this.contextToken,r,i);s=Object(T.R)(e,a,t)}else s=Object(C.ac)(e,a,this.contextToken)}return s}_linkRecordToState(e,t,i){const s=this.previousOwnProps.id,o=i.getRecordId();i.getFormattedValue=e=>{var t,r;if(a.b(e))return null;a.b(i._columnAliasNameMap[e])||(e=i._columnAliasNameMap[e]);const s=null===(r=null===(t=this.previousDataSetParameter)||void 0===t?void 0:t.columns)||void 0===r?void 0:r.find(t=>t.name===e);if(s&&(s.dataType===g.a.WholeLanguage||s.dataType===g.a.WholeTimeZone||s.dataType===g.a.WholeDuration))return i.reformatValue(e);const o=i._record.fields[e];return a.c(o)?null:Object(n.c)(o)};const u=i.getNamedReference().entityName,c=Object(L.f)(this.contextToken,new r.a(o,!0),u);i.isEditable=t=>{if(Object(z.b)(t)){const t=!this._isRecordDisabled(e,u,i);return Promise.resolve(t)}return Promise.resolve(this.getRecordFieldIsEditable(e,i,t))},i.isSecured=t=>{const r=Object(S.d)(e,i.getNamedReference().entityName);return r&&r[t]?Promise.resolve(r[t].IsSecured):Promise.resolve(!1)},i.isReadable=t=>{const r=Object(S.d)(e,i.getNamedReference().entityName);return r&&r[t]?Promise.resolve(r[t].IsValidForRead):Promise.resolve(!0)},i.getFieldRequiredLevel=t=>Promise.resolve(this.getRecordFieldRequiredLevel(e,i,t)),i.isValid=t=>!Object(T.J)(e,s,c,t)&&(!(i._record&&i._record.fields&&i._record.fields[t]&&i._record.fields[t].validationResult)||i._record.fields[t].validationResult.isValueValid),i.getValidationError=t=>{const r=Object(T.J)(e,s,c,t);return r||(i._record&&i._record.fields&&i._record.fields[t]&&i._record.fields[t].validationResult?i._record.fields[t].validationResult.errorMessage:null)},i.reformatValue=t=>{const r=i.getValue(t);if(!Object(z.b)(r)){let a=Object(S.d)(e,i.getNamedReference().entityName);if((!a||!a[t])&&i._record&&i._record.fields&&i._record.fields[t]){const r=i._record.fields[t];Object(n.f)(r)&&(a=Object(S.d)(e,r.entityLogicalName),t=r.attributeLogicalName)}if(a&&a[t]||!i._record||!i._record.identifier||!i._record.identifier.etn||"activitypointer"!==i._record.identifier.etn||(a=Object(S.d)(e,"activitypointer")),a&&a[t]){const i=Object(l.u)(),n=Object(B.z)(e,a[t],null);return Object(B.x)(r,n,Object(U.e)(e,i))}}return""},i.getCurrencyDecimalPrecision=t=>{var n,s,o,l,u;const c=Object(S.d)(e,i.getNamedReference().entityName);if(!c)return null;const d=c[t];if(!d||a.c(d.PrecisionSource))return null;const p=Object(M.x)(e);switch(d.PrecisionSource){case le.a.attribute:return d.Precision;case le.a.organization:return p.pricingDecimalPrecision;case le.a.currency:const t=null===(s=null===(n=i._record)||void 0===n?void 0:n.fields)||void 0===s?void 0:s[ue.w],a=r.a.toString(null===(o=null==t?void 0:t.reference)||void 0===o?void 0:o.id);return a&&(null===(l=p.transactionCurrencyById)||void 0===l?void 0:l.hasOwnProperty(a))?p.transactionCurrencyById[a].currencyPrecision:null===(u=Object(h.w)(e).numberFormatInfo)||void 0===u?void 0:u.CurrencyDecimalDigits}return null}}_isRecordDisabled(e,t,i){return t!==W.tb&&(t===W.p||Object(C.Lb)(e,t,new r.a(i.getRecordId())))}getRecordFieldRequiredLevel(e,t,i){const n=this.previousOwnProps.id,a=t.getRecordId(),s=t.getNamedReference().entityName,o=Object(L.f)(this.contextToken,new r.a(a,!0),s);return Object(T.M)(e,n,o,i)}getRecordFieldIsEditable(e,t,i){if("statuscode"===i||"statecode"===i)return!1;const n=this.previousOwnProps.id,a=t.getRecordId(),s=t.getNamedReference().entityName,o=Object(L.f)(this.contextToken,new r.a(a,!0),s);return Object(T.K)(e,n,o,i,r.a.tryParseOrNull(a))}getListRecordData(e,t,i){const n=i.Parameters[this.propKey];let a;if(this.shouldUseLookupService(e)){const r=Object(Z.b)(i,this.propKey);a=Object(G.b)(e,this.pageEtn,r,this.targetEntity||this.entityLogicalNameFromView,t.id),this.previousInitState=Object(G.d)(e,a)}else a=this._getQueryKey(()=>e,t,n),this.previousInitState=Object(f.o)(e,a);if(this.previousInitState!==y.a.Initialized)return 1!==this.refreshingStatus||this.previousInitState!==y.a.Initializing&&this.previousInitState!==y.a.Refreshing||(this.refreshingStatus=2),null;if(2===this.refreshingStatus&&(this.refreshingStatus=3),1===this.refreshingStatus)return null;if(2===this.refreshingStatus)return null;const s=this.getRecordsListFromStateWithSnapshots(e,t,i);this.clearCurrentSnapshotIdMap();const u={},c={};for(let i=0;i<s.length;i++){const n=s[i].identifier.id,a=r.a.toString(n),o=s[i].identifier.etn,l=this.getRecordSnapshotId(e,t,o,n);l&&(u[a]=l,c[l]=c[l]||Object(P.b)(e,l))}Object.assign(this._snapShotIdMap,u);const d=!!Object.keys(u).length;if(this._previousDataSetRecords&&!d&&a===this._previousQueryKey&&!this.shouldUseLookupService(e)&&4!==this.refreshingStatus)return this._previousDataSetRecords;const p=this._previousQueryKey!==a;if(this._previousQueryKey=a,this.previousDataSetParameter){Object(l.A)(this.previousRecords,this.previousDataSetParameter.sortedRecordIds,s)&&(this.setLegacyUpdatedPropertiesDic(ge,!0),this.setUpdatedPropertiesDic(ge,!0))}else s&&s.length>0&&(this.setLegacyUpdatedPropertiesDic(ge,!0),this.setUpdatedPropertiesDic(ge,!0));const h=Object(l.d)(this.previousRecords,s),m=Object(l.b)(this.previousDataSetDefinition,n);if(h||m){const i={},a={},l=this.getAliasMap(n);for(let t=0;t<s.length;t++){const n=s[t],d=r.a.toString(n.identifier.id),p=n.identifier.etn,h=Object(R.h)(e,p).PrimaryNameAttribute;let m=!1;if(this.isEditableGrid(e)&&u[d]){const t=c[u[d]]||Object(P.b)(e,u[d]);(t.activeChanges&&Object.keys(t.activeChanges).length||t.lockedChanges&&Object.keys(t.lockedChanges).length)&&(m=!0)}i[d]=n,a[d]=new o(n,l,h,m)}h&&(this.previousRecords=Object.assign({},i)),m&&(this.previousDataSetDefinition=Object.assign({},n)),this._needToRunLoad=!0,this.setUpdatedPropertiesDic(ge,!0),this._previousDataSetRecords=Object.assign({},a);for(const i in this._previousDataSetRecords){const r=this._previousDataSetRecords[i];this._linkRecordToState(e,t,r)}this.triggerOnDataSetUpdateCallBack(!1,"")}else(p||4===this.refreshingStatus)&&this.triggerOnDataSetUpdateCallBack(!1,"");return this._previousDataSetRecords}getRecordsListById(e,t,i){const n={};if(this.previousInitState!==y.a.Initialized)return n;const a=this.getRecordsListFromStateWithSnapshots(e,t,i);for(let e=0;e<a.length;e++){const t=a[e];n[r.a.toString(t.identifier.id)]=t}return n}getRecordsListFromStateWithSnapshots(e,t,i){const n=i.Parameters[this.propKey],a=this.getRecordsList(e,t,n);this.clearCurrentSnapshotIdMap();const s={},o={};for(let i=0;i<a.length;i++){const n=a[i].identifier.id,l=r.a.toString(n),u=a[i].identifier.etn,c=this.getRecordSnapshotId(e,t,u,n);c&&(s[l]=c,o[c]=o[c]||Object(P.b)(e,c))}Object.assign(this._snapShotIdMap,s);return!!Object.keys(s).length&&Object.keys(s).forEach(t=>{const i=a.findIndex(e=>e.identifier.id.guid===t),n=a[i],l=s[t];(A.a.equals(o[l].identifier,n.identifier)||"activitypointer"===n.identifier.etn&&o[l].identifier&&n.identifier&&r.a.equals(o[l].identifier.id,n.identifier.id))&&(a[i]=Object(P.h)(e,s[t],n,n.identifier,Object.keys(n.fields)))}),a}getAliasMap(e){const t={};return e.Columns&&e.Columns.forEach(e=>{t[e.Alias]=e.Name}),t}setFilteringObjColumnAliasMap(e){e?this.filteringObj.setColumnAliasMapWithColumns(this._generateColumnAliasMapWithColumns(e)):this.filteringObj.setColumnAliasMapWithColumns(null)}extendFilteringObjColumnAliasMap(e){e&&e.length>0&&this.filteringObj.extendColumnAliasMapWithColumns(this._generateColumnAliasMapWithColumns(e))}setSortingObjColumnAliasMap(e){e?this.sortingObj.setColumnAliasMap(this._generateColumnAliasMapWithColumns(e)):this.sortingObj.setColumnAliasMap(null)}extendSortingObjColumnAliasMap(e){e&&e.length>0&&this.sortingObj.extendColumnAliasMap(this._generateColumnAliasMapWithColumns(e))}retrieveView(e,t){const i=this.getEntityTypeName();if(!i){const e=q.a+"Models.DataSet.DataSetObjectWrapper.retrieveView";return V.a.error(e+": retrieveView, Entity name is not specified for lookup",this._getTelemetryParams(e)),Promise.reject(new _.a("Entity name is not specified for lookup"))}return t(i,null,O.b.savedview,e)}ensureDataInitialization(e){this.dataRequestedOnce||this.previousInitState===y.a.Initialized&&2===this.firstDataRequestType?this.previousInitState===y.a.Initialized&&2===this.firstDataRequestType&&(this.dataFirstTimeSentAcknowledged=!0):e.refreshDataSetParameter(this,this.contextToken),this.dataRequestedOnce=!0}triggerOnDataSetUpdateCallBack(e,t,i=""){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.onDataSetUpdate)if(this.cachedQueryState||this._dataProvider){let r="";this.filteringObj&&!a.c(this.filteringObj.getConvertedFilter())&&(r=Object(w.b)(this.filteringObj.getConvertedFilter()));const n=this.pagingObj.retrieveDataSetPaging();n.firstPageNumber=this.pagingObj.getPageFirstIndex(),n.lastPageNumber=this.pagingObj.getPageLastIndex();const s={fetchXmlInUse:a.c(this.cachedQueryState)?null:this.cachedQueryState.fetchXml,newQueryKey:a.c(this.cachedQueryState)?null:this.cachedQueryState.key,existedFilteringString:r,existedPagingString:Object(w.b)(n),error:e,errorMessage:t,innerError:i,existedValidSortingArrayString:Object(w.b)(this.sortingObj.getValidSortingArray())};this.previousDataSetDefinition.onDataSetUpdate(s)}else if(this.error){const r={error:e,errorMessage:t,innerError:i};this.previousDataSetDefinition.onDataSetUpdate(r)}}_getViewColumns(e,t){if(!this._memoizedViewColumnsInfo||this._memoizedViewColumnsInfo.memoizedViewId!==(e&&e.viewId)){const i=[],r=e&&e.grid&&e.grid.rows&&e.grid.rows[0]?e.grid.rows[0].cells:null;if(r){for(const e in r)!r.hasOwnProperty(e)||t&&r[e].disableMetaDataBinding||i.push(r[e].name);if(e.fetchXML){const t=Object(de.b)(e.fetchXML),r=Object(ce.m)(t);if(r)for(const e of r)-1===i.indexOf(e)&&i.push(e)}}else if(this.shouldUseLookupService()&&this.lookupView)for(const e in this.lookupView.columns)i.push(this.lookupView.columns[e].logicalName);this._memoizedViewColumnsInfo={memoizedViewId:e&&e.viewId,memoizedValue:i}}return this._memoizedViewColumnsInfo.memoizedValue}_getAdditionalColumns(e,t,i){if(this._isColumnsetChanged||!this._memoizedAdditionalColumnsInfo||this._memoizedAdditionalColumnsInfo.memoizedViewId!==e.viewId){let r=[];const n=this._getViewColumns(e);for(const e in t.Columns){const{Name:i}=t.Columns[e];i&&-1===n.indexOf(i)&&-1===r.indexOf(i)&&r.push(i)}const s=[];this._additionalColumns.forEach(({name:e,alias:t})=>{const i=a.c(t)?e:`${t}.${e}`;-1===r.indexOf(i)&&-1===n.indexOf(i)&&s.push(i)}),r=r.concat(s);(e?this._getMandatoryColumnNames(i,e.entityLogicalName):[]).forEach(e=>{-1===r.indexOf(e)&&-1===n.indexOf(e)&&r.push(e)}),this._memoizedAdditionalColumnsInfo={memoizedViewId:e.viewId,memoizedValue:r}}return this._memoizedAdditionalColumnsInfo.memoizedValue}_getAllColumns(e,t,i,r){if(this._isColumnsetChanged||!this._memoizedAllColumnsInfo||this._memoizedAllColumnsInfo.memoizedViewId!==e.viewId){const n=this._getViewColumns(e,r).concat(this._getAdditionalColumns(e,t,i)),a=e&&e.grid&&e.grid.rows&&e.grid.rows[0]?e.grid.rows[0].multiObjectIdField:null;a&&-1===n.indexOf(a)&&n.push(a),this._memoizedAllColumnsInfo={memoizedViewId:e.viewId,memoizedValue:n},this._isColumnsetChanged=!1}return this._memoizedAllColumnsInfo.memoizedValue}getRecordsList(e,t,i){let r,n;if(this.shouldUseLookupService()&&this.lookupView&&this.lookupView.viewId&&(this.lookupView.viewId.guid===i.ViewId||!i.ViewId)){n=[];for(const e of this.lookupView.columns)n.push(e.logicalName)}else{const r=Object(T.qb)(e,this.getCurrentViewId(i),t.id);r&&(n=this._getAllColumns(r,i,e))}const a=this._getPageNumberQueue(),s=[];a.length>0&&1!==a[0]?this.pagingObj.setHasPreviousPage(!0):this.pagingObj.setHasPreviousPage(!1);for(let o=0;o<a.length;o++){let l;if(this.shouldUseLookupService()){const i=Object(Z.b)(t.configuration,this.propKey);r=Object(G.b)(e,this.pageEtn,i,this.targetEntity||this.entityLogicalNameFromView,t.id),l=Object(G.e)(e,r,a[o],n)}else r=this._getQueryKey(()=>e,t,i),l=Object(f.q)(e,r,a[o],n);if(l&&l.length>0){if(s.push(...l),o===a.length-1){const t=Object(f.n)(e,r).pages[a[o]];this.pagingObj.setHasNextPage(t.moreRecords)}}else o>0?this.pagingObj.setPageLastIndex(a[o]):this.pagingObj.setPageLastIndex(1),this.pagingObj.setHasNextPage(!1)}return this.pagingObj.setTotalResultCount(Object(f.s)(e,r)),s}_generateColumnAliasMapWithColumns(e){const t={};for(const i of e)i.alias&&i.name?(t[i.name]=i.name,t[i.alias]=i.name):!i.alias&&i.name&&(t[i.name]=i.name);return t}_getQueryKey(e,t,i){return this._getQueryBuilder(e,t,i).getKey()}_getQueryBuilder(e,t,i){if(!this.cachedQueryState){const r=Object(T.qb)(e(),this.getCurrentViewId(i),t.id),n=this.createQueryBuilder(e,r);n instanceof b.a?(this.cachedQueryBuilder=n,this.cachedQueryState=this.cachedQueryBuilder.getQueryState()):(this.cachedQueryState=n,this.cachedQueryBuilder=oe.a.fromState(this.cachedQueryState))}return this.cachedQueryBuilder}_getPageNumberQueue(){const e=[];if(this.shouldUseLookupService()||this.cachedQueryState)for(let t=this.pagingObj.getPageFirstIndex();t<this.pagingObj.getPageLastIndex()+1;t++)e.push(t);else e.push(1);return e}_getTelemetryParams(e,t){const i=[],r={name:"pageType",value:t},n={name:"CustomControlId",value:this.previousOwnProps&&this.previousOwnProps.configuration?this.previousOwnProps.configuration.CustomControlId:""},a={name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:""},s={name:"APIName",value:e},o={name:"EntityName",value:this.previousOwnProps&&this.previousOwnProps.formInfo&&this.previousOwnProps.formInfo.EntityName?this.previousOwnProps.formInfo.EntityName:null},l={name:"FormId",value:this.previousOwnProps&&this.previousOwnProps.formInfo&&this.previousOwnProps.formInfo.FormId?this.previousOwnProps.formInfo.FormId:null},u={name:"contextString",value:this.previousOwnProps?this.previousOwnProps.contextString:""};return i.push(r),i.push(n),i.push(s),i.push(o),i.push(l),i.push(a),i.push(u),i}getEntityTypeName(){let e;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?e=this.previousDataSetDefinition.TargetEntityType:this.entityLogicalNameFromView?e=this.entityLogicalNameFromView:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName&&(e=this.previousDataSetDefinition.EntityName),e}getAttribute(e,t,i){const r=e.Parameters[this.propKey];return 3===r.Usage?r.Attributes:Object(S.a)(t,i,r.Value)}isEditableGrid(e){if(!this.previousOwnProps||!this.previousOwnProps.configuration)return!1;const t=Object(x.e)(e,this.previousOwnProps.configuration.CustomControlId)||Object(x.e)(e,this.previousOwnProps.configuration.Name);if(!t||"MscrmControls.Grid.GridControl"!==t.ConstructorName)return!1;if(this.previousOwnProps.configuration.Parameters&&this.previousOwnProps.configuration.Parameters.EnableEditing){const e=this.previousOwnProps.configuration.Parameters.EnableEditing;if(e.Value&&"No"===e.Value)return!1}return!0}getViewIdDocumentDic(){return this.viewIdDocumentDic}parseLookupColumnsToDataSetColumns(e){const t=[];for(let i=0;i<e.length;i++)t.push({name:e[i].logicalName,displayName:e[i].logicalName,order:i,dataType:"String"===e[i].dataType?"SingleLine."+e[i].format.charAt(0).toUpperCase()+e[i].format.slice(1):e[i].dataType,alias:e[i].alias||e[i].logicalName,visualSizeFactor:0});return t}parseLookupViewDescriptorToViewDescriptor(e){return{initialized:y.a.Initialized,viewId:new r.a(this.lookupViewId),fetchXML:this.lookupView.fetchXml,entityLogicalName:this.targetEntity||this.entityLogicalNameFromView,queryType:O.a.LOOKUP_VIEW,isUserView:!1,title:e.viewName}}shouldUseLookupService(e){if(e&&!Object(X.b)(e)||!this.isOnlineStatus)return!1;if(Object(z.b)(this.lookupServiceEnabled)){if(!e)return!1;if(this._dataProvider)return this.lookupServiceEnabled=!1,this.lookupServiceEnabled;Object(z.b)(this.lookupServiceEnabled)&&(this.lookupServiceEnabled=Object(H.c)(e,K.mc))}let t=!1;return this.previousOwnProps&&this.previousOwnProps.configuration&&this.previousOwnProps.configuration.CustomControlId===me&&(t=!0),this.lookupServiceEnabled&&t}shouldUseQuickFindViewForLookup(e){Object(z.b)(this.lookupQuickFindEnabled)&&(this.lookupQuickFindEnabled=Object(H.c)(e,K.kc));let t=!1;return this.previousOwnProps&&this.previousOwnProps.configuration&&this.previousOwnProps.configuration.CustomControlId===me&&(t=!0),this.lookupQuickFindEnabled&&t}get filteringObj(){return this._filteringObj}set filteringObj(e){this._filteringObj=e}_scheduleForceMapStateToProps(e){this._rerunMapStateToPropsTaskId>=0&&clearTimeout(this._rerunMapStateToPropsTaskId),this._rerunMapStateToPropsTaskId=setTimeout(()=>{e(),this._rerunMapStateToPropsTaskId=-1},50)}_isCustomGrid(){var e;return(null===(e=this.contextToken)||void 0===e?void 0:e.contextTokenType)===k.a.CustomGrid}setMyRecordsOnlyFilter(e){this.meFilterEnabled=e}get queryBuilder(){return this.cachedQueryBuilder}relevantQueryError(){if(!(this.cachedQueryBuilder&&this.cachedQueryBuilder instanceof b.a&&this.cachedQueryBuilder.containsError()))return null;const e=this.cachedQueryBuilder.getFirstError();return!e||this.isOnlineStatus&&e.offlineModeSpecific?null:e}}be._DATASET_LOOKUP_PROP_KEY="columnLookup",be.UnknownErrorMessage="Unknown error occurred."},ANW1:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var r=i("kSDG"),n=i("yTPE"),a=i("nfCs"),s=i("r0As"),o=i("SAYH"),l=i("LbMF"),u=i("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class c extends n.a{constructor(e,t,i,r,n,a,s,o){if(super(e,t,i,r,n),this._chartType=o,-1!==a.indexOf(".")){const e=a.split(".");2===e.length&&(this._newGroupByLinkedEntityAlias=e[0],this._newGroupByAttributeName=a.split(".")[1],this._newGroupByLinkedEntityName=s)}else this._newGroupByAttributeName=a}get drillDownChartType(){return this._chartType}setupAggregationQueries(){if(!this.initialized)throw new Error("ChartDataSetQueryDecorator has not been initialized.");this.isWebResourceChart||(this._removeExistingGroupBysAndOrderBys(),this._addNewGroupBys(),this.dataDefinition.buildCategory(),Object(s.i)(this.dataDefinition.entityExpression))}_removeExistingGroupBysAndOrderBys(){const e=this.dataDefinition.entityExpression;Object(s.j)(e,"groupby"),this.dataDefinition.groupByList.length=0}_addNewGroupBys(){const e=this.dataDefinition.entityExpression,t="_"+o.a.toString(o.a.newGuid()).replace(/-/g,""),i=this._newGroupByLinkedEntityName?this._newGroupByLinkedEntityName:this.dataDefinition.entityExpression.entityName;let r=null;const n=this._createDateTimeGroupingInfo(i),l=n?Object(a.c)(n.groupingType):null;if(this._newGroupByLinkedEntityName){const i=this._getRequiredLinkedEntityFromViewDefintion();if(null!=i){const a=Object(s.c)(i,e);Object(s.g)(a,this._newGroupByAttributeName,t,"true",null,l,"true"),Object(s.a)(a,e),e.linkedEntities.push(a),r=this._createNewGroupByAndAddToExpression(t,a,n),this._GroupByKey=`LinedEntity_${a.entityName}_alias_${a.alias}_from_${a.linkFromAttribute}_to_${a.linkToAttribute}_join_${a.joinType}_GroupBy_${this._newGroupByAttributeName}_${l}`}}else Object(s.g)(e,this._newGroupByAttributeName,t,"true",null,l,"true"),r=this._createNewGroupByAndAddToExpression(t,e,n);this._GroupByKey=`GroupBy_${this._newGroupByAttributeName}_${l}`,this.dataDefinition.addGroupBys(r)}_createNewGroupByAndAddToExpression(e,t,i){const n=Object(r.a)(this._newGroupByAttributeName,e,t,i);return n.hasGroupBy=!0,t.attributes.push(n),t.groupByAttributes.push(n),n}_getRequiredLinkedEntityFromViewDefintion(){for(let e=0;e<this.viewDefinition.linkedEntities.length;e++)if(this.viewDefinition.linkedEntities[e].alias===this._newGroupByLinkedEntityAlias)return this.viewDefinition.linkedEntities[e];return null}_createDateTimeGroupingInfo(e){return"datetime"===Object(l.a)(this.getState(),e,this._newGroupByAttributeName).Type?Object(a.a)(u.a.MONTH):null}getStorageKey(){let e=super.getStorageKey();return e=`${e}:${this._GroupByKey}:${this._chartType}`,e}}},"Bj/n":function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"c",(function(){return u})),i.d(t,"b",(function(){return c}));var r=i("/Ikn"),n=i("dGG5"),a=i("YxC/"),s=i("xy1J"),o=i("zJiL");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const l="form.notification.set";function u(e,t,i,a,s,u,c,d){return{type:"form.notification.set.sync",sync:!0,execute(p,h){o.f.has(a)&&(a=o.b);const m=h.ScriptManager.getContainer(t).getEventManager();u=u||[],c=c||[],Object(r.a)(e,s,u,m);for(const t in u){const i=u[t],n=Object(r.b)(s,t);m.addOnClickEvent(e,n,i.Handler)}Object(n.a)(e,s,c,m);for(const t in c){const i=c[t],r=Object(n.b)(s,t);i.Handler&&m.addOnClickEvent(e,r,i.Handler)}return p.dispatch(function(e,t,i,r,n,a,s){return{type:l,payload:{uniqueId:r,message:t,level:i,buttons:n,placeholders:a,controlName:s,componentId:e},meta:{pageId:e}}}(t,i,a,s,u,c,d))}}}function c(e,t){return{type:"form.notification.label.sync",sync:!0,execute({dispatch:i,getState:r},n,o){const l=Object(a.b)(r(),s.k);return String.format(l,e,t)}}}},DU5H:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return u}));var r=i("i1f0"),n=i("VnpK"),a=i("q/4y"),s=i("JwRZ"),o=i("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,i,a,l){const u=Object(r.C)(e,t,a,i),c=[];let d=!1;if(u&&u.customFilter)for(const e of u.customFilter)if("START_FLAG"===e.customFilter)d=!0;else if("END_FLAG"===e.customFilter)d=!1;else if(d&&(!e.entityLogicalName||l===e.entityLogicalName)){const t=Object(n.i)(Object(o.CrmHtmlDecode)(e.customFilter));if(null!==t){const e=Object(s.n)(t,null);e&&c.push(e)}}return c}function u(e,t,i,r,n){return l(e,t,i,r,n).map(e=>a.a.toLegacyFilterExpression(e).toFetchXml()||"").join("")}},E5qG:function(e,t,i){"use strict";i.d(t,"b",(function(){return C})),i.d(t,"a",(function(){return D}));var r=i("SAYH"),n=i("FZDd"),a=i("FETf"),s=i("FCvT"),o=i("y60j"),l=i("iZ7K"),u=i("odYE"),c=i("Lohl"),d=i("S6h3"),p=i("NAAR"),h=i("dyr5"),m=i("LE5i"),g=i("zDpi"),f=i("Lyxw"),b=i("E5IU"),y=i("bwbe"),v=i("84PK");function O(e,t,i){return{type:"recentitemsbyentity.retrieve.async",execute({dispatch:r,getState:n},s){const o=s.DataSource,l=[];return l.push(e),function(e,t,i,r,n,s,o,l,u,c,d){const p=v.a.tryCreate(Object(b.i)(i));return e.getRecentItems(p,n,l,u,c,d,null).nativePromise().then(h,m);function h(e){const i=e.map(y.d),n=_(i,o,r,t,s);if(n&&t(Object(a.s)(s,n)),i&&i.length>0&&o&&o.entityTypeName){const e={};e[o.entityTypeName]=i,t(Object(a.r)(s,e))}return i}function m(e){return r.TraceManager.getTracer("Recents").error("Retrieving recent items from data source failed with error: "+e.get_Message()),Promise.reject(e)}}(o,r,n,s,l,t,i)}}}function _(e,t,i,r,n){if(e&&t&&t.id&&t.id.guid){const s=e.filter(e=>e.ObjectId.guid===t.id.guid);if(1===s.length){if(s[0].LastAccessed){const e=new Date(s[0].LastAccessed);if(e)return e.toJSON()}}else s.length>1&&(r(Object(a.u)(n,!0)),Object(h.d)(null,i,"TimelineWall.getLastAccessedTimeStamp","recentitemsbyentity.retrieve.async","more than one recent item found for current record."))}return null}var P=i("BJ7u"),S=i("3hnk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const w={},I={};let j;function C(e,t,i){return{type:"timelinewall.load.metadata.async",execute({dispatch:b,getState:y},v){const C=y();w[p.b.PostsEntity]=p.t.TimelineWallPosts,w[p.b.ActivityPointerEntity]=p.t.TimelineWallActivities,w[p.b.AnnotationEntity]=p.t.TimelineWallNotes,function(e){let t;for(t in w)I[t]=Object(f.b)(e,w[t])}(C),j=Object(f.b)(C,p.t.TimelineWall);const E=Object(f.b)(C,p.t.TimelineWallWhatsChanged);if(D())return Promise.resolve();const T=e;let F=null;const N=T.LabelId;b(Object(a.q)(N,Object(d.c)(C,N))),E&&null!==t&&null!==t.pageType&&t.pageType!==p.j&&(F=_(i,t,v,b,N),null!=F&&b(Object(a.s)(N,F)));const R=function(e,t,i,n){const s=Object(g.a)(t.Parameters[p.s.UClientActivityCardMap]),l=[];if(I[p.b.ActivityPointerEntity])for(let d=0;d<s.length;d++){const p=s[d],m=p.formId,g=p.logicalName;if(m&&g)try{const t=new r.a(m);if(!Object(o.j)(e,t)){const e=new u.a(g),r=i(Object(c.b)(e,t,Object(P.a)(11)));l.push(r)}}catch(e){i(Object(a.u)(t.LabelId,!0));const r=e.message;Object(h.d)(null,n,"TimelineWall.loadCardFormsMetadata","timelinewall.load.metadata",r)}}return Promise.all(l).then(()=>{Promise.resolve()},e=>{i(Object(a.u)(t.LabelId,!0)),Object(h.d)(e,n,"TimelineWall.loadCardFormsMetadata","retrieveForm"),Promise.resolve()})}(C,T,b,v),A=I[p.b.ActivityPointerEntity]&&!Object(h.c)(C)?function(e,t,i,r){let n=[];const a=e.Parameters[p.s.UClientActivities];if(a){n=a.split(",");if(Object(h.a)(t,p.n.SecondStage)){const e=[];for(const i of n)Object(S.b)(t,i)&&e.push(i);return e}}else{const e=Object(l.a)(t);if(e&&e!=={})for(const i in e)Object(S.b)(t,i)&&n.push(i)}return n}(e,C):[],k=function(e,t,i,r,a){return function(e,t,i,r){if(I[p.b.PostsEntity]&&!Object(h.c)(e)){Object(f.b)(e,p.t.TimelineWallUserPosts)&&i.push(p.l),i.push(s.a)}const a={};p.u.SupportedModules.forEach(t=>{const n=t.entityName;if(I[n]&&(!Object(h.c)(e)||n.indexOf(p.b.AnnotationEntity)>-1)){const e=function(e,t){switch(e.entityName.toLowerCase()){case p.b.AnnotationEntity:case p.b.PostsEntity:return[e.sortByPrimary];case p.b.ActivityPointerEntity:return[null!=t.Parameters[p.s.UClientSortActivitiesByValue]?t.Parameters[p.s.UClientSortActivitiesByValue]:e.sortByPrimary,e.sortBySecondary]}}(t,r);i.push(n),a[n]=e}});let o=0;const l=Object(h.a)(e,p.n.FirstStage),u=i.reduce((e,t)=>{const i=l?p.r[t]:p.c[t];return t===s.a?e[t]=[s.c,s.b]:e[t]=null==i?l?[]:[p.b.ModifiedOn,p.b.Description,p.b.OwnerId]:i,null!==a[t]&&void 0!==a[t]&&(e[t]=e[t].concat(a[t])),o++,e},{});if(o)return t(Object(n.e)(u));return Promise.resolve()}(e,t,i,r).then(()=>{if(I[p.b.PostsEntity])return t(Object(s.f)(r));Promise.resolve()},e=>{Object(h.d)(e,a,"TimelineWall.loadTimelineConfigAndMetaData","timelinewall.load.metadata.async")})}(C,b,A,T,v),L=function(e,t,i,r,n,s,o){let l=Promise.resolve();if(s&&null!==n&&null!==n.pageType&&n.pageType!==p.j&&null==o){const s=function(e,t,i){if(t&&t.entityTypeName){const r=Object(d.c)(e,i);if(r){return r[t.entityTypeName]||null}}return null}(e,n,r);null==s?n&&n.entityTypeName&&(l=t(O(n.entityTypeName,r,n))):(o=_(s,n,i,t,r))&&t(Object(a.s)(r,o))}return l.catch(e=>{Object(h.d)(e,i,"TimelineWall.getRecentItemsForEntity","RETRIEVE_RECENT_ITEMS_BY_ENTITY_ACTION")})}(y(),b,v,N,t,E,F);return Promise.all([R,k,L]).then(()=>{b(Object(a.o)(N,m.a.Metadata,2,null))},e=>{b(Object(a.u)(N,!0)),Object(h.d)(e,v,"TimelineWall.loadTimelineConfigAndMetaData","timelinewall.load.metadata.async")})}}}function D(){return!j||!function(){let e,t;for(t in e=!1,w)e=e||I[t];return e}()}},FCvT:function(e,t,i){"use strict";i.d(t,"f",(function(){return P})),i.d(t,"e",(function(){return w})),i.d(t,"a",(function(){return y})),i.d(t,"c",(function(){return v})),i.d(t,"b",(function(){return O})),i.d(t,"d",(function(){return _}));var r=i("x0oY"),n=i("Nb1E"),a=i("iZ7K"),s=i("LbMF"),o=i("lY/Z"),l=i("odYE"),u=i("nxXM"),c=i("dyr5"),d=i("5Oca"),p=i("a72m"),h=i("d0w6"),m=i("Lyxw"),g=i("NAAR"),f=i("KBcj"),b=i("FZDd");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const y="msdyn_postconfig",v="msdyn_entityname",O="msdyn_configurewall",_="statecode";function P(e){return{type:"postconfigs.retrieve.async",execute({dispatch:e,getState:t},i){const r=Object(d.i)(t(),y);if(r){const t=[];for(const e in r)t.push(r[e].identifier);return e(Object(u.c)(t)),Promise.resolve()}const a=function(){const e=sessionStorage.getItem("PostConfigs");if(null!=e)return JSON.parse(e)}();return a?(I(a,e,t),Promise.resolve()):e(Object(n.e)(y,"?$select=msdyn_configurewall,statecode,msdyn_entityname")).then(i=>(function(e){try{sessionStorage.setItem("PostConfigs",JSON.stringify(e))}catch(e){}}(i),I(i,e,t),Promise.resolve()),e=>{Object(c.d)(e,i,"TimelineWall.retrievePostConfigs","postconfigs.retrieve.async")})}}}function S(e,t){return new Promise(i=>{e(function(e){return{type:"postconfigquickfindviews.retrieve.async",execute:({dispatch:t,getState:i},r)=>t(Object(p.a)(e,h.a.QUICKFIND_SEARCH,h.b.savedview)).then(e=>{let t=null;return e&&(t=Object(f.c)(i(),e)),Promise.resolve(t)},e=>{Object(c.d)(e,r,"TimelineWall.retrieveQuickFindViewDescriptor","postconfigquickfindviews.retrieve.async")})}}(t)).then(e=>{i(e)})})}function w(e,t,i){const r={};return null!=t&&(Object(m.b)(i,g.t.TimelineWallPostsEnhancedMentions)||Object(m.b)(i,g.t.October2020Update)&&Object(m.b)(i,g.t.TimelineWallOctober2020UxUpdate)&&!Object(m.b)(i,g.t.TimelineWallShouldDisablePostMentionImprovements))&&e.forEach(e=>{r[e]=()=>S(t,e)}),r}function I(e,t,i){var n;const c=i();if(e.value&&e.value.length>0){const i=[v,_,O],d=Object(a.h)(c,y),p=Object(s.d)(c,y),h=e.value.length,m=[],g={};for(let n=0;n<h;n++){const a=e.value[n];(null==a?void 0:a.msdyn_entityname)&&0===(null==a?void 0:a.statecode)&&(g[a.msdyn_entityname]=[]);const s=Object(r.d)(c,a,d,p,i,null,null),u=l.a.fromLegacyEntityReference(s.get_identifier());t(Object(o.g)(u,s)),m.push(u)}g&&(null===(n=Object.keys(g))||void 0===n?void 0:n.length)>0&&t(Object(b.e)(g)),m.length>0&&t(Object(u.c)(m))}}},Fij2:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(){try{return window&&window.opener&&window.opener.parent&&window.opener.LOCID_BRANDNAME&&(window.opener.parent.IsUCI&&window.opener.auto||window.opener.parent.parent&&window.opener.parent.parent.refreshCurrentGrid&&window.opener.parent.parent.IsHybridAF)}catch(e){return!1}}function n(e){e&&r()&&window.opener.auto&&(window.opener.parent.IsUCI||window.opener.parent.parent.IsHybridAF)&&(window.opener.gridrefreshsource="child",window.opener.auto(Xrm.Internal.getEntityCode(e.getEntityName()),e.getPrimaryAttributeValue(),e.getId()))}function a(e){r()&&window.opener.parent.parent.refreshCurrentGrid&&window.opener.parent.parent.IsHybridAF&&window.opener.parent.parent.refreshCurrentGrid(e)}function s(e){return!(e||!r())&&(window.close(),!0)}i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return s}))},GEBM:function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"v",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"e",(function(){return o})),i.d(t,"y",(function(){return l})),i.d(t,"z",(function(){return u})),i.d(t,"w",(function(){return c})),i.d(t,"m",(function(){return d})),i.d(t,"o",(function(){return p})),i.d(t,"q",(function(){return h})),i.d(t,"r",(function(){return m})),i.d(t,"t",(function(){return g})),i.d(t,"s",(function(){return f})),i.d(t,"n",(function(){return b})),i.d(t,"f",(function(){return v})),i.d(t,"g",(function(){return y})),i.d(t,"A",(function(){return E})),i.d(t,"u",(function(){return O})),i.d(t,"j",(function(){return _})),i.d(t,"a",(function(){return P})),i.d(t,"i",(function(){return S})),i.d(t,"x",(function(){return w})),i.d(t,"p",(function(){return I})),i.d(t,"h",(function(){return j})),i.d(t,"k",(function(){return C})),i.d(t,"l",(function(){return D}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Web.Visualization.AxisTitle",n="Web.Visualization.AxisTitle.DateGrouping",a="Web.Visualization.EmptyAxisLabel",s="Web.Visualization.AxisTitle.CurrencySymbol",o="Calendar_Short_Months",l="Web.Visualization.Year.Quarter",u="Web.Visualization.Year.Week",c="FiscalYear_Format_String_NoSpace",d="Chart_NoData_Message",p="Chart_NoReadPrivilege",h="Chart_Retrieve_Error_Message",m="Chart_UnavailableOffline",g="Chart_Unsupported_Title",f="Chart_Unsupported_Message",b="Visualization_EmptyGridMessage",y="Error_Message_0x80061721",v="ChartAttributeValueMissing",O="Error_Message_Generic_Mobile_Client",_="Visualization_QueryApiMessage",P="Error_Message_0x8004e023",S="Web.Visualization_Invalid_Attribute",w="Error_Message_Visualization_SQLArithmeticOverflow",I="Error_Message_Visualization_Not_Found",j="Web.Visualization_Invalid_Aggregate_Type",C="Error_Message_Visualization_Navigation",D="Error_Message_Visualization_Navigation_Detail",E=["ActivityContainerControl.SubjectEllipsesText",r,n,a,"Web.Visualization.AxisTitle.AVG","Web.Visualization.AxisTitle.SUM","Web.Visualization.AxisTitle.COUNT","Web.Visualization.AxisTitle.COUNTCOLUMN",s,"Web.Visualization.AxisTitle.DateGrouping.DAY","Web.Visualization.AxisTitle.DateGrouping.FISCALPERIOD","Web.Visualization.AxisTitle.DateGrouping.FISCALYEAR","Web.Visualization.AxisTitle.DateGrouping.MONTH","Web.Visualization.AxisTitle.DateGrouping.QUARTER","Web.Visualization.AxisTitle.DateGrouping.WEEK","Web.Visualization.AxisTitle.DateGrouping.YEAR",o,l,u,c,"PageLoadingMessage",d,p,h,m,"Chart_UnreadableDefinition_Title","Chart_UnreadableDefinition_Message",g,f,"CRM_Personal_Visualization_Group_Name","CRM_System_Visualization_Group_Name",b,v,y,"Error_Message_0x80040226","Error_Message_0x80048306",O,_,P,S,w,I,j,C,D]},H523:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e.error="ERROR",e.recommendation="RECOMMENDATION",e.information="INFORMATION"}(r||(r={}))},JwRZ:function(e,t,i){"use strict";i.d(t,"A",(function(){return E})),i.d(t,"d",(function(){return T})),i.d(t,"b",(function(){return F})),i.d(t,"x",(function(){return N})),i.d(t,"c",(function(){return R})),i.d(t,"m",(function(){return A})),i.d(t,"r",(function(){return x})),i.d(t,"s",(function(){return M})),i.d(t,"e",(function(){return V})),i.d(t,"t",(function(){return B})),i.d(t,"p",(function(){return U})),i.d(t,"n",(function(){return z})),i.d(t,"g",(function(){return K})),i.d(t,"f",(function(){return Q})),i.d(t,"i",(function(){return Y})),i.d(t,"h",(function(){return X})),i.d(t,"o",(function(){return W})),i.d(t,"q",(function(){return q})),i.d(t,"B",(function(){return k})),i.d(t,"u",(function(){return ee})),i.d(t,"j",(function(){return te})),i.d(t,"z",(function(){return ne})),i.d(t,"k",(function(){return ie})),i.d(t,"l",(function(){return re})),i.d(t,"v",(function(){return ae})),i.d(t,"y",(function(){return se})),i.d(t,"w",(function(){return L})),i.d(t,"a",(function(){return D}));var r=i("SAYH"),n=i("P6DH"),a=i("WPtp"),s=i("455M"),o=i("VcAV"),l=i("Lyxw"),u=i("3/02"),c=i("eXjw"),d=i("2ciq"),p=i("NjDY"),h=i("IqkD"),m=i("aFKs"),g=i("p/2N"),f=i("errb"),b=i("LbMF"),y=i("iZ7K"),v=i("504W"),O=i("09gH"),_=i("YxC/"),P=i("nVTU"),S=i("VnpK"),w=i("CpcI"),I=i("5ZBI"),j=i("jAuy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const C="CustomControlFramework.Selectors.CustomControlDataSetSelectors",D={operator:"and",terms:[{operator:"eq-userid",terms:[{attributeName:"ownerid"}]}]};function E(e,t,i){if(!e)return!0;if(Object.keys(e).length!==i.length)return!0;if(t)for(let e=0;e<t.length;e++){const n=t[e],a=i[e];if(n!==r.a.toString(a.identifier.id))return!0}return!1}function T(e,t){var i,n;I.a.info(C+": areRecordsUpdated started");let a=!1;const s=e;if(e)if(Object.keys(e).length!==t.length)a=!0;else for(let e=0;e<t.length;e++){const o=t[e],l=s[r.a.toString(o.identifier.id)];if((o&&!l||l.initialized!==o.initialized||l.identifier!==o.identifier)&&(a=!0),!a)for(const e in o.fields){const t=o.fields[e],r=l.fields[e];(!r&&t||(null===(i=null==t?void 0:t.timestamp)||void 0===i?void 0:i.getTime())!==(null===(n=null==r?void 0:r.timestamp)||void 0===n?void 0:n.getTime()))&&(a=!0)}if(a)break}else a=!0;return I.a.info(C+": areRecordsUpdated finished"),a}function F(e,t){I.a.info(C+": areColumnAliasMapUpdated started");const i=e;let r=!1;if(e){if(i.Columns&&!t.Columns||!i.Columns&&t.Columns)r=!0;else if(i.Columns&&t.Columns)if(i.Columns.length!==t.Columns.length)r=!0;else for(let e=0;e<t.Columns.length;e++){const n=t.Columns[e].Alias;let a=!0;for(let s=0;s<i.Columns.length;s++)if(i.Columns[s].Alias===n){i.Columns[s].Name===t.Columns[e].Name?a=!1:r=!0;break}if(r||a){r=!0;break}}}else r=!0;return I.a.info(C+": areColumnAliasMapUpdated finished"),r}function N(e,t,i){var r;if(I.a.info(C+": getSortedColumnsOnView started"),!t||t.initialized!==c.a.Initialized)return[];const n=k(t,i);if(n){const e=n.getElementsByTagName("order");if(!e||0===e.length)return I.a.info(C+": getSortedColumnsOnView return []"),[];if(e.length>0){const t=[];for(let i=0;i<e.length;i++){const n=e[i],a=Object(S.o)(n,"attribute");let s="";"link-entity"===(null===(r=null==n?void 0:n.parentNode)||void 0===r?void 0:r.nodeName)&&(s=n.parentNode.getAttribute("alias")?n.parentNode.getAttribute("alias")+".":"");const o=Object(S.o)(n,"descending");a&&t.push({name:s+a,sortDirection:o&&"TRUE"===o.toUpperCase()?1:0})}return I.a.info(C+": getSortedColumnsOnView finished"),t}}return I.a.info(C+": getSortedColumnsOnView finished and return []"),[]}function R(e,t){if(!e&&!t)return!0;if(!e&&t||!t&&e||e.length!==t.length)return!1;for(let i=0;i<e.length;i++){const r=e[i],n=t[i];if(r.name!==n.name||r.sortDirection!==n.sortDirection)return!1}return!0}function A(e,t,i,r=null,a){I.a.info(C+": generateDataSetColumns started");const o=[],d=Object(p.x)(e),O=Object(h.w)(e),P=Object(p.g)(e);let S=null;if(r&&r.initialized===c.a.Initialized){const t=Object(y.h)(e,r.entityLogicalName);t&&(S=t.PrimaryNameAttribute)}if(t.Type===s.a.Grid){const a=t;a.Columns&&a.Columns.forEach(t=>{if(r&&r.initialized===c.a.Initialized){const a=t.Name,s=Object(n.E)(e,r),l=s[a],u=l?l.DisplayName:"",c=a&&s&&s[a]&&s[a].Type?s[a].Type:"",d=a&&s&&s[a]&&s[a].Format?s[a].Format:"",p=Object(m.a)(c,d),h=Object.assign(Object.assign({},t),{DisplayName:u,DataType:p,Type:""===c?"string":c,Format:""===d?f.a.text:d});o.push(i(h,-1,-1,l))}else o.push(i(t,-1,-1,null))});const s=o.find(e=>e.name===S);s&&(s.isPrimary=!0)}if(t.Type===s.a.Grid||t.Type===s.a.LookupSimple){if(r&&r.initialized===c.a.Initialized){const t=Object(g.d)(r);let s=0;const c=k(r,a),p=c?c.getElementsByTagName("link-entity"):null,h=Object(n.E)(e,r);if(!h)return I.a.error(C+": generateDataSetColumns, attributesByName is missing, return []",[{name:"viewDescriptor",value:Object(j.j)(r.fetchXML)},{name:"attributesOnState",value:e&&e.metadata&&e.metadata.attributes?JSON.stringify(e.metadata.attributes):null}]),[];for(const r of t){let t=r.disableSorting;const n=o.filter(e=>e.name===r.name&&e.order<0);let a,c=h[r.name];a=c&&r.labelId?Object(_.b)(e,r.labelId):c?c.DisplayName:"";let g="",y="";if(!c||0==(2&c.SourceTypeMask)&&0==(4&c.SourceTypeMask)&&0==(8&c.SourceTypeMask)||(t=!0),r.relatedEntityName){const i=Object(b.d)(e,r.relatedEntityName),n=r&&null!=r.name?r.name.split(".")[1]:null;c=null!=i&&n?i[n]:null,Object(l.c)(e,u.Hd)&&t&&c&&("lookup"===c.Type||"customer"===c.Type||"owner"===c.Type||"status"===c.Type||"state"===c.Type||!Object(v.a)(c.SourceType))&&"partylist"!==c.Type&&(t=!1),a=L(e,r,h,p,i),c&&(g=c.Type?c.Type:"",y=c.Format?c.Format:"")}else g=r.name&&h[r.name]&&h[r.name].Type?h[r.name].Type:"",y=r.name&&h[r.name]&&h[r.name].Format?h[r.name].Format:"";const w=Object(m.a)(g,y),I={Alias:r.name,DisplayName:a,DataType:w,Name:r.name,Type:""===g?"string":g,Format:""===y?f.a.text:y},j=i(I,s,r.width,c,r.isHidden||r.disableMetaDataBinding,r.imageProviderWebresource,r.imageProviderFunctionName,r.name===S,r.cellType,t,d,O,P,e);n&&n.length>0?n.forEach((e,t)=>{const i=e.alias;Object.assign(e,j,{alias:i}),t>0&&Object.assign(e,{order:-1})}):o.push(j),s++}}return I.a.info(C+": generateDataSetColumns finished"),o}return I.a.info(C+": generateDataSetColumns finished and return []"),[]}function k(e,t){const i=e?r.a.toString(e.viewId):"";if(i&&t[i.toUpperCase()])return t[i.toUpperCase()];const n=new DOMParser,a=e&&e.fetchXML?n.parseFromString(e.fetchXML,"text/xml"):null;return i&&a&&(t[i.toUpperCase()]=a),a}function L(e,t,i,r,n){let a="";const s=t.name.split("."),o=s.length>1?s[1]:s[0],l=n?n[o]:null;if(null!=n&&null!=l&&null!=r){let e="";for(let t=0;t<r.length;t++)r[t].getAttribute("alias")===s[0]&&(e=r[t].getAttribute("to"));const t=i[e];a=l?String.format("{0} ({1})",l.DisplayName,t?t.DisplayName:""):""}return a}function M(e,t,i,r,n){const s=[],o=Object(g.d)(r).map(e=>e.name);if(o)for(let e=0;e<o.length;e++){const t=n.fields[o[e]];s.push(Object(a.c)(t))}return s}function x(e,t,i,r,n){return Object(g.d)(r)}function V(e,t){if(!Object(o.a)(e))return!1;if(e.length!==t.length)return!0;let i=!1;for(let r=0;r<t.length;r++){const n=e[r],a=t[r];if(!n.name||Object(o.b)(n.name)||!G(n.sortDirection))return!1;n.name===a.name&&n.sortDirection===a.sortDirection||(i=!0)}return i}function B(e,t){const i=[];for(let r=0;r<e.length;r++){const n=e[r];let a;a=null==t?n.name:n.name?t[n.name]:null;const s=Object.assign(Object.assign({},n),{name:a});i.push(s)}return i}function U(e,t){const i={conditions:[],filterOperator:0};if("activitypointer"===t){const t=Object(y.a)(e);for(const e in t){const r=t[e];if(!r.IsEnabledInUnifiedInterface&&null!=r.ObjectTypeCode){const e={attributeName:"activitytypecode",conditionOperator:1,value:r.ObjectTypeCode.toString()};i.conditions.push(e)}}}return i.conditions.length>0?z(i,null):null}function z(e,t){if(I.a.info(C+": generateIExpression started"),Object(v.a)(e.filterOperator)&&(e.filterOperator=0),!(e&&(e.conditions&&0!==e.conditions.length||e.filters&&0!==e.filters.length)))return null;const i=function(e){switch(e){case 0:return"and";case 1:return"or"}return"none"}(e.filterOperator);!function(e){switch(e){case"and":case"or":break;default:throw new TypeError}}(i);const r=[];if(e.conditions&&e.conditions.length>0)for(let i=0;i<e.conditions.length;i++){const n=e.conditions[i];H(n);const a=Z(n.conditionOperator);let s,o,l,u,c,d;if($(a),s=null===t?n.attributeName:J(n.attributeName,t),Object(v.a)(n.value))l={etn:null,attributeName:s},c={entityName:n.entityAliasName},o=[],o.push(l),o.push(c),d={operator:a,terms:o},r.push(d);else{l={etn:null,attributeName:s};u={value:"number"==typeof n.value?n.value.toString(10):n.value},c={entityName:n.entityAliasName},o=[],o.push(l),o.push(u),o.push(c),d={operator:a,terms:o},r.push(d)}}if(e.filters&&e.filters.length>0)for(let i=0;i<e.filters.length;i++){const n=z(e.filters[i],t);n&&r.push(n)}return e.conditions||e.filters?(I.a.info(C+": generateIExpression finished"),{hint:e.hint,operator:i,terms:r}):(I.a.info(C+": generateIExpression finished and return null"),null)}const W=(e,t,i,r,n,a,s,o,l,u,c,p,h,m)=>{let g=function(e){if(!e)return{LogicalName:null,Type:null,type:null,DisplayName:null,IsSecured:null,RequiredLevel:null,MaxLength:null,maxLength:null,MinValue:null,minValue:null,MaxValue:null,maxValue:null,Precision:null,precision:null,Format:null,format:null,Behavior:null,behavior:null,DefaultValue:null,defaultValue:null,Targets:null,targets:null,ImeMode:null,imeMode:null,SourceType:null,sourceType:null,Options:null,options:null,ParentPicklistLogicalName:null,parentPicklistLogicalName:null,ChildPicklistLogicalNames:null,childPicklistLogicalNames:null};let t=null;return e.Behavior&&(t=e.Behavior.toString()),{LogicalName:e.LogicalName,Type:e.Type,type:e.Type,DisplayName:e.DisplayName,IsSecured:e.IsSecured,RequiredLevel:e.RequiredLevel,MaxLength:e.MaxLength,maxLength:e.MaxLength,MinValue:e.MinValue,minValue:e.MinValue,MaxValue:e.MaxValue,maxValue:e.MaxValue,Precision:e.Precision,precision:e.Precision,Format:e.Format,format:e.Format,Behavior:t,behavior:t,DefaultValue:e.DefaultValue,defaultValue:e.DefaultValue,Targets:e.Targets,targets:e.Targets,ImeMode:e.ImeMode,imeMode:e.ImeMode,SourceType:e.SourceType,sourceType:e.SourceType,Options:e.OptionSet,options:e.OptionSet,ParentPicklistLogicalName:e.ParentPicklistLogicalName,parentPicklistLogicalName:e.ParentPicklistLogicalName,ChildPicklistLogicalNames:e.ChildPicklistLogicalNames,childPicklistLogicalNames:e.ChildPicklistLogicalNames}}(r);return c&&p&&h&&(g=Object(d.d)(g,c,p,e.DataType,h,null,m,null,null)),{name:e.Name,displayName:e.DisplayName,dataType:e.DataType,alias:e.Alias,order:t,visualSizeFactor:i,attributes:g,isHidden:n,imageProviderWebresource:a,imageProviderFunctionName:s,isPrimary:o,cellType:l,disableSorting:u}},q=(e,t,i,r,n,a,s,o,l,u,c,d,p,h)=>({name:e.Name,displayName:e.DisplayName,dataType:e.DataType,alias:e.Alias,order:t,visualSizeFactor:i,isHidden:n,imageProviderWebresource:a,imageProviderFunctionName:s,isPrimary:o,cellType:l,disableSorting:u});function G(e){return 0===e||1===e}function H(e){if(e.attributeName&&e.value&&(null===e.conditionOperator||"number"!=typeof e.conditionOperator))throw I.a.error(C+": checkIfConditionExpressionHasInvalidArguments, condition Operator in ConditionExpression is missing"),TypeError("Condition Operator in ConditionExpression is missing");if(e.conditionOperator&&e.value&&!e.attributeName)throw I.a.error(C+": checkIfConditionExpressionHasInvalidArguments, attributeName in ConditionExpression is missing"),TypeError("AttributeName in ConditionExpression is missing")}function K(e,t,i){return i.filter(i=>{const r=e.getFormattedValue(i),n=t.getFormattedValue(i);return!(!r&&!n)&&r!==n})}function Q(e,t,i){return i.filter(i=>e[i].isValid&&!t.isValid(i)||!e[i].isValid&&t.isValid(i))}function Y(e,t,i,r,n){return n.filter(n=>i[n].requiredLevel!==t.getRecordFieldRequiredLevel(e,r,n))}function X(e,t,i,r,n){return n.filter(n=>i[n].isEditable!==t.getRecordFieldIsEditable(e,r,n))}function Z(e){switch(e){case 0:return"eq";case 1:return"ne";case 4:return"ge";case 2:return"gt";case 5:return"le";case 3:return"lt";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 39:return"last-x-years";case 40:return"next-x-years";case 37:return"last-x-months";case 38:return"next-x-months";case 8:return"in";case 49:return"like";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 87:return"contain-values";case 53:return"olderthan-x-months";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 54:return"begins-with";case 56:return"ends-with";case 55:return"not-begin-with";case 57:return"not-end-with";case 51:return"eq-userlanguage";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 88:return"not-contain-values"}return""}function $(e){switch(e){case"eq":case"ne":case"neq":case"ge":case"gt":case"le":case"lt":case"on":case"on-or-before":case"on-or-after":case"like":case"not-like":case"in":case"not-in":case"between":case"not-between":case"null":case"not-null":case"yesterday":case"today":case"tomorrow":case"last-seven-days":case"next-seven-days":case"last-week":case"this-week":case"next-week":case"last-month":case"this-month":case"next-month":case"last-year":case"this-year":case"next-year":case"last-x-hours":case"next-x-hours":case"last-x-days":case"next-x-days":case"last-x-weeks":case"next-x-weeks":case"last-x-months":case"next-x-months":case"last-x-years":case"next-x-years":case"this-fiscal-year":case"this-fiscal-period":case"next-fiscal-year":case"next-fiscal-period":case"last-fiscal-year":case"last-fiscal-period":case"last-x-fiscal-years":case"last-x-fiscal-periods":case"next-x-fiscal-years":case"next-x-fiscal-periods":case"in-fiscal-year":case"in-fiscal-period":case"in-fiscal-period-and-year":case"in-or-before-fiscal-period-and-year":case"in-or-after-fiscal-period-and-year":case"above":case"under":case"not-under":case"eq-or-above":case"eq-or-under":case"olderthan-x-months":case"olderthan-x-years":case"olderthan-x-weeks":case"olderthan-x-days":case"olderthan-x-hours":case"olderthan-x-minutes":case"contain-values":case"begins-with":case"ends-with":case"not-begin-with":case"not-end-with":case"not-contain-values":case"eq-userid":case"ne-userid":case"eq-businessid":case"ne-businessid":case"eq-userlanguage":case"eq-userteams":case"eq-useroruserteams":case"eq-useroruserhierarchy":case"eq-useroruserhierarchyandteams":break;default:throw I.a.error(C+": checkConditionOperatorIsValid, invalid condition operator"),TypeError("Invalid condition operator")}}function J(e,t){return t&&t.hasOwnProperty(e)?t[e]:e}function ee(){return[].concat(O.o).concat(w.g)}function te(e){return e?(e instanceof Array||(e=[e]),e.forEach(e=>{Object.assign(e,{entityType:e.TypeName,id:e.Id?e.Id.toString():null,name:e.Name})}),e):[]}function ie(e){const t=[];if(!e)return t;const i=e.get_entities();return i?(i.forEach(e=>{const i=e.getValue("partyid");if(i)t.push(new P.a(i.TypeName,i.Id?i.Id.toString():null,i.Name));else{const i=e.getValue("addressused");i&&t.push(new P.a("unresolvedaddress",r.a.EMPTY.guid,i))}}),t):t}function re(e){const t=[];return e?(e instanceof Array||(e=[e]),e.forEach(e=>{if(e.fields.partyid){const i=e.fields.partyid.reference;i&&t.push(new P.a(i.etn,i.id?i.id.guid:null,i.name))}else e.fields.addressused&&t.push(new P.a("unresolvedaddress",r.a.EMPTY.guid,e.fields.addressused.value))}),t):[]}function ne(e,t,i){const r=Object(b.j)(e,t,i);if(!r)return!1;for(let e=0;e<i.length;e++)if(!r[i[e]])return!1;return!0}function ae(e){if(e&&e.descriptor&&e.descriptor.Id){const t=e.descriptor.Id;return t.indexOf(".fieldControl")===t.length-".fieldControl".length?t.substring(0,t.length-".fieldControl".length):t}return null}function se(e,t){return!(Object(v.a)(e)||Object(v.a)(t)||Object(v.a)(e.Columns)===Object(v.a)(t.Columns)&&(Object(v.a)(t.Columns)||e.Columns.length===t.Columns.length))}},K3gL:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return o}));var r=i("yzZr"),n=i("YxC/"),a=i("ngeo");function s(){let e=null;const t=Object(n.h)();return function(i,n){let a=r.X;const s=n&&function(e){const t=[];for(const i in e){const r=o(e[i].errorCode);r&&-1===t.indexOf(r)&&t.push(r)}return t}(n);s&&s.length>0&&(a=[...r.X,...s]);const l=t(i,a);return e!==l&&(e=l),e}}function o(e){return 0===e?null:"Error_Message_0x"+a.a.getHexErrorCodeFromInt(e)}},KCGk:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{updateConfiguration(e,t){var i,r,n,a;null!==(null==e?void 0:e.DisableMru)&&void 0!==(null==e?void 0:e.DisableMru)?this._disableMru="true"===e.DisableMru.toString():this._disableMru="true"===(null===(i=null==t?void 0:t.Parameters)||void 0===i?void 0:i.DisableMru),(null===(r=null==t?void 0:t.Parameters)||void 0===r?void 0:r.IsInlineNewEnabled)?this._disableInlineNewButton="false"===t.Parameters.IsInlineNewEnabled:this._disableInlineNewButton=!1,(null===(n=null==t?void 0:t.Parameters)||void 0===n?void 0:n.useMainFormDialogForCreate)?this._useMainFormDialogForCreate="true"===t.Parameters.useMainFormDialogForCreate:this._useMainFormDialogForCreate=!!(null==e?void 0:e.UseMainFormDialogForCreate),(null===(a=null==t?void 0:t.Parameters)||void 0===a?void 0:a.useMainFormDialogForEdit)?this._useMainFormDialogForEdit="true"===t.Parameters.useMainFormDialogForEdit:this._useMainFormDialogForEdit=!!(null==e?void 0:e.UseMainFormDialogForEdit)}getLookupConfiguration(){return this._memoizedLookupConfiguration&&this._memoizedLookupConfiguration.isMruDisabled===this._disableMru&&this._memoizedLookupConfiguration.isInlineNewButtonDisabled===this._disableInlineNewButton&&this._memoizedLookupConfiguration.useMainFormDialogForCreate===this._useMainFormDialogForCreate&&this._memoizedLookupConfiguration.useMainFormDialogForEdit===this._useMainFormDialogForEdit||(this._memoizedLookupConfiguration={isMruDisabled:this._disableMru,isInlineNewButtonDisabled:this._disableInlineNewButton,useMainFormDialogForCreate:this._useMainFormDialogForCreate,useMainFormDialogForEdit:this._useMainFormDialogForEdit}),this._memoizedLookupConfiguration}}},KVHF:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var r=i("7fV9"),n=i("w10E"),a=i("KCGk"),s=i("j9v9"),o=i("5ipV"),l=i("455M"),u=i("SAYH"),c=i("KBcj"),d=i("d0w6"),p=i("Uv1Y"),h=i("eXjw"),m=i("Xi8U"),g=i("5ZBI"),f=i("j6Db"),b=i("JwRZ"),y=i("R5Qn"),v=i("Znul"),O=i("u2Wk"),_=i("F3eT"),P=i("2ciq"),S=i("DU5H"),w=i("LbMF"),I=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class j extends r.a{constructor(e,t,i){super(e,null,t),this._dataSetWrappers={},this._dataSetParameters={},this._viewSelectorItemsByTypeById={},this._previousAvailableViewIds=null,this._previousAvailableViews=null,this._selectedViewName=null,this._previousLookupParameter=null,this._lookupConfigurationWrapper=null,this._lookupMruWrapper=null,this._requireRefresh=!1,this._views={},this.lookupMetaDataRequestOnce=!1,this._lookupMruWrapper=new n.a,this._lookupConfigurationWrapper=new a.a,this._requireRefresh=i,this.dataSetClass=2}getLatestData(){return this._previousLookupParameter}getLatestFieldData(){return this._previousFieldData}retrieveCurrentView(e,t){if(null!==this._previousAvailableViews&&null!==this._selectedViewName)for(let e=0,t=this._previousAvailableViews.length;e<t;e++)if(this._previousAvailableViews[e]&&this._previousAvailableViews[e].title===this._selectedViewName)return Promise.resolve(this._previousAvailableViews[e]);return super.retrieveCurrentView(e,t)}getRelationshipNameFromParameter(e){if(!e)return null;return e.FilterRelationshipName}retrieveDataSetObject(e,t,i,r){const n=i.Parameters[this.getPropKey()];this._pageId=t.id,this.controlId=Object(b.v)(t)||n.Value,this.pageEtn=r?r.entityTypeName:"";const a=Object(P.b)(i,this.propKey),o=this.getAttribute(i,e,this.pageEtn),l=o&&o.Targets&&o.Targets[0];if(this.targetEntity=l,o&&this._checkCustomViews(e,o),this.shouldUseLookupService(e)&&o){const t=Object(y.f)(e,this.pageEtn,a,this._pageId);if(!this._entityMetadata){const i=Object(y.c)(e,t,l);if(i){const e=i.entity;this._entityMetadata={[l]:this.convertEntityDescriptorToEntityMetadata(e)}}}}let p=!1;if(!this.isParameterOfDataSetType(n))return null;this._defaultViewId=this.getCurrentViewId(n);const h=this.previousDataSetParameter;let g=this._retrieveDataSetObjectInternal(e,t,i,r);if(!g){const t=this.getCurrentViewId(n);let i;t&&(i=Object(c.c)(e,t)),g=super.generateNewDatasetParam(!0,[],!1,null,null,{},u.a.toString(t),i?i.title:"")}const f=this.createLookupParameter(e,g,n);if(this._updateMemoizedObjectsIfNeeded(h,g,f,n,r,e),this._lookupConfigurationWrapper.updateConfiguration(n,t.descriptor),this._lookupMruWrapper.updateRecentItems(Object(m.h)(e),[g.getTargetEntityType()||l],this._lookupConfigurationWrapper.getLookupConfiguration()),Object.keys(this._viewSelectorItemsByTypeById).length>0){const n={};Object.keys(this._viewSelectorItemsByTypeById).forEach(a=>{Object.keys(this._viewSelectorItemsByTypeById[a]).forEach(o=>{if(this._views[o]=Object(c.c)(e,new u.a(o)),!this._dataSetWrappers[o]){const e=this._viewSelectorItemsByTypeById[a][o],i=e&&e.isUserView?d.b.userview:d.b.savedview;this._dataSetWrappers[o]=new s.a(a,this.propKey,this.contextToken,o,i),this._dataSetWrappers[o].updatePreviousOwnProps(t),this._dataSetParameters[o]=null}const l=this._dataSetWrappers[o];let h=l.retrieveDataSetObject(e,t,i,r);h||(h=l.generateEmptyParam()),n[o]=h,n[o]!==this._dataSetParameters[o]&&(this._dataSetParameters[o]=n[o],p=!0)})}),p&&(this._previousLookupParameter=Object.assign({},this._previousLookupParameter))}return this._previousLookupParameter}_getExtraFilters(e){let t=[];if(e){e.ExtraFilters&&(t=t.concat(e.ExtraFilters));const i=e.AdditionalTargetExtraFilters;i&&i.hasOwnProperty(this.targetEntity)&&(t=t.concat(i[this.targetEntity].slice(0)))}return t}_retrieveDataSetObjectInternal(e,t,i,r){const n=this.getPropKey();if(i&&i.Parameters&&i.Parameters[n]){const a=i.Parameters[n],s=this._getExtraFilters(a),o=Object.assign(Object.assign(Object.assign({},i.Parameters[n]),this.previousDataSetDefinition),{Type:l.a.LookupSimple,ExtraFilters:s}),u=Object.assign(Object.assign({},i),{Parameters:Object.assign(Object.assign({},i.Parameters),{[n]:o})}),c=Object.assign(Object.assign({},t),{configuration:u});return super.retrieveDataSetObject(e,c,u,r)}return super.retrieveDataSetObject(e,t,i,r)}_checkCustomViews(e,t){if(e&&e.metadata&&e.metadata.views&&t&&t.Targets){const i=[],r=[];for(const t in e.metadata.views){e.metadata.views[t].isCustomView&&r.push(t)}for(const t in r){const n=r[t];i.push({id:n,name:e.metadata.views[n].title,queryType:d.a.CUSTOM_DEFINED_VIEW,isDefault:!1,isQuickFindQuery:!1,isUserView:!1,isPinned:!1,relatedEntityName:e.metadata.views[n].entityLogicalName,isAvailableInOffline:!0})}for(const e in t.Targets){const r=t.Targets[e],n=i.filter(e=>e.relatedEntityName===r),a={};n&&n.length>0&&(n.forEach(e=>{a[e.id]=e}),this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),a))}}}_updateMemoizedObjectsIfNeeded(e,t,i,r,n,a){let s=!1,o=!1;const l=this._previousAvailableViewIds?this._previousAvailableViewIds.join():null;let d=null;this.previousDataSetDefinition!==r&&(this.previousDataSetDefinition=r),null!==e&&e===t||(s=!0,this.previousDataSetParameter=t);const p=n,h=p&&p.viewIds&&p.viewIds.length>0?p.viewIds.join():null;if(h&&l!==h?(s=!0,o=!0,d=p.viewIds):r.AvailableViewIds&&l!==r.AvailableViewIds&&(s=!0,o=!0,d=r.AvailableViewIds.split(",")),null===this._previousLookupParameter&&(s=!0),s?this._previousLookupParameter=i:i.error&&(this._previousLookupParameter.error=!0,this._previousLookupParameter.errorMessage=i.errorMessage),o){this._previousAvailableViews=[],d.forEach(e=>{const t=Object(c.c)(a,new u.a(e));t&&this._previousAvailableViews.push(t)}),this._previousAvailableViewIds=d.map(e=>e.replace(/[\{\}]/gi,"").toLocaleLowerCase()),i.selectView=e=>{this._selectedViewName=e},i.availableViewNames=[];for(let e=0,t=this._previousAvailableViews.length;e<t;e++)this._previousAvailableViews[e]?i.availableViewNames.push(this._previousAvailableViews[e].title):i.availableViewNames.push("Unknown View")}}createLookupParameter(e,t,i){const n=new o.a(t,t.getViewId(),t.getTitle(),t.getTargetEntityType());n.allowFilterOff=!!i.AllowFilterOff,n.disableQuickFind=!!i.DisableQuickFind,n.enableViewPicker=!1!==i.EnableViewPicker,n.targetEntityType=i.TargetEntityType,n.filterRelationshipName=i.FilterRelationshipName,n.setRelatedFilter=this._setRelatedFilter.bind(this),n.setMyRecordsOnlyFilter=this._setMyRecordsOnlyFilter.bind(this);const a=this.relevantQueryError();if(a){if(n.error=!0,n.errorMessage=Object(I.b)(e,a.message),!n.errorMessage)return n.errorMessage=r.a.UnknownErrorMessage,n;a.parameter&&(n.errorMessage+=" "+a.parameter)}return n}_setMyRecordsOnlyFilter(e){this.setMyRecordsOnlyFilter(e),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setMyRecordsOnlyFilter(e)})}_setRelatedFilter(e){this.setRelatedFilter(e),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setRelatedFilter(e)})}generateEmptyLookupParam(e){const t=this.previousDataSetParameter,i=super.generateEmptyDataSetParam();if(!this._previousLookupParameter||t!==i){const t=this.getCurrentViewId(this.previousDataSetDefinition),r=u.a.toString(t),n=this.targetEntity;this._previousLookupParameter=this.extendByFieldData(new o.a(i,r,"",n),e)}return this._previousLookupParameter}generateEmptyParam(){return this.generateEmptyLookupParam(j._EMPTY_LOOKUP_SIMPLE_FIELD_DATA)}extendByFieldData(e,t=null){const i=this.queryBuilder&&this.queryBuilder.getFirstError()&&this._previousLookupParameter&&this._previousLookupParameter.error,r=i?this._previousLookupParameter.errorMessage:"";return null!==t&&this._previousFieldData!==t?(this._previousFieldData=t,this._previousLookupParameter=Object.assign(Object.assign({},e),this._previousFieldData)):this._previousLookupParameter=Object.assign(e,this._previousFieldData),i&&(this._previousLookupParameter.error=i,this._previousLookupParameter.errorMessage=r),this._previousLookupParameter}linkToParameter(e,t){super.linkToParameter(e,t),e.getRecentItems=this._lookupMruWrapper.getRecentItems.bind(this._lookupMruWrapper,{entityTypeNames:[e.getTargetEntityType()]}),e.getLookupConfiguration=this._lookupConfigurationWrapper.getLookupConfiguration.bind(this._lookupConfigurationWrapper),e.getAllViews=this.getAllViews.bind(this,{retrieveViewAction:t.retrieveViewAction,retrieveViewSelectorAction:t.retrieveViewSelectorAction}),e.getDefaultViewId=this.getDefaultViewId.bind(this),e.getDataSetParameter=this._getDataSetParameter.bind(this),this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{this._dataSetWrappers[e].linkToParameter(this._dataSetParameters[e],t)}),e.generateAdditionalAttributes=this.ensureLookupMetaDataInitialization.bind(this,{retrieveLookupMetadataAction:t.retrieveLookupMetadataAction,refreshDataSetParameter:t.refreshDataSetParameter},!0),e.sendLookupRequest=this.searchLookup.bind(this,t),e.runPreSearch=()=>{this.contextToken&&t.runPreSearch(this.contextToken,this.controlId,this._pageId)},e.executeNotifyHandlersThatEventOccurred=this._executeNotifyHandlersThatEventOccurred.bind(this,t)}getDefaultViewId(e){return this._defaultViewId&&this._defaultViewId.guid}getAllViews(e,t,i){const r=t;let n=[];if(!i){const t=e.retrieveViewAction(r,d.a.MAIN_APPLICATION_VIEW,d.b.savedview),i=e.retrieveViewAction(r,d.a.LOOKUP_VIEW,d.b.savedview);n=n.concat([t,i])}const a=this._previousAvailableViewIds?this._previousAvailableViewIds:[];for(let t=0;t<a.length;t++)this._previousAvailableViews&&0!==this._previousAvailableViews.length&&0!==this._previousAvailableViews.filter(e=>e.viewId&&e.viewId.guid===a[t]).length||n.push(this.retrieveView(new u.a(a[t]),e.retrieveViewAction));return Promise.all(n).then(()=>{const n=[];let s=[];if(!i){const t=e.retrieveViewSelectorAction(r,d.a.LOOKUP_VIEW).then(e=>{const t=e.viewSelectors[r][d.a[d.a.LOOKUP_VIEW]];t&&(this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),t),Object.keys(t).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&n.push({viewId:e,viewName:t[e]?t[e].name:null,isDefault:t[e]?t[e].isDefault:null,isAvailableInOffline:t[e]?t[e].isAvailableInOffline:null,isUserView:t[e]?t[e].isUserView:null,isPinned:t[e]?t[e].isPinned:null,relatedEntityName:t[e]?t[e].relatedEntityName:null})}))}),i=e.retrieveViewSelectorAction(r,d.a.MAIN_APPLICATION_VIEW).then(e=>{const t=e.viewSelectors[r][d.a[d.a.MAIN_APPLICATION_VIEW]];t&&(this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),t),Object.keys(t).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&n.push({viewId:e,viewName:t[e]?t[e].name:null,isDefault:!1,isAvailableInOffline:t[e]?t[e].isAvailableInOffline:null,isUserView:t[e]?t[e].isUserView:null,isPinned:t[e]?t[e].isPinned:null,relatedEntityName:t[e]?t[e].relatedEntityName:null})}))});s=s.concat([t,i])}const o=new Promise(e=>{for(const e in this._viewSelectorItemsByTypeById[t]){const i=this._viewSelectorItemsByTypeById[t][e];i.queryType===d.a.CUSTOM_DEFINED_VIEW&&n.push({viewId:e,viewName:i.name,isDefault:i.isDefault,isAvailableInOffline:i.isAvailableInOffline,isUserView:i.isUserView,isPinned:i.isPinned,relatedEntityName:i.relatedEntityName})}e()});return s.push(o),Promise.all(s).then(()=>n)})}retrieveView(e,t){let i;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?i=this.previousDataSetDefinition.TargetEntityType:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName?i=this.previousDataSetDefinition.EntityName:this._previousFieldData&&this._previousFieldData.attributes&&this._previousFieldData.attributes.Targets&&this._previousFieldData.attributes.Targets.length>0?i=this._previousFieldData.attributes.Targets[0]:this._previousFieldData&&this._previousFieldData.attributes&&this._previousFieldData.attributes.EntityLogicalName&&(i=this._previousFieldData.attributes.EntityLogicalName),i?e||this._viewId?t(i,d.a.LOOKUP_VIEW,d.b.savedview,e||this._viewId):t(i,d.a.LOOKUP_VIEW,d.b.savedview).then(e=>(this._viewId=e,e)).then(e=>e):(g.a.error(f.a+": retrieveView encountered error, Entity name is not specified for lookup",[{name:"APIName",value:f.a+".Models.Lookups.LookupSimpleObjectWrapper.retrieveView"}]),Promise.reject(new p.a("Entity name is not specified for lookup")))}getParameterManifestType(){return l.a.LookupSimple}refreshDataSet(e,t,i){let r=null;const n=this.getEntityTypeName()||this.targetEntity;try{t.startCustomFilter(this._pageId,this.controlId,this.contextToken),t.runPreSearch(this._pageId,this.controlId),t.runSetAdditionalParams(this._pageId,this.controlId),t.endCustomFilter(this._pageId,this.controlId,this.contextToken)}catch(e){}if(this.lookupCustomFilters=Object(S.a)(e(),this._pageId,this.contextToken,this.controlId,n),this.meFilterEnabled&&(Object(w.a)(e(),n,"ownerid")?this.lookupCustomFilters.push(b.a):r=t.getEntityMetadataAction(n,["ownerid"])),this.shouldUseQuickFindViewForLookup(e())){const e=this.filteringObj&&this.filteringObj.getFilter();this.lookupFilterString=e&&e.conditions&&e.conditions[0]&&e.conditions[0].value,this.lookupFilterString=this.lookupFilterString&&this.lookupFilterString.replace(/%$/g,"").replace(/\%/g,"*")}return this.meFilterEnabled&&r?r.then(()=>(Object(w.a)(e(),n,"ownerid")&&this.lookupCustomFilters.push(b.a),super.refreshDataSet(e,t,i))):super.refreshDataSet(e,t,i)}setErrorStatus(e,t){let i=e;const n=this.relevantQueryError();n&&t&&"function"==typeof t&&(i=Object(I.b)(t(),n.message),i?n.parameter&&(i+=" "+n.parameter):i=r.a.UnknownErrorMessage),super.setErrorStatus(i,t)}isParameterOfDataSetType(e){return!!e&&e.Type===this.getParameterManifestType()}retrieveLookupMetadata(e,t){return this.lookupMetaDataRequestOnce=!0,this.retrieveCurrentViewAndAssoicatedAttributes(e,t)}ensureLookupMetaDataInitialization(e){this.previousInitState!==h.a.Uninitialized||this.lookupMetaDataRequestOnce||this.shouldUseLookupService()||e.retrieveLookupMetadataAction(this).then(()=>{this._requireRefresh&&(this._requireRefresh=!1,e.refreshDataSetParameter(this,this.contextToken))})}_executeNotifyHandlersThatEventOccurred(e,t,i){return this.contextToken?e.executeNotifyHandlersThatEventOccurred({contextToken:this.contextToken,fieldName:this.controlId,pageId:this._pageId,record:i,eventName:t}):Promise.resolve(!1)}_getDataSetParameter(e,t){return this._dataSetParameters[t]}convertEntityDescriptorToEntityMetadata(e){return{IsReadOnlyInMobileClient:e.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.IsEnabledInUnifiedInterface,DisplayName:e.DisplayName,PrimaryNameAttribute:e.PrimaryNameAttribute,LogicalName:e.EntityLogicalName,DisplayCollectionName:e.DisplayCollectionName,IconVectorName:e.IconVectorName,ObjectTypeCode:e.ObjectTypeCode,Attributes:null}}searchLookup(e,t,i,r,n,a){const s=new _.a(this.pagingObj.getPageLastIndex()+(r&&this.pagingObj.getHasNextPage()?1:0),this.pagingObj.getPageSize(),!0,null);this._viewId=t?new u.a(t):this._defaultViewId;const o=n;a||(a=this.getRelationshipNameFromParameter(this.previousDataSetDefinition));const l=new O.a(this.targetEntity,this._viewId,o,a,null,null,s);if(r){if(!this.pagingObj.getHasNextPage())return Promise.resolve(null);this.pagingObj.setPageLastIndex(this.pagingObj.getPageLastIndex()+1)}const c=new v.a([l],null,null,null,i,!0);this.getLatestData().loading=!0,this.setRefreshingStart();const d=Object(P.b)(this.previousOwnProps.configuration,this.propKey);return e.sendLookupRequest(c,this.contextToken,this._pageId,this.pageEtn,this.controlId,d,this.previousDataSetDefinition.DependentAttributeName).then(()=>{this.updateRefreshStatusToRequestBack()}).catch(e=>{const t="Lookup Data Request encounters an exception";return this.setErrorStatus(t),g.a.error(f.a+": "+t,[{name:"APIName",value:f.a+".Models.Lookups.LookupSimpleObjectWrapper.searchLookup"},{name:"error.Stack",value:JSON.stringify(e.stack)},{name:"controlId",value:this.controlId},{name:"entityTypeName",value:this.pageEtn}]),Promise.reject(new p.a(t))})}}j._EMPTY_LOOKUP_SIMPLE_FIELD_DATA={type:l.a.LookupSimple,raw:void 0,error:!1,errorMessage:void 0,security:null}},Khp3:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var r=i("jRy5"),n=i("dHD5"),a=i("ApeL"),s=i("jTSi"),o=i("i1f0"),l=i("Qn2w"),u=i("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="control.notification.set";function d(e,t,i,d){return{type:"control.notification.set.clear.form.notification",sync:!0,execute(p,h){p.dispatch(function(e,t,i,s){if(s&&s.contextTokenType&&s.contextTokenType===r.a.GridRow)return Object(a.d)(e,s,t,i);let o={};o=i?{[i.uniqueId]:i}:null;const l=Object(n.x)(s);return{type:c,payload:o,meta:{pageId:e,contextKey:l,controlName:t}}}(e,t,i,d)),Object(o.Sc)(p.getState(),e,d,t)||(p.dispatch(Object(l.b)(e,t,!0,d)),p.dispatch(Object(s.b)(d,e,Object(u.d)(e,t))))}}}},LAcd:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="form.SuppressDuplicateDetection.set";function n(e,t){return{type:r,payload:{suppressDuplicateDetection:t},meta:{pageId:e}}}},LFkE:function(e,t,i){"use strict";i.d(t,"g",(function(){return s})),i.d(t,"c",(function(){return l})),i.d(t,"d",(function(){return u})),i.d(t,"a",(function(){return o})),i.d(t,"e",(function(){return c})),i.d(t,"f",(function(){return d})),i.d(t,"b",(function(){return p})),i.d(t,"h",(function(){return h}));var r=i("5Oca"),n=i("LbMF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t){return e&&e.businessProcessFlowData&&e.businessProcessFlowData.dataById&&e.businessProcessFlowData.dataById.hasOwnProperty(t.guid)?e.businessProcessFlowData.dataById[t.guid]:null}function s(e,t){const i=a(e,t);return i&&i.selectedStageId?i.selectedStageId:null}function o(e,t){const i=a(e,t);return i&&i.actionLogCollection?i.actionLogCollection:null}function l(e,t){const i=a(e,t);return i&&i.activePath?i.activePath:null}function u(e){return e&&e.businessProcessFlowData&&e.businessProcessFlowData.displayState?e.businessProcessFlowData.displayState:null}function c(e,t){const i=a(e,t);return i&&i.processNavigationBehavior&&i.processNavigationBehavior.navigationBehavior?i.processNavigationBehavior.navigationBehavior:null}function d(e,t){const i=a(e,t);return i&&i.processNavigationBehavior&&i.processNavigationBehavior.navigationBehaviorPageId?i.processNavigationBehavior.navigationBehaviorPageId:null}function p(e,t){const i=c(e,t);return i&&i.allowCreateNew?c(e,t).allowCreateNew:null}function h(e,t,i,a){const s=Object(n.a)(t,i,a);if(s){switch(s.Type){case"boolean":const n=e;return!n||"1"!==n.valueString;default:return Object(r.z)(e,t,i,a)}}return Object(r.z)(e,t,i,a)}},NAAR:function(e,t,i){"use strict";i.d(t,"b",(function(){return f})),i.d(t,"c",(function(){return b})),i.d(t,"r",(function(){return y})),i.d(t,"g",(function(){return v})),i.d(t,"t",(function(){return O})),i.d(t,"s",(function(){return _})),i.d(t,"o",(function(){return P})),i.d(t,"u",(function(){return S})),i.d(t,"q",(function(){return a})),i.d(t,"f",(function(){return s})),i.d(t,"i",(function(){return o})),i.d(t,"p",(function(){return l})),i.d(t,"e",(function(){return u})),i.d(t,"l",(function(){return c})),i.d(t,"m",(function(){return d})),i.d(t,"k",(function(){return p})),i.d(t,"a",(function(){return h})),i.d(t,"h",(function(){return w})),i.d(t,"j",(function(){return m})),i.d(t,"n",(function(){return g})),i.d(t,"d",(function(){return I}));var r=i("x3V2"),n=i("Lyxw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="notescontrol",s="DashboardControl",o="OneNoteIntegration",l="SharePointS2S",u="Personal",c="postcomment",d="systemusers",p="Posts",h=-2147164125,m="dashboard",g={PerfOrgDbOrgSettings:"EnableActivitiesTimeLinePerfImprovement",FirstStage:1,SecondStage:3},f={Email:"email",Task:"task",PhoneCall:"phonecall",Appointment:"appointment",Letter:"letter",Fax:"fax",RecurringAppointment:"recurringappointmentmaster",SocialActivity:"socialactivity",CampaignActivity:"campaignactivity",OpportunityClose:"opportunityclose",OrderClose:"orderclose",QuoteClose:"quoteclose",IncidentResolution:"incidentresolution",Annotations:"annotation",User:"systemuser",OwnerId:"ownerid",ScheduledStart:"scheduledstart",ScheduleEnd:"scheduleend",Description:"description",Owner:"owner",Subject:"subject",Organizer:"organizer",ActualStart:"actualstart",ModifiedOn:"modifiedon",ModifiedBy:"modifiedby",ActualRevenue:"actualrevenue",From:"from",StatusCode:"statuscode",Notes:"annotation",UserName:"username",RegardingObjectId:"regardingobject",CreatedOn:"createdon",NoteText:"notetext",Text:"text",ActivityModule:"Activities",NotesModule:"Notes",PostsModule:"Posts",AnnotationEntity:"annotation",PostsEntity:"post",ActivityPointerEntity:"activitypointer",PatternStartDate:"patternstartdate",AutoPost:"autopost",UserPost:"manualpost",CreatedBy:"createdby",FileName:"filename",FileSize:"filesize",IsDocument:"isdocument",MimeType:"mimetype"},b={letter:[f.From,f.ModifiedOn,f.Description],fax:[f.From,f.ModifiedOn,f.Description],email:[f.From,f.ModifiedOn,f.Description],task:[f.ModifiedBy,f.ModifiedOn,f.Description],phonecall:[f.From,f.ModifiedOn,f.Description],appointment:[f.Organizer,f.ScheduledStart,f.Description],RecurringAppointment:[f.OwnerId,f.PatternStartDate,f.Description],opportunityclose:[f.OwnerId,f.ModifiedOn,f.Subject,f.ActualRevenue],incidentresolution:[f.CreatedBy,f.ModifiedOn,f.Subject,f.Description],annotation:[f.ModifiedOn,f.NoteText,f.CreatedBy,f.CreatedOn,f.FileName,f.FileSize,f.IsDocument,f.MimeType,f.ModifiedBy],post:[f.CreatedOn],postcomment:[]},y={annotation:[f.NoteText,f.CreatedBy,f.CreatedOn,f.FileName,f.FileSize,f.IsDocument,f.MimeType,f.ModifiedBy]},v={bigint:r.a.Number,boolean:r.a.Boolean,customer:Object(r.c)(),datetime:r.a.DateTime,decimal:r.a.Number,double:r.a.Number,entityname:r.a.String,integer:r.a.Number,lookup:Object(r.d)(),memo:r.a.String,money:r.a.Number,owner:Object(r.e)(),partylist:r.a.PartyList,picklist:Object(r.d)(),state:r.a.String,status:r.a.String,string:r.a.String,uniqueidentifier:r.a.UniqueIdentifier,virtual:r.a.Virtual},O={TimelineWallActivities:"TimelineWallActivities",TimelineWallNotes:"TimelineWallNotes",TimelineWallPosts:"TimelineWallPosts",TimelineWallUserPosts:"TimelineWallUserPosts",TimelineWallFilters:"TimelineWallFilters",TimelineWallWhatsChanged:"TimelineWallWhatsChanged",TimelineWall:"TimelineWall",TimelineWallNotesAnalysis:"NotesAnalysisFeature",TimelineWallPostsEnhancedMentions:"TimelineWallPostsEnhancedMentions",TimelineWallContextualEmail:"FCB.ContextualEmailExperience",TimelineWallNotesOffline:"FCB.EnableNotesOnTimelineWallInOffline",TimelineWallContexual2020Update:"FCB.ContextualTimeline2020Update",TimelineWallKeywordSearch:"FCB.TimelineWall.KeywordSearch",October2020Update:"October2020Update",TimelineWallOctober2020UxUpdate:"TimelineWallOctober2020UxUpdate",TimelineWallShouldDisablePostMentionImprovements:"TimelineWallShouldDisablePostMentionImprovements"},_={Label:"Label",UClientUniqueName:"UClientUniqueName",UClientModules:"UClientModules",UClientShowFilterPane:"UClientShowFilterPane",UClientExpandFilterPane:"UClientExpandFilterPane",UClientEnableSearch:"UClientEnableSearch",UClientActivities:"UClientActivities",UClientActivityRollupType:"UClientActivityRollupType",UClientCreateActivityUsing:"UClientCreateActivityUsing",UClientDisplayActivityUsing:"UClientDisplayActivityUsing",UClientRecordPerPage:"UClientRecordPerPage",UClientOrderBy:"UClientOrderBy",UClientSortActivitiesByValue:"UClientSortActivitiesByValue",UClientActivityCardMap:"UClientActivityCardMap",UClientDisplayActivityHeaderUsing:"UClientDisplayActivityHeaderUsing",UClientDefaultModuleForCreateExperience:"UClientDefaultModuleForCreateExperience",UClientExpandRecord:"UClientExpandRecord",UClientEnableWhatsNewFilter:"UClientEnableWhatsNewFilter",UClientActivitiesConfigurationJSON:"UClientActivitiesConfigurationJSON",UClientNotesConfigurationJSON:"UClientNotesConfigurationJSON",UClientPostsConfigurationJSON:"UClientPostsConfigurationJSON",UClientDefaultFilterJSON:"UClientDefaultFilterJSON"},P={Read:"Read",Create:"Create",Write:"Write",Delete:"Delete",Assign:"Assign",Share:"Share",Append:"Append",AppendTo:"AppendTo"},S={SortActivitiesByValueDefault:"modifiedon",Timeline:"Timeline",OrderByDefault:"descending",CreateActivityDefault:"quickcreateform",DisplayActivityDefault:"defaultfields",DisplayActivityHeaderDefault:"defaultformat",PostsModule:"Posts",UserPostsModule:"UserPosts",ActivitiesModule:"Activities",NotesModule:"Notes",ActivitiesListSupported:function(e){return[f.Task,f.Email,f.PhoneCall,f.Appointment,f.Letter,f.Fax,f.RecurringAppointment,f.SocialActivity,f.CampaignActivity,f.OpportunityClose,f.OrderClose,f.QuoteClose,f.IncidentResolution].filter(t=>{switch(t){case f.RecurringAppointment:return Object(n.b)(e,"HybridDialog.AppointmentRecurrence");case f.Letter:case f.Fax:return Object(n.b)(e,"LetterAndFaxVisibleOnTLW");default:return!0}})},SupportedModules:[{moduleName:"Notes",entityName:"annotation",sortByPrimary:"modifiedon"},{moduleName:"Posts",entityName:"post",sortByPrimary:"modifiedon"},{moduleName:"Activities",entityName:"activitypointer",sortByPrimary:"modifiedon",sortBySecondary:"activityid"}],DefaultModuleForCreateExperience:"Notes"};const w={Forbidden:"Forbidden"},I={PanelHeight:600,PanelWidth:840,SupportedUnifiedClientApps:["msdynce_saleshub"]}},NDmk:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r}));const r="form.output";function n(e,t){return{type:r,payload:{reason:"save",value:t},meta:{pageId:e}}}},NPZ3:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return u}));var r=i("LbMF"),n=i("iZ7K"),a=i("8nT0"),s=i("tJdb"),o=i("O7zD");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t){const i=u(e,t,!0),n=Object(r.d)(e,t);return n&&Object.keys(n).forEach(e=>{const t=n[e];if(t.SourceType===s.a.Rollup){let e=t.LogicalName;!0===t.IsBaseCurrency&&(e=e.substring(0,e.length-5)),i.push(e+"_date"),i.push(e+"_state")}}),i}function u(e,t,i){const r=[],s=Object(n.h)(e,t);return s&&(s.HasStateCode&&r.push(a.u),s.PrimaryIdAttribute&&r.push(s.PrimaryIdAttribute),s.PrimaryImageAttribute&&r.push(Object(o.a)(s.PrimaryImageAttribute,null,null)),s.PrimaryNameAttribute&&(i&&s.PrimaryNameAttribute===a.j?r.push(a.j):i||r.push(s.PrimaryNameAttribute)),s.IsBPFEntity&&(r.push(a.r),r.push(a.x),r.push(a.a))),r}},NUHF:function(e,t,i){"use strict";i.d(t,"b",(function(){return P})),i.d(t,"a",(function(){return j}));var r=i("arV0"),n=i("jRy5"),a=i("dHD5"),s=i("LbMF"),o=i("TAgK"),l=i("Zpd/"),u=i("mIxf"),c=i("i1f0"),d=i("odYE"),p=i("D9jM"),h=i("H523"),m=i("Khp3"),g=i("YxC/"),f=i("bJSG"),b=i("uzi5"),y=i("quej"),v=i("ldGr"),O=i("ApeL"),_=i("P6DH");function P(e,t,i,a,o,l,p,h,m){return{type:"dependentFields.update.value",sync:!0,execute({dispatch:g,getState:f},b){const y=f(),v=Object(r.g)(y,e);let O,_=null;const w=Object(c.ac)(y,e,t);t.contextTokenType===n.a.RelatedEntity?(_=Object(c.T)(y,e,t.relationshipName),O=Object(c.oc)(y,{id:e},t)[t.relationshipName]):t.contextTokenType===n.a.GridRow?(_=t.entityTypeName,O=new d.a(_,t.recordId)):(_=v.entityTypeName,O=new d.a(_,v.id));const C=Object(s.e)(y,_,Object.keys(a));for(const r in a){let d=[];const f=I(a[r],C[r]);d=S(y,g,e,t,O,r,f,C);for(const r of d)if(!a.hasOwnProperty(r)){const a={},d=Object(s.a)(y,_,r),b=I(Object(c.X)(y,e,t,w,O,r),d);if(i)j(y,e,t,d,_,f,b)||(a[r]={fieldName:r,value:d.Type.toUpperCase()==="multiselectpicklist".toUpperCase()?[]:null},g(Object(u.a)(e,a,o,l,p,h,m,t.contextTokenType===n.a.GridRow?t.parentContextToken:t)));else{const n=Object(c.X)(y,e,t,w,O,r);a[r]=n||(d.Type.toUpperCase()==="multiselectpicklist".toUpperCase()?[]:null),g(P(e,t,i,a))}}}}}}function S(e,t,i,r,a,s,l,u){const c=u[s],d=r.contextTokenType!==n.a.GridRow?String.format(Object(g.b)(e,f.b),c.DisplayName):null,m=l||r.contextTokenType===n.a.GridRow?null:Object(v.b)(e,[d],h.a.information),b=c&&c.ChildPicklistLogicalNames?c.ChildPicklistLogicalNames:[];for(const s of b){if(l&&r.contextTokenType!==n.a.GridRow){const n=Object(p.a)(e,a.etn,s,l);t(Object(o.b)(i,r,s,n))}w(e,t,i,r,a,s,l,m)}return b}function w(e,t,i,r,s,o,u,d){if(r.contextTokenType===n.a.GridRow){Object(_.O)(e,i,r,o)&&t(Object(O.c)(i,r,o,!u))}else{const n=Object(a.w)(r);Object(c.z)(e,i,n,o,r.relationshipName).forEach(a=>{const o=Object(c.s)(e,{id:i,controlName:a},n);o&&!o.Disabled&&(t(Object(l.b)(i,a,n,!u)),u?function(e,t,i,r,n,a){const s=Object(c.A)(e,{controlName:r,id:i},n);if(s){const e=Object.keys(s);if(e&&e.length>0)for(const o of e)if(s[o].notificationLevel===a){const e={uniqueId:o,messages:null,notificationLevel:null,actions:null};t(Object(m.b)(i,r,e,n))}}}(e,t,i,a,r,h.a.information):t(Object(m.b)(i,a,d,r)),a.startsWith(b.b)&&t(Object(y.b)(s)))})}}function I(e,t){let i=null;return"picklist"===t.Type&&e&&e.valueString?i=parseInt(e.valueString,10):"multiselectpicklist"===t.Type&&e&&e.value&&(i=e.value.split(",")),i}function j(e,t,i,r,n,a,s){if(r&&!r.ParentPicklistLogicalName||!s)return!0;const o=Object(p.a)(e,n,r.LogicalName,a);if(o&&o.length>0){if("picklist"===r.Type)return o.some(e=>e.Value===s);if("multiselectpicklist"===r.Type)return s.every(e=>o.some(t=>t.Value===e))}return!1}},NYBK:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i("KBcj"),n=i("LbMF"),a=i("d0w6"),s=i("SAYH"),o=i("S2mk"),l=i("Z+6x");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class u{constructor(e,t,i){this._dataSetWrapper=null,this._dataSetHostOwnProps=null,this._dataSetPageInfo=null,this._memoizedDataSetColumnLookupOwnProps=null,this._memoizedDataSetColumnLookupConfiguration=null,this._columnName=e,this._contextToken=t,this._dataSetPageInfo=i}setParentRecordContext(e){this._parentRecordContext=e,this._getDataSetWrapper()&&this._getDataSetWrapper().setLookupDataSetAttributes(!0,e)}updateParameterConfiguration(e,t,i,l){if(this._dataSetHostOwnProps=t,i&&(this._dataSetPageInfo=i),!this._memoizedDataSetColumnLookupConfiguration){const t=Object(n.a)(e,l.getTargetEntityType(),this._columnName);let i;if(t&&t.Targets&&t.Targets.length)i=t.Targets[0];else if(l&&l.columns){let e=l.columns[this._columnName];e||(e=l.columns.find(e=>e.name===this._columnName)),e&&e.attributes&&e.attributes.Targets&&e.attributes.Targets.length&&(i=e.attributes.Targets[0])}l&&l.getTargetEntityType&&l.getTargetEntityType()&&"connection"===l.getTargetEntityType().toLowerCase()&&"record2id"===this._columnName&&(l&&l.getViewId&&l.getViewId()&&l.getViewId().toUpperCase()===u._ALL_STAKEHOLDERS_VIEWID?i="contact":l&&l.getViewId&&l.getViewId()&&l.getViewId().toUpperCase()===u._ALL_SALESTEAMMEMBERS_VIEWID&&(i="systemuser"));let c=Object(r.a)(e,i,a.a.LOOKUP_VIEW),d=!1,p=null,h=null,m=null;if(this._dataSetHostOwnProps&&this._dataSetHostOwnProps.configuration&&this._dataSetHostOwnProps.configuration.Parameters&&this._dataSetHostOwnProps.configuration.Parameters.hasOwnProperty(u._DATASET_GRID_PROPERTY)){const e=this._dataSetHostOwnProps.configuration.Parameters[u._DATASET_GRID_PROPERTY].Lookups;if(null!=e)for(const t in e){if(t.split(".").indexOf(this._columnName)>-1){const i=t.split("."),r=i&&i.length>0&&i[0];if(l&&l.getViewId&&l.getViewId()&&s.a.equals(new s.a(l.getViewId()),new s.a(r))){const i=e[t];c=new s.a(i.DefaultViewId),d=i.AllowFilterOff,m=i.RelationshipName,p=i.DependentAttributeName,h=i.DependentAttributeType}}}}this._memoizedDataSetColumnLookupConfiguration=Object(o.m)(this._dataSetHostOwnProps.configuration.CustomControlId,this._dataSetHostOwnProps.configuration.FormFactor,s.a.toString(c),i,u._DATASET_LOOKUP_PROP_KEY,d,m,h,p)}if(this._memoizedDataSetColumnLookupConfiguration.Parameters.hasOwnProperty(u._DATASET_LOOKUP_PROP_KEY)){const e=this._memoizedDataSetColumnLookupConfiguration.Parameters[u._DATASET_LOOKUP_PROP_KEY];if(e&&null!=e.AllowFilterOff){l.filtering.canDisableRelationshipFilter=()=>"true"===e.AllowFilterOff.toString();const t=l.filtering;t.enableRelationshipFilter=e=>{this._dataSetWrapper.setLookupDataSetAttributes(!0,this._parentRecordContext)},t.disableRelationshipFilter=()=>{this._dataSetWrapper.setLookupDataSetAttributes(!1,this._parentRecordContext)}}}this._memoizedDataSetColumnLookupOwnProps||(this._memoizedDataSetColumnLookupOwnProps=Object.assign(Object.assign({},this._dataSetHostOwnProps),{configuration:this._memoizedDataSetColumnLookupConfiguration}))}_getDataSetWrapper(){if(!this._dataSetWrapper){const e=this._memoizedDataSetColumnLookupConfiguration.Parameters[u._DATASET_LOOKUP_PROP_KEY];this._dataSetWrapper=new l.a(u._DATASET_LOOKUP_PROP_KEY,e,this._contextToken)}return this._dataSetWrapper}ensureViewInitialization(e){const t=this._memoizedDataSetColumnLookupConfiguration.Parameters[u._DATASET_LOOKUP_PROP_KEY];if(!t.ViewId){return e(t.TargetEntityType,a.a.LOOKUP_VIEW,a.b.savedview).then(e=>(t.ViewId=s.a.toString(e),t.ViewId))}return Promise.resolve(t.ViewId)}retrieveDataSetObject(e,t,i){this.updateParameterConfiguration(e,this._dataSetHostOwnProps,this._dataSetPageInfo,t);const r=this._getDataSetWrapper(),n=r.retrieveDataSetObject(e,this._memoizedDataSetColumnLookupOwnProps,this._memoizedDataSetColumnLookupConfiguration,this._dataSetPageInfo,i);n.filtering.canDisableRelationshipFilter=t.filtering.canDisableRelationshipFilter;const a=n.filtering;return a.disableRelationshipFilter=t.filtering.disableRelationshipFilter,a.enableRelationshipFilter=t.filtering.enableRelationshipFilter,r.updateControlMemoizedParameter(e,n,!1,null),n}setWrapperLoadingFlag(e){this._getDataSetWrapper().setWrapperLoadingFlag(!0)}linkToParameter(e,t){const i=e.filtering;e&&e.getTargetEntityType&&e.getTargetEntityType()&&"connectionrole"===e.getTargetEntityType().toLowerCase()&&"record2roleid"===this._columnName&&this._addConnectionFilters(i),this._dataSetWrapper.linkToParameter(e,t),e.refresh=()=>{t.retrieveDataSetLookupCellParameter(e,this,this._contextToken)}}getLatestData(){return this._dataSetWrapper?this._dataSetWrapper.getLatestData():null}resetControlLockedDataSet(){this._dataSetWrapper&&this._dataSetWrapper.resetControlMemoizedDataSet()}refreshDataSet(e,t,i){const r=this._getDataSetWrapper();return this.ensureViewInitialization(t.retrieveViewAction).then(n=>r.refreshDataSet(e,t,i))}_addConnectionFilters(e){if(this._dataSetHostOwnProps&&this._dataSetHostOwnProps.descriptor&&this._dataSetHostOwnProps.descriptor.Parameters&&this._dataSetHostOwnProps.descriptor.Parameters.hasOwnProperty(u._DATASET_VIEW_ID_PROPERTY)){const t=s.a.toString(s.a.fromExternalGuid(this._dataSetHostOwnProps.descriptor.Parameters[u._DATASET_VIEW_ID_PROPERTY])).toUpperCase();if(t===u._ALL_STAKEHOLDERS_VIEWID||t===u._ALL_SALESTEAMMEMBERS_VIEWID){const i=t===u._ALL_STAKEHOLDERS_VIEWID?"1000":"1001";e.clearFilter();const r=[],n={attributeName:"category",conditionOperator:0,value:i};r.push(n);const a={conditions:r,filterOperator:0};e.setFilter(a)}}}}u._DATASET_LOOKUP_PROP_KEY="columnLookup",u._DATASET_GRID_PROPERTY="Grid",u._DATASET_VIEW_ID_PROPERTY="ViewId",u._ALL_STAKEHOLDERS_VIEWID="4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF",u._ALL_SALESTEAMMEMBERS_VIEWID="FE4BC089-8901-466C-A41B-1C1090F204D4"},NbYl:function(e,t,i){"use strict";i.d(t,"a",(function(){return U}));var r=i("3/02"),n=i("Lyxw"),a=i("SAYH"),s=i("eXjw"),o=i("j6Db");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,i,r,n,a,s,o,l=null){const d={getState:t,actions:i,entityName:o,parentName:n,promiseCollection:l||[],chartDataSetObjectWrapper:r,pageId:a,contextToken:s};switch(e){case 1:return c(d);case 3:return function(e){const t=e.actions.updateChartFilterExpression(e.pageId,e.contextToken,e.chartDataSetObjectWrapper.getChartFilterExpression()),i=e.actions.updateChartDrillDownParameters(e.pageId,e.contextToken,e.chartDataSetObjectWrapper.getChartDrillDownParameters());return Promise.all([t,i]).then(()=>{let t=1;const i=e.chartDataSetObjectWrapper.getChartDrillDownParameters();i&&i.length>0&&(t=2),e.chartDataSetObjectWrapper.setRefreshMode(t)})}(d);case 2:return function(e){return u(e).then(e=>{const t=e.input,i=e.chartDataDecorator,r=e.input.actions.retreiveChartDataAction(i,t.entityName,t.pageId,!0);return t.promiseCollection.push(r),Promise.all(t.promiseCollection)})}(d);default:return c(d)}}function u(e){return e.chartDataSetObjectWrapper.ensureReadinessForChartDataRefresh(e.getState,e.actions,e.entityName).then(t=>{if(e.parentName&&"DataSetHost"===e.parentName){const i=e.actions.updateDataSetChartVisualizationId(e.pageId,e.contextToken,a.a.toString(t.visualizationId)),r=e.actions.updateDataSetChartVisualizationType(e.pageId,e.contextToken,t.visualizationType);e.promiseCollection.push(i,r)}return{input:e,chartDataDecorator:t}})}function c(e){return u(e).then(t=>{const i=t.input,r=t.chartDataDecorator,n=t.input.actions.retreiveChartDataAction(r,i.entityName,i.pageId,!0);return e.promiseCollection.push(n),Promise.all(e.promiseCollection)})}var d=i("CngE"),p=i("GEBM"),h=i("LbMF"),m=i("p/2N"),g=i("YxC/"),f=i("69Qu"),b=i("KBcj"),y=i("3mEc"),v=i("JwRZ"),O=i("5ZBI"),_=i("4DTG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class P extends _.a{constructor(e,t,i,r,n,a,s,o,l,u,c,d){super(e,t,i,r),this.getChartConfigObject=()=>n,this.getWebResourceState=()=>a,this.getChartSelectorOption=()=>s,this.getAttributesMetadata=()=>o,this.getViewAssociatedAttributesMetadata=()=>l,this.getViewSelectorOption=()=>u,this.getDefaultVisualizationId=()=>c,this.getChartExportMetadata=()=>d}getVisualizationType(){throw new Error("Not Replaced")}setVisualizationType(e){throw new Error("Not Replaced")}getVisualizationId(){throw new Error("Not Replaced")}setVisualizationId(e){throw new Error("Not Replaced")}getViewType(){throw new Error("Not Replaced")}setViewType(e){throw new Error("Not Replaced")}getViewId(){throw new Error("Not Replaced")}setViewId(e){throw new Error("Not Replaced")}getChartConfigObject(){throw new Error("Not Replaced")}getWebResourceState(){throw new Error("Not Replaced")}getChartFilterExpression(){throw new Error("Not Replaced")}setChartFilterExpression(e){throw new Error("Not Replaced")}getChartSelectorOption(){throw new Error("Not Replaced")}getViewSelectorOption(){throw new Error("Not Replaced")}getUpdateChartFilterExpression(){throw new Error("Not Replaced")}setUpdateChartFilterExpression(e){throw new Error("Not Replaced")}getAttributesMetadata(){throw new Error("Not Replaced")}getViewAssociatedAttributesMetadata(){throw new Error("Not Replaced")}setRefreshMode(e){throw new Error("Not Replaced")}getChartDrillDownParameters(){throw new Error("Not Replaced")}setChartDrillDownParameters(e){throw new Error("Not Replaced")}getDefaultVisualizationId(){throw new Error("Not Replaced")}formatNumber(e,t){throw new Error("Not Replaced")}getChartExportMetadata(){throw new Error("Not Replaced")}getIsRelatedRecord(){throw new Error("Not Replaced")}}var S=i("7fV9"),w=i("d0w6"),I=i("hwt8"),j=i("IqkD"),C=i("Xd5/"),D=i("ANW1"),E=i("fSnw"),T=i("S2mk"),F=i("ngeo"),N=i("5R5s"),R=i("K3gL"),A=i("85o3"),k=i("uNu9"),L=i("VcAV"),M=i("P6DH"),x=i("vNXc"),V=i("/Zy9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const B=o.a+".Models.DataSet.ChartDataSetObjectWrapper.refreshDataSet";class U extends S.a{constructor(e,t){super(e,null,t),this._previousChartDataSetParameter=null,this._previousEmptyChartParameter=null,this._previousChartConfigObjectFromStateTree=null,this._previousChartConfigObjectToChartControl=null,this._previousWebResourceStateFromStateTree=null,this._previousWebResourceStateToChartControl=null,this._previousChartSelectorObjectFromStateTree=null,this._previousChartSelectorObjectToChartControl=null,this._previousViewSelectorObjectFromStateTree=null,this._previousViewSelectorObjectToChartControl=null,this._previousViewIdsToDisplayRaw=null,this._previousViewIdsToDisplay=null,this._memoizedVisualizationIdFromDataSetDefinition=null,this._currentVisualizationId=null,this._memoizedVisualizationTypeFromDataSetDefinition=null,this._currentVisualizationType=null,this._memoizedViewIdFromDataSetDefinition=null,this._currentViewId=null,this._memoizedViewTypeFromDataSetDefinition=null,this._currentViewType=null,this._memoizedChartFilterExpressionFromDataSetDefinition=null,this._currentChartFilterExpression=null,this._memoizedChartDrillDownParametersFromDataSetDefinition=null,this._memoizedDefaultFilterAndLinkedEntities=null,this._currentChartDrillDownParameters=null,this._parentName=null,this._shouldUpdateChartFilterExpression=null,this._chartDataSetRefreshMode=null,this._isChartDrillDownFeatureEnabled=null,this._cultureInfo=null,this.dataSetClass=1}getLatestData(){return this._previousChartDataSetParameter}retrieveDataSetObjectFromStorage(e,t,i,o){const l=i.Parameters.Parent;l&&(this._parentName=l.Value);const u=i.Parameters[this.getPropKey()],c=this.updatedSubParameter(o);"DataSetHost"===this._parentName&&(this.forceApplyDataSetInputReturnNone=!1);const p=this.getViewId(),g=this.getVisualizationId(),f=u.EntityName||u.TargetEntityType;if(this.getVisualizationType(),this.getViewType(),this.getChartFilterExpression(),this.getChartDrillDownParameters(),this._getUserCultureInfo(e),!p||!g)return this._generateEmptyChartDataSetParam();const b=this.previousOwnProps?this.previousOwnProps.id:null,y=Object(M.qb)(e,a.a.tryParse(p),b),O=this._retrieveChartConfigObject(e,g,p),_=this._retrieveWebResourceState(e,g),P=this._retrieveChartSelectorObject(e,f),S=this._retrieveViewSelectorObject(e,f);if(!(O||_||P||S))return this._generateEmptyChartDataSetParam();if(null!==_||null!==O?(2===this.refreshingStatus&&(this.refreshingStatus=4),this.previousInitState=s.a.Initialized):this.previousInitState===s.a.Uninitialized&&2===this.firstDataRequestType&&(this.previousInitState=s.a.Initializing),!this._previousChartDataSetParameter||O!==this._previousChartDataSetParameter.getChartConfigObject()||_!==this._previousChartDataSetParameter.getWebResourceState()||P!==this._previousChartDataSetParameter.getChartSelectorOption()||S!==this._previousChartDataSetParameter.getViewSelectorOption()||4===this.refreshingStatus){let t=!1;if(null!==O){let i;i=Object(n.c)(e,r.rd)?this._cachedChartDataDecorator?Object(d.e)(e,this._cachedChartDataDecorator.getStorageKey()):Object(d.e)(e,this.createChartDataDecorator(e).getStorageKey()):Object(d.d)(e,g,p),t=i!==s.a.Initialized}const i=Object(v.m)(e,u,v.q,y,this.viewIdDocumentDic),a=!1,o=null,l=null,c={},b=p,w="",I=O,j=_,C=P,D=Object(h.d)(e,f),E=function(e,t){const i={};if(e&&e.initialized===s.a.Initialized){Object(m.d)(e).forEach(e=>{i[e.name]={relatedEntityName:e.relatedEntityName||"",drilldownDisplayName:e.name}}),t&&t.length>0&&t.filter(e=>e.name in i).forEach(e=>{i[e.name].drilldownDisplayName=e.displayName})}return i}(y,i),T=S,F=this._getDefaultVisualizationId(e),N=this._getChartExportMetadataFromStateTree(e);null===_&&null===O||4===this.refreshingStatus&&(this.refreshingStatus=0),this._previousChartDataSetParameter=this._generateNewDataSetParam(t,i,a,o,l,c,b,w,I,j,C,D,E,T,F,N)}return c&&(this._previousChartDataSetParameter=Object.assign({},this._previousChartDataSetParameter)),this._previousChartDataSetParameter}_retrieveWebResourceState(e,t){const i=Object(d.a)(e,a.a.tryParse(t));if(null==i||a.a.isNullOrEmpty(i.WebResourceId))return null;const r=i.WebResourceId,n=Object(y.g)(e,r);if(!this._previousWebResourceStateFromStateTree||this._previousWebResourceStateFromStateTree!==n||!this._previousWebResourceStateToChartControl){this._previousWebResourceStateFromStateTree=n;let e=null;return n&&(e={name:n.name,displayName:n.displayName,id:a.a.toString(n.id),type:n.type,isEnabledForMobileClient:n.isEnabledForMobileClient}),this._previousWebResourceStateToChartControl=e,this._previousWebResourceStateToChartControl}return this._previousWebResourceStateToChartControl}_retrieveChartConfigObject(e,t,i){let a=null;if(a=Object(n.c)(e,r.rd)?this._cachedChartDataDecorator?Object(d.c)(e,this._cachedChartDataDecorator.getStorageKey()):Object(d.c)(e,this.createChartDataDecorator(e).getStorageKey()):Object(d.b)(e,t,i),!this._previousChartConfigObjectFromStateTree||this._previousChartConfigObjectFromStateTree!==a||!this._previousChartConfigObjectToChartControl){this._previousChartConfigObjectFromStateTree=a;let e=null;return a&&(e={Title:a.Title,Legend:a.Legend,Area3DStyle:a.Area3DStyle,AreaGradientStyle:a.AreaGradientStyle,XAxes:a.XAxes,YAxes:a.YAxes,SeriesList:a.SeriesList,SubTitle:a.SubTitle,Colors:a.Colors,DisplayMode:a.DisplayMode,ErrorInformation:a.ErrorInformation,EnableDrilldown:a.EnableDrilldown,Annotations:a.Annotations}),this._previousChartConfigObjectToChartControl=e,this._previousChartConfigObjectToChartControl}return this._previousChartConfigObjectToChartControl}_retrieveChartSelectorObject(e,t){const i=Object(d.i)(e,t);if(!this._previousChartSelectorObjectFromStateTree||this._previousChartSelectorObjectFromStateTree!==i||!this._previousChartSelectorObjectToChartControl){this._previousChartSelectorObjectFromStateTree=i;const e=[];if(i){const t=i.chartTypes;if(t&&Object.keys(t).length>0)for(const i in t){const r=t[i];for(const t in r){const i=r[t],n={categoryId:i.IsUserChart?"1":"0",id:a.a.toString(i.Id),value:a.a.toString(i.Id),text:i.Name};e.push(n)}}}return this._previousChartSelectorObjectToChartControl=e,this._previousChartSelectorObjectToChartControl}return this._previousChartSelectorObjectToChartControl}_retrieveViewSelectorObject(e,t){const i=this.previousDataSetDefinition;if(!i.EnableViewPicker)return null;const r=i.ViewIds;this._previousViewIdsToDisplayRaw&&this._previousViewIdsToDisplayRaw===r||(this._previousViewIdsToDisplayRaw=r,this._previousViewIdsToDisplay=r&&r.split(","),this._previousViewIdsToDisplay&&this._previousViewIdsToDisplay.length>0&&this._previousViewIdsToDisplay.forEach((e,t,i)=>{i[t]=a.a.toString(a.a.tryParse(e))}));const n=Object(b.f)(e,t,w.a.MAIN_APPLICATION_VIEW);if(n&&(!this._previousViewSelectorObjectFromStateTree||this._previousViewSelectorObjectFromStateTree!==n||!this._previousViewSelectorObjectToChartControl)){this._previousViewSelectorObjectFromStateTree=n;const e=[];if(Object.keys(n).length>0)for(const t in n){if(this._previousViewIdsToDisplay&&this._previousViewIdsToDisplay.length>0&&-1===this._previousViewIdsToDisplay.indexOf(t))continue;const i=n[t],r={categoryId:i.isUserView?"1":"0",id:t,value:t,text:i.name};e.push(r)}return this._previousViewSelectorObjectToChartControl=e,this._previousViewSelectorObjectToChartControl}return this._previousViewSelectorObjectToChartControl}generateEmptyParam(){return this._generateEmptyChartDataSetParam()}_generateEmptyChartDataSetParam(){const e=this.getViewId(),t=this.getVisualizationId();if(!this._previousEmptyChartParameter||e!==this._previousEmptyChartParameter.getViewId()||t!==this._previousEmptyChartParameter.getVisualizationId()){const i=null!==e&&null!==t;this._previousEmptyChartParameter=this._generateNewDataSetParam(i,[],!1,null,null,{},e,"",null,null,null,null,null,null,"",null)}return this._previousChartDataSetParameter=this._previousEmptyChartParameter,this._previousEmptyChartParameter}_generateNewDataSetParam(e,t,i,r,n,a,s,o,l,u,c,d,p,h,m,g){const f=super.generateNewDatasetParam(e,t,i,r,n,a,s,o),b=this.getEntityTypeName(),y=new P(f,s,o,b,l,u,c,d,p,h,m,g);return y.getVisualizationType=this.getVisualizationType.bind(this),y.setVisualizationType=this.setVisualizationType.bind(this),y.getVisualizationId=this.getVisualizationId.bind(this),y.setVisualizationId=this.setVisualizationId.bind(this),y.getViewType=this.getViewType.bind(this),y.setViewType=this.setViewType.bind(this),y.getViewId=this.getViewId.bind(this),y.setViewId=this.setViewId.bind(this),y.getChartFilterExpression=this.getChartFilterExpression.bind(this),y.setChartFilterExpression=this.setChartFilterExpression.bind(this),y.getUpdateChartFilterExpression=this.getUpdateChartFilterExpression.bind(this),y.setUpdateChartFilterExpression=this.setUpdateChartFilterExpression.bind(this),y.getChartDrillDownParameters=this.getChartDrillDownParameters.bind(this),y.setChartDrillDownParameters=this.setChartDrillDownParameters.bind(this),y.setRefreshMode=this.setRefreshMode.bind(this),y.formatNumber=this.formatNumber.bind(this),y.getIsRelatedRecord=this.getIsRelatedRecord.bind(this),y}getVisualizationId(){if(this._currentVisualizationId){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.VisualizationId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.VisualizationId));e!==this._memoizedVisualizationIdFromDataSetDefinition&&(this._currentVisualizationId=e,this._memoizedVisualizationIdFromDataSetDefinition=e)}}else if(this.previousDataSetDefinition&&this.previousDataSetDefinition.VisualizationId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.VisualizationId));this._currentVisualizationId=e,this._memoizedVisualizationIdFromDataSetDefinition=e}else this._currentVisualizationId=null;return this._currentVisualizationId}setVisualizationId(e){const t=new a.a(e);this._currentVisualizationId=a.a.toString(t)}getVisualizationType(){const e=this.previousDataSetDefinition;if(null===this._currentVisualizationType)if(e&&e.IsUserChart){const t="true"===e.IsUserChart?1:0;this._currentVisualizationType=t,this._memoizedVisualizationTypeFromDataSetDefinition=t}else this._currentVisualizationType=0;else if(e&&e.IsUserChart){const t="true"===e.IsUserChart?1:0;t!==this._memoizedVisualizationTypeFromDataSetDefinition&&(this._currentVisualizationType=t,this._memoizedVisualizationTypeFromDataSetDefinition=t)}return this._currentVisualizationType}setVisualizationType(e){this._currentVisualizationType=e}getViewId(){if(this._currentViewId){if(this.previousDataSetDefinition&&this.previousDataSetDefinition.ViewId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.ViewId));e!==this._memoizedViewIdFromDataSetDefinition&&(this._currentViewId=e,this._memoizedViewIdFromDataSetDefinition=e)}}else if(this.previousDataSetDefinition&&this.previousDataSetDefinition.ViewId){const e=a.a.toString(new a.a(this.previousDataSetDefinition.ViewId));this._currentViewId=e,this._memoizedViewIdFromDataSetDefinition=e}else this._currentViewId=null;return this._currentViewId}setViewId(e){const t=new a.a(e);this._currentViewId=a.a.toString(t)}getViewType(){const e=this.previousDataSetDefinition;if(null===this._currentViewType)if(e&&e.IsUserView){const t="true"===e.IsUserView?4230:1039;this._currentViewType=t,this._memoizedViewTypeFromDataSetDefinition=t}else this._currentViewType=1039;else if(e&&e.IsUserView){const t="true"===e.IsUserView?4230:1039;t!==this._memoizedViewTypeFromDataSetDefinition&&(this._currentViewType=t,this._memoizedViewTypeFromDataSetDefinition=t)}return this._currentViewType}setViewType(e){this._currentViewType=e}getChartFilterExpression(){const e=this.previousDataSetDefinition;return this._currentChartFilterExpression?e&&e.HighchartFilterExpression&&e.HighchartFilterExpression!==this._memoizedChartFilterExpressionFromDataSetDefinition&&(this._currentChartFilterExpression=e.HighchartFilterExpression,this._memoizedChartFilterExpressionFromDataSetDefinition=e.HighchartFilterExpression):e&&e.HighchartFilterExpression?(this._currentChartFilterExpression=e.HighchartFilterExpression,this._memoizedChartFilterExpressionFromDataSetDefinition=e.HighchartFilterExpression):e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters.length>0&&(this._currentChartFilterExpression=e.ChartDrillDownParameters[e.ChartDrillDownParameters.length-1].filterExpression),this._currentChartFilterExpression}setChartFilterExpression(e){this._currentChartFilterExpression=e}setUpdateChartFilterExpression(e){this._shouldUpdateChartFilterExpression=e}getUpdateChartFilterExpression(){return this._shouldUpdateChartFilterExpression}getChartDrillDownParameters(){const e=this.previousDataSetDefinition;return this._currentChartDrillDownParameters?e&&e.ChartDrillDownParameters&&e.ChartDrillDownParameters!==this._memoizedChartDrillDownParametersFromDataSetDefinition&&(this._currentChartDrillDownParameters=e.ChartDrillDownParameters,this._memoizedChartDrillDownParametersFromDataSetDefinition=e.ChartDrillDownParameters):e&&e.ChartDrillDownParameters&&(this._currentChartDrillDownParameters=e.ChartDrillDownParameters,this._memoizedChartDrillDownParametersFromDataSetDefinition=e.ChartDrillDownParameters),this._currentChartDrillDownParameters}setChartDrillDownParameters(e){this._currentChartDrillDownParameters=e}setRefreshMode(e){this._chartDataSetRefreshMode=e}formatNumber(e,t,i){return Object(I.c)(e,this._cultureInfo,t,i)}getRefreshMode(e){return null===this._isChartDrillDownFeatureEnabled&&(this._isChartDrillDownFeatureEnabled=Object(n.c)(e,r.t)),this._getRefreshMode()}_getRefreshMode(){!1===this._isChartDrillDownFeatureEnabled&&(this._parentName&&"DataSetHost"===this._parentName&&this.getUpdateChartFilterExpression()?this._chartDataSetRefreshMode=3:this._chartDataSetRefreshMode=1);const e=this.getChartDrillDownParameters();return 2===this._chartDataSetRefreshMode&&(!e||e.length<=0)&&(this._chartDataSetRefreshMode=1),this._chartDataSetRefreshMode?this._chartDataSetRefreshMode:e&&e.length>0?2:1}getIsRelatedRecord(){var e;return!!(null===(e=this.previousDataSetDefinition)||void 0===e?void 0:e.RelationshipName)}createChartDataDecorator(e){const t=this.getViewId(),i=a.a.tryParse(t),r=this.getViewType(),n=this.getVisualizationId(),s=a.a.tryParse(n),o=this.getVisualizationType();let l;switch(this.getRefreshMode(e)){case 2:let t=null;const n=this.getChartDrillDownParameters();if(!(n&&n.length>0))throw new Error("Execution failed for ChartDrilldownDataSetRefreshExecutor; Cause: Missing Chart Drilldown Parameter.");t=n[n.length-1],l=new D.a(()=>e,s,i,o,r,t.groupByAttribute.name,t.groupByAttribute.relatedEntityName,t.chartType);break;case 1:case 3:default:l=new E.a(()=>e,s,i,o,r)}this.dataFirstTimeSentAcknowledged=!0;const u=this.previousOwnProps?this.previousOwnProps.id:null,c=Object(M.qb)(e,i,u);if(!c||!c.fetchXML)return l;const p=Object(d.a)(e,s);if(!p||!p.DataDescription&&!p.WebResourceId)return l;this.sortingObj.updateSortingArrays();const h=this.getChartFilterExpression();h&&("{}"===h?this.filteringObj.clearFilter():this.filteringObj.setFilter(JSON.parse(h))),c.entityLogicalName&&c.entityLogicalName===k.Bb&&this._applyQueueItemDefaultFilterAndLinkedEntities(e,c),this.filteringObj.getFilter()&&this.filteringObj.calculateFilterExpression();const m=this.createQueryBuilder(()=>e,c);return this.pagingObj.reset(),m instanceof x.a?(this.cachedQueryState=m.getQueryState(),this.cachedQueryBuilder=m):(this.cachedQueryState=m,this.cachedQueryBuilder=V.a.fromState(this.cachedQueryState)),l.initialize(p.DataDescription,this.cachedQueryBuilder instanceof x.a?this.cachedQueryBuilder.fetchXml:this.cachedQueryState.fetchXml,p.PresentationDescription,c.title,c.entityLogicalName,p.Name,p.PrimaryEntityTypeCode,!a.a.isNullOrEmpty(p.WebResourceId),!Object(L.c)(this.cachedQueryBuilder instanceof x.a?this.cachedQueryBuilder.rollupType:void 0)),l.setupAggregationQueries(),this._cachedChartDataDecorator=l,this._cachedChartDataDecorator}ensureDataInitialization(e){this.dataRequestedOnce||this.previousInitState!==s.a.Initializing||2!==this.firstDataRequestType||(this.dataRequestedOnce=!0,this.dataFirstTimeSentAcknowledged=!0),super.ensureDataInitialization(e)}ensureReadinessForChartDataRefresh(e,t,i){const r=this.getViewId(),n=this.getViewType(),s=this.getVisualizationId(),o=this.getVisualizationType(),l=[];l.push(t.retrieveViewAction(i,null,n,a.a.tryParse(r))),this.previousDataSetDefinition&&this.previousDataSetDefinition.EnableViewPicker&&l.push(t.retrieveViewSelectorAction(i,w.a.MAIN_APPLICATION_VIEW));const u=this.retrieveQuickFindView(e,t);return u&&l.push(u),Promise.all(l).then(l=>t.retreiveChartAction(i,o,a.a.tryParse(s)).then(()=>this.createChartDataDecorator(e()),i=>(this._handleRetrieveChartActionError(e,t,new E.a(e,a.a.tryParse(s),a.a.tryParse(r),o,n),i.getNegativeErrorCode()),null)),i=>{const l=i&&!Object(T.j)(i.errorCode)&&i.errorCode,u=Object(R.a)(l),c=u?Object(g.b)(e(),u):"retrieve chart failed. error code: "+F.a.getHexErrorCodeFromInt(l);t.updateChartErrorInformation(e(),c,new E.a(e,a.a.tryParse(s),a.a.tryParse(r),o,n),this.previousOwnProps.id)})}_handleRetrieveChartActionError(e,t,i,r){const n=e();t.updateChartErrorInformation(n,Object(g.b)(n,p.q),i,this.previousOwnProps.id)}refreshDataSet(e,t,i){const r=this.previousOwnProps&&this.previousOwnProps.configuration?Object(O.b)(e(),this.previousOwnProps.configuration.CustomControlId)||Object(O.b)(e(),this.previousOwnProps.configuration.Name):o.a;if(!this.previousDataSetDefinition)throw i.EventManager.ReportComponentFailure(r,new Error("previousDataSetDefinition is null or undefined"),null,[{name:"APIName",value:B},{name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:""},{name:"EntityName",value:this.previousOwnProps&&this.previousOwnProps.formInfo?this.previousOwnProps.formInfo.EntityName:null},{name:"CustomControlId",value:this.previousOwnProps&&this.previousOwnProps.configuration?this.previousOwnProps.configuration.CustomControlId:""}]),new Error("Refreshing not initialized DataSet parameter");if(!Object(f.b)(e()))return this.updateRefreshStatusToRequestBack(),Promise.resolve(this);const n=this.previousOwnProps?this.previousOwnProps.id:null,s=this.previousOwnProps&&this.previousOwnProps.formInfo?this.previousOwnProps.formInfo.EntityName:this.getEntityTypeName(),u=this.getVisualizationId(),c=a.a.tryParse(u);return l(this.getRefreshMode(e()),e,t,this,this._parentName,n,this.contextToken,s,null).then(()=>(this.updateRefreshStatusToRequestBack(),this),a=>(i.EventManager.ReportComponentFailure(r,a,a.message,[{name:"APIName",value:B},{name:"pageId",value:n},{name:"controlId",value:this.previousOwnProps?this.previousOwnProps.controlId:null},{name:"EntityName",value:this.getEntityTypeName()},{name:"visualizationId",value:JSON.stringify(c)}]),this.handleRefreshError(e,this,a,t),this))}setErrorStatus(e,t){this.refreshingStatus=100,this.errorMessage=e,this.error=!0;const i=this.getLatestData();i&&(i.loading=!1,this._previousChartDataSetParameter.loading=!1,i.error=this.error,this._previousChartDataSetParameter.error=this.error,i.errorMessage=this.errorMessage,this._previousChartDataSetParameter.errorMessage=this.errorMessage),this.triggerOnDataSetUpdateCallBack(this.error,this.errorMessage,"")}_getChartExportMetadataFromStateTree(e){if(!(e&&e.metadata&&e.metadata.charts&&e.metadata.charts[this.getVisualizationId()]))return null;return{visualizationid:this.getVisualizationId(),name:e.metadata.charts[this.getVisualizationId()].Name,description:null,primaryentitytypecode:e.metadata.charts[this.getVisualizationId()].PrimaryEntityTypeCode,datadescription:e.metadata.charts[this.getVisualizationId()].DataDescription,presentationdescription:e.metadata.charts[this.getVisualizationId()].PresentationDescription,isdefault:e.metadata.charts[this.getVisualizationId()].IsDefault,solutionId:null}}_getUserCultureInfo(e){return e&&e.user?(this._cultureInfo||(this._cultureInfo=Object(C.d)(Object(j.w)(e))),this._cultureInfo):null}_getDefaultVisualizationId(e){const t=this.getEntityTypeName();if(!(e&&e.metadata&&e.metadata.chartDefaults&&t))return null;const i=e.metadata.chartDefaults[t];return i?a.a.toString(i):null}_applyQueueItemDefaultFilterAndLinkedEntities(e,t){const i=Object(j.q)(e),a=t.entityLogicalName;if(i&&a&&0===this.extraFilters.length){if(!this._memoizedDefaultFilterAndLinkedEntities){const t=Object(n.c)(e,r.Zc),s=Object(N.a)(a,i,this.contextToken,t).getFilterAndLinkedEntities(A.a,!0);this._memoizedDefaultFilterAndLinkedEntities=s}if(this._memoizedDefaultFilterAndLinkedEntities){const e=this._memoizedDefaultFilterAndLinkedEntities.filter,t=this.filteringObj.getFilter();if(t&&t!==e){if(!t.filters||t.filters&&-1===t.filters.indexOf(e)){const i={conditions:[],filterOperator:0,filters:[t,e]};this.filteringObj.setFilter(i)}}else this.filteringObj.setFilter(e);this._memoizedDefaultFilterAndLinkedEntities.linkEntities.forEach(e=>{this.linkedEntitiesObj.addLinkedEntity(e)})}}}}},Or4W:function(e,t,i){"use strict";i.d(t,"b",(function(){return D})),i.d(t,"a",(function(){return E})),i.d(t,"d",(function(){return F})),i.d(t,"c",(function(){return C}));var r=i("SAYH"),n=i("y60j"),a=i("K7RF"),s=i("S2mk"),o=i("VqBP"),l=i("FZDd"),u=i("Lohl"),c=i("odYE"),d=i("Z/4N"),p=i("NPZ3"),h=i("Uv1Y"),m=i("BJ7u"),g=i("txdA"),f=i("3/02"),b=i("Lyxw"),y=i("AF/G"),v=i("9fGf"),O=i("iJGp"),_=i("CYtR"),P=i("69Qu"),S=i("i1f0"),w=i("4mtW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const I=new r.a("06e9f7af-1f54-4681-8eec-1e21a1ceb465"),j=new r.a("e7a81278-8635-4d9e-8d4d-59480b391c5b");function C(e,t){const i=[{name:"formId",value:r.a.toString(e)},{name:"entityTypeName",value:t}];return{type:"loadFormDependencies.async",execute({dispatch:r,getState:a},s,o){let u=a();const c=Object(n.j)(u,e);if(!c)return s.EventManager.ReportComponentFailure("Forms.LoadFormDependencies",Error("Invalid FormDescriptor in LoadFormDependencies"),void 0,i),Promise.reject(new h.a("No form descriptor found in state tree for specified formId."));return r(Object(l.f)(t,!1,Object(n.y)(u,e))).then(()=>{u=a();const e=D(u,r,c,t,s,o),i=r(Object(l.f)(t,!1,Object(p.b)(u,t,!1)));e.push(i);const n=function(e,t,i,r,n){let a=!0;null!=i.EntityLogicalName&&e&&e.metadata&&e.metadata.entities&&e.metadata.entities[i.EntityLogicalName]&&!e.metadata.entities[i.EntityLogicalName].IsBusinessProcessEnabled&&(a=!1);if(a){return T(e,t,["MscrmControls.Containers.ProcessBreadCrumb","MscrmControls.Containers.ProcessStageControl"],r,n)}return Promise.resolve()}(u,r,c,s,o);return e.push(n),Promise.all(e)})},getFailureParameters:(e,t)=>i}}function D(e,t,i,n,a,s){const l=[];for(const u in i.Controls){const c=i.Controls[u];if(r.a.isNullOrEmpty(c.ClassId)||r.a.equals(c.ClassId,y.G))continue;const d=E(e,t,i,u,c,Object(o.b)(e,n,c),c.ClassId&&r.a.toString(c.ClassId),a,s);l.push(d)}return l}function E(e,t,i,n,a,o,u,c,d){let p,h;const m=a.Parameters,y=Object(g.g)(e,i,a,m);if(Object(b.c)(e,f.y)&&y){h="MscrmControls.Chart.ChartControl";const i=[T(e,t,[h],c,d)];return Promise.all(i)}if(a.UniqueId!==r.a.EMPTY.guid&&!r.a.equals(a.ClassId,I)){const t=i.ControlConfigurations[a.UniqueId],r=Object(v.b)(e);t&&t.CustomControls&&t.CustomControls[r]&&(p=t.CustomControls[r],h=p.Name)}p||(p=Object(s.q)(n,a.DataFieldName,o,a,i.EntityLogicalName,u),h="notescontrol"===p.Name?"MscrmControls.TimelineWallControl.TimelineWall":Object(s.z)(p));const O=[T(e,t,function(e,t){if(Object(b.c)(e,f.jd)&&t===_.a)return[t,_.g];if(Object(w.d)(e)&&t===_.f)return[t,_.g];return t===_.c?[t,_.b,_.h]:[t]}(e,h),c,d)];if(r.a.equals(new r.a(u),j)&&a.Parameters){const e="TargetEntityType",i=a.Parameters[e];O.push(t(Object(l.f)(i,!1,[])).catch(()=>{}))}return Promise.all(O)}function T(e,t,i,r,n){const s=[];for(const t of i){Object(d.e)(e,t)||s.push(t)}return s.length>0?t(Object(a.b)("customcontrol",null,null,null,!1,O.a.OnDemandWithoutContext,null,null,s,null)).catch(e=>{const t=[{name:"CorrelationId",value:n.correlationId},{name:"ContextId",value:n.contextId},{name:"ActionStack",value:n.stack}];r.TraceManager.getTracer("Forms.LoadFormDependencies").warn("Getting client metadata has failed.",t)}):Promise.resolve()}function F(e,t,i,r){var n;const a=[];for(const s in t){const o=t[s],l=!Object(P.b)(i);let d;d=l?Object(S.Xb)(i):new Set(Object.keys(o));for(const t in o){if(l&&d&&!d.has(t)){null===(n=r.TraceManager.getTracer("Forms.LoadFormDependencies"))||void 0===n||n.warn("Quick form entity is not included in offline profile.Skipping loading descriptor when offline .");continue}const i=o[t],s=e(Object(u.b)(new c.a(t),i,Object(m.a)(6))).then(()=>e(C(i,t)));a.push(s)}}return Promise.all(a)}},PUjk:function(e,t,i){"use strict";let r;function n(e){r=e}function a(e,t){return r?r.getProcessManager(e,t):null}function s(e){return r?r.getCurrentProcessManagerWithoutInit(e):null}i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}))},PVDM:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return r}));const r="msdyn_forecastinstance";function n({dispatch:e,getState:t},i){return new Promise((e,t)=>{Xrm.WebApi.retrieveMultipleRecords(r,"?fetchXml=\n<fetch version='1.0' mapping='logical' distinct='true' >\n\t<entity name='msdyn_forecastinstance'>\n\n\t\t<attribute name='msdyn_forecastdefinitionid'/>\n\n\t\t<link-entity name='msdyn_forecastdefinition' from='msdyn_forecastdefinitionid' to='msdyn_forecastdefinitionid' alias='fd'>\n\t\t\t<attribute name='msdyn_forecastdefinitionname'/>\n\t\t\t<attribute name='modifiedon'/>\n\t\t</link-entity>\n\n\t\t<filter type='and'> \n\t\t\t<condition attribute='ownerid' operator='eq-userid'/> \n\t\t</filter>\n\t\t\n\t</entity>\n\n</fetch>\n").then(t=>{const i=[],r=t.entities,n=i.length;r.sort((e,t)=>new Date(t["fd.modifiedon"]).getTime()-new Date(e["fd.modifiedon"]).getTime());for(let e=0;e<r.length;e++){const t=`${n+e}:${r[e]._msdyn_forecastdefinitionid_value}`;i.push({value:t,text:r[e]["fd.msdyn_forecastdefinitionname"],isDefault:!1})}i.length>0&&(i[0].isDefault=!0),e(i)})})}function a(e,t,i){let r=null;const n=[];return n.push({attributeName:"msdyn_forecastdefinitionid",conditionOperator:0,value:e}),n&&n.length>0&&(r={conditions:n,filterOperator:1}),r}},R5Qn:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"c",(function(){return l})),i.d(t,"f",(function(){return u})),i.d(t,"a",(function(){return d})),i.d(t,"e",(function(){return p})),i.d(t,"d",(function(){return h}));var r=i("5Oca"),n=i("eXjw"),a=i("E3i9"),s=i("jq7Z");function o(e,t,i,r){var n,a,o;return null===(o=null===(a=null===(n=Object(s.a)(e,t))||void 0===n?void 0:n.__lookupKeys)||void 0===a?void 0:a[i])||void 0===o?void 0:o[r]}function l(e,t,i){const r=Object(a.b)(e,t);return r&&i&&r[i]?r[i]:null}function u(e,t,i,r){const n=o(e,r,t||"placeholderEtn",i);return n&&n.metadataKey}function c(e,t,i,r,n){const a=o(e,n,t||"placeholderEtn",i);return a&&a.dataKeys?a.dataKeys[r]:null}function d(e,t,i){const r=l(e,t,i||"placeholderEtn");return r&&r.view?r.view:null}function p(e,t,i,n,a){const s=function(e,t,i,r){const n=function(e,t){if(!e||!e.data||!e.data.lists)return null;return e.data.lists[t]}(e,t);if(n){if(r)return n.records;if(n.pages&&i>0){const e=n.pages[i];if(e)return n.records.slice(e.startIndex,e.startIndex+n.pageSize)}}return null}(e,t,i,a),o=[];if(!s)return null;for(const t of s){const i=Object(r.b)(t)(e,t.etn);i&&o.push(i)}return o}function h(e,t){const i=Object(r.n)(e,t);return i?i.initialized:n.a.Uninitialized}},S6h3:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e,t){if(!e||!e.data||!t)return null;const i=e.data;if(!i.timelineWalls)return null;const r=i.timelineWalls[t];return r||null}function n(e,t,i){if(!e||!e.data||!t)return null;const r=e.data;if(!r.timelineWalls)return null;const n=r.timelineWalls[t];return n?n.requestStatusMap[i]?n.requestStatusMap[i].status:0:null}function a(e,t){if(!e||!e.data||!t)return{};const i=e.data;if(!i.timelineWalls)return{};const r=i.timelineWalls[t];return r&&r.entityRecentItems?r.entityRecentItems:{}}function s(e,t){if(!e||!e.data||!t)return!0;const i=e.data;if(!i.timelineWalls)return!0;const r=i.timelineWalls[t];return r?r.isMetadataRetrievalError:void 0}i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return s}))},SoKF:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var r=i("+BIz"),n=i("tICD"),a=i("YxC/"),s=i("EY5k"),o=i("uNLT"),l=i("dHD5"),u=i("i1f0"),c=i("LbMF"),d=i("arV0"),p=i("odYE"),h=i("+pAH"),m=i("qpML"),g=i("Lyxw"),f=i("3/02");function b(e){return{type:"form.cancelInprogressFileImageUpload.async",execute({dispatch:t,getState:i}){const r=Object(l.j)(i(),e),n=i(),a=Object(g.c)(n,f.Wb)&&Object(g.c)(n,f.nb),s=Object(g.c)(n,f.Yb)&&Object(g.c)(n,f.nb),o=Object(u.fb)(n,{id:e},r),b=a?Object(c.f)(n,o.EntityLogicalName,"file"):{},y=s?Object(c.f)(n,o.EntityLogicalName,"image"):{},v=Object.assign(b,y),O=Object(u.eb)(n,e,r),_=Object(d.g)(n,e);if(Object.keys(v).length>0)for(const e in O){const i=O[e].dataFieldName;if(v[i]&&_&&_.id&&i){const e=new p.a(o.EntityLogicalName,_.id,i);t(Object(h.b)(e,i,m.b.Cancelled))}}return Promise.resolve()}}}var y=i("1fn7"),v=i("0kGT");function O(e,t,i){const l=[{name:"message",value:t}];return{type:"show.unsaved.changes.dialog.async",execute:({dispatch:u,getState:c},p,h)=>u(Object(s.e)(_)).then(()=>{const s=p.TraceManager.getTracer("Forms.UnsavedChangesDialog"),h=Object(g.a)(c(),f.de),m=Object(v.b)(c()),{header:O,message:P,ok:S,cancel:w}=function(e,t){const i=Object(g.a)(e,f.de),r=Object(v.b)(e),n=Object(d.m)(e,t),s=Object(a.e)(e,_);if(r)return n?{header:Object(a.c)(s,"UnSavedChanges_TitleUpdated"),message:Object(a.c)(s,"Discard_Message_Create")||"Are you sure you want to discard this new record?",ok:Object(a.c)(s,"Button_Label_Keep_Editing")||"Keep editing",cancel:Object(a.c)(s,y.b)}:{header:Object(a.c)(s,"UnSavedChanges_TitleUpdated"),message:Object(a.c)(s,"Discard_Message_Edit")||"Are you sure you want to discard your changes?",ok:Object(a.c)(s,"Button_Label_Keep_Editing")||"Keep editing",cancel:Object(a.c)(s,"Dialog_Button_DiscardChanges")};if(i)return{header:Object(a.c)(s,"UnSavedChanges_TitleUpdated"),message:Object(a.c)(s,"Web._forms.styles.FORM.crm.htc_TitleUpdated"),ok:Object(a.c)(s,"Button_Label_SaveContinue"),cancel:Object(a.c)(s,"Dialog_Button_DiscardChanges")};return{header:Object(a.c)(s,"UnSavedChanges_Title"),message:Object(a.c)(s,"Web._forms.styles.FORM.crm.htc_Title"),ok:Object(a.c)(s,"Dialog_Button_Ok"),cancel:Object(a.c)(s,"Button_Label_Cancel")}}(c(),e),I=null!=t?t:P,j=null!=i?i:O;return l.push({name:"unsavedChangesDialogMessageLabel",value:I}),u(Object(r.a)(I,{allowNativeDialog:!0},j,e,"",S,w)).then(t=>0===t.status?u(Object(n.a)(t.pageId)).then(t=>{if(t.value.confirmed){if(m)return!1;if(null!=e){if(h){return u(Object(o.e)(e,2)).then(()=>!0).catch(e=>!1)}s.info("Dispatched Cancellation for File/Image Inprogress Upload Due to discard changes",l),u(b(e))}return!0}return!("close"!==t.reason||!h)&&(null!=e&&(s.info("Dispatched Cancellation for File/Image Inprogress Upload due to discard changes",l),u(b(e))),!0)}):Promise.reject(t.error))}),getFailureParameters:(e,t)=>l}}const _=["UnSavedChanges_Title","UnSavedChanges_TitleUpdated","Web._forms.styles.FORM.crm.htc_Title","Web._forms.styles.FORM.crm.htc_TitleUpdated","Dialog_Button_Ok","Button_Label_SaveContinue","Button_Label_Cancel","Dialog_Button_DiscardChanges","UnSavedChangesWarning",y.b,"Button_Label_Continue","Button_Label_Keep_Editing","Discard_Message_Edit","Discard_Message_Create"]},TAgK:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));var r=i("dHD5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n="attribute.options.set";function a(e,t,i,a){const s=Object(r.v)(t);return{type:n,payload:a,meta:{pageId:e,contextKey:s,dataFieldName:i}}}},UqQu:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var r=i("SAYH"),n=i("5Oca"),a=i("pF61"),s=i("JP46"),o=i("bT7G"),l=i("i1f0"),u=i("odYE"),c=i("LbMF"),d=i("504W");function p(e,t,i,p,h){const m=[{name:"pageId",value:e}];return{type:"triggerdirtyonchangehandlers.async",execute({dispatch:g,getState:f},b,y){const v=f();if(!Object(a.n)(v,e)||Object(l.Eb)(f(),e)){const a=b.ScriptManager.getContainer(e).getEventManager();if(i||b.EventManager.ReportComponentFailure("Forms.TriggerDirtyOnChangeHandlers",new Error("Missing contextToken"),null,m),a){const f=function(e,t,i,a,p,h){const m=[];if(e&&t&&!Object(d.b)(i)&&!Object(d.b)(a)){const d=Object(n.h)(t,i,a),g=Object(l.ac)(e,p,h),f=d&&d.fields,b=new u.a(i,new r.a(a)),y=Object(c.d)(t,b.etn);for(const t in y){const i=y[t],r=Object(o.d)(e,g,b,i.LogicalName),n=f[i.LogicalName];Object(s.b)(r,n)&&m.push(i.LogicalName)}}return m}(t,v,p,r.a.toString(h),e,i);if(f)for(const e of f)g(a.runOnChange(i,e));b.EventManager.ReportComponentSuccess("Forms.TriggerDirtyOnChangeHandlers",m)}else b.EventManager.ReportComponentFailure("Forms.TriggerDirtyOnChangeHandlers",new Error("Missing eventManager"),null,m)}else b.EventManager.ReportComponentSuccess("Forms.TriggerDirtyOnChangeHandlers",m);return Promise.resolve()},getFailureParameters:(e,t)=>m}}},UuJw:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e.crossEntity="crossEntity",e.invalid="invalid",e.unreachable="unreachable",e.dirtyForm="dirtyForm",e.invalidProcess="invalidProcess"}(r||(r={}))},YGjz:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return n}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="systemuser",n="transactioncurrency"},YPtO:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class r{constructor(){this.getLinkedEntities=this.getLinkedEntities.bind(this),this.addLinkedEntity=this.addLinkedEntity.bind(this),this.clear=this.clear.bind(this),this._linkedEntityExpressions=new Array}retrieveDataSetLinking(){return{addLinkedEntity:this.addLinkedEntity.bind(this),getLinkedEntities:this.getLinkedEntities.bind(this)}}getLinkedEntities(){return this._linkedEntityExpressions}addLinkedEntity(e){this._linkedEntityExpressions.find(t=>t.name===e.name&&t.from===e.from&&t.to===e.to&&t.linkType===e.linkType&&t.alias===e.alias)||this._linkedEntityExpressions.push(e)}get length(){return this._linkedEntityExpressions.length}clear(){this._linkedEntityExpressions=[]}}},Yx7Y:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r=i("SAYH").a.EMPTY},"Z+6x":function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var r=i("7fV9");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class n{constructor(e,t,i){this.commanding={},this.hasError=e.error,this.errorMessage=e.errorMessage,this.innerError=e.innerError,this.working=e.loading,this.columns=i,this.sortedRecordIds=e.sortedRecordIds,this.records=t,this.sorting=e.sorting,this.filtering=e.filtering,this.linking=e.linking,this.paging=e.paging,this._dataSetParameter=e}refresh(){throw new Error("Not Replaced")}generateAdditionalAttributes(){throw new Error("Not Replaced")}add_OnDataSetRecordChange(e){throw new Error("Not Replaced")}remove_OnDataSetRecordChange(e){throw new Error("Not Replaced")}addOnDataSetUpdated(e){throw new Error("Not Replaced")}removeOnDataSetUpdated(e){throw new Error("Not Replaced")}getTitle(){return this._dataSetParameter.getTitle()}getViewId(){return this._dataSetParameter.getViewId()}getTargetEntityType(){return this._dataSetParameter.getTargetEntityType()}getLookupDataSet(e){throw new Error("Not Replaced")}setSelectedRecordId(e,t){throw new Error("Not Replaced")}setSelectedRecords(e){throw new Error("Not Replaced")}clearSelectedRecord(){throw new Error("Not Replaced")}getSelectedRecord(){throw new Error("Not Replaced")}retrieveRecordCommand(e,t,i,r,n){throw new Error("Not Replaced")}openDatasetItem(e){throw new Error("Not Replaced")}setSelectedRecordIds(e){throw new Error("Not Replaced")}getSelectedRecordIds(){throw new Error("Not Replaced")}clearSelectedRecordIds(){throw new Error("Not Replaced")}getCellImageInfo(e,t){throw new Error("Not Replaced")}retrieveLookupRecordsBySearchString(e,t,i){throw new Error("Not Replaced")}retrieveLookupRecordsByIds(e,t,i){throw new Error("Not Replaced")}}var a=i("SAYH"),s=i("455M"),o=i("NYBK"),l=i("VcAV"),u=i("JwRZ"),c=i("tHaS"),d=i("uhZ3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class p{constructor(e,t,i,r){this._errorMessage="",this._notifications={},this._columns=[],this._wrappedRecord=e,this._columnAliasNameMap=t,this._legacyRecordData=i,this._columns=r}getWrappedRecord(){return this._wrappedRecord}getRecordId(){return this._wrappedRecord.getRecordId()}getNamedReference(){return this._wrappedRecord.getNamedReference()}getPrimaryEntityLogicalName(){return this.getNamedReference().LogicalName}getErrorMessage(){return this._errorMessage}setErrorMessage(e){this._errorMessage=e}getNotification(e){return this._notifications[e]?this._notifications[e]:this._wrappedRecord.getValidationError(e)}setNotification(e,t){this._notifications[e]=t}_getColumnDataType(e){let t;const i=l.b(this._columnAliasNameMap[e])?e:this._columnAliasNameMap[e],r=this._columns.find(e=>e.name===i);return r&&(t=r.dataType),t}getValue(e){if(this._legacyRecordData){if(l.b(e))return null;if(l.b(this._columnAliasNameMap[e])||(e=this._columnAliasNameMap[e]),!this.getWrappedRecord().isValid(e)||null==this._legacyRecordData[e])return this._getColumnDataType(e)===s.a.LookupPartyList?Object(u.l)(this.getWrappedRecord().getValue(e)):this.getWrappedRecord().getValue(e);const t=this._legacyRecordData[e];if(t instanceof c.a){const i=this._getColumnDataType(e);if(i===s.a.OptionSet)return this._wrappedRecord.getValue(e);if(i===s.a.LookupSimple)return t.get_value()}return this._getColumnDataType(e)===s.a.LookupPartyList?Object(u.l)(this.getWrappedRecord().getValue(e)):this._getColumnDataType(e)===s.a.OptionSet?t.getValue("value"):t}return this._wrappedRecord.getValue(e)}getFormattedValue(e){return this._wrappedRecord.getFormattedValue(e)}setValue(e,t){throw new Error("Not replaced")}save(e){return this._wrappedRecord.save(e)}isDirty(){return this._wrappedRecord.isDirty()}isRecordValid(){return!this._errorMessage&&this._wrappedRecord.isRecordValid()}isEditable(e){return this._wrappedRecord.isEditable(e)}isSecured(e){return this._wrappedRecord.isSecured(e)}isReadable(e){return this._wrappedRecord.isReadable(e)}isValid(e){return this._wrappedRecord.isValid(e)}getFieldRequiredLevel(e){return this._wrappedRecord.getFieldRequiredLevel(e)}reformatValue(e){return this._wrappedRecord.reformatValue(e)}getCurrencyDecimalPrecision(e){return this._wrappedRecord.getCurrencyDecimalPrecision(e)}tryValidateColumns(e){var t;null===(t=this._columns)||void 0===t||t.forEach(t=>{var i;if(-1===(null===(i=t.name)||void 0===i?void 0:i.indexOf("."))&&t.name!==e&&!t.isHidden&&t.order>=0){const e=this.getValue(t.name);Object(d.b)(e)&&this._wrappedRecord.setValue(t.name,e)}})}}var h=i("odYE"),m=i("5Oca"),g=i("5ZBI"),f=i("j6Db"),b=i("P6DH"),y=i("bT7G"),v=i("Lyxw"),O=i("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const _=f.a+".Models.DataSet.LegacyDataSetObjectWrapper";class P{constructor(e,t=null,i){this._wrapper=null,this.previousDataSetParameter=null,this.previousLegacyDataSetParameter=null,this.controlMemoizedLegacyDataSetParameter=null,this._initializationActions=null,this._memoizedLookupWrappers={},this._recordChangeHandlers=[],this._dataSetChangeHandlers=[],this._previousRecords={},this._previousRowProperties={},this._previousHostOwnProps=null,this._previousPageInfo=null,this._isSetBlankValueValidationEnabled=!1,this.refreshDataSet=this.refreshDataSet.bind(this),this.gridRunOnLoad=this.gridRunOnLoad.bind(this),this._propKey=e,this._wrapper=new r.a(e,t,i),this._contextToken=i}_wrapDataSetRecords(e,t,i,r){const n={},s={};i&&i.forEach(e=>{s[e.alias]=e.name});const o=this._previousHostOwnProps.configuration.Parameters[this._propKey],l=t.getTargetEntityType();for(const u in t.records){let c,d;if(o.DataProvider)c=t.records[u],d=new p(c,null,null,i);else{c=t.records[u];const n=c.getNamedReference(),o=new h.a(l,a.a.parse(n.id),n.name),g=r[u],f={};g&&i&&i.forEach(t=>{f[t.name]=Object(m.m)(e,o.etn,t.name,g.fields[t.name])}),d=new p(c,s,f,i)}i&&i.forEach(e=>{if(e.alias){const t=e.alias;Object.assign(d,{[t]:d.getValue(t)})}}),n[u]=d}return n}setLookupDataSetAttributes(e,t){this._wrapper.setLookupDataSetAttributes(e,t)}getPreviousQueryKey(){return this._wrapper.getPreviousQueryKey()}getUpdatedPropertiesDic(){return this._wrapper.getLegacyUpdatedPropertiesDic()}clearUpdatedPropertiesDic(){this._wrapper.clearLegacyUpdatedPropertiesDic()}isValidParameterConfiguration(e){return this._wrapper.isValidParameterConfiguration(e)}retrieveDataSetObject(e,t,i,r,a){try{this._isSetBlankValueValidationEnabled=Object(v.c)(e,O.zd),null!==t&&(this._previousHostOwnProps=t),null!==r&&(this._previousPageInfo=r);const i=this._wrapper.retrieveDataSetObject(e,this._previousHostOwnProps,this._previousHostOwnProps.configuration,this._previousPageInfo);if(this.previousDataSetParameter&&i===this.previousDataSetParameter)return this.controlMemoizedLegacyDataSetParameter||this.previousLegacyDataSetParameter&&this.previousLegacyDataSetParameter.working||(this.controlMemoizedLegacyDataSetParameter=this.previousLegacyDataSetParameter),this.previousLegacyDataSetParameter;this.previousDataSetParameter=i;const a=this._previousHostOwnProps.configuration.Parameters[this._propKey],l=Object(b.qb)(e,this._wrapper.getCurrentViewId(a),null==t?void 0:t.id),c=a.DataProvider&&!l,d=c||!this._wrapper.getIsColumnFirstMetadataReady()?i.columns:Object(u.m)(e,a,u.o,l,this._wrapper.getViewIdDocumentDic()),p=this._wrapper.getRecordsListById(e,this._previousHostOwnProps,this._previousHostOwnProps.configuration),h=this._wrapDataSetRecords(e,i,i.columns,p);this._dependentOptionSetColumnStatus=Object(b.y)(e,this._contextToken,this._previousHostOwnProps.id);const m=new n(i,h,d);if(i.columns&&!c)for(const n of i.columns){const i=n.name,a=d.filter(e=>e.name===i);if(!a||0===a.length){const e=Object.assign({},n);d.push(e)}if(this._wrapper.isEditableGrid(e))switch(n.dataType){case s.a.LookupSimple:this._memoizedLookupWrappers[i]||(this._memoizedLookupWrappers[i]=new o.a(i,this._contextToken,r));const n=this._memoizedLookupWrappers[i];n.updateParameterConfiguration(e,t,r,m),this._initializationActions&&n.ensureViewInitialization(this._initializationActions.retrieveViewAction)}}return this.previousLegacyDataSetParameter=m,Object.defineProperty(this.previousLegacyDataSetParameter,"working",{get:()=>i.loading,set(e){i.loading=e},enumerable:!0,configurable:!0}),this.previousLegacyDataSetParameter}catch(e){if(a){const t=this._previousHostOwnProps.configuration.CustomControlId.substring(this._previousHostOwnProps.configuration.CustomControlId.lastIndexOf(".")+1);a.EventManager.ReportComponentFailure(t,e,e.errorMessage,[{name:"APIName",value:_+".retrieveDataSetObject"},{name:"entityTypeName",value:this._previousPageInfo?this._previousPageInfo.entityTypeName:""},{name:"pageType",value:this._previousPageInfo?this._previousPageInfo.pageType:""},{name:"CustomControlId",value:this._previousHostOwnProps.configuration.CustomControlId},{name:"FormId",value:this._previousHostOwnProps&&this._previousHostOwnProps.formInfo?this._previousHostOwnProps.formInfo.FormId:""}])}throw e}}updateControlMemoizedParameter(e,t,i,n){this.controlMemoizedLegacyDataSetParameter?Object.assign(this.controlMemoizedLegacyDataSetParameter,t):t.working||(this.controlMemoizedLegacyDataSetParameter=t),this._triggerDataSetUpdatedEvents(e,t,i,n),(i||this.getUpdatedPropertiesDic().hasOwnProperty(r.b))&&this.triggerOnDataSetUpdated()}_triggerDataSetUpdatedEvents(e,t,i,n){try{const s={},o=t.columns.map(e=>e.name);for(const l in t.records){if(i&&n&&n.toUpperCase()!==l.toUpperCase())continue;const c=t.records[l],d=c.getWrappedRecord(),p={},h={};for(const t of o)d.isValid(t)||(p[t]=d.getValidationError(t)),h[t]={isValid:d.isValid(t),requiredLevel:this._wrapper.getRecordFieldRequiredLevel(e,d,t),isEditable:this._wrapper.getRecordFieldIsEditable(e,d,t)};if(s[l]=h,this._previousRecords[l]){const t=this._previousRecords[l].getWrappedRecord();if(i){const t=this._previousRowProperties[l],i=Object(u.i)(e,this._wrapper,t,d,o);if(i.length){const e=this._createUpdateResult(2,c,i,p);this.triggerOnDataSetRecordChange(e)}const r=Object(u.h)(e,this._wrapper,t,d,o);if(r.length){const e=this._createUpdateResult(3,c,r,p);this.triggerOnDataSetRecordChange(e)}const n=Object(u.f)(t,d,o);if(n.length){const e=this._createUpdateResult(4,c,n,p);this.triggerOnDataSetRecordChange(e)}}const n=Object(u.g)(t,d,o);if(n.length){let t=null;if(i)this._wrapper.getCurrentSnapshotIdMap().hasOwnProperty(l)?(t=this._createUpdateResult(1,c,n,p),this.triggerOnDataSetRecordChange(t)):(t=this._createUpdateResult(10,c,n,p),this.triggerOnDataSetRecordChange(t));else if(!i)if(this._wrapper.getCurrentSnapshotIdMap().hasOwnProperty(l)){let i=1;if(a.a.tryParseOrNull(l)){const t=this._wrapper.getRecordSnapshotId(e,this._previousHostOwnProps,this._wrapper.getEntityTypeName(),a.a.parse(l));if(t){const r=Object(y.b)(e,t);if(r.activeChanges){for(const e of n)if(!r.activeChanges.hasOwnProperty(e)){i=10;break}}else i=10}else i=10}t=this._createUpdateResult(i,c,n,p),this.triggerOnDataSetRecordChange(t),10===i&&(this._wrapper.setLegacyUpdatedPropertiesDic(r.b,!0),this._wrapper.setLegacyUpdatedPropertiesDic(`${r.c}${l}`,!0))}else t=this._createUpdateResult(10,c,n,p),this.triggerOnDataSetRecordChange(t),this._wrapper.setLegacyUpdatedPropertiesDic(r.b,!0)}else if(t.isDirty()&&!d.isDirty()){const e=this._createUpdateResult(10,c,n,p);this.triggerOnDataSetRecordChange(e)}}}this._wrapper.clearCurrentSnapshotIdMap(),this._previousRecords=t.records,this._previousRowProperties=s}catch(e){const t=[];t.push({name:"APIName",value:_},{name:"fromSetValue",value:i},{name:"fromSetRecordId",value:n}),g.a.error(_+": _triggerDataSetUpdatedEvents encountered error: "+e.message,t)}}setWrapperLoadingFlag(e){this._wrapper.getLatestData().loading=e,this._wrapper.setRefreshingStart()}getLatestData(){return this.previousLegacyDataSetParameter}setControlReRender(e){this._wrapper.setControlReRender(()=>{this.previousLegacyDataSetParameter.working=this._wrapper.getLatestData().loading,this.previousLegacyDataSetParameter.hasError=this._wrapper.getLatestData().error;const t=this._wrapper.getLatestData().errorMessage;let i=t||"";t&&t.startsWith("0x")&&(i=t.substring(t.indexOf(" ")+1)),this.previousLegacyDataSetParameter.errorMessage=i,this.previousLegacyDataSetParameter.innerError=this._wrapper.getLatestData().innerError,e()})}linkToParameter(e,t){const i=t.refreshDataSetParameter;for(const i in e.records){const r=e.records[i],n=r.getWrappedRecord();this._wrapper.linkRecordAPI(n,t),r.setValue=this._recordSetValueAPI.bind(this,n.setValue.bind(n),t,i,r.tryValidateColumns.bind(r))}e.refresh=()=>{i(this,this._contextToken)},e.dependentOptionSetColumnStatus=this._dependentOptionSetColumnStatus,e.getLookupDataSet=this.getLookupDataSet.bind(this,e,t),e.generateAdditionalAttributes=this.generateAdditionalAttributes.bind(this),e.setSelectedRecordId=this._setSelectedRecordId.bind(this),e.setSelectedRecords=this._setSelectedRecords.bind(this),e.clearSelectedRecord=this._clearSelectedRecord.bind(this),e.getSelectedRecord=this._getSelectedRecord.bind(this,e),this._linkDataSetParameterEvents(e,t),e.openDatasetItem=t.openDatasetItem,e.setSelectedRecordIds=this._wrapper.setSelectedRecordIds.bind(this._wrapper),e.getSelectedRecordIds=this._wrapper.getSelectedRecordIds.bind(this._wrapper),e.clearSelectedRecordIds=this._wrapper.clearSelectedRecordIds.bind(this._wrapper);const r={},n=[];e.columns.forEach(e=>{r[e.name]=e,n.push(e.name)}),e.getCellImageInfo=this._getCellConditionalImage.bind(this,e.records,t.loadWebResource,r,n),e.addColumn=this._wrapper.addColumn.bind(this._wrapper),e.retrieveLookupRecordsBySearchString=this._retrieveLookupRecordsBySearchString.bind(this,t),e.retrieveLookupRecordsByIds=this._retrieveLookupRecordsByIds.bind(this,t),this._wrapper.linkPagingAPI(e.paging,t)}_retrieveLookupRecordsBySearchString(e,t,i,r){return e.retrieveLookupRecordsBySearchString(t,i,r)}_retrieveLookupRecordsByIds(e,t,i,r){return e.retrieveLookupRecordsByIds(t,i,r)}_getCellConditionalImage(e,t,i,r,n,a,s){const o=i[n];return e&&e[a]&&o?this._wrapper.getConditionalImage(t,r,e[a],o.imageProviderWebresource,o.imageProviderFunctionName,s):Promise.resolve(null)}_setSelectedRecordId(e,t){return this._wrapper.setSelectedRecordIds([e])}_setSelectedRecords(e){if(1===e.length&&this._memoizedLookupWrappers){const t={parentRecordId:e[0],parentRecordEntityTypeName:this.getEntityTypeName()};Object.keys(this._memoizedLookupWrappers).forEach(e=>{const i=this._memoizedLookupWrappers[e];i&&i.setParentRecordContext(t)})}return this._wrapper.setSelectedRecordIds(e)}_clearSelectedRecord(){return this._wrapper.clearSelectedRecordIds()}_getSelectedRecord(e){return e.records[this._wrapper.getSelectedRecordIds()[0]]}_recordSetValueAPI(e,t,i,r,n,a){return this._isSetBlankValueValidationEnabled&&r(n),e(n,a),t.updateControlMemoizedDataSet(this,t,i),Promise.resolve(!0)}generateAdditionalAttributes(){const e=Promise.resolve(!0);return e.always=t=>e.then(t,t),e.done=t=>e.then(t),e}_linkDataSetParameterEvents(e,t){e.add_OnDataSetRecordChange=this.addOnDataSetRecordChange.bind(this),e.remove_OnDataSetRecordChange=this.removeOnDataSetRecordChange.bind(this),e.addOnDataSetUpdated=this.addOnDataSetUpdated.bind(this),e.removeOnDataSetUpdated=this.removeOnDataSetUpdated.bind(this)}addOnDataSetRecordChange(e){this._recordChangeHandlers.push(e)}removeOnDataSetRecordChange(e){for(let t=0;t<this._recordChangeHandlers.length;t++)this._recordChangeHandlers[t]===e&&this._recordChangeHandlers.splice(t,1)}triggerOnDataSetRecordChange(e){for(const t of this._recordChangeHandlers)t(e)}addOnDataSetUpdated(e){this._dataSetChangeHandlers.push(e)}removeOnDataSetUpdated(e){for(let t=0;t<this._dataSetChangeHandlers.length;t++)this._dataSetChangeHandlers[t]===e&&this._dataSetChangeHandlers.splice(t,1)}triggerOnDataSetUpdated(){for(const e of this._dataSetChangeHandlers)e(this.getLatestData())}_createUpdateResult(e,t,i,r){let n=!0;return r&&Object.keys(r).length&&(n=!1),{resultType:e,recordId:t.getRecordId(),isSuccessful:n,isRecordSavedSuccessfully:n,affectedColumns:i,fieldErrorMessages:r||{},record:t}}resetControlMemoizedDataSet(){this.controlMemoizedLegacyDataSetParameter=null}getLookupDataSet(e,t,i){const r=this._memoizedLookupWrappers[i];return r.resetControlLockedDataSet(),t.retrieveDataSetLookupCellParameter(e,r,this._contextToken).then(e=>(r.linkToParameter(e,t),e))}gridRunOnLoad(e){this._wrapper.gridRunOnLoad(e)}refreshDataSet(e,t,i){return this._wrapper.refreshDataSet(e,t,i).then(()=>this)}ensureDataInitialization(e){return this._initializationActions=e,this._wrapper.ensureDataInitialization(e)}applyDataSetInputs(e){return this._wrapper.applyDataSetInputs(e)}getParameterManifestType(){return this._wrapper.getParameterManifestType()}getEntityTypeName(){return this._wrapper.getEntityTypeName()}getUpdateFlag(){return this._wrapper.getUpdateFlag()}}},ZXdP:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return c}));var r=i("i1f0"),n=i("SoKF"),a=i("uNLT"),s=i("arV0"),o=i("E8F2"),l=i("9wSR");function u(e,t){const i=[];return{type:"configure.save.async",sync:!0,execute({dispatch:u,getState:c},m,g){const f=h(c(),e);p(i,f,g),f&&u(d(e,t)),m.Router.registerPreNavigationHandler(d=>new Promise(p=>{Object(l.g)(e);const h={id:e};!Object(r.Db)(d,h,t)&&Object(r.Nb)(d,h.id,t)?f&&!Object(s.m)(d,e)?u(Object(a.e)(e,2,!1)).then(t=>{p(!!t||u(Object(n.a)(e)))},t=>{Object(o.h)(c(),e,t,i,m,"Forms.ConfigureSave.Navigate.Save"),p(u(Object(n.a)(e)))}):p(u(Object(n.a)(e))):p(!0)}),e)},getFailureParameters:(e,t)=>(Object(o.a)(e,i),i)}}function c(e,t){return{type:"configure.save.async",sync:!0,execute({dispatch:i,getState:r},n,a){h(r(),e)&&(i(Object(l.g)(e)),i(d(e,t)))}}}function d(e,t){let i=[];return{type:"configure.save.async",sync:!0,execute({dispatch:n,getState:s},u,c){l.f[e]=setTimeout((function d(){if(Object(r.Nb)(s(),e,t)&&!Object(r.mb)(s(),{id:e},t)){const t=n(Object(a.c)(e));t&&t.then(e=>{},t=>{!function(e){return e&&(2200000004===e.errorCode||2200000005===e.errorCode||2200000006===e.errorCode||2200000007===e.errorCode)}(t)?n(Object(l.e)(e)):n(Object(l.g)(e));const a=Object(r.Qc)(s());i=[],p(i,a,c),Object(o.h)(s(),e,t,i,u,"Forms.ConfigureSave.AutoSave")})}l.f[e]=setTimeout(d,Object(r.l)(s(),e))}),Object(r.l)(s(),e))}}}function p(e,t,i){e.push({name:"CorrelationId",value:i.correlationId},{name:"ContextId",value:i.contextId},{name:"ActionStack",value:i.stack},{name:"autoSaveEnabled",value:t})}function h(e,t){return Object(r.Qc)(e)&&!Object(r.Eb)(e,t)}},Zzxs:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"c",(function(){return n})),i.d(t,"a",(function(){return a}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="nf_serverValidationError",n="nf_formsyncerrornotificationId",a="nf_duplicateDetectionValidationError"},aFKs:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("455M"),n=i("errb");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function a(e,t){switch("number"==typeof t&&(t=t.toString()),t=t.toUpperCase(),e=e.toUpperCase()){case"boolean".toUpperCase():return r.a.TwoOptions;case"customer".toUpperCase():return r.a.LookupCustomer;case"datetime".toUpperCase():return t===n.a.dateTime.toUpperCase()?r.a.DateAndTimeDateAndTime:r.a.DateAndTimeDateOnly;case"decimal".toUpperCase():return r.a.Decimal;case"double".toUpperCase():return r.a.FP;case"integer".toUpperCase():return t===n.a.duration.toUpperCase()||"1"===t?r.a.WholeDuration:t===n.a.language.toUpperCase()||"3"===t?r.a.WholeLanguage:t===n.a.timeZone.toUpperCase()||"2"===t?r.a.WholeTimeZone:r.a.WholeNone;case"lookup".toUpperCase():return t===n.a.regarding.toUpperCase()?r.a.LookupRegarding:r.a.LookupSimple;case"memo".toUpperCase():return r.a.Multiple;case"money".toUpperCase():return r.a.Currency;case"owner".toUpperCase():return r.a.LookupOwner;case"partylist".toUpperCase():return r.a.LookupPartyList;case"picklist".toUpperCase():case"status".toUpperCase():return r.a.OptionSet;case"multiselectpicklist".toUpperCase():return r.a.MultiSelectPicklist;case"string".toUpperCase():return t===n.a.email.toUpperCase()?r.a.SingleLineEmail:t===n.a.phone.toUpperCase()?r.a.SingleLinePhone:t===n.a.text.toUpperCase()?r.a.SingleLineText:t===n.a.textArea.toUpperCase()?r.a.SingleLineTextArea:t===n.a.tickerSymbol.toUpperCase()?r.a.SingleLineTickerSymbol:t===n.a.url.toUpperCase()?r.a.SingleLineURL:r.a.SingleLineText;case"entityname".toUpperCase():return r.a.EntityNameOptionSet;default:return""}}},blB4:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e.success="success",e.crossEntity="crossEntity",e.beginning="beginning",e.end="end",e.invalid="invalid",e.dirtyForm="dirtyForm",e.stageGate="stageGate",e.invalidProcess="invalidProcess"}(r||(r={}))},dyr5:function(e,t,i){"use strict";i.d(t,"d",(function(){return l})),i.d(t,"a",(function(){return u})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return d}));var r=i("NAAR"),n=i("NjDY"),a=i("Lyxw"),s=i("69Qu"),o=i("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function l(e,t,i,n,a=null){const s=t.XrmObject;let o=null!=a?a:"",l="NA",u="NA",c=!0;try{e&&e.reason&&(e.reason.get_textStatus()===r.h.Forbidden&&(c=!1),l=null!=e.reason.get_organizationServiceFault().get_innerFault().get_callStack()?e.reason.get_organizationServiceFault().get_innerFault().get_callStack():"NA",u=null!=e.reason.get_textStatus()?e.reason.get_textStatus():"NA",o=null!=e.reason.get_message()?e.reason.get_message():e.reason.get_organizationServiceFault().get_messages().get_Items().toString())}catch(e){o=e.message}try{c&&s&&s.Reporting&&s.Reporting.reportFailure(i,{name:"error",message:o},"",[{name:"Action",value:n},{name:"StackTrace",value:l},{name:"Status",value:u}])}catch(e){}}function u(e,t){const i=Object(n.x)(e);return!!i.enableActivitiesTimeLinePerfImprovement&&(i.enableActivitiesTimeLinePerfImprovement&t)===t}function c(e){return!Object(s.b)(e)&&Object(a.a)(e,r.t.TimelineWallNotesOffline)}function d(e){return Object(a.a)(e,r.t.TimelineWallKeywordSearch,o.h)}},fKWG:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e[e.DAY=0]="DAY",e[e.WEEK=1]="WEEK",e[e.MONTH=2]="MONTH",e[e.QUARTER=3]="QUARTER",e[e.YEAR=4]="YEAR",e[e.FISCAL_PERIOD=5]="FISCAL_PERIOD",e[e.FISCAL_YEAR=6]="FISCAL_YEAR"}(r||(r={}))},fSnw:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("r0As"),n=i("kSDG"),a=i("yTPE");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s extends a.a{setupAggregationQueries(){if(!this.initialized)throw new Error("ChartDataSetQueryDecorator has not been initialized.");if(this.isWebResourceChart)return;this.dataDefinition.buildCategory();const e=this.viewDefinition;if(!this.dataDefinition.isOrderPresent()&&e.orderByAttributes.length>0){const t=e.orderByAttributes[0],i=this.dataDefinition.entityExpression;if(i.hasAggregate)for(let e=0;e<i.groupByAttributes.length;e++){const a=i.groupByAttributes[e];if(a.attributeName===t.name){Object(r.h)(i,Object(n.a)(a.attributeName,a.aliasName,i),!0,t.descending,-1);break}}else Object(r.h)(i,Object(n.a)(t.name,t.aliasName,i),!1,t.descending,-1)}Object(r.i)(this.dataDefinition.entityExpression)}}},g6bs:function(e,t,i){"use strict";i.d(t,"a",(function(){return D})),i.d(t,"b",(function(){return T})),i.d(t,"c",(function(){return F})),i.d(t,"f",(function(){return E}));var r=i("Lyxw"),n=i("SAYH"),a=i("i1f0"),s=i("bT7G"),o=i("sX6v"),l=i("dHD5"),u=i("WY/A"),c=i("Dea/"),d=i("odYE"),p=i("iZ7K"),h=i("5Oca"),m=i("xMtD"),g=i("CPoS"),f=i("arV0"),b=i("PUjk"),y=i("LbMF"),v=i("4Us1"),O=i("AFlp"),_=i("k1f1"),P=i("ycdb"),S=i("TBkx"),w=i("FZDd"),I=i("fh2P");i.d(t,"d",(function(){return I.a})),i.d(t,"e",(function(){return I.b}));var j=i("69Qu"),C=i("sZ+8");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function D(e,t,i,v,O){if(!(e&&t&&i&&v&&O))return null;let _=null;try{const P=Object(f.g)(t,O);if(!P)return i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","page input is null."),null;if(!Object(a.Kb)(t,O)){const e=Object(b.b)(O,P);return e&&e.generateBPFInstanceSnapshotId()}if(!Object(r.c)(t,"FCB.SplitBPFEntityAndParticipatingEntityCreates"))return null;const S=Object(a.ac)(t,O,v),D=Object(s.b)(t,S);if(!D||!D.identifier||!D.identifier.etn)return i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","primary entity snapshot is invalid."),null;const E=D.identifier.etn;let F=D.identifier.id;const N=Object(h.d)(t,E);if(n.a.isNullOrEmpty(N))return null;const R=Object(g.a)(t,N);if(!R)return i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",`The BPF unique name is null for processId - ${N}.`),null;if(R===E)return i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",`This is immersive BPF with processId - ${N}.`),null;if(!Object(j.b)(t)&&!Object(C.l)(t,R))return null;const A={processid:{id:n.a.EMPTY}};if(Object(I.b)(P)||Object(I.a)(t,D.identifier,O))return e(Object(o.b)(t,S,A)),null;n.a.isNullOrEmpty(F)?F=n.a.newGuid():i.EventManager.ReportComponentSuccess("ProcessManagerHelper.AlreadyPopulatePrimaryEntityId"),e(Object(o.b)(t,S,A,F));const k=Object(m.d)(t,N);if(n.a.isNullOrEmpty(k))return i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","The first stage id is null."),null;_=function(e,t,i,r,a,s,o,h,m){const g=function(e,t,i,r,n,a){if(!i||!r||!a)throw new Error("Primary entity and Active stage cannot be null or undefined.");const s={activestageid:{reference:new d.a("processstage",a),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:a.guid}},traversedpath:{value:a.guid.toString(),timestamp:new Date,validationResult:{isValueValid:!0,errorMessage:null,errorId:null,userInput:""}},processid:{reference:new d.a("workflow",r),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}}};return function(e,t,i,r,n,a){if(!(e&&t&&i&&r&&n))return;const s=T(t,i,a);s&&(e[s.ReferencingAttribute]={reference:new d.a(i,r),timestamp:new Date,validationResult:{errorId:null,errorMessage:null,isValueValid:!0,userInput:null,isOfflineSyncError:!1}})}(s,e,t,i,r,n),s}(t,a,s,o,h,m);if(!function(e,t,i,r){if(!t||!i||!r)return!1;const n=Object(y.g)(e,i,Object.keys(r));if(n&&n.length>0)return t.EventManager.ReportComponentFailure("ProcessManagerHelper._validateBPFEntityAttributes",`BPF(${i}) - These attributes are missing metadata: ${n.join()}`),!1;return!0}(t,i,h,g))return h&&e(Object(w.f)(h,!0,[])).then(()=>{Object(p.h)(t,h)||i.EventManager.ReportComponentFailure("ProcessManagerHelper._createBPFEntitySnapshot",`Retrieve BPF(${h}) failed.`)}),null;const f=Object(l.x)(r),b=Object(u.b)(t,new d.a(h,n.a.EMPTY),g,f,c.a.Create),v=b.payload.snapshotId;return e(b),v}(e,t,i,v,E,F,N,R,k),_?i.EventManager.ReportComponentSuccess("ProcessManagerHelper.generateBPFInstanceSnapshotId"):i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId","The BPF entity snapshot id is null.")}catch(e){i.EventManager.ReportComponentFailure("ProcessManagerHelper.generateBPFInstanceSnapshotId",e)}return _}function E(e,t,i,r){if(e&&r&&t&&i){const a={processid:{id:n.a.EMPTY}};r(Object(o.b)(e,t,a,i))}}function T(e,t,i){const r=Object(p.C)(e,t);if(!r)return null;for(const e in r){const n=r[e];if(n.ReferencedEntity===t&&n.ReferencingEntity===i)return n}return null}function F(e,t,i,a,s,o){const l=new d.a(a,n.a.EMPTY),u=Object(h.d)(e,a);return Object(r.c)(e,"FCB.SplitBPFEntityAndParticipatingEntityCreates")&&!n.a.equals(u,n.a.EMPTY)?t(Object(v.a)(n.a.EMPTY,l)).then(r=>{let a="";if(r&&r.businessProcessFlows){const s=r.businessProcessFlows[n.a.toString(u)];if(s&&(t(Object(O.b)(s.businessProcessFlowId,l)),t(Object(_.b)(n.a.EMPTY,l)),t(Object(P.b)(!1,l)),a=s.businessProcessFlowUniqueName,a)){const r=Object(y.g)(e,a,["activestageid","traversedpath","processid"]);r&&r.length>0&&t(Object(w.f)(a,!0,[])).then(()=>{Object(p.h)(e,a)||i.EventManager.ReportComponentFailure("ProcessManagerHelper.retrieveBPFEntity",`Retrieve BPF(${a}) failed.`)})}}return s&&s.info("retrieveBusinessProcessFlow completed.",o),i.EventManager.ReportComponentSuccess(`ProcessManagerHelper.retrieveBusinessProcessFlow for ${n.a.toString(u)}(${a})`),Promise.resolve(r)}).catch(e=>(o.push({name:"retrieveDefaultBPFForQuickCreateForm.Reason",value:Object(S.e)(e)}),i.EventManager.ReportComponentFailure("ProcessManagerHelper.retrieveBusinessProcessFlow",e,null,o),Promise.resolve(null))):Promise.resolve(null)}},hvSt:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e[e.Active=1]="Active",e[e.Finished=2]="Finished",e[e.Aborted=3]="Aborted"}(r||(r={}))},hwt8:function(e,t,i){"use strict";i.d(t,"e",(function(){return h})),i.d(t,"f",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"g",(function(){return f})),i.d(t,"c",(function(){return u})),i.d(t,"b",(function(){return c}));var r=i("lcrw"),n=i("zh0k"),a=i("Xd5/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const s=/(.*)(((0|#),)?(0|#)+,*(\.(0|#)+)?)(.*)/,o=/(((0|#),)?(0|#)+,*(\.(0|#)+)?)/,l=/^(c|C|d|D|f|F|n|N|p|P)\d*$/;function u(e,t,i,r){return i?d(i)?Object(n.b)(e,i,t):p(i)?g(e,f(i),t):void 0:r&&Object(a.C)(r)?("money"===r.controlAttributes.Type&&(r.controlAttributes.Type="float",r.controlAttributes.Precision=t.numberFormat.CurrencyDecimalDigits),Object(a.b)(e,r)):e.toString()}function c(e,t,i){return isNaN(e.valueOf())?"":Object(r.a)(e,i,t)}function d(e){return l.test(e)}function p(e){return s.test(e)}function h(e){if(p(e)){const{prefix:t,suffix:i}=b(e);return t.indexOf("%")>=0&&m(t).isSingleQuoted||i.indexOf("%")>=0&&m(i).isSingleQuoted}return!1}function m(e){if(!e)return{isSingleQuoted:!1};let[t,i]=[0,e.length-1];for(;t<i;)if(" "!==e.charAt(t)){if(" "!==e.charAt(i)){if("'"===e.charAt(t)&&"'"===e.charAt(i)){return{isSingleQuoted:!0,stripQuote:e.slice(0,t)+e.slice(t+1,i)+e.slice(i+1)}}break}i--}else t++;return{isSingleQuoted:!1}}function g(e,t,i){if(!t||!i)return e.toString();let r=t.positiveValueFormat;if(e<0&&t.negativeValueFormat?r=t.negativeValueFormat:0===e&&t.zeroValueFormat&&(r=t.zeroValueFormat),!r||!i)return e.toString();e*=Math.pow(10,r.numberScalingFactor);let a=Object(n.a)(Math.abs(e),r.decimalPrecision,i.numberFormat.NumberGroupSizes,i.numberFormat.NumberGroupSeparator,i.numberFormat.NumberDecimalSeparator);return 0==+a&&(r=t.zeroValueFormat?t.zeroValueFormat:r,a="0",0===r.minNumberOfIntegerDigits&&(a="")),r.integerZeroPlaceHolder&&r.minNumberOfIntegerDigits&&(a=function(e,t,i){const[r,a]=e.split(".");return null==a?Object(n.c)(r,t,!0):Object(n.c)(r,t,!0)+"."+a}(""+a,r.minNumberOfIntegerDigits)),a=function(e,t,i){const r=e.indexOf("."),n=-1===r?0:e.length-r-1;let a=0;if(i)t-n>0&&(-1===r&&(e+="."),e+="0".repeat(t-n));else{for(let t=0;t<n&&"0"===e.charAt(e.length-1-t);t++)a++;"."===e.charAt(e.length-a-1)&&a++}return e.substring(0,e.length-a)}(a,r.decimalPrecision,r.decimalZeroPlaceholder),e<0&&r.addNegativeSymbol&&(a=i.numberFormat.NegativeSign+a),r.prefix+a+r.suffix}function f(e){if(!e||!p(e))return null;const t=e.split(";"),i={};return i.positiveValueFormat=y(t[0]),i.negativeValueFormat=y(t[1]),i.negativeValueFormat&&(i.negativeValueFormat.addNegativeSymbol=!1),i.zeroValueFormat=y(t[2]),i}function b(e){let[t,i]=e.replace(o,";").split(";");return t=t&&"#"!==t.trim()&&"0"!==t.trim()?t:"",i=i&&"#"!==i.trim()&&"0"!==i.trim()?i:"",{prefix:t,suffix:i}}function y(e){if(null==e)return null;let t=!1,i=0,r=!1,n=0,a=0,s=!1;const{prefix:o,suffix:l}=b(e);o&&(e=e.substring(o.length)),l&&(e=e.substring(0,e.length-l.length));let u=!1,c=0,d=!1,p=!1;for(let n=0;n<e.length;n++){switch(e.charAt(n)){case"0":u||p&&(p=!1,c=0,t=!0),c++,d=!0;break;case"#":u?c++:p&&(p=!1,c=0,t=!0);break;case",":p=!0;break;case".":i=c,r=d,u=!0,d=!1,c=0;break;default:continue}0!==c&&u?(a=c,s=d):0!==c&&(i=c,r=d)}n=0;let h=e;u&&(h=e.split(/\.(.+)/)[0]);for(let e=h.length-1;e>0&&","===h.charAt(e);e--)n+=-3;const{isSingleQuoted:g,stripQuote:f}=m(o);n+=g?0:2*(o.split("%").length-1);const{isSingleQuoted:y,stripQuote:v}=m(l);return n+=y?0:2*(l.split("%").length-1),{decimalPrecision:a,decimalZeroPlaceholder:s,useGroup:t,minNumberOfIntegerDigits:i,integerZeroPlaceHolder:r,numberScalingFactor:n,prefix:f||o,suffix:v||l,addNegativeSymbol:!0}}},j9v9:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i("7fV9"),n=i("SAYH"),a=i("d0w6"),s=i("455M"),o=i("5ZBI"),l=i("j6Db"),u=i("JwRZ"),c=i("DU5H"),d=i("KBcj"),p=i("5ipV"),h=i("Uv1Y"),m=i("LbMF"),g=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const f=l.a+".Models.Lookups.MultiEntityTypeLookupInternalDataSetWrapper";class b extends r.a{constructor(e,t,i,r,n){super(t,null,i),this._previousAvailableViewIds=null,this._previousAvailableViews=null,this._selectedViewName=null,this.refreshDataSet=this.refreshDataSet.bind(this),this._ensureViewId=this._ensureViewId.bind(this),this.dataSetClass=3,this.targetEntity=e,this._viewId=r,this._viewType=n||a.b.savedview}_retrieveParameterDefinition(e,t,i){return Object.assign(Object.assign({},this.previousDataSetDefinition),{Type:s.a.Grid,ViewId:t,TargetEntityType:e,ExtraFilters:i})}_ensureViewId(e,t){return this.shouldUseLookupService()&&!this._viewId?(this._viewId=this.lookupViewId,Promise.resolve(this._viewId)):e(this.targetEntity,a.a.LOOKUP_VIEW,this._viewType).then(i=>{const r=n.a.toString(i);if(this._viewId&&r!==this._viewId){const i=e(this.targetEntity,a.a.LOOKUP_VIEW,this._viewType,new n.a(this._viewId)).then(e=>!!t||this._viewId).catch(e=>(o.a.error(l.a+": _ensureViewId encountered error, "+e),this.setErrorStatus(e),!1));return t?Promise.resolve(!0):i}return this._viewId=r,!!t||this._viewId}).catch(e=>(o.a.error(l.a+": _ensureViewId encountered error, "+e,[{name:"APIName",value:f}]),this.setErrorStatus(e),!1))}setErrorStatus(e,t){let i=e;const n=this.relevantQueryError();n&&t&&"function"==typeof t&&(i=Object(g.b)(t(),n.message),i?n.parameter&&(i+=" "+n.parameter):i=r.a.UnknownErrorMessage),super.setErrorStatus(i,t)}refreshDataSet(e,t,i){let r=null;const n=this.getEntityTypeName()||this.targetEntity;this.shouldUseLookupService()&&(this.lookupServiceEnabled=!1);try{t.startCustomFilter(this._pageId,this._controlName,this.contextToken),t.runPreSearch(this._pageId,this._controlName),t.runSetAdditionalParams(this._pageId,this._controlName),t.endCustomFilter(this._pageId,this._controlName,this.contextToken)}catch(e){}if(this.lookupCustomFilters=Object(c.a)(e(),this._pageId,this.contextToken,this.controlId,n),this.meFilterEnabled&&(Object(m.a)(e(),n,"ownerid")?this.lookupCustomFilters.push(u.a):r=t.getEntityMetadataAction(n,["ownerid"])),this.shouldUseQuickFindViewForLookup(e())){const e=this.filteringObj&&this.filteringObj.getFilter();this.lookupFilterString=e&&e.conditions&&e.conditions[0]&&e.conditions[0].value,this.lookupFilterString=this.lookupFilterString&&this.lookupFilterString.replace(/%$/g,"").replace(/\%/g,"*")}return this._ensureViewId(t.retrieveViewAction).then(()=>(super.updatePreviousDataSetParameterDefinition(this._retrieveParameterDefinition(this.targetEntity,this._viewId,this._passInConfigExtraFilters)),this.meFilterEnabled&&r?r.then(()=>(Object(m.a)(e(),n,"ownerid")&&this.lookupCustomFilters.push(u.a),super.refreshDataSet(e,t,i))):super.refreshDataSet(e,t,i)))}linkToParameter(e,t){super.linkToParameter(e,t),e.generateAdditionalAttributes=this._ensureViewId.bind(this,t.retrieveViewAction,!0)}retrieveDataSetObject(e,t,i,r){if(this._pageId=t.id,this._controlName=Object(u.v)(t),i&&i.Parameters){const e=i.Parameters.value;if(this._passInConfigExtraFilters=[],e){this._controlName=this._controlName||e.Value,e.ExtraFilters&&(this._passInConfigExtraFilters=this._passInConfigExtraFilters.concat(e.ExtraFilters));const t=e.AdditionalTargetExtraFilters;t&&t.hasOwnProperty(this.targetEntity)&&(this._passInConfigExtraFilters=this._passInConfigExtraFilters.concat(t[this.targetEntity].slice(0)))}}const n=Object.assign(Object.assign({},i.Parameters[super.getPropKey()]),this._retrieveParameterDefinition(this.targetEntity,this._viewId,this._passInConfigExtraFilters)),a=Object.assign(Object.assign({},i),{Parameters:Object.assign(Object.assign({},i.Parameters),{[super.getPropKey()]:n})}),s=Object.assign(Object.assign({},t),{configuration:a}),o=super.retrieveDataSetObject(e,s,a,r);return this._updateAvailableViewIds(i,r,e,o),o}getPagingObject(){return this.pagingObj}updatePagingObject(){this.pagingObj.getHasNextPage()&&this.pagingObj.setPageLastIndex(this.pagingObj.getPageLastIndex()+1)}setViewId(e){this._viewId=e}updatePreviousOwnProps(e){this.previousOwnProps=e,this._pageId=e.id,this._controlName=Object(u.v)(e)}getRelationshipNameFromParameter(e){if(!e)return null;return e.FilterRelationshipName}_updateAvailableViewIds(e,t,i,r){let a=!1;const s=this._previousAvailableViewIds?this._previousAvailableViewIds.join():null,o=e.Parameters[this.getPropKey()],l=this.createLookupParameter(r,o),u=t;let c=null;const p=u&&u.viewIds&&u.viewIds.length>0?u.viewIds.join():null;if(p&&s!==p?(c=u.viewIds,a=!0):o.AvailableViewIds&&s!==o.AvailableViewIds&&(c=o.AvailableViewIds.split(","),a=!0),a){this._previousAvailableViews=[],c.forEach(e=>{const t=Object(d.c)(i,new n.a(e));t&&this._previousAvailableViews.push(t)}),this._previousAvailableViewIds=c.map(e=>e.replace(/[\{\}]/gi,"").toLocaleLowerCase()),l.selectView=e=>{this._selectedViewName=e},l.availableViewNames=[];for(let e=0,t=this._previousAvailableViews.length;e<t;e++)this._previousAvailableViews[e]?l.availableViewNames.push(this._previousAvailableViews[e].title):l.availableViewNames.push("Unknown View")}}createLookupParameter(e,t){const i=new p.a(e,e.getViewId(),e.getTitle(),e.getTargetEntityType());return i.allowFilterOff=!!t.AllowFilterOff,i.disableQuickFind=!!t.DisableQuickFind,i.useMainFormDialogForCreate=!!t.UseMainFormDialogForCreate,i.useMainFormDialogForEdit=!!t.UseMainFormDialogForEdit,i.enableViewPicker=!1!==t.EnableViewPicker,i.targetEntityType=t.TargetEntityType,i.setMyRecordsOnlyFilter=this.setMyRecordsOnlyFilter.bind(this),i}retrieveView(e,t){let i;return this.previousDataSetDefinition&&this.previousDataSetDefinition.TargetEntityType?i=this.previousDataSetDefinition.TargetEntityType:this.previousDataSetDefinition&&this.previousDataSetDefinition.EntityName&&(i=this.previousDataSetDefinition.EntityName),i?t(i,a.a.LOOKUP_VIEW,a.b.savedview,e):(o.a.error(l.a+": retrieveView encountered error, Entity name is not specified for lookup",[{name:"APIName",value:l.a+".Models.Lookups.LookupSimpleObjectWrapper.retrieveView"}]),Promise.reject(new h.a("Entity name is not specified for lookup")))}getAvailableViews(){return this._previousAvailableViewIds||[]}getMissingDescriptorIds(){const e=[],t=this._previousAvailableViewIds?this._previousAvailableViewIds:[];for(let i=0;i<t.length;i++)this._previousAvailableViews&&0!==this._previousAvailableViews.length&&0!==this._previousAvailableViews.filter(e=>e.viewId&&e.viewId.guid===t[i]).length||e.push(new n.a(t[i]));return e}retrieveCurrentView(e,t){if(null!==this._previousAvailableViews&&null!==this._selectedViewName)for(let e=0,t=this._previousAvailableViews.length;e<t;e++)if(this._previousAvailableViews[e]&&this._previousAvailableViews[e].title===this._selectedViewName)return Promise.resolve(this._previousAvailableViews[e]);return super.retrieveCurrentView(e,t)}}},kSDG:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return a}));let r=0;function n(e,t,i,r){return{attributeName:e,aliasName:t,entity:i,dateTimeGrouping:r||null,hasAggregate:!1,hasGroupBy:!1,aggregateType:null}}function a(e,t){return r++,r>65535&&(r=0),String.format("{0}_{1}{2}_{3}",e,r,t,(new Date).getTime())}},lLEV:function(e,t,i){"use strict";i.d(t,"a",(function(){return se}));var r=i("455M"),n=i("y60j"),a=i("S6h3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class s{constructor(e){Object.assign(this,e)}getTimelineWallData(){throw new Error("Not Replaced")}getCommands(){throw new Error("Not Replaced")}getEntityAttributes(){throw new Error("Not Replaced")}}var o=i("LE5i"),l=i("zDpi"),u=i("NAAR"),c=i("69Qu"),d=i("ybGo"),p=i("E5qG"),h=i("37s6"),m=i("Lyxw"),g=i("FETf"),f=i("dyr5"),b=i("SRlt");function y(e){return{type:"SERIALIZE_RETRIEVE_PERSONAL_WALL_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_pageNumber(),a=e.get_pageSize(),s=i(),o=e.get_commentsPerPost(),l=e.get_startDate(),u=e.get_endDate(),c=e.get_type(),d=e.get_source(),p=e.get_sortDirection(),h=e.get_keyword()||null;return Promise.resolve(
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r,n,a,s,o,l,u){return{urlParameters:"posts/Microsoft.Dynamics.CRM.RetrievePersonalWall(PageNumber="+t+",PageSize="+i+",CommentsPerPost="+r+",StartDate="+n+",EndDate="+a+",Type="+s+",Source="+o+",SortDirection="+l+(Object(f.b)(e)&&u?",Keyword=@keyword)?@keyword="+encodeURIComponent("'"+u+"'"):")"),method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"}}}(s,n,a,o,l,u,c,d,p,h))}}}var v=i("iZ7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function O(e,t,i,r){return Object(f.b)(e)&&t?",Keyword=@keyword)?@tid="+_(i,r,e)+"&@keyword="+encodeURIComponent("'"+t+"'"):")?@tid="+_(i,r,e)}function _(e,t,i){if(null===e||null===t)return"null";return"{'@odata.id':'"+Object(v.o)(i,t)+"("+e.toString()+")'}"}function P(e){return{type:"SERIALIZE_RETRIEVE_RECORD_WALL_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_pageNumber(),a=e.get_pageSize(),s=i(),o=e.get_commentsPerPost(),l=e.get_startDate(),u=e.get_endDate(),c=e.get_type(),d=e.get_source(),p=e.get_sortDirection(),h=e.get_entity(),m=e.get_keyword();return Promise.resolve(function(e,t,i,r,n,a,s,o,l,u,c){return{urlParameters:"posts/Microsoft.Dynamics.CRM.RetrieveRecordWall(Entity=@tid,PageNumber="+t+",PageSize="+i+",CommentsPerPost="+r+",StartDate="+n+",EndDate="+a+",Type="+s+",Source="+o+",SortDirection="+l+O(e,c,u.Id,u.LogicalName),method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"}}}(s,n,a,o,l,u,c,d,p,h,m))}}}var S=i("fU7K");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function w(e,t,i,r){let n="null",a=!1;t&&t.LogicalName&&(n=function(e,t,i){if(null===e||null===t)return"null";return"{'@odata.id':'"+Object(v.o)(i,t)+"("+e.toString()+")'}"}(t.Id,t.LogicalName,e),e&&e.metadata&&e.metadata.entities&&e.metadata.entities[t.LogicalName]&&(a=e.metadata.entities[t.LogicalName].IsActivityParty));return{urlParameters:"activitypointers/Microsoft.Dynamics.CRM.RetrieveTimelineWallRecords(FetchXml=@xml,Target=@id,RollupType=@rollupType)?@id="+(-1===r&&a?null:n)+"&@xml='"+Object(S.CrmUrlEncode)(i)+"'&@rollupType="+r,method:"GET",additionalHeaders:{Accept:b.a,"Content-Type":"application/json; charset=utf-8",Prefer:"odata.include-annotations=*","OData-MaxVersion":"4.0","OData-Version":"4.0"}}}function I(e){return{type:"SERIALIZE_RETRIEVE_TIMELINE_WALL_RECORDS_REQUEST_ASYNC",execute({dispatch:t,getState:i},r){const n=e.get_target(),a=e.get_fetchXml(),s=i(),o=e.get_rollupType();return Promise.resolve(w(s,n,a,o))}}}var j=i("nxt5");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class C extends j.a{constructor(e){super("RetrievePersonalWall"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function D(e,t){return{type:"DESERIALIZE_RETRIEVE_PERSONAL_WALL_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>e.json().then(e=>new C(e.value))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class E extends j.a{constructor(e){super("RetrieveRecordWall"),this._entityCollection=e}get_entityCollection(){return this._entityCollection}}function T(e,t){return{type:"DESERIALIZE_RETRIEVE_RECORD_WALL_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>e.json().then(e=>new E(e.value))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class F extends j.a{constructor(e){super("RetrieveTimelineWallRecords"),this._timelineWallRecords=e}get_timelineWallRecords(){return this._timelineWallRecords}}function N(e,t){return{type:"DESERIALIZE_RETRIEVE_TIMELINE_WALL_RECORDS_RESPONSE_ASYNC",execute:({dispatch:t,getState:i},r)=>Promise.resolve(e.json().then(e=>new F(e.TimelineWallRecords)))}}var R=i("84PK"),A=i("hirD"),k=i("GD3x"),L=i("WRF3"),M=i("Mr6u"),x=i("5yoC");class V extends x.a{constructor(e,t,i){super(),this._fetchXml=null,this._rollupType=0,this._target=null,this._set_fetchXml(e),this._set_target(t),this._rollupType=i}get_name(){return"RetrieveTimelineWallRecords"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/7.1/Contracts"}get_target(){return this._target}_set_target(e){return this._target=e,e}get_fetchXml(){return this._fetchXml}_set_fetchXml(e){return this._fetchXml=e,e}get_rollupType(){return this._rollupType}}var B=i("sZ+8");class U extends x.a{constructor(e,t,i,r,n,a,s,o,l,u){super(),this._entity=null,this._pageNumber=0,this._pageSize=0,this._commentsPerPost=0,this._startDate=null,this._endDate=null,this._type=0,this._source=0,this._sortDirection=!1,this._entity=e,this._pageNumber=t,this._pageSize=i,this._commentsPerPost=r,this._startDate=n,this._endDate=a,this._type=s,this._source=o,this._sortDirection=l,this._keyword=u}get_name(){return"RetrieveRecordWall"}get_xmlNamespace(){return"http://schemas.microsoft.com/xrm/7.1/Contracts"}get_entity(){return this._entity}get_pageNumber(){return this._pageNumber}get_pageSize(){return this._pageSize}get_commentsPerPost(){return this._commentsPerPost}get_startDate(){return this._startDate}get_endDate(){return this._endDate}get_type(){return this._type}get_source(){return this._source}get_sortDirection(){return this._sortDirection}get_keyword(){return this._keyword}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class z extends x.a{constructor(e,t,i,r,n,a,s,o,l){super(),this._pageNumber=0,this._pageSize=0,this._commentsPerPost=0,this._startDate=null,this._endDate=null,this._type=0,this._source=0,this._sortDirection=!1,this._keyword=null,this._set_pageNumber(e),this._set_pageSize(t),this._set_commentsPerPost(i),this._set_startDate(r),this._set_endDate(n),this._set_type(a),this._set_source(s),this._set_sortDirection(o),this._set_keyword(l)}get_name(){return"RetrievePersonalWall"}get_pageNumber(){return this._pageNumber}_set_pageNumber(e){return this._pageNumber=e,e}get_pageSize(){return this._pageSize}_set_pageSize(e){return this._pageSize=e,e}get_commentsPerPost(){return this._commentsPerPost}_set_commentsPerPost(e){return this._commentsPerPost=e,e}get_startDate(){return this._startDate}_set_startDate(e){return this._startDate=e,e}get_endDate(){return this._endDate}_set_endDate(e){return this._endDate=e,e}get_type(){return this._type}_set_type(e){return this._type=e,e}get_source(){return this._source}_set_source(e){return this._source=e,e}get_sortDirection(){return this._sortDirection}_set_sortDirection(e){return this._sortDirection=e,e}get_keyword(){return this._keyword}_set_keyword(e){return this._keyword=e,e}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function W(e){return{type:"timelinewall.data.retrieve.async",execute({dispatch:t,getState:i},r){const n=r.DataSource.get_WebAPIService();let a=o.a.Data;return void 0!==e.queueTypeToRequestMap[o.a.Filters]&&null!==e.queueTypeToRequestMap[o.a.Filters]?a=o.a.Filters:void 0!==e.queueTypeToRequestMap[o.a.WhatsChanged]&&null!==e.queueTypeToRequestMap[o.a.WhatsChanged]?a=o.a.WhatsChanged:void 0!==e.queueTypeToRequestMap[o.a.MoreEmails]&&null!==e.queueTypeToRequestMap[o.a.MoreEmails]&&(a=o.a.MoreEmails),t(Object(g.n)(e,a)),t(function(e,t,i){return{type:"timelinewall.data.retrieve.nextpage.async",execute({dispatch:r,getState:n},a){const s=a.DataSource,l=n(),c=t,d=Object.keys(c.queueTypeToRequestMap).sort();let p=[];const h="FetchXML",m="FetchXMLs",b="PostImageFetchXml";if(i!==o.a.Data&&i!==o.a.MoreEmails&&(p=Object.keys(t.queueTypeToRequestMap[i].dataMap[m])),Object(f.c)(l)){if(Object(B.l)(l,u.b.Notes)&&Object(B.l)(l,u.b.User)&&c.queueTypeToRequestMap[g.g]&&c.queueTypeToRequestMap[g.g].isEnabled){const e=c.queueTypeToRequestMap[g.g].dataMap[h];return Xrm.WebApi.retrieveMultipleRecords(u.b.Notes,"?fetchXml="+e).then(e=>{r(Object(g.p)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:e.entities},t.controlId,g.g))},e=>{r(Object(g.p)({isError:!0,errorMessage:e.message,errorLocalizedMessage:"",errorCode:e.errorCode,dataResults:null},t.controlId,g.g))})}return Promise.resolve()}const y=[];let v="";for(let r=0;r<d.length;r++){v=d[r];const n=c.queueTypeToRequestMap[v];if(n.isEnabled)if(i!==o.a.Data&&i!==o.a.MoreEmails)for(let i=0;i<p.length;i++){const r=K(e,n,v,l,R.a.tryCreate(t.recordId),t.recordEntityName,i,p);r&&y.push(r)}else{const i=K(e,n,v,l,R.a.tryCreate(t.recordId),t.recordEntityName);i&&y.push(i)}}let O=!1;i!==o.a.WhatsChanged&&i!==o.a.Filters||(O=!0);const _=s.get_WebAPIService().Execute(new A.a(y,new k.a(O,!0)),null).then(n=>{const m=n.get_responses(),y={};let O=!1,_="";for(const n in m){const P=m[n];if(i!==o.a.Data&&i!==o.a.MoreEmails){if(v=p[n],(i===o.a.WhatsChanged||i===o.a.Filters)&&null===P.get_response()&&null!==P.get_fault())if(P.get_fault().get_errorCode()===u.a);else{try{P.get_fault().get_message()&&(_=P.get_fault().get_message())}catch(e){_=e.message}O=!0,Object(f.d)(P,a,"TimelineWall.retrieveTimelineWallData","timelinewall.data.retrieve.nextpage.async",_)}y[v]=P}else if(v=d[n],v===u.k){const{userIds:i,postIds:n}=q(P),o=H(n,i,h,b,e,c,l,t,v);if(o.length>0)return s.get_WebAPIService().Execute(new A.a(o,new k.a(!1,!0)),null).then(e=>{const i=e.get_responses(),n=[P.get_response()];for(let e=0;e<i.length;e++)n.push(i[e].get_response());r(Object(g.p)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:n},t.controlId,v))},e=>{let i="";try{e&&e.reason&&(i=e.reason.get_localizedMessage())}catch(e){i=e.message}Object(f.d)(e,a,"TimelineWall.retrieveTimelineWallData","timelinewall.data.retrieve.nextpage.async",i),r(Object(g.p)({isError:!0,errorMessage:_,errorLocalizedMessage:"",errorCode:"",dataResults:null},t.controlId,v))});r(Object(g.p)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:P.get_response()},t.controlId,v))}else r(Object(g.p)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:P.get_response()},t.controlId,v))}i!==o.a.Data&&i!==o.a.MoreEmails&&r(O?Object(g.p)({isError:!0,errorMessage:_,errorLocalizedMessage:"",errorCode:"",dataResults:null},t.controlId,i):Object(g.p)({isError:!1,errorMessage:"",errorLocalizedMessage:"",errorCode:"",dataResults:y},t.controlId,i))},e=>{let i="",n="",s="";try{if(e)if(e.reason)i=null!=e.reason.get_message()?e.reason.get_message():e.reason.get_organizationServiceFault().get_messages().get_Items().toString();else{i=null!=e.get_message()?e.get_message():"",n=null!=e.get_localizedMessage()?e.get_localizedMessage():"";const t=e.get_error()?JSON.parse(e.get_error()):"";s=t?t.error.code:""}}catch(e){i=e.message}Object(f.d)(e,a,"TimelineWall.retrieveTimelineWallData","timelinewall.data.retrieve.nextpage.async",i),r(Object(g.p)({isError:!0,errorMessage:i,errorLocalizedMessage:n,errorCode:s,dataResults:null},t.controlId,v))});return Promise.resolve(_)}}}(n,e,a)).then(()=>{t(Object(g.o)(e.controlId,a,2,e.requestId))}),Promise.resolve()}}}function q(e){const t=[],i=[],r=e.get_response();if(r){const e=r.get_entityCollection();if(null!=e)for(const r of e){if(2===r.source){const e=r["_createdby_value"];-1===i.indexOf(e)&&i.push(e)}t.push(r.postid)}}return{userIds:i,postIds:t}}function G(e,t){let i;for(let e=0;e<t.length;e++)i=void 0===i?"<value>"+t[e]+"</value>":i+"<value>"+t[e]+"</value>";return String.format(e,i)}function H(e,t,i,r,n,a,s,o,l){const c=[];if(e&&e.length>0&&a.queueTypeToRequestMap[l].dataMap[i]&&null!==a.queueTypeToRequestMap[l].dataMap[i]){a.queueTypeToRequestMap[l].dataMap[i]=G(a.queueTypeToRequestMap[l].dataMap[i],e);const t=K(n,a.queueTypeToRequestMap[l],u.l,s,R.a.tryCreate(o.recordId),o.recordEntityName);c.push(t)}if(t&&t.length>0&&a.queueTypeToRequestMap[l].dataMap[r]&&null!==a.queueTypeToRequestMap[l].dataMap[r]){a.queueTypeToRequestMap[l].dataMap[r]=G(a.queueTypeToRequestMap[l].dataMap[r],t);const e=K(n,a.queueTypeToRequestMap[l],u.m,s,R.a.tryCreate(o.recordId),o.recordEntityName);c.push(e)}return c}function K(e,t,i,r,n,a,s,l){switch(i){case g.h:const i="IsDashboardContext",d="PageNumber",p="PageSize",h="CommentsPerPost",f="StartDate",b="EndDate",v="Source",O="SortDirection",_="Keyword",S=!0===Object(m.b)(r,u.t.TimelineWallUserPosts)?t.dataMap[v]||null:1;return!0===t.dataMap[i]?(Y(e,"RetrievePersonalWall",y,D),c={pageNumber:t.dataMap[d],pageSize:t.dataMap[p],commentsPerPost:t.dataMap[h],startDate:t.dataMap[f],endDate:t.dataMap[b],type:null,source:S,sortDirection:t.dataMap[O],keyword:t.dataMap[_]},new z(c.pageNumber,c.pageSize,c.commentsPerPost,c.startDate,c.endDate,c.type,c.source,c.sortDirection,c.keyword)):(Y(e,"RetrieveRecordWall",P,T),function(e){return new U(e.entity,e.pageNumber,e.pageSize,e.commentsPerPost,e.startDate,e.endDate,e.type,e.source,e.sortDirection,e.keyword)}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */({entity:new L.a(a,n),pageNumber:t.dataMap[d],pageSize:t.dataMap[p],commentsPerPost:t.dataMap[h],startDate:t.dataMap[f],endDate:t.dataMap[b],type:null,source:S,sortDirection:t.dataMap[O],keyword:t.dataMap[_]}));case o.a.MoreEmails:case g.a:const w="FetchXML";return Q(e,t,t.dataMap[w],n,a);case g.g:{const e="FetchXML",i=t.dataMap[e];return new M.a(i)}case u.l:{const e="FetchXML",i=t.dataMap[e];return new M.a(i)}case u.m:{const e="PostImageFetchXml",i=t.dataMap[e];return new M.a(i)}case o.a.Filters:case o.a.WhatsChanged:{const i="FetchXMLs",r=t.dataMap[i][l[s]],o=r.fetchXml;if(o){const i=r.requestType;if("RetrieveMultipleRequest"===i)return new M.a(o);if("RetrieveTimelineWallRecordsRequest"===i)return Q(e,t,o,n,a)}return null}}var c}function Q(e,t,i,r,n){const a=t.dataMap.IsDashboardContext;Y(e,"RetrieveTimelineWallRecords",I,N);const s=a?null:new L.a(n,r);return new V(i,s,t.dataMap.RollupType)}function Y(e,t,i,r){e.requestSerializers.hasOwnProperty(t)||(e.requestSerializers[t]=i),e.responseDeserializers.hasOwnProperty(t)||(e.responseDeserializers[t]=r)}var X=i("65OV"),Z=i("mFPv"),$=i("arV0"),J=i("j6Db"),ee=i("zmL5"),te=i("OtHk");var ie=i("dHD5"),re=i("ghNp");var ne=i("Knfm"),ae=i("GEbX");class se{constructor(e,t,i){this.objectWrapperType=3,this.previousReturn=new s({timelineWallData:null,timelineWallConfiguration:null,contextType:null,controlId:null,entitiesMetadata:null,getTimelineWallData:null,getCommands:null,getEntityAttributes:null,isMultiSessionNavigationType:null}),this._isServerAvailable=null,this._upSyncStatus=null,this._propKey=t,this._pageId=i,this._retrieveTimelineWallData=t=>e(W(t)),this._retrieveTimelineCommands=(t,r,n,a,s)=>e(function(e,t,i,r,n){return{type:"retrieve.timelineRecordCommand.async",execute({dispatch:a,getState:s},o){let l=null;const u=s(),c=Object($.g)(u,e);if("dashboard"===c.pageType){let t=c.dashboardId;t||(t=c.etn?Object(te.e)(u,c.etn):Object(ee.b)(u,e)),l=t.guid+":notescontrol"}else l=c.entityTypeName+":notescontrol";return Object(X.a)(u,e,t,l,i,a,r,!0,n).then(e=>Object(Z.d)(e,a),e=>{const i="Retrieve Timeline record commands failure error message";o.EventManager.ReportComponentFailure("TimelineWall.CustomControl.retrieveTimelineCommands",{name:"error",message:i},i,[{name:"APIName",value:J.a+".Actions.RetrieveTimelineCommands"},{name:"Action",value:"retrieve.timelineRecordCommand.async"},{name:"CommandMangerId",value:t}])})}}}(i,r,n,a,s)),this._getEntityAttributes=()=>{return e((t=i,{type:"getentityattributes.async.action",execute({dispatch:e,getState:i},r,n){const a=i(),s=Object(ie.j)(a,t);if(null!==t&&null!==s){const i=e(Object(re.b)(t,s));if(i&&i.data&&i.data.entity)return i.data.entity.attributes}return null},sync:!0}));var t}}linkToParameter(e,t){e.getTimelineWallData=this._retrieveTimelineWallData,e.getCommands=this.executeRetrieveTimelineWallCommandAction.bind(this),e.getEntityAttributes=this._getEntityAttributes}retrieveTimelineWallObject(e,t,i,r,c){const d=i.Parameters[this._propKey];if(this.isParameterOfTimelineWallType(d)){const i=Object(ee.b)(e,t.id),p=Object(l.b)(r,t.controlId),h=Object(n.b)(e,t.id,i,p);t&&t.descriptor&&h.Label!==t.descriptor.Label&&(h.Parameters[u.s.Label]=t.descriptor.Label);const m=e.data;if(!r.isPreview||!m.timelineWalls||m.timelineWalls[h.LabelId]&&m.timelineWalls[h.LabelId].requestStatusMap){const t=Object(a.a)(e,h.LabelId),i=Object(l.c)(e,h,r,d,t,c);t.target&&(!t.target||t.target.etn&&t.target.id)||r.entityTypeName&&r.id&&(t.target={etn:r.entityTypeName,id:r.id.guid});const n=Object(ne.a)(e)===ae.a.MultiSession;n&&t&&t.target&&!t.target.isAPI&&r&&r.entityTypeName&&r.id&&(t.target={etn:r.entityTypeName,id:r.id.guid});const o=new s({timelineWallData:t,timelineWallConfiguration:i?i.TimelineWallConfiguration:null,contextType:i?i.ContextType:null,controlId:h.LabelId,entitiesMetadata:i?i.EntitiesMetadata:null,getTimelineWallData:null,getCommands:null,getEntityAttributes:null,isMultiSessionNavigationType:n});return this._hasStateChanged(this.previousReturn,o,e)&&(this.previousReturn=o),this.previousReturn}c(Object(g.q)(h.LabelId,null)),c(Object(g.o)(h.LabelId,o.a.Metadata,2,null))}}_hasServerStateChanged(e){const t=null!==this._upSyncStatus&&Object(d.b)(e)!==this._upSyncStatus,i=null!==this._isServerAvailable&&Object(c.b)(e)!==this._isServerAvailable,r=i&&Object(c.b)(e)&&!Object(h.w)(e)||t&&Object(c.b)(e)||i&&!Object(c.b)(e);return this._isServerAvailable=Object(c.b)(e),this._upSyncStatus=Object(d.b)(e),r}_hasTimelineWallStateChanged(e,t){if(!e.controlId||!e.timelineWallConfiguration&&t.timelineWallConfiguration||e.timelineWallConfiguration&&t.timelineWallConfiguration&&e.timelineWallConfiguration.Label!==t.timelineWallConfiguration.Label)return!0;const i=[o.a.Data,o.a.Filters,o.a.WhatsChanged,o.a.InitiateRefresh,o.a.MoreEmails,o.a.ContextualDialogEntity],r=i.length;for(let n=0;n<r;n++)if(t.timelineWallData&&e.timelineWallData&&t.timelineWallData.requestStatusMap&&e.timelineWallData.requestStatusMap&&(e.timelineWallData.requestStatusMap[i[n]].requestId!==t.timelineWallData.requestStatusMap[i[n]].requestId||e.timelineWallData.requestStatusMap[i[n]].status!==t.timelineWallData.requestStatusMap[i[n]].status))return!0;return!1}getLatestData(){return this.previousReturn}isLoading(){return!(this.previousReturn&&this.previousReturn.timelineWallConfiguration||Object(p.a)())}isParameterOfTimelineWallType(e){return!!e&&e.Type===r.a.TimelineWall}executeRetrieveTimelineWallCommandAction(e,t){if(e[0]&&e[0].name&&this._activityCommandManagerId)return this._retrieveTimelineCommands(this._pageId,this._activityCommandManagerId,e,t)}getParameterManifestType(){return r.a.TimelineWall}ensureTimelinewallCommandsInitialization(e){this._ownProps=e,this._initializeCommandManager()}_initializeCommandManager(){null==this._activityCommandManagerId&&(this._activityCommandManagerId=this._createHiddenCommandManager(this._ownProps,"activitypointer"))}_createHiddenCommandManager(e,t){const i=e.id+":"+e.controlId+":"+t;return e.actions.registerNewControl(e.contextToken,e.id,e.controlId,e.descriptor.LabelId),e.actions.initializeCommandManager(e.id,e.contextToken,e.controlId,i,"SubGridStandard:activitypointer"),i}_hasStateChanged(e,t,i){return this._hasTimelineWallStateChanged(e,t)||this._hasServerStateChanged(i)}}},ldGr:function(e,t,i){"use strict";i.d(t,"b",(function(){return P})),i.d(t,"a",(function(){return v})),i.d(t,"c",(function(){return b}));var r=i("SAYH"),n=i("i1f0"),a=i("jRy5"),s=i("dHD5"),o=i("Zpd/"),l=i("NUHF"),u=i("arV0"),c=i("odYE"),d=i("H523"),p=i("Khp3"),h=i("kWiz"),m=i("YxC/"),g=i("bJSG"),f=i("WePp");function b(e,t,i){return{type:"initialize.dependentOptionSet.fields",sync:!0,execute({dispatch:r,getState:n},a,s){const o=y.bind(this,n(),r,e,t,i);!function(e,t,i,r,n){const a=[],s=e.TraceManager.getTracer("initialize.dependentOptionSet.fields");e.TraceManager.setLogLevel(h.a.Info,"initialize.dependentOptionSet.fields"),a.push({name:"CorrelationId",value:t.correlationId},{name:"ContextId",value:t.contextId},{name:"ActionStack",value:t.stack},{name:"PageId",value:r},{name:"EntityTypeName",value:i}),s.info("Executing initialize dependent option set fields action.",a);const o=n(),l={name:"NumCompleteDependentOptionSetChains",value:o[0]},u={name:"CompleteChainsDepth",value:o[1]};a.push(l,o[2],u);const c=new f.a("initialize.dependentOptionSet.fields");c.addEventParameter("NumCompleteDependentOptionSetChains",o[0]),c.addEventParameter("NumPartialDependentOptionSetChainFields",o[2].value),c.addEventParameter("CompleteChainsDepth",o[1]),e.EventManager.ReportEvent(c),s.info("Executed initialize dependent option set fields action successfully.",a)}(a,s,e,t,o)}}}function y(e,t,i,r,o){const l={name:"NumPartialDependentOptionSetChainFields",value:0},d=[];let p=0;const h=Object(s.w)(o),m=Object(n.P)(e,h,i,r),g=function(e,t,i,r){let s;if(t.contextTokenType===a.a.RelatedEntity)s=Object(n.oc)(e,{id:i},t)[t.relationshipName];else{const t=Object(u.g)(e,i);s=new c.a(r,t.id)}return s}(e,o,r,i);for(const n in m){const a=m[n];if(null===a.ParentPicklistLogicalName){const a={name:n,value:0};v(e,o,r,i,m,n,a)?_(e,t,h,r,m,n,o.relationshipName,l):(O(e,t,o,r,g,n),p++,d.push(a))}else void 0===m[a.ParentPicklistLogicalName]&&_(e,t,h,r,m,n,o.relationshipName,l)}return[p,d,l]}function v(e,t,i,r,a,o,l){if(void 0===a[o])return!0;if(function(e,t,i,r,a){const o=Object(u.g)(e,i);if(!Object(n.Vc)(e,r,null==o?void 0:o.id,i,a))return!0;const l=Object(s.w)(t),c=Object(n.z)(e,i,l,a,t.relationshipName);for(let t=0;t<c.length;t++){const r=Object(n.s)(e,{id:i,controlName:c[t]},l);if(r&&!r.Disabled&&r.Visible)return!1}return!0}(e,t,i,r,o))return!0;const c=a[o].ChildPicklistLogicalNames;if(null!==c)for(let n=0;n<c.length;n++){const s={name:o,value:0};if(v(e,t,i,r,a,c[n],s))return!0;l.value=Math.max(l.value,s.value)}return l.value=l.value+1,!1}function O(e,t,i,r,a,s){const o={},u=Object(n.ac)(e,r,i);o[s]=Object(n.X)(e,r,i,u,a,s),t(Object(l.b)(r,i,!1,o))}function _(e,t,i,r,a,s,l,u){if(void 0===a[s])return;const c=P(e,[String.format(Object(m.b)(e,g.a))],d.a.information);Object(n.z)(e,r,i,s,l).forEach(e=>{t(Object(o.b)(r,e,i,!0)),t(Object(p.b)(r,e,c,i)),u.value=u.value+1});const h=a[s].ChildPicklistLogicalNames;if(h)for(let n=0;n<h.length;n++)_(e,t,i,r,a,h[n],l,u)}function P(e,t,i){return{uniqueId:r.a.toString(r.a.newGuid()),messages:t,notificationLevel:i,actions:null}}},mFPv:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return u})),i.d(t,"d",(function(){return c}));var r=i("65OV"),n=i("odYE"),a=i("SAYH"),s=i("dHD5"),o=i("j6Db"),l=i("wgH2");function u(e,t,i,u,d,p,h,m,g,f){return{type:"retrieve.recordCommand.async",execute({dispatch:b,getState:y},v){const O=[];for(const e in t)if(-1!==d.indexOf(e)){const i=t[e].getNamedReference();O.push(new n.a(i.entityName,new a.a(i.id),i.name))}return Object(r.a)(y(),e,i,Object(s.v)(u),O,b,p,false,h,m,g,f).then(e=>c(e,b),e=>{const t=Object(l.c)(y(),i),r=(t?t.CustomControlType:o.a)+".CustomControl.Commanding.retrieveRecordCommand";throw v.EventManager.ReportComponentFailure(r,e,"retrieveRecordCommand failure",[{name:"APIName",value:o.a+".Actions.retrieveRecordCommand"},{name:"commandManagerId",value:i},{name:"contextToken",value:JSON.stringify(u)},{name:"records",value:JSON.stringify(d)},{name:"commandButtonIds",value:JSON.stringify(p)},{name:"filterByPriority",value:h},{name:"useNestedFormat",value:JSON.stringify(m)},{name:"controlConstructorName",value:g},{name:"refreshAllRules",value:JSON.stringify(f)}]),e})}}}function c(e,t){const i=[];for(let r=0;r<e.length;r++){const n=e[r];i.push({commandButtonId:n.commandButtonId,commandId:n.commandId,label:n.label,canExecute:n.canExecute,shouldBeVisible:n.shouldBeVisible,tooltip:n.tooltip,icon:n.icon,children:c(n.children,t),controlType:n.controlType,execute:()=>t(n.execute)})}return i}function d(e,t,i,r,n){return{type:"initialize.customControl.command",payload:{contextKey:Object(s.v)(t),commandManagerId:r,controlId:i,ribbonId:n},meta:{pageId:e}}}function p(e,t,i,r){return{type:"pending.customControl.command",payload:{contextKey:Object(s.v)(t),commandManagerId:r,controlId:i},meta:{pageId:e}}}},mIxf:function(e,t,i){"use strict";i.d(t,"a",(function(){return Q})),i.d(t,"b",(function(){return Z}));var r=i("sX6v"),n=i("bT7G"),a=i("Uv1Y");function s(e,t){return{type:"dataSnapshot.undoChanges.async",execute({dispatch:i,getState:r},s){const l=Object(n.b)(r(),e);if(l){if(0===Object.keys(l.activeChanges).length)return Promise.resolve();let r={};if(t&&t.length>0){if(r=Object.keys(l.activeChanges).reduce((e,i)=>(-1===t.indexOf(i)&&(e[i]=l.activeChanges[i]),e),r),Object.keys(r).length===Object.keys(l.activeChanges).length)return Promise.resolve();i(o(e,r))}else i(o(e,r));return Promise.resolve()}return Promise.reject(new a.a("Snapshot does not exist"))}}}function o(e,t){return{type:r.a,payload:t,meta:{snapshotId:e,flavor:1}}}var l=i("arV0"),u=i("i1f0"),c=i("mL5Q"),d=i("f/sd"),p=i("odYE"),h=i("WY/A"),m=i("RrRQ"),g=i("qTme"),f=i("4UCL"),b=i("SAYH"),y=i("Dea/"),v=i("JP46"),O=i("dHD5"),_=i("3tOH"),P=i("Bj/n"),S=i("YxC/"),w=i("EY5k"),I=i("ZPAw"),j=i("3hnk"),C=i("aF0N"),D=i("LbMF"),E=i("y60j"),T=i("504W"),F=i("NUHF"),N=i("Zzxs"),R=i("3/02"),A=i("Lyxw"),k=i("5Oca"),L=i("3HPu"),M=i("qpML"),x=i("jTSi"),V=i("qLnS"),B=i("ZXdP"),U=i("xy1J"),z=i("zmL5"),W=i("O7zD"),q=i("Nb1E"),G=i("+pAH");function H(e,t,i){return{type:G.a,payload:{identifier:e,attributeName:t,fileState:{operationType:M.a.Delete,fileProgress:i}}}}function K(e,t){return{type:"delete.file",execute({dispatch:i,getState:r},n){const a=n.TraceManager.getTracer("DownloadFile");return a.info("deleteFile : Starting to delete the file associated with . fileAttributeName = "+t+" and target entity = "+e.etn),i(Object(q.c)(e,t)).then(()=>(i(H(e,t,M.b.Finished)),Promise.resolve())).catch(r=>{if(r)return i(H(e,t,M.b.Failed)),a.error("deleteFile : Failed to delete the file associated with . fileAttributeName = "+t+" and target entity = "+e.etn),Promise.reject(r)})}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function Q(e,t,i,a,o,I,L,M){return{type:"control.update.value",sync:!0,execute({dispatch:x,getState:U},W){const q=U();let G,H;const X=Object(l.g)(q,e),Z=L&&o&&I,$=!!o;let J;if(Z){const t=Object(C.c)(q),i=Object(C.b)(q);(t||i)&&"Dashboard"!==Object(l.l)(q,e)||(a=!0),H=Object(O.f)(M,new b.a(I),o),G=new p.a(o,new b.a(I))}else $?(H=M,G=new p.a(o,I?new b.a(I):b.a.EMPTY),J=H.relationshipName):(H=M||Object(O.j)(q,e),G=new p.a(X.entityTypeName,X.id));let ee=Object(u.ac)(q,e,H),te=!i||X.isOfflineSyncError;te&&!X.isOfflineSyncError&&(Object(c.a)(q,e)<d.a.OnLoadReady||Object(u.mb)(q,{id:e},H))&&(te=!1);const ie=te?function(e,t,i,r){const a={};for(const s in t)a[s]=Object(n.d)(e,r,i,s);return a}(q,t,G,ee):void 0,re=Object(v.a)(q,ee,G,t,!0,Object(O.s)(H),W.TraceManager.getTracer("Forms.UpdateFieldValue"),e,x,J,i),ne=Object.keys(re);if(0===ne.length)return;if(X.isOfflineSyncError){let t=!0;for(let i=0;i<Object.keys(re).length;i++){const r=Object(z.b)(q,e);if(!Object(T.a)(r)){const e=Object(E.j)(q,r);if(!Object(T.a)(e)&&Object(T.a)(e.Controls[Object.keys(re)[i]])){t=!1;break}}if(t=Object(l.m)(q,e)?Object(j.f)(q,G.etn,Object.keys(re)[i],V.a.CanCreate,null==G?void 0:G.id):Object(j.f)(q,G.etn,Object.keys(re)[i],V.a.CanUpdate,null==G?void 0:G.id),!t)break}let i="LOCID_RESOLVE_INFO_TEXT",r=_.a.information;t||(i="LOCID_RESOLVE_WARNING_TEXT",r=_.a.warning),x(Object(w.e)([i])).then(()=>{x(Object(P.c)(H,e,Object(S.b)(U(),i),r,N.c))})}const ae=b.a.isNullOrEmpty(G.id)?y.a.Create:y.a.Update,se=Object(O.v)(H),oe=Object(n.b)(q,ee),le=Object.keys(t),ue=[],ce=Object(D.d)(q,G.etn),de=Object(A.c)(q,R.Wb)&&Object(A.c)(q,R.nb),pe=Object(A.c)(q,R.Yb)&&Object(A.c)(q,R.nb),he=Object(l.m)(q,e);for(const i of le){const r=ce[i];if(!he||r&&"multiselectpicklist"===r.Type){const n=Object(k.j)(q,G,i);if((re[i]&&!Object(v.b)(n,re[i],!0)||!de&&r&&"file"===r.Type||!pe&&r&&"image"===r.Type)&&ue.push(i),(de&&r&&"file"===r.Type||pe&&r&&"image"===r.Type)&&re[i]&&t&&t[i])if(t[i].value){if("string"!=typeof t[i].value){const r=t[i].value;Y(U,r,i,x,H,e,G,W)}}else x(K(G,i))}}if(ee&&oe&&(p.a.equals(G,oe.identifier)||ae===y.a.Create))x(Object(r.b)(q,ee,re));else{ee&&x(Object(m.c)(e,ee,H));const t=Object(h.b)(q,G,re,se,ae),i=t.payload.snapshotId;x(t),x(Object(g.b)(e,i,H)),ee=i}te&&x(Object(f.c)(e,H,ie));if(Object(A.c)(q,R.L)){const t=function(e,t,i){const r=Object(D.e)(e,t,Object.keys(i)),n={};if(r&&Object.keys(r).length>0){for(const e in r)n[e]=i[e];if(Object.keys(r).length>1)for(const e in r)r[e].ParentPicklistLogicalName&&delete n[e]}return n}(q,G.etn,re);x(Object(F.b)(e,H,!0,t,i,a,o,I,L))}if(!a){if(!W.ScriptManager.containerExists(e)){const t=JSON.stringify(ne),i=[{name:"pageId",value:e},{name:"changeKeys",value:t}],r=`Could not get container or event manager. pageId: ${e}, changesKeys ${t}.`;W.EventManager.ReportComponentFailure("Forms.UpdateFieldValue",Error(r),void 0,i)}const i=W.ScriptManager.getContainer(e).getEventManager();for(const e in t)re[e]&&re[e].validationResult&&(re[e].validationResult.isValueValid||"Required"===re[e].validationResult.errorId)&&x(i.runOnChange(Z?M:H,e))}if(ue.length>0&&ee&&x(s(ee,ue)),t.transactioncurrencyid){const t=Object(D.d)(q,X.entityTypeName),i={};for(const e in t){const r=t[e];"money"===r.Type.toLowerCase()&&(i[r.LogicalName]=Object(n.d)(q,ee,G,r.LogicalName))}x(Q(e,i,!0,!0,o,I,L,H))}x(Object(B.b)(e,H))}}}function Y(e,t,i,r,n,a,s,o){const l=e(),u=Object(D.a)(l,s.etn,i),c="file"===u.Type?String.format(Object(S.b)(e(),U.f),u.DisplayName):String.format(Object(S.b)(e(),U.i),u.DisplayName);X(l,r,n,i,a,!1,_.a.information,c);const d=[];d.push({name:"Attribute Type",value:u.Type});const p=o.TraceManager.getTracer("Forms.LargeImageFileAttribute");return p.info("Uploaded started for file/image type attribute.",d),r(Object(I.b)(t,i,s)).then(()=>{p.info("Uploaded successfully completed for file/image type attribute.",d);const t=e();return Object(k.k)(e(),s,i)===M.b.Finished&&X(t,r,n,i,a,!0),Promise.resolve()}).catch(t=>{const o=Object(k.k)(e(),s,i),l=e();if(o===M.b.Failed){d.push({name:"Error",value:t.message}),p.error("Uploaded failed for file/image type attribute.",d);const s=String.format(Object(S.b)(e(),U.h),u.DisplayName);X(l,r,n,i,a,!0,_.a.warning,s)}else if(o===M.b.Cancelled){p.info("Uploaded cancelled for file/image type attribute.",d);const t="file"===u.Type?String.format(Object(S.b)(e(),U.g),u.DisplayName):String.format(Object(S.b)(e(),U.j),u.DisplayName);X(l,r,n,i,a,!0,_.a.information,t)}else X(l,r,n,i,a,!0);return Promise.reject(t)})}function X(e,t,i,r,n,a,o,l){if(t(Object(L.b)(n,r,a,i)),a){const a=[];a.push(r);t(s(Object(u.ac)(e,n,i),a)),t(Object(x.b)(i,n,Object(W.d)(n,r)))}l&&o&&t(Object(P.c)(i,n,l,o,Object(W.d)(n,r)))}function Z(e,t){return{type:"control.update.value",sync:!0,execute({dispatch:i,getState:r},n){const a=r(),s={},o=Object(u.Qb)(a,{id:e},t);if(o)for(const e in o)s[o[e]]={fieldName:o[e],value:""};i(Q(e,s,!0,!0))}}}},nfCs:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return n}));var r=i("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */function n(e){if(e<r.a.DAY||e>r.a.FISCAL_YEAR)throw new RangeError("Argunment out of range");return{groupingType:e}}function a(e){if(!e)return-1;switch(e){case"day":return r.a.DAY;case"week":return r.a.WEEK;case"month":return r.a.MONTH;case"year":return r.a.YEAR;case"quarter":return r.a.QUARTER;case"fiscal-period":return r.a.FISCAL_PERIOD;case"fiscal-year":return r.a.FISCAL_YEAR;default:return-1}}function s(e){switch(e){case r.a.DAY:return"day";case r.a.WEEK:return"week";case r.a.MONTH:return"month";case r.a.YEAR:return"year";case r.a.QUARTER:return"quarter";case r.a.FISCAL_PERIOD:return"fiscal-period";case r.a.FISCAL_YEAR:return"fiscal-year";default:return null}}},ofgb:function(e,t,i){"use strict";i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return d}));var r=i("dHD5"),n=i("Zn5P"),a=i("i1f0"),s=i("wL2W"),o=i("/t1C"),l=i("yHAP"),u=i("KXSk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const c="form.SavingState.set";function d(e,t,i){return{type:"set.formSaving.sync",sync:!0,execute({dispatch:d,getState:p},h){const m=p(),g=Object(s.a)();if(2===i||1===i){const r=Object(a.mb)(m,{id:e},t),s=Object(a.Ab)(m,{id:e},t);r&&!s&&d(Object(n.c)(2===i?1:0))}if(d(function(e,t,i){const n=Object(r.v)(t);return{type:c,payload:{savingState:i},meta:{pageId:e,contextKey:n}}}(e,t,0===i)),g){const r=p();let n;switch(i){case 0:n="started";break;case 1:n="succeeded";break;case 2:n="failed";break;case 3:n="canceled"}const s=Object(u.b)(r,e);n=`Save operation ${n} ${Object(l.c)(r,e,t)}.`;if(Object(a.jb)(r,s)){Object(l.b)(s,o.b.onSave).push({message:n})}else Object(l.a)(h,s,o.b.onSave,{message:n})}}}}},"p/2N":function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return p})),i.d(t,"d",(function(){return d})),i.d(t,"c",(function(){return c}));var r=i("455M"),n=i("KBcj"),a=i("Z/4N"),s=i("vmcK"),o=i("9fGf");function l(e,t,i,n){const a=Object(o.b)(e);if(!(t&&t.CustomControls&&t.CustomControls[a]&&t.CustomControls[a].Parameters))return null;const s=t.CustomControls[a].Parameters;let l=null;if(n&&s[n]){s[n].Type===r.a.Grid&&(l=s[n])}else for(const e in s){const t=s[e];if(t.Type===r.a.Grid){l=t;break}}if(l&&l.Columns){const e=l.Columns,t=[];for(const r in e){const{Name:n}=e[r];n&&-1===t.indexOf(n)&&-1===i.indexOf(n)&&t.push(n)}return t}return null}function u(e,t,i,r,s,o,u){const d=Object(n.c)(e,u);if(!(r||s||e&&d&&e.metadata&&e.metadata.formDefaults&&o&&e.metadata.formDefaults[o]))return null;const p=r||e.metadata.formDefaults[o][s].formId;return l(e,Object(a.b)(e,t,p),c(d),i)}function c(e){const t=d(e);return t?t.map(e=>e.name):[]}function d(e){return e&&e.grid&&e.grid.rows&&e.grid.rows[0]&&e.grid.rows[0].cells?e.grid.rows[0].cells:[]}function p(e,t,i){const r=Object(n.c)(e,i);return r?l(e,Object(a.d)(e,t,s.a),c(r)):[]}},p8cR:function(e,t,i){"use strict";i.d(t,"b",(function(){return we})),i.d(t,"a",(function(){return Ie}));var r=i("455M"),n=i("sozv"),a=i("SAYH"),s=i("7fV9"),o=i("69Qu"),l=i("KBcj"),u=i("d0w6"),c=i("arV0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class d{getDataSetParameter(e){throw new Error("Not wrapped")}getTargetEntityNames(){throw new Error("Not wrapped")}refresh(e){throw new Error("Not Replaced")}getRecentItems(e){throw new Error("Not Replaced")}getLookupConfiguration(){throw new Error("Not Replaced")}getAllViews(e){throw new Error("Not Replaced")}getDefaultViewId(e){throw new Error("Not Replaced")}setMyRecordsOnlyFilter(e){throw new Error("Not Replaced")}sendLookupRequest(e,t,i,r,n){throw new Error("Not Replaced")}runPreSearch(){throw new Error("Not Replaced")}}var p=i("j9v9"),h=i("i1f0"),m=i("w10E"),g=i("KCGk"),f=i("Xi8U"),b=i("5ZBI"),y=i("R5Qn"),v=i("Znul"),O=i("u2Wk"),_=i("Lyxw"),P=i("F3eT"),S=i("3/02"),w=i("VcAV"),I=i("Uv1Y"),j=i("E3i9"),C=i("q/4y"),D=i("2ciq"),E=i("YxC/");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const T="CustomControlFramework.Models.Lookups.MultiEntityTypeLookupObjectWrapper",F=a.a.EMPTY;class N{constructor(e,t){this._dataSetWrappers={},this._dataSetParameters={},this._viewSelectorItemsByTypeById={},this._viewIdByEtn={},this._targetEntityTypeNames=null,this._lookupMruWrapper=null,this._lookupConfigurationWrapper=null,this._propKey=e,this._contextToken=t,this._lookupMruWrapper=new m.a,this._lookupConfigurationWrapper=new g.a}getPropKey(){return this._propKey}getLatestData(){return this.previousReturn}getLatestFieldData(){return this._previousFieldData}retrieveTargetEntityNames(e,t,i){const r=i;if(r.entityTypes&&r.entityTypes.length>0)return r.entityTypes;if(this._contextToken&&(this._contextToken.entityTypeName||i.entityTypeName)){const r=this._contextToken;r.entityTypeName=r.entityTypeName||i.entityTypeName;const n=t.configuration.Parameters[this.getPropKey()];if(0===n.Usage)return Object(h.Ob)(e,t.id,r,n.Value);if(3===n.Usage){const e=n;return e.Attributes&&e.Attributes.Targets}}return null}createParameterInstance(){return new d}_generateDataSetKey(e,t){return t&&this._viewIdByEtn[e]!==t?e+":"+t:e+":"+F.guid}retrieveDataSetObject(e,t,i,r){const n={};let a,d=!1,m=!1,g="",v="";if(this._pageId=t.id,this._pageEtn=r.entityTypeName,this._controlId=t.descriptor.parentFieldSectionItem?t.descriptor.parentFieldSectionItem:t.controlId,this._attributeName=Object(D.b)(i,this._propKey),this._shouldUseLookupService(e,i.CustomControlId)&&!this._entityMetadata){const i=Object(y.f)(e,this._pageEtn,this._attributeName,t.id);if(a=Object(j.b)(e,i),a){this._entityMetadata={},this._entityDefaultViews={};for(const e in a)this._entityMetadata[e]=this.convertEntityDescriptorToEntityMetadata(a[e].entity),this._entityDefaultViews[e]=a[e].view,d=!0}}this._checkCustomViews(e,this.retrieveTargetEntityNames(e,t,r));const O=i.Parameters[this._propKey];let _;if(_=O.TargetEntityTypes?O.TargetEntityTypes:3===O.Usage&&O.Attributes?O.Attributes.Targets:this.retrieveTargetEntityNames(e,t,r),null===_||0===_.length){const i=t?Object(c.l)(e,t.id):"",n=t&&t.configuration?Object(b.b)(e,t.configuration.CustomControlId)||Object(b.b)(e,t.configuration.Name):T,a=[{name:"EntityName",value:r&&r.entityTypeName},{name:"RecordId",value:r&&r.id&&r.id.guid},{name:"FieldName",value:t&&t.controlId},{name:"IsOffline",value:!Object(o.b)(e)},{name:"PageType",value:i}];b.a.warn(n+": No target entities found",a)}const P=Object(h.eb)(e,t.id,this._contextToken),S=O;for(const a in _){const s=_[a],c=Object(l.a)(e,s,u.a.LOOKUP_VIEW),h=this._getDefaultView(s,P,this._controlId,this._entityDefaultViews,c,S,e,this._viewSelectorItemsByTypeById);h&&(this._viewIdByEtn[s]=h.guid);this._viewSelectorItemsByTypeById&&this._viewSelectorItemsByTypeById[s]&&Object.keys(this._viewSelectorItemsByTypeById[s]).length>0&&Object.keys(this._viewSelectorItemsByTypeById[s]).forEach(o=>{const l=this._generateDataSetKey(s,o);if(!this._dataSetWrappers[l]||!this._targetEntityTypeNames||_[a]!==this._targetEntityTypeNames[a]){const e=this._viewSelectorItemsByTypeById[s][o],i=e&&e.isUserView?u.b.userview:u.b.savedview;this._dataSetWrappers[l]=new p.a(s,this._propKey,this._contextToken,o,i),this._dataSetWrappers[l].updatePreviousOwnProps(t),this._dataSetParameters[l]=null}const c=this._dataSetWrappers[l];if(o){c.setViewId(o);let a=c.retrieveDataSetObject(e,t,i,r);a||(a=c.generateEmptyParam()),n[l]=a}else n[l]=c.generateEmptyParam(),this._dataSetParameters[l]&&this._dataSetParameters[l].error?n[l].error=!0:n[l].loading=!0;n[l]!==this._dataSetParameters[l]&&(this._dataSetParameters[l]=n[l],d=!0)});const f=this._generateDataSetKey(s,this._viewIdByEtn[s]);this._dataSetWrappers[f]&&this._targetEntityTypeNames&&_[a]===this._targetEntityTypeNames[a]||(this._dataSetWrappers[f]=new p.a(s,this._propKey,this._contextToken),this._dataSetWrappers[f].updatePreviousOwnProps(t),this._dataSetParameters[f]=null);const b=this._dataSetWrappers[f];if(b&&b.queryBuilder){const t=b.queryBuilder.getFirstError();!t||Object(o.b)(e)&&t.offlineModeSpecific||(m=!0,g=t.message,v=t.parameter)}if(h){b.setViewId(h.guid);let a=b.retrieveDataSetObject(e,t,i,r);a||(a=b.generateEmptyParam()),n[f]=a}else b.savePreviousOwnProps(t),n[f]=b.generateEmptyParam(),this._dataSetParameters[f]&&this._dataSetParameters[f].error?n[f].error=!0:n[f].loading=!0;n[f]!==this._dataSetParameters[f]&&(this._dataSetParameters[f]=n[f],d=!0)}if(this._targetEntityTypeNames=_,this._lookupConfigurationWrapper.updateConfiguration(O,t.descriptor),this._lookupMruWrapper.updateRecentItems(Object(f.h)(e),_,this._lookupConfigurationWrapper.getLookupConfiguration()),d&&(this.previousReturn=this.createParameterInstance(),this.previousReturn.getDataSetParameter=this.getDataSetParameter.bind(this),this.previousReturn.getTargetEntityNames=this.getTargetEntityNames.bind(this),this.previousReturn.entityMetadata=this._entityMetadata),m){if(this.previousReturn.error=!0,this.previousReturn.errorMessage=Object(E.b)(e,g),!this.previousReturn.errorMessage)return this.previousReturn.errorMessage=s.a.UnknownErrorMessage,this.previousReturn;v&&(this.previousReturn.errorMessage+=" "+v)}return this.previousReturn}_checkCustomViews(e,t){if(e&&e.metadata&&e.metadata.views&&t){const i=[],r=[];for(const t in e.metadata.views){e.metadata.views[t].isCustomView&&r.push(t)}for(const t in r){const n=r[t];i.push({id:n,name:e.metadata.views[n].title,queryType:u.a.CUSTOM_DEFINED_VIEW,isDefault:!1,isQuickFindQuery:!1,isUserView:!1,isPinned:!1,relatedEntityName:e.metadata.views[n].entityLogicalName,isAvailableInOffline:!0})}for(const e in t){const r=t[e],n=i.filter(e=>e.relatedEntityName===r),a={};n&&n.length>0&&(n.forEach(e=>{a[e.id]=e}),this._viewSelectorItemsByTypeById[r]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[r]),a))}}}_getDefaultView(e,t,i,r,n,s,o,l){const u=t&&t[i]&&t[i].parameters&&t[i].parameters.defaultviewid&&this._doesViewSupportEntity(o,e,t[i].parameters.defaultviewid)?new a.a(t[i].parameters.defaultviewid):null,c=r&&r[e]&&r[e].viewId?new a.a(r[e].viewId):null;let d;return d=this._shouldUseLookupService()?c||u:u&&l[e]&&l[e][t[i].parameters.defaultviewid]?u:s&&s.ViewId&&this._doesViewSupportEntity(o,e,s.ViewId)?new a.a(s.ViewId):u||n,"string"==typeof d&&(d=new a.a(d)),d}_doesViewSupportEntity(e,t,i){if(!e||!e.metadata||!e.metadata.views)return!0;const r=e.metadata.views[i];return!r||!r.entityLogicalName||r.entityLogicalName===t}_queryBuilderHasErrors(){return this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{if(this._dataSetWrappers[e].queryBuilder&&this._dataSetWrappers[e].queryBuilder.getFirstError())return!0}),!1}setControlReRender(e){this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setControlReRender(e)})}extendByFieldData(e,t=null){const i=this._queryBuilderHasErrors()&&this.previousReturn&&this.previousReturn.error,r=i?this.previousReturn.errorMessage:"";return null!==t&&this._previousFieldData!==t?(this._previousFieldData=t,this.previousReturn=Object.assign(Object.assign({},e),this._previousFieldData)):this.previousReturn=Object.assign(e,this._previousFieldData),this.previousReturn.entityMetadata=this._entityMetadata,i&&(this.previousReturn.error=i,this.previousReturn.errorMessage=r),this.previousReturn}linkToParameter(e,t){const i=t.refreshDataSetParameter;this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(e=>{this._dataSetWrappers[e].linkToParameter(this._dataSetParameters[e],t)}),e.refresh=this.refresh.bind(this,i),e.getRecentItems=this._lookupMruWrapper.getRecentItems.bind(this._lookupMruWrapper),e.getLookupConfiguration=this._lookupConfigurationWrapper.getLookupConfiguration.bind(this._lookupConfigurationWrapper),e.getAllViews=this.getAllViews.bind(this,{retrieveViewAction:t.retrieveViewAction,retrieveViewSelectorAction:t.retrieveViewSelectorAction}),e.getDefaultViewId=this.getDefaultViewId.bind(this),e.sendLookupRequest=this.searchLookup.bind(this,t),e.setMyRecordsOnlyFilter=this.setMyRecordsOnlyFilter.bind(this),e.runPreSearch=()=>{this._contextToken&&t.runPreSearch(this._contextToken,this._controlId,this._pageId)},e.executeNotifyHandlersThatEventOccurred=this._executeNotifyHandlersThatEventOccurred.bind(this,t)}_executeNotifyHandlersThatEventOccurred(e,t,i){return this._contextToken?e.executeNotifyHandlersThatEventOccurred({contextToken:this._contextToken,fieldName:this._controlId,pageId:this._pageId,record:i,eventName:t}):Promise.resolve(!1)}setMyRecordsOnlyFilter(e){this._dataSetWrappers&&Object.keys(this._dataSetWrappers).forEach(t=>{this._dataSetWrappers[t].setMyRecordsOnlyFilter(e)})}getDefaultViewId(e){return this._viewIdByEtn&&this._viewIdByEtn[e]?this._viewIdByEtn[e]:null}getAllViews(e,t,i){let r=[];if(!i){const i=e.retrieveViewAction(t,u.a.MAIN_APPLICATION_VIEW,u.b.savedview),n=e.retrieveViewAction(t,u.a.LOOKUP_VIEW,u.b.savedview);r=r.concat([i,n])}const n=this._dataSetWrappers[this._generateDataSetKey(t,this._viewIdByEtn[t])],a=n&&n.getAvailableViews()||[];if(n){const t=n.getMissingDescriptorIds();t&&t.forEach(t=>{r.push(n.retrieveView(t,e.retrieveViewAction))})}return Promise.all(r).then(()=>{const r=[];let n=[];if(!i){const i=e.retrieveViewSelectorAction(t,u.a.LOOKUP_VIEW).then(e=>{const i=e.viewSelectors[t][u.a[u.a.LOOKUP_VIEW]];i&&(this._viewSelectorItemsByTypeById[t]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[t]),i),Object.keys(i).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&r.push({viewId:e,viewName:i[e]?i[e].name:null,isDefault:i[e]?i[e].isDefault:null,isAvailableInOffline:i[e]?i[e].isAvailableInOffline:null,isUserView:i[e]?i[e].isUserView:null,isPinned:i[e]?i[e].isPinned:null,relatedEntityName:i[e]?i[e].relatedEntityName:null})}))}),s=e.retrieveViewSelectorAction(t,u.a.MAIN_APPLICATION_VIEW).then(e=>{const i=e.viewSelectors[t][u.a[u.a.MAIN_APPLICATION_VIEW]];i&&(this._viewSelectorItemsByTypeById[t]=Object.assign(Object.assign({},this._viewSelectorItemsByTypeById[t]),i),Object.keys(i).forEach(e=>{(0===a.length||a.indexOf(e.toLocaleLowerCase())>-1)&&r.push({viewId:e,viewName:i[e]?i[e].name:null,isDefault:!1,isAvailableInOffline:i[e]?i[e].isAvailableInOffline:null,isUserView:i[e]?i[e].isUserView:null,isPinned:i[e]?i[e].isPinned:null,relatedEntityName:i[e]?i[e].relatedEntityName:null})}))});n=n.concat([i,s])}const s=new Promise(e=>{for(const e in this._viewSelectorItemsByTypeById[t]){const i=this._viewSelectorItemsByTypeById[t][e];i.queryType===u.a.CUSTOM_DEFINED_VIEW&&r.push({viewId:e,viewName:i.name,isDefault:i.isDefault,isAvailableInOffline:i.isAvailableInOffline,isUserView:i.isUserView,isPinned:i.isPinned,relatedEntityName:i.relatedEntityName})}e()});return n.push(s),Promise.all(n).then(()=>r)})}refresh(e,t){let i;if(this._lookupServiceEnabled=!1,t)i=e(this._dataSetWrappers[this._generateDataSetKey(t,null)],this._contextToken);else{const t=[];for(const i of this._targetEntityTypeNames){const r=e(this._dataSetWrappers[this._generateDataSetKey(i,null)],this._contextToken);t.push(r)}i=Promise.all(t)}return i.then(()=>this)}getDataSetParameter(e,t){return this._dataSetParameters[this._generateDataSetKey(e,t)]}getTargetEntityNames(){return[...this._targetEntityTypeNames]}convertEntityDescriptorToEntityMetadata(e){return{IsReadOnlyInMobileClient:e.IsReadOnlyInMobileClient,IsEnabledInUnifiedInterface:e.IsEnabledInUnifiedInterface,DisplayName:e.DisplayName,PrimaryNameAttribute:e.PrimaryNameAttribute,LogicalName:e.EntityLogicalName,DisplayCollectionName:e.DisplayCollectionName,IconVectorName:e.IconVectorName,ObjectTypeCode:e.ObjectTypeCode,Attributes:null}}searchLookup(e,t,i,r,n,s){const o=[];let l=!1;for(const e in t){let i="";const u=this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`],c=u.getPagingObject(),d=new P.a(c.getPageLastIndex()+(r&&c.getHasNextPage()?1:0),c.getPageSize(),!0,null);if(i=(n&&n[e]?n[e]:null)||"",u.filteringObj){const e=u.filteringObj.getRootFilterExpression();if(e){i+=C.a.toLegacyFilterExpression(e).toFetchXml()||""}}i||(i=null),o.push(new O.a(e,t[e]&&new a.a(t[e]),i,s,null,null,d)),r?c.getHasNextPage()&&(l=!0,u.updatePagingObject(),u.getLatestData().loading=!0,u.setRefreshingStart()):l=!0}if(l){const r=new v.a(o,null,null,null,i,!0);return e.sendLookupRequest(r,this._contextToken,this._pageId,this._pageEtn,this._controlId,this._attributeName).then(()=>{for(const e in t){(this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`]).updateRefreshStatusToRequestBack()}}).catch(e=>{const i="Lookup Data Request encounters an exception";for(const e in t){(this._dataSetWrappers[`${e}:${t[e]}`]||this._dataSetWrappers[`${e}:${a.a.EMPTYGUIDSTRING}`]).setErrorStatus(i)}return b.a.error(T+": "+i,[{name:"APIName",value:T+".searchLookup"},{name:"error.Stack",value:JSON.stringify(e.stack)},{name:"controlId",value:this._controlId},{name:"entityTypeName",value:this._pageEtn}]),Promise.reject(new I.a(i))})}return Promise.resolve(null)}_shouldUseLookupService(e,t){return Object(w.c)(this._lookupServiceEnabled)&&(this._lookupServiceEnabled=Object(_.c)(e,S.mc),"MscrmControls.FieldControls.SimpleLookupControl"!==t&&(this._lookupServiceEnabled=!1)),this._lookupServiceEnabled}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class R extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class A extends N{createParameterInstance(){return new R}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class k extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class L extends N{createParameterInstance(){return new k}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class M extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class x extends N{createParameterInstance(){return new M}}var V=i("KVHF");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class B extends d{}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class U extends N{createParameterInstance(){return new B}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const z="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlLookupSelector";var W=i("NbYl"),q=i("Z/4N"),G=i("Z+6x"),H=i("S2mk");var K=i("odYE"),Q=i("LbMF"),Y=i("5Oca"),X=i("bT7G"),Z=i("eXjw");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class ${constructor(e,t,i,r=null,n=null,s=null){this.status=0,this.formDescriptor=e,this.entityName=t,this.recordId=a.a.toString(i),this.associatedEntityLabel=r,this.associatedEntityRecordName=n,this.entityImageUrl=s}getComponentNameByControlId(e){throw new Error("Not initialized")}getComponentPropsByControlId(e){throw new Error("Not initialized")}retrieveRecordDataForForm(e,t){throw new Error("Not initialized")}}var J=i("y60j"),ee=i("VqBP"),te=i("iZ7K"),ie=i("BJ7u"),re=i("GYEz"),ne=i("w1eR"),ae=i("CYtR"),se=i("4mtW");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class oe{constructor(){this.objectWrapperType=4,this._formRequested=!1,this._entityRequested=!1,this._recordRequested=!1,this._formDependenciesLoaded=!0,this._actions=null,this._formType=null,this._wrapperStatus=-1,this._memoizedComponents={},this._entityPrimaryImageField=null,this._handleFetchFailure=this._handleFetchFailure.bind(this),this._checkForm=this._checkForm.bind(this),this._checkEntity=this._checkEntity.bind(this)}getParameterManifestType(){return r.a.QuickForm}ensureDataInitialization(e){this._actions={retrieveForm:e.retrieveForm,retrieveEntityData:e.retrieveEntityData,retrieveRecordData:e.retrieveRecordForForm,forceUpdate:e.forceUpdate},this._fetchData()}_fetchData(e){var t,i;if(this._actions){if(2!==this._wrapperStatus||this._entityRequested||(this._entityRequested=!0,this._actions.retrieveEntityData(this.previousFormParameter.entityName).then(this._checkEntity).catch(this._handleFetchFailure)),0===this._wrapperStatus&&!this._formRequested){this._formRequested=!0,this._formDependenciesLoaded=!1;const e=new K.a(this.previousFormParameter.entityName,a.a.tryParse(this.previousFormParameter.recordId));this._actions.retrieveForm(e,null===(i=null===(t=this.previousFormParameter.formDescriptor)||void 0===t?void 0:t.Id)||void 0===i?void 0:i.guid,this._formType).then(this._checkForm).catch(this._handleFetchFailure)}if(3===this._wrapperStatus&&!this._recordRequested){this._recordRequested=!0;const e=new K.a(this.previousFormParameter.entityName,a.a.tryParse(this.previousFormParameter.recordId));this._actions.retrieveRecordData(e,this.previousFormParameter.formDescriptor.Id.guid,null,[],!0).catch(this._handleFetchFailure)}}}_checkEntity(e){e&&e.entities&&e.entities.hasOwnProperty(this.previousFormParameter.entityName)||this._handleFetchFailure(null)}_checkForm(e){!e||a.a.equals(a.a.EMPTY,e)?this._handleFetchFailure(null):this._formDependenciesLoaded=!0}_handleFetchFailure(e){this._wrapperStatus=5;const t=this.previousFormParameter&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.Id?this.previousFormParameter.formDescriptor.Id:a.a.EMPTY,i=this.previousFormParameter&&this.previousFormParameter.entityName?this.previousFormParameter.entityName:null;this.retrieveErrorFormObject(t,i),this._actions.forceUpdate()}static _isControlDefaultMapping(e,t){const i=e.formDescriptor.Controls[t];return!i||!i.UniqueId||!e.formDescriptor.ControlConfigurations[i.UniqueId]}static _getDefaultControlConfiguration(e,t,i){const r=t.formDescriptor.Controls[i],n=t.entityName,s=Object(ee.b)(e,n,r),o=r.ClassId&&a.a.toString(r.ClassId);return Object(H.q)(r.Id,r.DataFieldName,s,r,n,o)}static _createDummyFormDescriptor(e){return{initialized:Z.a.Initializing,Tabs:[],Sections:{},Controls:{},ControlConfigurations:{},Id:e,Header:[],Footer:[],HiddenFields:[]}}retrieveErrorFormObject(e,t){this._wrapperStatus=5;const i=oe._createDummyFormDescriptor(e);return this.previousFormParameter&&3===this.previousFormParameter.status||(this.previousFormParameter=new $(i,t,null,null,null,null),this.previousFormParameter.status=3),this.previousFormParameter}retrieveOfflineFormObject(e,t){if(!this.previousFormParameter||6!==this._wrapperStatus){this._wrapperStatus=6;const i=oe._createDummyFormDescriptor(e);this.previousFormParameter=new $(i,t,null,null,null,null)}return this.previousFormParameter}retrieveFormObject(e,t,i,r,n,s,l,u,c,d){let p=this.previousFormParameter&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.initialized===Z.a.Initialized&&a.a.equals(i,this.previousFormParameter.formDescriptor.Id)?this.previousFormParameter.formDescriptor:Object(J.j)(e,i);if(this.previousFormParameter&&this.previousFormParameter.formDescriptor&&r===Object(ie.a)(6)){let i;const r=this.previousFormParameter.formDescriptor.Controls?Object.keys(this.previousFormParameter.formDescriptor.Controls):null;if(r&&r.forEach(r=>{const n=Object(h.Mc)(e,{id:t.id,controlName:r},u),a=this.previousFormParameter.formDescriptor.Controls[r],s=n&&a.Visible!==n.visible,o=n&&a.Label!==n.label&&null!=n.label;n&&(s||o)&&(i||(i={}),i[r]=Object.assign(Object.assign({},a),{Visible:s?n.visible:a.Visible,Label:o?n.label:a.Label}))}),i){p=Object.assign({},this.previousFormParameter.formDescriptor);const e=Object.assign({},this.previousFormParameter.formDescriptor.Controls);Object.keys(i).forEach(t=>{e[t]=i[t]}),p.Controls=e}}this._formType=r,d&&(this._chartDataRequestType=d);let m=2;const g=Object(te.h)(e,n);this._entityPrimaryImageField=g?g.PrimaryImageAttribute:null;const f=t.descriptor.ShowLabel&&t.descriptor.Label?t.descriptor.Label:g?g.DisplayName:"";if(p&&p.initialized===Z.a.Error||5===this._wrapperStatus)return b.a.info("Form: retrieveFormObject encountered error",[{name:"formId",value:a.a.toString(i)},{name:"entityName",value:n},{name:"controlId",value:t?t.controlId:""}]),this.retrieveErrorFormObject(i,n);if(!Object(_.c)(e,S.Pc)&&!Object(o.b)(e))return this.retrieveOfflineFormObject(i,n);if(!(Object(o.b)(e)||this.previousFormParameter&&6===this._wrapperStatus)){const t=Object(h.Xb)(e);if(t&&!t.has(g.EntityLogicalName))return this._wrapperStatus=6,this.previousFormParameter=new $(null,n,null,null,null,null),this.previousFormParameter}if(a.a.equals(i,a.a.EMPTY)||!p||p.initialized===Z.a.Initializing||p.initialized===Z.a.Uninitialized||p.initialized===Z.a.Initialized&&!this._formDependenciesLoaded){const t=p?p.initialized:null;let r=!1;return(!this.previousFormParameter||0!==this.previousFormParameter.status||0!==this._wrapperStatus&&-1!==this._wrapperStatus)&&(this.previousFormParameter&&this.previousFormParameter.formDescriptor&&!a.a.equals(this.previousFormParameter.formDescriptor.Id,i)&&(r=!0),p=oe._createDummyFormDescriptor(i),this.previousFormParameter=new $(p,n,null,f,null,null),this.previousFormParameter.status=0),this._wrapperStatus=a.a.equals(i,a.a.EMPTY)?-1:t!==Z.a.Initializing||this._formRequested?0:1,r&&(this._wrapperStatus=0,this._formRequested=!1),this._fetchData(e),this.previousFormParameter}const y=c||this._getAssociatedRecordPrimaryAttributeValue(e,t.id,n,s,u);if(y||null==s||a.a.equals(s,a.a.EMPTY)?m=2:(this._wrapperStatus=g&&g.Initialized===Z.a.Initialized?3:2,m=1),this.previousFormParameter&&this.previousFormParameter.formDescriptor===p&&this.previousFormParameter.formDescriptor&&this.previousFormParameter.formDescriptor.initialized===p.initialized&&a.a.equals(this.previousFormParameter.formDescriptor.Id,i)&&(null===this.previousFormParameter.recordId&&null===s||this.previousFormParameter.recordId===s.guid)&&this.previousFormParameter.entityImageUrl===l&&this.previousFormParameter.associatedEntityRecordName===y)return 1===m&&this._fetchData(e),this.previousFormParameter;const v=new $(p,n,s,f,y,l);return v.status=m,v.getComponentPropsByControlId=this.getComponentPropsByControlId.bind(this,e,v),v.getComponentNameByControlId=this.getComponentNameByControlId.bind(this,e,v),v.firstDataRequestType=this._getFirstDataRequestType(e,t,u),this.previousFormParameter=v,1===m&&this._fetchData(e),v}linkToParameter(e,t){const i=t.retrieveRecordDataForForm,r=e.formDescriptor&&e.formDescriptor.Id?e.formDescriptor.Id.guid:null,n=this._entityPrimaryImageField?[this._entityPrimaryImageField+"_url"]:null;e.retrieveRecordDataForForm=this._retrieveRecordDataForForm.bind(this,new K.a(e.entityName,a.a.tryParse(e.recordId)),r,i,null,n)}getComponentNameByControlId(e,t,i){const r=t.formDescriptor.Controls[i];if(!oe._isControlDefaultMapping(t,i))return r.UniqueId;const n=oe._getDefaultControlConfiguration(e,t,i);return Object(H.z)(n)}getComponentPropsByControlId(e,t,i,r=!1){this._memoizedComponents[i]||(this._memoizedComponents[i]={controlId:i});const n=this._memoizedComponents[i],s=t.entityName;let o;const l=t.formDescriptor.Controls[i];if(oe._isControlDefaultMapping(t,i)||r)if(oe._isQuickFormChart(e,l)){const t=!Object(_.a)(e,S.v,S.Lc,S.w);o=Object(H.w)(l.Parameters,this._chartDataRequestType,t)}else o=oe._getDefaultControlConfiguration(e,t,i);else{o=t.formDescriptor.ControlConfigurations[l.UniqueId].CustomControls[0];const i=Object(re.a)(e);if(Object(_.c)(e,S.ne)&&i!==ne.a.MailApp&&l.DataFieldName){const t=Object(q.e)(e,o.Name);t&&(o=Object(H.F)(o,t))}}const u=t.recordId,c=t.formDescriptor.Id;let d;return d=n.nestedFormProps&&n.nestedFormProps.EntityName===s&&n.nestedFormProps.RecordId===u&&n.nestedFormProps===c?n.nestedFormProps:{EntityName:s,RecordId:t.recordId,FormId:a.a.toString(t.formDescriptor.Id)},o===n.configuration&&l===n.descriptor&&d===n.nestedFormProps||(n.configuration=o,n.descriptor=l,n.nestedFormProps=d,n.componentProps={configuration:o,descriptor:l,nestedFormProps:d}),Object(_.c)(e,S.jd)&&n.componentProps.configuration.CustomControlId===ae.a&&(n.componentProps.configuration=Object(se.a)(n.componentProps.configuration,s)),n.componentProps}getLatestData(){return this.previousFormParameter}_getAssociatedRecordPrimaryAttributeValue(e,t,i,r,n){const s=Object(Q.h)(e,i),o=new K.a(i,r||a.a.EMPTY),l=Object(h.ac)(e,t,n),u=Object(X.d)(e,l,o,s);return u&&u.value?u.value:null}_retrieveRecordDataForForm(e,t,i,r,n){i(e,t,r,n)}static _isQuickFormChart(e,t){var i;return Object(_.c)(e,S.z)&&!a.a.isNullOrEmpty(null===(i=null==t?void 0:t.Parameters)||void 0===i?void 0:i.VisualizationId)&&"Chart"===t.Parameters.ChartGridMode}_getFirstDataRequestType(e,t,i){if(!i)return null;if(!Object(h.Tc)(e,t.id,t.descriptor))return null;const r=Object(h.ac)(e,t.id,i.parentContextToken);return Object(X.b)(e,r)?null:1}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var le=i("3mEc"),ue=i("NjDY"),ce=i("b8TU"),de=i("unFF"),pe=i("jq7Z");function he(e,t){return"web"===function(e){if(e<425)return"mobile";if(e<600)return"tablet";return"web"}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(Object(ce.c)(e))||!1!==t}function me(e){return e*function(){let e;if(void 0===e){const t=window.document.getElementsByTagName("body")[0],i=window.getComputedStyle(t,null).getPropertyValue("font-size");e=parseInt(i.replace("px",""),10)}return e}()}class ge{constructor(e){Object.assign(this,e)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class fe{constructor(){this.previousReturn=new ge({IsMicrosoftFlowEnabled:!1,MicrosoftFlowFirstPartyIntegrationSiteUrl:"",MicrosoftFlowDestinationUrl:"",MicrosoftFlowEnvironmentId:""})}retrieveMicrosoftFlowObject(e,t,i,r){const n=function(e){return{isMicrosoftFlowEnabled:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.isMicrosoftFlowEnabled,microsoftFlowFirstPartyIntegrationSiteUrl:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowFirstPartyIntegrationSiteUrl,microsoftFlowDestinationUrl:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowDestinationUrl,microsoftFlowEnvironmentId:e&&e.organization&&e.organization.organizationSettings&&e.organization.organizationSettings.microsoftFlowEnvironmentId}}(e),a={IsMicrosoftFlowEnabled:n.isMicrosoftFlowEnabled,MicrosoftFlowFirstPartyIntegrationSiteUrl:n.microsoftFlowFirstPartyIntegrationSiteUrl,MicrosoftFlowDestinationUrl:n.microsoftFlowDestinationUrl,MicrosoftFlowEnvironmentId:n.microsoftFlowEnvironmentId};return this.previousReturn=a,a}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function be(e,t,i,r,n){return r.Parameters[e].Value}var ye=i("lLEV");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const ve=[r.a.Currency,r.a.DateAndTimeDateAndTime,r.a.DateAndTimeDateOnly,r.a.Decimal,r.a.FP,r.a.Multiple,r.a.OptionSet,r.a.SingleLineEmail,r.a.SingleLinePhone,r.a.SingleLineText,r.a.SingleLineTextArea,r.a.SingleLineTickerSymbol,r.a.SingleLineURL,r.a.TwoOptions,r.a.WholeDuration,r.a.WholeLanguage,r.a.WholeNone,r.a.WholeTimeZone],Oe=[r.a.LookupSimple,r.a.LookupPartyList,r.a.LookupRegarding,r.a.LookupOwner,r.a.LookupCustomer,r.a.LookupMultiEntity],_e=[0,1,2,3,4],Pe={};function Se(e,t,i){for(const r of t)e[r]=i}function we(e,...t){for(const i of t)Pe.hasOwnProperty(i)||Se(Pe,[i],e)}function Ie(){let e=null,t={};const i={},n=function(){const e={};return t=>(e[t]||(e[t]=t in Pe?Pe[t]():Pe[r.a.SingleLineText]()),e[t])}();return(a,o,l,u,c,d)=>{const p=l.configuration?l.configuration.CustomControlId:"";b.a.info(p+".CustomControlFramework.Selectors.CustomControlHostDynamicDataSelectors: createGetDynamicData started");let h=!1,m=!0;const g={},f=[];if(a&&a.Parameters&&Object.keys(a.Parameters).length){const e=Object(q.e)(u,l.configuration.CustomControlId);for(const o in a.Parameters){const p=a.Parameters[o],b=n(p.Type)(o,u,l,a,c,d),y=b;let v=!1;if(e&&b instanceof s.a||b instanceof G.a){if(e.Properties.DataSetDefinitions[o]&&!b.isValidParameterConfiguration(p))continue}(null===b||(b instanceof s.a||b instanceof G.a)&&b.getParameterManifestType()===r.a.Grid&&(!b.getLatestData().columns||0===b.getLatestData().columns.length)||y&&3===y.objectWrapperType&&b instanceof ye.a&&b.isLoading())&&(m=!!(b instanceof W.a&&b.getLatestData())),t.hasOwnProperty(o)&&t[o]===b||(g[o]=b,f.push(o),h=!0,v=!0);let O=!1;y&&(O=-1!==_e.indexOf(y.objectWrapperType)),O||(O=b instanceof s.a||b instanceof G.a||b instanceof N),O&&b.getLatestData()!==i[o]&&(g[o]=b,i[o]=b.getLatestData(),v||f.push(o),h=!0)}}else e&&e.response&&!Object.keys(e.response.parameters).length||(h=!0);return h?(f.push("parameters"),t=Object.assign(Object.assign({},t),g),e={response:{parameters:t,dataReady:m,updated:!0},updatedProperties:f}):(e.response.updated=!1,e.updatedProperties=f),b.a.info(p+".CustomControlFramework.Selectors.CustomControlHostDynamicDataSelectors: createGetDynamicData finished"),e}}Se(Pe,ve,n.a),Se(Pe,Oe,(function(){const e={},t={},i={},s=Object(n.a)(),o={};return(n,l,u,c,d,p)=>{b.a.info(u.controlId+"."+z+": createGetLookupData started");let h=!1;const m=c.Parameters[n],g=s(n,l,u,c,d,p);if(!o.hasOwnProperty(n)||!o[n])switch(m.Type){case r.a.LookupCustomer:o[n]=new A(n,p);break;case r.a.LookupOwner:o[n]=new L(n,p);break;case r.a.LookupSimple:o[n]=new V.a(n,p);break;case r.a.LookupPartyList:o[n]=new x(n,p);break;case r.a.LookupRegarding:o[n]=new U(n,p);break;case r.a.LookupMultiEntity:o[n]=new N(n,p);break;default:throw new Error("Unknown parameter type")}let f=o[n];const y=o[n].getLatestData(),v=m;if(y&&v&&y.getViewId&&!a.a.equals(a.a.fromExternalGuid(y.getViewId()),a.a.fromExternalGuid(v.ViewId))){const e=f;f=e.refreshingStatus&&0!==e.refreshingStatus?new V.a(n,p,!0):new V.a(n,p,!1),o[n]=f}const O=f;if(null===g)return b.a.info(u.controlId+"."+z+": createGetLookupData return null"),null;t.hasOwnProperty(n)&&t[n]===g||(t[n]=g,h=!0);const _=f.retrieveDataSetObject(l,u,c,d);if(i.hasOwnProperty(n)&&i[n]&&_===i[n]||(i[n]=_,h=!0),f instanceof V.a)f.extendByFieldData(_,g);else{if(!(f instanceof N))throw b.a.error(u.controlId+"."+z+": createGetLookupData encountered error, unknown Lookup parameter wrapper type"),new Error("Unknown Lookup parameter wrapper type");f.extendByFieldData(_,g)}return h&&(e[n]=O),b.a.info(u.controlId+"."+z+": createGetLookupData finished"),e[n]}})),Se(Pe,[r.a.Grid],(function(){const e={},t={},i={};return(r,n,a,o,l,u)=>{b.a.info(a.configuration.CustomControlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDataSetDataSelector: createGetDataSetData started");let c=!1;if(!i.hasOwnProperty(r)||!i[r]){const e=o.Parameters[r],t=Object(q.e)(n,o.CustomControlId);e.ChartGridMode&&"Chart"===e.ChartGridMode?i[r]=new W.a(r,u):t&&Object(H.i)(t)?i[r]=new G.a(r,null,u):i[r]=new s.a(r,null,u)}const d=i[r],p=d.retrieveDataSetObject(n,a,o,l);d instanceof G.a&&d.updateControlMemoizedParameter(n,p,!1,null),t.hasOwnProperty(r)&&t[r]&&p===t[r]||(t[r]=p,c=!0);const h=d;return c&&(e[r]=h),b.a.info(a.configuration.CustomControlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlDataSetDataSelector: createGetDataSetData finished"),e[r]}})),Se(Pe,[r.a.WebResourceHtmlControl],(function(){const e={};return(t,i,n,a,s)=>{let o;b.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlWebResourcesSelector: createGetWebResourceHtmlData started");const l=a.Parameters[t],u=Object(le.l)(l),c=Object(le.g)(i,u);if(c){let e=l.Url;e=Object(ue.t)(i)+e;const t=he(i,c.isEnabledForMobileClient);o={ControlId:l.ControlId,Title:l.Title,Url:e,Visible:t||l.Visible,ShowLabel:l.ShowLabel,Label:l.Label,Type:r.a.WebResourceHtmlControl,PageType:l.PageType,WebResourceType:l.WebResourceType?l.WebResourceType:-1,ControlParameters:l.ControlParameters}}else{let e=null;const t=Object(pe.a)(i,n.id);if(e=t&&t.webResourcePageDescriptor?t.webResourcePageDescriptor:Object(le.h)(i,n.descriptor),!e)return null;let a={};n.descriptor&&n.descriptor.Parameters&&(a=Object(le.i)(n.descriptor));let s=!0;if("FullPage"===e.pageType){const t=function(e,t){if(e&&e.metadata&&e.metadata.webResourceDescriptorsByName)return e.metadata.webResourceDescriptorsByName[t];return null}(i,e.Name);t&&void 0!==t.isEnabledForMobileClient&&(s=he(i,t.isEnabledForMobileClient))}const l=Object(de.a)(i);o={ControlId:e.controlId,Title:e.title,Url:e.url,Visible:"FullPage"===e.pageType?s:e.visible,ShowLabel:e.showLabel,Label:e.label,Type:r.a.WebResourceHtmlControl,PageType:e.pageType,WebResourceType:e.webresourceType,CellHeight:me(l.sizes.Section.cellHeightInRem),ControlParameters:a,WebResourceName:e.Name?e.Name:""}}return e.hasOwnProperty(t)&&e[t].Url===o.Url||(e[t]=o),b.a.info(n.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlWebResourcesSelector: createGetWebResourceHtmlData finished"),e[t]}})),Se(Pe,[r.a.MicrosoftFlow],(function(){return(e,t,i,r,n)=>{b.a.info(i.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlMicrosoftFlowSelector: createGetMicrosoftFlowData started");const a=new fe;return a.retrieveMicrosoftFlowObject(t,i,r,n),b.a.info(i.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlMicrosoftFlowSelector: createGetMicrosoftFlowData finished"),a}})),Se(Pe,[r.a.QuickForm,"Form.Card"],(function(){const e={},t={},i={};return(r,n,s,o,l,u)=>{b.a.info(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData started");let c,d,p=!1;const m=o.Parameters[r].Value.split("|");if(m.length<2)throw b.a.error(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData encountered error, invalid form configuration provided"),new Error("Invalid form configuration provided");let g=m[0],f=null;if(g.indexOf(":")>-1){const e=g.split(":");g=e[0],f=e[1]}f=f||Object(ie.a)(6);const y=m[1];let v=a.a.EMPTY,O=null,_=y;if(m.length>=3){v=a.a.tryParse(m[2]);const e=_?Object(te.h)(n,_):null,t=!a.a.isNullOrEmpty(v)&&_?new K.a(_,v):null,i=e&&t?Object(Y.j)(n,t,e.PrimaryImageAttribute+"_url"):null;O=i?i.value:null}else{const e=new K.a(l.entityTypeName,a.a.isNullOrEmpty(l.id)?a.a.EMPTY:l.id),t=Object(h.ac)(n,s.id,u.parentContextToken);c=Object(X.d)(n,t,e,y);const i=c?c.reference:null;if(v=i&&i.id?i.id:a.a.EMPTY,d=c&&c.reference?c.reference.name:"",_=i?i.etn:null,!_){const e=Object(Q.a)(n,l.entityTypeName,y),t=e?e.Targets:null;_=t&&t.length?t[0]:null}const r=_?Object(te.h)(n,_):null,o=r&&i?Object(Y.j)(n,i,r.PrimaryImageAttribute+"_url"):null;O=o?o.value:null}i.hasOwnProperty(r)&&i[r]||(i[r]=new oe);const P=i[r],S=a.a.tryParse(g),w=o.Parameters[r].FirstDataRequestType,I=P.retrieveFormObject(n,s,S,f,_,v,O,u,d,w);t.hasOwnProperty(r)&&t[r]&&I===t[r]||(p=!0);const j=P;return p&&(t[r]=I,e[r]=j),b.a.info(s.controlId+".CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlQuickFormSelector: createGetQuickFormData finished"),e[r]}})),Se(Pe,["GroupDefinition"],()=>be)},qTme:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var r=i("dHD5"),n=i("BFlg");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const a="dataSnapshotNumber.setFormMetadata";function s(e,t,i){return{type:"grid.setCustomFilter.async",execute({dispatch:s,getState:o},l){const u=l.TraceManager.getTracer(n.z),c=n.x+".setDataSnapshotNumberAction";try{u.info("Updating the data snapshot id for the grid. ");const n=Object(r.v)(i);return s(function(e,t,i){return{type:a,payload:t,meta:{pageId:e,contextKey:i}}}(e,t,n)),l.EventManager.ReportComponentSuccess(c),Promise.resolve()}catch(e){const t="Updating data snapshot id failed with error : "+e.message;l.EventManager.ReportComponentFailure(c,Error(t))}}}}},r0As:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return u})),i.d(t,"f",(function(){return c})),i.d(t,"e",(function(){return d})),i.d(t,"h",(function(){return g})),i.d(t,"g",(function(){return f})),i.d(t,"j",(function(){return m})),i.d(t,"c",(function(){return O})),i.d(t,"a",(function(){return _})),i.d(t,"i",(function(){return v}));var r=i("kSDG"),n=i("nfCs");function a(e,t,i,r){return{name:e,aliasName:t,descending:i,entity:r||null}}function s(e,t,i,r){return o(e,t,i,null,r)}function o(e,t,i,r,n){const a={getState:n,entityName:e,tableAliasCount:0,tableAliases:new Array,attributes:[],attributesByName:new Map,orderByAttributes:[],groupByAttributes:[],aggregateAttributes:[],linkedEntities:[],parentEntity:t||null,useLimitStatement:!0,top:5e3,offset:1,alias:r,filters:[]};return l(a),t?(a.baseEntity=t.baseEntity,a.joinType=i||0):a.baseEntity=a,a}function l(e){if(e.entityName){const t=String.format("{0}{1}",e.entityName,e.tableAliasCount++);e.tableAliases.push(t),e.tableAlias=t}else e.tableAlias=""}function u(e){return(new XMLSerializer).serializeToString(e.fetchXmlDoc.documentElement)}function c(e,t){const i=new DOMParser;e.fetchXmlDoc=i.parseFromString(t,"text/xml");const r=e.fetchXmlDoc.getElementsByTagName("fetch");r&&r.length>0&&d(e,r[0])}function d(e,t){const i=new DOMParser,s=new XMLSerializer;e.fetchXmlDoc=i.parseFromString(s.serializeToString(t),"text/xml"),e.hasAggregate="true"===p(t,"aggregate");const u=p(t,"count");u&&(e.top=Number(u));const c=t.getElementsByTagName("entity");let h=c&&c.length>0?c[0]:null;h||"link-entity"!==t.tagName||(h=t),e.parentEntity||(e.tableAliasCount=0,e.tableAliases=[],l(e),e.baseEntity=e),function(e,t){e.entityName=p(t,"name");const i=t.childNodes;for(let t=0;t<i.length;t++){const s=i.item(t);if(!s||!s.tagName)continue;switch(s.tagName.toLowerCase()){case"attribute":{let t=null;const i=Object(n.b)(p(s,"dategrouping"));i>=0&&(t=Object(n.a)(i));const a=p(s,"name"),o=p(s,"alias"),l=Object(r.a)(a,o,e,t);e.attributesByName.set(null===o?a:o,l),e.attributes.push(l);const u=p(s,"aggregate");u&&(l.hasAggregate=!0,l.aggregateType=u,e.aggregateAttributes.push(l));const c=p(s,"groupby");c&&"true"===c&&(l.hasGroupBy=!0,e.groupByAttributes.push(l));break}case"order":{const t=p(s,"alias"),i=p(s,"attribute"),r=p(s,"descending"),n=a(i,t,r&&"true"===r,e);e.orderByAttributes.push(n);break}case"link-entity":{const t=s.getAttribute("name"),i=s.getAttribute("from"),r=s.getAttribute("to"),n=o(t,e,null,s.getAttribute("alias"),e.getState);P(n,i,r,"eq",y(s)),d(n,s),e.linkedEntities.push(n);break}case"filter":e.filters.push(s.outerHTML);break;default:throw new Error("Unexpected Node Name.")}}}(e,h)}function p(e,t){return e.getAttribute(t)}function h(e){let t=e.fetchXmlDoc.getElementsByTagName("entity")[0];return t||(t=e.fetchXmlDoc.getElementsByTagName("link-entity")[0]),t}function m(e,t){!function e(t,i){const r=new Array;for(let n=0,a=t.childNodes.length;n<a;n++){const a=t.childNodes[n];switch(a.nodeName){case"attribute":i?i&&p(a,i)&&"true"===p(a,i).toLowerCase()&&r.push(a):r.push(a);break;case"order":r.push(a);break;case"link-entity":e(a,i),r.push(a)}}for(let e=0;e<r.length;e++)t.removeChild(r[e])}(e.fetchXmlDoc.getElementsByTagName("entity")[0],t),function(e){if(e.hasAggregate){for(let t=e.groupByAttributes.length-1;t>=0;t--)e.groupByAttributes[t].hasGroupBy&&e.groupByAttributes.splice(t,1);for(let t=e.orderByAttributes.length-1;t>=0;t--)e.orderByAttributes.splice(t,1)}}(e)}function g(e,t,i,r,n){const s=i?null:t.attributeName?t.attributeName:t.aliasName,o=i?t.aliasName?t.aliasName:t.attributeName:null;!function(e,t,i,r,n){const a=e.fetchXmlDoc.createElement("order");if(t){const i=e.fetchXmlDoc.createAttribute("attribute");i.value=t,a.attributes.setNamedItem(i)}if(i){const t=e.fetchXmlDoc.createAttribute("alias");t.value=i,a.attributes.setNamedItem(t)}const s=e.fetchXmlDoc.createAttribute("descending");s.value=r?"true":"false",a.attributes.setNamedItem(s);const o=h(e);if(n<0)return void o.appendChild(a);const l=o.childNodes;let u=-1;for(let e=0;e<l.length;e++){const t=l[e],i=t.nodeName;if(i&&"order"===i.toLowerCase()&&(u++,u===n))return void o.insertBefore(a,t)}o.appendChild(a)}(e,s,o,r,n);const l=a(s,o,r,e);n<0||n>=e.orderByAttributes.length?e.orderByAttributes.push(l):e.orderByAttributes.splice(n,0,l)}function f(e,t,i,r,n,a,s){const o=e.fetchXmlDoc.createElement("attribute");o.attributes.setNamedItem(b(e,"name",t)),i&&o.attributes.setNamedItem(b(e,"alias",i)),r&&o.attributes.setNamedItem(b(e,"groupby",r)),n&&o.attributes.setNamedItem(b(e,"aggregate",n)),a&&(o.attributes.setNamedItem(b(e,"dategrouping",a)),s?o.attributes.setNamedItem(b(e,"usertimezone",s)):o.attributes.setNamedItem(b(e,"usertimezone","true")));h(e).appendChild(o)}function b(e,t,i){const r=e.fetchXmlDoc.createAttribute(t);return r.value=i,r}function y(e){const t=p(e,"link-type");if(!t)return 0;switch(t){case"natural":return 2;case"inner":return 0;case"outer":return 1;case"matchfirstrowusingcrossapply":return 3;case"in":return 4;case"exists":return 5;default:throw new Error("EntityQueryExpression.GetLinkType: Invalid join type!")}}function v(e){const t=h(e);!function(e){const t=Array.from(e.childNodes).filter(e=>"link-entity"===e.tagName);for(let i=0;i<t.length;i++)e.removeChild(t[i])}(t),function(e,t){for(let i=0;i<t.linkedEntities.length;i++){const r=h(t.linkedEntities[i]).cloneNode(!0);e.appendChild(r)}}(t,e)}function O(e,t){return function(e,t,i,r,n,a){const s=o(e,i,null,t,i.getState);P(s,r,n,"eq",0);const l=function(e,t){const i=t.fetchXmlDoc.createElement("link-entity");if(e.entityName){const r=t.fetchXmlDoc.createAttribute("name");r.value=e.entityName,i.attributes.setNamedItem(r)}if(e.linkFromAttribute){const r=t.fetchXmlDoc.createAttribute("from");r.value=e.linkFromAttribute,i.attributes.setNamedItem(r)}if(e.linkToAttribute){const r=t.fetchXmlDoc.createAttribute("to");r.value=e.linkToAttribute,i.attributes.setNamedItem(r)}if(null!==e.joinType){const r=t.fetchXmlDoc.createAttribute("link-type");r.value=function(e){switch(e){case 2:return"natural";case 0:return"inner";case 1:return"outer";case 3:return"matchfirstrowusingcrossapply";case 4:return"in";case 5:return"exists";default:throw new Error("EntityQueryExpression.convertLinkTypeToString: Invalid join type!")}}(e.joinType),i.attributes.setNamedItem(r)}return i}(s,i);return d(s,l),s}(e.entityName,e.alias,t,e.linkFromAttribute,e.linkToAttribute,e.joinType)}function _(e,t){const i=h(t),r=h(e);i.appendChild(r.cloneNode(!0))}function P(e,t,i,r,n){e.linkFromAttribute=t,e.linkToAttribute=i,e.conditionOperator=r,e.joinType=n}},sozv:function(e,t,i){"use strict";i.d(t,"a",(function(){return k})),i.d(t,"b",(function(){return A}));var r=i("odYE"),n=i("SAYH"),a=i("eXjw"),s=i("455M"),o=i("i1f0"),l=i("WPtp"),u=i("LbMF"),c=i("5Oca"),d=i("LFkE"),p=i("y60j"),h=i("bT7G"),m=i("NjDY"),g=i("arV0"),f=i("IqkD"),b=i("2ciq"),y=i("Xd5/"),v=i("dHD5"),O=i("jq7Z");var _=i("H523"),P=i("0cBP");var S=i("3hnk"),w=i("JwRZ"),I=i("5ZBI"),j=i("tJdb"),C=i("qLnS"),D=i("VcAV"),E=i("zmL5"),T=i("6QGX"),F=i("64CY"),N=i("7Sr4");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const R="CustomControlFramework.Selectors.DynamicDataSelectors.CustomControlFieldDataSelector";function A(e,t){const i=Object(p.j)(e,t);return!!i&&7===i.FormType}function k(){const e={},t={},i={};let w;const k={};let V=[],B=null,U=null;const z=function(){let e,t;return(i,r,n)=>{const a=Object(o.A)(i,r,n);if(!a)return t=a,e=null,null;if(a===t)return e;const s=Object.keys(a);let l=null,u=null,c=null;for(let e=0;e<s.length;e++){const t=a[s[e]];l||t.notificationLevel!==_.a.error||(l=t),u||t.notificationLevel!==_.a.recommendation||(u=t),c||t.notificationLevel!==_.a.information||(c=t)}return t=a,e={error:l,recommendation:u,information:c},e}}();let W=null;return(_,q,G,H,K,Q)=>{var Y;I.a.info(G.controlId+"."+R+": createGetFieldParameterData started");const X=Object(f.w)(q),Z=Object(m.x)(q),$=G.formInfo&&G.formInfo.FormId?new n.a(G.formInfo.FormId):Object(E.b)(q,G.id),J=function(e,t){const i=Object(p.j)(e,t);return!!i&&10===i.FormType}(q,$),ee=A(q,$),te=G.id;let ie,re,ne;G.formInfo&&G.formInfo.EntityName&&G.formInfo.RecordId?(ie=G.formInfo.EntityName,re=new n.a(G.formInfo.RecordId)):(ie=K.entityTypeName,re=K.id);let ae=!1;const se=new r.a(ie,K.id),oe=H.Parameters[_];let le={};const ue=0===oe.Usage,ce=1===oe.Usage,de=2===oe.Usage;if(_.includes("isEmpty")){const t="showStageGatingError",i=H.Parameters[t],r=e[t];if(!!i&&!!r&&i.Value!==r.raw&&(!e.hasOwnProperty(_)||e[_].type!==oe.Type)){const t="value",i=H.Parameters[t];if(i){const t=i.Value,r=Object(o.ac)(q,te,Q),n=Object(o.X)(q,te,Q,r,se,t);let a;a=Object(D.c)(G)||Object(D.c)(G.descriptor)||Object(D.c)(G.descriptor.Id)||!G.descriptor.Id.startsWith("header_process_")?Object(c.z)(n,q,ie,t):Object(d.h)(n,q,ie,t),ae=!e[_]||a!==e[_].raw,ne={type:oe.Type,raw:a,formatted:null,attributes:le,error:!1,errorMessage:null,security:{},isPropertyLoading:!1}}}}else if(3===oe.Usage&&i[_]!==oe){const e=oe;i[_]=e,ne={type:e.Type,raw:e.Value,formatted:e.Attributes&&oe.Value?Object(y.x)(oe.Value,Object(y.z)(q,e.Attributes)):null,error:!1,errorMessage:null,security:e.Security||{secured:!1,editable:!0,readable:!0},attributes:e.Attributes,isPropertyLoading:!1},ae=!0}else if(de)e.hasOwnProperty(_)&&e[_].type===oe.Type||(ne={type:oe.Type,raw:null,formatted:null,attributes:le,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},ae=!0);else if(void 0===oe.Value)e.hasOwnProperty(_)||(ne={type:null,raw:null,formatted:null,attributes:le,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},ae=!0);else if(oe.Static)e.hasOwnProperty(_)&&e[_].raw===oe.Value||(ne={type:oe.Type,raw:oe.Value,formatted:null,attributes:le,error:!1,errorMessage:null,security:{},isPropertyLoading:!1},ae=!0);else if(ce&&oe.ControlLinked){const e=oe.Value,t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i,r){const n=Object(O.a)(e,t),a=Object(v.v)(i);return n&&n.forms&&n.forms[a]&&n.forms[a].controlUnboundOutputs[r]?n.forms[a].controlUnboundOutputs[r]:null}(q,te,Q,e);let i=t?t.value:null;if(!i){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i){const r=Object(O.a)(e,t);return r&&r.formlessControlOutputs&&r.formlessControlOutputs[i]?r.formlessControlOutputs[i]:null}(q,te,e);i=t?t.value:null}i!==k[e]&&(ne={type:oe.Type,raw:i,formatted:i,error:!1,errorMessage:null,security:{},attributes:{}},k[e]=i,ae=!0)}else{const i=oe.Value;if(N.a.getInstance().getAttributesPendingUpdate().has(i))return e[_];const r=Object(c.b)(se)(q,se.etn);if(ue&&!J&&!ee&&!n.a.isNullOrEmpty(re)&&(!r||!Object(a.b)(r.initialized)))return I.a.info(G.controlId+"."+R+": createGetFieldParameterData return null"),null;let d=!1;const p=t.hasOwnProperty(_)?t[_]:{timestamp:null,fieldName:null,rawAttributes:null,pageAttributes:null,finalAttributes:null},f=!!r&&(r.initialized===a.a.Initializing||r.initialized===a.a.Refreshing);(ue||ce)&&e[_]&&f!==e[_].isPropertyLoading&&(d=!0);const E=Object(o.ac)(q,te,Q),A=Object(o.X)(q,te,Q,E,se,i);let k=[];oe.Type===s.a.SingleLineAddress&&(k=Object(F.d)(i)),A&&(!p.fieldName||p.fieldName!==i||!p.timestamp||A.timestamp>p.timestamp)?(d=!0,p.timestamp=A.timestamp,p.fieldName=i,w=K):w&&!n.a.equals(w.id,re)&&(d=!0,p.timestamp=A?A.timestamp:p.timestamp,p.fieldName=i,w=K);let H=null,$={};const de=Object(O.a)(q,G.id);let pe=null;const he=Object(v.v)(Q);if(de&&de.metadata&&de.metadata[he]&&de.metadata[he].attributes&&de.metadata[he].attributes[i]&&(pe=de.metadata[he].attributes[i]),ue){let t=!0,r=!0;if(k.length>0){const e=Object(u.j)(q,ie,k);Object.keys(e).forEach(i=>{const n=e[i];t=t&&n.IsValidForUpdate,r=r&&n.IsValidForCreate})}const n=Object(u.a)(q,ie,oe.Value),a=Object(m.g)(q);let o=null,f=null;if(oe.Type===s.a.StatusOptionSet&&(o=Object(h.d)(q,E,se,"statecode"),f=Object(h.d)(q,E,se,oe.Value)),oe.Type===s.a.File&&(n.IsValidForUpdate=!0),n!==p.rawAttributes||p.pageAttributes!==pe||x(o,B)||x(f,U)||(oe.Type===s.a.File||oe.Type===s.a.Image)&&d){d=!0,p.rawAttributes=n;if(le=function(e,t){if(!e)return null;return{DisplayName:e.DisplayName,LogicalName:e.LogicalName,Type:e.Type,IsSecured:e.IsSecured,RequiredLevel:e.RequiredLevel,MinValue:e.MinValue,MaxValue:e.MaxValue,ImeMode:e.ImeMode,MaxLength:e.MaxLength,EntityLogicalName:e.EntityLogicalName,Precision:e.Precision,Format:e.Format,Behavior:e.Behavior,Targets:e.Targets,Options:e.OptionSet,DefaultValue:e.DefaultValue,SourceType:e.SourceType,Description:e.Description,Timestamp:t}}(n,A&&A.timestamp?A.timestamp.getTime():null),le=Object(b.d)(le,Z,X,oe.Type,a,n?n.SourceType:j.a.Unknown,q,ie,re),p.finalAttributes=function(e,t){if(null==e)return t;const i=t;null!=e.OptionSet&&(i.Options=e.OptionSet);null!=e.Precision&&(i.Precision=e.Precision);null!=e.RequiredLevel&&(i.RequiredLevel=e.RequiredLevel);null!=e.Targets&&(i.Targets=e.Targets);null!=e.Format&&(i.Format=e.Format);return i}(pe,le),oe.Type===s.a.StatusOptionSet&&o){const e=Object(c.j)(q,se,"statuscode"),t=Object(T.g)(e),i=parseInt(o.valueString,10),r=f?parseInt(f.valueString,10):null;let a=Object(P.a)(q,n.EntityLogicalName,i,null!=t?t:r);null!=a&&Array.isArray(a)&&0===a.length&&(a=[r]);const s=le.Options.filter((e,t,i)=>(I.a.info(G.controlId+"."+R+": createGetFieldParameterData return statusOptionValues.indexOf(element.Value) >= 0"),a.indexOf(e.Value)>=0));B=o,V=s,U=f,le.Options=V}p.pageAttributes=pe,!n||n.SourceType!==j.a.Rollup&&n.SourceType!==j.a.Calculated||Object(b.a)(q,ie,re,p.finalAttributes,E)}else!n||n.SourceType!==j.a.Rollup&&n.SourceType!==j.a.Calculated||Object(b.a)(q,ie,re,p.finalAttributes,E)&&(d=!0);oe.Type===s.a.DateAndTimeDateAndTime&&Object(l.j)(A)?H=Object(b.c)(A,q,G,K,i,Q):oe.Type===s.a.WholeLanguage&&Object(l.j)(A)?H=Object(y.n)(A.value,a):oe.Type===s.a.Currency&&Object(l.j)(A)?H=A&&A.validationResult&&!A.validationResult.isValueValid?A.validationResult.userInput&&(null===(Y=A.validationResult.userInput)||void 0===Y?void 0:Y.toString()):Object(l.c)(A):oe.Type===s.a.TwoOptions?(H=Object(l.c)(A),Object(D.b)(H)&&(H=Object(l.e)(A))):H=Object(l.c)(A),d=d||e[_]&&H!==e[_].formatted;const v=Object(g.m)(q,te),O=!!Object(S.f)(q,ie,oe.Value,v?C.a.CanCreate:C.a.CanUpdate,re),w=!!Object(S.f)(q,ie,oe.Value,C.a.CanRead,re);let F;F=oe.Type===s.a.SingleLineAddress?!!n&&((v?r:t)&&O):!!n&&((v?n.IsValidForCreate:n.IsValidForUpdate)&&O);const N=!!n&&(w&&n.IsValidForRead);$={secured:!!n&&n.IsSecured,editable:F,readable:N},d=d||e[_]&&e[_].security&&(F!==e[_].security.editable||N!==e[_].security.readable)}const me=z(q,{controlName:M(G),id:te},Q);me!==W&&(d=!0,W=me);let ge=!1,fe=null;if(d||me){const t=function(e,t){let i=!(!e||!e.validationResult)&&!e.validationResult.isValueValid,r=e&&e.validationResult?e.validationResult.errorMessage:null;i||(i=!!(t&&t.error&&t.error.messages),r=i&&t.error.messages[0]||null);return{error:i,errorMessage:r}}(A,me);ge=t.error,fe=t.errorMessage,!e[_]||e[_].error===ge&&e[_].errorMessage===fe||(d=!0)}if(d)t[_]=p,ne={type:oe.Type,raw:L(q,E,se,oe),formatted:H,attributes:t[_].finalAttributes,error:ge,errorMessage:fe,notifications:me,security:$,isPropertyLoading:f},ae=!0;else if(!e[_]){if(!ce)return I.a.info(G.controlId+"."+R+": createGetFieldParameterData return null"),null;ne={type:oe.Type,raw:null,formatted:null,attributes:le,error:!1,errorMessage:null,notifications:null,security:$,isPropertyLoading:!1},ae=!0}}return ae&&(e[_]=ne),I.a.info(G.controlId+"."+R+": createGetFieldParameterData finished"),e[_]}}function L(e,t,i,r){const n=Object(h.d)(e,t,i,r.Value);if(Object(l.j)(n)&&n.validationResult&&!n.validationResult.isValueValid)return n.validationResult.userInput;switch(r.Type){case s.a.OptionSet:return n&&n.valueString?parseInt(n.valueString,10):null;case s.a.TwoOptions:if(n){let e=n.value;const t=Object(D.c)(e);if(t&&(e=n.valueString),!Object(D.c)(e))return t&&"-1"===e?null:"boolean"==typeof e?e:"0"!==e.toString()}return null;case s.a.LookupSimple:case s.a.LookupCustomer:case s.a.LookupOwner:case s.a.LookupRegarding:case s.a.LookupMultiEntity:const a=n&&n.validationResult&&!n.validationResult.isValueValid?n.validationResult.userInput:Object(c.y)(e,t,i,r.Value);return Object(w.j)(a);case s.a.LookupPartyList:return n&&n.validationResult&&!n.validationResult.isValueValid?n.validationResult.userInput:Object(w.k)(Object(c.y)(e,t,i,r.Value));case s.a.SingleLineText:if(n&&Object(l.g)(n)&&n.id)return n.id.guid;default:return Object(c.y)(e,t,i,r.Value)}}function M(e){const t=e.parentDefinedControlProps&&e.parentDefinedControlProps.parentFieldSectionItem,i=e.descriptor&&e.descriptor.Name;return t||i}function x(e,t){return!(e===t||t&&e&&e.label===t.label&&e.valueString===t.valueString)}},srnJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var r=i("lY/Z"),n=i("dHD5"),a=i("pF61"),s=i("UqQu"),o=i("i1f0");function l(e,t,i,l){const u=[{name:"pageId",value:e},{name:"numRefreshColumns",value:i?i.length:null}];return{type:"refreshdataandtriggeronchange.async",execute({dispatch:c,getState:d},p,h){const m=d();return c(Object(r.c)(t,i,l)).then(()=>{const i=d();if(!Object(a.n)(i,e)||Object(o.Eb)(i,e)){const i=Object(n.j)(d(),e);return c(Object(s.a)(e,m,i,t.etn,t.id)).then(()=>(p.EventManager.ReportComponentSuccess("Forms.RefreshDataAndTriggerOnChange",u),Promise.resolve()),e=>(u.push({name:"originalErrorForTriggerOnchangeHandlers",value:JSON.stringify(e)}),p.EventManager.ReportComponentFailure("Forms.RefreshDataAndTriggerOnChange",e,null,u),Promise.reject(e)))}return p.EventManager.ReportComponentSuccess("Forms.RefreshDataAndTriggerOnChange",u),Promise.resolve()},e=>(u.push({name:"originalErrorForRefreshRecordData",value:JSON.stringify(e)}),p.EventManager.ReportComponentFailure("Forms.RefreshDataAndTriggerOnChange",e,null,u),Promise.reject(e)))},getFailureParameters:(e,t)=>u}}},tJdb:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r;i.d(t,"a",(function(){return r})),function(e){e[e.Unknown=-1]="Unknown",e[e.Persistent=0]="Persistent",e[e.Calculated=1]="Calculated",e[e.Rollup=2]="Rollup"}(r||(r={}))},txdA:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"d",(function(){return I})),i.d(t,"c",(function(){return j})),i.d(t,"a",(function(){return C})),i.d(t,"f",(function(){return F})),i.d(t,"e",(function(){return N})),i.d(t,"g",(function(){return D})),i.d(t,"i",(function(){return E})),i.d(t,"h",(function(){return R})),i.d(t,"j",(function(){return A}));var r=i("SAYH"),n=i("Yx7Y"),a=i("y60j"),s=i("5R5s"),o=i("9fGf"),l=i("Z/4N"),u=i("BzGi"),c=i("d0w6"),d=i("HfZT"),p=i("WIoD"),h=i("P6DH"),m=i("3/02"),g=i("69Qu"),f=i("Lyxw"),b=i("dHD5"),y=i("AF/G"),v=i("M0zh"),O=i("i1f0"),_=i("IqkD"),P=i("85o3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const S=p.a.guid.toUpperCase();function w(e,t,i,n,s){const o=Object(a.d)(e,i,t);if(!o)return{};const l=":"+r.a.toString(i),u={};for(const e in o){const t=o[e],i=n[t.ClassId.guid.toUpperCase()];if(i&&i(t))if(s){const e=s(t);if(Array.isArray(e))for(const t of e)u[t.name+l]=t.control;else u[t.Name+l]=e}else u[t.Name+l]=t}return u}function I(e,t,i,r,n,o=!1,l=!1,u=!1){const c=Object(a.j)(e,i),p=Object(f.c)(e,m.y)&&Object(g.b)(e),h=Object(f.c)(e,m.z)&&Object(g.b)(e),y=t=>(t=>p&&!o&&D(e,c,t,t.Parameters))(t)||(t=>h&&o&&D(e,c,t,t.Parameters))(t),O=e=>n&&e.ParentTabId===n&&(!o||o&&l),I=e=>!u||!(e.Parameters&&e.Parameters.RelationshipName),j={[S]:t=>I(t)&&O(t)&&R(e,c,t),[d.a]:e=>I(e)&&O(e)};return w(e,t,i,j,t=>{const i=t.Parameters,n=y(t),a=E(e,c,t,i)||(t=>!h&&o&&D(e,c,t,t.Parameters))(t),l=Object(_.q)(e),u=Object(f.c)(e,m.Zc),d=Object(s.a)(i.TargetEntityType,l,r,u),p=null!==d?d.getFilterAndLinkedEntities(P.a,!0):null,g=a&&(()=>p);return{hasChart:n,chartType:n&&F(i),viewType:n&&N(i),getCustomFilter:a?g:null,hasGrid:a,gridType:0,ribbonContext:a&&v.u,recordsPerPage:a&&i.RecordsPerPage&&+i.RecordsPerPage,cardFormId:a&&C(e,c,t),contextToken:Object(b.p)(r,t.Name),control:t,controlParameters:i,entityLogicalName:i.TargetEntityType,viewId:i.ViewId}})}function j(e,t,i,r){const n=function(e,t,i){const r=Object(a.j)(e,i);return w(e,t,i,{[S]:t=>D(e,r,t,t.Parameters),[d.a]:t=>D(e,r,t,t.Parameters)})}(e,i,t),s={};for(const e in n){const t=n[e];s[e]=Object(b.p)(r,t.Name)}return s}function C(e,t,i){if(r.a.equals(i.ClassId,y.mb))return n.a;const a=Object(o.b)(e),s=t&&Object(l.a)(i,t,a);if(!(s&&s.Parameters&&s.Parameters.CardForm&&s.Parameters.CardForm.Value))return;const[u]=s.Parameters.CardForm.Value.split(":");return r.a.tryParseOrNull(u)}function D(e,t,i,r){if(r){const n=r.ChartGridMode;return r.VisualizationId&&("Chart"===n&&!R(e,t,i)||function(e,t,i){return T(e,t,i,"MscrmControls.Chart.ChartControl")}(e,t,i))}return!1}function E(e,t,i,r){if(r){return"Chart"!==r.ChartGridMode&&(!R(e,t,i)||function(e,t,i){return T(e,t,i,"MscrmControls.Grid.ReadOnlyGrid","MscrmControls.MailApp.MailAppListControl","MscrmControls.AuditAssociatedGrid.AuditControl")}(e,t,i))}return!1}function T(e,t,i,...r){const n=k(e,t,i);return n&&-1!==r.indexOf(n.Name)}function F(e){return e.IsUserChart&&"true"===e.IsUserChart?u.a.uservisualization:u.a.savedvisualization}function N(e){return e.IsUserView&&"true"===e.IsUserView?c.b.userview:c.b.savedview}function R(e,t,i){const r=k(e,t,i);if(!r)return!1;return!!Object(h.ab)(e,r.CustomControlId)}function A(e,t,i,r,n){const a={};return i.forEach(i=>{const s=Object(O.N)(e,i),o=I(e,t,i,r,s,!0,n);Object.assign(a,o)}),a}function k(e,t,i){const r=Object(o.b)(e);return Object(l.a)(i,t,r)}},uNLT:function(e,t,i){"use strict";i.d(t,"e",(function(){return xe})),i.d(t,"f",(function(){return pt})),i.d(t,"c",(function(){return Ke})),i.d(t,"d",(function(){return Xe})),i.d(t,"b",(function(){return ke})),i.d(t,"g",(function(){return ut})),i.d(t,"a",(function(){return Ae}));var r=i("YYhu"),n=i("arV0"),a=i("i1f0"),s=i("SAYH"),o=i("odYE"),l=i("ruPX"),u=i("y60j"),c=i("/qEh"),d=i("Uv1Y"),p=i("ofgb"),h=i("+hq9"),m=i("tT9w"),g=i("nzu+"),f=i("1uZV"),b=i("Tz6o"),y=i("bT7G"),v=i("Bj/n"),O=i("jTSi"),_=i("3tOH"),P=i("dHD5"),S=i("Dea/"),w=i("tICD"),I=i("EY5k"),j=i("YxC/"),C=i("LAcd"),D=i("xy1J"),E=i("iZ7K"),T=i("LbMF"),F=i("5Oca"),N=i("iF9X"),R=i("69Qu"),A=i("1HWW"),k=i("EBJu"),L=i("4UCL"),M=i("NDmk"),x=i("LJro"),V=i("84PK"),B=i("WRF3"),U=i("HYaY"),z=i("sdkC"),W=i("PF3G"),q=i("IvgJ"),G=i("ybGo");function H(e){return{type:"offline.resolve.syncerror.record",execute({dispatch:t,getState:i},r){const a=1,s=Object(n.g)(i(),e);if(!s.data||!s.data._isSyncErrorRetryRequest)return Promise.resolve();const o=s.data._isSyncErrorRetryRequest;if(!Object(G.a)(i(),e)){const i="statecode",n=new Array(1),s={},l={};n[0]=i,s[i]="state",l[i]=new q.a(null,a,0,-1,null,null,null);const u="syncerror",c=new B.a(u,V.a.tryCreate(o)),d=new U.a(c,l,s,{},{},new z.a(new Array(0)));d.get_changedFieldNames().push(...n);const p=new W.a(d,!1);r.DataSource.execute(p,null).then(()=>{t(Object(x.b)(e,!0))},i=>{t(Object(x.b)(e,!1))})}return Promise.resolve()}}}var K=i("NPZ3"),Q=i("uCpV"),Y=i("X37l"),X=i("Zzxs"),Z=i("ZFRl"),$=i("O7zD"),J=i("mIxf"),ee=i("D+Bz"),te=i("pEXn"),ie=i("zmaG"),re=i.n(ie),ne=i("NjDY"),ae=i("E8F2"),se=i("LAGg"),oe=i("BFlg"),le=i("txdA"),ue=i("jRy5"),ce=i("jq7Z");var de=i("3mEc"),pe=i("zmL5");var he=i("lY/Z");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */var me=i("UqQu"),ge=i("Fij2"),fe=i("504W"),be=i("+nNZ");var ye=i("QHx/"),ve=i("rQHy"),Oe=i("Exmh"),_e=i("pF61"),Pe=i("g6bs"),Se=i("9wSR"),we=i("7Sr4"),Ie=i("Zpd/"),je=i("wL2W"),Ce=i("/t1C"),De=i("yHAP"),Ee=i("4aOd"),Te=i("RrRQ"),Fe=i("gQ5I"),Ne=i("uWQm"),Re=i("TBkx");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ae="ignore_save",ke="Forms.SaveForm";class Le{constructor(e,t,i,r){this._isIgnorable=e,this._continueExecution=t,this._canNavigate=i,this._canForceNavigate=r}getIsIgnorable(){return this._isIgnorable}getContinueExecution(){return this._continueExecution}getCanNavigate(){return this._canNavigate}getCanForceNavigate(){return this._canForceNavigate}}const Me=new o.a("NO_ROOT_COMPONENT");function xe(e,t,i){const r=[{name:"saveMode",value:t},{name:"PageId",value:e}];return{type:"form.save.async",execute({dispatch:s,getState:o},l,u){const c=l.TraceManager.getTracer(ke);if(!Object(a.Eb)(o(),e)&&Object(_e.n)(o(),e))return;const d=Object(n.l)(o(),e);r.push({name:"CorrelationId",value:u.correlationId},{name:"pageType",value:d}),function(e,t){const i={};i[te.b.SaveFormParameters.CorrelationId]=e.correlationId,i[te.b.SaveFormParameters.SaveMode]=t.toString(),re.a.addKeyPerformanceIndicatorOnIdle("SaveForm",i)}(u,t);const p=Object(n.g)(o(),e),h=Object(a.Lb)(o(),null==p?void 0:p.entityTypeName,null==p?void 0:p.id);return it(l,s,o,e,t,!1,r,h).then(i=>{let n=i;n===Me&&(n=gt(o(),e));const a=lt(n,r,c,"Null identifier after _saveForm within saveForm");return qe(s,o(),l,t,!0,e,a,r,h),a&&Object(ge.c)(Object(E.p)(o(),n.etn)),n},n=>{n=Ve(n,e);const a=Object.keys(n),u=Ue(n);r.push({name:"originalError",value:u});const d=We(a,o,n,s,c,r),p=a[0],m=n[p],g=Object(P.j)(o(),p),b=d[0];if(b&&b.getIsIgnorable()){if(qe(s,o(),l,t,b.getContinueExecution(),p,!1,r,h),ze(o(),s,l,e,n),2200000006===m.errorCode){const t=gt(o(),e);if(t)return Promise.resolve(t)}return Promise.reject(m)}return ze(o(),s,l,e,n,"Forms.SaveForm.SaveForm",r),Object(ae.e)(m)?(c.info("Failed to save the form due to duplicate",r),s(Object(f.a)(p,m)).then(n=>0===n.status?s(Object(w.a)(n.pageId)).then(n=>{if("merge_done"!==n.value.param_lastButtonClicked){if(n.value.param_lastButtonClicked===Ae)return s(Object(O.b)(g,p,X.a)),s(Object(C.b)(p,!0)),it(l,s,o,p,t,!1,r).then(t=>{let i=t;return i===Me&&(i=gt(o(),e)),lt(t,r,c,"Null identifier after internal _saveForm within saveForm"),Ge(s,o(),l,p,r),i},t=>{const n=t[p],a=He(n,s,o(),g,p,c,r);return a&&a.getIsIgnorable()?(Ge(s,o(),l,p,r),ze(o(),s,l,e,t),null):(ze(o(),s,l,e,t),Ze(s,o(),n,i,p),Object(ae.h)(o(),p,n,r,l,"Forms.SaveForm.SaveForm.Duplicate"),Promise.reject(n))})}else Be(o(),s,p,g,e)}):Promise.reject(n.error))):(s(Object(O.b)(g,p,X.a)),Ze(s,o(),m,i,p),Promise.reject(m))})},getFailureParameters:(e,t)=>(Object(ae.a)(e,r),r)}}function Ve(e,t){return e.message&&(e={[t]:e}),e}function Be(e,t,i,r,n){const s=Object(a.ac)(e,i,r);t(Object(Te.b)(s)),t(Object(Fe.e)(n))}function Ue(e){const t={};for(const i in e)Object(ae.e)(e[i])||(t[i]=e[i]);return JSON.stringify(t)}function ze(e,t,i,r,n,s,o){const l=Object(pe.a)(e,r);for(let r=0;r<l.length;r++){const u=l[r],c=Object(P.j)(e,u);t(Object(h.b)(u,c,!1)),n[u]&&s?(t(Object(p.b)(u,c,2)),Object(ae.h)(e,u,n[u],o,i,s)):Object(a.mb)(e,{id:u},c)&&t(Object(p.b)(u,c,3))}}function We(e,t,i,r,n,a){const s=[];if(e)for(let o=0;o<e.length;o++){const l=e[o],u=Object(P.j)(t(),l),c=i[l];s.push(He(c,r,t(),u,l,n,a))}return s}function qe(e,t,i,r,s,o,l,u,c){if(s){const i=Object(P.j)(t,o),s=!Object(R.b)(t),d=Object(N.a)(t);u.push({name:"isServerUnavailable",value:s},{name:"isMocaOfflineFeatureEnabled",value:d}),s&&d&&e(Object(A.c)(o,i,!0)),e(Object(O.b)(i,o,X.a)),e(H(o));const p=Object(a.eb)(t,o,i),h=Object(n.g)(t,o),m=Object(a.Lb)(t,null==h?void 0:h.entityTypeName,null==h?void 0:h.id);if((15===r||5===r||!Object(fe.a)(c)&&m&&!c)&&p)for(const t in p)p[t]&&void 0!==p[t].disabledByClientApi&&null!==p[t].disabledByClientApi&&p[t].dataFieldName&&e(Object(Ie.b)(o,p[t].dataFieldName,i,void 0));l&&Xe(e,i,o),e(Object(ve.a)(o,null,!1))}i.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveForm",u)}function Ge(e,t,i,r,n){i.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveForm.Duplicate",n)}function He(e,t,i,r,n,s,o){const l=Object(ae.g)(e);let u=!1,c=!0,d=!1;if(l)switch(e.errorCode){case 2200000004:d=!0;break;case 2200000005:c=!1;break;case 2200000006:u=!0,d=!0;break;case 2200000007:c=!1,function(e,t,i,r,n){if(n)i(Object(v.c)(t,r,n,_.a.error,X.b));else{const n=Object(a.zb)(e,r,t);if(n)for(const s in n){const o=i(Object(v.b)(n[s].label,n[s].errorMessage)),l=Object(ce.a)(e,r),u=Object(a.yb)(l,t),c=Object(a.y)(e,r,t),d=u.concat(c),p=Object(a.W)(e,t,r,s,d),h=Object($.d)(r,s);i(Object(v.c)(t,r,o,_.a.error,h,null,null,p))}}}(i,r,t,n),s.info(Object(ae.c)(2200000007),o);break;default:s.error("Unknown error code to ignore",o)}return o.push({name:"isIgnorable",value:l},{name:"continueExecution",value:u},{name:"canNavigate",value:c},{name:"canForceNavigate",value:d}),new Le(l,u,c,d)}function Ke(e){const t=[{name:"PageId",value:e}];return{type:"form.autosave.async",execute({dispatch:i,getState:r},o,l){const u=r(),c=Object(n.g)(u,e),d=function(e,t){const i=Object(n.g)(e,t),r="_isSyncErrorRetryRequest";let a=!1;i.data&&(a=!!i.data[r]);return a!==Object(G.a)(e,t)}(u,e),m=!c,g=!c.id,b=s.a.isNullOrEmpty(c.id);if(!Object(R.b)(u)&&!Object(N.a)(u))return Promise.resolve(void 0);if(Object(a.Eb)(u,e))return Promise.resolve(void 0);const S=o.TraceManager.getTracer(ke);if(d||m||g||b)return t.push({name:"blockAutoSave",value:d},{name:"isPageInputNull",value:m},{name:"isPageInputIdNull",value:g},{name:"isPageInputIdBadGuid",value:b}),S.info("Not Autosaving due to bad inputs.",t),Promise.resolve(void 0);const E=Object(pe.a)(r(),e);return E.some(e=>{const t=Object(P.j)(u,e),i=Object(a.ac)(u,e,t);return Object(y.g)(u,i)})?it(o,i,r,e,70,!0,t).then(n=>{let a=n;a===Me&&(a=gt(r(),e));const s=lt(a,t,S,"Null identifier after _saveForm within autoSaveForm"),o=Object(P.j)(u,e);return Qe(i,r(),o,e,s),a},n=>{n=Ve(n,e);const a=Object.keys(n),s=Ue(n);t.push({name:"originalError",value:s});const l=We(a,r,n,i,S,t),c=a[0],d=n[c],m=Object(P.j)(r(),c),g=l[0];if(g&&g.getIsIgnorable()){const t=Object(P.j)(r(),e);return Qe(i,r(),t,e,!1),ze(r(),i,o,e,n),null}return i(Object(I.e)(D.m)).then(()=>{if(ze(r(),i,o,e,n,"Forms.SaveForm.AutoSaveForm",t),!Object(ae.e)(d))return i(Object(O.b)(m,c,X.a)),Promise.reject(d);S.info("Failed to autosave the form due to duplicate",t);const a=()=>{i(Object(O.b)(m,c,X.a)),i(Object(C.b)(c,!0));for(let e=0;e<E.length;e++){const t=E[e],n=Object(P.j)(r(),t);i(Object(p.b)(t,n,1)),i(Object(h.b)(t,n,!1))}return it(o,i,r,e,70,!0,t).then(n=>{let a=n;return a===Me&&(a=gt(r(),e)),lt(a,t,S,"Null identifier after internal _saveForm within autoSaveForm"),Ye(i,r(),o,e,t),Promise.resolve(a)},n=>{n=Ve(n,e);const a=Object.keys(n)[0],s=n[a],l=Object(P.j)(r(),a),d=He(s,i,r(),l,a,S,t);if(d&&d.getIsIgnorable())return Ye(i,r(),o,e,t),null;Object(ae.h)(r(),c,s,t,o,"Forms.SaveForm.AutoSaveForm.SaveAnyway"),Ze(i,u,s,null,c)})};tt(r());const s={Label:Object(j.c)(Je,D.c),Handler:()=>{a()}},l={Label:Object(j.c)(Je,D.d),Handler:()=>{i(Object(f.a)(e,d)).then(t=>0===t.status?i(Object(w.a)(t.pageId)).then(t=>{"merge_done"!==t.value.param_lastButtonClicked?t.value.param_lastButtonClicked===Ae&&a():Be(r(),i,c,m,e)}):Promise.reject(t.error))}};for(let e=0;e<E.length;e++){const t=E[e],a=Object(P.j)(r(),t);i(Object(h.b)(t,a,!1)),n[t]?i(Object(p.b)(t,a,2)):i(Object(p.b)(t,a,3)),i(Object(O.b)(a,t,X.a))}return i(Object(v.c)(m,c,Object(j.c)(Je,D.b),_.a.warning,X.a,[s,l]))})}):Promise.resolve(void 0)},getFailureParameters:(e,i)=>(Object(ae.a)(e,t),t)}}function Qe(e,t,i,r,n){!Object(R.b)(t)&&Object(N.a)(t)&&e(Object(A.c)(r,i,!0)),e(Object(O.b)(i,r,X.a)),n&&Xe(e,i,r),e(Object(ve.a)(r,null,!1))}function Ye(e,t,i,r,n){i.EventManager.ReportComponentSuccess("Forms.SaveForm.AutoSaveForm.SaveAnyway",n)}function Xe(e,t,i){e(function(e,t){return{type:"grids.page.refresh.dataset.asyn",execute({dispatch:i,getState:r},n){var a,s;const o=n.TraceManager.getTracer(oe.z),l=oe.x+".refreshPageDataSetsAction";try{const u=r(),c=Object(ce.a)(u,e);if(t.contextTokenType===ue.a.QuickViewForm){o.info("Refreshing all of the quick view's grids for the quick view on page with ID "+e);const r=Object(P.v)(t),n=null===(s=null===(a=null==c?void 0:c.forms)||void 0===a?void 0:a[r])||void 0===s?void 0:s.formId;if(n){const r=Object(le.j)(u,e,[n],t,!0);for(const t in r){const n=r[t].contextToken;i(Object(se.b)(e,n))}}}else if(o.info("Refreshing all the grids for the page with ID "+e),c.datasets)for(const t in c.datasets)i(Object(se.c)(e,t));return n.EventManager.ReportComponentSuccess(l),Promise.resolve()}catch(t){let i="Refreshing datasets for pageid "+e+"failed ";t&&t.message&&(i+="with the error message as : "+t.message),n.EventManager.ReportComponentFailure(l,Error(i));const r=new d.a(i);return Promise.reject(r)}}}}(i,t)),e(function(e,t){return{type:"form.page.chartdata.refresh.async",execute({dispatch:i,getState:r}){const n=r(),a=Object(pe.b)(n,e),s=Object(le.c)(n,a,e,t);for(const t in s){const r=s[t];i(Object(se.b)(e,r))}return Promise.resolve()}}}(i,t)),e(function(e,t){return{type:"form.quickform.data.resfresh.async",execute({dispatch:i,getState:r}){const s=r(),l=Object(a.ac)(s,t,e),c=Object(n.g)(s,t),d=new o.a(c.entityTypeName,c.id),p=Object(a.fc)(s,t,e);for(const r in p){const n=Object(a.s)(s,{id:t,controlName:r},e),o=Object(y.d)(s,l,d,n.DataFieldName);if(!o||!o.reference)continue;const c=p[r][o.reference.etn],h=Object(u.y)(s,c);i(Object(he.c)(o.reference,h))}return Promise.resolve()}}}(t,i))}function Ze(e,t,i,r,n){if(r)return;if(i&&i.errorCode)return e(Object(m.b)(i,!1,n));if(i&&i.reason&&i.reason.errorCode)return e(Object(m.b)(i.reason,!1,n));const a=i.message,s=et(t,D.l);return e(Object(g.a)({title:s,text:a},{type:"error"},n))}let $e,Je;function et(e,t){return tt(e),Object(j.c)(Je,t)}function tt(e){$e||($e=Object(j.h)()),Je||(Je=$e(e,D.m))}function it(e,t,i,r,s,o,l,u){const m=i(),g=Object(pe.a)(m,r),f=g.map(e=>Object(P.j)(m,e));null==l&&(l=[{name:"nullTelemetryParameters",value:!0}]),l.push({name:"_saveMode",value:s});const b=[],v=[];for(let e=0;e<g.length;e++){const t=g[e];Object(a.Wc)(m,t,f[e])?v.push(t):b.push(t)}const O=b.length>0;if(l.push({name:"readOnlyFormComponents",value:JSON.stringify(v)}),O){return function(e,t,i,r,s,o,l,u,m,g){const f=t(),b=Object(je.a)(),v=o.filter((e,t)=>{const i=s[t];return Object(a.mb)(f,{id:e},i)});if(v.length>0){if(b){const e=Object(De.b)(r,Ce.b.onSave);v.forEach((t,i)=>{const r=s[i],n=Object(De.c)(f,t,r),a=new Ee.a(new Error);e.push({message:`Save is called again while previous save operation is in progress ${n}. Make sure the previous save event handler code does not call client API to save the form.`,callstack:a.getStackTrace()})})}const e=et(f,D.a),t={[r]:Object(ae.b)(f,r,2200000003,e)};return Promise.reject(t)}const O=Object(ne.x)(t());o.forEach((i,r)=>{("TaskBasedFlow"===Object(n.l)(t(),i)||O&&!1===O.isDuplicateDetectionEnabled||O&&!1===O.isDuplicateDetectionEnabledForOnlineCreateUpdate)&&e(Object(C.b)(i,!0)),e(Object(p.b)(i,s[r],0)),e(Object(h.b)(i,s[r],70===l))});const _=70===l?we.a.getInstance().getAttributesPendingUpdate():new Set;return(70===l?Promise.resolve():we.a.getInstance().checkForOutstandingWork(t(),r)).then(()=>function(e,t,i,r,n,s,o,l,u,m,g){let f=i();l||s.forEach((t,i)=>e(Object(J.b)(t,n[i])));const b={};for(let t=0;t<s.length;t++){const i=s[t],r=n[t],o=Object(a.oc)(f,{id:i},r);if(o){const t=ot(e,f,i,r,o,b);if(!Object(fe.b)(t)){const e={[i]:new d.a(t)};return Promise.reject(e)}}}const v=t.TraceManager.getTracer(ke);let O=at(f,s,n),_=O.map(e=>Object(P.j)(f,e));if(O.length>0)return ft(f,r,e,v,O,_,u);for(let i=0;i<s.length;i++){const a=s[i],l=n[i],c=t.ScriptManager.getContainer(a).getEventManager();if(e(c.runOnSave(l,o))){v.info(Object(ae.c)(2200000005),u);const e={[a]:Object(ae.b)(f,r,2200000005)};return Promise.reject(e)}}if(f=i(),O=at(f,s,n),_=O.map(e=>Object(P.j)(f,e)),O.length>0)return ft(f,r,e,v,O,_,u);const S=s.map((e,t)=>Object(a.ac)(f,e,n[t])),w=S.map(e=>Object(y.b)(f,e));let I=!1,j=!1;const C=new Set;for(let t=0;t<w.length;t++){const i=w[t];if((null==i?void 0:i.activeChanges)&&Object.keys(i.activeChanges).length)j=!0,!I&&rt(i,f,s[t])&&(I=!0);else{const i=s[t];let r=!1;const a=b[i];if(a&&a.length>0&&(r=a.some(e=>{const t=Object(y.b)(f,e);if((null==t?void 0:t.activeChanges)&&Object.keys(null==t?void 0:t.activeChanges).length>0)return rt(t,f,i)})),!r){const r=n[t];C.add(i),e(Object(p.b)(i,r,3)),e(Object(h.b)(i,r,!1))}}}const D=[];if(Object.keys(b).forEach(e=>{b[e]&&D.push(...b[e])}),j&&!I||C.size===s.length&&0===D.length){v.info(Object(ae.c)(2200000006),u);const e={};for(const t of s)e[t]=Object(ae.b)(f,r,2200000006);return Promise.reject(e)}return function(e,t,i,r,n,a,s,o,l,u,d,p,h){const m=[],g=[];for(let f=0;f<a.length;f++){const b=a[f];if(l.has(b))continue;const y=Object(pe.b)(i(),b);g.push(b),m.push(e(Object(c.b)(b,y)).then(({unboundAttributes:a,attributesPendingUpdate:l})=>st(e,i,t,n[f],b,r,s[f],o,u,a,l,d,p,h)))}let f=g.length;return Promise.all(m.map((t,r)=>t.then(t=>{f--;let n=Promise.all([Promise.resolve()]);return 0===f&&(n=nt(e,i,g,u)),n.then(()=>({formComponentId:g[r],entityReference:t}))}).catch(t=>{throw f--,0===f&&nt(e,i,g,u),t.saveFormPromiseComponentId=g[r],t}))).then(e=>{for(const t of e)if(t.formComponentId===r)return t.entityReference;return Me}).catch(t=>{var r;const n={[t.saveFormPromiseComponentId]:t};if(t.saveFormPromiseComponentId=void 0,-2147220969===(null===(r=null==t?void 0:t.getNegativeErrorCode)||void 0===r?void 0:r.call(t))){const r=Object(Re.f)(t.message);r&&e(Object(Ne.c)(r,Object(R.b)(i())))}throw n})}(e,t,i,r,n,s,S,D,C,o,u,m,g)}(e,i,t,r,s,o,l,u,m,g,_))}(t,i,e,r,b.map(e=>Object(P.j)(m,e)),b,s,o,l,!!u)}e.TraceManager.getTracer(ke).info(Object(ae.c)(2200000004),l);const _={};for(const e of v)_[e]=Object(ae.b)(m,r,2200000004);return Promise.reject(_)}function rt(e,t,i){let r=!1;const n=Object(a.Oc)(t,i);if(n){const t=Object.keys(n);Object.keys(e.activeChanges).filter(e=>-1===t.indexOf(e)).length&&(r=!0)}else r=!0;return r}function nt(e,t,i,r){var a,l;if(i.length<2)return Promise.all([Promise.resolve()]);const u=t(),c=new Map;for(const e of i){const t=Object(n.g)(u,e),i=null!==(a=Object(E.E)(u,null==t?void 0:t.entityTypeName))&&void 0!==a?a:"",o=Object(pe.b)(u,e),d=null==t?void 0:t.entityTypeName,p=s.a.toString(null==t?void 0:t.id),h=null===(l=ut(u,o,t,i,r))||void 0===l?void 0:l[d],m=c.get(d);if(null==m?void 0:m.size){const e=m.get(p);(null==e?void 0:e.size)?h.forEach(e.add,e):m.set(p,new Set(h))}else{const e=new Map;e.set(p,new Set(h)),c.set(d,e)}}const d=[];return c.forEach((t,i)=>{t.forEach((t,r)=>{const n=new o.a(i,new s.a(r));d.push(e(Object(he.c)(n,Array.from(t))))})}),Promise.all(d)}function at(e,t,i){const r=[];for(let n=0;n<t.length;n++){const s=t[n],o=Object(ce.a)(e,s);Object(a.Gb)(o,e,s,i[n])||r.push(s)}return r}function st(e,t,i,l,u,d,m,g,f,b,v,O,_,P){const S=t(),w=Object(n.g)(S,u);let I="";null!=w&&(O.push({name:"_entityTypeName",value:w.entityTypeName},{name:"_formId",value:s.a.toString(w.formId)}),I=Object(E.E)(S,w.entityTypeName));return function(e,t,i,l,u,d,m,g,f,b,v,O,_,P,S,w,I){const j=Object(a.Bc)(t,l),C=i.ScriptManager.getContainer(l).getEventManager(),D=function(e,t,i,r){if(!Object(be.e)(e,i.entityTypeName)||!Object(a.Cb)(e,t))return null;const n=Object(y.b)(e,r);let l=new o.a(i.entityTypeName,i.id);s.a.isNullOrEmpty(i.id)&&!n.identifier&&(l=new o.a(i.entityTypeName,n.identifier.id));const u=i.processId&&!s.a.equals(s.a.fromExternalGuid(i.processId),s.a.EMPTY)?o.a.toLegacyEntityReference(new o.a("businessprocessflowinstance",s.a.fromExternalGuid(i.processId))):null,c=i.processInstanceId&&!s.a.equals(s.a.fromExternalGuid(i.processInstanceId),s.a.EMPTY)?o.a.toLegacyEntityReference(new o.a("businessprocessflowinstance",s.a.fromExternalGuid(i.processInstanceId))):null;if(l&&u&&c)return new Oe.a(o.a.toLegacyEntityReference(l),u,c);if(l&&u&&!c)return new Oe.a(o.a.toLegacyEntityReference(l),u,null);if(l)return new Oe.a(o.a.toLegacyEntityReference(l),null,null);return null}(t,l,m,b),E=function(e,t,i,r,n){const a=new Array,s=Object(Pe.a)(e,t,i,r,n);s&&a.push(s);return a}(e,t,i,f,l);Object(pe.b)(t,l);if(v.length>0||E.length>0)return function(e,t,i,n,a,s,o,l,u,d,m,g,f,b,y,v,O,_,P,S,w){O.push({name:"relatedEntitiesSnapshotIds.length",value:g.length},{name:"primaryEntitySnapshotId",value:m});const I=m?g.concat(m):g;f&&f.length>0&&I.push(...f);return e(Object(r.d)(I,v,P,w)).then(r=>e(Object(c.a)(n,b,y)).then(()=>{if(r&&r.length>0&&m){const a=r[I.indexOf(m)];return e(ct(i,n,s,l,m,d,u,a,_,t,S))}return e(Object(p.b)(n,d,1)),e(Object(h.b)(n,d,!1)),r&&r.length>0?r[0]:null}))}(e,t,C,l,0,d,0,m,g,f,b,v,E,_,P,j,S,w,O,I,D);return function(e,t,i,a,s,o,l,u,d,p,h,m,g,f,b,y,v,O,_){const P=Object(n.g)(t,a),S=P&&m&&m[P.entityTypeName]?m[P.entityTypeName]:[];return e(Object(r.c)(h,b,S,_)).then(r=>e(Object(c.a)(a,g,f)).then(()=>e(ct(i,a,o,u,h,p,d,r,v,t,O))))}(e,t,C,l,0,d,0,m,g,f,b,O,_,P,j,0,w,I,D)}(e,S,i,u,0,f,w,I,l,m,g,ut(S,Object(pe.b)(S,u),w,I,f),b,v,O,_,P)}function ot(e,t,i,r,n,s){const o=Object(ce.a)(t,i),l=[];for(const s in n){const n=Object(P.m)(r,s),u=Object(a.ac)(t,i,n);if(u&&(l.push(u),!Object(a.Gb)(o,t,i,n))){e(Object(p.b)(i,r,2)),e(Object(h.b)(i,r,!1));return et(t,D.e)}}l.length>0&&(s[i]=l)}function lt(e,t,i,r){const n=!!e;return t.push({name:"isIdentifierValid",value:n},{name:"entityTypeName",value:n?e.etn:null}),n||i.error(r,t),n}function ut(e,t,i,r,n){const a=Object(u.j)(e,t),l=i?new o.a(i.entityTypeName,i.id):null,c=l?Object(F.e)(e,l):null,d=Object(u.y)(e,t),p=[];p.push(...d);const h=Object(K.a)(e,i.entityTypeName);if(h&&p.push(...h),a&&i.entityTypeName){const t=Object(de.d)(e,a.FormLibraries,[i.entityTypeName]);t&&p.push(...t)}if(r&&-1===p.indexOf(r)){const t=Object(T.a)(e,i.entityTypeName,r);t&&t.IsRetrievable&&p.push(r)}if(c&&c!==s.a.EMPTY){const t=
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function(e,t,i){const r=[];if(e&&!s.a.isNullOrEmpty(t)&&i){const n=Object(be.a)(e,t);if(n&&n.businessProcessFlowStepEntityAttributeControls){const t=n.businessProcessFlowStepEntityAttributeControls[i];if(!Object(fe.a)(t)){const n=Object(E.h)(e,i);if(!Object(fe.a)(n)){const e=n.AttributeNames;Object(fe.a)(e)||Object.keys(t).forEach(i=>{const n=t[i].DataFieldName;!Object(fe.b)(n)&&e.indexOf(n)>-1&&r.push(n)})}}}}return r}(e,c,l.etn);if(t){const e=t.filter(e=>-1===p.indexOf(e));p.push(...e)}}let m=p;if(70===n){const e=we.a.getInstance().getAttributesPendingUpdate();m=null==m?void 0:m.filter(t=>!e.has(t))}return{[l.etn]:m}}function ct(e,t,i,r,n,s,o,l,u,c,d){return{type:"form.updateOnSaveSuccess",sync:!0,execute({dispatch:m,getState:g},f){const v=g(),O=Object.assign(Object.assign({},r),{id:l.id,data:dt(r)}),_=Object(y.b)(v,n),P=Object(F.j)(v,l,o),w=P?P.value:null,I=_.identifier.name?_.identifier.name:w||null,j=Object.assign(Object.assign({},l),{name:I});m(Object(b.b)(O,t)),Object(ce.a)(v,t).__pageName!==k.a&&m(Object(M.b)(t,j)),r.id||m(e.runOnProcessChange(s,2));const C=70===i?Array.from(we.a.getInstance().getAttributesPendingUpdate()).concat(Array.from(d)):void 0;m(Object(L.d)(t,s,C)),m(Object(p.b)(t,s,1)),m(Object(h.b)(t,s,!1)),m(Object(Se.g)(t)),m(Object(me.a)(t,c,s,l.etn,l.id)),m(e.runOnDataLoad(s,2)),!u&&(r.id||Object(a.Kb)(v,t)||Object(a.Ib)(v,t))||m(e.runOnLoad(s,2)),m(e.runPBLs(s));const{entityTypeName:D}=O,T=Object($.c)(t,D,g(),s);T&&m(Object(Z.c)(t,T));return m(function(e,t){return{type:"recentitems.formsave.addrecentitem",sync:!0,execute({dispatch:i,getState:r}){const n=r();if(!t||!e||void 0===t.mode)return;const s=Object(E.E)(n,e.etn),o=s&&t.activeChanges&&t.activeChanges[s];if(t.mode===S.a.Update&&!o)return;const l={RecordType:Y.a.Entity,EntityTypeName:e.etn,LastAccessed:new Date,ObjectId:e.id,Title:Object(a.ec)(n,e.etn,e.id),IconPath:Object(E.j)(n,e.etn,e.id)};i(Object(Q.b)(l))}}}(j,Object(y.b)(c,n))),j}}}function dt(e){const t={};return null!=e&&null!=e.data&&(t.processId=e.data.processId,t.processInstanceId=e.data.processInstanceId,t.nextStageId=e.data.nextStageId,t.parentrecordtype=e.data.parentrecordtype,t.parentrecordid=e.data.parentrecordid,t.parentrecordname=e.data.parentrecordname),t}function pt(e,t,i,r,o,l,u){const c=[{name:"PageId",value:e},{name:"saveMode",value:r},{name:"shouldNavigateToSavedEntity",value:i},{name:"performRefresh",value:!!o}];return{type:"form.saveNavigate.async",execute({dispatch:d,getState:p},h,m){const g=p(),b=Object(n.l)(g,e);if(c.push({name:"pageType",value:b}),Object(a.Eb)(g,e))return Promise.reject(Object(ae.b)(g,e,2200000016));if(!Object(a.Qc)(g)&&o){const r=Object(n.g)(g,e);null!=r&&c.push({name:"entityTypeName",value:r.entityTypeName},{name:"formId",value:s.a.toString(r.formId)});const a=Object(P.j)(g,e);return mt(g,d,h,e,a,t,i,r,o),h.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveAndNavigateAway",c),null}const y=h.TraceManager.getTracer(ke);return it(h,d,p,e,r,!1,c,l).then(n=>{let a=n;a===Me&&(a=gt(p(),e));const s=lt(a,c,y,"Null identifier after _saveForm within saveFormAndNavigate"),l=Object(P.j)(g,e);return ht(d,p,h,l,e,t,i,s,!!o,!0,!1,r,c),a},n=>{n=Ve(n,e);const a=Object.keys(n),s=Ue(n);c.push({name:"originalError",value:s});const m=We(a,p,n,d,y,c),g=a[0],b=n[g],v=Object(P.j)(p(),g),_=m[0];if(_&&_.getIsIgnorable()){if(ht(d,p,h,v,g,t,i,!1,!!o,_.getCanNavigate(),_.getCanForceNavigate(),r,c),ze(p(),d,h,e,n),2200000006===b.errorCode){const t=gt(p(),e);if(t)return Promise.resolve(t)}return Promise.reject(b)}return ze(p(),d,h,e,n,"Forms.SaveForm.SaveAndNavigateAway",c),Object(ae.e)(b)?d(Object(f.a)(g,b)).then(a=>0===a.status?d(Object(w.a)(a.pageId)).then(a=>{if("merge_done"!==a.value.param_lastButtonClicked){if(a.value.param_lastButtonClicked===Ae)return d(Object(O.b)(v,g,X.a)),d(Object(C.b)(g,!0)),d(pt(g,t,i,r,o,l)).catch(t=>{t=Ve(t,e);const i=Object.keys(t)[0],r=null==n?void 0:n[i];return c.push({name:"errorCode",value:null==r?void 0:r.errorCode}),y.warn("Ignorable error on duplicate record save",c),Promise.reject(r)})}else Be(p(),d,g,v,e)}):Promise.reject(a.error)):(d(Object(O.b)(v,g,X.a)),Ze(d,p(),b,u,g),Promise.reject(b))})},getFailureParameters:(e,t)=>(Object(ae.a)(e,c),c)}}function ht(e,t,i,r,a,o,l,u,c,d,p,h,m){m.push({name:"performRefresh",value:c});const g=Object(n.g)(t(),a);g&&g.isOfflineSyncError&&e(Object(b.b)(Object.assign(Object.assign({},g),{isOfflineSyncError:!1}),a));const f=t(),y=Object(n.g)(f,a);null!=y&&m.push({name:"_entityTypeName",value:y.entityTypeName},{name:"_formId",value:s.a.toString(y.formId)}),d&&(u||c||p)&&(mt(f,e,i,a,r,o,l,y,c),e(H(a))),i.EventManager.ReportComponentSuccess("Forms.SaveForm.SaveAndNavigateAway",m)}function mt(e,t,i,r,n,s,o,u,c){if(o){const n=i.Router.createUrlForPage(s,u),o=n.match(/pagetype=([^&]+)/)[1];if(c||u.pageType!==o){const e=function(e){if(!e)return e;const t=["entityTypeName","id","formId","processId","processInstanceId","selectedStageId","isCrossEntityNavigate","isOfflineSyncError","navItemId","bodyOnly","recordSetQueryKey"],i={entityTypeName:e.entityTypeName};return t.reduce((t,i)=>(t[i]=e[i],t),i)}(u);t(Object(l.a)(s,e,r,ee.b.Redirect))}else if(!c&&!Object(a.Ib)(e,r)){const t=i.Router.getHistoryManager(),a=Object(ye.a)(e,r);t.ReplaceState(t.GetState(),n,a)}}}function gt(e,t){const i=Object(n.g)(e,t);return i&&i.entityTypeName&&i.id?new o.a(i.entityTypeName,i.id):null}function ft(e,t,i,r,n,a,s){const o={};return null==n||n.forEach((r,n)=>{i(Object(p.b)(r,a[n],2)),i(Object(h.b)(r,a[n],!1)),o[r]=Object(ae.b)(e,t,2200000007)}),r.info(Object(ae.c)(2200000007),s),Promise.reject(o)}},w10E:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i("X37l"),n=i("SAYH");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class a{constructor(){this._recentItems=[],this._targetEntityTypeNames=[]}updateRecentItems(e,t,i){this._recentItems=e,t&&(this._targetEntityTypeNames=t),i&&(this._disableMru=i.isMruDisabled)}getRecentItems(e){if(this._disableMru)return[];let t=this._recentItems?this._recentItems.map(t=>!(t&&t.RecordType===r.a.Entity&&t.EntityTypeName&&this._targetEntityTypeNames&&-1!==this._targetEntityTypeNames.indexOf(t.EntityTypeName))||e&&e.entityTypeNames&&-1===e.entityTypeNames.indexOf(t.EntityTypeName)?null:{lastAccessed:t.LastAccessed,entityTypeName:t.EntityTypeName,pinStatus:t.PinStatus,objectId:n.a.toString(t.ObjectId),title:t.Title,iconPath:t.IconPath}):[];return t=t.filter(e=>null!==e),t}}},x3V2:function(e,t,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,n;function a(){return[{LinkEntity:"account",IdAttribute:"accountid",DisplayAttribute:"name"},{LinkEntity:"contact",IdAttribute:"contactid",DisplayAttribute:"name"}]}function s(){return{LinkEntity:"systemuser",IdAttribute:"systemuserid",DisplayAttribute:"fullname"}}function o(){return[]}i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return r})),function(e){e[e.Header=0]="Header",e[e.Body=1]="Body",e[e.Footer=2]="Footer"}(r||(r={})),function(e){e[e.String=0]="String",e[e.Number=1]="Number",e[e.Boolean=2]="Boolean",e[e.DateTime=3]="DateTime",e[e.PartyList=4]="PartyList",e[e.UniqueIdentifier=5]="UniqueIdentifier",e[e.Virtual=6]="Virtual"}(n||(n={}))},xMtD:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"e",(function(){return o})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return l})),i.d(t,"f",(function(){return c})),i.d(t,"d",(function(){return d}));var r=i("SAYH"),n=i("504W"),a=i("CPoS");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function s(e,t,i){const n=Object(a.b)(e,t);if(!n||!n.businessProcessFlowEntities||0===n.businessProcessFlowEntities.length)return null;for(const e in n.businessProcessFlowEntities){const t=n.businessProcessFlowEntities[e];if(t.hasOwnProperty("stage")&&r.a.equals(t.stage.stageId,i))return t}return null}function o(e,t){const i=Object(a.b)(e,t);if(!i||!i.businessProcessFlowEntities||0===i.businessProcessFlowEntities.length)return null;const r=i.businessProcessFlowEntities[0];return r.relationships?r.relationships:null}function l(e,t,i){let r=null;if(Object(n.a)(e)||Object(n.a)(e.metadata)||Object(n.a)(e.metadata.forms))return r;const s=Object(a.b)(e,t);if(!s||!s.businessProcessFlowUniqueName){const e=[];return e.push({name:"ProcessId",value:t.guid}),i.error("BPF descriptor does not contain 'businessProcessFlowUniqueName'",e),r}return Object.keys(e.metadata.forms).forEach(t=>{e.metadata.forms[t].EntityLogicalName===s.businessProcessFlowUniqueName&&(r=e.metadata.forms[t])}),r}function u(e,t){const i={};if(Object(n.a)(e.Controls)){const r=[];return r.push({name:"BPF Entity FormId",value:e.Id.guid},{name:"BPF Entity Form Name",value:e.EntityLogicalName},{name:"BPF Entity Form Type",value:e.FormType}),t.info("BPF form descriptor does not contain any controls",r),i}const a=e.Controls;return Object.keys(a).forEach(e=>{Object(n.a)(a[e].UniqueId)||a[e].UniqueId===r.a.EMPTY.guid||(i[e]=a[e])}),i}function c(e,t,i,s){const o=Object(a.b)(e,t),l=i.Tabs,u=i.Sections,c=[];if(c.push({name:"BPF Entity FormId",value:i.Id.guid},{name:"BPF Entity Form Name",value:i.EntityLogicalName},{name:"BPF Entity Form Type",value:i.FormType}),Object(n.a)(l))return s.error("BPF form descriptor does not contain any tabs",c),!1;if(0===Object.keys(l).length)return s.error("BPF form descriptor contains an empty tab collection",c),!1;if(Object(n.a)(u))return s.error("BPF form descriptor does not contain any sections",c),!1;if(0===Object.keys(u).length)return s.error("BPF form descriptor contains an empty section collection",c),!1;const d=[],p=[],h=[],m=o.businessProcessFlowEntities;if(Object.keys(m).forEach(e=>{const t=m[e].stage;Object(n.a)(t)||Object(n.a)(t.stageId)||Object(n.a)(t.stageId.guid)||t.stageId.guid===r.a.EMPTY.guid||d.indexOf(t.stageId.guid)<0&&d.push(t.stageId.guid.toLowerCase())}),Object.keys(l).forEach(e=>{const t=l[e].RawTabId;!Object(n.a)(t)&&t!==r.a.EMPTY.guid&&p.indexOf(t.toLowerCase())<0&&p.push(new r.a(t).guid.toLowerCase())}),Object.keys(u).forEach(e=>{const t=u[e].Id;!Object(n.a)(t)&&t!==r.a.EMPTY&&h.indexOf(t.guid.toLowerCase())<0&&h.push(t.guid.toLowerCase())}),c.push({name:"BPF Stage Ids",value:d},{name:"BPF Entity Form Tab Ids ",value:p},{name:"BPF Entity Form Section Ids ",value:h}),d.length>p.length)return s.error("Number of stageIds in UIData is greater than the number of stageIds in the FormXML",c),!1;if(h.length!==p.length)return s.error("Number of tabs and sections do not match.",c),!1;for(let e=0;e<d.length;e++)if(p.indexOf(d[e])<0)return c.push({name:"Missing Stage Id in BPF Form descriptor",value:d[e]}),s.error("StageId missing from BPF form descriptor",c),!1;return!0}function d(e,t){const i=Object(a.b)(e,t);if(!i||!i.businessProcessFlowEntities||i.businessProcessFlowEntities.length<=1)return null;const r=i.businessProcessFlowEntities[0].relationships?i.businessProcessFlowEntities[1]:i.businessProcessFlowEntities[0];return r&&r.stage?r.stage.stageId:null}},yTPE:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var r=i("r0As"),n=i("kSDG"),a=i("nfCs"),s=i("iZ7K"),o=i("fKWG");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class l{constructor(e,t){this._attribute=e,this._extendedGroupBys=new Array,this._chartDefinition=t,this._addExtendedGroupBys(),this._initializeOrderType()}get groupAttribute(){return this._attribute}get extendedGroupBys(){return this._extendedGroupBys}get descending(){return this._descending}get hasOrder(){return this._hasOrder}_initializeOrderType(){const e=this._attribute.entity.orderByAttributes;for(let t=0;t<e.length;t++){const i=e[t];if(i.aliasName===this._attribute.aliasName)return this._hasOrder=!0,void(this._descending=i.descending)}}_addExtendedGroupBys(){this._addPrimaryFieldGroupByforPrimaryKey(),this._addDateGroupBys()}_addDateGroupBys(){if(!this._attribute.dateTimeGrouping)return;let e=-1;const t=this._attribute.entity.orderByAttributes;for(let i=0;i<t.length;i++){const r=t[i];if(r.aliasName===this._attribute.aliasName){e=i,this._hasOrder=!0,this._descending=r.descending;break}}switch(-1===e&&(Object(r.h)(this._attribute.entity,this._attribute,!0,!1,t.length),e=t.length-1,this._hasOrder=!0,this._descending=!1),this._attribute.dateTimeGrouping.groupingType){case o.a.FISCAL_YEAR:case o.a.FISCAL_PERIOD:case o.a.YEAR:return;case o.a.WEEK:case o.a.MONTH:case o.a.QUARTER:this._addGroupingAndOrder(o.a.YEAR,this.descending,e);break;case o.a.DAY:this._addGroupingAndOrder(o.a.MONTH,this.descending,e),this._addGroupingAndOrder(o.a.YEAR,this.descending,e)}}_addPrimaryFieldGroupByforPrimaryKey(){const e=this._attribute.entity,t=Object(s.h)(e.getState(),e.entityName).PrimaryIdAttribute;if(!t||this._attribute.attributeName!==t)return;const i=Object(s.h)(e.getState(),e.entityName).PrimaryNameAttribute,a=e.entityName+"_"+i+"_extendedGroupByAttribute",o=Object(n.a)(i,a,e);if(this._attribute.hasGroupBy){for(let t=0;t<e.groupByAttributes.length;t++){const r=e.groupByAttributes[t];if(r.attributeName===i)return void this._extendedGroupBys.push(r)}o.hasGroupBy=!0,Object(r.g)(e,o.attributeName,o.aliasName,"true",null,null,null),e.groupByAttributes.push(o)}else Object(r.g)(e,o.attributeName,o.aliasName);e.attributes.push(o),e.attributesByName.set(o.aliasName,o),this._chartDefinition.allAttributeNamesByEntity.has(e.entityName)&&this._chartDefinition.allAttributeNamesByEntity.get(e.entityName).set(o.attributeName,o),this._extendedGroupBys.push(o)}_addGroupingAndOrder(e,t,i){const s=this._attribute.entity,l=this._attribute&&this._attribute.aliasName?this._attribute.aliasName+"_"+o.a[e]:Object(n.b)(s.entityName,this._attribute.attributeName),u=Object(n.a)(this._attribute.attributeName,l,s,a.a(e));u.hasGroupBy=!0,s.groupByAttributes.push(u),s.attributes.push(u),s.attributesByName.set(u.aliasName,u),Object(r.h)(s,u,!0,t,i),Object(r.g)(s,u.attributeName,u.aliasName,"true",null,a.c(e),"true"),this._extendedGroupBys.push(u)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function u(e,t,i,a){const o=e.getAttribute("alias"),u=t.allMeasureInfo.get(o),c={measureAttribute:u.attributeExpression,parentMeasureCollection:i,parentCategory:a};return function(e,t,i){if(!e.parentCategory.primaryGroupBy)if(!t.groupByList||t.groupByList.length<=0)e.parentCategory.primaryGroupBy=function(e,t){if(e.hasAggregate)return null;const i=Object(n.a)(Object(s.h)(e.getState(),e.entityName).PrimaryIdAttribute,null,e);return Object(r.g)(e,i.attributeName,null),e.attributes.push(i),e.attributesByName.set(i.attributeName,i),t.allAttributeNamesByEntity.has(e.entityName)&&t.allAttributeNamesByEntity.get(e.entityName).set(i.attributeName,i),new l(i,t)}(t.attributeExpression.entity,i);else if(e.parentCategory.primaryGroupByAlias)for(let r=0;r<t.groupByList.length;r++){const n=t.groupByList[r];if(n.aliasName===e.parentCategory.primaryGroupByAlias){e.parentCategory.primaryGroupBy=new l(n,i);break}}else e.parentCategory.primaryGroupBy=new l(t.groupByList[0],i);if(!e.parentMeasureCollection.secondaryGroupBys&&(e.parentMeasureCollection.secondaryGroupBys=new Array,t.groupByList&&t.groupByList.length>1))for(let r=0;r<t.groupByList.length;r++){const n=t.groupByList[r];n!==e.parentCategory.primaryGroupBy.groupAttribute&&e.parentMeasureCollection.secondaryGroupBys.push(new l(n,i))}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(c,u,t),c}function c(e,t,i){const r={measures:new Array,chartDataDefinition:t,secondaryGroupBys:null};return r.measures.push(u(e.getElementsByTagName("measure")[0],r.chartDataDefinition,r,i)),r}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class d{constructor(e,t){this._attributeExpression=e,this._groupByList=t}get groupByList(){return this._groupByList}get attributeExpression(){return this._attributeExpression}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class p{constructor(e){this._getState=e,this._allAttributeNamesByEntity=new Map,this._groupByList=new Array,this._allMeasureInfo=new Map,this._allAttributes=new Map}get category(){return this._category}get isComparisonChart(){return this._isComparisonChart}get entityExpression(){return this._entityExpression}get groupByList(){return this._groupByList}get allMeasureInfo(){return this._allMeasureInfo}get allAttributeNamesByEntity(){return this._allAttributeNamesByEntity}get categoryColumns(){const e=new Array;if(this._category.primaryGroupBy){this._category.primaryGroupBy.groupAttribute.attributeName!==Object(s.h)(this._getState(),this.category.primaryGroupBy.groupAttribute.entity.entityName).PrimaryIdAttribute&&e.push(this._category.primaryGroupBy.groupAttribute);for(let t=0;t<this._category.primaryGroupBy.extendedGroupBys.length;t++)e.push(this._category.primaryGroupBy.extendedGroupBys[t])}else for(let t=0;t<this._entityExpression.attributes.length;t++){const i=this._entityExpression.attributes[t],r=i.aliasName?i.aliasName:i.attributeName;this._allMeasureInfo.has(r)||e.push(i)}return e}isOrderPresent(){if(this._entityExpression.orderByAttributes.length>0)return!0;const e=this._entityExpression.linkedEntities;for(let t=0;t<e.length;t++)if(e[t].orderByAttributes.length>0)return!0;return!1}isOrderPresentOnPrimaryGroupBy(){return!!(this._category&&this._category.primaryGroupBy&&this._category.primaryGroupBy.hasOrder)}isGroupByFromNestedLinkEntity(){const e=this._entityExpression.linkedEntities;for(const t of e)return this._isGroupByFromChildLinkEntity(t);return!1}_isGroupByFromChildLinkEntity(e){var t;for(const i of e.linkedEntities)return(null===(t=null==i?void 0:i.groupByAttributes)||void 0===t?void 0:t.length)>0||this._isGroupByFromChildLinkEntity(i);return!1}parserDataDefinition(e){const t=new DOMParser;this._dataXmlDoc=t.parseFromString(e,"text/xml"),function(e){const t=e.getElementsByTagName("parsererror");if(t&&t.length>0)throw new Error("Unreadable Chart Definition")}(this._dataXmlDoc),this._entityExpression=Object(r.b)(null,null,null,this._getState);const i=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("fetchcollection")[0].getElementsByTagName("fetch")[0];Object(r.e)(this._entityExpression,i),this._buildMeasureInformationFromFetch(this._entityExpression)}addGroupBys(e){this._groupByList.push(e),this._removeAliasFromCategoryNode()}_removeAliasFromCategoryNode(){const e=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("categorycollection")[0].getElementsByTagName("category")[0];e&&e.removeAttribute("alias")}buildCategory(){this._buildChartMeasures(),this._isComparisonChart=this._category.measureCollections[0].secondaryGroupBys.length>0}_buildChartMeasures(){const e=this._dataXmlDoc.getElementsByTagName("datadefinition")[0].getElementsByTagName("categorycollection")[0].getElementsByTagName("category")[0];if(!e)throw new Error("data xml missing category node!");this._category=function(e,t){const i={chartDataDefinition:t,measureCollections:new Array,primaryGroupByAlias:e.getAttribute("alias"),primaryGroupBy:null},r=e.getElementsByTagName("measurecollection");for(let e=0;e<r.length;e++)i.measureCollections.push(c(r[e],i.chartDataDefinition,i));return i}(e,this)}_buildMeasureInformationFromFetch(e){const t=e.entityName;let i;this._allAttributeNamesByEntity.has(t)?i=this._allAttributeNamesByEntity.get(t):(i=new Map,this._allAttributeNamesByEntity.set(t,i));const r=e.attributes;for(let e=0;e<r.length;e++){const t=r[e];i.set(t.attributeName,t);const n=(t.aliasName,t.aliasName);this._allAttributes.set(n,t),t.hasGroupBy?this._groupByList.push(t):this._allMeasureInfo.set(h(t),new d(t,this._groupByList))}for(let t=0;t<e.linkedEntities.length;t++)this._buildMeasureInformationFromFetch(e.linkedEntities[t])}}function h(e){return e.aliasName?e.aliasName:e.attributeName}var m=i("SAYH"),g=i("BzGi"),f=i("d0w6");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class b{constructor(e,t,i,r,n){this._initialized=!1,this._isWebResourceChart=!1,this._isRollUpView=!1,this.getState=e,this._visualizationId=t,this._viewId=i,this._visualizationType=r||g.a.savedvisualization,this._viewType=n||f.b.savedview}get dataDefinition(){return this._dataDefinition}get fetchXml(){return Object(r.d)(this._dataDefinition.entityExpression)}get viewDefinition(){return this._viewDefinition}get viewXml(){return this._viewDefinition?Object(r.d)(this._viewDefinition):null}get viewId(){return this._viewId}get visualizationId(){return this._visualizationId}get viewType(){return this._viewType}get visualizationType(){return this._visualizationType}get isWebResourceChart(){return this._isWebResourceChart}get presentationXml(){return this._presentationXml}get viewTitle(){return this._viewTitle}get viewEntityLogicalName(){return this._viewEntityLogicalName}get chartName(){return this._chartName}get chartPrimaryEntityTypeCode(){return this._chartPrimaryEntityTypeCode}get initialized(){return this._initialized}get isRollUpView(){return this._isRollUpView}initialize(e,t,i,n,a,s,o,l=!1,u=!1){e&&(this._dataDefinition=new p(this.getState),this._dataDefinition.parserDataDefinition(e)),t&&(this._viewDefinition=Object(r.b)(null,null,null,this.getState),Object(r.f)(this._viewDefinition,t)),this._presentationXml=i,this._isWebResourceChart=l,this._viewTitle=n,this._viewEntityLogicalName=a,this._chartName=s,this._chartPrimaryEntityTypeCode=o,this._isRollUpView=u,(l||e&&t)&&(this._initialized=!0)}getStorageKey(){let e="",t="",i="";this.initialized&&!this.isWebResourceChart&&(e=this.viewDefinition.linkedEntities.map(e=>Object(r.d)(e)).join(""),t=this.dataDefinition.entityExpression.linkedEntities.map(e=>Object(r.d)(e)).join(""),i=this.viewDefinition.filters.join(""));return`${this.viewEntityLogicalName||""}:${m.a.toString(this.viewId)}:${i}:${e}:${m.a.toString(this.visualizationId)}:${t}`}}},yzZr:function(e,t,i){"use strict";i.d(t,"W",(function(){return r})),i.d(t,"U",(function(){return n})),i.d(t,"n",(function(){return a})),i.d(t,"o",(function(){return s})),i.d(t,"b",(function(){return o})),i.d(t,"Q",(function(){return l})),i.d(t,"V",(function(){return u})),i.d(t,"i",(function(){return c})),i.d(t,"c",(function(){return d})),i.d(t,"h",(function(){return p})),i.d(t,"f",(function(){return h})),i.d(t,"a",(function(){return m})),i.d(t,"e",(function(){return g})),i.d(t,"d",(function(){return f})),i.d(t,"m",(function(){return b})),i.d(t,"j",(function(){return y})),i.d(t,"k",(function(){return v})),i.d(t,"l",(function(){return O})),i.d(t,"g",(function(){return _})),i.d(t,"T",(function(){return P})),i.d(t,"R",(function(){return S})),i.d(t,"S",(function(){return w})),i.d(t,"K",(function(){return I})),i.d(t,"O",(function(){return j})),i.d(t,"t",(function(){return C})),i.d(t,"s",(function(){return D})),i.d(t,"L",(function(){return E})),i.d(t,"F",(function(){return T})),i.d(t,"G",(function(){return F})),i.d(t,"N",(function(){return N})),i.d(t,"M",(function(){return R})),i.d(t,"I",(function(){return A})),i.d(t,"P",(function(){return k})),i.d(t,"J",(function(){return L})),i.d(t,"H",(function(){return M})),i.d(t,"r",(function(){return x})),i.d(t,"u",(function(){return V})),i.d(t,"w",(function(){return B})),i.d(t,"A",(function(){return U})),i.d(t,"y",(function(){return z})),i.d(t,"z",(function(){return W})),i.d(t,"x",(function(){return q})),i.d(t,"B",(function(){return G})),i.d(t,"v",(function(){return H})),i.d(t,"D",(function(){return K})),i.d(t,"E",(function(){return Q})),i.d(t,"C",(function(){return Y})),i.d(t,"q",(function(){return X})),i.d(t,"p",(function(){return Z})),i.d(t,"X",(function(){return $}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="Search_Page_Title",n="Search_SearchWith_Label",a="Search_FilterWith_Label_No_Colon",s="Search_FilterOption_None",o="Web.Tools.personalsettings.dialogs.personalsettings.aspx_213",l="Web.Tools.personalsettings.dialogs.personalsettings.aspx_212",u="Search_Noresults_Message",c="Search_TextInput_Placeholder",d="Search.Accessibility.Multiple_CategorizedSearchResult",p="Search.Accessibility.Single_CategorizedSearchResult",h="Search.Accessibility.ResultLoading",m="Search_FilterWith_Label_No_Colon",g="Grid_ToolTip_PreviousPage",f="Grid_ToolTip_NextPage",b="Facet_RecordType",y="Facet_CreatedOn",v="Facet_ModifiedOn",O="Facet_Owner",_="ReportViewer_PageOf",P="Search.Accessibility.Search_box",S="Search.Accessibility.Scan_Barcode",w="Search.Accessibility.Barcode_Scanned",I="RelevanceSearch.SearchResults",j="RelevanceSearch.TopResults",C="RelevanceSearch.ErrorTitle",D="RelevanceSearch.ErrorSubtitle",E="RelevanceSearch.Retry",T="RelevanceSearch.Feedback",F="RelevanceSearch.Feedback.Provided",N="RelevanceSearch.ShowMore",R="RelevanceSearch.ShowLess",A="RelevanceSearch.NoResult",k="RelevanceSearch.TryDifferentKeyword",L="RelevanceSearch.NumberOfResultsBasedOnFields",M="RelevanceSearch.Filters",x="RelevanceSearch.ClearAll",V="RelevanceSearch.Facet.Clear",B="RelevanceSearch.Facet.DateRange.Oldest",U="RelevanceSearch.Facet.DateRange.OneYearAgo",z="RelevanceSearch.Facet.DateRange.OneMonthAgo",W="RelevanceSearch.Facet.DateRange.OneWeekAgo",q="RelevanceSearch.Facet.DateRange.OneDayAgo",G="RelevanceSearch.Facet.DateRange.Today",H="RelevanceSearch.Facet.DateRange.Latest",K="RelevanceSearch.Facet.Range.From",Q="RelevanceSearch.Facet.Range.To",Y="RelevanceSearch.Facet.Owner.Me",X="Button_Label_Yes",Z="Button_Label_No",$=[r,o,l,n,a,s,"Ribbon.AdvancedFind.Show.Results",u,c,d,p,h,m,b,y,v,O,_,P,S,w,g,f,I,j,"RelevanceSearch.ShowNumberOfResults",N,R,A,k,C,D,E,T,F,"RelevanceSearch.EntityNumberOfResults","RelevanceSearch.EntityNumberOfSingleResult",L,M,x,V,B,U,z,W,q,G,H,Y,K,Q,X,Z]},zDpi:function(e,t,i){"use strict";i.d(t,"c",(function(){return C})),i.d(t,"b",(function(){return Q})),i.d(t,"a",(function(){return K}));var r=i("SAYH"),n=i("iZ7K"),a=i("x3V2"),s=i("NAAR");function o(e){switch(e){case s.b.Email:return u(s.b.ActivityModule,s.b.Email,s.b.From,a.a.PartyList,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.PhoneCall:return u(s.b.ActivityModule,s.b.PhoneCall,s.b.From,a.a.PartyList,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.Task:return u(s.b.ActivityModule,s.b.Task,s.b.ModifiedBy,a.a.String,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.Appointment:return u(s.b.ActivityModule,s.b.Appointment,s.b.Organizer,a.a.PartyList,s.b.ScheduledStart,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.RecurringAppointment:return u(s.b.ActivityModule,s.b.RecurringAppointment,s.b.Organizer,a.a.PartyList,s.b.ScheduledStart,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.Letter:return u(s.b.ActivityModule,s.b.Letter,s.b.From,a.a.PartyList,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.Fax:return u(s.b.ActivityModule,s.b.Fax,s.b.From,a.a.PartyList,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);case s.b.OpportunityClose:return u(s.b.ActivityModule,s.b.OpportunityClose,s.b.OwnerId,a.a.PartyList,s.b.ModifiedOn,a.a.DateTime,s.b.ActualRevenue,a.a.Number,s.b.Subject,a.a.String);case s.b.IncidentResolution:return u(s.b.ActivityModule,s.b.IncidentResolution,s.b.CreatedBy,a.a.String,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String);default:return null}}function l(e,t){e[t.activityType.toLowerCase()]=t}function u(e,t,i,r,n,a,s,o,l,u){const c={activityType:t,moduleName:e},d={dataFieldName:i,dataType:r},p={dataFieldName:n,dataType:a},h={dataFieldName:s,dataType:o},m={dataFieldName:l,dataType:u};return c.headerFields=[d,p],c.bodyFields=[h,m],c}var c=i("y60j"),d=i("LbMF"),p=i("IqkD"),h=i("Lyxw"),m=i("LE5i"),g=i("S6h3"),f=i("NjDY"),b=i("5Oca"),y=i("FCvT"),v=i("ybGo"),O=i("37s6"),_=i("3hnk"),P=i("dyr5"),S=i("E5IU"),w=i("b8TU"),I=i("9fGf"),j=i("3/02");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function C(e,t,i,r,n,a){const s=Object(g.b)(e,t.LabelId,m.a.Metadata);let o;return Object(g.d)(e,t.LabelId)?(o=D(e,t,i,r,n,a),o):2!==s?null:(o=D(e,t,i,r,n,a),o)}function D(e,t,i,r,a,o){let l=[];const u=Object(P.a)(e,s.n.SecondStage);u&&(l=V(e,t.Parameters[s.s.UClientActivities]));let c=i.entityTypeName;a&&a.target&&a.target.etn&&(c=a.target.etn);const d=function(e){const t=Object(b.i)(e,y.a);if(!t)return[];const i=[];for(const r in t){const a=t[r],s=a&&a.fields&&a.fields[y.c]?a.fields[y.c].value:"";if(s){const t=Object(n.h)(e,s);t&&t.IsEnabledInUnifiedInterface&&a.fields.statecode&&"0"===a.fields.statecode.valueString&&i.push(s)}}return i}(e);return{TimelineWallConfiguration:{SortActivitiesByValue:null!=t.Parameters[s.s.UClientSortActivitiesByValue]?t.Parameters[s.s.UClientSortActivitiesByValue]:s.u.SortActivitiesByValueDefault,DefaultModuleForCreateExperience:null!=t.Parameters[s.s.UClientDefaultModuleForCreateExperience]?t.Parameters[s.s.UClientDefaultModuleForCreateExperience]:s.u.DefaultModuleForCreateExperience,OrderBy:null!=t.Parameters[s.s.UClientOrderBy]?t.Parameters[s.s.UClientOrderBy]:s.u.OrderByDefault,RecordPerPage:null!=t.Parameters[s.s.UClientRecordPerPage]?t.Parameters[s.s.UClientRecordPerPage]:10,Label:null!=t.Parameters[s.s.Label]?t.Parameters[s.s.Label]:null,ShowFilterPane:R(e,t),ExpandFilterPane:N(t.Parameters[s.s.UClientExpandFilterPane],!1),DefaultFilters:E(t.Parameters[s.s.UClientDefaultFilterJSON]),EnableSearch:N(t.Parameters[s.s.UClientEnableSearch],!0),EnableWhatsChanged:N(t.Parameters[s.s.UClientEnableWhatsNewFilter],T(e)),ExpandRecord:N(t.Parameters[s.s.UClientExpandRecord],!1),ShowOneNotePane:k(e,i),ShowContextualEmail:M(e),ShowRichTextNotes:x(e),IsAutoDataCaptureV2Enabled:L(e),Activities:u?l:V(e,t.Parameters[s.s.UClientActivities]),Modules:A(e,t.Parameters[s.s.UClientModules],c,r.ContextType),DisplayActivityHeaderUsing:null!=t.Parameters[s.s.UClientDisplayActivityHeaderUsing]?t.Parameters[s.s.UClientDisplayActivityHeaderUsing]:s.u.DisplayActivityHeaderDefault,CreateActivityUsing:null!=t.Parameters[s.s.UClientCreateActivityUsing]?t.Parameters[s.s.UClientCreateActivityUsing]:s.u.CreateActivityDefault,DisplayActivityUsing:null!=t.Parameters[s.s.UClientDisplayActivityUsing]?t.Parameters[s.s.UClientDisplayActivityUsing]:s.u.DisplayActivityDefault,ActivityCardMap:Y(e,t.Parameters[s.s.UClientActivities],t.Parameters[s.s.UClientActivityCardMap],l),ActivityRollupType:t.Parameters[s.s.UClientActivityRollupType],ActivitiesConfigMap:E(t.Parameters[s.s.UClientActivitiesConfigurationJSON]),NotesConfigurations:E(t.Parameters[s.s.UClientNotesConfigurationJSON]),PostsConfigurations:E(t.Parameters[s.s.UClientPostsConfigurationJSON]),PostsEnabledEntities:d,PostsEnabledEntitiesQFVRetrievalList:Object(y.e)(d,o,e),isMetadataError:Object(g.d)(e,t.LabelId),upSyncStatus:Object(v.b)(e),offlineAvailableForUse:Object(O.w)(e),isNotesAnalysisEnabled:F(e,i),enableActivitiesTimeLinePerfImprovement:Object(f.x)(e).enableActivitiesTimeLinePerfImprovement},ContextType:r&&r.ContextType?r.ContextType:null,Type:s.q,EntitiesMetadata:B(e)}}function E(e){if(e)try{return JSON.parse(e)}catch(e){return null}return null}function T(e){return!Object(h.b)(e,"October2020Update")}function F(e,t){return!!Object(h.b)(e,s.t.TimelineWallNotesAnalysis)&&(function(e){const t=Object(p.w)(e).languageId;if(3081===t||10249===t||4105===t||9225===t||6153===t||8201===t||5129===t||13321===t||7177===t||11273===t||2057===t||1033===t||12297===t)return!0;return!1}(e)&&function(e){return e&&e.entityTypeName&&("contact"===e.entityTypeName||"opportunity"===e.entityTypeName||"lead"===e.entityTypeName||"account"===e.entityTypeName||"case"===e.entityTypeName)}(t))}function N(e,t){return null!=e?"true"===e:t}function R(e,t){const i=Object(h.b)(e,s.t.TimelineWallFilters),r=Object(P.c)(e),n=N(t.Parameters[s.s.UClientShowFilterPane],!0);return i&&n&&!r}function A(e,t,i,r){const a=[],o=i?Object(n.h)(e,i):null;r!==s.e&&o&&o.HasNotes&&a.push(s.u.NotesModule),(r===s.e||o&&o.HasActivities)&&a.push(s.u.ActivitiesModule),(r===s.e||function(e,t){const i=Object(b.i)(e,y.a);if(i)for(const e in i){const r=i[e];if(r.fields&&r.fields[y.c]&&r.fields[y.c].value===t)return r.fields[y.d]&&"1"!==r.fields[y.d].valueString}return!1}(e,i))&&a.push(s.u.PostsModule);let l=[];if(null!=t&&""!==t){const e=t.split(",");l=a.filter(t=>e.indexOf(t)>=0)}else l=a;return l.reduce((t,i)=>(function(e,t){switch(t){case s.u.ActivitiesModule:return Object(h.b)(e,s.t.TimelineWallActivities);case s.u.NotesModule:return Object(h.b)(e,s.t.TimelineWallNotes);case s.u.PostsModule:return Object(h.b)(e,s.t.TimelineWallPosts);case s.u.UserPostsModule:return Object(h.b)(e,s.t.TimelineWallUserPosts);default:return!1}}(e,i)&&t.push(i),t),[])}function k(e,t){if(t&&t.entityTypeName){const i=Object(f.x)(e),r=Object(p.w)(e),a=Object(n.h)(e,t.entityTypeName);if(Object(h.b)(e,s.i)&&Object(h.b)(e,s.p)&&0===i.sharePointDeploymentType&&r.isLive&&a.IsDocumentManagementEnabled&&a.IsOneNoteIntegrationEnabled)return!0}return!1}function L(e){return Object(f.x)(e).isAutoDataCaptureV2Enabled}function M(e){const t=Object(f.x)(e),i=Object(S.l)(e),r=Object(I.b)(e),n=Object(w.b)(e),a=Object(w.c)(e),o=s.d.SupportedUnifiedClientApps;return!!(Object(h.a)(e,s.t.TimelineWallContextualEmail)&&t.isContextualEmailEnabled&&(o.indexOf(i)>=0||Object(h.a)(e,s.t.TimelineWallContexual2020Update,j.h))&&r===I.a.Web&&n>s.d.PanelHeight&&a>s.d.PanelWidth)}function x(e){return Object(f.x)(e).isRichTextNotesEnabled}function V(e,t){const i=[],r=[];let a=null;const o=Object(P.a)(e,s.n.SecondStage);if(null!=t&&""!==t)a=t.split(","),a.forEach(t=>{if(!o||Object(_.b)(e,t)){G(Object(n.h)(e,t),t,r,i)}});else{const t=Object(n.g)(e);for(const a in t)if(t[a].IsActivity&&(!o||Object(_.b)(e,a))&&(t[a].IsCustomEntity||s.u.ActivitiesListSupported(e).indexOf(a)>=0)){G(Object(n.h)(e,a),a,r,i)}}return i.sort(H).concat(r.sort(H))}function B(e){const t=Object(n.g)(e),i={},r=Object(p.u)(e);for(const n in t){const a=t[n],o=q(a,n);if(o.Privileges={},U(r,a.Privileges,o.Privileges),a.IsActivity||s.u.SupportedModules.findIndex(e=>e.entityName===n)>=0||n===s.l){const t=Object(d.d)(e,n);o.AttributesMetadata=t}i[n]=o}return i}function U(e,t,i){if(t)for(let r=0;r<t.length;r++){const n=t[r];if(n){i[z(n.PrivilegeType)]=W(e,n.PrivilegeId)}}}function z(e){let t=e.toString();switch(e){case 1:t=s.o.Create;break;case 2:t=s.o.Read;break;case 3:t=s.o.Write;break;case 4:t=s.o.Delete;break;case 5:t=s.o.Assign;break;case 6:t=s.o.Share;break;case 7:t=s.o.Append;break;case 8:t=s.o.AppendTo}return t}function W(e,t){if(t&&""!==t&&e){const i=e[t];if(i&&i.privilegeDepth>=0)return!0}return!1}function q(e,t){const i={};return i.LogicalName=t,i.DisplayName=e.DisplayName,i.ObjectTypeCode=e.ObjectTypeCode,i.IsCustomEntity=e.IsCustomEntity,i.EntitySetName=e.EntitySetName,i.ActivityTypeMask=e.ActivityTypeMask,i.IsReadOnlyInMobileClient=e.IsReadOnlyInMobileClient,i.IsVisibleInMobileClient=e.IsVisibleInMobileClient,i.IsActivityParty=e.IsActivityParty,i.IconVectorName=e.IconVectorName,i}function G(e,t,i,r){e&&e.hasOwnProperty("IsActivity")&&e.IsActivity&&(e.IsCustomEntity?i.push(q(e,t)):r.push(q(e,t)))}function H(e,t){if(e&&t&&e.DisplayName&&t.DisplayName){const i=null==e.DisplayName.UserLocalizedLabel?e.DisplayName:e.DisplayName.UserLocalizedLabel.Label,r=null==t.DisplayName.UserLocalizedLabel?t.DisplayName:t.DisplayName.UserLocalizedLabel.Label;return i.localeCompare(r)}return-1}function K(e){let t=[];if(null!=e){t=e.split(",").map(e=>{const t=e.split(":");return{logicalName:t[0],objectTypeCode:t[1],formId:t[2]}})}return t}function Q(e,t){if(e&&e.dashboardId&&t.indexOf(s.f)>=0){const e=t.split(".");return e[e.length-1]}return t}function Y(e,t,i,r){const c=function(e,t){const i={timelineCards:{}};for(const r in t)if(t[r].IsActivity&&(t[r].IsCustomEntity||s.u.ActivitiesListSupported(e).indexOf(r)>=0)){const e=o(r);e&&l(i.timelineCards,e)}return l(i.timelineCards,u(s.b.NotesModule,s.b.Annotations,s.b.UserName,a.a.String,s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.NoteText,a.a.String)),l(i.timelineCards,u(s.b.PostsModule,s.b.AutoPost,s.b.RegardingObjectId,a.a.String,s.b.CreatedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Text,a.a.String)),l(i.timelineCards,u(s.b.PostsModule,s.b.UserPost,s.b.CreatedBy,a.a.String,s.b.CreatedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Text,a.a.String)),i.defaultCustomActivityCard=u("_default","_default",s.b.OwnerId,Object(a.e)(),s.b.ModifiedOn,a.a.DateTime,s.b.Subject,a.a.String,s.b.Description,a.a.String),i}(e,Object(n.g)(e));Object(P.a)(e,s.n.SecondStage)&&r||(r=V(e,t));const p=function(e,t,i){var r;const n={};for(let a=0;a<t.length;a++){const s=t[a];if(null!==s&&null!==s.ObjectTypeCode){const o=Object(d.d)(e,t[a].LogicalName);s.AttributesMetadata={};for(const e in o){const t=o[e];s.AttributesMetadata[t.LogicalName]=t}const l=i.find(e=>e.logicalName===s.LogicalName);s.FormId=null!==(r=null==l?void 0:l.formId)&&void 0!==r?r:"";const u=s.LogicalName;n&&(n[u]=s)}}return n}(e,r,K(i));if(null!=p)for(const t in p){let i;const r=p[t];if(""===r.FormId||void 0===r.FormId||null===r.FormId){h=c,m=r.LogicalName,i=h.timelineCards[m.toLowerCase()]?h.timelineCards[m.toLowerCase()]:h.defaultCustomActivityCard;const e=i.headerFields,t=i.bodyFields;null!==r.AttributesMetadata&&void 0!==r.AttributesMetadata&&($(e,r.LogicalName,r.AttributesMetadata),$(t,r.LogicalName,r.AttributesMetadata))}else i=X(e,r.FormId,r.LogicalName,p);null!=i&&l(c.timelineCards,i)}var h,m;return c}function X(e,t,i,n){let s,o={activityType:i,moduleName:"Activities",headerFields:[],bodyFields:[],formId:t};if(void 0===t||""===t||null===t)return null;if(s=new r.a(t),s){const t=Object(c.t)(e,s,"CardHeader"),i=Object(c.t)(e,s,"CardDetails");let r,l;return null!=t&&(l=t.Rows,l.forEach(e=>{r=e.Cells,null!=r&&(o=Z(r,a.b.Header,o,n))})),null!=i&&(l=i.Rows,l.forEach(e=>{r=e.Cells,null!=r&&(o=Z(r,a.b.Body,o,n))})),o}}function Z(e,t,i,r){for(let n=0;n<e.length;n++){const o={},l=e[n].ControlName;if(null!=l){const e=l,n=r[i.activityType];if(null!=e&&null!=n&&null!=n.AttributesMetadata&&null!=n.AttributesMetadata[e]){o.dataFieldName=e,o.label=n.AttributesMetadata[e].DisplayName;const r=n.AttributesMetadata[e].Type;o.dataType=s.g[r.toLowerCase()],t===a.b.Body?i.bodyFields.push(o):i.headerFields.push(o)}}}return i}function $(e,t,i){for(let t=0;t<e.length;t++){const r=e[t],n=r.dataFieldName;n&&i[n]&&(r.label=i[n].DisplayName)}}},zJiL:function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return n})),i.d(t,"e",(function(){return a})),i.d(t,"b",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"f",(function(){return l}));
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const r="SUCCESS",n="ERROR",a="WARNING",s="INFORMATION",o="LOCKED",l=new Set([o])}}]),window.bundleExecutionMarkers["scripts/5.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();