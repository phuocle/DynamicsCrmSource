(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/sidepanel.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[102],{aHX0:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i,s=n("CGM5"),a=n("HMYz"),o=n("iDZS"),l=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=function(e){function t(t){var n=e.call(this,t)||this;return n._iframeElement=null,n._origin=null,n._onLoad=n._onLoad.bind(n),n._origin=n._normalizeUrl(t.src),n}return l(t,e),t.prototype._normalizeUrl=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},t.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad(),this.props.onReadyStateComplete&&this.props.onReadyStateComplete()},t.prototype.getElementName=function(){return"iframe"},t.prototype.getElementProps=function(){var e={src:this.props.src,title:this.props.title,onLoad:this._onLoad};return this.props.security&&(e.security=this.props.security,e.sandbox=""),this.props.scrolling&&(e.scrolling=this.props.scrolling),this.props.allow&&(e.allow=this.props.allow),this.props.name&&(e.name=this.props.name),e.ref=this._registerIframeElement.bind(this),e},t.prototype.componentWillReceiveProps=function(){this._resetEventHandlers()},t.prototype._resetEventHandlers=function(){window.removeEventListener("message",this._receiveMessageHandler,!1),this._receiveMessageHandler=null,this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(void 0)},t.prototype._registerIframeElement=function(e){this._iframeElement=e,this._iframeElement?(this._receiveMessageHandler=this._receiveMessage.bind(this),window.addEventListener("message",this._receiveMessageHandler,!1),this.props.registerSendMessageHandler&&this.props.registerSendMessageHandler(this._sendMessage.bind(this))):this._resetEventHandlers()},t.prototype.componentWillUnmount=function(){this._resetEventHandlers()},t.prototype._receiveMessage=function(e){this._iframeElement&&e.source===this._iframeElement.contentWindow&&this._normalizeUrl(e.origin)===this._origin&&this.props.onMessage&&this.props.onMessage(e)},t.prototype._sendMessage=function(e){this._iframeElement&&this._iframeElement.contentWindow.postMessage(e,this._origin)},t.displayName="IFrame",t}(s.a),d=a.connect(o.a)(r)},gYJt:function(e,t,n){"use strict";n.r(t),n.d(t,"XrmAppPanel",(function(){return C})),n.d(t,"SidePanel",(function(){return me})),n.d(t,"loadSidePanelWithPageInput",(function(){return ye})),n.d(t,"loadSidePanelWithUrl",(function(){return Ie})),n.d(t,"setPanelOptions",(function(){return b})),n.d(t,"getPanelWidth",(function(){return m}));var i=n("16wZ"),s=n("/leX"),a=n("rcL5"),o=n("LqfC"),l=n("zsAz");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){switch(e){case 1:case 2:return}throw Object(l.d)("Invalid panel position",2415919121,[{name:"position",value:e}])}function d(e){switch(e){case 0:case 1:case 2:return}throw Object(l.d)("Invalid panel state",2415919121,[{name:"state",value:e}])}function p(e){if(!e)throw Object(l.d)("Invalid width",2415919121,[{name:"width",value:e}]);if(!/^\d+(\.\d+)?(px|%)?$/.test(e))throw Object(l.d)("Invalid width",2415919121,[{name:"width",value:e}])}function c(e){return 2===e?o.o:o.m}function h(e){return 1===e?o.l:void 0}let u=0;function g(){return"sidePanel-"+u++}function P(e,t,n){const i=Object(a.c)(e,t);if(i&&(i.type===s.b.IFrame||!n))throw Object(l.d)("Cannot create SidePanel. Only 1 sidepanel in each position",2415919107)}function b(e,t){return{type:o.f,sync:!0,execute({dispatch:n,getState:i},s){var c;const h=i(),u=Object(a.d)(h,e);t.sidePanelPosition&&(null===(c=u.option)||void 0===c?void 0:c.sidePanelPosition)!==t.sidePanelPosition&&function(e,t,n){const i=Object(a.c)(e,n);if(i&&i.sidePanelId!==t)throw Object(l.d)("Cannot update SidePanel position. Only 1 sidepanel in each position",2415919107)}(h,u.sidePanelId,t.sidePanelPosition),t.sidePanelState&&d(t.sidePanelState),t.sidePanelPosition&&r(t.sidePanelPosition),t.sidePanelWidth&&p(t.sidePanelWidth);try{t.sidePanelWidth&&localStorage.setItem(o.q,t.sidePanelWidth+"px"),t.sidePanelState&&localStorage.setItem(o.n,t.sidePanelState.toString())}catch(e){}n(function(e,t){return{type:o.g,payload:{sidePanelId:e,option:t}}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(e,t))}}}function m(e,t){const n=Object(a.d)(e,t);if(2===n.option.sidePanelState)return 0;if(0===n.option.sidePanelState)return c(n.option.sidePanelPosition);const i=n.option.sidePanelWidth,s=h(n.option.sidePanelState);if(i){const e=function(e){let t;if(!(e.indexOf("%")>-1))return parseInt(e,10);{const n=document.getElementById("mainContent"),i=n?n.offsetWidth:0;t=+e.substring(0,e.indexOf("%"))/100*i}return t}(i.toLowerCase());return e>s?e:s}return s}var f=n("dNvO"),_=n("B3HF"),y=n("nJrx"),S=n("ABCl");class C{constructor(e,t,n){const s="ClientApi.XrmAppPanel.constructor";Object(i.g)(e,s,"store"),Object(i.g)(t,s,"context"),Object(i.g)(n,s,"sidePanelId"),Object(a.d)(e.getState(),n),this._store=e,this._applicationContext=t,this._sidePanelId=n,this._clientApiExecutor=new S.b(e,"ClientApi.XrmAppPanel."),this._onChannelMessageRecieved=this._onChannelMessageRecieved.bind(this),this._subscriberChannel=this._applicationContext.ChannelManager.createChannel(Object(y.a)(),this._onChannelMessageRecieved),this._subscriberChannel.subscribeTo(n)}set position(e){this._clientApiExecutor.execute("position_set",()=>{this._store.dispatch(b(this._sidePanelId,{sidePanelPosition:e}))},[{name:"panelPosition",value:e,isRequired:!0}])}get position(){return this._clientApiExecutor.execute("position_get",()=>Object(a.d)(this._store.getState(),this._sidePanelId).option.sidePanelPosition)}set state(e){this._clientApiExecutor.execute("state_set",()=>{this._store.dispatch(b(this._sidePanelId,{sidePanelState:e}))},[{name:"panelState",value:e,isRequired:!0}])}get state(){return this._clientApiExecutor.execute("state_get",()=>Object(a.d)(this._store.getState(),this._sidePanelId).option.sidePanelState)}set title(e){this._clientApiExecutor.execute("title_set",()=>{this._store.dispatch(b(this._sidePanelId,{sidePanelTitle:e}))},[{name:"panelTitle",value:e,isRequired:!0}])}get title(){return this._clientApiExecutor.execute("title_get",()=>Object(a.d)(this._store.getState(),this._sidePanelId).option.sidePanelTitle||"")}get url(){return this._clientApiExecutor.execute("url_get",()=>{const e=Object(a.d)(this._store.getState(),this._sidePanelId);return e.type===s.b.IFrame?e.sidePanelURL:""})}set width(e){this._clientApiExecutor.execute("width_set",()=>{this._store.dispatch(b(this._sidePanelId,{sidePanelWidth:e.toString()+"px"}))},[{name:"panelWidth",value:e,isRequired:!0}])}get width(){return this._clientApiExecutor.execute("width_get",()=>m(this._store.getState(),this._sidePanelId))}_onChannelMessageRecieved(e,t){if(this._sidePanelId===t)switch(e.type){case f.a.PostMessage:const t={message:e.data.data,origin:e.data.origin};this._store.dispatch(Object(_.k)(this._sidePanelId,this,t));break;case f.a.SizeChange:this._store.dispatch(Object(_.l)(this._sidePanelId,this));break;case f.a.StateChange:this._store.dispatch(Object(_.m)(this._sidePanelId,this))}}postMessage(e){this._clientApiExecutor.execute("postMessage",()=>{this._applicationContext.ChannelManager.sendMessage(this._subscriberChannel,this._sidePanelId,e)},[{name:"message",value:e,isRequired:!0}])}addOnMessageReceived(e){this._clientApiExecutor.execute("addOnMessageReceived",()=>{this._store.dispatch(Object(_.c)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnMessageReceived(e){this._clientApiExecutor.execute("removeOnMessageReceived",()=>{this._store.dispatch(Object(_.h)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnSizeChange(e){this._clientApiExecutor.execute("addOnSizeChange",()=>{this._store.dispatch(Object(_.d)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnSizeChange(e){this._clientApiExecutor.execute("removeOnSizeChange",()=>{this._store.dispatch(Object(_.i)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}addOnStateChange(e){this._clientApiExecutor.execute("addOnStateChange",()=>{this._store.dispatch(Object(_.e)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}removeOnStateChange(e){this._clientApiExecutor.execute("removeOnStateChange",()=>{this._store.dispatch(Object(_.j)(this._sidePanelId,e))},[{name:"handler",value:e,isRequired:!0}])}}var v=n("nuS9"),x=n("YWpA"),I=n("u+q+");var w=n("Gilj"),O=n("FhVi"),M=n("3rse"),E=n("zVFX");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
let L,j,T,R,B,k,D,H=null;function z(e,t,n,i,s,a,l,r,d,p){if(null!==H&&L!==n&&j!==i&&T!==e&&R!==s&&B!==a&&k!==l)return H;L=n,j=i,T=e,R=s,B=a,k=l,D=r;const u=function(){let e;e=0===j?c(L)+"px":k||o.p;return e}(),g=h(j);H={panel:A(u,g,d,p),topSession:{display:"flex",flexShrink:0,height:E.a.sizes.Measures.Measure300,width:B?u:"100%",minWidth:g,borderBottom:"1px solid rgb(216, 216, 216)",background:"#EFEFEF"},bottomSession:{height:"100%",display:"flex",flexDirection:"column",width:B?u:"100%",minWidth:g,background:"#ffffff"},sideTitle:{width:o.o,height:"100%",cursor:"pointer",":hover":{background:"#d8d8d8"}},titleTextStyle:{width:"100%",paddingLeft:14,lineHeight:E.a.sizes.Measures.Measure300,overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"block",fontSize:16},buttonStyle:{height:E.a.sizes.Measures.Measure300,width:o.o,background:"transparent",color:"inherit",border:"none",lineHeight:E.a.sizes.Measures.Measure300,cursor:"pointer",":hover":{background:"#d8d8d8"}}};const P="solid 1px #D8D8D8";return 0===i&&(1===n?(Object.assign(H.panel,{borderLeft:p?P:0,borderRight:p?P:0,borderTop:p?P:0,"border-top-left-radius":"5px","border-top-right-radius":"5px","box-shadow":"rgb(102, 102, 102, 0.2) 0 -4px 8px",overflow:"hidden"}),Object.assign(H.bottomSession,{borderLeft:P,borderRight:P})):H.panel.borderLeft=p?P:0),H}function A(e,t,n,i){let s="",a="";const l="solid 1px #D8D8D8";let r;return 1===j&&(2===L?T?a=l:s=l:T?s=l:a=l),r=2===j?{display:"none"}:{width:e,minWidth:t,maxWidth:"100%",height:"100%",order:D,borderLeft:s,borderRight:a,boxSizing:"content-box",display:"flex",flexDirection:"column",borderTop:i&&l},0===j&&1===L&&Object.assign(r,{position:"absolute",height:R?43:88,bottom:0,[T?"right":"left"]:7+n*(o.m+7)}),B&&1===j&&Object.assign(r,{position:"absolute",width:"100%",top:0,bottom:0,left:0,right:0,alignItems:1===L?"flex-start":"flex-end",backgroundColor:"rgba(0, 0, 0, 0.5)"}),r}var W=n("Afz2"),F=n("QBtP"),q=n("evW+"),U=n("XIN1"),X=n("o0iw"),J=n("H/hG"),N=n("znb3");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function V(e){let t="";const n=1===e.position,i=0===e.sidePanelState;return t=n?i?"ChromeMaximize":"ChromeMinimize":i?e.isRTL?"RightChevron":"LeftChevron":e.isRTL?"LeftChevron":"RightChevron",v.createElement(q.a,{key:"sidePanelExpandedCollapseButton",accessibilityExpanded:!i,accessibilityLabel:e.expandCollapseButtonLabel,title:e.expandCollapseButtonLabel,style:e.style,onClick:e.onClick,testhooks:{id:"expand-collapse-button-sidepanel"}},v.createElement(U.b,{type:Object(X.q)(t),style:{width:"100%"}}))}function G(e){return v.createElement(q.a,{key:"sidePanelCloseButton",accessibilityLabel:e.closeButtonLabel,title:e.closeButtonLabel,style:e.style,onClick:e.onClick,testhooks:{id:"expand-collapse-button-sidepanel"}},v.createElement(U.b,{type:N.a.Close,style:{width:"100%"}}))}function Y(e){const t=Object.assign(Object.assign({},e.style),e.defaultCollapsedBehavior?{height:"100%",borderBottom:""}:{height:"3rmb",borderBottom:"1px solid transparent"});return v.createElement(x.a,{style:t,onClick:e.onClick,key:"sidePanelRightCollapse"},v.createElement(V,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.state,isRTL:e.isRTL,style:e.buttonStyle,position:e.position}),e.defaultCollapsedBehavior&&v.createElement(x.a,{key:"sidePanelTitle",style:{width:300,margin:5,top:44,"transform-origin":"left top",transform:e.isRTL?"translateX(275px) translateY(300px) rotate(-90deg)":"translatex(27px) rotate(90deg)","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap",position:"absolute",display:"block"}},e.sidePanelTitle))}function K(e){if(e.canBeCollapsed&&!e.canBeClosed){const t=Object.assign(Object.assign({},e.topSessionStyle),{cursor:"pointer",":hover":{background:"#d8d8d8"}});return v.createElement(x.a,{style:t,key:"sidePanelHeader",onClick:e.onTogglePanelHandler},v.createElement(J.a,{style:e.titleTextStyle},e.sidePanelTitle),v.createElement(V,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.panelState,isRTL:e.isRTL,style:e.buttonStyle,position:e.panelPosition}))}return v.createElement(x.a,{style:e.topSessionStyle,key:"sidePanelHeader"},v.createElement(J.a,{style:e.titleTextStyle},e.sidePanelTitle),e.canBeClosed&&v.createElement(G,{closeButtonLabel:e.closeButtonLabel,style:e.buttonStyle,position:e.panelPosition,onClick:e.onClosePanelHandler}),e.canBeCollapsed&&v.createElement(V,{expandCollapseButtonLabel:e.expandCollapseButtonLabel,sidePanelState:e.panelState,isRTL:e.isRTL,style:e.buttonStyle,onClick:e.onTogglePanelHandler,position:e.panelPosition}))}var Q=n("oT5e"),Z=n("xPbo"),$=n("gQ5I");function ee(e){return{type:o.b,payload:{sidePanelId:e}}}var te=n("IqkD"),ne=n("QVDB"),ie=n("e9UD"),se=n("vIHs"),ae=n("unFF"),oe=n("pF61");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class le extends v.Component{constructor(e,t){super(e),this.state={errorPopupData:null}}componentDidUpdate(e){if(e.error!==this.props.error){const e=this.context.EventManager.getActivityId(),t=this.context.EventManager.getCurrentSessionId();this.props.error&&this.props.getErrorPopupData(this.props.error,e,t).then(e=>{this.setState({errorPopupData:e})})}}render(){if(this.state.errorPopupData)return v.createElement(ne.a,{errorPopupDescriptor:this.state.errorPopupData.errorPopupDescriptor,theme:this.props.theme,isViewportSmall:!0,okButtonLabel:this.state.errorPopupData.okButtonLabel,onOkHandler:()=>{}});const e=this.props.pageId?this.props.router.getPage(this.props.pageId):null;return e?v.createElement(e,{key:this.props.pageId,id:this.props.pageId}):v.createElement(ie.a,{key:"progressIndicator",id:"boot-loading-indicator",progressType:"ring",displayDelay:1e3,active:!0,style:{display:"flex"}})}}le.getDerivedStateFromProps=e=>e.error?null:{errorPopupData:null},le.contextType=F.a;const re=Object(I.a)((function(e,t){return{error:Object(oe.i)(e,t.browsingContextId),pageId:Object(Q.a)(e,t.browsingContextId).pageId,theme:Object(ae.a)(e)}}),(function(e){return{getErrorPopupData:(t,n,i)=>e({type:"GET_ERROR_POPUP_DATA",execute:({getState:s})=>Object(se.a)(t,e,s,{activityId:n,sessionId:i})})}}))(le);var de=n("aHX0");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const pe={width:"100%",height:"100%",display:"block"};function ce(e){return v.createElement(de.a,{id:e.iframeContainerId,key:e.iframeContainerId,title:e.iframeContainerId,style:pe,src:e.sidePanelUrl,onMessage:e.onIframeMessage,registerSendMessageHandler:e.registerIframeSendMessageHandler,allow:"microphone; camera; geolocation"})}var he=n("VnpK"),ue=n("arV0"),ge=n("FJpk");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Pe={height:"100%",flex:"1"};class be extends v.Component{constructor(e,t){super(e),this._communicationChannel=null,this._shortcutHandler=function(e){const t=document.querySelector(`[data-id="${o.i}"]`);t&&t.focus()},this._onTogglePanelHandler=this._onTogglePanelHandler.bind(this),this._registerIframeSendMessageHandler=this._registerIframeSendMessageHandler.bind(this),this._onChannelMessageRecieved=this._onChannelMessageRecieved.bind(this),this._onIframeMessage=this._onIframeMessage.bind(this),this._onFlyoutBackgroudClick=this._onFlyoutBackgroudClick.bind(this),this._windowResized=this._windowResized.bind(this),this._domId=o.i+"_"+this.props.sidePanelId,this._communicationChannel=t.ChannelManager.getChannel(e.sidePanelId),this._communicationChannel.setOnMesseageReceivedHandler(this._onChannelMessageRecieved)}componentDidMount(){this.props.setSidePanelLoadStateComplete(this.props.sidePanelId),this._sendMessage(f.a.LoadCompleted,null),window.addEventListener("resize",this._windowResized)}componentWillUnmount(){window.removeEventListener("resize",this._windowResized),this._sendIframeMessageHandler=null}componentDidUpdate(e){e.panelData.option.sidePanelState!==this.props.panelData.option.sidePanelState&&this._sendMessage(f.a.StateChange,null),e.panelData.option.sidePanelWidth!==this.props.panelData.option.sidePanelWidth&&this._sendMessage(f.a.SizeChange,null)}render(){if(!this.props.panelData||void 0===this.props.panelData.sidePanelLoadState||this.props.panelData.sidePanelLoadState===s.a.NotStarted)return null;const e=this.props.panelData.option,t=0===e.sidePanelState,n=1===e.sidePanelState,i=1===e.sidePanelPosition;t&&e.sidePanelDefaultCollapsedBehavior?Object.assign(Pe,{visibility:"hidden",height:0}):Object.assign(Pe,{visibility:"visible",height:"100%"});const a=!!e.canBeCollapsed,o=!!e.canBeClosed,l=!!e.showTitle,r=Object(he.n)(),d=z(this.props.isRTL,0,e.sidePanelPosition,e.sidePanelState,e.sidePanelDefaultCollapsedBehavior,this.props.forcedFlyout,e.sidePanelWidth,this.props.flexOrder,this.props.leftCollapsedOrder,r),p=t?this.props.sidePanelExpandButtonLabel:this.props.sidePanelCollapseButtonLabel,c=String.format(this.props.isRTL?"{1} {0}":"{0} {1}",p,this.props.title||this.props.sidePanelLabel),h=String.format(this.props.isRTL?"{1} {0}":"{0} {1}",this.props.closeButtonLabel,this.props.title||this.props.sidePanelLabel),u=l&&n||l&&i&&t,g=l&&t&&!i;return v.createElement(x.a,{tabIndex:-1,key:this._domId,id:this._domId,testhooks:{id:this._domId},accessibilityLabel:this.props.sidePanelLabel,style:d.panel,role:W.r,onClick:this._onFlyoutBackgroudClick},v.createElement(O.a,{key:"sidePanelAccessibility",keyboardShortcuts:this._createKeyboardShortcuts(),shouldManageFocus:!1}),u&&v.createElement(K,{key:"SidePanelHorizontalPanelTitle",titleTextStyle:d.titleTextStyle,buttonStyle:d.buttonStyle,topSessionStyle:d.topSession,isRTL:this.props.isRTL,panelPosition:e.sidePanelPosition,panelState:e.sidePanelState,canBeClosed:o,canBeCollapsed:a,sidePanelTitle:this.props.title,closeButtonLabel:h,expandCollapseButtonLabel:c,onTogglePanelHandler:this._onTogglePanelHandler,onClosePanelHandler:()=>this.props.closePanel(this.props.sidePanelId)}),v.createElement(x.a,{style:d.bottomSession,key:"sidePanelBody"},g&&v.createElement(Y,{sidePanelTitle:this.props.title,isRTL:this.props.isRTL,style:d.sideTitle,buttonStyle:d.buttonStyle,position:e.sidePanelPosition,state:e.sidePanelState,expandCollapseButtonLabel:c,onClick:this._onTogglePanelHandler,defaultCollapsedBehavior:e.sidePanelDefaultCollapsedBehavior}),v.createElement(x.a,{style:Pe,key:"sidePanelContent"},this.props.panelData.type===s.b.Page&&v.createElement(re,{router:this.props.router,browsingContextId:this.props.panelData.browsingContextId}),this.props.panelData.type===s.b.IFrame&&v.createElement(ce,{sidePanelId:this.props.sidePanelId,sidePanelUrl:this.props.panelData.sidePanelURL,legacyPanel:this.props.panelData.legacyPanel,iframeContainerId:this.props.panelData.legacyPanel?"SidePanelIFrame":"IFrame-"+this.props.sidePanelId,onIframeMessage:this._onIframeMessage,registerIframeSendMessageHandler:this._registerIframeSendMessageHandler}))))}_onFlyoutBackgroudClick(e){this.props.forcedFlyout&&1===this.props.panelData.option.sidePanelState&&e.target.id===this._domId&&this._onTogglePanelHandler()}_onTogglePanelHandler(){1===this.props.panelData.option.sidePanelState?this.props.setPanelState(this.props.sidePanelId,0):this.props.setPanelState(this.props.sidePanelId,1)}_registerIframeSendMessageHandler(e){this._sendIframeMessageHandler=e}_onIframeMessage(e){const t={data:e.data,origin:e.origin};this._sendMessage(f.a.PostMessage,t)}_windowResized(){this._sendMessage(f.a.SizeChange,null)}_onChannelMessageRecieved(e,t){if(!this._sendIframeMessageHandler)throw new Error("Send Message Handler was null");this._sendIframeMessageHandler(e)}_sendMessage(e,t){const n={type:e,data:t,senderId:this.props.sidePanelId};this._communicationChannel.sendToSubscribers(n)}_createKeyboardShortcuts(){const e=this._shortcutHandler.bind(this),t=[],n=new w.a([M.a.Ctrl,M.a.Shift,M.a.Period],e,!0,"Side Panel","Set focus on side panel");return t.push(n),t}}be.contextType=F.a;const me=Object(I.a)((function(e,t){var n;const i=Object(a.d)(e,t.sidePanelId);let o=null===(n=i.option)||void 0===n?void 0:n.sidePanelTitle;if(!o&&i.type===s.b.Page){const t=Object(Q.a)(e,i.browsingContextId);o=Object(ge.c)(Object(ue.j)(e,t.pageId))}return{title:o,panelData:i,isRTL:Object(te.g)(e)}}),(function(e){return{setSidePanelLoadStateComplete:t=>e(function(e){const t={sidePanelId:e};return{type:o.e,payload:t}}(t)),closePanel:t=>e(function(e){return{type:o.a,execute({dispatch:t,getState:n},i){const o=Object(a.d)(n(),e);if(o.type===s.b.Page){const s=Object(Q.a)(n(),o.browsingContextId);return t(Object($.e)(s.pageId,"close sidepanel",!1)).then(()=>{const n=i.ChannelManager.getChannel(e);return i.ChannelManager.destroyChannel(n),t(Object(Z.a)(o.browsingContextId)),t(ee(e)),!0})}return t(ee(e)),Promise.resolve(!0)}}}(t)),setPanelState:(t,n)=>e(b(t,{sidePanelState:n}))}}))(be);var fe=n("c/eZ"),_e=n("ruPX");function ye(e,t,n,i,l,r,d,p=!0,c=!1,h=!0,u=!1,m=!0){const f=[];return{type:o.c,execute({dispatch:_,getState:y},S){P(y(),ve(l),p),f.push({name:"inputPayload",value:JSON.stringify({pageType:e,pageInput:t,panelPosition:l,initialWidth:i,panelState:r,sidePanelDefaultCollapsedBehavior:d,replaceIfExisted:p,canBeClosed:c,canBeCollapsed:h,isTitleStatic:u,showTitle:m})}),null==d&&(d=!0);const C={sidePanelTitle:n||"",sidePanelDefaultCollapsedBehavior:d,sidePanelState:Ce(r),sidePanelWidth:Se(i),sidePanelPosition:ve(l),canBeClosed:c,canBeCollapsed:h,isTitleStatic:u,showTitle:m};let v="",x="",I=p?Object(a.a)(y(),C.sidePanelPosition):null;if(I)v=x=I.sidePanelId,_(b(v,C));else{v=x=g(),_(Object(Z.b)(x,!1)),I={sidePanelId:v,type:s.b.Page,browsingContextId:x,option:C},S.ChannelManager.createChannel(v,null),_((w=I,{type:o.d,payload:w}));const{sidePanelTitle:e}=C,t=Object(fe.__rest)(C,["sidePanelTitle"]),n=Object.assign(Object.assign({},I),{option:t});f.push({name:"payload",value:JSON.stringify(n)})}var w;return _(Object(_e.a)(e,t,void 0,{targetBrowsingContext:x})).then(()=>I)},getFailureParameters:(e,t,n,i)=>f,getSuccessParameters:(e,t,n)=>f}}function Se(e){let t;return null!=e&&p(e.toString()),t=null!=e?e.toString()+"px":o.p,t}function Ce(e){return null!=e&&d(e),null==e&&(e=1),e}function ve(e){return null!=e&&r(e),null==e&&(e=2),e}var xe=n("31Vn");function Ie(e,t,n,i,a,l,r=!1,d=!1,p=!0,c=!1,h=!0){const u=[];return{type:o.c,execute({dispatch:b,getState:m},_){P(m(),Me(i),!1);const S=g();u.push({name:"inputPayload",value:JSON.stringify({url:Object(xe.a)(e),sidePanelId:S,panelPosition:i,initialWidth:n,panelState:a,sidePanelDefaultCollapsedBehavior:l})}),null==l&&(l=!0);const C={sidePanelId:S,sidePanelURL:e,type:s.b.IFrame,option:{sidePanelTitle:t,sidePanelDefaultCollapsedBehavior:l,sidePanelState:Oe(a),sidePanelWidth:we(n),sidePanelPosition:Me(i),canBeClosed:d,canBeCollapsed:p,isTitleStatic:c,showTitle:h},legacyPanel:r};_.ChannelManager.createChannel(S,null),b(function(e){return{type:o.d,payload:e}}
/**
 * Public interface of the MultiSession feature. This feature is dynamically loaded.
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */(C));const v=C.option,{sidePanelTitle:x}=v,I=Object(fe.__rest)(v,["sidePanelTitle"]),w=Object.assign(Object.assign({},C),{sidePanelURL:Object(xe.a)(C.sidePanelURL),option:I});return u.push({name:"payload",value:JSON.stringify(w)}),new Promise(e=>{const t=_.ChannelManager.createChannel(Object(y.a)(),(n,i)=>{i===S&&n.type===f.a.LoadCompleted&&(_.ChannelManager.destroyChannel(t),C.sidePanelLoadState=s.a.Completed,e(C))});t.subscribeTo(S)})},getFailureParameters:(e,t,n,i)=>u,getSuccessParameters:(e,t,n)=>u}}function we(e){let t;if(null!=e&&p(e.toString()),null!=e){t=e.toString()+"px";try{localStorage.setItem(o.q,t)}catch(e){}}else{let e;try{e=localStorage.getItem(o.q),p(e)}catch(t){e=void 0}t=e||o.p}return t}function Oe(e){if(null!=e&&d(e),null!=e)try{localStorage.setItem(o.n,e.toString())}catch(e){}else{let t;try{t=localStorage.getItem(o.n),d(parseInt(t,10))}catch(e){t=void 0}e=void 0!==t?parseInt(t,10):1}return e}function Me(e){return null!=e&&r(e),null==e&&(e=2),e}}}]),window.bundleExecutionMarkers["scripts/sidepanel.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();