(window.bundleExecutionMarkers=window.bundleExecutionMarkers||{})["scripts/3.js?v=1.4.9962-v91onpremise"]={begin:performance.now()},(window.__wpJsonpUci=window.__wpJsonpUci||[]).push([[3],{"0oMj":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var r=i("Nzmy");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */const n={[-7e3.toString()]:"Your organization has not opted in for the Mobile Offline feature.",[-7001..toString()]:"You must opt in to the Offline mode to use this feature. ",[-7002..toString()]:"This feature is not available when you are connected to Dynamics 365 server.",[-7003..toString()]:"The Offline Data Store is not ready to  perform the operation.",[-7004..toString()]:"{0}�is a required parameter and cannot be null.",[-7005..toString()]:"{0} is an invalid value for the field.",[-7006..toString()]:"{0} is an invalid GUID.",[-7007..toString()]:"Max Page Size� should be a number.",[-7008..toString()]:"Max Page Size should be a positive integer.",[-7009..toString()]:'Option Parameter should begin with "?".',[-7010..toString()]:"{0} operation doesn�t have privilege to perform the operation.",[-7011..toString()]:"Attribute Metadata not found for entity {0}.",[-7012..toString()]:"Specified attributes are Invalid.",[-7013..toString()]:"Attribute {0} is not supported in offline mode.",[-7014..toString()]:"Entity {0} is not supported.",[-7015..toString()]:"Entity {0} is not enabled.",[-7016..toString()]:"Entity {0} is not available due to a mismatch in metadata.",[-7017..toString()]:"Entity Metadata not found for entity {0}.",[-7018..toString()]:"Specified query option string is invalid.",[-7019..toString()]:"The value of {0} query option cannot be null.",[-7020..toString()]:"Invalid value specified for the {0} query option.",[-7021..toString()]:"Specified Navigation Property not found for entity {0}.",[-7022..toString()]:"Navigation Property {0} is not present for entity {1}.",[-7023..toString()]:"The value of $top query option must be a non-negative number.",[-7024..toString()]:'Invalid direction suffix specified in the $orderby query option. Use the "asc" or "desc" suffix to specify ascending or descending order respectively.',[-7025..toString()]:"Specified FetchXML is invalid.",[-7026..toString()]:"No other query options are supported with the FetchXML option.",[-7027..toString()]:"Query option {0} is not supported.",[-7028..toString()]:"Retrieve doesn�t support query option {0}.",[-7029..toString()]:"Record not found.",[-7030..toString()]:"Error occurred during SQL generation.",[-7031..toString()]:"Error occurred while executing SQL.",[-7032..toString()]:"An unexpected error occurred.",[-7033..toString()]:"Invalid value specified for attribute {0}.",[-7034..toString()]:"Create or update or delete action on Activity Party and Intersect Entity are not allowed."};function a(t,e){if(t&&n[t.toString()]){let i=n[t.toString()];return e&&e.length>0&&(i=String.format(i,e)),i}throw r.c.error("Offline.XrmOfflineErrors.getErrorCodeMessage: Cant return error message for an invalid error code:"+t),new Error("XrmOfflineErrors: Cant return error message for an invalid error code:"+t)}},EXJz:function(t,e,i){"use strict";i.d(e,"b",(function(){return N})),i.d(e,"a",(function(){return x})),i.d(e,"g",(function(){return Q})),i.d(e,"e",(function(){return q})),i.d(e,"d",(function(){return B})),i.d(e,"c",(function(){return V})),i.d(e,"f",(function(){return I}));var r=i("Uv1Y"),n=i("TBkx"),a=i("LbMF"),s=i("iZ7K"),o=i("0oMj"),l=i("iF9X"),c=i("sZ+8"),u=i("37s6"),g=i("GL3b"),d=i("IqkD"),h=i("SAYH"),b=i("3hnk"),f=i("69Qu"),p=i("Nzmy"),y=i("+5Bq"),_=i("wHbR"),m=i("FZDd"),O=i("MXaZ"),w=i("HYaY"),j=i("WRF3"),S=i("sdkC"),C=i("wMH2"),E=i("8Mff"),v=i("eZ32"),A=i("504W");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function N(t,e,i){return new Promise((a,d)=>{if(!Object(l.a)(i.getState()))throw new r.a(Object(o.a)(-7e3),-7e3);return Object(f.b)(i.getState())?(p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs in online mode for this entity"),d(new r.a(Object(o.a)(-7002),-7002))):Object(u.p)(i.getState())!==E.a.Enabled?(p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs in when the user isnt opted in for this entity:"),d(new r.a(Object(o.a)(-7001),-7001))):Object(u.q)(i.getState())!==v.a.Available?(p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when status is not marked as available (offline db is not available) for this entity:"),d(new r.a(Object(o.a)(-7003),-7003))):(p.c.info("Offline.XrmOfflineValidators.basicValidator: Base level validations completed for entity:"+t+" & request type:"+e.toString()),void i.dispatch(Object(m.f)(t,!0,null)).then(()=>{const n=i.getState();if(Object(s.h)(n,t)){const l=Object(s.h)(i.getState(),t).Id,u=Object(g.b)(i.getState());if(!u||u.indexOf(t)<0)return p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when "+l+"is not present in user's profile"),d(new r.a(Object(o.a)(-7015,[t]),-7015));if(-1===Object(c.j)(i.getState()).indexOf(t))return p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs when "+l+"is marked offline disabled."),d(new r.a(Object(o.a)(-7016,[t]),-7016));const h=4===e||5===e?2:0===e?1:1===e?3:4;return!Object(s.s)(n,t)&&t!==_.b.ActivityParty||2===h?Object(b.g)(i.getState(),t,h,-1)?(p.c.info("Offline.XrmOfflineValidators.basicValidator: Entity level validations completed for entity:"+t+" & request type:"+e.toString()),a()):(p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs for "+l+" as the user dont have permission for operation:"+h.toString()),d(new r.a(Object(o.a)(-7010,[h.toString()]),-7010))):(p.c.error("Offline.XrmOfflineValidators.basicValidator: Cant call offline Client APIs for "+l+" with operation:"+h.toString()+" as only read operation is allowed for it."),d(new r.a(Object(o.a)(-7034),-7034)))}return p.c.error("Offline.XrmOfflineValidators.basicValidator: Entity metadata not present in state tree for this entity"),d(new r.a(Object(o.a)(-7017,[t]),-7017))}).catch(t=>(p.c.error("Offline.XrmOfflineValidators.basicValidator: Retrieval of metadata failed for entity with error:"+Object(n.e)(t)),d(t))))})}function x(t,e,i,s){Object.keys(s).forEach(l=>{const c=s[l];let u=i[l];if(!Object(A.a)(u)){let s=!0;try{switch(c){case"integer":case"bigint":isNaN(parseInt(u.toString(),10))?(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1):u=parseInt(u.toString(),10);break;case"decimal":case"double":case"money":isNaN(parseFloat(u.toString()))&&(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1);break;case"datetime":const i=Object(a.a)(e.getState(),t,l);u="DateOnly"===i.Format?Object(O.l)(Object(O.q)(u),Object(d.l)(e.getState()),i.Behavior,Object(d.k)(e.getState())):Object(O.l)(u,Object(d.l)(e.getState()),i.Behavior,Object(d.k)(e.getState()));break;case"boolean":"true"===u.toString().toLowerCase()||"false"===u.toString().toLowerCase()?u={[_.b.Value]:"true"===u.toString().toLowerCase()?"1":"0"}:(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1);break;case"state":case"status":case"picklist":isNaN(parseInt(u.toString(),10))?(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1):u={[_.b.Value]:parseInt(u.toString(),10)};break;case"uniqueidentifier":u={[_.b.RawGuid]:u.toString()};break;case"lookup":case"customer":case"owner":(function(t){return!(null===t||"object"!=typeof t||t instanceof Array||t instanceof Date)})(u)&&u[_.b.Id]&&u[_.b.LogicalName]?u=k(u):(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1);break;case"partylist":u instanceof Array&&u.length>0?u=function(t){const e=[],i=new j.a(_.b.ActivityParty,h.a.toLegacyGuid(h.a.EMPTY));return t.map(t=>{if(!t[_.b.Id]||!t[_.b.LogicalName])throw new Error("invalid value for party list attribute ");e.push(new w.a(i,{[_.b.PartyId]:w.a.createSingleFieldFromObjectData(k(t),"lookup")},{[_.b.PartyId]:"lookup"},{},{},new S.a([])))}),new C.a(e,!0,e.length,!1,null)}(u):(p.c.error("Invalid value for attribute "+l+" type of "+c),s=!1);break;case"string":case"memo":case"unknown":case"entityname":break;default:throw new r.a(Object(o.a)(-7013,[l]),-7013)}if(!s)throw new Error("Invalid value for attribute "+l+" type of "+c);"partylist"!==c&&(u=w.a.createSingleFieldFromObjectData(u,c))}catch(t){throw p.c.error(" formatting of attribute value failed with "+Object(n.e)(t)),t}i[l]=u}})}function k(t){return{[_.b.Id]:{[_.b.RawGuid]:t[_.b.Id]},[_.b.LogicalName]:t[_.b.LogicalName],[_.b.Name]:F(t[_.b.Name])}}function F(t){return t||(typeof t==typeof Number||Object.propertyIsEnumerable(typeof t)?0:typeof t!=typeof Boolean&&null)}function Q(t,e,i,a){let l,c=!0,u=!1;const g=new Map;try{return Object.keys(i.get_queryParameters()).forEach(d=>{switch(d){case _.c.SelectQueryOption:if(L(d,t,u)){c=!1;let t=null;try{t=i.get_select()}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+d),new r.a(Object(o.a)(-7020,[d]),-7020)}if(!t||!t.get_attributeNames()||0===t.get_attributeNames().length)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+d),new r.a(Object(o.a)(-7019,[d]),-7019);T(e,t.get_attributeNames(),a)}break;case _.c.ExpandQueryOption:if(L(d,t,u)){let t;c=!1;try{t=i.get_expand()}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+d),new r.a(Object(o.a)(-7020,[d]),-7020)}if(!t||!t.get_expandTerms()||0===t.get_expandTerms().length)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+d),new r.a(Object(o.a)(-7019,[d]),-7019);{const i=Object(s.h)(a.getState(),e)?Object(s.h)(a.getState(),e).Id:null;l=function(t,e){return e.dispatch(Object(m.f)(t,!0,[])).then(()=>{const i=Object(s.h)(e.getState(),t);if(!i)throw new r.a(Object(o.a)(-7017,[t]),-7017);const n=new Map;return i.OneToManyRelationships&&Object.keys(i.OneToManyRelationships).forEach(t=>{const e=i.OneToManyRelationships[t];n.set(e.ReferencedEntityNavigationPropertyName,{schemaName:e.SchemaName,relationshipType:0})}),i.ManyToOneRelationships&&Object.keys(i.ManyToOneRelationships).forEach(t=>{const e=i.ManyToOneRelationships[t];n.set(e.ReferencingEntityNavigationPropertyName,{schemaName:e.SchemaName,relationshipType:2})}),i.ManyToManyRelationships&&Object.keys(i.ManyToManyRelationships).forEach(e=>{const r=i.ManyToManyRelationships[e];r.Entity1LogicalName===t?n.set(r.Entity1NavigationPropertyName,{schemaName:r.SchemaName,relationshipType:1}):n.set(r.Entity2NavigationPropertyName,{schemaName:r.SchemaName,relationshipType:1})}),n}).catch(i=>{const r=Object(s.h)(e.getState(),t)?Object(s.h)(e.getState(),t).Id:null;return p.c.error("Offline.XrmOfflineValidators.getNavigationPropertiesForEntity: Entity Metadata could not be retrieved for entity "+r+" with error "+Object(n.e)(i)),Promise.reject(i)}).catch(i=>{const r=Object(s.h)(e.getState(),t)?Object(s.h)(e.getState(),t).Id:null;return p.c.error("Offline.XrmOfflineValidators.getNavigationPropertiesForEntity: Navigation properties for entity "+r+" could not be retrieved with error "+Object(n.e)(i)),Promise.reject(i)})}(e,a).then(n=>{if(!n)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Navigation property is undefined for entity "+i+" in "+d),new r.a(Object(o.a)(-7021,[e]),-7021);return t.get_expandTerms().forEach(t=>{if(!n.has(t.get_navigationProperty()))throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Navigation property "+t.get_navigationProperty()+" is invalid for entity "+i+" in "+d),new r.a(Object(o.a)(-7022,[t.get_navigationProperty(),e]),-7022);g.set(t.get_navigationProperty(),n.get(t.get_navigationProperty()))}),Promise.resolve(g)}).catch(t=>{throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Entity Metadata could not be retrieved for "+i+" in "+d+" with error "+Object(n.e)(t)),new r.a(Object(o.a)(-7017,[e]),-7017)})}}break;case _.c.TopQueryOption:if(L(d,t,u)){c=!1;let t=0;try{t=i.get_top()}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+d),new r.a(Object(o.a)(-7020,[d]),-7020)}if(t<=0)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Value must be a non-negative number "+d),new r.a(Object(o.a)(-7023),-7023)}break;case _.c.OrderByQueryOption:if(L(d,t,u)){c=!1;const t=[];let n=null;try{n=i.get_orderBy()}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+d),new r.a(Object(o.a)(-7020,[d]),-7020)}if(!n||0===n.get_orderByTermTokens().length)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+d),new r.a(Object(o.a)(-7019,[d]),-7019);n.get_orderByTermTokens().forEach(e=>{t.push(e.get_attributeName())}),t&&t.length>0&&T(e,t,a)}break;case _.c.FilterQueryOption:if(L(d,t,u)){c=!1;let t=null;try{t=i.get_filter()}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid value "+d),new r.a(Object(o.a)(-7020,[d]),-7020)}if(!t||!t.get_filterExpression())throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Value cannot be null "+d),new r.a(Object(o.a)(-7019,[d]),-7019);!function t(e,i,n){if(i){const a=[];if(i.get_conditions()){i.get_conditions().forEach(t=>{a.push(t.get_attributeName())});const t=q(a,e,n.getState());i.get_conditions().forEach(e=>{try{const i=t[e.get_attributeName()];!function(t,e,i){switch(e){case"unknown":case"entityimage":case"managedproperty":case"partylist":throw new Error(String.format("Attribute "+t+" is not supported in filter query option."));case"boolean":case"customer":case"entityname":case"lookup":case"memo":case"owner":case"picklist":case"state":case"status":case"string":case"uniqueidentifier":if(i!==_.a.Equal&&i!==_.a.NotEqual)throw new Error(String.format("Operator "+i+" is not supported with attribute "+t+" in filter query option."))}}(e.get_attributeName(),i,e.get_operator())}catch(i){throw new r.a(Object(o.a)(-7027,["Attribute(Name = "+e.get_attributeName()+", type = "+t[e.get_attributeName()]+", Condition = "+e.get_operator()+")"]),-7027)}})}i.get_filterExpressions()&&i.get_filterExpressions().length>0&&i.get_filterExpressions().forEach(i=>{t(e,i,n)})}}(e,t.get_filterExpression(),a)}break;case _.c.FetchXmlQueryOption:if(!c)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: No other query options are supported "+d),new r.a(Object(o.a)(-7026),-7026);if(L(d,t,u)){u=!0;const t=i.get_fetchXml();try{const e=(new DOMParser).parseFromString(t,"text/xml");if(!e)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+d),new r.a(Object(o.a)(-7025),-7025);{const t=e.getElementsByTagName("fetch");if(!t[0])throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+d),new r.a(Object(o.a)(-7025),-7025)}}catch(t){throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid FetchXML "+d),new r.a(Object(o.a)(-7025),-7025)}}break;default:if(L(d,t,u)){const t=i.get_queryParameters()[d];switch(c=!1,d){case _.c.SkipTokenQueryOption:if(!t||isNaN(parseInt(t.toString(),10))||parseInt(t.toString(),10)<=0)throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid Retrieve option "+d),new r.a(Object(o.a)(-7028,[d]),-7028);break;case _.c.GetOnlyRelatedEntity:if(!t||!Object(y.a)(t.toString()))throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid Retrieve option "+d),new r.a(Object(o.a)(-7028,[d]),-7028);break;default:throw p.c.error("Offline.XrmOfflineValidators.optionsValidator: Invalid option "+d),new r.a(Object(o.a)(-7027),-7027)}}}}),l||Promise.resolve(g)}catch(t){return Promise.reject(t)}}function L(t,e,i){let n=!1;switch(t){case _.c.SelectQueryOption:case _.c.ExpandQueryOption:case _.c.GetOnlyRelatedEntity:n=!0;break;case _.c.TopQueryOption:case _.c.OrderByQueryOption:case _.c.FilterQueryOption:case _.c.FetchXmlQueryOption:case _.c.SkipTokenQueryOption:n=5===e}if(!n)throw p.c.error("Offline.XrmOfflineValidators.isOptionValid: Retrieve query option not supported:"+t),new r.a(Object(o.a)(-7028,[t]),-7028);if(i)throw n=!1,p.c.error("Offline.XrmOfflineValidators.isOptionValid: No query options with fetch XML:"+t),new r.a(Object(o.a)(-7026),-7026);return n}function T(t,e,i){const r=i.getState(),n=Object(a.d)(r,t);if(!n)throw p.c.error("Offline.XrmOfflineValidators.areAttributesSupported: No attribute metadata is available in the state tree."),new Error("Attribute Metadata not found while validation attributes in query options.");e&&e.length>0&&e.forEach(e=>{const i=B(r,t,e);if(!n[i])throw new Error("Invalid Attribute name.");if(!function(t){switch(t){case"unknown":case"decimal":case"double":case"integer":case"memo":case"money":case"string":case"uniqueidentifier":case"bigint":case"owner":case"customer":case"lookup":case"datetime":case"picklist":case"state":case"status":case"boolean":case"entityname":return!0;default:return!1}}(n[i].Type)||n[i].AttributeOf)throw new Error(String.format("Attribute type "+n[i].Type+" for attribute "+n[i].LogicalName+" not supported in offline."))})}function q(t,e,i){const r=t.map(t=>B(i,e,t));return Object(a.c)(r,e,i)}function B(t,e,i){const r=I(i),n=V(i);return r&&2===r.length&&Object(a.a)(t,e,r[1])?r[1]:n&&2===n.length&&Object(a.a)(t,e,n[1])?n[1]:i}function V(t){return t.match(/^(.*)@odata.bind$/)}function I(t){return t.match(/^_(.*)_value$/)}},ROKC:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var r=i("TBkx"),n=i("Nzmy"),a=i("d+dp"),s=i("5qiD"),o=i("/oKV");function l(t,e){return{type:"offline.retrieve.multiple.records",execute:({dispatch:i,getState:l},c)=>c.DataSource.retrieveMultiple(t,new a.a(s.a.NotCached,o.a.Local),e).nativePromise().then(t=>(n.c.info("Able to successfully retrieve multiple record from offline db"),Promise.resolve(t))).catch(t=>(n.c.error("Unable to Retrieve multiple record in offline db "+Object(r.e)(t)),Promise.reject(t)))}}},a8zb:function(t,e,i){"use strict";i.d(e,"a",(function(){return Ut})),i.d(e,"b",(function(){return Wt})),i.d(e,"c",(function(){return Jt}));var r=i("SoYb"),n=i("Uv1Y"),a=i("TBkx"),s=i("LbMF"),o=i("iZ7K"),l=i("0oMj"),c=i("SAYH"),u=i("Nzmy"),g=i("+5Bq"),d=i("wHbR"),h=i("vNXc"),b=i("FZDd"),f=i("ROKC"),p=i("d+dp"),y=i("5qiD"),_=i("/oKV");var m=i("84PK"),O=i("umme"),w=i("504W");class j{constructor(t,e,i){this._name=null,this._entity=null,this._name=t,this._entity=i}get_entity(){return this._entity}get_name(){return this._name}}var S=i("I1N9"),C=i("YIt1");class E{constructor(t,e,i,r){this._name=null,this._descending=!1,this._entity=null,this._name=t,this._descending=i,this._entity=r}get_entity(){return this._entity}get_descending(){return this._descending}get_name(){return this._name}}var v=i("eruq");class A{constructor(t,e,i){this.joinType=0,this.fetchXmlDoc=null,this.entityName=null,this.attributesByName=null,this.attributes=null,this.orderByAttributes=null,this.groupByAttributes=null,this.aggregateAttributes=null,this.linkedEntities=null,this.parentEntity=null,this.baseEntity=null,this.filterExpression=null,this.hasAggregate=!1,this.tableAlias=null,this.tableAliasCount=0,this.tableAliases=null,this.useLimitStatement=!0,this.top=A._defaultTopValue,this.offset=A._defaultOffsetValue,this.entityName=t,this.tableAliasCount=0,this.tableAliases=[],this.tableAlias=this.generateTableAlias(this.entityName),this.attributes=new Array(0),this.attributesByName={},this.orderByAttributes=new Array(0),this.groupByAttributes=new Array(0),this.aggregateAttributes=new Array(0),this.linkedEntities=new Array(0),this.alias=null,this.parentEntity=e,e?(this.baseEntity=e.baseEntity,this.joinType=Object(w.a)(i)?A.innerJoin:i):this.baseEntity=this}get_top(){return this.top}set_top(t){return this.top=t,t}get_offset(){return this.offset}set_offset(t){return this.offset=t,t}get_linkedEntities(){return this.linkedEntities}get_joinType(){return this.joinType}get_orderByAttributes(){return this.orderByAttributes}get_attributesByName(){return this.attributesByName}get_attributes(){return this.attributes}get_entityName(){return this.entityName}get_Alias(){return this.alias}get_fetchXml(){return Object(w.a)(this.fetchXmlDoc)?"":Object(v.a)(this.fetchXmlDoc.firstChild).get_outerXml()}get_parentEntity(){return this.parentEntity}get_baseEntity(){return this.baseEntity}get_filterExpression(){return this.filterExpression}set_filterExpression(t){return this.filterExpression=t,t}get_tableAlias(){return this.tableAlias}get_useLimitStatement(){return this.useLimitStatement}set_useLimitStatement(t){return this.useLimitStatement=t,t}generateTableAlias(t){if(!Object(w.b)(t)){const e=String.format("{0}{1}",t,this.tableAliasCount++);return this.tableAliases.push(e),e}return""}initialize(t){this.fetchXmlDoc=Object(v.b)(t.get_outerXml()),this.hasAggregate="true"===this.getAttributeValue(t,"aggregate");const e=this.getAttributeValue(t,"count");e&&(this.top=Number.parseInvariant(e));const i=this.getAttributeValue(t,"page");i&&(this.offset=Number.parseInvariant(i));let r=t.selectSingleNode("entity");if(Object(w.a)(r)&&"link-entity"===t.get_tagName()&&(r=t),Object(w.a)(this.parentEntity)){const t=this.getAttributeValue(r,"name");this.tableAliasCount=0,this.tableAliases=[],this.tableAlias=this.generateTableAlias(t),this.baseEntity=this}this._parser(r)}initializeFromFetchXml(t){const e=Object(v.b)(t);this.initialize(Object(v.a)(e).selectSingleNode("fetch"))}removeAttributesAndOrder(t){const e=new Array(0);for(let i=0,r=t.childNodes.length;i<r;i++){const r=t.childNodes[i];switch(r.nodeName){case"attribute":case"order":e[e.length]=r;break;case"link-entity":this.removeAttributesAndOrder(r)}}for(let i=0;i<e.length;i++)t.removeChild(e[i])}addAttribute(t,e){const i=new j(t,null,this);this.get_attributesByName()[t]=i,this.get_attributes()[this.get_attributes().length]=i}addOrderByAttribute(t,e){const i=new E(t,this.tableAlias,e,this);this.orderByAttributes[this.orderByAttributes.length]=i}_parser(t){this.entityName=this.getAttributeValue(t,"name");const e=t.childNodes();for(let t=0;t<e.get_count();t++){const i=e.get_item(t);if(Object(w.a)(i.get_tagName()))continue;switch(i.get_tagName().toLocaleLowerCase()){case"attribute":const t=this.getAttributeValue(i,"name"),e=this.getAttributeValue(i,"alias"),r=new j(t,e,this);this.attributesByName[e||t]=r,this.attributes[this.attributes.length]=r;this.getAttributeValue(i,"aggregate")&&(this.aggregateAttributes[this.aggregateAttributes.length]=r);const n=this.getAttributeValue(i,"groupby");n&&"true"===n&&(this.groupByAttributes[this.groupByAttributes.length]=r);break;case"order":const a=this.getAttributeValue(i,"alias"),s=this.getAttributeValue(i,"attribute"),o=this.getAttributeValue(i,"descending"),l=new E(s,a,!!o&&"true"===o,this);this.orderByAttributes[this.orderByAttributes.length]=l;break;case"link-entity":const c=this.getAttributeValue(i,"name"),u=this.getAttributeValue(i,"from"),g=this.getAttributeValue(i,"to"),d=this.getAttributeValue(i,"alias"),h=new N(c,this);h.setLinkProperties(u,g,"eq",this.getLinkType(i),d),h.initialize(i),this.linkedEntities[this.linkedEntities.length]=h;break;case"filter":const b=this.getAttributeValue(i,"type");let f=0;b&&"or"===b.toLowerCase()&&(f=C.a.Or),this.filterExpression=new S.a(f,this.get_entityName()),this.filterExpression=this.filterParser(i,this.filterExpression)}}}filterParser(t,e){const i=t.childNodes();for(let t=0;t<i.get_count();t++){const r=i.get_item(t);if(Object(w.a)(r.get_tagName()))continue;switch(r.get_tagName().toLocaleLowerCase()){case"filter":const i=this.getAttributeValue(r,"type");let n=0;i&&"or"===i.toLowerCase()&&(n=C.a.Or);let a=new S.a(n,"tempValue");a=this.filterParser(r,a),e.addFilterExpression(a);break;case"condition":const s=this.getAttributeValue(r,"attribute"),o=this.getAttributeValue(r,"operator"),l=this.getAttributeValue(r,"value"),c=this.getAttributeValue(r,"uitype");if(t||e.set_filterExpressionId(s),Object(w.b)(l)){const t=r.childNodes();if(t.get_count()>0){const i=[];for(let e=0;e<t.get_count();e++){const r=t.get_item(e);Object(w.a)(r.get_innerText())||i.push(t.get_item(e).get_innerText())}e.addCondition(s,o,i)}else e.addCondition(s,o);if(e.get_conditions().length>0){e.get_conditions()[e.get_conditions().length-1].set_entityName(c)}}else e.addCondition(s,o,l)}}return e}getAttributeValue(t,e){return t.getAttribute(e)}getLinkType(t){const e=this.getAttributeValue(t,"link-type");if(!e)return A.innerJoin;switch(e){case"natural":return A._naturalJoin;case"inner":return A.innerJoin;case"outer":return A._leftOuterJoin;case"matchfirstrowusingcrossapply":return A._matchFirstRowUsingCrossApply;case"exists":return A._exists;case"in":return A._inSubquery;default:throw Error.create("EntityQueryExpression.GetLinkType: Invalid join type!")}}}A.innerJoin=0,A._leftOuterJoin=1,A._naturalJoin=2,A._matchFirstRowUsingCrossApply=3,A._inSubquery=4,A._exists=5,A._defaultTopValue=5e3,A._defaultOffsetValue=1;class N extends A{constructor(t,e,i){super(),this._linkToAttribute=null,this._linkFromAttribute=null,this._conditionOperator=null,this.entityName=t,this.attributes=new Array(0),this.attributesByName={},this.orderByAttributes=new Array(0),this.groupByAttributes=new Array(0),this.aggregateAttributes=new Array(0),this.linkedEntities=new Array(0),this.parentEntity=e,e&&(this.baseEntity=e.get_baseEntity(),this.tableAlias=this.baseEntity.generateTableAlias(this.entityName),this.joinType=Object(w.a)(i)?A.innerJoin:i)}get_linkToAttribute(){return this._linkToAttribute}get_linkFromAttribute(){return this._linkFromAttribute}get_conditionOperator(){return this._conditionOperator}setLinkProperties(t,e,i,r,n){this._linkFromAttribute=t,this._linkToAttribute=e,this._conditionOperator=i,this.joinType=r,this.alias=n}}var x=i("WRF3"),k=i("YhOF"),F=i("67s4"),Q=i("XvL5"),L=i("/bjP"),T=i("8tWD");var q,B=i("2mBq");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */!function(t){t[t.inner=0]="inner",t[t.leftOuter=1]="leftOuter",t[t.outer=2]="outer"}(q||(q={}));var V=i("jZCH");function I(t){switch(t.toLowerCase()){case"eq":case"eq-userid":return"=";case"ne":case"ne-userid":return"!=";case"gt":return">";case"ge":return">=";case"lt":return"<";case"le":return"<=";case"like":case"begins-with":case"ends-with":return"like";case"not-like":case"not-begin-with":case"not-end-with":return"not like";case"eq-userteams":case"eq-useroruserteams":case"in":return"in";case"not-in":return"not in";case"between":return"between";case"not-between":return"not between";case"not-null":return"is not null";case"null":return"is null";default:throw Error.create("Invalid condition operator type!")}}function P(t){switch(t){case 0:return"and";case C.a.Or:return"or";default:throw Error.create("Invalid logical operator type!")}}function M(t,e){const i=V.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(e,t);if(!Object(w.a)(i))return i;throw Error.create(Object(B.a)("Attribute {0} is not present in the metadata for entity {1}",t,e))}class D extends class{}{constructor(t){super(),this._strategy=null,this._tableAlias="",this._entityName="",this._strategy=t}_visitAttributeExpression(t){this._strategy.addAttribute(t,this._tableAlias)}_visitColumnSetExpression(t){for(const e of t)this._visitAttributeExpression(e)}_visitConditionExpression(t){!function(t){switch(t){case"ne":case"not-in":case"not-like":case"not-begin-with":case"not-end-with":return!0;default:return!1}}(t.get_operator())?this._strategy.addCondition(t.get_attributeName(),t.get_operator(),t.get_value(),this._entityName,this._tableAlias):(this._strategy.beginWritingFilter(C.a.Or),this._strategy.addCondition(t.get_attributeName(),t.get_operator(),t.get_value(),this._entityName,this._tableAlias),this._strategy.addCondition(t.get_attributeName(),"null",null,this._entityName,this._tableAlias),this._strategy.endWritingFilter())}_visitFilterExpression(t){if(!Object(w.a)(t)){if(this._strategy.beginWritingFilter(t.get_filterOperator()),!Object(w.a)(t.get_conditions()))for(const e of t.get_conditions())this._visitConditionExpression(e);if(!Object(w.a)(t.get_filterExpressions()))for(const e of t.get_filterExpressions())this._visitFilterExpression(e);this._strategy.endWritingFilter()}}_visitLinkEntityExpression(t){const e=this._entityName;this._tableAlias=t.get_tableAlias(),this._entityName=t.get_entityName(),this._strategy.beginWritingLinkEntity(t),this._visitColumnSetExpression(t.get_attributes()),this._visitFilterExpression(t.get_filterExpression()),this._strategy.addLinkEntityFromClause(t);for(const e of t.get_orderByAttributes())this._visitOrderByQueryExpression(e);this._strategy.endWritingLinkEntity(t);for(const e of t.get_linkedEntities())this._visitLinkEntityExpression(e);this._entityName=e}_visitOrderByQueryExpression(t){this._strategy.addOrderByClause(t,this._tableAlias)}visitEntityExpression(t){this._tableAlias=t.get_tableAlias(),this._entityName=t.get_entityName(),this._strategy.addLimitClause(t),this._strategy.addOffsetClause(t),this._visitColumnSetExpression(t.get_attributes());for(const e of t.get_orderByAttributes())this._visitOrderByQueryExpression(e);this._strategy.addFromClause(t),this._visitFilterExpression(t.get_filterExpression());for(const e of t.get_linkedEntities())this._visitLinkEntityExpression(e)}}class X extends class{constructor(){this._EntityQueryExpression=null,this._Visitor=null,this._Strategy=null}get_entityQueryExpression(){return this._EntityQueryExpression}set_entityQueryExpression(t){return this._EntityQueryExpression=t,t}get_visitor(){return this._Visitor}set_visitor(t){return this._Visitor=t,t}get_strategy(){return this._Strategy}set_strategy(t){return this._Strategy=t,t}}{constructor(t,e){super(),this.set_strategy(t),this.set_visitor(new D(t)),this.set_entityQueryExpression(e)}getSql(){return this.get_visitor().visitEntityExpression(this.get_entityQueryExpression()),this.get_strategy().generateQueryText()}}var R=i("Ydwo");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class U{constructor(){this.dateTimeBehavior=0}validateAttribute(t,e){const i=M(t,e);if("datetime"!==i.get_type())throw Error.create("Attribute Type is not DateTime though the given condition operator is of DateTime type.");this.dateTimeBehavior=i.get_behavior()}getQueryForCondition(t,e,i,r){return this.validateAttribute(t,i),this.generateSQLiteQueryString(t,e,i,r)}}var z=i("olF5"),G=i("3c60");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
class W extends U{constructor(){super(),this.xValue=0,this.endUTCDate=null,this.currUTCDateMidnight=null}setXValue(t){Object(z.b)(t,"Last X input Value"),this.xValue=Number.parseLocale(t),Object(z.a)(this.xValue,"Last X input Value cannot be negative")}setEndDate(){let t=Object(G.f)();this.endUTCDate=Object(G.a)(t,this.dateTimeBehavior),t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),this.currUTCDateMidnight=Object(G.a)(t,this.dateTimeBehavior)}}var J=i("MXaZ");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Y extends W{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setEndDate();const n=Object(J.c)(this.currUTCDateMidnight,-1*this.xValue);return Object(G.d)(e,t,n,this.endUTCDate)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class $ extends U{generateSQLiteQueryString(t,e,i,r){return(new Y).getQueryForCondition(t,e,i,"7")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class H extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)();let a=new Date(n.getFullYear(),n.getMonth(),1),s=Object(J.d)(a,-1);return s=Object(G.a)(s,this.dateTimeBehavior),a=Object(G.a)(a,this.dateTimeBehavior),Object(G.c)(e,t,s,a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class K extends U{generateSQLiteQueryString(t,e,i,r){let n=Object(G.g)(),a=Object(J.e)(n,-1);return a=Object(G.a)(a,this.dateTimeBehavior),n=Object(G.a)(n,this.dateTimeBehavior),Object(G.c)(e,t,a,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Z extends W{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setEndDate();const n=Object(J.d)(this.currUTCDateMidnight,-1*this.xValue);return Object(G.d)(e,t,n,this.endUTCDate)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class tt extends W{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setEndDate();const n=Object(J.e)(this.currUTCDateMidnight,-1*this.xValue);return Object(G.d)(e,t,n,this.endUTCDate)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class et extends W{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setEndDate();const n=Object(J.f)(this.currUTCDateMidnight,-1*this.xValue);return Object(G.d)(e,t,n,this.endUTCDate)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class it extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)();let a=new Date(n.getFullYear(),0,1),s=Object(J.f)(a,-1);return s=Object(G.a)(s,this.dateTimeBehavior),a=Object(G.a)(a,this.dateTimeBehavior),Object(G.c)(e,t,s,a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class rt extends U{constructor(){super(),this.xValue=0,this.startUTCDate=null,this.currUTCDateMidnight=null}setXValue(t){Object(z.b)(t,"Next X input Value"),this.xValue=Number.parseLocale(t),Object(z.a)(this.xValue,"Next X input Value cannot be negative")}setStartDate(){let t=Object(G.f)();this.startUTCDate=Object(G.a)(t,this.dateTimeBehavior),(t.getHours()||t.getMinutes()||t.getSeconds()||t.getMilliseconds())&&(t=Object(J.c)(t,1)),t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),this.currUTCDateMidnight=Object(G.a)(t,this.dateTimeBehavior)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class nt extends rt{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setStartDate();const n=Object(J.c)(this.currUTCDateMidnight,this.xValue);return Object(G.c)(e,t,this.startUTCDate,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class at extends U{generateSQLiteQueryString(t,e,i,r){return(new nt).getQueryForCondition(t,e,i,"7")}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class st extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)(),a=new Date(n.getFullYear(),n.getMonth(),1);let s=Object(J.d)(a,1),o=Object(J.d)(s,1);return s=Object(G.a)(s,this.dateTimeBehavior),o=Object(G.a)(o,this.dateTimeBehavior),Object(G.c)(e,t,s,o)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ot extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.g)();let a=Object(J.e)(n,1),s=Object(J.e)(a,1);return a=Object(G.a)(a,this.dateTimeBehavior),s=Object(G.a)(s,this.dateTimeBehavior),Object(G.c)(e,t,a,s)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class lt extends rt{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setStartDate();const n=Object(J.d)(this.currUTCDateMidnight,this.xValue);return Object(G.c)(e,t,this.startUTCDate,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ct extends rt{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setStartDate();const n=Object(J.e)(this.currUTCDateMidnight,this.xValue);return Object(G.c)(e,t,this.startUTCDate,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ut extends rt{generateSQLiteQueryString(t,e,i,r){this.setXValue(r),this.setStartDate();const n=Object(J.f)(this.currUTCDateMidnight,this.xValue);return Object(G.c)(e,t,this.startUTCDate,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class gt extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)(),a=new Date(n.getFullYear(),0,1);let s=Object(J.f)(a,1),o=Object(J.f)(s,1);return s=Object(G.a)(s,this.dateTimeBehavior),o=Object(G.a)(o,this.dateTimeBehavior),Object(G.c)(e,t,s,o)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class dt extends U{generateSQLiteQueryString(t,e,i,r){let n=Object(G.b)(r);n=Object(G.e)(n);let a=Object(J.c)(n,1);return n=Object(G.a)(n,this.dateTimeBehavior),a=Object(G.a)(a,this.dateTimeBehavior),Object(G.c)(e,t,n,a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ht extends U{generateSQLiteQueryString(t,e,i,r){let n=Object(G.b)(r);n=Object(G.e)(n);const a=Object(G.a)(n,this.dateTimeBehavior);return this._CreateQuery(e,t,a)}_CreateQuery(t,e,i){const r=Object(B.a)("rtrim([{0}].[{1}])",t,e),n=Object(J.r)(i);return Object(B.a)(" {0} >= {1} ",r,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class bt extends U{generateSQLiteQueryString(t,e,i,r){let n=Object(G.b)(r);n=Object(G.e)(n),n=Object(J.c)(n,1);const a=Object(G.a)(n,this.dateTimeBehavior);return this._CreateQuery(e,t,a)}_CreateQuery(t,e,i){const r=Object(B.a)("rtrim([{0}].[{1}])",t,e),n=Object(J.r)(i);return Object(B.a)(" {0} < {1} ",r,n)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class ft extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)();let a=new Date(n.getFullYear(),n.getMonth(),1),s=Object(J.d)(a,1);return a=Object(G.a)(a,this.dateTimeBehavior),s=Object(G.a)(s,this.dateTimeBehavior),Object(G.c)(e,t,a,s)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class pt extends U{generateSQLiteQueryString(t,e,i,r){let n=Object(G.g)(),a=Object(J.e)(n,1);return n=Object(G.a)(n,this.dateTimeBehavior),a=Object(G.a)(a,this.dateTimeBehavior),Object(G.c)(e,t,n,a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class yt extends U{generateSQLiteQueryString(t,e,i,r){const n=Object(G.f)();let a=new Date(n.getFullYear(),0,1),s=Object(J.f)(a,1);return a=Object(G.a)(a,this.dateTimeBehavior),s=Object(G.a)(s,this.dateTimeBehavior),Object(G.c)(e,t,a,s)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class _t extends U{generateSQLiteQuery(t,e,i,r){const n=Object(G.f)(),a=Object(J.c)(n,r);return(new dt).getQueryForCondition(t,e,i,a)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class mt extends _t{generateSQLiteQueryString(t,e,i,r){return this.generateSQLiteQuery(t,e,i,0)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ot extends _t{generateSQLiteQueryString(t,e,i,r){return this.generateSQLiteQuery(t,e,i,1)}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class wt extends _t{generateSQLiteQueryString(t,e,i,r){return this.generateSQLiteQuery(t,e,i,-1)}}class jt{constructor(){this._LimitClause=null,this._OffsetClause=null,this._SelectClause=null,this._FromClause=null,this._JoinClauses=null,this._WhereClause=null,this._OrderByClause=null,this._DistinctClause=null,this._MUIAttributes=null,this._set_limitClause(new Sys.StringBuilder),this._set_offsetClause(new Sys.StringBuilder),this._set_selectClause(new Sys.StringBuilder),this.set_fromClause(null),this._set_joinClauses([]),this._set_whereClause(new Sys.StringBuilder),this._set_orderByClause(new Sys.StringBuilder),this._set_distinctClause(new Sys.StringBuilder),this._set_muiAttributes({})}get_limitClause(){return this._LimitClause}_set_limitClause(t){return this._LimitClause=t,t}get_offsetClause(){return this._OffsetClause}_set_offsetClause(t){return this._OffsetClause=t,t}get_selectClause(){return this._SelectClause}_set_selectClause(t){return this._SelectClause=t,t}get_fromClause(){return this._FromClause}set_fromClause(t){return this._FromClause=t,t}get_joinClauses(){return this._JoinClauses}_set_joinClauses(t){return this._JoinClauses=t,t}get_whereClause(){return this._WhereClause}_set_whereClause(t){return this._WhereClause=t,t}get_orderByClause(){return this._OrderByClause}_set_orderByClause(t){return this._OrderByClause=t,t}get_distinctClause(){return this._DistinctClause}_set_distinctClause(t){return this._DistinctClause=t,t}get_muiAttributes(){return this._MUIAttributes}_set_muiAttributes(t){return this._MUIAttributes=t,t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class St{constructor(t,e,i){this._FromClauseFormat=null,this._Entity=null,this._set_fromClauseFormat(e),this._set_entity(i)}get_fromClauseFormat(){return this._FromClauseFormat}_set_fromClauseFormat(t){return this._FromClauseFormat=t,t}get_entity(){return this._Entity}_set_entity(t){return this._Entity=t,t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Ct{constructor(t){this._sqlClause=null,this._logicalOperator=null,this._conditionCount=0,this._logicalOperator=t,this._sqlClause=new Sys.StringBuilder,this._conditionCount=0}appendCondition(t){Object(w.b)(t)||(this._conditionCount>0&&this._sqlClause.append(Object(B.a)(" {0} ",this._logicalOperator)),this._sqlClause.append(t),this._conditionCount++)}getSql(){return this._sqlClause.toString().length>0?"("+this._sqlClause.toString()+")":""}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class Et{constructor(){this._ConditionBuilders=null,this.set_conditionBuilders([])}BeginWritingFilter(t){this.get_conditionBuilders().push(this.createConditionBuilder(t))}EndWritingFilter(){const t=this.get_conditionBuilders()[this.get_conditionBuilders().length-1];if(this.get_conditionBuilders().splice(this.get_conditionBuilders().length-1,1),this.get_conditionBuilders().length>0)this.get_conditionBuilders()[this.get_conditionBuilders().length-1].appendCondition(t.getSql());else{const e=t.getSql();this.get_WhereClause().toString().length>0&&e.length>0&&this.get_WhereClause().append(Object(B.a)(" {0} ",P(0))),this.get_WhereClause().append(e)}}createConditionBuilder(t){return new Ct(P(t))}AppendCondition(t){this.get_conditionBuilders()[this.get_conditionBuilders().length-1].appendCondition(t)}GetSql(){return this.get_WhereClause().toString()}get_conditionBuilders(){return this._ConditionBuilders}set_conditionBuilders(t){return this._ConditionBuilders=t,t}}
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */class vt extends Et{constructor(){super(),this._whereClause=new Sys.StringBuilder}get_WhereClause(){return this._whereClause}GetSql(){if(0!==this.get_conditionBuilders().length)throw Error.create("The ConditionBuilders stack is not empty - the generation of the LinkEntityPredicate is not complete, which means the SQL cannot be generated for it yet");return super.GetSql()}Reset(){this._whereClause.clear(),this.set_conditionBuilders([])}}class At{constructor(t,e,i){this._JoinCount=0,this._AttributeMetadata=null,this.set_attributeMetadata(t),this.set_joinCount(i)}get_joinCount(){return this._JoinCount}set_joinCount(t){return this._JoinCount=t,t}get_attributeMetadata(){return this._AttributeMetadata}set_attributeMetadata(t){return this._AttributeMetadata=t,t}}class Nt extends Et{constructor(t){super(),this._set_queryContainer(t)}get_WhereClause(){return this.get_queryContainer().get_whereClause()}get_queryContainer(){return this._QueryContainer}_set_queryContainer(t){return this._QueryContainer=t,t}}var xt=i("MUIu");var kt=i("LFDu"),Ft=i("bRS5"),Qt=i("03Hu");var Lt=i("lR0U"),Tt=i("b2mI");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const qt={uniqueidentifier:["null","not-null","in","not-in","eq","ne","gt","ge","lt","le","eq-userid","ne-userid"],boolean:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],string:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with"],picklist:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],state:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],status:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],entityname:["null","not-null","eq","ne","like","not-like","begins-with","not-begin-with","ends-with","not-end-with","in","not-in"],customer:["null","not-null","eq","ne","in","not-in"],lookup:["null","not-null","in","not-in","eq","ne","eq-userid","ne-userid"],owner:["null","not-null","in","not-in","eq","ne","eq-userid","ne-userid","eq-userteams","eq-useroruserteams"],integer:["eq","ne","null","not-null","gt","ge","lt","le"],bigint:["eq","ne","null","not-null","gt","ge","lt","le"],double:["eq","ne","null","not-null","gt","ge","lt","le"],decimal:["eq","ne","null","not-null","gt","ge","lt","le"],money:["eq","ne","null","not-null","gt","ge","lt","le"],datetime:["on-or-after","on","on-or-before","today","tomorrow","yesterday","next-seven-days","last-seven-days","next-week","last-week","this-week","next-month","last-month","this-month","next-year","last-year","this-year","last-x-days","next-x-days","last-x-weeks","next-x-weeks","last-x-months","next-x-months","last-x-years","next-x-years","not-null","null","not-null","eq","ne","gt","ge","lt","le"]};class Bt extends class{constructor(){this.queryContainer=null,this._predicateBuilders=null,this.localizedLabelJoinCounter=-1,this.queryContainer=new jt,this._predicateBuilders=[],this._predicateBuilders.push(new Nt(this.queryContainer))}get_muiAttributes(){return this.queryContainer.get_muiAttributes()}get_languageId(){return V.a.get_DefaultInstance().get_UserContext().get_UserSettings().get_languageId()}get_baseLanguageId(){return V.a.get_DefaultInstance().get_UserContext().get_organizationSettings().get_languageCode()}get_needTwoJoinsToLocalizedLabelTable(){return this.get_languageId()!==this.get_baseLanguageId()}_get_CurrentPredicateBuilder(){return this._predicateBuilders[this._predicateBuilders.length-1]}addAttribute(t,e){this.throwIfNullOrUndefined(t.get_entity(),"AttributeQueryExpression has no parent EntityQueryExpression");const i=V.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(t.get_entity().get_entityName(),t.get_name());this.throwIfNullOrUndefined(i,Object(B.a)("attributeMetadata: {0}.{1}",t.get_entity().get_entityName(),t.get_name())),this.throwIfAttributeUnsupported(i);const r=t.get_entity().get_entityName(),n=V.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r);this.throwIfNullOrUndefined(n,Object(B.a)("entityMetadata: ",r)),this._HasMultipleLabels(i,n)?this.queryContainer.get_selectClause().append(this._GetLocalizedAttributeName(e,i,n)):this.queryContainer.get_selectClause().append(Object(B.a)("{0} [{1}].[{2}] as [{3}]",Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",",e,this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName()),this._GetResultColumnName(t))),this.addChildAttributes(t.get_name(),t.get_entity().get_entityName(),e)}_GetResultColumnName(t){let e=this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName());return Object(w.b)(t.get_entity().get_Alias())||(e=t.get_entity().get_Alias()+"."+e),e}addFromClause(t){const e=new Sys.StringBuilder;e.append(Object(B.a)("[{{0}}] as [{1}]",t.get_entityName(),t.get_tableAlias())),e.append(this.localizedOuterJoinClause(t).toString()),this.queryContainer.set_fromClause(new St(t.get_tableAlias(),e.toString(),t.get_entityName()))}addLinkEntityFromClause(t){const e=t.get_parentEntity().get_tableAlias(),i=new Sys.StringBuilder,r=this._GetLinkAttribute(t,t.get_linkToAttribute(),t.get_parentEntity().get_entityName()),n=this._GetLinkAttribute(t,t.get_linkFromAttribute(),t.get_entityName()),a=this.getAttributePhysicalName(r,t.get_parentEntity().get_entityName()),s=this.getAttributePhysicalName(n,t.get_entityName()),o=Object(B.a)(" [{1}].[{0}] ",a,e);if(i.append(Object(B.a)(" {0} ",function(t){switch(t){case 0:return"inner join";case q.leftOuter:return"left outer join";default:throw Error.create("Invalid join operator type!")}}(t.get_joinType()))),i.append(Object(B.a)("[{0}] as [{1}]",t.get_entityName(),t.get_tableAlias())),i.append(Object(B.a)(" on ({0} {1} [{2}].[{3}]",o,I(t.get_conditionOperator()),t.get_tableAlias(),s)),this._get_CurrentPredicateBuilder()instanceof vt){const t=this._get_CurrentPredicateBuilder();if(null!==t){const e=t.GetSql();e.length>0&&i.append(Object(B.a)(" and {0}",e)),t.Reset(),i.append(")")}}i.append(this.localizedOuterJoinClause(t).toString()),this.queryContainer.get_joinClauses().push(new St(t.get_tableAlias(),i.toString(),t.get_entityName()))}_GetLinkAttribute(t,e,i){let r=e;if((Object(w.a)(r)||Object(w.b)(r))&&!Object(w.a)(i)){const t=V.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(i);Object(w.a)(t)||(r=t.get_primaryIdAttribute())}return r}addCondition(t,e,i,r,n){let a;const s=new Sys.StringBuilder,o=this.getAttributePhysicalName(t,r);let l="";if(this.throwIfOperationOnAttributeNotSupported(t,r,e),!Object(w.a)(i)||this._IsConditionWithNoValue(e))switch(e){case"in":case"not-in":const c=new Sys.StringBuilder;a=i;for(let e=0;e<a.length;e++)c.toString().length>0&&c.append(", "),c.append(Object(B.a)("'{0}'",this._GetOperandValue(t,r,a[e])));l=Object(B.a)("({0})",c.toString()),s.append(this.getQueryForCondition(n,t,r,e,l));break;case"between":case"not between":a=i,l=Object(B.a)("'{0}' and '{1}'",this._GetOperandValue(t,r,a[0]),this._GetOperandValue(t,r,a[1])),s.append(this.getQueryForCondition(n,t,r,e,l));break;case"begins-with":case"ends-with":case"not-begin-with":case"not-end-with":"begins-with"===e||"not-begin-with"===e?l=Object(B.a)("'{0}%'",this._GetOperandValue(t,r,i)):"ends-with"!==e&&"not-end-with"!==e||(l=Object(B.a)("'%{0}'",this._GetOperandValue(t,r,i))),s.append(this.getQueryForCondition(n,t,r,e,l));break;case"eq-userid":case"ne-userid":l=Object(B.a)("'{0}'",V.a.get_DefaultInstance().get_UserContext().get_UserId().toString()),s.append(this.getQueryForCondition(n,t,r,e,l));break;case"eq-userteams":case"eq-useroruserteams":l=this._GenerateConditionForOwnerTypeOperator(e,n,o),s.append(this.getQueryForCondition(n,t,r,e,l));break;case"on":const u=new dt;s.append(u.getQueryForCondition(o,n,r,i));break;case"on-or-before":const g=new bt;s.append(g.getQueryForCondition(o,n,r,i));break;case"on-or-after":const d=new ht;s.append(d.getQueryForCondition(o,n,r,i));break;case"today":const h=new mt;s.append(h.getQueryForCondition(o,n,r,i));break;case"yesterday":const b=new wt;s.append(b.getQueryForCondition(o,n,r,i));break;case"tomorrow":const f=new Ot;s.append(f.getQueryForCondition(o,n,r,i));break;case"last-week":const p=new K;s.append(p.getQueryForCondition(o,n,r,i));break;case"this-week":const y=new pt;s.append(y.getQueryForCondition(o,n,r,i));break;case"next-week":const _=new ot;s.append(_.getQueryForCondition(o,n,r,i));break;case"last-month":const m=new H;s.append(m.getQueryForCondition(o,n,r,i));break;case"this-month":const O=new ft;s.append(O.getQueryForCondition(o,n,r,i));break;case"next-month":const w=new st;s.append(w.getQueryForCondition(o,n,r,i));break;case"last-year":const j=new it;s.append(j.getQueryForCondition(o,n,r,i));break;case"this-year":const S=new yt;s.append(S.getQueryForCondition(o,n,r,i));break;case"next-year":const C=new gt;s.append(C.getQueryForCondition(o,n,r,i));break;case"last-seven-days":const E=new $;s.append(E.getQueryForCondition(o,n,r,i));break;case"next-seven-days":const v=new at;s.append(v.getQueryForCondition(o,n,r,i));break;case"last-x-days":const A=new Y;s.append(A.getQueryForCondition(o,n,r,i));break;case"next-x-days":const N=new nt;s.append(N.getQueryForCondition(o,n,r,i));break;case"last-x-weeks":const x=new tt;s.append(x.getQueryForCondition(o,n,r,i));break;case"next-x-weeks":const k=new ct;s.append(k.getQueryForCondition(o,n,r,i));break;case"last-x-months":const F=new Z;s.append(F.getQueryForCondition(o,n,r,i));break;case"next-x-months":const Q=new lt;s.append(Q.getQueryForCondition(o,n,r,i));break;case"last-x-years":const L=new et;s.append(L.getQueryForCondition(o,n,r,i));break;case"next-x-years":const T=new ut;s.append(T.getQueryForCondition(o,n,r,i));break;case"null":s.append(Object(B.a)("[{0}].[{1}] is null ",n,o));break;case"not-null":s.append(Object(B.a)("[{0}].[{1}] is not null ",n,o));break;default:l=Object(B.a)("'{0}'",this._GetOperandValue(t,r,i)),s.append(this.getQueryForCondition(n,t,r,e,l))}this._get_CurrentPredicateBuilder().AppendCondition(s.toString())}throwIfOperationOnAttributeNotSupported(t,e,i){}getQueryForCondition(t,e,i,r,n){const a=new Sys.StringBuilder;return this._AddQueryForConditionAttribute(e,i,t,a),a.append(Object(B.a)(" {0} {1}",I(r),n)),a.toString()}beginWritingFilter(t){this._get_CurrentPredicateBuilder().BeginWritingFilter(t)}endWritingFilter(){this._get_CurrentPredicateBuilder().EndWritingFilter()}beginWritingLinkEntity(t){const e=new vt;this._predicateBuilders.push(e)}endWritingLinkEntity(t){this._predicateBuilders.splice(this._predicateBuilders.length-1,1)}addChildAttributes(t,e,i){}throwIfAttributeUnsupported(t){}throwIfNullOrUndefined(t,e){if(Object(w.a)(t))throw Error.create(Object(B.a)("Argument {0} cannot be null or undefined",e))}addLimitClause(t){if(!Object(w.a)(t.get_top())&&t.get_useLimitStatement()){if(t.get_top()<0)throw Error.create("Limit must be a positive integer");this.queryContainer.get_limitClause().append(Object(B.a)(" LIMIT {0}",t.get_top()))}}addOffsetClause(t){if(!Object(w.a)(t.get_offset())&&t.get_useLimitStatement()){if(t.get_offset()<0)throw Error.create("Offset must be a positive integer");t.get_offset()>0&&this.queryContainer.get_limitClause().append(Object(B.a)(" OFFSET {0}",t.get_offset()))}}addOrderByClause(t,e){if(Object(w.a)(t.get_entity()))throw Error.create("orderByQueryExpression has no parent EntityQueryExpression");this.queryContainer.get_orderByClause().toString().length>0&&(this.queryContainer.get_orderByClause().appendLine(),this.queryContainer.get_orderByClause().append(", "));const i=new Sys.StringBuilder;i.append(Object(B.a)("[{0}].[{1}]",e,this.getAttributePhysicalName(t.get_name(),t.get_entity().get_entityName()))),i.append(Object(B.a)(" {0}",t.get_descending()?"desc":"asc")),this.queryContainer.get_orderByClause().append(i)}generateQueryText(){const t=new Sys.StringBuilder;return this._GenerateSelectQuery(t),t.toString()}getAttributePhysicalName(t,e){return t}_AddQueryForConditionAttribute(t,e,i,r){if(function(t,e){const i=M(t,e);if(!Object(w.a)(i.get_attributeOf()))switch(M(i.get_attributeOf(),e).get_type()){case"boolean":case"picklist":case"state":case"status":return!0;default:return!1}return!1}(t,e)){const n=M(t,e),a=M(n.get_attributeOf(),e);this._AddPicklistCaseStatement(a,r,i)}else r.append(Object(B.a)("[{0}].[{1}]",i,this.getAttributePhysicalName(t,e)))}_AddPicklistCaseStatement(t,e,i){const r=t.get_optionSet();if(Object(w.a)(r)||Object(w.a)(r.get_options())||0===Object.keys(r.get_options()).length)return void e.append(" null ");e.append(Object(B.a)("case [{0}].[{1}]",i,t.get_logicalName()));const n=r.get_options();for(const t in n){const i={key:t,value:n[t]}.value;e.append(Object(B.a)(" when {0} then '{1}'",i.get_value(),i.get_Label()))}e.append(" else null"),e.append(" end ")}_GenerateSelectQuery(t){t.append("select \n"),this.queryContainer.get_distinctClause().toString().length>0&&t.append(Object(B.a)("{0} ",this.queryContainer.get_distinctClause().toString()));const e=this._GenerateFromClause();t.append(Object(B.a)("{0} \nfrom\n {1}",this.queryContainer.get_selectClause().toString(),e)),this._get_CurrentPredicateBuilder().get_WhereClause().toString().length>0&&t.append(Object(B.a)(" \nwhere\n {0} COLLATE NOCASE",this._get_CurrentPredicateBuilder().get_WhereClause().toString())),this.queryContainer.get_orderByClause().toString().length>0&&t.append(Object(B.a)(" order by\n {0}",this.queryContainer.get_orderByClause().toString())),this.queryContainer.get_limitClause().toString().length>0&&t.append(Object(B.a)("{0} ",this.queryContainer.get_limitClause().toString())),this.queryContainer.get_offsetClause().toString().length>0&&t.append(Object(B.a)("{0} ",this.queryContainer.get_offsetClause().toString()))}_GenerateFromClause(){const t=new Sys.StringBuilder;t.append(Object(B.a)(this.queryContainer.get_fromClause().get_fromClauseFormat(),this.queryContainer.get_fromClause().get_entity()));for(const e of this.queryContainer.get_joinClauses())t.append(Object(B.a)(e.get_fromClauseFormat(),e.get_entity()));return t.toString()}_GetOperandValue(t,e,i){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");const r=M(t,e),n=this._IsEntityNameAttribute(r)?this._GetEntityName(i):i;return this._FormatOperandValue(n,r.get_type())}_FormatOperandValue(t,e){if(!Object(w.a)(t))switch(e){case"lookup":case"customer":case"owner":case"uniqueidentifier":const e=new m.a(t.toString());t=e.toString();break;case"datetime":t=Object(xt.d)(t).trim()}return t}_IsEntityNameAttribute(t){return!Object(w.a)(t)&&"entityname"===t.get_type()}_GetEntityName(t){Object(w.a)(t)&&Error.create("Entity with null otc is not possible");const e=V.a.get_DefaultInstance().get_MetadataCache().getEntityMetadataByTypeCode(t).get_logicalName();return Object(w.a)(e)&&Error.create(Object(B.a)("Entity with otc {0} is not found in cache",t)),e}localizedOuterJoinClause(t){const e=new Sys.StringBuilder,i=t.get_tableAlias();if(i in this.get_muiAttributes()){const r=t.get_entityName(),n=V.a.get_DefaultInstance().get_MetadataCache().getEntityMetadata(r);for(let t=0;t<this.get_muiAttributes()[i].length;t++)e.append(this.getLocalizedLabelJoinClause(this.get_muiAttributes()[i][t],i,n))}return e}getLocalizedLabelJoinClause(t,e,i){const r=new Sys.StringBuilder;let n=t.get_joinCount(),a="LL"+n;return r.append(this.getLocalizedLabelJoinQuery(e,i.get_primaryIdAttribute(),this.get_languageId(),a,t.get_attributeMetadata().get_logicalName())),this.get_needTwoJoinsToLocalizedLabelTable()&&(n++,a="LL"+n,r.append(this.getLocalizedLabelJoinQuery(e,i.get_primaryIdAttribute(),this.get_baseLanguageId(),a,t.get_attributeMetadata().get_logicalName()))),r}getLocalizedLabelJoinQuery(t,e,i,r,n){const a=new Sys.StringBuilder;return a.append(String.format('\n left outer join {0} as "{1}" on ("{1}".[ObjectId] = "{2}".{3} and "{1}".LanguageId = {4} and "{1}".{5} like "%{6}%" )',"businessdatalocalizedlabel",r,t,e,i,"objectcolumnname",n)),a}_HasMultipleLabels(t,e){return!(Object(w.a)(t)||!t.get_isLocalizable()||Object(w.a)(e)||!e.get_usesBusinessDataLabelTable()||!this.get_needTwoJoinsToLocalizedLabelTable())}_GetLocalizedAttributeName(t,e,i){this.localizedLabelJoinCounter++,t in this.get_muiAttributes()||(this.get_muiAttributes()[t]=[]),this.get_muiAttributes()[t].push(new At(e,i,this.localizedLabelJoinCounter));const r=Object(B.a)('"LL{0}".Label',this.localizedLabelJoinCounter.toString());this.localizedLabelJoinCounter++;const n=Object(B.a)('"LL{0}".Label',this.localizedLabelJoinCounter.toString());return Object(B.a)(" {4} cast(coalesce({0},{1}, [{2}].[{3}]) as varchar(2000)) as [{3}] ",r,n,t,e.get_logicalName(),Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",")}_IsConditionWithNoValue(t){return this._IsOwnerTypeOperator(t)||Object(G.h)(t)||this._IsNullOperator(t)}_IsNullOperator(t){switch(t){case"null":case"not-null":return!0;default:return!1}}_IsOwnerTypeOperator(t){switch(t){case"eq-userid":case"ne-userid":case"eq-userteams":case"eq-useroruserteams":return!0;default:return!1}}_GenerateConditionForOwnerTypeOperator(t,e,i){const r=V.a.get_DefaultInstance().get_UserContext().get_UserId().toString(),n=new Sys.StringBuilder(String.format("(SELECT TeamId FROM TeamMembership WHERE SystemUserId = '{0}')",r));return"eq-useroruserteams"===t&&n.append(Object(B.a)(" or {0}.[{1}] = '{2}'",e,i,r)),n.toString()}}{constructor(){super(),this._attributeMapper=new kt.a}addChildAttributes(t,e,i){this.throwIfNullOrUndefined(t,"attributeName"),this.throwIfNullOrUndefined(e,"entityName");const r=V.a.get_DefaultInstance().get_MetadataCache().getAttributeMetadata(e,t);this.throwIfNullOrUndefined(r,Object(B.a)("attributeMetadata: {0}.{1}",e,t)),this._attributeMapper.isComplexAttribute(r.get_type())&&this._AddChildAttributesInternal(t,r,e,i)}_AddChildAttributesInternal(t,e,i,r){const n=Object(Lt.a)(t,e.get_type()),a=this.getAttributePhysicalName(t,i);for(const t of n)t!==a&&this.queryContainer.get_selectClause().append(Object(B.a)("{0} [{1}].[{2}] as [{2}]",Object(w.b)(this.queryContainer.get_selectClause().toString())?"":",",r,t))}throwIfAttributeUnsupported(t){if(!function(t){let e=!0;return Object(Ft.d)(t.get_type())&&(Qt.a.get_DefaultInstance().get_offlineTypescriptInterface().isDssOfflineEnabled()||Object(w.a)(t.get_attributeOf()))||(e=!1),e}(t))throw Error.create(Object(B.a)("Attribute type {0} for attribute {1} not supported in offline",t.get_type(),t.get_logicalName()))}getAttributePhysicalName(t,e){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");let i=null;return(t=Object(Tt.a)(V.a.get_DefaultInstance().get_MetadataCache(),e,t,Object(R.a)(()=>i,t=>i=t))).endsWith("]")&&t.startsWith("[")&&(t=t.substring(1,t.length-1)),t}throwIfOperationOnAttributeNotSupported(t,e,i){if(Object(w.a)(t)||Object(w.a)(e))throw Error.create("Attribute name or entity name cannot be null or undefined");const r=M(t,e);if(!Object(w.a)(r)&&r.get_type()in qt){if(qt[r.get_type()].indexOf(i)<0)throw Error.create(Object(B.a)("Condition Operation {0} is not supported on Attribute Type {1}",i,r.get_type()))}}getLocalizedLabelJoinQuery(t,e,i,r,n){const a=new Sys.StringBuilder;return a.append(String.format('\n left outer join {0} as "{1}" on ("{1}".[ObjectId!id] = "{2}".{3} and "{1}".LanguageId = {4} and "{1}".{5} like "%{6}%" )',"businessdatalocalizedlabel",r,t,e,i,"objectcolumnname",n)),a}}var Vt=i("zjrO"),It=i("uIhY"),Pt=i("tHtE"),Mt=i("odYE"),Dt=i("EXJz"),Xt=i("sZ+8"),Rt=i("eeMP");
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
const Ut={createSqlfromEntityQueryExpression:function(t){t.set_useLimitStatement(!1);const e=new X(new Bt,t);try{return e.getSql()}catch(t){throw u.c.error("Error While Generating Sql "),t}},convertToOdataFormatResponse:function(t,e,i){const r=t.get_fieldNames();r&&r.length>0&&r.forEach(i=>{e&&e.get_select()&&e.get_select().get_attributeNames().length&&-1===e.get_select().get_attributeNames().indexOf(i)||t.markFieldChanged(i)});return Object(It.b)(i.getState(),t,1)},addNextPageLinkIfRequired:function(t,e,i,r,n){if(i&&!(r&&r.get_top()>0&&Ut.getPageNumber(r)*Ut.getPageSize(r,n)>=r.get_top())){let i="";if(r.get_skipToken()){i="?";const t=r.get_queryParameters();Object.keys(t).forEach(r=>{r===d.c.SkipTokenQueryOption&&(t[d.c.SkipTokenQueryOption]=e.get_offset()+1),i+=String.format("&{0}={1}",r,t[r])})}else i=r.get_requestUri()?r.get_requestUri()+String.format("&{0}={1}",d.c.SkipTokenQueryOption,e.get_offset()+1):"?"+String.format("&{0}={1}",d.c.SkipTokenQueryOption,e.get_offset()+1);t[d.c.ODataNextLinkString]={[d.d.API]:d.d.retrieveRecord,[d.d.EntityType]:e.get_entityName(),[d.d.Options]:i,[d.d.MaxPageSize]:n}}},getRelationshipFetchXml:function(t,e,i,r){let n=null;if(e){const a=["schemaName","relationshipType"],s=e[a[0]];switch(e[a[1]]){case 2:const e=Object(o.x)(r,t,s);n=String.format('<fetch mapping=\'logical\'><entity name=\'{0}\'><attribute name=\'{1}\'/><link-entity name="{2}" from="{3}" to="{4}" alias="{2}_1"><filter type="and"><condition attribute="{5}" operator="eq" uitype="{2}" /></filter></link-entity></entity></fetch>',e.ReferencedEntity,Object(o.h)(r,e.ReferencedEntity).PrimaryKeyName,e.ReferencingEntity,e.ReferencingAttribute,e.ReferencedAttribute,Object(o.h)(r,e.ReferencingEntity).PrimaryKeyName);break;case 0:const a=Object(o.B)(r,t,s),l=h.a.fromXml(String.format("<fetch mapping='logical'><entity name='{0}'><attribute name='{1}'/></entity></fetch>",a.ReferencingEntity,Object(o.h)(r,a.ReferencingEntity).PrimaryKeyName));l.applyContextFilter(s,i,r),n=l.getKeyQuery().get_FetchXml();break;case 1:const c=Object(o.u)(r,t,s);let u;u=c.Entity1LogicalName===t?c.Entity2LogicalName:c.Entity1LogicalName;const g=h.a.fromXml(String.format("<fetch mapping='logical'><entity name='{0}'><attribute name='{1}'/></entity></fetch>",u,Object(o.h)(r,u).PrimaryKeyName));g.applyContextFilter(s,i,r),n=g.getKeyQuery().get_FetchXml()}}return n},createEntityQueryExpressionFromFetchXml:function(t){if(!t||""===t)throw new Error("FetchXml string is empty or null");const e=new A(null);try{e.initializeFromFetchXml(t)}catch(t){throw u.c.error("Exception in Create Entity Query Expression From FetchXml is "+Object(a.e)(t)),new Error("Exception in Create Entity Query Expression From FetchXml")}return e},createEntityQueryExpressionFromODataUri:function(t,e,i,r){if(!e||""===e)throw new Error("entityName is null or empty");if(!i)throw new Error("oDataqueryOptions object is null or undefined");const n=new A(e);if(i.get_select()&&i.get_select().get_attributeNames().length>0){u.c.info("oDataqueryOptions has select option");const r=n.get_tableAlias();i.get_select().get_attributeNames().forEach(i=>{n.addAttribute(Object(Dt.d)(t,e,i),r)})}i.get_filter()&&i.get_filter().get_filterExpression()?n.set_filterExpression(i.get_filter().get_filterExpression()):u.c.info("oDataqueryOptions has no filter option"),i.get_orderBy()&&i.get_orderBy().get_orderByTermTokens().length>0&&(u.c.info("oDataqueryOptions has orderby option"),i.get_orderBy().get_orderByTermTokens().forEach(t=>{n.addOrderByAttribute(t.get_attributeName(),t.get_isDescending())}));return n.set_top(Ut.getPageSize(i,r)),n.set_offset(Ut.getPageNumber(i)),n},createQueryFromEntityQueryExpression:function(t,e){const i=Ut.createSqlfromEntityQueryExpression(t);u.c.info("Sql generated from EQE of entity: "+t.get_entityName()+" with sql value: "+i);const r=new Vt.a(new L.a,e);return r.set_EntityLogicalName(t.get_entityName()),Gt(r,t,i),r.set_PageSize(t.get_top()),r.set_PageNumber(t.get_offset()),r},convertToRetrieveMultipleOdataFormat:function(t,e,i,r,n){const a=new Array,s=e.get_entities();let l=s.length;i&&i.get_top()>0&&t.get_top()<i.get_top()&&i.get_top()-t.get_offset()*t.get_top()<0&&(l=i.get_top()-(t.get_offset()-1)*t.get_top());for(let e=0;e<l;e++){const r=Ut.convertToOdataFormatResponse(s[e],i,n);i&&i.get_expand()&&i.get_expand().get_expandTerms().forEach(i=>{r[i.get_navigationProperty().concat(d.c.ODataNextLinkString)]={[d.d.API]:d.d.retrieveRecord,[d.d.Id]:s[e].get_identifier().get_identifier().toString(),[d.d.EntityType]:t.get_entityName(),[d.d.Options]:String.format("?$select={0}&{1}&$getOnlyRelatedEntity=true",Object(o.D)(n.getState(),t.get_entityName()),i.get_expandTermString())},r[i.get_navigationProperty()]={}}),a.push(r)}const c={[d.b.Value]:a};return Ut.addNextPageLinkIfRequired(c,t,e.get_moreRecords(),i,r),c},getRelatedEntities:function(t,e,i,r){const s=[];try{if(!t)throw u.c.error("Record value is null"),new n.a("Record value is null");if(!e||0===e.get_expandTerms().length)return Promise.resolve(t);e.get_expandTerms().forEach(e=>{const a=e.get_navigationProperty();if(u.c.info("Expand expression has navigation property value is "+a),!i.has(a))throw u.c.error("Navigation property is not present"),new n.a(Object(l.a)(-7022,[a,t.get_identifier().LogicalName]),-7022);const o=i.get(a);s.push(Ut.retrieveMultipleRecordsFromNavProp(o,t,e,r))})}catch(t){return u.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(O.a.FromMessage(t.message,null))}return Promise.all(s).then(e=>(e.forEach(e=>{const i=e,r=i.get_query().get_relationship();t.get_relatedEntities().addRelationship(r,i)}),Promise.resolve(t))).catch(t=>(u.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(t)))},addAttributeToEQE:function(t,e,i){if(!t)throw new Error("EntityQueryExpression is null");if(0!==t.get_attributes().length||e&&e.get_selectOption()&&0!==e.get_selectOption().get_attributeNames().length){const r=new Array;if(e&&e.get_selectOption()&&e.get_selectOption().get_attributeNames().length>0){u.c.info("Expand has attribute and length is "+e.get_selectOption().get_attributeNames().length),t.get_attributes().forEach(t=>{r.push(t.get_name())});const i=t.get_tableAlias();e.get_selectOption().get_attributeNames().forEach(e=>{-1===r.indexOf(e)&&(t.addAttribute(e,i),r.push(e))})}const n=Object(o.D)(i,t.get_entityName());u.c.info("Primaryid attribute is "+n),-1===r.indexOf(n)&&t.addAttribute(n,null)}else{u.c.info("Query expression or select token has no attributes, so adding all attributes to the query expression.");const e=Object(s.d)(i,t.get_entityName());for(const i in e){const r=e[i];zt(r.Type)&&!r.AttributeOf&&t.addAttribute(i,null)}}},convertToRetrieveOdataFormat:function(t,e,i){let r={};if(e.get_queryParameters()&&e.get_queryParameters()[d.c.GetOnlyRelatedEntity]&&Object(g.a)(e.get_queryParameters()[d.c.GetOnlyRelatedEntity].toString())){const e=new Array;if(t&&t.get_relatedEntities()&&t.get_relatedEntities().get_entityCollections()&&t.get_relatedEntities().get_entityCollections().length>0){t.get_relatedEntities().get_entityCollections()[0].get_value().get_entities().forEach(t=>{e.push(Ut.convertToOdataFormatResponse(t,null,i))})}r[d.b.Value]=e}else r=Ut.convertToOdataFormatResponse(t,e,i);return r},getPageNumber:function(t){const e=t&&t.get_skipToken()?Object(r.b)(t.get_skipToken()):1;return u.c.info("oDataqueryOptions has pageNumber is "+e),e},getPageSize:function(t,e){let i=e&&e<5e3?e:5e3;t&&t.get_top()&&t.get_top()>0&&i>t.get_top()&&(i=t.get_top());return u.c.info("oDataqueryOptions has maxPageSize is "+e+" and pageSize is "+i),i},getEntityFromRelationShip:function(t,e,i){const r=["schemaName","relationshipType"],n=t[r[0]];switch(t[r[1]]){case 2:return Object(o.x)(e,i,n).ReferencedEntity;case 0:return Object(o.B)(e,i,n).ReferencingEntity;case 1:const t=Object(o.u)(e,i,n);return t.Entity1LogicalName===i?t.Entity2LogicalName:t.Entity1LogicalName}return null},updateLinkExpressionWithFilterValues:function(t,e,i){t.get_linkedEntities().forEach(t=>{t.get_entityName()===e&&Ut.updateConditionsWithFilterValues(t.get_filterExpression(),e,i),Ut.updateLinkExpressionWithFilterValues(t,e,i)})},updateConditionsWithFilterValues:function(t,e,i){t&&(t.get_conditions()&&t.get_conditions().forEach(t=>{t.get_entityName()===e&&(t.set_value(c.a.toString(c.a.fromLegacyGuid(i.get_identifier().Id))),t.set_operator("eq"))}),t.get_filterExpressions()&&t.get_filterExpressions().forEach(t=>{Ut.updateConditionsWithFilterValues(t,e,i)}))},retrieveMultipleRecordsFromNavProp:function(t,e,i,r){return r.dispatch(Object(b.f)(Ut.getEntityFromRelationShip(t,r.getState(),e.get_identifier().LogicalName),!0,[])).then(()=>{const a=Ut.getRelationshipFetchXml(e.get_identifier().LogicalName,t,c.a.fromLegacyGuid(e.get_identifier().Id),r.getState());if(!a)throw u.c.error("Invalid Fetch Xml for navigation property "),new n.a(Object(l.a)(-7025),-7025);const s=Ut.createEntityQueryExpressionFromFetchXml(a);Ut.updateLinkExpressionWithFilterValues(s,e.get_identifier().LogicalName,e),Ut.addAttributeToEQE(s,i,r.getState());const o=new F.a(new k.a(i.get_navigationProperty()),new x.a(s.get_entityName(),c.a.toLegacyGuid(c.a.newGuid())),""),g=Ut.createSqlfromEntityQueryExpression(s);return u.c.info("Sql generated from EQE of entity: "+s.get_entityName()+" with sql value: "+g),o.set_EntityLogicalName(s.get_entityName()),Gt(o,s,g),o.set_PageSize(5e3),r.dispatch(Object(f.a)(o,null))},t=>(u.c.error("Offline.XrmOfflineUtils.retrieveMultipleRecordsFromNavProp: Entity Metadata could not be retrieved with error "+Object(a.e)(t)),Promise.reject(t))).catch(t=>(u.c.error("Offline.XrmOfflineUtils.retrieveMultipleRecordsFromNavProp: Multiple records could not be retrieved with error "+Object(a.e)(t)),Promise.reject(t)))},getEntityMapFromQueryExpression:function t(e){return e.get_linkedEntities().reduce((e,i)=>Object.assign(e,t(i)),{[e.get_entityName()]:null})},createSqlfromFetchXMLAsync:function(t,e){const i=Ut.createEntityQueryExpressionFromFetchXml(e),r=Ut.getEntityMapFromQueryExpression(i);return t.dispatch(Object(b.e)(r)).then(()=>Promise.resolve(Ut.createSqlfromEntityQueryExpression(i))).catch(t=>(u.c.error("createSqlfromFetchXMLAsync fails because all entities in fetch are not present: "+Object(a.e)(t)),Promise.reject(t)))},createSqlfromFetchXMLSync:function(t,e,i){if(Object(Xt.l)(t,i))try{const t=Ut.createEntityQueryExpressionFromFetchXml(e);return Ut.createSqlfromEntityQueryExpression(t)}catch(t){return u.c.error("createSqlfromFetchXMLSync: Error While Generating Sql from fetch"),""}return""},parseResponseAsEntityReference:function(t,e){const i={};return i[d.b.Id]=Object(Rt.c)(t).guid,i[d.b.LogicalName]=e,i}};function zt(t){switch(t){case"unknown":case"decimal":case"double":case"integer":case"memo":case"money":case"string":case"uniqueidentifier":case"bigint":case"owner":case"customer":case"lookup":case"datetime":case"picklist":case"state":case"status":case"boolean":case"entityname":return!0;default:return!1}}function Gt(t,e,i){t.set_ColumnSet(new Q.a([])),t.set_ColumnNames(function t(e){return e.get_attributes().map(t=>{const i=e.get_Alias();return i?`${i}.${t.get_name()}`:t.get_name()}).concat(e.get_linkedEntities().reduce((e,i)=>e.concat(t(i)),[]))}(e)),t.get_DescriptorSet().updateDescriptorSet(T.a.Sql,i),t.set_FetchXmlForAliasedValues(function(t){const e=t.get_fetchXml();if(e)return Object(Pt.d)(e);return null}(e))}function Wt(t,e,i,r){const n=e&&e.get_fetchXml()&&e.get_fetchXml().length>0?Ut.createEntityQueryExpressionFromFetchXml(e.get_fetchXml()):Ut.createEntityQueryExpressionFromODataUri(r.getState(),t,e,i);Ut.addAttributeToEQE(n,null,r.getState());const s=Ut.getEntityMapFromQueryExpression(n);return r.dispatch(Object(b.e)(s)).then(()=>r.dispatch(Object(f.a)(Ut.createQueryFromEntityQueryExpression(n,m.a.newGuid().toString()),null)).then(t=>Promise.resolve(Ut.convertToRetrieveMultipleOdataFormat(n,t,e,i,r))).catch(t=>(u.c.error("retrieveMultipleRecordAsyncAction fails"+Object(a.e)(t)),Promise.reject(t)))).catch(t=>(u.c.error("retrieveEntities fails"+Object(a.e)(t)),Promise.reject(t)))}function Jt(t,e,i,r,n){const l=i.get_select(),g=l&&l.get_attributeNames().length>0?l.get_attributeNames().map(e=>Object(Dt.d)(n.getState(),t,e)):[],d=new Mt.a(t,new c.a(e)),h=new Array,b=Object(s.j)(n.getState(),t,g);if(Object.keys(b).forEach(t=>{const e=b[t];zt(e.Type)&&!e.AttributeOf&&h.push(t)}),0!==g.length){const e=Object(o.D)(n.getState(),t);-1===h.indexOf(e)&&h.push(e)}return n.dispatch((f=Mt.a.toLegacyEntityReference(d),m=new Q.a(h),O=null,w=null,{type:"offline.retrieve.records",execute:({dispatch:t,getState:e},i)=>i.DataSource.retrieve(f,m,new p.a(y.a.NotCached,_.a.Local),O,w).nativePromise().then(t=>(u.c.info("Able to successfully retrieve record from offline db"),Promise.resolve(t))).catch(t=>(u.c.error("DataSource.retrieve fails "+Object(a.e)(t)),Promise.reject(t)))})).then(t=>Ut.getRelatedEntities(t.clone(),i.get_expand(),r,n).then(t=>Promise.resolve(Ut.convertToRetrieveOdataFormat(t,i,n))).catch(t=>(u.c.error("getRelatedEntities fails "+Object(a.e)(t)),Promise.reject(t)))).catch(t=>(u.c.error("DataSource.retrieve fails "+Object(a.e)(t)),Promise.reject(t)));var f,m,O,w}},wHbR:function(t,e,i){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
var r,n,a,s;i.d(e,"c",(function(){return r})),i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"d",(function(){return s})),function(t){t.FilterQueryOption="$filter",t.ExpandQueryOption="$expand",t.SelectQueryOption="$select",t.TopQueryOption="$top",t.SkipTokenQueryOption="$skiptoken",t.OrderByQueryOption="$orderby",t.FetchXmlQueryOption="fetchXml",t.GetOnlyRelatedEntity="$getOnlyRelatedEntity",t.ODataOrderByAscending="asc",t.ODataOrderByDescending="desc",t.ODataNextLinkString="@odata.nextLink"}(r||(r={})),function(t){t.Equal="eq",t.NotEqual="ne",t.Null="null",t.NotNull="not-null",t.In="in",t.NotIn="not-in",t.Like="like",t.NotLike="not-like",t.BeginsWith="begins-with",t.NotBeginWith="not-begin-with",t.EndsWith="ends-with",t.NotEndWith="not-end-with",t.GreaterThan="gt",t.GreaterThanEqual="ge",t.LessThan="lt",t.LessThanEqual="le",t.EqualsUserId="eq-userid",t.NotEqualsUserId="ne-userid",t.EqualsUserTeams="eq-userteams",t.EqualsUserOrUserTeams="eq-useroruserteams"}(n||(n={})),function(t){t.ActivityParty="activityparty",t.OwnerId="ownerid",t.Value="value",t.RawGuid="rawguid",t.Id="id",t.LogicalName="logicalname",t.Name="name",t.PartyId="partyid",t.TransactionCurrencyId="transactioncurrencyid",t.TransactionCurrency="transactioncurrency",t.ColumnDelimiter="!",t.Fields="fields",t.VersionNumber="versionnumber",t.RowVersion="RowVersion"}(a||(a={})),function(t){t.API="API",t.EntityType="entityType",t.Id="id",t.Attributes="attributes",t.Options="options",t.MaxPageSize="maxPageSize",t.retrieveRecord="{Xrm.Mobile.offline}.{retrieveRecord}"}(s||(s={}))}}]),window.bundleExecutionMarkers["scripts/3.js?v=1.4.9962-v91onpremise"].end=window.performance.now(),window.reportBundleExecutionTimes&&window.reportBundleExecutionTimes();