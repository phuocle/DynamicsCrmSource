!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.UCIEmbed=t():e.UCIEmbed=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";
/**
 * @license Copyright (c) Microsoft Corporation. All rights reserved.
 */
function r(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}n.r(t),n.d(t,"Player",(function(){return m})),n.d(t,"PlayerError",(function(){return w}));var o,i=function(){function e(e){this._anchor=document.createElement("a"),this._anchor.href=e}return Object.defineProperty(e.prototype,"host",{get:function(){return this._anchor.host},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostname",{get:function(){return this._anchor.hostname},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._anchor.protocol},enumerable:!1,configurable:!0}),e.prototype.origin=function(e){void 0===e&&(e=!0);var t=e?this.protocol+"//"+this.host:this.protocol+"//"+this.hostname;return"/"===t[t.length-1]&&"\\"===t[t.length-1]||(t+="/"),t},e.prototype.hasSameOrigin=function(t){return this.origin(!1)===new e(t).origin(!1)},e.prototype.toString=function(){return this._anchor.href},e}(),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},u=function(){function e(e,t){this._instanceUrl=e,this._container=t,this._iframe=this._createIframe(),this._isLoaded=!1}return e.prototype.loadAsync=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this._isLoaded?[2]:(this._container.appendChild(this._iframe),[4,this._loadIframeAsync()]);case 1:return e.sent(),[2]}}))}))},e.prototype._createIframe=function(){var e=document.createElement("iframe");return e.id="auth-iframe-"+this._instanceUrl.hostname,e.setAttribute("style","display: none"),e},e.prototype._loadIframeAsync=function(){var e=this;return new Promise((function(t,n){r(5e3).then((function(){n(new w("Cookie exchange error - Authentication iframe load timeout",3,2))})),e._iframe.onload=function(){e._isLoaded=!0,t()},e._iframe.src=e._instanceUrl.origin(!1)+"uclient/embedauth.htm"}))},e.prototype.postCookieExchangeRequestAsync=function(e){var t=this;return new Promise((function(n,i){if(!t._iframe||!t._iframe.contentWindow)return Promise.reject(new w("Cookie exchange error - Authentication iframe does not exist.",4,2));r(5e3).then((function(){i(new w("Cookie exchange timeout",6,2))}));var a=function(e){var r=e.data;t._instanceUrl.hasSameOrigin(e.origin)&&r&&r.payload&&r.message===o.cookieExchangeResponse&&(n(r.payload),removeEventListener("message",a))};window.addEventListener("message",a),t._iframe.contentWindow.postMessage({message:o.cookieExchangeRequest,payload:e},t._instanceUrl.toString())}))},e}();!function(e){e.cookieExchangeRequest="exchangeCookieRequest",e.cookieExchangeResponse="exchangeCookieResponse"}(o||(o={}));var s,l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},h=function(){function e(e,t,n){this._instanceUrl=e,this._authProvider=t,this._asyncAuthErrorCallback=n,this._authIframe=new u(e,document.body)}return e.prototype.authenticateAsync=function(){return l(this,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return[4,this._authIframe.loadAsync()];case 1:return t.sent(),[4,this._completeAuthFlowAsync()];case 2:return e=t.sent(),this._setCookieRefreshTimeout(e),[2]}}))}))},e.prototype._completeAuthFlowAsync=function(){return l(this,void 0,void 0,(function(){var e,t;return f(this,(function(n){switch(n.label){case 0:return e={resource:this._instanceUrl.toString()},[4,this._getTokenAsync(e)];case 1:return t=n.sent(),[4,this._getCookieAsync(t)];case 2:return n.sent(),[2,t.expiration]}}))}))},e.prototype._getTokenAsync=function(e){return l(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._authProvider.getToken(e)];case 1:return[2,n.sent()];case 2:throw t=n.sent(),new w("Unable to retrieve access token",2,2,{error:t});case 3:return[2]}}))}))},e.prototype._getCookieAsync=function(e){return l(this,void 0,void 0,(function(){var t,n,r,o;return f(this,(function(i){switch(i.label){case 0:return t={token:e.token,expiration:e.expiration},[4,this._authIframe.postCookieExchangeRequestAsync(t)];case 1:if(!(n=i.sent()).success)throw r=JSON.parse(n.error),o="Unable to create/renew session cookie",o+=r&&r.message?" - "+r.message:"",new w(o,5,2,r);return[2]}}))}))},e.prototype._setCookieRefreshTimeout=function(e){var t=this,n=e.getTime()-(new Date).getTime();setTimeout((function(){t._refreshCookieAsync()}),n)},e.prototype._refreshCookieAsync=function(){return l(this,void 0,void 0,(function(){var e,t;return f(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._completeAuthFlowAsync()];case 1:return e=n.sent(),this._setCookieRefreshTimeout(e),[3,3];case 2:return(t=n.sent()).DETAILS=t.DETAILS||{},t.DETAILS.instanceUrl=this._instanceUrl.toString(),t.TYPE=2,this._asyncAuthErrorCallback(t),[3,3];case 3:return[2]}}))}))},e}(),p=(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function c(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}u((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},b=["allow-popups","allow-same-origin","allow-modals","allow-scripts","allow-forms","allow-downloads"],m=function(){function e(e){this._options=e}return e.prototype.renderAppAsync=function(e,t){return d(this,void 0,void 0,(function(){var n,r,o,a;return y(this,(function(c){switch(c.label){case 0:if(c.trys.push([0,2,,3]),!(n=document.getElementById(t)))throw new w("Error embedding application, no HTML element found with id '"+t+"'.",7,3,{containerId:t});if(!(r=function(e){var t=new i(e);return t.host&&t.host!==window.location.host?t:null}(e)))throw new w("Error embedding application, '"+e+"' is an invalid app url.",8,3,{appUrl:e});return o=new i(r.origin(!1)),[4,new h(o,this._options.authProvider,this._hostErrorCallback.bind(this)).authenticateAsync()];case 1:return c.sent(),[2,this._render(e,n)];case 2:return a=c.sent(),this._hostErrorCallback(a),[2,Promise.reject(a)];case 3:return[2]}}))}))},e.prototype._hostErrorCallback=function(e){var t;e instanceof w?t=e:((t=e).CODE=t.CODE||1,t.TYPE=t.TYPE||1,t.DETAILS=t.DETAILS||{}),this._options.handleError(t)},e.prototype._render=function(e,t){var n=this._createAppIframe();return t.appendChild(n),n.src=e,n.id},e.prototype._createAppIframe=function(){var e=document.createElement("iframe");return e.id="embedded-app-iframe",e.setAttribute("style","display: block; box-sizing: border-box; border: none; width: 100%; height: 100%"),e.setAttribute("sandbox",b.join(" ")),e},e}(),w=function(e){function t(n,r,o,i){void 0===r&&(r=1),void 0===o&&(o=1),void 0===i&&(i={});var a=e.call(this,n)||this;return Object.setPrototypeOf(a,t.prototype),a.message=n,a.CODE=r,a.TYPE=o,a.DETAILS=i,a}return p(t,e),t}(Error)}])}));