Type.registerNamespace("Mscrm");Mscrm.IArticlePost=function(){};Mscrm.IArticlePost.registerInterface("Mscrm.IArticlePost");Mscrm.IExternalInteractionProvider=function(){};Mscrm.IExternalInteractionProvider.registerInterface("Mscrm.IExternalInteractionProvider");Mscrm.IRetrieveArticlePostRequest=function(){};Mscrm.IRetrieveArticlePostRequest.registerInterface("Mscrm.IRetrieveArticlePostRequest");Mscrm.IRetrieveArticlePostResponse=function(){};Mscrm.IRetrieveArticlePostResponse.registerInterface("Mscrm.IRetrieveArticlePostResponse");Mscrm.ArticlePost=function(){};Mscrm.ArticlePost.prototype={timesViewed:0,attachmentCount:0,question:null,description:null,answer:null,publicUrl:null,published:false,stateCode:0,rating:0,articleId:null,articleUId:null,href:null,serviceDeskUri:null,lastModifiedOn:null,createdOn:null,expiredDate:null,folderHref:null,searchBlurb:"",sanitized:false,isParature:false,$c_0:false,get_isAssociated:function(){return this.$c_0},set_isAssociated:function(value){this.$c_0=value;return value},get_timesViewed:function(){return this.timesViewed},set_timesViewed:function(value){this.timesViewed=value;return value},get_attachmentCount:function(){return this.attachmentCount},set_attachmentCount:function(value){this.attachmentCount=value;return value},get_question:function(){return this.question},set_question:function(value){this.question=value;return value},get_description:function(){return this.description},set_description:function(value){this.description=value;return value},get_answer:function(){return this.answer},set_answer:function(value){this.answer=value;this.searchBlurb=value;return value},get_publicUrl:function(){return this.publicUrl},set_publicUrl:function(value){this.publicUrl=value;return value},get_published:function(){return this.published},set_published:function(value){this.published=value;return value},get_stateCode:function(){return this.stateCode},set_stateCode:function(value){this.stateCode=value;return value},get_rating:function(){return this.rating},set_rating:function(value){this.rating=value;return value},get_articleId:function(){return this.articleId},set_articleId:function(value){this.articleId=value;return value},get_articleUId:function(){return this.articleUId},set_articleUId:function(value){this.articleUId=value;return value},get_href:function(){return this.href},set_href:function(value){this.href=value;return value},get_serviceDeskUri:function(){return this.serviceDeskUri},set_serviceDeskUri:function(value){this.serviceDeskUri=value;return value},get_lastModifiedOn:function(){return this.lastModifiedOn},set_lastModifiedOn:function(value){this.lastModifiedOn=value;return value},get_expiredDate:function(){return this.expiredDate},set_expiredDate:function(value){this.expiredDate=value;return value},get_folderHref:function(){return this.folderHref},set_folderHref:function(value){this.folderHref=value;return value},get_createdOn:function(){return this.createdOn},set_createdOn:function(value){this.createdOn=value;return value},get_searchBlurb:function(){return this.searchBlurb},set_searchBlurb:function(value){this.searchBlurb=value;return value},get_sanitized:function(){return this.sanitized},set_sanitized:function(value){this.sanitized=value;return value},get_isParature:function(){return this.isParature},set_isParature:function(value){this.isParature=value;return value},get_comments:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_comments:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_createdBy:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_createdBy:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_likeCounter:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_likeCounter:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_likeId:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_likeId:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_postId:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_postId:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_text:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_text:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value}};Mscrm.ExternalProviderFactory=function(){};Mscrm.ExternalProviderFactory.getClient=function(clientType){switch(clientType.toLowerCase()){case "parature":return new Mscrm.ParatureInteraction;case "crm":return new Mscrm.CrmNativeSearchInteraction;case "simplerelevancesearch":return new Mscrm.SimpleRelevanceSearchInteraction;case "advancedrelevancesearch":return new Mscrm.AdvancedRelevanceSearchInteraction;default:return null}};Mscrm.ParatureConverter=function(){};Mscrm.ParatureConverter.$r=function($p0){var $v_0=new Mscrm.RetrieveArticlePostResponse,$v_1={},$v_2=null,$v_3=null,$$t_A,$$t_B,$v_4=($$t_B=Mscrm.JsonUtilities.tryGetParsedJson($p0,$$t_A={val:$v_1}),$v_1=$$t_A.val,$$t_B);if(!IsNull($v_4)){$v_0.isSucceded=false;$v_0.errorCode=$v_4.ErrorCode;$v_0.errorMessage=$v_4.DisplayText;return $v_0}if($v_1&&$v_1["Entities"]){$v_2=$v_1["Entities"];$v_0.total=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_2,"@total"))?Number.parseInvariant(Mscrm.ParatureConverter.$3($v_2,"@total")):0;$v_0.results=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_2,"@results"))?Number.parseInvariant(Mscrm.ParatureConverter.$3($v_2,"@results")):0;$v_0.pageSize=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_2,"@page-size"))?Number.parseInvariant(Mscrm.ParatureConverter.$3($v_2,"@page-size")):0;$v_0.morePosts=$v_0.total>$v_0.pageSize?true:false;var $v_5=$v_2["Article"];if($v_5&&$v_5.length>0){$v_3=new Array($v_5.length);var $v_6=0;while($v_6<$v_5.length){var $v_7=$v_5[$v_6],$v_8=new Mscrm.ArticlePost;$v_8.isParature=true;$v_8.set_answer(Mscrm.ParatureConverter.$7($v_7,"Answer"));$v_8.href=Mscrm.ParatureConverter.$3($v_7,"@href");$v_8.articleId=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_7,"@id"))?Mscrm.ParatureConverter.$3($v_7,"@id"):"0";$v_8.timesViewed=!isNullOrEmptyString(Mscrm.ParatureConverter.$7($v_7,"Times_Viewed"))?Number.parseInvariant(Mscrm.ParatureConverter.$7($v_7,"Times_Viewed")):0;$v_8.attachmentCount=0;$v_8.question=Mscrm.ParatureConverter.$7($v_7,"Question");$v_8.published=!isNullOrEmptyString(Mscrm.ParatureConverter.$7($v_7,"Published"))?Boolean.parse(Mscrm.ParatureConverter.$7($v_7,"Published")):false;$v_8.rating=!isNullOrEmptyString(Mscrm.ParatureConverter.$7($v_7,"Rating"))?Number.parseInvariant(Mscrm.ParatureConverter.$7($v_7,"Rating")):0;$v_8.serviceDeskUri=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_7,"@service-desk-uri"))?CrmEncodeDecode.CrmUrlEncode(Mscrm.ParatureConverter.$3($v_7,"@service-desk-uri")):"";$v_8.articleUId=Mscrm.ParatureConverter.$3($v_7,"@uid");$v_8.folderHref=!isNullOrEmptyString(Mscrm.ParatureConverter.$3($v_7,"@href"))?CrmEncodeDecode.CrmUrlEncode(Mscrm.ParatureConverter.$3($v_7,"@href")):"";$v_8.lastModifiedOn=Mscrm.ParatureConverter.$Y(Mscrm.ParatureConverter.$7($v_7,"Date_Updated"));$v_8.createdOn=Mscrm.ParatureConverter.$Y(Mscrm.ParatureConverter.$7($v_7,"Date_Created"));$v_8.expiredDate=Mscrm.ParatureConverter.$Y(Mscrm.ParatureConverter.$7($v_7,"Expiration_Date"));$v_3[$v_6]=$v_8;$v_6++}}}$v_0.posts=$v_3;$v_0.isSucceded=true;return $v_0};Mscrm.ParatureConverter.$Y=function($p0){if(isNullOrEmptyString($p0))return null;var $v_0=ParseUtcDate($p0);$v_0.setMinutes($v_0.getMinutes()+window.ORG_TIMEZONE_OFFSET);return $v_0};Mscrm.ParatureConverter.$7=function($p0,$p1){if($p0&&$p0[$p1])return $p0[$p1]["#text"].toString();return ""};Mscrm.ParatureConverter.$3=function($p0,$p1){if($p0&&$p0[$p1])return $p0[$p1].toString();return ""};Mscrm.ParatureJsonData=function(){};Mscrm.ParatureJsonData.prototype={Entities:null};Mscrm.ParatureEntityData=function(){};Mscrm.ParatureEntityData.prototype={total:0,results:0,page:null,pagesize:0,href:null,Article:null};Mscrm.ParatureArticleData=function(){};Mscrm.ParatureArticleData.prototype={id:0,uid:null,href:null,servicedeskuri:null,Question:null,Answer:null,Published:null,Times_Viewed:null,Date_Created:null,Date_Updated:null,Expiration_Date:null,Created_By:null,Rating:null,Folders:null};Mscrm.ParatureArticle=function(){};Mscrm.ParatureArticle.prototype={ArticleFolder:null};Mscrm.ParatureArticleFolder=function(){};Mscrm.ParatureArticleFolder.prototype={id:0,uid:0,href:null,Name:null};Mscrm.ParatureAttributeData=function(){};Mscrm.ParatureAttributeData.prototype={text:null};Mscrm.ParatureInteraction=function(){this.$0_0={};this.$0_0["answer"]="Answer";this.$0_0["answerlike"]="Answer_like_";this.$0_0["folderid"]="Folder_id_";this.$0_0["published"]="Published";this.$0_0["question"]="Question";this.$0_0["questionlike"]="Question_like_";this.$0_0["searchString"]="_keywords_";this.$0_0["order"]="_order_";this.$0_0["output"]="_output_";this.$0_0["searchoption"]="_searchoption_";this.$0_0["searchsubfolders"]="_search_subfolders_";this.$0_0["status"]="_status_new";this.$0_0["total"]="_total_";this.$0_0["pagesize"]="_PageSize_";this.$0_0["startpage"]="_startPage_";this.$0_0["isprivate"]="Is_Private";this.$0_0["namelike"]="Name_like_";this.$0_0["name"]="Name";this.$0_0["parentfolderid"]="Parent_Folder_id_"};Mscrm.ParatureInteraction.prototype={get_$N_0:function(){if(window._bIsOsdpOrg)return true;else return window.IsCorsEnabledForKmControl},getArticleResponse:function(request,retrievePostsCallback){var $v_0=Mscrm.CrmUri.create(request.get_parameters()["url"]),$$t_5;this.$10_0(request.get_parameters(),$$t_5={val:$v_0}),$v_0=$$t_5.val;if(IsNull($v_0.get_query()["_total_"])){if(!IsNull(request.get_parameters()["startpage"])){request.set_pageNumber(request.get_parameters()["startpage"]);$v_0.get_query()[this.$0_0["startpage"].toString()]=request.get_pageNumber()}if(!IsNull(request.get_parameters()["pagesize"])){request.set_pageSize(request.get_parameters()["pagesize"]);$v_0.get_query()[this.$0_0["pagesize"].toString()]=request.get_pageSize()}}var $$t_6=this,$$t_7=this;this.$u_0($v_0,function($p1_0){$$t_6.$K_0($p1_0,retrievePostsCallback)},function($p1_0){$$t_7.$F_0($p1_0,retrievePostsCallback)})},validateConnection:function(urlToValidate,successCallback,failureCallback){if(this.get_$N_0()){urlToValidate.get_query()["_output_"]="json";urlToValidate.get_query()["_outputerror_"]="json"}else urlToValidate.get_query()["_output_"]="javascript";var $$t_B=this,$$t_C=this;this.$u_0(urlToValidate,function($p1_0){if(IsNull(successCallback))return;successCallback()},function($p1_0){if(IsNull(failureCallback))return;var $v_0,$$t_9,$$t_A;$$t_A=Mscrm.JsonUtilities.tryGetParsedJson($p1_0,$$t_9={val:$v_0}),$v_0=$$t_9.val,$$t_A;var $v_1=IsNull($v_0)?{}:$v_0["Error"],$v_2=!IsNull($v_1["@code"])?$v_1["@code"]:"0",$v_3=!IsNull($v_1["@suberrorcode"])?$v_1["@suberrorcode"].toString():"";if($p1_0==="timeout")$v_2="408";failureCallback($v_2,$v_3)})},$10_0:function($p0,$p1){if(this.get_$N_0()){$p1.val.get_query()["_output_"]="json";$p1.val.get_query()["_outputerror_"]="json"}else $p1.val.get_query()["_output_"]="javascript";$p1.val.get_query()["_searchoption_"]="anywords";if(!IsNull($p0)){var $$dict_3=$p0;for(var $$key_4 in $$dict_3){var $v_0={key:$$key_4,value:$$dict_3[$$key_4]};if(!IsNull($v_0.value)&&!isNullOrEmptyString($v_0.value.toString()))if(this.$0_0[$v_0.key])$p1.val.get_query()[this.$0_0[$v_0.key].toString()]=$v_0.value}}},$K_0:function($p0,$p1){var $v_0;if(this.get_$N_0())$v_0=$p0;else $v_0=JSON.stringify($p0);var $v_1=Mscrm.ParatureConverter.$r($v_0);$p1($v_1)},$F_0:function($p0,$p1){var $v_0=new Mscrm.RetrieveArticlePostResponse,$v_1,$$t_5,$$t_6;$$t_6=Mscrm.JsonUtilities.tryGetParsedJson($p0,$$t_5={val:$v_1}),$v_1=$$t_5.val,$$t_6;var $v_2=IsNull($v_1)?{}:$v_1["Error"];$v_0.errorCode=!IsNull($v_2["@code"])?Number.parseInvariant($v_2["@code"].toString()):0;$v_0.errorMessage=!IsNull($v_2["@message"])?$v_2["@message"].toString():"";$v_0.errorDescription=!IsNull($v_2["@description"])?$v_2["@description"].toString():"";$v_0.subErrorCode=!IsNull($v_2["@suberrorcode"])?$v_2["@suberrorcode"].toString():"";$v_0.subErrorDescription=!IsNull($v_2["@suberrormessage"])?$v_2["@suberrormessage"].toString():"";if($p0==="timeout")$v_0.errorCode=408;$v_0.isSucceded=false;$p1($v_0)},$u_0:function($p0,$p1,$p2){if(!this.get_$N_0()){var $v_0=new jQueryAjaxOptions;$v_0.cache=true;$v_0.type="GET";$v_0.dataType="jsonp";$v_0.url=$p0.toString();$v_0.jsonp="_callback_";$v_0.timeout=3e4;var $$t_F=this,$$t_G=this;$P_CRM.ajax($v_0).success(function($p1_0){$p1($p1_0)}).error(function($p1_0,$p1_1,$p1_2){$p2($p1_2)})}else{$P_CRM.support.cors=true;var $v_1=new jQueryAjaxOptions;$v_1.cache=true;$v_1.type="GET";$v_1.contentType="text/plain";$v_1.url=$p0.toString();$v_1.timeout=3e4;var $v_2={};$v_2["withCredentials"]="true";$v_1.xhrFields=$v_2;var $v_3=$P_CRM.ajax($v_1),$$t_H=this,$$t_I=this;$v_3.success(function($p1_0){$p1($v_3.responseText)}).error(function($p1_0,$p1_1,$p1_2){if(!IsNull($p1_2)&&$p1_2.toString()==="timeout")$p2($p1_2);else $p2($p1_0.responseText)})}}};Mscrm.CrmNativeSearchInteraction=function(){};Mscrm.CrmNativeSearchInteraction.$X=function($p0){$p0.setMinutes($p0.getMinutes()+$p0.getTimezoneOffset()+window.ORG_TIMEZONE_OFFSET);return $p0};Mscrm.CrmNativeSearchInteraction.prototype={getArticleResponse:function(request,retrievePostsCallback){this.$z_0(request,retrievePostsCallback)},validateConnection:function(urlToValidate,successCallback,failureCallback){throw Error.notImplemented("The method or operation is not implemented.")},$z_0:function($p0,$p1){!IsNull($p0.get_parameters()["startpage"])&&$p0.set_pageNumber($p0.get_parameters()["startpage"]);!IsNull($p0.get_parameters()["pagesize"])&&$p0.set_pageSize($p0.get_parameters()["pagesize"]);var $v_0=$p0.get_parameters()["searchString"].toString(),$v_1=String.format("<fetch mapping='logical' returntotalrecordcount='true' page='{0}' count='{1}'><entity name='knowledgearticle'><attribute name='knowledgearticleid' /><attribute name='articlepublicnumber' /><attribute name='title' /><attribute name='description' /><attribute name='content' /><attribute name='knowledgearticleviews' /><attribute name='createdon' /><attribute name='modifiedon' /><attribute name='statecode' /><attribute name='statuscode' /><attribute name='expirationdate' /><attribute name='languagelocaleid' /><attribute name='majorversionnumber' /><attribute name='minorversionnumber' /><attribute name='islatestversion' />{2}{3}</entity></fetch>",$p0.get_pageNumber(),$p0.get_pageSize(),this.$12_0($p0),this.$16_0($p0)),$v_2=this.$17_0($p0),$$t_C=this,$$t_D=this;Xrm.Internal.messages.fullTextSearchKnowledgeArticle($v_0,true,true,$v_2,$v_1).then(function($p1_0){var $v_3=$p1_0;if(!IsNull($v_3)&&!IsNull($v_3.entityCollection)){var $v_4=$v_3.entityCollection,$v_5=new Mscrm.RetrieveArticlePostResponse;$v_5.total=$v_4.get_TotalRecordCount();$v_5.results=$v_4.get_count();$v_5.pageSize=$p0.get_pageSize();$v_5.morePosts=$v_4.get_moreRecords();$v_5.isSucceded=true;$v_5.posts=$$t_C.$w_0($p0,$v_4);$p1&&$p1($v_5)}},function($p1_0){if($p1_0.get_organizationServiceFault()){var $v_6=new Mscrm.RetrieveArticlePostResponse;$v_6.isSucceded=false;var $v_7=$p1_0.get_organizationServiceFault().get_errorCode();Xrm.Internal.openErrorDialog($v_7,$p1_0.get_message(),$p1_0.get_organizationServiceFault().get_responseOuterXml());$p1&&$p1($v_6)}})},$12_0:function($p0){var $v_0=!$p0.get_parameters()["language"]?"":$p0.get_parameters()["language"].toString();if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0))return "";return String.format("<filter><condition attribute='languagelocaleid' operator='eq' value='{0}'/></filter>",CrmEncodeDecode.CrmHtmlAttributeEncode($v_0.toString()))},$16_0:function($p0){if(Mscrm.InternalUtilities.JSTypes.isNull($p0.get_parameters()["order"]))return "";var $v_0="<order attribute='{0}' descending='{1}' />",$v_1=Mscrm.InternalUtilities.JSTypes.isNull($p0.get_parameters()["isDescending"])||$p0.get_parameters()["isDescending"]?"true":"false";return String.format($v_0,$p0.get_parameters()["order"],$v_1)},$17_0:function($p0){var $v_0=3;if(Mscrm.InternalUtilities.JSTypes.isNull($p0.get_parameters()["articleFilter"]))return $v_0;$v_0=Number.parseInvariant($p0.get_parameters()["articleFilter"].toString());return $v_0},$w_0:function($p0,$p1){var $v_0=null;$v_0=new Array($p1.get_count());for(var $v_1=0;$p1.get_count()>$v_1;$v_1++){var $v_2=$p1.get_item($v_1),$v_3=new Mscrm.ArticlePost;$v_3.articleId=$v_2.getValue("articlepublicnumber").toString()+"_"+$v_2.getValue("knowledgearticleid").toString();$v_3.articleUId=$v_2.getValue("knowledgearticleid").toString();$v_3.question=$v_2.getValue("title").toString();$v_3.description=IsNull($v_2.getValue("description"))?"":$v_2.getValue("description").toString();$v_3.set_answer(IsNull($v_2.getValue("content"))?"":$v_2.getValue("content").toString());$v_3.lastModifiedOn=Mscrm.CrmNativeSearchInteraction.$X($v_2.getValue("modifiedon"));$v_3.createdOn=Mscrm.CrmNativeSearchInteraction.$X($v_2.getValue("createdon"));var $v_4=$v_2.getFieldObjectData("statecode")["value"];$v_3.stateCode=$v_4;$v_3.published=$v_4===3;$v_3.sanitized=true;$v_3.timesViewed=IsNull($v_2.getValue("knowledgearticleviews"))?0:$v_2.getValue("knowledgearticleviews");if(!IsNull($v_2.getValue("expirationdate")))$v_3.expiredDate=Mscrm.CrmNativeSearchInteraction.$X($v_2.getValue("expirationdate"));$v_0[$v_1]=$v_3}return $v_0}};Mscrm.RetrieveArticlePostRequest=function(){this.$g_0={}};Mscrm.RetrieveArticlePostRequest.prototype={$d_0:0,$e_0:0,$f_0:null,$l_0:null,$j_0:null,get_pageNumber:function(){return this.$d_0},set_pageNumber:function(value){this.$d_0=value;return value},get_pageSize:function(){return this.$e_0},set_pageSize:function(value){this.$e_0=value;return value},get_pagingCookie:function(){return this.$f_0},set_pagingCookie:function(value){this.$f_0=value;return value},get_sortModifier:function(){return this.$l_0},set_sortModifier:function(value){this.$l_0=value;return value},get_requestType:function(){return this.$j_0},set_requestType:function(value){this.$j_0=value;return value},get_startDate:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_startDate:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_endDate:function(){throw Error.notImplemented("The method or operation is not implemented.")},set_endDate:function(value){throw Error.notImplemented("The method or operation is not implemented.");return value},get_parameters:function(){return this.$g_0},set_parameters:function(value){this.$g_0=value;return value}};Mscrm.RetrieveArticlePostResponse=function(){};Mscrm.RetrieveArticlePostResponse.prototype={morePosts:false,posts:null,total:0,results:0,pageSize:0,errorMessage:null,isSucceded:false,errorCode:0,errorDescription:null,subErrorCode:null,subErrorDescription:null,get_morePosts:function(){return this.morePosts},set_morePosts:function(value){this.morePosts=value;return value},get_posts:function(){return this.posts},set_posts:function(value){this.posts=value;return value},get_total:function(){return this.total},set_total:function(value){this.total=value;return value},get_results:function(){return this.results},set_results:function(value){this.results=value;return value},get_pageSize:function(){return this.pageSize},set_pageSize:function(value){this.pageSize=value;return value},get_errorMessage:function(){return this.errorMessage},set_errorMessage:function(value){this.errorMessage=value;return value},get_isSucceeded:function(){return this.isSucceded},set_isSucceeded:function(value){this.isSucceded=value;return value},get_errorCode:function(){return this.errorCode},set_errorCode:function(value){this.errorCode=value;return value},get_errorDescription:function(){return this.errorDescription},set_errorDescription:function(value){this.errorDescription=value;return value},get_subErrorCode:function(){return this.subErrorCode},set_subErrorCode:function(value){this.subErrorCode=value;return value},get_subErrorDescription:function(){return this.subErrorDescription},set_subErrorDescription:function(value){this.subErrorDescription=value;return value},get_pagingCookie:function(){throw Error.notImplemented("The method or operation is not implemented.")}};Mscrm.AdvancedRelevanceSearchInteraction=function(){};Mscrm.AdvancedRelevanceSearchInteraction.getSearchFacets=function(searchEntity){for(var $v_2=0;searchEntity.length>$v_2;$v_2++)if(Mscrm.Utility.getAttributeValue(searchEntity[$v_2],"Value")==="knowledgearticle")Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray[0]=searchEntity[$v_2];else if(Mscrm.Utility.getAttributeValue(searchEntity[$v_2],"Value")==="annotation")Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray[1]=searchEntity[$v_2];var $v_0=Mscrm.Utility.getAttributeValue(Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray[0],"Count"),$v_1=Mscrm.Utility.getAttributeValue(Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray[1],"Count");Mscrm.AdvancedRelevanceSearchInteraction.$H=!isNullOrEmptyString($v_0)?Number.parseInvariant($v_0):0;Mscrm.AdvancedRelevanceSearchInteraction.$U=!isNullOrEmptyString($v_1)?Number.parseInvariant($v_1):0};Mscrm.AdvancedRelevanceSearchInteraction.processResponseEntities=function(retrievePostsCallback,request){Mscrm.AdvancedRelevanceSearchInteraction.$C=new Array(0);if(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults||Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset){Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.$8=0;Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=new Array(Mscrm.AdvancedRelevanceSearchInteraction.$G);Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler=0;Mscrm.AdvancedRelevanceSearchInteraction.$1B(retrievePostsCallback,request);if(!Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler){Mscrm.AdvancedRelevanceSearchInteraction.sanitizeSearchControlDataSet();Mscrm.AdvancedRelevanceSearchInteraction.getRelevanceSearchResultSet(retrievePostsCallback);Mscrm.AdvancedRelevanceSearchInteraction.$J(retrievePostsCallback);return}else{Mscrm.AdvancedRelevanceSearchInteraction.$C.length=Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler;Mscrm.AdvancedRelevanceSearchInteraction.processAnnotations(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset,Mscrm.AdvancedRelevanceSearchInteraction.$C,retrievePostsCallback,request)}}};Mscrm.AdvancedRelevanceSearchInteraction.$1B=function($p0,$p1){var $v_0,$v_1=new Array(0),$v_2=false;if(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset&&Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length===10||Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset&&!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults){Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length=Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length;Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset;Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.$J($p0);return}if(Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults){Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge=Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults.length;var $$t_9,$v_3=($$t_9=Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults).concat.apply($$t_9,Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults);Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=$v_3;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults=null}if(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults&&Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults.length>0){var $v_4=0,$v_5=0,$v_6=false;while($v_4<Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults.length&&$v_5<Mscrm.AdvancedRelevanceSearchInteraction.$G){$v_0=Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_4];if($v_0){Mscrm.AdvancedRelevanceSearchInteraction.$S=Mscrm.Utility.getAttributeValue($v_0,"@search.entityname");if(Mscrm.AdvancedRelevanceSearchInteraction.$S==="knowledgearticle"){Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8]=$v_0;Mscrm.AdvancedRelevanceSearchInteraction.removeAssociatedAnnotationInUnprocessedData(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults,Mscrm.Utility.getAttributeValue($v_0,"@search.objectid"),$v_0);Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_4]=null;Mscrm.AdvancedRelevanceSearchInteraction.$8++;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount++;$v_5++}else if(Mscrm.AdvancedRelevanceSearchInteraction.$S==="annotation"){$v_1[0]=$v_0;$v_6=Mscrm.AdvancedRelevanceSearchInteraction.updateKnowledgeArticleWithAnnotaion(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults,$v_1,$v_2);if($v_6){Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_4]=null;Mscrm.AdvancedRelevanceSearchInteraction.removeAssociatedAnnotationInUnprocessedData(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults,Mscrm.Utility.getAttributeValue(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8],"@search.objectid"),Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8]);Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount++;$v_5++;Mscrm.AdvancedRelevanceSearchInteraction.$8++}if(!$v_6){Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_4]=null;Mscrm.AdvancedRelevanceSearchInteraction.removeAssociatedAnnotationInUnprocessedData(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults,Mscrm.Utility.getAttributeValue($v_0,"objectid"),$v_0);Mscrm.AdvancedRelevanceSearchInteraction.$C[Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler]=$v_0;Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8]=$v_0;Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler++;Mscrm.AdvancedRelevanceSearchInteraction.$C.length=Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler+1;$v_5++;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount++;Mscrm.AdvancedRelevanceSearchInteraction.$8++}}}$v_4++}}if(Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount>0){Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount=Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount-Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount=0}};Mscrm.AdvancedRelevanceSearchInteraction.processLocalStorageEntities=function(totalResults,totalProcessedResults,totalUnProcessedResults){if(totalResults>Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength)if(totalUnProcessedResults<=Mscrm.AdvancedRelevanceSearchInteraction.$G&&totalUnProcessedResults){var $v_0=0;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount=0;var $v_1=0;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults=new Array(10);while($v_0<Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults.length&&Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults){if(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_0]){Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults[$v_1]=Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults[$v_0];$v_1++}$v_0++}Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults.length=$v_1;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount=Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults.length;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount=0}};Mscrm.AdvancedRelevanceSearchInteraction.updateKnowledgeArticleWithAnnotaion=function(resultsData,annotationdata,processAnnotation){var $v_0=0,$v_1=0,$v_2=false;while($v_0<resultsData.length){if(resultsData[$v_0]){var $v_3=Mscrm.Utility.getAttributeValue(resultsData[$v_0],"@search.entityname"),$v_4=null,$v_5=Mscrm.Utility.getAttributeValue(resultsData[$v_0],"@search.objectid"),$v_6="";if($v_3==="knowledgearticle"){if(annotationdata.length>0)for($v_1=0;$v_1<annotationdata.length;$v_1++){$v_4=Mscrm.Utility.getAttributeValue(annotationdata[$v_1],"@search.entityname");if($v_4==="annotation"){$v_6=Mscrm.Utility.getAttributeValue(annotationdata[$v_1],"objectid");if($v_6===$v_5)break}}if($v_6!==""&&$v_6===$v_5){var $v_7=resultsData[$v_0],$v_8=$v_7["@search.highlights"],$v_9=annotationdata[$v_1]["@search.highlights"],$v_A=$v_9["notetext"],$v_B=$v_9["documentbody"];$v_8["notetext"]=$v_A;$v_8["documentbody"]=$v_B;if(processAnnotation)Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[$v_1]=$v_7;else Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8]=$v_7;resultsData[$v_0]=null;if(annotationdata.length===1&&!processAnnotation)Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount++;$v_2=true}}}$v_0++}return $v_2};Mscrm.AdvancedRelevanceSearchInteraction.sanitizeSearchControlDataSet=function(){var $v_0=0;if(!Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset)Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=new Array(0);var $v_1=0,$v_2=new Array(0);while($v_0<Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length){var $v_3=Mscrm.Utility.getAttributeValue(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[$v_0],"@search.entityname");if($v_3==="knowledgearticle"&&Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length<10)Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length]=Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[$v_0];else if(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length===10)if($v_3==="knowledgearticle"){$v_2[$v_1]=Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[$v_0];$v_1++}$v_0++}Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=null;if(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length>0){Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=new Array(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length);Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset;if(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length===10)Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=null}if($v_2.length>0){Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=new Array($v_2.length);Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=$v_2}};Mscrm.AdvancedRelevanceSearchInteraction.removeAssociatedAnnotationInUnprocessedData=function(data,articleid,kbarticle){var $v_0=false;if(articleid!==""){var $v_1=0;while($v_1<data.length){if(data[$v_1]){var $v_2=Mscrm.Utility.getAttributeValue(data[$v_1],"@search.entityname");if($v_2==="annotation"){var $v_3=Mscrm.Utility.getAttributeValue(data[$v_1],"objectid");if(articleid===$v_3){var $v_4=data[$v_1],$v_5=$v_4["@search.highlights"],$v_6=kbarticle["@search.highlights"],$v_7=$v_6["notetext"],$v_8=$v_6["documentbody"],$v_9=$v_5["notetext"],$v_A=$v_5["documentbody"];if(IsNull($v_7)&&!IsNull($v_9))$v_6["notetext"]=$v_9;else if(!IsNull($v_7)&&!IsNull($v_9))$v_6["notetext"]=$v_7.concat.apply($v_7,$v_9);if(IsNull($v_8)&&!IsNull($v_A))$v_6["documentbody"]=$v_A;else if(!IsNull($v_8)&&!IsNull($v_A))$v_6["documentbody"]=$v_8.concat.apply($v_8,$v_A);Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset[Mscrm.AdvancedRelevanceSearchInteraction.$8]=kbarticle;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount++;data[$v_1]=null;$v_0=true}}}$v_1++}}return $v_0};Mscrm.AdvancedRelevanceSearchInteraction.processAnnotations=function(searchControlData,annotations,retrievePostsCallback,request){var $v_0=request.get_parameters()["language"].toString();Mscrm.NotesHandler.$11(annotations,Mscrm.AdvancedRelevanceSearchInteraction.$m,$v_0,function($p1_0){if($p1_0&&$p1_0.length>0){var $v_1=true;Mscrm.AdvancedRelevanceSearchInteraction.updateKnowledgeArticleWithAnnotaion($p1_0,searchControlData,$v_1)}Mscrm.AdvancedRelevanceSearchInteraction.getRelevanceSearchResultSet(retrievePostsCallback);Mscrm.AdvancedRelevanceSearchInteraction.sanitizeSearchControlDataSet();if(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset)if(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length===10){Mscrm.AdvancedRelevanceSearchInteraction.$J(retrievePostsCallback);return}(!Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset||Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length<10)&&Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount>0&&Mscrm.AdvancedRelevanceSearchInteraction.processResponseEntities(retrievePostsCallback,request);if(!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount&&!Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount&&Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength>0&&!Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter){Mscrm.AdvancedRelevanceSearchInteraction.$J(retrievePostsCallback);return}else if((!Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset||Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length<10)&&Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter>0&&Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter){Mscrm.AdvancedRelevanceSearchInteraction.urlCall+="&$skip="+Math.min(Math.max(0,Mscrm.AdvancedRelevanceSearchInteraction.skipCounter*50),1e5).toString();var $v_2=Mscrm.CrmUri.create(Mscrm.AdvancedRelevanceSearchInteraction.urlCall);Mscrm.AdvancedRelevanceSearchInteraction.$Q($v_2,function($p2_0){Mscrm.AdvancedRelevanceSearchInteraction.$K($p2_0,retrievePostsCallback,request)},function($p2_0){Mscrm.AdvancedRelevanceSearchInteraction.$F($p2_0,retrievePostsCallback)})}})};Mscrm.AdvancedRelevanceSearchInteraction.getRelevanceSearchResultSet=function(retrievePostsCallback){if(Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge>0)Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount=Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge-Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount;else Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount=Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults.length-Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount;Mscrm.AdvancedRelevanceSearchInteraction.$T=Mscrm.AdvancedRelevanceSearchInteraction.$H+Mscrm.AdvancedRelevanceSearchInteraction.$U;Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength=Mscrm.AdvancedRelevanceSearchInteraction.skipCounter*50+Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount+Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount;Mscrm.AdvancedRelevanceSearchInteraction.processLocalStorageEntities(Mscrm.AdvancedRelevanceSearchInteraction.$T,Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength,Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount);if(!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount){Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.skipCounter++}Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter=Mscrm.AdvancedRelevanceSearchInteraction.$T-Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength};Mscrm.AdvancedRelevanceSearchInteraction.$J=function($p0){var $v_0=new Mscrm.RetrieveArticlePostResponse,$v_1=Mscrm.RelevanceSearchDataConverter.$o(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset);$v_0.posts=$v_1;$v_0.isSucceded=true;$v_0.morePosts=Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount>0||Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount>0?true:false;if(!IsNull(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset)&&!IsNull(Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset))if(!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount&&!Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount&&Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length!==Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length)$v_0.morePosts=true;if(Mscrm.AdvancedRelevanceSearchInteraction.$H>10)$v_0.total=Mscrm.AdvancedRelevanceSearchInteraction.$H;else if(!IsNull(Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset))$v_0.total=!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults&&!Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount&&(!Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset||!Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length||Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset.length===Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length)&&Mscrm.AdvancedRelevanceSearchInteraction.$P===1?Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset.length:11;else $v_0.total=0;Mscrm.AdvancedRelevanceSearchInteraction.$2=null;$p0($v_0);Mscrm.AdvancedRelevanceSearchInteraction.$9=Mscrm.DateTimeUtility.localDateTimeNow().toString();Mscrm.MetricsReporting.instance().addMetric("karelevancesearch",{requestType:"AdvancedRelevanceSearch",searchEndTime:Mscrm.AdvancedRelevanceSearchInteraction.$9,searchStartTime:Mscrm.AdvancedRelevanceSearchInteraction.$A,searchText:Mscrm.AdvancedRelevanceSearchInteraction.$B,status:"Success"})};Mscrm.AdvancedRelevanceSearchInteraction.$Q=function($p0,$p1,$p2){Mscrm.AdvancedRelevanceSearchInteraction.$1.cache=false;Mscrm.AdvancedRelevanceSearchInteraction.$1.type="GET";Mscrm.AdvancedRelevanceSearchInteraction.$1.dataType="json";Mscrm.AdvancedRelevanceSearchInteraction.$1.url=$p0.toString();Mscrm.AdvancedRelevanceSearchInteraction.$1.timeout=3e4;Mscrm.AdvancedRelevanceSearchInteraction.$2&&Number.parseInvariant(Mscrm.AdvancedRelevanceSearchInteraction.$2.readyState.toString())!==4&&Number.parseInvariant(Mscrm.AdvancedRelevanceSearchInteraction.$2.readyState.toString())&&Mscrm.AdvancedRelevanceSearchInteraction.$2.abort();var $v_0=$P_CRM.ajax(Mscrm.AdvancedRelevanceSearchInteraction.$1);Mscrm.AdvancedRelevanceSearchInteraction.$2=$v_0;Mscrm.AdvancedRelevanceSearchInteraction.$2.success(function($p1_0){$p1($p1_0)}).error(function($p1_0,$p1_1,$p1_2){$p2($p1_2)})};Mscrm.AdvancedRelevanceSearchInteraction.$K=function($p0,$p1,$p2){var $v_0="";$v_0=JSON.stringify($p0);if($v_0!==""){var $v_1={},$$t_8,$$t_9,$v_2=($$t_9=Mscrm.JsonUtilities.tryGetParsedJson($v_0,$$t_8={val:$v_1}),$v_1=$$t_8.val,$$t_9),$v_3=$v_1["facets"],$v_4=$v_3["@search.entityname"];Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray=new Array(2);Mscrm.AdvancedRelevanceSearchInteraction.getSearchFacets($v_4);Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=$v_1["value"];Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge=0}Mscrm.AdvancedRelevanceSearchInteraction.processResponseEntities($p1,$p2)};Mscrm.AdvancedRelevanceSearchInteraction.$F=function($p0,$p1){var $v_0=new Mscrm.RetrieveArticlePostResponse;$v_0.errorMessage=!isNullOrEmptyString($p0)?$p0:"";$v_0.isSucceded=false;$p1($v_0);Mscrm.AdvancedRelevanceSearchInteraction.$9=Mscrm.DateTimeUtility.localDateTimeNow().toString();$p0!=="abort"&&Mscrm.MetricsReporting.instance().addMetric("karelevancesearch",{requestType:"AdvancedRelevanceSearch",searchEndTime:Mscrm.AdvancedRelevanceSearchInteraction.$9,searchStartTime:Mscrm.AdvancedRelevanceSearchInteraction.$A,searchText:Mscrm.AdvancedRelevanceSearchInteraction.$B,status:$v_0.errorMessage})};Mscrm.AdvancedRelevanceSearchInteraction.jsonDataToArticlesCollection=function(jsonString){var $v_0={},$$t_4,$$t_5,$v_1=($$t_5=Mscrm.JsonUtilities.tryGetParsedJson(jsonString,$$t_4={val:$v_0}),$v_0=$$t_4.val,$$t_5),$v_2=null;if($v_0&&$v_0["value"])$v_2=$v_0["value"];return $v_2};Mscrm.AdvancedRelevanceSearchInteraction.prototype={$L_0:false,getArticleResponse:function(request,retrievePostsCallback){Mscrm.AdvancedRelevanceSearchInteraction.$P=request.get_parameters()["startpage"];Mscrm.AdvancedRelevanceSearchInteraction.$m=request.get_parameters()["articleFilter"];Mscrm.AdvancedRelevanceSearchInteraction.urlCall=request.get_parameters()["url"].toString();if(!Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount&&Mscrm.AdvancedRelevanceSearchInteraction.$P>1)request.get_parameters()["url"]+="&$skip="+Math.min(Math.max(0,Mscrm.AdvancedRelevanceSearchInteraction.skipCounter*50),1e5).toString();var $v_0=Mscrm.CrmUri.create(request.get_parameters()["url"]);if(IsNull($v_0.get_query()["_total_"])){!IsNull(request.get_parameters()["startpage"])&&request.set_pageNumber(request.get_parameters()["startpage"]);!IsNull(request.get_parameters()["pagesize"])&&request.set_pageSize(request.get_parameters()["pagesize"])}request.get_pageNumber()===1&&this.$1E_0();Mscrm.AdvancedRelevanceSearchInteraction.$G=request.get_pageSize();if(Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength>0)if(!Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter)this.$L_0=true;if(Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount<10&&!this.$L_0){Mscrm.AdvancedRelevanceSearchInteraction.$B=request.get_parameters()["searchString"].toString();Mscrm.AdvancedRelevanceSearchInteraction.$A=Mscrm.DateTimeUtility.localDateTimeNow().toString();var $$t_5=this,$$t_6=this;Mscrm.AdvancedRelevanceSearchInteraction.$Q($v_0,function($p1_0){Mscrm.AdvancedRelevanceSearchInteraction.$K($p1_0,retrievePostsCallback,request)},function($p1_0){Mscrm.AdvancedRelevanceSearchInteraction.$F($p1_0,retrievePostsCallback)})}else Mscrm.AdvancedRelevanceSearchInteraction.processResponseEntities(retrievePostsCallback,request)},$1E_0:function(){Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength=0;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray=null;Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter=0;Mscrm.AdvancedRelevanceSearchInteraction.skipCounter=0;Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler=0;Mscrm.AdvancedRelevanceSearchInteraction.$C=null;Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge=0;this.$L_0=false},validateConnection:function(urlToValidate,successCallback,failureCallback){throw Error.notImplemented("The method or operation is not implemented.")}};Mscrm.NotesHandler=function(){};Mscrm.NotesHandler.$11=function($p0,$p1,$p2,$p3){var $v_0=0,$v_1="statecode eq "+$p1,$v_2=$p0.length;if($p0){while($v_0<$v_2){var $v_5=$p0[$v_0],$v_6=Mscrm.Utility.getAttributeValue($v_5,"@search.entityname");if($v_6==="annotation")if($v_2===1)$v_1=$v_1+" and knowledgearticleid eq '"+Mscrm.Utility.getAttributeValue($v_5,"objectid")+"'";else if($v_0<$v_2-1)if(!$v_0)$v_1=$v_1+" and (knowledgearticleid eq '"+Mscrm.Utility.getAttributeValue($v_5,"objectid")+"' or ";else $v_1=$v_1+"knowledgearticleid eq '"+Mscrm.Utility.getAttributeValue($v_5,"objectid")+"' or ";else $v_1=$v_1+"knowledgearticleid eq '"+Mscrm.Utility.getAttributeValue($v_5,"objectid")+"')";$v_0++}$v_1+=" and languagelocaleid eq '"+$p2+"'"}var $v_3=String.format("/api/search/indexes/default/Entities?&api-version={0}&searchEntities={1}&$filter={2}",window.APPLICATION_VERSION,"knowledgearticle",$v_1),$v_4=Mscrm.CrmUri.create($v_3);Mscrm.NotesHandler.$14($v_4,$p3)};Mscrm.NotesHandler.$14=function($p0,$p1){Mscrm.NotesHandler.$Q($p0,function($p1_0){Mscrm.NotesHandler.$r($p1_0,$p1)},function($p1_0){Mscrm.NotesHandler.$F($p1_0)})};Mscrm.NotesHandler.$Q=function($p0,$p1,$p2){var $v_0=new jQueryAjaxOptions;$v_0.cache=true;$v_0.type="GET";$v_0.dataType="json";$v_0.url=$p0.toString();$v_0.timeout=3e4;$P_CRM.ajax($v_0).success(function($p1_0){$p1($p1_0)}).error(function($p1_0,$p1_1,$p1_2){$p2($p1_2)})};Mscrm.NotesHandler.$r=function($p0,$p1){var $v_0={},$v_1="";$v_1=JSON.stringify($p0);var $$t_6,$$t_7,$v_2=($$t_7=Mscrm.JsonUtilities.tryGetParsedJson($v_1,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7),$v_3=$v_0["value"];$p1($v_3)};Mscrm.NotesHandler.$F=function($p0){var $v_0=null;return $v_0};Mscrm.RelevanceSearchDataConverter=function(){};Mscrm.RelevanceSearchDataConverter.$o=function($p0){var $v_0=null;if($p0&&$p0.length>0){$v_0=new Array($p0.length);var $v_1=0;while($v_1<$p0.length){var $v_2=$p0[$v_1],$v_3=new Mscrm.ArticlePost,$v_4=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"description"),$v_5=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"content"),$v_6=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"articlepublicnumber"),$v_7=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"@search.objectid"),$v_8=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"title"),$v_9=Mscrm.RelevanceSearchDataConverter.$b($v_2,"createdon"),$v_A=Mscrm.RelevanceSearchDataConverter.$b($v_2,"modifiedon"),$v_B=Mscrm.RelevanceSearchDataConverter.$18($v_2,"statecode"),$v_C=Mscrm.RelevanceSearchDataConverter.$b($v_2,"expirationdate"),$v_D=Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_2,"knowledgearticleviews");$v_3.articleId=!isNullOrEmptyString($v_6)&&!isNullOrEmptyString($v_7)?$v_6+"_"+$v_7:"";$v_3.articleUId=!isNullOrEmptyString($v_7)?$v_7:"";$v_3.question=!isNullOrEmptyString($v_8)?$v_8:"";$v_3.description=!isNullOrEmptyString($v_4)?$v_4:"";$v_3.set_answer(!isNullOrEmptyString($v_5)?$v_5:"");$v_3.lastModifiedOn=$v_A?$v_A:null;$v_3.createdOn=$v_9?$v_9:null;$v_3.stateCode=!isNullOrEmptyString($v_B.toString())?$v_B:0;$v_3.published=!isNullOrEmptyString($v_B.toString())?$v_B===3:false;$v_3.sanitized=true;$v_3.timesViewed=!isNullOrEmptyString($v_D)?Number.parseInvariant($v_D):0;$v_3.expiredDate=$v_C?$v_C:null;$v_3.searchBlurb=Mscrm.RelevanceSearchDataConverter.$13($v_2);$v_0[$v_1]=$v_3;$v_1++}}return $v_0};Mscrm.RelevanceSearchDataConverter.$13=function($p0){for(var $v_0="",$v_1=$p0["@search.highlights"],$v_2=true,$v_3=["notetext","documentbody","content","keywords"],$v_4=0;$v_4<$v_3.length;$v_4++)if(!IsNull($v_1[$v_3[$v_4]])&&$v_3[$v_4] in $v_1){$v_0=$v_2?$v_0:$v_0+"...";var $v_5=$v_1[$v_3[$v_4]];$v_0+=Mscrm.RelevanceSearchDataConverter.$15($v_5);$v_2=false}return $v_0};Mscrm.RelevanceSearchDataConverter.$15=function($p0){var $v_0="",$v_1=CrmEncodeDecode.CrmHtmlEncode("{crmhit}"),$v_2=CrmEncodeDecode.CrmHtmlEncode("{/crmhit}");if($p0&&$p0.length>0)for(var $v_3=0;$p0.length>$v_3;$v_3++){var $v_4=$p0[$v_3].toString().replace(new RegExp("<[^>]+>|&nbsp;","g"),"");$v_4=CrmEncodeDecode.CrmHtmlEncode($v_4);while($v_4.indexOf($v_1)>=0)$v_4=$v_4.replace($v_1,"<em>");while($v_4.indexOf($v_2)>=0)$v_4=$v_4.replace($v_2,"</em>");if($v_3<$p0.length-1)$v_4+="...";$v_0+=$v_4}return $v_0};Mscrm.RelevanceSearchDataConverter.$b=function($p0,$p1){var $v_0;if($p0&&$p0[$p1]){$v_0=ParseDateTime($p0[$p1].toString());$v_0.setMinutes($v_0.getMinutes()+$v_0.getTimezoneOffset()+window.ORG_TIMEZONE_OFFSET);return $v_0}return null};Mscrm.RelevanceSearchDataConverter.getAttributeValue=function($p0,$p1){if($p0&&$p0[$p1])return $p0[$p1].toString();return ""};Mscrm.RelevanceSearchDataConverter.$18=function($p0,$p1){var $v_0={};$v_0=$p0[$p1];if(!Mscrm.RelevanceSearchDataConverter.$6){Mscrm.RelevanceSearchDataConverter.$Z=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllDraftArticles");Mscrm.RelevanceSearchDataConverter.$V=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllApprovedArticles");Mscrm.RelevanceSearchDataConverter.$h=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllPublishedArticles");Mscrm.RelevanceSearchDataConverter.$k=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllScheduledArticles");Mscrm.RelevanceSearchDataConverter.$a=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllExpiredArticles");Mscrm.RelevanceSearchDataConverter.$W=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllArchivedArticles");Mscrm.RelevanceSearchDataConverter.$n=Microsoft.Crm.Client.Core.Framework.Common.ResourceManager.getLocalizedString("SearchWidget.Mobile.Filters.AllTrashedArticles");Mscrm.RelevanceSearchDataConverter.$6={};Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$Z]=0;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$V]=1;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$k]=2;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$h]=3;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$a]=4;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$W]=5;Mscrm.RelevanceSearchDataConverter.$6[Mscrm.RelevanceSearchDataConverter.$n]=6}return $p0&&$p0[$p1]&&Mscrm.RelevanceSearchDataConverter.$6?Mscrm.RelevanceSearchDataConverter.$6[$v_0["0"].toString()]:3};Mscrm.SimpleRelevanceSearchInteraction=function(){};Mscrm.SimpleRelevanceSearchInteraction.$Q=function($p0,$p1,$p2){Mscrm.SimpleRelevanceSearchInteraction.$1.cache=false;Mscrm.SimpleRelevanceSearchInteraction.$1.type="GET";Mscrm.SimpleRelevanceSearchInteraction.$1.dataType="json";Mscrm.SimpleRelevanceSearchInteraction.$1.url=$p0.toString();Mscrm.SimpleRelevanceSearchInteraction.$1.timeout=3e4;Mscrm.SimpleRelevanceSearchInteraction.$2&&Number.parseInvariant(Mscrm.SimpleRelevanceSearchInteraction.$2.readyState.toString())!==4&&Number.parseInvariant(Mscrm.SimpleRelevanceSearchInteraction.$2.readyState.toString())&&Mscrm.SimpleRelevanceSearchInteraction.$2.abort();var $v_0=$P_CRM.ajax(Mscrm.SimpleRelevanceSearchInteraction.$1);Mscrm.SimpleRelevanceSearchInteraction.$2=$v_0;Mscrm.SimpleRelevanceSearchInteraction.$2.success(function($p1_0){$p1($p1_0)}).error(function($p1_0,$p1_1,$p1_2){$p2($p1_2)})};Mscrm.SimpleRelevanceSearchInteraction.$K=function($p0,$p1,$p2){var $v_0="";$v_0=JSON.stringify($p0);var $v_1={},$v_2=null,$$t_D,$$t_E,$v_3=($$t_E=Mscrm.JsonUtilities.tryGetParsedJson($v_0,$$t_D={val:$v_1}),$v_1=$$t_D.val,$$t_E),$v_4=$v_1["facets"],$v_5=$v_4["@search.entityname"],$v_6=new Mscrm.RetrieveArticlePostResponse,$v_7=null,$v_8=null;if($v_1&&$v_1["value"]){$v_2=$v_1["value"];$v_7=new Array($v_2.length);$v_7=Mscrm.RelevanceSearchDataConverter.$o($v_2)}for(var $v_9=0;$v_9<$v_5.length;$v_9++)if($v_5[$v_9]["Value"].toString()==="knowledgearticle"){$v_8=$v_5[$v_9];break}$v_6.total=!isNullOrEmptyString(Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_8,"Count"))?Number.parseInvariant(Mscrm.RelevanceSearchDataConverter.getAttributeValue($v_8,"Count")):0;$v_6.results=$v_2.length;$v_6.pageSize=$p2.get_pageSize();$v_6.isSucceded=true;$v_6.posts=$v_7;Mscrm.SimpleRelevanceSearchInteraction.$2=null;$p1($v_6);Mscrm.SimpleRelevanceSearchInteraction.$9=Mscrm.DateTimeUtility.localDateTimeNow().toString();Mscrm.MetricsReporting.instance().addMetric("karelevancesearch",{requestType:"SimpleRelevanceSearch",searchEndTime:Mscrm.SimpleRelevanceSearchInteraction.$9,searchStartTime:Mscrm.SimpleRelevanceSearchInteraction.$A,searchText:Mscrm.SimpleRelevanceSearchInteraction.$B,status:"Success"})};Mscrm.SimpleRelevanceSearchInteraction.$F=function($p0,$p1){var $v_0=new Mscrm.RetrieveArticlePostResponse;$v_0.errorMessage=!isNullOrEmptyString($p0)?$p0:"";$v_0.isSucceded=false;$p1($v_0);Mscrm.SimpleRelevanceSearchInteraction.$9=Mscrm.DateTimeUtility.localDateTimeNow().toString();$p0!=="abort"&&Mscrm.MetricsReporting.instance().addMetric("karelevancesearch",{requestType:"SimpleRelevanceSearch",searchEndTime:Mscrm.SimpleRelevanceSearchInteraction.$9,searchStartTime:Mscrm.SimpleRelevanceSearchInteraction.$A,searchText:Mscrm.SimpleRelevanceSearchInteraction.$B,status:$v_0.errorMessage})};Mscrm.SimpleRelevanceSearchInteraction.prototype={getArticleResponse:function(request,retrievePostsCallback){var $v_0=Mscrm.CrmUri.create(request.get_parameters()["url"]);if(IsNull($v_0.get_query()["_total_"])){!IsNull(request.get_parameters()["startpage"])&&request.set_pageNumber(request.get_parameters()["startpage"]);!IsNull(request.get_parameters()["pagesize"])&&request.set_pageSize(request.get_parameters()["pagesize"])}Mscrm.SimpleRelevanceSearchInteraction.$B=request.get_parameters()["searchString"].toString();Mscrm.SimpleRelevanceSearchInteraction.$A=Mscrm.DateTimeUtility.localDateTimeNow().toString();var $$t_5=this,$$t_6=this;Mscrm.SimpleRelevanceSearchInteraction.$Q($v_0,function($p1_0){Mscrm.SimpleRelevanceSearchInteraction.$K($p1_0,retrievePostsCallback,request)},function($p1_0){Mscrm.SimpleRelevanceSearchInteraction.$F($p1_0,retrievePostsCallback)})},validateConnection:function(urlToValidate,successCallback,failureCallback){throw Error.notImplemented("The method or operation is not implemented.")}};Mscrm.Utility=function(){};Mscrm.Utility.getStateCode=function(request){var $v_0=3;if(Mscrm.InternalUtilities.JSTypes.isNull(request.get_parameters()["articleFilter"]))return $v_0;$v_0=Number.parseInvariant(request.get_parameters()["articleFilter"].toString());return $v_0};Mscrm.Utility.getDateString=function(dictionary,attribute){var $v_0;if(dictionary&&dictionary[attribute]){$v_0=ParseDateTime(dictionary[attribute].toString());$v_0.setMinutes($v_0.getMinutes()+window.ORG_TIMEZONE_OFFSET);return $v_0}return null};Mscrm.Utility.getAttributeText=function(dictionary,attribute){if(dictionary&&dictionary[attribute])return dictionary[attribute]["#text"].toString();return ""};Mscrm.Utility.getAttributeValue=function(dictionary,attribute){if(dictionary&&dictionary[attribute])return dictionary[attribute].toString();return ""};Type.registerNamespace("Mscrm.SearchWidgetControl.Runtime");Mscrm.SearchWidgetControl.Runtime.AuthenticationService=function(){};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$$cctor=function(){$P_CRM(window).unload(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.dispose)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.dispose=function(unloadEvent){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=null;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$x()};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.ping=function(){var $v_0=Mscrm.ExternalProviderFactory.getClient("parature");!IsNull($v_0)&&$v_0.validateConnection(Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_validationUri(),null,null)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$19=function(){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5=$P_CRM("<iframe style='display:none;' />");$P_CRM("body").append(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5);Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.on("load",function(){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1C()});Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D=Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_baseUri();Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.attr("src",Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1C=function(){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$I=window.setTimeout(function(){if(!IsNull(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4)){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4.reject(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$v);Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=null}window.clearTimeout(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$I)},Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$i);Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1F()};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1D=function(){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.removeAttr("src");Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.attr("src",Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1F=function(){var $v_0=Mscrm.ExternalProviderFactory.getClient("parature");!IsNull($v_0)&&$v_0.validateConnection(Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_validationUri(),function(){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$R(true,null)},function($p1_0,$p1_1){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$y($p1_0,$p1_1)})};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$y=function($p0,$p1){if(!Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$O)Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$R(false,null);else if(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1A($p0,$p1)){var $v_0=isNullOrEmptyString($p1)?$p0:$p1;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$R(false,$v_0)}else window.setTimeout(function(){var $v_1=isNullOrEmptyString($p1)?$p0:$p1;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$R(false,$v_1)},Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$i)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1A=function($p0,$p1){return $p0==="500"||$p0==="501"||$p1===Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$p||$p1===Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$q||$p1===Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$s||$p1===Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$t};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$R=function($p0,$p1){if(IsNull(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4))return;window.clearTimeout(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$I);if(!Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$O||isNullOrEmptyString($p1))Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4.resolve($p0);else Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4.reject($p1)};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.get_checkSignedIn=function(){if(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D!==Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_baseUri()){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=null;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D=Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_baseUri()}if(IsNull(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4)){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=jQueryApi.jQueryDeferredFactory.Deferred(Boolean,String);if(IsNull(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5))Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$19();else Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$1D();Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4.always(function($p1_0){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=null})}return Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4.promise()};Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$x=function(){if(!IsNull(Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5)){Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.unbind("load");Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5.remove();Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5=null;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D=""}};Mscrm.SearchWidgetControl.Runtime.UrlUtility=function(){};Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_externalServiceUri=function(){return Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E};Mscrm.SearchWidgetControl.Runtime.UrlUtility.set_externalServiceUri=function(value){Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E=value;return value};Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_baseUri=function(){return Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E.get_scheme()+"://"+Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E.get_host()};Mscrm.SearchWidgetControl.Runtime.UrlUtility.get_validationUri=function(){return Mscrm.CrmUri.create(Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E+"/schema")};Mscrm.ArticlePost.registerClass("Mscrm.ArticlePost",null,Mscrm.IArticlePost,Wall.Interfaces.IPost);Mscrm.ExternalProviderFactory.registerClass("Mscrm.ExternalProviderFactory");Mscrm.ParatureConverter.registerClass("Mscrm.ParatureConverter");Mscrm.ParatureJsonData.registerClass("Mscrm.ParatureJsonData");Mscrm.ParatureEntityData.registerClass("Mscrm.ParatureEntityData");Mscrm.ParatureArticleData.registerClass("Mscrm.ParatureArticleData");Mscrm.ParatureArticle.registerClass("Mscrm.ParatureArticle");Mscrm.ParatureArticleFolder.registerClass("Mscrm.ParatureArticleFolder");Mscrm.ParatureAttributeData.registerClass("Mscrm.ParatureAttributeData");Mscrm.ParatureInteraction.registerClass("Mscrm.ParatureInteraction",null,Mscrm.IExternalInteractionProvider);Mscrm.CrmNativeSearchInteraction.registerClass("Mscrm.CrmNativeSearchInteraction",null,Mscrm.IExternalInteractionProvider);Mscrm.RetrieveArticlePostRequest.registerClass("Mscrm.RetrieveArticlePostRequest",null,Mscrm.IRetrieveArticlePostRequest,Wall.Interfaces.IRetrievePostsRequest);Mscrm.RetrieveArticlePostResponse.registerClass("Mscrm.RetrieveArticlePostResponse",null,Mscrm.IRetrieveArticlePostResponse,Wall.Interfaces.IRetrievePostsResponse);Mscrm.AdvancedRelevanceSearchInteraction.registerClass("Mscrm.AdvancedRelevanceSearchInteraction",null,Mscrm.IExternalInteractionProvider);Mscrm.NotesHandler.registerClass("Mscrm.NotesHandler");Mscrm.RelevanceSearchDataConverter.registerClass("Mscrm.RelevanceSearchDataConverter");Mscrm.SimpleRelevanceSearchInteraction.registerClass("Mscrm.SimpleRelevanceSearchInteraction",null,Mscrm.IExternalInteractionProvider);Mscrm.Utility.registerClass("Mscrm.Utility");Mscrm.SearchWidgetControl.Runtime.AuthenticationService.registerClass("Mscrm.SearchWidgetControl.Runtime.AuthenticationService");Mscrm.SearchWidgetControl.Runtime.UrlUtility.registerClass("Mscrm.SearchWidgetControl.Runtime.UrlUtility");Mscrm.AdvancedRelevanceSearchInteraction.searchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResults=null;Mscrm.AdvancedRelevanceSearchInteraction.searchEntitiesArray=null;Mscrm.AdvancedRelevanceSearchInteraction.nextSearchControlDataset=null;Mscrm.AdvancedRelevanceSearchInteraction.$C=null;Mscrm.AdvancedRelevanceSearchInteraction.$8=0;Mscrm.AdvancedRelevanceSearchInteraction.processedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.unProcessedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.localStorageForUnprocessedRelevanceSearchResultsCount=0;Mscrm.AdvancedRelevanceSearchInteraction.totalProcessedJsonLength=0;Mscrm.AdvancedRelevanceSearchInteraction.$G=0;Mscrm.AdvancedRelevanceSearchInteraction.entitiesCounter=0;Mscrm.AdvancedRelevanceSearchInteraction.skipCounter=0;Mscrm.AdvancedRelevanceSearchInteraction.annotationsCountForNoteHandler=0;Mscrm.AdvancedRelevanceSearchInteraction.$m=0;Mscrm.AdvancedRelevanceSearchInteraction.totalEntitiesBeforeMerge=0;Mscrm.AdvancedRelevanceSearchInteraction.$S="";Mscrm.AdvancedRelevanceSearchInteraction.urlCall="";Mscrm.AdvancedRelevanceSearchInteraction.$B="";Mscrm.AdvancedRelevanceSearchInteraction.$A="";Mscrm.AdvancedRelevanceSearchInteraction.$9="";Mscrm.AdvancedRelevanceSearchInteraction.$T=0;Mscrm.AdvancedRelevanceSearchInteraction.$H=0;Mscrm.AdvancedRelevanceSearchInteraction.$U=0;Mscrm.AdvancedRelevanceSearchInteraction.$P=0;Mscrm.AdvancedRelevanceSearchInteraction.$1=new jQueryAjaxOptions;Mscrm.AdvancedRelevanceSearchInteraction.$2=$P_CRM.ajax(Mscrm.AdvancedRelevanceSearchInteraction.$1);Mscrm.NotesHandler.searchentities="knowledgearticle";Mscrm.RelevanceSearchDataConverter.$Z=null;Mscrm.RelevanceSearchDataConverter.$V=null;Mscrm.RelevanceSearchDataConverter.$h=null;Mscrm.RelevanceSearchDataConverter.$k=null;Mscrm.RelevanceSearchDataConverter.$a=null;Mscrm.RelevanceSearchDataConverter.$W=null;Mscrm.RelevanceSearchDataConverter.$n=null;Mscrm.RelevanceSearchDataConverter.$6=null;Mscrm.SimpleRelevanceSearchInteraction.$B="";Mscrm.SimpleRelevanceSearchInteraction.$A="";Mscrm.SimpleRelevanceSearchInteraction.$9="";Mscrm.SimpleRelevanceSearchInteraction.$1=new jQueryAjaxOptions;Mscrm.SimpleRelevanceSearchInteraction.$2=$P_CRM.ajax(Mscrm.SimpleRelevanceSearchInteraction.$1);Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$4=null;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$5=null;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$D="";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$I=0;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$O=window._bIsOsdpOrg||window.IsCorsEnabledForKmControl;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$i=Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$O?6e4:3e4;Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$v="408";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$s="C6002";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$p="C6003";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$q="C6004";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$t="C6009";Mscrm.SearchWidgetControl.Runtime.AuthenticationService.$$cctor();Mscrm.SearchWidgetControl.Runtime.UrlUtility.$E=null