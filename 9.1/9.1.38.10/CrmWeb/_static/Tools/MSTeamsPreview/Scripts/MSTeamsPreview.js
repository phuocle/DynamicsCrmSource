Type.registerNamespace("Microsoft.Crm.Tools.MSTeamsPreview.Scripts");Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SharePointDeploymentType=function(){};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SharePointDeploymentType.prototype={online:0,onPremises:1};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SharePointDeploymentType.registerEnum("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SharePointDeploymentType",false);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest=function(){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest.initializeBase(this)};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest.prototype={getMetadata:function(){var $v_0=new XrmClientApi.WebApi.ODataContractMetadata;$v_0.boundParameter=null;$v_0.parameterTypes={};$v_0.operationName="msdyn_EnableSharePoint";$v_0.operationType=0;return $v_0}};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointResponse=function(){};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointResponse.prototype={OperationResult:false};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper=function(){};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.hideConfimationMessageAndFooterButton=function(){$get("divWarning").style.display="none";$get("butBegin").disabled=true};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.showLoader=function(informationContainerStyle,processingIndicatorContainerStyle,processingIndicatorElementStyle,ProcessingDescriptionMessage){var $v_0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$9(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$H,informationContainerStyle,""),$v_1=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$9(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$P,processingIndicatorContainerStyle,"");$v_1.appendChild(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$T(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$C,Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$I,processingIndicatorElementStyle,""));$v_0.appendChild($v_1);$v_0.appendChild(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$9(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$B,null,ProcessingDescriptionMessage));var $v_2=$get("DlgHdBodyContainer");$v_2.appendChild($v_0)};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.setMessages=function(successDescriptionMessage,finishButtonText,failedDescriptionMessage,failedHelpDescriptionMessage,sharePointErrorDescriptionMessage){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$7=successDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$6=finishButtonText;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$4=failedDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$5=failedHelpDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$F=sharePointErrorDescriptionMessage};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.enableSharePointForMSTeams=function(entityLogicalNameList){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-3.6.0.min.js"),true);var $v_0=jQueryApi.jQueryDeferredFactory.Deferred(Boolean,Boolean);if(!Xrm.Internal.isFeatureEnabled(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$Q)){var $v_1=new Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest;Xrm.WebApi.execute($v_1).then(function($p1_0){try{var $v_2=JSON.parse($p1_0["responseText"].toString());if($v_2.OperationResult)Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$3(entityLogicalNameList,$v_0);else{Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$v_0.resolve(false)}}catch($v_3){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$v_0.resolve(false)}},function($p1_0){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0=$p1_0.errorCode.toString(16);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$v_0.resolve(false)})}else{var $v_4=Xrm.Utility.getGlobalContext().organizationSettings;if($v_4.attributes&&$v_4.attributes["sharePointDeploymentType"]===0)Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$3(entityLogicalNameList,$v_0);else if(!$v_4.attributes&&window.ORG_SHAREPOINT_DEPLOYMENTTYPE===0)Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$3(entityLogicalNameList,$v_0);else{Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$X();return $v_0.resolve(false)}}return $v_0.promise()};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$3=function($p0,$p1){var $v_0=new Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest(true,$p0);Xrm.WebApi.execute($v_0).then(function($p1_0){try{var $v_1=JSON.parse($p1_0["responseText"].toString());if($v_1.OperationResult){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$R();$p1.resolve(true)}else{Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$2.push($v_1.FailedLogicalEntityNames);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$W($p1)}}catch($v_2){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$p1.resolve(false)}},function($p1_0){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0=$p1_0.errorCode.toString(16);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$p1.resolve(false)})};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$W=function($p0){if(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$D>0&&Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$2.length>0){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$D--;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$V($p0)}else{Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1();$p0.resolve(false)}};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$V=function($p0){Array.forEach(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$2,function($p1_0){var $v_0=$p1_0;$v_0=JSON.stringify($v_0.slice(1,$v_0.length-1).split(","));Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$3($v_0,$p0)});Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$2.length=0};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$R=function(){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$8(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$S,Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$7);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$E(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$6)};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1=function(){if(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0==="")Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$G;var $v_0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$4;if(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0==="800503ca")$v_0=$v_0+" Error Code: 800503ca";else $v_0=$v_0+"</br>"+String.format(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$5,Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$8(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$A,$v_0);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$E(null)};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$X=function(){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$8(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$A,Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$F);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$E(null)};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.showCustomFailureMessage=function(failedDescriptionMessage,failedHelpDescriptionMessage,advancedFeatureName){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.hideConfimationMessageAndFooterButton();Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$U(advancedFeatureName);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$4=failedDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$5=failedHelpDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$1()};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.showCustomSuccessMessage=function(successDescriptionMessage,finishButtonText){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.hideConfimationMessageAndFooterButton();Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$7=successDescriptionMessage;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$6=finishButtonText;Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$R()};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$U=function($p0){var $v_0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$G;if($p0===Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$K)$v_0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$L;else if($p0===Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$N)$v_0=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$O;return $v_0};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$8=function($p0,$p1){var $v_0=$get(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$C);$v_0.setAttribute("src",$p0);$v_0.style.marginBottom=Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$J;$get(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$B).innerHTML=$p1};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.logMSTeamsCollabTelemetry=function(eventName,eventDetails){Mscrm.MetricsReporting.instance().addMetric(Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$M,{eventName:eventName,eventDetails:eventDetails})};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$E=function($p0){$get("cmdDialogCancel").style.display="none";var $v_0=$get("butBegin");if($p0){$v_0.innerText=$p0;$v_0.setAttribute("title",$p0)}$v_0.style.display="initial";$v_0.style.marginRight="30px";$v_0.disabled=false};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$9=function($p0,$p1,$p2){var $v_0=document.createElement("div");$v_0.id=$p0;$v_0.setAttribute("className",$p0);$v_0.innerText=$p2;$v_0.setAttribute("tabindex","-1");$v_0.className=$p1;return $v_0};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$T=function($p0,$p1,$p2,$p3){var $v_0=document.createElement("img");$v_0.id=$p0;$v_0.setAttribute("className",$p0);$v_0.setAttribute("src",$p1);$v_0.setAttribute("alt",$p3);$v_0.setAttribute("tabindex","-1");$v_0.className=$p2;return $v_0};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest=function(enable,logicalEntityNames){Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest.initializeBase(this);this.Enable=enable;this.LogicalEntityNames=logicalEntityNames};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest.prototype={Enable:false,LogicalEntityNames:null,getMetadata:function(){var $v_0=new XrmClientApi.WebApi.ODataContractMetadata;$v_0.boundParameter=null;var $v_1={};$v_1["typeName"]="Edm.Boolean";$v_1["structuralProperty"]=1;var $v_2={};$v_2["typeName"]="Edm.String";$v_2["structuralProperty"]=1;$v_0.parameterTypes={};$v_0.parameterTypes["Enable"]=$v_1;$v_0.parameterTypes["LogicalEntityNames"]=$v_2;$v_0.operationName="msdyn_SetTeamsDocumentStatus";$v_0.operationType=0;return $v_0}};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusResponse=function(){};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusResponse.prototype={OperationResult:false,PassedLogicalEntityNames:null,FailedLogicalEntityNames:null};Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest.registerClass("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointRequest",XrmClientApi.WebApi.ODataContract);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointResponse.registerClass("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.EnableSharePointResponse");Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.registerClass("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper");Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest.registerClass("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusRequest",XrmClientApi.WebApi.ODataContract);Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusResponse.registerClass("Microsoft.Crm.Tools.MSTeamsPreview.Scripts.SetTeamsDocumentStatusResponse");Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$H="informationContainer";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$B="informationDescriptionContainer";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$C="processingIndicatorElement";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$P="processingIndicatorContainer";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$I="/_imgs/AdvFind/progress.gif";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$A="/_imgs/BusinessRuleEditor/erroricon.png";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$S="/_imgs/SMB_Map_Success_16.png";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$Q="FCB.SharePointS2S";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$J="12px";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$G="80060719";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$L="80060720";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$O="80060721";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$0="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$K="MSTeamsCollaborationPreview";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$N="MSTeamsUserSyncPreview";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$M="msteamscollabevents";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$7="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$6="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$4="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$5="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$F="";Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$2=[];Microsoft.Crm.Tools.MSTeamsPreview.Scripts.MSTeamsPreviewHelper.$D=3