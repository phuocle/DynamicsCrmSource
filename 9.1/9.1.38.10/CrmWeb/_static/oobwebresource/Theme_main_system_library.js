Type.registerNamespace("Mscrm");Mscrm.ThemeMainSystemLibraryWebResource=function(){};Mscrm.ThemeMainSystemLibraryWebResource.formOnLoad=function(){var $v_0=["navbarbackgroundcolor","navbarshelfcolor","headercolor","globallinkcolor","selectedlinkeffect","hoverlinkeffect","processcontrolcolor","defaultentitycolor","controlshade","controlborder","defaultcustomentitycolor","backgroundcolor","pageheaderbackgroundcolor","panelheaderbackgroundcolor","maincolor","accentcolor"];Mscrm.ThemeMainSystemLibraryWebResource.$3();for(var $v_1=["navbarshelfcolor","processcontrolcolor","defaultentitycolor","controlshade","controlborder","defaultcustomentitycolor","maincolor"],$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2],$v_4=Xrm.Page.data.entity.attributes.get($v_3),$v_5=$v_4.getValue();Mscrm.ThemeMainSystemLibraryWebResource.$0($v_3,Mscrm.ThemeMainSystemLibraryWebResource.$2($v_3,$v_5))}if(Xrm.Page.ui.getFormType()===1)return;for(var $v_6=0;$v_6<$v_0.length;$v_6++){var $v_7=$v_0[$v_6],$v_8=Xrm.Page.data.entity.attributes.get($v_7),$v_9=$v_8.getValue();if($v_7==="navbarbackgroundcolor"||$v_7==="headercolor"||$v_7==="globallinkcolor"||$v_7==="selectedlinkeffect"||$v_7==="hoverlinkeffect"||$v_7==="pageheaderbackgroundcolor"||$v_7==="panelheaderbackgroundcolor"||$v_7==="maincolor"||$v_7==="accentcolor"){var $v_A=Xrm.Page.data.entity.attributes.get("navbarbackgroundcolor"),$v_B=$v_A.getValue();Mscrm.ThemeMainSystemLibraryWebResource.$0($v_7,$v_9!==$v_B?$v_9:Mscrm.ThemeMainSystemLibraryWebResource.$2($v_7,$v_B))}else Mscrm.ThemeMainSystemLibraryWebResource.$0($v_7,$v_9)}};Mscrm.ThemeMainSystemLibraryWebResource.$3=function(){if(!Xrm.Internal.isFeatureEnabled("FCB.WebClientVisualRefresh")){var $v_0=$get("panelheaderbackgroundcolor_c");if($v_0&&$v_0.parentNode)$v_0.parentNode.style.display="none";var $v_1=$get("pageheaderbackgroundcolor_c");if($v_1&&$v_1.parentNode)$v_1.parentNode.style.display="none"}};Mscrm.ThemeMainSystemLibraryWebResource.colorValueChanged=function(context){var $v_0=context.getEventSource();if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_1=$v_0.getName(),$v_2=$v_0.getValue();if(!Mscrm.ThemeMainSystemLibraryWebResource.$5($v_1,$v_2))return;if($v_1==="navbarbackgroundcolor"&&$v_2){var $v_3=Xrm.Page.data.entity.attributes.get("navbarbackgroundcolor");$v_3.setValue($v_2.toUpperCase());Mscrm.ThemeMainSystemLibraryWebResource.$0("navbarbackgroundcolor",$v_2);var $v_4=Xrm.Page.data.entity.attributes.get("globallinkcolor");$v_4.setValue($v_2.toUpperCase());Mscrm.ThemeMainSystemLibraryWebResource.$0("globallinkcolor",$v_2);var $v_5=Xrm.Page.data.entity.attributes.get("headercolor");$v_5.setValue($v_2);Mscrm.ThemeMainSystemLibraryWebResource.$0("headercolor",$v_2);for(var $v_6=["selectedlinkeffect","hoverlinkeffect","pageheaderbackgroundcolor","panelheaderbackgroundcolor"],$v_7=0;$v_7<$v_6.length;$v_7++){var $v_8=$v_6[$v_7],$v_9=Xrm.Page.data.entity.attributes.get($v_8);Mscrm.ThemeMainSystemLibraryWebResource.$0($v_8,Mscrm.ThemeMainSystemLibraryWebResource.$2($v_8,$v_2))}}else if(($v_1==="headercolor"||$v_1==="globallinkcolor")&&!$v_2){var $v_A=Xrm.Page.data.entity.attributes.get("navbarbackgroundcolor"),$v_B=$v_A.getValue();if($v_B){var $v_C=Xrm.Page.data.entity.attributes.get($v_1);$v_C.setValue($v_B.toUpperCase());Mscrm.ThemeMainSystemLibraryWebResource.$0($v_1,$v_B)}}else Mscrm.ThemeMainSystemLibraryWebResource.$0($v_1,Mscrm.ThemeMainSystemLibraryWebResource.$2($v_1,$v_2))}};Mscrm.ThemeMainSystemLibraryWebResource.$2=function($p0,$p1){switch($p0){case "navbarshelfcolor":$p1=!$p1?"FFFFFF":$p1;break;case "processcontrolcolor":$p1=!$p1?"41A053":$p1;break;case "defaultentitycolor":$p1=!$p1?"666666":$p1;break;case "defaultcustomentitycolor":$p1=!$p1?"00CCA3":$p1;break;case "controlshade":$p1=!$p1?"FFFFFF":$p1;break;case "controlborder":$p1=!$p1?"BDC3C7":$p1;break;case "selectedlinkeffect":$p1=Mscrm.ThemeMainSystemLibraryWebResource.$1($p0,$p1,.5);break;case "hoverlinkeffect":$p1=Mscrm.ThemeMainSystemLibraryWebResource.$1($p0,$p1,.75);break;case "pageheaderbackgroundcolor":$p1=Mscrm.ThemeMainSystemLibraryWebResource.$1($p0,$p1,.9);break;case "panelheaderbackgroundcolor":$p1=Mscrm.ThemeMainSystemLibraryWebResource.$1($p0,$p1,.96);break;case "maincolor":$p1=!$p1?"000000":$p1;break}var $v_0=Xrm.Page.data.entity.attributes.get($p0);$v_0.setValue($p1);return $p1};Mscrm.ThemeMainSystemLibraryWebResource.$1=function($p0,$p1,$p2){var $v_0=Xrm.Page.data.entity.attributes.get($p0),$v_1=$v_0.getValue();if($v_1==="#000000"||$v_1==="000000"||!$v_1){var $v_2=Xrm.Page.data.entity.attributes.get("navbarbackgroundcolor"),$v_3=$v_2.getValue();if($v_3){$v_3=$v_3.startsWith("#")?$v_3.substr(1):$v_3;var $v_4=parseInt($v_3.substring(0,2),16),$v_5=parseInt($v_3.substring(2,4),16),$v_6=parseInt($v_3.substring(4,6),16);return Mscrm.ThemeMainSystemLibraryWebResource.$4($v_4,$v_5,$v_6,$p2)}}return $v_1};Mscrm.ThemeMainSystemLibraryWebResource.$4=function($p0,$p1,$p2,$p3){$p0=Math.round((1-$p3)*$p0+$p3*255);$p1=Math.round((1-$p3)*$p1+$p3*255);$p2=Math.round((1-$p3)*$p2+$p3*255);var $v_0=(16777216+($p0<<16)+($p1<<8)+$p2).toString(16).slice(1).toUpperCase();return $v_0};Mscrm.ThemeMainSystemLibraryWebResource.$5=function($p0,$p1){var $v_0=Xrm.Page.ui.controls.get($p0);if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)&&!Mscrm.InternalUtilities.JSTypes.isNull($p1)){$v_0.clearNotifications();if($p1.startsWith("#"))$p1=$p1.substr(1);var $v_1=new RegExp("^[0-9A-F]{6}$","i"),$v_2=$v_1.test($p1);if(!$v_2){$v_0.setNotification(Xrm.Internal.getResourceString("LOCID_SYSCUST_INVALIDCOLORVALUE"));return false}}return true};Mscrm.ThemeMainSystemLibraryWebResource.$0=function($p0,$p1){var $v_0=$get($p0+"_i");$v_0.parentNode.className+=" ms-crm-Inline-Edit-Theme-Margin";var $v_1=$get($p0+"_colord");if(Mscrm.InternalUtilities.JSTypes.isNull($v_1)){$v_1=document.createElement("div");$v_1.id=$p0+"_colord";$v_1.className="ms-crm-inline-colorvalue";var $v_2=$get($p0);$v_2.appendChild($v_1);$v_2.className+=" ms-crm-ColorValueDirection"}if(!Mscrm.InternalUtilities.JSTypes.isNull($p1)){$v_1.style.backgroundColor=$p1.startsWith("#")?$p1:"#"+$p1;$v_1.style.display="block"}else $v_1.style.display="none"};Mscrm.ThemeMainSystemLibraryWebResource.registerClass("Mscrm.ThemeMainSystemLibraryWebResource")