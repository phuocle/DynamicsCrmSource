Type.registerNamespace("Mscrm");Mscrm.SyncErrorConstants=function(){};Mscrm.SyncErrorConstants.SyncErrorState=function(){};Mscrm.SyncErrorConstants.SyncErrorState.prototype={active:0,resolved:1};Mscrm.SyncErrorConstants.SyncErrorState.registerEnum("Mscrm.SyncErrorConstants.SyncErrorState",false);Mscrm.SyncErrorCommandBarActions=function(){};Mscrm.SyncErrorCommandBarActions.retryChangesFromForm=function(syncErrorid){var $v_0=Xrm.Page.getAttribute("requestdata"),$v_1=Xrm.Page.getAttribute("action");Mscrm.SyncErrorCommandBarActions.$4($v_0,$v_1,syncErrorid,null)};Mscrm.SyncErrorCommandBarActions.retryChangesFromGrid=function(gridControl,selectedRecord){var $v_0=Mscrm.SyncErrorCommandBarActions.$0("requestdata",gridControl),$v_1=Mscrm.SyncErrorCommandBarActions.$0("action",gridControl);Mscrm.SyncErrorCommandBarActions.$4($v_0,$v_1,selectedRecord[0].Id.toString(),gridControl)};Mscrm.SyncErrorCommandBarActions.isRetryableSyncError=function(item,records){if(Xrm.Utility.getGlobalContext().client.getClientState()!=="Online")return false;if(item&&records&&records.length===1){var $v_0=Mscrm.SyncErrorCommandBarActions.$0("statecode",item),$v_1=Mscrm.SyncErrorCommandBarActions.$0("action",item),$v_2=Mscrm.SyncErrorCommandBarActions.$0("errortype",item);return Mscrm.SyncErrorCommandBarActions.$3($v_0,$v_1,$v_2)}else if(Xrm.Page.data){var $v_3=Xrm.Page.getAttribute("statecode"),$v_4=Xrm.Page.getAttribute("action"),$v_5=Xrm.Page.getAttribute("errortype");return Mscrm.SyncErrorCommandBarActions.$3($v_3,$v_4,$v_5)}else return false};Mscrm.SyncErrorCommandBarActions.$4=function($p0,$p1,$p2,$p3){if($p0&&$p0.getValue()&&$p1){var $v_0=JSON.parse($p0.getValue().toString());if($v_0){var $v_1=$p1.getValue().toString().toLowerCase(),$v_2=$v_1==="create"?null:$v_0["syncerror__regardingentityid"].toString(),$v_3=$v_0["entitylogicalname"].toString();Xrm.Utility.getEntityMetadata($v_3,null).then(function($p1_0){if($p1_0.IsBPFEntity){delete $v_0.syncerror__regardingentityid;delete $v_0.entitylogicalname;var $v_4=$v_1==="create"?Xrm.WebApi.online.createRecord($v_3,$v_0):Xrm.WebApi.online.updateRecord($v_3,$v_2,$v_0);$v_4.then(function($p2_0){var $v_5={};$v_5["statecode"]=1;Xrm.WebApi.online.updateRecord("syncerror",$p2,$v_5).then(function($p3_0){if($p3)$p3.refresh();else Xrm.Page.data.refresh(false)},function($p3_0){})},function($p2_0){var $v_6={};$v_6.errorCode=$p2_0.errorCode;$v_6.message=$p2_0.message;$v_6.details="";Xrm.Navigation.openErrorDialog($v_6)})}else if(Xrm.Internal.isUci()&&Xrm.Utility.getGlobalContext().client.getClientState()==="Online"){var $v_7$G=$v_0;$v_7$G["_isSyncErrorRetryRequest"]=$p2;$v_7$G["action"]=$v_1;var $v_8={};$v_8.entityName=$v_0["entitylogicalname"].toString();$v_8.entityId=$v_2;$v_8.isOfflineSyncError=true;if($v_1==="create")Xrm.Utility.getEntityMetadata($v_8.entityName,null).then(function($p2_0){if($p2_0.IsBusinessProcessEnabled)$v_7$G["processid"]=Microsoft.Crm.Client.Core.Framework.Guid.get_empty().toString();Mscrm.SyncErrorCommandBarActions.$2($v_8,$v_7$G,$p3)},function($p2_0){Mscrm.SyncErrorCommandBarActions.$2($v_8,$v_7$G,$p3)});else Mscrm.SyncErrorCommandBarActions.$2($v_8,$v_7$G,$p3)}else{var $v_9$K={};$v_9$K["_isSyncErrorRetryRequest"]=$p2;if($v_1==="create")Xrm.Utility.getEntityMetadata($v_0["entitylogicalname"].toString(),null).then(function($p2_0){if($p2_0.IsBusinessProcessEnabled)$v_9$K["processid"]=Microsoft.Crm.Client.Core.Framework.Guid.get_empty().toString();Xrm.Utility.openEntityForm($v_0["entitylogicalname"].toString(),$v_2,$v_9$K)},function($p2_0){Xrm.Utility.openEntityForm($v_0["entitylogicalname"].toString(),$v_2,$v_9$K)});else Xrm.Utility.openEntityForm($v_0["entitylogicalname"].toString(),$v_2,$v_9$K)}},function($p1_0){var $v_A={};$v_A.errorCode=$p1_0.errorCode;$v_A.message=$p1_0.message;$v_A.details="";Xrm.Navigation.openErrorDialog($v_A)})}}};Mscrm.SyncErrorCommandBarActions.$2=function($p0,$p1,$p2){Xrm.Navigation.openForm($p0,$p1).then(function($p1_0){$p2&&$p2.refresh()},function($p1_0){var $v_0={};$v_0.errorCode=$p1_0.errorCode;$v_0.message=$p1_0.message;$v_0.details="";Xrm.Navigation.openErrorDialog($v_0)})};Mscrm.SyncErrorCommandBarActions.$0=function($p0,$p1){if($p1&&$p1.getGrid()&&$p1.getGrid().getSelectedRows()){var $v_0=$p1.getGrid().getSelectedRows().get(0);if($v_0&&$v_0.getData()&&$v_0.getData().getEntity()&&$v_0.getData().getEntity().attributes){var $v_1=$v_0.getData().getEntity().attributes.getByName($p0);if($v_1)return $v_1}}return null};Mscrm.SyncErrorCommandBarActions.$3=function($p0,$p1,$p2){if($p0&&Mscrm.SyncErrorCommandBarActions.$5($p0.getValue()))if($p1&&$p1.getValue()&&$p2)if($p1.getValue().toString().toLowerCase()==="create"||$p1.getValue().toString().toLowerCase()==="update"&&Mscrm.SyncErrorCommandBarActions.$6($p2.getValue()))return true;return false};Mscrm.SyncErrorCommandBarActions.$5=function($p0){if($p0.toString()==="Active"||Mscrm.SyncErrorCommandBarActions.$1($p0)===0)return true;return false};Mscrm.SyncErrorCommandBarActions.$6=function($p0){if(Mscrm.SyncErrorCommandBarActions.$1($p0)===0||Mscrm.SyncErrorCommandBarActions.$1($p0)===3)return true;return false};Mscrm.SyncErrorCommandBarActions.$1=function($p0){return parseInt($p0.toString())};Mscrm.SyncErrorConstants.registerClass("Mscrm.SyncErrorConstants");Mscrm.SyncErrorCommandBarActions.registerClass("Mscrm.SyncErrorCommandBarActions");Mscrm.SyncErrorConstants.action="action";Mscrm.SyncErrorConstants.requestData="requestdata";Mscrm.SyncErrorConstants.stateCode="statecode";Mscrm.SyncErrorConstants.statusCode="statuscode";Mscrm.SyncErrorConstants.errorType="errortype";Mscrm.SyncErrorConstants.entityLogicalNameAttribute="entitylogicalname";Mscrm.SyncErrorConstants.syncErrorRequestQueryParameter="_isSyncErrorRetryRequest";Mscrm.SyncErrorConstants.regardingEntityId="syncerror__regardingentityid";Mscrm.SyncErrorConstants.active="Active";Mscrm.SyncErrorConstants.syncErrorLogicalName="syncerror";Mscrm.SyncErrorConstants.create="create";Mscrm.SyncErrorConstants.update="update";Mscrm.SyncErrorConstants.processid="processid";Type.registerNamespace("Mscrm");Mscrm.DeleteSyncErrorRecords=Mscrm.SyncErrorCommandBarActions.deleteSyncErrorRecords;Mscrm.DeleteSyncErrorRecord=Mscrm.SyncErrorCommandBarActions.deleteSyncErrorRecord;Mscrm.DeleteAllSyncErrorRecords=Mscrm.SyncErrorCommandBarActions.deleteAllSyncErrorRecords;Mscrm.RetryChanges=Mscrm.SyncErrorCommandBarActions.retryChangesFromForm;Mscrm.RetryChangesFromGrid=Mscrm.SyncErrorCommandBarActions.retryChangesFromGrid;Mscrm.IsRetryableSyncError=Mscrm.SyncErrorCommandBarActions.isRetryableSyncError