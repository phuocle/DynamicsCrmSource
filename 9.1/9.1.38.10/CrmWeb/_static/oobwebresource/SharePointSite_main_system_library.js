if(Xrm.Internal.isUci()){var mscrm=window.Mscrm;mscrm.urloption_onchange=function(){var urloption=Xrm.Page.getAttribute("urloption");if(IsNull(urloption))return;Xrm.Page.getControl("absoluteurl").setVisible(false);Xrm.Page.getControl("relativeurl").setVisible(false);Xrm.Page.getControl("parentsite").setVisible(false);if(urloption.getValue()==0){Xrm.Page.getControl("absoluteurl").setVisible(true);Xrm.Page.getAttribute("parentsite").setRequiredLevel("none");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("none");Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("required");var sharepointS2S=Xrm.Internal.isFeatureEnabled("SharePointS2S");!sharepointS2S&&Xrm.Page.getControl("isgridpresent").setVisible(true)}else{Xrm.Page.getControl("relativeurl").setVisible(true);Xrm.Page.getControl("parentsite").setVisible(true);Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("none");Xrm.Page.getAttribute("parentsite").setRequiredLevel("required");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("required");Xrm.Page.getControl("isgridpresent").setVisible(false)}};mscrm.Form_onload=function(){var urloption=Xrm.Page.getAttribute("urloption"),sharepointS2S=Xrm.Internal.isFeatureEnabled("SharePointS2S");if(IsNull(urloption))return;Xrm.Page.getControl("absoluteurl").setVisible(false);Xrm.Page.getControl("relativeurl").setVisible(false);Xrm.Page.getControl("parentsite").setVisible(false);if(urloption.getValue()==0){Xrm.Page.getControl("absoluteurl").setVisible(true);Xrm.Page.getAttribute("parentsite").setRequiredLevel("none");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("none");Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("required");sharepointS2S&&Xrm.Page.getControl("isgridpresent").setVisible(false)}else{Xrm.Page.getControl("relativeurl").setVisible(true);Xrm.Page.getControl("parentsite").setVisible(true);Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("none");Xrm.Page.getAttribute("parentsite").setRequiredLevel("required");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("required");Xrm.Page.getControl("isgridpresent").setVisible(false)}}}else{Type.registerNamespace("Mscrm");Mscrm.urloption_onchange=function(){var urloptionCtrl=Mscrm.FormControlInputBehavior.GetBehavior("urloption");if(IsNull(urloptionCtrl))return;var parentsite=Mscrm.FormControlInputBehavior.GetBehavior("parentsite");if(!IsNull(parentsite)&&!parentsite.IsValid()){urloptionCtrl.set_dataValue(!urloptionCtrl.get_dataValue());return}$get("absoluteurl_c").style.display="none";$get("absoluteurl_d").style.display="none";$get("relativeurl_c").style.display="none";$get("relativeurl_d").style.display="none";$get("parentsite_c").style.display="none";$get("parentsite_d").style.display="none";if(urloptionCtrl.get_dataValue()==0){$get("absoluteurl_c").style.display="";$get("absoluteurl_d").style.display="";$find("crmForm").SetFieldReqLevel("parentsite",false);$find("crmForm").SetFieldReqLevel("relativeurl",false);$find("crmForm").SetFieldReqLevel("absoluteurl",true);if(!Mscrm.RibbonActions.isSharepointS2SConfigurationEnabled()){$get("isgridpresent_c").style.display="";$get("isgridpresent_d").style.display=""}}else{$get("relativeurl_c").style.display="";$get("relativeurl_d").style.display="";$get("parentsite_c").style.display="";$get("parentsite_d").style.display="";$find("crmForm").SetFieldReqLevel("absoluteurl",false);$find("crmForm").SetFieldReqLevel("parentsite",true);$find("crmForm").SetFieldReqLevel("relativeurl",true);$get("isgridpresent_c").style.display="none";$get("isgridpresent_d").style.display="none"}};Mscrm.Form_onload=function(){var urloptionCtrl=Mscrm.FormControlInputBehavior.GetBehavior("urloption"),isS2Senabled=Mscrm.RibbonActions.isSharepointS2SConfigurationEnabled();if(IsNull(urloptionCtrl))return;$get("absoluteurl_c").style.display="none";$get("absoluteurl_d").style.display="none";$get("relativeurl_c").style.display="none";$get("relativeurl_d").style.display="none";$get("parentsite_c").style.display="none";$get("parentsite_d").style.display="none";if(urloptionCtrl.get_dataValue()==0){$get("absoluteurl_c").style.display="";$get("absoluteurl_d").style.display="";$find("crmForm").SetFieldReqLevel("parentsite",false);$find("crmForm").SetFieldReqLevel("relativeurl",false);$find("crmForm").SetFieldReqLevel("absoluteurl",true);if(isS2Senabled){$get("isgridpresent_c").style.display="none";$get("isgridpresent_d").style.display="none"}}else{$get("relativeurl_c").style.display="";$get("relativeurl_d").style.display="";$get("parentsite_c").style.display="";$get("parentsite_d").style.display="";$find("crmForm").SetFieldReqLevel("absoluteurl",false);$find("crmForm").SetFieldReqLevel("parentsite",true);$find("crmForm").SetFieldReqLevel("relativeurl",true);$get("isgridpresent_c").style.display="none";$get("isgridpresent_d").style.display="none"}}}