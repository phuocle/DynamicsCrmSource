if(Xrm.Internal.isUci()){var mscrm=window.Mscrm;mscrm.urloption_onchange=function(){var urloption=Xrm.Page.getAttribute("urloption");if(IsNull(urloption))return;Xrm.Page.getControl("absoluteurl").setVisible(false);Xrm.Page.getControl("relativeurl").setVisible(false);Xrm.Page.getControl("parentsiteorlocation").setVisible(false);if(urloption.getValue()==0){Xrm.Page.getControl("absoluteurl").setVisible(true);Xrm.Page.getAttribute("parentsiteorlocation").setRequiredLevel("none");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("none");Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("required")}else{Xrm.Page.getControl("relativeurl").setVisible(true);Xrm.Page.getControl("parentsiteorlocation").setVisible(true);Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("none");Xrm.Page.getAttribute("parentsiteorlocation").setRequiredLevel("required");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("required")}};mscrm.Form_onload=function(){var sharepointS2S=Xrm.Internal.isFeatureEnabled("SharePointS2S");if(IsNull(sharepointS2S))return;var absoluteurl=Xrm.Page.getAttribute("absoluteurl").getValue();IsNull(absoluteurl)&&Xrm.Page.getControl("absoluteurl").setVisible(false);Xrm.Page.getControl("relativeurl").setVisible(false);Xrm.Page.getControl("parentsiteorlocation").setVisible(false);if(!sharepointS2S){Xrm.Page.getControl("urloption").setVisible(true);if(urloption.getValue()==0){Xrm.Page.getControl("absoluteurl").setVisible(true);Xrm.Page.getAttribute("parentsiteorlocation").setRequiredLevel("none");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("none");Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("required")}else{Xrm.Page.getControl("relativeurl").setVisible(true);Xrm.Page.getControl("parentsiteorlocation").setVisible(true);Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("none");Xrm.Page.getAttribute("parentsiteorlocation").setRequiredLevel("required");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("required")}}else{Xrm.Page.getControl("relativeurl").setVisible(true);Xrm.Page.getControl("parentsiteorlocation").setVisible(true);Xrm.Page.getAttribute("absoluteurl").setRequiredLevel("none");Xrm.Page.getAttribute("parentsiteorlocation").setRequiredLevel("required");Xrm.Page.getAttribute("relativeurl").setRequiredLevel("required")}}}else{Type.registerNamespace("Mscrm");Mscrm.urloption_onchange=function(){var urloptionCtrl=Mscrm.FormControlInputBehavior.GetBehavior("urloption");if(IsNull(urloptionCtrl))return;var parentsiteorlocation=Mscrm.FormControlInputBehavior.GetBehavior("parentsiteorlocation");if(!IsNull(parentsiteorlocation)&&!parentsiteorlocation.IsValid()){urloptionCtrl.set_dataValue(!urloptionCtrl.get_dataValue());return}$get("absoluteurl_c").style.display="none";$get("absoluteurl_d").style.display="none";$get("relativeurl_c").style.display="none";$get("relativeurl_d").style.display="none";$get("parentsiteorlocation_c").style.display="none";$get("parentsiteorlocation_d").style.display="none";if(urloptionCtrl.get_dataValue()==0){$get("absoluteurl_c").style.display="";$get("absoluteurl_d").style.display="";$find("crmForm").SetFieldReqLevel("parentsiteorlocation",false);$find("crmForm").SetFieldReqLevel("relativeurl",false);$find("crmForm").SetFieldReqLevel("absoluteurl",true)}else{$get("relativeurl_c").style.display="";$get("relativeurl_d").style.display="";$get("parentsiteorlocation_c").style.display="";$get("parentsiteorlocation_d").style.display="";$find("crmForm").SetFieldReqLevel("absoluteurl",false);$find("crmForm").SetFieldReqLevel("parentsiteorlocation",true);$find("crmForm").SetFieldReqLevel("relativeurl",true)}};Mscrm.Form_onload=function(){var urloptionCtrl=Mscrm.FormControlInputBehavior.GetBehavior("urloption"),sharepointS2S=Mscrm.RibbonActions.isSharepointS2SConfigurationEnabled();if(IsNull(urloptionCtrl)||IsNull(sharepointS2S))return;$get("absoluteurl_c").style.display="none";$get("absoluteurl_d").style.display="none";$get("relativeurl_c").style.display="none";$get("relativeurl_d").style.display="none";$get("parentsiteorlocation_c").style.display="none";$get("parentsiteorlocation_d").style.display="none";$get("urloption_c").style.display="none";$get("urloption_d").style.display="none";if(!sharepointS2S){$get("urloption_c").style.display="";$get("urloption_d").style.display="";if(urloptionCtrl.get_dataValue()==0){$get("absoluteurl_c").style.display="";$get("absoluteurl_d").style.display="";$find("crmForm").SetFieldReqLevel("parentsiteorlocation",false);$find("crmForm").SetFieldReqLevel("relativeurl",false);$find("crmForm").SetFieldReqLevel("absoluteurl",true)}else{$get("relativeurl_c").style.display="";$get("relativeurl_d").style.display="";$get("parentsiteorlocation_c").style.display="";$get("parentsiteorlocation_d").style.display="";$find("crmForm").SetFieldReqLevel("absoluteurl",false);$find("crmForm").SetFieldReqLevel("parentsiteorlocation",true);$find("crmForm").SetFieldReqLevel("relativeurl",true)}}else{urloptionCtrl.set_dataValue(true);$get("urloption_c").parentNode.parentNode.firstChild.style.display="none";$get("relativeurl_c").style.display="";$get("relativeurl_d").style.display="";$get("parentsiteorlocation_c").style.display="";$get("parentsiteorlocation_d").style.display="";$find("crmForm").SetFieldReqLevel("absoluteurl",false);$find("crmForm").SetFieldReqLevel("parentsiteorlocation",true);$find("crmForm").SetFieldReqLevel("relativeurl",true)}}}