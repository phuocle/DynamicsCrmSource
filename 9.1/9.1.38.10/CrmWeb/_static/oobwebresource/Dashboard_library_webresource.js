var Dashboard;(function(Dashboard){Dashboard.DashboardCommandsLibrary={saveDashboardAs:function(){return _executeCommand(function(commands,dashboardId){return commands.saveDashboardAs(dashboardId)})},assignDashboard:function(){return _executeCommand(function(commands,dashboardId){return commands.assignDashboard(dashboardId)})},deleteDashboard:function(){return _executeCommand(function(commands,dashboardId){return commands.deleteDashboard(dashboardId)})},editDashboard:function(){return _executeCommand(function(commands,dashboardId){return commands.editDashboard(dashboardId)})},shareDashboard:function(){return _executeCommand(function(commands,dashboardId){return commands.shareDashboard(dashboardId)})},createNewDashboard:function(){return _executeCommand(function(commands){return commands.createNewDashboard()})},refreshDashboardPage:function(){return _executeCommand(function(commands,dashboardId){return commands.refreshDashboard(dashboardId)})},setUserDefaultDashboard:function(){return _setUserDefaultDashboard()},unsetUserDefaultDashboard:function(){return _setUserDefaultDashboard(true)},createPowerBIDashboard:function(){return _executeCommand(function(commands){return commands.createNewPowerBIDashboard()})},openInPowerBI:function(){return _executeCommand(function(commands,dashboardId){return commands.openInPowerBI(dashboardId)})}};function _executeCommand(action){var dashboardCommands=Xrm&&Xrm.Page&&Xrm.Page.commands;if(dashboardCommands){var dashboardId=Dashboard.getCurrentDashboardId();action(dashboardCommands,dashboardId)}}function _setUserDefaultDashboard(unset){if(unset===void 0)unset=false;_executeCommand(function(commands,dashboardId){return commands.setUserDefaultDashboard(unset?null:dashboardId).then(function(){return Xrm.Page.ui&&Xrm.Page.ui.refreshRibbon()})})}})(Dashboard||(Dashboard={}));var Dashboard;(function(Dashboard){Dashboard.Commands=Xrm&&Xrm.Internal&&Xrm.Internal.isUci&&Xrm.Internal.isUci()?Dashboard.DashboardCommandsLibrary:Mscrm.DashboardRibbonActions})(Dashboard||(Dashboard={}));var Dashboard;(function(Dashboard){function getCurrentDashboard(){return Xrm&&Xrm.Page&&Xrm.Page.ui&&Xrm.Page.ui.formSelector&&Xrm.Page.ui.formSelector.getCurrentItem()}Dashboard.getCurrentDashboard=getCurrentDashboard;function getCurrentDashboardId(){var currentDashboard=getCurrentDashboard(),dashboardId=currentDashboard&&currentDashboard.getId();return dashboardId&&normalizeGuidString(dashboardId)}Dashboard.getCurrentDashboardId=getCurrentDashboardId;function normalizeGuidString(guid){return guid.replace("{","").replace("}","").toLowerCase()}Dashboard.normalizeGuidString=normalizeGuidString})(Dashboard||(Dashboard={}));var Mscrm;(function(Mscrm){var DashboardRibbonActions;(function(DashboardRibbonActions){function isUnboundDashboardSelected(){return true}DashboardRibbonActions.isUnboundDashboardSelected=isUnboundDashboardSelected})(DashboardRibbonActions=Mscrm.DashboardRibbonActions||(Mscrm.DashboardRibbonActions={}))})(Mscrm||(Mscrm={}));var Dashboard;(function(Dashboard){Dashboard.DashboardRulesLibrary={isAnyDashboardSelected:function(){return _checkCurrentDashboard(function(dashboard){return [true,false].indexOf(dashboard.isUserDashboard)!==-1})},isUserFormSelected:function(){return _checkCurrentDashboard(function(dashboard){return dashboard.isUserDashboard===true})},isUnboundDashboardSelected:function(){return _checkCurrentDashboard(function(dashboard){return dashboard.isBoundDashboard===false})},isPowerBIDashboardSelected:function(){try{var controls=Xrm&&Xrm.Page&&Xrm.Page.ui&&Xrm.Page.ui.controls;if(!controls)return false;return controls.getLength()===1&&controls.get(0).controlDescriptor.Parameters.Type==="1"}catch(e){return false}},isUserDefaultDashboard:function(){var currentDashboardId=Dashboard.getCurrentDashboardId(),defaultDashboardId=_getDefaultDashboardId();return currentDashboardId===defaultDashboardId},isUserDefaultModule:function(){return true}};function _getDefaultDashboardId(){var context=Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext(),defaultDashboardId=context&&context.userSettings&&context.userSettings.defaultDashboardId;return defaultDashboardId&&Dashboard.normalizeGuidString(defaultDashboardId)}function _checkCurrentDashboard(check){var currentDashboard=Dashboard.getCurrentDashboard();return currentDashboard&&check(currentDashboard)}})(Dashboard||(Dashboard={}));var Dashboard;(function(Dashboard){Dashboard.Rules=Xrm&&Xrm.Internal&&Xrm.Internal.isUci&&Xrm.Internal.isUci()?Dashboard.DashboardRulesLibrary:Mscrm.DashboardRibbonActions})(Dashboard||(Dashboard={}))