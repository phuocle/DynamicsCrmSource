Type.registerNamespace("Mscrm");Mscrm.DashboardPage=function(){};Mscrm.DashboardPage.run=function(){if(Mscrm.DashboardPage.$J("Dashboard.aspx"))return;Mscrm.DashboardPage.$K("Dashboard.aspx");Mscrm.DashboardPage.$O();if(window.UseTabletExperience){Mscrm.DashboardPage.$l();window.LOCID_UI_DIR==="RTL"&&Mscrm.DashboardPage.$U()}};Mscrm.DashboardPage.$U=function(){for(var $v_0=document.getElementsByTagName("iframe"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];!IsNull($v_2)&&!isNullOrEmptyString($v_2.id)&&(!$v_2.id.indexOf("WebResource")||!$v_2.id.indexOf("IFRAME"))&&$addHandler($v_2,"load",Mscrm.DashboardPage.$m)}};Mscrm.DashboardPage.$m=function($p0){var $v_0=null;if(!$p0.target.id.indexOf("WebResource"))$v_0=$p0.target.parentNode.parentNode;else if(!$p0.target.id.indexOf("IFRAME"))$v_0=$p0.target.parentNode;if(!IsNull($v_0)){var $v_1=$v_0.scrollWidth-$v_0.clientWidth;$v_0.scrollLeft+=$v_1}};Mscrm.DashboardPage.$l=function(){var $v_0=$get("formBodyContainer");$v_0&&new Mscrm.TopBottomScrollRestriction($v_0)};Mscrm.DashboardPage.$J=function($p0){var $v_0=window.top,$v_1=window.self;if($v_0&&"METADATA_TIMESTAMP" in $v_0&&"METADATA_TIMESTAMP" in $v_1&&$v_0["METADATA_TIMESTAMP"]!==$v_1["METADATA_TIMESTAMP"])return Mscrm.DashboardPage.$i($p0,$v_0["METADATA_TIMESTAMP"],$v_1["METADATA_TIMESTAMP"]);Xrm.Internal.trace.log($p0,"Metadata is up to date");return false};Mscrm.DashboardPage.$i=function($p0,$p1,$p2){var $v_0=window.location.href.toString()+$p1+$p2;if(Mscrm.CrmCrossBrowser.getSessionStorage(window.self).getItem($v_0)==="true"){Xrm.Internal.trace.log($p0,"Metadata version pair encountered before");return false}Xrm.Internal.trace.log($p0,"Metadata updated. Self: {0}; Top: {1}. Redirecting to check for system dashboard list changes",$p2,$p1);Mscrm.CrmCrossBrowser.getSessionStorage(window.self).setItem($v_0,"true");window.location.reload(true);return true};Mscrm.DashboardPage.$O=function(){var $v_0=Mscrm.CrmUri.create(window.location.href),$v_1=$v_0.get_query(),$v_2=$v_1["dashboardId"],$v_3=$v_1["dashboardType"];Mscrm.DashboardPage.checkForUserDashboardUpdate("Dashboard.aspx",$v_2,$v_3)};Mscrm.DashboardPage.checkForUserDashboardUpdate=function(component,dashboardId,dashboardType){if(dashboardType==="1030")return;Xrm.Internal.trace.log(component,"Checking if user dashboard has been updated");var $v_0=new RemoteCommand("DashboardWebService","GetUserDashboardVersion");$v_0.SetParameter("userDashboardId",dashboardId);var $v_1="cache."+component+".userDashboard";Mscrm.DashboardPage.$A($v_0).done(function($p1_0){var $v_2=$p1_0.toString(),$v_3=$v_1+dashboardId+".version",$v_4=Mscrm.CrmCrossBrowser.getLocalStorage(window.self).getItem($v_3);if($v_2===$v_4){Xrm.Internal.trace.log(component,"This is the latest version of the dashboard");return}Mscrm.CrmCrossBrowser.getLocalStorage(window.self).setItem($v_3,$v_2);if(isNullOrEmptyString($v_4))return;Xrm.Internal.trace.log(component,"Redirecting to update to version {0}",$v_2);window.location.reload(true)}).fail(function($p1_0){return Xrm.Internal.trace.warning(component,"User dashboard version cannot be retrieved")})};Mscrm.DashboardPage.$K=function($p0){var $v_0=new RemoteCommand("DashboardWebService","GetDashboardWrpcTokens");Mscrm.DashboardPage.$A($v_0).done(function($p1_0){var $v_1=$p1_0.toString();if($v_1.startsWith("while(1);"))$v_1=$v_1.substr(9);var $v_2=JSON.parse($v_1),$v_3=window.self["_aWrpcTokens"],$$dict_7=$v_2;for(var $$key_8 in $$dict_7){var $v_4={key:$$key_8,value:$$dict_7[$$key_8]};$v_3[$v_4.key]=$v_4.value}Xrm.Internal.trace.log($p0,"Rerieved WRPC tokens")}).fail(function($p1_0){return Xrm.Internal.trace.warning($p0,"Can not retrieve WRPC tokens. Some functionality might not work")})};Mscrm.DashboardPage.$A=function($p0){var $v_0=jQueryApi.jQueryDeferredFactory.Deferred(Object,Error);$p0.Execute(function($p1_0,$p1_1){if($p1_0.Success)$v_0.resolve($p1_0.ReturnValue);else $v_0.reject()});return $v_0.promise()};Mscrm.DashboardSelector=function(element){this.$$d_$D_3=Function.createDelegate(this,this.$D_3);this.$$d_$S_3=Function.createDelegate(this,this.$S_3);this.$$d_$R_3=Function.createDelegate(this,this.$R_3);this.$$d_$k_3=Function.createDelegate(this,this.$k_3);this.$$d_$Y_3=Function.createDelegate(this,this.$Y_3);this.$$d_$d_3=Function.createDelegate(this,this.$d_3);this.$F_3=window.screen.availHeight;Mscrm.DashboardSelector.initializeBase(this,[element])};Mscrm.DashboardSelector.prototype={$E_3:true,$7_3:0,$0_3:null,$8_3:null,$B_3:false,$3_3:null,$1_3:null,$6_3:null,$5_3:null,get_selector:function(){if(IsNull(this.$8_3))this.$8_3=$get("dashboardSelectorContainer",this.get_element());return this.$8_3},set_selector:function(value){this.$8_3=value;return value},get_dashboardItems:function(){return XUI.Xml.SelectNodes(this.$0_3.get_menuXml(),"/Menu/MenuItem",null)},get_currentItem:function(){if(!IsNull(this.get_selector().attributes.getNamedItem("CurrentItem")))return this.get_selector().attributes.getNamedItem("CurrentItem").value;return ""},get_currentType:function(){if(!IsNull(this.get_selector().attributes.getNamedItem("CurrentItemType")))return parseInt(this.get_selector().attributes.getNamedItem("CurrentItemType").value,10);return 0},get_currentPowerBIDashboardUrl:function(){if(!IsNull(this.get_selector().attributes.getNamedItem("CurrentPowerBIDashboardUrl")))return this.get_selector().attributes.getNamedItem("CurrentPowerBIDashboardUrl").value;return ""},getDashboardNode:function(id){return XUI.Xml.SelectSingleNode(this.$0_3.get_menuXml(),"//MenuItem[@id='"+id+"']",null)},get_reloadNeeded:function(){return this.$B_3},set_reloadNeeded:function(value){this.$B_3=value;return value},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$h_3();this.loadList(this.get_selector().attributes.getNamedItem("MenuXml").value,null);this.selectDefaultDashboard();!isNullOrEmptyString(this.get_currentItem())&&Mscrm.DashboardPage.checkForUserDashboardUpdate("Home_Dashboards.aspx",this.get_currentItem(),this.get_currentType().toString());this.$R_3()},dispose:function(){if(this.get_isDisposed())return;window.clearTimeout(this.$9_3);this.$o_3();Mscrm.CrmUIControl.prototype.dispose.call(this)},$h_3:function(){this.$8_3=$get("dashboardSelectorContainer",this.get_element());if(!IsNull(this.get_selector())){Mscrm.PageManager.get_instance().get_eventManager().subscribeEvent(14,this.get_id());var $v_0=$get("dashboardSelectorLink",this.get_element());$addHandler($v_0,"click",this.$$d_$d_3);this.$0_3=new Mscrm.Popup(this.$$d_$Y_3)}},$o_3:function(){var $v_0=$get("dashboardSelectorLink",this.get_element());$removeHandler($v_0,"click",this.$$d_$d_3);this.$0_3.dispose()},handleEvent:function(eventCode,parameters,sourceComponent){Mscrm.CrmUIControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent);switch(eventCode){case 14:this.$Z_3();break}return null},$Z_3:function(){var $v_0=$get("dashboardSelectorLink"),$v_1=XUI.Html.DomUtils.GetFirstChild($v_0);if(IsNull($v_0)||IsNull($v_1))return;try{$v_1.style.width=$v_1.clientWidth.toString();var $v_2=$v_0.parentNode.offsetWidth,$v_3=$v_1.scrollWidth,$v_4=XUI.Html.DomUtils.GetNextSibling($v_1).offsetWidth;if($v_3>$v_2-$v_4)$v_1.style.width=($v_2-$v_4-30).toString();else $v_1.style.width="auto"}catch($$e_5){}},selectDefaultDashboard:function(){var $v_0="";if(!IsNull(this.get_selector().attributes.getNamedItem("defaultItem")))$v_0=this.get_selector().attributes.getNamedItem("defaultItem").value;this.selectDashboard($v_0)},hide:function(){!IsNull(this.$0_3)&&!IsNull(this.$0_3.get_currentMenu())&&this.$0_3.get_currentMenu().hide()},loadList:function(newList,defaultItem){this.$0_3.set_menuXml(XUI.Xml.LoadXml(newList));this.$0_3.set_currentMenu(null);this.$n_3();if(!isNullOrEmptyString(defaultItem)){this.get_selector().setAttribute("defaultItem",defaultItem);this.selectDashboard(defaultItem)}else this.selectDashboard(null);this.$a_3()},$d_3:function($p0){$p0.stopPropagation();var $v_0=Mscrm.Utilities.getDomEventElement($p0,"A"),$v_1=new Mscrm.SelectorUtil($get("dashboardSelectorLink",this.get_element()),this.$0_3,XUI.Xml.XMLSerializer.serializeToString(this.$0_3.get_menuXml()));$v_1.selectorClicked($v_0)},$Y_3:function($p0,$p1){var $v_0=$p1["menuitem"];this.selectDashboard($v_0.get_menuItemId());this.loadSelectedDashboard()},selectDashboard:function(dashboardId){var $v_0=this.get_currentItem();if($v_0===dashboardId)return;var $v_1=this.getDashboardNode(dashboardId);if(IsNull($v_1)){dashboardId=this.$W_3();$v_1=this.getDashboardNode(dashboardId)}if(IsNull($v_1)&&this.get_dashboardItems().length>0){dashboardId=XUI.Xml.GetText(this.get_dashboardItems()[1].attributes.getNamedItem("id"));$v_1=this.getDashboardNode(dashboardId)}var $v_2=window.LOCID_NO_DASHBOARDS_AVAILABLE,$v_3="0",$v_4=null,$v_5=null;if(!IsNull($v_1)){$v_2=XUI.Xml.GetText($v_1.attributes.getNamedItem("display"));$v_3=XUI.Xml.GetText($v_1.attributes.getNamedItem("type"));$v_4=XUI.Xml.GetText($v_1.attributes.getNamedItem("dashboardUrl"));$v_5=XUI.Xml.GetText($v_1.attributes.getNamedItem("istabletenabled"))}XUI.Html.SetText(this.get_selector(),$v_2);this.get_selector().setAttribute("CurrentItem",dashboardId);this.get_selector().setAttribute("CurrentItemType",$v_3);this.get_selector().setAttribute("CurrentPowerBIDashboardUrl",$v_4);this.get_selector().setAttribute("isTabletEnabled",$v_5);this.get_selector().title=$v_2;var $v_6=String.format(window.LOCID_VIEW_TITLE_FORMAT,window.LOCID_DASHBOARD_PLURAL_NAME,$v_2);setPageTitle($v_6);setAttributeInWindow("DashboardName",$v_2);setAttributeInWindow("DashboardId",dashboardId)},$n_3:function(){this.$G_3("defaultItem");this.$G_3("userDefaultItem");this.$G_3("systemDefaultItem")},$G_3:function($p0){var $v_0="",$v_1=XUI.Xml.DomUtils.GetFirstChild(this.$0_3.get_menuXml());if(!IsNull($v_1.attributes.getNamedItem($p0)))$v_0=XUI.Xml.GetText($v_1.attributes.getNamedItem($p0));this.get_selector().setAttribute($p0,$v_0)},$a_3:function(){var $v_0={};$v_0["timestamp"]=new Date;$v_0["queryList"]="";var $v_1={};$v_1["data"]=$v_0;$v_1["key"]=String.format("QueryList_{0}","Dashboard");Mscrm.PageManager.get_instance().raiseEvent(5,$v_1)},$W_3:function(){var $v_0=XUI.Xml.SelectSingleNode(this.$0_3.get_menuXml(),"/Menu",null);if(IsNull($v_0))return null;var $v_1=$v_0.attributes.getNamedItem("defaultItem");return IsNull($v_1)?null:$v_1.value},$4_3:function($p0,$p1){var $v_0=$get($p0);if(!IsNull($v_0)){$v_0.style.zIndex=$p1;if(0>=$p1)$v_0.style.visibility="hidden";else $v_0.style.visibility="visible"}},$R_3:function($p0){this.$4_3("dashboardFrameRow",1);this.$4_3("dashboardLoadingRow",0);this.$4_3("dashboardNotificationRow",0);try{refreshRibbon();this.$P_3();this.$b_3();if(window.UseTabletExperience&&this.$E_3){var $$t_6=this;Sys.Application.add_load(function($p1_0,$p1_1){$$t_6.$E_3=false;$$t_6.selectDefaultDashboard();$$t_6.loadSelectedDashboard()})}else{var $v_1=this.$c_3();Mscrm.PageManager.get_instance().raiseEvent(72,$v_1);$addHandler(window,"resize",this.$$d_$k_3);this.get_selector().focus()}var $v_0={};$v_0["dashboardId"]=this.get_currentItem();XrmUI.Manager.XrmUIPage=new Mscrm.XrmUIPageWrapper("Workspace",$v_0)}catch($$e_5){}},$P_3:function(){var $v_0=$get("dashboardFrame");if(!IsNull($v_0)){$removeHandler($v_0,"load",this.$$d_$R_3);this.$3_3=$v_0.contentWindow}else this.$3_3=window;if(this.$3_3.document.readyState==="complete")this.$D_3(null);else $addHandler(this.$3_3.document,"readystatechange",this.$$d_$S_3)},$D_3:function($p0){if(!IsNull(this.$1_3)){if(this.$1_3.readyState!=="complete")return;$removeHandler(this.$1_3,"readystatechange",this.$$d_$D_3);this.$1_3=null}var $v_0=this.$3_3.frames;if(!IsNull($v_0))for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1],$v_3;try{$v_3=$v_2.document}catch($$e_5){continue}if($v_3.readyState!=="complete"){this.$1_3=$v_3;$addHandler(this.$1_3,"readystatechange",this.$$d_$D_3);return}else if($v_2.location.href.indexOf("msdyn_/PersonalWall.htm")!==-1){var $v_4=$v_3.getElementById("activityFeedsWall");if(IsNull($v_4)){if(IsNull(this.$6_3)){this.$6_3=new MutationObserver(this.$$d_$D_3);this.$6_3.observe($v_2.document,{childList:true,subtree:true})}return}if(!IsNull(this.$6_3)){this.$6_3.disconnect();this.$6_3=null}var $v_5=$v_4.attributes.getNamedItem("iswallrenderingcomplete");if(IsNull($v_5)||$v_5.value!=="true"){if(IsNull(this.$5_3)){this.$5_3=new MutationObserver(this.$$d_$D_3);this.$5_3.observe($v_4,{attributes:true})}return}if(!IsNull(this.$5_3)){this.$5_3.disconnect();this.$5_3=null}}}this.$j_3()},$j_3:function(){if(!IsNull(this.$1_3)){$removeHandler(this.$1_3,"readystatechange",this.$$d_$D_3);this.$1_3=null}this.$3_3=null;setPerfMarkerTimestamp("FinishDashboardLoadTimeStamp");Mscrm.MetricsCollector.collectAndReportClientMetrics(3)},$S_3:function($p0){if(this.$3_3.document.readyState==="complete"){$removeHandler(this.$3_3.document,"readystatechange",this.$$d_$S_3);this.$D_3(null)}},$b_3:function(){var $v_0=$get("dashboardFrame");if(!IsNull($v_0))this.$7_3=$v_0.offsetWidth},$c_3:function(){var $v_0={},$v_1=Mscrm.CrmUri.create(window.location.href);$v_0["uri"]=$v_1.toString();if(this.get_currentType()){var $v_2=this.getDashboardNode(this.get_currentItem());$v_0["otc"]=this.get_currentType().toString();$v_0["action"]=$v_1.get_queryString().replace("?","");$v_0["etn"]="Dashboard";$v_0["entitydisplayname"]=window.LOCID_DASHBOARD_SINGLE_NAME;$v_0["title"]=XUI.Xml.GetText($v_2.attributes.getNamedItem("display"));$v_0["id"]=this.get_currentItem()}return $v_0},$9_3:0,$k_3:function($p0){window.clearTimeout(this.$9_3);var $$t_3=this;this.$9_3=window.setTimeout(function(){if(window.UseTabletExperience&&Mscrm.CrmBrowser.get_currentBrowser().get_agent()===3)if($$t_3.$F_3===window.screen.availHeight)return;else $$t_3.$F_3=window.screen.availHeight;var $v_0=document.body.offsetWidth;if(Math.abs($v_0-$$t_3.$7_3)<40)return;if(!$$t_3.$7_3){$$t_3.$7_3=$v_0;return}Xrm.Internal.trace.logT(Mscrm.DashboardSelector,"resizing dashboard from {0}px to {1}px",$$t_3.$7_3,$v_0);$$t_3.$7_3=$v_0;var $v_1=$$t_3.$V_3();!IsNull($v_1)&&$v_1.raiseEvent(53,null)},300)},$V_3:function(){var $v_0=$get("dashboardFrame");if(IsNull($v_0))return $find("crmPageManager");else{var $v_1=$v_0.contentWindow.Sys.Application;if(!IsNull($v_1))return $v_1.findComponent("crmPageManager")}return null},loadSelectedDashboard:function(){setPerfMarkerTimestamp("StartDashboardLoadTimeStamp");var $v_0=this.get_currentItem(),$v_1=this.get_currentType();if(!this.get_dashboardItems().length||isNullOrEmptyString($v_0)){this.$4_3("dashboardFrameRow",0);this.$4_3("dashboardLoadingRow",0);this.$4_3("dashboardNotificationRow",1)}else{var $v_2=$get("dashboardBodyContainer");if(!$v_2){Xrm.Internal.trace.errorT(Mscrm.DashboardSelector,"dashboardBodyContainer is missing");return}this.$4_3("dashboardFrameRow",0);this.$4_3("dashboardLoadingRow",1);this.$4_3("dashboardNotificationRow",0);var $v_3=Mscrm.CrmUri.create("/dashboards/dashboard.aspx");$v_3.set_useVersionStamp(true);$v_3.set_includeContextInPath(true);$v_3.appendToQuery("dashboardId="+$v_0);$v_3.appendToQuery("&pagemode=iframe");$v_3.appendToQuery("&dashboardType="+$v_1.toString());$v_1!==1030&&this.$L_3($v_3,$v_0);var $v_4=$get("dashboardFrame");if(IsNull($v_4)){this.$T_3();$v_2.innerHTML="";$v_4=this.$Q_3(window.document);$v_2.appendChild($v_4)}var $v_5=this.$$d_$R_3;$v_4.contentWindow.location.replace($v_3.toString());$addHandler($v_4,"load",$v_5)}this.updateStickyDashboardUrl($v_0,$v_1)},$T_3:function(){for(var $v_0=$get("crmForm"),$v_1=Sys.Application.getComponents(),$v_2=0;$v_2<$v_1.length;$v_2++){if(IsNull($v_1[$v_2].get_id))continue;var $v_3=$get($v_1[$v_2].get_id());!IsNull($v_3)&&$v_0.contains($v_3)&&$v_1[$v_2].dispose()}},$Q_3:function($p0){var $v_0=$p0.createElement("IFRAME");$v_0.id="dashboardFrame";$v_0.setAttribute("name","dashboardFrame");$v_0.scrolling="no";$v_0.frameBorder="0";$v_0.className="ms-crm-absolutePosition";$v_0.style.borderStyle="none";$v_0.style.width=$v_0.style.height="100%";return $v_0},$L_3:function($p0,$p1){var $v_0=Mscrm.CrmLocalStorage.getItem("cache.userDashboard"+$p1+".version");if(isNullOrEmptyString($v_0))return;$p0.appendToQuery("&dashboardVer="+CrmEncodeDecode.CrmUrlEncode($v_0))},updateStickyDashboardUrl:function(dashboardId,dashboardType){if(IsNull(dashboardType)){Xrm.Internal.trace.warningT(Mscrm.DashboardSelector,"falling back to dashboard type 0, as it was not provided by the caller");dashboardType=0}var $v_0={};$v_0["dashboardId"]=dashboardId;$v_0["dashboardType"]=dashboardType.toString();if(this.$B_3)$v_0["refreshDashboard"]=true;if(isOutlookHostedWindow())getOutlookHostedWindow().handleEvent(61,$v_0,null);else Mscrm.PageManager.get_instance().raiseEvent(61,$v_0)}};Mscrm.HomeDashboardsPage=function(){};Mscrm.HomeDashboardsPage.run=function(){if(Mscrm.DashboardPage.$J("Home_Dashboards.aspx"))return;Mscrm.DashboardPage.$K("Home_Dashboards.aspx");Mscrm.HomeDashboardsPage.$N()};Mscrm.HomeDashboardsPage.$N=function(){var $v_0=Mscrm.CrmUri.create(window.location.href),$v_1=$v_0.get_query(),$v_2=Mscrm.HomeDashboardsPage.$M($v_0,$v_1),$v_3=Mscrm.HomeDashboardsPage.$X($v_1),$v_4=jQueryApi.jQueryDeferredFactory.Deferred(Object,Error);Sys.Application.add_load(function(){$v_4.resolve(null)});$P_CRM.when($v_3,$v_2,$v_4).done(function($p1_0){return Mscrm.HomeDashboardsPage.$e($p1_0,$v_1)})};Mscrm.HomeDashboardsPage.$e=function($p0,$p1){var $v_0=$p0.toString();if($v_0===$p1["dashboardId"])return;var $v_1=$find("dashboardSelector"),$v_2=!IsNull($v_1.getDashboardNode($v_0)),$v_3=$v_1.get_currentItem();if($v_3===$v_0)return;if($v_2){var $v_4=Mscrm.CrmCrossBrowser.getLocalStorage(window.self);$v_4.setItem("cache.usersDashboards.defaultFor."+$p1["sitemappath"],$v_0);Xrm.Internal.trace.log("Home_Dashboards.aspx","Default dashboard changed to {0}",$v_0);$v_1.selectDashboard($v_0);$v_1.loadSelectedDashboard()}else Xrm.Internal.trace.warning("Home_Dashboards.aspx","Requested dashboard {0} not found",$v_0)};Mscrm.HomeDashboardsPage.$X=function($p0){var $v_0;if("dashboardId" in $p0)$v_0=jQueryApi.jQueryDeferredFactory.fromResult(Object,Error,$p0["dashboardId"]);else{var $v_1=new RemoteCommand("DashboardWebService","GetDefaultDashboardId");$v_1.SetParameter("siteMapPath",$p0["sitemappath"]);Mscrm.FeatureControl.get_Current().isFeatureEnabled("FCB.AppModuleForOrganization")&&$v_1.SetParameter("appid",$p0["appid"]);$v_0=Mscrm.DashboardPage.$A($v_1)}return $v_0};Mscrm.HomeDashboardsPage.$M=function($p0,$p1){if("noUpdateCheck" in $p1){Xrm.Internal.trace.log("Home_Dashboards.aspx","Skipping check for updates");return jQueryApi.jQueryDeferredFactory.fromResult(Object,Error,$p1["userDashboardsHash"])}Xrm.Internal.trace.log("Home_Dashboards.aspx","Checking if user dashboard has been updated");var $v_0=new RemoteCommand("DashboardWebService","GetUserDashboardListHash"),$v_1=Mscrm.DashboardPage.$A($v_0);$v_1.done(function($p1_0){var $v_2=$p1_0.toString(),$v_3=Mscrm.CrmCrossBrowser.getLocalStorage(window.self).getItem("cache.usersDashboards.hash");if(!("userDashboardsHash" in $p1)&&$v_2===$v_3){Xrm.Internal.trace.log("Home_Dashboards.aspx","Dashboard list is up to date");return}Mscrm.CrmCrossBrowser.getLocalStorage(window.self).setItem("cache.usersDashboards.hash",$v_2);if(isNullOrEmptyString($v_3))return;Xrm.Internal.trace.log("Home_Dashboards.aspx","Redirecting to update dashboard list");window.location.reload(true)});return $v_1};Mscrm.TopBottomScrollRestriction=function($p0){this.$$d_$f_0=Function.createDelegate(this,this.$f_0);this.$$d_$g_0=Function.createDelegate(this,this.$g_0);if(!$p0)throw Error.argumentNull("panel");this.$2_0=$p0;$addHandler(this.$2_0,"touchstart",this.$$d_$g_0);$addHandler(this.$2_0,"touchmove",this.$$d_$f_0)};Mscrm.TopBottomScrollRestriction.prototype={$C_0:false,$I_0:false,$H_0:0,$2_0:null,dispose:function(){$removeHandler(this.$2_0,"touchstart",this.$$d_$g_0);$removeHandler(this.$2_0,"touchmove",this.$$d_$f_0)},$g_0:function($p0){this.$H_0=$p0.clientY;this.$I_0=this.$2_0.scrollTop<=0;this.$C_0=this.$2_0.scrollTop>=this.$2_0.scrollHeight-this.$2_0.clientHeight},$f_0:function($p0){var $v_0=this.$H_0-$p0.clientY;if($v_0<0&&this.$I_0||$v_0>0&&this.$C_0){$p0.preventDefault();$p0.stopPropagation()}else $p0.stopPropagation()}};Mscrm.DashboardPage.registerClass("Mscrm.DashboardPage");Mscrm.DashboardSelector.registerClass("Mscrm.DashboardSelector",Mscrm.CrmUIControl);Mscrm.HomeDashboardsPage.registerClass("Mscrm.HomeDashboardsPage");Mscrm.TopBottomScrollRestriction.registerClass("Mscrm.TopBottomScrollRestriction",null,Sys.IDisposable)