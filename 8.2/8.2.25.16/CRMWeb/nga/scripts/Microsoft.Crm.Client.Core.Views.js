Type.registerNamespace("Microsoft.Crm.Client.Core.Commands");Microsoft.Crm.Client.Core.Commands.PinCommand=function(n,t){this.$$d_$3HL=Function.createDelegate(this,this.$3HL);this.$$d_$wr=Function.createDelegate(this,this.$wr);this.$$d_$31=Function.createDelegate(this,this.$31);Microsoft.Crm.Client.Core.Commands.PinCommand.initializeBase(this);var i=t.InitializationParameters;this.set_$2e(this.$$d_$31);this.$Be=n;this.$X=i.TargetViewModel;this.$Ir=i.StartScreen?"{D04E4181-ED85-4305-A3DC-3DA59C00F25B}":Microsoft.Crm.Client.Core.Framework.Guid.get_empty().toString();this.$1Ea="IsBoundToScreen"in i&&i.IsBoundToScreen;this.$1bk=this.$Be.$1D;this.$22h();this.get_CanExecute()&&(this.$wr(),Microsoft.Crm.Client.Core.ViewModels.ListComponentViewModel.isInstanceOfType(this.$X)&&(this.$142=this.$$d_$wr,this.$X.add_$130(this.$142)))};Microsoft.Crm.Client.Core.Commands.PinCommand.$$cctor=function(){Microsoft.Crm.Client.Core.ViewModels.CommandFactory.$1c("PinCommand",Microsoft.Crm.Client.Core.Commands.PinCommand.$10)};Microsoft.Crm.Client.Core.Commands.PinCommand.$1jg=function(){Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$34H(function(n){Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$XA(new Microsoft.Crm.Client.Core.Framework.Guid("{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"),Microsoft.Crm.Client.Core.Commands.PinCommand.get_$f()).done(function(t){for(var h,i,r=new(Microsoft.Crm.Client.Core.Framework.List$1.$$(Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p)),e=new(Microsoft.Crm.Client.Core.Framework.List$1.$$(String)),o={},s=n,l=s.length,u=0;u<l;++u)h=s[u],o[h]=null;for(var c=t.$E6,a=c.length,f=0;f<a;++f)i=c[f],i.$Al.toString()in o||(r.add(i),e.add(i.$Al.toString()));r.get_Count()>0&&(Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$lV(new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$3G(new Microsoft.Crm.Client.Core.Framework.Guid("{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"),r.toArray()),Microsoft.Crm.Client.Core.Commands.PinCommand.get_$f()),Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$2hq(e.toArray()))})})};Microsoft.Crm.Client.Core.Commands.PinCommand.get_$f=function(){return Microsoft.Crm.Client.Core.Framework.$G.$b("","PinCommand")};Microsoft.Crm.Client.Core.Commands.PinCommand.$10=function(n,t){return new Microsoft.Crm.Client.Core.Commands.PinCommand(n,t)};Microsoft.Crm.Client.Core.Commands.PinCommand.$2jD=function(n){var i=window.document.createElement("img"),t,r;return i.setAttribute("src",n),t=window.document.createElement("canvas"),t.width=i.getAttribute("width"),t.height=i.getAttribute("height"),t.getContext("2d").drawImage(i,0,0),r=t.toDataURL("image/png"),r.substr(22)};Microsoft.Crm.Client.Core.Commands.PinCommand.prototype={$Be:null,$X:null,$Ir:null,$1Ea:!1,$1bk:null,$142:null,$2G:null,$1dw:null,$3HL:function(n,t){this.$2G===t.$2G&&this.$wr()},$26W:function(){var r=Microsoft.Crm.Client.Core.Framework.Guid.tryCreate(this.$Ir),u,h,f,c,i,e,o,s;if(!Microsoft.Crm.Client.Core.Framework.$3.$9(this.$X.get_$2R())&&Microsoft.Crm.Client.Core.ViewModels.ListComponentViewModel.isInstanceOfType(this.$X)&&(u=this.$X,!$0.$1(u.$h)))return Microsoft.Crm.Client.Core.Models.$3U.$B(new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p(r,this.$X.get_$2R(),new Microsoft.Crm.Client.Core.Framework.Guid(u.$h),1,u.$9c));if(!$0.$1(this.$X.get_$1K()))return h=this.$X.get_$1K(),Microsoft.Crm.Client.Core.Models.$3U.$VH(r,h.$M);if(this.$X.$o===1&&(f=this.$X,!$0.$1(f.$h)))return c="IsPowerBIDashboard="+f.$1F8.toString(),Microsoft.Crm.Client.Core.Models.$3U.$B(new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p(r,"Workspace".toUpperCase(),new Microsoft.Crm.Client.Core.Framework.Guid(f.$h),4,c));if(this.$X.$o===50){var l=this.$X.get_Root(),t=l.$BH.powerBIFullScreenComponent,n={};n.externalContextPowerBIUrl=t.$Uj;n.dashboardId=t.$Xu;n.tileId=t.$c6;n.reportId=t.$jy;n.reportEmbedUrl=t.$qd;n.powerBIComponentType=t.$c5;i="";e=n;for(o in e)s={key:o,value:e[o]},i+=String.format("{0}={1}&",CrmEncodeDecode.CrmUrlEncode(s.key),CrmEncodeDecode.CrmUrlEncode(s.value));return i=i.substring(0,i.length-1),Microsoft.Crm.Client.Core.Models.$3U.$B(new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p(r,"PowerBIFullScreenPage".toUpperCase(),Microsoft.Crm.Client.Core.Framework.Guid.get_empty(),5,i))}return Microsoft.Crm.Client.Core.Framework.Trace.logError(1014,"Attempted to pin with unrecognized context."),Error.invalidOperation("Attempted to pin with unrecognized context."),null},$22h:function(){var n,t;this.$1Ea&&this.$Ir!==Microsoft.Crm.Client.Core.Framework.Guid.get_empty().toString()?Error.argument("descriptor","Pin command must have empty ScreenId if it is bound to the pin screen."):!this.$1Ea&&Microsoft.Crm.Client.Core.Framework.$3.$9(this.$Ir)&&Error.argument("descriptor","Pin command must have non-empty ScreenId if not bound to the pin screen.");n=!$0.$1(this.$X);(this.$X.get_$2R()==="opportunityproduct"||this.$X.get_$2R()==="productpricelevel")&&(n=!1);this.$Ir!=="{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"||Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$20||(n=!1);this.$X.get_$Dt()&&(n=!1);Microsoft.Crm.Client.Core.ViewModels.ListComponentViewModel.isInstanceOfType(this.$X)&&(t=this.$X,Microsoft.Crm.Client.Core.Framework.$3.$9(t.$9c)||(n=!1),this.$1Ea&&(n=!1),!Microsoft.Crm.Client.Core.ViewModels.MultilineListViewModel.isInstanceOfType(t)||t.$f8||Microsoft.Crm.Client.Core.Framework.DeviceConfiguration.get_$4V()||(n=!1));this.set_CanExecute(n)},$wr:function(){var t,n,i;this.$3w||(t=this.$26W(),$0.$1(t))||($0.$1(this.$2G)&&(this.$2G=t.get_$2p().get_$4z(),Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.get_$6Q().$1iD(Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p,this.$2G,this.$$d_$3HL)),this.$Ir==="{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"&&Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$20&&this.$3VT(1e3),n=this,i=this,t.$27C().then(function(t){if(!$0.$1(n.$Be)){var i=n.$Be.$Hs;t?(n.$Be.set_Label(Microsoft.Crm.Client.Core.Framework.$3.$MN(Microsoft.Crm.Client.Core.Framework.Common.$2.$6("L_PinCommand_Unpin_Text"),n.$1bk)),i["data-pinned"]="1",Microsoft.Crm.Client.Core.ViewModels.$8k.isInstanceOfType(n.$Be)&&n.$Be.set_ImageName("Unpin")):(n.$Be.set_Label(Microsoft.Crm.Client.Core.Framework.$3.$MN(Microsoft.Crm.Client.Core.Framework.Common.$2.$6("L_PinCommand_Pin_Text"),n.$1bk)),i["data-pinned"]=null,Microsoft.Crm.Client.Core.ViewModels.$8k.isInstanceOfType(n.$Be)&&n.$Be.set_ImageName("Pin"));n.$Be.set_TestabilityAttributes(i)}},function(n){Error.create(String.format("PinCommand has failed in UpdateLabelAndIcon:\n\n {0}",n.$E))}))},$3VT:function(n){var t=new Date;(!this.$1dw||t.getTime()-this.$1dw.getTime()>n)&&(this.$1dw=new Date,Microsoft.Crm.Client.Core.Commands.PinCommand.$1jg())},$31:function(){var t=this.$26W(),n=this,i=this;t.$27C().then(function(i){if(i)n.$Ir==="{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"?Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$2nf(t.get_$2p().$Al.toString(),n.$Be.$v4,n.$Be.$v5,Number.parseInvariant(n.$Be.$IR.toString()),Number.parseInvariant(n.$Be.$G4.toString()),function(i){i&&(n.$1BQ(t.get_$2p()),window.document.body.focus())}):n.$1BQ(t.get_$2p());else if(n.$Ir==="{D04E4181-ED85-4305-A3DC-3DA59C00F25B}"){var e={forcerefresh:!0,pinnedtilemodel:t},f=new Microsoft.Crm.Client.Core.Models.Descriptors.ViewModel.QueryDescriptor("PopulateTileData",e),r,u;Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().$u4?(r=window.innerWidth/2-Number.parseInvariant(n.$Be.$G4.toString())/2,u=window.innerHeight/2):(r=n.$Be.$v4,u=n.$Be.$v5);f.OnSuccess=function(){var f=new Microsoft.Crm.Client.Core.Models.Tiles.Factories.$J0,i=f.$2A0(t),e=n.$3W7("CRM "+i.get_LeftCornerText());Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$2mK(t.get_$2p().$Al.toString(),n.$2g1(t.get_$2p()),e,i.get_$KT(),r,u,Number.parseInvariant(n.$Be.$IR.toString()),Number.parseInvariant(n.$Be.$G4.toString()),function(r,u){if(r){n.$2VU(t.get_$2p());var f=Microsoft.Crm.Client.Core.Commands.PinCommand.$2jD(i.get_$1Uh());Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().$UY.$3QS(t.get_$2p().$Al.toString(),i.get_$3Ug(),i.get_$3Uh(),i.get_$1KZ(),i.get_$3Z9(),f,u.length?"name":"none");Microsoft.Crm.Client.Core.ViewModels.ApplicationShellViewModel.get_instance().get_$1AY().collapse()}})};Microsoft.Crm.Client.Core.ViewModels.ApplicationShellViewModel.get_instance().$2Y("ActionProvider",n.$X,f)}else n.$2VU(t.get_$2p())},function(n){Error.create(String.format("PinCommand has failed in OnExecute:\n\n {0}",n.$E))})},$3W7:function(n){return Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().$fl&&n.length>15&&(n=n.substr(0,14)+"â€¦"),n},$2VU:function(n){var t=this,i=this;Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$l6(n).then(function(){Microsoft.Crm.Client.Core.Framework.$B.$1g("PinCommand_OnExecute_CreateTile_Success",1014,n.get_$4z());t.$wr();Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$XA(n.$Gi,Microsoft.Crm.Client.Core.Commands.PinCommand.get_$f())},function(n){Error.create(String.format("PinCommand has failed in CreatePinnedTile:\n\n {0}",n.$E))})},$1BQ:function(n){var t=this,i=this;Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$lU(n).then(function(){Microsoft.Crm.Client.Core.Framework.$B.$1g("PinCommand_OnExecute_DeleteTile_Success",1014,n.get_$4z());t.$wr();Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.$XA(n.$Gi,Microsoft.Crm.Client.Core.Commands.PinCommand.get_$f())},function(n){Error.create(String.format("PinCommand has failed in DeletePinnedTile:\n\n {0}",n.$E))})},$2g1:function(n){var t;switch(n.$AO){case 1:t="entitylist";break;case 4:t="dashboard";break;default:t="entityrecord"}return Microsoft.Crm.Client.Core.Framework.$3.$MN("{0}={1}&{2}={3}&{4}={5}","navetn",CrmEncodeDecode.CrmUrlEncode(n.$85),"navid",CrmEncodeDecode.CrmUrlEncode(n.$Al.toString()),"navpagetype",CrmEncodeDecode.CrmUrlEncode(t))},$GX:function(){$0.$1(this.$142)||$0.$1(this.$X)||(this.$X.remove_$130(this.$142),this.$142=null);this.$X=null;this.$Be=null;$0.$1(this.$2G)||Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.$3.get_$6Q().$1yY(Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.$1p,this.$2G,this.$$d_$3HL);Microsoft.Crm.Client.Core.Framework.Binding.$3a.prototype.$GX.call(this)}};Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand=function(){this.$$d_$31=Function.createDelegate(this,this.$31);Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.initializeBase(this);this.set_$2e(this.$$d_$31)};Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.$$cctor=function(){Microsoft.Crm.Client.Core.ViewModels.CommandFactory.$1c("ShowPerformanceCommand",Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.$10)};Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.$10=function(){return new Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand};Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.prototype={$31:function(){Microsoft.Crm.Client.Core.ViewModels.PerformanceReport.TogglePerformanceResultsVisibility()}};Microsoft.Crm.Client.Core.Commands.PinCommand.registerClass("Microsoft.Crm.Client.Core.Commands.PinCommand",Microsoft.Crm.Client.Core.Framework.Binding.$3a);Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.registerClass("Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand",Microsoft.Crm.Client.Core.Framework.Binding.$3a);Microsoft.Crm.Client.Core.Commands.PinCommand.$$cctor();Microsoft.Crm.Client.Core.Commands.ShowPerformanceCommand.$$cctor()
//# sourceMappingURL=../../../../../../../../../../Symbols/retail/amd64/jsmin/Microsoft.Crm.Client.Core.Views.js.srcmap
