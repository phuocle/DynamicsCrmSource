define("Core/ReactTypescriptAdapter",["require","exports"],function(require,exports){function createComponent(spec){return React.createFactory(React.createClass(extractMembers(spec)))}exports.createComponent=createComponent;function createMixin(mixin){return extractMembers(mixin)}exports.createMixin=createMixin;function extractMembers(mixin){var skipList=["constructor","forceUpdate"],indexableMixin=mixin,members={};for(var key in indexableMixin)if(skipList.indexOf(key)===-1)members[key]=indexableMixin[key];return members}var SpecBase=function(){function SpecBase(){}return SpecBase}();exports.SpecBase=SpecBase});define("Core/ComponentUpdateRequestManager",["require","exports"],function(require,exports){var ComponentUpdateRequestManager=function(){function ComponentUpdateRequestManager(component){this.component=component;this.throttleTimerId=-1}ComponentUpdateRequestManager.prototype.requestUpdate=function(reason){var _this=this;if(this.throttleTimerId===-1)this.throttleTimerId=window.setTimeout(function(){var _reason=reason;_this.throttleTimerId=-1;_this.component.isMounted()&&_this.component.forceUpdate()},0)};return ComponentUpdateRequestManager}();return ComponentUpdateRequestManager});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/PureUpdateMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){function propertyObjectsEqual(objA,objB){if(objA===objB)return true;if(typeof objA!=="object"||objA===null||typeof objB!=="object"||objB===null)return false;if(objA instanceof Date&&objB instanceof Date)return objA.getTime()===objB.getTime();var keysA=Object.keys(objA),keysB=Object.keys(objB),keysALength=keysA.length;if(keysALength!==keysB.length)return false;for(var i=0;i<keysALength;i++){var keyA=keysA[i],subobjA=objA[keyA],subobjB=objB[keyA];if(subobjA!==subobjB)if(!propertyObjectsEqual(subobjA,subobjB))return false}return true}exports.propertyObjectsEqual=propertyObjectsEqual;var PureUpdateMixin=function(_super){__extends(PureUpdateMixin,_super);function PureUpdateMixin(){_super.apply(this,arguments)}PureUpdateMixin.prototype.shouldComponentUpdate=function(nextProps,nextState){var userAgent=Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance();if(userAgent.get_IsInteractionCentricDashboard())return true;if(nextProps.forceUpdate)return true;if(!propertyObjectsEqual(this.props,nextProps))return true;if(!propertyObjectsEqual(this.state,nextState))return true;return false};return PureUpdateMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new PureUpdateMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/DataWrapperComponent",["require","exports","Core/ReactTypescriptAdapter","Core/ComponentUpdateRequestManager","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,ComponentUpdateRequestManager,PureUpdate){var DataWrapperComponentSpec=function(_super){__extends(DataWrapperComponentSpec,_super);function DataWrapperComponentSpec(componentDisplayName,wrappedComponent,listenToViewModels,immediateUpdates){if(immediateUpdates===void 0)immediateUpdates=false;_super.call(this);this.mixins=[PureUpdate.Mixin];this.displayName=componentDisplayName+"DataWrapper";this.wrappedComponent=wrappedComponent;this.listenToViewModels=listenToViewModels;this.immediateUpdates=immediateUpdates}DataWrapperComponentSpec.prototype.updateCollectionSubscriptions=function(listenToCollections,viewModel,subscribe){if(!listenToCollections)return;for(var i=0,len=listenToCollections.length;i<len;i++){var propName="get_"+listenToCollections[i],collectionGetter=viewModel[propName];if(!collectionGetter){console.warn("[DataWrapperComponent] Invalid collection property name: "+listenToCollections[i]);continue}var collection=collectionGetter.call(viewModel);if(collection)if(subscribe)collection.add_CollectionChanged(this.onCollectionChanged);else collection.remove_CollectionChanged(this.onCollectionChanged)}};DataWrapperComponentSpec.prototype.subscribeToViewModelProperties=function(listenToProperties,viewModel){if(listenToProperties)for(var i=0,len=listenToProperties.length;i<len;i++)viewModel.apcl(listenToProperties[i],this.onPropertyChanged)};DataWrapperComponentSpec.prototype.unsubscribeFromViewModelProperties=function(listenToProperties,viewModel){if(listenToProperties)for(var i=0,len=listenToProperties.length;i<len;i++)viewModel.rpcl(listenToProperties[i],this.onPropertyChanged)};DataWrapperComponentSpec.prototype.subscribeToViewModelUpdates=function(listenInfo,viewModel){this.subscribeToViewModelProperties(listenInfo.listenToProperties,viewModel);this.updateCollectionSubscriptions(listenInfo.listenToCollections,viewModel,true)};DataWrapperComponentSpec.prototype.unsubscribeFromViewModelUpdates=function(listenInfo,viewModel){this.unsubscribeFromViewModelProperties(listenInfo.listenToProperties,viewModel);this.updateCollectionSubscriptions(listenInfo.listenToCollections,viewModel,false)};DataWrapperComponentSpec.prototype.getInstanceDisplayName=function(){var constructor=this.constructor;return constructor.displayName};DataWrapperComponentSpec.prototype.onPropertyChanged=function(sender,propertyName){var context=sender;if(!context.get_IsDisposed()&&!context.get_IsDisposing()){var reason=this.getInstanceDisplayName()+" updating due to "+propertyName+" view model property change";Microsoft.Crm.Client.Core.Framework.Trace.logPerf(128,reason);if(this.immediateUpdates)this.forceUpdate();else this.updateManager.requestUpdate(reason)}};DataWrapperComponentSpec.prototype.onCollectionChanged=function(event){var reason=this.getInstanceDisplayName()+" updating due to view model collection change";Microsoft.Crm.Client.Core.Framework.Trace.logPerf(128,reason);if(this.immediateUpdates)this.forceUpdate();else this.updateManager.requestUpdate(reason)};DataWrapperComponentSpec.prototype.componentWillMount=function(){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);for(var viewModelProp in this.listenToViewModels){var viewModel=this.props[viewModelProp];viewModel&&this.subscribeToViewModelUpdates(this.listenToViewModels[viewModelProp],viewModel)}};DataWrapperComponentSpec.prototype.componentWillUnmount=function(){for(var viewModelProp in this.listenToViewModels){var viewModel=this.props[viewModelProp];viewModel&&this.unsubscribeFromViewModelUpdates(this.listenToViewModels[viewModelProp],viewModel)}};DataWrapperComponentSpec.prototype.componentWillReceiveProps=function(nextProps){for(var viewModelProp in this.listenToViewModels){var viewModel=this.props[viewModelProp],newViewModel=nextProps[viewModelProp];if(viewModel!==newViewModel){viewModel&&this.unsubscribeFromViewModelUpdates(this.listenToViewModels[viewModelProp],viewModel);newViewModel&&this.subscribeToViewModelUpdates(this.listenToViewModels[viewModelProp],newViewModel)}}};DataWrapperComponentSpec.prototype.render=function(){return this.wrappedComponent(this.props)};return DataWrapperComponentSpec}(TsAdapter.SpecBase);function wrapComponent(spec,immediateUpdates){if(immediateUpdates===void 0)immediateUpdates=false;var listenToViewModels=spec.listenToViewModels;if(!listenToViewModels)listenToViewModels={dataContext:{listenToProperties:spec.listenToProperties,listenToCollections:spec.listenToCollections}};return TsAdapter.createComponent(new DataWrapperComponentSpec(spec.displayName,TsAdapter.createComponent(spec),listenToViewModels,immediateUpdates))}exports.wrapComponent=wrapComponent});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/CustomEventsListenerMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var EventListenerAction;(function(EventListenerAction){EventListenerAction[EventListenerAction["Subscribe"]=0]="Subscribe";EventListenerAction[EventListenerAction["Unsubscribe"]=1]="Unsubscribe"})(EventListenerAction||(EventListenerAction={}));var CustomEventsListenerMixin=function(_super){__extends(CustomEventsListenerMixin,_super);function CustomEventsListenerMixin(){_super.apply(this,arguments);this.listenToEvents={}}CustomEventsListenerMixin.prototype.updateEventListeners=function(dataContext,action){var action_prefix;switch(action){case EventListenerAction.Subscribe:action_prefix="add_";break;case EventListenerAction.Unsubscribe:action_prefix="remove_";break;default:throw"Unexpected event listener action type."}for(var eventName in this.listenToEvents){var handler=this.listenToEvents[eventName],propName=action_prefix+eventName,eventAddMethod=dataContext[propName];eventAddMethod&&eventAddMethod.call(dataContext,handler)}};CustomEventsListenerMixin.prototype.componentWillMount=function(){this.listenToEvents=this.configureEventListeners();this.props.dataContext&&this.updateEventListeners(this.props.dataContext,EventListenerAction.Subscribe)};CustomEventsListenerMixin.prototype.componentWillUnmount=function(){this.props.dataContext&&this.updateEventListeners(this.props.dataContext,EventListenerAction.Unsubscribe)};CustomEventsListenerMixin.prototype.componentWillReceiveProps=function(nextProps){if(this.props.dataContext!==nextProps.dataContext){this.props.dataContext&&this.updateEventListeners(this.props.dataContext,EventListenerAction.Unsubscribe);nextProps.dataContext&&this.updateEventListeners(nextProps.dataContext,EventListenerAction.Subscribe)}};return CustomEventsListenerMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new CustomEventsListenerMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ConfirmDialog",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var ConfirmDialogSpec=function(_super){__extends(ConfirmDialogSpec,_super);function ConfirmDialogSpec(){_super.apply(this,arguments);this.displayName="ConfirmDialog"}ConfirmDialogSpec.prototype.shouldComponentUpdate=function(){return false};ConfirmDialogSpec.prototype.render=function(){var content=React.DOM.div({key:"content",className:"messageDialog-popupContent"},React.DOM.div({className:"messageDialog-contentContainer"},React.DOM.span({className:"messageDialog-message"},[React.DOM.span({key:"title",id:"ConfirmDialogTitle",className:"messageDialog-Title","data-id":"messageDialogTitle"}),React.DOM.div({key:"message",id:"ConfirmDialogMessage",className:"messageDialog-Message messageDialog-MessageBody","data-id":"messageDialogMessage"})]))),okButton=React.DOM.button({key:"okbutton",id:"ConfirmDialogYes",tabIndex:-1,className:"button dynamicsButton messageDialog_OK_Button",role:"button","aria-labelledby":"ConfirmDialogYesLabel","data-id":"Ok"},React.DOM.div({className:"button-container"},[React.DOM.span({key:"ring",className:"button-commandRing"}),React.DOM.span({key:"label",className:"button-label",id:"ConfirmDialogYesLabel"})])),noButton=React.DOM.button({key:"nobutton",id:"ConfirmDialogNo",tabIndex:-1,className:"button dynamicsButton messageDialog_Cancel_Button",role:"button","aria-labelledby":"ConfirmDialogNoLabel","data-id":"Cancel"},React.DOM.div({className:"button-container"},[React.DOM.span({key:"ring",className:"button-commandRing"}),React.DOM.span({key:"label",className:"button-label",id:"ConfirmDialogNoLabel"})])),actionContainer=React.DOM.div({key:"action",className:"messageDialog-actionContainer"},React.DOM.span({className:"messageDialog-buttons"},React.DOM.span({className:"messageDialog-buttonContainer"},[okButton,noButton])));return React.DOM.div({id:"ConfirmDialog",tabIndex:-1,className:"popupShadow conductorContent messageDialog-popup-OkCancel information",role:"dialog",style:{zIndex:1002,display:"none"},"data-id":"messageDialog"},content,actionContainer)};return ConfirmDialogSpec}(TsAdapter.SpecBase);exports.ConfirmDialog=TsAdapter.createComponent(new ConfirmDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/AuthenticationManager",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var AuthenticationManagerSpec=function(_super){__extends(AuthenticationManagerSpec,_super);function AuthenticationManagerSpec(){_super.apply(this,arguments);this.displayName="AuthenticationManager"}AuthenticationManagerSpec.prototype.shouldComponentUpdate=function(){return false};AuthenticationManagerSpec.prototype.render=function(){return React.DOM.form({method:"POST",id:"authForm",target:"authFrame"},[React.DOM.input({key:"wa",type:"hidden",name:"wa",value:"wsignin1.0"}),React.DOM.input({key:"token",type:"hidden",id:"authToken",name:"wresult",value:""}),React.DOM.input({key:"wctx",type:"hidden",id:"wctx",name:"wctx",value:""})])};return AuthenticationManagerSpec}(TsAdapter.SpecBase);exports.AuthenticationManager=TsAdapter.createComponent(new AuthenticationManagerSpec)});define("Utils/DeferredPromise",["require","exports"],function(require,exports){var DeferredPromise=function(){function DeferredPromise(promise){var _this=this;this.resolved=false;this.rejected=false;this.resolvedValue=null;this.rejectedError=null;if(promise){this.wrappedPromise=promise;if(this.wrappedPromise.isFulfilled()){this.resolved=true;this.resolvedValue=this.wrappedPromise.value()}else if(this.wrappedPromise.isRejected()){this.rejected=true;this.rejectedError=this.wrappedPromise.reason()}}else this.wrappedPromise=new Promise.Promise(function(resolve,reject){_this.nativeResolve=resolve;_this.nativeReject=reject})}DeferredPromise.prototype.isPending=function(){return !this.resolved&&!this.rejected};DeferredPromise.prototype.all=function(){for(var deferreds=[],_i=0;_i<arguments.length;_i++)deferreds[_i-0]=arguments[_i];return this.allArray(deferreds)};DeferredPromise.prototype.allArray=function(deferreds){return new DeferredPromise(Promise.all(deferreds))};DeferredPromise.prototype.always=function(callback){if(this.resolved){callback(this.resolvedValue);return this}if(this.rejected){callback(this.rejectedError);return this}this.wrappedPromise.then(callback,callback);return this};DeferredPromise.prototype.done=function(callback){if(this.rejected)return this;if(this.resolved){callback(this.resolvedValue);return this}this.wrappedPromise.then(callback,undefined);return this};DeferredPromise.prototype.fail=function(callback){if(this.resolved)return this;if(this.rejected){callback(this.rejectedError);return this}this.wrappedPromise.then(undefined,callback);return this};DeferredPromise.prototype.then=function(success,failure){if(this.resolved){success(this.resolvedValue);return this}if(this.rejected){failure(this.rejectedError);return this}this.wrappedPromise.then(success,failure);return this};DeferredPromise.prototype.isRejected=function(){return this.rejected};DeferredPromise.prototype.isResolved=function(){return this.resolved};DeferredPromise.prototype.promise=function(){return this};DeferredPromise.prototype.reject=function(error){if(!this.isPending())return this;this.rejected=true;this.rejectedError=error;this.nativeReject(error);return this};DeferredPromise.prototype.resolve=function(result){if(!this.isPending())return this;this.resolved=true;this.resolvedValue=result;this.nativeResolve(result);return this};return DeferredPromise}();exports.DeferredPromise=DeferredPromise;function DeferredPromiseFactory(){return new DeferredPromise}exports.DeferredPromiseFactory=DeferredPromiseFactory});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/CustomScriptsFrameObject",["require","exports","Core/ReactTypescriptAdapter","Utils/DeferredPromise","Core/Binding/CustomEventsListenerMixin"],function(require,exports,TsAdapter,DeferredPromise,CustomEventsListener){var ClientApiWrapperRelativePath="scripts/ClientApiWrapper.js",AuthTokenHeaderAttacherRelativePath="scripts/AuthTokenHeaderAttacher.js",MicrosoftAjaxRelativePath="scripts/MicrosoftAjax.js",CommandBarActionsRelativePath="../_static/_common/scripts/CommandBarActions.js",SharedRibbonActionsRelativePath="../_static/_common/scripts/SharedRibbonActions.js",BlankSrcRelativePath="../_static/blank.htm",CustomScriptsFrameObjectSpec=function(_super){__extends(CustomScriptsFrameObjectSpec,_super);function CustomScriptsFrameObjectSpec(){_super.apply(this,arguments);this.displayName="CustomScriptsFrameObject";this.mixins=[CustomEventsListener.Mixin];this.schedulerOwnerToken=null;this.filesToLoad=[];this.initialized=false;this.loadingScriptDeferreds=[];this._stackObjectsLoading=0}CustomScriptsFrameObjectSpec.prototype.getStackObjectsLoading=function(){return this._stackObjectsLoading};CustomScriptsFrameObjectSpec.prototype.setStackObjectsLoading=function(value){this._stackObjectsLoading=value;this._stackObjectsLoading<=0&&$(window).trigger("NoCustomScriptsLoading")};CustomScriptsFrameObjectSpec.prototype.getInitialState=function(){return {renderIframe:this.props.dataContext.get_DeferredLoad()?false:true}};CustomScriptsFrameObjectSpec.prototype.configureEventListeners=function(){return {ScriptStringAdded:this.addScriptNodeFromString,LoadAndRun:this.loadAndRun}};CustomScriptsFrameObjectSpec.prototype.shouldComponentUpdate=function(nextProps,nextState){if(nextState.renderIframe!==this.state.renderIframe)return true;return false};CustomScriptsFrameObjectSpec.prototype.componentWillMount=function(){this.schedulerOwnerToken=this.props.clientContext.schedulerCreateOwnerToken();this.filesToLoad=[this.generateVersionedFilename(MicrosoftAjaxRelativePath),this.generateVersionedFilename(ClientApiWrapperRelativePath),this.generateVersionedFilename(CommandBarActionsRelativePath),this.generateVersionedFilename(SharedRibbonActionsRelativePath)];this.props.clientContext.isMailApp&&this.filesToLoad.push(this.generateVersionedFilename(AuthTokenHeaderAttacherRelativePath));this.setStackObjectsLoading(this.getStackObjectsLoading()+1)};CustomScriptsFrameObjectSpec.prototype.componentDidMount=function(){var _this=this;if(!this.state.renderIframe)this.schedule(function(){_this.setState({renderIframe:true})},"CustomScriptsFrameObject.NewContextLoadDeferred.LoadIFrame");else this.handleIframeLoad()};CustomScriptsFrameObjectSpec.prototype.componentDidUpdate=function(){this.state.renderIframe&&this.handleIframeLoad()};CustomScriptsFrameObjectSpec.prototype.componentWillUnmount=function(){this.unbind();this.clear()};CustomScriptsFrameObjectSpec.prototype.onInitialized=function(){if(this.filesToLoad.length===0){this.initialized=true;while(this.props.dataContext.get_Active()&&this.props.dataContext.get_ContainerViewModel().get_ProcessedHandlersQueue().length>0)this.loadAndRun();this.setStackObjectsLoading(this.getStackObjectsLoading()-1)}};CustomScriptsFrameObjectSpec.prototype.clear=function(){this.props.dataContext.set_StaticLibrariesLoaded(null);this.props.dataContext.set_LibrariesLoaded(null);this.schedulerOwnerToken.cancelAll();this.cancelLoadingScripts();!this.initialized&&this.setStackObjectsLoading(this.getStackObjectsLoading()-1)};CustomScriptsFrameObjectSpec.prototype.unbind=function(){var node=ReactDOM.findDOMNode(this);if(node&&node.contentDocument){var iframeBody=node.contentDocument.body;while(iframeBody.firstChild)iframeBody.removeChild(iframeBody.firstChild)}};CustomScriptsFrameObjectSpec.prototype.loadAndRun=function(){if(this.initialized){var handlerModel=this.props.dataContext.get_ContainerViewModel().get_ProcessedHandlersQueue().shift();handlerModel.preRunCallback&&handlerModel.preRunCallback();if(handlerModel.scriptsToLoad&&handlerModel.scriptsToLoad.get_Count()>0)for(var i=0;i<handlerModel.scriptsToLoad.get_Count();i++)this.addScriptNodeFromString(handlerModel.scriptsToLoad.get_Items()[i],handlerModel.srcName.get_Items()[i]);this.runHandlers(handlerModel)}};CustomScriptsFrameObjectSpec.prototype.runHandlers=function(handlerModel){var handlersToRun=handlerModel.handlers.toArray(),runCompleteCallback=handlerModel.runCompleteCallback,resultCount=handlersToRun?handlersToRun.length:0,results=[];if(resultCount>0)for(var executionContext,i=0;i<resultCount;i++){var method=handlersToRun[i];if(method.passExecutionContext!=null&&method.passExecutionContext.toString()==="true"){executionContext=this.props.dataContext.get_ContainerViewModel().get_ExecutionContextFactory().getExecutionContext(handlerModel,i,executionContext);method.executionContext=executionContext}results[i]=this.invokeMethod(method,handlerModel.details,handlerModel.srcName.get_Items()[i])}runCompleteCallback&&runCompleteCallback(results,handlerModel.eventArgs)};CustomScriptsFrameObjectSpec.prototype.invokeMethod=function(method,eventDetails,srcName){if(!method)return null;try{var scope=ReactDOM.findDOMNode(this).contentWindow;scope=scope.Mscrm;var wrapperParams=[];wrapperParams[1]=eventDetails;wrapperParams[3]=method;if(method.method){wrapperParams[0]=method.method;wrapperParams[2]=method.parameters;wrapperParams[4]=method.executionContext;wrapperParams[5]=srcName;return scope.RunHandlerWithHandlerObject.apply(null,wrapperParams)}else{wrapperParams[0]=method.functionName;var parameterArray=[];if(method.executionContext)parameterArray[0]=method.executionContext;if(method.parameterArray)parameterArray=parameterArray.concat(method.parameterArray);wrapperParams[2]=parameterArray;wrapperParams[4]=srcName;return scope.RunHandlerWithHandlerName.apply(null,wrapperParams)}}catch(e){var exception=e;Microsoft.Crm.Client.Core.Framework.Trace.logWarning(1016,'Method "'+method.functionName+'" has errors: '+exception.get_Message())}return null};CustomScriptsFrameObjectSpec.prototype.cancelLoadingScripts=function(){for(var i=0;i<this.loadingScriptDeferreds.length;i++)this.loadingScriptDeferreds[i].reject();this.loadingScriptDeferreds=[]};CustomScriptsFrameObjectSpec.prototype.addScriptNodeFromString=function(scriptBlob,srcName){var scope=this,script=document.createElement("script");script.type="text/javascript";script.text=scriptBlob;var node=ReactDOM.findDOMNode(this);if(node){node.contentDocument.body.onerror=function(evt){scope.scriptErrorHandler(evt,srcName)};node.contentDocument.body.appendChild(script)}};CustomScriptsFrameObjectSpec.prototype.scriptErrorHandler=function(evt,srcName){try{var scope=ReactDOM.findDOMNode(this).contentWindow;scope=scope.Mscrm;var wrapperParams=[];wrapperParams[0]=evt.error.message;wrapperParams[1]="";wrapperParams[2]=srcName;wrapperParams[3]="";wrapperParams[4]=evt.error.stack;scope.handleErrorDisplay.apply(null,wrapperParams)}catch(e){var exception=e,errorMessage=exception.get_Message==null||exception.get_Message==undefined?e.message:exception.get_Message();Microsoft.Crm.Client.Core.Framework.Trace.logWarning(1016," has errors: "+errorMessage)}};CustomScriptsFrameObjectSpec.prototype.addScriptNodeFromSrc=function(fileFullPath,onLoadCallback){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.set_HighPriorityBrowserAsyncWorkCount(Microsoft.Crm.Client.Core.Framework.Scheduler.get_HighPriorityBrowserAsyncWorkCount()+1);var perfSW=this.props.clientContext.getPerformanceStopwatch("CustomScriptsFrameObject.AddScriptNodeFromSrc");perfSW.start();var script=document.createElement("script");script.type="text/javascript";script.src=fileFullPath;var jqScript=$(script),deferred=new DeferredPromise.DeferredPromise;this.loadingScriptDeferreds.push(deferred);deferred.done(function(loadEvent){_this.filesToLoad.splice(_this.filesToLoad.indexOf(fileFullPath),1);onLoadCallback(loadEvent)}).always(function(e){jqScript.unbind();perfSW.stop();Microsoft.Crm.Client.Core.Framework.Scheduler.set_HighPriorityBrowserAsyncWorkCount(Microsoft.Crm.Client.Core.Framework.Scheduler.get_HighPriorityBrowserAsyncWorkCount()-1);perfSW.stopMarker&&perfSW.stopMarker.addParameter(fileFullPath)});jqScript.bind("load",function(e){_this.loadingScriptDeferreds.splice(_this.loadingScriptDeferreds.indexOf(deferred),1);deferred.resolve(e)});jqScript.bind("error",function(e){_this.props.clientContext.customEventHandlersManager.loadFinished();deferred.reject()});var node=ReactDOM.findDOMNode(this);node&&node.contentDocument.body.appendChild(script)};CustomScriptsFrameObjectSpec.prototype.generateVersionedFilename=function(filename){return filename+"?v="+VERSION_NUMERIC_VALUE};CustomScriptsFrameObjectSpec.prototype.handleIframeLoad=function(){var _this=this,iframe=ReactDOM.findDOMNode(this);if(iframe&&iframe.contentDocument.readyState!=="complete")window.setTimeout(this.handleIframeLoad);else this.schedule(function(){_this.addScriptNodeFromSrc(_this.generateVersionedFilename(MicrosoftAjaxRelativePath),_this.ajaxLoadedHandler)},"CustomScriptsFrameObject.HandleIFrameLoad.AddMicrosoftAjax")};CustomScriptsFrameObjectSpec.prototype.ajaxLoadedHandler=function(loadEvent){var _this=this;$(loadEvent.target).unbind();this.schedule(function(){_this.addScriptNodeFromSrc(_this.generateVersionedFilename(ClientApiWrapperRelativePath),_this.clientApiWrapperLoadedHandler)},"CustomScriptsFrameObject.AjaxLoadedHandler.ClientApiWrapper")};CustomScriptsFrameObjectSpec.prototype.clientApiWrapperLoadedHandler=function(loadEvent){var _this=this;this.scriptLoadedHandler(loadEvent);this.schedule(function(){_this.addScriptNodeFromSrc(_this.generateVersionedFilename(CommandBarActionsRelativePath),_this.scriptLoadedHandler)},"CustomScriptsFrameObject.AjaxLoadedHandler.CommandBarActions");this.schedule(function(){_this.addScriptNodeFromSrc(_this.generateVersionedFilename(SharedRibbonActionsRelativePath),_this.scriptLoadedHandler)},"CustomScriptsFrameObject.AjaxLoadedHandler.SharedRibbonActions");this.props.clientContext.isMailApp&&this.schedule(function(){_this.addScriptNodeFromSrc(_this.generateVersionedFilename(AuthTokenHeaderAttacherRelativePath),_this.scriptLoadedHandler)},"CustomScriptsFrameObject.AjaxLoadedHandler.AuthTokenHeaderAttacher")};CustomScriptsFrameObjectSpec.prototype.scriptLoadedHandler=function(loadEvent){$(loadEvent.target).unbind();this.onInitialized()};CustomScriptsFrameObjectSpec.prototype.schedule=function(work,name){var job=Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(work,Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.customScriptsContainer,name);job.set_Owner(this.schedulerOwnerToken)};CustomScriptsFrameObjectSpec.prototype.render=function(){if(!this.state.renderIframe)return React.DOM.noscript();var isBlankSrcRelativePathRequired=this.props.clientContext.userAgent.get_IsBrowserEdge()||this.props.clientContext.userAgent.get_IsMailApp()&&this.props.clientContext.userAgent.get_IsBrowserIE();return React.DOM.iframe({id:"CustomScriptsIFrame",className:"CustomScriptsIFrame",frameBorder:"0",src:isBlankSrcRelativePathRequired?BlankSrcRelativePath:null})};return CustomScriptsFrameObjectSpec}(TsAdapter.SpecBase);exports.CustomScriptsFrameObject=TsAdapter.createComponent(new CustomScriptsFrameObjectSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/PersistentScriptsFrameObject",["require","exports","Core/ReactTypescriptAdapter","Utils/DeferredPromise","Core/Binding/CustomEventsListenerMixin"],function(require,exports,TsAdapter,DeferredPromise,CustomEventsListener){var PersistentScriptsFrameObjectSpec=function(_super){__extends(PersistentScriptsFrameObjectSpec,_super);function PersistentScriptsFrameObjectSpec(){_super.apply(this,arguments);this.displayName="PersistentScriptsFrameObject";this.mixins=[CustomEventsListener.Mixin];this.schedulerOwnerToken=null;this.loadingScriptDeferreds=[]}PersistentScriptsFrameObjectSpec.prototype.getInitialState=function(){return {renderIframe:false}};PersistentScriptsFrameObjectSpec.prototype.configureEventListeners=function(){return {ScriptStringAdded:this.addScriptNodeFromString,ScriptFileAdded:this.addScriptNodeFromSrc}};PersistentScriptsFrameObjectSpec.prototype.shouldComponentUpdate=function(nextProps,nextState){if(nextState.renderIframe!==this.state.renderIframe)return true;return false};PersistentScriptsFrameObjectSpec.prototype.componentWillMount=function(){this.schedulerOwnerToken=this.props.clientContext.schedulerCreateOwnerToken()};PersistentScriptsFrameObjectSpec.prototype.componentDidMount=function(){var _this=this;!this.state.renderIframe&&this.schedule(function(){_this.setState({renderIframe:true})},"PersistentScriptsFrameObject.NewContextLoadDeferred.LoadIFrame")};PersistentScriptsFrameObjectSpec.prototype.componentWillUnmount=function(){this.unbind();this.clear()};PersistentScriptsFrameObjectSpec.prototype.clear=function(){this.schedulerOwnerToken.cancelAll();this.cancelLoadingScripts()};PersistentScriptsFrameObjectSpec.prototype.unbind=function(){var node=ReactDOM.findDOMNode(this);if(node&&node.contentDocument){var iframeBody=node.contentDocument.body;while(iframeBody.firstChild)iframeBody.removeChild(iframeBody.firstChild)}};PersistentScriptsFrameObjectSpec.prototype.cancelLoadingScripts=function(){for(var i=0;i<this.loadingScriptDeferreds.length;i++)this.loadingScriptDeferreds[i].reject();this.loadingScriptDeferreds=[]};PersistentScriptsFrameObjectSpec.prototype.addScriptNodeFromString=function(scriptBlob,srcName){var scope=this,script=document.createElement("script");script.type="text/javascript";script.text=scriptBlob;var node=ReactDOM.findDOMNode(this);if(node){node.contentDocument.body.onerror=function(evt){scope.scriptErrorHandler(evt,srcName)};node.contentDocument.body.appendChild(script)}};PersistentScriptsFrameObjectSpec.prototype.scriptErrorHandler=function(evt,srcName){try{var scope=ReactDOM.findDOMNode(this).contentWindow;scope=scope.Mscrm;var wrapperParams=[];wrapperParams[0]=evt.error.message;wrapperParams[1]="";wrapperParams[2]=srcName;wrapperParams[3]="";wrapperParams[4]=evt.error.stack;scope.handleErrorDisplay.apply(null,wrapperParams)}catch(e){var exception=e,errorMessage=exception.get_Message==null||exception.get_Message==undefined?e.message:exception.get_Message();Microsoft.Crm.Client.Core.Framework.Trace.logWarning(1016," has errors: "+errorMessage)}};PersistentScriptsFrameObjectSpec.prototype.addScriptNodeFromSrc=function(fileFullPath,onLoadCallback){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.set_HighPriorityBrowserAsyncWorkCount(Microsoft.Crm.Client.Core.Framework.Scheduler.get_HighPriorityBrowserAsyncWorkCount()+1);var perfSW=this.props.clientContext.getPerformanceStopwatch("PersistentScriptsFrameObject.AddScriptNodeFromSrc");perfSW.start();var script=document.createElement("script");script.type="text/javascript";script.src=fileFullPath;var id=fileFullPath.split("/");script.id=id[id.length-1];var jqScript=$(script),deferred=new DeferredPromise.DeferredPromise;this.loadingScriptDeferreds.push(deferred);deferred.done(function(loadEvent){onLoadCallback(loadEvent)}).always(function(e){jqScript.unbind();perfSW.stop();Microsoft.Crm.Client.Core.Framework.Scheduler.set_HighPriorityBrowserAsyncWorkCount(Microsoft.Crm.Client.Core.Framework.Scheduler.get_HighPriorityBrowserAsyncWorkCount()-1);perfSW.stopMarker&&perfSW.stopMarker.addParameter(fileFullPath)});jqScript.bind("load",function(e){_this.loadingScriptDeferreds.splice(_this.loadingScriptDeferreds.indexOf(deferred),1);deferred.resolve(e)});jqScript.bind("error",function(e){_this.props.clientContext.customEventHandlersManager.loadFinished();deferred.reject()});var node=ReactDOM.findDOMNode(this);if(node){var documentObj=node.contentDocument;documentObj.getElementById(script.id)==null&&documentObj.body.appendChild(script)}};PersistentScriptsFrameObjectSpec.prototype.schedule=function(work,name){var job=Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(work,Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.customScriptsContainer,name);job.set_Owner(this.schedulerOwnerToken)};PersistentScriptsFrameObjectSpec.prototype.render=function(){var hrefLocation=window.location.href,clientUrl=hrefLocation.substring(0,hrefLocation.indexOf(window.location.pathname)),targetUrl=clientUrl+"/WebResources/msdyn_LearningPath.html";if(!this.state.renderIframe)return React.DOM.noscript();return React.DOM.iframe({id:"PersistentScriptsIFrame",frameBorder:"0",src:targetUrl})};return PersistentScriptsFrameObjectSpec}(TsAdapter.SpecBase);exports.PersistentScriptsFrameObject=TsAdapter.createComponent(new PersistentScriptsFrameObjectSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/CustomScriptsContainer",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Shell/CustomScriptsFrameObject","Components/Shell/PersistentScriptsFrameObject"],function(require,exports,TsAdapter,DataWrapperComponent,CustomScriptsFrameObject,PersistentScriptsFrameObject){var CustomScriptsContainerSpec=function(_super){__extends(CustomScriptsContainerSpec,_super);function CustomScriptsContainerSpec(){_super.apply(this,arguments);this.displayName="CustomScriptsContainer";this.listenToCollections=["Items"]}CustomScriptsContainerSpec.prototype.render=function(){var style={height:0,overflow:"hidden"};if(!this.props.clientContext.userAgent.get_IsAndroid())style["display"]="none";var children=[],childVM=this.props.dataContext.get_PersistentFrame();children.push(PersistentScriptsFrameObject.PersistentScriptsFrameObject({key:childVM.get_ViewModelId(),dataContext:childVM,clientContext:this.props.clientContext}));for(var i=0;i<this.props.dataContext.get_Items().get_Count();i++){childVM=this.props.dataContext.get_Items().getItem(i);children.push(CustomScriptsFrameObject.CustomScriptsFrameObject({key:childVM.get_ViewModelId(),dataContext:childVM,clientContext:this.props.clientContext}))}return React.DOM.div({className:"customizationContainer",style:style},children)};return CustomScriptsContainerSpec}(TsAdapter.SpecBase);exports.CustomScriptsContainer=DataWrapperComponent.wrapComponent(new CustomScriptsContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/WindowResizeHandlerMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var windowWidth=window.innerWidth,windowHeight=window.innerHeight,screenHeight=screen.height,screenWidth=screen.width,resizedTimerCallback=0;window.onresize=handleWindowResizeInternal;var windowResizeMixins=[];function getWindowWidth(){return windowWidth}exports.getWindowWidth=getWindowWidth;function getWindowHeight(){return windowHeight}exports.getWindowHeight=getWindowHeight;function getScreenHeight(){return screenHeight}exports.getScreenHeight=getScreenHeight;function getScreenWidth(){return screenWidth}exports.getScreenWidth=getScreenWidth;function getScreenHeightBasedOnDevice(){var screenHeight=0;if(Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsMobilePhone())screenHeight=Math.max(getScreenWidth(),getScreenHeight());else screenHeight=Math.min(getScreenWidth(),getScreenHeight());return screenHeight}exports.getScreenHeightBasedOnDevice=getScreenHeightBasedOnDevice;function handleWindowResizeInternal(){resizedTimerCallback!==0&&window.clearTimeout(resizedTimerCallback);resizedTimerCallback=window.setTimeout(function(){windowWidth=window.innerWidth;windowHeight=window.innerHeight;for(var i=0;i<windowResizeMixins.length;i++)windowResizeMixins[i].handleWindowResize&&windowResizeMixins[i].handleWindowResize()},200)}var WindowResizeHandlerMixin=function(_super){__extends(WindowResizeHandlerMixin,_super);function WindowResizeHandlerMixin(){_super.apply(this,arguments)}WindowResizeHandlerMixin.prototype.componentDidMount=function(){windowResizeMixins.push(this)};WindowResizeHandlerMixin.prototype.componentWillUnmount=function(){windowResizeMixins.splice(windowResizeMixins.indexOf(this),1)};return WindowResizeHandlerMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new WindowResizeHandlerMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){var PerformanceButtonSpec=function(_super){__extends(PerformanceButtonSpec,_super);function PerformanceButtonSpec(){_super.apply(this,arguments);this.displayName="PerformanceButton";this.listenToProperties=["CanExecute","Name"]}PerformanceButtonSpec.prototype.handleClick=function(){this.props.dataContext.get_CanExecute()&&this.props.dataContext.execute()};PerformanceButtonSpec.prototype.render=function(){return React.DOM.button({className:"perfButton",disabled:!this.props.dataContext.get_CanExecute(),onClick:this.handleClick},this.props.dataContext.get_Name())};return PerformanceButtonSpec}(TsAdapter.SpecBase);exports.PerformanceButton=DataWrapperComponent.wrapComponent(new PerformanceButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceTabBase",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Performance/PerformanceButton"],function(require,exports,TsAdapter,DataWrapperComponent,PerformanceButton){var PerformanceTabBaseSpec=function(_super){__extends(PerformanceTabBaseSpec,_super);function PerformanceTabBaseSpec(){_super.apply(this,arguments);this.displayName="PerformanceTabBase";this.listenToCollections=["Commands"];this.listenToProperties=["OutputMessage"]}PerformanceTabBaseSpec.prototype.render=function(){for(var textArea=React.DOM.pre({key:"perfTextArea",id:"perfTextArea",className:"perfTabBaseTextArea"},this.props.dataContext.get_OutputMessage()),buttons=[],commands=this.props.dataContext.get_Commands(),i=0;i<commands.get_Count();i++){var command=commands.getItem(i),newButton=PerformanceButton.PerformanceButton({key:command.get_Id(),dataContext:command,clientContext:this.props.clientContext});buttons.push(newButton)}this.props.extraButtons&&this.props.extraButtons.forEach(function(button){return buttons.push(button)});var buttonsContainer=React.DOM.div({key:"buttonsContainer",className:"buttonsContainer"},buttons);return React.DOM.div({className:"perfTabBase"},[textArea,buttonsContainer])};return PerformanceTabBaseSpec}(TsAdapter.SpecBase);exports.PerformanceTabBase=DataWrapperComponent.wrapComponent(new PerformanceTabBaseSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportTimeline",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/WindowResizeHandlerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,WindowResizeHandler){exports.PERFORMANCE_TIMELINE_DEFAULT_FONT="10px Verdana";exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_COLOR="black";exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_WIDTH=6;exports.PERFORMANCE_TIMELINE_CANVAS_PADDING=10;exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT=20;exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_TOP_HEADING=4;exports.PERFORMANCE_TIMELINE_MARKER_DEFAULT_HEIGHT=15;exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_Y=4;exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_HEIGHT=12;exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_WIDTH=10;exports.CLICK_HIT_TARGET_DIAMETER=12;var PerformanceMarkerDisplay=function(){function PerformanceMarkerDisplay(){this.x=1;this.y=1;this.width=1;this.height=15;this.fillStyle="#000000";this.markerArea=null}PerformanceMarkerDisplay.prototype.hitTest=function(markerDisplay){var noOverlap=this.x>=markerDisplay.x+markerDisplay.width||markerDisplay.x>=this.x+this.width||this.y>markerDisplay.y+markerDisplay.height||markerDisplay.y>this.y+this.height;return !noOverlap};return PerformanceMarkerDisplay}(),PerformanceReportTimelineSpec=function(_super){__extends(PerformanceReportTimelineSpec,_super);function PerformanceReportTimelineSpec(){_super.apply(this,arguments);this.markersDisplay=[];this.displayName="PerformanceReportTimeLine";this.mixins=[WindowResizeHandler.Mixin];this.listenToProperties=["IsLoading"];this.recalculateDisplays=true;this.recalculateSize=true;this.redrawTimer=-1}PerformanceReportTimelineSpec.prototype.handleClick=function(e){var canvas=this.refs["canvas"],boundingRectangle=canvas.getBoundingClientRect(),hitX=e.clientX,hitY=e.clientY;hitX-=boundingRectangle.left;hitY-=boundingRectangle.top;if(this.props.reportRotated){var curX=hitX;hitX=hitY;hitY=canvas.height-curX}var fakeMarkerDisplay=new PerformanceMarkerDisplay;fakeMarkerDisplay.x=hitX-exports.CLICK_HIT_TARGET_DIAMETER/2;fakeMarkerDisplay.y=hitY-exports.CLICK_HIT_TARGET_DIAMETER/2;fakeMarkerDisplay.width=exports.CLICK_HIT_TARGET_DIAMETER;fakeMarkerDisplay.height=exports.CLICK_HIT_TARGET_DIAMETER;for(var i=0;i<this.markersDisplay.length;i++)if(this.markersDisplay[i].hitTest(fakeMarkerDisplay))this.markersDisplay[i].markerArea.set_IsSelected(true);else this.markersDisplay[i].markerArea.set_IsSelected(false);this.redraw();this.props.dataContext.updateSelectedMarkersMessage()};PerformanceReportTimelineSpec.prototype.getHashFromString=function(str){var hash=0;if(str&&str.length>0)for(var i=0;i<str.length;i++){var charCode=str.charCodeAt(i);hash=(hash<<5)-hash+charCode;hash=hash&hash}return hash};PerformanceReportTimelineSpec.prototype.handleWindowResize=function(){this.recalculateSize=true;this.queueRedraw()};PerformanceReportTimelineSpec.prototype.componentDidMount=function(){this.queueRedraw()};PerformanceReportTimelineSpec.prototype.componentDidUpdate=function(prevProps){if(this.props.reportRotated!==prevProps.reportRotated){this.recalculateDisplays=true;this.recalculateSize=true}this.queueRedraw()};PerformanceReportTimelineSpec.prototype.calculateDisplays=function(width){var markerAreas=this.props.dataContext.get_PerformanceMarkerAreas();this.markersDisplay=[];for(var minTime=Math.floor(this.props.dataContext.get_MinTime()),maxTime=Math.ceil(this.props.dataContext.get_MaxTime()),scaling=(width-2*exports.PERFORMANCE_TIMELINE_CANVAS_PADDING)/Math.ceil(maxTime-minTime),maxHeight=0,i=0;i<markerAreas.length;i++){var markerArea=markerAreas[i],marker=markerArea.get_Marker(),duration=1,markerDisplay=new PerformanceMarkerDisplay;markerDisplay.markerArea=markerArea;markerDisplay.y=exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT;markerDisplay.x=exports.PERFORMANCE_TIMELINE_CANVAS_PADDING+(markerArea.get_StartTime()-minTime)*scaling;if(markerArea.get_StartTime()!==-1){duration=marker.get_Timestamp()-markerArea.get_StartTime();markerDisplay.width=Math.max(1,duration*scaling)}else markerDisplay.x=exports.PERFORMANCE_TIMELINE_CANVAS_PADDING+(marker.get_Timestamp()-minTime)*scaling;markerDisplay.fillStyle="#"+Math.floor(Math.abs(this.getHashFromString(marker.get_Name()))/2147483647*16777215).toString(16);if(marker.get_MarkerType()!==1)for(var j=0;j<this.markersDisplay.length;)if(markerDisplay.hitTest(this.markersDisplay[j])){markerDisplay.y+=exports.PERFORMANCE_TIMELINE_MARKER_DEFAULT_HEIGHT+1;j=0}else j++;else{markerDisplay.y=exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_Y;markerDisplay.height=exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_HEIGHT;markerDisplay.width=exports.PERFORMANCE_TIMELINE_MAJOR_EVENT_WIDTH}maxHeight=Math.max(maxHeight,markerDisplay.y+markerDisplay.height);this.markersDisplay.push(markerDisplay)}this.recalculateDisplays=false;return maxHeight};PerformanceReportTimelineSpec.prototype.queueRedraw=function(){if(this.redrawTimer===-1)this.redrawTimer=window.setTimeout(this.redraw,0)};PerformanceReportTimelineSpec.prototype.redraw=function(){this.redrawTimer=-1;var canvas=this.refs["canvas"],parent=canvas.parentElement;if(this.recalculateSize){var parentWidth=parent.clientWidth;if(canvas.width!==parentWidth){canvas.width=parentWidth;this.recalculateDisplays=true;this.recalculateSize=false}}var ctx=canvas.getContext("2d");if(this.props.dataContext.get_IsLoading()){ctx.fillText("Loading...",0,0);return}var markerCount=this.props.dataContext.get_PerformanceMarkerAreas().length,markerDisplaysCount=this.markersDisplay.length;if(markerCount!==markerDisplaysCount)this.recalculateDisplays=true;else if(markerCount>0&&markerDisplaysCount>0&&this.props.dataContext.get_PerformanceMarkerAreas()[0]!==this.markersDisplay[0].markerArea)this.recalculateDisplays=true;if(this.recalculateDisplays){var maxHeight=this.calculateDisplays(parent.clientWidth);if(maxHeight!==canvas.height)canvas.height=Math.max(maxHeight,parent.clientHeight)}ctx.globalAlpha=.7;ctx.clearRect(0,0,canvas.width,canvas.height);var totalTime=this.props.dataContext.totalTime();ctx.beginPath();ctx.moveTo(exports.PERFORMANCE_TIMELINE_CANVAS_PADDING,exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT-2);ctx.lineTo(canvas.width-exports.PERFORMANCE_TIMELINE_CANVAS_PADDING,exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT-2);ctx.stroke();ctx.font=exports.PERFORMANCE_TIMELINE_DEFAULT_FONT;ctx.fillStyle=exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_COLOR;ctx.fillText("0 ms",exports.PERFORMANCE_TIMELINE_CANVAS_PADDING,exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT/2+exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_TOP_HEADING);var endLabelWidth=60;ctx.fillText(Math.ceil(totalTime).toString()+" ms",canvas.width-exports.PERFORMANCE_TIMELINE_CANVAS_PADDING-endLabelWidth,exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_HEIGHT/2+exports.PERFORMANCE_TIMELINE_CANVAS_HEADER_TOP_HEADING);for(var i=0;i<this.markersDisplay.length;i++){var markerDisplay=this.markersDisplay[i],markerArea=this.markersDisplay[i].markerArea,marker=markerArea.get_Marker(),isSelected=markerArea.get_IsSelected();if(marker.get_MarkerType()===1){ctx.save();ctx.fillStyle=markerDisplay.fillStyle;ctx.beginPath();ctx.moveTo(markerDisplay.x,3);ctx.lineTo(markerDisplay.x,3e3);ctx.stroke();ctx.beginPath();ctx.moveTo(markerDisplay.x,markerDisplay.y);ctx.lineTo(markerDisplay.x+markerDisplay.width,markerDisplay.y+markerDisplay.height/2);ctx.lineTo(markerDisplay.x,markerDisplay.y+markerDisplay.height);ctx.lineTo(markerDisplay.x,markerDisplay.y);ctx.fill();isSelected&&ctx.stroke();ctx.restore()}else{ctx.fillStyle=markerDisplay.fillStyle;ctx.fillRect(markerDisplay.x,markerDisplay.y,markerDisplay.width,markerDisplay.height)}if(isSelected){ctx.save();if(marker.get_MarkerType()===1)ctx.globalAlpha=1;ctx.fillStyle=exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_COLOR;ctx.lineWidth=2;ctx.strokeRect(markerDisplay.x+1,markerDisplay.y+1,markerDisplay.width-2,markerDisplay.height-2);ctx.restore()}var message=marker.toString();if(message.length*exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_WIDTH<=markerDisplay.width){ctx.font=exports.PERFORMANCE_TIMELINE_DEFAULT_FONT;ctx.fillStyle=exports.PERFORMANCE_TIMELINE_DEFAULT_FONT_COLOR;ctx.fillText(message,markerDisplay.x+4,markerDisplay.y+markerDisplay.height/2+3)}}};PerformanceReportTimelineSpec.prototype.render=function(){return React.DOM.canvas({key:"perfTimeLineCanvas",className:"perfTimelineCanvas",ref:"canvas",onClick:this.handleClick})};return PerformanceReportTimelineSpec}(TsAdapter.SpecBase);exports.PerformanceReportTimeline=DataWrapperComponent.wrapComponent(new PerformanceReportTimelineSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportMarkersTab",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Performance/PerformanceTabBase","Components/Performance/PerformanceReportTimeline"],function(require,exports,TsAdapter,PureUpdate,PerformanceTabBase,PerformanceReportTimeline){var PerformanceReportMarkersTabSpec=function(_super){__extends(PerformanceReportMarkersTabSpec,_super);function PerformanceReportMarkersTabSpec(){_super.apply(this,arguments);this.displayName="PerformanceReportMarkers";this.mixins=[PureUpdate.Mixin]}PerformanceReportMarkersTabSpec.prototype.findMarkersButtonOnClick=function(){this.findAndSelectMarkersFromInput()};PerformanceReportMarkersTabSpec.prototype.findAndSelectMarkersFromInput=function(){var searchTextBox=this.refs["findMarkersSearchText"],searchText=searchTextBox.value;this.props.dataContext.findMarkers(searchText)};PerformanceReportMarkersTabSpec.prototype.findMarkersSearchCriteriaKeyPress=function(e){e.key==="Enter"&&this.findAndSelectMarkersFromInput()};PerformanceReportMarkersTabSpec.prototype.render=function(){var timeline=PerformanceReportTimeline.PerformanceReportTimeline({key:"perfTimeline",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Timeline(),reportRotated:this.props.reportRotated}),timelineDiv=React.DOM.div({key:"perfTimelineWrapper",className:"perfTimelineWrapper"},timeline),findMarkersSearchCriteria=React.DOM.input({key:"perfFindMarkersSearchCriteria",ref:"findMarkersSearchText",onKeyPress:this.findMarkersSearchCriteriaKeyPress}),findMarkersButton=React.DOM.button({key:"PerfFindMarkersButton",onClick:this.findMarkersButtonOnClick},"Find"),findContainer=React.DOM.div({key:"findMarkersContainer",className:"findMarkersContainer perfButton"},[findMarkersSearchCriteria,findMarkersButton]),performanceTabBase=PerformanceTabBase.PerformanceTabBase({key:"PerformanceTabBase",clientContext:this.props.clientContext,dataContext:this.props.dataContext,extraButtons:[findContainer]});if(this.props.clientContext.userAgent.get_IsAndroid())return React.DOM.div({className:"PerfTabContent PerfMarkerTab"},[performanceTabBase,timelineDiv]);return React.DOM.div({className:"PerfTabContent PerfMarkerTab"},[timelineDiv,performanceTabBase])};return PerformanceReportMarkersTabSpec}(TsAdapter.SpecBase);exports.PerformanceReportMarkersTab=TsAdapter.createComponent(new PerformanceReportMarkersTabSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportLocalStoreTab",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Performance/PerformanceTabBase"],function(require,exports,TsAdapter,PureUpdate,PerformanceTabBase){var PerformanceReportLocalStoreTabSpec=function(_super){__extends(PerformanceReportLocalStoreTabSpec,_super);function PerformanceReportLocalStoreTabSpec(){_super.apply(this,arguments);this.displayName="PerformanceReportLocalStore";this.mixins=[PureUpdate.Mixin]}PerformanceReportLocalStoreTabSpec.prototype.render=function(){var performanceTabBase=PerformanceTabBase.PerformanceTabBase({key:"PerformanceTabBase",clientContext:this.props.clientContext,dataContext:this.props.dataContext});return React.DOM.div({className:"PerfTabContent"},performanceTabBase)};return PerformanceReportLocalStoreTabSpec}(TsAdapter.SpecBase);exports.PerformanceReportLocalStoreTab=TsAdapter.createComponent(new PerformanceReportLocalStoreTabSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportGlobalObjectsCountTab",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Performance/PerformanceTabBase"],function(require,exports,TsAdapter,PureUpdate,PerformanceTabBase){var PerformanceReportGlobalObjectsCountTabSpec=function(_super){__extends(PerformanceReportGlobalObjectsCountTabSpec,_super);function PerformanceReportGlobalObjectsCountTabSpec(){_super.apply(this,arguments);this.displayName="PerformanceReportGlobalObjectsCountTab";this.mixins=[PureUpdate.Mixin]}PerformanceReportGlobalObjectsCountTabSpec.prototype.render=function(){var performanceTabBase=PerformanceTabBase.PerformanceTabBase({key:"PerformanceTabBase",clientContext:this.props.clientContext,dataContext:this.props.dataContext});return React.DOM.div({className:"PerfTabContent"},performanceTabBase)};return PerformanceReportGlobalObjectsCountTabSpec}(TsAdapter.SpecBase);exports.PerformanceReportGlobalObjectsCountTab=TsAdapter.createComponent(new PerformanceReportGlobalObjectsCountTabSpec)});define("Utils/CssClassSet",["require","exports"],function(require,exports){function classSet(includeKeysIfValues){for(var includeValuesIfValid=[],_i=1;_i<arguments.length;_i++)includeValuesIfValid[_i-1]=arguments[_i];var classNames=[];if(includeKeysIfValues)for(var key in includeKeysIfValues)includeKeysIfValues[key]&&classNames.push(key);if(includeValuesIfValid)for(var i=0,len=includeValuesIfValid.length;i<len;i++){var value=includeValuesIfValid[i];value&&classNames.push(value)}return classNames.join(" ")}return classSet});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportAutomationTabTestCase",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){var PerformanceReportAutomationTabTestCaseSpec=function(_super){__extends(PerformanceReportAutomationTabTestCaseSpec,_super);function PerformanceReportAutomationTabTestCaseSpec(){_super.apply(this,arguments);this.displayName="PerformanceReportAutomationTabTestCase";this.listenToProperties=["Enabled"]}PerformanceReportAutomationTabTestCaseSpec.prototype.handleChange=function(){this.props.dataContext.set_Enabled(!this.props.dataContext.get_Enabled())};PerformanceReportAutomationTabTestCaseSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet({testCase:true,selected:this.props.dataContext.get_Enabled()})},React.DOM.label(null,[React.DOM.input({key:"check",type:"checkbox",checked:this.props.dataContext.get_Enabled(),onChange:this.handleChange}),React.DOM.span({key:"label"},this.props.dataContext.get_DisplayName())]))};return PerformanceReportAutomationTabTestCaseSpec}(TsAdapter.SpecBase);exports.PerformanceReportAutomationTabTestCase=DataWrapperComponent.wrapComponent(new PerformanceReportAutomationTabTestCaseSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReportAutomationTab",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Performance/PerformanceTabBase","Components/Performance/PerformanceReportAutomationTabTestCase"],function(require,exports,TsAdapter,DataWrapperComponent,PerformanceTabBase,PerformanceReportAutomationTabTestCase){var scenarioNames={0:"Edit forms",1:"Grids",2:"Quick create forms",3:"Dashboards",4:"Offline create forms",5:"Sort Grid",6:"InitialSync",7:"IncrementalSync",8:"ICDashboardCsrOne",9:"ICDashboardCsrTwo",10:"ICForm",11:"ICNavBar",12:"ICCaseForm",13:"Offline search",14:"Offline update records",15:"Offline delete records",16:"Offline Retrieve records",17:"UpSync Reconnect",18:"Task Based Flow",19:"Chart drilldown",20:"Search form",21:"Grid refresh",22:"List refresh",23:"Create record",24:"Update record",25:"Document recommendations"},PERCEIVED_PERFORMANCE_RUN_ENTITIES=["account","incident","opportunity","contact","lead","competitor","new_basicentity","new_extralightentity","new_lightentity","new_mediumandheavyentity","new_mediumhierarchical"],PERCEIVED_PERFORMANCE_RUN_SCENARIOS={0:PERCEIVED_PERFORMANCE_RUN_ENTITIES,1:PERCEIVED_PERFORMANCE_RUN_ENTITIES,2:PERCEIVED_PERFORMANCE_RUN_ENTITIES,3:[]},RELABILITY_RUN_SCENARIOS={0:["account"],1:["lead"],3:[],19:[],20:[],21:["lead"],22:[],23:["opportunity"],24:["opportunity"]},TABLET_LATENCY=175,PHONE_LATENCY=250,PerformanceReportAutomationTabSpec=function(_super){__extends(PerformanceReportAutomationTabSpec,_super);function PerformanceReportAutomationTabSpec(){_super.apply(this,arguments);this.displayName="PerformanceReportAutomationTab";this.listenToProperties=["IterationCount","RoundRobin","RecordMemory","ReactLogging","ConstantLatency"]}PerformanceReportAutomationTabSpec.prototype.handleIterationCountChange=function(e){var element=e.target;this.props.dataContext.set_IterationCount(+element.value)};PerformanceReportAutomationTabSpec.prototype.handleRoundRobinChange=function(){this.props.dataContext.set_RoundRobin(!this.props.dataContext.get_RoundRobin())};PerformanceReportAutomationTabSpec.prototype.handleRecordMemoryChange=function(){this.props.dataContext.set_RecordMemory(!this.props.dataContext.get_RecordMemory())};PerformanceReportAutomationTabSpec.prototype.handleReactLoggingChange=function(){this.setReactLogging(!this.props.dataContext.get_ReactLogging())};PerformanceReportAutomationTabSpec.prototype.enableConstantLatency=function(){this.props.dataContext.set_ConstantLatency(true);var isPhone=this.props.clientContext.isPhone,responseCache={},_XMLHttpRequest=XMLHttpRequest;XMLHttpRequest=function(){var realXhr=new _XMLHttpRequest,_this=this,_send=realXhr.send;this.send=function(data){if(data in responseCache)window.setTimeout(function(){_this.responseText=responseCache[data];_this.onload()},isPhone?PHONE_LATENCY:TABLET_LATENCY);else{var _onload=realXhr.onload;_this.onload=function(){responseCache[data]=this.responseText;_this.responseText=this.responseText;_onload.apply(realXhr,arguments)};return _send.apply(realXhr,arguments)}};var realXhrAsObject=realXhr,proxyGetters=["status","statusText","responseType","response","readyState","responseXML","upload"];proxyGetters.forEach(function(item){Object.defineProperty(_this,item,{"get":function(){return realXhrAsObject[item]}})});["ontimeout, timeout","withCredentials","onload","onerror","onprogress"].forEach(function(item){Object.defineProperty(_this,item,{"get":function(){return realXhrAsObject[item]},"set":function(val){realXhrAsObject[item]=val}})});["addEventListener","open","abort","getAllResponseHeaders","getResponseHeader","overrideMimeType","setRequestHeader"].forEach(function(item){Object.defineProperty(_this,item,{value:function(){return realXhrAsObject[item].apply(realXhr,arguments)}})})}};PerformanceReportAutomationTabSpec.prototype.setReactLogging=function(value){React.addons.ReactFeatureFlags.logTopLevelRenders=value;this.props.dataContext.set_ReactLogging(value)};PerformanceReportAutomationTabSpec.prototype.renderIterationCountInput=function(){var currentValue=this.props.dataContext.get_IterationCount().toString(10);return React.DOM.input({key:"input",value:currentValue,onChange:this.handleIterationCountChange})};PerformanceReportAutomationTabSpec.prototype.renderScenarioTestCases=function(testCases){var _this=this,count=testCases.length;if(count===0)return null;var header=React.DOM.div({key:"header",style:{fontWeight:"bold"}},scenarioNames[testCases[0].get_Scenario()]),children=testCases.map(function(tc){return PerformanceReportAutomationTabTestCase.PerformanceReportAutomationTabTestCase({key:tc.get_DisplayName(),dataContext:tc,clientContext:_this.props.clientContext})});return React.DOM.div({key:testCases[0].get_Scenario().toString(),className:"scenarioContainer"},[header,children])};PerformanceReportAutomationTabSpec.prototype.renderTestCases=function(){for(var children=[],testCasesByScenario={},testCases=this.props.dataContext.get_TestCases(),i=0,len=testCases.length;i<len;i++){var testCase=testCases[i],scenario=testCase.get_Scenario();if(!(scenario in testCasesByScenario))testCasesByScenario[scenario]=[];testCasesByScenario[scenario].push(testCase)}for(var key in testCasesByScenario)testCasesByScenario.hasOwnProperty(key)&&children.push(this.renderScenarioTestCases(testCasesByScenario[key]));return children};PerformanceReportAutomationTabSpec.prototype.selectAll=function(){for(var testCases=this.props.dataContext.get_TestCases(),i=0,len=testCases.length;i<len;i++)testCases[i].set_Enabled(true)};PerformanceReportAutomationTabSpec.prototype.selectNone=function(){for(var testCases=this.props.dataContext.get_TestCases(),i=0,len=testCases.length;i<len;i++)testCases[i].set_Enabled(false)};PerformanceReportAutomationTabSpec.prototype.selectScenarios=function(scenarios,iterationCount,roundRobin,recordMemory){for(var testCases=this.props.dataContext.get_TestCases(),i=0,len=testCases.length;i<len;i++){var testCase=testCases[i],enabled=false,scenario=scenarios[testCase.get_Scenario()];if(scenario)enabled=testCase.get_Parameter()?scenario.indexOf(testCase.get_Parameter())>=0:true;testCase.set_Enabled(enabled)}this.props.dataContext.set_IterationCount(iterationCount);this.props.dataContext.set_RoundRobin(roundRobin);this.props.dataContext.set_RecordMemory(recordMemory);this.setReactLogging(false)};PerformanceReportAutomationTabSpec.prototype.render=function(){var collectorServer=React.DOM.div({key:"collector"},"Collector server URL: "+this.props.dataContext.get_CollectorServerUrl()),selectAllButton=React.DOM.button({key:"selectAll",onClick:this.selectAll},"All"),selectNoneButton=React.DOM.button({key:"selectNone",onClick:this.selectNone},"None"),configurationChildren=[React.DOM.span({key:"label"},"Iterations: "),this.renderIterationCountInput(),selectAllButton,selectNoneButton];!this.props.dataContext.get_IsInteractionCentricEnabled()&&configurationChildren.push(React.DOM.button({key:"selectOfficial",onClick:this.selectScenarios.bind(this,PERCEIVED_PERFORMANCE_RUN_SCENARIOS,21,false,false)},"Official"),React.DOM.button({key:"selectReliabililty",onClick:this.selectScenarios.bind(this,RELABILITY_RUN_SCENARIOS,70,true,true)},"Reliability"));configurationChildren.push(React.DOM.span({key:"roundRobin"},"Round robin: "),React.DOM.input({key:"roundRobinCheck",type:"checkbox",checked:this.props.dataContext.get_RoundRobin(),onChange:this.handleRoundRobinChange}));configurationChildren.push(React.DOM.span({key:"recordMemory"},"Record memory: "),React.DOM.input({key:"recordMemoryCheck",type:"checkbox",checked:this.props.dataContext.get_RecordMemory(),onChange:this.handleRecordMemoryChange}));configurationChildren.push(React.DOM.span({key:"reactLogging"},"React logging: "),React.DOM.input({key:"reactLoggingCheck",type:"checkbox",checked:this.props.dataContext.get_ReactLogging(),onChange:this.handleReactLoggingChange}));configurationChildren.push(React.DOM.button({key:"constantLatency",onClick:this.enableConstantLatency,disabled:this.props.dataContext.get_ConstantLatency()},"Enable constant latency"));var configuration=React.DOM.div({key:"configuration"},configurationChildren),testCases=React.DOM.div({key:"testCases",className:"testCasesContainer"},this.renderTestCases()),performanceTabBase=PerformanceTabBase.PerformanceTabBase({key:"PerformanceTabBase",clientContext:this.props.clientContext,dataContext:this.props.dataContext});return React.DOM.div({className:"PerfTabContent AutomationTab"},[collectorServer,configuration,testCases,performanceTabBase])};return PerformanceReportAutomationTabSpec}(TsAdapter.SpecBase);exports.PerformanceReportAutomationTab=DataWrapperComponent.wrapComponent(new PerformanceReportAutomationTabSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Performance/PerformanceReport",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/WindowResizeHandlerMixin","Components/Performance/PerformanceReportMarkersTab","Components/Performance/PerformanceReportLocalStoreTab","Components/Performance/PerformanceReportGlobalObjectsCountTab","Components/Performance/PerformanceReportAutomationTab"],function(require,exports,TsAdapter,DataWrapperComponent,WindowResizeHandler,PerformanceReportMarkersTab,PerformanceReportLocalStoreTab,PerformanceReportGlobalObjectsCountTab,PerformanceReportAutomationTab){var PerformanceReportSpec=function(_super){__extends(PerformanceReportSpec,_super);function PerformanceReportSpec(){_super.apply(this,arguments);this.displayName="PerformanceReport";this.listenToProperties=["CurrentTab","Enabled"];this.mixins=[WindowResizeHandler.Mixin]}PerformanceReportSpec.prototype.markerTabOnClickHandler=function(){this.props.dataContext.set_CurrentTab(0)};PerformanceReportSpec.prototype.localStoreTabOnClickHandler=function(){this.props.dataContext.set_CurrentTab(1)};PerformanceReportSpec.prototype.globalObjectsCountOnClickHandler=function(){this.props.dataContext.set_CurrentTab(2)};PerformanceReportSpec.prototype.automationTabOnClickHandler=function(){this.props.dataContext.set_CurrentTab(3)};PerformanceReportSpec.prototype.handleWindowResize=function(){var windowSize={windowHeight:WindowResizeHandler.getWindowHeight(),windowWidth:WindowResizeHandler.getWindowWidth()};(this.state.windowHeight!==windowSize.windowHeight||this.state.windowWidth!==windowSize.windowWidth)&&this.setState(windowSize)};PerformanceReportSpec.prototype.handleRotateButtonClick=function(){this.setState({reportRotated:!this.state.reportRotated})};PerformanceReportSpec.prototype.getInitialState=function(){return {windowHeight:window.innerHeight,windowWidth:window.innerWidth,reportRotated:false}};PerformanceReportSpec.prototype.componentDidMount=function(){var _this=this;!this.props.dataContext.get_Enabled()&&window.setTimeout(function(){!_this.props.dataContext.get_Enabled()&&Microsoft.Crm.Client.Core.Framework.PerformanceMarker.set_IsSuspended(false)},0)};PerformanceReportSpec.prototype.componentDidUpdate=function(){var _this=this;!this.props.dataContext.get_Enabled()&&window.setTimeout(function(){!_this.props.dataContext.get_Enabled()&&Microsoft.Crm.Client.Core.Framework.PerformanceMarker.set_IsSuspended(false)},0)};PerformanceReportSpec.prototype.renderTab=function(id,text,tab){var tabClassName="",currentTab=this.props.dataContext.get_CurrentTab();if(currentTab===tab)tabClassName="active";var onClickHandler=this.markerTabOnClickHandler;if(tab===1)onClickHandler=this.localStoreTabOnClickHandler;else if(tab===2)onClickHandler=this.globalObjectsCountOnClickHandler;else if(tab===3)onClickHandler=this.automationTabOnClickHandler;var tabItem=React.DOM.div({key:id,className:tabClassName,onClick:onClickHandler},text);return tabItem};PerformanceReportSpec.prototype.render=function(){if(!this.props.dataContext||!this.props.dataContext.get_Enabled())return React.DOM.noscript();var headerTitle=React.DOM.span({key:"text"},"Performance Results"),rotateButton=React.DOM.button({key:"rotate",className:"rotate",title:"Rotate",onClick:this.handleRotateButtonClick},"R"),performanceHeader=React.DOM.div({key:"performanceHeader",className:"PerfDivHeader"},[headerTitle,rotateButton]),markerTab=this.renderTab("markerTab","Performance Markers",0),localStoreTab=this.renderTab("localStoreTab","Local Store",1),globalObjectsCountTab=this.renderTab("globalObjectsCountTab","Global Objects Count",2),automationTab=this.renderTab("automationTab","Automation",3),tabContainer=React.DOM.div({key:"tabContainer",className:"perfTabs perfTabs_container"},[markerTab,localStoreTab,globalObjectsCountTab,automationTab]),performanceTabContent,currentTab=this.props.dataContext.get_CurrentTab();if(currentTab===0)performanceTabContent=PerformanceReportMarkersTab.PerformanceReportMarkersTab({key:"markersTabContent",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_PerformanceMarkersTab(),reportRotated:this.state.reportRotated});else if(currentTab===1)performanceTabContent=PerformanceReportLocalStoreTab.PerformanceReportLocalStoreTab({key:"localStoreTabContent",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_PerformanceLocalStoreTab()});else if(currentTab===2)performanceTabContent=PerformanceReportGlobalObjectsCountTab.PerformanceReportGlobalObjectsCountTab({key:"globalObjectCountTabContent",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_GlobalObjectsCountTab()});else if(currentTab===3)performanceTabContent=PerformanceReportAutomationTab.PerformanceReportAutomationTab({key:"automationTabContent",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_AutomationTab()});else{performanceTabContent=React.DOM.div({key:"performanceReportErrorTab"},"Invalid Tab");console.error("Invalid Tab In Performance Tool")}if(this.state.reportRotated){var transformOrigin=this.state.windowWidth/2,performanceReportStyle={width:this.state.windowHeight,height:this.state.windowWidth,WebkitTransformOrigin:transformOrigin+"px "+transformOrigin+"px",MozTransformOrigin:transformOrigin+"px "+transformOrigin+"px",OTransformOrigin:transformOrigin+"px "+transformOrigin+"px",msTransformOrigin:transformOrigin+"px "+transformOrigin+"px",transformOrigin:transformOrigin+"px "+transformOrigin+"px"};return React.DOM.div({className:"RotatedPerfReport PerformanceReport",style:performanceReportStyle},[performanceHeader,tabContainer,performanceTabContent])}return React.DOM.div({id:"perfDiv",className:"PerfDiv"},React.DOM.div({className:"PerformanceReport"},[performanceHeader,tabContainer,performanceTabContent]))};return PerformanceReportSpec}(TsAdapter.SpecBase);exports.PerformanceReport=DataWrapperComponent.wrapComponent(new PerformanceReportSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/Shell",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Components/Shell/ConfirmDialog","Components/Shell/AuthenticationManager","Components/Shell/CustomScriptsContainer","Components/Performance/PerformanceReport","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ConfirmDialog,AuthenticationManager,CustomScriptsContainer,PerformanceReport,CssClassSet){var ShellSpec=function(_super){__extends(ShellSpec,_super);function ShellSpec(){_super.apply(this,arguments);this.displayName="Shell";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["CanvasConductor","CommandManagerViewModel","DialogConductor","IsSyncCheckCompleted","CustomScriptsContainerViewModel","PerformanceReport"]}ShellSpec.prototype.configureEventListeners=function(){return {AddSelectedViewModelsEvent:this.onAddOrRemoveSelectedViewModels,RemoveSelectedViewModelsEvent:this.onAddOrRemoveSelectedViewModels,ClearSelectedViewModelsEvent:this.onClearSelectedViewModels}};ShellSpec.prototype.onAddOrRemoveSelectedViewModels=function(){this.onSelectionChanged(true)};ShellSpec.prototype.onClearSelectedViewModels=function(){this.onSelectionChanged(false)};ShellSpec.prototype.onSelectionChanged=function(showAppBar){if(this.props.clientContext.isInteractionCentric){var appBarViewModel=this.props.dataContext.get_CommandManagerViewModel();appBarViewModel.shouldRefreshCommandBarForInteractionCentric()&&this.selectionChangeEventHandler(showAppBar)}else this.selectionChangeEventHandler(showAppBar)};ShellSpec.prototype.selectionChangeEventHandler=function(showAppBar){var _this=this;if(showAppBar){if(this.props.dataContext.isCrmDialogActive())return;this.props.dataContext.get_CommandManagerViewModel().registerContextualContexts(function(){Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){_this.props.dataContext.get_CommandManagerViewModel().expand()},Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.selectionExpandAppBar,"SelectionChangeExpandAppBar")})}else{this.props.dataContext.get_CommandManagerViewModel().collapse();window.setTimeout(function(){_this.props.dataContext.get_CommandManagerViewModel().registerContextualContexts(null)},500)}};ShellSpec.prototype.shouldClearSelectedViewModelsOnTargetClick=function(target){return target.closest(".panoramaItem, .flyoutButton-flyOut, .appBar, .CrmDialog-rootView, .messageDialog-popupContent, .lookup-bar").length==0};ShellSpec.prototype.handleContextMenu=function(e){var dialogConductorViewModel=this.props.dataContext.get_DialogConductor();dialogConductorViewModel.get_ActiveNavigationStack().get_Count()===0&&this.props.dataContext.get_CommandManagerViewModel().expand()};ShellSpec.prototype.handleShellClick=function(e){if(e.button===0){var target=$(e.target);if(!this.props.clientContext.isInteractionCentric)(this.props.shouldClearSelectedViewModelsOnTargetClick&&this.props.shouldClearSelectedViewModelsOnTargetClick(target)||this.shouldClearSelectedViewModelsOnTargetClick(target))&&this.props.dataContext.clearSelectedViewModels()}return true};ShellSpec.prototype.onMemoryDiagnosticsChanged=function(){if(this.props.clientContext.memoryUsageTracker.get_MemoryDiagnosticsEnabled())ReactDOM.findDOMNode(this).classList.add("mashupLoadOnDemand");else ReactDOM.findDOMNode(this).classList.remove("mashupLoadOnDemand")};ShellSpec.prototype.componentDidMount=function(){var _this=this,touchAction=this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroidPhone()?"pan-y":"pan-x pan-y";if(this.props.clientContext.userAgent.get_IsWinPhone10())touchAction="pan-x";document.body.setAttribute("touch-action",touchAction);if(this.props.clientContext.userAgent.get_IsIOS()||this.props.clientContext.userAgent.get_IsAndroid())document.body.style.height=document.body.clientHeight+"px";if(!this.props.clientContext.userAgent.get_MutationObserverSupported())PointerEventsPolyfill.dispatcher.eventSources.touch&&typeof PointerEventsPolyfill.dispatcher.eventSources.touch!=="undefined"&&PointerEventsPolyfill.dispatcher.eventSources.touch.elementChanged(document.body);if(this.props.clientContext.userAgent.get_IsIPad()&&this.props.clientContext.userAgent.get_IsIOS8())document.body.style.overflow="hidden";this.props.clientContext.memoryUsageTracker.AddPropertyChangedListener("MemoryDiagnosticsEnabled",function(){_this.onMemoryDiagnosticsChanged()})};ShellSpec.prototype.useMouse=function(){var userAgent=this.props.clientContext.userAgent;return !userAgent.get_TouchSupported()||!(userAgent.get_IsIOS()||userAgent.get_IsAndroid()||userAgent.get_IsIPhone()||userAgent.get_IsWinPhone()||userAgent.get_IsAndroidPhone()||userAgent.get_PhoneURLParameter())};ShellSpec.prototype.render=function(){var _a=this.props.clientContext,userAgent=_a.userAgent,isPhone=_a.isPhone,isMailApp=_a.isMailApp,children=[].concat(this.props.children);children.push(CustomScriptsContainer.CustomScriptsContainer({key:"scripts",dataContext:this.props.dataContext.get_CustomScriptsContainerViewModel(),clientContext:this.props.clientContext}));children.push(ConfirmDialog.ConfirmDialog({key:"confirmdialog"}));children.push(AuthenticationManager.AuthenticationManager({key:"authmanager"}));children.push(React.DOM.div({key:"synccheck",id:"syncCheckComplete","data-content":this.props.dataContext.get_IsSyncCheckCompleted()?"1":"0",style:{display:"none"}}));children.push(React.DOM.iframe({key:"authframe",id:"authFrame",name:"authFrame",src:"",style:{display:"none"}}));children.push(PerformanceReport.PerformanceReport({key:"perf",dataContext:this.props.dataContext.get_PerformanceReport(),clientContext:this.props.clientContext}));var perfReport=window.Microsoft.Crm.Client.Core.ViewModels.PerformanceReport;perfReport.get_PerformanceBadgeEnabled()&&children.push(React.DOM.div({key:"perfBadge",id:"perfBadge",onClick:perfReport.TogglePerformanceResultsVisibility},"PR"));return React.DOM.div({id:"shell",onClick:this.handleShellClick,onContextMenu:this.useMouse()?this.handleContextMenu:null,style:this.props.styles,className:CssClassSet((_b={},_b["lang-"+this.props.dataContext.get_UserContext().get_LanguageId()]=!isMailApp&&!this.props.clientContext.isInteractionCentric,_b["phone"]=isPhone,_b["tablet"]=!isPhone&&!isMailApp,_b["android51"]=userAgent.get_IsAndroid51(),_b["android5"]=userAgent.get_IsAndroid5(),_b["android"]=userAgent.get_IsAndroid(),_b["ios"]=userAgent.get_IsIOS(),_b["ios8"]=userAgent.get_IsIOS8(),_b["ios8_4_1"]=userAgent.get_IsIOS841(),_b["macSafari"]=userAgent.get_IsMacSafari(),_b["macintosh"]=userAgent.get_IsMacIntosh(),_b["chromeGauntletVersion"]=userAgent.get_IsBrowserChromeGauntletVersion(),_b["windows"]=userAgent.get_IsWindows(),_b["win81"]=userAgent.get_IsWindows81(),_b["winPhone81"]=userAgent.get_IsWindowsPhone81(),_b["winPhone10"]=userAgent.get_IsWinPhone10(),_b["mashupLoadOnDemand"]=this.props.clientContext.memoryUsageTracker.get_MemoryDiagnosticsEnabled(),_b["hoverable"]=!userAgent.get_IsIOS()&&!userAgent.get_IsAndroid(),_b["interactionCentric"]=this.props.clientContext.isInteractionCentric,_b),this.props.className)},children);var _b};return ShellSpec}(TsAdapter.SpecBase);exports.Shell=DataWrapperComponent.wrapComponent(new ShellSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/UserEducation",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var UserEducationSpec=function(_super){__extends(UserEducationSpec,_super);function UserEducationSpec(){_super.apply(this,arguments);this.displayName="UserEducation"}UserEducationSpec.prototype.shouldComponentUpdate=function(){return false};UserEducationSpec.prototype.render=function(){var header=React.DOM.div({key:"header",id:"UserEducationHeader",className:"userEducationHeader"},React.DOM.label({id:"UserEducationTitle",className:"userEducationTitle"})),tips=React.DOM.div({key:"tips",id:"UserEducationTips",className:"userEducationTips"},[React.DOM.label({key:"tip1",id:"HelpTip1",className:"helpTip1"}),React.DOM.label({key:"tip2",id:"HelpTip2",className:"helpTip2"}),React.DOM.label({key:"tip3",id:"HelpTip3",className:"helpTip3"})]),gifSection=React.DOM.div({key:"gif",className:"gifSection"},React.DOM.img({id:"userEducationImage"})),syncProgressIndicatorSection=React.DOM.div({key:"syncprogress",id:"SyncProgressIndicatorSection",className:"syncProgressIndicatorSection"},[React.DOM.label({key:"progress",id:"SyncProgressIndicator",className:"syncProgressIndicator"}),React.DOM.label({key:"text",id:"SyncProgressIndicatorText",className:"syncProgressIndicatorText"}),React.DOM.label({key:"step",id:"StepProgressIndicator",className:"stepProgressIndicator"})]),waitLabel=React.DOM.label({key:"wait",id:"WaitLabel",className:"waitLabel"}),crmUiLoading=React.DOM.div({key:"crmui",id:"CRMUILoading",className:"indeterminateProgressRing"},[React.DOM.div({key:"dot1",className:"progressDot"}),React.DOM.div({key:"dot2",className:"progressDot"}),React.DOM.div({key:"dot3",className:"progressDot"}),React.DOM.div({key:"dot4",className:"progressDot"}),React.DOM.div({key:"dot5",className:"progressDot"})]),feedbackSection=React.DOM.div({key:"feedback",className:"feedbackSection"},React.DOM.div({id:"LoadingSection",className:"loadingSection"},[syncProgressIndicatorSection,waitLabel,crmUiLoading]));return React.DOM.div({id:"UserEducation",className:"userEducation",style:{display:"none"}},header,tips,gifSection,feedbackSection)};return UserEducationSpec}(TsAdapter.SpecBase);exports.UserEducation=TsAdapter.createComponent(new UserEducationSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/Popup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var PopupSpec=function(_super){__extends(PopupSpec,_super);function PopupSpec(){_super.apply(this,arguments);this.displayName="Popup";this.mixins=[PureUpdate.Mixin]}PopupSpec.prototype.getDefaultProps=function(){return {bindingElement:document,ariaLabel:""}};PopupSpec.prototype.handleClick=function(e){if(this.props.onDismiss)if(this.shouldDismissOnElementFocus(e.target)){this.props.onDismiss($(e.target));e.stopPropagation()}};PopupSpec.prototype.handlePointerDown=function(e){this.startPointerX=e.clientX;this.startPointerY=e.clientY};PopupSpec.prototype.handlePointerUp=function(e){var endPointerX=e.clientX,endPointerY=e.clientY;Math.abs(this.startPointerX-endPointerX)<=20&&Math.abs(this.startPointerY-endPointerY)<=20&&this.handleClick(e)};PopupSpec.prototype.bindDismissEvents=function(){if(Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsIOS()||Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsAndroid()){this.props.bindingElement.addEventListener("pointerdown",this.handlePointerDown);this.props.bindingElement.addEventListener("pointerup",this.handlePointerUp)}else this.props.bindingElement.addEventListener("click",this.handleClick)};PopupSpec.prototype.unbindDismissEvents=function(){if(Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsIOS()||Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsAndroid()){this.props.bindingElement.removeEventListener("pointerdown",this.handlePointerDown);this.props.bindingElement.removeEventListener("pointerup",this.handlePointerUp)}else this.props.bindingElement.removeEventListener("click",this.handleClick)};PopupSpec.prototype.shouldDismissOnElementFocus=function(e){if(this.props.keepOpenOnTap)return false;if(!e||!e.tagName||e.tagName==="body")return true;if(this.props.keepOpenOnPopupTap){if(e.getAttribute("data-is-popup")==="true")return false}else if(this.isMounted()&&e==ReactDOM.findDOMNode(this))return false;return this.shouldDismissOnElementFocus(e.parentElement)};PopupSpec.prototype.componentDidMount=function(){if(this.props.visible){this.bindDismissEvents();this.getFirstFocusableElement(ReactDOM.findDOMNode(this))}};PopupSpec.prototype.componentDidUpdate=function(prevProps){if(prevProps&&this.props&&prevProps.visible!==this.props.visible)if(this.props.visible){this.bindDismissEvents();this.getFirstFocusableElement(ReactDOM.findDOMNode(this))}else this.unbindDismissEvents()};PopupSpec.prototype.getFirstFocusableElement=function(domElement){var focusableElements;focusableElements=$(domElement).find("[tabindex]");for(var focusableElementsCount=focusableElements.length,count=0;count<focusableElementsCount;count++){var currentElement=focusableElements[count],tabIndex=currentElement.getAttribute("tabindex");if(parseInt(tabIndex)>-1&&$(currentElement).is(":visible")){currentElement.focus();break}}};PopupSpec.prototype.componentWillMount=function(){this.activeElementBeforeOpening=document.activeElement};PopupSpec.prototype.componentWillUnmount=function(){this.props&&this.props.visible&&this.unbindDismissEvents();!this.props.skipFocusActiveElementBeforeOpening&&Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance().get_IsInteractionCentricDashboard()&&this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};PopupSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet({popupContent:true,popupHidden:!this.props.visible},this.props.className),id:this.props.id,ref:"content",role:"dialog","data-is-popup":"true",style:this.props.style,onScroll:this.props.onScroll,"aria-label":this.props.ariaLabel,onKeyDown:this.props.onKeyDown?this.props.onKeyDown:null},this.props.children)};return PopupSpec}(TsAdapter.SpecBase);exports.Popup=TsAdapter.createComponent(new PopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/XrmUIDescriptorMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var XrmUIDescriptorMixin=function(_super){__extends(XrmUIDescriptorMixin,_super);function XrmUIDescriptorMixin(){_super.apply(this,arguments);this.properties={};this.eventListeners={}}XrmUIDescriptorMixin.prototype.addEventListener=function(eventType,eventListener){try{if(this.isMounted()){this.eventListeners[eventType]=eventListener;ReactDOM.findDOMNode(this).addEventListener(eventType,eventListener)}}catch(e){console.error(e)}};XrmUIDescriptorMixin.prototype.getBoundingBox=function(){var boundingValues={},domNode=$(ReactDOM.findDOMNode(this));if(domNode){var offsetObj=domNode.offset();boundingValues["left"]=offsetObj.left;boundingValues["top"]=offsetObj.top;boundingValues["height"]=domNode.height();boundingValues["width"]=domNode.width();return boundingValues}return null};XrmUIDescriptorMixin.prototype.isVisible=function(){var domNode=$(ReactDOM.findDOMNode(this));if(domNode)return domNode.is(":visible");return false};XrmUIDescriptorMixin.prototype.removeEventListener=function(eventType){try{this.isMounted()&&ReactDOM.findDOMNode(this).removeEventListener(eventType,this.eventListeners[eventType])}catch(e){console.error(e)}};XrmUIDescriptorMixin.prototype.componentDidMount=function(){try{var clientContext=this.props.reactClientContext?this.props.reactClientContext:this.props.clientContext;if(clientContext&&clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled(Microsoft.Crm.Client.Application.App.Features.FeatureName.guidedHelp)&&Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.get_DefaultInstance().get_UserContext().get_UserSettings().get_IsGuidedHelpEnabled())if(this.getProperties!=undefined){this.properties=this.getProperties();this.properties&&Object.keys(this.properties).length>0&&clientContext.xrmUIControlsWrapper.registerControl(this,this.properties)}}catch(e){console.error(e)}};XrmUIDescriptorMixin.prototype.componentWillUnmount=function(){try{var clientContext=this.props.reactClientContext?this.props.reactClientContext:this.props.clientContext;if(clientContext&&clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled(Microsoft.Crm.Client.Application.App.Features.FeatureName.guidedHelp)&&Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.get_DefaultInstance().get_UserContext().get_UserSettings().get_IsGuidedHelpEnabled())this.properties&&Object.keys(this.properties).length>0&&clientContext.xrmUIControlsWrapper.unRegisterControl(this.properties)}catch(e){console.error(e)}};return XrmUIDescriptorMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new XrmUIDescriptorMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/Button",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/XrmUIDescriptorMixin","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,IXUD,PureUpdate,CssClassSet){exports.handlerForToggleButton;var ButtonSpec=function(_super){__extends(ButtonSpec,_super);function ButtonSpec(){_super.apply(this,arguments);this.displayName="Button";this.mixins=[PureUpdate.Mixin,IXUD.Mixin]}ButtonSpec.prototype.getDefaultProps=function(){return {enabled:true,role:"button",ariaLabel:""}};ButtonSpec.prototype.getProperties=function(){var properties={},ctrlId=this.getNavButtonId(this.props.dataId);if(ctrlId){properties["type"]=XrmUI.UIControlType.staticNavigationButton;properties["id"]=ctrlId;if(this.props.xrmUIParentId)properties["parentId"]=this.props.xrmUIParentId}return properties};ButtonSpec.prototype.handleShortPress=function(e){if(this.props.onClick){if(this.props.stopShortPressPropagation!==false){e.stopPropagation();if(typeof e.nativeEvent.preventDefault==="function"){e.nativeEvent.preventDefault();var context=this.props.reactClientContext;(this.props.touchActionNone||context&&context.userAgent&&context.userAgent.get_IsAndroid())&&$(ReactDOM.findDOMNode(this)).focus()}}this.props.onClick(e)}};ButtonSpec.prototype.stopClickPropagation=function(e){e.nativeEvent.stopImmediatePropagation()};ButtonSpec.prototype.getNavButtonId=function(id){switch(id){case "home":return XrmUI.ControlId.homeButton;case "searchImage":return XrmUI.ControlId.searchButton;default:return null}};ButtonSpec.prototype.componentDidMount=function(){var context=this.props.reactClientContext;(this.props.touchActionNone||context&&context.userAgent&&context.userAgent.get_IsIPad()&&!this.props.touchActionScroll)&&ReactDOM.findDOMNode(this).setAttribute("touch-action","none");if(this.isMounted())this.props.onDidMount&&this.props.onDidMount()};ButtonSpec.prototype.componentDidUpdate=function(){if(exports.handlerForToggleButton!=null){exports.handlerForToggleButton();exports.handlerForToggleButton=null}};ButtonSpec.prototype.handleKeyDown=function(e){switch(e.key){case "Enter":this.handleShortPress(e);break}};ButtonSpec.prototype.render=function(){if(this.props.className=="toggleButton"&&exports.handlerForToggleButton==null)exports.handlerForToggleButton=this.props.callbackForToggleButton;return React.DOM.button({className:CssClassSet(null,"button",this.props.className),disabled:this.props.noDisabledAttribute?null:!this.props.enabled,style:this.props.style,tabIndex:this.props.tabIndex!=undefined?this.props.tabIndex:-1,role:this.props.role,title:this.props.title,"data-id":this.props.dataId,"data-flyoutopen":this.props.dataFlyoutOpen?"1":null,"data-pinned":this.props.dataPinned,id:this.props.id,onKeyDown:this.props.onKeyDown||this.handleKeyDown,onShortPress:this.handleShortPress,onClick:this.props.stopClickPropagation?this.stopClickPropagation:null,onBlur:this.props.onBlur,"aria-label":this.props.ariaLabel,onMouseEnter:this.props.onMouseEnter?this.props.onMouseEnter:null},this.props.children)};return ButtonSpec}(TsAdapter.SpecBase);exports.Button=TsAdapter.createComponent(new ButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/ProgressIndicator",["require","exports","Core/ReactTypescriptAdapter","Utils/CssClassSet"],function(require,exports,TsAdapter,CssClassSet){(function(ProgressIndicatorType){ProgressIndicatorType[ProgressIndicatorType["Bar"]=0]="Bar";ProgressIndicatorType[ProgressIndicatorType["Ring"]=1]="Ring"})(exports.ProgressIndicatorType||(exports.ProgressIndicatorType={}));var ProgressIndicatorType=exports.ProgressIndicatorType,ProgressIndicatorSpec=function(_super){__extends(ProgressIndicatorSpec,_super);function ProgressIndicatorSpec(){_super.apply(this,arguments);this.displayName="ProgressIndicator"}ProgressIndicatorSpec.prototype.shouldComponentUpdate=function(nextProps){return this.props.active!==nextProps.active||this.props.type!==nextProps.type};ProgressIndicatorSpec.prototype.renderDots=function(){for(var dots=[],i=0;i<5;i++)dots.push(React.DOM.div({key:i.toString(),className:"progressDot"},React.DOM.div()));return dots};ProgressIndicatorSpec.prototype.render=function(){if(!this.props.active)return React.DOM.noscript();return React.DOM.div({style:this.props.style,className:CssClassSet({indeterminateProgressBar:!this.props.type||this.props.type===ProgressIndicatorType.Bar,indeterminateProgressRing:this.props.type===ProgressIndicatorType.Ring,hideProgressBar:!this.props.active},this.props.className)},this.renderDots())};return ProgressIndicatorSpec}(TsAdapter.SpecBase);exports.ProgressIndicator=TsAdapter.createComponent(new ProgressIndicatorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/OfflineIndicator",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Popup","Components/Primitives/Button","Components/Primitives/ProgressIndicator","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,Popup,Button,ProgressIndicator,CssClassSet){var OfflineIndicatorSpec=function(_super){__extends(OfflineIndicatorSpec,_super);function OfflineIndicatorSpec(){_super.apply(this,arguments);this.displayName="OfflineIndicator";this.listenToProperties=["IsServerAvailable","IsAttemptingConnection"]}OfflineIndicatorSpec.prototype.getInitialState=function(){return {offlineDialogIsVisible:false}};OfflineIndicatorSpec.prototype.hideOfflineDialog=function(){this.setState({offlineDialogIsVisible:false})};OfflineIndicatorSpec.prototype.handleReconnectClick=function(){this.props.dataContext.get_ConnectCommand().execute();this.hideOfflineDialog()};OfflineIndicatorSpec.prototype.handleIndicatorClick=function(){this.props.dataContext.get_IsAttemptingConnectionVisible()&&this.setState({offlineDialogIsVisible:!this.state.offlineDialogIsVisible})};OfflineIndicatorSpec.prototype.componentDidMount=function(){this.setState({offlineDialogContainerHeight:this.calculateOfflineContainerHeight()});if(this.props.clientContext.userAgent.get_IsWinPhone()){var domNode=ReactDOM.findDOMNode(this);domNode.addEventListener("transitionend",this.handleTransitionEnd)}};OfflineIndicatorSpec.prototype.componentWillUnmount=function(){if(this.props.clientContext.userAgent.get_IsWinPhone()){var domNode=ReactDOM.findDOMNode(this);domNode&&domNode.removeEventListener("transitionend",this.handleTransitionEnd)}};OfflineIndicatorSpec.prototype.handleTransitionEnd=function(e){var _this=this;if(!this.state.offlineDialogIsVisible){var offlineIndicatorNode=this.refs["offlineIndicator"],originalValue=$(offlineIndicatorNode).css(this.props.clientContext.transformPropertyName);$(offlineIndicatorNode).css(this.props.clientContext.transformPropertyName,"none");window.setTimeout(function(){_this.isMounted()&&_this.refs["offlineIndicator"]==offlineIndicatorNode&&$(offlineIndicatorNode).css(_this.props.clientContext.transformPropertyName,originalValue)},0)}};OfflineIndicatorSpec.prototype.calculateOfflineContainerHeight=function(){var offlineIndicatorMargin=30,dummySpan=$("<span class='dummySpan'></span>").appendTo("body");dummySpan.text(this.props.clientContext.getLocalizedString("L_Connecting_Text"));var reconnectWidth=offlineIndicatorMargin+dummySpan.width();dummySpan.text(this.props.clientContext.getLocalizedString("L_Offline_Indicator_Text"));var offlineWidth=offlineIndicatorMargin+dummySpan.width(),cloneDialogNode=$(this.refs["offlineDialog"]).clone(),offlineDialogHeight=cloneDialogNode.appendTo("body").height();dummySpan.remove();cloneDialogNode.remove();return Math.max(offlineWidth,reconnectWidth,offlineDialogHeight)};OfflineIndicatorSpec.prototype.render=function(){var isServerAvailable=this.props.dataContext.get_IsServerAvailable(),isAttemptingConnection=this.props.dataContext.get_IsAttemptingConnection(),showAttemptingConnectionText=this.props.dataContext.get_ShowAttemptingConnectionText(),reconnectButton=Button.Button({key:"reconnect",id:"reconnect",className:"dynamicsButton",onClick:this.handleReconnectClick,enabled:this.props.dataContext.get_ConnectCommand().get_CanExecute(),reactClientContext:this.props.clientContext,touchActionNone:this.props.clientContext.userAgent.get_IsIPhone()},this.props.clientContext.getLocalizedString("L_Reconnect_Text")),waitSpan=React.DOM.span({className:"button-label"},this.props.clientContext.getLocalizedString("L_Wait_Offline_Dialog_Text")),offlineDialog=React.DOM.div({ref:"offlineDialog",key:"offlineDialog",className:"offlineDialog",style:{height:this.state.offlineDialogContainerHeight}},[React.DOM.span({key:"offlineText"},this.props.dataContext.get_OfflineDialogText()),showAttemptingConnectionText?waitSpan:reconnectButton]),offlineIndicatorText=this.props.clientContext.getLocalizedString(isAttemptingConnection?"L_Connecting_Text":"L_Offline_Indicator_Text"),offlineIndicator=Button.Button({key:"offlineIndicator",ref:"offlineIndicator",id:"offline",onClick:this.handleIndicatorClick,className:"offlineIndicator dynamicsButton",style:{width:this.state.offlineDialogContainerHeight},reactClientContext:this.props.clientContext,touchActionNone:this.props.clientContext.userAgent.get_IsIPhone()},React.DOM.span({className:"button-label"},offlineIndicatorText)),progressIndicator=ProgressIndicator.ProgressIndicator({key:"progressIndicator",type:ProgressIndicator.ProgressIndicatorType.Bar,active:isAttemptingConnection,style:{width:this.state.offlineDialogContainerHeight}});return Popup.Popup({visible:!isServerAvailable,className:CssClassSet({"offlineContainer transformAnim":true,offlineContainerHidden:!this.state.offlineDialogIsVisible}),onDismiss:this.hideOfflineDialog},[offlineDialog,offlineIndicator,progressIndicator])};return OfflineIndicatorSpec}(TsAdapter.SpecBase);exports.OfflineIndicator=DataWrapperComponent.wrapComponent(new OfflineIndicatorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/OfflineStatusMenu",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Core/ComponentUpdateRequestManager","Components/Primitives/Popup","Components/Primitives/Button","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ComponentUpdateRequestManager,Popup,Button,CssClassSet){exports.DESCRIPTOR_NAME="OfflineStatusMenu";var OfflineStatusMenuSpec=function(_super){__extends(OfflineStatusMenuSpec,_super);function OfflineStatusMenuSpec(){_super.apply(this,arguments);this.mixins=[CustomEventsListener.Mixin];this.displayName="OfflineStatusMenu";this.listenToProperties=["LastRetrievedText","LastRetrievedTextClassName"]}OfflineStatusMenuSpec.prototype.configureEventListeners=function(){return {UpdateOfflineStatusTextEvent:this.updateOfflineStatusTextEventHandler}};OfflineStatusMenuSpec.prototype.updateOfflineStatusTextEventHandler=function(){this.requestRender("OfflineStatusMenu receieved an UpdateOfflineStatusTextEvent")};OfflineStatusMenuSpec.prototype.requestRender=function(reason){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);this.updateManager.requestUpdate(reason)};OfflineStatusMenuSpec.prototype.getInitialState=function(){return {offlineFlyoutIsVisible:false}};OfflineStatusMenuSpec.prototype.hideOfflineFlyout=function(){this.setState({offlineFlyoutIsVisible:false})};OfflineStatusMenuSpec.prototype.handleButtonClick=function(){this.setState({offlineFlyoutIsVisible:!this.state.offlineFlyoutIsVisible})};OfflineStatusMenuSpec.prototype.handleofflineStatusMessageClick=function(){this.props.dataContext.get_MetadataDownloadCommand().execute();this.hideOfflineFlyout()};OfflineStatusMenuSpec.prototype.componentDidUpdate=function(){if(this.props.clientContext.userAgent.get_IsAndroid()&&!this.props.clientContext.userAgent.get_IsAndroid5()){var node=this.refs["lastRetrievedText"];node.style.display="none";window.setTimeout(function(){node.style.display="inline"},0)}};OfflineStatusMenuSpec.prototype.render=function(){var offlineSubStatusChildren=[],offlineSyncStatusInfo=this.props.dataContext.get_GetOfflineSyncStatusInfo(),isOfflineSyncStatusAvailable=typeof offlineSyncStatusInfo!="undefined"&&offlineSyncStatusInfo!=null,offlineEnabledSymbol=React.DOM.span({key:"offlineEnabled",className:"offlineEnabled"}),offlineEnabledCountText=React.DOM.span({key:"offlineEnabledCountText",className:"offlineEnabledCountText"},isOfflineSyncStatusAvailable?offlineSyncStatusInfo.get_EnabledEntitiesCount():0),offlineDisabledSymbol=React.DOM.span({key:"offlineDisabled",className:"offlineDisabled"}),offlineDisabledCountText=React.DOM.span({key:"offlineDisabledCountText",className:"offlineDisabledCountText"},isOfflineSyncStatusAvailable?offlineSyncStatusInfo.get_DisabledEntitiesCount():0),offlineSyncStatusSymbol=React.DOM.span({key:"offlineSync",className:this.props.dataContext.get_OfflineGlobalSyncStatusTextClassName()}),offlineSyncStatusText=React.DOM.span({key:"offlineStatusFlyoutText",className:"offlineSyncStatusFlyoutText"},isOfflineSyncStatusAvailable?this.props.dataContext.get_OfflineGlobalSyncStatusText():""),offlineEntitiesCount=React.DOM.div({key:"offlineEntites"},[offlineSyncStatusSymbol,offlineSyncStatusText,offlineEnabledSymbol,offlineEnabledCountText,offlineDisabledSymbol,offlineDisabledCountText]),notificationPip=React.DOM.div({key:"offlineNotificationPip"},React.DOM.span({key:"notificationPip",className:CssClassSet({notificationPip:this.state.offlineFlyoutIsVisible,hideNotificationPip:!this.state.offlineFlyoutIsVisible})})),showPopup=this.props.dataContext.get_IsOptinEnabled()&&isOfflineSyncStatusAvailable,enableOfflineSubStatusLink=this.props.dataContext.get_IsServerAvailable()&&isOfflineSyncStatusAvailable&&offlineSyncStatusInfo.get_StatusReason()!=-2&&offlineSyncStatusInfo.get_StatusReason()===3&&this.props.dataContext.get_IsServerMetadataSyncRequired();if(enableOfflineSubStatusLink){var offlineSubStatusLink=React.DOM.span({key:"offlineSubStatusLink",className:"offlineSubStatusLink"},React.DOM.a({onClick:this.handleofflineStatusMessageClick,key:"offlineSubStatusLinkAnchor",className:"offlineSubStatusLinkAnchor"},this.props.clientContext.getLocalizedString("L_Metadata_Download"))),offlineSubStatusLinkText=React.DOM.span({key:"offlineSubStatusLinkText",className:"offlineSubStatusText"},this.props.dataContext.get_OfflineStatusReason());offlineSubStatusChildren.push(offlineSubStatusLinkText);offlineSubStatusChildren.push(offlineSubStatusLink)}else{var offlineSubStatusMessage=React.DOM.span({key:"offlineSubStatusMessage",className:"offlineSubStatusText"},this.props.dataContext.get_OfflineStatusReason());offlineSubStatusChildren.push(offlineSubStatusMessage)}var offlineSubStatusText=React.DOM.div({key:"offlineSubStatus",className:"offlineSubStatusDiv"},offlineSubStatusChildren),offlinePopup=Popup.Popup({key:"offlineStatusMenu",id:"offlineStatusMenu",visible:!showPopup?false:this.state.offlineFlyoutIsVisible,className:"offlineStatusMenu",onDismiss:this.hideOfflineFlyout},[offlineEntitiesCount,this.props.dataContext.get_OfflineStatusReason()==""?null:offlineSubStatusText]),offlineStatusButton=Button.Button({id:"offlineStatusButton",key:"offlineStatusButton",onClick:showPopup?this.handleButtonClick:null,className:"offlineStatusButton",reactClientContext:this.props.clientContext},[React.DOM.span({key:"offlineStatusIcon",className:this.props.dataContext.get_LastRetrievedTextClassName()}),React.DOM.span({key:"offlineStatusText",ref:"lastRetrievedText",className:"lastRetrievedText"},this.props.dataContext.get_LastRetrievedText())]),children=[offlineStatusButton,notificationPip,offlinePopup];return React.DOM.div({key:"offlineStatusMenuContainer",className:CssClassSet({"globalMenu-Container":true,"offlineStatusMenu-Container":true})},children)};return OfflineStatusMenuSpec}(TsAdapter.SpecBase);exports.OfflineStatusMenu=DataWrapperComponent.wrapComponent(new OfflineStatusMenuSpec)});define("Utils/Animator",["require","exports"],function(require,exports){function getSupportedAnimationEndEvent(){var el=document.createElement("div"),animations={animation:"animationend",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(var animation in animations)if(el.style[animation]!==undefined){el=null;return animations[animation]}el=null;return "animationend"}var animationEndEvent=getSupportedAnimationEndEvent(),Animation=function(){function Animation(node,animation){this.node=node;this.animation=animation}Animation.prototype.start=function(){var _this=this;this.node.classList.remove(this.animation);this.node.removeEventListener(animationEndEvent,this.callback);return new Promise.Promise(function(resolve,reject){_this.callback=function(){_this.node.classList.remove(_this.animation);_this.node.removeEventListener(animationEndEvent,_this.callback);window.clearTimeout(_this.callbackTimeoutId);resolve()};_this.node.addEventListener(animationEndEvent,_this.callback);_this.callbackTimeoutId=window.setTimeout(_this.callback,2e3);_this.node.classList.add(_this.animation)})};return Animation}();function animate(node,animation){if(!node)return Promise.resolve();var animationObj=new Animation(node,animation);return animationObj.start()}exports.animate=animate});define("Utils/LoadingManager",["require","exports"],function(require,exports){var animatingPage=false,pageAnimationEndCallbacks=[];function setAnimatingPage(value){animatingPage=value;if(!animatingPage){var callbacksArray=pageAnimationEndCallbacks.slice();pageAnimationEndCallbacks=[];for(var _i=0;_i<callbacksArray.length;_i++){var callback=callbacksArray[_i];callback()}}}exports.setAnimatingPage=setAnimatingPage;function isAnimatingPage(){return animatingPage}exports.isAnimatingPage=isAnimatingPage;function onAnimatingPageEnd(callback){if(isAnimatingPage())pageAnimationEndCallbacks.push(callback);else callback()}exports.onAnimatingPageEnd=onAnimatingPageEnd});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ConductorItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/Animator","Utils/LoadingManager"],function(require,exports,TsAdapter,DataWrapperComponent,Animator,LoadingManager){var ConductorItemSpec=function(_super){__extends(ConductorItemSpec,_super);function ConductorItemSpec(){_super.apply(this,arguments);this.displayName="ConductorItem"}ConductorItemSpec.prototype.findComponentForType=function(type){if(!type)return null;var factory=this.props.resolveViewModelNameToComponentFactory(type.getName());if(factory)return factory;return this.findComponentForType(type.getBaseType())};ConductorItemSpec.prototype.activate=function(){if(!this.isMounted()||this.props.mountState!==0)return;var vm=this.props.dataContext;vm&&vm.activate&&vm.activate()};ConductorItemSpec.prototype.deactivate=function(){var vm=this.props.dataContext;vm&&vm.deactivate&&vm.deactivate()};ConductorItemSpec.prototype.getBackgroundColorForRootComponent=function(rootViewModel){if(!this.props.clientContext.isPreview&&rootViewModel.get_IsLocked()&&!this.props.clientContext.isPhone)return "#f0f0f0";return "#ffffff"};ConductorItemSpec.prototype.handleConductorTopChange=function(){var shell=document.getElementById("shell");shell.style.backgroundColor=this.getBackgroundColorForRootComponent(this.props.dataContext)};ConductorItemSpec.prototype.transitionIn=function(){var _this=this;LoadingManager.setAnimatingPage(true);Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){if(_this.isMounted()){var node=ReactDOM.findDOMNode(_this);if(node){node.style.display=_this.displayVisible;node.setAttribute("id",_this.props.activeItemId);if(_this.props.clientContext.isMailApp||_this.props.clientContext.isInteractionCentric){_this.handleConductorTopChange();_this.props.dataContext.apcl("IsLocked",_this.handleConductorTopChange)}Animator.animate(node,_this.props.entranceAnimationName).then(function(v){LoadingManager.setAnimatingPage(false)},function(e){LoadingManager.setAnimatingPage(false)});window.setTimeout(_this.activate,0)}}},Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.ConductorItemTransitionIn,"ConductorItem.TransitionIn")};ConductorItemSpec.prototype.transitionOut=function(){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){(_this.props.clientContext.isMailApp||_this.props.clientContext.isInteractionCentric)&&_this.props.dataContext.rpcl("IsLocked",_this.handleConductorTopChange);if(_this.isMounted()){_this.hide();_this.deactivate();_this.props.mountState===2&&_this.lazyDestroy()}},Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.ConductorItemTransitionOut,"ConductorItem.TransitionOut")};ConductorItemSpec.prototype.hide=function(){var node=ReactDOM.findDOMNode(this);if(node){this.displayVisible=node.style.display;node.style.display="none";node.classList.remove(this.props.entranceAnimationName);node.removeAttribute("id")}};ConductorItemSpec.prototype.lazyCreate=function(){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){_this.props.mountState!==2&&_this.state.firstRenderState===0&&_this.setState({firstRenderState:1})},Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.ConductorItemLazyCreation,"ConductorItem.LazyCreate")};ConductorItemSpec.prototype.lazyDestroy=function(){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){_this.props.mountState===2&&_this.props.onReadyToUnmount(_this.props.dataContext.get_ViewModelId())},-Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.ConductorItemLazyDestruction,"ConductorItem.LazyDestroy")};ConductorItemSpec.prototype.getInitialState=function(){return {firstRenderState:this.props.mountState===0?2:0}};ConductorItemSpec.prototype.componentDidMount=function(){switch(this.props.mountState){case 0:this.transitionIn();break;case 1:this.lazyCreate();break;case 2:this.lazyDestroy();break}};ConductorItemSpec.prototype.componentDidUpdate=function(prevProps,prevState){if(this.state.firstRenderState===1){if(this.props.mountState===1)this.hide();else this.props.mountState===0&&this.transitionIn();this.setState({firstRenderState:2})}};ConductorItemSpec.prototype.componentWillReceiveProps=function(nextProps){if(this.props.mountState!==nextProps.mountState)switch(nextProps.mountState){case 0:if(this.state.firstRenderState!==2)this.setState({firstRenderState:1});else this.transitionIn();break;case 1:this.transitionOut();break;case 2:if(this.state.firstRenderState===2)this.transitionOut();else this.lazyDestroy();break}};ConductorItemSpec.prototype.shouldComponentUpdate=function(nextProps,nextState){var propChanged=this.props.dataContext!==nextProps.dataContext||this.props.conductorHeight!==nextProps.conductorHeight||this.props.conductorWidth!==nextProps.conductorWidth,firstRenderRequested=nextState.firstRenderState===1;return propChanged||firstRenderRequested};ConductorItemSpec.prototype.render=function(){if(this.state.firstRenderState===0&&this.props.mountState!==0)return React.DOM.noscript();this.props.mountState===0&&LoadingManager.setAnimatingPage(true);var viewModel=this.props.dataContext,factory=this.findComponentForType(Object.getType(viewModel));if(!factory){console.error("Unable to find a component for view model type: "+Object.getType(viewModel).getName());return React.DOM.noscript()}return factory({key:viewModel.get_ViewModelId(),clientContext:this.props.clientContext,dataContext:viewModel,className:"conductorContent",initialParentHeight:this.props.conductorHeight,initialParentWidth:this.props.conductorWidth})};return ConductorItemSpec}(TsAdapter.SpecBase);exports.ConductorItem=DataWrapperComponent.wrapComponent(new ConductorItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/RetrieveViewDescriptorMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var RetrieveViewDescriptorMixin=function(_super){__extends(RetrieveViewDescriptorMixin,_super);function RetrieveViewDescriptorMixin(){_super.apply(this,arguments)}RetrieveViewDescriptorMixin.prototype.getInitialState=function(){return {viewDescriptor:null}};RetrieveViewDescriptorMixin.prototype.requestViewDescriptor=function(props){if(props.clientContext&&props.clientContext.viewManager&&props.dataContext){if(this.state.viewDescriptor){this.setState({viewDescriptor:null});props.clientContext.viewManager.removeDescriptor(props.dataContext.get_ViewModelId())}if(!props.dataContext.get_GetDefinitionProvider()&&props.descriptor)this.setState({viewDescriptor:props.descriptor});else props.clientContext.viewManager.requestDefinition(props.dataContext.get_ViewModelId(),this.onViewDescriptorRetrieved)}};RetrieveViewDescriptorMixin.prototype.onViewDescriptorRetrieved=function(descriptor){this.setState({viewDescriptor:descriptor})};RetrieveViewDescriptorMixin.prototype.componentWillMount=function(){this.requestViewDescriptor(this.props)};RetrieveViewDescriptorMixin.prototype.componentWillReceiveProps=function(nextProps){nextProps.dataContext!==this.props.dataContext&&this.requestViewDescriptor(nextProps)};return RetrieveViewDescriptorMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new RetrieveViewDescriptorMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/DefaultValueLabel",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){exports.DESCRIPTOR_NAME="DefaultValueLabel";exports.RENDERED_PROPERTY_NAME="Data";exports.DEFAULT_VALUE_MASK="---";exports.SECURE_VALUE_MASK="*******";var DefaultValueLabelSpec=function(_super){__extends(DefaultValueLabelSpec,_super);function DefaultValueLabelSpec(){_super.apply(this,arguments);this.displayName="DefaultValueLabel";this.listenToProperties=[exports.RENDERED_PROPERTY_NAME,"UseHiddenMask"]}DefaultValueLabelSpec.prototype.trimWhitespaces=function(text){if(!text)return text;if(typeof text=="string")return text.replace(/\s+/g," ").trim();return text};DefaultValueLabelSpec.prototype.isEmptyString=function(modelValue){return typeof modelValue=="string"&&modelValue.replace(/(?:\\[rn])+/g,"").trim()==""};DefaultValueLabelSpec.prototype.render=function(){var text=exports.DEFAULT_VALUE_MASK;if(this.props.dataContext){if(this.props.dataContext.get_UseHiddenMask())return React.DOM.span(null,exports.SECURE_VALUE_MASK);var modelValue=this.props.dataContext.get_Data();if(modelValue){text=this.props.clientContext.isMailApp&&this.isEmptyString(modelValue)?exports.DEFAULT_VALUE_MASK:modelValue;if(this.props.clientContext.isInteractionCentric)text=this.trimWhitespaces(text)}}var emptyMaskClass=CssClassSet({"empty-mask":text==exports.DEFAULT_VALUE_MASK});if(this.props.dataContext&&this.props.dataContext.get_UseHTMLFormat())return React.DOM.span({className:emptyMaskClass,dangerouslySetInnerHTML:{__html:text}});else return React.DOM.span({className:emptyMaskClass},text)};return DefaultValueLabelSpec}(TsAdapter.SpecBase);exports.DefaultValueLabel=DataWrapperComponent.wrapComponent(new DefaultValueLabelSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/TruncatedDiv",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var TruncatedDivSpec=function(_super){__extends(TruncatedDivSpec,_super);function TruncatedDivSpec(){_super.apply(this,arguments);this.displayName="TruncatedDiv";this.mixins=[PureUpdate.Mixin];this.forceCheckOnNextUpdate=false;this.lastOffsetHeight=0}TruncatedDivSpec.prototype.getDefaultProps=function(){return {canChange:true}};TruncatedDivSpec.prototype.checkTruncation=function(){var node=ReactDOM.findDOMNode(this),needsTruncation=false;if(this.props.canChange&&node&&this.calculateDivContentHeight(node)>this.props.maximumHeight)needsTruncation=true;else if(!this.props.canChange){var parent=node.parentNode;if(node&&parent&&node.offsetHeight>parent.offsetHeight)needsTruncation=true}needsTruncation&&this.setState({truncated:true})};TruncatedDivSpec.prototype.calculateDivContentHeight=function(node){for(var height=node.offsetHeight,contentHeight=0,i=0;i<node.children.length;i++)contentHeight+=node.children.item(i).offsetHeight;return Math.min(height,contentHeight)};TruncatedDivSpec.prototype.getInitialState=function(){return {truncated:false}};TruncatedDivSpec.prototype.componentDidMount=function(){this.checkTruncation()};TruncatedDivSpec.prototype.componentDidUpdate=function(prevProps){var textChanged=this.props.textToCheck!==prevProps.textToCheck,maxHeightChanged=this.props.maximumHeight!==prevProps.maximumHeight,offsetHeightChanged=false;if(!this.state.truncated&&!this.props.canChange){var node=ReactDOM.findDOMNode(this);offsetHeightChanged=this.lastOffsetHeight!==node.offsetHeight;this.lastOffsetHeight=node.offsetHeight}if(this.forceCheckOnNextUpdate||textChanged||maxHeightChanged||offsetHeightChanged)if(this.state.truncated&&this.props.canChange){this.forceCheckOnNextUpdate=true;this.setState({truncated:false})}else{this.checkTruncation();this.forceCheckOnNextUpdate=false}};TruncatedDivSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet({truncated:this.state.truncated},this.props.className),"data-fieldname":this.props["data-fieldname"],onShortPress:this.props.onShortPress},this.props.children)};return TruncatedDivSpec}(TsAdapter.SpecBase);exports.TruncatedDiv=TsAdapter.createComponent(new TruncatedDivSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/ImageButton",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Components/Primitives/TruncatedDiv","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,Button,TruncatedDiv,CssClassSet){var ImageButtonSpec=function(_super){__extends(ImageButtonSpec,_super);function ImageButtonSpec(){_super.apply(this,arguments);this.displayName="ImageButton";this.mixins=[PureUpdate.Mixin]}ImageButtonSpec.prototype.render=function(){var imageClasses="button-commandRing",imageChildren=[],styles={};if(this.props.imageType==="Symbol"){imageClasses+=" symbolFont "+this.props.imageName+"-symbol";if(this.props.symbolBackgroundColor)styles["backgroundColor"]=this.props.symbolBackgroundColor}else if(this.props.imageType==="URL"){var backgroundImageUrl=CrmEncodeDecode.CrmUrlEncode(this.props.imageName),backgroundImage=React.DOM.img({key:"img",src:"resources\\images\\"+backgroundImageUrl,className:"imageBinder-image"});imageChildren.push(backgroundImage);imageClasses+=" removeBorders"}else if(this.props.imageType==="EntityImage"||this.props.imageType==="NotePreview")imageChildren.push(React.DOM.img({key:"img",src:this.props.imageName,className:"button-image"}));else if(this.props.imageType==="CrmSymbol")imageClasses+=" crmSymbolFont "+this.props.imageName+"-symbol";var image=React.DOM.span({key:"image",className:imageClasses,style:styles},imageChildren),label=React.DOM.span({key:"label",className:CssClassSet(null,"button-label",this.props.labelClassName)},this.props.label),arrow=React.DOM.div({key:"arrow",className:"button-flyoutArrow Arrow-symbol symbolFont"}),labelComponents=[];if(this.props.imageType==="EntityImage"){var iconContainer=React.DOM.span({key:"icons",className:"fieldLabelInlineIcons"}),truncatedDiv=TruncatedDiv.TruncatedDiv({key:"truncatedDiv",maximumHeight:0,textToCheck:this.props.label,canChange:false,className:"truncatedDiv"},[label,iconContainer]);labelComponents.push(truncatedDiv)}else{this.props.labelPrefixComponents&&Array.prototype.unshift.apply(labelComponents,this.props.labelPrefixComponents);labelComponents.push(label)}labelComponents.push(arrow);var labelContainer=React.DOM.div({key:"labelContainer",className:"button-labelContainer"},labelComponents),container=React.DOM.div({className:CssClassSet({"button-container":true,"content-notesImage":this.props.imageType==="NotePreview"})},[image,labelContainer]),styles=this.props.style||{};if(this.props.hidden)styles["display"]="none";return Button.Button({className:CssClassSet(null,"dynamicsButton",this.props.className),style:styles,enabled:this.props.enabled,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown,tabIndex:this.props.tabIndex,title:this.props.title,dataId:this.props.dataId,id:this.props.id,dataFlyoutOpen:this.props.dataFlyoutOpen,dataPinned:this.props.dataPinned,reactClientContext:this.props.reactClientContext,stopClickPropagation:this.props.stopClickPropagation,touchActionScroll:this.props.touchActionScroll,ariaLabel:this.props.ariaLabel,onMouseEnter:this.props.onMouseEnter?this.props.onMouseEnter:null},container)};return ImageButtonSpec}(TsAdapter.SpecBase);exports.ImageButton=TsAdapter.createComponent(new ImageButtonSpec)});define("Components/Common/Constants",["require","exports"],function(require,exports){exports.ENTER_KEY="Enter";exports.SPACE_KEY=" ";exports.RIGHT_ARROW_KEY="ArrowRight";exports.LEFT_ARROW_KEY="ArrowLeft";exports.UP_ARROW_KEY="ArrowUp";exports.DOWN_ARROW_KEY="ArrowDown";exports.ESCAPE_KEY="Escape";exports.F8_KEY="F8";exports.BACKSPACE_KEY="Backspace";exports.DELETE_KEY="Delete";exports.TAB_KEY="Tab";exports.ESCAPE_KEY_CODE=27;exports.TAB_KEY_CODE=9;exports.ENTER_KEY_CODE=13;exports.SPACE_KEY_CODE=32;exports.UP_ARROW_KEY_CODE=38;exports.DOWN_ARROW_KEY_CODE=40;exports.LEFT_ARROW_KEY_CODE=37;exports.RIGHT_ARROW_KEY_CODE=39;exports.F8_KEY_CODE=119;exports.K_KEY_CODE=75;exports.COLUMNS_TO_FIT=12});define("Components/Common/AccessibilityUtility",["require","exports","Components/Common/Constants"],function(require,exports,Constants){function getScreenReaderTypeName(typeName){var screenReaderTypeName="";switch(typeName){case "Lookup":case "PartyList":case "InteractionCentricLookup":case "InteractionCentricMultipleSourceLookup":case "InteractionCentricPartyList":case "HierarchicalSubjectControl":case "GlobalFilterLookup":screenReaderTypeName="Lookup";break;case "Picklist":case "ComboBox":screenReaderTypeName="Option Set";break;case "String":screenReaderTypeName="Single Line of Text";break;case "MultilineString":screenReaderTypeName="Multiple Lines of Text";break;case "DateControl":screenReaderTypeName="Date and Time";break;case "DurationControl":case "Integer":screenReaderTypeName="Whole Number";break;case "InteractionCentricPartyListLookup":screenReaderTypeName="Party List";break;case "ToggleControl":screenReaderTypeName="Two Options";break;case "Money":screenReaderTypeName="Currency";break;case "ReferencePanelSubgrid":case "SubGrid":screenReaderTypeName="Sub Grid";break;case "ReferencePanelQuickForm":case "QuickForm":screenReaderTypeName="Quick view form";break}return screenReaderTypeName}exports.getScreenReaderTypeName=getScreenReaderTypeName;function handleArrowNavigationForTable(focusTarget,e){var targetItem=$(focusTarget),targetParent,targetToFocus;if(e.keyCode==Constants.RIGHT_ARROW_KEY_CODE||e.keyCode==Constants.F8_KEY_CODE){targetParent=targetItem.closest("td");targetToFocus=targetParent.next("td").find("[tabindex]:first")}else if(e.keyCode==Constants.LEFT_ARROW_KEY_CODE){targetParent=targetItem.closest("td");targetToFocus=targetParent.prev("td").find("[tabindex]:first")}else if(e.keyCode==Constants.DOWN_ARROW_KEY_CODE){targetParent=targetItem.closest("tr");targetToFocus=targetParent.next().find("[tabindex]:first")}else if(e.keyCode==Constants.UP_ARROW_KEY_CODE){targetParent=targetItem.closest("tr");targetToFocus=targetParent.prev().find("[tabindex]:first")}targetToFocus!=null&&targetToFocus.focus()}exports.handleArrowNavigationForTable=handleArrowNavigationForTable;exports.key="";var isShiftKey=false,classList=["CrmDialog-popupContent","icQuickCreateForm-popupContent","columnOverflow"];function storeTabOperation(e){exports.key=e.key;isShiftKey=e.shiftKey}exports.storeTabOperation=storeTabOperation;function shouldDoSpecialHandling(currentElement){if(isShiftKey){var currentNode=$(currentElement),classNameSelector=getParentClassNameSelector(currentNode),sectionItemList=currentNode.parents(classNameSelector).find(".section_control"),index=sectionItemList.index(currentElement);return index==0}return false}exports.shouldDoSpecialHandling=shouldDoSpecialHandling;function getParentClassNameSelector(currentNode){for(var className="",classIndex=0;classIndex<classList.length;classIndex++){var selector="."+classList[classIndex];if($(selector).has(currentNode).length>0){className=selector;break}}return className}function handleSpecialTabbingForEditableSecionControl(currentElement){var currentNode=$(currentElement),classNameSelector=getParentClassNameSelector(currentNode),itemList=currentNode.parents(classNameSelector).find("[tabindex]:not([tabindex^=-])"),index=itemList.index(currentElement);if(index>-1){var indexOfItemToFocus=isShiftKey?index-1:index+1;if(indexOfItemToFocus>-1){var itemToFocus=itemList[indexOfItemToFocus];exports.key="";isShiftKey=false;itemToFocus!=null&&$(itemToFocus).focus()}}}exports.handleSpecialTabbingForEditableSecionControl=handleSpecialTabbingForEditableSecionControl;function handleShiftTabFocus(currentElement,e){var targetElement=!e.shiftKey?currentElement.nextSibling:currentElement.previousSibling;if(!targetElement&&$(".ui-jqgrid-view").length>0){var selectedRows=$(".ui-state-highlight").not("a");if(selectedRows.length>0){$(selectedRows[selectedRows.length-1]).focus();e.preventDefault()}}}exports.handleShiftTabFocus=handleShiftTabFocus;function doesNextElementExist(currentElement,e){var targetElement=!e.shiftKey?currentElement.nextSibling:currentElement.previousSibling;if(targetElement==null||targetElement==undefined)return false;return true}exports.doesNextElementExist=doesNextElementExist;function focusPopupSourceElement(parentElement){var childCount=$(parentElement).children()?$(parentElement).children().length:0,elementToFocus=childCount>1?$(parentElement).children()[childCount-2]:null;elementToFocus&&$(elementToFocus).focus()}exports.focusPopupSourceElement=focusPopupSourceElement;function handleShiftTabAndFocusParentSectionControl(currentElement,e){if(e.shiftKey&&e.key==Constants.TAB_KEY){var sectionControl=$(currentElement).closest(".section_control");if(sectionControl[0]!=null){e.preventDefault();e.stopPropagation();storeTabOperation(e);sectionControl.focus()}}}exports.handleShiftTabAndFocusParentSectionControl=handleShiftTabAndFocusParentSectionControl;function handleMouseDownAndHideOutLine(e){var currentElement=e.currentTarget;currentElement!=null&&($(currentElement).hasClass("columnOverflow")||$(currentElement).hasClass("mscrm-gridContainer"))&&$(currentElement).addClass("removeOutLine")}exports.handleMouseDownAndHideOutLine=handleMouseDownAndHideOutLine;function handleKeyDownAndShowOutLine(e){var currentElement=e.currentTarget;currentElement!=null&&($(currentElement).hasClass("columnOverflow")||$(currentElement).hasClass("mscrm-gridContainer"))&&$(currentElement).removeClass("removeOutLine")}exports.handleKeyDownAndShowOutLine=handleKeyDownAndShowOutLine;function handleOnMouseEnter(e){var currentElement=e.currentTarget;currentElement!=null&&$(currentElement).focus()}exports.handleOnMouseEnter=handleOnMouseEnter});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/DynamicsButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/Primitives/ImageButton","Utils/CssClassSet","Components/Common/Constants","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,ImageButton,CssClassSet,Constants,AccessibilityUtility){exports.DESCRIPTOR_NAME="DynamicsButton";exports.DESCRIPTOR_NAME2="Button";exports.DESCRIPTOR_NAME3="CommandButton";var DynamicsButtonSpec=function(_super){__extends(DynamicsButtonSpec,_super);function DynamicsButtonSpec(){_super.apply(this,arguments);this.displayName="DynamicsButton";this.mixins=[IXUD.Mixin];this.listenToProperties=["ImageType","ImageName","Visible","Enabled","Label","ActionCommand","ActionCommandCanExecute"]}DynamicsButtonSpec.prototype.getDefaultProps=function(){return {showWhenDisabled:false,isInteractionCentricFormFooterButton:false}};DynamicsButtonSpec.prototype.getProperties=function(){var properties={};if(this.props!=undefined&&this.props.descriptor!=undefined&&this.props.descriptor.TypeName==="CommandButton"){properties["type"]=XrmUI.UIControlType.commandButton;properties["id"]=this.props.dataContext.get_Id()}else if(this.props.dataContext.get_IsSitemapButton()){properties["type"]=XrmUI.UIControlType.navigationButton;properties["parentId"]=XrmUI.ControlId.navDetailFlyout;if(this.props.descriptor&&this.props.descriptor.Properties&&"NodeId" in this.props.descriptor.Properties)properties["id"]=this.props.descriptor.Properties["NodeId"];else properties["id"]=this.props.parentGivenKey}else{properties["type"]=XrmUI.UIControlType.flyOutButton;properties["id"]=this.props.parentGivenKey}return properties};DynamicsButtonSpec.prototype.isSiteMapButtonWithPrimaryModelName=function(){return this.props.dataContext.get_IsSitemapButton()&&!!this.props.dataContext.get_PrimaryModelName()};DynamicsButtonSpec.prototype.allowScroll=function(){return this.isSiteMapButtonWithPrimaryModelName()||this.props.dataContext.get_IsGlobalMenuButton()||this.props.isAppBarFlyOut||this.props.isQuickCommandsBarFlyOut};DynamicsButtonSpec.prototype.handleKeyDown=function(e){var currentElement=e.currentTarget,targetElement;switch(e.keyCode){case Constants.UP_ARROW_KEY_CODE:case Constants.DOWN_ARROW_KEY_CODE:case Constants.TAB_KEY_CODE:case Constants.LEFT_ARROW_KEY_CODE:targetElement=currentElement.previousSibling;targetElement==null&&e.preventDefault();break}};DynamicsButtonSpec.prototype.handleClick=function(){this.props.isInteractionCentricFormFooterButton&&this.props.dataContext.get_ActionCommand().set_CanExecute(true);this.props.dataContext.get_ActionCommand()!=null&&this.props.dataContext.get_ActionCommand().execute();var isPinToStartButton=this.props.dataContext.get_Id()==="Win8PinButton";if(isPinToStartButton){var buttonComponent=this.refs["button"],button=$(ReactDOM.findDOMNode(buttonComponent)),offset=button.offset(),width=button.outerWidth(true),height=button.outerHeight(true),vm=this.props.dataContext;vm.set_Width(width.toString(10));vm.set_Height(height.toString(10));vm.set_PageX(offset.left);vm.set_PageY(offset.top)}this.props.afterClick&&this.props.afterClick();!isPinToStartButton&&!this.props.dataContext.get_IsInteractionCentricEnabled()&&this.props.clientContext.applicationShellViewModel.get_CommandManagerViewModel().collapse()};DynamicsButtonSpec.prototype.calculateTestabilityId=function(){var id=null,vm=this.props.dataContext;if(vm){if(this.props.descriptor)id=this.props.descriptor.BindingPath;var command=vm.get_Command(),label=vm.get_Label();if(command)if(command==="ProcessStageGateCommand"){var params=vm.get_Parameters();if(params&&params["EntityId"])id=params["EntityId"];else if(label==="Create")id="CreateNew"}else if(label&&command==="ChangeProcessControlCommand")id=label;if(this.isSiteMapButtonWithPrimaryModelName())id="sitemap-button-"+vm.get_PrimaryModelName()}return id};DynamicsButtonSpec.prototype.getEntityColor=function(){var vm=this.props.dataContext,cm=this.props.clientContext;if(vm&&cm&&cm.theming.IsEnabled&&this.props.dataContext.get_IsSitemapButton())return cm.theming.getEntityColor(vm.get_PrimaryModelName());return null};DynamicsButtonSpec.prototype.calculateDataPinnedValue=function(){var dataPinnedValue=null,vm=this.props.dataContext;if(vm){var cmd=vm.get_Command();if(cmd&&cmd==="PinCommand"){var dic=vm.get_TestabilityAttributes();if(dic&&dic["data-pinned"])dataPinnedValue=dic["data-pinned"].toString()}}return dataPinnedValue};DynamicsButtonSpec.prototype.handleFlyOutKeyDown=function(e){this.props.onKeyDown&&this.props.onKeyDown(e);switch(e.key){case Constants.ENTER_KEY:this.handleClick();break;case Constants.SPACE_KEY:this.handleClick();break;case Constants.TAB_KEY:var currentElement=e.currentTarget;AccessibilityUtility.handleShiftTabFocus(currentElement,e);currentElement!=null&&currentElement.id!=null&&currentElement.id==="icFormFooterSaveIcon"&&$("#headerBar")[0]!=null&&$("#headerBar").focus();break}};DynamicsButtonSpec.prototype.getICButtonTitle=function(){if(typeof this.props.title==="undefined"||this.props.title===null||this.props.title==="")return this.props.dataContext.get_Title()!==null?this.props.dataContext.get_Title():this.props.dataContext.get_Label();else return this.props.title};DynamicsButtonSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var descriptorClassName="";if(this.props.descriptor&&this.props.descriptor.Properties&&"CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];var canExecute=this.props.dataContext&&this.props.dataContext.get_ActionCommand()&&this.props.dataContext.get_ActionCommandCanExecute(),enabled=this.props.dataContext.get_Enabled(),propsObject={className:CssClassSet({disabled:!enabled},descriptorClassName,this.props.className),ref:"button",imageType:this.props.dataContext.get_ImageType(),imageName:this.props.dataContext.get_ImageName(),labelPrefixComponents:this.props.prefixComponents,label:this.props.dataContext.get_Label(),title:this.props.dataContext.get_IsInteractionCentricEnabled()?this.getICButtonTitle():"",enabled:this.props.dataContext.get_Enabled(),hidden:!this.props.showWhenDisabled&&(!this.props.dataContext.get_Visible()||!enabled||!canExecute),dataPinned:this.calculateDataPinnedValue(),onClick:this.props.dataContext.get_Enabled()?this.handleClick:null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()&&this.props.dataContext.get_Enabled()?this.handleFlyOutKeyDown:null,reactClientContext:this.props.clientContext,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex&&this.props.tabIndex>-1?this.props.tabIndex:this.props.dataContext.get_Parameters()["tabindex"]:null,symbolBackgroundColor:this.getEntityColor(),id:this.props.id,onMouseEnter:this.props.dataContext.get_IsInteractionCentricEnabled()&&enabled&&this.props.onMouseEnter?this.props.onMouseEnter:null,ariaLabel:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_Label():null};if(this.props.dataContext.get_IsSitemapButton())propsObject.id=this.calculateTestabilityId();else propsObject.dataId=this.calculateTestabilityId();propsObject.touchActionScroll=this.allowScroll();return ImageButton.ImageButton(propsObject)};return DynamicsButtonSpec}(TsAdapter.SpecBase);exports.DynamicsButton=DataWrapperComponent.wrapComponent(new DynamicsButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/HyperlinkButton",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Components/Common/DefaultValueLabel","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,Button,DefaultValueLabel,CssClassSet){var HyperlinkButtonSpec=function(_super){__extends(HyperlinkButtonSpec,_super);function HyperlinkButtonSpec(){_super.apply(this,arguments);this.displayName="HyperlinkButton";this.mixins=[PureUpdate.Mixin]}HyperlinkButtonSpec.prototype.render=function(){var label=React.DOM.span({key:"label",className:CssClassSet({label:true,"button-label":true,enabled:this.props.enabled,"empty-mask":this.props.label==DefaultValueLabel.DEFAULT_VALUE_MASK})},this.props.label),buttonContainer=React.DOM.div({className:"button-container"},label);return Button.Button({role:"button",tabIndex:this.props.tabIndex,className:CssClassSet(null,"dynamicsButton fieldButton",this.props.className),onClick:this.props.onClick,dataId:this.props.dataId,enabled:this.props.enabled,title:this.props.title,stopShortPressPropagation:this.props.stopShortPressPropagation,noDisabledAttribute:this.props.noDisabledAttribute},buttonContainer)};return HyperlinkButtonSpec}(TsAdapter.SpecBase);exports.HyperlinkButton=TsAdapter.createComponent(new HyperlinkButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/FieldButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/HyperlinkButton"],function(require,exports,TsAdapter,DataWrapperComponent,HyperlinkButton){exports.DESCRIPTOR_NAME="FieldButton";exports.RENDERED_PROPERTY_NAME="Text";var FieldButtonSpec=function(_super){__extends(FieldButtonSpec,_super);function FieldButtonSpec(){_super.apply(this,arguments);this.displayName="FieldButton";this.listenToProperties=[exports.RENDERED_PROPERTY_NAME,"CanNavigate"]}FieldButtonSpec.prototype.handleShortPress=function(e){if(this.props.dataContext.get_CanNavigate()){this.props.dataContext.get_ActionCommand().execute();e.stopPropagation()}};FieldButtonSpec.prototype.render=function(){var text="---";if(this.props.dataContext)if(this.props.dataContext.get_UseHiddenMask())text="*******";else{var modelValue=this.props.dataContext.get_Text();if(modelValue)text=modelValue}return HyperlinkButton.HyperlinkButton({label:text,enabled:this.props.dataContext&&this.props.dataContext.get_CanNavigate(),onClick:this.handleShortPress,stopShortPressPropagation:false,noDisabledAttribute:this.props.clientContext.userAgent.get_IsBrowserFirefox()})};return FieldButtonSpec}(TsAdapter.SpecBase);exports.FieldButton=DataWrapperComponent.wrapComponent(new FieldButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/MountedHost",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var MountedHostSpec=function(_super){__extends(MountedHostSpec,_super);function MountedHostSpec(){_super.apply(this,arguments);this.displayName="MountedHost";this.mixins=[PureUpdate.Mixin]}MountedHostSpec.prototype.createHostElement=function(){var ancestor=this.props.findNode(ReactDOM.findDOMNode(this));if(ancestor){this.hostElement=document.createElement("div");this.hostElement.setAttribute("data-id",this.props.dataId);this.hostElement.setAttribute("class",this.props.className);ancestor.appendChild(this.hostElement)}};MountedHostSpec.prototype.destroyHostElement=function(){if(!this.hostElement.parentNode)return;this.hostElement.parentNode.removeChild(this.hostElement)};MountedHostSpec.prototype.componentDidMount=function(){this.createHostElement();if(!this.hostElement)return;ReactDOM.render(React.Children.only(this.props.children),this.hostElement)};MountedHostSpec.prototype.componentDidUpdate=function(){if(!this.hostElement)return;ReactDOM.render(React.Children.only(this.props.children),this.hostElement)};MountedHostSpec.prototype.componentWillUnmount=function(){var _this=this;if(!this.hostElement)return;var userAgent=Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance();if(userAgent.get_IsInteractionCentricDashboard()){this.hostElement.style.display="none";window.setTimeout(function(){_this.unmount()},1e3)}else this.unmount()};MountedHostSpec.prototype.unmount=function(){ReactDOM.unmountComponentAtNode(this.hostElement);this.destroyHostElement();this.hostElement=null};MountedHostSpec.prototype.render=function(){return React.DOM.noscript()};return MountedHostSpec}(TsAdapter.SpecBase);exports.MountedHost=TsAdapter.createComponent(new MountedHostSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/ElementMountedHost",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/MountedHost"],function(require,exports,TsAdapter,PureUpdate,MountedHost){function findParentNode(parentId){var parent=$("#"+parentId);if(parent.length==1)return parent[0];console.warn("Unable to find ancestor with selector '"+parentId+"'");return null}var ElementMountedHostSpec=function(_super){__extends(ElementMountedHostSpec,_super);function ElementMountedHostSpec(){_super.apply(this,arguments);this.displayName="ElementMountedHost";this.mixins=[PureUpdate.Mixin]}ElementMountedHostSpec.prototype.render=function(){var _this=this;return MountedHost.MountedHost({findNode:function(){return findParentNode(_this.props.parentId)},dataId:this.props.dataId},this.props.children)};return ElementMountedHostSpec}(TsAdapter.SpecBase);exports.ElementMountedHost=TsAdapter.createComponent(new ElementMountedHostSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/AncestorMountedHost",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/MountedHost"],function(require,exports,TsAdapter,PureUpdate,MountedHost){function findAncestorNode(selectorString,domNode){var closestAncestor=$(domNode).closest(selectorString);if(closestAncestor.length==1)return closestAncestor[0];console.warn("Unable to find ancestor with selector '"+selectorString+"'");return null}var AncestorMountedHostSpec=function(_super){__extends(AncestorMountedHostSpec,_super);function AncestorMountedHostSpec(){_super.apply(this,arguments);this.displayName="AncestorMountedHost";this.mixins=[PureUpdate.Mixin]}AncestorMountedHostSpec.prototype.render=function(){var _this=this;return MountedHost.MountedHost({findNode:function(domNode){return findAncestorNode(_this.props.selectorString,domNode)},dataId:this.props.dataId,className:this.props.className},this.props.children)};return AncestorMountedHostSpec}(TsAdapter.SpecBase);exports.AncestorMountedHost=TsAdapter.createComponent(new AncestorMountedHostSpec)});define("Utils/ZIndexFinder",["require","exports"],function(require,exports){function zIndexFinder(){for(var max=1e4,siblings=Array.prototype.slice.call(document.getElementsByTagName("*")),i=0;i<siblings.length;i++)if(!isNaN(siblings[i].style.zIndex)&&isFinite(siblings[i].style.zIndex))max=Math.max(max,siblings[i].style.zIndex);return max}return zIndexFinder});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/DialogConductorItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Popup","Utils/CssClassSet","Utils/Animator","Utils/ZIndexFinder"],function(require,exports,TsAdapter,PureUpdate,Popup,CssClassSet,Animator,ZIndexFinder){var DialogConductorItemSpec=function(_super){__extends(DialogConductorItemSpec,_super);function DialogConductorItemSpec(){_super.apply(this,arguments);this.displayName="DialogConductorItem";this.mixins=[PureUpdate.Mixin]}DialogConductorItemSpec.prototype.componentDidMount=function(){if(this.props.options.mountInConductor){var item=this.refs["item"];if(item){var animation="dialogSlideInRight";if(this.props.options.slideTop)animation="dialogSlideInTop";else if(this.props.clientContext.isPhone)animation="dialogSlideInBottom";var node=ReactDOM.findDOMNode(item);Animator.animate(node,animation)}}};DialogConductorItemSpec.prototype.handlePopupDismiss=function(){this.props.handleDialogDismiss(this.props.dataContext.get_ViewModelId())};DialogConductorItemSpec.prototype.renderItem=function(){return this.props.itemFactory({ref:"item",clientContext:this.props.clientContext,dataContext:this.props.dataContext,onDismiss:this.handlePopupDismiss})};DialogConductorItemSpec.prototype.render=function(){var item=this.renderItem(),className=item.props.className;if(this.props.options.mountInConductor){var style={zIndex:ZIndexFinder()+1};if(this.props.clientContext.isPhone&&Object.getType(this.props.dataContext).getName()==="Microsoft.Crm.Client.Core.ViewModels.GlobalLookupViewModel")style["display"]="none";var conductor=React.DOM.div({"data-id":"dialogContentContainer",id:this.props.isActive?"activeDialog":null,className:CssClassSet(null,className,"dialogConductorContent","PopupContainer"),style:style},Popup.Popup({key:"popup",visible:true,onDismiss:this.handlePopupDismiss,keepOpenOnPopupTap:true,style:{width:"100%",height:"100%"}},item));return conductor}else return item};return DialogConductorItemSpec}(TsAdapter.SpecBase);exports.DialogConductorItem=TsAdapter.createComponent(new DialogConductorItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/DialogConductor",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Shell/DialogConductorItem","Utils/CssClassSet","Utils/ZIndexFinder"],function(require,exports,TsAdapter,DataWrapperComponent,DialogConductorItem,CssClassSet,ZIndexFinder){exports.NO_SCROLL_ON_MODAL_CLASSNAME="modalDialogBackgroundScrollBlock";function disableIOSConductorContentScroll(){var userAgent=Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance();userAgent.get_IsIOS()&&document.body.classList.add(exports.NO_SCROLL_ON_MODAL_CLASSNAME)}exports.disableIOSConductorContentScroll=disableIOSConductorContentScroll;function enableIOSConductorContentScroll(){var userAgent=Microsoft.Crm.Client.Core.Framework.UserAgent.getInstance();userAgent.get_IsIOS()&&document.body.classList.remove(exports.NO_SCROLL_ON_MODAL_CLASSNAME)}exports.enableIOSConductorContentScroll=enableIOSConductorContentScroll;var defaultDialogOptions={dismissOnBlur:false,mountInConductor:true,useBackdrop:false,slideTop:false},viewModelToComponentMap={},viewModelToOptionsMap={};function registerComponentForViewModel(viewModelName,factory,options){viewModelToComponentMap[viewModelName]=factory;viewModelToOptionsMap[viewModelName]=options}exports.registerComponentForViewModel=registerComponentForViewModel;var DialogConductorSpec=function(_super){__extends(DialogConductorSpec,_super);function DialogConductorSpec(){_super.apply(this,arguments);this.displayName="DialogConductor";this.listenToProperties=["ActiveNavigationStack","Top"];this.listenToCollections=["ActiveNavigationStack"];this.topDialogOptions={};this.showBackdrop=false;this.isAnyDialogRenderedInConductor=false}DialogConductorSpec.prototype.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown)};DialogConductorSpec.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)};DialogConductorSpec.prototype.findComponentForType=function(type){if(!type)return null;var viewModelName=type.getName();if(viewModelToComponentMap[viewModelName]!=null)return viewModelName;return this.findComponentForType(type.getBaseType())};DialogConductorSpec.prototype.renderDialog=function(viewModel,isActive){var viewModelName=this.findComponentForType(Object.getType(viewModel)),itemFactory=viewModelToComponentMap[viewModelName],options=viewModelToOptionsMap[viewModelName];if(options!=null){if(options.dismissOnBlur==null)options.dismissOnBlur=defaultDialogOptions.dismissOnBlur;if(options.mountInConductor==null)options.mountInConductor=defaultDialogOptions.mountInConductor;if(options.useBackdrop==null)options.useBackdrop=defaultDialogOptions.useBackdrop;if(options.slideTop==null)options.slideTop=defaultDialogOptions.slideTop}else options=defaultDialogOptions;if(!this.props.clientContext.isPhone&&options.useBackdrop)this.showBackdrop=true;if(options.mountInConductor)this.isAnyDialogRenderedInConductor=true;this.topDialogOptions=options;this.topDialogViewModelId=viewModel.get_ViewModelId();return DialogConductorItem.DialogConductorItem({key:this.topDialogViewModelId,dataContext:viewModel,clientContext:this.props.clientContext,options:options,handleDialogDismiss:this.handleDialogDismiss,itemFactory:itemFactory,isActive:isActive})};DialogConductorSpec.prototype.handleDialogDismiss=function(viewModelId){this.topDialogOptions.dismissOnBlur&&this.props.dataContext.removeViewModelById(viewModelId)};DialogConductorSpec.prototype.handleKeyDown=function(e){if(this.topDialogOptions.dismissOnBlur&&this.props.dataContext.get_ActiveNavigationStack().get_Count()>0)if(e.keyCode===27)this.props.dataContext.popMany(1);else if(e.keyCode===9){e.stopPropagation();e.preventDefault()}};DialogConductorSpec.prototype.componentDidUpdate=function(){if(this.showBackdrop||this.isAnyDialogRenderedInConductor)disableIOSConductorContentScroll();else enableIOSConductorContentScroll()};DialogConductorSpec.prototype.render=function(){var activeStack=this.props.dataContext.get_ActiveNavigationStack();this.showBackdrop=false;this.isAnyDialogRenderedInConductor=false;for(var children=[],childrenCount=activeStack.get_Count(),i=0;i<childrenCount;i++)children.push(this.renderDialog(activeStack.getItem(i),i===childrenCount-1));return React.DOM.div({className:CssClassSet({dialogBackdrop:this.showBackdrop},"dialogConductor"),style:{zIndex:ZIndexFinder()+1}},children)};return DialogConductorSpec}(TsAdapter.SpecBase);exports.DialogConductor=DataWrapperComponent.wrapComponent(new DialogConductorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/FlyOutButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/ComponentFactory","Components/Primitives/ImageButton","Components/Primitives/Popup","Components/Primitives/ElementMountedHost","Components/Primitives/AncestorMountedHost","Components/Primitives/ProgressIndicator","Components/Shell/DialogConductor","Utils/CssClassSet","Components/Common/Constants","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,ComponentFactory,ImageButton,Popup,ElementMountedHost,AncestorMountedHost,ProgressIndicator,DialogConductor,CssClassSet,Constants,AccessibilityUtility){(function(FlyOutPositioning){FlyOutPositioning[FlyOutPositioning["Vertical"]=0]="Vertical";FlyOutPositioning[FlyOutPositioning["Horizontal"]=1]="Horizontal";FlyOutPositioning[FlyOutPositioning["External"]=2]="External"})(exports.FlyOutPositioning||(exports.FlyOutPositioning={}));var FlyOutPositioning=exports.FlyOutPositioning;exports.DESCRIPTOR_NAME="MenuButton";var FlyOutButtonSpec=function(_super){__extends(FlyOutButtonSpec,_super);function FlyOutButtonSpec(){_super.apply(this,arguments);this.displayName="FlyOutButton";this.mixins=[IXUD.Mixin];this.listenToProperties=["Visible","Enabled","FlyOutExpanded"];this.isFirstFocus=true;this.shouldFocusPopupSourceElement=false}FlyOutButtonSpec.prototype.getDefaultProps=function(){return {isICCommandBarFlyOut:false}};FlyOutButtonSpec.prototype.getInitialState=function(){return {popupAppearance:null}};FlyOutButtonSpec.prototype.getProperties=function(){var properties={};if(this.props.dataId==="MscrmOverflow"){properties["id"]=XrmUI.ControlId.moreCommands;properties["parentId"]=XrmUI.UIControlType.commandBarContainer}else if(this.props.dataContext.get_PrimaryModelName()=="activitypointer")properties["id"]="flyoutTopMenuButton_"+this.props.dataContext.get_PrimaryModelName();return properties};FlyOutButtonSpec.prototype.showFlyOut=function(){this.props.dataContext.set_FlyOutExpanded(true);this.props.isQuickCommandsBarFlyOut&&this.props.clientContext.userAgent.get_IsIPad()&&DialogConductor.enableIOSConductorContentScroll()};FlyOutButtonSpec.prototype.hideFlyOut=function(){this.props.dataContext.set_FlyOutExpanded(false);this.props.isQuickCommandsBarFlyOut&&this.props.clientContext.userAgent.get_IsIPad()&&DialogConductor.disableIOSConductorContentScroll()};FlyOutButtonSpec.prototype.handleButtonClick=function(){if(this.props.dataContext.get_FlyOutExpanded())this.hideFlyOut();else this.showFlyOut()};FlyOutButtonSpec.prototype.handleFlyOutButtonClick=function(){this.hideFlyOut()};FlyOutButtonSpec.prototype.handleICFlyOutButtonClick=function(){this.hideFlyOut();var parentFlyout=$(ReactDOM.findDOMNode(this));parentFlyout[0]!=null&&parentFlyout.focus()};FlyOutButtonSpec.prototype.handleFlyOutDismiss=function(target){if(this.isMounted()){var match=target.closest(".flyoutButton-flyOut");(!match||match.length==0)&&this.hideFlyOut()}};FlyOutButtonSpec.prototype.hasEnabledDescendant=function(){if(this.props.childViewModels){for(var childCount=this.props.childViewModels.length,i=0;i<childCount;i++){var child=this.props.childViewModels[i],childAsContainer=child;if(childAsContainer.get_ChildViewModels&&childAsContainer.hasEnabledDescendant())return true;if(child.get_Enabled())return true}return false}else return this.props.dataContext.hasEnabledDescendant()};FlyOutButtonSpec.prototype.isHidden=function(){var showFlyout=this.hasEnabledDescendant()||this.props.loadingComponent;return !this.props.dataContext.get_Visible()||!this.props.dataContext.get_Enabled()||!showFlyout};FlyOutButtonSpec.prototype.componentDidMount=function(){this.props.isQuickCommandsBarFlyOut&&this.props.clientContext.userAgent.get_IsIPad()&&ReactDOM.findDOMNode(this).setAttribute("touch-action","pan-x pan-y")};FlyOutButtonSpec.prototype.componentDidUpdate=function(prevProps){var positioning=this.props.flyOutPositioning,flyOutExpanded=this.props.dataContext.get_FlyOutExpanded();!flyOutExpanded&&this.state.popupAppearance&&this.setState({popupAppearance:null});if(flyOutExpanded&&!this.state.popupAppearance&&positioning!==FlyOutPositioning.External){var container=$(ReactDOM.findDOMNode(this)),buttonComponent=this.refs["button"],flyoutComponent=this.refs["flyout"],button=$(ReactDOM.findDOMNode(buttonComponent)),flyout=$(ReactDOM.findDOMNode(flyoutComponent)),containerOffset=container.offset(),containerWidth=container.outerWidth(),buttonOffset=button.offset(),buttonHeight=button.outerHeight(),flyoutWidth=flyout.outerWidth(),flyoutHeight=flyout.outerHeight(),windowWidth=window.innerWidth,windowHeight=window.innerHeight,flyoutMenuItemHeight=25,navBarHeight=42,appBarIndent=1,left,top,height;if(positioning===FlyOutPositioning.Horizontal){left=containerOffset.left+containerWidth;top=buttonOffset.top-flyoutHeight+buttonHeight;var right=left+flyoutWidth,direction=windowWidth-left>flyoutWidth*1.5?1:0;if(direction===1)if(right>windowWidth)left-=right-windowWidth+10;else left+=1;else{left=containerOffset.left-flyoutWidth;if(left<0)left=10;else left-=1}if(top<20){top=20;height=buttonOffset.top+flyoutMenuItemHeight}this.setState({popupAppearance:{top:top,left:left,height:height}})}else{if(buttonOffset.left>0)if(buttonOffset.left+flyoutWidth>windowWidth)left=windowWidth-flyoutWidth;else left=buttonOffset.left;else left=Math.abs(buttonOffset.left);if(this.props.clientContext.isMailApp||this.props.clientContext.isInteractionCentric){var maxHeight=windowHeight-53-buttonHeight;height=Math.min(maxHeight,flyoutHeight);top=buttonOffset.top-flyoutHeight-1;if(top<20){top=20;height=buttonOffset.top-20}}else{var maxHeightUX=windowHeight-navBarHeight-buttonHeight;height=Math.min(maxHeightUX,flyoutHeight);top=buttonOffset.top-flyoutHeight-appBarIndent;if(top<navBarHeight){top=navBarHeight;height=buttonOffset.top-navBarHeight-appBarIndent}}this.setState({popupAppearance:{height:height,top:top,left:left}})}}if(this.shouldFocusPopupSourceElement){this.shouldFocusPopupSourceElement=false;AccessibilityUtility.focusPopupSourceElement(ReactDOM.findDOMNode(this))}};FlyOutButtonSpec.prototype.getTitle=function(){var label=this.props.label;if(this.props.dataContext)label=label||this.props.dataContext.get_Label();var isTitleEmpty=typeof this.props.title==="undefined"||this.props.title===null||this.props.title==="",title=typeof this.props.title==="undefined"||this.props.title===null||this.props.title===""?this.props.isICCommandBarFlyOut?label:"":this.props.title;if(isTitleEmpty){if(this.props.isICCommandBarFlyOut)title=label;if(this.props.clientContext.isMailApp)title=this.props.dataContext.get_Title()}return title};FlyOutButtonSpec.prototype.renderButton=function(){var imageType=this.props.imageType,imageName=this.props.imageName,label=this.props.label,dataId=this.props.dataId;if(this.props.dataContext){imageType=imageType||this.props.dataContext.get_ImageType();imageName=imageName||this.props.dataContext.get_ImageName();label=label||this.props.dataContext.get_Label()}if(this.props.descriptor)dataId=dataId||this.props.descriptor.BindingPath;return ImageButton.ImageButton({key:"button",ref:"button",className:CssClassSet(null,"flyoutButton-Button",this.props.buttonClassName),enabled:this.props.dataContext.get_Enabled(),imageType:imageType,imageName:imageName,label:label,title:this.getTitle(),dataId:dataId,dataFlyoutOpen:this.props.dataContext.get_FlyOutExpanded(),onClick:this.handleButtonClick,reactClientContext:this.props.clientContext,stopClickPropagation:this.props.stopClickPropagation,onMouseEnter:this.handleOnMouseEnter})};FlyOutButtonSpec.prototype.handleFlyOutButtonKeyDownIC=function(e){var currentElement=e.currentTarget,targetElement;switch(e.key){case Constants.ENTER_KEY:this.showFlyOut();break;case Constants.ESCAPE_KEY:this.hideFlyOut();var referenceButton=this.refs["button"],domNode=ReactDOM.findDOMNode(referenceButton);domNode&&$(domNode).focus();break;case Constants.SPACE_KEY:this.showFlyOut();break;case Constants.TAB_KEY:if(!AccessibilityUtility.doesNextElementExist(e.target,e)){this.hideFlyOut();this.shouldFocusPopupSourceElement=true}AccessibilityUtility.handleShiftTabFocus(currentElement,e);break;case Constants.UP_ARROW_KEY:case Constants.DOWN_ARROW_KEY:targetElement=e.key===Constants.DOWN_ARROW_KEY?currentElement.nextSibling:currentElement.previousSibling;if(targetElement!=null)if($(targetElement).is(":visible"))$(targetElement).focus();else{e.currentTarget=targetElement;this.handleFlyOutButtonKeyDownIC(e)}e.preventDefault();e.stopPropagation();break}};FlyOutButtonSpec.prototype.handleKeyDownIC=function(e){var currentElement=e.currentTarget,targetElement;switch(e.key){case Constants.ENTER_KEY:this.hideFlyOut();break;case Constants.UP_ARROW_KEY:case Constants.DOWN_ARROW_KEY:targetElement=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?currentElement.nextSibling:currentElement.previousSibling;if(targetElement!=null)if($(targetElement).is(":visible"))$(targetElement).focus();else{e.currentTarget=targetElement;this.handleKeyDownIC(e)}e.preventDefault();break;case Constants.ESCAPE_KEY:case Constants.TAB_KEY:if(e.key===Constants.TAB_KEY&&AccessibilityUtility.doesNextElementExist(e.target,e))break;this.hideFlyOut();var referenceButton=this.refs["button"],domNode=ReactDOM.findDOMNode(referenceButton),parent=domNode?domNode.parentNode:null;parent&&$(parent).focus();e.preventDefault();break}e.stopPropagation()};FlyOutButtonSpec.prototype.handleOnFocusIC=function(e){if(this.isFirstFocus){this.isFirstFocus=false;var flyoutElement,currentElement=e.currentTarget;flyoutElement=$(currentElement).find(".flyoutButton-flyOut");for(var flyoutChildrenCount=flyoutElement?flyoutElement.children().length:0,modifiedCount=flyoutChildrenCount,index=1,i=0;i<flyoutChildrenCount;i++){var visible=$(flyoutElement.children()[i]).css("display");if(visible!=undefined&&visible==="none")modifiedCount--}for(var i=0;i<flyoutChildrenCount;i++){var visible=$(flyoutElement.children()[i]).css("display"),label=$(flyoutElement.children()[i]).find(".button-label").text();if(visible!=undefined&&visible==="none")continue;$(flyoutElement.children()[i]).attr("aria-label",this.props.dataContext.screenReaderTextForFlyoutItem(index,modifiedCount,label));index++}}};FlyOutButtonSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled())return this.props.tabIndex>0?this.props.tabIndex:this.props.commandBarTabIndex;else return null};FlyOutButtonSpec.prototype.childDecorator=function(factory,childProps){if(this.props.childViewModels){var viewModel=childProps["dataContext"];if(this.props.childViewModels.indexOf(viewModel)===-1)return null}childProps["className"]=CssClassSet(null,childProps["className"],"flyout-menuItem");childProps["onClick"]=this.handleFlyOutButtonClick;childProps["afterClick"]=this.handleFlyOutButtonClick;childProps["flyOutPositioning"]=FlyOutPositioning.Horizontal;childProps["mountToElementWithId"]=this.props.mountToElementWithId;childProps["isAppBarFlyOut"]=this.props.isAppBarFlyOut;childProps["isQuickCommandsBarFlyOut"]=this.props.isQuickCommandsBarFlyOut;childProps["stopClickPropagation"]=true;childProps["onKeyDown"]=this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleKeyDownIC:null;childProps["tabIndex"]=this.props.tabIndex;childProps["onMouseEnter"]=this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOnMouseEnter:null;return factory(childProps)};FlyOutButtonSpec.prototype.icchildDecorator=function(factory,childProps){if(this.props.childViewModels){var viewModel=childProps["dataContext"];if(this.props.childViewModels.indexOf(viewModel)===-1)return null}childProps["className"]=CssClassSet(null,childProps["className"],"flyout-menuItem");childProps["onClick"]=this.handleICFlyOutButtonClick;childProps["afterClick"]=this.handleICFlyOutButtonClick;childProps["flyOutPositioning"]=FlyOutPositioning.Horizontal;childProps["flyOutContainerClassName"]="flyout-horizontal-right";childProps["mountToAncestorWithSelector"]=this.props.mountToAncestorWithSelector||".commandBarSection";childProps["isICCommandBarFlyOut"]=true;childProps["stopClickPropagation"]=true;childProps["onKeyDown"]=this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleKeyDownIC:null;childProps["tabIndex"]=this.props.commandBarTabIndex>-1?this.props.commandBarTabIndex:this.props.tabIndex;childProps["onMouseEnter"]=this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOnMouseEnter:null;return factory(childProps)};FlyOutButtonSpec.prototype.handleOnMouseEnter=function(e){var currentElement=e.currentTarget;if(currentElement!=null){var elementName=this.props.dataContext.get_Name();if(this.props.dataContext.get_VisibleChildrenCount&&this.props.dataContext.get_VisibleChildrenCount()>0&&elementName==null)$(currentElement.parentElement).focus();else(elementName==null||elementName!==currentElement.getAttribute("data-id"))&&$(currentElement).focus()}};FlyOutButtonSpec.prototype.renderPhoneFlyOut=function(flyOutContent){var innerContent=React.DOM.div({className:"phone-overflow-flyout-Content"},flyOutContent);return React.DOM.div({key:"overflowFlyoutOuter",className:"phone-overflow-flyOut-Container"},innerContent)};FlyOutButtonSpec.prototype.renderLoadingFlyOut=function(){var progressBar=ProgressIndicator.ProgressIndicator({key:"flyoutButtonProgressBar",active:true,className:"loading-flyout-Container",type:ProgressIndicator.ProgressIndicatorType.Bar});return React.DOM.div({key:"progress",className:"loadingBarContainer"},[progressBar,this.props.loadingComponent])};FlyOutButtonSpec.prototype.renderFlyOut=function(){var isPhone=this.props.clientContext.isPhone,children,decorator=this.props.isICCommandBarFlyOut?this.icchildDecorator:this.childDecorator,flyOutContent=ComponentFactory.createChildComponents(this.props.flyOutChildrenParent||this.props.dataContext,this.props.descriptor,this.props.clientContext,decorator),shouldRenderPhoneLayout=isPhone&&(this.props.isAppBarFlyOut||this.props.isQuickCommandsBarFlyOut);if(this.props.loadingComponent)children=this.renderLoadingFlyOut();else if(shouldRenderPhoneLayout)children=this.renderPhoneFlyOut(flyOutContent);else children=flyOutContent;if(this.props.reverseChildren&&!this.props.loadingComponent)children=children.reverse();var styles={};if(!isPhone){var styles={};if(this.props.flyOutPositioning!==FlyOutPositioning.External&&this.state.popupAppearance){styles["position"]="fixed";styles["height"]=this.state.popupAppearance.height;styles["top"]=this.state.popupAppearance.top;styles["left"]=this.state.popupAppearance.left}}var popup=Popup.Popup({key:"flyout",ref:"flyout",className:CssClassSet({"flyoutButton-flyOut":true,"phone-flyoutContainer":shouldRenderPhoneLayout},this.props.flyOutContainerClassName),onDismiss:this.handleFlyOutDismiss,visible:this.props.dataContext.get_FlyOutExpanded(),style:styles},children);if(this.props.clientContext.isInteractionCentric)if(this.props.mountToAncestorWithSelector)return AncestorMountedHost.AncestorMountedHost({key:"flyout",dataId:"flyoutMenuContainer",selectorString:this.props.mountToAncestorWithSelector},popup);else return popup;if(this.props.mountToElementWithId)return ElementMountedHost.ElementMountedHost({key:"flyout",dataId:"flyoutMenuContainer",parentId:this.props.mountToElementWithId},popup);else return popup};FlyOutButtonSpec.prototype.render=function(){var styles={};if(this.isHidden())styles["display"]="none";return React.DOM.div({className:CssClassSet({flyoutContainer:true,flyoutMenuOpen:this.props.dataContext.get_FlyOutExpanded()},this.props.className),style:styles,"data-id":this.props.containerDataId,tabIndex:this.getTabIndex(),"aria-label":this.getTitle(),onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleFlyOutButtonKeyDownIC:null,onFocus:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOnFocusIC:null},[this.renderButton(),this.renderFlyOut()])};return FlyOutButtonSpec}(TsAdapter.SpecBase);exports.FlyOutButton=DataWrapperComponent.wrapComponent(new FlyOutButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/EntityFontIcon",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var EntityFontIconSpec=function(_super){__extends(EntityFontIconSpec,_super);function EntityFontIconSpec(){_super.apply(this,arguments);this.displayName="EntityFontIcon";this.mixins=[PureUpdate.Mixin]}EntityFontIconSpec.prototype.render=function(){return React.DOM.span({className:CssClassSet({crmSymbolFont:true,"entity-symbol":true},this.props.entityName,this.props.className),style:this.props.cssStyles})};return EntityFontIconSpec}(TsAdapter.SpecBase);exports.EntityFontIcon=TsAdapter.createComponent(new EntityFontIconSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/Image",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/EntityFontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,EntityFontIcon){exports.DESCRIPTOR_NAME="Image";var ImageSpec=function(_super){__extends(ImageSpec,_super);function ImageSpec(){_super.apply(this,arguments);this.displayName="Image";this.listenToProperties=["Data","Width","Height","AltText"];this.skipInlineStyleEntities=["sharepointdocument","recommendeddocument","delveactionhub"];this.iframeLoaded=false;this.imageHasError=false}ImageSpec.prototype.onIframeLoad=function(e){this.iframeLoaded=true;if(this.imageHasError){var imageElement=this.refs["image"];imageElement.src=imageElement.src}};ImageSpec.prototype.onImageError=function(e){if(this.iframeLoaded){var imageElement=this.refs["image"];imageElement.src=imageElement.src}this.imageHasError=true};ImageSpec.prototype.getInlineStyle=function(){var styles={},vm=this.props.dataContext,cm=this.props.clientContext,skipInlineStyle=false;if(vm&&vm.get_Root()&&vm.get_Root().get_PrimaryModelName())skipInlineStyle=this.skipInlineStyleEntities.indexOf(vm.get_Root().get_PrimaryModelName().toLowerCase())>=0;if(skipInlineStyle)return styles;if(vm&&cm&&cm.theming.IsEnabled){var entityColor=cm.theming.getEntityColor(vm.get_PrimaryModelName());if(entityColor)styles["backgroundColor"]=entityColor}return styles};ImageSpec.prototype.componentWillUnmount=function(){this.iframeLoaded=false;this.imageHasError=false};ImageSpec.prototype.render=function(){var imageClassName=this.props.dataContext!=null?this.props.dataContext.get_ImageClassName():null,src=this.props.dataContext!=null?this.props.dataContext.get_Data():null,roundIcon=this.props.descriptor!=null&&this.props.descriptor.Properties&&this.props.descriptor.Properties["UseRoundIcon"]?"roundIcon":"";if(src){var image=React.DOM.img({key:"image",ref:"image",height:this.props.dataContext.get_Height(),width:this.props.dataContext.get_Width(),alt:this.props.dataContext.get_AltText(),src:src,onError:this.props.clientContext.userAgent.get_IsMailApp()?this.onImageError:null,className:CssClassSet(null,this.props.className,roundIcon)});if(this.props.clientContext.userAgent.get_IsMailApp()){var iframe=React.DOM.iframe({key:"iframe",className:"displayNone",src:src,onLoad:this.props.clientContext.userAgent.get_IsMailApp()?this.onIframeLoad:null});return React.DOM.div(null,[iframe,image])}else return image}var className=CssClassSet(null,imageClassName,this.props.placeholderClassName,roundIcon);return EntityFontIcon.EntityFontIcon({entityName:"placeHolderImage",className:className,cssStyles:this.getInlineStyle()})};return ImageSpec}(TsAdapter.SpecBase);exports.Image=DataWrapperComponent.wrapComponent(new ImageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/Label",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="label";exports.RENDERED_PROPERTY_NAME="Data";var LabelSpec=function(_super){__extends(LabelSpec,_super);function LabelSpec(){_super.apply(this,arguments);this.displayName="Label";this.listenToProperties=[exports.RENDERED_PROPERTY_NAME,"Visible"]}LabelSpec.prototype.getDefaultProps=function(){return {isInteractionCentricFormStateLabel:false}};LabelSpec.prototype.handleShortPress=function(e){this.props.onClick&&this.props.onClick(e)};LabelSpec.prototype.render=function(){var descriptorClassName="";if(this.props.descriptor&&this.props.descriptor.Properties&&"LabelCssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["LabelCssClass"];var text="",isVisible=false;if(this.props.dataContext){text=this.props.dataContext.get_Data();isVisible=this.props.dataContext.get_Visible();if(text&&this.props.descriptor&&this.props.descriptor.Properties&&"ValuePrefixResourceId" in this.props.descriptor.Properties){var valuePrefixResourceId=this.props.descriptor.Properties["ValuePrefixResourceId"];text=this.props.clientContext.getLocalizedString(valuePrefixResourceId)+" "+text}}var title=text;if(this.props.descriptor&&this.props.descriptor.Properties&&"Title" in this.props.descriptor.Properties)title=this.props.descriptor.Properties["Title"];if(this.props.isInteractionCentricFormStateLabel)if(this.props.dataContext.getLabelFromOptionMetadata(text)!=null){text=this.props.dataContext.getLabelFromOptionMetadata(text);title=text}if(this.props.descriptor&&this.props.descriptor.Properties&&"TitleFormat" in this.props.descriptor.Properties){var titleFormat=this.props.descriptor.Properties["TitleFormat"];title=titleFormat.replace("{0}",title).replace("{1}",text)}var styles;if(!isVisible)styles={display:"none"};if(this.props.dataContext&&this.props.dataContext.get_UseHTMLFormat())return React.DOM.span({title:title,className:descriptorClassName,style:styles,onShortPress:this.handleShortPress,dangerouslySetInnerHTML:{__html:text}});else return React.DOM.span({title:title,className:descriptorClassName,style:styles,onShortPress:this.handleShortPress},text)};return LabelSpec}(TsAdapter.SpecBase);exports.LabelSpec=LabelSpec;exports.Label=DataWrapperComponent.wrapComponent(new LabelSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/Group",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,CssClassSet){exports.DESCRIPTOR_NAME="Group";var GroupSpec=function(_super){__extends(GroupSpec,_super);function GroupSpec(){_super.apply(this,arguments);this.displayName="Group";this.listenToProperties=["ChildViewModels","Label","ShowLabel","Visible"]}GroupSpec.prototype.childDecorator=function(factory,childProps){childProps["tabIndex"]=this.props.tabIndex;childProps["onKeyDown"]=this.props.onKeyDown;return factory(childProps)};GroupSpec.prototype.render=function(){var descriptorClassName="";if(this.props.descriptor&&this.props.descriptor.Properties&&"CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];var children=[];if(this.props.dataContext&&!this.props.hideChildren){var label=this.props.dataContext.get_Label();if(label&&this.props.dataContext.get_ShowLabel()){var title=React.DOM.span({key:"title",className:"group_title"},label);children.push(title)}var contentChildren=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.props.dataContext.get_IsInteractionCentricEnabled()?this.childDecorator:this.props.childDecorator),content=React.DOM.div({key:"content",className:"group_content"},contentChildren);children.push(content)}var styles={};if(this.props.dataContext&&!this.props.dataContext.get_Visible())styles["display"]="none";return React.DOM.div({className:CssClassSet(null,"group",descriptorClassName,this.props.className),"data-id":this.props.dataId,"data-viewstatus":this.props.dataViewStatus,style:styles},children)};return GroupSpec}(TsAdapter.SpecBase);exports.Group=DataWrapperComponent.wrapComponent(new GroupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ErrorIndicator",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Popup","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,Popup,CssClassSet){var ErrorIndicatorSpec=function(_super){__extends(ErrorIndicatorSpec,_super);function ErrorIndicatorSpec(){_super.apply(this,arguments);this.displayName="ErrorIndicator";this.mixins=[PureUpdate.Mixin]}ErrorIndicatorSpec.prototype.handleIndicatorClick=function(e){this.isPopupShownOnMouseEnter=false;this.setState({popupVisible:!this.state.popupVisible});e.stopPropagation()};ErrorIndicatorSpec.prototype.handleMouseEnter=function(e){if(this.state.popupVisible)return;this.isPopupShownOnMouseEnter=true;this.setState({popupVisible:true})};ErrorIndicatorSpec.prototype.handleApplyButtonClick=function(e){this.props.buttonAcceptanceActions&&this.props.buttonAcceptanceActions()};ErrorIndicatorSpec.prototype.handleMouseLeave=function(e){this.isPopupShownOnMouseEnter&&this.handlePopupDismiss()};ErrorIndicatorSpec.prototype.handlePopupDismiss=function(){this.setState({popupVisible:false})};ErrorIndicatorSpec.prototype.getInitialState=function(){return {popupVisible:false}};ErrorIndicatorSpec.prototype.setErrorMessagePosition=function(){if(this.state.popupVisible&&this.props.dataContext.get_Root().get_ComponentType()==40){var popupNode=$("#errorpopup"),errorSpan=$("#errorspan");if(errorSpan&&popupNode){errorSpan.css("top",popupNode.offset().top+"px");errorSpan.css("left",popupNode.offset().left+"px")}}};ErrorIndicatorSpec.prototype.componentDidMount=function(){this.props.dataContext.get_IsInteractionCentricEnabled()&&this.setErrorMessagePosition()};ErrorIndicatorSpec.prototype.componentDidUpdate=function(){this.props.dataContext.get_IsInteractionCentricEnabled()&&this.setErrorMessagePosition()};ErrorIndicatorSpec.prototype.renderPopup=function(){var vm=this.props.dataContext,applyButtonText=vm.get_RecommendationApplyActionText(),applyDismissText=vm.get_RecommendationDismissActionText();if(this.state.popupVisible&&this.props.errorMessage)if(this.props.buttonAcceptanceMessage){if(this.props.buttonAcceptanceActions)return Popup.Popup({visible:true,key:"errorIndicator_popup",onDismiss:this.handlePopupDismiss},[React.DOM.div({key:"errorMessage",className:"errorMessage",id:"errorspan"},this.props.errorMessage,React.DOM.div({className:"RecommendationText"},this.props.buttonAcceptanceMessage,React.DOM.div({className:"RecommendationButtonDiv"},React.DOM.button({className:"RecommendationApply",onClick:this.handleApplyButtonClick},applyButtonText),React.DOM.button({className:"RecommendationDismiss"},applyDismissText)))),React.DOM.span({key:"errorMessagePip",className:"errorMessagePip"})])}else return Popup.Popup({visible:true,key:"errorIndicator_popup",onDismiss:this.handlePopupDismiss},[React.DOM.span({key:"errorMessage",className:"errorMessage",id:"errorspan"},this.props.errorMessage),React.DOM.span({key:"errorMessagePip",className:"errorMessagePip"})]);return null};ErrorIndicatorSpec.prototype.render=function(){var children=[this.renderPopup()];this.props.clientContext.isPhone&&children.push(React.DOM.div({className:"errorIndicator_hitbox",key:"errorIndicator_hitbox",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?-1:null,onClick:this.handleIndicatorClick}));return React.DOM.div({className:CssClassSet(null,"errorIndicator",this.props.className),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?-1:null,onClick:this.handleIndicatorClick,onMouseEnter:this.props.clientContext.userAgent.get_IsMailApp()?this.handleMouseEnter:null,onMouseLeave:this.props.clientContext.userAgent.get_IsMailApp()?this.handleMouseLeave:null},children)};return ErrorIndicatorSpec}(TsAdapter.SpecBase);exports.ErrorIndicator=TsAdapter.createComponent(new ErrorIndicatorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/FontIcon",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var FontIconSpec=function(_super){__extends(FontIconSpec,_super);function FontIconSpec(){_super.apply(this,arguments);this.displayName="FontIcon";this.mixins=[PureUpdate.Mixin]}FontIconSpec.prototype.render=function(){return React.DOM.span({key:"symbolFont",className:CssClassSet(null,"symbolFont",this.props.symbolName+"-symbol",this.props.className),style:this.props.style,"data-id":this.props.dataId,title:this.props.title,"aria-hidden":this.props.ariaHidden})};return FontIconSpec}(TsAdapter.SpecBase);exports.FontIcon=TsAdapter.createComponent(new FontIconSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/BodyListenerDiv",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var CLICK_HANDLER_ID_PREFIX="BLDclick",BodyListenerDivSpec=function(_super){__extends(BodyListenerDivSpec,_super);function BodyListenerDivSpec(){_super.apply(this,arguments);this.displayName="BodyListenerDiv";this.mixins=[PureUpdate.Mixin]}BodyListenerDivSpec.prototype.onBodyClick=function(e){var target=$(e.target),match=target.closest(ReactDOM.findDOMNode(this));(!match||match.length==0)&&this.props.onBodyClick()};BodyListenerDivSpec.prototype.componentDidMount=function(){if(!this.bodyClickHandlerId&&this.onBodyClick){this.bodyClickHandlerId=CLICK_HANDLER_ID_PREFIX+this.props.dataContext.get_ViewModelId();if(this.props.id)this.bodyClickHandlerId+=this.props.id;$(document).on("click."+this.bodyClickHandlerId,this.onBodyClick)}};BodyListenerDivSpec.prototype.componentWillUnmount=function(){if(this.bodyClickHandlerId){$(document).off("click."+this.bodyClickHandlerId);this.bodyClickHandlerId=null}};BodyListenerDivSpec.prototype.render=function(){return React.DOM.div({className:this.props.className,tabIndex:this.props.tabIndex,ref:this.props.id,onFocus:this.props.onFocus,onKeyDown:this.props.onKeyDown,style:this.props.style},this.props.children)};return BodyListenerDivSpec}(TsAdapter.SpecBase);exports.BodyListenerDiv=TsAdapter.createComponent(new BodyListenerDivSpec)});define("Components/CustomControls/VirtualComponentTranslator",["require","exports","Components/Fields/ErrorIndicator","Components/Primitives/FontIcon","Components/Primitives/BodyListenerDiv"],function(require,exports,ErrorIndicator,FontIcon,BodyListenerDiv){var simpleComponentNames=["DIV","VIEW","BUTTON","SPAN","OPTION","ERROR","ICON","ANCHOR","INPUT","LABEL","TABLE","OPTION","SELECT","BODYLISTENVIEW","TEXTAREA","TR","TD","TH","TBODY"];function getReactChildren(virtualComponents){var childNodes=[];if(virtualComponents!=null)for(var i=0;i<virtualComponents.length;i++)if(virtualComponents[i].getType){var elemChildren=virtualComponents[i].getChildren();childNodes.push(this.generateReactComponent(virtualComponents[i].getType(),null,null,virtualComponents[i].getComponentId(),virtualComponents[i].getProperties(),elemChildren.length?this.getReactChildren(elemChildren):null))}else childNodes.push(virtualComponents[i]);return childNodes}exports.getReactChildren=getReactChildren;function generateReactComponent(elementType,dataContext,clientContext,componentId,props,children){switch(elementType.toLowerCase()){case "error":return ErrorIndicator.ErrorIndicator({dataContext:dataContext,clientContext:clientContext,errorMessage:props?props["errorMessage"]:null},children);case "icon":if(props&&props["symbolName"])switch(props["symbolName"]){case "lock":return FontIcon.FontIcon({key:"lock",symbolName:"FlsLocked"});case "requiredIcon":case "securedIcon":return React.DOM.span({className:props["symbolName"]});default:return FontIcon.FontIcon({key:"lock",symbolName:props["symbolName"]})}else return React.DOM.div(null,"UNKNOWN COMPONENT");case "button":return React.DOM.button(props,children);case "span":return React.DOM.span(props,children);case "anchor":return React.DOM.a(props,children);case "input":return React.DOM.input(props,children);case "textarea":return React.DOM.textarea(props,children);case "label":return React.DOM.label(props,children);case "table":return React.DOM.table(props,children);case "select":return React.DOM.select(props,children);case "option":return React.DOM.option(props,children);case "div":case "view":return React.DOM.div(props,children);case "bodylistenview":updatePropsWithContext(props,dataContext,clientContext);return BodyListenerDiv.BodyListenerDiv(props,children);case "tbody":return React.DOM.tbody(props,children);case "tr":return React.DOM.tr(props,children);case "td":return React.DOM.td(props,children);case "th":return React.DOM.th(props,children);default:return React.DOM.div(null,"UNKNOWN COMPONENT")}}exports.generateReactComponent=generateReactComponent;function updatePropsWithContext(props,dataContext,clientContext){if(props!=null){props["clientContext"]=clientContext;props["dataContext"]=dataContext}}function isComplexComponent(virtualComponent){var componentType=virtualComponent.getType();if(simpleComponentNames.indexOf(componentType.toUpperCase())!=-1)return false;return true}exports.isComplexComponent=isComplexComponent});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/CustomControls/CustomControlHostView",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Utils/CssClassSet","Core/Binding/CustomEventsListenerMixin","Components/ComponentFactory","Core/Binding/WindowResizeHandlerMixin","Components/Shell/Conductor","Components/CustomControls/VirtualComponentTranslator"],function(require,exports,TsAdapter,DataWrapperComponent,ProgressIndicator,CssClassSet,CustomEventsListener,ComponentFactory,WindowResizeHandler,Conductor,VirtualComponentTranslator){exports.DESCRIPTOR_NAME="CustomControlHostView";var GRID_CONTAINER_TOP_MARGIN=17,CustomControlHostViewSpec=function(_super){__extends(CustomControlHostViewSpec,_super);function CustomControlHostViewSpec(){_super.apply(this,arguments);this.displayName="CustomControlsHostView";this.typeName="CustomControl";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["IsLoaded","IsActive","InErrorState","MaxAvailableWidth","ViewportHeight","ControlUpdated"];this.controlInitialized=false;this.outputUpdateDebouncer=-1;this.initializationFailure=false}CustomControlHostViewSpec.prototype.generateControlInstance=function(){if(!this.props.dataContext.get_InErrorState())try{this.constructControl();this.initControl();this.controlInitialized=true;this.updateControl()}catch(e){this.controlInitialized=false;this.props.dataContext.set_InErrorState(true);this.initializationFailure=true;this.props.dataContext.logCustomControlInitializationError(e)}};CustomControlHostViewSpec.prototype.constructControl=function(){var stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - Constructor");stopwatch.start();this.instance=eval("new "+this.props.dataContext.get_ConstructorName()+"()");stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - Cosntructor",stopwatch)};CustomControlHostViewSpec.prototype.initControl=function(){var propertyBag=this.props.dataContext.generatePropertyBag(),stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - Init");stopwatch.start();if(this.props.dataContext.get_ControlType()==0){propertyBag["utils"]["bindDOMComponent"]=this.bindDOMComponent;propertyBag["utils"]["unbindDOMComponent"]=this.unbindDOMComponent;propertyBag["utils"]["updateComponent"]=this.updateComponentProperties;propertyBag["utils"]["fireEvent"]=this.onEventFired;var standardControl=this.instance;standardControl.init(ReactDOM.findDOMNode(this),this.onOutputChanged,propertyBag,this.props.dataContext.get_State(),this.getAuxLabel())}else{propertyBag["utils"]["notifyOutputChanged"]=this.onOutputChanged;propertyBag["utils"]["fireEvent"]=this.onEventFired;propertyBag["utils"]["getElementByRef"]=this.getElementByRef;var virtualControl=this.instance;virtualControl.context=propertyBag;virtualControl.init(this.props.dataContext.get_State())}this.props.dataContext.get_Root().add_PreNavigation(this.onPreNavigation);this.props.dataContext.set_CustomControlInitCalled(true);stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - Init",stopwatch)};CustomControlHostViewSpec.prototype.updateControl=function(){if(!this.controlInitialized)return;if(this.outputUpdateDebouncer!=-1){window.clearTimeout(this.outputUpdateDebouncer);this.onOutputChangedInternal()}if(this.props.dataContext.get_ControlType()==0){var stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - Update"),propertyBag=this.props.dataContext.generatePropertyBag();propertyBag["utils"]["notifyOutputChanged"]=this.onOutputChanged;propertyBag["utils"]["bindDOMComponent"]=this.bindDOMComponent;propertyBag["utils"]["unbindDOMComponent"]=this.unbindDOMComponent;propertyBag["utils"]["updateComponent"]=this.updateComponentProperties;propertyBag["utils"]["fireEvent"]=this.onEventFired;propertyBag["utils"]["getElementByRef"]=this.getElementByRef;stopwatch.start();var standardControl=this.instance;standardControl.update(propertyBag);stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - Update",stopwatch)}else this.props.dataContext.requestRender()};CustomControlHostViewSpec.prototype.updateComponentProperties=function(componentId,properties){this.props.dataContext.retrieveOrAddChildViewModel(componentId,null,properties)};CustomControlHostViewSpec.prototype.getOutputs=function(){var stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - GetOutputs");stopwatch.start();var outputs=this.instance.getOutputs();stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - GetOutputs",stopwatch);return outputs};CustomControlHostViewSpec.prototype.onPreNavigation=function(){this.instance.onPreNavigation&&this.instance.onPreNavigation()};CustomControlHostViewSpec.prototype.destroyControl=function(){var stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - Destroy");stopwatch.start();this.props.dataContext.get_Root().remove_PreNavigation(this.onPreNavigation);this.props.dataContext.set_CustomControlInitCalled(false);if(this.props.dataContext.get_ControlType()==0&&this.childrenDOMNodes!=null)for(var index in this.childrenDOMNodes)this.unbindDOMComponent(index);this.instance.destroy();stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - Destroy",stopwatch)};CustomControlHostViewSpec.prototype.updateLayoutThenControl=function(){this.updateClientSize(false);this.updateControl()};CustomControlHostViewSpec.prototype.configureEventListeners=function(){return {OnPropertyBagChanged:this.updateControl,OnPropBagWithLayoutChange:this.updateLayoutThenControl}};CustomControlHostViewSpec.prototype.componentUpdated=function(){if(this.controlInitialized&&!this.props.dataContext.get_IsLoaded()){this.destroyControl();this.controlInitialized=false}else{this.updateClientSize(true);!this.controlInitialized&&this.props.dataContext.get_IsLoaded()&&this.props.dataContext.get_IsActive()&&!this.props.dataContext.get_InErrorState()&&this.generateControlInstance()}};CustomControlHostViewSpec.prototype.isPhoneHeaderField=function(){return this.props.clientContext.isPhone&&this.props.descriptor&&this.props.descriptor.Properties&&this.props.descriptor.Properties["IsHeaderField"]};CustomControlHostViewSpec.prototype.getAuxLabel=function(){if(!this.props.dataContext.get_IsDataSetControl())if(this.props.clientContext.isPhone){var node=ReactDOM.findDOMNode(this);if(node){var wrapper=$(node).parents(".label_value_wrapper"),label=wrapper.children(".aux_cc_label");return label[0]}}else{var node=ReactDOM.findDOMNode(this);if(node){var wrapper=$(node).parents(".control_value").siblings(".aux_cc_wrapper"),label=wrapper.children(".aux_cc_label");return label[0]}}return null};CustomControlHostViewSpec.prototype.updateClientSize=function(triggerUpdate){var node=ReactDOM.findDOMNode(this);if(node){var prevMaxWidth=this.props.dataContext.get_MaxAvailableWidth(),prevHeight=this.props.dataContext.get_ViewportHeight(),width=node.clientWidth,height=-1,gridPane=$(node).parents(".RootView-gridForm");if(this.props.dataContext.get_IsDataSetControl()){var panoramaItem=$(node).parents(".panoramaItem"),panoramaHeader=$(node).siblings(".listHeader");if(gridPane.length>0&&!this.props.clientContext.isPhone&&!this.props.clientContext.isInteractionCentric){var additionalWidth=this.parseIntHelper(panoramaItem.css("padding-left"))+this.parseIntHelper(panoramaItem.css("padding-right"))+this.parseIntHelper(panoramaItem.css("margin-left"));width=WindowResizeHandler.getWindowWidth()-additionalWidth-Conductor.CONDUCTOR_LEFT_OFFSET}if(this.props.clientContext.isInteractionCentric){panoramaItem=$(node).parents(".gridcontainer");width=panoramaItem.width()-90}var rawheight=panoramaItem.height();height=rawheight-(panoramaHeader.length>0?panoramaHeader.outerHeight():0)-(this.props.clientContext.isInteractionCentric?90:0)}else if(this.isPhoneHeaderField()){var panoramaHeaderItem=$(node).parents(".section_control"),header=panoramaHeaderItem.find(".control_label");height=panoramaHeaderItem.height()-header.outerHeight()}this.props.dataContext.set_ViewportHeight(height);this.props.dataContext.set_MaxAvailableWidth(width);if(prevMaxWidth!==width||prevHeight!==height){this.props.dataContext.addUpdatedProperty("layout");triggerUpdate&&this.updateControl()}}};CustomControlHostViewSpec.prototype.parseIntHelper=function(value){if(value)return parseInt(value);return 0};CustomControlHostViewSpec.prototype.componentDidMount=function(){this.componentUpdated()};CustomControlHostViewSpec.prototype.componentDidUpdate=function(){this.componentUpdated()};CustomControlHostViewSpec.prototype.componentWillUnmount=function(){if(this.instance){if(!this.props.dataContext.get_IsDisposed()){this.outputUpdateDebouncer!=-1&&window.clearTimeout(this.outputUpdateDebouncer);this.props.dataContext.get_ControlMode()!=0&&this.onOutputChangedInternal();if(this.initializationFailure){this.props.dataContext.set_InErrorState(false);this.initializationFailure=false}}this.destroyControl()}};CustomControlHostViewSpec.prototype.onOutputChanged=function(force,requestRender){if(force===void 0)force=false;if(requestRender===void 0)requestRender=false;var _this=this;this.outputUpdateDebouncer!=-1&&window.clearTimeout(this.outputUpdateDebouncer);if(force)this.onOutputChangedInternal(requestRender);else this.outputUpdateDebouncer=window.setTimeout(function(){_this.onOutputChangedInternal(requestRender)},100)};CustomControlHostViewSpec.prototype.onOutputChangedInternal=function(requestRender){if(requestRender===void 0)requestRender=false;this.outputUpdateDebouncer=-1;var outputs=this.getOutputs();this.props.dataContext.updateOutput(outputs);requestRender&&this.props.dataContext.requestRender()};CustomControlHostViewSpec.prototype.onEventFired=function(eventName,params){var handlerDic=this.props.dataContext.get_ParentalEventListeners();if(handlerDic!=null&&handlerDic[eventName]!=null)for(var handlerList=handlerDic[eventName],i=0;i<handlerList.length;i++)handlerList[i]!=null&&handlerList[i](params)};CustomControlHostViewSpec.prototype.getElementByRef=function(refId){var node=this.refs[refId];if(node instanceof Element)return node;else if(node)return ReactDOM.findDOMNode(node);return null};CustomControlHostViewSpec.prototype.generateVirtualControl=function(){var stopwatch=this.props.clientContext.getPerformanceStopwatch("CustomControl - Update");stopwatch.start();var propertyBag=this.props.dataContext.generatePropertyBag(),virtualControl=this.instance;propertyBag["utils"]["notifyOutputChanged"]=this.onOutputChanged;propertyBag["utils"]["fireEvent"]=this.onEventFired;propertyBag["utils"]["getElementByRef"]=this.getElementByRef;virtualControl.context=propertyBag;var virtualComponent=virtualControl.render(),direction=propertyBag["client"]["isRTL"]?"rtl":"ltr",dataVmId=this.props.dataContext.get_customControlViewModelId(),container=React.DOM.div({style:{direction:direction},className:CssClassSet({customControl:true,columnDisplay:this.props.dataContext.get_ControlMode()==2||this.props.dataContext.get_ControlMode()==0},this.props.dataContext.get_CssNameString()),"data-isvirtual":true,"data-vmid":dataVmId},this.generateReactComponent(virtualComponent,this.getReactChildren(virtualComponent.getChildren())));stopwatch.stop();this.props.dataContext.logCustomControlPerfInfo("CustomControl - Update",stopwatch);return container};CustomControlHostViewSpec.prototype.generateContainer=function(){var dataVmId=this.props.dataContext.get_customControlViewModelId(),container=React.DOM.div({className:CssClassSet({customControl:true,columnDisplay:this.props.dataContext.get_ControlMode()==2||this.props.dataContext.get_ControlMode()==0},this.props.dataContext.get_CssNameString()),"data-vmid":dataVmId});if(this.props.dataContext.get_ControlType()==0)return container;else if(this.instance)container=this.generateVirtualControl();return container};CustomControlHostViewSpec.prototype.render=function(){if(this.props.dataContext.get_InErrorState())return React.DOM.div({className:"customControl inError"},this.props.clientContext.getLocalizedString("Error_CustomControl_Load_Failure"));if(this.props.dataContext.get_IsLoaded())return this.generateContainer();else return ProgressIndicator.ProgressIndicator({className:"customControl",key:"progressBar",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true})};CustomControlHostViewSpec.prototype.getReactChildren=function(virtualComponents){var childNodes=[];if(virtualComponents!=null)for(var i=0;i<virtualComponents.length;i++)if(virtualComponents[i].getType){var elemChildren=virtualComponents[i].getChildren();childNodes.push(this.generateReactComponent(virtualComponents[i],elemChildren.length?this.getReactChildren(elemChildren):null))}else childNodes.push(virtualComponents[i]);return childNodes};CustomControlHostViewSpec.prototype.generateReactComponent=function(component,children){if(!VirtualComponentTranslator.isComplexComponent(component))return VirtualComponentTranslator.generateReactComponent(component.getType(),this.props.dataContext,this.props.clientContext,component.getComponentId(),component.getProperties(),children);var componentId=component.getComponentId(),elementType=component.getType(),props=component.getProperties();if(componentId==null)return React.DOM.div(props,children);var childViewModel=this.props.dataContext.retrieveOrAddChildViewModel(componentId,elementType,props),bindingPath=componentId,viewDescriptor=this.generateViewDescriptor(bindingPath,this.props.dataContext.get_ControlProperties()),newChildComponent=ComponentFactory.createCustomComponent(childViewModel,componentId,viewDescriptor,this.props.clientContext);this.props.descriptor.ChildControlViewDescriptors[bindingPath]=viewDescriptor;return newChildComponent};CustomControlHostViewSpec.prototype.bindDOMComponent=function(virtualComponent,DOMNode){var newChildComponent=this.generateReactComponent(virtualComponent,this.getReactChildren(virtualComponent.getChildren()));if(this.childrenDOMNodes==null)this.childrenDOMNodes={};this.childrenDOMNodes[virtualComponent.getComponentId()]=DOMNode;ReactDOM.render(newChildComponent,DOMNode)};CustomControlHostViewSpec.prototype.unbindDOMComponent=function(componentId){var success=false;if(this.childrenDOMNodes!=null){var DOMElement=this.childrenDOMNodes[componentId];if(DOMElement!=null){success=ReactDOM.unmountComponentAtNode(DOMElement);if(success){this.props.dataContext.RemoveChildViewModel(componentId);delete this.childrenDOMNodes[componentId]}}}return success};CustomControlHostViewSpec.prototype.generateViewDescriptor=function(bindingPath,controlProperties){var newViewDescriptor={TypeName:"CustomControlHostView",BindingPath:bindingPath,ChildControlViewDescriptors:{},__type:"Control",Properties:controlProperties};return newViewDescriptor};return CustomControlHostViewSpec}(TsAdapter.SpecBase);exports.CustomControlHostViewSpec=CustomControlHostViewSpec;exports.CustomControlHostView=DataWrapperComponent.wrapComponent(new CustomControlHostViewSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/SectionItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/CustomControls/CustomControlHostView","Components/Fields/ErrorIndicator","Components/Primitives/FontIcon","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,CustomControlHostView,ErrorIndicator,FontIcon,Constants){var SectionItemSpec=function(_super){__extends(SectionItemSpec,_super);function SectionItemSpec(){_super.apply(this,arguments);this.listenToViewModels={dataContext:{listenToProperties:["HasFocus","PropertyBagChanged","RequiredLevel","Required","Recommended","Visible","Label","CustomControlLayout","ErrorMessage"]},editSectionViewModel:{listenToProperties:["FieldAccessChanged"]}};this.displayName="SectionItem";this.prevHasFocus=false;this.custControlUpdateNeeded=false}SectionItemSpec.prototype.controlNeedsLabel=function(){var needsLabel=this.props.sectionDescriptor.Properties["ShowLabel"];if(this.props.descriptor.Properties)if("ShowLabel" in this.props.descriptor.Properties)needsLabel=this.props.descriptor.Properties["ShowLabel"];if(!this.props.dataContext||!this.props.dataContext.get_Label())needsLabel=false;return needsLabel};SectionItemSpec.prototype.getIsCustomControl=function(){return this.props.descriptor.TypeName===CustomControlHostView.DESCRIPTOR_NAME&&!this.props.dataContext.get_Internal()};SectionItemSpec.prototype.getIsGenericCustomControl=function(){return this.props.descriptor.TypeName===CustomControlHostView.DESCRIPTOR_NAME&&this.props.dataContext.get_Internal()};SectionItemSpec.prototype.getErrorMessage=function(){var editViewModelAsValidatable=this.props.dataContext;return editViewModelAsValidatable&&editViewModelAsValidatable.get_ErrorMessage&&editViewModelAsValidatable.get_ErrorMessage()};SectionItemSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){if(this.props.tabIndex!=null&&this.props.tabIndex>0)return this.props.tabIndex;return this.props.sectionDescriptor.RowTabIndex!=undefined?this.props.sectionDescriptor.RowTabIndex:this.props.dataContext.get_StartIndex()}else return null};SectionItemSpec.prototype.onBodyClick=function(e){var target=$(e.target),match=target.closest(ReactDOM.findDOMNode(this));if(!match||match.length==0){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable){editViewModelAsFocusable.set_HasFocus(false);document.removeEventListener("click",this.onBodyClick)}}};SectionItemSpec.prototype.getEditViewModelAsFocusable=function(){var editViewModelAsFocusable=this.props.dataContext;if(editViewModelAsFocusable.get_HasFocus)return editViewModelAsFocusable;else return null};SectionItemSpec.prototype.onShortPress=function(e){this.onItemClicked()};SectionItemSpec.prototype.onItemClicked=function(){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable){editViewModelAsFocusable.set_HasFocus(true);document.addEventListener("click",this.onBodyClick)}};SectionItemSpec.prototype.checkIfCustomControlUpdateNeeded=function(state){if(!this.getIsCustomControl())return;if(!this.prevCustCssStates){this.prevCustCssStates=state;return}if(state)for(var key in state)if(state[key]!=this.prevCustCssStates[key]){this.custControlUpdateNeeded=true;this.prevCustCssStates[key]=state[key]}};SectionItemSpec.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.onBodyClick)};SectionItemSpec.prototype.componentDidUpdate=function(){if(this.getIsCustomControl()){var hasFocus=false,editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable)hasFocus=editViewModelAsFocusable.get_HasFocus();if(hasFocus)document.addEventListener("click",this.onBodyClick);else document.removeEventListener("click",this.onBodyClick);this.prevHasFocus!=hasFocus&&this.props.handleFocusStateChange&&this.props.handleFocusStateChange(hasFocus);this.prevHasFocus=hasFocus;if(this.custControlUpdateNeeded){this.props.dataContext.triggerUpdate();this.custControlUpdateNeeded=false}}};SectionItemSpec.prototype.renderCustomControl=function(){var children=[],controlDescriptor=this.props.descriptor,custModel=this.props.dataContext,fieldName=custModel.getPrimaryFieldName(),isPhone=this.props.clientContext.isPhone,fieldWriteable=custModel.get_ModelContext()&&this.props.editSectionViewModel.isFieldEditable(fieldName);if(custModel.get_ModelContext()==null)var isFieldLocked=false;else var isFieldLocked=this.props.dataContext&&(this.props.dataContext.get_IsReadOnly()||!fieldWriteable);var isSecured=this.props.editSectionViewModel.isFieldSecured(fieldName),editViewModelAsRequired=this.props.dataContext,isRequired=editViewModelAsRequired&&editViewModelAsRequired.get_Required&&editViewModelAsRequired.get_Required(),isRecommended=editViewModelAsRequired&&editViewModelAsRequired.get_Recommended&&editViewModelAsRequired.get_Recommended(),lock=FontIcon.FontIcon({key:"lock",symbolName:"FlsLocked"});isFieldLocked&&!isPhone&&children.push(lock);var createLabel=this.controlNeedsLabel();if(createLabel){var labelText=this.props.dataContext.get_Label(),labelSpan=React.DOM.span({key:"label"},labelText),icons=[];(isRequired||isRecommended)&&icons.push(React.DOM.span({key:"required",className:"requiredIcon"}));isFieldLocked&&isPhone&&icons.push(lock);isSecured&&icons.push(React.DOM.span({key:"secured",className:"securedIcon"}));var iconContainer=React.DOM.span({key:"icons",className:"fieldLabelInlineIcons"},icons),label=React.DOM.div({key:"label",className:CssClassSet({"control_label Section_label_common Section_value_alignment":true,section_primaryFieldLabel:this.props.isPrimaryFieldSection}),onShortPress:this.onShortPress},React.DOM.label(null,[React.DOM.span({key:"labelSpan"},this.props.dataContext.get_Label()),iconContainer]))}if(!this.props.clientContext.isPhone){var labels=[];labels.push(label);labels.push(React.DOM.div({key:"aux_cc_label",className:"aux_cc_label Section_value_common control_value",onShortPress:this.onShortPress}));children.push(React.DOM.div({key:"aux_cc_wrapper",className:"aux_cc_wrapper"},labels))}else{children.push(label);children.push(React.DOM.div({key:"aux_cc_label",className:"aux_cc_label Section_value_common control_value",onShortPress:this.onShortPress}))}var controlContainer=React.DOM.div({key:"value","data-fieldname":controlDescriptor.BindingPath,className:CssClassSet({"control_value Section_value_common Section_value_alignment custom_control_section":true,multiline_label:controlDescriptor.TypeName==="textArea",AttachmentsControl:controlDescriptor.TypeName==="AttachmentsControl"&&!isPhone,editControlContainer:this.getEditViewModelAsFocusable().get_HasFocus()&&!custModel.get_DisableUITransitions()},this.props.sectionDescriptor.CellValueCssClass,controlDescriptor.Properties["CellValueCssClass"]),onShortPress:this.onShortPress},this.props.children);children.push(controlContainer);if(this.props.clientContext.isPhone)children=[React.DOM.div({key:"label_value_wrapper",className:"label_value_wrapper"},children)];var errorMessage=this.getErrorMessage();if(errorMessage){var errorIndicator=ErrorIndicator.ErrorIndicator({key:"error",errorMessage:errorMessage,clientContext:this.props.clientContext,dataContext:this.props.dataContext});children.push(errorIndicator)}var styles={};if(!this.props.dataContext.get_Visible())styles["display"]="none";var isColumnLayout=!custModel.get_InlineLayout(),rightAligned=custModel.get_RightAlignedEdit(),editRow=this.getEditViewModelAsFocusable().get_HasFocus()&&!custModel.get_DisableUITransitions();this.checkIfCustomControlUpdateNeeded({rightAlignedEdit:rightAligned,isColumnLayout:isColumnLayout,editRow:editRow});var controlRow=React.DOM.div({key:controlDescriptor.BindingPath,"data-fieldname":controlDescriptor.BindingPath,className:CssClassSet({section_control:true,custom_control_column:isColumnLayout,right_aligned:rightAligned,noLabel:!createLabel,hasError:errorMessage,requiredField:isRequired,recommendedField:isRecommended,securedField:isSecured,editRow:editRow},controlDescriptor.Properties["BodyCssClass"]),style:styles,tabIndex:createLabel?this.getTabIndex():null},children);return controlRow};SectionItemSpec.prototype.getFinalTabIndex=function(){if(this.props.dataContext.get_Visible()&&this.props.descriptor.TypeName!=="SimpleButton"&&this.props.descriptor.TypeName!=="AttachmentsControl")return this.getTabIndex();else return null};SectionItemSpec.prototype.onEnterKeyDown=function(e){if(this.props.dataContext.get_CanNavigate()){this.props.dataContext.get_ActionCommand().execute();e.stopPropagation()}};SectionItemSpec.prototype.onKeyDownHandler=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.onEnterKeyDown(e);break}};SectionItemSpec.prototype.renderSuperGeneric=function(){return this.props.children};SectionItemSpec.prototype.renderGeneric=function(){var controlDescriptor=this.props.descriptor,children=[],isPhone=this.props.clientContext.isPhone,createLabel=this.controlNeedsLabel();if(createLabel){var label=React.DOM.div({key:"label",className:"control_label Section_label_common Section_value_alignment"},React.DOM.label(null,React.DOM.span(null,this.props.dataContext.get_Label())));children.push(label)}if(controlDescriptor.Properties){var controlContainer=React.DOM.div({key:"value","data-fieldname":controlDescriptor.BindingPath,className:CssClassSet({control_value:true,multiline_label:controlDescriptor.TypeName==="textArea",AttachmentsControl:controlDescriptor.TypeName==="AttachmentsControl"&&!isPhone,"control_value-statuscode":controlDescriptor.BindingPath==="statuscode"},this.props.sectionDescriptor.CellValueCssClass,controlDescriptor.Properties["CellValueCssClass"])},this.props.children);children.push(controlContainer);var styles={};if(this.props.clientContext.isMailApp&&this.props.dataContext&&this.props.dataContext.get_Visible&&this.props.dataContext.get_Visible()===false)styles["display"]="none";var controlRow=React.DOM.div({key:controlDescriptor.BindingPath,"data-fieldname":controlDescriptor.BindingPath,onKeyDown:this.props.descriptor.TypeName==="FieldButton"?this.onKeyDownHandler:this.props.onKeyDown,className:CssClassSet({section_control:true,noLabel:!createLabel},controlDescriptor.Properties["BodyCssClass"]),tabIndex:this.getFinalTabIndex(),style:styles},children);return controlRow}else return React.DOM.noscript()};SectionItemSpec.prototype.render=function(){if(this.getIsCustomControl())return this.renderCustomControl();else if(this.getIsGenericCustomControl())return this.renderSuperGeneric();else return this.renderGeneric()};return SectionItemSpec}(TsAdapter.SpecBase);exports.SectionItem=DataWrapperComponent.wrapComponent(new SectionItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/Section",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/ComponentFactory","Components/Fields/SectionItem","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,ComponentFactory,SectionItem,CssClassSet){exports.DESCRIPTOR_NAME="Section";var SectionSpec=function(_super){__extends(SectionSpec,_super);function SectionSpec(){_super.apply(this,arguments);this.displayName="Section";this.mixins=[PureUpdate.Mixin]}SectionSpec.prototype.getDefaultProps=function(){return {isVisible:true}};SectionSpec.prototype.renderSectionLabel=function(){if(!this.props.dataContext||!this.props.dataContext.get_Label()||!this.props.dataContext.get_ShowLabel())return null;var label=React.DOM.label(null,this.props.dataContext.get_Label());return React.DOM.div({key:"sectionLabel",className:CssClassSet(null,"section_label",this.props.descriptor.Properties["SectionLabelCssClass"])},label)};SectionSpec.prototype.sectionControlDecorator=function(factory,props){var boundProps=props,controlDescriptor=boundProps.descriptor;if(!this.props.dataContext||!factory||!controlDescriptor||controlDescriptor.__type!=="Control")return null;return SectionItem.SectionItem({key:props.key,clientContext:this.props.clientContext,dataContext:boundProps.dataContext,descriptor:controlDescriptor,sectionDescriptor:this.props.descriptor,isPrimaryFieldSection:this.props.descriptor.Properties["IsPrimaryFieldSection"]},factory(props))};SectionSpec.prototype.render=function(){var children=[],sectionLabel=this.renderSectionLabel();sectionLabel&&children.push(sectionLabel);var hasImage=false;if(this.props.descriptor.Properties&&this.props.descriptor.Properties["BodyCssClass"])hasImage=this.props.descriptor.Properties["BodyCssClass"].indexOf("image_enabled")>-1;var childComponents=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.props.sectionControlInterceptor||this.sectionControlDecorator,this.props.parentList);if(childComponents&&childComponents.length>0)if(hasImage&&childComponents.length>1){children.push(childComponents[0]);children.push(React.DOM.div({key:"textWrapper",className:"sectionTextWrapper"},childComponents.slice(1)))}else Array.prototype.push.apply(children,childComponents);var styles={};if(!this.props.isVisible)styles["display"]="none";return React.DOM.div({className:CssClassSet({section_vertical:!hasImage},"section",this.props.descriptor.Properties["BodyCssClass"],this.props.className),style:styles},children)};return SectionSpec}(TsAdapter.SpecBase);exports.Section=TsAdapter.createComponent(new SectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/Input",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Utils/CssClassSet","Components/Common/Constants","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,CssClassSet,Constants,AccessibilityUtility){var InputOverlayMode;(function(InputOverlayMode){InputOverlayMode[InputOverlayMode["Mask"]=0]="Mask";InputOverlayMode[InputOverlayMode["Prefix"]=1]="Prefix";InputOverlayMode[InputOverlayMode["Suffix"]=2]="Suffix"})(InputOverlayMode||(InputOverlayMode={}));exports.DESCRIPTOR_NAME="String";var InputSpec=function(_super){__extends(InputSpec,_super);function InputSpec(){_super.apply(this,arguments);this.displayName="Input";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["ShowLabel","Required","OverlayText","Value"]}InputSpec.prototype.configureEventListeners=function(){return {RefreshFromContextEvent:this.refreshFromContext}};InputSpec.prototype.refreshFromContext=function(){this.setState({currentText:this.props.dataContext.get_Value(),userEdited:false})};InputSpec.prototype.onTextValueChanged=function(event){if(event&&event.target){var target=event.target;this.setState({currentText:target.value,userEdited:true});this.props.dataContext.fireValueChanging(target.value);if(this.props.updateOnChange){this.props.onChangeEvent&&this.props.onChangeEvent();this.props.dataContext.set_Value(target.value)}}};InputSpec.prototype.onBlur=function(event){if(event&&event.target){var target=event.target;this.state.currentText!==target.value&&this.setState({currentText:target.value});this.props.dataContext&&!this.props.updateOnChange&&this.props.dataContext.set_Value(target.value)}this.props.onBlur&&this.props.onBlur()};InputSpec.prototype.onPreNavigate=function(){if(this.props.dataContext&&!this.props.updateOnChange){var input=this.refs["text"];input instanceof HTMLInputElement&&this.props.dataContext.set_Value(input.value)}};InputSpec.prototype.bindPreNavigationHandler=function(){var root=this.props.dataContext&&this.props.dataContext.get_Root&&this.props.dataContext.get_Root(),editRoot=root;editRoot&&editRoot.add_PreNavigation&&editRoot.add_PreNavigation(this.onPreNavigate)};InputSpec.prototype.unbindPreNavigationHandler=function(){var root=this.props.dataContext&&this.props.dataContext.get_Root&&this.props.dataContext.get_Root(),editRoot=root;editRoot&&editRoot.remove_PreNavigation&&editRoot.remove_PreNavigation(this.onPreNavigate)};InputSpec.prototype.fireOnKeyPress=function(event){this.props.dataContext.FireOnKeyPress(event)};InputSpec.prototype.onFocus=function(event){this.props.onFocus&&this.props.onFocus()};InputSpec.prototype.handleKeyDownForInput=function(e){AccessibilityUtility.handleShiftTabAndFocusParentSectionControl(ReactDOM.findDOMNode(this),e);(e.key==Constants.BACKSPACE_KEY||e.key==Constants.DELETE_KEY)&&this.fireOnKeyPress(e)};InputSpec.prototype.onTouchMove=function(event){event.stopPropagation()};InputSpec.prototype.generateTextInput=function(){var textContainerChildren=[],hasOverlay=!!this.props.dataContext.get_OverlayText(),longOverlay=hasOverlay&&this.props.dataContext.get_OverlayText().length>1,overlayMode=this.props.descriptor.Properties["OverlayMode"];if(hasOverlay){var overlay=React.DOM.span({key:"overlay",className:CssClassSet({isPrefix:overlayMode===InputOverlayMode.Prefix,isSuffix:overlayMode===InputOverlayMode.Suffix},"textboxOverlay")},this.props.dataContext.get_OverlayText());textContainerChildren.push(overlay)}if(this.props.inputType==8)this.props.clientContext.getTextBoxTypeString(5);else if(this.props.descriptor.TypeName=="Money"&&this.props.clientContext.isPhone)var type=this.props.clientContext.userAgent.get_IsIOS()?this.props.clientContext.getTextBoxTypeString(7):this.props.clientContext.getTextBoxTypeString(2);else var type=this.props.inputType?this.props.clientContext.getTextBoxTypeString(this.props.inputType):this.props.clientContext.getTextBoxTypeString(this.props.descriptor.Properties["Type"]);var inputProps=(_a={key:"text",ref:"text",className:CssClassSet({"textbox field":true,hasLongPrefix:longOverlay&&overlayMode===InputOverlayMode.Prefix,hasPrefix:hasOverlay&&overlayMode===InputOverlayMode.Prefix,hasLongSuffix:longOverlay&&overlayMode===InputOverlayMode.Suffix,hasSuffix:hasOverlay&&overlayMode===InputOverlayMode.Suffix,validationFailed:false}),value:(this.state.userEdited?this.state.currentText:this.props.dataContext.get_Value())||"",maxLength:this.props.dataContext.get_MaxLength(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex==null?this.props.dataContext.get_NextTabIndex():this.props.tabIndex:null,type:type,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleKeyDownForInput:null,onPointerMove:this.onTouchMove,onKeyPress:this.props.dataContext.get_IsInteractionCentricEnabled()?this.fireOnKeyPress:null},_a[this.props.clientContext.userAgent.get_IsBrowserIE()?"onInput":"onChange"]=this.onTextValueChanged,_a);if(this.props.inputType==8)if(this.props.onKeyDown)inputProps.onKeyDown=this.props.onKeyDown;if(this.props.extraInputComponentStyles){if(!inputProps.style)inputProps.style={};for(var key in this.props.extraInputComponentStyles)inputProps.style[key]=this.props.extraInputComponentStyles[key]}var textbox=this.props.inputComponent(inputProps);textContainerChildren.push(textbox);return textContainerChildren;var _a};InputSpec.prototype.autoSize=function(){var node=this.refs["text"];if(node instanceof Element){var jNode=$(node);jNode.height("auto")}};InputSpec.prototype.getDefaultProps=function(){return {inputComponent:React.DOM.input}};InputSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_Value(),userEdited:false}};InputSpec.prototype.componentDidMount=function(){this.props.shouldAutoSize&&this.autoSize();this.bindPreNavigationHandler()};InputSpec.prototype.componentWillUnmount=function(){!this.props.updateOnChange&&this.props.dataContext.set_Value(this.state.currentText);if(this.props.clientContext.userAgent.get_IsIOS10()){var textRef=this.refs["text"],textInput=null;if(textRef instanceof HTMLElement)textInput=textRef;else{var node=ReactDOM.findDOMNode(textRef);if(node instanceof HTMLElement)textInput=node}textInput&&textInput===document.activeElement&&textInput.blur()}this.unbindPreNavigationHandler()};InputSpec.prototype.componentDidUpdate=function(){this.props.shouldAutoSize&&this.autoSize()};InputSpec.prototype.render=function(){var children=[];if(this.props.dataContext.get_ShowLabel()){var label=React.DOM.span({key:"label",className:CssClassSet({label:true,requiredField:this.props.dataContext.get_Required()})},this.props.dataContext.get_Label());children.push(label)}var textContainerChildren=this.generateTextInput(),textContainer=React.DOM.div({key:"container",className:"textboxContainer"},textContainerChildren);children.push(textContainer);return React.DOM.div({className:"input-container",id:this.props.id},children)};return InputSpec}(TsAdapter.SpecBase);exports.Input=DataWrapperComponent.wrapComponent(new InputSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/MultilineInput",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Common/Input"],function(require,exports,TsAdapter,PureUpdate,Input){exports.DESCRIPTOR_NAME="MultilineString";var DEFAULT_ROWS=6,MultilineInputSpec=function(_super){__extends(MultilineInputSpec,_super);function MultilineInputSpec(){_super.apply(this,arguments);this.displayName="MultilineInput";this.mixins=[PureUpdate.Mixin]}MultilineInputSpec.prototype.render=function(){var descriptorRows=this.props.descriptor&&this.props.descriptor.Properties&&this.props.descriptor.Properties["Rows"],rows=parseInt(descriptorRows||DEFAULT_ROWS),styles;if(isNaN(rows)||this.props.dataContext.get_Root().get_ComponentType()==40)styles={};else{rows=rows*1.4;styles={minHeight:rows.toString()+"em"}}return Input.Input({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,inputComponent:React.DOM.textarea,shouldAutoSize:this.props.clientContext.isPhone,extraInputComponentStyles:styles,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null})};return MultilineInputSpec}(TsAdapter.SpecBase);exports.MultilineInput=TsAdapter.createComponent(new MultilineInputSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RichEditor/RichEditor",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="RichEditor";var RichEditorSpec=function(_super){__extends(RichEditorSpec,_super);function RichEditorSpec(){_super.apply(this,arguments);this.displayName="RichEditor";this.listenToProperties=["ReadOnly","HasFocus","HideToolbar","ShowLabel","Required","Recommended","ClassName"];this.rerenderProperties=["IsViewExpandable","ToolbarJSON","ExpandedToolbarJSON","HiddenToolbarJSON","LanguageCode","FallbackLanguageCode","LabelValue"];this.isforceWebkitLayer=false;this.isWebKitInertiaScroll=false}RichEditorSpec.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];if(!console||!console.log)return;console.log.call(console,arguments)};RichEditorSpec.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];if(!console)return;if(!console.warn)RichEditorSpec.log.call(this,arguments);else console.warn.call(console,arguments)};RichEditorSpec.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i-0]=arguments[_i];if(!console)return;if(!console.error)RichEditorSpec.warn.call(this,arguments);else console.error.call(console,arguments)};RichEditorSpec.notIn=function(elements,notInElements){for(var temp=[],i=0;i<elements.length;++i)notInElements.indexOf(elements[i])===-1&&temp.push(elements[i]);return temp};RichEditorSpec.parseToolbarJSON=function(json){if(!json)return [];try{var result=JSON.parse(json);if(!$.isArray(result))throw"toolbar JSON is not an array";return result}catch(err){RichEditorSpec.error("Error parsing JSON: "+err);RichEditorSpec.error("JSON: "+json);return []}};RichEditorSpec.handleStaticResize=function(){if(RichEditorSpec.resizing)return;RichEditorSpec.resizing=true;var tds=$("."+RichEditorSpec.classes.root).parent();tds.css("display","table-cell");CKEDITOR.document.getWindow().fire("resize");tds.css("display","");setTimeout(function(){return RichEditorSpec.resizing=false})};RichEditorSpec.prototype.componentWillMount=function(){this.id=++RichEditorSpec.idCount;this.expandTabIndex=this.props.dataContext.get_NextTabIndex();this.props.dataContext.set_NextTabIndex(this.expandTabIndex+1);this.editorTabIndex=this.props.dataContext.get_NextTabIndex();this.props.dataContext.set_NextTabIndex(this.editorTabIndex+1);this.expandAnchorSelector="div."+RichEditorSpec.classes.root+"#"+RichEditorSpec.rootPrefix+this.id+" > a."+RichEditorSpec.classes.expandAnchor+"#"+RichEditorSpec.expandPrefix+this.id;this.toolbarGroupSelector="#"+RichEditorSpec.rootPrefix+this.id+" "+RichEditorSpec.ckEditorToolbarClass;this.delayedHookupWithEditor();for(var i=0;i<this.rerenderProperties.length;++i)this.props.dataContext.AddPropertyChangedListener(this.rerenderProperties[i],this.forceRender);this.componentWillUpdate()};RichEditorSpec.prototype.delayedHookupWithEditor=function(){RichEditorSpec.editorLibraryLoaded=window.hasOwnProperty("CKEDITOR");if(RichEditorSpec.editorLibraryLoaded){CKEDITOR.disableAutoInline=true;CKEDITOR.on("ariaWidget",this.onShowDropDown);this.forceRender();RichEditorSpec.warn("RichEditor dependency is loaded.")}else Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(this.delayedHookupWithEditor,Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.ConductorItemLazyCreation,"RichEditor.LoadingCKEditor")};RichEditorSpec.prototype.componentWillUpdate=function(){this.unmountEditor()};RichEditorSpec.prototype.render=function(){var children=[exports.RichEditorBanner(this.props)];if(!RichEditorSpec.editorLibraryLoaded){RichEditorSpec.warn("RichEditor dependency is not yet loaded.");children.push(React.DOM.div({id:RichEditorSpec.rootPrefix+this.id,key:RichEditorSpec.rootPrefix+this.id},"---"))}else if(this.props.dataContext.get_IsViewExpandable()){var expand=React.DOM.a({key:RichEditorSpec.expandPrefix+this.id,id:RichEditorSpec.expandPrefix+this.id,className:CKEDITOR.env.hc?RichEditorSpec.classes.expandAnchor+" "+RichEditorSpec.classes.expandHC:RichEditorSpec.classes.expandAnchor,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.expandTabIndex:null,href:"#",onShortPress:this.onExpandClick,onKeyDown:this.onExpandKeyPress},[React.DOM.span({key:RichEditorSpec.expandIconPrefix+this.id,id:RichEditorSpec.expandIconPrefix+this.id,className:RichEditorSpec.classes.expandIcon}),React.DOM.span({key:RichEditorSpec.expandIconLabelPrefix+this.id,id:RichEditorSpec.expandIconLabelPrefix+this.id,className:RichEditorSpec.classes.expandIconLabel})]);children.unshift(expand)}return React.DOM.div({key:RichEditorSpec.rootPrefix+this.id,id:RichEditorSpec.rootPrefix+this.id,className:RichEditorSpec.classes.root,onShortPress:this.onFocus},children)};RichEditorSpec.prototype.componentDidMount=function(){var _this=this;this.props.dataContext.AddPropertyChangedListener("ModelContext",this.handleModelContextChange);this.props.dataContext.AddPropertyChangedListener("ClientApi_Data",this.handleDataSet);this.props.dataContext.AddPropertyChangedListener("RecordUpdate",this.handleDataSet);Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().get_device().get_DeviceState().AddPropertyChangedListener("AppBarVisible",this.onAppBarChange);this.bodyClickHandlerId=this.bodyClickHandlerId||RichEditorSpec.CLICK_HANDLER_ID_PREFIX+this.props.dataContext.get_ViewModelId();$(document).on("click."+this.bodyClickHandlerId,this.onBodyClick);this.controlClickHandlerId=this.controlClickHandlerId||RichEditorSpec.CONTROL_CLICK_HANDLER_ID_PREFIX+this.props.dataContext.get_ViewModelId();this.windowResizeHandlerId=this.windowResizeHandlerId||RichEditorSpec.RESIZE_HANDLER_ID_PREFIX+this.props.dataContext.get_ViewModelId();$(window).on("resize."+this.windowResizeHandlerId,function(){setTimeout(function(){_this.handleWindowResize()})});this.componentDidUpdate()};RichEditorSpec.prototype.componentDidUpdate=function(){var _this=this;this.element=ReactDOM.findDOMNode(this);this.setParentClasses();$(this.element).parents("."+RichEditorSpec.classes.control).on("click."+this.controlClickHandlerId,function(){_this.onFocus()});this.mountEditor()};RichEditorSpec.prototype.componentWillUnmount=function(){if(!RichEditorSpec.editorLibraryLoaded)return;this.expanded&&this.onExpandClick();this.props.dataContext.RemovePropertyChangedListener("ModelContext",this.handleModelContextChange);this.props.dataContext.RemovePropertyChangedListener("ClientApi_Data",this.handleDataSet);this.props.dataContext.RemovePropertyChangedListener("RecordUpdate",this.handleDataSet);Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().get_device().get_DeviceState().RemovePropertyChangedListener("AppBarVisible",this.onAppBarChange);CKEDITOR.removeListener("expanding",this.onOtherEditorInstanceExpanding);if(this.bodyClickHandlerId){$(document).off("click."+this.bodyClickHandlerId);this.bodyClickHandlerId=null}this.controlClickHandlerId&&$(this.element).parents("."+RichEditorSpec.classes.control).off("click."+this.controlClickHandlerId);if(this.windowResizeHandlerId){$(window).off("resize."+this.windowResizeHandlerId);this.windowResizeHandlerId=null}this.isHiddenInterval&&clearInterval(this.isHiddenInterval);CKEDITOR.removeListener("ariaWidget",this.onShowDropDown);for(var i=0;i<this.rerenderProperties.length;++i)this.props.dataContext.RemovePropertyChangedListener(this.rerenderProperties[i],this.forceRender);this.unmountEditor()};RichEditorSpec.prototype.componentWillReceiveProps=function(){if(!RichEditorSpec.editorLibraryLoaded)return;if(!this.editorLoaded)this.mountEditor();else{var hasToolbarGroups=(this.expanded?this.expandedToolbar.length:this.toolbar.length)>0,hasFocus=this.props.dataContext.get_HasFocus(),readOnly=this.props.dataContext.get_ReadOnly()||!hasToolbarGroups,hideToolbar=this.props.dataContext.get_HideToolbar(),inSourceView=this.editor.mode!=="wysiwyg";readOnly&&inSourceView&&this.editor.setMode("wysiwyg");this.editor.readOnly!==readOnly&&this.editor.setReadOnly(readOnly);if(readOnly||!hasToolbarGroups||hideToolbar&&!hasFocus&&!inSourceView&&!this.dialogShowing&&!this.expanded)this.hideToolbar();else this.showToolbar();this.setParentClasses();this.handleWindowResize()}};RichEditorSpec.prototype.shouldComponentUpdate=function(){return !RichEditorSpec.editorLibraryLoaded};RichEditorSpec.prototype.setReadOnly=function(isReadOnly){this.props.dataContext.set_ReadOnly(isReadOnly)};RichEditorSpec.prototype.forceRender=function(){this.forceUpdate()};RichEditorSpec.prototype.mountEditor=function(){var _this=this;if(this.mountingEditor||!RichEditorSpec.editorLibraryLoaded)return;this.unmountEditor();this.mountingEditor=true;this.toolbar=RichEditorSpec.parseToolbarJSON(this.props.dataContext.get_ToolbarJSON());this.expandedToolbar=RichEditorSpec.parseToolbarJSON(this.props.dataContext.get_ExpandedToolbarJSON());this.hiddenToolbar=RichEditorSpec.parseToolbarJSON(this.props.dataContext.get_HiddenToolbarJSON());var toolbars=[].concat(this.toolbar).concat(this.expandedToolbar).concat(this.hiddenToolbar),config={on:{change:function(){if(_this.props.dataContext.get_DataSet())return;_this.dataChanged=true;var content=_this.editor.getData(),data=_this.props.dataContext.get_Data(),readOnly=_this.props.dataContext.get_ReadOnly();if(!readOnly&&(data===null?content!=="":content!==null&&content!==data)){_this.props.dataContext.set_SettingData(true);_this.props.dataContext.set_Data(content)}},beforeModeUnload:function(){_this.modeChanging=true},mode:function(){_this.modeChanging=false;_this.componentWillReceiveProps();_this.handleCodeMirrorResize()},beforeShowDialog:function(evt){return _this.props.dataContext.get_ShowDialogs()||evt.data==="a11yHelp"},dialogShow:function(){_this.dialogShowing=true;_this.componentWillReceiveProps()},dialogHide:function(){setTimeout(function(){_this.dialogShowing=false;_this.componentWillReceiveProps()})},instanceReady:function(ev){_this.editorLoaded=true;_this.mountingEditor=false;_this.handleModelContextChange();if(_this.props.dataContext.get_IsViewExpandable())_this.expanded&&_this.onExpandClick();_this.toggleToolbarState();_this.componentWillReceiveProps();_this.handleWindowResize();_this.dataChanged&&_this.editor.resetUndo();_this.props.dataContext.get_DataSet()&&_this.handleDataSet();CKEDITOR.env.ie&&CKEDITOR.env.version==10&&$("iframe.cke_wysiwyg_frame").contents().on("click",function(){var ed=ev.editor;ed.editable().focus()})},loaded:function(){_this.hideToolbar();var toolbars=$(_this.toolbarGroupSelector);toolbars.last().addClass("last");toolbars.length&&_this.toolbar.length&&$(toolbars[_this.toolbar.length-1]).addClass("last");$("#"+_this.editor.id+RichEditorSpec.ckEditorContents).removeAttr("style")},click:function(){_this.onFocus()},focus:function(){_this.onFocus()}},readOnly:this.props.dataContext.get_ReadOnly(),skin:$(".interactionCentricMainContainer").length>0?"crmflat":"crmflatMoca",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.editorTabIndex:null,title:this.props.dataContext.get_LabelValue(),toolbar:toolbars,toolbarCanCollapse:false,toolbarStartupExpanded:true,language:this.props.dataContext.get_LanguageCode(),defaultLanguage:this.props.dataContext.get_FallbackLanguageCode()};if(CKEDITOR.env.edge&&CKEDITOR.env.version<13.10586)config.removePlugins="codemirror";config.disableNativeSpellChecker=false;var data=this.props.dataContext.get_Data()||"";if(data){this.dataChanged=true;this.props.dataContext.set_DataSet(false)}this.editor=CKEDITOR.appendTo(RichEditorSpec.rootPrefix+this.id,config,data);this.editor.focusManager.add(new CKEDITOR.dom.element(this.element),true);this.toolbarSelector="#"+this.editor.id+RichEditorSpec.ckEditorToolbarTop;this.codeMirrorSelector="."+this.editor.id+" .CodeMirror"};RichEditorSpec.prototype.unmountEditor=function(){if(this.editor&&this.editor.status!=="destroyed"){this.editor.destroy(true);delete this.editor}this.editorLoaded=false;this.mountingEditor=false;this.settingData=false;this.dialogShowing=false;this.modeChanging=false};RichEditorSpec.prototype.handleModelContextChange=function(){this.dataChanged=false;!this.editorLoaded&&this.mountEditor();this.componentWillReceiveProps()};RichEditorSpec.prototype.handleDataSet=function(){var _this=this;if(!this.editorLoaded||this.settingData)return;var data=this.props.dataContext.get_Data()||"",content=this.editor.getData()||"";if(data===content)return;this.settingData=true;this.editor.setData(data,{noSnapshot:false,callback:function(){_this.settingData=false;if((_this.props.dataContext.get_Data()||"")!==data){_this.handleDataSet();return}_this.props.dataContext.set_DataSet(false);if(!_this.dataChanged){_this.editor.resetUndo();if(data)_this.dataChanged=true}_this.componentWillReceiveProps()}})};RichEditorSpec.prototype.onFocus=function(e){this.props.dataContext.set_HasFocus(true)};RichEditorSpec.prototype.onBodyClick=function(e){var _this=this;if(!RichEditorSpec.editorLibraryLoaded||!this.editorLoaded)return;if(!this.isHiddenInterval&&$(this.element).is(":hidden"))this.isHiddenInterval=setInterval(function(){if(!$(_this.element).is(":hidden")){clearInterval(_this.isHiddenInterval);_this.isHiddenInterval=0;setTimeout(function(){_this.handleWindowResize()})}},100);if(this.dialogShowing||this.modeChanging){this.props.dataContext.set_HasFocus(true);return}var target=$(e.target),match=target.closest($(this.element).parents("."+RichEditorSpec.classes.control).get(0));if(!match||match.length==0){this.editor.focusManager.blur(true);this.props.dataContext.set_HasFocus(false)}};RichEditorSpec.prototype.onExpandKeyPress=function(e){e.key==="Enter"&&this.onExpandClick(e)};RichEditorSpec.prototype.onExpandClick=function(e){this.editor.plugins.expand.expandEditorInstance(this.editor);this.expanded=this.editor.expanded;if(this.expanded){CKEDITOR.fire("expanding",undefined,this.editor);CKEDITOR.on("expanding",this.onOtherEditorInstanceExpanding);if($(this.element).parents(".panoramaItem-content.forceWebkitLayer").length){this.isforceWebkitLayer=true;$(this.element).parents(".panoramaItem-content").removeClass("forceWebkitLayer")}if($(this.element).parents(".panoramaItem-content.panoramaItem-content_scrollable.webkitInertiaScroll").length&&this.props.clientContext.userAgent.get_IsIPad()){this.isWebKitInertiaScroll=true;$(this.element).parents(".panoramaItem-content.panoramaItem-content_scrollable").removeClass("webkitInertiaScroll");$(this.element).parents(".panoramaContainer.webkitInertiaScroll").length&&$(this.element).parents(".panoramaContainer").removeClass("webkitInertiaScroll")}}else{this.isforceWebkitLayer&&$(this.element).parents(".panoramaItem-content").addClass("forceWebkitLayer");if(this.isWebKitInertiaScroll&&this.props.clientContext.userAgent.get_IsIPad()){$(this.element).parents(".panoramaItem-content.panoramaItem-content_scrollable").addClass("webkitInertiaScroll");$(this.element).parents(".panoramaContainer").addClass("webkitInertiaScroll");this.isWebKitInertiaScroll=false}CKEDITOR.removeListener("expanding",this.onOtherEditorInstanceExpanding)}$(this.element).parents(".scrollRegion").css("transform",this.expanded?"none":"").css("overflow",this.expanded?"hidden":"");this.toggleToolbarState();this.componentWillReceiveProps();this.handleWindowResize()};RichEditorSpec.prototype.onShowDropDown=function(evt){if(!this.editorLoaded||!$(evt.data.$).parent().is("."+this.editor.id))return;this.dropdownShown=true};RichEditorSpec.prototype.onOtherEditorInstanceExpanding=function(evt){if(evt.editor===this.editor||!this.expanded)return;try{this.onExpandClick()}catch(err){evt.removeListener()}};RichEditorSpec.prototype.onAppBarChange=function(deviceState,eventName){this.setParentClasses();this.handleWindowResize()};RichEditorSpec.prototype.handleWindowResize=function(){if(!RichEditorSpec.editorLibraryLoaded||!this.editorLoaded)return;this.handleToolbarReflow();this.updateEditableHeight();this.handleCodeMirrorResize();!this.dropdownShown&&RichEditorSpec.handleStaticResize();this.dropdownShown=false};RichEditorSpec.prototype.handleToolbarReflow=function(){var positions=[],toolbars=$(this.toolbarGroupSelector).removeClass(RichEditorSpec.lastToolbarLineGroup).not(":hidden");toolbars.each(function(index,element){positions.push($(this).position())});for(var i=0;i<positions.length;++i)(i===positions.length-1||positions[i].top<positions[i+1].top)&&$(toolbars.get(i)).addClass(RichEditorSpec.lastToolbarLineGroup)};RichEditorSpec.prototype.updateEditableHeight=function(){var root=$(this.element),controlValue=root.parent(),controlRoot=controlValue.parent(),padding=controlRoot.outerHeight()-controlRoot.height();controlValue.css("height",this.expanded?"":controlRoot.height()-controlValue.position().top+padding+"px");var editorRoot=root.children(".cke");editorRoot.height(root.height()-editorRoot.position().top);var innerRoot=editorRoot.children(".cke_inner"),contents=innerRoot.children(".cke_contents");contents.height(innerRoot.height()-contents.position().top)};RichEditorSpec.prototype.handleCodeMirrorResize=function(){if(this.editor.mode==="source"){var codeMirror=$(this.codeMirrorSelector);codeMirror.hide();this.editor.resize();codeMirror.show();this.editor.resize()}};RichEditorSpec.prototype.toggleToolbarState=function(){var toolbars=$(this.toolbarGroupSelector),collapsedToolbar=toolbars.slice(0,this.toolbar.length),expandedToolbar=toolbars.slice(this.toolbar.length,this.toolbar.length+this.expandedToolbar.length),hiddenToolbar=toolbars.slice(this.toolbar.length+this.expandedToolbar.length);if(this.props.dataContext.get_IsViewExpandable()){var anchor=$(this.expandAnchorSelector),icon=anchor.find("span."+RichEditorSpec.classes.expandIcon),iconLabel=anchor.find("span."+RichEditorSpec.classes.expandIconLabel);if(this.expanded){anchor.attr("title",this.editor.lang.expand.collapse);iconLabel.text(this.editor.lang.expand.collapse);icon.addClass(RichEditorSpec.ckEditorCollapseIconClass).removeClass(RichEditorSpec.ckEditorExpandIconClass);collapsedToolbar.hide();expandedToolbar.show()}else{anchor.attr("title",this.editor.lang.expand.expand);iconLabel.text(this.editor.lang.expand.expand);icon.addClass(RichEditorSpec.ckEditorExpandIconClass).removeClass(RichEditorSpec.ckEditorCollapseIconClass);expandedToolbar.hide();collapsedToolbar.show()}}else expandedToolbar.hide();hiddenToolbar.hide();this.handleToolbarReflow()};RichEditorSpec.prototype.showToolbar=function(){var toolbar=$(this.toolbarSelector);if(toolbar.is(":hidden")){toolbar.show();this.handleToolbarReflow();this.updateEditableHeight()}};RichEditorSpec.prototype.hideToolbar=function(){var toolbar=$(this.toolbarSelector);if(!toolbar.is(":hidden")){toolbar.hide();this.updateEditableHeight()}};RichEditorSpec.prototype.setParentClasses=function(){var root=$(this.element),table=root.parents("table.sectionLayout:first"),sectionLabel=root.parents(".section").find(".section_label").add(table.prev(".icform_section_label")),sectionControl=root.parents(".section_control"),add=[];if(this.expanded){var formHeader=root.parents(".rootViewControl_content, .RootView-interactionCentricForm").children(".formHeaderContainer").find(".formHeaderContent"),processHeader=formHeader.children(".processHeaderContainer, .processHeaderContainerDesktop, .proxyProcessHeader"),tabNavigator=formHeader.children(".radio-button-group");add.push(RichEditorSpec.classes.expanded);processHeader.length!==0&&processHeader.not(":hidden").length!==0&&add.push(RichEditorSpec.classes.process);tabNavigator.length!==0&&tabNavigator.not(":hidden").length!==0&&add.push(RichEditorSpec.classes.tabs);Microsoft.Crm.Client.Core.Framework.PAL.Core.NativeBridge.get_Instance().get_device().get_DeviceState().AppBarVisible&&add.push(RichEditorSpec.classes.appBar)}var modelContext=this.props.dataContext.get_ModelContext();modelContext&&modelContext.get_ModelName()&&add.push(modelContext.get_ModelName());this.props.dataContext.get_ClassName()&&add.push.apply(add,this.props.dataContext.get_ClassName().split(" "));var label=add.slice(0).concat([RichEditorSpec.classes.sectionLabel]),control=add.slice(0).concat([RichEditorSpec.classes.control]);this.props.dataContext.get_ShowLabel()&&label.push(RichEditorSpec.classes.controlLabeled);sectionLabel.length&&control.push(RichEditorSpec.classes.sectionLabeled);this.props.dataContext.get_HasFocus()&&control.push(RichEditorSpec.classes.focused);this.props.dataContext.get_IsViewExpandable()&&control.push(RichEditorSpec.classes.expandable);this.props.dataContext.get_Recommended()&&control.push(RichEditorSpec.classes.recommended);this.props.dataContext.get_Required()&&control.push(RichEditorSpec.classes.required);this.props.dataContext.get_ReadOnly()&&control.push(RichEditorSpec.classes.locked);table.addClass(RichEditorSpec.classes.sectionTable);sectionLabel.removeClass(RichEditorSpec.notIn(RichEditorSpec.allClasses,label).join(" ")).addClass(label.join(" "));sectionControl.removeClass(RichEditorSpec.notIn(RichEditorSpec.allClasses,control).join(" ")).addClass(control.join(" "))};RichEditorSpec.editorLibraryLoaded=window.hasOwnProperty("CKEDITOR");RichEditorSpec.resizing=false;RichEditorSpec.idCount=0;RichEditorSpec.classes={sectionTable:"re_section",sectionLabel:"re_sectionLabel",controlLabeled:"re_hasControlLabel",sectionLabeled:"re_hasSectionLabel",control:"re_control",root:"richEditor",expandAnchor:"expandEditor",expandHC:"expandHC",expandIcon:"expandEditorIcon",expandIconLabel:"expandEditorIconLabel",focused:"re_focused",expanded:"expanded",expandable:"re_expandable",process:"re_hasProcessHeader",tabs:"re_hasTabNavigator",appBar:"re_hasAppBar",locked:"re_locked",required:"re_required",recommended:"re_recommended"};RichEditorSpec.allClasses=function(){var temp=[],tempList=RichEditorSpec.classes;for(var i in tempList)temp.push(tempList[i]);return temp}();RichEditorSpec.rootPrefix=RichEditorSpec.classes.root+"-";RichEditorSpec.expandPrefix=RichEditorSpec.classes.expandAnchor+"-";RichEditorSpec.expandIconPrefix=RichEditorSpec.classes.expandIcon+"-";RichEditorSpec.expandIconLabelPrefix=RichEditorSpec.classes.expandIconLabel+"-";RichEditorSpec.lastToolbarLineGroup="re_toolbarLineLast";RichEditorSpec.ckEditorPrefix="#cke";RichEditorSpec.ckEditorToolbarTop="_top";RichEditorSpec.ckEditorContents="_contents";RichEditorSpec.ckEditorToolbarClass=".cke_toolbar";RichEditorSpec.ckEditorExpandIconClass="cke_button__expand_icon";RichEditorSpec.ckEditorCollapseIconClass="cke_button__collapse_icon";RichEditorSpec.CLICK_HANDLER_ID_PREFIX="REclick";RichEditorSpec.CONTROL_CLICK_HANDLER_ID_PREFIX="REclickControl";RichEditorSpec.RESIZE_HANDLER_ID_PREFIX="REresize";return RichEditorSpec}(TsAdapter.SpecBase),RichEditorBannerSpec=function(_super){__extends(RichEditorBannerSpec,_super);function RichEditorBannerSpec(){_super.apply(this,arguments);this.displayName="RichEditorBanner";this.listenToProperties=["ModelContext","RecordUpdate"]}RichEditorBannerSpec.prototype.render=function(){if(!this.modelIsEmail()||!this.descriptionIsUnsafe())return React.DOM.div({className:RichEditorBannerSpec.bannerClass,key:RichEditorBannerSpec.bannerClass,style:{display:"none"}});return React.DOM.div({className:RichEditorBannerSpec.bannerClass,key:RichEditorBannerSpec.bannerClass},[React.DOM.span({key:RichEditorBannerSpec.messageClass,className:RichEditorBannerSpec.messageClass},this.props.dataContext.get_MaliciousContentMessage()),React.DOM.a({key:RichEditorBannerSpec.linkClass,className:RichEditorBannerSpec.linkClass,onClick:this.handleFullContentLinkClick},this.props.dataContext.get_OpenMaliciousContentMessage())])};RichEditorBannerSpec.prototype.descriptionIsUnsafe=function(){var modelContext=this.props.dataContext.get_ModelContext();if(!modelContext)return false;var isUnsafe=modelContext.GetValue("isunsafe");return isUnsafe!=null&&isUnsafe==1};RichEditorBannerSpec.prototype.modelIsEmail=function(){var modelContext=this.props.dataContext.get_ModelContext();return modelContext&&modelContext.get_ModelName()=="email"};RichEditorBannerSpec.prototype.handleFullContentLinkClick=function(){var command=this.props.dataContext.get_ViewFullContentCommand();command&&command.get_CanExecute()&&command.execute()};RichEditorBannerSpec.bannerClass="maliciousContentDiv";RichEditorBannerSpec.messageClass="maliciousContentMessage";RichEditorBannerSpec.linkClass="linkToFullDescription";return RichEditorBannerSpec}(TsAdapter.SpecBase);exports.RichEditor=DataWrapperComponent.wrapComponent(new RichEditorSpec);exports.RichEditorBanner=DataWrapperComponent.wrapComponent(new RichEditorBannerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/HitHighlightValueLabel",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="HitHighlightValueLabel";exports.RENDERED_PROPERTY_NAME="Data";exports.DEFAULT_VALUE_MASK="---";var HitHighlightValueLabelSpec=function(_super){__extends(HitHighlightValueLabelSpec,_super);function HitHighlightValueLabelSpec(){_super.apply(this,arguments);this.displayName="HitHighlightValueLabel";this.listenToProperties=[exports.RENDERED_PROPERTY_NAME]}HitHighlightValueLabelSpec.prototype.trimWhitespaces=function(text){if(!text)return text;if(typeof text=="string")return text.replace(/\s+/g," ").trim();return text};HitHighlightValueLabelSpec.prototype.render=function(){var text=exports.DEFAULT_VALUE_MASK;if(this.props.dataContext){var modelValue=this.props.dataContext.get_Data();if(modelValue){text=modelValue;if(this.props.clientContext.isInteractionCentric)text=this.trimWhitespaces(text)}}text=this.props.dataContext.processHitHighlight(this.props.dataContext.get_ModelContext().get_Id(),this.props.dataContext.get_Name(),text,this.props.parentList.get_HitHighlightInfo());if(text==exports.DEFAULT_VALUE_MASK)return React.DOM.noscript();else if(this.props.dataContext&&this.props.dataContext.get_UseHTMLFormat())return React.DOM.span({dangerouslySetInnerHTML:{__html:text}});else return React.DOM.span(null,text)};return HitHighlightValueLabelSpec}(TsAdapter.SpecBase);exports.HitHighlightValueLabel=DataWrapperComponent.wrapComponent(new HitHighlightValueLabelSpec)});define("Components/ComponentFactory",["require","exports","Components/Common/DefaultValueLabel","Components/Common/DynamicsButton","Components/Common/FieldButton","Components/Common/FlyOutButton","Components/Common/Image","Components/Common/Label","Components/Common/Group","Components/Common/Section","Components/Common/Input","Components/Common/MultilineInput","Components/RichEditor/RichEditor","Components/Search/HitHighlightValueLabel"],function(require,exports,DefaultValueLabel,DynamicsButton,FieldButton,FlyOutButton,Image,Label,Group,Section,Input,MultilineInput,RichEditor,HitHighlightValueLabel){var factoryNameMap={};function registerComponentFactory(descriptorName,factory){descriptorName in factoryNameMap&&factoryNameMap[descriptorName]!==factory&&console.warn("Descriptor name '"+descriptorName+"' already registered for different factory, overriding the previous value.");factoryNameMap[descriptorName]=factory}exports.registerComponentFactory=registerComponentFactory;registerComponentFactory(DefaultValueLabel.DESCRIPTOR_NAME,DefaultValueLabel.DefaultValueLabel);registerComponentFactory(DynamicsButton.DESCRIPTOR_NAME,DynamicsButton.DynamicsButton);registerComponentFactory(DynamicsButton.DESCRIPTOR_NAME2,DynamicsButton.DynamicsButton);registerComponentFactory(DynamicsButton.DESCRIPTOR_NAME3,DynamicsButton.DynamicsButton);registerComponentFactory(FieldButton.DESCRIPTOR_NAME,FieldButton.FieldButton);registerComponentFactory(Image.DESCRIPTOR_NAME,Image.Image);registerComponentFactory(Label.DESCRIPTOR_NAME,Label.Label);registerComponentFactory(FlyOutButton.DESCRIPTOR_NAME,FlyOutButton.FlyOutButton);registerComponentFactory(Group.DESCRIPTOR_NAME,Group.Group);registerComponentFactory(Section.DESCRIPTOR_NAME,Section.Section);registerComponentFactory(Input.DESCRIPTOR_NAME,Input.Input);registerComponentFactory(MultilineInput.DESCRIPTOR_NAME,MultilineInput.MultilineInput);registerComponentFactory(RichEditor.DESCRIPTOR_NAME,RichEditor.RichEditor);registerComponentFactory(HitHighlightValueLabel.DESCRIPTOR_NAME,HitHighlightValueLabel.HitHighlightValueLabel);function getFactoryForControlName(descriptorName){if(descriptorName in factoryNameMap)return factoryNameMap[descriptorName];console.warn("Unrecognized type name in component factory: "+descriptorName);return null}exports.getFactoryForControlName=getFactoryForControlName;function createChildComponents(viewModel,viewDescriptor,clientContext,interceptor,listViewModel){if(viewModel&&(!viewDescriptor||viewDescriptor.Properties&&viewDescriptor.Properties["IsViewModelBased"]))return createChildComponentsFromViewModel(viewModel,clientContext,interceptor);if(viewDescriptor&&viewDescriptor.ChildControlViewDescriptors)if(listViewModel)return createChildComponentsFromDescriptor(viewModel,viewDescriptor,clientContext,interceptor,listViewModel);else return createChildComponentsFromDescriptor(viewModel,viewDescriptor,clientContext,interceptor);return []}exports.createChildComponents=createChildComponents;function createChildComponentsFromViewModel(viewModel,clientContext,interceptor){var viewModels=[],childViewModels=viewModel.get_ChildViewModels();for(var key in childViewModels){var child=childViewModels[key];viewModels.push(child)}return createComponentsFromViewModels(viewModels,clientContext,interceptor)}function createComponentsFromViewModels(viewModels,clientContext,interceptor){for(var children=[],childCount=0,callingContext="createComponentsFromViewModels",i=0,len=viewModels.length;i<len;i++){var child=viewModels[i],typeName=clientContext.childControlTypeNameResolver(child);childCount++;var descriptor={__type:"Control",BindingPath:child.get_Id(),TypeName:typeName,ChildControlViewDescriptors:null,Properties:{IsViewModelBased:true}};createComponent(typeName,child.get_ViewModelId(),child,descriptor,children,clientContext,interceptor,descriptor.TypeName,childCount.toString(),callingContext)}return children}exports.createComponentsFromViewModels=createComponentsFromViewModels;function createCustomComponent(viewModel,key,viewDescriptor,clientContext){var children=[];createComponent(viewDescriptor.TypeName,key,viewModel,viewDescriptor,children,clientContext,null);if(children.length>0)return children[0];else return null}exports.createCustomComponent=createCustomComponent;function createChildComponentsFromDescriptor(viewModel,viewDescriptor,clientContext,interceptor,listViewModel){if(!viewModel)return null;var children=[],childViewModels=viewModel.get_ChildViewModels(),childCount=0,callingContext="createChildComponentsFromDescriptor";for(var childKey in viewDescriptor.ChildControlViewDescriptors){var childDescriptor=viewDescriptor.ChildControlViewDescriptors[childKey];childCount++;if(childDescriptor.__type==="Control"){var controlDescriptor=childDescriptor,childViewModel=childViewModels&&childViewModels[controlDescriptor.BindingPath],parentViewDescriptor=viewDescriptor,parentBindPath=parentViewDescriptor.BindingPath+"_"+parentViewDescriptor.TypeName;createComponent(controlDescriptor.TypeName,childKey,childViewModel,controlDescriptor,children,clientContext,interceptor,parentBindPath,childCount.toString(),callingContext,listViewModel)}}return children}function createComponent(controlName,key,dataContext,descriptor,output,clientContext,interceptor,ParentName,dataSeqId,callContext,listViewModel){var props,factory=getFactoryForControlName(controlName);if(factory){if(ParentName&&dataSeqId){var dataSeqParam=ParentName+"_"+controlName+"_"+dataSeqId;if(callContext==="createChildComponentsFromDescriptor")if(listViewModel)props={key:key,parentGivenKey:key,clientContext:clientContext,dataContext:dataContext,descriptor:descriptor,dataId:dataSeqParam,dataSeq:dataSeqParam,parentList:listViewModel};else props={key:key,parentGivenKey:key,clientContext:clientContext,dataContext:dataContext,descriptor:descriptor,dataId:dataSeqParam,dataSeq:dataSeqParam};else props={key:key,parentGivenKey:key,clientContext:clientContext,dataContext:dataContext,descriptor:descriptor,dataSeq:dataSeqParam}}else props={key:key,parentGivenKey:key,clientContext:clientContext,dataContext:dataContext,descriptor:descriptor};if(interceptor){var component=interceptor(factory,props);component&&output.push(component)}else output.push(factory(props))}}});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/TestHooksDiv",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){var TestHooksDivSpec=function(_super){__extends(TestHooksDivSpec,_super);function TestHooksDivSpec(){_super.apply(this,arguments);this.displayName="TestHooksDiv";this.listenToProperties=["TestabilityAttributes"]}TestHooksDivSpec.prototype.render=function(){var props={};for(var prop in this.props)if(this.props.hasOwnProperty(prop)&&prop!=="children")props[prop]=this.props[prop];var testabilityAttributes=this.props.dataContext.get_TestabilityAttributes();for(var key in testabilityAttributes)if(testabilityAttributes.hasOwnProperty(key))props[key]=testabilityAttributes[key];return React.DOM.div(props,this.props.children)};return TestHooksDivSpec}(TsAdapter.SpecBase);exports.TestHooksDiv=DataWrapperComponent.wrapComponent(new TestHooksDivSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/UIHasRenderedMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var UIHasRenderedMixin=function(_super){__extends(UIHasRenderedMixin,_super);function UIHasRenderedMixin(){_super.apply(this,arguments)}UIHasRenderedMixin.prototype.componentDidMount=function(){this.props.dataContext&&this.props.dataContext.UIHasRendered()};UIHasRenderedMixin.prototype.componentDidUpdate=function(){this.props.dataContext&&!this.skipComponentDidUpdateHasRenderedCall&&this.props.dataContext.UIHasRendered()};return UIHasRenderedMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new UIHasRenderedMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/PageSearchHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Primitives/FontIcon","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,DataWrapperComponent,Button,FontIcon,IXUD){exports.DESCRIPTOR_NAME="PageSearchHeader";var PageSearchHeaderSpec=function(_super){__extends(PageSearchHeaderSpec,_super);function PageSearchHeaderSpec(){_super.apply(this,arguments);this.displayName="PageSearchHeader";this.mixins=[IXUD.Mixin];this.listenToProperties=["Enabled"]}PageSearchHeaderSpec.prototype.handleClick=function(e){e.stopPropagation();(this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()||this.props.dataContext.get_IsMobileClientOfflineFeatureAvailable())&&this.props.dataContext.HandleSearchButtonClick()};PageSearchHeaderSpec.prototype.render=function(){if(!this.props.dataContext.get_Enabled())return React.DOM.noscript();return React.DOM.div({className:"searchIconContainer"},Button.Button({className:"searchHeaderButton",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_SearchButtonTabIndex():null,title:this.props.dataContext.get_SearchButtonToolTip(),dataId:"searchImage",onClick:this.handleClick},FontIcon.FontIcon({symbolName:"SearchButton"})))};PageSearchHeaderSpec.prototype.getProperties=function(){var properties={};properties["id"]=this.props.dataId;return properties};return PageSearchHeaderSpec}(TsAdapter.SpecBase);exports.PageSearchHeader=DataWrapperComponent.wrapComponent(new PageSearchHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ComboBox",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Constants","Utils/CssClassSet","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,Constants,CssClassSet,AccessibilityUtility){exports.DESCRIPTOR_NAME="ComboBox";var ComboBoxSpec=function(_super){__extends(ComboBoxSpec,_super);function ComboBoxSpec(){_super.apply(this,arguments);this.displayName=exports.DESCRIPTOR_NAME;this.listenToProperties=["ItemsList","SelectedItem","AllowEdit","OptionSetLoaded","Enabled","Label","ShowLabel"];this.maxComboBoxSize=10;this.screenReaderTextForComboBox=function(index){var screenReaderText="",recordNum=parseInt(index)+1,optionsList=this.props.dataContext.get_ItemsList(),totalRecords=optionsList.length;screenReaderText=this.props.dataContext.fetchScreenReadableText(recordNum,totalRecords,null,true);return screenReaderText}}ComboBoxSpec.prototype.getDefaultProps=function(){return {dismissOnSelectionChange:true,disabled:false}};ComboBoxSpec.prototype.itemOnKeyDownHandler=function(e){var currentElement=e.target,controlType="";if(this.props.descriptor!=undefined)controlType=AccessibilityUtility.getScreenReaderTypeName(this.props.descriptor.TypeName);var screenReaderText="";switch(e.keyCode){case Constants.TAB_KEY_CODE:screenReaderText=this.props.dataContext.comboBoxScreenReaderText(controlType,this.props.dataContext.get_Label(),this.props.dataContext.get_ItemsList().length.toString());this.setState({screenReaderAriaText:screenReaderText?screenReaderText:""});e.shiftKey&&AccessibilityUtility.handleShiftTabAndFocusParentSectionControl(ReactDOM.findDOMNode(this),e);break;case Constants.ENTER_KEY_CODE:if(currentElement){var domNode=ReactDOM.findDOMNode(this),index=$(currentElement).find("option:selected").attr("data-seq"),indexNumber=parseInt(index),optionList=this.props.dataContext.get_ItemsList(),optionName=optionList[indexNumber].get_Label();screenReaderText=this.props.dataContext.comboBoxSelectedScreenReaderText(indexNumber+1,optionName);$(domNode)&&$(domNode).parents(".section_control").attr("aria-label",screenReaderText)}break;case Constants.F8_KEY_CODE:this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey);break}};ComboBoxSpec.prototype.onSelectionChanged=function(event){if(event&&event.target){var target=event.target,currentElement=event.target;this.props.dataContext.set_SelectedItem(target.value);if(currentElement){var index=$(currentElement).find("option:selected").attr("data-seq");this.setState({screenReaderAriaText:this.screenReaderTextForComboBox(index)})}}};ComboBoxSpec.prototype.handleMouseWheel=function(event){event.stopPropagation()};ComboBoxSpec.prototype.getInitialState=function(){return {screenReaderAriaText:"",showAsListStyle:true}};ComboBoxSpec.prototype.componentWillMount=function(){this.activeElementBeforeOpening=document.activeElement};ComboBoxSpec.prototype.componentDidMount=function(){if(this.props.handleFocusInDidMount&&this.props.dataContext.get_IsInteractionCentricEnabled()&&this.props.dataContext.get_FocusComboBox()){var comboBox=this.refs["comboBoxRef"];comboBox instanceof Element&&$(comboBox).focus();this.props.dataContext.set_FocusComboBox(false)}};ComboBoxSpec.prototype.componentWillUnmount=function(){this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};ComboBoxSpec.prototype.renderOptions=function(options){for(var optionComponents=[],i=0;i<options.length;i++){var value=options[i].get_ValueString(),label=options[i].get_Label(),screenReaderText=this.props.dataContext.fetchScreenReadableText(i+1,options.length,label,false),newOption=React.DOM.option({value:value,label:label,key:i.toString(),"data-seq":this.props.dataContext.get_IsInteractionCentricEnabled()?i.toString():null,"aria-label":this.props.dataContext.get_IsInteractionCentricEnabled()&&screenReaderText?screenReaderText:null},label);optionComponents.push(newOption)}return optionComponents};ComboBoxSpec.prototype.render=function(){var children=[];this.props.dataContext.get_IsInteractionCentricEnabled()&&!this.props.dataContext.get_FocusComboBox()&&this.props.dataContext.set_FocusComboBox(true);if(this.props.dataContext.get_ShowLabel()){var label=React.DOM.span({key:"label",className:"label"},this.props.dataContext.get_Label());children.push(label)}var selectChildren=this.renderOptions(this.props.dataContext.get_ItemsList()),selectedItem=this.props.dataContext.get_SelectedItem(),screenReaderText="";if(this.props.descriptor!=undefined){var controlType=AccessibilityUtility.getScreenReaderTypeName(this.props.descriptor.TypeName);screenReaderText=this.props.dataContext.comboBoxScreenReaderText(controlType,this.props.dataContext.get_Label(),this.props.dataContext.get_ItemsList().length.toString())}var renderAsDropDownForCurrentAgent=!this.props.clientContext.userAgent.get_PALEnabled()||this.props.clientContext.userAgent.get_IsWindows()||this.props.clientContext.userAgent.get_IsMailApp(),selectProps={key:"comboBox",ref:"comboBoxRef",className:CssClassSet({comboBox:true,comboBoxSingleLine:!renderAsDropDownForCurrentAgent}),onChange:this.onSelectionChanged,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.itemOnKeyDownHandler:null,onWheel:this.handleMouseWheel,onDismiss:this.props.onDismiss,value:selectedItem,"data-id":this.props.selectElementdataId,"aria-label":this.props.dataContext.get_IsInteractionCentricEnabled()?this.state.screenReaderAriaText!=""?this.state.screenReaderAriaText:screenReaderText:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?typeof this.props.tabIndex==="number"&&this.props.tabIndex>-1?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():null,disabled:this.props.disabled||this.props.dataContext.get_ShouldDisableDropdown(),title:this.props.title};if(!this.props.renderAsDropDown&&this.state.showAsListStyle&&!renderAsDropDownForCurrentAgent){var optionSize=selectChildren.length;optionSize=optionSize>this.maxComboBoxSize?this.maxComboBoxSize:optionSize;selectProps.size=optionSize}children.push(React.DOM.select(selectProps,selectChildren));return React.DOM.div({"data-id":this.props.dataId,className:CssClassSet(null,"input-container",this.props.className),onShortPress:this.props.onShortPress},children)};return ComboBoxSpec}(TsAdapter.SpecBase);exports.ComboBox=DataWrapperComponent.wrapComponent(new ComboBoxSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/FocusHandlerMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var FocusHandlerMixin=function(_super){__extends(FocusHandlerMixin,_super);function FocusHandlerMixin(){_super.apply(this,arguments)}FocusHandlerMixin.prototype.componentDidMount=function(){this.handleFocusEvent()};FocusHandlerMixin.prototype.componentDidUpdate=function(){this.handleFocusEvent()};FocusHandlerMixin.prototype.handleFocusEvent=function(){this.props.dataContext.get_IsInteractionCentricEnabled()&&this.handleFocus!=null&&this.shouldTakeFocus()&&this.handleFocus()};FocusHandlerMixin.prototype.getNavigationStack=function(){return this.props.clientContext.applicationShellViewModel.get_DialogConductor().get_ActiveNavigationStack()};FocusHandlerMixin.prototype.getStackCount=function(){return this.getNavigationStack().get_Count()};FocusHandlerMixin.prototype.getNavigationStackTop=function(){return this.getNavigationStack().getItem(this.getStackCount()-1)};FocusHandlerMixin.prototype.shouldTakeFocus=function(){return this.getNavigationStackTop()==this.props.dataContext||this.getStackCount()==0||this.isHostedInPopup!=null&&this.isHostedInPopup()?true:false};return FocusHandlerMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new FocusHandlerMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/SearchBox",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Fields/ComboBox","Components/Primitives/ProgressIndicator","Components/Primitives/FontIcon","Core/Binding/FocusHandlerMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,Button,ComboBox,ProgressIndicator,FontIcon,FocusHandlerMixin,CssClassSet){exports.DESCRIPTOR_NAME="SearchBox";var SearchBoxSpec=function(_super){__extends(SearchBoxSpec,_super);function SearchBoxSpec(){_super.apply(this,arguments);this.displayName="SearchBox";this.mixins=[FocusHandlerMixin.Mixin];this.listenToProperties=["SearchText","ComboBoxViewModel","IsLoading","ActiveNavigationStack","Top","CheckBoxEnabled"]}SearchBoxSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_SearchText(),showFilter:false}};SearchBoxSpec.prototype.handleFocus=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var item=this.refs["searchTextBox"];item instanceof Element&&$(item).focus()}};SearchBoxSpec.prototype.handleSearchButtonClick=function(e){if(this.props.dataContext){this.props.dataContext.set_SearchText(this.state.currentText);this.props.dataContext.resetFacetPaneViewModelProperties();this.props.dataContext.executeAction()}var searchTextBoxNode=this.refs["searchTextBox"];$(searchTextBoxNode).trigger("blur")};SearchBoxSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled())return this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex();else return null};SearchBoxSpec.prototype.handleKeyPress=function(e){if(e.key==="Enter"){this.handleSearchButtonClick(null);this.props.dataContext.raiseEnterButtonPressEvent(true)}};SearchBoxSpec.prototype.renderSearchBoxLeftColumn=function(){var leftColumnChildren=[];(!this.props.dataContext.get_IsRelevanceSearchEnabled()||this.props.clientContext.isMailApp)&&leftColumnChildren.push(this.renderLabel());leftColumnChildren.push(this.renderSearchBoxRow());return React.DOM.div({key:"leftColumn",className:"leftcolumn"},leftColumnChildren)};SearchBoxSpec.prototype.renderLabel=function(){var searchBoxRowChildren=[],searchlabel=React.DOM.span({className:"searchwithLabel"},this.props.dataContext.get_SearchWithLabel());searchBoxRowChildren.push(searchlabel);return React.DOM.div({key:"label",className:"startwithrow"},[this.props.labelPrefix,searchBoxRowChildren])};SearchBoxSpec.prototype.renderSearchBoxRow=function(){var searchBoxRow=[];searchBoxRow.push(this.renderSearchBoxContainer());if(this.props.dataContext.get_IsLoading()){var progress=ProgressIndicator.ProgressIndicator({key:"progress",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true});searchBoxRow.push(progress)}return React.DOM.div({key:"searchbox",className:"searchboxrow"},searchBoxRow)};SearchBoxSpec.prototype.handleCheckboxClick=function(){var currentState=this.props.dataContext.get_ActivityNotesCheckBoxData();this.props.dataContext.set_ActivityNotesCheckBoxData(!currentState)};SearchBoxSpec.prototype.handleBarcodeButtonClick=function(e){this.props.dataContext&&this.props.dataContext.scanBarcode(this.barcodeCallback)};SearchBoxSpec.prototype.barcodeCallback=function(){this.setState({currentText:this.props.dataContext.get_SearchText()});this.props.dataContext.executeAction()};SearchBoxSpec.prototype.activitiesNotesCheckBoxChildren=function(){var activitiesOrNotesCheckBox=React.DOM.input({type:"checkbox",key:"checkbox",disabled:this.props.dataContext.get_IsActivitiesNotesCheckBoxDisabled(),checked:this.props.dataContext.get_IsActivitiesNotesCheckBoxChecked(),onClick:this.handleCheckboxClick,"data-id":"searchFilterForActivitiesOrNotes",className:"optionsetFilterItemCheckbox"}),label=React.DOM.span({key:"label",className:"optionsetFilterItemLabel"},this.props.dataContext.get_ActivityNotesCheckBoxLabel());return React.DOM.div({key:"checkBoxContainer",className:"searchCheckBoxContainer"},[activitiesOrNotesCheckBox,label])};SearchBoxSpec.prototype.handleFilterButtonClick=function(){var isShowFilter=this.state.showFilter;this.setState({showFilter:!isShowFilter})};SearchBoxSpec.prototype.renderSearchBoxContainer=function(){var arrElements=[];if(this.props.dataContext.get_IsRelevanceSearchEnabled()){var searchTypeComboBox=ComboBox.ComboBox({key:"searchTypeComboBox",className:CssClassSet({},"searchDropDown","relavanceSearchEnabledDropDown"),clientContext:this.props.clientContext,renderAsDropDown:true,dataContext:this.props.dataContext.get_SearchTypeViewModel()});arrElements.push(searchTypeComboBox)}!this.state.currentText&&this.props.dataContext.get_SearchTextboxText()&&this.setState({currentText:this.props.dataContext.get_SearchTextboxText()});var textbox=React.DOM.input((_a={ref:"searchTextBox",className:"textbox allowTextSelection searchText placeholderText",key:"textarea",role:"textbox",type:this.props.clientContext.getTextBoxTypeString(5),"data-id":"searchText",value:this.state.currentText||"",maxLength:200},_a[this.props.clientContext.userAgent.get_IsBrowserIE()?"onInput":"onChange"]=this.onTextBoxChanged,_a.onKeyUp=this.handleKeyPress,_a.tabIndex=this.props.dataContext.get_IsInteractionCentricEnabled()?this.getTabIndex():null,_a));arrElements.push(textbox);var buttonSearch=Button.Button({key:"button",className:"searchButton",onClick:this.handleSearchButtonClick,title:this.props.dataContext.get_SearchButtonToolTip(),dataId:"searchImage"},FontIcon.FontIcon({symbolName:"SearchButton"}));arrElements.push(buttonSearch);var buttonBarcode=Button.Button({key:"buttonBarcode",className:"buttonBarcode",onClick:this.handleBarcodeButtonClick,title:this.props.dataContext.get_ScanBarcodeToolTip(),dataId:"buttonBarcode"},FontIcon.FontIcon({symbolName:"BarcodeScanButton"}));this.props.dataContext.get_IsCameraAvailable()&&arrElements.push(buttonBarcode);var filterChildren=[],comboBox=null;if(this.props.dataContext.get_IsRelevanceSearchPage()&&this.props.dataContext.get_UsePhoneExperience())if(!this.props.suppressComboBox){var buttonFilter=Button.Button({key:"buttonFilter",className:"searchButton",onClick:this.handleFilterButtonClick,title:this.props.dataContext.get_SearchButtonToolTip(),dataId:"searchFilter"},FontIcon.FontIcon({symbolName:"GlobalFilter"}));arrElements.push(buttonFilter)}if(!this.props.dataContext.get_IsRelevanceSearchPage()||this.props.dataContext.get_UsePhoneExperience()){if(!this.props.suppressComboBox)comboBox=ComboBox.ComboBox({key:"combobox",className:CssClassSet({searchDropDown:true,relevanceSearchDropDown:this.props.dataContext.get_IsRelevanceSearchPage()}),clientContext:this.props.clientContext,selectElementdataId:"filterEntities",renderAsDropDown:true,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.getTabIndex():null,dataContext:this.props.dataContext.get_ComboBoxViewModel()});if(this.props.dataContext.get_UsePhoneExperience()&&this.props.dataContext.get_IsRelevanceSearchPage()){filterChildren.push(comboBox);this.props.dataContext.get_IsActivityNotesCheckBoxVisible()&&filterChildren.push(this.activitiesNotesCheckBoxChildren())}else arrElements.push(comboBox)}if(this.state.showFilter){var filterElement=React.DOM.div({key:"container",className:"searchboxiconcontainer"},filterChildren);arrElements.push(filterElement)}arrElements.push(this.props.searchButtonSuffix);return React.DOM.div({key:"container",className:"searchboxiconcontainer"},arrElements);var _a};SearchBoxSpec.prototype.onTextBoxChanged=function(event){if(event&&event.target){var target=event.target;this.setState({currentText:target.value});this.props.dataContext.set_SearchTextboxText(target.value)}};SearchBoxSpec.prototype.render=function(){var children=[this.renderSearchBoxLeftColumn()];React.Children.forEach(this.props.children,function(child){children.push(child)});return React.DOM.div({className:"searchBoxHeader"},children)};return SearchBoxSpec}(TsAdapter.SpecBase);exports.SearchBox=DataWrapperComponent.wrapComponent(new SearchBoxSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/Search/MailAppSearchBox",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Primitives/FontIcon","Components/Search/SearchBox"],function(require,exports,TsAdapter,DataWrapperComponent,Button,FontIcon,SearchBox){exports.DESCRIPTOR_NAME="MailAppSearchBox";var MailAppSearchBoxSpec=function(_super){__extends(MailAppSearchBoxSpec,_super);function MailAppSearchBoxSpec(){_super.apply(this,arguments);this.displayName="MailAppSearchBox";this.listenToProperties=["SearchText","Message"]}MailAppSearchBoxSpec.prototype.handleCloseButtonClick=function(e){this.props.dataContext.closePage()};MailAppSearchBoxSpec.prototype.renderBackButton=function(tabIndex){var text=[FontIcon.FontIcon({symbolName:"BackButton"}),React.DOM.span({},this.props.clientContext.getLocalizedString("L_Back_Button_Text"))],button=Button.Button({key:"button",className:"backBtn",onClick:this.handleCloseButtonClick,title:this.props.clientContext.getLocalizedString("L_Back_Button_Text"),dataId:"backImage",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?tabIndex++:null},text);return button};MailAppSearchBoxSpec.prototype.render=function(){var tabIndex=this.props.dataContext.get_StartIndex(),searchBoxProps={clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,suppressComboBox:true,searchInputTabIndex:tabIndex++},children=[this.renderBackButton(tabIndex++)];this.props.dataContext.get_Message()&&children.push(React.DOM.div({className:"searchBoxMessage-container"},React.DOM.span({className:"searchBoxMessage"},this.props.dataContext.get_Message())));var baseSearchBox=SearchBox.SearchBox(searchBoxProps,children);return baseSearchBox};return MailAppSearchBoxSpec}(TsAdapter.SpecBase);exports.MailAppSearchBox=DataWrapperComponent.wrapComponent(new MailAppSearchBoxSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/Search/MailAppRecentlyViewedItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,FontIcon){exports.DESCRIPTOR_NAME="MailAppRecentlyViewedItem";var MailAppRecentlyViewedItemSpec=function(_super){__extends(MailAppRecentlyViewedItemSpec,_super);function MailAppRecentlyViewedItemSpec(){_super.apply(this,arguments);this.displayName="MailAppRecentlyViewedItem";this.listenToProperties=["PinStatus","ModelContext","IsModelInitialized"]}MailAppRecentlyViewedItemSpec.prototype.toggleHandle=function(e){this.props.toggleHandler(this.props.dataContext)};MailAppRecentlyViewedItemSpec.prototype.executeNavigation=function(eventType){if(!this.props.dataContext)return;this.props.dataContext.set_SelectItemEventType(eventType);this.props.onClick&&this.props.onClick();var command=this.props.dataContext.get_SelectListItemCommand();if(command==null||this.props.clientContext==null||this.props.clientContext.device==null)return;command.execute()};MailAppRecentlyViewedItemSpec.prototype.handleShortPress=function(e){var shortPressCommand=this.props.dataContext.get_ShortPressCommand();if(shortPressCommand&&shortPressCommand.get_CanExecute())shortPressCommand.execute();else this.executeNavigation(2)};MailAppRecentlyViewedItemSpec.prototype.handleOpenListItemPress=function(e){this.props.onOpenListItemClick&&this.props.onOpenListItemClick();e.stopPropagation();e.preventDefault()};MailAppRecentlyViewedItemSpec.prototype.renderRecentlyTextContainer=function(){var isSetRegarding=this.props.dataContext.get_IsModelInitialized()&&this.props.isSetRegarding(),recentlyTextContainerChildren=[React.DOM.span({key:"type",className:"recentlyViewedItem-text recentlyViewedItem-text2"},this.props.dataContext.get_DisplayName()+": "),React.DOM.span({key:"name",className:"recentlyViewedItem-text recentlyViewedItem-text1"},this.props.dataContext.get_Title())];return React.DOM.div({key:"textContainer",className:CssClassSet({active:isSetRegarding},"recentlyViewedItem-textContainer"),onShortPress:this.handleShortPress,title:this.props.clientContext.getLocalizedString("MoCA_OWA_SetRegarding_Tooltip")},recentlyTextContainerChildren)};MailAppRecentlyViewedItemSpec.prototype.renderOpenInWeb=function(){var children=[FontIcon.FontIcon({key:"openInWebIcon",symbolName:"PopOverButton"})];return React.DOM.button({key:"openInWeb",className:CssClassSet(null,"recentlyViewedItem-openInWeb","recentlyViewedItem-commandButton"),onShortPress:this.handleOpenListItemPress,title:this.props.clientContext.getLocalizedString("MoCA_OWA_OpenRecord")},children)};MailAppRecentlyViewedItemSpec.prototype.renderPin=function(){var children=[FontIcon.FontIcon({key:"pinIcon",symbolName:this.props.dataContext.get_PinStatus()?"Unpin":"Pin"})];return React.DOM.button({key:"buttonPin",className:CssClassSet(null,"recentlyViewedItem-buttonPin","recentlyViewedItem-commandButton"),onClick:this.toggleHandle,title:this.props.dataContext.get_PinStatus()?this.props.clientContext.getLocalizedString("MoCA_OWA_Unpin_Record_Title"):this.props.clientContext.getLocalizedString("MoCA_OWA_Pin_Record_Title")},children)};MailAppRecentlyViewedItemSpec.prototype.render=function(){if(this.props.dataContext==null||!this.props.dataContext.get_IsModelInitialized()||!this.props.dataContext.get_EntityViewModel()==null||this.props.dataContext.get_EntityViewModel().get_ModelContext()==null||this.props.dataContext.get_EntityViewModel().get_ModelContext().get_ModelName()==null)return null;return React.DOM.div({key:"recentlyViewedItem",className:CssClassSet({"recentlyViewedItem-favorite":this.props.dataContext.get_PinStatus()},"recentlyViewedItem")},[this.renderRecentlyTextContainer(),this.renderPin(),this.renderOpenInWeb()])};return MailAppRecentlyViewedItemSpec}(TsAdapter.SpecBase);exports.MailAppRecentlyViewedItem=DataWrapperComponent.wrapComponent(new MailAppRecentlyViewedItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/Search/MailAppRecentlyViewedItemList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Components/MailApp/Search/MailAppRecentlyViewedItem"],function(require,exports,TsAdapter,DataWrapperComponent,ProgressIndicator,MailAppRecentlyViewedItem){exports.DESCRIPTOR_NAME="MailAppRecentlyViewedItemList";var MailAppRecentlyViewedItemListSpec=function(_super){__extends(MailAppRecentlyViewedItemListSpec,_super);function MailAppRecentlyViewedItemListSpec(){_super.apply(this,arguments);this.displayName="MailAppRecentlyViewedItemList";this.listenToProperties=["ChangeItemSet","Visible","IsLoading"]}MailAppRecentlyViewedItemListSpec.prototype.onItemToggleClick=function(vm){this.props.dataContext.onItemToggleClick(vm)};MailAppRecentlyViewedItemListSpec.prototype.renderItems=function(itemsList){for(var recentlyChildren=[],i=0,length=itemsList.length;i<length;i++)recentlyChildren.push(MailAppRecentlyViewedItem.MailAppRecentlyViewedItem({key:"RecentlyItem-"+i,dataContext:itemsList[i],clientContext:this.props.clientContext,onClick:this.createOnSetRegardingClick(itemsList[i]),onOpenListItemClick:this.createOpenListItem(itemsList[i]),isSetRegarding:this.createIsSetRegarding(itemsList[i]),toggleHandler:this.onItemToggleClick}));return recentlyChildren};MailAppRecentlyViewedItemListSpec.prototype.createIsSetRegarding=function(item){var _this=this;return function(){return _this.props.dataContext.IsSetRegarding(item.get_EntityViewModel())}};MailAppRecentlyViewedItemListSpec.prototype.createOnSetRegardingClick=function(item){var _this=this;return function(){_this.props.dataContext.SetRegarding(item)}};MailAppRecentlyViewedItemListSpec.prototype.createOpenListItem=function(item){var _this=this;return function(){_this.props.dataContext.OpenListItem(item.get_EntityViewModel())}};MailAppRecentlyViewedItemListSpec.prototype.render=function(){if(!this.props.dataContext.get_Visible())return null;var children=[];if(this.props.dataContext.get_IsLoading())children.push(ProgressIndicator.ProgressIndicator({key:"progressRing",className:"progressRing",active:true,type:ProgressIndicator.ProgressIndicatorType.Bar}));else{var tabIndex=this.props.tabIndex,pinnedItems=this.props.dataContext.get_FavoriteItemsSection(),recentlyViewedtems=this.props.dataContext.get_RecentItemsSection(),hasPinnedItems=pinnedItems&&pinnedItems.get_Count()>0,hasRecentlyViewedtems=recentlyViewedtems&&recentlyViewedtems.get_Count()>0;if(hasPinnedItems){var pinnedSectionChildren=[React.DOM.span({key:"pinnedHeader",className:"pinnedHeader"},this.props.dataContext.get_PinnedListHeader()),React.DOM.div({key:"pinnedItemsContainer",className:"pinnedItemsContainer"},this.renderItems(pinnedItems.toArray()))];children.push(React.DOM.div({key:"pinnedContainer",className:"pinnedContainer"},pinnedSectionChildren))}hasPinnedItems&&hasRecentlyViewedtems&&children.push(React.DOM.div({key:"divider",className:"divider"}));if(hasRecentlyViewedtems){var recentlyViewedSectionChildren=[React.DOM.span({key:"recentlyViewedHeader",className:"recentlyViewedHeader"},this.props.dataContext.get_RecentlyViewedListHeader()),React.DOM.div({key:"recentlyViewedItemsContainer",className:"recentlyViewedItemsContainer"},this.renderItems(recentlyViewedtems.toArray()))];children.push(React.DOM.div({key:"recentlyViewedContainer",className:"recentlyViewedContainer"},recentlyViewedSectionChildren))}}return React.DOM.div({className:"recentlyViewedItemListContainer"},children)};return MailAppRecentlyViewedItemListSpec}(TsAdapter.SpecBase);exports.MailAppRecentlyViewedItemList=DataWrapperComponent.wrapComponent(new MailAppRecentlyViewedItemListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeaderStage",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Core/Binding/XrmUIDescriptorMixin","Components/Primitives/FontIcon","Utils/CssClassSet","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,IXUD,FontIcon,CssClassSet,Constants){var ProcessHeaderStageSpec=function(_super){__extends(ProcessHeaderStageSpec,_super);function ProcessHeaderStageSpec(){_super.apply(this,arguments);this.displayName="ProcessHeaderStage";this.mixins=[CustomEventsListener.Mixin,IXUD.Mixin];this.listenToProperties=["RootIsLocked","GlobalActiveStage","SelectedStageId"];this.activeLabel="";this.isActiveStage=false}ProcessHeaderStageSpec.prototype.configureEventListeners=function(){return {ReflowEvent:this.onReflow}};ProcessHeaderStageSpec.prototype.changeSelectedStage=function(){if(!this.props.dataContext)return;var isSelectedStage=this.props.dataContext.isSelectedStage(this.props.stage);if(isSelectedStage)return;this.props.dataContext.set_SelectedStageId(this.props.stage.get_Id())};ProcessHeaderStageSpec.prototype.launchPopover=function(e){if(!this.props.dataContext)return;if(this.props.clientContext.isPhone){this.props.dataContext.set_PopoverVisibility(true);e.stopPropagation()}};ProcessHeaderStageSpec.prototype.handleClosePopup=function(){$(".flyoutPaneClass").css("display","none")};ProcessHeaderStageSpec.prototype.onCurrentEntityStageClick=function(e){this.changeSelectedStage();this.launchPopover(e)};ProcessHeaderStageSpec.prototype.onOtherEntityStageClick=function(e){if(!this.props.dataContext)return;this.changeSelectedStage();if(!this.props.dataContext.navigateToEntity(this.props.entity.get_EntityLogicalName())){this.changeSelectedStage();this.launchPopover(e)}};ProcessHeaderStageSpec.prototype.onCurrentEntityStageKeyDown=function(e){var targetItem=ReactDOM.findDOMNode(this),targetToFocus,targetEvent=e;switch(targetEvent.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:var targetEvents=e;this.changeSelectedStage();this.launchPopover(e);break;case Constants.RIGHT_ARROW_KEY_CODE:case Constants.LEFT_ARROW_KEY_CODE:targetToFocus=targetEvent.keyCode==Constants.RIGHT_ARROW_KEY_CODE?targetItem.nextSibling:targetItem.previousSibling;break;case Constants.ESCAPE_KEY_CODE:this.handleClosePopup();break}if(targetToFocus!=null){$(targetToFocus).focus();return false}};ProcessHeaderStageSpec.prototype.onOtherEntityStageKeyDown=function(e){var targetItem=ReactDOM.findDOMNode(this),targetToFocus,targetEvent=e;switch(targetEvent.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:var targetEvents=e;if(!this.props.dataContext)return;if(!this.props.dataContext.navigateToEntity(this.props.entity.get_EntityLogicalName())){this.changeSelectedStage();this.launchPopover(e)}break;case Constants.RIGHT_ARROW_KEY_CODE:case Constants.LEFT_ARROW_KEY_CODE:targetToFocus=targetEvent.keyCode==Constants.RIGHT_ARROW_KEY_CODE?targetItem.nextSibling:targetItem.previousSibling;break;case Constants.ESCAPE_KEY_CODE:this.handleClosePopup();break}if(targetToFocus!=null){$(targetToFocus).focus();return false}};ProcessHeaderStageSpec.prototype.onReflow=function(sender,e){if(!e||!this.props.dataContext)return;e.get_UpdateUI()&&!this.props.dataContext.isInvocationSource()&&this.forceUpdate()};ProcessHeaderStageSpec.prototype.getProcessStageColor=function(stage){var defaultSelectedStageColor="#1871d6",processControlColor=this.props.clientContext.theming.get_ProcessControlColor();if(this.props.dataContext.isSelectedStage(stage))return this.props.clientContext.theming.IsEnabled?processControlColor:defaultSelectedStageColor;return null};ProcessHeaderStageSpec.prototype.renderStageContent=function(stage,calculatedStageHeight,calculatedStageWidth,calculatedFontSize){var stageIconHolder=React.DOM.div({className:"stageIconHolder",key:"icon",style:{fontSize:calculatedFontSize,height:calculatedStageHeight}},[FontIcon.FontIcon({symbolName:"CheckMark",key:"check",dataId:"checkmarksymbol"}),FontIcon.FontIcon({symbolName:"Locked",key:"locked",dataId:"locksymbol"})]),stageNameText=React.DOM.span({className:"processStageName",key:"content","data-id":"stagename",style:{height:calculatedStageHeight,fontSize:calculatedFontSize}},this.isActiveStage&&!this.props.clientContext.isPhone?stage.get_Description()+" ("+this.activeLabel+")":stage.get_Description()),processColorStage=this.getProcessStageColor(stage),stageNameContent=React.DOM.div({className:"stageNameContent",key:"content",id:"processStage_"+stage.get_Id(),style:{color:processColorStage,width:this.props.clientContext.isPhone?calculatedStageWidth*.65:calculatedStageWidth*.7}},[stageNameText]);return React.DOM.div({className:"stageContent",key:"stageContent",style:{height:calculatedStageHeight}},[stageIconHolder,stageNameContent])};ProcessHeaderStageSpec.prototype.renderStageTracker=function(calculatedStageHeight,calculatedFontSize){var stageTrackerContent=React.DOM.span({className:"screen-reader-text",key:"content"},"active stage"),fontIcon=FontIcon.FontIcon({symbolName:"ViewNotifications",key:"icon",className:"dataIcon",ariaHidden:true});return React.DOM.div({className:"stageTracker",key:"tracker","data-id":"stageflag",style:{height:calculatedStageHeight,fontSize:calculatedFontSize}},[fontIcon,stageTrackerContent])};ProcessHeaderStageSpec.prototype.renderStage=function(stage,isCurrentEntity,isSelectedStage,isActiveStage,isCompleted,isLocked,isAborted,defaultPath){var calculatedStageHeight=this.props.calculatedStageHeight,calculatedStageArrow=this.props.calculatedStageHeight/2,dataStageState=null;if(isActiveStage)dataStageState="active";else if(isLocked)dataStageState="locked";else if(isCompleted)dataStageState="completed";var stageContent=this.renderStageContent(stage,calculatedStageHeight,this.props.calculatedStageWidth,this.props.calculatedFontSize),afterProcessStage=React.DOM.div({className:"afterProcessStage",style:{right:-calculatedStageArrow,borderTopWidth:calculatedStageArrow,borderBottomWidth:calculatedStageArrow,borderLeftWidth:calculatedStageArrow}}),beforeProcessStage=React.DOM.div({className:"beforeProcessStage",style:{marginLeft:-calculatedStageArrow,borderTopWidth:calculatedStageArrow,borderBottomWidth:calculatedStageArrow,borderLeftWidth:calculatedStageArrow}}),stageTracker=this.renderStageTracker(calculatedStageHeight,this.props.calculatedFontSize),props={className:CssClassSet({processStageContainer:true,selectedStage:isSelectedStage,unselectedStage:!isSelectedStage,activeStage:isActiveStage,currentEntity:isCurrentEntity,disabled:isLocked,completedStage:isCompleted,abortedStage:isAborted,hideStage:defaultPath.indexOf(stage.get_Id())===-1,lastVisibleStage:defaultPath.indexOf(stage.get_Id())===defaultPath.length-1}),id:"stage_"+stage.get_Id(),style:{width:this.props.calculatedStageWidth,height:calculatedStageHeight,marginRight:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.stageMargin:calculatedStageArrow+this.props.stageMargin},"data-id":"stagecontainer","data-stagestate":dataStageState,"data-selectedstage":isSelectedStage?"1":null,title:this.props.dataContext.getStageTooltip(stage),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onClick:this.props.clientContext.isUsingPointerUp?null:isCurrentEntity?this.onCurrentEntityStageClick:this.onOtherEntityStageClick,onPointerUp:this.props.clientContext.isUsingPointerUp?isCurrentEntity?this.onCurrentEntityStageClick:this.onOtherEntityStageClick:null,onKeyDown:isCurrentEntity?this.onCurrentEntityStageKeyDown:this.onOtherEntityStageKeyDown};return React.DOM.div(props,[beforeProcessStage,stageContent,afterProcessStage,stageTracker])};ProcessHeaderStageSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.processHeaderStage;properties["id"]=this.props.stage.get_Id();properties["parentId"]=XrmUI.UIControlType.processHeaderContainer;return properties};ProcessHeaderStageSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var currentEntityName=this.props.dataContext.get_ModelContext().get_ModelName(),isCurrentEntity=this.props.entity.get_EntityLogicalName()===currentEntityName,isSelectedStage=this.props.dataContext.isSelectedStage(this.props.stage)&&!this.props.dataContext.isBusinessProcessCompleted();this.isActiveStage=this.props.dataContext.isActiveStage(this.props.stage)&&!this.props.dataContext.isBusinessProcessCompleted();var isCompleted=this.props.dataContext.isCompleted(this.props.stage.get_Id())||this.props.dataContext.isBusinessProcessCompleted(),isLocked=this.props.dataContext.isLocked(this.props.stage.get_Id()),isAborted=this.props.dataContext.isBusinessProcessAborted(),defaultPath=this.props.dataContext.get_DefaultPath();this.activeLabel=this.props.dataContext.get_ActiveLabel();return this.renderStage(this.props.stage,isCurrentEntity,isSelectedStage,this.isActiveStage,isCompleted,isLocked,isAborted,defaultPath)};return ProcessHeaderStageSpec}(TsAdapter.SpecBase);exports.ProcessHeaderStageSpec=ProcessHeaderStageSpec;exports.ProcessHeaderStage=DataWrapperComponent.wrapComponent(new ProcessHeaderStageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Core/Binding/WindowResizeHandlerMixin","Components/Primitives/FontIcon","Utils/CssClassSet","Components/BusinessProcess/ProcessHeaderStage"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,WindowResizeHandler,FontIcon,CssClassSet,ProcessHeaderStage){exports.DESCRIPTOR_NAME="ProcessHeader";var PHONE_STAGE_MARGIN=4,MINIMUM_VISIBLE_STAGES=2,BREAK_LENGTH=4;(function(SwipeRange){SwipeRange[SwipeRange["OutLeftBoundary"]=-1]="OutLeftBoundary";SwipeRange[SwipeRange["InRange"]=0]="InRange";SwipeRange[SwipeRange["OutRightBoundary"]=1]="OutRightBoundary"})(exports.SwipeRange||(exports.SwipeRange={}));var SwipeRange=exports.SwipeRange,ProcessHeaderSpec=function(_super){__extends(ProcessHeaderSpec,_super);function ProcessHeaderSpec(){_super.apply(this,arguments);this.displayName="ProcessHeader";this.mixins=[CustomEventsListener.Mixin,WindowResizeHandler.Mixin];this.listenToProperties=["Data","GlobalActiveStage","SelectedStageId","StageCount"];this.startPositionX=0;this.lastPositionX=0;this.startMargin=0;this.stageMargin=10;this.overflowTrackerWidth=18;this.processNamePositionRight=15;this.stageWidth=155;this.minstageHeight=28;this.minChevronsSpace=7;this.stageHeightProFactorTablet=.037;this.stageHeightProFactorPhone=.047;this.stageFontSizeProFactor=.53;this.maximumVisibleStages=5;this.touchStart=false;this.interactioncentricPadding=115;this.parentWidth=0;this.globalActiveStageId="";this.rightSidehiddenWidth=function(stagesViewportWidth,allStageCount){var allStagesWidth=this.calculateStagesWidth(allStageCount),hiddenWidth=allStagesWidth-stagesViewportWidth;return hiddenWidth};this.resetStageWidth=function(screenWidth){if(screenWidth>=1025)this.stageWidth=380;else if(screenWidth<=768)this.stageWidth=190;else this.stageWidth=250;var stageCount=this.props.dataContext.get_DefaultPath().length;if(this.props.clientContext.isPhone)if(stageCount==1)this.stageWidth=screenWidth;else if(stageCount==MINIMUM_VISIBLE_STAGES)this.stageWidth=(screenWidth-this.stageMargin)/MINIMUM_VISIBLE_STAGES;else if(stageCount>MINIMUM_VISIBLE_STAGES){var maxStageWidth=(screenWidth-this.stageMargin)/MINIMUM_VISIBLE_STAGES,minStageWidth=(screenWidth-this.stageMargin)/this.maximumVisibleStages;this.stageWidth=(maxStageWidth+minStageWidth)/2}};this.calculateStageHeight=function(){var proportionFactor=this.props.clientContext.isPhone?this.stageHeightProFactorPhone:this.stageHeightProFactorTablet,screenHeight=WindowResizeHandler.getScreenHeightBasedOnDevice(),chevronHeight=screenHeight*proportionFactor,adjustedChevronHeight=Math.round(chevronHeight);if(adjustedChevronHeight%2!=0)adjustedChevronHeight--;if(adjustedChevronHeight<=this.minstageHeight)return this.minstageHeight;else return adjustedChevronHeight};this.calculateSpaceBetweenChevrons=function(){var proportionFactor=this.props.clientContext.isPhone?.019:.005,screenWidth=WindowResizeHandler.getWindowWidth(),SpaceBetweenChevrons=screenWidth*proportionFactor;SpaceBetweenChevrons=Math.round(SpaceBetweenChevrons);if(SpaceBetweenChevrons<=this.minChevronsSpace)return this.minChevronsSpace;else return SpaceBetweenChevrons};this.getProcessHeader=function(){var activeRootView=$("#activeRootView");if(activeRootView)return activeRootView.find("#headerProcessName")}}ProcessHeaderSpec.prototype.configureEventListeners=function(){return {ReflowEvent:this.onReflow}};ProcessHeaderSpec.prototype.calculateStagesWidth=function(stageCount){var stageWidth=this.stageWidth;if(this.props.isInteractionCentric)stageWidth=this.calculateStageAutoWidth();return stageCount*stageWidth+(stageCount-1)*this.stageMargin};ProcessHeaderSpec.prototype.calculateVisibleStageCount=function(screenWidth){if(this.props.isInteractionCentric)return Math.ceil((screenWidth-this.interactioncentricPadding)/(this.stageWidth+this.stageMargin));var availableSpace=screenWidth;if(!this.props.clientContext.isPhone)availableSpace=this.parentWidth||screenWidth;var visibleStageCount=Math.floor((availableSpace+this.stageMargin)/(this.stageWidth+this.stageMargin));if(visibleStageCount>this.maximumVisibleStages)visibleStageCount=this.maximumVisibleStages;else if(visibleStageCount<MINIMUM_VISIBLE_STAGES)visibleStageCount=0;return visibleStageCount};ProcessHeaderSpec.prototype.calculateMargin=function(pageX,startMargin,startPositionX,maxSwipe){var change=pageX-startPositionX,finalMargin=0,stageCount=this.props.dataContext.get_StageCount();if(this.props.isInteractionCentric)stageCount=this.props.dataContext.get_DefaultPath().length;var screenWidth=WindowResizeHandler.getWindowWidth(),visibleStageCount=this.calculateVisibleStageCount(screenWidth);if(stageCount>visibleStageCount)finalMargin=startMargin+change;if(finalMargin>=0)finalMargin=0;else if(finalMargin<=maxSwipe)finalMargin=maxSwipe;return finalMargin};ProcessHeaderSpec.prototype.getStageTrackerPosition=function(){var processHeaderContainer=this.refs["processHeaderContainer"],stagesViewport=this.refs["stagesViewport"];if(processHeaderContainer instanceof Element&&stagesViewport instanceof Element){var stageTracker=$(processHeaderContainer).find(".activeStage .stageTracker");if(stageTracker.offset()!=undefined){var leftBoundary=$(stagesViewport).offset().left,rightBound=leftBoundary+$(stagesViewport).width(),trackerLeft=stageTracker.offset().left,trackerRight=trackerLeft+stageTracker.width();if(trackerRight<leftBoundary)return SwipeRange.OutLeftBoundary;if(trackerLeft>rightBound)return SwipeRange.OutRightBoundary}}return SwipeRange.InRange};ProcessHeaderSpec.prototype.showOutboundTracker=function(){var range=this.getStageTrackerPosition(),showLeftStageTracker=false,showRightStageTracker=false;if(range===SwipeRange.InRange){showLeftStageTracker=false;showRightStageTracker=false}else if(range===SwipeRange.OutLeftBoundary)showLeftStageTracker=true;else showRightStageTracker=true;this.setState({showLeftStageTracker:showLeftStageTracker,showRightStageTracker:showRightStageTracker})};ProcessHeaderSpec.prototype.onTouchStart=function(e){this.touchStart=true;this.startPositionX=this.lastPositionX=e.pageX;this.startMargin=this.state.processHeaderContainerCSSMarginLeft};ProcessHeaderSpec.prototype.onTouchMove=function(e){if(!this.touchStart)return;var pageX=e.pageX,currentDirection=pageX>this.lastPositionX,initDirection=pageX>this.startPositionX,margin=this.calculateMargin(pageX,this.startMargin,this.startPositionX,this.state.maxSwipe);this.setState({processHeaderContainerCSSMarginLeft:margin});var range=margin>=0?SwipeRange.OutLeftBoundary:margin<=this.state.maxSwipe?SwipeRange.OutRightBoundary:SwipeRange.InRange;if(range!=SwipeRange.InRange&&currentDirection!=initDirection){this.startPositionX=pageX;this.startMargin=range===SwipeRange.OutLeftBoundary?0:this.state.maxSwipe}this.showOutboundTracker();this.lastPositionX=pageX};ProcessHeaderSpec.prototype.onTouchEnd=function(e){if(!this.touchStart)return;var margin=this.calculateMargin(e.pageX,this.startMargin,this.startPositionX,this.state.maxSwipe);this.setState({processHeaderContainerCSSMarginLeft:margin});this.touchStart=false};ProcessHeaderSpec.prototype.onTouchCancel=function(e){this.touchStart=false};ProcessHeaderSpec.prototype.setupSwipe=function(stageCount,visibleStageCount){var allStagesWidth=this.calculateStagesWidth(stageCount),swipeable=false,visibleWidth=allStagesWidth,processHeaderWidth=allStagesWidth,nameOffset=0;if(visibleStageCount===0){this.setState({showStages:false});return false}else this.setState({showStages:true});if(stageCount>visibleStageCount){visibleWidth=this.calculateStagesWidth(visibleStageCount);if(this.props.isInteractionCentric){var screenWidth=WindowResizeHandler.getWindowWidth();visibleWidth=screenWidth-this.interactioncentricPadding}processHeaderWidth=visibleWidth+this.overflowTrackerWidth*2;swipeable=true;nameOffset=this.overflowTrackerWidth*2}if(!this.props.clientContext.isPhone)if(this.parentWidth){var maxWidth=Math.max(this.parentWidth,allStagesWidth);visibleWidth=this.parentWidth;processHeaderWidth=this.parentWidth;allStagesWidth=maxWidth;nameOffset=0}this.setState({processWrapperWidth:processHeaderWidth,stagesViewportWidth:visibleWidth,processNameOffset:nameOffset,processHeaderContainerWidth:allStagesWidth,maxSwipe:visibleWidth-allStagesWidth});return swipeable};ProcessHeaderSpec.prototype.setInitialSwipe=function(visibleStageCount,allStageCount){if(!this.props.dataContext)return;var currentStage=this.props.dataContext.get_CurrentActiveStageIndex();if(this.props.isInteractionCentric){if(currentStage+1<visibleStageCount)return}else if(currentStage<visibleStageCount)return;var hiddenStages=currentStage-visibleStageCount+1,margin=this.calculateStagesWidth(hiddenStages);if(this.props.isInteractionCentric){var screenWidth=WindowResizeHandler.getWindowWidth(),visibleWidth=screenWidth-this.interactioncentricPadding,hiddenWidth=this.stageWidth-visibleWidth%(this.stageWidth+this.stageMargin);margin=margin+hiddenWidth+this.stageMargin}else if(this.parentWidth){var hiddenWidth=this.rightSidehiddenWidth(this.parentWidth,allStageCount);margin=margin>hiddenWidth?hiddenWidth:margin}this.setState({processHeaderContainerCSSMarginLeft:-margin})};ProcessHeaderSpec.prototype.resizeProcessControl=function(){if(!this.props.dataContext)return;var defaultPath=this.props.dataContext.get_DefaultPath(),stageCount=defaultPath?defaultPath.length:0,screenWidth=WindowResizeHandler.getWindowWidth();this.resetStageWidth(screenWidth);var visibleStageCount=this.calculateVisibleStageCount(screenWidth);this.setupSwipe(stageCount,visibleStageCount);stageCount>visibleStageCount&&this.setInitialSwipe(visibleStageCount,stageCount)};ProcessHeaderSpec.prototype.handleWindowResize=function(){var stagesContainer=this.refs["processHeaderContainer"],stagesViewport=this.refs["stagesViewport"];if(this.props.dataContext&&stagesContainer instanceof Element&&stagesViewport instanceof Element){var screenWidth=WindowResizeHandler.getWindowWidth();this.resetStageWidth(screenWidth);var visibleStageCount=this.calculateVisibleStageCount(screenWidth),defaultPath=this.props.dataContext.get_DefaultPath(),stageCount=defaultPath?defaultPath.length:0;this.parentWidth=ReactDOM.findDOMNode(this).parentElement.clientWidth;this.setupSwipe(stageCount,visibleStageCount);var leftBoundary=$(stagesViewport).offset().left,rightBoundary=leftBoundary+$(stagesViewport).width(),selectedStage=$(stagesContainer).find(".selectedStage"),elementLeft=selectedStage.length>0?selectedStage.offset().left:0,elementRight=elementLeft+this.stageWidth,margin=Math.min(rightBoundary-elementRight,leftBoundary-$(stagesContainer).offset().left);margin+=this.state.processHeaderContainerCSSMarginLeft;if(this.parentWidth&&stageCount>visibleStageCount){var hiddenWidth=this.rightSidehiddenWidth(this.parentWidth,stageCount);margin=margin*-1>hiddenWidth?-hiddenWidth:margin}this.setState({processHeaderContainerCSSMarginLeft:margin});stageCount>visibleStageCount&&this.showOutboundTracker()}};ProcessHeaderSpec.prototype.onReflow=function(sender,e){if(!e||!this.props.dataContext)return;if(e.get_UpdateUI()&&!this.props.dataContext.isInvocationSource()){var newDefaultPathHash=this.props.dataContext.get_DefaultPathHash();if(this.state.renderedPathHash===newDefaultPathHash)return;this.setState({renderedPathHash:newDefaultPathHash});this.resizeProcessControl()}};ProcessHeaderSpec.prototype.renderOverflowStageTrackerMarkup=function(isLeft){var stageTrackerMarkup=FontIcon.FontIcon({symbolName:"ViewNotifications",className:"dataIcon",ariaHidden:true}),isHidden=true;if(isLeft&&this.state.showLeftStageTracker)isHidden=false;else if(!isLeft&&this.state.showRightStageTracker)isHidden=false;var trackerMarkupByDirection=React.DOM.div({className:CssClassSet({leftStageTracker:isLeft,rightStageTracker:!isLeft,hidden:isHidden})},stageTrackerMarkup);return React.DOM.div({className:CssClassSet({overflowTracker:isLeft,"overflowTracker rightTracker":!isLeft}),key:isLeft?"left":"right"},trackerMarkupByDirection)};ProcessHeaderSpec.prototype.calculateStageAutoWidth=function(){var stageCount=this.props.dataContext.get_DefaultPath().length,screenWidth=WindowResizeHandler.getWindowWidth(),visibleStageCount=this.calculateVisibleStageCount(screenWidth);if(visibleStageCount>=stageCount){var total_available_space=screenWidth-this.interactioncentricPadding,total_margin_btw_stages=(stageCount-1)*this.stageMargin,total_available_spaceForStageWidth=(total_available_space-total_margin_btw_stages)/stageCount;return total_available_spaceForStageWidth}else return this.stageWidth};ProcessHeaderSpec.prototype.calculateStageWidth=function(){if(this.props.clientContext.isPhone){var stageCount=this.props.dataContext.get_StageCount(),screenWidth=WindowResizeHandler.getWindowWidth(),visibleStageCount=Math.floor((screenWidth+PHONE_STAGE_MARGIN)/(this.stageWidth+PHONE_STAGE_MARGIN));if(stageCount<=visibleStageCount){var total_available_space=.9*screenWidth,total_margin_btw_stages=(stageCount-1)*PHONE_STAGE_MARGIN,total_available_spaceForStageWidth=(total_available_space-total_margin_btw_stages)/stageCount;return total_available_spaceForStageWidth}else return this.stageWidth}else return this.stageWidth};ProcessHeaderSpec.prototype.headerStages=function(i,j,stage,entity,calculatedStageWidth,calculatedStageHeight,calculatedFontSize,stageMargin){var process=this.props.dataContext.get_Process(),entities=process.get_Steps(),stageDom=ProcessHeaderStage.ProcessHeaderStage({clientContext:this.props.clientContext,dataContext:this.props.dataContext,key:i.toString()+j.toString(),entity:entity,stage:stage,calculatedStageWidth:calculatedStageWidth,calculatedStageHeight:calculatedStageHeight,calculatedFontSize:calculatedFontSize,stageMargin:stageMargin,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null});return stageDom};ProcessHeaderSpec.prototype.renderProcess=function(headerStages,calculatedStageWidth,calculatedStageHeight,calculatedFontSize,stageMargin){var stages=[];if(!this.props.dataContext||!this.props.dataContext.get_Process())return stages;var process=this.props.dataContext.get_Process(),entities=process.get_Steps();if(entities)for(var i=0;i<entities.get_Count();i++){var entity=entities.getStep(i);if(entity){if(!this.props.dataContext.isEntityStep(entity))continue;var childSteps=entity.get_Steps();if(childSteps)for(var j=0;j<childSteps.get_Count();j++){var stage=childSteps.getStep(j);if(stage){var stageDom=headerStages(i,j,stage,entity,calculatedStageWidth,calculatedStageHeight,calculatedFontSize,stageMargin);stages.push(stageDom)}}}}return stages};ProcessHeaderSpec.prototype.getInitialState=function(){return {showStages:false,processHeaderContainerCSSMarginLeft:0,processNameOffset:0}};ProcessHeaderSpec.prototype.componentWillMount=function(){if(this.props.isInteractionCentric){this.stageWidth=this.props.stageWidth;this.maximumVisibleStages=this.props.maximumVisibleStages}this.resizeProcessControl()};ProcessHeaderSpec.prototype.componentDidMount=function(){this.handleWindowResize()};ProcessHeaderSpec.prototype.componentDidUpdate=function(){var activeProcessHeader=this.getProcessHeader(),processName=this.props.dataContext.get_Process().get_Name();!this.props.clientContext.isPhone&&(activeProcessHeader.text()==""||activeProcessHeader.text()!=processName)&&activeProcessHeader.text(processName);if(this.state.showRightStageTracker)activeProcessHeader.css("padding-right",this.processNamePositionRight+this.overflowTrackerWidth+"px");else activeProcessHeader.css("padding-right",this.processNamePositionRight+"px");if(this.props.dataContext.get_GlobalActiveStageId()!=this.globalActiveStageId){this.globalActiveStageId=this.props.dataContext.get_GlobalActiveStageId();this.handleWindowResize()}};ProcessHeaderSpec.prototype.render=function(){var calculatedStageWidth=this.calculateStageWidth(),calculatedStageHeight=this.calculateStageHeight(),calculatedChevronsSpace=this.calculateSpaceBetweenChevrons(),calculatedFontSize=calculatedStageHeight*this.stageFontSizeProFactor,stageMargin=calculatedChevronsSpace,stages=this.renderProcess(this.headerStages,calculatedStageWidth,calculatedStageHeight,calculatedFontSize,stageMargin),nameOffset=this.state.showLeftStageTracker?this.state.processNameOffset/2:this.state.processNameOffset,stagesContainer=React.DOM.div({className:"processHeaderContainer",key:"container",ref:"processHeaderContainer",style:{width:this.state.processHeaderContainerWidth,marginLeft:this.state.processHeaderContainerCSSMarginLeft},onPointerDown:this.onTouchStart,onPointerMove:this.onTouchMove,onPointerUp:this.onTouchEnd,onPointerCancel:this.onTouchCancel},stages),stageViewport=React.DOM.div({className:"stagesViewport",key:"viewport",ref:"stagesViewport",style:{width:this.state.stagesViewportWidth}},stagesContainer),leftOverflowIndicator=this.renderOverflowStageTrackerMarkup(true),rightOverflowIndicator=this.renderOverflowStageTrackerMarkup(false);return React.DOM.div({className:"processWrapper",style:{width:this.state.processWrapperWidth,display:this.state.showStages?"block":"none"}},[leftOverflowIndicator,stageViewport,rightOverflowIndicator])};return ProcessHeaderSpec}(TsAdapter.SpecBase);exports.ProcessHeaderSpec=ProcessHeaderSpec;exports.ProcessHeader=DataWrapperComponent.wrapComponent(new ProcessHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeaderContainer",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Core/Binding/XrmUIDescriptorMixin","Components/BusinessProcess/ProcessHeader"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,IXUD,ProcessHeader){exports.DESCRIPTOR_NAME="ProxyProcessHeader";var ProcessHeaderContainerSpec=function(_super){__extends(ProcessHeaderContainerSpec,_super);function ProcessHeaderContainerSpec(){_super.apply(this,arguments);this.displayName="ProcessHeaderContainer";this.mixins=[UIHasRendered.Mixin,IXUD.Mixin];this.listenToProperties=["ControlDescriptor","Visible","HasMultipleBPFInstancesInOffline"]}ProcessHeaderContainerSpec.prototype.componentDidUpdate=function(){var node=ReactDOM.findDOMNode(this);!node.hasAttribute("touch-action")&&node.setAttribute("touch-action","none")};ProcessHeaderContainerSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.processHeaderContainer;return properties};ProcessHeaderContainerSpec.prototype.render=function(){var props={className:"group proxyProcessHeader initialized","data-id":"processcontainer"};if(!this.props.dataContext||this.props.dataContext.get_HasMultipleBPFInstancesInOffline())return React.DOM.noscript();if(!this.props.dataContext.get_ControlDescriptor()||!this.props.dataContext.get_FetchedViewModel()||!this.props.dataContext.get_Visible())if(this.props.dataContext.get_HasBusinessProcess()&&!this.props.dataContext.get_IsProcessHiddenByClientApi())return React.DOM.div(props);else return React.DOM.noscript();var processHeaderControl=null;processHeaderControl=ProcessHeader.ProcessHeader({clientContext:this.props.clientContext,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,dataContext:this.props.dataContext.get_FetchedViewModel(),descriptor:this.props.dataContext.get_ControlDescriptor()});props["data-vmid"]=this.props.dataContext.get_ViewModelId();return React.DOM.div(props,processHeaderControl)};return ProcessHeaderContainerSpec}(TsAdapter.SpecBase);exports.ProcessHeaderContainerSpec=ProcessHeaderContainerSpec;exports.ProcessHeaderContainer=DataWrapperComponent.wrapComponent(new ProcessHeaderContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeaderStageDesktop",["require","exports","Components/DataWrapperComponent","Components/BusinessProcess/ProcessHeaderStage","Components/Common/Constants"],function(require,exports,DataWrapperComponent,ProcessHeaderStage,Constants){var ProcessHeaderStageDesktopSpec=function(_super){__extends(ProcessHeaderStageDesktopSpec,_super);function ProcessHeaderStageDesktopSpec(){_super.apply(this,arguments);this.displayName="ProcessHeaderStageDesktop"}ProcessHeaderStageDesktopSpec.prototype.changeStage=function(e){if(!this.props.dataContext)return;var isSelectedStage=this.props.dataContext.isSelectedStage(this.props.stage);!isSelectedStage&&this.props.dataContext.set_SelectedStageId(this.props.stage.get_Id());this.props.dataContext.set_PopoverVisibility(true)};ProcessHeaderStageDesktopSpec.prototype.onCurrentEntityStageClick=function(e){this.changeStage(e)};ProcessHeaderStageDesktopSpec.prototype.onOtherEntityStageClick=function(e){if(!this.props.dataContext)return;!this.props.dataContext.navigateToEntity(this.props.entity.get_EntityLogicalName())&&this.changeStage(e)};ProcessHeaderStageDesktopSpec.prototype.onCurrentEntityStageKeyDown=function(e){var targetItem=ReactDOM.findDOMNode(this),targetToFocus,targetEvent=e;switch(targetEvent.key){case Constants.ENTER_KEY:case Constants.SPACE_KEY:var targetEvents=e;this.changeStage(e);break;case Constants.RIGHT_ARROW_KEY:case Constants.LEFT_ARROW_KEY:targetToFocus=targetEvent.key===Constants.RIGHT_ARROW_KEY?targetItem.nextSibling:targetItem.previousSibling;break;case Constants.ESCAPE_KEY:this.handleClosePopup();break}if(targetToFocus!=null){$(targetToFocus).focus();return false}};ProcessHeaderStageDesktopSpec.prototype.onOtherEntityStageKeyDown=function(e){var targetItem=ReactDOM.findDOMNode(this),targetToFocus,targetEvent=e;switch(targetEvent.key){case Constants.ENTER_KEY:case Constants.SPACE_KEY:var targetEvents=e;if(!this.props.dataContext)return;!this.props.dataContext.navigateToEntity(this.props.entity.get_EntityLogicalName())&&this.changeStage(e);break;case Constants.RIGHT_ARROW_KEY:case Constants.LEFT_ARROW_KEY:targetToFocus=targetEvent.key===Constants.RIGHT_ARROW_KEY?targetItem.nextSibling:targetItem.previousSibling;break;case Constants.ESCAPE_KEY:this.handleClosePopup();break}if(targetToFocus!=null){$(targetToFocus).focus();return false}};ProcessHeaderStageDesktopSpec.prototype.renderHeaderStages=function(stage,isCurrentEntity,isSelectedStage,isActiveStage,isCompleted,isLocked,isAborted,defaultPath){var renderedStage=this.renderStage(this.props.stage,isCurrentEntity,isSelectedStage,isActiveStage,isCompleted,isLocked,isAborted,defaultPath);if(isSelectedStage&&isActiveStage&&!isLocked)$(".flyoutWindowFlagIcon").css("display","");else isSelectedStage&&$(".flyoutWindowFlagIcon").css("display","none");isLocked&&$(".flyoutFooterClass").css("display","none");return renderedStage};ProcessHeaderStageDesktopSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var currentEntityName=this.props.dataContext.get_ModelContext().get_ModelName(),isCurrentEntity=this.props.entity.get_EntityLogicalName()===currentEntityName,isSelectedStage=this.props.dataContext.isSelectedStage(this.props.stage),isActiveStage=this.props.dataContext.isActiveStage(this.props.stage),isCompleted=this.props.dataContext.isCompleted(this.props.stage.get_Id())||this.props.dataContext.isBusinessProcessCompleted(),isLocked=this.props.dataContext.isLocked(this.props.stage.get_Id()),isAborted=this.props.dataContext.isBusinessProcessAborted(),defaultPath=this.props.dataContext.get_DefaultPath();return this.renderHeaderStages(this.props.stage,isCurrentEntity,isSelectedStage,isActiveStage,isCompleted,isLocked,isAborted,defaultPath)};return ProcessHeaderStageDesktopSpec}(ProcessHeaderStage.ProcessHeaderStageSpec);exports.ProcessHeaderStageDesktop=DataWrapperComponent.wrapComponent(new ProcessHeaderStageDesktopSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeaderDesktop",["require","exports","Components/DataWrapperComponent","Core/Binding/WindowResizeHandlerMixin","Utils/CssClassSet","Components/BusinessProcess/ProcessHeaderStageDesktop","Components/BusinessProcess/ProcessHeader"],function(require,exports,DataWrapperComponent,WindowResizeHandler,CssClassSet,ProcessHeaderStageDesktop,ProcessHeader){exports.DESCRIPTOR_NAME="ProcessHeaderDesktop";var ProcessHeaderDesktopSpec=function(_super){__extends(ProcessHeaderDesktopSpec,_super);function ProcessHeaderDesktopSpec(){_super.apply(this,arguments);this.displayName="ProcessHeaderDesktop"}ProcessHeaderDesktopSpec.prototype.getProcessWrapperWidth=function(){var visibleWidth=this.getStagesViewportWidth(),processWrapperWidth=visibleWidth+this.overflowTrackerWidth*2;return processWrapperWidth};ProcessHeaderDesktopSpec.prototype.getVisibleStageCount=function(){var screenWidth=WindowResizeHandler.getWindowWidth(),visibleStageCount=this.calculateVisibleStageCount(screenWidth);return visibleStageCount};ProcessHeaderDesktopSpec.prototype.getStagesViewportWidth=function(){var screenWidth=WindowResizeHandler.getWindowWidth();return screenWidth-this.interactioncentricPadding};ProcessHeaderDesktopSpec.prototype.overflowIndicator=function(){var screenWidth=WindowResizeHandler.getWindowWidth(),visibleStageCount=this.calculateVisibleStageCount(screenWidth),allStages=this.props.dataContext.get_DefaultPath().length;if(visibleStageCount<allStages)return true;return false};ProcessHeaderDesktopSpec.prototype.headerStages=function(i,j,stage,entity,calculatedStageWidth){var process=this.props.dataContext.get_Process(),entities=process.get_Steps(),stageDom=ProcessHeaderStageDesktop.ProcessHeaderStageDesktop({clientContext:this.props.clientContext,dataContext:this.props.dataContext,key:i.toString()+j.toString(),entity:entity,stage:stage,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,calculatedStageWidth:calculatedStageWidth,calculatedStageHeight:20,calculatedFontSize:13,stageMargin:5});return stageDom};ProcessHeaderDesktopSpec.prototype.render=function(){var calculatedStageWidth=this.calculateStageAutoWidth(),stages=this.renderProcess(this.headerStages,calculatedStageWidth,0,0,0),stagesContainer=React.DOM.div({className:CssClassSet({processHeaderContainer:true,majorComponent:this.props.dataContext.get_IsInteractionCentricEnabled()}),key:"container",ref:"processHeaderContainer",style:{width:this.calculateStagesWidth(this.props.dataContext.get_DefaultPath().length),marginLeft:this.state.processHeaderContainerCSSMarginLeft},onPointerDown:this.onTouchStart,onPointerMove:this.onTouchMove,onMouseLeave:this.onTouchEnd,onPointerUp:this.onTouchEnd,onPointerCancel:this.onTouchCancel,tabIndex:this.props.dataContext.get_StartIndex()},stages),fadedOverlay=React.DOM.span({key:"fadedOverlay",className:CssClassSet({stagesOverlayFaded:this.overflowIndicator()})}),stageViewport=React.DOM.div({className:"stagesViewportDesktop",key:"viewport",ref:"stagesViewport",style:{width:this.getStagesViewportWidth()}},[stagesContainer,fadedOverlay]),leftOverflowIndicator=this.renderOverflowStageTrackerMarkup(true),rightOverflowIndicator=this.renderOverflowStageTrackerMarkup(false);return React.DOM.div({key:"processWrapper",className:"processWrapper",style:{width:this.getProcessWrapperWidth(),display:this.state.showStages?"block":"none"}},[leftOverflowIndicator,stageViewport,rightOverflowIndicator])};return ProcessHeaderDesktopSpec}(ProcessHeader.ProcessHeaderSpec);exports.ProcessHeaderDesktop=DataWrapperComponent.wrapComponent(new ProcessHeaderDesktopSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessHeaderContainerDesktop",["require","exports","Components/DataWrapperComponent","Components/BusinessProcess/ProcessHeaderContainer","Components/BusinessProcess/ProcessHeaderDesktop","Core/Binding/WindowResizeHandlerMixin"],function(require,exports,DataWrapperComponent,ProcessHeaderContainer,ProcessHeaderDesktop,WindowResizeHandler){exports.DESCRIPTOR_NAME="ProxyProcessHeaderDesktop";var ProcessHeaderContainerDesktopSpec=function(_super){__extends(ProcessHeaderContainerDesktopSpec,_super);function ProcessHeaderContainerDesktopSpec(){_super.apply(this,arguments);this.displayName="ProcessHeaderContainerDesktop"}ProcessHeaderContainerDesktopSpec.prototype.render=function(){var props={className:"processHeaderContainerDesktop group proxyProcessHeader initialized","data-id":"processcontainer"};if(this.props.dataContext.IsProcessBasedOnMultipleEntities())return React.DOM.noscript();if(!this.props.dataContext||!this.props.dataContext.get_ControlDescriptor()||!this.props.dataContext.get_FetchedViewModel()||!this.props.dataContext.get_Visible())if(this.props.dataContext.get_HasBusinessProcess()&&!this.props.dataContext.get_IsProcessHiddenByClientApi())return React.DOM.div(props);else return React.DOM.noscript();var processHeaderControl=null,stageWidth=200,screenWidth=WindowResizeHandler.getWindowWidth(),stages=screenWidth/stageWidth,maximumVisibleStages=Math.ceil(stages);processHeaderControl=ProcessHeaderDesktop.ProcessHeaderDesktop({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_FetchedViewModel(),descriptor:this.props.dataContext.get_ControlDescriptor(),stageWidth:stageWidth,maximumVisibleStages:maximumVisibleStages,isInteractionCentric:true});props["data-vmid"]=this.props.dataContext.get_ViewModelId();return React.DOM.div(props,processHeaderControl)};return ProcessHeaderContainerDesktopSpec}(ProcessHeaderContainer.ProcessHeaderContainerSpec);exports.ProcessHeaderContainerDesktop=DataWrapperComponent.wrapComponent(new ProcessHeaderContainerDesktopSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/FormNotification/Notification",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){var NotificationSpec=function(_super){__extends(NotificationSpec,_super);function NotificationSpec(){_super.apply(this,arguments);this.displayName="Notification";this.listenToProperties=["Text","MessageType"]}NotificationSpec.prototype.getInitialState=function(){return {textTruncated:false}};NotificationSpec.prototype.componentDidMount=function(){this.verifyTextTruncated()};NotificationSpec.prototype.componentDidUpdate=function(){this.verifyTextTruncated()};NotificationSpec.prototype.verifyTextTruncated=function(){if(this.props.onTextTruncated&&!this.state.textTruncated&&this.props.messageDialogViewModel==null){var textDOM=this.refs["text"],actiontextDOM=this.refs["actions"],messageBlockWidth=textDOM.scrollWidth;if(actiontextDOM instanceof HTMLElement)messageBlockWidth+=actiontextDOM.scrollWidth;var isTextTruncated=textDOM.parentElement.offsetWidth<messageBlockWidth||textDOM.offsetWidth<textDOM.scrollWidth;this.state.textTruncated!==isTextTruncated&&this.setState({textTruncated:isTextTruncated});this.props.onTextTruncated(isTextTruncated)}};NotificationSpec.prototype.onActionLinkClicked=function(actionIndex){var actions=this.props.dataContext&&this.props.dataContext.get_Actions()?this.props.dataContext.get_Actions().get_Items():null;actions&&actions.length&&actions[actionIndex].get_ActionCommand().execute();this.props.messageDialogViewModel!=null&&this.props.messageDialogViewModel.Close()};NotificationSpec.prototype.renderNotificationText=function(hasActions){if(this.props.dataContext.get_IsOfflineEnabledAndLocalCopyEntity()&&this.props.dataContext.get_IsError())return React.DOM.span({key:"text",ref:"text",className:CssClassSet({"messageBar-message":true,actionMessageBar:hasActions,localSaveIcon:true})},React.DOM.span({key:"text",ref:"text",className:CssClassSet({"messageBar-message":true,actionMessageBar:hasActions,errorIcon:this.props.dataContext.get_IsError()})},this.props.dataContext.get_Text()));else return React.DOM.span({key:"text",ref:"text",className:CssClassSet({"messageBar-message":true,actionMessageBar:hasActions,infoIcon:this.props.dataContext.get_IsInfo(),warningIcon:this.props.dataContext.get_IsWarning(),errorIcon:this.props.dataContext.get_IsError(),localSaveIcon:this.props.dataContext.get_IsLocalSave(),textTruncated:this.state.textTruncated})},this.props.dataContext.get_Text())};NotificationSpec.prototype.renderActions=function(actions){if(this.state.textTruncated)return React.DOM.noscript();for(var children=[],i=0;i<actions.get_Count();++i){var action=actions.get_Items()[i];children.push(React.DOM.a({key:"action"+i,className:"actionLink",onClick:this.onActionLinkClicked.bind(this,i)},[React.DOM.span({key:"symbol",className:"symbolFont arrowImage-symbol"}),React.DOM.span({key:"text",className:"actionlabel"},action.get_Text())]))}return React.DOM.div({key:"actions",ref:"actions",className:CssClassSet({actionlist:true,textTruncated:this.state.textTruncated})},children)};NotificationSpec.prototype.render=function(){var actions=this.props.dataContext.get_Actions?this.props.dataContext.get_Actions():null,hasActions=actions&&actions.get_Count(),children=[this.renderNotificationText(hasActions)];hasActions&&children.push(this.renderActions(actions));return React.DOM.div({className:"messageBar-messageBlock"},children)};return NotificationSpec}(TsAdapter.SpecBase);exports.Notification=DataWrapperComponent.wrapComponent(new NotificationSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/FormNotification/NotificationBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/FormNotification/Notification","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,Button,Notification,CssClassSet){var NotificationBarSpec=function(_super){__extends(NotificationBarSpec,_super);function NotificationBarSpec(){_super.apply(this,arguments);this.displayName="NotificationBar";this.listenToCollections=["MessageBarItems"];this.listenToProperties=["IsServerAvailable"]}NotificationBarSpec.prototype.getInitialState=function(){return {isShowingAll:false,isForcedHidden:false,isFirstNotificationTruncated:false,notificationPanelPaddingRight:null}};NotificationBarSpec.prototype.componentDidUpdate=function(){this.recalculateNotificationsPanelPadding()};NotificationBarSpec.prototype.recalculateNotificationsPanelPadding=function(){if(this.props.dataContext){var notifications=this.props.dataContext.get_MessageBarItems(),count=notifications.get_Count(),readAllComponent=this.refs["readAll"],notificationPanelPaddingRight=count>1||this.state.isFirstNotificationTruncated?$(ReactDOM.findDOMNode(readAllComponent)).outerWidth():null;this.state.notificationPanelPaddingRight!==notificationPanelPaddingRight&&this.setState({notificationPanelPaddingRight:notificationPanelPaddingRight})}};NotificationBarSpec.prototype.displayShowAllDialog=function(){if(this.props.dataContext){var notificationCollection=this.props.dataContext.get_MessageBarItems(),notificationsCount=notificationCollection.get_Count(),messageDialogViewModel=this.props.dataContext.get_ShowAllDialogViewModel();messageDialogViewModel.set_IsHtmlEncodingRequired(false);messageDialogViewModel.set_MessageObject(this.renderNotificationsPanel(notificationCollection,messageDialogViewModel,notificationsCount));messageDialogViewModel.set_OkHandler(this.onShowAllDialogClosed);messageDialogViewModel.Show()}!this.props.clientContext.isPhone&&this.setState({isForcedHidden:true})};NotificationBarSpec.prototype.onShowAllDialogClosed=function(){!this.props.clientContext.isPhone&&this.setState({isForcedHidden:false})};NotificationBarSpec.prototype.onFirstNotificationTruncated=function(isFirstNotificationTruncated){this.state.isFirstNotificationTruncated!==isFirstNotificationTruncated&&this.setState({isFirstNotificationTruncated:isFirstNotificationTruncated})};NotificationBarSpec.prototype.notificationCollectionDisplaysAction=function(notificationCollection,notificationsCount){if(notificationsCount===0)return false;var messageViewModel=notificationCollection.getItem(0);if(!messageViewModel||!messageViewModel.get_Actions)return false;return messageViewModel.get_Actions().get_Count()>0};NotificationBarSpec.prototype.renderNotificationItems=function(notificationCollection,messageDialogViewModel,notificationsCount){var notificationItems=[];if(notificationsCount>notificationCollection.get_Count())notificationsCount=notificationCollection.get_Count();for(var i=0;i<notificationsCount;++i){var notificationProps=notificationCollection.getItem(i);notificationItems.push(Notification.Notification({key:"notification"+i,dataContext:notificationProps,clientContext:this.props.clientContext,messageDialogViewModel:messageDialogViewModel,onTextTruncated:i===0?this.onFirstNotificationTruncated:null}))}return notificationItems};NotificationBarSpec.prototype.renderNotificationsPanel=function(notificationCollection,messageDialogViewModel,notificationsCount){var paddingStyleName=this.props.clientContext.isUserCultureRightToLeft?"paddingLeft":"paddingRight",style={};style[paddingStyleName]=this.state.notificationPanelPaddingRight;return React.DOM.div({key:"notificationsPanel",className:CssClassSet({"messageBar-messageRegion":true,"messageBar-withActions":this.notificationCollectionDisplaysAction(notificationCollection,notificationsCount)}),style:style},this.renderNotificationItems(notificationCollection,messageDialogViewModel,notificationsCount))};NotificationBarSpec.prototype.renderCountButton=function(notificationsCount){return Button.Button({key:"count",dataId:"count",className:CssClassSet({"messageBar-countButton":true,isVisible:notificationsCount>1}),onClick:this.displayShowAllDialog},React.DOM.span(null,notificationsCount))};NotificationBarSpec.prototype.renderReadAllButton=function(notificationsCount){var hasMultipleNotifications=notificationsCount>1,readAllButtonText=hasMultipleNotifications?this.props.clientContext.getLocalizedString("L_NotificationBar_ReadAll_Text"):this.props.clientContext.getLocalizedString("L_NotificationBar_ReadMore_Text");return Button.Button({key:"readAll",dataId:"readAll",ref:"readAll",className:"messageBar-readAllButton",onClick:this.displayShowAllDialog},React.DOM.span(null,readAllButtonText))};NotificationBarSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var notificationCollection=this.props.dataContext.get_MessageBarItems(),notificationsCount=notificationCollection.get_Count(),children=[this.renderNotificationsPanel(notificationCollection,null,1),this.renderCountButton(notificationsCount),this.renderReadAllButton(notificationsCount)];return React.DOM.div({className:CssClassSet({messageBar:true,isAssociatedWithOfflineRecord:this.props.dataContext.get_IsAssociatedWithOfflineRecord(),isHidden:!this.props.dataContext.get_IsActive()||this.state.isForcedHidden||!notificationsCount,isAssociatedWithCreateForm:this.props.dataContext.get_IsAssociatedWithCreateForm(),hasMultipleNotifications:notificationsCount>1,isFirstNotificationTruncated:this.state.isFirstNotificationTruncated,isOffline:!this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()})},React.DOM.div({className:"messageBar-scrollRegion"},children))};return NotificationBarSpec}(TsAdapter.SpecBase);exports.NotificationBar=DataWrapperComponent.wrapComponent(new NotificationBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/SetRegardingButton",["require","exports","Utils/CssClassSet","Core/ReactTypescriptAdapter","Components/Primitives/FontIcon","Components/DataWrapperComponent"],function(require,exports,CssClassSet,TsAdapter,FontIcon,DataWrapperComponent){exports.DESCRIPTOR_NAME="SetRegardingButton";var SetRegardingButtonSpec=function(_super){__extends(SetRegardingButtonSpec,_super);function SetRegardingButtonSpec(){_super.apply(this,arguments);this.displayName="SetRegardingButton";this.listenToProperties=["IsSetRegarding","IsActive","IsVisible"]}SetRegardingButtonSpec.prototype.handleClick=function(e){if(this.props.dataContext.get_IsActive()&&!this.props.dataContext.get_IsSetRegarding()){this.props.dataContext.onClick();e.stopPropagation();e.preventDefault()}};SetRegardingButtonSpec.prototype.render=function(){if(!this.props.dataContext.get_IsVisible())return null;var children=[FontIcon.FontIcon({symbolName:"LinkArticle"})],title=null;if(this.props.descriptor&&this.props.descriptor.Properties&&"Title" in this.props.descriptor.Properties)title=this.props.descriptor.Properties["Title"];this.props.dataContext.get_ShowLabel()&&children.push(React.DOM.span({className:CssClassSet(null,"setRegardingButton-label","commandButton-label")},this.props.dataContext.get_Label()));return React.DOM.button({key:"setRegarding",title:title,className:CssClassSet({"setReagding-on":this.props.dataContext.get_IsSetRegarding()},"setRegarding-commandButton",this.props.className),onShortPress:this.handleClick},children)};return SetRegardingButtonSpec}(TsAdapter.SpecBase);exports.SetRegardingButton=DataWrapperComponent.wrapComponent(new SetRegardingButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/ActionableCrmItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,FontIcon){exports.DESCRIPTOR_NAME="ActionableCrmItem";var ActionableCrmItemSpec=function(_super){__extends(ActionableCrmItemSpec,_super);function ActionableCrmItemSpec(){_super.apply(this,arguments);this.displayName="ActionableCrmItem"}ActionableCrmItemSpec.prototype.getInitialState=function(){return {collapsed:true}};ActionableCrmItemSpec.prototype.toggleClick=function(){this.setState({collapsed:!this.state.collapsed})};ActionableCrmItemSpec.prototype.renderOpenInWebButton=function(itemDataContext){var children=[FontIcon.FontIcon({symbolName:"PopOverButton"}),React.DOM.span({className:CssClassSet(null,"openInBrowserButton-label","commandButton-label")},this.props.clientContext.getLocalizedString("MoCA_OWA_OpenRecord"))];return React.DOM.button({key:"openInBrowser",className:CssClassSet(null,"openInBrowser-commandButton","commandButton"),onShortPress:this.props.openInBowserButtonShortPress},children)};ActionableCrmItemSpec.prototype.render=function(){var children=[React.DOM.div({className:"actionableCrmItemContent"},this.props.children)];children.push(React.DOM.button({className:"toggleButton"},FontIcon.FontIcon({symbolName:this.state.collapsed?"Expanded":"UpArrowHead"})));!this.state.collapsed&&children.push(React.DOM.div({className:"actionsButtonContainer"},this.props.openInBowserButtonShortPress?[this.props.setRegardingButton,this.renderOpenInWebButton()]:this.props.setRegardingButton));return React.DOM.div({key:"actionableCrmItem",className:CssClassSet({collapsed:this.state.collapsed,expanded:!this.state.collapsed},"actionableCrmItem",this.props.className),onShortPress:this.toggleClick},children)};return ActionableCrmItemSpec}(TsAdapter.SpecBase);exports.ActionableCrmItem=DataWrapperComponent.wrapComponent(new ActionableCrmItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/PopOutLinkLabel",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Common/Label","Utils/CssClassSet","Components/MailApp/SetRegardingButton","Components/MailApp/ActionableCrmItem"],function(require,exports,TsAdapter,PureUpdate,Label,CssClassSet,SetRegardingButton,ActionableCrmItem){exports.DESCRIPTOR_NAME="PopOutLinkLabel";var PopOutLinkLabelSpec=function(_super){__extends(PopOutLinkLabelSpec,_super);function PopOutLinkLabelSpec(){_super.apply(this,arguments);this.displayName="PopOutLinkLabel";this.mixins=[PureUpdate.Mixin];this.listenToProperties=["ShowSetRegardingButton"]}PopOutLinkLabelSpec.prototype.handleClick=function(){if(this.props.descriptor&&this.props.descriptor.Properties&&"PopOutLinkLabelCommandName" in this.props.descriptor.Properties){var popOutLinkCommandName=this.props.descriptor.Properties["PopOutLinkLabelCommandName"];this.props.dataContext.popOutLinkLabelClick(popOutLinkCommandName)}};PopOutLinkLabelSpec.prototype.getTitle=function(){var text="";if(this.props.dataContext)text=this.props.dataContext.get_Data();var title=text;if(this.props.descriptor&&this.props.descriptor.Properties&&"Title" in this.props.descriptor.Properties)title=this.props.descriptor.Properties["Title"];if(this.props.descriptor&&this.props.descriptor.Properties&&"TitleFormat" in this.props.descriptor.Properties){var titleFormat=this.props.descriptor.Properties["TitleFormat"];title=titleFormat.replace("{0}",title).replace("{1}",text)}return title};PopOutLinkLabelSpec.prototype.render=function(){if(!this.props.dataContext.get_Data())return null;var displayAsActionableCrmItem=this.props.descriptor&&this.props.descriptor.Properties&&"HasCollapseForAcompli" in this.props.descriptor.Properties&&this.props.clientContext.userAgent.get_IsMobilePhone(),setRegardingButton,children=[];this.props.descriptor&&this.props.descriptor.Properties&&"PrefixText" in this.props.descriptor.Properties&&children.push(React.DOM.span({key:"popOutLinkLabelPrefix",className:"popOutLinkLabelPrefix",title:this.getTitle(),onClick:displayAsActionableCrmItem?null:this.handleClick},this.props.descriptor.Properties["PrefixText"]));children.push(Label.Label({key:"label",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,onClick:displayAsActionableCrmItem?null:this.handleClick}));this.props.descriptor&&this.props.descriptor.Properties&&"SuffixText" in this.props.descriptor.Properties&&children.push(React.DOM.span({key:"popOutLinkLabelSuffix",className:"popOutLinkLabelSuffix",title:this.getTitle(),onClick:displayAsActionableCrmItem?null:this.handleClick},this.props.descriptor.Properties["SuffixText"]));if(this.props.dataContext.get_ShowSetRegardingButton()){var setRegardingButtonDescriptor;if(this.props.descriptor&&this.props.descriptor.Properties&&this.props.descriptor.Properties["SetRegardingButtonTitle"])setRegardingButtonDescriptor={__type:null,TypeName:null,ChildControlViewDescriptors:null,Properties:{Title:this.props.descriptor.Properties["SetRegardingButtonTitle"]}};var setRegardingButtonDataContext=this.props.dataContext.createSetRegardingButtonViewModel();setRegardingButtonDataContext.set_ShowLabel(displayAsActionableCrmItem);setRegardingButton=SetRegardingButton.SetRegardingButton({dataContext:setRegardingButtonDataContext,clientContext:this.props.clientContext,descriptor:setRegardingButtonDescriptor,className:"popoutSetRegardingButton"})}var className="popOutLinkLabel";if(this.props.descriptor&&this.props.descriptor.Properties&&"CssClassName" in this.props.descriptor.Properties)className=CssClassSet(null,className,this.props.descriptor.Properties["CssClassName"]);if(displayAsActionableCrmItem)return ActionableCrmItem.ActionableCrmItem({className:className,dataContext:this.props.dataContext,clientContext:this.props.clientContext,openInBowserButtonShortPress:this.handleClick.bind(this),setRegardingButton:setRegardingButton},children);else return React.DOM.div({key:"popOutLinkLabel",className:className},setRegardingButton?children.concat([setRegardingButton]):children)};return PopOutLinkLabelSpec}(TsAdapter.SpecBase);exports.PopOutLinkLabel=TsAdapter.createComponent(new PopOutLinkLabelSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/Feedback",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){exports.DESCRIPTOR_NAME="Feedback";var FeedbackSpec=function(_super){__extends(FeedbackSpec,_super);function FeedbackSpec(){_super.apply(this,arguments);this.displayName="Feedback";this.mixins=[PureUpdate.Mixin]}FeedbackSpec.prototype.handleClick=function(){var command=this.props.dataContext.get_OpenFeedbackCommand();command&&command.get_CanExecute()&&command.execute()};FeedbackSpec.prototype.handleKeyDown=function(e){e.key==="Enter"&&this.handleClick()};FeedbackSpec.prototype.render=function(){var descriptorClassName="";if(this.props.descriptor&&this.props.descriptor.Properties&&"CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];return React.DOM.div({className:CssClassSet({feedback:true},descriptorClassName)},React.DOM.img({src:"/nga/resources/images/feedback.png",onClick:this.handleClick,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onKeyDown:this.handleKeyDown}))};return FeedbackSpec}(TsAdapter.SpecBase);exports.Feedback=TsAdapter.createComponent(new FeedbackSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/FormHeaderEntityImage",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Image"],function(require,exports,TsAdapter,DataWrapperComponent,Image){exports.DESCRIPTOR_NAME="FormHeaderEntityImage";var FormHeaderEntityImageSpec=function(_super){__extends(FormHeaderEntityImageSpec,_super);function FormHeaderEntityImageSpec(){_super.apply(this,arguments);this.displayName="FormHeaderEntityImage";this.listenToProperties=["ImageUrl"]}FormHeaderEntityImageSpec.prototype.handleEntityImageClick=function(){if(this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()){var command=this.props.dataContext.get_OpenImageUploadDialogCommand();command&&command.get_CanExecute()&&command.execute()}};FormHeaderEntityImageSpec.prototype.render=function(){var imageUrl=this.props.dataContext.get_ImageUrl();if(imageUrl)return React.DOM.img({key:"formHeaderEntityImage",src:imageUrl,className:"formHeaderEntityImage",onClick:this.handleEntityImageClick});else{var entityName=this.props.dataContext.get_PrimaryModelName(),entityIcon=Image.Image({key:"entitySymbol",dataContext:null,clientContext:this.props.clientContext,placeholderClassName:entityName});return React.DOM.div({key:"entitySymbolContainer",className:entityName,onClick:this.handleEntityImageClick},entityIcon)}};return FormHeaderEntityImageSpec}(TsAdapter.SpecBase);exports.FormHeaderEntityImage=DataWrapperComponent.wrapComponent(new FormHeaderEntityImageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/CommandBar/CommandBarSection",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Common/FlyOutButton","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,FlyOutButton,CssClassSet){exports.DESCRIPTOR_NAME="CommandBarSection";var CommandBarSectionSpec=function(_super){__extends(CommandBarSectionSpec,_super);function CommandBarSectionSpec(){_super.apply(this,arguments);this.displayName="CommandBarSection";this.listenToProperties=["ActiveChildViewModels"]}CommandBarSectionSpec.prototype.getDefaultProps=function(){return {maximumVisibleCommands:5,isFormInCreateMode:false,areMultipleRecordSelected:false}};CommandBarSectionSpec.prototype.childDecorator=function(factory,props){props["flyOutPositioning"]=FlyOutButton.FlyOutPositioning.External;props["isICCommandBarFlyOut"]=true;props["commandBarTabIndex"]=this.props.dataContext.get_StartIndex();return factory(props)};CommandBarSectionSpec.prototype.renderWithOverflowFlyout=function(activeChildViewModels,overflowButton){var children=ComponentFactory.createComponentsFromViewModels(activeChildViewModels,this.props.clientContext,this.childDecorator);overflowButton&&children.push(overflowButton);return children};CommandBarSectionSpec.prototype.componentDidMount=function(){this.props.dataContext.RetrieveSaveButtonViewModelData();if(this.props.dataContext.get_IsInteractionCentricEnabled())$(".commandBarSectionContainer button:first")!==null&&$(".commandBarSectionContainer button:first").addClass("majorComponent")};CommandBarSectionSpec.prototype.render=function(){var activeChildViewModels=this.props.dataContext.FindFilteredViewModels(this.props.areMultipleRecordSelected);if(this.props.isFormInCreateMode)activeChildViewModels=this.props.dataContext.RetrieveInteractionCentricCreateModeCommands();var activeChildCount=activeChildViewModels.length,overflowButton=null,overflowCount=activeChildCount-this.props.maximumVisibleCommands;if(overflowCount>1){var overflowChildViewModels=activeChildViewModels.splice(this.props.maximumVisibleCommands);this.props.dataContext.get_OverflowViewModel().set_OverflowChildViewModels(overflowChildViewModels);overflowButton=FlyOutButton.FlyOutButton({key:"commandBarOverflowButton",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_OverflowViewModel(),flyOutChildrenParent:this.props.dataContext,childViewModels:overflowChildViewModels,flyOutPositioning:FlyOutButton.FlyOutPositioning.External,isICCommandBarFlyOut:true,label:this.props.clientContext.getLocalizedString("Ribbon_Menu_More"),imageType:"Symbol",imageName:"More",tabIndex:this.props.dataContext.get_StartIndex(),dataId:"MscrmOverflow",mountToElementWithId:"commandBarSection"})}var children=this.renderWithOverflowFlyout(activeChildViewModels,overflowButton);return React.DOM.div({id:"commandBarSection",className:CssClassSet({commandBarSection:true,commandBarSectionOff:this.props.dataContext.isCommandBarOff()},"commandBarSectionContainer"),"data-id":"commandBarSection"},children)};return CommandBarSectionSpec}(TsAdapter.SpecBase);exports.CommandBarSection=DataWrapperComponent.wrapComponent(new CommandBarSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/CommandBar/CommandBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Core/ComponentUpdateRequestManager","Components/ComponentFactory","Components/InteractionCentric/CommandBar/CommandBarSection"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ComponentUpdateRequestManager,ComponentFactory,CommandBarSection){exports.DESCRIPTOR_NAME="CommandBar";var CommandBarSpec=function(_super){__extends(CommandBarSpec,_super);function CommandBarSpec(){_super.apply(this,arguments);this.displayName="CommandBar";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["IsLoading","ShowGlobalAndPageCommands"];this.listenToCollections=["PageSections","ContextualSections"]}CommandBarSpec.prototype.getDefaultProps=function(){return {maxWidthOfCommands:150,isFormInCreateMode:false}};CommandBarSpec.prototype.getInitialState=function(){return {numOfCommandsToDisplay:5}};CommandBarSpec.prototype.configureEventListeners=function(){return {AfterRuleEvaluationEvent:this.afterRuleEvaluationEventHandler}};CommandBarSpec.prototype.afterRuleEvaluationEventHandler=function(){this.requestRender("CommandBar receieved an AfterRuleEvaluationEvent")};CommandBarSpec.prototype.requestRender=function(reason){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);this.updateManager.requestUpdate(reason)};CommandBarSpec.prototype.componentDidMount=function(){window.addEventListener("resize",this.handleResize);this.handleResize()};CommandBarSpec.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleResize)};CommandBarSpec.prototype.handleResize=function(){var maxVisisbleButtons=Math.floor(window.innerWidth/2/this.props.maxWidthOfCommands)-1;maxVisisbleButtons=maxVisisbleButtons<0?0:maxVisisbleButtons;this.state.numOfCommandsToDisplay!==maxVisisbleButtons&&this.setState({numOfCommandsToDisplay:maxVisisbleButtons})};CommandBarSpec.prototype.render=function(){var pageSections=this.props.dataContext.get_PageSections(),contextualSections=this.props.dataContext.get_ContextualSections(),maximumVisibleButtons=this.state.numOfCommandsToDisplay,pageSectionChildren=[],contextualSectionChildren=[],hasContextualSections=contextualSections.get_Count()>0,pageSectionDataContext="",contextualSectionDataContext="";if(hasContextualSections){contextualSectionChildren.push(CommandBarSection.CommandBarSection({key:"contextualSection",clientContext:this.props.clientContext,dataContext:contextualSections.getItem(0),maximumVisibleCommands:maximumVisibleButtons,isFormInCreateMode:this.props.isFormInCreateMode,areMultipleRecordSelected:this.props.dataContext.get_SelectedRowCount()>1?true:false}));contextualSectionDataContext=this.props.dataContext.get_ContextualContextId()}else if(this.props.dataContext.get_ShowGlobalAndPageCommands()&&pageSections.get_Count()>0){pageSectionChildren.push(CommandBarSection.CommandBarSection({key:"pageSection",clientContext:this.props.clientContext,dataContext:pageSections.getItem(0),maximumVisibleCommands:maximumVisibleButtons,isFormInCreateMode:this.props.isFormInCreateMode,areMultipleRecordSelected:this.props.dataContext.get_SelectedRowCount()>1?true:false}));pageSectionDataContext=this.props.dataContext.get_GlobalContextId()}var pageCommandsSection=React.DOM.div({key:"pageCommandsSection",className:"commandBar-pageSection","data-context":pageSectionDataContext},pageSectionChildren),contextualCommandsSection=React.DOM.div({key:"contextualCommandsSection",className:"commandBar-contextualSection","data-context":contextualSectionDataContext},contextualSectionChildren);return React.DOM.div({className:"commandBar-content",id:"commandBar-content"},[pageCommandsSection,contextualCommandsSection])};return CommandBarSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(CommandBarSection.DESCRIPTOR_NAME,CommandBarSection.CommandBarSection);exports.CommandBar=DataWrapperComponent.wrapComponent(new CommandBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/FormHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/ComponentFactory","Components/Shell/PageSearchHeader","Components/Search/SearchBox","Components/MailApp/Search/MailAppSearchBox","Components/MailApp/Search/MailAppRecentlyViewedItemList","Components/BusinessProcess/ProcessHeaderContainer","Components/BusinessProcess/ProcessHeaderContainerDesktop","Components/FormNotification/NotificationBar","Components/MailApp/PopOutLinkLabel","Components/MailApp/Feedback","Components/Shell/FormHeaderEntityImage","Components/InteractionCentric/CommandBar/CommandBar","Components/Common/Constants","Components/Primitives/ElementMountedHost"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,ComponentFactory,PageSearchHeader,SearchBox,MailAppSearchBox,MailAppRecentlyViewedItemList,ProcessHeaderContainer,ProcessHeaderContainerDesktop,NotificationBar,PopOutLinkLabel,Feedback,FormHeaderEntityImage,CommandBar,Constants,ElementMountedHost){exports.DESCRIPTOR_NAME="FormHeader";var FormHeaderSpec=function(_super){__extends(FormHeaderSpec,_super);function FormHeaderSpec(){_super.apply(this,arguments);this.displayName="FormHeader";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["Label","ShowIcon","ShowEntityImage","PrimaryModelName"]}FormHeaderSpec.prototype.componentDidMount=function(){this.props.clientContext.applicationShellViewModel.get_NavigationManager().add_PostNavigation(this.postNavigation)};FormHeaderSpec.prototype.componentWillUnmount=function(){this.props.clientContext.applicationShellViewModel.get_NavigationManager().remove_PostNavigation(this.postNavigation)};FormHeaderSpec.prototype.postNavigation=function(){this.forceUpdate()};FormHeaderSpec.prototype.handlePopOutIconClick=function(){if(this.props.descriptor&&this.props.descriptor.Properties&&"PopOutIconCommandName" in this.props.descriptor.Properties){var popOutIconCommandName=this.props.descriptor.Properties["PopOutIconCommandName"];this.props.dataContext.popOutIconClick(popOutIconCommandName)}};FormHeaderSpec.prototype.processHeaderSpan=function(){if(!this.props.clientContext.isPhone)return React.DOM.span({className:"headerProcessName",id:"headerProcessName",key:"name","data-id":"headerProcessName",style:{"float":"right"}})};FormHeaderSpec.prototype.renderContentForMailAppISH=function(){var children=[],showEntityImage=this.props.dataContext.get_ShowEntityImage();showEntityImage&&children.push(FormHeaderEntityImage.FormHeaderEntityImage({key:"formHeaderEntityImage",clientContext:this.props.clientContext,dataContext:this.props.dataContext,dataId:"formHeaderEntityImage"}));if(this.props.dataContext.get_ShowIcon()&&!this.props.dataContext.get_IsInteractionCentricForm())var icon=React.DOM.span({key:"icon",className:this.props.dataContext.get_SymbolCssClass()},null);var label=React.DOM.span({key:"label",className:this.props.dataContext.get_LabelCssClass()},this.props.dataContext.get_Label());children.push(React.DOM.div({key:"iconlabelcontainer",className:"formHeader__iconLabelContainer"},[icon,label]));if(this.props.dataContext.get_IsInteractionCentricForm()){var InteractionCentricCommandBar=CommandBar.CommandBar({key:"ICAppBar",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_CommandManagerViewModel(),isFormInCreateMode:this.props.dataContext.get_Root().get_FormMode()==1?true:false});children.push(InteractionCentricCommandBar)}children=children.concat(ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.props.childDecorator));return React.DOM.div({key:"formHeaderContent",className:"formHeaderContent"},children)};FormHeaderSpec.prototype.renderContent=function(){var textItemsContainerChildren=[],descriptor=this.props.descriptor,primaryAttributeKey="primaryAttribute",dashboardNameKey="DashboardName",primaryAttributeViewModel=this.props.dataContext.get_ChildViewModels()[primaryAttributeKey],dashboardViewModel=this.props.dataContext.get_ChildViewModels()[dashboardNameKey],truncatedDescriptor={TypeName:"FormHeader",ChildControlViewDescriptors:{},__type:"Control"};for(var key in descriptor.ChildControlViewDescriptors)if(key==primaryAttributeKey)var primaryAttributeViewDescriptor=this.props.descriptor.ChildControlViewDescriptors[key];else if(key==dashboardNameKey)var dashboardViewDescriptor=this.props.descriptor.ChildControlViewDescriptors[key];else truncatedDescriptor.ChildControlViewDescriptors[key]=descriptor.ChildControlViewDescriptors[key];primaryAttributeViewModel&&primaryAttributeViewDescriptor&&textItemsContainerChildren.push(ComponentFactory.createCustomComponent(primaryAttributeViewModel,primaryAttributeKey,primaryAttributeViewDescriptor,this.props.clientContext));dashboardViewModel&&dashboardViewDescriptor&&textItemsContainerChildren.push(ComponentFactory.createCustomComponent(dashboardViewModel,dashboardNameKey,dashboardViewDescriptor,this.props.clientContext));textItemsContainerChildren.push(React.DOM.div({key:"iconlabelcontainer",className:"formHeader__iconLabelContainer"},React.DOM.span({className:this.props.dataContext.get_LabelCssClass(),style:{"float":"left"}},this.props.dataContext.get_Label()),this.processHeaderSpan()));var headerBlockChildren=[],showEntityImage=this.props.dataContext.get_ShowEntityImage();if(showEntityImage)headerBlockChildren.push(FormHeaderEntityImage.FormHeaderEntityImage({key:"formHeaderEntityImage",clientContext:this.props.clientContext,dataContext:this.props.dataContext,dataId:"formHeaderEntityImage"}));else this.props.dataContext.get_ShowIcon()&&headerBlockChildren.push(React.DOM.span({key:"icon",className:this.props.dataContext.get_SymbolCssClass()}));headerBlockChildren.push(React.DOM.div({key:"textItemsContainer",className:"formHeader__textItemsContainer"},textItemsContainerChildren));var children=[];children.push(React.DOM.div({key:"headerBlock",className:"formHeader__headerBlock"},headerBlockChildren));children=children.concat(ComponentFactory.createChildComponents(this.props.dataContext,truncatedDescriptor,this.props.clientContext,this.props.childDecorator));return React.DOM.div({key:"formHeaderContent",className:"formHeaderContent"},children)};FormHeaderSpec.prototype.updateSearchButton=function(children){if(children&&children[0]&&children[0].props.children){var headerChild=children[0].props.children;for(var childKey in headerChild){var child=headerChild[childKey];if(child&&child.key==="PageSearchHeader"){if(this.props.dataContext.get_Root()===this.props.clientContext.applicationShellViewModel.get_CanvasConductor().get_Top()){child=React.DOM.div({key:"PageSearchHeader"+this.props.dataContext.get_Root().get_Id()},child);headerChild[childKey]=ElementMountedHost.ElementMountedHost({key:"PageSearchHeader"+this.props.dataContext.get_Root().get_Id(),parentId:"mountedSearchContainer"},child)}else headerChild[childKey]=null;break}}}};FormHeaderSpec.prototype.renderNotificationBar=function(rootVM){return NotificationBar.NotificationBar({key:"notifications",clientContext:this.props.clientContext,dataContext:rootVM.get_FormNotifications()})};FormHeaderSpec.prototype.onICHeaderKeyDownHandler=function(e){switch(e.key){case Constants.F8_KEY:this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey)}};FormHeaderSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var children=[];if(this.props.clientContext.isMailApp||this.props.clientContext.isInteractionCentric)children.push(this.renderContentForMailAppISH());else{children.push(this.renderContent());this.updateSearchButton(children)}var rootVM=this.props.dataContext.get_Root();rootVM&&!this.props.dataContext.get_IsInteractionCentricForm()&&children.push(this.renderNotificationBar(rootVM));var descriptorClassName="";if(this.props.descriptor&&this.props.descriptor.Properties&&"CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];return React.DOM.div({className:"formHeaderContainer",onKeyDown:this.props.dataContext.get_IsInteractionCentricForm?this.onICHeaderKeyDownHandler:null},React.DOM.div({className:descriptorClassName},children))};return FormHeaderSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(PageSearchHeader.DESCRIPTOR_NAME,PageSearchHeader.PageSearchHeader);ComponentFactory.registerComponentFactory(SearchBox.DESCRIPTOR_NAME,SearchBox.SearchBox);ComponentFactory.registerComponentFactory(MailAppSearchBox.DESCRIPTOR_NAME,MailAppSearchBox.MailAppSearchBox);ComponentFactory.registerComponentFactory(MailAppRecentlyViewedItemList.DESCRIPTOR_NAME,MailAppRecentlyViewedItemList.MailAppRecentlyViewedItemList);ComponentFactory.registerComponentFactory(ProcessHeaderContainer.DESCRIPTOR_NAME,ProcessHeaderContainer.ProcessHeaderContainer);ComponentFactory.registerComponentFactory(ProcessHeaderContainerDesktop.DESCRIPTOR_NAME,ProcessHeaderContainerDesktop.ProcessHeaderContainerDesktop);ComponentFactory.registerComponentFactory(PopOutLinkLabel.DESCRIPTOR_NAME,PopOutLinkLabel.PopOutLinkLabel);ComponentFactory.registerComponentFactory(Feedback.DESCRIPTOR_NAME,Feedback.Feedback);exports.FormHeader=DataWrapperComponent.wrapComponent(new FormHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ListComponentFormHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Shell/FormHeader"],function(require,exports,TsAdapter,DataWrapperComponent,FormHeader){exports.DESCRIPTOR_NAME="ListComponentFormHeader";var ListComponentFormHeaderSpec=function(_super){__extends(ListComponentFormHeaderSpec,_super);function ListComponentFormHeaderSpec(){_super.apply(this,arguments);this.displayName="ListComponentFormHeader";this.listenToProperties=["IsRelatedEntityHeader"]}ListComponentFormHeaderSpec.prototype.childDecorator=function(factory,childProps){if(childProps.key===this.props.dataContext.get_RelatedToEntityTitle())childProps["onClick"]=this.handleRelatedToLinkClick;return factory(childProps)};ListComponentFormHeaderSpec.prototype.handleRelatedToLinkClick=function(){this.props.dataContext.openParentEntityForm()};ListComponentFormHeaderSpec.prototype.render=function(){if(this.props.dataContext&&this.props.dataContext.get_IsRelatedEntityHeader())this.props.descriptor.Properties["CssClass"]+=" relatedEntityHeader";return FormHeader.FormHeader({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,childDecorator:this.childDecorator})};return ListComponentFormHeaderSpec}(TsAdapter.SpecBase);exports.ListComponentFormHeader=DataWrapperComponent.wrapComponent(new ListComponentFormHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Panorama/PanoramaItemTitle",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ErrorIndicator","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ErrorIndicator,CssClassSet){var PanoramaItemTitleSpec=function(_super){__extends(PanoramaItemTitleSpec,_super);function PanoramaItemTitleSpec(){_super.apply(this,arguments);this.displayName="PanoramaItemTitle";this.listenToProperties=["Label","TitleShortPressCommand","ErrorMessage"]}PanoramaItemTitleSpec.prototype.getTitleTextStyle=function(){var styles={};styles["color"]="#0070df";return styles};PanoramaItemTitleSpec.prototype.handleHeaderTextShortPress=function(e){var command=this.props.dataContext.get_TitleShortPressCommand();command&&command.get_CanExecute()&&command.execute()};PanoramaItemTitleSpec.prototype.handleHeaderTextLongPress=function(e){if(!this.props.dataContext.get_DisableHeaderLongPress()){this.props.clientContext.applicationShellViewModel.clearSelectedViewModels();this.props.dataContext.set_IsSelected(true)}};PanoramaItemTitleSpec.prototype.render=function(){var children=[];if(this.props.titleChildren)children=this.props.titleChildren.slice();var label=this.props.dataContext.get_Label();if(label&&label!=="&nbsp;"){this.props.dataContext.get_ErrorMessage()&&children.push(ErrorIndicator.ErrorIndicator({key:"error",errorMessage:this.props.dataContext.get_ErrorMessage(),clientContext:this.props.clientContext,dataContext:this.props.dataContext}));children.push(React.DOM.div({key:"titleText",className:CssClassSet({"panoramaItem-title-text":true,"panoramaItem-titleShortPressEnabled":this.props.dataContext.get_TitleShortPressCommand()}),style:this.getTitleTextStyle(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?-1:null},this.props.dataContext.get_Label(),this.props.titleSuffix))}if(!this.props.clientContext.isMailApp&&!this.props.clientContext.isInteractionCentric){var subTitle=this.props.dataContext.get_PluralName();subTitle&&children.push(React.DOM.div({key:"panoramaItem-subtitle",className:"header-subtitle"},subTitle))}if(children.length===0)return React.DOM.noscript();return React.DOM.div({className:CssClassSet({"panoramaItem-title":true,"panoramaItem-title-textAlignForErrorIndicator":this.props.dataContext.get_ErrorMessage()}),onShortPress:this.props.clientContext.isPreview?null:this.handleHeaderTextShortPress,onLongPress:this.props.clientContext.isPreview?null:this.handleHeaderTextLongPress},children)};return PanoramaItemTitleSpec}(TsAdapter.SpecBase);exports.PanoramaItemTitle=DataWrapperComponent.wrapComponent(new PanoramaItemTitleSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Panorama/PanoramaItemSeeMore",["require","exports","Core/ReactTypescriptAdapter","Utils/CssClassSet","Components/DataWrapperComponent"],function(require,exports,TsAdapter,CssClassSet,DataWrapperComponent){var PanoramaItemSeeMoreSpec=function(_super){__extends(PanoramaItemSeeMoreSpec,_super);function PanoramaItemSeeMoreSpec(){_super.apply(this,arguments);this.displayName="PanoramaItemSeeMore";this.listenToProperties=["RecordCount"]}PanoramaItemSeeMoreSpec.prototype.handleTextPress=function(e){var openGridCommand=this.props.dataContext.get_OpenGridCommand();openGridCommand.get_CanExecute()&&openGridCommand.execute();e.preventDefault()};PanoramaItemSeeMoreSpec.prototype.render=function(){var seeMoreTitleResource=this.props.clientContext.getLocalizedString("LabelForSeeMoreButton");return React.DOM.div({className:CssClassSet({stackedItemSeeMore:true,stackedItemSeeMoreHidden:this.props.dataContext.get_RecordCount()<=3}),onClick:this.handleTextPress,title:seeMoreTitleResource},seeMoreTitleResource)};return PanoramaItemSeeMoreSpec}(TsAdapter.SpecBase);exports.PanoramaItemSeeMore=DataWrapperComponent.wrapComponent(new PanoramaItemSeeMoreSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/Binding/SortableMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var SortableMixin=function(_super){__extends(SortableMixin,_super);function SortableMixin(){_super.apply(this,arguments)}SortableMixin.prototype.initializeSortable=function(){var node=ReactDOM.findDOMNode(this);if(node){var element=$(node).find(".sortable"),options={start:this.handleSortStart,stop:this.handleSortStop,sort:this.handleSort,disabled:true,containment:this.getContainmentElement?this.getContainmentElement():null};this.sortable=element.sortable(options)}};SortableMixin.prototype.fixHelperPositionRelativeToScrollOffset=function(e,ui){if(!ui||!this.sortable||!this.sortable.scrollParent()||this.props.clientContext.userAgent.get_IsBrowserIE())return;var touchOffset=e.pageY-ui.offset.top,top=e.pageY+this.sortable.scrollParent().scrollTop()-this.sortable.scrollParent().offset().top-touchOffset;ui.helper.css("top",top)};SortableMixin.prototype.handleSort=function(e,ui){this.fixHelperPositionRelativeToScrollOffset(e,ui)};SortableMixin.prototype.handleSortStart=function(e,ui){if(!this.props.dataContext)return;var startPos=ui.item.index();this.props.dataContext.sortStart(startPos)};SortableMixin.prototype.handleSortStop=function(e,ui){if(!this.props.dataContext||!this.sortable)return;var endPos=ui.item.index();this.shouldCancelSortable=true;this.props.dataContext.sortStop(endPos)};SortableMixin.prototype.disposeSortable=function(){if(this.sortable){this.sortable.sortable("destroy");this.sortable=null}};SortableMixin.prototype.componentDidMount=function(){this.props.dataContext&&this.props.dataContext.get_IsSortable()&&this.initializeSortable()};SortableMixin.prototype.componentWillUnmount=function(){this.disposeSortable()};SortableMixin.prototype.componentWillUpdate=function(){if(this.shouldCancelSortable){this.sortable.sortable("cancel");this.shouldCancelSortable=false}};SortableMixin.prototype.createSortableWrapper=function(children){if(this.props.dataContext&&this.props.dataContext.get_IsSortable()){var wrapper=React.DOM.div({key:"sortableWrapper",className:"sortable"},children);return wrapper}};return SortableMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new SortableMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/ScrollRegion",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){(function(ScrollDirection){ScrollDirection[ScrollDirection["None"]=0]="None";ScrollDirection[ScrollDirection["Vertical"]=1]="Vertical";ScrollDirection[ScrollDirection["Horizontal"]=2]="Horizontal"})(exports.ScrollDirection||(exports.ScrollDirection={}));var ScrollDirection=exports.ScrollDirection;exports.LastScrollDirection;exports.LastScrollTime;var ScrollRegionSpec=function(_super){__extends(ScrollRegionSpec,_super);function ScrollRegionSpec(){_super.apply(this,arguments);this.displayName="ScrollRegion";this.mixins=[PureUpdate.Mixin];this.scrollDebounceTimer=-1}ScrollRegionSpec.prototype.setScrollTop=function(value){if(this.isMounted()){var node=ReactDOM.findDOMNode(this);node.scrollTop=value}};ScrollRegionSpec.prototype.handleMouseWheel=function(e){if(this.shouldScrollVertically(e)){e.stopPropagation();exports.LastScrollDirection=ScrollDirection.Vertical;exports.LastScrollTime=Date.now()}};ScrollRegionSpec.prototype.handleScroll=function(e){e.stopPropagation();this.scrollDebounceTimer!==-1&&window.clearTimeout(this.scrollDebounceTimer);this.scrollDebounceTimer=window.setTimeout(this.fireScrollEnd,250)};ScrollRegionSpec.prototype.fireScrollEnd=function(){this.scrollDebounceTimer=-1;var node=ReactDOM.findDOMNode(this);this.props.onScrollEnd&&this.props.onScrollEnd({scrollHeight:node.scrollHeight,scrollTop:node.scrollTop,scrollContentHeight:$(node).outerHeight()})};ScrollRegionSpec.prototype.shouldScrollVertically=function(e){var lastScrollWasHorizontal=exports.LastScrollDirection===ScrollDirection.Horizontal,timeSinceLastScroll=e.timeStamp-exports.LastScrollTime,pauseTime=500;if(lastScrollWasHorizontal&&timeSinceLastScroll<pauseTime)return false;var isLocked=this.props&&this.props.scrollState&&this.props.scrollState.get_IsScrollLocked();if(isLocked)return false;return true};ScrollRegionSpec.prototype.componentWillUnmount=function(){this.scrollDebounceTimer!==-1&&window.clearTimeout(this.scrollDebounceTimer)};ScrollRegionSpec.prototype.render=function(){var initialProps={className:CssClassSet(null,"scrollRegion scrollingElement",this.props.className),onScroll:this.handleScroll,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,onFocus:this.props.onFocus,onBlur:this.props.onBlur,style:this.props.style,"data-vmid":this.props.viewModelId,onWheel:this.handleMouseWheel};if(this.props.wrapperInterceptor)return this.props.wrapperInterceptor(React.DOM.div,initialProps,this.props.children);return React.DOM.div(initialProps,this.props.children)};return ScrollRegionSpec}(TsAdapter.SpecBase);exports.ScrollRegion=TsAdapter.createComponent(new ScrollRegionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/LoadingBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/ComponentUpdateRequestManager","Components/Primitives/ProgressIndicator","Utils/LoadingManager"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentUpdateRequestManager,ProgressIndicator,LoadingManager){var LoadingBarSpec=function(_super){__extends(LoadingBarSpec,_super);function LoadingBarSpec(loadingPropertyName,activeWhenPropertyTrue){_super.call(this);this.loadingPropertyName=loadingPropertyName;this.activeWhenPropertyTrue=activeWhenPropertyTrue;this.displayName="LoadingBar";this.pendingPageAnimation=false;this.listenToProperties=[loadingPropertyName]}LoadingBarSpec.prototype.isLoadingActive=function(){var active=false;if(this.props.dataContext){var getter=this.props.dataContext["get_"+this.loadingPropertyName];if(getter){var value=getter.call(this.props.dataContext);active=this.activeWhenPropertyTrue?value:!value}}return active};LoadingBarSpec.prototype.componentDidUpdate=function(){this.props.onUpdate&&this.props.onUpdate();this.updatePageAnimationStatus()};LoadingBarSpec.prototype.componentDidMount=function(){this.updatePageAnimationStatus()};LoadingBarSpec.prototype.updatePageAnimationStatus=function(){var _this=this;if(this.pendingPageAnimation){LoadingManager.onAnimatingPageEnd(function(){if(_this.isLoadingActive()){if(!_this.updateManager)_this.updateManager=new ComponentUpdateRequestManager(_this);_this.updateManager.requestUpdate("LoadingBar is requesting an render via updatePageAnimationStatus()")}});this.pendingPageAnimation=false}};LoadingBarSpec.prototype.render=function(){var active=this.isLoadingActive();this.pendingPageAnimation=LoadingManager.isAnimatingPage();return ProgressIndicator.ProgressIndicator({type:ProgressIndicator.ProgressIndicatorType.Bar,active:active&&!this.pendingPageAnimation})};return LoadingBarSpec}(TsAdapter.SpecBase);function createLoadingBar(loadingPropertyName,activeWhenPropertyTrue){return DataWrapperComponent.wrapComponent(new LoadingBarSpec(loadingPropertyName,activeWhenPropertyTrue))}exports.createLoadingBar=createLoadingBar});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/ImageCheckbox",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,Button,CssClassSet){var ImageCheckboxSpec=function(_super){__extends(ImageCheckboxSpec,_super);function ImageCheckboxSpec(){_super.apply(this,arguments);this.displayName="ImageCheckbox";this.mixins=[PureUpdate.Mixin]}ImageCheckboxSpec.prototype.getDefaultProps=function(){return {dataId:"checkbox",role:"checkbox"}};ImageCheckboxSpec.prototype.render=function(){return Button.Button({className:CssClassSet(null,"checkbox",this.props.className),style:this.props.style,enabled:this.props.enabled,onClick:this.props.onClick,dataId:this.props.dataId,role:this.props.role,tabIndex:this.props.tabIndex,onKeyDown:this.props.onKeyDown},React.DOM.div({className:CssClassSet({"image-clear1x1-gif":!this.props.checked,"image-lv-chk-png":this.props.checked},"imageView csimg"),role:"img"}),this.props.children)};return ImageCheckboxSpec}(TsAdapter.SpecBase);exports.ImageCheckbox=TsAdapter.createComponent(new ImageCheckboxSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/ActivityListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/DefaultValueLabel","Components/Primitives/EntityFontIcon","Components/Primitives/ImageCheckbox","Components/Common/Constants","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,DefaultValueLabel,EntityFontIcon,ImageCheckbox,Constants,CssClassSet){exports.DESCRIPTOR_NAME="ActivityItem";var ActivityListItemSpec=function(_super){__extends(ActivityListItemSpec,_super);function ActivityListItemSpec(){_super.apply(this,arguments);this.displayName="ActivityListItem";this.listenToProperties=["IsToday","ActivityType","DueDateTime","Completed","CheckBoxEnabled"]}ActivityListItemSpec.prototype.handleCheckboxClick=function(e){if(this.props.dataContext.get_CheckBoxEnabled()){e.stopPropagation();this.props.dataContext.set_Completed(true)}};ActivityListItemSpec.prototype.handleOnKeyDownForCheckBox=function(e){if((e.key==Constants.SPACE_KEY||e.key==Constants.ENTER_KEY)&&this.props.dataContext.get_CheckBoxEnabled()){e.preventDefault();e.stopPropagation();this.props.dataContext.set_Completed(true);var listItemFocusable=$(document.activeElement).parents(".listItem")[0];listItemFocusable!=null&&$(listItemFocusable).focus()}};ActivityListItemSpec.prototype.render=function(){var iconContainerChildren=[];iconContainerChildren.push(EntityFontIcon.EntityFontIcon({key:"icon",entityName:this.props.dataContext.get_ActivityType(),className:"activityItemIcon"}));var isToday=this.props.dataContext.get_IsToday(),followed=this.props.dataContext.get_FollowEmail(),isdelayEmail=this.props.dataContext.get_DelayEmail(),emailEngagementFeatureEnabled=this.props.dataContext.get_IsEmailEngagementFeatureEnabled(),isFarEastLanguage=Microsoft.Crm.Client.Core.Storage.DataApi.DataSource.get_DefaultInstance().get_UserContext().get_UserSettings().get_IsFarEastLanguage();iconContainerChildren.push(React.DOM.span({key:"dueDate",className:CssClassSet({"activityItem-dueDate":true,"activityItem-today":isToday})},this.props.dataContext.get_DueDate()));!isToday&&iconContainerChildren.push(React.DOM.span({key:"dueMonth",className:CssClassSet({"activityItem-dueMonth":true,"activityItem-dueMonth-Followed":emailEngagementFeatureEnabled&&followed})},this.props.dataContext.get_DueMonth()));iconContainerChildren.push(React.DOM.span({key:"dueTime",className:CssClassSet({"activityItem-dueTime-Followed":emailEngagementFeatureEnabled&&followed,"activityItem-dueTime-Unfollowed":!emailEngagementFeatureEnabled||!followed,farEastLanguage:isFarEastLanguage})},this.props.dataContext.get_DueTime()));emailEngagementFeatureEnabled&&followed&&iconContainerChildren.push(React.DOM.span({key:"followemail",className:"activityItem-followemail"},followed?this.props.clientContext.getLocalizedString("ActivityItem_Followed_Label"):this.props.clientContext.getLocalizedString("ActivityItem_UnFollowed_Label")));var iconContainer=React.DOM.div({key:"iconContainer",className:CssClassSet({activityItemIconContainer:!emailEngagementFeatureEnabled||!followed,activityItem_FollowIconContainer:emailEngagementFeatureEnabled&&followed,activityItem_FollowUnFollowIcon:!this.props.dataContext.get_PastDue(),activityItem_pastDueIcon:this.props.dataContext.get_PastDue()})},iconContainerChildren),firstProperty=this.props.dataContext.get_FirstProperty();if(typeof firstProperty!="string")firstProperty=DefaultValueLabel.DEFAULT_VALUE_MASK;var emailAnalyticsTextContainer;if(emailEngagementFeatureEnabled&&(followed||isdelayEmail)){var wallText,lastOpenTime=this.props.dataContext.get_LastOpened(),seperatorSymbol=lastOpenTime==""?"":" | ";if(this.props.clientContext.isUserCultureRightToLeft)wallText=this.props.dataContext.get_LastOpened()+seperatorSymbol+this.props.dataContext.get_SentTime();else wallText=this.props.dataContext.get_SentTime()+seperatorSymbol+this.props.dataContext.get_LastOpened();emailAnalyticsTextContainer=React.DOM.div({key:"SentOpenedText",className:"activityItem-analytics"},[React.DOM.span({key:"sentoropenText",className:"activityItem-sentoropenText"},wallText)])}var textContainer=React.DOM.div({key:"text",className:"activityItem-text"},[React.DOM.span({key:"subject","data-fieldname":"subject",className:CssClassSet({"activityItem-subject":true,activityItem_completedText:this.props.dataContext.get_Completed()})},this.props.dataContext.get_Subject()),React.DOM.span({key:"subText","data-fieldname":"regardingobjectid",className:"activityItem-subText"},firstProperty),emailAnalyticsTextContainer]),checkbox=ImageCheckbox.ImageCheckbox({key:"checkbox",className:"imageCheckbox",enabled:this.props.dataContext.get_CheckBoxEnabled(),checked:this.props.dataContext.get_Completed(),onClick:this.handleCheckboxClick,tabIndex:this.props.dataContext.get_NextTabIndex(),onKeyDown:this.handleOnKeyDownForCheckBox});return React.DOM.div({className:"activityListItem"},[iconContainer,textContainer,checkbox])};return ActivityListItemSpec}(TsAdapter.SpecBase);exports.ActivityListItem=DataWrapperComponent.wrapComponent(new ActivityListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppSenderFormActivityItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/EntityFontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,EntityFontIcon){exports.DESCRIPTOR_NAME="MailAppSenderFormActivityItem";var MailAppSenderFormActivityItemSpec=function(_super){__extends(MailAppSenderFormActivityItemSpec,_super);function MailAppSenderFormActivityItemSpec(){_super.apply(this,arguments);this.displayName="MailAppSenderFormActivityItem"}MailAppSenderFormActivityItemSpec.prototype.render=function(){var iconContainer=React.DOM.div({key:"iconContainer",className:"iconContainer"},EntityFontIcon.EntityFontIcon({key:"icon",entityName:this.props.dataContext.get_ActivityType(),className:"activityItemIcon"})),childrens=[];childrens.push(React.DOM.span({key:"dueDate",className:"activityItem-activityDate"},String.format("{0} {1}",this.props.dataContext.get_FormattedDueDate(),this.props.dataContext.get_DueTime())));var activityTitle=this.props.dataContext.get_Root().getActivityParentListTitle(this.props.dataContext.get_ModelContext().get_Id());childrens.push(React.DOM.span({key:"activityHeader",className:"activityItem-activityHeader"},activityTitle));childrens.push(React.DOM.span({key:"activitySubject",className:"activityItem-activitySubject"},this.props.dataContext.get_Subject()));var descriptionContainer=React.DOM.div({key:"itemDetails",className:"itemDetails"},childrens);return React.DOM.div({className:"senderFormActivityItem"},[iconContainer,descriptionContainer])};return MailAppSenderFormActivityItemSpec}(TsAdapter.SpecBase);exports.MailAppSenderFormActivityItem=DataWrapperComponent.wrapComponent(new MailAppSenderFormActivityItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/PinnedTile",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/Common/DynamicsButton","Components/Common/Image","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,DynamicsButton,Image,CssClassSet){var TileMode;(function(TileMode){TileMode[TileMode["square"]=0]="square";TileMode[TileMode["wide"]=1]="wide"})(TileMode||(TileMode={}));exports.DESCRIPTOR_NAME="CrmTile";var PinnedTileSpec=function(_super){__extends(PinnedTileSpec,_super);function PinnedTileSpec(){_super.apply(this,arguments);this.displayName="PinnedTile";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["CanExecute","Enabled","LeftCornerText","RightCornerText","Text1","Text2","Text3","Text4","Text5","Text6","ImageSource","EntityTypeName","TileMode"];this.componentDidUpdate=function(){var el=ReactDOM.findDOMNode(this);$(el).hasClass("parentDisplay")&&$(el).parent().css("display","none")};this.componentDidMount=function(){var el=ReactDOM.findDOMNode(this);$(el).hasClass("parentDisplay")&&$(el).parent().css("display","none")}}PinnedTileSpec.prototype.renderTileTextContainer=function(){var tileTextContainerChildren=[React.DOM.span({key:"text1",id:"TileText1",className:"tileText tileText1"},this.props.dataContext.get_Text1()),React.DOM.span({key:"text2",id:"TileText2",className:"tileText tileText2","data-fieldname":this.props.dataContext.get_TileText2FieldName()},this.props.dataContext.get_Text2()),React.DOM.span({key:"text3",id:"TileText3",className:"tileText tileText3","data-fieldname":this.props.dataContext.get_TileText3FieldName()},this.props.dataContext.get_Text3()),React.DOM.span({key:"text4",id:"TileText4",className:"tileText tileText4","data-fieldname":this.props.dataContext.get_TileText4FieldName()},this.props.dataContext.get_Text4())];return React.DOM.div({key:"textContainer",className:"tileTextContainer"},tileTextContainerChildren)};PinnedTileSpec.prototype.renderTileButtonContainer=function(){var tileButtonContainerChildren=[];this.props.dataContext.get_Button1ViewModel()&&tileButtonContainerChildren.push(DynamicsButton.DynamicsButton({key:"tileButton1",parentGivenKey:"tileButton1",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Button1ViewModel(),showWhenDisabled:true,className:CssClassSet({tileButton:true,tileButton1:true,buttonOutlinedDisabled:this.props.dataContext.get_Button1ViewModel().get_ActionCommand().get_CanExecute()}),"data-id":"mailbutton"}));this.props.dataContext.get_Button3ViewModel()&&tileButtonContainerChildren.push(DynamicsButton.DynamicsButton({key:"tileButton3",parentGivenKey:"tileButton3",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Button3ViewModel(),showWhenDisabled:true,className:CssClassSet({tileButton:true,tileButton3:true,buttonOutlinedDisabled:this.props.dataContext.get_Button3ViewModel().get_ActionCommand().get_CanExecute()}),"data-id":"callbutton"}));return React.DOM.div({key:"tileButtons",className:"tileButtonContainer"},tileButtonContainerChildren)};PinnedTileSpec.prototype.getEntityColor=function(){var vm=this.props.dataContext,cm=this.props.clientContext;if(vm&&cm&&cm.theming.IsEnabled)return cm.theming.getEntityColor(vm.get_TargetLogicalName());return null};PinnedTileSpec.prototype.render=function(){var children=[],childrenText=[React.DOM.span({key:"leftCornerText",className:"tileLeftCornerText"},this.props.dataContext.get_LeftCornerText()),React.DOM.span({key:"rightCornerText",className:"tileRightCornerText","data-fieldname":"telephone1"},this.props.dataContext.get_RightCornerText()),this.renderTileTextContainer(),React.DOM.span({key:"text5",id:"TileText5",className:"tileText tileText5","data-fieldname":this.props.dataContext.get_TileText5FieldName()},this.props.dataContext.get_Text5()),React.DOM.span({key:"text6",id:"TileText6",className:"tileText tileText6"},this.props.dataContext.get_Text6())];children.push(React.DOM.div({key:"tileTextItems",className:"tileTextItems"},childrenText));var entityColor=this.getEntityColor();if(this.props.dataContext.get_HasCommunicationCardIconBackground()){var communicationCardStyles={};if(entityColor!=null)communicationCardStyles["backgroundColor"]=entityColor;children.push(React.DOM.div({key:"communicationCardIconBackground",className:"tileImage1",style:communicationCardStyles}))}var imageViewModel=this.props.dataContext.get_ImageViewModel(),hasImage=false;if(imageViewModel&&imageViewModel.get_Data()){var image=Image.Image({key:"image",dataContext:this.props.dataContext.get_ImageViewModel(),clientContext:this.props.clientContext,className:"tileImage1"});children.push(image);hasImage=true}var icon=Image.Image({key:"entity-symbol",dataContext:null,clientContext:this.props.clientContext,placeholderClassName:CssClassSet({"entity-symbol":true,crmSymbolFont:true,placeHolderImage:true,hasImage:hasImage},this.props.dataContext.get_EntityTypeName())});children.push(icon);children.push(this.renderTileButtonContainer());var styles={};if(this.props.dataContext.get_HideTile()||this.props.dataContext.get_TargetType()===2&&!this.props.dataContext.get_Enabled())styles["display"]="none";if(entityColor!=null)styles["backgroundColor"]=entityColor;return React.DOM.div({className:CssClassSet({crmtile:true,tileGradient:true,crmtileandroid:this.props.clientContext.userAgent.get_IsAndroid(),crmtilelookup:this.props.dataContext.get_TargetType()===3,parentDisplay:styles["display"]=="none"},this.props.dataContext.get_EntityTypeName(),"tile"+TileMode[this.props.dataContext.get_TileMode()]),disabled:this.props.dataContext.get_Enabled(),"data-id":"TileHeader","data-tiletype":this.props.dataContext.get_TileType(),"data-name":this.props.dataContext.get_TargetLogicalName(),"data-guid":this.props.dataContext.get_TargetGuid(),"data-fieldname":this.props.dataContext.get_TargetEntityPrimaryField(),"data-vmid":this.props.dataContext.get_ViewModelId(),style:styles},children)};return PinnedTileSpec}(TsAdapter.SpecBase);exports.PinnedTile=DataWrapperComponent.wrapComponent(new PinnedTileSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/Rollup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/DefaultValueLabel","Utils/CssClassSet","Components/Primitives/Button"],function(require,exports,TsAdapter,DataWrapperComponent,DefaultValueLabel,CssClassSet,Button){exports.DESCRIPTOR_NAME="Rollup";var MIN_HEIGHT_WITH_RECALCULATE_ENABLED=130,MIN_HEIGHT_WITHOUT_RECALCULATE_ENABLED=64,CONFIRM_BUTTON_EXTRA_MARGIN=8,EXTRA_PIXELS_PER_LINE=20,RollupSpec=function(_super){__extends(RollupSpec,_super);function RollupSpec(){_super.apply(this,arguments);this.displayName="Label";this.listenToProperties=["Data","RollupState","LastUpdated","LastUpdatedLabel","Root","UseHiddenMask"]}RollupSpec.prototype.getInitialState=function(){return {margin:0}};RollupSpec.prototype.recalculate=function(){var command=this.props.dataContext.get_CalculateFieldCommand();command&&command.get_CanExecute()&&command.execute()};RollupSpec.prototype.calculateControlMargin=function(){if(!(this.props.descriptor.Properties["IsHeaderField"]&&this.props.clientContext.isPhone)){var controlLabel=$(ReactDOM.findDOMNode(this)).parents(".section_control").children(".control_label").children("label"),margin=0;if(controlLabel.length>0){var controlLabelHeight=controlLabel[0].clientHeight;margin=(Math.floor(controlLabelHeight/EXTRA_PIXELS_PER_LINE)-1)*EXTRA_PIXELS_PER_LINE;this.setState({margin:margin})}}};RollupSpec.prototype.forceRerender=function(e,propertyName){this.forceUpdate()};RollupSpec.prototype.componentDidMount=function(){this.calculateControlMargin();this.props.clientContext.applicationShellViewModel.apcl("IsServerAvailable",this.forceRerender)};RollupSpec.prototype.componentWillUnmount=function(){this.props.clientContext.applicationShellViewModel.rpcl("IsServerAvailable",this.forceRerender)};RollupSpec.prototype.getLabels=function(){if(this.props.descriptor.Properties["IsHeaderField"]&&this.props.clientContext.isPhone)return null;var lastUpdatedLabel=React.DOM.span({key:"lastUpdatedLabel",className:"rollupLastUpdatedLabel",style:{marginTop:this.state.margin}},this.props.dataContext.get_LastUpdatedLabel()),lastUpdatedValue=React.DOM.span({key:"lastUpdatedValue",className:"rollupLastUpdatedValue",style:{marginTop:this.state.margin}},this.props.dataContext.get_UseHiddenMask()?DefaultValueLabel.SECURE_VALUE_MASK:this.props.dataContext.get_LastUpdated()||DefaultValueLabel.DEFAULT_VALUE_MASK);return React.DOM.div({key:"labelContainers",className:"rollupLabelContainers"},[lastUpdatedLabel,lastUpdatedValue])};RollupSpec.prototype.getMinHeight=function(isRecalculateEnabled){if(this.props.descriptor.Properties["IsHeaderField"]&&this.props.clientContext.isPhone)return 0;else return isRecalculateEnabled?MIN_HEIGHT_WITH_RECALCULATE_ENABLED+this.state.margin:MIN_HEIGHT_WITHOUT_RECALCULATE_ENABLED+this.state.margin};RollupSpec.prototype.render=function(){var isRecalculateEnabled=this.props.inActiveSection&&this.props.dataContext.get_IsRecalculateEnabled(),isPhoneHeader=this.props.descriptor.Properties["IsHeaderField"]&&this.props.clientContext.isPhone,lastUpdatedLabelText=this.props.dataContext.get_UseHiddenMask()?DefaultValueLabel.SECURE_VALUE_MASK:this.props.dataContext.get_Data()||DefaultValueLabel.DEFAULT_VALUE_MASK,valueSymbol=React.DOM.span({key:"valueSymbol",className:"rollupValue Recalculate-symbol"},this.props.dataContext.get_DidRecalculate()?this.props.dataContext.get_LastUpdatedLabel():lastUpdatedLabelText);this.props.dataContext.set_DidRecalculate(false);var children=[valueSymbol,this.getLabels()];if(isRecalculateEnabled&&!isPhoneHeader){var rollupRecalculateLabel=React.DOM.span({key:"rollupRecalculateLabel",className:"rollupRecalculateLabel",style:{marginTop:this.state.margin}},this.props.clientContext.getLocalizedString("RollupFieldRecalculateString"));children.push(rollupRecalculateLabel);var button=Button.Button({key:"button",className:"button dynamicsButton rollup_OK_Button",onClick:this.recalculate,style:{marginTop:this.state.margin+CONFIRM_BUTTON_EXTRA_MARGIN}},this.props.clientContext.getLocalizedString("L_OK_Text"));children.push(button)}return React.DOM.div({className:CssClassSet({rollup:true,expanded:isRecalculateEnabled&&!isPhoneHeader}),style:{minHeight:this.getMinHeight(isRecalculateEnabled)}},children)};return RollupSpec}(TsAdapter.SpecBase);exports.Rollup=DataWrapperComponent.wrapComponent(new RollupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/DetailFieldsSection",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Fields/EditableSection"],function(require,exports,TsAdapter,PureUpdate,EditableSection){exports.DESCRIPTOR_NAME="DetailFieldsSection";exports.DETAIL_FIELD_SECTION_CSS_CLASS="fieldsSectionView detailFieldsSectionView";var DetailFieldsSectionSpec=function(_super){__extends(DetailFieldsSectionSpec,_super);function DetailFieldsSectionSpec(){_super.apply(this,arguments);this.displayName="DetailFieldsSection";this.mixins=[PureUpdate.Mixin]}DetailFieldsSectionSpec.prototype.render=function(){return React.DOM.div({className:exports.DETAIL_FIELD_SECTION_CSS_CLASS},EditableSection.EditableSection({dataContext:this.props.dataContext,clientContext:this.props.clientContext,descriptor:this.props.descriptor,renderExtraChildren:this.props.renderExtraChildren,onKeyDown:this.props.onKeyDown,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null}))};return DetailFieldsSectionSpec}(TsAdapter.SpecBase);exports.DetailFieldsSection=TsAdapter.createComponent(new DetailFieldsSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/HierarchicalSubjectControl/HierarchicalSubject",["require","exports","Core/ReactTypescriptAdapter","Components/Primitives/Button","Components/DataWrapperComponent","Components/Primitives/FontIcon","Components/Primitives/Popup","Components/Primitives/AncestorMountedHost","Core/Binding/WindowResizeHandlerMixin","Utils/ZIndexFinder","Components/Common/Constants","Components/Common/AccessibilityUtility","Core/Binding/FocusHandlerMixin"],function(require,exports,TsAdapter,Button,DataWrapperComponent,FontIcon,Popup,AncestorMountedHost,WindowResizeHandler,ZIndexFinder,Constants,AccessibilityUtility,FocusHandlerMixin){exports.DESCRIPTOR_NAME="HierarchicalSubjectControl";var HierarchicalSubjectControlSpec=function(_super){__extends(HierarchicalSubjectControlSpec,_super);function HierarchicalSubjectControlSpec(){_super.apply(this,arguments);this.displayName="HierarchicalSubjectControl";this.zIndex=1500;this.SEARCH_HEIGHT=30;this.MIN_ROW_COUNT=3;this.PADDING=5;this.SUBJECT_LEFT_OFFSET=25;this.SUBJECT_LINE_ITEM_HEIGHT=28;this.SUBJECT_POPUP_BORDER_WIDTH=1;this.POPUP_MIN_WIDTH=300;this.listenToProperties=["Visible","SubjectsLoaded","Data","Text"];this.rowCount=0;this.mixins=[WindowResizeHandler.Mixin,FocusHandlerMixin.Mixin]}HierarchicalSubjectControlSpec.prototype.handleSubjectLookupButtonClick=function(){this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible());this.calculateRowCount();this.calculatePosition(this.rowCount)};HierarchicalSubjectControlSpec.prototype.handleSubjectLookupButtonKeyEvents=function(e){if(e&&e.target){var kc=e.keyCode;switch(kc){case Constants.SPACE_KEY_CODE:case Constants.ENTER_KEY_CODE:this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible());this.calculateRowCount();this.calculatePosition(this.rowCount);break}}};HierarchicalSubjectControlSpec.prototype.getInitialState=function(){return {lookupListCount:0,isDropDownButtonExpanded:false,lookupDropBoxWidth:0}};HierarchicalSubjectControlSpec.prototype.handleWindowResize=function(){this.calculatePosition(this.rowCount)};HierarchicalSubjectControlSpec.prototype.focusNextMajorComponent=function(isShiftKey){var domNode=ReactDOM.findDOMNode(this);domNode!=null&&$(domNode).parent()!=null&&this.props.clientContext.focusNextMajorComponent($(domNode).parent(),isShiftKey)};HierarchicalSubjectControlSpec.prototype.handleButtonClick=function(idElem){this.props.dataContext.ToggleState(idElem);this.calculateRowCount();this.calculatePosition(this.rowCount);this.setState({isDropDownButtonExpanded:!this.state.isDropDownButtonExpanded})};HierarchicalSubjectControlSpec.prototype.callbackForToggleButton=function(){var subjectItemToFocus=$(".subjectTitle")[this.props.dataContext.get_ItemIndex()];if(subjectItemToFocus!=null){this.props.dataContext.get_ItemIndex()===0&&this.props.dataContext.get_Text()===""&&$(subjectItemToFocus).attr("aria-label",this.defaultFocusScreenReaderText(subjectItemToFocus.textContent));$(subjectItemToFocus).focus()}};HierarchicalSubjectControlSpec.prototype.defaultFocusScreenReaderText=function(selectedNode){var screenReaderText="";if(this.props.dataContext.get_Label())screenReaderText+=this.props.dataContext.get_Label()+". ";if(selectedNode!=null&&selectedNode!="")screenReaderText+=selectedNode+". ";if(this.props.descriptor){var typeName=this.props.descriptor.TypeName,controlTypeName=AccessibilityUtility.getScreenReaderTypeName(typeName);screenReaderText+=controlTypeName}return screenReaderText};HierarchicalSubjectControlSpec.prototype.handleSubjectLabelClick=function(subjectId){this.props.dataContext.SetValue(subjectId);this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible())};HierarchicalSubjectControlSpec.prototype.focusOnParentSectionControl=function(){var domNode=ReactDOM.findDOMNode(this);$(domNode).parents(".section_control").focus()};HierarchicalSubjectControlSpec.prototype.handleSubjectLabelKeyDown=function(idElem,subjectId,childCount,e){var currentItem=e.currentTarget;switch(e.key){case Constants.ESCAPE_KEY:var subjectTextBox=$(".subjecttextbox")[0];if(subjectTextBox!=null){$(subjectTextBox).focus();this.props.dataContext.set_Visible(false)}break;case Constants.TAB_KEY:var index=e.shiftKey?this.props.dataContext.get_ItemIndex()-1:this.props.dataContext.get_ItemIndex()+1;if(index>-1)if($(".subjectTitle")[index]){if(index===0){var subjectItemToFocus=$(".subjectTitle")[index];subjectItemToFocus!=null&&$(subjectItemToFocus).attr("aria-label",subjectItemToFocus.textContent)}this.props.dataContext.set_ItemIndex(index)}else{this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible());this.props.dataContext.set_HasFocus(false);this.focusOnParentSectionControl()}break;case Constants.ENTER_KEY:this.handleSubjectLabelClick(idElem);this.props.dataContext.set_HasFocus(false);var domNode=ReactDOM.findDOMNode(this);domNode!=null&&$(domNode).parents(".section_control").attr("aria-label",this.props.dataContext.selectedNodeScreenReaderText(subjectId));this.focusOnParentSectionControl();break;case Constants.DOWN_ARROW_KEY:case Constants.UP_ARROW_KEY:e.preventDefault();var index=e.key==Constants.DOWN_ARROW_KEY?this.props.dataContext.get_ItemIndex()+1:this.props.dataContext.get_ItemIndex()-1,subjectItemToFocus=$(".subjectTitle")[index];if(subjectItemToFocus!=null){$(subjectItemToFocus).focus();this.props.dataContext.set_ItemIndex(index)}break;case Constants.RIGHT_ARROW_KEY:case Constants.LEFT_ARROW_KEY:e.preventDefault();childCount>0&&this.handleButtonClick(idElem);break;case Constants.F8_KEY:this.focusNextMajorComponent(e.shiftKey);break}};HierarchicalSubjectControlSpec.prototype.isHostedInPopup=function(){var popupVieModelName=Object.getType(this.getNavigationStackTop()).getName();return popupVieModelName=="Microsoft.Crm.Client.Core.ViewModels.QuickCreateFormViewModel"||popupVieModelName=="Microsoft.Crm.Client.Core.ViewModels.CrmDialogViewModel"?true:false};HierarchicalSubjectControlSpec.prototype.componentDidMount=function(){if(this.state.lookupDropBoxWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupDropBoxWidth:lookupWidth})}var subjectLookup=this.refs["subjectLookupPopupDiv"];if(subjectLookup instanceof Element){var domNode=$(subjectLookup);domNode.data("IsPopup",true);domNode.data("IsModal",true);domNode.click(this.interceptClick)}if(this.rowCount<this.MIN_ROW_COUNT)this.rowCount=this.MIN_ROW_COUNT;this.calculatePosition(this.rowCount);this.calculatePosition(this.rowCount);this.props.dataContext.set_Visible(false);if(this.shouldTakeFocus())if(subjectLookup instanceof Element){var foc=$(subjectLookup).find("input");foc.focus()}};HierarchicalSubjectControlSpec.prototype.componentWillMount=function(){this.props.dataContext.FetchData();this.zIndex=ZIndexFinder()+2};HierarchicalSubjectControlSpec.prototype.componentWillUnmount=function(){var subjectLookup=this.refs["subjectLookupPopupDiv"];subjectLookup instanceof Element&&$(subjectLookup).unbind()};HierarchicalSubjectControlSpec.prototype.calculatePosition=function(count){if(this.isMounted()!==true)return;if(!this.props.dataContext.get_Visible())count=0;var lookupListBelow=true,screenWidth=WindowResizeHandler.getWindowWidth(),screenHeight=WindowResizeHandler.getWindowHeight(),newListTop=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().top,newListLeft=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().left,subjectLookupPopupHeight=this.SUBJECT_POPUP_BORDER_WIDTH*2+count*this.SUBJECT_LINE_ITEM_HEIGHT,popUpWidth=this.state.lookupDropBoxWidth<this.POPUP_MIN_WIDTH?this.POPUP_MIN_WIDTH:this.state.lookupDropBoxWidth,displacementX=screenWidth-(newListLeft+popUpWidth);if(displacementX<0)newListLeft=newListLeft+displacementX-this.PADDING;var height=this.SEARCH_HEIGHT+subjectLookupPopupHeight,newDisplacementY=screenHeight-(newListTop+height);if(newDisplacementY<0)if(newListTop>=subjectLookupPopupHeight){newDisplacementY=-1*(height+1);height=subjectLookupPopupHeight}else if(newListTop>screenHeight-newListTop){newDisplacementY=-1*(newListTop+this.SEARCH_HEIGHT+1);height=newListTop-this.PADDING}else{newDisplacementY=1;height=screenHeight-(newListTop+this.PADDING+this.SEARCH_HEIGHT)}else{newDisplacementY=1;height=subjectLookupPopupHeight}this.state.lookupTop!==newListTop&&this.setState({lookupTop:newListTop});this.state.lookupLeft!==newListLeft&&this.setState({lookupLeft:newListLeft});this.state.displacementY!==newDisplacementY&&this.setState({displacementY:newDisplacementY});this.state.lookupListCount!==count&&this.setState({lookupListCount:count});this.state.lookupHeight!==height&&this.setState({lookupHeight:height});if(this.state.lookupDropBoxWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupDropBoxWidth:lookupWidth})}};HierarchicalSubjectControlSpec.prototype.calculateInnerRowCount=function(subjectNode,count,isFirstLevel){if(subjectNode.GetChildCount()!=0&&subjectNode.get_State()==1)for(var childSubjects=subjectNode.get_Children(),j=0;j<childSubjects.get_Count();j++){this.rowCount++;var childSubject=childSubjects.get_Items()[j];this.calculateInnerRowCount(childSubject,count++,false)}};HierarchicalSubjectControlSpec.prototype.calculateRowCount=function(){this.rowCount=0;if(this.props.dataContext.get_IsLoading())return;for(var firstLevelSubjects=this.props.dataContext.get_FirstLevelSubjects(),i=0;i<firstLevelSubjects.get_Count();i++){this.rowCount++;var subjectItemNode=firstLevelSubjects.get_Items()[i];this.calculateInnerRowCount(subjectItemNode,i,true)}};HierarchicalSubjectControlSpec.prototype.renderNode=function(subjectNode,count,subjectDepth){var viewModel=this.props.dataContext,nextTabIndex=viewModel.get_NextTabIndex(),childSubjectNodes=[];if(subjectNode.GetChildCount()!=0&&subjectNode.get_State()==1)for(var childSubjects=subjectNode.get_Children(),j=0;j<childSubjects.get_Count();j++){this.rowCount++;var childSubject=childSubjects.get_Items()[j];childSubjectNodes.push(this.renderNode(childSubject,count++,subjectDepth+1))}var childNodesDiv=React.DOM.div({key:"popupChildNodes",className:"popupChildNodes"},childSubjectNodes),symbolName=subjectDepth!==0?"Diamond":"";if(subjectNode.GetChildCount()>0)if(subjectNode.get_State()==0)symbolName="GlobalFilterCollapse";else symbolName="GlobalFilterExpand";var clickHandler=this.handleButtonClick.bind(this,subjectNode.get_Id()),toggleButton=Button.Button({key:"togglebutton",className:"toggleButton",onClick:clickHandler,callbackForToggleButton:this.callbackForToggleButton},FontIcon.FontIcon({symbolName:symbolName})),subjectTitleClickHandler=this.handleSubjectLabelClick.bind(this,subjectNode.get_Id()),subjectTitleKeyDownHandler=this.handleSubjectLabelKeyDown.bind(this,subjectNode.get_Id(),subjectNode.get_Title(),subjectNode.GetChildCount()),subjectTitleDiv=React.DOM.div({className:"subjectTitle",key:"subjectTitle"+subjectNode.get_Id(),onClick:subjectTitleClickHandler,tabIndex:this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),"aria-label":subjectNode.GetChildCount()!=0?this.props.dataContext.parentNodeScreenReaderText(subjectNode.get_Title()):subjectNode.get_Title(),onKeyDown:subjectTitleKeyDownHandler},subjectNode.get_Title());return React.DOM.div({key:"subjectListItem"+subjectNode.get_Id(),className:"subjectListItem"},[React.DOM.div({key:"subjectListLineItem",className:"subjectListLineItem",style:{paddingLeft:subjectDepth*this.SUBJECT_LEFT_OFFSET+"px"}},toggleButton,subjectTitleDiv),childNodesDiv])};HierarchicalSubjectControlSpec.prototype.renderPopup=function(){this.rowCount=0;if(this.props.dataContext.get_IsLoading())return React.DOM.noscript();for(var firstLevelSubjectNodes=[],firstLevelSubjects=this.props.dataContext.get_FirstLevelSubjects(),i=0;i<firstLevelSubjects.get_Count();i++){this.rowCount++;var subjectItemNode=firstLevelSubjects.get_Items()[i];firstLevelSubjectNodes.push(this.renderNode(subjectItemNode,i,0))}return React.DOM.div({className:"subjectItemContainer"},firstLevelSubjectNodes)};HierarchicalSubjectControlSpec.prototype.interceptClick=function(e){e.target.className!="subjectTitle"&&e.stopPropagation()};HierarchicalSubjectControlSpec.prototype.handleOnFocusForSubjectTextBox=function(){this.props.dataContext.set_ItemIndex(0)};HierarchicalSubjectControlSpec.prototype.handleSearchKeyDown=function(e){e.key===Constants.BACKSPACE_KEY&&this.clearSubjectText();if(e&&e.target)switch(e.key){case Constants.ENTER_KEY:this.handleSubjectLookupButtonClick();break;case Constants.BACKSPACE_KEY:this.clearSubjectText();break;case Constants.ESCAPE_KEY:this.props.dataContext.SetValue("");var subjectControlSearch=this.refs["SubjectControlSearchContainer"];subjectControlSearch instanceof Element&&$(subjectControlSearch).find(".subjecttextbox").focus();this.props.dataContext.set_Visible(false);break;case Constants.TAB_KEY:e.preventDefault();AccessibilityUtility.storeTabOperation(e);var sectionControl=$(".subjectPopup").closest(".section_control");sectionControl[0]!=null&&sectionControl.focus();break;case Constants.F8_KEY:this.focusNextMajorComponent(e.shiftKey);break}};HierarchicalSubjectControlSpec.prototype.clearSubjectText=function(){this.props.dataContext.set_Text("");this.props.dataContext.set_Data(null)};HierarchicalSubjectControlSpec.prototype.render=function(){var clearButton;if(this.props.dataContext.get_Text()!=="")clearButton=Button.Button({key:"clearTextButton",onClick:this.clearSubjectText,className:"clearText"},FontIcon.FontIcon({symbolName:"Cancel"}));var textbox=React.DOM.input({className:"subjecttextbox",key:"textarea",role:"textbox",type:this.props.clientContext.getTextBoxTypeString(5),maxLength:this.props.dataContext.get_SubjectTextboxMaxLength(),value:this.props.dataContext.get_Text(),tabIndex:this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),"aria-label":this.defaultFocusScreenReaderText(""),onKeyDown:this.handleSearchKeyDown,onFocus:this.handleOnFocusForSubjectTextBox}),textboxContainer=React.DOM.div({className:"subjectTextboxContainer"},textbox,clearButton),button=Button.Button({className:"subjectButton",title:"Subject",dataFlyoutOpen:this.props.dataContext.get_Visible(),onClick:this.handleSubjectLookupButtonClick,onKeyDown:this.handleSubjectLookupButtonKeyEvents},FontIcon.FontIcon({symbolName:"Expanded"})),inputDiv=React.DOM.div({key:"SubjectControlSearchContainer",ref:"SubjectControlSearchContainer",className:"SubjectControlSearch",style:{position:"relative"}},textboxContainer,button),popup=[];popup.push(inputDiv);if(this.props.dataContext.get_Visible()){var subjectLookupPopup=Popup.Popup({visible:this.props.dataContext.get_Visible(),key:"popup",className:"subjectLookupPopup",onDismiss:null,style:{position:"relative",top:this.state.displacementY,height:this.state.lookupHeight}},this.renderPopup());popup.push(subjectLookupPopup)}var popupDiv=React.DOM.div({className:"SubjectLookupPopupDiv",ref:"subjectLookupPopupDiv",style:{position:"absolute",top:this.state.lookupTop,left:this.state.lookupLeft,width:this.state.lookupDropBoxWidth}},popup),lookupBackDiv=React.DOM.div({className:"SubjectLookupBackDiv","data-id":"SubjectLookupBackDiv",style:{zIndex:this.zIndex}},popupDiv),bodyMount=AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"subjectPopupBody"},lookupBackDiv),subjectPoppup=React.DOM.div({className:"subjectPopupBody",ref:"subjectPopupBody",style:{height:"32px",zIndex:this.zIndex},clientContext:this.props.clientContext,dataContext:this.props.dataContext},bodyMount);return React.DOM.div({className:"subjectPopup",ref:"subjectPopup",clientContext:this.props.clientContext,dataContext:this.props.dataContext},subjectPoppup)};return HierarchicalSubjectControlSpec}(TsAdapter.SpecBase);exports.HierarchicalSubjectControl=DataWrapperComponent.wrapComponent(new HierarchicalSubjectControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PartyListReadItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/HyperlinkButton"],function(require,exports,TsAdapter,DataWrapperComponent,HyperlinkButton){var PartyListReadItemSpec=function(_super){__extends(PartyListReadItemSpec,_super);function PartyListReadItemSpec(){_super.apply(this,arguments);this.displayName="PartyListReadItem";this.listenToProperties=["Text"]}PartyListReadItemSpec.prototype.handleOpenItemCommand=function(){if(this.props.dataContext){var command=this.props.dataContext.get_ActionCommand();command&&command.get_CanExecute()&&command.execute()}};PartyListReadItemSpec.prototype.render=function(){var text="---";if(this.props.dataContext){var modelValue=this.props.dataContext.get_Text();if(modelValue)text=modelValue}var hyperlinkbutton=HyperlinkButton.HyperlinkButton({label:text,enabled:true,onClick:this.handleOpenItemCommand});return React.DOM.div(null,hyperlinkbutton)};return PartyListReadItemSpec}(TsAdapter.SpecBase);exports.PartyListReadItem=DataWrapperComponent.wrapComponent(new PartyListReadItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PartyListRead",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lookup/PartyListReadItem","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,PartyListReadItem,CssClassSet){exports.DESCRIPTOR_NAME="PartyListRead";exports.RENDERED_PROPERTY_NAME="ItemViewModels";var PartyListReadSpec=function(_super){__extends(PartyListReadSpec,_super);function PartyListReadSpec(){_super.apply(this,arguments);this.displayName="PartyListRead";this.listenToProperties=["ItemViewModels","TypedText"]}PartyListReadSpec.prototype.renderRecords=function(){for(var itemsCollection=this.props.dataContext.get_ItemViewModels(),results=[],itemsCount=itemsCollection.length,i=0;i<itemsCount;i++){var item=itemsCollection[i];results.push(PartyListReadItem.PartyListReadItem({dataContext:item,clientContext:this.props.clientContext,key:"partyListReadItem"+i}))}return results};PartyListReadSpec.prototype.render=function(){var children=this.renderRecords(),length=children.length;if(length===0){var text="---";children.push(React.DOM.span({key:"emptyPartListReadItem"},text))}else length>=2&&children.push(React.DOM.span({key:"overflow",className:"partyListRead-overflowIndicator"},"..."));return React.DOM.div({className:CssClassSet({partyListRead:true,empty:length===0,partyListRead_Overflow:length>=2})},children)};return PartyListReadSpec}(TsAdapter.SpecBase);exports.PartyListRead=DataWrapperComponent.wrapComponent(new PartyListReadSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/EditableSectionItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/ComponentFactory","Components/Fields/ComboBox","Components/Fields/Rollup","Components/Fields/ErrorIndicator","Components/Common/Label","Components/Common/DefaultValueLabel","Components/Common/FieldButton","Components/Primitives/TruncatedDiv","Components/Primitives/FontIcon","Components/Lists/ListItem","Components/Fields/DetailFieldsSection","Components/CustomControls/CustomControlHostView","Components/InteractionCentric/HierarchicalSubjectControl/HierarchicalSubject","Components/Lookup/PartyListRead","Components/Primitives/Button","Utils/CssClassSet","Components/Common/Constants","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,ComponentFactory,ComboBox,Rollup,ErrorIndicator,Label,DefaultValueLabel,FieldButton,TruncatedDiv,FontIcon,ListItem,DetailFieldsSection,CustomControl,HierarchicalSubjectControl,PartyListRead,Button,CssClassSet,Constants,AccessibilityUtility){var TOGGLE_DESCRIPTOR_NAME="ToggleControl",TOGGLE_RENDERED_PROPERTY_NAME="Data";exports.MAXIMUM_LABEL_HEIGHT=114;exports.MAXIMUM_LARGER_LABEL_HEIGHT=124;exports.EDIT_CONTROL_SUFFIX="_edit";exports.READ_CONTROL_SUFFIX="_readonly";exports.TRUNCATION_ELIGIBLE_COMPONENTS={};exports.TRUNCATION_ELIGIBLE_COMPONENTS[Label.DESCRIPTOR_NAME]=Label.RENDERED_PROPERTY_NAME;exports.TRUNCATION_ELIGIBLE_COMPONENTS[DefaultValueLabel.DESCRIPTOR_NAME]=DefaultValueLabel.RENDERED_PROPERTY_NAME;exports.TRUNCATION_ELIGIBLE_COMPONENTS[FieldButton.DESCRIPTOR_NAME]=FieldButton.RENDERED_PROPERTY_NAME;exports.TRUNCATION_ELIGIBLE_COMPONENTS[TOGGLE_DESCRIPTOR_NAME]=TOGGLE_RENDERED_PROPERTY_NAME;exports.TRUNCATION_ELIGIBLE_COMPONENTS[HierarchicalSubjectControl.DESCRIPTOR_NAME]=FieldButton.RENDERED_PROPERTY_NAME;exports.TRUNCATION_ELIGIBLE_COMPONENTS[PartyListRead.DESCRIPTOR_NAME]=PartyListRead.RENDERED_PROPERTY_NAME;var EditableSectionItemSpec=function(_super){__extends(EditableSectionItemSpec,_super);function EditableSectionItemSpec(){_super.apply(this,arguments);this.displayName="EditableSectionItem";this.mixins=[IXUD.Mixin];this.listenToViewModels={editViewModel:{listenToProperties:["IsValid","ErrorMessage","RequiredLevel","Required","Recommended","Enabled","ProcessRequiredSatisfied","HasFocus","CustomControlLayout"]},dataContext:{listenToProperties:["Visible","SourceTypeMask","Enabled","ModelContext","Label","ErrorMessage","CustomControlLayout"]},editSectionViewModel:{listenToProperties:["FieldAccessChanged"]}};this.custControlUpdateNeeded=false;this.isRenderedInDialog=false}EditableSectionItemSpec.prototype.getProperties=function(){var properties={};properties["id"]=this.props.fieldName;if(this.props.dataContext.get_Root().get_componentType()==5)properties["id"]=properties["id"]+"_quickCreate";return properties};EditableSectionItemSpec.prototype.getDefaultProps=function(){return {largerLineHeightForLabels:false}};EditableSectionItemSpec.prototype.isToggleControl=function(){return this.props.editDescriptor.TypeName===TOGGLE_DESCRIPTOR_NAME};EditableSectionItemSpec.prototype.onBodyClick=function(e){var target=$(e.target),match=target.closest(ReactDOM.findDOMNode(this));if(!match||match.length==0){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(false)}};EditableSectionItemSpec.prototype.bindDismissHandlers=function(){document.addEventListener(this.props.clientContext.isUsingPointerUp?"pointerup":"click",this.onBodyClick)};EditableSectionItemSpec.prototype.unbindDismissHandlers=function(){document.removeEventListener(this.props.clientContext.isUsingPointerUp?"pointerup":"click",this.onBodyClick)};EditableSectionItemSpec.prototype.bindPreNavigationHandler=function(){var root=this.props.dataContext.get_Root(),editRoot=root;editRoot.add_PreNavigation&&editRoot.add_PreNavigation(this.leaveEditMode)};EditableSectionItemSpec.prototype.unbindPreNavigationHandler=function(){var root=this.props.dataContext.get_Root(),editRoot=root;editRoot.remove_PreNavigation&&editRoot.remove_PreNavigation(this.leaveEditMode)};EditableSectionItemSpec.prototype.isRollupHeaderFieldForPhone=function(){return this.props.clientContext.isPhone&&this.props.descriptor&&this.props.descriptor.TypeName===Rollup.DESCRIPTOR_NAME&&this.props.descriptor.Properties&&this.props.descriptor.Properties["IsHeaderField"]};EditableSectionItemSpec.prototype.shouldFocusEditModeControl=function(){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();return editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus()&&!this.isToggleControl()&&!this.isRollupHeaderFieldForPhone()};EditableSectionItemSpec.prototype.focusEditModeControl=function(){var isLookup=this.props.editDescriptor.TypeName==="MultipleSourceLookup"||this.props.editDescriptor.TypeName==="PartyListLookup"||this.props.editDescriptor.TypeName==="Lookup"||this.props.editDescriptor.TypeName==="HierarchicalSubjectControl"||this.props.editDescriptor.TypeName==="InteractionCentricMultipleSourceLookup"||this.props.editDescriptor.TypeName==="InteractionCentricLookup"||this.props.editDescriptor.TypeName==="InteractionCentricPartyListLookup",isCustomControl=this.props.editDescriptor.TypeName==="CustomControlHostView",editControl=this.refs["editControl"];if(editControl&&!isLookup&&!isCustomControl){this.props.clientContext.focusField($(ReactDOM.findDOMNode(editControl)));this.props.clientContext.interceptBlurringEvents()}};EditableSectionItemSpec.prototype.shouldStopClickEventPropagation=function(){var node=ReactDOM.findDOMNode(this);if(node){var ancestorList=$(node).closest("."+ListItem.LIST_ITEM_CSS_CLASS);if(ancestorList.length>0)return true}return false};EditableSectionItemSpec.prototype.onShortPress=function(e){var _this=this;this.shouldStopClickEventPropagation()&&e.stopPropagation();this.fieldClicked=true;window.setTimeout(function(){_this.onItemClicked()},0);this.props.clientContext.userAgent.get_IsIOS()&&(this.props.editDescriptor.TypeName===ComboBox.DESCRIPTOR_NAME||this.props.descriptor.TypeName===CustomControl.DESCRIPTOR_NAME)&&this.props.clientContext.interceptBlurringEvents();(this.props.editDescriptor.TypeName==="MultipleSourceLookup"||this.props.editDescriptor.TypeName==="PartyListLookup"||this.props.editDescriptor.TypeName==="Lookup"||this.props.editDescriptor.TypeName==="InteractionCentricMultipleSourceLookup"||this.props.editDescriptor.TypeName==="InteractionCentricLookup"||this.props.editDescriptor.TypeName==="InteractionCentricPartyListLookup")&&this.props.clientContext.interceptBlurringEvents();this.props.dataContext.get_IsInteractionCentricEnabled()&&this.props.dataContext.set_SectionControlObject(this.getEditViewModelAsFocusable())};EditableSectionItemSpec.prototype.onEditShortPress=function(e){this.shouldStopClickEventPropagation()&&e.stopPropagation()};EditableSectionItemSpec.prototype.onItemClicked=function(){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(!editViewModelAsFocusable.get_HasFocus())};EditableSectionItemSpec.prototype.onKeyDownHandler=function(e){switch(e.key){case "Enter":this.onEnterKeyDown(e);break;case "Escape":this.onEscKeyDown(e);break;case "ArrowUp":case "ArrowDown":this.onUpDownArrowKeyDown(e);break}};EditableSectionItemSpec.prototype.onKeyDownHandlerForICH=function(e){if(this.props.onKeyDown){this.props.onKeyDown(e);this.isRenderedInDialog=true}switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.onEnterKeyDown(e);break;case Constants.ESCAPE_KEY_CODE:this.onEscKeyDown(e);break;case Constants.UP_ARROW_KEY_CODE:case Constants.DOWN_ARROW_KEY_CODE:if(this.props.editDescriptor.TypeName==="ToggleControl")this.onEnterKeyDown(e);else this.onUpDownArrowKeyDown(e);break;case Constants.TAB_KEY_CODE:var editViewModelAsFocusable=this.getEditViewModelAsFocusable();this.props.dataId&&this.props.dataId.indexOf("GlobalFilter")>-1&&editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus()&&this.onEnterKeyDown(e);editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(false);this.props.dataContext.set_IsTabPressed(true);break}};EditableSectionItemSpec.prototype.onUpDownArrowKeyDown=function(e){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus())return;var currentRow=$(e.currentTarget),toFocusItem;if(e.key==="ArrowUp")toFocusItem=this.findPrevEditableSectionItem(currentRow);else if(e.key==="ArrowDown")toFocusItem=this.findNextEditableSectionItem(currentRow);toFocusItem&&toFocusItem.focus()};EditableSectionItemSpec.prototype.findPrevEditableSectionItem=function(currentRow){var prevRow=currentRow.prev(".section_control");if(prevRow.length==0){var sectionClassSelector="."+DetailFieldsSection.DETAIL_FIELD_SECTION_CSS_CLASS.replace(" ","."),prevSection=currentRow.closest(sectionClassSelector).prev(sectionClassSelector);prevRow=prevSection.find(".section_control:last")}return prevRow};EditableSectionItemSpec.prototype.findNextEditableSectionItem=function(currentRow){var nextRow=currentRow.next(".section_control");if(nextRow.length==0){var sectionClassSelector="."+DetailFieldsSection.DETAIL_FIELD_SECTION_CSS_CLASS.replace(" ","."),nextSection=currentRow.closest(sectionClassSelector).next(sectionClassSelector);nextRow=nextSection.find(".section_control:first")}return nextRow};EditableSectionItemSpec.prototype.onEnterKeyDown=function(e){if(e.keyCode===229)return;var editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus()){if(this.shouldSkipEnterKey(e))return;$(e.currentTarget).focus()}this.fieldClicked=true;this.onItemClicked()};EditableSectionItemSpec.prototype.shouldSkipEnterKey=function(e){return this.props.editDescriptor.TypeName==="MultilineString"&&!e.ctrlKey||this.props.editDescriptor.TypeName==="Lookup"||this.props.editDescriptor.TypeName==="InteractionCentricMultipleSourceLookup"||this.props.editDescriptor.TypeName==="InteractionCentricLookup"||this.props.editDescriptor.TypeName==="InteractionCentricPartyListLookup"};EditableSectionItemSpec.prototype.onEscKeyDown=function(e){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus()&&this.onEnterKeyDown(e)};EditableSectionItemSpec.prototype.getErrorMessage=function(){if(this.props.descriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var readViewModelAsValidatable=this.props.dataContext;if(readViewModelAsValidatable&&readViewModelAsValidatable.get_ErrorMessage&&readViewModelAsValidatable.get_ErrorMessage())return readViewModelAsValidatable.get_ErrorMessage()}var editViewModelAsValidatable=this.props.editViewModel;return editViewModelAsValidatable&&editViewModelAsValidatable.get_ErrorMessage&&editViewModelAsValidatable.get_ErrorMessage()};EditableSectionItemSpec.prototype.getErrorMessageLevel=function(){if(this.props.descriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var readViewModelAsValidatable=this.props.dataContext;if(readViewModelAsValidatable&&readViewModelAsValidatable.get_ErrorMessageLevel&&readViewModelAsValidatable.get_ErrorMessageLevel())return readViewModelAsValidatable.get_ErrorMessageLevel()}var editViewModelAsValidatable=this.props.editViewModel;return editViewModelAsValidatable&&editViewModelAsValidatable.get_ErrorMessageLevel&&editViewModelAsValidatable.get_ErrorMessageLevel()};EditableSectionItemSpec.prototype.getRecommendationAcceptanceText=function(){if(this.props.descriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var readViewModelAsValidatable=this.props.dataContext;if(readViewModelAsValidatable&&readViewModelAsValidatable.get_AcceptanceTextMessage&&readViewModelAsValidatable.get_AcceptanceTextMessage())return readViewModelAsValidatable.get_AcceptanceTextMessage()}var editViewModelAsValidatable=this.props.editViewModel;return editViewModelAsValidatable&&editViewModelAsValidatable.get_AcceptanceTextMessage&&editViewModelAsValidatable.get_AcceptanceTextMessage()};EditableSectionItemSpec.prototype.getRecommendationAcceptanceActions=function(){if(this.props.descriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var readViewModelAsValidatable=this.props.dataContext;if(readViewModelAsValidatable&&readViewModelAsValidatable.get_AcceptanceActions&&readViewModelAsValidatable.get_AcceptanceActions())return readViewModelAsValidatable.get_AcceptanceActions()}var editViewModelAsValidatable=this.props.editViewModel;return editViewModelAsValidatable&&editViewModelAsValidatable.get_AcceptanceActions&&editViewModelAsValidatable.get_AcceptanceActions()};EditableSectionItemSpec.prototype.getAlertMessage=function(){var viewModelAsNonPersistentAttribute=this.props.dataContext;return viewModelAsNonPersistentAttribute&&viewModelAsNonPersistentAttribute.tryGetAlertMessage&&viewModelAsNonPersistentAttribute.tryGetAlertMessage()};EditableSectionItemSpec.prototype.getEditViewModelAsFocusable=function(){var editViewModelAsFocusable=this.props.editViewModel;if(editViewModelAsFocusable.get_HasFocus)return editViewModelAsFocusable;else return null};EditableSectionItemSpec.prototype.leaveEditMode=function(){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(false)};EditableSectionItemSpec.prototype.afterEnterEditMode=function(){this.props.editStartedCommand&&this.props.editStartedCommand.get_CanExecute()&&this.props.editStartedCommand.execute();this.focusEditModeControl();this.bindPreNavigationHandler();this.bindDismissHandlers()};EditableSectionItemSpec.prototype.afterExitEditMode=function(){this.unbindDismissHandlers();this.unbindPreNavigationHandler();this.props.clientContext.isPhone&&window.pageYOffset!=0&&window.scrollTo(window.pageXOffset,0);this.props.editFinishedCommand&&this.props.editFinishedCommand.get_CanExecute()&&this.props.editFinishedCommand.execute()};EditableSectionItemSpec.prototype.componentDidMount=function(){this.shouldFocusEditModeControl()&&this.focusEditModeControl();var hasFocus=false,editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable&&editViewModelAsFocusable.get_HasFocus()&&!this.isToggleControl()){hasFocus=true;this.afterEnterEditMode()}this.prevHasFocus=hasFocus;this.setGridRowDisplay();if(this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("LockFormOnRefresh")){var root=this.props.dataContext.get_Root(),editRoot=root;editRoot.apcl("IsLocked",this.updateIsLockedState)}};EditableSectionItemSpec.prototype.updateIsLockedState=function(){var root=this.props.dataContext.get_Root(),editRoot=root;this.setState({isLocked:root.get_IsLocked()})};EditableSectionItemSpec.prototype.handleRollupHeaderLongPress=function(){var command=this.props.dataContext.get_ConfirmRecalculateCommand();command&&command.get_CanExecute()&&command.execute()};EditableSectionItemSpec.prototype.changeModeOfEditableSection=function(flag){var editViewModelAsFocusable=this.getEditViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(flag)};EditableSectionItemSpec.prototype.handleOnFocusForSectionControl=function(){if(this.props.dataContext.get_IsTabPressed()){this.props.dataContext.set_SectionControlObject(this.getEditViewModelAsFocusable());this.props.dataContext.set_IsTabPressed(false);this.fieldClicked=true;this.props.editDescriptor.TypeName!="ToggleControl"&&this.changeModeOfEditableSection(true)}else{var key=AccessibilityUtility.key;if(key!=null&&key!=""&&key==Constants.TAB_KEY){AccessibilityUtility.key="";!AccessibilityUtility.shouldDoSpecialHandling(ReactDOM.findDOMNode(this))&&this.props.dataContext.set_IsTabPressed(true);this.changeModeOfEditableSection(false);AccessibilityUtility.handleSpecialTabbingForEditableSecionControl(ReactDOM.findDOMNode(this))}}};EditableSectionItemSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var currentTabIndex=this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),child=this.props.children;if(child.props.dataId.indexOf("GlobalFilter")>-1)currentTabIndex=this.props.dataContext.get_Root().get_StartIndex();return currentTabIndex}else return null};EditableSectionItemSpec.prototype.checkIfCustomControlUpdateNeeded=function(state){if(this.props.editDescriptor.TypeName!=CustomControl.DESCRIPTOR_NAME&&this.props.descriptor.TypeName!=CustomControl.DESCRIPTOR_NAME)return;if(!this.prevCustCssStates){this.prevCustCssStates=state;return}if(state)for(var key in state)if(state[key]!=this.prevCustCssStates[key]){this.custControlUpdateNeeded=true;this.prevCustCssStates[key]=state[key]}};EditableSectionItemSpec.prototype.componentDidUpdate=function(prevProps){var hasFocus=false,editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable)hasFocus=editViewModelAsFocusable.get_HasFocus();if(this.isToggleControl()||this.isRollupHeaderFieldForPhone())hasFocus&&editViewModelAsFocusable.set_HasFocus(false);else if(hasFocus&&!this.prevHasFocus)this.afterEnterEditMode();else!hasFocus&&this.prevHasFocus&&this.afterExitEditMode();var fieldWriteable=this.props.editSectionViewModel.isFieldEditable(this.props.fieldName),isFieldLocked=this.props.dataContext&&(!this.props.dataContext.get_Enabled()||!fieldWriteable);if(hasFocus&&!isFieldLocked)if(this.isToggleControl())if(this.fieldClicked){var dataContext=this.props.editViewModel;dataContext.set_SelectedItem(dataContext.get_SelectedItem()==="0"?"1":"0")}this.prevHasFocus=hasFocus;this.fieldClicked=false;if(this.custControlUpdateNeeded){if(hasFocus&&this.props.editDescriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var editViewModelAsCustomControl=this.props.editViewModel;editViewModelAsCustomControl&&editViewModelAsCustomControl.triggerUpdate&&editViewModelAsCustomControl.triggerUpdate()}else if(!hasFocus&&this.props.descriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var readViewModelAsCustomControl=this.props.dataContext;readViewModelAsCustomControl&&readViewModelAsCustomControl.triggerUpdate&&readViewModelAsCustomControl.triggerUpdate()}this.custControlUpdateNeeded=false}this.setGridRowDisplay()};EditableSectionItemSpec.prototype.componentWillUnmount=function(){this.unbindDismissHandlers();this.unbindPreNavigationHandler();if(this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("LockFormOnRefresh")){var root=this.props.dataContext.get_Root(),editRoot=root;editRoot.rpcl("IsLocked",this.updateIsLockedState)}};EditableSectionItemSpec.prototype.setGridRowDisplay=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var gridRowContent=$(ReactDOM.findDOMNode(this)).closest(".grid_row_content");if(gridRowContent.length)if(this.props.dataContext.get_Visible()&&gridRowContent.hasClass("grid_row_display_none"))gridRowContent.removeClass("grid_row_display_none");else if(!this.props.dataContext.get_Visible()&&!gridRowContent.hasClass("grid_row_display_none")){var hideEntireRow=true;if(gridRowContent[0]!=undefined&&gridRowContent[0].childNodes!=undefined)for(var children=gridRowContent[0].childNodes,index=0;index<children.length;index++){var eachChild=children[index];if(eachChild.getElementsByClassName("section_control")[0]!=undefined&&eachChild.getElementsByClassName("section_control")[0].style.display!="none"){hideEntireRow=false;break}}hideEntireRow&&gridRowContent.addClass("grid_row_display_none")}}};EditableSectionItemSpec.prototype.SectionItemScreenReaderText=function(){var editViewModelAsRequired=this.props.editViewModel,isRequired=editViewModelAsRequired&&editViewModelAsRequired.get_Required&&editViewModelAsRequired.get_Required(),isRecommended=editViewModelAsRequired&&editViewModelAsRequired.get_Recommended&&editViewModelAsRequired.get_Recommended(),fieldName=this.props.fieldName,isReadable=this.props.editSectionViewModel.isFieldReadable(fieldName),screenReaderText="";if(this.props.controlSectionTitle)screenReaderText+=this.props.controlSectionTitle+". ";if(this.props.showLabel)screenReaderText+=this.props.dataContext.get_Label()+". ";if(this.props.editDescriptor&&isReadable){var typeName=this.props.editDescriptor.TypeName,controlTypeName=AccessibilityUtility.getScreenReaderTypeName(typeName),data=this.props.dataContext.get_Data();if(data!=null)if(data.Name===undefined)screenReaderText+=data+". ";else screenReaderText+=data.Name+". ";screenReaderText+=controlTypeName}if(isRequired||isRecommended)screenReaderText+=". "+this.props.clientContext.getLocalizedString("ScreenReader_RequiredField_Text");return screenReaderText};EditableSectionItemSpec.prototype.render=function(){var children=[],isPhone=this.props.clientContext.isPhone,isVisible=this.props.dataContext.get_Visible(),hasFocus=false,editViewModelAsFocusable=this.getEditViewModelAsFocusable();if(editViewModelAsFocusable)hasFocus=editViewModelAsFocusable.get_HasFocus();var editViewModelAsRequired=this.props.editViewModel,isRequired=editViewModelAsRequired&&editViewModelAsRequired.get_Required&&editViewModelAsRequired.get_Required(),isRecommended=editViewModelAsRequired&&editViewModelAsRequired.get_Recommended&&editViewModelAsRequired.get_Recommended(),isProcessControl=this.props.descriptor.Properties["IsProcessControl"],isProcessRequired=this.props.descriptor.Properties["ProcessRequired"],isProcessSatisfied=this.props.editViewModel.get_ProcessRequirementSatisfied(),isCustomControlRead=this.props.descriptor.TypeName===CustomControl.DESCRIPTOR_NAME,isCustomControlEdit=this.props.editDescriptor.TypeName===CustomControl.DESCRIPTOR_NAME,isInteractionCentricEnabled=this.props.dataContext.get_IsInteractionCentricEnabled(),errorMessage=this.getErrorMessage(),alertMessage=this.getAlertMessage(),fieldName="";if(this.props.parentGivenKey.lastIndexOf(":")>0)fieldName=this.props.parentGivenKey;else fieldName=this.props.fieldName;var fieldWriteable=this.props.editViewModel.get_ModelContext()&&this.props.editSectionViewModel.isFieldEditable(fieldName);if(isInteractionCentricEnabled&&this.props.editViewModel.get_ModelContext()==null)var isFieldLocked=false;else var isFieldLocked=this.props.dataContext&&(!fieldWriteable||this.props.dataContext.get_IsEnabledSetByClientAPI()&&!this.props.dataContext.get_Enabled()||!this.props.dataContext.get_IsEnabledSetByClientAPI()&&this.props.dataContext.get_IsReadOnly());var isSecured=this.props.editSectionViewModel.isFieldSecured(fieldName),isInListContext=this.props.descriptor.Properties["IsInListContext"],dataContextAsMaskable=this.props.dataContext;dataContextAsMaskable&&dataContextAsMaskable.set_UseHiddenMask&&this.props.editSectionViewModel.isFieldAccessAvailable(fieldName)&&dataContextAsMaskable.set_UseHiddenMask(!this.props.editSectionViewModel.isFieldReadable(fieldName));var customControlActive=isCustomControlRead&&(!hasFocus||isFieldLocked)||isCustomControlEdit&&hasFocus&&!isFieldLocked;if(this.props.renderExtraChildren)children=this.props.renderExtraChildren(this.props.editViewModel,this.props.editDescriptor)||[];var lock=FontIcon.FontIcon({key:"lock",symbolName:"FlsLocked"}),fieldChangeIndicatorIcon=FontIcon.FontIcon({key:"fieldChangeIndicator",symbolName:"FieldChangeIndicator"});isFieldLocked&&!isInListContext&&!isPhone&&children.push(lock);this.props.dataContext.ShowFieldChangeIndicator(this.props.fieldName)&&children.push(fieldChangeIndicatorIcon);var bindShortPressHandlers=!this.props.clientContext.isPreview&&(!hasFocus||this.isToggleControl());if(this.props.showLabel){var labelText=this.props.dataContext.get_Label(),labelSpan=React.DOM.span({key:"label"},labelText),icons=[];(isRequired||isRecommended)&&icons.push(React.DOM.span({key:"required",className:"requiredIcon"}));isFieldLocked&&!isInListContext&&isPhone&&icons.push(lock);isSecured&&icons.push(React.DOM.span({key:"secured",className:"securedIcon"}));var iconContainer=React.DOM.span({key:"icons",className:"fieldLabelInlineIcons"},icons),entityFieldType=this.props.descriptor.Properties["EntityFieldType"],label=TruncatedDiv.TruncatedDiv({key:"label",maximumHeight:this.props.largerLineHeightForLabels?exports.MAXIMUM_LARGER_LABEL_HEIGHT:exports.MAXIMUM_LABEL_HEIGHT,textToCheck:labelText,className:CssClassSet({"control_label Section_label_common Section_value_alignment":true,section_primaryFieldLabel:this.props.isPrimaryFieldSection,taskBasedFlowPrimaryFieldLabel:entityFieldType==="primary",taskBasedFlowRelatedFieldLabel:entityFieldType==="related"}),onShortPress:bindShortPressHandlers?this.onShortPress:null},React.DOM.label({className:CssClassSet({processRequiredStep:isProcessRequired})},[labelSpan,iconContainer]))}var isInteractionCentricEnabled=this.props.dataContext.get_IsInteractionCentricEnabled();if(isCustomControlRead&&(!hasFocus||isFieldLocked)||this.props.editDescriptor.TypeName===CustomControl.DESCRIPTOR_NAME&&hasFocus&&!isFieldLocked)if(!this.props.clientContext.isPhone){var labels=[];labels.push(label);labels.push(React.DOM.div({key:"aux_cc_label",className:"aux_cc_label Section_value_common control_value",onShortPress:bindShortPressHandlers?this.onShortPress:null}));children.push(React.DOM.div({key:"aux_cc_wrapper",className:"aux_cc_wrapper"},labels))}else{children.push(label);children.push(React.DOM.div({key:"aux_cc_label",className:"aux_cc_label Section_value_common control_value",onShortPress:bindShortPressHandlers?this.onShortPress:null}))}else children.push(label);var control=this.props.children;if(hasFocus&&!isFieldLocked){if(!this.isToggleControl()){var controlFactory=ComponentFactory.getFactoryForControlName(this.props.editDescriptor.TypeName);if(!controlFactory)control=React.DOM.div(null,"Unimplemented edit control ('"+this.props.editDescriptor.TypeName+"')");else control=controlFactory({ref:"editControl",clientContext:this.props.clientContext,dataContext:this.props.editViewModel,descriptor:this.props.editDescriptor,onDismiss:this.onItemClicked,showLabel:this.props.showLabel,inActiveSection:hasFocus,onShortPress:this.onEditShortPress,leaveEditMode:this.leaveEditMode,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,handleFocusInDidMount:this.props.dataContext.get_IsInteractionCentricEnabled()?true:null})}}else if(!(isCustomControlRead&&this.isToggleControl()))control=React.Children.map(control,function(child){var newChild=child;if(child.props.descriptor&&child.props.descriptor.TypeName===Rollup.DESCRIPTOR_NAME)newChild=Rollup.Rollup({clientContext:child.props.clientContext,dataContext:child.props.dataContext,descriptor:child.props.descriptor,key:child.props.parentGivenKey,inActiveSection:hasFocus});return newChild});if(isInteractionCentricEnabled)if(!hasFocus&&!isFieldLocked&&(this.props.editDescriptor.TypeName==="InteractionCentricMultipleSourceLookup"||this.props.editDescriptor.TypeName==="InteractionCentricLookup"||this.props.editDescriptor.TypeName==="InteractionCentricPartyListLookup")){var icLookupViewModel=this.props.editViewModel;if(icLookupViewModel!==null&&icLookupViewModel.get_interactionCentricLookupAutoResolve()&&icLookupViewModel.get_LookupInputViewModel()!==null){var typedText=icLookupViewModel.get_LookupInputViewModel().get_Value(),originalText="";if(this.props.editDescriptor.TypeName!=="InteractionCentricPartyListLookup"&&typeof this.props.dataContext.get_Text!=="undefined"&&typeof this.props.dataContext.set_Text!=="undefined"){originalText=this.props.dataContext.get_Text();this.props.dataContext.set_Text(typedText)}else if(this.props.editDescriptor.TypeName==="InteractionCentricPartyListLookup"&&typeof this.props.dataContext.get_TypedText!=="undefined"&&typeof this.props.dataContext.set_TypedText!=="undefined"){originalText=this.props.dataContext.get_TypedText();this.props.dataContext.set_TypedText(typedText)}icLookupViewModel.set_LastTypedValue(typedText);if(icLookupViewModel.get_shouldAutoResolve())(typedText===null||typedText===undefined||typedText==="")&&originalText!==typedText&&icLookupViewModel.clearError()}var lookupSearchImageButton=Button.Button({key:"editLookupButton",className:"InlineLookupInputSearchImage",imageType:"Symbol",onClick:this.onItemClicked},FontIcon.FontIcon({symbolName:"SearchButton"}));control=[control,lookupSearchImageButton]}var dataFieldName=this.props.fieldName+(hasFocus?exports.EDIT_CONTROL_SUFFIX:exports.READ_CONTROL_SUFFIX),controlContainerProps={key:"value",className:CssClassSet({"control_value Section_value_common Section_value_alignment":true,multiline_label:this.props.descriptor.TypeName==="textArea",comboBoxContainer:hasFocus&&this.props.editDescriptor.TypeName===ComboBox.DESCRIPTOR_NAME,editControlContainer:hasFocus&&!this.isToggleControl()},this.props.descriptor.Properties["CellValueCssClass"]),"data-fieldname":dataFieldName,onShortPress:bindShortPressHandlers?this.onShortPress:null},typeName=hasFocus?this.props.editDescriptor&&this.props.editDescriptor.TypeName:this.props.descriptor&&this.props.descriptor.TypeName;if(typeName&&typeName in exports.TRUNCATION_ELIGIBLE_COMPONENTS&&!isCustomControlRead){var text=null,propertyGetter=this.props.dataContext["get_"+exports.TRUNCATION_ELIGIBLE_COMPONENTS[this.props.descriptor.TypeName]];if(!propertyGetter)console.error("Misconfigured TRUNCATION_ELIGIBLE_COMPONENTS for type "+this.props.descriptor.TypeName);else text=propertyGetter.apply(this.props.dataContext);if(typeName==PartyListRead.DESCRIPTOR_NAME){for(var itemsCollection=propertyGetter.apply(this.props.dataContext),itemsCount=itemsCollection.length,value="",i=0;i<itemsCount;i++){var item=itemsCollection[i];value=value+";"+item.get_Text()}if(value!="")value=value.substr(1);text=value}var truncatedControlControlsProps=controlContainerProps;truncatedControlControlsProps.maximumHeight=exports.MAXIMUM_LABEL_HEIGHT;truncatedControlControlsProps.textToCheck=text;children.push(TruncatedDiv.TruncatedDiv(truncatedControlControlsProps,control))}else children.push(React.DOM.div(controlContainerProps,control));if(isPhone)children=[React.DOM.div({key:"label_value_wrapper",className:"label_value_wrapper"},children)];if(alertMessage){var alertIndicator=ErrorIndicator.ErrorIndicator({key:"alert",errorMessage:alertMessage,className:"alertWarning",clientContext:this.props.clientContext,dataContext:this.props.dataContext});children.push(alertIndicator)}if(errorMessage){var errorLevel=this.getErrorMessageLevel(),props={key:"error",errorMessage:errorMessage,clientContext:this.props.clientContext,dataContext:this.props.dataContext};if(errorLevel&&errorLevel!="ERROR"){props.buttonAcceptanceMessage=this.getRecommendationAcceptanceText();props.buttonAcceptanceActions=this.getRecommendationAcceptanceActions();props.className="recommendation"}var errorIndicator=ErrorIndicator.ErrorIndicator(props);children.push(errorIndicator)}var styles={};if(!isVisible)styles["display"]="none";var title="",isLabelText=typeof labelText!="undefined"&&labelText!=""&&labelText!=null,isText=typeof text!="undefined"&&text!=""&&text!=null;if(isLabelText&&isText&&isInteractionCentricEnabled&&this.props.editSectionViewModel.isFieldReadable(fieldName))title=labelText+" : "+text;else if(isLabelText&&typeof text!="undefined"&&isInteractionCentricEnabled)title=labelText;var isColumnLayout=false;if(isCustomControlRead&&(this.isToggleControl()||!hasFocus)){var custModel=this.props.dataContext;isColumnLayout=!custModel.get_InlineLayout()}var rightAlignedEdit=false;if(this.props.editDescriptor.TypeName==CustomControl.DESCRIPTOR_NAME){var custModel=this.props.editViewModel;rightAlignedEdit=custModel.get_RightAlignedEdit()}customControlActive&&this.checkIfCustomControlUpdateNeeded({rightAlignedEdit:rightAlignedEdit,isColumnLayout:isColumnLayout});var isNoteSubject=false,isNoteText=false;if(!this.props.clientContext.isInteractionCentric&&!this.props.clientContext.isMailApp&&this.props.dataContext.get_PrimaryModelName()==="annotation"){isNoteSubject=this.props.fieldName==="subject";isNoteText=this.props.fieldName==="notetext"}var controlRow=React.DOM.div({key:this.props.descriptor.BindingPath,className:CssClassSet({section_control:true,editRow:hasFocus&&!this.isToggleControl()&&!this.isRollupHeaderFieldForPhone(),noLabel:!this.props.showLabel,requiredField:isRequired,recommendedField:isRecommended,comboBoxRow:hasFocus&&this.props.editDescriptor.TypeName===ComboBox.DESCRIPTOR_NAME,multilineStringRow:this.props.clientContext.isMailApp&&this.props.editDescriptor.TypeName==="MultilineString",RollupContainer:this.props.descriptor.TypeName===Rollup.DESCRIPTOR_NAME,hasError:errorMessage,locked:isFieldLocked,securedField:isSecured,custom_control_column:isColumnLayout,right_aligned:rightAlignedEdit,notesubject:isNoteSubject,notetext:isNoteText},this.props.descriptor.Properties["BodyCssClass"]),style:styles,"data-fieldname":this.props.fieldName,"data-id":isProcessControl&&isProcessSatisfied?"completed":null,ref:"controlRow",tabIndex:this.getTabIndex(),onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.onKeyDownHandlerForICH:this.onKeyDownHandler,onLongPress:this.isRollupHeaderFieldForPhone()?this.handleRollupHeaderLongPress:null,onFocus:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOnFocusForSectionControl:null,title:title,"aria-label":this.props.dataContext.get_IsInteractionCentricEnabled()?this.SectionItemScreenReaderText():null},children);if(this.props.onKeyDown)this.isRenderedInDialog=true;return controlRow};return EditableSectionItemSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(TOGGLE_DESCRIPTOR_NAME,null);exports.EditableSectionItem=DataWrapperComponent.wrapComponent(new EditableSectionItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/DateControl/DateControl",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ComboBox","Components/Common/Constants","Components/Common/AccessibilityUtility","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComboBox,Constants,AccessibilityUtility,CssClassSet){exports.DESCRIPTOR_NAME="DateControl";var DateControlSpec=function(_super){__extends(DateControlSpec,_super);function DateControlSpec(){_super.apply(this,arguments);this.displayName="DateControl";this.listenToProperties=["DateValueSet","DatetimeListComboBox","Format"]}DateControlSpec.prototype.datePickerClicked=function(event){event.stopPropagation()};DateControlSpec.prototype.componentWillUnmount=function(){this.props.clientContext.isMailApp&&$("#ui-datepicker-div").hide()};DateControlSpec.prototype.componentDidMount=function(){$("#dateSelector").datepicker("widget").on("mousedown",function(event){var $this=$(this),target=$(event.target);if(target.hasClass("ui-datepicker-close")){this.props.dataContext.set_DateTimeObject(new Date);$("#dateSelector").datepicker("setDate",new Date);$("#dateFieldValue").val(this.props.dataContext.get_DateValueInString())}});this.props.clientContext.isMailApp&&$("#ui-datepicker-div").attr("data-is-popup","true");$("#ui-datepicker-div").on(this.props.clientContext.isUsingPointerUp?"pointerup":"click",this.datePickerClicked);$("#dateFieldValue").attr("tabIndex",this.getStartTabIndex());$("#dateSelector").datepicker({changeMonth:true,changeYear:true,yearRange:"c-5:c+5",gotoCurrent:true,minDate:"01/01/1900",maxDate:"12/31/9999",showButtonPanel:"true",closeText:this.props.clientContext.getLocalizedString("LabelForToday")+": "+this.props.dataContext.get_TodayDateString(),prevText:'<b class="symbolFont BackButtonWithoutBorder-symbol"></b>',nextText:'<b class="symbolFont Forward-symbol"></b>',showOn:"button",buttonImage:"/_imgs/btn_off_cal.gif",buttonImageOnly:true,buttonText:this.props.clientContext.getLocalizedString("Calendar_Title"),dayNamesMin:this.props.dataContext.get_ShortestDayNames(),dayNames:this.props.dataContext.get_DayNames(),monthNamesShort:this.props.dataContext.get_MonthNames(),onClose:function(){var currentDate=$("#dateSelector").datepicker("getDate");if(currentDate!=null){$("#dateSelector").datepicker("setDate",currentDate);this.props.dataContext.set_DateTimeObject(currentDate);$("#dateFieldValue").val(this.props.dataContext.get_DateValueInString());this.props.dataContext.set_IsPickerClicked(true)}$("#dateFieldValue").focus()}.bind(this)});$(".ui-datepicker-trigger").on(this.props.clientContext.isUsingPointerUp?"pointerup":"click",function(e){this.datePickerClicked(e);var dateSelector=$("#dateSelector");if(dateSelector!=null)if(this.props.dataContext.get_Date()){var date=this.props.dataContext.get_Date();this.props.dataContext.get_AllDayDisplay()&&date.setHours(date.getHours()-24);dateSelector.datepicker("setDate",date)}}.bind(this))};DateControlSpec.prototype.getStartTabIndex=function(){return this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_StartIndex()};DateControlSpec.prototype.clearDateTimeField=function(event){if(event.key==Constants.BACKSPACE_KEY||event.key==Constants.DELETE_KEY){this.props.dataContext.get_ClearValueCommand().execute();this.props.dataContext.set_DateValueInString("")}};DateControlSpec.prototype.setDateInDatePicker=function(){$("#dateSelector").datepicker("setDate",this.props.dataContext.get_DateTimeObject())};DateControlSpec.prototype.clearFilter=function(){$("#dateSelector").datepicker("setDate",this.props.dataContext.get_DateTimeObject());$("#dateFieldValue").val(this.props.dataContext.get_DateValueInString());this.props.dataContext.set_ClearFilter(true)};DateControlSpec.prototype.handleKeyDownForDateField=function(e){AccessibilityUtility.handleShiftTabAndFocusParentSectionControl(ReactDOM.findDOMNode(this),e)};DateControlSpec.prototype.renderDateControl=function(){var dateChildren=[];this.props.dataContext.get_Data()&&this.props.dataContext.get_Data()!=""&&this.props.dataContext.get_DateTimeObject().getTime()!=this.props.dataContext.get_Date().getTime()&&this.props.dataContext.set_DateTimeObject(this.props.dataContext.get_Date());if(this.props.dataContext.get_DateValueInString()===undefined){var errorImageDiv=React.DOM.img({key:"img",src:"/_imgs/Tools/Notification_Error_16.png",className:"errorImage"});dateChildren.push(errorImageDiv)}else{var errorImageDiv=React.DOM.label({key:"errorImageDiv",className:"errorImageWidth"},"");dateChildren.push(errorImageDiv);this.props.dataContext.get_DateValueInString()!=""&&this.setDateInDatePicker()}var dateFieldString=this.props.dataContext.get_AllDayDisplay()?this.props.dataContext.get_AllDayAdjustedDate():this.props.dataContext.get_DateValueInString(),dateFieldValue=React.DOM.input({key:"dateFieldValue",id:"dateFieldValue",className:CssClassSet({textbox:this.props.clientContext.isMailApp}),value:dateFieldString,onKeyUp:this.clearDateTimeField,onKeyDown:this.handleKeyDownForDateField}),dateSelector=React.DOM.input({key:"dateSelector",id:"dateSelector",readOnly:true,className:"dateSelector"});dateChildren.push(dateFieldValue,dateSelector);var dateControl=React.DOM.div({key:"DatePickerControl",id:"DatePickerControl",className:CssClassSet({"input-container":this.props.clientContext.isMailApp})},dateChildren);return dateControl};DateControlSpec.prototype.renderTimeControl=function(){var timeControl=ComboBox.ComboBox({key:"combobox",id:"timeSelector",ref:"timePickerControl",className:"timePickerControl",clientContext:this.props.clientContext,renderAsDropDown:true,defaultValue:this.props.dataContext.get_TimeValueInString().toString(),value:this.props.dataContext.get_DatetimeListComboBox().get_SelectedItem(),dataContext:this.props.dataContext.get_DatetimeListComboBox(),disabled:this.props.dataContext.get_DateValueInString()===""?true:false,tabIndex:this.getStartTabIndex()});return timeControl};DateControlSpec.prototype.render=function(){var dateTimeChildren=[];this.props.dataContext.get_ClearFilter()&&this.clearFilter();var dateControl,timeControl;switch(this.props.dataContext.get_Format()){case "datetime":dateControl=this.renderDateControl();dateTimeChildren.push(dateControl);timeControl=this.renderTimeControl();timeControl.props.dataContext.set_SelectedItem(this.props.dataContext.get_TimeValueInString());dateTimeChildren.push(timeControl);break;case "date":dateControl=this.renderDateControl();dateTimeChildren.push(dateControl);break;case "time":timeControl=this.renderTimeControl();timeControl.props.dataContext.set_SelectedItem(this.props.dataContext.get_TimeValueInString());dateTimeChildren.push(timeControl);break}return React.DOM.div({key:"DatePickerControl",className:"DatePickerControl"},dateTimeChildren)};return DateControlSpec}(TsAdapter.SpecBase);exports.DateControl=DataWrapperComponent.wrapComponent(new DateControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/DurationControl/DurationControl",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Common/Constants","Components/Primitives/Popup","Components/Primitives/FontIcon","Components/Primitives/AncestorMountedHost","Core/Binding/WindowResizeHandlerMixin","Utils/ZIndexFinder","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,Button,Constants,Popup,FontIcon,AncestorMountedHost,WindowResizeHandler,ZIndexFinder,AccessibilityUtility){exports.DESCRIPTOR_NAME="DurationControl";var previousTextValue,DurationControlSpec=function(_super){__extends(DurationControlSpec,_super);function DurationControlSpec(){_super.apply(this,arguments);this.displayName="DurationControl";this.zIndex=1500;this.MAX_WIDTH=200;this.MAX_HEIGHT=250;this.DURATION_INPUT_HEIGHT=25;this.PADDING=5;this.POPUP_MIN_WIDTH=300;this.listenToProperties=["DurationValueSet","IsLoading","SelectedItem","Visible"];this.mixins=[WindowResizeHandler.Mixin]}DurationControlSpec.prototype.componentWillMount=function(){this.zIndex=ZIndexFinder()+2};DurationControlSpec.prototype.componentDidMount=function(){if(this.state.lookupDurationBoxWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupDurationBoxWidth:lookupWidth})}var durationControl=this.refs["durationControlSearchContainer"];if(durationControl instanceof Element){var domNode=$(durationControl);domNode.data("IsPopup",true);domNode.data("IsModal",true);domNode.click(this.interceptClick)}this.calculatePosition();var durationTextBox=this.refs["durationBox"];if(durationTextBox instanceof Element)if(this.props.clientContext.userAgent.get_IsBrowserIE())setTimeout(function(){$(durationTextBox).focus()},1);else $(durationTextBox).focus()};DurationControlSpec.prototype.focusOnParentSectionControl=function(){var domNode=ReactDOM.findDOMNode(this);$(domNode).parents(".section_control").focus()};DurationControlSpec.prototype.interceptClick=function(e){e.stopPropagation()};DurationControlSpec.prototype.calculatePosition=function(){var count=this.props.dataContext.get_DurationItemList().length;if(this.isMounted()!==true)return;var screenWidth=WindowResizeHandler.getWindowWidth(),screenHeight=WindowResizeHandler.getWindowHeight(),newListTop=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().top,newListLeft=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().left,padding=window.getComputedStyle(ReactDOM.findDOMNode(this).parentElement,null).getPropertyValue("padding-left");padding=padding.substr(0,padding.length-2);var paddingNumber=+padding;newListLeft=newListLeft+paddingNumber;var durationPopupHeight=this.DURATION_INPUT_HEIGHT+count*20;if(durationPopupHeight>this.MAX_HEIGHT)durationPopupHeight=this.MAX_HEIGHT;var popUpWidth=this.state.lookupDurationBoxWidth<this.POPUP_MIN_WIDTH?this.POPUP_MIN_WIDTH:this.state.lookupDurationBoxWidth,displacementX=screenWidth-(newListLeft+popUpWidth);if(displacementX<0){newListLeft=newListLeft+displacementX-this.PADDING;newListLeft=newListLeft}var height=this.DURATION_INPUT_HEIGHT+durationPopupHeight,newDisplacementY=screenHeight-(newListTop+height);if(newDisplacementY<0)if(newListTop>=durationPopupHeight){newDisplacementY=-1*height;height=durationPopupHeight}else if(newListTop>screenHeight-newListTop){newDisplacementY=-1*(newListTop+this.DURATION_INPUT_HEIGHT);height=newListTop-this.PADDING}else{newDisplacementY=0;height=screenHeight-(newListTop+this.PADDING+this.DURATION_INPUT_HEIGHT)}else{newDisplacementY=0;height=durationPopupHeight}if(this.state.lookupDurationBoxWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupDurationBoxWidth:lookupWidth})}var stateChangeRequired=this.state.durationListTop!==newListTop||this.state.durationListLeft!==newListLeft||this.state.displacementY!==newDisplacementY||this.state.durationListHeight!==height;stateChangeRequired&&this.setState({durationListTop:newListTop,durationListLeft:newListLeft,displacementY:newDisplacementY,durationListHeight:height})};DurationControlSpec.prototype.getInitialState=function(){this.props.dataContext.set_InitialText(this.props.dataContext.get_Data());previousTextValue=this.props.dataContext.get_InitialText();return {currentText:this.props.dataContext.get_InitialText(),lookupDurationBoxWidth:0}};DurationControlSpec.prototype.convertDurationValue=function(event){if(previousTextValue!==this.state.currentText){var target=event.target;this.props.dataContext.set_DurationValue(target.value);this.setState({currentText:this.props.dataContext.get_DurationValue()});previousTextValue=this.props.dataContext.get_DurationValue()}};DurationControlSpec.prototype.handleKeyPress=function(e){if(e.key==="Enter"){this.convertDurationValue(e);this.setDurationTextAndHidePopup(e.currentTarget.value);this.props.dataContext.set_HasFocus(false)}};DurationControlSpec.prototype.handleKeyDown=function(e){switch(e.key){case Constants.ENTER_KEY:this.props.dataContext.set_HasFocus(false);this.focusOnParentSectionControl();break;case Constants.UP_ARROW_KEY:case Constants.DOWN_ARROW_KEY:e.preventDefault();this.props.dataContext.set_Visible(false);this.focusFirstItemInDurationList();break;case Constants.ESCAPE_KEY:this.props.dataContext.set_Visible(true);break;case Constants.TAB_KEY:e.preventDefault();AccessibilityUtility.storeTabOperation(e);!this.props.dataContext.get_Visible()&&this.props.dataContext.set_Visible(true);var sectionControl=$(".durationPopupBody").closest(".section_control");sectionControl[0]!=null&&sectionControl.focus();break}};DurationControlSpec.prototype.focusFirstItemInDurationList=function(){var focusableItem=$(".durationRow:first")[0];focusableItem!=null&&$(focusableItem).focus()};DurationControlSpec.prototype.handleKeyPressForDurationList=function(e){var currentItem=e.currentTarget;switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.setDurationTextAndHidePopup(currentItem.textContent);this.props.dataContext.set_HasFocus(false);this.focusOnParentSectionControl();break;case Constants.ESCAPE_KEY_CODE:e.preventDefault();this.props.dataContext.set_Visible(true);var item=$(".durationBox")[0];item!=null&&$(item).focus();break;case Constants.DOWN_ARROW_KEY_CODE:case Constants.UP_ARROW_KEY_CODE:e.preventDefault();var targetToFocus=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?currentItem.nextSibling:currentItem.previousSibling;targetToFocus!=null&&$(targetToFocus).focus();break;case Constants.TAB_KEY_CODE:this.props.dataContext.set_Visible(true);this.props.dataContext.set_HasFocus(false);AccessibilityUtility.storeTabOperation(e);e.preventDefault();this.focusOnParentSectionControl();break}};DurationControlSpec.prototype.setDurationTextAndHidePopup=function(durationText){this.setState({currentText:durationText});this.props.dataContext.set_Visible(true);this.props.dataContext.set_SelectedDuration(durationText);this.props.dataContext.set_InitialText(this.props.dataContext.get_SelectedDuration());this.props.dataContext.set_Data(this.props.dataContext.get_SelectedDuration())};DurationControlSpec.prototype.handlePopUpDismiss=function(){this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible())};DurationControlSpec.prototype.handleTogglePopUp=function(){this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible());this.calculatePosition()};DurationControlSpec.prototype.selectDurationValue=function(event){var selectedIndexValue=parseInt(event.target.getAttribute("data-value")),selectedDurationElement=this.refs["selectedDurationValue"+selectedIndexValue];if(selectedDurationElement instanceof Element){previousTextValue=selectedDurationElement.getAttribute("label");this.setDurationTextAndHidePopup(previousTextValue);this.calculatePosition()}};DurationControlSpec.prototype.handleWindowResize=function(){this.calculatePosition()};DurationControlSpec.prototype.onFocusChanged=function(event){if(event&&event.target){var target=event.target;this.convertDurationValue(event);this.props.dataContext.set_SelectedDuration(target.value);this.props.dataContext.set_InitialText(this.props.dataContext.get_SelectedDuration());this.props.dataContext.set_Data(this.props.dataContext.get_SelectedDuration())}};DurationControlSpec.prototype.doGetCaretPosition=function(ctrl){var CaretPos=0,doc=window.document;if(doc.selection){ctrl.focus();var Sel=doc.selection.createRange();Sel.moveStart("character",-ctrl.value.length);CaretPos=Sel.text.length}else if(ctrl.selectionStart||ctrl.selectionStart=="0")CaretPos=ctrl.selectionStart;return CaretPos};DurationControlSpec.prototype.setCaretPosition=function(ctrl,pos){if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,pos)}else if(ctrl.createTextRange){var range=ctrl.createTextRange();range.collapse(true);range.moveStart("character",pos);range.select()}};DurationControlSpec.prototype.onTextChanged=function(event){if(event&&event.target){var pos=this.doGetCaretPosition(target),target=event.target;this.setState({currentText:target.value});this.setCaretPosition(target,pos)}};DurationControlSpec.prototype.listOptions=function(options){for(var durationTable=[],durationsRows=[],i=0;i<options.length;i++){var value=options[i].get_ValueString(),label=options[i].get_Label(),newDuration=React.DOM.td({"data-value":value,label:label,onClick:this.selectDurationValue,key:i.toString(),ref:"selectedDurationValue"+i.toString()},label),durationRow=React.DOM.tr({key:"durationRow"+i,className:"durationRow",tabIndex:i==0?this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():-1,"aria-label":this.props.dataContext.listItemScreenReaderText(i+1,options.length,label),onKeyDown:this.handleKeyPressForDurationList},newDuration);durationsRows.push(durationRow)}var table=React.DOM.table({className:"durationTable",key:"durationTable"},durationsRows);durationTable.push(table);return durationTable};DurationControlSpec.prototype.render=function(){var children=[],controlTypeName=AccessibilityUtility.getScreenReaderTypeName(this.props.descriptor.TypeName),durationBox=React.DOM.input({key:"durationBox",className:"durationBox",ref:"durationBox",onKeyPress:this.handleKeyPress,onKeyDown:this.handleKeyDown,onBlur:this.onFocusChanged,onChange:this.onTextChanged,value:this.state.currentText,"aria-label":this.props.dataContext.onFocusScreenReaderText(controlTypeName),tabIndex:this.props.tabIndex&&this.props.tabIndex>-1?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),type:this.props.clientContext.getTextBoxTypeString(1)}),durationDropDownImageButton=Button.Button({key:"dropdownkey",className:"durationDropdownImage",imageType:"Symbol",onClick:this.handleTogglePopUp},FontIcon.FontIcon({symbolName:"Expanded"})),inputDiv=React.DOM.div({key:"durationControlSearchContainer",ref:"durationControlSearchContainer",className:"durationControlSearch",style:{position:"relative"}},durationBox,durationDropDownImageButton),popup=[];popup.push(inputDiv);var durationList=this.listOptions(this.props.dataContext.get_DurationItemList()),durationListPopUp=Popup.Popup({visible:!this.props.dataContext.get_Visible(),key:"durationListPopUp",className:"durationPopup",onDismiss:this.handlePopUpDismiss,skipFocusActiveElementBeforeOpening:true,style:{top:this.state.displacementY,height:this.state.durationListHeight}},durationList);popup.push(durationListPopUp);var popupDiv=React.DOM.div({ref:"durationPopupDiv",style:{position:"absolute",top:this.state.durationListTop,left:this.state.durationListLeft,width:this.state.lookupDurationBoxWidth}},popup),durationBackDiv=React.DOM.div({className:"durationBackDiv","data-id":"durationBackDiv",style:{zIndex:this.zIndex}},popupDiv),bodyMount=AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"durationPopupBody"},durationBackDiv),durationPoppup=React.DOM.div({className:"durationPopupBody",ref:"durationPopupBody",style:{zIndex:this.zIndex},clientContext:this.props.clientContext,dataContext:this.props.dataContext},bodyMount);if(this.props.clientContext.isMailApp)return React.DOM.div({className:"mailAppDuration"},popup);return React.DOM.div({className:"durationPopup",ref:"durationPopup",clientContext:this.props.clientContext,dataContext:this.props.dataContext},durationPoppup)};return DurationControlSpec}(TsAdapter.SpecBase);exports.DurationControl=DataWrapperComponent.wrapComponent(new DurationControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Common/ScrollerComponent",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var ScrollerComponentSpec=function(_super){__extends(ScrollerComponentSpec,_super);function ScrollerComponentSpec(){_super.apply(this,arguments);this.displayName="ScrollerComponent";this.mixins=[PureUpdate.Mixin]}ScrollerComponentSpec.prototype.handleShortPress=function(e){this.props.onShortPress&&this.props.onShortPress(e)};ScrollerComponentSpec.prototype.interceptClick=function(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation()};ScrollerComponentSpec.prototype.render=function(){if(this.props.dimensions)var style={marginRight:this.props.dimensions.itemMargin};return React.DOM.div({className:CssClassSet(null,"scrollerComponent",this.props.cssClass),tabIndex:-1,style:style,onShortPress:this.handleShortPress,onClick:this.interceptClick},this.props.children)};return ScrollerComponentSpec}(TsAdapter.SpecBase);exports.ScrollerComponent=TsAdapter.createComponent(new ScrollerComponentSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Common/ScrollerItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Common/DefaultValueLabel"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,DefaultValueLabel){var ScrollerItemSpec=function(_super){__extends(ScrollerItemSpec,_super);function ScrollerItemSpec(){_super.apply(this,arguments);this.displayName="ScrollerItem";this.mixins=[PureUpdate.Mixin]}ScrollerItemSpec.prototype.getDefaultProps=function(){return {isCurrentItem:false}};ScrollerItemSpec.prototype.handleShortPress=function(e){if(this.props.onShortPress){this.props.onShortPress(e);if(this.props.reactClientContext.userAgent.get_IsIOS())this.shouldStopImmediatePropagation(ReactDOM.findDOMNode(this))&&e.nativeEvent.stopImmediatePropagation();e.preventDefault()}};ScrollerItemSpec.prototype.shouldStopImmediatePropagation=function(e){if(e.parentElement&&(e.parentElement.classList.contains("yearComponentScroller")||e.parentElement.classList.contains("monthComponentScroller")||e.parentElement.classList.contains("dayComponentScroller")))return false;return true};ScrollerItemSpec.prototype.interceptClick=function(e){e.stopPropagation();this.shouldStopImmediatePropagation(ReactDOM.findDOMNode(this))&&e.nativeEvent.stopImmediatePropagation()};ScrollerItemSpec.prototype.handleKeyDown=function(e){};ScrollerItemSpec.prototype.render=function(){if(this.props.dimensions)var largeLabelStyle={fontSize:this.props.dimensions.largeText},smallLabelStyel={visibility:this.props.smallText?"inherit":"hidden",fontSize:this.props.dimensions.smallText},itemStyle={marginBottom:this.props.dimensions.itemMargin,width:this.props.dimensions.itemWidth,height:this.props.dimensions.itemWidth,borderWidth:this.props.dimensions.itemBorder};else var smallLabelStyel={visibility:this.props.smallText?"inherit":"hidden"};var mainTextSpan=React.DOM.span({key:"text",className:"largeLabel",style:largeLabelStyle},this.props.mainText),smallTextSpan=React.DOM.span({key:"smallText",className:"smallLabel",style:smallLabelStyel},this.props.smallText||DefaultValueLabel.DEFAULT_VALUE_MASK),scrollerLabels=React.DOM.div({className:"scrollerLabels"},[mainTextSpan,smallTextSpan]);return React.DOM.div({key:"scrollerItem",className:CssClassSet({currentItem:this.props.isCurrentItem},"scrollerItem",this.props.className),style:itemStyle,tabIndex:this.props.tabIndex,onKeyDown:this.handleKeyDown,onShortPress:this.handleShortPress,onClick:this.props.reactClientContext.userAgent.get_IsIOS()?null:this.interceptClick},scrollerLabels)};return ScrollerItemSpec}(TsAdapter.SpecBase);exports.ScrollerItem=TsAdapter.createComponent(new ScrollerItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/DateTimeScrollerItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Fields/ScrollerControls/Common/ScrollerItem"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,ScrollerItem){exports.DATE_COMPONENT_YEAR="year";exports.DATE_COMPONENT_YEAR_WITH_ERA="yearwithera";exports.DATE_COMPONENT_MONTH="month";exports.DATE_COMPONENT_DAY="day";exports.DATE_COMPONENT_12HOUR="12hour";exports.DATE_COMPONENT_24HOUR="24hour";exports.DATE_COMPONENT_MINUTE="minute";exports.DATE_COMPONENT_PERIOD="period";var DateTimeScrollerItemSpec=function(_super){__extends(DateTimeScrollerItemSpec,_super);function DateTimeScrollerItemSpec(){_super.apply(this,arguments);this.displayName="DateTimeScrollerItem";this.mixins=[PureUpdate.Mixin]}DateTimeScrollerItemSpec.prototype.getDefaultProps=function(){return {isCurrentItem:false}};DateTimeScrollerItemSpec.prototype.onShortPress=function(e){this.props.onShortPressWithDate&&this.props.onShortPressWithDate(e,this.props.date)};DateTimeScrollerItemSpec.prototype.onKeyDown=function(e){this.props.onKeyDown&&this.props.onKeyDown(e);this.props.onKeyDownWithDate&&this.props.onKeyDownWithDate(e,this.props.date)};DateTimeScrollerItemSpec.prototype.getTextFormat=function(forSmallText){if(this.props.date&&this.props.dateComponent){var textFormat="",smallTextFormat="";switch(this.props.dateComponent){case exports.DATE_COMPONENT_YEAR:textFormat="yyyy";smallTextFormat="";break;case exports.DATE_COMPONENT_YEAR_WITH_ERA:textFormat="yyyy";smallTextFormat="gg";break;case exports.DATE_COMPONENT_MONTH:textFormat="MM";smallTextFormat="MMMM";break;case exports.DATE_COMPONENT_DAY:textFormat="dd";smallTextFormat="dddd";break;case exports.DATE_COMPONENT_12HOUR:textFormat="hh";smallTextFormat="";break;case exports.DATE_COMPONENT_24HOUR:textFormat="HH";smallTextFormat="";break;case exports.DATE_COMPONENT_MINUTE:textFormat="mm";smallTextFormat="";break;case exports.DATE_COMPONENT_PERIOD:textFormat="tt";smallTextFormat="";break}if(forSmallText)return smallTextFormat;else return textFormat}else return ""};DateTimeScrollerItemSpec.prototype.getText=function(forSmallText){var format=this.getTextFormat(forSmallText);if(format=="")return "";return this.props.date.localeFormat(format)};DateTimeScrollerItemSpec.prototype.render=function(){return ScrollerItem.ScrollerItem({key:"DateTimeScrollerItem",mainText:this.getText(false),smallText:this.getText(true),isCurrentItem:this.props.isCurrentItem,onShortPress:this.onShortPress,className:CssClassSet({yearWithEra:this.props.dateComponent==exports.DATE_COMPONENT_YEAR_WITH_ERA},this.props.className),dimensions:this.props.dimensions,tabIndex:this.props.tabIndex,onKeyDown:this.onKeyDown,reactClientContext:this.props.reactClientContext})};return DateTimeScrollerItemSpec}(TsAdapter.SpecBase);exports.DateTimeScrollerItem=TsAdapter.createComponent(new DateTimeScrollerItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Common/ScrollerPopup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Primitives/AncestorMountedHost","Components/Primitives/Popup"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,AncestorMountedHost,Popup){var ITEM_HEIGHT=88,MIN_PAD_ITEMS=2,ScrollerPopupSpec=function(_super){__extends(ScrollerPopupSpec,_super);function ScrollerPopupSpec(){_super.apply(this,arguments);this.displayName="ScrollerPopup";this.mixins=[PureUpdate.Mixin];this.numChildrenMounted=0;this.numChildren=0;this.paddingShift=0;this.topActiveIndex=0;this.bottomActiveIndex=-1;this.initialized=false}ScrollerPopupSpec.prototype.getInitialState=function(){return {scrollTop:0}};ScrollerPopupSpec.prototype.getDefaultProps=function(){return {createItem:this.createItemDefault,top:0,padItemCount:30}};ScrollerPopupSpec.prototype.createItemDefault=function(index){return React.DOM.div()};ScrollerPopupSpec.prototype.getItemHeight=function(){return this.props.isPhone?this.props.dimensions?this.props.dimensions.componentHeight:ITEM_HEIGHT:ITEM_HEIGHT};ScrollerPopupSpec.prototype.calculateScrollForItemNumber=function(itemNumber){var itemHeight=this.getItemHeight(),topVisibleItemOverlap=itemHeight-this.props.top%itemHeight,topVisibleItemScroll=topVisibleItemOverlap==itemHeight?0:topVisibleItemOverlap,padItemsScroll=this.props.padItemCount*itemHeight,currentItemScroll=itemNumber*itemHeight;return topVisibleItemScroll+padItemsScroll+currentItemScroll};ScrollerPopupSpec.prototype.handleScroll=function(){if(this.initialized){var scrollerPopup=this.refs["scrollerPopup"],scrollDistance=ReactDOM.findDOMNode(scrollerPopup).scrollTop;this.setState({scrollTop:scrollDistance})}else this.initialized=true};ScrollerPopupSpec.prototype.getPopupHeight=function(){return $(document).height()};ScrollerPopupSpec.prototype.getUpdatedItems=function(){var topVisibleIndex,itemHeight=this.getItemHeight();if(this.state.scrollTop==0)topVisibleIndex=Math.floor(-this.props.top/itemHeight);else topVisibleIndex=Math.floor(this.state.scrollTop/itemHeight)+this.topActiveIndex;var topVisiblePortion=this.props.top%itemHeight,visibleItems=Math.ceil((this.getPopupHeight()-topVisiblePortion)/itemHeight),bottomVisibleIndex=topVisibleIndex+visibleItems-1;if(this.topActiveIndex>topVisibleIndex-MIN_PAD_ITEMS)while(this.topActiveIndex>topVisibleIndex-this.props.padItemCount){this.topActiveIndex--;if(this.initialized)this.paddingShift+=itemHeight}else if(this.state.scrollTop<itemHeight&&this.initialized)this.paddingShift+=itemHeight;if(this.bottomActiveIndex<bottomVisibleIndex+MIN_PAD_ITEMS)while(this.bottomActiveIndex<bottomVisibleIndex+this.props.padItemCount)this.bottomActiveIndex++;for(var children=[],i=this.topActiveIndex;i<=this.bottomActiveIndex;i++)children.push(this.props.createItem(i));return children};ScrollerPopupSpec.prototype.componentDidMount=function(){var scrollerComponent=this.refs["scrollerPopup"],scrollerPopup=ReactDOM.findDOMNode(scrollerComponent);scrollerPopup.scrollTop=this.calculateScrollForItemNumber(0)};ScrollerPopupSpec.prototype.componentDidUpdate=function(){if(this.initialized&&this.paddingShift>0){var scrollerComponent=this.refs["scrollerPopup"],scrollerPopup=ReactDOM.findDOMNode(scrollerComponent);scrollerPopup.scrollTop+=this.paddingShift;this.paddingShift=0}};ScrollerPopupSpec.prototype.render=function(){var styles={};styles["left"]=this.props.left;var popupInner=React.DOM.div({key:"popup-inner","popup-type":this.props.popupType},this.getUpdatedItems());if(this.props.isPhone)var bindingElement=document.getElementById("scroller-popOver");var popup=Popup.Popup({key:"scrollerPopup",className:CssClassSet({popOver:this.props.isPhone},"scrollerPopup",this.props.className),visible:this.props.visible,onDismiss:this.props.onDismiss,style:styles,onScroll:this.handleScroll,ref:"scrollerPopup",bindingElement:bindingElement},popupInner);return AncestorMountedHost.AncestorMountedHost({key:"scroller",selectorString:this.props.isPhone?".scroller-popOver":"body"},popup)};return ScrollerPopupSpec}(TsAdapter.SpecBase);exports.ScrollerPopup=TsAdapter.createComponent(new ScrollerPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/DateTimeScrollerPopup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Fields/ScrollerControls/Common/ScrollerPopup","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerItem"],function(require,exports,TsAdapter,PureUpdate,ScrollerPopup,DateTimeScrollerItem){var MIN_YEAR=1753,MAX_YEAR=9999,NUMBER_OF_SUPPORTED_YEARS=MAX_YEAR-MIN_YEAR+1,ITEM_IDENTIFIER="popupScrollerItem-",DateTimeScrollerPopupSpec=function(_super){__extends(DateTimeScrollerPopupSpec,_super);function DateTimeScrollerPopupSpec(){_super.apply(this,arguments);this.displayName="DateTimeScrollerPopup";this.mixins=[PureUpdate.Mixin]}DateTimeScrollerPopupSpec.prototype.offSetMatchesCurrentDate=function(dateOffset){switch(this.props.dateComponent){case DateTimeScrollerItem.DATE_COMPONENT_YEAR:case DateTimeScrollerItem.DATE_COMPONENT_YEAR_WITH_ERA:return dateOffset==0;case DateTimeScrollerItem.DATE_COMPONENT_MONTH:return dateOffset%12==0;case DateTimeScrollerItem.DATE_COMPONENT_DAY:return dateOffset%this.daysInMonth(this.props.date)==0;case DateTimeScrollerItem.DATE_COMPONENT_12HOUR:return dateOffset%12==0;case DateTimeScrollerItem.DATE_COMPONENT_24HOUR:return dateOffset%24==0;case DateTimeScrollerItem.DATE_COMPONENT_MINUTE:return dateOffset%60==0;case DateTimeScrollerItem.DATE_COMPONENT_PERIOD:return dateOffset%2==0}return false};DateTimeScrollerPopupSpec.prototype.daysInMonth=function(date){var dateCopy=new Date(date.getFullYear(),date.getMonth()+1,0);return dateCopy.getDate()};DateTimeScrollerPopupSpec.prototype.getDateWithOffset=function(offset){var offsetDateTime=new Date(this.props.date.getTime());switch(this.props.dateComponent){case DateTimeScrollerItem.DATE_COMPONENT_YEAR:case DateTimeScrollerItem.DATE_COMPONENT_YEAR_WITH_ERA:var originalMonth=offsetDateTime.getMonth(),originalDays=offsetDateTime.getDate(),newYear=offsetDateTime.getFullYear()+offset;if(newYear<MIN_YEAR)newYear-=NUMBER_OF_SUPPORTED_YEARS*Math.floor(offset/NUMBER_OF_SUPPORTED_YEARS);else if(newYear>MAX_YEAR)newYear-=NUMBER_OF_SUPPORTED_YEARS*Math.ceil(offset/NUMBER_OF_SUPPORTED_YEARS);offsetDateTime.setFullYear(newYear);offsetDateTime.setMonth(originalMonth);var daysInCurrentMonth=this.daysInMonth(offsetDateTime);if(originalDays>daysInCurrentMonth)offsetDateTime.setDate(daysInCurrentMonth);else offsetDateTime.setDate(originalDays);break;case DateTimeScrollerItem.DATE_COMPONENT_MONTH:var originalDate=offsetDateTime.getDate();offsetDateTime.setDate(1);offsetDateTime.setMonth(offsetDateTime.getMonth()+offset);offsetDateTime.setFullYear(this.props.date.getFullYear());var daysInMonth=this.daysInMonth(offsetDateTime);if(originalDate>daysInMonth)offsetDateTime.setDate(daysInMonth);else offsetDateTime.setDate(originalDate);break;case DateTimeScrollerItem.DATE_COMPONENT_DAY:var monthLength=this.daysInMonth(offsetDateTime),dateI=offsetDateTime.getDate()-1,monthMultiplier=Math.floor(Math.abs(offset)/monthLength)+1,newDate=(dateI+monthMultiplier*monthLength+offset)%monthLength+1;offsetDateTime.setDate(newDate);break;case DateTimeScrollerItem.DATE_COMPONENT_12HOUR:var hour=(offsetDateTime.getHours()%12+offset)%12;if(hour<0)hour+=12;if(offsetDateTime.getHours()>=12)hour+=12;offsetDateTime.setHours(hour%24);break;case DateTimeScrollerItem.DATE_COMPONENT_24HOUR:hour=(offsetDateTime.getHours()+offset)%24;if(hour<0)hour+=24;offsetDateTime.setHours(hour);break;case DateTimeScrollerItem.DATE_COMPONENT_MINUTE:var minute=(offsetDateTime.getMinutes()+offset)%60;if(minute<0)minute+=60;offsetDateTime.setMinutes(minute);break;case DateTimeScrollerItem.DATE_COMPONENT_MONTH:offsetDateTime.setHours((offsetDateTime.getHours()+Math.abs(offset)*12)%24);break}return offsetDateTime};DateTimeScrollerPopupSpec.prototype.handlePopupItemShortPress=function(e,itemDate){e.stopPropagation();this.props.setDate(itemDate)};DateTimeScrollerPopupSpec.prototype.createItem=function(itemNumber){return DateTimeScrollerItem.DateTimeScrollerItem({key:ITEM_IDENTIFIER+itemNumber,ref:ITEM_IDENTIFIER+itemNumber,isCurrentItem:this.offSetMatchesCurrentDate(itemNumber),date:this.getDateWithOffset(itemNumber),dateComponent:this.props.dateComponent,onShortPressWithDate:this.handlePopupItemShortPress,dimensions:this.props.dimensions,tabIndex:this.props.tabIndex,onKeyDownWithDate:this.handlePopupItemKeyDown,reactClientContext:this.props.reactClientContext})};DateTimeScrollerPopupSpec.prototype.handlePopupItemKeyDown=function(e,itemDate){if(e.key==="Enter"){e.stopPropagation();e.preventDefault();this.props.setDate(itemDate);this.props.onAfterEnterKeyPressedOnItem&&this.props.onAfterEnterKeyPressedOnItem()}};DateTimeScrollerPopupSpec.prototype.render=function(){return ScrollerPopup.ScrollerPopup({createItem:this.createItem,top:this.props.top,left:this.props.left,visible:this.props.visible,onDismiss:this.props.onDismiss,itemIdentifier:ITEM_IDENTIFIER,padItemCount:this.props.padItemCount,isPhone:this.props.isPhone,dimensions:this.props.dimensions})};return DateTimeScrollerPopupSpec}(TsAdapter.SpecBase);exports.DateTimeScrollerPopup=TsAdapter.createComponent(new DateTimeScrollerPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/DateTimeScrollerComponent",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Fields/ScrollerControls/Common/ScrollerComponent","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerItem","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerPopup"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,ScrollerComponent,DateTimeScrollerItem,DateTimeScrollerPopup){var DateTimeScrollerComponentSpec=function(_super){__extends(DateTimeScrollerComponentSpec,_super);function DateTimeScrollerComponentSpec(){_super.apply(this,arguments);this.displayName="DateTimeScrollerComponent";this.mixins=[PureUpdate.Mixin]}DateTimeScrollerComponentSpec.prototype.getInitialState=function(){return {hasFocus:false}};DateTimeScrollerComponentSpec.prototype.getCssClass=function(){if(this.props.dateComponent)switch(this.props.dateComponent){case DateTimeScrollerItem.DATE_COMPONENT_YEAR:case DateTimeScrollerItem.DATE_COMPONENT_YEAR_WITH_ERA:return "yearComponentScroller";case DateTimeScrollerItem.DATE_COMPONENT_MONTH:return "monthComponentScroller";case DateTimeScrollerItem.DATE_COMPONENT_DAY:return "dayComponentScroller";case DateTimeScrollerItem.DATE_COMPONENT_24HOUR:case DateTimeScrollerItem.DATE_COMPONENT_12HOUR:return "hourComponentScroller";case DateTimeScrollerItem.DATE_COMPONENT_MINUTE:return "minuteComponentScroller";case DateTimeScrollerItem.DATE_COMPONENT_PERIOD:return "periodComponentScroller"}return ""};DateTimeScrollerComponentSpec.prototype.handleShortPress=function(e){this.updateScrollerState()};DateTimeScrollerComponentSpec.prototype.updateScrollerState=function(){if(this.props.dateComponent==DateTimeScrollerItem.DATE_COMPONENT_PERIOD){var tempdate=new Date(this.props.date.getTime());tempdate.setHours((tempdate.getHours()+12)%24);this.props.setDate(tempdate)}else{this.props.setRowActive&&this.props.setRowActive(!this.state.hasFocus);this.setState({hasFocus:!this.state.hasFocus,left:this.state.left?this.state.left:$(ReactDOM.findDOMNode(this)).offset().left,top:this.state.top?this.state.top:$(ReactDOM.findDOMNode(this)).offset().top})}};DateTimeScrollerComponentSpec.prototype.dismissPopup=function(){this.props.setRowActive(false);this.setState({hasFocus:false,left:this.state.left,top:this.state.top})};DateTimeScrollerComponentSpec.prototype.setDate=function(d){this.props.setDate(d);this.dismissPopup()};DateTimeScrollerComponentSpec.prototype.onKeyDownHandler=function(e){if(e.key==="Enter"){e.stopPropagation();e.preventDefault();this.updateScrollerState()}};DateTimeScrollerComponentSpec.prototype.onPopupItemSelected=function(){var scrollerComponent=this.refs["scrollerItem"];scrollerComponent&&$(ReactDOM.findDOMNode(scrollerComponent)).focus()};DateTimeScrollerComponentSpec.prototype.render=function(){var children=[],scrollerItem=DateTimeScrollerItem.DateTimeScrollerItem({key:"scrollerItem",ref:"scrollerItem",date:this.props.date,isCurrentItem:true,className:CssClassSet({focusedItem:this.state.hasFocus}),dateComponent:this.props.dateComponent,dimensions:this.props.dimensions,tabIndex:this.props.tabIndex,onKeyDown:this.onKeyDownHandler,reactClientContext:this.props.reactClientContext});children.push(scrollerItem);if(this.state.hasFocus){var scrollPopup=DateTimeScrollerPopup.DateTimeScrollerPopup({key:"dateTimeScrollerPopup",top:this.state.top,left:this.state.left,date:this.props.date,dateComponent:this.props.dateComponent,onDismiss:this.dismissPopup,visible:true,setDate:this.setDate,padItemCount:this.props.popupPadItems,isPhone:this.props.isPhone,dimensions:this.props.dimensions,tabIndex:this.props.tabIndex,onAfterEnterKeyPressedOnItem:this.onPopupItemSelected,reactClientContext:this.props.reactClientContext});children.push(scrollPopup)}return ScrollerComponent.ScrollerComponent({key:"dateTimeComponent",cssClass:this.getCssClass(),onShortPress:this.handleShortPress,dimensions:this.props.dimensions},children)};return DateTimeScrollerComponentSpec}(TsAdapter.SpecBase);exports.DateTimeScrollerComponent=TsAdapter.createComponent(new DateTimeScrollerComponentSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/DateScroller",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerComponent","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerItem"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,DateTimeScrollerComponent,DateTimeScrollerItem){var DateScrollerSpec=function(_super){__extends(DateScrollerSpec,_super);function DateScrollerSpec(){_super.apply(this,arguments);this.displayName="DateScroller";this.mixins=[PureUpdate.Mixin]}DateScrollerSpec.prototype.setRowActive=function(isActive){this.props.setRowActive&&this.props.setRowActive(true,isActive)};DateScrollerSpec.prototype.render=function(){var dayScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"dayScroller",dateComponent:DateTimeScrollerItem.DATE_COMPONENT_DAY,position:this.props.dateFormat.indexOf("d"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext}),monthScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"monthScroller",dateComponent:DateTimeScrollerItem.DATE_COMPONENT_MONTH,position:this.props.dateFormat.indexOf("M"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext}),yearScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"yearScroller",dateComponent:this.props.dateFormat.indexOf("g")>=0?DateTimeScrollerItem.DATE_COMPONENT_YEAR_WITH_ERA:DateTimeScrollerItem.DATE_COMPONENT_YEAR,position:this.props.dateFormat.indexOf("y"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext}),children=[dayScrollerComponent,monthScrollerComponent,yearScrollerComponent].sort(function(n1,n2){return n1.props.position-n2.props.position}),componentTabIndex=this.props.tabIndex;children.map(function(component,index){return React.cloneElement(component,{tabIndex:componentTabIndex++})});return React.DOM.div({key:"dateScroller",className:CssClassSet({scroller:true},this.props.className)},children)};return DateScrollerSpec}(TsAdapter.SpecBase);exports.DateScroller=TsAdapter.createComponent(new DateScrollerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/TimeScroller",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerComponent","Components/Fields/ScrollerControls/DateTime/DateTimeScrollerItem"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,DateTimeScrollerComponent,DateTimeScrollerItem){var TimeScrollerSpec=function(_super){__extends(TimeScrollerSpec,_super);function TimeScrollerSpec(){_super.apply(this,arguments);this.displayName="TimeScroller";this.mixins=[PureUpdate.Mixin]}TimeScrollerSpec.prototype.setRowActive=function(isActive){this.props.setRowActive&&this.props.setRowActive(false,isActive)};TimeScrollerSpec.prototype.render=function(){var isAstronomicalTime=this.props.timeFormat&&this.props.timeFormat.indexOf("H")>=0,hourScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"hourScroller",dateComponent:isAstronomicalTime?DateTimeScrollerItem.DATE_COMPONENT_24HOUR:DateTimeScrollerItem.DATE_COMPONENT_12HOUR,position:isAstronomicalTime?this.props.timeFormat.indexOf("h"):this.props.timeFormat.indexOf("H"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext}),minuteScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"minuteScroller",dateComponent:DateTimeScrollerItem.DATE_COMPONENT_MINUTE,position:this.props.timeFormat.indexOf("m"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext}),children=[hourScrollerComponent,minuteScrollerComponent];if(!isAstronomicalTime){var periodScrollerComponent=DateTimeScrollerComponent.DateTimeScrollerComponent({key:"periodScroller",dateComponent:DateTimeScrollerItem.DATE_COMPONENT_PERIOD,position:this.props.timeFormat.indexOf("t"),date:this.props.date,popupPadItems:this.props.popupPadItems,setDate:this.props.setDate,isPhone:this.props.isPhone,dimensions:this.props.dimensions,setRowActive:this.setRowActive,reactClientContext:this.props.reactClientContext});children.push(periodScrollerComponent)}children.sort(function(n1,n2){return n1.props.position-n2.props.position});return React.DOM.div({key:"timeScroller",className:CssClassSet({scroller:true,timeScroller:true},this.props.className)},children)};return TimeScrollerSpec}(TsAdapter.SpecBase);exports.TimeScroller=TsAdapter.createComponent(new TimeScrollerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/DateTime/DateTimeScroller",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Fields/ScrollerControls/DateTime/DateScroller","Components/Fields/ScrollerControls/DateTime/TimeScroller","Components/Primitives/ImageButton","Components/Primitives/AncestorMountedHost","Utils/ZIndexFinder"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,DateScroller,TimeScroller,ImageButton,AncestorMountedHost,ZIndexFinder){exports.DESCRIPTOR_NAME="DateTimeScroller";(function(ActiveRow){ActiveRow[ActiveRow["None"]=0]="None";ActiveRow[ActiveRow["Date"]=1]="Date";ActiveRow[ActiveRow["Time"]=2]="Time"})(exports.ActiveRow||(exports.ActiveRow={}));var ActiveRow=exports.ActiveRow,DateTimeScrollerSpec=function(_super){__extends(DateTimeScrollerSpec,_super);function DateTimeScrollerSpec(){_super.apply(this,arguments);this.displayName="DateTimeScroller";this.listenToProperties=["Format","ShowLabel","Label","Date"];this.tempDate=null;this.tempDateSet=false;this.popupClickDebouncer=false}DateTimeScrollerSpec.prototype.getInitialState=function(){return {activeRow:ActiveRow.None}};DateTimeScrollerSpec.prototype.handleClear=function(){this.props.onDismiss&&this.props.onDismiss();this.tempDate=null;this.tempDateSet=false;this.props.dataContext.get_ClearValueCommand().execute()};DateTimeScrollerSpec.prototype.handleOk=function(){this.props.onDismiss&&this.props.onDismiss();this.tempDate=null;this.tempDateSet=false};DateTimeScrollerSpec.prototype.handleCancel=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel);this.props.onDismiss&&this.props.onDismiss();if(!this.tempDate)this.props.dataContext.get_ClearValueCommand().execute();else{this.props.dataContext.set_Date(this.tempDate);this.tempDate=null}this.tempDateSet=false};DateTimeScrollerSpec.prototype.setDate=function(d){if(!this.props.dataContext.get_ShowTime()){d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0)}d=this.adjustAllDayDate(d,1);this.props.dataContext.set_Date(d)};DateTimeScrollerSpec.prototype.getDate=function(){var date=this.props.dataContext.get_Date();date=this.adjustAllDayDate(date,-1);return date};DateTimeScrollerSpec.prototype.adjustAllDayDate=function(d,adjustment){if(this.props.dataContext.get_AllDayDisplay()){var adjustedDate=new Date(d.getTime());adjustedDate.setDate(adjustedDate.getDate()+adjustment);d=adjustedDate}return d};DateTimeScrollerSpec.prototype.generateScrollerDimensions=function(){var screenWidth=document.documentElement.clientWidth,itemMargin=Math.floor(1/48*screenWidth),itemBorder=Math.floor(1/240*screenWidth),itemWidth=Math.floor(1/4*screenWidth-2*itemBorder),componentHeight=Math.floor(itemWidth+2*itemBorder+itemMargin);return {itemMargin:itemMargin,itemBorder:itemBorder,itemWidth:itemWidth,componentHeight:componentHeight,smallText:screenWidth*(1/32),largeText:this.props.clientContext.userAgent.get_IsHPEliteWindowsPhone()?screenWidth*(7/110):screenWidth*(7/80)}};DateTimeScrollerSpec.prototype.getLabel=function(){if(this.props.dataContext.get_ShowLabel()||this.props.showLabel&&this.props.clientContext.isPhone){var label=React.DOM.span({key:"label",className:"label"},this.props.dataContext.get_Label());return label}return null};DateTimeScrollerSpec.prototype.getCommonComponents=function(children){var padItems=this.props.clientContext.userAgent.get_IsAndroid()?120:30,isPhone=this.props.clientContext.isPhone,clientContext=this.props.clientContext,dateScroller=DateScroller.DateScroller({key:"dateScroller",date:this.getDate(),dateFormat:this.props.dataContext.get_DateFormat(),popupPadItems:padItems,setDate:this.setDate,isPhone:isPhone,dimensions:this.dimensions,className:CssClassSet({inactive:this.state.activeRow===ActiveRow.Time}),setRowActive:isPhone?this.setActiveRow:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,reactClientContext:clientContext});children.push(dateScroller);if(this.props.dataContext.get_ShowTime()){var timeScroller=TimeScroller.TimeScroller({key:"timeScroller",date:this.getDate(),timeFormat:this.props.dataContext.get_TimeFormat(),popupPadItems:padItems,setDate:this.setDate,isPhone:isPhone,dimensions:this.dimensions,className:CssClassSet({inactive:this.state.activeRow===ActiveRow.Date}),setRowActive:isPhone?this.setActiveRow:null,reactClientContext:clientContext});children.push(timeScroller)}return children};DateTimeScrollerSpec.prototype.renderInlineControl=function(){var children=[];children.push(this.getLabel());children=this.getCommonComponents(children);var button=ImageButton.ImageButton({label:this.props.dataContext.get_ClearFieldText(),className:"scroller_button",key:"clearButton",onClick:this.handleClear,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_NextTabIndex()-1:null});children.push(button);return React.DOM.div({className:"scroller",title:this.props.dataContext.get_Label()},children)};DateTimeScrollerSpec.prototype.renderPopoverControl=function(){var innerChildren=this.getCommonComponents([]),container=React.DOM.div({className:CssClassSet({scrollerContainer:true,doubleScrollerContainer:this.props.dataContext.get_ShowTime()}),key:"container"},innerChildren),okButton=ImageButton.ImageButton({key:"okButton",label:this.props.dataContext.get_OkText(),imageType:"Symbol",imageName:"Accept",onClick:this.handleOk}),cancelButton=ImageButton.ImageButton({key:"cancelButton",label:this.props.dataContext.get_CancelText(),imageType:"Symbol",imageName:"Cancel",onClick:this.handleCancel}),clearButton=ImageButton.ImageButton({key:"clearButton",label:this.props.dataContext.get_ClearFieldText(),imageType:"Symbol",imageName:"Clear",onClick:this.handleClear}),buttons=[okButton,cancelButton,clearButton],buttonContainer=React.DOM.div({key:"buttonContainer",className:"scroller-buttonContainer appBarSection"},buttons),controlBar=React.DOM.div({key:"controlBar",className:"scroller-controlBar appBar"},buttonContainer),popOver=React.DOM.div({className:"scroller-popOver",id:"scroller-popOver",style:{zIndex:ZIndexFinder()},onClick:this.props.clientContext.isUsingPointerUp?null:this.interceptEvent,onPointerUp:this.props.clientContext.isUsingPointerUp?this.interceptEvent:null},[this.getLabel(),container,controlBar]),host=AncestorMountedHost.AncestorMountedHost({selectorString:"body"},popOver);return host};DateTimeScrollerSpec.prototype.setActiveRow=function(isDate,isActive){if(this.popupClickDebouncer){this.popupClickDebouncer=false;return}var row=ActiveRow.None;if(isActive){if(isDate)row=ActiveRow.Date;else row=ActiveRow.Time;if(this.state.activeRow!==ActiveRow.None)this.popupClickDebouncer=true}this.setState({activeRow:row})};DateTimeScrollerSpec.prototype.interceptEvent=function(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation()};DateTimeScrollerSpec.prototype.componentWillMount=function(){if(this.props.clientContext.isPhone)this.dimensions=this.generateScrollerDimensions();this.props.clientContext.reactBackHandlerHelper.addHandler(this.handleCancel);this.activeElementBeforeOpening=document.activeElement};DateTimeScrollerSpec.prototype.componentWillUnmount=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel);this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};DateTimeScrollerSpec.prototype.render=function(){if(this.props.clientContext.isPhone&&!this.tempDateSet){this.tempDate=this.getDate();this.tempDateSet=true}this.props.dataContext.setDateIfNull();if(this.props.clientContext.isPhone)return this.renderPopoverControl();else return this.renderInlineControl()};return DateTimeScrollerSpec}(TsAdapter.SpecBase);exports.DateTimeScroller=DataWrapperComponent.wrapComponent(new DateTimeScrollerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Duration/DurationScrollerItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Fields/ScrollerControls/Common/ScrollerItem"],function(require,exports,TsAdapter,PureUpdate,ScrollerItem){exports.DURATION_COMPONENT_DAY="day";exports.DURATION_COMPONENT_HOUR="hour";exports.DURATION_COMPONENT_MINUTE="minute";var DurationScrollerItemSpec=function(_super){__extends(DurationScrollerItemSpec,_super);function DurationScrollerItemSpec(){_super.apply(this,arguments);this.displayName="DurationScrollerItem";this.mixins=[PureUpdate.Mixin]}DurationScrollerItemSpec.prototype.getDefaultProps=function(){return {isCurrentItem:false}};DurationScrollerItemSpec.prototype.onShortPress=function(e){this.props.onShortPressWithDuration&&this.props.onShortPressWithDuration(e,this.props.duration)};DurationScrollerItemSpec.prototype.getDurationText=function(forSmallText){if((this.props.duration||this.props.duration===0)&&this.props.durationComponent){var days=Math.floor(this.props.duration/(60*24)),durationMinusDays=this.props.duration%(60*24),hours=Math.floor(durationMinusDays/60),minutes=durationMinusDays%60,text="",smallText="";switch(this.props.durationComponent){case exports.DURATION_COMPONENT_DAY:var daysText="0"+days;text=daysText.substr(Math.max(0,daysText.length-2));smallText=days!=1?this.props.localizedStrings.days:this.props.localizedStrings.day;break;case exports.DURATION_COMPONENT_HOUR:var hoursText="0"+hours;text=hoursText.substr(Math.max(0,hoursText.length-2));smallText=hours!=1?this.props.localizedStrings.hours:this.props.localizedStrings.hour;break;case exports.DURATION_COMPONENT_MINUTE:var minutesText="0"+minutes;text=minutesText.substr(Math.max(0,minutesText.length-2));smallText=minutes!=1?this.props.localizedStrings.minutes:this.props.localizedStrings.minute;break}if(forSmallText)return smallText;else return text}return ""};DurationScrollerItemSpec.prototype.render=function(){return ScrollerItem.ScrollerItem({key:"DurationScrollerItem",mainText:this.getDurationText(false),smallText:this.getDurationText(true),isCurrentItem:this.props.isCurrentItem,onShortPress:this.onShortPress,className:this.props.className,dimensions:this.props.dimensions,reactClientContext:this.props.reactClientContext,tabIndex:this.props.tabIndex})};return DurationScrollerItemSpec}(TsAdapter.SpecBase);exports.DurationScrollerItem=TsAdapter.createComponent(new DurationScrollerItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Duration/DurationScrollerPopup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Fields/ScrollerControls/Common/ScrollerPopup","Components/Fields/ScrollerControls/Duration/DurationScrollerItem"],function(require,exports,TsAdapter,PureUpdate,ScrollerPopup,DurationScrollerItem){var MAXIMUM_DAYS=32,ITEM_IDENTIFIER="popupScrollerItem-",DurationScrollerPopupSpec=function(_super){__extends(DurationScrollerPopupSpec,_super);function DurationScrollerPopupSpec(){_super.apply(this,arguments);this.displayName="DurationScrollerPopup";this.mixins=[PureUpdate.Mixin]}DurationScrollerPopupSpec.prototype.offSetMatchesCurrentDuration=function(durationOffset){switch(this.props.durationComponent){case DurationScrollerItem.DURATION_COMPONENT_DAY:return durationOffset%MAXIMUM_DAYS==0;case DurationScrollerItem.DURATION_COMPONENT_HOUR:return durationOffset%24==0;case DurationScrollerItem.DURATION_COMPONENT_MINUTE:return durationOffset%60==0}return false};DurationScrollerPopupSpec.prototype.getDurationWithOffset=function(offset){var offsetDuration=this.props.duration,days=Math.floor(this.props.duration/(60*24)),durationMinusDays=this.props.duration%(60*24),hours=Math.floor(durationMinusDays/60),minutes=durationMinusDays%60;switch(this.props.durationComponent){case DurationScrollerItem.DURATION_COMPONENT_DAY:var dayOffset=(days+offset)%MAXIMUM_DAYS;if(dayOffset<0)dayOffset+=MAXIMUM_DAYS;offsetDuration=durationMinusDays+dayOffset*60*24;break;case DurationScrollerItem.DURATION_COMPONENT_HOUR:var hourOffset=(hours+offset)%24;if(hourOffset<0)hourOffset+=24;offsetDuration=this.props.duration-(durationMinusDays-minutes)+hourOffset*60;break;case DurationScrollerItem.DURATION_COMPONENT_MINUTE:var minuteOffset=(minutes+offset)%60;if(minuteOffset<0)minuteOffset+=60;offsetDuration=this.props.duration-minutes+minuteOffset;break}return offsetDuration};DurationScrollerPopupSpec.prototype.handlePopupItemShortPress=function(e,itemDuration){e.stopPropagation();this.props.setDuration(itemDuration)};DurationScrollerPopupSpec.prototype.createItem=function(itemNumber){return DurationScrollerItem.DurationScrollerItem({key:ITEM_IDENTIFIER+itemNumber,ref:ITEM_IDENTIFIER+itemNumber,isCurrentItem:this.offSetMatchesCurrentDuration(itemNumber),duration:this.getDurationWithOffset(itemNumber),durationComponent:this.props.durationComponent,onShortPressWithDuration:this.handlePopupItemShortPress,localizedStrings:this.props.localizedStrings,dimensions:this.props.dimensions,reactClientContext:this.props.reactClientContext})};DurationScrollerPopupSpec.prototype.render=function(){return ScrollerPopup.ScrollerPopup({createItem:this.createItem,top:this.props.top,left:this.props.left,visible:this.props.visible,onDismiss:this.props.onDismiss,itemIdentifier:ITEM_IDENTIFIER,padItemCount:this.props.padItemCount,isPhone:this.props.isPhone,dimensions:this.props.dimensions})};return DurationScrollerPopupSpec}(TsAdapter.SpecBase);exports.DurationScrollerPopup=TsAdapter.createComponent(new DurationScrollerPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Duration/DurationScrollerComponent",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Fields/ScrollerControls/Common/ScrollerComponent","Components/Fields/ScrollerControls/Duration/DurationScrollerItem","Components/Fields/ScrollerControls/Duration/DurationScrollerPopup"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,ScrollerComponent,DurationScrollerItem,DurationScrollerPopup){var DurationScrollerComponentSpec=function(_super){__extends(DurationScrollerComponentSpec,_super);function DurationScrollerComponentSpec(){_super.apply(this,arguments);this.displayName="DurationScrollerComponent";this.mixins=[PureUpdate.Mixin]}DurationScrollerComponentSpec.prototype.getInitialState=function(){return {hasFocus:false}};DurationScrollerComponentSpec.prototype.handleShortPress=function(e){this.setState({hasFocus:!this.state.hasFocus,left:this.state.left?this.state.left:$(ReactDOM.findDOMNode(this)).offset().left,top:this.state.top?this.state.top:$(ReactDOM.findDOMNode(this)).offset().top})};DurationScrollerComponentSpec.prototype.dismissPopup=function(){this.setState({hasFocus:false,left:this.state.left,top:this.state.top})};DurationScrollerComponentSpec.prototype.setDuration=function(d){this.props.setDuration(d);this.dismissPopup()};DurationScrollerComponentSpec.prototype.render=function(){var children=[],scrollerChild=DurationScrollerItem.DurationScrollerItem({key:"scrollerItem",className:CssClassSet({focusedItem:this.state.hasFocus}),duration:this.props.duration,isCurrentItem:true,durationComponent:this.props.durationComponent,localizedStrings:this.props.localizedStrings,dimensions:this.props.dimensions,reactClientContext:this.props.reactClientContext});children.push(scrollerChild);if(this.state.hasFocus){var scrollPopup=DurationScrollerPopup.DurationScrollerPopup({key:"durationScrollerPopup",top:this.state.top,left:this.state.left,duration:this.props.duration,durationComponent:this.props.durationComponent,onDismiss:this.dismissPopup,visible:true,setDuration:this.setDuration,padItemCount:this.props.popupPadItems,localizedStrings:this.props.localizedStrings,isPhone:this.props.isPhone,dimensions:this.props.dimensions,reactClientContext:this.props.reactClientContext});children.push(scrollPopup)}return ScrollerComponent.ScrollerComponent({key:"durationComponent",onShortPress:this.handleShortPress,dimensions:this.props.dimensions},children)};return DurationScrollerComponentSpec}(TsAdapter.SpecBase);exports.DurationScrollerComponent=TsAdapter.createComponent(new DurationScrollerComponentSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/ScrollerControls/Duration/DurationScroller",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ScrollerControls/Duration/DurationScrollerComponent","Components/Fields/ScrollerControls/Duration/DurationScrollerItem","Components/Primitives/ImageButton","Components/Primitives/AncestorMountedHost","Utils/ZIndexFinder"],function(require,exports,TsAdapter,DataWrapperComponent,DurationScrollerComponent,DurationScrollerItem,ImageButton,AncestorMountedHost,ZIndexFinder){exports.DESCRIPTOR_NAME="DurationScroller";var DurationScrollerSpec=function(_super){__extends(DurationScrollerSpec,_super);function DurationScrollerSpec(){_super.apply(this,arguments);this.listenToProperties=["ShowLabel","Label","Data"];this.tempDuration=null;this.tempDurSet=false;this.displayName="DurationScroller"}DurationScrollerSpec.prototype.handleClear=function(){this.props.onDismiss&&this.props.onDismiss();this.tempDuration=null;this.tempDurSet=false;this.props.dataContext.get_ClearValueCommand().execute()};DurationScrollerSpec.prototype.handleOk=function(){this.props.onDismiss&&this.props.onDismiss();this.tempDuration=null;this.tempDurSet=false};DurationScrollerSpec.prototype.handleKeyDown=function(e){};DurationScrollerSpec.prototype.handleCancel=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel);this.props.onDismiss&&this.props.onDismiss();if(!this.tempDuration&&this.tempDuration!==0)this.props.dataContext.get_ClearValueCommand().execute();else this.props.dataContext.set_Data(this.tempDuration);this.tempDuration=null;this.tempDurSet=false};DurationScrollerSpec.prototype.generateScrollerDimensions=function(){var screenWidth=document.documentElement.clientWidth,itemMargin=Math.ceil(1/48*screenWidth),itemBorder=Math.ceil(1/240*screenWidth),itemWidth=Math.ceil(1/4*screenWidth-2*itemBorder),componentHeight=Math.ceil(itemWidth+2*itemBorder+itemMargin);return {itemMargin:itemMargin,itemBorder:itemBorder,itemWidth:itemWidth,componentHeight:componentHeight,smallText:screenWidth*(1/32),largeText:this.props.clientContext.userAgent.get_IsHPEliteWindowsPhone()?screenWidth*(7/110):screenWidth*(7/80)}};DurationScrollerSpec.prototype.setDuration=function(d){this.props.dataContext.set_Data(d)};DurationScrollerSpec.prototype.getDuration=function(){return this.props.dataContext.get_Data()};DurationScrollerSpec.prototype.getLabel=function(){if(this.props.dataContext.get_ShowLabel()||this.props.showLabel&&this.props.clientContext.isPhone){var label=React.DOM.span({key:"label",className:"label"},this.props.dataContext.get_Label());return label}return null};DurationScrollerSpec.prototype.getCommonComponents=function(children){var padItems=this.props.clientContext.userAgent.get_IsAndroid()?120:30,duration=this.getDuration(),isPhone=this.props.clientContext.isPhone,clientContext=this.props.clientContext,localizedStrings={days:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Days_Text"),day:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Day_Text"),hours:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Hours_Text"),hour:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Hour_Text"),minutes:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Minutes_Text"),minute:this.props.clientContext.getLocalizedString("L_DurationScrollerItem.Minute_Text")},dayScrollerComponent=DurationScrollerComponent.DurationScrollerComponent({key:"dayScroller",durationComponent:DurationScrollerItem.DURATION_COMPONENT_DAY,duration:duration,popupPadItems:padItems,setDuration:this.setDuration,localizedStrings:localizedStrings,isPhone:isPhone,dimensions:this.dimensions,reactClientContext:clientContext}),hourScrollerComponent=DurationScrollerComponent.DurationScrollerComponent({key:"hourScroller",durationComponent:DurationScrollerItem.DURATION_COMPONENT_HOUR,duration:duration,popupPadItems:padItems,setDuration:this.setDuration,localizedStrings:localizedStrings,isPhone:isPhone,dimensions:this.dimensions,reactClientContext:clientContext}),minuteScrollerComponent=DurationScrollerComponent.DurationScrollerComponent({key:"minuteScroller",durationComponent:DurationScrollerItem.DURATION_COMPONENT_MINUTE,duration:duration,popupPadItems:padItems,setDuration:this.setDuration,localizedStrings:localizedStrings,isPhone:isPhone,dimensions:this.dimensions,reactClientContext:clientContext}),scrollerChildren=[dayScrollerComponent,hourScrollerComponent,minuteScrollerComponent],scroller=React.DOM.div({key:"durationScroller",className:"scroller"},scrollerChildren);children.push(scroller);return children};DurationScrollerSpec.prototype.renderInlineControl=function(){var children=[];children.push(this.getLabel());children=this.getCommonComponents(children);var button=ImageButton.ImageButton({label:this.props.dataContext.get_ClearFieldText(),className:"scroller_button",ref:"clearButton",key:"clearButton",onClick:this.handleClear,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex()-1:null,onKeyDown:this.handleKeyDown});children.push(button);return React.DOM.div({className:"scroller",title:this.props.dataContext.get_Label()},children)};DurationScrollerSpec.prototype.renderPopoverControl=function(){var innerChildren=this.getCommonComponents([]),container=React.DOM.div({className:"scrollerContainer",key:"container"},innerChildren),okButton=ImageButton.ImageButton({key:"okButton",label:this.props.dataContext.get_OkText(),imageType:"Symbol",imageName:"Accept",onClick:this.handleOk}),cancelButton=ImageButton.ImageButton({key:"cancelButton",label:this.props.dataContext.get_CancelText(),imageType:"Symbol",imageName:"Cancel",onClick:this.handleCancel}),clearButton=ImageButton.ImageButton({key:"clearButton",label:this.props.dataContext.get_ClearFieldText(),imageType:"Symbol",imageName:"Clear",onClick:this.handleClear}),buttons=[okButton,cancelButton,clearButton],buttonContainer=React.DOM.div({key:"buttonContainer",className:"scroller-buttonContainer appBarSection"},buttons),controlBar=React.DOM.div({key:"controlBar",className:"scroller-controlBar appBar"},buttonContainer),popOver=React.DOM.div({className:"scroller-popOver",id:"scroller-popOver",style:{zIndex:ZIndexFinder()},onClick:this.props.clientContext.isUsingPointerUp?null:this.interceptEvent,onPointerUp:this.props.clientContext.isUsingPointerUp?this.interceptEvent:null},[this.getLabel(),container,controlBar]),host=AncestorMountedHost.AncestorMountedHost({selectorString:"body"},popOver);return host};DurationScrollerSpec.prototype.interceptEvent=function(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation()};DurationScrollerSpec.prototype.componentWillMount=function(){if(this.props.clientContext.isPhone)this.dimensions=this.generateScrollerDimensions();this.props.clientContext.reactBackHandlerHelper.addHandler(this.handleCancel)};DurationScrollerSpec.prototype.componentWillUnmount=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel)};DurationScrollerSpec.prototype.render=function(){var isPhone=this.props.clientContext.isPhone;if(isPhone&&!this.tempDurSet){this.tempDuration=this.getDuration();this.tempDurSet=true}this.props.dataContext.setDurationIfNull();if(isPhone)return this.renderPopoverControl();else return this.renderInlineControl()};return DurationScrollerSpec}(TsAdapter.SpecBase);exports.DurationScroller=DataWrapperComponent.wrapComponent(new DurationScrollerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/RealInput",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Common/Input"],function(require,exports,TsAdapter,PureUpdate,Input){exports.DESCRIPTOR_NAME1="Money";exports.DESCRIPTOR_NAME2="Real";exports.DESCRIPTOR_NAME3="Decimal";var RealInputSpec=function(_super){__extends(RealInputSpec,_super);function RealInputSpec(){_super.apply(this,arguments);this.displayName="RealInput";this.mixins=[PureUpdate.Mixin]}RealInputSpec.prototype.render=function(){return Input.Input({clientContext:this.props.clientContext,descriptor:this.props.descriptor,dataContext:this.props.dataContext,className:this.props.className,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null})};return RealInputSpec}(TsAdapter.SpecBase);exports.RealInput=TsAdapter.createComponent(new RealInputSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/IntegerInput",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Common/Input"],function(require,exports,TsAdapter,PureUpdate,Input){exports.DESCRIPTOR_NAME="Integer";var IntegerInputSpec=function(_super){__extends(IntegerInputSpec,_super);function IntegerInputSpec(){_super.apply(this,arguments);this.displayName="IntegerInput";this.mixins=[PureUpdate.Mixin]}IntegerInputSpec.prototype.render=function(){return Input.Input({clientContext:this.props.clientContext,descriptor:this.props.descriptor,dataContext:this.props.dataContext,className:this.props.className,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null})};return IntegerInputSpec}(TsAdapter.SpecBase);exports.IntegerInput=TsAdapter.createComponent(new IntegerInputSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/LookupList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lists/List"],function(require,exports,TsAdapter,DataWrapperComponent,List){var LookupListSpec=function(_super){__extends(LookupListSpec,_super);function LookupListSpec(){_super.apply(this,arguments);this.displayName="LookupList";this.listenToProperties=["NewItemDescriptorAndModel","HideLookupResultsList","HasMoreRecords"]}LookupListSpec.prototype.renderMoreRecordMessage=function(){if(this.props.clientContext.isPhone&&this.props.dataContext.get_HasMoreRecords())return React.DOM.span({key:"moreRecordsMessage",className:"lookupListComponentView_moreRecordsText"},this.props.dataContext.get_MoreRecordsText())};LookupListSpec.prototype.render=function(){var children=[];this.props.clientContext.isMailApp&&children.push(React.DOM.span({key:"searchResultsHeader",className:"searchResultsHeader"},this.props.dataContext.get_SearchResultsText()));!(this.props.clientContext.isPhone&&this.props.dataContext.get_HideLookupResultsList())&&children.push(List.List({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,listItemDescriptor:this.props.dataContext.get_ListItemViewDescriptor(),afterContentRenderer:this.renderMoreRecordMessage}));return React.DOM.div({className:"listRoot",style:this.props.style},children)};return LookupListSpec}(TsAdapter.SpecBase);exports.LookupList=DataWrapperComponent.wrapComponent(new LookupListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/LookupBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/AncestorMountedHost","Components/Lookup/LookupList","Utils/ZIndexFinder","Core/Binding/WindowResizeHandlerMixin","Components/Primitives/Button","Utils/CssClassSet","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,AncestorMountedHost,LookupList,ZIndexFinder,WindowResizeHandler,Button,CssClassSet,FontIcon){var LookupBarSpec=function(_super){__extends(LookupBarSpec,_super);function LookupBarSpec(){_super.apply(this,arguments);this.displayName="LookupBar";this.mixins=[WindowResizeHandler.Mixin];this.listenToProperties=["LookupListViewModel","LookupNewButtonViewModel","ActionCommand","ActionCommandCanExecute"]}LookupBarSpec.prototype.getDefaultProps=function(){return {isGlobalLookupComponent:false}};LookupBarSpec.prototype.handleNewButtonClick=function(){if(this.props.dataContext){var buttonViewModel=this.props.dataContext.get_LookupNewButtonViewModel();if(buttonViewModel){var action=buttonViewModel.get_ActionCommand();action&&action.get_CanExecute()&&action.execute()}}this.props.onDismiss&&this.props.onDismiss()};LookupBarSpec.prototype.interceptEvent=function(e){this.props.clientContext.userAgent.get_IsIOS()&&e.preventDefault();e.stopPropagation();e.nativeEvent.stopImmediatePropagation()};LookupBarSpec.prototype.componentDidMount=function(){var domNode=$(this.refs["bar"]);domNode.data("IsPopup",true);domNode.data("IsModal",true);if(!this.props.clientContext.isPhone&&!this.props.isGlobalLookupComponent){this.props.clientContext.device.get_DeviceState().AddPropertyChangedListener("KeyboardHeight",this.positionLookupBar);this.props.clientContext.device.get_DeviceState().AddPropertyChangedListener("ExternalWindowScrollAmount",this.positionLookupBar);this.props.clientContext.userAgent.get_IsAndroid()&&window.addEventListener("scroll",this.positionLookupBar)}};LookupBarSpec.prototype.componentWillUnmount=function(){this.props.clientContext.device.get_DeviceState().RemovePropertyChangedListener("KeyboardHeight",this.positionLookupBar);this.props.clientContext.device.get_DeviceState().RemovePropertyChangedListener("ExternalWindowScrollAmount",this.positionLookupBar);window.removeEventListener("scroll",this.positionLookupBar)};LookupBarSpec.prototype.handleWindowResize=function(){!this.props.clientContext.isPhone&&!this.props.isGlobalLookupComponent&&this.props.clientContext.userAgent.get_IsAndroid()&&this.positionLookupBar()};LookupBarSpec.prototype.positionLookupBar=function(){var _this=this;this.internalPositionLookupBar();var initialPageYOffset=window.pageYOffset;window.setTimeout(function(){initialPageYOffset!==window.pageYOffset&&_this.internalPositionLookupBar()},50)};LookupBarSpec.prototype.internalPositionLookupBar=function(){if(!this.isMounted())return;var externalWindowScrollAmount=this.props.clientContext.device.get_IsAvailable()?this.props.clientContext.device.get_DeviceState().get_ExternalWindowScrollAmount():0,keyboardHeight=this.props.clientContext.get_KeyboardHeight();if(this.props.clientContext.userAgent.get_IsWindows81())keyboardHeight=Math.ceil(keyboardHeight);var bottomPx=keyboardHeight-window.pageYOffset-externalWindowScrollAmount;this.refs["bar"].style.bottom=(bottomPx<0?0:bottomPx)+"px"};LookupBarSpec.prototype.renderMailAppNewButton=function(tabIndex){var tooltipResourceId=this.props.descriptor.Properties["CloseButtonToolTipResourceId"],text=[FontIcon.FontIcon({symbolName:"New"}),React.DOM.span({},this.props.dataContext.get_NewButtonText())];return Button.Button({className:"lookupNewButton",id:"lookupBarNewButton",role:"button",key:"newButton",onClick:this.handleNewButtonClick,dataId:"newButton",dataContext:this.props.dataContext.get_LookupNewButtonViewModel(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?tabIndex:null},text)};LookupBarSpec.prototype.renderDefaultNewButton=function(tabIndex){return Button.Button({className:"button dynamicsButton",role:"button",key:"newButton",onClick:this.handleNewButtonClick,dataContext:this.props.dataContext.get_LookupNewButtonViewModel(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?tabIndex:null},React.DOM.div({className:"button-container"},React.DOM.span({},this.props.dataContext.get_NewButtonText())))};LookupBarSpec.prototype.render=function(){var children=[],isPhone=this.props.clientContext.isPhone,isMailApp=this.props.clientContext.isMailApp,lookupListViewModel=this.props.dataContext.get_LookupListViewModel(),lookupList=LookupList.LookupList({key:"LookupList",clientContext:this.props.clientContext,dataContext:lookupListViewModel,descriptor:this.props.descriptor});!isMailApp&&children.push(lookupList);if(this.props.dataContext.get_LookupNewButtonViewModel().get_Visible()&&!this.props.isGlobalLookupComponent)if(!isPhone){var newButtonTabIndex=lookupListViewModel?lookupListViewModel.get_NextTabIndex():-1,newButton;if(isMailApp)newButton=this.renderMailAppNewButton(newButtonTabIndex);else newButton=this.renderDefaultNewButton(newButtonTabIndex);children.push(newButton)}isMailApp&&children.push(lookupList);var lookupBar=React.DOM.div({ref:"bar","data-is-popup":"true",className:this.props.isGlobalLookupComponent?"globalLookup-bar":"lookup-bar","data-id":"lookupBarContainer",style:{zIndex:this.props.isGlobalLookupComponent?0:ZIndexFinder(),display:!isPhone&&!this.props.showLookupBar&&!isMailApp?"none":null},onClick:this.props.clientContext.userAgent.get_IsIOS()?null:this.interceptEvent,onPointerUp:this.props.clientContext.userAgent.get_IsIOS()?this.interceptEvent:null},children);if(!isPhone&&!isMailApp&&!this.props.isGlobalLookupComponent)return AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"lookupContainer",className:CssClassSet({lookupBarContainer:true,androidLookup:this.props.clientContext.userAgent.get_IsAndroid(),ios8_4_1:this.props.clientContext.userAgent.get_IsIOS841()})},lookupBar);else return lookupBar};return LookupBarSpec}(TsAdapter.SpecBase);exports.LookupBar=DataWrapperComponent.wrapComponent(new LookupBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PhoneLookupAppBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Components/Primitives/ImageButton","Core/Binding/WindowResizeHandlerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ImageButton,WindowResizeHandler){var PhoneLookupAppBarSpec=function(_super){__extends(PhoneLookupAppBarSpec,_super);function PhoneLookupAppBarSpec(){_super.apply(this,arguments);this.displayName="PhoneLookupAppBar";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["LookupModelName"];this.tempDataName=null;this.tempData=null;this.tempDataSet=false}PhoneLookupAppBarSpec.prototype.configureEventListeners=function(){return {OfflineMode:this.handleCancel}};PhoneLookupAppBarSpec.prototype.handleOk=function(){if(this.props.onDismiss)this.props.onDismiss();else this.props.dataContext.get_CloseCommand()&&this.props.dataContext.get_PrimaryModelName()!=="connection"&&this.props.dataContext.get_CloseCommand().execute();this.props.onOkClick&&this.props.onOkClick();this.props.dataContext.set_HasFocus(false);this.tempData=null;this.tempDataSet=false};PhoneLookupAppBarSpec.prototype.handleNewButtonClick=function(){if(this.props.dataContext){var buttonViewModel=this.props.dataContext.get_LookupBarViewModel().get_LookupNewButtonViewModel();if(buttonViewModel){var action=buttonViewModel.get_ActionCommand();action&&action.get_CanExecute()&&action.execute()}}};PhoneLookupAppBarSpec.prototype.handleCancel=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel);if(this.props.onDismiss)this.props.onDismiss();else this.props.dataContext.get_CloseCommand()&&this.props.dataContext.get_PrimaryModelName()!=="connection"&&this.props.dataContext.get_CloseCommand().execute();if(this.props.onCancelClick)this.props.onCancelClick();else!this.tempData&&this.props.dataContext.get_ClearValueCommand()&&this.props.dataContext.get_ClearValueCommand().execute();this.tempData&&this.props.dataContext.set_Data(this.tempData);this.props.dataContext.updateInputValue();var lookupBarViewModel=this.props.dataContext.get_LookupBarViewModel();if(lookupBarViewModel){lookupBarViewModel.get_LookupListViewModel().set_HasNewPreSearchHandler(true);lookupBarViewModel.get_LookupListViewModel().set_SearchValue(this.tempDataName)}this.props.dataContext.set_HasFocus(false);this.tempData=null;this.tempDataSet=false};PhoneLookupAppBarSpec.prototype.handleClear=function(){this.props.onDismiss&&this.props.onDismiss();this.tempData=null;this.tempDataSet=false;this.tempDataName="";this.props.dataContext.get_ClearValueCommand().execute();var lookupBarViewModel=this.props.dataContext.get_LookupBarViewModel();if(lookupBarViewModel){lookupBarViewModel.get_LookupListViewModel().set_HasNewPreSearchHandler(true);lookupBarViewModel.get_LookupListViewModel().set_SearchValue(this.tempDataName)}};PhoneLookupAppBarSpec.prototype.generateScrollerDimensions=function(){var screenWidth=WindowResizeHandler.getWindowWidth(),itemMargin=Math.floor(1/48*screenWidth),itemBorder=Math.floor(1/240*screenWidth),itemWidth=Math.floor(1/4*screenWidth-2*itemBorder),componentHeight=Math.floor(itemWidth+2*itemBorder+itemMargin);return {itemMargin:itemMargin,itemBorder:itemBorder,itemWidth:itemWidth,componentHeight:componentHeight,smallText:screenWidth*(1/32),largeText:screenWidth*(7/80)}};PhoneLookupAppBarSpec.prototype.interceptClick=function(e){e.stopPropagation()};PhoneLookupAppBarSpec.prototype.componentWillMount=function(){if(this.props.clientContext.isPhone)this.dimensions=this.generateScrollerDimensions();this.props.clientContext.reactBackHandlerHelper.addHandler(this.handleCancel)};PhoneLookupAppBarSpec.prototype.componentDidMount=function(){this.tempDataName=this.props.dataContext.get_CurrentDataName()};PhoneLookupAppBarSpec.prototype.componentWillUnmount=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.handleCancel)};PhoneLookupAppBarSpec.prototype.renderPopoverControl=function(){var buttons=[];if(this.props.dataContext.get_ShowOkButtonInPhone()){var okButton=ImageButton.ImageButton({key:"okButton",label:this.props.clientContext.getLocalizedString("L_OK_Text"),imageType:"Symbol",imageName:"Accept",reactClientContext:this.props.clientContext,onClick:this.handleOk,className:"popOverOkButton"});buttons.push(okButton)}var cancelButton=ImageButton.ImageButton({key:"cancelButton",label:this.props.clientContext.getLocalizedString("L_Cancel_Text"),imageType:"Symbol",imageName:"Cancel",reactClientContext:this.props.clientContext,onClick:this.handleCancel,className:"popOverCancelButton"});buttons.push(cancelButton);if(this.props.dataContext.get_LookupBarViewModel().get_LookupNewButtonViewModel().get_Visible()){var newButton=ImageButton.ImageButton({key:"newButton",label:this.props.dataContext.get_LookupBarViewModel().get_NewButtonText(),imageType:"Symbol",imageName:"Add",reactClientContext:this.props.clientContext,onClick:this.handleNewButtonClick,className:"popOverAddButton"});buttons.push(newButton)}if(!this.props.dataContext.get_IsGlobalLookup())if(this.props.dataContext.get_ShowClearButtonInPhone()){var clearButton=ImageButton.ImageButton({key:"clearButton",label:this.props.clientContext.getLocalizedString("L_Clear_Field_Text"),imageType:"Symbol",imageName:"Clear",reactClientContext:this.props.clientContext,onClick:this.handleClear});buttons.push(clearButton)}var buttonContainer=React.DOM.div({key:"buttonContainer",className:"scroller-buttonContainer appBarSection"},buttons),controlBar=React.DOM.div({key:"controlBar",className:"scroller-controlBar appBar"},buttonContainer);return React.DOM.div({id:"lookup-appBar",className:"lookup-appBar",onClick:this.interceptClick},[controlBar])};PhoneLookupAppBarSpec.prototype.render=function(){if(this.props.clientContext.isPhone&&!this.tempDataSet){this.tempData=this.props.dataContext.get_Data();this.tempDataSet=true}return this.renderPopoverControl()};return PhoneLookupAppBarSpec}(TsAdapter.SpecBase);exports.PhoneLookupAppBar=DataWrapperComponent.wrapComponent(new PhoneLookupAppBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PhoneLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/AncestorMountedHost","Components/Lookup/PhoneLookupAppBar","Components/Primitives/Button","Components/Primitives/FontIcon","Utils/ZIndexFinder","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,AncestorMountedHost,PhoneLookupAppBar,Button,FontIcon,ZIndexFinder,CssClassSet){var PhoneLookupSpec=function(_super){__extends(PhoneLookupSpec,_super);function PhoneLookupSpec(){_super.apply(this,arguments);this.displayName="PhoneLookup";this.listenToProperties=["LookupDisplayName"]}PhoneLookupSpec.prototype.interceptEvent=function(e){e.stopPropagation();e.nativeEvent.stopImmediatePropagation()};PhoneLookupSpec.prototype.componentDidMount=function(){var popOver=this.refs["lookup-popOver"];if(popOver instanceof Element){var lookupPopOver=$(popOver);lookupPopOver.data("IsPopup",true);lookupPopOver.data("IsModal",true)}};PhoneLookupSpec.prototype.renderBackButton=function(tabIndex){var backBtnText=this.props.clientContext.getLocalizedString("L_Back_Button_Text"),text=[FontIcon.FontIcon({symbolName:"BackButton"}),React.DOM.span({title:backBtnText},backBtnText)],button=Button.Button({key:"button",className:"backBtn",onClick:this.props.onDismiss,title:backBtnText,dataId:"backImage",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?tabIndex++:null},text);return button};PhoneLookupSpec.prototype.render=function(){var children=[],phoneLookupAppBar=null;if(this.props.clientContext.isMailApp)children.push(this.renderBackButton(0));else{var isConnectionList=this.props.dataContext&&this.props.dataContext.get_PrimaryModelName()==="connection",isEntityNameEnabled=!this.props.label||isConnectionList;if(this.props.dataContext&&this.props.dataContext.get_LookupDisplayName()&&isEntityNameEnabled){var labelEntityName=React.DOM.span({key:"lookupEntityName",className:"label lookupFieldName"},this.props.dataContext.get_LookupDisplayName());children.push(labelEntityName)}else if(this.props.label){var labelFieldName=React.DOM.span({key:"lookupFieldName",className:"label lookupFieldName"},this.props.label);children.push(labelFieldName)}phoneLookupAppBar=PhoneLookupAppBar.PhoneLookupAppBar({key:"phoneLookupAppBar",clientContext:this.props.clientContext,dataContext:this.props.dataContext,onDismiss:this.props.onDismiss,showLabel:this.props.showLabel,onOkClick:this.props.onOkClick,onCancelClick:this.props.onCancelClick})}React.Children.forEach(this.props.children,function(child){children.push(child)});var childContainer=React.DOM.div({className:"lookupChildContainer",key:"lookupChildContainer"},children),popOver=React.DOM.div({className:CssClassSet({"lookup-popOver":true},this.props.className),"data-is-popup":"true",ref:"lookup-popOver",id:"phoneLookupPopup",style:{zIndex:ZIndexFinder()},onClick:this.props.clientContext.isUsingPointerUp?null:this.interceptEvent,onPointerUp:this.props.clientContext.isUsingPointerUp?this.interceptEvent:null},[childContainer,phoneLookupAppBar]),host=AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"lookupContainer",className:CssClassSet({androidLookup:this.props.clientContext.userAgent.get_IsAndroid(),ios8_4_1:this.props.clientContext.userAgent.get_IsIOS841(),mailAppLookUpContainer:this.props.clientContext.isMailApp})},popOver);return host};return PhoneLookupSpec}(TsAdapter.SpecBase);exports.PhoneLookup=DataWrapperComponent.wrapComponent(new PhoneLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/Lookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Input","Components/Lookup/LookupBar","Components/Lookup/PhoneLookup","Components/Lookup/PhoneLookupAppBar"],function(require,exports,TsAdapter,DataWrapperComponent,Input,LookupBar,PhoneLookup,PhoneLookupAppBar){exports.DESCRIPTOR_NAME="Lookup";var LookupSpec=function(_super){__extends(LookupSpec,_super);function LookupSpec(){_super.apply(this,arguments);this.displayName="Lookup";this.isPhoneOrMailApp_value=undefined;this.listenToProperties=["HasFocus","Label","PrimaryModelName","Value","ShowLookupBar","LookupDisplayName"]}LookupSpec.prototype.isPhoneOrMailApp=function(){if(typeof this.isPhoneOrMailApp_value=="undefined")this.isPhoneOrMailApp_value=this.props.clientContext.isPhone||this.props.clientContext.isMailApp;return this.isPhoneOrMailApp_value};LookupSpec.prototype.getDefaultProps=function(){return {dismissOnLoseFocus:true}};LookupSpec.prototype.getInitialState=function(){return {isInlineLookupOpened:false}};LookupSpec.prototype.componentWillMount=function(){this.props.dataContext.forceModelReload();this.props.dataContext.buildChildViewModelDescriptors(this.props.descriptor);this.props.dataContext.set_HasFocus(true);this.activeElementBeforeOpening=document.activeElement};LookupSpec.prototype.componentWillUnmount=function(){this.props.dataContext.set_HasFocus(false);this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};LookupSpec.prototype.componentDidUpdate=function(prevProps){if(!this.props.dataContext.get_HasFocus()&&this.props.dismissOnLoseFocus&&this.props.onDismiss){this.props.onDismiss();this.props.dataContext.set_HasFocus(false)}if(this.isPhoneOrMailApp())this.state.isInlineLookupOpened&&this.setState({isInlineLookupOpened:false})};LookupSpec.prototype.componentDidMount=function(){if(this.props.clientContext.userAgent.get_IsMobilePhone()&&this.props.dataContext.get_IsInlineOrAssociateFormLookup())$(".popOverCancelButton").focus();else(!this.props.clientContext.userAgent.get_IsIPad()||!this.props.dataContext.get_IsInlineOrAssociateFormLookup()&&!this.props.dataContext.get_IsGlobalLookup())&&this.props.clientContext.focusField($(ReactDOM.findDOMNode(this.refs["LookupInput"])))};LookupSpec.prototype.onShortPress=function(e){this.setState({isInlineLookupOpened:true});this.props.dataContext.set_HasFocus(true)};LookupSpec.prototype.renderInlineLookup=function(){var labelFieldName=React.DOM.span({key:"connectionLookupField",className:"label lookupFieldName"},this.props.dataContext.get_Label()),labelValue=React.DOM.span({key:"connectionLookupValue",className:"field lookupFieldName"},this.props.dataContext.get_LookupInputViewModel().get_Value());return React.DOM.div({key:"inlineCreateLookup",onShortPress:this.isPhoneOrMailApp()?this.onShortPress:null},[labelFieldName,labelValue])};LookupSpec.prototype.onLookupBarDismiss=function(){this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME&&!this.props.onDismiss&&this.props.dataContext.set_ShowLookupBar(false)};LookupSpec.prototype.onFocus=function(){this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME&&!this.props.onDismiss&&this.props.dataContext.set_ShowLookupBar(true)};LookupSpec.prototype.onTextValueChanged=function(){this.props.dataContext.get_HasFocus()!=true&&this.props.dataContext.set_HasFocus(true)};LookupSpec.prototype.onKeyDownHandler=function(e){if(e.key==="Escape"){this.setState({isInlineLookupOpened:false});this.props.dataContext.set_HasFocus(false)}};LookupSpec.prototype.getLookupType=function(){return this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME?"singleLookup":null};LookupSpec.prototype.render=function(){var isGlobalLookup=this.props.dataContext.get_IsGlobalLookup(),inputBox=Input.Input({key:"Lookup",ref:"LookupInput",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_LookupInputViewModel(),descriptor:this.props.dataContext.get_LookupInputDescriptor(),inputType:5,updateOnChange:true,onChangeEvent:this.onTextValueChanged,id:this.isPhoneOrMailApp()&&this.getLookupType(),onFocus:this.isPhoneOrMailApp()?null:this.onFocus}),lookupBar=LookupBar.LookupBar({className:"lookup-bar",key:"lookup-bar",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_LookupBarViewModel(),descriptor:this.props.dataContext.get_LookupBarDescriptor(),onDismiss:this.props.onDismiss||this.onLookupBarDismiss,showLookupBar:this.isPhoneOrMailApp()?null:this.props.dataContext.get_ShowLookupBar(),isGlobalLookupComponent:isGlobalLookup}),children=[];if(isGlobalLookup){var isConnectionList=this.props.dataContext&&this.props.dataContext.get_PrimaryModelName()==="connection",isEntityNameEnabled=!this.props.dataContext.get_Label()||isConnectionList;if(this.props.dataContext&&this.props.dataContext.get_LookupDisplayName()){var labelEntityName=React.DOM.span({key:"lookupEntityName",className:"label lookupFieldName"},this.props.dataContext.get_LookupDisplayName());children.push(labelEntityName)}var phoneLookupAppBar=PhoneLookupAppBar.PhoneLookupAppBar({key:"phoneLookupAppBar",clientContext:this.props.clientContext,dataContext:this.props.dataContext,onDismiss:this.props.onDismiss,showLabel:this.props.showLabel});children.push(inputBox,lookupBar,phoneLookupAppBar)}else if(this.props.clientContext.isMailApp){children.push(inputBox);React.Children.forEach(this.props.children,function(child){children.push(child)});children.push(lookupBar)}else children.push(inputBox,lookupBar);if(!this.props.dataContext.get_HasFocus()&&this.props.dismissOnLoseFocus&&!this.state.isInlineLookupOpened&&this.props.dataContext.get_PrimaryModelName())if(this.isPhoneOrMailApp()&&this.props.dataContext.get_PrimaryModelName()==="connection")return React.DOM.div({className:"lookup"},this.renderInlineLookup());else return React.DOM.div({className:"lookup",onKeyDown:this.onKeyDownHandler},[inputBox]);else if(this.isPhoneOrMailApp()&&this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME)return PhoneLookup.PhoneLookup({label:this.props.dataContext.get_Label(),dataContext:this.props.dataContext,clientContext:this.props.clientContext,onDismiss:this.props.onDismiss,showLabel:this.props.showLabel,descriptor:this.props.descriptor},children);else return React.DOM.div({className:"lookup",onKeyDown:this.onKeyDownHandler,id:this.getLookupType()},children)};return LookupSpec}(TsAdapter.SpecBase);exports.Lookup=DataWrapperComponent.wrapComponent(new LookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricLookupList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lists/List","Components/Primitives/Button","Components/Primitives/ImageButton","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,List,Button,ImageButton,Constants){var InteractionCentricLookupListSpec=function(_super){__extends(InteractionCentricLookupListSpec,_super);function InteractionCentricLookupListSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricLookupList";this.listenToProperties=["NewItemDescriptorAndModel","HideLookupResultsList","HasMoreRecords","RecordCount"];this.screenReaderPrevText=""}InteractionCentricLookupListSpec.prototype.renderMoreRecordMessage=function(){if(!this.props.dataContext.get_HideLookupMoreRecords()&&this.props.dataContext.get_IsInteractionCentricLookup()){var lookupMoreButton=Button.Button({className:"button InlineLookupButton InlineLookupFieldButton",role:"button",ref:"lookup-lookupMoreButton",key:"lookupMoreButton",onClick:this.openLookupMoreRecordsDialog,tabIndex:this.props.tabIndex,onKeyDown:this.handleMoreButtonEscape,ariaLabel:this.props.clientContext.getLocalizedString("InlineEditControls.InlineLookup.ShowMore")},React.DOM.div({key:"more-button-container",className:"button-container"},React.DOM.span({key:"more-button-label",className:"label button-label enabled"},this.props.clientContext.getLocalizedString("InlineEditControls.InlineLookup.ShowMore"))));return React.DOM.div({key:"lookup-anchor-more",className:"InlineLookup-FooterSection-MoreResults",ref:"lookup-anchor-more"},lookupMoreButton)}};InteractionCentricLookupListSpec.prototype.handleNavForLookup=function(e){var item=e.currentTarget;if(e.key==Constants.TAB_KEY){e.preventDefault();if(!e.shiftKey){var moreResultDiv=$(".InlineLookup-FooterSection-MoreResults")[0];if(moreResultDiv!=null){var lookupMoreButton=$(moreResultDiv).children(".InlineLookupFieldButton")[0];lookupMoreButton!=null&&$(lookupMoreButton).focus()}}else{var listItemWrapper=$(".listRoot").find(".listItemWrapper")[0];if(listItemWrapper!=null){var listItem=$(listItemWrapper).find(".listItem")[0];listItem!=null&&$(listItem).focus()}}}};InteractionCentricLookupListSpec.prototype.handleKeyDownAddNew=function(e){switch(e.key){case Constants.TAB_KEY:if(!e.shiftKey){var firstPartyListItem=$(".partyListItem")[0];if(firstPartyListItem==null){var domNode=ReactDOM.findDOMNode(this);if(domNode!=null){var parent=$(domNode).parents(".InlineLookupPopup");if(parent!=null&&parent.length>0){var focusableItem=$(domNode).parents(".InlineLookupPopup").find("[tabindex]:first");if(focusableItem!=null&&focusableItem.length>0){focusableItem.focus();e.preventDefault()}}}}else{var firstPartyListItemLabelToFocus=$(firstPartyListItem).children(".partyListItem_label")[0];firstPartyListItemLabelToFocus!=null&&$(firstPartyListItemLabelToFocus).focus();e.preventDefault()}}break;case Constants.ENTER_KEY:this.handleNewButtonClick();e.stopPropagation();break;case Constants.ESCAPE_KEY:if(this.props.onKeyDown){this.props.onKeyDown(e);e.preventDefault();e.stopPropagation()}break}};InteractionCentricLookupListSpec.prototype.handleMoreButtonEscape=function(e){switch(e.key){case Constants.ESCAPE_KEY:if(this.props.onKeyDown){this.props.onKeyDown(e);e.preventDefault();e.stopPropagation()}break;case Constants.ENTER_KEY:this.openLookupMoreRecordsDialog();break;case Constants.TAB_KEY:if(!e.shiftKey)if(this.props.dataContext.get_ParentLookupViewModel().get_LookupNewButtonViewModel().get_Visible()===true&&this.props.dataContext.ShowNewButtonOnlyIfInteractionCentricEnabled()===true){var domNode=ReactDOM.findDOMNode(this);if(domNode!=null){var parent=$(domNode).parents(".InlineLookupPopup");if(parent!=null&&parent.length>0){var focusableItem=$(domNode).parents(".InlineLookupPopup").find('[data-id="AddNew"]');if(focusableItem!=null&&focusableItem.length>0){focusableItem.focus();e.preventDefault()}}}}else{var domNode=ReactDOM.findDOMNode(this);if(domNode!=null){var parent=$(domNode).parents(".InlineLookupPopup");if(parent!=null&&parent.length>0){var focusableItem=$(domNode).parents(".InlineLookupPopup").find("[tabindex]:first");if(focusableItem!=null&&focusableItem.length>0){focusableItem.focus();e.preventDefault()}}}}break}};InteractionCentricLookupListSpec.prototype.openLookupMoreRecordsDialog=function(){this.props.onDismiss&&this.props.onDismiss(true);this.props.dataContext.openLookupDialog()};InteractionCentricLookupListSpec.prototype.renderFooter=function(){var footer=[],recordCount=React.DOM.div({key:"lookup-more",className:"InlineLookup-FooterSection-TopResults",ref:"lookup-more","aria-hidden":true},React.DOM.span({},this.props.dataContext.get_RecordsCountText()));footer.push(recordCount);if(this.props.dataContext.get_ParentLookupViewModel().get_LookupNewButtonViewModel().get_Visible()===true&&this.props.dataContext.ShowNewButtonOnlyIfInteractionCentricEnabled()===true){var plusButton=ImageButton.ImageButton({key:"add",imageType:"Symbol",imageName:"Add",dataId:"AddNew",tabIndex:this.props.tabIndex,ariaLabel:this.props.dataContext.get_ParentLookupViewModel().get_NewButtonText(),onKeyDown:this.handleKeyDownAddNew}),newButtonLabel=React.DOM.span({key:"InlinelookupNew-label",className:"InlinelookupNew","aria-hidden":"true"},this.props.dataContext.get_ParentLookupViewModel().get_NewButtonText()),newButton=Button.Button({className:"button dynamicsButton",role:"button",ref:"lookup-newButton",key:"newButton",onClick:this.handleNewButtonClick,dataContext:this.props.dataContext.get_ParentLookupViewModel().get_LookupNewButtonViewModel()},[plusButton,newButtonLabel]),newButtonDiv=React.DOM.div({className:"InlineLookup-FooterSection-AddNew"},newButton);footer.push(newButtonDiv)}return React.DOM.div({key:"InlineLookup-Footer",className:"InlineLookup-Footer"},footer)};InteractionCentricLookupListSpec.prototype.handleNewButtonClick=function(){if(this.props.dataContext){var buttonViewModel=this.props.dataContext.get_ParentLookupViewModel().get_LookupNewButtonViewModel();if(buttonViewModel){var action=buttonViewModel.get_ActionCommand();action&&action.get_CanExecute()&&action.execute()}}this.props.onDismiss&&this.props.onDismiss()};InteractionCentricLookupListSpec.prototype.componentDidUpdate=function(prevProps){this.callOnUpdate();if($("#inlineLookupOnlyScreenReadableElementId").length==0){var screenReadableElement=$("<div>");screenReadableElement.attr("id","inlineLookupOnlyScreenReadableElementId");screenReadableElement.attr("class","onlyScreenReadableContent");screenReadableElement.attr("aria-live","assertive");screenReadableElement.attr("aria-atomic","true");$("#listRootId").append(screenReadableElement);this.screenReaderPrevText=""}var screenReaderCurrentText=this.props.dataContext.get_Items().get_Count()===0?this.props.clientContext.getLocalizedString("InteractionCentricLookupListCount_NoRecord_ScreenReaderLabel"):this.props.dataContext.screenReaderTextForInteractionCentricLookupList(this.props.dataContext.get_Items().get_Count());if(!this.props.dataContext.get_IsLoading()&&screenReaderCurrentText!=this.screenReaderPrevText){this.screenReaderPrevText=screenReaderCurrentText;var inlineLookupScreenReaderElement=document.getElementById("inlineLookupOnlyScreenReadableElementId");inlineLookupScreenReaderElement.innerHTML=screenReaderCurrentText}};InteractionCentricLookupListSpec.prototype.callOnUpdate=function(){if(!this.props.dataContext.get_Items())this.props.onUpdate(0);else this.props.onUpdate(this.props.dataContext.get_Items().get_Count());this.setHeight()};InteractionCentricLookupListSpec.prototype.setHeight=function(){var children=ReactDOM.findDOMNode(this).childNodes;if(children.length>0)children[0].style.height=this.props.height.toString()+"px"};InteractionCentricLookupListSpec.prototype.componentDidMount=function(){this.props.dataContext.SetPageSizeAndHideMoreRecords();this.callOnUpdate()};InteractionCentricLookupListSpec.prototype.render=function(){if(this.props.dataContext.get_HideLookupResultsList())return React.DOM.div({className:"listRoot",style:this.props.style});else{var children=[],list=List.List({key:"InlineLookup-NoRecords",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,listItemDescriptor:this.props.dataContext.get_ListItemViewDescriptor(),afterContentRenderer:this.renderMoreRecordMessage,tabIndex:this.props.tabIndex,noRecordsMessage:this.props.clientContext.getLocalizedString("InlineEditControls.InlineLookup.NoRecords"),onKeyDown:this.props.onKeyDown,handlerForLookup:this.handleNavForLookup,useExtraContentRenderersWithNoRecords:true,preRecordsMessage:this.props.dataContext.get_MoreThanOneMatchText()});children.push(list);children.push(this.renderFooter());return React.DOM.div({key:"listRoot",className:"listRoot",style:this.props.style,id:"listRootId"},children)}};return InteractionCentricLookupListSpec}(TsAdapter.SpecBase);exports.InteractionCentricLookupList=DataWrapperComponent.wrapComponent(new InteractionCentricLookupListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricInlineLookupList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/InteractionCentric/Lookup/InteractionCentricLookupList"],function(require,exports,TsAdapter,DataWrapperComponent,InteractionCentricLookupList){var InteractionCentricInlineLookupListSpec=function(_super){__extends(InteractionCentricInlineLookupListSpec,_super);function InteractionCentricInlineLookupListSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricInlineLookupList";this.listenToProperties=["LookupListViewModel","LookupNewButtonViewModel","ActionCommand","ActionCommandCanExecute","DimensionChanged","RecordCount"]}InteractionCentricInlineLookupListSpec.prototype.interceptClick=function(e){e.stopPropagation()};InteractionCentricInlineLookupListSpec.prototype.componentDidMount=function(){var list=this.refs["list"];list instanceof Element&&$(list).click(this.interceptClick)};InteractionCentricInlineLookupListSpec.prototype.componentWillUnmount=function(){var list=this.refs["list"];list instanceof Element&&$(list).unbind()};InteractionCentricInlineLookupListSpec.prototype.render=function(){var children=[];if(!this.props.showLookupBar)return React.DOM.noscript();else{var lookupList=InteractionCentricLookupList.InteractionCentricLookupList({key:"LookupList",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_InteractionCentricLookupListViewModel(),descriptor:this.props.descriptor,onDismiss:this.props.onDismiss,height:this.props.height,onUpdate:this.props.onUpdate,tabIndex:this.props.tabIndex,onKeyDown:this.props.onKeyDown});children.push(lookupList);var inlineLookupList=React.DOM.div({ref:"list",className:"InlineLookupList","data-id":"lookupListContainer","aria-label":" ",style:{top:this.props.displacementY}},children);return inlineLookupList}};return InteractionCentricInlineLookupListSpec}(TsAdapter.SpecBase);exports.InteractionCentricInlineLookupList=DataWrapperComponent.wrapComponent(new InteractionCentricInlineLookupListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PartyListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,Constants){var PartyListItemSpec=function(_super){__extends(PartyListItemSpec,_super);function PartyListItemSpec(){_super.apply(this,arguments);this.displayName="PartyListItem";this.listenToProperties=["Data"]}PartyListItemSpec.prototype.handleOpenItemCommand=function(e){if(this.props.dataContext&&!this.props.clientContext.isInteractionCentric){var command=this.props.dataContext.get_OpenItemCommand();command&&command.get_CanExecute()&&command.execute()}else switch(e.key){case Constants.ENTER_KEY:var command=this.props.dataContext.get_OpenItemCommand();command&&command.get_CanExecute()&&command.execute();break;case Constants.ESCAPE_KEY:this.focusTextBoxOfLookup();e.preventDefault();break}};PartyListItemSpec.prototype.handleDeleteItemCommand=function(){if(this.props.dataContext){var command=this.props.dataContext.get_DeleteItemCommand();command&&command.get_CanExecute()&&command.execute()}};PartyListItemSpec.prototype.handleKeyDownForDeleteButton=function(e){var currentItem=e.currentTarget;switch(e.key){case Constants.ENTER_KEY:var partyItemLength=$(".partyListItem").length;this.handleDeleteItemCommand();if(partyItemLength==1){this.focusTextBoxOfLookup();e.preventDefault()}else{var parent=$(currentItem).parents(".partyListItem")[0],nextSib=parent.nextSibling;if(nextSib==null){var prevSibling=parent.previousSibling;if(prevSibling!=null){var clearButtonToFocus=$(prevSibling).children(".partyListItem_delete")[0];clearButtonToFocus!=null&&$(clearButtonToFocus).focus()}}}break;case Constants.TAB_KEY:if(!e.shiftKey){var nextSib=$(currentItem).parents(".partyListItem")[0].nextSibling;if(nextSib==null){this.focusTextBoxOfLookup();e.preventDefault()}}break;case Constants.DOWN_ARROW_KEY:case Constants.UP_ARROW_KEY:e.preventDefault();var parent=$(currentItem).parents(".partyListItem")[0];if(parent!=null){var sibling=e.key==Constants.DOWN_ARROW_KEY?parent.nextSibling:parent.previousSibling;if(sibling!=null){var clearButtonToFocus=$(sibling).children(".partyListItem_delete")[0];clearButtonToFocus!=null&&$(clearButtonToFocus).focus()}else this.focusTextBoxOfLookup()}break;case Constants.ESCAPE_KEY:this.focusTextBoxOfLookup();e.preventDefault();break}};PartyListItemSpec.prototype.focusTextBoxOfLookup=function(){var inlineLookup=$(".InlineLookupSearch")[0];if(inlineLookup!=null){var textBoxContainer=$(inlineLookup).find(".textboxContainer")[0];if(textBoxContainer!=null){var textBox=$(textBoxContainer).children("input")[0];textBox!=null&&$(textBox).focus()}}};PartyListItemSpec.prototype.render=function(){var mailAppLabel;if(this.props.clientContext.isMailApp)mailAppLabel=React.DOM.div({className:"selectedItem-textContainer"},React.DOM.span({key:"type",className:"selectedItem-text selectedItem-text2"},this.props.dataContext.get_EntityDisplayName()+":"),React.DOM.span({key:"name",className:"selectedItem-text selectedItem-text1"},this.props.dataContext.get_Data()));var button=ImageButton.ImageButton({key:"open",label:this.props.clientContext.isMailApp?mailAppLabel:this.props.dataContext.get_Data(),title:this.props.dataContext.get_IsInteractionCentricEnabled()||this.props.clientContext.isMailApp?this.props.dataContext.get_Data():null,className:"partyListItem_label canNavigate",onClick:this.handleOpenItemCommand,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOpenItemCommand:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null}),imageButton=ImageButton.ImageButton({key:"delete",imageType:"Symbol",imageName:"Clear",className:"partyListItem_delete",onClick:this.handleDeleteItemCommand,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleKeyDownForDeleteButton:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null});return React.DOM.div({className:"partyListItem"},[button,imageButton])};return PartyListItemSpec}(TsAdapter.SpecBase);exports.PartyListItem=DataWrapperComponent.wrapComponent(new PartyListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricPartyList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lookup/PartyListItem"],function(require,exports,TsAdapter,DataWrapperComponent,PartyListItem){var InteractionCentricPartyListSpec=function(_super){__extends(InteractionCentricPartyListSpec,_super);function InteractionCentricPartyListSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricPartyList";this.listenToProperties=["HidePartyList"];this.listenToCollections=["ItemViewModels"]}InteractionCentricPartyListSpec.prototype.componentDidUpdate=function(prevProps){this.props.onUpdate&&this.props.onUpdate(-1)};InteractionCentricPartyListSpec.prototype.renderRecords=function(){for(var itemsCollection=this.props.dataContext.get_ItemViewModels(),itemsCount=itemsCollection.get_Count(),results=[],i=0;i<itemsCount;i++){var item=itemsCollection.getItem(i);results.push(PartyListItem.PartyListItem({key:"partyListItem"+i,clientContext:this.props.clientContext,dataContext:item,parentList:this.props.dataContext,tabIndex:this.props.tabIndex}))}return results};InteractionCentricPartyListSpec.prototype.render=function(){return React.DOM.div({className:"partyList"},this.renderRecords())};return InteractionCentricPartyListSpec}(TsAdapter.SpecBase);exports.InteractionCentricPartyList=DataWrapperComponent.wrapComponent(new InteractionCentricPartyListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Input","Components/InteractionCentric/Lookup/InteractionCentricInlineLookupList","Components/Primitives/FontIcon","Components/Primitives/Button","Components/Common/Constants","Components/Primitives/AncestorMountedHost","Core/Binding/WindowResizeHandlerMixin","Components/InteractionCentric/Lookup/InteractionCentricPartyList","Utils/ZIndexFinder","Components/Common/AccessibilityUtility"],function(require,exports,TsAdapter,DataWrapperComponent,Input,InteractionCentricInlineLookupList,FontIcon,Button,Constants,AncestorMountedHost,WindowResizeHandler,InteractionCentricPartyList,ZIndexFinder,AccessibilityUtility){exports.DESCRIPTOR_NAME="InteractionCentricLookup";var InteractionCentricLookupSpec=function(_super){__extends(InteractionCentricLookupSpec,_super);function InteractionCentricLookupSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricLookup";this.zIndex=1500;this.LIST_MAX_HEIGHT=250;this.SEARCH_HEIGHT=30;this.FOOTER_HEIGHT=40;this.PADDING=5;this.LOOKUP_LINE_ITEM_HEIGHT=114;this.LOOKUP_MISC_HEIGHT=73;this.PARTY_LIST_MAX_HEIGHT=100;this.POPUP_MIN_WIDTH=300;this.subGridLookupHeight=-1;this.mixins=[WindowResizeHandler.Mixin];this.listenToProperties=["HasFocus","Label","PrimaryModelName","Value","ShowLookupBar"]}InteractionCentricLookupSpec.prototype.getDefaultProps=function(){return {dismissOnLoseFocus:true}};InteractionCentricLookupSpec.prototype.getInitialState=function(){return {isInlineLookupOpened:false,inlineLookupListCount:0,lookupSearchBarWidth:0}};InteractionCentricLookupSpec.prototype.handleWindowResize=function(){this.calculateLookupListPosition(this.state.inlineLookupListCount)};InteractionCentricLookupSpec.prototype.interceptClick=function(e){e.stopPropagation()};InteractionCentricLookupSpec.prototype.calculateLookupListPosition=function(count){if(this.isMounted()!==true)return;if(count===-1)count=this.state.inlineLookupListCount;var lookupListBelow=true,screenWidth=WindowResizeHandler.getWindowWidth(),screenHeight=WindowResizeHandler.getWindowHeight(),newListTop=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().top,newListLeft=ReactDOM.findDOMNode(this).parentElement.getBoundingClientRect().left,popUpWidth=this.state.lookupSearchBarWidth<this.POPUP_MIN_WIDTH?this.POPUP_MIN_WIDTH:this.state.lookupSearchBarWidth,displacementX=screenWidth-(newListLeft+popUpWidth);if(displacementX<0)newListLeft=newListLeft+displacementX-this.PADDING;var inlineLookupListHeight=this.LIST_MAX_HEIGHT;if(this.subGridLookupHeight!=-1)inlineLookupListHeight=this.subGridLookupHeight;else if(count*this.LOOKUP_LINE_ITEM_HEIGHT+this.LOOKUP_MISC_HEIGHT<this.LIST_MAX_HEIGHT)inlineLookupListHeight=count*this.LOOKUP_LINE_ITEM_HEIGHT+this.LOOKUP_MISC_HEIGHT;var displacementY=screenHeight-(newListTop+inlineLookupListHeight+this.FOOTER_HEIGHT+this.SEARCH_HEIGHT);if(this.subGridLookupHeight==-1&&displacementY<0)if(newListTop>=inlineLookupListHeight+this.FOOTER_HEIGHT){displacementY=-1*(inlineLookupListHeight+this.FOOTER_HEIGHT+this.SEARCH_HEIGHT+1);lookupListBelow=false}else if(newListTop>screenHeight-(newListTop+this.SEARCH_HEIGHT)){displacementY=-1*(newListTop+this.SEARCH_HEIGHT-this.PADDING+1);inlineLookupListHeight=newListTop-this.FOOTER_HEIGHT-this.PADDING;lookupListBelow=false}else{displacementY=1;inlineLookupListHeight=screenHeight-(newListTop+this.SEARCH_HEIGHT+this.FOOTER_HEIGHT+this.PADDING)}else displacementY=1;var partyListScrollWrapper=this.refs["interactioncentricpartylistscrollable"];if(partyListScrollWrapper instanceof HTMLElement){if(this.props.dataContext.get_ShowLookupBar()!==true)lookupListBelow=false;if(this.props.dataContext.get_InteractionCentricPartyListViewModel().get_ItemViewModels().get_Count()>0){partyListScrollWrapper.style.visibility="visible";var maxHeight=10;if(lookupListBelow!==true){partyListScrollWrapper.style.top=(newListTop+this.SEARCH_HEIGHT+this.PADDING).toString()+"px";if(screenHeight-(newListTop+this.SEARCH_HEIGHT+this.PADDING)>0)maxHeight=screenHeight-(newListTop+this.SEARCH_HEIGHT+this.PADDING)}else{var partyListWrapper=ReactDOM.findDOMNode(this.refs["interactioncentricpartylist"]),partyListClientHeight=partyListWrapper.clientHeight;if(partyListClientHeight>this.PARTY_LIST_MAX_HEIGHT)partyListClientHeight=this.PARTY_LIST_MAX_HEIGHT;if(newListTop-(partyListClientHeight+this.PADDING)<=0){partyListScrollWrapper.style.top=this.PADDING.toString()+"px";maxHeight=newListTop-2*this.PADDING}else{partyListScrollWrapper.style.top=(newListTop-(partyListClientHeight+this.PADDING)).toString()+"px";maxHeight=partyListClientHeight+this.PADDING}}if(maxHeight>this.PARTY_LIST_MAX_HEIGHT)maxHeight=this.PARTY_LIST_MAX_HEIGHT;partyListScrollWrapper.style.maxHeight=maxHeight.toString()+"px";partyListScrollWrapper.style.left=newListLeft.toString()+"px";partyListScrollWrapper.style.zIndex=this.zIndex.toString()}else partyListScrollWrapper.style.visibility="hidden"}this.state.lookupTop!==newListTop&&this.setState({lookupTop:newListTop});this.state.lookupLeft!==newListLeft&&this.setState({lookupLeft:newListLeft});this.state.inlineLookupListDisplacementY!==displacementY&&this.setState({inlineLookupListDisplacementY:displacementY});this.state.inlineLookupListCount!==count&&this.setState({inlineLookupListCount:count});this.state.inlineLookupListHeight!==inlineLookupListHeight&&this.setState({inlineLookupListHeight:inlineLookupListHeight});if(this.state.lookupSearchBarWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupSearchBarWidth:lookupWidth})}};InteractionCentricLookupSpec.prototype.focusParentElement=function(){this.switchFocusOnUnmount();var domNode=ReactDOM.findDOMNode(this);if(domNode!=null)$(domNode).parents(".section_control")!==null&&$(domNode).parents(".section_control").length!==0&&$($(domNode).parents(".section_control")[0]).focus()};InteractionCentricLookupSpec.prototype.switchFocusOnUnmount=function(){var popup=this.refs["interactioncentricpopup"];popup instanceof Element&&$(popup).unbind();var partyListScrollable=this.refs["interactioncentricpartylistscrollable"];partyListScrollable instanceof HTMLElement&&$(partyListScrollable).unbind();this.props.dataContext.set_HasFocus(false)};InteractionCentricLookupSpec.prototype.componentWillMount=function(){this.props.dataContext.buildChildViewModelDescriptors(this.props.descriptor);this.props.dataContext.set_ShowLookupBar(false);this.zIndex=ZIndexFinder()+2};InteractionCentricLookupSpec.prototype.componentWillUnmount=function(){this.switchFocusOnUnmount();if(this.props.dataContext.get_interactionCentricLookupAutoResolve()&&this.props.dataContext.get_IsSearchComplete()&&this.props.dataContext.get_IsResolveSuccessful()){AccessibilityUtility.key=Constants.TAB_KEY;var node=$(ReactDOM.findDOMNode(this)).parents(".section_control");this.props.dataContext.set_IsSearchComplete(false);setTimeout(function(){node.focus()},100)}};InteractionCentricLookupSpec.prototype.componentDidUpdate=function(prevProps){if(!this.props.dataContext.get_HasFocus()&&this.props.dismissOnLoseFocus&&this.props.onDismiss){this.props.onDismiss();this.props.dataContext.set_HasFocus(false)}this.calculateLookupListPosition(this.state.inlineLookupListCount)};InteractionCentricLookupSpec.prototype.componentDidMount=function(){if(this.state.lookupSearchBarWidth!=$(ReactDOM.findDOMNode(this)).parent().width()){var lookupWidth=$(ReactDOM.findDOMNode(this)).parent().width();this.setState({lookupSearchBarWidth:lookupWidth})}if(!this.props.dataContext.get_IsInlineOrAssociateFormLookup()){var inlineLookupInput=this.refs["InlineLookupInput"];this.props.clientContext.focusField($(ReactDOM.findDOMNode(inlineLookupInput)))}else{var subGridAncestor=$(ReactDOM.findDOMNode(this)).closest(".gridCell.SubGridCell");if(subGridAncestor.length>0){this.subGridLookupHeight=subGridAncestor[0].clientHeight-125;if(this.subGridLookupHeight>this.LIST_MAX_HEIGHT)this.subGridLookupHeight=this.LIST_MAX_HEIGHT}else{var popupAncestor=$(ReactDOM.findDOMNode(this)).closest(".popupContent.associateForm");if(popupAncestor.length>0){popupAncestor[0].style.backgroundColor="transparent";popupAncestor[0].style.bottom="auto";popupAncestor[0].style.top="80px";popupAncestor[0].style.position="absolute";ReactDOM.findDOMNode(this).style.cssFloat="right";ReactDOM.findDOMNode(this).style.marginRight="45px"}}}var popup=this.refs["interactioncentricpopup"];if(popup instanceof Element){var domNode=$(popup);domNode.data("IsPopup",true);domNode.data("IsModal",true);domNode.click(this.interceptClick)}var partyListScrollWrapper=this.refs["interactioncentricpartylistscrollable"];partyListScrollWrapper instanceof HTMLElement&&$(partyListScrollWrapper).click(this.interceptClick);this.calculateLookupListPosition(this.state.inlineLookupListCount)};InteractionCentricLookupSpec.prototype.onShortPress=function(e){this.setState({isInlineLookupOpened:true});this.props.dataContext.set_HasFocus(true)};InteractionCentricLookupSpec.prototype.onInlineLookupListDismiss=function(force){if(force)if(this.props.leaveEditMode)this.props.leaveEditMode();else this.props.dataContext.set_ShowLookupBar(false);else this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME&&!this.props.onDismiss&&this.props.dataContext.set_ShowLookupBar(false)};InteractionCentricLookupSpec.prototype.showLookupOnClick=function(){this.showLookup(false)};InteractionCentricLookupSpec.prototype.clearError=function(){var lookupInputViewModel=this.props.dataContext.get_LookupInputViewModel();if(lookupInputViewModel!==null&&lookupInputViewModel!==undefined){var inputValue=lookupInputViewModel.get_Value();(inputValue===null||inputValue===undefined||inputValue==="")&&this.props.dataContext.clearError()}};InteractionCentricLookupSpec.prototype.showLookup=function(shouldAutoResolve){this.props.dataContext.shouldPerformSearch()&&this.props.dataContext.search(shouldAutoResolve)};InteractionCentricLookupSpec.prototype.focusFirstLookupItem=function(){var focusableItem=$(".listItemWrapper:first").find("[tabindex]:first");focusableItem!=null&&focusableItem.length>0&&focusableItem.focus()};InteractionCentricLookupSpec.prototype.getEditableViewModelAsFocusable=function(){return this.props.dataContext.get_SectionControlObject()};InteractionCentricLookupSpec.prototype.switchToReadModeAndFocusSectionControl=function(){var editViewModelAsFocusable=this.getEditableViewModelAsFocusable();editViewModelAsFocusable&&editViewModelAsFocusable.set_HasFocus(!editViewModelAsFocusable.get_HasFocus());var focusableItem=$(".InlineLookup").parents(".section_control");focusableItem!=null&&focusableItem.length>0&&focusableItem.focus()};InteractionCentricLookupSpec.prototype.focusLastPartyListItem=function(){var partyListNode=this.refs["interactioncentricpartylist"];if(partyListNode instanceof Element){var partyList=$(partyListNode).find("[tabindex]:not([tabindex^=-])");if(partyList!==null&&partyList.length>0){$(partyList[partyList.length-1]).focus();return true}}return false};InteractionCentricLookupSpec.prototype.onKeyDownHandler=function(e){if(this.props.dataContext.get_interactionCentricLookupAutoResolve()&&e.ctrlKey&&e.which===Constants.K_KEY_CODE){this.showLookup(true);e.preventDefault();e.nativeEvent.stopImmediatePropagation();return false}switch(e.key){case Constants.ENTER_KEY:this.showLookup(false);e.preventDefault();e.nativeEvent.stopImmediatePropagation();break;case Constants.ESCAPE_KEY:if(this.props.dataContext.get_ShowLookupBar()){this.props.dataContext.set_ShowLookupBar(false);e.preventDefault();e.stopPropagation()}else{this.switchToReadModeAndFocusSectionControl();e.preventDefault();e.stopPropagation()}this.focusParentElement();break;case Constants.TAB_KEY:this.props.dataContext.get_interactionCentricLookupAutoResolve()&&this.props.dataContext.shouldPerformSearch()&&this.props.dataContext.set_ShowLookupBar(false);if(!e.shiftKey&&!this.props.dataContext.get_ShowLookupBar()){e.preventDefault();if(!this.props.dataContext.get_interactionCentricLookupAutoResolve()){var firstPartyistItem=$(".partyListItem")[0];if(firstPartyistItem!=null){var clearButtonToFocus=$(firstPartyistItem).children(".partyListItem_label")[0];clearButtonToFocus!=null&&$(clearButtonToFocus).focus()}else{AccessibilityUtility.storeTabOperation(e);this.switchToReadModeAndFocusSectionControl()}}else{AccessibilityUtility.storeTabOperation(e);this.showLookup(true)}}else if(!e.shiftKey&&this.props.dataContext.get_ShowLookupBar()){var footerElement=$(".InlineLookup-FooterSection-TopResults:first-child span");if(footerElement!=null&&footerElement.length>0){var count=footerElement.text().split(" ")[0];if(count==="0"){var focusableItem=$(".InlineLookupList").find("[tabindex]:first");focusableItem!=null&&focusableItem.length>0&&focusableItem.focus()}else this.focusFirstLookupItem();e.preventDefault()}}else if(e.shiftKey&&!this.props.dataContext.get_ShowLookupBar()){if(!this.focusLastPartyListItem()){AccessibilityUtility.storeTabOperation(e);this.switchToReadModeAndFocusSectionControl()}e.preventDefault()}else if(e.shiftKey&&this.props.dataContext.get_ShowLookupBar()){if(!this.focusLastPartyListItem()){var listComponent=$(".InlineLookupList"),listItems=listComponent?listComponent.find("[tabindex]:not([tabindex^=-])"):null;listItems!==null&&listItems.length>0&&$(listItems[listItems.length-1]).focus()}e.preventDefault()}break;case Constants.UP_ARROW_KEY:case Constants.DOWN_ARROW_KEY:this.focusFirstLookupItem();e.preventDefault();break;case Constants.F8_KEY:var domNode=ReactDOM.findDOMNode(this);domNode!=null&&$(domNode).parent()!=null&&this.props.clientContext.focusNextMajorComponent($(domNode).parent(),e.shiftKey);break}};InteractionCentricLookupSpec.prototype.handleListKeyDown=function(e){switch(e.key){case Constants.ENTER_KEY:case Constants.ESCAPE_KEY:if(e.key===Constants.ENTER_KEY&&this.props.dataContext.get_InteractionCentricPartyListViewModel()!==null)break;var focusableItem=$(".InlineLookupPopup").find("[tabindex]:first");focusableItem!=null&&focusableItem.length>0&&focusableItem.focus();this.props.dataContext.set_ShowLookupBar(false);e.preventDefault();e.stopPropagation();this.focusParentElement();break}};InteractionCentricLookupSpec.prototype.getTabIndex=function(){return this.props.tabIndex==null?this.props.dataContext.get_StartIndex()>0?this.props.dataContext.get_StartIndex():this.props.dataContext.get_Root().get_StartIndex():this.props.tabIndex};InteractionCentricLookupSpec.prototype.render=function(){var lookupSearchImageButton=Button.Button({key:"dropdownkey",className:"InlineLookupInputSearchImage",imageType:"Symbol",onClick:this.showLookupOnClick,dataId:"InlineLookupInputSearch"},FontIcon.FontIcon({symbolName:"SearchButton"})),inputBox=Input.Input({key:"InlineLookupInput",ref:"InlineLookupInput",className:"InlineLookupInput",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_LookupInputViewModel(),descriptor:this.props.dataContext.get_LookupInputDescriptor(),inputType:8,onBlur:this.clearError,updateOnChange:true,onKeyDown:this.onKeyDownHandler,tabIndex:this.getTabIndex()}),icLookupList=InteractionCentricInlineLookupList.InteractionCentricInlineLookupList({className:"inlinelookup-bar",key:"inlinelookup-bar",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_InteractionCentricInlineLookupListViewModel(),descriptor:this.props.dataContext.get_InteractionCentricInlineLookUpListDescriptor(),onDismiss:this.props.onDismiss||this.onInlineLookupListDismiss,showLookupBar:this.props.dataContext.get_ShowLookupBar(),height:this.state.inlineLookupListHeight,displacementY:this.state.inlineLookupListDisplacementY,onUpdate:this.calculateLookupListPosition,onKeyDown:this.handleListKeyDown,tabIndex:this.getTabIndex()}),inputDiv=React.DOM.div({key:"InlineLookupSearchContainer",ref:"InlineLookupSearchContainer",className:"InlineLookupSearch"},inputBox,lookupSearchImageButton),children=[];children.push(inputDiv,icLookupList);if(!this.props.dataContext.get_IsInlineOrAssociateFormLookup())var lookup=React.DOM.div({key:"interactioncentricpopup",ref:"interactioncentricpopup",className:"InlineLookupPopup",style:{position:"absolute",top:this.state.lookupTop,left:this.state.lookupLeft,width:this.state.lookupSearchBarWidth}},children),lookupBackDiv=React.DOM.div({key:"InlineLookupListBackDiv",className:"InlineLookupListBackDiv","data-id":"lookupListContainerBackDiv",style:{zIndex:this.zIndex}},lookup),lookupAncestorMountedHost=AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"lookupContainer"},lookupBackDiv);else var lookup=React.DOM.div({key:"interactioncentricpopup",ref:"interactioncentricpopup",className:"InlineLookupPopup",style:{position:"relative",width:this.state.lookupSearchBarWidth,zIndex:this.zIndex}},children),lookupAncestorMountedHost=AncestorMountedHost.AncestorMountedHost({selectorString:"div",dataId:"lookupContainer"},lookup);if(this.props.dataContext.get_InteractionCentricPartyListViewModel()){var interactionCentricPartyList=InteractionCentricPartyList.InteractionCentricPartyList({key:"interactionCentricPartyList",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_InteractionCentricPartyListViewModel(),onUpdate:this.calculateLookupListPosition,tabIndex:this.props.tabIndex==null?this.props.dataContext.get_StartIndex():this.props.tabIndex}),interactionCentricPartyListWrapper=React.DOM.div({key:"interactioncentricpartylist",ref:"interactioncentricpartylist",className:"InteractionCentricPartyListWrapper"},interactionCentricPartyList),interactionCentricPartyListScrollWrapper=React.DOM.div({key:"interactioncentricpartylistscrollable",ref:"interactioncentricpartylistscrollable",className:"InteractionCentricPartyListScrollWrapper"},interactionCentricPartyListWrapper),partyListAncestorMountedHost=AncestorMountedHost.AncestorMountedHost({selectorString:"body",dataId:"partyListContainer"},interactionCentricPartyListScrollWrapper);return React.DOM.div({key:"InlineLookup",className:"InlineLookup"},lookupAncestorMountedHost,partyListAncestorMountedHost)}return React.DOM.div({key:"InlineLookup",className:"InlineLookup"},lookupAncestorMountedHost)};return InteractionCentricLookupSpec}(TsAdapter.SpecBase);exports.InteractionCentricLookup=DataWrapperComponent.wrapComponent(new InteractionCentricLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricMultipleSourceLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/InteractionCentric/Lookup/InteractionCentricLookup"],function(require,exports,TsAdapter,DataWrapperComponent,InteractionCentricLookup){exports.DESCRIPTOR_NAME="InteractionCentricMultipleSourceLookup";var InteractionCentricMultipleSourceLookupSpec=function(_super){__extends(InteractionCentricMultipleSourceLookupSpec,_super);function InteractionCentricMultipleSourceLookupSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricMultipleSourceLookup";this.listenToProperties=["HasFocus","Label","LookupModelName"]}InteractionCentricMultipleSourceLookupSpec.prototype.render=function(){var interactionCentricLookup=InteractionCentricLookup.InteractionCentricLookup({key:"InteractionCentricLookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:this.props.dismissOnLoseFocus,onDismiss:this.props.onDismiss,leaveEditMode:this.props.leaveEditMode,tabIndex:this.props.tabIndex}),children=[interactionCentricLookup];return React.DOM.div({id:"picklistLookup",className:"multipleSourceLookup picklistLookup"},children)};return InteractionCentricMultipleSourceLookupSpec}(TsAdapter.SpecBase);exports.InteractionCentricMultipleSourceLookup=DataWrapperComponent.wrapComponent(new InteractionCentricMultipleSourceLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Lookup/InteractionCentricPartyListLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/InteractionCentric/Lookup/InteractionCentricMultipleSourceLookup","Components/InteractionCentric/Lookup/InteractionCentricLookup"],function(require,exports,TsAdapter,DataWrapperComponent,InteractionCentricMultipleSourceLookup,InteractionCentricLookup){exports.DESCRIPTOR_NAME="InteractionCentricPartyListLookup";var InteractionCentricPartyListLookupSpec=function(_super){__extends(InteractionCentricPartyListLookupSpec,_super);function InteractionCentricPartyListLookupSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricPartyListLookup";this.MAX_WIDTH=300;this.listenToProperties=["HasFocus","Label","LookupStyle"]}InteractionCentricPartyListLookupSpec.prototype.componentWillMount=function(){this.props.clientContext.isPhone&&this.props.dataContext.showOrHideResultsList()};InteractionCentricPartyListLookupSpec.prototype.render=function(){var multipleSourceLookup;if(this.props.dataContext.get_IsMultiSourceLookup())multipleSourceLookup=InteractionCentricMultipleSourceLookup.InteractionCentricMultipleSourceLookup({key:"multipleSourceLookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:false,leaveEditMode:this.props.leaveEditMode,tabIndex:this.props.tabIndex==null?this.props.dataContext.get_NextTabIndex():this.props.tabIndex});else multipleSourceLookup=InteractionCentricLookup.InteractionCentricLookup({key:"multipleSourceLookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:false,leaveEditMode:this.props.leaveEditMode,tabIndex:this.props.tabIndex==null?this.props.dataContext.get_NextTabIndex():this.props.tabIndex});return React.DOM.div({className:"partyListLookup picklistLookup"},multipleSourceLookup)};return InteractionCentricPartyListLookupSpec}(TsAdapter.SpecBase);exports.InteractionCentricPartyListLookup=DataWrapperComponent.wrapComponent(new InteractionCentricPartyListLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/MultipleSourceLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ComboBox","Components/Lookup/Lookup","Components/Lookup/PhoneLookup"],function(require,exports,TsAdapter,DataWrapperComponent,ComboBox,Lookup,PhoneLookup){exports.DESCRIPTOR_NAME="MultipleSourceLookup";var MultipleSourceLookupSpec=function(_super){__extends(MultipleSourceLookupSpec,_super);function MultipleSourceLookupSpec(){_super.apply(this,arguments);this.displayName="MultipleSourceLookup";this.listenToProperties=["HasFocus","Label","LookupModelName"];this.tempPrimaryModelName=null}MultipleSourceLookupSpec.prototype.componentWillMount=function(){this.props.dataContext.buildChildViewModelDescriptors(this.props.descriptor)};MultipleSourceLookupSpec.prototype.componentDidMount=function(){if(this.props.clientContext.isPhone)this.tempPrimaryModelName=this.props.dataContext.get_LookupBarViewModel().get_LookupListViewModel().get_PrimaryModelName()};MultipleSourceLookupSpec.prototype.handleCancel=function(){this.props.dataContext.setComboBoxToModelName(this.tempPrimaryModelName)};MultipleSourceLookupSpec.prototype.render=function(){var combobox=ComboBox.ComboBox({key:"combobox",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_ComboBoxViewModel()}),lookup=Lookup.Lookup({key:"Lookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:this.props.dismissOnLoseFocus,onDismiss:this.props.onDismiss},this.props.clientContext.isMailApp?this.props.children:null),children=[combobox,lookup];if((this.props.clientContext.isPhone||this.props.clientContext.isMailApp)&&this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME)return PhoneLookup.PhoneLookup({label:this.props.dataContext.get_Label(),dataContext:this.props.dataContext,clientContext:this.props.clientContext,onDismiss:this.props.onDismiss,showLabel:this.props.showLabel,descriptor:this.props.descriptor,onCancelClick:this.handleCancel,className:"multipleSource"},children);else return React.DOM.div({id:"picklistLookup",className:"multipleSourceLookup picklistLookup"},children)};return MultipleSourceLookupSpec}(TsAdapter.SpecBase);exports.MultipleSourceLookup=DataWrapperComponent.wrapComponent(new MultipleSourceLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PartyList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lookup/PartyListItem"],function(require,exports,TsAdapter,DataWrapperComponent,PartyListItem){var PartyListSpec=function(_super){__extends(PartyListSpec,_super);function PartyListSpec(){_super.apply(this,arguments);this.displayName="PartyList";this.listenToProperties=["HidePartyList"];this.listenToCollections=["ItemViewModels"]}PartyListSpec.prototype.renderRecords=function(){for(var itemsCollection=this.props.dataContext.get_ItemViewModels(),itemsCount=itemsCollection.get_Count(),results=[],i=0;i<itemsCount;i++){var item=itemsCollection.getItem(i);results.push(PartyListItem.PartyListItem({key:"partyListItem"+i,clientContext:this.props.clientContext,dataContext:item,parentList:this.props.dataContext}))}return results};PartyListSpec.prototype.render=function(){if(this.props.clientContext.isPhone&&this.props.dataContext.get_HidePartyList())return React.DOM.div(null);return React.DOM.div({className:"partyList"},this.renderRecords())};return PartyListSpec}(TsAdapter.SpecBase);exports.PartyList=DataWrapperComponent.wrapComponent(new PartyListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lookup/PartyListLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lookup/PartyList","Components/Lookup/MultipleSourceLookup","Components/Lookup/PhoneLookup","Components/Lookup/Lookup"],function(require,exports,TsAdapter,DataWrapperComponent,PartyList,MultipleSourceLookup,PhoneLookup,Lookup){exports.DESCRIPTOR_NAME="PartyListLookup";var PartyListLookupSpec=function(_super){__extends(PartyListLookupSpec,_super);function PartyListLookupSpec(){_super.apply(this,arguments);this.displayName="PartyListLookup";this.listenToProperties=["HasFocus","Label","LookupStyle"]}PartyListLookupSpec.prototype.componentWillMount=function(){this.props.dataContext.buildChildViewModelDescriptors(this.props.descriptor);this.props.clientContext.isPhone&&this.props.dataContext.showOrHideResultsList()};PartyListLookupSpec.prototype.handleOk=function(){this.props.dataContext.get_PartyListViewModel().setDataOnOkClick()};PartyListLookupSpec.prototype.handleCancel=function(){this.props.dataContext.get_PartyListViewModel().setDataOnCancelClick()};PartyListLookupSpec.prototype.render=function(){var multipleSourceLookup;if(this.props.dataContext.get_PartyListViewModel())var partyList=PartyList.PartyList({key:"partyList",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_PartyListViewModel()});if(this.props.dataContext.get_IsMultiSourceLookup())multipleSourceLookup=MultipleSourceLookup.MultipleSourceLookup({key:"multipleSourceLookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:false},this.props.clientContext.isMailApp?partyList:null);else multipleSourceLookup=Lookup.Lookup({key:"multipleSourceLookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,dismissOnLoseFocus:false},this.props.clientContext.isMailApp?partyList:null);var children=this.props.clientContext.isMailApp?[multipleSourceLookup]:[multipleSourceLookup,partyList];if((this.props.clientContext.isPhone||this.props.clientContext.isMailApp)&&this.props.descriptor.TypeName===exports.DESCRIPTOR_NAME){var isMultiLookup=false;if(this.props.dataContext.get_LookupStyle()==="multi")isMultiLookup=true;return PhoneLookup.PhoneLookup({label:this.props.dataContext.get_Label(),dataContext:this.props.dataContext,clientContext:this.props.clientContext,onDismiss:this.props.onDismiss,showLabel:this.props.showLabel,onOkClick:isMultiLookup?this.handleOk:null,onCancelClick:isMultiLookup?this.handleCancel:null,descriptor:this.props.descriptor,className:this.props.clientContext.isMailApp?"partyListLookup picklistLookup":""},children)}else return React.DOM.div({className:"partyListLookup picklistLookup"},children)};return PartyListLookupSpec}(TsAdapter.SpecBase);exports.PartyListLookup=DataWrapperComponent.wrapComponent(new PartyListLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/EditableSection",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Common/Section","Components/Fields/EditableSectionItem","Components/Fields/ComboBox","Components/Fields/DateControl/DateControl","Components/Fields/DurationControl/DurationControl","Components/Fields/ScrollerControls/DateTime/DateTimeScroller","Components/Fields/ScrollerControls/Duration/DurationScroller","Components/Fields/SectionItem","Components/Fields/RealInput","Components/Fields/IntegerInput","Components/Lookup/Lookup","Components/InteractionCentric/Lookup/InteractionCentricLookup","Components/InteractionCentric/Lookup/InteractionCentricMultipleSourceLookup","Components/InteractionCentric/Lookup/InteractionCentricPartyListLookup","Components/Lookup/MultipleSourceLookup","Components/Lookup/PartyListLookup","Components/Lookup/PartyListRead","Components/Fields/Rollup","Components/InteractionCentric/HierarchicalSubjectControl/HierarchicalSubject"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,Section,EditableSectionItem,ComboBox,DateControl,DurationControl,DateTimeScroller,DurationScroller,SectionItem,RealInput,IntegerInput,Lookup,InteractionCentricLookup,InteractionCentricMultipleSourceLookup,InteractionCentricPartyListLookup,MultipleSourceLookup,PartyListLookup,PartyListRead,Rollup,SubjectLookup){exports.DESCRIPTOR_NAME="EditModeSection";var EditableSectionSpec=function(_super){__extends(EditableSectionSpec,_super);function EditableSectionSpec(){_super.apply(this,arguments);this.displayName="EditableSection";this.isFirstChildForSection="true";this.listenToProperties=["Visible","ChildViewModels","EditStartedCommand","EditFinishedCommand","FieldAccessChanged"]}EditableSectionSpec.prototype.controlNeedsLabel=function(descriptor,viewModel){var needsLabel=this.props.descriptor.Properties["ShowLabel"];if(!viewModel||!viewModel.get_Label())needsLabel=false;if("ShowLabel" in descriptor.Properties)needsLabel=descriptor.Properties["ShowLabel"];return needsLabel};EditableSectionSpec.prototype.handleSectionFocusStateChange=function(hasFocus){var command;if(hasFocus)command=this.props.dataContext.get_EditStartedCommand();else command=this.props.dataContext.get_EditFinishedCommand();command&&command.get_CanExecute()&&command.execute()};EditableSectionSpec.prototype.sectionControlDecorator=function(factory,props){var boundProps=props,controlDescriptor=boundProps.descriptor;if(!this.props.dataContext||!controlDescriptor||controlDescriptor.__type!=="Control")return null;if(controlDescriptor.BindingPath.substr(-EditableSectionItem.EDIT_CONTROL_SUFFIX.length)===EditableSectionItem.EDIT_CONTROL_SUFFIX)return null;if(this.props.dataContext.get_IsInteractionCentricEnabled())props["tabIndex"]=this.props.tabIndex;if(this.props.dataContext.get_ChildViewModels()&&controlDescriptor.BindingPath.substr(-EditableSectionItem.READ_CONTROL_SUFFIX.length)===EditableSectionItem.READ_CONTROL_SUFFIX){var bindingName=controlDescriptor.BindingPath.substring(0,controlDescriptor.BindingPath.length-EditableSectionItem.READ_CONTROL_SUFFIX.length),editBindingName=bindingName+EditableSectionItem.EDIT_CONTROL_SUFFIX,editViewModel=this.props.dataContext.get_ChildViewModels()[editBindingName],editDescriptor=this.props.descriptor.ChildControlViewDescriptors[editBindingName],fieldName=this.props.dataContext.getFieldNameFromDescriptorName(controlDescriptor.BindingPath);if(editViewModel&&editDescriptor){if(this.props.clientContext.isInteractionCentric){var sectionTitle="";if(this.isFirstChildForSection)if(this.props.dataContext&&this.props.dataContext.get_Label()&&this.props.dataContext.get_ShowLabel())sectionTitle=this.props.dataContext.get_Label();this.isFirstChildForSection="false"}return EditableSectionItem.EditableSectionItem({key:bindingName,parentGivenKey:bindingName,fieldName:fieldName,clientContext:boundProps.clientContext,dataContext:boundProps.dataContext,descriptor:controlDescriptor,editSectionViewModel:this.props.dataContext,editViewModel:editViewModel,editDescriptor:editDescriptor,showLabel:this.controlNeedsLabel(controlDescriptor,boundProps.dataContext),editStartedCommand:this.props.dataContext.get_EditStartedCommand(),editFinishedCommand:this.props.dataContext.get_EditFinishedCommand(),renderExtraChildren:this.props.renderExtraChildren,onKeyDown:this.props.clientContext.isInteractionCentric?this.props.onKeyDown:null,isPrimaryFieldSection:this.props.descriptor.Properties["IsPrimaryFieldSection"],largerLineHeightForLabels:this.props.dataContext.get_LargerLineHeightForLabels(),controlSectionTitle:this.props.clientContext.isInteractionCentric?sectionTitle:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null},factory(props))}}return SectionItem.SectionItem({key:props.key,clientContext:this.props.clientContext,dataContext:boundProps.dataContext,descriptor:controlDescriptor,editSectionViewModel:this.props.dataContext,sectionDescriptor:this.props.descriptor,handleFocusStateChange:this.handleSectionFocusStateChange,isPrimaryFieldSection:this.props.descriptor.Properties["IsPrimaryFieldSection"],tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.onKeyDown:null},factory(props))};EditableSectionSpec.prototype.render=function(){if(this.props.clientContext.isInteractionCentric)this.isFirstChildForSection="true";return Section.Section({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,className:this.props.className,sectionControlInterceptor:this.sectionControlDecorator,isVisible:this.props.dataContext.get_Visible(),onKeyDown:this.props.onKeyDown,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null})};return EditableSectionSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(ComboBox.DESCRIPTOR_NAME,ComboBox.ComboBox);ComponentFactory.registerComponentFactory(DateControl.DESCRIPTOR_NAME,DateControl.DateControl);ComponentFactory.registerComponentFactory(DurationControl.DESCRIPTOR_NAME,DurationControl.DurationControl);ComponentFactory.registerComponentFactory(DateTimeScroller.DESCRIPTOR_NAME,DateTimeScroller.DateTimeScroller);ComponentFactory.registerComponentFactory(DurationScroller.DESCRIPTOR_NAME,DurationScroller.DurationScroller);ComponentFactory.registerComponentFactory(RealInput.DESCRIPTOR_NAME1,RealInput.RealInput);ComponentFactory.registerComponentFactory(RealInput.DESCRIPTOR_NAME2,RealInput.RealInput);ComponentFactory.registerComponentFactory(RealInput.DESCRIPTOR_NAME3,RealInput.RealInput);ComponentFactory.registerComponentFactory(IntegerInput.DESCRIPTOR_NAME,IntegerInput.IntegerInput);ComponentFactory.registerComponentFactory(Lookup.DESCRIPTOR_NAME,Lookup.Lookup);ComponentFactory.registerComponentFactory(InteractionCentricLookup.DESCRIPTOR_NAME,InteractionCentricLookup.InteractionCentricLookup);ComponentFactory.registerComponentFactory(InteractionCentricMultipleSourceLookup.DESCRIPTOR_NAME,InteractionCentricMultipleSourceLookup.InteractionCentricMultipleSourceLookup);ComponentFactory.registerComponentFactory(InteractionCentricPartyListLookup.DESCRIPTOR_NAME,InteractionCentricPartyListLookup.InteractionCentricPartyListLookup);ComponentFactory.registerComponentFactory(MultipleSourceLookup.DESCRIPTOR_NAME,MultipleSourceLookup.MultipleSourceLookup);ComponentFactory.registerComponentFactory(PartyListLookup.DESCRIPTOR_NAME,PartyListLookup.PartyListLookup);ComponentFactory.registerComponentFactory(PartyListRead.DESCRIPTOR_NAME,PartyListRead.PartyListRead);ComponentFactory.registerComponentFactory(Rollup.DESCRIPTOR_NAME,Rollup.Rollup);ComponentFactory.registerComponentFactory(SubjectLookup.DESCRIPTOR_NAME,SubjectLookup.HierarchicalSubjectControl);exports.EditableSection=DataWrapperComponent.wrapComponent(new EditableSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Attachments/AddAttachment",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,Constants){var AddAttachmentSpec=function(_super){__extends(AddAttachmentSpec,_super);function AddAttachmentSpec(){_super.apply(this,arguments);this.displayName="AttachmentItem";this.listenToProperties=["Text"]}AddAttachmentSpec.prototype.handleClick=function(e){e.stopPropagation();var command=this.props.dataContext.get_AddAttachmentCommand();command&&command.get_CanExecute()&&command.execute()};AddAttachmentSpec.prototype.onKeyDownHandler=function(e){switch(e.key){case Constants.ENTER_KEY:this.handleClick(e);break}};AddAttachmentSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled())return this.props.tabIndex!=undefined?this.props.tabIndex:this.props.dataContext.get_NextTabIndex();else return null};AddAttachmentSpec.prototype.handleChange=function(event){if(event&&event.target){var fileInput=event.currentTarget,fileList=fileInput.files,file=fileList[0],fileSize=file.size,fileName=file.name,fileType=file.type,isFileSizeTooLarge=this.props.dataContext.isFileSizeTooLarge(fileSize);if(!isFileSizeTooLarge){var currentInstance=this,ms_ie=false,ua=window.navigator.userAgent,old_ie=ua.indexOf("MSIE "),new_ie=ua.indexOf("Trident/"),edge=ua.indexOf("Edge/");if(old_ie>-1||new_ie>-1||edge>-1)ms_ie=true;var reader=new FileReader;reader.onload=function(){if(ms_ie){for(var binary="",bytes=new Uint8Array(reader.result),length=bytes.byteLength,i=0;i<length;i++)binary+=String.fromCharCode(bytes[i]);currentInstance.props.dataContext.submitFile(fileName,binary,fileType,fileSize)}else currentInstance.props.dataContext.submitFile(fileName,reader.result,fileType,fileSize)};if(ms_ie)reader.readAsArrayBuffer(file);else reader.readAsBinaryString(file)}else $("#attachmentFileInput").val("")}};AddAttachmentSpec.prototype.render=function(){var children=[],text=this.props.dataContext.get_Text(),imageButton=ImageButton.ImageButton({className:"AddAttachment_Text",id:"AddAttachmentTextId",labelClassName:"AddAttachment_Icon",label:this.props.dataContext.get_IsInteractionCentricEnabled()?text:null,title:text,onClick:this.handleClick,dataId:"addorreplace",onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.onKeyDownHandler:null,tabIndex:this.getTabIndex()});if(!this.props.dataContext.get_IsInteractionCentricEnabled())return imageButton;var fileInput=React.DOM.input({type:"file",id:"attachmentFileInput",ref:"attachmentFileInput",style:{display:"none"},onChange:this.handleChange});children.push(fileInput,imageButton);return React.DOM.span({},children)};return AddAttachmentSpec}(TsAdapter.SpecBase);exports.AddAttachment=DataWrapperComponent.wrapComponent(new AddAttachmentSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Attachments/AttachmentItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Common/Constants","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,Constants,CssClassSet){var AttachmentItemSpec=function(_super){__extends(AttachmentItemSpec,_super);function AttachmentItemSpec(){_super.apply(this,arguments);this.displayName="AttachmentItem";this.listenToProperties=["Title","Image","MimeType"]}AttachmentItemSpec.prototype.handleOpenAttachment=function(e){e.stopPropagation();var command=this.props.dataContext.get_OpenAttachmentCommand();command&&command.get_CanExecute()&&command.execute()};AttachmentItemSpec.prototype.handleRemoveAttachment=function(e){e.stopPropagation();if(this.props.dataContext.get_IsInteractionCentricEnabled()){var input=$("#attachmentFileInput");input.val("")}var command=this.props.dataContext.get_RemoveAttachmentCommand();command&&command.get_CanExecute()&&command.execute()};AttachmentItemSpec.prototype.handleRemoveAttachmentkeyDown=function(e){switch(e.key){case Constants.ENTER_KEY:var addAttachmentText=$("#AddAttachmentTextId");this.handleRemoveAttachment(e);addAttachmentText!=null&&addAttachmentText.length>0&&addAttachmentText.focus();break}};AttachmentItemSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var tabIndex=this.props.tabIndex;return tabIndex!=undefined&&tabIndex!=null?tabIndex:this.props.dataContext.get_NextTabIndex()}else return null};AttachmentItemSpec.prototype.componentDidMount=function(){var IsDeviceIntegrationEnabled=this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("DeviceIntegration");if(IsDeviceIntegrationEnabled){var command=this.props.dataContext.get_ShowAttachmentCommand();command&&command.get_CanExecute()&&command.execute()}};AttachmentItemSpec.prototype.render=function(){var IsDeviceIntegrationEnabled=this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("DeviceIntegration"),IsEmailEngagementFeatureEnable=this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("EmailEngagement"),title=this.props.dataContext.get_Title(),image=this.props.dataContext.get_Image(),mimeType=this.props.dataContext.get_MimeType().toString().split("/")[0],isInlineCreateForm=this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded(),attachmentButtonsContainer=[],IsFollowedDiv;if(IsEmailEngagementFeatureEnable&&this.props.dataContext.get_IsFollowed())IsFollowedDiv=React.DOM.div({key:"FollowedText",className:"AttachmentItem_FollowedContainer"},[React.DOM.span({key:"isfollwedText",className:"AttachmentItem_FollowedText"},this.props.clientContext.getLocalizedString("ActivityItem_Followed_Label"))]);if(!isInlineCreateForm&&IsDeviceIntegrationEnabled&&mimeType==="image")attachmentButtonsContainer.push(React.DOM.div(null,ImageButton.ImageButton({key:"ShowAttachment",onClick:this.handleOpenAttachment,className:"AttachmentItem_Image maintain-ratio-notesImage",dataId:"showattachment",tabIndex:this.getTabIndex(),imageType:"NotePreview",imageName:"data:"+this.props.dataContext.get_MimeType()+";base64,"+image})));else{attachmentButtonsContainer.push(ImageButton.ImageButton({key:"OpenAttachment",className:"AttachmentItem_Icon",onClick:this.handleOpenAttachment,dataId:"openattachment",tabIndex:this.getTabIndex()}));attachmentButtonsContainer.push(ImageButton.ImageButton({key:"Filename",className:"AttachmentItem_Filename",label:title,title:title,onClick:this.handleOpenAttachment,dataId:"filename",tabIndex:this.getTabIndex()}))}IsDeviceIntegrationEnabled&&(mimeType==="audio"||mimeType==="video")&&attachmentButtonsContainer.push(ImageButton.ImageButton({key:"Playicon",className:"AttachmentItem_PlayIcon",onClick:this.handleOpenAttachment,dataId:"showattachmentforaudioorvideo",tabIndex:this.getTabIndex()}));!this.props.dataContext.get_HideDeleteButton()&&attachmentButtonsContainer.push(ImageButton.ImageButton({key:"DeleteAttachment",className:CssClassSet({AttachmentItem_Delete:true,AttachmentItem_Delete_Flyout:!isInlineCreateForm}),onClick:this.handleRemoveAttachment,dataId:"deleteattachment",onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleRemoveAttachmentkeyDown:null,tabIndex:this.getTabIndex()}));attachmentButtonsContainer.push(IsFollowedDiv);return React.DOM.div({className:"notes_attachmentPointerEvent"},attachmentButtonsContainer)};return AttachmentItemSpec}(TsAdapter.SpecBase);exports.AttachmentItem=DataWrapperComponent.wrapComponent(new AttachmentItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Attachments/AttachmentsControl",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Attachments/AddAttachment","Components/Attachments/AttachmentItem","Components/Primitives/ImageButton"],function(require,exports,TsAdapter,DataWrapperComponent,AddAttachment,AttachmentItem,ImageButton){exports.DESCRIPTOR_NAME="AttachmentsControl";var AttachmentsControlSpec=function(_super){__extends(AttachmentsControlSpec,_super);function AttachmentsControlSpec(){_super.apply(this,arguments);this.displayName="AttachmentsControl";this.listenToProperties=["Text","AttachmentItemViewModel","AddAttachmentViewModel","Title"]}AttachmentsControlSpec.prototype.getTabIndex=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var tabIndex=this.props.tabIndex;return tabIndex!=undefined&&tabIndex!=null?tabIndex:this.props.dataContext.get_NextTabIndex()}else return null};AttachmentsControlSpec.prototype.handleAddCameraImageClick=function(e){e.stopPropagation();var command=this.props.dataContext.get_AddAttachmentViewModel().get_AddImageCommand();command&&command.get_CanExecute()&&command.execute()};AttachmentsControlSpec.prototype.handleAddAudioClick=function(e){e.stopPropagation();var command=this.props.dataContext.get_AddAttachmentViewModel().get_AddAudioCommand();command&&command.get_CanExecute()&&command.execute()};AttachmentsControlSpec.prototype.handleAddVideoClick=function(e){e.stopPropagation();var command=this.props.dataContext.get_AddAttachmentViewModel().get_AddVideosCommand();command&&command.get_CanExecute()&&command.execute()};AttachmentsControlSpec.prototype.render=function(){var vm=this.props.dataContext,attachmentContainer=[];vm.get_AttachmentItemViewModel()!=null&&vm.get_AttachmentItemViewModel().get_Title()&&attachmentContainer.push(AttachmentItem.AttachmentItem({key:"AttachmentItem",clientContext:this.props.clientContext,dataContext:vm.get_AttachmentItemViewModel(),tabIndex:this.getTabIndex()}));if(!this.props.dataContext.get_IsInteractionCentricEnabled()&&vm.get_AddAttachmentViewModel()!=null&&!vm.get_AddAttachmentViewModel().get_HideAddAttachment()){!vm.get_AddAttachmentViewModel().get_HideCamera()&&attachmentContainer.push(ImageButton.ImageButton({className:"AddImage_Text",id:"AddCameraImagesTextId",labelClassName:"AddImage_Icon",title:vm.get_AddAttachmentViewModel().get_CameraText(),onClick:this.handleAddCameraImageClick,dataId:"addorreplaceimages"}));!vm.get_AddAttachmentViewModel().get_HideMicrophone()&&attachmentContainer.push(ImageButton.ImageButton({className:"AddAudio_Text",id:"AddAudioTextId",labelClassName:"AddAudio_Icon",title:vm.get_AddAttachmentViewModel().get_AudioText(),onClick:this.handleAddAudioClick,dataId:"addorreplaceaudio"}));!vm.get_AddAttachmentViewModel().get_HideVideo()&&attachmentContainer.push(ImageButton.ImageButton({className:"AddVideos_Text",id:"AddVideosTextId",labelClassName:"AddVideos_Icon",title:vm.get_AddAttachmentViewModel().get_VideoText(),onClick:this.handleAddVideoClick,dataId:"addorreplacevideos"}))}vm.get_AddAttachmentViewModel()!=null&&!vm.get_AddAttachmentViewModel().get_HideAddAttachment()&&attachmentContainer.push(AddAttachment.AddAttachment({key:"AddAttachment",className:"Attachments_AddAttachment",clientContext:this.props.clientContext,dataContext:vm.get_AddAttachmentViewModel(),tabIndex:this.getTabIndex()}));return React.DOM.div(null,attachmentContainer)};return AttachmentsControlSpec}(TsAdapter.SpecBase);exports.AttachmentsControl=DataWrapperComponent.wrapComponent(new AttachmentsControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/NotesListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Attachments/AttachmentsControl","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,AttachmentsControl,CssClassSet){exports.DESCRIPTOR_NAME="NotesItem";var CUTOFF_LENGTH=123,NotesListItemSpec=function(_super){__extends(NotesListItemSpec,_super);function NotesListItemSpec(){_super.apply(this,arguments);this.displayName="NotesListItem";this.listenToProperties=["Subject","Text","LastModifiedBy","ModifiedOn"]}NotesListItemSpec.prototype.getInitialState=function(){return {isExpanded:false}};NotesListItemSpec.prototype.handleShortPress=function(e){e.stopPropagation();this.props.dataContext.get_Text().length>CUTOFF_LENGTH&&this.setState({isExpanded:!this.state.isExpanded})};NotesListItemSpec.prototype.render=function(){var vm=this.props.dataContext,isExpandable=false,notesText=vm.get_Text(),notesTextValue=notesText?notesText:"";if(notesTextValue!=""){isExpandable=notesTextValue.length>CUTOFF_LENGTH;notesTextValue=!this.state.isExpanded&&isExpandable?notesTextValue.substring(0,CUTOFF_LENGTH)+"...":notesTextValue}var textContainerChildren=[];textContainerChildren.push(React.DOM.span({key:"NoteSubject","data-fieldname":"subject",className:"notes_subject"},vm.get_Subject()));textContainerChildren.push(React.DOM.span({key:"NoteText","data-fieldname":"notetext",className:CssClassSet({notes_postText:true,noteCollapsed:!this.state.isExpanded&&isExpandable,noteExpanded:this.state.isExpanded&&isExpandable})},notesTextValue));vm.get_AttachmentsControlViewModel()!=null&&vm.get_AttachmentsControlViewModel().get_Enabled()&&textContainerChildren.push(React.DOM.div({key:"AttachmentsControl",className:"notes_attachments"},AttachmentsControl.AttachmentsControl({clientContext:this.props.clientContext,dataContext:vm.get_AttachmentsControlViewModel()})));textContainerChildren.push(React.DOM.span({key:"LastModifiedOn","data-fieldname":"modifiedon",className:"notes_modifiedOn"},vm.get_ModifiedOn()));textContainerChildren.push(React.DOM.span({key:"LastModifiedBy","data-fieldname":"modifiedby",className:"notes_lastModifiedBy"},vm.get_LastModifiedBy()));var textContainer=React.DOM.div({key:"text",className:"notes_details"},textContainerChildren);return React.DOM.div({className:"notesItem",onShortPress:this.handleShortPress},[textContainer])};return NotesListItemSpec}(TsAdapter.SpecBase);exports.NotesListItem=DataWrapperComponent.wrapComponent(new NotesListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/HierarchyListItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Lists/ListItem"],function(require,exports,TsAdapter,PureUpdate,ListItem){exports.DESCRIPTOR_NAME="HierarchyListItem";var HierarchyListItemSpec=function(_super){__extends(HierarchyListItemSpec,_super);function HierarchyListItemSpec(){_super.apply(this,arguments);this.displayName="HierarchyListItem";this.mixins=[PureUpdate.Mixin]}HierarchyListItemSpec.prototype.handleShortPressEventForBreadcrumb=function(e){e.stopPropagation();if(this.props.isLastItem)this.props.parentList.navigateBreadcrumbItem(this.props.dataContext);else this.props.parentList.onBreadcrumbPressed(this.props.dataContext)};HierarchyListItemSpec.prototype.render=function(){return ListItem.ListItem({key:this.props.parentGivenKey,clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,className:this.props.className,parentList:this.props.parentList,dataActive:this.props.dataActive,onClick:this.handleShortPressEventForBreadcrumb})};return HierarchyListItemSpec}(TsAdapter.SpecBase);exports.HierarchyListItem=TsAdapter.createComponent(new HierarchyListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/OneNoteListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon){exports.DESCRIPTOR_NAME="OneNoteItem";var CUTOFF_LENGTH=123,OneNoteListItemSpec=function(_super){__extends(OneNoteListItemSpec,_super);function OneNoteListItemSpec(){_super.apply(this,arguments);this.displayName="OneNoteListItem";this.listenToProperties=["FullName","Modified","Author","SharepointModifiedBy","SharepointCreatedOn","EditUrl","AbsoluteUrl"]}OneNoteListItemSpec.prototype.getInitialState=function(){return {isExpanded:false}};OneNoteListItemSpec.prototype.handleShortPress=function(e){e.stopPropagation();var command=this.props.dataContext.get_OneNoteShortPressCommand();command&&command.get_CanExecute()&&command.execute()};OneNoteListItemSpec.prototype.render=function(){var vm=this.props.dataContext,iconContainer=React.DOM.div({key:"onenote_Icon_Container",className:"onenote_Icon_Container"},React.DOM.div({className:"onenote_Icon"},FontIcon.FontIcon({symbolName:"OneNote"}))),isExpandable=false,notesText=vm.get_FullName(),notesTextValue=notesText?notesText:"";if(notesTextValue!=""){isExpandable=notesTextValue.length>CUTOFF_LENGTH;notesTextValue=!this.state.isExpanded&&isExpandable?notesTextValue.substring(0,CUTOFF_LENGTH)+"...":notesTextValue}var textContainerChildren=[];textContainerChildren.push(React.DOM.span({key:"FullName","data-fieldname":"fullname",className:"onenote_fullname"},vm.get_FullName()));textContainerChildren.push(React.DOM.span({key:"modifiedon",className:"onenote_modifiedon"},vm.get_Modified()));textContainerChildren.push(React.DOM.span({key:"ModifiedBy",className:"onenote_modifiedby"},vm.get_SharepointModifiedBy()));var textContainer=React.DOM.div({key:"section",className:"onenoteSection"},textContainerChildren);return React.DOM.div({className:"onenoteSectionItem",onShortPress:this.handleShortPress},[iconContainer,textContainer])};return OneNoteListItemSpec}(TsAdapter.SpecBase);exports.OneNoteListItem=DataWrapperComponent.wrapComponent(new OneNoteListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/OfficeGraphDocumentItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/EntityFontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,EntityFontIcon){exports.DESCRIPTOR_NAME="OfficeGraphDocumentItem";var OfficeGraphDocumentItemSpec=function(_super){__extends(OfficeGraphDocumentItemSpec,_super);function OfficeGraphDocumentItemSpec(){_super.apply(this,arguments);this.displayName="OfficeGraphDocumentItem";this.listenToProperties=["Title","SiteTitle","WebLocationUrl","ModifiedTime","FileType"]}OfficeGraphDocumentItemSpec.prototype.render=function(){var vm=this.props.dataContext,children=[],textContainerChildren=[],iconContainer=React.DOM.div({className:this.props.dataContext.get_IconBackgroundClass()},EntityFontIcon.EntityFontIcon({entityName:"",className:this.props.dataContext.get_DocumentIconClass()}));children.push(iconContainer);textContainerChildren.push(React.DOM.span({key:"FullName","data-fieldname":"title",className:"officegraph_title"},vm.get_Title()));textContainerChildren.push(React.DOM.span({key:"modifiedtime",className:"officegraph_modifiedtime"},vm.get_ModifiedTime()));textContainerChildren.push(React.DOM.span({key:"siteTitle",className:"officegraph_sitetitle"},vm.get_SiteTitle()));var textContainer=React.DOM.div({key:"section",className:"officegraphSection"},textContainerChildren);children.push(textContainer);return React.DOM.div({className:"officegraphSectionItem"},children)};return OfficeGraphDocumentItemSpec}(TsAdapter.SpecBase);exports.OfficeGraphDocumentItem=DataWrapperComponent.wrapComponent(new OfficeGraphDocumentItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/SwitchProcessListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="SwitchProcessListItem";var SwitchProcessListItemSpec=function(_super){__extends(SwitchProcessListItemSpec,_super);function SwitchProcessListItemSpec(){_super.apply(this,arguments);this.displayName="SwitchProcessListItem"}SwitchProcessListItemSpec.prototype.render=function(){var vm=this.props.dataContext,details=vm.get_NewProcessLabel(),listItems=[],model=this.props.dataContext.get_ModelContext(),name=model.get_ModelName(),StatusCodeName=model.GetValue("StatusCodeName");this.isDefinition=model.GetValue("type")=="definition"?true:false;if(!this.isDefinition){var modifiedon=model.GetValue("ModifiedOn"),modifiedByName=model.GetValue("ModifiedByName");details=modifiedon+" "+vm.get_ByLabel()+" "+modifiedByName}var itemNameView=React.DOM.div({key:"itemNameView"},name);listItems.push(itemNameView);if(StatusCodeName!="Active"){StatusCodeName=vm.get_GetStatusCode();var itemStatusView=React.DOM.div({key:"itemStatusView"},StatusCodeName);listItems.push(itemStatusView)}var detailsView=React.DOM.div({key:"itemStageView"},details);listItems.push(detailsView);var listItemsView=React.DOM.div({key:"listItemsView",className:"switchProcessItem-control"},listItems),symbolView=React.DOM.div({key:"symbolView",className:"SymbolContainer"},React.DOM.div({key:"symbol",className:"SwitchProcessDialogList-symbol"})),controlSwitchProcessItem=React.DOM.div({key:"control",className:"switchProcessItem-container"},[symbolView,listItemsView]);return controlSwitchProcessItem};return SwitchProcessListItemSpec}(TsAdapter.SpecBase);exports.SwitchProcessListItem=DataWrapperComponent.wrapComponent(new SwitchProcessListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/ListItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Lists/ActivityListItem","Components/MailApp/MailAppSenderFormActivityItem","Components/Lists/PinnedTile","Components/Fields/EditableSection","Components/Lists/NotesListItem","Components/Lists/HierarchyListItem","Components/Lists/OneNoteListItem","Components/Lists/OfficeGraphDocumentItem","Components/BusinessProcess/SwitchProcessListItem","Utils/CssClassSet","Core/Binding/XrmUIDescriptorMixin","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,ActivityListItem,MailAppSenderFormActivityItem,PinnedTile,EditableSection,NotesListItem,HierarchyListItem,OneNoteListItem,OfficeGraphDocumentListItem,SwitchProcessListItem,CssClassSet,IXUD,Constants){exports.LIST_ITEM_CSS_CLASS="listItem";var ListItemSpec=function(_super){__extends(ListItemSpec,_super);function ListItemSpec(){_super.apply(this,arguments);this.displayName="ListItem";this.mixins=[IXUD.Mixin];this.listenToProperties=["IsSelected","RecordId"];this.simulateMouseEvent=false}ListItemSpec.prototype.getDefaultProps=function(){return {wrapperComponent:React.DOM.div}};ListItemSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.listItem;if(this.props.dataContext.get_RecordId())properties["id"]=this.props.dataContext.get_RecordId();else properties["id"]=$(ReactDOM.findDOMNode(this)).attr("data-seq");if(this.props!=undefined&&this.props.descriptor!=undefined&&this.props.descriptor.BindingPath)properties["parentId"]=XrmUI.UIControlType.grid;else properties["parentId"]=XrmUI.ControlId.panoramaItem;return properties};ListItemSpec.prototype.handleShortPress=function(e){if(this.props.onClick)this.props.onClick(e);else{var shortPressCommand=this.props.dataContext.get_ShortPressCommand();if(shortPressCommand&&shortPressCommand.get_CanExecute())shortPressCommand.execute();else this.invokeSelectListItemCommand(2)}};ListItemSpec.prototype.handleKeyDown=function(e){if(this.props.isInteractionCentricLookup)this.props.onKeyDown&&this.props.onKeyDown(e);if(this.props.dataContext.get_IsInteractionCentricEnabled())switch(e.key){case Constants.ENTER_KEY:this.handleShortPress(e);break;case Constants.DOWN_ARROW_KEY:case Constants.UP_ARROW_KEY:e.preventDefault();var currentDataSeq=parseInt($(ReactDOM.findDOMNode(this)).attr("data-seq")),ItemNumber=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?currentDataSeq+1:currentDataSeq-1;this.focusElement($(ReactDOM.findDOMNode(this)),ItemNumber);break;case Constants.RIGHT_ARROW_KEY:case Constants.LEFT_ARROW_KEY:e.preventDefault();var currentPanoramaItem=$(document.activeElement).closest(".panoramaItem");if(currentPanoramaItem[0]!=null){var panoramaItemToFocus=e.key==Constants.RIGHT_ARROW_KEY?currentPanoramaItem.next(".panoramaItem"):currentPanoramaItem.prev(".panoramaItem");if(panoramaItemToFocus[0]!=null){var listItem=panoramaItemToFocus.find(".listItem")[0];listItem!=null&&$(listItem).focus()}}break;case Constants.TAB_KEY:this.props.handlerForLookup!=null&&this.props.handlerForLookup(e);if(e.shiftKey){e.preventDefault();this.handleShiftTab(e.target)}else{e.preventDefault();this.handleTab(e.target)}break}};ListItemSpec.prototype.focusElement=function(domElement,dataSeq){if(domElement!=null)if(domElement.parents(".listView")!=null&&domElement.parents(".listView").find('[data-seq="'+dataSeq+'"]')!=null){var nextDom=domElement.parents(".listView").find('[data-seq="'+dataSeq+'"]');nextDom!=null&&nextDom.focus()}else this.focusElement(domElement.parent(),dataSeq)};ListItemSpec.prototype.handleShiftTab=function(domElement){if(domElement!=null){var activeElement=$(domElement),parentElement=activeElement.closest(".listItem");if(parentElement.length>0)if(activeElement.hasClass("listItem")){var prevElement=activeElement.prev();if(prevElement.length>0)this.handleListItemFocus(activeElement,true);else this.handlePanaronmaItemFocus(activeElement,true)}else{var firstChildElement=parentElement.find("[tabIndex]")[0];if(activeElement[0]==firstChildElement)parentElement.focus();else this.handleItemFocus(activeElement,parentElement,true)}}};ListItemSpec.prototype.handleTab=function(domElement){if(domElement!=null){var activeElement=$(domElement),currentPanoramaItem=activeElement.closest(".panoramaItem");if(currentPanoramaItem[0]!=null)if(activeElement.hasClass("listItem"))this.handleListItemFocus(activeElement,false);else{var parentElement=activeElement.closest(".listItem");if(parentElement.length>0){var lastChildElement=parentElement.find("[tabIndex]")[parentElement.find("[tabIndex]").length-1];if(activeElement[0]==lastChildElement)if(parentElement.next().length>0)parentElement.next().focus();else this.handlePanaronmaItemFocus(activeElement,false);else this.handleItemFocus(activeElement,parentElement,false)}}}};ListItemSpec.prototype.handleListItemFocus=function(activeElement,isShift){var nextElement=isShift?activeElement.prev().find("[tabIndex]")[activeElement.prev().find("[tabIndex]").length-1]:activeElement.find("[tabIndex]")[0];if(nextElement!=null)if($(nextElement).hasClass("checkbox"))if(!$(nextElement).is(":disabled"))$(nextElement).focus();else{var listElement=isShift?activeElement.prev():activeElement.next();this.focusWithNullCheck(listElement)}else $(nextElement).focus()};ListItemSpec.prototype.handleItemFocus=function(activeElement,parentElement,isShift){for(var j=0;j<parentElement.find("[tabIndex]").length;j++)if(activeElement[0]==parentElement.find("[tabIndex]")[j]){var nextChildElement=isShift?parentElement.find("[tabIndex]")[j-1]:parentElement.find("[tabIndex]")[j+1];this.focusWithNullCheck($(nextChildElement));break}};ListItemSpec.prototype.handlePanaronmaItemFocus=function(activeElement,isShift){var currentPanoramaItem=activeElement.closest(".panoramaItem"),panoramaItemToFocus=isShift?currentPanoramaItem.prev(".panoramaItem"):currentPanoramaItem.next(".panoramaItem");if(panoramaItemToFocus[0]!=null&&!($(panoramaItemToFocus[0]).css("display")=="none")){var listItem=isShift?panoramaItemToFocus.find(".listItem")[panoramaItemToFocus.find(".listItem").length-1]:panoramaItemToFocus.find(".listItem")[0];this.focusWithNullCheck($(listItem))}else{var focusedElement=isShift?activeElement.closest(".panoramaContainer").prev().find(".comboBox"):$("body").find(".navBarSiteMapLogoText");this.focusWithNullCheck($(focusedElement[0]))}};ListItemSpec.prototype.focusWithNullCheck=function(activeElement){activeElement!=null&&activeElement.focus()};ListItemSpec.prototype.handleLongPress=function(e){this.invokeSelectListItemCommand(1);if(this.props.parentList.get_IsSortable()){this.simulateMouseEvent=true;this.handleLongPressEventObject=e.nativeEvent}e.stopPropagation()};ListItemSpec.prototype.invokeSelectListItemCommand=function(eventType){var dataContextExists=this.props.dataContext;if(!dataContextExists)return;this.props.dataContext.set_SelectItemEventType(eventType);var command=this.props.dataContext.get_SelectListItemCommand();command!=null&&command.execute()};ListItemSpec.prototype.mapTouchEvents=function(){if(!this.isMounted())return;if(!this.props.parentList.get_IsSortable())return;var element=$(ReactDOM.findDOMNode(this));if(this.props.dataContext.get_IsSelected()){!this.props.clientContext.userAgent.get_IsBrowserIE()&&this.props.clientContext.mapTouchEvents(element);this.startSingleTouchDrag(element)}else{if(!this.props.clientContext.userAgent.get_IsBrowserIE()){element.unbind("touchstart");element.unbind("touchmove");element.unbind("touchend")}this.props.clientContext.userAgent.get_IsBrowserIE()&&element.css("touch-action","")}};ListItemSpec.prototype.componentDidMount=function(){if(this.props.clientContext.isPreview)return;var domNode=$(ReactDOM.findDOMNode(this))};ListItemSpec.prototype.componentDidUpdate=function(){if(this.props.clientContext.isPreview)return;this.isMounted()&&this.mapTouchEvents()};ListItemSpec.prototype.componentWillUnmount=function(){var domNode=ReactDOM.findDOMNode(this);$(domNode).unbind()};ListItemSpec.prototype.renderSelectedMarkComponent=function(){return React.DOM.div({key:"check",className:"item_Checked"})};ListItemSpec.prototype.childDecorator=function(factory,childProps){if(childProps["descriptor"]&&childProps["dataContext"]){childProps["descriptor"].TypeName=this.props.dataContext.resolveChildViewType(childProps["dataContext"]);var newFactory=ComponentFactory.getFactoryForControlName(childProps["descriptor"].TypeName);return newFactory(childProps)}return factory(childProps)};ListItemSpec.prototype.icChildDecorator=function(factory,childProps){if(childProps["descriptor"]&&childProps["descriptor"].TypeName==="EmailAttachment")childProps["tabIndex"]=this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_NextTabIndex();return factory(childProps)};ListItemSpec.prototype.isEmailAttachmentListItem=function(children){return children.length==1&&children[0].props.descriptor!=null?children[0].props.descriptor.TypeName==="EmailAttachment"?true:false:false};ListItemSpec.prototype.render=function(){var record=this.props.dataContext;if(this.props.isInteractionCentricMultiSourceLookup===true)var children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);else if(this.props.parentList.get_PrimaryModelName()==="multiItem")var children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,null,this.props.parentList);else var children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.icChildDecorator);var isSelected=this.props.dataContext.get_IsSelected(),showCheckmark=this.props.dataContext.get_ShowCheckmark(),toolTipMsg="";if(this.props.isInteractionCentricLookup===true||this.props.isInteractionCentricMultiSourceLookup===true)for(var j=0,len=children.length;j<len;j++)if(children[j].props.dataContext.get_Data())if(children[j].props.dataContext.get_Data().get_displayName)toolTipMsg+=children[j].props.dataContext.get_Data().get_displayName().toString()+"\n";else toolTipMsg+=children[j].props.dataContext.get_Data().toString()+"\n";else toolTipMsg+="---\n";else toolTipMsg=null;if(this.props.itemRenderer)for(var i=0,len=children.length;i<len;i++)children[i]=this.props.itemRenderer(children[i],i,isSelected&&i===len-1?this.renderSelectedMarkComponent():null,this.props.dataContext);isSelected&&!this.props.itemRenderer&&showCheckmark&&children.push(this.renderSelectedMarkComponent());for(var cssClassNames="",classNames=[],i=0;i<this.props.dataContext.get_CssClassNames().get_Count();i++)classNames.push(this.props.dataContext.get_CssClassNames().getItem(i));cssClassNames=classNames.join(" ");var tabindex=this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_NextTabIndex();if(this.props.dataContext.get_IsInteractionCentricEnabled())if(this.props.itemNumber>0)tabindex=-1;return this.props.wrapperComponent({role:"option",className:CssClassSet({listItemSelected:isSelected},exports.LIST_ITEM_CSS_CLASS,cssClassNames,this.props.className,this.props.dataContext.get_RecordModelName()),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()&&!this.isEmailAttachmentListItem(children)?tabindex:null,"data-id":record.get_RecordId(),"data-active":this.props.dataActive?1:0,"aria-selected":isSelected?"true":"false","data-seq":this.props.itemNumber,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()&&!this.isEmailAttachmentListItem(children)?this.handleKeyDown:null,onShortPress:this.props.clientContext.isPreview?null:this.handleShortPress,onLongPress:this.props.clientContext.isPreview||this.props.dataContext.get_IsInteractionCentricEnabled()||this.props.dataContext.get_IsSelected()?null:this.handleLongPress,title:toolTipMsg},children)};ListItemSpec.prototype.startSingleTouchDrag=function(element){var _this=this;if(this.simulateMouseEvent&&this.handleLongPressEventObject){this.props.clientContext.userAgent.get_IsBrowserIE()&&element.parents(".scrollRegion").first().css("overflow-y","hidden");window.setTimeout(function(){_this.props.clientContext.simulateMouseEventForLongPress(_this.handleLongPressEventObject);_this.handleLongPressEventObject=null});this.simulateMouseEvent=false}};return ListItemSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(MailAppSenderFormActivityItem.DESCRIPTOR_NAME,MailAppSenderFormActivityItem.MailAppSenderFormActivityItem);ComponentFactory.registerComponentFactory(ActivityListItem.DESCRIPTOR_NAME,ActivityListItem.ActivityListItem);ComponentFactory.registerComponentFactory(PinnedTile.DESCRIPTOR_NAME,PinnedTile.PinnedTile);ComponentFactory.registerComponentFactory(EditableSection.DESCRIPTOR_NAME,EditableSection.EditableSection);ComponentFactory.registerComponentFactory(NotesListItem.DESCRIPTOR_NAME,NotesListItem.NotesListItem);ComponentFactory.registerComponentFactory(HierarchyListItem.DESCRIPTOR_NAME,HierarchyListItem.HierarchyListItem);ComponentFactory.registerComponentFactory(OneNoteListItem.DESCRIPTOR_NAME,OneNoteListItem.OneNoteListItem);ComponentFactory.registerComponentFactory(OfficeGraphDocumentListItem.DESCRIPTOR_NAME,OfficeGraphDocumentListItem.OfficeGraphDocumentItem);ComponentFactory.registerComponentFactory(SwitchProcessListItem.DESCRIPTOR_NAME,SwitchProcessListItem.SwitchProcessListItem);exports.ListItem=DataWrapperComponent.wrapComponent(new ListItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Utils/PreserveScrollPositionMixin",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var DefaultScrollPreservationStrategy=function(){function DefaultScrollPreservationStrategy(){}DefaultScrollPreservationStrategy.prototype.getElement=function(component){return ReactDOM.findDOMNode(component)};DefaultScrollPreservationStrategy.prototype.saveScroll=function(component){var node=this.getElement(component);if(node)return {top:node.scrollTop,left:node.scrollLeft};return {top:0,left:0}};DefaultScrollPreservationStrategy.prototype.restoreScroll=function(component,savedState){var nonZeroLeft=savedState.left!==0,nonZeroTop=savedState.top!==0;if(nonZeroLeft||nonZeroTop){var node=this.getElement(component);if(node){if(nonZeroLeft)node.scrollLeft=savedState.left;if(nonZeroTop)node.scrollTop=savedState.top}}};return DefaultScrollPreservationStrategy}();exports.DefaultScrollPreservationStrategy=DefaultScrollPreservationStrategy;var ComponentRefScrollPreservationStrategy=function(_super){__extends(ComponentRefScrollPreservationStrategy,_super);function ComponentRefScrollPreservationStrategy(componentRef){_super.call(this);this.componentRef=componentRef}ComponentRefScrollPreservationStrategy.prototype.getElement=function(component){var ref=component.refs[this.componentRef];if(ref&&ref.isMounted())return ReactDOM.findDOMNode(ref);return null};return ComponentRefScrollPreservationStrategy}(DefaultScrollPreservationStrategy);exports.ComponentRefScrollPreservationStrategy=ComponentRefScrollPreservationStrategy;var SavedScrollState=function(){function SavedScrollState(viewModel,scrollState,strategy){this.viewModel=viewModel;this.scrollState=scrollState;this.strategy=strategy}return SavedScrollState}(),viewModelScrollPositions={},cleanupTimeout=-1;function cleanUpPositions(){for(var vmId in viewModelScrollPositions)if(viewModelScrollPositions.hasOwnProperty(vmId))if(viewModelScrollPositions[vmId].viewModel.get_IsDisposed())delete viewModelScrollPositions[vmId];cleanupTimeout=-1}function queueCleanup(){if(cleanupTimeout===-1)cleanupTimeout=window.setTimeout(cleanUpPositions,1e3)}var PreserveScrollPositionMixin=function(_super){__extends(PreserveScrollPositionMixin,_super);function PreserveScrollPositionMixin(){_super.apply(this,arguments)}PreserveScrollPositionMixin.prototype.componentDidMount=function(){if(this.props.dataContext){var scrollPosition=viewModelScrollPositions[this.props.dataContext.get_ViewModelId()];scrollPosition&&scrollPosition.strategy.restoreScroll(this,scrollPosition.scrollState)}};PreserveScrollPositionMixin.prototype.componentWillUnmount=function(){if(this.props.dataContext&&!this.props.dataContext.get_IsDisposed()){var vmId=this.props.dataContext.get_ViewModelId(),scrollPosition=viewModelScrollPositions[vmId];if(scrollPosition)scrollPosition.scrollState=scrollPosition.strategy.saveScroll(this);else{var strategy=this.getScrollPreservationStrategy?this.getScrollPreservationStrategy():new DefaultScrollPreservationStrategy,scrollState=strategy.saveScroll(this);scrollPosition=new SavedScrollState(this.props.dataContext,scrollState,strategy);viewModelScrollPositions[vmId]=scrollPosition}}queueCleanup()};return PreserveScrollPositionMixin}(TsAdapter.SpecBase);exports.Mixin=TsAdapter.createMixin(new PreserveScrollPositionMixin)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/List",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/SortableMixin","Core/Binding/WindowResizeHandlerMixin","Core/Binding/UIHasRenderedMixin","Components/Primitives/ScrollRegion","Components/Common/LoadingBar","Components/Lists/ListItem","Utils/CssClassSet","Utils/PreserveScrollPositionMixin"],function(require,exports,TsAdapter,DataWrapperComponent,ISortable,WindowResizeHandler,UIHasRendered,ScrollRegion,LoadingBar,ListItem,CssClassSet,PreserveScrollPosition){var ListLoadingBar=LoadingBar.createLoadingBar("IsLoading",true),ListSpec=function(_super){__extends(ListSpec,_super);function ListSpec(){_super.apply(this,arguments);this.displayName="List";this.mixins=[ISortable.Mixin,PreserveScrollPosition.Mixin,UIHasRendered.Mixin,WindowResizeHandler.Mixin];this.listenToProperties=["SelectedItem","Items","PrimaryModelName","IsSelected","IsServerAvailable","OfflineText","HideDraftsMessage","SortOrder","HasError"];this.skipComponentDidUpdateHasRenderedCall=true;this.listenToCollections=["Items"];this.FIRST_ITEM_LABEL="itemlabel0";this.componentDidUpdateCallback=null}ListSpec.prototype.getDefaultProps=function(){return {listClassName:"listView"}};ListSpec.prototype.componentDidUpdate=function(){if(this.componentDidUpdateCallback){this.componentDidUpdateCallback();this.componentDidUpdateCallback=null}this.props.dataContext&&this.props.dataContext.UIHasRendered();if(this.props.dataContext&&this.props.dataContext.get_IsSortable()&&this.sortable)if(this.props.dataContext.get_SelectedItem())this.sortable.sortable("enable");else this.sortable.sortable("disable")};ListSpec.prototype.handleWindowResize=function(){var root=this.props.dataContext.get_Root();root&&root.get_ComponentTypeName()==="dialog"&&this.forceUpdate()};ListSpec.prototype.getContainmentElement=function(){var node=$(ReactDOM.findDOMNode(this));return node.parents(".component")[0]};ListSpec.prototype.renderError=function(){var title=React.DOM.span({key:"title",className:"listComponentView_errorTitle"},this.props.dataContext.get_ListErrorTitle()),message=React.DOM.span({key:"message",className:"listComponentView_errorMessage"},this.props.dataContext.get_ListErrorMessage());return React.DOM.div({key:"error"},[title,message])};ListSpec.prototype.renderNoRecords=function(){var msg;if(this.props.noRecordsMessage)msg=this.props.noRecordsMessage;else msg=this.props.dataContext.get_NoRecordsText();return React.DOM.span({key:"noRecordsMessage",className:"listComponentView_noRecords"},msg)};ListSpec.prototype.renderPreRecordsMessage=function(){return React.DOM.span({key:"preRecordsMessage",className:"listComponentView_preRecordsMessage"},this.props.preRecordsMessage)};ListSpec.prototype.renderOfflineMessage=function(){return React.DOM.span({key:"offline",className:"listComponentView_offlineList"},this.props.dataContext.get_OfflineText())};ListSpec.prototype.renderDraftsMessage=function(){return React.DOM.label({key:"draftMessage",className:"listComponentView_draftsMessageList"},this.props.dataContext.get_DraftsMessage())};ListSpec.prototype.isMultiSourceInteractionCentricLookup=function(){return this.props.dataContext.get_IsInteractionCentricLookup()&&this.props.dataContext.get_LookupStyle()==="multi"};ListSpec.prototype.renderItem=function(item,itemNumber){var attachImage=false,imageUrl="",entityName="";if(this.props.dataContext.get_IsInteractionCentricLookup()){var firstItem=item.get_ChildViewModels()[this.FIRST_ITEM_LABEL];entityName=firstItem.get_ModelContext().get_ModelName();var objectTypeCode=item.GetObjectTypeCode(entityName);if(objectTypeCode){attachImage=true;var objectTypeCodeValue=item.IsCustomEntity(entityName)?"customEntity":objectTypeCode.toString();imageUrl="/_imgs/ico_16_"+objectTypeCodeValue+".gif"}}var itemDescriptor=this.props.listItemDescriptor||this.props.descriptor.Properties["ListItemDescriptor"];if(this.props.descriptor.Properties["ListItemControlViewDescriptors"])itemDescriptor=this.props.descriptor.Properties["ListItemControlViewDescriptors"][item.get_PrimaryModelName()];var listItem=ListItem.ListItem({key:item.get_ViewModelId(),clientContext:this.props.clientContext,dataContext:item,descriptor:itemDescriptor,parentList:this.props.dataContext,className:this.props.listItemClassName,wrapperComponent:this.props.listItemWrapperComponent,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,itemRenderer:this.props.listItemRenderer,isInteractionCentricMultiSourceLookup:this.isMultiSourceInteractionCentricLookup(),isInteractionCentricLookup:this.props.dataContext.get_IsInteractionCentricLookup(),itemNumber:itemNumber,onKeyDown:this.props.onKeyDown,handlerForLookup:this.props.handlerForLookup,forceUpdate:true});if(attachImage)return React.DOM.div({key:item.get_ViewModelId(),className:"listItemWrapper"},React.DOM.img({className:"entityIcon",src:imageUrl,alt:entityName}),listItem);else return listItem};ListSpec.prototype.renderRecords=function(){var results=[];if(!this.props.dataContext||!this.props.dataContext.get_Items())return results;var itemsCollection=this.props.dataContext.get_Items();if(!itemsCollection)return results;for(var itemsCount=itemsCollection.get_Count(),i=0;i<itemsCount;i++){var item=itemsCollection.getItem(i),sortedItemsCollection=this.props.dataContext.get_SortedItems();if(this.props.dataContext.get_IsSortable()&&sortedItemsCollection){sortedItemsCollection=sortedItemsCollection.get_Items();item=sortedItemsCollection[i]}var component=this.renderItem(item,i);results.push(component)}if(this.props.dataContext&&this.props.dataContext.get_IsSortable()){var wrapper=this.createSortableWrapper(results);results=[wrapper]}return results};ListSpec.prototype.renderScrollRegionWrapperInterceptor=function(factory,props,children){return React.DOM.div({key:"dialogWrappedScrollRegion",className:"scrollRegion-dialogWrapped"},factory(props,children))};ListSpec.prototype.render=function(){var children=[],beforeContent=[];if(this.props.beforeContentRenderer)beforeContent=this.props.beforeContentRenderer();children.push(ListLoadingBar({key:"loading",clientContext:this.props.clientContext,dataContext:this.props.dataContext}));!this.props.dataContext.get_HideDraftsMessage()&&!this.props.dataContext.get_IsEntityAvailable()&&children.push(this.renderDraftsMessage());var loadedWithNoRecords=!this.props.dataContext.get_IsLoading()&&this.props.dataContext.get_Items().get_Count()===0;if(!this.props.dataContext.get_IsEntityAvailable())children.push(this.renderNoRecords());else if(this.props.dataContext.get_HasError())children.push(this.renderError());else if(this.props.descriptor)if(loadedWithNoRecords&&!this.props.useExtraContentRenderersWithNoRecords)children.push(this.renderNoRecords());else{if(this.props.beforeContentRenderer)children=children.concat(beforeContent);loadedWithNoRecords&&children.push(this.renderNoRecords());this.props.preRecordsMessage!==null&&this.props.preRecordsMessage!==undefined&&children.push(this.renderPreRecordsMessage());var records=this.renderRecords();if(this.props.containerRenderer)children.push(this.props.containerRenderer(records));else children=children.concat(records);this.props.afterContentRenderer&&children.push(this.props.afterContentRenderer())}!this.props.dataContext.get_IsServerAvailable()&&this.props.dataContext.get_IsEntityAvailable()&&children.push(this.renderOfflineMessage());var className=CssClassSet({selectedState:this.props.dataContext.get_SelectedItem()?true:false},this.props.listClassName);if(this.props.descriptor&&this.props.descriptor.Properties&&"HasScrollRegion" in this.props.descriptor.Properties&&!this.props.descriptor.Properties["HasScrollRegion"])return React.DOM.div({key:this.props.viewModelId,className:className,style:this.props.style,"data-vmid":this.props.viewModelId},children);else{var root=this.props.dataContext.get_Root();return ScrollRegion.ScrollRegion({key:this.props.viewModelId,className:className,onScrollEnd:this.props.handleScrollEnd,style:this.props.style,scrollState:this.props.dataContext,viewModelId:this.props.viewModelId,forceUpdate:true,wrapperInterceptor:!this.props.clientContext.isInteractionCentric&&root&&root.get_ComponentTypeName()==="dialog"&&this.renderScrollRegionWrapperInterceptor},children)}};return ListSpec}(TsAdapter.SpecBase);exports.List=DataWrapperComponent.wrapComponent(new ListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/PinnedTilePlaceholder",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon","Core/Binding/UIHasRenderedMixin"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon,UIHasRendered){var PinnedTilePlaceholderSpec=function(_super){__extends(PinnedTilePlaceholderSpec,_super);function PinnedTilePlaceholderSpec(){_super.apply(this,arguments);this.displayName="PinnedTilePlaceholder";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["TilePlaceholderCurrentText"]}PinnedTilePlaceholderSpec.prototype.handlePlacerHolderTileClick=function(){this.props.dataContext&&this.props.dataContext.changeText()};PinnedTilePlaceholderSpec.prototype.render=function(){var children=[React.DOM.span({key:"placeholderTileText",className:"placeholderTileText"},this.props.dataContext.get_TilePlaceholderCurrentText()),FontIcon.FontIcon({key:"clickSymbol",symbolName:"HandClick",className:"placeholderTileSymbol"})];return React.DOM.div({className:"crmtile tilewide placeholderTile",onClick:this.handlePlacerHolderTileClick,"data-vmid":this.props.dataContext.get_ViewModelId()},children)};return PinnedTilePlaceholderSpec}(TsAdapter.SpecBase);exports.PinnedTilePlaceholder=DataWrapperComponent.wrapComponent(new PinnedTilePlaceholderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/PinnedTileList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Components/Lists/List","Components/Lists/PinnedTilePlaceholder","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,List,PinnedTilePlaceholder,CssClassSet){exports.DESCRIPTOR_NAME="CrmTileContainer";var PinnedTileListSpec=function(_super){__extends(PinnedTileListSpec,_super);function PinnedTileListSpec(){_super.apply(this,arguments);this.displayName="PinnedTileList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin];this.listenToProperties=["Items"];this.listenToCollections=["Items"]}PinnedTileListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};PinnedTileListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};PinnedTileListSpec.prototype.render=function(){if(this.props.dataContext.get_RenderPlaceholder())return PinnedTilePlaceholder.PinnedTilePlaceholder({dataContext:this.props.dataContext,clientContext:this.props.clientContext});else if(this.props.dataContext.get_RenderTiles()){var listProps={listClassName:CssClassSet({listRoot:true,crmTiles:true,listView:true}),key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,viewModelId:this.props.dataContext.get_ViewModelId()};return List.List(listProps)}else return React.DOM.noscript()};return PinnedTileListSpec}(TsAdapter.SpecBase);exports.PinnedTileList=DataWrapperComponent.wrapComponent(new PinnedTileListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/InteractBarListHeaderTitle",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){var InteractBarListHeaderTitleSpec=function(_super){__extends(InteractBarListHeaderTitleSpec,_super);function InteractBarListHeaderTitleSpec(){_super.apply(this,arguments);this.displayName="InteractBarListHeaderTitle";this.listenToProperties=["Title","GridEnabled"]}InteractBarListHeaderTitleSpec.prototype.handleHeaderTextShortPress=function(e){if(this.props.dataContext.get_GridEnabled()&&!this.props.clientContext.isPhone)this.props.dataContext.get_OpenGridCommand().execute();else this.props.dataContext.get_GridEnabled()&&this.props.dataContext.get_IsStackingEnabled()&&this.props.dataContext.get_IsHalfHeight()&&this.props.dataContext.get_OpenGridCommand().execute();e.stopPropagation();e.preventDefault()};InteractBarListHeaderTitleSpec.prototype.handleHeaderTextLongPress=function(e){if(!this.props.dataContext.get_DisableHeaderLongPress()){this.props.clientContext.applicationShellViewModel.clearSelectedViewModels();this.props.dataContext.set_IsSelected(true)}};InteractBarListHeaderTitleSpec.prototype.render=function(){return React.DOM.span({className:CssClassSet({listViewName:true,noDrillDown:!this.props.dataContext.get_GridEnabled(),truncatedListHeader:this.props.truncateHeader}),onShortPress:this.props.clientContext.isPreview?null:this.handleHeaderTextShortPress,onLongPress:this.props.clientContext.isPreview?null:this.handleHeaderTextLongPress},this.props.dataContext.get_Title())};return InteractBarListHeaderTitleSpec}(TsAdapter.SpecBase);exports.InteractBarListHeaderTitle=DataWrapperComponent.wrapComponent(new InteractBarListHeaderTitleSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/InteractBarListHeaderAddButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,IXUD){var InteractBarListHeaderAddButtonSpec=function(_super){__extends(InteractBarListHeaderAddButtonSpec,_super);function InteractBarListHeaderAddButtonSpec(){_super.apply(this,arguments);this.displayName="InteractBarListHeaderAddButton";this.mixins=[IXUD.Mixin];this.listenToProperties=["CanExecute"]}InteractBarListHeaderAddButtonSpec.prototype.render=function(){return ImageButton.ImageButton({imageType:"Symbol",imageName:"Add",hidden:!this.props.dataContext.get_CanExecute(),enabled:this.props.dataContext.get_CanExecute(),title:this.props.title,tabIndex:this.props.tabIndex,onClick:this.props.onClick,dataId:"AddNew"})};InteractBarListHeaderAddButtonSpec.prototype.getProperties=function(){var properties={};if(this.props.dataContext.get_PrimaryModelName())properties["id"]="AddNew_"+this.props.dataContext.get_PrimaryModelName();return properties};return InteractBarListHeaderAddButtonSpec}(TsAdapter.SpecBase);exports.InteractBarListHeaderAddButton=DataWrapperComponent.wrapComponent(new InteractBarListHeaderAddButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/InteractBarListHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/ComponentUpdateRequestManager","Components/Lists/InteractBarListHeaderTitle","Components/Primitives/Button","Components/Lists/InteractBarListHeaderAddButton","Components/Common/FlyOutButton","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentUpdateRequestManager,InteractBarListHeaderTitle,Button,InteractBarListHeaderAddButton,FlyOutButton,CssClassSet){var MOUNT_ID_PREFIX="ListHeader_",InteractBarListHeaderSpec=function(_super){__extends(InteractBarListHeaderSpec,_super);function InteractBarListHeaderSpec(){_super.apply(this,arguments);this.displayName="InteractBarListHeader";this.listenToProperties=["AddCommand","AddExistingCommand","IsSelected","OpenGridCommand","RelationshipName","CreateFormType","ShouldHideAddButton"]}InteractBarListHeaderSpec.prototype.getAddCommand=function(){if(!this.props.dataContext.get_RelationshipName()||this.props.dataContext.get_CreateFormType()===14)return this.props.dataContext.get_AddCommand();return this.props.dataContext.get_AddExistingCommand()};InteractBarListHeaderSpec.prototype.updateParentIdOnAddCommand=function(){var addCommand=this.getAddCommand(),parameterizedAddCommand=addCommand;if(parameterizedAddCommand&&parameterizedAddCommand.get_ExternalParameters)parameterizedAddCommand.get_ExternalParameters()["ParentId"]=this.inlineFormMountId};InteractBarListHeaderSpec.prototype.handleAddClick=function(e){this.props.dataContext.getAndExecuteSubgridAddCommand();e.preventDefault();e.stopPropagation()};InteractBarListHeaderSpec.prototype.handlePlaceHolderTextClick=function(e){if(!this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded()){this.props.clientContext.applicationShellViewModel.set_NoteInlineCreateFormExpanded(true);this.props.dataContext.executeNoteInlineCreateCommand();e.preventDefault();e.stopPropagation()}};InteractBarListHeaderSpec.prototype.componentDidMount=function(){this.updateParentIdOnAddCommand();this.props.dataContext.get_IsNoteListHeader()&&this.props.clientContext.applicationShellViewModel.apcl("NoteInlineCreateFormExpanded",this.onNoteInlineCreateFormExpandedChanged)};InteractBarListHeaderSpec.prototype.componentDidUpdate=function(){this.updateParentIdOnAddCommand()};InteractBarListHeaderSpec.prototype.componentWillUnmount=function(){this.props.dataContext.get_IsNoteListHeader()&&this.props.clientContext.applicationShellViewModel.rpcl("NoteInlineCreateFormExpanded",this.onNoteInlineCreateFormExpandedChanged)};InteractBarListHeaderSpec.prototype.onNoteInlineCreateFormExpandedChanged=function(){this.requestRender("InteractBarListHeader requesting a render via onNoteInlineCreateFormExpandedChanged()")};InteractBarListHeaderSpec.prototype.requestRender=function(reason){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);this.updateManager.requestUpdate(reason)};InteractBarListHeaderSpec.prototype.renderAddFlyOutButton=function(){var childViewModels=this.props.dataContext&&this.props.dataContext.get_ChildViewModels(),childViewDescriptors=this.props.descriptor&&this.props.descriptor.ChildControlViewDescriptors;if(childViewModels&&childViewDescriptors){var topMenuViewModel=childViewModels["TopMenu"],topMenuDescriptor=childViewDescriptors["TopMenu"];if(topMenuViewModel)return FlyOutButton.FlyOutButton({key:"add",clientContext:this.props.clientContext,dataContext:topMenuViewModel,descriptor:topMenuDescriptor,buttonClassName:"flyoutTopMenuButton",imageType:"Symbol",imageName:"Add",flyOutPositioning:FlyOutButton.FlyOutPositioning.External,containerDataId:"AddNew",tabIndex:this.props.tabIndex!=undefined?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),title:this.props.dataContext.get_AddRecordTooltipText(),stopClickPropagation:true})}return null};InteractBarListHeaderSpec.prototype.renderAddButton=function(){var addCommand=this.getAddCommand();if(addCommand)return InteractBarListHeaderAddButton.InteractBarListHeaderAddButton({key:"add",clientContext:this.props.clientContext,dataContext:addCommand,title:this.props.dataContext.get_AddRecordTooltipText(),tabIndex:this.props.tabIndex!=undefined?this.props.tabIndex:this.props.dataContext.get_NextTabIndex(),dataId:"AddNew",onClick:this.handleAddClick});return null};InteractBarListHeaderSpec.prototype.render=function(){var noteInlineCreateFormExpanded=this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded();if(!this.inlineFormMountId)this.inlineFormMountId=MOUNT_ID_PREFIX+this.props.dataContext.get_ViewModelId();var children=[];!this.props.hideViewName&&children.push(InteractBarListHeaderTitle.InteractBarListHeaderTitle({key:"name",clientContext:this.props.clientContext,dataContext:this.props.dataContext,truncateHeader:this.props.truncateHeader}));this.props.afterHeaderContentRenderer&&children.push(this.props.afterHeaderContentRenderer());if(!this.props.clientContext.isPreview&&!this.props.dataContext.get_ShouldHideAddButton()&&!(this.props.dataContext.get_IsNoteListHeader()&&noteInlineCreateFormExpanded)){var addButton=this.props.dataContext.get_TopMenuEnabled()?this.renderAddFlyOutButton():this.renderAddButton();addButton&&children.push(addButton)}var listHeaderControl=[];listHeaderControl.push(React.DOM.div({key:"interactBar",className:CssClassSet({subGridAddOnly:this.props.hideViewName},"listComponentView-interactBar")},children));if(this.props.dataContext.get_IsNoteListHeader()&&!noteInlineCreateFormExpanded){listHeaderControl.push(React.DOM.div({key:"noteinlinelistheaderborder",className:"noteinlinelistheaderborder"}));listHeaderControl.push(Button.Button({key:"notetextplaceholder",className:"noteTextPlaceHolder",onClick:this.handlePlaceHolderTextClick},React.DOM.div({key:"notetextplaceholdercontent",className:"noteTextPlaceHolderContent"},this.props.dataContext.get_NotePlaceHolderText())))}return React.DOM.div({className:"listHeader",id:this.inlineFormMountId},listHeaderControl)};return InteractBarListHeaderSpec}(TsAdapter.SpecBase);exports.InteractBarListHeader=DataWrapperComponent.wrapComponent(new InteractBarListHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/InteractBarListHeaderWithCounter",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lists/InteractBarListHeader"],function(require,exports,TsAdapter,DataWrapperComponent,InteractBarListHeader){var InteractBarListHeaderWithCounterSpec=function(_super){__extends(InteractBarListHeaderWithCounterSpec,_super);function InteractBarListHeaderWithCounterSpec(){_super.apply(this,arguments);this.displayName="InteractBarListHeaderWithCounter";this.listenToCollections=["Items"];this.listenToProperties=["RecordCount","ListComponentModel"]}InteractBarListHeaderWithCounterSpec.prototype.recordCount=function(){var headerValue=0,listComponentModel=this.props.dataContext.get_ListComponentModel(),listRecordCollectionModel=listComponentModel;if(listRecordCollectionModel&&listRecordCollectionModel.get_EntityCollection&&listRecordCollectionModel.get_EntityCollection())headerValue=listRecordCollectionModel.get_EntityCollection().get_TotalRecordCount();else headerValue=this.props.dataContext.get_RecordCount();headerValue=headerValue<0?0:headerValue;return headerValue};InteractBarListHeaderWithCounterSpec.prototype.renderCounter=function(){var headerValue=this.recordCount(),header=this.props.dataContext.formatRecordCount(headerValue);return React.DOM.span({key:"counter",className:"listViewHeader"},header)};InteractBarListHeaderWithCounterSpec.prototype.render=function(){return InteractBarListHeader.InteractBarListHeader({key:"header",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,afterHeaderContentRenderer:this.renderCounter,recordCount:this.recordCount(),truncateHeader:this.props.truncateHeader})};return InteractBarListHeaderWithCounterSpec}(TsAdapter.SpecBase);exports.InteractBarListHeaderWithCounter=DataWrapperComponent.wrapComponent(new InteractBarListHeaderWithCounterSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/PagedList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Components/Primitives/ProgressIndicator","Components/Lists/ListItem","Components/Lists/List"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ProgressIndicator,ListItem,List){var PagedListSpec=function(_super){__extends(PagedListSpec,_super);function PagedListSpec(){_super.apply(this,arguments);this.displayName="PagedList";this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["IsLoadingNextPage","IsLoadingPreviousPage"];this.scrollPagingTriggerPadding=5;this.loadingIconHeight=32;this.componentDidUpdateCallback=null}PagedListSpec.prototype.configureEventListeners=function(){return {NextPageLoadCompleted:this.handleNextPageLoadCompleted,PreviousPageLoadCompleted:this.handlePreviousPageLoadCompleted}};PagedListSpec.prototype.componentDidUpdate=function(){if(this.componentDidUpdateCallback){this.componentDidUpdateCallback();this.componentDidUpdateCallback=null}};PagedListSpec.prototype.isScrollTopHit=function(e){var scrollTarget=this.scrollPagingTriggerPadding+this.loadingIconHeight;return e.scrollTop<=scrollTarget};PagedListSpec.prototype.isScrollBottomHit=function(e){var scrollBottom=e.scrollTop+e.scrollContentHeight,scrollTarget=e.scrollHeight-this.scrollPagingTriggerPadding-this.loadingIconHeight;return scrollBottom>=scrollTarget};PagedListSpec.prototype.handleNextPageLoadCompleted=function(){var _this=this,itemsLoaded=this.props.dataContext.get_ItemsLoaded();if(this.props.dataContext.get_PagingInfo().get_MorePreviousPage())this.componentDidUpdateCallback=function(){var listNode=ReactDOM.findDOMNode(_this),lastListItem=$(listNode).find("."+ListItem.LIST_ITEM_CSS_CLASS).last(),listItemHeight=lastListItem.outerHeight(true),scrollRegionNode=ReactDOM.findDOMNode(_this),scrollRegionHeight=$(scrollRegionNode).innerHeight(),scrollRegionScrollHeight=scrollRegionNode.scrollHeight,offset=scrollRegionScrollHeight-scrollRegionHeight-listItemHeight*(itemsLoaded-1)-_this.loadingIconHeight;scrollRegionNode.scrollTop=offset}};PagedListSpec.prototype.handlePreviousPageLoadCompleted=function(){var _this=this,itemsLoaded=this.props.dataContext.get_ItemsLoaded();this.componentDidUpdateCallback=function(){var listNode=ReactDOM.findDOMNode(_this),firstListItem=$(listNode).find("."+ListItem.LIST_ITEM_CSS_CLASS).first(),listItemHeight=firstListItem.outerHeight(true),scrollRegionNode=ReactDOM.findDOMNode(_this);scrollRegionNode.scrollTop=listItemHeight*(itemsLoaded-1)+_this.loadingIconHeight}};PagedListSpec.prototype.handleScrollEnd=function(e){var fetchCommand=null,pagingInfo=this.props.dataContext.get_PagingInfo();if(pagingInfo&&pagingInfo.get_MoreNextPage()&&this.isScrollBottomHit(e))fetchCommand=this.props.dataContext.get_LoadNextPageCommand();else if(pagingInfo&&pagingInfo.get_MorePreviousPage()&&this.isScrollTopHit(e))fetchCommand=this.props.dataContext.get_LoadPreviousPageCommand();fetchCommand&&fetchCommand.get_CanExecute()&&fetchCommand.execute()};PagedListSpec.prototype.renderNextPageProgressRing=function(){return ProgressIndicator.ProgressIndicator({key:"loadingNext",type:ProgressIndicator.ProgressIndicatorType.Ring,active:this.props.dataContext.get_IsLoadingNextPage(),className:"listComponentView_loadingIcon"})};PagedListSpec.prototype.renderPreviousPageProgressRing=function(){var children=[];if(this.props.beforeContentRenderer)children=children.concat(this.props.beforeContentRenderer());var progressIndicactor=ProgressIndicator.ProgressIndicator({key:"loadingPrevious",type:ProgressIndicator.ProgressIndicatorType.Ring,active:this.props.dataContext.get_IsLoadingPreviousPage(),className:"listComponentView_loadingIcon"});children.push(progressIndicactor);return children};PagedListSpec.prototype.render=function(){return List.List({listClassName:"listView",key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,listItemClassName:this.props.listItemClassName,listItemRenderer:this.props.listItemRenderer,listItemWrapperComponent:this.props.listItemWrapperComponent,beforeContentRenderer:this.renderPreviousPageProgressRing,afterContentRenderer:this.renderNextPageProgressRing,useExtraContentRenderersWithNoRecords:this.props.useExtraContentRenderersWithNoRecords,containerRenderer:this.props.containerRenderer,handleScrollEnd:this.handleScrollEnd,forceUpdate:true})};return PagedListSpec}(TsAdapter.SpecBase);exports.PagedList=DataWrapperComponent.wrapComponent(new PagedListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/MultilineList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Components/Lists/InteractBarListHeader","Components/Lists/InteractBarListHeaderWithCounter","Components/Lists/PagedList","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,InteractBarListHeader,InteractBarListHeaderWithCounter,PagedList,CssClassSet){exports.DESCRIPTOR_NAME="MultilineList";var MultilineListSpec=function(_super){__extends(MultilineListSpec,_super);function MultilineListSpec(){_super.apply(this,arguments);this.displayName="MultilineList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin];this.listenToProperties=["ViewModelId","PrimaryModelName","IsSelected"]}MultilineListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};MultilineListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};MultilineListSpec.prototype.renderListContainer=function(children){return React.DOM.div({key:"container",className:"SimpleListView"},this.props.containerRenderer?this.props.containerRenderer(children):children)};MultilineListSpec.prototype.renderHeader=function(){var truncateHeader=false;if(this.props.descriptor&&"TruncateHeader" in this.props.descriptor.Properties)truncateHeader=this.props.descriptor.Properties["TruncateHeader"];var showRecordCount=false;if(this.props.descriptor&&"ShowRecordCountInHeader" in this.props.descriptor.Properties)showRecordCount=this.props.descriptor.Properties["ShowRecordCountInHeader"];if(showRecordCount)return InteractBarListHeaderWithCounter.InteractBarListHeaderWithCounter({key:"header",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.state.viewDescriptor,truncateHeader:truncateHeader});else return InteractBarListHeader.InteractBarListHeader({key:"header",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.state.viewDescriptor,truncateHeader:truncateHeader})};MultilineListSpec.prototype.onLoadMoreButtonClick=function(){this.props.dataContext.handleLoadList()};MultilineListSpec.prototype.renderLoadMoreButton=function(){return React.DOM.a({key:"loadMoreButton",onClick:this.onLoadMoreButtonClick,className:"LoadMoreButton"},"...")};MultilineListSpec.prototype.render=function(){if(this.props.dataContext.get_HideEmailAttachmentSubGrid())return React.DOM.div({className:CssClassSet({"listRoot panoramaItem-control":true,customentity:this.props.dataContext.get_IsCustomEntity()},this.props.dataContext.get_PrimaryModelName()),"data-id":"GridHeader","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SourceId()},[]);var header=this.renderHeader(),pagedList=PagedList.PagedList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.state.viewDescriptor,containerRenderer:this.renderListContainer,beforeContentRenderer:this.props.beforeContentRenderer,useExtraContentRenderersWithNoRecords:this.props.useExtraContentRenderersWithNoRecords,listItemClassName:this.props.listItemClassName,listItemRenderer:this.props.listItemRenderer}),components=[header,pagedList];this.props.dataContext.get_IsTaskBasedFlow()&&components.push(this.renderLoadMoreButton());return React.DOM.div({className:CssClassSet({"listRoot panoramaItem-control":true,customentity:this.props.dataContext.get_IsCustomEntity()},this.props.dataContext.get_PrimaryModelName()),"data-id":"GridHeader","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SourceId()},components)};return MultilineListSpec}(TsAdapter.SpecBase);exports.MultilineList=DataWrapperComponent.wrapComponent(new MultilineListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/SelectableList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Components/Primitives/ImageCheckbox","Components/Lists/MultilineList","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,ImageCheckbox,MultilineList,CssClassSet){exports.DESCRIPTOR_NAME="SelectableList";var SelectableListSpec=function(_super){__extends(SelectableListSpec,_super);function SelectableListSpec(){_super.apply(this,arguments);this.displayName="SelectableList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin];this.listenToProperties=["ViewModelId","PrimaryModelName","IsSelected","Label"]}SelectableListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};SelectableListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};SelectableListSpec.prototype.listItemRenderer=function(item,childIndex,selectedMarkComponent,itemDataContext){var selected=itemDataContext.get_IsSelected();return React.DOM.div({className:CssClassSet({"selectableListItem-selected":selected,"selectableListItem-deselected":!selected},"selectableListItem"),key:childIndex.toString()},[ImageCheckbox.ImageCheckbox({key:childIndex.toString(),className:"imageCheckbox",enabled:true,checked:selected,onClick:function(){return itemDataContext.set_IsSelected(!selected)}}),item])};SelectableListSpec.prototype.render=function(){return MultilineList.MultilineList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,listItemRenderer:this.listItemRenderer})};return SelectableListSpec}(TsAdapter.SpecBase);exports.SelectableListSpec=SelectableListSpec;exports.SelectableList=DataWrapperComponent.wrapComponent(new SelectableListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Charts/Highchart",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var LEGEND_LINE_HEIGHT=26.63,CHARACTER_SIZE=5.6,DEFAULT_CHART_CATEGORY_NAME_LENGTH=15,CHART_LABEL_ADJUSTMENT_PADDING=35,HighchartSpec=function(_super){__extends(HighchartSpec,_super);function HighchartSpec(){_super.apply(this,arguments);this.displayName="Highchart";this.mixins=[PureUpdate.Mixin];this.seriesPointUnselectedTimeoutId=-1;this.initialSelectedPointTimeoutId=-1;this.chart=null}HighchartSpec.prototype.chartPointsIterator=function(predicate){var chart=this.chart;if(chart&&chart.series)for(var seriesIndex in chart.series){var series=chart.series[seriesIndex];if(series.data)for(var dataIndex in series.data)predicate(series.data[dataIndex])}};HighchartSpec.prototype.unselectAllElements=function(){this.chartPointsIterator(function(data){data.select(false,false)})};HighchartSpec.prototype.isAtLeastOneElementSelected=function(){var pointSelected=false;this.chartPointsIterator(function(data){if(data.selected)pointSelected=true});return pointSelected};HighchartSpec.prototype.selectPoint=function(dataPointToSelect){var _this=this,pointSelected=false;this.chartPointsIterator(function(data){if(_this.props.areSeriesPointsEqual(data,dataPointToSelect)){data.select(true,false);pointSelected=true}});if(!pointSelected){this.props.chartSeriesPointUnselected();this.currentSelectedPoint=this.props.selectedPoint()}};HighchartSpec.prototype.disposeCurrentChart=function(){this.props.config.HighchartSeriesPointClicked=null;this.props.config.HighchartSeriesPointSelected=null;this.props.config.HighchartSeriesPointUnselected=null;if(this.chart){$(this.chart).trigger("destroy");this.chart=null}var chartElement=this.refs["chart"];chartElement instanceof Element&&$(chartElement).unbind();if(this.seriesPointUnselectedTimeoutId!==-1){window.clearTimeout(this.seriesPointUnselectedTimeoutId);this.seriesPointUnselectedTimeoutId=-1}if(this.initialSelectedPointTimeoutId!==-1){window.clearTimeout(this.initialSelectedPointTimeoutId);this.initialSelectedPointTimeoutId=-1}this.currentSelectedPoint=null;this.currentChartConfig=null};HighchartSpec.prototype.getLegendHeightAdjustment=function(){var adjustment=0,series=this.props.config.series;if(series.length===1&&(series[0].type==="funnel"||series[0].type==="pie"))adjustment=LEGEND_LINE_HEIGHT*(series[0].data.length-1);else if(series.length>1)adjustment=LEGEND_LINE_HEIGHT*(series.length-1);var maxLengthCategoryName=this.props.config.CrmConfiguration["maxLengthCategoryName"];if(maxLengthCategoryName>0){if(maxLengthCategoryName<DEFAULT_CHART_CATEGORY_NAME_LENGTH)maxLengthCategoryName=DEFAULT_CHART_CATEGORY_NAME_LENGTH;var maxLabelPixelLength=CHART_LABEL_ADJUSTMENT_PADDING+maxLengthCategoryName*CHARACTER_SIZE;adjustment+=maxLabelPixelLength}else adjustment+=DEFAULT_CHART_CATEGORY_NAME_LENGTH*CHARACTER_SIZE;return adjustment};HighchartSpec.prototype.getAxisLabelsHeightAdjustment=function(){var yAxis=this.props.config.yAxis;if(yAxis.length<=0)return 0;var rotation=yAxis[0].labels.rotation;if(rotation!==90&&rotation!==270)return 0;for(var longestFormattedValue=0,i=0;i<this.props.config.series.length;i++)for(var seriesData=this.props.config.series[i].data,j=0;j<seriesData.length;j++){var data=seriesData[j],currentFormattedValue=data.FormattedValue?data.FormattedValue.length:data.y?data.y.toString().length:0;if(currentFormattedValue>longestFormattedValue)longestFormattedValue=currentFormattedValue}return CHARACTER_SIZE*longestFormattedValue};HighchartSpec.prototype.getHeightAdjustment=function(){return this.getAxisLabelsHeightAdjustment()+this.getLegendHeightAdjustment()};HighchartSpec.prototype.shouldHackSelection=function(){return this.props.config.series&&this.props.config.series.length>0&&(this.props.config.series[0].type==="funnel"||this.props.config.series[0].type==="column"||this.props.config.series[0].type==="bar")};HighchartSpec.prototype.forceUnselect=function(seriesPoint){var el=seriesPoint.graphic["element"];el.removeAttribute("stroke")};HighchartSpec.prototype.bringToFront=function(seriesPoint){var el=seriesPoint.graphic["element"];el.parentNode.removeAttribute("clip-path");el.parentNode.appendChild(el)};HighchartSpec.prototype.seriesPointUnselected=function(seriesPoint){var _this=this;this.shouldHackSelection()&&this.forceUnselect(seriesPoint);this.seriesPointUnselectedTimeoutId=window.setTimeout(function(){_this.isMounted()&&!_this.isAtLeastOneElementSelected()&&_this.props.chartSeriesPointUnselected()},50)};HighchartSpec.prototype.seriesPointSelected=function(seriesPoint){this.shouldHackSelection()&&this.bringToFront(seriesPoint);this.props.chartSeriesPointSelected(seriesPoint);this.currentSelectedPoint=this.props.selectedPoint()};HighchartSpec.prototype.seriesPointClicked=function(seriesPoint){this.props.chartSeriesPointClicked(seriesPoint);this.currentSelectedPoint=this.props.selectedPoint()};HighchartSpec.prototype.updateHighcharts=function(){var _this=this;window.clearTimeout(this.initialSelectedPointTimeoutId);window.clearTimeout(this.seriesPointUnselectedTimeoutId);this.initialSelectedPointTimeoutId=-1;this.seriesPointUnselectedTimeoutId=-1;this.disposeCurrentChart();this.currentChartConfig=this.props.config;if(!this.props.clientContext.isPreview)if(this.props.allowPointSelect){this.props.config.HighchartSeriesPointUnselected=this.seriesPointUnselected;this.props.config.HighchartSeriesPointSelected=this.seriesPointSelected}else this.props.config.HighchartSeriesPointClicked=this.seriesPointClicked;var chartNode=this.refs["chart"];this.props.config.chart.renderTo=chartNode;var heightAdjustment=this.getHeightAdjustment();this.props.config.chart.height=$(chartNode).height()||null;if(this.props.isFilterGraphContext){this.props.config.chart.backgroundColor="#000000";var chartType=this.props.config.series[0].type;switch(chartType){case "bar":this.props.config.chart.marginLeft=this.props.config.CrmConfiguration["maxLengthCategoryName"]+89;this.props.config.chart.marginBottom=9;break;case "column":case "line":case "area":this.props.config.chart.marginLeft=49;this.props.config.chart.marginBottom=this.props.config.CrmConfiguration["maxLengthCategoryName"]+49;break;case "pie":case "funnel":default:this.props.config.chart.marginLeft=9;this.props.config.chart.marginBottom=9;break}this.props.config.chart.marginRight=9;this.props.config.chart.marginTop=40;this.props.config.chart.spacingTop=0}else{this.props.config.chart.height=this.props.config.chart.height==null?null:this.props.config.chart.height+heightAdjustment;this.props.config.chart.marginBottom=heightAdjustment}var sw=this.props.clientContext.getPerformanceStopwatch("HighCharts.Render");sw.start();this.chart=new Highcharts.Chart(this.props.config);sw.stop();this.props.chartRendered();!this.props.clientContext.isPreview&&$(this.chart.container).click(function(e){var targetNode=e.target;if(targetNode&&targetNode===_this.chart.container||targetNode.parentNode&&targetNode.parentNode===_this.chart.container||targetNode.parentNode.parentNode&&targetNode.parentNode.parentNode===_this.chart.container)if(_this.props.allowPointSelect)_this.unselectAllElements();else _this.seriesPointClicked(null)});var selectedPoint=this.props.selectedPoint();if(this.props.allowPointSelect&&selectedPoint){var delayLength=0;if(this.props.config.series!=null&&this.props.config.series.length>0&&this.props.config.series[0].type=="pie")delayLength=1e3;this.initialSelectedPointTimeoutId=window.setTimeout(function(){_this.isMounted()&&_this.selectPoint(selectedPoint)},delayLength)}};HighchartSpec.prototype.getDefaultProps=function(){return {isFilterGraphContext:false}};HighchartSpec.prototype.componentDidMount=function(){this.updateHighcharts()};HighchartSpec.prototype.componentDidUpdate=function(){var selectedPointChanged=(!!this.currentSelectedPoint||!!this.props.selectedPoint())&&!this.props.areSeriesPointsEqual(this.currentSelectedPoint,this.props.selectedPoint());(selectedPointChanged||this.currentChartConfig!==this.props.config||this.props.isFilterGraphContext)&&this.updateHighcharts()};HighchartSpec.prototype.componentWillUnmount=function(){this.disposeCurrentChart()};HighchartSpec.prototype.render=function(){return React.DOM.div({className:"chartGraphicsContainer",ref:"chart"})};return HighchartSpec}(TsAdapter.SpecBase);exports.Highchart=TsAdapter.createComponent(new HighchartSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Charts/Chart",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/Common/LoadingBar","Components/Charts/Highchart"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,LoadingBar,Highchart){var ChartLoadingBar=LoadingBar.createLoadingBar("IsLoading",true);exports.DESCRIPTOR_NAME="Application_Framework_Chart_Chart";var ChartSpec=function(_super){__extends(ChartSpec,_super);function ChartSpec(){_super.apply(this,arguments);this.displayName="Chart";this.mixins=[IXUD.Mixin];this.listenToProperties=["AllowPointSelect","ChartConfigObject","DisplayMode","ErrorInformation","SavedQueryId","SavedQueryVisualizationId","IsLoading","ViewModelId"]}ChartSpec.prototype.chartSeriesPointUnselected=function(){this.props.dataContext.set_SelectedHighchartPoint(null);this.props.dataContext.executeSeriesClickCommand(null);this.props.clientContext.isPhone&&this.props.dataContext.set_ShowData(true)};ChartSpec.prototype.chartSeriesPointSelected=function(seriesPoint){this.props.dataContext.set_SelectedHighchartPoint(seriesPoint);this.props.dataContext.executeSeriesClickCommand(seriesPoint);this.props.clientContext.isPhone&&this.props.dataContext.set_ShowData(true)};ChartSpec.prototype.getProperties=function(){var properties={};properties["id"]=this.props.descriptor.Properties["ControlId"];return properties};ChartSpec.prototype.chartSeriesPointClicked=function(seriesPoint){this.props.dataContext.set_SelectedHighchartPoint(null);this.props.dataContext.executeSeriesClickCommand(seriesPoint)};ChartSpec.prototype.chartRendered=function(){this.props.dataContext&&this.props.dataContext.UIHasRendered()};ChartSpec.prototype.renderErrorContainer=function(){var errorInfo=this.props.dataContext.get_ErrorInformation(),errorType=errorInfo.get_ErrorType(),children=[];errorType&&errorType.trim().length>0&&children.push(React.DOM.div({key:"type",className:"chartErrorMessageType",id:"chartErrorMessageType"},errorType));children.push(React.DOM.div({key:"description",className:"chartErrorMessageDescription",id:"chartErrorMessageDescription"},errorInfo.get_ErrorDescription()));return React.DOM.div({key:"error",className:"chartErrorMessageContainer",id:"chartErrorMessageContainer"},children)};ChartSpec.prototype.handleScroll=function(e){e.stopPropagation()};ChartSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var children=[];children.push(ChartLoadingBar({key:"loading",clientContext:this.props.clientContext,dataContext:this.props.dataContext}));if(this.props.dataContext.get_DisplayMode()===1)children.push(this.renderErrorContainer());else!this.props.dataContext.get_IsLoading()&&this.props.dataContext.get_ChartConfigObject()&&children.push(Highchart.Highchart({key:"chart",config:this.props.dataContext.get_ChartConfigObject(),clientContext:this.props.clientContext,allowPointSelect:this.props.dataContext.get_AllowPointSelect(),selectedPoint:this.props.dataContext.get_SelectedHighchartPoint.bind(this.props.dataContext),chartSeriesPointUnselected:this.chartSeriesPointUnselected,chartSeriesPointSelected:this.chartSeriesPointSelected,chartSeriesPointClicked:this.chartSeriesPointClicked,chartRendered:this.chartRendered,areSeriesPointsEqual:this.props.dataContext.areSeriesPointsEqual.bind(this.props.dataContext)}));return React.DOM.div({className:"chartContainer","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SavedQueryId(),"data-visualizationid":this.props.dataContext.get_SavedQueryVisualizationId(),onScroll:this.handleScroll},children)};return ChartSpec}(TsAdapter.SpecBase);exports.Chart=DataWrapperComponent.wrapComponent(new ChartSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Charts/ChartDrilldown",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Utils/CssClassSet","Components/Panorama/PanoramaContainer"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,CssClassSet,PanoramaContainer){exports.DESCRIPTOR_NAME="CrmChartDrilldown";var ChartDrilldownSpec=function(_super){__extends(ChartDrilldownSpec,_super);function ChartDrilldownSpec(){_super.apply(this,arguments);this.displayName="ChartDrilldown";this.listenToProperties=["ListControlViewModel","ChartControlViewModel"]}ChartDrilldownSpec.prototype.renderPanoramaItemContainer=function(children){return React.DOM.div({key:"drillDownContainer",className:CssClassSet({drillDownContainer:true})},children)};ChartDrilldownSpec.prototype.renderPhonelayout=function(chartDrilldownContent){return PanoramaContainer.PanoramaContainer({key:"pcdrilldown",className:"drilldown-panoramaContainer",initialParentHeight:this.props.initialParentHeight,dataContext:this.props.dataContext,clientContext:this.props.clientContext,descriptor:this.props.descriptor,containerRenderer:this.renderPanoramaItemContainer})};ChartDrilldownSpec.prototype.renderTabletlayout=function(chartDrilldownContent){return React.DOM.div({key:"drillDownContainer",className:CssClassSet({drillDownContainer:true,chrome:this.props.clientContext.userAgent.get_IsBrowserChrome()})},chartDrilldownContent)};ChartDrilldownSpec.prototype.render=function(){var isPhone=this.props.clientContext.isPhone,chartDrilldownContent=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext);if(isPhone)return this.renderPhonelayout(chartDrilldownContent);else return this.renderTabletlayout(chartDrilldownContent)};return ChartDrilldownSpec}(TsAdapter.SpecBase);exports.ChartDrilldown=DataWrapperComponent.wrapComponent(new ChartDrilldownSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridHeaderItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,IXUD){var GridHeaderItemSpec=function(_super){__extends(GridHeaderItemSpec,_super);function GridHeaderItemSpec(){_super.apply(this,arguments);this.displayName="GridHeaderItem";this.mixins=[PureUpdate.Mixin,IXUD.Mixin]}GridHeaderItemSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.gridHeader;properties["id"]=this.props.descriptor.Properties["name"];properties["parentId"]=XrmUI.UIControlType.grid;return properties};GridHeaderItemSpec.prototype.handleClick=function(e){if(this.props.dataContext.get_IsSortable()&&this.props.dataContext.get_IsColumnSortableInOffline()){var sortable=this.props.descriptor.Properties["Sortable"],sortByField=this.props.descriptor.Properties["name"];if(sortable&&sortByField){var sortingInfo=this.props.gridDataContext.get_SortingInfo(),sortDescending=false;if(sortingInfo.get_SortByField()===sortByField)sortDescending=!sortingInfo.get_SortDescending();this.props.gridDataContext.setSortOrder(sortByField,sortDescending)}}};GridHeaderItemSpec.prototype.render=function(){var child=React.Children.only(this.props.children),sortingInfo=this.props.gridDataContext.get_SortingInfo(),sortAscending=false,sortDescending=false,dataId=null,cellChildren=[child];if(this.props.descriptor){var metadataName=this.props.descriptor.Properties["name"];if(sortingInfo.get_SortByField()===metadataName)if(sortingInfo.get_SortDescending()){sortDescending=true;dataId="descending"}else{sortAscending=true;dataId="ascending"}(sortAscending||sortDescending)&&cellChildren.push(React.DOM.div({key:"sortArrow",className:"headerRow-sortArrow"}))}var width=this.props.columnWidth;if(!width&&this.props.dataContext.get_Width)width=parseInt(this.props.dataContext.get_Width(),10);return React.DOM.th({tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_NextTabIndex():null,style:{width:width,minWidth:width,maxWidth:width},className:CssClassSet({"headerRow-sortDescending":sortDescending,"headerRow-sortAscending":sortAscending}),"data-id":dataId,"data-fieldname":this.props.descriptor.Properties["name"],onClick:this.handleClick},cellChildren)};return GridHeaderItemSpec}(TsAdapter.SpecBase);exports.GridHeaderItem=TsAdapter.createComponent(new GridHeaderItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridDragHandle",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){exports.IGNORE_CLICK_CLASS_NAME="noclick";var GridDragHandleSpec=function(_super){__extends(GridDragHandleSpec,_super);function GridDragHandleSpec(){_super.apply(this,arguments);this.displayName="GridDragHandle";this.mixins=[PureUpdate.Mixin]}GridDragHandleSpec.prototype.handleDragStart=function(e,ui){document.body.classList.add(exports.IGNORE_CLICK_CLASS_NAME);e.stopImmediatePropagation();this.previousX=Math.floor(ui.offset.left);return true};GridDragHandleSpec.prototype.handleDragStop=function(e,ui){window.setTimeout(function(){document.body.classList.remove(exports.IGNORE_CLICK_CLASS_NAME)},0);e.stopImmediatePropagation();var newX=Math.floor(ui.offset.left),delta=newX-this.previousX;this.props.onResize&&this.props.onResize(this.props.columnIndex,delta);return true};GridDragHandleSpec.prototype.componentDidMount=function(){var node=$(ReactDOM.findDOMNode(this));node.draggable({axis:"x",revert:true,revertDuration:0,start:this.handleDragStart,stop:this.handleDragStop});this.props.clientContext.mapTouchEvents(node)};GridDragHandleSpec.prototype.componentWillUnmount=function(){var node=$(ReactDOM.findDOMNode(this));node.draggable("destroy");node.unbind()};GridDragHandleSpec.prototype.render=function(){return React.DOM.span({key:"image",style:{position:"relative"},className:"symbolFont ResizeHandle-symbol handleRow"})};return GridDragHandleSpec}(TsAdapter.SpecBase);exports.GridDragHandle=TsAdapter.createComponent(new GridDragHandleSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Components/ComponentFactory","Components/Grids/GridHeaderItem","Components/Grids/GridDragHandle","Components/Shell/Conductor","Core/Binding/WindowResizeHandlerMixin","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,ComponentFactory,GridHeaderItem,GridDragHandle,Conductor,WindowResizeHandler,IXUD){exports.CELL_BORDER_AND_PADDING=21;exports.HEADER_MARGIN=17;var OUTER_PADDING=29,GridHeaderSpec=function(_super){__extends(GridHeaderSpec,_super);function GridHeaderSpec(){_super.apply(this,arguments);this.displayName="GridHeader";this.mixins=[CustomEventsListener.Mixin,IXUD.Mixin];this.listenToProperties=["Name","SortingInfo","HideTitle"]}GridHeaderSpec.prototype.configureEventListeners=function(){return {ResizeHandlesToggled:this.handleResizeHandlesToggled}};GridHeaderSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.gridHeader;properties["parentId"]=XrmUI.UIControlType.grid;return properties};GridHeaderSpec.prototype.isFixedWidthColumn=function(column){var fixedWidthColumns=this.props.dataContext.get_FixedWidthColumns();if(!column||!fixedWidthColumns)return false;for(var i=0;i<fixedWidthColumns.length;i++)if(fixedWidthColumns[i]===column.props.dataContext.get_Name())return true;return false};GridHeaderSpec.prototype.determineColumnSizes=function(){var headerRow=this.refs["headerRow"],rowWidth=$(headerRow).width(),componentType=this.props.dataContext.get_Root().get_ComponentType();if(!this.props.clientContext.isPhone&&componentType===17){var chartContainerWidth=$(".chartContainer").width(),flexBasis=rowWidth+chartContainerWidth,flexValue="0 0 {0}px;".replace("{0}",String(flexBasis));$(headerRow).parents(".drillDownPane").css("-webkit-box-flex",flexValue);$(headerRow).parents(".drillDownPane").css("-moz-box-flex",flexValue);$(headerRow).parents(".drillDownPane").css("-webkit-flex",flexValue);$(headerRow).parents(".drillDownPane").css("-ms-flex",flexValue);$(headerRow).parents(".drillDownPane").css("flex",flexValue)}if(!this.props.columnSizes&&this.props.onColumnSizesDetermined){var childCount=headerRow.children.length;if(childCount>0){for(var viewModel=this.props.dataContext.get_Header(),children=ComponentFactory.createChildComponents(viewModel,this.props.descriptor,this.props.clientContext),shellWidth=WindowResizeHandler.getWindowWidth(),columnSizes=[],fixedWidthColumnCount=this.props.dataContext.get_FixedWidthColumns()?this.props.dataContext.get_FixedWidthColumns().length:0,additionalWidthPerColumn=Math.max(0,Math.floor((shellWidth-rowWidth-OUTER_PADDING-Conductor.CONDUCTOR_LEFT_OFFSET)/(childCount-fixedWidthColumnCount))),i=0;i<childCount;i++){var header=headerRow.children[i],currentWidth=$(header).outerWidth();columnSizes[i]=currentWidth-exports.CELL_BORDER_AND_PADDING;if(!this.isFixedWidthColumn(children[i]))columnSizes[i]+=additionalWidthPerColumn}this.props.onColumnSizesDetermined(columnSizes)}}};GridHeaderSpec.prototype.getColumnSize=function(columnIndex){if(this.props.columnSizes&&columnIndex>=0&&columnIndex<this.props.columnSizes.length)return this.props.columnSizes[columnIndex];return 0};GridHeaderSpec.prototype.handleResizeHandlesToggled=function(){this.setState({handleRowVisible:!this.state.handleRowVisible})};GridHeaderSpec.prototype.handleColumnResized=function(columnIndex,delta){var columnSizes=this.props.columnSizes;if(columnIndex<0||columnIndex>=columnSizes.length)return;var previousSize=columnSizes[columnIndex],newSize=previousSize+delta;if(newSize<50)return;for(var newColumnSizes=[],i=0,len=columnSizes.length;i<len;i++)newColumnSizes[i]=i===columnIndex?newSize:columnSizes[i];this.props.dataContext.set_ColumnSizes(newColumnSizes)};GridHeaderSpec.prototype.handleBodyClick=function(e){if(document.body.classList.contains(GridDragHandle.IGNORE_CLICK_CLASS_NAME))return;var target=e.target;if($(target).closest(".ui-draggable").length!==0||target.className.substr(0,6)==="button")return;document.removeEventListener("click",this.handleBodyClick);this.setState({handleRowVisible:false})};GridHeaderSpec.prototype.getInitialState=function(){return {handleRowVisible:false}};GridHeaderSpec.prototype.componentDidMount=function(){this.determineColumnSizes()};GridHeaderSpec.prototype.componentDidUpdate=function(prevProps,prevState){this.determineColumnSizes();if(this.state.handleRowVisible!==prevState.handleRowVisible)if(this.state.handleRowVisible)document.addEventListener("click",this.handleBodyClick);else document.removeEventListener("click",this.handleBodyClick)};GridHeaderSpec.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.handleBodyClick)};GridHeaderSpec.prototype.renderTextHeader=function(){var styles={};if(this.props.dataContext.get_HideTitle())styles["display"]="none";var headerText=this.props.dataContext.get_Name();if(headerText==="Grid")headerText="";return React.DOM.span({key:"title",className:"gridHeader",style:styles},headerText)};GridHeaderSpec.prototype.renderTextSubHeader=function(){return this.props.dataContext.get_HideTitle()?null:React.DOM.div({key:"subTitle",className:"header-subtitle"},this.props.dataContext.get_PluralName())};GridHeaderSpec.prototype.renderTableHeaderColumns=function(){var columns=[];if(this.props.descriptor){var viewModel=this.props.dataContext.get_Header(),forceUpdate=this.props.dataContext.get_ForceHeaderUpdates();this.props.dataContext.set_ForceHeaderUpdates(false);for(var children=ComponentFactory.createChildComponents(viewModel,this.props.descriptor,this.props.clientContext),i=0,len=children.length;i<len;i++){var child=children[i];columns.push(GridHeaderItem.GridHeaderItem({key:i.toString(),clientContext:this.props.clientContext,dataContext:child.props.dataContext,descriptor:child.props.descriptor,gridDataContext:this.props.dataContext,columnWidth:this.getColumnSize(i),forceUpdate:forceUpdate},child))}}return columns};GridHeaderSpec.prototype.renderTableResizeHandlesRow=function(numColumns){var handles=[];if(this.state.handleRowVisible)for(var j=0;j<numColumns;j++){var handle=React.DOM.td({key:j.toString()},GridDragHandle.GridDragHandle({clientContext:this.props.clientContext,columnIndex:j,onResize:this.handleColumnResized}));handles.push(handle)}return React.DOM.tr({key:"handleRow",className:"handleRow"},handles)};GridHeaderSpec.prototype.renderTableHeader=function(){var columns=this.renderTableHeaderColumns(),headerRow=React.DOM.tr({key:"headerRow",ref:"headerRow",role:"option",className:"listItem listAsTable-HeaderRow","data-id":"TableHeader"},columns),handleRow=this.renderTableResizeHandlesRow(columns.length);return React.DOM.table({key:"table",className:"table_header","data-id":"tableHeader"},React.DOM.tbody({},[handleRow,headerRow]))};GridHeaderSpec.prototype.render=function(){var children=[];children.push(this.renderTextHeader());!this.props.clientContext.isMailApp&&!this.props.clientContext.isInteractionCentric&&children.push(this.renderTextSubHeader());children.push(this.renderTableHeader());return React.DOM.div({className:"listHeader hideExtraPadding"},children)};return GridHeaderSpec}(TsAdapter.SpecBase);exports.GridHeader=DataWrapperComponent.wrapComponent(new GridHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Components/Grids/GridHeader","Components/Lists/PagedList"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,RetrieveViewDescriptor,CustomEventsListener,GridHeader,PagedList){exports.DESCRIPTOR_NAME="Grid";var GridListSpec=function(_super){__extends(GridListSpec,_super);function GridListSpec(){_super.apply(this,arguments);this.displayName="GridList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin,IXUD.Mixin];this.listenToProperties=["ViewModelId","PrimaryModelName","IsSelected","ColumnSizes"]}GridListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};GridListSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.grid;return properties};GridListSpec.prototype.getInitialState=function(){return {defaultColumnSizes:null}};GridListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props);this.state.defaultColumnSizes&&this.setState({defaultColumnSizes:null})};GridListSpec.prototype.handleHeaderColumnSizesDetermined=function(columnSizes){this.setState({defaultColumnSizes:columnSizes})};GridListSpec.prototype.getColumnSizes=function(){var viewModelColumnSizes=this.props.dataContext.get_ColumnSizes();if(viewModelColumnSizes&&viewModelColumnSizes.length>0)return viewModelColumnSizes;return this.state.defaultColumnSizes};GridListSpec.prototype.getWidthStyleForColumn=function(columnIndex){var style={},columnSizes=this.getColumnSizes();if(columnSizes&&columnIndex>=0&&columnIndex<columnSizes.length)style["width"]=columnSizes[columnIndex];return style};GridListSpec.prototype.renderListContainer=function(children){return React.DOM.table({key:"container",className:"TabularView","data-id":"tableContent"},React.DOM.tbody(null,children))};GridListSpec.prototype.renderCell=function(item,childIndex,selectedMarkComponent){return React.DOM.td({key:item.props.parentGivenKey,style:this.getWidthStyleForColumn(childIndex)},item,selectedMarkComponent)};GridListSpec.prototype.render=function(){var headerDescriptor=this.state.viewDescriptor;if(headerDescriptor&&headerDescriptor.Properties)headerDescriptor=headerDescriptor.Properties["HeaderViewDescriptor"];var header=GridHeader.GridHeader({key:"header",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:headerDescriptor,columnSizes:this.getColumnSizes(),onColumnSizesDetermined:this.handleHeaderColumnSizesDetermined}),pagedList=PagedList.PagedList({key:"list",ref:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.state.viewDescriptor,containerRenderer:this.renderListContainer,listItemClassName:"listAsTable-Row",listItemWrapperComponent:React.DOM.tr,listItemRenderer:this.renderCell,forceUpdate:true});return React.DOM.div({className:"listRoot gridRoot panoramaItem-control "+this.props.dataContext.get_PrimaryModelName(),"data-id":"GridHeader","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SourceId()},[header,pagedList])};return GridListSpec}(TsAdapter.SpecBase);exports.GridList=DataWrapperComponent.wrapComponent(new GridListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Popup/InteractionCentricPopupItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Common/Constants"],function(require,exports,TsAdapter,PureUpdate,Constants){exports.DESCRIPTOR_NAME="InteractionCentricPopupItem";exports.lastItemInFocus;exports.shouldHidePopup;var InteractionCentricPopupItemSpec=function(_super){__extends(InteractionCentricPopupItemSpec,_super);function InteractionCentricPopupItemSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricPopupItem";this.mixins=[PureUpdate.Mixin]}InteractionCentricPopupItemSpec.prototype.handlePopupItemClick=function(){this.props.itemSelected(this.props.itemID)};InteractionCentricPopupItemSpec.prototype.handleOnFocusForItemWithArrow=function(e){exports.lastItemInFocus=$(e.currentTarget);if(exports.shouldHidePopup){exports.shouldHidePopup=false;this.hidePopup(e.currentTarget);this.focusOnParentDropDown(e.currentTarget,false)}};InteractionCentricPopupItemSpec.prototype.handleOnKeyDownForItemWithArrow=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:e.stopPropagation();case Constants.RIGHT_ARROW_KEY_CODE:this.handlePopupItemClick();break;case Constants.DOWN_ARROW_KEY_CODE:case Constants.UP_ARROW_KEY_CODE:e.preventDefault();var targetItem=e.currentTarget;targetItem=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?targetItem.nextSibling:targetItem.previousSibling;targetItem&&$(targetItem).focus();break;case Constants.TAB_KEY_CODE:e.preventDefault();case Constants.ESCAPE_KEY_CODE:this.hidePopup(e.currentTarget);this.focusOnParentDropDown(e.currentTarget,true);break}};InteractionCentricPopupItemSpec.prototype.handleOnKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.handlePopupItemClick();this.hidePopup(e.currentTarget);exports.shouldHidePopup=true;exports.lastItemInFocus!=null&&exports.lastItemInFocus.focus();break;case Constants.DOWN_ARROW_KEY_CODE:case Constants.UP_ARROW_KEY_CODE:e.preventDefault();var targetItem=e.currentTarget;targetItem=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?targetItem.nextSibling:targetItem.previousSibling;targetItem&&$(targetItem).focus();break;case Constants.TAB_KEY_CODE:e.preventDefault();exports.shouldHidePopup=true;case Constants.ESCAPE_KEY_CODE:this.hidePopup(e.currentTarget);exports.lastItemInFocus!=null&&exports.lastItemInFocus.focus();break}};InteractionCentricPopupItemSpec.prototype.hidePopup=function(element){var popup=$(element).closest(".interactionCentricPopup");this.props.onDismiss(popup)};InteractionCentricPopupItemSpec.prototype.focusOnParentDropDown=function(element,shouldUseTimeout){var itemToFocus=$(element).closest(".dashboardPicker.gridFlyout");if(itemToFocus[0]!=null)if(shouldUseTimeout&&this.props.isBrowserIE)setTimeout(function(){$(itemToFocus[0]).focus()},1);else $(itemToFocus[0]).focus()};InteractionCentricPopupItemSpec.prototype.renderItemWithArrowAndIcon=function(){var children=[];if(this.props.showIcon){var icon=React.DOM.div({key:"icon",className:this.props.iconClassName+" interactionCentricPopupItemIcon"});children.push(icon)}if(this.props.showArrow){var arrow=React.DOM.div({key:"arrow",className:"Arrow-symbol symbolFont interactionCentricPopupItemArrow"});children.push(arrow)}var item=React.DOM.div({key:"interactionCentricPopupItem",className:"interactionCentricPopupItem"},this.props.displayName);children.push(item);return React.DOM.div({className:"interactionCentricPopupItemContainer",onClick:this.handlePopupItemClick,tabIndex:this.props.tabIndex,onKeyDown:this.handleOnKeyDownForItemWithArrow,onFocus:this.handleOnFocusForItemWithArrow,title:this.props.displayName},children)};InteractionCentricPopupItemSpec.prototype.render=function(){if(this.props.showIcon||this.props.showArrow)return this.renderItemWithArrowAndIcon();var item=React.DOM.div({className:"interactionCentricPopupItem",onClick:this.handlePopupItemClick,title:this.props.displayName,tabIndex:this.props.tabIndex,onKeyDown:this.handleOnKeyDown},this.props.displayName);return item};return InteractionCentricPopupItemSpec}(TsAdapter.SpecBase);exports.InteractionCentricPopupItem=TsAdapter.createComponent(new InteractionCentricPopupItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Popup/InteractionCentricPopup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Popup","Components/InteractionCentric/Popup/InteractionCentricPopupItem"],function(require,exports,TsAdapter,PureUpdate,Popup,InteractionCentricPopupItem){exports.DESCRIPTOR_NAME="InteractionCentricPopup";var InteractionCentricPopupSpec=function(_super){__extends(InteractionCentricPopupSpec,_super);function InteractionCentricPopupSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricPopup";this.mixins=[PureUpdate.Mixin]}InteractionCentricPopupSpec.prototype.handlePopupItemClick=function(itemNumber){this.props.itemSelected(itemNumber)};InteractionCentricPopupSpec.prototype.createItem=function(itemNumber){var isCurrentItem=this.props.currentItemID==itemNumber,iconClassName=this.props.showIcon?this.props.icons[itemNumber]:null;return InteractionCentricPopupItem.InteractionCentricPopupItem({key:"InteractionCentricPopupItem"+itemNumber,displayName:this.allNames[itemNumber],dimensions:this.props.itemDimensions,itemSelected:this.handlePopupItemClick,tabIndex:this.props.tabIndex,itemID:itemNumber,showIcon:this.props.showIcon,showArrow:this.props.showArrow,iconClassName:iconClassName,onDismiss:this.props.onDismiss,isBrowserIE:this.props.isBrowserIE})};InteractionCentricPopupSpec.prototype.getPopupWidth=function(){return this.props.dimensions?this.props.dimensions.itemWidth:"auto"};InteractionCentricPopupSpec.prototype.getPopupHeight=function(){return this.props.visible?this.props.dimensions?this.props.dimensions.itemHeight:"100%":0};InteractionCentricPopupSpec.prototype.getPopupMinHeight=function(){return this.props.visible?this.props.dimensions?this.props.dimensions.minItemHeight:30:0};InteractionCentricPopupSpec.prototype.getPopupDisplay=function(){return this.props.visible?"block":"none"};InteractionCentricPopupSpec.prototype.showLabelStatus=function(){var status=false,count=0;for(var key in this.props.displayGroups){count++;if(count==2){status=true;break}}return status};InteractionCentricPopupSpec.prototype.render=function(){this.allNames=[];var children=[],styles={margin:this.props.dimensions.itemMargin,marginTop:this.props.dimensions.itemMarginTop,width:this.getPopupWidth(),height:this.getPopupHeight(),minHeight:this.getPopupMinHeight(),display:this.getPopupDisplay(),fontSize:this.props.dimensions.fontSize},showLabel=this.showLabelStatus();for(var key in this.props.displayGroups){var viewNames=this.props.displayGroups[key].toArray();showLabel&&children.push(React.DOM.div({key:"InteractionCentricPopupGroup"+key,className:"interactionCentricPopupGroupName"},key));for(var allNamesSize=this.allNames.length,i=0;i<viewNames.length;i++){this.allNames.push(viewNames[i]);children.push(this.createItem(allNamesSize+i))}}var dashboardPicker=Popup.Popup({visible:this.props.visible,onDismiss:this.props.onDismiss},children);return React.DOM.div({style:styles,className:"interactionCentricPopup"},dashboardPicker)};return InteractionCentricPopupSpec}(TsAdapter.SpecBase);exports.InteractionCentricPopup=TsAdapter.createComponent(new InteractionCentricPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/Popup/InteractionCentricPopupWrapper",["require","exports","Components/Primitives/FontIcon","Components/DataWrapperComponent","Components/InteractionCentric/Popup/InteractionCentricPopup","Core/ReactTypescriptAdapter","Components/Common/Constants"],function(require,exports,FontIcon,DataWrapperComponent,InteractionCentricPopup,TsAdapter,Constants){exports.DESCRIPTOR_NAME="InteractionCentricPopupWrapper";var InteractionCentricPopupWrapperSpec=function(_super){__extends(InteractionCentricPopupWrapperSpec,_super);function InteractionCentricPopupWrapperSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricPopupWrapper";this.listenToProperties=["dataRecieved"]}InteractionCentricPopupWrapperSpec.prototype.getInitialState=function(){return {expanded:false}};InteractionCentricPopupWrapperSpec.prototype.handleItemSelect=function(itemNumber){this.props.dataContext.ItemSelected(this.props.dataContext.get_ItemIDs().toArray()[itemNumber]);if(this.props.onItemSelected!=null){var canOpenOrClose=this.props.onItemSelected();if(!canOpenOrClose)return}var selectedItem=this.refs["selectedItem"];if(selectedItem instanceof HTMLSpanElement)selectedItem.textContent=this.props.dataContext.SelectedItemName();this.openOrCloseFlyout()};InteractionCentricPopupWrapperSpec.prototype.handlePopupDismiss=function(target){this.setState({expanded:false})};InteractionCentricPopupWrapperSpec.prototype.openOrCloseFlyout=function(){this.setState({expanded:!this.state.expanded})};InteractionCentricPopupWrapperSpec.prototype.handleOnKeyDown=function(e){if(e.keyCode==Constants.ENTER_KEY_CODE||e.keyCode==Constants.SPACE_KEY_CODE){this.openOrCloseFlyout();$(".interactionCentricPopupItem:first").focus();return false}else if(e.keyCode==Constants.ESCAPE_KEY_CODE){$(".dashboardPicker").focus();this.setState({expanded:false})}else e.keyCode==Constants.F8_KEY_CODE&&this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey)};InteractionCentricPopupWrapperSpec.prototype.render=function(){var children=[],allNames=this.props.dataContext.get_ItemNames().toArray(),displayGroups=this.props.dataContext.get_DataNames(),dimensions={itemMarginTop:5,itemMinHeight:30},currentItemName=this.props.dataContext.SelectedItemName(),text=React.DOM.span({className:this.props.selectedItemTextClassName,key:"InteractionCentricPopupText",ref:"selectedItem"},currentItemName);children.push(React.DOM.div({key:this.props.selectedItemClassName,onClick:this.openOrCloseFlyout,className:this.props.selectedItemClassName},[text,FontIcon.FontIcon({key:"InteractionCentricPopupExpandedSymbol",symbolName:"Expanded"})]));if(this.state.expanded){var popup=InteractionCentricPopup.InteractionCentricPopup({key:"InteractionCentricPopup",dimensions:dimensions,itemSelected:this.handleItemSelect,displayGroups:displayGroups,itemDimensions:null,currentItemID:allNames.indexOf(this.props.dataContext.SelectedItemName()),onDismiss:this.handlePopupDismiss,visible:true,showIcon:this.props.showIcon,showArrow:this.props.showArrow,icons:this.props.icons,tabIndex:this.props.tabIndex,isBrowserIE:this.props.clientContext.userAgent.get_IsBrowserIE()});children.push(popup)}return React.DOM.div({className:this.props.mainClassName,title:currentItemName,"data-id":this.props.dataID,onKeyDown:this.handleOnKeyDown,tabIndex:this.props.tabIndex,"aria-label":currentItemName+" "+this.props.clientContext.getLocalizedString("DashboardPicker_ScreenReader_Label")},children)};return InteractionCentricPopupWrapperSpec}(TsAdapter.SpecBase);exports.InteractionCentricPopupWrapper=DataWrapperComponent.wrapComponent(new InteractionCentricPopupWrapperSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GridView/GridViewFlyout",["require","exports","Core/Binding/PureUpdateMixin","Components/InteractionCentric/Popup/InteractionCentricPopup","Components/InteractionCentric/Popup/InteractionCentricPopupWrapper","Core/ReactTypescriptAdapter","Core/Binding/UIHasRenderedMixin"],function(require,exports,PureUpdate,InteractionCentricPopup,InteractionCentricPopupWrapper,TsAdapter,UIHasRendered){exports.DESCRIPTOR_NAME="GridViewFlyout";var GridViewFlyoutSpec=function(_super){__extends(GridViewFlyoutSpec,_super);function GridViewFlyoutSpec(){_super.apply(this,arguments);this.displayName="GridViewFlyout";this.mixins=[UIHasRendered.Mixin,PureUpdate.Mixin]}GridViewFlyoutSpec.prototype.getInitialState=function(){return {parentFlyoutOpened:false,showChildFlyout:false}};GridViewFlyoutSpec.prototype.componentDidUpdate=function(){var parentComponent=this.refs["parent"],parentNode=ReactDOM.findDOMNode(parentComponent);if(this.props.dataContext.get_ClientWidth()!=parentNode.clientWidth){this.props.dataContext.set_ClientWidth(parentNode.clientWidth);this.setState({parentFlyoutOpened:true})}};GridViewFlyoutSpec.prototype.onParentItemSelected=function(){if(!this.props.dataContext.get_HasChildFlyouts())return true;this.setState({showChildFlyout:true});return false};GridViewFlyoutSpec.prototype.handlePopupDismiss=function(target){this.setState({showChildFlyout:false})};GridViewFlyoutSpec.prototype.handleChildItemSelect=function(itemNumber){var currentItemName=this.props.dataContext.get_SelectedItemID();if(currentItemName==null)return;var data=this.props.dataContext.get_DataList(),selectedFlyout=data[currentItemName],selectedFlyoutItemIds=selectedFlyout.get_ItemIDs().toArray();this.props.dataContext.ItemSelected(currentItemName,selectedFlyoutItemIds[itemNumber]);this.props.dataContext.FireDropdownSelectedItemUpdatedEvent();this.setState({showChildFlyout:false})};GridViewFlyoutSpec.prototype.getIcons=function(){for(var icons=this.props.dataContext.get_ItemIDs().toArray(),index=0;index<icons.length;index++){var icon=icons[index];icons[index]=icons[index]+" entity-symbol symbolFont"}return icons};GridViewFlyoutSpec.prototype.getMainClassName=function(){return "dashboardPicker "+(this.props.mainClassName==null?"gridFlyout":this.props.mainClassName)};GridViewFlyoutSpec.prototype.renderWithChildPopups=function(flyoutData){var children=[],data=flyoutData.get_DataList(),currentItemId=this.props.dataContext.get_SelectedItemID(),selectedItemName=this.props.dataContext.SelectedItemName(),count=1;for(var item in data){var allNames=data[item].get_ItemNames().toArray(),displayGroups=data[item].get_DataNames(),dimensions={itemMarginTop:5,itemMinHeight:30},popup=InteractionCentricPopup.InteractionCentricPopup({dimensions:dimensions,displayGroups:displayGroups,itemDimensions:null,currentItemID:allNames.indexOf(this.props.dataContext.SelectedItemName()),itemSelected:this.handleChildItemSelect,onDismiss:this.handlePopupDismiss,visible:item==currentItemId&&this.state.showChildFlyout,ref:item,tabIndex:this.props.dataContext.get_StartIndex()-1}),style={};style["left"]=this.props.dataContext.get_ClientWidth()+"px";style["top"]=count*30-50+"px";var popupWrapper=React.DOM.div({className:item==currentItemId?this.getMainClassName()+" gridFlyout-show":this.getMainClassName()+" gridFlyout-hide",style:style},popup);children.push(popupWrapper);count++}return children};GridViewFlyoutSpec.prototype.render=function(){var flyoutData=this.props.dataContext,gridFlyout=InteractionCentricPopupWrapper.InteractionCentricPopupWrapper({key:"gridFlyout",clientContext:this.props.clientContext,dataContext:flyoutData,selectedItemClassName:"dashboardPickerSelectedItem",selectedItemTextClassName:"dashboardPickerSelectedItemText",mainClassName:this.getMainClassName(),dataID:"gridViewFlyout",onItemSelected:this.onParentItemSelected,ref:"parent",showIcon:flyoutData.get_HasChildFlyouts(),showArrow:flyoutData.get_HasChildFlyouts(),tabIndex:this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_StartIndex()-1,icons:flyoutData.get_HasChildFlyouts()?this.getIcons():null});if(flyoutData.get_HasChildFlyouts()){var children=this.renderWithChildPopups(flyoutData);return React.DOM.div({},[gridFlyout,children])}return gridFlyout};return GridViewFlyoutSpec}(TsAdapter.SpecBase);exports.GridViewFlyout=TsAdapter.createComponent(new GridViewFlyoutSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Interactioncentric/FilterBar/FilterBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Primitives/FontIcon","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,Button,FontIcon,Constants){exports.DESCRIPTOR_NAME="FilterBar";var isCompositionEvent=false,FilterBarSpec=function(_super){__extends(FilterBarSpec,_super);function FilterBarSpec(){_super.apply(this,arguments);this.displayName="FilterBar";this.listenToProperties=["SearchText"]}FilterBarSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_SearchText()}};FilterBarSpec.prototype.componentWillReceiveProps=function(nextProps){this.setState({currentText:nextProps.dataContext.get_SearchText()})};FilterBarSpec.prototype.performSearch=function(e){e.key=="Enter"&&!this.props.dataContext.get_IsSearchBlocked()&&this.props.dataContext.RefreshData()};FilterBarSpec.prototype.handleOnKeyDown=function(e){switch(e.key){case Constants.F8_KEY:this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey);case Constants.ENTER_KEY:e.preventDefault();case Constants.BACKSPACE_KEY:isCompositionEvent=false;case Constants.DELETE_KEY:isCompositionEvent=false}};FilterBarSpec.prototype.onTextBoxChanged=function(event){if(event&&event.target&&!isCompositionEvent){var target=event.target;this.props.dataContext.set_SearchText(target.value)}};FilterBarSpec.prototype.handleSearchButtonClick=function(e){this.props.dataContext&&!this.props.dataContext.get_IsSearchBlocked()&&this.props.dataContext.RefreshData()};FilterBarSpec.prototype.handleComposition=function(event){if(event&&event.data){isCompositionEvent=true;this.props.dataContext.set_SearchText(event.data);if(event.type==="compositionend")isCompositionEvent=false}};FilterBarSpec.prototype.render=function(){var children=[],textbox=React.DOM.input((_a={ref:"searchTextBox",className:"SearchTextBox majorComponent",key:"FilterSearchBox",role:"textbox",type:this.props.clientContext.getTextBoxTypeString(5),"data-id":"searchText",maxLength:100,value:this.state.currentText||"",tabIndex:this.props.tabIndex,placeholder:this.props.clientContext.getLocalizedString("L_InteractionWall_SearchPlaceholder")+" ...",onKeyUp:this.performSearch,onKeyDown:this.handleOnKeyDown},_a[this.props.clientContext.userAgent.get_IsBrowserChrome()?"onCompositionStart":""]=this.handleComposition,_a[this.props.clientContext.userAgent.get_IsBrowserChrome()?"onCompositionUpdate":""]=this.handleComposition,_a[this.props.clientContext.userAgent.get_IsBrowserChrome()?"onCompositionEnd":""]=this.handleComposition,_a[this.props.clientContext.userAgent.get_IsBrowserIE()?"onInput":"onChange"]=this.onTextBoxChanged,_a["aria-label"]=this.props.ariaLabel,_a)),buttonSearch=Button.Button({key:"button",className:"ButtonSearch",onClick:this.handleSearchButtonClick,dataId:"searchImage"},FontIcon.FontIcon({symbolName:"SearchButton"}));children.push(textbox,buttonSearch);return React.DOM.div({className:"FilterControlGrid"},children);var _a};return FilterBarSpec}(TsAdapter.SpecBase);exports.FilterBar=DataWrapperComponent.wrapComponent(new FilterBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GridView/InteractionCentricGridHeaderControlView",["require","exports","Core/Binding/PureUpdateMixin","Components/Primitives/FontIcon","Components/Lists/InteractBarListHeader","Core/ReactTypescriptAdapter","Components/Interactioncentric/FilterBar/FilterBar"],function(require,exports,PureUpdate,FontIcon,InteractBarListHeader,TsAdapter,FilterBar){exports.DESCRIPTOR_NAME="InteractionCentricGridHeaderControlView";var InteractionCentricGridHeaderControlViewSpec=function(_super){__extends(InteractionCentricGridHeaderControlViewSpec,_super);function InteractionCentricGridHeaderControlViewSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricGridHeaderControlView";this.listenToProperties=["ActiveNavigationStack","Top"];this.mixins=[PureUpdate.Mixin]}InteractionCentricGridHeaderControlViewSpec.prototype.renderHeaderAddButton=function(){return InteractBarListHeader.InteractBarListHeader({key:"gridHeaderAddButton",clientContext:this.props.clientContext,dataContext:this.props.dataContext,truncateHeader:false,hideViewName:this.props.dataContext.get_EnableViewPicker()})};InteractionCentricGridHeaderControlViewSpec.prototype.render=function(){var children=[];this.props.tabIndex&&this.props.tabIndex>-1&&this.props.dataContext.set_StartIndex(this.props.tabIndex);if(this.props.dataContext.get_ShowSearch()&&(this.props.dataContext.get_IsAssociatedGridContext()||this.props.dataContext.get_IsGridFormContext())||this.props.dataContext.get_EnableQuickFind()&&!this.props.dataContext.get_IsAssociatedGridContext()&&!this.props.dataContext.get_IsGridFormContext()){var filterBar=FilterBar.FilterBar({dataContext:this.props.dataContext.get_FilterBarViewModel(),tabIndex:this.props.dataContext.get_StartIndex(),clientContext:this.props.clientContext,ariaLabel:this.props.headerSectionTitle}),divSearch=React.DOM.div({className:"mscrm-gridSearch",key:"mscrm-gridSearch"},filterBar);children.push(divSearch)}!(this.props.dataContext.get_IsGridFormContext()||this.props.dataContext.get_IsAssociatedGridContext())&&children.push(this.renderHeaderAddButton());var refreshButton=React.DOM.button({key:"GridViewHeaderRefresh",dataId:"GridViewHeaderRefresh",onClick:this.props.onRefresh,datacontext:this.props.dataContext,tabIndex:this.props.dataContext.get_StartIndex(),className:"mscrm-gridViewRefreshButton",title:this.props.clientContext.getLocalizedString("Mobile_Preview_No_Records_Refresh_Button"),"aria-label":this.props.clientContext.getLocalizedString("Mobile_Preview_No_Records_Refresh_Button")},FontIcon.FontIcon({symbolName:"Refresh"}));children.push(refreshButton);return React.DOM.div({className:"mscrm-gridViewHeader"},children)};return InteractionCentricGridHeaderControlViewSpec}(TsAdapter.SpecBase);exports.InteractionCentricGridHeaderControl=TsAdapter.createComponent(new InteractionCentricGridHeaderControlViewSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GridView/InteractionCentricGridFooterControlView",["require","exports","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/FontIcon","Core/ReactTypescriptAdapter","Components/Common/Constants","Core/Binding/FocusHandlerMixin"],function(require,exports,DataWrapperComponent,CssClassSet,FontIcon,TsAdapter,Constants,FocusHandlerMixin){exports.DESCRIPTOR_NAME="InteractionCentricGridFooterControlView";var InteractionCentricGridFooterControlViewSpec=function(_super){__extends(InteractionCentricGridFooterControlViewSpec,_super);function InteractionCentricGridFooterControlViewSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricGridFooterControlView";this.listenToProperties=["IsLoading","CurrentPageIndex","PageSize","PagingInfo"];this.listenToCollections=["Items"];this.mixins=[FocusHandlerMixin.Mixin];this.NEXT_BUTTON_EVENT="NextButtonClicked";this.PREVIOUS_BUTTON_EVENT="PreviousButtonClicked";this.FIRST_LOAD_EVENT="FirstLoad";this.JUMP_BAR_EVENT="JumpBarEvent"}InteractionCentricGridFooterControlViewSpec.prototype.setGridPagingFocus=function(){var currentPageIndex=this.props.dataContext.get_CurrentPageIndex(),moreRecordsAvailable=false;if(typeof this.props.dataContext.moreRecordsAvailable!==undefined)moreRecordsAvailable=this.props.dataContext.moreRecordsAvailable();var btnNextButton=this.refs["btnNextButton"],btnPreviousButton=this.refs["btnPreviousButton"];if(this.props.dataContext.get_GridPagerEventType()!==this.FIRST_LOAD_EVENT)if(currentPageIndex>1&&this.props.dataContext.get_GridPagerEventType()===this.NEXT_BUTTON_EVENT)moreRecordsAvailable===true?$(btnNextButton).focus():$(btnPreviousButton).focus();else if(this.props.dataContext.get_GridPagerEventType()===this.PREVIOUS_BUTTON_EVENT)currentPageIndex===1?$(btnNextButton).focus():$(btnPreviousButton).focus()};InteractionCentricGridFooterControlViewSpec.prototype.componentDidUpdate=function(){if(this.shouldTakeFocus())if(!this.props.dataContext.get_IsLoading())if(this.props.dataContext.get_Items().get_Count()>0&&this.props.dataContext.get_GridPagerEventType()!==this.FIRST_LOAD_EVENT&&this.props.dataContext.get_GridPagerEventType()!==this.JUMP_BAR_EVENT)this.setGridPagingFocus();else this.props.dataContext.get_SelectedFilterValue()!==null&&$(".mscrm-gridJumpBarButtonSelected").focus()};InteractionCentricGridFooterControlViewSpec.prototype.gotoPreviousPage=function(){this.props.dataContext.PagingGridRecords(false);this.props.dataContext.set_GridPagerEventType(this.PREVIOUS_BUTTON_EVENT)};InteractionCentricGridFooterControlViewSpec.prototype.gotoNextPage=function(){this.props.dataContext.PagingGridRecords(true);this.props.dataContext.set_GridPagerEventType(this.NEXT_BUTTON_EVENT)};InteractionCentricGridFooterControlViewSpec.prototype.jumpBarFilter=function(e){this.props.dataContext.set_GridPagerEventType(this.JUMP_BAR_EVENT);var filter=e.target.getAttribute("data-filter");this.props.dataContext.JumpBarFilterToGrid(filter)};InteractionCentricGridFooterControlViewSpec.prototype.handleOnNextPageKeyDown=function(e){e.key===Constants.ENTER_KEY&&this.gotoNextPage()};InteractionCentricGridFooterControlViewSpec.prototype.handleOnPreviousPageKeyDown=function(e){e.key===Constants.ENTER_KEY&&this.gotoPreviousPage()};InteractionCentricGridFooterControlViewSpec.prototype.renderGridPaging=function(){var itemCount=this.props.dataContext.get_Items().get_Count(),moreRecordsAvailable;if(this.props.dataContext.get_CurrentPageIndex()>1&&itemCount==0&&!this.props.dataContext.get_IsLoading()){moreRecordsAvailable=false;this.props.dataContext.set_ShouldRenderEmptyPager(true)}else{if(this.props.dataContext.get_IsLoading()||itemCount==0)return React.DOM.div({key:"emptyGridPagingDiv"});moreRecordsAvailable=this.props.dataContext.moreRecordsAvailable()}var headerPagerDetailChildren=[],headerPagerNextPreviousChildren=[],pagerDetail=React.DOM.label({key:"PagerDetail",datacontext:this.props.dataContext,ref:"PagerDetail"},this.props.dataContext.getPagerDetailText()),nextButton=React.DOM.button({key:"NextButton",onMouseDown:this.gotoNextPage,onKeyDown:this.handleOnNextPageKeyDown,ref:"btnNextButton",datacontext:this.props.dataContext,tabIndex:this.getStartTabIndex(),className:!moreRecordsAvailable?"mscrm-gridPagerButtonDisable":"mscrm-gridPagerButton"},FontIcon.FontIcon({key:"collapsed-fontIcon",symbolName:"Collapsed"})),pageCountText=React.DOM.label({key:"PageCountText",datacontext:this.props.dataContext,ref:"PageCountText"},this.props.dataContext.get_PagerCountText()),previousButton=React.DOM.button({key:"PreviousButton",ref:"btnPreviousButton",onMouseDown:this.gotoPreviousPage,onKeyDown:this.handleOnPreviousPageKeyDown,datacontext:this.props.dataContext,tabIndex:this.getStartTabIndex(),className:this.props.dataContext.get_CurrentPageIndex()==1?"mscrm-gridPagerButtonDisable":"mscrm-gridPagerButton"},FontIcon.FontIcon({key:"LeftArrowHead-fontIcon",symbolName:"LeftArrowHead"})),pagerPageDetails=React.DOM.span({key:"mscrm-pagerDetails",className:"mscrm-pagerDetails"},[pagerDetail]),pagerNextPreviousPager=React.DOM.span({tabIndex:this.getStartTabIndex(),onKeyDown:this.handleOnKeyDownForMajorComponent,key:"mscrm-pagerNextPrevious",className:"mscrm-pagerNextPrevious majorComponent"},[previousButton],[pageCountText],[nextButton]),gridPager=React.DOM.div({ref:"GridPager",key:"GridPager"},[pagerPageDetails,pagerNextPreviousPager]);return React.DOM.div({key:"InteractionCentricGridFooterControlPager"},gridPager)};InteractionCentricGridFooterControlViewSpec.prototype.handleOnKeyDownForMajorComponent=function(e){e.keyCode==Constants.F8_KEY_CODE&&this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey)};InteractionCentricGridFooterControlViewSpec.prototype.renderGridJumpBar=function(){if(this.props.dataContext.get_IsLoading())return React.DOM.div({key:"emptyGridJumpBarDiv"});for(var jumpBarButtons=[],textValues=this.props.dataContext.GetJumpbarText(),selectedFilter=this.props.dataContext.get_SelectedFilterValue()==null?"*":this.props.dataContext.get_SelectedFilterValue(),i=0;i<textValues.length;i++){var current=textValues[i],text=current.split(":")[0],filterId=current.split(":")[1],jumpBarButton=React.DOM.button({key:"button"+filterId,ref:"button"+filterId,onClick:this.jumpBarFilter,title:text,"data-filter":filterId,tabIndex:this.props.dataContext.get_StartIndex(),className:CssClassSet({"mscrm-gridJumpBarButton":selectedFilter!=filterId,"mscrm-gridJumpBarButtonSelected":selectedFilter==filterId})},text);jumpBarButtons.push(jumpBarButton)}return React.DOM.div({ref:"JumpBar",key:"JumpBar",className:"mscrm-gridJumpBar majorComponent",tabIndex:this.getStartTabIndex(),onKeyDown:this.handleOnKeyDownForMajorComponent},jumpBarButtons)};InteractionCentricGridFooterControlViewSpec.prototype.getStartTabIndex=function(){return this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_StartIndex()};InteractionCentricGridFooterControlViewSpec.prototype.render=function(){var children=[],gridPaging=this.renderGridPaging();children.push(gridPaging);if(this.props.dataContext.get_EnableJumpBar()){var gridJumpBar=this.renderGridJumpBar();children.push(gridJumpBar)}return React.DOM.div({key:"mscrm-gridFooter",className:"mscrm-gridFooter"},children)};return InteractionCentricGridFooterControlViewSpec}(TsAdapter.SpecBase);exports.InteractionCentricGridFooterControl=DataWrapperComponent.wrapComponent(new InteractionCentricGridFooterControlViewSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GridView/InteractionCentricGridControlView",["require","exports","Components/Common/Constants","Components/DataWrapperComponent","Utils/CssClassSet","Core/Binding/CustomEventsListenerMixin","Components/InteractionCentric/GridView/InteractionCentricGridHeaderControlView","Components/InteractionCentric/GridView/InteractionCentricGridFooterControlView","Core/Binding/RetrieveViewDescriptorMixin","Core/ReactTypescriptAdapter","Core/Binding/UIHasRenderedMixin","Core/Binding/WindowResizeHandlerMixin","Core/Binding/FocusHandlerMixin","Components/Common/AccessibilityUtility"],function(require,exports,Constants,DataWrapperComponent,CssClassSet,CustomEventsListener,InteractionCentricGridHeaderControl,InteractionCentricGridFooterControl,RetrieveViewDescriptor,TsAdapter,UIHasRendered,WindowResizeHandler,FocusHandlerMixin,AccessibilityUtility){var SortDirection;(function(SortDirection){SortDirection[SortDirection["asc"]=0]="asc";SortDirection[SortDirection["desc"]=1]="desc"})(SortDirection||(SortDirection={}));exports.DESCRIPTOR_NAME="InteractionCentricGridControlView";var InteractionCentricGridControlSpec=function(_super){__extends(InteractionCentricGridControlSpec,_super);function InteractionCentricGridControlSpec(){_super.apply(this,arguments);this.multiSelectionDirection=0;this.displayName="InteractionCentricGridControlView";this.listenToProperties=["ViewModelId","RecordCount","IsLoading","HasError","ShowDeleteIcon","ColumnsInitialized","AddSelectedViewModels","QueueDataFetched","Visible","HasFocus"];this.mixins=[RetrieveViewDescriptor.Mixin,UIHasRendered.Mixin,CustomEventsListener.Mixin,WindowResizeHandler.Mixin,FocusHandlerMixin.Mixin];this.scrollpos=0}InteractionCentricGridControlSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};InteractionCentricGridControlSpec.prototype.getGridId=function(){return this.generateId("grid")};InteractionCentricGridControlSpec.prototype.getGridContainerId=function(){return this.generateId("gridContainer")};InteractionCentricGridControlSpec.prototype.getGridNoRecordsId=function(){return this.generateId("gridNoRecords")};InteractionCentricGridControlSpec.prototype.getGridLoadingId=function(){return this.generateId("gridLoading")};InteractionCentricGridControlSpec.prototype.generateId=function(preFix){return preFix+"_"+this.props.dataContext.get_ViewModelId()};InteractionCentricGridControlSpec.prototype.getJQGrid=function(){var gridIdSelector="#"+this.getGridId(),gridContainer=$("#"+this.getGridContainerId()),grid=gridContainer.find(gridIdSelector);return grid};InteractionCentricGridControlSpec.prototype.handleWindowResize=function(){this.props.dataContext.set_CollectionHasChanged(true)};InteractionCentricGridControlSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};InteractionCentricGridControlSpec.prototype.handlerUtility=function(recordId,entityName,isComingFromDoubleClick,e){if(this.props.dataContext.get_IsInContextOfReferencePanel()){this.props.dataContext.invokeReferencePanelTab(entityName,recordId,this.props.dataContext.get_HeaderTitleField(),isComingFromDoubleClick,e.target.innerHTML);return -1}return 0};InteractionCentricGridControlSpec.prototype.handleDoubleClick=function(e,recordId){if(this.props.dataContext.get_IsDoubleClickDisabled())return;if(this.handlerUtility(recordId,this.props.dataContext.get_PrimaryModelName(),true,e)==-1)return;var res=e.result===undefined?true:e.result,primaryModelName=this.props.dataContext.get_PrimaryModelName();this.props.dataContext.set_IsDoubleClicked(true);this.props.dataContext.OpenEntityForm(primaryModelName,recordId);return res};InteractionCentricGridControlSpec.prototype.handleClick=function(e){var anchor=e.target,entityName=anchor.getAttribute("data-entity"),recordId=anchor.getAttribute("data-id"),action=anchor.getAttribute("data-action");if(action==="none")return;if(action!="delete"&&this.props.dataContext.IsReferenceFieldClickDisabled(entityName))return;if(action!="delete"&&this.handlerUtility(recordId,entityName,false,e)==-1)return;this.props.dataContext.set_IsDoubleClicked(false);this.props.dataContext.ExecuteRecordAction(action,entityName,recordId)};InteractionCentricGridControlSpec.prototype.handleFocusForGridCells=function(e){var activeElement=document.activeElement,role=activeElement.getAttribute("role"),parentRow=$(activeElement).closest("tr"),deleteIconColumn=parentRow.find("a.mscrm-gridRowDelete");if(deleteIconColumn!=null&&activeElement.parentElement!=null)if((role=="gridcell"||activeElement.parentElement.getAttribute("role")=="gridcell")&&deleteIconColumn.length!==0){deleteIconColumn.css("display","inline-block");deleteIconColumn.addClass("showGridRowDeleteButton")}};InteractionCentricGridControlSpec.prototype.handleGridSorting=function(gridContainer){var gridHeader=gridContainer.find("div.ui-jqgrid-view div th");gridHeader.unbind("click");gridHeader.click(this.sortGrid);gridHeader.each(this.handleColumnSort)};InteractionCentricGridControlSpec.prototype.getFullColumnName=function(gridHeads){gridHeads=gridHeads.replace(/jqgh*_/i,"");return gridHeads.replace(/grid_[0-9]*_/i,"")};InteractionCentricGridControlSpec.prototype.handleColumnSort=function(index,el){var gridHeds=$(el).attr("id"),fullColumnName=this.getFullColumnName(gridHeds),cl=fullColumnName.split("."),columName=cl[cl.length-1];if(!this.isColumnSortable(fullColumnName))return;var sortField=this.props.dataContext.get_SortingInfo().get_SortByField(),sortDesc=this.props.dataContext.get_SortingInfo().get_SortDescending(),divSpan=$(el).find("div span.s-ico"),spanAsc=$(el).find(".ui-icon-asc"),spanDesc=$(el).find(".ui-icon-desc");$(el).css("backgroundColor",sortField==columName?"#D7DBE2":"#E7E9EC");divSpan.css("display",sortField==columName?"inline":"none");spanAsc.css("display",sortDesc?"none":"inline");spanDesc.css("display",!sortDesc?"none":"inline");sortField==columName&&this.isGridRefreshedForSort&&$(el).focus()};InteractionCentricGridControlSpec.prototype.onSelection=function(id,isChecked){if(this.props.dataContext.isSubgridInForm())return;var grid=this.getJQGrid(),selectedRows=grid.jqGrid("getGridParam","selarrrow").length;this.props.dataContext.OnRowSelcted(id,isChecked);this.props.onSelection&&this.props.onSelection();!isChecked&&selectedRows==0&&this.props.dataContext.fireOnAllCheckboxesUnchecked();this.isActionButtonFocused=isChecked};InteractionCentricGridControlSpec.prototype.onSelectionAll=function(list,isChecked){this.props.dataContext.OnAllRowsSelected(list,isChecked);this.props.onSelectionAll&&this.props.onSelectionAll();!isChecked&&this.props.dataContext.fireOnAllCheckboxesUnchecked();this.isActionButtonFocused=isChecked};InteractionCentricGridControlSpec.prototype.refreshGrid=function(){this.props.dataContext.set_ShouldNotRetainPageIndexToLoad(false);this.props.dataContext.RefreshData()};InteractionCentricGridControlSpec.prototype.itemOnKeyDownHandler=function(e){var activeElement=document.activeElement,role=activeElement.getAttribute("role"),tabIndex=this.getStartTabIndex().toString(),screenReaderText="";AccessibilityUtility.handleKeyDownAndShowOutLine(e);switch(e.keyCode){case Constants.TAB_KEY_CODE:var parentRow=$(activeElement).closest("tr");if(this.isActionButtonFocused==true&&parentRow&&parentRow.attr("aria-selected")=="true"){var focusableItem=$(".CrmDialog-body .dialogFooter").find(":button").first();if(focusableItem==null||focusableItem.length==0)focusableItem=$(".commandBarSection").children().first();if(focusableItem!=null&&focusableItem.length>0){typeof e.nativeEvent.preventDefault==="function"&&e.nativeEvent.preventDefault();focusableItem.focus()}this.isActionButtonFocused=false;return false}if(role==="row"&&!e.shiftKey){var currentRow=this.getCurrentGridRow(),firstChildInCell=currentRow.childNodes[0].firstChild;if(firstChildInCell!=null){var elementToFocus=firstChildInCell.focus===undefined?this.findFirstVisibleElementInGrid(currentRow.childNodes):firstChildInCell;elementToFocus!=null&&elementToFocus.focus()}return false}var deleteIconColumn=parentRow.find("a.mscrm-gridRowDelete"),gridIdSelector="#"+this.getGridId(),gridContainer=$("#"+this.getGridContainerId()),gridId=gridContainer.find(gridIdSelector),gridDeleteIconColumn=gridId.find("a.mscrm-gridRowDelete");(role=="columnheader"||role=="gridcell"||activeElement.parentElement.getAttribute("role"))&&gridDeleteIconColumn.length!==0&&gridDeleteIconColumn.hasClass("showGridRowDeleteButton")&&gridDeleteIconColumn.removeClass("showGridRowDeleteButton");break;case Constants.ENTER_KEY_CODE:var targetElement=e.target,action=targetElement.getAttribute("data-action");if(action=="delete"){var recordId=targetElement.getAttribute("data-id"),entityName=targetElement.getAttribute("data-entity");this.props.dataContext.ExecuteRecordAction(action,entityName,recordId)}else if(role=="columnheader")this.sortGrid(e);else if(role=="gridcell"||role=="row"){var currentRow=this.getCurrentGridRow(),recordId=currentRow.getAttribute("id");if(this.handlerUtility(recordId,this.props.dataContext.get_PrimaryModelName(),true,e)==-1)return;this.props.dataContext.OpenPrimaryEntityForm(recordId)}else if(targetElement.tagName=="A"){var entityName=targetElement.getAttribute("data-entity"),recordId=targetElement.getAttribute("data-id");if(this.handlerUtility(recordId,this.props.dataContext.get_PrimaryModelName(),true,e)==-1)return;entityName?this.props.dataContext.OpenEntityForm(entityName,recordId):this.props.dataContext.OpenPrimaryEntityForm(recordId)}break;case Constants.SPACE_KEY_CODE:if(role=="checkbox"&&activeElement.parentElement!=null)if(activeElement.parentElement.parentElement!=null&&activeElement.parentElement.parentElement.getAttribute("role")=="columnheader")break;var currentRow=this.getCurrentGridRow(),recordNumber=currentRow.getAttribute("data-seq");if(currentRow){this.selectGridRow(currentRow);currentRow.setAttribute("tabindex",tabIndex);var rowCount=this.props.dataContext.get_SelectedRowCount(),currentLabel=$(currentRow).attr("aria-label"),stateOfRow=$(currentRow).attr("aria-selected");this.setScreenReaderTextForRecords(recordNumber,currentRow);if(stateOfRow=="false"){screenReaderText=this.props.dataContext.gridRowCheckText(recordNumber,rowCount,false);$(currentRow).attr("aria-label",screenReaderText);$(currentRow).attr("aria-selected","false")}else{if(rowCount==1){screenReaderText=this.props.clientContext.getLocalizedString("InteractionCentricGrid_ScreenReader_ParsedData_FirstSelectedRecord");$(currentRow).attr("aria-label",screenReaderText)}else{screenReaderText=this.props.dataContext.gridRowCheckText(recordNumber,rowCount,true);$(currentRow).attr("aria-label",screenReaderText)}$(currentRow).attr("aria-selected","true")}$(currentRow).focus();e.preventDefault()}break;case Constants.UP_ARROW_KEY_CODE:case Constants.DOWN_ARROW_KEY_CODE:e.preventDefault();var targetRow=null,rowCount=0,currentRow=this.getCurrentGridRow();if(currentRow){var recordNumber=currentRow.getAttribute("data-seq"),isCurrentRowChecked=currentRow.getAttribute("aria-selected");this.setScreenReaderTextForRecords(recordNumber,currentRow);var targetNode=e.keyCode==Constants.DOWN_ARROW_KEY_CODE?currentRow.nextSibling:currentRow.previousSibling;if(targetNode&&targetNode.classList.contains("jqgrow")){targetRow=targetNode;currentRow.removeAttribute("tabindex");var isTargetRowChecked=targetRow.getAttribute("aria-selected");if(targetNode.classList.contains("jqgfirstrow"))break}rowCount=this.props.dataContext.get_SelectedRowCount();if(e.shiftKey){if(this.multiSelectionDirection==0&&isCurrentRowChecked!=="true"){this.selectGridRow(currentRow);isCurrentRowChecked="true";rowCount=this.props.dataContext.get_SelectedRowCount();screenReaderText=this.props.dataContext.gridRowCheckText(recordNumber,rowCount,true);$(currentRow).attr("aria-label",screenReaderText)}if(isCurrentRowChecked=="true"&&isTargetRowChecked!=="true"&&targetRow){this.selectGridRow(targetRow);rowCount=this.props.dataContext.get_SelectedRowCount();screenReaderText=this.props.dataContext.gridRowCheckText(recordNumber,rowCount,true);$(targetRow).attr("aria-label",screenReaderText)}else{this.selectGridRow(currentRow);rowCount=this.props.dataContext.get_SelectedRowCount();screenReaderText=this.props.dataContext.gridRowCheckText(recordNumber,rowCount,true);$(currentRow).attr("aria-label",screenReaderText)}this.multiSelectionDirection=e.keyCode}else if(e.ctrlKey)this.multiSelectionDirection=0;else if(this.multiSelectionDirection>0||rowCount>0){this.clearAllSelection();this.multiSelectionDirection=0}}else if(role=="columnheader"&&e.keyCode==Constants.DOWN_ARROW_KEY_CODE){var grid=document.getElementById(this.getGridId()),gridRows=grid.getElementsByClassName("jqgrow");if(gridRows&&gridRows.length>0)targetRow=gridRows.item(0)}if(targetRow){targetRow.setAttribute("tabindex",tabIndex);$(targetRow).focus();e.preventDefault()}break;case Constants.F8_KEY_CODE:this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey);break}};InteractionCentricGridControlSpec.prototype.findFirstVisibleElementInGrid=function(childNodeList){for(var element,index=0;index<childNodeList.length-1;index++){var eachChild=childNodeList[index];if(eachChild.clientWidth!=0){element=eachChild.firstChild!==undefined?eachChild.firstChild:eachChild;break}}return element};InteractionCentricGridControlSpec.prototype.getStartTabIndex=function(){return this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_StartIndex()};InteractionCentricGridControlSpec.prototype.getCurrentGridRow=function(){var role=document.activeElement.getAttribute("role");if(role=="gridcell")return document.activeElement.parentElement;else if(role=="row")return document.activeElement;else if(document.activeElement.tagName=="A"||document.activeElement.getAttribute("type")||document.activeElement.getAttribute("type")=="checkbox")return document.activeElement.parentElement.parentElement;return null};InteractionCentricGridControlSpec.prototype.selectGridRow=function(gridRow){var rowId=gridRow.getAttribute("id");$("#"+this.getGridId()).jqGrid("setSelection",rowId,true)};InteractionCentricGridControlSpec.prototype.clearAllSelection=function(){$("#"+this.getGridId()).jqGrid("resetSelection");this.props.dataContext.DeselectAllRecords()};InteractionCentricGridControlSpec.prototype.trimWhitespaces=function(text){if(!text)return text;return text.replace(/\s+/g," ").trim()};InteractionCentricGridControlSpec.prototype.setTabIndex=function(index,el){if(el){if(el.title)el.title=this.trimWhitespaces(el.title);var startTabIndex=this.getStartTabIndex();if(el.childNodes&&el.childNodes.length>0&&el.childNodes[0]instanceof Element){el.childNodes[0].tabIndex=startTabIndex;el.childNodes[0].text=this.trimWhitespaces(el.childNodes[0].text)}else el.tabIndex=startTabIndex}};InteractionCentricGridControlSpec.prototype.setScreenReaderTextForRecords=function(index,el){if(el){var recordNum=parseInt(index)+1,totalRecords=this.props.dataContext.get_RecordCount(),screenReaderText=this.props.dataContext.fetchScreenReadableText(recordNum,totalRecords);el.setAttribute("aria-label",screenReaderText)}};InteractionCentricGridControlSpec.prototype.setGridRowIndex=function(index,el){if(el){var recordNum=parseInt(index)+1;el.setAttribute("data-seq",recordNum)}};InteractionCentricGridControlSpec.prototype.setScreenReaderTextForColumnHeader=function(index,el){if(el){var headerCellId=$(el).attr("id"),headerName=$(el).text(),fullColumnName=this.getFullColumnName(headerCellId),sortField=this.props.dataContext.get_SortingInfo().get_SortByField()==null?"":this.props.dataContext.get_SortingInfo().get_SortByField(),sortDesc=this.props.dataContext.get_SortingInfo().get_SortDescending(),isSortableFlag=this.isColumnSortable(fullColumnName),screenReaderText=this.props.dataContext.fetchScreenReadableTextColumnHeader(headerName,fullColumnName,sortField,sortDesc,isSortableFlag);el.setAttribute("aria-label",screenReaderText)}};InteractionCentricGridControlSpec.prototype.shouldComponentUpdate=function(nextProps){return this.props.dataContext.get_CollectionHasChanged()};InteractionCentricGridControlSpec.prototype.componentDidMount=function(){this.props.callbackForFocus!=null&&this.props.callbackForFocus();if(!this.props.dataContext.get_IsLoading()){this.renderjQGrid();this.setFocus();this.props.dataContext.set_CollectionHasChanged(false)}if(this.shouldTakeFocus()){var searchTextBox=$(".SearchTextBox").eq(0);if(searchTextBox){this.isGridRefreshedForSort=false;(searchTextBox.parents().hasClass("interactionCentricGrid")||searchTextBox.parents().hasClass("interactionCentricAssociatedGrid"))&&searchTextBox.focus()}}};InteractionCentricGridControlSpec.prototype.setFocus=function(){if(this.props.dataContext&&this.props.dataContext.get_HasFocus()){var node=ReactDOM.findDOMNode(this);this.props.dataContext.ScrollParentColumn($(node).offset().top,$(node).offset().left);this.props.dataContext.set_HasFocus(false);this.props.dataContext.set_CollectionHasChanged(false)}};InteractionCentricGridControlSpec.prototype.componentDidUpdate=function(){if(!this.props.dataContext.get_IsLoading()){this.props.dataContext.recalculateColumnSize();this.props.dataContext.RefreshActivityCommandBar();this.renderjQGrid();var grid=this.getJQGrid(),id;if(!this.props.dataContext.get_IsGridDialogContext()&&this.props.clientContext.applicationShellViewModel.get_PreSelectedViewModelIds().get_Count()!=0){var ids=this.props.clientContext.applicationShellViewModel.get_PreSelectedViewModelIds().toArray();for(id in ids){grid.jqGrid("setSelection",ids[id],false);this.onSelection(ids[id],true)}this.props.clientContext.applicationShellViewModel.get_PreSelectedViewModelIds().clear();this.props.dataContext.get_AllowMultiSelect()&&ids.length===this.props.dataContext.get_Items().get_Count()&&$("#cb_"+grid[0].id).attr("checked",true)}if(this.props.dataContext.get_IsGridDialogContext()&&!this.props.dataContext.get_HasError()){var ids=this.props.dataContext.get_SelectedRowIds();for(id in ids)grid.jqGrid("setSelection",ids[id],false);if(ids!=null&&ids!=undefined&&ids.length>0){var currentRow;if($(".gridControlInDialog")[0]!=null)currentRow=$(".gridControlInDialog").find("[id="+ids[ids.length-1]+"]");else currentRow=$("#"+ids[ids.length-1]);if(currentRow){this.isActionButtonFocused=true;currentRow.focus()}}!this.props.dataContext.get_IsMultiSelect()&&$("#cb_"+grid[0].id).hide();this.props.dataContext.get_IsMultiSelect()&&this.props.dataContext.get_AreAllRowsSelected()&&$("#cb_"+grid[0].id).attr("checked",true);$(".ui-jqgrid-bdiv")[0].scrollTop=this.scrollpos}this.props.dataContext.set_CollectionHasChanged(false);this.setFocus()}};InteractionCentricGridControlSpec.prototype.componentWillUnmount=function(){this.scrollpos=0};InteractionCentricGridControlSpec.prototype.componentWillUpdate=function(){this.scrollpos=$(".ui-jqgrid-bdiv").scrollTop()};InteractionCentricGridControlSpec.prototype.renderjQGrid=function(){if(this.props.dataContext.get_DataForGrid()==null)return;var sw=this.props.clientContext.getPerformanceStopwatch("jQGrid.Render");sw.start();var gridIdSelector="#"+this.getGridId(),prevGridIdSelector="#"+this.props.dataContext.get_PreviousGridId(),gridContainer=$("#"+this.getGridContainerId()),gridBox=gridContainer.find(gridIdSelector);if(gridBox.length!=0){$(gridIdSelector).jqGrid("GridDestroy");$(prevGridIdSelector).jqGrid("GridDestroy")}else prevGridIdSelector!=null&&$(prevGridIdSelector).jqGrid("GridDestroy");gridContainer.prepend($("<table id='"+this.getGridId()+"'></table>"));var grid=gridContainer.find(gridIdSelector);if(this.props.dataContext.get_ColumnsForGrid()==null||this.props.dataContext.get_ColumnsForGrid().length==0){sw.stop();return}grid.jqGrid({datatype:"local",data:this.props.dataContext.get_DataForGrid(),colModel:this.props.dataContext.get_ColumnsForGrid(),multiselect:this.props.dataContext.get_AllowMultiSelect(),width:"calc(100% - 17px)",autowidth:!this.props.dataContext.get_IsGridDialogContext()&&(this.props.dataContext.get_IsGridFormContext()||this.props.dataContext.get_IsAssociatedGridContext()),height:"100%",onSelectRow:this.onSelection,onSelectAll:this.onSelectionAll,resizeStop:this.updateGhostDiv,rowNum:this.props.dataContext.get_PageSize(),shrinkToFit:this.props.dataContext.get_ColumnsForGrid().length>Constants.COLUMNS_TO_FIT?false:true});grid.bind("jqGridDblClickRow",this.handleDoubleClick);var tabIndex=this.getStartTabIndex().toString(),headerCells=gridContainer.find("div.ui-jqgrid-view div th");headerCells.each(function(index,element){element.setAttribute("tabindex",tabIndex);var checkbox=$(element).find(".cbox");if(checkbox[0]!=null)checkbox[0].setAttribute("tabindex",tabIndex);else element.setAttribute("tabindex",tabIndex)});headerCells.each(this.setScreenReaderTextForColumnHeader);var gridRows=grid.find("tr[class!='jqgfirstrow']");gridRows.each(this.setScreenReaderTextForRecords);gridRows.each(this.setGridRowIndex);var firstColumn=gridRows.find(".cbox");firstColumn.each(this.setScreenReaderTextForRecords);var gridCells=gridRows.find("td");gridCells.each(this.setTabIndex);var gridCellAnchors=gridCells.find("a");gridCellAnchors.click(this.handleClick);var deleteIconCell=grid.find("a.mscrm-gridRowDelete");deleteIconCell.length!=0&&gridCells.on("focusin",this.handleFocusForGridCells);grid.closest(".ui-jqgrid-view").children(".ui-jqgrid-hdiv").find("th").each(this.associateHeaderTooltips);this.handleGridSorting(gridContainer);sw.stop()};InteractionCentricGridControlSpec.prototype.updateGhostDiv=function(newWidth,index){var ghostDiv=$(ReactDOM.findDOMNode(this)).find(".ui-jqgrid-bdiv > div");ghostDiv.width(ghostDiv.children("table.ui-jqgrid-btable").width())};InteractionCentricGridControlSpec.prototype.associateHeaderTooltips=function(index,element){if(index===0)element.title=this.props.clientContext.getLocalizedString("Grid_ToolTip_SelectAll");else if(this.isColumnSortable(element.id))element.title=this.props.dataContext.GetHeaderTooltip($(element).find(".ui-jqgrid-sortable").text())};InteractionCentricGridControlSpec.prototype.isColumnSortable=function(columnName){return !(columnName.indexOf("cb")>-1||this.props.dataContext.IsColumnSortable(columnName)==false)};InteractionCentricGridControlSpec.prototype.sortGrid=function(e){var headerCell=e.target;if(headerCell!=null){var headerCellId=$(headerCell).attr("id"),fullColumnName=this.getFullColumnName(headerCellId),columName=fullColumnName.split(".");columName=columName[columName.length-1];if(!this.isColumnSortable(fullColumnName))return;this.isGridRefreshedForSort=true;var order=this.props.dataContext.get_SortingInfo().get_SortDescending()==true?SortDirection[SortDirection.asc]:SortDirection[SortDirection.desc];this.props.dataContext.SortGrid(columName,order)}};InteractionCentricGridControlSpec.prototype.renderError=function(){var title=React.DOM.span({key:"title",className:"listComponentView_errorTitle"},this.props.dataContext.get_ListErrorTitle()),message=React.DOM.span({key:"message",className:"listComponentView_errorMessage"},this.props.dataContext.get_ListErrorMessage());return React.DOM.div({key:"error"},[title,message])};InteractionCentricGridControlSpec.prototype.renderGridHeader=function(){return InteractionCentricGridHeaderControl.InteractionCentricGridHeaderControl({key:"InteractionCentricGridHeader",dataContext:this.props.dataContext.get_GridHeaderViewModel(),clientContext:this.props.clientContext,tabIndex:this.getStartTabIndex(),onRefresh:this.refreshGrid,headerSectionTitle:this.props.headerSectionTitle})};InteractionCentricGridControlSpec.prototype.renderGridFooter=function(){return InteractionCentricGridFooterControl.InteractionCentricGridFooterControl({key:"InteractionCentricGridFooter",dataContext:this.props.dataContext,clientContext:this.props.clientContext,onRefresh:this.refreshGrid,tabIndex:this.getStartTabIndex()})};InteractionCentricGridControlSpec.prototype.renderGridContainer=function(){var children=[],showNoRecords;if(this.props.dataContext.get_PrimaryModelName()==="queueitem")showNoRecords=!this.props.dataContext.get_IsLoading()&&this.props.dataContext.get_NoItemInQueue()&&!this.props.dataContext.get_HasError();else showNoRecords=!this.props.dataContext.get_IsLoading()&&this.props.dataContext.get_Items().get_Count()==0&&!this.props.dataContext.get_HasError();if(showNoRecords){var gridNoRecords=React.DOM.div({key:"gridNoRecords",className:"mscrm-gridNoRecords"},this.props.dataContext.get_NoRecordsText());children.push(gridNoRecords)}else if(!this.props.dataContext.get_HasError()){var gridLoading=React.DOM.div({key:"gridLoading",className:CssClassSet({"mscrm-gridLoading":this.props.dataContext.get_IsLoading()||this.props.dataContext.get_Evaluating(),"mscrm-gridHide":!(this.props.dataContext.get_IsLoading()||this.props.dataContext.get_Evaluating())})},this.props.dataContext.get_LoadingText());children.push(gridLoading)}if(this.props.dataContext.get_HasError()){var gridError=this.renderError();return gridError}var totalRecordsCount=this.props.dataContext.get_TotalRecordsCount(),recordsText=totalRecordsCount>1?"records":"record",recordsCount=showNoRecords?this.props.dataContext.get_NoRecordsText():String.prototype.concat(totalRecordsCount.toString(),recordsText),screenReaderText=this.props.dataContext.gridScreenReaderText(recordsCount.toString()),gridContainer=React.DOM.div({key:"gridContainer",id:this.getGridContainerId(),className:"mscrm-gridContainer majorComponent","data-vmid":this.props.dataContext.get_ViewModelId(),onKeyDown:this.itemOnKeyDownHandler,onMouseDown:AccessibilityUtility.handleMouseDownAndHideOutLine,"data-viewid":this.props.dataContext.get_SourceId(),tabIndex:this.getStartTabIndex(),datacontext:this.props.dataContext,"aria-label":screenReaderText?screenReaderText:"",viewDescriptor:this.state.viewDescriptor},children);return gridContainer};InteractionCentricGridControlSpec.prototype.render=function(){if(!this.props.dataContext.get_Visible())return React.DOM.noscript();this.isActionButtonFocused=false;this.props.clientContext.applicationShellViewModel.get_CommandManagerViewModel().collapse();if(this.props.dataContext.get_RelationshipName()=="incident_parent_incident"&&!this.props.dataContext.ShouldRenderChildCases())return React.DOM.div({className:"InvisibleChildCasesSubgrid"},null);!this.props.dataContext.get_IsGridDialogContext()&&this.props.dataContext.DeselectAllRecords();var children=[];!this.props.dataContext.get_ShouldShowOnlyGrid()&&children.push(this.renderGridHeader());children.push(this.renderGridContainer(),this.renderGridFooter());return React.DOM.div({className:CssClassSet({"mscrm-mainGrid":this.props.dataContext.get_IsGridFormContext(),"mscrm-associatedGrid":this.props.dataContext.get_IsAssociatedGridContext(),"mscrm-gridControl":this.props.dataContext.get_IsGridFormContext()||this.props.dataContext.get_IsAssociatedGridContext(),"mscrm-subGridControl":!this.props.dataContext.get_IsGridFormContext()&&!this.props.dataContext.get_IsAssociatedGridContext(),"mscrm-hybridGridControl":this.props.dataContext.get_IsGridDialogContext()})},children)};return InteractionCentricGridControlSpec}(TsAdapter.SpecBase);exports.InteractionCentricGridControl=DataWrapperComponent.wrapComponent(new InteractionCentricGridControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/ComboBoxWrapper",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ComboBox"],function(require,exports,TsAdapter,DataWrapperComponent,ComboBox){exports.DESCRIPTOR_NAME="ComboBoxWrapper";var ComboBoxWrapperSpec=function(_super){__extends(ComboBoxWrapperSpec,_super);function ComboBoxWrapperSpec(){_super.apply(this,arguments);this.displayName="ComboBoxWrapper";this.listenToProperties=["DashBoardListComboBox","ItemsList","SelectedItem","Enabled","ModelContext"]}ComboBoxWrapperSpec.prototype.getInitialState=function(){return {showAsListStyle:true}};ComboBoxWrapperSpec.prototype.render=function(){var children=[],comboBox=ComboBox.ComboBox({key:"combobox",className:this.props.dataContext.get_ComboBoxClass(),clientContext:this.props.clientContext,selectElementdataId:this.props.dataContext.get_SelectElementDataId(),renderAsDropDown:true,tabIndex:this.props.tabIndex,dataContext:this.props.dataContext.get_ComboBoxViewModel()});children.push(comboBox);return React.DOM.div({className:this.props.dataContext.get_WrapperClass()},children)};return ComboBoxWrapperSpec}(TsAdapter.SpecBase);exports.ComboBoxWrapper=DataWrapperComponent.wrapComponent(new ComboBoxWrapperSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GridView/InteractionCentricGridList",["require","exports","Components/InteractionCentric/GridView/GridViewFlyout","Components/Common/Constants","Utils/CssClassSet","Components/Primitives/FontIcon","Components/DataWrapperComponent","Core/ReactTypescriptAdapter","Core/Binding/UIHasRenderedMixin","Components/InteractionCentric/GridView/InteractionCentricGridControlView","Components/InteractionCentric/ComboBoxWrapper"],function(require,exports,GridViewFlyout,Constants,CssClassSet,FontIcon,DataWrapperComponent,TsAdapter,UIHasRendered,InteractionCentricGridControl,ComboBoxWrapper){exports.DESCRIPTOR_NAME="InteractionCentricGridView";var InteractionCentricGridListSpec=function(_super){__extends(InteractionCentricGridListSpec,_super);function InteractionCentricGridListSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricGridView";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["SelectViewDataReceived","EntityDashboardDataReceived"]}InteractionCentricGridListSpec.prototype.openEntityDashboard=function(){this.props.dataContext.OpenEntityDashboard()};InteractionCentricGridListSpec.prototype.handleKeyDownForEntityDashboardIcon=function(e){e.key==Constants.ENTER_KEY&&this.openEntityDashboard()};InteractionCentricGridListSpec.prototype.getTabIndex=function(){return this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_StartIndex()};InteractionCentricGridListSpec.prototype.render=function(){var children=[],grid;if(this.props.dataContext.IsSelectViewDataReceived()||!this.props.dataContext.get_IsGridFormContext())grid=InteractionCentricGridControl.InteractionCentricGridControl({key:"InteractionCentricGridViewControl",dataContext:this.props.dataContext,isActionButtonFocused:false,clientContext:this.props.clientContext,tabIndex:this.getTabIndex()});if(this.props.dataContext.get_SelectViewData()!=null&&this.props.dataContext.get_EnableViewPicker()){var dropdown=GridViewFlyout.GridViewFlyout({key:"InteractionCentricGridViewFlyout",dataContext:this.props.dataContext.get_GridFlyoutViewModel(),clientContext:this.props.clientContext,mainClassName:this.props.dataContext.get_IsGridFormContext()?null:"subGridFlyout"});children.push(dropdown)}if((this.props.dataContext.get_Activities()!=null||this.props.dataContext.get_IsActivityGrid())&&this.props.dataContext.get_IsGridFormContext()){var label=React.DOM.span({key:"label",className:"label dueLabel"},this.props.dataContext.get_DueLabel()),gridFilterComboBox=ComboBoxWrapper.ComboBoxWrapper({key:"InteractionCentricGridFilterComboBox",dataContext:this.props.dataContext.get_FilterFlyoutViewModel(),tabIndex:this.getTabIndex(),clientContext:this.props.clientContext}),gridFilterContainer=React.DOM.div({key:"filterViewDropDownContainer",className:"filterViewDropDownContainer"},[label,gridFilterComboBox]);children.push(gridFilterContainer)}if(this.props.dataContext.get_PrimaryModelName()==="queueitem"&&this.props.dataContext.get_IsGridFormContext()){var queuepicker=ComboBoxWrapper.ComboBoxWrapper({key:"InteractionCentricGridViewQueuePickerFlyout",tabIndex:this.getTabIndex(),dataContext:this.props.dataContext.get_QueuePickerDropDown(),clientContext:this.props.clientContext});children.push(queuepicker)}grid&&children.push(grid);if(this.props.dataContext.get_IsGridFormContext()){var entityDashboardIcon=React.DOM.div({key:"InteractionCentricGridViewEntityDashboard",onClick:this.openEntityDashboard,className:this.props.dataContext.get_EnableClickOnEntityDashboardIcon()?"entityDashboardIcon":"entityDashboardIconDisabled",tabIndex:this.props.dataContext.get_EnableClickOnEntityDashboardIcon()?this.getTabIndex():null,onKeyDown:this.handleKeyDownForEntityDashboardIcon},FontIcon.FontIcon({symbolName:"EntityDashboard"}));children.push(entityDashboardIcon)}return React.DOM.div({className:CssClassSet({interactionCentricGrid:this.props.dataContext.get_IsGridFormContext(),interactionCentricSubGrid:!this.props.dataContext.get_IsGridFormContext()})},children)};return InteractionCentricGridListSpec}(TsAdapter.SpecBase);exports.InteractionCentricGridList=DataWrapperComponent.wrapComponent(new InteractionCentricGridListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/FieldsPane",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/ComponentFactory","Components/Primitives/ScrollRegion","Components/Common/LoadingBar","Components/Fields/DetailFieldsSection","Utils/CssClassSet","Utils/PreserveScrollPositionMixin"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,ComponentFactory,ScrollRegion,LoadingBar,DetailFieldsSection,CssClassSet,PreserveScrollPosition){var FieldsPaneLoadingBar=LoadingBar.createLoadingBar("EnableEdits",false),FieldsPaneContainerSpec=function(_super){__extends(FieldsPaneContainerSpec,_super);function FieldsPaneContainerSpec(){_super.apply(this,arguments);this.displayName="FieldsPaneContainer";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["EnableEdits","IsLoading"]}FieldsPaneContainerSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet({loading:this.props.dataContext.get_EnableEdits()},this.props.className),"data-vmid":this.props.dataContext.get_ViewModelId()},this.props.children)};return FieldsPaneContainerSpec}(TsAdapter.SpecBase),FieldsPaneContainer=DataWrapperComponent.wrapComponent(new FieldsPaneContainerSpec);exports.DESCRIPTOR_NAME="CrmFieldsComponent";var FieldsPaneSpec=function(_super){__extends(FieldsPaneSpec,_super);function FieldsPaneSpec(){_super.apply(this,arguments);this.displayName="FieldsPane";this.mixins=[PreserveScrollPosition.Mixin]}FieldsPaneSpec.prototype.getScrollPreservationStrategy=function(){return new PreserveScrollPosition.ComponentRefScrollPreservationStrategy("scroll")};FieldsPaneSpec.prototype.render=function(){var children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext),progress=FieldsPaneLoadingBar({key:"progress",clientContext:this.props.clientContext,dataContext:this.props.dataContext}),scrollRegion=ScrollRegion.ScrollRegion({key:"scroll",className:"group_content"},children);return FieldsPaneContainer({clientContext:this.props.clientContext,dataContext:this.props.dataContext,className:CssClassSet({"group panoramaItem-control":true,headerFieldsPane:this.props.descriptor&&this.props.descriptor.Properties&&this.props.descriptor.Properties["IsHeaderFieldsPane"]})},[progress,scrollRegion])};return FieldsPaneSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(DetailFieldsSection.DESCRIPTOR_NAME,DetailFieldsSection.DetailFieldsSection);exports.FieldsPane=DataWrapperComponent.wrapComponent(new FieldsPaneSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/HierarchyDrilldown",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var HierarchyDrilldownSpec=function(_super){__extends(HierarchyDrilldownSpec,_super);function HierarchyDrilldownSpec(){_super.apply(this,arguments);this.displayName="HierarchyDrilldown";this.mixins=[PureUpdate.Mixin]}HierarchyDrilldownSpec.prototype.handleShortPressEventForDrilldown=function(e){if(this.props.dataContext){e.stopPropagation();this.props.parentList.set_IsDrilldown(true);this.props.parentList.modifyBreadcrumbsList(this.props.dataContext)}};HierarchyDrilldownSpec.prototype.render=function(){return React.DOM.div({"data-id":"drilldown",className:"drilldown symbolFont Drilldown-symbol",onShortPress:this.handleShortPressEventForDrilldown})};return HierarchyDrilldownSpec}(TsAdapter.SpecBase);exports.HierarchyDrilldown=TsAdapter.createComponent(new HierarchyDrilldownSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/HierarchyList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lists/MultilineList","Components/Lists/HierarchyListItem","Components/Lists/HierarchyDrilldown"],function(require,exports,TsAdapter,DataWrapperComponent,MultilineList,HierarchyListItem,HierarchyDrilldown){exports.DESCRIPTOR_NAME="HierarchyList";var HierarchyListSpec=function(_super){__extends(HierarchyListSpec,_super);function HierarchyListSpec(){_super.apply(this,arguments);this.displayName="HierarchyList";this.listenToProperties=["IsBreadcrumbCapExceeded","HierarchyMessage","HierarchyListItemDescriptor","PrimaryFieldAttribute"];this.listenToCollections=["BreadcrumbViewModels"]}HierarchyListSpec.prototype.renderHierarchyMessage=function(){var symbol=React.DOM.div({key:"symbol",className:"messageSymbol"}),view=React.DOM.div({key:"message",className:"messageView"},this.props.dataContext.get_HierarchyMessage());return React.DOM.div({key:"error",className:"messageDiv"},[symbol,view])};HierarchyListSpec.prototype.renderHiearchyRecords=function(){var results=[],itemsCollection=this.props.dataContext.get_BreadcrumbViewModels();if(itemsCollection)for(var itemsCount=itemsCollection.get_Count(),i=0;i<itemsCount;i++){var item=itemsCollection.getItem(i);results.push(HierarchyListItem.HierarchyListItem({key:item.get_ViewModelId(),parentGivenKey:item.get_ViewModelId(),clientContext:this.props.clientContext,dataContext:item,descriptor:this.props.dataContext.get_HierarchyListItemDescriptor(),parentList:this.props.dataContext,className:"breadcrumb",dataActive:i===itemsCount-1,isLastItem:i===itemsCount-1}))}return results};HierarchyListSpec.prototype.renderHierarchyListContainer=function(children){return React.DOM.div({key:"hierarchycontainer",className:"SimpleListView","data-listtype":"hierarchy"},children)};HierarchyListSpec.prototype.renderHierarchyContent=function(){var children=[];this.props.dataContext.get_IsBreadcrumbCapExceeded()&&children.push(this.renderHierarchyMessage());var hierachyRecords=this.renderHiearchyRecords();children.push(this.renderHierarchyListContainer(hierachyRecords));return children};HierarchyListSpec.prototype.renderHierarchyItem=function(item,childIndex,selectedMarkComponent,itemDataContext){var drilldown;if(itemDataContext.get_ShowDrilldown())drilldown=HierarchyDrilldown.HierarchyDrilldown({key:"drilldown","data-id":"drilldown",className:"drilldown symbolFont Drilldown-symbol",parentList:this.props.dataContext,clientContext:this.props.clientContext,dataContext:itemDataContext});var drilldownParent=React.DOM.div({key:"drilldownParent",className:"drilldownParent"},[item]);return React.DOM.div({key:item.props.key},[drilldownParent,drilldown])};HierarchyListSpec.prototype.render=function(){return MultilineList.MultilineList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,beforeContentRenderer:this.renderHierarchyContent,useExtraContentRenderersWithNoRecords:true,listItemClassName:"hierarchyItem",listItemRenderer:this.renderHierarchyItem})};return HierarchyListSpec}(TsAdapter.SpecBase);exports.HierarchyList=DataWrapperComponent.wrapComponent(new HierarchyListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/SearchSummary",["require","exports","Components/DataWrapperComponent","Core/ReactTypescriptAdapter"],function(require,exports,DataWrapperComponent,TsAdapter){exports.DESCRIPTOR_NAME="SearchSummaryView";var SearchSummarySpec=function(_super){__extends(SearchSummarySpec,_super);function SearchSummarySpec(){_super.apply(this,arguments);this.displayName="SearchSummary";this.listenToProperties=["DisplayMode","SearchResults"]}SearchSummarySpec.prototype.render=function(){var children=[];if(this.props.dataContext)if(this.props.dataContext.get_DisplayMode()===2)children.push(this.renderErrorMessageContainer());else this.props.dataContext.get_DisplayMode()===1&&children.push(this.renderSearchSummaryContainer());return React.DOM.span({className:"SearchSummaryViewContainer"},children)};SearchSummarySpec.prototype.renderErrorMessageContainer=function(){return React.DOM.div({id:"SearchErrorMessageContainer"},this.renderErrorMessageDescription())};SearchSummarySpec.prototype.renderErrorMessageDescription=function(){if(this.props.dataContext.get_IsRelevanceSearch())return React.DOM.div({className:"relevanceSearchErrorMessage",id:"SearchErrorMessage"},this.props.dataContext.get_RelevanceSearchServerErrorText())};SearchSummarySpec.prototype.renderSearchSummaryContainer=function(){return React.DOM.div({key:"searchSummaryContainerKey",className:"SummaryContainer",id:"searchSummaryContainer"},this.renderSummaryObject())};SearchSummarySpec.prototype.renderSummaryObject=function(){var searchCollectionResults=this.props.dataContext.get_SearchResults(),results=searchCollectionResults&&searchCollectionResults.get_SearchResults(),items=results&&results.get_Items();if(items&&items.length===0&&searchCollectionResults.get_ErrorCode()===0)return React.DOM.div({className:"summaryDescription",id:"summaryDescription"},this.props.dataContext.get_NoResultsFoundText());else return React.DOM.div({className:"summaryDescription",id:"summaryDescription"},this.renderResultChildren())};SearchSummarySpec.prototype.renderResultChildren=function(){var children=[],errorEntityList=this.props.dataContext.get_ErrorEntityList();if(errorEntityList)for(var i=0;i<errorEntityList.get_Count();i++){var result=errorEntityList.get_Items()[i];if(result){var errorElement=React.DOM.div({key:result.get_DisplayName(),className:"searchErrorMessage","data-id":"error"+result.get_EntityLogicalName()},this.props.dataContext.getErrorElementHtml(result.get_DisplayName(),result.get_ErrorCode()));children.push(errorElement)}}var noResultsEntity=this.props.dataContext.get_NoResultsEntity();if(noResultsEntity){var noResultsObject=React.DOM.div({key:"noResultsKey",className:"summaryNoResult","data-id":"noResultElement"},this.props.dataContext.get_NoResultsEntity());return [noResultsObject].concat(children)}else return children};return SearchSummarySpec}(TsAdapter.SpecBase);exports.SearchSummary=DataWrapperComponent.wrapComponent(new SearchSummarySpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/UserInfo",["require","exports","Components/DataWrapperComponent","Core/ReactTypescriptAdapter"],function(require,exports,DataWrapperComponent,TsAdapter){exports.DESCRIPTOR_NAME="UserInfoView";var UserInfoSpec=function(_super){__extends(UserInfoSpec,_super);function UserInfoSpec(){_super.apply(this,arguments);this.displayName="UserInfo";this.listenToProperties=["DisplayMode"]}UserInfoSpec.prototype.render=function(){var children=[],p1=React.DOM.p({key:"message1"},this.props.dataContext.get_SearchTipsSectionContentDetails());children.push(p1);var p2=React.DOM.p({key:"message2"},this.props.dataContext.get_SearchTipsSectionContentMoreDetails());children.push(p2);var scrollRegion=React.DOM.div({className:"tipsSectionScrollRegion",id:"tipsSectionScrollRegion"},children),tipSectionContent=React.DOM.div({className:"tipsSectionContent",id:"tipsSectionContent"},scrollRegion),spn=React.DOM.span({id:"tipsSectionTitle",className:"tipsSectionTitle"},this.props.dataContext.get_SearchTipsSectionLabel());return React.DOM.div({className:"tipsSectionContainer",id:"tipsSectionContainer"},[spn,tipSectionContent])};return UserInfoSpec}(TsAdapter.SpecBase);exports.UserInfo=DataWrapperComponent.wrapComponent(new UserInfoSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/RangeSliderControl",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){exports.DESCRIPTOR_NAME="RangeSliderControl";var RangeSliderControlSpec=function(_super){__extends(RangeSliderControlSpec,_super);function RangeSliderControlSpec(){_super.apply(this,arguments);this.displayName="RangeSliderControl";this.listenToProperties=["ClearFilter"]}RangeSliderControlSpec.prototype.componentDidMount=function(){this.rangeSliderUpdate()};RangeSliderControlSpec.prototype.componentDidUpdate=function(){this.rangeSliderUpdate()};RangeSliderControlSpec.prototype.rangeSliderUpdate=function(){$(this.refs["rangeSlider"]).slider({range:true,min:this.props.dataContext.get_MinRange(),max:this.props.dataContext.get_MaxRange(),values:[this.props.dataContext.get_SelectedMinimum(),this.props.dataContext.get_SelectedMaximum()],step:1/Math.pow(10,this.props.dataContext.get_DecimalPrecision()),create:function(event,ui){var minRange=this.props.dataContext.get_MinRange(),maxRange=this.props.dataContext.get_MaxRange(),decimalPrecision=this.props.dataContext.get_DecimalPrecision();$(this.refs["leftVal"]).val(parseFloat(minRange).toFixed(decimalPrecision));$(this.refs["rightVal"]).val(parseFloat(maxRange).toFixed(decimalPrecision));$(this.refs["leftVal"]).text(this.props.dataContext.get_LabelAll())}.bind(this),slide:function(event,ui){if(this.props.enableRangeEditTextBox){$(this.refs["leftVal"]).val(ui.values[0]);$(this.refs["rightVal"]).val(ui.values[1])}else{$(this.refs["leftVal"]).text(this.props.labelsForSteps[ui.values[0]]);$(this.refs["rightVal"]).text(this.props.labelsForSteps[ui.values[1]])}}.bind(this),stop:function(event,ui){if(this.props.dataContext.get_SelectedMinimum()!=ui.values[0]||this.props.dataContext.get_SelectedMaximum()!=ui.values[1]){var decimalPrecision=this.props.dataContext.get_DecimalPrecision();this.props.dataContext.set_SelectedMinimum(ui.values[0].toFixed(decimalPrecision));this.props.dataContext.set_SelectedMaximum(ui.values[1].toFixed(decimalPrecision));this.props.dataContext.set_ClearFilter(false);this.props.dataContext.onDataChange();this.props.onDataChangeFilterCallBack&&this.props.onDataChangeFilterCallBack(ui.values[0],ui.values[1],this.props.filterColumn)}}.bind(this)})};RangeSliderControlSpec.prototype.resizeSlider=function(){this.props.dataContext.limitSliderValues();var selectedMin=this.props.dataContext.get_SelectedMinimum(),selectedMax=this.props.dataContext.get_SelectedMaximum(),leftVal=this.refs["leftVal"],rightVal=this.refs["rightVal"],rangeSlider=this.refs["rangeSlider"];if(leftVal instanceof Element&&rightVal instanceof Element&&rangeSlider instanceof Element){$(leftVal).val(selectedMin);$(rightVal).val(selectedMax);$(rangeSlider).slider({values:[selectedMin,selectedMax]})}this.props.dataContext.onDataChange()};RangeSliderControlSpec.prototype.resetLabels=function(){var leftVal=this.refs["leftVal"],rightVal=this.refs["rightVal"];if(leftVal instanceof Element&&rightVal instanceof Element){$(leftVal).text(this.props.dataContext.get_LabelAll());$(rightVal).text("")}};RangeSliderControlSpec.prototype.clearSelectedRange=function(){this.props.dataContext.clearRange();this.resizeSlider();this.resetLabels()};RangeSliderControlSpec.prototype.isNumberKey=function(evt){var charCode=evt.which?evt.which:evt.keyCode;if((charCode<48||charCode>57)&&charCode!=190&&charCode!=37&&charCode!=39&&charCode!=46&&charCode!=8&&charCode!=13&&charCode!=109&&charCode!=189)return false;this.props.dataContext.set_LastCharCode(charCode);var target=evt.target,aNumber=target.value*1;if(aNumber%1!=0&&charCode==190)return false;return true};RangeSliderControlSpec.prototype.handleMinValue=function(event){if(event&&event.target){var target=event.target,aNumber=target.value*1;if(isNaN(aNumber))return false;var charCode=this.props.dataContext.get_LastCharCode();if(charCode>=48&&charCode<=57||charCode==8||charCode==46||charCode==0||charCode==190||charCode==13||charCode==109||charCode==189){if((charCode==46||charCode==8||charCode==190)&&Math.floor(this.props.dataContext.get_SelectedMinimum())==Math.floor(aNumber))return;if(aNumber<this.props.dataContext.get_MinRange())return;this.props.dataContext.set_SelectedMinimum(parseFloat(aNumber.toFixed(this.props.dataContext.get_DecimalPrecision())));this.props.dataContext.set_ClearFilter(false);this.resizeSlider()}}};RangeSliderControlSpec.prototype.handleMaxValue=function(event){if(event&&event.target){var target=event.target,aNumber=target.value*1;if(isNaN(aNumber))return false;var charCode=this.props.dataContext.get_LastCharCode();if(charCode>=48&&charCode<=57||charCode==46||charCode==8||charCode==0||charCode==190||charCode==13||charCode==109||charCode==189){if((charCode==46||charCode==8||charCode==190)&&Math.floor(this.props.dataContext.get_SelectedMaximum())==Math.floor(aNumber))return;if(aNumber<this.props.dataContext.get_MinRange())return;this.props.dataContext.set_SelectedMaximum(parseFloat(aNumber.toFixed(this.props.dataContext.get_DecimalPrecision())));this.props.dataContext.set_ClearFilter(false);this.resizeSlider()}}};RangeSliderControlSpec.prototype.render=function(){if(this.props.enableClearFilterButton)var clearButton=React.DOM.button({key:"clearButton",onClick:this.clearSelectedRange,className:"SliderControlClearButton"},this.props.clientContext.getLocalizedString("SliderControl_ClearButton"));var valType=this.props.enableRangeEditTextBox?React.DOM.input:React.DOM.label,leftVal=valType({ref:"leftVal",key:"leftVal",onKeyDown:this.isNumberKey,onKeyUp:this.handleMinValue,className:CssClassSet(null,"RangeSliderControlValues","LeftSliderControlValues")}),rightVal=valType({ref:"rightVal",key:"rightVal",onKeyDown:this.isNumberKey,onKeyUp:this.handleMaxValue,className:CssClassSet(null,"RangeSliderControlValues","RightSliderControlValues")}),sliderBar=React.DOM.div({ref:"rangeSlider",key:"rangeSlider",orientation:"horizontal",className:"RangeSliderControlSliderBar"}),children=[];this.props.dataContext.get_ClearFilter()&&this.clearSelectedRange();if(this.props.enableClearFilterButton){var clearButtonDiv=React.DOM.div({key:"clearButtonDiv",align:"right"},clearButton);children.push(clearButtonDiv);if(this.props.dataContext.get_GlobalClearFilter()){this.props.dataContext.set_GlobalClearFilter(false);this.clearSelectedRange()}}return React.DOM.div({className:"RangeSlider"},children,sliderBar,leftVal,rightVal)};return RangeSliderControlSpec}(TsAdapter.SpecBase);exports.RangeSliderControl=DataWrapperComponent.wrapComponent(new RangeSliderControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/AutoComplete",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){exports.DESCRIPTOR_NAME="AutoCompleteControl";var AutoCompleteControlSpec=function(_super){__extends(AutoCompleteControlSpec,_super);function AutoCompleteControlSpec(){_super.apply(this,arguments);this.displayName="AutoCompleteControl";this.mixins=[PureUpdate.Mixin]}AutoCompleteControlSpec.prototype.componentDidMount=function(){$(this.refs["autoComplete"]).autocomplete({source:this.props.source,select:function(event,ui){this.props.itemSelectCallBack(ui.item.value)}.bind(this)})};AutoCompleteControlSpec.prototype.render=function(){var autoCompleteSearchBox=React.DOM.input({ref:"autoComplete",className:"autoCompleteControlValues"});return React.DOM.div({className:"autoCompleteSearchBox"},autoCompleteSearchBox)};return AutoCompleteControlSpec}(TsAdapter.SpecBase);exports.AutoCompleteControl=TsAdapter.createComponent(new AutoCompleteControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/TextBasedFacetResult",["require","exports","Components/DataWrapperComponent","Core/ReactTypescriptAdapter","Components/Primitives/FontIcon","Utils/CssClassSet"],function(require,exports,DataWrapperComponent,TsAdapter,FontIcon,CssClassSet){exports.DESCRIPTOR_NAME="TextBasedFacetResultView";var TextBasedFacetResultSpec=function(_super){__extends(TextBasedFacetResultSpec,_super);function TextBasedFacetResultSpec(){_super.apply(this,arguments);this.displayName="TextBasedFacetResult";this.listenToProperties=["ImageUrl"]}TextBasedFacetResultSpec.prototype.handleTextBasedFacetResultButtonClick=function(e){this.props.onClick&&this.props.onClick(e,this.props.dataContext)};TextBasedFacetResultSpec.prototype.render=function(){var textBasedFacetResultChildren=[],recordCountDiv=React.DOM.div({key:"facetPaneElementCount",className:"facetPaneElementCount"},"("+this.props.dataContext.get_Count()+")");textBasedFacetResultChildren.push(recordCountDiv);var textFacetLogicalName=this.props.dataContext.get_FacetAttributeLogicalName();if(this.props.dataContext.get_FacetResultType()==1){var textBasedFacetIcon=FontIcon.FontIcon({symbolName:"Entity",className:CssClassSet({},"button-commandRing","entity-symbol",textFacetLogicalName,"facetPaneImage"),key:"icon"});textBasedFacetResultChildren.push(textBasedFacetIcon)}else if(this.props.dataContext.get_FacetResultType()==0||this.props.dataContext.get_FacetAttributeType()==6){var imageUrl=this.props.dataContext.get_ImageUrl()?this.props.dataContext.get_ImageUrl():this.props.dataContext.get_TextFacetDefaultImage(),textBasedImageDiv=React.DOM.img({key:"image",src:imageUrl,className:CssClassSet({},"textFacetImage","facetPaneImage")});textBasedFacetResultChildren.push(textBasedImageDiv)}var entityNameLabel=React.DOM.label({key:"entityNameLabel",className:"facetPaneLabels",onClick:this.handleTextBasedFacetResultButtonClick},this.props.dataContext.get_FacetValue());textBasedFacetResultChildren.push(entityNameLabel);return React.DOM.div({className:"facetPaneElements"},textBasedFacetResultChildren)};return TextBasedFacetResultSpec}(TsAdapter.SpecBase);exports.TextBasedFacetResult=DataWrapperComponent.wrapComponent(new TextBasedFacetResultSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/Facet",["require","exports","Components/DataWrapperComponent","Core/ReactTypescriptAdapter","Components/Search/RangeSliderControl","Components/Search/AutoComplete","Components/Search/TextBasedFacetResult"],function(require,exports,DataWrapperComponent,TsAdapter,SliderControl,AutoComplete,TextBasedFacetResult){exports.DESCRIPTOR_NAME="FacetView";var FacetSpec=function(_super){__extends(FacetSpec,_super);function FacetSpec(){_super.apply(this,arguments);this.displayName="Facet";this.listenToProperties=["EnableShowMore"]}FacetSpec.prototype.activitiesNotesCheckBoxChildren=function(){var activitiesOrNotesCheckBox=React.DOM.input({key:"activitiesOrNotesCheckBox",type:"checkbox",onClick:this.handleCheckboxClick,checked:this.props.dataContext.get_ActivityNotesCheckBoxData()}),label=React.DOM.span({key:"activitiesOrNotesLabel",className:"facetActivitiesOrNotesLabel"},this.props.dataContext.get_FacetSearchActivitiesAndNotes());return React.DOM.div({key:"activitiesOrNotes",className:"facetActivitiesOrNotesDiv"},[activitiesOrNotesCheckBox,label])};FacetSpec.prototype.handleCheckboxClick=function(){if(this.props.dataContext){var currentState=this.props.dataContext.get_ActivityNotesCheckBoxData();this.props.dataContext.set_ActivityNotesCheckBoxData(!currentState);this.props.dataContext.RecordTypeCheckBoxClickHandler()}};FacetSpec.prototype.renderAllButton=function(){return React.DOM.div({key:"allButton",onClick:this.handleAllButtonClick,style:{marginTop:"10px",cursor:"pointer"}},this.props.dataContext.get_FacetLabelAll())};FacetSpec.prototype.handleAllButtonClick=function(){this.props.dataContext&&this.props.dataContext.ExecuteSearchAction(null,true,this.props.dataContext.get_FacetAttributeLogicalName())};FacetSpec.prototype.renderShowButton=function(){return React.DOM.div({key:"showButton",className:"showLabel",onClick:this.handleShowButtonClick},this.props.dataContext.get_ShowButtonLabel())};FacetSpec.prototype.handleShowButtonClick=function(){this.props.dataContext.set_EnableShowMore(!this.props.dataContext.get_EnableShowMore())};FacetSpec.prototype.sliderOnDataChange=function(lowerIndex,upperIndex){this.props.dataContext.FacetSliderOnChange(lowerIndex,upperIndex-1)};FacetSpec.prototype.renderTextBasedFacetItem=function(item,index){return TextBasedFacetResult.TextBasedFacetResult({key:"textBasedFacetItem"+index,clientContext:this.props.clientContext,dataContext:item,onClick:this.handleTextBasedFacetItemClick})};FacetSpec.prototype.handleTextBasedFacetItemClick=function(e,item){item&&item.executeAction()};FacetSpec.prototype.renderTextBasedFacet=function(){var elements=[],textBasedFacetArray=this.props.dataContext.get_FacetList().toArray();if(this.props.dataContext.get_IsSelected()){var allButton=this.renderAllButton();elements.push(allButton)}var defaultFacetsToDisplay=this.props.dataContext.get_DefaultFacetsToDisplay(),maxFacetsToDisplay=this.props.dataContext.get_MaxFacetsToDisplay(),itemsCount=textBasedFacetArray.length,facetsToDisplay=defaultFacetsToDisplay;if(itemsCount>defaultFacetsToDisplay){if(!this.props.dataContext.get_EnableShowMore())facetsToDisplay=itemsCount>maxFacetsToDisplay?this.props.dataContext.get_MaxFacetsToDisplayWithAutoComplete():itemsCount}else facetsToDisplay=itemsCount;for(var j=0;j<facetsToDisplay;j++){var textBasedFacetResultViewModel=textBasedFacetArray[j],recordItem=this.renderTextBasedFacetItem(textBasedFacetResultViewModel,j);elements.push(recordItem)}if(this.props.dataContext.get_FacetResultType()==1&&this.props.dataContext.get_IsSelected()){var chkActivitesNotesDiv=this.activitiesNotesCheckBoxChildren();elements.push(chkActivitesNotesDiv)}if(itemsCount>maxFacetsToDisplay&&!this.props.dataContext.get_EnableShowMore())if(this.props.dataContext.get_FacetList()){for(var autoCompleteItems=[],i=0;i<this.props.dataContext.get_FacetList().get_Items().length;i++)autoCompleteItems[i]=this.props.dataContext.get_FacetList().get_Items()[i].get_FacetValue();var autoComplete=AutoComplete.AutoCompleteControl({key:"autoComplete",source:autoCompleteItems,itemSelectCallBack:this.onAutoCompleteItemSelected});elements.push(autoComplete)}if(itemsCount>defaultFacetsToDisplay){var showButton=this.renderShowButton();elements.push(showButton)}return React.DOM.div({key:"textBasedFacets",className:"facetElementsAll"},elements)};FacetSpec.prototype.renderRangeBasedFacet=function(){var rangeBasedFacetArray=this.props.dataContext.get_FacetList().toArray(),rangeSliderFacetViewModel=rangeBasedFacetArray[0];return SliderControl.RangeSliderControl({key:"rangeBasedFacets",clientContext:this.props.clientContext,dataContext:rangeSliderFacetViewModel,enableClearFilterButton:false,enableRangeEditTextBox:false,onDataChangeFilterCallBack:this.sliderOnDataChange,labelsForSteps:rangeSliderFacetViewModel.get_RangeSliderValues()})};FacetSpec.prototype.onAutoCompleteItemSelected=function(entity){this.props.dataContext.ExecuteSearchAction(entity,false,"")};FacetSpec.prototype.render=function(){var facetHeaderName=this.props.dataContext.get_FacetAttributeDisplayName(),headerElementDiv=React.DOM.div({key:"headerElement",className:"facetHeaderElement"},facetHeaderName),facetElements=this.props.dataContext.get_FacetType()==0?this.renderTextBasedFacet():this.renderRangeBasedFacet();return React.DOM.div({className:"facetSubPane"},[headerElementDiv,facetElements])};return FacetSpec}(TsAdapter.SpecBase);exports.Facet=DataWrapperComponent.wrapComponent(new FacetSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Search/FacetPane",["require","exports","Components/DataWrapperComponent","Core/ReactTypescriptAdapter","Components/Search/Facet"],function(require,exports,DataWrapperComponent,TsAdapter,Facet){exports.DESCRIPTOR_NAME="FacetPaneView";var FacetPaneSpec=function(_super){__extends(FacetPaneSpec,_super);function FacetPaneSpec(){_super.apply(this,arguments);this.displayName="FacetPane";this.listenToProperties=["FacetViewModelList"]}FacetPaneSpec.prototype.renderFacetPane=function(){var results=[],facetList=this.props.dataContext.get_FacetViewModelList();if(facetList){for(var itemsCount=facetList.get_Count(),facetViewModelArray=facetList.toArray(),i=0;i<itemsCount;i++){var facetViewModel=facetViewModelArray[i],facetType=Facet.Facet({key:"facet"+i,clientContext:this.props.clientContext,dataContext:facetViewModel});results.push(facetType)}return results}};FacetPaneSpec.prototype.render=function(){var facetPane=this.renderFacetPane();return React.DOM.div({className:"facetSubPaneRoot"},facetPane)};return FacetPaneSpec}(TsAdapter.SpecBase);exports.FacetPane=DataWrapperComponent.wrapComponent(new FacetPaneSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/MessageHtmlLabel",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Utils/CssClassSet","Components/Primitives/AncestorMountedHost","Components/Primitives/Button","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,CssClassSet,AncestorMountedHost,Button,FontIcon){exports.DESCRIPTOR_NAME="MessageHtmlLabel";var MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS=["http:","https:"],MessageHtmlLabelSpec=function(_super){__extends(MessageHtmlLabelSpec,_super);function MessageHtmlLabelSpec(){_super.apply(this,arguments);this.displayName="MessageHtmlLabel";this.listenToProperties=["Data"];this.setHandlers=true;this.updateCounter=0;this.shouldForceUpdate=false}MessageHtmlLabelSpec.prototype.getInitialState=function(){return {inPopup:false,isCutoff:false}};MessageHtmlLabelSpec.prototype.getLoadMarker=function(){return '<div style="display:none" data-id="'+this.getDataId()+'"></div>'};MessageHtmlLabelSpec.prototype.getDataId=function(){return this.props.dataContext.get_ViewModelId()+"--"+this.updateCounter};MessageHtmlLabelSpec.prototype.iFrameUpdate=function(){var _this=this,iframeElement=this.refs["iframe"];if(iframeElement instanceof HTMLIFrameElement){var innerBody=iframeElement.contentDocument.body,data=this.props.dataContext.get_Data();if(this.oldData!==data||this.shouldForceUpdate){if(!this.shouldForceUpdate)this.updateCounter++;innerBody.innerHTML=this.getLoadMarker()+data;innerBody.style.margin="0px";if(this.props.clientContext.isPhone&&!this.state.inPopup)innerBody.style.overflow="hidden";this.oldData=data;this.shouldForceUpdate=false}this.setAnchorTagBindings(true,iframeElement);window.setTimeout(function(){_this.checkIsIframeCutoff()},0)}};MessageHtmlLabelSpec.prototype.checkIsIframeCutoff=function(){var isCutoff=false;if(this.isMounted()){var iframeElement=this.refs["iframe"];if(iframeElement instanceof HTMLIFrameElement){var innerBody=iframeElement.contentDocument.body;if($(innerBody).find('[data-id="'+this.getDataId()+'"]').length<1)this.iFrameUpdate();else{var node=ReactDOM.findDOMNode(this);if(this.oldData&&(innerBody.scrollHeight>node.clientHeight||innerBody.scrollWidth>node.clientWidth))isCutoff=true;isCutoff!=this.state.isCutoff&&this.setState({isCutoff:isCutoff})}}}};MessageHtmlLabelSpec.prototype.anchorClicked=function(evt){var targetNode=evt.target;while(targetNode.nodeName!="A")if(targetNode.parentNode&&targetNode.parentNode.nodeName!="BODY")targetNode=targetNode.parentNode;else return;var url=targetNode.href;if(url){var command=this.props.clientContext.getUrlLauncherCommand(targetNode.protocol,url);command.get_CanExecute()&&command.execute();evt.stopPropagation();evt.preventDefault();command.dispose()}};MessageHtmlLabelSpec.prototype.updateAnchorHandlers=function(iFrame){var _this=this;try{var anchors=$(iFrame.contentWindow.document.body).find("A").each(function(index,element){for(var anchorElement=element,i=0;i<MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS.length;i++)try{if(anchorElement.protocol==MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS[i])if(_this.setHandlers)anchorElement.addEventListener("click",_this.anchorClicked);else anchorElement.removeEventListener("click",_this.anchorClicked)}catch(e){}})}catch(e2){}};MessageHtmlLabelSpec.prototype.setAnchorTagBindings=function(setHandlers,iFrame){this.setHandlers=setHandlers;iFrame&&this.updateAnchorHandlers(iFrame)};MessageHtmlLabelSpec.prototype.componentDidMount=function(){this.iFrameUpdate()};MessageHtmlLabelSpec.prototype.componentDidUpdate=function(){this.iFrameUpdate()};MessageHtmlLabelSpec.prototype.componentWillUnmount=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.hidePopup);var iframeElement=this.refs["iframe"];iframeElement instanceof HTMLIFrameElement&&this.setAnchorTagBindings(false,iframeElement)};MessageHtmlLabelSpec.prototype.showPopup=function(){this.props.clientContext.reactBackHandlerHelper.addHandler(this.hidePopup);this.shouldForceUpdate=true;this.setState({inPopup:true})};MessageHtmlLabelSpec.prototype.hidePopup=function(){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.hidePopup);this.shouldForceUpdate=true;this.setState({inPopup:false})};MessageHtmlLabelSpec.prototype.renderInline=function(){var children=[],isPhone=this.props.clientContext.isPhone;if(isPhone&&this.state.isCutoff){var blocker=React.DOM.div({key:"blocker",className:"iframeBlocker"});children.push(blocker);var button=Button.Button({key:"open",className:"emailMoreButton",onClick:this.showPopup},FontIcon.FontIcon({symbolName:"More"}));children.push(button)}var iframe=React.DOM.iframe({key:"iframe",ref:"iframe",className:"emailControlIframe"});children.push(iframe);return React.DOM.div({className:CssClassSet({windowsLineHeight:this.props.clientContext.userAgent.get_IsWinPhone(),noData:!this.oldData},"iframeWrapper")},children)};MessageHtmlLabelSpec.prototype.renderPopup=function(){var iframe=React.DOM.iframe({key:"iframe",ref:"iframe",className:"popoverIframe"}),iframeContainer=React.DOM.div({className:!this.props.clientContext.userAgent.get_IsIOS()&&this.props.clientContext.userAgent.get_IsMobilePhone()?"phone-noniOS-popoverIframeContainer":"popoverIframeContainer",key:"frameContainer"},iframe),backButton=ImageButton.ImageButton({key:"okButton",label:this.props.clientContext.getLocalizedString("L_Back_Button_Text"),imageType:"Symbol",imageName:"Close",onClick:this.hidePopup}),buttonContainer=React.DOM.div({key:"buttonContainer",className:"emailBody-buttonContainer appBarSection"},backButton),controlBar=React.DOM.div({key:"controlBar",className:"emailBody-controlBar appBar"},buttonContainer),popOver=React.DOM.div({className:this.props.clientContext.userAgent.get_IsIPhone()?"iPhone-emailBody-popOver":"emailBody-popOver",ref:"popover",id:"emailBody-popOver"},[iframeContainer,controlBar]),host=AncestorMountedHost.AncestorMountedHost({selectorString:"body"},popOver);return host};MessageHtmlLabelSpec.prototype.render=function(){if(this.state.inPopup)return this.renderPopup();else return this.renderInline()};return MessageHtmlLabelSpec}(TsAdapter.SpecBase);exports.MessageHtmlLabel=DataWrapperComponent.wrapComponent(new MessageHtmlLabelSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridContainerHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Lists/InteractBarListHeader"],function(require,exports,TsAdapter,DataWrapperComponent,InteractBarListHeader){exports.DESCRIPTOR_NAME="GridContainerHeader";var GridContainerHeaderSpec=function(_super){__extends(GridContainerHeaderSpec,_super);function GridContainerHeaderSpec(){_super.apply(this,arguments);this.displayName="GridContainerHeader";this.listenToProperties=["PropBagGenerator"]}GridContainerHeaderSpec.prototype.render=function(){var propBagGenerator=this.props.dataContext.get_PropBagGenerator();if(propBagGenerator){var dataSetObject=propBagGenerator.GetPrimaryDataSet();if(dataSetObject){var dataSetViewModel=dataSetObject.get_DataSetViewModel();if(!this.props.clientContext.isPhone&&this.props.dataContext.get_Root().get_ComponentType()===13){var header=React.DOM.span({key:"title",className:"gridHeader"},dataSetViewModel.get_Title());if(!this.props.clientContext.isMailApp&&!this.props.clientContext.isInteractionCentric)var subHeader=React.DOM.div({key:"subTitle",className:"header-subtitle"},this.props.dataContext.get_PluralName());return React.DOM.div({className:"listHeader hideExtraPadding"},[header,subHeader])}else return InteractBarListHeader.InteractBarListHeader({clientContext:this.props.clientContext,dataContext:dataSetViewModel,descriptor:this.props.descriptor,truncateHeader:false})}}return React.DOM.noscript()};return GridContainerHeaderSpec}(TsAdapter.SpecBase);exports.GridContainerHeader=DataWrapperComponent.wrapComponent(new GridContainerHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Grids/GridContainer",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Grids/GridContainerHeader"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,GridContainerHeader){exports.DESCRIPTOR_NAME="GridContainer";var GridContainerSpec=function(_super){__extends(GridContainerSpec,_super);function GridContainerSpec(){_super.apply(this,arguments);this.displayName="GridContainer";this.listenToProperties=["ChildComponent"]}GridContainerSpec.prototype.componentWillMount=function(){};GridContainerSpec.prototype.componentDidMount=function(){};GridContainerSpec.prototype.componentWillUnmount=function(){};GridContainerSpec.prototype.childDecorator=function(factory,childProps){childProps["expectedContainerHeight"]=this.props.expectedContainerHeight;childProps["expectedContainerWidth"]=this.props.expectedContainerWidth;return factory(childProps)};GridContainerSpec.prototype.render=function(){var childDescriptor=this.props.dataContext.get_ActiveViewDescriptor(),childControl=null,children=[];if(childDescriptor){for(var key in this.props.descriptor.ChildControlViewDescriptors)delete this.props.descriptor.ChildControlViewDescriptors[key];if(childDescriptor.TypeName==="CustomControlHostView"&&!this.props.clientContext.userAgent.get_IsInteractionCentricDashboard()){var customControlDataContext=this.props.dataContext.get_ActiveViewModel(),header=GridContainerHeader.GridContainerHeader({key:"header",clientContext:this.props.clientContext,dataContext:customControlDataContext,descriptor:childDescriptor});children.push(header)}this.props.descriptor.ChildControlViewDescriptors[childDescriptor.BindingPath]=childDescriptor;childControl=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);children.push(childControl)}return React.DOM.div({ref:"gridcontainer",className:"gridcontainer",id:this.props.dataContext.get_Id()},children)};return GridContainerSpec}(TsAdapter.SpecBase);exports.GridContainer=DataWrapperComponent.wrapComponent(new GridContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/EntitySearchResultLegends",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon){exports.DESCRIPTOR_NAME="EntitySearchResultLegends";var EntitySearchResultLegendsSpec=function(_super){__extends(EntitySearchResultLegendsSpec,_super);function EntitySearchResultLegendsSpec(){_super.apply(this,arguments);this.displayName="EntitySearchResultLegends";this.listenToProperties=["LegendList"]}EntitySearchResultLegendsSpec.prototype.renderEntitySearchResultLegendsContainer=function(){return React.DOM.div({key:"entitySearchResultLegendContainer",id:"entitySearchResultLegendContainer"},[this.renderEntitySearchResultLegendContainer()])};EntitySearchResultLegendsSpec.prototype.getLegendTemplate=function(legend){var children=[legend.get_Label()+" "+legend.get_Value()];legend.get_IconSymbol()&&children.unshift(FontIcon.FontIcon({key:legend.get_Key()+"Icon",symbolName:legend.get_IconSymbol(),className:legend.get_IconClassName()?legend.get_IconClassName():""}));return React.DOM.span({key:legend.get_Key(),className:legend.get_ClassName()?legend.get_ClassName():"kbSearchResultLegendsSpan",title:legend.get_Tooltip()?legend.get_Tooltip():""},children)};EntitySearchResultLegendsSpec.prototype.renderEntitySearchResultLegendContainer=function(){var entitySearchResultLegendContainerChildren=[],legends=this.props.dataContext.get_LegendList();if(legends)for(var i=0;i<legends.get_Count();i++){var legend=legends.get_Items()[i];if(legend){var legendTemplate=this.getLegendTemplate(legend);entitySearchResultLegendContainerChildren.push(legendTemplate)}}return entitySearchResultLegendContainerChildren};EntitySearchResultLegendsSpec.prototype.render=function(){return this.renderEntitySearchResultLegendsContainer()};return EntitySearchResultLegendsSpec}(TsAdapter.SpecBase);exports.EntitySearchResultLegends=DataWrapperComponent.wrapComponent(new EntitySearchResultLegendsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchResultLegends",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/RelatedEntitySearchControls/EntitySearchResultLegends"],function(require,exports,TsAdapter,DataWrapperComponent,EntitySearchResultLegends){exports.DESCRIPTOR_NAME="KbSearchResultLegends";var KbSearchResultLegendsSpec=function(_super){__extends(KbSearchResultLegendsSpec,_super);function KbSearchResultLegendsSpec(){_super.apply(this,arguments);this.displayName="KbSearchResultLegends";this.listenToProperties=["KbSearchResult"]}KbSearchResultLegendsSpec.prototype.render=function(){var entitySearchLegendsProps={key:"KbSearchResultLegends.EntitySearchResultLegend",clientContext:this.props.clientContext,dataContext:this.props.dataContext},baseSearchBox=EntitySearchResultLegends.EntitySearchResultLegends(entitySearchLegendsProps);return baseSearchBox};return KbSearchResultLegendsSpec}(TsAdapter.SpecBase);exports.KbSearchResultLegends=DataWrapperComponent.wrapComponent(new KbSearchResultLegendsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchResultStatus",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var KbSearchResultStatusSpec=function(_super){__extends(KbSearchResultStatusSpec,_super);function KbSearchResultStatusSpec(){_super.apply(this,arguments);this.displayName="KbSearchResultStatus"}KbSearchResultStatusSpec.prototype.render=function(){var kbSearchResultStatusValue="",kbSearchResultStatusClass="";switch(this.props.kbSearchResultStatus){case 0:kbSearchResultStatusValue=this.props.clientContext.getLocalizedString("SearchWidget.Articles.Drafts");kbSearchResultStatusClass="mscrm-kbSearchResultStatusInfo-Draft";break;case 1:kbSearchResultStatusValue=this.props.clientContext.getLocalizedString("SearchWidget.Articles.Approved");kbSearchResultStatusClass="mscrm-kbSearchResultStatusInfo-Approved";break;case 2:kbSearchResultStatusValue=this.props.clientContext.getLocalizedString("SearchWidget.Articles.Scheduled");kbSearchResultStatusClass="mscrm-kbSearchResultStatusInfo-Scheduled";break;case 4:kbSearchResultStatusValue=this.props.clientContext.getLocalizedString("SearchWidget.Articles.Expired");kbSearchResultStatusClass="mscrm-kbSearchResultStatusInfo-Expired";break;case 3:case 5:case 6:default:break}if(kbSearchResultStatusValue!="")kbSearchResultStatusClass="mscrm-kbSearchResultStatusInfo mscrm-kbSerachResultHeaderCell mscrm-ContentPaneArticleNameContainerCell "+kbSearchResultStatusClass;return React.DOM.div({key:"KbSearchResultStatus",className:kbSearchResultStatusClass},kbSearchResultStatusValue)};return KbSearchResultStatusSpec}(TsAdapter.SpecBase);exports.KbSearchResultStatus=TsAdapter.createComponent(new KbSearchResultStatusSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/SearchResultActionsDropdown",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/FontIcon","Components/Primitives/Popup"],function(require,exports,TsAdapter,PureUpdate,FontIcon,Popup){exports.DESCRIPTOR_NAME="SearchResultActionsDropdown";var SearchResultActionsDropdownSpec=function(_super){__extends(SearchResultActionsDropdownSpec,_super);function SearchResultActionsDropdownSpec(){_super.apply(this,arguments);this.displayName="SearchResultActionsDropdown";this.mixins=[PureUpdate.Mixin]}SearchResultActionsDropdownSpec.prototype.handleAction=function(action,result){this.props.dataContext.HandleAction(action,result)};SearchResultActionsDropdownSpec.prototype.isActionAllowed=function(action,article){return this.props.dataContext.IsActionAllowed(action,article)};SearchResultActionsDropdownSpec.prototype.onKeyDownHandler=function(e){e.key==="Enter"&&e.target&&e.target.click()};SearchResultActionsDropdownSpec.prototype.renderMenuItems=function(){for(var children=[],items=this.props.dataContext.get_ItemsList(),result=this.props.result,rAction=this.props.dataContext.GetFirstAction(result.Article),i=0;i<items.length;i++){var label=items[i].get_Label(),action=items[i].get_ValueString();if(!this.isActionAllowed(action,result.Article)||rAction.get_Name()==action)continue;children.push(React.DOM.span({key:"actionMenuItemKey_"+action,className:"mscrm-actionMenuItem",title:this.props.dataContext.GetTooltip(action),onClick:this.handleAction.bind(this,action,result),onKeyDown:this.onKeyDownHandler,tabIndex:this.props.tabIndex},label))}return React.DOM.span({key:"actionMenuPopupContent",className:"mscrm-actionMenuPopupContent"},children)};SearchResultActionsDropdownSpec.prototype.toggleMenu=function(){this.setState({isMenuVisible:!this.state.isMenuVisible})};SearchResultActionsDropdownSpec.prototype.onKeyDown=function(e){switch(e.key){case "Enter":this.setState({isMenuVisible:true});break;case "Escape":this.setState({isMenuVisible:false});break;default:}};SearchResultActionsDropdownSpec.prototype.getInitialState=function(){return {isMenuVisible:false}};SearchResultActionsDropdownSpec.prototype.renderMenuFlyout=function(){var menuButton;if(this.state.isMenuVisible)var menuPopup=Popup.Popup({key:"menuActionPopup",visible:true,className:"mscrm-actionMenuPopup",onDismiss:this.toggleMenu},this.renderMenuItems());menuButton=React.DOM.span({key:"actionMenuButton",className:"mscrm-actionMenuButton",title:this.props.dataContext.get_Title()},FontIcon.FontIcon({symbolName:"More"}));var children=[menuButton,menuPopup];return React.DOM.div({key:"menuActionButtonPopup",ref:"menuActionButtonPopup",className:"mscrm-menuActionButtonPopup",onClick:this.toggleMenu,title:this.props.dataContext.get_Title(),tabIndex:this.props.tabIndex,onKeyDown:this.onKeyDown},children)};SearchResultActionsDropdownSpec.prototype.renderFirstAction=function(){var fAction=this.props.dataContext.GetFirstAction(this.props.result.Article),symbolName=""+fAction.get_Name();return React.DOM.span({key:"SearchResultActionsDropdown.firstAction",className:"mscrm-firstActionButtonPopup",onClick:this.handleAction.bind(this,fAction.get_Name(),this.props.result),title:this.props.dataContext.GetTooltip(fAction.get_Name()),tabIndex:this.props.tabIndex,onKeyDown:this.onKeyDownHandler},FontIcon.FontIcon({symbolName:symbolName}))};SearchResultActionsDropdownSpec.prototype.render=function(){var children=[],countActions=this.props.dataContext.CountAllowedActions(this.props.result);countActions>0&&children.push(this.renderFirstAction());countActions>1&&children.push(this.renderMenuFlyout());return React.DOM.div({key:"actioMenuDiv",className:"mscrm-actioMenuDiv"},children)};return SearchResultActionsDropdownSpec}(TsAdapter.SpecBase);exports.SearchResultActionsDropdown=TsAdapter.createComponent(new SearchResultActionsDropdownSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchResultContentPane",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon","Components/Primitives/Button","Components/RelatedEntitySearchControls/KbSearchResultLegends","Components/RelatedEntitySearchControls/KbSearchResultStatus","Components/RelatedEntitySearchControls/SearchResultActionsDropdown"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon,Button,KbSearchResultLegends,KbSearchResultStatus,SearchResultActionsDropdown){exports.DESCRIPTOR_NAME="KbSearchResultContentPane";var MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS=["http:","https:"],KbSearchControlReadPaneSpec=function(_super){__extends(KbSearchControlReadPaneSpec,_super);function KbSearchControlReadPaneSpec(){_super.apply(this,arguments);this.displayName="KbSearchResultContentPane";this.listenToViewModels={dataContext:{listenToProperties:["CurrentKbSearchResult"]},selectedSearchResult:{listenToProperties:["ActionHandled"]}};this._preparedArticleContent=null}KbSearchControlReadPaneSpec.prototype.getInitialState=function(){return {height:this.props.getUsedHeightOfControl?this.props.getUsedHeightOfControl():0}};KbSearchControlReadPaneSpec.prototype.renderBackButton=function(){var backButtonTitleText=this.props.clientContext.getLocalizedString("KMControl.BackToSearchResult.Tooltip"),backButtonText=this.props.isMobileControl?this.props.clientContext.getLocalizedString("KMControl.BackToSearchResult"):"",buttonContent=[FontIcon.FontIcon({key:"contentPanelBackButton.icon",symbolName:this.props.isMobileControl?"BackButtonWithoutBorder":"BackButton"}),backButtonText];return Button.Button({key:"ContentPanelBackButton",onClick:this.backButtonClick,title:backButtonTitleText,className:this.props.isMobileControl?"mscrm-ContentPaneBackButtonM":"mscrm-ContentPaneBackButton"},buttonContent)};KbSearchControlReadPaneSpec.prototype.backButtonClick=function(){this.props.backButtonHandler()};KbSearchControlReadPaneSpec.prototype.keyDown=function(e){e.key==="Enter"&&this.props.backButtonHandler()};KbSearchControlReadPaneSpec.prototype.handleAction=function(action,article){this.props.dataContext.HandleAction(action,article)};KbSearchControlReadPaneSpec.prototype.renderActionLinks=function(result){var links=[];if(this.props.isMobileControl)links.push(SearchResultActionsDropdown.SearchResultActionsDropdown({key:"kbSearchResults.searchResultActions",className:"mscrm-searchResultActionMenu",clientContext:this.props.clientContext,dataContext:result.get_SearchResultActionsDropdownViewModel(),tabIndex:0,result:result}));else{var allActions=this.props.dataContext.get_SearchResultActions();for(var i in allActions){var action=allActions[i];if(!this.props.dataContext.IsActionAllowed(action,result))continue;var button=Button.Button({key:"ContentPanel"+action.get_Name()+"Button",className:"mscrm-ContentPaneActionLinksButton",title:action.get_Tooltip(),tabIndex:0,onClick:this.handleAction.bind(this,action,result)},action.get_Title());links.push(button)}}return links};KbSearchControlReadPaneSpec.prototype.renderArticleMetadata=function(result){var dataContext=this.props.dataContext.get_kbSearchResultLegendsViewModel(),resultLegends=KbSearchResultLegends.KbSearchResultLegends({key:"kbSearchResultContentPane.kbSearchResultLegends",clientContext:this.props.clientContext,dataContext:dataContext});dataContext.set_KbSearchResult(result.Article);return resultLegends};KbSearchControlReadPaneSpec.prototype.getPreparedArticleContent=function(){if(this._preparedArticleContent==null)this._preparedArticleContent=this.props.selectedSearchResult.Article.get_content();return this._preparedArticleContent};KbSearchControlReadPaneSpec.prototype.renderArticleContent=function(classPostfix){var styles={};if(!this.props.isMobileControl)styles["height"]="calc(100% - "+this.state.height+"px)";var ipadClassPostfix=this.props.clientContext.userAgent.get_IsIPad()||this.props.clientContext.userAgent.get_IsIOS8()||this.props.clientContext.userAgent.get_IsIOS9()?"_Ios":"",classNameVal=this.props.isMobileControl?"mscrm-ContentPaneArticleContentM"+ipadClassPostfix:"mscrm-ContentPaneArticleContent"+classPostfix;return React.DOM.iframe({ref:"iframeContent",className:classNameVal,key:"mscrm-ContentPaneArticleContentContainer",style:styles})};KbSearchControlReadPaneSpec.prototype.getControlHeight=function(){var contentPaneContainer=this.refs["iframeContent"];if(contentPaneContainer instanceof HTMLElement){var usedHeight=0;if(this.props.getUsedHeightOfControl)usedHeight=this.props.getUsedHeightOfControl();var controlBlock=this.refs["controlBlockReadPanelDiv"];if(controlBlock instanceof Element){var controlBlockReadPanelDiv=$(controlBlock);usedHeight=usedHeight+controlBlockReadPanelDiv.outerHeight(true)}usedHeight=usedHeight+parseInt(getComputedStyle(contentPaneContainer,null).getPropertyValue("margin-bottom"),10);usedHeight=usedHeight+parseInt(getComputedStyle(contentPaneContainer,null).getPropertyValue("margin-top"),10);return usedHeight}};KbSearchControlReadPaneSpec.prototype.updateIframe=function(){var iFrameNode=this.refs["iframeContent"],frameDoc=iFrameNode.contentDocument?iFrameNode.contentDocument:iFrameNode.contentWindow.document;frameDoc.write(this.getPreparedArticleContent());if(frameDoc.body)frameDoc.body.className=" articleText";if(this.props.isMobileControl&&frameDoc.head){for(var linkList=document.getElementsByTagName("link"),i=0;i<linkList.length;i++){var link=linkList[i];frameDoc.head.appendChild(link.cloneNode())}$(frameDoc.getElementsByTagName("html")).addClass("iFrameHtml")}this.setAnchorTagBindings(true,iFrameNode)};KbSearchControlReadPaneSpec.prototype.setAnchorTagBindings=function(setHandlers,iFrame){var _this=this;if(iFrame)try{var anchors=$(iFrame.contentWindow.document.body).find("A").each(function(index,element){for(var anchorElement=element,i=0;i<MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS.length;i++)try{if(anchorElement.protocol==MESSAGE_HTML_ANCHOR_TAG_PROTOCOLS[i])if(setHandlers)anchorElement.addEventListener("click",_this.anchorClicked);else anchorElement.removeEventListener("click",_this.anchorClicked)}catch(e){}})}catch(e2){}};KbSearchControlReadPaneSpec.prototype.anchorClicked=function(evt){var targetNode=evt.target;while(targetNode.nodeName!="A")if(targetNode.parentNode&&targetNode.parentNode.nodeName!="BODY")targetNode=targetNode.parentNode;else return;var url=targetNode.href;if(url){var command=this.props.clientContext.getUrlLauncherCommand(targetNode.protocol,url);command.get_CanExecute()&&command.execute();evt.stopPropagation();evt.preventDefault();command.dispose()}};KbSearchControlReadPaneSpec.prototype.componentDidUpdate=function(){if(this.props.isMobileControl)return;var currentHeight=this.getControlHeight();this.state.height!=currentHeight&&this.setState({height:currentHeight})};KbSearchControlReadPaneSpec.prototype.componentDidMount=function(){this.updateIframe();this.props.dataContext.get_KbSearchControl().FireResultOpenedPropertyChanged();this.componentDidUpdate()};KbSearchControlReadPaneSpec.prototype.componentWillUnmount=function(){this.refs["iframeContent"]&&this.setAnchorTagBindings(false,this.refs["iframeContent"])};KbSearchControlReadPaneSpec.prototype.renderAssoicationLink=function(result){if(this.props.dataContext.IsAssociated(result))return React.DOM.span({key:"kbSearchResultContentPane.assoicationLink",className:"mscrm-KbAssociatedLink mscrm-ContentPaneArticleNameContainerCell",title:result.get_title()},FontIcon.FontIcon({key:"assoicationLink.icon",symbolName:"ArticleLink",className:"mscrm-KbAssociatedLink",title:this.getTooltipMessage(result)}));return null};KbSearchControlReadPaneSpec.prototype.getTooltipMessage=function(article){if(this.props.dataContext.IsAssociated(article))return this.props.dataContext.get_AlreadyAssociatedText();else return this.props.dataContext.get_AssociatedText()};KbSearchControlReadPaneSpec.prototype.renderArticleTitle=function(title){return React.DOM.div({key:"kbSearchResultContentPane.articleTitle",className:"mscrm-ContentPaneArticleName mscrm-ContentPaneArticleNameContainerTitle",title:title},title)};KbSearchControlReadPaneSpec.prototype.renderControlBlock=function(searchResult,classPostfix){var controlBlock=[],contentHeader=[],returnBlock=[],classPostfix="",selectedArticle=searchResult.Article,backButton=React.DOM.div({key:"ContentPaneBackButtonContainer",className:this.props.isMobileControl?"mscrm-ContentPaneBackButtonContainerM":"mscrm-ContentPaneBackButtonContainer",tabIndex:this.props.tabIndex,onKeyDown:this.keyDown},this.renderBackButton()),actions=React.DOM.div({key:"ContentPaneActionLinks",className:this.props.isMobileControl?"mscrm-searchResultActionMenu":"mscrm-ContentPaneActionLinks"},this.renderActionLinks(searchResult)),delimiter=React.DOM.hr({key:"ContentPaneDelimiter",className:"mscrm-ContentPaneDelimiter"},null);if(this.props.isMobileControl)contentHeader.push(React.DOM.div({key:"ContentPaneHeader",className:"mscrm-ContentPaneHeader"},[backButton,actions]));else!this.props.isHostedInReferencePanel&&controlBlock.push(backButton);if(!this.props.isMobileControl){controlBlock.push(React.DOM.div({key:"ContentPaneEntityName",className:"mscrm-ContentPaneEntityName"},this.props.articleEntityDisplayName));controlBlock.push(actions);controlBlock.push(delimiter)}var kbSearchResultStatus=KbSearchResultStatus.KbSearchResultStatus({key:"kbSearchResultContentPane.kbSearchResultStatus",clientContext:this.props.clientContext,kbSearchResultStatus:selectedArticle.get_stateCode()}),articleImage=React.DOM.span({key:"kbSearchResults.image",className:"mscrm-kbSearchResultArticleImage mscrm-ContentPaneArticleNameContainerCell",title:this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.ArticleIconAltText")},FontIcon.FontIcon({symbolName:"Article"})),rowsForRender=[articleImage,kbSearchResultStatus,this.renderArticleTitle(selectedArticle.get_title()),this.renderAssoicationLink(selectedArticle)];this.props.isMobileControl&&controlBlock.push(React.DOM.div({key:"ContentPaneDelimiterDiv",className:"mscrm-ContentPaneDelimiterDiv"},delimiter));controlBlock.push(React.DOM.div({key:"ContentPaneArticleName",className:this.props.isMobileControl?"mscrm-ContentPaneArticleNameContainerM":"mscrm-ContentPaneArticleNameContainer"+classPostfix},[rowsForRender]));controlBlock.push(React.DOM.div({key:"ContentPaneArticleMetadata",className:this.props.isMobileControl?"mscrm-ContentPaneArticleMetadataM":"mscrm-ContentPaneArticleMetadata"+classPostfix},this.renderArticleMetadata(searchResult)));var controlDiv=React.DOM.div({key:"controlBlockReadPanelDiv",ref:"controlBlockReadPanelDiv",className:"controlBlockHeaderReadPane"},contentHeader,controlBlock);returnBlock.push(controlDiv);return returnBlock};KbSearchControlReadPaneSpec.prototype.render=function(){var searchResult=this.props.selectedSearchResult,style="mscrm-ContentPaneContainer";if(this.props.isMobileControl){style="scrollingElement mscrm-ContentPaneContainerM";if(this.props.clientContext.userAgent.get_IsIOS8()||this.props.clientContext.userAgent.get_IsIOS9())style+=" ContentPaneIos"}var classPostfix="";if(!this.props.isHostedInReferencePanel)classPostfix="_m";var dataBlock=this.renderArticleContent(classPostfix),controlBlockDiv=this.renderControlBlock(searchResult,classPostfix);return React.DOM.div({key:"kbSearchResultContentPane.container",className:style},controlBlockDiv,dataBlock)};return KbSearchControlReadPaneSpec}(TsAdapter.SpecBase);exports.KbSearchControlReadPane=DataWrapperComponent.wrapComponent(new KbSearchControlReadPaneSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/SearchBoxContainer",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon){exports.DESCRIPTOR_NAME="SearchBoxContainer";var SearchBoxContainerSpec=function(_super){__extends(SearchBoxContainerSpec,_super);function SearchBoxContainerSpec(){_super.apply(this,arguments);this.displayName="SearchBoxContainer";this.listenToProperties=["SearchText"];this.setTimeoutHandle=null;this.searchBoxTypeTimeInterval=200;this.minLettersToTriggerAutoSearch=4}SearchBoxContainerSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_SearchText()}};SearchBoxContainerSpec.prototype.handleSearchButtonClick=function(event){if(this.props.dataContext)this.props.searchButtonClickHandler&&this.props.searchButtonClickHandler(event,this.props.dataContext.get_SearchText());this.setFocusOnSearchTextBox()};SearchBoxContainerSpec.prototype.onTextBoxChanged=function(event){if(event&&event.target){var target=event.target;this.props.dataContext.set_SearchText(target.value);this.setState({currentText:target.value});this.props.searchTextChangeHandler&&this.props.searchTextChangeHandler(event)}};SearchBoxContainerSpec.prototype.onClearTextClicked=function(event){this.props.dataContext.set_SearchText("");this.setState({currentText:""});this.props.clearTextClickHandler&&this.props.clearTextClickHandler(event);this.setFocusOnSearchTextBox()};SearchBoxContainerSpec.prototype.handleKeyUp=function(event){var _this=this;if(this.setTimeoutHandle!=null){window.clearTimeout(this.setTimeoutHandle);this.setTimeoutHandle=null}if(event.key==="Enter"){this.handleSearchButtonClick(event);event.stopPropagation();event.preventDefault();var searchTextBoxNode=$(this.refs["searchTextBox"]);searchTextBoxNode.trigger("blur");this.setFocusOnSearchTextBox()}else if(this.props.dataContext.get_SearchText().length>=this.minLettersToTriggerAutoSearch&&this.isValidKey(event.key))this.setTimeoutHandle=setTimeout(function(){return _this.handleSearchButtonClick(event)},this.searchBoxTypeTimeInterval)};SearchBoxContainerSpec.prototype.setFocusOnSearchTextBox=function(){var searchTextBoxNode=this.refs["searchTextBox"];searchTextBoxNode instanceof Element&&$(searchTextBoxNode).focus()};SearchBoxContainerSpec.prototype.onKeyDown=function(e){e.key==="Enter"&&e.target&&e.target.click()};SearchBoxContainerSpec.prototype.isValidKey=function(keyName){switch(keyName){case "ArrowRight":case "ArrowLeft":case "ArrowUp":case "ArrowDown":case "Tab":case "Shift":case "Control":case "Alt":case "Escape":case " ":case "End":case "Home":case "F2":case "F4":case "F9":case "F10":case "F12":case "CapsLock":case "Insert":return false;default:return true}};SearchBoxContainerSpec.prototype.renderSearchBoxRow=function(){var searchBoxRowChildren=[];searchBoxRowChildren.push(this.renderSearchBoxContainer());return React.DOM.div({key:"searchbox"},searchBoxRowChildren)};SearchBoxContainerSpec.prototype.renderSearchBoxContainer=function(){var textbox=React.DOM.input({ref:"searchTextBox",className:"mscrm-kbSearchTextBox",placeholder:this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles"),key:"textarea",value:this.props.dataContext.get_SearchText(),maxLength:2e3,onChange:this.onTextBoxChanged,onKeyPress:this.handleKeyUp,tabIndex:this.props.tabIndex}),searchButtonClass="mscrm-kbSearchButton",clearTextClass="mscrm-kbSearchClearText";if(!this.props.isHostedInReferencePanel){searchButtonClass="mscrm-kbSearchButton_independent";clearTextClass="mscrm-kbSearchClearText_independent"}var buttonSearch=this.props.isMobileClient?null:React.DOM.span({key:"button",className:searchButtonClass,title:this.props.clientContext.getLocalizedString("SearchWidget.StartSearch"),onClick:this.handleSearchButtonClick},FontIcon.FontIcon({symbolName:"SearchButton"})),searchBoxContainer=[textbox,buttonSearch];if(this.props.dataContext.get_SearchText()&&this.props.dataContext.get_SearchText()!=""){var clearText=React.DOM.span({key:"clearText",className:clearTextClass,onClick:this.onClearTextClicked,tabIndex:this.props.tabIndex,onKeyDown:this.onKeyDown},FontIcon.FontIcon({symbolName:"Close"}));searchBoxContainer.push(clearText)}return React.DOM.div({key:"container",className:"mscrm-kbSearchBoxContainer"},searchBoxContainer)};SearchBoxContainerSpec.prototype.render=function(){var children=[];children.push(this.renderSearchBoxRow());return React.DOM.div({key:"kbSearchBoxContainer"},children)};return SearchBoxContainerSpec}(TsAdapter.SpecBase);exports.SearchBoxContainer=DataWrapperComponent.wrapComponent(new SearchBoxContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchResults",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon","Components/RelatedEntitySearchControls/SearchResultActionsDropdown","Components/RelatedEntitySearchControls/KbSearchResultStatus","Components/RelatedEntitySearchControls/KbSearchResultLegends"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon,SearchResultActionsDropdown,KbSearchResultStatus,KbSearchResultLegends){exports.DESCRIPTOR_NAME="KbSearchResult";var KbSearchResultsSpec=function(_super){__extends(KbSearchResultsSpec,_super);function KbSearchResultsSpec(){_super.apply(this,arguments);this.displayName="KbSearchResults";this.listenToProperties=["ActionHandled"];this.showResults=true}KbSearchResultsSpec.prototype.resultClickHandler=function(result){this.props.selectItemHandler(result)};KbSearchResultsSpec.prototype.onKeyDown=function(e){e.key==="Enter"&&e.target&&e.target.click()};KbSearchResultsSpec.prototype.onFocusHandler=function(){$(".mscrm-actionMenuPopupContent").hide()};KbSearchResultsSpec.prototype.renderSearchResultRow=function(result,key){var title=result.Article.get_title(),legendsDataContext=result.get_kbSearchResultLegendsViewModel(),resultLegends=KbSearchResultLegends.KbSearchResultLegends({clientContext:this.props.clientContext,dataContext:legendsDataContext});legendsDataContext.set_IsMobileClient(this.props.isMobileControl);legendsDataContext.set_KbSearchResult(result.Article);var rowsForRender=[this.renderKbSearchResultStatusInfo(result),React.DOM.div({key:"kbSearchResults.row",className:"mscrm-kbSearchResultTitle mscrm-kbSerachResultHeaderCell mscrm-kbSerachResultHeaderTitle",title:title,tabIndex:this.props.tabIndex,onFocus:this.onFocusHandler,onKeyDown:this.onKeyDown},title),this.renderAssoicationLink(result)],headerDiv=React.DOM.div({key:"kbSearchResults.header",onClick:this.resultClickHandler.bind(this,result),className:"mscrm-kbSearchResultHeader mscrm-kbSerachResultHeaderTable"},rowsForRender),fullResultContent=result.Article.get_content();fullResultContent=$($["parseHTML"](fullResultContent)).text();var shortResultContent=fullResultContent,maxCharsInResultContent=140;if(fullResultContent.length>maxCharsInResultContent)shortResultContent=fullResultContent.substr(0,maxCharsInResultContent);var descriptionDiv=React.DOM.div({key:"kbSearchResults.description",onClick:this.resultClickHandler.bind(this,result),className:"mscrm-kbSearchResultDescription mscrm-multilineEllipsis",title:fullResultContent},shortResultContent),imageSpan=React.DOM.span({key:"kbSearchResults.image",className:"mscrm-kbSearchResultArticleImage",title:this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.ArticleIconAltText")},FontIcon.FontIcon({symbolName:"Article"})),searchResultActions=SearchResultActionsDropdown.SearchResultActionsDropdown({key:"kbSearchResults.searchResultActions",className:"mscrm-searchResultActionMenu",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_SearchResultActionsDropdownViewModel(),tabIndex:this.props.tabIndex,result:result}),bottomOptionsDiv=React.DOM.div({className:"mscrm-kbSearchResultBottomOptions",key:"bottomResultDiv"+key},resultLegends,searchResultActions),bodyDiv=React.DOM.div({key:"kbSearchResults.body"},descriptionDiv,bottomOptionsDiv),contentSpan=React.DOM.span({key:"kbSearchResults.content",className:"mscrm-kbSearchResultContent"},headerDiv,bodyDiv),rClassName=this.props.listClassName||"mscrm-kbSearchResult",resultDiv=React.DOM.div({key:"resultDiv"+key,className:rClassName},contentSpan,imageSpan);return resultDiv};KbSearchResultsSpec.prototype.renderKbSearchResultStatusInfo=function(kbSearchResult){var kbSearchResultStatusInfo=kbSearchResult.Article.get_stateCode(),kbSearchResultStatus=KbSearchResultStatus.KbSearchResultStatus({key:"kbSearchResults.kbSearchResultStatus",clientContext:this.props.clientContext,kbSearchResultStatus:kbSearchResultStatusInfo});return kbSearchResultStatus};KbSearchResultsSpec.prototype.renderAssoicationLink=function(result){if(this.props.dataContext.IsAssociated())return React.DOM.div({key:"kbSearchResults.assoicationLink",className:"mscrm-KbAssociatedLink mscrm-kbSerachResultHeaderCell mscrm-kbSerachResultHeaderSidebar",title:result.Article.get_title()},FontIcon.FontIcon({key:"assoicationLink.icon",symbolName:"ArticleLink",className:"mscrm-KbAssociatedLink",title:this.getTooltipMessage(result)}));return null};KbSearchResultsSpec.prototype.getTooltipMessage=function(article){if(this.props.dataContext.IsAssociated())return article.get_AlreadyAssociatedText();else return article.get_AssociatedText()};KbSearchResultsSpec.prototype.render=function(){return this.renderSearchResultRow(this.props.dataContext,this.props.parentGivenKey)};return KbSearchResultsSpec}(TsAdapter.SpecBase);exports.KbSearchResults=DataWrapperComponent.wrapComponent(new KbSearchResultsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchResultFooter",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button"],function(require,exports,TsAdapter,DataWrapperComponent,Button){exports.DESCRIPTOR_NAME="KbSearchResultFooter";var KbSearchResultFooterSpec=function(_super){__extends(KbSearchResultFooterSpec,_super);function KbSearchResultFooterSpec(){_super.apply(this,arguments);this.displayName="KbSearchResultFooter"}KbSearchResultFooterSpec.prototype.renderMoreResultButton=function(){var buttonText;if(this.props.clientContext.isUserCultureRightToLeft)buttonText=this.props.clientContext.getLocalizedString("ActivityContainerControl.SubjectEllipsesText")+" "+this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.ShowMoreArticlesText");else buttonText=this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.ShowMoreArticlesText")+" "+this.props.clientContext.getLocalizedString("ActivityContainerControl.SubjectEllipsesText");var buttonTitleText=this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.ShowMoreArticlesToolTip"),button=Button.Button({key:"MoreResults",className:"mscrm-kbSearchMoreButton",title:buttonTitleText,onClick:this.onMoreResultsButtonClicked},buttonText);return button};KbSearchResultFooterSpec.prototype.render=function(){var childs=[];if(this.props.resultsPerPage<this.props.dataContext.get_KbSearchControl().get_searchResultCount()){var button=this.renderMoreResultButton();childs.push(button)}var footer=React.DOM.div({className:"mscrm-kbSearchMoreButtonContainer"},childs);return footer};KbSearchResultFooterSpec.prototype.onMoreResultsButtonClicked=function(event){this.props.moreResultsHandler&&this.props.moreResultsHandler()};return KbSearchResultFooterSpec}(TsAdapter.SpecBase);exports.KbSearchResultFooter=DataWrapperComponent.wrapComponent(new KbSearchResultFooterSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchFilter",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="KbSearchFilter";var KbSearchFilterSpec=function(_super){__extends(KbSearchFilterSpec,_super);function KbSearchFilterSpec(){_super.apply(this,arguments);this.displayName="KbSearchFilter"}KbSearchFilterSpec.prototype.getInitialState=function(){return {currentFilterItemOpened:null}};KbSearchFilterSpec.prototype.renderFilterItem=function(item){var ulStyles="";if(item.get_Value()=="root")ulStyles="mscrm-kbSearchFilter";var controlRef=this,children=[],button=React.DOM.button({key:item.get_Value().replace(" ","_"),onClick:function(){if(item.get_KbSearchFilterCommand())item.get_KbSearchFilterCommand().execute();else controlRef.setState({currentFilterItemOpened:item})},className:item.get_IsActive()?"menuItemButton menuItemButtonActive":"menuItemButton"},this.getButtonContent(item.get_Label(),item.get_HasChildren()));children.push(button);if(item.get_HasChildren()){for(var ulInList=[],items=item.get_Children(),i=0;i<items.length;i++){var list=this.renderFilterItem(items[i]);ulInList.push(list)}if(item.get_Value()!="root")ulStyles=item==this.state.currentFilterItemOpened?"subMenuUl":"menuHidden subMenuUl";var ul=React.DOM.ul({key:"ul_"+item.get_Value().replace(" ","_"),ref:"ul_"+item.get_Value().replace(" ","_"),className:ulStyles},ulInList);children.push(ul)}if(item.get_Value()=="root")return children[1];else{var li=React.DOM.li({key:"li_"+item.get_Value().replace(" ","_"),className:"menuItemLi"},children);return li}};KbSearchFilterSpec.prototype.getButtonContent=function(text,isNode){var itemSymbolClass="";if(isNode)itemSymbolClass="menuItemSymbolArrow";var divText=React.DOM.div(null,text),divSymbol=React.DOM.div({className:itemSymbolClass}),divContent=React.DOM.div({className:"menuItemContent"},divText,divSymbol);return divContent};KbSearchFilterSpec.prototype.render=function(){var root=this.props.dataContext.get_RootKbSearchFilterItem();if(root.get_HasChildren())return this.renderFilterItem(root);else return React.DOM.noscript()};return KbSearchFilterSpec}(TsAdapter.SpecBase);exports.KbSearchFilter=DataWrapperComponent.wrapComponent(new KbSearchFilterSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchControlMobile",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Primitives/ProgressIndicator","Components/RelatedEntitySearchControls/KbSearchResultContentPane","Components/RelatedEntitySearchControls/SearchBoxContainer","Components/RelatedEntitySearchControls/KbSearchResults","Components/RelatedEntitySearchControls/KbSearchResultFooter","Components/RelatedEntitySearchControls/KbSearchFilter","Components/Common/FlyOutButton"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,ProgressIndicator,KbSearchResultContentPane,SearchBoxContainer,KbSearchResults,KbSearchResultFooter,KbSearchFilter,FlyOutButton){exports.DESCRIPTOR_NAME="KbSearchControlMobile";var KbSearchControlMSpec=function(_super){__extends(KbSearchControlMSpec,_super);function KbSearchControlMSpec(){_super.apply(this,arguments);this.displayName="KbSearchControlMobile";this.listenToProperties=["ResultsRetrieved","IsLoading","ComboBoxViewModel","AssociatedArticles","SearchText","ModelContext","Label","ShowLabel","SearchMode","AllowChangingFiltersOnUI","ShowLanguageFilter"];this.showResults=true;this.loadMore=false;this.sortFilterWidth=100}KbSearchControlMSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_SearchText()}};KbSearchControlMSpec.prototype.renderLoading=function(){return React.DOM.div({key:"loadingDiv",className:"mscrm-loadingDiv"},ProgressIndicator.ProgressIndicator({type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}),React.DOM.div({className:"mscrm-searchingDiv"},this.props.clientContext.getLocalizedString("SearchWidget.Searching")))};KbSearchControlMSpec.prototype.onBackButton=function(){this.props.dataContext.set_IsSearchMode(true)};KbSearchControlMSpec.prototype.renderHeader=function(){var header=this.props.dataContext.get_IsHostedInReferencePanel()?this.props.clientContext.getLocalizedString("SFATabsControl.KnowledgeBaseRecord"):this.props.dataContext.get_Label(),children=[],headerLabel=React.DOM.label({className:"mscrm-kbSearchControlLabel",title:header,key:"headerLabel"},header);children.push(headerLabel);var button=this.renderFilterFlyOutButton();children.push(button);return React.DOM.div({key:"kbSearchControlMobile.listHeader",className:"listHeader"},React.DOM.div({key:"kbSearchControlMobile.kbSearchHeader",className:"mscrm-kbSearchHeader listComponentView-interactBar"},children))};KbSearchControlMSpec.prototype.renderFilterFlyOutButton=function(){var filterMenuFlyOutMetadata=this.props.dataContext.get_FilterMenuFlyOutMetadata();if(filterMenuFlyOutMetadata)return FlyOutButton.FlyOutButton({key:"filter",clientContext:this.props.clientContext,dataContext:filterMenuFlyOutMetadata[0],descriptor:filterMenuFlyOutMetadata[1],buttonClassName:"flyoutTopMenuButton",imageType:"Symbol",imageName:"Filter",flyOutPositioning:FlyOutButton.FlyOutPositioning.External,containerDataId:"Filter",tabIndex:this.props.dataContext.get_NextTabIndex(),title:this.props.clientContext.getLocalizedString("KMControl.Filter.Label.FilterResultBy"),stopClickPropagation:true})};KbSearchControlMSpec.prototype.handleSelectedItemChanged=function(result){this.props.dataContext.set_SelectedSearchResult(result.Article);this.props.dataContext.set_SelectedSearchResultViewModel(result);this.props.dataContext.IncrementKnowledgeArticleViewCount();this.props.dataContext.set_IsSearchMode(false)};KbSearchControlMSpec.prototype.handleSearchButtonClick=function(event,searchText){if(this.props.dataContext){if(searchText!==null&&searchText!=="")this.showResults=true;this.props.dataContext.set_SearchText(searchText);this.props.dataContext.executeAction();this.setState({currentText:searchText});this.props.dataContext.set_IsSearchMode(true)}};KbSearchControlMSpec.prototype.onTextBoxChanged=function(event){if(event&&event.target){var target=event.target;this.props.dataContext.set_SearchText(target.value);this.setState({currentText:target.value})}};KbSearchControlMSpec.prototype.onClearTextClicked=function(event){this.showResults=false;this.props.dataContext.set_SearchText("");this.setState({currentText:""})};KbSearchControlMSpec.prototype.onSearchMoreButtonClick=function(event){if(this.props.dataContext){this.showResults=true;this.props.dataContext.loadMoreResults()}};KbSearchControlMSpec.prototype.getUsedHeightOfControl=function(){var usedHeight=0,controlBlockDiv=this.refs["controlBlockDiv"];if(controlBlockDiv instanceof Element)usedHeight=usedHeight+this.outerHeight(controlBlockDiv);return usedHeight};KbSearchControlMSpec.prototype.outerHeight=function(el){var height=el.offsetHeight,style=getComputedStyle(el);height+=parseInt(style.marginTop)+parseInt(style.marginBottom);return height};KbSearchControlMSpec.prototype.renderErrorMessage=function(){return React.DOM.div({key:"errorMessage",className:"mscrm-kbSearchResultDescription"},this.props.dataContext.get_ErrorString())};KbSearchControlMSpec.prototype.renderSearchSummaryContainer=function(){return React.DOM.div({key:"kbSearchResultContainer",ref:"mscrm-kbSearchResultContainer",className:"mscrm-kbSearchResultContainer"},[this.renderSearchResultsContainer(),this.renderSearchResultFooter()])};KbSearchControlMSpec.prototype.renderSearchResults=function(){var searchAnswer=this.props.dataContext.get_KbSearchResultsList();if(searchAnswer)return React.DOM.div({key:"mscrm-KbSearchSummaryControl",className:"scrollRegion scrollingElement listView mscrm-SearchSummaryViewContainerM"},[this.renderResultsCount(),this.renderSearchSummaryContainer()]);return this.renderPlaceHolder()};KbSearchControlMSpec.prototype.renderPlaceHolder=function(){return React.DOM.div({key:"mscrm-KbSearchSummaryControl",className:"scrollRegion scrollingElement listView mscrm-SearchSummaryViewContainerM"})};KbSearchControlMSpec.prototype.renderSearchResultFooter=function(){var results=this.props.dataContext.get_KbSearchResultsList(),resultsCount=0;if(results)resultsCount=results.get_Count();var footer=KbSearchResultFooter.KbSearchResultFooter({key:"kbSearchControlMobile.kbSearchResultFooter",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_KbSearchResultFooterViewModel(),moreResultsHandler:this.onSearchMoreButtonClick,resultsPerPage:resultsCount});return footer};KbSearchControlMSpec.prototype.renderResultsCount=function(){var resultString=String.format(this.props.clientContext.getLocalizedString("ReferencePanelSearch_Results_Found"),this.props.dataContext.get_searchResultCount());if(this.props.dataContext.get_searchResultCount()>0)return React.DOM.div({key:"resultCount",className:"mscrm-kbSearchResultCount"},resultString.toUpperCase());else return React.DOM.div({key:"resultCount",className:"mscrm-kbSearchResultCount"},this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.NoResults").toUpperCase())};KbSearchControlMSpec.prototype.renderSearchResultsContainer=function(){var tabIndex=this.props.dataContext.get_tabIndex(),searchResults=this.props.dataContext.get_KbSearchResultsList(),searchResultContainerChildren=[];if(searchResults){this.props.dataContext.set_tabIndex(tabIndex);for(var searchResultsArray=searchResults.toArray(),i=0,l=searchResultsArray.length;i<l;i++){var kbSearchResults=KbSearchResults.KbSearchResults({clientContext:this.props.clientContext,dataContext:this.props.dataContext.SearchResult(i),key:searchResultsArray[i].get_ViewModelId(),parentGivenKey:searchResultsArray[i].get_ViewModelId(),tabIndex:this.props.dataContext.get_tabIndex().toString(),selectItemHandler:this.handleSelectedItemChanged,listClassName:"mscrm-kbSearchResult",isMobileControl:true});searchResultContainerChildren.push(kbSearchResults)}}return searchResultContainerChildren};KbSearchControlMSpec.prototype.renderBody=function(){var dataBlock=[];if(this.props.dataContext.get_IsSearchMode()){var isLoading=this.props.dataContext.get_IsLoading();if(this.props.dataContext.get_ErrorString()&&this.props.dataContext.get_ErrorString()!="")dataBlock.push(this.renderErrorMessage());else if(this.showResults)if(this.loadMore){dataBlock.push(this.renderSearchResults());isLoading&&dataBlock.push(this.renderLoading());this.loadMore=false}else if(isLoading)dataBlock.push(this.renderLoading());else dataBlock.push(this.renderSearchResults());else dataBlock.push(this.renderPlaceHolder())}else dataBlock.push(KbSearchResultContentPane.KbSearchControlReadPane({key:"kbSearchControlMobile.kbSearchControlReadPane",clientContext:this.props.clientContext,dataContext:this.props.dataContext.createKbSearchResultContentPaneViewModel(),selectedSearchResult:this.props.dataContext.get_SelectedSearchResultViewModel(),articleEntityDisplayName:this.props.dataContext.get_ArticleEntityDisplayName(),backButtonHandler:this.onBackButton,showContextualActions:this.props.dataContext.get_ShowContextualActions(),isHostedInReferencePanel:this.props.dataContext.get_IsHostedInReferencePanel(),tabIndex:this.props.dataContext.get_tabIndex()+1,getUsedHeightOfControl:this.getUsedHeightOfControl,isMobileControl:true}));return dataBlock};KbSearchControlMSpec.prototype.render=function(){var controlBlock=[],dataBlock=[];this.props.dataContext.set_tabIndex(1);var searchBoxContainer=SearchBoxContainer.SearchBoxContainer({key:"kbSearchControlMobile.searchBoxContainer",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_searchBoxContainerViewModel(),searchButtonClickHandler:this.handleSearchButtonClick,searchTextChangeHandler:this.onTextBoxChanged,clearTextClickHandler:this.onClearTextClicked,tabIndex:this.props.dataContext.get_tabIndex(),isHostedInReferencePanel:this.props.dataContext.get_IsHostedInReferencePanel(),isMobileClient:true});this.props.dataContext.get_IsSearchBoxVisible()&&controlBlock.push(searchBoxContainer);dataBlock.push(this.renderBody());var controlBlockDiv=React.DOM.div({key:"controlBlockDiv",ref:"controlBlockDiv",className:"mscrm-kbSearchBox"},controlBlock),containerDiv=React.DOM.div({key:"mscrm-kbSearchContainer",ref:"mscrm-kbSearchContainer",className:"mscrm-kbSearchContainerM","data-id":"GridHeader"},controlBlockDiv);return React.DOM.div({key:"kbSearchControlMobile-panoramaItem",className:"panoramaItem-control listRoot"},[this.renderHeader(),containerDiv,dataBlock])};return KbSearchControlMSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(KbSearchFilter.DESCRIPTOR_NAME,KbSearchFilter.KbSearchFilter);exports.KbSearchControlMobile=DataWrapperComponent.wrapComponent(new KbSearchControlMSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/RelatedEntitySearchControls/KbSearchControl",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Components/Fields/ComboBox","Components/RelatedEntitySearchControls/KbSearchResultContentPane","Components/RelatedEntitySearchControls/SearchBoxContainer","Components/RelatedEntitySearchControls/KbSearchResults","Components/RelatedEntitySearchControls/KbSearchResultFooter","Components/RelatedEntitySearchControls/KbSearchControlMobile","Core/Binding/WindowResizeHandlerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,ProgressIndicator,ComboBox,KbSearchResultContentPane,SearchBoxContainer,SearchResultsTable,SearchResultsFooter,KbSearchControlMobile,WindowResizeHandler){exports.DESCRIPTOR_NAME="KbSearchControl";var KbSearchControlSpec=function(_super){__extends(KbSearchControlSpec,_super);function KbSearchControlSpec(){_super.apply(this,arguments);this.mixins=[WindowResizeHandler.Mixin];this.displayName="KbSearchControl";this.listenToProperties=["ResultsRetrieved","IsLoading","ComboBoxViewModel","AssociatedArticles","SearchText","ModelContext","Label","ShowLabel","SearchMode"];this.showResults=true;this.loadMore=false;this.sortFilterWidth=100;this.reflowControlWidth=600;this.hiddenSpanWidthValue=30;this.hiddenSpanReflowWidthValue=45}KbSearchControlSpec.prototype.getInitialState=function(){return {currentText:this.props.dataContext.get_SearchText(),isSearchMode:true,isReflowMode:false}};KbSearchControlSpec.prototype.renderLoading=function(){return React.DOM.div({key:"loadingDiv",className:"mscrm-loadingDiv",style:{height:this.loadMore?"40px":"416px"}},ProgressIndicator.ProgressIndicator({type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}),React.DOM.div({className:"mscrm-searchingDiv"},this.props.clientContext.getLocalizedString("SearchWidget.Searching")))};KbSearchControlSpec.prototype.onSortFilterChange=function(){var sortFilterComponent=this.refs["sortFilter"],hiddenSort=this.refs["hiddenSort"];if(sortFilterComponent&&hiddenSort instanceof Element){var sortFilterNode=$(ReactDOM.findDOMNode(sortFilterComponent)),hiddenSortSpan=$(hiddenSort);hiddenSortSpan.text(this.props.dataContext.get_SortFilterViewModel().get_SelectedItem());this.sortFilterWidth=hiddenSortSpan.width()+this.hiddenSpanWidthValue;sortFilterNode.css("width",this.sortFilterWidth)}};KbSearchControlSpec.prototype.onArticleFilterChange=function(){var articleFilter=this.refs["articleFilter"],hiddenArticle=this.refs["hiddenArticle"];if(articleFilter&&hiddenArticle instanceof Element){var articleFilterNode=$(ReactDOM.findDOMNode(articleFilter)),hiddenArticleSpan=$(hiddenArticle);hiddenArticleSpan.text(this.props.dataContext.get_ArticleFilterViewModel().get_SelectedItem());articleFilterNode.css("width",hiddenArticleSpan.width()+this.hiddenSpanWidthValue)}};KbSearchControlSpec.prototype.onLanguageFilterChange=function(){var languageFilter=this.refs["languageFilter"],hiddenLanguage=this.refs["hiddenLanguage"];if(languageFilter&&hiddenLanguage instanceof HTMLElement){var langFilterNode=$(ReactDOM.findDOMNode(languageFilter)),hiddenLangSpan=$(hiddenLanguage);hiddenLangSpan.text(this.props.dataContext.get_ArticleLanguageFilterViewModel().get_SelectedLanguageFilterName());var height=this.state.isReflowMode?hiddenLangSpan.width()+this.hiddenSpanReflowWidthValue:hiddenLangSpan.width()+this.hiddenSpanWidthValue;langFilterNode.css("width",height)}};KbSearchControlSpec.prototype.renderFilters=function(){if(!this.props.dataContext.get_AllowChangingFiltersOnUI()&&!this.props.dataContext.get_ShowLanguageFilter())return null;var filterContainer=[],sectionLabel=React.DOM.span({ref:"sectionLabel",className:"mscrm-sectionLabel"},this.props.clientContext.getLocalizedString("KMControl.Filter.Label.FilterResultBy"));filterContainer.push(sectionLabel);this.props.dataContext.get_AllowChangingFiltersOnUI()&&filterContainer.push(this.renderArticleTypeFilter());this.props.dataContext.get_ShowLanguageFilter()&&filterContainer.push(this.renderLanguageFilter());return React.DOM.div({key:"filterContainer",className:"mscrm-kbSearchFilterContainer"},filterContainer)};KbSearchControlSpec.prototype.renderSort=function(){var sortComboBox=null;sortComboBox=ComboBox.ComboBox({key:"kbSortFilterComboBox",className:"mscrm-kbSearchSortFilter",clientContext:this.props.clientContext,selectElementdataId:"sortFilterSelected",renderAsDropDown:true,dataContext:this.props.dataContext.get_SortFilterViewModel(),ref:"sortFilter",title:this.props.clientContext.getLocalizedString("SearchWidget.Filters.SortTooltip"),value:this.props.dataContext.get_SortFilterViewModel().get_SelectedItem(),onDismiss:this.onSortFilterChange,tabIndex:this.props.tabIndex});var hiddenSortSpan=React.DOM.span({key:"hiddenSortSpan",ref:"hiddenSort",className:"mscrm-hiddenSpan"},this.props.dataContext.get_SortFilterViewModel().get_SelectedItem()),sortFilterContainer=[];!this.props.dataContext.get_IsLoading()&&this.showResults&&(!this.props.dataContext.get_ErrorString()||this.props.dataContext.get_ErrorString()=="")&&sortFilterContainer.push(this.renderResultsCount());sortFilterContainer.push(sortComboBox,hiddenSortSpan);return React.DOM.div({key:"sortFilterDiv",className:"mscrm-mscrm-kbSearchSortFilterContainer"},sortFilterContainer)};KbSearchControlSpec.prototype.renderArticleTypeFilter=function(){var articleComboBox=null;articleComboBox=ComboBox.ComboBox({key:"kbArticleFilterComboBox",className:"mscrm-kbSearchArticleStatusFilter",clientContext:this.props.clientContext,selectElementdataId:"articleFilterSelected",renderAsDropDown:true,dataContext:this.props.dataContext.get_ArticleFilterViewModel(),ref:"articleFilter",title:this.props.clientContext.getLocalizedString("SearchWidget.Filters.ArticleTooltip"),value:this.props.dataContext.get_ArticleFilterViewModel().get_SelectedItem(),onDismiss:this.onArticleFilterChange,tabIndex:this.props.tabIndex});var articleSpan=React.DOM.span({ref:"articleSpan",className:"mscrm-filterLabel"},this.props.clientContext.getLocalizedString("SearchWidget.Filters.ArticleTitle")),hiddenArticleSpan=React.DOM.span({ref:"hiddenArticle",className:"mscrm-hiddenSpan"},this.props.dataContext.get_ArticleFilterViewModel().get_SelectedItem());return React.DOM.div({key:"articleStatusFilterDiv",className:"mscrm-kbSearchArticleStatusFilterContainer"},articleSpan,articleComboBox,hiddenArticleSpan)};KbSearchControlSpec.prototype.renderLanguageFilter=function(){var langComboBox=null,languageFilterLabel=React.DOM.span({ref:"languageFilterLabel",className:"mscrm-filterLabel"},this.props.clientContext.getLocalizedString("KMControl.Filter.Label.Language"));langComboBox=ComboBox.ComboBox({key:"kbArticleLanguageFilterComboBox",className:"mscrm-kbSearchArticleLanguageFilter",clientContext:this.props.clientContext,selectElementdataId:"articleLanguageFilterSelected",renderAsDropDown:true,dataContext:this.props.dataContext.get_ArticleLanguageFilterViewModel(),ref:"languageFilter",title:this.props.clientContext.getLocalizedString("SearchWidget.Filters.LanguageTooltip"),value:this.props.dataContext.get_ArticleLanguageFilterViewModel().get_SelectedItem(),onDismiss:this.onLanguageFilterChange,tabIndex:this.props.tabIndex});var hiddenArticleLanguageFilterSpan=React.DOM.span({ref:"hiddenLanguage",className:"mscrm-hiddenSpan"},this.props.dataContext.get_ArticleLanguageFilterViewModel().get_SelectedLanguageFilterName());return React.DOM.div({key:"articleLanguageFilterDiv",className:"mscrm-kbSearchLanguageFilterContainer"},languageFilterLabel,langComboBox,hiddenArticleLanguageFilterSpan)};KbSearchControlSpec.prototype.onBackButton=function(){this.props.dataContext.set_IsSearchMode(true)};KbSearchControlSpec.prototype.renderHeader=function(){var header=this.props.dataContext.get_Label();if(this.props.dataContext.get_ShowLabel()&&header&&header!="")return React.DOM.label({className:"mscrm-kbSearchControlLabel",title:header},this.props.dataContext.get_Label())};KbSearchControlSpec.prototype.renderResultsCount=function(){var resultString=String.format(this.props.clientContext.getLocalizedString("ReferencePanelSearch_Results_Found"),this.props.dataContext.get_searchResultCount());if(this.props.dataContext.get_searchResultCount()>0)return React.DOM.div({key:"resultCount",className:"mscrm-kbSearchResultCount"},resultString);else return React.DOM.div({key:"resultCount",className:"mscrm-kbSearchResultCount"},this.props.clientContext.getLocalizedString("KMControl.SearchKMArticles.NoResults"))};KbSearchControlSpec.prototype.selectedItemChanged=function(result){this.props.dataContext.set_SelectedSearchResult(result.Article);this.props.dataContext.set_SelectedSearchResultViewModel(result);this.props.dataContext.IncrementKnowledgeArticleViewCount();if(this.props.dataContext.get_IsHostedInReferencePanel())this.props.dataContext.ArticleClick();else this.props.dataContext.set_IsSearchMode(false)};KbSearchControlSpec.prototype.handleSearchButtonClick=function(event,searchText){if(this.props.dataContext){if(searchText!==null&&searchText!=="")this.showResults=true;this.props.dataContext.set_SearchText(searchText);this.props.dataContext.executeAction();this.setState({currentText:searchText});this.props.dataContext.set_IsSearchMode(true)}};KbSearchControlSpec.prototype.recalculateKbSearchControlStyles=function(){var isReflowControlCanBeActive=this.isReflowControlCanBeActive();this.state.isReflowMode!==isReflowControlCanBeActive&&this.setState({isReflowMode:isReflowControlCanBeActive})};KbSearchControlSpec.prototype.isReflowControlCanBeActive=function(){var controlWidth=ReactDOM.findDOMNode(this).clientWidth;if(controlWidth<=0)controlWidth=$(ReactDOM.findDOMNode(this)).parents(":visible:first").width();return controlWidth>this.reflowControlWidth};KbSearchControlSpec.prototype.onTextBoxChanged=function(event){if(event&&event.target){var target=event.target;this.props.dataContext.set_SearchText(target.value);this.setState({currentText:target.value})}};KbSearchControlSpec.prototype.onClearTextClicked=function(event){this.showResults=false;this.props.dataContext.set_SearchText("");this.setState({currentText:""})};KbSearchControlSpec.prototype.onSearchMoreButtonClick=function(event){if(this.props.dataContext){this.showResults=true;this.props.dataContext.loadMoreResults()}};KbSearchControlSpec.prototype.getUsedHeightOfControl=function(){var usedHeight=0,controlBlock=this.refs["controlBlockDiv"];if(controlBlock instanceof Element){var controlBlockDiv=$(controlBlock);usedHeight=usedHeight+controlBlockDiv.outerHeight(true)}return usedHeight};KbSearchControlSpec.prototype.setControlHeight=function(){var kbSearchResultElement=this.refs["mscrm-kbSearchResultContainer"];if(kbSearchResultElement instanceof Element){var kbSearchResultContainer=$(kbSearchResultElement),usedHeight=this.getUsedHeightOfControl();usedHeight=usedHeight+parseInt(kbSearchResultContainer.css("margin-bottom"),10);usedHeight=usedHeight+parseInt(kbSearchResultContainer.css("margin-top"),10);kbSearchResultContainer.css("height","calc(100% - "+usedHeight+"px)")}};KbSearchControlSpec.prototype.renderErrorMessage=function(){return React.DOM.div({className:"mscrm-kbSearchResultDescription",style:{color:"#ff0000"}},this.props.dataContext.get_ErrorString())};KbSearchControlSpec.prototype.componentDidMount=function(){if(this.props.dataContext.get_IsMobileClient())return;this.recalculateKbSearchControlStyles();this.onArticleFilterChange();this.onLanguageFilterChange();this.onSortFilterChange();this.setControlHeight()};KbSearchControlSpec.prototype.componentDidUpdate=function(){if(this.props.dataContext.get_IsMobileClient())return;this.onArticleFilterChange();this.onLanguageFilterChange();this.onSortFilterChange();this.setControlHeight()};KbSearchControlSpec.prototype.renderSearchSummaryContainer=function(){return React.DOM.div({key:"mscrm-kbSearchResultContainer",ref:"mscrm-kbSearchResultContainer",className:"mscrm-kbSearchResultContainer",id:"kbSearchResultContainer"},[this.renderSearchResultsContainer(),this.renderSearchResultFooter()])};KbSearchControlSpec.prototype.renderSearchResults=function(){var children=[],searchAnswer=this.props.dataContext.get_KbSearchResultsList();if(searchAnswer){children.push(this.renderSearchSummaryContainer());return React.DOM.span({key:"mscrm-KbSearchSummaryControl",className:"mscrm-SearchSummaryViewContainer"},children)}};KbSearchControlSpec.prototype.renderSearchResultFooter=function(){var results=this.props.dataContext.get_KbSearchResultsList(),resultsCount=0;if(results)resultsCount=results.get_Count();var footer=SearchResultsFooter.KbSearchResultFooter({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_KbSearchResultFooterViewModel(),moreResultsHandler:this.onSearchMoreButtonClick,resultsPerPage:resultsCount});return footer};KbSearchControlSpec.prototype.renderSearchResultsContainer=function(){var searchResults=this.props.dataContext.get_KbSearchResultsList(),searchResultContainerChildren=[];if(searchResults)for(var searchResultsArray=searchResults.toArray(),i=0,l=searchResultsArray.length;i<l;i++){var kbSearchResults=SearchResultsTable.KbSearchResults({clientContext:this.props.clientContext,dataContext:this.props.dataContext.SearchResult(i),key:searchResultsArray[i].get_ViewModelId(),tabIndex:this.props.tabIndex,parentGivenKey:searchResultsArray[i].get_ViewModelId(),selectItemHandler:this.selectedItemChanged,listClassName:null,isMobileControl:false});searchResultContainerChildren.push(kbSearchResults)}return searchResultContainerChildren};KbSearchControlSpec.prototype.render=function(){if(this.props.dataContext.get_IsMobileClient())return KbSearchControlMobile.KbSearchControlMobile({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor});else{var controlBlock=[],dataBlock=[];controlBlock.push(this.renderHeader());var searchBoxContainer=SearchBoxContainer.SearchBoxContainer({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_searchBoxContainerViewModel(),searchButtonClickHandler:this.handleSearchButtonClick,searchTextChangeHandler:this.onTextBoxChanged,clearTextClickHandler:this.onClearTextClicked,tabIndex:this.props.tabIndex,isHostedInReferencePanel:this.props.dataContext.get_IsHostedInReferencePanel()});this.props.dataContext.get_IsSearchBoxVisible()&&controlBlock.push(searchBoxContainer);if(this.props.dataContext.get_IsSearchMode()){var isLoading=this.props.dataContext.get_IsLoading();if(this.state.isReflowMode){controlBlock.push(this.renderSort());controlBlock.push(this.renderFilters())}else{controlBlock.push(this.renderFilters());controlBlock.push(this.renderSort())}if(this.props.dataContext.get_ErrorString()&&this.props.dataContext.get_ErrorString()!="")dataBlock.push(this.renderErrorMessage());else if(this.showResults)if(this.loadMore){dataBlock.push(this.renderSearchResults());isLoading&&dataBlock.push(this.renderLoading());this.loadMore=false}else if(isLoading)dataBlock.push(this.renderLoading());else dataBlock.push(this.renderSearchResults())}else dataBlock.push(KbSearchResultContentPane.KbSearchControlReadPane({clientContext:this.props.clientContext,dataContext:this.props.dataContext.createKbSearchResultContentPaneViewModel(),selectedSearchResult:this.props.dataContext.get_SelectedSearchResultViewModel(),articleEntityDisplayName:this.props.dataContext.get_ArticleEntityDisplayName(),backButtonHandler:this.onBackButton,showContextualActions:this.props.dataContext.get_ShowContextualActions(),isHostedInReferencePanel:this.props.dataContext.get_IsHostedInReferencePanel(),tabIndex:this.props.tabIndex,getUsedHeightOfControl:this.getUsedHeightOfControl,isMobileControl:false}));var controlBlockDiv=React.DOM.div({key:"controlBlockDiv",ref:"controlBlockDiv"},controlBlock),reflowClassName=this.state.isReflowMode?" mscrm-kbSearchContainer-onReflow":"";if(this.props.dataContext.get_IsHostedInReferencePanel())return React.DOM.div({key:"mscrm-kbSearchContainer",ref:"mscrm-kbSearchContainer",className:"mscrm-kbSearchContainer"+reflowClassName},controlBlockDiv,dataBlock);else return React.DOM.div({key:"mscrm-kbSearchContainer",ref:"mscrm-kbSearchContainer",className:"mscrm-kbSearchContainer_independent"+reflowClassName},controlBlockDiv,dataBlock)}};KbSearchControlSpec.prototype.handleWindowResize=function(){if(this.props.dataContext.get_IsMobileClient())return;this.recalculateKbSearchControlStyles()};return KbSearchControlSpec}(TsAdapter.SpecBase);exports.KbSearchControl=DataWrapperComponent.wrapComponent(new KbSearchControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/CollapsibleControl/CollapsibleControl",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Components/Primitives/FontIcon","Utils/CssClassSet","Components/ComponentFactory"],function(require,exports,TsAdapter,PureUpdate,Button,FontIcon,CssClassSet,ComponentFactory){exports.DESCRIPTOR_NAME="CollapsibleControl";(function(HeaderFormat){HeaderFormat[HeaderFormat["LabelLeft"]=0]="LabelLeft";HeaderFormat[HeaderFormat["LabelRight"]=1]="LabelRight";HeaderFormat[HeaderFormat["NoLabel"]=2]="NoLabel"})(exports.HeaderFormat||(exports.HeaderFormat={}));var HeaderFormat=exports.HeaderFormat;(function(CollapsedDirection){CollapsedDirection[CollapsedDirection["Vertical"]=0]="Vertical";CollapsedDirection[CollapsedDirection["LeftRight"]=1]="LeftRight";CollapsedDirection[CollapsedDirection["RightLeft"]=2]="RightLeft"})(exports.CollapsedDirection||(exports.CollapsedDirection={}));var CollapsedDirection=exports.CollapsedDirection,CollapsibleControlSpec=function(_super){__extends(CollapsibleControlSpec,_super);function CollapsibleControlSpec(){_super.apply(this,arguments);this.displayName="CollapsibleControl";this.mixins=[PureUpdate.Mixin]}CollapsibleControlSpec.prototype.getInitialState=function(){return {collapsed:this.props.defaultCollapsed,initialHeight:this.props.height,initialWidth:this.props.width,currentHeight:this.props.defaultCollapsed?0:this.props.height,currentWidth:this.props.defaultCollapsed?0:this.props.width}};CollapsibleControlSpec.prototype.getDefaultProps=function(){return {headerFormatExpanded:HeaderFormat.NoLabel,headerFormatCollapsed:HeaderFormat.NoLabel,defaultCollapsed:false,buttonClassName:"toggleButton",buttonImageNameExpanded:"Expanded",buttonImageNameCollapsed:"Collapsed",className:"collapsibleComponent",hideButton:false,ariaLabel:""}};CollapsibleControlSpec.prototype.handleButtonClick=function(){if(this.props.stateChangedEventHandler)if(!this.props.stateChangedEventHandler(!this.state.collapsed))return;if(this.props.collapsedDirection!=null)if(this.props.collapsedDirection===CollapsedDirection.Vertical)this.setState({collapsed:!this.state.collapsed,currentHeight:!this.state.collapsed?0:this.state.initialHeight,currentWidth:this.state.initialWidth});else this.setState({collapsed:!this.state.collapsed,currentHeight:this.state.initialHeight,currentWidth:!this.state.collapsed?0:this.state.initialWidth});else this.setState({collapsed:!this.state.collapsed})};CollapsibleControlSpec.prototype.handleButtonKeyDown=function(e){switch(e.keyCode){case 13:case 32:this.handleButtonClick();break;case 37:this.setState({collapsed:true});break;case 39:this.setState({collapsed:false});break}};CollapsibleControlSpec.prototype.componentDidMount=function(){if(!this.props.defaultCollapsed)if(!this.state.initialHeight||!this.state.initialWidth){var bodyChildren=$(this.refs["bodyComponent"]);this.setState({initialHeight:bodyChildren.outerHeight(),initialWidth:bodyChildren.outerWidth()})}if($("#collapsiblePanelScreenReadableElementId").length==0){var screenReaderElement=$("<div>");screenReaderElement.attr("id","collapsiblePanelScreenReadableElementId");screenReaderElement.attr("class","onlyScreenReadableContent");screenReaderElement.attr("aria-live","assertive");screenReaderElement.attr("aria-atomic","true");$("#collapsibleBodyElementId").length!=0&&$("#collapsibleBodyElementId").append(screenReaderElement)}};CollapsibleControlSpec.prototype.componentDidUpdate=function(){if(!this.state.collapsed)if(!this.state.initialHeight||!this.state.initialWidth){var bodyChildren=$(this.refs["bodyComponent"]);this.setState({initialHeight:bodyChildren.outerHeight(),initialWidth:bodyChildren.outerWidth()})}};CollapsibleControlSpec.prototype.componentWillReceiveProps=function(nextProps){nextProps.defaultCollapsed!=this.props.defaultCollapsed&&this.setState({collapsed:nextProps.defaultCollapsed})};CollapsibleControlSpec.prototype.generateBodyComponent=function(contentChildren){if(contentChildren===void 0)contentChildren=[];var bodyComponent;if(this.props.collapsedDirection!=null)bodyComponent=React.DOM.div({key:"bodyComponent",ref:"bodyComponent",style:{height:this.state.currentHeight?this.state.currentHeight:"auto",width:this.state.currentWidth?this.state.currentWidth:"auto"},className:CssClassSet({collapsibleBody:true,verticalTransition:this.props.collapsedDirection===CollapsedDirection.Vertical,horizontalTransition:this.props.collapsedDirection!==CollapsedDirection.Vertical,leftToRightCollapse:this.props.collapsedDirection===CollapsedDirection.LeftRight}),id:"collapsibleBodyElementId"},contentChildren);else bodyComponent=React.DOM.div({key:"bodyComponent",ref:"bodyComponent",style:{height:this.state.collapsed?"0px":"100%",display:this.state.collapsed?"none":"block"},className:"collapsibleBody",id:"collapsibleBodyElementId"},contentChildren);return bodyComponent};CollapsibleControlSpec.prototype.render=function(){var button=Button.Button({key:"togglebutton",className:this.props.buttonClassName,onClick:this.handleButtonClick,onKeyDown:this.handleButtonKeyDown,tabIndex:this.props.tabIndex,dataId:this.props.dataId,ariaLabel:this.props.ariaLabel},FontIcon.FontIcon({symbolName:!this.state.collapsed?this.props.buttonImageNameExpanded:this.props.buttonImageNameCollapsed})),label,headerChildren=[];switch(!this.state.collapsed?this.props.headerFormatExpanded:this.props.headerFormatCollapsed){case HeaderFormat.LabelLeft:label=this.props.headerLabel;headerChildren.push(label);headerChildren.push(button);break;case HeaderFormat.LabelRight:label=this.props.headerLabel;headerChildren.push(button);headerChildren.push(label);break;case HeaderFormat.NoLabel:!this.props.hideButton&&headerChildren.push(button)}var header=React.DOM.div({key:"headerComponent",className:"collapsibleHeader"},headerChildren),contentChildren=[];React.Children.forEach(this.props.children,function(child){contentChildren.push(child)});if(contentChildren.length==0)contentChildren=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext);var bodyChildren=this.generateBodyComponent(contentChildren);return React.DOM.div({id:"collapsibleGraphArea",key:"collapsibleComponent",className:this.props.className},[header,bodyChildren])};return CollapsibleControlSpec}(TsAdapter.SpecBase);exports.CollapsibleControl=TsAdapter.createComponent(new CollapsibleControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/GlobalFilterControl/GlobalFilterLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/PureUpdateMixin","Components/InteractionCentric/CollapsibleControl/CollapsibleControl","Components/Fields/DetailFieldsSection","Components/Primitives/ImageButton","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,PureUpdate,CollapsibleControl,DetailFieldsSection,ImageButton,Constants){exports.DESCRIPTOR_NAME="GlobalFilterLookup";var GlobalFilterLookupSpec=function(_super){__extends(GlobalFilterLookupSpec,_super);function GlobalFilterLookupSpec(){_super.apply(this,arguments);this.displayName="GlobalFilterLookup";this.mixins=[PureUpdate.Mixin];this.listenToProperties=["RemovedEntity"]}GlobalFilterLookupSpec.prototype.handleExpandOrCollapseIconClick=function(collapsed){this.props.dataContext.handleExpandOrCollapseIconClick(!collapsed);return true};GlobalFilterLookupSpec.prototype.handleDeleteItemCommand=function(index){this.props.dataContext.removeEntityReferenceForGuid(this.props.dataContext.getGuidAtIndex(index))};GlobalFilterLookupSpec.prototype.handleDeleteItemOnKeyDown=function(index,e){if(e.keyCode===Constants.ENTER_KEY_CODE){this.handleDeleteItemCommand(index);if(index===this.props.dataContext.get_SelectedFilterCount()){var itemList=$(ReactDOM.findDOMNode(this)).find("[tabindex]:not([tabindex^=-])"),currentElementIndex=itemList&&itemList.length!==0?itemList.index(e.target):-1;currentElementIndex>-1&&$(itemList[currentElementIndex-1]).focus()}}};GlobalFilterLookupSpec.prototype.render=function(){if(!this.props.dataContext.get_Active())return React.DOM.noscript();var children=[],attributeLabel=React.DOM.span({key:"attributeName",className:"attributeName"},this.props.dataContext.get_AttributeDisplayName());if(this.props.dataContext.get_SelectedFilterCount()!=0)var selectedFilter=React.DOM.span({key:"selectedFilter",className:"selectedFilter"}," "+this.props.dataContext.get_SelectedFilterCount());var header=React.DOM.span({className:"attributeHeader",key:"attributeHeader"},[attributeLabel,selectedFilter]),headerElement=[];if(this.props.dataContext.get_SelectedFilterCount()!=0)for(var i=0;i<this.props.dataContext.get_SelectedFilterCount();i++){var guid=this.props.dataContext.getGuidAtIndex(i);if(guid!=null){var label=React.DOM.span({className:"SelectedFilterItem_label"},this.props.dataContext.getSelectedFilterName(guid)),imageButton=ImageButton.ImageButton({key:"delete",imageType:"Symbol",imageName:"Clear",className:"SelectedFilterItem_delete",onClick:this.handleDeleteItemCommand.bind(this,i),tabIndex:this.props.tabIndex,onKeyDown:this.handleDeleteItemOnKeyDown.bind(this,i)});headerElement.push(React.DOM.div({key:"selectedFilterName_"+i,className:"selectedFilterName"},[label,imageButton]))}}var headerElementDiv=React.DOM.div({key:"headerElementDiv",className:"headerElementDiv"},headerElement),lookup=DetailFieldsSection.DetailFieldsSection({key:"globallookup",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,tabIndex:this.props.tabIndex});children.push(lookup);var screenReaderText=this.props.dataContext.getScreenReadableText();return CollapsibleControl.CollapsibleControl({headerLabel:header,headerFormatExpanded:CollapsibleControl.HeaderFormat.LabelRight,headerFormatCollapsed:CollapsibleControl.HeaderFormat.LabelRight,defaultCollapsed:!this.props.dataContext.get_IsExpanded(),clientContext:this.props.clientContext,stateChangedEventHandler:this.handleExpandOrCollapseIconClick,dataContext:null,className:"lookupFilter",buttonImageNameExpanded:"GlobalFilterExpand",buttonImageNameCollapsed:"GlobalFilterCollapse",tabIndex:this.props.tabIndex,ariaLabel:screenReaderText?screenReaderText:""},children,headerElementDiv)};return GlobalFilterLookupSpec}(TsAdapter.SpecBase);exports.GlobalFilterLookup=DataWrapperComponent.wrapComponent(new GlobalFilterLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/MailAppMultiLineList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Utils/CssClassSet","Components/Primitives/FontIcon","Components/Lists/MultilineList","Components/MailApp/SetRegardingButton","Components/MailApp/ActionableCrmItem"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,CssClassSet,FontIcon,MultilineList,SetRegardingButton,ActionableCrmItem){exports.DESCRIPTOR_NAME="MailAppMultiLineList";var MailAppMultiLineListSpec=function(_super){__extends(MailAppMultiLineListSpec,_super);function MailAppMultiLineListSpec(){_super.apply(this,arguments);this.displayName="MailAppMultiLineList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin]}MailAppMultiLineListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};MailAppMultiLineListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};MailAppMultiLineListSpec.prototype.createOpenInBrowserClickHandler=function(itemDataContext){var dataContext=this.props.dataContext;return function(e){dataContext.openListItemInWeb(itemDataContext);e.stopPropagation()}};MailAppMultiLineListSpec.prototype.renderOpenInBrowserButton=function(itemDataContext){var children=[FontIcon.FontIcon({symbolName:"PopOverButton"})];return React.DOM.button({key:"openInBrowser",className:CssClassSet({},"openInBrowser-commandButton","commandButton"),onShortPress:this.createOpenInBrowserClickHandler(itemDataContext),title:this.props.clientContext.getLocalizedString("MoCA_OWA_OpenRecord")},children)};MailAppMultiLineListSpec.prototype.listItemRenderer=function(item,childIndex,selectedMarkComponent,itemDataContext){if(childIndex!=0)return item;var disaplayAsActionableCrmItem=this.props.descriptor&&this.props.descriptor.Properties&&"HasCollapseForAcompli" in this.props.descriptor.Properties&&this.props.clientContext.userAgent.get_IsMobilePhone();this.props.dataContext.updateFieldsVisibility(itemDataContext);var setRegardingButton,setRegardingButtonDataContext=this.props.dataContext.getSetRegardingButtonViewModel(itemDataContext);if(setRegardingButtonDataContext){setRegardingButtonDataContext.set_ShowLabel(disaplayAsActionableCrmItem);var setRegardingBtnTitle=this.props.descriptor&&this.props.descriptor.Properties?this.props.descriptor.Properties["SetRegardingButtonTitle"]:null,setRegardingBtnDescriptor={__type:null,TypeName:null,ChildControlViewDescriptors:null,Properties:{Title:setRegardingBtnTitle}};setRegardingButton=SetRegardingButton.SetRegardingButton({dataContext:setRegardingButtonDataContext,clientContext:this.props.clientContext,className:"commandButton",descriptor:setRegardingBtnDescriptor})}if(disaplayAsActionableCrmItem){itemDataContext.set_SelectListItemCommand(null);return ActionableCrmItem.ActionableCrmItem({className:"mailAppMultiLineListItem",dataContext:itemDataContext,clientContext:this.props.clientContext,openInBowserButtonShortPress:this.createOpenInBrowserClickHandler(itemDataContext),setRegardingButton:setRegardingButton},item)}else{var actionButton=setRegardingButton,mainActionTitle=this.props.clientContext.getLocalizedString("MoCA_OWA_OpenRecord");if(!this.props.dataContext.get_ShowSetRegardingButtonAsActionable()){actionButton=this.renderOpenInBrowserButton(itemDataContext);mainActionTitle=this.props.clientContext.getLocalizedString("MoCA_OWA_SetRegarding_Tooltip")}return React.DOM.div({key:"mailAppMultiLineListItem",className:"mailAppMultiLineListItem",title:mainActionTitle},[item,actionButton])}};MailAppMultiLineListSpec.prototype.render=function(){var multilineList=MultilineList.MultilineList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,listItemRenderer:this.listItemRenderer});return React.DOM.div({"data-id":"GridHeader","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SourceId()},multilineList)};return MailAppMultiLineListSpec}(TsAdapter.SpecBase);exports.MailAppMultiLineList=DataWrapperComponent.wrapComponent(new MailAppMultiLineListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/MailAppRelevantSearchList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Utils/CssClassSet","Components/Primitives/FontIcon","Components/Lists/MultilineList"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,CssClassSet,FontIcon,MultilineList){exports.DESCRIPTOR_NAME="MailAppRelevantSearchList";var MailAppRelevantSearchListSpec=function(_super){__extends(MailAppRelevantSearchListSpec,_super);function MailAppRelevantSearchListSpec(){_super.apply(this,arguments);this.displayName="MailAppRelevantSearchList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin]}MailAppRelevantSearchListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};MailAppRelevantSearchListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};MailAppRelevantSearchListSpec.prototype.renderOpenInBrowserButton=function(itemDataContext){var children=[FontIcon.FontIcon({symbolName:"PopOverButton"})],dataContext=this.props.dataContext;return React.DOM.button({key:"openInBrowser",className:CssClassSet({},"openInBrowser-commandButton","commandButton"),onShortPress:function(e){dataContext.openListItemInWeb(itemDataContext);e.stopPropagation()},title:this.props.clientContext.getLocalizedString("MoCA_OWA_OpenRecord")},children)};MailAppRelevantSearchListSpec.prototype.listItemRenderer=function(item,childIndex,selectedMarkComponent,itemDataContext){if(childIndex!=0)return item;this.props.dataContext.updateFieldsVisibility(itemDataContext);return React.DOM.div({key:"setregardinglistitem",title:this.props.clientContext.getLocalizedString("MoCA_OWA_SetRegarding_Tooltip")},[item,this.renderOpenInBrowserButton(itemDataContext)])};MailAppRelevantSearchListSpec.prototype.render=function(){return React.DOM.div({"data-id":"GridHeader","data-vmid":this.props.dataContext.get_ViewModelId(),"data-viewid":this.props.dataContext.get_SourceId(),className:"relevantSearch"},MultilineList.MultilineList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.state.viewDescriptor,listItemRenderer:this.listItemRenderer}))};return MailAppRelevantSearchListSpec}(TsAdapter.SpecBase);exports.MailAppRelevantSearchList=DataWrapperComponent.wrapComponent(new MailAppRelevantSearchListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Core/ScheduledRender",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var ScheduledRenderSpec=function(_super){__extends(ScheduledRenderSpec,_super);function ScheduledRenderSpec(){_super.apply(this,arguments);this.displayName="ScheduledRender"}ScheduledRenderSpec.prototype.getInitialState=function(){return {render:false}};ScheduledRenderSpec.prototype.componentDidMount=function(){var _this=this;Microsoft.Crm.Client.Core.Framework.Scheduler.Schedule(function(){_this.setState({render:true})},this.props.priority||Microsoft.Crm.Client.Core.Framework.SchedulerPriorities.scheduledReactUpdate,"ScheduledRender")};ScheduledRenderSpec.prototype.render=function(){if(!this.state.render)return React.DOM.noscript();return this.props.renderer()};return ScheduledRenderSpec}(TsAdapter.SpecBase);exports.ScheduledRender=TsAdapter.createComponent(new ScheduledRenderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Trees/SubjectTree",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Primitives/HyperlinkButton","Components/Primitives/FontIcon","Components/Primitives/ProgressIndicator"],function(require,exports,TsAdapter,DataWrapperComponent,Button,HyperlinkButton,FontIcon,ProgressIndicator){exports.DESCRIPTOR_NAME="SubjectTree";var SubjectTreeSpec=function(_super){__extends(SubjectTreeSpec,_super);function SubjectTreeSpec(){_super.apply(this,arguments);this.displayName="SubjectTree";this.SUBJECT_LEFT_OFFSET=19;this.listenToProperties=["FirstLevelSubjects","SubjectTreeItemIdForInserting"]}SubjectTreeSpec.prototype.componentWillUnmount=function(){if(this.props.dataContext){this.props.dataContext.set_OpenedBranches(this.state.openedBranches);this.props.dataContext.set_SelectedItem(this.state.selectedItem)}};SubjectTreeSpec.prototype.componentDidMount=function(){this.props.dataContext&&this.setState({openedBranches:this.props.dataContext.get_OpenedBranches()||[],selectedItem:this.props.dataContext.get_SelectedItem()})};SubjectTreeSpec.prototype.getInitialState=function(){return {openedBranches:[],selectedItem:null}};SubjectTreeSpec.prototype.toggleBranch=function(idElem){var branches=this.state.openedBranches;if(this.state.openedBranches.indexOf(idElem)>=0)branches.splice(this.state.openedBranches.indexOf(idElem),1);else branches.push(idElem);this.setState({openedBranches:branches,selectedItem:this.state.selectedItem})};SubjectTreeSpec.prototype.handleSelectSubjectTreeItem=function(item){this.setState({openedBranches:this.state.openedBranches,selectedItem:item})};SubjectTreeSpec.prototype.handleViewInCRMClick=function(){this.state.selectedItem!=null&&this.props.dataContext.viewInCrm(this.state.selectedItem.get_Id(),this.state.selectedItem.get_ModelName())};SubjectTreeSpec.prototype.handleAddToEmailClick=function(){this.state.selectedItem!=null&&this.props.dataContext.addSubjectTreeItem(this.state.selectedItem.get_Id(),this.state.selectedItem.get_ModelName())};SubjectTreeSpec.prototype.renderSubjectTreeItem=function(subjectTreeData,subjectDepth){var symbolName="SubjectTreeItem",itemClassName="subjectTreeItem linkItem";if(this.state.selectedItem!=null&&subjectTreeData.get_Id()===this.state.selectedItem.get_Id())itemClassName+=" active";var toggleButton=Button.Button({key:"togglebutton",className:"toggleButton"},FontIcon.FontIcon({symbolName:symbolName})),progressIndicactor=this.props.dataContext.get_SubjectTreeItemIdForInserting()==subjectTreeData.get_Id()?ProgressIndicator.ProgressIndicator({key:"insertingTemplate",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}):null;return React.DOM.div({key:"subjectTreeItem_"+subjectTreeData.get_Id(),className:itemClassName,style:{paddingLeft:subjectDepth*this.SUBJECT_LEFT_OFFSET+"px"},onClick:this.handleSelectSubjectTreeItem.bind(this,subjectTreeData)},[React.DOM.div({key:"subjectTreeItem",className:"subjectTreeItemHeader"},subjectTreeData.get_Name(),toggleButton),progressIndicactor])};SubjectTreeSpec.prototype.renderSubject=function(subjectNode,subjectDepth){var symbolName="";if(this.state.openedBranches.indexOf(subjectNode.get_Id())<0)symbolName="SubjectTreeItemClosed";else symbolName="SubjectTreeItemOpened";var clickHandler=this.toggleBranch.bind(this,subjectNode.get_Id()),toggleButton=Button.Button({key:"togglebutton",className:"toggleButton"},FontIcon.FontIcon({symbolName:symbolName}));return React.DOM.div({key:"subject",className:"subjectTreeItem",style:{paddingLeft:subjectDepth*this.SUBJECT_LEFT_OFFSET+"px"},onClick:clickHandler},React.DOM.div({className:"subjectTreeItemHeader"},subjectNode.get_Title(),toggleButton))};SubjectTreeSpec.prototype.renderNode=function(subjectNode,subjectDepth){var subjectTitleDiv=this.renderSubject(subjectNode,subjectDepth),childSubjectNodes=[];if(this.state.openedBranches.indexOf(subjectNode.get_Id())>=0){for(var childSubjects=subjectNode.get_Children(),j=0;j<childSubjects.get_Count();j++){var childSubject=childSubjects.get_Items()[j];this.branchHasItems(childSubject)&&childSubjectNodes.push(this.renderNode(childSubject,subjectDepth+1))}for(var treeItems=subjectNode.get_TreeData(),j=0;j<treeItems.get_Count();j++){var treeItem=treeItems.get_Items();childSubjectNodes.push(this.renderSubjectTreeItem(treeItem[j],subjectDepth+1))}}var childNodesDiv=React.DOM.div({className:"subjectTreeInnerItemsContainer"},childSubjectNodes);return React.DOM.div({key:"subjectTreeNode_"+subjectNode.get_Id(),className:"subjectTreeItemContainer"},[subjectTitleDiv,childNodesDiv])};SubjectTreeSpec.prototype.renderTree=function(){for(var firstLevelSubjects=this.props.dataContext.get_FirstLevelSubjects().get_Items(),firstLevelSubjectNodes=[],i=0;i<firstLevelSubjects.length;i++){var subjectItemNode=firstLevelSubjects[i];this.branchHasItems(subjectItemNode)&&firstLevelSubjectNodes.push(this.renderNode(subjectItemNode,0))}for(var itemsWithoutSubject=this.props.dataContext.get_NoSubjectItems().get_Items(),j=0;j<itemsWithoutSubject.length;j++){var itemNode=itemsWithoutSubject[j];firstLevelSubjectNodes.push(this.renderSubjectTreeItem(itemNode,0))}return React.DOM.div({key:"SubjectItemContainer",className:"subjectItemContainer"},firstLevelSubjectNodes)};SubjectTreeSpec.prototype.branchHasItems=function(subjectNode){if(subjectNode.get_TreeData().get_Items().length>0)return true;for(var childSubjects=subjectNode.get_Children().toArray(),j=0;j<childSubjects.length;j++)if(this.branchHasItems(childSubjects[j]))return true;return false};SubjectTreeSpec.prototype.treeHasItems=function(){return this.props.dataContext.get_NoSubjectItems().get_Items().length>0||this.props.dataContext.get_FirstLevelSubjects().get_Items().length>0};SubjectTreeSpec.prototype.renderProgress=function(){var progress=ProgressIndicator.ProgressIndicator({key:"progress",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring,className:"rootViewControlLoadingRing"}),loading=React.DOM.div({key:"loading",className:"loadingdiv"},progress);return loading};SubjectTreeSpec.prototype.getControlsComponent=function(){var buttonsEnabled=this.state.selectedItem!=null,actions=[];actions.push(HyperlinkButton.HyperlinkButton({key:"viewInCRM",dataId:"viewInCRM",enabled:buttonsEnabled,label:this.props.dataContext.get_ViewInCRMText(),onClick:this.handleViewInCRMClick}));actions.push(HyperlinkButton.HyperlinkButton({key:"addToEmail",dataId:"addToEmail",enabled:buttonsEnabled&&!this.props.dataContext.get_SubjectTreeItemIdForInserting(),label:this.props.dataContext.get_AddToEmailText(),onClick:this.handleAddToEmailClick}));return React.DOM.div({key:"emailTemplatesControls",className:"actions"},actions)};SubjectTreeSpec.prototype.render=function(){var childrens=[],subjectTreeItems=[];if(this.props.dataContext.get_isLoading())childrens.push(this.renderProgress());else{var subjectTreeTitle=React.DOM.div({key:"SubjectTreeTitle",className:"subjectTreeTitle"},this.props.dataContext.get_SubjectTreeTitle());subjectTreeItems.push(subjectTreeTitle)}subjectTreeItems.push(this.renderTree());childrens.push(React.DOM.div({className:"subjectTree"},subjectTreeItems));!this.props.dataContext.get_isLoading()&&this.treeHasItems()&&childrens.push(this.getControlsComponent());return React.DOM.div({key:"subject-tree-page",className:"subject-tree-page"},childrens)};return SubjectTreeSpec}(TsAdapter.SpecBase);exports.SubjectTree=DataWrapperComponent.wrapComponent(new SubjectTreeSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Lists/EmailTemplatesList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Components/Lists/MultilineList","Components/Primitives/ProgressIndicator"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,CustomEventsListener,MultilineList,ProgressIndicator){exports.DESCRIPTOR_NAME="EmailTemplatesList";var EmailTemplatesListSpec=function(_super){__extends(EmailTemplatesListSpec,_super);function EmailTemplatesListSpec(){_super.apply(this,arguments);this.displayName="EmailTemplatesList";this.mixins=[RetrieveViewDescriptor.Mixin,CustomEventsListener.Mixin];this.listenToProperties=["ViewModelId","PrimaryModelName","IsSelected","Label","Items"];this.listenToCollections=["Items"]}EmailTemplatesListSpec.prototype.configureEventListeners=function(){return {DefinitionUpdated:this.handleDefinitionUpdated}};EmailTemplatesListSpec.prototype.handleDefinitionUpdated=function(){this.requestViewDescriptor(this.props)};EmailTemplatesListSpec.prototype.listItemRenderer=function(item,childIndex,selectedMarkComponent,itemDataContext){var rootViewModel=itemDataContext.get_Root(),progressIndicactor=rootViewModel.get_TemplateIdForInserting()==itemDataContext.get_ModelContext().get_Id()?ProgressIndicator.ProgressIndicator({key:"insertingTemplate",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}):null;return React.DOM.div({key:childIndex.toString()},[item,progressIndicactor])};EmailTemplatesListSpec.prototype.render=function(){if(this.props.dataContext.get_Items().get_Count())return MultilineList.MultilineList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,listItemRenderer:this.listItemRenderer});return null};return EmailTemplatesListSpec}(TsAdapter.SpecBase);exports.EmailTemplatesList=DataWrapperComponent.wrapComponent(new EmailTemplatesListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Panorama/PanoramaItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/WindowResizeHandlerMixin","Components/DataWrapperComponent","Components/ComponentFactory","Components/Panorama/PanoramaItemTitle","Components/Panorama/PanoramaItemSeeMore","Components/Common/TestHooksDiv","Components/Primitives/ProgressIndicator","Components/Lists/PinnedTileList","Components/Lists/MultilineList","Components/Lists/SelectableList","Components/Charts/Chart","Components/Charts/ChartDrilldown","Components/Grids/GridList","Components/InteractionCentric/GridView/InteractionCentricGridList","Components/Fields/FieldsPane","Components/Lists/HierarchyList","Components/Search/SearchSummary","Components/Search/UserInfo","Components/Search/FacetPane","Components/Common/MessageHtmlLabel","Components/Primitives/ScrollRegion","Components/Grids/GridContainer","Components/RelatedEntitySearchControls/KbSearchControl","Utils/CssClassSet","Utils/PreserveScrollPositionMixin","Components/InteractionCentric/GlobalFilterControl/GlobalFilterLookup","Core/Binding/XrmUIDescriptorMixin","Components/Lists/MailAppMultiLineList","Components/Lists/MailAppRelevantSearchList","Core/ScheduledRender","Components/Trees/SubjectTree","Components/Lists/EmailTemplatesList"],function(require,exports,TsAdapter,WindowResizeHandler,DataWrapperComponent,ComponentFactory,PanoramaItemTitle,PanoramaItemSeeMore,TestHooksDiv,ProgressIndicator,PinnedTileList,MultilineList,SelectableList,Chart,ChartDrilldown,GridList,InteractionCentricGridList,FieldsPane,HierarchyList,SearchSummary,UserInfo,FacetPane,MessageHtmlLabel,ScrollRegion,GridContainer,KbSearchControl,CssClassSet,PreserveScrollPosition,GlobalFilterLookup,IXUD,MailAppMultiLineList,MailAppRelevantSearchList,ScheduledRender,SubjectTree,EmailTemplatesList){exports.DESCRIPTOR_NAME="PanoramaItem";var PANORAMA_ITEM_MIN_WIDTH=310;exports.PANORAMA_ITEM_TITLE_HEIGHT=47;var PanoramaItemSpec=function(_super){__extends(PanoramaItemSpec,_super);function PanoramaItemSpec(){_super.apply(this,arguments);this.displayName="PanoramaItem";this.mixins=[WindowResizeHandler.Mixin,PreserveScrollPosition.Mixin,IXUD.Mixin];this.listenToProperties=["IsSelected","Visible","HasFocus","HideChildren","ScrollToFocused"];this.previousHasFocus=false}PanoramaItemSpec.prototype.getScrollPreservationStrategy=function(){return new PreserveScrollPosition.ComponentRefScrollPreservationStrategy("scroll")};PanoramaItemSpec.prototype.getInitialState=function(){var state={};if(this.props.clientContext.isPhone)state.width=WindowResizeHandler.getWindowWidth();return state};PanoramaItemSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.panoramaItem;properties["id"]=this.props.parentGivenKey;properties["parentId"]=XrmUI.UIControlType.panoramaContainer;return properties};PanoramaItemSpec.prototype.handleWindowResize=function(){this.props.clientContext.isPhone&&this.setState({width:WindowResizeHandler.getWindowWidth()})};PanoramaItemSpec.prototype.calculateStyles=function(scrollable,fixedWidth){var style={},componentType=this.props.dataContext.get_Root().get_ComponentType();if(!this.props.clientContext.isPhone&&(componentType===13||componentType===17||componentType===50||this.props.dataContext.get_Root().get_IsPowerBIDashboard()))return style;if(this.props.styles)for(var key in this.props.styles)style[key]=this.props.styles[key];if(!this.props.calculateWidth)return style;var itemWidth=this.props.dataContext.get_Width(),finalWidth;if(this.state.width)finalWidth=this.state.width.toString();else if(itemWidth){if(scrollable&&fixedWidth){var scrollBarWidth=this.props.clientContext.scrollBarWidth;itemWidth+=scrollBarWidth}finalWidth=itemWidth}else finalWidth=PANORAMA_ITEM_MIN_WIDTH.toString();if(!this.props.clientContext.isMailApp){var flexGrow=0,flexShrink=0,root=this.props.dataContext.get_Root();if(root&&root.get_ComponentTypeName()==="dialog"){flexGrow=1;flexShrink=1}if(finalWidth!=="auto")finalWidth=finalWidth+"px";if(this.props.isStacked){flexGrow=1;flexShrink=1;style["width"]=finalWidth}else if(this.props.clientContext.isPhone&&this.props.clientContext.userAgent.get_IsWindows()){var componentName=this.props.dataContext.get_Name();if(componentName==="DrilldownChartPane"||componentName==="DrilldownDataPane"){style["width"]="calc("+finalWidth+" - 34px)";style["box-sizing"]="content-box"}finalWidth="auto"}var flexStyle=flexGrow+" "+flexShrink+" "+finalWidth;style["WebkitBoxFlex"]=flexStyle;style["MozBoxFlex"]=flexStyle;style["WebkitFlex"]=flexStyle;style["msFlex"]=flexStyle;style["flex"]=flexStyle}return style};PanoramaItemSpec.prototype.checkFocus=function(){if(this.props.dataContext){var hasFocus=this.props.dataContext.get_HasFocus();if(hasFocus&&(!this.previousHasFocus||this.props.dataContext.get_ForceScrollToFocus())){var node=ReactDOM.findDOMNode(this),leftPosition=$(node).position().left;this.props.focusScrollCallback&&this.props.focusScrollCallback(leftPosition,true);this.previousHasFocus=hasFocus}this.props.dataContext.set_ForceScrollToFocus(false)}};PanoramaItemSpec.prototype.getDefaultProps=function(){return {calculateWidth:true,showProgress:true}};PanoramaItemSpec.prototype.componentDidMount=function(){this.checkFocus()};PanoramaItemSpec.prototype.componentDidUpdate=function(prevProps){this.checkFocus();if(this.props.dataContext.get_SearchButtonPress()&&this.props.dataContext.get_IsInteractionCentricEnabled()){this.props.dataContext.set_SearchButtonPress(false);var panaromaItem=$(".panoramaItem")==null?null:$(".panoramaItem")[0];if(panaromaItem!=null){var listItem=$(panaromaItem).find(".listItem")[0];if(listItem!=null)$(listItem).focus();else{var item=$(".searchboxiconcontainer > input")[0];item!=null&&$(item).focus()}}}};PanoramaItemSpec.prototype.scrollRegionWrapperInterceptor=function(factory,props,children){var divProps=props;divProps.dataContext=this.props.dataContext;divProps.clientContext=this.props.clientContext;return TestHooksDiv.TestHooksDiv(divProps,children)};PanoramaItemSpec.prototype.childDecorator=function(factory,childProps){childProps["expectedContainerHeight"]=this.props.expectedContainerHeight;childProps["expectedContainerWidth"]=this.props.expectedContainerWidth;if(this.props.isStacked&&this.props.clientContext.isPhone)childProps["containerRenderer"]=function(children){return React.DOM.div({},children.slice(0,3))};return factory(childProps)};PanoramaItemSpec.prototype.renderItem=function(){var contentChildren=[];if(!this.props.dataContext.get_HideChildren()){React.Children.forEach(this.props.children,function(child){contentChildren.push(child)});if(contentChildren.length==0){contentChildren=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);if(this.props.isStacked&&this.props.clientContext.isPhone)this.props.dataContext.get_HasSeeMoreButton()&&contentChildren.push(PanoramaItemSeeMore.PanoramaItemSeeMore({dataContext:this.props.dataContext.get_SeeMoreButtonViewModel(),clientContext:this.props.clientContext}))}}var panoramaItemChildren=[],descriptorClassName="",isSelected=this.props.dataContext.get_IsSelected(),isForceWebkitLayer=false;panoramaItemChildren.push(PanoramaItemTitle.PanoramaItemTitle({key:"title",clientContext:this.props.clientContext,dataContext:this.props.dataContext,titleChildren:this.props.titleChildren,titleChildrenStyles:this.props.titleChildrenStyles,titleSuffix:this.props.titleSuffix}));if(contentChildren.length>0){var scrollable=false,fixedWidth=true;if(this.props.descriptor&&this.props.descriptor.Properties){if("Scrollable" in this.props.descriptor.Properties)scrollable=this.props.descriptor.Properties["Scrollable"];if("FixedWidth" in this.props.descriptor.Properties)fixedWidth=this.props.descriptor.Properties["FixedWidth"];if("CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];isForceWebkitLayer=this.props.clientContext.userAgent.get_IsAndroid51()&&descriptorClassName.indexOf("iframePanoramaItem")===-1}var control=React.DOM.div({key:"control",className:"panoramaItem-control"},contentChildren);contentChildren=null;var component=React.DOM.div({key:"component",className:"component"},control),content=React.DOM.div({key:"content",className:CssClassSet({"panoramaItem-content":true,"panoramaItem-content_scrollable":scrollable,webkitInertiaScroll:scrollable,forceWebkitLayer:isForceWebkitLayer})},component);panoramaItemChildren.push(content);isSelected&&panoramaItemChildren.push(React.DOM.div({key:"check",className:"item_Checked"}))}else this.props.showProgress&&panoramaItemChildren.push(ProgressIndicator.ProgressIndicator({key:"loading",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}));var style=this.calculateStyles(scrollable,fixedWidth);if(!this.props.dataContext.get_Visible()||this.props.parentGivenKey=="searchSummaryPane"&&!this.props.dataContext.get_Label())style["display"]="none";var className=CssClassSet({panoramaItem_selected:isSelected},"panoramaItem",descriptorClassName,this.props.className);if(this.props.descriptor&&this.props.descriptor.Properties&&"HasScrollRegion" in this.props.descriptor.Properties&&this.props.descriptor.Properties["HasScrollRegion"]){var scrollRegionProps={ref:"scroll",className:className,style:style,wrapperInterceptor:this.scrollRegionWrapperInterceptor};return ScrollRegion.ScrollRegion(scrollRegionProps,panoramaItemChildren)}else return TestHooksDiv.TestHooksDiv({clientContext:this.props.clientContext,dataContext:this.props.dataContext,className:className,style:style},panoramaItemChildren)};PanoramaItemSpec.prototype.render=function(){if(!this.props.dataContext||this.props.parentGivenKey=="EmailBodyPane"&&this.props.dataContext.get_Root().get_ComponentType()==5&&this.props.dataContext.get_IsInteractionCentricEnabled())return React.DOM.noscript();return ScheduledRender.ScheduledRender({key:this.props.parentGivenKey,renderer:this.renderItem})};return PanoramaItemSpec}(TsAdapter.SpecBase);exports.PanoramaItemSpec=PanoramaItemSpec;ComponentFactory.registerComponentFactory(PinnedTileList.DESCRIPTOR_NAME,PinnedTileList.PinnedTileList);ComponentFactory.registerComponentFactory(MultilineList.DESCRIPTOR_NAME,MultilineList.MultilineList);ComponentFactory.registerComponentFactory(SelectableList.DESCRIPTOR_NAME,SelectableList.SelectableList);ComponentFactory.registerComponentFactory(Chart.DESCRIPTOR_NAME,Chart.Chart);ComponentFactory.registerComponentFactory(ChartDrilldown.DESCRIPTOR_NAME,ChartDrilldown.ChartDrilldown);ComponentFactory.registerComponentFactory(GridList.DESCRIPTOR_NAME,GridList.GridList);ComponentFactory.registerComponentFactory(GlobalFilterLookup.DESCRIPTOR_NAME,GlobalFilterLookup.GlobalFilterLookup);ComponentFactory.registerComponentFactory(FieldsPane.DESCRIPTOR_NAME,FieldsPane.FieldsPane);ComponentFactory.registerComponentFactory(HierarchyList.DESCRIPTOR_NAME,HierarchyList.HierarchyList);ComponentFactory.registerComponentFactory(SearchSummary.DESCRIPTOR_NAME,SearchSummary.SearchSummary);ComponentFactory.registerComponentFactory(UserInfo.DESCRIPTOR_NAME,UserInfo.UserInfo);ComponentFactory.registerComponentFactory(FacetPane.DESCRIPTOR_NAME,FacetPane.FacetPane);ComponentFactory.registerComponentFactory(MessageHtmlLabel.DESCRIPTOR_NAME,MessageHtmlLabel.MessageHtmlLabel);ComponentFactory.registerComponentFactory(GridContainer.DESCRIPTOR_NAME,GridContainer.GridContainer);ComponentFactory.registerComponentFactory(InteractionCentricGridList.DESCRIPTOR_NAME,InteractionCentricGridList.InteractionCentricGridList);ComponentFactory.registerComponentFactory(KbSearchControl.DESCRIPTOR_NAME,KbSearchControl.KbSearchControl);ComponentFactory.registerComponentFactory(SubjectTree.DESCRIPTOR_NAME,SubjectTree.SubjectTree);ComponentFactory.registerComponentFactory(EmailTemplatesList.DESCRIPTOR_NAME,EmailTemplatesList.EmailTemplatesList);ComponentFactory.registerComponentFactory(MailAppMultiLineList.DESCRIPTOR_NAME,MailAppMultiLineList.MailAppMultiLineList);ComponentFactory.registerComponentFactory(MailAppRelevantSearchList.DESCRIPTOR_NAME,MailAppRelevantSearchList.MailAppRelevantSearchList);exports.PanoramaItem=DataWrapperComponent.wrapComponent(new PanoramaItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStageGroup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Group","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,Group,CssClassSet){exports.DESCRIPTOR_NAME="CrmGroup";var ProcessStageGroupSpec=function(_super){__extends(ProcessStageGroupSpec,_super);function ProcessStageGroupSpec(){_super.apply(this,arguments);this.displayName="ProcessStageGroup";this.listenToProperties=["Show"]}ProcessStageGroupSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var show=this.props.dataContext.get_Show();return Group.Group({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,className:CssClassSet({crmGroup:true,hideGroup:!show}),dataId:"processpanegroup",dataViewStatus:show?"active":null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,hideChildren:!(show||this.props.dataContext.get_IsInteractionCentricEnabled())})};return ProcessStageGroupSpec}(TsAdapter.SpecBase);exports.ProcessStageGroup=DataWrapperComponent.wrapComponent(new ProcessStageGroupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStageActions",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Common/FlyOutButton"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,FlyOutButton){exports.DESCRIPTOR_NAME="StageAction";var ProcessStageActionsSpec=function(_super){__extends(ProcessStageActionsSpec,_super);function ProcessStageActionsSpec(){_super.apply(this,arguments);this.displayName="ProcessStageActions";this.listenToProperties=["StageActionCommand","ClosedLoopCommand","CompleteProcessActionCommand","Visible","CanCurrentlyNavigate","CanCurrentlyAdvance","CanCurrentlyBack","ProcessStatusChange","CanCurrentlyCloseLoop","CanNavigate","CanCloseLoop","RetrieveNavigationEntitiesSuccess","IsNavigationButtonHidden","FlyOutExpanded"]}ProcessStageActionsSpec.prototype.handleAdvanceButtonClick=function(){var viewModel=this.props.dataContext.get_Root();if(viewModel.get_InvalidViewModels().get_Items().length>0){window.alert(this.props.clientContext.getLocalizedString("Form_Component_Error"));return}var command=this.props.dataContext.get_StageActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsSpec.prototype.handleNavigationButtonClick=function(){this.props.dataContext.set_FlyOutExpanded(true)};ProcessStageActionsSpec.prototype.handleClosedLoopClick=function(){var viewModel=this.props.dataContext.get_Root();if(viewModel.get_InvalidViewModels().get_Items().length>0){window.alert(this.props.clientContext.getLocalizedString("Form_Component_Error"));return}var command=this.props.dataContext.get_ClosedLoopCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsSpec.prototype.handlePreviousButtonClick=function(){var viewModel=this.props.dataContext.get_Root();if(viewModel.get_InvalidViewModels().get_Items().length>0){window.alert(this.props.clientContext.getLocalizedString("Form_Component_Error"));return}var command=this.props.dataContext.get_StagePrevActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsSpec.prototype.handleCompleteButtonClick=function(){var viewModel=this.props.dataContext.get_Root();if(viewModel.get_InvalidViewModels().get_Items().length>0){window.alert(this.props.clientContext.getLocalizedString("Form_Component_Error"));return}var command=this.props.dataContext.get_CompleteProcessActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsSpec.prototype.getNavigationContainerDiv=function(onClickMethod){var vm=this.props.dataContext;if(this.props.clientContext.isPhone)return React.DOM.div({key:"navigationcontainer",className:"navTextContainer"+vm.get_AbortedActionClass(),onClick:onClickMethod},React.DOM.div({key:"navigationtext",className:"navButtonContent"+vm.get_AbortedActionClass()},this.props.dataContext.get_NextStageLabel()));else return React.DOM.div({key:"text",className:"stageActionText"+vm.get_AbortedActionClass()},this.props.dataContext.get_NextStageLabel())};ProcessStageActionsSpec.prototype.getCompleteContainerDiv=function(onClickMethod){var vm=this.props.dataContext;if(this.props.clientContext.isPhone)return React.DOM.div({key:"navigationcontainer",className:"navTextContainer"+vm.get_AbortedActionClass(),onClick:onClickMethod},React.DOM.div({key:"navigationtext",className:"navButtonContent"+vm.get_AbortedActionClass()},this.props.dataContext.get_CompleteProcessLabel()));else return React.DOM.div({key:"text",className:"stageActionText"+vm.get_AbortedActionClass()},this.props.dataContext.get_CompleteProcessLabel())};ProcessStageActionsSpec.prototype.getPreviousContainerDiv=function(){var vm=this.props.dataContext;return React.DOM.div({key:"previous",className:"processPreviousButton"+vm.get_AbortedActionClass()},ImageButton.ImageButton({imageName:"StagePrevious",imageType:"Symbol",className:"stageActionIcon"+vm.get_AbortedActionClass(),onClick:this.handlePreviousButtonClick,dataId:"previousstage"}))};ProcessStageActionsSpec.prototype.render=function(){var vm=this.props.dataContext;if(!vm||!vm.get_Visible()||this.props.dataContext.get_IsNavigationButtonHidden())return React.DOM.noscript();var children=[],navigationContainer,completeContainer;if(vm.get_CanCurrentlyBack()&&!vm.isBusinessProcessCompleted()){var previousButton=this.getPreviousContainerDiv();children.push(previousButton)}if(vm.get_CanCurrentlyCloseLoop()){var closedLoopButton=React.DOM.div({key:"closedLoop",className:"processClosedLoopButton"},ImageButton.ImageButton({imageName:"StageAdvance",imageType:"Symbol",className:"stageActionIcon"+vm.get_AbortedActionClass(),onClick:this.handleClosedLoopClick,dataId:"nextstage"}));navigationContainer=this.getNavigationContainerDiv(this.handleClosedLoopClick);children.push(navigationContainer,closedLoopButton)}else if(vm.get_CanCurrentlyNavigate()&&!vm.isBusinessProcessCompleted()){var navigationButton,loadingComponentDiv;if(this.props.dataContext.get_FlyOutExpanded()){if(!this.props.dataContext.get_RetrieveNavigationEntitiesSuccess())loadingComponentDiv=React.DOM.div({key:"flyoutDataLoading",className:"loadingTextContainer"},this.props.dataContext.get_RetrievingRecordsText());navigationButton=FlyOutButton.FlyOutButton({key:"stageNavigationButton",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_StageNavigationViewModel().get_NavigationViewModel(),flyOutChildrenParent:this.props.dataContext.get_StageNavigationViewModel().get_NavigationViewModel(),childViewModels:this.props.dataContext.get_StageNavigationViewModel().get_ChildNavigationViewModels(),reverseChildren:true,imageType:"Symbol",imageName:"StageAdvance",dataId:"nextstage",buttonClassName:"stageActionIcon"+vm.get_AbortedActionClass(),flyOutPositioning:FlyOutButton.FlyOutPositioning.External,className:"processNavigationButton"+vm.get_AbortedActionClass(),loadingComponent:loadingComponentDiv,flyOutContainerClassName:this.props.dataContext.get_IsScrollRequired()?"processControlFlyOutContainer":null});navigationContainer=this.getNavigationContainerDiv(this.handleNavigationButtonClick);children.push(navigationContainer,navigationButton)}else{navigationButton=React.DOM.div({key:"advance",className:"processNavigationButton"+vm.get_AbortedActionClass()},ImageButton.ImageButton({imageName:"StageAdvance",imageType:"Symbol",className:"stageActionIcon"+vm.get_AbortedActionClass(),onClick:this.handleNavigationButtonClick,dataId:"nextstage"}));navigationContainer=this.getNavigationContainerDiv(this.handleNavigationButtonClick);children.push(navigationContainer,navigationButton)}}else if(vm.get_CanCurrentlyAdvance()&&!vm.isBusinessProcessCompleted()){var advanceButton=React.DOM.div({key:"advance",className:"processAdvanceButton"+vm.get_AbortedActionClass()},ImageButton.ImageButton({imageName:"StageAdvance",imageType:"Symbol",className:"stageActionIcon"+vm.get_AbortedActionClass(),onClick:this.handleAdvanceButtonClick,dataId:"nextstage"}));navigationContainer=this.getNavigationContainerDiv(this.handleAdvanceButtonClick);children.push(navigationContainer,advanceButton)}else if(vm.canShowFinishButton()){var advanceButton=React.DOM.div({key:"complete",className:"processAdvanceButton"+vm.get_AbortedActionClass()},ImageButton.ImageButton({imageName:"StageAdvance",imageType:"Symbol",className:"stageActionIcon"+vm.get_AbortedActionClass(),onClick:this.handleCompleteButtonClick,dataId:"completeprocess"}));completeContainer=this.getCompleteContainerDiv(this.handleCompleteButtonClick);children.push(completeContainer,advanceButton)}if(vm.isBusinessProcessCompleted()){var finishedLabel=React.DOM.div({key:"finish",className:"processFinishedLabel"},this.props.dataContext.get_CompletedLabel());children.push(finishedLabel)}return React.DOM.div({className:"stageActionContainer",style:this.props.styles},children)};return ProcessStageActionsSpec}(TsAdapter.SpecBase);exports.ProcessStageActions=DataWrapperComponent.wrapComponent(new ProcessStageActionsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStepCheckmark",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){var ProcessStepCheckmarkSpec=function(_super){__extends(ProcessStepCheckmarkSpec,_super);function ProcessStepCheckmarkSpec(){_super.apply(this,arguments);this.displayName="ProcessStepCheckmark";this.listenToProperties=["Data"]}ProcessStepCheckmarkSpec.prototype.getCheckMarkStyle=function(incomplete){var styles={};if(incomplete)styles["color"]="#0070df";return styles};ProcessStepCheckmarkSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var incomplete=!this.props.dataContext.get_ProcessRequirementSatisfied(),icon=React.DOM.div({className:incomplete?"Forward-symbol":"Accept-symbol",style:this.getCheckMarkStyle(incomplete)});return React.DOM.div({className:"checkMark"},icon)};return ProcessStepCheckmarkSpec}(TsAdapter.SpecBase);exports.ProcessStepCheckmark=DataWrapperComponent.wrapComponent(new ProcessStepCheckmarkSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStageFieldsSection",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/DetailFieldsSection","Components/BusinessProcess/ProcessStepCheckmark"],function(require,exports,TsAdapter,DataWrapperComponent,DetailFieldsSection,ProcessStepCheckmark){exports.DESCRIPTOR_NAME="ProcessSection";var ProcessStageFieldsSectionSpec=function(_super){__extends(ProcessStageFieldsSectionSpec,_super);function ProcessStageFieldsSectionSpec(){_super.apply(this,arguments);this.displayName="ProcessStageFieldsSection";this.listenToProperties=["LoadComplete","StageGateCheckResult"]}ProcessStageFieldsSectionSpec.prototype.renderExtraChildren=function(editViewModel,editDescriptor){var checkMark=ProcessStepCheckmark.ProcessStepCheckmark({key:"checkMark",clientContext:this.props.clientContext,dataContext:editViewModel,descriptor:editDescriptor});return [checkMark]};ProcessStageFieldsSectionSpec.prototype.render=function(){return DetailFieldsSection.DetailFieldsSection({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,renderExtraChildren:this.renderExtraChildren})};return ProcessStageFieldsSectionSpec}(TsAdapter.SpecBase);exports.ProcessStageFieldsSection=DataWrapperComponent.wrapComponent(new ProcessStageFieldsSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStagePane",["require","exports","Components/ComponentFactory","Utils/CssClassSet","Core/Binding/CustomEventsListenerMixin","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Panorama/PanoramaItem","Components/Common/LoadingBar","Components/BusinessProcess/ProcessStageGroup","Components/BusinessProcess/ProcessStageActions","Components/BusinessProcess/ProcessStageFieldsSection","Core/ReactTypescriptAdapter"],function(require,exports,ComponentFactory,CssClassSet,CustomEventsListener,DataWrapperComponent,ImageButton,PanoramaItem,LoadingBar,ProcessStageGroup,ProcessStageActions,ProcessStageFieldsSection,TsAdapter){var ProcessStagePaneLoadingBar=LoadingBar.createLoadingBar("LoadComplete",false);exports.DESCRIPTOR_NAME="ProxyProcessControl";var ProcessStagePaneSpec=function(_super){__extends(ProcessStagePaneSpec,_super);function ProcessStagePaneSpec(){_super.apply(this,arguments);this.displayName="ProcessStagePane";this.isHandlerAdded=false;this.mixins=[CustomEventsListener.Mixin];this.listenToProperties=["ControlDescriptor","FetchedViewModel","DeletedProcess","PopoverVisibility","SelectedStage","HasMultipleBPFInstancesInOffline"]}ProcessStagePaneSpec.prototype.configureEventListeners=function(){return {OnActivateEvent:this.onActivate}};ProcessStagePaneSpec.prototype.handleKbArticleClick=function(e){var command=this.props.dataContext.get_KBArticleLauncherCommand();if(command&&command.get_CanExecute()){command.execute();e.stopPropagation();e.preventDefault()}};ProcessStagePaneSpec.prototype.onActivate=function(sender,e){var _this=this;if(this.props.clientContext.userAgent.get_IsIPhone()&&this.isMounted()){$(ReactDOM.findDOMNode(this)).prevAll(".crmSymbolFont").css("margin-top","0.1px");window.setTimeout(function(){_this.isMounted()&&$(ReactDOM.findDOMNode(_this)).prevAll(".crmSymbolFont").css("margin-top","0")},1e3)}};ProcessStagePaneSpec.prototype.dismissPopover=function(e){if(e){var paneContainer=$(e.target).closest(".processPaneContainer");if(paneContainer&&paneContainer.length>0)return;var paneHeader=$(e.target).closest(".proxyProcessHeader");if(paneHeader&&paneHeader.length>0)return}this.setReactBackHandler(false);this.props.dataContext&&this.props.dataContext.set_PopoverVisibility(false)};ProcessStagePaneSpec.prototype.dismissPopoverBridge=function(){this.dismissPopover(null)};ProcessStagePaneSpec.prototype.setReactBackHandler=function(setHandler){if(setHandler&&!this.isHandlerAdded){this.props.clientContext.reactBackHandlerHelper.addHandler(this.dismissPopoverBridge);this.isHandlerAdded=true}if(!setHandler){this.props.clientContext.reactBackHandlerHelper.removeHandler(this.dismissPopoverBridge);this.isHandlerAdded=false}};ProcessStagePaneSpec.prototype.getInitialState=function(){return {flyoutMoved:false}};ProcessStagePaneSpec.prototype.getFormHeader=function(){var domNodeObject=$(ReactDOM.findDOMNode(this));return domNodeObject.closest(".rootViewControl_content").find(".form_header")[0]};ProcessStagePaneSpec.prototype.componentDidMount=function(){if(!this.formHeaderDomNode)this.formHeaderDomNode=this.getFormHeader();if(this.props.clientContext.isPhone&&this.props.dataContext.get_PopoverVisibility()&&this.formHeaderDomNode){this.formHeaderDomNode.addEventListener("click",this.dismissPopover);this.setReactBackHandler(true)}};ProcessStagePaneSpec.prototype.componentWillUnmount=function(){if(this.props.clientContext.isPhone&&this.formHeaderDomNode){this.formHeaderDomNode.removeEventListener("click",this.dismissPopover);this.formHeaderDomNode=null;this.setReactBackHandler(false)}};ProcessStagePaneSpec.prototype.componentDidUpdate=function(){if(this.props.clientContext.isPhone)if(this.props.dataContext.get_PopoverVisibility()&&this.formHeaderDomNode){this.formHeaderDomNode.addEventListener("click",this.dismissPopover);this.setReactBackHandler(true)}else this.setReactBackHandler(false)};ProcessStagePaneSpec.prototype.render=function(){if(!this.props.dataContext||this.props.clientContext.isPhone&&!this.props.dataContext.get_PopoverVisibility()||this.props.dataContext.get_HasMultipleBPFInstancesInOffline())return React.DOM.noscript();var children=[],stageTitleChildren=[];if(this.props.dataContext.get_DeletedProcess())if(!this.props.clientContext.isPhone)children.push(React.DOM.div({key:"message",className:"processMessageBox"},React.DOM.a({onClick:this.handleKbArticleClick},this.props.dataContext.get_DeletedProcessMessageWithoutPlaceholder())));else return React.DOM.noscript();else{children.push(ProcessStagePaneLoadingBar({key:"progress",clientContext:this.props.clientContext,dataContext:this.props.dataContext}));if(!this.props.clientContext.isPhone||this.props.clientContext.isPhone&&this.props.dataContext.get_PopoverVisibility()){var childDescriptor=this.props.dataContext.get_ControlDescriptor(),childViewModel=this.props.dataContext.get_FetchedViewModel();if(childDescriptor&&childViewModel){var childFactory=ComponentFactory.getFactoryForControlName(childDescriptor.TypeName);childFactory&&children.push(childFactory({key:"child",clientContext:this.props.clientContext,dataContext:childViewModel,descriptor:childDescriptor}))}}}this.props.clientContext.isPhone&&stageTitleChildren.push(ImageButton.ImageButton({key:"closePopover",imageName:"Close",imageType:"Symbol",className:"closeProcessPopover",onClick:this.dismissPopoverBridge}));var titleChildrenStyles={};if(this.props.clientContext.theming.IsEnabled)titleChildrenStyles["color"]=this.props.clientContext.theming.get_ProcessControlColor();var panoramaItem=PanoramaItem.PanoramaItem({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,className:CssClassSet({processPaneHidden:!this.props.dataContext.get_PopoverVisibility()}),titleSuffix:React.DOM.div({className:"processPanoramaTitleSuffix",key:"suffix"},this.props.clientContext.getLocalizedString("Sales.ProcessControl.Stage")),calculateWidth:!this.props.clientContext.isPhone,titleChildren:stageTitleChildren,titleChildrenStyles:titleChildrenStyles},children),processPaneContainer=React.DOM.div({className:"processPaneContainer transformAnim"},panoramaItem);return this.props.clientContext.isPhone?processPaneContainer:panoramaItem};return ProcessStagePaneSpec}(TsAdapter.SpecBase);exports.ProcessStagePaneSpec=ProcessStagePaneSpec;ComponentFactory.registerComponentFactory(ProcessStageGroup.DESCRIPTOR_NAME,ProcessStageGroup.ProcessStageGroup);ComponentFactory.registerComponentFactory(ProcessStageFieldsSection.DESCRIPTOR_NAME,ProcessStageFieldsSection.ProcessStageFieldsSection);ComponentFactory.registerComponentFactory(ProcessStageActions.DESCRIPTOR_NAME,ProcessStageActions.ProcessStageActions);exports.ProcessStagePane=DataWrapperComponent.wrapComponent(new ProcessStagePaneSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Panorama/PanoramaPaneIndicator",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){var PanoramaPaneIndicatorSpec=function(_super){__extends(PanoramaPaneIndicatorSpec,_super);function PanoramaPaneIndicatorSpec(){_super.apply(this,arguments);this.displayName="PanoramaPaneIndicator";this.listenToProperties=["CurrentPaneIndex","VisiblePanesCount","VisibleChildrenCount"]}PanoramaPaneIndicatorSpec.prototype.render=function(){var contentChildren=[];if(this.props.dataContext.get_VisiblePanesCount()<=1)return React.DOM.noscript();for(var i=0;i<this.props.dataContext.get_VisiblePanesCount();i++)contentChildren.push(React.DOM.div({key:i.toString(),className:CssClassSet({"panoramaContainer-paneScrollIndicator-dot":true,"panoramaContainer-paneScrollIndicator-dot-selected":i===this.props.dataContext.get_CurrentPaneIndex()})}));return React.DOM.div({className:"panoramaContainer-paneScrollIndicator"},contentChildren)};return PanoramaPaneIndicatorSpec}(TsAdapter.SpecBase);exports.PanoramaPaneIndicator=DataWrapperComponent.wrapComponent(new PanoramaPaneIndicatorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Panorama/PanoramaContainer",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/WindowResizeHandlerMixin","Core/Binding/CustomEventsListenerMixin","Components/DataWrapperComponent","Components/ComponentFactory","Components/Panorama/PanoramaItem","Components/BusinessProcess/ProcessStagePane","Components/Panorama/PanoramaPaneIndicator","Components/Primitives/ScrollRegion","Core/ComponentUpdateRequestManager","Components/Primitives/ElementMountedHost","Utils/CssClassSet","Utils/PreserveScrollPositionMixin","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,WindowResizeHandler,CustomEventsListener,DataWrapperComponent,ComponentFactory,PanoramaItem,ProcessStagePane,PanoramaPaneIndicator,ScrollRegion,ComponentUpdateRequestManager,ElementMountedHost,CssClassSet,PreserveScrollPosition,IXUD){exports.DESCRIPTOR_NAME="PanoramaContainer";exports.PHONE_BOTTOM_MARGIN=40;var BOTTOM_MARGIN=75,SCROLL_DEADZONE_CUTOFF=6,PanoramaScrollPreservationStrategy=function(){function PanoramaScrollPreservationStrategy(){}PanoramaScrollPreservationStrategy.prototype.saveScroll=function(component){var panoramaContainer=component;return {top:0,left:panoramaContainer.currentScrollOffset}};PanoramaScrollPreservationStrategy.prototype.restoreScroll=function(component,savedState){var panoramaContainer=component;if(panoramaContainer.props.clientContext.userAgent.get_IsIPhone()||panoramaContainer.props.clientContext.userAgent.get_IsAndroid())panoramaContainer.scrollContainer(savedState.left,false);else{panoramaContainer.currentScrollOffset=-savedState.left;if(savedState.left!==0){var node=ReactDOM.findDOMNode(panoramaContainer);if(node){panoramaContainer.ignoreScrollHandle=true;node.scrollLeft=savedState.left;panoramaContainer.ignoreScrollHandle=false}}}};return PanoramaScrollPreservationStrategy}(),PanoramaContainerSpec=function(_super){__extends(PanoramaContainerSpec,_super);function PanoramaContainerSpec(){_super.apply(this,arguments);this.displayName="PanoramaContainer";this.mixins=[WindowResizeHandler.Mixin,PreserveScrollPosition.Mixin,CustomEventsListener.Mixin,IXUD.Mixin];this.listenToProperties=["IsScrollLocked","ReorderedPanesNames","VisiblePanesCount","VisibleChildrenCount"];this.paneScrollItemWidth=-1;this.swipeStartX=0;this.swipeStartY=0;this.pageX=0;this.pageY=0;this.swipeStartScrollOffset=0;this.currentScrollOffset=0;this.lastTouchX=0;this.lastTouchY=0;this.scrollingVertically=false;this.scrollingHorizontally=false;this.pointerActive=false;this.ignoreScrollHandle=false;this.setVisibleOnMount=false;this.isRootViewActive=false;this._isMounted=false;this.stackedStates=[]}PanoramaContainerSpec.prototype.configureEventListeners=function(){return {OnRootViewActivated:this.onRootViewActivated,OnRootViewDeactivated:this.onRootViewDeactivated,OnPaneIndexProgrammaticallyUpdated:this.onPaneIndexProgrammaticallyUpdated,OnVisibleChildrenCountChanged:this.onVisibleChildrenCountChanged}};PanoramaContainerSpec.prototype.getInitialState=function(){return {panoramaContainerWidth:null}};PanoramaContainerSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.panoramaContainer;return properties};PanoramaContainerSpec.prototype.getScrollPreservationStrategy=function(){if(Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.PaneScrollIndicatorEnabled)return new PanoramaScrollPreservationStrategy;else return new PreserveScrollPosition.DefaultScrollPreservationStrategy};PanoramaContainerSpec.prototype.calculateContentStyles=function(){var contentStyles={};if(this.transition)contentStyles[this.props.clientContext.transitionPropertyName]=this.transition;if(this.transform)contentStyles[this.props.clientContext.transformPropertyName]=this.transform;return contentStyles};PanoramaContainerSpec.prototype.isLocked=function(){return this.props&&this.props.dataContext&&this.props.dataContext.get_IsScrollLocked()};PanoramaContainerSpec.prototype.handleMouseWheel=function(e){if(this.props.clientContext.isMailApp)return;e.preventDefault();e.stopPropagation();if(this.isLocked())return;var node=ReactDOM.findDOMNode(this);node.scrollLeft-=e.nativeEvent.wheelDelta;ScrollRegion.LastScrollDirection=ScrollRegion.ScrollDirection.Horizontal;ScrollRegion.LastScrollTime=e.timeStamp};PanoramaContainerSpec.prototype.handleScroll=function(){if(this.ignoreScrollHandle)return;var node=ReactDOM.findDOMNode(this);if(node.scrollLeft!=0){var previousPaneIndex=Math.round(-this.currentScrollOffset/this.paneScrollItemWidth),newPaneIndex=Math.round(node.scrollLeft/this.paneScrollItemWidth);this.currentScrollOffset=-node.scrollLeft;this.updatePaneIndex(newPaneIndex-previousPaneIndex)}};PanoramaContainerSpec.prototype.updatePaneIndex=function(paneDelta){(Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.PaneScrollIndicatorEnabled||Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.get_DelayedPaneRenderingEnabled())&&this.props.dataContext.updatePaneIndex(paneDelta,false);paneDelta!=0&&this.props.clientContext.applicationShellViewModel.get_CommandManagerViewModel().collapse()};PanoramaContainerSpec.prototype.onTouchStart=function(e){if(this.pointerActive)return;this.pointerActive=true;if(this.isLocked())return;this.swipeStartX=e.pageX;this.swipeStartY=e.pageY;this.lastTouchX=this.swipeStartX;this.lastTouchY=this.swipeStartY;this.swipeStartScrollOffset=this.currentScrollOffset;this.scrollingVertically=false;this.scrollingHorizontally=false};PanoramaContainerSpec.prototype.onTouchMove=function(e){if(this.scrollingVertically||this.isLocked()||!this.pointerActive)return;var pageX=this.pageX=e.pageX,pageY=this.pageY=e.pageY,deltaX=pageX-this.lastTouchX,deltaY=pageY-this.swipeStartY;if(!this.scrollingVertically&&!this.scrollingHorizontally)if(Math.abs(deltaX)>SCROLL_DEADZONE_CUTOFF)this.scrollingHorizontally=true;else if(Math.abs(deltaY)>SCROLL_DEADZONE_CUTOFF)this.scrollingVertically=true;else e.preventDefault();if(this.scrollingHorizontally){if(Math.abs(deltaX)>SCROLL_DEADZONE_CUTOFF){var newOffset=this.currentScrollOffset+deltaX,diff=pageX-this.swipeStartX;if(diff<0&&this.props.dataContext.nextVisibleIndex(this.props.dataContext.get_CurrentPaneIndex())==-1||diff>0&&this.props.dataContext.previousVisibleIndex(this.props.dataContext.get_CurrentPaneIndex())==-1){var percentage=Math.abs(diff)/this.paneScrollItemWidth,fraction=Math.atan(Math.PI*percentage/2)/2,sign=diff>0?1:-1;newOffset=this.swipeStartScrollOffset+sign*(this.paneScrollItemWidth*fraction)}this.scrollContainer(newOffset,false);this.lastTouchX=pageX;this.lastTouchY=pageY}e.preventDefault()}};PanoramaContainerSpec.prototype.onTouchEnd=function(e){if(!this.pointerActive)return;this.pointerActive=false;if(!this.scrollingHorizontally||this.isLocked())return;var pageX=e.pageX==0?this.pageX:e.pageX,pageY=e.pageY==0?this.pageY:e.pageY,diffX=pageX-this.swipeStartX,swipeDiff=Math.abs(diffX),screenWidth=WindowResizeHandler.getWindowWidth(),horizontalFlick=pageX===this.lastTouchX&&pageY===this.lastTouchY;if(swipeDiff>=screenWidth/2||horizontalFlick)this.checkLimitsAndScrollContainer(diffX<0,this.swipeStartScrollOffset);else this.scrollContainer(this.swipeStartScrollOffset,true);e.preventDefault()};PanoramaContainerSpec.prototype.handleWindowResize=function(){this.paneScrollItemWidth=WindowResizeHandler.getWindowWidth();this.props.clientContext.userAgent.get_IsHTCWindowsPhone()&&this.setState({panoramaContainerWidth:this.paneScrollItemWidth});this.lastCalculatedContainerHeight=ReactDOM.findDOMNode(this).clientHeight};PanoramaContainerSpec.prototype.checkLimitsAndScrollContainer=function(swipeLeft,currentOffset){var scrollTarget=null;if(swipeLeft&&this.props.dataContext.nextVisibleIndex(this.props.dataContext.get_CurrentPaneIndex())!=-1)scrollTarget=currentOffset-this.paneScrollItemWidth;else if(!swipeLeft&&this.props.dataContext.previousVisibleIndex(this.props.dataContext.get_CurrentPaneIndex())!=-1)scrollTarget=currentOffset+this.paneScrollItemWidth;if(scrollTarget!=null){this.scrollContainer(scrollTarget,true);this.updatePaneIndex(swipeLeft?1:-1)}else this.scrollContainer(currentOffset,true)};PanoramaContainerSpec.prototype.scrollToTab=function(tabLeft,animate){if(Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.PaneScrollIndicatorEnabled&&(this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroid())){var paneIndexShift=Math.round(tabLeft/this.paneScrollItemWidth);this.scrollContainer(this.currentScrollOffset-tabLeft,animate);this.updatePaneIndex(paneIndexShift)}else{var content=$(ReactDOM.findDOMNode(this)),scrollLeftPosition=content.scrollLeft();content.scrollLeft(scrollLeftPosition+tabLeft)}};PanoramaContainerSpec.prototype.scrollContainer=function(newOffset,animate){if(this.currentScrollOffset!==newOffset){this.currentScrollOffset=newOffset;this.transition=animate?"200ms ease-out":"0s";this.transform=this.props.clientContext.getTranslateValue(newOffset,0);if(this.isMounted()){var content=$(this.refs["content"]);content.css(this.props.clientContext.transitionPropertyName,this.transition);content.css(this.props.clientContext.transformPropertyName,this.transform)}}};PanoramaContainerSpec.prototype.requestRender=function(reason){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);this.updateManager.requestUpdate(reason)};PanoramaContainerSpec.prototype.onRootViewActivated=function(){this.isRootViewActive=true;this.props.clientContext.userAgent.get_IsWinPhone()&&this.requestRender("PanoramaContainer is requesting an render via onRootViewActivated()")};PanoramaContainerSpec.prototype.onRootViewDeactivated=function(){this.isRootViewActive=false};PanoramaContainerSpec.prototype.onPaneIndexProgrammaticallyUpdated=function(){this.requestRender("PanoramaContainer is requesting an render via onPaneIndexProgrammaticallyUpdated()")};PanoramaContainerSpec.prototype.onVisibleChildrenCountChanged=function(){this.needToCalibrateActivePanePosition()&&this.requestRender("PanoramaContainer is requesting an render via onVisibleChildrenCountChanged()")};PanoramaContainerSpec.prototype.needToCalibrateActivePanePosition=function(){return this.props.dataContext.get_CurrentPaneIndex()>=0};PanoramaContainerSpec.prototype.componentDidMount=function(){this.isRootViewActive=this.props.dataContext.get_Root().get_RootViewActivated();var node=ReactDOM.findDOMNode(this);this.paneScrollItemWidth=WindowResizeHandler.getWindowWidth();this.props.clientContext.userAgent.get_IsHTCWindowsPhone()&&this.setState({panoramaContainerWidth:this.paneScrollItemWidth});this.props.dataContext.get_CurrentPaneIndex()===-1&&this.updatePaneIndex(1);if(this.setVisibleOnMount){this.setVisibleOnMount=false;$(node.parentNode.parentNode).css("visibility","visible")}this._isMounted=true};PanoramaContainerSpec.prototype.calibrateActivePanePosition=function(){var _this=this,currentPaneVisibilityIndex=this.props.dataContext.get_CurrentPaneIndex()===-1?0:this.props.dataContext.get_CurrentPaneIndex(),newOffset=currentPaneVisibilityIndex*this.paneScrollItemWidth;if(this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroid())this.scrollContainer(newOffset*-1,false);else if(this._isMounted){this.ignoreScrollHandle=true;window.setTimeout(function(){if(_this.isMounted()){_this.currentScrollOffset=-newOffset;var node=ReactDOM.findDOMNode(_this);node.scrollLeft=newOffset;_this.ignoreScrollHandle=false;$(node.parentNode.parentNode).css("visibility","visible")}},0)}else this.setVisibleOnMount=true};PanoramaContainerSpec.prototype.childDecorator=function(factory,childProps){var _this=this;if(Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.get_DelayedPaneRenderingEnabled()){var currentPaneIndex=this.props.dataContext.get_CurrentPaneIndex();if(currentPaneIndex!==-1){var itemIndexesInPane=this.props.dataContext.get_Panes().get_Items()[currentPaneIndex];childProps["showProgress"]=itemIndexesInPane.some(function(value){return value===_this.paneCounter})}else childProps["showProgress"]=false}childProps["focusScrollCallback"]=this.scrollToTab;childProps["expectedContainerHeight"]=this.lastCalculatedContainerHeight;childProps["expectedContainerWidth"]=this.props.initialParentWidth;this.paneCounter++;return factory(childProps)};PanoramaContainerSpec.prototype.reorderDescriptorChildren=function(orderedNames,descriptorChildren){for(var nameToOrder={},i=0;i<orderedNames.length;i++)nameToOrder[orderedNames[i]]=i+1;descriptorChildren.sort(function(childA,childB){var nameA=childA.props.dataContext.get_Name(),nameB=childB.props.dataContext.get_Name(),newOrderA=nameToOrder[nameA],newOrderB=nameToOrder[nameB];if(newOrderA&&newOrderB)return newOrderA-newOrderB;else if(!newOrderA)return -1;else if(!newOrderB)return 1;return 0});return descriptorChildren};PanoramaContainerSpec.prototype.stackComponents=function(descriptorChildren){for(var stackedItems=[],panes=this.props.dataContext.get_Panes(),items=this.props.dataContext.get_Items(),i=0;i<panes.get_Count();i++){var pane=panes.get_Items()[i];if(pane.length===1){var item=items.getItem(pane[0]);stackedItems.push(descriptorChildren.filter(function(component){return component.props.descriptor.BindingPath===item.get_Name()})[0])}else{var key=pane.map(function(index){return items.getItem(index).get_Name()}).reduce(function(previous,current){return previous+current},"");stackedItems.push(React.DOM.div({key:key,className:"stackedItemsContainer"},pane.map(function(index){return descriptorChildren.filter(function(component){return component.props.descriptor.BindingPath===items.getItem(index).get_Name()})[0]}).map(function(item){return React.cloneElement(item,{isStacked:true})})))}}return stackedItems};PanoramaContainerSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();this.needToCalibrateActivePanePosition()&&this.calibrateActivePanePosition();this.paneCounter=0;var activeItemContainerViewModel=Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel,contentStyles=this.calculateContentStyles(),containerChildren=[],containerStyles={},descriptorChildren=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);if(this.props.dataContext.get_ReorderedPanesNames())descriptorChildren=this.reorderDescriptorChildren(this.props.dataContext.get_ReorderedPanesNames(),descriptorChildren);else descriptorChildren=this.stackComponents(descriptorChildren);var contentChildren=[];if(this.props.containerRenderer)contentChildren.push(this.props.containerRenderer(descriptorChildren));else contentChildren=descriptorChildren;if(this.isLocked())containerStyles["overflowX"]="hidden";if(activeItemContainerViewModel.PaneScrollIndicatorEnabled){containerStyles["msScrollSnapType"]="mandatory";if(this.props.clientContext.userAgent.get_IsHTCWindowsPhone()&&this.state.panoramaContainerWidth!==null)containerStyles["width"]=this.state.panoramaContainerWidth;var panoramaPaneIndicator=PanoramaPaneIndicator.PanoramaPaneIndicator({key:"indicator",clientContext:this.props.clientContext,dataContext:this.props.dataContext}),panoramaPaneIndicatorContainerId=this.props.dataContext.get_Root().get_Id();containerChildren.push(ElementMountedHost.ElementMountedHost({key:"panoramaPaneWrapper",parentId:"panoramaPaneIndicatorContainer-"+panoramaPaneIndicatorContainerId},panoramaPaneIndicator));if(this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroid()){containerStyles["overflow"]="hidden";contentStyles["overflow"]="visible"}}var scrollHandler=null;if((activeItemContainerViewModel.get_DelayedPaneRenderingEnabled()||activeItemContainerViewModel.PaneScrollIndicatorEnabled)&&this.props.clientContext.isPhone)scrollHandler=this.handleScroll;containerChildren.unshift(React.DOM.div({key:"content",className:"panoramaContainer-content",style:contentStyles,ref:"content"},contentChildren));var props={className:CssClassSet({panoramaContainer:true,"panoramaContainer-control":this.props.clientContext.userAgent.get_IsMailApp(),webkitInertiaScroll:!(this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroid())}),style:containerStyles,onScroll:scrollHandler,onWheel:this.handleMouseWheel,reactClientContext:this.props.clientContext};if(Microsoft.Crm.Client.Core.ViewModels.ActiveItemContainerViewModel.PaneScrollIndicatorEnabled&&(this.props.clientContext.userAgent.get_IsIPhone()||this.props.clientContext.userAgent.get_IsAndroid())){props.onPointerDown=this.onTouchStart;props.onPointerMove=this.onTouchMove;props.onPointerUp=this.onTouchEnd;props.onPointerCancel=this.onTouchEnd}return React.DOM.div(props,containerChildren)};return PanoramaContainerSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(PanoramaItem.DESCRIPTOR_NAME,PanoramaItem.PanoramaItem);ComponentFactory.registerComponentFactory(ProcessStagePane.DESCRIPTOR_NAME,ProcessStagePane.ProcessStagePane);exports.PanoramaContainer=DataWrapperComponent.wrapComponent(new PanoramaContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStageActionsFlyout",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon","Utils/CssClassSet","Components/Common/Constants","Core/Binding/FocusHandlerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon,CssClassSet,Constants,FocusHandlerMixin){exports.DESCRIPTOR_NAME="ProcessStageActionsFlyout";var PADDING_MARGIN_LEFT=65,STAGE_MARGIN=5,ProcessStageActionsFlyoutSpec=function(_super){__extends(ProcessStageActionsFlyoutSpec,_super);function ProcessStageActionsFlyoutSpec(){_super.apply(this,arguments);this.displayName="ProcessStageActionsFlyout";this.listenToProperties=["StageActionCommand","StagePrevActionCommand","StageCurrentActionCommand","ClosedLoopCommand","Visible","CanCurrentlyNavigate","CanCurrentlyAdvance","CanCurrentlyBack","CanNavigate","CanCurrentlyCloseLoop","CanNavigate","CanCloseLoop","RetrieveNavigationEntitiesSuccess","IsNavigationButtonHidden","StageMovedAction"];this.mixins=[FocusHandlerMixin.Mixin]}ProcessStageActionsFlyoutSpec.prototype.setPosition=function(direction){var stageWidth=$(".processStageContainer").width()+STAGE_MARGIN,headerWidth=$(".stagesViewportDesktop").width(),selectedStageLeft=$(".selectedStage").offset().left-PADDING_MARGIN_LEFT;if(!$(".flyoutPaneClass").hasClass("flyoutPaneMoved")){if(selectedStageLeft>=0&&headerWidth-selectedStageLeft+STAGE_MARGIN>=stageWidth)this.moveflyout(selectedStageLeft);else if(selectedStageLeft<0){this.moveflyout(0);this.moveProcessHeaderBar("left",stageWidth,headerWidth,selectedStageLeft)}else if(selectedStageLeft>=headerWidth+STAGE_MARGIN-stageWidth){this.moveflyout(headerWidth-stageWidth);this.moveProcessHeaderBar("right",stageWidth,headerWidth,selectedStageLeft)}}else if(selectedStageLeft<0)this.moveProcessHeaderBar("left",stageWidth,headerWidth,selectedStageLeft);else selectedStageLeft>=headerWidth+STAGE_MARGIN-stageWidth&&this.moveProcessHeaderBar("right",stageWidth,headerWidth,selectedStageLeft)};ProcessStageActionsFlyoutSpec.prototype.moveflyout=function(offset){$(".flyoutPaneClass").css("left",offset)};ProcessStageActionsFlyoutSpec.prototype.moveProcessHeaderBar=function(direction,stageWidth,headerWidth,selectedStageLeft){var marginLeft=parseInt($(".processHeaderContainer").css("margin-left"),10);if(direction=="left")marginLeft=marginLeft+Math.abs(selectedStageLeft);else if(direction=="right")marginLeft=marginLeft-(selectedStageLeft-headerWidth+stageWidth);$(".processHeaderContainer").css("margin-left",marginLeft+"px")};ProcessStageActionsFlyoutSpec.prototype.handlePrevClick=function(){if(this.props.dataContext.get_Data()==null)return;var command=this.props.dataContext.get_StagePrevActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsFlyoutSpec.prototype.handleNextClick=function(){if(this.props.dataContext.get_Data()==null)return;var command=this.props.dataContext.get_StageActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsFlyoutSpec.prototype.handleClosedLoopClick=function(){var command=this.props.dataContext.get_ClosedLoopCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsFlyoutSpec.prototype.setStageActive=function(){var command=this.props.dataContext.get_StageCurrentActionCommand();command&&command.get_CanExecute()&&command.execute()};ProcessStageActionsFlyoutSpec.prototype.setStageKeyDown=function(e){switch(e.key){case Constants.SPACE_KEY:case Constants.ENTER_KEY:var currentElement=e.target;this.onEnterKeyDown(currentElement.id);break;case Constants.TAB_KEY:var currentElement=e.target,prevAction=currentElement.id=="flyoutPrevId"?$(".flyoutNextClass").length>0?false:true:true;if(!e.shiftKey&&prevAction){e.preventDefault();e.stopPropagation();$(".flyoutClosePaneClass").focus()}break;default:break}};ProcessStageActionsFlyoutSpec.prototype.onEnterKeyDown=function(elemId){switch(elemId){case "flyoutNextId":this.handleNextClick();break;case "flyoutPrevId":this.handlePrevClick();break;case "flyoutCurrentId":this.setStageActive();break;default:break}};ProcessStageActionsFlyoutSpec.prototype.componentDidUpdate=function(){this.shouldTakeFocus()&&this.isFooterRendered&&this.flyoutFooterFocus()};ProcessStageActionsFlyoutSpec.prototype.flyoutFooterFocus=function(){var flyoutFooter=this.refs["flyoutFooterRef"];if(flyoutFooter instanceof Element){var flyoutFooterClassElement=$(flyoutFooter).find("[tabindex]:first");flyoutFooterClassElement!=null&&flyoutFooterClassElement.length>0&&flyoutFooterClassElement.focus()}};ProcessStageActionsFlyoutSpec.prototype.getTabIndex=function(){return this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():null};ProcessStageActionsFlyoutSpec.prototype.render=function(){this.isFooterRendered=false;var vm=this.props.dataContext;if(!vm)return React.DOM.noscript();if(this.props.dataContext.get_IsStageLock())return React.DOM.div({});if(!vm.get_Visible()||this.props.dataContext.get_IsNavigationButtonHidden())var makeActive=React.DOM.div({key:"flyoutCurrentButton",onClick:this.setStageActive,onKeyDown:this.setStageKeyDown,id:"flyoutCurrentId",tabIndex:this.getTabIndex(),className:CssClassSet({flyoutCurrent:true,navigationDisabled:!this.props.dataContext.get_IsStageCompleted()})},this.props.clientContext.getLocalizedString("Process_Stage_Make_Active_Action_Text"),FontIcon.FontIcon({symbolName:"SetActiveButton",key:"icon",className:"dataIcon",ariaHidden:true}));else{if(vm.get_CanCurrentlyCloseLoop()||vm.get_CanCurrentlyAdvance())var nextButton=React.DOM.span({key:"flyoutNextButton",onClick:this.handleNextClick,id:"flyoutNextId",onKeyDown:this.setStageKeyDown,tabIndex:this.getTabIndex(),className:CssClassSet({flyoutNextClass:true,navigationDisabled:this.props.dataContext.get_Data()==null})},this.props.clientContext.getLocalizedString("Process_Stage_Next_Stage_Action_Text"),FontIcon.FontIcon({symbolName:"Forward"}));if(vm.get_CanCurrentlyBack())var prevButton=React.DOM.div({key:"flyoutPrevButton",onClick:this.handlePrevClick,id:"flyoutPrevId",onKeyDown:this.setStageKeyDown,tabIndex:this.getTabIndex(),className:CssClassSet({flyoutPrevClass:true,navigationDisabled:this.props.dataContext.get_Data()==null})},FontIcon.FontIcon({symbolName:"BackButtonWithoutBorder"}))}if(this.props.dataContext.get_StageMovedTo()=="Next"){this.setPosition("right");this.props.dataContext.set_StageMovedTo(null)}else if(this.props.dataContext.get_StageMovedTo()=="Previous"){this.setPosition("left");this.props.dataContext.set_StageMovedTo(null)}var flyoutFooter=React.DOM.div({ref:"flyoutFooterRef",className:CssClassSet({flyoutFooterClass:true,navigationDisabled:this.props.dataContext.get_Data()==null}),key:"flyoutFooterKey"},[prevButton,makeActive,nextButton]);this.isFooterRendered=true;return flyoutFooter};return ProcessStageActionsFlyoutSpec}(TsAdapter.SpecBase);exports.ProcessStageActionsFlyout=DataWrapperComponent.wrapComponent(new ProcessStageActionsFlyoutSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/FlyoutDialogItem",["require","exports","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Components/ComponentFactory","Components/Panorama/PanoramaItem","Components/Primitives/ScrollRegion","Utils/CssClassSet"],function(require,exports,DataWrapperComponent,ProgressIndicator,ComponentFactory,PanoramaItem,ScrollRegion,CssClassSet){exports.DESCRIPTOR_NAME="FlyoutDialogItem";var FLYOUTDIALOG_ITEM_MIN_WIDTH=300,FlyoutDialogItemSpec=function(_super){__extends(FlyoutDialogItemSpec,_super);function FlyoutDialogItemSpec(){_super.apply(this,arguments);this.displayName="FlyoutDialogItem";this.hasFocusChanged=false}FlyoutDialogItemSpec.prototype.calculateStyles=function(){var style={};style["width"]=FLYOUTDIALOG_ITEM_MIN_WIDTH;return style};FlyoutDialogItemSpec.prototype.iSHChildDecorator=function(factory,childProps){childProps["tabIndex"]=this.props.tabIndex;return factory(childProps)};FlyoutDialogItemSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var contentChildren=[],titleChildren=this.props.titleChildren||[];if(!this.props.dataContext.get_HideChildren()){React.Children.forEach(this.props.children,function(child){contentChildren.push(child)});if(contentChildren.length==0)contentChildren=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.props.dataContext.get_IsInteractionCentricEnabled()?this.iSHChildDecorator:null)}var flyoutDialogItemChildren=[],descriptorClassName="",isSelected=this.props.dataContext.get_IsSelected(),label=this.props.dataContext.get_Label();label&&label!="&nbsp;"&&titleChildren.push(React.DOM.div({key:"titleText",className:CssClassSet({"panoramaItem-title-text":true}),tabIndex:-1},this.props.dataContext.get_Label(),this.props.titleSuffix));titleChildren.length>0&&flyoutDialogItemChildren.push(React.DOM.div({key:"title",className:"flyoutDialogItem-title"},titleChildren));if(contentChildren.length>0){var scrollable=true;if(this.props.descriptor&&this.props.descriptor.Properties)if("CssClass" in this.props.descriptor.Properties)descriptorClassName=this.props.descriptor.Properties["CssClass"];var control=React.DOM.div({key:"control",className:"flyoutDialogItem-control"},contentChildren),component=React.DOM.div({key:"component",className:"component"},control),content=React.DOM.div({key:"content",className:CssClassSet({"flyoutDialogItem-content":true,"flyoutDialogItem-content_scrollable":scrollable,webkitInertiaScroll:scrollable})},component);flyoutDialogItemChildren.push(content);isSelected&&flyoutDialogItemChildren.push(React.DOM.div({key:"check",className:"item_Checked"}))}else this.props.showProgress&&flyoutDialogItemChildren.push(ProgressIndicator.ProgressIndicator({key:"loading",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}));var style=this.calculateStyles(),initialProps={className:CssClassSet({panoramaItem_selected:isSelected},"flyoutDialogItem",descriptorClassName,this.props.className),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex!=null?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():null,style:style};return ScrollRegion.ScrollRegion(initialProps,flyoutDialogItemChildren)};return FlyoutDialogItemSpec}(PanoramaItem.PanoramaItemSpec);exports.FlyoutDialogItem=DataWrapperComponent.wrapComponent(new FlyoutDialogItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/ProcessStagePaneFlyout",["require","exports","Components/ComponentFactory","Components/DataWrapperComponent","Components/BusinessProcess/ProcessStageActionsFlyout","Utils/CssClassSet","Components/Primitives/ProgressIndicator","Components/Primitives/FontIcon","Components/BusinessProcess/ProcessStagePane","Components/BusinessProcess/FlyoutDialogItem","Components/Common/Constants"],function(require,exports,ComponentFactory,DataWrapperComponent,ProcessStageActionsFlyout,CssClassSet,ProgressIndicator,FontIcon,ProcessStagePane,FlyoutDialogItem,Constants){exports.DESCRIPTOR_NAME="ProxyProcessControlDesktop";var ProcessStagePaneFlyoutSpec=function(_super){__extends(ProcessStagePaneFlyoutSpec,_super);function ProcessStagePaneFlyoutSpec(){_super.apply(this,arguments);this.displayName="ProcessStagePaneFlyout";this.PADDING_MARGIN_LEFT=65;this.listenToProperties=["LoadComplete","ControlDescriptor","FetchedViewModel","DeletedProcess","SelectedStage","PopoverVisibility"]}ProcessStagePaneFlyoutSpec.prototype.setFocus=function(){if(this.props.dataContext&&this.props.dataContext.get_HasFocus()){var jNode=$(ReactDOM.findDOMNode(this));jNode.focus()}var sec_vert=$(".flyoutDialogItem-control .crmGroup").not(".hideGroup").find(".fieldsSectionView").find(".section_vertical").find(".section_control");if(sec_vert!=null&&sec_vert.length>0)sec_vert[0]!=null&&$(sec_vert[0]).focus();else $(".flyoutFooterClass > div ").focus()};ProcessStagePaneFlyoutSpec.prototype.setPosition=function(){if(!this.state.flyoutMoved){var selectedStage=$(".processStageContainer.selectedStage.currentEntity");if(selectedStage.length>0){var headerStageLeft=selectedStage.offset().left-this.PADDING_MARGIN_LEFT,leftMargin=0;if(headerStageLeft>this.PADDING_MARGIN_LEFT)leftMargin=headerStageLeft}$(".flyoutPaneClass").css("left",leftMargin);$(".flyoutPaneClass").css("top","0px")}};ProcessStagePaneFlyoutSpec.prototype.componentDidUpdate=function(){if(this.props.dataContext&&this.props.dataContext.get_PopoverVisibility()){this.initializeDraggable();this.handleWindowResize();this.setPosition();this.setFocus()}};ProcessStagePaneFlyoutSpec.prototype.handleDragStart=function(e,ui){e.stopImmediatePropagation()};ProcessStagePaneFlyoutSpec.prototype.setStageMoved=function(event){var flyoutPaneElement=this.refs["flyoutPaneRef"];if(flyoutPaneElement instanceof Element){var pane=$(flyoutPaneElement);if(pane.offset().top+pane.outerHeight()>$(window).height()){var topMargin=$(window).height()-pane.outerHeight()-10;pane.offset({top:topMargin,left:pane.offset().left});event.preventDefault()}}!this.state.flyoutMoved&&this.setState({flyoutMoved:true})};ProcessStagePaneFlyoutSpec.prototype.handleWindowResize=function(){var SECTION_HEIGHT=360,MAX_HEIGHT=500,bodyHeight=$(".InteractionCentricFormBody").height();if(bodyHeight<MAX_HEIGHT){var newHeight=SECTION_HEIGHT-(MAX_HEIGHT-bodyHeight);$(".fieldsSectionView").css("max-height",newHeight)}else $(".fieldsSectionView").css("max-height",SECTION_HEIGHT)};ProcessStagePaneFlyoutSpec.prototype.initializeDraggable=function(){var pane=this.refs["flyoutPaneRef"],header=this.refs["flyoutHeaderRef"];if(pane instanceof Element&&header instanceof Element){this.draggable=$(pane).draggable({zIndex:11,start:this.handleDragStart,containment:"parent",drag:this.setStageMoved,handle:$(header)});this.props.clientContext.mapTouchEvents($(pane))}};ProcessStagePaneFlyoutSpec.prototype.handleClosePane=function(){if(this.props.dataContext){this.props.dataContext.set_PopoverVisibility(false);var selectedStage=$(".processStageContainer.selectedStage.currentEntity");selectedStage.length>0&&selectedStage.focus();this.setState({flyoutMoved:false})}};ProcessStagePaneFlyoutSpec.prototype.handleEscKey=function(e){e.key===Constants.ESCAPE_KEY&&this.handleClosePane()};ProcessStagePaneFlyoutSpec.prototype.handleKeyDown=function(e){if(e.key===Constants.TAB_KEY){e.preventDefault();e.stopPropagation();if(e.shiftKey)if($(".flyoutNextClass").css("visibility")!="hidden")$(".flyoutNextClass").focus();else $(".flyoutCurrent").css("visibility")!="hidden"&&$(".flyoutCurrent").focus();else this.setFocus()}else e.key===Constants.ENTER_KEY&&this.handleClosePane()};ProcessStagePaneFlyoutSpec.prototype.render=function(){if(!this.props.dataContext||!this.props.dataContext.get_PopoverVisibility())return React.DOM.noscript();var progress=ProgressIndicator.ProgressIndicator({key:"progress",type:ProgressIndicator.ProgressIndicatorType.Bar,active:!this.props.dataContext.get_LoadComplete()}),children=[];if(this.props.dataContext.get_DeletedProcess())return React.DOM.noscript();else{var childDescriptor=this.props.dataContext.get_ControlDescriptor(),childViewModel=this.props.dataContext.get_FetchedViewModel();if(childDescriptor&&childViewModel){var childFactory=ComponentFactory.getFactoryForControlName(childDescriptor.TypeName);childFactory&&children.push(childFactory({key:"child",clientContext:this.props.clientContext,dataContext:childViewModel,descriptor:childDescriptor,tabIndex:this.props.tabIndex}))}}var flyoutDialogItem=FlyoutDialogItem.FlyoutDialogItem({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,tabIndex:this.props.tabIndex},children),closeIcon=FontIcon.FontIcon({symbolName:"Cancel",key:"icon"}),closePane=React.DOM.div({ref:"closePane",key:"closePaneKey",tabIndex:this.props.tabIndex,className:"flyoutClosePaneClass",onKeyDown:this.handleKeyDown,onClick:this.handleClosePane},closeIcon),flagPane=React.DOM.div({key:"flagPane",className:"flyoutWindowFlagIcon",style:{display:"none"}},FontIcon.FontIcon({symbolName:"ViewNotifications",key:"icon",className:"dataIcon"})),header=React.DOM.div({className:"flyoutHeaderClass",key:"flyoutHeaderKey",ref:"flyoutHeaderRef"},[flagPane,closePane]),body=React.DOM.div({ref:"flyoutBodyRef",className:"flyoutBodyClass",key:"flyoutBodyKey"},flyoutDialogItem),flyoutPane=React.DOM.div({ref:"flyoutPaneRef",className:CssClassSet({flyoutPaneClass:true,flyoutPaneMoved:this.state.flyoutMoved}),key:"flyoutPaneKey",onKeyDown:this.handleEscKey},header,body);return flyoutPane};return ProcessStagePaneFlyoutSpec}(ProcessStagePane.ProcessStagePaneSpec);ComponentFactory.registerComponentFactory(ProcessStageActionsFlyout.DESCRIPTOR_NAME,ProcessStageActionsFlyout.ProcessStageActionsFlyout);exports.ProcessStagePaneFlyout=DataWrapperComponent.wrapComponent(new ProcessStagePaneFlyoutSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/InteractionCentricForm/InteractionCentricFormBody",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/BusinessProcess/ProcessStagePaneFlyout","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,ProcessStagePaneFlyout,Constants){exports.DESCRIPTOR_NAME="InteractionCentricFormBody";var InteractionCentricFormBodySpec=function(_super){__extends(InteractionCentricFormBodySpec,_super);function InteractionCentricFormBodySpec(){_super.apply(this,arguments);this.displayName="InteractionCentricFormBody";this.listenToProperties=["CurrentSelectedTabName"]}InteractionCentricFormBodySpec.prototype.childDecorator=function(factory,childProps){var childViewModel=childProps["dataContext"];if(this.props.dataContext.get_CurrentSelectedTabName()==childViewModel.get_Name())childProps[this.props.dataContext.get_GetIsCurrentSelectedTabPropertyName()]=true;else childProps[this.props.dataContext.get_GetIsCurrentSelectedTabPropertyName()]=false;childProps["tabIndex"]=this.props.dataContext.get_NextTabIndex()-1;return factory(childProps)};InteractionCentricFormBodySpec.prototype.handleKeyDown=function(e){switch(e.key){case Constants.F8_KEY:this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey)}};InteractionCentricFormBodySpec.prototype.render=function(){var children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);return React.DOM.div({className:"InteractionCentricFormBody",onKeyDown:this.handleKeyDown},children)};return InteractionCentricFormBodySpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(ProcessStagePaneFlyout.DESCRIPTOR_NAME,ProcessStagePaneFlyout.ProcessStagePaneFlyout);exports.InteractionCentricFormBody=DataWrapperComponent.wrapComponent(new InteractionCentricFormBodySpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/FormFooter/FormFooterNotificationBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){exports.DESCRIPTOR_NAME="FormFooterNotificationBar";var FormFooterNotificationBarSpec=function(_super){__extends(FormFooterNotificationBarSpec,_super);function FormFooterNotificationBarSpec(){_super.apply(this,arguments);this.displayName="FormFooterNotificationBar";this.listenToProperties=["NotificationChanged"]}FormFooterNotificationBarSpec.prototype.render=function(){return React.DOM.div({className:"icFormFooterNotificationBar"},this.props.dataContext.get_InteractionCentricNotification())};return FormFooterNotificationBarSpec}(TsAdapter.SpecBase);exports.FormFooterNotificationBar=DataWrapperComponent.wrapComponent(new FormFooterNotificationBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/InteractionCentric/FormFooter/InteractionCentricFormFooter",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/InteractionCentric/FormFooter/FormFooterNotificationBar","Components/Common/Constants","Core/Binding/FocusHandlerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,FormFooterNotificationBar,Constants,FocusHandlerMixin){exports.DESCRIPTOR_NAME="InteractionCentricFormFooter";var InteractionCentricFormFooterSpec=function(_super){__extends(InteractionCentricFormFooterSpec,_super);function InteractionCentricFormFooterSpec(){_super.apply(this,arguments);this.displayName="InteractionCentricFormFooter";this.listenToProperties=["SaveButtonDataReceived"];this.mixins=[FocusHandlerMixin.Mixin];this.SaveButtonTabBuffer=500}InteractionCentricFormFooterSpec.prototype.handleKeyDownForSaveButton=function(e){if(e.key==Constants.TAB_KEY&&!e.shiftKey){var siteLogo=$(".navBarSiteMapLogoText");if(siteLogo[0]!=null){siteLogo.focus();e.preventDefault()}}};InteractionCentricFormFooterSpec.prototype.childDecorator=function(factory,childProps){childProps["showWhenDisabled"]=true;childProps["isInteractionCentricFormStateLabel"]=true;childProps["title"]=this.props.clientContext.getLocalizedString("L_Save_Text");childProps["isInteractionCentricFormFooterButton"]=true;childProps["tabIndex"]=this.props.dataContext.get_NextTabIndex()+1;childProps["id"]="icFormFooterSaveIcon";childProps["onKeyDown"]=this.handleKeyDownForSaveButton;return factory(childProps)};InteractionCentricFormFooterSpec.prototype.setFocusOnFirstField=function(){if(this.props.dataContext.get_Root().get_ComponentType()==40){var gridRowContent=$(".grid_row_content");if(gridRowContent!=null&&gridRowContent.length!=0){var focusableFields=gridRowContent.not(".InteractionCentricCommunicationCardRow").find(".requiredField[tabindex]");if(focusableFields==null)focusableFields=gridRowContent.not(".InteractionCentricCommunicationCardRow").find("[tabindex]");if(focusableFields!=null&&focusableFields.length!=0)if(this.props.clientContext.userAgent.get_IsBrowserIE())setTimeout(function(){$(focusableFields[0]).focus()},1);else $(focusableFields[0]).focus()}}};InteractionCentricFormFooterSpec.prototype.componentDidMount=function(){this.shouldTakeFocus()&&this.setFocusOnFirstField()};InteractionCentricFormFooterSpec.prototype.componentWillUpdate=function(){this.setFocusOnFirstField()};InteractionCentricFormFooterSpec.prototype.render=function(){var stateValueLabel=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator),children=[],rootVM=this.props.dataContext.get_Root(),ICNotificationBar=FormFooterNotificationBar.FormFooterNotificationBar({key:"icNotificationBar",clientContext:this.props.clientContext,dataContext:rootVM.get_FormNotifications()}),saveChildViewModel=this.props.dataContext.getSaveButtonViewModel();if(saveChildViewModel!=null){for(var i=0;i<saveChildViewModel.length;i++)if(saveChildViewModel[i]&&saveChildViewModel[i].get_Parameters()["tabindex"]!=undefined)saveChildViewModel[i].get_Parameters()["tabindex"]=rootVM.get_NextTabIndex()+this.SaveButtonTabBuffer;children=ComponentFactory.createComponentsFromViewModels(saveChildViewModel,this.props.clientContext,this.childDecorator)}return React.DOM.div({key:"icformFooter",className:"icformFooter"},[children,ICNotificationBar,stateValueLabel])};return InteractionCentricFormFooterSpec}(TsAdapter.SpecBase);exports.InteractionCentricFormFooter=DataWrapperComponent.wrapComponent(new InteractionCentricFormFooterSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/RootView",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/RetrieveViewDescriptorMixin","Components/ComponentFactory","Components/Primitives/ProgressIndicator","Components/Common/TestHooksDiv","Components/Shell/FormHeader","Components/Shell/ListComponentFormHeader","Components/Panorama/PanoramaContainer","Components/InteractionCentric/InteractionCentricForm/InteractionCentricFormBody","Components/InteractionCentric/FormFooter/InteractionCentricFormFooter","Utils/Animator","Utils/CssClassSet","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,RetrieveViewDescriptor,ComponentFactory,ProgressIndicator,TestHooksDiv,FormHeader,ListComponentFormHeader,PanoramaContainer,InteractionCentricFormBody,InteractionCentricFormFooter,Animator,CssClassSet,Constants){var RootViewSpec=function(_super){__extends(RootViewSpec,_super);function RootViewSpec(){_super.apply(this,arguments);this.displayName="RootView";this.mixins=[RetrieveViewDescriptor.Mixin];this.listenToProperties=["ShowProgress","ShowProgressMessage","IsLocked"];this.listenToCollections=["CssClassNames"];this.isFirstElementFocused=false;this.isFirstTabKeyDown=true}RootViewSpec.prototype.componentDidMount=function(){this.props.clientContext.applicationShellViewModel.apcl("CurrentListNavigationDataContext",this.onListNavigationDataContextChanged)};RootViewSpec.prototype.componentWillUnmount=function(){this.props.clientContext.applicationShellViewModel.rpcl("CurrentListNavigationDataContext",this.onListNavigationDataContextChanged);this.props.dataContext.get_IsInteractionCentricEnabled()&&this.props.handleFocusOnDismiss!=null&&this.props.handleFocusOnDismiss()};RootViewSpec.prototype.componentDidUpdate=function(){var domNode=ReactDOM.findDOMNode(this);if(this.props.dataContext.get_IsInteractionCentricEnabled()&&!this.isFirstElementFocused&&domNode&&(this.props.isCrmDialog||this.props.isQuickCreateForm)){this.getFirstFocusableElement(domNode);this.getLastFocusableElement(domNode);this.isFirstElementFocused=true}};RootViewSpec.prototype.getFirstFocusableElement=function(domElement){if(domElement==null)domElement=ReactDOM.findDOMNode(this);var focusableElements;focusableElements=$(domElement).find("[tabindex]");for(var focusableElementsCount=focusableElements.length,count=0;count<focusableElementsCount;count++){var currentElementToIterate=focusableElements[count],tabIndex=currentElementToIterate.getAttribute("tabindex");if(parseInt(tabIndex)>0&&(currentElementToIterate.style.display==""||currentElementToIterate.style.display=="block")&&(currentElementToIterate.disabled==undefined||!currentElementToIterate.disabled)){var selectedDom=ReactDOM.findDOMNode(this),activeElementInDom=document.activeElement;if(this.firstFocusableElement==null||(this.firstFocusableElement!=currentElementToIterate||!selectedDom.contains(activeElementInDom))){this.firstFocusableElement=currentElementToIterate;currentElementToIterate.focus()}break}}};RootViewSpec.prototype.getLastFocusableElement=function(domElement){var focusableElements;focusableElements=$(domElement).find("[tabindex]");for(var focusableElementsCount=focusableElements.length,count=focusableElementsCount-1;count>=0;count--){var currentElementToIterate=focusableElements[count],tabIndex=currentElementToIterate.getAttribute("tabindex");if(parseInt(tabIndex)>0&&(currentElementToIterate.style.display==""||currentElementToIterate.style.display=="block")&&(currentElementToIterate.disabled==undefined||!currentElementToIterate.disabled)){this.lastFocusableElement=currentElementToIterate;break}}};RootViewSpec.prototype.onListNavigationDataContextChanged=function(){!this.props.clientContext.applicationShellViewModel.get_ListNavigationContext().get_ShouldCreateNewPage()&&this.props.clientContext.applicationShellViewModel.get_CanvasConductor().get_Top()===this.props.dataContext&&this.animateViewForListSetNavigation()};RootViewSpec.prototype.animateViewForListSetNavigation=function(){var _this=this,node=ReactDOM.findDOMNode(this),navType=this.props.clientContext.applicationShellViewModel.get_ListNavigationContext().listNavigationTypeForLastNavigation(),startAnimation=null,endAnimation=null;if(navType===1){startAnimation="slideOutTLarge";endAnimation="slideInBLarge"}else{startAnimation="slideOutBLarge";endAnimation="slideInTLarge"}if(this.props.clientContext.userAgent.get_IsAndroid()){startAnimation="none";endAnimation="none"}Animator.animate(node,startAnimation).then(function(){var viewModel=_this.props.clientContext.applicationShellViewModel.get_CurrentListNavigationDataContext();_this.props.dataContext.set_ModelContext(viewModel.get_ModelContext());_this.props.dataContext.refreshWithoutScriptReload();var node=ReactDOM.findDOMNode(_this);return Animator.animate(node,endAnimation)}).then(function(){_this.props.clientContext.applicationShellViewModel.get_ListNavigationContext().set_ListNavigationInProgress(false)})};RootViewSpec.prototype.handleCyclicTabbing=function(e){this.props.onKeyDown&&this.props.onKeyDown(e);switch(e.keyCode){case Constants.TAB_KEY_CODE:if(!e.shiftKey){if(this.isFirstTabKeyDown){this.isFirstTabKeyDown=false;this.getLastFocusableElement(ReactDOM.findDOMNode(this))}if(e.target==this.lastFocusableElement){$(this.firstFocusableElement).focus();e.preventDefault()}}else if(e.shiftKey)if(e.target==this.firstFocusableElement){$(this.lastFocusableElement).focus();e.preventDefault()}break}};RootViewSpec.prototype.calculateCssClasses=function(){for(var dataContextClassNames=[],cn=this.props.dataContext.get_CssClassNames(),i=0,len=cn.get_Count();i<len;i++)dataContextClassNames.push(cn.getItem(i));var componentTypeClass="RootView-"+this.props.dataContext.get_ComponentTypeName();return CssClassSet({form_body_locked:!this.props.clientContext.isPreview&&this.props.dataContext.get_IsLocked()},CssClassSet.apply(null,[null,"rootViewControl_content",this.props.className,componentTypeClass].concat(dataContextClassNames)))};RootViewSpec.prototype.childDecorator=function(factory,props){props["initialParentWidth"]=this.props.initialParentWidth;props["initialParentHeight"]=this.props.initialParentHeight;props["onKeyDown"]=this.handleCyclicTabbing;if(this.props.dataContext.get_IsInteractionCentricEnabled())props["tabIndex"]=this.props.tabIndex;return factory(props)};RootViewSpec.prototype.renderProgress=function(){var progress=ProgressIndicator.ProgressIndicator({key:"progress",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring,className:"rootViewControlLoadingRing"}),progressMessage=null,message=this.props.dataContext.get_ShowProgressMessage();if(message)progressMessage=React.DOM.div({key:"message",className:"ShowProgressMessage"},message);var children=[progress,progressMessage];if(this.props.loadingDecorator)children=this.props.loadingDecorator(children);var loading=React.DOM.div({key:"loading",className:CssClassSet({loadingdiv:true,"modalBackground ShowProgress":this.props.dataContext.get_ShowProgress()})},children);return loading};RootViewSpec.prototype.render=function(){var children;if(this.state.viewDescriptor){children=ComponentFactory.createChildComponents(this.props.dataContext,this.state.viewDescriptor,this.props.clientContext,this.childDecorator);this.props.dataContext.get_ShowProgress()&&children.unshift(this.renderProgress())}else children=[this.renderProgress()];if(this.props.suffixComponents&&this.props.suffixComponents.length>0)children=this.props.suffixComponents;this.props.prefixComponents&&Array.prototype.unshift.apply(children,this.props.prefixComponents);return TestHooksDiv.TestHooksDiv({clientContext:this.props.clientContext,dataContext:this.props.dataContext,className:this.calculateCssClasses()},children)};return RootViewSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(FormHeader.DESCRIPTOR_NAME,FormHeader.FormHeader);ComponentFactory.registerComponentFactory(ListComponentFormHeader.DESCRIPTOR_NAME,ListComponentFormHeader.ListComponentFormHeader);ComponentFactory.registerComponentFactory(PanoramaContainer.DESCRIPTOR_NAME,PanoramaContainer.PanoramaContainer);ComponentFactory.registerComponentFactory(InteractionCentricFormBody.DESCRIPTOR_NAME,InteractionCentricFormBody.InteractionCentricFormBody);ComponentFactory.registerComponentFactory(InteractionCentricFormFooter.DESCRIPTOR_NAME,InteractionCentricFormFooter.InteractionCentricFormFooter);exports.RootView=DataWrapperComponent.wrapComponent(new RootViewSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Common/EditRootView",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/RootView"],function(require,exports,TsAdapter,DataWrapperComponent,RootView){var EditRootViewSpec=function(_super){__extends(EditRootViewSpec,_super);function EditRootViewSpec(){_super.apply(this,arguments);this.displayName="EditRootView";this.listenToProperties=["NavigationBlockedOnSave"]}EditRootViewSpec.prototype.render=function(){var prefixChildren=this.props.prefixComponents||[];prefixChildren.push(React.DOM.span({key:"lock",className:"Lock-symbol"}));this.props.dataContext.get_NavigationBlockedOnSave()&&prefixChildren.push(React.DOM.div({key:"blockedOnSave",className:"modalBackground ShowProgress navigationBlockedOnSave"}));return RootView.RootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext,prefixComponents:prefixChildren,loadingDecorator:this.props.loadingDecorator,initialParentHeight:this.props.initialParentHeight,suffixComponents:this.props.suffixComponents})};return EditRootViewSpec}(TsAdapter.SpecBase);exports.EditRootView=DataWrapperComponent.wrapComponent(new EditRootViewSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/ExternalProtocolLinkLabel",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon","Components/Common/Label","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon,Label,CssClassSet){exports.DESCRIPTOR_NAME="ExternalProtocolLinkLabel";var ExternalProtocolLinkLabelSpec=function(_super){__extends(ExternalProtocolLinkLabelSpec,_super);function ExternalProtocolLinkLabelSpec(){_super.apply(this,arguments);this.descriptorProps={Protocol:"Protocol",LinkContainerClassName:"LinkContainerCssClass",IconSymbolName:"IconSymbolName"};this.hrefFormatString="{0}: {1}";this.displayName="ExternalProtocolLinkLabel";this.listenToProperties=["Data","Visible"]}ExternalProtocolLinkLabelSpec.prototype.getProtocol=function(){var protocol=this.getDescriptorProperty(this.descriptorProps.Protocol);switch(protocol){case 0:return "mailto";case 1:return "tel";default:return null}};ExternalProtocolLinkLabelSpec.prototype.isPropertyPresentInDescriptor=function(propName){return this.props.descriptor&&this.props.descriptor.Properties&&propName in this.props.descriptor.Properties};ExternalProtocolLinkLabelSpec.prototype.getProtocolLinkHref=function(){var protocolStr=this.getProtocol(),data=this.props.dataContext.get_Data();if(protocolStr&&data)return this.hrefFormatString.replace("{0}",protocolStr).replace("{1}",data);return null};ExternalProtocolLinkLabelSpec.prototype.getDescriptorProperty=function(propertyName){if(this.isPropertyPresentInDescriptor(propertyName))return this.props.descriptor.Properties[propertyName];return null};ExternalProtocolLinkLabelSpec.prototype.onClick=function(e){this.props.dataContext.onClick()};ExternalProtocolLinkLabelSpec.prototype.getIconComponent=function(){var symbolName=this.getDescriptorProperty(this.descriptorProps.IconSymbolName);if(symbolName)return FontIcon.FontIcon({symbolName:symbolName});return null};ExternalProtocolLinkLabelSpec.prototype.getLink=function(){var href=this.getProtocolLinkHref();if(!href)return null;var label=Label.Label({key:"label",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor}),linkProps={href:href,onClick:this.onClick};if(this.props.clientContext.userAgent.get_IsMobilePhone())linkProps.target="_top";return React.DOM.a(linkProps,label)};ExternalProtocolLinkLabelSpec.prototype.render=function(){var link=this.getLink();if(!link)return null;var icon=this.getIconComponent();return React.DOM.div({key:"externalProtocolLinkLabel",className:CssClassSet(null,"external_protocol_link_container",this.getDescriptorProperty(this.descriptorProps.LinkContainerClassName))},[icon,link])};return ExternalProtocolLinkLabelSpec}(TsAdapter.SpecBase);exports.ExternalProtocolLinkLabel=DataWrapperComponent.wrapComponent(new ExternalProtocolLinkLabelSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/SenderForm",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/EditRootView","Components/ComponentFactory","Components/MailApp/SetRegardingButton","Components/MailApp/ExternalProtocolLinkLabel"],function(require,exports,TsAdapter,DataWrapperComponent,EditRootView,ComponentFactory,SetRegardingButton,ExternalProtocolLinkLabel){var SenderFormSpec=function(_super){__extends(SenderFormSpec,_super);function SenderFormSpec(){_super.apply(this,arguments);this.displayName="SenderForm"}SenderFormSpec.prototype.loadingDecorator=function(components){for(var children=[],i=0,len=components.length;i<len;i++){var component=components[i];if(component&&component.props.key==="progress"){var progressContainer=React.DOM.div({key:"progress",className:"progressContainer"},component);children.push(progressContainer)}else children.push(component)}return children};SenderFormSpec.prototype.render=function(){return EditRootView.EditRootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext,loadingDecorator:this.loadingDecorator,initialParentHeight:this.props.initialParentHeight})};return SenderFormSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(SetRegardingButton.DESCRIPTOR_NAME,SetRegardingButton.SetRegardingButton);ComponentFactory.registerComponentFactory(ExternalProtocolLinkLabel.DESCRIPTOR_NAME,ExternalProtocolLinkLabel.ExternalProtocolLinkLabel);exports.SenderForm=DataWrapperComponent.wrapComponent(new SenderFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/EmailTemplates",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/EditRootView","Core/Binding/RetrieveViewDescriptorMixin","Components/Primitives/ProgressIndicator","Components/Primitives/HyperlinkButton","Components/Primitives/ImageButton","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,EditRootView,RetrieveViewDescriptor,ProgressIndicator,HyperlinkButton,ImageButton,CssClassSet){var EmailTemplatesSpec=function(_super){__extends(EmailTemplatesSpec,_super);function EmailTemplatesSpec(){_super.apply(this,arguments);this.displayName="EmailTemplates";this.mixins=[RetrieveViewDescriptor.Mixin];this.listenToProperties=["ErrorMessage","ShowEmailTemplateControls","ShowProgress"]}EmailTemplatesSpec.prototype.handleRetryClick=function(){this.props.dataContext.retryButtonClick()};EmailTemplatesSpec.prototype.handleViewInCRMClick=function(){this.props.dataContext.viewInCRMButtonClick()};EmailTemplatesSpec.prototype.handleAddToEmailClick=function(){this.props.dataContext.addToEmailButtonClick()};EmailTemplatesSpec.prototype.loadingDecorator=function(components){for(var children=[],i=0,len=components.length;i<len;i++){var component=components[i];if(component&&component.props.key==="progress"){var progressContainer=React.DOM.div({key:"progress",className:"progressContainer"},component);children.push(progressContainer)}else children.push(component)}return children};EmailTemplatesSpec.prototype.getErrorMessageContainer=function(){var errorMessageContainerChildren=[React.DOM.div({key:"errorMessageButtonContainer",className:"errorMessageButtonContainer"},React.DOM.span(null,this.props.dataContext.get_ErrorMessage())),ImageButton.ImageButton({key:"RetryButton",dataId:"RetryButton",className:"retryButton",labelClassName:"symbolFont Refresh-symbol iconContainer",enabled:true,label:this.props.dataContext.get_RetryText(),onClick:this.handleRetryClick})];return React.DOM.div({key:"errorMessageContainer",className:"errorMessageContainer"},errorMessageContainerChildren)};EmailTemplatesSpec.prototype.getControlsComponent=function(){if(this.props.dataContext.get_ShowProgress())return null;else{var buttonsEnabled=this.props.dataContext.get_ShowEmailTemplateControls();return React.DOM.div({key:"emailTemplatesControls",className:"actions"},HyperlinkButton.HyperlinkButton({key:"viewInCRM",dataId:"viewInCRM",enabled:buttonsEnabled,label:this.props.dataContext.get_ViewInCRMText(),onClick:this.handleViewInCRMClick}),HyperlinkButton.HyperlinkButton({key:"addToEmail",dataId:"addToEmail",enabled:buttonsEnabled,label:this.props.dataContext.get_AddToEmailText(),onClick:this.handleAddToEmailClick}))}};EmailTemplatesSpec.prototype.renderProgress=function(){var progress=ProgressIndicator.ProgressIndicator({key:"progress",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring,className:"rootViewControlLoadingRing"}),loading=React.DOM.div({key:"loading",className:"loadingdiv"},progress);return loading};EmailTemplatesSpec.prototype.render=function(){var suffixComponents=[],controls=[];this.props.dataContext.get_ErrorMessage()&&suffixComponents.push(this.getErrorMessageContainer());if(this.state!=null&&this.state.viewDescriptor){if(!this.props.dataContext.get_ErrorMessage()){var templateRegardingTitle=React.DOM.div({className:"templateRegardingTitle"},this.props.dataContext.get_TemplateRegardingLabel());controls.push(templateRegardingTitle)}var rootview=EditRootView.EditRootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext,loadingDecorator:this.loadingDecorator,initialParentHeight:this.props.initialParentHeight,suffixComponents:suffixComponents});controls.push(rootview);!this.props.dataContext.get_ErrorMessage()&&controls.push(this.getControlsComponent())}else controls.push(this.renderProgress());return React.DOM.div({key:"emailTemplatesContainer",className:CssClassSet(null,"email-templates-page",this.props.className)},controls)};return EmailTemplatesSpec}(TsAdapter.SpecBase);exports.EmailTemplates=DataWrapperComponent.wrapComponent(new EmailTemplatesSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Fields/CreateFieldsSection",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/ComponentFactory","Components/Fields/EditableSection","Components/Attachments/AttachmentsControl"],function(require,exports,TsAdapter,PureUpdate,ComponentFactory,EditableSection,AttachmentsControl){exports.DESCRIPTOR_NAME="CreateSection";var CreateFieldsSectionSpec=function(_super){__extends(CreateFieldsSectionSpec,_super);function CreateFieldsSectionSpec(){_super.apply(this,arguments);this.displayName="CreateFieldsSection";this.mixins=[PureUpdate.Mixin]}CreateFieldsSectionSpec.prototype.render=function(){return React.DOM.div({className:"createSectionView fieldsSectionView"},EditableSection.EditableSection({dataContext:this.props.dataContext,clientContext:this.props.clientContext,descriptor:this.props.descriptor,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null}))};return CreateFieldsSectionSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(AttachmentsControl.DESCRIPTOR_NAME,AttachmentsControl.AttachmentsControl);exports.CreateFieldsSection=TsAdapter.createComponent(new CreateFieldsSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/QuickCreateFormHeader",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Components/Primitives/FontIcon","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ProgressIndicator,FontIcon,CssClassSet){var QuickCreateFormHeaderSpec=function(_super){__extends(QuickCreateFormHeaderSpec,_super);function QuickCreateFormHeaderSpec(){_super.apply(this,arguments);this.displayName="QuickCreateFormHeader";this.listenToProperties=["IsSaving","ShowIcon","PrimaryModelName","Title","Label"]}QuickCreateFormHeaderSpec.prototype.render=function(){var header=[],progress=null;if(this.props.dataContext.get_IsSaving()){var progressBar=ProgressIndicator.ProgressIndicator({key:"bar",active:true,type:ProgressIndicator.ProgressIndicatorType.Bar}),savingText=React.DOM.div({key:"text",className:"savingTextContainer"},this.props.dataContext.get_SavingText());progress=React.DOM.div({key:"progress",className:"progressBarContainer"},[progressBar,savingText]);header.push(progress)}var showIcon=this.props.dataContext.get_ShowIcon();showIcon&&header.push(React.DOM.div({key:"titleIcon",className:"quickCreateForm-titleIcon"},FontIcon.FontIcon({symbolName:"entity",className:this.props.dataContext.get_PrimaryModelName()})));var title=this.props.dataContext.get_Title();title&&header.push(React.DOM.span({key:"title",className:"quickCreateForm-title"},title));header.push(React.DOM.span({key:"label",className:CssClassSet({quickCreateForm_headerLabel:true,quickCreateNotesForm_headerLabel:this.props.dataContext.get_IsNoteQuickCreateForm()})},this.props.dataContext.get_Label()));return React.DOM.div({className:"quickCreateForm_header"},header)};return QuickCreateFormHeaderSpec}(TsAdapter.SpecBase);exports.QuickCreateFormHeader=DataWrapperComponent.wrapComponent(new QuickCreateFormHeaderSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/QuickCreateButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Primitives/Button","Utils/CssClassSet","Components/Common/Constants","Core/Binding/XrmUIDescriptorMixin"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,Button,CssClassSet,Constants,IXUD){var QuickCreateButtonSpec=function(_super){__extends(QuickCreateButtonSpec,_super);function QuickCreateButtonSpec(){_super.apply(this,arguments);this.displayName="QuickCreateButton";this.mixins=[IXUD.Mixin];this.listenToProperties=["CanExecute"]}QuickCreateButtonSpec.prototype.handleClick=function(){var command=this.props.dataContext;command&&command.get_CanExecute()&&command.execute()};QuickCreateButtonSpec.prototype.handleKeyDown=function(e){this.props.onKeyDown&&this.props.onKeyDown(e);switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.handleClick();break}};QuickCreateButtonSpec.prototype.render=function(){var children=[];if(this.props.noImageRequired){var onlyButton=Button.Button({key:"button",className:"icQuickCreateForm_actionButton dynamicsButton "+this.props.className,tabIndex:this.props.tabIndex,ref:this.props.dataId||"",onKeyDown:this.handleKeyDown,onClick:this.handleClick,enabled:this.props.dataContext.get_CanExecute(),dataId:this.props.dataId,ariaLabel:this.props.clientContext.isInteractionCentric?this.props.label:null},this.props.label);children.push(onlyButton)}else{var button=React.DOM.div({key:"button",className:"quickCreateForm_actionDiv"},ImageButton.ImageButton({imageType:"Symbol",imageName:this.props.symbolName,className:"dynamicsButton quickCreateForm_Button "+this.props.className,tabIndex:this.props.tabIndex,onClick:this.handleClick,enabled:this.props.dataContext.get_CanExecute(),dataId:this.props.dataId,label:this.props.label,labelClassName:CssClassSet({quickCreateForm_buttonLabel:true,label_enabled:this.props.dataContext.get_CanExecute()}),ariaLabel:this.props.clientContext.isInteractionCentric?this.props.label:null}));children.push(button);if(!this.props.clientContext.isPhone){var hr=React.DOM.hr({key:"hr",className:"quickCreateForm_ruler"});children.push(hr)}}return React.DOM.div({className:"actionDivWrapper"},children)};QuickCreateButtonSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.quickCreateCommandButton;properties["id"]=this.props.dataId;return properties};return QuickCreateButtonSpec}(TsAdapter.SpecBase);exports.QuickCreateButton=DataWrapperComponent.wrapComponent(new QuickCreateButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/QuickCreateForm",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Common/RootView","Components/Fields/CreateFieldsSection","Components/Dialogs/QuickCreateFormHeader","Components/Dialogs/QuickCreateButton","Core/Binding/WindowResizeHandlerMixin","Components/Common/Constants","Core/Binding/FocusHandlerMixin","Utils/CssClassSet","Components/Primitives/ImageButton"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,RootView,CreateFieldsSection,QuickCreateFormHeader,QuickCreateButton,WindowResizeHandler,Constants,FocusHandlerMixin,CssClassSet,ImageButton){var QuickCreateFormSpec=function(_super){__extends(QuickCreateFormSpec,_super);function QuickCreateFormSpec(){_super.apply(this,arguments);this.displayName="QuickCreateForm";this.mixins=[WindowResizeHandler.Mixin,FocusHandlerMixin.Mixin];this.listenToProperties=["ShowIcon","Title","Label","IsSaving","AttributeMetadata","CreateAndCloseButtonText","IsSaveAndCloseButtonHidden","IsSaveAndEditButtonHidden","IsSaveAndProcessNavigationButtonHidden","CreateAndEditButtonText","IsCloseButtonHidden"]}QuickCreateFormSpec.prototype.handleOnFocus=function(e){var targetElement=e.target;targetElement.className!=null&&targetElement.className.indexOf("quickCreateForm-body")!=-1&&$(targetElement).attr("aria-hidden","true")};QuickCreateFormSpec.prototype.handleOnBlur=function(e){var targetElement=e.target;targetElement.className!=null&&targetElement.className.indexOf("quickCreateForm-body")!=-1&&$(targetElement).attr("aria-hidden","false")};QuickCreateFormSpec.prototype.handleKeyDown=function(e){switch(e.keyCode){case Constants.TAB_KEY_CODE:if(e.shiftKey&&e.target==this.refs["firstFocusable"]||!e.shiftKey&&e.target==$(".quickCreateCloseButton")[0]){$(".icQuickCreateForm_closeButton").focus();e.preventDefault()}break;case Constants.ESCAPE_KEY_CODE:var command=this.props.dataContext.get_RequestCloseCommand();command&&command.get_CanExecute()&&command.execute();break}};QuickCreateFormSpec.prototype.handleFocusOnDismiss=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()&&this.activeElementBeforeOpening){var navBarQuickCreateFormsExists=false,itemId=this.activeElementBeforeOpening.id;if(itemId){var itemIdPrefix=itemId.substring(0,itemId.lastIndexOf("_"));if(itemIdPrefix!=null&&(itemIdPrefix==="ActivityEntityListItemId"||itemIdPrefix==="RecordEntityListItemId"))navBarQuickCreateFormsExists=true}if(navBarQuickCreateFormsExists&&!$(this.activeElementBeforeOpening).is(":visible"))$(".navBarQuickCreateButton").focus();else $(this.activeElementBeforeOpening).focus()}};QuickCreateFormSpec.prototype.handlSaveClick=function(){var command=this.props.dataContext.get_CreateAndCloseCommand();command&&command.get_CanExecute()&&command.execute()};QuickCreateFormSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_RequestCloseCommand();command&&command.get_CanExecute()&&command.execute()};QuickCreateFormSpec.prototype.renderActions=function(){var actions=[],vm=this.props.dataContext,nextTabIndex=vm.get_NextTabIndex();if(!vm.get_IsSaveAndCloseButtonHidden()){var save=QuickCreateButton.QuickCreateButton({key:"save",clientContext:this.props.clientContext,dataContext:vm.get_CreateAndCloseCommand(),label:vm.get_CreateAndCloseButtonText(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,symbolName:"Save",dataId:"createandclose"});actions.push(save)}if(!vm.get_IsSaveAndProcessNavigateButtonHidden()){var navigate=QuickCreateButton.QuickCreateButton({key:"navigate",clientContext:this.props.clientContext,dataContext:vm.get_CreateAndProcessNavigateCommand(),label:vm.get_CreateAndCloseButtonText(),symbolName:"Save",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,dataId:"createandprocessnavigate"});actions.push(navigate)}if(!vm.get_IsSaveAndEditButtonHidden()){var edit=QuickCreateButton.QuickCreateButton({key:"edit",clientContext:this.props.clientContext,dataContext:vm.get_CreateAndEditPanoramaCommand(),label:vm.get_CreateAndEditButtonText(),symbolName:"SaveAndEdit",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,dataId:"createandedit"});actions.push(edit)}if(!vm.get_IsCloseButtonHidden()){var close=QuickCreateButton.QuickCreateButton({key:"close",clientContext:this.props.clientContext,dataContext:vm.get_RequestCloseCommand(),label:vm.get_CancelButtonText(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,symbolName:"Cancel",dataId:"close"});actions.push(close)}return actions};QuickCreateFormSpec.prototype.renderHeader=function(){return QuickCreateFormHeader.QuickCreateFormHeader({key:"header",clientContext:this.props.clientContext,dataContext:this.props.dataContext})};QuickCreateFormSpec.prototype.renderBody=function(){var isNoteQuickCreateForm=this.props.dataContext.get_IsNoteQuickCreateForm(),isInteractionCentricEnabled=this.props.dataContext.get_IsInteractionCentricEnabled();return React.DOM.div({key:"body",ref:"firstFocusable",className:"quickCreateForm-body",onKeyDown:isInteractionCentricEnabled?this.handleKeyDown:null,tabIndex:isInteractionCentricEnabled?this.props.dataContext.get_StartIndex():null,onFocus:isInteractionCentricEnabled?this.handleOnFocus:null,onBlur:isInteractionCentricEnabled?this.handleOnBlur:null},RootView.RootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Root(),isQuickCreateForm:true,className:CssClassSet({"quickCreateForm-rootView":true,notes_Flyout_height:isNoteQuickCreateForm,inlinePopup:isNoteQuickCreateForm,annotation:isNoteQuickCreateForm,noteTextboxWidth:isNoteQuickCreateForm}),handleFocusOnDismiss:isInteractionCentricEnabled?this.handleFocusOnDismiss:null,tabIndex:isInteractionCentricEnabled?this.props.dataContext.get_StartIndex():null}),isNoteQuickCreateForm&&!isInteractionCentricEnabled?this.renderActionForNote():null,isNoteQuickCreateForm&&!isInteractionCentricEnabled?this.renderBorderForNoteFlyout():null)};QuickCreateFormSpec.prototype.renderBorderForNoteFlyout=function(){return React.DOM.div({key:"borderForNote_Flyout",className:"borderForNote_Flyout"})};QuickCreateFormSpec.prototype.renderActionForNote=function(){var arrElements=[],isAppOffline=!this.props.clientContext.applicationShellViewModel.get_IsServerAvailable(),okButton=ImageButton.ImageButton({key:"save",className:"noteFlyoutButton NoteSave_Text",labelClassName:"SaveImage_Icon",title:this.props.dataContext.get_CreateAndCloseButtonText(),onClick:this.handlSaveClick,dataId:"createandclose"});arrElements.push(okButton);var cancelButton=ImageButton.ImageButton({key:"close",className:"noteFlyoutButton NoteCancel_Text",labelClassName:"CancelImage_Icon",title:this.props.dataContext.get_CancelButtonText(),onClick:this.handleCancelClick,dataId:"close"});arrElements.push(cancelButton);return React.DOM.div({key:"actionForNote",className:CssClassSet({actionForNote_Flyout:!isAppOffline,actionForNote_Flyout_Offline:isAppOffline})},[arrElements])};QuickCreateFormSpec.prototype.render=function(){var arrElements=[],content=React.DOM.div({key:"content",className:"quickCreateForm-popupContent"},[this.renderHeader(),this.renderBody()]);arrElements.push(content);if(!this.props.dataContext.get_IsNoteQuickCreateForm()){var actionContainer=React.DOM.div({key:"actions",className:"quickCreateForm_actionDivContainer"},this.renderActions());arrElements.push(actionContainer)}return React.DOM.div({className:"quickCreateFullForm quickCreateForm-popup"},arrElements)};return QuickCreateFormSpec}(TsAdapter.SpecBase);exports.QuickCreateFormSpec=QuickCreateFormSpec;ComponentFactory.registerComponentFactory(CreateFieldsSection.DESCRIPTOR_NAME,CreateFieldsSection.CreateFieldsSection);exports.QuickCreateForm=DataWrapperComponent.wrapComponent(new QuickCreateFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppCreateForm",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Dialogs/QuickCreateForm","Components/Primitives/ImageCheckbox"],function(require,exports,TsAdapter,DataWrapperComponent,QuickCreateForm,ImageCheckbox){var COLLAPSE_WIDTH=900,MailAppCreateFormSpec=function(_super){__extends(MailAppCreateFormSpec,_super);function MailAppCreateFormSpec(){_super.apply(this,arguments);this.displayName="MailAppCreateForm";this.listenToProperties=["IsViewInCRMChecked","IsViewInCRMHidden"]}MailAppCreateFormSpec.prototype.render=function(){var _this=this,components=[];components.push(QuickCreateForm.QuickCreateForm({dataContext:this.props.dataContext,clientContext:this.props.clientContext}));if(!this.props.dataContext.get_IsViewInCRMHidden()){var label=React.DOM.label({key:"editLabel"},this.props.clientContext.getLocalizedString("MoCA_OWA_View_In_CRM_After_Saving")),imageCheckbox=ImageCheckbox.ImageCheckbox({key:"editCheckBox",className:"imageCheckbox",checked:this.props.dataContext.get_IsViewInCRMChecked(),onClick:function(){return _this.props.dataContext.set_IsViewInCRMChecked(!_this.props.dataContext.get_IsViewInCRMChecked())}},label);components.push(React.DOM.div({key:"edit",className:"quickCreateForm_editCheckBoxContainer"},imageCheckbox))}return React.DOM.div({className:"mailAppCreateForm"},components)};return MailAppCreateFormSpec}(TsAdapter.SpecBase);exports.MailAppCreateForm=DataWrapperComponent.wrapComponent(new MailAppCreateFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/UnknownRecipientForm",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/RootView","Components/Primitives/FontIcon","Components/Primitives/ImageButton","Components/Common/FlyOutButton","Components/Primitives/ProgressIndicator","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,RootView,FontIcon,ImageButton,FlyOutButton,ProgressIndicator,CssClassSet){var UnknownRecipientFormSpec=function(_super){__extends(UnknownRecipientFormSpec,_super);function UnknownRecipientFormSpec(){_super.apply(this,arguments);this.displayName="UnknownRecipientForm";this.listenToProperties=["ShowProgressMessage","ShowContactCreateRecommendation"]}UnknownRecipientFormSpec.prototype.handleRetryClick=function(){this.props.dataContext.retryButtonClick()};UnknownRecipientFormSpec.prototype.loadingDecorator=function(components){for(var children=[],i=0,len=components.length;i<len;i++){var component=components[i];if(component&&component.props.key==="progress"){var progressContainer=React.DOM.div({key:"progress",className:"progressContainer"},component);children.push(progressContainer)}else children.push(component)}return children};UnknownRecipientFormSpec.prototype.renderProgress=function(){var progress=ProgressIndicator.ProgressIndicator({key:"progress",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring,className:"rootViewControlLoadingRing"}),progressMessage=null,message=this.props.dataContext.get_ShowProgressMessage();if(message)progressMessage=React.DOM.div({key:"message",className:"ShowProgressMessage"},message);var children=[progress,progressMessage];if(this.props.loadingDecorator)children=this.props.loadingDecorator(children);var loading=React.DOM.div({key:"loading",className:CssClassSet({loadingdiv:true,"modalBackground ShowProgress":this.props.dataContext.get_ShowProgress()})},children);return loading};UnknownRecipientFormSpec.prototype.getErrorMessageContainer=function(){var errorMessageContainerChildren=[FontIcon.FontIcon({key:"iconContainer",className:"iconContainer",symbolName:"systemuser"}),React.DOM.div({key:"errorMessage",className:"errorMessage"},React.DOM.span(null,this.props.dataContext.get_ErrorMessage())),React.DOM.div({key:"errorMessageButtonContainer",className:"errorMessageButtonContainer"},ImageButton.ImageButton({key:"RetryButtonImg",dataId:"RetryButtonImg",className:"retryButton",labelClassName:CssClassSet(null,"symbolFont","Refresh-symbol","iconContainer"),enabled:true,label:this.props.dataContext.get_RetryText(),onClick:this.handleRetryClick}))];return React.DOM.div({key:"errorMessageContainer",className:"errorMessageContainer"},errorMessageContainerChildren)};UnknownRecipientFormSpec.prototype.getRecipientSummarySectionContainer=function(){var children=[],headerText=this.props.dataContext.get_HeaderText();headerText&&children.push(React.DOM.div({key:"unknownRecipientFormHeader",className:CssClassSet(null,"unknown_recipients_header")},headerText));if(this.props.dataContext.get_ShowCreateContactRecommendation()){var createMessage=this.props.dataContext.get_CreateContactRecommendationMessage();children.push(React.DOM.div({key:"createContactRecommendation",id:"createContactRecommendation",className:"formMessage warning createContactRecommendation text-ellipsis",title:createMessage},createMessage))}var nameShouldBeDisplayed=this.props.dataContext.get_IsNameShouldBeDisplayed();if(nameShouldBeDisplayed){var displayName=this.props.dataContext.get_DisplayName();displayName&&children.push(React.DOM.div({key:"unknownRecipientDisplayName",className:CssClassSet(null,"unknown_recipient_display_name"),title:this.props.dataContext.get_DisplayNameTooltip()},displayName))}var emailAddress=this.props.dataContext.get_EmailAddress();if(emailAddress){var emailLink=React.DOM.a({target:"_top",href:"mailto:"+emailAddress,className:"unknown_recipient_email_link"},emailAddress);children.push(React.DOM.div({key:"unknownRecipientEmailAddress",className:CssClassSet(null,"unknown_recipient_email_address")},emailLink))}var creationButton=React.DOM.div({key:"createSection",className:"createSection"},FlyOutButton.FlyOutButton({key:"create",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_FlyOutViewModel(),imageType:"Symbol",imageName:"Add",label:this.props.dataContext.get_AddToCrmButtonText(),dataId:"create",stopClickPropagation:true,flyOutPositioning:FlyOutButton.FlyOutPositioning.External,flyOutContainerClassName:"addToCRMContainer"}));children.push(creationButton);return React.DOM.div({},children)};UnknownRecipientFormSpec.prototype.render=function(){if(this.props.dataContext.get_IsLoading())return this.renderProgress();else{var suffixComponents=[];if(this.props.dataContext.get_ErrorMessage())suffixComponents.push(this.getErrorMessageContainer());else this.props.dataContext.get_IsSummarySectionVisible()&&suffixComponents.push(this.getRecipientSummarySectionContainer());return RootView.RootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext,initialParentHeight:this.props.initialParentHeight,suffixComponents:suffixComponents})}};return UnknownRecipientFormSpec}(TsAdapter.SpecBase);exports.UnknownRecipientForm=DataWrapperComponent.wrapComponent(new UnknownRecipientFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/Conductor",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/WindowResizeHandlerMixin","Components/Shell/ConductorItem","Components/Common/RootView","Components/Common/EditRootView","Components/MailApp/SenderForm","Components/MailApp/EmailTemplates","Components/MailApp/MailAppCreateForm","Components/MailApp/UnknownRecipientForm"],function(require,exports,TsAdapter,DataWrapperComponent,WindowResizeHandler,ConductorItem,RootView,EditRootView,SenderForm,EmailTemplates,MailAppCreateForm,UnknownRecipientForm){var viewModelToComponentMap={"Microsoft.Crm.Client.Core.ViewModels.RootViewModel":RootView.RootView,"Microsoft.Crm.Client.Core.ViewModels.EditRootViewModel":EditRootView.EditRootView,"Microsoft.Crm.Client.Core.ViewModels.MailApp.SenderFormRootViewModel":SenderForm.SenderForm,"Microsoft.Crm.Client.Core.ViewModels.MailApp.EmailTemplatesRootViewModel":EmailTemplates.EmailTemplates,"Microsoft.Crm.Client.Core.ViewModels.MailApp.UnknownRecipientFormViewModel":UnknownRecipientForm.UnknownRecipientForm,"Microsoft.Crm.Client.Core.ViewModels.MailApp.SenderCreateFormViewModel":MailAppCreateForm.MailAppCreateForm};function resolveViewModelNameToComponentFactory(viewModelName){return viewModelToComponentMap[viewModelName]}exports.CONDUCTOR_LEFT_OFFSET=110;var REALIZED_BACK_STACK_COUNT=3,ConductorSpec=function(_super){__extends(ConductorSpec,_super);function ConductorSpec(){_super.apply(this,arguments);this.displayName="Conductor";this.mixins=[WindowResizeHandler.Mixin];this.listenToCollections=["ActiveNavigationStack"]}ConductorSpec.prototype.updateDimensions=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var effectiveWidth=window.innerWidth,effectiveHeight=window.innerHeight;(effectiveWidth<1024||effectiveHeight<768)&&window.alert(this.props.dataContext.getInteractionCentricResolutionWarning(effectiveWidth,effectiveHeight))}this.setState({renderedOnce:true,height:$(ReactDOM.findDOMNode(this)).parent().height(),width:$(ReactDOM.findDOMNode(this)).parent().width()})};ConductorSpec.prototype.handleWindowResize=function(){this.updateDimensions()};ConductorSpec.prototype.handleConductorItemReadyToUnmount=function(viewModelId){this.setState({mountedItems:this.state.mountedItems.filter(function(item){return item.id!==viewModelId})})};ConductorSpec.prototype.reconcileStack=function(){for(var activeStack=this.props.dataContext.get_ActiveNavigationStack(),count=activeStack.get_Count(),visibleId=null,realizedViewModels={},realizedBackStackCount=this.props.dataContext.get_IsInteractionCentricDashboard()?0:REALIZED_BACK_STACK_COUNT,visibleViewModel,i=0;i<realizedBackStackCount+1;i++){var index=count-(1+i);if(index>=0){var item=activeStack.getItem(index),id=item.get_ViewModelId();if(i===0){visibleId=id;visibleViewModel=item}realizedViewModels[id]=item}}var existingStack=this.state.mountedItems||[],mountedIds=existingStack.map(function(value){return value.id}),newMountedItems=existingStack.map(function(value){var newState=value.id===visibleId?0:realizedViewModels[value.id]?1:2;return {id:value.id,viewModel:value.viewModel,visibility:newState}});for(var realizedId in realizedViewModels)realizedViewModels.hasOwnProperty(realizedId)&&mountedIds.indexOf(realizedId)===-1&&newMountedItems.push({id:realizedId,viewModel:realizedViewModels[realizedId],visibility:realizedId===visibleId?0:1});this.setState({mountedItems:newMountedItems});this.props.dataContext.OnPageVisit(visibleViewModel)};ConductorSpec.prototype.getInitialState=function(){return {renderedOnce:false,height:WindowResizeHandler.getWindowHeight(),width:WindowResizeHandler.getWindowWidth()}};ConductorSpec.prototype.componentDidMount=function(){this.updateDimensions();this.reconcileStack()};ConductorSpec.prototype.componentWillReceiveProps=function(){this.reconcileStack()};ConductorSpec.prototype.render=function(){var children=[],stack=this.state.mountedItems||[],rootViewModel,rootComponentType,paneIndicatorContainers=[];if(this.state.renderedOnce)for(var i=0,count=stack.length;i<count;i++){var item=stack[i];children.push(ConductorItem.ConductorItem({key:item.id,clientContext:this.props.clientContext,dataContext:item.viewModel,mountState:item.visibility,conductorHeight:this.state.height,conductorWidth:this.state.width,activeItemId:"activeRootView",entranceAnimationName:"enterPage",resolveViewModelNameToComponentFactory:resolveViewModelNameToComponentFactory,onReadyToUnmount:this.handleConductorItemReadyToUnmount}));var paneContainerStyle={};if(item.visibility===0){rootViewModel=item.viewModel;rootComponentType=rootViewModel.get_ComponentType()}else paneContainerStyle["display"]="none";this.props.clientContext.isPhone&&paneIndicatorContainers.push(React.DOM.div({key:"panoramaPaneIndicatorContainer-"+item.id,id:"panoramaPaneIndicatorContainer-"+item.id,style:paneContainerStyle}))}var className="primaryConductor";if(rootComponentType)switch(rootComponentType){case 1:case 26:case 31:case 32:className+=" workspace_body";break;case 2:case 40:className+=" form_body";break;case 8:className+=" grid_body";break;default:break}return React.DOM.div({id:"contentContainer",className:className},React.DOM.div({"data-id":"conductorContentContainer",className:"conductorContentContainer"},children),paneIndicatorContainers)};return ConductorSpec}(TsAdapter.SpecBase);exports.Conductor=DataWrapperComponent.wrapComponent(new ConductorSpec,true)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ListNavigation",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){var ADDITIONAL_HEIGHT_FOR_HIT_TARGET=12,INDICATOR_HEIGHT=6,LIST_NAVIGATION_HEIGHT=337,IMAGE_HEIGHT=LIST_NAVIGATION_HEIGHT-ADDITIONAL_HEIGHT_FOR_HIT_TARGET*2-INDICATOR_HEIGHT,ListNavigationSpec=function(_super){__extends(ListNavigationSpec,_super);function ListNavigationSpec(){_super.apply(this,arguments);this.displayName="ListNavigation";this.listenToProperties=["ListNavigationContext","ListPosition","ListNavigationIndicatorRecordTitle","ListNavigationEnabled"]}ListNavigationSpec.prototype.getInitialState=function(){return {recordTitleVisible:false}};ListNavigationSpec.prototype.handleClick=function(event){var indicatorPosition=$(this.refs["indicator"]).offset(),position=event.pageY;if(position<=indicatorPosition.top){if(!this.props.dataContext.get_ListNavigationContext().get_AtStart()){this.props.dataContext.set_NextNavigationIndex(this.props.dataContext.get_ListNavigationContext().get_CurrentIndex()-1);this.props.dataContext.get_ListNavigationContext().set_ListNavigationInProgress(true);this.props.dataContext.get_NavigateToIndexCommand().execute()}}else if(position>indicatorPosition.top+INDICATOR_HEIGHT)if(!this.props.dataContext.get_ListNavigationContext().get_AtEnd()){this.props.dataContext.set_NextNavigationIndex(this.props.dataContext.get_ListNavigationContext().get_CurrentIndex()+1);this.props.dataContext.get_ListNavigationContext().set_ListNavigationInProgress(true);this.props.dataContext.get_NavigateToIndexCommand().execute()}};ListNavigationSpec.prototype.handleDragStart=function(e,ui){e.stopImmediatePropagation();return !this.props.dataContext.get_ListNavigationContext().get_ListNavigationInProgress()};ListNavigationSpec.prototype.handleDragStop=function(e,ui){if(!this.props.dataContext.get_ListNavigationContext().get_ListNavigationInProgress()){this.props.dataContext.get_ListNavigationContext().set_ListNavigationInProgress(true);e.stopImmediatePropagation();this.setState({recordTitleVisible:false});this.props.dataContext.get_NavigateToIndexCommand().execute()}};ListNavigationSpec.prototype.handleDrag=function(e,ui){var currentY=ui.position.top;e.stopImmediatePropagation();var listLength=this.props.dataContext.get_ListNavigationContext().get_ListLength();if(listLength===0)return false;var recordHeightAllottment=IMAGE_HEIGHT/listLength,index=Math.min(Math.max(Math.floor(currentY/recordHeightAllottment),0),listLength-1);this.props.dataContext.set_NextNavigationIndex(index);!this.state.recordTitleVisible&&this.setState({recordTitleVisible:true});return true};ListNavigationSpec.prototype.initializeDraggable=function(){var hitTarget=this.refs["hitTarget"];if(hitTarget instanceof Element&&!this.draggable){var hitTargetNode=$(hitTarget);this.draggable=hitTargetNode.draggable({axis:"y",start:this.handleDragStart,drag:this.handleDrag,stop:this.handleDragStop,revert:true,revertDuration:0,containment:"parent"});this.props.clientContext.mapTouchEvents(hitTargetNode)}};ListNavigationSpec.prototype.disposeDraggable=function(){if(this.draggable){this.draggable.draggable("destroy");this.draggable.off("touchstart");this.draggable.off("touchmove");this.draggable.off("touchend");this.draggable=null}};ListNavigationSpec.prototype.onListNavigationDataContextChanged=function(){this.props.dataContext.get_ListNavigationContext().get_ShouldCreateNewPage()&&this.props.dataContext.get_ListNavigationContext().openNewPageForCurrentIndex()};ListNavigationSpec.prototype.componentDidMount=function(){this.props.clientContext.applicationShellViewModel.apcl("CurrentListNavigationDataContext",this.onListNavigationDataContextChanged);this.initializeDraggable()};ListNavigationSpec.prototype.componentWillUnmount=function(){this.props.clientContext.applicationShellViewModel.rpcl("CurrentListNavigationDataContext",this.onListNavigationDataContextChanged);this.disposeDraggable()};ListNavigationSpec.prototype.componentWillUpdate=function(){!this.shouldDisplay()&&this.disposeDraggable()};ListNavigationSpec.prototype.componentDidUpdate=function(){this.initializeDraggable()};ListNavigationSpec.prototype.shouldDisplay=function(){return this.props.dataContext.get_ListNavigationContext()&&this.props.dataContext.get_ListNavigationEnabled()};ListNavigationSpec.prototype.render=function(){if(!this.shouldDisplay())return React.DOM.noscript();var indicatorPosition=this.props.dataContext.get_ListPosition()*IMAGE_HEIGHT,recordTitle=this.state.recordTitleVisible?React.DOM.span({className:"indicatorRecordTitle"},this.props.dataContext.get_ListNavigationIndicatorRecordTitle()):null,indicatorHitTarget=React.DOM.div({key:"hitTarget",ref:"hitTarget",className:"listNavigationIndicatorHitTarget",style:{top:indicatorPosition}},React.DOM.div({ref:"indicator",className:"listNavigationIndicator",style:{height:INDICATOR_HEIGHT}},recordTitle)),recordNavContainer=React.DOM.div({key:"navContainer",className:"recordNavContainer"}),listNavigation=React.DOM.div({key:"listNavigation",className:"listNavigation",style:{height:LIST_NAVIGATION_HEIGHT},onClick:this.handleClick},[recordNavContainer,indicatorHitTarget]),recordCount=React.DOM.span({key:"recordCount",className:"listNavigationRecordCount"},this.props.dataContext.get_ListNavigationRecordCount());return React.DOM.div({className:"listNavigationRecordNav"},[listNavigation,recordCount])};return ListNavigationSpec}(TsAdapter.SpecBase);exports.ListNavigation=DataWrapperComponent.wrapComponent(new ListNavigationSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/SiteMapButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/Primitives/Button","Components/Primitives/FontIcon","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,Button,FontIcon,CssClassSet){var SiteMapButtonSpec=function(_super){__extends(SiteMapButtonSpec,_super);function SiteMapButtonSpec(){_super.apply(this,arguments);this.displayName="SiteMapButton";this.mixins=[IXUD.Mixin];this.listenToProperties=["Visible"]}SiteMapButtonSpec.prototype.getDefaultProps=function(){return {enabled:true,stopClickPropagation:true}};SiteMapButtonSpec.prototype.getProperties=function(){var properties={};if(this.props.xrmUIControlId){properties["type"]=XrmUI.UIControlType.staticNavigationButton;properties["id"]=this.props.xrmUIControlId;if(this.props.xrmUIParentId)properties["parentId"]=this.props.xrmUIParentId}return properties};SiteMapButtonSpec.prototype.handleSitemapButtonClick=function(){if(this.props.clientContext.userAgent.get_IsIPhone()){var activeElement=document.activeElement;activeElement.blur()}if(this.props.dataContext){this.props.dataContext.set_Visible(!this.props.dataContext.get_Visible());this.isMounted&&$(".navBarAreaTileContainer").first().focus()}};SiteMapButtonSpec.prototype.attachOnClick=function(){return !this.props.clientContext.isPreview&&this.props.enabled};SiteMapButtonSpec.prototype.render=function(){return Button.Button({className:CssClassSet({opened:this.props.dataContext.get_Visible()},this.props.className),dataId:this.props.dataId,dataFlyoutOpen:this.props.dataContext.get_Visible(),enabled:this.props.enabled,onClick:this.attachOnClick()?this.handleSitemapButtonClick:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex:null,title:this.props.title,reactClientContext:this.props.clientContext,stopClickPropagation:this.props.stopClickPropagation,id:this.props.id},FontIcon.FontIcon({symbolName:this.props.symbolName}))};return SiteMapButtonSpec}(TsAdapter.SpecBase);exports.SiteMapButton=DataWrapperComponent.wrapComponent(new SiteMapButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/SiteMapItemButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/DynamicsButton"],function(require,exports,TsAdapter,DataWrapperComponent,DynamicsButton){exports.DESCRIPTOR_NAME="SiteMapItemButton";var SITEMAP_OFFLINE_ENABLED_CSS_CLASS="siteMapOfflineEnabled",SITEMAP_OFFLINE_DISABLED_CSS_CLASS="siteMapOfflineDisabled",SITEMAP_ONLINE_ONLY_CSS_CLASS="siteMapOnlineOnly",SITEMAP_DEFAULT_CSS_CLASS="siteMapDefault",SiteMapItemButtonSpec=function(_super){__extends(SiteMapItemButtonSpec,_super);function SiteMapItemButtonSpec(){_super.apply(this,arguments);this.displayName="SiteMapItemButton";this.listenToProperties=["LastRetrievedText"]}SiteMapItemButtonSpec.prototype.getEntityOfflineStatusCssClass=function(){var offlineEntityStatusClassName=null;if(!this.props.dataContext.get_IsAppOfflineSyncEnabled())offlineEntityStatusClassName=SITEMAP_DEFAULT_CSS_CLASS;else if(!this.props.dataContext.get_IsEntityInSkipList()){var offlineStatus=this.props.dataContext.get_GetEntityOfflineStatus();switch(offlineStatus){case 1:if(this.props.dataContext.get_IsOfflineDataStoreAvailable())offlineEntityStatusClassName=SITEMAP_OFFLINE_ENABLED_CSS_CLASS;else offlineEntityStatusClassName=SITEMAP_OFFLINE_DISABLED_CSS_CLASS;break;case 2:offlineEntityStatusClassName=SITEMAP_OFFLINE_DISABLED_CSS_CLASS;break;default:offlineEntityStatusClassName=SITEMAP_ONLINE_ONLY_CSS_CLASS;break}}else offlineEntityStatusClassName=SITEMAP_ONLINE_ONLY_CSS_CLASS;return offlineEntityStatusClassName};SiteMapItemButtonSpec.prototype.render=function(){var prefixComponents=[];prefixComponents.push(React.DOM.span({key:"offlineEntityStatusIcon",className:this.getEntityOfflineStatusCssClass()}));return DynamicsButton.DynamicsButton({clientContext:this.props.clientContext,prefixComponents:prefixComponents,descriptor:this.props.descriptor,dataContext:this.props.dataContext})};return SiteMapItemButtonSpec}(TsAdapter.SpecBase);exports.SiteMapItemButton=DataWrapperComponent.wrapComponent(new SiteMapItemButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/SiteMapPopup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/ComponentFactory","Components/NavigationBar/SiteMapItemButton","Components/Common/RootView","Components/Primitives/Popup","Utils/CssClassSet","Core/Binding/WindowResizeHandlerMixin","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,ComponentFactory,SiteMapItemButton,RootView,Popup,CssClassSet,WindowResizeHandler,Constants){var SiteMapPopupSpec=function(_super){__extends(SiteMapPopupSpec,_super);function SiteMapPopupSpec(){_super.apply(this,arguments);this.displayName="SiteMapPopup";this.mixins=[WindowResizeHandler.Mixin,IXUD.Mixin];this.listenToProperties=["Visible"]}SiteMapPopupSpec.prototype.calculateSiteMapContainerHeight=function(){return WindowResizeHandler.getWindowHeight()-WindowResizeHandler.getWindowWidth()*.115};SiteMapPopupSpec.prototype.useSiteMapContainer=function(){var isTaskBasedFlowGlobalMenu=this.props.dataContext.get_ComponentType()===38;return !isTaskBasedFlowGlobalMenu&&(this.props.clientContext.userAgent.get_IsWinPhone()||this.props.clientContext.isPhone&&this.props.clientContext.userAgent.get_IsBrowserIE())};SiteMapPopupSpec.prototype.useInteractionCentricMode=function(){return this.props.interactionCentricMode};SiteMapPopupSpec.prototype.getInitialState=function(){var state={};if(this.useSiteMapContainer())state.siteMapContainerHeight=this.calculateSiteMapContainerHeight();return state};SiteMapPopupSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.navigationContainer;properties["id"]=XrmUI.ControlId.navDetailFlyout;return properties};SiteMapPopupSpec.prototype.handleWindowResize=function(){this.useSiteMapContainer()&&this.setState({siteMapContainerHeight:this.calculateSiteMapContainerHeight()})};SiteMapPopupSpec.prototype.handlePopupDismiss=function(){this.props.dataContext.set_Visible(false)};SiteMapPopupSpec.prototype.handleKeyDownForDismis=function(e){if(e.keyCode==Constants.ESCAPE_KEY_CODE){this.handlePopupDismiss();$(".navBarSiteMapButton").focus()}};SiteMapPopupSpec.prototype.render=function(){var isTaskBasedFlowGlobalMenu=this.props.dataContext.get_ComponentType()===38;!isTaskBasedFlowGlobalMenu&&this.props.clientContext.applicationShellViewModel.closeTBFPopups();var sitemapPopup=null;if(this.props.dataContext.get_Visible())sitemapPopup=Popup.Popup({visible:true,className:CssClassSet({transformAnim:!this.useSiteMapContainer(),useSiteMapContainer:this.useSiteMapContainer(),siteMapPopup:!isTaskBasedFlowGlobalMenu&&!this.useInteractionCentricMode(),globalMenuPopup:isTaskBasedFlowGlobalMenu,interactionCentricSiteMapPopup:this.useInteractionCentricMode()},null),id:isTaskBasedFlowGlobalMenu?"globalMenu":"siteMapMenu",onDismiss:this.handlePopupDismiss,keepOpenOnPopupTap:true},RootView.RootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor,prefixComponents:this.props.prefixComponents,onKeyDown:this.handleKeyDownForDismis,className:CssClassSet({siteMap:!isTaskBasedFlowGlobalMenu&&!this.useInteractionCentricMode(),"globalMenu RootView-globalMenu":isTaskBasedFlowGlobalMenu,"RootView-siteMap":!isTaskBasedFlowGlobalMenu},null)}));if(this.useSiteMapContainer())return React.DOM.div({style:{height:this.state.siteMapContainerHeight},className:CssClassSet({popupHidden:!this.props.dataContext.get_Visible()},"siteMapPopupContainer transformAnim")},sitemapPopup);else return sitemapPopup};return SiteMapPopupSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(SiteMapItemButton.DESCRIPTOR_NAME,SiteMapItemButton.SiteMapItemButton);exports.SiteMapPopup=DataWrapperComponent.wrapComponent(new SiteMapPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/TaskBasedFlow/TaskBasedFlowGlobalMenu",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/NavigationBar/SiteMapButton","Components/NavigationBar/SiteMapPopup"],function(require,exports,TsAdapter,DataWrapperComponent,SiteMapButton,SiteMapPopup){exports.DESCRIPTOR_NAME="TaskBasedFlowGlobalMenu";var TaskBasedFlowGlobalMenuSpec=function(_super){__extends(TaskBasedFlowGlobalMenuSpec,_super);function TaskBasedFlowGlobalMenuSpec(){_super.apply(this,arguments);this.displayName="TaskBasedFlowGlobalMenu";this.listenToProperties=["GlobalMenuViewModel","IsServerAvailable"]}TaskBasedFlowGlobalMenuSpec.prototype.renderOffline=function(){return React.DOM.div({key:"message",className:"globalMenuMessage",style:{alignSelf:"center",color:"white",textAlign:"center",width:"100%"}},this.props.dataContext.get_OfflineText())};TaskBasedFlowGlobalMenuSpec.prototype.renderNoDefinitions=function(){return React.DOM.div({key:"message",className:"globalMenuMessage",style:{alignSelf:"center",color:"white",textAlign:"center",width:"100%"}},this.props.dataContext.get_NoDefinitionsText())};TaskBasedFlowGlobalMenuSpec.prototype.render=function(){if(!this.props.dataContext)return React.DOM.noscript();var isServerAvailable=this.props.clientContext.applicationShellViewModel.get_IsServerAvailable(),globalMenuViewModel=this.props.dataContext.get_GlobalMenuViewModel(),button=SiteMapButton.SiteMapButton({symbolName:"TaskBasedFlow",enabled:isServerAvailable,clientContext:this.props.clientContext,dataContext:globalMenuViewModel,id:"globalMenuButton"}),taskBasedFlowMenuButton=React.DOM.div({key:"globalMenuButton",className:"globalMenuButton"},button),prefixComponents=[];if(!isServerAvailable)prefixComponents.push(this.renderOffline());else globalMenuViewModel.get_VisibleChildrenCount()===0&&prefixComponents.push(this.renderNoDefinitions());var taskBasedFlowMenu=SiteMapPopup.SiteMapPopup({key:"globalMenuPopup",className:"globalMenu",dataId:"applauncher",clientContext:this.props.clientContext,prefixComponents:prefixComponents,dataContext:globalMenuViewModel}),children=[taskBasedFlowMenu,taskBasedFlowMenuButton];return React.DOM.div({className:"globalMenuBar globalMenu-Container"},children)};return TaskBasedFlowGlobalMenuSpec}(TsAdapter.SpecBase);exports.TaskBasedFlowGlobalMenu=DataWrapperComponent.wrapComponent(new TaskBasedFlowGlobalMenuSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ShellBackButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/Constants"],function(require,exports,TsAdapter,DataWrapperComponent,Constants){var ShellBackButtonSpec=function(_super){__extends(ShellBackButtonSpec,_super);function ShellBackButtonSpec(){_super.apply(this,arguments);this.displayName="ShellBackButton";this.listenToProperties=["CanGoBack","BackCommand","BackButtonToolTip"]}ShellBackButtonSpec.prototype.OnKeyDownHandler=function(e){switch(e.keyCode){case Constants.F8_KEY_CODE:if(e.shiftKey){var logoSelector=$("#headerBar .navBarSiteMapLogoText");logoSelector!=null&&logoSelector.length>0&&logoSelector.focus()}else this.props.clientContext.focusNextMajorComponent($(e.target),e.shiftKey);break}};ShellBackButtonSpec.prototype.render=function(){var _this=this;return React.DOM.button({"data-id":"back",tabIndex:this.props.clientContext.userAgent.get_TabbingSupported()?40:-1,disabled:!this.props.dataContext.get_CanGoBack(),className:"button backButton",onClick:function(){_this.props.dataContext.get_CanGoBack()&&_this.props.dataContext.get_BackCommand().execute();_this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded()&&_this.props.clientContext.applicationShellViewModel.closeNoteInlineCreateForm()},onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.OnKeyDownHandler:null,title:this.props.dataContext.get_BackButtonToolTip()},React.DOM.span({key:"backsymbol",className:"symbolFont BackButton-symbol"}),React.DOM.span({key:"backbg",className:"backButtonBackground"}))};return ShellBackButtonSpec}(TsAdapter.SpecBase);exports.ShellBackButton=DataWrapperComponent.wrapComponent(new ShellBackButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/BackButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet){var BackButtonSpec=function(_super){__extends(BackButtonSpec,_super);function BackButtonSpec(){_super.apply(this,arguments);this.displayName="BackButton";this.listenToProperties=["BackButtonEnabled"]}BackButtonSpec.prototype.handleButtonClick=function(){if(this.props.dataContext){var command=this.props.dataContext.get_BackCommand();if(command&&command.get_CanExecute()){if(this.props.dataContext.get_SiteMapViewModel().get_Visible())this.props.dataContext.get_SiteMapViewModel().set_Visible(false);else command.execute();this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded()&&this.props.clientContext.applicationShellViewModel.closeNoteInlineCreateForm()}}};BackButtonSpec.prototype.render=function(){return React.DOM.button({disabled:!this.props.dataContext.get_BackButtonEnabled(),className:CssClassSet(null,"backButton","button"),"data-id":"back",onClick:this.handleButtonClick},React.DOM.span({className:"symbolFont BackButtonWithoutBorder-symbol"}))};return BackButtonSpec}(TsAdapter.SpecBase);exports.BackButton=DataWrapperComponent.wrapComponent(new BackButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/SearchButton",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,Button,FontIcon){var SearchButtonSpec=function(_super){__extends(SearchButtonSpec,_super);function SearchButtonSpec(){_super.apply(this,arguments);this.displayName="SearchButton";this.listenToProperties=["SearchButtonEnabled"]}SearchButtonSpec.prototype.handleButtonClick=function(){if(this.props.dataContext){var command=this.props.dataContext.get_SearchCommand();if(command&&command.get_CanExecute())if(this.props.dataContext.get_SiteMapViewModel().get_Visible())this.props.dataContext.get_SiteMapViewModel().set_Visible(false);else command.execute()}};SearchButtonSpec.prototype.render=function(){if(this.props.dataContext.get_SearchButtonEnabled())return Button.Button({key:"search",className:"searchButton",dataId:"searchImage",onClick:this.handleButtonClick,reactClientContext:this.props.clientContext},FontIcon.FontIcon({symbolName:"SearchButton"}));return React.DOM.noscript()};return SearchButtonSpec}(TsAdapter.SpecBase);exports.SearchButton=DataWrapperComponent.wrapComponent(new SearchButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/UserProfile",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener){exports.DESCRIPTOR_NAME="UserProfile";var UserProfileSpec=function(_super){__extends(UserProfileSpec,_super);function UserProfileSpec(){_super.apply(this,arguments);this.displayName="UserProfile";this.listenToProperties=["DefaultImageSrc","UserName"];this.mixins=[CustomEventsListener.Mixin]}UserProfileSpec.prototype.configureEventListeners=function(){return {UserProfileImageChangedEvent:this.onUserProfileImageChanged}};UserProfileSpec.prototype.onUserProfileImageChanged=function(){this.setState({hasCustomImage:true})};UserProfileSpec.prototype.getInitialState=function(){return {hasCustomImage:true}};UserProfileSpec.prototype.imageClick=function(){var command=this.props.dataContext.get_OpenImageUploadDialogCommand();command&&command.get_CanExecute()&&command.execute()};UserProfileSpec.prototype.renderIconContainer=function(){var _this=this,userImage=React.DOM.img({key:"userProfileImage",src:this.state.hasCustomImage?this.props.dataContext.get_ImageSrc():this.props.dataContext.get_DefaultImageSrc(),onError:function(){_this.setState({hasCustomImage:false})},className:"userProfile-img",onClick:this.imageClick});return React.DOM.div({key:"userProfileIcon",className:"userProfile-icon"},userImage)};UserProfileSpec.prototype.renderTextContainer=function(){var textContainerChildren=[React.DOM.div({key:"userProfileName",className:"userProfile-name"},this.props.dataContext.get_UserName()),React.DOM.div({key:"userProfileDate",className:"userProfile-date"},this.props.dataContext.get_CurrentDate())];return React.DOM.div({key:"userProfileText",className:"userProfile-text"},textContainerChildren)};UserProfileSpec.prototype.render=function(){var userProfileChildren=[this.renderIconContainer(),this.renderTextContainer()];return React.DOM.div({key:"userProfile",className:"userProfile"},userProfileChildren)};return UserProfileSpec}(TsAdapter.SpecBase);exports.UserProfile=DataWrapperComponent.wrapComponent(new UserProfileSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Accordion/Accordion",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var AccordionSpec=function(_super){__extends(AccordionSpec,_super);function AccordionSpec(){_super.apply(this,arguments);this.displayName="Accordion";this.mixins=[PureUpdate.Mixin]}AccordionSpec.prototype.render=function(){return React.DOM.div({className:"accordion",style:this.props.style},this.props.children)};return AccordionSpec}(TsAdapter.SpecBase);exports.Accordion=TsAdapter.createComponent(new AccordionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Accordion/AccordionSection",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Utils/CssClassSet","Utils/Animator"],function(require,exports,TsAdapter,PureUpdate,Button,CssClassSet,Animator){var AccordionSectionSpec=function(_super){__extends(AccordionSectionSpec,_super);function AccordionSectionSpec(){_super.apply(this,arguments);this.displayName="AccordionSection";this.countItemsShortList=5;this.mixins=[PureUpdate.Mixin]}AccordionSectionSpec.prototype.getInitialState=function(){return {isExpanded:true}};AccordionSectionSpec.prototype.getDefaultProps=function(){return {isEnabled:true}};AccordionSectionSpec.prototype.seeMoreOnClickHandler=function(){this.props.handlerShowShortList(false)};AccordionSectionSpec.prototype.toggleExpand=function(){var _this=this,node=this.refs["accordionSectionBody"];if(this.state.isExpanded)Animator.animate(node,"accordionSectionCollapseAnim").then(function(){node.style.height="0";_this.props.handlerShowShortList&&_this.props.handlerShowShortList(true)});else{node.style.height="auto";Animator.animate(node,"accordionSectionExpandAnim")}this.setState({isExpanded:!this.state.isExpanded})};AccordionSectionSpec.prototype.renderSectionHeader=function(){var sectionHeaderChildren=[];sectionHeaderChildren.push(React.DOM.span({key:"accordionSectionHeaderTitle",className:"accordion-sectionHeader-title"},this.props.sectionHeader));if(this.props.isCounterVisible){var childCount=[].concat(this.props.children).length;childCount&&sectionHeaderChildren.push(React.DOM.span({key:"accordionSectionHeaderNumber",className:"accordion-sectionHeader-number"}," ("+childCount+")"))}return React.DOM.div({key:"accordionSectionHeader",className:CssClassSet({"accordion-sectionHeader":true,"accordion-sectionHeader-enabled":this.props.isEnabled}),onClick:this.props.isEnabled?this.toggleExpand:null},sectionHeaderChildren)};AccordionSectionSpec.prototype.renderSectionBody=function(){var sectionItems=[].concat(this.props.children),sectionBodyChildren=sectionItems.slice(0,this.countItemsShortList);if(this.props.isSeeMoreButtonVisible&&sectionItems.length>this.countItemsShortList){var buttonSeeMore=Button.Button({key:"buttonSeeMore",className:"button accordionSectionSeeMore",onClick:this.seeMoreOnClickHandler},this.props.clientContext.getLocalizedString("LabelForSeeMoreButton"));sectionBodyChildren.push(buttonSeeMore)}sectionBodyChildren.push(React.DOM.div({key:"accordionSectionHiddenItems",className:"accordionSectionHiddenItems",style:{maxHeight:this.props.isSeeMoreButtonVisible?"0":"2000px"}},sectionItems.slice(this.countItemsShortList,sectionItems.length)));if(this.props.noDataPlaceholder&&!sectionItems.length){var placeholderText=typeof this.props.noDataPlaceholder==="string"?this.props.noDataPlaceholder:this.props.clientContext.getLocalizedString("L_List_No_Records_Text");sectionBodyChildren.push(React.DOM.span({key:"accordionNoDataPlaceholder",className:"accordion-noDataPlaceholder"},placeholderText))}return React.DOM.div({key:"accordionSectionBody",ref:"accordionSectionBody",className:"accordion-sectionBody"},sectionBodyChildren)};AccordionSectionSpec.prototype.render=function(){var sectionChildren=[this.renderSectionHeader(),this.renderSectionBody()];return React.DOM.div({className:CssClassSet({"accordion-section":true,"accordion-section--expanded":this.state.isExpanded})},sectionChildren)};return AccordionSectionSpec}(TsAdapter.SpecBase);exports.AccordionSection=TsAdapter.createComponent(new AccordionSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/RecentlyViewedItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/ProgressIndicator","Components/Primitives/EntityFontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,ProgressIndicator,EntityFontIcon){exports.DESCRIPTOR_NAME="RecentlyViewedItem";var RecentlyViewedItemSpec=function(_super){__extends(RecentlyViewedItemSpec,_super);function RecentlyViewedItemSpec(){_super.apply(this,arguments);this.displayName="RecentlyViewedItem";this.listenToProperties=["PinStatus","ModelContext","IsModelInitialized","IsWaitingToCompleteNavigation","Enabled"]}RecentlyViewedItemSpec.prototype.componentDidUpdate=function(){this.props.dataContext.get_IsWaitingToCompleteNavigation()&&this.props.dataContext.get_IsModelInitialized()&&this.handleShortPress(null)};RecentlyViewedItemSpec.prototype.togglePinStatus=function(e){var landingPageModel=this.props.clientContext.applicationShellViewModel.get_landingPageViewModel();if(this.props.dataContext.get_PinStatus()===false&&!landingPageModel.get_IsFavoriteLimitReached())landingPageModel.ShowOverflowFavoritesSectionError();else{var command=this.props.dataContext.get_TogglePinStatusCommand();command&&command.get_CanExecute()&&command.execute()}e.stopPropagation();e.preventDefault()};RecentlyViewedItemSpec.prototype.handleShortPress=function(e){if(!this.props.dataContext.get_IsModelInitialized()){this.handleNotLoadedItem(e);return}var shortPressCommand=this.props.dataContext.get_ShortPressCommand();if(shortPressCommand&&shortPressCommand.get_CanExecute())shortPressCommand.execute();else this.executeNavigation(2)};RecentlyViewedItemSpec.prototype.handleNotLoadedItem=function(e){var _this=this;if(!this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()){this.props.dataContext.ShowErrorDialog("Error_Message_0x8005f213");return}this.props.dataContext.set_IsWaitingToCompleteNavigation(true);setTimeout(function(){_this.props.dataContext.set_IsWaitingToCompleteNavigation(false);!_this.props.dataContext.get_IsModelInitialized()&&_this.props.dataContext.ShowErrorDialog("LandingPage_Error_On_Record_Unavailable")},5e3)};RecentlyViewedItemSpec.prototype.executeNavigation=function(eventType){if(!this.props.dataContext||!this.props.dataContext.get_EntityViewModel())return;this.props.dataContext.get_EntityViewModel().set_SelectItemEventType(eventType);this.props.dataContext.ExecuteNavigation()};RecentlyViewedItemSpec.prototype.renderRecentTextContainer=function(){var recentlyTextContainerChildren=[React.DOM.div({key:"text1",className:"recentlyViewedItem-text recentlyViewedItem-text1"},this.props.dataContext.get_Title()),React.DOM.div({key:"text2",className:"recentlyViewedItem-text recentlyViewedItem-text2"},this.props.dataContext.get_DisplayName())];return React.DOM.div({key:"textContainer",className:"recentlyViewedItem-textContainer"},recentlyTextContainerChildren)};RecentlyViewedItemSpec.prototype.renderIconContainer=function(){var userImage,styles={};if(this.props.dataContext&&this.props.clientContext&&this.props.clientContext.theming.IsEnabled){var entityColor=this.props.clientContext.theming.getEntityColor(this.props.dataContext.get_EntityLogicalName());if(entityColor)styles["backgroundColor"]=entityColor}if(this.props.dataContext.get_ImageSrc())userImage=React.DOM.img({src:this.props.dataContext.get_ImageSrc(),className:"recentItemImage"});else userImage=EntityFontIcon.EntityFontIcon({key:"entitySymbol",entityName:"placeHolderImage",className:CssClassSet({"entity-symbol":true,crmSymbolFont:true,placeHolderImage:true},this.props.dataContext.get_EntityClassName()),cssStyles:styles});return React.DOM.div({key:"entityImage",className:"recentlyViewedItem-entityImage",style:styles},userImage)};RecentlyViewedItemSpec.prototype.render=function(){var children=[],navigationContainer=React.DOM.div({key:"navigationContainer",className:"recentlyViewedItem-navigationContainer"},this.renderIconContainer(),this.renderRecentTextContainer());children.push(navigationContainer);var pinButtonContainer=React.DOM.button({key:"buttonPin",className:CssClassSet({"recentlyViewedItem-buttonPin":true,crmSymbolFont:true,"RatingFull-symbol":this.props.dataContext.get_PinStatus(),"RatingEmpty-symbol":!this.props.dataContext.get_PinStatus(),disabled:!this.props.dataContext.get_Enabled()}),onClick:this.props.dataContext.get_Enabled()?this.togglePinStatus:null});children.push(pinButtonContainer);this.props.dataContext.get_IsWaitingToCompleteNavigation()&&this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()&&children.push(ProgressIndicator.ProgressIndicator({key:"recentItemProgressIndicator",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}));return React.DOM.div({key:"recentlyViewedItem",className:CssClassSet({recentlyViewedItem:true,"recentlyViewedItem-favorite":this.props.dataContext.get_PinStatus()},this.props.dataContext.get_EntityClassName()),onClick:this.handleShortPress},children)};return RecentlyViewedItemSpec}(TsAdapter.SpecBase);exports.RecentlyViewedItem=DataWrapperComponent.wrapComponent(new RecentlyViewedItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/RecentlyViewedItemList",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/Accordion/Accordion","Components/Accordion/AccordionSection","Components/LandingPage/RecentlyViewedItem","Core/Binding/CustomEventsListenerMixin"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,Accordion,AccordionSection,RecentlyViewedItem,CustomEventsListener){var RecentlyViewedItemListSpec=function(_super){__extends(RecentlyViewedItemListSpec,_super);function RecentlyViewedItemListSpec(){_super.apply(this,arguments);this.displayName="RecentlyViewedItemList";this.listenToProperties=["ChangeItemSet"];this.mixins=[CustomEventsListener.Mixin,UIHasRendered.Mixin]}RecentlyViewedItemListSpec.prototype.configureEventListeners=function(){return {LandingPageCollapseEvent:this.onLandingPageCollapse}};RecentlyViewedItemListSpec.prototype.getInitialState=function(){return {isShortItemsList:true}};RecentlyViewedItemListSpec.prototype.onLandingPageCollapse=function(){this.showShortItemsList(true)};RecentlyViewedItemListSpec.prototype.showShortItemsList=function(doShortList){this.setState({isShortItemsList:doShortList})};RecentlyViewedItemListSpec.prototype.getAccordionSections=function(){var favoriteSection=AccordionSection.AccordionSection({key:"accordionSection-favorite",sectionHeader:this.props.clientContext.getLocalizedString("LabelForFavorites"),isSeeMoreButtonVisible:this.state.isShortItemsList,handlerShowShortList:this.showShortItemsList,noDataPlaceholder:true,clientContext:this.props.clientContext,isCounterVisible:false},this.renderRecentlyItems(this.props.dataContext.get_FavoriteItemsSection().toArray())),recentSection=AccordionSection.AccordionSection({key:"accordionSection-recent",sectionHeader:this.props.clientContext.getLocalizedString("LabelForRecent"),noDataPlaceholder:true,clientContext:this.props.clientContext,isCounterVisible:false},this.renderRecentlyItems(this.props.dataContext.get_RecentItemsSection().toArray()));return [favoriteSection,recentSection]};RecentlyViewedItemListSpec.prototype.renderRecentlyItems=function(itemList){for(var recentlyChildren=[],i=0,length=itemList.length;i<length;i++)recentlyChildren.push(RecentlyViewedItem.RecentlyViewedItem({key:"LandingPageRecentlyItem-"+i,dataContext:itemList[i],clientContext:this.props.clientContext}));return recentlyChildren};RecentlyViewedItemListSpec.prototype.render=function(){var components=[],AccordionRecently=Accordion.Accordion({key:"accordionRecently"},this.getAccordionSections());components.push(AccordionRecently);var recentlyList=React.DOM.div({key:"recentlyViewedItemList",className:"recentlyViewedItemList"},components);return recentlyList};return RecentlyViewedItemListSpec}(TsAdapter.SpecBase);exports.RecentlyViewedItemList=DataWrapperComponent.wrapComponent(new RecentlyViewedItemListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/QuickCommandsBarSection",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Common/FlyOutButton"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,FlyOutButton){var QuickCommandsBarSectionSpec=function(_super){__extends(QuickCommandsBarSectionSpec,_super);function QuickCommandsBarSectionSpec(){_super.apply(this,arguments);this.displayName="QuickCommandsBarSection";this.listenToProperties=["VisibleChildrenCount"]}QuickCommandsBarSectionSpec.prototype.childDecorator=function(factory,props){if(factory===FlyOutButton.FlyOutButton){props.isQuickCommandsBarFlyOut=true;props.stopClickPropagation=true}return factory(props)};QuickCommandsBarSectionSpec.prototype.render=function(){var activeChildViewModels=this.props.dataContext.findActiveChildViewModels(),children=ComponentFactory.createComponentsFromViewModels(activeChildViewModels,this.props.clientContext,this.childDecorator);return React.DOM.div({className:"quickCommandBarSection"},children)};return QuickCommandsBarSectionSpec}(TsAdapter.SpecBase);exports.QuickCommandsBarSection=DataWrapperComponent.wrapComponent(new QuickCommandsBarSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/QuickCommandsBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/LandingPage/QuickCommandsBarSection","Components/Primitives/ProgressIndicator"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,QuickCommandsBarSection,ProgressIndicator){var QuickCommandsBarSpec=function(_super){__extends(QuickCommandsBarSpec,_super);function QuickCommandsBarSpec(){_super.apply(this,arguments);this.displayName="QuickCommandsBar";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["IsLoading"];this.listenToCollections=["CommandSections"]}QuickCommandsBarSpec.prototype.handleGlobalClick=function(e){var target=e.target;this.handleGlobalClickOnElement(target)};QuickCommandsBarSpec.prototype.handleGlobalClickOnElement=function(e){if(!e||!e.tagName||e.tagName==="body"){this.props.dataContext.get_CommandSection().CloseAllFlyOuts();return}if(e.classList.contains("quickCommandsBar"))return;this.handleGlobalClickOnElement(e.parentElement)};QuickCommandsBarSpec.prototype.componentDidMount=function(){document.addEventListener("mousedown",this.handleGlobalClick);document.addEventListener("touchstart",this.handleGlobalClick);this.props.clientContext.userAgent.get_IsIPad()&&ReactDOM.findDOMNode(this).setAttribute("touch-action","none")};QuickCommandsBarSpec.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleGlobalClick);document.removeEventListener("touchstart",this.handleGlobalClick)};QuickCommandsBarSpec.prototype.renderProgressBar=function(){return ProgressIndicator.ProgressIndicator({key:"progressBar",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true})};QuickCommandsBarSpec.prototype.render=function(){if(this.props.dataContext.get_IsLoading())return React.DOM.div({className:"quickCommandsBar"},React.DOM.div({className:"quickCommandsBar-content",id:"quickCommandsBar-content"},[this.renderProgressBar()]));var commandBarSection=QuickCommandsBarSection.QuickCommandsBarSection({key:"record",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_CommandSection()}),quickCommandsBarChildren=[commandBarSection];return React.DOM.div({id:"quickCommandsBar",className:"quickCommandsBar"},quickCommandsBarChildren)};return QuickCommandsBarSpec}(TsAdapter.SpecBase);exports.QuickCommandsBar=DataWrapperComponent.wrapComponent(new QuickCommandsBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPageActivityItem",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){exports.DESCRIPTOR_NAME="LandingPageActivityItem";var LandingPageActivityItemSpec=function(_super){__extends(LandingPageActivityItemSpec,_super);function LandingPageActivityItemSpec(){_super.apply(this,arguments);this.displayName="LandingPageActivityItem";this.mixins=[PureUpdate.Mixin]}LandingPageActivityItemSpec.prototype.render=function(){var children=[React.DOM.div({key:"activityTitle",className:"landingPageActivity-text landingPageActivity-title"},this.props.activitySubject),React.DOM.div({key:"activityDueDateTime",className:"landingPageActivity-text landingPageActivity-common"},this.props.activityScheduledEndString),React.DOM.div({key:"activityRegardingField",className:"landingPageActivity-text landingPageActivity-common"},this.props.activityRegardingObjectName)];return React.DOM.div({className:"landingPageActivity"},children)};return LandingPageActivityItemSpec}(TsAdapter.SpecBase);exports.LandingPageActivityItem=TsAdapter.createComponent(new LandingPageActivityItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPageActivities",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/UIHasRenderedMixin","Components/Primitives/ProgressIndicator","Components/Accordion/Accordion","Components/Accordion/AccordionSection","Components/LandingPage/LandingPageActivityItem","Components/CustomControls/CustomControlHostView"],function(require,exports,TsAdapter,DataWrapperComponent,UIHasRendered,ProgressIndicator,Accordion,AccordionSection,LandingPageActivityItem,CustomControlHostView){var LandingPageActivitiesSpec=function(_super){__extends(LandingPageActivitiesSpec,_super);function LandingPageActivitiesSpec(){_super.apply(this,arguments);this.displayName="LandingPageActivities";this.mixins=[UIHasRendered.Mixin];this.listenToProperties=["IsLoading"]}LandingPageActivitiesSpec.prototype.getAccordionSections=function(){if(this.props.dataContext.get_IsLandingPageActivitiesEnabled()){var todayActivitySection=AccordionSection.AccordionSection({key:"accordionSection-TodayActivity",sectionHeader:this.props.clientContext.getLocalizedString("LabelForToday"),clientContext:this.props.clientContext,isEnabled:this.props.clientContext.isPhone},this.renderActivitiesItems(this.props.dataContext.get_TodayActivities().toArray())),thisWeekActivitySection=AccordionSection.AccordionSection({key:"accordionSection-ThisWeekActivity",sectionHeader:this.props.clientContext.getLocalizedString("LabelForThisWeek"),clientContext:this.props.clientContext,isEnabled:this.props.clientContext.isPhone},this.renderActivitiesItems(this.props.dataContext.get_ThisWeekActivities().toArray())),overDueActivitySection=AccordionSection.AccordionSection({key:"accordionSection-OverDueActivity",sectionHeader:this.props.clientContext.getLocalizedString("LabelForOverdue"),clientContext:this.props.clientContext,isEnabled:this.props.clientContext.isPhone},this.renderActivitiesItems(this.props.dataContext.get_OverDueActivities().toArray()));return [todayActivitySection,thisWeekActivitySection,overDueActivitySection]}else{var todayActivitySection=AccordionSection.AccordionSection({key:"accordionSection-TodayActivity",sectionHeader:this.props.clientContext.getLocalizedString("LabelForToday"),clientContext:this.props.clientContext,isEnabled:this.props.clientContext.isPhone},this.renderCardFeedContainer());return [todayActivitySection]}};LandingPageActivitiesSpec.prototype.renderCardFeedContainer=function(){return CustomControlHostView.CustomControlHostView({key:"CCTempHost",dataContext:this.props.dataContext.get_CardFeedContainerViewModel(),clientContext:this.props.clientContext})};LandingPageActivitiesSpec.prototype.renderActivitiesItems=function(itemList){for(var activitiesChildren=[],i=0,length=itemList.length;i<length;i++)activitiesChildren.push(LandingPageActivityItem.LandingPageActivityItem({key:"LandingPageActivityItem-"+i,activitySubject:itemList[i].get_Subject(),activityScheduledEndString:itemList[i].get_ScheduledEndString(),activityRegardingObjectName:itemList[i].get_RegardingObjectName()}));return activitiesChildren};LandingPageActivitiesSpec.prototype.render=function(){var children=[];children.push(ProgressIndicator.ProgressIndicator({key:"loadingItem",type:ProgressIndicator.ProgressIndicatorType.Bar,active:this.props.dataContext.get_IsLoading()}));var accordionActivities=Accordion.Accordion({key:"MyActivitiesPanel",style:{display:!this.props.dataContext.get_IsLoading()?"block":"none"}},this.getAccordionSections());children.push(accordionActivities);return React.DOM.div({className:"landingPageActivities"},children)};return LandingPageActivitiesSpec}(TsAdapter.SpecBase);exports.LandingPageActivities=DataWrapperComponent.wrapComponent(new LandingPageActivitiesSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/PullToRefresher/PullToRefresher",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/FontIcon","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,FontIcon,CssClassSet){var headerStyle={position:"absolute",height:"50px",width:"100%",left:"0px",top:"-50px",textAlign:"center",lineHeight:"50px",fontSize:"16px",color:"#666666"},contentTransformDefault="translateY(0px)",componentStyle={overflow:"auto",position:"relative",height:"100%",backgroundColor:"#e2f4fd"},refreshSymbolContainerHeight=50,contentStyle={position:"relative",top:"0px",minHeight:"100%",backgroundColor:"white",WebkitTransform:contentTransformDefault,transform:contentTransformDefault,WebkitTransition:"transform .1s ease-out",MozTransition:"transform .1s ease-out",msTransition:"transform .1s ease-out",transition:"transform .1s ease-out"},PullToRefresherSpec=function(_super){__extends(PullToRefresherSpec,_super);function PullToRefresherSpec(){_super.apply(this,arguments);this.displayName="PullToRefresher";this.mixins=[PureUpdate.Mixin];this.startPosition=0;this.currentDisplacement=0;this.doRefresh=false}PullToRefresherSpec.prototype.componentWillMount=function(){this.isAndroid4=this.props.clientContext.userAgent.get_IsAndroid()&&!this.props.clientContext.userAgent.get_IsAndroid5()};PullToRefresherSpec.prototype.onTouchStart=function(e,pageY){this.startPosition=ReactDOM.findDOMNode(this).scrollTop+pageY};PullToRefresherSpec.prototype.onTouchMove=function(e,pageY){this.isAndroid4&&e.preventDefault();if(this.props.isRefreshing)return;if(ReactDOM.findDOMNode(this).scrollTop>0&&this.currentDisplacement==0)return;this.currentDisplacement=pageY-this.startPosition;if(this.currentDisplacement<0)this.currentDisplacement=0;!this.props.clientContext.userAgent.get_IsIPhone()&&this.setContentNodeTransformField(this.currentDisplacement);this.doRefresh=this.currentDisplacement>this.props.distanceForRefresh&&!this.props.isRefreshing};PullToRefresherSpec.prototype.onTouchEnd=function(){this.currentDisplacement=0;this.setContentNodeTransformField(this.props.isRefreshing||this.doRefresh?refreshSymbolContainerHeight:0,true);if(this.doRefresh){this.doRefresh=false;this.setContentStyleVariableTransformField(refreshSymbolContainerHeight);this.props.componentRefresh()}};PullToRefresherSpec.prototype.setContentNodeTransformField=function(displacement,fixWebkitTransformFreeze){if(fixWebkitTransformFreeze===void 0)fixWebkitTransformFreeze=false;var node=this.refs["pullToRefresherContent"];if(!node)return;var translateY="translateY("+displacement+"px)";node.style.webkitTransform=translateY;node.style.transform=translateY;if(this.props.clientContext.userAgent.get_IsAndroid()&&fixWebkitTransformFreeze&&displacement===0)node.style.webkitTransform=""};PullToRefresherSpec.prototype.setContentStyleVariableTransformField=function(displacement){var modifiedContentStyle={};for(var key in contentStyle)modifiedContentStyle[key]=contentStyle[key];var translateY="translateY("+displacement+"px)";modifiedContentStyle["WebkitTransform"]=translateY;modifiedContentStyle["transform"]=translateY;contentStyle=modifiedContentStyle};PullToRefresherSpec.prototype.render=function(){var _this=this;!this.props.isRefreshing&&contentStyle["transform"]!==contentTransformDefault&&this.setContentStyleVariableTransformField(0);var pullToRefresherHeader=React.DOM.div({key:"pullToRefresherHeader",className:"pullToRefresher-header",style:headerStyle},FontIcon.FontIcon({symbolName:"Refresh",style:{display:"block"},className:CssClassSet({refreshSymbolRotateAnim:this.props.isRefreshing})})),pullToRefresherContent=React.DOM.div({key:"pullToRefresherContent",ref:"pullToRefresherContent",className:"pullToRefresher-content",style:contentStyle},[pullToRefresherHeader,this.props.children]),props={className:"pullToRefresher scrollRegion",style:componentStyle,onScroll:this.props.onScroll?this.props.onScroll:null};if(this.props.clientContext.userAgent.get_IsWinPhone()){props.onPointerDown=function(e){return _this.onTouchStart(e,e.pageY)};props.onPointerUp=this.onTouchEnd;props.onPointerCancel=this.onTouchEnd;props.onPointerMove=function(e){return _this.onTouchMove(e,e.pageY)}}else{props.onTouchStart=function(e){return _this.onTouchStart(e,e.touches[0].pageY)};props.onTouchEnd=this.onTouchEnd;props.onTouchCancel=this.onTouchEnd;props.onTouchMove=function(e){return _this.onTouchMove(e,e.touches[0].pageY)}}return React.DOM.div(props,pullToRefresherContent)};return PullToRefresherSpec}(TsAdapter.SpecBase);exports.PullToRefresher=TsAdapter.createComponent(new PullToRefresherSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPage",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageButton","Components/Primitives/Button","Components/Primitives/FontIcon","Components/LandingPage/UserProfile","Components/LandingPage/RecentlyViewedItemList","Components/LandingPage/QuickCommandsBar","Components/LandingPage/LandingPageActivities","Components/PullToRefresher/PullToRefresher","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ImageButton,Button,FontIcon,UserProfile,RecentlyViewedItemList,QuickCommandsBar,LandingPageActivities,PullToRefresher,CssClassSet){var bottomScrollThreshold=70,LandingPageSpec=function(_super){__extends(LandingPageSpec,_super);function LandingPageSpec(){_super.apply(this,arguments);this.displayName="LandingPage";this.listenToProperties=["RecordCount","Items","RefreshTime","IsRefreshing"];this.scrollCollapsed=false;this.scrollPosition=0;this.stateDebounce=false}LandingPageSpec.prototype.handleScroll=function(e){var _this=this,currentBlock=e.currentTarget,currentScrollPosition=currentBlock.scrollTop;if(this.stateDebounce){this.scrollPosition=currentScrollPosition;return}if(currentScrollPosition<0||currentBlock.scrollHeight-currentScrollPosition-currentBlock.clientHeight<bottomScrollThreshold)return;if(currentScrollPosition>this.scrollPosition&&!this.scrollCollapsed){ReactDOM.findDOMNode(this).classList.add("landingPage-scrolledDown");this.scrollCollapsed=true}if(currentScrollPosition<this.scrollPosition&&this.scrollCollapsed){ReactDOM.findDOMNode(this).classList.remove("landingPage-scrolledDown");this.scrollCollapsed=false}this.scrollPosition=currentScrollPosition;this.stateDebounce=true;window.setTimeout(function(){_this.stateDebounce=false},100)};LandingPageSpec.prototype.refreshHandler=function(){this.props.dataContext.RefreshLandingPage(true)};LandingPageSpec.prototype.collapse=function(){var landingPageModel=this.props.clientContext.applicationShellViewModel.get_landingPageViewModel();landingPageModel&&landingPageModel.collapse&&landingPageModel.collapse(true)};LandingPageSpec.prototype.render=function(){var isRefreshing=this.props.dataContext.get_IsRefreshing(),accordionActivities=LandingPageActivities.LandingPageActivities({key:"myActivities",dataContext:this.props.dataContext.get_LandingPageActivitiesViewModel(),clientContext:this.props.clientContext}),accordionRecently=RecentlyViewedItemList.RecentlyViewedItemList({key:"accordionRecently",dataContext:this.props.dataContext.get_RecentlyViewedItemListViewModel(),clientContext:this.props.clientContext}),userProfile=UserProfile.UserProfile({key:"userProfileComponent",dataContext:this.props.dataContext.get_UserProfile(),clientContext:this.props.clientContext}),quickCommandsBar=QuickCommandsBar.QuickCommandsBar({key:"quickCommandsBar",dataContext:this.props.dataContext.get_QuickCommandManager(),clientContext:this.props.clientContext}),closeLandingPageButton=Button.Button({key:"closeLandingPage",className:"closeLandingPage",onClick:this.collapse},[React.DOM.span({key:"closeLandingPageText",className:"closeLandingPage-text"},this.props.clientContext.getLocalizedString("LabelForCloseButton")),FontIcon.FontIcon({key:"closeLandingPageSymbol",symbolName:"Cancel",className:"landingPageButton"})]),manualRefreshButton=ImageButton.ImageButton({key:"refreshLandingPage",className:CssClassSet({refreshLandingPage:true,refreshSymbolRotateAnim:isRefreshing}),imageName:"Refresh",imageType:"Symbol",onClick:this.refreshHandler}),refreshTime=React.DOM.span({key:"landingPageRefreshTime",className:"landingPage-refreshTime"},this.props.dataContext.get_RefreshTime()),refreshBlock=React.DOM.div({key:"landingPageRefreshBlock",className:"landingPage-refreshBlock"},[manualRefreshButton,refreshTime]),landingPageHeader=React.DOM.div({key:"landingPageHeader",className:"landingPage-header"},[userProfile,refreshBlock,closeLandingPageButton]),landingPageContent;if(this.props.clientContext.isPhone)landingPageContent=PullToRefresher.PullToRefresher({key:"landingPageContent",ref:"pullToRefresher",componentRefresh:this.refreshHandler,distanceForRefresh:50,onScroll:this.handleScroll,isRefreshing:isRefreshing,clientContext:this.props.clientContext},[accordionActivities,accordionRecently]);else landingPageContent=React.DOM.div({key:"landingPageContent",className:"landingPage-columns"},[accordionActivities,accordionRecently]);var landingPageFooter=React.DOM.div({key:"landingPageFooter",className:"landingPage-footer"},quickCommandsBar),landingPage=React.DOM.div({key:"landingPage",className:"landingPage"},[landingPageHeader,landingPageContent,landingPageFooter]);return landingPage};return LandingPageSpec}(TsAdapter.SpecBase);exports.LandingPage=DataWrapperComponent.wrapComponent(new LandingPageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPageShell",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/Animator","Components/LandingPage/LandingPage","Core/Binding/CustomEventsListenerMixin","Core/Binding/XrmUIDescriptorMixin","Components/Shell/DialogConductor"],function(require,exports,TsAdapter,PureUpdate,Animator,LandingPage,CustomEventsListener,IXUD,DialogConductor){exports.LANDING_PAGE_OPEN_BUTTON_CLASS_NAME="landingPageOpenButton";var LandingPageShellSpec=function(_super){__extends(LandingPageShellSpec,_super);function LandingPageShellSpec(){_super.apply(this,arguments);this.displayName="LandingPageShell";this.canSetState=false;this.landingPageCollapsePending=false;this.mixins=[PureUpdate.Mixin,CustomEventsListener.Mixin,IXUD.Mixin];this.visibility=0}LandingPageShellSpec.prototype.getInitialState=function(){return {visibility:0}};LandingPageShellSpec.prototype.configureEventListeners=function(){return {ExpandEvent:this.expand,CollapseEvent:this.collapse}};LandingPageShellSpec.prototype.getProperties=function(){var properties={};properties["id"]=XrmUI.ControlId.swipeIn;return properties};LandingPageShellSpec.prototype.handleGlobalClick=function(e){var target=e.target;this.visibility===1&&this.handleGlobalClickOnElement(target)};LandingPageShellSpec.prototype.handleGlobalClickOnElement=function(e){if(!e||!e.tagName||e.tagName==="body"){this.props.dataContext.collapse(true);return}if(e.classList.contains(exports.LANDING_PAGE_OPEN_BUTTON_CLASS_NAME))return;var landingPageComponent=this.refs["landingpage"],landingPageNode=ReactDOM.findDOMNode(landingPageComponent);if(e.isEqualNode(landingPageNode)||e.getAttribute("data-is-popup")==="true")return;this.handleGlobalClickOnElement(e.parentElement)};LandingPageShellSpec.prototype.componentDidUpdate=function(){this.state.visibility===1&&this.animateExpand()};LandingPageShellSpec.prototype.componentDidMount=function(){document.addEventListener("mousedown",this.handleGlobalClick);document.addEventListener("touchstart",this.handleGlobalClick);if(this.props.dataContext.get_OpenOnStart()){this.expand();this.canSetState=false}else this.canSetState=true};LandingPageShellSpec.prototype.componentWillUnmount=function(){document.removeEventListener("mousedown",this.handleGlobalClick);document.removeEventListener("touchstart",this.handleGlobalClick)};LandingPageShellSpec.prototype.expand=function(){if(this.visibility===1||!this.isMounted())return;if(this.props.clientContext.userAgent.get_IsIPhone()){var activeElement=document.activeElement;activeElement.blur()}this.visibility=1;this.setState({visibility:1})};LandingPageShellSpec.prototype.animateExpand=function(){var landingPage=this.refs["landingpage"],node=ReactDOM.findDOMNode(landingPage);if(node){node.classList.remove("landingPageCollapseAnim");node.classList.add("landingPageExpanded");Animator.animate(node,"landingPageExpandAnim");DialogConductor.disableIOSConductorContentScroll()}};LandingPageShellSpec.prototype.componentWillReceiveProps=function(){this.canSetState=true;this.landingPageCollapsePending&&this.collapse(false)};LandingPageShellSpec.prototype.collapse=function(doRefresh){var _this=this;if(this.visibility===0||!this.isMounted())return;if(!this.canSetState){this.landingPageCollapsePending=true;return}this.visibility=0;var landingPage=this.refs["landingpage"],node=ReactDOM.findDOMNode(landingPage);if(node){node.classList.remove("landingPageExpandAnim");Animator.animate(node,"landingPageCollapseAnim").then(function(){node.classList.remove("landingPageExpanded");_this.props.dataContext.onPostCollapse();doRefresh&&_this.props.dataContext.RefreshLandingPage(false);_this.setState({visibility:0})});this.landingPageCollapsePending=false;DialogConductor.enableIOSConductorContentScroll()}else this.setState({visibility:0})};LandingPageShellSpec.prototype.render=function(){if(this.state.visibility===0)return React.DOM.noscript();var children=[];children.push(React.DOM.div({key:"landingPageBackdrop",ref:"landingPageBackdrop",className:"landingPageBackdrop"}));children.push(LandingPage.LandingPage({key:"landingpage",ref:"landingpage",dataContext:this.props.dataContext,clientContext:this.props.clientContext}));return React.DOM.div({},children)};return LandingPageShellSpec}(TsAdapter.SpecBase);exports.LandingPageShell=TsAdapter.createComponent(new LandingPageShellSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPageButton",["require","exports","Core/ReactTypescriptAdapter","Components/Primitives/Button","Components/Primitives/FontIcon","Components/LandingPage/LandingPageShell"],function(require,exports,TsAdapter,Button,FontIcon,LandingPageShell){var LandingPageButtonSpec=function(_super){__extends(LandingPageButtonSpec,_super);function LandingPageButtonSpec(){_super.apply(this,arguments);this.displayName="LandingPageButton"}LandingPageButtonSpec.prototype.handleClick=function(){var landingPageViewModel=this.props.clientContext.applicationShellViewModel.get_landingPageViewModel();if(!landingPageViewModel)return;landingPageViewModel.expand()};LandingPageButtonSpec.prototype.render=function(){return Button.Button({className:LandingPageShell.LANDING_PAGE_OPEN_BUTTON_CLASS_NAME,onClick:this.handleClick},FontIcon.FontIcon({symbolName:"Docker"}))};return LandingPageButtonSpec}(TsAdapter.SpecBase);exports.LandingPageButton=TsAdapter.createComponent(new LandingPageButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/NavigationBar/NavigationBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Components/Shell/ShellBackButton","Components/Primitives/Button","Components/Primitives/FontIcon","Components/NavigationBar/BackButton","Components/NavigationBar/SearchButton","Components/NavigationBar/SiteMapButton","Components/NavigationBar/SiteMapPopup","Components/LandingPage/LandingPageButton"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,ShellBackButton,Button,FontIcon,BackButton,SearchButton,SiteMapButton,SiteMapPopup,LandingPageButton){var NavigationBarSpec=function(_super){__extends(NavigationBarSpec,_super);function NavigationBarSpec(){_super.apply(this,arguments);this.displayName="NavigationBar";this.mixins=[IXUD.Mixin];this.listenToProperties=["SiteMapViewModel"]}NavigationBarSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.navigationContainer;properties["id"]=XrmUI.ControlId.navigationBar;return properties};NavigationBarSpec.prototype.handleHomeButtonClick=function(){if(this.props.dataContext){var command=this.props.dataContext.get_HomeCommand();if(command&&command.get_CanExecute()){if(this.props.dataContext.get_SiteMapViewModel().get_Visible())this.props.dataContext.get_SiteMapViewModel().set_Visible(false);else command.execute();this.props.clientContext.applicationShellViewModel.get_NoteInlineCreateFormExpanded()&&this.props.clientContext.applicationShellViewModel.closeNoteInlineCreateForm()}}};NavigationBarSpec.prototype.render=function(){var siteMapViewModel=this.props.dataContext.get_SiteMapViewModel(),siteMapButton=SiteMapButton.SiteMapButton({key:"siteMapButton",className:"siteMapButton",dataId:"sitemap",xrmUIParentId:XrmUI.ControlId.navigationBar,xrmUIControlId:XrmUI.ControlId.siteMapButton,symbolName:"Details",clientContext:this.props.clientContext,dataContext:siteMapViewModel}),siteMapMenu=SiteMapPopup.SiteMapPopup({key:"siteMapMenu",clientContext:this.props.clientContext,dataContext:siteMapViewModel}),homeButton=Button.Button({key:"home",className:"homeButton",dataId:"home",onClick:this.handleHomeButtonClick,reactClientContext:this.props.clientContext,tabIndex:this.props.dataContext.get_HomeButtonTabIndex(),xrmUIParentId:XrmUI.ControlId.navigationBar},FontIcon.FontIcon({symbolName:"Home"})),children=[];!this.props.clientContext.isPhone&&children.push(ShellBackButton.ShellBackButton({key:"backbutton",clientContext:this.props.clientContext,dataContext:this.props.clientContext.applicationShellViewModel}));children.push([siteMapButton,homeButton,siteMapMenu]);this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("LandingPage")&&children.push(LandingPageButton.LandingPageButton({key:"landingpagebutton",clientContext:this.props.clientContext}));var styles={};if(this.props.clientContext.isPhone){children.push(BackButton.BackButton({key:"back",dataContext:this.props.dataContext,clientContext:this.props.clientContext}));children.push(SearchButton.SearchButton({key:"search",dataContext:this.props.dataContext,clientContext:this.props.clientContext}))}if(!this.props.clientContext.isMailApp&&!this.props.clientContext.isInteractionCentric){var theming=this.props.clientContext.theming;if(theming.IsEnabled)styles["backgroundColor"]=theming.get_NavBarBackgroundColor()}children.push(React.DOM.div({key:"mountedSearchContainer",className:"mountedSearchContainer",id:"mountedSearchContainer"}));return React.DOM.div({className:"navBar",id:"headerBar"},React.DOM.div({className:"navigationBar",style:styles},children))};return NavigationBarSpec}(TsAdapter.SpecBase);exports.NavigationBar=DataWrapperComponent.wrapComponent(new NavigationBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/AppBar/AppBarGroup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,CssClassSet){exports.DESCRIPTOR_NAME="AppBarGroup";var AppBarGroupSpec=function(_super){__extends(AppBarGroupSpec,_super);function AppBarGroupSpec(){_super.apply(this,arguments);this.displayName="AppBarGroup";this.listenToProperties=["ChildViewModels"]}AppBarGroupSpec.prototype.childDecorator=function(factory,childProps){childProps["isAppBarFlyOut"]=true;return factory(childProps)};AppBarGroupSpec.prototype.render=function(){var displayTitle=this.props.pageSectionTitle||this.props.dataContext.get_Label(),children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childDecorator);if(this.props.reverseChildren)children=children.reverse();var title;if(displayTitle)title=React.DOM.span({key:"title",className:"group_title"},displayTitle);var content=React.DOM.div({key:"content",className:"group_content"},children);return React.DOM.div({className:CssClassSet(null,"group",this.props.className)},[title,content])};return AppBarGroupSpec}(TsAdapter.SpecBase);exports.AppBarGroup=DataWrapperComponent.wrapComponent(new AppBarGroupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/AppBar/AppBarSection",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/ComponentFactory","Components/Common/FlyOutButton","Components/AppBar/AppBarGroup"],function(require,exports,TsAdapter,DataWrapperComponent,ComponentFactory,FlyOutButton,AppBarGroup){var AppBarSectionSpec=function(_super){__extends(AppBarSectionSpec,_super);function AppBarSectionSpec(){_super.apply(this,arguments);this.displayName="AppBarSection";this.listenToProperties=["ActiveChildViewModels"]}AppBarSectionSpec.prototype.getDefaultProps=function(){return {reverseChildren:false,overflowArea:false,overflowGlobalCommands:false}};AppBarSectionSpec.prototype.childDecorator=function(factory,props){if(factory===FlyOutButton.FlyOutButton){props.isAppBarFlyOut=true;props.stopClickPropagation=true}return factory(props)};AppBarSectionSpec.prototype.renderWithOverflowFlyout=function(activeChildViewModels,overflowButton){var children=ComponentFactory.createComponentsFromViewModels(activeChildViewModels,this.props.clientContext,this.childDecorator);!this.props.clientContext.isPhone&&overflowButton&&children.push(overflowButton);if(this.props.reverseChildren)children=children.reverse();return children};AppBarSectionSpec.prototype.renderWithOverflowArea=function(overflowChildViewModels){return ComponentFactory.createComponentsFromViewModels(overflowChildViewModels,this.props.clientContext,this.childDecorator)};AppBarSectionSpec.prototype.renderOverflowGlobalCommands=function(overflowChildViewModels){var children=ComponentFactory.createComponentsFromViewModels(overflowChildViewModels,this.props.clientContext,this.childDecorator);return children};AppBarSectionSpec.prototype.render=function(){var activeChildViewModels=this.props.dataContext.findActiveChildViewModels(),activeChildCount=activeChildViewModels.length;if(this.props.overflowGlobalCommands){var children=[],isPhone=this.props.clientContext.isPhone;if(!isPhone)children=this.renderOverflowGlobalCommands(activeChildViewModels);else children=[AppBarGroup.AppBarGroup({key:"1",clientContext:this.props.clientContext,dataContext:this.props.dataContext,pageSectionTitle:this.props.pageSectionTitle,reverseChildren:this.props.reverseChildren,forceUpdate:true})]}else{var overflowButton=null;if(activeChildCount>this.props.maximumVisibleCommands){var visibleCount=this.props.maximumVisibleCommands;if(!this.props.clientContext.isPhone)visibleCount--;var overflowCount=activeChildCount-visibleCount,overflowChildViewModels=activeChildViewModels.splice(visibleCount,overflowCount);this.props.dataContext.get_OverflowViewModel().set_OverflowChildViewModels(overflowChildViewModels);if(!this.props.overflowArea)overflowButton=FlyOutButton.FlyOutButton({key:"appBarOverflowButton",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_OverflowViewModel(),flyOutChildrenParent:this.props.dataContext,childViewModels:overflowChildViewModels,reverseChildren:true,label:this.props.clientContext.getLocalizedString("Ribbon_Menu_More"),imageType:"Symbol",imageName:"More",dataId:"MscrmOverflow",stopClickPropagation:true,mountToElementWithId:"appBarHostContainer"})}if(this.props.overflowArea)var children=this.renderWithOverflowArea(overflowChildViewModels||[]);else var children=this.renderWithOverflowFlyout(activeChildViewModels,overflowButton)}return React.DOM.div({className:"appBarSection","data-id":"appBarSection"},children)};return AppBarSectionSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(AppBarGroup.DESCRIPTOR_NAME,AppBarGroup.AppBarGroup);exports.AppBarSection=DataWrapperComponent.wrapComponent(new AppBarSectionSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/AppBar/Appbar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/XrmUIDescriptorMixin","Core/Binding/CustomEventsListenerMixin","Core/ComponentUpdateRequestManager","Components/Primitives/FontIcon","Components/Primitives/Button","Components/AppBar/AppBarSection","Components/Primitives/ProgressIndicator","Core/Binding/WindowResizeHandlerMixin","Components/AppBar/AppBarShell","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,IXUD,CustomEventsListener,ComponentUpdateRequestManager,FontIcon,Button,AppBarSection,ProgressIndicator,WindowResizeHandler,AppBarShell,CssClassSet){var AppBarSpec=function(_super){__extends(AppBarSpec,_super);function AppBarSpec(){_super.apply(this,arguments);this.displayName="AppBar";this.lastAppBarGlobalContextID="";this.mixins=[CustomEventsListener.Mixin,IXUD.Mixin,WindowResizeHandler.Mixin];this.listenToProperties=["IsLoading","ShowGlobalAndPageCommands"];this.listenToCollections=["GlobalSections","PageSections","ContextualSections"]}AppBarSpec.prototype.configureEventListeners=function(){return {AfterRuleEvaluationEvent:this.afterRuleEvaluationEventHandler}};AppBarSpec.prototype.afterRuleEvaluationEventHandler=function(){this.requestRender("AppBar receieved an AfterRuleEvaluationEvent")};AppBarSpec.prototype.getProperties=function(){var properties={};properties["type"]=XrmUI.UIControlType.commandBarContainer;return properties};AppBarSpec.prototype.requestRender=function(reason){if(!this.updateManager)this.updateManager=new ComponentUpdateRequestManager(this);this.updateManager.requestUpdate(reason)};AppBarSpec.prototype.calculateMaximumVisibleButtonCount=function(){var windowWidth=window.innerWidth,visibleButtonsCount=8;if(windowWidth<=330&&this.props.clientContext.isPhone)visibleButtonsCount=3;else if(windowWidth<=500||this.props.clientContext.isPhone)visibleButtonsCount=4;else if(windowWidth<=920)visibleButtonsCount=5;this.props.dataContext.set_MaximumVisibleButtonsCount(visibleButtonsCount);return visibleButtonsCount};AppBarSpec.prototype.handleWindowResize=function(){this.requestRender("AppBar is requesting an render via handleWindowResize()")};AppBarSpec.prototype.renderProgressBar=function(){return ProgressIndicator.ProgressIndicator({key:"progressBar",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true})};AppBarSpec.prototype.isItemSelectedAndNoCrmDialogActive=function(){return this.props.clientContext.applicationShellViewModel.getSelectedViewModels().length>0&&!this.props.clientContext.applicationShellViewModel.isCrmDialogActive()};AppBarSpec.prototype.shouldComponentUpdate=function(nextProps,nextState){var propChanged=this.props.dataContext!==nextProps.dataContext||this.props.visibility!==nextProps.visibility||this.props.children!==nextProps.children||this.props.clientContext!==nextProps.clientContext||this.lastAppBarGlobalContextID!=this.props.dataContext.get_GlobalContextId();this.lastAppBarGlobalContextID=this.props.dataContext.get_GlobalContextId();return propChanged};AppBarSpec.prototype.renderOverflowSection=function(dataContext,children,style){if(children.length===0)return null;return React.DOM.div({key:"overflowSection",className:"appBar-contextSection appBar-overflowSection","data-context":dataContext,style:style},children)};AppBarSpec.prototype.onTouchStart=function(){var appBarContent=this.refs["appBarContent"];if(appBarContent)if(appBarContent.style.top)appBarContent.style.top="";else appBarContent.style.top="0px"};AppBarSpec.prototype.componentWillMount=function(){this.isPhoneAndroid4=this.props.clientContext.isPhone&&this.props.clientContext.userAgent.get_IsAndroid()&&!this.props.clientContext.userAgent.get_IsAndroid5()};AppBarSpec.prototype.render=function(){if(this.props.clientContext.isPreview||this.props.clientContext.isInteractionCentric)return React.DOM.div({className:"appBar"},React.DOM.div({className:"appBar-content",id:"appBar-content"}));if(this.props.dataContext.get_IsLoading())return React.DOM.div({className:"appBar"},React.DOM.div({className:"appBar-content",id:"appBar-content"},[this.renderProgressBar()]));var isMergedContext=this.props.dataContext.get_IsMergedContext(),globalSections=this.props.dataContext.get_GlobalSections(),pageSections=this.props.dataContext.get_PageSections(),contextualSections=this.props.dataContext.get_ContextualSections(),paneSections=this.props.dataContext.get_PaneContextualSections(),maximumVisibleButtons=this.calculateMaximumVisibleButtonCount(),leftSectionChildren=[],rightSectionChildren=[],overflowSectionChildren=[],hasContextualSections=contextualSections.get_Count()>0,hasContextualCommands=false,isPhone=this.props.clientContext.isPhone,itemIsSelected=this.isItemSelectedAndNoCrmDialogActive(),leftSectionDataContext="",rightSectionDataContext="",overflowSectionDataContext="";if(isPhone&&this.props.visibility===1){globalSections.get_Count()>0&&this.props.dataContext.mergePageAndGlobalSections();var dataContextItem=pageSections.get_Count()>0?pageSections.getItem(0):null;if(hasContextualSections||paneSections.get_Count()>0){var context;if(hasContextualSections&&!isMergedContext)context=contextualSections.getItem(0);else if(paneSections.get_Count()>0&&isMergedContext)context=paneSections.getItem(0);if(context){hasContextualCommands=true;leftSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:context,maximumVisibleCommands:maximumVisibleButtons}));leftSectionDataContext=this.props.dataContext.get_ContextualContextId();if(context.findActiveChildViewModels().length>maximumVisibleButtons){overflowSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:context,maximumVisibleCommands:maximumVisibleButtons,overflowArea:true}));overflowSectionDataContext=this.props.dataContext.get_ContextualContextId()}if(dataContextItem&&isMergedContext){rightSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:dataContextItem,maximumVisibleCommands:maximumVisibleButtons,overflowGlobalCommands:true,pageSectionTitle:this.props.dataContext.get_PageSectionTitle(),reverseChildren:true,forceUpdate:true}));rightSectionDataContext=this.props.dataContext.get_GlobalContextId()}}}else if(dataContextItem){leftSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:dataContextItem,maximumVisibleCommands:maximumVisibleButtons}));leftSectionDataContext=this.props.dataContext.get_GlobalContextId();overflowSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:dataContextItem,maximumVisibleCommands:maximumVisibleButtons,overflowArea:true}));overflowSectionDataContext=this.props.dataContext.get_GlobalContextId()}}else if(this.props.visibility===1)if(hasContextualSections){rightSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:contextualSections.getItem(0),maximumVisibleCommands:maximumVisibleButtons}));rightSectionDataContext=this.props.dataContext.get_ContextualContextId()}else{if(this.props.dataContext.get_ShowGlobalAndPageCommands()&&globalSections.get_Count()>0&&!itemIsSelected){rightSectionChildren.push(AppBarSection.AppBarSection({key:"1",clientContext:this.props.clientContext,dataContext:globalSections.getItem(0),maximumVisibleCommands:maximumVisibleButtons}));rightSectionDataContext=this.props.dataContext.get_GlobalContextId()}if(this.props.dataContext.get_ShowGlobalAndPageCommands()&&pageSections.get_Count()>0&&!itemIsSelected){leftSectionChildren.push(AppBarSection.AppBarSection({key:"1",reverseChildren:true,clientContext:this.props.clientContext,dataContext:pageSections.getItem(0),maximumVisibleCommands:maximumVisibleButtons}));leftSectionDataContext=this.props.dataContext.get_GlobalContextId()}}var leftSection=React.DOM.div({key:"leftSection",className:"appBar-globalSection","data-context":leftSectionDataContext},leftSectionChildren),rightSection=React.DOM.div({key:"rightSection",className:CssClassSet({"appBar-contextSection":true,"appBar-overflowSection phone-appBar-overflowGlobal":overflowSectionChildren}),"data-context":rightSectionDataContext},rightSectionChildren),overflowScrollStyle={};if(this.props.clientContext.isPhone)overflowScrollStyle={maxHeight:WindowResizeHandler.getWindowHeight()/2-110+"px"};var appBarContent=null,appBarContextChildren=[leftSection];if(hasContextualCommands&&isMergedContext){var overflowSection=this.renderOverflowSection(overflowSectionDataContext,overflowSectionChildren,null),overflowArea=React.DOM.div({key:"overflowArea",className:"phone-overflowArea",style:overflowScrollStyle},[overflowSection,rightSection]);appBarContextChildren.push(overflowArea)}else{var overflowSection=this.renderOverflowSection(overflowSectionDataContext,overflowSectionChildren,overflowScrollStyle),rightSection=React.DOM.div({key:"rightSection",className:"appBar-contextSection","data-context":rightSectionDataContext},rightSectionChildren);appBarContextChildren.push(overflowSection);appBarContextChildren.push(rightSection)}this.props.clientContext.isPhone&&appBarContextChildren.push(Button.Button({key:"phoneclosebutton",ref:"close",className:"phoneAppBarCloseButton",stopShortPressPropagation:true,stopClickPropagation:true,onClick:this.props.handleCloseButtonClick},FontIcon.FontIcon({symbolName:"More"})));appBarContent=React.DOM.div({key:"content",className:"appBar-content",id:"appBar-content",ref:"appBarContent",onTouchStart:this.isPhoneAndroid4?this.onTouchStart:null},appBarContextChildren);var appBarHostContainer=React.DOM.div({key:"host",id:"appBarHostContainer"}),appBarChildren=[appBarContent,appBarHostContainer];return React.DOM.div({id:"AppBar",className:"appBar"},appBarChildren)};return AppBarSpec}(TsAdapter.SpecBase);exports.AppBar=DataWrapperComponent.wrapComponent(new AppBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/AppBar/AppBarButton",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,PureUpdate,FontIcon){var AppBarButtonSpec=function(_super){__extends(AppBarButtonSpec,_super);function AppBarButtonSpec(){_super.apply(this,arguments);this.displayName="AppBarButton";this.mixins=[PureUpdate.Mixin]}AppBarButtonSpec.prototype.handleClick=function(){var appBarVisible=!this.props.clientContext.device.get_DeviceState().get_AppBarVisible();if(appBarVisible)this.props.clientContext.applicationShellViewModel.get_CommandManagerViewModel().expand();else this.props.clientContext.applicationShellViewModel.get_CommandManagerViewModel().collapse()};AppBarButtonSpec.prototype.render=function(){var buttonProps={onClick:this.handleClick,className:"appBarButton",id:"appBarSwitch"};return React.DOM.div(buttonProps,React.DOM.button({className:"appBarInButton"},FontIcon.FontIcon({symbolName:"More"})))};return AppBarButtonSpec}(TsAdapter.SpecBase);exports.AppBarButton=TsAdapter.createComponent(new AppBarButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/AppBar/AppBarShell",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/CustomEventsListenerMixin","Core/Binding/XrmUIDescriptorMixin","Utils/Animator","Components/AppBar/Appbar","Components/AppBar/AppBarButton","Components/Shell/DialogConductor"],function(require,exports,TsAdapter,DataWrapperComponent,CustomEventsListener,IXUD,Animator,AppBar,AppBarButton,DialogConductor){var AppBarShellSpec=function(_super){__extends(AppBarShellSpec,_super);function AppBarShellSpec(){_super.apply(this,arguments);this.displayName="AppBarShell";this.visibility=0;this.mixins=[CustomEventsListener.Mixin,IXUD.Mixin]}AppBarShellSpec.prototype.configureEventListeners=function(){return {ExpandEvent:this.expand,CollapseEvent:this.collapse}};AppBarShellSpec.prototype.getInitialState=function(){return {visibility:0}};AppBarShellSpec.prototype.handleAppBarButtonClick=function(e){if(this.state.visibility===0)this.expand();else this.collapse();e.stopPropagation()};AppBarShellSpec.prototype.deviceVisibilityChangeHandler=function(){if(this.props.clientContext.device.get_DeviceState())if(this.state.visibility===0&&this.props.clientContext.device.get_DeviceState().get_AppBarVisible())this.expand();else this.state.visibility!==0&&!this.props.clientContext.device.get_DeviceState().get_AppBarVisible()&&this.collapse();else if(this.state.visibility===0)this.expand();else this.collapse();this.props.clientContext.userAgent.get_PALEnabled()&&this.props.clientContext.navigation.get_IsAvailable()&&this.props.clientContext.navigation.updateBackBehavior()};AppBarShellSpec.prototype.handleGlobalClick=function(e){var target=e.target;this.state.visibility===1&&this.shouldDismissOnElementFocus(target)&&this.collapse()};AppBarShellSpec.prototype.shouldDismissOnElementFocus=function(e){if(this.props.clientContext.isInteractionCentric)return false;if(!e||!e.tagName||e.tagName==="body")return true;if(e.classList&&e.classList.contains("appBarButton"))return false;if(e.isEqualNode(ReactDOM.findDOMNode(this))||e.getAttribute("data-is-popup")==="true"||e.getAttribute("aria-selected")==="true")return false;return this.shouldDismissOnElementFocus(e.parentElement)};AppBarShellSpec.prototype.componentDidMount=function(){this.props.clientContext.device.get_DeviceState().AddPropertyChangedListener("AppBarVisible",this.deviceVisibilityChangeHandler);document.addEventListener("mousedown",this.handleGlobalClick);!this.props.clientContext.userAgent.get_IsWindowsPhone81()&&document.addEventListener("touchstart",this.handleGlobalClick)};AppBarShellSpec.prototype.componentWillUnmount=function(){this.props.clientContext.device.get_DeviceState().RemovePropertyChangedListener("AppBarVisible",this.deviceVisibilityChangeHandler);document.removeEventListener("mousedown",this.handleGlobalClick);!this.props.clientContext.userAgent.get_IsWindowsPhone81()&&document.removeEventListener("touchstart",this.handleGlobalClick)};AppBarShellSpec.prototype.expand=function(){var _this=this;if(this.state.visibility===1||!this.isEnabled()||!this.isMounted())return;var shell=ReactDOM.findDOMNode(this);shell.setAttribute("data-open","1");this.visibility=1;this.setState({visibility:1},function(){_this.props.dataContext.forceRuleEvaluation();var appBarComponent=_this.refs["appbar"],node=ReactDOM.findDOMNode(appBarComponent);if(node){var animNode=$(node).children(".appBar-content")[0];if(!animNode||_this.props.clientContext.userAgent.get_IsIOS())animNode=node;node.style.height="auto";animNode.classList.remove("appBarCollapseAnim");Animator.animate(animNode,"appBarExpandAnim");DialogConductor.disableIOSConductorContentScroll()}_this.props.clientContext.applicationShellViewModel.closePopups();_this.props.clientContext.device.changeState("AppBarVisible",true)})};AppBarShellSpec.prototype.collapse=function(){var _this=this;if(this.state.visibility===0||!this.isMounted())return;var shell=ReactDOM.findDOMNode(this);shell.setAttribute("data-open","0");this.visibility=0;this.setState({visibility:0},function(){_this.props.dataContext.closeAllFlyOuts();var appBarComponent=_this.refs["appbar"],node=ReactDOM.findDOMNode(appBarComponent);if(node){var animNode=$(node).children(".appBar-content")[0];if(!animNode||_this.props.clientContext.userAgent.get_IsIOS())animNode=node;animNode.classList.remove("appBarExpandAnim");Animator.animate(animNode,"appBarCollapseAnim").then(function(){if(_this.state.visibility===0)node.style.height="0"});DialogConductor.enableIOSConductorContentScroll()}_this.props.clientContext.applicationShellViewModel.clearSelectedViewModels();_this.props.clientContext.device.changeState("AppBarVisible",false)})};AppBarShellSpec.prototype.isEnabled=function(){if(this.props.clientContext.isPreview)return false;if(this.props.dataContext)return this.props.dataContext.get_IsEnabled();return true};AppBarShellSpec.prototype.shouldComponentUpdate=function(nextProps,nextState){var propChanged=this.props.dataContext!==nextProps.dataContext||this.props.clientContext!==nextProps.clientContext,stateChanged=nextState.visibility!==this.state.visibility;if(stateChanged)if(nextState.visibility===0&&this.visibility===0)stateChanged=false;return propChanged||stateChanged};AppBarShellSpec.prototype.render=function(){var shellProps={className:"appBarShell",id:"appBarShell"};if(this.state.visibility===1)shellProps["data-open"]="1";var appBarButton=AppBarButton.AppBarButton({key:"appBarButton",clientContext:this.props.clientContext}),appBar=AppBar.AppBar({key:"appbar",ref:"appbar",id:"AppBar",dataContext:this.props.dataContext,clientContext:this.props.clientContext,handleCloseButtonClick:this.handleAppBarButtonClick,visibility:this.state.visibility});return React.DOM.div(shellProps,[appBarButton,appBar])};AppBarShellSpec.prototype.getProperties=function(){var properties={};properties["id"]=XrmUI.ControlId.swipeIn;return properties};return AppBarShellSpec}(TsAdapter.SpecBase);exports.AppBarShell=DataWrapperComponent.wrapComponent(new AppBarShellSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Shell/ApplicationShell",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Shell/Shell","Components/Shell/UserEducation","Components/Shell/OfflineIndicator","Components/Shell/OfflineStatusMenu","Components/Shell/Conductor","Components/Shell/DialogConductor","Components/Shell/ListNavigation","Components/TaskBasedFlow/TaskBasedFlowGlobalMenu","Components/NavigationBar/NavigationBar","Components/AppBar/AppBarShell","Components/LandingPage/LandingPageShell"],function(require,exports,TsAdapter,DataWrapperComponent,Shell,UserEducation,OfflineIndicator,OfflineStatusMenu,Conductor,DialogConductor,ListNavigation,TaskBasedFlowGlobalMenu,NavigationBar,AppBarShell,LandingPageShell){var ApplicationShellSpec=function(_super){__extends(ApplicationShellSpec,_super);function ApplicationShellSpec(){_super.apply(this,arguments);this.displayName="ApplicationShell";this.listenToProperties=["NavigationBar","CanvasConductor","TaskBasedFlowGlobalMenu","CommandManagerViewModel","DialogConductor"]}ApplicationShellSpec.prototype.render=function(){var userAgent=this.props.clientContext.userAgent,children=[];children.push(OfflineIndicator.OfflineIndicator({key:"offline",dataContext:this.props.dataContext,clientContext:this.props.clientContext}));children.push(NavigationBar.NavigationBar({key:"navbar",dataContext:this.props.dataContext.get_NavigationBar(),clientContext:this.props.clientContext}));!this.props.clientContext.isPhone&&children.push(React.DOM.div({key:"nav",className:"navContainer",id:"navigationPane"},ListNavigation.ListNavigation({key:"listnav",dataContext:this.props.dataContext,clientContext:this.props.clientContext})));var landingPageViewModel=this.props.dataContext.get_landingPageViewModel();landingPageViewModel&&children.push(LandingPageShell.LandingPageShell({key:"landingPageShell",dataContext:landingPageViewModel,clientContext:this.props.clientContext}));children.push(Conductor.Conductor({key:"canvas",dataContext:this.props.dataContext.get_CanvasConductor(),clientContext:this.props.clientContext}));children.push(OfflineStatusMenu.OfflineStatusMenu({key:"offlineStatusMenu",dataContext:this.props.dataContext,clientContext:this.props.clientContext}));children.push(TaskBasedFlowGlobalMenu.TaskBasedFlowGlobalMenu({key:"taskflow",dataContext:this.props.dataContext.get_TaskBasedFlowGlobalMenu(),clientContext:this.props.clientContext}));children.push(AppBarShell.AppBarShell({key:"appbar",dataContext:this.props.dataContext.get_CommandManagerViewModel(),clientContext:this.props.clientContext}));children.push(DialogConductor.DialogConductor({key:"dialog",dataContext:this.props.dataContext.get_DialogConductor(),clientContext:this.props.clientContext}));children.push(UserEducation.UserEducation({key:"usered"}));var rootViewModel=this.props.dataContext.get_CanvasConductor().get_Top();return Shell.Shell({ref:"shell",dataContext:this.props.dataContext,clientContext:this.props.clientContext},children)};return ApplicationShellSpec}(TsAdapter.SpecBase);exports.ApplicationShell=DataWrapperComponent.wrapComponent(new ApplicationShellSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppUserEducation",["require","exports","Core/ReactTypescriptAdapter"],function(require,exports,TsAdapter){var MailAppUserEducationSpec=function(_super){__extends(MailAppUserEducationSpec,_super);function MailAppUserEducationSpec(){_super.apply(this,arguments);this.displayName="MailAppUserEducation"}MailAppUserEducationSpec.prototype.shouldComponentUpdate=function(){return false};MailAppUserEducationSpec.prototype.render=function(){var header=React.DOM.div({key:"header",id:"UserEducationHeader",className:"userEducationHeader"},React.DOM.label({id:"UserEducationTitle",className:"userEducationTitle"})),tips=React.DOM.div({key:"tips",id:"UserEducationTips",className:"userEducationTips"},[React.DOM.label({key:"tip1",id:"HelpTip1",className:"helpTip1"}),React.DOM.label({key:"tip2",id:"HelpTip2",className:"helpTip2"}),React.DOM.label({key:"tip3",id:"HelpTip3",className:"helpTip3"})]),gifSection=React.DOM.div({key:"gif",className:"gifSection"},React.DOM.img({id:"userEducationImage"})),waitLabel=React.DOM.label({key:"wait",id:"WaitLabel",className:"waitLabel"}),multipleServerCallProgressIndicator=React.DOM.label({key:"multipleserverprogress",id:"MultipleServerCallProgressIndicator",className:"multipleServerCallProgressIndicator"}),crmUiLoading=React.DOM.div({key:"crmui",id:"CRMUILoading",className:"indeterminateProgressRing"},[React.DOM.div({key:"dot1",className:"progressDot"}),React.DOM.div({key:"dot2",className:"progressDot"}),React.DOM.div({key:"dot3",className:"progressDot"}),React.DOM.div({key:"dot4",className:"progressDot"}),React.DOM.div({key:"dot5",className:"progressDot"})]),feedbackSection=React.DOM.div({key:"feedback",className:"feedbackSection"},React.DOM.div({id:"LoadingSection",className:"loadingSection"},[waitLabel,multipleServerCallProgressIndicator,crmUiLoading]));return React.DOM.div({id:"UserEducation",className:"userEducation",style:{display:"none"}},header,tips,gifSection,feedbackSection)};return MailAppUserEducationSpec}(TsAdapter.SpecBase);exports.MailAppUserEducation=TsAdapter.createComponent(new MailAppUserEducationSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/Notification",["require","exports","Core/ReactTypescriptAdapter","Utils/CssClassSet","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,CssClassSet,FontIcon){var NotificationSpec=function(_super){__extends(NotificationSpec,_super);function NotificationSpec(){_super.apply(this,arguments);this.displayName="Notification";this.dismissTimeoutId=-1}NotificationSpec.prototype.getDefaultProps=function(){return {isActive:false,dismissAfter:5e3,permanent:false}};NotificationSpec.prototype.componentDidMount=function(){if(this.props.onDismiss&&this.props.isActive&&!this.props.permanent)this.dismissTimeoutId=window.setTimeout(this.props.onDismiss,this.props.dismissAfter)};NotificationSpec.prototype.componentWillUnmount=function(){if(this.dismissTimeoutId!==-1){window.clearTimeout(this.dismissTimeoutId);this.dismissTimeoutId=-1}};NotificationSpec.prototype.renderNotificationText=function(){var fontIcon=FontIcon.FontIcon({symbolName:this.props.type===0?"CheckMark":"HighPriority",key:"icon",className:"dataIcon"});return React.DOM.span({key:"text",ref:"text",className:CssClassSet({notificationText:true,success:this.props.type===0,warning:this.props.type===1,error:this.props.type===2,permanent:this.props.permanent==true})},[fontIcon,this.props.message])};NotificationSpec.prototype.renderCloseButton=function(){var fontIcon=FontIcon.FontIcon({symbolName:"Cancel",key:"cancel-icon"});return React.DOM.span({key:"close-button",className:"closeNotificationButton",onClick:this.props.onDismiss},fontIcon)};NotificationSpec.prototype.render=function(){var children=[];children.push(this.renderNotificationText());!this.props.permanent&&children.push(this.renderCloseButton());return React.DOM.div({"data-id":"notification-"+this.props.type,key:"notification-"+this.props.type,title:this.props.message,className:CssClassSet({notificationItem:true,permanent:this.props.permanent})},children)};return NotificationSpec}(TsAdapter.SpecBase);exports.Notification=TsAdapter.createComponent(new NotificationSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/TrackBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/HyperlinkButton","Components/Primitives/ProgressIndicator","Utils/CssClassSet","Components/Primitives/Popup","Components/Primitives/Notification"],function(require,exports,TsAdapter,DataWrapperComponent,HyperlinkButton,ProgressIndicator,CssClassSet,Popup,Notification){var TrackBarSpec=function(_super){__extends(TrackBarSpec,_super);function TrackBarSpec(){_super.apply(this,arguments);this.displayName="TrackBar";this.listenToProperties=["State","IsLoading","IsError","Notification","ShowContactCreateRecommendation"]}TrackBarSpec.prototype.hideChangeDropdown=function(){this.setState({showModifyTrackDropdown:false})};TrackBarSpec.prototype.handleTrackClick=function(){this.props.dataContext.openRegardingSearchPage()};TrackBarSpec.prototype.handleChangeClick=function(){this.props.dataContext.onChangeFlyOutButtonClick();this.setState({showModifyTrackDropdown:!this.state.showModifyTrackDropdown})};TrackBarSpec.prototype.handleChangeRegardingClick=function(){this.hideChangeDropdown();this.props.dataContext.changeRegarding()};TrackBarSpec.prototype.handleUntrackClick=function(){this.hideChangeDropdown();this.props.dataContext.handleUntrack()};TrackBarSpec.prototype.handleChangeDismiss=function(target){if(this.isMounted()){var match=target.closest(".flyoutButton-flyOut");(!match||match.length==0)&&this.hideChangeDropdown()}};TrackBarSpec.prototype.handleRetryClick=function(){this.props.dataContext.retryLastFailedAction()};TrackBarSpec.prototype.openRegardingClick=function(){this.props.dataContext.openRegardedEntity()};TrackBarSpec.prototype.getInitialState=function(){return {showModifyTrackDropdown:false}};TrackBarSpec.prototype.renderChangeFlyoutButton=function(){var block=[],dropdownButton=HyperlinkButton.HyperlinkButton({key:"changeDropdown",id:"changeDropdown",dataId:"changeDropdown",className:"actionButton",enabled:true,label:this.props.dataContext.get_ChangeButtonText(),onClick:this.handleChangeClick});block.push(dropdownButton);if(this.state.showModifyTrackDropdown){var flyoutChildren=[],changeButton=HyperlinkButton.HyperlinkButton({key:"change",id:"change",dataId:"change",className:"flyout-menuItem",enabled:true,label:this.props.dataContext.get_SetRegardingLinkText(),onClick:this.handleChangeRegardingClick}),untrackButton=HyperlinkButton.HyperlinkButton({key:"untrack",id:"untrack",dataId:"untrack",className:"flyout-menuItem",enabled:true,label:this.props.dataContext.get_UntrackButtonText(),onClick:this.handleUntrackClick});flyoutChildren.push(changeButton);flyoutChildren.push(untrackButton);block.push(Popup.Popup({key:"changeTrackFlyout",className:CssClassSet({"flyoutButton-flyOut":true,changeTrackFlyout:true}),onDismiss:this.handleChangeDismiss,visible:true},flyoutChildren))}return React.DOM.div({className:"flyoutContainer flyoutMenuOpen"},block)};TrackBarSpec.prototype.componentsWrapper=function(leftBlockItems,rightBlockItems){var container=[];leftBlockItems&&container.push(React.DOM.div({className:"messages"},leftBlockItems));rightBlockItems&&container.push(React.DOM.div({className:"actions"},rightBlockItems));return container};TrackBarSpec.prototype.renderProgressIndicator=function(){return this.componentsWrapper(React.DOM.div({key:"progressContainer",className:"progressContainer",active:true},ProgressIndicator.ProgressIndicator({key:"progressRing",className:"progressRing",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring})))};TrackBarSpec.prototype.renderError=function(){var actionButton,errorMessage=this.props.dataContext.get_ErrorMessageText();if(this.props.dataContext.get_IsRetryButtonVisible())actionButton=HyperlinkButton.HyperlinkButton({key:"retry",id:"retry",dataId:"retry",className:"actionButton",enabled:true,label:this.props.dataContext.get_RetryButtonText(),onClick:this.handleRetryClick});else actionButton=HyperlinkButton.HyperlinkButton({key:"help",id:"help",dataId:"help",className:"actionButton helpButton",enabled:true,label:this.props.dataContext.get_HelpButtonText(),onClick:this.props.dataContext.openDynamicsHelpPage});return this.componentsWrapper(React.DOM.div({key:"error_msg",id:"error_msg",className:"msg",title:errorMessage,active:true},errorMessage),actionButton)};TrackBarSpec.prototype.renderRegularTrack=function(){var messageBlock=[],actionsBlock=[],message=this.props.dataContext.get_MessageText(),isSetRegardingOpened=this.props.isSetRegardingOpened,isTracked=this.props.dataContext.get_IsTracked();message&&messageBlock.push(React.DOM.div({key:"msg",id:"msg",className:CssClassSet({msg:true}),title:message,active:true},message));this.props.dataContext.get_IsRegardingButtonVisible()&&messageBlock.push(React.DOM.div({key:"regarding",id:"regarding",dataId:"regarding",className:CssClassSet({msg:true,button:true}),title:this.props.dataContext.get_RegardingObjectName(),onClick:this.openRegardingClick,active:true},this.props.dataContext.get_RegardingObjectName()));if(!isSetRegardingOpened&&this.props.dataContext.get_IsChangeRegardingAvailable())if(isTracked)actionsBlock.push(this.renderChangeFlyoutButton());else!this.props.dataContext.get_IsUntrackingInProgress()&&actionsBlock.push(HyperlinkButton.HyperlinkButton({key:"track",id:"track",dataId:"track",className:"actionButton",enabled:true,label:this.props.dataContext.get_TrackButtonText(),onClick:this.handleTrackClick}));return this.componentsWrapper(messageBlock,actionsBlock)};TrackBarSpec.prototype.renderNotifications=function(){var _this=this,notification=this.props.dataContext.get_Notification(),permanentNotification=this.props.dataContext.get_PermanentNotification(),children=[];permanentNotification&&children.push(Notification.Notification({message:permanentNotification.get_Text(),type:permanentNotification.get_Type(),permanent:true,isActive:permanentNotification.get_Active()}));notification&&children.push(Notification.Notification({message:notification.get_Text(),type:notification.get_Type(),permanent:false,onDismiss:function(){_this.props.dataContext.set_Notification(null)},isActive:notification.get_Active()}));if(children.length>0)return React.DOM.div({key:"notifications",className:"notifications"},children);return null};TrackBarSpec.prototype.render=function(){var children=[],notifications=this.renderNotifications();if(notifications)children=notifications;else if(this.props.dataContext.get_IsLoading())children=this.renderProgressIndicator();else if(this.props.dataContext.get_IsError())children=this.renderError();else children=this.renderRegularTrack();return React.DOM.div({key:"trackBar",className:"trackBar",id:"trackBar"},children)};return TrackBarSpec}(TsAdapter.SpecBase);exports.TrackBar=DataWrapperComponent.wrapComponent(new TrackBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/LoadingPopup",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var LoadingPopupSpec=function(_super){__extends(LoadingPopupSpec,_super);function LoadingPopupSpec(){_super.apply(this,arguments);this.displayName="LoadingPopup";this.mixins=[PureUpdate.Mixin]}LoadingPopupSpec.prototype.render=function(){return React.DOM.div({id:"PopupContainer",className:"popupContainer"},React.DOM.div({className:"popup"},React.DOM.div({className:"loadingPopup"},[React.DOM.div({key:"loadingImageContainer",className:"loadingImageContainer"},React.DOM.img({className:"loadingImage"})),React.DOM.div({key:"loadingTextContainer",className:"loadingTextContainer"},React.DOM.span({id:"LoadingPopupMessage",className:"loadingText"},"Opening CRM..."))])))};return LoadingPopupSpec}(TsAdapter.SpecBase);exports.LoadingPopup=TsAdapter.createComponent(new LoadingPopupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/EmailEngagementCard",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,FontIcon){var EmailEngagementCardSpec=function(_super){__extends(EmailEngagementCardSpec,_super);function EmailEngagementCardSpec(){_super.apply(this,arguments);this.displayName="EmailEngagementCard";this.listenToProperties=["ShowSummary","OpenCount","ReplyCount","LastActivityDate"]}EmailEngagementCardSpec.prototype.renderSummaryItem=function(itemText,itemValue,itemSymbolName){var summaryItemIcon=FontIcon.FontIcon({symbolName:itemSymbolName,className:"summary-item-icon"}),summaryItemText=React.DOM.div({key:itemText+"Text",className:"summary-item-text"},itemText),summaryItemValue=React.DOM.span({className:"summary-item-value"},itemValue);return React.DOM.div({key:itemText+"Key",className:"summary-item"},[summaryItemValue,summaryItemIcon,summaryItemText])};EmailEngagementCardSpec.prototype.renderSummary=function(){var summary=[this.renderSummaryItem(this.props.dataContext.get_OpensLabel(),this.props.dataContext.get_OpenCount(),"EEMail"),this.renderSummaryItem(this.props.dataContext.get_RepliesLabel(),this.props.dataContext.get_ReplyCount(),"EEReply")];return React.DOM.div({key:"summary",className:"summary-items"},summary)};EmailEngagementCardSpec.prototype.handleViewAllActivitiesLinkClick=function(e){this.props.dataContext.viewAllActivitiesLinkClick()};EmailEngagementCardSpec.prototype.renderViewAllActivitiesLink=function(){var link=React.DOM.a({"data-id":"viewAllActivitiesLink",className:"viewAllLink",onClick:this.handleViewAllActivitiesLinkClick},this.props.dataContext.get_ViewInCRMLabel());return React.DOM.div({key:"viewAllActivitiesLink",className:"viewAllLinkContainer"},link)};EmailEngagementCardSpec.prototype.render=function(){if(this.props.dataContext.get_ShowSummary()){var title=React.DOM.div({key:"EmailMonitoringTitle",className:"title"},this.props.dataContext.get_HeaderLabel()),lastActivityDate=React.DOM.div({key:"LastActivityLabel",className:"lastActivity"},this.props.dataContext.get_LastActivityLabel());return React.DOM.div({key:"EmailEngagementContainer"},[title,this.renderSummary(),lastActivityDate,this.renderViewAllActivitiesLink()])}else return null};return EmailEngagementCardSpec}(TsAdapter.SpecBase);exports.EmailEngagementCard=DataWrapperComponent.wrapComponent(new EmailEngagementCardSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/RegardingObjectCard",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/RootView","Components/Primitives/ProgressIndicator","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,RootView,ProgressIndicator,FontIcon){var RegardingObjectCardSpec=function(_super){__extends(RegardingObjectCardSpec,_super);function RegardingObjectCardSpec(){_super.apply(this,arguments);this.displayName="RegardingObjectCard";this.listenToProperties=["ModelContext","UnableToLoadItem"]}RegardingObjectCardSpec.prototype.renderProgressIndicator=function(){return ProgressIndicator.ProgressIndicator({key:"progress",active:true,type:ProgressIndicator.ProgressIndicatorType.Bar,className:"regardingObjectcardLoadingIndicator"})};RegardingObjectCardSpec.prototype.renderDisplayName=function(){var _this=this;return React.DOM.div({className:"section_control noLabel",onClick:function(){_this.props.dataContext.openRegardedEntity()}},React.DOM.div({className:"popOutLinkLabel"},React.DOM.span({key:"card_header_primaryfield",className:"card_header_primaryfield"},[this.props.dataContext.get_RegardingObjectDisplayName()])))};RegardingObjectCardSpec.prototype.renderTitle=function(){return React.DOM.div({key:"section_label",className:"section_label"},React.DOM.label({},this.props.dataContext.get_Title()))};RegardingObjectCardSpec.prototype.renderTemporaryCard=function(isLoading){return React.DOM.div({className:"section_vertical section record_card_content "+this.props.dataContext.get_RegardingObjectType()},[this.renderTitle(),this.renderDisplayName(),isLoading?this.renderProgressIndicator():null])};RegardingObjectCardSpec.prototype.renderRegardingIcon=function(){return React.DOM.div({className:"regarding-icon"},FontIcon.FontIcon({symbolName:"LinkArticle"}))};RegardingObjectCardSpec.prototype.render=function(){if(!this.props.dataContext)return null;var prefixComponents=[];prefixComponents.push(this.renderRegardingIcon());if(this.props.dataContext.get_ModelContext()){this.props.dataContext.updateFieldsVisibility();return RootView.RootView({key:"RootView-regardingObjectCard",clientContext:this.props.clientContext,dataContext:this.props.dataContext,prefixComponents:prefixComponents})}else{var isLoading=this.props.dataContext.get_UnableToLoadItem()==false;prefixComponents.push(this.renderTemporaryCard(isLoading));return React.DOM.div({key:"RootView-regardingObjectCard",className:"RootView-regardingObjectCard"},prefixComponents)}};return RegardingObjectCardSpec}(TsAdapter.SpecBase);exports.RegardingObjectCard=DataWrapperComponent.wrapComponent(new RegardingObjectCardSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/TabsControl/IconControl",["require","exports","Core/ReactTypescriptAdapter","Utils/CssClassSet","Components/Primitives/FontIcon","Components/Primitives/EntityFontIcon"],function(require,exports,TsAdapter,CssClassSet,FontIcon,EntityFontIcon){exports.DESCRIPTOR_NAME="IconControl";var IconControlSpec=function(_super){__extends(IconControlSpec,_super);function IconControlSpec(){_super.apply(this,arguments);this.displayName="IconControl";this.textClassName="text";this.iconClassName="icon"}IconControlSpec.prototype.getInitials=function(fullname){var initials="";if(fullname){for(var nameParts=fullname.split(" "),i=0;i<nameParts.length&&initials.length<2;i++)if(nameParts[i].length>0){var chr=nameParts[i].charCodeAt(0);if(chr>=97&&chr<=122||chr>=65&&chr<=90)initials+=nameParts[i].charAt(0).toUpperCase()}if(initials.length<=1){initials="";for(var j=0;j<fullname.length&&initials.length<2;j++){var char=fullname.charCodeAt(j);if(char>=97&&char<=122||char>=65&&char<=90)initials+=fullname.charAt(j).toUpperCase()}}}return initials};IconControlSpec.prototype.getColorId=function(fullname,initials){var colorsCount=15;if(initials){for(var s=0,k=fullname.length-1;k>=0;k--){var o=fullname.charCodeAt(k),e=k%8;s^=(o<<e)+(o>>8-e)}return s%colorsCount+1}return null};IconControlSpec.prototype.renderFontIcon=function(){if(this.props.isEntityFontIcon)return EntityFontIcon.EntityFontIcon({key:"fontIcon",entityName:this.props.symbolClassName,className:this.iconClassName});else return FontIcon.FontIcon({key:"fontIcon",symbolName:this.props.symbolClassName,className:this.iconClassName})};IconControlSpec.prototype.renderIcon=function(){if(this.props.imageURL)return React.DOM.img({key:"image",ref:"image",src:this.props.imageURL,className:this.iconClassName});if(this.props.initialsText){var initials=this.getInitials(this.props.initialsText);if(initials){var colorId=this.getColorId(this.props.initialsText,initials),colorClass="icon-bg-color"+colorId;return React.DOM.div({key:"initials",className:CssClassSet(null,"initials-icon",colorClass,this.iconClassName)},initials)}}if(this.props.symbolClassName)return this.renderFontIcon()};IconControlSpec.prototype.renderText=function(){return React.DOM.div({key:"text",className:this.textClassName},this.props.text)};IconControlSpec.prototype.render=function(){var children=[],icon=this.renderIcon();icon&&children.push(icon);this.props.text&&children.push(this.renderText());return React.DOM.div({className:this.props.className,title:this.props.tooltip||this.props.text},children)};return IconControlSpec}(TsAdapter.SpecBase);exports.IconControl=TsAdapter.createComponent(new IconControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/HorizontalScroll",["require","exports","Core/ReactTypescriptAdapter","Utils/CssClassSet","Core/Binding/WindowResizeHandlerMixin","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,CssClassSet,WindowResizeHandler,FontIcon){exports.DESCRIPTOR_NAME="HorizontalScroll";var HorizontalScrollSpec=function(_super){__extends(HorizontalScrollSpec,_super);function HorizontalScrollSpec(){_super.apply(this,arguments);this.displayName="HorizontalScroll";this.mixins=[WindowResizeHandler.Mixin]}HorizontalScrollSpec.prototype.getInitialState=function(){return {anchorElement:this.props.startElementIndex||0,dragging:false,startX:0,swipeLength:0,elementWidth:50,elementsCount:1,visibleElementsCount:1}};HorizontalScrollSpec.prototype.handleWindowResize=function(){this._setVisisibleElementsCount()};HorizontalScrollSpec.prototype.componentDidMount=function(){this._ensureScroll()};HorizontalScrollSpec.prototype.componentDidUpdate=function(){var elements=this.refs["scrollElementWrapper"].children;if(elements.length==this.state.elementsCount)return;this._ensureScroll()};HorizontalScrollSpec.prototype._ensureScroll=function(){var wrapperNode=this.refs["scrollElementWrapper"],elements=wrapperNode.children,elementNode=$(elements[0]),elementWidth=elementNode.outerWidth(true),elementsCount=elements.length,visibleElementsCount=this._calculateVisibleElementCount(),adjustedStartAnchorElement=this.state.anchorElement+visibleElementsCount>elementsCount?elementsCount-visibleElementsCount>0?elementsCount-visibleElementsCount:0:this.state.anchorElement;this.setState({elementWidth:elementWidth,elementsCount:elements.length,visibleElementsCount:visibleElementsCount,anchorElement:adjustedStartAnchorElement})};HorizontalScrollSpec.prototype._isMouseUsed=function(){var userAgent=this.props.clientContext.userAgent;return !userAgent.get_TouchSupported()||!(userAgent.get_IsIOS()||userAgent.get_IsAndroid()||userAgent.get_IsIPhone()||userAgent.get_IsWinPhone()||userAgent.get_IsAndroidPhone()||userAgent.get_PhoneURLParameter())};HorizontalScrollSpec.prototype._calculateVisibleElementCount=function(){for(var wrapperNode=this.refs["scrollElementWrapper"],scrollTouchWrapperNode=$(this.refs["scrollTouchWrapper"]),elements=wrapperNode.children,innerWidth=scrollTouchWrapperNode.width(),visibleElementsCount=0,accumulatedWidth=0,i=0;i<elements.length;i++){var element=$(elements[i]),width=element.outerWidth(true);if(accumulatedWidth+width<innerWidth){accumulatedWidth+=width;visibleElementsCount++}else break}return visibleElementsCount};HorizontalScrollSpec.prototype._setVisisibleElementsCount=function(){var visibleElementsCount=this._calculateVisibleElementCount();this.setState({visibleElementsCount:visibleElementsCount})};HorizontalScrollSpec.prototype.swipeStart=function(e){var posX;if(e.type.indexOf("mouse")!==-1)return;posX=e.touches!==undefined?e.touches[0].pageX:e.clientX;this.setState({dragging:true,startX:posX,swipeLength:0})};HorizontalScrollSpec.prototype.swipeMove=function(e){var curruentX,currentSwipeLength;if(!this.state.dragging)return;curruentX=e.touches?e.touches[0].pageX:e.clientX;currentSwipeLength=Math.round(curruentX-this.state.startX);this.setState({startX:curruentX,swipeLength:this.state.swipeLength+currentSwipeLength})};HorizontalScrollSpec.prototype.swipeEnd=function(){var deltaAnchorElement,newAnchorElement,maxLastAnchor;deltaAnchorElement=Math.round(this.state.swipeLength/this.state.elementWidth);maxLastAnchor=this.state.elementsCount-this.state.visibleElementsCount>0?this.state.elementsCount-this.state.visibleElementsCount:0;newAnchorElement=this.state.anchorElement-deltaAnchorElement;newAnchorElement=newAnchorElement<0?0:newAnchorElement;newAnchorElement=maxLastAnchor<newAnchorElement?maxLastAnchor:newAnchorElement;this.setState({dragging:false,anchorElement:newAnchorElement,startX:0,swipeLength:0})};HorizontalScrollSpec.prototype.slideNext=function(e){var newAnchorElement=this.state.anchorElement+this.state.visibleElementsCount,maxLastAnchor=this.state.elementsCount-this.state.visibleElementsCount>0?this.state.elementsCount-this.state.visibleElementsCount:0;newAnchorElement=maxLastAnchor>newAnchorElement?newAnchorElement:maxLastAnchor;this.setState({anchorElement:newAnchorElement});e.stopPropagation()};HorizontalScrollSpec.prototype.slidePrev=function(e){var newAnchorElement=this.state.anchorElement-this.state.visibleElementsCount;newAnchorElement=newAnchorElement<0?0:this.state.anchorElement-this.state.visibleElementsCount;this.setState({anchorElement:newAnchorElement});e.stopPropagation()};HorizontalScrollSpec.prototype._generateScrollInnerComponents=function(){var elementsWrapperPosition=-1*this.state.anchorElement*this.state.elementWidth;if(this.state.dragging){elementsWrapperPosition+=this.state.swipeLength;var delta=Math.round(Math.log(Math.abs(elementsWrapperPosition))*Math.sqrt(Math.abs(elementsWrapperPosition)/this.state.elementWidth)),leftLimit=10+delta,rightLimit=-1*(this.state.elementWidth*(this.state.elementsCount-this.state.visibleElementsCount)+10+delta);elementsWrapperPosition=elementsWrapperPosition>leftLimit?leftLimit:elementsWrapperPosition;elementsWrapperPosition=elementsWrapperPosition<rightLimit?rightLimit:elementsWrapperPosition}var elementsWrapper=React.DOM.div({key:"scrollElementWrapper",ref:"scrollElementWrapper",className:this.state.dragging?"scroll-elements-wrapper-dragging":"scroll-elements-wrapper",style:{left:elementsWrapperPosition+"px"}},this.props.children),scrollWrapper=React.DOM.div({key:"scrollInner",className:"scroll-inner"},elementsWrapper),touchWrapper=React.DOM.div({key:"scrollTouchWrapper",ref:"scrollTouchWrapper",onTouchStart:this.swipeStart,onTouchMove:this.state.dragging?this.swipeMove:null,onTouchEnd:this.swipeEnd,onTouchCancel:this.state.dragging?this.swipeEnd:null,className:"scroll-touch-wrapper"},scrollWrapper);return touchWrapper};HorizontalScrollSpec.prototype.render=function(){var content=[],isLeftArrowActive=this.state.anchorElement!==0,isRightArrowActive=this.state.elementsCount-this.state.visibleElementsCount>0&&this.state.anchorElement+this.state.visibleElementsCount<this.state.elementsCount,arrowsAreVisible=(isLeftArrowActive||isRightArrowActive)&&this._isMouseUsed();if(this._isMouseUsed()){var nextArrow=React.DOM.div({key:"scrollNextArrow",className:CssClassSet({active:isRightArrowActive,disabled:!isRightArrowActive},"scroll-arrow","next"),onClick:isRightArrowActive?this.slideNext:null},FontIcon.FontIcon({symbolName:"RightArrowHead",className:"icon"})),prevArrow=React.DOM.div({key:"scrollPrevArrow",className:CssClassSet({active:isLeftArrowActive,disabled:!isLeftArrowActive},"scroll-arrow","prev"),onClick:isLeftArrowActive?this.slidePrev:null},FontIcon.FontIcon({symbolName:"LeftArrowHead",className:"icon"}));content=[prevArrow,this._generateScrollInnerComponents(),nextArrow]}else content=[this._generateScrollInnerComponents()];return React.DOM.div({key:"scrollWrapper",className:CssClassSet({noArrows:!this._isMouseUsed()},"scroll-wrapper",this.props.className)},content)};return HorizontalScrollSpec}(TsAdapter.SpecBase);exports.HorizontalScroll=TsAdapter.createComponent(new HorizontalScrollSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/TabsControl/TabsControl",["require","exports","Core/ReactTypescriptAdapter","Components/MailApp/TabsControl/IconControl","Utils/CssClassSet","Components/MailApp/HorizontalScroll"],function(require,exports,TsAdapter,IconControl,CssClassSet,HorizontalScroll){exports.DESCRIPTOR_NAME="TabsControl";var TabsControlSpec=function(_super){__extends(TabsControlSpec,_super);function TabsControlSpec(){_super.apply(this,arguments);this.displayName="TabsControl"}TabsControlSpec.prototype.getInitialState=function(){var selectedTabId="";if(this.props.tabsList&&this.props.tabsList.length>0)if(this.props.selectedTabId)selectedTabId=this.props.selectedTabId;else if(this.props.selectedTabId===undefined){var firstTab=this.props.tabsList[0];selectedTabId=firstTab&&firstTab.id}return {selectedTabId:selectedTabId}};TabsControlSpec.prototype.componentWillReceiveProps=function(nextProps){this.props.selectedTabId!==null&&this.state.selectedTabId!==nextProps.selectedTabId&&this.setState({selectedTabId:nextProps.selectedTabId})};TabsControlSpec.prototype.getTab=function(tabProps,tabIndex){var icon=IconControl.IconControl({className:tabProps.className,text:tabProps.text,tooltip:tabProps.tooltip,imageURL:tabProps.imageURL,initialsText:tabProps.initialsText,symbolClassName:tabProps.symbolClassName,isEntityFontIcon:tabProps.isEntityFontIcon}),tabsControl=this;return React.DOM.div({key:"tabContainer_"+tabIndex,className:CssClassSet({"tab-container":true,selected:tabsControl.state.selectedTabId===tabProps.id}),onClick:function(e){tabsControl.setState({selectedTabId:tabProps.id});tabProps.onClick&&tabProps.onClick(e,tabProps)}},icon)};TabsControlSpec.prototype.render=function(){var _this=this,selectedTabIndex=0,tabs=(this.props.tabsList||[]).map(function(tabProps,tabIndex){_this.state.selectedTabId===tabProps.id&&(selectedTabIndex=tabIndex);return _this.getTab(tabProps,tabIndex)});return HorizontalScroll.HorizontalScroll({className:this.props.className,startElementIndex:selectedTabIndex,clientContext:this.props.clientContext},tabs)};return TabsControlSpec}(TsAdapter.SpecBase);exports.TabsControl=TsAdapter.createComponent(new TabsControlSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/TabBar",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/MailApp/TabsControl/TabsControl"],function(require,exports,TsAdapter,DataWrapperComponent,TabsControl){exports.DESCRIPTOR_NAME="TabBar";var TabBarSpec=function(_super){__extends(TabBarSpec,_super);function TabBarSpec(){_super.apply(this,arguments);this.displayName="TabBar";this.listenToProperties=["TabItems"]}TabBarSpec.prototype.onTabItemClicked=function(e,tabProps){var index=Number(tabProps.id);this.props.dataContext.TabItemClick(index)};TabBarSpec.prototype.getTabControlItems=function(){var tabBarItems=this.props.dataContext.get_TabItems();if(!tabBarItems||tabBarItems.length===0)return null;for(var tabControlItems=[],i=0;i<tabBarItems.length;i++){var tabBarItem=tabBarItems[i],tabControlItem={id:i.toString(),imageURL:tabBarItem.get_ImageUrl(),text:tabBarItem.get_Text(),initialsText:tabBarItem.get_InitialsText(),tooltip:tabBarItem.get_Tooltip(),symbolClassName:tabBarItem.get_SymbolClassName(),isEntityFontIcon:tabBarItem.get_IsEntityFontIcon(),onClick:this.onTabItemClicked,className:tabBarItem.get_ClassName()};tabControlItems.push(tabControlItem)}return tabControlItems};TabBarSpec.prototype.render=function(){var tabControlItems=this.getTabControlItems();if(!tabControlItems)return null;var tabsControls=TabsControl.TabsControl({tabsList:tabControlItems,selectedTabId:this.props.dataContext.get_SelectedIndex()==-1?null:this.props.dataContext.get_SelectedIndex().toString(),clientContext:this.props.clientContext});return tabsControls};return TabBarSpec}(TsAdapter.SpecBase);exports.TabBar=DataWrapperComponent.wrapComponent(new TabBarSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/StatusMessage/StatusMessage",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ProgressIndicator","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,ProgressIndicator,FontIcon){var StatusMessageSpec=function(_super){__extends(StatusMessageSpec,_super);function StatusMessageSpec(){_super.apply(this,arguments);this.displayName="StatusMessage";this.listenToProperties=["Message","State"]}StatusMessageSpec.prototype.render=function(){var state=this.props.dataContext.get_State(),indicator;switch(state){case 2:indicator=FontIcon.FontIcon({symbolName:"Error"});break;case 3:indicator=FontIcon.FontIcon({symbolName:"Success"});break;case 1:indicator=ProgressIndicator.ProgressIndicator({key:"progressRing",className:"progressRing",active:true,type:ProgressIndicator.ProgressIndicatorType.Ring});break}var children=[React.DOM.span({className:"message"},this.props.dataContext.get_Message())];indicator&&children.push(React.DOM.div({key:"statusIndicator",className:"statusIndicator"},indicator));return React.DOM.div({className:"statusMessage"},children)};return StatusMessageSpec}(TsAdapter.SpecBase);exports.StatusMessage=DataWrapperComponent.wrapComponent(new StatusMessageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/StatusMessage/StatusMessagesContainer",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/MailApp/StatusMessage/StatusMessage","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,StatusMessage,CssClassSet){var StatusMessagesContainerSpec=function(_super){__extends(StatusMessagesContainerSpec,_super);function StatusMessagesContainerSpec(){_super.apply(this,arguments);this.displayName="StatusMessagesContainer";this.listenToProperties=["StatusCollectionChanged"]}StatusMessagesContainerSpec.prototype.render=function(){for(var children=[],index=0;index<this.props.dataContext.get_Collection().length;index++)children.push(StatusMessage.StatusMessage({key:"statusMessage"+index,clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Collection()[index]}));return React.DOM.div({key:"statusMessagesContainer",className:CssClassSet(null,"statusMessagesContainer",this.props.className)},children)};return StatusMessagesContainerSpec}(TsAdapter.SpecBase);exports.StatusMessagesContainer=DataWrapperComponent.wrapComponent(new StatusMessagesContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/Follow",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Primitives/Button","Components/Primitives/FontIcon","Components/MailApp/PopOutLinkLabel","Components/MailApp/StatusMessage/StatusMessagesContainer"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,Button,FontIcon,PopOutLinkLabel,StatusMessagesContainer){var FollowSpec=function(_super){__extends(FollowSpec,_super);function FollowSpec(){_super.apply(this,arguments);this.displayName="Follow";this.listenToProperties=["State","Loading"]}FollowSpec.prototype.componentWillMount=function(){this.props.dataContext.tabActivated()};FollowSpec.prototype.componentWillUnmount=function(){this.props.dataContext.ClearState()};FollowSpec.prototype.handleFollowButtonClick=function(){this.props.dataContext.HandleFollowButtonClick()};FollowSpec.prototype.renderTitle=function(){return React.DOM.div({key:"emailFollowTitle",className:"emailFollowTitle"},React.DOM.span({},this.props.dataContext.get_TitleText()))};FollowSpec.prototype.renderButton=function(){return React.DOM.div({key:"followAction",className:"followAction"},Button.Button({key:"emailFollowButton",className:CssClassSet({dynamicsButton:true,emailFollowButton:true}),onClick:this.props.dataContext.get_IsFollowButtonEnabled()?this.handleFollowButtonClick:null,enabled:this.props.dataContext.get_IsFollowButtonEnabled()},this.props.dataContext.get_FollowButtonText()))};FollowSpec.prototype.renderRestrictedRecipientsList=function(){var list=this.props.dataContext.get_RecipientsList();if(list.length>0){for(var container=[],i=0;i<list.length;i++)container.push(PopOutLinkLabel.PopOutLinkLabel({clientContext:this.props.clientContext,dataContext:list[i],descriptor:{__type:null,TypeName:null,ChildControlViewDescriptors:null,Properties:{PopOutLinkLabelCommandName:"OpenInBrowserCommand"}}}));return React.DOM.div({key:"listContainer",className:"listContainer"},container)}return null};FollowSpec.prototype.renderRestrictedRecipients=function(){var header=React.DOM.div({key:"emailFollowRestrictedRecipientsTitle",className:"title"},React.DOM.span({},this.props.dataContext.get_RestrictedRecipientsHeaderText()));return React.DOM.div({key:"recipientsList",className:"recipientsList"},[header,this.renderRestrictedRecipientsList()])};FollowSpec.prototype.renderRecommendationLink=function(){var linkText=this.props.dataContext.get_RecommendationLinkText(),anchor=React.DOM.a({href:this.props.dataContext.get_RecommendationLink(),title:linkText,target:"_blank"},React.DOM.span({},linkText));return React.DOM.div({key:"RecommendationLink",className:"popOutLinkLabel"},anchor)};FollowSpec.prototype.renderRecommendation=function(){var children=[],textChildren=[];children.push(React.DOM.div({key:"RecommendationIcon",className:"iconContainer"},FontIcon.FontIcon({symbolName:"Exclamation"})));textChildren.push(React.DOM.div({key:"RecommendationText",className:"recommendationText"},React.DOM.span({},this.props.dataContext.get_RecommendationText())));this.props.dataContext.get_RecommendationLink()&&textChildren.push(this.renderRecommendationLink());children.push(React.DOM.div({key:"textContainer",className:"textContainer"},textChildren));return React.DOM.div({key:"emailFollowRecommendation",className:"emailFollowRecommendation"},children)};FollowSpec.prototype.render=function(){var children=[];children.push(this.renderTitle());children.push(StatusMessagesContainer.StatusMessagesContainer({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_StatusMessagesContainer()}));this.props.dataContext.get_RecommendationText()&&children.push(this.renderRecommendation());this.props.dataContext.get_IsFollowButtonVisible()&&children.push(this.renderButton());this.props.dataContext.get_IsRestricted()&&children.push(this.renderRestrictedRecipients());return React.DOM.div({key:"followContainer",className:CssClassSet({emailFollowContainer:true},this.props.className)},React.DOM.div({key:"emailFollow",className:"emailFollow"},children))};return FollowSpec}(TsAdapter.SpecBase);exports.Follow=DataWrapperComponent.wrapComponent(new FollowSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppSimpleConductor",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/RootView","Components/Common/EditRootView","Components/MailApp/EmailTemplates","Components/MailApp/Follow"],function(require,exports,TsAdapter,DataWrapperComponent,RootView,EditRootView,EmailTemplates,Follow){var viewModelToComponentMap={"Microsoft.Crm.Client.Core.ViewModels.RootViewModel":RootView.RootView,"Microsoft.Crm.Client.Core.ViewModels.EditRootViewModel":EditRootView.EditRootView,"Microsoft.Crm.Client.Core.ViewModels.MailApp.EmailTemplatesRootViewModel":EmailTemplates.EmailTemplates,"Microsoft.Crm.Client.Core.ViewModels.MailApp.FollowViewModel":Follow.Follow};function resolveViewModelNameToComponentFactory(viewModelName){return viewModelToComponentMap[viewModelName]}var MailAppSimpleConductorSpec=function(_super){__extends(MailAppSimpleConductorSpec,_super);function MailAppSimpleConductorSpec(){_super.apply(this,arguments);this.displayName="MailAppSimpleConductor";this.listenToProperties=["Top"]}MailAppSimpleConductorSpec.prototype.findComponentForType=function(type){if(!type)return null;var factory=resolveViewModelNameToComponentFactory(type.getName());if(factory)return factory;return this.findComponentForType(type.getBaseType())};MailAppSimpleConductorSpec.prototype.render=function(){var children=[],stack=this.props.dataContext.get_ActiveNavigationStack(),length=stack.get_Count();if(length==0)return null;var viewModel=stack.getItem(length-1),factory=this.findComponentForType(Object.getType(viewModel));return factory({key:viewModel.get_ViewModelId(),clientContext:this.props.clientContext,dataContext:viewModel,className:"conductorContent"})};return MailAppSimpleConductorSpec}(TsAdapter.SpecBase);exports.MailAppSimpleConductor=DataWrapperComponent.wrapComponent(new MailAppSimpleConductorSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppShell",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Utils/Animator","Components/Shell/Conductor","Components/Shell/DialogConductor","Components/Shell/Shell","Components/MailApp/MailAppUserEducation","Components/MailApp/TrackBar","Components/MailApp/LoadingPopup","Components/MailApp/EmailEngagementCard","Components/MailApp/RegardingObjectCard","Components/MailApp/TabBar","Components/MailApp/MailAppSimpleConductor","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,Animator,Conductor,DialogConductor,Shell,MailAppUserEducation,TrackBar,LoadingPopup,EmailEngagementCard,RegardingObjectCard,TabBar,MailAppSimpleConductor,FontIcon){var MailAppShellSpec=function(_super){__extends(MailAppShellSpec,_super);function MailAppShellSpec(){_super.apply(this,arguments);this.displayName="MailAppShell";this.listenToProperties=["CanvasConductor","DialogConductor","RegardingRecordCardViewModel","IsSetRegardingDisplayedAsHomepage","IsCanvasConductorShouldBeDisplayed"]}MailAppShellSpec.prototype.componentDidMount=function(){this.props.dataContext.apcl("IsSetRegardingOpened",this.onIsSetRegardingOpenedChanged);this.props.dataContext.apcl("ComposeActionsVisibilityChanged",this.onIsComposeActionVisibleChanged)};MailAppShellSpec.prototype.componentWillUnmount=function(){this.props.dataContext.rpcl("IsSetRegardingOpened",this.onIsSetRegardingOpenedChanged);this.props.dataContext.rpcl("ComposeActionsVisibilityChanged",this.onIsComposeActionVisibleChanged)};MailAppShellSpec.prototype.onIsSetRegardingOpenedChanged=function(){var isSetRegardingOpened=this.props.dataContext&&this.props.dataContext.get_IsSetRegardingOpened();isSetRegardingOpened!=this.state.isSetRegardingOpened&&this.setState({isComposeActionsVisible:this.state.isComposeActionsVisible,isSetRegardingOpened:isSetRegardingOpened})};MailAppShellSpec.prototype.onIsComposeActionVisibleChanged=function(){var isComposeActionsVisible=this.isComposeActionsVisible();isComposeActionsVisible!=this.state.isComposeActionsVisible&&this.setState({isComposeActionsVisible:isComposeActionsVisible,isSetRegardingOpened:this.state.isSetRegardingOpened})};MailAppShellSpec.prototype.componentDidUpdate=function(prevProps,prevState){var contentContainer=this.refs["contentContainer"],detailsSection=this.refs["detailsSection"],actionsCanvasContainer=this.refs["actionsSection"];if(prevState&&prevState.isSetRegardingOpened!=this.state.isSetRegardingOpened)if(!this.state.isSetRegardingOpened){if(actionsCanvasContainer&&this.state.isComposeActionsVisible){actionsCanvasContainer.classList.add("visible");detailsSection.classList.remove("visible")}else{actionsCanvasContainer&&actionsCanvasContainer.classList.remove("visible");detailsSection.classList.add("visible")}Animator.animate(contentContainer,"enterPage").then(function(){})}if(prevState&&actionsCanvasContainer&&prevState.isComposeActionsVisible!=this.state.isComposeActionsVisible){var recipientsSectionHeader=this.refs["recipientsSectionHeader"];if(this.state.isComposeActionsVisible){actionsCanvasContainer.classList.add("visible");detailsSection.classList.remove("visible")}else{actionsCanvasContainer.classList.remove("visible");detailsSection.classList.add("visible")}}};MailAppShellSpec.prototype.isComposeActionsVisible=function(){return this.props.clientContext.userAgent.get_IsMailAppComposeMode()&&this.props.dataContext&&this.props.dataContext.get_ActionsCanvasConductor()&&this.props.dataContext.get_ActionsCanvasConductor().get_Visible()};MailAppShellSpec.prototype.getInitialState=function(){return {isComposeActionsVisible:this.isComposeActionsVisible(),isSetRegardingOpened:this.props.dataContext&&this.props.dataContext.get_IsSetRegardingOpened()}};MailAppShellSpec.prototype.onClickCollapsedRecipientsSectionHeader=function(){this.setState({isComposeActionsVisible:false,isSetRegardingOpened:this.state.isSetRegardingOpened});this.props.dataContext.collapseActions()};MailAppShellSpec.prototype.renderEmailEngagementCard=function(){return React.DOM.div({key:"emailengagementcard",id:"emailEngagementCard",className:CssClassSet({emailEngagementCard:true,mailAppCard:true})},EmailEngagementCard.EmailEngagementCard({dataContext:this.props.dataContext.get_EmailEngagementCardViewModel(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderRegardingObjectCard=function(){if(!this.props.dataContext.get_RegardingRecordCardViewModel())return null;return React.DOM.div({key:"regardingObjectCard",id:"regardingObjectCard",className:CssClassSet({regardingObjectCard:true,mailAppCard:true})},RegardingObjectCard.RegardingObjectCard({dataContext:this.props.dataContext.get_RegardingRecordCardViewModel(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderRecipientsTabBar=function(){return React.DOM.div({key:"recipientstabbar",id:"RecipientsTabBarContainer",className:"recipientsTabBarContainer"},TabBar.TabBar({dataContext:this.props.dataContext.get_RecipientsTabBarViewModel(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderCanvasConductor=function(){return React.DOM.div({key:"canvasContainer",className:CssClassSet({canvasContainer:true,setRegardingDisplayedAsHomepage:this.props.dataContext.get_IsSetRegardingDisplayedAsHomepage()})},Conductor.Conductor({key:"canvas",id:"PrimaryConductor",className:"primaryConductor",dataContext:this.props.dataContext.get_CanvasConductor(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderRecipientsHeader=function(label){var headerLabel=React.DOM.span({key:"recipientsheader",id:"recipientsHeader",className:"recipientsHeaderText"},label);return React.DOM.div({key:"recipientsHeaderContainer",className:"recipientsHeaderContainer"},headerLabel)};MailAppShellSpec.prototype.renderActionsTabBar=function(){return React.DOM.div({key:"composeactionstabbar",id:"composeActionsTabBarContainer",className:CssClassSet({composeActionsTabBarContainerCollapsed:!this.isComposeActionsVisible()},"composeActionsTabBarContainer")},TabBar.TabBar({dataContext:this.props.dataContext.get_ComposeActionsTabBarViewModel(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderCollapsedRecipientsSectionHeader=function(){var iconContainer=React.DOM.div({className:"iconContainer"},[FontIcon.FontIcon({symbolName:"UpArrowHead"})]);return React.DOM.div({className:"recipientsSectionHeader",ref:"recipientsSectionHeader",onClick:this.onClickCollapsedRecipientsSectionHeader},[this.renderRecipientsHeader(this.props.dataContext.get_CollapsedRecipientsHeader()),iconContainer])};MailAppShellSpec.prototype.renderRecipientsSection=function(){return React.DOM.div({className:"recipientsSection",ref:"recipientsSection",key:"recipientsSection"},[this.renderRecipientsHeader(this.props.dataContext.get_RecipientsHeader()),this.renderRecipientsTabBar(),this.renderCanvasConductor()])};MailAppShellSpec.prototype.rednerActionsCanvas=function(){return React.DOM.div({key:"actionsCanvasContainer",ref:"actionsSection",className:CssClassSet({visible:this.isComposeActionsVisible()},"actionsCanvasContainer")},MailAppSimpleConductor.MailAppSimpleConductor({dataContext:this.props.dataContext.get_ActionsCanvasConductor(),clientContext:this.props.clientContext}))};MailAppShellSpec.prototype.renderReadMode=function(){var children=[this.renderEmailEngagementCard(),this.renderRegardingObjectCard()];this.props.dataContext.get_IsCanvasConductorShouldBeDisplayed()&&children.push(this.renderRecipientsSection());return React.DOM.div({className:"detailsSection visible",key:"detailsSection",ref:"detailsSection"},children)};MailAppShellSpec.prototype.renderEmailComposeMode=function(){var children=[];if(this.props.dataContext.get_IsSetRegardingOpened())children.push(this.renderCanvasConductor());else{children.push(this.renderActionsTabBar());children.push(this.rednerActionsCanvas());children.push(React.DOM.div({className:CssClassSet({visible:!this.isComposeActionsVisible()},"detailsSection"),key:"detailsSection",ref:"detailsSection"},[this.renderRegardingObjectCard(),this.renderRecipientsSection()]));this.isComposeActionsVisible()&&children.push(this.renderCollapsedRecipientsSectionHeader())}return children};MailAppShellSpec.prototype.isComposeModeShouldBeDisplayed=function(){if(this.props.clientContext.userAgent.get_IsMailAppComposeMode())return !this.props.dataContext.get_IsAppointmentOfficeItemType();return false};MailAppShellSpec.prototype.renderMainContainer=function(){var trackbar=React.DOM.div({key:"trackBarContainer",id:"TrackBarContainer",className:"trackBarContainer"},TrackBar.TrackBar({dataContext:this.props.dataContext.get_TrackBarViewModel(),clientContext:this.props.clientContext,isSetRegardingOpened:this.props.dataContext.get_IsSetRegardingOpened()})),children=[];if(this.isComposeModeShouldBeDisplayed())children=children.concat(this.renderEmailComposeMode());else children.push(this.renderReadMode());var contentContainer=React.DOM.div({key:"contentContainer",ref:"contentContainer",id:"contentContainer",className:"contentContainer"},children);return React.DOM.div({key:"mainContainer",className:"mainContainer"},[trackbar,contentContainer])};MailAppShellSpec.prototype.renderDialogConductor=function(){var children=[React.DOM.div({key:"dialog",className:"dialog"}),React.DOM.span({key:"close",className:"closeBtn symbolFont Close-symbol",href:"javascript:void(0);"}),DialogConductor.DialogConductor({key:"dialogconductor",dataContext:this.props.dataContext.get_DialogConductor(),clientContext:this.props.clientContext})];return React.DOM.div({key:"dialogConductor",className:"dialogConductor"},React.DOM.div({className:"dialogWrapper"},children))};MailAppShellSpec.prototype.render=function(){var children=[];children.push(this.renderMainContainer());children.push(this.renderDialogConductor());children.push(LoadingPopup.LoadingPopup({key:"loadingpopup"}));children.push(MailAppUserEducation.MailAppUserEducation({key:"usered"}));return Shell.Shell({dataContext:this.props.dataContext,clientContext:this.props.clientContext,className:CssClassSet({mailAppOutlookMobile:this.props.clientContext.userAgent.get_IsMobilePhone()},"mailApp")},children)};return MailAppShellSpec}(TsAdapter.SpecBase);exports.MailAppShell=DataWrapperComponent.wrapComponent(new MailAppShellSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Mashups/IFrame",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Core/Binding/WindowResizeHandlerMixin","Components/Primitives/ImageButton","Components/Primitives/AncestorMountedHost","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,WindowResizeHandler,ImageButton,AncestorMountedHost,CssClassSet){exports.IFRAME_DESCRIPTOR_NAME="IFrameView";exports.WEB_RESOURCE_DESCRIPTOR_NAME="WebResourceView";exports.POWER_BI_DESCRIPTOR_NAME="PowerBIView";exports.TOP_BUFFER_HEIGHT=40;exports.PIXELS="px";exports.BOTTOM_PADDING=10;var IFrameSpec=function(_super){__extends(IFrameSpec,_super);function IFrameSpec(){_super.apply(this,arguments);this.displayName="IFrame";this.mixins=[WindowResizeHandler.Mixin];this.listenToProperties=["UrlSource","ScrollingBehavior","IsXFrameScriptingRestricted","FrameShouldBeRendered","Visible","OnDemandMashupLoadEnabled","IsServerAvailable","HasFocus"]}IFrameSpec.prototype.getInitialState=function(){return {poppedOut:false}};IFrameSpec.prototype.getPanoramaContainer=function(element){if(!this.panoramaContainer)this.panoramaContainer=element.parents(".panoramaContainer");return this.panoramaContainer};IFrameSpec.prototype.handlePopoverDismiss=function(){var element=$(ReactDOM.findDOMNode(this)),container=this.getPanoramaContainer(element);container.css("-webkit-overflow-scrolling","touch");if(!this.props.clientContext.userAgent.get_IsAndroid())container.css("overflow","scroll");else{var iframeElement=this.refs["iframe"];if(iframeElement&&this.props.descriptor.TypeName===exports.WEB_RESOURCE_DESCRIPTOR_NAME)iframeElement.style.minHeight="initial"}this.setState({poppedOut:false})};IFrameSpec.prototype.handlePopoverCreate=function(){var element=$(ReactDOM.findDOMNode(this)),container=this.getPanoramaContainer(element);container.css("-webkit-overflow-scrolling","auto");if(!this.props.clientContext.userAgent.get_IsAndroid())container.css("overflow","hidden");else{var iframeElement=this.refs["iframe"];if(iframeElement&&this.props.descriptor.TypeName==exports.WEB_RESOURCE_DESCRIPTOR_NAME)iframeElement.style.minHeight=iframeElement.contentDocument.body.offsetHeight+exports.BOTTOM_PADDING+exports.PIXELS}if(this.state.panoramaItemHeight||this.state.panoramaItemHeight===0)this.setState({poppedOut:true,docHeight:document.body.clientHeight,docWidth:document.body.clientWidth});else{var panoramaItem=element.parents(".panoramaItem"),headerVisible=panoramaItem.find(".panoramaItem-title-text").length>0,itemHeight=panoramaItem.height();this.setState({poppedOut:true,docHeight:document.body.clientHeight,docWidth:document.body.clientWidth,headerVisible:headerVisible,panoramaItemHeight:itemHeight})}};IFrameSpec.prototype.stopScrolling=function(e){e.stopPropagation()};IFrameSpec.prototype.shouldShowPopover=function(){return this.props.descriptor&&this.props.descriptor.Properties&&this.props.descriptor.Properties["ShowPopover"]};IFrameSpec.prototype.shouldAutoExpand=function(){if(this.props.descriptor&&this.props.descriptor.Properties){var autoExpand=this.props.descriptor.Properties["AutoExpand"];return !!autoExpand}return false};IFrameSpec.prototype.isMashupScrollEnabled=function(){return this.props.dataContext.get_ScrollingBehavior()!="no"};IFrameSpec.prototype.descriptorHeight=function(){if(this.props.descriptor&&this.props.descriptor.Properties)return this.props.descriptor.Properties["Height"];return null};IFrameSpec.prototype.calculateHeight=function(){if(!this.shouldAutoExpand())return this.descriptorHeight();if(this.props.clientContext.userAgent.get_IsAndroid()&&this.props.descriptor.TypeName!=="PowerBIView")return "100vh";return "100%"};IFrameSpec.prototype.calculateMaxHeight=function(){var windowHeight=this.state.docHeight;return windowHeight-exports.TOP_BUFFER_HEIGHT};IFrameSpec.prototype.calculateTop=function(){var windowHeight=this.state.docHeight,iframeHeight=!this.props.descriptor.Properties["AutoExpand"]?this.descriptorHeight():this.calculateMaxHeight();return iframeHeight>=this.calculateMaxHeight()?exports.TOP_BUFFER_HEIGHT:(windowHeight-iframeHeight)/2<exports.TOP_BUFFER_HEIGHT?exports.TOP_BUFFER_HEIGHT:(windowHeight-iframeHeight)/2};IFrameSpec.prototype.calculateScrolling=function(){var scrollBehavior=this.props.dataContext.get_ScrollingBehavior();if(this.isMashupScrollEnabled())if(this.state.poppedOut)scrollBehavior="auto";else if(this.shouldShowPopover())if(this.props.clientContext.userAgent.get_IsIOS())scrollBehavior="no";return scrollBehavior};IFrameSpec.prototype.calculateSecurityAttribute=function(){if(this.props.dataContext.get_IsXFrameScriptingRestricted())return "restricted";return null};IFrameSpec.prototype.calculateSandboxAttribute=function(){if(this.props.dataContext.get_IsXFrameScriptingRestricted())return "allow-forms allow-same-origin";else return "allow-scripts allow-forms allow-same-origin"};IFrameSpec.prototype.updateViewModelIFrameReference=function(){var frame=this.refs["iframe"];frame instanceof HTMLIFrameElement&&this.props.dataContext.set_Element(frame)};IFrameSpec.prototype.getContainerStyle=function(){var style;if(this.state.poppedOut){var windowHeight=this.state.docHeight,iframeHeight=!this.props.descriptor.Properties["AutoExpand"]?this.props.descriptor.Properties["Height"]:this.calculateMaxHeight(),clientWidth=this.state.docWidth,newWidth=this.props.descriptor.Properties["Width"],left=(clientWidth-newWidth)/2,newLeft=left<=0?0:left;style={height:iframeHeight,width:"",left:newLeft,maxHeight:this.calculateMaxHeight()}}else style={height:this.calculateHeight(),width:"",left:"",zIndex:""};return style};IFrameSpec.prototype.onIframeLoad=function(e){this.props.dataContext.onIFrameLoad()};IFrameSpec.prototype.handleWindowResize=function(){this.state.poppedOut&&this.setState({docHeight:WindowResizeHandler.getWindowHeight(),docWidth:WindowResizeHandler.getWindowWidth()})};IFrameSpec.prototype.componentDidMount=function(){this.updateViewModelIFrameReference();this.props.clientContext.isInteractionCentric&&this.setFocus()};IFrameSpec.prototype.componentDidUpdate=function(){this.updateViewModelIFrameReference();this.props.clientContext.isInteractionCentric&&this.setFocus()};IFrameSpec.prototype.componentWillUnmount=function(){this.props.dataContext&&this.props.dataContext.set_Element(null)};IFrameSpec.prototype.setFocus=function(){this.props.dataContext&&this.props.dataContext.get_HasFocus()&&this.props.dataContext.ScrollParentColumn($(ReactDOM.findDOMNode(this)).offset().top,$(ReactDOM.findDOMNode(this)).offset().left)};IFrameSpec.prototype.handleLoadButtonClick=function(){this.props.dataContext.captureOnDemandLoadMemorySnapshot();!this.props.dataContext.get_FrameShouldBeRendered()&&this.props.dataContext.set_FrameShouldBeRendered(true);var iframe=this.refs["iframe"];if(iframe instanceof HTMLIFrameElement)iframe.src=this.props.dataContext.get_UrlSource()};IFrameSpec.prototype.render=function(){if(!this.props.dataContext||!this.props.dataContext.get_Visible())return React.DOM.noscript();var children=[];if(!this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()&&!this.props.dataContext.get_IsOfflineWebResourcesRenderingEnabled()){var noDataMessage=React.DOM.span({key:"noDataMessage",className:"mashUpView_noData"},this.props.dataContext.get_NoDataMessage());children.push(noDataMessage)}else{var iFrame=React.DOM.iframe({ref:"iframe",src:this.props.dataContext.get_UrlSource(),scrolling:this.calculateScrolling(),security:this.calculateSecurityAttribute(),sandbox:this.calculateSandboxAttribute(),onLoad:this.onIframeLoad,style:{height:this.calculateHeight()},className:CssClassSet({iframeWithBorder:this.props.clientContext.isInteractionCentric&&!this.props.dataContext.get_IsWebResource()&&this.props.descriptor.Properties["Border"]})}),container=React.DOM.div({key:"container",ref:"container",style:this.getContainerStyle(),className:CssClassSet({iframeContainerPoppedOut:this.state.poppedOut,hasPopover:this.shouldShowPopover(),mashupScrolling:!this.shouldShowPopover()&&this.isMashupScrollEnabled(),onDemandMashupLoadScroll:this.props.dataContext.get_DisplayOnDemandLoadMessage()&&this.isMashupScrollEnabled()})},this.props.dataContext.get_FrameShouldBeRendered()?iFrame:null);children.push(container);if(this.state.poppedOut){var popOverBackgroundDiv=AncestorMountedHost.AncestorMountedHost({selectorString:"body"},React.DOM.div({key:"popOverBackgroundDiv",className:"popOverBackgroundDiv"}));children.push(popOverBackgroundDiv);var ExitButton=AncestorMountedHost.AncestorMountedHost({selectorString:"body"},React.DOM.div({className:CssClassSet({InteractionCentricIFrameExitButton:this.props.dataContext.get_IsInteractionCentricEnabled()},"ExitButton-symbol"),key:"ExitButton",onClick:this.handlePopoverDismiss}));children.push(ExitButton)}else if(this.shouldShowPopover()){var popover=React.DOM.div({key:"popover",className:"popOverSideBar",style:{height:this.calculateHeight()}},ImageButton.ImageButton({className:"PopOverButton",imageType:"Symbol",imageName:"PopOverButton",onClick:this.handlePopoverCreate}));children.push(popover)}}var iFrameParentDiv=React.DOM.div({className:CssClassSet({iframeParent:true,iframeParentLabelOffset:!this.props.clientContext.isInteractionCentric&&!this.props.descriptor.Properties["ShowLabel"],iframeParentPoppedOut:this.state.poppedOut,iframeWithBorder:this.props.clientContext.isInteractionCentric&&this.props.dataContext.get_IsWebResource()&&this.props.descriptor.Properties["Border"]}),style:{top:this.state.poppedOut?this.calculateTop():""},tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():null},children),finalComponents=[];if(this.props.clientContext.applicationShellViewModel.get_IsServerAvailable()&&this.props.dataContext.get_DisplayOnDemandLoadMessage()){var loadButton=React.DOM.button({className:"onDemandMashupLoad",role:"button",key:"mashupLoadButton",onClick:this.handleLoadButtonClick},this.props.dataContext.get_LoadButtonText());finalComponents.push(loadButton)}finalComponents.push(iFrameParentDiv);if(this.props.clientContext.isInteractionCentric){var showLabel=this.props.dataContext.get_ShowLabel(),iframeControl=React.DOM.div({className:CssClassSet({interactionCentricIframeControl:true,interactionCentricIframeControlLabel:showLabel}),onTouchStart:this.stopScrolling,onTouchMove:this.stopScrolling,onScroll:this.stopScrolling,onWheel:this.stopScrolling},finalComponents);if(showLabel)var labelText=this.props.dataContext.get_Label(),labelvalue=React.DOM.div({className:"interactionCentricIframeHeader"},labelText);return React.DOM.div({className:"interactionCentricIframe"},labelvalue,iframeControl)}var divHeight=this.props.clientContext.userAgent.get_IsIOS()&&this.props.descriptor.TypeName=="WebResourceView"?"100vh":"100%";return React.DOM.div({style:{height:divHeight},className:this.props.descriptor.TypeName+"-iframe",onTouchStart:this.stopScrolling,onTouchMove:this.stopScrolling,onScroll:this.stopScrolling,onWheel:this.stopScrolling},finalComponents)};return IFrameSpec}(TsAdapter.SpecBase);exports.IFrameSpec=IFrameSpec;exports.IFrame=DataWrapperComponent.wrapComponent(new IFrameSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Mashups/ACIControl",["require","exports","Components/DataWrapperComponent","Components/Mashups/IFrame"],function(require,exports,DataWrapperComponent,IFrame){exports.ACI_DESCRIPTOR_NAME="ACIControlView";exports.WEB_RESOURCE_DESCRIPTOR_NAME="WebResourceView";exports.IFRAME_DESCRIPTOR_NAME="IFrameView";var ACIControlSpec=function(_super){__extends(ACIControlSpec,_super);function ACIControlSpec(){_super.apply(this,arguments);this.displayName="ACI"}return ACIControlSpec}(IFrame.IFrameSpec);exports.ACIControl=DataWrapperComponent.wrapComponent(new ACIControlSpec)});define("Components/ComponentFeatureControl",["require","exports","Components/ComponentFactory","Components/Mashups/IFrame","Components/Mashups/ACIControl","Components/CustomControls/CustomControlHostView"],function(require,exports,ComponentFactory,IFrame,ACIControl,CustomControlHostView){function registerComponentsUnderFeatureControl(featureControlManager){featureControlManager.isFeatureEnabled("CustomControlMobile")&&ComponentFactory.registerComponentFactory(CustomControlHostView.DESCRIPTOR_NAME,CustomControlHostView.CustomControlHostView);if(featureControlManager.isFeatureEnabled("MobileClientMashup")){ComponentFactory.registerComponentFactory(IFrame.IFRAME_DESCRIPTOR_NAME,IFrame.IFrame);ComponentFactory.registerComponentFactory(IFrame.WEB_RESOURCE_DESCRIPTOR_NAME,IFrame.IFrame)}featureControlManager.isFeatureEnabled("PowerBI")&&ComponentFactory.registerComponentFactory(IFrame.POWER_BI_DESCRIPTOR_NAME,IFrame.IFrame);ComponentFactory.registerComponentFactory(IFrame.IFRAME_DESCRIPTOR_NAME,IFrame.IFrame);ComponentFactory.registerComponentFactory(IFrame.WEB_RESOURCE_DESCRIPTOR_NAME,IFrame.IFrame);ComponentFactory.registerComponentFactory(ACIControl.ACI_DESCRIPTOR_NAME,ACIControl.ACIControl)}exports.registerComponentsUnderFeatureControl=registerComponentsUnderFeatureControl});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/SimpleButton",["require","exports","Core/ReactTypescriptAdapter","Components/Primitives/Button","Components/DataWrapperComponent","Components/Common/Constants","Core/Binding/FocusHandlerMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,Button,DataWrapperComponent,Constants,FocusHandlerMixin,CssClassSet){exports.DESCRIPTOR_NAME="SimpleButton";var SimpleButtonSpec=function(_super){__extends(SimpleButtonSpec,_super);function SimpleButtonSpec(){_super.apply(this,arguments);this.displayName="SimpleButton";this.listenToProperties=["Enabled","Visible","Label","HasFocus"];this.mixins=[FocusHandlerMixin.Mixin]}SimpleButtonSpec.prototype.handleOnClick=function(){this.props.dataContext.get_Enabled()&&this.props.dataContext.onClick()};SimpleButtonSpec.prototype.onBlur=function(e){this.props.dataContext&&this.props.dataContext.get_HasFocus()&&this.props.dataContext.set_HasFocus(false)};SimpleButtonSpec.prototype.handleFocus=function(){if(this.props.dataContext&&this.props.dataContext.get_HasFocus()){var jNode=$(ReactDOM.findDOMNode(this));jNode.focus()}};SimpleButtonSpec.prototype.handleKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:this.handleOnClick();break}};SimpleButtonSpec.prototype.render=function(){var styles={};if(!this.props.dataContext.get_Visible())return React.DOM.noscript();var buttonLabel=React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_Label());return Button.Button({className:CssClassSet({SimpleButton:true,dialogCancelButton:this.props.dataContext.get_Label()==="Cancel"}),enabled:this.props.dataContext.get_Enabled(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.tabIndex>0?this.props.tabIndex:this.props.dataContext.get_NextTabIndex():null,title:this.props.dataContext.get_Label(),onClick:this.handleOnClick,onBlur:this.onBlur,onKeyDown:this.handleKeyDown,reactClientContext:this.props.clientContext,ariaLabel:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_Label():null},buttonLabel)};return SimpleButtonSpec}(TsAdapter.SpecBase);exports.SimpleButton=DataWrapperComponent.wrapComponent(new SimpleButtonSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/CrmDialog",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Dialogs/QuickCreateButton","Components/Common/RootView","Components/ComponentFactory","Components/Dialogs/SimpleButton","Utils/CssClassSet","Components/Common/Constants"],function(require,exports,TsAdapter,PureUpdate,QuickCreateButton,RootView,ComponentFactory,SimpleButton,CssClassSet,Constants){var CrmDialogSpec=function(_super){__extends(CrmDialogSpec,_super);function CrmDialogSpec(){_super.apply(this,arguments);this.displayName="CrmDialog";this.mixins=[PureUpdate.Mixin]}CrmDialogSpec.prototype.renderActions=function(){var actions=[],vm=this.props.dataContext,close=QuickCreateButton.QuickCreateButton({key:"close",clientContext:this.props.clientContext,dataContext:vm.get_RequestCloseCommand(),label:vm.get_CancelButtonText(),tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex()>0?this.props.dataContext.get_StartIndex():vm.get_NextTabIndex():null,symbolName:"Cancel",dataId:"close"});actions.push(close);return actions};CrmDialogSpec.prototype.handleKeyDown=function(e){switch(e.key){case Constants.ESCAPE_KEY:this.props.dataContext.CloseOnCancel();break}};CrmDialogSpec.prototype.handleFocusOnDismiss=function(){if(this.activeElementBeforeOpening){var activeElementParent=this.activeElementBeforeOpening.parentNode;if(activeElementParent.classList.contains("quickActionQueueContainerPopup")&&activeElementParent.classList.contains("popupHidden"))$(".quickActionQueueContainerPopupButton").focus();else $(this.activeElementBeforeOpening).focus()}};CrmDialogSpec.prototype.componentWillUnmount=function(){this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};CrmDialogSpec.prototype.componentWillMount=function(){this.activeElementBeforeOpening=document.activeElement};CrmDialogSpec.prototype.renderBody=function(){return React.DOM.div({key:"body",className:"CrmDialog-body"},RootView.RootView({clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Root(),className:"CrmDialog-rootView",isCrmDialog:true,handleFocusOnDismiss:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleFocusOnDismiss:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null}))};CrmDialogSpec.prototype.render=function(){var content=React.DOM.div({key:"content",className:"CrmDialog-popupContent"},this.renderBody()),actionContainer=React.DOM.div({key:"actions",className:"CrmDialog_actionDivContainer"},this.renderActions());return React.DOM.div({id:"CrmDialog",onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleKeyDown:null,className:CssClassSet({"CrmDialog-popup":true,CrmDialogForm:true,PanoramaItemDialog:this.props.dataContext.get_DialogArguments()["PanoramaItemDialog"]})},[content,actionContainer])};return CrmDialogSpec}(TsAdapter.SpecBase);ComponentFactory.registerComponentFactory(SimpleButton.DESCRIPTOR_NAME,SimpleButton.SimpleButton);exports.CrmDialog=TsAdapter.createComponent(new CrmDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/AboutDialog",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Utils/CssClassSet","Core/Binding/FocusHandlerMixin"],function(require,exports,TsAdapter,PureUpdate,Button,CssClassSet,FocusHandlerMixin){var AboutDialogSpec=function(_super){__extends(AboutDialogSpec,_super);function AboutDialogSpec(){_super.apply(this,arguments);this.displayName="AboutDialog";this.mixins=[PureUpdate.Mixin,FocusHandlerMixin.Mixin];this.listenToProperties=["ActiveNavigationStack","Top"]}AboutDialogSpec.prototype.handleFocus=function(){var okButton=this.refs["okButton"];okButton!=null&&$(ReactDOM.findDOMNode(okButton)).focus()};AboutDialogSpec.prototype.handleOkClick=function(){var command=this.props.dataContext.get_OkCommand();command&&command.get_CanExecute()&&command.execute()};AboutDialogSpec.prototype.handlePrivacyClick=function(){var command=this.props.dataContext.get_OpenPrivacyPolicyCommand();command&&command.get_CanExecute()&&command.execute()};AboutDialogSpec.prototype.handleLicenseClick=function(){var command=this.props.dataContext.get_OpenLicenseTermsCommand();command&&command.get_CanExecute()&&command.execute()};AboutDialogSpec.prototype.renderButtonContainer=function(){var okButton=Button.Button({dataId:"ok",ref:"okButton",onClick:this.handleOkClick,className:"dynamicsButton messageDialog_OK_Button",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_NextTabIndex():null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOkClick:null},this.props.dataContext.get_OkButtonText());return React.DOM.div({key:"buttonContainer",className:"messageDialog-buttons"},React.DOM.div({className:"messageDialog-buttonContainer"},okButton))};AboutDialogSpec.prototype.renderLabelItem=function(labelText,lineBreak){if(!labelText)return null;return React.DOM.li({key:labelText,className:CssClassSet({"aboutDialog-list-break":lineBreak})},React.DOM.span(null,labelText))};AboutDialogSpec.prototype.renderLabelValueItem=function(labelText,valueText,valueClassName,lineBreak){if(!labelText)return null;var labelContent=React.DOM.span({key:"label",className:"aboutDialog-label"},labelText),valueContent=React.DOM.span({key:"value",className:valueClassName},valueText);return React.DOM.li({key:labelText,className:CssClassSet({"aboutDialog-list-break":lineBreak})},[labelContent,valueContent])};AboutDialogSpec.prototype.renderBodyContainer=function(){var titleLabel=React.DOM.span({key:"title",className:"messageDialog-Title"},this.props.dataContext.get_MessageTitle()),brandLabel=React.DOM.span({key:"brand",className:"aboutDialog-Brand"},this.props.dataContext.get_AboutBrandTitle()),list=React.DOM.ul({key:"list",className:"aboutDialog-list"},[this.renderLabelItem(this.props.dataContext.get_ManagedLabel(),true),this.renderLabelValueItem(this.props.dataContext.get_AppVersionLabel(),this.props.dataContext.get_AppVersion(),null,false),this.renderLabelValueItem(this.props.dataContext.get_ServerVersionLabel(),this.props.dataContext.get_ServerVersion(),null,false),this.renderLabelValueItem(this.props.dataContext.get_WebAddressLabel(),this.props.dataContext.get_WebAddress(),"aboutDialog_webAddress",false),this.renderLabelValueItem(this.props.dataContext.get_OrgNameLabel(),this.props.dataContext.get_OrgName(),null,true),this.renderLabelItem(this.props.dataContext.get_UserName(),false),this.renderLabelItem(this.props.dataContext.get_UserRoles(),false),this.renderLabelValueItem(this.props.dataContext.get_LastSyncTimeLabel(),this.props.dataContext.get_LastSyncTime(),null,true),React.DOM.li({key:"privacyPolicy",className:"aboutDialog-list-break"},Button.Button({id:"OpenPrivacyStatementButton",className:"aboutDialog_Link",onClick:this.handlePrivacyClick},this.props.dataContext.get_PrivacyPolicyLabel())),React.DOM.li({key:"licenseTerms",className:"aboutDialog-list-break"},Button.Button({id:"OpenLicenseTermsButton",className:"aboutDialog_Link",onClick:this.handleLicenseClick},this.props.dataContext.get_LicenseTermsLabel()))]);return React.DOM.div({key:"bodyContainer",className:"messageDialog-message"},[titleLabel,brandLabel,list])};AboutDialogSpec.prototype.render=function(){return React.DOM.div({className:"messageDialog-popupContent","data-id":"messageDialog"},React.DOM.div({className:"messageDialog-contentContainer"},[this.renderBodyContainer(),this.renderButtonContainer()]))};return AboutDialogSpec}(TsAdapter.SpecBase);exports.AboutDialog=TsAdapter.createComponent(new AboutDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/MessageDialog",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Components/Common/Constants","Core/Binding/FocusHandlerMixin"],function(require,exports,TsAdapter,PureUpdate,Button,Constants,FocusHandlerMixin){var MessageDialogSpec=function(_super){__extends(MessageDialogSpec,_super);function MessageDialogSpec(){_super.apply(this,arguments);this.displayName="MessageDialog";this.mixins=[PureUpdate.Mixin,FocusHandlerMixin.Mixin];this.listenToProperties=["ActiveNavigationStack","Top"]}MessageDialogSpec.prototype.handleOkClick=function(){var command=this.props.dataContext.get_OkCommand();command&&command.get_CanExecute()&&command.execute()};MessageDialogSpec.prototype.handleOkKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleOkClick();break;case Constants.TAB_KEY_CODE:var lastElement=this.refs["lastElement"],lastElementNode=ReactDOM.findDOMNode(lastElement);if(e.shiftKey&&lastElementNode){$(lastElementNode).focus();e.preventDefault()}break;default:break}};MessageDialogSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_CancelCommand();command&&command.get_CanExecute()&&command.execute()};MessageDialogSpec.prototype.handleCancleKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleCancelClick();break;case Constants.TAB_KEY_CODE:var firstElement=this.refs["firstElement"];if(!e.shiftKey&&firstElement){$(ReactDOM.findDOMNode(firstElement)).focus();e.preventDefault()}break}};MessageDialogSpec.prototype.showTechnicalDetailsLinkOnClick=function(){this.transitionToTechnicalDetailsVisable()};MessageDialogSpec.prototype.showTechnicalDetailsLinkOnKeyDownHandler=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.transitionToTechnicalDetailsVisable();default:break}};MessageDialogSpec.prototype.showTechnicalDetailsLinkOnMouseEnter=function(e){var showTechnicalDetailsLinkComponent=this.refs["showTechnicalDetailsLink"],showTechnicalDetailsLinkElement=ReactDOM.findDOMNode(showTechnicalDetailsLinkComponent);if(showTechnicalDetailsLinkElement){showTechnicalDetailsLinkElement.style.textDecoration="underline";showTechnicalDetailsLinkElement.style.cursor="pointer"}};MessageDialogSpec.prototype.showTechnicalDetailsLinkOnMouseLeave=function(e){var showTechnicalDetailsLinkComponent=this.refs["showTechnicalDetailsLink"],showTechnicalDetailsLinkElement=ReactDOM.findDOMNode(showTechnicalDetailsLinkComponent);if(showTechnicalDetailsLinkElement){showTechnicalDetailsLinkElement.style.textDecoration="none";showTechnicalDetailsLinkElement.style.cursor="auto"}};MessageDialogSpec.prototype.transitionToTechnicalDetailsVisable=function(){var showTechnicalDetailsLinkComponent=this.refs["showTechnicalDetailsLink"],showTechnicalDetailsLinkElement=ReactDOM.findDOMNode(showTechnicalDetailsLinkComponent);if(showTechnicalDetailsLinkElement)showTechnicalDetailsLinkElement.style.display="none";var technicalDetailsLinkComponent=this.refs["technicalDetails"],technicalDetailsLinkElement=ReactDOM.findDOMNode(technicalDetailsLinkComponent);if(technicalDetailsLinkElement)technicalDetailsLinkElement.style.display=""};MessageDialogSpec.prototype.componentWillMount=function(){this.activeElementBeforeOpening=document.activeElement};MessageDialogSpec.prototype.componentWillUnmount=function(){this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};MessageDialogSpec.prototype.handleFocus=function(){var firstElement=this.refs["firstElement"],okButton=ReactDOM.findDOMNode(firstElement),dialogBody=$(".messageDialog-MessageBody span");if(okButton!=null&&dialogBody!=null){var dialogBodyText=dialogBody.text(),okButtonText=$(okButton).text(),ariaLabelText=this.props.dataContext.get_MessageTitle()+" "+this.props.dataContext.get_MessageSubtitle()+" "+dialogBodyText+" "+okButtonText;ariaLabelText=this.props.dataContext.get_IsInteractionCentricEnabled()?ariaLabelText:null;$(okButton).attr("aria-label",ariaLabelText);$(okButton).focus()}};MessageDialogSpec.prototype.handleEscapeKeyDown=function(e){e.keyCode==Constants.ESCAPE_KEY_CODE&&this.handleCancelClick()};MessageDialogSpec.prototype.renderContentContainer=function(){var title=React.DOM.span({key:"title",className:"messageDialog-Title","data-id":"messageDialogTitle"},this.props.dataContext.get_MessageTitle()),subTitle=React.DOM.span({key:"subTitle",className:"messageDialog-Subtitle","data-id":"messageDialogSubtitle"},this.props.dataContext.get_MessageSubtitle()),messageObject=this.props.dataContext.get_MessageObject()?this.props.dataContext.get_MessageObject():React.DOM.span({dangerouslySetInnerHTML:{__html:this.props.dataContext.get_ProcessedMessage()}}),message=React.DOM.div({key:"messageBody",className:"messageDialog-Message messageDialog-MessageBody","data-id":"messageDialogMessage"},messageObject),showTechnicalDetailsLink=React.DOM.div({key:"showTechnicalDetailsLink",ref:"showTechnicalDetailsLink",style:{color:this.props.dataContext.get_IsInteractionCentricEnabled()?"#429bbd":"#0070df",paddingTop:"10px",display:"inline-block"},className:"messageDialog-showTechnicalDetailsLink",onClick:this.showTechnicalDetailsLinkOnClick,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.showTechnicalDetailsLinkOnKeyDownHandler:null,onMouseEnter:this.props.dataContext.get_IsInteractionCentricEnabled()?this.showTechnicalDetailsLinkOnMouseEnter:null,onMouseLeave:this.props.dataContext.get_IsInteractionCentricEnabled()?this.showTechnicalDetailsLinkOnMouseLeave:null,"data-id":"messageDialogshowTechnicalDetailsLink"},this.props.dataContext.get_ShowTechnicalDetailsLinkLable()),technicalDetails=React.DOM.div({key:"technicalDetails",ref:"technicalDetails",style:{display:"none",paddingTop:"10px"},className:"messageDialog-technicalDetails","data-id":"messageDialogtechnicalDetails"},React.DOM.span({dangerouslySetInnerHTML:{__html:this.props.dataContext.get_TechnicalDetails()}}));return React.DOM.div({key:"contentContainer",className:"messageDialog-contentContainer"},React.DOM.span({className:"messageDialog-message"},[title,subTitle,message,showTechnicalDetailsLink,technicalDetails]))};MessageDialogSpec.prototype.renderActionContainer=function(){var okButtonText=this.props.dataContext.get_OkButtonText(),cancelButtonText=this.props.dataContext.get_CancelButtonText(),nextTabIndex=this.props.dataContext.get_StartIndex()+1,buttons=[],okButton=Button.Button({key:"Ok",ref:"firstElement",className:"dynamicsButton messageDialog_OK_Button",onClick:this.handleOkClick,dataId:"Ok",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOkKeyDown:null},okButtonText);buttons.push(okButton);if(this.props.dataContext.get_DialogType()===1){var cancelButton=Button.Button({key:"Cancel",ref:"lastElement",className:"dynamicsButton messageDialog_Cancel_Button",onClick:this.handleCancelClick,dataId:"Cancel",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?nextTabIndex++:null,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleCancleKeyDown:null,ariaLabel:this.props.dataContext.get_IsInteractionCentricEnabled()?cancelButtonText:null},cancelButtonText);buttons.push(cancelButton)}var buttonContainer=React.DOM.span({className:"messageDialog-buttonContainer"},buttons);return React.DOM.div({key:"actionContainer",className:"messageDialog-actionContainer",onKeyDown:this.handleEscapeKeyDown},React.DOM.span({className:"messageDialog-buttons"},buttonContainer))};MessageDialogSpec.prototype.render=function(){return React.DOM.div({id:"ConfirmDialog","data-id":"messageDialog","data-vmid":this.props.dataContext.get_ViewModelId(),className:"messageDialog-popupContent"},[this.renderContentContainer(),this.renderActionContainer()])};return MessageDialogSpec}(TsAdapter.SpecBase);exports.MessageDialog=TsAdapter.createComponent(new MessageDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/AssociateForm",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet","Components/Primitives/Popup","Components/Primitives/ElementMountedHost","Components/Common/RootView"],function(require,exports,TsAdapter,PureUpdate,CssClassSet,Popup,ElementMountedHost,RootView){var AssociateFormSpec=function(_super){__extends(AssociateFormSpec,_super);function AssociateFormSpec(){_super.apply(this,arguments);this.displayName="AssociateForm";this.mixins=[PureUpdate.Mixin]}AssociateFormSpec.prototype.componentDidMount=function(){var associateLookupViewModel=this.props.dataContext.get_AssociateLookupViewModel();associateLookupViewModel&&associateLookupViewModel.set_HasFocus(true)};AssociateFormSpec.prototype.componentWillUnmount=function(){var associateLookupViewModel=this.props.dataContext.get_AssociateLookupViewModel();associateLookupViewModel&&associateLookupViewModel.set_HasFocus(false)};AssociateFormSpec.prototype.render=function(){var cssClass="associateForm";if(this.props.dataContext&&!this.props.dataContext.get_AssociateLookupViewModel().get_ShowLookupBar())cssClass="associateForm NoLookupBar";var popup=Popup.Popup({visible:true,className:CssClassSet(null,cssClass,"associateLookupDialog"),onDismiss:this.props.onDismiss,id:"associateLookupDialog",keepOpenOnPopupTap:true},RootView.RootView({className:"rootViewControl",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Root()})),parentId=this.props.dataContext.get_ParentId();if(!parentId)return React.DOM.div({key:"associateLookupDialog"},popup);return ElementMountedHost.ElementMountedHost({parentId:parentId},popup)};return AssociateFormSpec}(TsAdapter.SpecBase);exports.AssociateForm=TsAdapter.createComponent(new AssociateFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Primitives/Switch",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,CssClassSet){var SwitchSpec=function(_super){__extends(SwitchSpec,_super);function SwitchSpec(){_super.apply(this,arguments);this.displayName="Switch";this.mixins=[PureUpdate.Mixin]}SwitchSpec.prototype.getDefaultProps=function(){return {dataId:"switch",role:"switch"}};SwitchSpec.prototype.render=function(){var textOn=this.props.labelOn||this.props.clientContext.getLocalizedString("L_Switch_On"),textOff=this.props.labelOff||this.props.clientContext.getLocalizedString("L_Switch_Off"),switchLabel=React.DOM.label({key:"switchLabel",className:CssClassSet({switchLabel:true,turnedOn:this.props.turnedOn})},this.props.turnedOn?textOn:textOff),switchContainer=React.DOM.div({key:"switchContainer",className:CssClassSet({switchContainer:true,turnedOn:this.props.turnedOn}),onClick:this.props.onClick,dataId:this.props.dataId},React.DOM.div({key:"switchSlider",className:"switchSlider"}));return React.DOM.div({key:"switch",className:CssClassSet(null,"switch",this.props.className)},[switchLabel,switchContainer])};return SwitchSpec}(TsAdapter.SpecBase);exports.Switch=TsAdapter.createComponent(new SwitchSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/ImageUploadDialog",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Button","Utils/CssClassSet","Components/Common/Image","Components/Primitives/Switch"],function(require,exports,TsAdapter,DataWrapperComponent,Button,CssClassSet,Image,Switch){var ImageUploadDialogSpec=function(_super){__extends(ImageUploadDialogSpec,_super);function ImageUploadDialogSpec(){_super.apply(this,arguments);this.displayName="ImageUploadDialog";this.listenToProperties=["IsDefaultImageUsed"]}ImageUploadDialogSpec.prototype.handleCapturePhotoClick=function(){var command=this.props.dataContext.get_CapturePhotoCommand();command&&command.get_CanExecute()&&command.execute()};ImageUploadDialogSpec.prototype.handleChooseFromLibraryClick=function(){var command=this.props.dataContext.get_ChooseFromLibraryCommand();command&&command.get_CanExecute()&&command.execute()};ImageUploadDialogSpec.prototype.handleUseDefaultImageClick=function(){var command=this.props.dataContext.get_UsedefaultImageCommand();command&&command.get_CanExecute()&&command.execute()};ImageUploadDialogSpec.prototype.handleSaveClick=function(){var command=this.props.dataContext.get_SaveImageUploadCommand();command&&command.get_CanExecute()&&command.execute()};ImageUploadDialogSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_CancelImageUploadCommand();command&&command.get_CanExecute()&&command.execute()};ImageUploadDialogSpec.prototype.renderHeaderImage=function(){var imageViewModel=this.props.dataContext.get_ImageViewModel(),entityName=this.props.dataContext.get_PrimaryModelName();return Image.Image({key:"entityImage",dataContext:imageViewModel,clientContext:this.props.clientContext,className:"entityImage",placeholderClassName:entityName})};ImageUploadDialogSpec.prototype.renderBody=function(){var children=[],isDefaultImageUsed=this.props.dataContext.get_IsDefaultImageUsed(),isDeviceIntegrationEnabled=this.props.clientContext&&this.props.clientContext.applicationShellViewModel.get_FeatureControlManager().isFeatureEnabled("DeviceIntegration"),isCameraAvailable=this.props.dataContext.get_IsCameraAvailable(),instructionTitle=React.DOM.label({key:"instructionTitle",className:"imageUploadDialogTitleText"},this.props.dataContext.get_DialogHeaderText()),instrcutionContent=React.DOM.label({key:"instructionContent",className:"imageUploadDialogContentText"},this.props.dataContext.get_InstructionText());children.push(React.DOM.div({key:"instructionContentDiv",className:"imageUploadDialogSection"},[instructionTitle,instrcutionContent]));var useDefaultImageTitle=React.DOM.label({key:"instructionTitle",className:"imageUploadDialogTitleText usedefault"},this.props.dataContext.get_UseDefaultImageText()),useDefaultImageControl=Switch.Switch({key:"useDefaultImageSwitch",className:"useDefaultImageSwitch",turnedOn:this.props.dataContext.get_IsDefaultImageUsed(),clientContext:this.props.clientContext,onClick:this.handleUseDefaultImageClick});children.push(React.DOM.div({key:"useDefaultImageContentDiv",className:CssClassSet({imageUploadDialogSection:true,disabled:!isDefaultImageUsed})},[useDefaultImageTitle,useDefaultImageControl]));var customImageChildren=[],customImageTitle=React.DOM.label({key:"customImageTitle",className:"imageUploadDialogTitleText"},this.props.dataContext.get_CustomImageText());if(isCameraAvailable){var uploadFromDeviceButton=Button.Button({key:"capturePhoto",dataId:"capturePhoto",onClick:!isDefaultImageUsed?this.handleCapturePhotoClick:null,className:"imageUploadDialogButton"},this.props.dataContext.get_CustomImageContentFromDeviceText());customImageChildren.push(uploadFromDeviceButton);customImageChildren.push(React.DOM.label({key:"orLabel",className:"imageUploadDialogContentText orLabel"},this.props.dataContext.get_OrLabelText()))}if(isDeviceIntegrationEnabled){var uploadFromLibraryButton=Button.Button({key:"chooseFromLibrary",dataId:"chooseFromLibrary",onClick:!isDefaultImageUsed?this.handleChooseFromLibraryClick:null,className:"imageUploadDialogButton"},this.props.dataContext.get_CustomImageContentFromLibraryText());customImageChildren.push(uploadFromLibraryButton)}var uploadPhotoSection=React.DOM.div({key:"customImageFromLibrary",className:"customImageSection"},customImageChildren);children.push(React.DOM.div({key:"customImageDiv",className:CssClassSet({imageUploadDialogSection:true,disabled:isDefaultImageUsed})},[customImageTitle,uploadPhotoSection]));return React.DOM.div({key:"imageUploadDialogBody",className:"imageUploadDialogBody"},children)};ImageUploadDialogSpec.prototype.renderActions=function(){var children=[];children.push(Button.Button({key:"cancelImageUpload",dataId:"cancelImageUpload",onClick:this.handleCancelClick,className:"imageUploadDialogButton"},this.props.dataContext.get_CancelButtonText()));children.push(Button.Button({key:"saveImageUpload",dataId:"saveImageUpload",onClick:this.handleSaveClick,className:"imageUploadDialogButton imageUploadDialogButton-save"},this.props.dataContext.get_SaveButtonText()));return React.DOM.div({key:"imageUploadDialogActions",className:"imageUploadDialogActions"},children)};ImageUploadDialogSpec.prototype.render=function(){var content=React.DOM.div({key:"content",className:"imageUploadDialogContent"},[this.renderHeaderImage(),this.renderBody()]);return React.DOM.div({key:"imageUploadDialog",className:"imageUploadDialog"},[content,this.renderActions()])};return ImageUploadDialogSpec}(TsAdapter.SpecBase);exports.ImageUploadDialog=DataWrapperComponent.wrapComponent(new ImageUploadDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/InlineCreateForm",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Popup","Components/Primitives/ElementMountedHost","Components/Common/RootView","Utils/CssClassSet","Components/Primitives/ImageButton"],function(require,exports,TsAdapter,PureUpdate,Popup,ElementMountedHost,RootView,CssClassSet,ImageButton){var InlineCreateFormSpec=function(_super){__extends(InlineCreateFormSpec,_super);function InlineCreateFormSpec(){_super.apply(this,arguments);this.displayName="InlineCreateForm";this.mixins=[PureUpdate.Mixin]}InlineCreateFormSpec.prototype.getInitialState=function(){return {isDisabled:true}};InlineCreateFormSpec.prototype.handleOkClick=function(){this.setState({isDisabled:false});var command=this.props.dataContext.get_CreateAndCloseCommand();command&&command.get_CanExecute()&&command.execute()};InlineCreateFormSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_RequestCloseCommand();command&&command.get_CanExecute()&&command.execute()};InlineCreateFormSpec.prototype.componentDidMount=function(){var inlineLookupViewModel=this.props.dataContext.get_InlineLookupViewModel();inlineLookupViewModel&&inlineLookupViewModel.set_HasFocus(true);this.props.dataContext.get_IsNoteInlineCreateForm()&&this.props.clientContext.applicationShellViewModel.set_NoteInlineCreateFormExpanded(true)};InlineCreateFormSpec.prototype.componentWillUnmount=function(){var inlineLookupViewModel=this.props.dataContext.get_InlineLookupViewModel();inlineLookupViewModel&&inlineLookupViewModel.set_HasFocus(false);this.props.dataContext.get_IsNoteInlineCreateForm()&&this.props.clientContext.applicationShellViewModel.set_NoteInlineCreateFormExpanded(false)};InlineCreateFormSpec.prototype.render=function(){var popupContent=React.DOM.div({key:"popup",className:"inlineCreateForm-popupContent"},RootView.RootView({className:"inlineCreateForm-rootView",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Root()})),createAndCloseButtonText=this.props.dataContext.get_IsNoteInlineCreateForm()?this.props.dataContext.get_CreateAndCloseButtonText():this.props.dataContext.get_OkButtonText(),isNoteInlineCreateNote=this.props.dataContext.get_IsNoteInlineCreateForm(),isAppOffline=!this.props.clientContext.applicationShellViewModel.get_IsServerAvailable(),okButton=ImageButton.ImageButton({key:"ok",className:CssClassSet({NoteSave_Text:true,inlineNoteSave_Button:!this.state.isDisabled,inlineCreateForm_OK_Button:this.state.isDisabled}),labelClassName:"SaveImage_Icon",title:createAndCloseButtonText,onClick:this.handleOkClick,dataId:"ok"}),cancelButton=ImageButton.ImageButton({key:"cancel",className:"NoteCancel_Text",labelClassName:"CancelImage_Icon",title:this.props.dataContext.get_CancelButtonText(),onClick:this.handleCancelClick,dataId:"close"}),actionChildren=[];if(isNoteInlineCreateNote){var actionContainer=React.DOM.div({key:"noteInlineCreateActionContainer",className:CssClassSet({noteInlineCreateActionContainer:true,noteInlineCreateActionContainerOffline:isAppOffline})},[cancelButton,okButton]);actionChildren.push(actionContainer)}else{actionChildren.push(okButton);actionChildren.push(cancelButton)}var popup=Popup.Popup({key:"popup",id:"inlineCreateForm-popup",className:CssClassSet({inlinePopup:true,annotation:isNoteInlineCreateNote}),visible:true,onDismiss:this.props.onDismiss,keepOpenOnPopupTap:true,keepOpenOnTap:isNoteInlineCreateNote},[popupContent,actionChildren]),parentId=this.props.dataContext.get_ParentId();if(!parentId)return React.DOM.div({id:"inlinecreateform"},popup);return ElementMountedHost.ElementMountedHost({parentId:parentId},popup)};return InlineCreateFormSpec}(TsAdapter.SpecBase);exports.InlineCreateForm=TsAdapter.createComponent(new InlineCreateFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/GlobalLookup/GlobalLookup",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Common/RootView"],function(require,exports,TsAdapter,DataWrapperComponent,RootView){var GlobalLookupSpec=function(_super){__extends(GlobalLookupSpec,_super);function GlobalLookupSpec(){_super.apply(this,arguments);this.displayName="GlobalLookup";this.listenToProperties=["ChildViewModels"]}GlobalLookupSpec.prototype.render=function(){var controls=React.DOM.div({key:"controls",className:"GlobalLookup divHeader"}),rootview=RootView.RootView({key:"rootView",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_Root(),className:"CrmDialog-rootView"}),GlobalLookupPopup=React.DOM.div({id:"GlobalLookup",className:"divHeader globalLookup-popup"},[controls,rootview]);return GlobalLookupPopup};return GlobalLookupSpec}(TsAdapter.SpecBase);exports.GlobalLookup=DataWrapperComponent.wrapComponent(new GlobalLookupSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/SwitchProcessList",["require","exports","Components/DataWrapperComponent","Components/Lists/PagedList","Core/ReactTypescriptAdapter"],function(require,exports,DataWrapperComponent,PagedList,TsAdapter){var SwitchProcessListSpec=function(_super){__extends(SwitchProcessListSpec,_super);function SwitchProcessListSpec(){_super.apply(this,arguments);this.displayName="SwitchProcessList";this.listenToProperties=["ChildViewModels"]}SwitchProcessListSpec.prototype.render=function(){var pagedList=PagedList.PagedList({key:"list",clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.dataContext.get_ViewDescriptor()});return pagedList};return SwitchProcessListSpec}(TsAdapter.SpecBase);exports.SwitchProcessList=DataWrapperComponent.wrapComponent(new SwitchProcessListSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/BusinessProcess/SwitchProcessDialog",["require","exports","Components/Primitives/Button","Components/DataWrapperComponent","Components/BusinessProcess/SwitchProcessList","Core/ReactTypescriptAdapter","Components/Common/Constants"],function(require,exports,Button,DataWrapperComponent,SwitchProcessList,TsAdapter,Constants){var SwitchProcessDialogSpec=function(_super){__extends(SwitchProcessDialogSpec,_super);function SwitchProcessDialogSpec(){_super.apply(this,arguments);this.displayName="SwitchProcessDialog";this.listenToProperties=["ChildViewModels","IsArchivedProcessCommand"]}SwitchProcessDialogSpec.prototype.handleCancelButton=function(){var command=this.props.dataContext.get_RequestCloseCommand();command&&command.get_CanExecute()&&command.execute()};SwitchProcessDialogSpec.prototype.handleArchivedButton=function(){var command=this.props.dataContext.get_ArchivedCommand();command&&command.get_CanExecute()&&command.execute()};SwitchProcessDialogSpec.prototype.handleCancelKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleCancelButton();break;case Constants.TAB_KEY_CODE:var firstElementComponent=this.refs["firstElement"];if(!e.shiftKey&&firstElementComponent instanceof Element){$(firstElementComponent).focus();e.preventDefault()}break}};SwitchProcessDialogSpec.prototype.handleFocus=function(){var okButton=this.refs["firstElement"],dialogBody=$(".messageDialog-MessageBody span");okButton instanceof Element&&dialogBody!=null&&$(okButton).focus()};SwitchProcessDialogSpec.prototype.handleEscapeKeyDown=function(e){e.keyCode==Constants.ESCAPE_KEY_CODE&&this.handleCancelButton()};SwitchProcessDialogSpec.prototype.render=function(){var vm=this.props.dataContext,buttonText=vm.get_ButtonText(),listContext=vm.get_SwitchProcessListViewModel(),dialogTitleText=vm.get_Title(),dialogSubTitleText=vm.get_SubTitle(),titles=[],titleView=React.DOM.div({key:"TitleView",className:"switchProcessDialogTitle"},dialogTitleText),subTitleView=React.DOM.div({key:"subTitleView",className:"switchProcessDialogSubTitle"},dialogSubTitleText);titles.push(titleView,subTitleView);var headerContainerView=React.DOM.div({key:"headerContainerView",className:"switchProcessDialogHeader"},titles),switchProcessListView=SwitchProcessList.SwitchProcessList({key:"SwitchProcessListView",clientContext:this.props.clientContext,dataContext:listContext}),cancelButtonText=vm.get_CancelButtonText(),buttons=[],okButtonView=Button.Button({key:"ArchivedButtonView ",onClick:this.handleArchivedButton,className:"dynamicsButton",dataId:"Archived"},buttonText);buttons.push(okButtonView);var closeButtonView=Button.Button({key:"CancelButtonView",onClick:this.handleCancelButton,className:"dynamicsButton dialogCancelButton",dataId:"Cancel",onKeyDown:vm.get_IsInteractionCentricEnabled()?this.handleCancelKeyDown:null,ariaLabel:this.props.dataContext.get_IsInteractionCentricEnabled()?cancelButtonText:null},cancelButtonText);buttons.push(closeButtonView);var footerContainerView=React.DOM.div({key:"footerContainerView",className:"switchProcessFooter"},buttons),HeaderListItem=[headerContainerView,switchProcessListView],HeaderListItemView=React.DOM.div({key:"HeaderListItemView",className:"HeaderListItem"},HeaderListItem),childViews=[HeaderListItemView,footerContainerView],switchProcessDialogView=React.DOM.div({key:"SwitchProcessDialogView",id:"SwitchProcessDialog",className:"SwitchProcessDialog-popup"},childViews);return switchProcessDialogView};return SwitchProcessDialogSpec}(TsAdapter.SpecBase);exports.SwitchProcessDialog=DataWrapperComponent.wrapComponent(new SwitchProcessDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/TaskBasedFlow/TaskBasedFlowPage",["require","exports","Core/ReactTypescriptAdapter","Components/Primitives/AncestorMountedHost","Components/DataWrapperComponent","Components/ComponentFactory","Utils/CssClassSet"],function(require,exports,TsAdapter,AncestorMountedHost,DataWrapperComponent,ComponentFactory,CssClassSet){exports.DESCRIPTOR_NAME="TaskBasedFlowPage";var MAXIMUM_TEXT_LENGTH=163,TaskBasedFlowPageSpec=function(_super){__extends(TaskBasedFlowPageSpec,_super);function TaskBasedFlowPageSpec(){_super.apply(this,arguments);this.displayName="TaskBasedFlowPage";this.listenToProperties=["Label"]}TaskBasedFlowPageSpec.prototype.childInterceptor=function(factory,props){props["childDecorator"]=this.wrapFooter;return factory(props)};TaskBasedFlowPageSpec.prototype.wrapFooter=function(factory,props){if(props.descriptor&&props.descriptor.BindingPath==="Footer")return AncestorMountedHost.AncestorMountedHost({key:"footer",selectorString:".TaskBasedFlow-popup",dataId:"tbx-footer",className:"TaskBasedFlowFooter"},factory(props));return factory(props)};TaskBasedFlowPageSpec.prototype.shouldUseSvg=function(agent){return agent.get_IsBrowserIE()||agent.get_IsWindows()&&!agent.get_IsWinDesktop()};TaskBasedFlowPageSpec.prototype.renderBackground=function(){if(this.shouldUseSvg(this.props.clientContext.userAgent)){var image="<image xlink:href ='"+this.props.imageName+"' width='144' height='144' filter='url(#blur)'/>",filter="<filter id='blur'><feGaussianBlur stdDeviation='3'/></filter>";return React.DOM.svg({key:"background",className:"background-image svg",viewBox:"0 0 144 144",preserveAspectRatio:"xMidYMid slice",dangerouslySetInnerHTML:{__html:image+filter}})}else return React.DOM.img({key:"background",className:"background-image cssBlur",src:this.props.imageName})};TaskBasedFlowPageSpec.prototype.render=function(){var label=this.props.dataContext.get_Label();if(label==null)label="";var pageTitle=React.DOM.span({key:"title",className:"page-title"},label),isTruncate=label.length>MAXIMUM_TEXT_LENGTH,headerControls=React.DOM.div({key:"headerControls",className:CssClassSet({controls:true,svg:this.shouldUseSvg(this.props.clientContext.userAgent),"block-with-text":isTruncate})},pageTitle),header=React.DOM.div({key:"header",className:"TaskBasedFlowPage-Header"},[this.renderBackground(),headerControls]),children=ComponentFactory.createChildComponents(this.props.dataContext,this.props.descriptor,this.props.clientContext,this.childInterceptor);if(this.props.dataContext.get_IsListTab())return React.DOM.div({className:"TaskBasedFlowPage"},children);return React.DOM.div({className:"TaskBasedFlowPage"},[header,children])};return TaskBasedFlowPageSpec}(TsAdapter.SpecBase);exports.TaskBasedFlowPage=DataWrapperComponent.wrapComponent(new TaskBasedFlowPageSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/TaskBasedFlow/TaskBasedFlowContainer",["require","exports","Components/Common/TestHooksDiv","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/TaskBasedFlow/TaskBasedFlowPage","Components/Primitives/ImageButton","Components/FormNotification/NotificationBar","Components/Primitives/ProgressIndicator","Utils/CssClassSet"],function(require,exports,TestHooksDiv,TsAdapter,DataWrapperComponent,TaskBasedFlowPage,ImageButton,NotificationBar,ProgressIndicator,CssClassSet){exports.DESCRIPTOR_NAME="TaskBasedFlowContainer";var TaskBasedFlowContainerSpec=function(_super){__extends(TaskBasedFlowContainerSpec,_super);function TaskBasedFlowContainerSpec(){_super.apply(this,arguments);this.displayName="TaskBasedFlowContainer";this.listenToProperties=["CurrentActivePage","UpdateRelatedEntityPending","UpdateEntityPending","EnableEdits","IsValid","IsServerAvailable"]}TaskBasedFlowContainerSpec.prototype.handlePopupDismiss=function(){this.props.dataContext.set_Visible(false)};TaskBasedFlowContainerSpec.prototype.cancelButtonHandler=function(){this.props.dataContext.get_RequestCloseCommand&&this.props.dataContext.get_RequestCloseCommand().execute()};TaskBasedFlowContainerSpec.prototype.renderNotificationBar=function(rootVM){return NotificationBar.NotificationBar({key:"notifications",clientContext:this.props.clientContext,dataContext:rootVM.get_FormNotifications()})};TaskBasedFlowContainerSpec.prototype.renderProgressBar=function(){var saving=this.props.dataContext.get_UpdateRelatedEntityPending()||this.props.dataContext.get_UpdateEntityPending();return ProgressIndicator.ProgressIndicator({key:"progress",className:"progressBarContainer",active:saving||!this.props.dataContext.get_EnableEdits(),type:ProgressIndicator.ProgressIndicatorType.Bar})};TaskBasedFlowContainerSpec.prototype.renderPage=function(){var children=[],rootVM=this.props.dataContext.get_Root();rootVM&&children.push(this.renderNotificationBar(rootVM));if(this.props.dataContext.get_CurrentActivePage()!=null){var taskBasedFlowPage=TaskBasedFlowPage.TaskBasedFlowPage({key:"taskBasedFlowPage",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_CurrentActivePage(),descriptor:this.props.dataContext.get_TaskBasedPageViewDescriptor(),imageName:this.props.dataContext.get_ImageName()});children.push(taskBasedFlowPage)}var hasError=this.props.dataContext.get_FormNotifications().get_MessageBarItems().get_Count()>0;return React.DOM.div({key:"Page",className:CssClassSet({"TaskBasedFlowPage-wrapper":true,hasError:hasError&&this.props.dataContext.get_EnableEdits()})},children)};TaskBasedFlowContainerSpec.prototype.render=function(){var children=[],cancelbutton=ImageButton.ImageButton({key:"cancel",imageType:"Symbol",imageName:"Close",onClick:this.cancelButtonHandler,enabled:true,dataId:"cancel",className:"closeButton"}),label=React.DOM.div({key:"label",className:"title"},this.props.dataContext.get_DisplayName()),controls=React.DOM.div({key:"header",className:"TaskBasedFlow-Header",dataId:"header"},[label,cancelbutton,this.renderProgressBar()]);children.push(controls);children.push(this.renderPage());var taskBasedFlowContainerPopup=TestHooksDiv.TestHooksDiv({key:"TaskBasedFlowContainer",id:"TaskBasedFlow",className:"TaskBasedFlowForm TaskBasedFlow-popup",clientContext:this.props.clientContext,dataContext:this.props.dataContext},children);return taskBasedFlowContainerPopup};return TaskBasedFlowContainerSpec}(TsAdapter.SpecBase);exports.TaskBasedFlowContainer=DataWrapperComponent.wrapComponent(new TaskBasedFlowContainerSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/DiagnosticsReport",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin"],function(require,exports,TsAdapter,PureUpdate){var DiagnosticsReportSpec=function(_super){__extends(DiagnosticsReportSpec,_super);function DiagnosticsReportSpec(){_super.apply(this,arguments);this.displayName="DiagnosticsReport";this.mixins=[PureUpdate.Mixin]}DiagnosticsReportSpec.prototype.handleRefreshButton=function(){this.setState({})};DiagnosticsReportSpec.prototype.handleSnapshotButton=function(){this.props.dataContext.snapshotButtonClicked()};DiagnosticsReportSpec.prototype.handleCloseButton=function(){this.props.dataContext.get_CancelCommand().execute()};DiagnosticsReportSpec.prototype.getScreenWidth=function(){return document.documentElement.clientWidth};DiagnosticsReportSpec.prototype.render=function(){var columnWidthStyle={},columnWidth=this.getScreenWidth()/8-19;columnWidthStyle={width:columnWidth};var diagnosticsReportDivWidth={};diagnosticsReportDivWidth["width"]=this.getScreenWidth()/2;for(var memoryUsageReportInfo=this.props.dataContext.getMemoryUsageReport(),th1=React.DOM.th({key:"keyTimeStamp",className:"diagnosticsReportTableTh",style:columnWidthStyle},this.props.dataContext.get_TimestampText()),th2=React.DOM.th({key:"Area",className:"diagnosticsReportTableTh",style:columnWidthStyle},this.props.dataContext.get_AreaText()),th3=React.DOM.th({key:"Mashup",className:"diagnosticsReportTableTh",style:columnWidthStyle},this.props.dataContext.get_MashupText()),th4=React.DOM.th({key:"Memory",className:"diagnosticsReportTableTh",style:columnWidthStyle},this.props.dataContext.get_MemoryText()),tableHead=React.DOM.thead({key:"keyTableHead"},React.DOM.tr({key:"keyTableHeader",className:"diagnosticsReportTableTr"},[th1,th2,th3,th4])),tableRecords=[],i=0;i<memoryUsageReportInfo.length;i++){var tableRow;tableRow=React.DOM.tr({key:"tr"+i},React.DOM.td({key:"td1"+i,className:"diagnosticsReportTableTd",style:columnWidthStyle},memoryUsageReportInfo[i].Timestamp),React.DOM.td({key:"td2"+i,className:"diagnosticsReportTableTd",style:columnWidthStyle},memoryUsageReportInfo[i].Area),React.DOM.td({key:"td3"+i,className:"diagnosticsReportTableTd",style:columnWidthStyle},memoryUsageReportInfo[i].EventName),React.DOM.td({key:"td4"+i,className:"diagnosticsReportTableTd",style:columnWidthStyle},memoryUsageReportInfo[i].MemoryUsage));tableRecords.push(tableRow)}var tableBody=React.DOM.tbody({key:"keydiagnosticsReportTableBody"},tableRecords),refreshButtonContainer=React.DOM.div({key:"refreshButtonSection",className:"mashupDiagnosticsFooterSection mashupDiagnosticsReportFooterSection mashupDiagnosticsFooterSectionLeft"},React.DOM.button({className:"mashupDiagnosticsButton",onClick:this.handleRefreshButton},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_RefreshButtonText()))),snapshotButtonContainer=React.DOM.div({key:"snapshotButtonSection",className:"mashupDiagnosticsFooterSection mashupDiagnosticsReportFooterSection"},React.DOM.button({className:"mashupDiagnosticsButton",onClick:this.handleSnapshotButton},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_SnapshotButtonText()))),closeButtonContainer=React.DOM.div({key:"closeButtonSection",className:"mashupDiagnosticsFooterSection mashupDiagnosticsReportFooterSection mashupDiagnosticsFooterSectionRight"},React.DOM.button({className:"mashupDiagnosticsButton dialogCancelButton",onClick:this.handleCloseButton},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_CloseButtonText()))),diagnosticsReportDivFooter=React.DOM.div({key:"keydiagnosticsReportFooter",className:"diagnosticsReportFooter"},[refreshButtonContainer,snapshotButtonContainer,closeButtonContainer]),diagnosticsReportDiv=React.DOM.div({key:"divPerfResultHeader",className:"diagnosticsReportHeaderDiv",style:diagnosticsReportDivWidth},React.DOM.span({className:"diagnosticsReportHeader"},this.props.dataContext.get_DiagnosticsReportHeaderText()),React.DOM.table({key:"keydiagnosticsReportTable",className:"diagnosticsReportTable"},[tableHead,tableBody]),diagnosticsReportDivFooter);return React.DOM.div({className:"diagnosticsReportForm-popup"},diagnosticsReportDiv)};return DiagnosticsReportSpec}(TsAdapter.SpecBase);exports.DiagnosticsReport=TsAdapter.createComponent(new DiagnosticsReportSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/DiagnosticsSettings",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Switch"],function(require,exports,TsAdapter,DataWrapperComponent,Switch){var DiagnosticsSettingsSpec=function(_super){__extends(DiagnosticsSettingsSpec,_super);function DiagnosticsSettingsSpec(){_super.apply(this,arguments);this.displayName="DiagnosticsSettings";this.listenToProperties=["DiagnosticsEnabled","MashupsEnabled","AppCrashDetectionEnabled"]}DiagnosticsSettingsSpec.prototype.handleEnableMashupSwitchClick=function(e){var currentState=this.props.dataContext.get_MashupsEnabled();this.props.dataContext.set_MashupsEnabled(!currentState)};DiagnosticsSettingsSpec.prototype.handleCrashDetectionSwitchClick=function(e){var currentState=this.props.dataContext.get_AppCrashDetectionEnabled();this.props.dataContext.set_AppCrashDetectionEnabled(!currentState)};DiagnosticsSettingsSpec.prototype.handleDiagnosticsEnableSwitchClick=function(e){var currentState=this.props.dataContext.get_DiagnosticsEnabled();this.props.dataContext.set_DiagnosticsEnabled(!currentState)};DiagnosticsSettingsSpec.prototype.handleOkClick=function(){this.props.dataContext.get_OkCommand().execute()};DiagnosticsSettingsSpec.prototype.handleCancelClick=function(){this.props.dataContext.get_CancelCommand().execute()};DiagnosticsSettingsSpec.prototype.render=function(){var diagnosticsDivHeader=React.DOM.div({key:"diagnosticsDivHeader",className:"mashupDiagnosticsDivHeader"},React.DOM.label({key:"labelDiagnosticsHeader"},this.props.dataContext.get_DiagnosticsHeaderText())),children=[],lblEnableAll=React.DOM.label({key:"enableAll",className:"mashupDiagnosticsLabelHeader"},this.props.dataContext.get_WebResourcesAndIFramesSubHeaderText());children.push(lblEnableAll);var enableAll=React.DOM.div({key:"enableAllContentDiv",className:"mashupDiagnosticsContent"},Switch.Switch({className:"mashupDiagnosticsSwitch",turnedOn:this.props.dataContext.get_MashupsEnabled(),clientContext:this.props.clientContext,onClick:this.handleEnableMashupSwitchClick,labelOn:this.props.dataContext.get_EnableText(),labelOff:this.props.dataContext.get_DisableText()}));children.push(enableAll);var lblCrashDetection=React.DOM.label({key:"labelCrashDetectionHeader",className:"mashupDiagnosticsLabelHeader"},this.props.dataContext.get_CrashDetectionSubHeaderText());children.push(lblCrashDetection);var appCrashDetection=React.DOM.div({key:"appCrashDetectionContentDiv",className:"mashupDiagnosticsContent"},Switch.Switch({className:"mashupDiagnosticsSwitch",turnedOn:this.props.dataContext.get_AppCrashDetectionEnabled(),clientContext:this.props.clientContext,onClick:this.handleCrashDetectionSwitchClick,labelOn:this.props.dataContext.get_EnableText(),labelOff:this.props.dataContext.get_DisableText()}));children.push(appCrashDetection);var lblDebugMode=React.DOM.label({key:"labelDebugModeHeader",className:"mashupDiagnosticsLabelHeader"},this.props.dataContext.get_DebugModeSubHeaderText());children.push(lblDebugMode);var diagnosticsEnabled=React.DOM.div({key:"enableDiagnosticsContentDiv",className:"mashupDiagnosticsContent"},Switch.Switch({className:"mashupDiagnosticsSwitch",turnedOn:this.props.dataContext.get_DiagnosticsEnabled(),clientContext:this.props.clientContext,onClick:this.handleDiagnosticsEnableSwitchClick,labelOn:this.props.dataContext.get_EnableText(),labelOff:this.props.dataContext.get_DisableText()}));children.push(diagnosticsEnabled);var diagnosticsDivContent=React.DOM.div({key:"contentContainerDiv",className:"mashupDiagnosticsDivContentContainer"},children),cancelButtonContainer=React.DOM.div({key:"mashupDiagnosticsCancelFooterSection",className:"mashupDiagnosticsFooterSection"},React.DOM.button({key:"keyCancelButton",className:"mashupDiagnosticsButton dialogCancelButton",onClick:this.handleCancelClick},React.DOM.div({key:"cancelButtonLabel",className:"SimpleButtonLabel"},this.props.dataContext.get_CancelButtonText()))),okButtonContainer=React.DOM.div({key:"mashupDiagnosticsOkFooterSection",className:"mashupDiagnosticsFooterSection"},React.DOM.button({key:"keyOkButton",className:"mashupDiagnosticsButton",onClick:this.handleOkClick},React.DOM.div({key:"okButtonLabel",className:"SimpleButtonLabel"},this.props.dataContext.get_OkButtonText()))),diagnosticsDivFooter=React.DOM.div({key:"diagnosticsFooterDiv",className:"mashupDiagnosticsDivFooter"},[cancelButtonContainer,okButtonContainer]);return React.DOM.div({className:"mashupDiagnosticsDivPopupContent"},[diagnosticsDivHeader,diagnosticsDivContent,diagnosticsDivFooter])};return DiagnosticsSettingsSpec}(TsAdapter.SpecBase);exports.DiagnosticsSettings=DataWrapperComponent.wrapComponent(new DiagnosticsSettingsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/DeviceSettings",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ComboBox","Components/Primitives/Switch"],function(require,exports,TsAdapter,DataWrapperComponent,ComboBox,Switch){var DeviceSettingsSpec=function(_super){__extends(DeviceSettingsSpec,_super);function DeviceSettingsSpec(){_super.apply(this,arguments);this.displayName="DeviceSettings";this.listenToProperties=["CameraEnabled","DeviceAccessEnabled","AudioEnabled","PhotoSaveEnabled"]}DeviceSettingsSpec.prototype.handleEnableCameraSwitchClick=function(e){var currentState=this.props.dataContext.get_CameraEnabled();this.props.dataContext.set_CameraEnabled(!currentState)};DeviceSettingsSpec.prototype.handleEnableDeviceAccessSwitchClick=function(e){var currentState=this.props.dataContext.get_DeviceAccessEnabled();this.props.dataContext.set_DeviceAccessEnabled(!currentState)};DeviceSettingsSpec.prototype.handleEnablePhotoSaveSwitchClick=function(e){var currentState=this.props.dataContext.get_PhotoSaveEnabled();this.props.dataContext.set_PhotoSaveEnabled(!currentState)};DeviceSettingsSpec.prototype.componentDidMount=function(){this.props.dataContext.get_ComboBoxViewModel().set_SelectedItem(this.props.dataContext.get_ImageRes())};DeviceSettingsSpec.prototype.handleOkClick=function(){this.props.dataContext.get_OkCommand().execute()};DeviceSettingsSpec.prototype.handleCancelClick=function(){this.props.dataContext.get_CancelCommand().execute()};DeviceSettingsSpec.prototype.render=function(){var isCameraAvailable=this.props.dataContext.get_IsCameraAvailable(),controlList=[],deviceSettingsDivHeader=React.DOM.div({key:"deviceSettingsDivHeader",className:"deviceSettingsDivHeader"},React.DOM.label({key:"labelDeviceSettingsHeader"},this.props.dataContext.get_DeviceSettingsHeaderText())),deviceSettingsSubHeader1=React.DOM.div({key:"deviceSettingsSubHeader1",className:"deviceSettingsSubHeader"},React.DOM.label({key:"labelDeviceSettingsSubHeader1"},this.props.dataContext.get_DeviceSettingsSubHeaderText1())),children=[];if(isCameraAvailable){var cameraEnabled=React.DOM.div({key:"enableCameraContentDiv",className:"deviceSettingsContent"},React.DOM.label({key:"labelEnableCamera",className:"deviceSettingsLabel"},this.props.dataContext.get_CameraText()),Switch.Switch({key:"cameraEnabledSwitch",className:"deviceSettingsCheckbox",turnedOn:this.props.dataContext.get_CameraEnabled(),clientContext:this.props.clientContext,onClick:this.handleEnableCameraSwitchClick,labelOn:this.props.dataContext.get_OnSwitchText(),labelOff:this.props.dataContext.get_OffSwitchText()}));children.push(cameraEnabled)}var deviceAccessEnabled=React.DOM.div({key:"deviceAccessContentDiv",className:"deviceSettingsContent"},React.DOM.label({key:"labelEnableDeviceAccess",className:"deviceSettingsLabel"},this.props.dataContext.get_DeviceAccessText()),Switch.Switch({key:"DeviceAccessEnabledSwitch",className:"deviceSettingsCheckbox",turnedOn:this.props.dataContext.get_DeviceAccessEnabled(),clientContext:this.props.clientContext,onClick:this.handleEnableDeviceAccessSwitchClick,labelOn:this.props.dataContext.get_OnSwitchText(),labelOff:this.props.dataContext.get_OffSwitchText()}));children.push(deviceAccessEnabled);var deviceSettingsDivContent1=React.DOM.div({key:"contentContainerDiv1",className:"deviceSettingsDivContentContainer"},children);controlList.push(deviceSettingsDivHeader,deviceSettingsSubHeader1,deviceSettingsDivContent1);if(isCameraAvailable){var deviceSettingsSubHeader2=React.DOM.div({key:"deviceSettingsSubHeader2",className:"deviceSettingsSubHeader"},React.DOM.label({key:"labelDeviceSettingsSubHeader2"},this.props.dataContext.get_DeviceSettingsSubHeaderText2())),children2=[],imageSize=React.DOM.div({key:"enableAudioContentDiv1",className:"deviceSettingsContent"},React.DOM.label({key:"labelImageResolution1",className:"deviceSettingsLabel"},this.props.dataContext.get_ImageResText()),ComboBox.ComboBox({key:"ImageResolutionList",className:"imageCheckbox deviceSettingsComboBox",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_ComboBoxViewModel()}));children2.push(imageSize);var deviceSettingsDivContent2=React.DOM.div({key:"contentContainerDiv2",className:"deviceSettingsDivContentContainer"},children2);controlList.push(deviceSettingsSubHeader2,deviceSettingsDivContent2)}if(isCameraAvailable){var deviceSettingsSubHeader3=React.DOM.div({key:"deviceSettingsSubHeader3",className:"deviceSettingsSubHeader"},React.DOM.label({key:"labelDeviceSettingsSubHeader3"},this.props.dataContext.get_DeviceSettingsSubHeaderText3())),children3=[];if(!this.props.clientContext.userAgent.get_IsWindowsPhone81()){var savePhoto=React.DOM.div({key:"savePhotoToLibrary",className:"deviceSettingsContent"},React.DOM.label({key:"labelSavePhoto",className:"deviceSettingsLabel"},this.props.dataContext.get_PhotoSaveText()),Switch.Switch({key:"SavePhotoSwitch",className:"deviceSettingsCheckbox",turnedOn:this.props.dataContext.get_PhotoSaveEnabled(),clientContext:this.props.clientContext,onClick:this.handleEnablePhotoSaveSwitchClick,labelOn:this.props.dataContext.get_OnSwitchText(),labelOff:this.props.dataContext.get_OffSwitchText()}));children3.push(savePhoto)}var deviceSettingsDivContent3=React.DOM.div({key:"contentContainerDiv3",className:"deviceSettingsDivContentContainer"},children3);controlList.push(deviceSettingsSubHeader3,deviceSettingsDivContent3)}var cancelButtonContainer=React.DOM.div({key:"deviceSettingsCancelFooterSection",className:"deviceSettingsFooterSection"},React.DOM.button({key:"keyCancelButton",className:"deviceSettingsButton",onClick:this.handleCancelClick},React.DOM.div({key:"cancelButtonLabel",className:"SimpleButtonLabel"},this.props.dataContext.get_CancelButtonText()))),okButtonContainer=React.DOM.div({key:"deviceSettingsOkFooterSection",className:"deviceSettingsFooterSection"},React.DOM.button({key:"keyOkButton",className:"deviceSettingsButton",onClick:this.handleOkClick},React.DOM.div({key:"okButtonLabel",className:"SimpleButtonLabel"},this.props.dataContext.get_OkButtonText()))),deviceSettingsDivFooter=React.DOM.div({key:"deviceSettingsFooterDiv",className:"deviceSettingsDivFooter"},[cancelButtonContainer,okButtonContainer]);controlList.push(deviceSettingsDivFooter);return React.DOM.div({className:"deviceSettingsDivPopupContent"},controlList)};return DeviceSettingsSpec}(TsAdapter.SpecBase);exports.DeviceSettings=DataWrapperComponent.wrapComponent(new DeviceSettingsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/AppCrashDetected",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/ImageCheckbox"],function(require,exports,TsAdapter,DataWrapperComponent,ImageCheckbox){var AppCrashDetectedSpec=function(_super){__extends(AppCrashDetectedSpec,_super);function AppCrashDetectedSpec(){_super.apply(this,arguments);this.displayName="AppCrashDetected";this.listenToProperties=["DisableAllMashups","DoNotShowMessageAgain"]}AppCrashDetectedSpec.prototype.handleDisableAllMashupsCheckboxClick=function(e){var currentState=this.props.dataContext.get_DisableAllMashups();this.props.dataContext.set_DisableAllMashups(!currentState)};AppCrashDetectedSpec.prototype.handleDoNotShowMessageAgainCheckboxClick=function(e){var currentState=this.props.dataContext.get_DoNotShowMessageAgain();this.props.dataContext.set_DoNotShowMessageAgain(!currentState)};AppCrashDetectedSpec.prototype.handleOkClick=function(){this.props.dataContext.get_OkCommand().execute()};AppCrashDetectedSpec.prototype.handleCancelClick=function(){this.props.dataContext.get_CancelCommand().execute()};AppCrashDetectedSpec.prototype.render=function(){var header=React.DOM.span({key:"appCrashDetectedHeader",className:"mashupDiagnosticsDivHeader"},this.props.dataContext.get_AppCrashDetectedHeaderText()),children=[],disableAllMashupsCheckbox=ImageCheckbox.ImageCheckbox({key:"diagnosticsEnabledCheckbox",className:"imageCheckbox  mashupDiagnosticsCheckbox",checked:this.props.dataContext.get_DisableAllMashups(),onClick:this.handleDisableAllMashupsCheckboxClick}),disableAllMashupsCheckboxText=React.DOM.label({key:"disableAllMashupsLabel",className:"mashupDiagnosticsLabel"},this.props.dataContext.get_DisableAllMashupCheckBoxText());children.push(disableAllMashupsCheckbox);children.push(disableAllMashupsCheckboxText);var content=React.DOM.div({key:"contentContainerDiv",className:"mashupDiagnosticsDivContentContainer"},children),doNotShowMessageAgain=React.DOM.div({key:"doNotShowMessageAgain",className:"mashupDiagnosticsContentFooter"},ImageCheckbox.ImageCheckbox({key:"diagnosticsEnabledCheckbox",className:"imageCheckbox  mashupDiagnosticsCheckbox",checked:this.props.dataContext.get_DoNotShowMessageAgain(),onClick:this.handleDoNotShowMessageAgainCheckboxClick}),React.DOM.label({key:"disableAllMashupsLabel",className:"mashupDiagnosticsLabel"},this.props.dataContext.get_DoNotShowMessageAgainCheckBoxText())),cancelButtonContainer=React.DOM.div({key:"mashupDiagnosticsCancelFooterSection",className:"mashupDiagnosticsFooterSection"},React.DOM.button({key:"keyCancelButton",className:"mashupDiagnosticsButton dialogCancelButton",onClick:this.handleCancelClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_CancelButtonText()))),okButtonContainer=React.DOM.div({key:"mashupDiagnosticsOkFooterSection",className:"mashupDiagnosticsFooterSection"},React.DOM.button({key:"keyOkButton",className:"mashupDiagnosticsButton",onClick:this.handleOkClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_OkButtonText()))),footer=React.DOM.div({key:"diagnosticsFooterDiv",className:"mashupDiagnosticsDivFooter"},[cancelButtonContainer,okButtonContainer]);return React.DOM.div({className:"mashupDiagnosticsDivPopupContent"},[header,content,doNotShowMessageAgain,footer])};return AppCrashDetectedSpec}(TsAdapter.SpecBase);exports.AppCrashDetected=DataWrapperComponent.wrapComponent(new AppCrashDetectedSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/QuickCreateNote/QuickCreateNoteEntityItem",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent"],function(require,exports,TsAdapter,DataWrapperComponent){var QuickCreateNoteEntityItemSpec=function(_super){__extends(QuickCreateNoteEntityItemSpec,_super);function QuickCreateNoteEntityItemSpec(){_super.apply(this,arguments);this.displayName="QuickCreateNoteEntityItem"}QuickCreateNoteEntityItemSpec.prototype.openCreateForm=function(e){this.props.dataContext.getAndExecuteSubgridAddCommand();var closeParentFormCommand=this.props.dataContext.get_CloseParentForm();closeParentFormCommand&&closeParentFormCommand.execute()};QuickCreateNoteEntityItemSpec.prototype.render=function(){var itemTitle=React.DOM.div({key:"item_title"},this.props.dataContext.get_DisplayName()),itemDescription=React.DOM.div({key:"item_description"},this.props.dataContext.get_Description()),delimiter=React.DOM.div({key:"delimiter"},"---");return React.DOM.div({key:"container",className:"item_container",onClick:this.openCreateForm},itemTitle,itemDescription,delimiter)};return QuickCreateNoteEntityItemSpec}(TsAdapter.SpecBase);exports.QuickCreateNoteEntityItem=DataWrapperComponent.wrapComponent(new QuickCreateNoteEntityItemSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/QuickCreateNote/QuickCreateNoteForm",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Utils/CssClassSet","Components/Dialogs/QuickCreateButton","Components/Fields/ComboBox","Components/QuickCreateNote/QuickCreateNoteEntityItem"],function(require,exports,TsAdapter,DataWrapperComponent,CssClassSet,QuickCreateButton,ComboBox,QuickCreateNoteEntityItem){var QuickCreateNoteFormSpec=function(_super){__extends(QuickCreateNoteFormSpec,_super);function QuickCreateNoteFormSpec(){_super.apply(this,arguments);this.displayName="QuickCreateNoteForm";this.listenToProperties=["ItemsChanged","SelectedItem"]}QuickCreateNoteFormSpec.prototype.onFilterTextChanged=function(event){if(event&&event.target){var target=event.target;this.props.dataContext.set_FilterText(target.value)}};QuickCreateNoteFormSpec.prototype.renderFooter=function(){var actions=[],close=QuickCreateButton.QuickCreateButton({key:"close",clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_CloseCommand(),label:this.props.dataContext.get_CloseButtonTitle(),tabIndex:null,symbolName:"Cancel",dataId:"close"});actions.push(close);return React.DOM.div({key:"actions",className:CssClassSet({quickCreateNoteForm_actionDivContainer:true})},actions)};QuickCreateNoteFormSpec.prototype.renderHeader=function(){return React.DOM.span({key:"header",className:"quickCreateNoteForm_header"},this.props.dataContext.get_Label())};QuickCreateNoteFormSpec.prototype.renderBody=function(){if(!this.props.dataContext.get_IsModelInitialized())return React.DOM.div({key:"body",className:CssClassSet({quickCreateNoteForm_bodyContainer:true})});var children=[],title=React.DOM.span({key:"combobox_title",className:CssClassSet({combobox_title:true})},this.props.dataContext.get_ComboBoxTitle()),combobox=ComboBox.ComboBox({key:"entities_combobox",className:CssClassSet({entity_dropdown:true}),clientContext:this.props.clientContext,dataContext:this.props.dataContext.get_ComboBoxViewModel(),renderAsDropDown:true}),comboboxContainer=React.DOM.div({key:"combobox_container",className:CssClassSet({entities_combobox_container:true})},title,combobox);children.push(comboboxContainer);var filter=React.DOM.input({className:"filterTextBox",key:"entityFilter",role:"textbox",type:this.props.clientContext.getTextBoxTypeString(5),"data-id":"searchText",placeholder:this.props.clientContext.getLocalizedString("L_InteractionWall_SearchPlaceholder")+" ...",onChange:this.onFilterTextChanged});children.push(filter);if(this.props.dataContext.get_Items().get_Count()>0){for(var items=[],i=0;i<this.props.dataContext.get_Items().get_Count();i++){var item=this.props.dataContext.get_Items().get_Items()[i];items.push(QuickCreateNoteEntityItem.QuickCreateNoteEntityItem({key:"item-"+i,dataContext:item,clientContext:this.props.clientContext}))}var itemsContainer=React.DOM.div({key:"items_cotainer",className:CssClassSet({items_container:true})},items);children.push(itemsContainer)}return React.DOM.div({key:"body",className:CssClassSet({quickCreateNoteForm_bodyContainer:true})},children)};QuickCreateNoteFormSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet({"quickCreateNoteForm-popup":true}),"data-id":"quickCreateNoteForm"},this.renderHeader(),this.renderBody(),this.renderFooter())};return QuickCreateNoteFormSpec}(TsAdapter.SpecBase);exports.QuickCreateNoteForm=DataWrapperComponent.wrapComponent(new QuickCreateNoteFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/ScriptErrorHandlerDialog",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Core/Binding/FocusHandlerMixin","Components/Common/Constants"],function(require,exports,TsAdapter,PureUpdate,Button,FocusHandlerMixin,Constants){var ScriptErrorHandlerDialogSpec=function(_super){__extends(ScriptErrorHandlerDialogSpec,_super);function ScriptErrorHandlerDialogSpec(){_super.apply(this,arguments);this.displayName="ScriptErrorHandlerDialog";this.listenToProperties=["ActiveNavigationStack","Top"];this.mixins=[PureUpdate.Mixin,FocusHandlerMixin.Mixin]}ScriptErrorHandlerDialogSpec.prototype.handleFocus=function(){if(this.props.dataContext.get_IsInteractionCentricEnabled()){var okButton=ReactDOM.findDOMNode(this.refs["scriptErrorDialogOkButton"]);okButton!=null&&$(okButton).focus()}};ScriptErrorHandlerDialogSpec.prototype.handleOkClick=function(){var command=this.props.dataContext.get_OkCommand();command&&command.get_CanExecute()&&command.execute()};ScriptErrorHandlerDialogSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_CancelCommand();command&&command.get_CanExecute()&&command.execute()};ScriptErrorHandlerDialogSpec.prototype.handlePrivacyLinkClick=function(){var command=this.props.dataContext.get_ViewPrivacyStatementCommand();command&&command.get_CanExecute()&&command.execute()};ScriptErrorHandlerDialogSpec.prototype.handleDetailsLinkClick=function(){var command=this.props.dataContext.get_ViewDetailsCommand();command&&command.get_CanExecute()&&command.execute()};ScriptErrorHandlerDialogSpec.prototype.handleChangeSettingLinkClick=function(){var command=this.props.dataContext.get_ViewHowToChangeNotificationSettingsCommand();command&&command.get_CanExecute()&&command.execute()};ScriptErrorHandlerDialogSpec.prototype.handleEscapeKeyDown=function(e){e.keyCode==Constants.ESCAPE_KEY_CODE&&this.handleCancelClick()};ScriptErrorHandlerDialogSpec.prototype.handlePrivacyLinkKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handlePrivacyLinkClick();break;case Constants.TAB_KEY_CODE:var cancelButton=ReactDOM.findDOMNode(this.refs["scriptErrorDialogCancelButton"]);if(e.shiftKey&&cancelButton!=null){$(cancelButton).focus();e.preventDefault()}break}};ScriptErrorHandlerDialogSpec.prototype.handleDetailsLinkKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleDetailsLinkClick();break}};ScriptErrorHandlerDialogSpec.prototype.handleChangeSettingLinkKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleChangeSettingLinkClick();break}};ScriptErrorHandlerDialogSpec.prototype.handleOkButtonKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleOkClick();break}};ScriptErrorHandlerDialogSpec.prototype.handleCancelButtonKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleCancelClick();break;case Constants.TAB_KEY_CODE:var privacyLink=this.refs["scriptErrorDialogPrivacyLink"];if(!e.shiftKey&&privacyLink instanceof Element){$(privacyLink).focus();e.preventDefault()}break}};ScriptErrorHandlerDialogSpec.prototype.renderContentContainer=function(){var titleContent=React.DOM.p({style:{marginBottom:"20px"}},React.DOM.span({"data-id":"messageDialogTitle"},this.props.dataContext.get_MessageTitle())),title=React.DOM.span({key:"title",className:"messageDialog-Title"},titleContent),subTitle=React.DOM.p({key:"subTitle",style:{fontWeight:"bold"}},React.DOM.span(null,this.props.dataContext.get_MessageSubtitle())),message=React.DOM.p({key:"message",style:{marginBottom:"15px"}},React.DOM.span({"data-id":"messageDialogMessage"},React.DOM.span({dangerouslySetInnerHTML:{__html:this.props.dataContext.get_Message()}}))),messageContainer=React.DOM.span({key:"message",className:"messageDialog-Message"},[subTitle,message]),privacyLink=React.DOM.p({key:"privacyLink",style:{marginBottom:"15px"}},React.DOM.a({ref:"scriptErrorDialogPrivacyLink",onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handlePrivacyLinkKeyDown:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onClick:this.handlePrivacyLinkClick},this.props.dataContext.get_ViewPrivacyStatementText())),detailsLink=React.DOM.p({key:"detailsLink",style:{marginBottom:"15px"}},React.DOM.a({onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleDetailsLinkKeyDown:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onClick:this.handleDetailsLinkClick},this.props.dataContext.get_ViewDetailsText())),changeSettingLink=React.DOM.p({key:"changeSettingLink"},React.DOM.a({onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleChangeSettingLinkKeyDown:null,tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_StartIndex():null,onClick:this.handleChangeSettingLinkClick},this.props.dataContext.get_ViewHowToChangeNotificationSettingsText())),actionLinks=React.DOM.span({key:"actionLinks",className:"messageDialog-ActionLink"},[privacyLink,detailsLink,changeSettingLink]);return React.DOM.div({key:"contentContainer",className:"messageDialog-contentContainer",onKeyDown:this.handleEscapeKeyDown},[title,messageContainer,actionLinks])};ScriptErrorHandlerDialogSpec.prototype.renderActionContainer=function(){var okButton=Button.Button({key:"Ok",ref:"scriptErrorDialogOkButton",className:"dynamicsButton messageDialog_OK_Button",onClick:this.handleOkClick,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleOkButtonKeyDown:null,dataId:"Ok",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_NextTabIndex():null},this.props.dataContext.get_OkButtonText()),cancelButton=Button.Button({key:"Cancel",ref:"scriptErrorDialogCancelButton",className:"dynamicsButton messageDialog_Cancel_Button",onClick:this.handleCancelClick,onKeyDown:this.props.dataContext.get_IsInteractionCentricEnabled()?this.handleCancelButtonKeyDown:null,dataId:"Cancel",tabIndex:this.props.dataContext.get_IsInteractionCentricEnabled()?this.props.dataContext.get_NextTabIndex():null},this.props.dataContext.get_CancelButtonText()),buttonContainer=React.DOM.span({className:"messageDialog-buttonContainer"},[okButton,cancelButton]);return React.DOM.div({key:"actionContainer",className:"messageDialog-actionContainer",onKeyDown:this.handleEscapeKeyDown},React.DOM.span({className:"messageDialog-buttons"},buttonContainer))};ScriptErrorHandlerDialogSpec.prototype.render=function(){return React.DOM.div({className:"watson messageDialog-popupContent","data-id":"messageDialog"},[this.renderContentContainer(),this.renderActionContainer()])};return ScriptErrorHandlerDialogSpec}(TsAdapter.SpecBase);exports.ScriptErrorHandlerDialog=TsAdapter.createComponent(new ScriptErrorHandlerDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/SenderCreateForm",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Dialogs/QuickCreateForm","Utils/CssClassSet"],function(require,exports,TsAdapter,PureUpdate,QuickCreateForm,CssClassSet){var SenderCreateFormSpec=function(_super){__extends(SenderCreateFormSpec,_super);function SenderCreateFormSpec(){_super.apply(this,arguments);this.displayName="SenderCreateForm";this.mixins=[PureUpdate.Mixin]}SenderCreateFormSpec.prototype.render=function(){return React.DOM.div({className:CssClassSet(null,this.props.className,"senderCreateForm")},QuickCreateForm.QuickCreateForm({clientContext:this.props.clientContext,dataContext:this.props.dataContext,descriptor:this.props.descriptor}))};return SenderCreateFormSpec}(TsAdapter.SpecBase);exports.SenderCreateForm=TsAdapter.createComponent(new SenderCreateFormSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/MailApp/MailAppMessageDialog",["require","exports","Core/ReactTypescriptAdapter","Core/Binding/PureUpdateMixin","Components/Primitives/Button","Utils/CssClassSet","Components/Common/Constants","Core/Binding/FocusHandlerMixin","Components/Primitives/FontIcon"],function(require,exports,TsAdapter,PureUpdate,Button,CssClassSet,Constants,FocusHandlerMixin,FontIcon){var MailAppMessageDialogSpec=function(_super){__extends(MailAppMessageDialogSpec,_super);function MailAppMessageDialogSpec(){_super.apply(this,arguments);this.displayName="MailAppMessageDialog";this.mixins=[PureUpdate.Mixin,FocusHandlerMixin.Mixin];this.listenToProperties=["ActiveNavigationStack","Top"]}MailAppMessageDialogSpec.prototype.handleOkClick=function(){var command=this.props.dataContext.get_OkCommand();command&&command.get_CanExecute()&&command.execute()};MailAppMessageDialogSpec.prototype.handleOkKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleOkClick();break;case Constants.TAB_KEY_CODE:var lastElement=this.refs["lastElement"],lastElementNode=ReactDOM.findDOMNode(lastElement);if(e.shiftKey&&lastElementNode){$(lastElementNode).focus();e.preventDefault()}break;default:break}};MailAppMessageDialogSpec.prototype.handleCancelClick=function(){var command=this.props.dataContext.get_CancelCommand();command&&command.get_CanExecute()&&command.execute()};MailAppMessageDialogSpec.prototype.handleActionClick=function(){var command=this.props.dataContext.get_ActionCommand();command&&command.get_CanExecute()&&command.execute()};MailAppMessageDialogSpec.prototype.handleCloseClick=function(){this.props.dataContext.Close()};MailAppMessageDialogSpec.prototype.handleCancelKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleCancelClick();break;case Constants.TAB_KEY_CODE:var firstElement=this.refs["firstElement"];if(!e.shiftKey&&firstElement){$(ReactDOM.findDOMNode(firstElement)).focus();e.preventDefault()}break}};MailAppMessageDialogSpec.prototype.handleActionKeyDown=function(e){switch(e.keyCode){case Constants.ENTER_KEY_CODE:case Constants.SPACE_KEY_CODE:this.handleActionClick();break;case Constants.TAB_KEY_CODE:var firstElement=this.refs["firstElement"];if(!e.shiftKey&&firstElement){$(ReactDOM.findDOMNode(firstElement)).focus();e.preventDefault()}break}};MailAppMessageDialogSpec.prototype.componentWillMount=function(){this.activeElementBeforeOpening=document.activeElement};MailAppMessageDialogSpec.prototype.componentWillUnmount=function(){this.activeElementBeforeOpening&&$(this.activeElementBeforeOpening).focus()};MailAppMessageDialogSpec.prototype.handleFocus=function(){var firstElement=this.refs["firstElement"],okButton=ReactDOM.findDOMNode(firstElement),dialogBody=$(".messageDialog-MessageBody span");if(okButton!=null&&dialogBody!=null){var dialogBodyText=dialogBody.text(),okButtonText=$(okButton).text(),ariaLabelText=this.props.dataContext.get_MessageTitle()+" "+this.props.dataContext.get_MessageSubtitle()+" "+dialogBodyText+" "+okButtonText;ariaLabelText=this.props.dataContext.get_IsInteractionCentricEnabled()?ariaLabelText:null;$(okButton).attr("aria-label",ariaLabelText);$(okButton).focus()}};MailAppMessageDialogSpec.prototype.handleEscapeKeyDown=function(e){if(e.keyCode==Constants.ESCAPE_KEY_CODE)if(this.props.dataContext.get_MailAppDialogType()===2)this.handleCloseClick();else this.handleCancelClick()};MailAppMessageDialogSpec.prototype.renderContentContainer=function(){var dialogType=this.props.dataContext.get_DialogType(),mailAppDialogType=this.props.dataContext.get_MailAppDialogType(),okCancelType=1,okCancelActionType=3,messageTitle=this.props.dataContext.get_MessageTitle(),messageSubtitle=this.props.dataContext.get_MessageSubtitle(),title=messageTitle?React.DOM.span({key:"title",className:CssClassSet({"messageDialog-Title":true,information:dialogType===okCancelType||mailAppDialogType===okCancelActionType}),"data-id":"messageDialogTitle"},messageTitle):null,subTitle=messageSubtitle?React.DOM.span({key:"subTitle",className:"messageDialog-Subtitle","data-id":"messageDialogSubtitle"},messageSubtitle):null,messageObject=this.props.dataContext.get_MessageObject()?this.props.dataContext.get_MessageObject():React.DOM.span({dangerouslySetInnerHTML:{__html:this.props.dataContext.get_ProcessedMessage()}}),message=React.DOM.div({key:"messageBody",className:"messageDialog-Message messageDialog-MessageBody","data-id":"messageDialogMessage"},messageObject);return React.DOM.div({key:"contentContainer",className:"messageDialog-contentContainer"},React.DOM.span({className:"messageDialog-message"},[title,subTitle,message]))};MailAppMessageDialogSpec.prototype.renderActionContainer=function(){var dialogType=this.props.dataContext.get_DialogType(),mailAppDialogType=this.props.dataContext.get_MailAppDialogType(),okCancelType=1,okCancelActionType=3,okButtonText=this.props.dataContext.get_OkButtonText(),cancelButtonText=this.props.dataContext.get_CancelButtonText(),actionLinkText=this.props.dataContext.get_ActionLinkText(),linkLabel=this.props.dataContext.get_ActionLinkPrefixText(),nextTabIndex=this.props.dataContext.get_StartIndex(),buttons=[],actionHyperlink=React.DOM.a({label:actionLinkText,onClick:this.handleActionClick,key:"Action",ref:"lastElement",className:"messageDialog_Action_Link",tabIndex:nextTabIndex++,onKeyDown:this.handleActionKeyDown},actionLinkText),okButton=Button.Button({key:"Ok",ref:"firstElement",className:"dynamicsButton messageDialog_OK_Button",onClick:this.handleOkClick,dataId:"Ok",tabIndex:nextTabIndex++,onKeyDown:this.handleOkKeyDown},okButtonText);buttons.push(okButton);if(dialogType===okCancelType||mailAppDialogType===okCancelActionType){var cancelButton=Button.Button({key:"Cancel",ref:"lastElement",className:"dynamicsButton messageDialog_Cancel_Button",onClick:this.handleCancelClick,dataId:"Cancel",tabIndex:nextTabIndex++,onKeyDown:this.handleCancelKeyDown,ariaLabel:cancelButtonText},cancelButtonText);buttons.push(cancelButton)}var buttonContainer=React.DOM.span({key:"messageDialog-buttonContainer",className:"messageDialog-buttonContainer"},buttons),linkContainer=React.DOM.span({key:"messageDialog-linkContainer",className:"messageDialog-linkContainer"},[linkLabel+" ",actionHyperlink]),buttonAndLinkContainer=React.DOM.span({key:"messageDialog-buttonAndLinkContainer",className:"messageDialog-buttonAndLinkContainer"},mailAppDialogType===okCancelActionType?[linkContainer,buttonContainer]:buttonContainer);return React.DOM.div({key:"messageDialog-actionContainer",className:"messageDialog-actionContainer",onKeyDown:this.handleEscapeKeyDown},React.DOM.span({key:"messageDialog-buttons",className:"messageDialog-buttons"},buttonAndLinkContainer))};MailAppMessageDialogSpec.prototype.renderCloseButton=function(){if(this.props.dataContext.get_MailAppDialogType()===2){var fontIcon=FontIcon.FontIcon({symbolName:"Cancel",key:"cancel-icon"});return React.DOM.span({key:"close-button",className:"closeNotificationButton",tabIndex:100,onClick:this.handleCloseClick},fontIcon)}return null};MailAppMessageDialogSpec.prototype.render=function(){return React.DOM.div({id:"MailAppConfirmDialog","data-id":"messageDialog","data-vmid":this.props.dataContext.get_ViewModelId(),className:"messageDialog-popupContent"},[this.renderContentContainer(),this.renderActionContainer(),this.renderCloseButton()])};return MailAppMessageDialogSpec}(TsAdapter.SpecBase);exports.MailAppMessageDialog=TsAdapter.createComponent(new MailAppMessageDialogSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/LandingPage/LandingPageSettings",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Fields/ComboBox","Components/Primitives/ProgressIndicator","Components/Primitives/Switch","Utils/CssClassSet"],function(require,exports,TsAdapter,DataWrapperComponent,ComboBox,ProgressIndicator,Switch,CssClassSet){var LandingPageSettingsSpec=function(_super){__extends(LandingPageSettingsSpec,_super);function LandingPageSettingsSpec(){_super.apply(this,arguments);this.displayName="LandingPageSettings";this.listenToProperties=["OpenOnStart","IsLoaded"]}LandingPageSettingsSpec.prototype.handleOkClick=function(){this.props.dataContext.get_OkCommand().execute()};LandingPageSettingsSpec.prototype.handleCancelClick=function(){this.props.dataContext.get_CancelCommand().execute()};LandingPageSettingsSpec.prototype.handleSwitchClick=function(e){var openOnStart=this.props.dataContext.get_OpenOnStart();this.props.dataContext.set_OpenOnStart(!openOnStart)};LandingPageSettingsSpec.prototype.render=function(){var header=React.DOM.div({key:"headerContainer",className:"mashupDiagnosticsDivHeader"},React.DOM.label({},this.props.dataContext.get_LandingPageSettingsHeaderText())),children=[];if(this.props.dataContext.get_IsLoaded()){var enableOnStartLabel=React.DOM.label({key:"enableOnStart",className:CssClassSet({mashupDiagnosticsLabelHeader:true,landingPageSettings:true})},this.props.dataContext.get_OnStartSubHeaderText()),enableOnStartDiv=React.DOM.div({key:"enableOnStartDiv",className:CssClassSet({mashupDiagnosticsContent:true,landingPageSettings:true})},Switch.Switch({turnedOn:this.props.dataContext.get_OpenOnStart(),clientContext:this.props.clientContext,onClick:this.handleSwitchClick,labelOn:this.props.dataContext.get_EnableText(),labelOff:this.props.dataContext.get_DisableText()}));children.push(React.DOM.div({key:"openLandingPageOnStart",className:CssClassSet({mashupDiagnosticsDivContentContainer:true,landingPageSettings:true})},enableOnStartLabel,enableOnStartDiv));if(this.props.dataContext.get_IsTaskFlowSettingsAvailable()){var taskFlow1Element=ComboBox.ComboBox({key:"taskFlow1ComboBox",clientContext:this.props.clientContext,renderAsDropDown:true,dataContext:this.props.dataContext.get_TaskFlow1(),className:"mashupDiagnosticsDivContentContainer"});children.push(taskFlow1Element);var taskFlow2Element=ComboBox.ComboBox({key:"taskFlow2ComboBox",clientContext:this.props.clientContext,selectElementdataId:"sortFilterSelected",renderAsDropDown:true,dataContext:this.props.dataContext.get_TaskFlow2(),className:"mashupDiagnosticsDivContentContainer"});children.push(taskFlow2Element)}}else children.push(ProgressIndicator.ProgressIndicator({key:"loadingItem",type:ProgressIndicator.ProgressIndicatorType.Bar,active:true}));var content=React.DOM.div({key:"contentContainer",className:"mashupDiagnosticsDivContentContainer"},children),cancelButtonContainer=React.DOM.div({key:"cancelButtonContainer",className:"mashupDiagnosticsFooterSection"},React.DOM.button({className:"mashupDiagnosticsButton dialogCancelButton",onClick:this.handleCancelClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_CancelButtonText()))),okButtonContainer=React.DOM.div({key:"okButtonContainer",className:"mashupDiagnosticsFooterSection"},React.DOM.button({className:"mashupDiagnosticsButton",onClick:this.handleOkClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_OkButtonText()))),footer=React.DOM.div({key:"footerContainer",className:"mashupDiagnosticsDivFooter"},[cancelButtonContainer,okButtonContainer]);return React.DOM.div({className:"landingPageSettings mashupDiagnosticsDivPopupContent"},[header,content,footer])};return LandingPageSettingsSpec}(TsAdapter.SpecBase);exports.LandingPageSettings=DataWrapperComponent.wrapComponent(new LandingPageSettingsSpec)});var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}__.prototype=b.prototype;d.prototype=new __};define("Components/Dialogs/PaneStackingSettings",["require","exports","Core/ReactTypescriptAdapter","Components/DataWrapperComponent","Components/Primitives/Switch"],function(require,exports,TsAdapter,DataWrapperComponent,Switch){var PaneStackingSettingsSpec=function(_super){__extends(PaneStackingSettingsSpec,_super);function PaneStackingSettingsSpec(){_super.apply(this,arguments);this.displayName="PaneStackingSettings";this.listenToProperties=["IsStackingEnabled"]}PaneStackingSettingsSpec.prototype.handleOkClick=function(){this.props.dataContext.get_OkCommand().execute()};PaneStackingSettingsSpec.prototype.handleCancelClick=function(){this.props.dataContext.get_CancelCommand().execute()};PaneStackingSettingsSpec.prototype.handleSwitchClick=function(e){var currentState=this.props.dataContext.get_IsStackingEnabled();this.props.dataContext.set_IsStackingEnabled(!currentState)};PaneStackingSettingsSpec.prototype.renderHeader=function(){return React.DOM.div({className:"mashupDiagnosticsDivHeader"},React.DOM.label({key:"labelDiagnosticsHeader"},this.props.dataContext.get_PaneStackingSettingsHeaderText()))};PaneStackingSettingsSpec.prototype.renderFooter=function(){var cancelButtonContainer=React.DOM.div({className:"mashupDiagnosticsFooterSection"},React.DOM.button({className:"mashupDiagnosticsButton dialogCancelButton",onClick:this.handleCancelClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_CancelButtonText()))),okButtonContainer=React.DOM.div({className:"mashupDiagnosticsFooterSection"},React.DOM.button({className:"mashupDiagnosticsButton",onClick:this.handleOkClick},React.DOM.div({className:"SimpleButtonLabel"},this.props.dataContext.get_OkButtonText())));return React.DOM.div({className:"mashupDiagnosticsDivFooter"},[cancelButtonContainer,okButtonContainer])};PaneStackingSettingsSpec.prototype.renderBody=function(){var children=[];children.push(React.DOM.label({className:"mashupDiagnosticsLabelHeader"},this.props.dataContext.get_PaneStackingEnabledLabelText()));children.push(React.DOM.div({className:"mashupDiagnosticsContent"},Switch.Switch({className:"mashupDiagnosticsSwitch",turnedOn:this.props.dataContext.get_IsStackingEnabled(),clientContext:this.props.clientContext,onClick:this.handleSwitchClick,labelOn:this.props.dataContext.get_EnableText(),labelOff:this.props.dataContext.get_DisableText()})));return React.DOM.div({className:"mashupDiagnosticsDivContentContainer"},children)};PaneStackingSettingsSpec.prototype.render=function(){return React.DOM.div({className:"mashupDiagnosticsDivPopupContent paneStackingSettings"},[this.renderHeader(),this.renderBody(),this.renderFooter()])};return PaneStackingSettingsSpec}(TsAdapter.SpecBase);exports.PaneStackingSettings=DataWrapperComponent.wrapComponent(new PaneStackingSettingsSpec)});define("Components",["require","exports","Components/Shell/ApplicationShell","Components/MailApp/MailAppShell","Utils/DeferredPromise","Components/ComponentFeatureControl","Core/Binding/PureUpdateMixin","Components/Shell/DialogConductor","Components/Dialogs/QuickCreateForm","Components/Dialogs/CrmDialog","Components/Dialogs/AboutDialog","Components/Dialogs/MessageDialog","Components/Dialogs/AssociateForm","Components/Dialogs/ImageUploadDialog","Components/Dialogs/InlineCreateForm","Components/GlobalLookup/GlobalLookup","Components/BusinessProcess/SwitchProcessDialog","Components/TaskBasedFlow/TaskBasedFlowContainer","Components/Dialogs/DiagnosticsReport","Components/Dialogs/DiagnosticsSettings","Components/Dialogs/DeviceSettings","Components/Dialogs/AppCrashDetected","Components/QuickCreateNote/QuickCreateNoteForm","Components/Dialogs/ScriptErrorHandlerDialog","Components/MailApp/MailAppCreateForm","Components/MailApp/SenderCreateForm","Components/MailApp/MailAppMessageDialog","Components/LandingPage/LandingPageSettings","Components/Dialogs/PaneStackingSettings"],function(require,exports,applicationShell,mailAppShell,deferredPromise,ComponentFeatureControl,PureUpdate,DialogConductor,QuickCreateForm,CrmDialog,AboutDialog,MessageDialog,AssociateForm,ImageUploadDialog,InlineCreateForm,GlobalLookup,SwitchProcessDialog,TaskBasedFlowContainer,DiagnosticsReport,DiagnosticsSettings,DeviceSettings,AppCrashDetected,QuickCreateNoteForm,ScriptErrorHandlerDialog,MailAppCreateForm,SenderCreateForm,MailAppMessageDialog,LandingPageSettings,PaneStackingSettings){DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.AssociateFormViewModel",AssociateForm.AssociateForm,{dismissOnBlur:true,mountInConductor:false});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.GlobalLookupViewModel",GlobalLookup.GlobalLookup,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.SwitchProcessDialogViewModel",SwitchProcessDialog.SwitchProcessDialog,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.ImageUploadDialogViewModel",ImageUploadDialog.ImageUploadDialog,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.InlineCreateFormViewModel",InlineCreateForm.InlineCreateForm,{dismissOnBlur:true,mountInConductor:false});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.AboutDialogViewModel",AboutDialog.AboutDialog,{slideTop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.QuickCreateNoteViewModel",QuickCreateNoteForm.QuickCreateNoteForm,{slideTop:true,useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.TaskBasedFlowContainerViewModel",TaskBasedFlowContainer.TaskBasedFlowContainer,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.QuickCreateFormViewModel",QuickCreateForm.QuickCreateForm,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.CrmDialogViewModel",CrmDialog.CrmDialog,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.ScriptErrorHandlerViewModel",ScriptErrorHandlerDialog.ScriptErrorHandlerDialog,{slideTop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.AppCrashDetectedViewModel",AppCrashDetected.AppCrashDetected,{useBackdrop:true,slideTop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.DiagnosticsReportViewModel",DiagnosticsReport.DiagnosticsReport,null);DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.DeviceSettingsViewModel",DeviceSettings.DeviceSettings,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.DiagnosticsSettingsViewModel",DiagnosticsSettings.DiagnosticsSettings,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.MessageDialogViewModel",MessageDialog.MessageDialog,{slideTop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.Controls.LandingPage.LandingPageSettingsViewModel",LandingPageSettings.LandingPageSettings,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.Controls.PaneStackingSettingsViewModel",PaneStackingSettings.PaneStackingSettings,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.MailApp.MailAppCreateFormViewModel",MailAppCreateForm.MailAppCreateForm,{dismissOnBlur:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.MailApp.SenderCreateFormViewModel",SenderCreateForm.SenderCreateForm,{useBackdrop:true});DialogConductor.registerComponentForViewModel("Microsoft.Crm.Client.Core.ViewModels.MailApp.MailAppMessageDialogViewModel",MailAppMessageDialog.MailAppMessageDialog,{slideTop:true});var Components;(function(Components){Components.ApplicationShell=applicationShell.ApplicationShell;Components.MailAppShell=mailAppShell.MailAppShell;Components.DeferredPromiseFactory=deferredPromise.DeferredPromiseFactory;function RegisterComponentsUnderFeatureControl(featureControlManager){ComponentFeatureControl.registerComponentsUnderFeatureControl(featureControlManager)}Components.RegisterComponentsUnderFeatureControl=RegisterComponentsUnderFeatureControl;function ObjectsEqual(objA,objB){return PureUpdate.propertyObjectsEqual(objA,objB)}Components.ObjectsEqual=ObjectsEqual})(Components||(Components={}));return Components})