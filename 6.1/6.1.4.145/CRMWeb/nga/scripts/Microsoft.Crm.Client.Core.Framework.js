Type.registerNamespace("Microsoft.Crm.Client.Core.Framework");Microsoft.Crm.Client.Core.Framework.$El=function(){};Microsoft.Crm.Client.Core.Framework.$El.registerInterface("Microsoft.Crm.Client.Core.Framework.$El");Microsoft.Crm.Client.Core.Framework.$Hg=function(){};Microsoft.Crm.Client.Core.Framework.$Hg.registerInterface("Microsoft.Crm.Client.Core.Framework.$Hg");Microsoft.Crm.Client.Core.Framework.AuthenticationManager=function(a,b,c){this.$$d_$2BC=Function.createDelegate(this,this.$2BC);this.$$d_$27V=Function.createDelegate(this,this.$27V);this.$cV=new($a.List.$$(Microsoft.Crm.Client.Core.Framework.$El));Microsoft.Crm.Client.Core.Framework.AuthenticationManager.initializeBase(this);this.$52="https://"+a;this.$u1=b;this.$XG=-1;this.$16R=true;this.$go=c};Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$Io=function(b,c,d){var a=c?2:1;return new Microsoft.Crm.Client.Core.Framework.AuthenticationManager($a.$2E.$1pf(b),a,d)};Microsoft.Crm.Client.Core.Framework.AuthenticationManager.get_defaultInstance=function(){return Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$7};Microsoft.Crm.Client.Core.Framework.AuthenticationManager.set_defaultInstance=function(a){if(!Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$7)Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$7=a;else $a.Trace.logWarning(159,"Warning: Auth manager is being changed within a session");return a};Microsoft.Crm.Client.Core.Framework.AuthenticationManager.prototype={$u1:0,$52:null,$lV:false,$16R:false,$S1:null,$wT:null,$XG:0,$1E9:0,$ae:false,$OK:false,$go:false,$1Ze:null,$1Zd:null,get_$18p:function(){var a=this.$S1-new Date;return a-6e4},get_$1Mo:function(){return this.get_$18p()<0},$u0:function(){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Starting");if(this.$u1!==2){this.$1K3();return}if($a.$5.$L(this.get_$fW())){var a=false;if(this.$OK){this.$OK=false;a=true}this.$cZ(a)}else{Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Starting authorization");this.$1BZ()}},get_$fW:function(){return this.$E(Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$u4)},set_$fW:function(a){this.$D(Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$u4,a);return a},add_$EU:function(a){this.$5S("OnAuthenticated",a)},remove_$EU:function(a){this.$5a("OnAuthenticated",a)},$1Tq:function(){this.$cZ(true)},onCookieAvailable:function(){this.$ae=false;window.clearTimeout(this.$1E9);if(!this.$lV){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Complete");this.$1K3()}},$29y:function(a){!this.$cV.contains(a)&&this.$cV.add(a)},$2BC:function(){this.$cZ(false)},$cZ:function(a){if(!$a.NativeBridge.get_$4().$9V.$3T)return;this.$lV=true;this.$ae=true;this.$OK=false;this.set_$fW(null);if(this.$XG!==-1){if(a)Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Starting re-authentication");else this.$16R=false;window.clearTimeout(this.$XG);this.$XG=-1}this.$go=!!(this.$go|a);$a.NativeBridge.get_$4().$9V.$2Ak(a,this.$$d_$27V)},$27V:function(b){if($a.$5.$L(b)){$a.$w.$Ak(97,"AuthenticationProvider.RefreshAuthToken",this.$$d_$2BC,150);return}this.$lV=false;if(this.$1ty(b)){Microsoft.Dynamics.Client.Core.Framework.$13.$Fg("Authentication: Failed");if(this.$16R){this.$OK=true;this.$jo(Microsoft.Dynamics.Client.Core.Framework.$6.$2K(Microsoft.Dynamics.Client.Core.Framework.$H.$2m))}else this.$1Tq()}else{var a=Microsoft.Crm.Client.Core.Framework.$D4.$B(b);Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Token received");a.$1Ui!==new $a.Uri(this.$52)&&$a.Trace.logWarning(159,"Resource URI and Server URI mismatch");this.$wT=a;this.set_$fW(a.$u3);this.$S1=a.$S1;Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Starting authorization");this.$1BZ()}},$1ty:function(a){return a==="AuthError"},$1BZ:function(){if(this.get_$1Mo()){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Token Expired with Token Timeout value ("+this.get_$18p()+") --- Retrieving new Auth Token from shim");this.$cZ(true);return}var a=this,b=this;this.$R3().then(function(){a.$6C(a.$wT.$qc).then(function(){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Authorization complete");a.$17f()},function(b){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Authorization error: "+b.$m);a.$jo(b)})},function(){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Authorization error: "+Microsoft.Dynamics.Client.Core.Framework.$H.$2m);b.$jo(Microsoft.Dynamics.Client.Core.Framework.$6.$2K(Microsoft.Dynamics.Client.Core.Framework.$H.$2m))})},$6C:function(f){var a=Microsoft.Dynamics.Client.Core.Imported.jQueryDeferredFactory.Deferred(Boolean,Microsoft.Dynamics.Client.Core.Framework.$6),d=this.$cV.get_count();if(!d)a.resolve(true);else{for(var e=[],b=0;b<d;b++)Array.add(e,this.$cV.get_$2Hy(b).$6C(f));var c=this,g=this;$.when.apply(null,e).then(new Microsoft.Dynamics.Client.Core.Framework.$45(function(g){for(var e=g,f=e.length,b=0;b<f;++b){var d=e[b];if(Microsoft.Crm.Client.Core.Framework.$DU.isInstanceOfType(d)){c.$1Ze=d.$2i;c.$1Zd=d.$5m;break}}a.resolve(true)}).$$d_$1CL,function(b){a.reject(b)})}return a.promise()},$17f:function(){var a=this.get_$18p();if(this.get_$1Mo())a=0;else{this.$ae=true;this.$OK=false;this.$2De()}window.clearTimeout(this.$XG);var b=this;this.$XG=window.setTimeout(function(){b.$cZ(true)},a)},$2De:function(){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Starting cookie setup");if(!this.$go){Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Cookie setup not needed, the token is still valid.");this.onCookieAvailable();return}$get("authToken").setAttribute("value",this.$wT.$qc);$get("wctx").setAttribute("value","ru="+CrmEncodeDecode.CrmUrlEncode(this.$52)+"/nga/main.aspx");var b=$get("authForm");b.action=this.$52;var a=this;this.$1E9=window.setTimeout(function(){a.$ae=false;a.$OK=true;Microsoft.Dynamics.Client.Core.Framework.$13.$1A("Authentication: Failed - cookie setup");a.$jo(Microsoft.Dynamics.Client.Core.Framework.$6.$2K(Microsoft.Dynamics.Client.Core.Framework.$H.$2m))},6e4);b.submit()},get_$rV:function(){return this.$OK?2:!this.$lV&&!this.$ae?1:0},$2Gz:function(a){this.$u1===2&&a.setRequestHeader("Authorization",this.get_$fW())},$17x:function(){if($a.UserAgent.getInstance().get_$4k())$a.NativeBridge.get_$4().$9V.$17x();else this.$17b()},$1Tn:function(){if($a.UserAgent.getInstance().get_$4k())$a.NativeBridge.get_$4().$9V.$1Tn();else this.$17b()},$1CW:function(){if($a.UserAgent.getInstance().get_$4k())$a.NativeBridge.get_$4().$9V.$1CW();else this.$17b()},$17b:function(){var a=window.location.hostname,b=window.location.port,c=$a.$5.$L(b)?a:$a.$5.$19("{0}:{1}",a,b),d=window.location.protocol+"//"+c;window.location.href=d+"/main.aspx?signout=1"},$R3:function(){$.support.cors=true;var a={};a.cache=false;a.type="HEAD";a.url="/nga/main.htm";var b=Microsoft.Dynamics.Client.Core.Imported.jQueryDeferredFactory.Deferred(Object,Microsoft.Dynamics.Client.Core.Framework.$6),c=new Microsoft.Dynamics.Client.Core.Framework.$1W("Ping");c.$1G();var d=this;b.always(function(){c.$1Z()});var e=this,f=this;$.ajax(a).success(function(){b.resolve()}).error(function(){b.reject()});return b.promise()},$jo:function(a){a.$Tr=1;this.$a0("OnAuthenticated",this,new Microsoft.Crm.Client.Core.Framework.$At(true,a,null,null))},$1K3:function(){this.$a0("OnAuthenticated",this,new Microsoft.Crm.Client.Core.Framework.$At(false,null,this.$1Ze,this.$1Zd))}};Microsoft.Crm.Client.Core.Framework.$At=function(a,b,c,d){Microsoft.Crm.Client.Core.Framework.$At.initializeBase(this);this.$JB=a;this.$FK=b;this.$2i=c;this.$5m=d};Microsoft.Crm.Client.Core.Framework.$At.prototype={$JB:false,$FK:null,$2i:null,$5m:null};Microsoft.Crm.Client.Core.Framework.$Dg=function(a){Microsoft.Crm.Client.Core.Framework.$Dg.initializeBase(this);this.$1Su(a)};Microsoft.Crm.Client.Core.Framework.$Dg.prototype={$1Su:function(a){var c=true;a.$1y("t","http://schemas.xmlsoap.org/ws/2005/02/trust");a.$1y("wsu","http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd");a.$1y("xenc","http://www.w3.org/2001/04/xmlenc#");a.$1y("wsp","http://schemas.xmlsoap.org/ws/2004/09/policy");a.$1y("wsa","http://www.w3.org/2005/08/addressing");var b=a.$8("/t:RequestSecurityTokenResponse/wsp:AppliesTo/wsa:EndpointReference/wsa:Address");if(b&&b.get_$K().indexOf("urn:")===-1)this.$1Ui=new $a.Uri(b.get_$K());else c=false;var g=a.$8("/t:RequestSecurityTokenResponse");this.$qc=g.get_$7W();var h=a.$8("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken");this.$u3=h.$9a().get_$2Hy(0).get_$7W();if(c){this.$S1=new Date;var i=a.$8("/t:RequestSecurityTokenResponse/t:Lifetime");if(i){var j=a.$8("/t:RequestSecurityTokenResponse/t:Lifetime/wsu:Expires"),d=j.get_$K();if(!$a.$5.$L(d))this.$S1=new Date(d)}}else{a.$1y("saml","urn:oasis:names:tc:SAML:1.0:assertion");var e=a.$8("/t:RequestSecurityTokenResponse/t:RequestedSecurityToken/saml:Assertion/saml:Conditions");if(e){var f=e.$4B("NotOnOrAfter").toString();if(!$a.$5.$L(f))this.$S1=new Date(f)}}}};Microsoft.Crm.Client.Core.Framework.$DU=function(a,b){this.$2i=a;this.$5m=b};Microsoft.Crm.Client.Core.Framework.$DU.prototype={$2i:null,$5m:null};Microsoft.Crm.Client.Core.Framework.$Fp=function(a){Microsoft.Crm.Client.Core.Framework.$Fp.initializeBase(this);this.$1Su(a)};Microsoft.Crm.Client.Core.Framework.$Fp.prototype={$1Su:function(a){var b=a.$8("/RequestOAuthSecurityTokenResponse/AccessToken");this.$u3=b.get_$K();var c=a.$8("/RequestOAuthSecurityTokenResponse/EncodedAccessToken"),d=c.get_$K(),e=a.$8("/RequestOAuthSecurityTokenResponse/ExpiresOn");this.$S1=new Date(e.get_$K());this.$qc=String.format('<t:RequestSecurityTokenResponse xmlns:t="http://schemas.xmlsoap.org/ws/2005/02/trust">\r\n\t<t:Lifetime>\r\n\t\t<wsu:Created xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">2013-05-21T00:58:40.544Z</wsu:Created>\r\n\t\t<wsu:Expires xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">2013-05-22T00:58:40.544Z</wsu:Expires>\r\n\t</t:Lifetime>\r\n\t<wsp:AppliesTo xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy">\r\n\t\t<EndpointReference xmlns="http://www.w3.org/2005/08/addressing">\r\n\t\t\t<Address>https://kevinwhi9852org2.crm.crmlivetoday.com/</Address>\r\n\t\t</EndpointReference>\r\n\t</wsp:AppliesTo>\r\n\t<t:RequestedSecurityToken>\r\n\t\t<wsse:BinarySecurityToken wsu:Id="_febfbc5a-99cf-4298-ae6f-7d752db4cb24-FECE4032DF73C0855F4B4BA9EAEB9E47" ValueType="urn:ietf:params:oauth:token-type:jwt" EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">{0}</wsse:BinarySecurityToken>\r\n\t</t:RequestedSecurityToken>\r\n\t<t:TokenType>urn:ietf:params:oauth:token-type:jwt</t:TokenType>\r\n\t<t:RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</t:RequestType>\r\n\t<t:KeyType>http://schemas.xmlsoap.org/ws/2005/05/identity/NoProofKey</t:KeyType>\r\n</t:RequestSecurityTokenResponse>',d)}};Microsoft.Crm.Client.Core.Framework.$D4=function(){};Microsoft.Crm.Client.Core.Framework.$D4.$B=function(b){b=$a.$5.$2AZ(b,"");var c=Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$y(b),a=Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B(c),d=a.$8("/RequestOAuthSecurityTokenResponse/AccessToken");return d?new Microsoft.Crm.Client.Core.Framework.$Fp(a):new Microsoft.Crm.Client.Core.Framework.$Dg(a)};Microsoft.Crm.Client.Core.Framework.$D4.prototype={$qc:null,$u3:null,$S1:null,$1Ui:null};Type.registerNamespace("Microsoft.Crm.Client.Core.Storage.Common.Xml");Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq=function(){};Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq.registerInterface("Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq");Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q=function(b){this.$4x=new($a.List.$$(Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G));for(var a=0;a<b.length;a++)this.$4x.add(b[a])};Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q.prototype={$4x:null,get_$C:function(){return this.$4x.get_count()},get_$2Hy:function(a){return this.$4x.get_items()[a]}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G=function(b,a){Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G.initializeBase(this);this.$41=b;this.$9I=$a.$0.$0(a)?{}:a};Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G.prototype={$41:null,$9I:null,get_$K:function(){return this.$41.hasChildNodes()?this.$41.firstChild.nodeValue:null},get_$7W:function(){return(new XMLSerializer).serializeToString(this.$41)},get_$DN:function(){return this.$41.nodeName},get_$Ia:function(){return this.$41},$4B:function(a){return this.$41.getAttribute(a)},$1y:function(a,b){this.$9I[a]=b},$8:function(b){var a=this.$1Vx(b,true);return!a.get_$C()?null:a.get_$2Hy(0)},$50:function(a){return this.$1Vx(a,false)},$Gu:function(e){var a;if($a.$0.$0(this.$41.ownerDocument))a=this.$41.getElementsByTagName(e);else a=this.$41.ownerDocument.getElementsByTagName(e);for(var b=[],c=0;c<a.length;c++)Array.add(b,a[c]);var g=this.$1Iu(e);Array.addRange(b,g);for(var f=[],d=0;d<b.length;d++)Array.add(f,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G(b[d],this.$9I));return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q(f)},$9a:function(){for(var b=[],a=0,c=this.$41.childNodes.length;a<c;a++)Array.add(b,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G(this.$41.childNodes[a],this.$9I));return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q(b)},$jv:function(){return this.$41.hasChildNodes()},$1Vx:function(a,m){var b=[];if(a.startsWith("//")||a.startsWith(".//")){var o=2,p=false;if(a.startsWith(".")){o++;p=true}a=a.substr(o);var c=a.indexOf("/"),e,h;if(c<0){e=a;h=null}else{e=a.substr(0,c);h=a.substr(c+1)}c=e.indexOf("[");var f,d;if(c<0){f=e;d=null}else{f=e.substr(0,c);d=e.substr(c+1);c=d.indexOf("]");d=d.substr(0,c)}var i;if(p||$a.$0.$0(this.$41.ownerDocument))i=this.$41.getElementsByTagName(f);else i=this.$41.ownerDocument.getElementsByTagName(f);for(var g=[],k=0;k<i.length;k++)Array.add(g,i[k]);var q=this.$1Iu(f);Array.addRange(g,q);var j=g;if(g.length>0&&null!==d)j=this.$yV(g,d);if(!j.length||null===h)b=j;else b=this.$17B(j,h,m)}else if(a.startsWith("/")){if($a.$0.$0(this.$41.ownerDocument))Array.add(b,this.$41);else Array.add(b,this.$41.ownerDocument);b=this.$17B(b,a.substr(1),m)}else{Array.add(b,this.$41);b=this.$17B(b,a,m)}for(var n=[],l=0;l<b.length;l++)Array.add(n,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G(b[l],this.$9I));return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q(n)},$17B:function(a,b,c){return c?this.$2CN(a,b):this.$1Vs(a,b)},$2CN:function(b,c){if($a.$0.$0(c)||c.length<1)return b;for(var d=[],a=0;a<b.length;a++){var e=this.$1Vt(b[a],c);if(!$a.$0.$0(e)){Array.add(d,e);break}}return d},$1Vt:function(i,d){if($a.$0.$0(d)||d.length<1)return i;var a=d.indexOf("/"),c,e;if(a<0){c=d;e=null}else{c=d.substr(0,a);e=d.substr(a+1)}a=c.indexOf("[");var j,b;if(a<0){j=c;b=null}else{j=c.substr(0,a);b=c.substr(a+1);a=b.indexOf("]");b=b.substr(0,a)}for(var f=null,g=0,l=i.childNodes.length;g<l;g++)if(this.$11a(i.childNodes[g],j)){var k=[];Array.add(k,i.childNodes[g]);var h=k;if(null!==b)h=this.$yV(k,b);if(h.length>0)if(null===e){f=h[0];break}else{f=this.$1Vt(h[0],e);if(f)break}}return f},$1Vs:function(h,a){if($a.$0.$0(a)||a.length<1)return h;var d=a.indexOf("/"),e,b;if(d<0){e=a;b=null}else{e=a.substr(0,d);b=a.substr(d+1)}for(var c=[],f,g=0;g<h.length;g++){f=this.$2CL(h[g],e);f.length>0&&Array.addRange(c,f)}return!c.length||null===b?c:this.$1Vs(c,b)},$2CL:function(g,e){var b=e.indexOf("["),f,a;if(b<0){f=e;a=null}else{f=e.substr(0,b);a=e.substr(b+1);b=a.indexOf("]");a=a.substr(0,b)}for(var c=[],d=0,i=g.childNodes.length;d<i;d++)this.$11a(g.childNodes[d],f)&&Array.add(c,g.childNodes[d]);var h=c;if(c.length>0&&null!==a)h=this.$yV(c,a);return h},$yV:function(i,b){var h=b.startsWith("@");if(h)b=b.substr(1);var e=b.indexOf("="),c,a;if(e<0){c=b;a=null}else{c=b.substr(0,e);a=b.substr(e+1);a=a.substr(1);a=a.substr(0,a.length-1)}for(var f=[],g=0;g<i.length;g++){var d=i[g];if(h&&this.$1nG(d,c,a))Array.add(f,d);else this.$1nH(d,c,a)&&Array.add(f,d)}return f},$1nG:function(a,b,c){return null===c?a.hasAttribute(b):c===a.getAttribute(b)},$1nH:function(b,e,c){for(var a=0,d=b.childNodes.length;a<d;a++)if(this.$11a(b.childNodes[a],e))if(null===c)return true;else if(b.childNodes[a].firstChild.nodeValue===c)return true;return false},$1Iu:function(f){var c=[],d=this.$1JE(f);if($a.$0.$0(d)||d.length<1)return c;var e=this.$1J9(f),a;if($a.$0.$0(this.$41.ownerDocument))a=this.$41.getElementsByTagName(e);else a=this.$41.ownerDocument.getElementsByTagName(e);for(var b=0;b<a.length;b++)a[b].namespaceURI===d&&Array.add(c,a[b]);return c},$1JE:function(b){var a=b.indexOf(":");if(a<0)return"";var c=b.substr(0,a),d=this.$9I[c];return d},$1J9:function(a){var b=a.indexOf(":");return b<0?a:a.substr(b+1)},$11a:function(c,a){if(c.nodeName===a||"*"===a)return true;var b=this.$1JE(a);if($a.$0.$0(b)||b.length<1)return false;var d=this.$1J9(a);return c.namespaceURI===b&&c.localName===d}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL=function(e,f,g){this.$4x=[];var a=f;if(!$a.$0.$0(a.length))for(var b=0;b<a.length;b++)Array.add(this.$4x,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L(e,a[b],g));else for(var d=f,c=0;c<d.snapshotLength;c++)Array.add(this.$4x,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L(e,d.snapshotItem(c),g))};Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL.prototype={$4x:null,get_$C:function(){return this.$4x.length},get_$2Hy:function(a){return this.$4x[a]}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$46=function(a,j,p){Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.initializeBase(this);this.$O4=a;if($a.$0.$0(j)){var b=a.match(Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.$vl),f=b[1];b=a.match(new RegExp("xmlns:([\\w]+)=[\"']http://schemas.datacontract.org/2004/07/System.Collections.Generic[\"']"));var k=b[1];b=a.match(new RegExp("xmlns:([\\w]+)=[\"']http://schemas.microsoft.com/xrm/2011/Metadata[\"']"));var l=b[1];b=a.match(new RegExp("xmlns:([\\w]+)=[\"']http://www.w3.org/2001/XMLSchema-instance[\"']"));var m=b[1],g=$a.$5.$19("<{0}:EntityMetadata>",f),d=$a.$5.$19("</{0}:EntityMetadata>",f),e=a.indexOf(g),h=a.lastIndexOf(d);if(e<0||h<0||e>=h)throw Error.argument("Not a valid RetrieveMetadataChanges response XML");this.$Bg=Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B(Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$y(a.substring(0,e)+"<placeholder/>"+a.substring(h+d.length,a.length)));var n=String.format("<{0}:EntityMetadata xmlns:{0}='{1}' xmlns:{2}='{3}' xmlns:{4}='{5}' xmlns:{6}='{7}'>",f,"http://schemas.microsoft.com/xrm/2011/Contracts",k,"http://schemas.datacontract.org/2004/07/System.Collections.Generic",l,"http://schemas.microsoft.com/xrm/2011/Metadata",m,"http://www.w3.org/2001/XMLSchema-instance"),c=e,i=new($a.List.$$(Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g));while(c>0){var o=Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$y(n+a.substring(c+g.length,a.indexOf(d,c)+d.length));i.add(Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B(o).$9a().get_$2Hy(0));c=a.indexOf(g,c+1)}this.$ES=i.get_items()}else{this.$Bg=j;this.$ES=p}this.$11X=Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.$1uF(this.$Bg)};Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.$1uF=function(a){return!$a.$0.$0(a.get_$DN())&&(a.get_$DN().endsWith(":value")||a.get_$DN()==="value")&&a.get_$Ia().namespaceURI==="http://schemas.datacontract.org/2004/07/System.Collections.Generic"&&a.$jv()&&a.$9a().get_$2Hy(0).get_$DN()==="placeholder"};Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.prototype={$Bg:null,$ES:null,$11X:false,$O4:null,get_$Ia:function(){return this.$Bg.get_$Ia()},get_$K:function(){return this.$Bg.get_$K()},get_$7W:function(){if($a.$0.$0(this.$O4)){this.$O4=this.$Bg.get_$7W();if(this.$O4.indexOf("<placeholder/>")>=0){for(var f=this.$O4.match(Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.$vl),d=f[1],a=new Sys.StringBuilder,c=this.$ES,e=c.length,b=0;b<e;++b){var g=c[b];a.append($a.$5.$19("<{0}:EntityMetadata>",d));a.append(g.$9a().get_$2Hy(0).get_$7W());a.append($a.$5.$19("</{0}:EntityMetadata>",d))}this.$O4=this.$O4.replace("<placeholder/>",a.toString())}}return this.$O4},get_$DN:function(){return this.$Bg.get_$DN()},$1y:function(c,d){this.$Bg.$1y(c,d);for(var b=this.$ES,e=b.length,a=0;a<e;++a){var f=b[a];f.$1y(c,d)}},$8:function(a){if(a.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",a,"This XmlNode implementation doesn't support queries for EntityMetadata");return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$46(null,this.$Bg.$8(a),this.$ES)},$50:function(a){if(a===".//a:KeyValuePairOfstringanyType[b:key='EntityMetadata']/b:value/a:EntityMetadata")return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q(this.$ES);else if(a===".//d:ExecuteResult/a:Results/a:KeyValuePairOfstringanyType/b:value[@i:type='a:EntityMetadataCollection']/a:EntityMetadata/c:Attributes/c:AttributeMetadata"){for(var h=a.substring(a.indexOf("a:EntityMetadata/")+17,a.length),e=new($a.List.$$(Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g)),d=this.$ES,g=d.length,b=0;b<g;++b)for(var i=d[b],f=i.$50(h),c=0;c<f.get_$C();c++)e.add(f.get_$2Hy(c));return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q(e.get_items())}else if(a.indexOf("a:EntityMetadata")>=0)throw Error.argumentOutOfRange("expression",a,"This XmlNode implementation doesn't support arbitrary queries for EntityMetadata");else return this.$Bg.$50(a)},$4B:function(a){return this.$Bg.$4B(a)},$Gu:function(g){for(var c=new($a.List.$$(Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g)),a=this.$Bg.$Gu(g),d=0;d<a.get_$C();d++)c.add(new Microsoft.Crm.Client.Core.Storage.Common.Xml.$46(null,a.get_$2Hy(d),this.$ES));for(var f=this.$ES,h=f.length,b=0;b<h;++b){var i=f[b];a=i.$Gu(g);for(var e=0;e<a.get_$C();e++)c.add(a.get_$2Hy(e))}return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q(c.get_items())},$9a:function(){if(this.$11X)return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q(this.$ES);else{for(var b=this.$Bg.$9a(),c=new($a.List.$$(Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g)),a=0;a<b.get_$C();a++)c.add(new Microsoft.Crm.Client.Core.Storage.Common.Xml.$46(null,b.get_$2Hy(a),this.$ES));return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q(c.get_items())}},$jv:function(){return this.$11X?this.$ES.length>0:this.$Bg.$jv()}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q=function(a){this.$13z=a};Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q.prototype={$13z:null,get_$C:function(){return this.$13z.length},get_$2Hy:function(a){return this.$13z[a]}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g=function(){};Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g.$6Z=function(b,c,d){var a=b.createAttribute(c);a.value=d;return a};Microsoft.Crm.Client.Core.Storage.Common.Xml.$G=function(){};Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B=function(a){if($a.$0.$0(a))return null;if(Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1ME())return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al(a);else if(Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1Lq()||Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$19S)return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G(a);else{var b=new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L(a);if(!Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$18y)try{Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$18y=true;b.$8("/root")}catch(c){b=new Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G(a);Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$19S=true;$a.Trace.logInfo(1006,"XPathEvaluator doesn't work on this browser, use DOMParserNodeWrapper instead.")}return b}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$y=function(e){var a=null;if(Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1ME())for(var c=["Microsoft.XMLDOM","Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"],b=0;b<c.length;b++){a=new ActiveXObject(c[b]);if(!$a.$0.$0(a)){a.async=false;a.loadXML(e);a.setProperty("SelectionLanguage","XPath");a.setProperty("SelectionNamespaces","xmlns:d='http://schemas.microsoft.com/xrm/2011/Contracts/Services' xmlns:a='http://schemas.microsoft.com/xrm/2011/Contracts' xmlns:b='http://schemas.datacontract.org/2004/07/System.Collections.Generic' xmlns:i='http://www.w3.org/2001/XMLSchema-instance'");if(!$a.$5.$L(a.text))break}}if($a.$0.$0(a))a=Sys.Net.XMLDOM(e);if(!$a.$0.$0(a)){var f=Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B(a),d=f.$8("/parsererror");if(!$a.$0.$0(d)&&d.get_$DN()==="parsererror"){$a.Trace.logWarning(1006,"XML Parsing failure in ParseXmlDocument: {0}",Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$B(a).get_$7W());a=null}}return a};Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1ME=function(){if(!Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1Lq())return false;var e=window.DOMParser,a=true,b=false,f=window.Xrm,c=f.Page;if(!$a.$0.$0(c)){var d=c.context;if(!$a.$0.$0(d))b=d.isOutlookClient()}if(b)a=Mscrm.Utilities.get_ieBrowserVersion()<10;else a=Number.parseInvariant($.browser.version)<10;return $a.$0.$0(e)||a};Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$1Lq=function(){var a=window.navigator.userAgent;return a.indexOf("MSIE")!==-1||a.indexOf("Trident")!==-1};Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak=function(d){var b=d;this.$4x=[];for(var a=0;a<b.length;a++){var c=b[a];Array.add(this.$4x,new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al(c,true))}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak.prototype={$4x:null,get_$C:function(){return this.$4x.length},get_$2Hy:function(a){return this.$4x[a]}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al=function(b,a){Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al.initializeBase(this);this.$HK=b;this.$4P=$a.$0.$0(a)?false:a;this.$9I=this.$4P?null:{}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al.prototype={$HK:null,$9I:null,$4P:false,get_$19x:function(){return this.$HK},get_$Ia:function(){return this.$HK},get_$xL:function(){return this.$HK},get_$K:function(){return this.$HK.hasChildNodes()?this.$HK.firstChild.nodeValue:null},get_$7W:function(){return this.$HK.xml},get_$DN:function(){return this.get_$xL().tagName},$1y:function(a,b){if(!this.$4P)this.$9I[a]=b},$8:function(b){this.$1M();var a=this.$HK.selectSingleNode(b);return $a.$0.$0(a)?null:new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al(a,true)},$50:function(a){this.$1M();return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak(this.$HK.selectNodes(a))},$4B:function(a){return this.get_$19x().getAttribute(a)},$Gu:function(a){return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak(this.get_$xL().getElementsByTagName(a))},$9a:function(){return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak(this.get_$xL().childNodes)},$jv:function(){return this.$HK.hasChildNodes()},$1M:function(){if(!this.$4P){var c=new Sys.StringBuilder,d="",a=this.$9I;for(var b in a){var e={key:b,value:a[b]};c.append(String.format("{0}xmlns:{1}='{2}'",d,e.key,e.value));d=" "}this.get_$19x().setProperty("SelectionLanguage","XPath");this.get_$19x().setProperty("SelectionNamespaces",c.toString());this.$4P=true}}};Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L=function(a,b,c){this.$$d_$2B6=Function.createDelegate(this,this.$2B6);Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L.initializeBase(this);this.$PC=a;this.$41=$a.$0.$0(b)?a:b;this.$9I=$a.$0.$0(c)?{}:c};Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L.prototype={$9I:null,$PC:null,$41:null,get_$K:function(){return this.$41.hasChildNodes()?this.$41.firstChild.nodeValue:null},get_$7W:function(){return(new XMLSerializer).serializeToString(this.$41)},get_$DN:function(){return this.$41.tagName},get_$Ia:function(){return this.$41},$1y:function(a,b){this.$9I[a]=b},$8:function(b){var a=this.$PC.evaluate(b,this.$41,this.$$d_$2B6,9,null);return $a.$0.$0(a.singleNodeValue)?null:new Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L(this.$PC,a.singleNodeValue,this.$9I)},$50:function(a){return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL(this.$PC,this.$PC.evaluate(a,this.$41,this.$$d_$2B6,7,null),this.$9I)},$4B:function(a){return this.$41.getAttribute(a)},$Gu:function(a){return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL(this.$PC,this.$41.getElementsByTagName(a),this.$9I)},$9a:function(){return new Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL(this.$PC,this.$41.childNodes,this.$9I)},$jv:function(){return this.$41.hasChildNodes()},$2B6:function(a){return a in this.$9I?this.$9I[a]:null}};Microsoft.Crm.Client.Core.Framework.AuthenticationManager.registerClass("Microsoft.Crm.Client.Core.Framework.AuthenticationManager",$a.$85,Microsoft.Crm.Client.Core.Framework.$Hg);Microsoft.Crm.Client.Core.Framework.$At.registerClass("Microsoft.Crm.Client.Core.Framework.$At",Sys.EventArgs);Microsoft.Crm.Client.Core.Framework.$D4.registerClass("Microsoft.Crm.Client.Core.Framework.$D4");Microsoft.Crm.Client.Core.Framework.$Dg.registerClass("Microsoft.Crm.Client.Core.Framework.$Dg",Microsoft.Crm.Client.Core.Framework.$D4);Microsoft.Crm.Client.Core.Framework.$DU.registerClass("Microsoft.Crm.Client.Core.Framework.$DU");Microsoft.Crm.Client.Core.Framework.$Fp.registerClass("Microsoft.Crm.Client.Core.Framework.$Fp",Microsoft.Crm.Client.Core.Framework.$D4);Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$9q",null,Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq);Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g");Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$7G",Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g);Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$AL",null,Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq);Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$46",Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g);Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$8Q",null,Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq);Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$G");Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$Ak",null,Microsoft.Crm.Client.Core.Storage.Common.Xml.$Hq);Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$Al",Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g);Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L.registerClass("Microsoft.Crm.Client.Core.Storage.Common.Xml.$9L",Microsoft.Crm.Client.Core.Storage.Common.Xml.$1g);Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$u4=new $a.$E("AuthToken",String,Microsoft.Crm.Client.Core.Framework.AuthenticationManager,"",null,null);Microsoft.Crm.Client.Core.Framework.AuthenticationManager.$7=null;Microsoft.Crm.Client.Core.Storage.Common.Xml.$46.$vl=new RegExp("xmlns:([\\w]+)=[\"']http://schemas.microsoft.com/xrm/2011/Contracts[\"']");Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$19S=false;Microsoft.Crm.Client.Core.Storage.Common.Xml.$G.$18y=false