Type.registerNamespace("Mscrm.FormInputControl.Tabs");Mscrm.FormInputControl.Tabs.TabChangingEventArgs=function(){Mscrm.FormInputControl.Tabs.TabChangingEventArgs.initializeBase(this)};Mscrm.FormInputControl.Tabs.TabChangingEventArgs.prototype={$F_2:null,$K_2:null,$A_2:null,$C_2:null,$G_2:null,$5_2:null,$H_2:false,get_currentTabContainer:function(){return this.$F_2},set_currentTabContainer:function(value){this.$F_2=value;return value},get_newTabContainer:function(){return this.$K_2},set_newTabContainer:function(value){this.$K_2=value;return value},get_currentTabHeader:function(){return this.$A_2},set_currentTabHeader:function(value){this.$A_2=value;return value},get_newTabHeader:function(){return this.$C_2},set_newTabHeader:function(value){this.$C_2=value;return value},get_currentTabId:function(){return this.$G_2},set_currentTabId:function(value){this.$G_2=value;return value},get_newTabId:function(){return this.$5_2},set_newTabId:function(value){this.$5_2=value;return value},get_firstTime:function(){return this.$H_2},set_firstTime:function(value){this.$H_2=value;return value}};Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs=function(){Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs.initializeBase(this)};Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs.prototype={$M_1:0,$J_1:0,$6_1:0,$L_1:0,get_oldHeight:function(){return this.$M_1},set_oldHeight:function(value){this.$M_1=value;return value},get_newHeight:function(){return this.$J_1},set_newHeight:function(value){this.$J_1=value;return value},get_oldWidth:function(){return this.$6_1},set_oldWidth:function(value){this.$6_1=value;return value},get_newWidth:function(){return this.$L_1},set_newWidth:function(value){this.$L_1=value;return value}};Mscrm.FormInputControl.Tabs.TabsControl=function(element){this.$$d_$a_3=Function.createDelegate(this,this.$a_3);Mscrm.FormInputControl.Tabs.TabsControl.initializeBase(this,[element])};Mscrm.FormInputControl.Tabs.TabsControl.prototype={$3_3:null,$0_3:null,$8_3:null,$4_3:null,$9_3:null,$D_3:null,$6_3:0,get_tabLinksjQueryObject:function(){return this.$0_3},set_tabLinksjQueryObject:function(value){this.$0_3=value;return value},get_tabsControljQueryObject:function(){return this.$3_3},get_tabsHeaderjQueryObject:function(){return this.$9_3},get_tabsContentjQueryObject:function(){return this.$4_3},add_onTabChanging:function(value){this.get_events().addHandler("otch",value)},remove_onTabChanging:function(value){this.get_events().removeHandler("otch",value)},add_tabsContainerResized:function(value){this.get_events().addHandler("otcrd",value)},remove_tabsContainerResized:function(value){this.get_events().removeHandler("otcrd",value)},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$3_3=$P_CRM(this.get_element().parentNode);this.$9_3=this.$3_3.find(".tabsHeader");this.$4_3=this.$3_3.find(".tabsContent");this.$0_3=this.$3_3.find(".tabLink");this.$8_3=this.$3_3.find(".tabContainer");this.$V_3();this.$W_3();this.$U_3()},$V_3:function(){var $$t_7=this;this.$D_3=function($p1_0){var $v_0=$$t_7.$4_3.height(),$v_1=$$t_7.$3_3.height()-$$t_7.$9_3.height(),$v_2=$$t_7.$4_3.width();if($v_0!==$v_1||$v_2!==$$t_7.$6_3){$$t_7.$4_3.height($v_1);var $v_3=$$t_7.get_events().getHandler("otcrd");if($v_3){var $v_4=$v_3,$v_5=new Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs;$v_5.$M_1=$v_0;$v_5.$J_1=$v_1;$v_5.$6_1=$$t_7.$6_3;$v_5.$L_1=$v_2;$v_4($$t_7,$v_5)}$$t_7.$6_3=$v_2}};$P_CRM(window).resize(this.$D_3);this.$D_3(null)},$W_3:function(){for(var $v_0=0;$v_0<this.$0_3.length;$v_0++){var $v_1=$P_CRM(this.$0_3.get($v_0)),$v_2=$P_CRM(this.$8_3.get($v_0));$v_1.data("associatedTabContainer",$v_2);$v_1.click(this.$$d_$a_3)}},$U_3:function(){var $v_0=$P_CRM(document.body);if(Mscrm.CrmBrowser.get_currentBrowser().get_isTouchEnabled())!$v_0.hasClass("mobile")&&$v_0.addClass("mobile")},$a_3:function($p0){var $v_0=$P_CRM($p0.currentTarget);this.changeCurrentTab($v_0);$p0.preventDefault()},changeCurrentTab:function(tab){var $v_0=new Mscrm.Performance.PerformanceStopwatch("ChangeCurrentTab");$v_0.start();var $v_1=tab.data("associatedTabContainer"),$v_2=!Boolean.parse($v_1.attr("shown")),$v_3=this.get_events().getHandler("otch");if($v_3){var $v_5=$v_3,$v_6=new Mscrm.FormInputControl.Tabs.TabChangingEventArgs;$v_6.set_cancel(false);$v_6.$A_2=this.$3_3.find(".tabLink.active");$v_6.$F_2=this.$3_3.find(".tabContainer.active");$v_6.$C_2=tab;$v_6.$K_2=$v_1;$v_6.$G_2=$v_6.$A_2.attr("tabid");$v_6.$5_2=$v_6.$C_2.attr("tabid");$v_6.$H_2=$v_2;$v_5(this,$v_6);if($v_6.get_cancel()){$v_0.stop();return}}this.$0_3.not(tab.get()).removeClass("active");this.$8_3.not($v_1.get()).removeClass("active");tab.addClass("active");$v_1.addClass("active");$v_2&&$v_1.attr("shown","true");var $v_4=tab.attr("tabid");this.onTabChanged($v_4);$v_0.stop()},onTabChanged:function(selectedTabId){},$S_3:function($p0,$p1){if(isNullOrEmptyString($p0))return;for(var $v_0=0;$v_0<this.$0_3.length;$v_0++){var $v_1=$P_CRM(this.$0_3.get($v_0)),$v_2=$P_CRM(this.$8_3.get($v_0));if($v_1.attr("tabid")===$p0)if($p1){$v_1.show();$v_2.css("display","")}else{$v_1.hide();$v_2.hide()}}},getTabContainerById:function(tabId){for(var $v_0=0;$v_0<this.$0_3.length;$v_0++){var $v_1=$P_CRM(this.$0_3.get($v_0));if($v_1.attr("tabid")===tabId)return $P_CRM(this.$8_3.get($v_0))}return null},getTabHeaderById:function(tabId){for(var $v_0=0;$v_0<this.$0_3.length;$v_0++){var $v_1=$P_CRM(this.$0_3.get($v_0));if($v_1.attr("tabid")===tabId)return $v_1}return null},setActiveTab:function(tabId){var $v_0=this.getTabHeaderById(tabId);$v_0&&this.changeCurrentTab($v_0)},showTab:function(tabId){this.$S_3(tabId,true)},hideTab:function(tabId){this.$S_3(tabId,false)},getActiveTabId:function(){return this.$0_3.filter(".active").attr("tabid")},dispose:function(){if(this.get_isDisposed())return;this.$0_3.unbind();this.$3_3.unbind();this.$9_3.unbind();this.$4_3.unbind();$P_CRM(window).unbind("resize",this.$D_3);this.$3_3=null;this.$9_3=null;this.$4_3=null;this.$0_3=null;Mscrm.CrmUIControl.prototype.dispose.call(this)}};Mscrm.FormInputControl.Tabs.RefreshTabEventParameters=function(){};Mscrm.FormInputControl.Tabs.SfaTabsControl=function(element){this.$$d_$Y_4=Function.createDelegate(this,this.$Y_4);Mscrm.FormInputControl.Tabs.SfaTabsControl.initializeBase(this,[element]);this.$2_4=new Mscrm.EntityReference};Mscrm.FormInputControl.Tabs.SfaTabsControl.prototype={$B_4:null,$7_4:false,$N_4:false,$P_4:false,$1_4:null,$2_4:null,$T_4:false,$I_4:null,get_masterComponentId:function(){return this.$B_4},set_masterComponentId:function(value){this.$B_4=value;return value},get_isControlReadOnly:function(){return this.$7_4},set_isControlReadOnly:function(value){this.$7_4=value;return value},get_showWallContentOnLoad:function(){return this.$N_4},set_showWallContentOnLoad:function(value){this.$N_4=value;return value},get_defaultTabId:function(){return this.get_element().getAttribute("DefaultTabId")},set_defaultTabId:function(value){this.get_element().setAttribute("DefaultTabId",value);return value},get_$X_4:function(){return !!this.getTabHeaderById(Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId)},initialize:function(){Mscrm.FormInputControl.Tabs.TabsControl.prototype.initialize.call(this);if(!IsNull(this.get_eventManager())){this.get_eventManager().subscribeEvent(Mscrm.ScriptEvents.RefreshTabsControl,this.get_id());this.get_eventManager().subscribeEvent(Mscrm.ScriptEvents.GridRowPreview,this.get_id())}var $v_0=this.getTabContainerById(Mscrm.SfaTabsConstants.ActivityFeedsTabId),$v_1=this.getTabContainerById(Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId);if(Mscrm.Utilities.isIosDevice()&&!IsNull($v_1)){this.$1_4=$find(XUI.Html.DomUtils.GetFirstChild($v_1.get(0)).id);this.$1_4.set_hasInitialSkeleton(true)}else if(!IsNull($v_0)){this.$1_4=$find(XUI.Html.DomUtils.GetFirstChild($v_0.get(0)).id);!IsNull(this.$1_4.set_hasInitialSkeleton)&&this.$1_4.set_hasInitialSkeleton(true);var $v_3=this.getTabHeaderById(Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId);!IsNull($v_3)&&$v_3.data("associatedTabContainer",$v_0)}var $v_2=$P_CRM(this.get_element()).find(".getYammerHolder");if($v_2.length===1)this.$I_4=Mscrm.CrmUIComponent.crmCreate(Mscrm.GetYammer,null,null,null,$v_2[0]);this.$2_4.Id=Xrm.Page.data.entity.getId();if(!this.$7_4||this.$N_4)if(Mscrm.Utilities.isRefreshForm()){var $$t_4=this;Mscrm.OnLoadDeferredExecutor.queueCallback(function(){$$t_4.setActiveTab($$t_4.get_defaultTabId())},2)}else{var $$t_5=this;window.setTimeout(function(){$$t_5.setActiveTab($$t_5.get_defaultTabId())},2e3)}this.add_onTabChanging(this.$$d_$Y_4)},modifyCssForReadOnly:function(){if(this.$7_4)if(!IsNull(this.$4_3)){var $v_0=this.getTabContainerById(Mscrm.SfaTabsConstants.ActivityFeedsTabId);if(!IsNull($v_0)){this.$4_3.css("margin-top","8px");$v_0.css("margin-top","-8px")}var $v_1=this.getTabContainerById(Mscrm.SfaTabsConstants.ActivityFeedsTabId);if(!IsNull($v_1)){var $v_2=$v_1.find("div[id='wallContainer']");if(!IsNull($v_2)){$v_2.css("top","-3px");$v_2.css("padding-top","0px")}}}},$Y_4:function($p0,$p1){if(window.UseTabletExperience){var $v_0=Mscrm.Utilities.getActiveElement(),$v_1=document.createElement("textarea");$v_1.style.height="0 px";$v_1.style.width="100 px";$v_1.style.position="absolute";$v_1.style.top="0 px";$v_1.style.left="0 px";document.body.appendChild($v_1);$v_1.focus();$v_1.blur();document.body.removeChild($v_1);!IsNull($v_0)&&$v_0.focus()}($p1.$5_2===Mscrm.SfaTabsConstants.ActivityFeedsTabId||$p1.$5_2===Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId)&&this.$O_4($p1.$5_2)},refresh:function(entity){if(!IsNull(entity)){this.updateParentEntity(entity);var $v_0=this.getActiveTabId();!IsNull($v_0)&&$v_0!==Mscrm.SfaTabsConstants.ActivitiesTabId&&this.setActiveTab($v_0)}},updateParentEntity:function(entityReference){this.$2_4=entityReference;this.$O_4(this.getActiveTabId())},$O_4:function($p0){if(this.$1_4){if(($p0===Mscrm.SfaTabsConstants.ActivityFeedsTabId||$p0===Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId)&&(this.$2_4.Id!==this.$1_4.get_entityId()||this.$2_4.TypeName!==this.$1_4.get_entityType()))if(IsNull(this.$1_4.set_hasInitialSkeleton)){var $v_0=this.getTabContainerById($p0).find(".recordWall.initialFiller");if($v_0.length>0){var $v_1=$v_0.get(0);$v_1.parentNode.removeChild($v_1)}}this.$P_4&&this.$1_4.loadWallForEntity(this.$2_4);this.get_$X_4()&&this.$1_4.selectPostSourceFilter($p0===Mscrm.SfaTabsConstants.ActivityFeedsTabId?2:1)}},setActivityFeedsTabState:function(isActivityFeedsEnabled){this.$P_4=isActivityFeedsEnabled;if(isActivityFeedsEnabled&&Mscrm.Utilities.isProcessForm()){if(!Mscrm.Utilities.isIosDevice())this.showTab(Mscrm.SfaTabsConstants.ActivityFeedsTabId);else!this.getTabHeaderById(this.get_defaultTabId())&&this.set_defaultTabId(Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId);this.showTab(Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId)}else if(Mscrm.Utilities.isProcessForm()&&!IsNull(this.getTabHeaderById(Mscrm.SfaTabsConstants.ActivitiesTabId)))IsNull(this.get_defaultTabId())&&this.set_defaultTabId(Mscrm.SfaTabsConstants.ActivitiesTabId);else this.set_defaultTabId(Mscrm.SfaTabsConstants.NotesTabId)},handleEvent:function(eventCode,parameters,sourceComponent){Mscrm.CrmUIControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent);switch(eventCode){case Mscrm.ScriptEvents.GridRowPreview:case Mscrm.ScriptEvents.RefreshTabsControl:if(IsNull(sourceComponent)&&this.$B_4===this.get_id()||!IsNull(sourceComponent)&&this.$B_4===sourceComponent.get_id())if(!IsNull(parameters)){if(!IsNull(parameters["entityReference"]))this.$2_4=parameters["entityReference"];var $v_0=false,$v_1=null;if(!IsNull(parameters["onlyFocus"]))$v_0=parameters["onlyFocus"];if(!IsNull(parameters["tabName"]))$v_1=parameters["tabName"];else{$v_1=this.getActiveTabId();parameters["tabName"]=$v_1}if($v_0)this.setActiveTab($v_1);else this.$R_4($v_1,parameters)}break}return null},dispose:function(){if(this.get_isDisposed())return;this.remove_onTabChanging(this.$$d_$Y_4);this.$I_4&&this.$I_4.dispose();if(IsNull(this.$0_3))return;this.$0_3.unbind();Mscrm.FormInputControl.Tabs.TabsControl.prototype.dispose.call(this)},onTabChanged:function(tabId){Mscrm.FormInputControl.Tabs.TabsControl.prototype.onTabChanged.call(this,tabId);this.$Z_4(tabId)},$Z_4:function($p0){var $v_0={};if(!isNullOrEmptyString(this.$2_4.Id))$v_0["entityID"]=this.$2_4.Id;this.$R_4($p0,$v_0)},$R_4:function($p0,$p1){if(!IsNull($p1["entityID"]))this.$2_4.Id=$p1["entityID"];if(isNullOrEmptyString(this.$2_4.Id)){var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId);!IsNull($v_0)&&!$v_0.get_isNew()&&this.$Q_4($p0,$p1)}else this.$Q_4($p0,$p1)},$Q_4:function($p0,$p1){switch($p0){case Mscrm.SfaTabsConstants.ActivitiesTabId:this.get_eventManager().raiseEvent(this.$7_4?Mscrm.ScriptEvents.RefreshActivitiesWall:Mscrm.ScriptEvents.RefreshActivityContainer,$p1,this);break;case Mscrm.SfaTabsConstants.NotesTabId:if(this.get_eventManager()){$p1["tabName"]=this.getActiveTabId();this.get_eventManager().raiseEvent(Mscrm.ScriptEvents.RefreshNotesWall,$p1,this)}break;case Mscrm.SfaTabsConstants.ActivityFeedsSystemTabId:case Mscrm.SfaTabsConstants.ActivityFeedsTabId:this.$O_4($p0);break}},processData:function(){!IsNull(this.$1_4)&&this.$1_4.processData()},get_shouldDeferDataProcessing:function(){return this.$T_4},set_shouldDeferDataProcessing:function(value){this.$T_4=value;!IsNull(this.$1_4)&&this.$1_4.set_shouldDeferDataProcessing(value);return value}};Mscrm.FormInputControl.Tabs.TabChangingEventArgs.registerClass("Mscrm.FormInputControl.Tabs.TabChangingEventArgs",Sys.CancelEventArgs);Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs.registerClass("Mscrm.FormInputControl.Tabs.TabsContainerResizedEventArgs",Sys.EventArgs);Mscrm.FormInputControl.Tabs.TabsControl.registerClass("Mscrm.FormInputControl.Tabs.TabsControl",Mscrm.CrmUIControl);Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.registerClass("Mscrm.FormInputControl.Tabs.RefreshTabEventParameters");Mscrm.FormInputControl.Tabs.SfaTabsControl.registerClass("Mscrm.FormInputControl.Tabs.SfaTabsControl",Mscrm.FormInputControl.Tabs.TabsControl,Mscrm.IDeferredDataProcessingControl);Mscrm.FormInputControl.Tabs.TabsControl.associatedTabContainerKey="associatedTabContainer";Mscrm.FormInputControl.Tabs.TabsControl.activeTabClassName="active";Mscrm.FormInputControl.Tabs.TabsControl.tabAttributeId="tabid";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.tabName="tabName";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.refreshAll="refreshAll";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.onlyFocus="onlyFocus";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.entityId="entityID";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.entityTypeToExpand="entityTypeToExpand";Mscrm.FormInputControl.Tabs.RefreshTabEventParameters.entityReference="entityReference"