function locAddRelatedTo(iTypeToAdd){locAddRelatedToPlusAdditional(iTypeToAdd,"")}function locAddRelatedToPlusAdditional(iTypeToAdd,additionalAttributes){var oCrmFormSubmit=$get("crmFormSubmit");locAddRelatedToNonForm(iTypeToAdd,oCrmFormSubmit.crmFormSubmitObjectType.value,oCrmFormSubmit.crmFormSubmitId.value,additionalAttributes)}function locAddRelatedToNonForm(iTypeToAdd,createFromType,createFromId,additionalAttributes,openInNewWindow){var sUrl="?_CreateFromType="+CrmEncodeDecode.CrmUrlEncode(createFromType)+"&_CreateFromId="+CrmEncodeDecode.CrmUrlEncode(createFromId)+additionalAttributes;if(openInNewWindow)openFrmObj(sUrl,buildWinName(),iTypeToAdd,null,0);else openFrmObj(sUrl,buildWinName(),iTypeToAdd)}function locAddObjTo(iType){var isXrmReferenceValid=isReferenceValid(Xrm.Page.data)&&isReferenceValid(Xrm.Page.data.entity),isUtilitiesReferenceValid=isReferenceValid(Mscrm.InternalUtilities.Utilities);if(isXrmReferenceValid&&isUtilitiesReferenceValid){var parentObjectId=Xrm.Page.data.entity.getId(),parentObjectTypeCode=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());openObjEx(iType,parentObjectTypeCode,parentObjectId)}else{var oCrmFormSubmit=$get("crmFormSubmit");openObjEx(iType,oCrmFormSubmit.crmFormSubmitObjectType.value,oCrmFormSubmit.crmFormSubmitId.value)}}function locAddFileTo(iAttachmentType){var oCrmFormSubmit=$get("crmFormSubmit"),oUrl=getObjUrl(iAttachmentType);oUrl.get_query()["hideDesc"]="1";oUrl.get_query()["pId"]=oCrmFormSubmit.crmFormSubmitId.value;oUrl.get_query()["pType"]=oCrmFormSubmit.crmFormSubmitObjectType.value;openStdWin(oUrl,buildWinName(),500,175)}function locAddAttachmentForWorkflow(workflowid,stepid){var oUrl=getObjUrl(Annotation);oUrl.get_query()["hideDesc"]="1";oUrl.get_query()["pId"]=workflowid;oUrl.get_query()["pType"]=Workflow;oUrl.get_query()["stepId"]=stepid;openStdWin(oUrl,buildWinName(),500,175)}function isReferenceValid(reference){var isValid=false;if(Mscrm.InternalUtilities.JSTypes)isValid=!Mscrm.InternalUtilities.JSTypes.isNull(reference);else isValid=!IsNull(reference);return isValid}