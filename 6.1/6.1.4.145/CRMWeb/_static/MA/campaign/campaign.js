function DoesNotHasOnlineCampAct(){if(window.HasOnlineMarketingCampaignActivities===undefined||HasOnlineMarketingCampaignActivities==0)return true;return false}function locAssocObjCampaign(iType,sSubType,sAssociationName,iRoleOrdinal,parentId,parentObjectTypeCode){var parent=GetParentObject(parentId,parentObjectTypeCode),parameters=[iType,sSubType,sAssociationName,iRoleOrdinal,parent,false],callbackRef=Mscrm.Utilities.createCallbackFunctionObject("locAssocCampaignAction",this,parameters,false);switch(iType){case Campaign:LookupObjectsWithCallback(callbackRef,null,"multi","4400","0",null,"currentid="+CrmEncodeDecode.CrmUrlEncode(parent.id),"1");break;case List:callbackRef=Mscrm.Utilities.createCallbackFunctionObject("openListAssociationDialog",this,parameters,false);LookupObjectsWithCallback(callbackRef,null,"multi","4300",0);break;default:LookupObjectsWithCallback(callbackRef,null,"multi",iType,0);break}}function openListAssociationDialog(lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent){if(IsNull(lookupItems)==false){var oResult,oURL=Mscrm.CrmUri.create("/_grid/cmds/dlg_listcaassociation.aspx");oURL.get_query()["iObjType"]=iType;var parameters=[lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent],crmDialog=new Mscrm.CrmDialog(oURL,null,450,250,null);crmDialog.setCallbackInfo("performActionAfterListAssociate",this,parameters);crmDialog.show()}}function performActionAfterListAssociate(oResult,lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent){if(IsNull(lookupItems)==false){if(IsNull(oResult)==true)lookupItems=null;if(oResult)sSubType=sSubType+"addtoCA"}locAssocCampaignAction(lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent)}function locAssocCampaignAction(lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent){if(IsNull(lookupItems)==false)if(lookupItems.items.length>0){iRoleOrdinal=IsNull(iRoleOrdinal)?-1:iRoleOrdinal;!IsNull(parent)&&AssociateObjects(parent.objectTypeCode,parent.id,iType,lookupItems,iRoleOrdinal==-1?false:iRoleOrdinal==2,sSubType,sAssociationName)}}