function locAssocObjCampaignActivity(iType,sSubType,sAssociationName,iRoleOrdinal,parentId,parentObjectTypeCode){var parent=GetParentObject(parentId,parentObjectTypeCode),parameters=[iType,sSubType,sAssociationName,iRoleOrdinal,parent],callbackRef=Mscrm.Utilities.createCallbackFunctionObject("associateCampaignActivityAction",this,parameters,false);switch(iType){case List:LookupObjectsWithCallback(callbackRef,null,"multi",iType,0,null,"campaignActivityId="+CrmEncodeDecode.CrmUrlEncode(parent.id),"0","1","0","","","","B4E49A57-0229-4087-837C-45E1BDD7DD38",null,null,null,null,null,null,null,"1",null);break;default:LookupObjectsWithCallback(callbackRef,null,"multi",iType,0);break}}function associateCampaignActivityAction(lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent){if(IsNull(lookupItems)==false)if(lookupItems.items.length>0){iRoleOrdinal=IsNull(iRoleOrdinal)?-1:iRoleOrdinal;AssociateObjects(parent.objectTypeCode,parent.id,iType,lookupItems,iRoleOrdinal==-1?false:iRoleOrdinal==2,sSubType,sAssociationName)}}function RefreshCampaignResponse(){try{window.opener.parent!=null&&window.opener.parent.auto(CampaignResponse)}catch(e){}}function DoDistribute(sGrid,iObjType,sAction,sObjId){try{var command=new RemoteCommand("MarketingAutomation","GetTargetListAssociated"),campaignActivityId=sObjId;command.SetParameter("campaignActivityId",campaignActivityId);var result=command.Execute(),targetlist=result.ReturnValue;if(targetlist==0)sAction="nolistassociated";doAction(sGrid,iObjType,sAction,sObjId)}catch(e){}}function IsDistribute(){if(IsCampaignActivityOpen()&&IsCampaignActivityDistributed===false&&IsCampaignActivityTemplate===false)return true;return false}function CallDistribute(ObjType){var pageHandler=Mscrm.ReadFormUtilities.get_pageHandler(),action=pageHandler.getCampaignActivityAction(Xrm.Page.getAttribute("channeltypecode").getValue(),IsCampaignActivityTemplate);DoDistribute(null,ObjType,action,Xrm.Page.data.entity.getId())}function IsCampaignActivityOpen(){if(window.CampaignActivityState===undefined)return false;if(CampaignActivityState.toLowerCase()==="open")return true;return false}