function closeOrFulfillOrder(closedState){if(!Xrm.Page.data.getIsValid())return;var parameters=[closedState],oUrl=Mscrm.CrmUri.create("/sfa/salesorder/dlg_Close.aspx?closedstate="+CrmEncodeDecode.CrmUrlEncode(closedState)),crmDialog=new Mscrm.CrmDialog(oUrl,null,400,330,null);crmDialog.setCallbackInfo("performActionAfterCloseOrder",this,parameters);crmDialog.show()}function performActionAfterCloseOrder(oResult,closedState){if(oResult){var closeOrder={};closeOrder["newStatus"]=oResult.newStatus;closeOrder["CloseDate"]=oResult.closeDate;closeOrder["Description"]=oResult.description;var fulfilledState=3;if(closedState==fulfilledState)Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.OrderFulfillOrder,closeOrder);else Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.OrderCancelOrder,closeOrder)}}function closeOrder(){closeOrFulfillOrder(CANCELLED_STATE)}function fulfillOrder(){closeOrFulfillOrder(FULFILLED_STATE)}function processOrder(){Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.OrderProcessOrder,null)}function lockSalesOrder(){lock()}function unlockSalesOrder(){unlock()}function isSalesorderActive(){if(window.ORDER_STATE===undefined)return false;if(ORDER_STATE=="Active")return true;return false}function isSalesorderFulfilled(){if(window.ORDER_STATE===undefined)return false;if(ORDER_STATE=="Fulfilled")return true;return false}function isSalesorderFulfilledOrActive(){if(window.ORDER_STATE===undefined)return false;if(ORDER_STATE=="Fulfilled"||ORDER_STATE=="Active")return true;return false}function isSalesorderSubmitted(){if(window.ORDER_STATE===undefined)return false;if(ORDER_STATE=="Submitted")return true;return false}function getProductsForOrder(){getProducts()}function canAppendToCustomer(){if(window.CAN_APPEND_TO_CUST===undefined)return false;if(CAN_APPEND_TO_CUST=="1")return true;return false}function isBackOfficeInstalled(){if(window.IS_BACKOFFICE_INSTALLED===undefined)return false;if(IS_BACKOFFICE_INSTALLED=="1")return true;return false}