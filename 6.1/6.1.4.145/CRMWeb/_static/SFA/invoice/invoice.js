function CloseInvoice(closedState){oDlgParams={};oDlgParams.invoiceNumber=Xrm.Page.data.entity.attributes.get("invoicenumber").getValue();var parameters=[closedState],oUrl=Mscrm.CrmUri.create("/sfa/invoice/dlg_close.aspx?closedstate="+CrmEncodeDecode.CrmUrlEncode(closedState)),crmDialog=new Mscrm.CrmDialog(oUrl,oDlgParams,400,210,null);crmDialog.setCallbackInfo("performActionAfterCloseInvoice",this,parameters);crmDialog.show()}function performActionAfterCloseInvoice(iNewStatus,closedState){if(iNewStatus){var paidState=2;if(closedState==paidState)Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.InvoicePaid,iNewStatus);else Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.InvoiceCancel,iNewStatus)}}function lockInvoice(){lock()}function unlockInvoice(){unlock()}function getProductsForInvoice(){getProducts()}function isInvoicePaid(){if(window.INVOICE_STATE===undefined)return false;if(INVOICE_STATE=="Paid")return true;return false}