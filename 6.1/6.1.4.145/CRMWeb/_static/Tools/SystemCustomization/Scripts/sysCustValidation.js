var _oSCVConst={regexpSchemaNameChars:RegExp("[A-Za-z0-9_]","g")},_oSCVErrors={sCannotBeBlank:LOCID_SYSCUST_CANTBEBLANK,sCannotHaveInvalidChars:LOCID_SYSCUST_INVALCHARS,sCanOnlyHaveAlphaNumerics:LOCID_SYSCUST_ALPHANUMSONLY};function validateName(txtName,oValidCharsRegExp,sError_InvalidCharsFormat,sError_InvalidChars){var sMessage,sName;if(sError_InvalidChars==null)sError_InvalidChars="";var sName=Mscrm.FormControlInputBehavior.GetElementBehavior(txtName).get_dataValue();if(sName==null||sName=="")sMessage=_oSCVErrors.sCannotBeBlank;else if(sName.replace(oValidCharsRegExp,"")!="")sMessage=sError_InvalidCharsFormat;else return true;alert(formatString(sMessage,getControlName(txtName),sError_InvalidChars));setControlFocus(txtName);return false}function validateSchemaName(txtName){return validateName(txtName,_oSCVConst.regexpSchemaNameChars,_oSCVErrors.sCanOnlyHaveAlphaNumerics)}function validateRequiredValue(oControl){var ajaxControl=Mscrm.FormControlInputBehavior.GetBehavior(oControl.id),disabled=ajaxControl.get_disabled(),oValue=ajaxControl.get_dataValue();if(!disabled)if(oValue==null||typeof oValue=="string"&&oValue==""){alert(formatString(_oSCVErrors.sCannotBeBlank,getControlName(oControl)));setControlFocus(oControl);return false}return true}function validateRequiredInput(oControl,sLabel){var oValue=oControl.value;if(oValue==null||typeof oValue=="string"&&oValue==""){setControlFocus(oControl);alert(formatString(_oSCVErrors.sCannotBeBlank,sLabel));return false}return true}function getControlName(oControl){return Trim(XUI.Html.GetText($get(oControl.id+"Label")))}function setControlFocus(oControl){var oParent=oControl.parentNode;do{if(oParent==null||oParent.className=="ms-crm-Tab")break;oParent=oParent.parentNode}while(1);if(oParent!=null){var oTab=$get(oParent.id+"Tab");Mscrm.Utilities.click(oTab)}try{var ajaxControl=Mscrm.FormControlInputBehavior.GetBehavior(oControl.id);if(IsNull(ajaxControl))oControl.SetFocus();else ajaxControl.setFocus()}catch(ex){oControl.focus()}}