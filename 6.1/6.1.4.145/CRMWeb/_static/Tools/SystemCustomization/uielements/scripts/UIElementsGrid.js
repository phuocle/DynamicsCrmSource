Type.registerNamespace("Mscrm");Mscrm.UIElementsGrid=function(){};Mscrm.UIElementsGrid.onFormsGridClick=function(sender,args){Mscrm.UIElementsGrid.editExistingForm(sender,args);args.breakEvent=true};Mscrm.UIElementsGrid.editExistingForm=function(sender,args){var $v_0=$find("crmGrid"),$v_1=Mscrm.UIElementsGrid.$0(args.objectTypeCode.toString());Mscrm.UIElementsGrid.$1($v_1,args.objectID,$v_0);args.breakEvent=true};Mscrm.UIElementsGrid.editExistingFormFromGridCommand=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}var $v_1=$v_0.get_selectedIds()[0],$v_2=$v_0.get_selectedRecords()[0],$v_3=Mscrm.UIElementsGrid.$0($v_2.TypeCode.toString());Mscrm.UIElementsGrid.$1($v_3,$v_1,$v_0)};Mscrm.UIElementsGrid.createNewForm=function(){var $v_0=$find("crmGrid"),$v_1=parseInt($v_0.GetParameter("entityOtc"),10);Mscrm.FormEditor.OpenFormEditor($v_1,"main",null,0)};Mscrm.UIElementsGrid.createNewMobileForm=function(){var $v_0=$find("crmGrid"),$v_1=$v_0.GetParameter("entityLogicalName");Mscrm.FormEditor.OpenMobileFormEditor($v_1,null)};Mscrm.UIElementsGrid.createNewQuickForm=function(){var $v_0=$find("crmGrid"),$v_1=parseInt($v_0.GetParameter("entityOtc"),10);Mscrm.FormEditor.OpenFormEditor($v_1,"quick",null,0)};Mscrm.UIElementsGrid.createNewQuickCreateForm=function(){var $v_0=$find("crmGrid"),$v_1=parseInt($v_0.GetParameter("entityOtc"),10);Mscrm.FormEditor.OpenFormEditor($v_1,"quickCreate",null,0)};Mscrm.UIElementsGrid.assignRoles=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}var $v_1=$v_0.get_selectedIds()[0],$v_2=$v_0.get_selectedRecords()[0],$v_3=Mscrm.UIElementsGrid.$0($v_2.TypeCode.toString());if($v_3==="quickCreate"||$v_3==="quick"){var $v_4=new Mscrm.CrmDialog(Mscrm.UIElementsGrid.$2("/_grid/cmds/dlg_securityrolesassign.aspx",$v_0),[window._Process_Id],500,200,null);$v_4.show()}else{var $v_5=Mscrm.CrmUri.create("/Tools/FormEditor/Dialogs/FormRoleAssignment.aspx");$v_5.get_query()["formId"]=$v_1;$v_5.get_query()["type"]=$v_0.getCellValue("type",$v_1);$v_5.get_query()["objectTypeCode"]=$v_0.GetParameter("entityOtc");var $v_6={};$v_6["formId"]=$v_1;var $v_7=new Xrm.DialogOptions;$v_7.height=550;$v_7.width=800;Xrm.Internal.openDialog($v_5.toString(),$v_7,$v_6,null,null)}};Mscrm.UIElementsGrid.$2=function($p0,$p1){var $v_0=Mscrm.CrmUri.create($p0);$v_0.get_query()["iObjType"]=$p1.get_entityTypeCode();$v_0.get_query()["sIds"]=$p1.get_selectedRecords()[0].Id;return $v_0};Mscrm.UIElementsGrid.formOrder=function(formType){var $v_0=$find("crmGrid"),$v_1=Mscrm.CrmUri.create("/Tools/FormEditor/Dialogs/FormsOrder.aspx"),$v_2={};$v_2["type"]=formType;$v_2["objectTypeCode"]=$v_0.GetParameter("entityOtc");var $v_3=new Xrm.DialogOptions;$v_3.height=550;$v_3.width=650;Xrm.Internal.openDialog($v_1.toString(),$v_3,$v_2,null,null)};Mscrm.UIElementsGrid.displayManagedProperties=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}var $v_1=$v_0.get_selectedIds()[0];Mscrm.ManagedPropertyUtil.launchManagedPropertyDlg(Mscrm.EntityTypeCode.SystemForm,$v_1)};Mscrm.UIElementsGrid.showDependencies=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}var $v_1=$v_0.get_selectedIds()[0];Mscrm.Dependency.launchDependencyDlg(Mscrm.EntityTypeCode.SystemForm,$v_1)};Mscrm.UIElementsGrid.deleteItem=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}Mscrm.GridRibbonActions.deleteRecords($v_0,$v_0.get_selectedRecords(),$v_0.get_entityTypeCode())};Mscrm.UIElementsGrid.activateItem=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}Mscrm.GridRibbonActions.changeFormStateRecords($v_0,$v_0.get_selectedRecords(),$v_0.get_entityTypeCode(),1)};Mscrm.UIElementsGrid.deactivateItem=function(){var $v_0=$find("crmGrid");if($v_0.get_selectedIds().length!==1){alert(window.LOCID_ACTION_SELECTONEFORM);return}Mscrm.GridRibbonActions.changeFormStateRecords($v_0,$v_0.get_selectedRecords(),$v_0.get_entityTypeCode(),0)};Mscrm.UIElementsGrid.$0=function($p0){switch($p0){case "0":return "dashboard";case "1":return "appointmentBook";case "2":return "main";case "4":return "preview";case "5":return "mobile";case "6":return "quick";case "7":return "quickCreate";default:return "undefined"}};Mscrm.UIElementsGrid.$1=function($p0,$p1,$p2){var $v_0=parseInt($p2.GetParameter("entityOtc"),10);if($p0==="mobile"){var $v_1=Mscrm.CrmUri.create("/m/Console/EntityConfig.aspx");$v_1.get_query()["etn"]=$p2.GetParameter("entityLogicalName");$v_1.get_query()["formid"]=$p1;openStdWin($v_1,"Editor",800,600,null)}else Mscrm.FormEditor.OpenFormEditor($v_0,$p0,$p1,-1)};Mscrm.UIElementsGrid.registerClass("Mscrm.UIElementsGrid")