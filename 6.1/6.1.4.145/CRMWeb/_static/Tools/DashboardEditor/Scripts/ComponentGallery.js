Type.registerNamespace("Mscrm");Mscrm.SelectorTypes=function(){};Mscrm.SelectorTypes.prototype={type:1,view:2,chart:3};Mscrm.SelectorTypes.registerEnum("Mscrm.SelectorTypes",false);Mscrm.ComponentGallery=function(){};Mscrm.ComponentGallery.onLoad=function(){var $v_0=getDialogArguments();if(!IsNull($v_0)){Mscrm.ComponentGallery.$0=$v_0["Field"];Mscrm.ComponentGallery.$T=$v_0["SecCols"];Mscrm.ComponentGallery.$U=$v_0["sSectionName"];Mscrm.ComponentGallery.$W=$v_0["sTabName"];Mscrm.ComponentGallery.$Q=$v_0["EditorType"];if($v_0["FormAccessType"]===Mscrm.EntityTypeCode.SystemForm)Mscrm.ComponentGallery.$1=false;if(!IsNull(Mscrm.ComponentGallery.$0)){if(!isNullOrEmptyString(Mscrm.ComponentGallery.$0["ChartGridMode"]))Mscrm.ComponentGallery.$3=Mscrm.ComponentGallery.$0["ChartGridMode"];if(!isNullOrEmptyString(Mscrm.ComponentGallery.$0["Id"]))Mscrm.ComponentGallery.$5=Mscrm.ComponentGallery.$0["Id"];if(!IsNull(Mscrm.ComponentGallery.$0["ColSpan"]))Mscrm.ComponentGallery.$D=Mscrm.ComponentGallery.$0["ColSpan"];if(!IsNull(Mscrm.ComponentGallery.$0["RowSpan"]))Mscrm.ComponentGallery.$H=Mscrm.ComponentGallery.$0["RowSpan"];if(!IsNull(Mscrm.ComponentGallery.$0["RowsPerPage"]))Mscrm.ComponentGallery.$G=Mscrm.ComponentGallery.$0["RowsPerPage"];if(!IsNull(Mscrm.ComponentGallery.$0["Labels"]))Mscrm.ComponentGallery.$2=Mscrm.ComponentGallery.$0["Labels"]}}if(Mscrm.ComponentGallery.$3.toUpperCase()==="CHART"){var $v_1=$get("previewFrame");$addHandler($v_1,"load",Mscrm.DashboardEditorUtils.onPreviewChartLoadedHandler)}Mscrm.ComponentGallery.onEntityTypeChange(true)};Mscrm.ComponentGallery.applyChanges=function(){Mscrm.ComponentGallery.$a();var $v_0=new SubGridObj(Mscrm.ComponentGallery.$5,Mscrm.ComponentGallery.$S,Mscrm.ComponentGallery.$I,Mscrm.ComponentGallery.$H,Mscrm.ComponentGallery.$G,Mscrm.ComponentGallery.$D,Mscrm.ComponentGallery.$N,Mscrm.ComponentGallery.$P,Mscrm.ComponentGallery.$8,Mscrm.ComponentGallery.$B,Mscrm.ComponentGallery.$X,Mscrm.ComponentGallery.$A,Mscrm.ComponentGallery.$9,Mscrm.ComponentGallery.$3,Mscrm.ComponentGallery.$6,Mscrm.ComponentGallery.$O,Mscrm.ComponentGallery.$2,Mscrm.ComponentGallery.$M,Mscrm.ComponentGallery.$F,Mscrm.ComponentGallery.$E);window.returnValue=$v_0;Mscrm.Utilities.setReturnValue($v_0);closeWindow()};Mscrm.ComponentGallery.onEntityTypeChange=function(persistViews){Mscrm.ComponentGallery.$f();Mscrm.ComponentGallery.$i(!persistViews)};Mscrm.ComponentGallery.onViewSelectionChange=function(refreshCharts){Mscrm.ComponentGallery.$g();Mscrm.ComponentGallery.$d(refreshCharts)};Mscrm.ComponentGallery.onChartSelectionChange=function(){Mscrm.ComponentGallery.$h();if(Mscrm.ComponentGallery.$6!==Mscrm.DashboardEditorConstants.emptyGuid)Mscrm.DashboardEditorUtils.refreshPreview(Mscrm.ComponentGallery.$6,Mscrm.ComponentGallery.$K,Mscrm.ComponentGallery.$8,Mscrm.ComponentGallery.$J,Mscrm.ComponentGallery.$1);else Mscrm.DashboardEditorUtils.initializeChartFrame()};Mscrm.ComponentGallery.$d=function($p0){if(Mscrm.ComponentGallery.$3.toUpperCase()==="GRID"){Mscrm.ComponentGallery.$b(false);Mscrm.ComponentGallery.$c()}else Mscrm.ComponentGallery.$e($p0)};Mscrm.ComponentGallery.$i=function($p0){if($p0){var $v_1=new RemoteCommand("FormEditorWebService","GetViewsHtml");$v_1.SetParameter("entityCode",Mscrm.ComponentGallery.$7);$v_1.SetParameter("displayUserGroup",Mscrm.ComponentGallery.$1);$v_1.SetParameter("retrieveOnlyPublished",Mscrm.ComponentGallery.$1);$v_1.SetParameter("onChange","Mscrm.ComponentGallery.onViewSelectionChange()");$v_1.SetParameter("id","crmViewSelector");var $v_2=$v_1.Execute(),$v_3=$get("crmViewSelector").parentNode;if($v_2.Success)$v_3.innerHTML=XUI.Xml.GetText($v_2.Xml);else $v_3.innerHTML=""}var $v_0=$get("crmViewSelector");Mscrm.ComponentGallery.$V($v_0,window.LOCID_CG_VIEW);if(!IsNull($v_0)&&$v_0.options.length>0){Mscrm.ComponentGallery.$R(true);Mscrm.ComponentGallery.onViewSelectionChange($p0)}else Mscrm.ComponentGallery.$R(false)};Mscrm.ComponentGallery.$e=function($p0){if($p0){var $v_1=new RemoteCommand("FormEditorWebService","GetVisualizationSelectorHtml");$v_1.SetParameter("entityCode",Mscrm.ComponentGallery.$7.toString());$v_1.SetParameter("displayUserGroup",Mscrm.ComponentGallery.$1);$v_1.SetParameter("retrieveOnlyPublished",Mscrm.ComponentGallery.$1);$v_1.SetParameter("onChange","Mscrm.ComponentGallery.onChartSelectionChange()");$v_1.SetParameter("id","crmChartSelector");var $v_2=$v_1.Execute(),$v_3=$get("crmChartSelector").parentNode;if($v_2.Success)$v_3.innerHTML=XUI.Xml.GetText($v_2.Xml);else $v_3.innerHTML=""}var $v_0=$get("crmChartSelector");Mscrm.ComponentGallery.$V($v_0,window.LOCID_CG_CHART);if(!IsNull($v_0)&&$v_0.options.length>0){Mscrm.ComponentGallery.$C(true);Mscrm.ComponentGallery.onChartSelectionChange()}else Mscrm.ComponentGallery.$C(false)};Mscrm.ComponentGallery.$f=function(){var $v_0=Mscrm.ComponentGallery.$4(1);if(!IsNull($v_0))Mscrm.ComponentGallery.$7=$v_0.value};Mscrm.ComponentGallery.$g=function(){var $v_0=Mscrm.ComponentGallery.$4(2);if(!IsNull($v_0)){Mscrm.ComponentGallery.$8=$v_0.value;Mscrm.ComponentGallery.$J=parseInt($v_0.getAttribute("Type"))}};Mscrm.ComponentGallery.$h=function(){var $v_0=Mscrm.ComponentGallery.$4(3);if(!IsNull($v_0)){Mscrm.ComponentGallery.$6=$v_0.value;Mscrm.ComponentGallery.$K=parseInt($v_0.getAttribute("type"))}};Mscrm.ComponentGallery.$V=function($p0,$p1){if(!IsNull($p0)){var $v_0=document.createAttribute("title");$v_0.value=$p1;$p0.attributes.setNamedItem($v_0)}};Mscrm.ComponentGallery.$R=function($p0){var $v_0=$get("crmViewSelector"),$v_1=$get("butBegin");if(!IsNull($v_0))$v_0.disabled=$p0?false:true;Mscrm.ComponentGallery.$C($p0)};Mscrm.ComponentGallery.$C=function($p0){var $v_0=$get("crmChartSelector"),$v_1=$get("butBegin");if(!IsNull($v_0)){$v_0.disabled=$p0?false:true;$v_1.disabled=$v_0.disabled}if(!$p0){Mscrm.DashboardEditorUtils.showDiv(Mscrm.DashboardEditorConstants.contentDivId);var $v_2=$get(Mscrm.DashboardEditorConstants.contentDivId);$v_2.innerHTML="<table style='height:100%;width:100%'><tr style='vertical-align:middle; text-align:center'><td>"+window.LOCID_CG_NOCHARTS+"</td></tr></table>"}};Mscrm.ComponentGallery.$b=function($p0){var $v_0=$p0?"inline":"none",$v_1=$get("crmChartSelector");if(!IsNull($v_1))$v_1.style.display=$v_0;var $v_2=$get("tdChartSelectorLabel");if(!IsNull($v_2))$v_2.style.display=$v_0;return};Mscrm.ComponentGallery.$Y=function(){var $v_0=Mscrm.ComponentGallery.$4(3);if(!IsNull($v_0)){var $v_1=parseInt($v_0.getAttribute("type"),10);if($v_1===Mscrm.EntityTypeCode.UserQueryVisualization)return true}return false};Mscrm.ComponentGallery.$Z=function(){var $v_0=Mscrm.ComponentGallery.$4(2);if(!IsNull($v_0)){var $v_1=parseInt($v_0.getAttribute("Type"),10);if($v_1===Mscrm.EntityTypeCode.UserQuery)return true}return false};Mscrm.ComponentGallery.$a=function(){var $v_0=Mscrm.ComponentGallery.$4(1);Mscrm.ComponentGallery.$I=!IsNull($v_0)?$v_0.attributes.getNamedItem("logicalName").value:"";Mscrm.ComponentGallery.$5=isNullOrEmptyString(Mscrm.ComponentGallery.$5)?String.format("Component{0}",Math.floor(Math.random()*1e7)):Mscrm.ComponentGallery.$5;Mscrm.ComponentGallery.$F=Mscrm.ComponentGallery.$Z();Mscrm.ComponentGallery.$E=Mscrm.ComponentGallery.$Y();if(Mscrm.ComponentGallery.$3.toUpperCase()==="CHART"){Mscrm.ComponentGallery.$B=false;Mscrm.ComponentGallery.$9=false;Mscrm.ComponentGallery.$A=false}var $v_1=!IsNull($v_0)?$v_0.text:"",$v_2=Mscrm.ComponentGallery.$1?window.ORG_LANGUAGE_CODE.toString():window.USER_LANGUAGE_CODE.toString();if(IsNull(Mscrm.ComponentGallery.$2)||!Mscrm.ComponentGallery.$2.length){var $v_3=new LocalizedObj($v_1,$v_2);Mscrm.ComponentGallery.$2=[];Array.add(Mscrm.ComponentGallery.$2,$v_3)}};Mscrm.ComponentGallery.$4=function($p0){var $v_0=null;switch($p0){case 1:$v_0="crmTypeSelector";break;case 2:$v_0="crmViewSelector";break;case 3:$v_0="crmChartSelector";break}var $v_1=$get($v_0),$v_2=null;if(!IsNull($v_1)&&$v_1.options.length>0&&$v_1.selectedIndex!==-1)$v_2=$v_1.options[$v_1.selectedIndex];return $v_2};Mscrm.ComponentGallery.$c=function(){var $v_0=null,$v_1=function($p1_0){$v_0=$p1_0},$v_2=function($p1_0,$p1_1){$v_0=null};XUI.Xml.Load(Mscrm.CrmUri.create("/Tools/FormEditor/formeditorsection.xsl").toString(),false,$v_1,$v_2);var $v_3=Mscrm.XmlUtil.createXslTemplate();$v_3.stylesheet=$v_0;var $v_4=$v_3.createProcessor(),$v_5=XUI.Xml.LoadXml('<gridPreview><resources><resource id="GridPreviewColumnHeader">'+window.LOCID_GRID_PREVIEW_COLUMN_HEADER+"</resource></resources></gridPreview>");$v_4.input=$v_5;$v_4.transform();Mscrm.DashboardEditorUtils.showDiv(Mscrm.DashboardEditorConstants.contentDivId);var $v_6=$get(Mscrm.DashboardEditorConstants.contentDivId);$v_6.innerHTML=$v_4.output};Mscrm.CHARTGRIDMODE=function(){};Mscrm.ComponentGallery.registerClass("Mscrm.ComponentGallery");Mscrm.CHARTGRIDMODE.registerClass("Mscrm.CHARTGRIDMODE");Mscrm.ComponentGallery.$7=1;Mscrm.ComponentGallery.$1=true;Mscrm.ComponentGallery.$3="CHART";Mscrm.ComponentGallery.$J=Mscrm.EntityTypeCode.None;Mscrm.ComponentGallery.$K=Mscrm.EntityTypeCode.None;Mscrm.ComponentGallery.$0=null;Mscrm.ComponentGallery.$T=1;Mscrm.ComponentGallery.$W="";Mscrm.ComponentGallery.$U="";Mscrm.ComponentGallery.$Q="dashboardEditor";Mscrm.ComponentGallery.$5="";Mscrm.ComponentGallery.$S="";Mscrm.ComponentGallery.$I="";Mscrm.ComponentGallery.$2=null;Mscrm.ComponentGallery.$H=12;Mscrm.ComponentGallery.$G=10;Mscrm.ComponentGallery.$D=1;Mscrm.ComponentGallery.$N=false;Mscrm.ComponentGallery.$P=false;Mscrm.ComponentGallery.$8="";Mscrm.ComponentGallery.$B=true;Mscrm.ComponentGallery.$X="";Mscrm.ComponentGallery.$A=true;Mscrm.ComponentGallery.$9=true;Mscrm.ComponentGallery.$6="";Mscrm.ComponentGallery.$O=false;Mscrm.ComponentGallery.$M="";Mscrm.ComponentGallery.$E=false;Mscrm.ComponentGallery.$F=false;Mscrm.CHARTGRIDMODE.CHART="CHART";Mscrm.CHARTGRIDMODE.GRID="GRID"