var _oEvent,isStateTransition=false;function SelectValuesJsWindowOnLoad(){var oArgs=getDialogArguments(),_oValuesXml=oArgs.valuesXml;_iFieldSelectWidth=205;_iFieldSelectHeight=145;_sFieldSelectLeftTitle=LOCID_SELVALS_TITLE_AVAILVALS;_sFieldSelectRightTitle=LOCID_SELVALS_TITLE_SELTDVALS;_bFieldSelectShowUp=false;_bFieldSelectShowDown=false;var oNodes=XUI.Xml.SelectNodes(_oValuesXml,"/select/option",null),isStateTransition=XUI.Xml.SelectNodes(_oValuesXml,"/select/option/@state",null).length==0?false:true,iLen=oNodes.length;if(isStateTransition)aSize=3;else aSize=2;var sValuesAry=new Array(aSize);sValuesAry[0]=new Array(iLen);sValuesAry[1]=new Array(iLen);if(isStateTransition)sValuesAry[2]=new Array(iLen);for(var i=0;i<iLen;i++){if(isStateTransition)sValuesAry[2][i]=oNodes[i].getAttribute("state");sValuesAry[1][i]=XUI.Xml.GetText(oNodes[i]);sValuesAry[0][i]=oNodes[i].getAttribute("value")}var disablesorting=XUI.Xml.SelectSingleNode(_oValuesXml,"/select/@disablesorting",null);if(disablesorting==null||XUI.Xml.GetText(disablesorting)=="false")if(isStateTransition)Quicksort(sValuesAry[1],0,sValuesAry[0].length-1,sValuesAry[0],sValuesAry[2],isStateTransition);else Quicksort(sValuesAry[1],0,sValuesAry[0].length-1,sValuesAry[0]);var selectedList=oArgs.sSelectedValues.split(";");iLen=selectedList.length;var sSelectedAry=new Array(aSize);sSelectedAry[0]=new Array(iLen);sSelectedAry[1]=new Array(iLen);if(isStateTransition)sSelectedAry[2]=new Array(iLen);for(var sSelectedValue="",i=0;i<iLen;i++){sSelectedValue=selectedList[i];if(sSelectedValue=="")continue;for(var oNodes=XUI.Xml.SelectNodes(_oValuesXml,"/select/option",null),j=0;j<oNodes.length;j++)if(oNodes[j].getAttribute("value")==sSelectedValue){if(isStateTransition)sSelectedAry[2][i]=oNodes[j].getAttribute("state");sSelectedAry[1][i]=XUI.Xml.GetText(oNodes[j]);sSelectedAry[0][i]=oNodes[j].getAttribute("value");break}}drawFieldSelect(sValuesAry,sSelectedAry,isStateTransition)}$addHandler(window,"load",SelectValuesJsWindowOnLoad);function applychanges(){var oRows=XUI.Html.DomUtils.GetFirstChild($get("rtnObjList")).rows,iLen=oRows.length,sDependsAry=[];sDependsAry=GetReturnList();Mscrm.Utilities.setReturnValue(sDependsAry);closeWindow()}function cancel(){closeWindow()}