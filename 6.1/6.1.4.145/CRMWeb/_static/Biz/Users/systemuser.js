var _oId=null,_sNewOwnerId=null,_iNewOwnerType=-1;function AssignAllRecords(){var crmDialog=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/_grid/cmds/dlg_assignallrecords.aspx"),null,590,340,null);crmDialog.setCallbackInfo("assignRecordsAction",this,null);crmDialog.show()}function assignRecordsAction(o){if(o){DisplayActionMsg(LOCID_REASSIGNINGRECORDS,350,150);_sNewOwnerId=o.OwnerId;_iNewOwnerType=o.OwnerType;window.setTimeout(reassignRecords,1)}}function reassignRecords(){var objectId=Xrm.Page.data.entity.getId(),typeName=Xrm.Page.data.entity.getEntityName(),objectTypeCode=Xrm.Internal.getEntityCode(typeName),oCommand=new RemoteCommand("OwnerManager","AssignAllRecords");oCommand.SetParameter("oldOwnerId",objectId);oCommand.SetParameter("oldOwnerType",objectTypeCode);oCommand.SetParameter("newOwnerId",_sNewOwnerId);oCommand.SetParameter("newOwnerType",_iNewOwnerType);var oResult=oCommand.Execute();HideActionMsg()}function JoinTeam(){if(_oId==null)_oId=new Array(Xrm.Page.data.entity.getId());ModifyMembership(null,"TeamsSubGrid",_oId,ACTION_ADD,Team,"&filterdefault=1","Microsoft.Crm.Application.Controls.TeamGridDataProvider")}function CancelFormSubmit(){return false}function SendEmail(){var sParentId=null,sParentType=null,sParentName=null,sPartyId=Xrm.Page.data.entity.getId(),typeName=Xrm.Page.data.entity.getEntityName(),sPartyType=Xrm.Internal.getEntityCode(typeName),sPartyName=_sPartyName,sPartyLocation="";addActivityTo(Email,sParentId,sParentType,sParentName,sPartyId,sPartyType,sPartyName,sPartyLocation)}function SendInvite(){Mscrm.CommandBarActions.sendInvite()}function ChangeWLID(){if(!_bIsLiveEnabled)openStdWin(_sNotificationUrl);else if(Xrm.Page.data.getIsValid()){var dlgUrl=Mscrm.CrmUri.create("/_grid/cmds/dlg_changewlid.aspx?userid="+CrmEncodeDecode.CrmUrlEncode($get("crmFormSubmit").crmFormSubmitId.value)+"&isform=true"),dialogOptions=new Xrm.DialogOptions;dialogOptions.height=300;dialogOptions.width=500;Xrm.Internal.openDialog(dlgUrl.toString(),dialogOptions,null,null,changewlidCallback)}}function changewlidCallback(result){var wlid=result;if(typeof wlid!="undefined"&&typeof wlid=="string"&&wlid!=""){var oldWlid=Xrm.Page.data.entity.attributes.get("windowsliveid").getValue();if(typeof oldWlid!="undefined"&&oldWlid!=wlid){var invitestatuscode=Xrm.Page.data.entity.attributes.get("invitestatuscode").getValue();if(invitestatuscode=="4"){var url=Mscrm.CrmUri.create("/_grid/cmds/dlg_confirm_invitereset.aspx"),dialogOptions=new Xrm.DialogOptions;dialogOptions.height=200;dialogOptions.width=400;Xrm.Internal.openDialog(url.toString(),dialogOptions,null,null,null)}Xrm.Page.getAttribute("windowsliveid").setValue(wlid);Xrm.Page.getAttribute("windowsliveid").setSubmitMode("always");Xrm.Page.data.save()}}}function SetDevErrors(userId){var oCommand=new RemoteCommand("UserManager","SetDevErrors");oCommand.SetParameter("userId",userId);oCommand.SetParameter("value",!_bIsShowDevErrorsEnabled);var oResult=oCommand.Execute();if(oResult.Success)_bIsShowDevErrorsEnabled=!_bIsShowDevErrorsEnabled}