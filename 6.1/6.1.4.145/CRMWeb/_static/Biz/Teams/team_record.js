var _sNewOwnerId=null,_iNewOwnerType=-1;function AssignAllRecords(entityName){var url=Mscrm.CrmUri.create("/_grid/cmds/dlg_assignallrecords.aspx");if(!IsNull(entityName)&&entityName=="businessunit"){url.get_query()["etn"]=entityName;url.get_query()["oldBUId"]=Xrm.Page.data.entity.getId()}var parameters=[];parameters[0]=entityName;var crmDialog=new Mscrm.CrmDialog(url,null,590,340,null);crmDialog.setCallbackInfo("assignRecordsAction",this,parameters);crmDialog.show()}function assignRecordsAction(o,entityName){if(o)if(entityName!="businessunit"){DisplayActionMsg(LOCID_REASSIGNINGRECORDS,350,150);_sNewOwnerId=o.OwnerId;_iNewOwnerType=o.OwnerType;window.setTimeout(reassignRecords,1e3)}}function reassignRecords(){var objectId=Xrm.Page.data.entity.getId(),typeName=Xrm.Page.data.entity.getEntityName(),objectTypeCode=Xrm.Internal.getEntityCode(typeName),oCommand=new RemoteCommand("OwnerManager","AssignAllRecords");oCommand.SetParameter("oldOwnerId",objectId);oCommand.SetParameter("oldOwnerType",objectTypeCode);oCommand.SetParameter("newOwnerId",_sNewOwnerId);oCommand.SetParameter("newOwnerType",_iNewOwnerType);var oResult=oCommand.Execute();HideActionMsg()}function isDefaultInstance(){if(!IsNull(window.IS_DEFAULT_INSTANCE)&&window.IS_DEFAULT_INSTANCE=="1")return true;return false}