Type.registerNamespace("Mscrm");Mscrm.IGridPresenceView=function(){};Mscrm.IGridPresenceView.registerInterface("Mscrm.IGridPresenceView");Mscrm.InlineGridType=function(){};Mscrm.InlineGridType.prototype={product:0,moveableRows:1,entitlementChannel:2};Mscrm.InlineGridType.registerEnum("Mscrm.InlineGridType",false);Mscrm.RequirementLevel=function(){};Mscrm.RequirementLevel.prototype={clientOnly:0,serverOnly:1,both:2};Mscrm.RequirementLevel.registerEnum("Mscrm.RequirementLevel",false);Mscrm.GridContextualAction=function(){};Mscrm.GridContextualAction.prototype={addRecord:0,deleteRecord:1};Mscrm.GridContextualAction.registerEnum("Mscrm.GridContextualAction",false);Mscrm.IFilterSet=function(){};Mscrm.IFilterSet.registerInterface("Mscrm.IFilterSet");Mscrm.IEntityInlineEditGrid=function(){};Mscrm.IEntityInlineEditGrid.registerInterface("Mscrm.IEntityInlineEditGrid");Mscrm.ISubGridContextualActions=function(){};Mscrm.ISubGridContextualActions.registerInterface("Mscrm.ISubGridContextualActions");Mscrm.GridPresenceView=function(){this.$$d_$7P_0=Function.createDelegate(this,this.$7P_0);this.$$d_$6I_0=Function.createDelegate(this,this.$6I_0);this.$$d_$6H_0=Function.createDelegate(this,this.$6H_0);this.$$d_$7V_0=Function.createDelegate(this,this.$7V_0);this.$$d_$7W_0=Function.createDelegate(this,this.$7W_0);this.$D_0=new Sys.EventHandlerList};Mscrm.GridPresenceView.prototype={$2o_0:null,$T_0:null,$2h_0:null,$2M_0:null,add_mouseOverEvent:function(value){this.$D_0.addHandler("MouseOverEvent",value)},remove_mouseOverEvent:function(value){this.$D_0.removeHandler("MouseOverEvent",value)},add_mouseOutEvent:function(value){this.$D_0.addHandler("MouseOutEvent",value)},remove_mouseOutEvent:function(value){this.$D_0.removeHandler("MouseOutEvent",value)},add_focusInEvent:function(value){this.$D_0.addHandler("FocusInEvent",value)},remove_focusInEvent:function(value){this.$D_0.removeHandler("FocusInEvent",value)},add_focusOutEvent:function(value){this.$D_0.addHandler("FocusOutEvent",value)},remove_focusOutEvent:function(value){this.$D_0.removeHandler("FocusOutEvent",value)},add_keyDownEvent:function(value){this.$D_0.addHandler("KeyDownEvent",value)},remove_keyDownEvent:function(value){this.$D_0.removeHandler("KeyDownEvent",value)},get_domHelperProxy:function(){IsNull(this.$2o_0)&&this.set_domHelperProxy(new Mscrm.Proxies.DomHelperProxy);return this.$2o_0},set_domHelperProxy:function(value){this.$2o_0=value;return value},get_element:function(){return this.$T_0},set_element:function(value){this.$T_0=value;return value},get_ancestorAnchor:function(){if(IsNull(this.$2h_0)){for(var $v_0=this.$T_0.get_parentNode(),$v_1=0;$v_1<2&&!IsNull($v_0)&&$v_0.get_tagName()!=="A"&&$v_0.get_className()!=="ms-crm-List-Link";$v_1++)$v_0=$v_0.get_parentNode();if($v_0.get_tagName()!=="A"||$v_0.get_className()!=="ms-crm-List-Link")return null;this.$2h_0=$v_0}return this.$2h_0},set_ancestorAnchor:function(value){throw Error.invalidOperation("Mscrm.GridPresenceView.AncestorAnchor.set: Setter is used for unit testing and should not be consumed in production code.");return value},get_status:function(){return this.$2M_0},set_status:function(value){this.$2M_0=value;return value},initialize:function(){this.$T_0.setAttribute("alt",this.$2M_0.get_description());this.$T_0.setAttribute("title",this.$2M_0.get_description());!IsNull(this.get_ancestorAnchor())&&this.$T_0.set_tabIndex(this.get_ancestorAnchor().get_tabIndex());this.get_domHelperProxy().addEventHandler(this.$T_0,"mouseover",this.$$d_$7W_0);this.get_domHelperProxy().addEventHandler(this.$T_0,"mouseout",this.$$d_$7V_0);this.get_domHelperProxy().addEventHandler(this.$T_0,"focusin",this.$$d_$6H_0);this.get_domHelperProxy().addEventHandler(this.$T_0,"focusout",this.$$d_$6I_0);this.get_domHelperProxy().addEventHandler(this.$T_0,"keydown",this.$$d_$7P_0)},dispose:function(){this.get_domHelperProxy().clearEventHandlers(this.$T_0)},$1p_0:function($p0,$p1){if(IsNull($p1))return;var $v_0=new Mscrm.GridPresenceViewEventParameters;$v_0.$t_0=$p0;$p1(this,$v_0)},$7W_0:function($p0){var $v_0=this.$D_0.getHandler("MouseOverEvent");this.$1p_0($p0,$v_0)},$7V_0:function($p0){var $v_0=this.$D_0.getHandler("MouseOutEvent");this.$1p_0($p0,$v_0)},$6H_0:function($p0){var $v_0=this.$D_0.getHandler("FocusInEvent");this.$1p_0($p0,$v_0)},$6I_0:function($p0){var $v_0=this.$D_0.getHandler("FocusOutEvent");this.$1p_0($p0,$v_0)},$7P_0:function($p0){var $v_0=this.$D_0.getHandler("KeyDownEvent");this.$1p_0($p0,$v_0)}};Mscrm.GridPresenceViewEventParameters=function(){};Mscrm.GridPresenceViewEventParameters.prototype={$t_0:null,get_domEvent:function(){return this.$t_0},set_domEvent:function(value){this.$t_0=value;return value}};Mscrm.BeforeFormLoadEventArgs=function(objectTypeCode,objectId,objectRow,isDblClick){Mscrm.BeforeFormLoadEventArgs.initializeBase(this);this.objectTypeCode=objectTypeCode;this.objectID=objectId;this.objectRow=objectRow;this.isDblClick=isDblClick};Mscrm.BeforeFormLoadEventArgs.prototype={objectTypeCode:0,objectID:null,objectRow:null,isDblClick:false,breakEvent:false};Mscrm.AppGridDefaultDataControl=function(element){this.$$d_contextMenuItemClickHandler=Function.createDelegate(this,this.contextMenuItemClickHandler);this.$$d_$2V_3=Function.createDelegate(this,this.$2V_3);this.$$d_$8Q_3=Function.createDelegate(this,this.$8Q_3);this.$$d_$4X_3=Function.createDelegate(this,this.$4X_3);this.$$d_$4Y_3=Function.createDelegate(this,this.$4Y_3);this.$$d_handleContextMenu=Function.createDelegate(this,this.handleContextMenu);this.$$d_$6q_3=Function.createDelegate(this,this.$6q_3);this.$4u_3=["ms-crm-List-DataCell-Lite","ms-crm-List-RoleDataCell-Lite","ms-crm-List-DataCell-Associated-Lite"];this.$N_3=-1;this.$B_3=[];this.$1h_3=[];this.$19_3=-1;Mscrm.AppGridDefaultDataControl.initializeBase(this,[element]);this.$2r_3=element;if(window.LOCID_UI_DIR==="RTL"){this.$3F_3=39;this.$3G_3=37}else{this.$3F_3=37;this.$3G_3=39}};Mscrm.AppGridDefaultDataControl.$8C=function($p0,$p1){var $v_0=$p0.getCellValueFromGridRow("absoluteurl",$p1),$v_1=$p0.getCellValueFromGridRow("readurl",$p1),$v_2=$p0.getCellValueFromGridRow("oid",$p1);if(!isNullOrEmptyString($v_0)||!isNullOrEmptyString($v_1))Mscrm.AppGridDefaultDataControl.$5C($v_1,$v_0);else{var $v_3=["absoluteurl","readurl"],$v_4=null;Mscrm.AppGridDefaultDataControl.$7T();Xrm.Internal.messages.retrieve(Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_2,$v_3).then(function($p1_0){$v_4=$p1_0.get_entity();$v_0=$v_4.getValue("absoluteurl").toString();$v_1=$v_4.getValue("readurl").toString();Mscrm.AppGridDefaultDataControl.$5C($v_1,$v_0)},null)}};Mscrm.AppGridDefaultDataControl.$7T=function(){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true)};Mscrm.AppGridDefaultDataControl.$5C=function($p0,$p1){if(!isNullOrEmptyString($p0))window.open($p0,"_blank");else!isNullOrEmptyString($p1)&&Mscrm.AppGridDefaultDataControl.$8j($p1)};Mscrm.AppGridDefaultDataControl.$8j=function($p0){!isNullOrEmptyString($p0)&&window.open($p0,"_blank")};Mscrm.AppGridDefaultDataControl.$5j=function($p0){return !(Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-DataCell")||Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-NonDataCell")||Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-DataCell-Lite")||Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-DataCell-Associated-Lite"))&&!(Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-SelectedRow")||Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-SelectedRow-Lite"))&&!Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-HoveredRow")&&!Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-SelectedMultilineRow")&&!Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-DeleteContainer")&&!Sys.UI.DomElement.containsCssClass($p0,"ms-crm-List-HoveredMultilineRow")};Mscrm.AppGridDefaultDataControl.$r=function($p0){var $v_0=$p0.getAttribute("selected");if(IsNull($v_0))return false;return $v_0.toUpperCase()==="TRUE"};Mscrm.AppGridDefaultDataControl.$4k=function($p0){var $v_0=$p0.getAttribute("expanded");if(IsNull($v_0))return false;return $v_0.toUpperCase()==="TRUE"};Mscrm.AppGridDefaultDataControl.$6C=function($p0){var $v_0=null,$v_1=$p0.target,$v_2=false;while($v_1&&!$v_2){for(var $v_3=Mscrm.Utilities.getChildElementsByClassNameRecursive($v_1,"ms-crm-Standard-Popup",false),$v_4=0;$v_4<$v_3.length;$v_4++){var $v_5=$v_3[$v_4];if($v_5.id==="divMenu"){$v_0=$v_5;$v_2=true;break}}$v_1=$v_1.parentNode}if(!$v_0)$v_0=$get("divMenu");return $v_0};Mscrm.AppGridDefaultDataControl.prototype={$1g_3:"",add_onSelectionChange:function(value){this.get_events().addHandler("OnSelectionChange",value)},remove_onSelectionChange:function(value){this.get_events().removeHandler("OnSelectionChange",value)},add_onBeforeFormLoad:function(value){this.get_events().addHandler("OnBeforeFormLoad",value)},remove_onBeforeFormLoad:function(value){this.get_events().removeHandler("OnBeforeFormLoad",value)},$3u_3:false,$n_3:0,$39_3:0,$f_3:null,$17_3:null,$2C_3:null,$3t_3:0,$2G_3:null,$18_3:null,$3y_3:21,$2r_3:null,$1R_3:null,$3Z_3:0,$3F_3:0,$3G_3:0,disposeRecordsKey:function(){if(!IsNull(this.get_parentGridControl())&&!IsNull(this.get_parentGridControl().get_eventManager())){var $v_0={};if(isNullOrEmptyString(this.$1g_3))$v_0["key"]=this.get_parentGridControl().GetParameter("viewid");else $v_0["key"]=this.$1g_3;this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.RemoveCacheData,$v_0)}},removeDblClickHandler:function(){$removeHandler(this.get_element(),"dblclick",this.$$d_$6q_3)},dispose:function(){if(this.get_isDisposed())return;this.$3g_3(this.get_element(),false);if(!IsNull(this.get_parentGridControl())){var $v_0=$get(this.$2z_3+"_divDataArea");!IsNull($v_0)&&$removeHandler($v_0,"contextmenu",this.$$d_handleContextMenu)}$removeHandler(this.get_element(),"keyup",this.$$d_$4Y_3);$removeHandler(this.get_element(),"keydown",this.$$d_$4X_3);$removeHandler(this.get_element(),"mouseover",this.$$d_$8Q_3);$removeHandler(this.get_element(),"dblclick",this.$$d_$6q_3);$removeHandler(this.get_element(),"click",this.$$d_$2V_3);this.$2_3=null;Mscrm.CrmUIControl.prototype.dispose.call(this)},$2_3:null,$2z_3:null,get_parentGridControl:function(){return this.$2_3},set_parentGridControl:function(value){this.$2_3=value;this.$2z_3=this.$2_3.get_element().id;if(!IsNull(value)){if(IsNull(value.$0_3))value.$0_3=this;this.$3g_3(this.get_element(),true)}return value},printRow:function(row){if(!IsNull(row)){var $v_0=Mscrm.CrmUri.create("/_forms/print/print.aspx");$v_0.get_query()["objectType"]=this.get_element().getAttribute("oname");$v_0.get_query()["id"]=row.getAttribute("oid");$v_0.get_query()["subType"]=row.getAttribute("otype");openStdWinWithFeatures($v_0,"print"+buildWinName(row.getAttribute("oid")),"",false)}},previewRow:function(row){if(IsNull(row)||IsNull(row.getAttribute("otype"))||IsNull(row.getAttribute("oid")))return;parseInt(row.getAttribute("otype"))===9100&&this.$65_3(row)},openInNewWindow:function(row){if(IsNull(this.get_parentGridControl())||IsNull(Mscrm.PageManager)||IsNull(Mscrm.PageManager.get_instance())||!Mscrm.PageManager.isFlatUIPage())return;if(!Mscrm.PageManager.isFlatObject(parseInt(this.get_element().getAttribute("oname")))){this.$1s_3(this.$1T_3(row));return}var $v_0=this.$1T_3(row);if(IsNull($v_0))return;var $v_1={};$v_1["etc"]=this.get_element().getAttribute("oname");if(!IsNull($v_0.getAttribute("otype")))$v_1["etc"]=$v_0.getAttribute("otype");$v_1["id"]=$v_0.getAttribute("oid");$v_1["pagetype"]="entityrecord";$v_1["sitemappath"]=this.$8l_3();$v_1["queryString"]=getParentEntityIdParams();var $v_2=getWindowInformation($v_1["etc"]);$v_1["windowWidth"]=$v_2["windowWidth"];$v_1["windowHeight"]=$v_2["windowHeight"];if(Mscrm.Utilities.isChrome()){$v_1["features"]="scrollbars=1";$v_1["trimStatus"]=false}this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_1)},$8l_3:function(){var $v_0=this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.GetSelectedAreaSubAreaIds,null);if(IsNull($v_0)||!$v_0.length)return null;var $v_1=$v_0[0];if(!IsNull($v_1))return $v_1["sitemappath"];return null},openSelectedRecord:function(parameters){if(!IsNull(this.get_selectedRecords())&&this.get_selectedRecords().length===1)this.$1s_3(this.$1T_3(this.get_selectedRecords()[0][3]),parameters,false);else if(!IsNull(this.get_selectedRecords())&&this.get_selectedRecords().length>1)throw Error.create("More than a single record selected.")},openGridInNewWindow:function(){if(Mscrm.NavigationMode.DefaultNavigationMode!==Mscrm.NavigationMode.NavigationModeInline)return;if(IsNull(this.get_parentGridControl())||IsNull(Mscrm.PageManager)||IsNull(Mscrm.PageManager.get_instance())||!Mscrm.PageManager.isFlatUIPage())return;var $v_0={};$v_0["etc"]=this.get_element().getAttribute("oname");$v_0["viewid"]=this.get_parentGridControl().GetParameter("viewid");$v_0["pagetype"]="entitylist";$v_0["newWindow"]=true;this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_0)},SelectRecords:function(start,stop,unselect){if(IsNull(start))start=0;if(IsNull(stop))stop=this.get_dataTableBody().rows.length-1;if(!IsNull(unselect)&&unselect&&stop!==this.get_dataTableBody().rows.length-1)for(var $v_0=this.$B_3.length,$v_1=0;$v_1<$v_0;$v_1++){var $v_2=this.$B_3[$v_1];if(!IsNull($v_2)&&($v_2.sectionRowIndex<start||$v_2.sectionRowIndex>stop)){this.$1W_3($v_2,false,false);Array.removeAt(this.$B_3,$v_1);$v_1--;$v_0--}}for(;start<stop+1;start++){this.$2P_3(this.get_dataTableBody().rows[start]);var $v_3=this.$2d_3(this.get_dataTableBody().rows[start],false);if(!$v_3)break}this.$N_3=stop;this.$1D_3()},UnselectRecords:function(skip){var $v_0=this.$B_3[this.$B_3.length-1];Array.removeAt(this.$B_3,this.$B_3.length-1);while(!IsNull($v_0)){this.$2P_3($v_0);this.$1W_3($v_0,false,false);$v_0=this.$B_3[this.$B_3.length-1];Array.removeAt(this.$B_3,this.$B_3.length-1)}!IsNull(skip)&&this.$2d_3(skip,false);this.$1D_3()},resizeColumn:function(columnName,width){var $v_0=this.FindColumnIndex(columnName);$v_0>-1&&this.resizeColumnOnIndex($v_0,width)},resizeColumnOnIndex:function(columnIndex,width){if(columnIndex>-1)this.get_element().getElementsByTagName("COL")[columnIndex].style.width=(width+3).toString()+"px"},autoResizeColumn:function(columnName){var $v_0=this.get_dataTableBody().rows,$v_1=$v_0.length,$v_2=this.FindColumnIndex(columnName),$v_3=0;if($v_2<0)return -1;if(XUI.Html.DomUtils.GetFirstChild($v_0[0]).className!=="ms-crm-List-MessageText")for(var $v_4=0;$v_4<$v_1;$v_4++){var $v_5=$v_0[$v_4].cells[$v_2],$v_6=XUI.Html.DomUtils.GetFirstChild($v_5),$v_7=$v_5.style.overflow,$v_8=$v_6.style.overflow,$v_9=$v_6.innerHTML;$v_5.style.overflow="visible";$v_6.style.overflow="visible";$v_6.innerHTML="<span>"+$v_9+"</span>";var $v_A=XUI.Html.DomUtils.GetFirstChild($v_6);if($v_A.offsetWidth>$v_3)$v_3=$v_A.offsetWidth;$v_5.style.overflow=$v_7;$v_6.style.overflow=$v_8;$v_6.innerHTML=$v_9}return $v_3+12},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);$addHandler(this.get_element(),"keyup",this.$$d_$4Y_3);$addHandler(this.get_element(),"keydown",this.$$d_$4X_3);$addHandler(this.get_element(),"mouseover",this.$$d_$8Q_3);$addHandler(this.get_element(),"dblclick",this.$$d_$6q_3);$addHandler(this.get_element(),"click",this.$$d_$2V_3);this.$3Z_3=window.LOCID_GRID_SELECT_ALL_KEY.charCodeAt(0);this.$1D_3();this.$5n_3()},$5n_3:function(){if(!IsNull(this.get_parentGridControl())){var $v_0=$get(this.get_parentGridControl().get_id()+"_divDataArea");$addHandler($v_0,"contextmenu",this.$$d_handleContextMenu);var $v_1=this.get_numberOfRecords();if($v_1>0)if(this.$56_3()){this.SelectRecords(0,0,false);this.$N_3=0}}},$3g_3:function($p0,$p1){if(this.$3u_3===$p1)if($p1)this.$3g_3($p0,!$p1);else return;else this.$3u_3=$p1;var $v_0=this.$2z_3,$v_1={};$v_1["CrmGrid"]=$v_0;for(var $v_2=$p0.getElementsByTagName("col"),$v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3].getAttribute("name");if(!IsNull($v_4)){var $v_5=$v_0+"_resize_"+$v_4;if($p1){var $v_6=$get($v_5);!IsNull($v_6)&&IsNull($find($v_5))&&Mscrm.CrmUIComponent.crmCreate(Mscrm.ColumnResizeControl,$v_1,null,null,$v_6)}else{var $v_7=$find($v_5);!IsNull($v_7)&&$v_7.dispose()}}}},$56_3:function(){var $v_0=false,$v_1=this.get_parentGridControl().GetParameter("EnableFirstRecordSelection");if(!IsNull($v_1)){$v_0=Mscrm.Utilities.parseBoolean($v_1);if($v_0&&this.get_parentGridControl().GetParameter("GridType")==="SubGrid"&&!this.get_parentGridControl().$1d_3)$v_0=false}return $v_0},$4N_3:function($p0){for(var $v_0=[],$v_1=this.get_dataTableBody().rows.length,$v_2=0,$v_3=0;$v_3<$v_1;$v_3++){var $v_4=this.get_dataTableBody().rows[$v_3];if(!IsNull($v_4.getAttribute("oid"))&&(!$p0||Mscrm.AppGridDefaultDataControl.$r($v_4))){$v_0[$v_2]=[];$v_0[$v_2][0]=$v_4.getAttribute("oid");$v_0[$v_2][3]=$v_4;if(!IsNull($v_4.getAttribute("otype"))){$v_0[$v_2][1]=$v_4.getAttribute("otype");$v_0[$v_2][3].setAttribute("otype",$v_4.getAttribute("otype"))}else{$v_0[$v_2][1]=this.get_element().getAttribute("oname");$v_0[$v_2][3].setAttribute("otype",this.get_element().getAttribute("oname"))}$v_0[$v_2][2]=$v_3;$v_2++}}return $v_0},get_selectedRecords:function(){return this.$4N_3(true)},get_allRecords:function(){return this.$4N_3(false)},get_recordsKey:function(){return this.$1g_3},set_recordsKey:function(value){this.$1g_3=value;return value},get_contextMenuRow:function(){return this.$f_3},get_moreRecords:function(){return this.get_element().getAttribute("morerecords")==="1"},get_totalRecordCount:function(){var $v_0=this.get_element().getAttribute("totalrecordcount");if(!IsNull($v_0))return parseInt($v_0,10);return -1},get_allRecordsCounted:function(){return this.get_element().getAttribute("allrecordscounted")!=="0"},get_dataTableBody:function(){var $v_0=this.get_element().getElementsByTagName("tbody");if(!IsNull($v_0)&&$v_0.length>0)return $v_0[0];return this.get_element()},$1D_3:function(){this.fireControlEvent("OnSelectionChange",Sys.EventArgs.Empty)},get_numberOfRecords:function(){var $v_0=this.get_element().getAttribute("numRecords");if(!IsNull($v_0)){this.$n_3=parseInt($v_0);return this.$n_3}if(!this.$n_3){for(var $v_1=0,$v_2=this.$2r_3.rows.length,$v_3=0;$v_3<$v_2;$v_3++){var $v_4=this.$2r_3.rows[$v_3].getAttribute("oid");if(!IsNull($v_4))$v_1++}this.$n_3=$v_1}return this.$n_3},get_defaultRowHeight:function(){return this.$3y_3},FindColumnIndex:function(columnName){var $v_0=0,$v_1=-1,$v_2=this.get_element().getElementsByTagName("COL"),$v_3=$v_2.length;while($v_0<$v_3){var $v_4=$v_2[$v_0];if(!IsNull($v_4.getAttribute("name"))&&$v_4.getAttribute("name")===columnName){$v_1=$v_0;break}$v_0++}return $v_1},get_primaryFieldName:function(){return this.get_element().getAttribute("primaryfieldname")},get_primaryFieldLabel:function(){var $v_0=XUI.Xml.LoadXml(this.get_parentGridControl().get_layoutXml()),$v_1=XUI.Xml.SelectSingleNode($v_0,"columns/column[@fieldname='"+this.get_primaryFieldName()+"']",null);return XUI.Xml.GetText($v_1.attributes.getNamedItem("label"))},sendShortcut:function(throughEmail,objectTypeCode){Mscrm.Utilities.sendSelectedRecordsUrl(throughEmail,this.$8D_3(this.get_parentGridControl().$0_3.get_selectedRecords()),objectTypeCode,false)},$8D_3:function($p0){for(var $v_0=[],$v_1=0;$v_1<$p0.length;++$v_1){var $v_2=new Mscrm.RecentlyViewedItem;$v_2.Id=$p0[$v_1][0];$v_2.TypeCode=$p0[$v_1][1];$v_0[$v_1]=$v_2}return $v_0},get_primaryFieldColumnIndex:function(){if(!IsNull(this.get_element().getAttribute("primaryfieldname"))){var $v_2=this.FindColumnIndex(this.get_element().getAttribute("primaryfieldname"));if($v_2!==-1)return $v_2}for(var $v_0=XUI.Html.DomUtils.GetFirstChild(this.get_element()).children,$v_1=$v_0.length,$v_3=0;$v_3<$v_1;$v_3++)if(!IsNull($v_0[$v_3].getAttribute("name")))return $v_3;return -1},$8Q_3:function($p0){var $v_0=$p0.target;if(!IsNull($v_0)&&!$v_0.title.length&&$v_0.innerHTML.length>0&&($v_0.tagName.toUpperCase()==="NOBR"||this.get_parentGridControl()&&this.get_parentGridControl().isLiteSubGrid()&&$v_0.className==="ms-crm-data-format-string")&&!Sys.UI.DomElement.containsCssClass($v_0.parentNode,"ms-crm-SubGrid-InlineEdit-Nobr-Div"))$v_0.title=XUI.Html.GetText($v_0)},$1T_3:function($p0){while(!IsNull($p0)&&($p0.tagName.toUpperCase()!=="TR"||IsNull($p0.getAttribute("oid")))){$p0=$p0.parentNode;if(IsNull($p0.tagName))return null}return $p0},$6q_3:function($p0){this.$3W_3($p0,true)},$3W_3:function($p0,$p1){this.$1R_3=this.$2T_3($p0,false);if(!IsNull(this.$1R_3))if(($p0.ctrlKey||$p0.target.tagName.toUpperCase()==="INPUT"&&$p0.target.getAttribute("type")==="checkbox")&&Mscrm.AppGridDefaultDataControl.$r(this.$1R_3))this.$1W_3(this.$1R_3,true,true);else this.$1o_3(this.$1R_3,$p0.target,Mscrm.Utilities.getDomEventKeyCode($p0),$p0.shiftKey,$p0.ctrlKey);var $v_0=this.get_selectedRecords();if(!$v_0.length)return;var $v_1=$v_0[0],$v_2=$v_1[3];this.$1s_3($v_2,null,$p1)},$74_3:function($p0){var $v_0=true;if(!this.get_parentGridControl())return $v_0;if(!isNullOrEmptyString(this.get_parentGridControl().GetParameter("disablePrimaryFieldClick")))if(Mscrm.Utilities.parseBoolean(this.get_parentGridControl().GetParameter("disablePrimaryFieldClick"))){$v_0=false;return $v_0}var $v_1=this.get_parentGridControl().GetProperty("dataProvider");if(!IsNull($v_1)&&$v_1==="Microsoft.Crm.Application.Controls.LookupGridDataProvider")this.$3W_3($p0,false);else{var $v_2=this.$2T_3($p0,false);!IsNull($v_2)&&this.$1s_3($v_2)}return $v_0},$1s_3:function($p0,$p1,$p2){if(!this.get_parentGridControl()||this.get_parentGridControl().GetParameter("disableDblClick")==="1"||!this.$n_3)return;window.clearTimeout(this.$3t_3);this.$3t_3=0;$p0=this.$1T_3($p0);if(IsNull($p0))return;var $v_0=parseInt(this.get_element().getAttribute("oname"));if(!IsNull($p0.getAttribute("otype"))){$v_0=parseInt($p0.getAttribute("otype"));if($v_0===Mscrm.EntityTypeCode.Workflow){var $v_2=$p0.getAttribute("oid"),$v_3=$p0.getAttribute("category");if(!isNullOrEmptyString($v_2)&&!isNullOrEmptyString($v_3)&&Mscrm.Utilities.parseInt($v_3)===4){Mscrm.BpfConfiguratorUtils.launchConfigurator($v_2);return}}}if(!IsNull($p0.getAttribute("otype"))){$v_0=parseInt($p0.getAttribute("otype"));if($v_0===Mscrm.EntityTypeCode.SharePointDocument){Mscrm.AppGridDefaultDataControl.$8C(this.get_parentGridControl(),$p0);return}}else return;if(IsNull($p2))$p2=false;if(this.$4v_3($p0,$v_0,$p0.getAttribute("oid"),$p2))return;var $v_1=null;if(!isNullOrEmptyString($p1))$v_1=$p1;else $v_1=getParentEntityIdParams();if(!IsNull(this.get_parentGridControl())&&!IsNull(Mscrm.PageManager)&&!IsNull(getPageManager())&&Mscrm.PageManager.isFlatUIPage()&&Mscrm.PageManager.isFlatObject(parseInt(this.get_element().getAttribute("oname"),10))){var $v_4={};$v_4[Mscrm.RecordSetNavigation.PrimaryFieldName]=this.get_primaryFieldName();$v_4[Mscrm.RecordSetNavigation.PrimaryFieldColumnIndex]=this.get_primaryFieldColumnIndex();$v_4[Mscrm.RecordSetNavigation.PageNumber]=this.get_parentGridControl().get_pageNumber();var $v_5=String.format(Mscrm.RecordSetNavigation.GridXmlMask,this.get_parentGridControl().get_pageNumber());$v_4[$v_5]=this.get_parentGridControl().get_gridXml();$v_4[Mscrm.RecordSetNavigation.LayoutXml]=this.get_parentGridControl().get_layoutXml();$v_4[Mscrm.RecordSetNavigation.RecordPosition]=this.$6D_3(this.get_allRecords(),$p0.getAttribute("oid"));var $v_6=this.get_parentGridControl().GetParameter("viewTitle");if(IsNull($v_6)||!$v_6.length)$v_6=window.LOCID_GRID_NO_VIEW_NAME;var $v_7=false,$v_8=this.get_parentGridControl().get_id(),$v_9=$find($v_8+"_SavedNewQuerySelector");if(!IsNull($v_9)&&$v_9.showNewVSControl&&!$v_9.showOriginalSelectBox&&$v_9.selectedViewName===window.LOCID_SEARCH_RESULTS)$v_7=true;var $v_A=this.get_element().ownerDocument.getElementById($v_8+"_SavedQuerySelector");if(!$v_7&&!IsNull($v_A)&&!IsNull($v_A.SelectedOption)&&!IsNull($v_A.SelectedOption.Search)&&$v_A.SelectedOption.Search)$v_7=true;if($v_7){$v_6=window.LOCID_SEARCH_RESULTS;var $v_H=this.get_element().ownerDocument.getElementById($v_8+"_findCriteria").value;if(!IsNull($v_H))$v_6=String.format(window.LOCID_WINDOW_TITLE_FORMAT,$v_6,$v_H)}$v_4[Mscrm.RecordSetNavigation.ViewName]=$v_6;var $v_B=String.format(Mscrm.RecordSetNavigation.MoreRecordsMask,this.get_parentGridControl().get_pageNumber());$v_4[$v_B]=this.get_moreRecords();var $v_C=this.get_parentGridControl().get_layoutXml().indexOf('fieldname="'+this.get_primaryFieldName()+'"')>=0,$v_D=[];if($v_C){$v_D[0]=this.get_primaryFieldName();$v_4[Mscrm.RecordSetNavigation.DisplayFieldName]=this.get_primaryFieldName();$v_4[Mscrm.RecordSetNavigation.DisplayFieldLabel]=this.get_primaryFieldLabel();$v_4[Mscrm.RecordSetNavigation.DisplayFieldColumnIndex]=this.get_primaryFieldColumnIndex()}else{var $v_I=XUI.Xml.LoadXml(this.get_parentGridControl().get_layoutXml()),$v_J=XUI.Xml.SelectSingleNode($v_I,"columns/column",null);$v_D[0]=XUI.Xml.GetText($v_J.attributes.getNamedItem("fieldname"));$v_4[Mscrm.RecordSetNavigation.DisplayFieldName]=XUI.Xml.GetText($v_J.attributes.getNamedItem("fieldname"));$v_4[Mscrm.RecordSetNavigation.DisplayFieldLabel]=XUI.Xml.GetText($v_J.attributes.getNamedItem("label"));$v_4[Mscrm.RecordSetNavigation.DisplayFieldColumnIndex]=2}var $v_E=String.format(Mscrm.RecordSetNavigation.RecordsMask,this.get_parentGridControl().get_pageNumber());$v_4[$v_E]=Sys.Serialization.JavaScriptSerializer.serialize(Mscrm.Grid.getGridRecords(this.get_element(),$v_D,this.get_parentGridControl().get_layoutXml()));var $v_F={};$v_F["key"]=this.get_parentGridControl().GetParameter("viewid");$v_F["data"]=$v_4;$v_F["cacheScope"]=Mscrm.CacheScope.ChildOnly;$v_F["purgeDataOnCacheSync"]=true;var $v_G=null;if(!IsNull(this.get_parentGridControl())&&!IsNull(this.get_parentGridControl().get_eventManager())){this.disposeRecordsKey();$v_G=this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.InsertCacheData,$v_F)}if(!IsNull($v_G)&&$v_G.length>0){$v_1=IsNull($v_1)||!$v_1.length?"?":$v_1+"&";this.$1g_3=$v_G[0];$v_1+="rskey="+CrmEncodeDecode.CrmUrlEncode($v_G[0]);$v_1+="&_gridType="+CrmEncodeDecode.CrmUrlEncode(this.get_element().getAttribute("oname"))}}if(this.get_parentGridControl().GetParameter("sameWindow")==="false")openObj($v_0,$p0.getAttribute("oid"),$v_1,null,Mscrm.NavigationMode.NavigationModeNewWindow,null);else{var $v_K=this.get_parentGridControl();openObj($v_0,$p0.getAttribute("oid"),$v_1);!this.get_isDisposed()&&!IsNull(this.get_parentGridControl())&&!IsNull(this.get_parentGridControl().get_eventManager())&&$v_K.raiseEvent(Mscrm.ScriptEvents.CacheCurrentGridView,{})}},$6D_3:function($p0,$p1){if(IsNull($p0))return -1;var $v_0=0,$v_1=$p0.length;while($v_0<$v_1){if($p0[$v_0][0]===$p1)return $v_0;$v_0++}return -1},$4v_3:function($p0,$p1,$p2,$p3){var $v_0=new Mscrm.BeforeFormLoadEventArgs($p1,$p2,$p0,$p3);this.fireControlEvent("OnBeforeFormLoad",$v_0);return $v_0.breakEvent},$2T_3:function($p0,$p1){if(!this.$n_3){this.$8E_3($p0);return null}var $v_0=$p0.target,$v_1=$v_0.tagName.toUpperCase();if($v_1==="TBODY")return null;if($v_1==="IMG"){$v_0=$v_0.parentNode;$v_1=$v_0.tagName.toUpperCase();if($v_1!=="SPAN"&&$v_1!=="NOBR")return $v_0.parentNode}if($v_0.tagName.toUpperCase()==="SPAN")$v_0=$v_0.parentNode;if($v_0.tagName.toUpperCase()==="LI")$v_0=$v_0.parentNode;if($v_0.tagName.toUpperCase()==="A"){if($p1)return $v_0;$v_0=$v_0.parentNode}if($v_0.tagName.toUpperCase()==="NOBR")$v_0=$v_0.parentNode;if($v_0.tagName.toUpperCase()==="INPUT"&&$v_0.getAttribute("type")==="checkbox")$v_0=$v_0.parentNode;if($v_0.tagName.toUpperCase()==="DIV")$v_0=$v_0.parentNode;if($v_0.tagName.toUpperCase()==="TD"){if(Mscrm.AppGridDefaultDataControl.$5j($v_0))return null;$v_0=$v_0.parentNode}if($v_0.tagName.toUpperCase()==="TR")return $v_0;return null},$8E_3:function($p0){if(!IsNull(this.get_parentGridControl())&&this.get_parentGridControl().GetParameter("LoadOnDemand")==="1"&&!IsNull($p0)&&$p0.target.getAttribute("id")==="LoadOnDemandMessage"){this.get_parentGridControl().SetParameter("LoadOnDemand","0");this.get_parentGridControl().SetParameter("LoadOnDemand_GridEmptyMessage","");this.get_parentGridControl().Refresh()}},$2V_3:function($p0,$p1){this.get_parentGridControl().doNotFocusGridQuickFindOnLoad=true;var $v_0,$v_1;if(IsNull($p1)){$v_0=$p0.target;$v_1=this.$2T_3($p0,true)}else{$v_0=$p1;$v_1=$p1}if(!IsNull($v_1)&&!isNullOrEmptyString($v_1.className)&&$v_1.className==="ms-crm-List-DeleteContainer-Div")$v_1=$v_1.parentNode.parentNode;var $v_2=false;if($v_1)$v_2=Mscrm.AppGridDefaultDataControl.$r($v_1);if($v_0.tagName.toUpperCase()==="IMG")if(Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-grid-checkbox-image")||Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-grid-checkbox-image-Associated-Lite")){this.$6n_3($p0,$v_0,$v_1,$v_2);return}else if(($v_0.src.indexOf("grid")>0||$v_0.className.indexOf("ms-crm-ImageStrip-r")>0)&&!$p0.ctrlKey){$v_1=$v_0.parentNode.parentNode;!$v_2&&this.$1o_3($v_1,$v_0,Mscrm.Utilities.getDomEventKeyCode($p0),$p0.shiftKey,$p0.ctrlKey);this.previewRow($v_1);return}if(!IsNull($v_1)){var $v_3=true;if($v_1.tagName.toUpperCase()==="A"){var $v_7=this.get_parentGridControl().GetProperty("dataProvider");if($v_1.id.indexOf("primaryField")!==-1){if(!Mscrm.Utilities.isMobileRefresh())$v_3=this.$74_3($p0);$p0.preventDefault()}if(!$v_3||Mscrm.Utilities.isMobileRefresh()&&!IsNull($v_7)&&$v_7==="Microsoft.Crm.Application.Controls.LookupGridDataProvider"){if(Mscrm.Utilities.isMobileRefresh()&&!IsNull($v_7)&&$v_7==="Microsoft.Crm.Application.Controls.LookupGridDataProvider"){$v_1=$v_1.parentNode.parentNode;if(IsNull($v_1.getAttribute("class"))||$v_1.getAttribute("class")!=="row0"&&$v_1.getAttribute("class")!=="row1"&&$v_1.getAttribute("class")!=="ms-crm-List-Row"&&$v_1.getAttribute("class")!=="ms-crm-List-SelectedRow")$v_1=XUI.Html.DomUtils.GetPrevSibling($v_1)}else $v_1=$v_1.parentNode.parentNode.parentNode;$v_2=Mscrm.AppGridDefaultDataControl.$r($v_1)}else return}var $v_4=$v_0.tagName.toUpperCase()==="INPUT"&&$v_0.getAttribute("type")==="checkbox",$v_5=$p0.ctrlKey,$v_6=this.get_parentGridControl().isLiteSubGrid();if(($v_4||$v_5||$v_6||Mscrm.Utilities.isMobileRefresh()&&$v_2)&&Mscrm.AppGridDefaultDataControl.$r($v_1))this.$1W_3($v_1,true,true);else this.$1o_3($v_1,$v_0,Mscrm.Utilities.getDomEventKeyCode($p0),$p0.shiftKey,$p0.ctrlKey);this.$4J_3($v_1)}!IsNull(this.get_parentGridControl())&&this.get_parentGridControl().isLiteSubGrid()&&!$v_2&&Mscrm.Utilities.parseBoolean(this.get_parentGridControl().GetParameter("enablesingleclick"))&&this.handleSingleClick($p0)},$6n_3:function($p0,$p1,$p2,$p3){if(!$p3)this.$1o_3($p2,$p1,Mscrm.Utilities.getDomEventKeyCode($p0),$p0.shiftKey,$p0.ctrlKey);else this.$1W_3($p2,true,true)},handleSingleClick:function(targetEvent){switch(this.get_parentGridControl().get_entityTypeCode()){case Mscrm.EntityTypeCode.Incident:var $v_0=this.fetchSelectedRecord(),$v_1=$get("titleHeader"),$v_2=!$v_0||isNullOrEmptyString($v_0[2])?" ":$v_0[2];if(!IsNull($v_1)){XUI.Html.SetText($v_1,$v_2);$v_1.title=$v_2.trim()}var $v_3={};$v_3["entityID"]=!$v_0||!$v_0[0]?"":$v_0[0];var $v_4=new Mscrm.EntityReference;$v_4.Id=$v_3["entityID"];$v_4.TypeName="incident";$v_4.TypeCode=Mscrm.EntityTypeCode.Incident;$v_4.Name=$v_2;$v_3["entityReference"]=$v_4;$v_3["entityTypeToExpand"]=Mscrm.EntityTypeCode.IncidentResolution.toString();this.get_parentGridControl().raiseEvent(Mscrm.ScriptEvents.GridRowPreview,$v_3);break;default:this.$3W_3(targetEvent,false);break}},fetchSelectedRecord:function(){var $v_0=[];if(IsNull(this.get_selectedRecords())||this.get_selectedRecords().length<1)return null;var $v_1=this.$1T_3(this.get_selectedRecords()[0][3]);if(IsNull($v_1))return null;var $v_2=$v_1.getAttribute("oid");$v_0[0]=$v_2;var $v_3=parseInt(this.get_element().getAttribute("oname"));$v_0[1]=$v_3;var $v_4=XUI.Html.GetText($v_1);$v_0[2]=$v_4;return $v_0},$4X_3:function($p0){if($p0.target.tagName.toUpperCase()==="INPUT"&&($p0.target.className!=="ms-crm-RowCheckBox"&&$p0.target.className!=="ms-crm-RowCheckBox-Lite"))return;if($p0.altKey){$p0.preventDefault();return}var $v_0=Mscrm.Utilities.getDomEventKeyCode($p0);if($v_0===40||$v_0===38){$p0.preventDefault();var $v_1=0;if($v_0===40){if(this.$N_3>=this.get_dataTableBody().rows.length-1)return;$v_1=1}else if($v_0===38){if(this.$N_3<=0)return;$v_1=-1}var $v_2=this.$N_3+$v_1,$v_3=this.get_dataTableBody().rows[$v_2];if(!this.get_parentGridControl().isLiteSubGrid())if($v_3.cells[0].className==="ms-crm-List-PreviewCell"||$v_3.cells[1].className==="ms-crm-List-PreviewCell")$v_2=$v_2+$v_1;this.$4J_3($v_3);this.$2V_3($p0,$v_3);var $$t_6=this;$v_2=window.setInterval(function(){try{!$$t_6.$8b_3($v_3,$v_0===40)&&window.clearInterval($v_2)}catch($$e_5){window.clearInterval($v_2)}},0)}else if($v_0===this.$3Z_3)$p0.ctrlKey&&this.$n_3>0&&this.$8c_3();else if($v_0===80)this.get_parentGridControl().GetParameter("preview")==="1"&&$p0.preventDefault();else if($v_0===32){this.get_parentGridControl().get_maximumSelectableRecords()&&$p0.preventDefault();return}},$4Y_3:function($p0){var $v_0=Mscrm.Utilities.getDomEventKeyCode($p0);if($p0.altKey||$p0.shiftKey||$p0.ctrlKey&&$v_0!==this.$3Z_3)return;if($v_0===13){if(this.$n_3>0&&this.$N_3!==-1){var $v_1=$p0.target.parentNode.parentNode;if($v_1.tagName.toUpperCase()==="A"&&this.$1R_3.getAttribute("id").indexOf("primaryField")===-1)XUI.Html.DispatchDomEvent(this.get_dataTableBody().rows[this.$N_3],XUI.Html.CreateDomEvent("click"));else XUI.Html.DispatchDomEvent(this.get_dataTableBody().rows[this.$N_3],XUI.Html.CreateDomEvent("dblclick"))}}else if($v_0===80)this.get_parentGridControl().GetParameter("preview")==="1"&&this.previewRow(this.get_dataTableBody().rows[this.$N_3]);else if($v_0===32){if(this.get_parentGridControl().get_maximumSelectableRecords()){var $v_2=this.$2T_3($p0,false);if(!IsNull($v_2)){$p0.preventDefault();if(Mscrm.AppGridDefaultDataControl.$r($v_2))this.$1W_3($v_2,true,true);else this.$1o_3($v_2,$p0.target,Mscrm.Utilities.getDomEventKeyCode($p0),$p0.shiftKey,$p0.ctrlKey)}}}else if($v_0===this.$3G_3)this.get_moreRecords()&&this.get_parentGridControl().set_pageNumber(this.get_parentGridControl().get_pageNumber()+1);else if($v_0===this.$3F_3)this.get_parentGridControl().get_pageNumber()>1&&this.get_parentGridControl().set_pageNumber(this.get_parentGridControl().get_pageNumber()-1)},$8b_3:function($p0,$p1){var $v_0=this.get_parentGridControl().get_id()+"_divDataArea",$v_1=$get($v_0),$v_2=$v_1.scrollTop,$v_3=$v_1.clientHeight+$v_2,$v_4;if($p1){$v_4=$p0.offsetTop+$p0.offsetHeight;if($v_4>$v_3){$v_1.scrollTop+=Math.floor($v_1.offsetHeight/8);return true}}else{$v_4=$p0.offsetTop;if($v_4<$v_2){$v_1.scrollTop-=Math.floor($v_1.offsetHeight/8);return true}}return false},$1o_3:function($p0,$p1,$p2,$p3,$p4){if(!IsNull($p0.getAttribute("IsDisabled"))&&$p0.getAttribute("IsDisabled")==="1")return;if($p3&&this.$N_3!==-1){if(this.$19_3===-1)this.$19_3=this.$N_3;if($p0.sectionRowIndex<this.$19_3)this.SelectRecords($p0.sectionRowIndex,this.$19_3,true);else this.SelectRecords(this.$19_3,$p0.sectionRowIndex,true);this.$N_3=$p0.sectionRowIndex}else{if(!$p4)if($p2!==32&&!this.$62_3($p1)||this.get_parentGridControl().get_maximumSelectableRecords()===1){var $v_0=this.get_parentGridControl().GetParameter("multiSelectOnRowClick");if(IsNull($v_0)||$v_0!=="true"){var $v_1=this.get_parentGridControl().GetParameter("IsInlineMultiLookup");(!Mscrm.Utilities.isMobileRefresh()||isNullOrEmptyString($v_1)||$v_1!=="1")&&this.UnselectRecords($p0)}}this.$2d_3($p0,false);this.$N_3=$p0.sectionRowIndex;this.$19_3=-1}this.$1D_3()},$62_3:function($p0){if(this.$4F_3($p0))return true;return this.$61_3($p0)},$4F_3:function($p0){if(IsNull($p0.tagName))return false;if($p0.id.toString().startsWith("gridBodyTable_checkBox_Image"))return true;return $p0.tagName.toUpperCase()==="INPUT"&&$p0.getAttribute("type")==="checkbox"},$61_3:function($p0){var $v_0=XUI.Html.DomUtils.GetFirstChild($p0);return IsNull($v_0)?false:this.$4F_3($v_0)},$3o_3:function($p0,$p1){var $v_0="checkBox_"+$p0.getAttribute("oid"),$v_1=$get($v_0,$p0);if(!IsNull($v_1)){$v_1.checked=$p1;var $v_2=Mscrm.GridControl.getCheckBoxImage($p0);if(!IsNull($v_2))if(!$p1){$v_2.style.visibility="hidden";Sys.UI.DomElement.removeCssClass($v_2,"ms-crm-ImageStrip-checkbox");Sys.UI.DomElement.addCssClass($v_2,"ms-crm-ImageStrip-checkbox_light")}else{$v_2.style.visibility="visible";Sys.UI.DomElement.removeCssClass($v_2,"ms-crm-ImageStrip-checkbox_light");Sys.UI.DomElement.addCssClass($v_2,"ms-crm-ImageStrip-checkbox")}}$p0.setAttribute("selected",$p1?"true":"false")},$4J_3:function($p0){if(!this.get_parentGridControl().isLiteSubGrid()){var $v_0="checkBox_"+$p0.getAttribute("oid"),$v_1=$get($v_0,$p0);if(!IsNull($v_1))try{$v_1.focus()}catch($$e_3){}}},$2d_3:function($p0,$p1){if(IsNull($p0))return false;if(IsNull(this.get_parentGridControl()))return false;var $v_0=this.get_parentGridControl().get_maximumSelectableRecords();if(Mscrm.AppGridDefaultDataControl.$r($p0))return true;if(0===$v_0)return false;if(this.get_parentGridControl()&&this.get_parentGridControl().isLiteSubGrid()&&$p0.className==="ms-crm-Hidden-List")return false;if($v_0>0&&this.$39_3+1<=$v_0||$v_0===-1){if(XUI.Html.DomUtils.GetFirstChild($p0).className!=="ms-crm-List-PreviewCell"){this.$39_3++;this.$3o_3($p0,true);if($p0.className==="ms-crm-List-MultilineRow"||$p0.className==="ms-crm-List-HoveredMultilineRow")this.$1C_3($p0,"ms-crm-List-SelectedMultilineRow");else if(!this.get_parentGridControl().isLiteSubGrid()){this.$1C_3($p0,"ms-crm-List-SelectedRow");var $v_1=Mscrm.GridControl.getCheckBoxImage($p0);if(!IsNull($v_1))$v_1.style.visibility="visible"}else if(Mscrm.InternalUtilities.Utilities.isHighContrastEnabled())this.$1C_3($p0,"ms-crm-List-SelectedRow-Lite ms-crm-List-SelectedRow-Lite-HighContrast");else this.$1C_3($p0,"ms-crm-List-SelectedRow-Lite");this.$B_3[this.$B_3.length]=$p0;!IsNull($p1)&&$p1&&this.$1D_3();this.get_parentGridControl().isLiteSubGrid()&&Mscrm.GridControlLite.ShowDeleteButton($p0);return true}}else if(this.get_parentGridControl().isLiteSubGrid()){if($v_0===1){this.UnselectRecords($p0);return true}}else{alert($v_0===1?window.LOCID_GRID_TOO_MANY_RECORDS_ONE:String.format(window.LOCID_GRID_TOO_MANY_RECORDS,$v_0));this.$3o_3($p0,false);return false}return false},$1W_3:function($p0,$p1,$p2){if(!IsNull($p0)&&Mscrm.AppGridDefaultDataControl.$r($p0)){var $v_0=this.get_dataTableBody().rows[$p0.sectionRowIndex+1];if(!IsNull($v_0))$v_0=XUI.Html.DomUtils.GetFirstChild(XUI.Html.DomUtils.GetFirstChild($v_0));this.$39_3--;if($p0.className==="ms-crm-List-SelectedMultilineRow")this.$1C_3($p0,"ms-crm-List-MultilineRow");else if(!this.get_parentGridControl().isLiteSubGrid())this.$1C_3($p0,"ms-crm-List-Row");else this.$1C_3($p0,"ms-crm-List-Row-Lite");this.$3o_3($p0,false);if(!IsNull($p1)&&$p1)for(var $v_1=this.$B_3.length,$v_2=0;$v_2<$v_1;$v_2++)if($p0.sectionRowIndex===this.$B_3[$v_2].sectionRowIndex){Array.removeAt(this.$B_3,$v_2);break}!IsNull($p2)&&$p2&&this.$1D_3();this.get_parentGridControl().isLiteSubGrid()&&Mscrm.GridControlLite.HideDeleteButton($p0)}},saveSelectRows:function(){this.$1h_3=[];for(var $v_0=0;$v_0<this.$B_3.length;$v_0++)this.$1h_3[$v_0]=this.$B_3[$v_0]},reselectRows:function(){var $v_0=this.$1h_3.length;if($v_0>0)for(var $v_1=0;$v_1<$v_0;$v_1++)this.$2d_3(this.$1h_3[$v_1],false);else this.get_numberOfRecords()>0&&this.$56_3()&&this.SelectRecords(0,0,true);this.$1D_3()},$8c_3:function(){this.SelectRecords(0,this.get_dataTableBody().rows.length-1,false)},$1C_3:function($p0,$p1){var $v_0=this.$3S_3($p0);if($v_0){var $v_1;if($p1==="ms-crm-List-SelectedRow"||$p1==="ms-crm-List-SelectedMultilineRow"){$v_1=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/row_selected.gif"));$v_0.alt=window.LOCID_GRID_SELECTED_ROW;if(window.LOCID_UI_DIR==="RTL"){Mscrm.Utilities.cancelElementFlipping($v_0);Mscrm.Utilities.flipElementHorizontally($v_0)}}else{$v_1=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/r.gif"));$v_0.alt=window.LOCID_GRID_UNSELECTED_ROW;if(window.LOCID_UI_DIR==="RTL"){Mscrm.Utilities.cancelElementFlipping($v_0);Mscrm.Utilities.flipElementHorizontally($v_0)}}$v_0.src=$v_1.source;$v_0.className=Mscrm.ImageStrip.replaceExistingImageStripClass($v_0.className,$v_1.cssClass)}for(var $$arr_4=this.$4u_3,$$len_5=$$arr_4.length,$$idx_6=0;$$idx_6<$$len_5;++$$idx_6){var $v_2=$$arr_4[$$idx_6];if(Sys.UI.DomElement.containsCssClass($p0,$v_2))$p1=$v_2+" "+$p1}$p0.className=$p1},$3R_3:function($p0){var $v_0;if(!IsNull($p0.getAttribute("otype")))$v_0=parseInt($p0.getAttribute("otype"));else $v_0=parseInt(this.get_element().getAttribute("oname"));return $v_0},handleContextMenu:function(e){var $v_0=Mscrm.AppGridDefaultDataControl.$6C(e);if(IsNull($v_0))return;this.$f_3=this.$1T_3(e.target);this.$2C_3=document.createElement("DIV");this.$2C_3.setAttribute("id","menuContainer");document.body.appendChild(this.$2C_3);this.$17_3=Mscrm.Menu.createMenu(this.$2C_3);this.$17_3.set_stylePrefix(Mscrm.MenuStyles.popupStylePrefix);this.$17_3.set_width(170);var $v_1=CrmEncodeDecode.CrmHtmlDecode($v_0.getAttribute("menuXml").toString()),$v_2=XUI.Xml.LoadXml($v_1).firstChild,$v_3=XUI.Xml.SelectNodes($v_2,"//Menu/MenuItem",null),$v_4=false,$v_5=0;while($v_5<$v_3.length){var $v_6=null;$v_6=Mscrm.MenuItem.createMenuItem(XUI.Xml.GetText($v_3[$v_5].attributes.getNamedItem("title")));var $v_7=$v_3[$v_5].attributes.getNamedItem("isseparator");if(!IsNull($v_7))$v_6=Mscrm.MenuItemSeparator.createSeparator(false);else{$v_6.set_reference($v_3[$v_5].attributes.getNamedItem("typeId").nodeValue);$v_4=$v_3[$v_5].attributes.getNamedItem("disableonemptygrid").nodeValue==="yes"?true:false;$v_6.set_actionCallback(this.$$d_contextMenuItemClickHandler);var $v_8=IsNull(this.$f_3)||IsNull(this.$f_3.getAttribute("oid")),$v_9=Number.parseInvariant($v_6.get_reference().toString());$v_6.set_disabled($v_8&&$v_4||$v_9===Mscrm.ContextMenuAction.copyShortcut&&!Mscrm.Utilities.isIE())}this.$17_3.addItem($v_6);$v_5++}this.$17_3.set_left(e.clientX);this.$17_3.set_top(e.clientY);this.$17_3.show();e.preventDefault();e.stopPropagation()},$7r_3:function(){this.openInNewWindow(this.$f_3)},$8F_3:function(){this.get_parentGridControl().Refresh()},$8y_3:function(){window.open(window.location.href)},$8d_3:function($p0){this.sendShortcut(true,$p0)},$84_3:function(){this.printRow(this.$f_3)},$5o_3:function($p0){this.sendShortcut(false,$p0)},$7q_3:function(){this.$1s_3(this.$f_3)},contextMenuItemClickHandler:function(item){if(!IsNull(item)){var $v_0=Number.parseInvariant(item.get_reference().toString());switch($v_0){case Mscrm.ContextMenuAction.openInNewWindow:this.$7r_3();break;case Mscrm.ContextMenuAction.copyShortcut:this.$5o_3(this.$3R_3(this.$f_3));break;case Mscrm.ContextMenuAction.sendShortcut:this.$8d_3(this.$3R_3(this.$f_3));break;case Mscrm.ContextMenuAction.print:this.$84_3();break;case Mscrm.ContextMenuAction.refresh:this.$8F_3();break;case Mscrm.ContextMenuAction.openSource:this.$8y_3();break;case Mscrm.ContextMenuAction.open:this.$7q_3();break}}},$3S_3:function($p0){var $v_0="previewImage_"+$p0.getAttribute("oid"),$v_1=$get($v_0);return $v_1},$2P_3:function($p0){var $v_0=this.$3S_3($p0);if(!IsNull($p0)&&Mscrm.AppGridDefaultDataControl.$4k($p0)){var $v_1;if(Mscrm.AppGridDefaultDataControl.$r($p0)){$v_1=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/row_selected.gif"));$v_0.setAttribute("alt",window.LOCID_GRID_SELECTED_ROW)}else{$v_1=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/r.gif"));$v_0.setAttribute("alt",window.LOCID_GRID_UNSELECTED_ROW);window.LOCID_UI_DIR==="RTL"&&Mscrm.Utilities.flipElementHorizontally($v_0)}$v_0.setAttribute("src",$v_1.source);$v_0.className=Mscrm.ImageStrip.replaceExistingImageStripClass($v_0.className,$v_1.cssClass);this.get_dataTableBody().removeChild(XUI.Html.DomUtils.GetNextSibling($p0));$p0.setAttribute("expanded","false");this.$2G_3=null}},$65_3:function($p0){if(IsNull($p0))return;if(Mscrm.AppGridDefaultDataControl.$4k($p0)){this.$2P_3($p0);return}else!IsNull(this.$2G_3)&&this.$2P_3(this.$2G_3);var $v_0;if(!IsNull($p0.getAttribute("otype")))$v_0=$p0.getAttribute("otype");else $v_0=this.get_element().getAttribute("oname");if(IsNull(this.$18_3))this.$18_3=new XMLHttpRequest;var $v_1=Mscrm.CrmUri.create("/_grid/preview.aspx");$v_1.get_query()["type"]=$v_0;$v_1.get_query()["id"]=$p0.getAttribute("oid");this.$18_3.open("GET",$v_1.toString(),false);Mscrm.Utilities.setResponseTypeToMSXml(this.$18_3);this.$18_3.send(null);if(Mscrm.XmlUtil.handleXMLErr(this.$18_3.responseXML,false)!==window.ERROR_NONE)return;var $v_2=this.get_dataTableBody().insertRow($p0.sectionRowIndex+1);$v_2.setAttribute("oid",$p0.getAttribute("oid"));!IsNull($p0.getAttribute("otype"))&&$v_2.setAttribute("otype",$p0.getAttribute("otype"));$v_2.style.height="100%";var $$t_9=this;$addHandler($v_2,"mouseover",function($p1_0){$p1_0.stopPropagation()});var $$t_A=this;$addHandler($v_2,"click ",function($p1_0){$p1_0.stopPropagation()});var $v_3=$v_2.insertCell(0);$v_3.className="ms-crm-List-PreviewCell";$v_3.colSpan=$p0.cells.length;$v_3.innerHTML=XUI.Xml.GetText(this.$18_3.responseXML.firstChild.firstChild);$p0.setAttribute("expanded","true");$p0.style.paddingTop="0px";var $v_4=this.$3S_3($p0),$v_5=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/d.gif"));$v_4.src=$v_5.source;$v_4.className=Mscrm.ImageStrip.replaceExistingImageStripClass($v_4.className,$v_5.cssClass);$v_4.alt=window.LOCID_GRID_PREVIEW_ROW;this.$2G_3=$p0}};Mscrm.AppGridFilterContainer=function(element){this.$$d_$8g_3=Function.createDelegate(this,this.$8g_3);this.$$d_refreshGridView=Function.createDelegate(this,this.refreshGridView);this.$$d_$8f_3=Function.createDelegate(this,this.$8f_3);Mscrm.AppGridFilterContainer.initializeBase(this,[element]);this.$o_3=element.getAttribute("GridId");this.$46_3=parseInt(element.getAttribute("autorefresh"))};Mscrm.AppGridFilterContainer.prototype={$1n_3:null,$o_3:null,$46_3:0,initialize:function(){this.$1n_3=$find(this.$o_3);this.$46_3===1&&this.$49_3(this.$$d_$8f_3)},$8f_3:function($p0){var $v_0=$find($p0.id);$v_0.add_onChange(this.$$d_refreshGridView)},refreshGridView:function(sender,ea){this.$49_3(this.$$d_$8g_3);this.$1n_3.ResetPageNumber();this.$1n_3.Refresh()},$8g_3:function($p0){switch($p0.className){case "AppGridFilterSelector":var $v_0=$find($p0.id),$v_1=$v_0.getDataValue();if(!IsNull($v_1)){var $$dict_3=$v_1;for(var $$key_4 in $$dict_3){var $v_2={key:$$key_4,value:$$dict_3[$$key_4]};this.$1n_3.SetParameter($v_2.key,$v_2.value)}}break;default:!IsNull($p0.DataValue)&&this.$1n_3.SetParameter($p0.id,$p0.DataValue);break}},$49_3:function($p0){var $v_0=$get(this.$o_3+"_AppGridFilterSelector");!IsNull($v_0)&&$p0($v_0)}};Mscrm.AppGridFilterSelector=function(element){this.$$d_$6m_3=Function.createDelegate(this,this.$6m_3);Mscrm.AppGridFilterSelector.initializeBase(this,[element]);this.$o_3=element.getAttribute("GridId")};Mscrm.AppGridFilterSelector.prototype={add_onChange:function(value){this.get_events().addHandler("OnChange",value)},remove_onChange:function(value){this.get_events().removeHandler("OnChange",value)},$1l_3:null,$1t_3:null,$o_3:null,initialize:function(){var $v_0=$get(this.$o_3+"_FilterControl");if(!IsNull($v_0)){this.$1l_3=XUI.Html.DomUtils.GetFirstChild($v_0);$addHandler(this.$1l_3,"change",this.$$d_$6m_3)}this.$1t_3=$get(this.$o_3+"_ViewControl");!IsNull(this.$1t_3)&&$addHandler(this.$1t_3,"change",this.$$d_$6m_3)},getDataValue:function(){var $v_0={},$v_1=false;if(!IsNull(this.$1l_3)){var $v_2=this.$1l_3.id.replace(this.$o_3+"_","");$v_0[$v_2]=this.$1l_3.value;$v_1=true}if(!IsNull(this.$1t_3)){var $v_3=this.$1t_3,$v_4=$v_3.options;if($v_4.length>0){$v_0["queryapi"]=$v_4[$v_3.selectedIndex].getAttribute("queryapi");$v_1=true}}if($v_1)return $v_0;else return null},$6m_3:function($p0){this.fireControlEvent("OnChange",Sys.EventArgs.Empty)}};Mscrm.AppGridJumpBar=function(element){this.$$d_$8N_3=Function.createDelegate(this,this.$8N_3);this.$$d_$5X_3=Function.createDelegate(this,this.$5X_3);this.$$d_$68_3=Function.createDelegate(this,this.$68_3);Mscrm.AppGridJumpBar.initializeBase(this,[element]);this.$30_3=element};Mscrm.AppGridJumpBar.prototype={$M_3:null,$30_3:null,Reset:function(){!IsNull(this.$M_3)&&this.$1E_3(this.$M_3,false);this.$M_3=this.$30_3.rows[0].cells[0];this.$1E_3(this.$M_3,true)},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);for(var $v_0=this.$30_3.rows[0].cells,$v_1=0;$v_1<$v_0.length;$v_1++)if($v_0[$v_1].className.indexOf("ms-crm-List-DefaultIndex")>=0)this.$M_3=$v_0[$v_1];!IsNull(this.$M_3)&&this.$1E_3(this.$M_3,true);this.$5c_3()},dispose:function(){if(this.get_isDisposed())return;this.$5w_3();Mscrm.CrmUIControl.prototype.dispose.call(this)},$1E_3:function($p0,$p1){if($p1){if($p0.className.indexOf(" ms-crm-List-SelectedIndex")===-1)$p0.className+=" ms-crm-List-SelectedIndex"}else $p0.className=$p0.className.replace(" ms-crm-List-SelectedIndex","")},$5c_3:function(){$addHandler(this.get_element(),"click",this.$$d_$68_3);$addHandler(this.get_element(),"mouseover",this.$$d_$5X_3);$addHandler(this.get_element(),"mouseout",this.$$d_$8N_3)},$5w_3:function(){$removeHandler(this.get_element(),"click",this.$$d_$68_3);$removeHandler(this.get_element(),"mouseover",this.$$d_$5X_3);$removeHandler(this.get_element(),"mouseout",this.$$d_$8N_3)},$5X_3:function($p0){$p0.target.tagName.toLowerCase()==="td"&&$p0.target!==this.$M_3&&this.$1E_3($p0.target,true)},$8N_3:function($p0){$p0.target.tagName.toLowerCase()==="td"&&$p0.target!==this.$M_3&&this.$1E_3($p0.target,false)},$68_3:function($p0){var $v_0=$p0.target;if($v_0.tagName.toLowerCase()==="td"){var $v_1=Mscrm.GridControl.findComponent(this.get_element().getAttribute("gridId"));if($v_1.GetParameter("ispreviewmode")==="1"||$v_1.GetParameter("InnerGridDisabled")==="1")return;this.$1E_3(this.$M_3,false);this.$1E_3($v_0,true);this.$M_3=$v_0;var $v_2=this.$M_3.cellIndex;$v_1.SetParameter("filter",!$v_2?"":this.$M_3.getAttribute("filter"));$v_1.SetParameter("filterDisplay",!$v_2?"":XUI.Html.GetText(this.$M_3));$v_1.ClearPagingCookie();$v_1.set_pageNumber(1)}}};Mscrm.ColumnResizeControl=function(element){this.$$d_$8T_3=Function.createDelegate(this,this.$8T_3);this.$$d_$8S_3=Function.createDelegate(this,this.$8S_3);this.$$d_$5e_3=Function.createDelegate(this,this.$5e_3);this.$$d_$8U_3=Function.createDelegate(this,this.$8U_3);Mscrm.ColumnResizeControl.initializeBase(this,[element])};Mscrm.ColumnResizeControl.prototype={$2l_3:null,CrmGrid:null,initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);$addHandler(this.get_element(),"mousedown",this.$$d_$8U_3);$addHandler(this.get_element(),"dblclick",this.$$d_$5e_3)},dispose:function(){if(this.get_isDisposed())return;$removeHandler(this.get_element(),"mousedown",this.$$d_$8U_3);$removeHandler(this.get_element(),"dblclick",this.$$d_$5e_3);Mscrm.CrmUIControl.prototype.dispose.call(this)},get_$2U_3:function(){if(IsNull(this.$2l_3))this.$2l_3=Mscrm.GridControl.findComponent(this.CrmGrid);return this.$2l_3},$8U_3:function($p0){$p0.preventDefault();$addHandler(window.document,"mousemove",this.$$d_$8S_3);$addHandler(window.document,"mouseup",this.$$d_$8T_3);this.get_$2U_3().HandleResizeStartup($p0)},$8T_3:function($p0){$p0.preventDefault();$removeHandler(window.document,"mousemove",this.$$d_$8S_3);$removeHandler(window.document,"mouseup",this.$$d_$8T_3);this.get_$2U_3().HandleResizeCleanup($p0)},$8S_3:function($p0){$p0.preventDefault();this.get_$2U_3().HandleResize($p0,this)},$5e_3:function($p0){this.get_$2U_3().HandleAutoResize($p0,this)}};Mscrm.GridControl=function(element){this.$$d_$7x_3=Function.createDelegate(this,this.$7x_3);this.$$d_prepareEnablePresence=Function.createDelegate(this,this.prepareEnablePresence);this.$$d_initAppGridPresence=Function.createDelegate(this,this.initAppGridPresence);this.$$d_$80_3=Function.createDelegate(this,this.$80_3);this.$$d_$7z_3=Function.createDelegate(this,this.$7z_3);this.$$d_$7y_3=Function.createDelegate(this,this.$7y_3);this.$$d_$81_3=Function.createDelegate(this,this.$81_3);this.$$d_$82_3=Function.createDelegate(this,this.$82_3);this.$$d_$7h_3=Function.createDelegate(this,this.$7h_3);this.$$d_$4K_3=Function.createDelegate(this,this.$4K_3);this.$$d_HandleGridResize=Function.createDelegate(this,this.HandleGridResize);this.$$d_$7g_3=Function.createDelegate(this,this.$7g_3);this.$$d_$7k_3=Function.createDelegate(this,this.$7k_3);this.$$d_$7j_3=Function.createDelegate(this,this.$7j_3);this.$$d_$5J_3=Function.createDelegate(this,this.$5J_3);this.$$d_$8t_3=Function.createDelegate(this,this.$8t_3);this.$$d_$6o_3=Function.createDelegate(this,this.$6o_3);this.$$d_$6p_3=Function.createDelegate(this,this.$6p_3);this.$$d_$4T_3=Function.createDelegate(this,this.$4T_3);this.$$d_$4X_3=Function.createDelegate(this,this.$4X_3);this.$$d_$4b_3=Function.createDelegate(this,this.$4b_3);this.$$d_$7B_3=Function.createDelegate(this,this.$7B_3);this.$$d_$7C_3=Function.createDelegate(this,this.$7C_3);this.$$d_$2W_3=Function.createDelegate(this,this.$2W_3);this.$$d_$6A_3=Function.createDelegate(this,this.$6A_3);this.$$d_$6B_3=Function.createDelegate(this,this.$6B_3);this.$$d_$69_3=Function.createDelegate(this,this.$69_3);this.$$d_$8I_3=Function.createDelegate(this,this.$8I_3);this.$$d_$8J_3=Function.createDelegate(this,this.$8J_3);this.$$d_$8H_3=Function.createDelegate(this,this.$8H_3);this.$$d_$6E_3=Function.createDelegate(this,this.$6E_3);this.$$d_$7a_3=Function.createDelegate(this,this.$7a_3);this.$$d_$83_3=Function.createDelegate(this,this.$83_3);this.$$d_$4v_3=Function.createDelegate(this,this.$4v_3);this.$$d_$8B_3=Function.createDelegate(this,this.$8B_3);this.$$d_onRefreshComplete=Function.createDelegate(this,this.onRefreshComplete);this.$$d_handleAutoExpandRows=Function.createDelegate(this,this.handleAutoExpandRows);this.$$d_$6l_3=Function.createDelegate(this,this.$6l_3);this.$$d_$3Y_3=Function.createDelegate(this,this.$3Y_3);this.$$d_$8R_3=Function.createDelegate(this,this.$8R_3);this.$E_3=new Array(0);this.$1K_3=new Array(0);this.$1I_3=new Array(0);this.$J_3=null;this.$i_3=null;this.$z_3=new Mscrm.MetricsStopwatch("SubGrid");this.$1O_3=null;this.$1J_3=Mscrm.GridControl.gridTypeNone;this.$1L_3=-1;this.refresh=this.Refresh;this.getProperty=this.GetProperty;Mscrm.GridControl.initializeBase(this,[element]);this.$7S_3()};Mscrm.GridControl.get_$4S=function(){var $v_0=window.self.gridViewTimestamps;if(IsNull($v_0)){$v_0={};window.self.gridViewTimestamps=$v_0}return $v_0};Mscrm.GridControl.getExpanderClassName=function(expanderContainer){if(expanderContainer)return XUI.Html.DomUtils.GetFirstChild(expanderContainer).className;else return null};Mscrm.GridControl.$4G=function($p0){$p0.rawEvent.returnValue=false};Mscrm.GridControl.findComponent=function(gridId){var $v_0=$find(gridId);if(!IsNull($v_0)&&Mscrm.GridControl.isInstanceOfType($v_0))return $v_0;return null};Mscrm.GridControl.getControlBehaviorFromChildElement=function(childElement){var $v_0=childElement;while(!IsNull($v_0)&&Mscrm.GridControl.$7K($v_0))$v_0=$v_0.parentNode;if(IsNull($v_0))return null;var $v_1=12,$v_2=$v_0.id.toString().substring(0,$v_0.id.toString().length-$v_1);return $find($v_2)};Mscrm.GridControl.$7K=function($p0){return IsNull($p0)||isNullOrEmptyString($p0.id)||!$p0.id.toString().endsWith("_divDataArea")};Mscrm.GridControl.getCheckBoxImage=function(rowElement){if(Mscrm.Utilities.isMobileRefresh())return null;var $v_0=-1,$v_1=rowElement.getAttribute("rowindex");if(!IsNull($v_1)&&$v_1!==-1)$v_0=$v_1;else $v_0=rowElement.sectionRowIndex;var $v_2="gridBodyTable_checkBox_Image_"+rowElement.getAttribute("oid")+"_"+$v_0,$v_3=rowElement.ownerDocument.getElementById($v_2);return $v_3};Mscrm.GridControl.mouseOver=function(rowElement){var $v_0=2;if(window.UseTabletExperience||window.dialogType===$v_0)return;var $v_1=Mscrm.GridControl.getCheckBoxImage(rowElement);if(!IsNull($v_1))$v_1.style.visibility="visible"};Mscrm.GridControl.mouseOut=function(rowElement){if(window.UseTabletExperience)return;var $v_0=Mscrm.GridControl.getCheckBoxImage(rowElement);if(!isNullOrEmptyString(rowElement.getAttribute("selected"))&&rowElement.getAttribute("selected").toUpperCase()==="TRUE")return;if(!IsNull($v_0))$v_0.style.visibility="hidden"};Mscrm.GridControl.loadGridView=function(containerId,gridId,url,oId,isSubGridLite){if(isSubGridLite){url=Mscrm.GridControl.$6j(containerId,url);var $v_1=$get(containerId);!IsNull($v_1)&&$v_1.setAttribute("URL",url)}var $v_0=new XMLHttpRequest;$v_0.onreadystatechange=function(){if($v_0.readyState===4){$v_0.onreadystatechange=null;if($v_0.status===200)if(Mscrm.Utilities.isIE11StandardOrIE11CompatibleMode())window.setTimeout(function(){Mscrm.GridControl.$4H($v_0.responseXML,containerId,gridId,oId,isSubGridLite)},0);else Mscrm.GridControl.$4H($v_0.responseXML,containerId,gridId,oId,isSubGridLite);else if(!(!$v_0.status&&window.UseTabletExperience));}};$v_0.open("GET",url,true);Mscrm.Utilities.setResponseTypeToMSXml($v_0);Mscrm.MetricsReporting.instance().addXMLHttpRequestHeaders($v_0);$v_0.send(null)};Mscrm.GridControl.$4H=function($p0,$p1,$p2,$p3,$p4){executeFunctionDeferred(function(){Mscrm.GridControl.$4h($p0,$p1,$p2,$p3,$p4)},false,false)};Mscrm.GridControl.$6j=function($p0,$p1){if(isNullOrEmptyString($p0))return $p1;$p0=$p0.replace("_crmGridTD","_span");var $v_0=$get($p0);if(IsNull($v_0))return $p1;var $v_1=IsNull($v_0.getAttribute("TabIndexValue"))?"":$v_0.getAttribute("TabIndexValue").toString();return Mscrm.GridControl.getUpdatedUrl($p1,"tabIndex",$v_1)};Mscrm.GridControl.getUpdatedUrl=function(url,propertyName,propertyValue){var $v_0=Mscrm.CrmUri.create(url);if(isNullOrEmptyString(propertyValue)||$v_0.get_query()[propertyName].toString()===propertyValue)return url;else{$v_0.get_query()[propertyName]=propertyValue;return $v_0.toString()}};Mscrm.GridControl.$4h=function($p0,$p1,$p2,$p3,$p4){var $v_0=$get($p1);if(IsNull($v_0)){window.setTimeout(function(){Mscrm.GridControl.$4h($p0,$p1,$p2,$p3,$p4)},10);return}var $v_1=new Mscrm.Performance.PerformanceStopwatch("InsertGridView "+$p2);$v_1.start();var $v_2=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($p0,"//gridXml/gridHtml",null));Mscrm.Utilities.assignInnerHtml($v_0,$v_2);var $v_3=$get($p2);!IsNull($p3)&&$p3!==""&&Mscrm.GridControl.setElementParameter($v_3,"oId",$p3);var $v_4=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($p0,"//gridXml/gridHeader",null));$v_4+=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($p0,"//gridXml/gridInitFunctionName",null))+"();";var $v_5=new Function($v_4);$v_5.apply(window);Mscrm.GridControl.$8L($v_3);$v_1.stop()};Mscrm.GridControl.$8L=function($p0){if(IsNull($p0)||!Mscrm.Utilities.isRefreshForm())return;var $v_0=$find($p0.id),$v_1=new Mscrm.InlineSubGridControlView($v_0);$v_1.setLabelNodeDisplay();var $v_2=Xrm.Page.ui;if(IsNull($v_2.controls))$v_2.controls=new Mscrm.ClientApiCollection;$v_2.controls.add($v_1);Mscrm.InlineEditInitializerUtility.associateControlWithParentSection($p0,$v_1)};Mscrm.GridControl.setElementParameter=function(element,name,value){var $v_0=$get("divGridParams",element);if(!IsNull($v_0)){var $v_1=$get(name,$v_0);if(IsNull($v_1)){$v_1=$v_0.ownerDocument.createElement("div");$v_1.id=name;$v_0.appendChild($v_1)}$v_1.setAttribute("value",value)}};Mscrm.GridControl.$3T=function($p0){for(var $v_0=new Array($p0.length),$v_1=0;$v_1<$p0.length;$v_1++)$v_0[$v_1]=$p0[$v_1][0];return $v_0};Mscrm.GridControl.$3H=function($p0,$p1){for(var $v_0=new Array($p0.length),$v_1=0;$v_1<$p0.length;$v_1++){var $v_2=$p0[$v_1],$v_3=new Mscrm.EntityReference;$v_3.Id=$v_2[0];$v_3.TypeCode=parseInt($v_2[1],10);var $v_4=$v_2[3];$v_3.TypeName=$v_4.getAttribute("otypename");$v_3.Name=XUI.Html.GetText($v_4.children[$p1]);$v_0[$v_1]=$v_3}return $v_0};Mscrm.GridControl.isBrowserIE8OrLower=function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version<=8};Mscrm.GridControl.prototype={add_onSelectionChange:function(value){this.get_events().addHandler("OnSelectionChange",value)},remove_onSelectionChange:function(value){this.get_events().removeHandler("OnSelectionChange",value)},add_onBeforeFormLoad:function(value){this.get_events().addHandler("OnBeforeFormLoad",value)},remove_onBeforeFormLoad:function(value){this.get_events().removeHandler("OnBeforeFormLoad",value)},add_onReset:function(value){this.get_events().addHandler("OnReset",value)},remove_onReset:function(value){this.get_events().removeHandler("OnReset",value)},add_onResetComplete:function(value){this.get_events().addHandler("OnResetComplete",value)},remove_onResetComplete:function(value){this.get_events().removeHandler("OnResetComplete",value)},$1a_3:null,$21_3:null,$35_3:false,get_isLastControl:function(){return this.$28_3},RefreshAppGrid:function(){this.Reset(null)},Reset:function(funOnResetComplete){this.fireControlEvent("OnReset",Sys.EventArgs.Empty);if(!IsNull(Mscrm.PageManager)&&!IsNull(Mscrm.PageManager.get_instance())&&Mscrm.PageManager.isFlatUIPage()){var $v_0={};$v_0["viewid"]=this.GetParameter("viewid");$v_0["viewtype"]=this.GetParameter("viewtype");this.raiseEvent(Mscrm.ScriptEvents.OnGridReset,$v_0)}if(!IsNull(Mscrm.IFilterSet)){var $v_1=$find(this.get_id()+"_filterSet");if(!IsNull($v_1)){var $v_2=this.$2Q_3(),$v_3=$get("fetchXml",$v_2);!IsNull($v_3)&&$v_2.removeChild($v_3)}}if(!IsNull(Mscrm.IFilterSet)){var $v_4=$find(this.get_id()+"_filterSet");!IsNull($v_4)&&$v_4.DisposeFilterMenu()}this.$4D_3();this.ShowLoadingMessage();if(!IsNull(funOnResetComplete)){this.$21_3=funOnResetComplete;window.setTimeout(this.$$d_$8R_3,1);return true}else{this.$21_3=null;return this.$50_3()}},$8R_3:function(){this.$50_3()},$50_3:function(){if(!this.$1a_3)this.$1a_3=new Mscrm.RemoteCommandXml("AppGridWebService","Reset");this.$1a_3.setContent(this.$5g_3());this.$1a_3.setParameter("id",this.get_id());var $v_0=this.$1a_3.execute();return this.resetComplete($v_0)},resetComplete:function(resultCommand){if(resultCommand.get_success()&&!isNullOrEmptyString(resultCommand.get_returnValue())){var $v_0=XUI.Xml.LoadXml(resultCommand.get_returnValue()),$v_1=$get(this.get_id()+"_gridBodyContainer");$v_1.removeChild(XUI.Html.DomUtils.GetFirstChild($v_1));$v_1.innerHTML=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_0,"gridXml/gridHtml",null));this.$3E_3();var $v_2=XUI.Xml.SelectNodes($v_0,"gridXml/viewParameters/div",null);if($v_2)for(var $v_3=0;$v_3<$v_2.length;$v_3++)this.SetParameter($v_2[$v_3].attributes.getNamedItem("id").nodeValue,XUI.Xml.GetText($v_2[$v_3]));$v_2=XUI.Xml.SelectNodes($v_0,"gridXml/gridProperties/div",null);if($v_2)for(var $v_4=0;$v_4<$v_2.length;$v_4++)this.SetProperty($v_2[$v_4].attributes.getNamedItem("id").nodeValue,XUI.Xml.GetText($v_2[$v_4]));this.$7G_3();this.$3Y_3(null,null);this.InitPresence();eval(this.GetProperty("initStatements"));if(!IsNull(Mscrm.IFilterSet)){var $v_5=$find(this.get_id()+"_filterSet");if(!IsNull($v_5)){$v_5.handleGridReset();for(var $v_6=this.$6c_3(),$v_7=$v_6[0].length,$v_8=0;$v_8<$v_7;$v_8++){var $v_9=$v_6[1][$v_8],$v_A=$v_6[0][$v_8];if($v_9==="string")$create(Mscrm.StringFilterPopup,{},null,null,$v_A);else if($v_9==="number")$create(Mscrm.NumberFilterPopup,{},null,null,$v_A);else if($v_9==="datetime")$create(Mscrm.DateTimeFilterPopup,{},null,null,$v_A);else if($v_9==="picklist")$create(Mscrm.PicklistFilterPopup,{},null,null,$v_A);else $v_9==="lookup"&&$create(Mscrm.LookupFilterPopup,{},null,null,$v_A);$v_5.registerFilterPopup($v_6[0][$v_8].id,$v_9,"reset")}if($v_5.isFilterEnabled())if($v_5.canEnableFilters())$v_5.enableFilters();else $v_5.markFiltersAsDisabled()}}}!IsNull(this.$21_3)&&this.$21_3(resultCommand,resultCommand.get_remoteCommandXml());this.fireControlEvent("OnResetComplete",Sys.EventArgs.Empty);if(!IsNull(Mscrm.PageManager)&&!IsNull(Mscrm.PageManager.get_instance())&&Mscrm.PageManager.isFlatUIPage()){var $v_B={};$v_B["viewid"]=this.GetParameter("viewid");$v_B["viewtype"]=this.GetParameter("viewtype");this.raiseEvent(Mscrm.ScriptEvents.OnGridResetComplete,$v_B)}this.finishShowLoadingMessage();return resultCommand.get_success()},$6c_3:function(){var $v_0=[[],[]],$v_1=$get(this.get_id()+"_gridBar");if(!IsNull($v_1))for(var $v_2="LI",$v_3="ms-crm-FilterPopupMenu",$v_4=$v_1.getElementsByTagName($v_2),$v_5=0,$v_6=$v_4.length;$v_5<$v_6;$v_5++)if($v_4[$v_5].className===$v_3)if(!IsNull($v_4[$v_5].getAttribute("filtermenutype"))){$v_0[0].push($v_4[$v_5]);$v_0[1].push($v_4[$v_5].getAttribute("filtermenutype"))}return $v_0},Print:function(){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/ribbonactions.js"),true);Mscrm.GridRibbonActions.print(this)},ExportToExcel:function(){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/ribbonactions.js"),true);Mscrm.GridRibbonActions.exportToExcel(this,this.get_entityTypeCode())},RunReport:function(instance,name,reportType,helpId){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/ribbonactions.js"),true);Mscrm.GridRibbonActions.runReportFromAppGrid(this,this.get_selectedIds(),instance,name,reportType,helpId)},$3Y_3:function($p0,$p1){this.remove_onRefresh(this.$$d_$3Y_3);this.add_onRefresh(this.$$d_$3Y_3);var $v_0=$get(this.get_id()+"_divDataArea");if($v_0.getAttribute("Expandable")==="1"&&this.get_element().parentNode.className!=="ms-crm-Category-List"){this.remove_onRefresh(this.$$d_$6l_3);this.add_onRefresh(this.$$d_$6l_3);this.$35_3&&$removeHandler(window,"resize",this.$$d_handleAutoExpandRows);$addHandler(window,"resize",this.$$d_handleAutoExpandRows);if(Mscrm.GridControl.isBrowserIE8OrLower()&&this.isLiteSubGrid()){this.$35_3&&$removeHandler(document.body,"resize",this.$$d_handleAutoExpandRows);$addHandler(document.body,"resize",this.$$d_handleAutoExpandRows)}this.$35_3=true;this.isLiteSubGrid()&&this.$2S_3();if(IsNull(this.$J_3))this.$J_3=this.isAutoSubGrid();this.$J_3&&!this.isLiteSubGrid()&&this.$2S_3();this.handleAutoExpandRows(null)}if(Mscrm.Utilities.isIosDevice())if(!IsNull($v_0)){$v_0.style.overflow="hidden";var $$t_3=this;window.setTimeout(function(){$v_0.style.overflow="auto"},0)}},SetDivGridParameter:function(parametersDiv,name,value){if(!IsNull(parametersDiv)&&!IsNull(name)&&!IsNull(value)){var $v_0=$get(name,parametersDiv);!IsNull($v_0)&&$v_0.setAttribute("value",value)}},$F_3:null,$h_3:0,$2q_3:null,$H_3:null,$1A_3:0,$U_3:null,$22_3:0,$1c_3:0,$28_3:false,$41_3:false,$44_3:0,$1y_3:0,$3v_3:0,$1x_3:0,$3x_3:0,$3w_3:0,get_AutoSubGrid:function(){return this.$J_3},set_AutoSubGrid:function(value){this.$J_3=value;return value},GetGridSpan:function(){var $v_0=this.get_id()+"_span",$v_1=this.get_element().parentNode;while(!IsNull($v_1)&&$v_1.id!==$v_0)$v_1=$v_1.parentNode;return $v_1},$3Q_3:function($p0,$p1){var $v_0=null,$v_1=$p1;if(IsNull($v_1)){if(IsNull(this.$U_3))this.$U_3=this.GetGridSpan();$v_1=this.$U_3}if(!IsNull($v_1)){$v_0=$v_1.parentNode;while(!IsNull($v_0)&&$v_0.tagName!==$p0)$v_0=$v_0.parentNode}return $v_0},getGridTDElement:function(){return this.$3Q_3("TD",null)},$6Z_3:function(){return this.$3Q_3("TR",null)},getGridColumnPosition:function(){var $v_0=0;if(this.$F_3){var $v_1=XUI.Html.DomUtils.GetPrevSibling(this.$F_3);while($v_1){$v_0+=$v_1.colSpan;$v_1=XUI.Html.DomUtils.GetPrevSibling($v_1)}}return $v_0},getGridRowPosition:function(){var $v_0=0;if(this.$2q_3){var $v_1=this.$2q_3;while(XUI.Html.DomUtils.GetPrevSibling($v_1)){$v_0++;$v_1=XUI.Html.DomUtils.GetPrevSibling($v_1)}}return $v_0},getGridParentTable:function(){return this.$3Q_3("TABLE",null)},findFirstEmptyCellColInTableRow:function(rowNumber){for(var $v_0=0;$v_0<8;$v_0++)if(this.$E_3[rowNumber][$v_0]==="-1")return $v_0;return 0},$6Y_3:function(){if(this.$E_3.length)return;this.$H_3=this.getGridParentTable();if(this.$H_3){if(!this.$H_3.rows[0].offsetHeight)return;var $v_0;this.$1A_3=this.$H_3.rows.length;for(var $v_1=0;$v_1<this.$1A_3;$v_1++){this.$1K_3[$v_1]=[null,null,null,null,null,null,null,null];this.$E_3[$v_1]=["-1","-1","-1","-1","-1","-1","-1","-1"]}for(var $v_2=0;$v_2<this.$1A_3;$v_2++){$v_0=this.$H_3.rows[$v_2];for(var $v_3=$v_0.offsetHeight,$v_4,$v_5=this.findFirstEmptyCellColInTableRow($v_2),$v_6,$v_7,$v_8,$v_9=0;$v_9<$v_0.cells.length;$v_9++){$v_6=$v_0.cells[$v_9];$v_7=this.isHiddenCell($v_6);while(this.$E_3[$v_2][$v_5]!=="-1"){$v_5++;if($v_5>=8){$v_5=8;break}}$v_4=$v_6.colSpan;var $v_A=$v_6.getAttribute("topTDid")===this.get_id()+"_TopTD";if($v_A)$v_8=this.$44_3;else $v_8=$v_6.rowSpan;for(var $v_B=0;$v_B<$v_8;$v_B++)for(var $v_C=0;$v_C<$v_4;$v_C++){var $v_D;if($v_7){if(!$v_B&&!$v_C)$v_D="hc";else $v_D="hm";this.$1K_3[$v_2+$v_B][$v_5+$v_C]=$v_6}else if($v_A){$v_D=this.get_id();this.$1y_3=$v_2;this.$3v_3=$v_9;this.$3x_3=$v_8;this.$3w_3=$v_4;this.$1x_3=$v_5}else if(!$v_B&&!$v_C)$v_D="c";else $v_D="m";var $v_E=$v_2+$v_B,$v_F=$v_5+$v_C;if(!IsNull(this.$E_3[$v_E]))this.$E_3[$v_E][$v_F]=$v_D}$v_5=$v_5+$v_4}this.$1I_3[$v_2]=$v_3}this.insertHiddenCell(this.$H_3,this.$1y_3,this.$3v_3,this.$3x_3,this.$3w_3,this.$1x_3)}},isHiddenCell:function(cell){var $v_0=true;if(!IsNull(cell.children)){var $$t_4=this;XUI.Html.DomUtils.ForEachChild(cell,function($p1_0){var $v_1=!IsNull($p1_0)&&!IsNull($p1_0.style)&&$p1_0.style.display==="none";if(!$v_1){$v_0=false;return true}return false})}return !IsNull(cell.style)&&cell.style.display==="none"||$v_0},getInitialRowSpan:function(){var $v_0=0,$v_1=$get(this.get_id()+"_divDataArea");if(!IsNull($v_1)){var $v_2=parseInt($v_1.getAttribute("MaxRowsBeforeScroll"),10);if(!IsNull($v_2))$v_0=$v_2}return $v_0},insertHiddenCell:function(gridParentTable,currentGridRowPosition,currentGridColPosition,currentGridRowSpan,currentGridColSpan,currentGridColPositionInControlMatrix){if(this.$41_3||IsNull(gridParentTable)||IsNull(currentGridRowPosition))return;for(var $v_0=1;$v_0<currentGridRowSpan;$v_0++){for(var $v_1=gridParentTable.rows[currentGridRowPosition+$v_0],$v_2=0,$v_3=0;$v_3<currentGridColPositionInControlMatrix;$v_3++)if(this.$E_3[currentGridRowPosition+$v_0][$v_3]==="c"||this.$E_3[currentGridRowPosition+$v_0][$v_3]==="hc")$v_2++;if(this.GetParameter("LayoutStyle")!=="PrintList")if(!IsNull($v_1)){var $v_4=$v_1.insertCell($v_2);$v_4.colSpan=this.$22_3;$v_4.innerHTML='<DIV style="display:none" />';$v_4.insertBy=this.get_id();$v_4.style.display="none";this.$1K_3[currentGridRowPosition+$v_0][currentGridColPositionInControlMatrix]=$v_4}}this.$41_3=true},isLastControlOfColumn:function(){if(this.$E_3.length>0){this.$h_3=this.$1y_3;this.$22_3=this.$F_3.colSpan;for(var $v_0=this.$1y_3+1;$v_0<this.$E_3.length;$v_0++)for(var $v_1=this.$1x_3;$v_1<this.$1x_3+this.$22_3;$v_1++)if(!IsNull(this.$E_3[$v_0][$v_1])&&(this.$E_3[$v_0][$v_1]==="c"||this.$E_3[$v_0][$v_1]==="mc"))return false}return true},$2S_3:function(){if(this.get_element().parentNode.className==="ms-crm-Category-List")return;this.$U_3=this.GetGridSpan();this.$F_3=this.getGridTDElement();this.$2q_3=this.$6Z_3();this.$1c_3=this.getGridColumnPosition();this.$h_3=this.getGridRowPosition();this.$H_3=this.getGridParentTable();if(!IsNull(this.$H_3)){this.$1A_3=this.$H_3.rows.length;this.$44_3=this.$F_3.rowSpan;this.$22_3=this.$F_3.colSpan;this.$F_3.setAttribute("topTDid",this.get_id()+"_TopTD");this.$6Y_3();this.$28_3=this.isLastControlOfColumn()}},$14_3:0,$6h_3:function(){var $v_0=this.get_element().parentNode;while(!IsNull($v_0)&&$v_0.className!=="ms-crm-Form-SubGrid-Layout"&&$v_0.className!=="ms-crm-Form-SubGrid-Layout-Lite"){if($v_0.className==="ms-crm-Form")return this.get_element().offsetHeight;$v_0=$v_0.parentNode}var $v_1=0;if(IsNull($v_0))$v_1=this.get_element().offsetHeight-Mscrm.Utilities.getVerticalBoxPadding(this.get_element());else{var $v_2=$v_0.parentNode;$v_1=$v_2.offsetHeight-Mscrm.Utilities.getVerticalBoxPadding($v_2)}return $v_1},isAutoSubGrid:function(){var $v_0=this.GetParameter("subgridAutoExpand")==="1";return $v_0},isProductGrid:function(){var $v_0=this.get_element().id;return $v_0.indexOf("quotedetail")>-1||$v_0.indexOf("salesorderdetail")>-1||$v_0.indexOf("invoicedetail")>-1||$v_0.indexOf("opportunityproduct")>-1},isMovableRowsGrid:function(){var $v_0=this.get_element().id;return $v_0.indexOf("SLADetails")>-1||$v_0.indexOf("RuleItems")>-1||$v_0.indexOf("ConvertRuleItemsGrid")>-1},isEntitlementChannelGrid:function(){var $v_0=this.get_element().id;return $v_0.indexOf("grid_EntitlementChannel")>-1},isOpportunityProductGrid:function(){var $v_0=this.get_element().id;return $v_0.indexOf("opportunityproduct")>-1},$6l_3:function($p0,$p1){this.handleAutoExpandRows(null)},$48_3:function(){var $v_0=this.get_element().offsetHeight,$v_1=$get(this.get_id()+"_divDataBody").offsetHeight,$v_2=$v_0-$v_1,$v_3=$get(this.get_id()+"_visualizationCompositeControl"),$v_4=!IsNull($v_3)&&$v_3.offsetHeight>0?this.$6h_3()-$v_3.offsetHeight:0,$v_5=$get("appGridQueryFilterContainer_"+this.get_id()),$v_6=!IsNull($v_5)?$v_5.offsetHeight:0;return $v_4+$v_2+$v_6},handleAutoExpandRows:function(domEvent){if(this.get_isDisposed())return;if(this.get_element().parentNode.className==="ms-crm-Category-List"||this.get_element().offsetHeight<=0)return;var $v_0=$get(this.get_id()+"_divDataArea");if($v_0.getAttribute("Expandable")!=="1")return;if(IsNull(this.$J_3))this.$J_3=this.isAutoSubGrid();if(IsNull(this.$i_3))this.$i_3=this.isProductGrid()||this.isMovableRowsGrid()||this.isEntitlementChannelGrid();if(!this.$14_3)if(this.$J_3){if(IsNull(this.$F_3))this.$F_3=this.getGridTDElement();if(!IsNull(this.$F_3)){var $v_4=this.$F_3.rowSpan;this.$F_3.rowSpan=1;this.$14_3=this.$48_3();this.$F_3.rowSpan=$v_4}}else this.$14_3=this.$48_3();this.$J_3&&this.$2S_3();var $v_1=parseInt($v_0.getAttribute("MaxRowsBeforeScroll"),10),$v_2=this.GetParameter("RecordsPerPage"),$v_3=0;if(!IsNull($v_2)){$v_3=parseInt($v_2,10);if(!this.$i_3&&($v_3<$v_1||this.isLiteSubGrid()))$v_1=$v_3}if(!isNaN($v_1)&&$v_1>0){var $v_5=0,$v_6=21;if(!IsNull(this.$0_3)){$v_5=this.$0_3.get_numberOfRecords();$v_6=this.$0_3.$3y_3;var $v_C=this.$0_3.get_dataTableBody();if($v_5>0&&!IsNull($v_C)&&$v_C.rows.length>0&&!IsNull(XUI.Html.GetComputedStyle($v_C.rows[0],"height"))){var $v_D;if(window.location.href.toLowerCase().indexOf("/dashboards/dashboard.aspx")!==-1&&Mscrm.Utilities.get_ieBrowserVersion()>9&&$v_C.rows.length>1)$v_D=$v_C.rows[1].offsetHeight;else if(Mscrm.Utilities.isEdge())$v_D=$v_C.rows[0].offsetHeight-1;else if(Mscrm.Utilities.get_ieBrowserVersion()>9)$v_D=$v_C.rows[0].offsetHeight-1;else $v_D=$v_C.rows[0].offsetHeight;if($v_D>0){$v_6=$v_D;if(this.$i_3&&$v_5>$v_1)$v_6=$v_6-4}}}var $v_7=$find("crmForm"),$v_8=$get("mainContainer"),$v_9;if(IsNull($v_7))if(IsNull($v_8))return;else $v_9=$v_8.offsetHeight;else $v_9=$v_7.GetViewportHeight();var $v_A=$v_1,$v_B=45;$v_A=Math.floor(($v_9-$v_B-this.$14_3)/$v_6);if($v_A<0)$v_A=2;if(!$v_5||$v_5===1)$v_5=2;this.$6z_3($v_1,$v_3,$v_A,$v_6,$v_5,$v_0)}},setSubGridHeight:function(forceResetHeight){this.$i_3=this.isProductGrid()||this.isMovableRowsGrid()||this.isEntitlementChannelGrid();if(this.$i_3){var $v_0=$find("crmForm"),$v_1=$get("mainContainer");if(forceResetHeight||!IsNull($v_0)&&!IsNull($v_1)&&$v_0.get_isNew()){this.isLiteSubGrid()&&this.$2S_3();this.handleAutoExpandRows(null)}}},$5D_3:function(){return this.$J_3&&this.$28_3},$6z_3:function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0;if(this.$J_3){if(!this.$i_3){$p0=$p1;$p5.style.overflowY="auto"}else{$p5.style.overflowX="auto";if($p4<=$p0){if($p5.className.indexOf("ms-crm-Grid-DataArea-VerticalScroll")!==-1)$p5.className=$p5.className.replace("ms-crm-Grid-DataArea-VerticalScroll","");if($p5.className.indexOf("ms-crm-Grid-DataArea-NoVerticalScroll")===-1)$p5.className+=" ms-crm-Grid-DataArea-NoVerticalScroll"}else{if($p5.className.indexOf("ms-crm-Grid-DataArea-NoVerticalScroll")!==-1)$p5.className=$p5.className.replace("ms-crm-Grid-DataArea-NoVerticalScroll","");if($p5.className.indexOf("ms-crm-Grid-DataArea-VerticalScroll")===-1)$p5.className+=" ms-crm-Grid-DataArea-VerticalScroll"}}var $v_3=this.$5D_3()?$p2<$p0?$p2:$p0:2;$v_0=$p3*($p4<$v_3?$p4:$v_3)}else{$p5.style.overflowY="auto";$v_0=$p3*$p0+1}if(this.isLiteSubGrid()&&!this.$i_3){$p5.style.overflowY="hidden";$p5.style.overflowX="auto"}$v_0+=3;if($p5.scrollWidth>=$p5.clientWidth||window.location.href.toLowerCase().indexOf("/dashboards/dashboard.aspx")!==-1)$v_0=$v_0+17;if($v_0<=0)return;if(this.$J_3){$p5.style.height=$v_0.toString()+"px";if(this.$5D_3()){this.$U_3=this.GetGridSpan();!IsNull(this.$U_3)&&this.$8i_3($v_0+this.$14_3)}}$p5.style.height=$v_0.toString()+"px";var $v_1=this.GetParameter("isGridHidden"),$v_2=this.GetParameter("GridType");if($v_2==="SubGrid"&&$v_1!=="true"){if(IsNull(this.$U_3))this.$U_3=this.GetGridSpan();if(!IsNull(this.$U_3)){var $v_4=0,$v_5=0,$v_6=0,$v_7=0;if(!Mscrm.Utilities.isIE7OrIE7CompactMode()){var $v_8=XUI.Html.DomUtils.GetFirstChild(this.$U_3);if(XUI.Html.GetComputedStyle($v_8,"position")==="absolute"){$v_4=Mscrm.Utilities.parseInt(XUI.Html.GetComputedStyle($v_8,"top"),0);$v_5=Mscrm.Utilities.parseInt(XUI.Html.GetComputedStyle($v_8,"bottom"),0)}$v_6=Mscrm.Utilities.parseInt(XUI.Html.GetComputedStyle($v_8,"borderTopWidth"),0);$v_7=Mscrm.Utilities.parseInt(XUI.Html.GetComputedStyle($v_8,"borderBottomWidth"),0)}if(this.$J_3||this.isLiteSubGrid())this.$U_3.parentNode.style.height=($v_4+$v_5+$v_6+$v_7+$v_0+this.$14_3).toString()+"px";else this.$U_3.style.height=($v_4+$v_5+$v_0+this.$14_3).toString()+"px"}}},$8i_3:function($p0){var $v_0=0,$v_1=false;if(!this.$E_3.length||!this.$H_3)return;for(var $v_5=0;$v_5<this.$H_3.rows.length;$v_5++)this.$1I_3[$v_5]=this.$H_3.rows[$v_5].offsetHeight;this.$1I_3[this.$h_3]=1;var $v_2=this.$1I_3[this.$h_3],$v_3=this.$E_3.length,$v_4=8;while($p0>$v_2+$v_4)if(this.$h_3+$v_0<$v_3-1){$v_2=$v_2+this.$1I_3[this.$h_3+$v_0];$v_0=$v_0+1}else{$v_1=true;$v_0=$v_0+1;break}$p0-$v_2>0&&$v_1&&this.setLastRowHeight($p0-$v_2);!$v_1&&this.setLastRowToAuto();this.setCellsHidden(this.$h_3+1,this.$h_3+$v_0-1,this.$1c_3,this.$1c_3+this.$F_3.colSpan-1,true);this.setCellsHidden(this.$h_3+$v_0,this.$1A_3-1,this.$1c_3,this.$1c_3+this.$F_3.colSpan-1,false);this.$F_3.rowSpan=$v_0},setCellsHidden:function(startRow,endRow,startCol,endCol,hidden){this.$H_3=this.getGridParentTable();for(var $v_0=startRow;$v_0<=endRow;$v_0++)for(var $v_1=startCol;$v_1<=endCol;$v_1++)if(!IsNull(this.$1K_3[$v_0][$v_1]))this.$1K_3[$v_0][$v_1].style.display=hidden?"none":""},setLastRowHeight:function(height){if(height>0)this.$H_3.rows[this.$1A_3-1].style.height=height.toString()},setLastRowToAuto:function(){this.$H_3.rows[this.$1A_3-1].style.height="100%"},$8B_3:function($p0,$p1){this.fireControlEvent("OnSelectionChange",$p1)},$4v_3:function($p0,$p1){this.fireControlEvent("OnBeforeFormLoad",$p1)},$5g_3:function(){var $v_0="<grid>",$$t_6=this;XUI.Html.DomUtils.ForEachChild(this.$2R_3(),function($p1_0){if(isNullOrEmptyString($p1_0.getAttribute("value")))$v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+"/>";else $v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">"+CrmEncodeDecode.CrmXmlEncode($p1_0.getAttribute("value"))+"</"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">";return false});$v_0+="<parameters>";var $v_1=this.$2Q_3(),$v_2=$get("viewid",$v_1),$v_3=!!$v_2&&$v_2.getAttribute("value")!=="{00000000-0000-0000-0000-000000000000}",$$t_7=this;XUI.Html.DomUtils.ForEachChild($v_1,function($p1_0){if((IsNull($p1_0.getAttribute("requiredMask"))||!IsNull($p1_0.getAttribute("requiredMask"))&&$p1_0.getAttribute("requiredMask")!==1)&&(!$v_3||$p1_0.id!=="layoutXml"))if(isNullOrEmptyString($p1_0.getAttribute("value")))$v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+"/>";else $v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">"+CrmEncodeDecode.CrmXmlEncode($p1_0.getAttribute("value"))+"</"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">";return false});return $v_0+"</parameters></grid>"},$2D_3:0,$25_3:0,$2K_3:null,$2J_3:null,add_onRefresh:function(value){this.get_events().addHandler("OnRefresh",value)},remove_onRefresh:function(value){this.get_events().removeHandler("OnRefresh",value)},add_onChangePage:function(value){this.get_events().addHandler("OnChangePage",value)},remove_onChangePage:function(value){this.get_events().removeHandler("OnChangePage",value)},add_onBeforeRefresh:function(value){this.get_events().addHandler("OnBeforeRefresh",value)},remove_onBeforeRefresh:function(value){this.get_events().removeHandler("OnBeforeRefresh",value)},get_refreshAsynchronous:function(){if(IsNull(this.$1O_3))this.$1O_3=this.GetProperty("refreshAsync")==="True";return this.$1O_3},set_refreshAsynchronous:function(value){this.$1O_3=value;return value},get_remoteCommandResult:function(){return this.$2K_3},set_remoteCommandResult:function(value){this.$2K_3=value;return value},get_remoteCommand:function(){return this.$2J_3},set_remoteCommand:function(value){this.$2J_3=value;return value},$15_3:null,$1G_3:null,$1N_3:true,$37_3:true,$2j_3:true,$1M_3:"<TABLE class='ms-crm-List-Message' morerecords='0'><TR><TD ID='GridMessage'>{0}</TD></TR></TABLE>",$2B_3:"<TABLE class='ms-crm-List-Message' morerecords='0'><TR><TD ID='GridLoadingMessage'><IMG alt='' src='/_imgs/AdvFind/progress.gif'><br>{0}</TD></TR></TABLE>",$2x_3:null,$1P_3:false,$1Z_3:null,$1i_3:0,$2v_3:0,$24_3:null,$36_3:true,$23_3:true,$1d_3:false,$1f_3:null,$X_3:null,$0_3:null,$1H_3:0,$3A_3:0,$3B_3:0,get_innerGrid:function(){return this.$0_3},set_innerGrid:function(value){this.$0_3=value;return value},get_pageNumber:function(){return this.getPageNumber()},set_pageNumber:function(value){this.$3i_3(value);return value},get_maximumSelectableRecords:function(){return this.$6b_3()},get_version:function(){return "3.0"},get_autoHideHScroll:function(){return this.$2j_3},set_autoHideHScroll:function(value){this.$2j_3=value;var $v_0=$get(this.get_id()+"_divDataArea");if(!this.$2j_3)$v_0.style.overflowX="scroll";else $v_0.style.overflowX="auto";return value},get_hasFocus:function(){return this.$1d_3},set_hasFocus:function(value){this.$1d_3=value;return value},get_gridXml:function(){return this.buildGridXml(false)},get_layoutXml:function(){return this.$47_3()},get_gridRefreshTime:function(){return this.$2x_3},get_gridRefreshSourceElement:function(){return this.$24_3},set_gridRefreshSourceElement:function(value){this.$24_3=value;return value},get_isRefreshing:function(){return this.$1P_3},get_defaultTabIndex:function(){return this.$1H_3},get_loadingMessageHtml:function(){return this.$2B_3},set_loadingMessageHtml:function(value){this.$2B_3=value;return value},get_messageHtml:function(){return this.$1M_3},set_messageHtml:function(value){this.$1M_3=value;return value},$7G_3:function(){this.ResetPageNumber();this.$4g_3()},$8H_3:function($p0){$p0.preventDefault();this.GetParameter("LoadOnDemand")==="1"&&this.SetParameter("LoadOnDemand","0");this.Refresh()},$8J_3:function($p0){var $v_0=$get(this.get_id()+"_gridBodyContainer");if(!IsNull($v_0)){var $v_1=$get("refreshButton",$v_0);if(!IsNull($v_1)){var $v_2=XUI.Html.DomUtils.GetFirstChild($v_1);if(!IsNull($v_2)){var $v_3=XUI.Html.DomUtils.GetFirstChild($v_2);if(!IsNull($v_3))$v_3.className="ms-crm-ImageStrip-grid_refresh_hover"}}}},$8I_3:function($p0){var $v_0=$get(this.get_id()+"_gridBodyContainer");if(!IsNull($v_0)){var $v_1=$get("refreshButton",$v_0);if(!IsNull($v_1)){var $v_2=XUI.Html.DomUtils.GetFirstChild($v_1);if(!IsNull($v_2)){var $v_3=XUI.Html.DomUtils.GetFirstChild($v_2);if(!IsNull($v_3))$v_3.className="ms-crm-ImageStrip-grid_refresh"}}}},$69_3:function($p0){doAction(this.get_id(),this.get_entityTypeCode(),"enabledisablefilters","")},$6B_3:function($p0){var $v_0=$get("filterButton",this.get_element()),$v_1=$get("filterButtonImage",this.get_element());if(!IsNull($v_1)&&!IsNull($v_0))if(Mscrm.InternalUtilities.Utilities.isHighContrastEnabled()){if($v_0.className!=="ms-crm-List-FilterButton-Selected")$v_1.src="/_imgs/grid/grid_filter_hover.png"}else if($v_0.className!=="ms-crm-List-FilterButton-Selected")$v_1.className="ms-crm-ImageStrip-grid_filter_hover"},$6A_3:function($p0){var $v_0=$get("filterButton",this.get_element()),$v_1=$get("filterButtonImage",this.get_element());if(!IsNull($v_1))if(Mscrm.InternalUtilities.Utilities.isHighContrastEnabled()){if($v_0.className!=="ms-crm-List-FilterButton-Selected")$v_1.src="/_imgs/grid/grid_filter.png"}else if($v_0.className!=="ms-crm-List-FilterButton-Selected")$v_1.className="ms-crm-ImageStrip-grid_filter"},RefreshGridAndClearPaging:function(){this.ClearPagingCookie();this.ResetPageNumber();this.Refresh()},Refresh:function(){this.$4w_3(false)},$4w_3:function($p0){var $v_0=this.GetParameter("oId");if(isNullOrEmptyString($v_0)&&(this.get_ribbonRelationshipType()===Mscrm.RibbonRuleRelationshipType.oneToMany||this.get_ribbonRelationshipType()===Mscrm.RibbonRuleRelationshipType.manyToMany)){var $v_2=$get(this.get_id()+"_divDataArea");if(!IsNull($v_2)){var $v_3=window.LOCID_EMPTY_GRID_MESSAGE_REFRESH;$v_2.innerHTML=String.format('<div class="ms-crm-grid-Title-Data-Lite">{0}</div><div style="height: 16px;"></div>',CrmEncodeDecode.CrmHtmlEncode($v_3));return}}if(!this.$1Z_3)this.$1Z_3=new Mscrm.RemoteCommandXml("AppGridWebService","Refresh");this.$4A_3();var $$t_5=this,$v_1=function(){$$t_5.$1Z_3.setContent($$t_5.buildGridXml($p0))};this.executeInternal($p0,this.$1Z_3,$v_1)},executeInternal:function(calledFromPaging,command,setCommandContextCallback){if(this.$z_3){this.$z_3.properties={};this.$z_3.properties["id"]=this.get_id();this.$z_3.start()}Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("SubGrid - "+this.get_id()+" - Start",1);Mscrm.Utilities.addControlMarker(this.get_id(),"Subgrid","StartLoadTimestamp",(new Date).getTime().toString());if(IsNull(calledFromPaging))calledFromPaging=false;this.$1P_3=true;var $v_0=new Mscrm.BeforeRefreshEventArgs;this.fireControlEvent("OnBeforeRefresh",$v_0);if($v_0.breakEvent){this.$1P_3=false;return}this.$1N_3&&this.DisablePaging();window.UseTabletExperience&&this.set_refreshAsynchronous(true);this.$4D_3();if(this.get_refreshAsynchronous()){setCommandContextCallback&&setCommandContextCallback();command.execute(this.$$d_onRefreshComplete);this.ShowLoadingMessage()}else{this.ShowLoadingMessage();var $$t_4=this;window.setTimeout(function(){setCommandContextCallback&&setCommandContextCallback();$$t_4.$8G_3(command)},1)}},DisassociateAndRefresh:function(associationName,parentTypeCode,parentId,targetTypeCode){return},DeleteConnectionAndRefresh:function(){return},CancelRefresh:function(){this.$1Z_3.abort();this.finishShowLoadingMessage();this.setGridData(String.format(this.$1M_3,window.LOCID_REFRESH_GRID_CANCELLED),true);this.$1P_3=false},ShowLoadingMessage:function(){var $v_0=this.getLoadingMessage();if(IsNull($v_0))$v_0=window["LOCID_LOADING_"+this.get_id().toUpperCase()];if(IsNull(this.$1f_3)){var $v_1=$get(this.get_id()+"_divDataArea");this.$1f_3=$v_1.style.overflowY;$v_1.style.overflowY=this.getDataAreaStyle()}$get(this.get_id()+"_divDataArea").innerHTML=String.format(this.$2B_3,CrmEncodeDecode.CrmHtmlEncode($v_0))},getLoadingMessage:function(){return window.LOCID_LOADING_GRID_DATA},getDataAreaStyle:function(){return "hidden"},buildGridXml:function(calledFromPaging){if(IsNull(calledFromPaging))calledFromPaging=false;var $v_0="<grid>",$$t_8=this;XUI.Html.DomUtils.ForEachChild(this.$2R_3(),function($p1_0){var $v_3=$p1_0.getAttribute("value");if(isNullOrEmptyString($v_3))$v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+"/>";else $v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">"+CrmEncodeDecode.CrmXmlEncode($v_3)+"</"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">";return false});if(IsNull(calledFromPaging)||!calledFromPaging)$v_0+="<refreshCalledFromRefreshButton>1</refreshCalledFromRefreshButton>";if(!IsNull(this.$0_3)){$v_0+="<totalrecordcount>"+CrmEncodeDecode.CrmXmlEncode(this.$0_3.get_totalRecordCount().toString())+"</totalrecordcount>";$v_0+="<allrecordscounted>"+(this.$0_3.get_allRecordsCounted()?"true":"false")+"</allrecordscounted>"}$v_0+="<returntotalrecordcount>"+(this.$36_3?"true":"false")+"</returntotalrecordcount>";$v_0+="<getParameters>";var $v_1=this.GetParameter("GridType"),$v_2=this.GetParameter("fetchXmlForFilters");if(!IsNull($v_1)&&$v_1==="SubGrid"&&IsNull($v_2))$v_0+="getFetchXmlForFilters";$v_0+="</getParameters>";$v_0+="<parameters>";var $$t_9=this;XUI.Html.DomUtils.ForEachChild(this.$2Q_3(),function($p1_0){if(IsNull($p1_0.getAttribute("requiredMask"))||!IsNull($p1_0.getAttribute("requiredMask"))&&$p1_0.getAttribute("requiredMask")!==1){var $v_4=$p1_0.getAttribute("value");if($v_4&&!$v_4.length)$v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+"/>";else $v_0+="<"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">"+CrmEncodeDecode.CrmXmlEncode($v_4)+"</"+CrmEncodeDecode.CrmXmlEncode($p1_0.id)+">"}return false});$v_0+="</parameters>";$v_0+=this.$47_3();$v_0+="</grid>";return $v_0},$47_3:function(){var $v_0="",$v_1=0,$v_2=this.get_id()+"_gridBar",$v_3=this.get_id()+"_gridBarCols";$v_0+="<columns>";var $v_4=$get($v_2),$v_5=$get($v_3);if($v_4){var $v_6=$v_4.rows[0].cells,$v_7=$v_6.length;for($v_1=0;$v_1<$v_7;$v_1++){var $v_8=$v_6[$v_1];if($v_8.getAttribute("field")){$v_0+="<column width=";if($v_8.getAttribute("isHidden"))$v_0+='"0" isHidden="true"';else{var $v_9=$v_8.scrollWidth;if(!$v_9){var $v_A=XUI.Html.DomUtils.GetChildElementAt($v_5,$v_1).getAttribute("width");if(!isNullOrEmptyString($v_A))$v_9=parseInt($v_A,10)}$v_0+='"'+$v_9+'" isHidden="false"'}if($v_8.getAttribute("metadataDisabled"))$v_0+=' isMetadataBound="false"';else $v_0+=' isMetadataBound="true"';if($v_8.className==="ms-crm-List-Sortable")$v_0+=' isSortable="true"';else $v_0+=' isSortable="false"';$v_0+=' label="'+CrmEncodeDecode.CrmXmlAttributeEncode($v_8.getAttribute("displayLabel"))+'"';$v_0+=' fieldname="'+CrmEncodeDecode.CrmXmlAttributeEncode($v_8.getAttribute("fieldname"))+'"';$v_0+=' entityname="'+CrmEncodeDecode.CrmXmlAttributeEncode($v_8.getAttribute("entityname"))+'"';if($v_8.getAttribute("renderertype"))$v_0+=' renderertype="'+CrmEncodeDecode.CrmXmlAttributeEncode($v_8.getAttribute("renderertype"))+'"';if($v_8.getAttribute("relationshipname"))$v_0+=' relationshipname="'+CrmEncodeDecode.CrmXmlAttributeEncode($v_8.getAttribute("relationshipname"))+'"';$v_0+=">"+CrmEncodeDecode.CrmXmlEncode($v_8.getAttribute("field"))+"</column>"}}}$v_0+="</columns>";return $v_0},$8G_3:function($p0){var $v_0=$p0.execute();this.onRefreshComplete($v_0,null)},onRefreshComplete:function(result,command){this.finishShowLoadingMessage();var $$t_2=this;window.setTimeout(function(){$$t_2.refreshComplete(result,command)},1)},get_$5N_3:function(){var $v_0=Mscrm.GridControl.get_$4S()[this.get_id()];if(isNullOrEmptyString($v_0))$v_0=this.GetParameter("viewts");return $v_0},set_$5N_3:function($p0){Mscrm.GridControl.get_$4S()[this.get_id()]=$p0;return $p0},refreshComplete:function(result,command){if(result.get_success()&&!isNullOrEmptyString(result.get_returnValue())){var $v_0=XUI.Xml.LoadXml(result.get_returnValue());this.SetProperty("pagingCookie",XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_0,"gridXml/pagingCookie",null)));this.setGridData(XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_0,"gridXml/gridHtml",null)),true);var $v_1=new Array(3);$v_1[0]="effectiveFetchXml";$v_1[1]="isFetchXmlNotFinal";$v_1[2]="fetchXmlForFilters";$v_1[3]="viewts";for(var $v_2=this.get_$5N_3(),$v_3="",$v_5=0;$v_5<$v_1.length;$v_5++){var $v_6=XUI.Xml.SelectSingleNode($v_0,String.format("gridXml/gridParams/div[@id='{0}']",$v_1[$v_5]),null);if($v_6){this.SetParameter(XUI.Xml.GetText($v_6.attributes.getNamedItem("id")),XUI.Xml.GetText($v_6));if(XUI.Xml.GetText($v_6.attributes.getNamedItem("id"))==="viewts")$v_3=XUI.Xml.GetText($v_6)}}this.isSubGridStale($v_2,$v_3)&&this.set_$5N_3($v_3);var $v_4=this.cacheValidation($v_2,$v_3);if(!$v_4)return false}else this.displayFailedMessage();this.fireGridEvents(command);this.$2W_3(null);this.$2x_3=new Date;this.$1P_3=false;if(this.$z_3){this.$z_3.stop();this.$z_3=null}Mscrm.Utilities.addControlMarker(this.get_id(),"Subgrid","FinishLoadTimestamp",(new Date).getTime().toString());Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("SubGrid - "+this.get_id()+" - Finish",1);return true},cacheValidation:function(currentViewTimestamp,updatedViewTimestamp){return true},fireGridEvents:function(command){this.fireControlEvent("OnRefresh",Sys.EventArgs.Empty);var $v_0=$find(this.get_id());if(this.isLiteSubGrid()||!IsNull(Mscrm.PageManager)&&!IsNull(Mscrm.PageManager.get_instance())&&Mscrm.PageManager.isFlatUIPage())if(!IsNull($v_0)){var $v_1={};$v_1["gridRefreshSourceElement"]=this.$24_3;this.$24_3=null;$v_0.raiseEvent(Mscrm.ScriptEvents.OnGridRefresh,$v_1)}},displayFailedMessage:function(){this.setGridData(String.format(this.$1M_3,CrmEncodeDecode.CrmHtmlEncode(window.LOCID_LOADING_GRID_FAILED)),true)},isSubGridStale:function(currentTimestamp,updatedTimestamp){if(isNullOrEmptyString(currentTimestamp)||isNullOrEmptyString(updatedTimestamp))return true;return currentTimestamp!==updatedTimestamp},$5P_3:function(){var $v_0=$get(this.get_id()+"_AppGridFilterSelector");!IsNull($v_0)&&Mscrm.CrmUIComponent.crmCreate(Mscrm.AppGridFilterSelector,null,null,null,$v_0);var $v_1=$get("AppGridFilterContainer");!IsNull($v_1)&&Mscrm.CrmUIComponent.crmCreate(Mscrm.AppGridFilterContainer,null,null,null,$v_1)},$5R_3:function(){var $v_0=$get(this.get_id()+"_JumpBar");!IsNull($v_0)&&Mscrm.CrmUIComponent.crmCreate(Mscrm.AppGridJumpBar,null,null,null,$v_0)},$3E_3:function(){var $v_0=$get("gridBodyTable",this.get_element());if(!IsNull($v_0)){var $v_1={};$v_1["parentGridControl"]=this;var $v_2={};$v_2["onSelectionChange"]=this.$$d_$8B_3;$v_2["onBeforeFormLoad"]=this.$$d_$4v_3;Mscrm.CrmUIComponent.crmCreate(Mscrm.AppGridDefaultDataControl,$v_1,$v_2,null,$v_0)}},$4D_3:function(){if(!IsNull(this.$0_3)){this.$0_3.remove_onSelectionChange(this.$$d_$8B_3);this.$0_3.remove_onBeforeFormLoad(this.$$d_$4v_3);this.$0_3.dispose();this.$0_3=null}},setGridData:function(html,updatePaging){var $v_0=this.GetParameter("expandable"),$v_1=this.GetParameter("maxrowsbeforescroll");if($v_0==="1"&&!parseInt($v_1,10))html=html+'<div style="height: 16px;"></div>';$get(this.get_id()+"_divDataArea").innerHTML=html;this.$3E_3();this.$4f_3(updatePaging)},finishShowLoadingMessage:function(){if(!IsNull(this.$1f_3)){var $v_0=$get(this.get_id()+"_divDataArea");if(!IsNull($v_0)){$v_0.style.overflowY=this.$1f_3;this.$1f_3=null}}},ClearPagingCookie:function(){this.SetProperty("pagingCookie","")},$4g_3:function(){var $v_0=$get(this.get_id()+"_PageInfo"),$v_1=$get(this.get_id()+"_RecordSelectInfo"),$v_2=null;if(!IsNull($v_0))$v_2=$get("_prevPageImg",$v_0);this.$1N_3=!IsNull($v_2);if(this.$1N_3)this.$1H_3=$v_2.tabIndex;if(!IsNull($v_1)){var $v_6=XUI.Html.GetText($v_1);this.$37_3=!isNullOrEmptyString($v_6)}else this.$37_3=false;this.$1O_3=this.GetProperty("refreshAsync")==="True";this.$23_3=this.GetParameter("InnerGridDisabled")!=="1"||this.isLiteSubGrid()?true:false;this.GetParameter("LoadOnDemand")==="1"&&this.registerHiddenTab();if(this.$1N_3)if(this.$23_3){$addHandler($v_2,"click",this.$$d_$83_3);$addHandler($get("_nextPageImg",$v_0),"click",this.$$d_$7a_3);$addHandler($get("fastRewind",$v_0),"click",this.$$d_$6E_3)}else this.DisablePaging();var $v_3=$get("refreshButtonLink",this.get_element());if(!IsNull($v_3)){$addHandler($v_3,"click",this.$$d_$8H_3);$addHandler($v_3,"mouseover",this.$$d_$8J_3);$addHandler($v_3,"mouseout",this.$$d_$8I_3)}var $v_4=$get("filterButtonLink",this.get_element());if(!IsNull($v_4)){$addHandler($v_4,"click",this.$$d_$69_3);$addHandler($v_4,"mouseover",this.$$d_$6B_3);$addHandler($v_4,"mouseout",this.$$d_$6A_3)}else{var $v_7=$get("gridbuttons",this.get_element());if(!IsNull($v_7))$v_7.style.width="30px"}var $v_5=$get(this.get_id()+"_findCriteria");if(!IsNull($v_5))$v_5.disabled=!this.$23_3;this.$7H_3();this.$4e_3(true);this.$4f_3(true);this.HandleGridResize();this.$2x_3=new Date},$7H_3:function(){var $v_0=$get(this.get_id()+"_divDataArea");!IsNull($v_0)&&$addHandler($v_0,"scroll",this.$$d_$2W_3);if(window.UseTabletExperience&&window.LOCID_UI_DIR==="RTL"){$addHandler($v_0,"touchstart",this.$$d_$7C_3);$addHandler($v_0,"touchmove",this.$$d_$7B_3)}},registerHiddenTab:function(){var $v_0=$find("crmForm");if(IsNull($v_0))return;var $v_1=$v_0.GetTab(this.get_element(),false);if(!IsNull($v_1)){var $v_2=$find($v_1.id);try{if($v_2.get_displayState()===Xrm.TabDisplayState.expanded)this.$4n_3();else $v_2.add_tabStateChange(this.$$d_$4b_3)}catch($$e_3){}}},$4b_3:function($p0,$p1){if($p1.get_displayState()===Xrm.TabDisplayState.expanded){$p0.remove_tabStateChange(this.$$d_$4b_3);this.$4n_3()}},$4n_3:function(){if(this.GetParameter("LoadOnDemand")==="1"){this.SetParameter("LoadOnDemand","0");this.Refresh()}},$4e_3:function($p0){if($p0)this.$X_3=null;var $v_0=this.get_id()+"_gridBar",$v_1=$get($v_0);if($v_1){var $v_2=$v_1.rows[0];$addHandler($v_2,"keydown",this.$$d_$4X_3);$addHandler($v_2,"click",this.$$d_$4T_3);$addHandler($v_2,"mouseover",this.$$d_$6p_3);$addHandler($v_2,"mouseout",this.$$d_$6o_3)}},$4f_3:function($p0){var $v_0=$get("gridBodyTable",this.get_element());if(!IsNull($v_0))this.$0_3=$v_0.control;if(typeof $p0==="undefined")$p0=true;this.$23_3&&$p0&&executeFunctionDeferred(this.$$d_$8t_3,false,false);if(!this.$0_3)return;this.$37_3&&this.$0_3.add_onSelectionChange(this.$$d_$5J_3);this.$5J_3(null,null)},$5J_3:function($p0,$p1){this.$8w_3(this.$0_3.get_selectedRecords().length,this.$0_3.get_numberOfRecords(),this.$0_3.get_moreRecords(),this.$0_3.get_totalRecordCount(),this.$0_3.get_allRecordsCounted())},$8w_3:function($p0,$p1,$p2,$p3,$p4){var $v_0=0,$v_1=0,$v_2=this.$4O_3();if($p1){var $v_D=this.getPageNumber();if(IsNull($v_D)||$v_D===-1)$v_D=1;$v_0=($v_D-1)*$v_2+1;$v_1=($v_D-1)*$v_2+$p1}if($p3>=0)if($v_1>$p3||$p1<$v_2){$p3=$v_1;$p4=!$p2}var $v_3=$get(this.get_element().id+"_StatusBar");this.updateVisibility($p3,$v_2,$v_3);var $v_4=$get(this.get_element().id+"_FirstItem");!IsNull($v_4)&&XUI.Html.SetText($v_4,$v_0+"");var $v_5=$get(this.get_element().id+"_LastItem");!IsNull($v_5)&&XUI.Html.SetText($v_5,$v_1+"");var $v_6=$get(this.get_element().id+"_ItemsTotal");!IsNull($v_6)&&XUI.Html.SetText($v_6,this.$6i_3($p3,$p4));var $v_7=$get(this.get_element().id+"_TotalCountInfo");if(!IsNull($v_7))$v_7.style.display=$p3<0?"none":"inline";var $v_8=$get(this.get_element().id+"_ItemsSelected");!IsNull($v_8)&&XUI.Html.SetText($v_8,$p0.toString());var $v_9=$get("chkAll",this.get_element());if(!IsNull($v_9)){$v_9.checked=$p0===$p1&&$p1>0;$v_9.disabled=!$p1}var $v_A=$get(this.get_id()+"_gridBodyTable_checkBox_Image_All");if(!IsNull($v_A))$v_A.style.visibility=!$p1?"hidden":"visible";var $v_B;if(!$p3)$v_B=window.LOCID_GRID_0_RESULT_COUNT_MSG;else if($p3===1)$v_B=window.LOCID_GRID_1_RESULT_COUNT_MSG;else $v_B=String.format(window.LOCID_GRID_RESULT_COUNT_MSG,$p3);var $v_C=$get("grid_resultsCount");!IsNull($v_C)&&XUI.Html.SetText($v_C,$v_B)},updateVisibility:function(totalRecordCount,recordsPerPage,statusBar){return},$8t_3:function(){if(this.get_isDisposed())return;if(this.$1N_3){var $v_0=false;if(!this.$0_3)$v_0=false;else $v_0=this.$0_3.get_moreRecords();var $v_1=false,$v_2=false,$v_3="0",$v_4=$v_0?"1":"0",$v_5="pointer",$v_6="pointer",$v_7=this.GetProperty("pageNum"),$v_8=$get(this.get_id()+"_PageInfo");XUI.Html.SetText($get("_PageNum",$v_8),$v_7);if(parseInt($v_7,10)>1)$v_3="1";else{$v_5="auto";$v_2=true}if(!$v_0){$v_6="auto";$v_1=true}var $v_9=$get("_prevPageImg",$v_8);if(!IsNull($v_9)){var $v_E=XUI.Html.DomUtils.GetFirstChild($v_9);$v_9.style.cursor=$v_5;var $v_F=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_L"+$v_3+".gif"));$v_E.src=$v_F.source;$v_E.className=$v_F.cssClass;if($v_2){$v_E.setAttribute("disabled","disabled");$v_9.setAttribute("disabled","disabled");$v_9.tabIndex=-1}else{$v_E.removeAttribute("disabled");$v_9.removeAttribute("disabled");$v_9.tabIndex=this.$1H_3}this.SetLinkAttributes($v_9,$v_2);this.$1V_3($v_9,$v_2)}var $v_A=$get("fastRewind",$v_8);if(!IsNull($v_A)){var $v_G=XUI.Html.DomUtils.GetFirstChild($v_A);$v_A.style.cursor=$v_5;var $v_H=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_FL"+$v_3+".gif"));$v_G.src=$v_H.source;$v_G.className=$v_H.cssClass;if($v_2){$v_G.setAttribute("disabled","disabled");$v_A.setAttribute("disabled","disabled");$v_A.tabIndex=-1}else{$v_G.removeAttribute("disabled");$v_A.removeAttribute("disabled");$v_A.tabIndex=this.$1H_3}this.SetLinkAttributes($v_A,$v_2);this.$1V_3($v_A,$v_2)}var $v_B=$get("_nextPageImg",$v_8);if(!IsNull($v_B)){var $v_I=XUI.Html.DomUtils.GetFirstChild($v_B);$v_B.style.cursor=$v_6;var $v_J=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_R"+$v_4+".gif"));$v_I.src=$v_J.source;$v_I.className=$v_J.cssClass;if($v_1){$v_I.setAttribute("disabled","disabled");$v_B.setAttribute("disabled","disabled");$v_B.tabIndex=-1}else{$v_I.removeAttribute("disabled");$v_B.removeAttribute("disabled");$v_B.tabIndex=this.$1H_3}this.SetLinkAttributes($v_B,$v_1);this.$1V_3($v_B,$v_1)}var $v_C=$get("_prevPageInlineButton",this.get_element());if(!IsNull($v_C))if($v_2)$v_C.style.display="none";else{$v_C.style.display="block";var $$t_M=this;$addHandler($v_C,"click",function($p1_0){$$t_M.$1r_3(parseInt($$t_M.GetProperty("pageNum"),10)-1)})}var $v_D=$get("_nextPageInlineButton",this.get_element());if(!IsNull($v_D))if($v_1)$v_D.style.display="none";else{$v_D.style.display="block";var $$t_N=this;$addHandler($v_D,"click",function($p1_0){$$t_N.$1r_3(parseInt($$t_N.GetProperty("pageNum"),10)+1)})}}},$4A_3:function(){var $v_0=$get("_prevPageInlineButton",this.get_element());!IsNull($v_0)&&$clearHandlers($v_0);var $v_1=$get("_nextPageInlineButton",this.get_element());!IsNull($v_1)&&$clearHandlers($v_1)},SetLinkAttributes:function(pageImage,isDisabled){if(isDisabled){pageImage.removeAttribute("href");$removeHandler(pageImage,"click",Mscrm.GridControl.$4G)}else{$addHandler(pageImage,"click",Mscrm.GridControl.$4G);pageImage.href="javascript:onclick();";return false}},DisablePaging:function(){var $v_0=$get("_prevPageImg",this.get_element()),$v_1=XUI.Html.DomUtils.GetFirstChild($v_0);$v_0.style.cursor="auto";var $v_2=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_L0.gif"));$v_1.src=$v_2.source;$v_1.className=$v_2.cssClass;if(window.LOCID_UI_DIR==="RTL"){Mscrm.Utilities.cancelElementFlipping($v_1);Mscrm.Utilities.flipElementHorizontally($v_1)}$v_1.setAttribute("disabled","disabled");$v_0.setAttribute("disabled","disabled");this.$1V_3($v_0,true);var $v_3=$get("fastRewind",this.get_element()),$v_4=XUI.Html.DomUtils.GetFirstChild($v_3);$v_3.style.cursor="auto";var $v_5=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_FL0.gif"));$v_4.src=$v_5.source;$v_4.className=$v_5.cssClass;if(window.LOCID_UI_DIR==="RTL"){Mscrm.Utilities.cancelElementFlipping($v_4);Mscrm.Utilities.flipElementHorizontally($v_4)}$v_4.setAttribute("disabled","disabled");$v_3.setAttribute("disabled","disabled");this.$1V_3($v_3,true);var $v_6=$get("_nextPageImg",this.get_element()),$v_7=XUI.Html.DomUtils.GetFirstChild($v_6);$v_6.style.cursor="auto";var $v_8=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/grid/page_R0.gif"));$v_7.src=$v_8.source;$v_7.className=$v_8.cssClass;if(window.LOCID_UI_DIR==="RTL"){Mscrm.Utilities.cancelElementFlipping($v_7);Mscrm.Utilities.flipElementHorizontally($v_7)}$v_7.setAttribute("disabled","disabled");$v_6.setAttribute("disabled","disabled");this.$1V_3($v_6,true)},$1V_3:function($p0,$p1){var $v_0=XUI.Html.DomUtils.GetFirstChild($p0);if(!IsNull($v_0))if($p1){$v_0.alt="";$v_0.title=""}else if(isNullOrEmptyString($v_0.alt)&&!IsNull($v_0.getAttribute("tempToolTip"))){$v_0.alt=$v_0.getAttribute("tempToolTip").toString();$v_0.title=$v_0.alt}},HandleGridResize:function(domEvent){window.UseTabletExperience&&this.$6F_3();this.$7w_3();this.$2W_3(domEvent);this.handleStatusBar();this.$6u_3()},$6u_3:function(){var $v_0=$get(this.get_id()),$v_1=$get(this.get_id()+"_JumpBar");if(!IsNull($v_1))if(!IsNull($v_0)&&$v_0.offsetWidth<800)$v_1.style.visibility="hidden";else $v_1.style.visibility="visible"},$6F_3:function(){var $v_0=$get(this.get_id()+"_gridBodyContainer");if(!IsNull($v_0)){$v_0.setAttribute("temp","temp");$v_0.removeAttribute("temp")}},$2W_3:function($p0){if(IsNull($p0)&&window.UseTabletExperience)return;var $v_0=$get(this.get_id()+"_gridBodyContainer"),$v_1=$get("fixedrow",$v_0),$v_2=$get(this.get_id()+"_divDataArea");!IsNull($v_1)&&!IsNull($v_2)&&this.$8o_3($v_1,$v_2)},$7C_3:function($p0){var $v_0=$p0.rawEvent.touches;if(!IsNull($v_0)&&!IsNull($v_0[0])){this.$3A_3=$v_0[0].pageX;this.$3B_3=$v_0[0].pageY}},$7B_3:function($p0){var $v_0=$p0.rawEvent.touches;if(!IsNull($v_0)&&!IsNull($v_0[0])){var $v_1=$v_0[0].pageX,$v_2=$v_0[0].pageY,$v_3=this.$3A_3-$v_1,$v_4=this.$3B_3-$v_2,$v_5=$get(this.get_id()+"_divDataArea");$v_5.scrollLeft+=$v_3;$v_5.scrollTop+=$v_4;this.$3A_3=$v_1;this.$3B_3=$v_2}},handleStatusBar:function(){var $v_0=$get("gridStatusBar",this.get_element()),$v_1=$get(this.get_id()+"_PageInfo"),$v_2=$get("page_R0",$v_1),$v_3=$get(this.get_id()+"_RecordSelectInfo"),$v_4=$get(this.get_id()+"_RecordSelectEndMarker"),$v_5=$get("fastRewind",$v_1);if(IsNull($v_0)||IsNull($v_3)||IsNull($v_1)||IsNull($v_2))return;var $v_6=$v_0.offsetWidth,$v_7=$get(this.get_id()+"_ItemsSelectedInfo"),$v_8=$v_3.style,$v_9=null;if($v_7)$v_9=$v_7.style;if($v_8.display!=="none"&&!this.$1i_3)if(window.LOCID_UI_DIR!=="RTL"){this.$1i_3=2*$v_4.offsetLeft;if($v_7)this.$2v_3=2*$v_7.offsetLeft}else{this.$1i_3=3*$v_5.offsetLeft;this.$2v_3=2*$v_5.offsetLeft}if($v_6<=this.$1i_3){if($v_6<=this.$2v_3){if($v_7)if($v_9.display==="none")$v_9.display="inline";if($v_6&&$v_8.display!=="none")$v_8.display="none"}else{if($v_7)if($v_9.display!=="none")$v_9.display="none";if($v_8.display==="none")$v_8.display="inline"}return}if($v_2.offsetLeft+$v_2.offsetWidth>=$v_1.offsetWidth){$v_8.display="none";this.$1i_3=$v_6;return}if($v_8.display==="none")$v_8.display="inline";if($v_7)if($v_9.display==="none")$v_9.display="inline";window.UseTabletExperience&&this.$8V_3()},$8V_3:function(){var $v_0=$get(this.get_id()+"_PageInfo"),$v_1=$get("gridStatusBar",this.get_element()),$v_2=$get(this.get_id()+"_StatusBar"),$v_3=$get("page_L0",$v_0),$v_4=$get("page_R0",$v_0),$v_5=$get(this.get_id()+"_RecordSelectInfo"),$v_6=$v_4.getAttribute("hspace");if($v_1.clientWidth>$v_2.clientWidth)if($v_1.clientWidth-4*($v_6-2)<=$v_2.clientWidth){var $v_7=Math.round(($v_1.clientWidth-$v_2.clientWidth)/4);if($v_7<=$v_6-2){$v_4.setAttribute("hspace",$v_6-$v_7);$v_3.setAttribute("hspace",$v_6-$v_7)}else $v_5.setAttribute("style","display:none")}else $v_5.setAttribute("style","display:none")},$7N_3:function($p0){if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var $v_0=document.documentMode;if(IsNull($v_0))$v_0=Sys.Browser.version;if($p0.scrollLeft>0||$v_0<=7)return false;return true}return Mscrm.Utilities.isFirefox()},$8o_3:function($p0,$p1){var $v_0=0;if(window.LOCID_UI_DIR==="RTL"){var $v_1=$p1.scrollLeft,$v_2=this.$7N_3($p0);if($v_2)$v_0=-Math.abs($p1.scrollLeft);else if(Mscrm.Utilities.isIE7OrIE7CompactMode())$v_0=$p1.scrollLeft+$p1.offsetWidth-$p1.scrollWidth;else $v_0=$p1.scrollLeft+$p1.clientWidth-$p1.scrollWidth;if($v_0!==parseInt($p0.style.marginRight,10)){$p0.style.marginRight=$v_0+"px";$p1.scrollLeft=$v_1}}else{$v_0=$p0.scrollLeft-$p1.scrollLeft;if($v_0!==parseInt($p0.style.marginLeft,10)){$p0.style.marginLeft=$v_0+"px";$p1.scrollLeft=Math.abs($v_0)}}},$83_3:function($p0){var $v_0=$get("_prevPageImg",this.get_element()).getAttribute("disabled");(IsNull($v_0)||!$v_0)&&this.$1r_3(parseInt(this.GetProperty("pageNum"),10)-1)},$7a_3:function($p0){var $v_0=$get("_nextPageImg",this.get_element()).getAttribute("disabled");(IsNull($v_0)||!$v_0)&&this.$1r_3(parseInt(this.GetProperty("pageNum"),10)+1)},$6E_3:function($p0){var $v_0=$get("fastRewind",this.get_element()).getAttribute("disabled");(IsNull($v_0)||!$v_0)&&this.$1r_3(1)},$1r_3:function($p0){try{if($p0>1)this.$36_3=true;this.$3i_3($p0)}finally{this.$36_3=true}},$3i_3:function($p0){if(this.$1P_3)return;if($p0<1)return;var $v_0=new Mscrm.ChangePageEventArgs($p0,this.getPageNumber());this.fireControlEvent("OnChangePage",$v_0);this.SetProperty("pageNum",$p0.toString());if($v_0.breakEvent)return;this.$4w_3(true)},$4X_3:function($p0){var $v_0=Mscrm.Utilities.getDomEventKeyCode($p0);switch($v_0){case 13:$p0.target.tagName==="TH"&&this.$4T_3($p0);break;default:return}},$4T_3:function($p0){var $v_0=$p0.target;switch($v_0.tagName){case "IMG":if(Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-List-Sortable"))$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;else if($v_0.id.toString().startsWith(this.get_id()+"_gridBodyTable_checkBox_Image")){var $v_2=$get("chkAll",this.get_element());if(!$v_2.checked){this.$0_3.SelectRecords(0,this.$0_3.get_dataTableBody().rows.length-1,false);$v_2.checked=true}else{this.$0_3.UnselectRecords(null);$v_2.checked=false}}break;case "LABEL":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "NOBR":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "A":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "TD":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode;break;case "INPUT":if(IsNull(this.$0_3))return;if($v_0.checked)this.$0_3.SelectRecords(0,this.$0_3.get_dataTableBody().rows.length-1,false);else this.$0_3.UnselectRecords(null);return}if(this.$1Q_3||!$v_0.getAttribute("field")||$v_0.className!=="ms-crm-List-Sortable")return;this.$4B_3($v_0);var $v_1=this.GetProperty("enableMultiSort")==="true";this.$X_3.toggle($v_0.getAttribute("field"),$v_1&&$p0.shiftKey);this.$5A_3()},$6p_3:function($p0){var $v_0=$p0.target;switch($v_0.tagName){case "IMG":if(Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-List-Sortable")){$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break}else return;case "LABEL":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "NOBR":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "A":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode.parentNode;break;case "TD":$v_0=$v_0.parentNode.parentNode.parentNode.parentNode;break}if($v_0.className==="ms-crm-List-Sortable"&&$v_0.style.backgroundImage!=="url(/_imgs/theme/"+Xrm.Page.context.getCurrentTheme()+"/GridColumnGradientHover.png)"){$v_0.style.backgroundImage="url(/_imgs/theme/"+window.CURRENT_THEME_TYPE+"/GridColumnGradientHover.png)";this.$15_3=$v_0}},$6o_3:function($p0){var $v_0=$p0.rawEvent.relatedTarget||$p0.rawEvent.toElement;if(!IsNull(this.$15_3)&&!(!IsNull($v_0)&&($v_0===this.$15_3||$v_0.parentNode===this.$15_3||$v_0.parentNode.parentNode===this.$15_3))){this.$15_3.style.backgroundImage="";this.$15_3=null}},$5A_3:function(){for(var $v_0=this.$X_3.columns.length,$v_1=0;$v_1<$v_0;$v_1++){var $v_2=this.$4I_3(this.$X_3.columns[$v_1].$k_0),$v_3=null;if(!IsNull($v_2))$v_3=this.$4Q_3($v_2);if(!$v_3)return;$v_3.style.visibility="visible";Mscrm.Utilities.cancelElementFlipping($v_3);var $v_4="",$v_5=Mscrm.InternalUtilities.Utilities.isHighContrastEnabled();if(!this.$X_3.columns[$v_1].$s_0){if(!$v_5){$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_up","");$v_3.className+=" ms-crm-ImageStrip-sorting_down"}else{$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_up","");$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_down","");$v_3.src="/_imgs/grid/sorting_down.png"}$v_4=window.LOCID_ALT_COLUMNSORTORDER_DOWN}else{if(!$v_5){$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_down","");$v_3.className+=" ms-crm-ImageStrip-sorting_up"}else{$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_up","");$v_3.className=$v_3.className.replace(" ms-crm-ImageStrip-sorting_down","");$v_3.src="/_imgs/grid/sorting_up.png"}$v_4=window.LOCID_ALT_COLUMNSORTORDER_UP}$v_3.alt=$v_4;$v_3.title=$v_4;window.LOCID_UI_DIR==="RTL"&&Mscrm.Utilities.flipElementHorizontally($v_3)}this.SetProperty("sortColumns",this.$X_3.serialize());this.ClearPagingCookie();this.$3i_3(1)},SortColumn:function(domElement,sortOrder,append){domElement=domElement.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(IsNull(domElement.getAttribute("field"))||domElement.className!=="ms-crm-List-Sortable")return;this.$4B_3(domElement);var $v_0=this.GetProperty("enableMultiSort")==="true";this.$X_3.multipleSort(domElement.getAttribute("field"),sortOrder,$v_0&&append);this.$5A_3()},$4B_3:function($p0){$p0.style.backgroundImage="";if(IsNull(this.$X_3)){this.$X_3=new Mscrm.SortColumns;this.$X_3.deserialize(this.GetProperty("sortColumns"))}for(var $v_0=this.$X_3.columns.length,$v_1=0;$v_1<$v_0;$v_1++){var $v_2=this.$4I_3(this.$X_3.columns[$v_1].$k_0);if(!IsNull($v_2)){var $v_3=this.$4Q_3($v_2);$v_3.style.visibility="hidden"}}},$4Q_3:function($p0){var $v_0=0,$v_1=null,$v_2=$p0.getElementsByTagName("IMG");while($v_0<$v_2.length){if(!IsNull($v_2[$v_0].className)){for(var $v_3=$v_2[$v_0].className.split(" "),$v_4=0;$v_4<$v_3.length;$v_4++)if($v_3[$v_4]==="ms-crm-List-Sortable"){$v_1=$v_2[$v_0];break}if(!IsNull($v_1))break}$v_0++}return $v_1},$4I_3:function($p0){var $v_0=0,$v_1=$get(this.get_id()+"_gridBar"),$v_2=$v_1.rows[0].cells,$v_3=$v_2.length;while($v_0<$v_3){if($v_2[$v_0].getAttribute("field")&&$v_2[$v_0].getAttribute("field")===$p0)return $v_2[$v_0];$v_0++}return null},ResetPageNumber:function(){this.SetProperty("pageNum","1")},getPageNumber:function(){return this.$1N_3?parseInt(this.GetProperty("pageNum"),10):-1},$4O_3:function(){return parseInt(this.GetProperty("recsPerPage"),10)},$6b_3:function(){return parseInt(this.GetProperty("max"),10)},$4M_3:function(){var $v_0=$get("fixedrow"),$v_1=0;if(!IsNull($v_0))$v_1=$v_0.offsetLeft;return $v_1},HandleResize:function(domEvent,column,width){if(!this.$1G_3){var $v_0=$get(this.get_element().id+"_gridBarCols");this.$1G_3=$v_0.children[parseInt(XUI.Html.DomUtils.GetPrevSibling(column.get_element().parentNode).cellIndex,10)]}if(!IsNull(width)&&width>0){this.$1G_3.setAttribute("width",width+"px");!IsNull(this.$0_3)&&this.$0_3.resizeColumn(XUI.Html.DomUtils.GetPrevSibling(column.get_element().parentNode).getAttribute("field"),width)}else{var $v_1=0,$v_2=0,$v_3=this.$4M_3();if(window.LOCID_UI_DIR==="RTL"){$v_1=this.$2D_3-domEvent.screenX;$v_2=this.$25_3-$v_3}else{$v_1=domEvent.screenX-this.$2D_3;$v_2=$v_3-this.$25_3}var $v_4=$v_1-$v_2,$v_5=parseInt(this.$1G_3.getAttribute("width"),10)+$v_4;if(($v_1>5||$v_1<-5)&&$v_5>=1){this.$2D_3=domEvent.screenX;this.$25_3=$v_3;this.$1G_3.setAttribute("width",$v_5+"px");!IsNull(this.$0_3)&&this.$0_3.resizeColumn(XUI.Html.DomUtils.GetPrevSibling(column.get_element().parentNode).getAttribute("field"),$v_5);this.$2W_3(domEvent)}}},HandleResizeCleanup:function(domEvent){Mscrm.GlobalEvents.set_globalAllowDrag(false);this.$1G_3=null;this.$4e_3(false)},HandleResizeStartup:function(domEvent){this.$2D_3=domEvent.screenX;this.$25_3=this.$4M_3();Mscrm.GlobalEvents.set_globalAllowDrag(true);var $v_0=$get(this.get_id()+"_gridBar").rows[0];$removeHandler($v_0,"keydown",this.$$d_$4X_3);$removeHandler($v_0,"click",this.$$d_$4T_3);$removeHandler($v_0,"mouseover",this.$$d_$6p_3);$removeHandler($v_0,"mouseout",this.$$d_$6o_3)},GetProperty:function(name){var $v_0=$get(name,this.$2R_3());return !IsNull($v_0)?$v_0.getAttribute("value"):null},SetProperty:function(name,value){var $v_0=this.$2R_3(),$v_1=$get(name,$v_0);if(IsNull($v_1)){$v_1=document.createElement("div");$v_1.setAttribute("id",name);$v_0.appendChild($v_1)}$v_1.setAttribute("value",value)},HandleAutoResize:function(domEvent,column){if(IsNull(this.$0_3))return;var $v_0=this.$0_3.autoResizeColumn(XUI.Html.DomUtils.GetPrevSibling(column.get_element().parentNode).getAttribute("field"));if($v_0===-1)$v_0=10;this.HandleResize(domEvent,column,$v_0);this.HandleResizeCleanup(domEvent)},$7w_3:function(){var $v_0=$get(this.get_id()+"_gridBodyContainer"),$v_1=$get("refreshButton",$v_0);if(!IsNull($v_1)){if(window.LOCID_UI_DIR==="RTL"){$v_1.style.left="0px";$v_1.style.right="auto"}else{$v_1.style.left="auto";$v_1.style.right="0px"}var $v_2=$v_1.style.display!=="inline"&&$v_1.style.display!=="none";if($v_2)$v_1.style.display="inline"}},$6i_3:function($p0,$p1){if($p1)return String.format(window.LOCID_GRID_EXACTTOTALCOUNT,$p0);else return String.format(window.LOCID_GRID_APPROXTOTALCOUNT,$p0)},$G_3:null,$5O_3:false,$4c_3:false,$3b_3:false,$7S_3:function(){var $v_0=false;if(this.GetParameter("AutoRefreshOnLoad")==="1"){this.SetParameter("LoadOnDemand","0");this.SetParameter("AutoRefreshOnLoad","0");$v_0=true}else if(this.GetParameter("RenderAsync")==="1"){this.SetParameter("RenderAsync","0");if(this.GetParameter("LoadOnDemand")!=="1")$v_0=true}if($v_0){this.add_onRefresh(this.$$d_$3Y_3);this.Refresh();this.setSubGridHeight(false)}else{this.$3E_3();this.$3Y_3(null,null)}},isLiteSubGrid:function(){return this.GetParameter("LayoutStyle")==="LiteGridList"||this.GetParameter("LayoutStyle")==="AssociatedLiteGridList"},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);if(this.get_gridType()===Mscrm.GridControl.hompageGrid){var $v_0=this.GetParameter("titleformat");setPageTitle(String.format($v_0,this.get_entityDisplayPluralName(),this.get_viewTitle()))}if(this.get_gridType()===Mscrm.GridControl.hompageGrid||this.get_gridType()===Mscrm.GridControl.associatedGrid&&this.isLiteSubGrid())!IsNull(this.get_$1X_3())&&this.get_$1X_3().addCssClass("ms-crm-View-Name-View-Lite");this.add_onRefresh(this.$$d_$7j_3);this.add_onResetComplete(this.$$d_$7j_3);!IsNull(this.$0_3)&&this.$0_3.add_onSelectionChange(this.$$d_$7k_3);if(this.get_gridType()===Mscrm.GridControl.inlineSubGrid){this.$G_3=this.get_element().parentNode;while(this.$G_3)if(!IsNull(this.$G_3.className)&&Sys.UI.DomElement.containsCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout"))break;else this.$G_3=this.$G_3.parentNode}this.$4c_3=true;this.$3b_3&&this.$4Z_3();this.$4g_3();!IsNull(this.get_$1X_3())&&window.setTimeout(this.get_$1X_3().$$d_syncToGridStatus,0);this.activateControls();this.HandleGridResize();$addHandler(window,"load",this.$$d_$7g_3);$addHandler(window,"resize",this.$$d_HandleGridResize)},activateControls:function(){this.$5R_3();this.$5P_3();this.initAppGridPresence(null,null)},addNewFromSubGridStandard:function(gridTypeCode,parentEntityTypeCode,parentEntityId){switch(gridTypeCode){case Mscrm.EntityTypeCode.CustomerAddress:Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/sfa/address.js"));AddRelatedAddress(gridTypeCode,parentEntityTypeCode,parentEntityId);break;case Mscrm.EntityTypeCode.KbArticle:gridTypeCode=Mscrm.EntityTypeCode.NewKbArticle;locAddRelatedToNonForm(gridTypeCode,parentEntityTypeCode,parentEntityId,"");break;default:locAddRelatedToNonForm(gridTypeCode,parentEntityTypeCode,parentEntityId,"");break}},updatePageNumberOnLastRecordDelete:function(){var $v_0=false,$v_1=this.getPageNumber();if($v_1>1&&($v_1-1)*this.$4O_3()===this.get_totalRecordCount()-1){this.SetProperty("pageNum",($v_1-1).toString());$v_0=true}return $v_0},getFormData:function(){var $v_0=$get(this.get_id()+"_span"),$v_1=$v_0.getAttribute("FormDataEntityId"),$v_2=$find($v_1);return $v_2},dispose:function(){if(this.get_isDisposed())return;this.$7c_3(null);$removeHandler(window,"load",this.$$d_$7g_3);if(window._events["resize"]!=undefined){$removeHandler(window,"resize",this.$$d_HandleGridResize);$removeHandler(window,"resize",this.$$d_handleAutoExpandRows)}this.$4A_3();Mscrm.CrmUIControl.prototype.dispose.call(this)},$2R_3:function(){return $get("divGridProps",this.get_element())},$2Q_3:function(){return $get("divGridParams",this.get_element())},getCellValue:function(columnName,rowId){for(var $v_0=this.GetRecordsFromInnerGrid(false),$v_1=rowId.toUpperCase(),$v_2=null,$v_4=0;$v_4<$v_0.length;$v_4++){var $v_5=$v_0[$v_4][0];if($v_5.toUpperCase()===$v_1){$v_2=$v_0[$v_4];break}}if(!$v_2)return null;var $v_3=$v_2[3];return this.getCellValueFromGridRow(columnName,$v_3)},getCellValueFromGridRow:function(columnName,rowElement){var $v_0=rowElement.getAttribute(columnName);if(!isNullOrEmptyString($v_0))return $v_0;var $v_1=this.$0_3.FindColumnIndex(columnName);if($v_1!==-1&&$v_1<rowElement.children.length){var $v_2=XUI.Html.DomUtils.GetChildElementAt(rowElement,$v_1),$v_3=$v_2.attributes.getNamedItem("RawValue");if($v_3)return $v_3.value;return XUI.Html.GetText($v_2)}return null},$5x_3:function(){if(this.$G_3&&Sys.UI.DomElement.containsCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout")){Sys.UI.DomElement.removeCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout");Sys.UI.DomElement.addCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout-Selected");var $v_0=this.$G_3.getElementsByTagName("tr")[0];Sys.UI.DomElement.addCssClass($v_0,"ms-crm-Form-SubGrid-viewRow");this.$1d_3=true;!IsNull(this.$0_3)&&this.$0_3.reselectRows();this.handleAutoExpandRows(null)}},$8O_3:function(){if(this.$G_3&&Sys.UI.DomElement.containsCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout-Selected")){Sys.UI.DomElement.removeCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout-Selected");Sys.UI.DomElement.addCssClass(this.$G_3,"ms-crm-Form-SubGrid-Layout");var $v_0=this.$G_3.getElementsByTagName("tr")[0];Sys.UI.DomElement.removeCssClass($v_0,"ms-crm-Form-SubGrid-viewRow");if(!IsNull(this.$0_3)){this.$0_3.saveSelectRows();this.$0_3.UnselectRecords(null)}this.$1d_3=false;this.handleAutoExpandRows(null)}},$7k_3:function($p0,$p1){this.raiseEventWithCheck(Mscrm.ScriptEvents.SelectionChanged,null)},$7j_3:function($p0,$p1){!IsNull(this.$0_3)&&this.$0_3.add_onSelectionChange(this.$$d_$7k_3);this.raiseEventWithCheck(Mscrm.ScriptEvents.SelectionChanged,null)},$7g_3:function($p0){executeFunctionDeferred(this.$$d_$4K_3,false,false)},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.ViewSelectorChanged:!IsNull(this.$0_3)&&this.$0_3.add_onSelectionChange(this.$$d_$7k_3);this.raiseEventWithCheck(Mscrm.ScriptEvents.SelectionChanged,null);break;case Mscrm.ScriptEvents.GetPageInfo:return this.$6s_3(parameters);case Mscrm.ScriptEvents.RefreshGrid:var $v_0=parameters["async"];if($v_0){var $v_3=this.get_refreshAsynchronous();this.set_refreshAsynchronous(true);this.$4V_3(parameters);this.set_refreshAsynchronous($v_3)}else this.$4V_3(parameters);break;case Mscrm.ScriptEvents.PageLoaded:var $$t_A=this,$v_1=function(){if(sourceComponent){var $v_5=sourceComponent._disposed,$v_6=!$v_5&&sourceComponent===$find(sourceComponent.get_id())&&!$$t_A.doNotFocusGridQuickFindOnLoad;$v_6&&$$t_A.$4K_3()}$$t_A.$3b_3=true;$$t_A.$4Z_3();$$t_A.HandleGridResize()};executeFunctionDeferred($v_1,false,false);break;case Mscrm.ScriptEvents.PageUnloaded:!IsNull(sourceComponent)&&sourceComponent===this.get_rootManager()&&this.$3K_3(null);break;case Mscrm.ScriptEvents.SetRibbonSelectedControl:var $v_4=parameters["selectedControl"];if(!IsNull($v_4)&&($v_4.get_id()===this.get_id()||Mscrm.Utilities.isDescendant($v_4.get_element(),this.get_element())))this.$5x_3();else this.$8O_3();break;case Mscrm.ScriptEvents.PrintPreviewGrid:var $v_2=false;if(this.$6Q_3()==="visible"){if(this.get_gridType()===Mscrm.GridControl.hompageGrid)$v_2=true;if(this.get_gridType()===Mscrm.GridControl.associatedGrid&&XUI.Html.GetComputedStyle(window.frameElement.parentNode,"display")!=="none"&&XUI.Html.GetComputedStyle(window.parent.frameElement,"visibility")==="visible")$v_2=true}if($v_2){(IsNull(parameters)||!(Mscrm.NavBarSharedConstants.printPreviewAvailable in parameters))&&this.Print();return true}return false;case Mscrm.ScriptEvents.IFrameReactivated:this.get_gridType()===Mscrm.GridControl.hompageGrid&&setPageTitle(String.format(this.GetParameter("titleformat"),this.get_entityDisplayPluralName(),this.get_viewTitle()));break}return Mscrm.CrmUIControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent)},$6Q_3:function(){var $v_0="";$v_0=XUI.Html.GetComputedStyle(window.frameElement,"visibility");if($v_0==="inherit"&&!IsNull(window.parent))$v_0=XUI.Html.GetComputedStyle(window.parent.frameElement,"visibility");return $v_0},$4Z_3:function(){if(!this.$4c_3)return;this.autoExpandGridControlRows();this.$3b_3=false},autoExpandGridControlRows:function(){this.get_gridType()===Mscrm.GridControl.inlineSubGrid&&this.handleAutoExpandRows(null)},doNotFocusGridQuickFindOnLoad:false,$4K_3:function(){if(!this.$5O_3)if(this.get_gridType()!==Mscrm.GridControl.inlineSubGrid){var $v_0=$get(this.get_id()+"_findCriteria");if(!IsNull($v_0))try{$v_0.focus();this.$5O_3=true}catch($$e_1){}}},SetParameter:function(name,value){if(!IsNull(value))value=value.toString();Mscrm.GridControl.setElementParameter(this.get_element(),name,value)},GetParameter:function(name){var $v_0=this.$2Q_3(),$v_1=null;if(!IsNull($v_0)){var $v_2=$get(name,$v_0);if(!IsNull($v_2))$v_1=$v_2.getAttribute("value")}return $v_1},$1Q_3:false,get_sortingDisabled:function(){return this.$1Q_3},set_sortingDisabled:function(value){this.$1Q_3=value;return value},get_disabled:function(){var $v_0=false;if(this.get_element())$v_0=this.GetParameter("InnerGridDisabled")==="1";return $v_0},set_disabled:function(value){this.get_element()&&this.SetParameter("InnerGridDisabled",value?"1":"0");return value},get_gridType:function(){if(this.$1J_3===Mscrm.GridControl.gridTypeNone){var $v_0=this.GetParameter("GridType");if($v_0==="AssociatedGrid")this.$1J_3=Mscrm.GridControl.associatedGrid;else if($v_0==="SubGrid")this.$1J_3=Mscrm.GridControl.inlineSubGrid;else{var $v_1=Mscrm.Utilities.getContentUrl(this),$v_2=$v_1.get_path().toUpperCase();if(Mscrm.Utilities.isHomepageUrl($v_1))this.$1J_3=Mscrm.GridControl.hompageGrid}}return this.$1J_3},get_primaryFieldColumnIndex:function(){return !IsNull(this.$0_3)?this.$0_3.get_primaryFieldColumnIndex():-1},$4V_3:function($p0){var $v_0=$p0["etc"];if($v_0===this.get_entityTypeCode())this.Refresh();else if(this.get_entityTypeCode()===Mscrm.EntityTypeCode.ActivityPointer)Mscrm.EntityPropUtil.isActivityTypeCode($v_0)&&this.Refresh();else if(this.get_entityTypeCode()===Mscrm.EntityTypeCode.QueueItem)Mscrm.EntityPropUtil.isQueueItemTypeCode($v_0)&&this.Refresh()},$6s_3:function($p0){if(!IsNull($p0)&&!IsNull($p0["pageType"])&&$p0["pageType"]==="grid"){var $v_0={};$v_0["Id"]=this.GetParameter("viewid");$v_0["otc"]=this.GetParameter("otc");$v_0["etn"]=this.GetParameter("otn");$v_0["viewtype"]=this.GetParameter("viewtype");$v_0["title"]=this.GetParameter("viewTitle");$v_0["entitydisplayname"]=this.GetParameter("entitydisplayname");return $v_0}else return null},get_ribbonContextType:function(){var $v_0=this.GetParameter("ribbonContext");if(isNullOrEmptyString($v_0))$v_0=Mscrm.RibbonContexts.homepageGrid;return $v_0},get_ribbonRelationshipType:function(){var $v_0=this.GetParameter("relationshipType");if(!isNullOrEmptyString($v_0)){var $v_1=parseInt($v_0,10);if(!isNaN($v_1))return $v_1}return 0},get_entityTypeCode:function(){return parseInt(this.GetParameter("otc"),10)},get_entityTypeName:function(){return this.GetParameter("otn")},get_entityDisplayName:function(){return this.GetParameter("entitydisplayname")},get_entityDisplayPluralName:function(){return this.GetParameter("entitypluraldisplayname")},get_selectedRecordCount:function(){return this.GetRecordsFromInnerGrid(true).length},get_recordCount:function(){return this.GetRecordsFromInnerGrid(false).length},get_allRecordIds:function(){return Mscrm.GridControl.$3T(this.GetRecordsFromInnerGrid(false))},get_selectedIds:function(){return Mscrm.GridControl.$3T(this.GetRecordsFromInnerGrid(true))},get_unselectedIds:function(){return Mscrm.GridControl.$3T(this.$4R_3())},get_allRecords:function(){return Mscrm.GridControl.$3H(this.GetRecordsFromInnerGrid(false),this.get_primaryFieldColumnIndex())},get_selectedRecords:function(){return Mscrm.GridControl.$3H(this.GetRecordsFromInnerGrid(true),this.get_primaryFieldColumnIndex())},get_unselectedRecords:function(){return Mscrm.GridControl.$3H(this.$4R_3(),this.get_primaryFieldColumnIndex())},setFocus:function(){},setVisible:function(isVisible){Sys.UI.DomElement.setVisible(this.get_element(),isVisible)},getVisible:function(){return Sys.UI.DomElement.getVisible(this.get_element())},disableOrEnableAllGridCheckBoxes:function(state){for(var $v_0=this.get_element().getElementsByTagName("INPUT"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if($v_2.type==="checkbox")$v_2.disabled=state}},GetRecordsFromInnerGrid:function(onlySelectedRecords){if(!IsNull(this.$0_3))return onlySelectedRecords?this.$0_3.get_selectedRecords():this.$0_3.get_allRecords();return []},$4R_3:function(){for(var $v_0=this.GetRecordsFromInnerGrid(true),$v_1={},$v_4=0;$v_4<$v_0.length;$v_4++)$v_1[$v_0[$v_4][0]]=true;for(var $v_2=this.GetRecordsFromInnerGrid(false),$v_3=[],$v_5=0;$v_5<$v_2.length;$v_5++)if(IsNull($v_1[$v_2[$v_5][0]]))$v_3[$v_3.length]=$v_2[$v_5];return $v_3},get_viewTitle:function(){if(!IsNull(this.get_element())){var $v_0=this.GetParameter("viewTitle");return isNullOrEmptyString($v_0)?"":$v_0}else return null},get_viewIsUserOwned:function(){if(!IsNull(this.get_$1X_3()))return this.get_$1X_3().get_viewIsUserOwned();else return false},$1j_3:null,get_$1X_3:function(){if(!this.$1j_3){var $v_0=this.get_id()+"_SavedQuerySelector";this.$1j_3=$find($v_0);if(IsNull(this.$1j_3)){var $v_1=this.get_id()+"_SavedNewQuerySelector";this.$1j_3=$find($v_1)}}return this.$1j_3},get_hasMorePages:function(){return this.$0_3.get_moreRecords()},get_totalRecordCount:function(){if(!IsNull(this.$0_3))return this.$0_3.get_totalRecordCount();return -1},get_pageRecordCount:function(){return this.get_recordCount()},ActivateAdd:function(){},addButtonClickHandler:function(){},$2k_3:false,$O_3:null,$u_3:null,$2F_3:null,$31_3:null,$l_3:null,$2N_3:false,$27_3:true,$32_3:null,get_presenceViews:function(){IsNull(this.$32_3)&&this.set_presenceViews([]);return this.$32_3},set_presenceViews:function(value){this.$32_3=value;return value},InitPresence:function(){this.initAppGridPresence(null,null)},$4C_3:function(){if(!this.$2k_3){try{this.$O_3=createPresenceControlInstance()}catch($$e_0){}this.$2k_3=true;if(!IsNull(this.$O_3))this.$O_3.OnStatusChange=this.$$d_$7h_3}return !IsNull(this.$O_3)},$3K_3:function($p0){if(!IsNull(this.$O_3)){destroyPresenceControlInstance(this.$O_3);this.$O_3=null;this.$2k_3=false}for(var $v_0=0;$v_0<this.get_presenceViews().length;$v_0++){var $v_1=this.get_presenceViews()[$v_0];$v_1.remove_mouseOverEvent(this.$$d_$82_3);$v_1.remove_mouseOutEvent(this.$$d_$81_3);$v_1.remove_focusInEvent(this.$$d_$7y_3);$v_1.remove_focusOutEvent(this.$$d_$7z_3);$v_1.remove_keyDownEvent(this.$$d_$80_3);$v_1.dispose()}Array.clear(this.get_presenceViews())},initAppGridPresence:function(sender,e){this.$27_3=true;if(_bPresenceEnabled){this.remove_onRefresh(this.$$d_initAppGridPresence);this.add_onRefresh(this.$$d_initAppGridPresence);this.$1L_3=window.setTimeout(this.$$d_prepareEnablePresence,100)}},$7c_3:function($p0){try{this.$1L_3!==-1&&window.clearTimeout(this.$1L_3);this.$1L_3=-1;this.$27_3=false;this.$3K_3($p0)}catch($$e_1){}},$6f_3:function(){var $v_0=[];if(IsNull(this.$0_3)||this.$0_3.get_isDisposed())return $v_0;var $v_1,$v_2={};this.$u_3={};var $v_3=this.$0_3.get_element().getElementsByTagName("SPAN");for($v_1=0;$v_1<$v_3.length;$v_1++){var $v_4=$v_3[$v_1];hasSipAttribute($v_4)&&this.$5i_3($v_0,$v_2,$v_4,parseInt($v_4.getAttribute("otype")),$v_4.getAttribute("oid"))}return $v_0},$5i_3:function($p0,$p1,$p2,$p3,$p4){if(!IsNull($p3)&&IsPresenceType($p3)){if(IsNull(this.$u_3))this.$u_3={};if(IsNull(this.$u_3[$p4]))this.$u_3[$p4]=[];this.$u_3[$p4].push($p2);if($p1[$p4]!==1){$p0.push(createPresenceInfo($p4,$p2.getAttribute("sip")));$p1[$p4]=1}}},$4t_3:function($p0,$p1,$p2){var $v_0=getPresenceUri($p1),$v_1=new Mscrm.Presence.PresenceStatus;$v_1.set_status($p1);if(!IsNull(this.$u_3)){var $v_2=this.$u_3[$p0];if(!IsNull($v_2))for(var $v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3];if(!IsNull($v_4)&&$v_4.tagName.toUpperCase()==="SPAN"){var $v_5=XUI.Html.DomUtils.GetFirstChild($v_4);if(!IsNull($v_5)&&!IsNull($v_5.tagName)&&$v_5.tagName.toUpperCase()==="IMG"){$v_5.className="ms-crm-Lookup-PresenceItem";$v_5.src=$v_0}else{var $v_8='<IMG class=ms-crm-Lookup-PresenceItem alt="" src="'+CrmEncodeDecode.CrmHtmlAttributeEncode($v_0)+'">'+$v_4.innerHTML;$v_4.innerHTML=$v_8;$v_5=XUI.Html.DomUtils.GetFirstChild($v_4)}var $v_6=new Mscrm.Proxies.DomElementProxy;$v_6.set_element($v_5);var $v_7=new Mscrm.GridPresenceView;$v_7.set_element($v_6);$v_7.set_status($v_1);$v_7.initialize();$p2&&this.$5d_3($v_7)}}}this.$2F_3[$p0]=$p1},$3e_3:function($p0){this.$O_3.HideOOUI();if(!IsNull(this.$2N_3)&&!this.$2N_3&&Sys.Browser.version===6){this.$3K_3($p0);this.$4C_3()}},$4s_3:function($p0,$p1){var $v_0=$p0.target,$v_1=null;if($v_0.parentNode.tagName.toUpperCase()==="SPAN")$v_1=$v_0.parentNode.getAttribute("oid");if(!IsNull($v_1)){var $v_2=getImageLocation($v_0),$v_3=$v_2.oouiX,$v_4=$v_2.oouiY,$v_5=this.$31_3[$v_1];this.$O_3.ShowOOUI($v_5,$p1,$v_3,$v_4)}},$7h_3:function($p0,$p1,$p2){if(!IsNull(this.$2F_3))this.$2F_3[$p2]!==$p1&&this.$4t_3($p2,$p1,false)},$7x_3:function($p0){if(!this.$l_3.InscrollFunc){this.$l_3.InscrollFunc=true;this.$3e_3($p0);this.$l_3.InscrollFunc=false}!IsNull(this.$l_3.OriginalScrollFunc)&&this.$l_3.OriginalScrollFunc($p0)},prepareEnablePresence:function(){if(this.get_isDisposed()||IsNull(this.$0_3)||this.$0_3.get_isDisposed())return;this.$1L_3=-1;if(!this.$27_3||IsNull(this.get_id()))return;try{var $v_0=this.$6f_3();if($v_0.length>0&&this.$4C_3()&&!IsNull(this.$O_3)&&this.$O_3.PresenceEnabled){this.$2F_3={};this.$31_3={};if(IsNull(this.$l_3)){var $v_1=$get(this.get_id()+"_divDataArea");if(!IsNull($v_1)){this.$l_3={};this.$l_3.OriginalScrollFunc=$v_1.scroll;this.$l_3.InscrollFunc=false;$addHandler($v_1,"scroll",this.$$d_$7x_3)}}this.$63_3($v_0)}if(IsNull(this.$2N_3))this.$2N_3=$v_0.length>0}catch($v_2){if(this.$27_3)throw Error.create($v_2.message)}},$63_3:function($p0){for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=$p0[$v_0];if(!IsNull($v_1)){var $v_2=$v_1.oid,$v_3=$v_1.sipuri;if(!IsNull(this.$O_3)&&!IsNull($v_3)&&$v_3.length>0){var $v_4=this.$O_3.GetStatus($v_3,$v_2);this.$31_3[$v_2]=$v_3;this.$4t_3($v_2,$v_4,true)}}}},$5d_3:function($p0){$p0.add_mouseOverEvent(this.$$d_$82_3);$p0.add_mouseOutEvent(this.$$d_$81_3);$p0.add_focusInEvent(this.$$d_$7y_3);$p0.add_focusOutEvent(this.$$d_$7z_3);$p0.add_keyDownEvent(this.$$d_$80_3);Array.add(this.get_presenceViews(),$p0)},$80_3:function($p0,$p1){var $v_0=$p1.$t_0;$v_0.altKey&&$v_0.shiftKey&&$v_0.keyCode===121&&this.$O_3.DoAccelerator()},$7z_3:function($p0,$p1){this.$3e_3($p1.$t_0)},$7y_3:function($p0,$p1){this.$4s_3($p1.$t_0,0)},$81_3:function($p0,$p1){this.$3e_3($p1.$t_0)},$82_3:function($p0,$p1){this.$4s_3($p1.$t_0,0)}};Mscrm.EntitlementChannelInlineEditGrid=function(){this.$p_0=["{A287D65E-D9FC-49B4-873E-D35CD58BB9A9}","{68479526-2F13-49C5-AE26-12F50C057CD8}"]};Mscrm.EntitlementChannelInlineEditGrid.prototype={$1b_0:null,$4m_0:function($p0){for(var $v_0=0;$v_0<this.$p_0.length;$v_0++)if($p0.toLowerCase()===this.$p_0[$v_0].toLowerCase())return true;return false},gridPreInitialize:function(grid){if(grid.$K_0)grid.$K_0=this.$4m_0(grid.$2_0.GetParameter("viewid"));grid.$j_0=true;grid.$1u_0=false;this.$1b_0=grid},getGridCellInlineControlMode:function(grid,currentRow,attributeName){return Mscrm.InlineEditControlMode.normal},gridRowSave:function(grid,currentRow){switch(grid.$C_0){case Mscrm.EntityTypeCode.EntitlementChannel:this.$54_0(grid,Mscrm.EntityLogicalNames.EntitlementChannel,currentRow);break;case Mscrm.EntityTypeCode.EntitlementTemplateChannel:this.$54_0(grid,Mscrm.EntityLogicalNames.EntitlementTemplateChannel,currentRow);break;default:break}},$54_0:function($p0,$p1,$p2){var $v_0="{00000000-0000-0000-0000-000000000000}",$v_1=$p0.isNewRecord($p2);if(!$v_1)$v_0=$p0.getHiddenTableCellValue($p2,"oid");var $v_2=$p0.getTableCellValue($p2,"channel"),$v_3=$p0.getTableCellValue($p2,"totalterms");if(!IsNull($v_2)&&($v_1||!IsNull($v_3))){if(IsNull($v_3))$v_3=0;if(isNullOrEmptyString($v_0))$v_0="{00000000-0000-0000-0000-000000000000}";if($v_3<0){alert(window.LOCID_TOTAL_TERMS_NEGATIVE);var $v_4={};$v_4["DisplayText"]=window.LOCID_TOTAL_TERMS_NEGATIVE;var $v_5={};$v_5["_error"]=$v_4;$p0.onRowSaveFailure($v_5)}else!Mscrm.InlineEditDataService.get_busy()&&Mscrm.InlineEditDataService.createEntitlementChannel($v_1,$p0.$C_0,$p1,$v_2,$v_3,$v_0,$p0.$$d_onRowSaveSuccess,$p0.$$d_onRowSaveFailure)}else $p0.resetCurrentSaveRow()},gridRowInitialize:function(grid,currentRow){if(!IsNull(currentRow))switch(grid.$C_0){case Mscrm.EntityTypeCode.EntitlementChannel:case Mscrm.EntityTypeCode.EntitlementTemplateChannel:!IsNull(grid.$2_0)&&!IsNull(grid.$2_0.$0_3)&&grid.$2_0.$0_3.removeDblClickHandler();break}},updateControlStyle:function(attributeMetadata,inlineEditGridControl){switch(attributeMetadata.AttributeType){case "picklist":var $v_0=inlineEditGridControl.get_editView();$v_0.set_minOptionsToShow(5);break}if(attributeMetadata.LogicalName.startsWith("remainingterms")){var $v_1=inlineEditGridControl;$v_1.set_disabled(true)}},gridAttributeInitialValue:function(currentRow,grid,currentInitialValue,attributeMetadata){var $v_0=currentInitialValue;switch(attributeMetadata.LogicalName){case "channel":if(!isNullOrEmptyString(currentInitialValue)){var $v_1=attributeMetadata.LogicalName+"_rawvalue";$v_0=grid.getHiddenTableCellValue(currentRow,$v_1)}else $v_0=null;break;case "remainingterms":case "totalterms":if(isNullOrEmptyString(currentInitialValue))$v_0="0";else{var $v_2=attributeMetadata.LogicalName+"_rawvalue";$v_0=grid.getHiddenTableCellValue(currentRow,$v_2);$v_0=$v_0.replace(",",".")}break}return $v_0},gridRowSaveSuccessAction:function(grid,currentSaveRow,response){this.$2e_0(grid,currentSaveRow,response,"totalterms");this.$2e_0(grid,currentSaveRow,response,"remainingterms");this.$2e_0(grid,currentSaveRow,response,"channel");this.$8v_0(grid,currentSaveRow,response);return},$8v_0:function($p0,$p1,$p2){var $v_0="_entity";if(!($v_0 in $p2))return;var $v_1=$p2[$v_0];if(IsNull($v_1))return;this.$8s_0($p0,$p1,$v_1);return},$2e_0:function($p0,$p1,$p2,$p3){if(!($p3 in $p2))return;var $v_0=$p2[$p3],$v_1=$v_0["raw"];if(!IsNull($v_1)){var $v_2=this.$1b_0.getAttributeType($p3);switch($v_2){case "int":case "picklist":$p0.setTableCellValue($p1,$p3,parseInt($v_1),true);$p0.setHiddenTableCellValue($p1,$p3,parseInt($v_1));break;case "decimal":$p0.setTableCellValue($p1,$p3,parseFloat($v_1),true);$p0.setHiddenTableCellValue($p1,$p3,parseFloat($v_1));break;default:$p0.setTableCellValue($p1,$p3,$v_1,true);$p0.setHiddenTableCellValue($p1,$p3,$v_1);break}}},$8s_0:function($p0,$p1,$p2){var $v_0=$p2["Id"];if(IsNull($v_0))return;$p0.setHiddenTableCellValue($p1,"oid",$v_0);if($p0.isNewRecord($p1)){var $v_1=$p1.querySelector("div.ms-crm-List-DeleteContainer-Div");if(!IsNull($v_1)){var $v_2=XUI.Html.DomUtils.GetFirstChild($v_1);if(!IsNull($v_2))$v_2.id="gridBodyTable_delete_"+$p1.getAttribute("oid")+"_"+$p1.getAttribute("rowindex")}}},gridRowSaveFailureAction:function(grid,currentSaveRow,response){return}};Mscrm.ProductGridFlyOut=function(element){this.$$d_$2V_3=Function.createDelegate(this,this.$2V_3);this.$$d_$6g_3=Function.createDelegate(this,this.$6g_3);this.$$d_$5b_3=Function.createDelegate(this,this.$5b_3);this.$$d_$5V_3=Function.createDelegate(this,this.$5V_3);this.$$d_$7F_3=Function.createDelegate(this,this.$7F_3);this.$$d_onClick=Function.createDelegate(this,this.onClick);Mscrm.ProductGridFlyOut.initializeBase(this,[element]);this.$3z_3=element;var $v_0=$P_CRM(this.$3z_3.parentNode.parentNode),$v_1=$v_0.siblings(".ms-crm-Grid-Title");this.$5_3=null;this.$2u_3=false;this.$2_3=null};Mscrm.ProductGridFlyOut.prototype={$3z_3:null,$1Y_3:null,$2u_3:false,$5_3:null,$2p_3:null,$20_3:null,$45_3:null,$2_3:null,$42_3:false,ParentGridId:null,TargetEntityType:null,initialize:function(){if($P_CRM("#hiddenAddPrivilegeCheck_"+this.ParentGridId).length<=0)return;Mscrm.CrmUIControl.prototype.initialize.call(this);this.$2_3=$find(this.ParentGridId);this.$1Y_3=$P_CRM(this.$2_3.get_addContextualButton());this.$1Y_3.on("click",this.$$d_onClick)},onClick:function(eventObject){var $v_0=false,$v_1=false;this.$20_3=this.$1Y_3;this.$45_3=$P_CRM("#tdAreas");!this.$2u_3&&this.$6K_3();if(IsNull(this.$5_3))return;if(this.$7L_3()){alert(window.LOCID_PRICE_LIST_NOT_SELECTED);return}if(!this.$42_3){this.$5f_3();this.$42_3=true}this.$5_3.get_options().set_width(150);this.$58_3();$P_CRM("#GetProducts").show();$P_CRM("#WriteinProduct").show();this.$5_3.get_options().set_height(this.TargetEntityType==="opportunityproduct"?50:74);if(!IsNull(this.$2_3.get_lockPriceContextualButton()))if(this.$2_3.isPriceLocked())$v_0=true;var $v_2=$P_CRM("#hiddenOverridePricePrivilegeCheck_"+this.ParentGridId);if(IsNull($v_2)||$v_2.length<=0)$v_1=true;this.$7U_3($v_0,$v_1);this.$5_3.show(this.$20_3,this.$45_3)},$7U_3:function($p0,$p1){if($p0||$p1)if(!$p0&&$p1){$P_CRM("#WriteinProduct").hide();if(this.$5_3.get_options().get_height()===74)this.$5_3.get_options().set_height(50);else this.$5_3.get_options().get_height()===50&&this.$5_3.get_options().set_height(28)}else{$P_CRM("#WriteinProduct").hide();$P_CRM("#GetProducts").hide();this.$5_3.get_options().set_height(28)}},$58_3:function(){var $v_0=this.TargetEntityType==="opportunityproduct"?-1*150:10;this.$5_3.set_dialogLeft(this.$1Y_3.offset().left+$v_0);this.$5_3.set_dialogTop(this.$20_3.offset().top+this.$20_3.outerHeight()+10)},$6K_3:function(){this.$6J_3();this.$2u_3=true},$6J_3:function(){this.$5_3=new Mscrm.FlyOutDialog;var $v_0=this.$6L_3(),$v_1=$P_CRM($v_0);this.$5_3.setContent($v_1);this.$5_3.get_options().set_height(this.TargetEntityType==="opportunityproduct"?50:74);this.$58_3();this.$5_3.set_shouldDisposeContent(false);this.$5_3.set_position(Mscrm.FlyOutPosition.custom);this.$5_3.get_options().set_showCloseButton(false);this.$5_3.get_options().set_showButtonPane(false);this.$5_3.get_options().set_closeOnEscape(true);this.$5_3.get_options().set_applyAnchorClassChange(false);this.$5_3.get_options().set_modal(false);this.$5_3.get_options().set_letjQueryHandleTabbing(true);this.$2p_3=this.$5_3.dialogChrome()},$5f_3:function(){$P_CRM(window).resize(this.$$d_$7F_3);$P_CRM("#ExistingProduct").click(this.$$d_$5V_3);$P_CRM("#WriteinProduct").click(this.$$d_$5b_3);$P_CRM("#GetProducts").click(this.$$d_$6g_3);$P_CRM("#ExistingProduct").keypress(this.$$d_$5V_3);$P_CRM("#WriteinProduct").keypress(this.$$d_$5b_3);$P_CRM("#GetProducts").keypress(this.$$d_$6g_3);$P_CRM("body").click(this.$$d_$2V_3)},$7F_3:function($p0){this.$5_3.hide()},$2V_3:function($p0){var $v_0=$P_CRM(this.$2_3.get_addContextualButton()),$v_1=$P_CRM($p0.target),$$t_7=this,$v_2=$v_1.parents().filter(function($p1_0){return $v_1.parents().eq($p1_0).css("z-index")!=="auto"}).first().css("z-index");if(isNullOrEmptyString($v_2))$v_2="0";var $v_3=parseInt($v_2,10),$v_4=isNaN($v_3)||$v_3<=999;!IsNull(this.$2p_3)&&!this.$2p_3.has($p0.target).length&&!$v_0.is($p0.target)&&!$v_0.has($p0.target).length&&$v_4&&this.$5_3.hide()},$6L_3:function(){var $v_0=new Sys.StringBuilder;$v_0.append("<div id='ProductGridFlyout' class='productgridflyout'> <ul id='ProductFlyout'>");$v_0.append(String.format("<li id='{0}' title='{1}' tabindex='0'>{1}</li>","ExistingProduct",CrmEncodeDecode.CrmHtmlEncode(window.LOCID_FLYOUT_EXISTINGPRODUCT)));$v_0.append(String.format("<li id='{0}' title='{1}' tabindex='0'>{1}</li>","WriteinProduct",CrmEncodeDecode.CrmHtmlEncode(window.LOCID_FLYOUT_WRITEINPRODUCT)));this.TargetEntityType!=="opportunityproduct"&&$v_0.append(String.format("<li id='{0}' title='{1}' tabindex='0'>{1}</li>","GetProducts",CrmEncodeDecode.CrmHtmlEncode(window.LOCID_FLYOUT_GETPRODUCTS)));$v_0.append("</ul></div>");return $v_0.toString()},$7L_3:function(){var $v_0=Xrm.Page.data.entity.attributes.get("pricelevelid");return IsNull($v_0)||IsNull($v_0.getValue())},$5V_3:function($p0){if($p0.type==="keydown"&&$p0.which!==13)return;this.$5_3.hide();this.$2_3.addButtonClickHandler()},$5b_3:function($p0){if($p0.type==="keydown"&&$p0.which!==13)return;if(!IsNull(this.$2_3.$L_4))if(this.$2_3.$L_4.$K_0)this.$2_3.$L_4.onCreateNewRecord();else{var $v_0=this.$2_3.$L_4.$A_0;$v_0.openProductLineItemForm(this.$2_3.$L_4.$C_0,true)}this.$5_3.hide()},$6g_3:function($p0){if($p0.type==="keydown"&&$p0.which!==13)return;this.$5_3.hide();this.TargetEntityType!=="opportunityproduct"&&getProducts()},dispose:function(){if(this.get_isDisposed())return;$P_CRM(window).unbind("resize",this.$$d_$7F_3);this.$1Y_3.off("click",this.$$d_onClick);$P_CRM("body").unbind("click",this.$$d_$2V_3);this.$5_3.unbind();this.$5_3.dispose();Mscrm.CrmUIControl.prototype.dispose.call(this)}};Mscrm.BeforeRefreshEventArgs=function(){Mscrm.BeforeRefreshEventArgs.initializeBase(this)};Mscrm.BeforeRefreshEventArgs.prototype={breakEvent:false};Mscrm.ChangePageEventArgs=function(newPageNumber,currentPageNumber){Mscrm.ChangePageEventArgs.initializeBase(this);this.newPageNumber=newPageNumber;this.currentPageNumber=currentPageNumber};Mscrm.ChangePageEventArgs.prototype={newPageNumber:0,currentPageNumber:0,breakEvent:false};Mscrm.GridControlLite=function(element){this.$$d_$72_4=Function.createDelegate(this,this.$72_4);this.$$d_$4E_4=Function.createDelegate(this,this.$4E_4);this.$$d_$64_4=Function.createDelegate(this,this.$64_4);this.$$d_$87_4=Function.createDelegate(this,this.$87_4);this.$$d_$89_4=Function.createDelegate(this,this.$89_4);this.$$d_$6y_4=Function.createDelegate(this,this.$6y_4);this.$$d_$73_4=Function.createDelegate(this,this.$73_4);this.$$d_$4Y_4=Function.createDelegate(this,this.$4Y_4);this.$$d_unlockPrice=Function.createDelegate(this,this.unlockPrice);this.$$d_lockPrice=Function.createDelegate(this,this.lockPrice);this.$$d_MoveRecordDownLite=Function.createDelegate(this,this.MoveRecordDownLite);this.$$d_MoveRecordUpLite=Function.createDelegate(this,this.MoveRecordUpLite);this.$$d_$6w_4=Function.createDelegate(this,this.$6w_4);this.$$d_$6x_4=Function.createDelegate(this,this.$6x_4);this.$7_4=$find("SubGridCommandBarData");this.$S_4=-1;Mscrm.GridControlLite.initializeBase(this,[element])};Mscrm.GridControlLite.moreActivitiesButton=function(menuId){var $v_0=Mscrm.CrmUIComponent.crmCreate(Mscrm.ActivityCommandBarButton,null,null,null,$get(menuId));return $v_0};Mscrm.GridControlLite.openActivityMenu=function(menuId){Mscrm.GridControlLite.moreActivitiesButton(menuId).get_menu().processAndShowMenu()};Mscrm.GridControlLite.DeleteRecordLite=function(deleteButton){var $v_0=Mscrm.GridControl.getControlBehaviorFromChildElement(deleteButton),$v_1=$v_0.GetParameter("deleteAction");if(isNullOrEmptyString($v_1))return;$v_0.$0_3.UnselectRecords(null);var $v_2=deleteButton.parentNode.parentNode.parentNode.sectionRowIndex;$v_0.$0_3.SelectRecords($v_2,$v_2,true);$v_0.$3V_4($v_1);$v_0.updatePageNumberOnLastRecordDelete();var $v_3=parseInt($v_0.GetParameter("otc"));Mscrm.Grid.auto($v_3,null)};Mscrm.GridControlLite.ShowDeleteButton=function(rowElement){if(!Mscrm.GridControlLite.$3L)return;var $v_0=-1,$v_1=rowElement.getAttribute("rowindex");if(!IsNull($v_1)&&$v_1!==-1)$v_0=$v_1;else $v_0=rowElement.sectionRowIndex;var $v_2="gridBodyTable_delete_"+rowElement.getAttribute("oid")+"_"+$v_0,$v_3="gridBodyTable_gridDelBtn_"+$v_0,$v_4=$get($v_2),$v_5=$get($v_3);if(IsNull($v_4))return;var $v_6=Mscrm.GridControl.getControlBehaviorFromChildElement(XUI.Html.DomUtils.GetFirstChild($v_4));if(!isNullOrEmptyString($v_6.GetParameter("enableContextualActions"))&&$v_6.GetParameter("enableContextualActions").toLowerCase()==="false")return;var $v_7=Mscrm.GridControlLite.$6T($v_6);if(isNullOrEmptyString($v_7)){if(!IsNull($v_5))if(!IsNull($v_5.attributes.getNamedItem("title")))$v_5.attributes.getNamedItem("title").value="";return}$v_6.SetParameter("deleteAction",$v_7);var $v_8=Mscrm.GridControlLite.$6P($v_6);if(window.LOCID_UI_DIR==="RTL")$v_4.style.left=$v_8.toString()+"px";else $v_4.style.right=$v_8.toString()+"px";$v_4.parentNode.style.display="inline";$v_4.parentNode.style.display="block";$v_4.style.visibility="visible";var $v_9=XUI.Html.GetComputedStyle($v_4.parentNode.parentNode.parentNode,"backgroundColor");if($v_9==="transparent")$v_9="#FFFFFF";$v_4.style.backgroundColor=$v_9};Mscrm.GridControlLite.HideDeleteButton=function(rowElement){var $v_0=-1,$v_1=rowElement.getAttribute("rowindex");if(!IsNull($v_1)&&$v_1!==-1)$v_0=$v_1;else $v_0=rowElement.sectionRowIndex;var $v_2="gridBodyTable_delete_"+rowElement.getAttribute("oid")+"_"+$v_0,$v_3=$get($v_2);if(IsNull($v_3))return;var $v_4=Mscrm.GridControl.getControlBehaviorFromChildElement(XUI.Html.DomUtils.GetFirstChild($v_3));if(IsNull($v_4))return;var $v_5=$v_4.GetParameter("deleteAction");if(isNullOrEmptyString($v_5))return;$v_3.style.visibility="hidden"};Mscrm.GridControlLite.SelectRow=function(rowElement){var $v_0=Mscrm.GridControl.getControlBehaviorFromChildElement(rowElement);if(IsNull($v_0)||!($v_0.isProductGrid()||$v_0.isMovableRowsGrid()||$v_0.isEntitlementChannelGrid()))return;Mscrm.GridControlLite.onSelectRow($v_0,rowElement.sectionRowIndex)};Mscrm.GridControlLite.onSelectRow=function(grid,rowIndex){var $v_0=$P_CRM(grid.get_element()).find("#"+grid.get_element().id+"_divDataArea table tr.ms-crm-List-Row-Lite,#"+grid.get_element().id+"_divDataArea table tr.ms-crm-List-SelectedRow-Lite");$v_0.attr("style","");var $v_1=$v_0[rowIndex];if(!IsNull($v_1)){$v_1.setAttribute("style","background-color:#b1d6f0");grid.$S_4=$v_1.sectionRowIndex;var $v_2=grid.get_allRecords().length-1;if(grid.$S_4<=0){if(!IsNull(grid.get_moveUpContextualButton()))grid.get_moveUpContextualButton().className="ms-crm-ImageStrip-moveUpButtonDisabled"}else if(!IsNull(grid.get_moveUpContextualButton()))grid.get_moveUpContextualButton().className="ms-crm-ImageStrip-moveUpButton";if(grid.$S_4<$v_2){if(!IsNull(grid.get_moveDownContextualButton()))grid.get_moveDownContextualButton().className="ms-crm-ImageStrip-moveDownButton"}else if(!IsNull(grid.get_moveDownContextualButton()))grid.get_moveDownContextualButton().className="ms-crm-ImageStrip-moveDownButtonDisabled"}};Mscrm.GridControlLite.recalculateRecord=function(){!Mscrm.InlineEditDataService.get_busy()&&Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.RecalculateRecord,null)};Mscrm.GridControlLite.handleTabStateForReadForm=function(value,handler){var $v_0=$get("rofContainer");if(!IsNull($v_0)){var $v_1=Mscrm.GridSpanControl.getTabRead(value),$v_2=Mscrm.GridControl.getExpanderClassName($v_1);if(!IsNull($v_1)&&!isNullOrEmptyString($v_2)&&$v_2.endsWith("_right")){var $v_3=$P_CRM($v_1);if(!IsNull($v_3)){var $v_4={};$v_4["tabExpander"]=$v_1;$v_4["controlObject"]=value;$v_4["expanderObject"]=$v_3;$v_3.bind(Mscrm.EventNames.inlineTabStateChange,$v_4,handler)}}}};Mscrm.GridControlLite.$6P=function($p0){var $v_0=$get($p0.get_id()+"_divDataArea"),$v_1=$v_0.offsetWidth,$v_2=XUI.Html.DomUtils.GetFirstChild(XUI.Html.DomUtils.GetFirstChild($v_0)).offsetWidth,$v_3=$v_2-$v_1-$v_0.scrollLeft,$v_4=$p0;if($v_4.isProductGrid())$v_3=$v_3+15;return $v_3>0?$v_3-1:0};Mscrm.GridControlLite.$6T=function($p0){var $v_0=$p0.$6S_4();if($p0.GetParameter("viewid")==="{F79AD170-AE03-4F4C-8132-D4AA08520A0C}")if(!Mscrm.SessionInfo.isOutlookClient()||Mscrm.SessionInfo.isOnline())$v_0="AccessTeamMemberDeleteAction";if($p0.GetParameter("viewid")==="{FE4BC089-8901-466C-A41B-1C1090F204D4}")if(Mscrm.SessionInfo.isOutlookClient()&&!Mscrm.SessionInfo.isOnline())$v_0="";return $v_0};Mscrm.GridControlLite.prototype={$e_4:null,$2I_4:null,$2t_4:null,$I_4:null,$2H_4:null,$L_4:null,$1w_4:null,$1v_4:null,$y_4:"",$3M_4:true,$1U_4:"",$3O_4:true,$1S_4:"",$3N_4:true,$3P_4:false,$4j_4:false,get_selectedRowIndex:function(){return this.$S_4},set_selectedRowIndex:function(value){this.$S_4=value;return value},get_getRelationshipTypeName:function(){var $v_0=this.get_ribbonRelationshipType();switch($v_0){case 0:return "NoRelationship";case 1:return "OneToMany";case 2:return "ManyToMany"}return "NoRelationship"},get_$2Y_4:function(){var $v_0=Mscrm.CrmUri.create(window.location.href);if($v_0.get_query()["dashboardType"])return true;return false},get_addContextualButton:function(){var $v_0=this.get_id()+"_addImageButton";return $get($v_0)},get_inlineEditGridControls:function(){return this.$L_4},get_lockPriceContextualButton:function(){var $v_0=this.get_id()+"_lockImageButton";return $get($v_0)},get_unlockPriceContextualButton:function(){var $v_0=this.get_id()+"_unlockImageButton";return $get($v_0)},get_moveUpContextualButton:function(){var $v_0=this.get_id()+"_upImageButton";return $get($v_0)},get_moveDownContextualButton:function(){var $v_0=this.get_id()+"_downImageButton";return $get($v_0)},get_openAssociatedGridViewButton:function(){var $v_0=this.get_id()+"_openAssociatedGridViewImageButton";return $get($v_0)},refreshLiteSubGrid:function(){this.RefreshGridAndClearPaging();this.HandleGridResize()},openNewActivityCreateFormInline:function(activityTypeCode){if(!this.get_$2Y_4()){var $v_0=this.getFormData(),$v_1=Xrm.Internal.getEntityCode($v_0.get_typeName());Mscrm.AddActivity.addActivityToFormFromsubgrid(activityTypeCode,$v_0.get_recordId(),$v_1)}else openObj(activityTypeCode,null,"",null,Mscrm.NavigationMode.NavigationModeNewWindow,null)},initialize:function(){this.$4j_4=true;this.$3P_4=false;var $v_0=this.getFormData(),$v_1=null,$$t_5=this;$v_1=function($p1_0){$$t_5.refreshLiteSubGrid()};$v_0&&$v_0.addOnRecordIdChanged($v_1,false);this.get_eventManager().subscribeEvent(Mscrm.ScriptEvents.ReloadCommandBar,this.get_id());Mscrm.GridControl.prototype.initialize.call(this);if(!IsNull(this.get_openAssociatedGridViewButton())&&this.$1q_4()){!IsNull(this.$$d_$6x_4)&&$addHandler(this.get_openAssociatedGridViewButton(),"mouseover",this.$$d_$6x_4);!IsNull(this.$$d_$6w_4)&&$addHandler(this.get_openAssociatedGridViewButton(),"mouseout",this.$$d_$6w_4)}if(this.$q_4())this.$4x_4();else{var $v_2="titleContainer_",$v_3=$get($v_2+this.get_element().id);$v_3&&$v_3.removeAttribute("height")}if(!IsNull(this.get_moveUpContextualButton())){$addHandler(this.get_moveUpContextualButton(),"click",this.$$d_MoveRecordUpLite);$addHandler(this.get_moveUpContextualButton(),"mouseover",this.$$d_$6x_4);$addHandler(this.get_moveUpContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_moveDownContextualButton())){$addHandler(this.get_moveDownContextualButton(),"click",this.$$d_MoveRecordDownLite);$addHandler(this.get_moveDownContextualButton(),"mouseover",this.$$d_$6x_4);$addHandler(this.get_moveDownContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_lockPriceContextualButton())){$addHandler(this.get_lockPriceContextualButton(),"click",this.$$d_lockPrice);$addHandler(this.get_lockPriceContextualButton(),"mouseover",this.$$d_$6x_4);$addHandler(this.get_lockPriceContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_unlockPriceContextualButton())){$addHandler(this.get_unlockPriceContextualButton(),"click",this.$$d_unlockPrice);$addHandler(this.get_unlockPriceContextualButton(),"mouseover",this.$$d_$6x_4);$addHandler(this.get_unlockPriceContextualButton(),"mouseout",this.$$d_$6w_4)}!IsNull(this.get_moveUpContextualButton())&&!IsNull(this.get_moveDownContextualButton())&&$addHandler(this.get_element(),"keyup",this.$$d_$4Y_4);if(this.$1q_4()){!IsNull(this.get_openAssociatedGridViewButton().attributes.getNamedItem("action"))&&(!IsNull(this.get_openAssociatedGridViewButton().attributes.getNamedItem("assocView"))||!IsNull(this.get_openAssociatedGridViewButton().attributes.getNamedItem("nonRelationShipGrid")))&&$addHandler(this.get_openAssociatedGridViewButton(),"click",this.$$d_$73_4);this.$3r_4(true)}},$4x_4:function(){if(this.$3P_4||!this.$4j_4)return;$addHandler(this.get_addContextualButton(),"mouseover",this.$$d_$6x_4);$addHandler(this.get_addContextualButton(),"mouseout",this.$$d_$6w_4);if(!IsNull(this.get_addContextualButton().attributes.getNamedItem("action"))){var $v_0=this.get_addContextualButton().attributes.getNamedItem("action").value;if(this.isProductGrid())this.$5S_4();else if(this.isEntitlementChannelGrid())this.$5Q_4();else if($v_0==="QuickAdd"&&this.get_gridType()===Mscrm.GridControl.inlineSubGrid)this.activateQuickAdd();else $addHandler(this.get_addContextualButton(),"click",this.$$d_$6y_4)}this.$3q_4(true);this.$3P_4=true},handleEvent:function(eventCode,parameters,sourceComponent){if(eventCode===Mscrm.ScriptEvents.ReloadCommandBar){var $v_0=this.getFormData(),$v_1="";if(!IsNull($v_0))$v_1=$v_0.get_recordId();!isNullOrEmptyString($v_1)&&this.refreshLiteSubGrid()}return Mscrm.GridControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent)},$73_4:function($p0){var $v_0=this.get_openAssociatedGridViewButton().attributes.getNamedItem("action").value;this.$3V_4($v_0)},$6y_4:function($p0){var $v_0=this.get_addContextualButton().attributes.getNamedItem("action").value;this.$3V_4($v_0)},$3V_4:function($p0){if($p0==="ActivityAddAction"){Mscrm.GridControlLite.openActivityMenu(this.get_id()+"moreActivitiesButton");return}if($p0==="AccessTeamMemberDeleteAction"){this.$8P_4(this.get_selectedIds()[0],this.GetParameter("teamTemplateId"));return}if(!IsNull(this.$7_4)){var $v_0=this.$7_4.get_selectedControl();this.$7_4.setCurrentSelectedControl(this);this.$7_4.executeCommand($p0,null);this.$7_4.setCurrentSelectedControl($v_0)}},$8P_4:function($p0,$p1){var $$t_5=this,$$t_6=this;Mscrm.InlineEditDataService.removeUserFromRecordAccessTeam($p0,$p1,function(){$$t_5.Refresh();return true},function($p1_0){var $v_0=$p1_0["_error"],$v_1=!IsNull($v_0)?$v_0["DisplayText"]:"";openErrorDlg(null,$v_1,null,-1,-1);return true})},$6N_4:function(){if(!this.$3M_4)return this.$y_4;this.$3M_4=false;this.$y_4=null;if(!IsNull(this.$7_4)){var $v_0=$find("crmRibbonData");!IsNull($v_0)&&!IsNull($v_0.get_primaryControl())&&this.$7_4.set_primaryControl($v_0.get_primaryControl());var $v_1=this.get_getRelationshipTypeName();if(this.get_entityTypeCode()===Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer){this.$y_4="ActivityAddAction";return this.$y_4}var $v_2=new Mscrm.AddExistingStandardAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4)){$v_2=new Mscrm.AddNewProductAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4)){$v_2=new Mscrm.AddNewStandardAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4)){$v_2=new Mscrm.AddExistingAssocAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4)){$v_2=new Mscrm.NewRecordAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4))return this.$y_4}}}}this.$y_4=$v_2.get_commandBarCommandId();return this.$y_4}return this.$y_4},$6e_4:function(){if(!this.$3O_4)return this.$1U_4;this.$3O_4=false;this.$1U_4=null;if(!IsNull(this.$7_4)){var $v_0=$find("crmRibbonData");!IsNull($v_0)&&!IsNull($v_0.get_primaryControl())&&this.$7_4.set_primaryControl($v_0.get_primaryControl());var $v_1=this.get_getRelationshipTypeName(),$v_2=new Mscrm.OpenAssociatedGridViewStandardAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4))return this.$1U_4;this.$1U_4=$v_2.get_commandBarCommandId();return this.$1U_4}return this.$1U_4},$6S_4:function(){if(!this.$3N_4)return this.$1S_4;this.$3N_4=false;this.$1S_4=null;if(!IsNull(this.$7_4)){this.$7_4.setCurrentSelectedControl(this);var $v_0=$find("crmRibbonData");!IsNull($v_0)&&this.$7_4.set_primaryControl($v_0.get_primaryControl());var $v_1=this.get_getRelationshipTypeName(),$v_2=new Mscrm.DeleteAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4)){$v_2=new Mscrm.RemoveAction(this.get_entityTypeName(),$v_1);if(!$v_2.isActionVisibleAndEnabled(this.$7_4))if(!$v_2.isActionVisibleAndEnabled(this.$7_4))return this.$1S_4}this.$1S_4=$v_2.get_commandBarCommandId();return this.$1S_4}return this.$1S_4},dispose:function(){if(this.get_isDisposed())return;if(Mscrm.GridControl.isBrowserIE8OrLower())try{$removeHandler(document.body,"resize",this.$$d_handleAutoExpandRows)}catch($$e_0){}!IsNull(this.get_addContextualButton())&&$clearHandlers(this.get_addContextualButton());!IsNull(this.$I_4)&&this.$I_4.dispose();!IsNull(this.$2t_4)&&this.$2t_4.dispose();!IsNull(this.$2H_4)&&this.$2H_4.dispose();!IsNull(this.$L_4)&&this.$L_4.dispose();if(!IsNull(this.get_moveUpContextualButton())){$removeHandler(this.get_moveUpContextualButton(),"click",this.$$d_MoveRecordUpLite);$removeHandler(this.get_moveUpContextualButton(),"mouseover",this.$$d_$6x_4);$removeHandler(this.get_moveUpContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_moveDownContextualButton())){$removeHandler(this.get_moveDownContextualButton(),"click",this.$$d_MoveRecordDownLite);$removeHandler(this.get_moveDownContextualButton(),"mouseover",this.$$d_$6x_4);$removeHandler(this.get_moveDownContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_lockPriceContextualButton())){$removeHandler(this.get_lockPriceContextualButton(),"click",this.$$d_lockPrice);$removeHandler(this.get_lockPriceContextualButton(),"mouseover",this.$$d_$6x_4);$removeHandler(this.get_lockPriceContextualButton(),"mouseout",this.$$d_$6w_4)}if(!IsNull(this.get_unlockPriceContextualButton())){$removeHandler(this.get_unlockPriceContextualButton(),"click",this.$$d_unlockPrice);$removeHandler(this.get_unlockPriceContextualButton(),"mouseover",this.$$d_$6x_4);$removeHandler(this.get_unlockPriceContextualButton(),"mouseout",this.$$d_$6w_4)}!IsNull(this.get_moveUpContextualButton())&&!IsNull(this.get_moveDownContextualButton())&&$removeHandler(this.get_element(),"keyup",this.$$d_$4Y_4);Mscrm.GridControl.prototype.dispose.call(this)},ShowLoadingMessage:function(){this.$2B_3="<TABLE class='ms-crm-List-Message-Lite' morerecords='0'><TR><TD ID='GridLoadingMessage' class='ms-crm-List-MessageText-Lite'>{0}<IMG alt='' src='/_imgs/grid/HorzPreloader_5x55.gif'></TD></TR></TABLE>";Mscrm.GridControl.prototype.ShowLoadingMessage.call(this);this.$3q_4(false);this.$3r_4(false)},MoveRecordUpLite:function(eventObject){if(this.$S_4<0)return;var $v_0=$P_CRM(this.get_element()).find("#"+this.get_element().id+"_divDataArea table tr.ms-crm-List-Row-Lite,#"+this.get_element().id+"_divDataArea table tr.ms-crm-List-SelectedRow-Lite")[this.$S_4];if(IsNull($v_0))return;var $v_1=$v_0,$v_2=$P_CRM($v_1),$v_3=$v_2.attr("sequencenumber");if(this.$S_4>0){$v_2.attr("sequencenumber",$v_2.prev().attr("sequencenumber"));$v_2.prev().attr("sequencenumber",$v_3);$v_2.insertBefore($v_2.prev());Mscrm.GridControlLite.onSelectRow(this,this.$S_4-1)}},MoveRecordDownLite:function(eventObject){var $v_0=null;$v_0=$P_CRM(this.get_element()).find("#"+this.get_element().id+"_divDataArea table tr.ms-crm-List-Row-Lite,#"+this.get_element().id+"_divDataArea table tr.ms-crm-List-SelectedRow-Lite")[this.$S_4];if(IsNull($v_0))return;var $v_1=$v_0,$v_2=$P_CRM($v_1),$v_3=this.get_allRecords().length-1,$v_4=$v_2.attr("sequencenumber");if(this.$S_4<$v_3){$v_2.attr("sequencenumber",$v_2.next().attr("sequencenumber"));$v_2.next().attr("sequencenumber",$v_4);$v_2.insertAfter($v_2.next());Mscrm.GridControlLite.onSelectRow(this,this.$S_4+1)}},isPriceLocked:function(){var $v_0=this.getFormData(),$v_1=true;if(!IsNull($v_0.get_attributes().get("ispricelocked"))&&!IsNull($v_0.get_attributes().get("ispricelocked").get_value()))$v_1=$v_0.get_attributes().get("ispricelocked").get_value();return $v_1},lockPrice:function(eventObject){lock()},unlockPrice:function(eventObject){unlock()},displayProductGridButtons:function(showButtons){Mscrm.GridControlLite.$3L=showButtons;var $v_0=showButtons?"block":"none";if(this.isPriceLocked())this.$9_4(this.get_unlockPriceContextualButton(),$v_0);else this.$9_4(this.get_lockPriceContextualButton(),$v_0);this.$9_4(this.get_moveUpContextualButton(),$v_0);this.$9_4(this.get_moveDownContextualButton(),$v_0)},Refresh:function(){if(window._IsRefreshForm==="1"){this.$3M_4=true;this.$3O_4=true;this.$3N_4=true;var $v_0=this.getFormData(),$v_1=$v_0.get_recordId(),$v_2=this.$3R_4(),$v_3=$get(this.get_id()+"_quickFindControl"),$v_4=$get(this.get_id()+"_addImageButton"),$v_5=$get(this.get_id()+"_openAssociatedGridViewImageButton"),$v_6=$get(this.get_id()+"_SavedNewQuerySelector"),$v_7=$find(this.get_id()+"_SavedNewQuerySelector"),$v_8=$get(this.get_id()+"_findCriteria");if(isNullOrEmptyString($v_1)||isNullOrEmptyString($v_2)){$v_4&&this.$9_4($v_4,"none");$v_5&&this.$9_4($v_5,"none");$v_3&&this.$9_4($v_3,"none");this.$9_4(this.get_moveDownContextualButton(),"none");this.$9_4(this.get_moveUpContextualButton(),"none");this.$9_4(this.get_lockPriceContextualButton(),"none");this.$9_4(this.get_unlockPriceContextualButton(),"none");this.set_disabled(true);this.$1Q_3=true;!IsNull($v_7)&&$v_7.set_disabled(true);if(!IsNull($v_6)){$v_6.className+=" ms-crm-view-name-disabled";XUI.Html.DomUtils.GetFirstChild($v_6).style.cursor="default"}if(!IsNull($v_8))$v_8.disabled=true;var $v_9=window.LOCID_EMPTY_GRID_MESSAGE_REFRESH;$get(this.get_id()+"_divDataArea").innerHTML=String.format('<div class="ms-crm-grid-Title-Data-Lite">{0}</div><div style="height: 16px;"></div>',CrmEncodeDecode.CrmHtmlEncode($v_9));return}else{this.set_disabled(false);this.$1Q_3=false;!IsNull($v_7)&&$v_7.addHandlers();if(!IsNull($v_6)){XUI.Html.DomUtils.GetFirstChild($v_6).style.cursor="pointer";$v_6.className=$v_6.className.replace(" ms-crm-view-name-disabled","")}if(!IsNull($v_8))$v_8.disabled=false;Mscrm.GridControl.setElementParameter(this.get_element(),"oId",$v_1);Mscrm.GridControl.setElementParameter(this.get_element(),"oType",$v_2);if($v_4){if(this.get_gridType()===Mscrm.GridControl.inlineSubGrid&&this.$q_4()){this.$9_4($v_4,"block");this.$4x_4()}else this.$9_4($v_4,"none");if(this.isProductGrid()||this.isMovableRowsGrid()){this.$1Q_3=false;if(this.isPriceLocked())this.$9_4(this.get_unlockPriceContextualButton(),"block");else this.$9_4(this.get_lockPriceContextualButton(),"block");this.$9_4(this.get_moveUpContextualButton(),"block");this.$9_4(this.get_moveDownContextualButton(),"block")}}$v_5&&this.$1q_4()&&this.$9_4($v_5,"block");$v_3&&this.$9_4($v_3,"inline")}}else if(this.get_$2Y_4()){var $v_A=$get(this.get_id()+"_addImageButton"),$v_B=$get(this.get_id()+"_openAssociatedGridViewImageButton");$v_A&&this.$q_4()&&this.$9_4($v_A,"block");$v_B&&this.$1q_4()&&this.$9_4($v_B,"block")}Mscrm.GridControl.prototype.Refresh.call(this)},getLoadingMessage:function(){return window.LOCID_LOADING_GRID_DATA_REFRESH},getDataAreaStyle:function(){return "hidden"},onRefreshComplete:function(result,command){this.$2K_3=result;this.$2J_3=command;if(Mscrm.Utilities.isRefreshForm()){this.$2X_4(this.isProductGrid(),0);this.$2X_4(this.isEntitlementChannelGrid(),2);this.$2X_4(this.isMovableRowsGrid(),1)}this.$7i_4()},resetComplete:function(resultCommand){var $v_0=Mscrm.GridControl.prototype.resetComplete.call(this,resultCommand);this.$2X_4(this.isProductGrid(),0);return $v_0},finishShowLoadingMessage:function(){Mscrm.GridControl.prototype.finishShowLoadingMessage.call(this);this.$3q_4(true);this.$3r_4(true)},activateControls:function(){Mscrm.GridControl.prototype.activateControls.call(this);this.ActivateAdd()},displayFailedMessage:function(){this.$1M_3="<TABLE class='ms-crm-List-Message-Lite' morerecords='0'><TR><TD ID='GridMessage' class='ms-crm-List-MessageText-Lite'>{0}<BR><A tabIndex=\"{1}\" class='ms-crm-List-Message-Link-Lite' id='GridRefreshLink' onclick=\"Mscrm.GridControl.getControlBehaviorFromChildElement(this).refreshLiteSubGrid();\" href=\"javascript:void(0)\">{2}</A></TD></TR></TABLE>";this.setGridData(String.format(this.$1M_3,CrmEncodeDecode.CrmHtmlEncode(window.LOCID_LOADING_GRID_FAILED),this.$1H_3,CrmEncodeDecode.CrmHtmlEncode(LOCID_GRID_REFRESH_TRY_AGAIN.toString())),true)},fireGridEvents:function(command){Mscrm.GridControl.prototype.fireGridEvents.call(this,command);this.$8A_4(command)},cacheValidation:function(currentViewTimestamp,updatedViewTimestamp){if(window._IsRefreshForm==="1"&&this.get_gridType()===Mscrm.GridControl.inlineSubGrid){var $v_0=this.isSubGridStale(currentViewTimestamp,updatedViewTimestamp);if($v_0){this.$7J_4(updatedViewTimestamp);return false}}return true},isAutoSubGrid:function(){var $v_0=this.GetParameter("subgridAutoExpand")==="1";return $v_0&&this.$28_3},updateVisibility:function(totalRecordCount,recordsPerPage,statusBar){if(!IsNull(statusBar)&&this.get_gridType()===Mscrm.GridControl.inlineSubGrid){if(totalRecordCount>recordsPerPage||totalRecordCount<0&&recordsPerPage>0)statusBar.style.visibility="visible";else if(!this.$0_3.get_moreRecords())statusBar.style.visibility="hidden";this.handleStatusBar()}},$7J_4:function($p0){var $v_0=this.get_id()+"_crmGridTD",$v_1=$get($v_0),$v_2=this.get_id(),$v_3=$v_1.getAttribute("URL");this.$0_3.dispose();this.dispose();$v_1.innerHTML="";$v_3=Mscrm.GridControl.getUpdatedUrl($v_3,"viewts",$p0);Mscrm.GridControl.loadGridView($v_0,$v_2,$v_3,"",true)},$8A_4:function($p0){if(!this.isLiteSubGrid())return;if(!this.GetParameter("deleteAction"))return;var $v_0=this.GetParameter("deleteAction").toString();if(isNullOrEmptyString($v_0))return;if(!IsNull($p0)&&!IsNull(this.$0_3)){var $v_1={};$v_1["command"]=1;$v_1["recordCount"]=this.$0_3.get_totalRecordCount().toString();$v_1["viewId"]=this.GetParameter("viewid");$v_1["entitytypecode"]=this.get_entityTypeCode();$v_1["relationshipName"]=this.GetParameter("relName");this.raiseEvent(Mscrm.ScriptEvents.GridContextualAction,$v_1)}},activateQuickAdd:function(){var $v_0="#titleContainer_";if(!this.isLiteSubGrid())return;var $v_1=$P_CRM($v_0+this.get_element().id);if(!$v_1.length)return;var $v_2=$P_CRM("#quick_add_hidden_div",$v_1);if(!IsNull($v_2)&&$v_2.length>0){var $v_3=$P_CRM("#_"+this.get_element().id+"[dummy-data-attributename]",$v_2).first();if(!IsNull($v_3)&&$v_3.length>0){this.$e_4={};this.$e_4["AttributeId"]=this.get_element().id;this.$e_4["TargetEntityType"]=$v_2.attr("TargetEntityType");this.$e_4["ParentGridId"]=this.get_id();var $v_4=$v_2.attr("ConnectionToEntity");this.$e_4["ConnectionToEntity"]=$v_4;this.$e_4["ConnectionToCategory"]=$v_2.attr("ConnectionToCategory");this.$e_4["IsInvokedFromProductFlyOut"]=false;this.$e_4["IsInvokedFromQuickAdd"]=true;this.$e_4["TeamTemplateId"]=this.GetParameter("teamTemplateId");$addHandler(this.get_addContextualButton(),"click",this.$$d_$89_4);if($v_4===Mscrm.EntityLogicalNames.Contact||$v_4===Mscrm.EntityLogicalNames.SystemUser){var $v_5={};$v_5["ParentGridId"]=this.get_id();$v_5["ConnectionToCategory"]=$v_2.attr("ConnectionToCategory");this.$2t_4=Mscrm.CrmUIComponent.crmCreate(Mscrm.InlineEditDropDownFlyOut,$v_5,null,null,this.get_addContextualButton())}}}},$5S_4:function(){var $v_0="#titleContainer_";if(!this.isLiteSubGrid())return;var $v_1=$P_CRM($v_0+this.get_element().id);if(!$v_1.length)return;var $v_2=$P_CRM("#quick_add_hidden_div",$v_1);if(!IsNull($v_2)&&$v_2.length>0){this.$2I_4={};this.$2I_4["ParentGridId"]=this.get_id();this.$2I_4["TargetEntityType"]=$v_2.attr("TargetEntityType");$addHandler(this.get_addContextualButton(),"click",this.$$d_$87_4)}},$5Q_4:function(){$addHandler(this.get_addContextualButton(),"click",this.$$d_$64_4)},$64_4:function($p0){this.$L_4.onCreateNewRecord()},$87_4:function($p0){this.$2H_4=Mscrm.CrmUIComponent.crmCreate(Mscrm.ProductGridFlyOut,this.$2I_4,null,null,this.get_addContextualButton());this.$2H_4.onClick(null);$removeHandler(this.get_addContextualButton(),"click",this.$$d_$87_4)},isProductGrid:function(){var $v_0=Mscrm.GridControl.prototype.isProductGrid.call(this);if(this.$q_4()){var $v_1=this.get_addContextualButton().attributes.getNamedItem("action"),$v_2=!IsNull($v_1)?this.get_addContextualButton().attributes.getNamedItem("action").value:"";return this.get_gridType()===Mscrm.GridControl.inlineSubGrid&&($v_0||$v_2.indexOf("AddNewProductFromSubGridStandard")>-1)}return $v_0},$89_4:function($p0){this.$I_4=Mscrm.CrmUIComponent.crmCreate(Mscrm.QuickAddFlyOut,this.$e_4,null,null,this.get_addContextualButton());this.$I_4.onClick(null);$removeHandler(this.get_addContextualButton(),"click",this.$$d_$89_4)},addButtonClickHandler:function(){if(this.get_gridType()===Mscrm.GridControl.inlineSubGrid&&this.get_entityTypeCode()===Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer){Mscrm.GridControlLite.openActivityMenu(this.get_id()+"moreActivitiesButton");return}if(this.get_$2Y_4())return;if(IsNull(this.$I_4)){var $v_0=this.isProductGrid();this.$5p_4($v_0)}this.$I_4.onClick(null)},$5p_4:function($p0){var $v_0="#titleContainer_";if(!this.isLiteSubGrid()||this.get_$2Y_4())return;var $v_1=$P_CRM($v_0+this.get_element().id);if(!$v_1.length)return;var $v_2=$P_CRM("#quick_add_hidden_div",$v_1);this.$I_4=new Mscrm.QuickAddFlyOut(this.get_addContextualButton());this.$I_4.AttributeId=this.get_element().id;this.$I_4.TargetEntityType=$v_2.attr("TargetEntityType");this.$I_4.ParentGridId=this.get_id();var $v_3=$v_2.attr("ConnectionToEntity");this.$I_4.ConnectionToEntity=$v_3;this.$I_4.ConnectionToCategory=$v_2.attr("ConnectionToCategory");this.$I_4.IsInvokedFromProductFlyOut=$p0;this.$I_4.TeamTemplateId=this.GetParameter("teamTemplateId");this.$I_4.initialize()},$q_4:function(){if(!IsNull(this.get_addContextualButton()))if(!IsNull(this.get_addContextualButton().attributes.getNamedItem("action"))&&this.get_addContextualButton().attributes.getNamedItem("action").value==="QuickAdd")return true;else{var $v_0=this.$6N_4();if(!isNullOrEmptyString($v_0)){this.get_addContextualButton().attributes.getNamedItem("action").value=$v_0;return true}}return false},$1q_4:function(){if(!IsNull(this.get_openAssociatedGridViewButton())){if(this.GetParameter("viewid")==="{F79AD170-AE03-4F4C-8132-D4AA08520A0C}")return false;if(IsNull(this.get_openAssociatedGridViewButton().attributes.getNamedItem("action")))return true;else{var $v_0=this.$6e_4(),$v_1=this.getFormData();if(!isNullOrEmptyString($v_0)){this.get_openAssociatedGridViewButton().attributes.getNamedItem("action").value=$v_0;if(!IsNull($v_1))switch($v_1.get_typeName()){case Mscrm.EntityLogicalNames.Opportunity:if(this.GetParameter("viewid")==="{FE4BC089-8901-466C-A41B-1C1090F204D4}"||this.GetParameter("viewid")==="{4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF}"||this.get_entityTypeName()===Mscrm.EntityLogicalNames.Product)return false;break;case Mscrm.EntityLogicalNames.Lead:if(this.GetParameter("viewid")==="{4E3600FA-B9C8-49F4-B69A-51EBA06D9BDF}")return false;break;case Mscrm.EntityLogicalNames.Quote:if(this.get_entityTypeName()===Mscrm.EntityLogicalNames.Product)return false;break;case Mscrm.EntityLogicalNames.SalesOrder:if(this.get_entityTypeName()===Mscrm.EntityLogicalNames.Product)return false;break;case Mscrm.EntityLogicalNames.Invoice:if(this.get_entityTypeName()===Mscrm.EntityLogicalNames.Product)return false;break;case Mscrm.EntityLogicalNames.Incident:if(this.GetParameter("viewid")==="{23FB1036-E41D-4D75-8AA7-27569B5B6512}")return false;break}return true}}}return false},$3r_4:function($p0){if(!IsNull(this.get_openAssociatedGridViewButton())){this.get_openAssociatedGridViewButton().className=$p0?"ms-crm-ImageStrip-openassociatedgridview":"ms-crm-ImageStrip-openassociatedgridviewDisable";var $v_0=$get(this.get_id()+"_contextualButtonsContainer");if(this.$q_4()&&!IsNull(this.get_openAssociatedGridViewButton().style.display)&&this.get_openAssociatedGridViewButton().style.display!=="none"&&!IsNull($v_0)){var $v_1=XUI.Html.DomUtils.GetPrevSibling($v_0);if(window.LOCID_UI_DIR==="RTL"){$v_0.style.paddingLeft="36px";$v_1.style.paddingLeft="36px"}else{$v_0.style.paddingRight="36px";$v_1.style.paddingRight="36px"}}}},$3q_4:function($p0){if(this.$q_4())this.get_addContextualButton().className=$p0?"ms-crm-ImageStrip-addButton":"ms-crm-ImageStrip-addButtonDisable"},$6x_4:function($p0){var $v_0=$p0.target.id;if($v_0.indexOf("_addImage")>0){if(this.$q_4()&&this.get_addContextualButton().className!=="ms-crm-ImageStrip-addButtonDisable")this.get_addContextualButton().className="ms-crm-ImageStrip-addButtonHover"}else if($v_0.indexOf("_openAssociatedGridViewImageButton")>0)this.get_openAssociatedGridViewButton().className="ms-crm-ImageStrip-openassociatedgridviewhover";else if($v_0.indexOf("_lockImage")>0){if(!IsNull(this.get_lockPriceContextualButton()))this.get_lockPriceContextualButton().className="ms-crm-ImageStrip-lockButtonHover"}else if($v_0.indexOf("_unlockImage")>0){if(!IsNull(this.get_unlockPriceContextualButton()))this.get_unlockPriceContextualButton().className="ms-crm-ImageStrip-unlockButtonHover"}else if($v_0.indexOf("_upImage")>0){if(!IsNull(this.get_moveUpContextualButton())&&this.get_moveUpContextualButton().className!=="ms-crm-ImageStrip-moveUpButtonDisabled")this.get_moveUpContextualButton().className="ms-crm-ImageStrip-moveUpButtonHover"}else if($v_0.indexOf("_downImage")>0)if(!IsNull(this.get_moveDownContextualButton())&&this.get_moveDownContextualButton().className!=="ms-crm-ImageStrip-moveDownButtonDisabled")this.get_moveDownContextualButton().className="ms-crm-ImageStrip-moveDownButtonHover"},$6w_4:function($p0){var $v_0=$p0.target.id;if($v_0.indexOf("_addImage")>0){if(this.$q_4()&&this.get_addContextualButton().className!=="ms-crm-ImageStrip-addButtonDisable")this.get_addContextualButton().className="ms-crm-ImageStrip-addButton"}else if($v_0.indexOf("_openAssociatedGridViewImageButtonImage")>0){if(this.$1q_4())this.get_openAssociatedGridViewButton().className="ms-crm-ImageStrip-openassociatedgridview"}else if($v_0.indexOf("_lockImage")>0)this.get_lockPriceContextualButton().className="ms-crm-ImageStrip-lockButton";else if($v_0.indexOf("_unlockImage")>0)this.get_unlockPriceContextualButton().className="ms-crm-ImageStrip-unlockButton";else if($v_0.indexOf("_upImage")>0){if(this.get_moveUpContextualButton().className!=="ms-crm-ImageStrip-moveUpButtonDisabled")this.get_moveUpContextualButton().className="ms-crm-ImageStrip-moveUpButton"}else if($v_0.indexOf("_downImage")>0)if(this.get_moveDownContextualButton().className!=="ms-crm-ImageStrip-moveDownButtonDisabled")this.get_moveDownContextualButton().className="ms-crm-ImageStrip-moveDownButton"},DisassociateAndRefresh:function(associationName,parentTypeCode,parentId,targetTypeCode){this.updatePageNumberOnLastRecordDelete();var $v_0=this.get_selectedRecords()[0].Id,$v_1="<disassociateAndRefresh>";$v_1+="<disassociate>";$v_1+="<associationName>"+CrmEncodeDecode.CrmXmlEncode(associationName)+"</associationName>";$v_1+="<parentTypeCode>"+CrmEncodeDecode.CrmXmlEncode(parentTypeCode.toString())+"</parentTypeCode>";$v_1+="<parentId>"+CrmEncodeDecode.CrmXmlEncode(parentId)+"</parentId>";$v_1+="<targetTypeCode>"+CrmEncodeDecode.CrmXmlEncode(targetTypeCode.toString())+"</targetTypeCode>";$v_1+="<targetId>"+CrmEncodeDecode.CrmXmlEncode($v_0)+"</targetId>";$v_1+="</disassociate>";$v_1+=this.buildGridXml(false);$v_1+="</disassociateAndRefresh>";if(!this.$1w_4)this.$1w_4=new Mscrm.RemoteCommandXml("AppGridWebService","DisassociateAndRefresh");var $$t_7=this,$v_2=function(){$$t_7.$1w_4.setContent($v_1)};this.executeInternal(false,this.$1w_4,$v_2)},DeleteConnectionAndRefresh:function(){this.updatePageNumberOnLastRecordDelete();var $v_0=this.get_selectedRecords()[0].Id,$v_1="<deleteConnectionAndRefresh>";$v_1+="<delete>";$v_1+="<targetId>"+CrmEncodeDecode.CrmXmlEncode($v_0)+"</targetId>";$v_1+="</delete>";$v_1+=this.buildGridXml(false);$v_1+="</deleteConnectionAndRefresh>";if(!this.$1v_4)this.$1v_4=new Mscrm.RemoteCommandXml("AppGridWebService","DeleteConnectionAndRefresh");var $$t_3=this,$v_2=function(){$$t_3.$1v_4.setContent($v_1)};this.executeInternal(false,this.$1v_4,$v_2)},$4Y_4:function($p0){var $v_0=Mscrm.GridControl.getControlBehaviorFromChildElement($p0.target);if(IsNull($v_0))return;if(!$v_0.isProductGrid())return;switch($p0.keyCode){case 38:$p0.altKey&&$v_0.MoveRecordUpLite($p0);break;case 40:$p0.altKey&&$v_0.MoveRecordDownLite($p0);break}},$7i_4:function(){this.finishShowLoadingMessage();var $v_0=this.refreshComplete(this.$2K_3,this.$2J_3);if(!$v_0)return;this.$85_4()},$85_4:function(){this.$7O_4()&&this.$86_4()},$7O_4:function(){var $v_0=this.get_element().id;return $v_0.indexOf("SalesAttachments")>-1},$86_4:function(){var $v_0=this.$0_3.FindColumnIndex("filename");if($v_0===-1)return;for(var $v_1=this.$0_3.get_dataTableBody(),$v_2=$v_1.children,$v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3],$v_5=$v_4.children[$v_0];if(!IsNull($v_5)){$v_5.style.textDecoration="underline";$addHandler($v_5,"click",this.$$d_$4E_4);$addHandler($v_5,"keyup",this.$$d_$72_4)}}},$4E_4:function($p0){var $v_0=$p0.target;if($v_0.tagName!=="DIV")return;if(!IsNull($v_0)&&!IsNull($v_0.parentNode)){var $v_1=$v_0.parentNode.parentNode,$v_2=$v_1.attributes.getNamedItem("otype"),$v_3=$v_1.attributes.getNamedItem("oid");if(!IsNull($v_2)&&!IsNull($v_3)){var $v_4=Mscrm.CrmUri.create("/Activities/Attachment/download.aspx");$v_4.setQueryParameter("AttachmentType",$v_2.value);$v_4.setQueryParameter("AttachmentId",$v_3.value);$v_4.setQueryParameter("IsNotesTabAttachment","0");$v_4.appendToQuery(Mscrm.WrpcTokenFuncs.getTokenAsQS($v_4));$p0.preventDefault();$p0.stopPropagation();openStdWin($v_4,null,0,0,null)}}},$72_4:function($p0){Mscrm.Utilities.getDomEventKeyCode($p0)===13&&this.$4E_4($p0)},$3R_4:function(){var $v_0=$get(this.get_id()+"_span"),$v_1=null;if($v_0)$v_1=$P_CRM($v_0);var $v_2=Mscrm.InlineEditUtilities.getLinkedDataObject($v_1),$v_3=null;if($v_2)$v_3=$v_2["_entity"];var $v_4=null;if(!IsNull($v_3))$v_4=$v_3.TypeCode.toString();return $v_4},$9_4:function($p0,$p1){if(!$p0)return;var $v_0=$find(this.get_id()+"_span");if($p0.style.display.toLowerCase()!==$p1.toLowerCase()){$p0.style.display=$p1;$v_0.setGridTopStyle()}},$2X_4:function($p0,$p1){if(!$p0)return;if(!IsNull(this.$L_4)){this.$L_4.dispose();this.$L_4=null}this.$L_4=new Mscrm.InlineEditGrid;var $v_0=null;switch($p1){case 0:$v_0=new Mscrm.ProductEntityInlineEditGrid;break;case 1:$v_0=new Mscrm.MovableRowsGrid;break;case 2:$v_0=new Mscrm.EntitlementChannelInlineEditGrid;break}if($v_0){var $v_1=this.$q_4();this.$L_4.initialize(this,$v_0,$v_1)}}};Mscrm.GridSizeCalculator=function(element){Mscrm.GridSizeCalculator.initializeBase(this,[element])};Mscrm.GridSpanControl=function($p0){this.$$d_$4b_3=Function.createDelegate(this,this.$4b_3);this.$$d_$8K_3=Function.createDelegate(this,this.$8K_3);this.$$d_$6t_3=Function.createDelegate(this,this.$6t_3);this.$$d_$6k_3=Function.createDelegate(this,this.$6k_3);Mscrm.GridSpanControl.initializeBase(this,[$p0])};Mscrm.GridSpanControl.getTabRead=function(value){var $v_0=null;if(Mscrm.GridControl.isInstanceOfType(value))$v_0=value.get_element();else if(Mscrm.GridSpanControl.isInstanceOfType(value))$v_0=value.get_element();else return null;var $v_1=$v_0,$v_2=$get("rofContainer");while(!IsNull($v_1)&&!Sys.UI.DomElement.containsCssClass($v_1,"ms-crm-InlineTabBody-Read")&&$v_1!==$v_2)$v_1=$v_1.parentNode;if(IsNull($v_1)||$v_1===$v_2)$v_1=null;else{var $v_3=$v_1.id;if($v_3.endsWith("_content")){var $v_4="_content",$v_5="_Expander";$v_3=$v_3.substr(0,$v_3.length-$v_4.length);$v_3+=$v_5;var $v_6=$get($v_3);if(!IsNull($v_6))$v_1=$v_6.parentNode}else $v_1=null}return $v_1};Mscrm.GridSpanControl.prototype={initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$5B_3();this.setGridTopStyle();Sys.Application.add_load(this.$$d_$6k_3);$addHandler(window,"resize",this.$$d_$6t_3)},dispose:function(){if(this.get_isDisposed())return;$removeHandler(window,"resize",this.$$d_$6t_3);Mscrm.CrmUIControl.prototype.dispose.call(this)},$6k_3:function($p0,$p1){this.setGridTopStyle()},$6t_3:function($p0){this.setGridTopStyle()},get_selectionControl:function(){return this.get_refInnerGrid()},$26_3:null,get_innerGridId:function(){return this.$26_3},set_innerGridId:function(value){this.$26_3=value;return value},$34_3:null,get_refInnerGrid:function(){if(IsNull(this.$34_3)&&!IsNull(this.$26_3))this.$34_3=Mscrm.GridControl.findComponent(this.$26_3);return this.$34_3},setGridTopStyle:function(){if(this.get_isDisposed())return;if($get("areaForm"))if($get("areaForm").style.display==="none")return;if(!this.get_element().hasChildNodes())return;var $v_0=XUI.Html.DomUtils.GetFirstChild(this.get_element()),$v_1=0;try{var $v_3=parseInt(XUI.Html.GetComputedStyle($v_0,"paddingTop"));$v_1+=$v_3}catch($$e_3){}var $$t_B=this,$v_2=function($p1_0){if($p1_0.id.endsWith("_ccDiv")){$p1_0.style.top=$v_1.toString()+"px";return true}var $v_4=$p1_0.offsetHeight;if(!$v_4&&!IsNull($$t_B.get_refInnerGrid())&&$$t_B.get_refInnerGrid().isLiteSubGrid()){var $v_5=XUI.Html.DomUtils.GetFirstChild($p1_0);if(!IsNull($v_5)&&$v_5.id.startsWith("titleContainer_")){var $v_6=$v_5.style.height;if($v_6.endsWith("px"))try{var $v_7=parseInt($v_6.substr(0,$v_6.length-2));$v_1+=isNaN($v_7)?0:$v_7}catch($$e_A){}}}else $v_1+=$v_4;return false};XUI.Html.DomUtils.ForEachChild($v_0,$v_2)},$5B_3:function(){if(this.get_element().tagName==="TABLE"||!IsNull(this.get_refInnerGrid())&&this.get_refInnerGrid().get_gridType()!==Mscrm.GridControl.inlineSubGrid||XUI.Html.DomUtils.GetFirstChild(this.get_element()).className!=="ms-crm-Form-SubGrid-Layout"&&XUI.Html.DomUtils.GetFirstChild(this.get_element()).className!=="ms-crm-Form-SubGrid-Layout-Lite")return;var $v_0=this.get_element().parentNode;if(isNullOrEmptyString($v_0.getAttribute("rowSpan")))return;var $v_1=$v_0.offsetHeight;if($v_1>0)$v_0.style.height=($v_1-6).toString()+"px";else window.setTimeout(this.$$d_$8K_3,0)},$8K_3:function(){var $v_0=$find("crmForm"),$v_1=$v_0.GetTab(this.get_element(),false);if(!IsNull($v_1)){var $v_2=$find($v_1.id);if(!IsNull($v_2)&&Mscrm.FormUITab.isInstanceOfType($v_2))if($v_2.get_displayState()===Xrm.TabDisplayState.expanded)this.$4W_3();else $v_2.add_tabStateChange(this.$$d_$4b_3)}},$4b_3:function($p0,$p1){if($p1.get_displayState()===Xrm.TabDisplayState.expanded){$p0.remove_tabStateChange(this.$$d_$4b_3);this.$4W_3()}},$4W_3:function(){this.$59_3()},$59_3:function(){this.$5B_3();this.setGridTopStyle();!IsNull(this.get_refInnerGrid())&&this.get_refInnerGrid().autoExpandGridControlRows()},handleLinkControlEvents:function(){this.$59_3()}};Mscrm.GridViewSelector=function($p0){this.$$d_$8a_3=Function.createDelegate(this,this.$8a_3);this.$$d_$8X_3=Function.createDelegate(this,this.$8X_3);this.$$d_$7Q_3=Function.createDelegate(this,this.$7Q_3);this.$$d_$5M_3=Function.createDelegate(this,this.$5M_3);this.$$d_$4q_3=Function.createDelegate(this,this.$4q_3);this.$$d_viewSelectorHidden=Function.createDelegate(this,this.viewSelectorHidden);this.$$d_$7b_3=Function.createDelegate(this,this.$7b_3);this.$$d_$7f_3=Function.createDelegate(this,this.$7f_3);this.$$d_$7d_3=Function.createDelegate(this,this.$7d_3);this.$$d_$7l_3=Function.createDelegate(this,this.$7l_3);this.$$d_$7e_3=Function.createDelegate(this,this.$7e_3);this.$$d_$8Y_3=Function.createDelegate(this,this.$8Y_3);this.$$d_$7n_3=Function.createDelegate(this,this.$7n_3);this.$$d_$7m_3=Function.createDelegate(this,this.$7m_3);this.$$d_syncToGridStatus=Function.createDelegate(this,this.syncToGridStatus);this.$1k_3=[];Mscrm.GridViewSelector.initializeBase(this,[$p0]);this.$1B_3=$p0};Mscrm.GridViewSelector.prototype={$3_3:null,$1B_3:null,$b_3:null,$R_3:null,$o_3:null,$2E_3:false,$1e_3:false,$2m_3:true,$6_3:null,$Y_3:null,$88_3:null,$3a_3:null,$2c_3:null,$5h_3:0,showNewVSControl:false,showOriginalSelectBox:true,isActivitiesViewSelector:false,createPersonalViewEnabled:false,gridFiltersEnabled:false,viewEntityName:null,selectedSavedQuery:null,selectedSavedQueryName:null,selectedSavedQueryType:null,userSelectedDefaultView:null,userOwnedView:null,quickFindQuery:null,systemViewsXml:null,userViewsXml:null,systemViewsLabel:null,userViewsLabel:null,customViewsLabel:null,createPersonalViewLabel:null,saveFiltersAsNewViewLabel:null,saveFiltersToCurrentViewLabel:null,onDefaultViewToolTip:null,setDefaultViewToolTip:null,renderForPrint:false,selectOptionsXml:null,$2s_3:false,$10_3:null,get_activityList:function(){return this.$10_3},set_activityList:function(value){this.$10_3=value;return value},$38_3:null,get_systemViewsMap:function(){return this.$38_3},$3C_3:null,get_userViewsMap:function(){return this.$3C_3},$2g_3:false,$3D_3:false,get_$3X_3:function(){if(!IsNull(this.$3_3.get_gridType())&&(this.$3_3.get_gridType()===Mscrm.GridControl.hompageGrid||this.$3_3.get_gridType()===Mscrm.GridControl.associatedGrid&&this.$3_3.isLiteSubGrid()))return "ms-crm-View-Name-View-Lite-hover";return "ms-crm-View-Name-hover"},get_$3f_3:function(){if(!IsNull(this.$3_3.get_gridType())&&(this.$3_3.get_gridType()===Mscrm.GridControl.hompageGrid||this.$3_3.get_gridType()===Mscrm.GridControl.associatedGrid&&this.$3_3.isLiteSubGrid()))return "ms-crm-View-Name-View-Lite-select";return "ms-crm-View-Name-select"},get_$3p_3:function(){if(!IsNull(this.$3_3.get_gridType())&&(this.$3_3.get_gridType()===Mscrm.GridControl.hompageGrid||this.$3_3.get_gridType()===Mscrm.GridControl.associatedGrid&&this.$3_3.isLiteSubGrid()))return "ms-crm-View-Name-View-Lite";return "ms-crm-View-Name"},selectedViewId:null,selectedViewType:null,selectedViewName:null,originalViewId:null,originalViewType:null,originalViewName:null,initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);if(this.showNewVSControl){var $v_1=this.$1B_3.parentNode.parentNode;if(!this.showOriginalSelectBox){this.$b_3=XUI.Html.DomUtils.GetFirstChild($v_1).getElementsByTagName("SPAN")[0];this.$R_3=XUI.Html.DomUtils.GetFirstChild($v_1).getElementsByTagName("A")[0]}else{this.$b_3=XUI.Html.DomUtils.GetNextSibling(XUI.Html.DomUtils.GetFirstChild($v_1)).getElementsByTagName("SPAN")[0];this.$R_3=XUI.Html.DomUtils.GetNextSibling(XUI.Html.DomUtils.GetFirstChild($v_1)).getElementsByTagName("A")[0]}this.$b_3&&!this.renderForPrint&&this.addHandlers();this.$88_3=this.$1B_3.parentNode.innerHTML;this.$38_3=XUI.Xml.LoadXml(this.systemViewsXml);this.$3C_3=XUI.Xml.LoadXml(this.userViewsXml);this.selectedViewId=this.selectedSavedQuery;this.selectedViewName=this.selectedSavedQueryName;this.selectedViewType=this.selectedSavedQueryType}var $v_0=$get("defaultViewIcon");if(!IsNull($v_0)){$addHandler($v_0,"mouseover",this.$$d_$7m_3);$addHandler($v_0,"mouseout",this.$$d_$7n_3)}this.$3a_3={};this.$2c_3={};window.setTimeout(this.$$d_$8Y_3,1);window.setTimeout(this.$$d_syncToGridStatus,0)},addHandlers:function(){if(!this.$2s_3){$addHandler(this.$R_3,"mouseover",this.$$d_$7e_3);$addHandler(this.$R_3,"mouseout",this.$$d_$7l_3);$addHandler(this.$R_3,"focus",this.$$d_$7d_3);$addHandler(this.$R_3,"blur",this.$$d_$7l_3);$addHandler(this.$R_3,"keydown",this.$$d_$7f_3);$addHandler(this.$R_3,"click",this.$$d_$7b_3);this.$2s_3=true}},dispose:function(){if(this.get_isDisposed())return;!IsNull(this.$6_3)&&this.$6_3.dispose();if(!IsNull(this.get_eventManager()))if(!IsNull(this.$1k_3))for(var $v_0=0;$v_0<this.$1k_3.length;$v_0++){var $v_1={};$v_1["key"]=this.$1k_3[$v_0];this.raiseEvent(Mscrm.ScriptEvents.RemoveCacheData,$v_1)}Mscrm.CrmUIControl.prototype.dispose.call(this)},$2n_3:false,get_disabled:function(){return this.$2n_3},set_disabled:function(value){this.$2n_3=value;if(this.$2n_3&&this.$R_3){$clearHandlers(this.$R_3);this.$2s_3=false}else this.addHandlers();return value},syncToGridStatus:function(){if(this.get_isDisposed())return;var $v_0=this.get_element().attributes.getNamedItem("GridId");if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.value)){this.$o_3=$v_0.value;var $v_1=$find(this.$o_3);if(!IsNull($v_1)&&Mscrm.GridControl.isInstanceOfType($v_1))this.$3_3=$v_1}this.$3_3&&this.$3_3.get_disabled()&&this.set_disabled(true)},$8Y_3:function(){if(this.get_isDisposed())return;if(IsNull(Mscrm.PageManager.get_instance())||IsNull(this.$1B_3)||isNullOrEmptyString(this.viewEntityName))return;var $v_0;if(this.showNewVSControl)$v_0=this.selectOptionsXml;else $v_0=this.$1B_3.OptionsXml;this.$5G_3($v_0)},$8u_3:function(){if(IsNull(Mscrm.PageManager.get_instance())||IsNull(this.$1B_3)||isNullOrEmptyString(this.viewEntityName))return;if(this.$2E_3){var $v_0=new RemoteCommand("SavedQuerySelectorWebService","GetSavedViewSelector",null);$v_0.SetParameter("entityName",this.viewEntityName);var $v_1=$v_0.Execute(null);if($v_1.Success){var $v_2=$v_1.Xml,$v_3=$v_2.text;!IsNull($v_3)&&this.$5G_3($v_3)}}},$5G_3:function($p0){this.$3m_3($p0,this.viewEntityName)},$3m_3:function($p0,$p1){var $v_0={};$v_0["timestamp"]=new Date;$v_0["queryList"]=$p0;var $v_1={};$v_1["data"]=$v_0;if(this.isActivitiesViewSelector)$v_1["key"]=String.format("QueryList_{0}_ActivitySelector",$p1);else $v_1["key"]=String.format("QueryList_{0}",$p1);this.$1k_3[this.$5h_3++]=$v_1["key"];Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.InsertCacheData,$v_1)},get_viewTitle:function(){if(this.showNewVSControl&&!this.showOriginalSelectBox)return this.selectedViewName;else return this.get_$57_3().getAttribute("Text")},get_viewIsUserOwned:function(){if(this.showNewVSControl&&!this.showOriginalSelectBox)return this.selectedViewId===this.userOwnedView;else{var $v_0=this.get_$57_3().getAttribute("isUserOwned");return !IsNull($v_0)&&$v_0==="true"}},get_$57_3:function(){return Mscrm.FormControlInputBehavior.GetElementBehavior(this.$1B_3).get_selectedOption()},get_selectionControl:function(){return this.$3_3},$8p_3:function($p0){if(!IsNull(this.$3_3)){this.addCssClass(this.get_$3X_3());this.removeCssClass(this.get_$3f_3());this.removeCssClass(this.get_$3p_3())}},$3n_3:function($p0){if(!IsNull(this.$3_3)){this.addCssClass(this.get_$3f_3());this.removeCssClass(this.get_$3X_3());this.removeCssClass(this.get_$3p_3())}},$5H_3:function($p0){if(!IsNull(this.$3_3)){this.addCssClass(this.get_$3p_3());this.removeCssClass(this.get_$3X_3());this.removeCssClass(this.get_$3f_3());if(this.$2g_3){this.$2g_3=false;this.$R_3.focus()}}},$7m_3:function($p0){var $v_0=$get("defaultViewIcon");if(!IsNull($v_0)){var $v_1=Mscrm.InternalUtilities.Utilities.isHighContrastEnabled();if($v_1){if(!$v_0.src.endsWith(window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pinned_16_RTL.png":"/_imgs/grid/pinned_16.png"))$v_0.src=window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pin_16_RTL.png":"/_imgs/grid/pin_hover_16.png"}else if(!$v_0.className.endsWith(window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pinned_16_RTL":"ms-crm-ImageStrip-pinned_16"))$v_0.className=window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pin_hover_16_RTL":"ms-crm-ImageStrip-pin_hover_16"}},$7n_3:function($p0){var $v_0=$get("defaultViewIcon");if(!IsNull($v_0)){var $v_1=Mscrm.InternalUtilities.Utilities.isHighContrastEnabled();if($v_1){if(!$v_0.src.endsWith(window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pinned_16_RTL.png":"/_imgs/grid/pinned_16.png"))$v_0.src=window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pin_hover_16_RTL.png":"/_imgs/grid/pin_16.png"}else if(!$v_0.className.endsWith(window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pinned_16_RTL":"ms-crm-ImageStrip-pinned_16"))$v_0.className=window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pin_16_RTL":"ms-crm-ImageStrip-pin_16"}},$7e_3:function($p0){var $v_0=Mscrm.Utilities.getDomEventElement($p0,"DIV");this.$8p_3($v_0)},$7l_3:function($p0){if(!this.$2g_3){var $v_0=Mscrm.Utilities.getDomEventElement($p0,"DIV");this.$5H_3($v_0)}},$7d_3:function($p0){var $v_0=Mscrm.Utilities.getDomEventElement($p0,"DIV");this.$3n_3($v_0)},$7f_3:function($p0){switch($p0.keyCode){case 13:case 32:case 38:case 40:$p0.stopPropagation();$p0.preventDefault();var $v_0=Mscrm.Utilities.getDomEventElement($p0,"DIV");this.$5L_3($v_0);break}},$7b_3:function($p0){$p0.stopPropagation();var $v_0=Mscrm.Utilities.getDomEventElement($p0,"DIV");this.$5L_3($v_0)},$5L_3:function($p0){this.$3n_3($p0);var $v_0=this.$R_3.parentNode.parentNode,$v_1=Mscrm.Utilities.getXYPos($v_0,window.LOCID_UI_DIR==="RTL",$get("crmContentPanel")),$v_2=$v_1["y"]+this.$R_3.offsetHeight,$v_3=$v_1["x"];if(window.LOCID_UI_DIR==="RTL")$v_3=$v_3+$v_0.offsetWidth;this.$8k_3($p0,$v_3,$v_2)},$8k_3:function($p0,$p1,$p2){this.$3n_3($p0);if(IsNull(this.$6_3)){this.$6_3=this.$3I_3();this.$7v_3(this.$6_3)}var $v_0=XUI.Html.GetText($p0);if(this.get_viewTitle()===window.LOCID_SEARCH_RESULTS||$v_0===window.LOCID_SEARCH_RESULTS){if(!IsNull(this.$Y_3)){this.$Y_3.set_isSelected(false);this.$6_3.set_focusElementOnShow(null)}this.$Y_3=null}else if(IsNull(this.$Y_3))for(var $v_1=null,$v_2=0;$v_2<this.$6_3.get_menuItems().length;$v_2++)if(!isNullOrEmptyString($v_0)){$v_1=this.$6_3.get_menuItems()[$v_2];if($v_1.get_title()===$v_0){this.$Y_3=$v_1;this.$Y_3.set_isSelected(true);this.$6_3.set_focusElementOnShow(this.$Y_3.get_itemContents());break}}this.$6_3.set_left($p1);this.$6_3.set_top($p2);this.$6_3.show();if(this.$2E_3){this.$2E_3=false;this.$6_3.refresh()}this.$2g_3=true;if(!this.isActivitiesViewSelector)this.$2m_3&&this.$5E_3(this.$6_3)},$5E_3:function($p0){for(var $v_0=0;$v_0<$p0.get_menuItems().length;$v_0++){var $v_1=$p0.get_menuItems()[$v_0];if(!IsNull($v_1.get_iconClassName()))if($v_1.get_menuItemId()===this.userSelectedDefaultView){$v_1.set_iconPath(window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pinned_16_RTL.png":"/_imgs/grid/pinned_16.png");this.$2m_3=false}else $v_1.set_iconPath("/_imgs/imagestrips/transparent_spacer.gif")}},$3I_3:function(){var $v_0=Mscrm.Menu.createMenu();$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_0.set_propagateStyle(false);$v_0.set_width(284);$v_0.set_reference(this.viewEntityName);$v_0.set_hideCallback(this.$$d_viewSelectorHidden);$v_0.set_shiftVertical(false);return $v_0},viewSelectorHidden:function(menu){var $v_0=this.$b_3.parentNode.parentNode;this.$5H_3($v_0)},$7v_3:function($p0){if(IsNull($p0))return;if(this.isActivitiesViewSelector)for(var $v_0=0;$v_0<this.$10_3.length;$v_0++){var $v_1;$v_1=Mscrm.Menu.createMenu();$v_1.set_title(this.$10_3[$v_0].Name);$v_1.set_stylePrefix(Mscrm.MenuStyles.activityViewSelectorStylePrefix);$v_1.set_isLoading(true);$v_1.set_subMenuShowCallback(this.$$d_$4q_3);$v_1.set_focusElementOnShow(null);$v_1.set_reference(this.$10_3[$v_0].TypeName);$v_1.set_menuItemId("ViewSelector_"+this.$10_3[$v_0].TypeName);$v_1.set_width(283);$v_1.set_propagateStyle(false);$v_1.set_iconPath(Mscrm.Utilities.getIconPath(this.$10_3[$v_0].TypeCode));$p0.addItem($v_1)}else this.$4q_3($p0)},$53_3:function($p0){var $v_0=null,$v_1=new RemoteCommand("ActivitiesWebService","GetQueryList");$v_1.SetParameter("entityName",$p0);var $v_2=$v_1.Execute(null);if(!IsNull($v_2)&&$v_2.Success)$v_0=XUI.Xml.GetText($v_2.Xml);return $v_0},$4L_3:function($p0){var $v_0={};if(this.isActivitiesViewSelector)$v_0["key"]=String.format("QueryList_{0}_ActivitySelector",$p0);else $v_0["key"]=String.format("QueryList_{0}",$p0);var $v_1=Mscrm.PageManager.get_instance().get_eventManager().raiseEvent(Mscrm.ScriptEvents.RetrieveCacheData,$v_0,this),$v_2=null;if(!IsNull($v_1)&&isArray($v_1)&&$v_1.length>0)$v_2=$v_1[0];var $v_3=null;if(!IsNull($v_2))$v_3=$v_2["queryList"];return $v_3},$4q_3:function($p0){var $v_0=$p0.get_reference();if(this.isActivitiesViewSelector){var $v_1=null,$v_2=this.$4L_3($v_0);if(IsNull($v_2)){$v_2=this.$53_3($v_0);!IsNull($v_2)&&this.$3m_3($v_2,$v_0)}if(!IsNull($v_2)){$v_1=XUI.Xml.LoadXml($v_2);this.$51_3($v_1)}if(IsNull(this.$3a_3[$v_0])||this.$2c_3[$v_0]){if(!IsNull($v_1)){this.$3D_3=true;$p0.set_menuId("ViewMenu_"+$v_0);this.$7u_3($p0,$v_1);this.$3D_3=false}this.$3a_3[$v_0]=true;$p0.get_parentMenu().set_focusElementOnShow($p0.get_itemContents());this.$2c_3[$v_0]=false}this.$5E_3($p0)}else{var $v_3=XUI.Xml.SelectSingleNode(this.$38_3,"savedqueries",null);!IsNull($v_3)&&$v_3.childNodes.length>0&&this.$4r_3($p0,$v_0,$v_3,Mscrm.EntityTypeCode.SavedQuery);var $v_4=XUI.Xml.SelectSingleNode(this.$3C_3,"userqueries",null);if(!IsNull($v_4)&&$v_4.childNodes.length>0){this.$1e_3=true;this.$2O_3($p0);this.$4r_3($p0,$v_0,$v_4,Mscrm.EntityTypeCode.UserQuery)}this.$2O_3($p0);this.createPersonalViewEnabled&&this.$3c_3($p0);this.$3d_3($p0)}$p0.get_isLoading()&&$p0.set_isLoading(false)},$8x_3:function($p0,$p1){var $v_0=$p1["viewName"],$v_1=Mscrm.MenuItem.createMenuItem($v_0),$v_2=$p1["viewId"],$v_3=$p1["viewType"],$v_4=$p1["entityName"],$v_5={};$v_5["viewId"]=$v_2;$v_5["viewType"]=$v_3;$v_5["entityName"]=$v_4;$v_5["viewName"]=$v_0;$v_1.set_reference($v_5);$v_1.set_actionCallback(this.$$d_$5M_3);$v_1.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_1.set_menuItemId($v_2);var $v_6=$p0.get_menuItems().length;$p0.insertItem($v_1,$v_6-4);if(!this.$1e_3){$p0.insertItem(this.$5s_3(this.userViewsLabel),$v_6-4);this.$7I_3($p0,$v_6-4);this.$1e_3=true}},$5s_3:function($p0){var $v_0=Mscrm.MenuItem.createMenuItem($p0);$v_0.set_stylePrefix("VS-header");return $v_0},$7I_3:function($p0,$p1){var $v_0=Mscrm.MenuItemSeparator.createSeparator(false);$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$p0.insertItem($v_0,$p1)},$2O_3:function($p0){var $v_0=Mscrm.MenuItemSeparator.createSeparator(false);$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$p0.addItem($v_0)},handleEvent:function(eventCode,parameters,sourceComponent){Mscrm.CrmUIControl.prototype.handleEvent.call(this,eventCode,parameters,sourceComponent);switch(eventCode){case Mscrm.ScriptEvents.NewViewCreated:this.$70_3(parameters);break;case Mscrm.ScriptEvents.WindowResize:case Mscrm.ScriptEvents.GridViewChanged:this.$7D_3();break;case Mscrm.ScriptEvents.ToggledFilter:this.$7A_3();break;case Mscrm.ScriptEvents.DefaultViewChanged:this.$4U_3();this.$2m_3=true;break}return null},get_$2Z_3:function(){return Mscrm.RibbonActions.canEnableSaveButton(this.$3_3)&&Mscrm.RibbonActions.disableButtonsWhenChartMaximized(this.$3_3)},get_$4l_3:function(){return Mscrm.RibbonActions.isUserQuerySelected(this.$3_3)},$7A_3:function(){if(this.$6_3)for(var $$arr_0=this.$6_3.get_menuItems(),$$len_1=$$arr_0.length,$$idx_2=0;$$idx_2<$$len_1;++$$idx_2){var $v_0=$$arr_0[$$idx_2];if($v_0.get_menuItemId()==="{SaveFiltersAsNew}"||$v_0.get_menuItemId()==="{SaveFiltersToCurrent}"){$v_0.set_disabled($v_0.get_menuItemId()==="{SaveFiltersAsNew}"?!this.get_$2Z_3():!(this.get_$2Z_3()&&this.get_$4l_3()));$v_0.displayRestStyle()}}},$70_3:function($p0){if(!IsNull(this.$6_3)){var $v_0=false,$v_1=false,$v_2,$v_3=$p0["entityTypeCode"];if(!IsNull($v_3)){$v_2=Number.parseInvariant($v_3);if(!IsNull($v_2))$v_0=Mscrm.EntityPropUtil.isActivityTypeCode($v_2)}var $v_4,$v_5=$p0["entityName"];if($v_0){$v_4=this.$4L_3($v_5);if(!IsNull($v_4)){$v_4=this.$53_3($v_5);if(!IsNull($v_4)){this.$3m_3($v_4,$v_5);$v_1=true}}}if(this.isActivitiesViewSelector&&$v_0)this.$2c_3[$v_5]=true;else{var $v_6=this.$6_3.get_reference();if($v_6===$v_5){this.$8x_3(this.$6_3,$p0);this.$2E_3=true;!$v_1&&this.$8u_3()}}}},$7D_3:function(){if(IsNull($get(this.get_id()))||IsNull(XUI.Html.DomUtils.GetFirstChild($get(this.get_id()))))return;try{var $v_0=$get(this.get_id()),$v_1=XUI.Html.DomUtils.GetFirstChild($v_0);$v_1.style.width=$v_1.clientWidth.toString();var $v_2=$v_0.parentNode.offsetWidth,$v_3=$v_1.scrollWidth,$v_4=XUI.Html.DomUtils.GetNextSibling($v_1).offsetWidth;if($v_3>$v_2-$v_4){$v_1.style.width=($v_2-$v_4-30).toString();$v_1.style.textOverflow="ellipsis";$v_1.style.overflow="hidden"}else $v_1.style.width="auto";this.$4U_3();this.$3_3.HandleGridResize()}catch($$e_5){}},$4U_3:function(){var $v_0=$get("defaultViewIcon");if(!IsNull($v_0)){var $v_1=Mscrm.InternalUtilities.Utilities.isHighContrastEnabled();if(this.selectedViewId===this.userSelectedDefaultView){if($v_1)$v_0.src=window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pinned_16_RTL.png":"/_imgs/grid/pinned_16.png";else $v_0.className=window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pinned_16_RTL":"ms-crm-ImageStrip-pinned_16";$v_0.style.cursor="default";$v_0.title=this.onDefaultViewToolTip}else{if($v_1)$v_0.src=window.LOCID_UI_DIR==="RTL"?"/_imgs/grid/pin_hover_16_RTL.png":"/_imgs/grid/pin_16.png";else $v_0.className=window.LOCID_UI_DIR==="RTL"?"ms-crm-ImageStrip-pin_16_RTL":"ms-crm-ImageStrip-pin_16";$v_0.style.cursor="pointer";$v_0.title=this.setDefaultViewToolTip}}},$4r_3:function($p0,$p1,$p2,$p3){var $v_0=$p3===Mscrm.EntityTypeCode.SavedQuery,$v_1=$v_0?this.systemViewsLabel:this.userViewsLabel,$v_2=Mscrm.MenuItem.createMenuItem($v_1);$v_2.set_stylePrefix("VS-header");$p0.addItem($v_2);var $v_3=$v_0?"savedquery":"userquery",$v_4=$v_0?"savedqueryid":"userqueryid",$v_5=XUI.Xml.SelectNodes($p2,$v_3,null),$v_6=0;while($v_6<$v_5.length){if($v_0&&XUI.Xml.GetText(XUI.Xml.SelectNodes($v_5[$v_6],"isquickfindquery",null)[0])==="true"){this.setQuickFindQuery(XUI.Xml.GetText(XUI.Xml.SelectNodes($v_5[$v_6],$v_4,null)[0]));$v_6++;continue}var $v_7=XUI.Xml.GetText(XUI.Xml.SelectNodes($v_5[$v_6],"name",null)[0]),$v_8=Mscrm.MenuItem.createMenuItem($v_7),$v_9=XUI.Xml.GetText(XUI.Xml.SelectNodes($v_5[$v_6],$v_4,null)[0]),$v_A={};$v_A["viewId"]=$v_9;$v_A["viewType"]=$p3;$v_A["entityName"]=$p1;$v_A["viewName"]=$v_7;$v_8.set_reference($v_A);$v_8.set_actionCallback(this.$$d_$5M_3);$v_8.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_8.set_menuItemId($v_9);if($v_9===this.selectedSavedQuery){this.selectedViewName=$v_7;this.selectedViewId=$v_9;this.selectedViewType=$p3.toString();$v_8.set_isSelected(true);$p0.set_focusElementOnShow($v_8.get_itemContents());this.$Y_3=$v_8}$p0.addItem($v_8);$v_6++}},$3c_3:function($p0){if(this.createPersonalViewEnabled){var $v_0=Mscrm.MenuItem.createMenuItem(this.createPersonalViewLabel);$v_0.set_actionCallback(this.$$d_$7Q_3);$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$p0.addItem($v_0)}},$3d_3:function($p0){if(this.gridFiltersEnabled){var $v_0=Mscrm.MenuItem.createMenuItem(this.saveFiltersAsNewViewLabel);$v_0.set_actionCallback(this.$$d_$8X_3);$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_0.set_menuItemId("{SaveFiltersAsNew}");$v_0.set_disabled(!this.get_$2Z_3());$p0.addItem($v_0);var $v_1=Mscrm.MenuItem.createMenuItem(this.saveFiltersToCurrentViewLabel);$v_1.set_actionCallback(this.$$d_$8a_3);$v_1.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_1.set_menuItemId("{SaveFiltersToCurrent}");$v_1.set_disabled(!(this.get_$2Z_3()&&this.get_$4l_3()));$p0.addItem($v_1)}},$7u_3:function($p0,$p1){if(IsNull($p0))$p0=this.$3I_3();else $p0.clear();var $v_0=$p0.get_reference(),$v_1=XUI.Xml.SelectSingleNode($p1,"select/OPTGROUP[@id='AppSystemViews']",null);!IsNull($v_1)&&$v_1.hasChildNodes()&&this.$2a_3($p0,$v_0,$v_1);var $v_2=XUI.Xml.SelectSingleNode($p1,"select/OPTGROUP[@id='AppUserViews']",null);if(!IsNull($v_2)&&$v_2.hasChildNodes()){this.$1e_3=true;this.$2O_3($p0);this.$2a_3($p0,$v_0,$v_2)}this.$2O_3($p0);this.$3c_3($p0);this.$3d_3($p0);$p0.get_isVisible()&&$p0.refresh()},populateMenuFromQueryList:function(queryList){if(IsNull(this.$6_3))this.$6_3=this.$3I_3();else this.$6_3.clear();var $v_0=this.$6_3.get_reference(),$v_1=XUI.Xml.LoadXml(queryList);this.$51_3($v_1);this.$3c_3(this.$6_3);this.$3d_3(this.$6_3);var $v_2=XUI.Xml.SelectSingleNode($v_1,"select/OPTGROUP[@id='AppSystemViews']",null);!IsNull($v_2)&&$v_2.childNodes.length>0&&this.$2a_3(this.$6_3,$v_0,$v_2);var $v_3=XUI.Xml.SelectSingleNode($v_1,"select/OPTGROUP[@id='AppUserViews']",null);if(!IsNull($v_3)&&$v_3.childNodes.length>0){this.$1e_3=true;this.$2a_3(this.$6_3,$v_0,$v_3)}this.$6_3.refresh()},$51_3:function($p0){var $v_0=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($p0,"select",null).attributes.getNamedItem("quickFindQuery"));!isNullOrEmptyString($v_0)&&this.setQuickFindQuery($v_0)},$2a_3:function($p0,$p1,$p2){var $v_0=Mscrm.MenuItem.createMenuItem(XUI.Xml.GetText($p2.attributes.getNamedItem("LABEL")));$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorHeaderStylePrefix);$p0.addItem($v_0);var $v_1=XUI.Xml.SelectNodes($p2,"option",null),$v_2=0;while($v_2<$v_1.length){var $v_3=XUI.Xml.GetText($v_1[$v_2]),$v_4=Mscrm.MenuItem.createMenuItem($v_3),$v_5=XUI.Xml.GetText($v_1[$v_2].attributes.getNamedItem("Type")),$v_6=XUI.Xml.GetText($v_1[$v_2].attributes.getNamedItem("value")),$v_7={};$v_7["viewId"]=$v_6;$v_7["viewType"]=$v_5;$v_7["entityName"]=$p1;$v_7["viewName"]=$v_3;$v_4.set_reference($v_7);$v_4.set_actionCallback(this.$$d_$5M_3);$v_4.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_4.set_menuItemId($v_6);if(!this.$3D_3&&$v_1[$v_2].attributes.getNamedItem("SELECTED")){this.setViewForNewSavedQuerySelector($v_3,$v_6,$v_5);this.selectedSavedQuery=$v_6;this.selectedSavedQueryName=$v_3;this.selectedSavedQueryType=$v_5;this.setDefaultSavedQueryView($v_6);$v_4.set_isSelected(true);$p0.set_focusElementOnShow($v_4.get_itemContents());this.$Y_3=$v_4}$v_1[$v_2].attributes.getNamedItem("isUserOwned")&&this.setUserOwnedView($v_6);$v_1[$v_2].attributes.getNamedItem("isdefault")&&this.setUserSelectedDefaultView($v_6);$p0.addItem($v_4);$v_2++}},$7Q_3:function($p0){var $v_0="crmGrid";if(!IsNull(this.$3_3))$v_0=this.$3_3.get_id();openAdvFind($v_0,true)},$8X_3:function($p0){Mscrm.RibbonActions.gridFiltersSaveAsNewView(this.$3_3)},$8a_3:function($p0){Mscrm.RibbonActions.gridFiltersSaveToCurrentView(this.$3_3)},$5M_3:function($p0,$p1){if(IsNull($p1))$p1=true;var $v_0=$p0.get_reference();!IsNull(this.$Y_3)&&this.$Y_3.set_isSelected(false);$p0.set_isSelected(true);$p0.get_parentMenu().set_focusElementOnShow($p0.get_itemContents());this.$Y_3=$p0;var $v_1=$v_0["viewType"],$v_2=$v_0["viewId"],$v_3=$v_0["viewName"],$v_4=$v_0["entityName"];if(isNullOrEmptyString($v_1)||isNullOrEmptyString($v_2))return;this.setViewForNewSavedQuerySelector($p0.get_title(),$v_2,$v_1);if($p1){handleView(null,this.$3_3);this.isActivitiesViewSelector&&updateVisualizationList(this.$3_3,$v_4)}},setSelectedViewItemInMenu:function(viewId,loadView){if(IsNull(loadView))loadView=true;for(var $v_0=null,$v_1=0;$v_1<this.$6_3.get_menuItems().length;$v_1++){$v_0=this.$6_3.get_menuItems()[$v_1];if(!isNullOrEmptyString($v_0.get_menuItemId()))if($v_0.get_menuItemId()===viewId){this.$5M_3($v_0,loadView);break}}},setViewForNewSavedQuerySelector:function(viewName,viewId,viewType){this.selectedViewName=viewName;this.selectedViewId=viewId;this.selectedViewType=viewType;if(this.showNewVSControl){XUI.Html.SetText(this.$b_3,viewName);this.$b_3.setAttribute("currentview",viewId);this.$b_3.setAttribute("currentviewtype",viewType)}},setOriginalViewForNewSavedQuerySelector:function(){this.setViewForNewSavedQuerySelector(this.originalViewName,this.originalViewId,this.originalViewType)},setUserSelectedDefaultView:function(viewId){this.userSelectedDefaultView=viewId;this.showNewVSControl&&this.$b_3.setAttribute("userselecteddefaultview",viewId)},setUserOwnedView:function(viewId){this.userOwnedView=viewId;this.showNewVSControl&&this.$b_3.setAttribute("userownedview",viewId)},setQuickFindQuery:function(viewId){this.quickFindQuery=viewId;this.showNewVSControl&&this.$b_3.setAttribute("quickfindquery",viewId)},setDefaultSavedQueryView:function(viewId){this.showNewVSControl&&this.$b_3.setAttribute("defaultsavedqueryview",viewId)}};Mscrm.QuickFindControl=function($p0){this.$$d_clearQuickFind=Function.createDelegate(this,this.clearQuickFind);this.$$d_RunQuickFind=Function.createDelegate(this,this.RunQuickFind);this.$$d_$2V_3=Function.createDelegate(this,this.$2V_3);this.$$d_$6v_3=Function.createDelegate(this,this.$6v_3);this.$$d_$71_3=Function.createDelegate(this,this.$71_3);this.$$d_$76_3=Function.createDelegate(this,this.$76_3);this.$$d_$77_3=Function.createDelegate(this,this.$77_3);this.$$d_$78_3=Function.createDelegate(this,this.$78_3);this.$$d_$4a_3=Function.createDelegate(this,this.$4a_3);Mscrm.QuickFindControl.initializeBase(this,[$p0])};Mscrm.QuickFindControl.$6r=function($p0){var $v_0=$p0.get_organizationServiceFault();if(!IsNull($v_0)){var $v_1=$v_0.get_errorCode();Xrm.Internal.openErrorDialog($v_1,$p0.get_message())}};Mscrm.QuickFindControl.prototype={$v_3:null,$11_3:null,$c_3:null,$W_3:null,$16_3:null,$2A_3:null,$2w_3:null,$Z_3:null,$3_3:null,$w_3:null,$29_3:false,initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$Z_3=$get(this.get_$P_3()+"_findCriteria");this.$W_3=$get(this.get_$P_3()+"_SavedQuerySelector");this.$v_3=$get(this.get_$P_3()+"_findCriteriaButton");this.$11_3=$get(this.get_$P_3()+"_clearCriteriaButton");this.$c_3=$get(this.get_$P_3()+"_articleSearchButton");if(!(typeof SHOW_ARTICLE_SEACRH_MENU=="undefined"||SHOW_ARTICLE_SEACRH_MENU==null)&&!isOutlookHostedWindow()){this.$c_3.style.display="inline";$addHandler(this.$c_3,"click",this.$$d_$4a_3);$addHandler(this.$c_3,"mouseover",this.$$d_$78_3);$addHandler(this.$c_3,"mouseout",this.$$d_$77_3);$addHandler(this.$c_3,"keydown",this.$$d_$76_3);Mscrm.ArticleSearchRibbon.set_gridId(this.get_$P_3());Mscrm.ArticleSearchRibbon.setHintText()}else this.$c_3.style.display="none";$addHandler(this.get_element(),"keypress",this.$$d_$71_3);$addHandler(this.get_element(),"keyup",this.$$d_$6v_3);$addHandler(this.get_element(),"click",this.$$d_$2V_3);$addHandler(this.$v_3,"click",this.$$d_RunQuickFind);$addHandler(this.$11_3,"click",this.$$d_clearQuickFind)},dispose:function(){if(this.get_isDisposed())return;$removeHandler(this.get_element(),"keypress",this.$$d_$71_3);$removeHandler(this.get_element(),"keyup",this.$$d_$6v_3);$removeHandler(this.get_element(),"click",this.$$d_$2V_3);$removeHandler(this.$v_3,"click",this.$$d_RunQuickFind);$removeHandler(this.$11_3,"click",this.$$d_clearQuickFind);if(!(typeof SHOW_ARTICLE_SEACRH_MENU=="undefined"||SHOW_ARTICLE_SEACRH_MENU==null)&&!isOutlookHostedWindow()){$removeHandler(this.$c_3,"click",this.$$d_$4a_3);$removeHandler(this.$c_3,"mouseover",this.$$d_$78_3);$removeHandler(this.$c_3,"mouseout",this.$$d_$77_3);$removeHandler(this.$c_3,"keydown",this.$$d_$76_3)}Mscrm.CrmUIControl.prototype.dispose.call(this)},get_$P_3:function(){var $v_0=this.get_element().attributes.getNamedItem("GridId");if(!IsNull($v_0))return $v_0.value;return null},get_selectionControl:function(){if(IsNull(this.$3_3))this.$3_3=this.$1m_3();return this.$3_3},$1m_3:function(){var $v_0=this.get_$P_3();if(!isNullOrEmptyString($v_0)){var $v_1=Mscrm.GridControl.findComponent($v_0);if(!IsNull($v_1))return $v_1;var $v_2=$get("frmGanttFrame");if(!IsNull($v_2))return $v_2.contentWindow.$find($v_0)}return null},$2V_3:function($p0){if(!this.$w_3)this.$w_3=this.$4P_3();if(!IsNull(this.$w_3)&&this.$w_3.viewEntityName==="kbarticle"){var $v_0=$p0.target;if($v_0.tagName==="INPUT"){!Mscrm.ArticleSearchRibbon&&Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/CS/ArticleSearchRibbon/ArticleSearchRibbon.js"));!Mscrm.ArticleSearchRibbon.isSearchTabEnabled()&&Mscrm.ArticleSearchRibbon.enableSearch();if(!this.$29_3){Mscrm.ArticleSearchRibbon.setFocusToSearchTab();this.$29_3=true}}}},$71_3:function($p0){var $v_0=this.$1m_3();if($v_0.GetParameter("ispreviewmode")==="1"||$v_0.GetParameter("InnerGridDisabled")==="1")return;if(Mscrm.Utilities.getDomEventKeyCode($p0)===13)if(this.$v_3.style.display!=="none")this.RunQuickFind();else this.clearQuickFind()},$4a_3:function($p0){Mscrm.ArticleSearchRibbon.showHideSearchMenu($p0)},$78_3:function($p0){var $v_0=$get("articleSearchImg");if(!IsNull($v_0))$v_0.className="ms-crm-ImageStrip-SearchFilter_Hover_16"},$77_3:function($p0){var $v_0=$get("articleSearchImg");if(!IsNull($v_0))$v_0.className="ms-crm-ImageStrip-SearchFilter_16"},$76_3:function($p0){($p0.keyCode===13||$p0.keyCode===32)&&this.$4a_3($p0)},$6v_3:function($p0){if(!this.$w_3)this.$w_3=this.$4P_3();if(!IsNull(this.$w_3)&&this.$w_3.viewEntityName==="kbarticle"){!Mscrm.ArticleSearchRibbon&&Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/CS/ArticleSearchRibbon/ArticleSearchRibbon.js"));!Mscrm.ArticleSearchRibbon.isSearchTabEnabled()&&Mscrm.ArticleSearchRibbon.enableSearch();if(!this.$29_3){Mscrm.ArticleSearchRibbon.setFocusToSearchTab();this.$29_3=true}}var $v_0=this.$1m_3();if($v_0.GetParameter("ispreviewmode")==="1"||$v_0.GetParameter("InnerGridDisabled")==="1")return;var $v_1=Mscrm.Utilities.getDomEventKeyCode($p0);if($v_1===13)return;else if($v_1===40&&$v_0.$0_3.get_numberOfRecords()>0)$v_0.$0_3.get_element().focus();else if($v_1!==9&&$v_1!==18){if(!IsNull(this.$Z_3)){var $v_2=this.$Z_3.value.replace(new RegExp("[\\*]+"),"*").trim(),$v_3=$v_0.GetParameter("quickfind");if(isNullOrEmptyString($v_2)&&(!isNullOrEmptyString($v_3)||!isNullOrEmptyString(this.$Z_3.getAttribute("defaultValue")))){this.$2f_3();return}}this.$3k_3()}},$4P_3:function(){var $v_0=$find(this.get_$P_3()+"_SavedNewQuerySelector");if(!IsNull($v_0))return $v_0;else return $find(this.get_$P_3()+"_SavedQuerySelector")},RunQuickFind:function(domEvent){!IsNull(domEvent)&&domEvent.preventDefault();var $v_0="",$v_1=this.$1m_3();if($v_1.GetParameter("ispreviewmode")==="1"||$v_1.GetParameter("InnerGridDisabled")==="1")return;var $v_2=$find(this.get_$P_3()+"_SavedNewQuerySelector");if($v_2&&$v_2.showNewVSControl&&!$v_2.showOriginalSelectBox){$v_0=$v_2.viewEntityName;if($v_2.selectedViewName!==window.LOCID_SEARCH_RESULTS){this.$16_3=$v_2.selectedViewId;this.$2A_3=$v_2.selectedViewName;this.$2w_3=$v_2.selectedViewType}}else{this.$W_3=$get(this.get_$P_3()+"_SavedQuerySelector");if(!IsNull(this.$W_3))if(window.LOCID_SEARCH_RESULTS!==this.$W_3.value&&this.$W_3.value.length>0){this.$16_3=this.$W_3.value;this.$2A_3=this.$W_3.options[this.$W_3.selectedIndex].title}}if($v_0===Mscrm.InternalUtilities.EntityNames.SharePointDocument){setPerfMarkerTimestamp("QuickFindSharePointAssocitedGridStart");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);var $v_3$4=this.$Z_3.value.trim();if(isNullOrEmptyString($v_3$4)){alert(window.LOCID_SEARCH_ALERT_NO_CRITERIA);return}var $v_4=Number.parseInvariant(Xrm.Page.context.getQueryStringParameters()["etc"].toString()),$v_5=Xrm.Page.data.entity.getId();setPerfMarkerTimestamp("QuickFindSharePointAssocitedGridStart");var $v_6=$v_1.GetParameter("locationId");if(IsNull($v_6))$v_6=Mscrm.InternalUtilities._String.Empty;var $$t_A=this;Xrm.Internal.messages.searchDocument($v_4,$v_5,$v_6).then(function($p1_0){setPerfMarkerTimestamp("QuickFindSharePointAssocitedGridSDKEnd");$$t_A.$79_3($p1_0,$v_3$4)},Mscrm.QuickFindControl.$6r);return}if($v_0==="kbarticle"){var $v_7=this.$Z_3.value.replace(new RegExp("[\\*]+"),"*").trim();if(isNullOrEmptyString($v_7)){alert(window.LOCID_SEARCH_ALERT_NO_CRITERIA);return}else if(Mscrm.ArticleSearchRibbon.searchType==="SubjectSearch"&&Mscrm.ArticleSearchRibbon.selectedSubjectId==="00000000-0000-0000-0000-000000000000"){alert(window.LOCID_SUBJECT_ALERT_NO_CRITERIA);return}Mscrm.ArticleSearchRibbon.set_gridId(this.get_$P_3());Mscrm.ArticleSearchRibbon.findArticles(this.$Z_3.value);this.$2f_3();return}quickFind($v_1)&&this.$2f_3()},$79_3:function($p0,$p1){var $v_0=$p0.get_searchLocation().toString(),$v_1=$p0.get_documentLocation().toString(),$v_2=Mscrm.CrmUri.create($v_0);$v_2.get_query()["u"]=$v_1;$v_2.get_query()["k"]=$p1;setPerfMarkerTimestamp("QuickFindSharePointAssocitedGridEnd");openStdWin($v_2,buildWinName(null),1e3,800,null)},clearQuickFind:function(domEvent){!IsNull(domEvent)&&domEvent.preventDefault();var $v_0="",$v_1=this.$1m_3();if($v_1.GetParameter("InnerGridDisabled")==="1")return;$v_1.SetParameter("quickfind","");var $v_2=false,$v_3=$find(this.get_$P_3()+"_SavedNewQuerySelector"),$v_4=!IsNull($v_3)&&$v_3.showNewVSControl;if($v_3)$v_0=$v_3.viewEntityName;if($v_0==="kbarticle")Mscrm.ArticleSearchRibbon.closeArticleSearch();else{if($v_4&&!IsNull(this.$16_3)){$v_3.setViewForNewSavedQuerySelector(this.$2A_3,this.$16_3,this.$2w_3);if(!$v_3.showOriginalSelectBox){$v_2=true;handleView(null,$v_1)}}this.$W_3=$get(this.get_$P_3()+"_SavedQuerySelector");if(!IsNull(this.$W_3)&&!IsNull(this.$16_3)){this.$W_3.value=this.$16_3;!$v_2&&XUI.Html.DispatchDomEvent(this.$W_3,XUI.Html.CreateDomEvent("change"))}else!$v_2&&clearFind($v_1)}this.NotifyExitedQuickFind();this.$Z_3.focus()},NotifyExitedQuickFind:function(){this.$3k_3();this.$Z_3.value="";var $v_0=Mscrm.CrmUIBehavior.getBehaviorByName(this.$Z_3,"HintText");$v_0.notifyTextChanged(null)},SyncQuickFindButton:function(){if(!isNullOrEmptyString(this.$Z_3.value))this.$2f_3();else this.$3k_3()},$3k_3:function(){if(!IsNull(this.$v_3)){this.$v_3.style.display="inline-block";var $v_0=XUI.Html.DomUtils.GetFirstChild(this.$v_3);if(!IsNull($v_0)){var $v_1=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create($v_0.getAttribute("imgBase")+".gif"));$v_0.src=$v_1.source;$v_0.className=Mscrm.ImageStrip.replaceExistingImageStripClass($v_0.className,$v_1.cssClass)}}if(!IsNull(this.$11_3))this.$11_3.style.display="none"},$2f_3:function(){this.$11_3.style.display="inline-block";this.$v_3.style.display="none";var $v_0=XUI.Html.DomUtils.GetFirstChild(this.$11_3);$v_0.src=$v_0.getAttribute("imgBase")+".gif"},GetSavedViewIds:function(){var $v_0={};$v_0["ViewId"]=this.$16_3;$v_0["ViewTitle"]=this.$2A_3;$v_0["ViewType"]=this.$2w_3;return $v_0}};Mscrm.SortColumns=function(){this.columns=new Array(0)};Mscrm.SortColumns.prototype={toggle:function(columnName,append){var $v_0=new Mscrm.SortColumnInfo;$v_0.$k_0=columnName;var $v_1=this.$4d_0(columnName);if($v_1!==-1){$v_0.$s_0=!this.columns[$v_1].$s_0;if(append){this.columns[$v_1]=$v_0;return}}if(!append)this.columns=new Array(0);this.columns[this.columns.length]=$v_0},sort:function(columnName,sortOrder){this.multipleSort(columnName,sortOrder,false)},multipleSort:function(columnName,sortOrder,append){var $v_0=new Mscrm.SortColumnInfo;$v_0.$k_0=columnName;$v_0.$s_0=sortOrder;if(append){var $v_1=this.$4d_0(columnName);if($v_1!==-1){this.columns[$v_1]=$v_0;return}}else this.columns=new Array(0);this.columns[this.columns.length]=$v_0},$4d_0:function($p0){for(var $v_0=this.columns.length,$v_1=0;$v_1<$v_0;$v_1++)if(this.columns[$v_1].$k_0===$p0)return $v_1;return -1},deserialize:function(gridParameter){for(var $v_0=gridParameter.split(";"),$v_1=$v_0.length,$v_2=0;$v_2<$v_1;$v_2++){var $v_3=new Mscrm.SortColumnInfo;$v_3.deserialize($v_0[$v_2]);this.columns[this.columns.length]=$v_3}},serialize:function(){for(var $v_0="",$v_1=this.columns.length,$v_2=0;$v_2<$v_1;$v_2++){if($v_2>0)$v_0+=";";$v_0+=this.columns[$v_2].serialize()}return $v_0}};Mscrm.SortColumnInfo=function(){};Mscrm.SortColumnInfo.prototype={$k_0:"",$s_0:true,get_name:function(){return this.$k_0},set_name:function(value){this.$k_0=value;return value},get_ascend:function(){return this.$s_0},set_ascend:function(value){this.$s_0=value;return value},deserialize:function(column){var $v_0=column.split(":");if($v_0.length===2){this.$k_0=$v_0[0];this.$s_0=$v_0[1]==="1"}},serialize:function(){return this.$k_0+":"+(this.$s_0?"1":"0")}};Mscrm.ProductEntityInlineEditGrid=function(){this.$p_0=["{A1FAA578-24AF-4ED6-B36D-47842E7E9B1E}","{01010DE7-749E-4FE6-8037-ACA560A4FCBE}","{9AC6A187-5FB8-445C-914A-3B4A33C0017E}","{CF23F371-4C2E-44DF-BCEF-C8971249BBE0}"]};Mscrm.ProductEntityInlineEditGrid.onGridRefreshRecalculateRecord=function(sender,args){Mscrm.GridControlLite.recalculateRecord()};Mscrm.ProductEntityInlineEditGrid.prototype={$33_0:null,$6R_0:function(){return Xrm.Page.data.entity.attributes.get("totalamount").controls.get(0).get_dataContext().get_currencySymbol()},gridPreInitialize:function(grid){for(var $v_0=grid.$2_0.GetParameter("viewid"),$v_1=false,$v_2=0;$v_2<this.$p_0.length;$v_2++)if($v_0===this.$p_0[$v_2]){$v_1=true;break}grid.$1F_0=this.$6R_0();if(grid.$K_0)grid.$K_0=$v_1;this.$33_0=grid},getGridCellInlineControlMode:function(grid,currentRow,attributeName){var $v_0=Mscrm.InlineEditControlMode.locked;switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.QuoteDetail:var $v_1=grid.getHiddenTableCellValue(currentRow,"isexisting"),$v_2=grid.isNewRecord(currentRow),$v_3=false;if(!IsNull(grid.$2_0.get_lockPriceContextualButton()))$v_3=grid.$2_0.isPriceLocked();switch(attributeName){case "priceperunit":case "productname":if(!$v_3)if($v_1==="0"||$v_2)$v_0=Mscrm.InlineEditControlMode.normal;break;case "manualdiscountamount":$v_0=Mscrm.InlineEditControlMode.normal;break;case "quantity":$v_2&&grid.setTableCellValue(currentRow,attributeName,"1",true);$v_0=Mscrm.InlineEditControlMode.normal;break;default:$v_0=Mscrm.InlineEditControlMode.locked;break}break;default:$v_0=Mscrm.InlineEditControlMode.locked;break}return $v_0},gridRowSave:function(grid,currentRow){switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:this.$2b_0(grid,Mscrm.EntityLogicalNames.SalesOrderDetail,currentRow);break;case Mscrm.EntityTypeCode.OpportunityProduct:this.$2b_0(grid,Mscrm.EntityLogicalNames.OpportunityProduct,currentRow);break;case Mscrm.EntityTypeCode.InvoiceDetail:this.$2b_0(grid,Mscrm.EntityLogicalNames.InvoiceDetail,currentRow);break;case Mscrm.EntityTypeCode.QuoteDetail:this.$2b_0(grid,Mscrm.EntityLogicalNames.QuoteDetail,currentRow);break;default:break}},updateControlStyle:function(attributeMetadata,inlineEditGridControl){return},$2b_0:function($p0,$p1,$p2){var $v_0="{00000000-0000-0000-0000-000000000000}",$v_1="{00000000-0000-0000-0000-000000000000}",$v_2=-99,$v_3=$p0.isNewRecord($p2);if(!$v_3){$v_0=$p0.getHiddenTableCellValue($p2,"oid");$v_2=$p0.getHiddenTableCellValue($p2,"sequencenumber");$v_1=$p0.getHiddenTableCellValue($p2,"productid")}var $v_4=$p0.getTableCellValue($p2,"productname"),$v_5=$p0.getTableCellValue($p2,"priceperunit"),$v_6=$p0.getTableCellValue($p2,"quantity"),$v_7=$p0.getTableCellValue($p2,"manualdiscountamount");if(!IsNull($v_4)&&($v_3||!IsNull($v_6))){if(IsNull($v_6))$v_6=0;if(IsNull($v_7))$v_7=0;if(IsNull($v_5))$v_5=0;if(IsNull($v_2))$v_2=-99;if(isNullOrEmptyString($v_0))$v_0="{00000000-0000-0000-0000-000000000000}";if(isNullOrEmptyString($v_1))$v_1="{00000000-0000-0000-0000-000000000000}";if($v_6<0&&$v_5<0){alert(window.LOCID_QTY_PRICE_NEGATIVE);var $v_8={};$v_8["DisplayText"]=window.LOCID_QTY_PRICE_NEGATIVE;var $v_9={};$v_9["_error"]=$v_8;$p0.onRowSaveFailure($v_9)}else!Mscrm.InlineEditDataService.get_busy()&&Mscrm.InlineEditDataService.createProduct($v_3,$p0.$C_0,$v_1,$p1,$v_4,$v_5,$v_6,$v_7,$v_0,$v_2,$p0.$$d_onRowSaveSuccess,$p0.$$d_onRowSaveFailure)}else $p0.resetCurrentSaveRow()},gridRowInitialize:function(grid,currentRow){if(!IsNull(currentRow))switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.QuoteDetail:!grid.isNewRecord(currentRow)&&this.$5K_0(grid,currentRow);break;default:break}},openProductLineItemForm:function(otc,isWriteInProduct){var $v_0=this.$33_0.$2_0.getFormData(),$v_1=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[$v_0.get_typeName().toLowerCase()];if(otc!==Mscrm.EntityTypeCode.OpportunityProduct){createNewLineItem(otc,$v_1,$v_0.get_recordId(),null,isWriteInProduct);this.$33_0.$2_0.add_onRefresh(Mscrm.ProductEntityInlineEditGrid.onGridRefreshRecalculateRecord)}else locAddRelatedToNonForm(otc,$v_1,$v_0.get_recordId(),"")},gridAttributeInitialValue:function(currentRow,grid,currentInitialValue,attributeMetadata){var $v_0=currentInitialValue;switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.QuoteDetail:if(attributeMetadata.LogicalName==="quantity")if(isNullOrEmptyString(currentInitialValue))$v_0="1";else{var $v_1=attributeMetadata.LogicalName+"_rawvalue";$v_0=grid.getHiddenTableCellValue(currentRow,$v_1);$v_0=$v_0.replace(",",".")}if(attributeMetadata.LogicalName==="productdescription")attributeMetadata.RequiredLevel=2;if(attributeMetadata.LogicalName==="priceperunit"||attributeMetadata.LogicalName==="manualdiscountamount"||attributeMetadata.LogicalName==="extendedamount")if(isNullOrEmptyString(currentInitialValue))$v_0="0";else{var $v_2=attributeMetadata.LogicalName+"_rawvalue";$v_0=grid.getHiddenTableCellValue(currentRow,$v_2);$v_0=$v_0.replace(",",".")}break}return $v_0},$5K_0:function($p0,$p1){var $v_0=$p0.getHiddenTableCellValue($p1,"isexisting");if($p0.isNewRecord($p1)){$v_0="0";$p0.setHiddenTableCellValue($p1,"isexisting","0")}if(isNullOrEmptyString($v_0))this.$3j_0($p0,false,$p1);else if($v_0==="0")this.$3j_0($p0,true,$p1);else this.$3j_0($p0,false,$p1)},gridRowSaveSuccessAction:function(grid,currentSaveRow,response){switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.QuoteDetail:var $v_0=response["extendedamount"];if(!IsNull($v_0)){var $v_5=$v_0["raw"];!IsNull($v_5)&&grid.setTableCellValue(currentSaveRow,"extendedamount",$v_5,true)}var $v_1=response["productid"];if(!IsNull($v_1)){var $v_6=$v_1["oid"];!IsNull($v_6)&&grid.setHiddenTableCellValue(currentSaveRow,"productid",$v_6)}var $v_2=response["_entity"];if(!IsNull($v_2)){var $v_7=$v_2["Id"];if(!IsNull($v_7)){grid.setHiddenTableCellValue(currentSaveRow,"oid",$v_7);if(grid.isNewRecord(currentSaveRow)){var $v_8=currentSaveRow.querySelector("div.ms-crm-List-DeleteContainer-Div");if(!IsNull($v_8)){var $v_9=XUI.Html.DomUtils.GetFirstChild($v_8);if(!IsNull($v_9))$v_9.id="gridBodyTable_delete_"+currentSaveRow.getAttribute("oid")+"_"+currentSaveRow.getAttribute("rowindex")}}}}var $v_3=response["productdescription"];if(!IsNull($v_3)){var $v_A=$v_3["value"];if(!IsNull($v_A)){var $v_B=CrmEncodeDecode.CrmXmlDecode($v_A);grid.setTableCellValue(currentSaveRow,"productname",CrmEncodeDecode.CrmHtmlDecode($v_B),false)}}this.$5K_0(grid,currentSaveRow);var $v_4=grid.getHiddenTableCellValue(currentSaveRow,"onlyHiddenValueChanged");if(!isNullOrEmptyString($v_4)){var $v_C=$v_4.toUpperCase();$v_C==="FALSE"&&Mscrm.GridControlLite.recalculateRecord()}break}return},gridRowSaveFailureAction:function(grid,currentSaveRow,response){switch(grid.$C_0){case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.QuoteDetail:break}return},$3j_0:function($p0,$p1,$p2){var $v_0=$p1?"/_imgs/grid/icon_18_writeinproduct.png":"";$p0.addOrRemoveImage($p2,$v_0)}};Mscrm.SaveQueueInlineEdit=function(){this.$m_0=[]};Mscrm.SaveQueueInlineEdit.prototype={$m_0:null,enqueue:function(queueItem){if(IsNull(this.$m_0))this.$m_0=[];this.$m_0.push(queueItem)},dequeue:function(){return this.$m_0.shift()},peek:function(){return this.$m_0[0]},get_length:function(){return this.$m_0.length},get_saveQueue:function(){return this.$m_0}};Mscrm.InlineEditGrid=function(){this.$$d_$7X_0=Function.createDelegate(this,this.$7X_0);this.$$d_$7Y_0=Function.createDelegate(this,this.$7Y_0);this.$$d_$7Z_0=Function.createDelegate(this,this.$7Z_0);this.$$d_$5u_0=Function.createDelegate(this,this.$5u_0);this.$$d_$5v_0=Function.createDelegate(this,this.$5v_0);this.$$d_$7o_0=Function.createDelegate(this,this.$7o_0);this.$$d_$4o_0=Function.createDelegate(this,this.$4o_0);this.$$d_$7p_0=Function.createDelegate(this,this.$7p_0);this.$$d_$75_0=Function.createDelegate(this,this.$75_0);this.$$d_$8n_0=Function.createDelegate(this,this.$8n_0);this.$$d_onRowSaveFailure=Function.createDelegate(this,this.onRowSaveFailure);this.$$d_onRowSaveSuccess=Function.createDelegate(this,this.onRowSaveSuccess);this.$C_0=-1};Mscrm.InlineEditGrid.prototype={$1_0:null,$g_0:null,$40_0:null,$d_0:null,$13_0:null,$Q_0:null,$a_0:null,$V_0:null,$12_0:null,$j_0:false,$2_0:null,$2y_0:null,$43_0:false,$8_0:null,$x_0:null,$K_0:false,$2L_0:false,$1u_0:true,$A_0:null,$1F_0:"",get_parentGridControl:function(){return this.$2_0},get_entityTypeCode:function(){return this.$C_0},get_enableInlineEdit:function(){return this.$K_0},set_enableInlineEdit:function(value){this.$K_0=value;return value},get_entityHandler:function(){return this.$A_0},get_currencySymbol:function(){return this.$1F_0},set_currencySymbol:function(value){this.$1F_0=value;return value},get_isGridInlineEditInitialized:function(){return this.$j_0},set_isGridInlineEditInitialized:function(value){this.$j_0=value;return value},get_canRollbackDefaultData:function(){return this.$1u_0},set_canRollbackDefaultData:function(value){this.$1u_0=value;return value},initialize:function(parentControl,entityHandler,editEnabled){this.$40_0=parentControl.get_element();this.$2_0=parentControl;this.$2y_0=parentControl.getFormData();var $v_0=$P_CRM("#gridBodyTable",this.$40_0);this.$j_0=false;if(IsNull($v_0[0])){var $$t_4=this;window.setTimeout(function(){$$t_4.initialize(parentControl,entityHandler,editEnabled)},10);return}if(Mscrm.PageManager.get_isUnloading())return;this.$K_0=editEnabled;this.$A_0=entityHandler;!IsNull(this.$A_0)&&this.$A_0.gridPreInitialize(this);this.initializeGridView($v_0);this.$2_0.displayProductGridButtons(this.$K_0)},initializeGridView:function(dataTable){this.$V_0=dataTable[0];this.$2L_0&&this.$3l_0();this.$6X_0(dataTable);this.$6W_0(dataTable);this.$7t_0(dataTable)},dispose:function(){if(this.$j_0){this.$3l_0();var $v_0=$P_CRM(this.$V_0).children("tbody").children("tr");if(!IsNull($v_0))for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];this.$3J_0($v_2)}}$removeHandler(window,"beforeunload",this.$$d_$8n_0)},$3J_0:function($p0){var $v_0=$P_CRM($p0);$v_0.off("SaveInlineRecord",this.$$d_$75_0);for(var $v_1=$P_CRM("td",$p0),$v_2=0;$v_2<$v_1.length;$v_2++)if(!isNullOrEmptyString(this.$1_0[$v_2])){var $v_3=this.$1_0[$v_2],$v_4=this.$Q_0[$v_3];if(!$v_4){var $v_5=this.getCellAttributeId($p0,this.$1_0[$v_2],false);this.$5y_0($v_5)}}},$5y_0:function($p0){var $v_0=this.$13_0[$p0];if(!IsNull($v_0)&&!$v_0.get_isDisposed()){for(var $v_1=$find($v_0.get_dataContext().get_attribute().get_dataAttributeId()),$v_2=0;$v_2<$v_1.get_controls().getLength();$v_2++)this.$60_0($v_1.get_controls().get($v_2));delete this.$13_0[$p0];this.$5z_0($v_1)}},$60_0:function($p0){!IsNull($p0)&&$p0.dispose()},$5z_0:function($p0){!IsNull($p0)&&$p0.dispose()},$5F_0:function(){if(this.$2L_0){this.checkForAllDirtyRows(true);var $$t_0=this;window.setTimeout(function(){$$t_0.$5F_0()},2e3)}},$6X_0:function($p0){var $v_0=$p0.attr("oname");if(!isNullOrEmptyString($v_0))this.$C_0=Number.parseInvariant($v_0)},$6W_0:function($p0){var $v_0=$p0.children("colgroup"),$v_1=$P_CRM("col",$v_0[0]);this.$1_0=new Array($v_1.length);this.$g_0={};this.$d_0={};this.$13_0={};this.$Q_0={};for(var $v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$P_CRM($v_1[$v_2]),$v_4=$v_3.attr("name"),$v_5=$v_3.attr("metadataJson"),$v_6=$v_3.attr("style");if(isNullOrEmptyString($v_4))this.$1_0[$v_2]="";else{this.$1_0[$v_2]=$v_4;if(!isNullOrEmptyString($v_6)&&!$v_3.is(":visible"))this.$Q_0[$v_4]=true;else this.$Q_0[$v_4]=false;var $v_7=$P_CRM.parseJSON($v_5);this.$g_0[$v_4]=$v_7}}},getIconCellColumnIndex:function(){return this.$3U_0(3,$P_CRM(this.$V_0))},$3U_0:function($p0,$p1){for(var $v_0=$p1.children("colgroup"),$v_1=$P_CRM("col",$v_0[0]),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$P_CRM($v_1[$v_2]),$v_4=$v_3.attr("class");if(!isNullOrEmptyString($v_4)){$v_4=$v_4.trimEnd();$v_4=$v_4.trimStart()}switch($p0){case 1:if(isNullOrEmptyString($v_4))return $v_2;break;case 2:if($v_4==="ms-crm-List-CheckBoxColumn")return $v_2;break;case 3:if($v_4==="ms-crm-List-RowIconColumn")return $v_2;break}}return 0},$5q_0:function($p0,$p1){var $v_0=document.createElement("div"),$v_1=$P_CRM($v_0);$v_1.attr(Mscrm.InlineEditConstants.HtmlAttributeForAttributeLogicalName,$p0);$v_1.attr("id",$p0);$v_1.attr("dummy-data-attributename",$p0);$v_1.attr("data-fdeid","PrimaryEntity");$v_1.attr("class","ms-crm-Inline-Edit-SubGrid-Cell");var $v_2=this.$V_0.getAttribute("tabindex");$v_0.setAttribute("tabindex",$v_2);var $v_3=this.$5Y_0($v_0,$p1),$v_4=this.$5a_0($v_3);return $v_4},$5a_0:function($p0){var $v_0=document.createElement("div"),$v_1=$P_CRM($v_0);$v_1.attr("class","ms-crm-Inline-Value");$p0.appendChild($v_0);return $p0},$5Y_0:function($p0,$p1){var $v_0=document.createElement("div"),$v_1=document.createElement("span"),$v_2=$P_CRM($v_0);$v_2.attr("id",$p0.id+"_c");$v_2.css("display","none");var $v_3=$P_CRM($v_1);$v_3.attr("class","ms-crm-InlineEditLabel");$v_3.text($p1);$v_0.appendChild($v_1);$p0.appendChild($v_0);return $p0},$6O_0:function($p0){if(!IsNull(this.$g_0[$p0])){var $v_0={};$v_0=$P_CRM.extend($v_0,this.$g_0[$p0]);return $v_0}else return null},$6M_0:function($p0,$p1,$p2){var $v_0=this.$6O_0(this.$1_0[$p0]),$v_1=$p1.parentNode;if(!IsNull($v_0)){var $v_2=this.getCellAttributeId($v_1,this.$1_0[$p0],false),$v_3=this.$6a_0($v_1,$p0),$v_4=this.$5q_0($v_2,$v_0.LogicalName),$v_5=XUI.Html.DomUtils.GetFirstChild($p1),$v_6=$P_CRM($v_5),$v_7=$v_6.text();if(!IsNull(this.$A_0))$v_7=this.$A_0.gridAttributeInitialValue($v_1,this,$v_7,$v_0);$p1.removeChild($v_5);$p1.appendChild($v_4);var $v_8=this.$7s_0($v_0,$v_4,$v_3,$v_7);if(!IsNull($v_8)){var $v_9=$P_CRM($p1),$v_A=$v_8;$v_9.css("overflow","visible");this.$8q_0($v_0,$v_A,$v_7,$p2);this.$A_0.updateControlStyle($v_0,$v_8);if(!this.$j_0)if($v_A.get_controlMode()===Mscrm.InlineEditControlMode.alwaysEdit||$v_A.get_controlMode()===Mscrm.InlineEditControlMode.normal)this.$j_0=true}else{this.$d_0[$v_2]=$v_7;$p1.removeChild($v_4);$p1.appendChild($v_5)}}},$8q_0:function($p0,$p1,$p2,$p3){var $v_0=$find($p1.get_dataContext().get_attribute().get_dataAttributeId());$v_0.get_controls().add($p1);!IsNull(this.$2y_0)&&this.$2y_0.get_attributes().remove($v_0);switch($p0.AttributeType){case "decimal":var $v_1=this.getCurrencyValue($p2);$v_0.forceResetValue($v_1);break;case "money":var $v_2=this.getCurrencyValue($p2);$v_0.resetValue($v_2);break;case "picklist":$v_0.forceResetValue(parseInt($p2));break;default:if($p3)return;$v_0.resetValue($p2);break}},$7s_0:function($p0,$p1,$p2,$p3){var $v_0=null,$v_1=$p3,$v_2=null;if(!IsNull($v_1)){$v_0={};$v_0["raw"]=$v_1;$v_0["defaultvalue"]=$v_1;$v_0["value"]=$v_1}$p0.LogicalName=$p1.id;switch($p0.AttributeType){case "money":var $v_5=$p0,$v_6=this.$66_0($v_5);$v_5.CurrencySymbol=$v_6;var $v_7=this.getCurrencyValue($v_1);if(IsNull($v_0))$v_0={};$v_0["symbol"]=$v_6;$v_0["precision"]=$v_5.Precision.toString();$v_0["value"]=$v_7;$v_0["raw"]=$v_7.toString();break;case "decimal":if(IsNull($v_0)){$v_0={};$v_0["value"]="0";$v_0["raw"]="0"}else{var $v_8=this.getCurrencyValue($v_1);$v_0["value"]=$v_8;$v_0["raw"]=$v_8.toString()}break;case "picklist":if(IsNull($v_0)){$v_0={};$v_0["value"]=null;$v_0["raw"]=null;$v_0["defaultvalue"]="-1"}break}var $v_3=$P_CRM($p1);$v_2=Mscrm.InlineControlFactory.initializeUnboundedField($v_3,$p0,$v_0,$p1.id,$p2);var $v_4=$v_2;$v_4.initializeAndRenderEditView();this.$13_0[$p1.id]=$v_2;return $v_2},$6V_0:function($p0){var $v_0=document.createElement("div"),$v_1=document.createElement("a"),$v_2=document.createElement("img");$v_1.appendChild($v_2);$v_0.appendChild($v_1);var $v_3=$P_CRM($v_0);$v_3.attr("class","ms-crm-List-ErrorStatusIcon");$v_3.attr("id",CrmEncodeDecode.CrmHtmlAttributeEncode("ErrorStatusLink_"+$p0));var $v_4=$P_CRM($v_1);$v_4.attr("href","#");$v_4.attr("id",CrmEncodeDecode.CrmHtmlAttributeEncode("ErrorStatusIcon_"+$p0));$v_4.attr("tabindex",this.$V_0.tabIndex+"");var $v_5=$P_CRM($v_2);$v_5.attr("src","/_imgs/inlineedit/warning.png");$v_5.attr("alt","");$v_5.attr("class","ms-crm-ImageStrip-inlineedit_warning");return $v_3},$6U_0:function($p0){var $v_0=document.createElement("div"),$v_1=$P_CRM($v_0);$v_1.attr("id",CrmEncodeDecode.CrmHtmlAttributeEncode("div_errorFlyout_"+$p0));$v_1.attr("class","ms-crm-List-ErrorStatusIcon-FlyOut");return $v_1},$5U_0:function($p0){var $v_0=this.getHiddenTableCellValue($p0,"rowIndex");if(!IsNull($v_0)){var $v_1="r"+$v_0+"c0";if(IsNull(this.$a_0))this.$a_0={};if(IsNull(this.$a_0[$v_1])){var $v_2=$P_CRM("td",$p0),$v_3=this.$6V_0($v_1),$v_4=this.$6U_0($v_1),$v_5=$v_2[0],$v_6=$P_CRM($v_5);$v_6.append($v_3);$v_6.append($v_4);$v_6.css("overflow","visible");var $v_7=new Mscrm.ErrorFlyout($v_3,$v_4,$P_CRM(window.document.body));this.$a_0[$v_1]=$v_7;$v_3.css("display","none");$v_4.addClass("ms-crm-Inline-Validation");$v_3.mouseover(this.$$d_$7p_0);$v_4.mouseout(this.$$d_$4o_0);$v_4.click(this.$$d_$7o_0)}}},$8M_0:function($p0){var $v_0=this.getHiddenTableCellValue($p0,"rowIndex");if(!IsNull($v_0)){var $v_1="r"+$v_0+"c0",$v_2=$P_CRM("td",$p0),$v_3=$v_2[0],$v_4=$P_CRM($v_3);$v_4.removeAttr("overflow");var $v_5="#"+CrmEncodeDecode.CrmHtmlAttributeEncode("ErrorStatusLink_"+$v_1),$v_6=$P_CRM($v_5,$v_2[0]),$v_7="#"+CrmEncodeDecode.CrmHtmlAttributeEncode("div_errorFlyout_"+$v_1),$v_8=$P_CRM($v_7,$v_2[0]);$v_6.off("mouseOver",this.$$d_$7p_0);$v_6.unbind();$v_8.off("mouseOut",this.$$d_$4o_0);$v_8.unbind();$v_6.remove();$v_8.remove();var $v_9=this.$a_0[$v_1];$v_9.dispose();delete this.$a_0[$v_1]}},$7t_0:function($p0){if(!IsNull($p0)){var $v_0=$p0.children("tbody").children("tr");if(!IsNull($v_0)){this.$12_0={};for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1],$v_3=$P_CRM($v_2);this.$5m_0($v_2);$v_3.attr("rowIndex",$v_1.toString());if(this.$K_0){$v_3.attr("rowIndex",$v_1.toString());this.$4p_0($v_2);var $v_4=$v_3.attr("otype");if(!isNullOrEmptyString($v_4))if(this.$C_0<0)this.$C_0=Number.parseInvariant($v_4);this.$12_0[$v_1.toString()]=false;var $v_5=$P_CRM($v_2);$v_5.on("SaveInlineRecord",this.$$d_$75_0)}this.addOrRemoveImage($v_2,"");!IsNull(this.$A_0)&&this.$A_0.gridRowInitialize(this,$v_2)}}this.$4y_0()}},$5m_0:function($p0){var $v_0=$P_CRM("td",$p0);if($v_0.length>1){var $v_1=$v_0[1],$v_2=$P_CRM("img",$v_1);$v_2.length>0&&$v_2.attr("class","StatusImage")}},$4y_0:function(){if(!this.$43_0)if(this.$j_0){if(IsNull(this.$x_0))this.$x_0=new Mscrm.SaveQueueInlineEdit;this.$8m_0();this.$43_0=true}$addHandler(window,"beforeunload",this.$$d_$8n_0)},$4p_0:function($p0){for(var $v_0=$P_CRM("td",$p0),$v_1=this.isNewRecord($p0),$v_2=0;$v_2<$v_0.length;$v_2++)if(!isNullOrEmptyString(this.$1_0[$v_2])){var $v_3=$v_0[$v_2],$v_4=this.getCellAttributeId($p0,this.$1_0[$v_2],false),$v_5=$P_CRM("#"+$v_4,$v_3);IsNull($v_5[0])&&this.$6M_0($v_2,$v_3,$v_1)}this.$7R_0($p0)},$7R_0:function($p0){for(var $v_0=this.isNewRecord($p0),$v_1=0;$v_1<this.$1_0.length;$v_1++)if(!isNullOrEmptyString(this.$1_0[$v_1])){var $v_2=this.$1_0[$v_1],$v_3=this.getCellAttributeId($p0,this.$1_0[$v_1],this.$Q_0[this.$1_0[$v_1]]);if($v_0){if(!IsNull(this.$d_0[$v_3])){var $v_4="",$v_5=0,$v_6=this.$g_0[$v_2];this.$d_0[$v_3]=$v_4;if(!IsNull($v_6))if($v_6.AttributeType==="money"||$v_6.AttributeType==="decimal")this.$d_0[$v_3]=$v_5}}else this.$d_0[$v_3]=this.getTableCellValue($p0,this.$1_0[$v_1])}},$8h_0:function($p0,$p1){$p0.attr("rowIndex",$p1.toString());while(this.$5l_0($p0[0])){$p1=$p1+1;$p0.attr("rowIndex",$p1.toString())}$p0.attr("id","row"+$p1.toString());return $p1},$5l_0:function($p0){for(var $v_0=false,$v_1=$P_CRM("td",$p0),$v_2=0;$v_2<$v_1.length;$v_2++)if(!isNullOrEmptyString(this.$1_0[$v_2])){var $v_3=this.getCellAttributeId($p0,this.$1_0[$v_2],false),$v_4=Xrm.Page.data.entity.attributes.get($v_3);if(!IsNull($v_4))$v_0=true;break}return $v_0},$8W_0:function($p0){for(var $v_0=0;$v_0<this.$1_0.length;$v_0++)if(!isNullOrEmptyString(this.$1_0[$v_0])){var $v_1=this.$1_0[$v_0],$v_2=this.getCellAttributeId($p0,this.$1_0[$v_0],this.$Q_0[this.$1_0[$v_0]]),$v_3=this.$g_0[$v_1],$v_4=this.$d_0[$v_2];if(!IsNull($v_3))switch($v_3.AttributeType){case "money":case "decimal":var $v_5=this.getCurrencyValue($v_4);this.setTableCellValue($p0,$v_1,$v_5,false);break;case "picklist":this.setTableCellValue($p0,$v_1,isNullOrEmptyString($v_4)?"-1":$v_4,true);break;default:this.setTableCellValue($p0,$v_1,$v_4,false);break}}},$8r_0:function($p0,$p1){if(!IsNull($p1))for(var $v_0=0;$v_0<this.$1_0.length;$v_0++)if(!isNullOrEmptyString(this.$1_0[$v_0])){var $v_1=this.$1_0[$v_0],$v_2=$p1[$v_1];if(!IsNull($v_2)){var $v_3=$v_2["raw"];if(IsNull($v_3))$v_3=$v_2["value"];if(!IsNull($v_3)){var $v_4=this.$g_0[$v_1];if(!IsNull($v_4))switch($v_4.AttributeType){case "money":case "decimal":var $v_5=this.getCurrencyValue($v_3);this.setTableCellValue($p0,$v_1,$v_5,false);break;case "picklist":this.setTableCellValue($p0,$v_1,isNullOrEmptyString($v_3)?-1:parseInt($v_3),true);break;case "int":if(IsNull(this.$Q_0[$v_1]))this.setTableCellValue($p0,$v_1,parseInt($v_3),false);else if(this.$Q_0[$v_1])this.setTableCellValue($p0,$v_1,$v_3,false);else this.setTableCellValue($p0,$v_1,parseInt($v_3),false);break;default:this.setTableCellValue($p0,$v_1,$v_3,false);break}}}}},$6a_0:function($p0,$p1){if(!this.$K_0)return Mscrm.InlineEditControlMode.locked;var $v_0="";if(!IsNull(this.$A_0)){var $v_1=this.$1_0[$p1];$v_0=this.$A_0.getGridCellInlineControlMode(this,$p0,$v_1)}if(isNullOrEmptyString($v_0))return Mscrm.InlineEditControlMode.locked;else return $v_0},setHiddenTableCellValue:function(row,attributeName,value){if(!IsNull(row)){var $v_0=$P_CRM(row),$v_1=this.getCellAttributeId(row,attributeName,true);this.$d_0[$v_1]=value;$v_0.attr(attributeName,value)}},getHiddenTableCellValue:function(row,attributeName){if(!IsNull(row)){var $v_0=$P_CRM(row);return $v_0.attr(attributeName)}return null},setTableCellValue:function(row,attributeName,value,isResetAttribute){if(this.$Q_0[attributeName]){this.setHiddenTableCellValue(row,attributeName,value);return}var $v_0=this.getAttributeIndex(attributeName);if($v_0>=0){var $v_1=this.getCellAttributeId(row,attributeName,false),$v_2=this.$13_0[$v_1];if(!IsNull($v_2))if($v_2.get_isValid()){this.$d_0[$v_1]=value;var $v_3=$find($v_2.get_dataContext().get_attribute().get_dataAttributeId());if(isResetAttribute)$v_3.resetValue(value);else $v_3.set_value(value)}}},$4i_0:function($p0,$p1,$p2){if(this.$Q_0[$p1])return this.getHiddenTableCellValue($p0,$p1);var $v_0=this.getAttributeIndex($p1);if($v_0>=0){var $v_1=this.getCellAttributeId($p0,$p1,false),$v_2=this.$13_0[$v_1];if(!IsNull($v_2))if(!$p2||$p2&&$v_2.get_isValid()){var $v_3=$find($v_2.get_dataContext().get_attribute().get_dataAttributeId());return $v_3.get_value()}}return null},getTableCellValueIfValid:function(row,attributeName){return this.$4i_0(row,attributeName,true)},getTableCellValue:function(row,attributeName){return this.$4i_0(row,attributeName,false)},isNewRecord:function(row){var $v_0=this.getHiddenTableCellValue(row,"isNewRecord"),$v_1=$v_0==="true";return $v_1},addOrRemoveImage:function(element,imagePath){var $v_0=$P_CRM("td",element);if($v_0.length>0){var $v_1=$P_CRM($v_0[1]),$v_2=$P_CRM("img",$v_1);if($v_2.length<=0){var $v_3=document.createElement("img"),$v_4=$P_CRM($v_3);$v_4.attr("class","StatusImage");$v_1.append($v_4);$v_2=$v_4}if(isNullOrEmptyString(imagePath))$v_2.css("display","none");else{$v_2.css("display","inline-block");$v_2.attr("src",imagePath)}}},showRowError:function(response,gridRow){var $v_0=this.getHiddenTableCellValue(gridRow,"rowIndex");if(!IsNull($v_0)){var $v_1=response["_error"];this.$5U_0(gridRow);if(!IsNull($v_1)){var $v_5=$P_CRM(gridRow),$v_6=null;if(!IsNull($v_1["Code"])&&$v_1["Code"]==="0x80040265")$v_6=$v_1["Description"];else $v_6=$v_1["DisplayText"];$v_5.attr("errorText",CrmEncodeDecode.CrmHtmlAttributeEncode($v_6));$v_5.attr("hasError","true")}var $v_2=$P_CRM("td",gridRow),$v_3=$v_2[0],$v_4=$P_CRM(".ms-crm-List-ErrorStatusIcon",$v_3);!IsNull($v_4)&&$v_4.css("display","inline-block")}},hideRowError:function(gridRow){var $v_0=this.getHiddenTableCellValue(gridRow,"rowIndex");if(!IsNull($v_0)){var $v_1=$P_CRM(gridRow);$v_1.removeAttr("errorText");$v_1.attr("hasError","false");var $v_2="r"+$v_0+"c0",$v_3=$P_CRM("td",gridRow),$v_4=$v_3[0],$v_5=$P_CRM(".ms-crm-List-ErrorStatusIcon",$v_4);if(!IsNull($v_5)){$v_5.css("display","none");$v_5.hide();var $v_6=this.$a_0[$v_2];!IsNull($v_6)&&$v_6.hideError()}this.$8M_0(gridRow)}},$7p_0:function($p0){var $v_0=$p0.target,$v_1=$P_CRM($v_0),$v_2=$v_1.closest("tr");if($v_2.length>0){var $v_3;if($v_2[0].tagName==="TR"){$v_3=this.getHiddenTableCellValue($v_2[0],"rowIndex");if(!IsNull($v_3)){var $v_4="r"+$v_3+"c0";$p0.stopImmediatePropagation();if(!IsNull(this.$a_0[$v_4])){var $v_5=this.$a_0[$v_4];if(!IsNull($v_5)){var $v_6=CrmEncodeDecode.CrmHtmlDecode($v_2.attr("errorText"));$v_5.showError($v_6)}}}}}},$7o_0:function($p0){this.$4o_0($p0);$p0.stopPropagation();$p0.preventDefault()},$4o_0:function($p0){var $v_0=$p0.target,$v_1=$P_CRM($v_0),$v_2=$v_1.closest("tr");if($v_2.length>0){var $v_3;if($v_2[0].tagName==="TR"){$v_3=this.getHiddenTableCellValue($v_2[0],"rowIndex");if(!IsNull($v_3)){var $v_4="r"+$v_3+"c0";$p0.stopImmediatePropagation();if(!IsNull(this.$a_0[$v_4])){var $v_5=this.$a_0[$v_4];!IsNull($v_5)&&$v_5.hideError()}}}}},getAttributeIndex:function(attributeName){return Array.indexOf(this.$1_0,attributeName)},getAttributeType:function(attributeName){if(!IsNull(this.$g_0[attributeName]))return this.$g_0[attributeName].AttributeType;return null},getCurrencyValue:function(currencyValue){if(!IsNull(currencyValue)&&typeof currencyValue===Mscrm.TypeNames.numberType)return currencyValue;else if(!isNullOrEmptyString(currencyValue)){currencyValue=currencyValue.trimStart();currencyValue=currencyValue.trimEnd();var $v_0=Number(currencyValue.replace(/[^0-9\.]+/g,""));if(IsNull($v_0)){var $v_1=currencyValue.replace(this.$1F_0,"");$v_1=$v_1.replace("(","");$v_1=$v_1.replace(")","");$v_1=$v_1.replace("-","");$v_0=Number($v_1);if(IsNull($v_0))$v_0=0}if(currencyValue.startsWith("(")&&currencyValue.endsWith(")")||currencyValue.indexOf("-")!==-1)$v_0=$v_0*-1;return $v_0}else return 0},$66_0:function($p0){var $v_0="$";if(!isNullOrEmptyString(this.$1F_0))$v_0=this.$1F_0;else{var $v_1=$P_CRM(".ms-crm-CurrencySymbol-Refresh");if($v_1&&$v_1.length>0)$v_0=XUI.Html.GetText($v_1[0]);else $v_0=$p0.CurrencySymbol}return $v_0},getCellAttributeId:function(row,attributeName,isHiddenCell){var $v_0=this.getHiddenTableCellValue(row,"rowIndex"),$v_1=this.getAttributeIndex(attributeName);if(!IsNull($v_0)&&!IsNull($v_1))if(isHiddenCell)return this.$1_0[$v_1]+"_r"+$v_0.toString()+"_hidden";else return this.$1_0[$v_1]+"_r"+$v_0.toString()+"c"+$v_1.toString();return ""},$3h_0:function($p0,$p1){var $v_0=$p0?"/_imgs/btn_lookup_resolving.gif":"";if($p0){var $v_1=$P_CRM("td",$p1);if($v_1.length>0){var $v_2=$P_CRM($v_1[1]),$v_3=$P_CRM("img",$v_2);this.$4z_0($v_3)}}this.addOrRemoveImage($p1,$v_0)},$6d_0:function($p0){for(var $v_0=document.createElement("tr"),$v_1=$P_CRM($v_0),$v_2=this.$3U_0(1,$P_CRM(this.$V_0)),$v_3=this.$3U_0(3,$P_CRM(this.$V_0)),$v_4=0;$v_4<this.$1_0.length;$v_4++){var $v_5="",$v_6=false;$v_6=this.$Q_0[this.$1_0[$v_4]];$v_5=isNullOrEmptyString(this.$1_0[$v_4])?"ms-crm-List-NonDataCell":"ms-crm-List-DataCell-Lite";if($v_4===$v_2)$v_1.append(this.$5T_0($p0));else if(!$v_6){var $v_7=document.createElement("td"),$v_8=$P_CRM($v_7);$v_8.attr("class",$v_5);if($v_5==="ms-crm-List-DataCell-Lite"){var $v_9=document.createElement("span");$v_8.append($P_CRM($v_9))}$v_1.append($v_8);$v_4===$v_3&&this.$5Z_0($v_0,$v_8)}}$v_1.attr("isNewRecord","true");$v_1.attr("class","ms-crm-List-Row-Lite");return $v_1},$5Z_0:function($p0,$p1){this.addOrRemoveImage($p0,"/_imgs/grid/actions_delete_bin_16.png");var $v_0=$P_CRM("img",$p1);$v_0.click(this.$$d_$5v_0)},$4z_0:function($p0){var $v_0=$p0;$v_0.off("click",this.$$d_$5v_0)},$5v_0:function($p0){var $v_0=$p0.currentTarget;if($v_0.tagName==="IMG"){var $v_1=$P_CRM($v_0);this.$4z_0($v_1);var $v_2=$v_1.closest("tr");if($v_2.length>0){this.$3J_0($v_2[0]);$v_2.remove()}this.$52_0()}},$5u_0:function($p0){var $v_0=$p0.currentTarget;if($v_0.tagName==="A"){var $v_1=$P_CRM($v_0),$v_2=$v_1.closest("tr");$v_2.length>0&&this.$3J_0($v_2[0]);Mscrm.GridControlLite.DeleteRecordLite($v_0)}},$5T_0:function($p0){var $v_0=document.createElement("img"),$v_1=document.createElement("a"),$v_2=document.createElement("div"),$v_3=document.createElement("td");$v_0.className="ms-crm-ImageStrip-deleteButton";var $v_4=document.createAttribute("src");$v_4.value="/_imgs/grid/actions_delete_bin_16.png";$v_0.attributes.setNamedItem($v_4);$v_1.className="ms-crm-List-DeleteButton";$v_1.style.visibility="hidden";$v_1.style.right="14px";$v_1.style.backgroundColor="rgb(215, 235, 249)";var $v_5=document.createAttribute("title");$v_5.value="Delete";$v_1.attributes.setNamedItem($v_5);$v_1.href="javascript:void(0)";var $v_6=$P_CRM($v_1);$v_6.click(this.$$d_$5u_0);$v_2.className="ms-crm-List-DeleteContainer-Div";$v_2.style.display="block";$v_3.className="ms-crm-List-DeleteContainer";$v_3.id="gridBodyTable_gridDelBtn_"+$p0;$v_1.appendChild($v_0);$v_2.appendChild($v_1);$v_3.appendChild($v_2);return $P_CRM($v_3)},$5t_0:function(){if(!IsNull(this.$V_0)){var $v_0=$P_CRM(this.$V_0),$v_1=$v_0.children("tbody").children("tr");if($v_1.length===1){var $v_2=$P_CRM("td:first",$v_1),$v_3=$v_2.attr("class");if($v_3==="ms-crm-List-MessageText-Lite"){$v_2.text("");return true}}}return false},$5r_0:function(){if(!IsNull(this.$V_0)){var $v_0=$P_CRM(this.$V_0),$v_1=$v_0.children("tbody").children("tr"),$v_2=$P_CRM("tbody:first",$v_0),$v_3=$v_1.length;if(this.$5t_0())$v_3=1;var $v_4=this.$6d_0($v_3);$v_2.prepend($v_4);$v_3=this.$8h_0($v_4,$v_3);this.$52_0();this.$4p_0($v_4[0]);!IsNull(this.$A_0)&&this.$A_0.gridRowInitialize(this,$v_4[0]);var $v_5=$v_4;$v_5.on("SaveInlineRecord",this.$$d_$75_0);this.$4y_0()}},onCreateNewRecord:function(){this.$K_0&&this.$5r_0()},$7M_0:function($p0){for(var $v_0=false,$v_1=this.getHiddenTableCellValue($p0,"rowIndex"),$v_2,$v_3=this.$x_0.$m_0,$v_4=0;$v_4<$v_3.length;$v_4++){var $v_5=$v_3[$v_4];if(!IsNull($v_5)){$v_2=this.getHiddenTableCellValue($v_5,"rowIndex");if($v_2===$v_1){$v_0=true;break}}}return $v_0},$75_0:function($p0){var $v_0=$p0.currentTarget;if($v_0.tagName==="TR"){!this.$7M_0($v_0)&&this.$x_0.enqueue($v_0);this.$8Z_0()}},$8Z_0:function(){if(IsNull(this.$8_0)){var $v_0=this.$x_0.dequeue();this.$55_0($v_0)}},$55_0:function($p0){if(!IsNull($p0)){this.$8_0=$p0;if(!IsNull(this.$A_0))this.$A_0.gridRowSave(this,$p0);else this.$67_0();this.$8_0&&this.$3h_0(true,$p0)}},$67_0:function(){var $v_0={};$v_0["DisplayText"]="No Entity Handler To Save Record";$v_0["Description"]="No Entity Handler To Save Record";var $v_1={};$v_1["_error"]=$v_0;this.onRowSaveFailure($v_1)},$52_0:function(){var $v_0=$P_CRM(this.$2_0.$0_3.get_dataTableBody());this.$2_0.$0_3.get_element().setAttribute("numRecords",$v_0.children("tr").length);var $$t_1=this;window.setTimeout(function(){$$t_1.$2_0.setSubGridHeight(true)},10)},resetCurrentSaveRow:function(){this.$8_0=null},onRowSaveSuccess:function(response){var $v_0=this.getHiddenTableCellValue(this.$8_0,"rowIndex");if(!IsNull($v_0))this.$12_0[$v_0.toString()]=false;this.$3h_0(false,this.$8_0);var $v_1=this.getHiddenTableCellValue(this.$8_0,"hasError");if(!IsNull($v_1))$v_1==="true"&&this.hideRowError(this.$8_0);this.$8r_0(this.$8_0,response);!IsNull(this.$A_0)&&this.$A_0.gridRowSaveSuccessAction(this,this.$8_0,response);if(this.isNewRecord(this.$8_0)){this.$5W_0(this.$8_0);this.setHiddenTableCellValue(this.$8_0,"isNewRecord","false")}this.setHiddenTableCellValue(this.$8_0,"onlyHiddenValueChanged","true");this.resetCurrentSaveRow();return true},$5W_0:function($p0){var $v_0=$P_CRM($p0);$v_0.mouseover(this.$$d_$7Z_0);$v_0.mouseout(this.$$d_$7Y_0);$v_0.click(this.$$d_$7X_0)},$7Z_0:function($p0){var $v_0=$p0.currentTarget;$v_0.tagName==="TR"&&Mscrm.GridControlLite.ShowDeleteButton($v_0)},$7Y_0:function($p0){var $v_0=$p0.currentTarget;$v_0.tagName==="TR"&&Mscrm.GridControlLite.HideDeleteButton($v_0)},$7X_0:function($p0){var $v_0=$p0.currentTarget;$v_0.tagName==="TR"&&Mscrm.GridControlLite.SelectRow($v_0)},onRowSaveFailure:function(response){var $v_0=this.getHiddenTableCellValue(this.$8_0,"rowIndex");if(!IsNull($v_0))this.$12_0[$v_0.toString()]=false;if(this.isNewRecord(this.$8_0));this.$3h_0(false,this.$8_0);this.showRowError(response,this.$8_0);!IsNull(this.$A_0)&&this.$A_0.gridRowSaveFailureAction(this,this.$8_0,response);this.$1u_0&&this.$8W_0(this.$8_0);this.setHiddenTableCellValue(this.$8_0,"onlyHiddenValueChanged","true");this.resetCurrentSaveRow();return true},$8m_0:function(){this.$2L_0=true;this.$5F_0()},$3l_0:function(){this.$2L_0=false;this.$6G_0()},$6G_0:function(){if(!IsNull(this.$x_0))while(this.$x_0.get_length()>0){var $v_0=this.$x_0.dequeue();this.$55_0($v_0)}},$8n_0:function($p0){this.$3l_0();$removeHandler(window,"beforeunload",this.$$d_$8n_0)},refreshGrid:function(){this.$2_0.refreshLiteSubGrid()},checkForAllDirtyRows:function(triggerSave){for(var $v_0=$P_CRM(this.$V_0),$v_1=$v_0.children("tbody").children("tr"),$v_2=false,$v_3=0;$v_3<$v_1.length;$v_3++){var $v_4=$P_CRM("td:first",$v_1[$v_3]),$v_5=$v_4.attr("class");if($v_5==="ms-crm-List-MessageText-Lite")continue;this.$5k_0($v_1[$v_3],triggerSave)}for(var $v_6=0;$v_6<$v_1.length;$v_6++){$v_2=this.$12_0[$v_6.toString()];if($v_2)break}return $v_2},$5k_0:function($p0,$p1){var $v_0=false;if(!IsNull($p0)){var $v_1=this.getHiddenTableCellValue($p0,"rowIndex");if(!IsNull($v_1)){$v_0=this.$12_0[$v_1.toString()];if(!$v_0)for(var $v_2=0;$v_2<this.$1_0.length;$v_2++)if(!isNullOrEmptyString(this.$1_0[$v_2])){var $v_3=true,$$t_9,$$t_A;if($$t_A=this.$7E_0($p0,this.$1_0[$v_2],$$t_9={val:$v_3}),$v_3=$$t_9.val,$$t_A){this.$12_0[$v_1.toString()]=true;var $v_4=this.getHiddenTableCellValue($p0,"onlyHiddenValueChanged");if(isNullOrEmptyString($v_4))this.setHiddenTableCellValue($p0,"onlyHiddenValueChanged",$v_3.toString());else{var $v_5=$v_4.toUpperCase();$v_5!=="FALSE"&&this.setHiddenTableCellValue($p0,"onlyHiddenValueChanged",$v_3.toString())}$v_0=true;break}}if($v_0&&$p1){var $v_6=$P_CRM($p0);$v_6.trigger("SaveInlineRecord")}}}return $v_0},$7E_0:function($p0,$p1,$p2){var $v_0,$v_1=false,$v_2=false;$p2.val=true;$v_0=this.getCellAttributeId($p0,$p1,this.$Q_0[$p1]);if(!this.$Q_0[$p1]){var $v_3=this.$13_0[$v_0];if(!IsNull($v_3))if($v_3.get_controlMode()===Mscrm.InlineEditControlMode.locked||$v_3.get_controlMode()===Mscrm.InlineEditControlMode.deactivated)$v_2=false;else{$v_2=true;$p2.val=false}}else $v_2=true;if($v_2){var $v_4=this.getTableCellValue($p0,$p1),$v_5=this.$d_0[$v_0];if(!IsNull($v_4)&&$v_4!==$v_5)$v_1=true;else $v_1=false;return $v_1}else return false}};Mscrm.MovableRowsGrid=function(){this.$p_0=["{ECBB6AF5-96E5-4544-94E1-0F339007039C}","{93A2BA26-A53A-491A-B8AE-CBADBC255136}","{02B21CE4-7F77-4451-BFB2-DB300236C56C}"]};Mscrm.MovableRowsGrid.prototype={$1b_0:null,$3s_0:function($p0,$p1,$p2){var $v_0=$p0.getHiddenTableCellValue($p2,"sequencenumber"),$v_1=$p0.getHiddenTableCellValue($p2,"oid"),$v_2=$find("crmFormSelector"),$v_3="";if($v_2)$v_3=$v_2.get_currentFormId();Mscrm.InlineEditDataService.updateSequenceNo($v_1,$v_3,$p1,$v_0,$p0.$$d_onRowSaveSuccess,$p0.$$d_onRowSaveFailure)},updateControlStyle:function(attributeMetadata,inlineEditGridControl){return},gridRowSaveSuccessAction:function(grid,currentSaveRow,response){this.$2e_0(grid,currentSaveRow,response,"sequencenumber");this.$5I_0(grid,currentSaveRow,false);return},$2e_0:function($p0,$p1,$p2,$p3){if($p3 in $p2){var $v_0=$p2[$p3],$v_1=$v_0["raw"];if(!IsNull($v_1)){var $v_2=this.$1b_0.getAttributeType($p3);switch($v_2){case "int":$p0.setTableCellValue($p1,$p3,parseInt($v_1),true);$p0.setHiddenTableCellValue($p1,$p3,parseInt($v_1));break;default:$p0.setTableCellValue($p1,$p3,$v_1,true);$p0.setHiddenTableCellValue($p1,$p3,$v_1);break}}}},gridRowSaveFailureAction:function(grid,currentSaveRow,response){return},gridRowSave:function(grid,currentRow){switch(grid.$C_0){case Mscrm.EntityTypeCode.ConvertRuleItem:this.$3s_0(grid,Mscrm.EntityLogicalNames.ConvertRuleItem,currentRow);break;case Mscrm.EntityTypeCode.RoutingRuleItem:this.$3s_0(grid,Mscrm.EntityLogicalNames.RoutingRuleItem,currentRow);break;case Mscrm.EntityTypeCode.SLAItem:this.$3s_0(grid,Mscrm.EntityLogicalNames.SlaItem,currentRow);break;default:break}},gridPreInitialize:function(grid){if(grid.$K_0)grid.$K_0=this.$4m_0(grid.$2_0.GetParameter("viewid"));grid.$j_0=true;this.$1b_0=grid},$4m_0:function($p0){for(var $v_0=0;$v_0<this.$p_0.length;$v_0++)if($p0.toLowerCase()===this.$p_0[$v_0].toLowerCase())return true;return false},getGridCellInlineControlMode:function(grid,currentRow,attributeName){return Mscrm.InlineEditControlMode.locked},gridAttributeInitialValue:function(currentRow,grid,currentInitialValue,attributeMetadata){return currentInitialValue},gridRowInitialize:function(grid,currentRow){switch(grid.$C_0){case Mscrm.EntityTypeCode.ConvertRuleItem:case Mscrm.EntityTypeCode.RoutingRuleItem:case Mscrm.EntityTypeCode.SLAItem:!grid.isNewRecord(currentRow)&&this.$5I_0(grid,currentRow,true);break;default:break}},$5I_0:function($p0,$p1,$p2){var $v_0=false;if($p2){var $v_1=this.$1b_0.getIconCellColumnIndex(),$v_2=$P_CRM("td",$p1);if($v_2.length>$v_1){var $v_3=$P_CRM("img",$v_2[$v_1]);if($v_3.length>0){var $v_4=$v_3[0].getAttribute("src");if(!IsNull($v_4))$v_0=!!$v_4.length}}$p0.setHiddenTableCellValue($p1,"hasError",$v_0?"1":"0")}else $v_0=$p0.getHiddenTableCellValue($p1,"hasError")==="1";this.$8e_0($p0,$v_0,$p1)},$8e_0:function($p0,$p1,$p2){var $v_0=$p1?"/_imgs/error/notif_icn_warn16.png":"";$p0.addOrRemoveImage($p2,$v_0)}};Mscrm.SubGridContextualActions=function(entityTypeName,associationName){this.$1z_0=entityTypeName;this.$2i_0=associationName};Mscrm.SubGridContextualActions.prototype={$1z_0:null,$2i_0:null,isActionVisibleAndEnabled:function(commandBarData){if(commandBarData.isControlVisible(this.get_commandBarCommandId(),this.get_commandBarControlId())&&commandBarData.isControlEnabled(this.get_commandBarCommandId()))return commandBarData.isControlInCommandLayout(this.get_commandBarCommandId());return false},get_commandBarCommandId:function(){return String.format("{0}|{1}|SubGridStandard|{2}",this.$1z_0,this.$2i_0,this.get_commandBarCommandIdSuffix())},get_commandBarControlId:function(){return String.format("{0}|{1}|SubGridStandard|Mscrm.SubGrid.{2}.{3}",this.$1z_0,this.$2i_0,this.$1z_0,this.get_commandBarControlIdSuffix())}};Mscrm.AddExistingStandardAction=function(entityTypeName,associationName){Mscrm.AddExistingStandardAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.AddExistingStandardAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.AddExistingRecordFromSubGridStandard"},get_commandBarControlIdSuffix:function(){return "AddExistingStandard"}};Mscrm.AddNewStandardAction=function(entityTypeName,associationName){Mscrm.AddNewStandardAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.AddNewStandardAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.AddNewRecordFromSubGridStandard"},get_commandBarControlIdSuffix:function(){return "AddNewStandard"}};Mscrm.OpenAssociatedGridViewStandardAction=function(entityTypeName,associationName){Mscrm.OpenAssociatedGridViewStandardAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.OpenAssociatedGridViewStandardAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.OpenAssociatedGridViewOnLiteGridStandard"},get_commandBarControlIdSuffix:function(){return "OpenAssociatedGridViewStandard"}};Mscrm.AddNewProductAction=function(entityTypeName,associationName){Mscrm.AddNewProductAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.AddNewProductAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.AddNewProductRecordFromSubGridStandard"},get_commandBarControlIdSuffix:function(){return "AddNewProduct"}};Mscrm.AddExistingAssocAction=function(entityTypeName,associationName){Mscrm.AddExistingAssocAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.AddExistingAssocAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.AddExistingRecordFromSubGridAssociated"},get_commandBarControlIdSuffix:function(){return "AddExistingAssoc"}};Mscrm.NewRecordAction=function(entityTypeName,associationName){Mscrm.NewRecordAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.NewRecordAction.prototype={get_commandBarCommandIdSuffix:function(){return "Mscrm.NewRecordFromGrid"},get_commandBarControlIdSuffix:function(){return "NewRecord"}};Mscrm.DeleteAction=function(entityTypeName,associationName){Mscrm.DeleteAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.DeleteAction.prototype={isActionVisibleAndEnabled:function(commandBarData){if(commandBarData.isControlVisible(this.get_commandBarCommandId(),this.get_commandBarControlId()))return commandBarData.isControlInCommandLayout(this.get_commandBarCommandId());return false},get_commandBarCommandIdSuffix:function(){return "Mscrm.DeleteSelectedRecord"},get_commandBarControlIdSuffix:function(){return "Delete"}};Mscrm.RemoveAction=function(entityTypeName,associationName){Mscrm.RemoveAction.initializeBase(this,[entityTypeName,associationName])};Mscrm.RemoveAction.prototype={isActionVisibleAndEnabled:function(commandBarData){if(commandBarData.isControlVisible(this.get_commandBarCommandId(),this.get_commandBarControlId()))return commandBarData.isControlInCommandLayout(this.get_commandBarCommandId());return false},get_commandBarCommandIdSuffix:function(){return "Mscrm.RemoveSelectedRecord"},get_commandBarControlIdSuffix:function(){return "Remove"}};Mscrm.GridPresenceView.registerClass("Mscrm.GridPresenceView",null,Mscrm.IGridPresenceView,Sys.IDisposable);Mscrm.GridPresenceViewEventParameters.registerClass("Mscrm.GridPresenceViewEventParameters");Mscrm.BeforeFormLoadEventArgs.registerClass("Mscrm.BeforeFormLoadEventArgs",Sys.EventArgs);Mscrm.AppGridDefaultDataControl.registerClass("Mscrm.AppGridDefaultDataControl",Mscrm.CrmUIControl);Mscrm.AppGridFilterContainer.registerClass("Mscrm.AppGridFilterContainer",Mscrm.CrmUIControl);Mscrm.AppGridFilterSelector.registerClass("Mscrm.AppGridFilterSelector",Mscrm.CrmUIControl);Mscrm.AppGridJumpBar.registerClass("Mscrm.AppGridJumpBar",Mscrm.CrmUIControl);Mscrm.ColumnResizeControl.registerClass("Mscrm.ColumnResizeControl",Mscrm.CrmUIControl);Mscrm.GridControl.registerClass("Mscrm.GridControl",Mscrm.CrmUIControl,Mscrm.IGridControl,Mscrm.IRibbonSelectionControl,Mscrm.IUIControl);Mscrm.EntitlementChannelInlineEditGrid.registerClass("Mscrm.EntitlementChannelInlineEditGrid",null,Mscrm.IEntityInlineEditGrid);Mscrm.ProductGridFlyOut.registerClass("Mscrm.ProductGridFlyOut",Mscrm.CrmUIControl);Mscrm.BeforeRefreshEventArgs.registerClass("Mscrm.BeforeRefreshEventArgs",Sys.EventArgs);Mscrm.ChangePageEventArgs.registerClass("Mscrm.ChangePageEventArgs",Sys.EventArgs);Mscrm.GridControlLite.registerClass("Mscrm.GridControlLite",Mscrm.GridControl);Mscrm.GridSizeCalculator.registerClass("Mscrm.GridSizeCalculator",Mscrm.CrmUIBehavior);Mscrm.GridSpanControl.registerClass("Mscrm.GridSpanControl",Mscrm.CrmUIControl,Mscrm.IRibbonSelectionControlProxy);Mscrm.GridViewSelector.registerClass("Mscrm.GridViewSelector",Mscrm.CrmUIControl,Mscrm.IRibbonSelectionControlProxy);Mscrm.QuickFindControl.registerClass("Mscrm.QuickFindControl",Mscrm.CrmUIControl,Mscrm.IRibbonSelectionControlProxy);Mscrm.SortColumns.registerClass("Mscrm.SortColumns");Mscrm.SortColumnInfo.registerClass("Mscrm.SortColumnInfo");Mscrm.ProductEntityInlineEditGrid.registerClass("Mscrm.ProductEntityInlineEditGrid",null,Mscrm.IEntityInlineEditGrid);Mscrm.SaveQueueInlineEdit.registerClass("Mscrm.SaveQueueInlineEdit");Mscrm.InlineEditGrid.registerClass("Mscrm.InlineEditGrid");Mscrm.MovableRowsGrid.registerClass("Mscrm.MovableRowsGrid",null,Mscrm.IEntityInlineEditGrid);Mscrm.SubGridContextualActions.registerClass("Mscrm.SubGridContextualActions",null,Mscrm.ISubGridContextualActions);Mscrm.AddExistingStandardAction.registerClass("Mscrm.AddExistingStandardAction",Mscrm.SubGridContextualActions);Mscrm.AddNewStandardAction.registerClass("Mscrm.AddNewStandardAction",Mscrm.SubGridContextualActions);Mscrm.OpenAssociatedGridViewStandardAction.registerClass("Mscrm.OpenAssociatedGridViewStandardAction",Mscrm.SubGridContextualActions);Mscrm.AddNewProductAction.registerClass("Mscrm.AddNewProductAction",Mscrm.SubGridContextualActions);Mscrm.AddExistingAssocAction.registerClass("Mscrm.AddExistingAssocAction",Mscrm.SubGridContextualActions);Mscrm.NewRecordAction.registerClass("Mscrm.NewRecordAction",Mscrm.SubGridContextualActions);Mscrm.DeleteAction.registerClass("Mscrm.DeleteAction",Mscrm.SubGridContextualActions);Mscrm.RemoveAction.registerClass("Mscrm.RemoveAction",Mscrm.SubGridContextualActions);Mscrm.GridControl.emptyGridRefreshMessageTemplate='<div class="ms-crm-grid-Title-Data-Lite">{0}</div><div style="height: 16px;"></div>';Mscrm.GridControl.gridTypeNone=0;Mscrm.GridControl.hompageGrid=1;Mscrm.GridControl.associatedGrid=2;Mscrm.GridControl.inlineSubGrid=3;Mscrm.GridControlLite.$3L=true