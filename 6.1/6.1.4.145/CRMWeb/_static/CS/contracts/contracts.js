function ValidateAssign(oGrid){var oInnerGrid=oGrid.get_innerGrid(),oGridItems=oInnerGrid.get_selectedRecords(),iLength=oGridItems.length,iColIndex=oInnerGrid.FindColumnIndex("statecode");if(iColIndex>=0)for(var i=0;i<iLength;i++){var sState=XUI.Html.DomUtils.GetFirstChild(oGridItems[i][3].cells[iColIndex]).innerHTML;if(sState!=LOCID_CASE_STATE_OPEN){alert(LOCID_MESSAGE_CANNOT_ASSIGN);return false}}return true}function recalculate(){Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.RecalculateRecord,null)}function hold(){var commandData={};commandData["NewStateCode"]="On Hold";commandData["NewStatusCode"]=-1;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractHold,commandData)}function releaseHold(){var commandData={};commandData["NewStateCode"]="Invoiced";commandData["NewStatusCode"]=-1;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractReleaseHold,commandData)}function cancel(){var crmDialog=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/cs/contracts/dlg_cancel.aspx"),null,410,200,null);crmDialog.setCallbackInfo("performActionAfterCancelContract",this,null);crmDialog.show()}function performActionAfterCancelContract(oResult){if(oResult){var commandData={};commandData["cancellationDate"]=oResult.date;commandData["statusCode"]=-1;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractCancel,commandData)}}function renew(){var crmDialog=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/cs/contracts/dlg_renew.aspx"),null,450,200,null);crmDialog.setCallbackInfo("performActionAfterRenewContract",this,null);crmDialog.show()}function performActionAfterRenewContract(oResult){if(oResult){var intVal="0";if(oResult.includeCancelledLines)intVal="1";var commandData={};commandData["rcIncludeCancelledLines"]=intVal;commandData["statusCode"]=-1;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractRenew,commandData)}}function invoice(){var commandData={};commandData["NewStateCode"]="Invoiced";commandData["NewStatusCode"]=-1;return Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractInvoice,commandData)}function clone(){var crmDialog=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/cs/contracts/dlg_clone.aspx"),null,560,200,null);crmDialog.setCallbackInfo("performActionAfterCloneContract",this,null);crmDialog.show()}function performActionAfterCloneContract(oResult){if(oResult){var intVal=0;if(oResult.includeCancelledLines)intVal=1;var commandData=intVal;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.ContractClone,commandData)}}function launchEffectivityCalendar(){var crmDialog=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/cs/contracts/dlg_calendar.aspx?id="+CrmEncodeDecode.CrmUrlEncode(Xrm.Page.data.entity.getId())+"&otype="+CrmEncodeDecode.CrmUrlEncode(Contract)+"&readonly="+CrmEncodeDecode.CrmUrlEncode(_bReadOnly)),null,600,408,null),oResult=crmDialog.show()}function locAddActTo(iActivityType){var sParentId=null,sParentType=null,sPartyId=null,sPartyType=null,sPartyName=null,sPartyLocation=null;sParentId=Xrm.Page.data.entity.getId();sParentType=Mscrm.FormControlInputBehavior.GetBehaviorForForm("crmFormSubmitObjectType").get_datavalue();if(iActivityType!=Task){var aoItems=Xrm.Page.data.entity.attributes.get("customerid").getValue();if(aoItems!=null){var oItem=aoItems[0];sPartyId=oItem.id;sPartyType=oItem.type;sPartyName=oItem.name}sPartyLocation=""}addActivityTo(iActivityType,sParentId,sParentType,sParentName,sPartyId,sPartyType,sPartyName,sPartyLocation)}function locAddObjTo(iType,bIsCustomRelationship,sRelName){if(bIsCustomRelationship){locAddRelatedTo(iType);return}if(iType==ContractDetail){var stateCode=Xrm.Page.data.entity.attributes.get("statecode").getValue();if(stateCode==3||stateCode==4||stateCode==5){alert(LOCID_ERROR_INVALID_STATUS);return}var sQS="?contractid="+Xrm.Page.data.entity.getId();sQS+="&_CreateFromType="+Contract;sQS+="&_CreateFromId="+Xrm.Page.data.entity.attributes.get("contractid").getValue();openFrmObj(sQS,buildWinName(),iType)}else openObjEx(iType,Mscrm.FormControlInputBehavior.GetBehaviorForForm("crmFormSubmitObjectType").get_datavalue(),Xrm.Page.data.entity.getId())}function IsContractCanceledOrExpiredOrOnHold(){if(typeof CONTRACTLINE_ENABLED!="undefined")return CONTRACTLINE_ENABLED;else return true}