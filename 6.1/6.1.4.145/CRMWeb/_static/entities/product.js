function locConvert(toKit){if(!Xrm.Page.data.getIsValid())return;ShowConvertDialog(toKit)}function ShowConvertDialog(toKit){var parameters=[toKit];ids=new Array(Xrm.Page.data.entity.getId());var dialogConvertionUrl=Mscrm.CrmUri.create("/_grid/cmds/dlg_convert.aspx?toKit="+CrmEncodeDecode.CrmUrlEncode(toKit)),crmDialog=new Mscrm.CrmDialog(dialogConvertionUrl,ids,520,200,null),callbackMethodName=Mscrm.Utilities.isRefreshForm()?"performRefreshedActionAfterConvert":"performEditActionAfterConvert";crmDialog.setCallbackInfo(callbackMethodName,this,parameters);crmDialog.show()}function performEditActionAfterConvert(oResult,toKit){if(oResult){var formEventId=toKit=="1"?Mscrm.InlineCommands.ProductConvertToKit:Mscrm.InlineCommands.ProductConvertFromKit,crmFormCtrl=$find("crmForm");crmFormCtrl.SubmitCrmForm(formEventId,true,true,false)}}function performRefreshedActionAfterConvert(oResult,toKit){oResult&&Mscrm.ProductPageHandler.convert(toKit)}function locAssocObjProduct(iType,sSubType,sAssociationName,iRoleOrdinal,parentId,parentObjectTypeCode){var parent=GetParentObject(parentId,parentObjectTypeCode),parameters=[iType,sSubType,sAssociationName,iRoleOrdinal,parent],callbackRef=Mscrm.Utilities.createCallbackFunctionObject("associateProductAction",this,parameters,false);switch(iType){case Product:LookupObjectsWithCallback(callbackRef,null,"multi","1024",0,null,"&currentid="+CrmEncodeDecode.CrmUrlEncode(parent.id));break;default:LookupObjectsWithCallback(callbackRef,"multi",iType,0);break}}function associateProductAction(lookupItems,iType,sSubType,sAssociationName,iRoleOrdinal,parent){if(lookupItems&&lookupItems.items.length>0){iRoleOrdinal=IsNull(iRoleOrdinal)?-1:iRoleOrdinal;AssociateObjects(parent.objectTypeCode,parent.id,iType,lookupItems,iRoleOrdinal==-1?false:iRoleOrdinal==2,sSubType,sAssociationName)}}