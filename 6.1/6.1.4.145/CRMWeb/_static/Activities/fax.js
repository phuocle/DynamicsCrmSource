function faxWindowOnLoadHandler(){attachWindowOnUnload(RefreshParentCampaignResponseGrid)}window.onload=faxWindowOnLoadHandler;function updateFaxNumber(){if(null!=event.result){var oItems=event.result.items;if(0<oItems.length){var oItem=oItems[0],oItemValue=oItem.keyValues["fax"];if(null==oItemValue)oItemValue=oItem.keyValues["address1_fax"];if(null!=oItemValue)oItemValue=oItemValue.value;else oItemValue="";var faxNumberControl=Xrm.Page.ui.controls.get("faxnumber");if(null!=faxNumberControl&&oItemValue!="")faxNumberControl.DataValue=oItemValue}}}function send(){if(Xrm.Page.data.entity.attributes.get("from").getValue().length<=0){alert(LOCID_FAX_SENDER_REQUIRED);return}var numberOfRecipients=Xrm.Page.data.entity.attributes.get("to").getValue().length;if(numberOfRecipients<=0){alert(LOCID_FAX_RECIPIENT_REQUIRED);return}if(numberOfRecipients>1){alert(LOCID_FAX_TOO_MANY_RECIPIENTS);return}Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.FaxSend,null)}