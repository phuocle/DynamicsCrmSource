function send(){var from=Xrm.Page.data.entity.attributes.get("from");if(!IsNull(from))if(IsNull(from.getValue())||from.getValue().length<=0){alert(LOCID_EMAIL_SENDER_REQUIRED);return}var recipients=Xrm.Page.data.entity.attributes.get("to").getValue(),numberOfRecipients=IsNull(recipients)?0:recipients.length,cc=Xrm.Page.data.entity.attributes.get("cc");if(!IsNull(cc))if(cc.getValue()!=null)numberOfRecipients+=cc.getValue().length;var bcc=Xrm.Page.data.entity.attributes.get("bcc");if(!IsNull(bcc))if(bcc.getValue()!=null)numberOfRecipients+=bcc.getValue().length;if(numberOfRecipients<=0){alert(LOCID_EMAIL_RECIPIENT_REQUIRED);return}var command=new RemoteCommand("MailboxService","IsMailboxEnabledForOutgoing");command.SetParameter("regardingObjectId",from.getValue()[0].id);command.SetParameter("regardingObjectTypeCode",parseInt(from.getValue()[0].type));var result=command.Execute();if(result.Success&&!result.ReturnValue&&!window.confirm(LOCID_MAILBOX_DISABLED_WARNING))return;var sendParams={};sendParams.sendType="send";Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.EmailSend,sendParams)}function reply(){var sendParams={};sendParams.sendType="reply";Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.EmailSend,sendParams)}function replyall(){var sendParams={};sendParams.sendType="replyall";Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.EmailSend,sendParams)}function forward(){var sendParams={};sendParams.sendType="forward";Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.EmailSend,sendParams)}