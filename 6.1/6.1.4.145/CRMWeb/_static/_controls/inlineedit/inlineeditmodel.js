Type.registerNamespace("Mscrm");Mscrm.IDuplicateDetectionService=function(){};Mscrm.IDuplicateDetectionService.registerInterface("Mscrm.IDuplicateDetectionService");Mscrm.DuplicateDetectionService=function(){this.$e_0="MSCRM_DuplicateDetection_Notification";this.set_performDuplicateCheck(this.get_$16_0());this.$k_0=0;this.$m_0=false};Mscrm.DuplicateDetectionService.prototype={$e_0:null,$k_0:0,$m_0:false,$t_0:false,$V_0:null,get_duplicateDetectionNotificationId:function(){return this.$e_0},set_duplicateDetectionNotificationId:function(value){this.$e_0=value;return value},get_helperLinkFormat:function(){return "<a class='ms-crm-DuplicateDetectionLink' href='#' style='{0}' id='{1}' onclick='{2}' title='{4}' tabIndex='{5}'> <span id='{3}'> {4} </span></a>"},get_tabIndexOfLink:function(){return 1e3},get_saveMode:function(){return this.$k_0},set_saveMode:function(value){this.$k_0=value;return value},get_syncMode:function(){return this.$m_0},set_syncMode:function(value){this.$m_0=value;return value},get_$16_0:function(){return window.IsDuplicateDetectionEnabled&&window.IsDuplicateDetectionEnabledForOnlineCreateUpdate},get_performDuplicateCheck:function(){return this.$t_0&&this.get_$16_0()&&!Mscrm.Utilities.isMobileRefresh()},set_performDuplicateCheck:function(value){this.$t_0=value;return value},callbackToLaunchResolveDuplicateDialog:function(entityXml){return String.format("Mscrm.InlineEditDataService.LaunchResolveDuplicateDialog('{0}');",entityXml)},callbackToIgnoreResolveDuplicate:function(){return "Mscrm.InlineEditDataService.IgnoreResolveDuplicate();"},callbackForUserActionOnDialog:function(){return Mscrm.InlineEditDataService.SaveRecordAsDuplicate},get_crmEncodeDecodeProxy:function(){if(Mscrm.InternalUtilities.JSTypes.isNull(this.$V_0))this.$V_0=new Mscrm.Proxies.CrmEncodeDecodeProxy;return this.$V_0},set_crmEncodeDecodeProxy:function(value){this.$V_0=value;return value},generateHelperLink:function(id,onClickHandler,label,inlineStyle){var $v_0=id+"Text";if(Mscrm.InternalUtilities.JSTypes.isNull(inlineStyle))inlineStyle="";if(Mscrm.InternalUtilities.JSTypes.isNull(label))label="";return String.format(this.get_helperLinkFormat(),inlineStyle,this.get_crmEncodeDecodeProxy().crmHtmlAttributeEncode(id),this.get_crmEncodeDecodeProxy().crmHtmlAttributeEncode(onClickHandler),this.get_crmEncodeDecodeProxy().crmHtmlAttributeEncode($v_0),this.get_crmEncodeDecodeProxy().crmHtmlEncode(label),this.get_tabIndexOfLink())},generateResolveDuplicateDialogLink:function(entity){var $v_0="/Tools/DuplicateDetection/ViewDuplicates/ViewDuplicatesOnline.aspx?source=1&dType=1";if(!entity.get_isNew()&&!IsNull(entity.get_recordId())){var $v_1="&oid="+this.get_crmEncodeDecodeProxy().crmUrlEncode(entity.get_recordId());$v_0+=$v_1}return $v_0},buildXml:function(entity){return entity.serialize(0)},diffAndMergeXml:function(formXml,duplicateEntityXml){var $v_0=XUI.Xml.LoadXml(formXml),$v_1=XUI.Xml.LoadXml(duplicateEntityXml),$v_2=$v_0.documentElement,$v_3=$v_1.documentElement,$$t_C=this;XUI.Xml.DomUtils.ForEachChild($v_3,function($p1_0){var $v_4=$p1_0,$v_5=null;if(!Mscrm.InternalUtilities.JSTypes.isNull($v_4))$v_5=$v_4.cloneNode(true);if(!IsNull($v_5)){var $v_6=XUI.Xml.SelectSingleNode($v_2,$v_5.nodeName,null);if(IsNull($v_6))$v_0.documentElement.appendChild($v_5);else{var $v_7=$v_6.attributes.getNamedItem("name"),$v_8=$v_5.attributes.getNamedItem("name");XUI.Xml.GetText($v_5)===XUI.Xml.GetText($v_6)&&!IsNull($v_7)&&!IsNull($v_8)&&isNullOrEmptyString(XUI.Xml.GetText($v_8))&&XUI.Xml.SetText($v_8,XUI.Xml.GetText($v_7));$v_0.documentElement.replaceChild($v_5,$v_6)}}return false});return XUI.Xml.XMLSerializer.serializeToString($v_0)}};Mscrm.InlineEditDataService=function(){this.$5_0=new Sys.EventHandlerList};Mscrm.InlineEditDataService.get_performDuplicateCheck=function(){return Mscrm.InlineEditDataService.$0.get_performDuplicateCheck()};Mscrm.InlineEditDataService.set_performDuplicateCheck=function(value){Mscrm.InlineEditDataService.$0.set_performDuplicateCheck(value);return value};Mscrm.InlineEditDataService.get_pageNavigation=function(){return Mscrm.InlineEditDataService.$J};Mscrm.InlineEditDataService.set_pageNavigation=function(value){Mscrm.InlineEditDataService.$J=value;return value};Mscrm.InlineEditDataService.get_primaryEntityChange=function(){return Mscrm.InlineEditDataService.$6};Mscrm.InlineEditDataService.set_primaryEntityChange=function(value){Mscrm.InlineEditDataService.$6=value;return value};Mscrm.InlineEditDataService.get_$U=function(){if(IsNull(Mscrm.InlineEditDataService.$a))Mscrm.InlineEditDataService.$a=new Mscrm.ProgressControl;return Mscrm.InlineEditDataService.$a};Mscrm.InlineEditDataService.get_formId=function(){return Mscrm.InlineEditDataService.$D};Mscrm.InlineEditDataService.set_formId=function(value){Mscrm.InlineEditDataService.$D=value;return value};Mscrm.InlineEditDataService.get_isPreviewForm=function(){return Mscrm.InlineEditDataService.$Y};Mscrm.InlineEditDataService.set_isPreviewForm=function(value){Mscrm.InlineEditDataService.$Y=value;return value};Mscrm.InlineEditDataService.get_$d=function(){var $v_0=30;try{$v_0=_autoSaveInterval}catch($$e_1){}return $v_0};Mscrm.InlineEditDataService.get_$18=function(){return window.AUTO_SAVE_ENABLED};Mscrm.InlineEditDataService.get_currentAutoSaveInterval=function(){return Mscrm.InlineEditDataService.$B};Mscrm.InlineEditDataService.get_$1N=function(){return _formVersionNumber};Mscrm.InlineEditDataService.get_$1V=function(){return _metadataCacheVersion};Mscrm.InlineEditDataService.get_blockAutoSave=function(){return Mscrm.InlineEditDataService.$F};Mscrm.InlineEditDataService.set_blockAutoSave=function(value){Mscrm.InlineEditDataService.$F=value;return value};Mscrm.InlineEditDataService.LaunchResolveDuplicateDialog=function(duplicateEntityXml){var $v_0={},$v_1=Mscrm.InlineEditDataService.$0.buildXml(Mscrm.InlineEditDataService.get_formEntity()),$v_2=Mscrm.InlineEditDataService.$0.diffAndMergeXml($v_1,duplicateEntityXml);$v_0["xml"]=$v_2;var $v_3=Mscrm.InlineEditDataService.$0.generateResolveDuplicateDialogLink(Mscrm.InlineEditDataService.get_formEntity()),$v_4=new Xrm.DialogOptions;$v_4.height=600;$v_4.width=700;var $v_5=Mscrm.InlineEditDataService.$0.callbackForUserActionOnDialog();Xrm.Internal.openDialog($v_3,$v_4,$v_0,null,$v_5)};Mscrm.InlineEditDataService.IgnoreResolveDuplicate=function(){Mscrm.InlineEditDataService.get_dataService().ResolveDuplicateAndTriggerSave()};Mscrm.InlineEditDataService.SaveRecordAsDuplicate=function(response){response==="Save"&&Mscrm.InlineEditDataService.get_dataService().ResolveDuplicateAndTriggerSave()};Mscrm.InlineEditDataService.$10=function(){Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization()};Mscrm.InlineEditDataService.$w=function($p0){for(var $v_0="",$v_1=0;$v_1<$p0.get_pendingAssociations().length;$v_1++){var $v_2=$p0.get_pendingAssociations()[$v_1];$v_0+=String.format("<association><relationshipname>{0}</relationshipname><sourceentityid>{1}</sourceentityid><sourceentitylogicalname>{2}</sourceentitylogicalname><relationshiproleordinal>{3}</relationshiproleordinal></association>",CrmEncodeDecode.CrmXmlEncode($v_2.get_relationshipName()),CrmEncodeDecode.CrmXmlEncode($v_2.get_sourceEntityId()),CrmEncodeDecode.CrmXmlEncode($v_2.get_sourceEntityLogicalName()),CrmEncodeDecode.CrmXmlEncode($v_2.get_isReverse().toString()))}return $v_0};Mscrm.InlineEditDataService.execute=function(command,commandXml,sync,doNotShowProgressControl){var $v_0={};$v_0["command"]=command;Mscrm.InlineEditDataService.setAttributeValueBeforeSave();return Mscrm.InlineEditDataService.executeWithReference(command,commandXml,sync,$v_0,Mscrm.InlineEditDataService.$14,doNotShowProgressControl)};Mscrm.InlineEditDataService.executeWithReference=function(command,commandXml,sync,reference,callback,doNotShowProgressControl){var $v_0=null;(IsNull(doNotShowProgressControl)||!doNotShowProgressControl)&&Mscrm.InlineEditDataService.get_$U().show(command);var $v_1=new RemoteCommand("InlineEditWebService","Execute");$v_1.SetParameter("command",command);$v_1.SetParameter("commandXml",commandXml);$v_1.ErrorHandler=Mscrm.InlineEditDataService.$1z;if(IsNull(reference))reference={};if(!("command" in reference))reference["command"]=command;$v_1.Reference=reference;if(!IsNull(sync)&&sync){Mscrm.InlineEditDataService.set_busy(true);try{$v_0=$v_1.Execute();!IsNull(callback)&&callback($v_0,$v_1);Mscrm.InlineEditDataService.$6=true}finally{Mscrm.InlineEditDataService.set_busy(false);!Mscrm.InlineEditDataService.get_busy()&&Mscrm.InlineEditDataService.get_$U().hide()}}else{if(IsNull(reference))reference={};if(!("command" in reference))reference["command"]=command;$v_1.Reference=reference;Mscrm.ErrorStatusControl.hide(10);Mscrm.AggregatePerformanceMarkers.beginMarker(Mscrm.RefreshFormMarker.ServiceRoundtrip);$v_0=$v_1.Execute(callback);Mscrm.InlineEditDataService.set_busy(true)}return $v_0};Mscrm.InlineEditDataService.get_dataService=function(){if(IsNull(Mscrm.InlineEditDataService.$W))Mscrm.InlineEditDataService.$W=new Mscrm.InlineEditDataService;return Mscrm.InlineEditDataService.$W};Mscrm.InlineEditDataService.get_formEntity=function(){var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId);return $v_0};Mscrm.InlineEditDataService.get_busy=function(){return Mscrm.InlineEditDataService.$7>0};Mscrm.InlineEditDataService.set_busy=function(value){if(value)Mscrm.InlineEditDataService.$7=Mscrm.InlineEditDataService.$7+1;else if(Mscrm.InlineEditDataService.$7>0)Mscrm.InlineEditDataService.$7=Mscrm.InlineEditDataService.$7-1;if(Mscrm.InlineEditDataService.$7>0)Mscrm.ErrorStatusControl.$1t();else Mscrm.ErrorStatusControl.hide(6);return value};Mscrm.InlineEditDataService.get_infraCallForBookOrReschedule=function(){return Mscrm.InlineEditDataService.$X};Mscrm.InlineEditDataService.set_infraCallForBookOrReschedule=function(value){Mscrm.InlineEditDataService.$X=value;return value};Mscrm.InlineEditDataService.checkState=function(){Mscrm.InlineEditDataService.$J=false;if(IsNull(Mscrm.InlineEditDataService.get_formEntity())){Mscrm.InlineEditDataService.$H=0;return}if(Mscrm.InlineEditDataService.get_formEntity().get_isNew())return;Mscrm.InlineEditDataService.$H++;if(Mscrm.InlineEditDataService.$H>Mscrm.InlineEditDataService.$B&&!Mscrm.InlineEditDataService.get_busy()){Mscrm.InlineEditDataService.$H=0;Mscrm.InlineEditDataService.get_$18()&&Mscrm.InlineEditDataService.get_dataService().autoSave()}else if(!Mscrm.InlineEditDataService.get_busy())if(Mscrm.InlineEditDataService.get_formEntity().get_isDirty()){Mscrm.ErrorStatusControl.$1v();Mscrm.InlineEditDataService.get_dataService().setDirty(true)}else{Mscrm.ErrorStatusControl.hide(2);Mscrm.InlineEditDataService.get_dataService().setDirty(false)}};Mscrm.InlineEditDataService.save=function(saveMode,succeedCallback,errorCallback,sync,propagateCallbackHandler){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);if(IsNull(sync))sync=false;var $v_0=Mscrm.InlineEditDataService.get_dataService().saveData(saveMode,sync,propagateCallbackHandler,true);$v_0.$2_0!==6&&Mscrm.InlineEditDataService.resetParameters();return $v_0};Mscrm.InlineEditDataService.activate=function(newStateCode,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);if(isNullOrEmptyString(newStateCode))newStateCode="Active";var $v_1="";$v_1=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStateCode>{3}</newStateCode><dataxml>{4}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.$D),CrmEncodeDecode.CrmXmlEncode(newStateCode),$v_1);Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.Reactivate,$v_1)}};Mscrm.InlineEditDataService.deactivate=function(newStateCode,newStatusCode,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){var $v_1="",$$t_6,$$t_7;if(!($$t_7=Mscrm.InlineEditDataService.isValidFormData(errorCallback,Mscrm.InlineCommands.Deactivate,$$t_6={val:$v_1}),$v_1=$$t_6.val,$$t_7))return;Mscrm.InlineEditDataService.deactivateWithReference(newStateCode,newStatusCode,$v_0.get_recordId(),$v_0.get_typeName(),$v_1,false,Mscrm.InlineEditDataService.$D,succeedCallback,errorCallback)}};Mscrm.InlineEditDataService.deactivateWithReference=function(newStateCode,newStatusCode,recordId,entityLogicalName,formData,doNotRetrieve,formId,succeedCallback,errorCallback,doNotShowProgressControl){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);if(IsNull(newStatusCode))newStatusCode=-1;if(IsNull(formData))formData="";if(IsNull(formId))formId="{00000000-0000-0000-0000-000000000000}";formData=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStateCode>{3}</newStateCode><newStatusCode>{4}</newStatusCode><donotretrieve>{5}</donotretrieve><dataxml>{6}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(recordId),CrmEncodeDecode.CrmXmlEncode(entityLogicalName),CrmEncodeDecode.CrmXmlEncode(formId),CrmEncodeDecode.CrmXmlEncode(newStateCode),CrmEncodeDecode.CrmXmlEncode(newStatusCode.toString()),CrmEncodeDecode.CrmXmlEncode(doNotRetrieve.toString()),CrmEncodeDecode.CrmXmlEncode(formData));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.Deactivate,formData,false,doNotShowProgressControl)};Mscrm.InlineEditDataService.createConnection=function(targetId,targetEntityName,roleId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t<targetid>{2}</targetid>\r\n\t\t\t\t\t\t<targetentityname>{3}</targetentityname>\r\n\t\t\t\t\t\t<roleid>{4}</roleid>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(targetId),CrmEncodeDecode.CrmXmlEncode(targetEntityName),CrmEncodeDecode.CrmXmlEncode(roleId));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.CreateConnection,$v_1,true)}};Mscrm.InlineEditDataService.addUserToRecordAccessTeam=function(userId,teamTemplateId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t<userid>{2}</userid>\r\n\t\t\t\t\t\t<teamtemplateid>{3}</teamtemplateid>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(userId),CrmEncodeDecode.CrmXmlEncode(teamTemplateId));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.CreateRecordAccessTeamMember,$v_1)}};Mscrm.InlineEditDataService.removeUserFromRecordAccessTeam=function(userId,teamTemplateId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t<userid>{2}</userid>\r\n\t\t\t\t\t\t<teamtemplateid>{3}</teamtemplateid>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(userId),CrmEncodeDecode.CrmXmlEncode(teamTemplateId));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.RemoveRecordAccessTeamMember,$v_1)}};Mscrm.InlineEditDataService.refreshGridOnStateChange=function(){Mscrm.InlineEditDataService.$6=true;Mscrm.InlineEditDataService.refreshGrid(true)};Mscrm.InlineEditDataService.deleteRecord=function(succeedCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,null);var $v_1=String.format("<Input><id>{0}</id><name>{1}</name></Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.DeleteRecord,$v_1);if(window.UseTabletExperience)Mscrm.InlineEditDataService.$6=true}};Mscrm.InlineEditDataService.updateConnection=function(connectionId,roleId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t<roleid>{2}</roleid>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode(connectionId),CrmEncodeDecode.CrmXmlEncode(Mscrm.EntityLogicalNames.Connection),CrmEncodeDecode.CrmXmlEncode(roleId));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.UpdateConnection,$v_1)}};Mscrm.InlineEditDataService.associateToCompetitor=function(competitorId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t<competitorid>{2}</competitorid>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(competitorId));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.AssociateToCompetitor,$v_1)}};Mscrm.InlineEditDataService.createProduct=function(isCreateNew,entityTypeCode,productId,entityName,productName,pricePerUnit,quantity,discountAmount,recordId,sequenceNumber,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<etc>{1}</etc>\r\n\t\t\t\t\t\t<productid>{2}</productid>\r\n\t\t\t\t\t\t<name>{3}</name>\r\n\t\t\t\t\t\t<productname>{4}</productname>\r\n\t\t\t\t\t\t<priceperunit>{5}</priceperunit>\r\n\t\t\t\t\t\t<quantity>{6}</quantity>\r\n\t\t\t\t\t\t<recordid>{7}</recordid>\r\n\t\t\t\t\t\t<manualdiscountamount>{8}</manualdiscountamount>\r\n\t\t\t\t\t\t<iscreatenew>{9}</iscreatenew>\r\n\t\t\t\t\t\t<sequencenumber>{10}</sequencenumber>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode(entityTypeCode.toString()),CrmEncodeDecode.CrmXmlEncode(productId),CrmEncodeDecode.CrmXmlEncode(entityName),CrmEncodeDecode.CrmXmlEncode(productName),CrmEncodeDecode.CrmXmlEncode(pricePerUnit.toString()),CrmEncodeDecode.CrmXmlEncode(quantity.toString()),CrmEncodeDecode.CrmXmlEncode(recordId),CrmEncodeDecode.CrmXmlEncode(discountAmount.toString()),CrmEncodeDecode.CrmXmlEncode(isCreateNew.toString()),CrmEncodeDecode.CrmXmlEncode(sequenceNumber.toString()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.CreateProduct,$v_1,true,true)}};Mscrm.InlineEditDataService.createEntitlementChannel=function(isCreateNew,entityTypeCode,entityName,channel,totalTerms,recordId,succeedCallback,errorCallback){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t<etc>{1}</etc>\r\n\t\t\t\t\t\t<name>{2}</name>\r\n\t\t\t\t\t\t<channel>{3}</channel>\r\n\t\t\t\t\t\t<totalterms>{4}</totalterms>\r\n\t\t\t\t\t\t<recordid>{5}</recordid>\r\n\t\t\t\t\t\t<iscreatenew>{6}</iscreatenew>\r\n\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode(entityTypeCode.toString()),CrmEncodeDecode.CrmXmlEncode(entityName),CrmEncodeDecode.CrmXmlEncode(channel),CrmEncodeDecode.CrmXmlEncode(totalTerms.toString()),CrmEncodeDecode.CrmXmlEncode(recordId),CrmEncodeDecode.CrmXmlEncode(isCreateNew.toString()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.CreateEntitlementChannel,$v_1,false,true)}};Mscrm.InlineEditDataService.updateSequenceNo=function(recordId,formId,entityLogicalName,sequenceNumber,succeedCallback,errorCallback){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><sequencenumber>{3}</sequencenumber></Input>",CrmEncodeDecode.CrmXmlEncode(recordId.toString()),CrmEncodeDecode.CrmXmlEncode(entityLogicalName),CrmEncodeDecode.CrmXmlEncode(formId.toString()),CrmEncodeDecode.CrmXmlEncode(sequenceNumber.toString()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.UpdateSequenceNo,$v_0,false,true)};Mscrm.InlineEditDataService.inlineFormRefresh=function(entityLogicalName,recordId,formId,succeedCallback,errorCallback){if(!isNullOrEmptyString(entityLogicalName)&&!isNullOrEmptyString(recordId)&&!isNullOrEmptyString(formId)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_0=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode(recordId),CrmEncodeDecode.CrmXmlEncode(entityLogicalName),CrmEncodeDecode.CrmXmlEncode(formId)),$v_1={};$v_1["command"]=Mscrm.InlineCommands.Retrieve;$v_1["isinlinerefresh"]=1;Mscrm.InlineEditDataService.setAttributeValueBeforeSave();Mscrm.InlineEditDataService.executeWithReference(Mscrm.InlineCommands.Retrieve,$v_0,false,$v_1,Mscrm.InlineEditDataService.$14)}};Mscrm.InlineEditDataService.retrieve=function(entityLogicalName,recordId,formId,succeedCallback,errorCallback){if(!isNullOrEmptyString(entityLogicalName)&&!isNullOrEmptyString(recordId)){Mscrm.InlineEditDataService.setCallback(succeedCallback,errorCallback);var $v_0=Mscrm.InlineEditDataService.$13(entityLogicalName,recordId,formId);Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.Retrieve,$v_0)}};Mscrm.InlineEditDataService.isValidFormData=function(errorCallback,command,formData){var $v_0=Mscrm.InlineEditDataService.get_formEntity();formData.val="";var $v_1=Mscrm.InlineEditDataService.get_dataService().$1E_0($v_0,command,false,formData);if($v_1.$2_0===6)return true;else if($v_1.$2_0===1)return true;else{if(!IsNull(errorCallback)){var $v_2={},$v_3=Mscrm.ErrorInformation.createErrorInfo($v_1.$2_0.toString(),$v_1.$h_0,null);$v_2["_error"]=$v_3;errorCallback($v_2)}return false}};Mscrm.InlineEditDataService.$13=function($p0,$p1,$p2){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId></Input>",CrmEncodeDecode.CrmXmlEncode($p1),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($p2));return $v_0};Mscrm.InlineEditDataService.setCallback=function(succeedCallback,errorCallback){if(!IsNull(succeedCallback))Mscrm.InlineEditDataService.get_dataService().$9_0=succeedCallback;if(!IsNull(errorCallback))Mscrm.InlineEditDataService.get_dataService().$C_0=errorCallback};Mscrm.InlineEditDataService.resetParameters=function(){if(!IsNull(Mscrm.InlineEditDataService.get_dataService().$9_0))Mscrm.InlineEditDataService.get_dataService().$9_0=null;if(!IsNull(Mscrm.InlineEditDataService.get_dataService().$C_0))Mscrm.InlineEditDataService.get_dataService().$C_0=null;Mscrm.InlineEditDataService.get_dataService().$3_0=false};Mscrm.InlineEditDataService.$14=function($p0,$p1){Mscrm.InlineEditDataService.get_$U().hide();Mscrm.InlineEditDataService.set_busy(false);var $v_0=$p0.ReturnValue,$v_1=Mscrm.InlineEditDataService.parsedJson($v_0);Mscrm.AggregatePerformanceMarkers.endMarker(Mscrm.RefreshFormMarker.ServiceRoundtrip);Mscrm.AggregatePerformanceMarkers.beginMarker(Mscrm.RefreshFormMarker.ResetFormState);if($p0.Success&&(IsNull($v_1)||IsNull($v_1["_error"]))){var $v_3=true;Mscrm.InlineEditDataService.$H=0;var $v_4=$p1.Reference;if(!IsNull($v_4)){var $v_5=$v_4["command"],$v_6=false;if("isinlinerefresh" in $v_4&&$v_4["isinlinerefresh"]===1){$v_3=false;$v_6=true}var $v_7=Mscrm.InlineEditDataService.isNew();Mscrm.InlineEditDataService.$1g($v_1,$v_3,$v_5,$v_6);"isinlinerefresh" in $v_4&&$v_4["isinlinerefresh"]===1&&raiseEvent(Mscrm.ScriptEvents.ReloadCommandBar,null,null);$v_7&&Mscrm.InlineEditDataService.$1u();var $v_8=Xrm.Page.ui;$v_8.set_entityDataHeader($v_0)}!IsNull(window.IS_OUTLOOK_CLIENT)&&window.IS_OUTLOOK_CLIENT&&Mscrm.InlineEditDataService.$1n()}else{var $v_9=false;if(!IsNull($v_1)&&!IsNull($v_1["_error"])){var $v_B=$v_1["_error"];if($v_B.Code==="0x80040237")$v_9=true}var $v_A=Mscrm.InlineEditDataService.get_dataService();!$v_9&&(IsNull($v_A.$C_0)||!$v_A.$C_0($v_1))&&$v_A.$o_0($v_1)}$p0.Success&&Mscrm.InlineEditDataService.clearCachedFormData();var $v_2=true;if(!IsNull($v_1)&&!IsNull($v_1["_error"])){var $v_C=$v_1["_error"];if($v_C.Code==="0x80040333")$v_2=false}$v_2&&Mscrm.InlineEditDataService.resetParameters();Mscrm.AggregatePerformanceMarkers.endMarker(Mscrm.RefreshFormMarker.ResetFormState)};Mscrm.InlineEditDataService.$1u=function(){var $v_0=true,$v_1=$get("WebResource_RecordWall");while(true)if(!IsNull($v_1)){if($v_0){var $v_2=$v_1.getAttribute("url");if($v_2.indexOf("&id={")===-1){$v_2=$v_2+Mscrm.InlineEditDataService.get_formEntity().get_recordId();$v_1.setAttribute("url",$v_2)}$v_0=false}if(!isNullOrEmptyString($v_1.className)&&$v_1.className==="ms-crm-InlineTab-Read"){$v_1.style.display="block";return}else $v_1=$v_1.parentNode}else return};Mscrm.InlineEditDataService.$1M=function(){typeof crmForm_window_onload_handler!="undefined"&&crmForm_window_onload_handler!=null&&crmForm_window_onload_handler(Xrm.Page.ui)};Mscrm.InlineEditDataService.$1n=function(){var $v_0=Xrm.Page.data.entity.getEntityName(),$v_1=Xrm.Internal.getEntityCode($v_0),$v_2=Xrm.Page.data.entity.getId(),$v_3=Xrm.Page.data.entity.getPrimaryAttributeValue();Xrm.Internal.refreshParentGrid($v_1,$v_3,$v_2)};Mscrm.InlineEditDataService.$1g=function($p0,$p1,$p2,$p3){if(IsNull($p0)||IsNull($p0["_error"])){var $v_0=false;if(!IsNull($p0)){var $v_1=!IsNull($p0["_entitydisabled"])&&$p0["_entitydisabled"]==="1";$v_0=Mscrm.InlineEditDataService.get_formEntity().get_isDisabled()!==$v_1;Mscrm.InlineEditDataService.get_formEntity().set_isDisabled($v_1);!IsNull($p0["_formstate"])&&Mscrm.InlineEditDataService.get_formEntity().set_formState($p0["_formstate"])}if(!IsNull(Mscrm.InlineEditDataService.get_dataService().$9_0))if(Mscrm.InlineEditDataService.get_dataService().$9_0($p0))return;if($p2===Mscrm.InlineCommands.CreateProduct)return;if(!IsNull($p0)){var $v_2=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_2)){var $v_4=Xrm.Page.ui;$v_4.set_formTitle($v_2.Name);window._id=$v_2.Id;window._primaryFieldValue=$v_2.Name}if("_version" in $p0){var $v_5=$p0["_version"],$v_6=Number.parseInvariant($v_5["_formVersionNumber"]),$v_7=$v_5["_metadataCacheVersion"];if($v_6!==Mscrm.InlineEditDataService.get_$1N()||$v_7!==Mscrm.InlineEditDataService.get_$1V()){Mscrm.InlineEditDataService.$J=true;window.location.reload(true);Mscrm.InlineEditDataService.$J=false;return}}var $v_3=Mscrm.InlineEditDataService.get_dataService().$3_0;Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl($v_3);Mscrm.InlineEditDataService.resetFormDataForRootForm($p0,$p1,$p2,$p3,Mscrm.InlineEditDataService.get_formEntity().get_isNew(),$v_0)}!IsNull(Mscrm.InlineEditDataService.get_dataService().$G_0)&&Mscrm.InlineEditDataService.get_dataService().$G_0($p0)}else Mscrm.InlineEditDataService.get_dataService().$o_0($p0)};Mscrm.InlineEditDataService.setAttributeValueBeforeSave=function(){Mscrm.InlineEditDataService.setAttributeValueBeforeSaveForEntity(Mscrm.InlineEditDataService.get_formEntity())};Mscrm.InlineEditDataService.setAttributeValueBeforeSaveForEntity=function(formEntity){for(var $v_0=formEntity.get_attributes().get(),$v_1=$v_0.length,$v_2=0;$v_2<$v_1;$v_2++){var $v_3=$v_0[$v_2];$v_3.set_lastSaveCallValue($v_3.get_value())}};Mscrm.InlineEditDataService.resetFormDataForRootForm=function(jsonData,isValidationRequired,command,forceReset,isNew,entityStateChanged){Mscrm.InlineEditDataService.$1B(Mscrm.InlineEditDataService.get_formEntity(),jsonData,isValidationRequired,forceReset,entityStateChanged);Mscrm.InlineEditDataService.$1D(Mscrm.InlineEditDataService.get_formEntity(),jsonData);Mscrm.InlineEditDataService.$p(Mscrm.InlineEditDataService.get_formEntity(),jsonData);Mscrm.InlineEditDataService.$q(Mscrm.InlineEditDataService.get_formEntity(),jsonData);isNew&&Mscrm.InlineEditDataService.$1M();Mscrm.InlineEditDataService.get_formEntity().clearPendingAssociations();Mscrm.InlineEditDataService.get_dataService().$20_0(Mscrm.InlineEdit.RefreshedEventArgs,"Refreshed",new Mscrm.InlineEdit.RefreshedEventArgs(jsonData,command));var $v_0=window.self.RefreshBingMap;!IsNull($v_0)&&RefreshBingMap(jsonData);Mscrm.Utilities.refreshParentLookup(jsonData["_entity"]);!window.IS_OUTLOOK_CLIENT&&window.setTimeout(Mscrm.InlineEditDataService.refreshGrid,1);!Mscrm.Utilities.isMobileRefresh()&&window.setTimeout(Mscrm.InlineEditDataService.$1p,1)};Mscrm.InlineEditDataService.$1p=function(){window.self.focus();Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl(Mscrm.InlineEditDataService.get_dataService().$3_0)};Mscrm.InlineEditDataService.$1B=function($p0,$p1,$p2,$p3,$p4){if(IsNull($p0))return;var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1);if(IsNull($v_0))return;if(isNullOrEmptyString($v_0.TypeName))return;if($p0.get_typeName()!==$v_0.TypeName)return;Mscrm.InlineEditDataService.$6=true;var $v_1=!IsNull($p1["_entitydisabled"])&&$p1["_entitydisabled"]==="1";$p0.set_isDisabled($v_1);var $v_2={};if(!$v_1&&!IsNull($p1["_disabledcontrols"])){var $v_5=$p1["_disabledcontrols"];$v_2=Mscrm.InlineEditUtilities.getDisabledControls($v_5)}for(var $v_3=$p0.get_attributes().get(),$v_4=$v_3.length,$v_6=0;$v_6<$v_4;$v_6++){var $v_7=$v_3[$v_6];if($v_7.get_isVirtual())continue;var $v_8=$p1[$v_7.get_name()];!IsNull($v_8)&&"properties" in $v_8&&Mscrm.InlineEditDataService.$1f($v_7,$v_8["properties"]);var $v_9=new Xrm.FormDataAttributePrivilege($v_7.get_userPrivilegeMask()),$v_A=$v_7.get_metadataType()==="lookup"&&$v_7.get_name()==="ownerid";if(!$v_1&&$v_7.get_isCompositeAttribute())Mscrm.InlineEditDataService.enableDisableAttributeBindingControls($v_7,false);else if($v_1||!$v_9.canUpdate&&!$v_A||!Mscrm.InlineEditDataService.$1S($p1[$v_7.get_name()]))Mscrm.InlineEditDataService.enableDisableAttributeBindingControls($v_7,true);else Mscrm.InlineEditDataService.$1J($v_7,$v_2,$p4);if($p2&&!Mscrm.InlineEditDataService.$1U($v_7))continue;if(!Mscrm.InlineEditDataService.$1R($p1[$v_7.get_name()])){$v_7.resetValue(null);$v_7.fireOnChange()}else Mscrm.InlineEditDataService.$1o($v_7,$p1,!$p3)&&$v_7.fireOnChange()}};Mscrm.InlineEditDataService.$1f=function($p0,$p1){for(var $v_0=$p0.get_controls().get(),$$arr_3=$v_0,$$len_4=$$arr_3.length,$$idx_5=0;$$idx_5<$$len_4;++$$idx_5){var $v_1=$$arr_3[$$idx_5];$v_1.updateControlProperties($p1)}};Mscrm.InlineEditDataService.$1J=function($p0,$p1,$p2){for(var $v_0=$p0.get_controls().get(),$$arr_4=$v_0,$$len_5=$$arr_4.length,$$idx_6=0;$$idx_6<$$len_5;++$$idx_6){var $v_1=$$arr_4[$$idx_6],$v_2=$v_1.get_controlId() in $p1;($p2||$v_2)&&$v_2!==$v_1.get_disabled()&&$v_1.set_disabled($v_2)}};Mscrm.InlineEditDataService.$1o=function($p0,$p1,$p2){var $v_0=false;switch($p0.get_metadataType()){case "string":$v_0=$p0.resetValueWithDirtyCheck(Mscrm.InlineEditUtilities.getDecodedValue($p1[$p0.get_name()]),$p2);break;case "memo":var $v_1=$p1[$p0.get_name()],$v_2=$v_1;if($p0.get_format()==="emailbody"){var $v_6=!IsNull($v_1)&&"safeValue" in $v_2?$v_2["safeValue"]:null;if(IsNull($v_6))$v_6=Mscrm.InlineEditUtilities.getDecodedValue($v_2);$v_0=$p0.resetValueWithDirtyCheck($v_6,$p2)}else $v_0=$p0.resetValueWithDirtyCheck(Mscrm.InlineEditUtilities.getDecodedValue($v_2,true),$p2);$v_0&&$p0.get_format()==="emailbody"&&Mscrm.InlineEditDataService.$1y($p0,$v_2);break;case "optionset":var $v_3=$p1[$p0.get_name()],$v_4=Mscrm.InlineEditUtilities.getRawValue($v_3);$p0.get_name()==="statuscode"&&$p0.tryAddOption($v_4,Mscrm.InlineEditUtilities.getDecodedValue($v_3));$v_0=$p0.resetValueWithDirtyCheck($v_4,$p2);break;case "lookup":$v_0=$p0.resetValueWithDirtyCheck(Mscrm.InlineEditUtilities.getLookupValue($p1[$p0.get_name()]),$p2);break;case "datetime":var $v_7=Mscrm.InlineEditUtilities.getRawValue($p1[$p0.get_name()],false);if(!isNullOrEmptyString($v_7))$v_0=$p0.resetValueWithDirtyCheck(ParseUtcDate($v_7),$p2);else $v_0=$p0.resetValue(null);break;case "decimal":case "double":case "integer":$v_0=$p0.resetValueWithDirtyCheck(Mscrm.InlineEditUtilities.getRawValue($p1[$p0.get_name()],true),$p2);break;case "money":var $v_5=Mscrm.InlineEditUtilities.getRawValue($p1[$p0.get_name()],false);if(!isNullOrEmptyString($v_5))$v_0=$p0.resetValueWithDirtyCheck(Number.parseInvariant($v_5),$p2);else $v_0=$p0.resetValue(null);break;case "boolean":$v_0=$p0.resetValueWithDirtyCheck(Mscrm.InlineEditUtilities.getRawValue($p1[$p0.get_name()],true),$p2);break;default:$v_0=$p0.resetValueWithDirtyCheck(Mscrm.Utilities.getData($p1,$p0.get_name(),"value"),$p2);break}return $v_0};Mscrm.InlineEditDataService.$1y=function($p0,$p1){if(!IsNull($p0.get_firstAvailableControl())){var $v_0=$p0.get_firstAvailableControl().get_innerControl();if(!IsNull($v_0)){var $v_1=$p0;!IsNull($v_1)&&$v_1.set_updatedDataValue($p1)}}};Mscrm.InlineEditDataService.$1U=function($p0){for(var $v_0=$p0.get_controls().get(),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1].get_validateResult();if(!IsNull($v_2)&&!$v_2.isValid)return false}return true};Mscrm.InlineEditDataService.$1R=function($p0){if(!IsNull($p0)&&$p0["securedread"]==="1")return false;else return true};Mscrm.InlineEditDataService.$1S=function($p0){if(!IsNull($p0)&&$p0["securedupdate"]==="1")return false;else return true};Mscrm.InlineEditDataService.refreshGrid=function(close){if(!Mscrm.InlineEditDataService.$6)return;try{if(window.IS_OUTLOOK_CLIENT){Mscrm.InlineEditDataService.$1m(close);return}var $v_0=window.top.document.getElementById("crmContentPanel"),$v_1=$v_0.attributes.getNamedItem("currentGridId"),$v_2=null;if(!IsNull($v_1)&&$v_1.specified){$v_2=window.top.document.getElementById($v_1.value);if(!IsNull($v_2)){var $v_3=$v_2.contentWindow.location.pathname.toLowerCase().endsWith("/homepage.aspx")?$v_2.contentWindow:$v_2.contentWindow.parent;if(!IsNull(window._primaryFieldValue))$v_3.auto(_etc,_primaryFieldValue,_id);else $v_3.auto(_etc)}}else if(!IsNull(window.top.opener))if(!IsNull(window._primaryFieldValue))window.top.opener.auto(_etc,_primaryFieldValue,_id);else window.top.opener.auto(_etc)}catch($$e_5){}};Mscrm.InlineEditDataService.$1m=function($p0){if(IsNull($p0)||!$p0)return;var $v_0=getOutlookHostedWindow();$v_0.notifyItemChanged(_etc,_id)};Mscrm.InlineEditDataService.$1d=function($p0){openErrorDlg($p0.get_code(),$p0.get_description(),$p0,0,0)};Mscrm.InlineEditDataService.$q=function($p0,$p1){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1);if(!IsNull($p0)&&!IsNull($v_0))$p0.get_recordName()!==$v_0.Name&&$p0.set_recordName($v_0.Name)};Mscrm.InlineEditDataService.$p=function($p0,$p1){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1);if(!IsNull($p0)&&!IsNull($v_0))($p0.get_isNew()||$v_0.Id!==$p0.get_recordId())&&$p0.set_recordId($v_0.Id);return false};Mscrm.InlineEditDataService.$1D=function($p0,$p1){if(!IsNull(window.top)){var $v_0=window.top.Sys.Application.findComponent("crmPageManager");if(!IsNull($v_0)){var $v_1=Mscrm.InlineEditUtilities.getEntityReference($p1);if(!IsNull($p0)&&!IsNull($v_1))if($p0.get_isNew()||$v_1.Id!==$p0.get_recordId()){var $v_2={};$v_2["updateQueryString"]=String.format("id={0}",$v_1.Id);$v_0.raiseEvent(Mscrm.ScriptEvents.UpdatePageInformation,$v_2)}}}};Mscrm.InlineEditDataService.isNew=function(){if(IsNull(Mscrm.InlineEditDataService.get_formEntity()))return false;else return Mscrm.InlineEditDataService.get_formEntity().get_isNew()};Mscrm.InlineEditDataService.enableDisableAttributeBindingControls=function(attribute,disabled){for(var $v_0=attribute.get_controls().get(),$v_1=$v_0.length-1;$v_1>=0;$v_1--){var $v_2=$v_0[$v_1];disabled!==$v_2.get_disabled()&&$v_0[$v_1].set_disabled(disabled)}};Mscrm.InlineEditDataService.parsedJson=function(value){var $v_0=null;try{if(!isNullOrEmptyString(value)&&!$P_CRM.isEmptyObject(value))$v_0=$P_CRM.parseJSON(value)}catch($v_1){var $v_2={};$v_2.DisplayText="Error while parsing Json \n"+$v_1.message;$v_0={};$v_0["_error"]=$v_2;return $v_0}return $v_0};Mscrm.InlineEditDataService.$1z=function($p0,$p1){Mscrm.InlineEditDataService.get_$U().hide();Mscrm.InlineEditDataService.set_busy(false);if(!(IsNull($p1)&&isNullOrEmptyString($p0))){var $v_0=null;if(!IsNull($p1))$v_0=Mscrm.ErrorInformation.createFromDoc($p1.ownerDocument);Mscrm.InlineEditDataService.$1d($v_0)}};Mscrm.InlineEditDataService.$1k=function($p0,$p1){Mscrm.InlineEditDataService.$1A($p0,$p1,false)};Mscrm.InlineEditDataService.$1j=function($p0,$p1){Mscrm.InlineEditDataService.$1A($p0,$p1,true)};Mscrm.InlineEditDataService.$1A=function($p0,$p1,$p2){Mscrm.InlineEditDataService.get_$U().hide();Mscrm.InlineEditDataService.set_busy(false);var $v_0=$p1.Reference,$v_1=$v_0["uniqueid"],$v_2=$v_0["command"],$v_3=Mscrm.QuickFormBehavior.getBehaviorById($v_1);if(IsNull($v_3))return;var $v_4=Mscrm.InlineEditDataService.parsedJson($p0.ReturnValue);if($p0.Success&&IsNull($v_4["_error"])){Mscrm.ErrorStatusControl.hide(10);Mscrm.InlineEditDataService.$1l($v_3,$v_4,$v_2)}else Mscrm.InlineEditDataService.$1i($v_3,$v_4,$v_2,$p2)};Mscrm.InlineEditDataService.$1l=function($p0,$p1,$p2){var $v_0=$p0.get_formDataEntityObject();if(!IsNull($v_0)&&!IsNull($p1)){var $v_1=$v_0.get_deferredAssociation();if($p0.get_controlMode()!=="Create")Mscrm.InlineEditDataService.$19($p0,$p1,true,false,$p2);else{Mscrm.InlineEditDataService.$p($p0.get_formDataEntityObject(),$p1);Mscrm.InlineEditDataService.$q($p0.get_formDataEntityObject(),$p1);$p0.fireSuccessEvent($p1,$p2)}if($p0.get_isPendingAssociationsNeeded())$v_1&&Array.add(Mscrm.InlineEditDataService.get_formEntity().get_pendingAssociations(),new Mscrm.Association($p0.get_relationshipName(),$p0.get_relationshipRoleOrdinal(),$v_0.get_recordId(),$v_0.get_typeName()))}$p0.get_controlMode()==="Create"&&$p0.clear()};Mscrm.InlineEditDataService.$19=function($p0,$p1,$p2,$p3,$p4){Mscrm.InlineEditDataService.$1B($p0.get_formDataEntityObject(),$p1,false,$p3,false);Mscrm.InlineEditDataService.$p($p0.get_formDataEntityObject(),$p1);Mscrm.InlineEditDataService.$q($p0.get_formDataEntityObject(),$p1);$p2&&$p0.fireSuccessEvent($p1,$p4)};Mscrm.InlineEditDataService.$1i=function($p0,$p1,$p2,$p3){var $v_0=false;if($p3){var $v_1=$p1["_error"];if(!IsNull($v_1))if($v_1.Code==="0x80048306")$v_0=true}if(!$v_0){Mscrm.InlineEditDataService.get_dataService().$o_0($p1);$p0.fireFailureEvent($p1,$p2)}};Mscrm.InlineEditDataService.cacheFormData=function(){if(!window.UseTabletExperience||Mscrm.InlineEditDataService.isNew()||IsNull(Mscrm.InlineEditDataService.get_formEntity())||!Mscrm.InlineEditDataService.get_formEntity().get_isDirty())return;try{var $v_0=Mscrm.InlineEditDataService.get_formEntity(),$v_1=Mscrm.InlineEditDataService.get_dataService().BuildXml($v_0);if(!isNullOrEmptyString($v_1)){var $v_2=Mscrm.InlineEditDataService.$w($v_0);Mscrm.InlineEditDataService.$P=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml><performduplicatecheck>{4}</performduplicatecheck><associations>{5}</associations></Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.$D),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_performDuplicateCheck().toString()),$v_2)}}catch($v_3){}};Mscrm.InlineEditDataService.saveCachedFormData=function(){if(isNullOrEmptyString(Mscrm.InlineEditDataService.$P))return;try{var $v_0=new RemoteCommand("InlineEditWebService","Execute");$v_0.SetParameter("command",Mscrm.InlineCommands.Save);$v_0.SetParameter("commandXml",Mscrm.InlineEditDataService.$P);$v_0.Execute();Mscrm.InlineEditDataService.$6=true}catch($v_1){}Mscrm.InlineEditDataService.clearCachedFormData()};Mscrm.InlineEditDataService.clearCachedFormData=function(){Mscrm.InlineEditDataService.$P=null};Mscrm.InlineEditDataService.prototype={$3_0:false,$9_0:null,$C_0:null,$G_0:null,_disposed:false,get_isDisposed:function(){return this._disposed},setDirty:function(value){var $v_0=$get("_inputFormDirtyFlag"),$v_1=$v_0.value==="1";if(value!==$v_1)$v_0.value=value?"1":"0"},resetAutoSaveInterval:function(){Mscrm.InlineEditDataService.$B=Mscrm.InlineEditDataService.get_$d()},add_formRefreshed:function(value){this.$5_0.addHandler("Refreshed",value)},remove_formRefreshed:function(value){if(this._disposed)return;this.$5_0.removeHandler("Refreshed",value)},add_preValidation:function(value){this.$5_0.addHandler("PreValidation",value)},remove_preValidation:function(value){if(this._disposed)return;this.$5_0.removeHandler("PreValidation",value)},add_entitySaved:function(value){this.$5_0.addHandler("entitySaved",value)},remove_entitySaved:function(value){if(this._disposed)return;this.$5_0.removeHandler("entitySaved",value)},ResolveDuplicateAndTriggerSave:function(){Xrm.Page.ui.clearFormNotification(Mscrm.InlineEditDataService.$0.get_duplicateDetectionNotificationId());Mscrm.InlineEditDataService.set_performDuplicateCheck(false);Mscrm.InlineEditDataService.get_dataService().saveData(Mscrm.InlineEditDataService.$0.get_saveMode(),Mscrm.InlineEditDataService.$0.get_syncMode());Mscrm.InlineEditDataService.$F=false},BuildXml:function(entity){var $v_0=null;if(!IsNull(entity)&&isInstanceOfTypeAcrossFrames(entity,Mscrm.FormDataEntity))if(entity.get_isNew())$v_0=entity.serialize(0);else $v_0=entity.serialize(1);if(!entity.get_id().startsWith(Mscrm.InlineEditConstants.FormDataEntityIdPrefix)&&entity.get_isNew()){var $v_1=CrmEncodeDecode.CrmXmlEncode(entity.get_typeName());$v_0=$v_0.substring($v_1.length+2,$v_0.length-$v_1.length-3);return String.format("<{0}>{1}</{0}>",$v_1,Mscrm.FormControl.addMappedAttributeInformation($v_0,Mscrm.Utilities.get_mappedXml()))}return $v_0},autoSave:function(){var $v_0=Xrm.Page.data.entity.getEntityName();if(IsNull(Mscrm.InlineEditDataService.get_formEntity())||Mscrm.InlineEditDataService.get_formEntity().get_isNew()||Mscrm.InlineEditDataService.$F||$v_0===Mscrm.InternalUtilities.EntityNames.Appointment||$v_0===Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster)return;this.$3_0=true;this.saveData(Xrm.SaveMode.autoSave,false)},$1E_0:function($p0,$p1,$p2,$p3){$p3.val=null;var $v_0=this.validate($p0,$p1,$p2);if($v_0.$2_0!==5)return $v_0;return this.$x_0($p0,$p3)},$x_0:function($p0,$p1){$p1.val=null;var $v_0=this.BuildXml($p0);if(isNullOrEmptyString($v_0))return new Mscrm.SaveResponse(4,null);$p1.val=$v_0;return new Mscrm.SaveResponse(6,"")},$s_0:function($p0,$p1,$p2){if(IsNull($p0))return new Mscrm.SaveResponse(0,null);Mscrm.InlineEditDataService.$10();var $v_0=new Mscrm.InlineEdit.PreValidationEventArgs($p0.get_id(),$p1);$v_0.set_autoSave($p2);this.$20_0(Mscrm.InlineEdit.PreValidationEventArgs,"PreValidation",$v_0);if(!IsNull($v_0)&&!IsNull($v_0.get_validationResult())&&!$v_0.get_validationResult().isValid)if(isNullOrEmptyString($v_0.get_validationResult().errorText)){Mscrm.ErrorStatusControl.showError(window.LOCID_FORMCONTAININVALIDDATA,false,$v_0.get_validationResult());return new Mscrm.SaveResponse(2,window.LOCID_FORMCONTAININVALIDDATA)}else{Mscrm.ErrorStatusControl.showError($v_0.get_validationResult().errorText,true,$v_0.get_validationResult());return new Mscrm.SaveResponse(2,$v_0.get_validationResult().errorText)}var $v_1=$p0.validateFieldsValue($p0.get_isNew());if(!isNullOrEmptyString($v_1)){Mscrm.ErrorStatusControl.showError($v_1,true);return new Mscrm.SaveResponse(3,$v_1)}return new Mscrm.SaveResponse(5,"")},validate:function(primaryEntity,command,isAutoSave){var $v_0=this.$s_0(primaryEntity,command,isAutoSave);if($v_0.$2_0!==5)return $v_0;if(!primaryEntity.get_isNew()&&!primaryEntity.get_isDirty())return new Mscrm.SaveResponse(1,null);return new Mscrm.SaveResponse(5,"")},saveData:function(saveMode,sync,propagateCallbackHandler,noAutoSaveCheck){if(saveMode!==Xrm.SaveMode.autoSave)this.$3_0=false;Mscrm.InlineEditDataService.$0.set_saveMode(saveMode);Mscrm.InlineEditDataService.$0.set_syncMode(sync);saveMode=-1===Xrm.Page.context.saveMode?saveMode:Xrm.Page.context.saveMode;Xrm.Page.context.saveMode=-1;var $v_0=Mscrm.InlineEditDataService.get_formEntity(),$v_1=null;Mscrm.InlineEditDataService.$10();var $v_2=Xrm.Page.data.entity.getEntityName(),$v_3=this.validateAndFireSaveEvents(saveMode,$v_0);if(!noAutoSaveCheck)if(!Mscrm.InlineEditDataService.get_$18())if(this.$1I_0(saveMode))return new Mscrm.SaveResponse(9,null);if($v_3.$2_0!==5)return $v_3;var $$t_E,$$t_F;$v_3=($$t_F=this.$x_0($v_0,$$t_E={val:$v_1}),$v_1=$$t_E.val,$$t_F);if($v_3.$2_0===6&&!Mscrm.InlineEditDataService.$Y){if(this.$1P_0(saveMode,$v_2,propagateCallbackHandler))return new Mscrm.SaveResponse(10,"");var $v_4=Mscrm.InlineEditDataService.$w($v_0),$v_5="{00000000-0000-0000-0000-000000000000}";if(!Mscrm.InlineEditDataService.isNew())$v_5=$v_0.get_recordId();this.$1r_0();$v_1=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml><performduplicatecheck>{4}</performduplicatecheck><associations>{5}</associations></Input>",CrmEncodeDecode.CrmXmlEncode($v_5),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.$D),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_performDuplicateCheck().toString()),$v_4);var $v_6=Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.Save,$v_1,sync);if(!IsNull(sync)&&sync)if($v_6.Success){var $v_7=$v_6.ReturnValue,$v_8=Mscrm.InlineEditDataService.parsedJson($v_7);if(!IsNull($v_8)&&!("_error" in $v_8)){var $v_9=Mscrm.InlineEditUtilities.getEntityReference($v_8);if(!IsNull($v_9)){$v_3.$j_0=$v_9.Name;$v_3.$i_0=$v_9.Id;Mscrm.InlineEditDataService.clearCachedFormData()}Mscrm.InlineEditDataService.$1D(Mscrm.InlineEditDataService.get_formEntity(),$v_8);return $v_3}else if(!IsNull($v_8)&&"_error" in $v_8)return new Mscrm.SaveResponse(7,$v_8["_error"].DisplayText)}else return new Mscrm.SaveResponse(7,"");this.$20_0(Sys.EventArgs,"entitySaved",Sys.EventArgs.Empty)}return $v_3},$1r_0:function(){var $v_0=this.$1h_0("appSolutionId");if($v_0){var $v_1=$get("crmFormSubmit");if($v_1)if(!$get("appSolutionId")){var $v_2=document.createElement("input");$v_2.id="appSolutionId";$v_2.setAttribute("value",$v_0);$v_2.setAttribute("type","hidden");$v_1.appendChild($v_2)}}},$1h_0:function($p0){var $v_0=Mscrm.CrmUri.create(window.top.location.href),$v_1=$v_0.get_query()[$p0];if(IsNull($v_1)||isNullOrEmptyString($v_1.toString()))return null;return $v_1.toString()},$1I_0:function($p0){return $p0===Xrm.SaveMode.saveAndClose},$1P_0:function($p0,$p1,$p2){if(!Mscrm.Utilities.isMobileRefresh()&&($p1===Mscrm.InternalUtilities.EntityNames.Appointment||$p1===Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster)){var $v_0=window.DoNotScheduleAppointment;$v_0=!IsNull($v_0)&&$v_0;window.DoNotScheduleAppointment=false;this.$1H_0();if(Xrm.Page.context.isOutlookOnline()&&!$v_0&&window.IS_ALLOW_SCHEDULE){var $v_1=null;if($p2)$v_1=Mscrm.InlineEditDataService.get_dataService().$9_0;if($p0===Xrm.SaveMode.saveAndClose){var $v_2=jQueryApi.jQueryDeferredFactory.Deferred(Mscrm.SaveSuccessResponse,Mscrm.SaveErrorResponse),$$t_7=this;Mscrm.InlineEditDataService.get_dataService().$G_0=function($p1_0){$v_2.resolve(null);return false};var $$t_8=this;$v_2.then(function(){closeWindowScript()},null)}else Mscrm.InlineEditDataService.get_dataService().$G_0=null;if(Mscrm.InlineEditDataService.$X)Mscrm.CommandBarActions.bookOrRescheduleWithCallback(true,true,$v_1);else Mscrm.CommandBarActions.bookOrRescheduleWithCallback(false,true,$v_1);return true}}return false},$1H_0:function(){var $v_0=$find("crmNotifications");if(!IsNull($v_0)){var $v_1=$v_0.GetNotifications();while($v_1.length){var $v_2=$v_1[0].Id;Xrm.Page.ui.clearFormNotification($v_2);$v_1=$v_0.GetNotifications()}}},validateAndFireSaveEvents:function(saveMode,primaryEntity){var $v_0=this.$s_0(primaryEntity,Mscrm.InlineCommands.Save,this.$3_0);if($v_0.$2_0!==5)return $v_0;if(!this.$3_0){$v_0=this.$12_0(saveMode,primaryEntity);if($v_0.$2_0!==5)return $v_0}if(!Mscrm.InlineEditDataService.get_formEntity().get_isNew()&&!primaryEntity.get_isDirty()){Mscrm.ErrorStatusControl.hide(10);return new Mscrm.SaveResponse(1,null)}if(this.$3_0){$v_0=this.$12_0(saveMode,primaryEntity);if($v_0.$2_0!==5)return $v_0}return new Mscrm.SaveResponse(5,"")},$12_0:function($p0,$p1){var $v_0=new Mscrm.EntitySaveEventArgs($p0);if($p1.fireOnSave($v_0))if($v_0.get_isHandlerAttached())return this.$s_0($p1,Mscrm.InlineCommands.Save,this.$3_0);else return new Mscrm.SaveResponse(5,"");else{var $v_1=new Mscrm.SaveResponse(9,"");$v_1.$Z_0=$v_0.isNavigationPrevented();return $v_1}},get_succeedCallback:function(){return this.$9_0},set_succeedCallback:function(value){this.$9_0=value;return value},get_errorCallback:function(){return this.$C_0},set_errorCallback:function(value){this.$C_0=value;return value},get_closeCallback:function(){return this.$G_0},set_closeCallback:function(value){this.$G_0=value;return value},get_isAutoSave:function(){return this.$3_0},set_isAutoSave:function(value){this.$3_0=value;return value},$o_0:function($p0){if(Mscrm.InlineEditDataService.get_dataService().$3_0)if(Mscrm.InlineEditDataService.$B<Mscrm.InlineEditDataService.get_$d()*20)Mscrm.InlineEditDataService.$B=Mscrm.InlineEditDataService.$B+Mscrm.InlineEditDataService.get_$d();if(IsNull($p0)){Mscrm.ErrorStatusControl.showError(window.LOCID_GENERIC_MESSAGE);return}if(!IsNull($p0["_error"])){var $v_0=$p0["_error"];if(this.$3_0)if($v_0.Code==="0x80040333"){var $v_1=null,$v_2=null,$v_3=window.LOCID_NOTIF_RESOLVE_DUPLICATE,$v_4=window.LOCID_NOTIF_SAVEANYWAY;if(window.LOCID_UI_DIR==="RTL"){$v_1="margin-right:30px;";$v_2="margin-right:10px;"}else{$v_1="margin-left:30px;";$v_2="margin-left:10px;"}Mscrm.InlineEditDataService.$F=true;var $v_5=Mscrm.InlineEditDataService.$0.generateHelperLink("launchCrmDuplicateDetectionDialogButton",Mscrm.InlineEditDataService.$0.callbackToLaunchResolveDuplicateDialog($v_0.SerializedEntity),$v_3,$v_1),$v_6=Mscrm.InlineEditDataService.$0.generateHelperLink("ignoreCrmDuplicateDetectionDialogButton",Mscrm.InlineEditDataService.$0.callbackToIgnoreResolveDuplicate(),$v_4,$v_2),$v_7=$v_0.DisplayText+$v_5+$v_6;Xrm.Page.ui.setFormHtmlNotification($v_7,Xrm.NotificationLevels.error,Mscrm.InlineEditDataService.$0.get_duplicateDetectionNotificationId())}else Mscrm.ErrorStatusControl.displayErrorInformation($v_0);else if($v_0.Code==="0x80040333")Mscrm.InlineEditDataService.LaunchResolveDuplicateDialog($v_0.SerializedEntity);else{var $v_8=$v_0.Code;if(isNullOrEmptyString($v_0.Code)||!$v_0.ErrorCode)$v_8="0x80040216";Mscrm.ErrorStatusControl.showCrmMessage(Mscrm.ErrorInformation.createErrorInfo($v_8,$v_0.Description,$v_0.SerializedException))}}else openErrorDlg("0x80040216","",null,0,0)},$20_0:function($p0,$p1,$p2){var $v_0=this.$5_0.getHandler($p1);!IsNull($v_0)&&$v_0(this,$p2)},dispose:function(){if(this._disposed)return;this._disposed=true;Mscrm.Utilities.destroyObject(this.$5_0);Mscrm.Utilities.destroyObject(this)},quickFormSaveData:function(uniqueId,saveAsCompleted){var $v_0=Mscrm.QuickFormBehavior.getBehaviorById(uniqueId);if(IsNull($v_0))return new Mscrm.SaveResponse(0,null);var $v_1=$v_0.get_formDataEntityObject();if(IsNull($v_1))return new Mscrm.SaveResponse(0,null);var $v_2=saveAsCompleted?Mscrm.InlineCommands.SaveAsCompleted:Mscrm.InlineCommands.Save,$v_3,$$t_B,$$t_C,$v_4=($$t_C=this.$1E_0($v_1,$v_2,false,$$t_B={val:$v_3}),$v_3=$$t_B.val,$$t_C);if($v_4.$2_0===6){var $v_5=$v_1.get_isNew()?"{00000000-0000-0000-0000-000000000000}":$v_1.get_recordId(),$v_6="";$v_1.set_deferredAssociation(false);if(!isNullOrEmptyString($v_0.get_relationshipName())){var $v_8=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_8)&&!$v_8.get_isNew())$v_6=String.format("<association><relationshipname>{0}</relationshipname><sourceentityid>{1}</sourceentityid><sourceentitylogicalname>{2}</sourceentitylogicalname><relationshiproleordinal>{3}</relationshiproleordinal></association>",CrmEncodeDecode.CrmXmlEncode($v_0.get_relationshipName()),CrmEncodeDecode.CrmXmlEncode($v_8.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_8.get_typeName()),CrmEncodeDecode.CrmXmlEncode($v_0.get_relationshipRoleOrdinal().toString()));else $v_1.set_deferredAssociation(true)}$v_3=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml><performduplicatecheck>{4}</performduplicatecheck><associations>{5}</associations></Input>",CrmEncodeDecode.CrmXmlEncode($v_5),CrmEncodeDecode.CrmXmlEncode($v_1.get_typeName()),CrmEncodeDecode.CrmXmlEncode($v_0.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_3),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_performDuplicateCheck().toString()),$v_6);var $v_7={};$v_7["command"]=$v_2;$v_7["uniqueid"]=uniqueId;Mscrm.InlineEditDataService.setAttributeValueBeforeSaveForEntity($v_1);Mscrm.InlineEditDataService.executeWithReference($v_2,$v_3,false,$v_7,Mscrm.InlineEditDataService.$1k)}return $v_4},quickFormClearData:function(uniqueId){var $v_0=Mscrm.QuickFormBehavior.getBehaviorById(uniqueId);if(IsNull($v_0))return;var $v_1=$P_CRM($v_0.get_element()),$v_2=Mscrm.InlineEditUtilities.getLinkedDataObject($v_1);Mscrm.InlineEditDataService.$19($v_0,$v_2,false,true,Mscrm.InlineCommands.None);var $v_3=Mscrm.InlineEditUtilities.getEntityReference($v_2);$v_0.get_formDataEntityObject().set_recordId($v_3.Id);$v_0.get_formDataEntityObject().set_recordName($v_3.Name)},quickFormRefreshData:function(uniqueId,recordId){var $v_0=Mscrm.QuickFormBehavior.getBehaviorById(uniqueId);if(IsNull($v_0))return;var $v_1=$v_0.get_relatedEntityLogicalName(),$v_2=$v_0.get_formId();if(!isNullOrEmptyString($v_1)&&!isNullOrEmptyString(recordId)){Mscrm.InlineEditDataService.setAttributeValueBeforeSaveForEntity($v_0.get_formDataEntityObject());var $v_3=Mscrm.InlineEditDataService.$13($v_1,recordId,$v_2),$v_4={};$v_4["command"]=Mscrm.InlineCommands.Retrieve;$v_4["uniqueid"]=uniqueId;Mscrm.InlineEditDataService.executeWithReference(Mscrm.InlineCommands.Retrieve,$v_3,false,$v_4,Mscrm.InlineEditDataService.$1j)}}};Mscrm.ErrorStatusControl=function(){this.$$d_$1F_0=Function.createDelegate(this,this.$1F_0);this.$$d_$1W_0=Function.createDelegate(this,this.$1W_0);this.$$d_$1X_0=Function.createDelegate(this,this.$1X_0);this.$$d_$1c_0=Function.createDelegate(this,this.$1c_0);this.$$d_$17_0=Function.createDelegate(this,this.$17_0);this.$$d_$1b_0=Function.createDelegate(this,this.$1b_0)};Mscrm.ErrorStatusControl.get_$1=function(){if(!Mscrm.ErrorStatusControl.$R){var $v_0=$P_CRM("#refreshFormFooterContainer div.ms-crm-Read-Message");if($v_0.length>0)Mscrm.ErrorStatusControl.$R=$v_0.attr("id");else Mscrm.ErrorStatusControl.$R="footer_statuscontrol"}return Mscrm.ErrorStatusControl.$R};Mscrm.ErrorStatusControl.get_statusBar=function(){if(!Mscrm.ErrorStatusControl.$M){Mscrm.ErrorStatusControl.$M=new Mscrm.ErrorStatusControl;Mscrm.ErrorStatusControl.$M.initialize()}return Mscrm.ErrorStatusControl.$M};Mscrm.ErrorStatusControl.set_statusBar=function(value){Mscrm.ErrorStatusControl.$M=value;return value};Mscrm.ErrorStatusControl.$1q=function($p0){raiseEvent(Mscrm.ScriptEvents.ReloadCommandBar,null,null);return false};Mscrm.ErrorStatusControl.hide=function(rank){if(!$get(Mscrm.ErrorStatusControl.get_$1()))return;Mscrm.ErrorStatusControl.get_statusBar().$Q_0===rank&&Mscrm.ErrorStatusControl.$E(0,"",null)};Mscrm.ErrorStatusControl.$1t=function(){Mscrm.ErrorStatusControl.get_statusBar().$b_0(6)&&Mscrm.ErrorStatusControl.$E(6,window.LOCID_SAVING,null)};Mscrm.ErrorStatusControl.onEntityIsDisabledChangedHandler=function(){Mscrm.ErrorStatusControl.$u()};Mscrm.ErrorStatusControl.$u=function(){if(Mscrm.InlineEditDataService.get_formEntity().get_isDisabled()&&!Mscrm.InlineEditDataService.get_formEntity().get_overrideDisabledMode()){$P_CRM("body").addClass("entity-disabled");Mscrm.ErrorStatusControl.$E(20,window.LOCID_READONLY,null)}else{$P_CRM("body").removeClass("entity-disabled");Mscrm.ErrorStatusControl.$1G()}};Mscrm.ErrorStatusControl.$1G=function(){Mscrm.ErrorStatusControl.$E(0,"",null)};Mscrm.ErrorStatusControl.showError=function(message,overwrite,result){if(!IsNull(overwrite)&&overwrite)Mscrm.ErrorStatusControl.get_statusBar().$8_0=true;Mscrm.ErrorStatusControl.get_statusBar().$b_0(10)&&Mscrm.ErrorStatusControl.$E(10,message,result)};Mscrm.ErrorStatusControl.displayErrorInformation=function(error){if(!IsNull(error)){var $v_0=Mscrm.ErrorStatusControl.$1O(error);if(!isNullOrEmptyString(error.Title))Mscrm.ErrorStatusControl.showError(error.Title,true,null);else Mscrm.ErrorStatusControl.showError($v_0,true,null);Mscrm.ErrorStatusControl.get_statusBar().$O_0=Mscrm.ErrorInformation.createErrorInfo(error.Code,$v_0,error.SerializedException)}else Mscrm.ErrorStatusControl.get_statusBar().$O_0=null};Mscrm.ErrorStatusControl.$1O=function($p0){var $v_0=null;if($p0.Code==="0x80040265")$v_0=$p0.Description;if(isNullOrEmptyString($v_0))$v_0=$p0.DisplayText;return $v_0};Mscrm.ErrorStatusControl.$1v=function(){Mscrm.ErrorStatusControl.get_statusBar().$b_0(2)&&Mscrm.ErrorStatusControl.$E(2,window.LOCID_UNSAVEDCHANGES,null)};Mscrm.ErrorStatusControl.showCriticalWarning=function(warningMessage){Mscrm.ErrorStatusControl.get_statusBar().$b_0(4)&&Mscrm.ErrorStatusControl.$E(4,warningMessage,null)};Mscrm.ErrorStatusControl.$E=function($p0,$p1,$p2){switch($p0){case 0:case 1:case 2:Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("src","/_imgs/inlineedit/save.png");Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("alt",CrmEncodeDecode.CrmHtmlEncode($p1));Mscrm.ErrorStatusControl.get_statusBar().$8_0=true;break;case 4:Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("src","/_imgs/inlineedit/save.png");Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("alt",CrmEncodeDecode.CrmHtmlEncode($p1));Mscrm.ErrorStatusControl.get_statusBar().$8_0=false;break;case 6:Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("src","/_imgs/inlineedit/saveAnimation.gif");Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("alt",CrmEncodeDecode.CrmHtmlEncode($p1));Mscrm.ErrorStatusControl.get_statusBar().$8_0=true;break;case 10:Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("src","/_imgs/inlineedit/save.png");Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("alt",String.format(window.LOCID_ERRORSTATUS_ALTTEXT,CrmEncodeDecode.CrmHtmlEncode($p1)));Mscrm.ErrorStatusControl.get_statusBar().$8_0=false;Mscrm.ErrorStatusControl.get_statusBar().get_$11_0().show();break;case 20:Mscrm.ErrorStatusControl.get_statusBar().get_imageElement().attr("src","/_imgs/inlineedit/locked.png");Mscrm.ErrorStatusControl.get_statusBar().$8_0=false;break}$p0!==10&&Mscrm.ErrorStatusControl.get_statusBar().get_$11_0().hide();Mscrm.ErrorStatusControl.get_statusBar().$Q_0=$p0;if(IsNull($p2))Mscrm.ErrorStatusControl.get_statusBar().$T_0=null;else{Mscrm.ErrorStatusControl.get_statusBar().$T_0=new Mscrm.ValidationResult($p2.isValid,$p2.errorText,$p2.errorIconPath);Mscrm.ErrorStatusControl.get_statusBar().$T_0.attributeName=$p2.attributeName;Mscrm.ErrorStatusControl.get_statusBar().$T_0.parentFormDataEntityId=$p2.parentFormDataEntityId}Mscrm.ErrorStatusControl.$1K($p1)};Mscrm.ErrorStatusControl.$1K=function($p0){Mscrm.ErrorStatusControl.get_statusBar().$O_0=null;Mscrm.ErrorStatusControl.get_statusBar().get_titleElement().html(CrmEncodeDecode.CrmHtmlEncode($p0));Mscrm.ErrorStatusControl.get_statusBar().get_$1L_0().setMessageInFlyOut($p0)};Mscrm.ErrorStatusControl.showMessage=function(){Mscrm.ErrorStatusControl.get_statusBar().$8_0=true;!IsNull(Mscrm.ErrorStatusControl.get_statusBar().$O_0)&&Mscrm.ErrorStatusControl.showCrmMessage(Mscrm.ErrorStatusControl.get_statusBar().$O_0)};Mscrm.ErrorStatusControl.showCrmMessage=function(error){openErrorDlg(error.get_code(),error.get_description(),error,0,0)};Mscrm.ErrorStatusControl.prototype={$Q_0:0,$8_0:false,$T_0:null,$I_0:null,$n_0:null,$f_0:null,$l_0:null,$g_0:null,$O_0:null,get_imageElement:function(){if(!this.$I_0)this.$I_0=$P_CRM("#img"+Mscrm.ErrorStatusControl.get_$1());return this.$I_0},get_$11_0:function(){if(!this.$f_0)this.$f_0=$P_CRM("img#alert-status-icon");return this.$f_0},get_saveElement:function(){if(!this.$I_0)this.$I_0=$P_CRM("#save"+Mscrm.ErrorStatusControl.get_$1());return this.$I_0},get_titleElement:function(){if(!this.$n_0)this.$n_0=$P_CRM("#title"+Mscrm.ErrorStatusControl.get_$1());return this.$n_0},get_$1w_0:function(){if(!this.$l_0)this.$l_0=$P_CRM("div.status-message");return this.$l_0},get_$1L_0:function(){if(!this.$g_0)this.$g_0=new Mscrm.ErrorStatusControlFlyout("footer-status-message-flyout",this.get_$1w_0());return this.$g_0},get_result:function(){return this.$T_0},get_messageRank:function(){return this.$Q_0},$1b_0:function($p0){Mscrm.ErrorStatusControl.showMessage()},$17_0:function($p0){if(!Mscrm.InlineEditDataService.get_busy()){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();Mscrm.InlineEditDataService.save(Xrm.SaveMode.save,Mscrm.ErrorStatusControl.$1q,null,false)}},$1c_0:function($p0){switch($p0.which){case 13:this.$17_0($p0);break;default:break}},initialize:function(){if(!$get(Mscrm.ErrorStatusControl.get_$1()))return;if(window.LOCID_UI_DIR==="RTL")$P_CRM("#"+Mscrm.ErrorStatusControl.get_$1()+"_d").css("align","left");else $P_CRM("#"+Mscrm.ErrorStatusControl.get_$1()+"_d").css("align","right");$P_CRM("#"+Mscrm.ErrorStatusControl.get_$1()).css("display","block");$P_CRM("#"+Mscrm.ErrorStatusControl.get_$1()).css("nowrap","nowrap");$P_CRM("#a"+Mscrm.ErrorStatusControl.get_$1()).click(this.$$d_$1b_0);$P_CRM("#save"+Mscrm.ErrorStatusControl.get_$1()).click(this.$$d_$17_0);$P_CRM("#save"+Mscrm.ErrorStatusControl.get_$1()).keydown(this.$$d_$1c_0);Mscrm.ErrorStatusControl.get_statusBar().$Q_0=0;Mscrm.ErrorStatusControl.get_statusBar().get_saveElement().attr("src","/_imgs/imagestrips/transparent_spacer.gif");Mscrm.ErrorStatusControl.$u();this.get_imageElement().mouseover(this.$$d_$1X_0);this.get_imageElement().mouseout(this.$$d_$1W_0);$P_CRM(window).bind("unload",this.$$d_$1F_0)},$1F_0:function($p0){$P_CRM(window).unbind("unload",this.$$d_$1F_0);this.$z_0()},$z_0:function(){if(!IsNull(this.get_imageElement())){this.get_imageElement().unbind("mouseover",this.$$d_$1X_0);this.get_imageElement().unbind("mouseout",this.$$d_$1W_0)}$P_CRM("#a"+Mscrm.ErrorStatusControl.get_$1()).unbind("click",this.$$d_$1b_0);$P_CRM("#save"+Mscrm.ErrorStatusControl.get_$1()).unbind("click",this.$$d_$17_0);$P_CRM("#save"+Mscrm.ErrorStatusControl.get_$1()).unbind("keydown",this.$$d_$1c_0);$P_CRM(window).unbind("unload",this.$$d_$1F_0)},$1W_0:function($p0){this.get_imageElement().attr("src")==="/_imgs/inlineedit/saveHover.png"&&this.get_imageElement().attr("src","/_imgs/inlineedit/save.png")},$1X_0:function($p0){this.get_imageElement().attr("src")==="/_imgs/inlineedit/save.png"&&this.get_imageElement().attr("src","/_imgs/inlineedit/saveHover.png")},$b_0:function($p0){if(!$get(Mscrm.ErrorStatusControl.get_$1()))return false;if(Mscrm.ErrorStatusControl.get_statusBar().$8_0||$p0>this.$Q_0)return true;return false}};Mscrm.MessageRanks=function(){};Mscrm.ErrorStatusControlFlyout=function(templateId,clickOpener){this.$$d_$1Z_0=Function.createDelegate(this,this.$1Z_0);this.$$d_$1F_0=Function.createDelegate(this,this.$1F_0);this.$$d_$1Y_0=Function.createDelegate(this,this.$1Y_0);this.$$d_$1a_0=Function.createDelegate(this,this.$1a_0);this.$A_0=$P_CRM("#"+templateId);this.$A_0.click(this.$$d_$1a_0);this.$v_0=$P_CRM("div.status-message-detail",this.$A_0);this.$c_0=clickOpener;this.$c_0.click(this.$$d_$1Y_0);$P_CRM(window).bind("unload",this.$$d_$1F_0)};Mscrm.ErrorStatusControlFlyout.prototype={$A_0:null,$v_0:null,$c_0:null,$1F_0:function($p0){$P_CRM(window).unbind("unload",this.$$d_$1F_0);this.$z_0()},$z_0:function(){!IsNull(this.$c_0)&&this.$c_0.unbind("click",this.$$d_$1Y_0);!IsNull(this.$A_0)&&this.$A_0.unbind("click",this.$$d_$1a_0);$P_CRM(window).unbind("unload",this.$$d_$1F_0)},setMessageInFlyOut:function(content){this.$v_0.html(CrmEncodeDecode.CrmHtmlEncode(content))},get_$1T_0:function(){return this.$A_0.css("display")==="none"},$1Q_0:function(){this.$A_0.hide();$P_CRM("body").unbind("click",this.$$d_$1Z_0)},$1s_0:function(){var $v_0=$P_CRM("body"),$$t_1=this;window.setTimeout(function(){$v_0.click($$t_1.$$d_$1Z_0)},100);this.$A_0.show()},$1Z_0:function($p0){this.$1Q_0()},$1a_0:function($p0){$p0.stopPropagation()},$1Y_0:function($p0){this.get_$1T_0()&&this.$1s_0()}};Mscrm.DisplayAggregatePerformanceMarkerVisitor=function(){};Mscrm.DisplayAggregatePerformanceMarkerVisitor.prototype={$S_0:null,get_displayHtml:function(){if(IsNull(this.$S_0))return "&nbsp;";return this.$S_0.toString()},visit:function(markers){if(IsNull(this.$S_0))this.$S_0=new Sys.StringBuilder;var $$dict_1=markers.get_markers();for(var $$key_2 in $$dict_1){var $v_0={key:$$key_2,value:$$dict_1[$$key_2]},$v_1=$v_0.value;this.$S_0.append(String.format('\r\n<LI>\r\n\t<Span>\r\n\t\t<DIV style="float:left; width:30%;"><b>{0}</b></Div>\r\n\t\t<DIV style="float:left; width:25%;">\r\n\t\t\tDuration:{1} ms &nbsp;\r\n\t\t</DIV>\r\n\t\t<DIV style="float:left; width:25%;">\r\n\t\t\tAvg:</strong>{2}ms &nbsp;\r\n\t\t</DIV>\r\n\t\t<DIV style="float:left; width:20%;">\r\n\t\t\tCalls:{3} &nbsp;\r\n\t\t</DIV>\r\n\t</span>\r\n</LI>\r\n',$v_0.key,$v_1.get_lastDuration(),$v_1.get_average(),$v_1.get_count()))}}};Mscrm.ProgressControl=function(){this.$y_0="<div Id='processingDialog' class='ms-crm-dialog-processing' style='display:none;'> \t<div class='ms-crm-processing-title ms-crm-TextAutoEllipsis'> <span>{0}</span> </div>\t<div> <img src='/_imgs/processing_loader.gif' class='ms-crm-inline-processing'> </div></div>";this.$4_0=false;var $v_0=$P_CRM("body");if(!$P_CRM("#processingDialog").length){$v_0.append(String.format(this.$y_0,CrmEncodeDecode.CrmHtmlEncode(window.LOCID_PROCESSING)));$v_0.append(this.$1e_0)}this.$L_0=$P_CRM("#processingDialogOverlay");this.$K_0=$P_CRM("#processingDialog")};Mscrm.ProgressControl.prototype={$4_0:false,$K_0:null,$L_0:null,$1e_0:"<div Id='processingDialogOverlay' class='ms-crm-processing-inactive-overlay' style='display:none;'></div>",$1C_0:function($p0){var $v_0=$p0[0];if(!IsNull($v_0)){var $v_1=document.createAttribute("style");$v_1.value="display:inline-block";$v_0.attributes.setNamedItem($v_1)}},$15_0:function($p0){var $v_0=$p0[0];if(!IsNull($v_0)){var $v_1=document.createAttribute("style");$v_1.value="display:none";$v_0.attributes.setNamedItem($v_1)}},$r_0:function($p0){if($p0){this.$1C_0(this.$K_0);this.$1C_0(this.$L_0)}else{this.$15_0(this.$K_0);this.$15_0(this.$L_0)}},hide:function(){if(this.$4_0)this.$4_0=false;this.$r_0(this.$4_0)},show:function(command){if(this.$1x_0(command)&&!this.$4_0)this.$4_0=true;this.$r_0(this.$4_0)},forceShow:function(){if(!this.$4_0)this.$4_0=true;this.$r_0(this.$4_0)},$1x_0:function($p0){switch($p0){case Mscrm.InlineCommands.Save:case Mscrm.InlineCommands.SaveAndClose:case Mscrm.InlineCommands.SaveAndNew:case Mscrm.InlineCommands.SaveAsCompleted:case Mscrm.InlineCommands.CreateConnection:case Mscrm.InlineCommands.AssociateToCompetitor:case Mscrm.InlineCommands.UpdateConnection:return false;default:return true}},_disposed:false,get_isDisposed:function(){return this._disposed},dispose:function(){if(this._disposed)return;if(!IsNull(this.$K_0)){this.$K_0.remove();this.$K_0=null}if(!IsNull(this.$L_0)){this.$L_0.remove();this.$L_0=null}this._disposed=true}};Mscrm.SaveResponse=function($p0,$p1){this.$2_0=$p0;this.$h_0=$p1;this.$Z_0=false};Mscrm.SaveResponse.prototype={$h_0:null,$2_0:0,$i_0:null,$j_0:null,$Z_0:false,get_message:function(){return this.$h_0},get_code:function(){return this.$2_0},get_recordId:function(){return this.$i_0},set_recordId:function(value){this.$i_0=value;return value},get_recordName:function(){return this.$j_0},set_recordName:function(value){this.$j_0=value;return value},get_navigationCanceled:function(){return this.$Z_0},set_navigationCanceled:function(value){this.$Z_0=value;return value},get_success:function(){switch(this.$2_0){case 2:case 3:case 4:case 0:case 7:case 9:return false;case 6:case 1:case 10:case 8:default:return true}}};Mscrm.SaveResponseCode=function(){};Mscrm.DuplicateDetectionService.registerClass("Mscrm.DuplicateDetectionService",null,Mscrm.IDuplicateDetectionService);Mscrm.InlineEditDataService.registerClass("Mscrm.InlineEditDataService");Mscrm.ErrorStatusControl.registerClass("Mscrm.ErrorStatusControl");Mscrm.MessageRanks.registerClass("Mscrm.MessageRanks");Mscrm.ErrorStatusControlFlyout.registerClass("Mscrm.ErrorStatusControlFlyout");Mscrm.DisplayAggregatePerformanceMarkerVisitor.registerClass("Mscrm.DisplayAggregatePerformanceMarkerVisitor",null,Mscrm.IPerformanceMarkerVisitor);Mscrm.ProgressControl.registerClass("Mscrm.ProgressControl");Mscrm.SaveResponse.registerClass("Mscrm.SaveResponse");Mscrm.SaveResponseCode.registerClass("Mscrm.SaveResponseCode");Mscrm.InlineEditDataService.$7=0;Mscrm.InlineEditDataService.$6=false;Mscrm.InlineEditDataService.$W=null;Mscrm.InlineEditDataService.$a=null;Mscrm.InlineEditDataService.$X=false;Mscrm.InlineEditDataService.$H=0;Mscrm.InlineEditDataService.$B=Mscrm.InlineEditDataService.get_$d();Mscrm.InlineEditDataService.$D=null;Mscrm.InlineEditDataService.$J=false;Mscrm.InlineEditDataService.$Y=false;Mscrm.InlineEditDataService.$F=false;Mscrm.InlineEditDataService.$0=new Mscrm.DuplicateDetectionService;Mscrm.InlineEditDataService.errorKey="_error";Mscrm.InlineEditDataService.entityDisabledKey="_entitydisabled";Mscrm.InlineEditDataService.stateCode="statecode";Mscrm.InlineEditDataService.$P=null;Mscrm.ErrorStatusControl.$R=null;Mscrm.ErrorStatusControl.$M=null;Mscrm.MessageRanks.none=0;Mscrm.MessageRanks.info=1;Mscrm.MessageRanks.warning=2;Mscrm.MessageRanks.criticalWarning=4;Mscrm.MessageRanks.progress=6;Mscrm.MessageRanks.error=10;Mscrm.MessageRanks.readOnly=20;Mscrm.SaveResponseCode.formNotFound=0;Mscrm.SaveResponseCode.formNotDirty=1;Mscrm.SaveResponseCode.preValidationFailed=2;Mscrm.SaveResponseCode.validationFailed=3;Mscrm.SaveResponseCode.formSerializationFailed=4;Mscrm.SaveResponseCode.validationSuccessful=5;Mscrm.SaveResponseCode.saveSuccessfullyInitiated=6;Mscrm.SaveResponseCode.saveFailed=7;Mscrm.SaveResponseCode.saveSucceeded=8;Mscrm.SaveResponseCode.saveCanceled=9;Mscrm.SaveResponseCode.saveSpecial=10