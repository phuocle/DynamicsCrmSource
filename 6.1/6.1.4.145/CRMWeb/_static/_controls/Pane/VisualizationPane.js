Type.registerNamespace("Mscrm");Mscrm.ChartAction=function(){};Mscrm.ChartAction.prototype={back:1,cancelDrillDown:2,none:0};Mscrm.ChartAction.registerEnum("Mscrm.ChartAction",false);Mscrm.VisualizationPane=function(element){this.$$d_hideToolBarHandler=Function.createDelegate(this,this.hideToolBarHandler);this.$$d_showToolBarHandler=Function.createDelegate(this,this.showToolBarHandler);this.$$d_attachResizeHandler=Function.createDelegate(this,this.attachResizeHandler);this.$$d_fadeOut=Function.createDelegate(this,this.fadeOut);this.$$d_fadeIn=Function.createDelegate(this,this.fadeIn);this.$$d_enlargePaneKeyUpHandler=Function.createDelegate(this,this.enlargePaneKeyUpHandler);this.$$d_reEnlargePaneHandler=Function.createDelegate(this,this.reEnlargePaneHandler);this.$$d_$2a_3=Function.createDelegate(this,this.$2a_3);this.$$d_$2O_3=Function.createDelegate(this,this.$2O_3);this.$$d_$2b_3=Function.createDelegate(this,this.$2b_3);this.$$d_HandleVisualizationChange=Function.createDelegate(this,this.HandleVisualizationChange);this.$$d_onClickHandler=Function.createDelegate(this,this.onClickHandler);this.$$d_handleWindowBeforeUnload=Function.createDelegate(this,this.handleWindowBeforeUnload);this.$$d_$2g_3=Function.createDelegate(this,this.$2g_3);this.$$d_$2q_3=Function.createDelegate(this,this.$2q_3);this.topImgFadeIntervalId=-1;this.bottomImgFadeIntervalId=-1;this.$3_3={};this.$9_3="LineColumnArea";this.$1S_3=[];this.$2_3={};this.$4_3={};this.$B_3=-1;this.$h_3=0;this.vizSubmitParams={};this.compressedParametersList=[];Mscrm.VisualizationPane.initializeBase(this,[element])};Mscrm.VisualizationPane.enableDisableElement=function(enable,elementId){var $v_0=$get(elementId);if(!IsNull($v_0)){$v_0.disabled=!enable;Mscrm.VisualizationPane.enableDisableIcon(enable,$v_0)}};Mscrm.VisualizationPane.enableDisableAddButtons=function(enable){Mscrm.VisualizationPane.enableDisableElement(enable,"addYBtn");Mscrm.VisualizationPane.enableDisableElement(enable,"addXBtn")};Mscrm.VisualizationPane.enableDisableIcon=function(enable,element){if(!IsNull(element)){var $v_0=element.getElementsByTagName("img")[0],$v_1=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_0.getAttribute("imgBase").toString(),"_dis",!enable);Mscrm.ImageStrip.changeImage($v_0,$v_1);$v_0.setAttribute("imgBase",$v_1)}};Mscrm.VisualizationPane.addOrRemoveSuffixInPath=function(sourcePath,suffix,conditionToAdd){var $v_0=".png",$v_1=sourcePath.substring(0,sourcePath.length-$v_0.length);if(conditionToAdd){if(!$v_1.endsWith(suffix))return $v_1+suffix+$v_0}else if($v_1.endsWith(suffix))return $v_1.substring(0,$v_1.length-suffix.length)+$v_0;return sourcePath};Mscrm.VisualizationPane.$0=function($p0,$p1){return $p0+"_"+$p1};Mscrm.VisualizationPane.$D=function($p0){return String.format("/_imgs/visualization/designer/{0}Chart/{0}Chart.png",$p0)};Mscrm.VisualizationPane.onSystemDesignerViewChange=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.get_isSystemDesigner()){$v_0.setParameter("vizPaneViewId",$get("visualizationDesignerViewSelector").value);$v_0.checkAndPreviewChart(false)}};Mscrm.VisualizationPane.onHoverAddButton=function(sourceElement,isHovered){sourceElement.className=isHovered&&!sourceElement.disabled?"ms-crm-AddSeries-Button-hover":"ms-crm-AddSeries-Button"};Mscrm.VisualizationPane.hideInlineActionMenus=function(){Mscrm.VisualizationPane.hideChartTypeBox();Mscrm.VisualizationPane.hideTopBottomBox()};Mscrm.VisualizationPane.displayChartTypeBox=function(domEvent){Mscrm.VisualizationPane.hideTopBottomBox();var $v_0=$get("chartTypeBox");if(!IsNull($v_0)){Mscrm.VisualizationPane.$1z(domEvent,$v_0);if($v_0.style.display==="none")$v_0.style.display="block"}};Mscrm.VisualizationPane.hideChartTypeBox=function(){var $v_0=$get("chartTypeBox");if(!IsNull($v_0)){$v_0.style.display="none";for(var $v_1=$v_0.getElementsByTagName("img"),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2],$v_4=Mscrm.VisualizationPane.$1o($v_3),$v_5=false,$v_6=$find("crmGrid_paneControl");if(!IsNull($v_6)){$v_5=$v_6.canApplyChartType($v_4);if($v_3.disabled!==!$v_5){$v_3.disabled=!$v_5;var $v_7=$v_3,$v_8=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_7.getAttribute("imgBase").toString(),"_dis",!$v_5);Mscrm.ImageStrip.changeImage($v_7,$v_8);$v_7.setAttribute("imgBase",$v_8)}}}}};Mscrm.VisualizationPane.$1z=function($p0,$p1){var $v_0=$p0.target,$v_1=$v_0.offsetParent.parentNode;$p1.style.display="block";var $v_2=$p1.offsetParent,$v_3=$v_2.offsetWidth,$v_4=-$v_1.offsetTop+$v_0.offsetHeight+$v_0.parentNode.offsetTop;$p1.style.top=$v_4.toString()+"px";if(Mscrm.Utilities.get_isLeftToRight()){var $v_5=$v_3-($v_0.offsetLeft+$v_0.offsetWidth);$p1.style.right=$v_5.toString()+"px"}else $p1.style.left=$v_0.offsetLeft.toString()+"px"};Mscrm.VisualizationPane.cancelClickEvent=function(domEvent){if(!IsNull(domEvent)){domEvent.preventDefault();domEvent.stopPropagation()}};Mscrm.VisualizationPane.handleKeyPressOnChartTypeMenu=function(domEvent){domEvent.keyCode===27&&Mscrm.VisualizationPane.hideChartTypeBox()};Mscrm.VisualizationPane.selectChartType=function(domEvent){Mscrm.VisualizationPane.cancelClickEvent(domEvent);var $v_0=domEvent.target;if(!IsNull($v_0)&&!$v_0.disabled){Mscrm.VisualizationPane.applyChartTypeInline(Mscrm.VisualizationPane.$1o($v_0));Mscrm.VisualizationPane.hideChartTypeBox()}};Mscrm.VisualizationPane.$1o=function($p0){return $p0.id.split("Type")[0]};Mscrm.VisualizationPane.hoverButton=function(domEvent,hover){var $v_0=domEvent.target,$v_1=$v_0;if(IsNull($v_1.getAttribute("imgBase")))$v_1=$v_0.getElementsByTagName("img")[0];var $v_2=$v_1.getAttribute("imgBase").toString().toLowerCase();if(!(Mscrm.Utilities.isDisabled($v_0)||$v_2.indexOf("_dis".toLowerCase(),$v_2.indexOf(".")-4)!==-1)){var $v_3=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_1.getAttribute("imgBase").toString(),"_sel",hover);Mscrm.ImageStrip.changeImage($v_1,$v_3);$v_1.setAttribute("imgBase",$v_3)}};Mscrm.VisualizationPane.applyChartTypeInline=function(chartType){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.applyChartType(chartType,true)};Mscrm.VisualizationPane.displayTopBottomBox=function(domEvent){Mscrm.VisualizationPane.hideChartTypeBox();var $v_0=$get("topBottomBox");if(!IsNull($v_0)){Mscrm.VisualizationPane.$1z(domEvent,$v_0);if($v_0.style.display==="none")$v_0.style.display="block"}};Mscrm.VisualizationPane.hideTopBottomBox=function(){var $v_0=$get("topBottomBox");if(!IsNull($v_0))$v_0.style.display="none"};Mscrm.VisualizationPane.handleKeyPressOnTopBottomMenu=function(domEvent){domEvent.keyCode===27&&Mscrm.VisualizationPane.hideTopBottomBox()};Mscrm.VisualizationPane.selectTopBottom=function(domEvent){Mscrm.VisualizationPane.cancelClickEvent(domEvent);var $v_0=domEvent.target;if(!IsNull($v_0)&&!$v_0.disabled){var $v_1=Mscrm.VisualizationPane.$29($v_0);if($v_1.toUpperCase()==="CLEAR"){var $v_2=$find("crmGrid_paneControl");!IsNull($v_2)&&$v_2.clearTopBottom();Mscrm.VisualizationPane.hideTopBottomBox()}}};Mscrm.VisualizationPane.$29=function($p0){return $p0.id.split("Rules")[0]};Mscrm.VisualizationPane.applyTopBottomInline=function(topBottomValue){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){var $v_1=topBottomValue.substr(0,topBottomValue.length-1),$v_2=$v_1.toUpperCase()==="TOP",$v_3=topBottomValue.substr(topBottomValue.length-1,1);switch($v_3){case "x":$v_0.appendTopBottomCustom($v_2,true);break;case "3":case "5":$v_0.appendTopBottom($v_3,$v_2,true,true);break;default:break}}};Mscrm.VisualizationPane.prototype={getParameter:function(name){var $v_0=this.getPaneChildElement(name);if(!IsNull($v_0)&&!IsNull($v_0.getAttribute("value")))return CrmEncodeDecode.CrmHtmlDecode($v_0.getAttribute("value").toString());return null},setParameter:function(name,value){var $v_0=this.getPaneChildElement(name);if(!IsNull($v_0))$v_0.setAttribute("value",CrmEncodeDecode.CrmHtmlAttributeEncode(value));else{var $v_1=this.getPaneChildElement("divPaneParams"),$v_2=document.createElement("div");$v_2.id=name;$v_2.setAttribute("value",CrmEncodeDecode.CrmHtmlAttributeEncode(value));$v_1.appendChild($v_2)}},getSelectedVisualization:function(){if(!IsNull(this.visualizationMenu)){var $v_0=XUI.Xml.SelectNodes(this.visualizationMenu.get_menuXml(),"//MenuItem",null),$v_1=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@isselected='true']",null);if(!IsNull($v_1))return XUI.Xml.GetText($v_1.attributes.getNamedItem("id"));else if($v_0.length>0){this.set_visualizationId(XUI.Xml.GetText($v_0[1].attributes.getNamedItem("id")));this.set_visualizationType(Number.parseInvariant(XUI.Xml.GetText($v_0[1].attributes.getNamedItem("type"))));this.visualizationMenu.setAttributeUtil($v_0[1],"isselected","true");return XUI.Xml.GetText($v_0[1].attributes.getNamedItem("id"))}}return ""},isVisualizationLayoutLeftRight:function(){var $v_0=this.getParameter("compositeLayout");if(IsNull($v_0)||$v_0==="0")return true;else return false},getSelectedVisualizationDisplayName:function(){if(!IsNull(this.visualizationMenu)){var $v_0=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@isselected='true']",null);if(!IsNull($v_0))return XUI.Xml.GetText($v_0.attributes.getNamedItem("display"))}return window.LOCID_CP_NOVISUALIZATION},getPaneChildElement:function(id){if(id==="vizIframe"||id==="vizForm"){var $v_0=isNullOrEmptyString(this._gridId)?"crmGrid":this._gridId;return window.document.getElementById($v_0+"_"+id)}else return $get(id,this.get_element())},get_elementId:function(){return this.get_element().id},fireEventForStickyVisualization:function(){var $v_0=this.get_$C_3();if($v_0===Mscrm.VisualizationPaneMode.resizeMode)$v_0=Mscrm.VisualizationPaneMode.defaultSize;var $v_1=Mscrm.VisualizationActions.createVizParamsDictionary(this.getParameter("compositeLayout"),this.get_visualizationId(),this.get_visualizationType().toString(),$v_0,this.getParameter("vizPanePrimaryEntityName"),this.getParameter("IsDashboardComponent"));Mscrm.VisualizationActions.fireEventForStickyVisualization($v_1)},getDivInIFrame:function(divId){var $v_0=this.getPaneChildElement("vizIframe");if(!IsNull($v_0)){var $v_1=$v_0.contentWindow.document.getElementById(divId);if(!IsNull($v_1))return $v_1}return null},addFormParameter:function(formName,inputName,value){var $v_0=this.getPaneChildElement(formName),$v_1=$get(inputName,$v_0);if(IsNull($v_1)){var $v_2=document.createElement("input");$v_2.type="hidden";$v_2.name=inputName;$v_2.id=inputName;if(IsNull(value))value="";$v_2.value=value;$v_0.appendChild($v_2)}else $v_1.value=value},addSubmitParameters:function(key,value,isCompressed){if(isNullOrEmptyString(value))return;if(IsNull(isCompressed))isCompressed=false;this.vizSubmitParams[key]=value;isCompressed&&Array.add(this.compressedParametersList,key)},cancelEvent:function(domEvent){if(!IsNull(domEvent)){domEvent.preventDefault();domEvent.stopPropagation()}},buildVisualizationXml:function(){var $v_0="<{0}{1}>{2}</{0}>",$v_1=new Sys.StringBuilder("<vizXml>"),$$dict_2=this.vizSubmitParams;for(var $$key_3 in $$dict_2){var $v_2={key:$$key_3,value:$$dict_2[$$key_3]},$v_3=!$v_2.value?"":$v_2.value,$v_4=Array.contains(this.compressedParametersList,$v_2.key)?" isCompressed='true'":"";$v_1.append(String.format($v_0,CrmEncodeDecode.CrmXmlEncode($v_2.key),$v_4,CrmEncodeDecode.CrmXmlEncode($v_3)))}$v_1.append("</vizXml>");return $v_1.toString()},getIframeWin:function(){var $v_0=this.$1F_3();if(!IsNull($v_0)&&!IsNull($v_0.contentWindow))return $v_0.contentWindow;return null},get_dashboardToolBarContainerId:function(){return this._gridId+"_d"},_paneMode:0,$j_3:false,$16_3:false,$V_3:"-1",_isComplexChart:false,_useCachedData:false,autoFillTitle:true,$A_3:false,_currentSeriesAxisLabel:null,_currentCategoryAxisLabel:null,_currentDataXml:null,_currentPresentationXml:null,$1k_3:null,$1i_3:null,$1j_3:null,$1h_3:null,$1B_3:null,$1T_3:null,$1C_3:null,$1U_3:null,$W_3:false,$8_3:"-1",$H_3:"-1",$1_3:10,$i_3:null,$1P_3:null,$1J_3:null,allAggregateHtml:"",countAggregateHtml:"",get_counter:function(){return this.$1_3},set_counter:function(value){this.$1_3=value;return value},get_chartTypesDictionary:function(){return this.$3_3},get_firstSeriesId:function(){var $v_0="-1",$v_1=this.$28_3();if($v_1&&$v_1.length>0)$v_0=$v_1[0];return $v_0},$2o_3:function($p0){return $p0.indexOf("tdyAttributeSelector_")!==-1},$2m_3:function($p0){return $p0.indexOf("tdxAttributeSelector_")!==-1},$2c_3:function(){return this.$27_3(true)},$28_3:function(){return this.$27_3(false)},$27_3:function($p0){var $v_0=[],$v_1=this.getPaneChildElement("designerAttributesSelectorTable");if(!IsNull($v_1)){var $v_2=0,$v_3=XUI.Html.DomUtils.GetFirstChild($v_1);while(!IsNull($v_3)){if($p0&&this.$2m_3($v_3.id)||!$p0&&this.$2o_3($v_3.id)){var $v_4=this.$J_3($v_3.id).toString();$v_0[$v_2]=$v_4;++$v_2}$v_3=XUI.Html.DomUtils.GetNextSibling($v_3)}}return $v_0},get_currentChartTypeGroup:function(){return this.$9_3},set_currentChartTypeGroup:function(value){this.$9_3=value;return value},get_selectedSeriesName:function(){return this.generateSeriesLabel(Number.parseInvariant(this.$8_3))},get_seriesCount:function(){var $v_0=0,$$dict_1=this.$2_3;for(var $$key_2 in $$dict_1){var $v_1={key:$$key_2,value:$$dict_1[$$key_2]};$v_0++}return $v_0},get_categoryCount:function(){var $v_0=0,$$dict_1=this.$4_3;for(var $$key_2 in $$dict_1){var $v_1={key:$$key_2,value:$$dict_1[$$key_2]};$v_0++}return $v_0},get_seriesSelectedForRibbonActions:function(){return this.$8_3},set_seriesSelectedForRibbonActions:function(value){this.$8_3=value;return value},get_seriesSelectedForInlineActions:function(){return this.$H_3},set_seriesSelectedForInlineActions:function(value){this.$H_3=value;return value},get_paneMode:function(){return this._paneMode},set_paneMode:function(value){this._paneMode=value;return value},get_isComplexChart:function(){return this._isComplexChart},get_isSystemDesigner:function(){return this.getParameter("isSystemDesigner")==="1"},get_isChartDirty:function(){return this.$A_3},set_isChartDirty:function(value){this.$A_3=value;return value},switchMode:function(paneRenderingMode){var $v_0=this.getPaneChildElement("contentSpan"),$v_1=this._gridId+"_paneControl";this.disableEmptyMessageLabels($v_0);Mscrm.PageManager.isOutlookProxyPage()&&getOutlookHostedWindow().switchVisualizationPaneMode(paneRenderingMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode);if(paneRenderingMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode){this.showVisualizationPane(true);this.clearContentSpan($v_0);this._paneMode=paneRenderingMode;window.setTimeout("$find('"+$v_1+"').switchModeAsync("+paneRenderingMode+")",0)}else{if(!IsNull(this.$i_3)){this.$i_3.dispose();this.$i_3=null}if(!IsNull(this.$1P_3)){this.$1P_3.dispose();this.$1P_3=null}if(!IsNull(this.$1J_3)){this.$1J_3.dispose();this.$1J_3=null}this.clearContentSpan($v_0);this.$31_3();var $v_2=this.getPaneChildElement("headerRowTR");$v_2.style.display="";this.updateFooterMessage("");var $v_3=this.getPaneChildElement("contentContainer");$v_3.style.top=$v_2.offsetHeight.toString()+"px";this._paneMode=Mscrm.VisualizationPaneRenderingModes.RuntimeMode;this.refreshCurrentVisualizationIdAndType();refreshRibbon()}},$31_3:function(){this.$1r_3();this.$9_3="LineColumnArea";this._currentDataXml=null;this._currentPresentationXml=null;this.$1k_3=null;this.$1i_3=null;this.$1j_3=null;this.$1h_3=null;this.$2_3={};this.$4_3={};this.$1B_3=null;this.$1T_3=null;this.$1C_3="";this.$1U_3="";this.$W_3=false;this.$8_3="-1";this.$H_3="-1";this.allAggregateHtml="";this.countAggregateHtml="";this.$1_3=10},switchModeAsync:function(paneRenderingMode){var $v_0=this.getPaneChildElement("contentSpan"),$v_1=Mscrm.EntityTypeCode.UserQueryVisualization,$v_2=new RemoteCommand("PaneWebService","SwitchMode",null);$v_2.SetParameter("paneMode",paneRenderingMode.toString());if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode){$v_2.SetParameter("vizId",this.get_visualizationId());$v_1=this.get_visualizationType()}$v_2.SetParameter("vizPanePrimaryEntityName",this.getParameter("vizPanePrimaryEntityName"));$v_2.SetParameter("vizPaneViewType",this.getParameter("vizPaneViewType"));$v_2.SetParameter("vizPaneViewId",this.getParameter("vizPaneViewId"));$v_2.SetParameter("vizType",$v_1);$v_2.SetParameter("paneLayout",this.getParameter("compositeLayout"));$v_2.SetParameter("vizPaneId",this.get_element().id);var $v_3=$find(this._gridId),$v_4="";if(!IsNull($v_3))$v_4=$v_3.GetParameter("layoutXml");$v_2.SetParameter("layoutXml",$v_4);var $v_5=$v_2.Execute(null);if($v_5.Success){var $v_6=$v_5.ReturnValue;if(!isNullOrEmptyString($v_6)){var $v_7=this.getPaneChildElement("headerRowTR");$v_7.style.display="none";var $v_8=this.getPaneChildElement("contentContainer");$v_8.style.top="0px";var $v_9=document.createElement("SPAN");$v_9.id="designerSpan";$v_0.appendChild($v_9);$v_9.innerHTML=$v_6;this.initializeDesignerMode();this.showContentSpan($v_0);this.handleFocus();var $v_A=paneRenderingMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode?this.get_visualizationId():"";this.set_visualizationId($v_A);this.set_visualizationType(Mscrm.EntityTypeCode.UserQueryVisualization)}}else{this.switchMode(Mscrm.VisualizationPaneRenderingModes.RuntimeMode);this.loadVisualization(false);this.updateFooterMessageWithIcon(window.LOCID_VPD_ERR_ONLOAD,false);return}refreshRibbon()},onYAttributeChange:function(sourceElement){var $v_0=this.$J_3(sourceElement.id),$v_1=sourceElement;if(!IsNull($v_1)){this.$A_3=true;if(this.$2F_3(false,$v_0)&&$v_1.selectedIndex){var $v_2=XUI.Xml.DomUtils.GetFirstChild($v_1);$v_2.removeChild(XUI.Xml.DomUtils.GetFirstChild($v_2))}this.setYAttributeInDataXml($v_1.value,$v_0);this.setAggregateList(true,$v_0);this.updateTopBottomButtonState();refreshRibbon()}},setFocusOnVizPane:function(){var $v_0=this.isPaneInDesignerMode();if($v_0){var $v_1=this.getPaneChildElement("yAttributeSelector1");!IsNull($v_1)&&this.setFocus($v_1)}else{var $v_2=this.getPaneChildElement("visualizationList");!IsNull($v_2)&&this.setFocus($v_2)}},$2R_3:function(){var $v_0=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/ChartAreas/ChartArea/AxisY2",null);if(!$v_0){var $v_1=XUI.Xml.LoadXml('<AxisY2 LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"> <MajorGrid LineColor="239, 242, 246" /> <MajorTickMark LineColor="165, 172, 181" /> <LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /> </AxisY2>');$v_0=XUI.Xml.SelectSingleNode($v_1,"AxisY2",null);var $v_2=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/ChartAreas/ChartArea",null);$v_2.appendChild($v_0.cloneNode(true))}},$1y_3:function($p0){var $v_0=this.$2_3[$p0],$v_1=this._currentPresentationXml.createAttribute("YAxisType");$v_1.value="Secondary";$v_0.$7_1.attributes.setNamedItem($v_1)},$2w_3:function(){var $v_0=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/ChartAreas/ChartArea/AxisY2",null);$v_0&&$v_0.parentNode.removeChild($v_0)},$2y_3:function($p0){var $v_0=this.$2_3[$p0];$v_0&&$v_0.$7_1.attributes.removeNamedItem("YAxisType")},markChartNodeReadyForUse:function(isCategory,itemKey){var $v_0=isCategory?this.$4_3[itemKey.toString()]:this.$2_3[itemKey.toString()];if(!$v_0.$L_0)$v_0.$L_0=true},$2F_3:function($p0,$p1){return !this.$2n_3($p0,$p1)},$2n_3:function($p0,$p1){var $v_0=$p0?this.$4_3[$p1.toString()]:this.$2_3[$p1.toString()];return $v_0.$L_0},handleAddField:function(id){if($get(id).disabled)return;if(id==="addXBtn"){this.$1G_3(true);this.onAddNewX(Mscrm.VisualizationPane.INVALIDINDEX)}else{this.$1G_3(false);this.onAddNewY(Mscrm.VisualizationPane.INVALIDINDEX)}},onAddNewY:function(index){var $v_0=this.getPaneChildElement("addYDiv");if(!IsNull($v_0)&&!IsNull(this.$1C_3)){this.addSeriesHtmlRow($v_0);if(this.$W_3)this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&this.$2L_3(false,index);else{this.$36_3();this.updateChartTypeIcon(this.getChartTypeString(this.$1_3.toString()),this.$1_3.toString());if(this.get_seriesCount()===2){this.$1y_3(this.$1_3.toString());this.$2R_3()}}this.updateButtonStates(false);Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon();this.$c_3()}},addSeriesHtmlRow:function(addSeriesButton){var $v_0=document.createElement("div");$v_0.innerHTML=this.$1C_3;var $v_1=XUI.Html.DomUtils.GetFirstChild($v_0);$v_1.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("tdyAttributeSelector",this.$1_3.toString()));addSeriesButton.parentNode.insertBefore($v_1,addSeriesButton);this.updateNewYNodeAttributes()},updateNewYNodeAttributes:function(){var $v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAttributeSelector","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("yAttributeSelector",this.$1_3.toString()));var $$t_D=this;$addHandler($v_0,"change",function($p1_0){$$t_D.onYAttributeChange($p1_0.target)});!this.$W_3&&$v_0.focus()}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAggregateSelector","0"));if($v_0){$v_0.disabled=true;$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("yAggregateSelector",this.$1_3.toString()));var $$t_E=this;$addHandler($v_0,"change",function($p1_0){$$t_E.onYAggregateChange($p1_0.target)})}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("removeSeriesBtn","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("removeSeriesBtn",this.$1_3.toString()));$v_0.parentNode.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("removeSeriesBtnLink",this.$1_3.toString()));var $$t_F=this;$addHandler($v_0.parentNode,"click",function($p1_0){Mscrm.VisualizationPane.cancelClickEvent($p1_0);var $v_1=$p1_0.target;!Mscrm.Utilities.isDisabled($v_1)&&$$t_F.onRemoveY($v_1)})}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yRowCheckBox","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("yRowCheckBox",this.$1_3.toString()));var $$t_G=this;$addHandler($v_0,"click",function($p1_0){$$t_G.onYRowSelect($p1_0.target)})}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("chartTypeImage","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("chartTypeImage",this.$1_3.toString()));$v_0.parentNode.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("chartTypeImageLink",this.$1_3.toString()));this.updateChartTypeIcon(this.getChartTypeString(this.$1_3.toString()),this.$1_3.toString());var $$t_H=this;$addHandler($v_0.parentNode,"click",function($p1_0){Mscrm.VisualizationPane.cancelClickEvent($p1_0);var $v_2=$p1_0.target;if(!Mscrm.Utilities.isDisabled($v_2)){$$t_H.$H_3=$$t_H.$J_3($v_0.id).toString();Mscrm.VisualizationPane.displayChartTypeBox($p1_0)}})}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("topBottomImage","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("topBottomImage",this.$1_3.toString()));$v_0.parentNode.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("topBottomImageLink",this.$1_3.toString()));var $v_3=this.$1_3.toString()===this.$V_3;if($v_3){var $v_4=String.format("/_imgs/visualization/designer/topBottom/{0}Rules.png",this.$16_3?"top":"bottom");Mscrm.ImageStrip.changeImage($v_0,$v_4);$v_0.setAttribute("imgBase",$v_4)}else{var $v_5="/_imgs/visualization/designer/topBottom/TopBottomRules.png";Mscrm.ImageStrip.changeImage($v_0,$v_5);$v_0.setAttribute("imgBase",$v_5)}var $$t_I=this;$addHandler($v_0.parentNode,"click",function($p1_0){Mscrm.VisualizationPane.cancelClickEvent($p1_0);var $v_6=$p1_0.target;if(!Mscrm.Utilities.isDisabled($v_6)){$$t_I.$H_3=$$t_I.$J_3($v_0.id).toString();Mscrm.VisualizationPane.displayTopBottomBox($p1_0)}})}},$1X_3:function($p0,$p1,$p2,$p3){if($p0!==Mscrm.VisualizationPane.INVALIDINDEX.toString()){var $v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("topBottomImage",$p0)),$v_1="/_imgs/visualization/designer/topBottom/TopBottomRules.png";Mscrm.ImageStrip.changeImage($v_0,$v_1);$v_0.setAttribute("imgBase",$v_1);$v_0.title=window.LOCID_TOPBOTTOM_ICON;$v_0.alt=$v_0.title}if($p1!==Mscrm.VisualizationPane.INVALIDINDEX.toString()){var $v_2=this.getPaneChildElement(Mscrm.VisualizationPane.$0("topBottomImage",$p1)),$v_3=String.format("/_imgs/visualization/designer/topBottom/{0}Rules.png",$p2?"top":"bottom");Mscrm.ImageStrip.changeImage($v_2,$v_3);$v_2.setAttribute("imgBase",$v_3);var $v_4=$p2?window.LOCID_TOP_ICON:window.LOCID_BOTTOM_ICON;$v_2.title=String.format($v_4,$p3);$v_2.alt=$v_2.title}},$2L_3:function($p0,$p1){this.$33_3($p0,$p1);!$p0&&this.setAggregateList(false,this.$1_3);this.$32_3($p0,$p1)},$33_3:function($p0,$p1){var $v_0=$p0?"xAttributeSelector":"yAttributeSelector",$v_1=this.getPaneChildElement(Mscrm.VisualizationPane.$0($v_0,this.$1_3.toString()));if($v_1){var $v_2=$p0?this.$1i_3:this.$1k_3;$v_1.value=$v_2[$p1];var $v_3=$v_1.options[0];$v_3.parentNode.removeChild($v_3)}},$32_3:function($p0,$p1){var $v_0=$p0?"xDateTimeGroupingSelector":"yAggregateSelector",$v_1=this.getPaneChildElement(Mscrm.VisualizationPane.$0($v_0,this.$1_3.toString()));if($v_1){var $v_2=$p0?this.$1h_3:this.$1j_3,$v_3=$v_2[$p1];if(!isNullOrEmptyString($v_3))if($v_3.toUpperCase()!=="DUMMY"){$v_1.value=$v_3;if($p0)$v_1.style.display="inline"}}},$36_3:function(){var $v_0=new Mscrm.YChartNodeItem(null,"",null,null,true);this.$2_3[this.$1_3.toString()]=$v_0;this.$37_3($v_0);this.$39_3($v_0)},$37_3:function($p0){var $v_0=this.$1B_3.cloneNode(true),$v_1=$v_0.attributes.getNamedItem("alias");$v_1.value="_CRMAutoGen_aggregate_column_Num_"+this.$1_3;var $v_2=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null);$v_2.appendChild($v_0);var $v_3=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/categorycollection/category/measurecollection",null),$v_4=$v_3.cloneNode(true),$v_5=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/categorycollection/category/measurecollection/measure",null),$v_6=$v_5.cloneNode(true),$v_7=$v_6.attributes.getNamedItem("alias");$v_7.value="_CRMAutoGen_aggregate_column_Num_"+this.$1_3;$v_4.replaceChild($v_6,XUI.Xml.DomUtils.GetFirstChild($v_4));$v_3.parentNode.appendChild($v_4);$p0.$G_0=$v_0;$p0.$M_0=XUI.Xml.GetText($v_1);$p0.$m_1=$v_6;$p0.$L_0=false},$39_3:function($p0){var $v_0=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/Series",null),$v_1="";switch(this.$9_3){case "LineColumnArea":$v_1='<Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';break;case "Bar":$v_1='<Series ChartType="Bar" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>';break;default:$v_1='<Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';break}var $v_2=XUI.Xml.LoadXml($v_1).documentElement.cloneNode(true);$v_0.appendChild($v_2);this.addLegends();$p0.$7_1=$v_2},addLegends:function(){if(this.get_seriesCount()===2||this.get_categoryCount()===2){var $v_0=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart",null),$v_1=XUI.Xml.SelectSingleNode($v_0,"Legends",null),$v_2=XUI.Xml.LoadXml('<Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends>').documentElement.cloneNode(true);if(IsNull($v_1))$v_0.appendChild($v_2);else!$v_1.hasChildNodes()&&$v_0.replaceChild($v_2,$v_1)}},updateButtonStates:function(isCategory){this.updateAddButtonState();this.updateRemoveButtonState(isCategory);this.updateTopBottomButtonState()},updateTopBottomButtonState:function(){var $$dict_0=this.$2_3;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]},$v_1=$v_0.key,$v_2=this.getPaneChildElement(Mscrm.VisualizationPane.$0("topBottomImage",$v_1));if(!IsNull($v_2)){var $v_3=this.isTopBottomEnabled($v_0.value),$v_4;if(!$v_3){$v_4="/_imgs/visualization/designer/topBottom/TopBottomRules.png";$v_2.setAttribute("disabled","disabled");$v_2.parentNode.setAttribute("disabled","disabled")}else{$v_4=$v_2.getAttribute("imgBase").toString();$v_2.removeAttribute("disabled");$v_2.parentNode.removeAttribute("disabled")}$v_4=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_4,"_dis",!$v_3);Mscrm.ImageStrip.changeImage($v_2,$v_4);$v_2.setAttribute("imgBase",$v_4)}}},updateAddButtonState:function(){var $v_0=this.$9_3==="Incompatible",$v_1=!this._isComplexChart&&!$v_0&&this.get_categoryCount()<2&&this.get_seriesCount()<=1,$v_2=!this._isComplexChart&&!$v_0&&this.get_seriesCount()<5&&this.get_categoryCount()<=1;Mscrm.VisualizationPane.enableDisableElement($v_1,"addXBtn");Mscrm.VisualizationPane.enableDisableElement($v_2,"addYBtn")},updateRemoveButtonState:function(isCategory){var $v_0=0,$v_1=null,$v_2="";if(isCategory){$v_0=this.get_categoryCount();$v_1=this.$4_3;$v_2="removeXBtn"}else{$v_0=this.get_seriesCount();$v_1=this.$2_3;$v_2="removeSeriesBtn"}var $v_3=$v_0===1,$$dict_5=$v_1;for(var $$key_6 in $$dict_5){var $v_4={key:$$key_6,value:$$dict_5[$$key_6]},$v_5=Mscrm.VisualizationPane.$0($v_2,$v_4.key),$v_6=$get($v_5,this.get_element()),$v_7=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_6.getAttribute("imgBase").toString(),"_dis",this._isComplexChart);Mscrm.ImageStrip.changeImage($v_6,$v_7);$v_6.setAttribute("imgBase",$v_7);$v_6.parentNode.style.visibility=$v_3?"hidden":"visible"}},onAddNewX:function(index){var $v_0=this.getPaneChildElement("addXDiv");if(!IsNull($v_0))if(!IsNull(this.$1U_3)){this.addCategoryHtmlRow($v_0);if(this.$W_3)this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&this.$2L_3(true,index);else this.updateDataAndPresentationXmlForNewX()}this.updateButtonStates(true);Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon();this.$c_3()},addCategoryHtmlRow:function(addCategoryButton){var $v_0=document.createElement("div");$v_0.innerHTML=this.$1U_3;var $v_1=XUI.Html.DomUtils.GetFirstChild($v_0);$v_1.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("tdxAttributeSelector",this.$1_3.toString()));addCategoryButton.parentNode.insertBefore($v_1,addCategoryButton);this.updateNewXNodeAttributes()},updateNewXNodeAttributes:function(){var $v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("xAttributeSelector","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("xAttributeSelector",this.$1_3.toString()));var $$t_5=this;$addHandler($v_0,"change",function($p1_0){$$t_5.onXAttributeChange($p1_0.target)});!this.$W_3&&$v_0.focus()}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("xDateTimeGroupingSelector","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("xDateTimeGroupingSelector",this.$1_3.toString()));$v_0.style.display="none";var $$t_6=this;$addHandler($v_0,"change",function($p1_0){$$t_6.onDateGroupingChange($p1_0.target)})}$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("removeXBtn","0"));if($v_0){$v_0.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("removeXBtn",this.$1_3.toString()));$v_0.parentNode.id=CrmEncodeDecode.CrmHtmlAttributeEncode(Mscrm.VisualizationPane.$0("removeXBtnLink",this.$1_3.toString()));var $$t_7=this;$addHandler($v_0.parentNode,"click",function($p1_0){Mscrm.VisualizationPane.cancelClickEvent($p1_0);var $v_1=$p1_0.target;!Mscrm.Utilities.isDisabled($v_1)&&$$t_7.onRemoveX($v_1)})}},updateCategoryNodeAlias:function(){var $v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/categorycollection/category",null),$v_1=this._currentDataXml.createAttribute("alias"),$v_2=this.$2c_3()[0];$v_1.value=this.$4_3[$v_2].$M_0;$v_0.attributes.setNamedItem($v_1)},updateDataAndPresentationXmlForNewX:function(){var $v_0=this.$1T_3.cloneNode(true),$v_1=$v_0.attributes.getNamedItem("alias");$v_1.value="_CRMAutoGen_groupby_column_Num_"+this.$1_3;var $v_2=new Mscrm.ChartNodeItem($v_0,XUI.Xml.GetText($v_1),true);this.$4_3[this.$1_3.toString()]=$v_2;var $v_3=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null);$v_3.appendChild($v_0);this.updateCategoryNodeAlias();this.addLegends();this.get_categoryCount()===2&&this.clearTopBottom()},$25_3:function($p0){var $v_0=$p0.parentNode;while($v_0.tagName.toUpperCase()!=="DIV"||$v_0.id.indexOf("AttributeSelector")===-1)$v_0=$v_0.parentNode;return $v_0},onRemoveX:function(sourceElement){var $v_0=this.$J_3(sourceElement.id);this.modifyDataXmlAttribute(true,"",$v_0,true);var $v_1=this.$25_3(sourceElement);$v_1&&$v_1.parentNode.removeChild($v_1);delete this.$4_3[$v_0.toString()];this.updateCategoryNodeAlias();this.$A_3=true;!this.checkAndPreviewChart(true)&&this.$c_3();this.updateButtonStates(true);Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon()},onYAggregateChange:function(sourceElement){var $v_0=this.$J_3(sourceElement.id),$v_1=sourceElement;if(!IsNull($v_1)){this.$A_3=true;if($v_1.options[0].getAttribute("value")==="Aggregate"){$v_1.remove(0);!this.$1V_3()&&this.saveAggregateHtml($v_1,true)}this.setAggregateInDataXml($v_1.value,$v_0);!this.checkAndPreviewChart(true)&&this.$c_3()}},onYRowSelect:function(sourceElement){var $v_0=this.$J_3(sourceElement.id).toString(),$v_1=sourceElement,$v_2=$v_1.checked;if(!$v_2){this.highlightSeries(false,$v_0);this.$8_3=this.get_firstSeriesId()}else{this.highlightSeries(false,this.$8_3);this.highlightSeries(true,$v_0);if($v_0.toString()!==this.$8_3){var $v_3=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yRowCheckBox",this.$8_3));if($v_3)$v_3.checked=false;this.$8_3=$v_0.toString()}}refreshRibbon()},highlightSeries:function(toBeHighlighted,seriesId){if(seriesId!==Mscrm.VisualizationPane.INVALIDINDEX.toString()){var $v_0=Mscrm.VisualizationPane.$0("tdyAttributeSelector",seriesId),$v_1=this.getPaneChildElement($v_0);if(!IsNull($v_1))$v_1.style.backgroundColor=toBeHighlighted?"#a7cdf0":""}},$c_3:function(){var $v_0=this.getPaneChildElement("previewFrameCell");if(!IsNull($v_0)){var $v_2=this.getPaneChildElement("previewIframe");if(!IsNull($v_2))$v_2.src=null;$v_0.innerHTML="";$v_0.style.display="none"}var $v_1=this.getPaneChildElement("staticImageTable");if(!IsNull($v_1)){$v_1.style.display="";this.updateStaticImages();var $v_3=window.LOCID_VPD_INLINEMSG_ONLOAD;this.updateFooterMessage($v_3)}},onRemoveY:function(sourceElement){var $v_0=this.$J_3(sourceElement.id);if(IsNull($v_0))return;var $v_1=$v_0.toString(),$v_2=$v_1===this.get_firstSeriesId();this.updateSecYAxisInfo($v_1);this.modifyDataXmlAttribute(false,"",$v_0,true);var $v_3=this.$25_3(sourceElement);$v_3&&$v_3.parentNode.removeChild($v_3);var $v_4=this.$2_3[$v_1];$v_4.$m_1.parentNode.parentNode.removeChild($v_4.$m_1.parentNode);$v_4.$7_1.parentNode.removeChild($v_4.$7_1);this.$2x_3($v_4.$M_0);delete this.$2_3[$v_1];this.$A_3=true;if($v_2){var $v_5=this.$3_3[this.getChartTypeString(this.get_firstSeriesId())];if(!IsNull($v_5)){var $v_6=$v_5;this.updatePresXmlColorPalette($v_6.$1O_0)}}if(this.$8_3===$v_1)this.$8_3=this.get_firstSeriesId();!this.checkAndPreviewChart(true)&&this.$c_3();this.updateButtonStates(false);Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon()},updateSecYAxisInfo:function(seriesNumber){for(var $v_0=this.$28_3(),$v_1=0;$v_1<Math.min($v_0.length,2);++$v_1)if($v_0[$v_1]===seriesNumber.toString()){this.$2W_3($v_0,!$v_1);break}},$2W_3:function($p0,$p1){$p1&&this.$2y_3($p0[1]);if($p0.length>2)this.$1y_3($p0[2]);else this.$2w_3()},$1G_3:function($p0){++this.$1_3;var $v_0=$p0?"_CRMAutoGen_groupby_column_Num_":"_CRMAutoGen_aggregate_column_Num_",$v_1=$v_0+this.$1_3;while(Array.contains(this.$1S_3,$v_1)){++this.$1_3;$v_1=$v_0+this.$1_3}},$J_3:function($p0){var $v_0=Mscrm.VisualizationPane.INVALIDINDEX;if($p0){var $v_1=$p0.split("_");$v_0=Number.parseInvariant($v_1[$v_1.length-1])}return $v_0},onXAttributeChange:function(sourceElement){var $v_0=this.$J_3(sourceElement.id),$v_1=sourceElement;if(!IsNull($v_1)){this.$A_3=true;var $v_2=$v_1.options[$v_1.selectedIndex].getAttribute("type"),$v_3=this.getPaneChildElement(Mscrm.VisualizationPane.$0("xDateTimeGroupingSelector",$v_0.toString()));if(!isNullOrEmptyString($v_2)&&!IsNull($v_3))if($v_2.toUpperCase()!=="DATETIME"){$v_3.style.display="none";this.setDateGroupingInDataXml($v_3.value,true,$v_0)}else{$v_3.style.display="inline";$v_3.value="month";this.setDateGroupingInDataXml($v_3.value,false,$v_0)}if(this.$2F_3(true,$v_0)&&$v_1.selectedIndex){var $v_4=XUI.Xml.DomUtils.GetFirstChild($v_1);$v_4.removeChild(XUI.Xml.DomUtils.GetFirstChild($v_4));$v_1.style.display="inline"}this.setGroupByInDataXml($v_1.value,$v_0);this.updateCategoryNodeAlias();!this.checkAndPreviewChart(true)&&this.$c_3()}this.markChartNodeReadyForUse(true,$v_0);this.updateTopBottomButtonState();refreshRibbon()},$20_3:function($p0){var $v_0=$p0?this.$4_3:this.$2_3,$$dict_2=$v_0;for(var $$key_3 in $$dict_2){var $v_1={key:$$key_3,value:$$dict_2[$$key_3]},$v_2=$v_1.value;if(!$v_2.$L_0)return false}return true},$21_3:function(){return this.$22_3()&&this.$23_3()},$22_3:function(){return this.$20_3(true)},$23_3:function(){return this.$20_3(false)},$2D_3:function(){return this.$2C_3(true)},$2E_3:function(){return this.$2C_3(false)},$2C_3:function($p0){var $v_0=$p0?this.$4_3:this.$2_3,$$dict_2=$v_0;for(var $$key_3 in $$dict_2){var $v_1={key:$$key_3,value:$$dict_2[$$key_3]},$v_2=$v_1.value;if($v_2.$L_0)return true}return false},checkAndPreviewChart:function(updateFooter,useCachedData){var $v_0=false;if(this.areRequiredInputsPresent(false)){this.autoFillTitle&&this.setChartName();updateFooter&&this.updateFooterMessage("");this._useCachedData=useCachedData;this.loadPreview();$v_0=true}return $v_0},onDateGroupingChange:function(sourceElement){var $v_0=this.$J_3(sourceElement.id);this.$A_3=true;var $v_1=sourceElement;if(!IsNull($v_1)){this.setDateGroupingInDataXml($v_1.value,false,$v_0);!this.checkAndPreviewChart(false)&&this.$c_3()}},onChartTitleChange:function(){var $v_0=this.get_chartNameInput();if(!IsNull($v_0)){if(!isNullOrEmptyString($v_0.value))this.autoFillTitle=false;else{this.autoFillTitle=true;this.$21_3()&&this.setChartName()}isNullOrEmptyString(XUI.Html.GetText(this.getPaneChildElement("visualizationDescription")))&&this.updateTooltip()}this.$2D_3()&&this.$2E_3()&&this.updateFooterMessage("")},onChartDescChange:function(){this.updateTooltip();this.$2D_3()&&this.$2E_3()&&this.updateFooterMessage("")},confirmViewChange:function(viewId){if(this.isVisualizationPaneVisible()&&this.isPaneInDesignerMode()&&!this.isQuickFindQuery(viewId)&&this.isDesignerPaneDirty())return confirm(window.LOCID_ON_VIEW_CHANGE1+"\n"+window.LOCID_ON_VIEW_CHANGE2);return true},isDesignerPaneDirty:function(){var $v_0=null;if(!IsNull(this.get_chartNameInput()))$v_0=Mscrm.FormControlInputBehavior.GetBehavior(this.get_chartNameInput().id);var $v_1=Mscrm.FormControlInputBehavior.GetBehavior("visualizationDescription");return this.$A_3||!IsNull($v_0)&&$v_0.get_isDirty()||!IsNull($v_1)&&$v_1.get_isDirty()},isPaneInDesignerMode:function(){if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode)return true;return false},fadeInStaticImg:function(isTopImg){var $v_0=isTopImg?"topImg":"bottomImg",$v_1=this.getPaneChildElement($v_0),$v_2=XUI.Html.GetOpacity($v_1);if($v_2>=1){this.clearFading(isTopImg);return}$v_2=$v_2+.2;!IsNull($v_1)&&XUI.Html.SetOpacity($v_1,$v_2)},fadeOutStaticImg:function(isTopImg){var $v_0=isTopImg?"topImg":"bottomImg",$v_1=this.getPaneChildElement($v_0),$v_2=this._gridId+"_paneControl",$v_3=XUI.Html.GetOpacity($v_1);if($v_3<=.4){this.clearFading(isTopImg);var $v_4=window.setInterval("$find('"+$v_2+"').fadeInStaticImg("+isTopImg+")",2);this.setFadeIntervalId(isTopImg,$v_4);return}$v_3=$v_3-.2;!IsNull($v_1)&&XUI.Html.SetOpacity($v_1,$v_3)},handleWindowBeforeUnload:function(oEvent){if(this.isPaneInDesignerMode()&&this.isDesignerPaneDirty()&&this.get_isSystemDesigner()){oEvent.rawEvent.returnValue=window.LOCID_VPD_CLOSEWARNING;return LOCID_VPD_CLOSEWARNING}},handleFocus:function(){var $v_0=this.getPaneChildElement("yAttributeSelector1");if(!IsNull($v_0)&&!$v_0.disabled)this.setFocus($v_0);else this.setFocus(this.get_chartNameInput())},updateTooltip:function(){var $v_0=this.$14_3(),$v_1=window.LOCID_VPD_ALT_TEXT;if(!IsNull($v_0)){var $v_2=XUI.Html.GetText(this.getPaneChildElement("visualizationDescription")).trim();if(!isNullOrEmptyString($v_2))$v_0.alt=String.format($v_1,$v_2);else $v_0.alt=String.format($v_1,this.get_chartNameInputValue())}},swapLabelsIfRequired:function(oldChartTypeGroup){if(this.get_seriesCount()>1)return;var $v_0=this.$9_3==="Bar"&&oldChartTypeGroup!=="Bar"||this.$9_3!=="Bar"&&oldChartTypeGroup==="Bar";if(!$v_0)return;var $v_1=this._currentCategoryAxisLabel,$v_2=this._currentCategoryAxisLabel.innerHTML,$v_3=this._currentSeriesAxisLabel.innerHTML;this._currentCategoryAxisLabel=this._currentSeriesAxisLabel;this._currentCategoryAxisLabel.innerHTML=$v_2;this._currentCategoryAxisLabel.setAttribute("title",$v_2);this._currentSeriesAxisLabel=$v_1;this._currentSeriesAxisLabel.innerHTML=$v_3;this._currentSeriesAxisLabel.setAttribute("title",$v_3)},setFocus:function(control){try{control.focus()}catch($$e_1){}},$2e_3:function(){var $v_0="",$v_1=0,$$dict_2=this.$2_3;for(var $$key_3 in $$dict_2){var $v_2={key:$$key_3,value:$$dict_2[$$key_3]};if($v_1<2){var $v_3=this.getSelectedPicklistText(Mscrm.VisualizationPane.$0("yAttributeSelector",$v_2.key)),$v_4="";if($v_0.length<=0)$v_4=String.format(window.LOCID_VPD_SERIESNAMETEMPLATE,$v_3);else $v_4=String.format(window.LOCID_VPD_MULSERIESNAMETEMPLATE,$v_0,$v_3);if($v_4.length<=60)$v_0=$v_4;else{$v_0=String.format(window.LOCID_VPD_ELLIPSISNAMETEMPLATE,$v_0);break}++$v_1}else{$v_0=String.format(window.LOCID_VPD_ELLIPSISNAMETEMPLATE,$v_0);break}}return $v_0},$2d_3:function($p0){var $v_0=$p0.length,$v_1="",$$dict_3=this.$4_3;for(var $$key_4 in $$dict_3){var $v_2={key:$$key_4,value:$$dict_3[$$key_4]},$v_3=this.getSelectedPicklistText(Mscrm.VisualizationPane.$0("xAttributeSelector",$v_2.key)),$v_4="";if($v_1.length<=0)$v_4=String.format(window.LOCID_VPD_CATEGORYNAMETEMPLATE,$v_3);else $v_4=String.format(window.LOCID_VPD_MULCATEGRYNAMETEMPLATE,$v_1,$v_3);if($v_4.length+$v_0<=95)$v_1=$v_4;else{$v_1=String.format(window.LOCID_VPD_ELLIPSISNAMETEMPLATE,$v_1);break}}return $v_1},get_chartNameInput:function(){return this.getPaneChildElement(this._gridId+"_paneControl_chartNameInput")},get_chartNameInputValue:function(){var $v_0=this.get_chartNameInput().value;return $v_0},get_$2X_3:function(){IsNull(this.$i_3)&&this.$2B_3();return this.$i_3},$1V_3:function(){var $v_0=false;if(Sys.Browser.version>=8&&!Mscrm.Utilities.isIosDevice())$v_0=true;return $v_0},setChartName:function(){var $v_0,$v_1,$v_2=this.$2e_3(),$v_3=this.$2d_3($v_2);if(this.$j_3){var $v_5=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch",null),$v_6=$v_5.attributes.getNamedItem("count");$v_0=this.$16_3?window.LOCID_VPD_NAMETEMPLATEWITHTOP:window.LOCID_VPD_NAMETEMPLATEWITHBOTTOM;$v_1=String.format($v_0,$v_6.value,$v_2,$v_3)}else{$v_0=window.LOCID_VPD_NAMETEMPLATE;$v_1=String.format($v_0,$v_2,$v_3)}var $v_4=this.get_chartNameInput();if(!IsNull($v_4))$v_4.value=$v_1;this.get_$2X_3().toggleHintVisibility(false)},generateSeriesLabel:function(seriesNumber){var $v_0="",$v_1=this.getSelectedPicklistText(Mscrm.VisualizationPane.$0("yAttributeSelector",seriesNumber.toString())),$v_2=window.LOCID_VPD_AXISTITLE,$v_3=this.getSelectedPicklistText(Mscrm.VisualizationPane.$0("yAggregateSelector",seriesNumber.toString()));$v_0=String.format($v_2,$v_3,$v_1);return $v_0},updateLabel:function(label,value){if(!IsNull(label)){label.innerHTML=CrmEncodeDecode.CrmHtmlEncode(value);label.setAttribute("title",value)}},getChartGroup:function(chartType){var $v_0="Incompatible",$v_1=this.$3_3[chartType];if(!IsNull($v_1))$v_0=$v_1.$15_0;else $v_0="Incompatible";return $v_0},setAggregateList:function(fireOnChangeEvent,seriesNumber){var $v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAttributeSelector",seriesNumber.toString())),$v_1=$v_0.options[$v_0.selectedIndex].getAttribute("type");if(!this.isNumericType($v_1))this.disableNumericAggregates(fireOnChangeEvent,seriesNumber);else this.enableAllAggregates(fireOnChangeEvent,seriesNumber);var $v_2=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAggregateSelector",seriesNumber.toString()));if($v_2)$v_2.disabled=this._isComplexChart},enableAllAggregates:function(fireOnChangeEvent,seriesNumber){var $v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAggregateSelector",seriesNumber.toString()));if(this.$1V_3())for(var $v_1=0;$v_1<$v_0.options.length;$v_1++)$v_0.options[$v_1].disabled=false;else if(!isNullOrEmptyString(this.allAggregateHtml)){this.updateAggregateSelector($v_0.id,true);$v_0=this.getPaneChildElement(Mscrm.VisualizationPane.$0("yAggregateSelector",seriesNumber.toString()))}if(fireOnChangeEvent){$v_0.value="sum";this.onYAggregateChange($v_0)}},disableNumericAggregates:function(fireOnChangeEvent,seriesNumber){var $v_0=Mscrm.VisualizationPane.$0("yAggregateSelector",seriesNumber.toString()),$v_1=this.getPaneChildElement($v_0);if(this.$1V_3()){for(var $v_2=0;$v_2<$v_1.options.length;$v_2++)if(!this.isAggregateValidForNonNumericTypes($v_1.options[$v_2].getAttribute("value")))$v_1.options[$v_2].disabled=true}else if(isNullOrEmptyString(this.countAggregateHtml)){for(var $v_3=0;$v_3<$v_1.options.length;$v_3++)if(!this.isAggregateValidForNonNumericTypes($v_1.options[$v_3].getAttribute("value"))){$v_1.remove($v_3);$v_3--}this.saveAggregateHtml($v_1,false)}else{this.updateAggregateSelector($v_1.id,false);$v_1=this.getPaneChildElement($v_0)}if(fireOnChangeEvent){$v_1.value="count";this.onYAggregateChange($v_1)}},isAggregateValidForNonNumericTypes:function(aggregateType){switch(aggregateType){case "count":case "countcolumn":case "none":return true;default:return false}},isNumericType:function(attributeType){switch(attributeType){case "money":case "int":case "float":case "decimal":return true;default:return false}},generateDataXml:function(){return XUI.Xml.XMLSerializer.serializeToString(this._currentDataXml)},getSelectedPicklistValue:function(selectControlId){var $v_0=this.getPaneChildElement(selectControlId);return $v_0.value},getSelectedPicklistText:function(selectControlId){var $v_0=this.getPaneChildElement(selectControlId);return XUI.Html.GetText($v_0.options[$v_0.selectedIndex])},getSeriesIndex:function(seriesId){for(var $v_0=0,$v_1=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/Series",null),$$arr_3=$v_1.childNodes,$$len_4=$$arr_3.length,$$idx_5=0;$$idx_5<$$len_4;++$$idx_5){var $v_2=$$arr_3[$$idx_5];if($v_2===this.$2_3[seriesId].$7_1)return $v_0;$v_0++}return -1},getChartTypeString:function(seriesId){var $v_0="column",$v_1=this.$2_3[seriesId];if(!IsNull($v_1)){var $v_2=$v_1.$7_1;if(!IsNull($v_2)){var $v_3=$v_2.attributes.getNamedItem("ChartType");if(!IsNull($v_3))$v_0=$v_3.nodeValue}}return $v_0.toLowerCase()},areRequiredInputsPresent:function(checkName){var $v_0=this.$21_3();if(checkName)$v_0=$v_0&&!isNullOrEmptyString(this.get_chartNameInputValue());return $v_0},loadPreview:function(){var $v_0=this.getPaneChildElement("previewFrameCell");if(!IsNull($v_0)){if(IsNull(this.getPaneChildElement("previewIframe"))){var $v_1=this.getPreviewIFrame();$v_0.appendChild($v_1);if(!IsNull($v_1.contentWindow))$v_1.contentWindow.name=$v_1.id}this.getPaneChildElement("staticImageTable").style.display="none";$v_0.style.display="none";this.getPaneChildElement("loadingImageTable").style.display="";this.delayedLoadVisualization()}},delayedLoadVisualization:function(){window.clearInterval(Mscrm.VisualizationPane.timeOutID);Mscrm.VisualizationPane.timeOutID=window.setTimeout(this.$$d_$2q_3,Mscrm.VisualizationPane.currentVizLoadDelay)},selectorOnMouseDown:function(){Mscrm.VisualizationPane.currentVizLoadDelay=0},selectorOnKeyDown:function(){Mscrm.VisualizationPane.currentVizLoadDelay=Mscrm.VisualizationPane.vizLoadDelayMS},$2q_3:function(){this.loadVisualization(false)},getPreviewIFrame:function(){var $v_0=document.createElement("iframe");$v_0.id="previewIframe";$v_0.setAttribute("name","previewIframe");$v_0.src="";$v_0.scrolling="auto";$v_0.style.height="99%";$v_0.style.width="100%";$v_0.style.overflow="hidden";$v_0.frameBorder="0";return $v_0},generatePresentationXml:function(){if(!IsNull(this._currentPresentationXml))return XUI.Xml.XMLSerializer.serializeToString(this._currentPresentationXml);return ""},disableEmptyMessageLabels:function(contentSpan){this.hideVizList();contentSpan.style.display="none";this.get_noVisualizations().style.display="none";this.get_loadingSpan().style.display="inline"},showContentSpan:function(contentSpan){contentSpan.style.display="block";this.get_loadingSpan().style.display="none"},updateStaticImages:function(){var $v_0=this.getPaneChildElement("topImg"),$v_1=this.getPaneChildElement("bottomImg");XUI.Html.SetOpacity($v_0,.3);XUI.Html.SetOpacity($v_1,.3);this.$22_3()&&this.showSelectedAxis(true,true,false);this.$23_3()&&this.showSelectedAxis(false,true,false);var $v_2=this.$3_3[this.getChartTypeString(this.get_firstSeriesId())];if(!IsNull($v_2)){var $v_3=$v_2;if(!isNullOrEmptyString($v_3.$1R_0))$v_0.src=$v_3.$1R_0;if(!isNullOrEmptyString($v_3.$1I_0))$v_1.src=$v_3.$1I_0;if($v_3.$1H_0==="none"||$v_1.style.display==="none")$v_1.style.display=$v_3.$1H_0;if(!isNullOrEmptyString($v_3.$1Q_0))$v_0.style.position=$v_3.$1Q_0}},showSelectedAxis:function(isX,isImageToBeUpdated,showAnimation){var $v_0=this.$3_3[this.getChartTypeString(this.get_firstSeriesId())];if(!IsNull($v_0)){var $v_1=$v_0.$15_0;switch($v_1){case "LineColumnArea":this.reflectSelection(!isX,isImageToBeUpdated,showAnimation);break;case "Bar":this.reflectSelection(isX,isImageToBeUpdated,showAnimation);break;case "Incompatible":this.reflectSelection(true,isImageToBeUpdated,showAnimation);break}}},reflectSelection:function(isTopImg,isImageToBeUpdated,showAnimation){var $v_0=isTopImg?"topImg":"bottomImg",$v_1=this.getPaneChildElement($v_0),$v_2=this._gridId+"_paneControl";if(!IsNull($v_1)){if(!showAnimation){XUI.Html.SetOpacity($v_1,1);return}var $v_3=-1;if(!isImageToBeUpdated){this.clearFading(isTopImg);$v_3=window.setInterval("$find('"+$v_2+"').fadeOutStaticImg("+isTopImg.toString()+")",2);this.setFadeIntervalId(isTopImg,$v_3)}else{this.clearFading(isTopImg);$v_3=window.setInterval("$find('"+$v_2+"').fadeInStaticImg("+isTopImg.toString()+")",5);this.setFadeIntervalId(isTopImg,$v_3)}}},clearFading:function(isTopImg){switch(isTopImg){case true:if(this.topImgFadeIntervalId!==-1){window.clearInterval(this.topImgFadeIntervalId);this.topImgFadeIntervalId=-1}break;case false:if(this.bottomImgFadeIntervalId!==-1){window.clearInterval(this.bottomImgFadeIntervalId);this.bottomImgFadeIntervalId=-1}break}},setFadeIntervalId:function(isTopImg,fadingIntervalId){if(isTopImg)this.topImgFadeIntervalId=fadingIntervalId;else this.bottomImgFadeIntervalId=fadingIntervalId},setGroupByInDataXml:function(newGroupBy,seriesNumber){this.modifyDataXmlAttribute(true,newGroupBy,seriesNumber,false);this.markChartNodeReadyForUse(true,seriesNumber)},setYAttributeInDataXml:function(newYAttribute,seriesNumber){this.modifyDataXmlAttribute(false,newYAttribute,seriesNumber,false);this.markChartNodeReadyForUse(false,seriesNumber)},modifyDataXmlAttribute:function(isCategory,attributeName,number,remove){var $v_0=isCategory?this.$4_3[number.toString()]:this.$2_3[number.toString()],$v_1=$v_0.$G_0,$v_2=$v_0.$M_0,$v_3=$v_1.parentNode,$v_4=this.get_$1W_3(),$v_5=XUI.Xml.SelectSingleNode($v_3,"//order[@alias='"+$v_2+"']",null),$v_6=-1;if(this.$j_3&&!IsNull($v_4)&&!IsNull($v_5)&&$v_4===$v_5){var $v_9=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch",null).attributes.getNamedItem("count").nodeValue;$v_6=parseInt($v_9,10);this.$1m_3();this.$1X_3(this.$V_3,Mscrm.VisualizationPane.INVALIDINDEX.toString(),false,-1);this.$1r_3()}!remove&&this.addAttribute($v_0,attributeName,$v_1);$v_3.removeChild($v_1);if(!IsNull($v_5)&&!IsNull($v_5.parentNode)){var $v_A=XUI.Xml.GetText(XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity/attribute[@name='"+attributeName+"']",null).attributes.getNamedItem("alias"));if(!isNullOrEmptyString($v_A)){var $v_B=this._currentDataXml.createAttribute("alias");$v_B.value=$v_A;$v_5.attributes.setNamedItem($v_B)}else $v_3.removeChild($v_5)}if(!remove)if($v_6!==-1&&this.$2G_3($v_0)){var $v_C=this.$H_3;this.$H_3=number.toString();var $v_D=Boolean.parse($v_5.attributes.getNamedItem("descending").value);this.appendTopBottom($v_6.toString(),$v_D,true,false);this.$H_3=$v_C}var $v_7=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null),$v_8=XUI.Xml.SelectNodes($v_7,"//order",null);if(!$v_8.length)!IsNull($v_7.parentNode)&&!IsNull($v_7.parentNode.attributes.getNamedItem("count"))&&$v_7.parentNode.attributes.removeNamedItem("count");!$v_3.childNodes.length&&!IsNull($v_3.parentNode)&&$v_3.parentNode.removeChild($v_3)},addAttribute:function(chartNode,attributeName,referenceNode){var $v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null),$v_1=chartNode.$G_0,$v_2=$v_1.cloneNode(true),$v_3=null;if(attributeName.indexOf(";")>-1){var $v_5=attributeName.split(";"),$v_6=XUI.Xml.SelectSingleNode($v_0,"link-entity[@name='"+$v_5[1]+"' and @from='"+$v_5[3]+"' and @to='"+$v_5[2]+"']",null);if(IsNull($v_6)){$v_3=this._currentDataXml.createElement("link-entity");var $v_7=this._currentDataXml.createAttribute("name");$v_7.value=$v_5[1];$v_3.attributes.setNamedItem($v_7);var $v_8=this._currentDataXml.createAttribute("from");$v_8.value=$v_5[3];$v_3.attributes.setNamedItem($v_8);var $v_9=this._currentDataXml.createAttribute("to");$v_9.value=$v_5[2];$v_3.attributes.setNamedItem($v_9);var $v_A=this._currentDataXml.createAttribute("link-type");$v_A.value="outer";$v_3.attributes.setNamedItem($v_A);if(referenceNode.parentNode===$v_0)$v_0.insertBefore($v_3,referenceNode);else $v_0.insertBefore($v_3,!IsNull(referenceNode)?referenceNode.parentNode:null)}else $v_3=$v_6;attributeName=$v_5[0]}else $v_3=$v_0;var $v_4=this._currentDataXml.createAttribute("name");$v_4.value=attributeName;$v_2.attributes.setNamedItem($v_4);if(referenceNode.parentNode===$v_3)$v_3.insertBefore($v_2,referenceNode);else if($v_3===$v_0)$v_3.insertBefore($v_2,!IsNull(referenceNode)?referenceNode.parentNode:null);else $v_3.appendChild($v_2);chartNode.$G_0=$v_2},setAggregateInDataXml:function(newAggregate,seriesNumber){var $v_0=this._currentDataXml.createAttribute("aggregate");$v_0.value=newAggregate;this.$2_3[seriesNumber.toString()].$G_0.attributes.setNamedItem($v_0)},setDateGroupingInDataXml:function(dateGrouping,remove,seriesNumber){var $v_0=this.$4_3[seriesNumber.toString()].$G_0;if(remove&&!IsNull($v_0.attributes.getNamedItem("dategrouping")))$v_0.attributes.removeNamedItem("dategrouping");else if(!remove){var $v_1=this._currentDataXml.createAttribute("dategrouping");if(dateGrouping==="fiscalperiod")$v_1.value="fiscal-period";else if(dateGrouping==="fiscalyear")$v_1.value="fiscal-year";else $v_1.value=dateGrouping;$v_0.attributes.setNamedItem($v_1)}},populateChartNodeItemsDictionaryAndCreateHtml:function(){this.$2_3={};this.$4_3={};try{this.$W_3=true;this.populateSeriesDictionaryAndHtml();this.populateCategoryDictionaryAndHtml()}finally{this.$W_3=false}},populateSeriesDictionaryAndHtml:function(){if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)for(var $v_0=XUI.Xml.SelectNodes(this._currentDataXml,"datadefinition/categorycollection/category/measurecollection",null),$v_1=XUI.Xml.SelectNodes(this._currentPresentationXml,"Chart/Series/Series",null),$v_2=$v_0.length,$v_3=0;$v_3<$v_2;++$v_3){var $v_4=XUI.Xml.SelectSingleNode($v_0[$v_3],"measure",null),$v_5=XUI.Xml.GetText($v_4.attributes.getNamedItem("alias")),$v_6=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity//attribute[@alias='"+$v_5+"']",null),$v_7=new Mscrm.YChartNodeItem($v_6,$v_5,$v_4,$v_1[$v_3],false);this.$1G_3(false);this.$2_3[this.$1_3.toString()]=$v_7;if(!this.$1B_3&&$v_6)this.$1B_3=$v_6.cloneNode(true);this.onAddNewY($v_3);this.updateTopBottomInfo($v_5,this.$1_3.toString())}else{var $v_8="_CRMAutoGen_aggregate_column_Num_"+0,$v_9=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity//attribute[@alias='"+$v_8+"']",null),$v_A=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/Series/Series",null),$v_B=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/categorycollection/category/measurecollection/measure",null),$v_C=new Mscrm.YChartNodeItem($v_9,$v_8,$v_B,$v_A,true);this.$1G_3(false);this.$2_3[this.$1_3.toString()]=$v_C;if($v_9)this.$1B_3=$v_9.cloneNode(true);this.onAddNewY(Mscrm.VisualizationPane.INVALIDINDEX)}},populateCategoryDictionaryAndHtml:function(){var $v_0=this.getParameter("xAliasOrdered"),$v_1=$v_0.split("#"),$v_2=this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode;if($v_1.length>0)for(var $v_3=0;$v_3<$v_1.length;++$v_3){var $v_4=$v_1[$v_3];if(isNullOrEmptyString($v_4))continue;var $v_5=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity//attribute[@alias='"+$v_4+"']",null);if(!this.$1T_3)this.$1T_3=$v_5.cloneNode(true);var $v_6=new Mscrm.ChartNodeItem($v_5,$v_4,!$v_2);this.$1G_3(true);this.$4_3[this.$1_3.toString()]=$v_6;this.onAddNewX($v_2?$v_3:Mscrm.VisualizationPane.INVALIDINDEX)}else{var $v_7=this.getPaneChildElement("xSelectionList");if($v_7)$v_7.style.visibility="hidden"}},saveAggregateHtml:function(selectElement,numericType){var $v_0=selectElement.id;selectElement.id="temporarySelectId";if(numericType)this.allAggregateHtml=selectElement.parentNode.innerHTML;else this.countAggregateHtml=selectElement.parentNode.innerHTML;selectElement.id=$v_0},updateAggregateSelector:function(selectorId,numericType){var $v_0=this.getPaneChildElement(selectorId);$v_0.parentNode.innerHTML=numericType?this.allAggregateHtml:this.countAggregateHtml;var $v_1=$get("temporarySelectId");$v_1.id=selectorId;var $$t_5=this;$addHandler($v_1,"change",function($p1_0){$$t_5.onYAggregateChange($p1_0.target)})},initializeRowTemplates:function(){this.$1C_3=this.getParameter("YRowHTMLTemplate");this.$1U_3=this.getParameter("XRowHTMLTemplate");this.$2i_3()},$2i_3:function(){if(!this.$1V_3()){var $v_0=document.createElement("div");$v_0.innerHTML=this.$1C_3;var $v_1=$get(Mscrm.VisualizationPane.$0("yAggregateSelector","0"),$v_0);$v_1&&this.saveAggregateHtml($v_1,true)}this.countAggregateHtml=""},initializeDesignerMode:function(){this.setPropertiesForChartTypes();this.initializeRowTemplates();if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)this.initializeDesignerNewMode();else this.initializeDesignerEditMode();this.$A_3=false;this.populateChartNodeItemsDictionaryAndCreateHtml();this.$8_3=this.get_firstSeriesId();this.$9_3=this.getChartGroup(this.getChartTypeString(this.get_firstSeriesId()));this.$9_3==="Incompatible"&&Mscrm.VisualizationPane.enableDisableAddButtons(false);this.initializeAxisLabels();this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&this.loadPreview();this.$k_3=this.$$d_$2g_3;$addHandler(document,"keydown",this.$k_3);this.get_isSystemDesigner()&&attachWindowOnBeforeUnload(this.$$d_handleWindowBeforeUnload,window);this.$2S_3();this.$2T_3();this.$2j_3();refreshRibbon();var $v_0=window.top.$find("crmRibbonManager");$v_0&&$v_0.setChartDesignerCommandBar($get("chartDesignerCommandBar",this.get_element()))},$2j_3:function(){this.$2B_3();this.$2k_3();this.$2l_3()},$2B_3:function(){var $v_0=this.get_chartNameInput();if(!IsNull($v_0))this.$i_3=$create(Mscrm.HintText,null,null,null,$v_0)},$2k_3:function(){var $v_0=this.get_chartNameInput();if(!IsNull($v_0))this.$1P_3=$create(Mscrm.FormInputControl.TextBoxInputBehavior,null,null,null,$v_0)},$2l_3:function(){var $v_0=this.getPaneChildElement("visualizationDescription");if(!IsNull($v_0))this.$1J_3=$create(Mscrm.FormInputControl.TextAreaInputBehavior,null,null,null,$v_0)},initializeDesignerNewMode:function(){var $v_0="",$v_1="";this._currentPresentationXml=XUI.Xml.LoadXml('<Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series></Series><ChartAreas><ChartArea BorderColor="White" BorderDashStyle="Solid"><AxisY LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorGrid LineColor="239, 242, 246" /><MajorTickMark LineColor="165, 172, 181" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisY><AxisX LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorTickMark LineColor="165, 172, 181" /><MajorGrid LineColor="Transparent" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisX></ChartArea></ChartAreas><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="59, 59, 59"></Title></Titles></Chart>');$v_0=window.LOCID_VPD_INLINEMSG_ONLOAD;this._isComplexChart=false;var $v_2="_CRMAutoGen_groupby_column_Num_"+0,$v_3="_CRMAutoGen_aggregate_column_Num_"+0;this.setParameter("xAliasOrdered",$v_2);var $v_4=String.format("<datadefinition><fetchcollection><fetch mapping='logical' aggregate='true'><entity name='entity_placeholder'><attribute name='x_placeholder' groupby='true' alias='{0}'/><attribute name='y_placeholder' aggregate='count' alias='{1}'/></entity></fetch></fetchcollection><categorycollection><category><measurecollection><measure alias='{1}'/></measurecollection></category></categorycollection></datadefinition>",$v_2,$v_3);this._currentDataXml=XUI.Xml.LoadXml($v_4);var $v_5=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null),$v_6=this._currentDataXml.createAttribute("name");$v_6.value=this.getParameter("vizPanePrimaryEntityName");$v_5.attributes.setNamedItem($v_6);this.autoFillTitle=true;this.updateFooterMessage($v_0);this.updateWindowTitle($v_1)},initializeDesignerEditMode:function(){var $v_0="",$v_1=this.get_chartNameInputValue();this._isComplexChart=Boolean.parse(this.getParameter("isComplexChart"));if(this._isComplexChart)$v_0=String.format(window.LOCID_VPD_COMPLEXCHART,$v_1);var $v_2=this.getParameter("currentDataXml");this._currentDataXml=XUI.Xml.LoadXml($v_2);var $v_3=this.getParameter("currentPresentationXml");this._currentPresentationXml=XUI.Xml.LoadXml($v_3);var $v_4=this.getParameter("ySelectedParams");if($v_4)this.$1k_3=$v_4.split("#");var $v_5=this.getParameter("xSelectedParams");if($v_5)this.$1i_3=$v_5.split("#");var $v_6=this.getParameter("yAggrParams");if($v_6)this.$1j_3=$v_6.split("#");var $v_7=this.getParameter("xAggrParams");if($v_7)this.$1h_3=$v_7.split("#");Array.clear(this.$1S_3);var $v_8=this.getParameter("usedAliasInDataDescription");if($v_8)for(var $v_9=$v_8.split("#"),$v_A=0;$v_A<$v_9.length;++$v_A)Array.add(this.$1S_3,$v_9[$v_A]);this.autoFillTitle=false;this.updateFooterMessage($v_0);this.updateWindowTitle($v_1)},initializeAxisLabels:function(){var $v_0="topLeftLabel";if(window.LOCID_UI_DIR==="RTL")$v_0="topRightLabel";this._currentSeriesAxisLabel=this.getPaneChildElement($v_0);this._currentCategoryAxisLabel=this.getPaneChildElement("bottomLabel");this.swapLabelsIfRequired("")},isDesignerSupportedChartType:function(){return this.$3_3[this.getChartTypeString(this.get_firstSeriesId())]?true:false},clearContentSpan:function(contentSpan){var $v_0=this.$1F_3();!IsNull($v_0)&&$clearHandlers($v_0.contentWindow);contentSpan.innerHTML=""},setPropertiesForChartTypes:function(){this.$3_3["column"]=new Mscrm.ChartType("column","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/colchart01.gif","/_imgs/Visualization/colchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("column"),window.LOCID_COLUMN_CHART);this.$3_3["stackedcolumn"]=new Mscrm.ChartType("stackedcolumn","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedColumn" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/colchart01.gif","/_imgs/Visualization/colchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("column"),window.LOCID_STACKEDCOLUMN_CHART);this.$3_3["stackedcolumn100"]=new Mscrm.ChartType("stackedcolumn100","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedColumn100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/colchart01.gif","/_imgs/Visualization/colchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("column"),window.LOCID_STACKEDCOLUMN100_CHART);this.$3_3["bar"]=new Mscrm.ChartType("bar","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="Bar" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>',"Bar","/_imgs/Visualization/barchart01.gif","/_imgs/Visualization/barchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("bar"),window.LOCID_BAR_CHART);this.$3_3["stackedbar"]=new Mscrm.ChartType("stackedbar","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedBar" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>',"Bar","/_imgs/Visualization/barchart01.gif","/_imgs/Visualization/barchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("bar"),window.LOCID_STACKEDBAR_CHART);this.$3_3["stackedbar100"]=new Mscrm.ChartType("stackedbar100","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedBar100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>',"Bar","/_imgs/Visualization/barchart01.gif","/_imgs/Visualization/barchart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("bar"),window.LOCID_STACKEDBAR100_CHART);this.$3_3["area"]=new Mscrm.ChartType("area","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="Area" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/areachart01.gif","/_imgs/Visualization/areachart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("area"),window.LOCID_AREA_CHART);this.$3_3["stackedarea"]=new Mscrm.ChartType("stackedarea","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedArea" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/areachart01.gif","/_imgs/Visualization/areachart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("area"),window.LOCID_STACKEDAREA_CHART);this.$3_3["stackedarea100"]=new Mscrm.ChartType("stackedarea100","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="StackedArea100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>',"LineColumnArea","/_imgs/Visualization/areachart01.gif","/_imgs/Visualization/areachart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("area"),window.LOCID_STACKEDAREA100_CHART);this.$3_3["line"]=new Mscrm.ChartType("line","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",'<Series ChartType="Line" IsValueShownAsLabel="True" BorderWidth="3" MarkerStyle="Square" MarkerSize="9" MarkerColor="37, 128, 153" MarkerBorderColor="37, 128, 153"></Series>',"LineColumnArea","/_imgs/Visualization/linechart01.gif","/_imgs/Visualization/linechart02.gif","inline","absolute",Mscrm.VisualizationPane.$D("line"),window.LOCID_LINE_CHART);this.$3_3["pie"]=new Mscrm.ChartType("pie","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",null,"Incompatible","/_imgs/Visualization/piechart01.gif","","none","relative",Mscrm.VisualizationPane.$D("pie"),window.LOCID_PIE_CHART);this.$3_3["funnel"]=new Mscrm.ChartType("funnel","91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;",null,"Incompatible","/_imgs/Visualization/funnelchart01.gif","","none","relative",Mscrm.VisualizationPane.$D("funnel"),window.LOCID_FUNNEL_CHART)},$2S_3:function(){var $v_0=$get("chartTypeBox");if(!IsNull($v_0))for(var $v_1=$v_0.getElementsByTagName("img"),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2],$v_4=Mscrm.VisualizationPane.$1o($v_3);switch($v_4){case "column":case "bar":case "area":var $v_5=String.format("{0}MenuXML",$v_4),$v_6={};$v_6["menuXml"]=this.getParameter($v_5);Mscrm.CrmUIComponent.crmCreate(Mscrm.ChartTypePopup,$v_6,null,null,$v_3.parentNode);break;default:break}}},$2T_3:function(){var $v_0=$get("topBottomBox");if(!IsNull($v_0))for(var $v_1=$v_0.getElementsByTagName("img"),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2],$v_4=Mscrm.VisualizationPane.$29($v_3);switch($v_4){case "top":case "bottom":var $v_5=String.format("{0}MenuXML",$v_4),$v_6={};$v_6["menuXml"]=this.getParameter($v_5);Mscrm.CrmUIComponent.crmCreate(Mscrm.TopBottomPopup,$v_6,null,null,$v_3.parentNode);break;default:break}}},get_drillDownParamObj:function(){if(IsNull(this.$1K_3))this.$1K_3=new Mscrm.DrillDownParameter;return this.$1K_3},set_drillDownParamObj:function(value){this.$1K_3=value;return value},get_multiLevelDrillDownParametersBackup:function(){if(IsNull(this.$1L_3))this.$1L_3=new Mscrm.MultiLevelDrillDownParameters;return this.$1L_3},get_navigateBack:function(){return this.$p_3},set_navigateBack:function(value){this.$p_3=value;return value},get_navigateToHomeChart:function(){return this.$1M_3},set_navigateToHomeChart:function(value){this.$1M_3=value;return value},checkIfDrilldownMode:function(){return !IsNull(this.getParameter("isDrillDownMode"))&&Boolean.parse(this.getParameter("isDrillDownMode"))},getFilterSetControl:function(){return $find(this._gridId+"_filterSet")},refreshGridAndLoadVisualizationOnBack:function(isHomeChart){this.handleBackButton(true);var $v_0=!IsNull(this.get_paneGridControl());if($v_0)this.$h_3=1;if(!isHomeChart){this.$p_3=true;if($v_0){this.$F_3=false;var $$t_5=this;window.setTimeout(function(){$$t_5.removeGridFilters(null,true)},0)}}else{var $v_1=window.document,$v_2=this.getPaneChildElement("contentSpan");this.get_noVisualizations().style.display="none";this.get_loadingSpan().style.display="inline";$v_2.style.display="none";var $v_3=this.getPaneChildElement("vizForm");!IsNull($v_3)&&$v_2.removeChild($v_3);if($v_0){this.removeGridFilters(null,true);this.loadVisualizationWhenGridIsHidden()}}(!isHomeChart||!$v_0)&&this.loadVisualizationAsync(!isHomeChart)},refreshGridOnColumnSelection:function(drillDownParams){if(!IsNull(this.get_paneGridControl())){this.$F_3=false;this.$1D_3(true,drillDownParams)}},refreshGridOnCancel:function(drillDownParams,isGridRefreshRequired,isChartRefreshRequired){if(!IsNull(this.get_paneGridControl())){this.handleBackButton(true);if(isGridRefreshRequired){this.$h_3=2;if(!isChartRefreshRequired)this.$F_3=false}this.removeGridFilters(drillDownParams,isGridRefreshRequired)}},handleBackButton:function(isToBeDisabled){var $v_0=this.getPaneChildElement("vizIframe");if(!IsNull($v_0)){this.enableDisableBackHomeButton("btnBack",isToBeDisabled,$v_0);this.enableDisableBackHomeButton("btnBackTop",isToBeDisabled,$v_0);this.enableDisableBackHomeButton("btnHome",isToBeDisabled,$v_0);this.enableDisableBackHomeButton("btnHomeTop",isToBeDisabled,$v_0)}},enableDisableBackHomeButton:function(id,disable,vizIframeElement){var $v_0=vizIframeElement.contentWindow.document.getElementById(id);if(!IsNull($v_0)&&$v_0.disabled!==disable)if(disable){$v_0.className="ms-crm-DrillDown-back-disabled";$v_0.setAttribute("disabled","disabled");$v_0.tabIndex=-1;if(!IsNull(XUI.Html.DomUtils.GetFirstChild($v_0))&&XUI.Html.DomUtils.GetFirstChild($v_0).nodeName==="IMG")if(id==="btnBack")XUI.Html.DomUtils.GetFirstChild($v_0).className="ms-crm-DrillDown-back-imageDisabled flipImage";else XUI.Html.DomUtils.GetFirstChild($v_0).className="ms-crm-DrillDown-back-imageDisabled"}else{$v_0.className="ms-crm-DrillDown-back-Link";$v_0.removeAttribute("disabled");$v_0.tabIndex=0;if(!IsNull(XUI.Html.DomUtils.GetFirstChild($v_0))&&XUI.Html.DomUtils.GetFirstChild($v_0).nodeName==="IMG")if(id==="btnBack")XUI.Html.DomUtils.GetFirstChild($v_0).className="ms-crm-DrillDown-back-imageEnabled flipImage";else XUI.Html.DomUtils.GetFirstChild($v_0).className="ms-crm-DrillDown-back-imageEnabled"}},addDrillDownSpecificParameterOnLoadVisualization:function(isDrilldown){if(!IsNull(isDrilldown)&&isDrilldown){this.setParameter("isDrillDownMode","true");this.addSubmitParameters("viewBy",this.get_drillDownParamObj().$w_0);this.addSubmitParameters("isDrilldown","true");this.addSubmitParameters("chartType",this.get_drillDownParamObj().$e_0);this.addSubmitParameters("x1Value",this.get_drillDownParamObj().$a_0);this.addSubmitParameters("x2Value",this.get_drillDownParamObj().$b_0);this.addSubmitParameters("primaryGroupByAlias",this.get_drillDownParamObj().$18_0);this.addSubmitParameters("secondaryGroupByAlias",this.get_drillDownParamObj().$1A_0);this.addSubmitParameters("formattedXValue",this.get_drillDownParamObj().$U_0);!IsNull(this.get_drillDownParamObj().$N_0)&&this.addSubmitParameters("formattedX2Value",this.get_drillDownParamObj().$N_0);this.addSubmitParameters("seriesIndex",this.get_drillDownParamObj().$v_0);this.addSubmitParameters("yColumnName",this.get_drillDownParamObj().$10_0);this.addSubmitParameters("aggregationFetchXml",this.get_drillDownParamObj().$d_0,true);this.addSubmitParameters("filterFetchXml",this.get_drillDownParamObj().$g_0,true);!isNullOrEmptyString(this.get_drillDownParamObj().$T_0)&&this.addSubmitParameters("drillDownChartTitle",this.get_drillDownParamObj().$T_0);this.addSubmitParameters("alreadyViewByAttr",this.getParameter("alreadyViewByAttribute"));!isNullOrEmptyString(this.get_drillDownParamObj().$P_0)&&this.addSubmitParameters("primaryGroupByStartDate",this.get_drillDownParamObj().$P_0);!isNullOrEmptyString(this.get_drillDownParamObj().$O_0)&&this.addSubmitParameters("primaryGroupByEndDate",this.get_drillDownParamObj().$O_0);!isNullOrEmptyString(this.get_drillDownParamObj().$R_0)&&this.addSubmitParameters("secondaryGroupByStartDate",this.get_drillDownParamObj().$R_0);!isNullOrEmptyString(this.get_drillDownParamObj().$Q_0)&&this.addSubmitParameters("secondaryGroupByEndDate",this.get_drillDownParamObj().$Q_0);this.$p_3&&this.addSubmitParameters("backNavigation","true")}else{this.setParameter("isDrillDownMode","false");var $v_1=this.getFilterSetControl();!IsNull($v_1)&&$v_1.clearAllFiltersBackup()}var $v_0=$find(this._gridId);if(!IsNull($v_0)){var $v_2=$v_0.GetParameter("fetchXmlForFilters");if(!isNullOrEmptyString($v_2)&&!isNullOrEmptyString(this.getParameter("enableDrillDown")))this.addSubmitParameters("enableDrillDown",this.getParameter("enableDrillDown"));else(isNullOrEmptyString($v_2)||this.isQuickFindQuery(this.getParameter("vizPaneViewId"),true))&&this.addSubmitParameters("enableDrillDown","false")}},clearDrilldownBackup:function(isDrilldown){if(!isDrilldown)this.$1L_3=null;else if(this.$p_3){this.set_drillDownParamObj(this.get_multiLevelDrillDownParametersBackup().getAtIndex(this.get_multiLevelDrillDownParametersBackup().$6_0-1).clone());this.get_multiLevelDrillDownParametersBackup().remove()}},removeGridFilters:function(drillDownParams,isGridRefreshRequired){if(!IsNull(drillDownParams))this.$1D_3(false,drillDownParams);else if(!this.$1M_3&&this.get_multiLevelDrillDownParametersBackup().$6_0>0)this.$1D_3(false,this.get_drillDownParamObj());else for(var $v_0=this.get_multiLevelDrillDownParametersBackup().$6_0;$v_0>=0;$v_0--){var $v_1=this.get_multiLevelDrillDownParametersBackup().getAtIndex($v_0);this.$1D_3(false,$v_1)}if(isGridRefreshRequired){var $v_2=this.getFilterSetControl();!IsNull($v_2)&&$v_2.RefreshWithFilters()}},$1D_3:function($p0,$p1,$p2){if(IsNull($p2))$p2=true;var $v_0=this.getFilterSetControl();if(!IsNull($v_0)){if(!$v_0.IsFilterEnabled())if(!$v_0.EnableFilters())return;for(var $v_1=null,$v_2=$p1.$Z_0,$v_3=null,$v_4=null,$v_5=null,$v_6=null,$v_7=null,$v_8=null,$v_9=null,$v_A=null,$v_B=null,$v_C=isNullOrEmptyString($v_2),$v_D=$v_C?1:2,$v_E=false,$v_F=0;$v_F<$v_D;$v_F++){$v_B=$p1.$E_0.length>$v_F?$p1.$E_0[$v_F]:null;if(!$v_F){$v_1=$p1.$x_0;$v_3=$p1.$z_0;$v_5=$p1.$a_0;$v_6=$p1.$l_0;$v_7=$p1.$U_0;$v_4=$p1.$y_0;$v_8=$p1.$P_0;$v_9=$p1.$O_0;$v_E=isNullOrEmptyString($p1.$X_0)?false:Boolean.parse($p1.$X_0);$v_A=$p1.$q_0}if($v_F===1){$v_1=$p1.$Z_0;$v_3=$p1.$s_0;$v_5=$p1.$b_0;$v_6=$p1.$u_0;$v_7=$p1.$N_0;$v_4=$p1.$r_0;$v_8=$p1.$R_0;$v_9=$p1.$Q_0;$v_C=true;$v_E=isNullOrEmptyString($p1.$Y_0)?false:Boolean.parse($p1.$Y_0);$v_A=$p1.$t_0}var $v_G=$v_0.findPopup($v_3,$v_1,$v_E,$v_A);if(IsNull($v_G)&&Mscrm.PageManager.isOutlookProxyPage()){getOutlookHostedWindow().initializeFilter($v_3,$v_1,$v_E,$v_A);$v_G=$v_0.findPopup($v_3,$v_1,$v_E,$v_A)}if(!IsNull($v_G))if($p0){$v_0.addVisualizationFilter($v_3,$v_1,$v_5,$v_6,$v_7,$v_4==="datetime",$v_8,$v_9,$v_C&&$p2,$v_E,$v_A);Array.add($p1.$E_0,null)}else $v_0.removeVisualizationFilter($v_3,$v_1,$v_E,$v_A);else{$v_0.set_isFilterOnHiddenCol(true);var $v_H=new Mscrm.FilterConditionCollection($v_1,$v_4,$v_E,$v_3,"");$v_E&&$v_H.set_relatedEntityDetails($v_A);if($v_4==="datetime"&&!isNullOrEmptyString($v_8)&&!isNullOrEmptyString($v_9))this.addDateTimeLimits($v_H,$v_1,$v_4,$p0,$v_3,$v_8,$v_9,$v_B);else Array.add($v_H.get_filters(),this.addRegularFilter($v_5,$p0,$v_B));var $v_I=null;if($p0){$v_I=$v_0.addFilterConditions($v_H,$v_C&&$p2);Array.add($p1.$E_0,$v_I)}else $v_I=$v_0.addFilterConditions($v_H,false)}}Mscrm.PageManager.isOutlookProxyPage()&&getOutlookHostedWindow().refreshFilterList()}},addRegularFilter:function(parameterValue,addFilter,filterIds){var $v_0=Mscrm.FilterOperatorType.binary,$v_1="eq",$v_2=false,$v_3=addFilter?null:'/fetch//condition[@gridfilterconditionid="'+filterIds[0]+'"]',$v_4;if(parameterValue!=="")$v_4=new Mscrm.FilterCondition($v_0,$v_1,parameterValue,$v_2,$v_3);else $v_4=new Mscrm.FilterCondition(Mscrm.FilterOperatorType.unary,"null",parameterValue,$v_2,$v_3);$v_4.set_isDirty(true);!addFilter&&$v_4.set_isDeleted(true);return $v_4},addDateTimeLimits:function(filterConditions,attributeName,attributeType,addFilter,entityName,startDate,endDate,filterIds){if(!isNullOrEmptyString(startDate)&&!isNullOrEmptyString(endDate)){var $v_0=Mscrm.FilterOperatorType.binary,$v_1="on-or-after",$v_2="on-or-before",$v_3=addFilter?null:'/fetch//condition[@gridfilterconditionid="'+filterIds[0]+'"]',$v_4=new Mscrm.FilterCondition($v_0,$v_1,startDate,false,$v_3);$v_3=addFilter?null:'/fetch//condition[@gridfilterconditionid="'+filterIds[1]+'"]';var $v_5=new Mscrm.FilterCondition($v_0,$v_2,endDate,false,$v_3);$v_4.set_isDirty(true);$v_5.set_isDirty(true);var $v_6=new Mscrm.CustomFilterConditionGroup($v_4,$v_5,Mscrm.FilterNodeType.and);if(!addFilter){$v_6.set_oldPrimary($v_6.get_primary());$v_6.set_primary(null);$v_6.set_oldSecondary($v_6.get_secondary());$v_6.set_secondary(null)}filterConditions.set_customFilters($v_6)}else{var $v_7=addFilter?null:'/fetch//condition[@gridfilterconditionid="'+filterIds[0]+'"]',$v_8=new Mscrm.FilterCondition(Mscrm.FilterOperatorType.unary,"null",null,!addFilter,$v_7);!addFilter&&$v_8.set_isDeleted(true);$v_8.set_isDirty(true);Array.add(filterConditions.get_filters(),$v_8)}return filterConditions},isChartDrillable:function(){var $v_0=this.getPaneChildElement("vizIframe");if(!IsNull($v_0)){var $v_1=$v_0.contentWindow.document.getElementById("drillDownBox");if(!IsNull($v_1))return true}return false},$38_3:function($p0,$p1){var $v_0=this.get_paneGridControl();if(!IsNull($v_0)){this.$F_3=false;this.$1D_3(true,$p0,$p1)}},$2z_3:function(){if(this.get_multiLevelDrillDownParametersBackup())for(var $v_0=this.get_multiLevelDrillDownParametersBackup().$6_0,$v_1=0;$v_1<=$v_0;++$v_1){var $v_2=this.get_multiLevelDrillDownParametersBackup().getAtIndex($v_1);this.$38_3($v_2,$v_1===$v_0)}},$34_3:function(){var $v_0=this.get_paneGridControl();!IsNull($v_0)&&$v_0.SetParameter("doNotFetchData","false");var $v_1=false;try{if(!IsNull(window.top.opener)&&!window.top.opener.closed){var $v_2=this.getParameter("parentVizPaneId"),$v_3=window.top.opener.Sys.Application.findComponent($v_2);if(!IsNull($v_3)){var $v_4=$v_3.get_multiLevelDrillDownParametersBackup();if($v_4.$6_0>=0){for(var $v_5=0;$v_5<=$v_4.$6_0;++$v_5){var $v_6=$v_4.getAtIndex($v_5);this.get_multiLevelDrillDownParametersBackup().add($v_6.clone())}this.set_drillDownParamObj(this.get_multiLevelDrillDownParametersBackup().getAtIndex(this.get_multiLevelDrillDownParametersBackup().$6_0).clone());$v_1=true}}}}catch($$e_7){$v_1=false}if(!$v_1)if(!IsNull($v_0)){this.$F_3=false;$v_0.refresh()}this.setParameter("parentVizPaneId",null);return $v_1},anchorlink:null,visualizationMenu:null,isVisualizationListEmpty:function(){if(this.getSelectedVisualization())return false;return true},refreshCurrentVisualizationIdAndType:function(){this.set_visualizationId(this.getSelectedVisualization());this.set_visualizationType(this.getSelectedVisualizationType());this.fireEventForStickyVisualization()},handleEntityChange:function(entityLogicalName,selectedVisualizationId){if(this.getParameter("vizPanePrimaryEntityName")!==entityLogicalName){this.setParameter("vizPanePrimaryEntityName",entityLogicalName);if(isNullOrEmptyString(selectedVisualizationId))this.loadVisualizationsForCurrentView();else this.refreshAndSetVisualizationList(selectedVisualizationId)}},HandleVisualizationChange:function(eventCode,parameters){var $v_0=parameters["menuitem"],$v_1=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@id='"+$v_0.get_menuItemId()+"']",null),$v_2=XUI.Xml.GetText($v_1.attributes.getNamedItem("display")),$v_3=XUI.Xml.GetText($v_1.attributes.getNamedItem("type")),$v_4=XUI.Xml.GetText($v_1.attributes.getNamedItem("id"));this.setChartNameForSelector($v_2,$v_4,$v_3,$v_1);!IsNull(this.visualizationMenu.get_menuXml())&&this.refreshCurrentVisualizationIdAndType();this.loadVisualization(false)},getSelectedVisualizationType:function(){if(!IsNull(this.visualizationMenu)){var $v_0=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@isselected='true']",null);if(!IsNull($v_0))return Number.parseInvariant(XUI.Xml.GetText($v_0.attributes.getNamedItem("type")))}return Mscrm.EntityTypeCode.None},getSelectedVisualizationProperty:function(propertyName){if(!IsNull(this.visualizationMenu)){var $v_0=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@isselected='true']",null);if(!IsNull($v_0))return XUI.Xml.GetText($v_0.attributes.getNamedItem(propertyName))}return ""},loadVisualizationsForCurrentViewIfNotLoaded:function(){if(this.$17_3)return;this.loadVisualizationsForCurrentView()},loadVisualizationsForCurrentView:function(){this.loadAndSetVisualizationsForCurrentView(true)},loadAndSetVisualizationsForCurrentView:function(setDefaultSelection){var $v_0=this.getPaneChildElement("vizList");this.hideVizList();if(!IsNull($v_0)){var $v_1=new RemoteCommand("PaneWebService","GetSortedVisualizationList",null);$v_1.SetParameter("entityLogicalName",this.getParameter("vizPanePrimaryEntityName"));$v_1.SetParameter("parametersXml",this.buildParamListForVisualizationRetrieval());var $v_2=$v_1.Execute(null),$v_3=$v_2.ReturnValue;$v_0.innerHTML=$v_3;this.$17_3=true;this.registerVisualizationListHandler();this.setSelectorName();setDefaultSelection&&this.refreshCurrentVisualizationIdAndType()}},removeVizListItems:function(vizList){while(vizList.children.length)vizList.removeChild(XUI.Html.DomUtils.GetLastChild(vizList))},resetVizlist:function(){this.refreshCurrentVisualizationIdAndType()},setVisualizationSelected:function(visualizationId){if(!IsNull(this.visualizationMenu)){visualizationId=visualizationId.toUpperCase();var $v_0=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@id='"+visualizationId+"']",null);if(!IsNull($v_0)&&!IsNull($v_0.attributes.getNamedItem("id"))){var $v_1=XUI.Xml.GetText($v_0.attributes.getNamedItem("id"));$v_1=$v_1.replace("{","");$v_1=$v_1.replace("}","");visualizationId=visualizationId.replace("{","");visualizationId=visualizationId.replace("}","");if($v_1.toUpperCase()===visualizationId.toUpperCase()){this.resetSelectedItem();this.visualizationMenu.setAttributeUtil($v_0,"isselected","true");this.setSelectorName()}}this.refreshCurrentVisualizationIdAndType()}},refreshAndSetVisualizationList:function(vizId){this.set_visualizationId(vizId);this.loadAndSetVisualizationsForCurrentView(false);this.setVisualizationSelected(vizId)},buildParamListForVisualizationRetrieval:function(){var $v_0=new Sys.StringBuilder;$v_0.append("<parameters>");!IsNull(this.getParameter("ShowUserVisualization"))&&!Boolean.parse(this.getParameter("ShowUserVisualization"))&&$v_0.append("<ShowUserGroup>false</ShowUserGroup>");!IsNull(this.getParameter("ShowChartPicker"))&&!Boolean.parse(this.getParameter("ShowChartPicker"))&&$v_0.append("<ShowChartPicker>false</ShowChartPicker>");if(!isNullOrEmptyString(this.getParameter("CurrentVisualizationId"))&&!isNullOrEmptyString(this.getParameter("CurrentVisualizationType"))){$v_0.append("<SelectedVisualization>");$v_0.append(CrmEncodeDecode.CrmXmlEncode(this.getParameter("CurrentVisualizationId")));$v_0.append("</SelectedVisualization>");$v_0.append("<SelectedVisualizationType>");$v_0.append(CrmEncodeDecode.CrmXmlEncode(this.getParameter("CurrentVisualizationType")));$v_0.append("</SelectedVisualizationType>")}$v_0.append("</parameters>");return $v_0.toString()},onClickHandler:function(domEvent){domEvent.stopPropagation();var $v_0=Mscrm.Utilities.getDomEventElement(domEvent,"A"),$v_1=new Mscrm.SelectorUtil(this.anchorlink,this.visualizationMenu,this.$1c_3);$v_1.selectorClicked($v_0)},resetSelectedItem:function(){for(var $v_0=XUI.Xml.SelectNodes(this.visualizationMenu.get_menuXml(),"//MenuItem",null),$v_1=0;$v_1<$v_0.length;$v_1++)this.visualizationMenu.setAttributeUtil($v_0[$v_1],"isselected","false")},setChartNameForSelector:function(VisualizationName,VisualizationId,VisualizationType,node){this.resetSelectedItem();this.visualizationMenu.setAttributeUtil(node,"isselected","true");var $v_0=XUI.Html.DomUtils.GetFirstChild(this.getPaneChildElement("visualizationListLink"));XUI.Html.SetText($v_0,VisualizationName);$v_0.setAttribute("CurrentItem",VisualizationId);$v_0.setAttribute("CurrentItemType",VisualizationType)},registerVisualizationListHandler:function(){var $v_0,$v_1=this.getPaneChildElement("visualizationListContainer");if(!IsNull($v_1)){this.$1c_3=$v_1.attributes.getNamedItem("MenuXml").value;this.anchorlink=this.getPaneChildElement("visualizationListLink");$v_0=this.$$d_onClickHandler;$addHandler(this.anchorlink,"click",$v_0);this.visualizationMenu=new Mscrm.Popup(this.$$d_HandleVisualizationChange);this.visualizationMenu.set_menuXml(XUI.Xml.LoadXml(this.$1c_3));var $v_2=document.createAttribute("DefaultItem"),$v_3=XUI.Xml.SelectNodes(this.visualizationMenu.get_menuXml(),"//MenuItem",null);if($v_3.length>0){if(!IsNull($v_3[1].attributes.getNamedItem("id")))$v_2.value=XUI.Xml.GetText($v_3[1].attributes.getNamedItem("id"));else $v_2.value="";$v_1.attributes.setNamedItem($v_2)}}},setSelectorName:function(){var $v_0=null;if(!IsNull(this.visualizationMenu))$v_0=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@id='"+this.getSelectedVisualization()+"']",null);var $v_1=null,$v_2=null,$v_3=null;if(!IsNull($v_0)){$v_1=XUI.Xml.GetText($v_0.attributes.getNamedItem("display"));$v_2=XUI.Xml.GetText($v_0.attributes.getNamedItem("type"));$v_3=XUI.Xml.GetText($v_0.attributes.getNamedItem("id"));this.setChartNameForSelector($v_1,$v_3,$v_2,$v_0)}},hideVizList:function(){!IsNull(this.visualizationMenu)&&!IsNull(this.visualizationMenu.get_currentMenu())&&this.visualizationMenu.get_currentMenu().hide()},$1c_3:null,$1d_3:null,$k_3:null,$o_3:null,$n_3:null,$19_3:null,$1Z_3:null,$17_3:false,$I_3:0,$K_3:true,$F_3:true,$1b_3:false,$f_3:"/Visualization/visualization.aspx",$1M_3:false,$p_3:false,$1K_3:null,$1L_3:null,$1v_3:null,$1t_3:null,$1a_3:null,$11_3:0,$1E_3:0,$2I_3:0,$2H_3:0,$24_3:"0px",$12_3:0,$13_3:0,_gridId:null,get_visualizationId:function(){return this.getParameter("CurrentVisualizationId")},set_visualizationId:function(value){this.setParameter("CurrentVisualizationId",value);return value},get_visualizationType:function(){return Number.parseInvariant(this.getParameter("CurrentVisualizationType"))},set_visualizationType:function(value){this.setParameter("CurrentVisualizationType",value.toString());return value},get_paneSize:function(){return this.getParameter("paneSize")},set_paneSize:function(value){this.setParameter("paneSize",value.toString());return value},get_useCachedData:function(){return this._useCachedData},set_useCachedData:function(value){this._useCachedData=value;return value},$1e_3:null,get_$S_3:function(){if(IsNull(this.$1e_3))this.$1e_3=$find(this._gridId+"_splitTD");return this.$1e_3},get_noVisualizations:function(){if(IsNull(this.$1v_3))return this.getPaneChildElement("emptyVizSpan");else return this.$1v_3},get_loadingSpan:function(){if(IsNull(this.$1t_3))return this.getPaneChildElement("loadingSpan");else return this.$1t_3},get_paneGridControl:function(){if(IsNull(this.$1a_3))this.$1a_3=$find(this._gridId);return this.$1a_3},isDefaultVisualizationModule:function(){return this.$26_3()===this.$f_3},isGridRefreshedThroughChartAction:function(){return !!this.$h_3},get_isChartStale:function(){return this.$K_3},isVisualizationPaneVisible:function(){return this.get_$C_3()!==Mscrm.VisualizationPaneMode.none},isVisualizationPaneOpen:function(){var $v_0=this.get_$C_3();if(Mscrm.SessionInfo.isOutlookClient())return $v_0!==Mscrm.VisualizationPaneMode.none;else return $v_0!==Mscrm.VisualizationPaneMode.none&&$v_0!==Mscrm.VisualizationPaneMode.collapsedSize},get_showVisualizationList:function(){var $v_0=this.getParameter("ShowChartPicker");if(!isNullOrEmptyString($v_0))return Boolean.parse($v_0);return false},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);if(!isNullOrEmptyString(this.getParameter("gridid")))this._gridId=this.getParameter("gridid");else this._gridId="crmGrid";this.$2v_3();var $v_0=$find(this._gridId);if(!IsNull($v_0)){this.setParameter("vizPaneViewId",$v_0.GetParameter("viewid"));this.setParameter("vizPaneViewType",$v_0.GetParameter("viewtype"))}},dispose:function(){if(this.get_isDisposed())return;var $v_0=window.top.$find("crmRibbonManager");!IsNull($v_0)&&$v_0.destroyChartCommandBar();!IsNull(this.visualizationMenu)&&this.visualizationMenu.dispose();Mscrm.CrmUIControl.prototype.dispose.call(this)},handlePageLoad:function(){this._paneMode=parseInt(this.getParameter("vizPaneMode"));if(this.get_$C_3()!==Mscrm.VisualizationPaneMode.none)if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode||this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)this.initializeDesignerMode();else this.initializeRuntimeMode();var $v_0=this.getParameter("vizPaneOtc");Mscrm.EntityPropUtil.isActivityTypeCode(Number.parseInvariant($v_0))&&Mscrm.PageManager.isOutlookProxyPage()&&this.fireEventForStickyVisualization()},handleRibbonLoad:function(){this._paneMode=parseInt(this.getParameter("vizPaneMode"));if(this.get_$C_3()!==Mscrm.VisualizationPaneMode.none)if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode||this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode){var $v_0=window.top.$find("crmRibbonManager");$v_0&&$v_0.setChartDesignerCommandBar($get("chartDesignerCommandBar",this.get_element()))}else{var $v_1=window.top.$find("crmRibbonManager");if($v_1){var $v_2=$get("chartPaneCommandBar",this.get_element()),$v_3=XUI.Html.DomUtils.GetFirstChild($v_2);while(!IsNull($v_3)){$v_2.removeChild($v_3);$v_3=XUI.Html.DomUtils.GetFirstChild($v_2)}$v_1.setChartPaneCommandBar($get("chartPaneCommandBar",this.get_element()))}}},initializeRuntimeMode:function(){var $v_0=this.get_$C_3();if($v_0!==Mscrm.VisualizationPaneMode.none&&$v_0!==Mscrm.VisualizationPaneMode.collapsedSize)this.$17_3=true;var $v_1=window.LOCID_EMPTY_GRID_MESSAGE_REFRESH,$v_2=false;if(!isNullOrEmptyString(this.getParameter("ispreviewmode"))&&Boolean.parse(this.getParameter("ispreviewmode"))){$v_2=true;$v_1=this.getParameter("emptypanemessage")}var $v_3=$find(Mscrm.ClientApiConstants.primaryEntityId);if($v_2||window._IsRefreshForm==="1"&&isNullOrEmptyString($v_3.get_recordId())){this.$1s_3($v_1);return}!IsNull(this.get_$S_3())&&this.get_$S_3().setViewLabelDisplayName();this.$2h_3()},$2h_3:function(){var $v_0=false;if(!isNullOrEmptyString(this.getParameter("parentVizPaneId")))$v_0=this.$34_3();this.get_$C_3()!==Mscrm.VisualizationPaneMode.collapsedSize&&this.loadVisualization($v_0?true:false);$v_0&&this.$2z_3()},isCustomQuery:function(){var $v_0=$find(this._gridId);if(!IsNull($v_0)){var $v_1=$v_0.GetParameter("isFetchXmlNotFinal");if(!isNullOrEmptyString($v_1)&&Boolean.parse($v_1))return true}return false},handleGridRefresh:function(autoRefresh){if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode||this.$1l_3())return;this.$1q_3();if(!this.$K_3&&!this.isGridRefreshedThroughChartAction()&&this.$F_3)if(this.isVisualizationPaneOpen()){if(!autoRefresh){this.$I_3=1;if(this.$B_3!==-1){window.clearInterval(this.$B_3);this.$B_3=-1}var $v_1=this.$14_3();if(!IsNull($v_1)){this.$F_3=false;this.$2Z_3($v_1);this.$B_3=window.setInterval(this.$$d_$2b_3,50)}else{var $v_2=this.getDivInIFrame("errorDiv"),$v_3=this.getDivInIFrame("updateDiv");if(!IsNull($v_2))$v_2.style.display="none";if(!IsNull($v_3)){this.$F_3=false;this.$2P_3();this.$K_3=true}}}var $v_0=this.getPaneChildElement("vizIframe");if(!IsNull($v_0)){var $v_4=$v_0.contentWindow.document.getElementById("drillDownBox");if(!IsNull($v_4))$v_4.style.display="none"}}else if(this.get_$C_3()===Mscrm.VisualizationPaneMode.collapsedSize){this.$K_3=true;this.$F_3=false}if(this.$F_3){var $v_5=false;switch(this.$h_3){case 2:$v_5=this.checkIfDrilldownMode();break;default:break}this.loadVisualizationAsync($v_5)}else this.isGridRefreshedThroughChartAction()&&this.handleBackButton(false);this.$2K_3()},handleGridResetComplete:function(parameters){if(this.isVisualizationPaneOpen()){if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.isQuickFindQuery(parameters["viewid"]))return;this.loadVisualization(false)}else if(this.get_$C_3()===Mscrm.VisualizationPaneMode.collapsedSize)this.$K_3=true},handleGridReset:function(parameters){if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.isQuickFindQuery(parameters["viewid"]))return;this.setParameter("vizPaneViewId",parameters["viewid"]);this.setParameter("vizPaneViewType",parameters["viewtype"]);this.$1q_3();this.$2K_3();if(this.isVisualizationPaneOpen()){this.get_loadingSpan().style.display="inline";var $v_0=this.getPaneChildElement("contentSpan");$v_0.style.display="none";this.get_noVisualizations().style.display="none";this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.switchMode(Mscrm.VisualizationPaneRenderingModes.RuntimeMode)}},$2g_3:function($p0){var $v_0=this.getIframeWin();if(!IsNull($v_0)){var $v_1=$p0;if(!IsNull($v_1))switch($v_1.keyCode){case 83:if($p0.ctrlKey)this.saveVisualization();else $p0.altKey&&this.saveAndCloseVisualization();break;case 17:case 116:$v_1.keyCode=0;this.cancelEvent($v_1);break;case 27:if(this.isEnlargePaneOpen()){this.cancelEvent($v_1);this.closeEnlargePane($v_1)}break}}if(!IsNull(window.document)){var $v_2=window.event;if(!IsNull($v_2))if($p0.keyCode===83&&$p0.ctrlKey)this.saveVisualization();else $p0.keyCode===83&&$p0.altKey&&this.saveAndCloseVisualization()}return},$2v_3:function(){this.registerVisualizationListHandler();this.setSelectorName();this.registerToolBarHandler();this.registerEnlargePaneHandler()},refreshVisualizationPane:function(domEvent){this.cancelEvent(domEvent);if(this.isPaneInDesignerMode())return;Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.OnPaneRefresh,null);this.cancelDrillDownAndLoadVisualization(!this.$K_3&&this.checkIfDrilldownMode())},cancelDrillDownAndLoadVisualization:function(isDrillDown){var $v_0=false;if(!IsNull(this.get_paneGridControl())){var $v_1=this.getPaneChildElement("vizIframe");try{$v_0=$v_1.contentWindow.Mscrm.Visualization.cancelDrillDown(true,true)}catch($$e_3){}}!$v_0&&this.loadVisualization(isDrillDown)},hideVisualizationPane:function(){var $v_0=$find(this._gridId+"_splitTD");!IsNull($v_0)&&$v_0.hideVisualizationPane()},toggleVisualizationPane:function(){var $v_0=$find(this._gridId+"_splitTD");!IsNull($v_0)&&$v_0.togglePaneSize()},showVisualizationPane:function(loadVisualizationNotRequired){if(this.get_$C_3()===Mscrm.VisualizationPaneMode.collapsedSize){Mscrm.PageManager.isOutlookProxyPage()&&getOutlookHostedWindow().showVisualizationCollapsed(false);!this.$17_3&&this.loadVisualizationsForCurrentView();this.get_$S_3().showVisualizationPane();if(this.$K_3&&!loadVisualizationNotRequired)this.loadVisualization(false);else refreshRibbon(0);var $v_0=window.top.$find("crmRibbonManager");$v_0&&$v_0.setChartPaneCommandBar($get("chartPaneCommandBar",this.get_element()))}},loadVisualization:function(isDrilldown){var $v_0=this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode;if(this.get_showVisualizationList()){var $v_9=this.getPaneChildElement("headerRowTR");if(!IsNull($v_9))$v_9.style.display="block"}var $v_1="",$v_2=this.$f_3,$v_3=this.getPaneChildElement("contentSpan"),$v_4;if(!$v_0){$v_4=this.getPaneChildElement("vizIframe");$v_3.style.display="none"}else $v_4=this.getPaneChildElement("previewIframe");if(this.$1p_3())return;if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode){$v_1=this.get_visualizationId();$v_2=this.$26_3();if(isNullOrEmptyString($v_1)){if(!this.$1l_3()){var $v_A="";if(!IsNull(this.get_paneGridControl()))$v_A=this.get_paneGridControl().get_entityDisplayPluralName();var $v_B=String.format(window.LOCID_VP_NOASSOSVISUALIZATION,$v_A);this.$1s_3($v_B);this.updateFooterMessage("")}this.get_loadingSpan().style.display="none";this.get_noVisualizations().style.display="inline";this.$2Q_3(false);if(!isNullOrEmptyString(this.getParameter("IsDashboardComponent"))&&Boolean.parse(this.getParameter("IsDashboardComponent")))refreshRibbon(0);else refreshRibbon();return}else{this.$2Q_3(true);if(this.$1l_3())return;this.get_noVisualizations().style.display="none";this.get_loadingSpan().style.display="inline"}}var $v_5=!this._gridId?this.get_elementId():this._gridId,$v_6=$v_0?"previewIframe":$v_5+"_vizIframe",$v_7=$v_5+"_vizForm",$v_8=$v_5+"_span";this.updateFooterMessage("");if(this.isVisualizationPaneOpen()){var $v_C=this.getParameter("IsDashboardComponent");if(window.UseTabletExperience&&!isNullOrEmptyString($v_C)&&Boolean.parse($v_C)){var $v_D=$get($v_8);if(this.isEnlargePaneOpen()){if(!isDrilldown){var $v_E=$get("visualizationImage",$v_3);!IsNull($v_E)&&$v_E.parentNode.removeChild($v_E)}if(!IsNull($v_D))$v_D.style.position="";this.$2J_3(isDrilldown,$v_0,$v_1,$v_2,$v_3,$v_4,$v_6,$v_7)}else{if(!IsNull($v_D))$v_D.style.position="relative";this.$2p_3($v_1,$v_2,$v_3)}}else this.$2J_3(isDrilldown,$v_0,$v_1,$v_2,$v_3,$v_4,$v_6,$v_7)}if(!isNullOrEmptyString(this.getParameter("IsDashboardComponent"))&&Boolean.parse(this.getParameter("IsDashboardComponent")))refreshRibbon(0);else refreshRibbon()},$2p_3:function($p0,$p1,$p2){this.vizSubmitParams={};this.compressedParametersList=[];this.$1x_3($p0,$p1,false);this.addDrillDownSpecificParameterOnLoadVisualization(false);var $v_0="vizXml="+CrmEncodeDecode.CrmUrlEncode(this.buildVisualizationXml()),$v_1=new XMLHttpRequest;$v_1.open("POST",this.$1n_3($p1,true));$v_1.setRequestHeader("Content-type","application/x-www-form-urlencoded");$v_1.setRequestHeader("Content-length",$v_0.length.toString());var $$t_8=this;$v_1.onreadystatechange=function(){if($v_1.readyState===4&&$v_1.status===200){$v_1.onreadystatechange=null;var $v_2=Sys.Serialization.JavaScriptSerializer.deserialize($v_1.responseText),$v_3;if($v_2.isValid){$v_3=document.createElement("img");$v_3.id="visualizationImage";$v_3.style.width=$v_2.imageWidth+"px";$v_3.style.height=$v_2.imageHeight+"px";$v_3.style.marginTop="10px";$v_3.src="data:image/png;base64,"+$v_2.imageData}else{$v_3=document.createElement("div");$v_3.id="visualizationImage";$v_3.style.display="table";$v_3.style.height="100%";var $v_4=document.createElement("label");$v_4.style.display="table-cell";$v_4.style.verticalAlign="middle";$v_4.className="ms-crm-errorDiv ms-crm-Info-Label";XUI.Html.SetText($v_4,$v_2.message);$v_3.appendChild($v_4)}$p2.innerHTML="";$p2.appendChild($v_3);$$t_8.$2O_3(null)}};$v_1.send($v_0)},$2J_3:function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){try{var $v_0=this.$2s_3($p5,$p6);this.$1d_3=this.$$d_$2O_3;$addHandler($v_0,"load",this.$1d_3);if(IsNull($p5)&&!$p1){$p4.appendChild($v_0);$v_0.contentWindow.name=$p6}if(isNullOrEmptyString($p2)||$p3===this.$f_3){var $v_1=this.getPaneChildElement($p7);!IsNull($v_1)&&$p4.removeChild($v_1);var $v_2=this.$2t_3($p7,$p6,$p3);$p4.appendChild($v_2);this.$1x_3($p2,$p3,$p0);this.addDrillDownSpecificParameterOnLoadVisualization($p0);this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.$2V_3();var $v_3=$find(this._gridId),$v_4=IsNull(this.vizSubmitParams["enableDrillDown"])?true:Mscrm.Utilities.parseBoolean(this.vizSubmitParams["enableDrillDown"]);!IsNull($v_3)&&$v_4&&this.addSubmitParameters("layoutXml",$v_3.GetParameter("layoutXml"));this.addFormParameter($v_2.name,"vizXml",this.buildVisualizationXml());var $v_5=Number.parseInvariant(this.vizSubmitParams["paneContentWidth"]),$v_6=Number.parseInvariant(this.vizSubmitParams["paneContentHeight"]);!(0===$v_5||0===$v_6)&&$v_2.submit();this.vizSubmitParams=null;this.compressedParametersList=null}else $v_0.src=this.$1n_3($p3);this.$1b_3=true}finally{this.$K_3=false;this.clearDrilldownBackup($p0);this.$p_3=false;this.$1M_3=false}},$2t_3:function($p0,$p1,$p2){this.vizSubmitParams={};this.compressedParametersList=[];var $v_0=document.createElement("form");$v_0.id=$p0;$v_0.name=$p0;$v_0.method="post";$v_0.target=$p1;$v_0.action=this.$1n_3($p2);return $v_0},$2s_3:function($p0,$p1){var $v_0=$p0;if(IsNull($v_0)){var $v_1=CrmEncodeDecode.CrmHtmlAttributeEncode(this.getSelectedVisualizationDisplayName());$v_0=document.createElement("iframe");$v_0.id=$p1;$v_0.title=$v_1;if(window.UseTabletExperience){$v_0.scrolling="no";$v_0.style.overflow="hidden"}else $v_0.scrolling="auto";$v_0.frameBorder="0";$v_0.style.width="100%";$v_0.style.height="100%";$v_0.style.display="block";$v_0.setAttribute("name",$p1);$v_0.setAttribute("gridId",this._gridId)}else if(!IsNull($v_0.contentWindow)&&this.$1b_3)try{$v_0.contentWindow.document.body.innerHTML=""}catch($$e_4){}return $v_0},loadVisualizationAsync:function(isDrillDown){var $$t_1=this;window.setTimeout(function(){$$t_1.loadVisualization(isDrillDown)},0)},loadVisualizationWhenGridIsHidden:function(){var $v_0=$find(this._gridId);if(!IsNull($v_0)){var $v_1=$v_0.GetParameter("isGridHidden");!isNullOrEmptyString($v_1)&&Boolean.parse($v_1)&&this.loadVisualizationAsync(false)}},$1x_3:function($p0,$p1,$p2){var $v_0=$find(this._gridId);if(IsNull($p2)||!$p2)if(!IsNull($v_0)){this.addSubmitParameters("filterFetchXml",$v_0.GetParameter("effectiveFetchXml"));var $v_2=$v_0.GetParameter("isFetchXmlNotFinal");!isNullOrEmptyString($v_2)&&Boolean.parse($v_2)&&$p1!==this.$f_3&&this.addSubmitParameters("isFetchXmlNotFinal","true")}this.addSubmitParameters("visualizationId",$p0);this.addSubmitParameters("viewid",this.getParameter("vizPaneViewId"));this.addSubmitParameters("viewtype",this.getParameter("vizPaneViewType"));this.addSubmitParameters("visType",this.get_visualizationType().toString());if(!IsNull(this.get_$C_3())&&this.getParameter("paneSize")!=="")this.addSubmitParameters("layoutSize",this.get_$C_3());else this.addSubmitParameters("layoutSize",Mscrm.VisualizationPaneMode.defaultSize);this._useCachedData&&this.$1w_3();var $v_1=this.getPaneChildElement("vizContent");if(!IsNull($v_1)){var $v_3=275,$v_4=180;if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode){var $v_5=$v_1.offsetHeight;$v_3=Math.round(.95*$v_1.clientWidth);$v_4=Math.round(.95*$v_1.clientHeight);if(!$v_3&&!$v_4){$v_3=this.$2I_3;$v_4=this.$2H_3}else{this.$2I_3=$v_3;this.$2H_3=$v_4}}this.addSubmitParameters("paneContentWidth",$v_3.toString());this.addSubmitParameters("paneContentHeight",$v_4.toString())}this.addSubmitParameters("isDashboardComponent",this.getParameter("IsDashboardComponent"));this.addSubmitParameters("isSubgridMode",this.getParameter("IsSubgridMode"));this.addSubmitParameters("enableViewPicker",this.getParameter("enableViewPicker"));this.addSubmitParameters("viewTitle",this.getParameter("viewTitle"));this.addSubmitParameters("ShowChartPicker",this.getParameter("ShowChartPicker"));this.addSubmitParameters("ie-browser-version",Mscrm.Utilities.get_ieBrowserVersion().toString())},$2V_3:function(){this.addSubmitParameters("isPreview","true");this.addSubmitParameters("vizName",this.get_chartNameInputValue());this.addSubmitParameters("vizDescription",XUI.Html.GetText(this.getPaneChildElement("visualizationDescription")));this.addSubmitParameters("dataXml",this.generateDataXml());this.addSubmitParameters("presentationXml",this.generatePresentationXml());this.addSubmitParameters("enableDrillDown","false");this._useCachedData&&this.$1w_3()},$1w_3:function(){var $v_0=this.getIframeWin();if(!IsNull($v_0)){var $v_1=$v_0.document.getElementById("resultXml");if(!IsNull($v_1)&&!isNullOrEmptyString($v_1.value)){this.addSubmitParameters("useCachedData","true");this.addSubmitParameters("resultXml",$v_1.value,true)}}},$2O_3:function($p0){this.$1b_3=false;if(!window.UseTabletExperience){this.$k_3=this.$$d_$2g_3;var $v_4=this.getIframeWin();!IsNull($v_4)&&!IsNull($v_4.document)&&$addHandler($v_4.document.documentElement,"keydown",this.$k_3)}var $v_0=this.getPaneChildElement("contentSpan");$v_0.style.display="block";$v_0.style.height="100%";this.get_loadingSpan().style.display="none";this.$I_3=.3;if(this.$B_3!==-1){window.clearInterval(this.$B_3);this.$B_3=-1}var $v_1=this.$14_3();if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode){if(!IsNull($v_1))this.isChartDrillable()&&this.isDefaultVisualizationModule()&&this.updateFooterMessage(window.LOCID_VP_DRILLDOWNALERT);else this.handleBackButton(false);var $v_5=$find(this._gridId);if(!IsNull($v_5)){var $v_6=$v_5.GetParameter("isGridHidden");!isNullOrEmptyString($v_6)&&Boolean.parse($v_6)&&this.handleBackButton(false)}}else{this.getPaneChildElement("loadingImageTable").style.display="none";if(IsNull($v_1)&&this.isNoDataToCreateChart()&&this.isDesignerSupportedChartType()){this.updateStaticImages();this.getPaneChildElement("staticImageTable").style.display="";this.updateFooterMessage(window.LOCID_VPD_NODATA)}else this.getPaneChildElement("previewFrameCell").style.display="block"}var $v_2=this.checkIfDrilldownMode();if(!IsNull($v_1)){$v_2&&this.setFocus($v_1);this.$B_3=window.setInterval(this.$$d_$2a_3,50)}var $v_3=this.$1F_3();if(!IsNull($v_3)){$removeHandler($v_3,"load",this.$1d_3);$clearHandlers($v_3.contentWindow)}if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var $v_7=window.status;window.status=null;window.status=$v_7}},$26_3:function(){var $v_0=this.$f_3;if(!IsNull(this.visualizationMenu)){var $v_1=XUI.Xml.SelectSingleNode(this.visualizationMenu.get_menuXml(),"//MenuItem[@isselected='true']",null);if(!IsNull($v_1))$v_0=XUI.Xml.GetText($v_1.attributes.getNamedItem("visualizationmodule.entrypointurl"))}return $v_0},$1n_3:function($p0,$p1){if(IsNull($p1))$p1=false;var $v_0=Mscrm.CrmUri.create($p0);if($p0===this.$f_3){var $v_1=Math.random();$v_0.get_query()["uniqueId"]=$v_1.toString()+this.get_visualizationId().replace("{","").replace("}","");if($p1)$v_0.get_query()["img"]=true}else{$v_0.get_query()["type"]=this.getParameter("vizPaneOtc");$v_0.get_query()["typename"]=this.getParameter("vizPanePrimaryEntityName");$v_0.get_query()["orgname"]=window.ORG_UNIQUE_NAME;$v_0.get_query()["userlcid"]=window.USER_LANGUAGE_CODE.toString();$v_0.get_query()["orglcid"]=window.ORG_LANGUAGE_CODE.toString();$v_0.get_query()["data"]=String.format("visid={0}&vistype={1}&viewid={2}&viewtype={3}",this.get_visualizationId(),this.get_visualizationType().toString(),this.getParameter("vizPaneViewId"),this.getParameter("vizPaneViewType"))}return $v_0.toString()},$1p_3:function(){if(!isNullOrEmptyString(this.getParameter("LoadOnDemand"))&&this.getParameter("LoadOnDemand")==="1")return true;else return false},loadVisualizationOnDemand:function(){if(this.$1p_3()){this.$1q_3();var $v_0=$find(this._gridId);if(!IsNull($v_0))$v_0.Refresh();else this.loadVisualizationAsync(false)}},$1q_3:function(){if(this.$1p_3()){this.setParameter("LoadOnDemand","0");var $v_0=this.getPaneChildElement("loadOnDemandMessage");$v_0.style.display="none";this.get_loadingSpan().style.display="inline"}},$2Z_3:function($p0){$p0.alt="";var $v_0=this.getPaneChildElement("vizIframe"),$v_1=$v_0.contentWindow.document.getElementById("ImageMap");!IsNull($v_1)&&$v_1.parentNode.removeChild($v_1)},$2b_3:function(){if(this.$I_3<=.3){window.clearInterval(this.$B_3);this.$B_3=-1;this.$2P_3();this.$K_3=true;return}this.$I_3=this.$I_3-.05;var $v_0=this.$14_3();!IsNull($v_0)&&XUI.Html.SetOpacity($v_0,this.$I_3)},$2a_3:function(){if(this.$I_3>=1){window.clearInterval(this.$B_3);this.$B_3=-1;!this.isGridRefreshedThroughChartAction()&&this.handleBackButton(false);return}this.$I_3=this.$I_3+.1;var $v_0=this.$14_3();!IsNull($v_0)&&XUI.Html.SetOpacity($v_0,this.$I_3)},$14_3:function(){var $v_0=this.$1F_3();if(!IsNull($v_0)){var $v_1=$v_0.contentWindow.document.getElementById("CrmChart");if(!IsNull($v_1))return $v_1}return null},isNoDataToCreateChart:function(){var $v_0=this.$1F_3();if(!IsNull($v_0)){var $v_1=$v_0.contentWindow.document.getElementById("errorDiv");if(!IsNull($v_1)){var $v_2=$v_1.getAttribute("type");return $v_2==="info"}}return false},$1F_3:function(){if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode)return this.getPaneChildElement("vizIframe");else return this.getPaneChildElement("previewIframe")},$2P_3:function(){var $v_0=this.getPaneChildElement("vizContent"),$v_1=this.getPaneChildElement("vizIframe"),$v_2=$v_1.contentWindow.document.getElementById("updateDiv"),$v_3=$v_0.clientWidth,$v_4=$v_0.clientHeight,$v_5=this.$14_3();if(!IsNull($v_5)){$v_3=$v_0.clientWidth;$v_4=$v_0.clientHeight}else{var $v_A=this.getDivInIFrame("errorDiv");if(!IsNull($v_A)){$v_3=$v_0.clientWidth;$v_4=$v_A.clientHeight}}var $v_6=0,$v_7=0;if(!IsNull($v_2)){$v_2.style.display="block";$v_6=($v_3-$v_2.clientWidth)/2-12+$v_1.contentWindow.document.body.scrollLeft;$v_7=($v_4-$v_2.clientHeight)/2+$v_1.contentWindow.document.body.scrollTop;if($v_6<0)$v_6=0;if($v_7<0)$v_7=0;$v_2.style.left=$v_6+"px";$v_2.style.top=$v_7+"px"}var $v_8=$v_1.contentWindow.document.getElementById("btnBack");if(!IsNull($v_8)){$v_8.style.display="none";var $v_B=$v_1.contentWindow.document.getElementById("btnBackTop");if(!IsNull($v_B))$v_B.style.display="none"}var $v_9=$v_1.contentWindow.document.getElementById("btnHome");if(!IsNull($v_9)){$v_9.style.display="none";var $v_C=$v_1.contentWindow.document.getElementById("btnHomeTop");if(!IsNull($v_C))$v_C.style.display="none"}this.setParameter("isDrillDownMode","false");this.updateFooterMessage(window.LOCID_VP_UPDATECHARTALERT)},updateFooterMessage:function(message){this.updateFooterMessageWithIcon(message,true)},updateFooterMessageWithIcon:function(message,isInfo){var $v_0=this.getPaneChildElement("notificationRow");if(IsNull($v_0))return;if(isNullOrEmptyString(message))$v_0.style.display="none";else{$v_0.style.display="inline";var $v_1=this.getPaneChildElement("visualizationPaneMessageLabel");if(!IsNull($v_1)){$v_1.innerHTML=CrmEncodeDecode.CrmHtmlEncode(message);$v_1.setAttribute("title",message)}var $v_2=this.getPaneChildElement("notificationImg");if(!IsNull($v_2)){var $v_3=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create(isInfo?"/_imgs/error/notif_icn_info16.png":"/_imgs/error/notif_icn_crit16.png"));$v_2.src=$v_3.source;$v_2.className=$v_3.cssClass}}},updateWindowTitle:function(visualizationName){if(this.getParameter("paneLocation")!=="1")return;if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)window.top.document.title=window.LOCID_VPD_TITLE_NEW;else if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)window.top.document.title=String.format(window.LOCID_VPD_TITLE_EDIT,visualizationName)},$1l_3:function(){var $v_0=$find(this._gridId);if(!IsNull($v_0)){var $v_1=$v_0.GetParameter("isFetchXmlNotFinal");if(!isNullOrEmptyString($v_1)&&Boolean.parse($v_1))if(this.isDefaultVisualizationModule()){var $v_2=this.getPaneChildElement("contentSpan");if(!IsNull($v_2))$v_2.style.display="none";this.$1s_3(window.LOCID_VP_QUERYAPIVISUALIZATION);this.$2A_3(false);return true}this.$2A_3(true)}return false},$2A_3:function($p0){var $v_0=this.getPaneChildElement("openDesignerLink");if(!IsNull($v_0))if($p0)$v_0.style.display="inline";else $v_0.style.display="none"},$1s_3:function($p0){var $v_0=this.getPaneChildElement("emptymessage");$v_0.innerHTML=CrmEncodeDecode.CrmHtmlEncode($p0);this.get_noVisualizations().style.display="inline";this.get_loadingSpan().style.display="none"},$2Q_3:function($p0){var $v_0=this.getPaneChildElement("chartRefreshButton");if(IsNull($v_0))return;if($p0)$v_0.style.display="inline";else $v_0.style.display="none"},$2K_3:function(){this.$h_3=0;this.$F_3=true},isQuickFindQuery:function(selectedViewId,onlyQuickFindMode){if(Mscrm.PageManager.isOutlookProxyPage())return Boolean.parse(getOutlookHostedWindow().getParameter("isQuickFindQuery"));var $v_0=this._gridId+"_SavedNewQuerySelector",$v_1=$find($v_0);if(!IsNull($v_1)&&$v_1.showNewVSControl&&!$v_1.showOriginalSelectBox){if(onlyQuickFindMode)if($v_1.quickFindQuery.toUpperCase()===selectedViewId.toUpperCase())return true;else return false;else if($v_1.quickFindQuery.toUpperCase()===selectedViewId.toUpperCase()||!IsNull($v_1.originalViewId)&&$v_1.originalViewId.toUpperCase()===$v_1.quickFindQuery.toUpperCase()&&this.getParameter("vizPaneViewId").toUpperCase()===selectedViewId.toUpperCase())return true}else{var $v_2=$get($v_0);if(!IsNull($v_2))if($v_2.DataValue===window.LOCID_SEARCH_RESULTS)return true}return false},get_$C_3:function(){if(IsNull(this.get_$S_3()))return Mscrm.VisualizationPaneMode.expandedSize;return this.get_$S_3().get_mode()},registerEnlargePaneHandler:function(){this.$19_3=this.$$d_reEnlargePaneHandler;this.$1Z_3=this.$$d_enlargePaneKeyUpHandler;this.fadeInAnimator=this.$$d_fadeIn;this.fadeOutAnimator=this.$$d_fadeOut},getEnlargeContainer:function(){return $get("formBodyContainer")},getToolBarContainer:function(){return $get(this.get_dashboardToolBarContainerId())},greyOutDashboard:function(container){container.style.overflow="hidden";container.style.visibility="hidden";var $v_0=container.offsetWidth,$v_1=container.offsetHeight,$v_2=container.scrollWidth,$v_3=container.scrollHeight,$v_4=$v_2<$v_0?$v_0:$v_2,$v_5=$v_3<$v_1?$v_1:$v_3,$v_6=$get("greyOutOverlappingIframe");if(IsNull($v_6)){$v_6=document.createElement("iframe");this.get_element().parentNode.appendChild($v_6)}$v_6.id="greyOutOverlappingIframe";$v_6.setAttribute("name","greyOutOverlappingIframe");$v_6.className="ms-crm-visualizationpane-greyout";$v_6.scrolling="no";$v_6.frameBorder="0";$v_6.style.width=$v_4+"px";$v_6.style.height=$v_5+"px";$v_6.setAttribute("tabIndex","-1");var $v_7=$get("greyOutDiv");if(IsNull($v_7)){$v_7=document.createElement("Div");this.get_element().parentNode.appendChild($v_7)}$v_7.id="greyOutDiv";$v_7.className="ms-crm-visualizationpane-greyout";$v_7.style.width=$v_4+"px";$v_7.style.height=$v_5+"px"},unGreyOutDashboard:function(container){container.style.overflow="auto";container.style.visibility="visible";var $v_0=$get("greyOutOverlappingIframe",this.get_element().parentNode);$v_0.parentNode.removeChild($v_0);var $v_1=$get("greyOutDiv",this.get_element().parentNode);$v_1.parentNode.removeChild($v_1)},appendCloseEnlargeButton:function(parentElement){var $v_0=document.createElement("span");$v_0.id="closeEnlargeButton";$v_0.className="ms-crm-visualizationpane-close-enlarge";var $v_1="<a href='#' onclick='$find(\"{0}\").closeEnlargePane(new Sys.UI.DomEvent(event));'><img id='closeEnlargeButton_image' alt='{1}' title='{1}' /></a>";$v_0.innerHTML=String.format($v_1,CrmEncodeDecode.CrmHtmlAttributeEncode(this.get_element().id),CrmEncodeDecode.CrmHtmlAttributeEncode(window.LOCID_VP_CLOSE_ENLARGE_ALT));parentElement.appendChild($v_0);var $v_2=Mscrm.ImageStrip.getImageInfo(Mscrm.CrmUri.create("/_imgs/close.png")),$v_3=$get("closeEnlargeButton_image");$v_3.setAttribute("src",$v_2.source);Sys.UI.DomElement.addCssClass($v_3,$v_2.cssClass);var $v_4=document.createElement("iframe");$v_4.id="closeEnlargeOverlappingIframe";$v_4.className="ms-crm-visualizationpane-close-enlarge";$v_4.frameBorder="0";$v_4.scrolling="no";$v_4.style.width="16px";$v_4.style.height="16px";$v_4.setAttribute("tabIndex","-1");parentElement.appendChild($v_4)},removeCloseEnlargeButton:function(parentElement){var $v_0=$get("closeEnlargeButton",parentElement);$v_0.parentNode.removeChild($v_0);var $v_1=$get("closeEnlargeOverlappingIframe",parentElement);$v_1.parentNode.removeChild($v_1)},enlargePaneKeyUpHandler:function(e){switch(e.keyCode){case 27:this.closeEnlargePane(e);break}},reEnlargePaneHandler:function(e){var $v_0=this.getEnlargeContainer(),$v_1=$v_0.offsetWidth,$v_2=$v_0.offsetHeight;if(Math.abs($v_1-this.$11_3)<5&&Math.abs($v_2-this.$1E_3)<5)return;this.$11_3=$v_1;this.$1E_3=$v_2;$removeHandler(window,"resize",this.$19_3);this.greyOutDashboard($v_0);this.$2M_3();this.refreshVisualizationPane(e);window.setTimeout(this.$$d_attachResizeHandler,1)},attachResizeHandler:function(){if(!this.isEnlargePaneOpen())return;$addHandler(window,"resize",this.$19_3)},getVisualizationToolBar:function(){return this.getPaneChildElement("visualizationToolBar")},getVisualizationToolBarOverlappingIframe:function(){return this.getPaneChildElement("visualizationToolBarIframe")},showToolBarHandler:function(e){this.showToolBar("2",this.fadeInAnimator)},hideToolBarHandler:function(e){this.hideToolBarWithAnimation(e,this.fadeOutAnimator)},showToolBarButton:function(buttonId){var $v_0=$get(buttonId,this.getVisualizationToolBar());if(!IsNull($v_0))$v_0.style.display="inline"},hideToolBarButton:function(buttonId){var $v_0=$get(buttonId,this.getVisualizationToolBar());if(!IsNull($v_0))$v_0.style.display="none"},fadeIn:function(elementList){var $v_0=this.fadeIn.caller;if(!IsNull($v_0))$v_0=$v_0.caller;if(IsNull($v_0)&&!this.$12_3)return;if(this.$13_3){window.clearTimeout(this.$13_3);this.$13_3=0}if(!elementList.length){this.$12_3=0;return}for(var $v_1=0;$v_1<elementList.length;$v_1++){var $v_2=elementList[$v_1],$v_3=XUI.Html.GetOpacity($v_2),$v_4=$v_2.style;if($v_4.display==="none"){$v_4.display="block";XUI.Html.SetOpacity($v_2,.35)}else if($v_3<1){$v_3+=.25;XUI.Html.SetOpacity($v_2,$v_3)}else{XUI.Html.SetOpacity($v_2,1);Array.remove(elementList,$v_2);$v_1--}}var $$t_6=this;this.$12_3=window.setTimeout(function(){$$t_6.fadeIn(elementList)},0)},fadeOut:function(elementList){var $v_0=this.fadeOut.caller;if(!IsNull($v_0))$v_0=$v_0.caller;if(IsNull($v_0)&&!this.$13_3)return;if(this.$12_3){window.clearTimeout(this.$12_3);this.$12_3=0}if(!elementList.length){this.$13_3=0;return}for(var $v_1=0;$v_1<elementList.length;$v_1++){var $v_2=elementList[$v_1],$v_3=XUI.Html.GetOpacity($v_2),$v_4=$v_2.style;if($v_4.display==="none"){XUI.Html.SetOpacity($v_2,1);Array.remove(elementList,$v_2);$v_1--}else if($v_3>.1){$v_3-=.35;XUI.Html.SetOpacity($v_2,$v_3)}else{$v_4.display="none";XUI.Html.SetOpacity($v_2,1);Array.remove(elementList,$v_2);$v_1--}}var $$t_6=this;this.$13_3=window.setTimeout(function(){$$t_6.fadeOut(elementList)},0)},fadeInAnimator:null,fadeOutAnimator:null,openView:function(e){this.cancelEvent(e);var $v_0=Mscrm.CrmUri.create("/homepage.aspx");$v_0.get_query()["visualizationId"]=this.get_visualizationId();$v_0.get_query()["visualizationType"]=this.get_visualizationType();$v_0.get_query()["visualizationPaneMode"]=Mscrm.VisualizationPaneMode.defaultSize;if(this.get_multiLevelDrillDownParametersBackup().$6_0>=0)$v_0.get_query()["parentVizPaneId"]=this.get_id();var $v_1=Mscrm.CrmUri.create("/main.aspx");$v_1.get_query()["pagetype"]="ENTITYLIST";var $v_2=this.getParameter("vizPaneOtc");$v_1.get_query()["etc"]=$v_2;$v_1.get_query()["viewid"]=this.getParameter("vizPaneViewId");$v_1.get_query()["viewtype"]=this.getParameter("vizPaneViewType");if(this.get_visualizationId()==="{475E6F02-32AE-4081-8CB8-E3E24A9FBC0F}")$v_0.get_query()["queueId"]="{5850FC36-8596-45fe-B607-FE81D0C453FD}";$v_1.get_query()["extraqs"]=$v_0.get_queryString();if(Mscrm.EntityPropUtil.isActivityTypeCode(Number.parseInvariant($v_2)))$v_1.get_query()["type"]=this.getParameter("vizPanePrimaryEntityName");openStdWin($v_1,buildWinName(this.get_element().id),1e3,600,null)},enlargePane:function(domEvent){this.cancelEvent(domEvent);var $v_0=this.getEnlargeContainer();this.greyOutDashboard($v_0);$v_0.scrollTop=0;$v_0.scrollLeft=0;this.$11_3=$v_0.offsetWidth;this.$1E_3=$v_0.offsetHeight;this.$2M_3();this.appendCloseEnlargeButton(this.getPaneChildElement("toolBarCell"));this.getPaneChildElement("headerRowTR").style.display="none";this.unRegisterToolBarHandler();this.HideToolBarControl();$addHandler(window,"resize",this.$19_3);$addHandler(document,"keyup",this.$1Z_3);this.refreshVisualizationPane(domEvent)},closeEnlargePane:function(domEvent){this.cancelEvent(domEvent);if(!this.isEnlargePaneOpen())return;var $v_0=this.getEnlargeContainer();$removeHandler(window,"resize",this.$19_3);$removeHandler(document,"keyup",this.$1Z_3);this.$30_3();$v_0.style.visibility="visible";this.removeCloseEnlargeButton(this.getPaneChildElement("toolBarCell"));if(isNullOrEmptyString(this.getParameter("ShowChartPicker"))||Boolean.parse(this.getParameter("ShowChartPicker")))this.getPaneChildElement("headerRowTR").style.display="block";else this.getPaneChildElement("headerRowTR").style.display="none";this.unGreyOutDashboard($v_0);this.refreshVisualizationPane(domEvent);this.registerToolBarHandler();var $v_1=this.getToolBarContainer();$v_1.scrollIntoView(true)},$2M_3:function(){this.get_element().className="ms-crm-visualizationpane-enlarge";var $v_0=3/2*(this.$1E_3-30),$v_1=(this.$11_3-$v_0)/2;if($v_1<0){$v_1=this.$11_3>60?30:0;$v_0=this.$11_3-2*$v_1}var $v_2=this.getPaneChildElement("contentContainer");this.$24_3=$v_2.style.top;$v_2.style.top="0px";var $v_3=this.get_element().style;$v_3.height=(this.$1E_3-Mscrm.Utilities.getVerticalBoxPadding(this.get_element())).toString()+"px";$v_3.width=$v_0+"px";$v_3.paddingLeft=$v_3.paddingRight=$v_1+"px";this.get_element().setAttribute("isEnlarge","True")},$30_3:function(){this.get_element().className="paneControl";this.get_element().style.width="auto";this.get_element().style.height="100%";this.get_element().style.paddingLeft=XUI.Html.GetComputedStyle(this.get_element().parentNode,"paddingLeft");this.get_element().style.paddingRight=XUI.Html.GetComputedStyle(this.get_element().parentNode,"paddingRight");this.get_element().setAttribute("isEnlarge","False");var $v_0=this.getPaneChildElement("contentContainer");$v_0.style.top=this.$24_3},showToolBar:function(mode,animator){var $v_0=this.getVisualizationToolBar(),$v_1=this.getVisualizationToolBarOverlappingIframe();if(IsNull($v_0)||IsNull($v_1))return;var $v_2=$v_0.style,$v_3=$v_1.style,$v_4=this.getPaneChildElement("vizIframe"),$v_5=null;if(!IsNull($v_4)&&!IsNull($v_4.contentWindow)&&!IsNull($v_4.contentWindow.document))$v_5=$v_4.contentWindow.document.body;if(!IsNull($v_5)&&$v_5.scrollHeight>$v_5.clientHeight){Sys.UI.DomElement.addCssClass($v_0,"ms-crm-visualizationpane-toolbar-scrollbar-offset");Sys.UI.DomElement.addCssClass($v_1,"ms-crm-visualizationpane-toolbar-scrollbar-offset")}else{Sys.UI.DomElement.removeCssClass($v_0,"ms-crm-visualizationpane-toolbar-scrollbar-offset");Sys.UI.DomElement.removeCssClass($v_1,"ms-crm-visualizationpane-toolbar-scrollbar-offset")}var $v_6="50px",$v_7=12,$v_8=$v_0.children.length,$v_9=6,$v_A=$v_7*$v_8+$v_9*$v_8;switch(mode){case "2":$v_2.width="auto";$v_2.height=$v_7+"px";$v_3.width=$v_A+"px";$v_3.height=$v_7+"px";break;case "1":$v_2.width=$v_7+"px";$v_2.height="100%";$v_3.width=$v_7+"px";$v_3.height="100%";$v_2.top=$v_6;$v_3.top=$v_6;break;case "3":$v_2.width=$v_7+"px";$v_2.height="auto";$v_3.width=$v_7+"px";$v_3.height=$v_A+"px";$v_2.top=$v_6;$v_3.top=$v_6;break;case "0":default:$v_2.width="100%";$v_2.height=$v_7+"px";$v_3.width="100%";$v_3.height=$v_7+"px";break}if(!IsNull(animator)){$v_3.display="block";var $v_B=[];Array.add($v_B,$v_0);animator($v_B)}else{$v_2.display="block";$v_3.display="block"}},hideToolBarWithAnimation:function(domEvent,animator){var $v_0=this.getVisualizationToolBar(),$v_1=this.getVisualizationToolBarOverlappingIframe();if(IsNull($v_0)||IsNull($v_1))return;var $v_2=null;if(!IsNull(domEvent))$v_2=domEvent.rawEvent.toElement;var $v_3=this.getToolBarContainer();if(!IsNull($v_2)&&Mscrm.Utilities.isDescendant($v_3,$v_2))return;if(!IsNull(animator)){var $v_4=[];Array.add($v_4,$v_0);Array.add($v_4,$v_1);animator($v_4)}else this.HideToolBarControl()},registerToolBarHandler:function(){if(!IsNull(this.getParameter("IsDashboardComponent"))&&Boolean.parse(this.getParameter("IsDashboardComponent"))){if(!IsNull(this.$o_3)&&!IsNull(this.$n_3))return;this.$o_3=this.$$d_showToolBarHandler;this.$n_3=this.$$d_hideToolBarHandler;var $v_0=this.getToolBarContainer();if(!IsNull($v_0)){$addHandler($v_0,"mouseover",this.$o_3);$addHandler($v_0,"mouseout",this.$n_3)}}},unRegisterToolBarHandler:function(){if(IsNull(this.$o_3)&&IsNull(this.$n_3))return;var $v_0=this.getToolBarContainer();if(!IsNull($v_0)){$removeHandler($v_0,"mouseover",this.$o_3);$removeHandler($v_0,"mouseout",this.$n_3)}this.$o_3=null;this.$n_3=null},isEnlargePaneOpen:function(){if(!IsNull(this.get_element().getAttribute("isEnlarge")))return Boolean.parse(this.get_element().getAttribute("isEnlarge").toString());return false},HideToolBarControl:function(){var $v_0=this.getVisualizationToolBar(),$v_1=this.getVisualizationToolBarOverlappingIframe();if(!IsNull($v_0)&&!IsNull($v_1)){$v_0.style.display="none";$v_1.style.display="none"}},deleteVisualization:function(){this.showVisualizationPane();var $v_0=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/_grid/cmds/dlg_confirm_deleteVisualization.aspx"),null,500,300,null);$v_0.setCallbackInfo("performVisualizationDelete",this,null);$v_0.show()},performVisualizationDelete:function(confirmDelete){if(!confirmDelete)return;var $v_0=this.get_visualizationId();if(!$v_0)return;var $v_1=this.get_visualizationType();if($v_1===Mscrm.EntityTypeCode.SavedQueryVisualization)return;var $v_2=new RemoteCommand("PaneWebService","DeleteVisualization",null);$v_2.SetParameter("visualizationId",$v_0);$v_2.SetParameter("type",$v_1.toString());var $v_3=$v_2.Execute(null);this.loadVisualizationsForCurrentView();this.loadVisualization(false)},showVisualization:function(toggle){if(this.isVisualizationPaneOpen())!IsNull(toggle)&&toggle&&this.disableVisualization();else{this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.switchMode(Mscrm.VisualizationPaneRenderingModes.RuntimeMode);if(!this.$17_3)this.loadVisualizationsForCurrentView();else this.resetVizlist();this.get_$S_3().showVisualizationPane();this.loadVisualization(false)}},exitDesigner:function(){if(!this.isPaneInDesignerMode())return false;if(this.getParameter("paneLocation")==="1"){closeWindow();$removeHandler(document,"keydown",this.$k_3);return true}else if(this.confirmCloseDesigner()){this.switchMode(Mscrm.VisualizationPaneRenderingModes.RuntimeMode);this.loadVisualization(false);$removeHandler(document,"keydown",this.$k_3);return true}else return false},disableVisualization:function(){if(this.isPaneInDesignerMode())if(this.confirmCloseDesigner())this.switchMode(Mscrm.VisualizationPaneRenderingModes.RuntimeMode);else return;var $v_0=this.getParameter("IsSubgridMode");this.hideVizList();this.get_$S_3().disableVisualizationPane();refreshRibbon()},saveChart:function(saveAs,close){if(IsNull(close))close=false;this.showVisualizationPane();if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&!this.areRequiredInputsPresent(true)){alert(window.LOCID_VPD_INCOMPLETE_CHART);return}if(!saveAs&&!this.isDesignerPaneDirty()){close&&this.exitDesigner();return}var $v_0=false,$v_1="",$v_2="",$v_3=false,$v_4=null;try{var $v_5=this.getParameter("vizPaneViewId"),$v_6=this.get_chartNameInput(),$v_7=this.getPaneChildElement("visualizationDescription"),$v_8=false,$v_9=this.get_visualizationId();if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode){$v_1=$v_6.value.trim();$v_2=$v_7.value.trim();$v_8=$v_6.IsDirty}else $v_2=this.getSelectedVisualizationProperty("desc");var $v_A=this.$2f_3(saveAs,$v_8);if(saveAs){if(isNullOrEmptyString($v_1))$v_1=this.getSelectedVisualizationDisplayName();this._paneMode!==Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode&&$v_A.SetParameter("visualizationId",$v_9)}else this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&$v_A.SetParameter("visualizationId",$v_9);$v_A.SetParameter("name",$v_1);$v_A.SetParameter("description",$v_2);$v_4=$v_A.Execute(null);if($v_4.Success){var $v_B=null;$v_B=Sys.Serialization.JavaScriptSerializer.deserialize($v_4.ReturnValue);if($v_B.DuplicateFound||Boolean.parse($v_A.GetParameter("saveAs").Value)){var $v_C=[$v_0,saveAs,$v_1,$v_2,close];this.saveChartWithUniqueName($v_A,$v_C,$v_B);$v_3=true}}}catch($$e_F){this.updateFooterMessageWithIcon(window.LOCID_VPD_SAVE_ERROR,false);$v_0=false}!$v_3&&this.saveChartCallback($v_4,$v_0,saveAs,$v_1,$v_2,close)},$2f_3:function($p0,$p1){var $v_0=new RemoteCommand("PaneWebService","SaveChart",null);if($p0)$v_0.SetParameter("saveAs","true");else $v_0.SetParameter("saveAs","false");if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode){$v_0.SetParameter("dataXml",this.generateDataXml());$v_0.SetParameter("presentationXml",this.generatePresentationXml())}if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode||Boolean.parse($v_0.GetParameter("saveAs").Value)||this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&$p1)$v_0.SetParameter("checkDuplicate","true");else $v_0.SetParameter("checkDuplicate","false");var $v_1=this.get_visualizationType(),$v_2=this.get_isSystemDesigner()?Mscrm.EntityTypeCode.SavedQueryVisualization:Mscrm.EntityTypeCode.UserQueryVisualization;$v_0.SetParameter("sourceVisualizationType",$v_1);$v_0.SetParameter("visualizationType",$v_2);var $v_3=this.getParameter("vizPanePrimaryEntityName");$v_0.SetParameter("entityName",$v_3);return $v_0},saveChartCallback:function(result,saveSucceeded,saveAs,visualizationName,visualizationDescription,close){try{var $v_0=this.get_chartNameInput(),$v_1=this.getPaneChildElement("visualizationDescription");if(!IsNull(result))if(result.Success){saveSucceeded=true;var $v_2=Sys.Serialization.JavaScriptSerializer.deserialize(result.ReturnValue),$v_3=$v_2.VisualizationId,$v_4=$v_2.VisualizationName,$v_5=!IsNull(result.description)?result.description:visualizationDescription;this.refreshAndSetVisualizationList($v_3);if(this._paneMode!==Mscrm.VisualizationPaneRenderingModes.RuntimeMode){this.$A_3=false;$v_0.defaultValue=$v_4;$v_0.value=$v_4;$v_1.defaultValue=$v_5;XUI.Html.SetText($v_1,$v_5);if(!IsNull(result.autoFillTitle))this.autoFillTitle=this.autoFillTitle&&Boolean.parse(result.autoFillTitle);if(!close)if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode){this._paneMode=Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode;Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon()}}if(saveAs){this.updateFooterMessage(String.format(window.LOCID_VPD_SAVEAS_SUCCESS,visualizationName,$v_4,this.getParameter("entityDisplayName")));this.updateWindowTitle($v_4);if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode)this.loadVisualization(false);else if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)if(!IsNull(window.CAN_CUSTOMIZE_VISUALIZATION)&&!window.CAN_CUSTOMIZE_VISUALIZATION){var $v_6=this.getPaneChildElement("designerContentTable");if(!IsNull($v_6))$v_6.disabled=false;window.CAN_CUSTOMIZE_VISUALIZATION=true;Mscrm.VisualizationPane.hideInlineActionMenus();refreshRibbon()}}else{this.updateFooterMessage(window.LOCID_VPD_SAVE_SUCCESS);this.updateWindowTitle(visualizationName)}}else{this.updateFooterMessageWithIcon(window.LOCID_VPD_SAVE_ERROR,false);saveSucceeded=false}}catch($$e_D){this.updateFooterMessageWithIcon(window.LOCID_VPD_SAVE_ERROR,false);saveSucceeded=false}saveSucceeded&&this.getParameter("paneLocation")==="1"&&Mscrm.VisualizationActions.refreshVisualizationsGrid();saveSucceeded&&close&&this.exitDesigner()},saveChartWithUniqueName:function(rc,parameters,visualizationInfo){var $v_0={};$v_0.rc=rc;$v_0.visInfo=visualizationInfo;var $v_1=Mscrm.CrmUri.create("/Visualization/SaveVisualization.aspx");$v_1.get_query()["saveAs"]=rc.GetParameter("saveAs").Value;$v_1.get_query()["vizType"]=rc.GetParameter("visualizationType").Value;var $v_2=new Mscrm.CrmDialog($v_1,$v_0,500,310,"maximize:no;minimize:no");$v_2.setCallbackInfo("saveChartCallback",this,parameters);$v_2.show()},expandVisualization:function(){this.get_$S_3().togglePaneSize()},importVisualization:function(setCallback){var $v_0=Mscrm.CrmUri.create("/Visualization/cmds/dlg_importvisualization.aspx");$v_0.get_query()["vizType"]=Mscrm.EntityTypeCode.UserQueryVisualization;var $v_1=new Mscrm.CrmDialog($v_0,null,400,260,"maximize:no;minimize:no");setCallback&&$v_1.setCallbackInfo("performActionAfterImportVisualization",this,null);$v_1.show()},performActionAfterImportVisualization:function(resultInfo){if(!IsNull(resultInfo)){var $v_0=resultInfo.VisualizationName,$v_1=resultInfo.EntityLogicalName,$v_2=resultInfo.Success;if($v_2){var $v_3=Sys.Serialization.JavaScriptSerializer.deserialize(resultInfo.ReturnValue),$v_4=$v_3.VisualizationId,$v_5=resultInfo.EntityPluralDisplayName;this.updateFooterMessage(String.format(window.LOCID_VPD_IV_SUCCESS,$v_0,$v_5));if(this.getParameter("vizPanePrimaryEntityName")===$v_1){var $v_6=this.get_visualizationId();this.loadAndSetVisualizationsForCurrentView(false);if(this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode){this.setVisualizationSelected($v_4);this.loadVisualization(false)}else this._paneMode===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode&&this.setVisualizationSelected($v_6)}}else{this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.loadVisualization(false);this.updateFooterMessageWithIcon(String.format(window.LOCID_VPD_IV_FAILURE,$v_0),false)}}else this._paneMode===Mscrm.VisualizationPaneRenderingModes.RuntimeMode&&this.loadVisualization(false)},exportVisualization:function(){this.showVisualizationPane();var $v_0=this.get_visualizationId();if(IsNull($v_0)||$v_0==="")return;Mscrm.VisualizationActions.exportVisualization($v_0,this.get_visualizationType(),false,this.get_element())},applyChartType:function(chartTypeToApply,isInlineAction){this.showVisualizationPane();var $v_0=isInlineAction?this.$H_3:this.$8_3,$v_1=this.getChartTypeString($v_0);if(chartTypeToApply.toUpperCase()!==$v_1.toUpperCase()){var $v_2=chartTypeToApply.toLowerCase(),$v_3=this.$3_3[$v_2];if(!IsNull($v_3)){var $v_4=this.$9_3;this.updatePresentationXmlOnChartTypeChange($v_4,$v_3,$v_2,$v_0);this.updateDesignerUIOnChartTypeChange($v_4,chartTypeToApply,$v_0);this.$A_3=true;!this.checkAndPreviewChart(false,true)&&this.updateStaticImages()}}Mscrm.VisualizationPane.hideInlineActionMenus()},updatePresentationXmlOnChartTypeChange:function(oldChartTypeGroup,chartTypeItem,chartTypeToApplyInLowercase,seriesId){var $v_0=this.getChartGroup(chartTypeToApplyInLowercase),$v_1=this.$2_3[seriesId],$v_2=true;if(oldChartTypeGroup==="Incompatible"||$v_0==="Incompatible")$v_2=this.changePresentationXml($v_1,$v_0,chartTypeToApplyInLowercase);this.$9_3=$v_0;if($v_2){var $v_3=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/Series",null),$v_4=XUI.Xml.LoadXml(chartTypeItem.$1g_0),$v_5=Mscrm.Utilities.getAdoptedNode(this._currentPresentationXml,$v_4.documentElement),$v_6=$v_3.insertBefore($v_5,$v_1.$7_1),$v_7=$v_1.$7_1.attributes.getNamedItem("YAxisType");!IsNull($v_7)&&$v_7.value==="Secondary"&&$v_6.attributes.setNamedItem($v_7.cloneNode(true));$v_3.removeChild($v_1.$7_1);$v_1.$7_1=$v_6;seriesId===this.get_firstSeriesId()&&this.updatePresXmlColorPalette(chartTypeItem.$1O_0)}},updatePresXmlColorPalette:function(newColorPalette){var $v_0=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart",null);if(!IsNull($v_0)){var $v_1=this._currentPresentationXml.createAttribute("PaletteCustomColors");$v_1.value=newColorPalette;$v_0.attributes.setNamedItem($v_1)}},changePresentationXml:function(chartNode,groupOfChartTypeToApply,chartTypeToApplyInLowercase){var $v_0=false;if(groupOfChartTypeToApply==="Incompatible"){if(chartTypeToApplyInLowercase==="pie")this._currentPresentationXml=XUI.Xml.LoadXml(' <Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ShadowOffset="0" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PieLabelStyle=Inside, PieDrawingStyle=Default" ChartType="pie"><SmartLabelStyle Enabled="True" /></Series></Series><ChartAreas><ChartArea><Area3DStyle Enable3D="false"/></ChartArea></ChartAreas><Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="0, 0, 0"></Title></Titles></Chart>');else if(chartTypeToApplyInLowercase==="funnel")this._currentPresentationXml=XUI.Xml.LoadXml('<Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ShadowOffset="0" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" ChartType="Funnel" CustomProperties="FunnelLabelStyle=Outside, FunnelNeckHeight=0, FunnelPointGap=1, FunnelNeckWidth=5 "><SmartLabelStyle Enabled="True" /></Series></Series><ChartAreas><ChartArea><Area3DStyle Enable3D="false"/></ChartArea></ChartAreas><Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="0, 0, 0"></Title></Titles></Chart>')}else{this._currentPresentationXml=XUI.Xml.LoadXml('<Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series></Series><ChartAreas><ChartArea BorderColor="White" BorderDashStyle="Solid"><AxisY LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorGrid LineColor="239, 242, 246" /><MajorTickMark LineColor="165, 172, 181" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisY><AxisX LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorTickMark LineColor="165, 172, 181" /><MajorGrid LineColor="Transparent" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisX></ChartArea></ChartAreas><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="59, 59, 59"></Title></Titles></Chart>');$v_0=true}var $v_1=XUI.Xml.SelectSingleNode(this._currentPresentationXml,"Chart/Series/Series",null);chartNode.$7_1=$v_1;return $v_0},updateDesignerUIOnChartTypeChange:function(oldChartTypeGroup,chartTypeToApply,seriesId){this.updateChartTypeIcon(chartTypeToApply,seriesId);this.swapLabelsIfRequired(oldChartTypeGroup);if(this.$9_3==="Incompatible")Mscrm.VisualizationPane.enableDisableAddButtons(false);else oldChartTypeGroup==="Incompatible"&&Mscrm.VisualizationPane.enableDisableAddButtons(true);refreshRibbon()},updateChartTypeIcon:function(chartType,seriesId){var $v_0=$get(Mscrm.VisualizationPane.$0("chartTypeImage",seriesId));if(!IsNull($v_0)){var $v_1=this.$3_3[chartType.toLowerCase()];if(IsNull($v_1))$v_1=this.$3_3["column"];var $v_2=Mscrm.VisualizationPane.addOrRemoveSuffixInPath($v_1.$1f_0,"_dis",this._isComplexChart);Mscrm.ImageStrip.changeImage($v_0,$v_2);$v_0.setAttribute("imgBase",$v_2);$v_0.title=String.format(window.LOCID_CHART_ICON_TOOLTIP,$v_1.$1Y_0);$v_0.alt=$v_0.title}},canApplyChartType:function(chartTypeToApply){var $v_0=false,$v_1=this.$3_3[chartTypeToApply.toLowerCase()];if(!IsNull($v_1)&&!this._isComplexChart){var $v_2=$v_1.$15_0;if((this.get_seriesCount()<=1||$v_2===this.$9_3)&&(this.get_categoryCount()<=1||$v_2!=="Incompatible"))$v_0=true}return $v_0},isTopBottomEnabledForSelectedSeries:function(){return this.isTopBottomEnabled(this.$2_3[this.$8_3])},isTopBottomEnabled:function(seriesItem){var $v_0=false;if(!this._isComplexChart&&this.get_seriesCount()>=1&&this.get_categoryCount()<=1&&this.$2G_3(seriesItem))$v_0=true;return $v_0},confirmCloseDesigner:function(){if(this.isDesignerPaneDirty())return confirm(window.LOCID_VPD_CLOSEWARNING);return true},assignVisualization:function(){this.showVisualizationPane();var $v_0=[this.get_visualizationId()],$v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_assign.aspx");$v_1.get_query()["iObjType"]=this.get_visualizationType();$v_1.get_query()["iTotal"]="1";var $v_2=new Mscrm.CrmDialog($v_1,$v_0,456,310,null);$v_2.setCallbackInfo("performActionAfterAssignVisualization",this,null);$v_2.show()},performActionAfterAssignVisualization:function(result){if(!IsNull(result)&&result){this.loadVisualizationsForCurrentView();this.loadVisualization(false)}},shareVisualizations:function(){this.showVisualizationPane();var $v_0=[this.get_visualizationId()],$v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_share.aspx");$v_1.get_query()["iObjType"]=this.get_visualizationType();$v_1.get_query()["iTotal"]="1";var $v_2=new Mscrm.CrmDialog($v_1,$v_0,800,600,null);$v_2.show()},saveVisualization:function(){this.saveChart(false)},saveAndCloseVisualization:function(){this.saveChart(false,true)},get_isTopBottomAppended:function(){return this.$j_3},get_isTopAppended:function(){return this.$16_3},get_idOfSeriesWithTopBottomApplied:function(){return this.$V_3},get_topBottomCount:function(){var $v_0=null;$v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch",null);var $v_1=$v_0.attributes.getNamedItem("count");return $v_1?Number.parseInvariant($v_1.value):0},$1m_3:function(){var $v_0=false,$v_1=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch",null),$v_2=$v_1.attributes.getNamedItem("count"),$v_3=this.get_$1W_3();if(!IsNull($v_2)&&!IsNull($v_3)){$v_1.attributes.removeNamedItem("count");$v_3.parentNode.removeChild($v_3);$v_0=true}return $v_0},$1r_3:function(){this.$j_3=false;this.$16_3=false;this.$V_3="-1"},$2N_3:function($p0,$p1){this.$j_3=true;this.$16_3=$p0;this.$V_3=$p1},$2U_3:function($p0,$p1,$p2){if(!isNullOrEmptyString($p1)){var $v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"//order[@alias='"+$p1+"']",null);if(!IsNull($v_0)){var $v_1=$v_0.attributes.getNamedItem("descending");$v_1.value=$p2?"true":"false"}else{$v_0=this._currentDataXml.createElement("order");var $v_2=this._currentDataXml.createAttribute("alias");$v_2.value=$p1;$v_0.attributes.setNamedItem($v_2);var $v_3=this._currentDataXml.createAttribute("descending");$v_3.value=$p2?"true":"false";$v_0.attributes.setNamedItem($v_3)}if(!IsNull($p0)){var $v_4=$p0.parentNode;$v_4.insertBefore($v_0,XUI.Xml.DomUtils.GetFirstChild($v_4))}}},$2x_3:function($p0){var $v_0=null;if(!isNullOrEmptyString($p0)){$v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"//order[@alias='"+$p0+"']",null);!IsNull($v_0)&&$v_0.parentNode.removeChild($v_0)}},get_$1W_3:function(){var $v_0=null,$v_1=XUI.Xml.SelectSingleNode(this._currentDataXml,"//fetch",null).attributes.getNamedItem("count");if(!IsNull($v_1)){$v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"//entity/order",null);if(IsNull($v_0))$v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"//order",null);if(!IsNull($v_0)){var $v_2=$v_0.attributes.getNamedItem("alias");if(!IsNull($v_2)){var $v_3=XUI.Xml.GetText($v_2);if(IsNull(XUI.Xml.SelectSingleNode(this._currentDataXml,"//measure[@alias='"+$v_3+"']",null)))$v_0=null}else $v_0=null}}return $v_0},$2G_3:function($p0){var $v_0=$p0.$G_0.parentNode,$v_1=XUI.Xml.SelectNodes($v_0,".//order",null).length,$v_2=XUI.Xml.SelectNodes(this._currentDataXml,"//order",null),$v_3=$v_2.length,$v_4=this.get_$1W_3();if(!IsNull($v_4)){$v_3--;$v_4=$v_4.parentNode;do if($v_4===$v_0){$v_1--;break}else $v_4=$v_4.parentNode;while(!IsNull($v_4)&&$v_4.nodeName!=="fetch")}if($v_1!==$v_3)return false;else return true},clearTopBottom:function(){var $v_0=this.$1m_3();if($v_0){this.$A_3=true;this.$1X_3(this.$V_3,Mscrm.VisualizationPane.INVALIDINDEX.toString(),false,-1);this.$1r_3();Mscrm.VisualizationPane.hideInlineActionMenus();this.checkAndPreviewChart(false)}},appendTopBottom:function(number,isTop,isInlineAction,updatePreview){if(isNullOrEmptyString(number))return;this.$1m_3();var $v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"datadefinition/fetchcollection/fetch/entity",null),$v_1=$v_0.parentNode,$v_2=isInlineAction?this.$H_3:this.$8_3,$v_3=this.$2_3[$v_2],$v_4=$v_3.$G_0,$v_5=$v_3.$M_0;this.$2U_3($v_4,$v_5,isTop);var $v_6=$v_1.attributes.getNamedItem("count");if(!IsNull($v_6))$v_6.value=number;else{var $v_7=this._currentDataXml.createAttribute("count");$v_7.value=number;$v_1.attributes.setNamedItem($v_7)}this.$1X_3(this.$V_3,$v_2,isTop,Number.parseInvariant(number));this.$2N_3(isTop,$v_2);Mscrm.VisualizationPane.hideInlineActionMenus();this.$A_3=true;updatePreview&&this.checkAndPreviewChart(false)},appendTopBottomCustom:function(isTop,isInlineAction){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){var $v_1="/Visualization/cmds/dlg_TopBottom.aspx",$v_2=Mscrm.CrmUri.create($v_1);$v_2.get_query()["isTop"]=isTop;$v_2.get_query()["count"]=$v_0.get_topBottomCount()?$v_0.get_topBottomCount():3;var $v_3=true,$v_4=[isTop,isInlineAction,$v_3],$v_5=new Mscrm.CrmDialog($v_2,null,450,225,null);$v_5.setCallbackInfo("appendTopBottom",this,$v_4);$v_5.show()}},updateTopBottomInfo:function(alias,seriesId){if(!this.$j_3){var $v_0=XUI.Xml.SelectSingleNode(this._currentDataXml,"//fetch",null),$v_1=$v_0.attributes.getNamedItem("count"),$v_2=XUI.Xml.SelectSingleNode($v_0,String.format("//order[@alias='{0}']",alias),null),$v_3=this.get_$1W_3();if(!IsNull($v_2)&&!IsNull($v_1)&&!IsNull($v_3)&&$v_3.attributes.getNamedItem("alias")===$v_2.attributes.getNamedItem("alias")){var $v_4=Boolean.parse($v_2.attributes.getNamedItem("descending").value),$v_5=Number.parseInvariant($v_1.value);this.$2N_3($v_4,seriesId);this.$1X_3(Mscrm.VisualizationPane.INVALIDINDEX.toString(),seriesId,$v_4,$v_5)}}}};Mscrm.ChartNodeItem=function(node,alias,isDummy){this.$G_0=node;this.$M_0=alias;this.$L_0=!isDummy};Mscrm.ChartNodeItem.prototype={$G_0:null,$M_0:null,$L_0:false,get_xmlNode:function(){return this.$G_0},set_xmlNode:function(value){this.$G_0=value;return value},get_alias:function(){return this.$M_0},set_alias:function(value){this.$M_0=value;return value},get_isReadyForUse:function(){return this.$L_0},set_isReadyForUse:function(value){this.$L_0=value;return value}};Mscrm.YChartNodeItem=function(node,alias,measureNode,presentationXmlSeriesNode,isDummy){Mscrm.YChartNodeItem.initializeBase(this,[node,alias,isDummy]);this.$m_1=measureNode;this.$7_1=presentationXmlSeriesNode};Mscrm.YChartNodeItem.prototype={$m_1:null,$7_1:null,get_presentationXmlSeriesNode:function(){return this.$7_1},set_presentationXmlSeriesNode:function(value){this.$7_1=value;return value},get_measureNode:function(){return this.$m_1},set_measureNode:function(value){this.$m_1=value;return value}};Mscrm.ChartType=function(name,colorPalette,seriesNodeTemplate,group,topImageSource,bottomImageSource,bottomImageDisplay,topImagePosition,seriesIconSource,displayName){this.$1u_0=name;this.$15_0=group;this.$1O_0=colorPalette;this.$1g_0=seriesNodeTemplate;this.$1R_0=topImageSource;this.$1I_0=bottomImageSource;this.$1H_0=bottomImageDisplay;this.$1Q_0=topImagePosition;this.$1f_0=seriesIconSource;this.$1Y_0=displayName};Mscrm.ChartType.prototype={$1u_0:null,$15_0:null,$1O_0:null,$1g_0:null,$1R_0:null,$1I_0:null,$1H_0:null,$1Q_0:null,$1f_0:null,$1Y_0:null,get_name:function(){return this.$1u_0},get_group:function(){return this.$15_0},get_presentationXmlColorPalette:function(){return this.$1O_0},get_seriesNodeTemplate:function(){return this.$1g_0},get_topImageSource:function(){return this.$1R_0},get_bottomImageSource:function(){return this.$1I_0},get_bottomImageDisplay:function(){return this.$1H_0},get_topImagePosition:function(){return this.$1Q_0},get_seriesIconSource:function(){return this.$1f_0},get_displayName:function(){return this.$1Y_0}};Mscrm.ChartTypePopup=function(element){Mscrm.ChartTypePopup.initializeBase(this,[element])};Mscrm.ChartTypePopup.prototype={MenuItemClicked:function(eventCode,parameters){var $v_0=parameters["menuitem"];if(!IsNull($v_0)){var $v_1=$v_0.get_menuItemId(),$v_2=$v_1.split("_MI")[1].toLowerCase();Mscrm.VisualizationPane.applyChartTypeInline($v_2)}}};Mscrm.TopBottomPopup=function(element){Mscrm.TopBottomPopup.initializeBase(this,[element])};Mscrm.TopBottomPopup.prototype={MenuItemClicked:function(eventCode,parameters){var $v_0=parameters["menuitem"];if(!IsNull($v_0)){var $v_1=$v_0.get_menuItemId(),$v_2=$v_1.split("_MI")[1].toLowerCase();Mscrm.VisualizationPane.applyTopBottomInline($v_2)}}};Mscrm.InlinePopup=function(element){this.$$d_menuHidden=Function.createDelegate(this,this.menuHidden);this.$$d_MenuItemClicked=Function.createDelegate(this,this.MenuItemClicked);this.$$d_$2u_3=Function.createDelegate(this,this.$2u_3);Mscrm.InlinePopup.initializeBase(this,[element]);this._thisElement=element};Mscrm.InlinePopup.prototype={xmlString:null,menu:null,_thisElement:null,get_menuXml:function(){return this.xmlString},set_menuXml:function(value){this.xmlString=value;return value},dispose:function(){if(this.get_isDisposed())return;this.menu.dispose();$removeHandler(this._thisElement,"click",this.$$d_$2u_3);Mscrm.CrmUIControl.prototype.dispose.call(this)},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.constructMenu()},constructMenu:function(){this.menu=new Mscrm.Popup(this.$$d_MenuItemClicked);this.menu.set_menuXml(XUI.Xml.LoadXml(this.xmlString));$addHandler(this._thisElement,"click",this.$$d_$2u_3)},$2u_3:function($p0){$p0.preventDefault();$p0.stopPropagation();!$p0.target.disabled&&this.$2r_3(this._thisElement)},$2r_3:function($p0){var $v_0=$get("crmContentPanel");if(IsNull($v_0))$v_0=document.body;var $v_1=Mscrm.Utilities.getXYPos(this._thisElement,window.LOCID_UI_DIR==="RTL",$v_0),$v_2=$v_1["y"]+$p0.offsetParent.offsetHeight,$v_3=$v_1["x"];this.$35_3($v_3,$v_2,$v_0)},$35_3:function($p0,$p1,$p2){if(IsNull(this.menu.get_currentMenu())){this.menu.set_currentMenu(this.$2Y_3($p0,$p1,$p2));this.menu.populateFilterMenu(this.xmlString)}else{this.menu.get_currentMenu().clear();this.menu.populateFilterMenu(this.xmlString)}this.menu.get_currentMenu().set_stylePrefix(Mscrm.MenuStyles.contextMenuStylePrefix);this.menu.get_currentMenu().set_propagateStyle(false);for(var $v_0=0;$v_0<this.menu.get_currentMenu().get_menuItems().length;$v_0++)if(!this.menu.get_currentMenu().get_menuItems()[$v_0].get_itemContents().disabled&&this.menu.get_currentMenu().get_menuItems()[$v_0].get_actionCallback()){this.menu.get_currentMenu().set_focusElementOnShow(this.menu.get_currentMenu().get_menuItems()[$v_0].get_itemContents());$v_0=this.menu.get_currentMenu().get_menuItems().length}this.menu.get_currentMenu().set_left($p0);this.menu.get_currentMenu().set_top($p1);this.menu.get_currentMenu().show()},$2Y_3:function($p0,$p1,$p2){var $v_0=Mscrm.Menu.createMenuForParentElement($p2);!IsNull(this._thisElement.attributes.getNamedItem("menu"))&&$v_0.set_menuId(this._thisElement.attributes.getNamedItem("menu").value);$v_0.set_stylePrefix(Mscrm.MenuStyles.viewSelectorStylePrefix);$v_0.set_propagateStyle(false);$v_0.set_left($p0);$v_0.set_top($p1);$v_0.set_width(284);$v_0.set_hideCallback(this.$$d_menuHidden);$v_0.set_shiftVertical(false);return $v_0},menuHidden:function(menuParameter){this.menu.get_currentMenu().clearDOM()},MenuItemClicked:function(eventCode,parameters){}};Mscrm.PaneLocation=function(){};Mscrm.ChartTypes=function(){};Mscrm.ToolBarMode=function(){};Mscrm.DrillDownParameter=function(){this.$E_0=[]};Mscrm.DrillDownParameter.prototype={$T_0:null,$e_0:null,$v_0:null,$10_0:null,$w_0:null,$g_0:null,$d_0:null,$a_0:null,$U_0:null,$x_0:null,$z_0:null,$y_0:null,$l_0:null,$P_0:null,$O_0:null,$X_0:null,$b_0:null,$N_0:null,$Z_0:null,$s_0:null,$r_0:null,$R_0:null,$Q_0:null,$u_0:null,$q_0:null,$Y_0:null,$t_0:null,$18_0:null,$1A_0:null,get_secondaryGroupByRelatedEntityDetail:function(){return this.$t_0},set_secondaryGroupByRelatedEntityDetail:function(value){this.$t_0=value;return value},get_isSecondaryGroupByRelatedEntityColumn:function(){return this.$Y_0},set_isSecondaryGroupByRelatedEntityColumn:function(value){this.$Y_0=value;return value},get_secondaryGroupByEntityName:function(){return this.$s_0},set_secondaryGroupByEntityName:function(value){this.$s_0=value;return value},get_secondaryGroupByColumnType:function(){return this.$r_0},set_secondaryGroupByColumnType:function(value){this.$r_0=value;return value},get_secondaryGroupByName:function(){return this.$Z_0},set_secondaryGroupByName:function(value){this.$Z_0=value;return value},get_primaryGroupByStartDate:function(){return this.$P_0},set_primaryGroupByStartDate:function(value){this.$P_0=value;return value},get_primaryGroupByEndDate:function(){return this.$O_0},set_primaryGroupByEndDate:function(value){this.$O_0=value;return value},get_secondaryGroupByStartDate:function(){return this.$R_0},set_secondaryGroupByStartDate:function(value){this.$R_0=value;return value},get_secondaryGroupByEndDate:function(){return this.$Q_0},set_secondaryGroupByEndDate:function(value){this.$Q_0=value;return value},get_viewBy:function(){return this.$w_0},set_viewBy:function(value){this.$w_0=value;return value},get_chartType:function(){return this.$e_0},set_chartType:function(value){this.$e_0=value;return value},get_x1Value:function(){return this.$a_0},set_x1Value:function(value){this.$a_0=value;return value},get_x2Value:function(){return this.$b_0},set_x2Value:function(value){this.$b_0=value;return value},get_formattedXValue:function(){return this.$U_0},set_formattedXValue:function(value){this.$U_0=value;return value},get_formattedX2Value:function(){return this.$N_0},set_formattedX2Value:function(value){this.$N_0=value;return value},get_seriesIndex:function(){return this.$v_0},set_seriesIndex:function(value){this.$v_0=value;return value},get_yColumnName:function(){return this.$10_0},set_yColumnName:function(value){this.$10_0=value;return value},get_filterFetchXml:function(){return this.$g_0},set_filterFetchXml:function(value){this.$g_0=value;return value},get_aggregationFetchXml:function(){return this.$d_0},set_aggregationFetchXml:function(value){this.$d_0=value;return value},get_xAttributeName:function(){return this.$x_0},set_xAttributeName:function(value){this.$x_0=value;return value},get_xEntityName:function(){return this.$z_0},set_xEntityName:function(value){this.$z_0=value;return value},get_xAttributeType:function(){return this.$y_0},set_xAttributeType:function(value){this.$y_0=value;return value},get_lookupAttributeString:function(){return this.$l_0},set_lookupAttributeString:function(value){this.$l_0=value;return value},get_secondaryXLookupAttributeString:function(){return this.$u_0},set_secondaryXLookupAttributeString:function(value){this.$u_0=value;return value},get_isRelatedEntityColumn:function(){return this.$X_0},set_isRelatedEntityColumn:function(value){this.$X_0=value;return value},get_filterIdsArray:function(){return this.$E_0},set_filterIdsArray:function(value){this.$E_0=value;return value},get_chartTitle:function(){return this.$T_0},set_chartTitle:function(value){this.$T_0=value;return value},get_relatedEntityDetail:function(){return this.$q_0},set_relatedEntityDetail:function(value){this.$q_0=value;return value},get_primaryGroupByAlias:function(){return this.$18_0},set_primaryGroupByAlias:function(value){this.$18_0=value;return value},get_secondaryGroupByAlias:function(){return this.$1A_0},set_secondaryGroupByAlias:function(value){this.$1A_0=value;return value},clone:function(){for(var $v_0=new Mscrm.DrillDownParameter,$v_1=0;$v_1<this.$E_0.length;++$v_1)Array.add($v_0.$E_0,this.$E_0[$v_1]);$v_0.$T_0=this.$T_0;$v_0.$e_0=this.$e_0;$v_0.$v_0=this.$v_0;$v_0.$10_0=this.$10_0;$v_0.$w_0=this.$w_0;$v_0.$d_0=this.$d_0;$v_0.$g_0=this.$g_0;$v_0.$a_0=this.$a_0;$v_0.$U_0=this.$U_0;$v_0.$x_0=this.$x_0;$v_0.$z_0=this.$z_0;$v_0.$y_0=this.$y_0;$v_0.$l_0=this.$l_0;$v_0.$P_0=this.$P_0;$v_0.$O_0=this.$O_0;$v_0.$X_0=this.$X_0;$v_0.$b_0=this.$b_0;$v_0.$N_0=this.$N_0;$v_0.$Z_0=this.$Z_0;$v_0.$s_0=this.$s_0;$v_0.$r_0=this.$r_0;$v_0.$R_0=this.$R_0;$v_0.$Q_0=this.$Q_0;$v_0.$u_0=this.$u_0;$v_0.$q_0=this.$q_0;$v_0.$Y_0=this.$Y_0;$v_0.$t_0=this.$t_0;$v_0.$18_0=this.$18_0;$v_0.$1A_0=this.$1A_0;return $v_0},clear:function(){this.$E_0=[];this.$T_0=null;this.$e_0=null;this.$v_0=null;this.$10_0=null;this.$w_0=null;this.$d_0=null;this.$g_0=null;this.$a_0=null;this.$U_0=null;this.$x_0=null;this.$z_0=null;this.$y_0=null;this.$l_0=null;this.$P_0=null;this.$O_0=null;this.$X_0=null;this.$b_0=null;this.$N_0=null;this.$Z_0=null;this.$s_0=null;this.$r_0=null;this.$R_0=null;this.$Q_0=null;this.$u_0=null;this.$q_0=null;this.$Y_0=null;this.$t_0=null}};Mscrm.MultiLevelDrillDownParameters=function(){this.$6_0=-1;this.$1N_0=[]};Mscrm.MultiLevelDrillDownParameters.prototype={$1N_0:null,$6_0:0,get_count:function(){return this.$6_0},add:function(obj){this.$6_0++;this.$1N_0[this.$6_0]=obj},remove:function(){if(this.$6_0>=0){this.$1N_0[this.$6_0]=null;this.$6_0--}},getAtIndex:function(index){if(index>=0)return this.$1N_0[index];else return null}};Mscrm.VisualizationPaneRenderingModes=function(){};Mscrm.ChartTypeGroups=function(){};Mscrm.AttributeType=function(){};Mscrm.AggregateType=function(){};Mscrm.VisualizationPane.registerClass("Mscrm.VisualizationPane",Mscrm.CrmUIControl);Mscrm.ChartNodeItem.registerClass("Mscrm.ChartNodeItem");Mscrm.YChartNodeItem.registerClass("Mscrm.YChartNodeItem",Mscrm.ChartNodeItem);Mscrm.ChartType.registerClass("Mscrm.ChartType");Mscrm.InlinePopup.registerClass("Mscrm.InlinePopup",Mscrm.CrmUIControl);Mscrm.ChartTypePopup.registerClass("Mscrm.ChartTypePopup",Mscrm.InlinePopup);Mscrm.TopBottomPopup.registerClass("Mscrm.TopBottomPopup",Mscrm.InlinePopup);Mscrm.PaneLocation.registerClass("Mscrm.PaneLocation");Mscrm.ChartTypes.registerClass("Mscrm.ChartTypes");Mscrm.ToolBarMode.registerClass("Mscrm.ToolBarMode");Mscrm.DrillDownParameter.registerClass("Mscrm.DrillDownParameter");Mscrm.MultiLevelDrillDownParameters.registerClass("Mscrm.MultiLevelDrillDownParameters");Mscrm.VisualizationPaneRenderingModes.registerClass("Mscrm.VisualizationPaneRenderingModes");Mscrm.ChartTypeGroups.registerClass("Mscrm.ChartTypeGroups");Mscrm.AttributeType.registerClass("Mscrm.AttributeType");Mscrm.AggregateType.registerClass("Mscrm.AggregateType");Mscrm.VisualizationPane.dashboardEnlargeContainerId="formBodyContainer";Mscrm.VisualizationPane.greyOutOverlappingIframeId="greyOutOverlappingIframe";Mscrm.VisualizationPane.greyOutDivId="greyOutDiv";Mscrm.VisualizationPane.greyOutClass="ms-crm-visualizationpane-greyout";Mscrm.VisualizationPane.closeEnlargeButtonId="closeEnlargeButton";Mscrm.VisualizationPane.enlargeClass="ms-crm-visualizationpane-enlarge";Mscrm.VisualizationPane.closeEnlargeOverlappingIframeId="closeEnlargeOverlappingIframe";Mscrm.VisualizationPane.toolBarScrollBarOffsetClass="ms-crm-visualizationpane-toolbar-scrollbar-offset";Mscrm.VisualizationPane.top="Top";Mscrm.VisualizationPane.bottom="Bottom";Mscrm.VisualizationPane.DATETIME="DATETIME";Mscrm.VisualizationPane.YATTRIBUTESELECTORID="yAttributeSelector1";Mscrm.VisualizationPane.YATTRIBUTESELECTORIDPREFIX="yAttributeSelector";Mscrm.VisualizationPane.NAMETEXTBOXID="chartNameInput";Mscrm.VisualizationPane.DESCTEXTAREAID="visualizationDescription";Mscrm.VisualizationPane.ATTRIBUTETYPEFIELD="type";Mscrm.VisualizationPane.VALUEFIELD="value";Mscrm.VisualizationPane.DEFAULTYALIAS="_CRMAutoGen_aggregate_column_Num_";Mscrm.VisualizationPane.DEFAULTXALIAS="_CRMAutoGen_groupby_column_Num_";Mscrm.VisualizationPane.DATEGROUPINGATTRIBUTE="dategrouping";Mscrm.VisualizationPane.DEFAULTDATEGROUP="month";Mscrm.VisualizationPane.INITIALAGGREGATEVALUE="Aggregate";Mscrm.VisualizationPane.CHARTTYPEBOXID="chartTypeBox";Mscrm.VisualizationPane.TOPBOTTOMBOXID="topBottomBox";Mscrm.VisualizationPane.DATAXMLTEMPLATE="<datadefinition><fetchcollection><fetch mapping='logical' aggregate='true'><entity name='entity_placeholder'><attribute name='x_placeholder' groupby='true' alias='{0}'/><attribute name='y_placeholder' aggregate='count' alias='{1}'/></entity></fetch></fetchcollection><categorycollection><category><measurecollection><measure alias='{1}'/></measurecollection></category></categorycollection></datadefinition>";Mscrm.VisualizationPane.axisY2STRING='<AxisY2 LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"> <MajorGrid LineColor="239, 242, 246" /> <MajorTickMark LineColor="165, 172, 181" /> <LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /> </AxisY2>';Mscrm.VisualizationPane.LEGENDSTRING='<Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends>';Mscrm.VisualizationPane.YAXISTYPE="YAxisType";Mscrm.VisualizationPane.SECONDARY="Secondary";Mscrm.VisualizationPane.kDefaultChartPresentationTemplate='<Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series></Series><ChartAreas><ChartArea BorderColor="White" BorderDashStyle="Solid"><AxisY LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorGrid LineColor="239, 242, 246" /><MajorTickMark LineColor="165, 172, 181" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisY><AxisX LabelAutoFitMinFontSize="8" TitleForeColor="59, 59, 59" TitleFont="{0}, 10.5px" LineColor="165, 172, 181" IntervalAutoMode="VariableCount"><MajorTickMark LineColor="165, 172, 181" /><MajorGrid LineColor="Transparent" /><LabelStyle Font="{0}, 10.5px" ForeColor="59, 59, 59" /></AxisX></ChartArea></ChartAreas><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="59, 59, 59"></Title></Titles></Chart>';Mscrm.VisualizationPane.kPieChartTemplate=' <Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ShadowOffset="0" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PieLabelStyle=Inside, PieDrawingStyle=Default" ChartType="pie"><SmartLabelStyle Enabled="True" /></Series></Series><ChartAreas><ChartArea><Area3DStyle Enable3D="false"/></ChartArea></ChartAreas><Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="0, 0, 0"></Title></Titles></Chart>';Mscrm.VisualizationPane.kFunnelChartTemplate='<Chart Palette="None" PaletteCustomColors="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;"><Series><Series ShadowOffset="0" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" ChartType="Funnel" CustomProperties="FunnelLabelStyle=Outside, FunnelNeckHeight=0, FunnelPointGap=1, FunnelNeckWidth=5 "><SmartLabelStyle Enabled="True" /></Series></Series><ChartAreas><ChartArea><Area3DStyle Enable3D="false"/></ChartArea></ChartAreas><Legends><Legend Alignment="Center" LegendStyle="Table" Docking="right" IsEquallySpacedItems="True" Font="{0}, 11px" ShadowColor="0, 0, 0, 0" ForeColor="59, 59, 59" /></Legends><Titles><Title Alignment="TopLeft" DockingOffset="-3" Font="{0}, 13px" ForeColor="0, 0, 0"></Title></Titles></Chart>';Mscrm.VisualizationPane.kColorPaletteOne="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;";Mscrm.VisualizationPane.kColorPaletteTwo="91,151,213; 237,125,49; 160,116,166; 255,192,0; 68,114,196; 112,173,71; 37,94,145; 158,72,14; 117,55,125; 153,115,0; 38,68,120; 67,104,43; 124,175,221; 241,151,90; 186,144,192; 255,205,51; 105,142,208; 140,193,104; 50,125,194; 210,96,18; 150,83,159; 204,154,0; 51,90,161; 90,138,57;";Mscrm.VisualizationPane.COLUMNSERIESTEMPLATE='<Series ChartType="Column" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.STACKEDCOLUMNSERIESTEMPLATE='<Series ChartType="StackedColumn" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.stackedcolumN100SERIESTEMPLATE='<Series ChartType="StackedColumn100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.BARSERIESTEMPLATE='<Series ChartType="Bar" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>';Mscrm.VisualizationPane.STACKEDBARSERIESTEMPLATE='<Series ChartType="StackedBar" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>';Mscrm.VisualizationPane.stackedbaR100SERIESTEMPLATE='<Series ChartType="StackedBar100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"><SmartLabelStyle Enabled="True"/></Series>';Mscrm.VisualizationPane.AREASERIESTEMPLATE='<Series ChartType="Area" IsValueShownAsLabel="True" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.STACKEDAREASERIESTEMPLATE='<Series ChartType="StackedArea" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.stackedareA100SERIESTEMPLATE='<Series ChartType="StackedArea100" Font="{0}, 9.5px" LabelForeColor="59, 59, 59" CustomProperties="PointWidth=0.75, MaxPixelPointWidth=40"></Series>';Mscrm.VisualizationPane.LINESERIESTEMPLATE='<Series ChartType="Line" IsValueShownAsLabel="True" BorderWidth="3" MarkerStyle="Square" MarkerSize="9" MarkerColor="37, 128, 153" MarkerBorderColor="37, 128, 153"></Series>';Mscrm.VisualizationPane.white="#ffffff";Mscrm.VisualizationPane.silver="#e6e6e6";Mscrm.VisualizationPane.defaultTextBoxValue="3";Mscrm.VisualizationPane.vizLoadDelayMS=500;Mscrm.VisualizationPane.currentVizLoadDelay=0;Mscrm.VisualizationPane.timeOutID=0;Mscrm.VisualizationPane.INVALIDINDEX=-1;Mscrm.VisualizationPane.defaultTopBottomValue=3;Mscrm.PaneLocation.inline="0";Mscrm.PaneLocation.newWindow="1";Mscrm.ChartTypes.barChart="bar";Mscrm.ChartTypes.stackedBarChart="stackedbar";Mscrm.ChartTypes.stackedBar100Chart="stackedbar100";Mscrm.ChartTypes.columnChart="column";Mscrm.ChartTypes.stackedColumnChart="stackedcolumn";Mscrm.ChartTypes.stackedColumn100Chart="stackedcolumn100";Mscrm.ChartTypes.areaChart="area";Mscrm.ChartTypes.stackedAreaChart="stackedarea";Mscrm.ChartTypes.stackedArea100Chart="stackedarea100";Mscrm.ChartTypes.pieChart="pie";Mscrm.ChartTypes.lineChart="line";Mscrm.ChartTypes.funnelChart="funnel";Mscrm.ToolBarMode.top="0";Mscrm.ToolBarMode.right="1";Mscrm.ToolBarMode.topFit="2";Mscrm.ToolBarMode.rightFit="3";Mscrm.VisualizationPaneRenderingModes.RuntimeMode=0;Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode=1;Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode=2;Mscrm.ChartTypeGroups.lineColumnArea="LineColumnArea";Mscrm.ChartTypeGroups.bar="Bar";Mscrm.ChartTypeGroups.incompatible="Incompatible";Mscrm.AttributeType.picklist="picklist";Mscrm.AttributeType.owner="owner";Mscrm.AttributeType.date="date";Mscrm.AttributeType.dateTime="datetime";Mscrm.AttributeType.nVarchar="nvarchar";Mscrm.AttributeType.customer="customer";Mscrm.AttributeType.lookup="lookup";Mscrm.AttributeType.money="money";Mscrm.AttributeType.integer="int";Mscrm.AttributeType.floatAttribute="float";Mscrm.AttributeType.decimalAttribute="decimal";Mscrm.AggregateType.none="none";Mscrm.AggregateType.count="count";Mscrm.AggregateType.countColumn="countcolumn";Mscrm.AggregateType.sum="sum";Mscrm.AggregateType.avg="avg";Mscrm.AggregateType.min="min";Mscrm.AggregateType.max="max"