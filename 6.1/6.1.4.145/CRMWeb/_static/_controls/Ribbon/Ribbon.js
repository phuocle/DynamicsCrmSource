if(typeof IEnumerator=="undefined"){var IEnumerator=function(){};IEnumerator.prototype={get_current:null,moveNext:null,reset:null};IEnumerator.registerInterface("IEnumerator")}if(typeof IEnumerable=="undefined"){var IEnumerable=function(){};IEnumerable.prototype={getEnumerator:null};IEnumerable.registerInterface("IEnumerable")}Type.registerNamespace("CUI");Type.registerNamespace("CUI.Page");if(typeof CUI.Page.PageComponent=="undefined"){CUI.Page.ICommandHandler=function(){};CUI.Page.ICommandHandler.registerInterface("CUI.Page.ICommandHandler");CUI.Page.PageComponent=function(){};CUI.Page.PageComponent.prototype={init:function(){},getGlobalCommands:function(){return null},getFocusedCommands:function(){return null},handleCommand:function(commandId,properties,sequence){return false},canHandleCommand:function(commandId){return false},isFocusable:function(){return false},receiveFocus:function(){return false},yieldFocus:function(){return true},getId:function(){return "PageComponent"}};CUI.Page.PageComponent.registerClass("CUI.Page.PageComponent",null,CUI.Page.ICommandHandler)}Type.registerNamespace("Mscrm");Mscrm.CommandInformation=function(){};Mscrm.ContextualGroupInfo=function(){};Mscrm.CrmClientType=function(){};Mscrm.CrmClientType.prototype={none:0,web:1,outlook:2};Mscrm.CrmClientType.registerEnum("Mscrm.CrmClientType",false);Mscrm.CrmOutlookClientType=function(){};Mscrm.CrmOutlookClientType.prototype={none:0,crmForOutlook:1,crmForOutlookOfflineAccess:2};Mscrm.CrmOutlookClientType.registerEnum("Mscrm.CrmOutlookClientType",false);Mscrm.OutlookRenderType=function(){};Mscrm.OutlookRenderType.prototype={none:0,web:1,outlook:2};Mscrm.OutlookRenderType.registerEnum("Mscrm.OutlookRenderType",false);Mscrm.OutlookVersion=function(){};Mscrm.OutlookVersion.prototype={none:0,version2003:1,version2007:2,version2010:3};Mscrm.OutlookVersion.registerEnum("Mscrm.OutlookVersion",false);Mscrm.CrmOfflineAccessState=function(){};Mscrm.CrmOfflineAccessState.prototype={none:0,online:1,offline:2};Mscrm.CrmOfflineAccessState.registerEnum("Mscrm.CrmOfflineAccessState",false);Mscrm.CommandBarBase=function(element){this.$$d_onKeyDown=Function.createDelegate(this,this.onKeyDown);this.$$d_onUnHoverHandler=Function.createDelegate(this,this.onUnHoverHandler);this.$$d_onHoverHandler=Function.createDelegate(this,this.onHoverHandler);this.$$d_onClickHandler=Function.createDelegate(this,this.onClickHandler);Mscrm.CommandBarBase.initializeBase(this,[element]);this.$1j_3=element};Mscrm.CommandBarBase.prototype={initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$3K_3=this.$$d_onClickHandler;this.$3q_3=this.$$d_onHoverHandler;this.$3r_3=this.$$d_onUnHoverHandler;this.$5u_3=this.$$d_onKeyDown},dispose:function(){if(this.get_isDisposed())return;this.$3K_3=null;this.$3q_3=null;this.$3r_3=null;this.$5u_3=null;Sys.Application.unregisterDisposableObject(this);Mscrm.CrmUIControl.prototype.dispose.call(this)},attachEvents:function(element){$addHandler(element,"click",this.$3K_3);$addHandler(element,"mouseover",this.$3q_3);$addHandler(element,"mouseout",this.$3r_3);$addHandler(element,"keydown",this.$5u_3);$addHandler(element,"focus",this.$3q_3);$addHandler(element,"blur",this.$3r_3)},detachEvents:function(element){!IsNull(this.$3K_3)&&$removeHandler(element,"click",this.$3K_3);if(!IsNull(this.$3q_3)){$removeHandler(element,"mouseover",this.$3q_3);$removeHandler(element,"focus",this.$3q_3)}if(!IsNull(this.$3r_3)){$removeHandler(element,"mouseout",this.$3r_3);$removeHandler(element,"blur",this.$3r_3)}!IsNull(this.$5u_3)&&$removeHandler(element,"keydown",this.$5u_3)},get_currentElement:function(){return this.$1j_3},$1j_3:null,$5u_3:null,$3K_3:null,$3q_3:null,$3r_3:null};Mscrm.CommandBarMoreMenu=function(moreCommandListSelector,listTemplate,menuParentSelector,commandBar){Mscrm.CommandBarMoreMenu.initializeBase(this,[moreCommandListSelector,listTemplate,menuParentSelector,commandBar,null])};Mscrm.CommandBarMoreMenu.prototype={cacheContent:function(){Mscrm.CommandBarMenu.prototype.cacheContent.call(this);var $v_0=$P_CRM(this.$4h_0),$v_1=$v_0[0];!CUI.ScriptUtility.isNullOrUndefined($v_1)&&Mscrm.CommandBarMenu.prototype.get_commandBar.call(this).set_moreMenuContent($v_1.innerHTML)}};Mscrm.CommandBarMenu=function(listSelector,listTemplate,menuParentSelector,commandBar,parentMenu){this.$$d_handleFocus=Function.createDelegate(this,this.handleFocus);this.$$d_handleMouseHover=Function.createDelegate(this,this.handleMouseHover);this.$$d_flyOutKeyDown=Function.createDelegate(this,this.flyOutKeyDown);this.$$d_$CQ_0=Function.createDelegate(this,this.$CQ_0);this.$46_0=$P_CRM("<div class='ui-flyout-dialog-moreCommands'></div>");this.$Ce_0=listTemplate;this.$6D_0=menuParentSelector;this.$4h_0=listSelector;this.$N_0=commandBar;this.$1n_0=parentMenu;this.$5o_0=false;this.$8O_0=false};Mscrm.CommandBarMenu.prototype={$2d_0:false,$T_0:null,$1n_0:null,$2a_0:null,$1m_0:null,$Ce_0:"",$6A_0:false,$6D_0:"",$4h_0:"",$6I_0:null,$5o_0:false,$8O_0:false,get_listSelector:function(){return this.$4h_0},$4c_0:200,$Aq_0:10,$DE_0:null,$N_0:null,$8e_0:0,$Ay_0:0,get_commandBar:function(){if(!IsNull(this.$N_0))return this.$N_0;if(!IsNull(this.$1n_0))return this.$1n_0.get_commandBar();return null},get_flyOutWidth:function(){return this.$4c_0},get_flyOutMinHeight:function(){return this.$Aq_0},get_isFlyOutVisible:function(){return this.$2d_0},disposeMenu:function(){if(!IsNull(this.$2a_0)){this.$2a_0.disposeMenu();this.$2a_0=null}if(!IsNull(this.$T_0)&&!this.$5o_0){if(this.$6A_0){this.$T_0.hide();this.$T_0.dispose()}this.$5o_0=true}if(!IsNull(this.$1n_0))this.$1n_0=null;this.$6I_0=null;return},cacheContent:function(){return},processAndShowMenu:function(flyOutContent,commandData,isInMenu){this.$DE_0=commandData;this.initializeMenu();if(this.$2d_0){this.hideFlyout();this.$2d_0=false;return}this.createMenuCommandsPopup(flyOutContent);var $v_0=$get(this.$6D_0),$v_1=null;if(IsNull($v_0)){var $v_4=$get("crmContentPanel"),$v_5=$v_4.attributes.getNamedItem("currentContentId"),$v_6=null;if(!IsNull($v_5)&&$v_5.specified)$v_6=$get($v_5.value);if(!IsNull($v_6))$v_1=Mscrm.Utilities.getXYPos($v_6,window.LOCID_UI_DIR==="RTL");if(this.$6D_0.indexOf("ChartDesigner")>-1)$v_0=$get(this.$6D_0,commandData.$2X_2.getChartCommandBarNode(1));else $v_0=$get(this.$6D_0,commandData.$2X_2.getChartCommandBarNode(0))}var $v_2=$P_CRM($v_0);!IsNull($v_0)&&this.$E3_0($v_0,this.$T_0,isInMenu,$v_1);this.$6I_0=$v_0;this.$T_0.show($v_2,null);var $v_3=$P_CRM(this.$4h_0).children(":first-child");while($v_3.hasClass("ms-cui-menusection-title"))$v_3=$v_3.next();$v_3.addClass("menuSelected");$v_3.removeClass("menuUnselected");$P_CRM(this.$4h_0+" IMG").removeClass("menuUnselected");this.$2d_0=true;var $$t_A=this;window.setTimeout(function(){$v_3.find("a").focus()},0)},$E3_0:function($p0,$p1,$p2,$p3){var $v_0=Mscrm.Utilities.getXYPos($p0,window.LOCID_UI_DIR==="RTL");$p1.set_dialogTop($p2?$v_0["y"]:$v_0["y"]+$p0.clientHeight);var $v_1=0;if(IsNull(window.frameElement))$v_1=Math.round((window.document.body.offsetHeight-$p1.get_dialogTop())*.98);else $v_1=Math.round((window.frameElement.offsetHeight-$p1.get_dialogTop())*.98);$p1.dialogChrome().css("max-height",$v_1.toString()+"px");var $v_2=this.$8e_0*28+this.$Ay_0*22;$v_2>$v_1&&$p1.get_options().set_width(this.$4c_0+15);var $v_3=2;if(!$p2)if(window.LOCID_UI_DIR==="RTL")$p1.set_dialogLeft($v_0["x"]+$p0.clientWidth-this.$4c_0);else $p1.set_dialogLeft($v_0["x"]);else if(window.LOCID_UI_DIR==="RTL")$p1.set_dialogLeft($v_0["x"]+$p0.clientWidth-(this.$4c_0+this.$1n_0.$4c_0-$v_3));else $p1.set_dialogLeft($v_0["x"]+$p0.clientWidth-$v_3);if(!IsNull($p3)){$p1.set_dialogTop($p1.get_dialogTop()+$p3["y"]);$p1.set_dialogLeft($p1.get_dialogLeft()+$p3["x"])}this.$T_0.set_position(Mscrm.FlyOutPosition.custom)},flyOutKeyDown:function(handleEvent){switch(handleEvent.which){case 13:var $v_0=$P_CRM(handleEvent.target);$v_0.click();handleEvent.stopImmediatePropagation();break;case 38:case 40:if(handleEvent.target.tagName==="A"){handleEvent.stopPropagation();this.handleArrowKey(handleEvent);handleEvent.stopImmediatePropagation()}break;case 27:this.hideFlyout();this.$2d_0=false;handleEvent.stopImmediatePropagation();break}},handleArrowKey:function(handleEvent){var $v_0=handleEvent.ctrlKey;if($v_0){var $v_3=Mscrm.Utilities.getParentElementByTagName(handleEvent.target,"LI"),$v_4=$P_CRM($v_3);if(!$v_4.hasClass("ms-crm-CommandBar-Spinner")||!$v_4.hasClass("menuSelected"))return;var $v_5=this.get_commandBar().$1W_4[$v_3.id];!IsNull($v_5)&&Mscrm.SpinnerControl.isInstanceOfType($v_5)&&$v_5.onKeyUpDown($v_3,handleEvent.which);return}var $v_1=$P_CRM(".menuSelected",this.$1m_0),$v_2;if(handleEvent.which===40||handleEvent.which===9&&!handleEvent.shiftKey){$v_2=$v_1.next();if(!$v_2.length)$v_2=this.$1m_0.children(":first-child");while($v_2.hasClass("ms-cui-menusection-title"))$v_2=$v_2.next()}else{$v_2=$v_1.prev();while($v_2.hasClass("ms-cui-menusection-title"))$v_2=$v_2.prev();if(!$v_2.length)$v_2=this.$1m_0.children(":last-child")}if($v_2.hasClass("ms-crm-CommandBarItem")){this.$AW_0($v_2,$v_1);this.swapSelection($v_2,$v_1);$v_2.find("a").focus()}},handleMouseHover:function(handleEvent){var $v_0=$P_CRM(handleEvent.target);if(!$v_0.hasClass("ms-crm-CommandBarItem")){$v_0=$v_0.parents("li");if($v_0.length!==1)return}var $v_1=$P_CRM(".menuSelected");this.$AW_0($v_0,$v_1);this.swapSelection($v_0,$v_1);if(handleEvent.target.tagName==="A")handleEvent.target.focus();else{var $v_2=Mscrm.Utilities.getParentElementByTagName(handleEvent.target,"A");if(!IsNull($v_2))$v_2.focus();else $v_0.find("a").focus()}handleEvent.stopImmediatePropagation()},swapSelection:function(newSelection,selectedItem){if(!selectedItem.hasClass("ms-crm-CommandBarItem")){selectedItem=selectedItem.parents("li");if(selectedItem.length!==1)return}selectedItem.addClass("menuUnselected");selectedItem.removeClass("menuSelected");newSelection.removeClass("menuUnselected");newSelection.addClass("menuSelected")},handleFocus:function(handleEvent){var $v_0=$P_CRM(handleEvent.target);if(!$v_0.hasClass("ms-crm-CommandBarItem")){$v_0=$v_0.parents("li");if($v_0.length!==1)return}if($v_0.hasClass("menuSelected")&&!$v_0.hasClass("ms-crm-CommandBar-SplitButton")){handleEvent.stopImmediatePropagation();return}var $v_1=$P_CRM(".menuSelected");this.swapSelection($v_0,$v_1);this.$AW_0($v_0,$v_1);handleEvent.stopImmediatePropagation()},$AW_0:function($p0,$p1){$p1.hasClass("ms-crm-CommandBar-SplitButton")&&this.$IB_0($p1);$p0.hasClass("ms-crm-CommandBar-SplitButton")&&this.$IA_0($p0)},$IA_0:function($p0){if(!$p0.hasClass("ms-crm-CommandBarItem")){$p0=$p0.parents("li");if($p0.length!==1)return}var $v_0=$p0.find("A.ms-crm-Menu-Label"),$v_1=$p0.find("A.ms-crm-Menu-Label-Flyout"),$v_2=this.get_commandBar().$1W_4[$p0.attr("id")];if(!IsNull($v_2)&&Mscrm.SplitButtonControl.isInstanceOfType($v_2))if($v_1.is(":focus"))$v_2.onHoverHandler($v_1.get(0));else $v_2.onHoverHandler($v_0.get(0))},$IB_0:function($p0){if(!$p0.hasClass("ms-crm-CommandBarItem")){$p0=$p0.parents("li");if($p0.length!==1)return}var $v_0=$p0.find("A.ms-crm-Menu-Label"),$v_1=$p0.find("A.ms-crm-Menu-Label-Flyout"),$v_2=this.get_commandBar().$1W_4[$p0.attr("id")];if(!IsNull($v_2)&&Mscrm.SplitButtonControl.isInstanceOfType($v_2))if($v_0.hasClass("ms-crm-commandbar-hoveredOver"))$v_2.onUnHoverHandler($v_0.get(0));else $v_2.onUnHoverHandler($v_1.get(0))},initializeMenu:function(){if(this.$6A_0){this.$T_0.get_options().set_modal(IsNull(this.$1n_0));return}this.$T_0=new Mscrm.FlyOutDialog;this.$T_0.get_options().set_showButtonPane(false);this.$T_0.get_options().set_modal(IsNull(this.$1n_0));this.$T_0.get_options().set_closeOnEscape(true);this.$T_0.get_options().set_isInDelayMode(true);this.$T_0.get_options().set_letjQueryHandleTabbing(true);this.$T_0.get_options().set_draggable(false);this.$T_0.set_shouldDisposeContent(false);var $$t_4=this;this.$T_0.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_4.$2d_0=false});var $$t_5=this;this.$T_0.bind(Mscrm.FlyOutDialogEventName.confirmed,function($p1_0){$$t_5.$2d_0=false});var $$t_6=this;this.$T_0.bind(Mscrm.FlyOutDialogEventName.overlayClicked,function($p1_0){$$t_6.hideFlyout()});var $$t_7=this;this.$T_0.bind(Mscrm.FlyOutDialogEventName.visibleChanged,function($p1_0){$$t_7.$GH_0()});$P_CRM(window).resize(this.$$d_$CQ_0);this.$6A_0=true},hideFlyout:function(){!IsNull(this.$2a_0)&&this.$2a_0.hideFlyout();this.$6A_0&&!this.$5o_0&&this.$T_0.hide()},$CQ_0:function($p0){this.hideFlyout()},hideAllParentFlyouts:function(){this.$6A_0&&!this.$5o_0&&this.$T_0.hide();!IsNull(this.$1n_0)&&this.$1n_0.hideAllParentFlyouts()},$GH_0:function(){this.$2d_0=this.$T_0.get_visible();if(!this.$2d_0){this.$1m_0.unbind("keydown");this.$1m_0.unbind("mouseover");this.$1m_0.find("A").unbind("focus");$P_CRM(window).unbind("resize",this.$$d_$CQ_0);var $$t_7=this;this.$1m_0.find("li").each(function($p1_0,$p1_1){var $v_4=$P_CRM($p1_1);$v_4.unbind()});this.$1m_0=null;this.cacheContent();if(!IsNull(this.$6I_0)){var $v_0=Mscrm.Utilities.getParentElementByTagName(this.$6I_0,"LI");if(!IsNull($v_0)){if(Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-CommandBar-SplitButton")){var $v_2=$v_0.children[0];if(!IsNull($v_2)){Sys.UI.DomElement.removeCssClass($v_2.children[1],"ms-crm-CommandBar-button-selected");Sys.UI.DomElement.removeCssClass($v_2.children[0],"ms-crm-CommandBar-button-split-selected");var $v_3=Mscrm.Utilities.getChildElementsByClassName($v_2.children[0],"splitButtonSplitter",true)[0];if(!IsNull($v_3))$v_3.style.visibility="visible"}}else Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-CommandBar-FlyoutAnchor")&&Sys.UI.DomElement.removeCssClass($v_0.children[0],"ms-crm-CommandBar-button-selected");Sys.UI.DomElement.containsCssClass($v_0,"menuSelected")&&Sys.UI.DomElement.removeCssClass($v_0,"menuSelected");var $v_1=$P_CRM($v_0);$v_1.find("A").focus()}this.$6I_0=null}}else{$P_CRM(window).resize(this.$$d_$CQ_0);if(!IsNull(this.$1n_0))this.$1n_0.$2a_0=this}},createMenuCommandsPopup:function(content){var $v_0=$P_CRM(this.$Ce_0);$v_0.append(content);if(IsNull(this.$46_0))this.$46_0=$P_CRM("<div class='ui-flyout-dialog-moreCommands'></div>");if(Mscrm.Utilities.isIE8OrLower())this.$46_0[0].innerHTML="";else this.$46_0.empty();this.$46_0.append($v_0);var $v_1=$P_CRM("img.flyoutAnchorArrow",$v_0);$v_1.attr("src","/_imgs/CommandBarMenuRight.png");if(!this.$8O_0){this.$T_0.setContent(this.$46_0);this.$8O_0=true}this.$1m_0=$P_CRM(this.$4h_0);this.$1m_0.keydown(this.$$d_flyOutKeyDown);this.$1m_0.mouseover(this.$$d_handleMouseHover);this.$8e_0=0;this.$Ay_0=this.$1m_0.find("div.ms-cui-menusection-title").length;var $$t_B=this;this.$1m_0.find("li").each(function($p1_0,$p1_1){$$t_B.$8e_0++;var $v_2=$P_CRM($p1_1);$v_2.find("A").focus($$t_B.$$d_handleFocus);$v_2.hasClass("menuSelected")&&$v_2.removeClass("menuSelected");$v_2.addClass("menuUnselected");var $v_3=$v_2.attr("command"),$v_4=$v_2.attr("id");$p1_1.setAttribute("style","display:block");$p1_1.setAttribute("float","none");var $v_5=null;if(!IsNull($$t_B.get_commandBar())){$v_5=$$t_B.get_commandBar().$1W_4[$v_4];if(!IsNull($v_5)){$v_5.$20_0=$$t_B;Mscrm.ToggleButtonControl.isInstanceOfType($v_5)&&$v_5.setButtonState($p1_1,$$t_B.$DE_0.get_toggleButtonState()[$v_3])}}$addHandler($p1_1,"click",function($p2_0){if(!IsNull($v_5))if(Mscrm.MenuAwareControl.isInstanceOfType($v_5)){if(Mscrm.SplitButtonControl.isInstanceOfType($v_5)&&(!$p2_0.target.attributes.getNamedItem("role")||$p2_0.target.attributes.getNamedItem("role").value!=="flyout")){$$t_B.hideFlyout();$$t_B.hideAllParentFlyouts()}}else if(!Mscrm.SpinnerControl.isInstanceOfType($v_5)){$$t_B.hideFlyout();$$t_B.hideAllParentFlyouts()}window.setTimeout(function(){if(!IsNull($v_5)){var $v_6=$p2_0;$v_5.click($p2_0.target,$v_6);return}},0)})});this.$T_0.set_position(Mscrm.FlyOutPosition.bottom);this.$T_0.get_options().set_width(this.$4c_0);this.$T_0.get_options().set_minHeight(this.$Aq_0);this.$T_0.get_options().set_dialogClass(this.$T_0.get_options().get_dialogClass()+" ms-crm-moreCommands-flyout");Mscrm.Utilities.isIosDevice()&&this.$T_0.get_options().set_dialogClass(this.$T_0.get_options().get_dialogClass()+" ms-crm-moreCommands-flyout-ipad-scroll");this.$T_0.get_options().set_showTitlePane(false)}};Mscrm.CommandBar=function(element){this.$$d_renderAllControls=Function.createDelegate(this,this.renderAllControls);this.$$d_refreshMoreMenu=Function.createDelegate(this,this.refreshMoreMenu);this.$$d_$Gw_4=Function.createDelegate(this,this.$Gw_4);this.$1V_4=new Sys.StringBuilder;this.$1r_4=new Sys.StringBuilder;Mscrm.CommandBar.initializeBase(this,[element])};Mscrm.CommandBar.$7a=function($p0,$p1){var $v_0=false,$v_1=$p1.$4B_2;$p1.$4B_2=false;try{$v_0=$p1.isControlVisible($p0.command,$p0.id)&&$p1.isControlEnabled($p0.command);if(!$v_0&&$p0.$5Q_0)$v_0=Mscrm.RibbonManager.get_$2y().$v_1.isCommandEnabled($p0.command)}finally{$p0.$4B_0=$p1.$4B_2;$p1.$4B_2=$v_1}return $v_0};Mscrm.CommandBar.prototype={$D_4:null,get_ribbonData:function(){return this.$D_4},$4m_4:0,$36_4:0,$4u_4:false,$2q_4:null,$t_4:0,get_availableWidth:function(){return this.$t_4},set_availableWidth:function(value){this.$t_4=value;return value},$2i_4:0,$4n_4:null,initialize:function(){Mscrm.CommandBarBase.prototype.initialize.call(this);if(window.LOCID_UI_DIR==="RTL")this.$9x_4=37;else this.$9x_4=39;this.$4u_4=true;this.$3u_4=[];this.$2i_4=0;this.$1W_4={};this.$4n_4=this.$$d_$Gw_4},setCommandBuildOptions:function(data,numberOfButtonsForDisplay,commandBarMode,availableWidth){this.$3e_4=commandBarMode;this.$D_4=data;this.$4m_4=numberOfButtonsForDisplay;this.$36_4=numberOfButtonsForDisplay;this.$t_4=availableWidth;if(commandBarMode===2)this.$1h_4=new Mscrm.CommandBarMoreMenu("#moreCommandsList","<ul id='moreCommandsList'></ul>","moreCommands",this);else{var $v_0=String.format("more{0}Commands",!commandBarMode?"Charts":"ChartDesigner"),$v_1=$v_0+"List";this.$1h_4=new Mscrm.CommandBarMoreMenu("#"+$v_1,"<ul id='"+$v_1+"'></ul>",$v_0,this)}},dispose:function(){if(this.get_isDisposed())return;if(!IsNull(this.$2q_4)){window.clearTimeout(this.$2q_4);this.$2q_4=null}if(window.PRERENDERALL&&!CUI.ScriptUtility.isNullOrUndefined(this.$2K_4)){window.clearTimeout(this.$2K_4);this.$2K_4=null}this.detachEvents();this.$4n_4=null;this.disposeAllMenus();!CUI.ScriptUtility.isNullOrUndefined(this.$3u_4)&&Array.clear(this.$3u_4);Mscrm.CommandBarBase.prototype.dispose.call(this)},detachEvents:function(){var $$t_4=this;this.$D7_4(function($p1_0){Mscrm.CommandBarBase.prototype.detachEvents.call($$t_4,$p1_0)});if(!IsNull(this.$1j_3))for(var $v_0=this.$1j_3.getElementsByTagName("input"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];!IsNull(this.$4n_4)&&$removeHandler($v_2,"click",this.$4n_4)}},$D7_4:function($p0){if(IsNull(this.$1j_3))return;for(var $v_0=this.$1j_3.getElementsByTagName("A"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if(!IsNull($v_2.attributes.getNamedItem("type"))&&$v_2.attributes.getNamedItem("type").value==="menu")continue;$p0($v_2)}},onKeyDown:function(domEvent){var $v_0=domEvent.target,$v_1=Mscrm.Utilities.getDomEventKeyCode(domEvent);if(domEvent.altKey){if($v_0.accessKey.toUpperCase()!==String.fromCharCode($v_1).toUpperCase()){domEvent.preventDefault();return}switch($v_1){case 9:case 115:domEvent.preventDefault();return}domEvent.preventDefault()}switch($v_1){case 32:case 13:this.onClickHandler(domEvent);break;case 37:case 39:this.handleKeyNavigation(domEvent);break;case 38:case 40:this.handleKeyUpDown(domEvent,$v_1);break;default:break}return},handleKeyUpDown:function(domEvent,keyCode){var $v_0=Mscrm.Utilities.getParentElementByTagName(domEvent.target,"LI");if(!IsNull($v_0)&&Sys.UI.DomElement.containsCssClass($v_0,"ms-crm-CommandBar-Spinner")){domEvent.preventDefault();domEvent.stopPropagation();var $v_1=this.$1W_4[$v_0.id];!IsNull($v_1)&&Mscrm.SpinnerControl.isInstanceOfType($v_1)&&$v_1.onKeyUpDown($v_0,keyCode)}},handleKeyNavigation:function(domEvent){var $v_0=Mscrm.Utilities.getDomEventKeyCode(domEvent);this.$Hw_4(this.$66_4(this.$1j_3),$v_0===this.$9x_4?1:-1);domEvent.preventDefault();domEvent.stopPropagation()},glowAndSetLastFocused:function(domEvent){this.onHoverHandler(domEvent)},setFocus:function(){var $v_0=this.$C1_4(this.$66_4(this.$1j_3),null,1),$v_1=$P_CRM("a",$v_0);$v_1.length>0&&this.$7q_4($v_1.get(0))},setLastFocused:function(){var $v_0=this.$8i_4;if(!IsNull($v_0)){var $v_1=$P_CRM("a",$v_0);$v_1.length>0&&this.$7q_4($v_1.get(0))}else this.setFocus()},$Hw_4:function($p0,$p1){var $v_0=this.$8i_4;if(IsNull($v_0))return;var $v_1=$v_0;$v_1=this.$C1_4($p0,$v_0,$p1);!IsNull($v_1)&&this.$7q_4(this.$66_4($v_1))},$C1_4:function($p0,$p1,$p2){var $v_0=$p1,$v_1=$p1,$v_2=false;do{if(!IsNull($v_0)){var $v_3=$p2<0?this.$Fm_4($v_0):this.$Fl_4($v_0);if($v_3!==$v_0)$v_0=$v_3;else $v_0=null}if(IsNull($v_0)){if($v_2)return null;$v_0=$p2<0?this.$Fk_4($p0):this.$66_4($p0);$v_2=true}if($v_0===$v_1)return null;if(IsNull($v_0))return null}while($v_0.tagName!=="LI"||$v_0.disabled||$v_0.style.display==="none");return $v_0},$Fm_4:function($p0){return XUI.Html.DomUtils.GetPrevSibling($p0)},$Fl_4:function($p0){return XUI.Html.DomUtils.GetNextSibling($p0)},$Fk_4:function($p0){var $v_0=XUI.Html.DomUtils.GetLastChild($p0);return $v_0},$66_4:function($p0){var $v_0=XUI.Html.DomUtils.GetFirstChild($p0);return $v_0},$7q_4:function($p0){if(IsNull($p0))return;if($p0.tabIndex>=0){$p0.focus();return}for(var $v_0=$p0.children.length,$v_1=0;$v_1<$v_0;++$v_1){if(IsNull($p0.children[$v_1]))break;!IsNull(this.$66_4($p0.children[$v_1]))&&this.$7q_4($p0.children[$v_1])}},onClickHandler:function(domEvent){var $v_0=Mscrm.Utilities.getDomEventElement(domEvent,"LI"),$v_1=this.$1W_4[$v_0.id];if($v_1)$v_1.click($v_0,domEvent);else if(this.$6B_4($v_0.id)){window.self.CommandBarMoreMenuLoadStartTime=(new Date).getTime();this.$Go_4(domEvent);window.self.CommandBarMoreMenuLoadEndTime=(new Date).getTime()}},$Go_4:function($p0){if(!$p0.button){$p0.stopPropagation();this.$1h_4.processAndShowMenu(this.get_moreMenuContent(),this.$D_4,false)}},onHoverHandler:function(domEvent){domEvent.stopPropagation();var $v_0=Mscrm.Utilities.getDomEventElement(domEvent,"A");if(!IsNull($v_0)){var $v_1=Mscrm.Utilities.getParentElementByTagName($v_0,"LI");if(Sys.UI.DomElement.containsCssClass($v_1,"ms-crm-CommandBar-SplitButton")){var $v_2=this.$1W_4[$v_1.id];!IsNull($v_2)&&Mscrm.SplitButtonControl.isInstanceOfType($v_2)&&$v_2.onHoverHandler($v_0)}else{Sys.UI.DomElement.removeCssClass($v_0.parentNode,"ms-crm-Menu-Label");Sys.UI.DomElement.addCssClass($v_0.parentNode,"ms-crm-Menu-Label-Hovered")}this.$8i_4=$v_1}},onUnHoverHandler:function(domEvent){domEvent.stopPropagation();var $v_0=Mscrm.Utilities.getDomEventElement(domEvent,"A"),$v_1=Mscrm.Utilities.getParentElementByTagName($v_0,"LI");if(Sys.UI.DomElement.containsCssClass($v_1,"ms-crm-CommandBar-SplitButton")){var $v_2=this.$1W_4[$v_1.id];!IsNull($v_2)&&Mscrm.SplitButtonControl.isInstanceOfType($v_2)&&$v_2.onUnHoverHandler($v_0)}else{Sys.UI.DomElement.removeCssClass($v_0.parentNode,"ms-crm-Menu-Label-Hovered");Sys.UI.DomElement.addCssClass($v_0.parentNode,"ms-crm-Menu-Label")}},$Gw_4:function($p0){$p0.stopPropagation();this.onClickHandler($p0)},$6B_4:function($p0){return $p0==="moreCommands"||$p0==="moreChartsCommands"||$p0==="moreChartDesignerCommands"},attachEvents:function(){var $$t_4=this;this.$D7_4(function($p1_0){Mscrm.CommandBarBase.prototype.attachEvents.call($$t_4,$p1_0)});if(!IsNull(this.$1j_3)&&!IsNull(this.$4n_4))for(var $v_0=this.$1j_3.getElementsByTagName("input"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];$addHandler($v_2,"click",this.$4n_4)}},setButtonVisible:function(button,visible){if(visible){button.style.display="inline-block";var $v_0=$P_CRM(button),$v_1=this.$D_4.get_toggleButtonState()[$v_0.attr("command")];!IsNull($v_1)&&$v_1&&$v_0.children().addClass("ms-crm-CommandBarToggleButton-Active")}else button.style.display="none"},get_commandBarButtonControls:function(){if(this.$1j_3)return this.$1j_3.getElementsByTagName("LI");return null},get_moreMenu:function(){return this.$1h_4},get_renderedControls:function(){if(IsNull(this.$3u_4))this.$3u_4=[];return this.$3u_4},set_renderedControls:function(value){this.$3u_4=value;return value},get_commandBarContent:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$1r_4)&&!this.$1r_4.isEmpty())return this.$1r_4.toString();else if(CUI.ScriptUtility.isNullOrUndefined(this.$1r_4))this.$1r_4=new Sys.StringBuilder;else this.$1r_4.clear();if(CUI.ScriptUtility.isNullOrUndefined(this.get_renderedControls()))return this.$1r_4.toString();for(var $v_0=false,$v_2=0;$v_2<this.get_renderedControls().length;$v_2++){var $v_3=this.get_renderedControls()[$v_2];if(CUI.ScriptUtility.isNullOrUndefined($v_3))continue;if($v_3.get_isVisible())if(!$v_3.isInMenu){var $v_4=this.get_renderedControls()[$v_2].get_element();this.setButtonVisible($v_4,true);$v_4.removeAttribute("overflowIndex");if(this.$3e_4!==2&&$v_4.className.indexOf(" ms-crm-ChartCommandBar-menu-text")===-1)$v_4.className+=" ms-crm-ChartCommandBar-menu-text";this.$1r_4.append(XUI.Html.GetOuterHTML($v_4))}else $v_0=true}var $v_1=this.$Ew_4();if($v_0)this.setButtonVisible($v_1,true);else this.setButtonVisible($v_1,false);this.$1r_4.append(XUI.Html.GetOuterHTML($v_1));return this.$1r_4.toString()},get_moreMenuContent:function(){if(this.$4u_4){this.$1V_4.clear();this.refreshMoreMenu()}else if(!CUI.ScriptUtility.isNullOrUndefined(this.$1V_4)&&!this.$1V_4.isEmpty())return this.$1V_4.toString();else if(CUI.ScriptUtility.isNullOrUndefined(this.$1V_4))this.$1V_4=new Sys.StringBuilder;else this.$1V_4.clear();if(CUI.ScriptUtility.isNullOrUndefined(this.get_renderedControls()))return this.$1V_4.toString();for(var $v_0=0,$v_1=0;$v_0<this.get_renderedControls().length;$v_0++){var $v_2=this.get_renderedControls()[$v_0];if(CUI.ScriptUtility.isNullOrUndefined($v_2))continue;if($v_2.get_isVisible()&&$v_2.isInMenu){var $v_3=$v_2.get_element();$v_3.setAttribute("overflowIndex",$v_1++);if(this.$3e_4!==2&&$v_3.className.indexOf(" ms-crm-ChartCommandBar-menu-text")!==-1){var $v_4=new RegExp("(?:^|\\s)ms-crm-ChartCommandBar-menu-text(?!\\S)","g");$v_3.className=$v_3.className.replace($v_4,"")}this.$1V_4.append(XUI.Html.GetOuterHTML($v_3))}}return this.$1V_4.toString()},set_moreMenuContent:function(value){this.$1V_4.clear();this.$1V_4.append(value);return value},refreshCommandBar:function(animate,xrmOnly){this.evaluateCommands(true,true,xrmOnly);this.$3N_4&&this.refreshCommandBarContent(animate);if(!IsNull(this.$1h_4)&&this.$1h_4.$2d_0){this.$1h_4.hideFlyout();this.$4u_4=true;this.$1h_4.processAndShowMenu(this.get_moreMenuContent(),this.$D_4,false)}},refreshCommandBarContent:function(animate){this.detachEvents();this.$1r_4.clear();var $v_0=$P_CRM(this.get_commandBarContent());if(Mscrm.Utilities.isIE8OrLower())this.get_$3S_4()[0].innerHTML="";else this.get_$3S_4().empty();this.get_$3S_4().append($v_0);var $v_1=this.get_$3S_4().find("li").length;if(animate){var $v_2=window.setTimeout(Mscrm.PerceivedCommandBarHelper.switchCommandBars,($v_1+1)*125);Mscrm.PerceivedCommandBarHelper.set_asyncRealCommandBarShowUpHandle($v_2)}this.attachEvents()},refreshMoreMenu:function(){if(window.PRERENDERALL&&!CUI.ScriptUtility.isNullOrUndefined(this.$2K_4)){window.clearTimeout(this.$2K_4);this.$2K_4=null}this.evaluateCommands(false,false,false);this.$1V_4.clear();this.$4u_4=false},refresh:function(animate,allContent,xrmOnly){this.refreshCommandBar(animate,xrmOnly);if(allContent)this.refreshMoreMenu();else{this.$4u_4=true;if(window.PRERENDERALL&&CUI.ScriptUtility.isNullOrUndefined(this.$2K_4))this.$2K_4=window.setTimeout(this.$$d_refreshMoreMenu,100)}},closeAllMenus:function(){!IsNull(this.$1h_4)&&this.$1h_4.hideFlyout();for(var $v_0=0;$v_0<this.get_renderedControls().length;$v_0++){var $v_1=this.get_renderedControls()[$v_0];!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1.get_isVisible()&&!$v_1.isInMenu&&Mscrm.MenuAwareControl.isInstanceOfType($v_1)&&!CUI.ScriptUtility.isNullOrUndefined($v_1.menu)&&$v_1.menu.hideFlyout()}},disposeAllMenus:function(){if(!IsNull(this.$1h_4)){this.$1h_4.disposeMenu();this.$1h_4=null}for(var $v_0=0;$v_0<this.get_renderedControls().length;$v_0++){var $v_1=this.get_renderedControls()[$v_0];if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&Mscrm.MenuAwareControl.isInstanceOfType($v_1)&&!CUI.ScriptUtility.isNullOrUndefined($v_1.menu)){$v_1.menu.disposeMenu();$v_1.menu=null}}},resizeCommandBar:function(displayLimit,widthLimit){if(!(displayLimit-this.$4m_4))return;this.$36_4+=displayLimit-this.$4m_4;this.$4m_4=displayLimit;this.$t_4=widthLimit;this.evaluateCommands(true,false,false);if(CUI.ScriptUtility.isNullOrUndefined(this.get_renderedControls()))return;for(var $v_0=0;$v_0<=this.$2i_4&&$v_0<this.get_renderedControls().length;$v_0++){var $v_1=this.get_renderedControls()[$v_0];if(CUI.ScriptUtility.isNullOrUndefined($v_1))continue;if(this.$6B_4($v_1.id))continue;if($v_1.get_isVisible()){if(displayLimit<=0)$v_1.isInMenu=true;else $v_1.isInMenu=false;displayLimit--}}this.refreshCommandBarContent(false);this.$4u_4=true;if(window.PRERENDERALL&&CUI.ScriptUtility.isNullOrUndefined(this.$2K_4))this.$2K_4=window.setTimeout(this.$$d_refreshMoreMenu,100)},evaluateCommands:function(partiallyEvaluate,resetIndex,clientApiControlsOnly){var $v_0=false,$v_1=null;if(CUI.ScriptUtility.isNullOrUndefined(this.get_renderedControls()))return $v_0;var $v_2=this.$2i_4;if(resetIndex||CUI.ScriptUtility.isNullOrUndefined(this.$2i_4)){this.$2i_4=0;this.$3N_4=false}if(!this.$2i_4)this.$36_4=this.$4m_4;for(var $v_3=this.$2i_4;$v_3<this.get_renderedControls().length;$v_3++){var $v_4=this.get_renderedControls()[$v_3];if(CUI.ScriptUtility.isNullOrUndefined($v_4)){$v_0=true;continue}var $v_5,$v_6;$v_5=$v_6=$v_4.get_isVisible();if(partiallyEvaluate&&this.$36_4<0&&IsNull($v_1)){this.$3N_4=this.$3N_4||$v_5&&!$v_4.isInMenu;$v_4.set_isVisible(false);continue}this.$2i_4++;$v_0=true;if(this.$6B_4($v_4.id))continue;if(this.$3e_4===2&&(this.$D_4.get_$Ca_3()&&!IsNull(this.$D_4.$84_3[$v_4.command])||!this.$D_4.get_$Ca_3()&&!IsNull(this.$D_4.$82_3[$v_4.command]))){$v_4.set_isVisible(false);$v_4.isInMenu=false;continue}if(!clientApiControlsOnly||$v_4.$4B_0||!IsNull($v_2)&&this.$2i_4>$v_2)$v_6=Mscrm.CommandBar.$7a($v_4,this.$D_4);if($v_6){$v_4.set_isVisible(true);if(this.$36_4>0){this.$3N_4=this.$3N_4||!$v_5||$v_4.isInMenu;$v_4.isInMenu=false;this.$36_4--;continue}$v_4.isInMenu=true;if(this.$3e_4!==2)if(IsNull($v_1)&&!this.$36_4){$v_1=$v_4;$v_4.isInMenu=false}else if(!IsNull($v_1)){$v_1.isInMenu=true;$v_1=null}this.$36_4--}else{this.$3N_4=this.$3N_4||$v_5&&!$v_4.isInMenu;$v_4.set_isVisible(false);$v_4.isInMenu=false}}return $v_0},renderAllControls:function(){for(var $v_0=0;$v_0<this.get_renderedControls().length;$v_0++){var $v_1=this.get_renderedControls()[$v_0];if($v_1.get_element());}},$Bo_4:function($p0){if(!IsNull(this.$2q_4)){window.clearTimeout(this.$2q_4);this.$2q_4=null}var $v_0=XUI.Html.GetOpacity(this.get_$3S_4()[0])>0;XUI.Html.SetOpacity(this.get_$3S_4()[0],$p0);!$v_0&&this.detachEvents()},$Bq_4:function($p0){this.detachEvents();if($p0&&!IsNull(this.$2q_4)){var $$t_1=this;this.$2q_4=window.setTimeout(function(){$$t_1.attachEvents();XUI.Html.RemoveOpacity($$t_1.get_$3S_4()[0]);$$t_1.$2q_4=null},0)}else{this.attachEvents();XUI.Html.RemoveOpacity(this.get_$3S_4()[0])}},$8i_4:null,$9x_4:0,$1h_4:null,$1W_4:null,$3N_4:true,$2K_4:null,$3u_4:null,$3e_4:0,get_$Gp_4:function(){switch(this.$3e_4){case 2:return "moreCommands";case 0:return "moreChartsCommands";case 1:return "moreChartDesignerCommands"}return "moreCommands"},$3d_4:null,get_$3S_4:function(){var $v_0=$P_CRM(this.$1j_3);if(CUI.ScriptUtility.isNullOrUndefined(this.$3d_4))switch(this.$3e_4){case 2:this.$3d_4=$v_0.find(String.format("ul.{0}","ms-crm-CommandBar-Menu"));break;case 0:this.$3d_4=$v_0.find(String.format("ul.{0}.{1}","ms-crm-CommandBar-Menu","ms-crm-chartsPaneCommand-Bar"));break;case 1:this.$3d_4=$v_0.find(String.format("ul.{0}.{1}","ms-crm-CommandBar-Menu","ms-crm-chartDesignerCommand-Bar"));break}if(CUI.ScriptUtility.isNullOrUndefined(this.$3d_4))return $v_0.find(String.format("ul.{0}","ms-crm-CommandBar-Menu"));if(!this.$3d_4.length)return $v_0.find(String.format("ul.{0}","ms-crm-CommandBar-Menu"));return this.$3d_4},$Ew_4:function(){var $v_0=document.createElement("li");$v_0.className="ms-crm-CommandBarItem ms-crm-CommandBar-Menu ms-crm-CommandBar-MoreMenu";$v_0.id=this.get_$Gp_4();$v_0.title=window.LOCID_MORECOMMANDS_TOOLTIP;var $v_1=document.createElement("span");$v_1.className="ms-crm-Menu-Label ms-crm-More-Menu-Label";var $v_2=document.createElement("a");$v_2.setAttribute("onclick","return false");$v_2.setAttribute("tabIndex","0");$v_2.className="ms-crm-Menu-Label";if(!this.$4m_4){var $v_3=document.createElement("span");$v_3.className="ms-crm-MenuItem-TextRTL ms-crm-CommandBar-Menu";$v_3.title=window.LOCID_MORECOMMANDS_TOOLTIP;$v_3.id="moreCommandsSpan";XUI.Html.SetText($v_3,window.LOCID_MORECOMMANDS_RESIZEDLABEL);$v_2.appendChild($v_3)}else{var $v_4=document.createElement("img");$v_4.setAttribute("tabIndex","-1");$v_4.setAttribute("alt","...");$v_4.setAttribute("src","/_imgs/More_16.png");$v_4.className="ms-crm-moreCommand-image";$v_2.appendChild($v_4)}$v_1.appendChild($v_2);$v_0.appendChild($v_1);return $v_0}};Mscrm.CommandBarBuildOptions=function(data){this.$1t_0=data};Mscrm.CommandBarBuildOptions.prototype={$1t_0:null,get_currentRibbonData:function(){return this.$1t_0},set_currentRibbonData:function(value){this.$1t_0=value;return value},$7M_0:null,get_trimmedIds:function(){return this.$7M_0},set_trimmedIds:function(value){this.$7M_0=value;return value},$2V_0:0,get_numberOfButtonsForDisplay:function(){return this.$2V_0},set_numberOfButtonsForDisplay:function(value){this.$2V_0=value;return value},$t_0:0,get_availableWidth:function(){return this.$t_0},set_availableWidth:function(value){this.$t_0=value;return value}};Mscrm.CommandBarBuilder=function(options,elmPlaceholder){this.$18_0={};this.$1E_0=new Array(2);this.$4N_0=new Array(2);this.$4M_0=new Array(2);this.$4t_0=new Array(3);this.$4s_0=new Array(3);if(CUI.ScriptUtility.isNullOrUndefined(elmPlaceholder))throw Error.create("Ribbon placeholder DOM element is null or undefined.");this.$4C_0=options;this.$N_0=this.$CZ_0(elmPlaceholder,this.get_commandBarBuildOptions(),2);this.$Fw_0()};Mscrm.CommandBarBuilder.$6H=function($p0,$p1,$p2,$p3,$p4){var $v_0=$p0.attrs,$v_1=$v_0.Id,$v_2=$v_0.Command,$v_3=$v_1,$v_4=$p2.$1W_4[$v_3],$v_5=!IsNull($v_4)?$v_4.get_count()+1:0;while(!IsNull($p2)&&!IsNull($v_4))if($p4&&$v_4.command===$v_2)return $v_4;else{$v_3=$v_1+"_"+$v_5.toString();$v_4=$p2.$1W_4[$v_3];if(!IsNull($v_4))$v_5++}$v_4=Mscrm.CommandBarControl.factoryMethod($p0,$p1,$v_0);if(!$v_4)return null;$v_4.id=$v_1;$v_4.command=$v_2;$v_4.set_count($v_5);if(!IsNull($p2))$p2.$1W_4[$v_3]=$v_4;var $v_6=$p0.name;if($v_6!=="Button"&&$v_6!=="ToggleButton"){var $v_7=$v_3.replace(/\|/g,"_").replace(/\./g,"_");if($v_6==="Spinner")$v_4.setAttribute("ArrowId","arrow_"+$v_7);else{$v_4.setAttribute("UpArrowId","up_arrow_"+$v_7);$v_4.setAttribute("DownArrowId","down_arrow_"+$v_7)}}if(!CUI.ScriptUtility.isNullOrUndefined($v_4.command)&&!CUI.ScriptUtility.isNullOrUndefined($p3))$p3[$v_0.Command.toString()]=true;$v_4.set_commandBar($p2);return $v_4};Mscrm.CommandBarBuilder.$CJ=function($p0){var $v_0=CUI.DataNodeWrapper.getNodeChildren($p0);if(!$v_0||!$v_0.length)return null;var $v_1=CUI.DataNodeWrapper.getNodeChildren($v_0[0]);return $v_1};Mscrm.CommandBarBuilder.$G3=function($p0){var $v_0={},$$dict_2=$p0;for(var $$key_3 in $$dict_2){var $v_1={key:$$key_3,value:$$dict_2[$$key_3]};$v_0[$v_1.key]=CrmEncodeDecode.CrmHtmlAttributeEncode($v_1.value.toString())}return $v_0};Mscrm.CommandBarBuilder.prototype={$4C_0:null,$N_0:null,$5n_0:false,get_chartPaneCommandBar:function(){return this.$1E_0[0]},get_chartDesignerCommandBar:function(){return this.$1E_0[1]},get_chartsPaneCommandBarBuildOptions:function(){return this.$4M_0[0]},get_chartsDesignerCommandBarBuildOptions:function(){return this.$4M_0[1]},get_commandBarBuildOptions:function(){return this.$4C_0},get_commandBar:function(){return this.$N_0},dispose:function(){!IsNull(this.$N_0)&&this.$N_0.dispose();this.$N_0=null;for(var $v_0=0;$v_0<=2;$v_0++){if(window.PRERENDERALL&&!CUI.ScriptUtility.isNullOrUndefined(this.$4t_0[$v_0])){window.clearTimeout(this.$4t_0[$v_0]);this.$4t_0[$v_0]=null}if(window.PRERENDERALL&&!CUI.ScriptUtility.isNullOrUndefined(this.$4s_0[$v_0])){window.clearTimeout(this.$4s_0[$v_0]);this.$4s_0[$v_0]=null}if(!CUI.ScriptUtility.isNullOrUndefined(this.$1E_0[$v_0])&&$v_0!==2){this.$1E_0[$v_0].dispose();this.$1E_0[$v_0]=null}}},buildCommandBar:function(commandBarData){var $v_0=new Mscrm.Performance.PerformanceStopwatch("BuildCommandBar");$v_0.start();var $v_1=commandBarData.get_commandLayout();!IsNull($v_1)&&this.$Hf_0($v_1);$v_0.stop()},buildChartCommandBar:function(chartDisplayDiv,commandMode,options){this.$4M_0[commandMode]=options;this.$1E_0[commandMode]=this.$CZ_0(chartDisplayDiv,options,commandMode);this.$1E_0[commandMode].$1W_4=this.$N_0.$1W_4;this.$1E_0[commandMode].set_renderedControls(this.$4N_0[commandMode]);this.$AD_0(this.$1E_0[commandMode]);if(window.PRERENDERALL){this.$4t_0[commandMode]=window.setTimeout(this.$1E_0[commandMode].$$d_renderAllControls,100);this.$4s_0[commandMode]=window.setTimeout(this.$1E_0[commandMode].$$d_refreshMoreMenu,100)}},refreshCommandBar:function(parameters){var $v_0=3,$v_1=false,$v_2=false;if(!IsNull(parameters)){if(!IsNull(parameters["mode"]))$v_0=parameters["mode"];if(!IsNull(parameters["animate"]))$v_1=parameters["animate"];if(!IsNull(parameters["XrmOnly"]))$v_2=parameters["XrmOnly"]}this.$N_0&&($v_0===3||$v_0===2)&&this.$N_0.refresh($v_1,false,$v_2);for(var $v_3=0;$v_3<2;$v_3++)if(!IsNull(this.$1E_0[$v_3]))($v_3===$v_0||$v_0===3)&&this.$1E_0[$v_3].refresh($v_1,false,$v_2)},resizeCommandBar:function(){this.$N_0&&this.$N_0.resizeCommandBar(this.get_commandBarBuildOptions().$2V_0,this.get_commandBarBuildOptions().$t_0);for(var $v_0=0;$v_0<2;$v_0++)!IsNull(this.$1E_0[$v_0])&&this.$1E_0[$v_0].resizeCommandBar(this.$4M_0[$v_0].$2V_0,this.$4M_0[$v_0].$t_0)},$Fw_0:function(){if(!Mscrm.TemplateGenerator.$5K){$P_CRM.template("CommandBarButtonTemplate",Mscrm.TemplateGenerator.get_buttonTemplate());$P_CRM.template("CommandBarFlyoutAnchorTemplate",Mscrm.TemplateGenerator.get_flyOutAnchorTemplate());$P_CRM.template("CommandBarSplitButtonTemplate",Mscrm.TemplateGenerator.get_splitButtonTemplate());$P_CRM.template("CommandBarCustomTabTemplate",Mscrm.TemplateGenerator.get_customTabTemplate());$P_CRM.template("CommandBarCheckBoxTemplate",Mscrm.TemplateGenerator.get_checkBoxTemplate());$P_CRM.template("CommandBarSpinnerTemplate",Mscrm.TemplateGenerator.get_spinnerControlTemplate())}},$Hf_0:function($p0){var $v_0=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"CommandBar");if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("No ribbon element was present in the data");var $v_1=new CUI.DataNodeWrapper($v_0);this.$4N_0[0]=[];this.$4N_0[1]=[];this.$5n_0=false;this.$EE_0($v_1);if(!this.$5n_0){this.$AD_0(this.$N_0);this.$5n_0=true}if(window.PRERENDERALL){this.$4t_0[2]=window.setTimeout(this.$N_0.$$d_renderAllControls,100);this.$4s_0[2]=window.setTimeout(this.$N_0.$$d_refreshMoreMenu,100)}},$EE_0:function($p0){var $v_0=this.get_commandBarBuildOptions().$1t_0.get_$3V_3();if(!$v_0){var $v_3=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.$a_0,"Tabs"));if(IsNull($v_3)||!$v_3.length)return;for(var $v_4=false,$v_5=0;$v_5<$v_3.length;$v_5++)if(!$v_4&&CUI.DataNodeWrapper.getNodeAttribute($v_3[$v_5],"Id")==="Mscrm.CommandBar"){this.$BR_0($v_3[$v_5],false);$v_4=true}else this.$BQ_0($v_3[$v_5],false);this.get_commandBarBuildOptions().$1t_0.$84_3=this.$18_0}this.$18_0={};var $v_1=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.$a_0,"ContextualTabs"));if(IsNull($v_1)||!$v_1.length)return;for(var $v_2=false,$v_6=0;$v_6<$v_1.length;$v_6++)if(!$v_2&&CUI.DataNodeWrapper.getNodeAttribute($v_1[$v_6],"Id")==="Mscrm.ContextualCommandBar"){this.$BR_0($v_1[$v_6],true);$v_2=true}else this.$BQ_0($v_1[$v_6],true);this.get_commandBarBuildOptions().$1t_0.$82_3=this.$18_0},$7e_0:function($p0){var $v_0=CUI.DataNodeWrapper.getNodeAttribute($p0,"Id");return this.$4C_0.$7M_0[$v_0]},$GW_0:function($p0){var $v_0=CUI.DataNodeWrapper.getNodeAttribute($p0,"Id");return $v_0.search(Mscrm.CommandBarBuilder.$Aa)>=0},$GV_0:function($p0){var $v_0=CUI.DataNodeWrapper.getNodeAttribute($p0,"Id");return $v_0.search(Mscrm.CommandBarBuilder.$AZ)>=0},$BR_0:function($p0,$p1){for(var $v_0=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Groups"),$v_1=CUI.DataNodeWrapper.getNodeChildren($v_0),$v_2=0;$v_2<$v_1.length;$v_2++){if(this.$7e_0($v_1[$v_2]))continue;for(var $v_3=new CUI.DataNodeWrapper($v_1[$v_2]),$v_4=null,$v_6=0;$v_6<$v_3.get_children().length;$v_6++)if($v_3.get_children()[$v_6].name==="Controls"){$v_4=$v_3.get_children()[$v_6];break}if(CUI.ScriptUtility.isNullOrUndefined($v_4))throw Error.create("No Controls node found in this Group tag.");for(var $v_5=CUI.DataNodeWrapper.getNodeChildren($v_4),$v_7=0;$v_7<$v_5.length;$v_7++){if(this.$7e_0($v_5[$v_7]))continue;var $v_8=null;if(this.$GW_0($v_5[$v_7])){$v_8=Mscrm.CommandBarBuilder.$6H($v_5[$v_7],this.$4C_0.$1t_0,this.$N_0,this.$18_0,false);if(IsNull($v_8))continue;Array.add(this.$4N_0[0],$v_8)}else if(this.$GV_0($v_5[$v_7])){$v_8=Mscrm.CommandBarBuilder.$6H($v_5[$v_7],this.$4C_0.$1t_0,this.$N_0,this.$18_0,false);if(IsNull($v_8))continue;Array.add(this.$4N_0[1],$v_8)}else{$v_8=Mscrm.CommandBarBuilder.$6H($v_5[$v_7],this.$4C_0.$1t_0,this.$N_0,this.$18_0,false);if(IsNull($v_8))continue;Array.add(this.$N_0.get_renderedControls(),$v_8);this.$BX_0(this.$N_0,$p1)}var $v_9=$v_8;if($v_9)$v_9.sections=Mscrm.CommandBarBuilder.$CJ($v_5[$v_7])}}},$BQ_0:function($p0,$p1){var $v_0=Mscrm.CommandBarBuilder.$6H($p0,this.$4C_0.$1t_0,this.$N_0,this.$18_0,false);Array.add(this.$N_0.get_renderedControls(),$v_0);this.$BX_0(this.$N_0,$p1);var $v_1=$v_0;$v_1.sections=[];for(var $v_2=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Groups"),$v_3=CUI.DataNodeWrapper.getNodeChildren($v_2),$v_4=0,$v_5=0;$v_5<$v_3.length;$v_5++){if(this.$7e_0($v_3[$v_5]))continue;for(var $v_6=new CUI.DataNodeWrapper($v_3[$v_5]),$v_7=null,$v_9=0;$v_9<$v_6.get_children().length;$v_9++)if($v_6.get_children()[$v_9].name==="Controls"){$v_7=$v_6.get_children()[$v_9];break}if(CUI.ScriptUtility.isNullOrUndefined($v_7))throw Error.create("No Controls node found in this Group tag.");for(var $v_8=CUI.DataNodeWrapper.getNodeChildren($v_7),$v_A=0;$v_A<$v_8.length;$v_A++){var $v_B=$v_8[$v_A];if(this.$7e_0($v_B))continue;$v_1.sections[$v_4++]=$v_8[$v_A]}}},$CZ_0:function($p0,$p1,$p2){var $v_0=document.createElement("ul");$v_0.className="ms-crm-CommandBar-Menu";switch($p2){case 0:$v_0.className+=String.format(" {0}","ms-crm-chartsPaneCommand-Bar");break;case 1:$v_0.className+=String.format(" {0}","ms-crm-chartDesignerCommand-Bar");break}if(this.get_commandBarBuildOptions().$1t_0.get_$3V_3())$v_0.className+=String.format(" {0}","ms-crm-AssociatedGridCommandBar-Menu");$p0.appendChild($v_0);var $v_1=Mscrm.CrmUIComponent.crmCreate(Mscrm.CommandBar,null,null,null,$p0);$v_1.setCommandBuildOptions($p1.$1t_0,$p1.$2V_0,$p2,$p1.$t_0);$v_1.initialize();return $v_1},$AD_0:function($p0){$p0.evaluateCommands(true,false,false);$p0.refreshCommandBarContent(true);window.self.CommandBarInitialLoadTime=(new Date).getTime()},$BX_0:function($p0,$p1){if(!$p1)if(!this.$N_0.evaluateCommands(true,false,false))if(!this.$5n_0){this.$AD_0($p0);this.$5n_0=true}}};Mscrm.TemplateGenerator=function(){};Mscrm.TemplateGenerator.get_$6C=function(){if(window.screen.availWidth>1e3)return 200;else return 200};Mscrm.TemplateGenerator.get_$AU=function(){return Mscrm.TemplateGenerator.get_$6C()-50};Mscrm.TemplateGenerator.get_$9L=function(){!Mscrm.TemplateGenerator.$6P&&Mscrm.TemplateGenerator.$Fr();return Mscrm.TemplateGenerator.$6P};Mscrm.TemplateGenerator.get_commandBarTemplateSet=function(){return Mscrm.TemplateGenerator.$5K};Mscrm.TemplateGenerator.set_commandBarTemplateSet=function(value){Mscrm.TemplateGenerator.$5K=value;return value};Mscrm.TemplateGenerator.get_buttonTemplate=function(){!Mscrm.TemplateGenerator.$6Q&&Mscrm.TemplateGenerator.$Fs();return Mscrm.TemplateGenerator.$6Q};Mscrm.TemplateGenerator.get_checkBoxTemplate=function(){!Mscrm.TemplateGenerator.$6R&&Mscrm.TemplateGenerator.$Ft();return Mscrm.TemplateGenerator.$6R};Mscrm.TemplateGenerator.get_flyOutAnchorTemplate=function(){!Mscrm.TemplateGenerator.$6o&&Mscrm.TemplateGenerator.$Fv();return Mscrm.TemplateGenerator.$6o};Mscrm.TemplateGenerator.get_splitButtonTemplate=function(){!Mscrm.TemplateGenerator.$7H&&Mscrm.TemplateGenerator.$Fy();return Mscrm.TemplateGenerator.$7H};Mscrm.TemplateGenerator.get_customTabTemplate=function(){!Mscrm.TemplateGenerator.$6X&&Mscrm.TemplateGenerator.$Fu();return Mscrm.TemplateGenerator.$6X};Mscrm.TemplateGenerator.get_spinnerControlTemplate=function(){!Mscrm.TemplateGenerator.$7G&&Mscrm.TemplateGenerator.$Fx();return Mscrm.TemplateGenerator.$7G};Mscrm.TemplateGenerator.$Fr=function(){var $v_0=new Sys.StringBuilder;$v_0.append('title ="${ToolTipTitle}${ToolTipDescription}" id ="${Id}" command="${Command}" style = "white-space:pre-line">');$v_0.append(String.format('<span tabindex="-1" class="{0} {1}" style = "max-width:{2}px">',"ms-crm-Menu-Label","ms-crm-CommandBar-Button",Mscrm.TemplateGenerator.get_$6C()));$v_0.append(String.format('<a tabindex="0" class="{0}" onclick="return false" >',"ms-crm-Menu-Label"));$v_0.append('<img  tabindex="-1" class="${Image16by16Class} ms-crm-commandbar-image16by16" src="${Image16by16}" style="vertical-align:top" alt="${Alt}"> </img>');$v_0.append(String.format('<span tabindex="-1" class="{0}" style = "max-width:{1}px"',"ms-crm-CommandBar-Menu",Mscrm.TemplateGenerator.get_$AU()));$v_0.append(' command="${Command}" > ${LabelText} </span>');Mscrm.TemplateGenerator.$6P=$v_0.toString();Mscrm.TemplateGenerator.$5K=true};Mscrm.TemplateGenerator.$Fs=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2}"',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-Button"));$v_0.append(Mscrm.TemplateGenerator.get_$9L());$v_0.append(" </a> </span> </li>");Mscrm.TemplateGenerator.$6Q=$v_0.toString()};Mscrm.TemplateGenerator.$Ft=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2}"',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-Checkbox"));$v_0.append('title ="${ToolTipTitle}${ToolTipDescription}" id ="${Id}" command="${Command}" style = "white-space:pre-line">');$v_0.append(String.format('<span class="{0} {1}" style = "max-width:{2}px">',"ms-crm-Menu-Label","ms-crm-CommandBar-Button",Mscrm.TemplateGenerator.get_$6C()));$v_0.append(String.format('<a tabindex="0" class="{0}" onclick="return false" >',"ms-crm-Menu-Label"));$v_0.append(String.format('<input tabindex="0" class="{0}" type="checkbox" style = "width:auto" >',"ms-crm-Menu-Label"));$v_0.append(String.format('<span tabindex="-1" class="{0}" style = "max-width:{1}px"',"ms-crm-CommandBar-Menu",Mscrm.TemplateGenerator.get_$AU()));$v_0.append(' command="${Command}" > ${LabelText} </span>');$v_0.append(" </a> </span> </li>");Mscrm.TemplateGenerator.$6R=$v_0.toString()};Mscrm.TemplateGenerator.$Fv=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2}"',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-FlyoutAnchor"));$v_0.append(Mscrm.TemplateGenerator.get_$9L());$v_0.append('<img tabindex="-1" class="flyoutAnchorArrow" src="/_imgs/CommandBarMenuDown.png" id="${ArrowId}" alt="" >');$v_0.append(" </a> </span> </li>");Mscrm.TemplateGenerator.$6o=$v_0.toString()};Mscrm.TemplateGenerator.$Fy=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2}"',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-SplitButton"));$v_0.append(Mscrm.TemplateGenerator.get_$9L());$v_0.append('<span class="splitButtonSplitter">');$v_0.append('<img tabindex="-1" class="ms-crm-ImageStrip-commandbar_divider" src="/_imgs/imagestrips/transparent_spacer.gif" alt="" />');$v_0.append("</span>");$v_0.append("</a>");$v_0.append('<a tabindex="0" class="ms-crm-Menu-Label-Flyout" onclick="return false" role="flyout" >');$v_0.append('<img tabindex="-1" class="flyoutAnchorArrow" src="/_imgs/CommandBarMenuDown.png" id="${ArrowId}" role="flyout" alt="" />');$v_0.append(" </a> </span> </li>");Mscrm.TemplateGenerator.$7H=$v_0.toString()};Mscrm.TemplateGenerator.$Fu=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2} {3}" ',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-CustomTab"));$v_0.append('title ="${ToolTipTitle}${ToolTipDescription}" id ="${Id}" command="${Command}" style = "white-space:pre-line">');$v_0.append(String.format('<span class="{0} {1}" style = "max-width:{2}px">',"ms-crm-Menu-Label","ms-crm-CommandBar-Button",Mscrm.TemplateGenerator.get_$6C()));$v_0.append(String.format('<a tabindex="0" class="{0}" onclick="return false" >',"ms-crm-Menu-Label"));$v_0.append('<img  tabindex="-1" class="${Image16by16Class}" src="${Image16by16}" style="vertical-align:top" alt="${Alt}"> </img>');$v_0.append(String.format('<span tabindex="-1" class="{0}" style = "max-width:{1}px"',"ms-crm-CommandBar-Menu",Mscrm.TemplateGenerator.get_$AU()));$v_0.append(' command="${Command}" > ${Title} </span>');$v_0.append('<img tabindex="-1" class="flyoutAnchorArrow" src="/_imgs/CommandBarMenuDown.png" id="${ArrowId}" alt="" >');$v_0.append(" </a> </span> </li>");Mscrm.TemplateGenerator.$6X=$v_0.toString()};Mscrm.TemplateGenerator.$Fx=function(){var $v_0=new Sys.StringBuilder;$v_0.append(String.format('<li tabindex="-1" class="{0} {1} {2}" ',"ms-crm-CommandBarItem","ms-crm-CommandBar-Menu","ms-crm-CommandBar-Spinner"));$v_0.append('title ="${ToolTipTitle}${ToolTipDescription}" id ="${Id}" command="${Command}" style = "white-space:pre-line">');$v_0.append(String.format('<span class="{0} {1}" style="display:inline-block;max-width:{2}px " >',"ms-crm-Menu-Label","ms-crm-CommandBar-Button",Mscrm.TemplateGenerator.get_$6C()));$v_0.append(String.format('<input tabindex="-1" class="{0} {1}" type="textbox" style="width:auto" ',"ms-crm-Menu-Label","ms-crm-CommandBar-Input-Container"));$v_0.append('value="${DefaultValue}" >');$v_0.append("</span>");$v_0.append(String.format('<span class="{0} {1}" tabindex="-1" style="display:inline-block;vertical-align:top;width:13px;"',"ms-crm-Menu-Label","ms-crm-CommandBar-Button"));$v_0.append('id ="${Id}" command="${Command}" >');$v_0.append('<div tabindex="-1" style="height:11px">');$v_0.append('<a tabindex="0" class="ms-crm-CommandBar-Spinner-Up" role="UpArrow" style="display:block">');$v_0.append('<img tabindex="-1" class="SpinnerUpArrow" src="/_imgs/CommandBarMenuDown.png" style="width:13px;height:11px;display:block" id="${UpArrowId}" >');$v_0.append("</a>");$v_0.append("</div>");$v_0.append('<div tabindex="-1" style="height:11px">');$v_0.append('<a tabindex="0" class="ms-crm-CommandBar-Spinner-Down" role="DownArrow" style="display:block">');$v_0.append('<img tabindex="-1" class="SpinnerDownArrow" src="/_imgs/CommandBarMenuDown.png" style="width:13px;height:11px;display:block" id="${DownArrowId}" >');$v_0.append("</a>");$v_0.append("</div>");$v_0.append("</span>");$v_0.append(" </li>");Mscrm.TemplateGenerator.$7G=$v_0.toString()};Mscrm.CommandBarConstants=function(){};Mscrm.ButtonControl=function($p0,$p1){Mscrm.ButtonControl.initializeBase(this,[$p1]);this.command=$p0};Mscrm.ButtonControl.prototype={click:function($p0,$p1){this.executeCommand($p0,null)},getTemplateName:function(){return "CommandBarButtonTemplate"}};Mscrm.CommandBarControl=function($p0){this.ribbonData=$p0};Mscrm.CommandBarControl.factoryMethod=function($p0,$p1,$p2){var $v_0=$p0.name,$v_1=$p2["Command"],$v_2=null;switch($v_0){case "FlyoutAnchor":$v_2=new Mscrm.FlyoutAnchorControl($p2,$p1);break;case "SplitButton":$v_2=new Mscrm.SplitButtonControl($p2,$v_1,$p1);break;case "Button":$v_2=new Mscrm.ButtonControl($v_1,$p1);break;case "CheckBox":$v_2=new Mscrm.CheckBoxControl($p2,$v_1,$p1);break;case "Tab":$v_2=new Mscrm.CustomTabControl($p1);break;case "ToggleButton":$v_2=new Mscrm.ToggleButtonControl($p2,$v_1,$p1);break;case "Spinner":$v_2=new Mscrm.SpinnerControl($p0,$v_1,$p1);break}if($v_2){$v_2.setAttributes($p2);return $v_2}return null};Mscrm.CommandBarControl.prototype={ribbonData:null,id:null,isInMenu:false,command:null,$4B_0:false,$y_0:null,$6N_0:false,$8A_0:null,$At_0:false,$20_0:null,$7y_0:null,$5Q_0:false,get_parentMenu:function(){return this.$20_0},set_parentMenu:function($p0){this.$20_0=$p0;return $p0},get_commandBar:function(){if(!IsNull(this.$7y_0))return this.$7y_0;if(!IsNull(this.$20_0))return this.$20_0.get_commandBar();return null},set_commandBar:function($p0){this.$7y_0=$p0;return $p0},get_isVisible:function(){return this.$At_0},set_isVisible:function($p0){this.$At_0=$p0;return $p0},setAttribute:function($p0,$p1){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined(this.$y_0)){this.$y_0[$p0]=$p1;this.$6N_0=true;return true}return false},setAttributes:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)){this.$y_0=$p0;this.$6N_0=true;return true}return false},getAttribute:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined(this.$y_0))return this.$y_0[$p0];return null},$S_0:0,get_count:function(){return this.$S_0},set_count:function($p0){if($p0>=0)this.$S_0=$p0;if(this.$S_0>0)this.$y_0["Id"]=this.$y_0["Id"]+"_"+this.$S_0.toString();return $p0},get_element:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$8A_0)||this.$6N_0){var $v_0=null,$v_1=null;if(!CUI.ScriptUtility.isNullOrUndefined(this.$y_0)){var $v_3=this.$y_0.Image16by16;if(CUI.ScriptUtility.isNullOrUndefined($v_3)||!$v_3.length){this.$y_0["Image16by16"]="/_imgs/imagestrips/transparent_spacer.gif";this.$y_0["Image16by16Class"]="ms-cui-img-16by16"}$v_0=this.$y_0["ToolTipTitle"];$v_1=this.$y_0["ToolTipDescription"];if(!isNullOrEmptyString($v_1)){if(!isNullOrEmptyString($v_0))this.$y_0["ToolTipTitle"]=$v_0+" \n\n";var $v_4=new RegExp("<br\\s*[\\/]?>","ig");this.$y_0["ToolTipDescription"]=$v_1.replace($v_4,"\n")}}var $v_2=$P_CRM.tmpl(this.getTemplateName(),Mscrm.CommandBarBuilder.$G3(this.$y_0));this.$8A_0=$v_2[0].cloneNode(true);$P_CRM.tmpl.complete($v_2);$v_2.removeData("tmplItem");if(!CUI.ScriptUtility.isNullOrUndefined(this.$y_0)&&!isNullOrEmptyString($v_1))this.$y_0["ToolTipTitle"]=$v_0;this.$6N_0=false}return this.$8A_0},get_dynamicControl:function(){return this.$5Q_0},set_dynamicControl:function($p0){this.$5Q_0=$p0;return $p0},executeCommand:function($p0,$p1){if(!IsNull(this.ribbonData)){if(IsNull($p1))$p1={};$p1["SourceControlId"]=IsNull(this.id)?$p0.id:this.id;var $v_0=this.getAttribute("CommandValueId");if(!IsNull($v_0))$p1["CommandValueId"]=$v_0;this.get_commandBar().$Bo_4(.5);try{this.ribbonData.executeCommand(this.command,$p1);this.$5Q_0&&Mscrm.RibbonManager.get_$2y().$v_1.executeCommand(this.command,$p1)}finally{this.get_commandBar().$Bq_4(true)}}}};Mscrm.MenuAwareControl=function($p0){Mscrm.MenuAwareControl.initializeBase(this,[$p0])};Mscrm.MenuAwareControl.prototype={sections:null,menu:null,populateDynamically:false,populateOnlyOnce:false,populateQueryCommand:null,getNewId:function(){if(!this.get_count())return this.id.replace(/\|/g,"_").replace(/\./g,"_").concat("Menu");else return this.id.replace(/\|/g,"_").replace(/\./g,"_").concat("Menu")+"_"+this.get_count().toString()},showMenuInternal:function(){var $v_0=new Sys.StringBuilder;if(!IsNull(this.sections)&&this.sections.length>0){var $v_2=document.createElement("ul");$v_2.className="ms-crm-CommandBar-Menu";if(Object.getType(this)===Mscrm.CustomTabControl)this.$DB_1(this.sections,$v_0);else for(var $v_3=0;$v_3<this.sections.length;$v_3++){var $v_4=this.sections[$v_3];this.$I4_1($v_4,$v_0);var $v_5=CUI.DataNodeWrapper.getNodeChildren($v_4),$v_6=CUI.DataNodeWrapper.getNodeChildren($v_5[0]);this.$DB_1($v_6,$v_0)}}if($v_0.isEmpty()){var $v_7={};$v_7["Id"]=this.getNewId()+"_dummControl";$v_7["LabelText"]=window.LOCID_DUMMYCONTROL_LABEL;$v_7["Image16by16"]="/_imgs/imagestrips/transparent_spacer.gif";$v_7["Image16by16Class"]="ms-cui-img-16by16";var $v_8=new Mscrm.ButtonControl("",this.ribbonData);$v_8.setAttributes($v_7);$v_0.append(XUI.Html.GetOuterHTML($v_8.get_element()))}var $v_1=$v_0.toString();if(!this.menu)this.menu=new Mscrm.CommandBarMenu("#"+this.getNewId(),String.format("<ul id='{0}'></ul>",this.getNewId()),this.getAttribute("Id"),this.get_commandBar(),this.$20_0);if(!IsNull(this.$20_0)&&this.$20_0.$2a_0!==this.menu){!IsNull(this.$20_0.$2a_0)&&this.$20_0.$2a_0.hideFlyout();this.$20_0.$2a_0=this.menu}this.menu.$1n_0=this.$20_0;this.menu.processAndShowMenu($v_1,this.ribbonData,this.isInMenu)},showMenu:function(){this.populateDynamically&&this.$Fi_1();this.showMenuInternal()},$78_1:false,$Fi_1:function(){if(this.$78_1&&this.populateOnlyOnce)return;if(!this.populateQueryCommand)return;var $v_0=this.ribbonData.getDynamicMenuRibbonFromCommand(this.populateQueryCommand,null);if($v_0){var $v_1=CUI.Builder.$Be($v_0);if($v_1){var $v_2=CUI.DataNodeWrapper.getNodeChildren($v_1);if($v_2&&$v_2.length>0){this.sections=$v_2;this.$78_1=true}}}},$DB_1:function($p0,$p1){for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=Mscrm.CommandBarBuilder.$6H($p0[$v_0],this.ribbonData,this.get_commandBar(),null,true);if(!IsNull($v_1)){if(Mscrm.MenuAwareControl.isInstanceOfType($v_1))$v_1.sections=Mscrm.CommandBarBuilder.$CJ($p0[$v_0]);if(this.populateDynamically)$v_1.$5Q_0=true;if(Mscrm.CommandBar.$7a($v_1,this.ribbonData)){$v_1.set_isVisible(true);$v_1.isInMenu=true;$p1.append(XUI.Html.GetOuterHTML($v_1.get_element()))}else $v_1.set_isVisible($v_1.isInMenu=false)}}},$I4_1:function($p0,$p1){var $v_0=$p0.attrs,$v_1=$v_0["Title"];if(!isNullOrEmptyString($v_1)){var $v_2=String.format('<div class="ms-cui-menusection-title">{0}</div>',$v_1);$p1.append($v_2)}}};Mscrm.FlyoutAnchorControl=function($p0,$p1){Mscrm.FlyoutAnchorControl.initializeBase(this,[$p1]);if(!IsNull($p0)){this.populateDynamically=$p0.PopulateDynamically;this.populateOnlyOnce=$p0.PopulateOnlyOnce;this.populateQueryCommand=$p0.PopulateQueryCommand}};Mscrm.FlyoutAnchorControl.prototype={click:function($p0,$p1){var $v_0=Mscrm.Utilities.getParentElementByTagName($p1.target,"LI");if(!IsNull($v_0)){var $v_1=$v_0.children[0];!IsNull($v_1)&&Sys.UI.DomElement.addCssClass($v_1,"ms-crm-CommandBar-button-selected")}this.showMenu()},getTemplateName:function(){return "CommandBarFlyoutAnchorTemplate"}};Mscrm.ToggleButtonControl=function($p0,$p1,$p2){Mscrm.ToggleButtonControl.initializeBase(this,[$p2]);this.command=$p1;this.$A8_1=$p0.QueryCommand;$p2.get_toggleButtonState()[$p1]=false;this.isActive=false};Mscrm.ToggleButtonControl.prototype={$A8_1:null,get_isVisible:function(){return Mscrm.CommandBarControl.prototype.get_isVisible.call(this)},set_isVisible:function($p0){if($p0){this.isActive=this.ribbonData.get_toggleButtonState()[this.command];this.setButtonState(this.get_element(),this.isActive)}Mscrm.CommandBarControl.prototype.set_isVisible.call(this,$p0);return $p0},isActive:false,click:function($p0,$p1){this.isActive=!this.isActive;this.setButtonState($p0,this.isActive);this.executeCommand($p0,null)},setButtonState:function($p0,$p1){$p1=this.evaluateState($p1);var $v_0=$P_CRM(XUI.Html.DomUtils.GetFirstChild(this.getElement($p0)));if($p1)this.$Hx_1($v_0);else this.$Hy_1($v_0)},evaluateState:function($p0){if(!isNullOrEmptyString(this.$A8_1)){var $v_0={};this.ribbonData.executeCommand(this.$A8_1,$v_0);if(!IsNull($v_0["On"]))$p0=$v_0["On"]}return $p0},$Hx_1:function($p0){$p0.addClass("ms-crm-CommandBarToggleButton-Active");this.ribbonData.get_toggleButtonState()[this.command]=true},$Hy_1:function($p0){$p0.removeClass("ms-crm-CommandBarToggleButton-Active");this.ribbonData.get_toggleButtonState()[this.command]=false},getElement:function($p0){if(IsNull($p0))return this.get_element();return Mscrm.Utilities.getParentElementByTagName($p0,"LI")},getTemplateName:function(){return "CommandBarButtonTemplate"}};Mscrm.SplitButtonControl=function($p0,$p1,$p2){Mscrm.SplitButtonControl.initializeBase(this,[$p2]);this.command=$p1;if(!IsNull($p0)){this.populateDynamically=$p0.PopulateDynamically;this.populateOnlyOnce=$p0.PopulateOnlyOnce;this.populateQueryCommand=$p0.PopulateQueryCommand}};Mscrm.SplitButtonControl.prototype={click:function($p0,$p1){var $v_0=$p1.target.attributes.getNamedItem("role");if($v_0&&$v_0.value==="flyout"){var $v_1=Mscrm.Utilities.getParentElementByTagName($p1.target,"LI"),$v_2=$v_1.children[0];if(!IsNull($v_2)){Sys.UI.DomElement.addCssClass($v_2.children[0],"ms-crm-CommandBar-button-split-selected");var $v_3=Mscrm.Utilities.getChildElementsByClassName($v_2.children[0],"splitButtonSplitter",true)[0];if(!IsNull($v_3))$v_3.style.visibility="hidden";Sys.UI.DomElement.addCssClass($v_2.children[1],"ms-crm-CommandBar-button-selected")}this.showMenu()}else this.executeCommand($p0,null)},getTemplateName:function(){return "CommandBarSplitButtonTemplate"},onHoverHandler:function($p0){var $v_0=$p0.attributes.getNamedItem("role"),$v_1=Mscrm.Utilities.getParentElementByTagName($p0,"SPAN");if(!IsNull($v_1))if($v_0&&$v_0.value==="flyout"){Sys.UI.DomElement.addCssClass($v_1.children[0],"ms-crm-commandbar-split-hover");var $v_2=Mscrm.Utilities.getChildElementsByClassName($v_1.children[0],"splitButtonSplitter",true)[0];!IsNull($v_2)&&Sys.UI.DomElement.addCssClass($v_2,"splitButtonSplitter-hidden");Sys.UI.DomElement.addCssClass($v_1.children[1],"ms-crm-commandbar-hoveredOver")}else{Sys.UI.DomElement.addCssClass($v_1.children[0],"ms-crm-commandbar-hoveredOver");var $v_3=Mscrm.Utilities.getChildElementsByClassName($v_1.children[0],"splitButtonSplitter",true)[0];!IsNull($v_3)&&Sys.UI.DomElement.addCssClass($v_3,"splitButtonSplitter-hidden");Sys.UI.DomElement.addCssClass($v_1.children[1],"ms-crm-commandbar-split-hover")}},onUnHoverHandler:function($p0){var $v_0=$p0.attributes.getNamedItem("role"),$v_1=Mscrm.Utilities.getParentElementByTagName($p0,"SPAN");if(!IsNull($v_1))if($v_0&&$v_0.value==="flyout"){Sys.UI.DomElement.removeCssClass($v_1.children[0],"ms-crm-commandbar-split-hover");var $v_2=Mscrm.Utilities.getChildElementsByClassName($v_1.children[0],"splitButtonSplitter",true)[0];!IsNull($v_2)&&Sys.UI.DomElement.removeCssClass($v_2,"splitButtonSplitter-hidden");Sys.UI.DomElement.removeCssClass($v_1.children[1],"ms-crm-commandbar-hoveredOver")}else{Sys.UI.DomElement.removeCssClass($v_1.children[0],"ms-crm-commandbar-hoveredOver");var $v_3=Mscrm.Utilities.getChildElementsByClassName($v_1.children[0],"splitButtonSplitter",true)[0];!IsNull($v_3)&&Sys.UI.DomElement.removeCssClass($v_3,"splitButtonSplitter-hidden");Sys.UI.DomElement.removeCssClass($v_1.children[1],"ms-crm-commandbar-split-hover")}}};Mscrm.CustomTabControl=function($p0){Mscrm.CustomTabControl.initializeBase(this,[$p0])};Mscrm.CustomTabControl.prototype={click:function($p0,$p1){this.showMenu()},getTemplateName:function(){return "CommandBarCustomTabTemplate"}};Mscrm.CheckBoxControl=function($p0,$p1,$p2){Mscrm.CheckBoxControl.initializeBase(this,[$p0,$p1,$p2])};Mscrm.CheckBoxControl.prototype={click:function($p0,$p1){this.isActive=!this.isActive;this.isActive=this.evaluateState(this.isActive);this.setButtonState($p0,this.isActive);this.$Eb_2($p0,this.isActive)},$Eb_2:function($p0,$p1){if(!IsNull(this.ribbonData)){var $v_0={};$v_0["On"]=$p1;this.executeCommand($p0,$v_0)}},setButtonState:function($p0,$p1){var $v_0=this.getElement($p0),$v_1=$v_0.getElementsByTagName("input")[0];!IsNull($v_1)&&this.$Hz_2($v_1,$p1)},$Hz_2:function($p0,$p1){$p0.checked=$p1;this.ribbonData.get_toggleButtonState()[this.command]=$p1},getTemplateName:function(){return "CommandBarCheckBoxTemplate"}};Mscrm.SpinnerCommandProperties=function(){};Mscrm.SpinnerControl=function($p0,$p1,$p2){Mscrm.SpinnerControl.initializeBase(this,[$p2]);this.command=$p1;if(!CUI.ScriptUtility.isNullOrUndefined($p0)){this.$7l_1=$p0.attrs;this.$14_1=this.$BU_1($p0)}this.$DT_1()};Mscrm.SpinnerControl.$F0=function($p0,$p1,$p2,$p3,$p4,$p5){return new CUI.Unit($p0,$p1,$p2,$p3,$p4,$p5)};Mscrm.SpinnerControl.$C4=function($p0,$p1){var $v_0=Math.pow(10,$p1.$6Z_0);return Math.round($p0*$v_0)/$v_0};Mscrm.SpinnerControl.prototype={$J_1:null,$14_1:null,$o_1:0,$7O_1:false,get_isVisible:function(){return Mscrm.CommandBarControl.prototype.get_isVisible.call(this)},set_isVisible:function($p0){!CUI.ScriptUtility.isNullOrUndefined($p0)&&$p0&&this.$7r_1(this.$o_1,this.$J_1.get_$2z_0());Mscrm.CommandBarControl.prototype.set_isVisible.call(this,$p0);return $p0},$5m_1:null,get_inputElement:function(){var $v_0=$get(this.$7l_1["Id"]);if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$5m_1=$v_0.getElementsByTagName("input")[0];else this.$5m_1=this.get_element().getElementsByTagName("input")[0];return this.$5m_1},$7l_1:null,$2g_1:null,getTemplateName:function(){return "CommandBarSpinnerTemplate"},$DT_1:function(){var $v_0=parseFloat(this.$7l_1["DefaultValue"]);this.$J_1=this.$9b_1(this.$7l_1["DefaultUnit"]);if(CUI.ScriptUtility.isNullOrUndefined(this.$J_1))throw Error.create("The default unit is not in the list of valid units");$v_0!==Number.NaN&&this.$Dd_1($v_0);this.$2g_1={};this.$2g_1["Value"]=this.$o_1;this.$2g_1["Unit"]=this.$J_1.$3p_0},$BU_1:function($p0){for(var $v_0=CUI.DataNodeWrapper.getNodeChildren($p0),$v_1=$v_0.length,$v_2=new Array($v_1),$v_3=0;$v_3<$v_1;$v_3++){var $v_4=$v_0[$v_3],$v_5=CUI.DataNodeWrapper.getNodeAttributes($v_4);$v_2[$v_3]=Mscrm.SpinnerControl.$F0($v_5["Name"],this.$BT_1(CUI.DataNodeWrapper.getNodeChildren($v_4)),this.$55_1($v_5["MinimumValue"]),this.$55_1($v_5["MaximumValue"]),this.$Bc_1($v_5["DecimalDigits"]),this.$55_1($v_5["Interval"]))}return $v_2},$BT_1:function($p0){for(var $v_0=$p0.length,$v_1=new Array($v_0),$v_2=0;$v_2<$v_0;$v_2++){var $v_3=$p0[$v_2],$v_4=CUI.DataNodeWrapper.getNodeAttributes($v_3);$v_1[$v_2]=$v_4["Value"]}return $v_1},$55_1:function($p0){if(typeof $p0==="string")return parseFloat($p0);return $p0},$Bc_1:function($p0){if(typeof $p0==="string")return parseInt($p0);return $p0},click:function($p0,$p1){if(!CUI.ScriptUtility.isNullOrUndefined($p1)&&!CUI.ScriptUtility.isNullOrUndefined($p1.target)){var $v_0=$p1.target;if($p1.target.tagName.toUpperCase()==="IMG")$v_0=Mscrm.Utilities.getParentElementByTagName($v_0,"A");if(!IsNull($v_0))if($v_0.getAttribute("role")==="UpArrow")this.$Da_1($p0);else if($v_0.getAttribute("role")==="DownArrow")this.$DZ_1($p0);else this.$AV_1($p0)}},onKeyUpDown:function($p0,$p1){if($p1===38){var $v_0=Mscrm.Utilities.getChildElementsByClassName($p0,"ms-crm-CommandBar-Spinner-Up",true);$v_0[0].focus();this.$Da_1($p0)}else if($p1===40){var $v_1=Mscrm.Utilities.getChildElementsByClassName($p0,"ms-crm-CommandBar-Spinner-Down",true);$v_1[0].focus();this.$DZ_1($p0)}},$Da_1:function($p0){this.$9u_1(1);this.$2g_1["ChangeType"]="increase";this.$2g_1["ChangedByMouse"]=true;this.$AV_1($p0)},$DZ_1:function($p0){this.$9S_1(1);this.$2g_1["ChangeType"]="decrease";this.$2g_1["ChangedByMouse"]=true;this.$AV_1($p0)},$AV_1:function($p0){if(!IsNull(this.ribbonData)&&!CUI.ScriptUtility.isNullOrUndefined($p0)){var $v_0={},$$dict_2=this.$2g_1;for(var $$key_3 in $$dict_2){var $v_1={key:$$key_3,value:$$dict_2[$$key_3]};$v_0[$v_1.key]=$v_1.value}this.executeCommand($p0,$v_0)}},$9u_1:function($p0){if(!Mscrm.CommandBarControl.prototype.get_isVisible.call(this))return;if(!this.$1o_1(this.$J_1,this.$o_1+$p0*this.$J_1.$61_0))if(this.$o_1<this.$J_1.$3I_0)this.$1o_1(this.$J_1,this.$J_1.$3I_0);else{this.$3X_1();return}},$9S_1:function($p0){if(!Mscrm.CommandBarControl.prototype.get_isVisible.call(this))return;if(!this.$1o_1(this.$J_1,this.$o_1-$p0*this.$J_1.$61_0))if(this.$o_1>this.$J_1.$3J_0)this.$1o_1(this.$J_1,this.$J_1.$3J_0);else{this.$3X_1();return}},$Dd_1:function($p0){this.$o_1=$p0;this.get_isVisible()&&!CUI.ScriptUtility.isNullOrUndefined(this.get_inputElement())&&this.$7r_1($p0,this.$J_1.get_$2z_0())},get_value:function(){return this.$o_1},set_value:function($p0){if(!this.$1o_1(this.$J_1,$p0))throw Error.create("Invalid value");return $p0},get_unitString:function(){return this.$J_1.get_$2z_0()},set_unitString:function($p0){if(!this.$AX_1(this.$o_1.toString()+$p0)){this.$3X_1();throw Error.create("Invalid unit")}return $p0},$6u_1:false,$6t_1:false,get_$58_1:function(){if(!this.$6u_1){var $v_0=1.1,$v_1=$v_0.toLocaleString().substring(1,2);this.$6t_1=$v_1===",";this.$6u_1=true}return this.$6t_1},$AX_1:function($p0){var $v_0="(\\-)?[0-9]*[\\.,]?[0-9]+",$v_1=new RegExp($v_0);$p0=$p0.trim();if($p0.search($v_1))return false;var $v_2=$p0.replace($v_1,""),$v_3=$p0.replace($v_2,""),$v_4=$v_2.trim(),$v_5,$v_6,$v_7=false;if(this.get_$58_1()){$v_3=$v_3.replace(".","");if($v_3.indexOf(",")>-1){$v_7=true;$v_3=$v_3.replace(",",".")}}else $v_3=$v_3.replace(",","");$v_6=parseFloat($v_3);if(!CUI.ScriptUtility.isNullOrEmptyString($v_4))if(this.$J_1.$54_0($v_4))$v_5=this.$J_1;else $v_5=this.$C2_1($v_4);else $v_5=this.$J_1;return this.$1o_1($v_5,$v_6,$v_7)},$1o_1:function($p0,$p1,$p2){if(arguments.length<3)$p2=this.get_$58_1();if(CUI.ScriptUtility.isNullOrUndefined($p0))return false;var $v_0=$p0.$Dk_0($p1);if($v_0===CUI.Unit.$7Z)return false;else if($v_0===1)$p1=Mscrm.SpinnerControl.$C4($p1,$p0);else if($v_0===2)$p1=$p0.$3J_0;else if($v_0===3)$p1=$p0.$3I_0;!CUI.ScriptUtility.isNullOrUndefined(this.get_inputElement())&&this.$7r_1($p1,$p0.get_$2z_0(),$p2);this.$J_1=$p0;this.$o_1=$p1;this.$7O_1=$p2;this.$2g_1["Unit"]=$p0.$3p_0;this.$2g_1["Value"]=$p1;return true},$3X_1:function(){!CUI.ScriptUtility.isNullOrUndefined(this.get_inputElement())&&this.$7r_1(this.$o_1,this.$J_1.get_$2z_0(),this.$7O_1)},$7r_1:function($p0,$p1,$p2){if(arguments.length<3)$p2=this.get_$58_1();var $v_0=$p0.toString();if($p2)$v_0=$v_0.replace(".",",");var $v_1=$v_0+" "+$p1;if(this.get_isVisible()&&!CUI.ScriptUtility.isNullOrUndefined(this.get_inputElement())){this.$5m_1.value=$v_1;this.$5m_1.setAttribute("value",$v_1)}Mscrm.CommandBarControl.prototype.setAttribute.call(this,"DefaultValue",$v_1);return $v_1},$C2_1:function($p0){for(var $v_0=0;$v_0<this.$14_1.length;$v_0++)if(this.$14_1[$v_0].$54_0($p0))return this.$14_1[$v_0];return null},$9b_1:function($p0){for(var $v_0=0;$v_0<this.$14_1.length;$v_0++){if(this.$14_1[$v_0].$3p_0===$p0)return this.$14_1[$v_0];if(this.$14_1[$v_0].$54_0($p0))return this.$14_1[$v_0]}return null}};Mscrm.CommandHandler=function($p0,$p1,$p2){this.$$d_$HS_1=Function.createDelegate(this,this.$HS_1);Mscrm.CommandHandler.initializeBase(this);this.$4_1=$p0;this.$D_1=$p1;this.$18_1=$p2;$addHandler(window,"unload",this.$$d_$HS_1)};Mscrm.CommandHandler.$CE=function($p0,$p1,$p2){if(isNullOrEmptyString($p1))$p1=null;for(var $v_0=[$p2[$p1],$p2[null]],$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if(!IsNull($v_2)){var $v_3=$v_2[$p0];if(!IsNull($v_3))return $v_3}}return null};Mscrm.CommandHandler.$9P=function($p0){if(!$p0)return null;else{for(var $v_0=new Sys.StringBuilder,$v_1=0;$v_1<$p0.length;$v_1++){$v_1>0&&$v_0.append(",");$v_0.append($p0[$v_1].toString())}return $v_0.toString()}};Mscrm.CommandHandler.prototype={$4_1:null,$D_1:null,$18_1:null,$6m_1:true,$3H_1:false,get_enableState:function(){return this.$6m_1},set_enableState:function($p0){this.$6m_1=$p0;return $p0},getGlobalCommands:function(){return this.$18_1},getFocusedCommands:function(){return this.$18_1},$HS_1:function($p0){this.$3H_1=true;$removeHandler(window,"unload",this.$$d_$HS_1)},handleCommand:function($p0,$p1,$p2){var $v_0=this.parseCommandFromRibbon($p0),$v_1=this.$9Z_1($v_0.command,$v_0.entityLogicalName,$p1,$p2),$v_2=$p1;if(!IsNull($v_2)&&!isNullOrEmptyString($v_2.PopulationXML)&&!$v_2.SuppressCommandIncludes){var $v_3=null;if($v_0.entityContext==="Form"){var $v_4=$find("crmFormSelector");if($v_4)$v_3=$v_4.get_currentFormId()}$v_2.PopulationXML=this.$He_1($v_2.PopulationXML,$v_0.entityLogicalName,$v_3)}return $v_1},canHandleCommand:function($p0){if(!this.$6m_1)return false;var $v_0=this.parseCommandFromRibbon($p0),$v_1=this.$Ea_1($v_0.command,$v_0.entityLogicalName);if($v_1&&!IsNull(this.$D_1.get_$Ei_2()[$p0]))$v_1=Mscrm.RibbonNavigationModel.shouldContextGroupBeShown($v_0,this.$D_1);else if($v_1&&!IsNull(this.$D_1.get_$4G_2()[$p0]))$v_1=Mscrm.RibbonNavigationModel.shouldTabBeShown($p0,$v_0,this.$D_1);if(!IsNull(this.$D_1.get_$4G_2()[$p0]))this.$D_1.get_$4G_2()[$p0]=$v_1;return $v_1},parseCommandFromRibbon:function($p0){var $v_0=$p0.indexOf("|"),$v_1=$p0.indexOf("|",$v_0+1),$v_2=$p0.indexOf("|",$v_1+1),$v_3=new Mscrm.CommandInformation;$v_3.entityLogicalName=$p0.substr(0,$v_0);var $v_4=$p0.substr($v_0+1,$v_1-$v_0-1);$v_3.entityContext=$p0.substr($v_1+1,$v_2-$v_1-1);$v_3.command=$p0.substr($v_2+1);switch($v_4){case "ManyToMany":$v_3.relationshipType=Mscrm.RibbonRuleRelationshipType.manyToMany;break;case "OneToMany":$v_3.relationshipType=Mscrm.RibbonRuleRelationshipType.oneToMany;break;case "NoRelationship":$v_3.relationshipType=Mscrm.RibbonRuleRelationshipType.noRelationship;break}return $v_3},getCommandDefinition:function($p0,$p1){if(IsNull(Mscrm.RibbonCommands)||IsNull(Mscrm.RibbonCommands.commands))return null;return Mscrm.CommandHandler.$CE($p0,$p1,Mscrm.RibbonCommands.commands)},getEnableRuleDefinition:function($p0,$p1){if(IsNull(Mscrm.RibbonCommands)||IsNull(Mscrm.RibbonCommands.enableRules))return null;return Mscrm.CommandHandler.$CE($p0,$p1,Mscrm.RibbonCommands.enableRules)},$He_1:function($p0,$p1,$p2){var $v_0=new RemoteCommand("Ribbon","ProcessDynamicMenuXml");$v_0.SetParameter("dynamicMenuXml",$p0);$v_0.SetParameter("entityLogicalName",$p1);$v_0.SetParameter("hierarchyLocation",$p2);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=$v_1.ReturnValue,$v_3=Sys.Serialization.JavaScriptSerializer.deserialize($v_2.CommandDefinitions),$v_4=Sys.Serialization.JavaScriptSerializer.deserialize($v_2.RuleDefinitions),$v_5=new Mscrm.DynamicMenuCommandHandler($v_2.CommandPrefix,this.$D_1,$v_3,$v_4,$p1);this.$D_1&&this.$D_1.$2X_2&&this.$D_1.$2X_2.$BI_3($v_5);return $v_2?$v_2.MenuXml:$p0}else return $p0},$Ea_1:function($p0,$p1){if(IsNull(Mscrm.RibbonCommands)||IsNull(Mscrm.RibbonCommands.enableRules))return true;var $v_0=this.getCommandDefinition($p0,$p1);if(IsNull($v_0))return true;var $v_1=$v_0.EnableRules;if(IsNull($v_1))return true;for(var $v_2=true,$v_3=0;$v_2&&$v_3<$v_1.length;$v_3++){var $v_4=$v_1[$v_3];if(IsNull($v_4)||!$v_4.length)continue;$v_2=$v_2&&this.$FP_1($v_4,$p1)}return $v_2},getId:function(){return this.$4_1},get_commandList:function(){return this.$18_1},set_commandList:function($p0){this.$18_1=$p0;return $p0},$9Z_1:function($p0,$p1,$p2,$p3){var $v_0=this.getCommandDefinition($p0,$p1);if(IsNull($v_0)||IsNull($v_0.Actions))return false;for(var $v_1=0;$v_1<$v_0.Actions.length;$v_1++){var $v_2=$v_0.Actions[$v_1];switch($v_2.ActionType){case 2:this.$Ff_1($v_2.Attributes);break;case 3:var $v_3=$v_2.Attributes;this.$By_1($v_3.FunctionName,$v_3.Library,$v_2.Parameters,$p2);break;case 1:this.$Fg_1($v_2.Attributes,$v_2.Parameters);break}}return true},$Ff_1:function($p0){var $v_0=$p0.JavaScriptAction;!IsNull($v_0)&&typeof $v_0===Mscrm.TypeNames.functionType&&$v_0()},$By_1:function($p0,$p1,$p2,$p3){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create($p1),true);for(var $v_0=window,$v_1=$p0.split("."),$v_2=0;$v_2<$v_1.length;$v_2++)if($v_0)$v_0=$v_0[$v_1[$v_2]];if(!IsNull($v_0)&&typeof $v_0===Mscrm.TypeNames.functionType){var $v_3=this.$Ej_1($p2,$p3);return $v_0.apply(null,$v_3)}return null},$Fg_1:function($p0,$p1){var $v_0=Mscrm.CrmUri.create($p0.Address);$v_0.checkParamsNoEqual=true;if($p0.PassParameters)$v_0=addIsvParameters($v_0);for(var $v_1=0;$v_1<$p1.length;$v_1++){var $v_2=$p1[$v_1].ParameterName,$v_3=this.$Bw_1($p1[$v_1],1);if(!IsNull($v_2)&&$v_2.length>0)$v_0.get_query()[$v_2]=$v_3}openIsvWin($v_0,false,$p0.WinMode,$p0.WinParameters,null)},$Bw_1:function($p0,$p1){switch($p0.ParameterType){case 18:case 19:case 20:case 21:return $p0.Value;case 14:return window.ORG_UNIQUE_NAME;case 15:return window.ORG_LANGUAGE_CODE;case 16:return window.USER_LANGUAGE_CODE;case 1:return this.$D_1.get_$D5_2();case 2:return this.$D_1.get_$D6_2();case 3:if($p1===1)return Mscrm.CommandHandler.$9P(this.$D_1.get_$A7_2());else return Array.clone(this.$D_1.get_$A7_2());case 4:var $v_0=this.$D_1.get_$A7_2();return !IsNull($v_0)&&!IsNull($v_0.length)&&$v_0.length>0?$v_0[0]:null;case 7:return this.$D_1.get_$DJ_2();case 8:return this.$D_1.get_$DK_2();case 11:case 22:return this.$D_1.get_$DL_2();case 25:var $v_1=this.$D_1._currentSelectedControl;return $v_1?$v_1.get_recordCount():0;case 28:var $v_2=this.$D_1._currentSelectedControl;return $v_2?$v_2.get_recordCount()-$v_2.get_selectedRecordCount():0;case 9:case 23:case 29:case 26:var $v_3=this.$D_1._currentSelectedControl,$v_4=null;if($v_3)if($p0.ParameterType===9||$p0.ParameterType===23)$v_4=this.$D_1.get_$DM_2();else if($p0.ParameterType===29)$v_4=this.$D_1._currentSelectedControl.get_unselectedIds();else $v_4=this.$D_1._currentSelectedControl.get_allRecordIds();else $v_4=[];if($p1===1)return Mscrm.CommandHandler.$9P($v_4);else return Array.clone($v_4);case 24:case 30:case 27:var $v_5=this.$D_1._currentSelectedControl,$v_6=null;if($v_5)if($p0.ParameterType===24)$v_6=this.$D_1._currentSelectedControl.get_selectedRecords();else if($p0.ParameterType===30)$v_6=this.$D_1._currentSelectedControl.get_unselectedRecords();else $v_6=this.$D_1._currentSelectedControl.get_allRecords();else $v_6=[];if($p1===1){for(var $v_7=new Array($v_6.length),$v_8=0;$v_8<$v_6.length;$v_8++)$v_7[$v_8]=$v_6[$v_8].Id;return Mscrm.CommandHandler.$9P($v_7)}else return Array.clone($v_6);case 10:var $v_9=this.$D_1.get_$DM_2();return !IsNull($v_9)&&!IsNull($v_9.length)&&$v_9.length>0?$v_9[0]:null;case 5:case 6:case 12:case 13:var $v_A=$p0.ParameterType===5||$p0.ParameterType===6,$v_B=true,$v_C=$v_A?this.$D_1.$2F_2:this.$D_1._currentSelectedControl,$v_D=null,$v_E=null;if($v_C)$v_E=$v_C.get_id();else{$v_B=false;$v_D=$v_A?null:this.$D_1.$6W_2;if($v_D)$v_E=$v_D.id;else return null}if($p0.ParameterType===13||$p1===1)return $v_E;else if($v_B)return $v_C;else return $v_D;case 0:default:return null}},$Ej_1:function($p0,$p1){for(var $v_0=[],$v_1=0;$v_1<$p0.length;$v_1++)if($p0[$v_1].ParameterType===17)$v_0[$v_1]=$p1;else $v_0[$v_1]=this.$Bw_1($p0[$v_1],3);return $v_0},$FP_1:function($p0,$p1){var $v_0=this.getEnableRuleDefinition($p0,$p1);if(IsNull($v_0)||IsNull($v_0.Rules)||!$v_0.Rules.length)return true;for(var $v_1=true,$v_2=0;$v_1&&$v_2<$v_0.Rules.length;$v_2++)$v_1=$v_1&&this.$Bx_1($v_0.Rules[$v_2]);return $v_1},$Bx_1:function($p0){if(IsNull($p0))return false;var $v_0=$p0.DefaultValue;switch($p0.RuleType){case 8:$v_0=this.$FN_1($p0);break;case 26:$v_0=this.$FO_1($p0);break;case 1:$v_0=this.$FR_1($p0);break;case 7:$v_0=this.$FS_1($p0,$p0.DefaultValue);break;case 4:$v_0=this.$FT_1($p0,$p0.DefaultValue);break;case 16:$v_0=this.$FU_1($p0);break;case 2:$v_0=this.$FV_1($p0);break;case 10:$v_0=this.$FW_1($p0);break;case 19:$v_0=this.$FX_1($p0,$p0.DefaultValue);break;case 17:$v_0=this.$FY_1($p0);break;case 12:$v_0=this.$FZ_1($p0);break;case 6:$v_0=this.$FQ_1($p0,$p0.DefaultValue);break;case 5:$v_0=this.$Fb_1($p0,$p0.DefaultValue);break;case 11:$v_0=this.$Fc_1($p0);break;case 3:$v_0=this.$Fd_1($p0,$p0.DefaultValue);break}if(IsNull($v_0))$v_0=IsNull($p0.DefaultValue)?true:$p0.DefaultValue;if(!IsNull($p0.InvertResult)&&$p0.InvertResult)$v_0=!$v_0;return $v_0},$FO_1:function($p0){return this.$D_1.get_$1Z_2()===1?$p0.ClientType===2:$p0.ClientType===3},$FN_1:function($p0){if(Mscrm.SessionInfo.isOutlookClient())return $p0.ClientType===2;else return $p0.ClientType===1},$FR_1:function($p0){var $v_0=null,$v_1=null,$v_2=-1,$v_3=$p0.AppliesTo;if(IsNull($v_3)||$v_3===Mscrm.RuleAppliesTo.none)$v_3=Mscrm.RuleAppliesTo.primaryEntity;if($v_3===Mscrm.RuleAppliesTo.primaryEntity){$v_0=this.$D_1.get_$D6_2();$v_2=this.$D_1.get_$D5_2();$v_1=this.$D_1.get_$Hc_2()}else if($v_3===Mscrm.RuleAppliesTo.selectedEntity){$v_0=this.$D_1.get_$DK_2();$v_2=this.$D_1.get_$DJ_2();$v_1=this.$D_1.get_$5G_2()}var $v_4=IsNull($p0.EntityLogicalName)||!$p0.EntityLogicalName.length||($p0.EntityLogicalName==="listmember"?$v_0==="account"||$v_0==="contact"||$v_0==="lead":$v_0===$p0.EntityLogicalName);if(!$v_4)if($v_2!==-1&&$p0.EntityLogicalName==="activitypointer"&&Mscrm.EntityPropUtil.isActivityTypeCode($v_2)&&$v_1===Mscrm.RibbonContexts.homepageGrid)$v_4=true;var $v_5=IsNull($p0.EntityContextName)||!$p0.EntityContextName.length||$v_1===$p0.EntityContextName;return $v_4&&$v_5},$FS_1:function($p0,$p1){var $v_0=this.$D_1.$2F_2;if($v_0&&isInstanceOfTypeAcrossFrames($v_0,Mscrm.FormProxyForRibbon))$v_0=$v_0.get_crmFormControl();var $v_1=Mscrm.CrmUri.create(window.location.href),$v_2,$v_3=!IsNull($v_1.get_query()["rof"])?Boolean.parse($v_1.get_query()["rof"].toString()):false;if($v_3||Mscrm.Utilities.isRefreshForm())$v_2=Mscrm.FormControlLite;else $v_2=Mscrm.FormControl;if(!$v_0||!isInstanceOfTypeAcrossFrames($v_0,$v_2))return $p1;var $v_4=$v_0.get_formType();return $v_4===$p0.FormState},$FT_1:function($p0,$p1){var $v_0=this.$By_1($p0.FunctionName,$p0.Library,$p0.Parameters,null);if(!IsNull($v_0)&&typeof $v_0===Mscrm.TypeNames.booleanType)return $v_0;else return $p1},$FU_1:function($p0){if(Mscrm.SessionInfo.isOutlookClient())if(Mscrm.SessionInfo.isOnline())return $p0.OfflineAccessState===1;else return $p0.OfflineAccessState===2;else return false},$FV_1:function($p0){for(var $v_0=0;$v_0<$p0.OrGroups.length;$v_0++){for(var $v_1=$p0.OrGroups[$v_0],$v_2=true,$v_3=0;$v_2&&$v_3<$v_1.Rules.length;$v_3++)$v_2=$v_2&&this.$Bx_1($v_1.Rules[$v_3]);if($v_2)return true}return false},$FW_1:function($p0){if(Mscrm.SessionInfo.isOutlookWorkstationClient())return $p0.OutlookClientType===1;else if(Mscrm.SessionInfo.isOutlookLaptopClient())return $p0.OutlookClientType===2;else return false},$FX_1:function($p0,$p1){if(Mscrm.SessionInfo.isOutlookClient()){var $v_0=getOutlookHostedWindow().isItemTrackedInCrm();return $v_0===$p0.TrackedInCrm}else return $p1},$FY_1:function($p0){if(Mscrm.SessionInfo.isOutlookClient()){var $v_0=Mscrm.SessionInfo.getOutlookMajorVersion();if(!$v_0)if($p0.Version===1||$p0.Version===2)return true;else return false;else if($v_0<=11)return $p0.Version===1;else if($v_0===12)return $p0.Version===2;else if($v_0===14)return $p0.Version===3}return false},$FZ_1:function($p0){var $v_0=Mscrm.Utilities.getContentUrl(this),$v_1=$v_0.get_path(),$v_2=Mscrm.CrmUri.create($p0.Address).get_path();if(!$v_1.startsWith("/"))$v_1="/"+$v_1;if(!$v_2.startsWith("/"))$v_2="/"+$v_2;$v_1=$v_1.toUpperCase();$v_2=$v_2.toUpperCase();return $v_1===$v_2},$FQ_1:function($p0,$p1){var $v_0=this.$D_1.get_$A6_2();if(!$v_0)return $p1;var $v_1=$p0.PrivilegeType;return $v_0.verifyRecordPermission($v_1)},$Fb_1:function($p0,$p1){var $v_0;if($p0.AppliesTo===Mscrm.RuleAppliesTo.primaryEntity)$v_0=this.$D_1.get_$Hd_2();else if($p0.AppliesTo===Mscrm.RuleAppliesTo.selectedEntity)$v_0=this.$D_1.get_$DL_2();else return $p1;return $v_0>=$p0.Minimum&&($v_0<=$p0.Maximum||$p0.Maximum===-1)},$Fc_1:function($p0){var $v_0=0;if(window.IS_LIVE)$v_0|=2;if(window.IS_ONPREMISE)$v_0|=1;if(window.IS_SPLA)$v_0|=4;var $v_1=$v_0&$p0.SkuTypes;return !!$v_1},$Fd_1:function($p0,$p1){var $v_0=this.$D_1.get_$A6_2();if(!$v_0)return $p1;var $v_1=null;if(this.$D_1.get_isClientApiInitialized())$v_1=$v_0.getUnformattedValue($p0.Field);else if(!IsNull(window.RecordData)&&!IsNull(window.RecordData[$p0.Field]))$v_1=window.RecordData[$p0.Field].value;if(IsNull($v_1))return $p1;var $v_2=$v_1.toString()===$p0.Value;if(!$v_2){if(!this.$Gd_1($p0.Field))return $v_2;$v_2=this.$Fa_1($p0,$p1)}return $v_2},$Gd_1:function($p0){if(!Xrm.Page.data.entity.attributes.getLength())return false;else{var $v_0=Xrm.Page.data.entity.attributes.get($p0),$v_1=$v_0.getAttributeType();if($v_1==="optionset")return true;else return false}},$Fa_1:function($p0,$p1){var $v_0=this.$D_1.get_$A6_2();if(!$v_0)return $p1;var $v_1=null;if(this.$D_1.get_isClientApiInitialized())$v_1=$v_0.getUnformattedRawValue($p0.Field);else if(!IsNull(window.RecordData)&&!IsNull(window.RecordData[$p0.Field]))$v_1=window.RecordData[$p0.Field].raw;if(IsNull($v_1))return $p1;return $v_1.toString()===$p0.Value}};Mscrm.CommandHandlerWrapper=function($p0){Mscrm.CommandHandlerWrapper.initializeBase(this);this.$2M_1=$p0;this.$18_1=$p0.getGlobalCommands();this.$4_1=$p0.getId()};Mscrm.CommandHandlerWrapper.prototype={$2M_1:null,$18_1:null,$4_1:null,getGlobalCommands:function(){return this.$18_1},getFocusedCommands:function(){return this.$18_1},handleCommand:function($p0,$p1,$p2){if(this.$2M_1&&!this.$2M_1.$3H_1)return this.$2M_1.handleCommand($p0,$p1,$p2);return false},canHandleCommand:function($p0){if(this.$2M_1&&!this.$2M_1.$3H_1)return this.$2M_1.canHandleCommand($p0);return false},getId:function(){return this.$4_1}};Mscrm.AlwaysEnabledCommandHandler=function($p0,$p1){this.$1c_1=[];Mscrm.AlwaysEnabledCommandHandler.initializeBase(this);this.$4_1=$p0;this.$1c_1=$p1};Mscrm.AlwaysEnabledCommandHandler.prototype={$4_1:null,getGlobalCommands:function(){return this.$1c_1},handleCommand:function($p0,$p1,$p2){return true},canHandleCommand:function($p0){return true},getId:function(){return this.$4_1}};Mscrm.CrmDataSource=function($p0,$p1,$p2){this.$$d_$Eg_1=Function.createDelegate(this,this.$Eg_1);Mscrm.CrmDataSource.initializeBase(this,[null,null,null]);this.$8Y_1=$p1;this.$3z_1=$p2;this.$HV_1($p0)};Mscrm.CrmDataSource.$Ee=function($p0,$p1){var $v_0=$p0.sequence,$v_1=$p1.sequence;if(IsNull($v_1))return -1;else if(IsNull($v_0))return 1;else return $v_0-$v_1};Mscrm.CrmDataSource.prototype={$2I_1:null,$8Y_1:null,$3z_1:null,dispose:function(){this.$2I_1=null;this.$8Y_1=null;this.$3z_1=null;CUI.DataSource.prototype.dispose.call(this)},runQuery:function($p0){var $v_0=null;switch($p0.queryType){case 5:$v_0=this.$GF_1($p0);break;case 4:$v_0=this.$GG_1($p0);break;case 2:$v_0=this.$G9_1($p0);break;default:break}var $v_1=new CUI.DataQueryResult;$v_1.contextData=$p0.data;$v_1.id=$p0.id;if(!IsNull($v_0)){$v_1.queryData=$v_0;$v_1.success=true;$p0.handler($v_1)}else $v_1.success=false},getInitialTabId:function($p0){this.$2I_1.sort(this.$$d_$Eg_1);for(var $v_0=0;$v_0<this.$2I_1.length;$v_0++)if(this.$2I_1[$v_0]===$p0)return $p0;if(this.$2I_1.length>0)return this.$2I_1[0];return ""},onDataReturned:function($p0){},$GF_1:function($p0){var $v_0=null;if($p0.id===Mscrm.RibbonConstants.jewelId)$v_0=this.$8Y_1;return $v_0},$GG_1:function($p0){var $v_0=$p0.id,$v_1=this.$3z_1[$v_0];if(!IsNull($v_1)&&$v_1.TabExists){var $v_2=[],$v_3=[];if($v_1.IsContextual){var $v_5=[];Array.add($v_5,$v_1.TabLayout);this.$DR_1($v_1.ContextualGroupLayout,$v_5);Array.add($v_3,$v_1.ContextualGroupLayout)}else Array.add($v_2,$v_1.TabLayout);var $v_4=$v_1.FullLayout;this.$DU_1($v_4,$v_2,$v_3);return $v_4}return null},$G9_1:function($p0){for(var $v_0=$p0.id,$v_1=[],$v_2=[],$v_3={},$v_4=null,$v_6=0;$v_6<this.$2I_1.length;$v_6++){var $v_7=this.$3z_1[this.$2I_1[$v_6]];if(!IsNull($v_7)&&$v_7.TabExists){var $v_8=null;if($v_7.IsContextual){var $v_9=$v_7.ContextualGroupId;if(IsNull($v_3[$v_9])){var $v_A=new Mscrm.ContextualGroupInfo;$v_A.id=$v_9;$v_A.sequence=$v_7.ContextGroupSequence;Array.add($v_2,$v_A);$v_3[$v_9]={};$v_3[$v_9]["Layout"]=$v_7.ContextualGroupLayout;$v_3[$v_9]["Tabs"]=[]}$v_8=$v_3[$v_9]["Tabs"]}else $v_8=$v_1;if($v_7.TabId===$v_0){Array.add($v_8,$v_7.TabLayout);$v_4=$v_7.FullLayout}else Array.add($v_8,$v_7.TabHeaderLayout)}}if(IsNull($v_4))return null;$v_2.sort(Mscrm.CrmDataSource.$Ee);for(var $v_5=[],$v_B=0;$v_B<$v_2.length;$v_B++){var $v_C=$v_2[$v_B].id,$v_D=$v_3[$v_C],$v_E=$v_D["Layout"];this.$DR_1($v_E,$v_D["Tabs"]);Array.add($v_5,$v_E)}if(!$v_1.length&&!$v_5.length)return null;this.$DU_1($v_4,$v_1,$v_5);return $v_4},$DR_1:function($p0,$p1){$p0["children"]=$p1},$DU_1:function($p0,$p1,$p2){var $v_0=0,$v_1=$p0["children"];if(!IsNull($v_1))for(var $v_2=0;$v_2<$v_1.length&&$v_0<2;$v_2++){var $v_3=$v_1[$v_2];if(!IsNull($v_3)&&$v_3["name"]==="Ribbon")for(var $v_4=$v_3["children"],$v_5=0;$v_5<$v_4.length;$v_5++){var $v_6=$v_4[$v_5];if(!IsNull($v_6)){var $v_7=$v_6["name"];if($v_7==="Tabs"){$v_6["children"]=$p1;$v_0++}else if($v_7==="ContextualTabs"){$v_6["children"]=$p2;$v_0++}}}}},$HV_1:function($p0){this.$2I_1=new Array(0);for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=$p0[$v_0],$v_2=this.$3z_1[$v_1];if(!IsNull($v_2)&&$v_2.TabExists)this.$2I_1[this.$2I_1.length]=$v_1}},$Eg_1:function($p0,$p1){var $v_0=this.$3z_1[$p0],$v_1=this.$3z_1[$p1];if(IsNull($v_1)||!$v_1.TabExists)return -1;else if(IsNull($v_0)||!$v_0.TabExists)return 1;if(!$v_0.IsContextual&&$v_1.IsContextual)return -1;else if($v_0.IsContextual&&!$v_1.IsContextual)return 1;var $v_2,$v_3;if(!$v_0.IsContextual&&!$v_1.IsContextual||$v_0.ContextualGroupId===$v_1.ContextualGroupId){$v_2=$v_0.TabSequence;$v_3=$v_1.TabSequence}else{$v_2=$v_0.ContextGroupSequence;$v_3=$v_1.ContextGroupSequence}if(IsNull($v_3))return -1;else if(IsNull($v_2))return 1;else return $v_2-$v_3}};Mscrm.DynamicMenuCommandHandler=function($p0,$p1,$p2,$p3,$p4){this.$1c_2={};this.$91_2={};Mscrm.DynamicMenuCommandHandler.initializeBase(this,[$p0,$p1,null]);this.$Ap_2=$p4;for(var $v_0=new Array($p2.length),$v_1=0;$v_1<$p2.length;$v_1++){$v_0[$v_1]=$p2[$v_1].Id;this.$1c_2[$p2[$v_1].Id]=$p2[$v_1]}for(var $v_2=0;$v_2<$p3.length;$v_2++)this.$91_2[$p3[$v_2].Id]=$p3[$v_2];this.$18_1=$v_0};Mscrm.DynamicMenuCommandHandler.prototype={$Ap_2:null,getCommandDefinition:function($p0,$p1){var $v_0=this.$1c_2[$p0];return $v_0?$v_0:Mscrm.CommandHandler.prototype.getCommandDefinition.call(this,$p0,$p1)},getEnableRuleDefinition:function($p0,$p1){var $v_0=this.$91_2[$p0];return $v_0?$v_0:Mscrm.CommandHandler.prototype.getEnableRuleDefinition.call(this,$p0,$p1)},parseCommandFromRibbon:function($p0){var $v_0=new Mscrm.CommandInformation;$v_0.command=$p0;$v_0.entityContext="";$v_0.entityLogicalName=this.$Ap_2;$v_0.relationshipType=Mscrm.RibbonRuleRelationshipType.noRelationship;return $v_0}};Mscrm.RibbonData=function(){Mscrm.RibbonData.initializeBase(this)};Mscrm.RibbonData.setRibbonEnabledState=function(enabled){var $v_0=$find("crmRibbonData");if($v_0){$v_0.get_$45_2().$6m_1=enabled;$v_0.raiseEventWithCheck(Mscrm.ScriptEvents.RibbonRefresh,null)}};Mscrm.RibbonData.prototype={$6x_3:null,$83_3:null,$22_3:null,$1c_3:null,$9C_3:null,$81_3:null,$Ad_3:false,dispose:function(){if(this.get_isDisposed())return;if(!IsNull(Mscrm)){if(!IsNull(Mscrm.RibbonLayout)){Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.jewelLayout);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.tabs);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.TabLayouts);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.ContextualGroupLayouts);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.menuSectionAndGroupCounts);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.menuSectionAndGroupControls);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.tabGroupCount);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout.parentGroupCommands);Mscrm.Utilities.destroyObject(Mscrm.RibbonLayout)}if(!IsNull(Mscrm.RibbonCommands)){Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands.commands);Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands.enableRules);Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands)}delete Mscrm.RibbonLayout;delete Mscrm.RibbonCommands}Mscrm.CommandData.prototype.dispose.call(this)},initialize:function(){Mscrm.CommandData.prototype.initialize.call(this);this.$6x_3={};this.$83_3={};this.$9C_3={};this.$81_3={};this.$Ad_3=Mscrm.RibbonLayout.isInvalid;if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.TabList))for(var $v_0=0;$v_0<this.$Q_2.TabList.length;$v_0++){var $v_1=this.$Q_2.TabList[$v_0],$v_2=$v_1.TabId,$v_3=this.get_$Dh_2()[$v_2];if(!IsNull($v_3)&&$v_3.TabExists){if(!isNullOrEmptyString($v_3.TabCommand))this.$9C_3[$v_3.TabCommand]=false;if(!isNullOrEmptyString($v_3.ContextGroupCommand))this.$81_3[$v_3.ContextGroupCommand]=false}var $v_4=this.$Dg_3($v_2);if(IsNull(this.get_$IG_2()[$v_4])){this.$6x_3[$v_2]=true;if(!IsNull($v_3)&&$v_3.IsContextual&&!isNullOrEmptyString($v_3.ContextualGroupId))this.$83_3[$v_3.ContextualGroupId]=true}}!IsNull(this.get_permanentlySelectedControl())&&this.setCurrentSelectedElement($get(this.get_permanentlySelectedControl().get_id()))},$Dg_3:function($p0){var $v_0=$p0;if($v_0.startsWith("EntityTemplateTab.")){$v_0=$v_0.substr(18);for(var $v_1=new Array(4),$v_2=0,$v_3=0;$v_3<3;$v_3++){var $v_4=$v_0.indexOf(".",$v_2);$v_1[$v_3]=$v_0.substring($v_2,$v_4);$v_2=$v_4+1}$v_1[3]=$v_0.substr($v_2);$v_0=$v_1.join("|")}return $v_0},get_$1Z_2:function(){return 0},get_$2h_2:function(){if(!IsNull(this.$60_3))return this.$60_3.get_ribbon();return null},handleRibbonTabSwitch:function(parameters){var $v_0=parameters;this.$Ag_2=$v_0.NewContextCommand},get_$GS_2:function(){if(!IsNull(this.$Q_2))return this.$Q_2.InitialTabId;return null},set_$GS_2:function($p0){if(!IsNull(this.$Q_2))this.$Q_2.InitialTabId=$p0;return $p0},get_$IG_2:function(){if(IsNull(this.$22_3)){this.$22_3={};if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.TrimList))for(var $v_0=0;$v_0<this.$Q_2.TrimList.length;$v_0++){var $v_1=this.$Q_2.TrimList[$v_0];this.$22_3[$v_1]=true;if(!IsNull(Mscrm.RibbonLayout.menuSectionAndGroupControls)){var $v_2=Mscrm.RibbonLayout.menuSectionAndGroupControls[$v_1];if(!isNullOrEmptyString($v_2)){var $v_3=Mscrm.RibbonLayout.menuSectionAndGroupCounts[$v_2]-1;Mscrm.RibbonLayout.menuSectionAndGroupCounts[$v_2]=$v_3;if($v_3<=0){this.$22_3[$v_2]=true;var $v_4=Mscrm.RibbonLayout.menuSectionAndGroupControls[$v_2];if(!isNullOrEmptyString($v_4)){var $v_5=Mscrm.RibbonLayout.tabGroupCount[$v_4]-1;Mscrm.RibbonLayout.tabGroupCount[$v_4]=$v_5;if($v_5<=0){var $v_6=this.$Dg_3($v_4);this.$22_3[$v_6]=true}}}}}}if(this.hasAssociatedGridContext()){var $v_7=window.parent.$find("crmRibbonData");if($v_7&&isInstanceOfTypeAcrossFrames($v_7,Mscrm.RibbonData)){var $v_8=$v_7.get_$IG_2(),$$dict_9=$v_8;for(var $$key_A in $$dict_9){var $v_9={key:$$key_A,value:$$dict_9[$$key_A]};this.$22_3[$v_9.key]=$v_9.value}}}}return this.$22_3},get_$9N_2:function(){if(!this.$1c_3){var $v_0={};if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.CommandIds))for(var $v_1=0;$v_1<this.$Q_2.CommandIds.length;$v_1++)$v_0[this.$Q_2.CommandIds[$v_1]]=true;this.$1c_3=$v_0}return this.$1c_3},get_$4G_2:function(){return this.$9C_3},get_$Ei_2:function(){return this.$81_3},get_$9v_3:function(){if(isNullOrEmptyString(this.get_$GS_2()))return true;var $$dict_0=this.$6x_3;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]};return false}return true},get_$Gh_3:function(){return Mscrm.RibbonLayout.jewelLayout},get_$Dh_2:function(){return Mscrm.RibbonLayout.tabs},$Dp_3:null,$60_3:null};function _ribbonScaleHeader(elmRibbonTopBars,isRtl){Mscrm.RibbonHeaderScaling.scaleHeader(elmRibbonTopBars,isRtl)}Mscrm.RibbonHeaderScaling=function(){};Mscrm.RibbonHeaderScaling.scaleHeader=function(elmTopBars,isRtl){if(IsNull(isRtl))isRtl=false;for(var $v_0=elmTopBars.childNodes[1],$v_1=$v_0.childNodes.length,$v_2=null,$v_6=0;$v_6<$v_1;$v_6++){var $v_7=$v_0.childNodes[$v_6];if($v_7.className.indexOf("ms-cui-tts")!==-1){$v_2=$v_7;break}}if(IsNull($v_2))return;!Mscrm.RibbonHeaderScaling.$9y($v_0,$v_2,isRtl)&&Mscrm.RibbonHeaderScaling.$Fh($v_0,$v_2,isRtl);while(Mscrm.RibbonHeaderScaling.$9y($v_0,$v_2,isRtl)){var $v_8=Mscrm.RibbonHeaderScaling.$9i($v_2);Mscrm.RibbonHeaderScaling.$CR($v_2,isRtl);if($v_8===Mscrm.RibbonHeaderScaling.$9i($v_2))break}Mscrm.RibbonHeaderScaling.$FE(elmTopBars,$v_2,isRtl);for(var $v_3=null,$v_4=$v_2.getElementsByTagName("DIV"),$v_9=0;$v_9<$v_4.length;$v_9++){var $v_A=$v_4[$v_9];if($v_A.className.indexOf("ms-cui-cg-t")>=0&&$v_A.style.display!=="none")$v_3=$v_A}var $v_5={};$v_5["tabElement"]=$v_2;$v_5["lastContextualTabElement"]=$v_3;Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.RibbonTabScalingComplete,$v_5)};Mscrm.RibbonHeaderScaling.$9y=function($p0,$p1,$p2){if(Mscrm.RibbonHeaderScaling.$BY($p0,$p2))return true;if(Mscrm.RibbonHeaderScaling.$GK($p1,$p2))return true;if(Mscrm.Utilities.isIE7())return false;else return Mscrm.RibbonHeaderScaling.$BY($p1,$p2)};Mscrm.RibbonHeaderScaling.$GK=function($p0,$p1){if($p1){if($p0.offsetLeft+Mscrm.RibbonHeaderScaling.$9i($p0)<220)return true}else if($p0.offsetLeft+$p0.offsetWidth>document.body.offsetWidth-220)return true;return false};Mscrm.RibbonHeaderScaling.$BY=function($p0,$p1){if(!$p0.offsetWidth)return false;for(var $v_0=[],$v_1=$p0.childNodes.length,$v_2=0;$v_2<$v_1;$v_2++){var $v_3=$p0.childNodes[$v_2];!IsNull($v_3)&&$v_3.nodeName!=="#text"&&$v_3.offsetWidth>0&&$v_3.offsetHeight>0&&Array.add($v_0,$v_3)}$v_1=$v_0.length;for(var $v_4=0;$v_4<$v_1-1;$v_4++){var $v_5=$v_0[$v_4],$v_6=$v_0[$v_4+1];if(!IsNull($v_6))if(Mscrm.RibbonHeaderScaling.$Dm($v_5,$v_6,$p1))return true}return false};Mscrm.RibbonHeaderScaling.$Fh=function($p0,$p1,$p2){Mscrm.RibbonHeaderScaling.$IH($p1,$p2);while(Mscrm.RibbonHeaderScaling.$9m($p1)){Mscrm.RibbonHeaderScaling.$GJ($p1,$p2);if(Mscrm.RibbonHeaderScaling.$9y($p0,$p1,$p2)){Mscrm.RibbonHeaderScaling.$CR($p1,$p2);break}}};Mscrm.RibbonHeaderScaling.$9m=function($p0){if(IsNull($p0._scaleStep))if($p0.className.indexOf("ms-cui-tts-scale1")!==-1)$p0._scaleStep=1;else if($p0.className.indexOf("ms-cui-tts-scale2")!==-1)$p0._scaleStep=2;else $p0._scaleStep=0;return parseInt($p0._scaleStep)};Mscrm.RibbonHeaderScaling.$CR=function($p0,$p1){var $v_0=$p1&&Mscrm.Utilities.isIE7()?3:Mscrm.RibbonHeaderScaling.$9m($p0);switch($v_0){case 0:Mscrm.RibbonHeaderScaling.$5H($p0,1);break;case 1:Mscrm.RibbonHeaderScaling.$5H($p0,2);break;case 2:Mscrm.RibbonHeaderScaling.$5H($p0,3);break;case 3:Mscrm.RibbonHeaderScaling.$GM($p0,$p1);break}};Mscrm.RibbonHeaderScaling.$GM=function($p0,$p1){for(var $v_0=$p0.childNodes,$v_1=$v_0.length-1;$v_1>=0;$v_1--)if($v_0[$v_1].style.visibility!=="hidden"){Mscrm.RibbonHeaderScaling.$CT($v_0[$v_1]);break}};Mscrm.RibbonHeaderScaling.$IH=function($p0,$p1){for(var $v_0=$p0.childNodes,$v_1=$v_0.length-1;$v_1>=0;$v_1--)Mscrm.RibbonHeaderScaling.$Df($v_0[$v_1])};Mscrm.RibbonHeaderScaling.$GJ=function($p0,$p1){var $v_0=$p1&&Mscrm.Utilities.isIE7()?1:Mscrm.RibbonHeaderScaling.$9m($p0);switch($v_0){case 1:Mscrm.RibbonHeaderScaling.$5H($p0,0);break;case 2:Mscrm.RibbonHeaderScaling.$5H($p0,1);break;case 3:Mscrm.RibbonHeaderScaling.$5H($p0,2);break}};Mscrm.RibbonHeaderScaling.$9i=function($p0){for(var $v_0=0,$v_1=$p0.childNodes,$v_2=$v_1.length-1;$v_2>=0;$v_2--)if($v_1[$v_2].style.visibility==="hidden")$v_0+=$v_1[$v_2].offsetWidth;return $v_0};Mscrm.RibbonHeaderScaling.$5H=function($p0,$p1){$p0.className=Mscrm.RibbonHeaderScaling.$DF[$p1];$p0._scaleStep=$p1};Mscrm.RibbonHeaderScaling.$Dm=function($p0,$p1,$p2){if($p2){if($p1.offsetLeft+$p1.offsetWidth>$p0.offsetLeft)return true}else if($p0.offsetLeft+$p0.offsetWidth>$p1.offsetLeft)return true;return false};Mscrm.RibbonHeaderScaling.$FE=function($p0,$p1,$p2){var $v_0=$p0.childNodes[0];if(IsNull($v_0))return;for(var $v_1=$v_0.childNodes.length,$v_2=null,$v_4=0;$v_4<$v_1;$v_4++){var $v_5=$v_0.childNodes[$v_4];if($v_5.className.indexOf("ms-cui-QATRowCenter")!==-1){$v_2=$v_5;break}}if(IsNull($v_2))return;var $v_3=$p1.childNodes[$p1.childNodes.length-1];if($v_3.className.indexOf("ms-cui-cg")!==-1&&Mscrm.RibbonHeaderScaling.$Dm($v_3,$v_2,$p2))Mscrm.RibbonHeaderScaling.$CT($v_2);else Mscrm.RibbonHeaderScaling.$Df($v_2)};Mscrm.RibbonHeaderScaling.$CT=function($p0){var $v_0=$p0._titleHidden;if(IsNull($v_0)||$v_0==="0"){$p0.style.visibility="hidden";$p0._titleHidden="1"}};Mscrm.RibbonHeaderScaling.$Df=function($p0){var $v_0=$p0._titleHidden;if(!IsNull($v_0)&&$v_0==="1"){$p0.style.visibility="visible";$p0._titleHidden="0"}};Mscrm.RibbonManager=function($p0){this.$$d_$Ha_3=Function.createDelegate(this,this.$Ha_3);this.$$d_$Hb_3=Function.createDelegate(this,this.$Hb_3);this.$$d_$CQ_3=Function.createDelegate(this,this.$CQ_3);this.$1R_3=new Array(2);this.$3b_3=new Array(0);this.$1q_3=new Array(0);this.$3f_3={};this.$4l_3=7;this.$70_3=3;this.$6z_3=3;Mscrm.RibbonManager.initializeBase(this,[$p0]);this.get_element().setAttribute("currentRibbonElement","")};Mscrm.RibbonManager.get_$2y=function(){if(!Mscrm.RibbonManager.$75)Mscrm.RibbonManager.$75=CUI.Page.PageManager.get_instance();return Mscrm.RibbonManager.$75};Mscrm.RibbonManager.prototype={$4f_3:false,$2t_3:false,$6q_3:false,$1S_3:null,$8_3:null,$1s_3:null,$35_3:null,$6k_3:null,$2L_3:false,$3w_3:false,$6n_3:true,$3v_3:null,$1g_3:null,$t_3:0,cmdBarStatus:null,get_hideCommandBar:function(){return !isNullOrEmptyString(this.cmdBarStatus)&&this.cmdBarStatus.toLowerCase()==="false"},get_availableWidth:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$t_3)||this.$t_3<0)this.$t_3=this.$53_3(2);return this.$t_3},set_availableWidth:function(value){if(CUI.ScriptUtility.isNullOrUndefined(value)||value<=0)return value;if(this.$t_3!==value)this.$t_3=value;return value},$3a_3:0,get_availableWidthOnChartPane:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$3a_3)||this.$3a_3<0)this.$3a_3=this.$53_3(0);return this.$3a_3},set_availableWidthOnChartPane:function(value){if(CUI.ScriptUtility.isNullOrUndefined(value)||value<=0)return value;if(this.$3a_3!==value)this.$3a_3=value;return value},$3Z_3:0,get_availableWidthOnChartDesigner:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$3Z_3)||this.$3Z_3<0)this.$3Z_3=this.$53_3(1);return this.$3Z_3},set_availableWidthOnChartDesigner:function(value){if(CUI.ScriptUtility.isNullOrUndefined(value)||value<=0)return value;if(this.$3Z_3!==value)this.$3Z_3=value;return value},get_numberOfButtonsForDisplay:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$4l_3))this.$4l_3=7;return this.$4l_3},set_numberOfButtonsForDisplay:function(value){if(!this.$8_3||this.$8_3._disposed||this.$8_3.get_$1Z_2()!==1)return value;if(CUI.ScriptUtility.isNullOrUndefined(value))return value;if(value>7)value=7;if(value<0)value=0;if(this.$4l_3!==value)this.$4l_3=value;return value},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);if(this.get_$AT_3())this.get_element().style.height="135px";else if(this.$6q_3)this.get_element().style.height="43px";else this.get_element().style.height="0px"},get_isOnOutlookStage:function(){return this.$4f_3},set_isOnOutlookStage:function(value){this.$4f_3=value;return value},get_isOnAssociatedGridCommandBar:function(){return this.$2t_3},set_isOnAssociatedGridCommandBar:function(value){this.$2t_3=value;return value},get_hideChrome:function(){return this.$6q_3},get_isMinimized:function(){return Mscrm.RibbonManager.$5p},set_isMinimized:function(value){if(this.$8_3&&this.$8_3.get_$2h_2()){var $v_0=this.$8_3.$Ag_2,$v_1=this.$8_3.get_$2h_2();$v_1.set_minimized(Mscrm.RibbonManager.$5p=value);!value&&!isNullOrEmptyString($v_0)&&this.$8_3.get_$4G_2()[$v_0]&&$v_1.selectTabByCommand($v_0);!value&&isNullOrEmptyString($v_0)&&$v_1.selectTabById(this.$8_3.get_$GS_2());this.$AE_3(null)}return value},setTabById:function(id){if(this.$8_3&&this.$8_3.get_$2h_2()){this.$8_3.get_$2h_2().selectTabById(id);this.$AE_3(null)}},get_$AT_3:function(){if(this.get_hideCommandBar())return false;var $v_0=true,$v_1=Mscrm.CrmUri.create(window.location.href);if($v_1.get_scheme().toLowerCase()==="outlook")$v_0=false;else{var $v_3=$v_1.get_query()["web"];if(!IsNull($v_3))$v_0=$v_3!=="false"}if(!IsNull($v_1.get_query()["_hc"])){this.$6q_3=$v_1.get_query()["_hc"].toLowerCase()==="true";if(this.$6q_3)return false}if(this.$Gc_3($v_0))return false;var $v_2=Mscrm.SessionInfo.getClientMajorVersion();if(!IsNull($v_2)&&$v_2<=4)return !this.$4f_3||$v_0;if(this.$4f_3)return false;return $v_0},$Gc_3:function($p0){if($p0)return false;var $v_0=Mscrm.CrmUri.create(window.location.href);if($v_0.get_path().toUpperCase().endsWith("/MAIN.ASPX")&&$v_0.get_query()["pagetype"]==="entitylist"){var $v_1=window.IS_ENTITY_RIBBONIZED;return !IsNull($v_1)&&!$v_1}return false},get_$De_3:function(){return Mscrm.SessionInfo.isOutlook14Client()},get_$9T_3:function(){if(!this.$6k_3)this.$6k_3={};return this.$6k_3},$GY_3:function($p0){var $v_0="";if(!IsNull($p0)&&!IsNull($p0["sourceUri"]))$v_0=$p0["sourceUri"].toString();var $v_1=window.location.href;if(!isNullOrEmptyString($v_0)&&$v_1.indexOf($v_0)<0)return true;return false},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.RibbonDataLoad:if(!IsNull(sourceComponent)){var $v_0=sourceComponent;if(!$v_0.get_$1Z_2()){var $v_1=$v_0;(!$v_1.get_$9v_3()||$v_1.get_$5G_2()===Mscrm.RibbonContexts.homepageGrid)&&this.$GE_3($v_1,parameters)}else{var $v_2=$v_0,$v_3=this.$2t_3&&$v_2.get_$3V_3()&&!this.$GY_3(parameters)||!this.$2t_3&&!$v_2.get_$3V_3();$v_3&&this.$G8_3($v_2,parameters)}}break;case Mscrm.ScriptEvents.RibbonDataUnload:if(!IsNull(sourceComponent)){var $v_4=sourceComponent;if(!$v_4.get_$1Z_2())this.$9r_3(sourceComponent);else{var $v_5=$v_4,$v_6=this.$2t_3&&$v_5.get_$3V_3()||!this.$2t_3&&!$v_5.get_$3V_3();$v_6&&this.$9o_3($v_5)}}break;case Mscrm.ScriptEvents.PageLoaded:this.$GB_3(sourceComponent,parameters);break;case Mscrm.ScriptEvents.PageUnloaded:this.$GC_3(sourceComponent);break;case Mscrm.ScriptEvents.RibbonRefresh:this.$AE_3(parameters);break;case Mscrm.ScriptEvents.RibbonRequestVisibleState:var $v_7=parameters["command"],$v_8=parameters["id"];if($v_7&&typeof $v_7===Mscrm.TypeNames.stringType&&$v_8&&typeof $v_8===Mscrm.TypeNames.stringType)return this.$7a_3($v_7,$v_8);else return false;case Mscrm.ScriptEvents.RibbonRequestEnabledState:var $v_9=parameters["command"],$v_A=parameters["id"];if($v_9&&typeof $v_9===Mscrm.TypeNames.stringType&&$v_A&&typeof $v_A===Mscrm.TypeNames.stringType)return this.$GX_3($v_9,$v_A);else return false;case Mscrm.ScriptEvents.RibbonExecuteCommand:var $v_B=parameters["command"],$v_C=parameters["getRibbonXmlForOutlookClient"];if($v_B&&typeof $v_B===Mscrm.TypeNames.stringType)if(!$v_C)this.$9Z_3($v_B);else{var $v_D=this.$G7_3($v_B,parameters);parameters["RibbonXmlForOutlookClientResult"]=$v_D}break;case Mscrm.ScriptEvents.RibbonRootEvent:var $v_E=parameters,$v_F=$v_E.Minimized;if(!IsNull($v_F)&&typeof $v_F===Mscrm.TypeNames.booleanType)Mscrm.RibbonManager.$5p=$v_F;this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null);break;case Mscrm.ScriptEvents.RibbonTabSwitch:if(!IsNull(this.$8_3)&&!this.$8_3.get_$1Z_2()){var $v_G=parameters;Mscrm.RibbonNavigationModel.onTabSwitch($v_G.OldContextId,$v_G.NewContextId,this.$8_3,$v_G.ChangedByUser)}break;case Mscrm.ScriptEvents.RibbonSetFocusToLastControl:case Mscrm.ScriptEvents.RibbonSetFocusToSelf:var $v_H=parameters;this.$I2_3(eventCode,$v_H.eventElement);break;case Mscrm.ScriptEvents.WindowResize:if(this.$2L_3)break;if(!this.$3w_3){this.$3w_3=true;this.$3v_3=window.setTimeout(this.$$d_$CQ_3,100)}break;case Mscrm.ScriptEvents.ReloadCommandBar:!IsNull(this.$8_3)&&!this.$8_3.get_isDisposed()&&this.$8_3.get_$1Z_2()===1&&this.$DA_3();break;case Mscrm.ScriptEvents.RibbonRendered:this.$2t_3&&this.$GN_3();break}return null},$GN_3:function(){var $v_0=window.top.document.getElementById("crmRibbonManager");if($v_0.style.visibility!=="hidden"){var $v_1=window.top.document.getElementById("crmContentPanel");if(!IsNull($v_1)){var $v_2=$v_1.attributes.getNamedItem("currentContentId"),$v_3=null;if(!IsNull($v_2)&&$v_2.specified)$v_3=window.top.document.getElementById($v_2.value);if(!IsNull($v_3)){var $v_4=$v_3.contentWindow.document.getElementById("areaForm");if(!IsNull($v_4)&&$v_4.style.display==="none"){$v_0.style.visibility="hidden";Mscrm.PerceivedCommandBarHelper.setPerceivedCommandBarAsHidden()}}}}},$DA_3:function(){var $v_0=this.$8_3;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.$N_0)&&!$v_0.isDocumentTab()){if(!IsNull(this.$1g_3)){window.clearTimeout(this.$1g_3);this.$1g_3=null}this.$1g_3=window.setTimeout($v_0.$$d_reloadCommandBar,0)}},$CQ_3:function(){this.$3v_3=null;try{if(!CUI.ScriptUtility.isNullOrUndefined(this.$8_3)&&!this.$8_3._disposed&&this.$8_3.get_$1Z_2()===1){var $v_0=false,$v_1=this.get_availableWidth();this.set_availableWidth(this.$53_3(2));var $v_2=this.get_availableWidth(),$v_3=this.get_availableWidthOnChartPane();this.set_availableWidthOnChartPane(this.$53_3(0));var $v_4=this.get_availableWidthOnChartPane(),$v_5=this.get_availableWidthOnChartDesigner();this.set_availableWidthOnChartDesigner(this.$53_3(1));var $v_6=this.get_availableWidthOnChartDesigner();$v_0=!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2!==$v_1||!CUI.ScriptUtility.isNullOrUndefined($v_4)&&$v_4!==$v_3||!CUI.ScriptUtility.isNullOrUndefined($v_6)&&$v_6!==$v_5;if($v_0||this.$6n_3){var $v_7=false;this.$6n_3=false;if(this.get_element().style.visibility==="visible"){$v_7=true;this.get_element().style.visibility="hidden"}this.$70_3=3;this.$6z_3=3;this.set_numberOfButtonsForDisplay(7);this.$DC_3();this.$70_3=this.$9O_3(0);this.$6z_3=this.$9O_3(1);this.set_numberOfButtonsForDisplay(this.$9O_3(2));this.$DC_3();if($v_7){this.get_element().style.visibility="visible";Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("CommandBar Rendered",1)}}}}finally{this.$3w_3=false}},$6B_3:function($p0){return $p0==="moreCommands"||$p0==="moreChartsCommands"||$p0==="moreChartDesignerCommands"},$G1_3:function($p0){var $v_0=null,$v_1=this.$8_3;if(CUI.ScriptUtility.isNullOrUndefined($v_1)||CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3))return $v_0;if($p0===2){if(CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.$N_0))return $v_0;if(this.get_element()){var $v_2=$P_CRM(this.get_element());$v_0=$v_2.find(String.format("ul.{0}","ms-crm-CommandBar-Menu"))}}else{if(!$p0&&CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.get_chartPaneCommandBar()))return $v_0;if($p0===1&&CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.get_chartDesignerCommandBar()))return $v_0;var $v_3=$get("crmContentPanel");if(IsNull($v_3)||IsNull($v_3.attributes))return $v_0;var $v_4=$v_3.attributes.getNamedItem("currentContentId"),$v_5=null;if(!IsNull($v_4)&&$v_4.specified)$v_5=$get($v_4.value);if(!IsNull($v_5)){var $v_6=$v_5.contentWindow,$v_7=!$p0?"chartPaneCommandBar":"chartDesignerCommandBar",$v_8=$v_6.document.getElementById($v_7);if(!IsNull($v_8)){var $v_9=$P_CRM($v_8),$v_A=!$p0?"ms-crm-chartsPaneCommand-Bar":"ms-crm-chartDesignerCommand-Bar";$v_0=$v_9.find(String.format("ul.{0}.{1}","ms-crm-CommandBar-Menu",$v_A))}}}return $v_0},$9O_3:function($p0){var $v_0=null,$v_1=null,$v_2=null,$v_3=false,$v_4=false,$v_5=0,$v_6=0,$v_7,$v_8,$v_9="moreCommands";if($p0===2){$v_6=7;$v_7=10;$v_8=this.get_availableWidth()}else{$v_6=3;$v_7=15;$v_8=!$p0?this.get_availableWidthOnChartPane():this.get_availableWidthOnChartDesigner();$v_9=!$p0?"moreChartsCommands":"moreChartDesignerCommands"}var $v_A=this.$G1_3($p0),$v_B=null;if(!CUI.ScriptUtility.isNullOrUndefined($v_A))$v_B=$v_A[0];if(!CUI.ScriptUtility.isNullOrUndefined($v_B)){$v_0=$v_B.getElementsByTagName("LI");$v_1=$v_A.find(String.format("#{0}",$v_9));if(!CUI.ScriptUtility.isNullOrUndefined($v_1))$v_2=$v_1[0]}if(CUI.ScriptUtility.isNullOrUndefined($v_0)||CUI.ScriptUtility.isNullOrUndefined($v_0.length)||!$v_0.length)return $v_6;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)){$v_5=1;if($v_2.style.display!=="none")$v_3=true}for(var $v_C=0;$v_C<$v_0.length;$v_C++){var $v_D=$v_0[$v_C];if($v_8-($v_D.offsetWidth+$v_7)<0){$v_6=$v_C;$v_4=true;if(!$v_5)$v_6--;break}else{if(this.$6B_3($v_D.id)){$v_5=0;continue}$v_8-=$v_D.offsetWidth+$v_7}}if($v_3||$v_4){$v_8-=$v_1.width()+$v_7;$v_C--;while($v_8<0&&$v_C>=0){var $v_E=$v_0[$v_C];$v_C--;$v_8+=$v_E.offsetWidth+$v_7;if(this.$6B_3($v_E.id)){$v_5=1;continue}$v_6--}}return $v_6},dispose:function(){if(this.get_isDisposed())return;this.$BW_3();if(!IsNull(this.$3v_3)){window.clearTimeout(this.$3v_3);this.$3w_3=false}!IsNull(this.$1g_3)&&window.clearTimeout(this.$1g_3);Mscrm.CrmUIControl.prototype.dispose.call(this)},$9Z_3:function($p0){if(!IsNull(this.$8_3)){var $v_0={};$v_0["SourceControlId"]=this.get_id();this.$8_3.executeCommand($p0,$v_0)}},$G7_3:function($p0,$p1){if(!IsNull(this.$8_3))return this.$8_3.getDynamicMenuRibbonFromCommand($p0,$p1);return null},$GX_3:function($p0,$p1){var $v_0=this.get_$9T_3()[$p0];if(IsNull($v_0)){if(!IsNull(this.$8_3))$v_0=this.$7a_3($p0,$p1)&&this.$8_3.isControlEnabled($p0);else $v_0=false;this.get_$9T_3()[$p0]=$v_0}return $v_0},$7a_3:function($p0,$p1){if(!IsNull(this.$8_3)&&!IsNull($p0))return this.$8_3.isControlVisible($p0,$p1);else return false},$BI_3:function($p0){Mscrm.RibbonManager.get_$2y().addPageComponent($p0)},$G8_3:function($p0,$p1){if(!isInstanceOfTypeAcrossFrames($p0,Mscrm.CommandBarData))return;if($p0.get_$7b_2()&&IsNull(this.$1S_3)){this.$1S_3=$p0;return}this.loadCommandBarDataAsync($p0,$p1)},$GE_3:function($p0,$p1){if(!isInstanceOfTypeAcrossFrames($p0,Mscrm.RibbonData))return;if($p0.get_$7b_2()&&IsNull(this.$1S_3)){this.$1S_3=$p0;return}if(this.$4f_3)this.$9w_3($p0,$p1);else this.$Cg_3($p0,$p1)},loadCommandBarDataAsync:function(commandBarData,parameters){var $$t_4=this,$v_0=function(){try{if(commandBarData.get_isDisposed())return;$$t_4.$Cf_3(commandBarData,parameters)}catch($v_1){if($v_1.number!==-2146823277)throw $v_1}};if(!IsNull(this.$1g_3)){window.clearTimeout(this.$1g_3);this.$1g_3=null}this.$1g_3=window.setTimeout($v_0,0)},destroyChartCommandBar:function(){for(var $v_0=0;$v_0<this.$1q_3.length;$v_0++){!IsNull(this.$1q_3[$v_0].get_chartPaneCommandBar())&&this.$1q_3[$v_0].get_chartPaneCommandBar().dispose();!IsNull(this.$1q_3[$v_0].get_chartDesignerCommandBar())&&this.$1q_3[$v_0].get_chartDesignerCommandBar().dispose()}this.$Bn_3()},$Cg_3:function($p0,$p1){var $$t_4=this,$v_0=function(){try{$$t_4.$9w_3($p0,$p1)}catch($v_1){if($v_1.number!==-2146823277)throw $v_1}};executeFunctionDeferred($v_0,true,false)},$9w_3:function($p0,$p1){if($p0.$3G_2)return;window.self.RibbonLoadStartTime=(new Date).getTime();this.$8_3&&!this.$8_3.$3H_2&&this.$9r_3(this.$8_3,true);var $v_0=$get("ms-crm-lightbox");if($v_0)$v_0.style.visibility="hidden";for(var $v_2=0;$v_2<this.$3b_3.length;$v_2++){var $v_3=this.$3b_3[$v_2];if(!IsNull($v_3)){var $v_4=$v_3.get_ribbon();!IsNull($v_4)&&$v_4.dispose();$v_3.dispose();$v_4=null;$v_3=null}this.$3b_3[$v_2]=null}this.$3b_3=[];$p0.$5j_2="ribbonContainer"+Mscrm.RibbonManager.$9G++;$p0.$2X_2=this;try{this.$8_3=$p0.get_$9v_3()?this.$1S_3:$p0}catch($$e_6){this.$8_3=this.$1S_3}if(!IsNull(this.$8_3)){this.$8_3.$C6_2();this.$Gk_3(this.$8_3);this.$Gl_3(this.$8_3,$p1);this.get_$De_3()&&this.$D9_3()}this.$2L_3=false;var $v_1=$get("perceivedRibbonId");if(!IsNull($v_1)){$v_1.style.visibility="hidden";$v_1.innerHTML="<div/>"}this.$DX_3();this.raiseEvent(Mscrm.ScriptEvents.RibbonRendered,null);executeFunctionDeferred(this.$$d_$Hb_3,true,false)},$Hb_3:function(){window.self.FullyLoadedTime=(new Date).getTime();var $$t_1=this;executeFunctionDeferred(function(){var $v_0=$get("perceivedRibbonId");!IsNull($v_0)&&typeof processLoadedRibbon!=="undefined"&&window.processLoadedRibbon()},false,false)},$Gk_3:function($p0){if(!IsNull(this.$1s_3)){Mscrm.RibbonManager.get_$2y().removePageComponent(this.$1s_3);this.$1s_3=null}if(!IsNull($p0)&&!IsNull($p0.get_$45_2())){this.$1s_3=new Mscrm.CommandHandlerWrapper($p0.get_$45_2());Mscrm.RibbonManager.get_$2y().addPageComponent(this.$1s_3)}},$Gl_3:function($p0,$p1){this.get_$AT_3()&&this.$Gm_3($p0,$p1);isOutlookHostedWindow()&&getOutlookHostedWindow().handleEvent(Mscrm.ScriptEvents.RibbonRefresh,null,null)},$F4_3:function(){for(var $v_0,$v_1=0;$v_1<this.$1q_3.length;$v_1++){$v_0=this.$1q_3[$v_1];if(!IsNull($v_0)){var $v_2=$v_0.$N_0;!IsNull($v_2)&&$v_2.dispose();$v_0.dispose();$v_2=null;$v_0=null}this.$1q_3[$v_1]=null}},$Cf_3:function($p0,$p1){var $v_0=false,$v_1=new Mscrm.Performance.PerformanceStopwatch("LoadCommandBarData");$v_1.start();try{if(IsNull($p0)||$p0.$3G_2||CUI.ScriptUtility.isNullOrUndefined($p0.get_isDisposed())||$p0.get_isDisposed()){$v_0=true;return}this.$8_3&&!this.$8_3._disposed&&!this.$8_3.$3H_2&&this.$9o_3(this.$8_3);this.$F4_3();this.$1q_3=[];$p0.$5j_2="commandContainer"+Mscrm.RibbonManager.$9G++;$p0.$2X_2=this;var $v_2=document.createElement("div");$v_2.id=$p0.$5j_2;try{this.$8_3=!$p0.get_$9v_3()?$p0:this.$1S_3}catch($$e_5){this.$8_3=this.$1S_3}if(!IsNull(this.$35_3)){Mscrm.Utilities.destroyElement(this.$35_3);this.$35_3=null}this.$Bn_3();this.get_element().appendChild($v_2);if(!$p0.get_$3V_3())this.get_element().style.height="62px";else this.get_element().style.height="43px";this.$35_3=$v_2;this.get_element().setAttribute("currentRibbonElement",$v_2.id);var $v_3=new Mscrm.CommandBarBuildOptions($p0);$v_3.$7M_0=$p0.get_$IG_2();$v_3.$2V_0=this.get_numberOfButtonsForDisplay();$v_3.$t_0=this.get_availableWidth();var $v_4=new Mscrm.CommandBarBuilder($v_3,$v_2);$p0.$O_3=$v_4;$v_4.buildCommandBar($p0);var $v_5=false;if(!$p0.get_$3V_3()&&!this.$2t_3&&!this.$GU_3($v_2)){this.get_element().style.display="none";$v_5=true}else{if(isNullOrEmptyString(this.get_element().style.display)||this.get_element().style.display==="none")$v_5=true;this.get_element().style.display="block";$v_2.style.display="inline";if(Mscrm.PerceivedCommandBarHelper.hasPerceivedCommandBar())this.get_element().style.visibility="hidden";else this.get_element().style.visibility="visible"}this.$Br_3();this.$DX_3();this.$6n_3=true;if(!this.$3w_3){this.$3w_3=true;this.$3v_3=window.setTimeout(this.$$d_$CQ_3,100)}var $v_6=$get("perceivedRibbonId");if(!IsNull($v_6)){if($get("crmTopBar"))$get("crmTopBar").style.visibility="visible";$v_6.style.visibility="hidden";$v_6.innerHTML="<div/>"}$v_5&&this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null);this.raiseEvent(Mscrm.ScriptEvents.RibbonRendered,null)}finally{if(!$v_0){this.$Br_3();window.self.CommandBarLoadEndTime=(new Date).getTime();executeFunctionDeferred(this.$$d_$Ha_3,true,false)}}$v_1.stop()},$Ha_3:function(){window.self.FullyLoadedTime=(new Date).getTime()},$DX_3:function(){if(!IsNull(this.$8_3)){this.$8_3.$3G_2=true;this.$8_3.$3H_2=false}},$GU_3:function($p0){var $v_0=Mscrm.Utilities.getChildElementsByClassName($p0,"ms-crm-CommandBarItem",false);if(!IsNull($v_0)&&$v_0.length>0)for(var $v_1=0;$v_1<$v_0.length;$v_1++)if($v_0[$v_1].style.display!=="none")return true;return false},$Bn_3:function(){if(!IsNull(this.$1R_3[0]))this.$1R_3[0]=null;if(!IsNull(this.$1R_3[1]))this.$1R_3[1]=null},$Gm_3:function($p0,$p1){var $v_0=document.createElement("div");$v_0.id=$p0.$5j_2;Mscrm.RibbonManager.get_$2y().disposeAllRoots();if(!IsNull(this.$35_3)){Mscrm.Utilities.destroyElement(this.$35_3);this.$35_3=null}this.get_element().appendChild($v_0);this.get_element().style.height="";$p0.$Dp_3=$v_0;this.$35_3=$v_0;this.get_element().setAttribute("currentRibbonElement",$v_0.id);var $v_1=$p0.get_$IG_2(),$v_2=$p0.$83_3,$v_3=$p0.$6x_3,$v_4=$p0.get_$Dh_2(),$v_5=new Array(0),$$dict_8=$v_3;for(var $$key_9 in $$dict_8){var $v_A={key:$$key_9,value:$$dict_8[$$key_9]},$v_B=$v_A.key;if(!IsNull($v_B)&&$v_B.length>0&&IsNull($v_1[$v_B]))$v_5[$v_5.length]=$v_B}var $v_6=new CUI.RibbonBuildOptions;$v_6.shownTabs=$v_3;$v_6.initiallyVisibleContextualGroups=$v_2;$v_6.trimmedIds=$v_1;$v_6.showJewelId=Mscrm.RibbonConstants.jewelId;$v_6.trimEmptyGroups=true;$v_6.minimized=Mscrm.RibbonManager.$5p;var $v_7=new CUI.RibbonBuilder($v_6,$v_0,Mscrm.RibbonManager.get_$2y()),$v_8=new Mscrm.CrmDataSource($v_5,$p0.get_$Gh_3(),$v_4);$v_7.$10_0=$v_8;var $v_9=$p0.get_$GS_2();if($p1&&!isNullOrEmptyString($p1["initialTabId"]))$v_9=$p1["initialTabId"];$p0.set_$GS_2($v_8.getInitialTabId($v_9));$v_7.buildRibbonAndInitialTab($p0.get_$GS_2());$p0.$60_3=$v_7;$v_0.style.display="inline";this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null);$p0.$Ad_3&&openErrorDlg("0x8004f671",null,null,0,0);$v_7.get_ribbon().$4F_2();window.self.RibbonLoadEndTime=(new Date).getTime()},$Dl_3:function($p0){if(this.$2L_3)return false;var $v_0=!$p0.get_$1Z_2()?Mscrm.RibbonData:Mscrm.CommandBarData;if(!isInstanceOfTypeAcrossFrames($p0,$v_0))return false;if($p0!==this.$8_3)return false;$p0.$3H_2=true;$p0.$3G_2=false;return true},$9o_3:function($p0){if(IsNull($p0))return;if(!this.$Dl_3($p0))return;var $v_0=new Mscrm.Performance.PerformanceStopwatch("HandleCommandBarDataUnload");$v_0.start();if(!IsNull(this.$1g_3)){window.clearTimeout(this.$1g_3);this.$1g_3=null}this.closeAllMenu($p0);this.$2L_3=true;this.$F5_3();var $v_1=$p0.$O_3;if(!IsNull($v_1)){$p0.$O_3=null;this.$1q_3[this.$1q_3.length]=$v_1}$v_0.stop()},$9r_3:function($p0,$p1){var $v_0;if(IsNull($p1))$p1=false;if(!this.$Dl_3($p0))return;if(!IsNull(this.$1s_3)){Mscrm.RibbonManager.get_$2y().removePageComponent(this.$1s_3);if(!$p1){var $v_1=[],$$dict_4=$p0.get_$4G_2();for(var $$key_5 in $$dict_4){var $v_3={key:$$key_5,value:$$dict_4[$$key_5]};if(this.$1s_3.canHandleCommand($v_3.key))$v_1[$v_1.length]=$v_3.key}var $$dict_7=$p0.get_$Ei_2();for(var $$key_8 in $$dict_7){var $v_4={key:$$key_8,value:$$dict_7[$$key_8]};if(this.$1s_3.canHandleCommand($v_4.key))$v_1[$v_1.length]=$v_4.key}this.$1s_3=new Mscrm.AlwaysEnabledCommandHandler(this.$1s_3.getId()+"_tabsOnly",$v_1);Mscrm.RibbonManager.get_$2y().addPageComponent(this.$1s_3);var $v_2=this.$8_3.get_$2h_2();if(!IsNull($v_2)){var $v_5=$v_2.get_element(),$v_6=$get("ms-crm-lightbox");if(!$v_6){$v_6=document.createElement("DIV");$v_6.id=$v_6.className="ms-crm-lightbox";$v_6.style.top=$v_5.offsetTop.toString()+"px";$v_6.style.left=$v_5.offsetLeft.toString()+"px";$v_6.style.height=$v_5.offsetHeight.toString()+"px";$v_6.style.width=$v_5.offsetWidth.toString()+"px";$v_5.appendChild($v_6)}else $v_6.style.visibility="visible";var $v_7=$v_5.className;$v_5.className=!IsNull($v_7)?"ms-cui-disabled":$v_7+" ms-cui-disabled"}}}$v_0=$p0.$60_3;$p0.$60_3=null;if(!IsNull($v_0)){var $v_8=$v_0.get_ribbon();!IsNull($v_8)&&$v_8.$51_1();this.$3b_3[this.$3b_3.length]=$v_0}this.$2L_3=true},$GB_3:function($p0,$p1){if(isInstanceOfTypeAcrossFrames($p0,Mscrm.ContentPanel)&&!IsNull(this.$1S_3)){this.$1S_3.$3G_2=false;if(this.$4f_3)this.$9w_3(this.$1S_3,null);else if(!this.$1S_3.get_$1Z_2())this.$Cg_3(this.$1S_3,null);else this.loadCommandBarDataAsync(this.$1S_3,$p1)}},$BW_3:function(){var $$dict_0=this.$3f_3;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]};window.clearTimeout(this.$3f_3[$v_0.key]);delete this.$3f_3[$v_0.key]}},$GC_3:function($p0){this.$BW_3();if(!IsNull(this.$3v_3)){window.clearTimeout(this.$3v_3);this.$3w_3=false}try{if(isInstanceOfTypeAcrossFrames($p0,Mscrm.ContentPanel)&&!IsNull(this.$8_3)&&!this.$8_3._disposed){if(!this.$8_3.get_isDisposed())if(!this.$8_3.get_$1Z_2())this.$9r_3(this.$8_3);else this.$9o_3(this.$8_3);this.$8_3=null}}catch($v_0){if($v_0.number!==-2146823277)throw $v_0}},$DD_3:function($p0){var $v_0="unspecified";if(!IsNull($p0)&&!IsNull($p0["mode"]))$v_0=$p0["mode"];return $v_0},$AE_3:function($p0){if(this.$2L_3)return;var $v_0=this.$DD_3($p0);if(!($v_0 in this.$3f_3)){var $$t_2=this;this.$3f_3[$v_0]=window.setTimeout(function(){$$t_2.$Hq_3($p0)},100)}},$Hq_3:function($p0){delete this.$3f_3[this.$DD_3($p0)];isOutlookHostedWindow()&&Mscrm.SessionInfo.getOutlookMajorVersion()<14&&getOutlookHostedWindow().handleEvent(Mscrm.ScriptEvents.RibbonRefresh,null,null);this.$Hl_3($p0)},$Hl_3:function($p0){if(this.$2L_3)return;if(this.get_$AT_3()&&this.$8_3&&!this.$8_3._disposed)if(!this.$8_3.get_$1Z_2())this.$Hm_3();else this.$Hk_3($p0);this.get_$De_3()&&this.$D9_3();this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null)},$Hk_3:function($p0){var $v_0=this.$8_3;!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.$N_0)&&$v_0.$O_3.refreshCommandBar($p0)},$DC_3:function(){var $v_0=this.$8_3;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.$N_0)){$v_0.$O_3.get_commandBarBuildOptions().$2V_0=this.get_numberOfButtonsForDisplay();$v_0.$O_3.get_commandBarBuildOptions().$t_0=this.get_availableWidth();if(!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.get_chartsPaneCommandBarBuildOptions())){$v_0.$O_3.get_chartsPaneCommandBarBuildOptions().$2V_0=this.$70_3;$v_0.$O_3.get_chartsPaneCommandBarBuildOptions().$t_0=this.$3a_3}if(!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.get_chartsDesignerCommandBarBuildOptions())){$v_0.$O_3.get_chartsDesignerCommandBarBuildOptions().$2V_0=this.$6z_3;$v_0.$O_3.get_chartsDesignerCommandBarBuildOptions().$t_0=this.$3Z_3}$v_0.$O_3.resizeCommandBar()}},$DP_3:function($p0,$p1){if(!this.$Ge_3())return;window.self.ChartCommandBarLoadStartTime=(new Date).getTime();if(IsNull(this.$1R_3[$p0])||isNullOrEmptyString(this.$1R_3[$p0].innerHTML)){this.$1R_3[$p0]=document.createElement("div");var $v_0=this.$8_3,$v_1=new Mscrm.CommandBarBuildOptions($v_0);$v_1.$t_0=this.get_availableWidth();$v_1.$2V_0=3;if(!IsNull($v_0)&&!IsNull($v_0.$O_3)){$v_0.$O_3.buildChartCommandBar(this.$1R_3[$p0],$p0,$v_1);this.$6n_3=true}}!IsNull($p1)&&$p1.appendChild(this.$1R_3[$p0]);window.self.ChartCommandBarLoadEndTime=(new Date).getTime()},getChartCommandBarNode:function(commandMode){if(!IsNull(this.$1R_3[commandMode]))return this.$1R_3[commandMode];return null},setChartDesignerCommandBar:function(chartCommandBar){this.$DP_3(1,chartCommandBar)},setChartPaneCommandBar:function(chartCommandBar){this.$DP_3(0,chartCommandBar)},$Ge_3:function(){if(IsNull(this.$8_3)||this.$8_3._disposed||this.$8_3.get_$7b_2()||!this.$8_3.get_$1Z_2()||!this.$8_3.$3G_2||this.$8_3.get_$5G_2()!==Mscrm.RibbonContexts.homepageGrid||Mscrm.SessionInfo.isOutlookClient())return false;return true},$Hm_3:function(){if(this.$8_3&&this.$8_3.get_$2h_2()){var $v_0=this.$8_3.get_$2h_2(),$v_1={},$$dict_2=this.$8_3.get_$4G_2();for(var $$key_3 in $$dict_2){var $v_3={key:$$key_3,value:$$dict_2[$$key_3]};$v_1[$v_3.key]=$v_3.value}this.$8_3.$C6_2();if($v_0.$B_2)$v_0.$B_2.$1H_2=false;$v_0.refresh();var $v_2=null,$$dict_6=this.$8_3.get_$4G_2();for(var $$key_7 in $$dict_6){var $v_4={key:$$key_7,value:$$dict_6[$$key_7]};if($v_4.value&&!$v_1[$v_4.key]){$v_2=$v_4.key;break}}!isNullOrEmptyString($v_2)&&$v_0.selectTabByCommand($v_2)}},$D9_3:function(){var $v_0=this.get_$9T_3(),$v_1={},$v_2;if(!IsNull(this.$8_3))$v_2=this.$8_3.get_$9N_2();else $v_2={};var $v_3=new Array(0),$$dict_4=$v_2;for(var $$key_5 in $$dict_4){var $v_4={key:$$key_5,value:$$dict_4[$$key_5]},$v_5=$v_4.key,$v_6=$v_0[$v_5],$v_7=this.$8_3.isControlEnabled($v_5);$v_1[$v_5]=$v_7;if(IsNull($v_6)||$v_6!==$v_7)$v_3[$v_3.length]=$v_5}this.$6k_3=$v_1;getOutlookHostedWindow().handleEvent(Mscrm.ScriptEvents.RibbonRefresh,null,null)},$I2_3:function($p0,$p1){if(!IsNull(this.$8_3)&&!IsNull(this.$8_3.get_$2h_2()))if(!this.$8_3.get_$1Z_2()){var $v_0=this.$8_3.get_$2h_2();switch($p0){case Mscrm.ScriptEvents.RibbonSetFocusToLastControl:$v_0.jumpToLastFocused($p1);break;case Mscrm.ScriptEvents.RibbonSetFocusToSelf:$v_0.jumpToRibbonTab($p1);break}}else if(this.$8_3.get_$1Z_2()===1){var $v_1=this.$8_3.get_$2h_2();switch($p0){case Mscrm.ScriptEvents.RibbonSetFocusToLastControl:$v_1.setLastFocused();break;case Mscrm.ScriptEvents.RibbonSetFocusToSelf:$v_1.setFocus();break}}},$53_3:function($p0){var $v_0=0,$v_1=this.$8_3;if(CUI.ScriptUtility.isNullOrUndefined($v_1)||CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3))return $v_0;if($p0===2){if(CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.$N_0))return $v_0;if(this.$2t_3&&!CUI.ScriptUtility.isNullOrUndefined(this.get_parent())&&!CUI.ScriptUtility.isNullOrUndefined(this.get_parent().get_element())&&this.get_parent().get_element().offsetWidth)$v_0=this.get_parent().get_element().offsetWidth;else $v_0=this.get_width();$v_0-=20;var $v_2=$P_CRM(this.get_element().parentNode).find(String.format("#{0}","contextualActionBar"))[0];if(!CUI.ScriptUtility.isNullOrUndefined($v_2))$v_0-=$v_2.offsetWidth;return $v_0}else{if(!$p0&&CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.get_chartPaneCommandBar()))return $v_0;if($p0===1&&CUI.ScriptUtility.isNullOrUndefined($v_1.$O_3.get_chartDesignerCommandBar()))return $v_0;if(!IsNull(this.$1R_3[$p0])){var $v_3=this.$1R_3[$p0].parentNode;if(!IsNull($v_3)){$v_0=$v_3.offsetWidth;$v_0-=10}}return $v_0}},$F5_3:function(){if(this.$2L_3){var $v_0=this.$8_3;!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.$N_0)&&$v_0.$O_3.$N_0.$Bo_4(.1)}},$Br_3:function(){if(this.$2L_3){this.$2L_3=false;var $v_0=this.$8_3;!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.$O_3.$N_0)&&$v_0.$O_3.$N_0.$Bq_4(false)}},closeAllMenu:function(commandBarData){if(IsNull(commandBarData))return;var $v_0=commandBarData.$O_3;if(!IsNull($v_0)){!IsNull($v_0.$N_0)&&$v_0.$N_0.closeAllMenus();!IsNull($v_0.get_chartPaneCommandBar())&&$v_0.get_chartPaneCommandBar().closeAllMenus();!IsNull($v_0.get_chartDesignerCommandBar())&&$v_0.get_chartDesignerCommandBar().closeAllMenus()}}};Mscrm.RibbonNavigationModel=function(){};Mscrm.RibbonNavigationModel.isContextualGroupForAssociatedGrid=function($p0){return Mscrm.RibbonNavigationModel.$7J.test($p0)};Mscrm.RibbonNavigationModel.shouldContextGroupBeShown=function($p0,$p1){if(Mscrm.RibbonNavigationModel.$BB.test($p0.command)){var $v_0=$p1._currentSelectedControl;if($v_0&&Mscrm.IGridControl.isInstanceOfType($v_0)){var $v_1=parseInt($v_0.GetParameter("relationshipType"),10);return $v_1===$p0.relationshipType}}return true};Mscrm.RibbonNavigationModel.shouldTabBeShown=function($p0,$p1,$p2){var $$dict_3=$p2.get_$Dh_2();for(var $$key_4 in $$dict_3){var $v_0={key:$$key_4,value:$$dict_3[$$key_4]},$v_1=$v_0.value;if($v_1.TabCommand===$p0){var $v_2=new Mscrm.CommandInformation;$v_2.command=$v_1.ContextGroupCommand;$v_2.entityContext=$p1.entityContext;$v_2.entityLogicalName=$p1.entityLogicalName;$v_2.relationshipType=$p1.relationshipType;return Mscrm.RibbonNavigationModel.shouldContextGroupBeShown($v_2,$p2)}}return true};Mscrm.RibbonNavigationModel.onTabSwitch=function($p0,$p1,$p2,$p3){if($p3){if(isNullOrEmptyString($p0))$p0=$p2.get_$GS_2();var $v_0=$p2.get_$Dh_2()[$p0],$v_1=$p2.get_$Dh_2()[$p1];if($v_0&&$v_1){var $v_2=$v_0.ContextualGroupId||"",$v_3=$v_1.ContextualGroupId||"";if(Mscrm.RibbonNavigationModel.$9B.test($v_2)&&!Mscrm.RibbonNavigationModel.$9B.test($v_3)){var $v_4=window.frames[0].window,$v_5=$v_4.location.pathname.toUpperCase();if(!$v_5.endsWith("/ADVFIND.ASPX"))setSelectedControl(null);else $v_4.ShowQuery(null)}if((Mscrm.RibbonNavigationModel.$7J.test($v_2)||$p0==="Mscrm.DocumentsTab")&&!Mscrm.RibbonNavigationModel.$7J.test($v_3)){var $v_6=$find("crmContentPanel"),$v_7=0;while(true){var $v_8=$v_6.get_contentWindow().document.getElementById("tab"+$v_7+"Tab");if($v_8){if($v_8.parentNode.style.visibility!=="hidden"&&$v_8.parentNode.style.display!=="none"){$v_6.get_contentWindow()._initialTabId=$p1;window.setTimeout(function(){Mscrm.Utilities.click($v_8)},0);break}}else break;$v_7++}}}}};Mscrm.CommandData=function(){this.$94_2=Mscrm.EntityTypeCode.None;this.$93_2=new Array(0);Mscrm.CommandData.initializeBase(this)};Mscrm.CommandData.prototype={$Q_2:null,$B4_2:false,$2M_2:null,$5j_2:null,$2F_2:null,$6W_2:null,$B3_2:null,$BA_2:"",$B9_2:0,$Ah_2:"",$2X_2:null,$3H_2:false,$3G_2:false,_currentSelectedControl:null,get_serverInformation:function(){return this.$Q_2},set_serverInformation:function(value){this.$Q_2=value;return value},$Ag_2:null,get_$Ec_2:function(){if(!IsNull(this.$Q_2))return this.$Q_2.CommandIds;return new Array(0)},get_$7b_2:function(){if(!IsNull(this.$Q_2))return this.$Q_2.IsDefaultData;return false},get_$45_2:function(){if(IsNull(this.$2M_2)){var $v_0=this.$5j_2+"_CommandHandler";this.$2M_2=new Mscrm.CommandHandler($v_0,this,this.get_$Ec_2())}return this.$2M_2},get_$A6_2:function(){return this.$2F_2},get_$DL_2:function(){if(!IsNull(this._currentSelectedControl))return this._currentSelectedControl.get_selectedRecordCount();return 0},get_$Hd_2:function(){var $v_0=this.$2F_2;try{return $v_0.get_selectedRecordCount()}catch($$e_1){return 0}},get_$5G_2:function(){if(!IsNull(this._currentSelectedControl))return this._currentSelectedControl.get_ribbonContextType();return null},get_$DJ_2:function(){if(!IsNull(this._currentSelectedControl))return this._currentSelectedControl.get_entityTypeCode();return 0},get_$DK_2:function(){if(!IsNull(this._currentSelectedControl))return this._currentSelectedControl.get_entityTypeName();return null},get_$Hc_2:function(){var $v_0=this.$2F_2;try{return $v_0.get_ribbonContextType()}catch($$e_1){return null}},get_$D5_2:function(){var $v_0=this.$2F_2;try{return $v_0.get_entityTypeCode()}catch($$e_1){return Mscrm.EntityTypeCode.None}},get_$D6_2:function(){var $v_0=this.$2F_2;try{return $v_0.get_entityTypeName()}catch($$e_1){return null}},get_permanentlySelectedControl:function(){return this.$B3_2},set_permanentlySelectedControl:function(value){this.$B3_2=value;this.setCurrentSelectedControl(value);return value},get_selectedControl:function(){return this._currentSelectedControl},get_$DM_2:function(){if(!IsNull(this._currentSelectedControl))return this._currentSelectedControl.get_selectedIds();return null},get_$A7_2:function(){var $v_0=this.$2F_2;try{return $v_0.get_selectedIds()}catch($$e_1){return new Array(0)}},get_primaryControl:function(){return this.$2F_2},set_primaryControl:function(value){this.$2F_2=value;return value},setCurrentSelectedElement:function(element){this.$6W_2=element;this.setCurrentSelectedControl($find(element.id))},setCurrentSelectedControl:function(control){this._currentSelectedControl=control;if(!IsNull(control))this.$6W_2=$get(control.get_id());else this.$6W_2=null;this.setSelectedControlValues(control)},setSelectedControlValues:function(control){var $v_0="",$v_1=Mscrm.EntityTypeCode.None,$v_2=0,$v_3=new Array(0),$v_4="";if(control&&Mscrm.IRibbonSelectionControl.isInstanceOfType(control)){$v_0=control.get_entityTypeName();$v_1=control.get_entityTypeCode();$v_2=control.get_selectedRecordCount();$v_3=control.get_selectedIds();$v_4=control.get_id()}var $v_5=this.$BA_2!==$v_0||this.$94_2!==$v_1||this.$B9_2!==$v_2||this.$93_2.length!==$v_3.length||this.$Ah_2!==$v_4;this.$BA_2=$v_0;this.$94_2=$v_1;this.$B9_2=$v_2;this.$93_2=$v_3;this.$Ah_2=$v_4;var $v_6=false;try{var $v_7=control;if(!IsNull($v_7))$v_6=true}catch($$e_9){$v_6=false}($v_6||$v_5)&&this.$2X_2&&this.raiseEvent(Mscrm.ScriptEvents.RibbonRefresh,null)},dispose:function(){if(this.get_isDisposed())return;Mscrm.CrmUIComponent.prototype.dispose.call(this)},initialize:function(){Mscrm.CrmUIComponent.prototype.initialize.call(this)},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.PageLoaded:this.$A9_2(parameters,sourceComponent,false,false);break;case Mscrm.ScriptEvents.StaticScriptsLoaded:this.$A9_2(parameters,sourceComponent,true,false);break;case Mscrm.ScriptEvents.PageUnloaded:this.$A9_2(parameters,sourceComponent,false,true);break;case Mscrm.ScriptEvents.IFrameReactivated:if($find("crmPageManager")===sourceComponent){if(!this.get_$7b_2())this.$3G_2=false;this.raiseEvent(Mscrm.ScriptEvents.RibbonDataLoad,null)}break;case Mscrm.ScriptEvents.SelectionChanged:if($find(sourceComponent.get_id())===sourceComponent)if(sourceComponent===this.$2F_2&&this.$2X_2)this.raiseEvent(Mscrm.ScriptEvents.RibbonRefresh,null);else sourceComponent===this._currentSelectedControl&&this.setSelectedControlValues(sourceComponent);break;case Mscrm.ScriptEvents.SetRibbonSelectedControl:this.setSelectedControl(parameters);break;case Mscrm.ScriptEvents.RibbonTabSwitch:this.handleRibbonTabSwitch(parameters);break}return null},setSelectedControl:function(parameters){if(IsNull(this.get_permanentlySelectedControl())){var $v_0=parameters["selectedControl"];this.setCurrentSelectedControl($v_0)}},getDynamicMenuRibbonFromCommand:function(command,properties){if(this.isControlEnabled(command)){if(!properties)properties={};this.get_$45_2().handleCommand(command,properties,0);return properties["PopulationXML"]}return null},isControlVisible:function(command,id){try{return !IsNull(this.get_$9N_2()[command])&&IsNull(this.get_$IG_2()[id])}catch($$e_2){return false}},hasAssociatedGridContext:function(){if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.TabList))for(var $v_0=this.$Q_2.TabList,$v_1=this.get_$Dh_2(),$v_2=0;$v_2<$v_0.length;$v_2++){var $v_3=$v_1[$v_0[$v_2].TabId];if($v_3&&$v_3.IsContextual&&!isNullOrEmptyString($v_3.ContextualGroupId)&&Mscrm.RibbonNavigationModel.isContextualGroupForAssociatedGrid($v_3.ContextualGroupId))return true}return false},isControlEnabled:function(command){return !IsNull(this.get_$9N_2()[command])&&this.get_$45_2().canHandleCommand(command)},isControlInCommandLayout:function(command){return false},$C6_2:function(){var $$dict_0=this.get_$4G_2();for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]};this.get_$45_2().canHandleCommand($v_0.key)}},executeCommand:function(command,properties){if(this.isControlEnabled(command)){if(!properties)properties={};this.get_$45_2().handleCommand(command,properties,0)}},initializeRefreshHandler:function(){return},$4B_2:false,get_isClientApiInitialized:function(){var $v_0=window.XrmAccess,$v_1=!IsNull(Xrm.Page.data)&&!IsNull(Xrm.Page.data.entity)&&!!Xrm.Page.data.entity.attributes.getLength();window.XrmAccess=$v_0;return $v_1},$A9_2:function($p0,$p1,$p2,$p3){if((!$p3||!this.$B4_2)&&($find("crmPageManager")===$p1||$find("crmInlinePageManager")===$p1)){var $v_0=null;if(!IsNull($p0))$v_0=$p0["sourceUri"];if(!IsNull($v_0)&&!$v_0.compare(Mscrm.Utilities.getContentUrl(null),true,5))return;var $v_1=(Mscrm.Utilities.isRefreshForm()&&$p2||!Mscrm.Utilities.isRefreshForm()&&!$p2)&&!$p3;if($v_1){this.initializeRefreshHandler();this.raiseEvent(Mscrm.ScriptEvents.RibbonDataLoad,$p0)}else if($p3){this.$B4_2=true;this.raiseEvent(Mscrm.ScriptEvents.RibbonDataUnload,null);this.dispose()}}}};function loadCommandData(commandBarId){var $v_0=$find("crmRibbonData");if(!IsNull($v_0)){var $v_1=Mscrm.CommandLayout;$v_0.$Cj_3($v_1[commandBarId])}}Mscrm.CommandBarData=function(){this.$$d_reloadCommandBar=Function.createDelegate(this,this.reloadCommandBar);Mscrm.CommandBarData.initializeBase(this)};Mscrm.CommandBarData.$Ck=function($p0,$p1){var $$dict_2=$p0;for(var $$key_3 in $$dict_2){var $v_0={key:$$key_3,value:$$dict_2[$$key_3]};if(IsNull($p1[$v_0.key]))$p1[$v_0.key]=$v_0.value;else{var $$dict_5=$v_0.value;for(var $$key_6 in $$dict_5){var $v_1={key:$$key_6,value:$$dict_5[$$key_6]};$p1[$v_0.key][$v_1.key]=$v_1.value}}}};Mscrm.CommandBarData.prototype={$22_3:null,$1c_3:null,$82_3:null,$84_3:null,$O_3:null,$7K_3:null,$6T_3:null,$4r_3:null,initialize:function(){Mscrm.CommandData.prototype.initialize.call(this);this.$82_3={};this.$84_3={};var $v_0=Mscrm.CommandLayout,$$dict_1=$v_0;for(var $$key_2 in $$dict_1){var $v_1={key:$$key_2,value:$$dict_1[$$key_2]};this.$Cj_3($v_1.value)}this.initializeRefreshHandler()},isDocumentTab:function(){return !IsNull(this.$Q_2)&&!IsNull(this.$Q_2.InitialTabId)&&this.$Q_2.InitialTabId==="Mscrm.DocumentsTab"},$Cj_3:function($p0){if(IsNull(this.$6T_3)){Mscrm.RibbonCommands.commands=$p0.commands;var $$dict_1=$p0.commands;for(var $$key_2 in $$dict_1){var $v_0={key:$$key_2,value:$$dict_1[$$key_2]};if($v_0.key==="null")continue;var $$dict_4=$v_0.value;for(var $$key_5 in $$dict_4){var $v_1={key:$$key_5,value:$$dict_4[$$key_5]};Mscrm.RibbonCommands.commands["null"][$v_1.key]=$v_1.value}}Mscrm.RibbonCommands.enableRules=$p0.rules;this.$6T_3=$p0.layout}else{Mscrm.CommandBarData.$Ck($p0.commands,Mscrm.RibbonCommands.commands);Mscrm.CommandBarData.$Ck($p0.rules,Mscrm.RibbonCommands.enableRules);this.$Gn_3($p0.layout)}},$Gn_3:function($p0){var $v_0=this.$6T_3.children[0],$v_1=$v_0.children[0],$v_2=$v_0.children[1],$v_3=$p0.children[0],$v_4=$v_3.children[0],$v_5=$v_3.children[1];this.$Cl_3($v_1,$v_4);this.$Cl_3($v_2,$v_5)},$Cl_3:function($p0,$p1){for(var $v_0={},$v_1=0;$v_1<$p0.children.length;$v_1++){var $v_2=CUI.DataNodeWrapper.getNodeAttribute($p0.children[$v_1],"Id"),$v_3=CUI.DataNodeWrapper.getNodeAttribute($p0.children[$v_1],"Command"),$v_4;if(!CUI.ScriptUtility.isNullOrEmptyString($v_3))$v_4=$v_2+$v_3;else $v_4=$v_2;$v_0[$v_4]=$p0.children[$v_1]}for(var $v_5=0;$v_5<$p1.children.length;$v_5++){var $v_6=CUI.DataNodeWrapper.getNodeAttribute($p1.children[$v_5],"Id"),$v_7=CUI.DataNodeWrapper.getNodeAttribute($p1.children[$v_5],"Command"),$v_8=CUI.DataNodeWrapper.getNodeChildren($p1.children[$v_5]),$v_9="";if(!CUI.ScriptUtility.isNullOrUndefined($v_8)&&$v_8.length>0)$v_9=CUI.DataNodeWrapper.getNodeAttribute($v_8[0],"Command");var $v_A;if(!CUI.ScriptUtility.isNullOrEmptyString($v_7))$v_A=$v_6+$v_7+$v_9;else $v_A=$v_6+$v_9;if(!($v_A in $v_0))$p0.children=$p0.children.concat($p1.children[$v_5])}},get_commandLayout:function(){return this.$6T_3},get_$1Z_2:function(){return 1},get_$2h_2:function(){if(!IsNull(this.$O_3))return this.$O_3.$N_0;return null},get_$4G_2:function(){return {}},get_$Ei_2:function(){return {}},get_$GS_2:function(){return "Mscrm.CommandBar"},set_$GS_2:function($p0){return $p0;return $p0},get_$9v_3:function(){var $v_0=Mscrm.CommandLayout;if(IsNull($v_0))return true;return false},get_$Dh_2:function(){return {}},handleRibbonTabSwitch:function(parameters){},get_$IG_2:function(){if(IsNull(this.$22_3)){this.$22_3={};if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.TrimList))for(var $v_0=this.$Q_2.TrimList,$v_1=0;$v_1<$v_0.length;$v_1++)this.$22_3[$v_0[$v_1]]=true}return this.$22_3},setSelectedControl:function(parameters){return},get_$9N_2:function(){if(!this.$1c_3){var $v_0={};if(!IsNull(this.$Q_2)&&!IsNull(this.$Q_2.CommandIds))for(var $v_1=0;$v_1<this.$Q_2.CommandIds.length;$v_1++)$v_0[this.$Q_2.CommandIds[$v_1]]=true;this.$1c_3=$v_0}return this.$1c_3},get_$Ca_3:function(){if(this.get_$5G_2()===Mscrm.RibbonContexts.subGridAssociated||this.get_$5G_2()===Mscrm.RibbonContexts.subGridStandard||this.isDocumentTab())return true;else return false},get_$3V_3:function(){if(this.get_$5G_2()===Mscrm.RibbonContexts.subGridAssociated||this.isDocumentTab())return true;else return false},get_toggleButtonState:function(){if(IsNull(this.$7K_3))this.$7K_3={};return this.$7K_3},set_toggleButtonState:function(value){this.$7K_3=value;return value},reloadCommandBar:function(){var $v_0=new RemoteCommand("Ribbon","ReloadCommandBar"),$v_1=$find(Mscrm.ClientApiConstants.primaryEntityId);if(IsNull($v_1))return;if(isNullOrEmptyString($v_1.get_recordId()))return;var $v_2=$v_1.get_typeName(),$v_3=$find("crmFormSelector");if(!IsNull($v_3))$v_0.SetParameter("hierarchyLocation",$v_3.get_currentFormId());else{var $v_6=window.RecordData._formId;if(!IsNull($v_6))$v_0.SetParameter("hierarchyLocation",$v_6.toString());else $v_0.SetParameter("hierarchyLocation","")}$v_0.SetParameter("entityLogicalName",$v_2);$v_0.SetParameter("ribbonContext","Form");$v_0.SetParameter("pageId",window.location.href.toString().toUpperCase());$v_0.SetParameter("recordId",$v_1.get_recordId());$v_0.SetParameter("formState",$v_1.get_formState());var $v_4=Mscrm.CrmUri.create(window.RecordData["_formlayoutUrl"]);Mscrm.PerceivedCommandBarHelper.addFormPerceivedCommandBar($v_4,true);var $v_5=$v_0.Execute();if($v_5.Success){var $v_7=Sys.Serialization.JavaScriptSerializer.deserialize($v_5.ReturnValue.toString());this.$Q_2=$v_7;this.$22_3=null;this.$1c_3=null;this.$3G_2=false;this.$3H_2=true;this.$2X_2.$Cf_3(this,null)}},isControlInCommandLayout:function(command){for(var $v_0=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName(CUI.DataNodeWrapper.getFirstChildNodeWithName(this.get_commandLayout(),"CommandBar"),"ContextualTabs")),$v_1=0;$v_1<$v_0.length;$v_1++)for(var $v_2=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($v_0[$v_1],"Groups")),$v_3=0;$v_3<$v_2.length;$v_3++){for(var $v_4=new CUI.DataNodeWrapper($v_2[$v_3]),$v_5=null,$v_7=0;$v_7<$v_4.get_children().length;$v_7++)if($v_4.get_children()[$v_7].name==="Controls"){$v_5=$v_4.get_children()[$v_7];break}if(CUI.ScriptUtility.isNullOrUndefined($v_5))throw Error.create("No Controls node found in this Group tag.");for(var $v_6=CUI.DataNodeWrapper.getNodeChildren($v_5),$v_8=0;$v_8<$v_6.length;$v_8++){var $v_9=$v_6[$v_8].attrs;if($v_9["Command"]===command)return true}}return false},dispose:function(){if(this.get_isDisposed())return;if(!IsNull(Mscrm)){!IsNull(Mscrm.CommandLayout)&&Mscrm.Utilities.destroyObject(Mscrm.CommandLayout);if(!IsNull(Mscrm.RibbonCommands)){Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands.commands);Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands.enableRules);Mscrm.Utilities.destroyObject(Mscrm.RibbonCommands)}delete Mscrm.CommandLayout;delete Mscrm.RibbonCommands}if(typeof Mscrm.ClientApiConstants!="undefined"&&!IsNull(Mscrm.ClientApiConstants.primaryEntityId)){var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId);if($v_0&&this.get_id()!=="SubGridCommandBarData"&&!IsNull(this.$4r_3)){$v_0.removeOnRecordIdChanged(this.$4r_3);this.$4r_3=null}}Mscrm.CommandData.prototype.dispose.call(this)},initializeRefreshHandler:function(){if(!IsNull(this.$4r_3))return;if(typeof Mscrm.ClientApiConstants!="undefined"&&!IsNull(Mscrm.ClientApiConstants.primaryEntityId)){var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId);if($v_0&&this.get_id()!=="SubGridCommandBarData"){var $$t_2=this;this.$4r_3=function($p1_0){$$t_2.$2X_2.$DA_3()};$v_0.addOnRecordIdChanged(this.$4r_3,false)}}return},isControlEnabled:function(command){var $v_0=window.XrmAccess,$v_1=!this.get_isClientApiInitialized();if($v_1){window.XrmAccess=false;window.XrmDataProperty=window.Xrm;if(!window.XrmAccess)try{Object.defineProperty(window,"Xrm",{"get":function(){window.XrmAccess=true;return window.XrmDataProperty},"set":function(val){window.XrmAccess=true;window.XrmDataProperty=val},configurable:true,enumerable:false})}catch($$e_3){window.Xrm=window.XrmDataProperty;$v_1=false}window.XrmAccess=false}try{return Mscrm.CommandData.prototype.isControlEnabled.call(this,command)}catch($v_2){if(!$v_1||!window.XrmAccess)throw $v_2;else return false}finally{if($v_1){this.$4B_2=window.XrmAccess;window.XrmAccess=$v_0}}}};Type.registerNamespace("CUI");CUI.IRootBuildClient=function(){};CUI.IRootBuildClient.registerInterface("CUI.IRootBuildClient");CUI.CommandType=function(){};CUI.CommandType.prototype={general:1,tabSelection:2,optionSelection:3,menuCreation:4,preview:5,previewRevert:6,optionPreview:7,optionPreviewRevert:8,ignoredByMenu:9,menuClose:10,rootEvent:11};CUI.CommandType.registerEnum("CUI.CommandType",false);CUI.ISelectableControl=function(){};CUI.ISelectableControl.registerInterface("CUI.ISelectableControl");CUI.QueryRecord=function(){};CUI.DataQueryType=function(){};CUI.DataQueryType.prototype={none:0,all:1,ribbonVisibleTabDeep:2,ribbonShallow:3,ribbonTab:4,root:5};CUI.DataQueryType.registerEnum("CUI.DataQueryType",false);CUI.GalleryElementDimensions=function(){};CUI.GalleryElementDimensions.prototype={size16by16:1,size32by32:2,size48by48:3,size64by48:4,size72by96:5,size96by72:6,size96by96:7,size128by128:8,size190by30:9,size190by40:10,size190by50:11,size190by60:12};CUI.GalleryElementDimensions.registerEnum("CUI.GalleryElementDimensions",false);CUI.IMenuItem=function(){};CUI.IMenuItem.registerInterface("CUI.IMenuItem");CUI.ContextualColor=function(){};CUI.ContextualColor.prototype={none:0,darkBlue:1,lightBlue:2,teal:3,orange:4,green:5,magenta:6,yellow:7,purple:8};CUI.ContextualColor.registerEnum("CUI.ContextualColor",false);CUI.DeclarativeTemplateBuildContext=function(){};CUI.CommandInformation=function(){this.CommandId=null;this.RootId=null;this.TabId=null;this.RootType=null;this.RootLocation=null};CUI.IModalController=function(){};CUI.IModalController.registerInterface("CUI.IModalController");CUI.Direction=function(){};CUI.Direction.prototype={LTR:0,RTL:1};CUI.Direction.registerEnum("CUI.Direction",false);CUI.DisabledCommandInfoProperties=function(){this.Description=null;this.Title=null;this.Icon=null;this.IconClass=null;this.IconTop=null;this.IconLeft=null;this.HelpKeyWord=null};CUI.ImgContainerType=function(){};CUI.ImgContainerType.prototype={div:1,span:2,anchor:3};CUI.ImgContainerType.registerEnum("CUI.ImgContainerType",false);CUI.ImgContainerSize=function(){};CUI.ImgContainerSize.prototype={none:0,size5by3:1,size13by13:2,size16by16:3,size32by32:4,size48by48:5,size64by48:6,size72by96:7,size96by72:8,size96by96:9,size56by24:10,size2by16:11};CUI.ImgContainerSize.registerEnum("CUI.ImgContainerSize",false);CUI.PMarker=function(){};CUI.PMarker.prototype={beginSession:1,endSession:2,perfCUIRibbonInitStart:7103,perfCUIRibbonInitPercvdEnd:7104,perfCUIRibbonTabSwitchWarmStart:7105,perfCUIRibbonTabSwitchWarmPercvdEnd:7106,perfCUIRibbonTabSwitchWarmEnd:7107,perfCUIRibbonCompleteConstruction:7108,perfCUIRibbonQueryDataStart:7109,perfCUIRibbonQueryDataEnd:7110,perfWSSWikiUpdatePanelStart:7111,perfWSSWikiUpdatePanelEnd:7112,perfWSSWebPartComponentMouseClickStart:7186,perfWSSWebPartComponentMouseClickEnd:7187,perfCUIAddAndPositionBackFrameStart:7188,perfCUIAddAndPositionBackFrameEnd:7189,perfCUIFlyoutAnchorOnClickStart:7190,perfCUIFlyoutAnchorOnClickEnd:7191,perfCUIDropDownOnArrowButtonClickStart:7192,perfCUIDropDownOnArrowButtonClickEnd:7193,perfWSSBreadcrumbStart:7386,perfWSSBreadcrumbEnd:7387,perfWSSSelectOrDeselectAllStart:7388,perfWSSSelectOrDeselectAllEnd:7389,perfWSSSelectItemStart:7390,perfWSSSelectItemEnd:7391,perfWSSFilterSortStart:7392,perfWSSFilterSortEnd:7393,perfWSSMMUOpenStart:7394,perfWSSMMUOpenEnd:7395,perfWSSECBClickStart:7396,perfWSSECBClickEnd:7397,perfSPSSaveStatusNoteBegin:7634,perfSPSSaveStatusNoteEnd:7635,perfWSSCalendarRenderStart:7644,perfWSSCalendarRenderEnd:7645,perfPLTxInstrumentStart:7698,perfPLTxInstrumentEnd:7699,perfCUIRibbonButtonOnClickStart:7700,perfCUIRibbonButtonOnClickEnd:7701,perfCUIRibbonInsertTableOnClickStart:7702,perfCUIRibbonInsertTableOnClickEnd:7703,perfCUIRibbonToggleButtonOnClickStart:7704,perfCUIRibbonToggleButtonOnClickEnd:7705,perfWSSDialogShow:7706,perfWSSDialogClosed:7707,perfWSSRTEDialogOnLoadEnd:7708,perfWSSRTEDialogOnOkButtonClickStart:7709,perfWSSRTEAutoCompleteSetResultsStart:7710,perfWSSRTEAutoCompleteSetResultsEnd:7711,perfCUIRibbonEditWikiPageStart:7735,perfCUIRibbonEditWikiPageEnd:7736};CUI.PMarker.registerEnum("CUI.PMarker",false);CUI.BuildOptions=function(){};CUI.BuildOptions.prototype={lazyMenuInit:false,trimmedIds:null,attachToDOM:false,validateServerRendering:false,fixedPositioningEnabled:false,dataExtensions:null,clientID:null};CUI.BuildContext=function(){};CUI.DataNodeWrapper=function($p0){this.$a_0=$p0};CUI.DataNodeWrapper.getFirstChildNodeWithName=function($p0,$p1){for(var $v_0=CUI.DataNodeWrapper.getNodeChildren($p0),$v_1=$v_0.length,$v_2=null,$v_3=0;$v_3<$v_1;$v_3++){$v_2=$v_0[$v_3];var $v_4=$v_2.name;if($v_4===$p1)return $v_2}return null};CUI.DataNodeWrapper.getNodeName=function($p0){return $p0.name};CUI.DataNodeWrapper.getNodeChildren=function($p0){var $v_0=$p0.children;if(CUI.ScriptUtility.isNullOrUndefined($v_0))return CUI.DataNodeWrapper.get_$F9();return $v_0};CUI.DataNodeWrapper.get_$F9=function(){if(CUI.ScriptUtility.isNullOrUndefined(CUI.DataNodeWrapper.$7o))CUI.DataNodeWrapper.$7o=[];return CUI.DataNodeWrapper.$7o};CUI.DataNodeWrapper.getNodeAttributes=function($p0){return $p0.attrs};CUI.DataNodeWrapper.getNodeAttribute=function($p0,$p1){var $v_0=$p0.attrs;return $v_0[$p1]};CUI.DataNodeWrapper.prototype={$a_0:null,get_node:function(){return this.$a_0},set_node:function($p0){this.$a_0=$p0;return $p0},get_name:function(){return CUI.DataNodeWrapper.getNodeName(this.$a_0)},get_children:function(){return CUI.DataNodeWrapper.getNodeChildren(this.$a_0)},get_attributes:function(){return CUI.DataNodeWrapper.getNodeAttributes(this.$a_0)},get_hasChildren:function(){return CUI.DataNodeWrapper.getNodeChildren(this.$a_0).length>0}};CUI.Builder=function(options,elmPlaceholder,rootBuildClient){this.$$d_$F2_0=Function.createDelegate(this,this.$F2_0);this.$$d_$A2_0=Function.createDelegate(this,this.$A2_0);this.$z_0=options;if(CUI.ScriptUtility.isNullOrUndefined(this.$z_0.trimmedIds))this.$z_0.trimmedIds={};this._elmPlaceholder=elmPlaceholder;this.$1i_0=rootBuildClient;this.$2w_0=this.$$d_$A2_0;$addHandler(window,"unload",this.$2w_0)};CUI.Builder.$Be=function($p0){var $v_0=CUI.NativeUtility.createXMLDocFromString($p0);if(CUI.ScriptUtility.isNullOrUndefined($v_0))return null;return CUI.Builder.$Ek($v_0)};CUI.Builder.$Ek=function($p0){return eval("("+CUI.Builder.convertNodeToJSON($p0.documentElement)+")")};CUI.Builder.convertNodeToJSON=function(node){var $v_0;$v_0="{";$v_0+='"name" : "';$v_0+=CUI.NativeUtility.ecmaScriptStringLiteralEncode(node.nodeName);$v_0+='",';$v_0+='"attrs": {';var $v_1=node.attributes;if(!CUI.ScriptUtility.isNullOrUndefined(node.attributes)){var $v_3=$v_1.length;if($v_3>0)for(var $v_4=true,$v_5=0;$v_5<$v_3;$v_5++){var $v_6=$v_1.item($v_5);if($v_4)$v_4=false;else $v_0+=",";$v_0+='"';$v_0+=CUI.NativeUtility.ecmaScriptStringLiteralEncode($v_6.name);$v_0+='"';$v_0+=':"';$v_0+=CUI.NativeUtility.ecmaScriptStringLiteralEncode($v_6.value);$v_0+='"'}}$v_0+="}";var $v_2=node.childNodes;if($v_2){var $v_7=$v_2.length;if($v_7>0){$v_0+=",";$v_0+="children:[";for(var $v_8=true,$v_9=0;$v_9<$v_7;$v_9++){var $v_A=$v_2[$v_9];if($v_A.nodeName==="#text")continue;if($v_8)$v_8=false;else $v_0+=",";$v_0+=CUI.Builder.convertNodeToJSON($v_A)}$v_0+="]"}}$v_0+="}";return $v_0};CUI.Builder.applyDataNodeExtensions=function(data,extensions){var $v_0=data.attrs;if(CUI.ScriptUtility.isNullOrUndefined($v_0))return data;var $v_1=$v_0["Id"],$v_2=extensions[$v_1];if(!CUI.ScriptUtility.isNullOrUndefined($v_2)){for(var $v_9=null,$v_A=Number.MAX_VALUE,$v_B=$v_2.length,$v_C=0;$v_C<$v_B;$v_C++){var $v_D=$v_2[$v_C];if(!$v_D)return null;var $v_E=CUI.DataNodeWrapper.getNodeAttribute($v_D,"Sequence");if(CUI.ScriptUtility.isNullOrUndefined($v_E)){if(CUI.ScriptUtility.isNullOrUndefined($v_9))$v_9=$v_D;continue}var $v_F=parseInt($v_E);if($v_F<$v_A){$v_9=$v_D;$v_A=$v_F}}if(!CUI.ScriptUtility.isNullOrUndefined($v_9))data=$v_9}var $v_3=data["children"];if(CUI.ScriptUtility.isNullOrUndefined($v_3)){$v_3=[];data["children"]=$v_3}for(var $v_4=[],$v_5=$v_3.length,$v_G=0;$v_G<$v_5;$v_G++)Array.add($v_4,$v_3[$v_G]);var $v_6=extensions[$v_1+"._children"];if(!CUI.ScriptUtility.isNullOrUndefined($v_6)){for(var $v_H=$v_6.length,$v_I=0;$v_I<$v_H;$v_I++)Array.add($v_4,$v_6[$v_I]);$v_4.sort(CUI.Builder.$Ef)}for(var $v_7=[],$v_8=$v_4.length,$v_J=0;$v_J<$v_8;$v_J++){var $v_K=CUI.Builder.applyDataNodeExtensions($v_4[$v_J],extensions);!CUI.ScriptUtility.isNullOrUndefined($v_K)&&Array.add($v_7,$v_K)}data["children"]=$v_7;return data};CUI.Builder.$Ef=function($p0,$p1){var $v_0=CUI.DataNodeWrapper.getNodeAttribute($p0,"Sequence"),$v_1=CUI.DataNodeWrapper.getNodeAttribute($p1,"Sequence");if(CUI.ScriptUtility.isNullOrUndefined($v_1)&&CUI.ScriptUtility.isNullOrUndefined($v_0))return 0;if(CUI.ScriptUtility.isNullOrUndefined($v_1))return -1;if(CUI.ScriptUtility.isNullOrUndefined($v_0))return 1;var $v_2=parseInt($v_0),$v_3=parseInt($v_1);if($v_2<$v_3)return -1;else if($v_2>$v_3)return 1;return 0};CUI.Builder.prototype={$1i_0:null,$2w_0:null,$A2_0:function($p0){this.dispose()},$A3_0:function($p0){$p0.$3l_1=this.$z_0.fixedPositioningEnabled},dispose:function(){this.$0_0=null;this.$z_0=null;this._elmPlaceholder=null;this.$1i_0=null;this.$10_0=null;$removeHandler(window,"unload",this.$2w_0)},$0_0:null,get_root:function(){return this.$0_0},set_root:function(value){this.$0_0=value;return value},$3E_0:false,get_inQuery:function(){return this.$3E_0},set_inQuery:function(value){this.$3E_0=value;return value},$10_0:null,get_dataSource:function(){return this.$10_0},set_dataSource:function(value){this.$10_0=value;return value},_elmPlaceholder:null,get_placeholder:function(){return this._elmPlaceholder},$z_0:null,isIdTrimmed:function(id){return this.$z_0.trimmedIds[id]},isNodeTrimmed:function(dataNode){var $v_0=CUI.DataNodeWrapper.getNodeAttribute(dataNode,"Id");return this.$z_0.trimmedIds[$v_0]},$23_0:function($p0,$p1){var $v_0=null,$v_1=$p0.name;switch($v_1){case "ToggleButton":$v_0=this.$EX_0($p0,$p1);break;case "ComboBox":$v_0=this.$ED_0($p0,$p1);break;case "DropDown":$v_0=this.$EF_0($p0,$p1);break;case "Button":$v_0=this.$E9_0($p0,$p1);break;case "SplitButton":$v_0=this.$EU_0($p0,$p1);break;case "FlyoutAnchor":$v_0=this.$EG_0($p0,$p1);break;case "GalleryButton":$v_0=this.$BS_0($p0,$p1,null);break;case "InsertTable":$v_0=this.$EJ_0($p0,$p1);break;case "Label":$v_0=this.$EN_0($p0,$p1);break;case "MRUSplitButton":$v_0=this.$EP_0($p0,$p1);break;case "Spinner":$v_0=this.$ET_0($p0,$p1);break;case "TextBox":$v_0=this.$EW_0($p0,$p1);break;case "ColorPicker":$v_0=this.$EC_0($p0,$p1);break;case "CheckBox":$v_0=this.$EB_0($p0,$p1);break;case "Separator":$v_0=this.$ES_0($p0,$p1);break;default:var $v_2=$p0.attrs,$v_3=$v_2["Classname"];if(CUI.ScriptUtility.isNullOrUndefined($v_3))throw Error.create("Unable to create Control with tagname: "+$v_1);break}return $v_0},$44_0:function($p0,$p1,$p2){var $v_0=$p0.attrs,$v_1=this.$0_0.$Bk_1($v_0["Id"],$v_0["Title"],$v_0["Description"],$v_0["MaxWidth"]);if(this.$z_0.lazyMenuInit&&$p2){$v_1.$AJ_0(this.$$d_$F2_0,$p0,$p1);return $v_1}this.$Bz_0($v_1,$p0,$p1);return $v_1},$Bz_0:function($p0,$p1,$p2){for(var $v_0=CUI.DataNodeWrapper.getNodeChildren($p1),$v_1=$v_0.length,$v_2=null,$v_3=0;$v_3<$v_1;$v_3++){$v_2=$v_0[$v_3];var $v_4=$v_2.name;if($v_4!=="MenuSection")throw Error.create("Tags with the name: "+$v_4+" cannot be children of Menu tags.");if(this.isNodeTrimmed($v_2))continue;var $v_5=this.$EO_0($v_2,$p2);$p0.addChild($v_5)}},$F2_0:function($p0,$p1,$p2){var $v_0=$p0;this.$Bz_0($v_0,$p1,$p2);$v_0.$A1_0(true);return $v_0},$EO_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=$v_0["DisplayMode"];if(CUI.ScriptUtility.isNullOrUndefined($v_1))$v_1="Menu";var $v_2=this.$0_0.$Bl_1($v_0["Id"],$v_0["Title"],$v_0["Description"],$v_0["Scrollable"]==="true",$v_0["MaxHeight"],$v_1),$v_3=CUI.DataNodeWrapper.getNodeName(CUI.DataNodeWrapper.getNodeChildren($p0)[0]);if($v_3==="Controls")for(var $v_4=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getNodeChildren($p0)[0]),$v_5=$v_4.length,$v_6=null,$v_7=0;$v_7<$v_5;$v_7++){$v_6=$v_4[$v_7];if(this.isNodeTrimmed($v_6))continue;var $v_8=this.$23_0($v_6,$p1);$v_2.addChild($v_8.createComponentForDisplayMode($v_1))}else if($v_3==="Gallery"){var $v_9=this.$EH_0(CUI.DataNodeWrapper.getNodeChildren($p0)[0],$p1,true);$v_2.addChild($v_9)}return $v_2},$EH_0:function($p0,$p1,$p2){for(var $v_0=$p0.attrs,$v_1=$p0.attrs,$v_2=this.$0_0.$Er_1($v_1.Id,$v_0["Title"],$v_0["Description"],$v_1),$v_3=$p2?"Menu":"Default",$v_4=CUI.DataNodeWrapper.getNodeChildren($p0),$v_5=$v_4.length,$v_6=null,$v_7=0;$v_7<$v_5;$v_7++){$v_6=$v_4[$v_7];if(this.isNodeTrimmed($v_6))continue;var $v_8;switch(CUI.DataNodeWrapper.getNodeName($v_6)){case "GalleryButton":$v_8=this.$BS_0($v_6,$p1,$v_1.ElementDimensions);break;default:$v_8=this.$23_0($v_6,$p1);break}$v_2.addChild($v_8.createComponentForDisplayMode($v_3))}return $v_2},$BS_0:function($p0,$p1,$p2){var $v_0;if(CUI.ScriptUtility.isNullOrEmptyString($p2)){var $v_3=$p0.attrs;$p2=$v_3["ElementDimensions"]}if(CUI.ScriptUtility.isNullOrEmptyString($p2))$v_0=2;else $v_0=CUI.Gallery.$Bd($p2);var $v_1=$p0.attrs,$v_2=new CUI.Controls.GalleryButton(this.$0_0,$v_1.Id,$v_1,$v_0);return $v_2},$EX_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.ToggleButton(this.$0_0,$v_0.Id,$v_0);return $v_1},$EB_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.CheckBox(this.$0_0,$v_0.Id,$v_0);return $v_1},$EC_0:function($p0,$p1){for(var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Colors")),$v_2=new Array($v_1.length),$v_3=$v_1.length,$v_5=0;$v_5<$v_3;$v_5++){var $v_6=new CUI.Controls.ColorStyle,$v_7=CUI.DataNodeWrapper.getNodeAttributes($v_1[$v_5]),$v_8=$v_7["Title"];$v_6.Title=CUI.ScriptUtility.isNullOrUndefined($v_8)?$v_7["Alt"]:$v_8;$v_6.Color=$v_7["Color"];$v_6.DisplayColor=$v_7["DisplayColor"];$v_6.Style=$v_7["Style"];$v_2[$v_5]=$v_6}var $v_4=new CUI.Controls.ColorPicker(this.$0_0,$v_0.Id,$v_0,$v_2);return $v_4},$ED_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null,$v_3=$p0.attrs,$v_4=null;if(!CUI.Utility.$15($v_3.PopulateDynamically)){$v_2=this.$44_0($v_1[0],$p1,false);$v_4={};for(var $v_6=CUI.DataNodeWrapper.getNodeChildren($v_1[0]),$v_7=$v_6.length,$v_8=0;$v_8<$v_7;$v_8++)for(var $v_9=CUI.DataNodeWrapper.getNodeChildren($v_6[$v_8]),$v_A=CUI.DataNodeWrapper.getNodeChildren($v_9[0]),$v_B=$v_A.length,$v_C=0;$v_C<$v_B;$v_C++){var $v_D=$v_A[$v_C].attrs,$v_E=$v_D["LabelText"],$v_F=$v_D["MenuItemId"];$v_4[$v_E]=$v_F}}var $v_5=new CUI.Controls.ComboBox(this.$0_0,$v_0.Id,$v_0,$v_2);$v_5.set_menuItems($v_4);return $v_5},$EF_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null,$v_3=$p0.attrs;if(!CUI.Utility.$15($v_3.PopulateDynamically))$v_2=this.$44_0($v_1[0],$p1,false);var $v_4=new CUI.Controls.DropDown(this.$0_0,$v_0.Id,$v_0,$v_2);return $v_4},$E9_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.Button(this.$0_0,$v_0.Id,$v_0);return $v_1},$EU_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null;if(!CUI.Utility.$15($v_0.PopulateDynamically))$v_2=this.$44_0($v_1[0],$p1,true);var $v_3=new CUI.Controls.SplitButton(this.$0_0,$v_0.Id,$v_0,$v_2);return $v_3},$EG_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null,$v_3=$p0.attrs;if(!CUI.Utility.$15($v_3.PopulateDynamically))$v_2=this.$44_0($v_1[0],$p1,true);var $v_4=new CUI.Controls.FlyoutAnchor(this.$0_0,$v_0.Id,$v_0,$v_2);return $v_4},$EJ_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.InsertTable(this.$0_0,$v_0.Id,$v_0);return $v_1},$EN_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.Label(this.$0_0,$v_0.Id,$v_0);return $v_1},$EP_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null,$v_3=$p0.attrs;if(!CUI.Utility.$15($v_3.PopulateDynamically))$v_2=this.$44_0($v_1[0],$p1,false);var $v_4=new CUI.Controls.MRUSplitButton(this.$0_0,$v_0.Id,$v_0,$v_2);return $v_4},$ES_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.Separator(this.$0_0,$v_0.Id,$v_0);return $v_1},$ET_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.Spinner(this.$0_0,$v_0.Id,$v_0,this.$BU_0($p0));return $v_1},$EW_0:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.Controls.TextBox(this.$0_0,$v_0.Id,$v_0);return $v_1},$55_0:function($p0){if(typeof $p0==="string")return parseFloat($p0);return $p0},$Bc_0:function($p0){if(typeof $p0==="string")return parseInt($p0);return $p0},$BU_0:function($p0){for(var $v_0=CUI.DataNodeWrapper.getNodeChildren($p0),$v_1=new Array($v_0.length),$v_2=$v_0.length,$v_3=0;$v_3<$v_2;$v_3++){var $v_4=$v_0[$v_3],$v_5=CUI.DataNodeWrapper.getNodeAttributes($v_4);$v_1[$v_3]=CUI.Controls.Spinner.createUnit($v_5["Name"],this.$BT_0(CUI.DataNodeWrapper.getNodeChildren($v_4)),this.$55_0($v_5["MinimumValue"]),this.$55_0($v_5["MaximumValue"]),this.$Bc_0($v_5["DecimalDigits"]),this.$55_0($v_5["Interval"]))}return $v_1},$BT_0:function($p0){for(var $v_0=new Array($p0.length),$v_1=$p0.length,$v_2=0;$v_2<$v_1;$v_2++){var $v_3=$p0[$v_2],$v_4=CUI.DataNodeWrapper.getNodeAttributes($v_3);$v_0[$v_2]=$v_4["Value"]}return $v_0},applyDataExtensions:function(data){if(!CUI.ScriptUtility.isNullOrUndefined(this.$z_0.dataExtensions))return CUI.Builder.applyDataNodeExtensions(data,this.$z_0.dataExtensions);else return data}};CUI.CommandEventArgs=function($p0,$p1,$p2,$p3){CUI.CommandEventArgs.initializeBase(this);this.$4_1=$p0;this.$3s_1=$p3;this.$3y_1=$p2;this.$I_1=$p1};CUI.CommandEventArgs.prototype={$4_1:null,$95_1:0,$3s_1:null,$3y_1:null,$I_1:0,$7z_1:null,get_id:function(){return this.$4_1},get_parameters:function(){return this.$3s_1},get_sequenceNumber:function(){return this.$95_1},set_sequenceNumber:function($p0){this.$95_1=$p0;return $p0},get_source:function(){return this.$3y_1},get_sourceControl:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$3y_1)&&CUI.ControlComponent.isInstanceOfType(this.$3y_1))return this.$3y_1.$R_1;return null},get_type:function(){return this.$I_1},get_properties:function(){return this.$3s_1},get_commandInfo:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$7z_1))this.$7z_1=new CUI.CommandInformation;return this.$7z_1}};CUI.Component=function(root,id,title,description){this._componentWidth=-1;this._componentHeight=-1;this._componentTopPosition=-1;this._componentLeftPosition=-1;this.$4_0=id;this.$0_0=root;this.$1k_0=title;this.$87_0=description;this.createChildArray()};CUI.Component.prototype={$4_0:null,$3i_0:null,$P_0:null,$0_0:null,$6_0:null,$l_0:true,$7Q_0:true,$1f_0:true,$6l_0:false,$87_0:null,$1k_0:null,createChildArray:function(){this.$9U_0()},$9U_0:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$6_0))this.$6_0=new CUI.List},get_id:function(){return this.$4_0},set_id:function(value){this.$4_0=value;return value},get_$2_0:function(){return this.$3i_0},set_$2_0:function($p0){this.$3i_0=$p0;return $p0},get_root:function(){return this.$0_0},get_parent:function(){return this.$P_0},set_parent:function(value){this.$P_0=value;return value},$1D_0:function(){},$7U_0:function(){return false},$7T_0:function(){return false},$9d_0:function(){},$9f_0:function(){},$9e_0:function($p0){return false},$CB_0:function($p0){var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();if($v_0.$4_0===$p0)return $v_0}return null},getChild:function(id){return this.$CB_0(id)},getChildByTitle:function(title){var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();if($v_0.get_title()===title)return $v_0}return null},addChild:function(child){this.$42_0(child,true)},$42_0:function($p0,$p1){this.$BH_0($p0,-1,$p1)},addChildAtIndex:function(child,index){this.$BH_0(child,index,true)},$BH_0:function($p0,$p1,$p2){$p2&&this.ensureCorrectChildType($p0);if(!CUI.ScriptUtility.isNullOrUndefined($p0.$P_0))throw Error.create("This child cannot be added because it has already been added \n to another Component in the hierarchy.  \n You must first call child.Parent.RemoveChild(child)");if($p1===-1)this.$6_0.add($p0);else this.$6_0.insert($p1,$p0);$p0.$P_0=this;this.$16_0()},removeChild:function(id){var $v_0=this.$CB_0(id);if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("The child with id: "+id+" is not as child of this Component");this.$6_0.remove($v_0);$v_0.$P_0=null;this.$16_0()},removeChildren:function(){var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();if($v_0)$v_0.$P_0=null}this.$6_0.clear();this.$16_0()},ensureCorrectChildType:function(child){return},initRootMember:function(root){if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0))throw Error.create("Root member has already been set for this Component.");this.$0_0=root},get_visible:function(){return this.$7Q_0},set_visible:function(value){this.set_$7u_0(value);return value},get_$7u_0:function(){return this.get_visible()},set_$7u_0:function($p0){var $v_0=this.$7Q_0;this.$7Q_0=$p0;$v_0!==this.$7Q_0&&this.$16_0();return $p0},get_enabled:function(){return this.$1f_0},set_enabled:function(value){if(this.$1f_0===value&&this.$6l_0)return value;if(!CUI.ScriptUtility.isNullOrUndefined(this.$P_0)&&!this.$P_0.get_enabled()&&value)throw Error.create("This Component with id: "+this.$4_0+" cannot be Enabled because its parent is Disabled");this.$1f_0=value;this.$6l_0=true;var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();$v_0.set_enabled(value)}this.onEnabledChanged(value);return value},onEnabledChanged:function(enabled){},$I1_0:function($p0){var $v_0=this.$1f_0!==$p0;this.$1f_0=$p0;if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0)){var $$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();$v_1.$I1_0($p0)}}$v_0&&this.onEnabledChanged($p0)},get_title:function(){return this.$1k_0},set_title:function(value){this.$1k_0=value;this.$16_0();return value},get_description:function(){return this.$87_0},set_description:function(value){this.$87_0=value;this.$16_0();return value},_lastWidthUpdate:0,_lastHeightUpdate:0,get_$Eh_0:function(){return this._componentHeight},_lastTopUpdate:0,get_$Ba_0:function(){return this._componentTopPosition},_lastLeftUpdate:0,valueIsDirty:function(lastUpdate){if(CUI.Ribbon.isInstanceOfType(this.$0_0)){var $v_0=this.$0_0;return lastUpdate<$v_0.get_$Gi_2()}return false},$AK_0:function($p0){this.$l_0=$p0;if(CUI.ScriptUtility.isNullOrUndefined(this.$6_0))return;var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();$v_0.$AK_0($p0)}},$16_0:function(){if(this.$l_0||this.$5k_0)return;this.$l_0=true;!CUI.ScriptUtility.isNullOrUndefined(this.$P_0)&&this.$P_0.$16_0()},$5k_0:false,$26_0:function(){this.$l_0=false},$30_0:function(){this.$l_0&&this.$26_0()},$50_0:function($p0){this.$7R_0();this.$W_0();this.$l_0=false;if($p0)if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0)){var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();$v_0.$50_0($p0)}}},$7R_0:function(){var $v_0=$get(this.$4_0);if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.set_$2_0($v_0);else throw Error.create("Attempting to attach to Id: "+this.$4_0+" but this id is not present in the DOM")},$W_0:function(){},$24_0:function(){if(!this.$3i_0){this.$3i_0=CUI.Utility.$3(this.get_domElementTagName());this.$3i_0.className=this.get_cssClass();this.$3i_0.id=this.$4_0}},get_domElementTagName:function(){return "span"},get_cssClass:function(){return ""},get_visibleInDOM:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$P_0))return false;return this.$P_0.get_visibleInDOM()},$AO_0:function(){if(!this.get_visible())return false;var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();if($v_0.$AO_0())return true}return false},ensureDOMElementAndEmpty:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this.$24_0();else this.set_$2_0(CUI.Utility.removeChildNodes(this.get_$2_0()))},appendChildrenToElement:function(elm){var $v_0=document.createDocumentFragment(),$$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();$v_1.$24_0();$v_0.appendChild($v_1.get_$2_0());$v_1.$30_0()}elm.appendChild($v_0)},raiseCommandEvent:function(commandId,type,properties){var $v_0=this.$0_0.$Eo_1(commandId,type,this,properties);this.$D8_0($v_0)},$D8_0:function($p0){this.$3W_0($p0)&&!CUI.ScriptUtility.isNullOrUndefined(this.$P_0)&&this.$P_0.$D8_0($p0);this.$Cw_0($p0)},$3W_0:function($p0){return true},$Cw_0:function($p0){},getTextValue:function(){return null},receiveFocus:function(){},onMenuClosed:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$6_0))return;var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.onMenuClosed()}},$4Q_0:null,$6a_0:null,$6b_0:null,$AJ_0:function($p0,$p1,$p2){this.$4Q_0=$p0;this.$6a_0=$p1;this.$6b_0=$p2},$86_0:false,doDelayedInit:function(){if(this.$86_0)return;if(CUI.ScriptUtility.isNullOrUndefined(this.$4Q_0))throw Error.create("No delayedinit handler present in this component: "+this.$4_0);this.$86_0=true;this.$4Q_0(this,this.$6a_0,this.$6b_0)},$A1_0:function($p0){if($p0){this.$4Q_0=null;this.$6a_0=null;this.$6b_0=null;this.$16_0()}this.$86_0=false},get_needsDelayIniting:function(){return !CUI.ScriptUtility.isNullOrUndefined(this.$4Q_0)},$5D_0:function(){var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.$5D_0()}},$5q_0:null,get_$5A_0:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$5q_0)){this.$5q_0=new Date;this.$5q_0.setTime(0)}return this.$5q_0},set_$5A_0:function($p0){this.$5q_0=$p0;return $p0},get_$DG_0:function(){return this.get_$5A_0().getTime()<this.$0_0.get_$5A_0().getTime()},$D3_0:function(){this.get_$DG_0()&&this.$5D_0()},dispose:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$6_0)){var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.dispose()}this.$6_0=null}this.$P_0=null;this.$0_0=null;this.$6a_0=null;this.$4Q_0=null;this.$6b_0=null;this.$3i_0=null}};CUI.ContextMenu=function($p0,$p1,$p2,$p3,$p4){CUI.ContextMenu.initializeBase(this,[$p0,$p1,$p2,$p3,$p4])};CUI.ContextMenu.prototype={$26_0:function(){this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$U_1)){this.$U_1=CUI.Utility.$3("div");this.$U_1.className="ms-cui-contextmenu-inner"}this.get_$2_0().appendChild(this.$U_1);this.appendChildrenToElement(this.$U_1);CUI.Menu.prototype.$26_0.call(this)},get_cssClass:function(){return "ms-cui-contextmenu"}};CUI.ContextMenuDock=function($p0,$p1){CUI.ContextMenuDock.initializeBase(this,[$p0,$p1,"",""])};CUI.ContextMenuDock.prototype={$26_0:function(){this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},ensureCorrectChildType:function($p0){if(!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Only children of type Control can be added to Strips.")},get_visibleInDOM:function(){return true}};CUI.ContextMenuLauncher=function($p0,$p1,$p2,$p3){CUI.ContextMenuLauncher.initializeBase(this,[$p0,$p1,$p2,$p3])};CUI.ContextMenuLauncher.prototype={$6v_2:null,$9D_2:null,$BF_2:0,$BG_2:0,$Cc_2:function($p0,$p1){this.$9D_2=$p1;this.$6v_2=this.getMenuPosition($p0,null);this.launchMenu(null);this.$C_1.$9d_0();return true},launchContextMenuAt:function($p0,$p1,$p2){this.$BF_2=$p1;this.$BG_2=$p2;this.$9D_2=$p0;this.launchMenu(null);this.$C_1.$9d_0();return true},positionMenu:function($p0,$p1){if(this.$6v_2){this.$C_1.get_$2_0().style.top=this.$6v_2.y+"px";this.$C_1.get_$2_0().style.left=this.$6v_2.x+"px";this.$C_1.get_$2_0().style.position="absolute"}else{$p0.style.top="0px";$p0.style.left="0px";var $v_0=this.getAllElementDimensions($p0,this.$9D_2);$v_0["launcherLeft"]=this.$BF_2;$v_0["launcherTop"]=this.$BG_2;$v_0["launcherWidth"]=0;$v_0["launcherHeight"]=0;this.$0_0.$AL_1($p0,$v_0,false)}},getMenuPosition:function($p0,$p1){var $v_0=new Sys.UI.Bounds(0,0,0,0);if(!$p0)$p0=window.event;$v_0.y=$p0.clientY;$v_0.x=$p0.clientX;return $v_0}};CUI.ContextMenuRootProperties=function(){CUI.ContextMenuRootProperties.initializeBase(this)};CUI.ContextMenuRootProperties.prototype={CommandMenuOpen:null,CommandMenuClose:null};CUI.ContextMenuRoot=function(id,properties){this.$6V_2={};CUI.ContextMenuRoot.initializeBase(this,[id,properties])};CUI.ContextMenuRoot.prototype={refresh:function(){this.$26_0();CUI.Root.prototype.$26_0.call(this)},$26_0:function(){CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&this.$24_0();this.set_$2_0(CUI.Utility.removeChildNodes(this.get_$2_0()));this.appendChildrenToElement(this.get_$2_0());this.$l_0=false},get_rootType:function(){return "ContextMenu"},get_$1I_1:function(){if(!CUI.Root.prototype.get_$1I_1.call(this)){var $v_0=new CUI.BuildOptions;$v_0.lazyMenuInit=false;CUI.Root.prototype.set_$1I_1.call(this,new CUI.Builder($v_0,null,null));CUI.Root.prototype.get_$1I_1.call(this).$0_0=this}return CUI.Root.prototype.get_$1I_1.call(this)},set_$1I_1:function($p0){CUI.Root.prototype.set_$1I_1.call(this,$p0);return $p0},get_contextMenuRootProperties:function(){return this.$5_1},ensureCorrectChildType:function(child){if(!CUI.ContextMenuDock.isInstanceOfType(child))throw Error.create("Only children of type ContextMenuDock can be added to a ContextMenuRoot")},createContextMenu:function(props,id,title,description,maxWidth){var $v_0=new CUI.ContextMenu(this,id,title,description,null);if(!props)props=new CUI.Controls.ContextMenuControlProperties;props.CommandMenuOpen=this.get_contextMenuRootProperties().CommandMenuOpen;props.CommandMenuClose=this.get_contextMenuRootProperties().CommandMenuClose;var $v_1=new CUI.Controls.ContextMenuControl(this,id+"Launcher",props,$v_0);this.$6V_2[id]=$v_1;var $v_2=new CUI.ContextMenuDock(this,"dock"+id);$v_2.addChild($v_1.createComponentForDisplayMode("Menu"));this.addChild($v_2);this.refresh()},showContextMenu:function(id,triggeringEvent,focusedElement){var $v_0=this.$6V_2[id];if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create('The context menu "'+id+'" does not exist');$v_0.$Cc_2(triggeringEvent,focusedElement)},showContextMenuAt:function(id,elmHadFocus,x,y){var $v_0=this.$6V_2[id];if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create('The context menu "'+id+'" does not exist');$v_0.launchContextMenuAt(elmHadFocus,x,y)}};CUI.ControlProperties=function(){};CUI.ControlProperties.prototype={Command:null,Id:null,TemplateAlias:null,ToolTipDescription:null,ToolTipHelpKeyWord:null,ToolTipImage32by32:null,ToolTipImage32by32Class:null,ToolTipImage32by32Top:null,ToolTipImage32by32Left:null,ToolTipSelectedItemTitle:null,ToolTipShortcutKey:null,ToolTipTitle:null,LabelCss:null};CUI.Control=function($p0,$p1,$p2){this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_onHelpKeyPress=Function.createDelegate(this,this.onHelpKeyPress);this.$$d_$d_0=Function.createDelegate(this,this.$d_0);this.$$d_launchToolTip=Function.createDelegate(this,this.launchToolTip);this.$0_0=$p0;this.$4_0=$p1;this.$5_0=$p2;this.$q_0=[];this.$5O_0=",";this.$3c_0={};$p0.$Hn_1(this)};CUI.Control.createStandardControlDOMElement=function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0=$p3;return CUI.Control.createStandardControlDOMElementCore($p0,$p1,$p2,$v_0.Id,$v_0.Image32by32,$v_0.Image32by32Class,$v_0.Image32by32Top,$v_0.Image32by32Left,$v_0.Image16by16,$v_0.Image16by16Class,$v_0.Image16by16Top,$v_0.Image16by16Left,$v_0.LabelText,$v_0.LabelCss,$v_0.Alt,$v_0.Description,$v_0.ToolTipTitle,$p4,$p5)};CUI.Control.createStandardControlDOMElementCore=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8,$p9,$p10,$p11,$p12,$p13,$p14,$p15,$p16,$p17,$p18){if(CUI.ScriptUtility.isNullOrUndefined($p12))$p12="";var $v_0=false,$v_1=true,$v_2=CUI.Utility.$65(),$v_3=null;if($p2==="Large")$v_3="ms-cui-ctl-large";else if($p2==="Medium")$v_3="ms-cui-ctl-medium";else if($p2==="Menu16"||$p2==="Menu"){$v_3="ms-cui-ctl-menu";$v_0=true}else if($p2==="Menu32"){$v_3="ms-cui-ctl-menu ms-cui-ctl-menu32";$v_0=true}else $v_3="ms-cui-ctl";CUI.Utility.ensureCSSClassOnElement($v_2,$v_3);$p2==="Menu"&&CUI.Utility.ensureCSSClassOnElement($v_2,"ms-cui-textmenuitem");!CUI.ScriptUtility.isNullOrUndefined($p16)&&$v_2.setAttribute("aria-describedby",$p3+"_ToolTip");$v_2.setAttribute("mscui:controltype",$p0.get_$Bb_0());var $v_4=CUI.Utility.$3("img"),$v_5=null,$v_6=null,$v_7=null,$v_8=null,$v_9=0;$v_4.alt="";$p14=CUI.ScriptUtility.isNullOrEmptyString($p14)?$p12:$p14;$v_2.setAttribute("role",$p0.get_$43_0());CUI.Controls.FlyoutAnchor.isInstanceOfType($p0)&&$v_2.setAttribute("aria-haspopup","true");if(CUI.ScriptUtility.isNullOrEmptyString($p16)){$v_2.title=$p14;$v_4.alt=$p14;$v_1=false}if($p2==="Large"||$p2==="Menu32"){$v_5=$p4;$v_6=$p5;$v_7=$p6;$v_8=$p7;$v_9=4}else{$v_5=$p8;$v_6=$p9;$v_7=$p10;$v_8=$p11;$v_9=3}var $v_A=CUI.Utility.$p(2,$v_9,$v_5,$v_6,$v_4,true,false,$v_7,$v_8),$v_B=CUI.Utility.$3("span");$v_B.className=$p2==="Large"?"ms-cui-ctl-largeIconContainer":"ms-cui-ctl-iconContainer";$v_B.appendChild($v_A);var $v_C=null,$v_D=null;if($v_1)$v_D=CUI.Utility.$3U($p14);if($p2!=="Small"||$p18){$v_C=CUI.Utility.$3("span");if($p2!=="Small"){if($p2==="Large"){CUI.Utility.ensureCSSClassOnElement($v_C,"ms-cui-ctl-largelabel");$v_C.innerHTML=CUI.Utility.$C3($p12,$p18)}else{var $v_I=$p12;if($p18)$v_I=$v_I+" ";CUI.Utility.ensureCSSClassOnElement($v_C,"ms-cui-ctl-mediumlabel");CUI.UIUtility.setInnerText($v_C,$v_I)}if(!CUI.ScriptUtility.isNullOrEmptyString($p13))$v_C.style.cssText=$p13}else{CUI.Utility.ensureCSSClassOnElement($v_C,"ms-cui-ctl-smalllabel");CUI.UIUtility.setInnerText($v_C," ")}}else if($v_1)$v_C=CUI.Utility.$3U($p14);var $v_E=null;if($p18){var $v_J=CUI.Utility.$3("img");$v_J.alt="";if(CUI.ScriptUtility.isNullOrEmptyString($p16))$v_J.alt=$p14;$v_E=CUI.Utility.$p(2,1,$p1.$5_1.ImageDownArrow,$p1.$5_1.ImageDownArrowClass,$v_J,true,false,$p1.$5_1.ImageDownArrowTop,$p1.$5_1.ImageDownArrowLeft)}var $v_F=null,$v_G=null,$v_H=null;if($p2==="Menu32"){$v_F=CUI.Utility.$3("span");$v_F.className="ms-cui-ctl-menulabel";CUI.Utility.ensureCSSClassOnElement($v_C,"ms-cui-btn-title");$v_F.appendChild($v_C);if(!CUI.ScriptUtility.isNullOrUndefined($p15)){$v_G=CUI.Utility.$3("span");CUI.Utility.ensureCSSClassOnElement($v_G,"ms-cui-btn-menu-description");CUI.Utility.$3Y($v_G,$p15);$v_G.style.display="block";$v_F.appendChild($v_G)}$v_H=CUI.Utility.$3("span");$v_H.className="ms-cui-ctl-menu32clear";$v_H.innerHTML="&nbsp;"}$v_2.appendChild($v_B);if(!CUI.ScriptUtility.isNullOrUndefined($v_C)){if(!CUI.ScriptUtility.isNullOrUndefined($v_F)){$v_2.appendChild($v_F);$v_2.appendChild($v_H)}else{$v_2.appendChild($v_C);$p2==="Small"&&$p18&&$v_1&&$v_2.appendChild($v_D)}!CUI.ScriptUtility.isNullOrUndefined($v_E)&&$v_C.appendChild($v_E)}if($v_0){var $v_K=CUI.Utility.$Bh();$v_2.appendChild($v_K)}return $v_2};CUI.Control.createTwoAnchorControlDOMElementCore=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8,$p9,$p10,$p11,$p12,$p13,$p14,$p15){var $v_0=true;if(CUI.ScriptUtility.isNullOrUndefined($p12))$p12="";var $v_1=CUI.Utility.$3("span");if($p2==="Large")$v_1.className="ms-cui-ctl-large";else if($p2==="Medium")$v_1.className="ms-cui-ctl ms-cui-ctl-medium";else $v_1.className="ms-cui-ctl ms-cui-ctl-small";!CUI.ScriptUtility.isNullOrUndefined($p14)&&$v_1.setAttribute("aria-describedby",$p3+"_ToolTip");$v_1.setAttribute("mscui:controltype",$p0.get_$Bb_0());var $v_2=CUI.Utility.$65(),$v_3=CUI.Utility.$65();$v_2.className="ms-cui-ctl-a1";$v_3.className="ms-cui-ctl-a2";$p13=CUI.ScriptUtility.isNullOrEmptyString($p13)?$p12:$p13;$v_2.setAttribute("role",$p0.get_$43_0());$v_3.setAttribute("role",$p0.get_$43_0());$v_3.setAttribute("aria-haspopup","true");var $v_4=CUI.Utility.$3("span");$v_4.className="ms-cui-ctl-a1Internal";var $v_5=CUI.Utility.$3("img"),$v_6=null,$v_7=null,$v_8=null,$v_9=null,$v_A=0;$v_5.alt="";if(CUI.ScriptUtility.isNullOrEmptyString($p14)){$v_2.title=$p13;$v_3.title=$p13;$v_5.alt=$p13;$v_0=false}if($p2==="Large"||$p2==="Menu32"){$v_6=$p4;$v_7=$p5;$v_8=$p6;$v_9=$p7;$v_A=4}else{$v_6=$p8;$v_7=$p9;$v_8=$p10;$v_9=$p11;$v_A=3}var $v_B=CUI.Utility.$p(2,$v_A,$v_6,$v_7,$v_5,true,false,$v_8,$v_9),$v_C=null,$v_D=null;if($v_0){$v_C=CUI.Utility.$3U($p13);$v_D=CUI.Utility.$3U($p13)}var $v_E=null;if($p2!=="Small"||$p15){$v_E=CUI.Utility.$3("span");if($p2!=="Small")if($p2==="Large"){CUI.Utility.ensureCSSClassOnElement($v_E,"ms-cui-ctl-largelabel");$v_E.innerHTML=CUI.Utility.$C3($p12,$p15)}else if($p2==="Medium"){CUI.Utility.ensureCSSClassOnElement($v_E,"ms-cui-ctl-mediumlabel");CUI.UIUtility.setInnerText($v_E,$p12)}}var $v_F=null;if($p15){var $v_G=CUI.Utility.$3("img");if(CUI.ScriptUtility.isNullOrEmptyString($p14))$v_G.alt=$p13;$v_F=CUI.Utility.$p(2,1,$p1.$5_1.ImageDownArrow,$p1.$5_1.ImageDownArrowClass,$v_G,true,false,$p1.$5_1.ImageDownArrowTop,$p1.$5_1.ImageDownArrowLeft)}$v_1.appendChild($v_2);$v_1.appendChild($v_3);$v_2.appendChild($v_4);$v_4.appendChild($v_B);if(!CUI.ScriptUtility.isNullOrUndefined($v_E)){if($p2==="Large"){$v_3.appendChild($v_E);$v_0&&$v_2.appendChild($v_C)}else{$v_4.appendChild($v_E);$v_0&&$v_3.appendChild($v_D)}$p2==="Small"&&$v_0&&$v_2.appendChild($v_C)}if(!CUI.ScriptUtility.isNullOrUndefined($v_F))if($p2==="Large")$v_E.appendChild($v_F);else $v_3.appendChild($v_F);return $v_1};CUI.Control.prototype={$0_0:null,$4_0:null,$q_0:null,$5_0:null,$5O_0:null,$3c_0:null,$1l_0:null,$7L_0:false,$9F_0:null,$9E_0:null,$1f_0:false,$6l_0:false,get_controlProperties:function(){return this.$5_0},$9A_0:null,get_stateProperties:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$9A_0))this.$9A_0={};return this.$9A_0},$80_0:null,get_commandProperties:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$80_0))this.$80_0={};return this.$80_0},get_templateAlias:function(){return this.$5_0.TemplateAlias},get_$Bb_0:function(){return "Control"},get_$43_0:function(){return "button"},ensureValidDisplayMode:function($p0){if(this.$5O_0.indexOf(","+$p0+",")!==-1)return;throw Error.create("The display mode with name: "+$p0+" is not valid for this control with id: "+this.$4_0)},refreshDOMElements:function(){this.onStateChanged();!this.get_enabled()&&this.onEnabledChanged(false)},onStateChanged:function(){},$85_0:null,getDOMElementForDisplayMode:function($p0){this.ensureValidDisplayMode($p0);var $v_0=this.$3c_0[$p0];if(!CUI.ScriptUtility.isNullOrUndefined($v_0))return $v_0;this.$85_0=$p0;$v_0=this.createDOMElementForDisplayMode($p0);this.$85_0=null;if(CUI.ScriptUtility.isNullOrEmptyString($v_0.id))$v_0.id=this.$4_0+"-"+$p0;this.storeElementForDisplayMode($v_0,$p0);this.refreshDOMElements();return $v_0},storeElementForDisplayMode:function($p0,$p1){this.$3c_0[$p1]=$p0},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);!CUI.ScriptUtility.isNullOrUndefined($v_0)&&this.storeElementForDisplayMode($v_0,$p0)},$E6_0:function($p0){},createComponentForDisplayMode:function($p0){var $v_0=this.createComponentForDisplayModeInternal($p0);Array.add(this.$q_0,$v_0);return $v_0},get_components:function(){return this.$q_0},createComponentForDisplayModeInternal:function($p0){var $v_0=this.$0_0.$Eq_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);return $v_0},dispose:function(){this.releaseEventHandlers();this.$0_0=null;this.$q_0=null;this.$5O_0=null;this.$5_0=null;var $$dict_0=this.$3c_0;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]};delete this.$3c_0[$v_0.key]}this.$3c_0=null;!CUI.ScriptUtility.isNullOrUndefined(this.$1l_0)&&this.$1l_0.dispose()},releaseEventHandlers:function(){var $$dict_0=this.$3c_0;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]};CUI.Utility.$AA($v_0.value)}},get_id:function(){return this.$4_0},get_root:function(){return this.$0_0},addDisplayMode:function($p0){if(this.$5O_0.indexOf(","+$p0+",")!==-1)return;this.$5O_0+=$p0+","},ensureCorrectChildType:function($p0){if(!CUI.ToolTip.isInstanceOfType($p0))throw Error.create("Child Components may not be added to this type of ControlComponent.")},get_displayedComponent:function(){for(var $v_0=this.$q_0.length,$v_1=0;$v_1<$v_0;$v_1++){var $v_2=this.$q_0[$v_1];if($v_2.get_visibleInDOM())return $v_2}return null},$3W_0:function($p0){return true},$Cw_0:function($p0){},onMenuClosed:function(){},onClick:function($p0){$p0.preventDefault()},onDblClick:function($p0){$p0.preventDefault();if(!this.get_enabled())return;Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.onClick($p0)},onBeginFocus:function(){window.clearInterval(this.$0_0.$3P_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$41_1))if(this.$0_0.$41_1.$4_0===this.$4_0){this.launchToolTip();return}else{this.$0_0.$3R_1();this.$0_0.$3P_1=window.setTimeout(this.$$d_launchToolTip,500)}else this.$0_0.$3P_1=window.setTimeout(this.$$d_launchToolTip,500)},onEndFocus:function(){window.clearInterval(this.$0_0.$3P_1);if(this.$7L_0)this.$0_0.$3P_1=window.setTimeout(this.$$d_$d_0,100)},onToolTipOpenned:function(){this.$9F_0=this.$$d_onHelpKeyPress;this.$9E_0=this.$1l_0.$$d_$Gr_1;$addHandler(document,"keydown",this.$9F_0);$addHandler(document,"click",this.$9E_0)},onToolTipClosed:function(){$removeHandler(document,"keydown",this.$9F_0);$removeHandler(document,"click",this.$9E_0)},onHelpKeyPress:function($p0){!CUI.ScriptUtility.isNullOrUndefined(this.$1l_0)&&this.$1l_0.$Cs_1($p0)},launchToolTip:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$0_0))return;window.clearInterval(this.$0_0.$3P_1);if(this.$7L_0)return;!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$41_1)&&this.$0_0.$41_1.$4_0!==this.$4_0&&this.$0_0.$3R_1();if(CUI.ScriptUtility.isNullOrUndefined(this.$5_0.ToolTipTitle))return;this.$1l_0=new CUI.ToolTip(this.$0_0,this.$4_0+"_ToolTip",this.$5_0.ToolTipTitle,this.$5_0.ToolTipDescription,this.$5_0);if(!this.get_enabled()){var $v_1=new CUI.DisabledCommandInfoProperties;$v_1.Icon=this.$0_0.$5_1.ToolTipDisabledCommandImage16by16;$v_1.IconClass=this.$0_0.$5_1.ToolTipDisabledCommandImage16by16Class;$v_1.IconTop=this.$0_0.$5_1.ToolTipDisabledCommandImage16by16Top;$v_1.IconLeft=this.$0_0.$5_1.ToolTipDisabledCommandImage16by16Left;$v_1.Title=this.$0_0.$5_1.ToolTipDisabledCommandTitle;$v_1.Description=this.$0_0.$5_1.ToolTipDisabledCommandDescription;$v_1.HelpKeyWord=this.$0_0.$5_1.ToolTipDisabledCommandHelpKey;this.$1l_0.$1L_1=$v_1}var $v_0=this.get_displayedComponent();$v_0.$9U_0();$v_0.addChild(this.$1l_0);this.$1l_0.$F6_1();this.$7L_0=true;this.$0_0.$41_1=this;this.onToolTipOpenned()},$d_0:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$0_0)&&window.clearInterval(this.$0_0.$3P_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.$1l_0)){this.$1l_0.$CS_1();this.$7L_0=false;this.onToolTipClosed();CUI.UIUtility.removeNode(this.$1l_0.get_$2_0());this.$1l_0=null}},get_enabled:function(){return this.$1f_0},set_enabled:function($p0){if(this.$1f_0===$p0&&this.$6l_0)return $p0;this.$1f_0=$p0;this.$6l_0=true;this.onEnabledChanged($p0);return $p0},get_enabledInternal:function(){return this.$1f_0},set_enabledInternal:function($p0){this.$1f_0=$p0;return $p0},$I0_0:function($p0){this.$1f_0=$p0;this.onEnabledChanged($p0)},$HT_0:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$5_0.Command)&&this.pollForStateAndUpdateInternal(this.$5_0.Command,null,null,false)},pollForStateAndUpdateInternal:function($p0,$p1,$p2,$p3){var $v_0=(this.$0_0.$D2_1($p0,$p1,$p2,$p3)&1)>0;this.set_enabled($v_0);return $v_0},getTextValue:function(){return ""},receiveFocus:function(){},$7T_0:function(){return this.$C5_0()},$7U_0:function(){return this.$C5_0()},$C5_0:function(){var $v_0=this.get_displayedComponent();if(!CUI.MenuItem.isInstanceOfType($v_0))return false;if(!$v_0.get_$1Q_2()){this.receiveFocus();return true}return false},$Ed_0:function(){},$7W_0:function(){var $v_0=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return null;return $v_0.get_$2_0()},$AN_0:function(){return false}};CUI.ControlComponent=function($p0,$p1,$p2,$p3){CUI.ControlComponent.initializeBase(this,[$p0,$p1,$p2,""]);this.$R_1=$p3};CUI.ControlComponent.prototype={$R_1:null,get_displayMode:function(){return this.get_title()},createChildArray:function(){},$26_0:function(){this.$l_0=false},$7R_0:function(){this.$R_1.$E5_0(this.get_displayMode())},$W_0:function(){this.$R_1.$E6_0(this.get_displayMode())},get_$2_0:function(){return this.$R_1.getDOMElementForDisplayMode(this.get_title())},set_$2_0:function($p0){throw Error.create("Cannot set the DOM Element of ControlComponents.  They get their DOM Elements from the Control.");return $p0},get_componentElement:function(){return CUI.Component.prototype.get_$2_0.call(this)},get_enabled:function(){return this.$R_1.get_enabled()},set_enabled:function($p0){this.$R_1.set_enabled($p0);return $p0},get_$Eh_0:function(){if((this._componentHeight===-1||this.valueIsDirty(this._lastHeightUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentHeight=this.get_$2_0().offsetHeight;return this._componentHeight},get_$Ba_0:function(){if((this._componentTopPosition===-1||this.valueIsDirty(this._lastTopUpdate))&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$2_0());return this._componentTopPosition},$I1_0:function($p0){this.$R_1.$I0_0($p0)},$64_1:function($p0){return this.$R_1.createComponentForDisplayMode(this.get_displayMode())},onEnabledChanged:function($p0){this.$R_1.onEnabledChanged($p0)},ensureCorrectChildType:function($p0){this.$R_1.ensureCorrectChildType($p0)},$3W_0:function($p0){return this.$R_1.$3W_0($p0)},$Cw_0:function($p0){this.$R_1.$Cw_0($p0)},get_textValue:function(){return this.$R_1.getTextValue()},$5D_0:function(){this.$R_1.$HT_0()},receiveFocus:function(){this.$R_1.receiveFocus()},onMenuClosed:function(){this.$R_1.onMenuClosed()},$AO_0:function(){return this.$R_1.$AN_0()},dispose:function(){this.$R_1.dispose();this.$R_1=null;CUI.Component.prototype.dispose.call(this)}};CUI.DataQueryResult=function(){};CUI.DataQueryResult.prototype={success:false,id:null,queryData:null,contextData:null};CUI.DataQuery=function(){};CUI.DataQuery.prototype={dataUrl:null,version:null,lcid:null,id:null,queryType:0,handler:null,data:null};CUI.DataSource=function(dataUrl,version,lcid){this.$$d_onDataReturned=Function.createDelegate(this,this.onDataReturned);this.$6Y_0=dataUrl;this.$7P_0=version;this.$6y_0=lcid;this.$B1_0={}};CUI.DataSource.prototype={$6Y_0:null,$B1_0:null,$7P_0:null,$6y_0:null,dispose:function(){this.$6Y_0=null;this.$7P_0=null;this.$6y_0=null;this.$B1_0=null},get_dataUrl:function(){return this.$6Y_0},get_version:function(){return this.$7P_0},get_lcid:function(){return this.$6y_0},runQuery:function(query){var $v_0=this.$7P_0;if(!CUI.ScriptUtility.isNullOrUndefined(query.version))$v_0=query.version;var $v_1=this.$6y_0;if(!CUI.ScriptUtility.isNullOrUndefined(query.lcid))$v_1=query.lcid;var $v_2=this.$6Y_0;if(!CUI.ScriptUtility.isNullOrUndefined(query.dataUrl))$v_2=query.dataUrl;var $v_3,$v_4=null;if($v_2.indexOf("?")===-1)$v_3=$v_2+"?ver=";else $v_3=$v_2+"&ver=";$v_3=$v_3+$v_0+"&id="+query.id+"&lcid="+$v_1+"&qt=";switch(query.queryType){case 1:$v_4="all";break;case 4:$v_4="ribbontab";break;case 3:$v_4="ribbonshallow";break;case 5:$v_4="root";break;case 2:$v_4="ribbonvisibletabdeep";break}$v_3+=$v_4;CUI.PMetrics.perfMark(7109);var $v_5=new Sys.Net.WebRequest;$v_5.set_httpVerb("GET");$v_5.set_url($v_3);var $v_6=new CUI.QueryRecord;$v_6.id=query.id;$v_6.queryType=query.queryType;$v_6.data=query.data;$v_6.handler=query.handler;$v_5.set_userContext($v_6);$v_5.add_completed(this.$$d_onDataReturned);$v_5.invoke()},onDataReturned:function(executor){CUI.PMetrics.perfMark(7110);var $v_0=executor.get_webRequest().get_userContext(),$v_1=new CUI.DataQueryResult;$v_1.contextData=$v_0.data;$v_1.id=$v_0.id;if(executor.get_responseAvailable()){$v_1.success=true;$v_1.queryData=executor.get_object();$v_0.handler($v_1)}else{$v_1.success=false;$v_0.handler($v_1)}}};CUI.Gallery=function($p0,$p1,$p2,$p3,$p4){this.$7_1=-1;CUI.Gallery.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$4E_1=$p4;this.$63_1=parseInt(this.$4E_1.Width);this.$6e_1=CUI.Gallery.$Bd(this.$4E_1.ElementDimensions)};CUI.Gallery.$Bd=function($p0){switch($p0){case "Size16by16":return 1;case "Size32by32":return 2;case "Size48by48":return 3;case "Size64by48":return 4;case "Size72by96":return 5;case "Size96by72":return 6;case "Size96by96":return 7;case "Size128by128":return 8;case "Size190by30":return 9;case "Size190by40":return 10;case "Size190by50":return 11;case "Size190by60":return 12;default:throw Error.argument("s","The parameter s is not a valid GalleryElementDimension")}};CUI.Gallery.prototype={$4E_1:null,$6e_1:0,$63_1:0,$92_1:null,get_domElementTagName:function(){return "table"},get_cssClass:function(){return "ms-cui-gallery"},$26_0:function(){this.ensureDOMElementAndEmpty();var $v_0=CUI.Utility.$3("tbody");this.get_$2_0().appendChild($v_0);this.appendChildrenToElement($v_0)},appendChildrenToElement:function($p0){for(var $v_0=Math.ceil(this.$6_0.$S_0/this.$63_1),$v_1,$v_2,$v_3,$v_4=0,$v_5=0;$v_5<$v_0;$v_5++){$v_1=CUI.Utility.$3("tr");for(var $v_6=0;$v_6<this.$63_1;$v_6++){$v_2=CUI.Utility.$3("td");$v_2.className="ms-cui-gallery-td ms-cui-gallery-element-"+CUI.GalleryElementDimensions.toString(this.$6e_1);if($v_4<this.$6_0.$S_0){$v_3=this.$6_0.get_item($v_4++);$v_3.$24_0();$v_2.appendChild($v_3.get_$2_0());$v_3.$30_0()}$v_1.appendChild($v_2)}$p0.appendChild($v_1)}},$8y_1:false,$3W_0:function($p0){if(this.$8y_1)return true;if($p0.$I_1===3){var $v_0=$p0.$3y_1;if(!CUI.ISelectableControl.isInstanceOfType($v_0.$R_1))return CUI.Component.prototype.$3W_0.call(this,$p0);var $v_1=$v_0.$R_1;!CUI.ScriptUtility.isNullOrUndefined(this.$92_1)&&this.$92_1.deselect();this.$92_1=$v_1}if($p0.$I_1===3||$p0.$I_1===7||$p0.$I_1===8){var $v_2;switch($p0.$I_1){case 3:$v_2=this.$4E_1.Command;break;case 7:$v_2=this.$4E_1.CommandPreview;break;case 8:$v_2=this.$4E_1.CommandRevert;break;default:$v_2=this.$4E_1.Command;break}this.$8y_1=true;this.raiseCommandEvent($v_2,$p0.$I_1,$p0.$3s_1);this.$8y_1=false;CUI.Component.prototype.$3W_0.call(this,$p0);return false}return CUI.Component.prototype.$3W_0.call(this,$p0)},$1D_0:function(){if(!this.$6_0.$S_0)return;this.$7_1=0;var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.$1D_0()}},$9d_0:function(){if(!this.$6_0.$S_0)return;this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=0;this.$6_0.get_item(this.$7_1).$9d_0()},$9f_0:function(){var $v_0=this.$6_0.$S_0;if(!$v_0)return;this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0-1;this.$6_0.get_item(this.$7_1).$9f_0()},$9e_0:function($p0){if(!this.$6_0.$S_0)return false;var $v_0=0,$$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$9e_0($p0)){this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0;return true}$v_0++}return false},$7U_0:function(){if(this.$7_1===-1)this.$7_1=this.$6_0.$S_0-1;var $v_0=this.$7_1,$v_1=this.$6_0.getEnumeratorAtPos($v_0);while($v_1.movePrevious()){if($v_1.get_current().$7U_0()){if($v_0!==this.$7_1){this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0}return true}$v_0--}this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=-1;return false},$7T_0:function(){if(this.$7_1===-1)this.$7_1=0;var $v_0=this.$7_1,$v_1=this.$6_0.getEnumeratorAtPos($v_0);while($v_1.moveNext()){if($v_1.get_current().$7T_0()){if($v_0!==this.$7_1){this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0}return true}$v_0++}this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=-1;return false},ensureCorrectChildType:function($p0){if(!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Galleries can only have children controls of type GalleryButton");var $v_0=$p0;if(!CUI.Controls.GalleryButton.isInstanceOfType($v_0.$R_1))throw Error.create("Galleries can only have children of type GalleryButton")},get_elementDimensions:function(){return this.$6e_1},set_elementDimensions:function($p0){this.$6e_1=$p0;return $p0},get_width:function(){return this.$63_1},set_width:function($p0){this.$63_1=$p0;return $p0}};CUI.Jewel=function($p0,$p1){CUI.Jewel.initializeBase(this,[$p0,$p1])};CUI.Jewel.prototype={$Ax_2:null,refresh:function(){this.$26_0();CUI.Root.prototype.refresh.call(this)},$26_0:function(){CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&this.$24_0();this.set_$2_0(CUI.Utility.removeChildNodes(this.get_$2_0()));this.appendChildrenToElement(this.get_$2_0());this.$l_0=false},ensureCorrectChildType:function(child){if(!CUI.ControlComponent.isInstanceOfType(child))throw Error.create('The child "'+child.$4_0+'" is not a ControlComponent');if(!CUI.Controls.JewelMenuLauncher.isInstanceOfType(child.$R_1))throw Error.create("Only children of type JewelMenuLauncher can be added to a Jewel")},get_cssClass:function(){return "ms-cui-jewel "+CUI.Root.prototype.get_cssClass.call(this)},get_rootType:function(){return "Jewel"},get_visibleInDOM:function(){return true},get_$Gf_2:function(){return this.get_$1I_1()},set_$Gf_2:function($p0){this.set_$1I_1($p0);return $p0},$Fo_2:function(){this.$Ax_2.$Fq_2()}};CUI.JewelBuildContext=function(){CUI.JewelBuildContext.initializeBase(this)};CUI.JewelBuildContext.prototype={jewel:null,jewelId:null};CUI.JewelBuildOptions=function(){CUI.JewelBuildOptions.initializeBase(this)};CUI.JewelBuilder=function(options,elmPlaceholder,rootBuildClient){this.$$d_$Cx_1=Function.createDelegate(this,this.$Cx_1);CUI.JewelBuilder.initializeBase(this,[options,elmPlaceholder,rootBuildClient]);if(CUI.ScriptUtility.isNullOrUndefined(elmPlaceholder))throw Error.create("Jewel placeholder DOM element is null or undefined.")};CUI.JewelBuilder.prototype={get_jewel:function(){return this.$0_0},set_jewel:function(value){this.$0_0=value;return value},buildJewel:function(jewelId){if(this.$3E_0)return false;if(this.isIdTrimmed(jewelId))return true;var $v_0=new CUI.JewelBuildContext;$v_0.jewelId=jewelId;this.$3E_0=true;var $v_1=new CUI.DataQuery;$v_1.id=$v_0.jewelId;$v_1.queryType=5;$v_1.handler=this.$$d_$Cx_1;$v_1.data=$v_0;this.$10_0.runQuery($v_1);return true},$EK_1:function($p0,$p1){var $v_0=new CUI.DataQueryResult;$v_0.success=true;$v_0.queryData=$p0;$v_0.contextData=$p1;this.$Cx_1($v_0)},$Cx_1:function($p0){var $v_0=$p0.contextData;$p0.queryData=this.applyDataExtensions($p0.queryData);var $v_1=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.queryData,"Jewel");this.set_jewel(this.$EL_1($v_1,$v_0));this.get_jewel().set_$Gf_2(this);this.$1i_0.onComponentCreated(this.get_jewel(),this.get_jewel().$4_0);if(this.get_$Gg_1().attachToDOM)this.get_jewel().$50_0(true);else{this.get_jewel().$26_0();this._elmPlaceholder.appendChild(this.get_jewel().get_$2_0());CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded")}this.$A3_0(this.get_jewel());this.$1i_0.onComponentBuilt(this.get_jewel(),this.get_jewel().$4_0)},$EL_1:function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0))throw Error.create("No Jewel element was present in the data");var $v_0=new CUI.DataNodeWrapper($p0);this.set_jewel(new CUI.Jewel($v_0.get_attributes()["Id"],$v_0.get_attributes()));var $v_1=this.$EM_1($p0,$p1);this.get_jewel().addChild($v_1.createComponentForDisplayMode("Default"));this.get_jewel().$Ax_2=$v_1;return this.get_jewel()},$EM_1:function($p0,$p1){var $v_0=$p0.attrs,$v_1=CUI.DataNodeWrapper.getNodeChildren($p0),$v_2=null,$v_3=$p0.attrs;if(!CUI.Utility.$15($v_3.PopulateDynamically))$v_2=this.$44_0($v_1[0],$p1,false);var $v_4=new CUI.Controls.JewelMenuLauncher(this.get_jewel(),$v_0.Id,$v_0,$v_2);return $v_4},get_$Gg_1:function(){return this.$z_0}};CUI.Menu=function($p0,$p1,$p2,$p3,$p4){this.$7_1=-1;CUI.Menu.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$8g_1=$p4};CUI.Menu.prototype={$U_1:null,$Dt_1:null,$Dq_1:null,$4v_1:null,$8g_1:null,$AY_1:25,$26_0:function(){this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();var $v_0=this.$0_0._textDirection,$v_1=this.get_$2_0(),$v_2=this.$U_1;if(!$v_0)$v_1.style.direction="ltr";else if($v_0===1){CUI.Utility.ensureCSSClassOnElement($v_1,"ms-cui-rtl");$v_1.style.direction="rtl"}if(CUI.ScriptUtility.isNullOrUndefined($v_2)){$v_2=CUI.Utility.$3("div");$v_2.className="ms-cui-smenu-inner"}$v_1.setAttribute("role","menu");$v_1.appendChild($v_2);if(!CUI.ScriptUtility.isNullOrEmptyString(this.$8g_1))$v_1.style.maxWidth=this.$8g_1;this.appendChildrenToElement($v_2);CUI.Component.prototype.$26_0.call(this);$addHandler($v_1,"contextmenu",CUI.Utility.get_returnFalseHandler())},get_cssClass:function(){return "ms-cui-menu"},get_domElementTagName:function(){return "div"},ensureCorrectChildType:function($p0){if(!CUI.MenuSection.isInstanceOfType($p0))throw Error.create("Only MenuSection Components can be added to Menu Components.")},get_innerDiv:function(){return this.$U_1},set_innerDiv:function($p0){this.$U_1=$p0;return $p0},get_additionalWidth:function(){var $v_0=this.$AY_1;this.$AY_1=0;return $v_0},$74_1:null,get_$D1_1:function(){return this.$74_1},set_$D1_1:function($p0){$p0&&!CUI.ScriptUtility.isNullOrUndefined(this.$74_1)&&this.$0_0.$3Q_1(this.$74_1);this.$74_1=$p0;return $p0},get_$Eh_0:function(){if(this._componentHeight===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentHeight=this.get_$2_0().offsetHeight;return this._componentHeight},get_$Ba_0:function(){if(this._componentTopPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$2_0());return this._componentTopPosition},$GT_1:function(){this._componentWidth=-1;this._componentHeight=-1;this._componentTopPosition=-1;this._componentLeftPosition=-1},$5D_0:function(){this.set_$5A_0(new Date);CUI.Component.prototype.$5D_0.call(this)},$1D_0:function(){if(!this.$6_0.$S_0)return;this.$7_1=0;var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.$1D_0()}},$9d_0:function(){if(!this.$6_0.$S_0)return;this.$7_1=0;this.$6_0.get_item(0).$9d_0();this.$7T_0()},$9f_0:function(){var $v_0=this.$6_0.$S_0;if(!$v_0)return;this.$7_1=$v_0-1;this.$6_0.get_item(this.$7_1).$9f_0();this.$7U_0()},$9e_0:function($p0){if(!this.$6_0.$S_0)return false;this.$7_1=0;var $v_0=0,$$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$9e_0($p0)){this.$7_1=$v_0;return true}$v_0++}return false},$7U_0:function(){if(this.$7_1===-1)this.$7_1=this.$6_0.$S_0-1;var $v_0=this.$6_0.getEnumeratorAtPos(this.$7_1),$v_1=this.$7_1;while($v_0.movePrevious()){if($v_0.get_current().$7U_0()){this.$7_1=$v_1;return true}$v_1--}this.$7_1=-1;return false},$7T_0:function(){if(this.$7_1===-1)this.$7_1=0;var $v_0=this.$6_0.getEnumeratorAtPos(this.$7_1),$v_1=this.$7_1;while($v_0.moveNext()){if($v_0.get_current().$7T_0()){this.$7_1=$v_1;return true}$v_1++}this.$7_1=-1;return false},$CG_1:function($p0){return this.$CH_1(this,$p0)},$CH_1:function($p0,$p1){var $v_0;if(CUI.ControlComponent.isInstanceOfType($p0)){var $v_2=$p0;if(CUI.ISelectableControl.isInstanceOfType($v_2.$R_1)){var $v_3=$v_2.$R_1;if($v_3.getMenuItemId()===$p1)return $v_3}}var $v_1=$p0.$6_0;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)){var $$enum_6=$v_1.getEnumerator();while($$enum_6.moveNext()){var $v_4=$$enum_6.get_current();$v_0=this.$CH_1($v_4,$p1);if($v_0)return $v_0}}return null},$GI_1:function(){var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current(),$$enum_2=$v_0.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.get_visible())return true}}return false},get_visibleInDOM:function(){return this.$8d_1},$8d_1:false,dispose:function(){CUI.Component.prototype.dispose.call(this);this.$U_1=null;this.$Dt_1=null;this.$Dq_1=null;this.$4v_1=null;try{$removeHandler(this.get_$2_0(),"contextmenu",CUI.Utility.get_returnFalseHandler())}catch($$e_0){}}};CUI.MenuItem=function($p0,$p1,$p2,$p3){CUI.MenuItem.initializeBase(this,[$p0,$p1,$p2,$p3])};CUI.MenuItem.prototype={$Ar_2:false,get_$1Q_2:function(){return this.$Ar_2},set_$1Q_2:function($p0){this.$Ar_2=$p0;return $p0},$9e_0:function($p0){if(CUI.ISelectableControl.isInstanceOfType(this.$R_1)){var $v_0=this.$R_1;if($v_0.getMenuItemId()===$p0)if(this.get_visible()&&this.get_enabled()){this.receiveFocus();this.set_$1Q_2(true);return true}}return false},$7U_0:function(){if(!this.get_visible())return false;this.set_$1Q_2(this.$R_1.$7U_0());return this.get_$1Q_2()},$7T_0:function(){if(!this.get_visible())return false;this.set_$1Q_2(this.$R_1.$7T_0());return this.get_$1Q_2()},$1D_0:function(){this.set_$1Q_2(false)}};CUI.MenuLauncherControlProperties=function(){CUI.MenuLauncherControlProperties.initializeBase(this)};CUI.MenuLauncherControlProperties.prototype={CacheMenuVersions:null,CommandMenuOpen:null,CommandMenuClose:null,CommandValueId:null,PopulateDynamically:null,PopulateOnlyOnce:null,PopulateQueryCommand:null};CUI.BrowserUtility=function(){};CUI.BrowserUtility.$Cb=function(){return Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1||navigator.userAgent.toLowerCase().indexOf("gecko")!==-1};CUI.BrowserUtility.$Gb=function(){return navigator.userAgent!=""&&navigator.userAgent!=null&&(navigator.userAgent.toLowerCase().search("ipad")>-1||navigator.userAgent.toLowerCase().search("ipod")>-1||navigator.userAgent.toLowerCase().search("iphone")>-1)};CUI.MenuLauncher=function($p0,$p1,$p2,$p3){this.$$d_$HO_1=Function.createDelegate(this,this.$HO_1);this.$$d_addAndPositionBackFrameInternal=Function.createDelegate(this,this.addAndPositionBackFrameInternal);this.$76_1=-1;CUI.MenuLauncher.initializeBase(this,[$p0,$p1,$p2]);this.$C_1=$p3};CUI.MenuLauncher.dictToInt=function($p0,$p1){return $p0[$p1]};CUI.MenuLauncher.prototype={$n_1:false,_selectedControl:null,get_menuLaunched:function(){return this.$n_1},$C_1:null,$1H_1:false,get_launchedByKeyboard:function(){return this.$1H_1},set_launchedByKeyboard:function($p0){this.$1H_1=$p0;return $p0},$39_1:null,get_elmHadFocus:function(){return this.$39_1},set_elmHadFocus:function($p0){this.$39_1=$p0;return $p0},$4S_1:null,get_$BN_1:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$4S_1))this.$4S_1=CUI.Utility.$Bi();return this.$4S_1},launchMenu:function($p0,$p1){if(this.$n_1)return false;this.$39_1=$p0;CUI.Utility.$15(this.get_$1_1().PopulateDynamically)&&this.pollForDynamicMenu(true,$p1);if(CUI.ScriptUtility.isNullOrUndefined(this.$C_1))return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$5t_1)){this.$5t_1();this.$5t_1=null}this.$C_1.$30_0();if(!this.$C_1.$GI_1())return false;var $v_0=this.get_displayedComponent();$v_0.$9U_0();$v_0.$5k_0=true;$v_0.addChild(this.$C_1);$v_0.$5k_0=false;this.$C_1.$D3_0();this.$C_1.$GT_1();var $v_1=CUI.Ribbon.isInstanceOfType(this.$0_0),$v_2=null,$v_3=false;if($v_1){$v_2=this.$0_0;$v_3=$v_2.get_$6K_2();$v_2.set_$6K_2(false)}var $v_4=this.$C_1.get_$2_0();$v_4.style.visibility="hidden";$v_4.style.position="absolute";$v_4.style.top="0px";$v_4.style.left="0px";$v_4.style.zIndex=1001;document.body.appendChild($v_4);if((CUI.Utility.$4A()||CUI.Utility.get_$7d())&&this.$0_0._textDirection===1){var $v_5=$v_4.offsetWidth+this.$C_1.get_additionalWidth();$v_5=$v_5>=18?$v_5-18:0;var $v_6=$v_5+"px",$v_7=this.$C_1.$6_0,$$enum_A=$v_7.getEnumerator();while($$enum_A.moveNext()){var $v_8=$$enum_A.get_current(),$v_9=$v_8.$6_0,$$enum_D=$v_9.getEnumerator();while($$enum_D.moveNext()){var $v_A=$$enum_D.get_current();if(CUI.MenuItem.isInstanceOfType($v_A))$v_A.get_$2_0().style.width=$v_6}}}this.positionMenu($v_4,$v_0.get_$2_0());Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.addAndPositionBackFrame();this.$0_0.$E8_1(this,this.$39_1);this.$0_0.$Dz_1(this);$v_4.style.visibility="visible";this.$n_1=true;this.$C_1.$8d_1=true;this.$Fp_1();$v_1&&$v_2.set_$6K_2($v_3);return true},$Fp_1:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$C_1.$4v_1)&&!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl)){var $v_0=this._selectedControl,$v_1=$v_0.get_displayedComponent();if(CUI.MenuItem.isInstanceOfType($v_1))this.$C_1.$4v_1=$v_1}if(this.$1H_1)this.$C_1.$9d_0();else{var $v_2=this.$C_1.$4v_1;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)&&!CUI.BrowserUtility.$Gb()){var $v_3=$v_2.$R_1;if(CUI.Controls.ToggleButton.isInstanceOfType($v_3)&&CUI.ISelectableControl.isInstanceOfType($v_3)){var $v_4=$v_3;!this.$C_1.$9e_0($v_4.getMenuItemId())&&this.$C_1.$9d_0()}}}},addAndPositionBackFrame:function(){this.$76_1!==-1&&window.clearTimeout(this.$76_1);this.$76_1=window.setTimeout(this.$$d_addAndPositionBackFrameInternal,50)},addAndPositionBackFrameInternal:function(){CUI.PMetrics.perfMark(7188);document.body.appendChild(this.get_$BN_1());CUI.Utility.$D4(this.get_$BN_1(),this.$C_1.get_$2_0());CUI.PMetrics.perfMark(7189)},onModalBodyClick:function($p0){$p0.stopPropagation();this.$1H_1=false;this.$0_0.$3Q_1(this)},onModalBodyMouseOver:function($p0){},onModalBodyMouseOut:function($p0){},onModalContextMenu:function($p0){$p0.stopPropagation();!CUI.BrowserUtility.$Cb()&&$p0.preventDefault();this.$1H_1=false;this.$0_0.$3Q_1(this)},onModalKeyPress:function($p0){if($p0)if($p0.rawEvent){if($p0.rawEvent.keyCode===27){$p0.stopPropagation();this.$1H_1=true;this.$0_0.$3Q_1(this)}if($p0.rawEvent.keyCode===9)if($p0.shiftKey){!this.$C_1.$7U_0()&&this.$C_1.$9f_0();$p0.preventDefault()}else{!this.$C_1.$7T_0()&&this.$C_1.$9d_0();$p0.preventDefault()}if($p0.rawEvent.keyCode===40){!this.$C_1.$7T_0()&&this.$C_1.$9d_0();$p0.preventDefault();$p0.stopPropagation()}if($p0.rawEvent.keyCode===38){!this.$C_1.$7U_0()&&this.$C_1.$9f_0();$p0.preventDefault();$p0.stopPropagation()}if(CUI.Controls.FlyoutAnchor.isInstanceOfType(this)){if($p0.rawEvent.keyCode===39&&!this.$0_0._textDirection||$p0.rawEvent.keyCode===37&&this.$0_0._textDirection===1){!this.$C_1.$7T_0()&&this.$C_1.$9d_0();$p0.preventDefault();$p0.stopPropagation()}if($p0.rawEvent.keyCode===37&&!this.$0_0._textDirection||$p0.rawEvent.keyCode===39&&this.$0_0._textDirection===1){!this.$C_1.$7U_0()&&this.$C_1.$9f_0();$p0.preventDefault();$p0.stopPropagation()}}}},positionMenu:function($p0,$p1){this.$0_0.$HX_1($p0,$p1)},getAllElementDimensions:function($p0,$p1){return this.$0_0.$9g_1($p0,$p1)},$52_1:function(){if(!this.$n_1)return;$clearHandlers(this.$C_1.get_$2_0());CUI.UIUtility.removeNode(this.$C_1.get_$2_0());!CUI.ScriptUtility.isNullOrUndefined(this.$4S_1)&&CUI.UIUtility.removeNode(this.$4S_1);this.$C_1.onMenuClosed();var $v_0=this.$C_1.$P_0;$v_0.$5k_0=true;$v_0.removeChild(this.$C_1.$4_0);$v_0.$5k_0=false;this.$n_1=false;this.$C_1.$8d_1=false;this.$0_0.$FB_1(this);!CUI.ScriptUtility.isNullOrUndefined(this.$39_1)&&this.$1H_1&&this.$39_1.focus();this.$39_1=null;this.$1H_1=false;this.onLaunchedMenuClosed()},onMenuClosed:function(){},onLaunchedMenuClosed:function(){this.$C_1.$1D_0()},ensureCorrectChildType:function($p0){if(!CUI.Menu.isInstanceOfType($p0)&&!CUI.ToolTip.isInstanceOfType($p0))throw Error.create("This Component can only have Menu and ToolTip Components as children.")},$3W_0:function($p0){if(this.$n_1&&$p0.$I_1!==4&&$p0.$I_1!==5&&$p0.$I_1!==6&&$p0.$I_1!==7&&$p0.$I_1!==8&&$p0.$I_1!==9&&$p0.$I_1!==10){if(!CUI.ScriptUtility.isNullOrUndefined($p0.get_sourceControl())){var $v_0=$p0.get_sourceControl().get_displayedComponent();this.$C_1.$4v_1=$v_0}this.$0_0.$3Q_1(this)}return true},$78_1:false,$5t_1:null,pollForDynamicMenu:function($p0,$p1){if(this.$78_1&&CUI.Utility.$15(this.get_$1_1().PopulateOnlyOnce))return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().PopulateQueryCommand))return;var $v_0={},$v_1;if(CUI.Utility.$15(this.get_$1_1().CacheMenuVersions)){$v_1={};var $$dict_4=this.$4K_1;for(var $$key_5 in $$dict_4){var $v_3={key:$$key_5,value:$$dict_4[$$key_5]};$v_1[$v_3.key]=true}$v_0.CachedVersions=$v_1}var $v_2=this.$0_0.$6F_1(this.get_$1_1().PopulateQueryCommand,this.get_$1_1().PopulateQueryCommand,$v_0);if($v_2){var $v_4=null,$v_5=null;if(!CUI.ScriptUtility.isNullOrUndefined($v_0.PopulationJSON))$v_5=$v_0.PopulationJSON;else if(!CUI.ScriptUtility.isNullOrUndefined($v_0.PopulationXML))$v_5=CUI.Builder.$Be($v_0.PopulationXML);if(!CUI.ScriptUtility.isNullOrUndefined($v_5)){$v_4=this.$0_0.get_$1I_1().$44_0($v_5,new CUI.BuildContext,false);if(!CUI.ScriptUtility.isNullOrUndefined($v_4)){this.$78_1=true;if(CUI.Utility.$15(this.get_$1_1().CacheMenuVersions)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.PopulationVersion))this.get_cachedMenuVersions()[$v_0.PopulationVersion]=$v_4}}else if(!CUI.ScriptUtility.isNullOrUndefined($v_0.PopulationVersion))$v_4=this.get_cachedMenuVersions()[$v_0.PopulationVersion];else if($p0&&-1!==$v_0.PollAgainInterval){this.$5t_1=$p1;window.setTimeout(this.$$d_$HO_1,$v_0.PollAgainInterval);this.$C_1=null}if(!CUI.ScriptUtility.isNullOrUndefined($v_4)){this.$C_1=$v_4;this.onDynamicMenuPopulated()}}},$HO_1:function(){this.launchMenu(this.$39_1,this.$5t_1)},onDynamicMenuPopulated:function(){},get_$1_1:function(){return this.$5_0},$4K_1:null,get_cachedMenuVersions:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$4K_1))this.$4K_1={};return this.$4K_1},dispose:function(){CUI.Control.prototype.dispose.call(this);!CUI.ScriptUtility.isNullOrUndefined(this.$C_1)&&this.$C_1.dispose();if(!CUI.ScriptUtility.isNullOrUndefined(this.$4K_1)){var $$dict_0=this.$4K_1;for(var $$key_1 in $$dict_0){var $v_0={key:$$key_1,value:$$dict_0[$$key_1]},$v_1=$v_0.value;$v_1.dispose()}}this._selectedControl=null;this.$C_1=null;this.$4S_1=null}};CUI.MenuSection=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){this.$7_1=-1;CUI.MenuSection.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$B8_1=$p4;this.$8f_1=$p5;this.$88_1=$p6};CUI.MenuSection.prototype={$B8_1:false,$8f_1:null,$88_1:null,$4a_1:null,$F_1:null,$2m_1:null,$26_0:function(){this.ensureDOMElementAndEmpty();this.$4a_1=CUI.Utility.$3("div");this.$4a_1.className="ms-cui-menusection";this.get_$2_0().appendChild(this.$4a_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.get_title())){this.$F_1=CUI.Utility.$3("div");CUI.UIUtility.setInnerText(this.$F_1,this.get_title());this.$F_1.className="ms-cui-menusection-title";this.$4a_1.appendChild(this.$F_1)}this.$2m_1=CUI.Utility.$3("ul");this.$2m_1.className="ms-cui-menusection-items";var $v_0;if(this.$88_1==="Menu32"){if(!this.$0_0._textDirection)$v_0="ms-cui-menusection-items32";else $v_0="ms-cui-menusection-items32rtl";var $v_1=this.$P_0;CUI.Menu.isInstanceOfType($v_1)&&CUI.Utility.ensureCSSClassOnElement($v_1.get_$2_0(),"ms-cui-menu32")}else if(this.$88_1==="Menu16")if(!this.$0_0._textDirection)$v_0="ms-cui-menusection-items16";else $v_0="ms-cui-menusection-items16rtl";else $v_0="";$v_0!==""&&CUI.Utility.ensureCSSClassOnElement(this.$2m_1,$v_0);if(this.$B8_1){this.$2m_1.style.overflowY="auto";this.$2m_1.style.position="relative"}if(!CUI.ScriptUtility.isNullOrEmptyString(this.$8f_1))this.$2m_1.style.maxHeight=this.$8f_1;this.$4a_1.appendChild(this.$2m_1);this.appendChildrenToElement(this.$2m_1)},get_domElementTagName:function(){return "div"},appendChildrenToElement:function($p0){var $v_0,$$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();$v_0=CUI.Utility.$3("li");$v_0.className="ms-cui-menusection-items";$v_1.$24_0();$v_0.appendChild($v_1.get_$2_0());$p0.appendChild($v_0);$v_1.$30_0()}},$1D_0:function(){if(!this.$6_0.$S_0)return;this.$7_1=0;var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();$v_0.$1D_0()}},$9d_0:function(){if(!this.$6_0.$S_0)return;this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=0;this.$6_0.get_item(this.$7_1).$9d_0()},$9f_0:function(){var $v_0=this.$6_0.$S_0;if(!$v_0)return;this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0-1;this.$6_0.get_item(this.$7_1).$9f_0()},$9e_0:function($p0){if(!this.$6_0.$S_0)return false;var $v_0=0,$$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$9e_0($p0)){this.$7_1>-1&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_0;return true}$v_0++}return false},$7U_0:function(){var $v_0=this.$6_0.$S_0;if(this.$7_1===-1)this.$7_1=$v_0-1;var $v_1=this.$7_1,$v_2=this.$6_0.getEnumeratorAtPos($v_1);while($v_2.movePrevious()){if($v_2.get_current().$7U_0()){if($v_1!==this.$7_1){this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_1}return true}$v_1--}$v_0>0&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=-1;return false},$7T_0:function(){if(this.$7_1===-1)this.$7_1=0;var $v_0=this.$6_0.getEnumeratorAtPos(this.$7_1),$v_1=this.$7_1;while($v_0.moveNext()){if($v_0.get_current().$7T_0()){if($v_1!==this.$7_1){!CUI.ScriptUtility.isNullOrUndefined(this.$6_0.get_item(this.$7_1))&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=$v_1}return true}$v_1++}this.$6_0.$S_0>0&&this.$6_0.get_item(this.$7_1).$1D_0();this.$7_1=-1;return false},ensureCorrectChildType:function($p0){if(!CUI.MenuItem.isInstanceOfType($p0)&&!CUI.Gallery.isInstanceOfType($p0)&&!CUI.GroupPopup.isInstanceOfType($p0))throw Error.create("MenuSections can only have children of type MenuItem, Gallery or GroupPopup.")},$Db_1:function($p0){this.$1k_0=$p0;CUI.UIUtility.setInnerText(this.$F_1,$p0)},dispose:function(){CUI.Component.prototype.dispose.call(this);this.$2m_1=null;this.$F_1=null;this.$4a_1=null}};CUI.QAT=function($p0,$p1){CUI.QAT.initializeBase(this,[$p0,$p1])};CUI.QAT.prototype={refresh:function(){this.$26_0();CUI.Root.prototype.refresh.call(this)},$26_0:function(){CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&this.$24_0();this.set_$2_0(CUI.Utility.removeChildNodes(this.get_$2_0()));this.appendChildrenToElement(this.get_$2_0());this.$l_0=false},ensureCorrectChildType:function(child){if(!CUI.ControlComponent.isInstanceOfType(child))throw Error.create("Only children of type ControlComponent can be added to a QAT")},get_cssClass:function(){return "ms-cui-QAT "+CUI.Root.prototype.get_cssClass.call(this)},get_rootType:function(){return "QAT"},get_visibleInDOM:function(){return true},get_$Hi_2:function(){return this.get_$1I_1()},set_$Hi_2:function($p0){this.set_$1I_1($p0);return $p0}};CUI.QATBuildContext=function(){CUI.QATBuildContext.initializeBase(this)};CUI.QATBuildContext.prototype={QAT:null,qatId:null};CUI.QATBuildOptions=function(){CUI.QATBuildOptions.initializeBase(this)};CUI.QATBuilder=function(options,elmPlaceholder,rootBuildClient){this.$$d_$HF_1=Function.createDelegate(this,this.$HF_1);CUI.QATBuilder.initializeBase(this,[options,elmPlaceholder,rootBuildClient]);if(CUI.ScriptUtility.isNullOrUndefined(elmPlaceholder))throw Error.create("QAT placeholder DOM element is null or undefined.")};CUI.QATBuilder.prototype={get_QAT:function(){return this.$0_0},set_QAT:function(value){this.$0_0=value;return value},buildQAT:function(qatId){if(this.$3E_0)return false;if(this.isIdTrimmed(qatId))return true;var $v_0=new CUI.QATBuildContext;$v_0.qatId=qatId;this.$3E_0=true;var $v_1=new CUI.DataQuery;$v_1.id=$v_0.qatId;$v_1.queryType=5;$v_1.handler=this.$$d_$HF_1;$v_1.data=$v_0;this.$10_0.runQuery($v_1);return true},$HF_1:function($p0){var $v_0=$p0.contextData;$p0.queryData=this.applyDataExtensions($p0.queryData);this.set_QAT(this.$EQ_1(CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.queryData,"QAT"),$v_0));this.get_QAT().set_$Hi_2(this);this.$1i_0.onComponentCreated(this.get_QAT(),this.get_QAT().$4_0);if(this.get_$Hj_1().attachToDOM)this.get_QAT().$50_0(true);else{this.get_QAT().$26_0();this._elmPlaceholder.appendChild(this.get_QAT().get_$2_0());CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded")}this.$A3_0(this.get_QAT());this.$1i_0.onComponentBuilt(this.get_QAT(),this.get_QAT().$4_0)},$EQ_1:function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0))throw Error.create("No QAT element was present in the data");var $v_0=new CUI.DataNodeWrapper($p0);this.set_QAT(new CUI.QAT($v_0.get_attributes()["Id"],$v_0.get_attributes()));for(var $v_1=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($v_0.$a_0,"Controls")),$v_2=0;$v_2<$v_1.length;$v_2++)if(!this.isNodeTrimmed($v_1[$v_2])){var $v_3=this.$23_0($v_1[$v_2],$p1);this.get_QAT().addChild($v_3.createComponentForDisplayMode("Small"))}return this.get_QAT()},get_$Hj_1:function(){return this.$z_0}};CUI.RibbonPeripheralSection=function(){};CUI.ContextualGroup=function($p0,$p1,$p2,$p3){this.$4_0=$p0;this.$1k_0=$p1;this.$4O_0=$p2;this.$17_0=$p3};CUI.ContextualGroup.$7V=function($p0){switch($p0){case 1:return "db";case 2:return "lb";case 3:return "tl";case 4:return "or";case 5:return "gr";case 6:return "mg";case 7:return "yl";case 8:return "pp";default:return ""}};CUI.ContextualGroup.prototype={$4_0:null,$1k_0:null,$4O_0:0,$17_0:null,$3O_0:0,get_id:function(){return this.$4_0},get_count:function(){return this.$3O_0},get_title:function(){return this.$1k_0},get_color:function(){return this.$4O_0},get_command:function(){return this.$17_0},$1w_0:null,$F_0:null,$2S_0:null,get_$2_0:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$1w_0)){this.$1w_0=CUI.Utility.$3("li");if(!CUI.ScriptUtility.isNullOrUndefined(this.$4_0))this.$1w_0.id=this.$4_0;this.$1w_0.className="ms-cui-cg";var $v_0=CUI.ContextualGroup.$7V(this.$4O_0);$v_0!==""&&CUI.Utility.ensureCSSClassOnElement(this.$1w_0,"ms-cui-cg-"+$v_0);var $v_1=CUI.Utility.$3("div");$v_1.className="ms-cui-cg-i";$v_1.title=this.$1k_0;this.$1w_0.appendChild($v_1);this.$F_0=CUI.Utility.$3("div");this.$F_0.className="ms-cui-cg-t";$v_1.appendChild(this.$F_0);var $v_2=CUI.Utility.$3("span");$v_2.className="ms-cui-cg-t-i";CUI.UIUtility.setInnerText($v_2,this.$1k_0);this.$F_0.appendChild($v_2);this.$2S_0=CUI.Utility.$3("ul");this.$2S_0.className="ms-cui-ct-ul";this.$1w_0.appendChild(this.$2S_0);this.$3O_0=0}return this.$1w_0},$E7_0:function(){var $v_0=$get(this.$4_0);if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){this.$1w_0=$v_0;this.$F_0=this.$1w_0.childNodes[0].childNodes[0];this.$2S_0=this.$1w_0.childNodes[1]}},$E0_0:function($p0){this.$2S_0.appendChild($p0);this.$3O_0++;if(this.$3O_0===1)CUI.Utility.ensureCSSClassOnElement(this.$2S_0,"ms-cui-oneCtxTab");else this.$3O_0===2&&CUI.Utility.removeCSSClassFromElement(this.$2S_0,"ms-cui-oneCtxTab")},$FJ_0:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$2S_0)&&CUI.Utility.removeChildNodesSlow(this.$2S_0);this.$3O_0=0},dispose:function(){this.$1w_0=null;this.$F_0=null;this.$2S_0=null;this.$3O_0=0}};CUI.DeclarativeTemplate=function($p0){this.$$d_$F1_1=Function.createDelegate(this,this.$F1_1);CUI.DeclarativeTemplate.initializeBase(this);this.$10_1=new CUI.DataNodeWrapper($p0)};CUI.DeclarativeTemplate.prototype={$10_1:null,createGroup:function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){var $v_0=new CUI.DeclarativeTemplateBuildContext;$v_0.ribbon=$p0;$v_0.controls=$p6;$v_0.parameters=$p7;for(var $v_1=$p0.$Es_2($p1,$p2,$p3,$p4,$p5),$v_2=0;$v_2<this.$10_1.get_children().length;$v_2++){var $v_3=this.$Ev_1(this.$10_1.get_children()[$v_2],$v_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$v_1.addChild($v_3)}return $v_1},$Ev_1:function($p0,$p1,$p2){var $v_0=$p0.attrs.Title;if($v_0==="Popup"){var $v_2=$p0.attrs.LayoutTitle;$p1.set_popupLayoutTitle($v_2);return null}var $v_1=$p2.ribbon.$Bj_2($p1.$4_0+"-"+$v_0,$v_0);$v_1.$AJ_0(this.$$d_$F1_1,$p0,$p2);return $v_1},$F1_1:function($p0,$p1,$p2){var $v_0=$p0,$v_1=$p2;this.$Fj_1($p1,$v_0,$v_1);$v_0.$A1_0(true);return $v_0},$Fj_1:function($p0,$p1,$p2){for(var $v_0=$p0.children,$v_1=0,$v_2=0;$v_2<$v_0.length;$v_2++){var $v_3=$v_0[$v_2].name;if($v_3==="Section"){var $v_4=this.$Ex_1($v_0[$v_2],$p2,$p1,$v_1++);$p1.addChild($v_4)}else $v_1=this.$9q_1($v_0[$v_2],$p2,$p1,$v_1)}},$Ex_1:function($p0,$p1,$p2,$p3){var $v_0,$v_1=$p0.attrs.Type,$v_2=$p0.attrs.Alignment;switch($v_1){case "OneRow":$v_0=2;break;case "TwoRow":$v_0=3;break;case "ThreeRow":$v_0=4;break;case "Divider":$v_0=1;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+$v_1)}var $v_3=1;if($v_2==="Middle")$v_3=2;var $v_4=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3,$v_0,$v_3);if($v_0!==1){this.$9s_1($v_4.getRow(1),$p0.children[0],$p1);($v_4.$I_2===3||$v_4.$I_2===4)&&this.$9s_1($v_4.getRow(2),$p0.children[1],$p1);$v_4.$I_2===4&&this.$9s_1($v_4.getRow(3),$p0.children[2],$p1)}return $v_4},$9s_1:function($p0,$p1,$p2){for(var $v_0=$p1.children,$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1].name,$v_3=null;if($v_2==="ControlRef")$v_3=this.$Bf_1($v_0[$v_1],$p2);else if($v_2==="OverflowArea")this.$9q_1($v_0[$v_1],$p2,$p0,$v_1);else $v_3=this.$Ey_1($v_0[$v_1],$p2,$p0,$v_1);!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$p0.addChild($v_3)}},$Ey_1:function($p0,$p1,$p2,$p3){for(var $v_0=$p0.children,$v_1=$p1.ribbon.$Bm_2($p2.$4_0+"-"+$p3),$v_2=0;$v_2<$v_0.length;$v_2++){var $v_3=CUI.DataNodeWrapper.getNodeName($v_0[$v_2]);if($v_3==="ControlRef"){var $v_4=this.$Bf_1($v_0[$v_2],$p1);!CUI.ScriptUtility.isNullOrUndefined($v_4)&&$v_1.addChild($v_4)}else this.$9q_1($v_0[$v_2],$p1,$v_1,$v_2)}if(!$v_1.$6_0.$S_0)return null;return $v_1},$Bf_1:function($p0,$p1){var $v_0=$p0.attrs,$v_1=$v_0["TemplateAlias"],$v_2=$v_0["DisplayMode"],$v_3=$p1.controls[$v_1],$v_4=null;if(!CUI.ScriptUtility.isNullOrUndefined($v_3)&&CUI.Control.isInstanceOfType($v_3))$v_4=$v_3.createComponentForDisplayMode($v_2);return $v_4},$9q_1:function($p0,$p1,$p2,$p3){var $v_0=CUI.DataNodeWrapper.getNodeAttributes($p0),$v_1=$v_0["TemplateAlias"],$v_2=CUI.DataNodeWrapper.getNodeName($p0),$v_3=$p1.controls[$v_1];if(CUI.ScriptUtility.isNullOrUndefined($v_3))return $p3;var $v_4=false,$v_5=false,$v_6=2;if($v_2==="OverflowSection"){$v_4=CUI.Utility.$15($v_0["DividerBefore"]);$v_5=CUI.Utility.$15($v_0["DividerAfter"]);if($v_4){var $v_9=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,1,1);$p2.addChild($v_9)}var $v_8=$v_0["Type"];switch($v_8){case "OneRow":$v_6=2;break;case "TwoRow":$v_6=3;break;case "ThreeRow":$v_6=4;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+$v_8)}}var $v_7=$v_0["DisplayMode"];if(Array.isInstanceOfType($v_3))for(var $v_A=$v_3,$v_B=null,$v_C=0;$v_C<$v_A.length;$v_C++){var $v_D=$v_A[$v_C];if($v_2==="OverflowSection")if($v_6===2){if(CUI.ScriptUtility.isNullOrUndefined($v_B)){$v_B=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,2,1);$p2.addChild($v_B)}$v_B.getRow(1).addChild($v_D.createComponentForDisplayMode($v_7))}else if($v_6===4){if(CUI.ScriptUtility.isNullOrUndefined($v_B)){$v_B=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,4,1);$p2.addChild($v_B)}$v_B.getRow($v_C%3+1).addChild($v_D.createComponentForDisplayMode($v_7));if($v_C%3===2)$v_B=null}else{if(CUI.ScriptUtility.isNullOrUndefined($v_B)){$v_B=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,3,1);$p2.addChild($v_B)}$v_B.getRow($v_C%2+1).addChild($v_D.createComponentForDisplayMode($v_7));if($v_C%2===1)$v_B=null}else $p2.addChild($v_D.createComponentForDisplayMode($v_7))}else{var $v_E=$v_3;if($v_2==="OverflowSection"){var $v_F;if($v_6===2){$v_F=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,2,1);$v_F.getRow(1).addChild($v_E.createComponentForDisplayMode($v_7))}else if($v_6===4){$v_F=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,4,1);$v_F.getRow(1).addChild($v_E.createComponentForDisplayMode($v_7))}else{$v_F=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,3,1);$v_F.getRow(1).addChild($v_E.createComponentForDisplayMode($v_7))}$p2.addChild($v_F)}else $p2.addChild($v_E.createComponentForDisplayMode($v_7))}if($v_5){var $v_G=$p1.ribbon.$2b_2($p2.$4_0+"-"+$p3++,1,1);$p2.addChild($v_G)}return $p3}};CUI.Group=function($p0,$p1,$p2,$p3,$p4,$p5){CUI.Group.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$17_2=$p4;this.$5_2=$p5};CUI.Group.prototype={$e_2:null,$F_2:null,$3k_2:null,$b_2:null,$5_2:null,dispose:function(){CUI.Component.prototype.dispose.call(this);this.$e_2=null;this.$F_2=null;this.$3k_2=null;this.$5_2=null},$26_0:function(){this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$F_2)){this.$F_2=CUI.Utility.$3("span");this.$F_2.className="ms-cui-groupTitle"}else this.$F_2=CUI.Utility.removeChildNodes(this.$F_2);if(CUI.ScriptUtility.isNullOrUndefined(this.$e_2)){this.$e_2=CUI.Utility.$3("span");this.$e_2.className="ms-cui-groupBody"}else this.$e_2=CUI.Utility.removeChildNodes(this.$e_2);if(CUI.ScriptUtility.isNullOrUndefined(this.$3k_2)){this.$3k_2=CUI.Utility.$3("span");this.$3k_2.className="ms-cui-groupSeparator"}var $v_0=this.get_title();!CUI.ScriptUtility.isNullOrUndefined($v_0)&&CUI.UIUtility.setInnerText(this.$F_2,$v_0);this.$F_2.title=this.get_title();if(!CUI.ScriptUtility.isNullOrUndefined(this.$b_2)&&CUI.GroupPopupLayout.isInstanceOfType(this.$b_2)){this.$b_2.$24_0();this.get_$2_0().appendChild(this.$b_2.get_$2_0());this.get_$2_0().appendChild(this.$3k_2);this.$b_2.$30_0()}else{var $v_1=CUI.Utility.$3("span");$v_1.className="ms-cui-groupContainer";$v_1.appendChild(this.$e_2);$v_1.appendChild(this.$F_2);this.get_$2_0().appendChild($v_1);this.get_$2_0().appendChild(this.$3k_2);if(!CUI.ScriptUtility.isNullOrUndefined(this.$b_2)){this.$b_2.$24_0();this.$e_2.appendChild(this.$b_2.get_$2_0());this.$b_2.$30_0()}}CUI.Component.prototype.$26_0.call(this)},$7R_0:function(){CUI.Component.prototype.$7R_0.call(this);if(!CUI.ScriptUtility.isNullOrUndefined(this.$b_2)&&!CUI.GroupPopupLayout.isInstanceOfType(this.$b_2)){var $v_0=this.get_$2_0().childNodes[0];this.$3k_2=this.get_$2_0().childNodes[1];this.$e_2=$v_0.childNodes[0];this.$F_2=$v_0.childNodes[1]}},$50_0:function($p0){this.$7R_0();this.$W_0();this.$l_0=false;$p0&&!CUI.ScriptUtility.isNullOrUndefined(this.$b_2)&&this.$b_2.$50_0(true)},$24_0:function(){var $v_0=this.get_$2_0();CUI.Component.prototype.$24_0.call(this)},get_cssClass:function(){return "ms-cui-group"},get_domElementTagName:function(){return "li"},unselectLayout:function(){this.selectLayout(null,null)},selectLayout:function($p0,$p1){var $v_0=null;if($p0!=="Popup")$v_0=CUI.ScriptUtility.isNullOrUndefined($p0)?null:this.getChildByTitle($p0);else{!CUI.ScriptUtility.isNullOrUndefined($p1)&&this.set_popupLayoutTitle($p1);this.$FG_2();$v_0=this.$5z_2}if($v_0===this.$b_2||CUI.ScriptUtility.isNullOrUndefined($v_0)&&CUI.ScriptUtility.isNullOrUndefined(this.$b_2))return;this.$b_2=!CUI.ScriptUtility.isNullOrUndefined($v_0)?$v_0:null;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){$v_0.$AK_0(true);$p0==="Popup"&&this.$79_2.$AK_0(true)}this.$16_0()},get_selectedLayout:function(){return this.$b_2},ensureCorrectChildType:function($p0){if(!CUI.Layout.isInstanceOfType($p0)&&!CUI.GroupPopupLayout.isInstanceOfType($p0))throw Error.create("Only children of type Layout can be added to Groups");if(!CUI.ScriptUtility.isNullOrUndefined(this.getChildByTitle($p0.get_title())))throw Error.create("A Layout with title "+$p0.get_title()+" already exists in this Group.")},get_$A4_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$b_2)||CUI.ScriptUtility.isNullOrUndefined(this.$b_2.get_$2_0()))return false;return this.get_$2_0().offsetHeight<this.$b_2.get_$2_0().offsetHeight||this.get_$2_0().offsetWidth<this.$b_2.get_$2_0().offsetWidth},$17_2:null,get_command:function(){return this.$17_2},$8v_2:null,get_popupLayoutTitle:function(){return this.$8v_2},set_popupLayoutTitle:function($p0){if($p0==="Popup")throw Error.create("PopupLayoutTitle cannot be set to 'Popup'");var $v_0=CUI.ScriptUtility.isNullOrUndefined($p0)?null:this.getChildByTitle($p0);if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("This Group does not have a Layout with Title: "+$p0);if(this.$8v_2===$p0)return $p0;this.$8v_2=$p0;!CUI.ScriptUtility.isNullOrUndefined(this.$5y_2)&&this.$5y_2.set_layoutTitle($p0);return $p0},$5z_2:null,$4q_2:null,$5y_2:null,$79_2:null,$8w_2:null,$FG_2:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$5z_2))return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_popupLayoutTitle()))throw Error.create("No PopupLayoutTitle has been set.");this.$5z_2=this.get_ribbon().$Eu_2(this.$4_0+"-Popup",this);this.$79_2=this.get_ribbon().$Bk_1(this.$4_0+"-popupMenu",null,null,null);this.$8w_2=this.get_ribbon().$Bl_1(this.$4_0+"-popupMenuSection",null,null,false,null,null);var $v_0={};$v_0.LabelText=this.get_title();var $v_1=this.get_ribbon().get_ribbonProperties();if(!CUI.ScriptUtility.isNullOrUndefined(this.$5_2.Image32by32Popup)){$v_0.Image32by32=this.$5_2.Image32by32Popup;$v_0.Image32by32Class=this.$5_2.Image32by32PopupClass;$v_0.Image32by32Top=this.$5_2.Image32by32PopupTop;$v_0.Image32by32Left=this.$5_2.Image32by32PopupLeft}else{$v_0.Image32by32=$v_1.Image32by32GroupPopupDefault;$v_0.Image32by32Class=$v_1.Image32by32GroupPopupDefaultClass;$v_0.Image32by32Left=$v_1.Image32by32GroupPopupDefaultLeft;$v_0.Image32by32Top=$v_1.Image32by32GroupPopupDefaultTop}$v_0.Command=this.$17_2;this.$4q_2=new CUI.Controls.FlyoutAnchor(this.get_ribbon(),this.$4_0+"-PopupAnchor",$v_0,this.$79_2);this.$4q_2.$8P_2=true;this.$4q_2.set_enabled(this.get_enabled());this.$5y_2=this.get_ribbon().$Et_2(this.$4_0+"-popupMenuItem",this);this.$5z_2.addChild(this.$4q_2.createComponentForDisplayMode("Large"));this.$79_2.addChild(this.$8w_2);this.$8w_2.addChild(this.$5y_2);this.$5y_2.set_layoutTitle(this.get_popupLayoutTitle());this.addChild(this.$5z_2)},$5D_0:function(){this.set_enabled(CUI.ScriptUtility.isNullOrUndefined(this.$17_2)?true:this.get_ribbon().$6F_1(this.$17_2,null,null));if(!this.get_enabled()||CUI.ScriptUtility.isNullOrUndefined(this.$b_2))return;this.$b_2.$5D_0()},onEnabledChanged:function($p0){CUI.Component.prototype.onEnabledChanged.call(this,$p0);!CUI.ScriptUtility.isNullOrUndefined(this.$4q_2)&&this.$4q_2.set_enabled($p0)},$AO_0:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$b_2)&&CUI.GroupPopupLayout.isInstanceOfType(this.$b_2)){this.$b_2.get_$2_0().getElementsByTagName("A")[0].focus();return true}return CUI.Component.prototype.$AO_0.call(this)}};CUI.GroupPopup=function($p0,$p1,$p2){this.$$d_$Gt_1=Function.createDelegate(this,this.$Gt_1);CUI.GroupPopup.initializeBase(this,[$p0,$p1,"",""]);this.$5h_1=$p2};CUI.GroupPopup.prototype={$5h_1:null,$F_1:null,$e_1:null,$26_0:function(){this.ensureDOMElementAndEmpty();if(CUI.ScriptUtility.isNullOrUndefined(this.$F_1)){this.$F_1=CUI.Utility.$3("div");this.$F_1.className="ms-cui-groupTitle"}else this.$F_1=CUI.Utility.removeChildNodes(this.$F_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$e_1)){this.$e_1=CUI.Utility.$3("div");this.$e_1.className="ms-cui-groupBody"}else this.$e_1=CUI.Utility.removeChildNodes(this.$e_1);CUI.UIUtility.setInnerText(this.$F_1,this.$5h_1.get_title());this.get_$2_0().appendChild(this.$e_1);this.get_$2_0().appendChild(this.$F_1);var $v_0=this.$5h_1.getChildByTitle(this.$5r_1);if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("Cannot find Layout with title: "+this.$5r_1+" for this GroupPopup to use from the Group with id: "+this.$5h_1.$4_0);var $v_1=$v_0.$64_2(true);this.removeChildren();this.addChild($v_1);this.appendChildrenToElement(this.$e_1);CUI.Component.prototype.$26_0.call(this)},$5r_1:null,get_layoutTitle:function(){return this.$5r_1},set_layoutTitle:function($p0){if(this.$5r_1===$p0)return $p0;this.$5r_1=$p0;this.$16_0();return $p0},get_cssClass:function(){return "ms-cui-groupPopup"},$5M_1:null,$3W_0:function($p0){if($p0.$I_1===4){var $v_0=$p0.get_sourceControl();if(this.$5M_1)return CUI.Component.prototype.$3W_0.call(this,$p0);this.$5M_1=$v_0;this.$I9_1()}else if($p0.$I_1===10){this.$GL_1();this.$5M_1=null}return CUI.Component.prototype.$3W_0.call(this,$p0)},$4T_1:null,$6p_1:false,$I9_1:function(){if(this.$6p_1)return;if(!this.$4T_1){this.$4T_1=CUI.Utility.$Bh();$addHandler(this.$4T_1,"click",this.$$d_$Gt_1);this.get_$2_0().appendChild(this.$4T_1)}this.$4T_1.style.display="";this.$6p_1=true},$GL_1:function(){if(!this.$6p_1)return;this.$4T_1.style.display="none";this.$6p_1=false},$Gt_1:function($p0){this.$5M_1&&this.$5M_1.$52_1()}};CUI.GroupPopupLayout=function($p0,$p1,$p2){CUI.GroupPopupLayout.initializeBase(this,[$p0,$p1,"Popup"]);this.$5h_3=$p2};CUI.GroupPopupLayout.prototype={$5h_3:null,$26_0:function(){CUI.Layout.prototype.$26_0.call(this)},get_cssClass:function(){return null},ensureCorrectChildType:function($p0){if(!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Only ControlComponents can be added to GroupPopupLayout.");if(this.$6_0.$S_0>0)throw Error.create("GroupPopupLayouts can only have one child")}};CUI.Layout=function($p0,$p1,$p2){CUI.Layout.initializeBase(this,[$p0,$p1,$p2,""])};CUI.Layout.prototype={$26_0:function(){this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},$7R_0:function(){this.get_needsDelayIniting()&&this.doDelayedInit();this.set_$2_0($get(this.$P_0.$4_0+"-"+this.get_title()))},ensureCorrectChildType:function($p0){if(!CUI.Section.isInstanceOfType($p0))throw Error.create("Only children of Section can be added to a Layout")},get_cssClass:function(){return "ms-cui-layout"},$64_2:function($p0){this.get_needsDelayIniting()&&this.doDelayedInit();var $v_0=this.get_ribbon().$Bj_2("clonedLayout-"+this.get_ribbon().$2c_1(),this.get_title());if(!$p0)return $v_0;var $$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current(),$v_2=$v_1.$64_2($p0);$v_0.addChild($v_2)}return $v_0},get_visibleInDOM:function(){if(CUI.Group.isInstanceOfType(this.$P_0)){var $v_0=this.$P_0;return $v_0.$b_2===this}else if(CUI.GroupPopup.isInstanceOfType(this.$P_0))return true;else return false}};CUI.RibbonEventCommandProperties=function(){CUI.RibbonEventCommandProperties.initializeBase(this)};CUI.RibbonEventCommandProperties.prototype={Minimized:false,Maximized:false};CUI.CommandContextSwitchCommandProperties=function(){};CUI.CommandContextSwitchCommandProperties.prototype={OldContextId:null,OldContextCommand:null,NewContextId:null,NewContextCommand:null,ChangedByUser:false};CUI.Ribbon=function($p0,$p1){this.$$d_$H0_2=Function.createDelegate(this,this.$H0_2);this.$$d_$HI_2=Function.createDelegate(this,this.$HI_2);this.$$d_$H1_2=Function.createDelegate(this,this.$H1_2);this.$$d_$HR_2=Function.createDelegate(this,this.$HR_2);this.$8a_2=new Date(0);this.$9I_2=CUI.Utility.$47();this.$9H_2=CUI.Utility.$57();CUI.Ribbon.initializeBase(this,[$p0,$p1]);this.$1A_2={};this.$Av_2=$p1.ShortcutKeyJumpToRibbon_Ctrl+$p1.ShortcutKeyJumpToRibbon_Alt+$p1.ShortcutKeyJumpToRibbon_Shift+$p1.ShortcutKeyJumpToRibbon_AccessKey;this.$Au_2=$p1.ShortcutKeyJumpToFirstControl_Ctrl+$p1.ShortcutKeyJumpToFirstControl_Alt+$p1.ShortcutKeyJumpToFirstControl_Shift+$p1.ShortcutKeyJumpToFirstControl_AccessKey;this.$3o_2=this.$CN_2()};CUI.Ribbon.prototype={$B_2:null,$3t_2:null,$2A_2:null,$j_2:null,$k_2:null,$13_2:null,$Am_2:null,$u_2:null,$3j_2:null,$r_2:null,$3B_2:null,$B2_2:null,$2B_2:null,$2C_2:null,$11_2:null,$12_2:null,$5x_2:false,$3C_2:null,$5l_2:null,$Au_2:null,$Av_2:null,$5v_2:null,$9J_2:false,$72_2:null,$73_2:null,$71_2:null,$8I_2:false,$8k_2:null,get_storedFocus:function(){return this.$3C_2},set_storedFocus:function(value){this.$3C_2=value;return value},$AS_2:function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return false;else if(!CUI.ScriptUtility.isNullOrUndefined($p0.id)&&$p0.id==="Ribbon")return false;else if($p0.tagName==="BODY")return true;else return this.$AS_2($p0.parentNode)},refresh:function(){this.$26_0();CUI.Root.prototype.refresh.call(this);this.$4F_2()},$26_0:function(){CUI.Root.prototype.$26_0.call(this);this.$24_0();this.$GD_2();var $v_0=null,$v_1=null,$v_2=null,$v_3=null,$v_4=null;CUI.Utility.removeChildNodesSlow(this.$13_2);var $$dict_5=this.$1A_2;for(var $$key_6 in $$dict_5){var $v_B={key:$$key_6,value:$$dict_5[$$key_6]},$v_C=$v_B.value;$v_C.$FJ_0()}var $v_5=0,$v_6=new CUI.List,$$enum_B=this.$6_0.getEnumerator();while($$enum_B.moveNext()){var $v_D=$$enum_B.get_current();if($v_D.get_visible()){$v_6.add($v_D);$v_5++}}var $v_7=0,$v_8=$v_6.$S_0,$v_9=!(CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonProperties().ATTabPositionText)||CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonProperties().ATContextualTabText)),$$enum_G=$v_6.getEnumerator();while($$enum_G.moveNext()){var $v_E=$$enum_G.get_current();$v_E.$9X_2();if(CUI.ScriptUtility.isNullOrUndefined($v_1)){$v_1=$v_E;this.$5l_2=$v_1.$4_0}$v_E.$Hs_2();if($v_E.$1K_2){if(!$v_3||$v_E.$19_2!==$v_3){if($v_E.$19_2!==$v_3)!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2.$1K_2&&CUI.Utility.ensureCSSClassOnElement($v_2.$F_2,"ms-cui-ct-last");$v_3=$v_E.$19_2;$v_4=this.$1A_2[$v_E.$19_2];CUI.Utility.removeCSSClassFromElement($v_4.get_$2_0(),"ms-cui-cg-s");this.$AI_2(0);this.$13_2.appendChild($v_4.get_$2_0());CUI.Utility.ensureCSSClassOnElement($v_E.$F_2,"ms-cui-ct-first")}$v_4.$E0_0($v_E.$F_2)}else{if($v_3){CUI.Utility.ensureCSSClassOnElement($v_2.$F_2,"ms-cui-ct-last");$v_3=null;$v_4=null}if($v_9){$v_7++;$v_E.$DS_2(this.get_ribbonProperties().ATTabPositionText,null,null,$v_7,$v_8)}this.$13_2.appendChild($v_E.$F_2)}if($v_E===this.$B_2)$v_0=$v_E;$v_2=$v_E}if($v_3){CUI.Utility.ensureCSSClassOnElement($v_2.$F_2,"ms-cui-ct-last");$v_2=null;$v_3=null;$v_4=null}var $v_A=1;if($v_9)for(var $v_F=0;$v_F<$v_5;$v_F++){var $v_G=$v_6.get_item($v_F);if($v_G.$1K_2){if($v_G.$19_2!==$v_3){$v_3=$v_G.$19_2;$v_4=this.$1A_2[$v_G.$19_2];$v_A=1}$v_G.$Bt_2();$v_G.$DS_2(this.get_ribbonProperties().ATTabPositionText,this.get_ribbonProperties().ATContextualTabText,$v_4.$1k_0,$v_A,$v_4.$3O_0);$v_A++}}if(!CUI.ScriptUtility.isNullOrUndefined($v_0))if($v_0.$1K_2){var $v_H=this.$9h_2($v_0.$19_2);CUI.Utility.ensureCSSClassOnElement($v_H.get_$2_0(),"ms-cui-cg-s");this.$AI_2($v_H.$4O_0)}if(CUI.ScriptUtility.isNullOrUndefined($v_0)&&!this.$2U_2){$v_0=!CUI.ScriptUtility.isNullOrUndefined(this.$8c_2)?this.$8c_2:$v_1;this.$7g_2($v_0)}if(this.$2U_2)$v_0=null;this.$IJ_2();if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){$v_0.get_$DG_0()&&CUI.Utility.disableElement(this.$r_2);var $v_I=this.$r_2.className.indexOf("ms-cui-disabled")!==-1;this.$r_2.className=$v_0.$G2_2()+($v_I?" ms-cui-disabled":"")}this.$W_0();this.$l_0=false;if(this.$8h_2&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().RootEventCommand)){var $v_J=new CUI.RibbonEventCommandProperties;$v_J.RootId=this.$4_0;$v_J.RootType="Ribbon";$v_J.Minimized=this.get_minimized();$v_J.Maximized=!this.get_minimized();this.raiseCommandEvent(this.get_ribbonProperties().RootEventCommand,11,$v_J);this.$8h_2=false}},$50_0:function($p0){this.$7R_0();this.$W_0();this.$l_0=false;var $v_0=this.$6_0;if($p0)if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){var $$enum_2=$v_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if(!$v_1.get_visible())continue;if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&this.$B_2===$v_1)this.$B_2.$50_0($p0);else{$v_1.$BL_2();$v_1.$BM_2()}}}if(!CUI.ScriptUtility.isNullOrUndefined(this.$1A_2)){var $$dict_4=this.$1A_2;for(var $$key_5 in $$dict_4){var $v_2={key:$$key_5,value:$$dict_4[$$key_5]};$v_2.value.$E7_0()}}},$7R_0:function(){CUI.Component.prototype.$7R_0.call(this);var $v_0=this.get_$2_0().childNodes;this.$Am_2=$get("cui-"+this.$4_0+"-scrollCurtain");this.$3B_2=$v_0[0];this.$2A_2=$v_0[1];this.$j_2=this.$2A_2.childNodes[0];this.$k_2=this.$2A_2.childNodes[1];this.$u_2=this.$k_2.childNodes[0];if($v_0.length>2)this.$r_2=$v_0[2];this.$3j_2=CUI.Utility.$7X(this.$j_2,"ms-cui-qat-container");this.$13_2=CUI.Utility.$7X(this.$k_2,"ms-cui-tts");if(CUI.ScriptUtility.isNullOrUndefined(this.$13_2))this.$13_2=CUI.Utility.$7X(this.$k_2,"ms-cui-tts-scale-1");if(CUI.ScriptUtility.isNullOrUndefined(this.$13_2))this.$13_2=CUI.Utility.$7X(this.$k_2,"ms-cui-tts-scale-2")},$W_0:function(){this.$5v_2=this.$$d_$HR_2;this.set_$6K_2(true);this.$72_2=this.$$d_$H1_2;this.$73_2=this.$$d_$HI_2;this.$71_2=this.$$d_$H0_2;if(!this.$8I_2){$addHandler(this.get_$2_0(),"keydown",this.$73_2);$addHandler(document,"keydown",this.$72_2);$addHandler(this.get_$2_0(),"keydown",this.$71_2);this.$8I_2=true}CUI.Component.prototype.$W_0.call(this)},get_$6K_2:function(){return this.$9J_2},set_$6K_2:function($p0){if($p0===this.$9J_2)return $p0;if($p0)$addHandler(window,"resize",this.$5v_2);else try{$removeHandler(window,"resize",this.$5v_2)}catch($$e_1){}this.$9J_2=$p0;return $p0},$H1_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined($p0.rawEvent)){var $v_0=$p0.rawEvent.keyCode,$v_1=$p0.ctrlKey?"t":"f";$v_1+=$p0.altKey?"t":"f";$v_1+=$p0.shiftKey?"t":"f";try{$v_1+=String.fromCharCode(_processKeyCodes($v_0))}catch($$e_3){return}var $v_2=$p0.target;if($v_1===this.$Au_2){this.$BZ_2();this.jumpToLastFocused($v_2)}else if($v_1===this.$Av_2){this.$BZ_2();this.jumpToRibbonTab($v_2)}}},$BZ_2:function(){if(!CUI.ScriptUtility.isNullOrUndefined(document.selection)&&document.selection.type==="Control"){for(var $v_0=document.selection.createRange(),$v_1=$v_0.length;$v_1>0;$v_1--)$v_0.remove($v_1-1);$v_0.select()}},jumpToLastFocused:function(currentElement){this.$2E_1&&this.$0_0.$51_1();if(this.$AS_2(currentElement))this.$3C_2=currentElement;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$s_1())){try{this.setFocus()}catch($$e_1){}return}this.setFocusOnRibbon()},jumpToRibbonTab:function(currentElement){if(this.$AS_2(currentElement))this.$3C_2=currentElement;this.$2E_1&&this.$0_0.$51_1();if(!CUI.ScriptUtility.isNullOrEmptyString(this.$5l_2)){var $v_0=$get(this.$5l_2+"-title");!CUI.ScriptUtility.isNullOrUndefined($v_0)&&$v_0.firstChild.focus()}},setFocusOnTabTitle:function(){if(!CUI.ScriptUtility.isNullOrEmptyString(this.$5l_2)){var $v_0=$get(this.$5l_2+"-title");!CUI.ScriptUtility.isNullOrUndefined($v_0)&&$v_0.firstChild.focus()}},$H0_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined($p0.rawEvent)){var $v_0=$p0.rawEvent.keyCode;if(($p0.ctrlKey||$p0.shiftKey)&&($v_0===39&&!this.$0_0._textDirection)||$v_0===37&&this.$0_0._textDirection===1){$p0.preventDefault();$p0.stopPropagation();this.$B_2.$Cn_2(true)}else if(($p0.ctrlKey||$p0.shiftKey)&&($v_0===37&&!this.$0_0._textDirection)||$v_0===39&&this.$0_0._textDirection===1){$p0.preventDefault();$p0.stopPropagation();this.$B_2.$Cn_2(false)}}},setFocusOnRibbon:function(){if(this.$2U_2)this.setFocusOnTabTitle();else this.$B_2.$DW_2()},setFocusOnCurrentTab:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2))this.$B_2.$I3_2();else this.setFocusOnRibbon()},setFocus:function(){(this.$2U_2||!CUI.Root.prototype.setFocus.call(this))&&this.setFocusOnTabTitle();return true},$HI_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined($p0.rawEvent)&&!this.$2E_1)if($p0.rawEvent.keyCode===27&&!CUI.ScriptUtility.isNullOrUndefined(this.$3C_2)){$p0.stopPropagation();$p0.preventDefault();try{this.$3C_2.focus()}catch($$e_1){}this.$3C_2=null}},$1A_2:null,addContextualGroup:function(id,title,color,command){var $v_0=this.$1A_2[id];if(!CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("A contextual group with id: "+id+" has already been added to this ribbon.");$v_0=new CUI.ContextualGroup(id,title,color,command);this.$1A_2[id]=$v_0},get_contextualGroupIds:function(){var $v_0=[],$$dict_1=this.$1A_2;for(var $$key_2 in $$dict_1){var $v_1={key:$$key_2,value:$$dict_1[$$key_2]};Array.add($v_0,$v_1.key)}return $v_0},removeContextualGroup:function(id){var $v_0=this.$1A_2[id];if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){var $$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$1K_2&&$v_1.$19_2===id)throw Error.create("You cannot remove a contextual group when there are Tabs that refer to it.")}delete this.$1A_2[id]}},showContextualGroup:function(id){this.$AR_2(id,true)},hideContextualGroup:function(id){this.$AR_2(id,false)},$AR_2:function($p0,$p1){var $v_0=this.$1A_2[$p0];if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("This ribbon does not contain a contextual group with id: "+$p0);var $v_1=false,$$enum_4=this.$6_0.getEnumerator();while($$enum_4.moveNext()){var $v_2=$$enum_4.get_current();if($v_2.$19_2===$p0){if($v_2.get_visible()!==$p1)$v_1=true;$v_2.set_$7u_0($p1)}}$v_1&&this.$16_0()},$9h_2:function($p0){return this.$1A_2[$p0]},addChildAtIndex:function(child,index){this.ensureCorrectChildType(child);var $v_0=child;if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("child must not be null or undefined.");if($v_0.$1K_2){var $v_1=this.$1A_2[$v_0.$19_2];if(CUI.ScriptUtility.isNullOrUndefined($v_1))throw Error.create("A contextual tab with contextual group id: "+$v_0.$19_2+" cannot be added because  the ribbon does not have a contextual group with this id.")}CUI.Component.prototype.addChildAtIndex.call(this,child,index)},ensureCorrectChildType:function(child){if(!CUI.Tab.isInstanceOfType(child))throw Error.create("Only children of type Tab can be added to a Ribbon")},get_cssClass:function(){return "ms-cui-ribbon"},get_rootType:function(){return "Ribbon"},$Bu_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$u_2)){this.$u_2=CUI.Utility.$3("div");this.$u_2.id="jewelcontainer";this.$u_2.className="ms-cui-jewel-container";this.$u_2.style.display="none";this.$k_2.appendChild(this.$u_2)}},$FH_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$3j_2)){this.$3j_2=CUI.Utility.$3("span");this.$3j_2.className="ms-cui-qat-container";this.$j_2.appendChild(this.$3j_2)}},$BP_2:function($p0,$p1,$p2){var $v_0=new CUI.QATBuildOptions;$v_0.attachToDOM=$p1;$v_0.trimmedIds=this.get_$31_2().$z_0.trimmedIds;var $v_1=new CUI.QATBuilder($v_0,this.$3j_2,this.get_$31_2().$1i_0);$v_1.$10_0=$p2;if(!$v_1.buildQAT($p0))throw Error.create("QAT could not be built");this._qat=$v_1.get_QAT();this.$j_2.style.display="block"},$BO_2:function($p0,$p1,$p2){this.$u_2.style.display="block";var $v_0=new CUI.JewelBuildOptions;$v_0.attachToDOM=$p1;$v_0.trimmedIds=this.get_$31_2().$z_0.trimmedIds;var $v_1=new CUI.JewelBuilder($v_0,this.$u_2,this.get_$31_2().$1i_0);$v_1.$10_0=$p2;if(!$v_1.buildJewel($p0))throw Error.create("Jewel could not be built");this._jewel=$v_1.get_jewel();this.$4g_2&&this.$4g_2.dispose();this.$4g_2=$v_1},_qat:null,get_QAT:function(){return this._qat},set_QAT:function(value){this._qat=value;return value},$4g_2:null,_jewel:null,get_jewel:function(){return this._jewel},set_jewel:function(value){this._jewel=value;return value},$Ez_2:function($p0,$p1,$p2,$p3,$p4){return new CUI.Tab(this,$p0,$p1,$p2,$p3,false,null,$p4)},$Ep_2:function($p0,$p1,$p2,$p3,$p4,$p5){return new CUI.Tab(this,$p0,$p1,$p2,$p3,true,$p4,$p5)},$Es_2:function($p0,$p1,$p2,$p3,$p4){return new CUI.Group(this,$p0,$p2,$p3,$p4,$p1)},$Et_2:function($p0,$p1){return new CUI.GroupPopup(this,$p0,$p1)},$Eu_2:function($p0,$p1){return new CUI.GroupPopupLayout(this,$p0,$p1)},$Bj_2:function($p0,$p1){return new CUI.Layout(this,$p0,$p1)},$2b_2:function($p0,$p1,$p2){return new CUI.Section(this,$p0,$p1,$p2)},$Bm_2:function($p0){return new CUI.Strip(this,$p0)},$8c_2:null,$IJ_2:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&this.$B_2.$24_0();if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&!this.$B_2.$1K_2)this.$8c_2=this.$B_2;if(CUI.ScriptUtility.isNullOrUndefined(this.$B_2)||!this.$B_2.$6_0.$S_0)!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&!CUI.ScriptUtility.isNullOrUndefined(this.$r_2)&&this.get_$2_0().lastChild===this.$r_2&&this.get_$2_0().removeChild(this.$r_2);else!CUI.ScriptUtility.isNullOrUndefined(this.$r_2)&&this.get_$2_0().appendChild(this.$r_2);if(CUI.ScriptUtility.isNullOrUndefined(this.$B_2))return;var $v_0=this.$B_2.$l_0;this.$B_2.$30_0();if(this.$B_2.$6_0.$S_0>0&&!CUI.ScriptUtility.isNullOrUndefined(this.$r_2)){var $v_1=false;if(this.$r_2.hasChildNodes()){$v_1=this.$r_2.firstChild===this.$B_2.get_$2_0();!$v_1&&this.$r_2.removeChild(this.$r_2.firstChild)}!$v_1&&this.$r_2.appendChild(this.$B_2.get_$2_0())}if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().TabSwitchCommand)&&this.$3t_2!==this.$B_2){var $v_2=new CUI.CommandContextSwitchCommandProperties;if(!CUI.ScriptUtility.isNullOrUndefined(this.$3t_2)&&this.$3t_2!==this.$B_2){$v_2.OldContextId=this.$3t_2.$4_0;$v_2.OldContextCommand=this.$3t_2.$17_2}else{$v_2.OldContextId=null;$v_2.OldContextCommand=null}if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)){$v_2.NewContextId=this.$B_2.$4_0;$v_2.NewContextCommand=this.$B_2.$17_2;$v_2.ChangedByUser=this.$B_2.$7C_2}this.raiseCommandEvent(this.get_ribbonProperties().TabSwitchCommand,2,$v_2);this.$IK_2(this.$B_2)}if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)){this.$B_2.$7C_2=false;this.$B_2.$1H_2&&this.$B_2.$DW_2()}},$7g_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)){this.$16_0();$p0.$AQ_2(true,false);!$p0.$1K_2&&this.$AI_2(0);!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&this.$B_2!==$p0&&this.$B_2.$AQ_2(false,false);this.$B_2=$p0;this.set_$5B_2(false)}this.set_$s_1(null)},$IK_2:function($p0){this.$3t_2=$p0},selectTabById:function(tabId){var $v_0=this.getChild(tabId);if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){if($v_0.get_selected()&&$v_0.get_visible())return true;$v_0.$1K_2&&!$v_0.get_visible()&&this.showContextualGroup($v_0.$19_2);if($v_0.get_visible()){$v_0.set_selected(true);return true}}return false},selectTabByCommand:function(tabCommand){if(this.get_selectedTabCommand()===tabCommand)return true;var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();if($v_0.$17_2===tabCommand)return this.selectTabById($v_0.$4_0)}return false},$AI_2:function($p0){var $v_0=CUI.ContextualGroup.$7V($p0);if($v_0===""){CUI.Utility.removeCSSClassFromElement(this.$k_2,this.$4P_2);this.$4P_2=null}else{!this.$4P_2&&CUI.Utility.removeCSSClassFromElement(this.$k_2,this.$4P_2);this.$4P_2="ms-cui-ct-topBar-"+$v_0;CUI.Utility.ensureCSSClassOnElement(this.$k_2,this.$4P_2)}},$4P_2:null,get_selectedTabCommand:function(){return this.$B_2?this.$B_2.$17_2:null},get_selectedTabId:function(){return this.$B_2?this.$B_2.$4_0:null},$CM_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$B_2))return 0;return this.$r_2.offsetHeight-this.$B_2.get_$2_0().offsetHeight},$7Y_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$B_2))return 0;return this.$r_2.offsetWidth-this.$B_2.$G5_2()},$9n_2:function(){return this.get_$2_0().offsetWidth},$CI_2:function(){return 100},$CS_2:function(){this.$B2_2=this.get_$2_0().style.display;this.get_$2_0().style.display="none";return},$I8_2:function(){this.get_$2_0().style.display=this.$B2_2;if(this.$9n_2()<this.$CI_2()){this.get_$2_0().style.display="none";return}},$CN_2:function(){return CUI.Utility.$47().toString()+CUI.Utility.$57().toString()},$Hu_2:function($p0){var $v_0=20;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&!this.$B_2.$B6_2){var $v_6=null;if(this.get_useDataCookie())$v_6=this.getDataCookieValue(this.$B_2.$4_0);var $v_7=this.$3o_2;if(!CUI.ScriptUtility.isNullOrUndefined($v_6)&&$v_6.startsWith($v_7)){var $v_8=$v_6.split("|");if(!CUI.ScriptUtility.isNullOrUndefined($v_8)&&$v_8.length===4){var $v_9=parseInt($v_8[1]),$v_A=parseInt($v_8[2]),$v_B=$v_8[3];$v_0=$v_A>$v_0?$v_A:$v_0;if(!isNaN($v_9)&&$v_9>=0)if($v_9>=0&&$v_9<this.$B_2.get_scaling().$2H_0.length){this.$B_2.scaleIndex($v_9);this.$B_2.$B6_2=true;this.$26_0();if($v_B===this.get_$1I_1().get_ribbonBuildOptions().scalingHint){this.$B_2.$8b_2=this.$3o_2;return true}}}}}if(CUI.ScriptUtility.isNullOrUndefined(this.$B_2))return false;this.$B_2.$l_0&&this.$26_0();if($p0&&this.$9n_2()>0)if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))if(this.get_$2_0().style.display!=="none"&&this.$9n_2()<this.$CI_2())this.$CS_2();else this.get_$2_0().style.display==="none"&&this.$I8_2();var $v_1=0,$v_2=false;while((this.$7Y_2()<0||this.$CM_2()<0||this.$B_2.get_$A4_2())&&$v_1<25){if(!this.$B_2.scaleDown()){$v_2=true;break}this.$26_0();$v_1++}if($v_2);var $v_3=0,$v_4=0;if($v_1<=0)while(this.$7Y_2()>$v_0&&$v_3<25){if(!this.$B_2.scaleUp())break;this.$26_0();$v_3++;if(this.$7Y_2()<=0||this.$CM_2()<0||this.$B_2.get_$A4_2()){this.$B_2.scaleDown();this.$26_0();$v_4++;break}}this.get_useDataCookie()&&this.$B_2.$1U_2>=-1&&this.$IE_2();this.$B_2.$8b_2=this.$3o_2;this.$AF_2();var $v_5=$v_1>0||$v_3-$v_4>0;if($v_5)!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonProperties().ScaleCommand)&&this.raiseCommandEvent(this.get_ribbonProperties().ScaleCommand,1,null);return $v_5},$I7_2:function(){return this.$0_0._textDirection===1&&(CUI.Utility.$4A()||CUI.Utility.get_$7d())},$I5_2:function(){var $v_0=this.$BV_2(this.$13_2);this.$13_2.style.width=$v_0+"px";this.$13_2.setAttribute("_widthAdded",true)},$BV_2:function($p0){for(var $v_0=0,$v_1=$p0.children,$v_2=$v_1.length,$v_3=0;$v_3<$v_2;$v_3++){var $v_4=$v_1[$v_3];if(!CUI.ScriptUtility.isNullOrUndefined($v_4)&&$v_4.nodeName==="LI"&&$v_4.offsetWidth>0){var $v_5=$v_4.childNodes[1];if(!CUI.ScriptUtility.isNullOrUndefined($v_5)&&$v_5.nodeName==="UL"){var $v_6=this.$BV_2($v_5);$v_5.style.width=$v_6+"px";$v_0=$v_0+$v_6+4}else $v_0=$v_0+$v_4.offsetWidth+2}}return $v_0},$AF_2:function(){this.$I7_2()&&this.$I5_2();if(!CUI.ScriptUtility.isNullOrUndefined(window._ribbonScaleHeader))try{window._ribbonScaleHeader(this.$2A_2,this.$0_0._textDirection===1)}catch($v_0){if($v_0.number!==-2146827843)throw $v_0}},$4F_2:function(){if(this.$2U_2){this.$AF_2();return false}var $v_0=this.$Hu_2(false);this.$8a_2=new Date;return $v_0},$Ht_2:function($p0){!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&this.$B_2.$DI_2($p0)},$Do_2:true,get_$Gi_2:function(){return this.$8a_2.getTime()},$IE_2:function(){this.storeDataCookie(this.$B_2.$4_0,CUI.Utility.$47().toString()+CUI.Utility.$57().toString()+"|"+this.$B_2.$1U_2.toString()+"|"+this.$7Y_2().toString()+"|"+this.get_$1I_1().get_ribbonBuildOptions().scalingHint.toString())},$2U_2:false,$Du_2:false,$8h_2:false,get_minimized:function(){return this.$2U_2},set_minimized:function(value){if(this.$2U_2!==value){this.set_$5B_2(value);!value&&this.get_$6G_1()&&this.pollForStateAndUpdate()}return value},$Az_2:false,get_$5B_2:function(){return this.$2U_2},set_$5B_2:function($p0){if(this.$2U_2!==$p0||!this.$Az_2){this.$16_0();this.$Du_2=!$p0;this.$8h_2=true;this.$2U_2=$p0;this.$Az_2=true;if($p0&&!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)){this.$B_2.$AQ_2(false,false);this.$B_2=null}}return $p0},$5D_0:function(){this.set_$5A_0(new Date);this.$4H_1=false;var $v_0={},$$dict_1=this.$1A_2;for(var $$key_2 in $$dict_1){var $v_1={key:$$key_2,value:$$dict_1[$$key_2]},$v_2=$v_1.value,$v_3=false;if(!CUI.ScriptUtility.isNullOrUndefined($v_2.$17_0))$v_3=this.get_rootUser().isRootCommandEnabled($v_2.$17_0,this);if($v_3)$v_0[$v_1.key]=true;this.$AR_2($v_1.key,$v_3)}this._qat&&this._qat.pollForStateAndUpdate();this._jewel&&this._jewel.pollForStateAndUpdate();if(this.$l_0){this.$26_0();this.$AF_2()}!CUI.ScriptUtility.isNullOrUndefined(this.$B_2)&&this.$B_2.$5D_0();if(this.$4H_1){this.$4F_2();this.$4H_1=false}this.ensureGlobalDisablingRemoved()},$3W_0:function($p0){if($p0.$I_1!==11){$p0.get_commandInfo().RootLocation=$p0.$I_1===2?"UpperRibbon":"LowerRibbon";if($p0.$I_1===2){var $v_0=$p0.$3s_1;$p0.get_commandInfo().TabId=$v_0.NewContextId}}return CUI.Root.prototype.$3W_0.call(this,$p0)},get_jewelElement:function(){return this.$u_2},set_jewelElement:function(value){this.$u_2=value;return value},$8L_2:false,$3o_2:null,$HR_2:function($p0){if(this.get_$Bp_1())return;var $v_0=this.$CN_2();if(this.$3o_2===$v_0)return;this.$3o_2=$v_0;if(!this.$8L_2&&this.$Do_2&&this.$IM_2()){this.$Hr_2();this.$8L_2=true;this._componentWidth=this._componentHeight=-1;this.$51_1();this.$3R_1();var $v_1=this.$4F_2();$v_1&&this.pollForStateAndUpdate();this.$8L_2=false}},$IM_2:function(){return this.$9I_2!==CUI.Utility.$47()||this.$9H_2!==CUI.Utility.$57()},$Hr_2:function(){this.$9I_2=CUI.Utility.$47();this.$9H_2=CUI.Utility.$57()},get_ribbonProperties:function(){return this.$5_1},get_$31_2:function(){return this.get_$1I_1()},set_$31_2:function($p0){this.set_$1I_1($p0);return $p0},get_domElementTagName:function(){return "div"},$24_0:function(){CUI.Root.prototype.$24_0.call(this);this.get_$2_0().setAttribute("aria-describedby","ribboninstructions");this.get_$2_0().setAttribute("role","toolbar");this.$FL_2();this.$FM_2();this.$FH_2();this.$Bu_2();this.$FI_2();this.$FF_2();this.$Bu_2()},$FM_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$j_2)){this.$j_2=CUI.Utility.$3("div");this.$j_2.className="ms-cui-topBar1";this.$j_2.style.display="none";this.$2A_2.appendChild(this.$j_2)}if(CUI.ScriptUtility.isNullOrUndefined(this.$k_2)){this.$k_2=CUI.Utility.$3("div");this.$k_2.className="ms-cui-topBar2";this.$2A_2.appendChild(this.$k_2)}},$FL_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$3B_2)){this.$3B_2=CUI.Utility.$3("span");this.$3B_2.className="ms-cui-hidden";this.$3B_2.id="ribboninstruction";CUI.Utility.$3Y(this.$3B_2,this.$5_1.NavigationHelpText)}if(CUI.ScriptUtility.isNullOrUndefined(this.$2A_2)){this.$2A_2=CUI.Utility.$3("div");this.$2A_2.className="ms-cui-ribbonTopBars";this.get_$2_0().appendChild(this.$3B_2);this.get_$2_0().appendChild(this.$2A_2)}},$FI_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$r_2)){this.$r_2=CUI.Utility.$3("div");CUI.Utility.disableElement(this.$r_2)}},$FF_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$11_2))this.$11_2=$get(this.$33_1+"-QATRowCenter");if(CUI.ScriptUtility.isNullOrUndefined(this.$12_2))this.$12_2=$get(this.$33_1+"-QATRowRight");if(CUI.ScriptUtility.isNullOrUndefined(this.$2B_2))this.$2B_2=$get(this.$33_1+"-TabRowLeft");if(CUI.ScriptUtility.isNullOrUndefined(this.$2C_2))this.$2C_2=$get(this.$33_1+"-TabRowRight")},$GD_2:function(){if(!this.$5x_2&&!CUI.ScriptUtility.isNullOrUndefined(this.$11_2)&&this.$11_2.parentNode!==this.$j_2){this.$11_2.parentNode&&this.$11_2.parentNode.removeChild(this.$11_2);this.$j_2.appendChild(this.$11_2);this.$11_2.style.display="inline-block";this.$j_2.style.display="block";CUI.Utility.$2f(this.$11_2,true,false)}if(!this.$5x_2&&!CUI.ScriptUtility.isNullOrUndefined(this.$12_2)&&this.$12_2.parentNode!==this.$j_2){this.$12_2.parentNode&&this.$12_2.parentNode.removeChild(this.$12_2);this.$j_2.appendChild(this.$12_2);this.$12_2.style.display="inline-block";this.$j_2.style.display="block";CUI.Utility.$2f(this.$12_2,true,false)}if(!this.$5x_2&&!CUI.ScriptUtility.isNullOrUndefined(this.$2B_2)&&this.$2B_2.parentNode!==this.$k_2){this.$2B_2.parentNode&&this.$2B_2.parentNode.removeChild(this.$2B_2);this.$k_2.appendChild(this.$2B_2);this.$2B_2.style.display="block";CUI.Utility.$2f(this.$2B_2,true,false)}if(CUI.ScriptUtility.isNullOrUndefined(this.$13_2)){this.$13_2=CUI.Utility.$3("ul");this.$13_2.setAttribute("role","tablist");this.$13_2.className="ms-cui-tts";this.$k_2.appendChild(this.$13_2)}if(!this.$5x_2&&!CUI.ScriptUtility.isNullOrUndefined(this.$2C_2)&&this.$2C_2.parentNode!==this.$k_2){this.$2C_2.parentNode&&this.$2C_2.parentNode.removeChild(this.$2C_2);this.$k_2.appendChild(this.$2C_2);this.$2C_2.style.display="block";CUI.Utility.$2f(this.$2C_2,true,false)}this.$5x_2=true},ensureGlobalDisablingRemoved:function(){CUI.Utility.enableElement(this.$13_2);this.$Bv_2();this._jewel&&this._jewel.set_enabled(true);this._qat&&this._qat.pollForStateAndUpdate()},$Bv_2:function(){CUI.Utility.enableElement(this.$r_2)},get_rootUser:function(){return CUI.Root.prototype.get_rootUser.call(this)},set_rootUser:function(value){CUI.Root.prototype.set_rootUser.call(this,value);!CUI.ScriptUtility.isNullOrUndefined(this._qat)&&this._qat.set_rootUser(value);!CUI.ScriptUtility.isNullOrUndefined(this._jewel)&&this._jewel.set_rootUser(value);return value},dispose:function(){this.set_$Bp_1(true);var $v_0=this.$0_0;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){var $v_1=$v_0.$3P_1;!CUI.ScriptUtility.isNullOrUndefined($v_1)&&window.clearTimeout($v_1);$v_0.$3R_1()}if(!CUI.ScriptUtility.isNullOrUndefined(this.$5v_2)){this.set_$6K_2(false);this.$5v_2=null}if(this.$8k_2){$removeHandler(this.get_$2_0(),"contextmenu",this.$8k_2);this.$8k_2=null}if(this.$8I_2){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())){$removeHandler(this.get_$2_0(),"keydown",this.$73_2);this.$73_2=null;$removeHandler(this.get_$2_0(),"keydown",this.$71_2);this.$71_2=null}$removeHandler(document,"keydown",this.$72_2);this.$72_2=null}CUI.Root.prototype.dispose.call(this);this.$3t_2=null;this.$B_2=null;this.$2A_2=null;this.$13_2=null;this.$u_2=null;this.$r_2=null;this.$2B_2=null;this.$2C_2=null;this.$3j_2=null;this.$11_2=null;this.$12_2=null;this.$j_2=null;this.$k_2=null;this.$3B_2=null;this.$Am_2=null;this.$3C_2=null;var $$dict_2=this.$1A_2;for(var $$key_3 in $$dict_2){var $v_2={key:$$key_3,value:$$dict_2[$$key_3]},$v_3=$v_2.value;$v_3.dispose()}this.$1A_2=null;if(this.$4g_2){this.$4g_2.dispose();this.$4g_2=null}}};CUI.RibbonCommand=function(){};CUI.RibbonCommand.$CK=function($p0){var $v_0=window._v_rg_spbutton;if($v_0){var $v_1=$v_0[$p0];if($v_1){var $v_2=$get($v_1);return $v_2}}return null};CUI.RibbonCommand.serverButton=function(srcId,menuItemId){var $v_0=CUI.RibbonCommand.$CK(srcId);if($v_0){var $v_1=$v_0;if(CUI.BrowserUtility.$Cb())if($v_0.tagName!=="A")CUI.NativeUtility.ffClick($v_0);else window.location.href=$v_1.href;else $v_0.click()}};CUI.RibbonCommand.serverQueryButton=function(srcId){var $v_0=CUI.RibbonCommand.$CK(srcId);return !!$v_0};CUI.RibbonCommand.serverControlLabel=function(ribbonCommand){var $v_0=window._v_rg_spbutton;if($v_0){var $v_1=$v_0[ribbonCommand];if($v_1){var $v_2=$get($v_1);return $v_2.value}}return null};CUI.RibbonBuildContext=function(){CUI.RibbonBuildContext.initializeBase(this)};CUI.RibbonBuildContext.prototype={clone:function(){var $v_0=new CUI.RibbonBuildContext;$v_0.initializedTab=this.initializedTab;$v_0.initialScalingIndex=this.initialScalingIndex;$v_0.initialTabId=this.initialTabId;$v_0.ribbon=this.ribbon;return $v_0},initializedTab:null,initialTabId:null,initialScalingIndex:0,ribbon:null};CUI.RibbonBuildOptions=function(){this.initialScalingIndex=-1;CUI.RibbonBuildOptions.initializeBase(this)};CUI.RibbonBuildOptions.prototype={lazyTabInit:false,shallowTabs:false,showQATId:null,showJewelId:null,minimized:false,shownTabs:null,shownContextualGroups:null,initiallyVisibleContextualGroups:null,normalizedContextualGroups:null,trimEmptyGroups:false,initialTabSelectedByUser:false,launchedByKeyboard:false,scalingHint:"0"};CUI.RibbonBuilder=function(options,elmPlaceholder,rootBuildClient){this.$$d_$HG_1=Function.createDelegate(this,this.$HG_1);this.$$d_$F3_1=Function.createDelegate(this,this.$F3_1);this.$$d_$Cy_1=Function.createDelegate(this,this.$Cy_1);CUI.RibbonBuilder.initializeBase(this,[options,elmPlaceholder,rootBuildClient]);if(CUI.ScriptUtility.isNullOrUndefined(elmPlaceholder))throw Error.create("Ribbon placeholder DOM element is null or undefined.")};CUI.RibbonBuilder.prototype={get_ribbon:function(){return this.$0_0},set_ribbon:function(value){this.$0_0=value;return value},get_ribbonBuildOptions:function(){return this.$z_0},buildRibbonAndInitialTab:function(initialTabId){if(CUI.ScriptUtility.isNullOrUndefined(initialTabId))throw Error.create("Initial tab for ribbon is null or undefined");if(this.$3E_0)return false;var $v_0=new CUI.RibbonBuildContext;$v_0.initialTabId=initialTabId;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().attachToDOM)&&this.get_ribbonBuildOptions().attachToDOM)$v_0.initialScalingIndex=this.get_ribbonBuildOptions().initialScalingIndex;this.$3E_0=true;var $v_1=new CUI.DataQuery;$v_1.id=$v_0.initialTabId;$v_1.queryType=2;$v_1.handler=this.$$d_$Cy_1;$v_1.data=$v_0;this.$10_0.runQuery($v_1);return true},buildRibbonFromData:function(dataNode,initialTabId){var $v_0=new CUI.RibbonBuildContext;$v_0.initialTabId=initialTabId;var $v_1=new CUI.DataQueryResult;$v_1.success=true;$v_1.queryData=dataNode;$v_1.contextData=$v_0;this.$Cy_1($v_1)},$Cy_1:function($p0){var $v_0=$p0.contextData;$p0.queryData=this.applyDataExtensions($p0.queryData);CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded");var $v_1=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.queryData,"Templates");!CUI.ScriptUtility.isNullOrUndefined($v_1)&&CUI.TemplateManager.get_instance().loadTemplates($v_1);this.set_ribbon(this.$ER_1($p0.queryData,$v_0));this.get_ribbon().set_$31_2(this);this.$1i_0.onComponentCreated(this.get_ribbon(),this.get_ribbon().$4_0);if(this.get_ribbonBuildOptions().minimized)this.get_ribbon().set_$5B_2(true);else{this.get_ribbon().set_$5B_2(false);var $v_3=this.get_ribbon().getChild($v_0.initialTabId);if(!CUI.ScriptUtility.isNullOrUndefined($v_3)){$v_3.$7C_2=this.get_ribbonBuildOptions().initialTabSelectedByUser;this.get_ribbon().$7g_2($v_3)}}this.get_ribbon().$33_1=this.get_ribbonBuildOptions().clientID;var $v_2=!this.get_ribbonBuildOptions().minimized&&this.get_ribbonBuildOptions().attachToDOM;if($v_2){!this.$z_0.minimized&&this.get_ribbon().$Ht_2($v_0.initialScalingIndex-1);this.get_ribbon().$50_0(true);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showQATId)&&this.get_ribbon().$BP_2(this.get_ribbonBuildOptions().showQATId,true,this.$10_0);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showJewelId)&&this.get_ribbon().$BO_2(this.get_ribbonBuildOptions().showJewelId,true,this.$10_0)}else{this.get_ribbon().$24_0();!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showQATId)&&this.get_ribbon().$BP_2(this.get_ribbonBuildOptions().showQATId,false,this.$10_0);!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbonBuildOptions().showJewelId)&&this.get_ribbon().$BO_2(this.get_ribbonBuildOptions().showJewelId,false,this.$10_0);CUI.Utility.removeChildNodesSlow(this._elmPlaceholder);this._elmPlaceholder.appendChild(this.get_ribbon().get_$2_0())}this.get_ribbon().$4F_2();this.$A3_0(this.get_ribbon());this.$1i_0.onComponentBuilt(this.get_ribbon(),this.get_ribbon().$4_0);this.get_ribbonBuildOptions().launchedByKeyboard&&this.get_ribbon().setFocusOnRibbon();CUI.PMetrics.perfMark(7104)},$HG_1:function($p0){var $v_0=$p0.contextData;if($p0.success){var $v_1=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.queryData,"Ribbon"),$v_2=CUI.DataNodeWrapper.getFirstChildNodeWithName($v_1,"Tabs"),$v_3=null;if(CUI.ScriptUtility.isNullOrUndefined($v_2)||!CUI.DataNodeWrapper.getNodeChildren($v_2).length)for(var $v_6=CUI.DataNodeWrapper.getFirstChildNodeWithName($v_1,"ContextualTabs"),$v_7=CUI.DataNodeWrapper.getNodeChildren($v_6),$v_8=0;$v_8<$v_7.length;$v_8++){var $v_9=$v_7[$v_8];$v_3=CUI.DataNodeWrapper.getNodeChildren($v_9);if($v_3.length>0)break}else $v_3=CUI.DataNodeWrapper.getNodeChildren($v_2);var $v_4=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0.queryData,"Templates");$v_4=this.applyDataExtensions($v_4);CUI.TemplateManager.get_instance().loadTemplates($v_4);var $v_5=this.applyDataExtensions($v_3[0]);this.$9a_1($v_0.initializedTab,$v_5,$v_0);$v_0.initializedTab.get_ribbon().$7g_2($v_0.initializedTab);$v_0.initializedTab.$A1_0(true)}CUI.PMetrics.perfMark(7106)},$ER_1:function($p0,$p1){var $v_0=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Ribbon");if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("No ribbon element was present in the data");var $v_1=new CUI.DataNodeWrapper($v_0);this.set_ribbon(new CUI.Ribbon($v_1.get_attributes()["Id"],$v_1.get_attributes()));this.get_ribbon().set_useDataCookie(true);var $v_2=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($v_1.$a_0,"Tabs"));this.$BJ_1($v_2,null,$p1);var $v_3=CUI.DataNodeWrapper.getFirstChildNodeWithName($v_1.$a_0,"ContextualTabs");if(!CUI.ScriptUtility.isNullOrUndefined($v_3))for(var $v_4=CUI.DataNodeWrapper.getNodeChildren($v_3),$v_5=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownContextualGroups),$v_6=0;$v_6<$v_4.length;$v_6++){if($v_5){var $v_7=CUI.DataNodeWrapper.getNodeAttributes($v_4[$v_6])["Id"];if(!CUI.ScriptUtility.isNullOrUndefined($v_7))if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownContextualGroups[$v_7]))continue}this.$Dy_1($v_4[$v_6],$p1)}return this.get_ribbon()},$Dy_1:function($p0,$p1){var $v_0=CUI.DataNodeWrapper.getNodeAttributes($p0),$v_1=0,$v_2=$v_0["Id"],$v_3=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().normalizedContextualGroups)&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().normalizedContextualGroups[$v_2])&&this.get_ribbonBuildOptions().normalizedContextualGroups[$v_2];if(!$v_3){switch($v_0["Color"]){case "DarkBlue":$v_1=1;break;case "LightBlue":$v_1=2;break;case "Magenta":$v_1=6;break;case "Green":$v_1=5;break;case "Orange":$v_1=4;break;case "Purple":$v_1=8;break;case "Teal":$v_1=3;break;case "Yellow":$v_1=7;break;default:$v_1=0;break}this.get_ribbon().addContextualGroup($v_2,$v_0["Title"],$v_1,$v_0["Command"])}var $v_4=CUI.DataNodeWrapper.getNodeChildren($p0);if(!$v_3)for(var $v_5=0;$v_5<$v_4.length;$v_5++){var $v_6=CUI.DataNodeWrapper.getNodeAttribute($v_4[$v_5],"Id");if($v_6===$p1.initialTabId){if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().initiallyVisibleContextualGroups))this.get_ribbonBuildOptions().initiallyVisibleContextualGroups={};this.get_ribbonBuildOptions().initiallyVisibleContextualGroups[$v_2]=true;break}}this.$BJ_1($v_4,$v_3?null:$v_0["Id"],$p1)},$BJ_1:function($p0,$p1,$p2){for(var $v_0=!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownTabs),$v_1=0;$v_1<$p0.length;$v_1++){if($v_0){var $v_3=CUI.DataNodeWrapper.getNodeAttributes($p0[$v_1])["Id"];if(!CUI.ScriptUtility.isNullOrUndefined($v_3))if(CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().shownTabs[$v_3]))continue}var $v_2=this.$EV_1($p0[$v_1],$p2,$p1);this.get_ribbon().addChild($v_2)}},$EV_1:function($p0,$p1,$p2){var $v_0=new CUI.DataNodeWrapper($p0),$v_1;if(CUI.ScriptUtility.isNullOrUndefined($p2))$v_1=this.get_ribbon().$Ez_2($v_0.get_attributes()["Id"],$v_0.get_attributes()["Title"],$v_0.get_attributes()["Description"],$v_0.get_attributes()["Command"],$v_0.get_attributes()["CssClass"]);else{$v_1=this.get_ribbon().$Ep_2($v_0.get_attributes()["Id"],$v_0.get_attributes()["Title"],$v_0.get_attributes()["Description"],$v_0.get_attributes()["Command"],$p2,$v_0.get_attributes()["CssClass"]);!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbonBuildOptions().initiallyVisibleContextualGroups)&&this.get_ribbonBuildOptions().initiallyVisibleContextualGroups[$p2]&&$v_1.set_$7u_0(true)}if(!$v_0.get_children().length)$v_1.$AJ_0(this.$$d_$F3_1,$v_0.$a_0,$p1.clone());else this.$9a_1($v_1,$p0,$p1);return $v_1},$9a_1:function($p0,$p1,$p2){for(var $v_0=CUI.DataNodeWrapper.getFirstChildNodeWithName($p1,"Groups"),$v_1=CUI.DataNodeWrapper.getNodeChildren($v_0),$v_2={},$v_7=0;$v_7<$v_1.length;$v_7++){if(this.isNodeTrimmed($v_1[$v_7]))continue;var $v_8=this.$EI_1($v_1[$v_7],$p2);if(!CUI.ScriptUtility.isNullOrUndefined($v_8))$p0.addChild($v_8);else{var $v_9=CUI.DataNodeWrapper.getNodeAttribute($v_1[$v_7],"Id");if(!CUI.ScriptUtility.isNullOrUndefined($v_9))$v_2[$v_9]=$v_9}}for(var $v_3=CUI.DataNodeWrapper.getFirstChildNodeWithName($p1,"Scaling"),$v_4=CUI.DataNodeWrapper.getNodeChildren($v_3),$v_5=null,$v_6=false,$v_A=0;$v_A<$v_4.length;$v_A++){var $v_B=CUI.DataNodeWrapper.getNodeName($v_4[$v_A]),$v_C=CUI.DataNodeWrapper.getNodeAttributes($v_4[$v_A]),$v_D=$v_C["GroupId"];if($v_B==="MaxSize"){if(this.isIdTrimmed($v_D)||!CUI.ScriptUtility.isNullOrUndefined($v_2[$v_D]))continue;$p0.get_scaling().setGroupMaxSize($v_D,$v_C["Size"])}else if($v_B==="Scale"){if(this.isIdTrimmed($v_D)||!CUI.ScriptUtility.isNullOrUndefined($v_2[$v_D]))continue;$p0.get_scaling().addScalingStep(new CUI.ScalingStep($v_D,$v_C["Size"],$v_C["PopupSize"],$v_5,$v_6));$v_5=null;$v_6=false}else if($v_B==="LowScaleWarning"){$v_5=$v_C["Message"];$v_6=true}else throw Error.create("Was expecting a node with name MaxSize or Scale.")}$p0.scaleMax()},$F3_1:function($p0,$p1,$p2){var $v_0=$p2,$v_1=$p0,$v_2=new CUI.DataNodeWrapper($p1);$v_0.initializedTab=$p0;if(!$v_2.get_hasChildren()){var $v_3=new CUI.DataQuery;$v_3.id=$v_0.initializedTab.$4_0;$v_3.queryType=4;$v_3.handler=this.$$d_$HG_1;$v_3.data=$v_0;this.$10_0.runQuery($v_3);return null}this.$9a_1($v_1,$p1,$v_0);$v_1.$A1_0(true);this.get_ribbon().refresh();return $v_1},$EI_1:function($p0,$p1){var $v_0=new CUI.DataNodeWrapper($p0),$v_1=$v_0.get_attributes()["Template"],$v_2=CUI.TemplateManager.get_instance().getTemplate($v_1);if(CUI.ScriptUtility.isNullOrUndefined($v_2))throw Error.create("A template with name: "+$v_1+" could not be loaded.");for(var $v_3={},$v_4=null,$v_8=0;$v_8<$v_0.get_children().length;$v_8++)if($v_0.get_children()[$v_8].name==="Controls"){$v_4=$v_0.get_children()[$v_8];break}if(CUI.ScriptUtility.isNullOrUndefined($v_4))throw Error.create("No Controls node found in this Group tag.");for(var $v_5=CUI.DataNodeWrapper.getNodeChildren($v_4),$v_6=true,$v_9=0;$v_9<$v_5.length;$v_9++){if(this.isNodeTrimmed($v_5[$v_9]))continue;$v_6=false;var $v_A=this.$23_0($v_5[$v_9],$p1),$v_B=$v_3[$v_A.get_templateAlias()];if(CUI.ScriptUtility.isNullOrUndefined($v_B))$v_3[$v_A.get_templateAlias()]=$v_A;else if(Array.isInstanceOfType($v_B))Array.add($v_B,$v_A);else{var $v_C=[];Array.add($v_C,$v_B);Array.add($v_C,$v_A);$v_3[$v_A.get_templateAlias()]=$v_C}}if(this.get_ribbonBuildOptions().trimEmptyGroups&&$v_6)return null;var $v_7=$v_2.createGroup(this.get_ribbon(),$v_0.get_attributes()["Id"],$v_0.get_attributes(),$v_0.get_attributes()["Title"],$v_0.get_attributes()["Description"],$v_0.get_attributes()["Command"],$v_3,null);return $v_7}};CUI.RibbonComponent=function($p0,$p1,$p2,$p3){CUI.RibbonComponent.initializeBase(this,[$p0,$p1,$p2,$p3])};CUI.RibbonComponent.prototype={get_ribbon:function(){return this.$0_0}};CUI.Row=function($p0,$p1){CUI.Row.initializeBase(this,[$p0,$p1,"",""])};CUI.Row.prototype={$26_0:function(){this.ensureDOMElementAndEmpty();CUI.Component.prototype.appendChildrenToElement.call(this,this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},$7R_0:function(){this.set_$2_0($get(this.$P_0.$4_0+"-"+this.$P_0.$6_0.indexOf(this)))},ensureCorrectChildType:function($p0){if(!CUI.Strip.isInstanceOfType($p0)&&!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Only children of type Strip and ControlComponent can be added to Row Components.")},get_domElementTagName:function(){return "span"},get_cssClass:function(){var $v_0=this.$P_0.$I_2;if($v_0===2)return "ms-cui-row-onerow";else return "ms-cui-row"}};CUI.ScalingStep=function($p0,$p1,$p2,$p3,$p4){if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p1))throw Error.create("groupId, layoutName and message cannot be undefined or null");this.$2r_0=$p0;this.$6w_0=$p1;this.$8x_0=$p2;this.$B7_0=$p3;this.$BE_0=$p4};CUI.ScalingStep.prototype={$2r_0:null,$6w_0:null,$8x_0:null,$B7_0:null,$BE_0:false,$2G_0:null,$DV_0:function($p0){this.$2G_0=$p0},get_groupId:function(){return this.$2r_0},get_layoutName:function(){return this.$6w_0},get_popupSize:function(){return this.$8x_0},get_scaleWarningMessage:function(){return this.$B7_0},get_hasScaleWarning:function(){return this.$BE_0},get_previousLayoutName:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$2G_0))return null;for(var $v_0=this.$2G_0.getGroupMaxSize(this.$2r_0),$v_1=this.$2G_0.$2H_0,$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];if($v_3===this)break;if($v_3.$2r_0===this.$2r_0)$v_0=$v_3.$6w_0}return $v_0}};CUI.Scaling=function(){this.$5s_0={};this.$2H_0=[]};CUI.Scaling.prototype={$5s_0:null,$2H_0:null,setGroupMaxSize:function($p0,$p1){this.$5s_0[$p0]=$p1;this.$l_0=true},removeGroupMaxSize:function($p0){delete this.$5s_0[$p0];this.$l_0=true},getGroupMaxSize:function($p0){return this.$5s_0[$p0]},addScalingStep:function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))throw Error.create("step must be definined and not null");if(CUI.ScriptUtility.isNullOrUndefined(this.$5s_0[$p0.$2r_0]))throw Error.create("You must set the GroupMaxSize of Group: "+$p0.$2r_0+" before you add ScalingSteps for it");this.addScalingStepAtIndex($p0,this.$2H_0.length)},addScalingStepAtIndex:function($p0,$p1){if(Array.contains(this.$2H_0,$p0))throw Error.create("This ScalingInfo already contains this ScaleStep");Array.insert(this.$2H_0,$p1,$p0);$p0.$DV_0(this);this.$l_0=true},removeScalingStep:function($p0){Array.remove(this.$2H_0,$p0);$p0.$DV_0(null);this.$l_0=true},get_steps:function(){return Array.clone(this.$2H_0)},get_stepsInternal:function(){return this.$2H_0},$l_0:true};CUI.Section=function($p0,$p1,$p2,$p3){CUI.Section.initializeBase(this,[$p0,$p1,"",""]);this.$I_2=$p2;this.$1b_2=$p3;switch($p2){case 4:this.$42_0(new CUI.Row($p0,$p1+"-0"),false);this.$42_0(new CUI.Row($p0,$p1+"-1"),false);this.$42_0(new CUI.Row($p0,$p1+"-2"),false);break;case 3:this.$42_0(new CUI.Row($p0,$p1+"-0"),false);this.$42_0(new CUI.Row($p0,$p1+"-1"),false);break;case 2:this.$42_0(new CUI.Row($p0,$p1+"-0"),false);break;case 1:break;default:throw Error.create("Invalid SectionType")}};CUI.Section.prototype={$I_2:0,$1b_2:0,$26_0:function(){this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$2_0());this.$24_0();if(this.$I_2!==1){var $v_0=this.$6_0;this.$9K_2($v_0,1);(this.$I_2===3||this.$I_2===4)&&this.$9K_2($v_0,2);this.$I_2===4&&this.$9K_2($v_0,3)}this.$l_0=false},$7R_0:function(){this.set_$2_0($get(this.$P_0.$4_0+"-"+this.$P_0.$6_0.indexOf(this).toString()))},$9K_2:function($p0,$p1){var $v_0=$p0.get_item($p1-1);$v_0.$24_0();if(this.$I_2===3)$v_0.get_$2_0().className="ms-cui-row-tworow";this.get_$2_0().appendChild($v_0.get_$2_0());$v_0.$30_0()},get_cssClass:function(){if(this.$1b_2===2)return "ms-cui-section-alignmiddle";else return "ms-cui-section"},get_type:function(){return this.$I_2},get_alignment:function(){return this.$1b_2},removeChild:function($p0){throw Error.create("Cannot directly add and remove children from Section Components")},addChildAtIndex:function($p0,$p1){throw Error.create("Cannot directly add and remove children from Section Components")},getRow:function($p0){switch(this.$I_2){case 4:if($p0<1||$p0>3)throw Error.create("This Section type only has Row numbers 1, 2 and 3.");break;case 3:if($p0<1||$p0>2)throw Error.create("This Section type only has Row numbers 1 and 2");break;case 2:if($p0!==1)throw Error.create("This Section type only has Row number 1.");break;default:throw Error.create("This Section type does not have any rows")}return this.$6_0.get_item($p0-1)},$24_0:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))return;if(this.$I_2===1){var $v_0=CUI.Utility.$3("span");$v_0.className="ms-cui-section-divider";this.set_$2_0($v_0);return}CUI.Component.prototype.$24_0.call(this)},ensureCorrectChildType:function($p0){var $v_0=this.$6_0.$S_0;if(this.$I_2===2&&$v_0>0||this.$I_2===3&&$v_0>1||this.$I_2===4&&$v_0>2)throw Error.create("No more children can be added to a Section of this type.");if(this.$I_2===1)throw Error.create("Cannot add child components to Divider Section types.");if(!CUI.Row.isInstanceOfType($p0))throw Error.create("Only children of type Row can be added to Section Components.")},$64_2:function($p0){var $v_0=this.get_ribbon().$2b_2("clonedSection-"+this.get_ribbon().$2c_1(),this.$I_2,this.$1b_2);if(!$p0)return $v_0;var $v_1=0,$$enum_3=this.$6_0.getEnumerator();while($$enum_3.moveNext()){var $v_2=$$enum_3.get_current(),$$enum_5=$v_2.$6_0.getEnumerator();while($$enum_5.moveNext()){var $v_3=$$enum_5.get_current(),$v_4=null;if(CUI.ControlComponent.isInstanceOfType($v_3)){var $v_5=$v_3;$v_4=$v_5.$64_1($p0)}else if(CUI.Strip.isInstanceOfType($v_3))$v_4=$v_3.$64_2($p0);$v_0.getRow($v_1+1).addChild($v_4)}$v_1++}return $v_0},get_domElementTagName:function(){return "span"}};CUI.Strip=function($p0,$p1){CUI.Strip.initializeBase(this,[$p0,$p1,"",""])};CUI.Strip.prototype={$26_0:function(){this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},$7R_0:function(){this.set_$2_0($get(this.$P_0.$4_0+"-"+this.$P_0.$6_0.indexOf(this)))},ensureCorrectChildType:function($p0){if(!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Only children of type Control can be added to Strips.")},get_cssClass:function(){return "ms-cui-strip"},$64_2:function($p0){var $v_0=this.get_ribbon().$Bm_2("clonedStrip-"+this.get_ribbon().$2c_1());if(!$p0)return $v_0;var $$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();$v_0.addChild($v_1.$64_1($p0))}return $v_0}};CUI.Tab=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){this.$$d_$Di_2=Function.createDelegate(this,this.$Di_2);this.$$d_$HN_2=Function.createDelegate(this,this.$HN_2);this.$$d_$D0_2=Function.createDelegate(this,this.$D0_2);this.$$d_$HM_2=Function.createDelegate(this,this.$HM_2);CUI.Tab.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$1U_2=-1;this.$2G_2=new CUI.Scaling;this.$1K_2=$p5;this.$19_2=$p6;this.$17_2=$p4;this.$Af_2=CUI.ScriptUtility.isNullOrUndefined($p7)?"":$p7;$p5&&this.set_$7u_0(false)};CUI.Tab.prototype={$7B_2:false,$F_2:null,$w_2:null,$4Z_2:null,$37_2:null,$1U_2:0,$Af_2:null,$1K_2:false,$19_2:null,$26_0:function(){this.ensureDOMElementAndEmpty();this.$9X_2();this.appendChildrenToElement(this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},$BL_2:function(){this.$F_2=$get(this.$4_0+"-title");this.$w_2=this.$F_2.childNodes[0];this.$4Z_2=this.$w_2.childNodes[0];this.$37_2=this.$w_2.childNodes[1]},$BM_2:function(){$addHandler(this.$w_2,"dblclick",this.$$d_$HM_2);$addHandler(this.$w_2,"click",this.$$d_$D0_2);$addHandler(this.$w_2,"keypress",this.$$d_$HN_2)},$7R_0:function(){CUI.Component.prototype.$7R_0.call(this);this.$BL_2()},$W_0:function(){CUI.Component.prototype.$W_0.call(this);this.$BM_2()},$24_0:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))return;CUI.Component.prototype.$24_0.call(this);this.get_$2_0().setAttribute("role","tabpanel");this.get_$2_0().setAttribute("aria-labelledby",this.$4_0+"-title")},get_domElementTagName:function(){return "ul"},$FK_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$F_2))this.$F_2=CUI.Utility.$3("li")},$Bt_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$37_2))this.$37_2=CUI.Utility.$3("span")},$9X_2:function(){var $v_0=" ";if(CUI.ScriptUtility.isNullOrUndefined(this.$w_2)){this.$FK_2();this.$w_2=CUI.Utility.$3("a");CUI.Utility.$2J(this.$w_2);this.$w_2.className="ms-cui-tt-a";this.$4Z_2=CUI.Utility.$3("span");this.$4Z_2.className="ms-cui-tt-span";this.$F_2.appendChild(this.$w_2);this.$w_2.appendChild(this.$4Z_2);this.$W_0()}else{$v_0+=this.$F_2.className.indexOf("ms-cui-ct-first")>-1?"ms-cui-ct-first ":"";$v_0+=this.$F_2.className.indexOf("ms-cui-ct-last")>-1?"ms-cui-ct-last":"";$v_0=$v_0.trimEnd()}this.$F_2.className=this.$CL_2()+$v_0;this.$F_2.id=this.$4_0+"-title";this.$F_2.setAttribute("role","tab");this.$F_2.setAttribute("aria-selected",this.$7B_2);CUI.UIUtility.setInnerText(this.$4Z_2,this.get_title());this.$F_2.title=this.get_title();if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_description()))this.$w_2.setAttribute("title",this.get_description());else this.$w_2.setAttribute("title",this.get_title())},$DS_2:function($p0,$p1,$p2,$p3,$p4){CUI.ScriptUtility.isNullOrUndefined(this.$37_2)&&this.$Bt_2();if(this.$1K_2)$p1=String.format($p1,$p2,$p3,$p4);else $p1=String.format($p0,$p3,$p4);CUI.UIUtility.setInnerText(this.$37_2,$p1);CUI.Utility.ensureCSSClassOnElement(this.$37_2,"ms-cui-hidden");this.$w_2.appendChild(this.$37_2)},$Hs_2:function(){this.$F_2.className=this.$CL_2()},get_cssClass:function(){return this.$Fz_2()},get_selected:function(){return this.$7B_2},set_selected:function($p0){if(!this.get_visible())throw Error.create("Tabs must be visible and enabled in order to be selected.");if($p0){if(this.get_needsDelayIniting()){this.doDelayedInit();return $p0}this.get_ribbon().$7g_2(this);this.get_ribbon().set_$5B_2(false);this.get_ribbon().$26_0();this.$8b_2!==this.get_ribbon().$3o_2&&this.get_ribbon().$4F_2();this.$D3_0();this.$1H_2=false}else throw Error.create("Selected cannot be set to false explicitly.\nSelecting another Tab will do this implicitly.");return $p0},$Ho_2:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon().get_$31_2())&&!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon().get_$31_2().get_ribbonBuildOptions())&&!CUI.ScriptUtility.isNullOrEmptyString(this.get_ribbon().get_$31_2().get_ribbonBuildOptions().clientID)){var $v_0=$get(this.get_ribbon().get_$31_2().get_ribbonBuildOptions().clientID+"_activeTabId");if($v_0)$v_0.value=this.$4_0}},$AQ_2:function($p0,$p1){$p0&&this.$Ho_2();this.$7B_2=$p0;this.$16_0();$p1&&this.$9X_2()},$A1_0:function($p0){CUI.Component.prototype.$A1_0.call(this,$p0);this.get_ribbon().$4F_2();this.get_ribbon().pollForStateAndUpdate()},ensureCorrectChildType:function($p0){if(!CUI.Group.isInstanceOfType($p0))throw Error.create("Only children of type Group can be added to Tab Components")},$2G_2:null,get_scaling:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$2G_2))this.$2G_2=new CUI.Scaling;return this.$2G_2},get_currentScalingIndex:function(){return this.$1U_2},$8b_2:null,scaleMax:function(){this.$AG_2();this.$16_0()},$AG_2:function(){var $$enum_0=this.$6_0.getEnumerator();while($$enum_0.moveNext()){var $v_0=$$enum_0.get_current();if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){var $v_1=this.$2G_2.getGroupMaxSize($v_0.$4_0);!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_0.selectLayout($v_1,null)}}this.$1U_2=-1},scaleIndex:function($p0){this.$DI_2($p0);this.$16_0()},$DI_2:function($p0){this.$AG_2();while($p0>this.$1U_2)if(!this.$DH_2())break},$Hv_2:function(){if(this.$1U_2===-2){this.$AG_2();return true}if(this.$1U_2===-1)return false;var $v_0=this.$2G_2.$2H_0,$v_1=$v_0[this.$1U_2],$v_2=this.getChild($v_1.$2r_0);!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2.selectLayout($v_1.get_previousLayoutName(),null);this.$1U_2--;return true},scaleUp:function(){var $v_0=this.$Hv_2();$v_0&&this.$16_0();return $v_0},$DH_2:function(){if(this.$1U_2===-2){this.scaleMax();return true}var $v_0=this.$2G_2.$2H_0;if($v_0.length<=this.$1U_2+1)return false;this.$1U_2++;var $v_1=$v_0[this.$1U_2],$v_2=this.getChild($v_1.$2r_0);!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2.selectLayout($v_1.$6w_0,$v_1.$8x_0);return true},scaleDown:function(){var $v_0=this.$DH_2();$v_0&&this.$16_0();return $v_0},$B6_2:false,$G5_2:function(){for(var $v_0=0,$v_1=this.get_$2_0().childNodes,$v_2=0;$v_2<$v_1.length;$v_2++)$v_0+=$v_1[$v_2].offsetWidth;return $v_0},get_contextual:function(){return this.$1K_2},get_contextualGroupId:function(){return this.$19_2},$7C_2:false,$1H_2:false,$HN_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined($p0.rawEvent)){var $v_0=$p0.rawEvent.keyCode;if($v_0===13){this.$1H_2=true;$p0.stopPropagation();this.$D0_2($p0)}}},$D0_2:function($p0){CUI.PMetrics.perfMark(7105);$p0.preventDefault();this.$96_2=true;if(this.get_selected())window.setTimeout(this.$$d_$Di_2,500);else this.$Di_2()},$96_2:true,$Di_2:function(){if(!this.$96_2)return;this.$7C_2=true;this.get_ribbon().$Bs_1();this.set_selected(true);this.get_ribbon().$3R_1();this.get_ribbon().set_$s_1(null);CUI.PMetrics.perfMark(7107)},$Cn_2:function($p0){var $v_0=document.activeElement,$v_1=this.$C0_2($v_0),$v_2=this.$6_0.$S_0,$v_3,$v_4=0,$$enum_6=this.$6_0.getEnumerator();while($$enum_6.moveNext()){var $v_6=$$enum_6.get_current();if($v_6.$4_0===$v_1)break;$v_4++}var $v_5;if($p0)$v_5=($v_4+1)%$v_2;else $v_5=$v_4-1;if($v_5<0)$v_5=$v_2+$v_5;while($v_5!==$v_4){$v_3=this.$6_0.get_item($v_5);if($v_3.$AO_0())return;if($p0)$v_5=($v_5+1)%$v_2;else $v_5=$v_5-1;if($v_5<0)$v_5=$v_2+$v_5}},$C0_2:function($p0){if($p0.nodeName==="LI")return $p0.id;else return this.$C0_2($p0.parentNode)},$DW_2:function(){var $v_0=false,$$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_1=$$enum_1.get_current();if($v_1.$AO_0()){$v_0=true;return}}!$v_0&&this.$w_2.focus()},$I3_2:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$w_2)&&this.$w_2.focus()},$HM_2:function($p0){this.$96_2=false;$p0.preventDefault();this.get_ribbon().set_$5B_2(true);this.get_ribbon().$26_0()},get_$A4_2:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0().lastChild)){var $v_0=CUI.Utility.$CD(this.get_$2_0().lastChild);if(this.$0_0._textDirection!==1&&CUI.Utility.$47()<=$v_0.width+$v_0.x)return true}var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_1=$$enum_1.get_current();if($v_1.get_$A4_2())return true}return false},$CL_2:function(){var $v_0="ms-cui-tt "+this.$Af_2;if(this.$7B_2)$v_0+=" ms-cui-tt-s";return $v_0},$Fz_2:function(){var $v_0="ms-cui-tabBody";if(this.$1K_2)$v_0+=" ms-cui-tabBody-"+CUI.ContextualGroup.$7V(this.get_ribbon().$9h_2(this.$19_2).$4O_0);return $v_0},$G2_2:function(){var $v_0="ms-cui-tabContainer";if(this.$1K_2)$v_0+=" ms-cui-tabContainer-"+CUI.ContextualGroup.$7V(this.get_ribbon().$9h_2(this.$19_2).$4O_0);return $v_0},get_visible:function(){return CUI.Component.prototype.get_visible.call(this)},set_visible:function($p0){if(this.$1K_2)throw Error.create("Visibility of Contextual Tabs cannot be set explicitly.");CUI.Component.prototype.set_visible.call(this,$p0);return $p0},$17_2:null,get_command:function(){return this.$17_2},$3W_0:function($p0){$p0.get_commandInfo().TabId=this.$4_0;return CUI.Component.prototype.$3W_0.call(this,$p0)},$5D_0:function(){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.$17_2)?true:this.get_ribbon().$6F_1(this.$17_2,null,null);this.set_enabled($v_0);if($v_0){this.set_$5A_0(new Date);CUI.Component.prototype.$5D_0.call(this)}this.get_ribbon().$Bv_2()},dispose:function(){CUI.Component.prototype.dispose.call(this);CUI.Utility.$AA(this.$F_2);this.$37_2=null;this.$F_2=null;this.$w_2=null;this.$4Z_2=null}};CUI.Template=function(){};CUI.TemplateManager=function(){this.$4w_0={}};CUI.TemplateManager.get_instance=function(){if(CUI.ScriptUtility.isNullOrUndefined(CUI.TemplateManager.$6s))CUI.TemplateManager.$6s=new CUI.TemplateManager;return CUI.TemplateManager.$6s};CUI.TemplateManager.prototype={$4w_0:null,addTemplate:function($p0,$p1){this.$4w_0[$p1]=$p0},removeTemplate:function($p0){this.$4w_0[$p0]=null},getTemplate:function($p0){return this.$4w_0[$p0]},loadTemplates:function($p0){for(var $v_0=new CUI.DataNodeWrapper($p0),$v_1=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"RibbonTemplates"),$v_2=CUI.DataNodeWrapper.getNodeChildren($v_1),$v_3=0;$v_3<$v_2.length;$v_3++)this.$Gj_0($v_2[$v_3])},$Gj_0:function($p0){var $v_0=new CUI.DataNodeWrapper($p0),$v_1=$v_0.get_attributes()["Id"],$v_2=$v_0.get_attributes()["Classname"];if(!CUI.ScriptUtility.isNullOrUndefined(this.$4w_0[$v_1]))return;if(CUI.ScriptUtility.isNullOrUndefined($v_2))this.$4w_0[$v_1]=new CUI.DeclarativeTemplate($p0)}};CUI.RootUser=function(){};CUI.RootProperties=function(){};CUI.RootProperties.prototype={RootEventCommand:null,ImageDownArrow:null,ImageDownArrowClass:null,ImageDownArrowTop:null,ImageDownArrowLeft:null,ImageSideArrow:null,ImageSideArrowClass:null,ImageSideArrowTop:null,ImageSideArrowLeft:null,ImageUpArrow:null,ImageUpArrowClass:null,ImageUpArrowTop:null,ImageUpArrowLeft:null,TextDirection:null,ToolTipFooterText:null,ToolTipFooterImage16by16:null,ToolTipFooterImage16by16Class:null,ToolTipFooterImage16by16Top:null,ToolTipFooterImage16by16Left:null,ToolTipDisabledCommandImage16by16:null,ToolTipDisabledCommandImage16by16Class:null,ToolTipDisabledCommandImage16by16Top:null,ToolTipDisabledCommandImage16by16Left:null,ToolTipDisabledCommandDescription:null,ToolTipDisabledCommandTitle:null,ToolTipDisabledCommandHelpKey:null,ToolTipHelpCommand:null,ToolTipSelectedItemTitlePrefix:null};CUI.RootEventCommandProperties=function(){};CUI.RootEventCommandProperties.prototype={RootId:null,RootType:null};CUI.Root=function($p0,$p1){this.$$d_$H6_1=Function.createDelegate(this,this.$H6_1);this.$$d_$H9_1=Function.createDelegate(this,this.$H9_1);this.$$d_$HA_1=Function.createDelegate(this,this.$HA_1);this.$$d_$H8_1=Function.createDelegate(this,this.$H8_1);this.$$d_onWindowScroll=Function.createDelegate(this,this.onWindowScroll);this.$$d_$A2_1=Function.createDelegate(this,this.$A2_1);this.$$d_$H7_1=Function.createDelegate(this,this.$H7_1);this.$3L_1=-1;this.$4p_1=-1;CUI.Root.initializeBase(this,[null,$p0,null,null]);this.initRootMember(this);this.$5_1=$p1;this.$q_1={};this.$Ae_1={};this.$Ac_1=0;this.$BC_1=0;if(!CUI.ScriptUtility.isNullOrUndefined($p1.TextDirection))this._textDirection=$p1.TextDirection.toLowerCase()==="rtl"?1:0;this.$8r_1=this.$$d_$H7_1;this.$2w_1=this.$$d_$A2_1;$addHandler(document,"keydown",this.$8r_1);$addHandler(window,"unload",this.$2w_1)};CUI.Root.$1X=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0))return 0;return $p0[$p1]};CUI.Root.prototype={$q_1:null,$Ae_1:null,$Ac_1:0,$BC_1:0,$B5_1:false,$8Z_1:null,$Aw_1:null,_textDirection:0,$33_1:null,$As_1:true,get_initializing:function(){return this.$As_1},get_$s_1:function(){return this.$8Z_1},set_$s_1:function($p0){if(!this.$2E_1)this.$8Z_1=$p0;return $p0},get_$59_1:function(){return this.$Aw_1},set_$59_1:function($p0){if(!this.$2E_1){this.$Aw_1=$p0;this.$8Z_1=$p0}return $p0},$Bs_1:function(){!CUI.ScriptUtility.isNullOrUndefined(this.get_$s_1())&&this.get_$s_1().$Ed_0()},$Hn_1:function($p0){this.$Ae_1[$p0.$4_0]=$p0},$26_0:function(){CUI.Component.prototype.$26_0.call(this);this.$As_1=false;if(!this.$B5_1){this.$8u_1=this.$$d_onWindowScroll;$addHandler(window,"scroll",this.$8u_1);this.$B5_1=true}},$24_0:function(){CUI.Component.prototype.$24_0.call(this);this._textDirection===1&&CUI.Utility.ensureCSSClassOnElement(this.get_$2_0(),"ms-cui-rtl")},setFocus:function(){var $v_0=this.get_$s_1();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;return $v_0.$AN_0()},restoreFocus:function(){var $v_0=this.get_$59_1();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;return $v_0.$AN_0()},$Dn_1:false,refresh:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$2Y_1)&&this.$2Y_1.onRootRefreshed(this)},attach:function(){this.$50_0(true)},$4H_1:false,get_needScaling:function(){return this.$4H_1},set_needScaling:function(value){this.$4H_1=value;return value},$2Y_1:null,get_rootUser:function(){return this.$2Y_1},set_rootUser:function(value){this.$2Y_1=value;return value},$4I_1:null,get_$1I_1:function(){return this.$4I_1},set_$1I_1:function($p0){this.$4I_1=$p0;return $p0},get_$6G_1:function(){return !CUI.ScriptUtility.isNullOrUndefined(this.$2Y_1)},$6F_1:function($p0,$p1,$p2){return (this.$D2_1($p0,$p1,$p2,false)&1)>0},$D2_1:function($p0,$p1,$p2,$p3){var $v_0=0,$v_1=this.$2Y_1.isRootCommandEnabled($p0,this);if($v_1)$v_0=1;if(CUI.ScriptUtility.isNullOrUndefined($p1)||!$p3&&!$v_1)return $v_0;if(this.$2Y_1.executeRootCommand($p1,$p2,null,this))$v_0|=2;return $v_0},pollForStateAndUpdate:function(){this.$5D_0()},$5D_0:function(){this.set_$5A_0(new Date);CUI.Component.prototype.$5D_0.call(this);this.ensureGlobalDisablingRemoved()},ensureGlobalDisablingRemoved:function(){CUI.Utility.enableElement(this.get_$2_0())},get_element:function(){return this.get_$2_0()},get_cssClass:function(){return "ms-cui-disabled"},get_textDirection:function(){return this._textDirection},$2c_1:function(){return this.$BC_1++},$Bl_1:function($p0,$p1,$p2,$p3,$p4,$p5){return new CUI.MenuSection(this,$p0,$p1,$p2,$p3,$p4,$p5)},$Bk_1:function($p0,$p1,$p2,$p3){return new CUI.Menu(this,$p0,$p1,$p2,$p3)},$Er_1:function($p0,$p1,$p2,$p3){return new CUI.Gallery(this,$p0,$p1,$p2,$p3)},$Eq_1:function($p0,$p1,$p2){return new CUI.ControlComponent(this,$p0,$p1,$p2)},$56_1:function($p0,$p1,$p2){return new CUI.MenuItem(this,$p0,$p1,$p2)},$Eo_1:function($p0,$p1,$p2,$p3){return new CUI.CommandEventArgs($p0,$p1,$p2,$p3)},$9Z_1:function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0.$4_1))return;$p0.$95_1=this.$G6_1();var $v_0=$p0.get_commandInfo();$v_0.CommandId=$p0.$4_1;$v_0.RootId=this.$4_0;$v_0.RootType=this.get_rootType();!CUI.ScriptUtility.isNullOrUndefined(this.$2Y_1)&&this.$2Y_1.executeRootCommand($p0.$4_1,$p0.$3s_1,$v_0,this)},$3W_0:function($p0){this.$9Z_1($p0);return true},get_rootType:function(){return "Root"},$G6_1:function(){return this.$Ac_1++},$c_1:null,$Dz_1:function($p0){if(CUI.ScriptUtility.isNullOrUndefined(this.$c_1))this.$c_1=[];Array.add(this.$c_1,$p0)},$7w_1:false,$3Q_1:function($p0){if(CUI.ScriptUtility.isNullOrUndefined(this.$c_1))return;this.$7w_1=true;var $v_0=Array.indexOf(this.$c_1,$p0);if($v_0>-1)for(var $v_1=this.$c_1.length-1;$v_1>=$v_0;$v_1--){this.$c_1[$v_1].$52_1();Array.removeAt(this.$c_1,$v_1)}else $p0.$52_1();this.$7w_1=false},$51_1:function(){if(this.$7w_1||CUI.ScriptUtility.isNullOrUndefined(this.$c_1))return;for(var $v_0=this.$c_1.length-1;$v_0>=0;$v_0--){this.$c_1[$v_0].$52_1();Array.removeAt(this.$c_1,$v_0)}},$41_1:null,$3R_1:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$41_1))return;this.$41_1.$d_0()},$3P_1:0,$4y_1:null,get_$7t_1:function(){if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&CUI.ScriptUtility.isNullOrUndefined(this.$4y_1)){this.$4y_1=CUI.Utility.$Bi();this.$4y_1.className="ms-cui-tooltip-backFrame";this.$4y_1.style.visibility="hidden";document.body.appendChild(this.$4y_1)}return this.$4y_1},$2E_1:false,$1N_1:null,$2v_1:null,$28_1:null,$E8_1:function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined(this.$2v_1))this.$2v_1=[];Array.add(this.$2v_1,$p0);this.$28_1=$p0;if(this.$2E_1)return false;var $v_0=this.get_$Cm_1();$v_0.style.visibility="hidden";document.body.appendChild($v_0);$v_0.style.visibility="visible";this.$2E_1=true;return true},$FB_1:function($p0){if($p0!==this.$28_1)return;if(!this.$2E_1)throw Error.create("Cannot end modal mode because the Ribbon is not in Modal Mode");Array.removeAt(this.$2v_1,this.$2v_1.length-1);this.$28_1=null;if(this.$2v_1.length>0)this.$28_1=this.$2v_1[this.$2v_1.length-1];CUI.ScriptUtility.isNullOrUndefined(this.$28_1)&&this.$FD_1()},$FD_1:function(){if(!this.$2E_1)return;if(!this.$2v_1.length){document.body.removeChild(this.get_$Cm_1());this.$2E_1=false;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){$clearHandlers(this.$1N_1);this.$1N_1=null}}},get_$Cm_1:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$1N_1)){this.$1N_1=CUI.Utility.$3("div");if(Sys.Browser.agent===Sys.Browser.InternetExplorer)this.$1N_1.className="ms-cui-modalDiv-ie";else this.$1N_1.className="ms-cui-modalDiv-ff";CUI.Utility.$2f(this.$1N_1,true,false);$addHandler(this.$1N_1,"click",this.$$d_$H8_1);$addHandler(this.$1N_1,"mouseover",this.$$d_$HA_1);$addHandler(this.$1N_1,"mouseout",this.$$d_$H9_1);$addHandler(this.$1N_1,"contextmenu",this.$$d_$H6_1)}return this.$1N_1},$8r_1:null,$2w_1:null,$8u_1:null,$H6_1:function($p0){this.$28_1.onModalContextMenu($p0)},$H8_1:function($p0){this.$28_1.onModalBodyClick($p0)},$HA_1:function($p0){this.$28_1.onModalBodyMouseOver($p0)},$H9_1:function($p0){!CUI.ScriptUtility.isNullOrUndefined(this.$28_1)&&this.$28_1.onModalBodyMouseOut($p0)},$H7_1:function($p0){if(!this.$2E_1)return;this.$28_1.onModalKeyPress($p0)},onWindowScroll:function(evt){this.$51_1();this.$3R_1()},$Fn_1:function(){this.$Bs_1()},$A2_1:function($p0){this.dispose()},dispose:function(){this.$89_1=true;!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&this.$Dn_1&&$removeHandler(this.get_$2_0(),"contextmenu",CUI.Utility.get_returnFalseHandler());try{$removeHandler(document,"keydown",this.$8r_1)}catch($$e_0){}try{$removeHandler(window,"scroll",this.$8u_1)}catch($$e_1){}$removeHandler(window,"unload",this.$2w_1);!CUI.ScriptUtility.isNullOrUndefined(this.$1N_1)&&$clearHandlers(this.$1N_1);this.$1N_1=null;this.$2Y_1=null;this.$4I_1=null;this.$5_1=null;CUI.Component.prototype.dispose.call(this)},$89_1:false,get_$Bp_1:function(){return this.$89_1},set_$Bp_1:function($p0){this.$89_1=$p0;return $p0},get_$Eh_0:function(){if(this._componentHeight===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentHeight=this.get_$2_0().offsetHeight;return this._componentHeight},get_$Ba_0:function(){if(this._componentTopPosition===-1&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0()))this._componentTopPosition=CUI.UIUtility.calculateOffsetTop(this.get_$2_0());return this._componentTopPosition},$6U_1:"",get_cookieDataVersion:function(){return this.$6U_1},set_cookieDataVersion:function(value){this.$6U_1=value;return value},$BD_1:false,get_useDataCookie:function(){return this.$BD_1},set_useDataCookie:function(value){this.$BD_1=false;return value},storeDataCookie:function(name,value){var $v_0=new Date;$v_0.setTime($v_0.getTime()+6.048e8);document.cookie=name+"="+this.$6U_1+value+"; expires="+$v_0.toDateString()+"; path=/"},getDataCookieValue:function(name){name=this.$6U_1+name;for(var $v_0=document.cookie.split(";"),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1].trimStart();if($v_2.startsWith(name))if($v_2.startsWith(name+"="))return $v_2.substring(name.length+1,$v_2.length)}return null},$5_1:null,$3l_1:false,$HX_1:function($p0,$p1){this.$Dj_1($p0,$p1,false)},$HY_1:function($p0,$p1){this.$Dj_1($p0,$p1,true)},$Dj_1:function($p0,$p1,$p2){if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p1))return;$p0.style.top="0px";$p0.style.left="0px";var $v_0=this.$9g_1($p0,$p1);this.$AL_1($p0,$v_0,$p2)},$AL_1:function($p0,$p1,$p2){var $v_0=false;if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p1))return;var $v_1,$v_2,$v_3=CUI.Root.$1X($p1,"launcherLeft"),$v_4=CUI.Root.$1X($p1,"launcherTop"),$v_5=CUI.Root.$1X($p1,"launcherWidth"),$v_6=CUI.Root.$1X($p1,"launcherHeight"),$v_7=CUI.Root.$1X($p1,"flyOutWidth"),$v_8=CUI.Root.$1X($p1,"flyOutHeight"),$v_9=CUI.Root.$1X($p1,"flyOutRealHeight"),$v_A=CUI.Root.$1X($p1,"viewportWidth"),$v_B=CUI.Root.$1X($p1,"viewportHeight"),$v_C=CUI.Root.$1X($p1,"viewableLeft"),$v_D=CUI.Root.$1X($p1,"viewableTop"),$v_E=!this.$0_0._textDirection,$v_F=false,$v_G=false,$v_H=$p0.getAttribute("mscui:scrollable"),$v_I=!CUI.ScriptUtility.isNullOrUndefined($v_H)&&$v_H==="true";if($p2){if($v_E){$v_1=$v_3+$v_5;$v_1+=2}else $v_1=$v_3-$v_7;$v_2=$v_4}else{if($v_E)$v_1=$v_3;else $v_1=$v_3+$v_5-$v_7;$v_2=$v_4+$v_6;var $v_J=$v_5>=2?$v_5-2:$v_5;if($v_J>$v_7)$v_7=$v_J;$p0.style.minWidth=$v_J+"px"}if(this.$3l_1){$v_2+=$v_D;$v_1+=$v_C}$p0.style.top=$v_2+"px";$p0.style.left=$v_1+"px";if($v_7<=$v_A)if($v_1+$v_7>$v_C+$v_A){if($p2&&$v_E&&$v_3-$v_7>$v_C)$v_1=$v_3-$v_7;else{$v_1=$v_C+$v_A-$v_7-5;$v_F=true}$v_0=true}else if($v_1<$v_C){if($p2&&!$v_E&&$v_3+$v_5+$v_7<$v_C+$v_A)$v_1=$v_3+$v_5;else{$v_1=$v_C+5;$v_G=true}$v_0=true}else $v_0=false;else if($v_E){$v_1=$v_C;$v_0=true}else{$v_1=$v_C+$v_A-$v_7;$v_0=true}if($v_0){$p0.style.left=$v_1+"px";$v_0=false}if($v_2+$v_9>$v_D+$v_B){var $v_K=$v_2,$v_L=$v_D+$v_B-$v_2;$v_2=$v_4-$v_9;if(this.$3l_1)$v_2+=$v_D;var $v_M=$v_4;if(!this.$3l_1)$v_M-=$v_D;$v_0=true;if($v_M<$v_9){var $v_N=$v_7+22;if($v_M<$v_L){$v_2=$v_K;$p0.style.maxHeight=$v_L-5+"px";if(!$v_I){$p0.style.overflowY="scroll";$p0.style.width=$v_N+"px"}if($v_F&&$v_E){$v_1-=27;$p0.style.left=$v_1+"px"}else if($v_G&&!$v_E){$v_1+=27;$p0.style.left=$v_1+"px"}$v_0=false}else{$p0.style.maxHeight=$v_M-5+"px";if(!$v_I){$p0.style.overflowY="scroll";$p0.style.width=$v_N+"px"}if($v_F&&$v_E){$v_1-=27;$p0.style.left=$v_1+"px"}else if($v_G&&!$v_E){$v_1+=27;$p0.style.left=$v_1+"px"}}!$v_I&&$p0.setAttribute("mscui:scrollable","true")}else if($v_I){$p0.style.maxHeight="none";$p0.style.overflowY="visible";$p0.style.width="auto";$p0.setAttribute("mscui:scrollable","false")}}else{if($v_I){$p0.style.maxHeight="none";$p0.style.overflowY="visible";$p0.style.width="auto";$p0.setAttribute("mscui:scrollable","false")}$v_0=false}if($v_0){$p0.style.top=$v_2+"px";$v_0=false}},$9g_1:function($p0,$p1){var $v_0={};if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p1))return $v_0;$v_0["launcherWidth"]=$p1.offsetWidth;$v_0["launcherHeight"]=$p1.offsetHeight;var $v_1=$p1.offsetTop,$v_2=$p1.offsetLeft;if(!CUI.ScriptUtility.isNullOrUndefined($p1.offsetParent))for(var $v_3=$p1.offsetParent;!CUI.ScriptUtility.isNullOrUndefined($v_3);$v_3=$v_3.offsetParent){$v_1+=$v_3.offsetTop;$v_2+=$v_3.offsetLeft}else{$v_1=$p1.offsetTop;$v_2=$p1.offsetLeft}if(!CUI.ScriptUtility.isNullOrUndefined($p1.parentNode)){for(var $v_4=0,$v_5=0,$v_6=$p1.parentNode;!CUI.ScriptUtility.isNullOrUndefined($v_6);$v_6=$v_6.parentNode){if($v_6.scrollTop>0)$v_4+=$v_6.scrollTop;if($v_6.scrollLeft>0)if($v_6===document.documentElement&&(CUI.Utility.$4A()||CUI.Utility.get_$7d())&&this.$0_0._textDirection===1)$v_5+=document.body.scrollLeft;else $v_5+=$v_6.scrollLeft}if($v_1>=$v_4)$v_1-=$v_4;if($v_2>=$v_5)$v_2-=$v_5}$v_0["launcherTop"]=$v_1;$v_0["launcherLeft"]=$v_2;if($p0){$v_0["flyOutWidth"]=$p0.offsetWidth;$v_0["flyOutHeight"]=$p0.offsetHeight;$v_0["flyOutRealHeight"]=$p0.scrollHeight;$v_0["viewportWidth"]=CUI.Utility.$47();$v_0["viewportHeight"]=CUI.Utility.$57();if(CUI.ScriptUtility.isNullOrUndefined($v_0["viewportWidth"])){$v_0["viewportWidth"]=document.documentElement.clientWidth;$v_0["viewportHeight"]=document.documentElement.clientHeight}if(CUI.ScriptUtility.isNullOrUndefined($v_0["viewportWidth"])){$v_0["viewportWidth"]=document.body.clientWidth;$v_0["viewportHeight"]=document.body.clientHeight}$v_0["viewableTop"]=document.documentElement.scrollTop;$v_0["viewableLeft"]=document.documentElement.scrollLeft;if(CUI.ScriptUtility.isNullOrUndefined($v_0["viewableTop"])){$v_0["viewableTop"]=window.pageYOffset;$v_0["viewableLeft"]=window.pageXOffset}if(CUI.ScriptUtility.isNullOrUndefined($v_0["viewableTop"])){$v_0["viewableTop"]=document.body.scrollTop;$v_0["viewableLeft"]=document.body.scrollLeft}if((CUI.Utility.$4A()||CUI.Utility.get_$7d())&&this.$0_0._textDirection===1)$v_0["viewableLeft"]=document.body.scrollLeft}return $v_0}};CUI.ButtonDock=function($p0,$p1,$p2){CUI.ButtonDock.initializeBase(this,[$p0,$p1,"",""]);this.$1b_1=$p2.Alignment};CUI.ButtonDock.prototype={$1b_1:null,$26_0:function(){this.ensureDOMElementAndEmpty();this.appendChildrenToElement(this.get_$2_0());CUI.Component.prototype.$26_0.call(this)},appendChildrenToElement:function($p0){var $$enum_1=this.$6_0.getEnumerator();while($$enum_1.moveNext()){var $v_0=$$enum_1.get_current();$v_0.$24_0();switch(this.$1b_1){case "Left":CUI.Utility.ensureCSSClassOnElement($v_0.get_$2_0(),"ms-cui-toolbar-button-left");break;case "Center":CUI.Utility.ensureCSSClassOnElement($v_0.get_$2_0(),"ms-cui-toolbar-button-center");break;case "Right":CUI.Utility.ensureCSSClassOnElement($v_0.get_$2_0(),"ms-cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.$1b_1)}$p0.appendChild($v_0.get_$2_0());$v_0.$30_0()}},ensureCorrectChildType:function($p0){if(!CUI.ControlComponent.isInstanceOfType($p0))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")},get_cssClass:function(){switch(this.$1b_1){case "Left":return "ms-cui-toolbar-buttondock alignleft";case "Center":return "ms-cui-toolbar-buttondock aligncenter";case "Right":return "ms-cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.$1b_1)}},get_visibleInDOM:function(){return true},get_alignment:function(){return this.$1b_1}};CUI.Toolbar=function(id,properties,builder,hasJewel){CUI.Toolbar.initializeBase(this,[id,properties]);this.$4I_2=builder;this.$5i_2=hasJewel};CUI.Toolbar.prototype={$5g_2:null,$j_2:null,$k_2:null,$u_2:null,$11_2:null,$12_2:null,$4I_2:null,$5i_2:false,_jewel:null,get_jewel:function(){return this._jewel},set_jewel:function(value){this._jewel=value;return value},refresh:function(){this.$26_0();CUI.Root.prototype.$26_0.call(this)},$26_0:function(){var $v_0=this.$5_1,$v_1=!CUI.ScriptUtility.isNullOrUndefined($v_0.Size)||$v_0.Size==="TwoRow";CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())&&this.createToolbarStructure($v_1);this.set_$2_0(CUI.Utility.removeChildNodes(this.get_$2_0()));if($v_1){this.get_$2_0().appendChild(this.$5g_2);this.appendChildrenToElement(this.$k_2)}else{this.$5i_2&&this.get_$2_0().appendChild(this.$u_2);this.appendChildrenToElement(this.get_$2_0())}this.$l_0=false},createToolbarStructure:function(twoRow){if(this.$5i_2){this.$u_2=CUI.Utility.$3("div");this.$u_2.id="jewelcontainer";this.$u_2.className="ms-cui-jewel-container";this.$u_2.style.display="none"}if(twoRow){this.$j_2=CUI.Utility.$3("div");this.$j_2.className="ms-cui-topBar1";this.$j_2.style.display="none";this.$k_2=CUI.Utility.$3("div");this.$k_2.className="ms-cui-topBar2";this.$5i_2&&this.$k_2.appendChild(this.$u_2);this.$5g_2=CUI.Utility.$3("div");this.$5g_2.className="ms-cui-ribbonTopBars";this.$5g_2.appendChild(this.$j_2);this.$5g_2.appendChild(this.$k_2);this.$11_2=$get(this.$33_1+"-QATRowCenter");this.$12_2=$get(this.$33_1+"-QATRowRight");if(!CUI.ScriptUtility.isNullOrUndefined(this.$11_2)){this.$11_2.parentNode.removeChild(this.$11_2);this.$j_2.appendChild(this.$11_2);this.$11_2.style.display="inline-block";this.$j_2.style.display="block";CUI.Utility.$2f(this.$11_2,true,false)}if(!CUI.ScriptUtility.isNullOrUndefined(this.$12_2)){this.$12_2.parentNode.removeChild(this.$12_2);this.$j_2.appendChild(this.$12_2);this.$12_2.style.display="inline-block";this.$j_2.style.display="block";CUI.Utility.$2f(this.$12_2,true,false)}}this.$24_0()},$5D_0:function(){this._jewel&&this._jewel.pollForStateAndUpdate();CUI.Root.prototype.$5D_0.call(this)},ensureGlobalDisablingRemoved:function(){CUI.Root.prototype.ensureGlobalDisablingRemoved.call(this);this._jewel&&this._jewel.set_enabled(true)},ensureCorrectChildType:function(child){if(!CUI.ButtonDock.isInstanceOfType(child))throw Error.create("Only children of type ButtonDock can be added to a Toolbar");var $v_0=child;if($v_0.$1b_1==="Center"){var $$enum_2=this.$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$1b_1==="Center")throw Error.create("Can't add a centered buttondock because one is already present.")}}},get_cssClass:function(){return "ms-cui-toolbar-toolbar "+CUI.Root.prototype.get_cssClass.call(this)},get_domElementTagName:function(){return "div"},get_rootType:function(){return "Toolbar"},get_$IF_2:function(){return this.get_$1I_1()},set_$IF_2:function($p0){this.set_$1I_1($p0);return $p0},$En_2:function($p0,$p1){var $v_0=$p0.attrs,$v_1=new CUI.ButtonDock(this.$0_0,$v_0.Id,$v_0);return $v_1},$E4_2:function($p0){if(!this.$5i_2)return;this.$u_2.style.display="block";var $v_0=new CUI.DataNodeWrapper($p0),$v_1=new CUI.JewelBuildContext;$v_1.jewelId=$v_0.get_attributes()["Id"];var $v_2=new CUI.JewelBuildOptions;$v_2.trimmedIds=this.$4I_2.$z_0.trimmedIds;var $v_3=new CUI.JewelBuilder($v_2,this.$u_2,this.$4I_2.$1i_0);$v_3.$EK_1($p0,$v_1);this._jewel=$v_3.get_jewel()},$24_0:function(){CUI.Root.prototype.$24_0.call(this);this.get_$2_0().setAttribute("role","toolbar")},setFocusOnJewel:function(){this._jewel&&this._jewel.$Fo_2()}};CUI.ToolbarBuildContext=function(){CUI.ToolbarBuildContext.initializeBase(this)};CUI.ToolbarBuildContext.prototype={toolbar:null};CUI.ToolbarBuildOptions=function(){CUI.ToolbarBuildOptions.initializeBase(this)};CUI.ToolbarBuilder=function(options,elmPlaceholder,rootBuildClient){this.$$d_$HH_1=Function.createDelegate(this,this.$HH_1);CUI.ToolbarBuilder.initializeBase(this,[options,elmPlaceholder,rootBuildClient]);if(CUI.ScriptUtility.isNullOrUndefined(elmPlaceholder))throw Error.create("Toolbar placeholder DOM element is null or undefined.")};CUI.ToolbarBuilder.prototype={get_toolbar:function(){return this.$0_0},set_toolbar:function(value){this.$0_0=value;return value},buildToolbar:function(){var $v_0=new CUI.ToolbarBuildContext,$v_1=new CUI.DataQuery;$v_1.id="toolbar";$v_1.queryType=1;$v_1.handler=this.$$d_$HH_1;$v_1.data=$v_0;this.$10_0.runQuery($v_1)},$HH_1:function($p0){var $v_0=$p0.contextData;$p0.queryData=this.applyDataExtensions($p0.queryData);this.set_toolbar(this.$EZ_1($p0.queryData,$v_0));this.get_toolbar().set_$IF_2(this);this.$1i_0.onComponentCreated(this.get_toolbar(),this.get_toolbar().$4_0);this.get_toolbar().$26_0();this._elmPlaceholder.appendChild(this.get_toolbar().get_$2_0());var $$enum_2=this.get_toolbar().$6_0.getEnumerator();while($$enum_2.moveNext()){var $v_1=$$enum_2.get_current();if($v_1.$1b_1==="Left"){var $v_2=$get("jewelcontainer");if($v_2)if(!this.get_toolbar()._textDirection)$v_1.get_$2_0().style.left=$v_2.offsetWidth+"px";else $v_1.get_$2_0().style.right=$v_2.offsetWidth+"px";break}}CUI.Utility.ensureCSSClassOnElement(this._elmPlaceholder,"loaded");this.$1i_0.onComponentBuilt(this.get_toolbar(),this.get_toolbar().$4_0)},$EZ_1:function($p0,$p1){var $v_0=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Toolbar");if(CUI.ScriptUtility.isNullOrUndefined($v_0))throw Error.create("No toolbar element was present in the data");var $v_1=new CUI.DataNodeWrapper($v_0),$v_2=null!==CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Jewel");this.set_toolbar(new CUI.Toolbar($v_1.get_attributes()["Id"],$v_1.get_attributes(),this,$v_2));this.get_toolbar().$33_1=this.$z_0.clientID;this.get_toolbar().set_useDataCookie(true);this.get_toolbar().$26_0();$v_2&&this.get_toolbar().$E4_2($p0);for(var $v_3=CUI.DataNodeWrapper.getNodeChildren(CUI.DataNodeWrapper.getFirstChildNodeWithName($v_1.$a_0,"ButtonDocks")),$v_4=0;$v_4<$v_3.length;$v_4++){var $v_5=this.$EA_1($v_3[$v_4],$p1);this.get_toolbar().addChild($v_5)}return this.get_toolbar()},$EA_1:function($p0,$p1){for(var $v_0=new CUI.DataNodeWrapper($p0),$v_1=this.get_toolbar().$En_2($p0,$p1),$v_2=CUI.DataNodeWrapper.getFirstChildNodeWithName($p0,"Controls"),$v_3=CUI.DataNodeWrapper.getNodeChildren($v_2),$v_4=0;$v_4<$v_3.length;$v_4++){if(this.isNodeTrimmed($v_3[$v_4]))continue;var $v_5=this.$EY_1($v_3[$v_4],$p1);$v_1.addChild($v_5)}return $v_1},$EY_1:function($p0,$p1){var $v_0=null,$v_1=new CUI.DataNodeWrapper($p0),$v_2=$v_1.get_name(),$v_3=$v_1.get_attributes()["DisplayMode"];switch($v_2){case "Button":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Small":$v_3);case "CheckBox":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Small":$v_3);case "ComboBox":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode("Medium");case "FlyoutAnchor":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Medium":$v_3);case "Label":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Small":$v_3);case "Separator":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode("Small");case "TextBox":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Medium":$v_3);case "ToggleButton":$v_0=this.$23_0($p0,$p1);return $v_0.createComponentForDisplayMode(CUI.ScriptUtility.isNullOrEmptyString($v_3)?"Small":$v_3);default:throw Error.create("Invalid control type.")}}};CUI.ToolTip=function($p0,$p1,$p2,$p3,$p4){this.$$d_$Gr_1=Function.createDelegate(this,this.$Gr_1);CUI.ToolTip.initializeBase(this,[$p0,$p1,$p2,$p3]);this.$5_1=$p4;if(!CUI.ScriptUtility.isNullOrEmptyString($p4.ToolTipShortcutKey))if(!this.$0_0._textDirection)this.$1k_0=String.format("{0} ({1})",this.get_title(),this.$5_1.ToolTipShortcutKey);else this.$1k_0=String.format("({1}) {0}",this.get_title(),this.$5_1.ToolTipShortcutKey)};CUI.ToolTip.prototype={$e_1:null,$U_1:null,$F_1:null,$1u_1:null,$6d_1:null,$5U_1:null,$6j_1:null,$3h_1:null,$8B_1:null,$5V_1:null,$38_1:null,$5W_1:null,$2l_1:null,$8C_1:null,$5X_1:null,$5Y_1:null,$7E_1:null,$7F_1:null,$97_1:null,$98_1:null,$99_1:null,$5_1:null,$1L_1:null,$26_0:function(){this.get_needsDelayIniting()&&this.doDelayedInit();this.ensureDOMElementAndEmpty();this.get_$2_0().setAttribute("role","tooltip");this.get_$2_0().setAttribute("aria-hidden","true");if(CUI.ScriptUtility.isNullOrUndefined(this.$e_1)){this.$e_1=CUI.Utility.$3("div");this.$e_1.className="ms-cui-tooltip-body"}else this.$e_1=CUI.Utility.removeChildNodes(this.$e_1);this.get_$2_0().appendChild(this.$e_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$U_1)){this.$U_1=CUI.Utility.$3("div");this.$U_1.className="ms-cui-tooltip-glow";this.$e_1.appendChild(this.$U_1)}else this.$U_1=CUI.Utility.removeChildNodes(this.$U_1);if(CUI.ScriptUtility.isNullOrUndefined(this.$F_1)){this.$F_1=CUI.Utility.$3("h1");if(this.$1k_0.length>100)CUI.UIUtility.setInnerText(this.$F_1,this.$1k_0.substr(0,100));else CUI.UIUtility.setInnerText(this.$F_1,this.get_title());this.$U_1.appendChild(this.$F_1)}if(CUI.ScriptUtility.isNullOrUndefined(this.$6d_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$5_1.ToolTipImage32by32)){this.$6d_1=CUI.Utility.$3("img");this.$5U_1=CUI.Utility.$p(2,4,this.$5_1.ToolTipImage32by32,this.$5_1.ToolTipImage32by32Class,this.$6d_1,true,false,this.$5_1.ToolTipImage32by32Top,this.$5_1.ToolTipImage32by32Left);this.$5U_1.className=this.$5U_1.className+" ms-cui-tooltip-bitmap ";this.$U_1.appendChild(this.$5U_1)}var $v_0=this.$5_1.ToolTipSelectedItemTitle,$v_1=this.get_description();if(CUI.ScriptUtility.isNullOrUndefined(this.$1u_1)&&(!CUI.ScriptUtility.isNullOrEmptyString($v_1)||!CUI.ScriptUtility.isNullOrEmptyString($v_0))){this.$1u_1=CUI.Utility.$3("div");this.$1u_1.className="ms-cui-tooltip-description";if(!CUI.ScriptUtility.isNullOrUndefined(this.$5_1.ToolTipImage32by32))this.$1u_1.style.width="80%";this.$U_1.appendChild(this.$1u_1);var $v_2=this.$0_0.$5_1.ToolTipSelectedItemTitlePrefix;if(!CUI.ScriptUtility.isNullOrEmptyString($v_0)&&!CUI.ScriptUtility.isNullOrEmptyString($v_2)){var $v_3=String.format($v_2,$v_0);this.$6j_1=CUI.Utility.$3("p");CUI.Utility.$3Y(this.$6j_1,$v_3);this.$1u_1.appendChild(this.$6j_1);this.$99_1=CUI.Utility.$3("br");this.$1u_1.appendChild(this.$99_1)}if(!CUI.ScriptUtility.isNullOrEmptyString($v_1))if($v_1.length>512)this.$1u_1.innerHTML=this.$1u_1.innerHTML+CUI.Utility.$CW($v_1.substr(0,512),true);else this.$1u_1.innerHTML=this.$1u_1.innerHTML+CUI.Utility.$CW($v_1,true)}if(CUI.ScriptUtility.isNullOrUndefined(this.$3h_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.$1L_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1L_1.Title)){this.$7E_1=CUI.Utility.$3("div");this.$7E_1.className="ms-cui-tooltip-clear";this.$U_1.appendChild(this.$7E_1);this.$97_1=CUI.Utility.$3("hr");this.$U_1.appendChild(this.$97_1);this.$38_1=CUI.Utility.$3("div");this.$38_1.className="ms-cui-tooltip-footer";this.$U_1.appendChild(this.$38_1);this.$5W_1=CUI.Utility.$3("div");CUI.Utility.$3Y(this.$5W_1,this.$1L_1.Title);this.$8B_1=CUI.Utility.$3("img");this.$5V_1=CUI.Utility.$p(2,3,this.$1L_1.Icon,this.$1L_1.IconClass,this.$8B_1,true,false,this.$1L_1.IconTop,this.$1L_1.IconLeft);this.$5V_1.style.verticalAlign="top";if(!this.$0_0._textDirection){this.$38_1.appendChild(this.$5V_1);this.$38_1.appendChild(this.$5W_1)}else{this.$38_1.appendChild(this.$5W_1);this.$38_1.appendChild(this.$5V_1)}if(!CUI.ScriptUtility.isNullOrUndefined(this.$1L_1.Description)){this.$3h_1=CUI.Utility.$3("div");this.$3h_1.className="ms-cui-tooltip-description";this.$3h_1.style.width="90%";CUI.Utility.$3Y(this.$3h_1,this.$1L_1.Description);this.$U_1.appendChild(this.$3h_1)}}if(CUI.ScriptUtility.isNullOrUndefined(this.$2l_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$5_1.ToolTipFooterImage16by16)&&!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$5_1.ToolTipFooterText)&&(!CUI.ScriptUtility.isNullOrUndefined(this.$1L_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1L_1.HelpKeyWord)||!CUI.ScriptUtility.isNullOrEmptyString(this.$5_1.ToolTipHelpKeyWord))){this.$7F_1=CUI.Utility.$3("div");this.$7F_1.className="ms-cui-tooltip-clear";this.$U_1.appendChild(this.$7F_1);this.$98_1=CUI.Utility.$3("hr");this.$U_1.appendChild(this.$98_1);this.$2l_1=CUI.Utility.$3("div");this.$2l_1.className="ms-cui-tooltip-footer";this.$U_1.appendChild(this.$2l_1);this.$5Y_1=CUI.Utility.$3("div");CUI.Utility.$3Y(this.$5Y_1,this.$0_0.$5_1.ToolTipFooterText);this.$8C_1=CUI.Utility.$3("img");this.$5X_1=CUI.Utility.$p(2,3,this.$0_0.$5_1.ToolTipFooterImage16by16,this.$0_0.$5_1.ToolTipFooterImage16by16Class,this.$8C_1,true,false,this.$0_0.$5_1.ToolTipFooterImage16by16Top,this.$0_0.$5_1.ToolTipFooterImage16by16Left);this.$5X_1.style.verticalAlign="top";if(!this.$0_0._textDirection){this.$2l_1.appendChild(this.$5X_1);this.$2l_1.appendChild(this.$5Y_1)}else{this.$2l_1.appendChild(this.$5Y_1);this.$2l_1.appendChild(this.$5X_1)}}this.appendChildrenToElement(this.$e_1);CUI.Component.prototype.$26_0.call(this)},$F6_1:function(){this.$26_0();this.get_$2_0().style.visibility="hidden";this.get_$2_0().style.position="absolute";this.get_$2_0().style.top="0px";this.get_$2_0().style.left="0px";document.body.appendChild(this.get_$2_0());this.$HZ_1();if(Sys.Browser.agent===Sys.Browser.InternetExplorer){CUI.Utility.$D4(this.$0_0.get_$7t_1(),this.get_$2_0());this.$0_0.get_$7t_1().style.visibility="visible";this.$0_0.get_$7t_1().style.border="none"}this.get_$2_0().style.visibility="visible";this.set_visible(true);this.get_$2_0().setAttribute("aria-hidden","false");return true},$CS_1:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$2_0())){this.get_$2_0().style.visibility="hidden";this.get_$2_0().setAttribute("aria-hidden","true")}if(Sys.Browser.agent===Sys.Browser.InternetExplorer)this.$0_0.get_$7t_1().style.visibility="hidden";this.set_visible(false)},get_cssClass:function(){return "ms-cui-tooltip"},get_innerDiv:function(){return this.$U_1},set_innerDiv:function($p0){this.$U_1=$p0;return $p0},$HZ_1:function(){var $v_0=this.get_$2_0(),$v_1=this.$P_0.get_$2_0();if(CUI.ScriptUtility.isNullOrUndefined($v_0)||CUI.ScriptUtility.isNullOrUndefined($v_1))return;$v_0.style.top="0px";$v_0.style.left="0px";var $v_2=this.$0_0.$9g_1($v_0,$v_1),$v_3=CUI.Root.$1X($v_2,"flyOutWidth");if(this.$P_0.get_$Ba_0()>this.$0_0.get_$Ba_0()&&this.$P_0.get_$Ba_0()+this.$P_0.get_$Eh_0()<this.$0_0.get_$Ba_0()+this.$0_0.get_$Eh_0()){$v_2["launcherTop"]=this.$0_0.get_$Ba_0();$v_2["launcherHeight"]=this.$0_0.get_$Eh_0()}else{var $v_4=CUI.Root.$1X($v_2,"launcherLeft"),$v_5=CUI.Root.$1X($v_2,"launcherTop");$v_4+=30;$v_5+=10;$v_2["launcherLeft"]=$v_4;$v_2["launcherTop"]=$v_5}this.$0_0.$AL_1($v_0,$v_2,false);$v_0.style.minWidth=$v_3+"px"},$Gr_1:function($p0){this.$0_0&&this.$0_0.$3R_1()},$Cs_1:function($p0){if($p0)if($p0.rawEvent){var $v_0=113,$v_1=123;if($p0.rawEvent.keyCode===$v_0||$p0.rawEvent.keyCode===$v_1){var $v_2=null;if(!CUI.ScriptUtility.isNullOrUndefined(this.$5_1.ToolTipHelpKeyWord))$v_2=this.$5_1.ToolTipHelpKeyWord;if(!CUI.ScriptUtility.isNullOrUndefined(this.$1L_1)&&!CUI.ScriptUtility.isNullOrEmptyString(this.$1L_1.HelpKeyWord))$v_2=this.$1L_1.HelpKeyWord;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)){var $v_3={};$v_3["HelpKeyword"]=$v_2;!CUI.ScriptUtility.isNullOrUndefined(this.$0_0.$5_1.ToolTipHelpCommand)&&this.raiseCommandEvent(this.$0_0.$5_1.ToolTipHelpCommand,1,$v_3)}$p0.preventDefault();$p0.stopPropagation();$p0.rawEvent.cancelBubble=true;$p0.rawEvent.returnValue=false}else this.$0_0.$3R_1()}},dispose:function(){CUI.Component.prototype.dispose.call(this);this.$e_1=null;this.$1u_1=null;this.$6d_1=null;this.$5U_1=null;this.$3h_1=null;this.$8B_1=null;this.$5V_1=null;this.$38_1=null;this.$5W_1=null;this.$2l_1=null;this.$8C_1=null;this.$5X_1=null;this.$5Y_1=null;this.$U_1=null;this.$F_1=null;this.$6j_1=null;this.$7E_1=null;this.$7F_1=null;this.$97_1=null;this.$98_1=null;this.$99_1=null;this.$5_1=null}};CUI.Unit=function($p0,$p1,$p2,$p3,$p4,$p5){this.$3p_0=$p0;this.$6L_0=$p1;this.$3J_0=$p2;this.$3I_0=$p3;this.$6Z_0=$p4;this.$61_0=$p5};CUI.Unit.prototype={$3p_0:null,$6L_0:null,$3J_0:0,$3I_0:0,$6Z_0:0,$61_0:0,$54_0:function($p0){if(!$p0)return false;for(var $v_0=0;$v_0<this.$6L_0.length;$v_0++)if(this.$6L_0[$v_0].toLowerCase()===$p0.toLowerCase())return true;return false},$Dk_0:function($p0){if(typeof $p0!=="number")return CUI.Unit.$7Z;if($p0<this.$3J_0)return 2;if($p0>this.$3I_0)return 3;var $v_0=$p0.toString(),$v_1=$v_0.indexOf(".");if($v_1>-1){var $v_2=$v_0.substr($v_1+1);if($v_2.length>this.$6Z_0)return 1}return 0},get_$2z_0:function(){return this.$6L_0[0]}};CUI.Utility=function(){};CUI.Utility.removeChildNodes=function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return null;var $v_0=$p0.parentNode;if($v_0){var $v_1=$p0.cloneNode(false);$v_0.replaceChild($v_1,$p0);return $v_1}else{var $v_2=$p0.firstChild,$v_3;while($v_2){$v_3=$v_2.nextSibling;$p0.removeChild($v_2);$v_2=$v_3}return $p0}};CUI.Utility.removeChildNodesSlow=function($p0){while($p0.hasChildNodes())$p0.removeChild($p0.firstChild)};CUI.Utility.ensureCSSClassOnElement=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0))return;var $v_0=$p0.className;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)&&$v_0.indexOf($p1)!==-1)return;var $v_1=$v_0.trim()+" "+$p1;$v_1=$v_1.trim();$p0.className=$v_1};CUI.Utility.isDescendantOf=function($p0,$p1){while(!CUI.ScriptUtility.isNullOrUndefined($p1)){try{if($p1.nodeName.toLowerCase()==="body")break}catch($$e_2){if($p1===$p0)return true;break}if($p1===$p0)return true;$p1=$p1.parentNode}return false};CUI.Utility.removeCSSClassFromElement=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p1)||CUI.ScriptUtility.isNullOrUndefined($p0.className))return;var $v_0=$p0.className;if($v_0!==$v_0.replace($p1,""))$p0.className=$v_0.replace($p1,"")};CUI.Utility.setEnabledOnElement=function($p0,$p1){if($p1)CUI.Utility.enableElement($p0);else CUI.Utility.disableElement($p0)};CUI.Utility.enableElement=function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return;CUI.Utility.removeCSSClassFromElement($p0,"ms-cui-disabled")};CUI.Utility.disableElement=function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return;CUI.Utility.ensureCSSClassOnElement($p0,"ms-cui-disabled")};CUI.Utility.setDisabledAttribute=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p0))return;$p0.disabled=$p1};CUI.Utility.$2J=function($p0){$p0.setAttribute("href","javascript:;");$p0.setAttribute("onclick","return false;")};CUI.Utility.$65=function(){var $v_0=CUI.Utility.$3("a");$v_0.href="javascript:;";$v_0.setAttribute("onclick","return false;");return $v_0};CUI.Utility.$CD=function($p0){var $v_0=$p0,$v_1=0,$v_2=0,$v_3=$p0.offsetWidth,$v_4=$p0.offsetHeight;while(!CUI.ScriptUtility.isNullOrUndefined($v_0)&&!CUI.ScriptUtility.isNullOrUndefined($v_0.nodeName)&&$v_0.nodeName.toLowerCase()!=="body"){var $v_5=$v_0.clientLeft;if(CUI.ScriptUtility.isNullOrUndefined($v_5))$v_5=0;var $v_6=$v_0.clientTop;if(CUI.ScriptUtility.isNullOrUndefined($v_6))$v_6=0;$v_1+=$v_0.offsetLeft+$v_5;$v_2+=$v_0.offsetTop+$v_6;$v_0=$v_0.offsetParent}return new Sys.UI.Bounds($v_1,$v_2,$v_3,$v_4)};CUI.Utility.$3Y=function($p0,$p1){CUI.UIUtility.setInnerText($p0,$p1)};CUI.Utility.$CW=function($p0,$p1){var $v_0=new Sys.StringBuilder;if(CUI.ScriptUtility.isNullOrEmptyString($p0)||0===$p0.length)return null;var $v_1=false,$v_2=0,$v_3=0,$v_4=0,$v_5=$p0.length;while($v_4<$v_5){var $v_6,$v_7=$p0.charCodeAt($v_4);if($v_7<63)$v_6=CUI.Utility.$CV[$v_7];else if($v_7>=160&&$v_7<=255)$v_6=-2;else $v_6=0;if($v_6){if($v_3>0){$v_0.append($p0.substring($v_2,$v_2+$v_3));$v_3=0}$v_2=$v_4+1;if($v_6===-2){$v_0.append("&#");$v_0.append($v_7.toString());$v_0.append(";")}else if($v_6===8){var $v_8=$p0.charAt($v_4+1);if($v_8===" "||$v_1)$v_0.append(CUI.Utility.$1J[$v_6]);else $v_0.append(" ")}else{if($v_6===2&&$p1){if($v_4+5<$v_5&&$p0.charAt($v_4+1)==="n"&&$p0.charAt($v_4+2)==="b"&&$p0.charAt($v_4+3)==="s"&&$p0.charAt($v_4+4)==="p"&&$p0.charAt($v_4+5)===";"){$v_0.append(CUI.Utility.$1J[8]);$v_4+=6;$v_2+=5;continue}if($v_4+5<$v_5&&$p0.charAt($v_4+1)==="#"&&$p0.charAt($v_4+2)==="1"&&$p0.charAt($v_4+3)==="6"&&$p0.charAt($v_4+4)==="0"&&$p0.charAt($v_4+5)===";"){$v_0.append(CUI.Utility.$1J[8]);$v_4+=6;$v_2+=5;continue}}else if($v_6===4&&$p1){var $v_9,$v_A,$v_B;$v_9=$p0.charAt($v_4+1);if("b"===$v_9||"B"===$v_9){$v_A=$p0.charAt($v_4+2);if(">"===$v_A){$v_0.append(CUI.Utility.$1J[9]);$v_4+=3;$v_2+=2;continue}else if("r"===$v_A||"R"===$v_A){$v_B=$p0.charAt($v_4+3);if(">"===$v_B){$v_0.append(CUI.Utility.$1J[7]);$v_4+=4;$v_2+=3;continue}if("/"===$v_B){var $v_C=$p0.charAt($v_4+4);if($v_C===">"){$v_0.append(CUI.Utility.$1J[7]);$v_4+=5;$v_2+=4;continue}}if(" "===$v_B){var $v_D=$p0.charAt($v_4+4),$v_E=$p0.charAt($v_4+5);if($v_D==="/"&&$v_E===">"){$v_0.append(CUI.Utility.$1J[7]);$v_4+=6;$v_2+=5;continue}}}}else if("i"===$v_9||"I"===$v_9){$v_A=$p0.charAt($v_4+2);if(">"===$v_A){$v_0.append(CUI.Utility.$1J[10]);$v_4+=3;$v_2+=2;continue}}else if("p"===$v_9||"P"===$v_9){$v_A=$p0.charAt($v_4+2);if(">"===$v_A){$v_0.append(CUI.Utility.$1J[11]);$v_4+=3;$v_2+=2;continue}}else if("u"===$v_9||"U"===$v_9){$v_A=$p0.charAt($v_4+2);if(">"===$v_A){$v_0.append(CUI.Utility.$1J[12]);$v_4+=3;$v_2+=2;continue}}else if("/"===$v_9){$v_B=$p0.charAt($v_4+3);if(">"===$v_B){$v_A=$p0.charAt($v_4+2);if("b"===$v_A||"B"===$v_A){$v_0.append(CUI.Utility.$1J[13]);$v_4+=4;$v_2+=3;continue}else if("i"===$v_A||"I"===$v_A){$v_0.append(CUI.Utility.$1J[14]);$v_4+=4;$v_2+=3;continue}else if("p"===$v_A||"P"===$v_A){$v_0.append(CUI.Utility.$1J[15]);$v_4+=4;$v_2+=3;continue}else if("u"===$v_A||"U"===$v_A){$v_0.append(CUI.Utility.$1J[16]);$v_4+=4;$v_2+=3;continue}}}}else if($v_6===7)$v_1=true;else $v_1=false;$v_0.append(CUI.Utility.$1J[$v_6])}}else{$v_1=false;$v_3++}$v_4++}$v_2<$v_5&&$v_0.append($p0.substring($v_2,$v_5));return $v_0.toString()};CUI.Utility.$2f=function($p0,$p1,$p2){if(CUI.ScriptUtility.isNullOrUndefined($p0)||$p0.nodeName==="#text")return;if($p1)$p0.setAttribute("unselectable","on");else $p0.setAttribute("unselectable","off");if($p2){var $v_0=$p0.firstChild;while($v_0){CUI.Utility.$2f($v_0,$p1,true);$v_0=$v_0.nextSibling}}};CUI.Utility.$p=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8){var $v_0=null;if($p0===1)$v_0=CUI.Utility.$3("div");else if($p0===3)$v_0=$p6?CUI.Utility.$El():CUI.Utility.$3("a");else $v_0=$p6?CUI.Utility.$Em():CUI.Utility.$3("span");var $v_1="",$v_2={};$v_1=CUI.Utility.$CX[$p1];var $v_3=!CUI.ScriptUtility.isNullOrUndefined($p7),$v_4=!CUI.ScriptUtility.isNullOrUndefined($p8),$v_5=!CUI.ScriptUtility.isNullOrUndefined($p3);if($p5)$v_1+=" ms-cui-img-cont-float";else $v_1+=" ms-cui-img-container";if($v_5)$p4.className=$p3;$v_0.className+=" "+$v_1;if(!CUI.ScriptUtility.isNullOrEmptyString($p2)){$v_0.appendChild($p4);$p4.src=$p2;if(Sys.Browser.agent===Sys.Browser.Safari){$p4.style.top="0px";$p4.style.left="0px"}if($v_3)$p4.style.top=$p7+"px";if($v_4)$p4.style.left=$p8+"px"}return $v_0};CUI.Utility.$25=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){$p0.style.display="inline-block";if(!CUI.ScriptUtility.isNullOrUndefined($p2))$p0.className=$p2;if(!CUI.ScriptUtility.isNullOrEmptyString($p6))$p0.style.height=$p6+"px";if(!CUI.ScriptUtility.isNullOrEmptyString($p5))$p0.style.width=$p5+"px";if(!CUI.ScriptUtility.isNullOrEmptyString($p1))$p0.style.backgroundImage="url("+$p1+")";var $v_0="0px",$v_1="0px",$v_2=false;if(!CUI.ScriptUtility.isNullOrEmptyString($p4)){$v_0=$p4+"px";$v_2=true}if(!CUI.ScriptUtility.isNullOrEmptyString($p3)){$v_1=$p3+"px";$v_2=true}if($v_2)$p0.style.backgroundPosition=$v_0+" "+$v_1};CUI.Utility.$Bi=function(){var $v_0=CUI.Utility.$3("iframe");$v_0.style.position="absolute";$v_0.style.visibility="hidden";return $v_0};CUI.Utility.$Bh=function(){var $v_0=CUI.Utility.$3("span");if(Sys.Browser.agent===Sys.Browser.InternetExplorer)$v_0.className="ms-cui-glass-ie";else $v_0.className="ms-cui-glass-ff";return $v_0};CUI.Utility.$D4=function($p0,$p1){$p0.style.position="absolute";$p0.style.visibility="hidden";$p0.style.border="none";$p0.style.left=$p1.style.left;$p0.style.top=$p1.style.top;var $v_0=$p1.offsetWidth,$v_1=$p1.offsetHeight;if(CUI.Utility.$Ga()){$v_0-=4;$v_1-=4}$p0.style.width=$v_0.toString()+"px";$p0.style.height=$v_1.toString()+"px";$p0.style.visibility="visible"};CUI.Utility.$27=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p1)||CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined($p0.ToolTipTitle))return;$p1.setAttribute("aria-describedby",$p0.Id+"_ToolTip")};CUI.Utility.$C3=function($p0,$p1){var $v_0,$v_1="<br />",$v_2=$p0.lastIndexOf("\u200b\u200b"),$v_3=$p0.lastIndexOf(" ");if($v_2!==-1){$v_0=CUI.Utility.$49($p0.substr(0,$v_2))+$v_1;if($v_2<$p0.length)$v_0+=CUI.Utility.$49($p0.substr($v_2+2))}else if($v_3!==-1){$v_0=CUI.Utility.$49($p0.substr(0,$v_3))+$v_1;if($v_3<$p0.length)$v_0+=CUI.Utility.$49($p0.substr($v_3+1));if($p1)$v_0+=" "}else if($v_3===-1&&$p1)$v_0=CUI.Utility.$49($p0)+$v_1;else $v_0=CUI.Utility.$49($p0);return $v_0};CUI.Utility.$49=function($p0){if(CUI.ScriptUtility.isNullOrEmptyString($p0))return "";for(var $v_0=new Sys.StringBuilder,$v_1=$p0.length,$v_2=0;$v_2<$v_1;$v_2++){var $v_3=$p0.charAt($v_2);switch($v_3){case "<":$v_0.append("&lt;");break;case ">":$v_0.append("&gt;");break;case "&":$v_0.append("&amp;");break;case '"':$v_0.append("&quot;");break;case "'":$v_0.append("&#39;");break;default:$v_0.append($v_3);break}}return $v_0.toString()};CUI.Utility.$AA=function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return;$clearHandlers($p0);if(!CUI.ScriptUtility.isNullOrUndefined($p0.childNodes))for(var $v_0=0;$v_0<$p0.childNodes.length;$v_0++)CUI.Utility.$AA($p0.childNodes[$v_0])};CUI.Utility.$Em=function(){var $v_0=CUI.Utility.$3("span");$v_0.className="ms-cui-block";return $v_0};CUI.Utility.$El=function(){var $v_0=CUI.Utility.$3("a");$v_0.className="ms-cui-block";return $v_0};CUI.Utility.$15=function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0))return false;return $p0==="True"||$p0==="true"};CUI.Utility.$47=function(){var $v_0=window.innerWidth;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0=document.documentElement.clientWidth;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0=document.body.clientWidth;return $v_0};CUI.Utility.$57=function(){var $v_0=window.innerHeight;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0=document.documentElement.clientHeight;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0=document.body.clientHeight;return $v_0};CUI.Utility.$7X=function($p0,$p1){var $v_0=CUI.Utility.$G0($p0,$p1,true);return $v_0&&$v_0.length>0?$v_0[0]:null};CUI.Utility.$G0=function($p0,$p1,$p2){if(!CUI.ScriptUtility.isNullOrUndefined($p0.getElementsByClassName)){var $v_0=$p0.getElementsByClassName($p1);if($p2){if(CUI.ScriptUtility.isNullOrUndefined($v_0)||$v_0.length<=1)return $v_0;var $v_1=[];$v_1[0]=$v_0[0];return $v_1}return $v_0}if(!CUI.ScriptUtility.isNullOrUndefined($p0.querySelectorAll)){if($p2){var $v_2=$p0.querySelector("."+$p1),$v_3=[];if(!CUI.ScriptUtility.isNullOrUndefined($v_2))$v_3[0]=$v_2;return $v_3}return $p0.querySelectorAll("."+$p1)}else return CUI.Utility.$CA($p0,$p1,$p2)};CUI.Utility.$CA=function($p0,$p1,$p2){for(var $v_0=[],$v_1=0,$v_2,$v_3=0;$v_3<$p0.childNodes.length;$v_3++){$v_2=$p0.childNodes[$v_3];if(!CUI.ScriptUtility.isNullOrUndefined($v_2.className)&&$v_2.className.indexOf($p1)>=0){$v_0[$v_1++]=$v_2;if($p2)break}$v_0=$v_0.concat(CUI.Utility.$CA($v_2,$p1,$p2));if($v_0.length>0&&$p2)break}return $v_0};CUI.Utility.$AH=function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0.select))$p0.select();else if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var $v_0=$p0.createTextRange();$v_0.moveStart("character",0);$v_0.moveEnd("character",$p0.value.length);$v_0.select()}else $p0.setSelectionRange(0,$p0.value.length)};CUI.Utility.$GZ=function(){if(!CUI.Utility.$8U){CUI.Utility.$8V=Sys.Browser.agent===Sys.Browser.InternetExplorer;CUI.Utility.$8U=true}return CUI.Utility.$8V};CUI.Utility.$4A=function(){if(!CUI.Utility.$8Q){if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&!window.document.documentMode)CUI.Utility.$8W=true;CUI.Utility.$8Q=true}return CUI.Utility.$8W};CUI.Utility.$Ga=function(){if(!CUI.Utility.$8R){var $v_0=window.document.documentMode;if(CUI.Utility.$GZ()&&$v_0&&$v_0>=9)CUI.Utility.$8X=true;CUI.Utility.$8R=true}return CUI.Utility.$8X};CUI.Utility.get_$GR=function(){if(!CUI.Utility.$8N){if(Sys.Browser.agent===Sys.Browser.InternetExplorer){CUI.Utility.$4e=7;if(Sys.Browser.version>=8)CUI.Utility.$4e=Sys.Browser.version;else{var $v_0=window.navigator.userAgent,$v_1=new RegExp("Trident\\/([0-9]{1,}[\\.0-9]{0,})");if($v_1.test($v_0)){var $v_2=$v_1.exec($v_0),$v_3=$v_2.length>=2?Number.parseInvariant($v_2[1]):3;CUI.Utility.$4e=$v_3>=4?$v_3+4:7}else CUI.Utility.$4e=Sys.Browser.version}}CUI.Utility.$8N=true}return CUI.Utility.$4e};CUI.Utility.get_$GQ=function(){if(!CUI.Utility.$8M){if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var $v_0=document.documentMode;if($v_0)CUI.Utility.$6r=$v_0;else{var $v_1=document.compatMode;if($v_1==="CSS1Compat")CUI.Utility.$6r=7}}CUI.Utility.$8M=true}return CUI.Utility.$6r};CUI.Utility.get_$7d=function(){if(!CUI.Utility.$8T){var $v_0=CUI.Utility.get_$GR();if($v_0>0){var $v_1=CUI.Utility.get_$GQ();if($v_1>0)CUI.Utility.$8S=$v_1!==$v_0}CUI.Utility.$8T=true}return CUI.Utility.$8S};CUI.Utility.$9k=function($p0,$p1){return CUI.Utility.$G4($p0,[$p1])};CUI.Utility.$G4=function($p0,$p1){var $v_0=$p1.length;if(!$p0)return null;for(var $v_2=0;$v_2<$v_0;$v_2++)if($p0.tagName.toLowerCase()===$p1[$v_2].toLowerCase())return $p0;var $v_1=$p0.parentNode;while($v_1){for(var $v_3=0;$v_3<$v_0;$v_3++)if($v_1.tagName.toLowerCase()===$p1[$v_3].toLowerCase())return $v_1;$v_1=$v_1.parentNode}return null};CUI.Utility.$3=function($p0){var $v_0=document.createElement($p0);$v_0.setAttribute("unselectable","on");return $v_0};CUI.Utility.$3U=function($p0){var $v_0=document.createElement("label");$v_0.setAttribute("unselectable","on");$v_0.className="ms-cui-hidden";CUI.UIUtility.setInnerText($v_0,$p0);return $v_0};CUI.Utility.$9Q=function($p0){return document.createElement($p0)};CUI.Utility.$AP=function($p0,$p1){if(CUI.ScriptUtility.isNullOrUndefined($p1))return;$p0.style.imeMode=CUI.Utility.$15($p1)?"auto":"disabled"};CUI.Utility.get_returnFalseHandler=function(){if(CUI.ScriptUtility.isNullOrUndefined(CUI.Utility.$7A))CUI.Utility.$7A=CUI.NativeUtility.returnFalse;return CUI.Utility.$7A};CUI.ScriptUtility=function(){};CUI.ScriptUtility.isNullOrEmptyString=function($p0){var $v_0=null;return $p0===$v_0||typeof $p0==="undefined"||!$p0.length};CUI.ScriptUtility.isNullOrUndefined=function($p0){var $v_0=null;return $p0===$v_0||typeof $p0==="undefined"};CUI.ScriptUtility.isUndefined=function($p0){return typeof $p0==="undefined"};CUI.UIUtility=function(){};CUI.UIUtility.generateRandomElementId=function(){var $v_0=null,$v_1=null;do{var $v_2=Math.random();$v_2=$v_2*1e5;$v_2=Math.round($v_2);$v_0="rnd"+$v_2.toString();$v_1=$get($v_0)}while($v_1);return $v_0};CUI.UIUtility.cancelEvent=function($p0){if($p0){$p0.preventDefault();$p0.stopPropagation()}};CUI.UIUtility.insertBefore=function($p0,$p1){var $v_0=$p1.parentNode;$v_0.insertBefore($p0,$p1)};CUI.UIUtility.insertAfter=function($p0,$p1){var $v_0=$p1.parentNode;if($v_0.lastChild===$p1)$v_0.appendChild($p0);else $v_0.insertBefore($p0,$p1.nextSibling)};CUI.UIUtility.removeNode=function($p0){$p0.parentNode&&$p0.parentNode.removeChild($p0)};CUI.UIUtility.calculateOffsetLeft=function($p0){var $v_0=0;while($p0){$v_0+=$p0.offsetLeft;$p0=$p0.offsetParent}return $v_0};CUI.UIUtility.calculateOffsetTop=function($p0){var $v_0=0;while($p0){$v_0+=$p0.offsetTop;$p0=$p0.offsetParent}return $v_0};CUI.UIUtility.setInnerText=function($p0,$p1){CUI.NativeUtility.setInnerText($p0,$p1)};CUI.UIUtility.isTextNode=function($p0){return $p0.nodeType===3||$p0.nodeType===4};CUI.UIUtility.isNodeOfType=function($p0,$p1){for(var $v_0=0;$v_0<$p1.length;$v_0++)if($p0.tagName===$p1[$v_0])return true;return false};CUI.ListNode=function($p0,$p1,$p2){this.next=$p2;this.previous=$p1;this.data=$p0};CUI.ListNode.prototype={next:null,previous:null,data:null};CUI.List=function(){};CUI.List.prototype={$2D_0:null,$40_0:null,$S_0:0,add:function($p0){if(!this.$2D_0)this.$2D_0=this.$40_0=new CUI.ListNode($p0,null,null);else this.$40_0=this.$40_0.next=new CUI.ListNode($p0,this.$40_0,null);this.$S_0++},insert:function($p0,$p1){if($p0>this.$S_0||0>$p0)throw Error.argumentOutOfRange("pos");if($p0===this.$S_0){this.add($p1);return}var $v_0=this.$2D_0;while(0!==$p0--)$v_0=$v_0.next;var $v_1=new CUI.ListNode($p1,$v_0.previous,$v_0);if(!$v_0.previous)this.$2D_0=$v_1;else $v_0.previous.next=$v_1;if(!$v_0.next)this.$40_0=$v_1;else $v_0.next.previous=$v_1},remove:function($p0){var $v_0=this.$2D_0;while($v_0){if($v_0.data===$p0)break;$v_0=$v_0.next}if(!$v_0)return false;if(!$v_0.previous)this.$2D_0=$v_0.next;else $v_0.previous.next=$v_0.next;if(!$v_0.next)this.$40_0=$v_0.previous;else $v_0.next.previous=$v_0.previous;return true},clear:function(){var $v_0=this.$2D_0,$v_1;this.$2D_0=null;this.$40_0=null;while($v_0){$v_1=$v_0.next;$v_0.previous=null;$v_0.next=null;$v_0=$v_1}},indexOf:function($p0){var $v_0=this.$2D_0,$v_1=0;while($v_0){if($v_0.data===$p0)break;$v_0=$v_0.next;$v_1++}if(!$v_0)return -1;return $v_1},get_item:function($p0){var $v_0=this.$BK_0($p0);return $v_0.data},get_count:function(){return this.$S_0},getEnumerator:function(){return new CUI.ListEnumerator(this.$2D_0)},getEnumeratorAtPos:function($p0){var $v_0=this.$BK_0($p0);return new CUI.ListEnumerator($v_0)},$BK_0:function($p0){var $v_0=this.$2D_0,$v_1=0;while($v_1!==$p0){if(!$v_0)throw Error.argumentOutOfRange("pos");$v_0=$v_0.next;$v_1++}return $v_0}};CUI.ListEnumerator=function($p0){this.$4b_0=$p0};CUI.ListEnumerator.prototype={$4b_0:null,$a_0:null,get_current:function(){if(!this.$a_0)throw Error.argumentOutOfRange();return this.$a_0.data},moveNext:function(){if(!this.$a_0){this.$a_0=this.$4b_0;return !!this.$4b_0}if(!this.$a_0.next)return false;this.$a_0=this.$a_0.next;return true},movePrevious:function(){if(!this.$a_0){this.$a_0=this.$4b_0;return !!this.$4b_0}if(!this.$a_0.previous)return false;this.$a_0=this.$a_0.previous;return true},reset:function(){this.$a_0=this.$4b_0}};CUI.JsonXmlElement=function(name,attrs){this.name=name;if(!attrs)attrs={};this.attrs=attrs};CUI.JsonXmlElement.prototype={get_name:function(){return this.name},get_attributes:function(){return this.attrs},appendChild:function(name,attrs){var $v_0=new CUI.JsonXmlElement(name,attrs);return this.appendChildNode($v_0)},appendChildNode:function(node){var $v_0=this.children;if(!$v_0){$v_0=[];this.children=$v_0}Array.add($v_0,node);return node},get_childNodes:function(){return this.children}};Type.registerNamespace("CUI.Controls");CUI.Controls.ColorStyle=function(){this.Title=null;this.Color=null;this.Style=null;this.DisplayColor=null};CUI.Controls.ColorPickerResult=function(){};CUI.Controls.ContextMenuControlProperties=function(){CUI.Controls.ContextMenuControlProperties.initializeBase(this)};CUI.Controls.ContextMenuControl=function($p0,$p1,$p2,$p3){CUI.Controls.ContextMenuControl.initializeBase(this,[$p0,$p1,$p2,$p3]);this.addDisplayMode("Menu")};CUI.Controls.ContextMenuControl.prototype={$Ci_3:null,createDOMElementForDisplayMode:function($p0){switch($p0){case "Menu":this.$Ci_3=CUI.Utility.$3("span");return this.$Ci_3;default:this.ensureValidDisplayMode($p0);return null}},onEnabledChanged:function($p0){},onMenuButtonClick:function($p0){if(!this.get_enabled())return;this.$Cc_2($p0,null);this.get_displayedComponent().raiseCommandEvent(this.get_$1_3().CommandMenuOpen,4,null)},onLaunchedMenuClosed:function(){this.get_displayedComponent().raiseCommandEvent(this.get_$1_3().CommandMenuClose,10,null)},get_$1_3:function(){return this.$5_0}};CUI.Controls.Button=function($p0,$p1,$p2){this.$$d_handleTabBlur=Function.createDelegate(this,this.handleTabBlur);this.$$d_handleTabFocus=Function.createDelegate(this,this.handleTabFocus);this.$$d_handleMouseBlur=Function.createDelegate(this,this.handleMouseBlur);this.$$d_handleMouseFocus=Function.createDelegate(this,this.handleMouseFocus);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.Button.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32")};CUI.Controls.Button.prototype={$H_1:null,$9_1:null,$A_1:null,$Y_1:null,$g_1:null,$2u_1:null,$1F_1:null,$8D_1:null,$8E_1:null,$8F_1:null,$2N_1:null,$1v_1:null,createComponentForDisplayModeInternal:function($p0){var $v_0;if($p0.startsWith("Menu")){$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);this.$2u_1=this.get_$1_1().MenuItemId;this.$1F_1=this.get_$1_1().CommandValueId;if(CUI.ScriptUtility.isNullOrEmptyString(this.$1F_1))this.$1F_1=this.$2u_1}else $v_0=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,$p0);return $v_0},createDOMElementForDisplayMode:function($p0){return this.$3T_1($p0,true)},$3T_1:function($p0,$p1){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().Alt)?this.getLabel():this.get_$1_1().Alt;switch($p0){case "Large":this.$H_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Large",this.get_$1_1(),false,false);$p1&&this.$E6_0("Large");return this.$H_1;case "Medium":this.$9_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Medium",this.get_$1_1(),false,false);$p1&&this.$E6_0("Medium");return this.$9_1;case "Small":this.$A_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Small",this.get_$1_1(),false,false);$p1&&this.$E6_0("Small");return this.$A_1;case "Menu":case "Menu16":this.$Y_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu16",this.get_$1_1(),true,false);$p1&&this.$E6_0("Menu16");return this.$Y_1;case "Menu32":this.$g_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu32",this.get_$1_1(),true,false);$p1&&this.$E6_0("Menu32");return this.$g_1;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Large":this.$H_1=$v_0;break;case "Medium":this.$9_1=$v_0;break;case "Small":this.$A_1=$v_0;break}},$E6_0:function($p0){switch($p0){case "Large":this.$W_1(this.$H_1,true);break;case "Medium":this.$W_1(this.$9_1,true);break;case "Small":this.$W_1(this.$A_1,true);break;case "Menu32":this.$W_1(this.$g_1,false);break;case "Menu16":this.$W_1(this.$Y_1,false);break;case "Menu":this.$W_1(this.$Y_1,false);break}},$W_1:function($p0,$p1){$addHandler($p0,"click",this.$$d_onClick);$p1&&$addHandler($p0,"dblclick",this.$$d_onDblClick);$addHandler($p0,"mouseover",this.$$d_handleMouseFocus);$addHandler($p0,"mouseout",this.$$d_handleMouseBlur);$addHandler($p0,"focus",this.$$d_handleTabFocus);$addHandler($p0,"blur",this.$$d_handleTabBlur)},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$H_1,$p0);CUI.Utility.setEnabledOnElement(this.$9_1,$p0);CUI.Utility.setEnabledOnElement(this.$A_1,$p0);CUI.Utility.setEnabledOnElement(this.$Y_1,$p0);CUI.Utility.setEnabledOnElement(this.$g_1,$p0);!$p0&&this.$1Y_1()},get_$Bb_0:function(){return "Button"},getTextValue:function(){return this.getLabel()},getLabel:function(){return this.get_$1_1().LabelText},receiveFocus:function(){this.onBeginFocus();var $v_0=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;$v_0.set_$1Q_2(true);!CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)&&this.$Y_1.focus();!CUI.ScriptUtility.isNullOrUndefined(this.$g_1)&&this.$g_1.focus()},getDropDownDOMElementForDisplayMode:function($p0){var $v_0;switch($p0){case "Large":$v_0=this.$8D_1;break;case "Medium":$v_0=this.$8E_1;break;case "Small":$v_0=this.$8F_1;break;case "Menu":$v_0=this.$2N_1;break;case "Text":$v_0=this.$1v_1;break;default:$v_0=CUI.Utility.$3("span");break}if($v_0)return $v_0;return this.$Bg_1($p0)},$Bg_1:function($p0){var $v_0;switch($p0){case "Large":$v_0=this.$3T_1($p0,false).cloneNode(true);this.$H_1=null;$v_0.style.height="auto";$v_0.childNodes[1].style.height="auto";this.$8D_1=$v_0;break;case "Medium":$v_0=this.$3T_1($p0,false).cloneNode(true);this.$9_1=null;this.$8E_1=$v_0;break;case "Small":$v_0=this.$3T_1($p0,false).cloneNode(true);this.$A_1=null;this.$8F_1=$v_0;break;case "Menu":this.$2N_1=this.$3T_1("Menu",false).cloneNode(true);this.$Y_1=null;return this.$2N_1;case "Text":var $v_1=CUI.Utility.$3("a");CUI.Utility.$2J($v_1);this.$1v_1=CUI.Utility.$3("span");this.$1v_1.className="ms-cui-textmenuitem";CUI.UIUtility.setInnerText($v_1,this.get_$1_1().LabelText);this.$1v_1.appendChild($v_1);return this.$1v_1;default:this.ensureValidDisplayMode($p0);return null}return $v_0},deselect:function(){},getMenuItemId:function(){return this.$2u_1},getCommandValueId:function(){return this.$1F_1},$AN_0:function(){if(!this.get_enabled())return false;this.get_displayedComponent().get_$2_0().focus();return true},focusOnDisplayedComponent:function(){this.receiveFocus()},onClick:function($p0){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7700);$p0.preventDefault();$p0.stopPropagation();this.$d_0();if(!this.get_enabled())return;this.$0_0.set_$59_1(this);var $v_0=1,$v_1=this.get_stateProperties(),$v_2=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2==="OptionSelection")$v_0=3;$v_1["CommandValueId"]=this.$1F_1;$v_1["MenuItemId"]=this.$2u_1;$v_1["SourceControlId"]=this.$4_0;this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().Command,$v_0,$v_1);!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7701)},handleMouseFocus:function($p0){this.onBeginFocus();if(!this.get_enabled())return;var $v_0=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType($v_0)&&$v_0.set_$1Q_2(true);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandPreview))return;var $v_1=this.get_stateProperties();$v_1["CommandValueId"]=this.$1F_1;$v_1["MenuItemId"]=this.$2u_1;var $v_2=5,$v_3=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$v_3==="OptionSelection")$v_2=7;$v_0.raiseCommandEvent(this.get_$1_1().CommandPreview,$v_2,$v_1)},handleMouseBlur:function($p0){this.$1Y_1();this.onEndFocus();if(!this.get_enabled())return;var $v_0=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType($v_0)&&$v_0.set_$1Q_2(false);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandRevert))return;var $v_1=6,$v_2=this.get_stateProperties();$v_2["CommandValueId"]=this.$1F_1;$v_2["MenuItemId"]=this.$2u_1;var $v_3=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$v_3==="OptionSelection")$v_1=8;$v_0.raiseCommandEvent(this.get_$1_1().CommandRevert,$v_1,$v_2)},handleTabFocus:function($p0){this.onBeginFocus();var $v_0=this.get_displayedComponent();if(CUI.MenuItem.isInstanceOfType($v_0)){$v_0.set_$1Q_2(true);this.$48_1(this.get_enabled())}else this.get_enabled()&&this.$0_0.set_$s_1(this)},handleTabBlur:function($p0){this.$1Y_1();this.onEndFocus();if(!this.get_enabled())return;var $v_0=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType($v_0)&&$v_0.set_$1Q_2(false)},onMenuClosed:function(){this.$1Y_1();this.$d_0()},$1Y_1:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$H_1)&&CUI.Utility.removeCSSClassFromElement(this.$H_1,"ms-cui-ctl-hoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$9_1)&&CUI.Utility.removeCSSClassFromElement(this.$9_1,"ms-cui-ctl-hoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$A_1)&&CUI.Utility.removeCSSClassFromElement(this.$A_1,"ms-cui-ctl-hoveredOver");if(!CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)){CUI.Utility.removeCSSClassFromElement(this.$Y_1,"ms-cui-ctl-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$Y_1,"ms-cui-ctl-disabledHoveredOver")}if(!CUI.ScriptUtility.isNullOrUndefined(this.$g_1)){CUI.Utility.removeCSSClassFromElement(this.$g_1,"ms-cui-ctl-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$g_1,"ms-cui-ctl-disabledHoveredOver")}},$48_1:function($p0){var $v_0="ms-cui-ctl-hoveredOver";if(!$p0){$v_0="ms-cui-ctl-disabledHoveredOver";!CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)&&CUI.Utility.ensureCSSClassOnElement(this.$Y_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined(this.$g_1)&&CUI.Utility.ensureCSSClassOnElement(this.$g_1,$v_0)}else{!CUI.ScriptUtility.isNullOrUndefined(this.$H_1)&&CUI.Utility.ensureCSSClassOnElement(this.$H_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined(this.$9_1)&&CUI.Utility.ensureCSSClassOnElement(this.$9_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined(this.$A_1)&&CUI.Utility.ensureCSSClassOnElement(this.$A_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined(this.$Y_1)&&CUI.Utility.ensureCSSClassOnElement(this.$Y_1,$v_0);!CUI.ScriptUtility.isNullOrUndefined(this.$g_1)&&CUI.Utility.ensureCSSClassOnElement(this.$g_1,$v_0)}},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$H_1=null;this.$9_1=null;this.$A_1=null;this.$Y_1=null;this.$g_1=null;this.$8D_1=null;this.$8E_1=null;this.$8F_1=null;this.$2N_1=null;this.$1v_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.CheckBoxCommandProperties=function(){};CUI.Controls.CheckBox=function($p0,$p1,$p2){this.$$d_$Ct_2=Function.createDelegate(this,this.$Ct_2);this.$$d_$Gz_2=Function.createDelegate(this,this.$Gz_2);this.$$d_$7i_2=Function.createDelegate(this,this.$7i_2);this.$$d_$7j_2=Function.createDelegate(this,this.$7j_2);this.$$d_$6E_2=Function.createDelegate(this,this.$6E_2);this.$$d_$5C_2=Function.createDelegate(this,this.$5C_2);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.CheckBox.initializeBase(this,[$p0,$p1,$p2])};CUI.Controls.CheckBox.prototype={$A_2:null,$1G_2:null,$9_2:null,$1B_2:null,$2o_2:null,createDOMElementForDisplayMode:function($p0){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().Alt)?this.get_$1_2().LabelText:this.get_$1_2().Alt;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0="";switch($p0){case "Small":this.$A_2=CUI.Utility.$3("span");this.$A_2.className="ms-cui-cbx";this.$A_2.setAttribute("mscui:controltype",this.get_$Bb_0());this.$1G_2=CUI.Utility.$3("input");this.$1G_2.type="checkbox";this.$1G_2.className="ms-cui-cbx-input";this.$1G_2.id=this._id+"-Small-checkbox";if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().ToolTipTitle))this.$1G_2.title=$v_0;this.$1G_2.setAttribute("role",this.get_$43_0());CUI.Utility.$27(this.get_$1_2(),this.$1G_2);this.$W_2(this.$1G_2,null);this.$A_2.appendChild(this.$1G_2);return this.$A_2;case "Medium":this.$9_2=CUI.Utility.$3("span");this.$9_2.className="ms-cui-cbx";this.$9_2.setAttribute("mscui:controltype",this.get_$Bb_0());this.$1B_2=CUI.Utility.$3("input");this.$1B_2.type="checkbox";this.$1B_2.className="ms-cui-cbx-input";this.$1B_2.id=this._id+"-Medium-checkbox";if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().ToolTipTitle))this.$1B_2.title=$v_0;this.$1B_2.setAttribute("role",this.get_$43_0());CUI.Utility.$27(this.get_$1_2(),this.$1B_2);var $v_1=false;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().LabelText)){this.$2o_2=CUI.Utility.$3("label");if(CUI.Utility.$4A())this.$2o_2.setAttribute("htmlFor",this._id+"-Medium-checkbox");else this.$2o_2.setAttribute("for",this._id+"-Medium-checkbox");CUI.Utility.$3Y(this.$2o_2,this.get_$1_2().LabelText);$v_1=true}this.$W_2(this.$1B_2,this.$2o_2);this.$9_2.appendChild(this.$1B_2);$v_1&&this.$9_2.appendChild(this.$2o_2);return this.$9_2;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Medium":this.$9_2=$v_0;this.$1B_2=$v_0.firstChild;this.$2o_2=$v_0.childNodes[1];break;case "Small":this.$A_2=$v_0;this.$1G_2=$v_0.firstChild;break}},$E6_0:function($p0){switch($p0){case "Medium":this.$W_2(this.$1B_2,this.$2o_2);break;case "Small":this.$W_2(this.$1G_2,null);break}},$W_2:function($p0,$p1){$addHandler($p0,"click",this.$$d_onClick);$addHandler($p0,"focus",this.$$d_$5C_2);$addHandler($p0,"blur",this.$$d_$6E_2);$addHandler($p0,"mouseover",this.$$d_$7j_2);$addHandler($p0,"mouseout",this.$$d_$7i_2);$addHandler($p0,"keydown",this.$$d_$Gz_2);if(!CUI.ScriptUtility.isNullOrUndefined($p1)){$addHandler($p1,"click",this.$$d_$Ct_2);$addHandler($p1,"keydown",this.$$d_$Gz_2);$addHandler($p1,"mouseover",this.$$d_$7j_2);$addHandler($p1,"mouseout",this.$$d_$7i_2)}},onEnabledChanged:function($p0){if($p0){CUI.Utility.enableElement(this.$A_2);CUI.Utility.enableElement(this.$9_2)}else{CUI.Utility.disableElement(this.$A_2);CUI.Utility.disableElement(this.$9_2)}CUI.Utility.setDisabledAttribute(this.$1G_2,!$p0);CUI.Utility.setDisabledAttribute(this.$1B_2,!$p0)},get_$Bb_0:function(){return "CheckBox"},get_$43_0:function(){return "checkbox"},onClick:function($p0){this.$d_0();if(!this.get_enabled())return;var $v_0=9,$v_1=this.get_displayedComponent();switch($v_1.get_displayMode()){case "Small":this.get_stateProperties()["On"]=this.$1G_2.checked;break;case "Medium":this.get_stateProperties()["On"]=this.$1B_2.checked;break;default:this.ensureValidDisplayMode($v_1.get_displayMode());return}$v_1.raiseCommandEvent(this.get_$1_2().Command,$v_0,this.get_stateProperties());if(this.$0_0.get_$6G_1())this.$HT_0();else this.setState(this.get_stateProperties()["On"])},$5C_2:function($p0){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$s_1(this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandPreview,5,this.get_stateProperties())},$Gz_2:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0))$p0.keyCode===13&&this.$Ct_2($p0)},$7j_2:function($p0){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandPreview,5,this.get_stateProperties())},$6E_2:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandRevert,6,this.get_stateProperties())},$7i_2:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandRevert,6,this.get_stateProperties())},$Ct_2:function($p0){$p0.preventDefault();this.$d_0();if(!this.get_enabled())return;this.$0_0.set_$s_1(this);this.setState(!this.$1B_2.checked);this.onClick($p0)},setState:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$1G_2))this.$1G_2.checked=$p0;if(!CUI.ScriptUtility.isNullOrUndefined(this.$1B_2))this.$1B_2.checked=$p0},$HT_0:function(){this.pollForStateAndUpdateInternal(this.get_$1_2().Command,this.get_$1_2().QueryCommand,this.get_stateProperties(),true);this.setState(this.get_stateProperties()["On"])},addDisplayModes:function(){this.addDisplayMode("Small");this.addDisplayMode("Medium")},$AN_0:function(){if(!this.get_enabled())return false;var $v_0=this.get_displayedComponent().get_$2_0();$v_0.firstChild.focus();return true},dispose:function(){CUI.Controls.ToggleButton.prototype.dispose.call(this);this.$9_2=null;this.$1B_2=null;this.$2o_2=null;this.$A_2=null;this.$1G_2=null},get_$1_2:function(){return this.$5_0}};CUI.Controls.ColorPickerCommandProperties=function(){};CUI.Controls.ColorPicker=function($p0,$p1,$p2,$p3){this.$$d_$Co_1=Function.createDelegate(this,this.$Co_1);this.$$d_$Gq_1=Function.createDelegate(this,this.$Gq_1);this.$$d_$Cq_1=Function.createDelegate(this,this.$Cq_1);this.$$d_$Cp_1=Function.createDelegate(this,this.$Cp_1);CUI.Controls.ColorPicker.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Menu");this.$Ab_1=$p3};CUI.Controls.ColorPicker.prototype={$Ab_1:null,createComponentForDisplayModeInternal:function($p0){if(this.$q_0.length>0)throw Error.create("Only one ControlComponent can be created for each ColorPicker Control");var $v_0;$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);return $v_0},get_$Bb_0:function(){return "ColorPicker"},$34_1:null,$Dx_1:function($p0,$p1){for(var $v_0=null,$v_1=$p0.ownerDocument,$v_2=0,$v_3=$p1.length/10,$v_4=0;$v_4<$p1.length;$v_4++){if(!($v_4%10)){$v_0=$v_1.createElement("tr");$p0.appendChild($v_0);$v_2++}var $v_5=$v_1.createElement("td");$v_5.className="ms-cui-colorpicker-cell";$v_5.setAttribute("arrayPosition",$v_4);if($v_2===1){$v_5.style.padding="2px";$v_5.style.height="16px"}$v_0.appendChild($v_5);var $v_6=$v_1.createElement("a");$v_6.href="javascript:";var $v_7=$p1[$v_4].Title;$v_6.title=$v_7;$v_6.className="ms-cui-colorpicker-cell-a";$addHandler($v_6,"focus",this.$$d_$Cp_1);var $v_8=$v_1.createElement("div"),$v_9=$p1[$v_4].DisplayColor;$v_8.style.backgroundColor=$v_9;$v_8.className="ms-cui-colorpicker-celldiv";var $v_A=13;if($v_2===1||$v_2===2){$v_8.style.borderTopWidth="1px";$v_A--}if($v_2===1||$v_2===$v_3){$v_8.style.borderBottomWidth="1px";$v_A--}if($v_A!==13)$v_8.style.height=$v_A+"px";var $v_B=$v_1.createElement("div");$v_B.className="ms-cui-colorpicker-cellinternaldiv";$addHandler($v_6,"mouseover",this.$$d_$Cq_1);$addHandler($v_6,"mouseout",this.$$d_$Gq_1);$addHandler($v_6,"click",this.$$d_$Co_1);$v_5.appendChild($v_6);$v_6.appendChild($v_8);$v_8.appendChild($v_B);$v_5.colorPickerCssClass=$p1[$v_4];Array.add(this.$34_1,$v_5)}},createDOMElementForDisplayMode:function($p0){switch($p0){case "Menu":var $v_0=this.$0_0.get_element().ownerDocument,$v_1=$v_0.createElement("table");if(this.$0_0._textDirection===1)$v_1.dir="rtl";else $v_1.dir="ltr";$v_1.className="ms-cui-smenu-inner";$v_1.setAttribute("cellSpacing","0");$v_1.setAttribute("cellPadding","0");$v_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$34_1=[];var $v_2=$v_0.createElement("tbody");this.$Dx_1($v_2,this.$Ab_1);$v_1.appendChild($v_2);return $v_1;default:this.ensureValidDisplayMode($p0);break}return null},onEnabledChanged:function($p0){},$Co_1:function($p0){$p0.preventDefault();if(!this.get_enabled())return;var $v_0=$p0.target,$v_1=CUI.Utility.$9k($v_0,"td"),$v_2=this.$CC_1($v_1);this.$9M_1();this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().Command,1,$v_2)},$CC_1:function($p0){var $v_0=$p0.colorPickerCssClass,$v_1=new CUI.Controls.ColorPickerResult;$v_1.Color=$v_0.Color;$v_1.Style=$v_0.Style;return $v_1},$Cq_1:function($p0){if(!this.get_enabled())return;var $v_0=CUI.Utility.$9k($p0.target,"td");this.$9p_1($v_0)},$Cp_1:function($p0){if(!this.get_enabled())return;var $v_0=CUI.Utility.$9k($p0.target,"td");this.$9p_1($v_0)},$Gq_1:function($p0){if(!this.get_enabled())return;this.$7m_1();CUI.Controls.ColorPicker.$7=-10},$4D_1:false,$A5_1:null,$9p_1:function($p0){var $v_0=parseInt($p0.getAttribute("arrayPosition"));if(CUI.Controls.ColorPicker.$7===$v_0)return;CUI.Controls.ColorPicker.$7=$v_0;this.$DN_1($p0);this.$E1_1($p0)},$E1_1:function($p0){this.$7m_1();Sys.UI.DomElement.addCssClass($p0,"ms-cui-colorpicker-hoveredOver");this.$9t_1=$p0;$p0.firstChild&&$p0.firstChild.focus()},$9t_1:null,$7m_1:function(){if(this.$9t_1)this.$9t_1.className="ms-cui-colorpicker-cell"},receiveFocus:function(){this.$AM_1(0)},$AM_1:function($p0){if(this.$34_1&&this.$34_1.length>$p0){var $v_0=this.$34_1[$p0];this.$9p_1($v_0)}},$9M_1:function(){this.$4D_1=false;this.$A5_1=null},$9V_1:function(){this.$4D_1&&!CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().CommandRevert)&&this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandRevert,6,this.$A5_1)},$DN_1:function($p0){if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().CommandPreview)){this.$4D_1=true;var $v_0=this.$CC_1($p0);this.$A5_1=$v_0;this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandPreview,5,$v_0)}},get_$1_1:function(){return this.$5_0},onMenuClosed:function(){this.$9V_1()},$7U_0:function(){var $v_0=1,$v_1=window.event;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1.keyCode===38)$v_0=10;if(CUI.Controls.ColorPicker.$7<0)CUI.Controls.ColorPicker.$7+=this.$34_1.length+$v_0;if(CUI.Controls.ColorPicker.$7>=$v_0){this.$AM_1(CUI.Controls.ColorPicker.$7-$v_0);return true}this.$7m_1();CUI.Controls.ColorPicker.$7-=$v_0;return false},$7T_0:function(){var $v_0=1,$v_1=window.event;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1.keyCode===40)$v_0=10;if(CUI.Controls.ColorPicker.$7+$v_0<0){CUI.Controls.ColorPicker.$7=-1;$v_0=1}if(CUI.Controls.ColorPicker.$7+$v_0<this.$34_1.length){this.$AM_1(CUI.Controls.ColorPicker.$7+$v_0);return true}this.$7m_1();CUI.Controls.ColorPicker.$7-=this.$34_1.length;return false}};CUI.Controls.ComboBoxCommandProperties=function(){};CUI.Controls.ComboBox=function($p0,$p1,$p2,$p3){this.$$d_executeAutoComplete=Function.createDelegate(this,this.executeAutoComplete);this.$$d_onInputKeyDown=Function.createDelegate(this,this.onInputKeyDown);this.$$d_onInputBlur=Function.createDelegate(this,this.onInputBlur);this.$$d_onInputFocus=Function.createDelegate(this,this.onInputFocus);this.$6O_3=100;this.$4o_3=-1;CUI.Controls.ComboBox.initializeBase(this,[$p0,$p1,$p2,$p3]);if(CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().AllowFreeForm))this.$7v_3=false;else this.$7v_3=this.get_cbProperties().AllowFreeForm.toLowerCase()==="true";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_cbProperties().AutoComplete))this.get_cbProperties().AutoComplete="true";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_cbProperties().AutoCompleteDelay))try{this.$6O_3=parseInt(this.get_cbProperties().AutoCompleteDelay)}catch($$e_4){this.$6O_3=100}};CUI.Controls.ComboBox.prototype={$9_3:null,$M_3:null,$L_3:null,$2Q_3:null,$2R_3:null,$7v_3:false,createDOMElementForDisplayMode:function($p0){switch($p0){case "Medium":var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().Alt)?"":this.get_cbProperties().Alt,$v_1=CUI.ScriptUtility.isNullOrUndefined(this.get_cbProperties().AltArrow)?$v_0:this.get_cbProperties().AltArrow;this.$9_3=CUI.Utility.$3("span");this.$9_3.className="ms-cui-cb";this.$9_3.setAttribute("mscui:controltype",this.get_$Bb_0());this.$M_3=CUI.Utility.$9Q("input");this.$M_3.setAttribute("name",this.get_cbProperties().Command);this.$M_3.type="text";this.$M_3.style.width=this.get_cbProperties().Width;this.$M_3.className="ms-cui-cb-input";this.$M_3.setAttribute("autocomplete","off");this.$M_3.id=this.get_cbProperties().Id;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle))this.$M_3.title=$v_0;CUI.Utility.$AP(this.$M_3,this.get_properties().ImeEnabled);var $v_2=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_2))$v_2=this.get_cbProperties().InitialItem;!CUI.ScriptUtility.isNullOrUndefined($v_2)&&this.$32_2($v_2);CUI.Utility.$27(this.get_properties(),this.$M_3);this.$L_3=CUI.Utility.$3("a");CUI.Utility.ensureCSSClassOnElement(this.$L_3,"ms-cui-dd-arrow-button");CUI.Utility.$2J(this.$L_3);this.$L_3.tabIndex=-1;this.$L_3.setAttribute("aria-haspopup",true);this.$2Q_3=CUI.Utility.$3("img");this.$2R_3=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$2Q_3,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle)){this.$2Q_3.alt=$v_1;this.$L_3.title=$v_1}this.$E6_0("Medium");this.$9_3.appendChild(this.$M_3);this.$9_3.appendChild(this.$L_3);this.$L_3.appendChild(this.$2R_3);return this.$9_3;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=null;switch($p0){case "Medium":this.$9_3=$v_0;this.$M_3=$v_0.childNodes[0];this.$L_3=$v_0.childNodes[1];this.$2R_3=this.$L_3.childNodes[0];this.$2Q_3=this.$2R_3.childNodes[0];CUI.Utility.$2f(this.$M_3,false,false);break}},$E6_0:function($p0){switch($p0){case "Medium":this.$W_3();break}},$W_3:function(){$addHandler(this.$M_3,"focus",this.$$d_onInputFocus);$addHandler(this.$M_3,"blur",this.$$d_onInputBlur);$addHandler(this.$M_3,"keydown",this.$$d_onInputKeyDown);$addHandler(this.$M_3,"mouseup",CUI.Utility.get_returnFalseHandler());$addHandler(this.$L_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$L_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$L_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$L_3,"focus",this.$$d_onArrowButtonFocus);$addHandler(this.$L_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$L_3,"keypress",this.$$d_onArrowButtonKeyPress)},onEnabledChanged:function($p0){if($p0){CUI.Utility.enableElement(this.$M_3);CUI.Utility.enableElement(this.$9_3)}else{CUI.Utility.disableElement(this.$M_3);CUI.Utility.disableElement(this.$9_3)}CUI.Controls.DropDown.prototype.onEnabledChanged.call(this,$p0)},get_$Bb_0:function(){return "ComboBox"},get_$43_0:function(){return "combobox"},$4j_3:null,get_menuItems:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$4j_3))this.$4j_3={};return this.$4j_3},set_menuItems:function($p0){this.$4j_3=$p0;return $p0},getFirstMenuItemThatBeginsWith:function($p0){var $$dict_1=this.$4j_3;for(var $$key_2 in $$dict_1){var $v_0={key:$$key_2,value:$$dict_1[$$key_2]};if($v_0.key.toLowerCase().startsWith($p0.toLowerCase()))return $v_0}return null},$77_3:null,onInputKeyDown:function($p0){this.clearPendingAutoComplete();var $v_0=this.$M_3.value;this.$d_0();if($p0&&$p0.rawEvent)if($p0.rawEvent.keyCode===40&&$p0.altKey){this.launchMenuInternal();return}if(CUI.ScriptUtility.isNullOrEmptyString($v_0))return;if($p0&&$p0.rawEvent){var $v_1=$p0.rawEvent.keyCode;switch($v_1){case 13:this.clearPendingAutoComplete();$p0.preventDefault();this.validateAndSave();return;case 27:this.clearPendingAutoComplete();!this.$n_1&&this.resetToPreviousValue();return;case 38:break;case 40:if($p0.altKey){this.launchMenuInternal();return}break;case 8:case 127:case 46:this.clearPendingAutoComplete();this.$77_3=null;return;case 36:case 35:case 33:case 34:case 37:case 39:case 16:case 18:case 17:case 20:return}}if(CUI.Utility.$15(this.get_cbProperties().AutoComplete)){this.clearPendingAutoComplete();this.$4o_3=window.setTimeout(this.$$d_executeAutoComplete,this.$6O_3)}},executeAutoComplete:function(){this.$4o_3=-1;var $v_0=this.$M_3.value,$v_1=this.getFirstMenuItemThatBeginsWith($v_0);if(!$v_1){this.$77_3=null;return}this.$M_3.value=$v_1.key;if(Sys.Browser.agent===Sys.Browser.InternetExplorer){var $v_2=this.$M_3.createTextRange();$v_2.moveStart("character",$v_0.length);$v_2.moveEnd("character",this.$M_3.value.length);$v_2.select()}else this.$M_3.setSelectionRange($v_0.length,this.$M_3.value.length);this.$77_3=$v_1.value},clearPendingAutoComplete:function(){this.$4o_3!==-1&&window.clearTimeout(this.$4o_3);this.$4o_3=-1},$AN_0:function(){if(!this.get_enabled())return false;if(!CUI.ScriptUtility.isNullOrUndefined(this.$M_3)){this.$M_3.focus();return true}return false},onInputFocus:function($p0){this.$0_0.set_$s_1(this);this.onArrowButtonFocus($p0);CUI.Utility.$15(this.get_cbProperties().PopulateDynamically)&&this.pollForDynamicMenu(false);CUI.Utility.$AH(this.$M_3);!CUI.ScriptUtility.isNullOrUndefined(this.$C_1)&&this.$C_1.$26_0()},onInputBlur:function($p0){this.clearPendingAutoComplete();this.onArrowButtonBlur($p0)},get_$7c_3:function(){return this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.IsFreeForm]},set_$7c_3:function($p0){this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.IsFreeForm]=$p0;return $p0},validateAndSave:function(){if(!this.$32_2(this.$77_3)){var $v_0=this.get_displayedComponent();if(!CUI.Utility.$15(this.get_cbProperties().AutoComplete)){var $v_1=this.$4j_3[this.$M_3.value];if(!CUI.ScriptUtility.isNullOrEmptyString($v_1)&&this.$32_2($v_1)){this.set_$7c_3(false);$v_0.raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:false,CommandValueId:this._selectedControl.getCommandValueId()});return}}if(this.$7v_3){this.set_$7c_3(true);this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]=this.$M_3.value;$v_0.raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:true,Value:this.$M_3.value})}else{this.resetToPreviousValue();return}}else{this.set_$7c_3(false);this.get_displayedComponent().raiseCommandEvent(this.get_cbProperties().Command,3,{IsFreeForm:false,CommandValueId:this._selectedControl.getCommandValueId()})}},resetToPreviousValue:function(){if(!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl))this.$M_3.value=this._selectedControl.getTextValue();else this.$M_3.value=""},selectMenuItem:function($p0){if(this._selectedControl===$p0)return;this._selectedControl=$p0;this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=$p0.getMenuItemId();var $v_0=$p0;this.$M_3.value=$v_0.getTextValue()},$HT_0:function(){var $v_0=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_0))this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=this.get_cbProperties().InitialItem;var $v_1=this.pollForStateAndUpdateInternal(this.get_cbProperties().Command,this.get_cbProperties().QueryCommand,this.get_stateProperties(),false),$v_2=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId];if($v_1)if(this.get_$7c_3()){this.$M_3.value=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value];this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.SelectedItemId]=null}else if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){if($v_0!==$v_2||!this._itemEverSelected)if(!this.$32_2($v_2))throw Error.create("The menu item id requested via polling does not exist")}else if(!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]))this.$M_3.value=this.get_stateProperties()[CUI.Controls.ComboBoxCommandProperties.Value]},onDynamicMenuPopulated:function(){var $v_0=null,$v_1=null,$v_2=null,$v_3=null,$v_4=null,$v_5=null;if(CUI.ScriptUtility.isNullOrUndefined(this.$C_1))return;var $$enum_6=this.$C_1.$6_0.getEnumerator();while($$enum_6.moveNext()){var $v_6=$$enum_6.get_current(),$$enum_8=$v_6.$6_0.getEnumerator();while($$enum_8.moveNext()){var $v_7=$$enum_8.get_current();if(CUI.MenuItem.isInstanceOfType($v_7)){$v_0=$v_7;$v_1=$v_0.$R_1;if(CUI.ISelectableControl.isInstanceOfType($v_1)){$v_2=$v_1;$v_4=$v_2.getMenuItemId()}if(CUI.IMenuItem.isInstanceOfType($v_1)){$v_3=$v_1;$v_5=$v_3.getTextValue()}if(!(CUI.ScriptUtility.isNullOrUndefined($v_4)||CUI.ScriptUtility.isNullOrUndefined($v_5))){this.get_menuItems()[$v_5]=$v_4;$v_5=null;$v_4=null}}}}},launchMenuInternal:function(){this.launchMenu(this.$M_3,this.$$d_sendMenuCreationCommandEvent)&&this.sendMenuCreationCommandEvent()},dispose:function(){CUI.Controls.DropDown.prototype.dispose.call(this);this.$9_3=null;this.$2Q_3=null;this.$2R_3=null;this.$L_3=null;this.$M_3=null},get_cbProperties:function(){return this.$5_0}};CUI.Controls.DropDownCommandProperties=function(){};CUI.Controls.DropDown=function($p0,$p1,$p2,$p3){this.$$d_onArrowButtonKeyboardFocus=Function.createDelegate(this,this.onArrowButtonKeyboardFocus);this.$$d_sendMenuCreationCommandEvent=Function.createDelegate(this,this.sendMenuCreationCommandEvent);this.$$d_onArrowButtonKeyPress=Function.createDelegate(this,this.onArrowButtonKeyPress);this.$$d_onArrowButtonClick=Function.createDelegate(this,this.onArrowButtonClick);this.$$d_onArrowButtonBlur=Function.createDelegate(this,this.onArrowButtonBlur);this.$$d_onArrowButtonFocus=Function.createDelegate(this,this.onArrowButtonFocus);CUI.Controls.DropDown.initializeBase(this,[$p0,$p1,$p2,$p3]);this.addDisplayModes();this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=null;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value]=null};CUI.Controls.DropDown.prototype={$9_2:null,$f_2:null,$L_2:null,$2Q_2:null,$2R_2:null,$AN_0:function(){if(!this.get_enabled())return false;this.$L_2.focus();return true},createDOMElementForDisplayMode:function($p0){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt,$v_1=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().AltArrow)?$v_0:this.get_properties().AltArrow,$v_2=true;if(CUI.ScriptUtility.isNullOrEmptyString($v_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle))$v_1=this.get_properties().ToolTipTitle;var $v_3=null;switch($p0){case "Text":case "Medium":this.$9_2=CUI.Utility.$3("span");this.$9_2.className="ms-cui-dd";this.$9_2.setAttribute("mscui:controltype",this.get_$Bb_0());this.$f_2=CUI.Utility.$3("span");this.$f_2.className="ms-cui-dd-text";this.$f_2.style.width=this.get_properties().Width;var $v_4=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_4))$v_4=this.get_properties().InitialItem;!CUI.ScriptUtility.isNullOrUndefined($v_4)&&this.$32_2($v_4);this.$L_2=CUI.Utility.$3("a");this.$L_2.setAttribute("role",this.get_$43_0());this.$L_2.setAttribute("aria-haspopup",true);CUI.Utility.ensureCSSClassOnElement(this.$L_2,"ms-cui-dd-arrow-button");CUI.Utility.$27(this.get_properties(),this.$L_2);CUI.Utility.$2J(this.$L_2);this.$L_2.id=this.$4_0;this.$2Q_2=CUI.Utility.$3("img");this.$2R_2=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$2Q_2,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ToolTipTitle)){this.$L_2.setAttribute("title",$v_1);this.$f_2.title=$v_0;this.$2Q_2.alt=$v_1;$v_2=false}this.$E6_0("Medium");this.$9_2.appendChild(this.$f_2);this.$9_2.appendChild(this.$L_2);this.$L_2.appendChild(this.$2R_2);if($v_2){$v_3=CUI.Utility.$3U($v_1);this.$L_2.appendChild($v_3)}return this.$9_2;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Text":case "Medium":this.$9_2=$v_0;this.$f_2=$v_0.childNodes[0];this.$L_2=$v_0.childNodes[1];this.$2R_2=this.$L_2.childNodes[0];this.$2Q_2=this.$2R_2.childNodes[0];break}},$E6_0:function($p0){switch($p0){case "Text":case "Medium":this.$W_2();break}},$W_2:function(){$addHandler(this.$9_2,"click",this.$$d_onArrowButtonClick);$addHandler(this.$9_2,"keypress",this.$$d_onArrowButtonKeyPress);$addHandler(this.$L_2,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$L_2,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$L_2,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$L_2,"blur",this.$$d_onArrowButtonBlur)},onEnabledChanged:function($p0){if($p0)CUI.Utility.enableElement(this.$9_2);else CUI.Utility.disableElement(this.$9_2)},get_$Bb_0:function(){return "DropDown"},$3W_0:function($p0){if($p0.$I_1===3){var $v_0=$p0.$3y_1;if(!CUI.ISelectableControl.isInstanceOfType($v_0.$R_1))return CUI.MenuLauncher.prototype.$3W_0.call(this,$p0);var $v_1=$v_0.$R_1;!CUI.ScriptUtility.isNullOrUndefined(this._selectedControl)&&this._selectedControl.deselect();this.selectMenuItem($v_1)}if($p0.$I_1===3||$p0.$I_1===7||$p0.$I_1===8){var $v_2;switch($p0.$I_1){case 3:$v_2=this.get_properties().Command;break;case 7:$v_2=this.get_properties().CommandPreview;break;case 8:$v_2=this.get_properties().CommandRevert;break;default:$v_2=this.get_properties().Command;break}this.get_displayedComponent().raiseCommandEvent($v_2,$p0.$I_1,$p0.$3s_1);CUI.MenuLauncher.prototype.$3W_0.call(this,$p0);return false}return CUI.MenuLauncher.prototype.$3W_0.call(this,$p0)},selectMenuItem:function($p0){if(this._selectedControl===$p0)return;this._selectedControl=$p0;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=$p0.getMenuItemId();var $v_0;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().SelectedItemDisplayMode))$v_0="Text";else $v_0=this.get_properties().SelectedItemDisplayMode;var $v_1;if($v_0==="Text"){var $v_2=$p0.getTextValue();$v_1=CUI.Utility.$3("a");CUI.UIUtility.setInnerText($v_1,$v_2)}else $v_1=this._selectedControl.getDropDownDOMElementForDisplayMode($v_0);if(this.$f_2.hasChildNodes()){var $v_3=this.$f_2.firstChild;this.$f_2.replaceChild($v_1,$v_3)}else this.$f_2.appendChild($v_1)},_itemEverSelected:false,$32_2:function($p0){if(CUI.ScriptUtility.isNullOrUndefined($p0)||CUI.ScriptUtility.isNullOrUndefined(this.$C_1))return false;var $v_0=this.$C_1.$CG_1($p0);if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;this.selectMenuItem($v_0);this._itemEverSelected=true;return true},addDisplayModes:function(){this.addDisplayMode("Medium");this.addDisplayMode("Text")},onArrowButtonClick:function($p0){var $v_0=this.get_enabled();$v_0&&CUI.PMetrics.perfMark(7192);this.$d_0();$p0.preventDefault();if(!$v_0)return;this.$0_0.set_$s_1(this);this.launchMenuInternal($p0);CUI.PMetrics.perfMark(7193)},launchMenuInternal:function($p0){this.launchMenu(this.$L_2,this.$$d_sendMenuCreationCommandEvent)&&this.sendMenuCreationCommandEvent()},sendMenuCreationCommandEvent:function(){this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuOpen,4,null)},onBeginFocus:function(){var $v_0=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value];if(CUI.ScriptUtility.isNullOrUndefined($v_0)){var $v_1=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_1))$v_1=this.get_properties().InitialItem;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&!CUI.ScriptUtility.isNullOrUndefined(this.$C_1)){var $v_2=this.$C_1.$CG_1($v_1);if(!CUI.ScriptUtility.isNullOrUndefined($v_2))$v_0=$v_2.getTextValue()}}if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.get_properties().ToolTipSelectedItemTitle=$v_0;CUI.Control.prototype.onBeginFocus.call(this)},onArrowButtonKeyboardFocus:function($p0){this.$0_0.set_$s_1(this);this.onArrowButtonFocus($p0)},onArrowButtonFocus:function($p0){this.onBeginFocus();if(!this.get_enabled())return;this.highlight()},onArrowButtonBlur:function($p0){this.onEndFocus();if(!this.get_enabled()||this.$n_1)return;this.removeHighlight()},onArrowButtonKeyPress:function($p0){this.$d_0();if(!this.get_enabled())return;var $v_0=$p0.rawEvent.keyCode;if($v_0===13||$v_0===32||$v_0===40){this.$1H_1=true;this.launchMenuInternal($p0)}},highlight:function(){CUI.Utility.ensureCSSClassOnElement(this.$L_2,"ms-cui-ctl-light-hoveredOver")},removeHighlight:function(){CUI.Utility.removeCSSClassFromElement(this.$L_2,"ms-cui-ctl-light-hoveredOver")},onLaunchedMenuClosed:function(){this.$d_0();this.removeHighlight();this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$HT_0:function(){var $v_0=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_0))this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=this.get_properties().InitialItem;this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties(),false);var $v_1=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(!CUI.ScriptUtility.isNullOrUndefined($v_1)){if($v_0!==$v_1||!this._itemEverSelected)if(!this.$32_2($v_1))throw Error.create("The menu item id requested via polling does not exist")}else if(!CUI.ScriptUtility.isNullOrUndefined(this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value])){var $v_2=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.Value];this.$f_2.innerHTML="<a>"+CUI.Utility.$49($v_2)+"</a>"}},dispose:function(){CUI.MenuLauncher.prototype.dispose.call(this);this.$9_2=null;this.$2Q_2=null;this.$2R_2=null;this.$L_2=null;this.$f_2=null},get_properties:function(){return this.$5_0}};CUI.Controls.FlyoutAnchor=function($p0,$p1,$p2,$p3){this.$$d_$H4_2=Function.createDelegate(this,this.$H4_2);this.$$d_$H3_2=Function.createDelegate(this,this.$H3_2);this.$$d_$H5_2=Function.createDelegate(this,this.$H5_2);this.$$d_$3Q_2=Function.createDelegate(this,this.$3Q_2);this.$$d_$7i_2=Function.createDelegate(this,this.$7i_2);this.$$d_$7j_2=Function.createDelegate(this,this.$7j_2);this.$$d_$5C_2=Function.createDelegate(this,this.$5C_2);this.$$d_$HE_2=Function.createDelegate(this,this.$HE_2);this.$$d_$HD_2=Function.createDelegate(this,this.$HD_2);this.$$d_$HL_2=Function.createDelegate(this,this.$HL_2);this.$$d_$Cs_2=Function.createDelegate(this,this.$Cs_2);this.$$d_$6E_2=Function.createDelegate(this,this.$6E_2);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.FlyoutAnchor.initializeBase(this,[$p0,$p1,$p2,$p3]);this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32");this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Thin")};CUI.Controls.FlyoutAnchor.prototype={$6h_2:null,$6i_2:null,$4W_2:null,$5b_2:null,$8G_2:null,$5c_2:null,$8H_2:null,$m_2:null,$Y_2:null,$g_2:null,$H_2:null,$Ai_2:null,$2O_2:null,$9_2:null,$Ak_2:null,$2n_2:null,$A_2:null,$An_2:null,$2p_2:null,$1y_2:null,$4Y_2:null,$5f_2:null,createDOMElementForDisplayMode:function($p0){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().Alt)?this.get_$1_2().LabelText:this.get_$1_2().Alt;switch($p0){case "Menu":this.$m_2=this.createMenuDOMElement("Menu","ms-cui-textmenuitem ms-cui-fa-menuitem ms-cui-ctl-menu",$v_0,null,null,null,null);this.$E6_0($p0);this.$m_2.setAttribute("aria-haspopup",true);return this.$m_2;case "Menu16":this.$Y_2=this.createMenuDOMElement("Menu16","ms-cui-fa-menuitem ms-cui-ctl-menu",$v_0,this.get_$1_2().Image16by16,this.get_$1_2().Image16by16Class,this.get_$1_2().Image16by16Top,this.get_$1_2().Image16by16Left);this.$E6_0($p0);this.$Y_2.setAttribute("aria-haspopup",true);return this.$Y_2;case "Menu32":this.$g_2=this.createMenuDOMElement("Menu32","ms-cui-fa-menuitem ms-cui-ctl-menu",$v_0,this.get_$1_2().Image32by32,this.get_$1_2().Image32by32Class,this.get_$1_2().Image32by32Top,this.get_$1_2().Image32by32Left);this.$g_2.setAttribute("aria-haspopup",true);this.$E6_0($p0);return this.$g_2;case "Large":this.$H_2=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Large",this.get_$1_2(),false,true);this.$H_2.setAttribute("aria-haspopup",true);this.$8P_2&&CUI.Utility.ensureCSSClassOnElement(this.$H_2,"ms-cui-ctl-large-groupPopup");this.$E6_0("Large");return this.$H_2;case "Medium":this.$9_2=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Medium",this.get_$1_2(),false,true);this.$E6_0("Medium");this.$9_2.setAttribute("aria-haspopup",true);return this.$9_2;case "Small":this.$A_2=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Small",this.get_$1_2(),false,true);this.$E6_0("Small");this.$A_2.setAttribute("aria-haspopup",true);return this.$A_2;case "Thin":this.$1y_2=CUI.Utility.$65();this.$1y_2.className="ms-cui-ctl-thin";this.$4Y_2=CUI.Utility.$3("img");this.$4Y_2.alt="";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_2().ToolTipTitle)){this.$1y_2.title=$v_0;this.$4Y_2.alt=$v_0}var $v_1=this.$0_0;this.$5f_2=CUI.Utility.$p(2,1,$v_1.$5_1.ImageDownArrow,$v_1.$5_1.ImageDownArrowClass,this.$4Y_2,true,false,$v_1.$5_1.ImageDownArrowTop,$v_1.$5_1.ImageDownArrowLeft);this.$1y_2.appendChild(this.$5f_2);this.$E6_0("Thin");this.$1y_2.setAttribute("aria-haspopup",true);return this.$1y_2;default:this.ensureValidDisplayMode($p0);break}return null},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);!CUI.ScriptUtility.isNullOrUndefined($v_0)&&this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Large":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$H_2=$v_0;this.$Ai_2=this.$H_2.childNodes[0].childNodes[0];this.$2O_2=this.$H_2.lastChild.lastChild.childNodes[0];break;case "Medium":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$9_2=$v_0;this.$Ak_2=this.$9_2.childNodes[0].childNodes[0];this.$2n_2=this.$9_2.lastChild.lastChild.childNodes[0];break;case "Small":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$A_2=$v_0;this.$An_2=this.$A_2.childNodes[0].childNodes[0];this.$2p_2=this.$A_2.lastChild.lastChild.childNodes[0];break;case "Thin":this.$1y_2=$v_0;this.$5f_2=$v_0.firstChild;this.$4Y_2=this.$5f_2.firstChild;break}},get_$Bb_0:function(){return "FlyoutAnchor"},createMenuDOMElement:function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $v_0=CUI.Utility.$65();$v_0.className=$p1;$v_0.title=$p2;$v_0.setAttribute("mscui:controltype",this.get_$Bb_0());CUI.Utility.$27(this.get_$1_2(),$v_0);var $v_1=null;switch($p0){case "Menu16":if(CUI.ScriptUtility.isNullOrUndefined(this.$5b_2)){this.$5b_2=CUI.Utility.$3("img");this.$8G_2=CUI.Utility.$p(2,3,$p3,$p4,this.$5b_2,true,true,$p5,$p6);this.$5b_2.alt=$p2;$v_1=this.$8G_2}break;case "Menu32":if(CUI.ScriptUtility.isNullOrUndefined(this.$5c_2)){this.$5c_2=CUI.Utility.$3("img");this.$8H_2=CUI.Utility.$p(2,4,$p3,$p4,this.$5c_2,true,true,$p5,$p6);this.$5c_2.alt=$p2;$v_1=this.$8H_2}break}this.createMenuLabelDOMElementIfNeeded($p0);if(CUI.ScriptUtility.isNullOrUndefined(this.$6h_2)){this.$6h_2=CUI.Utility.$3("img");this.$6i_2=CUI.Utility.$p(2,2,this.$0_0.$5_1.ImageSideArrow,this.$0_0.$5_1.ImageSideArrowClass,this.$6h_2,false,true,this.$0_0.$5_1.ImageSideArrowTop,this.$0_0.$5_1.ImageSideArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$6i_2,"ms-cui-fa-menu-arrow")}if($v_1){var $v_2=CUI.Utility.$3("span");$v_2.className="ms-cui-ctl-iconContainer";$v_2.appendChild($v_1);$v_0.appendChild($v_2)}$v_0.appendChild(this.$4W_2);$v_0.appendChild(this.$6i_2);return $v_0},createMenuLabelDOMElementIfNeeded:function($p0){if(CUI.ScriptUtility.isNullOrUndefined(this.$4W_2)){this.$4W_2=CUI.Utility.$3("span");this.$4W_2.className="ms-cui-ctl-mediumlabel";CUI.UIUtility.setInnerText(this.$4W_2,this.get_$1_2().LabelText)}},$E6_0:function($p0){var $v_0=this.getDisplayedDOMElement($p0);if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;var $v_1={click:this.$$d_onClick,blur:this.$$d_$6E_2,keypress:this.$$d_$Cs_2,focus:this.$$d_$HL_2},$v_2;if(Sys.Browser.agent===Sys.Browser.InternetExplorer)if($p0.startsWith("Menu"))$v_2={mouseenter:this.$$d_$HD_2,mouseleave:this.$$d_$HE_2};else $v_2={mouseenter:this.$$d_$5C_2,mouseleave:this.$$d_$6E_2};else if($p0.startsWith("Menu"))$v_2={mouseover:this.$$d_$7j_2,mouseout:this.$$d_$7i_2};else $v_2={mouseover:this.$$d_$5C_2,mouseout:this.$$d_$6E_2};$addHandlers($v_0,$v_1);$addHandlers($v_0,$v_2)},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$m_2,$p0);CUI.Utility.setEnabledOnElement(this.$Y_2,$p0);CUI.Utility.setEnabledOnElement(this.$g_2,$p0);CUI.Utility.setEnabledOnElement(this.$H_2,$p0);CUI.Utility.setEnabledOnElement(this.$9_2,$p0);CUI.Utility.setEnabledOnElement(this.$A_2,$p0);CUI.Utility.setEnabledOnElement(this.$1y_2,$p0)},positionMenu:function($p0,$p1){if(this.get_displayedComponent().get_displayMode().startsWith("Menu"))this.$0_0.$HY_1($p0,$p1);else CUI.MenuLauncher.prototype.positionMenu.call(this,$p0,$p1)},createComponentForDisplayModeInternal:function($p0){var $v_0;if($p0.startsWith("Menu"))$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);else $v_0=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,$p0);return $v_0},getDisplayedDOMElement:function($p0){switch($p0){case "Menu":return this.$m_2;case "Menu16":return this.$Y_2;case "Menu32":return this.$g_2;case "Large":return this.$H_2;case "Medium":return this.$9_2;case "Small":return this.$A_2;case "Thin":return this.$1y_2;default:this.ensureValidDisplayMode($p0);return null}},onClick:function($p0){var $v_0=this.get_enabled();$v_0&&!this.$n_1&&CUI.PMetrics.perfMark(7190);this.$d_0();$p0.preventDefault();if(!$v_0||this.$n_1)return;this.$0_0.set_$59_1(this);var $v_1=this.get_displayedComponent(),$v_2=$v_1.get_$2_0();this.$7f_2($v_2);!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().Command)&&$v_1.raiseCommandEvent(this.get_$1_2().Command,4,null);CUI.PMetrics.perfMark(7191)},$5C_2:function($p0){this.onBeginFocus();if(!this.get_enabled())return},$HD_2:function($p0){this.onBeginFocus();if(!this.get_enabled()||this.$n_1)return;var $v_0=this.get_displayedComponent(),$v_1=$v_0.get_$2_0();this.$7f_2($v_1);var $v_2=this.get_$1_2().Command;!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_0.raiseCommandEvent($v_2,4,null)},$7j_2:function($p0){this.onBeginFocus();if(!this.get_enabled()||this.$n_1)return;var $v_0=$p0.target;while($v_0.nodeType!==1||$v_0.tagName.toLowerCase()!=="a")$v_0=$v_0.parentNode;var $v_1=$p0.rawEvent.relatedTarget;if(!($v_0===this.$m_2||$v_0===this.$Y_2||$v_0===this.$g_2))return;while($v_1!==$v_0){try{if($v_1.nodeName.toLowerCase()==="body")break}catch($$e_3){break}$v_1=$v_1.parentNode}if($v_1===$v_0)return;var $v_2=this.get_displayedComponent(),$v_3=$v_2.get_$2_0();this.$7f_2($v_3);var $v_4=this.get_$1_2().Command;!CUI.ScriptUtility.isNullOrUndefined($v_4)&&$v_2.raiseCommandEvent($v_4,4,null)},$H5_2:function($p0){var $v_0=Array.indexOf(this.$0_0.$c_1,this),$v_1=this.$0_0.$3L_1;if($v_1!==-1&&$v_0>=this.$0_0.$4p_1){window.clearTimeout($v_1);this.$0_0.$3L_1=-1;this.$0_0.$4p_1=-1}},$HL_2:function($p0){this.onBeginFocus();this.get_displayedComponent().get_displayMode().startsWith("Menu")&&this.$48_2(this.get_enabled());this.get_enabled()&&this.$0_0.set_$s_1(this)},$6E_2:function($p0){this.onEndFocus();if(this.$n_1)return;this.$1Y_2()},$HE_2:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(this.$n_1){for(var $v_0=Array.indexOf(this.$0_0.$c_1,this),$v_1=$v_0;$v_1<this.$0_0.$c_1.length;$v_1++)if(CUI.Utility.isDescendantOf(this.$0_0.$c_1[$v_1].$C_1.get_$2_0(),$p0.rawEvent.toElement))return;this.$7p_2()}this.$1Y_2()},$H3_2:function($p0){this.onEndFocus();if(CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$2_0(),$p0.rawEvent.toElement))return;if(this.$n_1){for(var $v_0=Array.indexOf(this.$0_0.$c_1,this),$v_1=$v_0;$v_1<this.$0_0.$c_1.length;$v_1++)if(CUI.Utility.isDescendantOf(this.$0_0.$c_1[$v_1].$C_1.get_$2_0(),$p0.rawEvent.toElement))return;this.$7p_2()}},$7i_2:function($p0){this.onEndFocus();if(!this.get_enabled()||CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$2_0(),$p0.rawEvent.relatedTarget))return;if(this.$n_1){for(var $v_0=Array.indexOf(this.$0_0.$c_1,this),$v_1=$v_0;$v_1<this.$0_0.$c_1.length;$v_1++)if(CUI.Utility.isDescendantOf(this.$0_0.$c_1[$v_1].$C_1.get_$2_0(),$p0.rawEvent.relatedTarget))return;this.$7p_2()}},$H4_2:function($p0){this.onEndFocus();if(CUI.Utility.isDescendantOf(this.get_displayedComponent().get_$2_0(),$p0.rawEvent.relatedTarget))return;if(this.$n_1){for(var $v_0=Array.indexOf(this.$0_0.$c_1,this),$v_1=$v_0;$v_1<this.$0_0.$c_1.length;$v_1++)if(CUI.Utility.isDescendantOf(this.$0_0.$c_1[$v_1].$C_1.get_$2_0(),$p0.rawEvent.relatedTarget))return;this.$7p_2()}this.$1Y_2()},$Cs_2:function($p0){this.$d_0();if(!this.get_enabled())return;var $v_0=$p0.rawEvent.keyCode;if(this.$n_1)(!this.$0_0._textDirection&&$v_0===39||this.$0_0._textDirection===1&&$v_0===37)&&this.$C_1.$9d_0();else if($v_0===13||$v_0===32||(!this.$0_0._textDirection&&$v_0===39||this.$0_0._textDirection===1&&$v_0===37)&&(!$p0.ctrlKey||!$p0.shiftKey)){this.$1H_1=true;var $v_1=this.get_displayedComponent(),$v_2=$v_1.get_$2_0(),$v_3=this.get_$1_2().Command;!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$v_1.raiseCommandEvent($v_3,4,null);this.$7f_2($v_2)}},$8K_2:false,onModalKeyPress:function($p0){if($p0)if($p0.rawEvent)if((!this.$0_0._textDirection&&$p0.rawEvent.keyCode===37||this.$0_0._textDirection===1&&$p0.rawEvent.keyCode===39)&&this.get_displayedComponent().get_displayMode().startsWith("Menu")||$p0.rawEvent.keyCode===27){this.$0_0.$3Q_1(this);return}if(this.$8P_2){if(this.$8K_2)return;if(this.$C_1.$AO_0())this.$8K_2=true;$p0.preventDefault()}else CUI.MenuLauncher.prototype.onModalKeyPress.call(this,$p0)},onModalBodyClick:function($p0){this.$0_0.$51_1()},onLaunchedMenuClosed:function(){var $v_0=this.$0_0.$3L_1;$v_0!==-1&&window.clearTimeout($v_0);this.$0_0.$3L_1=-1;this.$0_0.$4p_1=-1;this.$1Y_2();this.$d_0();var $v_1=this.get_displayedComponent();if($v_1.get_displayMode().startsWith("Menu")){var $v_2=$v_1.$P_0.$P_0;$v_2.set_$D1_1(null)}$v_1.raiseCommandEvent(this.get_$1_2().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$7p_2:function(){var $v_0=this.$0_0.$3L_1;$v_0!==-1&&window.clearTimeout($v_0);if(null===this.$7x_2)this.$7x_2=this.$$d_$3Q_2;this.$0_0.$4p_1=Array.indexOf(this.$0_0.$c_1,this);this.$0_0.$3L_1=window.setTimeout(this.$7x_2,500)},$7x_2:null,$3Q_2:function(){this.$0_0.$3Q_1(this);this.$0_0.$3L_1=-1;this.$0_0.$4p_1=-1},$8q_2:null,$8o_2:null,$8p_2:null,$7f_2:function($p0){this.$d_0();this.$48_2(true);this.$0_0.$3l_1=false;this.$8K_2=false;var $v_0=this.get_displayedComponent(),$v_1=$v_0.get_displayMode().startsWith("Menu");if($v_1){var $v_2=$v_0.$P_0.$P_0;$v_2.set_$D1_1(this)}this.launchMenu($p0);if(!$v_1)return;if(null===this.$8q_2)this.$8q_2=this.$$d_$H5_2;$addHandler(this.$C_1.get_$2_0(),"mouseover",this.$8q_2);if(Sys.Browser.agent===Sys.Browser.InternetExplorer){if(null===this.$8o_2)this.$8o_2=this.$$d_$H3_2;$addHandler(this.$C_1.get_$2_0(),"mouseleave",this.$8o_2)}else{if(null===this.$8p_2)this.$8p_2=this.$$d_$H4_2;$addHandler(this.$C_1.get_$2_0(),"mouseout",this.$8p_2)}},$1Y_2:function(){var $v_0="ms-cui-ctl-disabledHoveredOver",$v_1="ms-cui-ctl-hoveredOver";CUI.Utility.removeCSSClassFromElement(this.$m_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$Y_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$g_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$H_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$9_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$A_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$1y_2,$v_1);CUI.Utility.removeCSSClassFromElement(this.$m_2,$v_0);CUI.Utility.removeCSSClassFromElement(this.$Y_2,$v_0);CUI.Utility.removeCSSClassFromElement(this.$g_2,$v_0)},$48_2:function($p0){var $v_0="ms-cui-ctl-hoveredOver";if(!$p0){$v_0="ms-cui-ctl-disabledHoveredOver";CUI.Utility.ensureCSSClassOnElement(this.$m_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$Y_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$g_2,$v_0)}else{CUI.Utility.ensureCSSClassOnElement(this.$m_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$Y_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$g_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$H_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$9_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$A_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$1y_2,$v_0)}},$8P_2:false,getTextValue:function(){return this.get_$1_2().LabelText},$AN_0:function(){if(!this.get_enabled())return false;this.receiveFocus();return true},receiveFocus:function(){var $v_0=this.get_displayedComponent().get_$2_0();!CUI.ScriptUtility.isNullOrUndefined($v_0)&&$v_0.focus()},onMenuClosed:function(){this.$1Y_2()},dispose:function(){CUI.MenuLauncher.prototype.dispose.call(this);this.$1y_2=null;this.$4Y_2=null;this.$5f_2=null;this.$H_2=null;this.$2O_2=null;this.$Ai_2=null;this.$9_2=null;this.$2n_2=null;this.$Ak_2=null;this.$m_2=null;this.$Y_2=null;this.$g_2=null;this.$6h_2=null;this.$6i_2=null;this.$5b_2=null;this.$8G_2=null;this.$5c_2=null;this.$8H_2=null;this.$4W_2=null;this.$A_2=null;this.$2p_2=null;this.$An_2=null},get_$1_2:function(){return this.$5_0}};CUI.Controls.GalleryButtonCommandProperties=function(){};CUI.Controls.GalleryButton=function($p0,$p1,$p2,$p3){this.$$d_onBlur=Function.createDelegate(this,this.onBlur);this.$$d_onFocus=Function.createDelegate(this,this.onFocus);this.$$d_onClick=Function.createDelegate(this,this.onClick);CUI.Controls.GalleryButton.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Large");this.addDisplayMode("Menu");this.$5N_1=$p3};CUI.Controls.GalleryButton.prototype={$G_1:null,$K_1:null,$5R_1:null,$5S_1:null,$5N_1:0,createComponentForDisplayModeInternal:function($p0){var $v_0;if($p0==="Menu"){$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandValueId))this.get_properties().CommandValueId=this.get_properties().MenuItemId}else $v_0=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,$p0);return $v_0},createDOMElementForDisplayMode:function($p0){switch($p0){case "Large":case "Menu":var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt;this.$G_1=CUI.Utility.$3("span");this.$G_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$G_1.className="ms-cui-gallerybutton ms-cui-gallerybutton-"+CUI.Utility.$C7[this.$5N_1];this.$K_1=CUI.Utility.$3("a");this.$K_1.title=$v_0;this.$K_1.className="ms-cui-gallerybutton-a";CUI.Utility.$2J(this.$K_1);CUI.Utility.$27(this.get_properties(),this.$K_1);this.$G_1.appendChild(this.$K_1);if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().InnerHTML)){this.$K_1.innerHTML=this.get_properties().InnerHTML;CUI.Utility.$2f(this.$K_1,true,true)}else{if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Image))throw Error.create("InnerHTML or Image must be defined for this GalleryButton");var $v_1=4;switch(this.$5N_1){case 1:$v_1=3;break;case 2:$v_1=4;break;case 3:$v_1=5;break;case 4:$v_1=6;break;case 5:$v_1=7;break;case 6:$v_1=8;break;case 7:$v_1=9;break}this.$5R_1=CUI.Utility.$3("img");this.$5S_1=CUI.Utility.$p(2,$v_1,this.get_properties().Image,this.get_properties().ImageClass,this.$5R_1,true,false,this.get_properties().ImageTop,this.get_properties().ImageLeft);this.$5R_1.alt=$v_0;this.$K_1.appendChild(this.$5S_1)}this.$E6_0($p0);return this.$G_1;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Large":case "Menu":this.$G_1=$v_0;this.$K_1=this.$G_1.childNodes[0];this.$5S_1=this.$K_1.childNodes[0];this.$5R_1=this.$5S_1.childNodes[0];break}},$E6_0:function($p0){switch($p0){case "Large":case "Menu":this.$W_1();break}},$W_1:function(){$addHandler(this.$K_1,"click",this.$$d_onClick);$addHandler(this.$K_1,"focus",this.$$d_onFocus);$addHandler(this.$K_1,"mouseover",this.$$d_onFocus);$addHandler(this.$K_1,"blur",this.$$d_onBlur);$addHandler(this.$K_1,"mouseout",this.$$d_onBlur)},get_$Bb_0:function(){return "GalleryButton"},onEnabledChanged:function($p0){if($p0)CUI.Utility.enableElement(this.$K_1);else CUI.Utility.disableElement(this.$K_1)},onClick:function($p0){this.$d_0();$p0.preventDefault();if(!this.get_enabled())return;this.toggle();var $v_0=1,$v_1=this.get_properties().CommandType,$v_2=this.get_stateProperties();$v_2[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;$v_2["MenuItemId"]=this.get_properties().MenuItemId;$v_2["SourceControlId"]=this.get_properties().Id;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection")$v_0=3;this.get_displayedComponent().raiseCommandEvent(this.get_properties().Command,$v_0,$v_2);if(this.$0_0.get_$6G_1())this.$HT_0();else this.$6J_1(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On])},onFocus:function($p0){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$s_1(this);if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandPreview))return;var $v_0=5,$v_1=this.get_properties().CommandType;this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection")$v_0=7;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandPreview,$v_0,this.get_stateProperties())},onBlur:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().CommandRevert))return;var $v_0=6,$v_1=this.get_properties().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection"){$v_0=8;this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId}this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandRevert,$v_0,this.get_stateProperties())},getDropDownDOMElementForDisplayMode:function($p0){return CUI.Utility.$3("span")},deselect:function(){this.set_selected(false)},getMenuItemId:function(){return this.get_properties().MenuItemId},getCommandValueId:function(){return this.get_properties().CommandValueId},focusOnDisplayedComponent:function(){this.receiveFocus()},getTextValue:function(){return this.get_properties().Alt},receiveFocus:function(){this.$K_1.focus()},onMenuClosed:function(){CUI.Control.prototype.onMenuClosed.call(this)},$48_1:function(){CUI.Utility.ensureCSSClassOnElement(this.$G_1,"ms-cui-gallerybutton-highlighted")},$1Y_1:function(){CUI.Utility.removeCSSClassFromElement(this.$G_1,"ms-cui-gallerybutton-highlighted")},toggle:function(){var $v_0=!this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On];this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]=$v_0;this.$6J_1($v_0)},$6J_1:function($p0){if($p0)this.$48_1();else this.$1Y_1()},$HT_0:function(){var $v_0=this.get_stateProperties();$v_0[CUI.Controls.GalleryButtonCommandProperties.CommandValueId]=this.get_properties().CommandValueId;$v_0["MenuItemId"]=this.get_properties().MenuItemId;$v_0["SourceControlId"]=this.get_properties().Id;var $v_1=this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,$v_0,false);$v_1&&this.$6J_1(this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On])},get_selected:function(){return this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]},set_selected:function($p0){this.get_stateProperties()[CUI.Controls.GalleryButtonCommandProperties.On]=$p0;if($p0)this.$48_1();else this.$1Y_1();return $p0},get_elementDimensions:function(){return this.$5N_1},set_elementDimensions:function($p0){this.$5N_1=$p0;return $p0},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$G_1=null;this.$K_1=null;this.$5R_1=null;this.$5S_1=null},get_properties:function(){return this.$5_0}};CUI.Controls.InsertTableCommandProperties=function(){};CUI.Controls.InsertTable=function($p0,$p1,$p2){this.$$d_$Co_1=Function.createDelegate(this,this.$Co_1);this.$$d_$Cq_1=Function.createDelegate(this,this.$Cq_1);this.$$d_$Cp_1=Function.createDelegate(this,this.$Cp_1);this.$$d_$Gs_1=Function.createDelegate(this,this.$Gs_1);this.$1z_1=-1;this.$5E_1=-1;this.$5F_1=-1;CUI.Controls.InsertTable.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Menu")};CUI.Controls.InsertTable.prototype={$2s_1:null,$5w_1:null,createComponentForDisplayModeInternal:function($p0){if(this.$q_0.length>0)throw Error.create("Only one ControlComponent can be created for each InsertTable Control");var $v_0;$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);return $v_0},$G_1:null,$3g_1:null,createDOMElementForDisplayMode:function($p0){switch($p0){case "Menu":this.$G_1=CUI.Utility.$3("table");this.$G_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$3g_1=CUI.Utility.$3("tbody");this.$3g_1.className="ms-cui-it";this.$G_1.setAttribute("cellspacing","0");this.$G_1.setAttribute("cellpadding","0");this.$3g_1.setAttribute("cellspacing","0");this.$3g_1.setAttribute("cellpadding","0");$addHandler(this.$G_1,"mouseout",this.$$d_$Gs_1);this.$FC_1();for(var $v_0,$v_1,$v_2,$v_3,$v_4,$v_5=0,$v_6=0;$v_6<10;$v_6++){$v_0=CUI.Utility.$3("tr");this.$3g_1.appendChild($v_0);for(var $v_7=0;$v_7<10;$v_7++){$v_1=CUI.Utility.$3("td");$v_1.style.padding="0px";$v_0.appendChild($v_1);$v_2=CUI.Utility.$3("a");CUI.Utility.$2J($v_2);CUI.Utility.$27(this.get_$1_1(),$v_2);$addHandler($v_2,"focus",this.$$d_$Cp_1);$v_3=CUI.Utility.$3("div");$v_3.className="ms-cui-it-inactiveCell";$v_4=CUI.Utility.$3("div");$v_4.id=this.$4_0+"-"+$v_5;$v_4.className="ms-cui-it-inactiveCellOuter";$addHandler($v_1,"mouseover",this.$$d_$Cq_1);$addHandler($v_1,"click",this.$$d_$Co_1);$v_1.appendChild($v_4);$v_4.appendChild($v_3);$v_3.appendChild($v_2);this.$2s_1[$v_5]=$v_3;this.$5w_1[$v_5]=$v_4;$v_5++}}this.$G_1.appendChild(this.$3g_1);return this.$G_1;default:this.ensureValidDisplayMode($p0);break}return null},onEnabledChanged:function($p0){},get_$Bb_0:function(){return "InsertTable"},$Co_1:function($p0){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7702);$p0.preventDefault();if(!this.get_enabled())return;var $v_0=this.$9l_1($p0.target),$v_1=this.$9j_1($v_0),$v_2=this.$68_1($v_1),$v_3=this.$69_1($v_1);this.$9M_1();this.get_commandProperties()["Rows"]=$v_3+1;this.get_commandProperties()["Columns"]=$v_2+1;this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().Command,1,this.get_commandProperties());!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7703)},$9l_1:function($p0){while($p0.hasChildNodes())$p0=$p0.childNodes[0];return $p0.parentNode.parentNode},$Dc_1:function($p0){var $v_0=$p0.childNodes[0].childNodes[0],$v_1=this.$9j_1($p0);$v_0.title=this.$C9_1(this.$69_1($v_1)+1,this.$68_1($v_1)+1)},$C9_1:function($p0,$p1){var $v_0=this.get_$1_1().Alt;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0=this.get_$1_1().MenuSectionTitle;$v_0=String.format($v_0,$p1.toString(),$p0.toString());return $v_0},$Cq_1:function($p0){if(!this.get_enabled())return;var $v_0=this.$9l_1($p0.target);this.$Dc_1($v_0);this.$CO_1($v_0)},$Cp_1:function($p0){if(!this.get_enabled())return;var $v_0=this.$9l_1($p0.target);this.$Dc_1($v_0);this.$CO_1($v_0)},$Gs_1:function($p0){var $v_0=CUI.Utility.$CD(this.$G_1);($p0.clientX<=$v_0.x||$p0.clientX>=$v_0.x+$v_0.width||$p0.clientY<=$v_0.y||$p0.clientY>=$v_0.y+$v_0.height)&&this.$7n_1()},$7n_1:function(){this.$II_1();this.$9V_1();this.$5E_1=-1;this.$5F_1=-1;this.$4D_1=false},$9j_1:function($p0){return parseInt($p0.id.substr(this.$4_0.length+1))},$4D_1:false,$CO_1:function($p0){var $v_0=this.$9j_1($p0);if(this.$1z_1===$v_0)return;this.$GA_1($v_0)},$GA_1:function($p0){this.$E2_1($p0);this.$1z_1=$p0;this.$9V_1();this.$DN_1($p0)},$69_1:function($p0){return Math.floor($p0/10)},$68_1:function($p0){return $p0%10},$E2_1:function($p0){var $v_0=this.$68_1($p0),$v_1=this.$69_1($p0),$v_2=-1,$v_3=-1;if(this.$1z_1!==-1){$v_2=this.$69_1(this.$1z_1);$v_3=this.$68_1(this.$1z_1)}while($v_2!==$v_1||$v_3!==$v_0)if($v_2<$v_1)this.$DY_1(++$v_2,$v_3,true);else if($v_2>$v_1){this.$DY_1($v_2,$v_3,false);$v_2--}else if($v_3<$v_0)this.$DQ_1(++$v_3,$v_2,true);else if($v_3>$v_0){this.$DQ_1($v_3,$v_2,false);$v_3--}this.get_$CU_1().$Db_1(this.$C9_1($v_1+1,$v_0+1))},$DY_1:function($p0,$p1,$p2){for(var $v_0=0;$v_0<=$p1;$v_0++)this.$DO_1($p0,$v_0,$p2)},$DQ_1:function($p0,$p1,$p2){for(var $v_0=0;$v_0<=$p1;$v_0++)this.$DO_1($v_0,$p0,$p2)},$DO_1:function($p0,$p1,$p2){var $v_0=$p0*10+$p1,$v_1=this.$2s_1[$v_0],$v_2=this.$5w_1[$v_0];if($p2){$v_1.className="ms-cui-it-activeCell";$v_2.className="ms-cui-it-activeCellOuter"}else{$v_1.className="ms-cui-it-inactiveCell";$v_2.className="ms-cui-it-inactiveCellOuter"}},$II_1:function(){for(var $v_1=0;$v_1<100;$v_1++){this.$2s_1[$v_1].className="ms-cui-it-inactiveCell";this.$5w_1[$v_1].className="ms-cui-it-inactiveCellOuter"}this.$1z_1=-1;var $v_0=this.get_$1_1().MenuSectionInitialTitle;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0="";this.get_$CU_1().$Db_1($v_0)},$FC_1:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$2s_1))this.$2s_1=new Array(100);if(CUI.ScriptUtility.isNullOrUndefined(this.$5w_1))this.$5w_1=new Array(100)},receiveFocus:function(){var $v_0=this.$2s_1[0];if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;$v_0.firstChild.focus()},$9M_1:function(){this.$5E_1=-1;this.$5F_1=-1;this.$4D_1=false},$9V_1:function(){if(this.$4D_1){var $v_0=this.get_$1_1().CommandRevert;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){this.get_commandProperties()["Rows"]=this.$5F_1+1;this.get_commandProperties()["Columns"]=this.$5E_1+1;this.get_displayedComponent().raiseCommandEvent($v_0,6,this.get_commandProperties())}this.$9M_1()}},$DN_1:function($p0){this.$5E_1=this.$68_1($p0);this.$5F_1=this.$69_1($p0);this.$4D_1=true;var $v_0=this.get_$1_1().CommandPreview;if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){this.get_commandProperties()["Rows"]=this.$5F_1+1;this.get_commandProperties()["Columns"]=this.$5E_1+1;this.get_displayedComponent().raiseCommandEvent($v_0,5,this.get_commandProperties())}},get_$CU_1:function(){var $v_0=this.get_displayedComponent().$P_0;if(!CUI.MenuSection.isInstanceOfType($v_0))throw Error.create("InsertTable must live inside of a MenuSection.");return $v_0},onMenuClosed:function(){this.$7n_1()},$7T_0:function(){if(this.$1z_1===99){this.$7n_1();return false}this.$2s_1[this.$1z_1+1].firstChild.focus();return true},$7U_0:function(){if(!this.$1z_1){this.$7n_1();return false}else if(this.$1z_1===-1)this.$2s_1[99].firstChild.focus();else this.$2s_1[this.$1z_1-1].firstChild.focus();return true},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$G_1=null;this.$3g_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.LabelCommandProperties=function(){};CUI.Controls.Label=function($p0,$p1,$p2){CUI.Controls.Label.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Medium");this.addDisplayMode("Small")};CUI.Controls.Label.prototype={$G_1:null,$6c_1:null,$2k_1:null,$A_1:null,$5e_1:null,$7I_1:"",createDOMElementForDisplayMode:function($p0){var $v_0=this.get_$1_1().ForId,$v_1=this.get_$1_1().LabelText;switch($p0){case "Medium":if($v_0){this.$G_1=CUI.Utility.$3("label");if(CUI.Utility.$4A())this.$G_1.setAttribute("htmlFor",$v_0);else this.$G_1.setAttribute("for",$v_0)}else this.$G_1=CUI.Utility.$3("span");this.$G_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$G_1.className="ms-cui-ctl-small ms-cui-fslb";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().Image16by16)){this.$6c_1=CUI.Utility.$3("img");var $v_4=CUI.Utility.$p(2,3,this.get_$1_1().Image16by16,this.get_$1_1().Image16by16Class,this.$6c_1,true,false,this.get_$1_1().Image16by16Top,this.get_$1_1().Image16by16Left),$v_5=CUI.Utility.$3("span");$v_5.className="ms-cui-ctl-iconContainer";$v_5.appendChild($v_4);this.$G_1.appendChild($v_5)}this.$2k_1=CUI.Utility.$3("span");this.$2k_1.className="ms-cui-ctl-mediumlabel";!CUI.ScriptUtility.isNullOrUndefined($v_1)&&CUI.UIUtility.setInnerText(this.$2k_1,$v_1);this.$G_1.appendChild(this.$2k_1);return this.$G_1;case "Small":if($v_0){this.$A_1=CUI.Utility.$3("label");if(CUI.Utility.$4A())this.$A_1.setAttribute("htmlFor",$v_0);else this.$A_1.setAttribute("for",$v_0)}else this.$A_1=CUI.Utility.$3("span");this.$A_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$A_1.className="ms-cui-ctl-small ms-cui-fslb";if(CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().Image16by16))throw Error.argumentNull("Image16by16","Small display mode must have an icon set");this.$5e_1=CUI.Utility.$3("img");var $v_2=CUI.Utility.$p(2,3,this.get_$1_1().Image16by16,this.get_$1_1().Image16by16Class,this.$5e_1,true,false,this.get_$1_1().Image16by16Top,this.get_$1_1().Image16by16Left);if(!CUI.ScriptUtility.isNullOrUndefined($v_1))this.$5e_1.alt=$v_1;var $v_3=CUI.Utility.$3("span");$v_3.className="ms-cui-ctl-iconContainer";$v_3.appendChild($v_2);this.$A_1.appendChild($v_3);return this.$A_1;default:this.ensureValidDisplayMode($p0);break}return null},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Medium":this.$G_1=$v_0;if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().Image16by16)){this.$6c_1=this.$G_1.firstChild.firstChild.firstChild;this.$2k_1=this.$G_1.childNodes[1]}else this.$2k_1=this.$G_1.firstChild;break;case "Small":this.$A_1=$v_0;this.$5e_1=this.$A_1.firstChild.firstChild.firstChild;break}},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$G_1,$p0);CUI.Utility.setEnabledOnElement(this.$A_1,$p0)},get_$Bb_0:function(){return "Label"},$HT_0:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().Command))return;var $v_0=this.pollForStateAndUpdateInternal(this.get_$1_1().Command,this.get_$1_1().QueryCommand,this.get_stateProperties(),false);if($v_0&&!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().QueryCommand)){var $v_1=this.$7I_1;if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_stateProperties()[CUI.Controls.LabelCommandProperties.Value])){CUI.UIUtility.setInnerText(this.$2k_1,this.get_stateProperties()[CUI.Controls.LabelCommandProperties.Value]);this.$7I_1=this.get_stateProperties()[CUI.Controls.LabelCommandProperties.Value]}else{CUI.UIUtility.setInnerText(this.$2k_1,this.get_$1_1().LabelText);this.$7I_1=this.get_$1_1().LabelText}if(this.$7I_1!==$v_1)this.$0_0.$4H_1=true}},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$G_1=null;this.$6c_1=null;this.$2k_1=null;this.$A_1=null;this.$5e_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.MRUSplitButton=function($p0,$p1,$p2,$p3){this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_$Cz_3=Function.createDelegate(this,this.$Cz_3);this.$$d_$HJ_3=Function.createDelegate(this,this.$HJ_3);this.$$d_$HK_3=Function.createDelegate(this,this.$HK_3);CUI.Controls.MRUSplitButton.initializeBase(this,[$p0,$p1,$p2,$p3])};CUI.Controls.MRUSplitButton.prototype={$H_3:null,$1T_3:null,$V_3:null,$2O_3:null,$9_3:null,$f_3:null,$X_3:null,$2n_3:null,$A_3:null,$1e_3:null,$Z_3:null,$2p_3:null,$1p_3:false,$4J_3:false,$AN_0:function(){if(!this.get_enabled())return false;if(this.$1p_3){this.get_displayedComponent().get_$2_0().firstChild.firstChild.focus();return true}return false},createDOMElementForDisplayMode:function($p0){var $v_0=true,$v_1=CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().Alt)?"":this.get_properties().Alt,$v_2=$p0==="Medium"&&!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Width)?this.get_properties().Width:"auto",$v_3=null,$v_4=this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(CUI.ScriptUtility.isNullOrUndefined($v_4))$v_4=this.get_properties().InitialItem;this.$4J_3=true;switch($p0){case "Large":this.$H_3=CUI.Utility.$3("span");this.$H_3.setAttribute("mscui:controltype",this.get_$Bb_0());CUI.Utility.ensureCSSClassOnElement(this.$H_3,"ms-cui-ctl-large");this.$1T_3=CUI.Utility.$3("span");this.$1T_3.className="ms-cui-mrusb-selecteditem";if(!this.$32_2($v_4))if(!CUI.Utility.$15(this.get_properties().PopulateDynamically))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");else{this.$1T_3.style.width="32px";this.$1T_3.style.height="32px"}this.$V_3=CUI.Utility.$3("a");this.$V_3.className="ms-cui-ctl-a2";this.$V_3.style.display="block";this.$V_3.setAttribute("role",this.get_$43_0());this.$V_3.setAttribute("aria-haspopup",true);CUI.Utility.$2J(this.$V_3);CUI.Utility.$27(this.get_properties(),this.$V_3);this.$2O_3=CUI.Utility.$3("img");var $v_5=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$2O_3,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){$v_0=false;this.$V_3.title=$v_1;this.$2O_3.alt=$v_1}this.$E6_0($p0);this.$V_3.appendChild($v_5);if($v_0){$v_3=CUI.Utility.$3U($v_1);this.$V_3.appendChild($v_3)}this.$H_3.appendChild(this.$1T_3);this.$H_3.appendChild(this.$V_3);this.$4J_3=false;return this.$H_3;case "Medium":this.$9_3=CUI.Utility.$3("span");this.$9_3.setAttribute("mscui:controltype",this.get_$Bb_0());this.$9_3.className="ms-cui-ctl-medium ms-cui-ctl";this.$f_3=CUI.Utility.$3("span");this.$f_3.className="ms-cui-mrusb-selecteditem";this.$f_3.style.width=$v_2;if(!this.$32_2($v_4))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");this.$X_3=CUI.Utility.$3("a");CUI.Utility.$2J(this.$X_3);CUI.Utility.$27(this.get_properties(),this.$X_3);this.$X_3.className="ms-cui-ctl";this.$X_3.setAttribute("role",this.get_$43_0());this.$X_3.setAttribute("aria-haspopup",true);this.$2n_3=CUI.Utility.$3("img");if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){$v_0=false;this.$X_3.title=$v_1;this.$2n_3.alt=$v_1}var $v_6=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$2n_3,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);this.$E6_0($p0);this.$X_3.appendChild($v_6);if($v_0){$v_3=CUI.Utility.$3U($v_1);this.$X_3.appendChild($v_3)}this.$9_3.appendChild(this.$f_3);this.$9_3.appendChild(this.$X_3);this.$4J_3=false;return this.$9_3;case "Small":this.$A_3=CUI.Utility.$3("span");this.$A_3.setAttribute("mscui:controltype",this.get_$Bb_0());this.$A_3.className="ms-cui-ctl-medium ms-cui-ctl";this.$1e_3=CUI.Utility.$3("span");this.$1e_3.className="ms-cui-mrusb-selecteditem";this.$1e_3.style.width=$v_2;if(!this.$32_2($v_4))throw Error.create("No menu item with id '"+this.get_properties().InitialItem+"' exists in this control's menu");this.$Z_3=CUI.Utility.$3("a");CUI.Utility.$2J(this.$Z_3);CUI.Utility.$27(this.get_properties(),this.$Z_3);this.$Z_3.setAttribute("role",this.get_$43_0());this.$Z_3.setAttribute("aria-haspopup",true);this.$Z_3.className="ms-cui-ctl ms-cui-mrusb-arwbtn";this.$2p_3=CUI.Utility.$3("img");if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ToolTipTitle)){this.$Z_3.title=$v_1;this.$2p_3.alt=$v_1;$v_0=false}var $v_7=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$2p_3,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);this.$E6_0($p0);this.$Z_3.appendChild($v_7);if($v_0){$v_3=CUI.Utility.$3U($v_1);this.$Z_3.appendChild($v_3)}this.$A_3.appendChild(this.$1e_3);this.$A_3.appendChild(this.$Z_3);this.$4J_3=false;return this.$A_3;default:this.$4J_3=false;this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Large":this.$H_3=$v_0;this.$1T_3=this.$H_3.childNodes[0];this.$V_3=this.$H_3.childNodes[1];this.$2O_3=this.$V_3.childNodes[0].childNodes[0];break;case "Medium":this.$9_3=$v_0;this.$f_3=this.$9_3.childNodes[0];this.$X_3=this.$9_3.childNodes[1];this.$2n_3=this.$X_3.childNodes[0].childNodes[0];break;case "Small":this.$A_3=$v_0;this.$1e_3=this.$A_3.childNodes[0];this.$Z_3=this.$A_3.childNodes[1];this.$2p_3=this.$Z_3.childNodes[0].childNodes[0];break}},$E6_0:function($p0){this.$W_3($p0)},$W_3:function($p0){switch($p0){case "Large":$addHandler(this.$V_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$1T_3,"mouseover",this.$$d_$HK_3);$addHandler(this.$1T_3,"mouseout",this.$$d_$HJ_3);$addHandler(this.$V_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$V_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$V_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$V_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$V_3,"keypress",this.$$d_onArrowButtonKeyPress);break;case "Medium":$addHandler(this.$X_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$f_3,"mouseover",this.$$d_$HK_3);$addHandler(this.$f_3,"mouseout",this.$$d_$HJ_3);$addHandler(this.$X_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$X_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$X_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$X_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$X_3,"keypress",this.$$d_onArrowButtonKeyPress);break;case "Small":$addHandler(this.$Z_3,"click",this.$$d_onArrowButtonClick);$addHandler(this.$1e_3,"mouseover",this.$$d_$HK_3);$addHandler(this.$1e_3,"mouseout",this.$$d_$HJ_3);$addHandler(this.$Z_3,"mouseover",this.$$d_onArrowButtonFocus);$addHandler(this.$Z_3,"mouseout",this.$$d_onArrowButtonBlur);$addHandler(this.$Z_3,"focus",this.$$d_onArrowButtonKeyboardFocus);$addHandler(this.$Z_3,"blur",this.$$d_onArrowButtonBlur);$addHandler(this.$Z_3,"keypress",this.$$d_onArrowButtonKeyPress);break}},get_$Bb_0:function(){return "MRUSplitButton"},selectMenuItem:function($p0){if(this._selectedControl===$p0&&!this.$4J_3)return;var $v_0=!CUI.ScriptUtility.isNullOrUndefined(this.get_displayedComponent())?this.get_displayedComponent().get_title():this.$85_0,$v_1;switch($v_0){case "Large":$v_1=this.$1T_3;break;case "Medium":$v_1=this.$f_3;break;case "Small":$v_1=this.$1e_3;break;default:throw Error.create("Invalid display mode on split button while selecting a menu item")}this._selectedControl=$p0;this.get_stateProperties()[CUI.Controls.DropDownCommandProperties.SelectedItemId]=$p0.getMenuItemId();var $v_2=$p0;if(CUI.MenuItem.isInstanceOfType($v_2.get_displayedComponent()))this.$C_1.$4v_1=$v_2.get_displayedComponent();var $v_3=this._selectedControl.getDropDownDOMElementForDisplayMode($v_0);if($v_3.childNodes.length>1){var $v_4=$v_3.childNodes[1];if($v_4.childNodes.length>1)if($v_4.childNodes[1].tagName.toLowerCase()==="br"){var $v_5=CUI.Utility.$3("span");CUI.Utility.$3Y($v_5," ");$v_4.replaceChild($v_5,$v_4.childNodes[1])}}$v_3.id=this.$4_0+"-SelectedItem";if($v_1.hasChildNodes()){var $v_6=$v_1.firstChild;$v_1.replaceChild($v_3,$v_6);$clearHandlers($v_6)}else $v_1.appendChild($v_3);$addHandler($v_3,"click",this.$$d_$Cz_3);$addHandler($v_3,"dblclick",this.$$d_onDblClick)},addDisplayModes:function(){this.addDisplayMode("Large");this.addDisplayMode("Medium");this.addDisplayMode("Small")},launchMenuInternal:function($p0){var $v_0=false;this.$0_0.$3l_1=false;switch(this.get_displayedComponent().get_title()){case "Large":$v_0=this.launchMenu(this.$V_3,this.$$d_sendMenuCreationCommandEvent);break;case "Medium":$v_0=this.launchMenu(this.$X_3,this.$$d_sendMenuCreationCommandEvent);break;case "Small":$v_0=this.launchMenu(this.$Z_3,this.$$d_sendMenuCreationCommandEvent);break}$v_0&&this.sendMenuCreationCommandEvent()},onEnabledChanged:function($p0){CUI.Controls.DropDown.prototype.onEnabledChanged.call(this,$p0);var $v_0="ms-cui-disabled";this.$1p_3=$p0;if($p0){CUI.Utility.removeCSSClassFromElement(this.$H_3,$v_0);CUI.Utility.enableElement(this.$V_3);CUI.Utility.removeCSSClassFromElement(this.$9_3,$v_0);CUI.Utility.enableElement(this.$X_3);CUI.Utility.removeCSSClassFromElement(this.$A_3,$v_0);CUI.Utility.enableElement(this.$Z_3)}else{CUI.Utility.ensureCSSClassOnElement(this.$H_3,$v_0);CUI.Utility.disableElement(this.$V_3);CUI.Utility.ensureCSSClassOnElement(this.$9_3,$v_0);CUI.Utility.disableElement(this.$X_3);CUI.Utility.ensureCSSClassOnElement(this.$A_3,$v_0);CUI.Utility.disableElement(this.$Z_3)}CUI.Utility.setEnabledOnElement(this.$V_3,$p0);CUI.Utility.setEnabledOnElement(this.$X_3,$p0);CUI.Utility.setEnabledOnElement(this.$Z_3,$p0)},onDblClick:function($p0){this.$d_0();$p0.preventDefault();if(!this.get_enabled())return;this.$Cz_3($p0)},$Cz_3:function($p0){CUI.PMetrics.perfMark(7735);this.$d_0();$p0.preventDefault();if(!this.get_enabled())return;var $v_0=3;this.get_displayedComponent().raiseCommandEvent(this.get_properties().Command,$v_0,{CommandValueId:this._selectedControl.getCommandValueId()})},$HK_3:function($p0){this.onBeginFocus();if(!this.get_enabled())return;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.ensureCSSClassOnElement(this.$1T_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$V_3,"ms-cui-ctl-split-hover");break;case "Medium":CUI.Utility.ensureCSSClassOnElement(this.$f_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$X_3,"ms-cui-ctl-split-hover");break;case "Small":CUI.Utility.ensureCSSClassOnElement(this.$1e_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.ensureCSSClassOnElement(this.$Z_3,"ms-cui-ctl-split-hover");break}if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandPreview,5,{CommandValueId:this._selectedControl.getCommandValueId()})},$HJ_3:function($p0){this.onEndFocus();if(!this.get_enabled())return;switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.removeCSSClassFromElement(this.$1T_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$V_3,"ms-cui-ctl-split-hover");break;case "Medium":CUI.Utility.removeCSSClassFromElement(this.$f_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$X_3,"ms-cui-ctl-split-hover");break;case "Small":CUI.Utility.removeCSSClassFromElement(this.$1e_3,"ms-cui-ctl-light-hoveredOver");CUI.Utility.removeCSSClassFromElement(this.$Z_3,"ms-cui-ctl-split-hover");break}if(CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandRevert,6,{CommandValueId:this._selectedControl.getCommandValueId()})},highlight:function(){switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.ensureCSSClassOnElement(this.$1T_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$V_3,"ms-cui-ctl-light-hoveredOver");break;case "Medium":CUI.Utility.ensureCSSClassOnElement(this.$f_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$X_3,"ms-cui-ctl-light-hoveredOver");break;case "Small":CUI.Utility.ensureCSSClassOnElement(this.$1e_3,"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement(this.$Z_3,"ms-cui-ctl-light-hoveredOver");break}},removeHighlight:function(){switch(this.get_displayedComponent().get_title()){case "Large":CUI.Utility.removeCSSClassFromElement(this.$1T_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$V_3,"ms-cui-ctl-light-hoveredOver");break;case "Medium":CUI.Utility.removeCSSClassFromElement(this.$f_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$X_3,"ms-cui-ctl-light-hoveredOver");break;case "Small":CUI.Utility.removeCSSClassFromElement(this.$1e_3,"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement(this.$Z_3,"ms-cui-ctl-light-hoveredOver");break}},dispose:function(){CUI.Controls.DropDown.prototype.dispose.call(this);this.$H_3=null;this.$2O_3=null;this.$V_3=null;this.$1T_3=null;this.$9_3=null;this.$2n_3=null;this.$X_3=null;this.$f_3=null;this.$A_3=null;this.$2p_3=null;this.$Z_3=null;this.$1e_3=null}};CUI.Controls.Separator=function($p0,$p1,$p2){CUI.Controls.Separator.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Small")};CUI.Controls.Separator.prototype={$6f_1:null,$6g_1:null,$A_1:null,createDOMElementForDisplayMode:function($p0){switch($p0){case "Small":this.$6f_1=CUI.Utility.$3("img");this.$6f_1.style.cursor="default";this.$6g_1=CUI.Utility.$p(2,11,this.get_$1_1().Image,this.get_$1_1().ImageClass,this.$6f_1,true,false,this.get_$1_1().ImageTop,this.get_$1_1().ImageLeft);this.$A_1=CUI.Utility.$3("span");this.$A_1.className="ms-cui-ctl ms-cui-ctl-small ms-cui-separator";this.$A_1.appendChild(this.$6g_1);return this.$A_1;default:this.ensureValidDisplayMode($p0);break}return null},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Small":this.$6g_1=$v_0;break}},onEnabledChanged:function($p0){},get_$Bb_0:function(){return "Separator"},$HT_0:function(){},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$6f_1=null;this.$6g_1=null;this.$A_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.SpinnerCommandProperties=function(){};CUI.Controls.Spinner=function($p0,$p1,$p2,$p3){this.$$d_$Dv_1=Function.createDelegate(this,this.$Dv_1);this.$$d_$Dw_1=Function.createDelegate(this,this.$Dw_1);this.$$d_$IC_1=Function.createDelegate(this,this.$IC_1);this.$$d_$ID_1=Function.createDelegate(this,this.$ID_1);this.$$d_$Cu_1=Function.createDelegate(this,this.$Cu_1);this.$$d_$HB_1=Function.createDelegate(this,this.$HB_1);this.$$d_$HP_1=Function.createDelegate(this,this.$HP_1);this.$$d_$Gu_1=Function.createDelegate(this,this.$Gu_1);this.$$d_$Cv_1=Function.createDelegate(this,this.$Cv_1);this.$$d_$HC_1=Function.createDelegate(this,this.$HC_1);this.$$d_$HQ_1=Function.createDelegate(this,this.$HQ_1);this.$$d_$Gv_1=Function.createDelegate(this,this.$Gv_1);this.$$d_$H2_1=Function.createDelegate(this,this.$H2_1);this.$$d_$Gy_1=Function.createDelegate(this,this.$Gy_1);this.$$d_$Cr_1=Function.createDelegate(this,this.$Cr_1);this.$$d_$7k_1=Function.createDelegate(this,this.$7k_1);this.$$d_$7h_1=Function.createDelegate(this,this.$7h_1);this.$$d_$A0_1=Function.createDelegate(this,this.$A0_1);this.$$d_$6E_1=Function.createDelegate(this,this.$6E_1);this.$$d_$5C_1=Function.createDelegate(this,this.$5C_1);CUI.Controls.Spinner.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Medium");this.$5J_1=0;this.$4k_1=1;this.$14_1=$p3;this.$o_1=parseFloat(this.get_$1_1().DefaultValue);this.get_stateProperties()["Value"]=this.$o_1;this.$J_1=this.$9b_1(this.get_$1_1().DefaultUnit);if(CUI.ScriptUtility.isNullOrUndefined(this.$J_1))throw Error.create("The default unit is not in the list of valid units");this.get_stateProperties()["Unit"]=this.$J_1.$3p_0};CUI.Controls.Spinner.createUnit=function($p0,$p1,$p2,$p3,$p4,$p5){return new CUI.Unit($p0,$p1,$p2,$p3,$p4,$p5)};CUI.Controls.Spinner.$C4=function($p0,$p1){var $v_0=Math.pow(10,$p1.$6Z_0);return Math.round($p0*$v_0)/$v_0};CUI.Controls.Spinner.prototype={$G_1:null,$E_1:null,$2j_1:null,$i_1:null,$h_1:null,$62_1:null,$4z_1:null,$5P_1:null,$4R_1:null,$J_1:null,$14_1:null,$o_1:0,$7O_1:false,$5J_1:0,$6M_1:0,$B0_1:0,$4k_1:0,$3F_1:0,$4x_1:0,$6S_1:null,$4L_1:false,createDOMElementForDisplayMode:function($p0){switch($p0){case "Medium":this.$G_1=CUI.Utility.$3("span");this.$G_1.className="ms-cui-spn";this.$G_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$E_1=CUI.Utility.$9Q("input");this.$E_1.className="ms-cui-spn-txtbx";this.$E_1.id=this.$4_0;this.$E_1.setAttribute("role","textbox");CUI.Utility.$27(this.get_$1_1(),this.$E_1);CUI.Utility.$AP(this.$E_1,this.get_$1_1().ImeEnabled);this.$2j_1=CUI.Utility.$3("span");this.$2j_1.className="ms-cui-spn-arwbx";this.$i_1=CUI.Utility.$3("a");this.$i_1.className="ms-cui-spn-btnup";this.$i_1.setAttribute("role","spinbutton");this.$h_1=CUI.Utility.$3("a");this.$h_1.className="ms-cui-spn-btndown";this.$h_1.setAttribute("role","spinbutton");this.$62_1=CUI.Utility.$3("img");this.$62_1.alt="";this.$4z_1=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageUpArrow,this.$0_0.$5_1.ImageUpArrowClass,this.$62_1,true,false,this.$0_0.$5_1.ImageUpArrowTop,this.$0_0.$5_1.ImageUpArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$4z_1,"ms-cui-spn-imgcnt");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().AltUpArrow))this.$i_1.title=this.get_$1_1().AltUpArrow;this.$5P_1=CUI.Utility.$3("img");this.$5P_1.alt="";this.$4R_1=CUI.Utility.$p(2,1,this.$0_0.$5_1.ImageDownArrow,this.$0_0.$5_1.ImageDownArrowClass,this.$5P_1,true,false,this.$0_0.$5_1.ImageDownArrowTop,this.$0_0.$5_1.ImageDownArrowLeft);CUI.Utility.ensureCSSClassOnElement(this.$4R_1,"ms-cui-spn-imgcnt");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().AltDownArrow))this.$h_1.title=this.get_$1_1().AltDownArrow;this.$E6_0($p0);this.$G_1.appendChild(this.$E_1);this.$G_1.appendChild(this.$2j_1);this.$2j_1.appendChild(this.$i_1);this.$2j_1.appendChild(this.$h_1);this.$i_1.appendChild(this.$4z_1);this.$h_1.appendChild(this.$4R_1);return this.$G_1;default:this.ensureValidDisplayMode($p0);return null}},$DT_1:function(){this.$Dd_1(parseFloat(this.get_$1_1().DefaultValue));this.$6M_1=parseInt(this.get_$1_1().AccelerationInterval);this.$B0_1=parseInt(this.get_$1_1().MultiplierInterval);this.$6S_1=this.get_$1_1().Command},$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Medium":this.$G_1=$v_0;this.$E_1=this.$G_1.childNodes[0];this.$2j_1=this.$G_1.childNodes[1];this.$i_1=this.$2j_1.childNodes[0];this.$h_1=this.$2j_1.childNodes[1];this.$4z_1=this.$i_1.childNodes[0];this.$4R_1=this.$h_1.childNodes[0];this.$62_1=this.$4z_1.childNodes[0];this.$5P_1=this.$4R_1.childNodes[0];break}},$E6_0:function($p0){switch($p0){case "Medium":this.$W_1();this.$DT_1();break}},$W_1:function(){$addHandler(this.$E_1,"focus",this.$$d_$5C_1);$addHandler(this.$E_1,"blur",this.$$d_$6E_1);$addHandler(this.$E_1,"change",this.$$d_$A0_1);$addHandler(this.$E_1,"mouseover",this.$$d_$7h_1);$addHandler(this.$E_1,"mouseout",this.$$d_$7k_1);$addHandler(this.$E_1,"keypress",this.$$d_$Cr_1);$addHandler(this.$E_1,"keydown",this.$$d_$Gy_1);$addHandler(this.$E_1,"keyup",this.$$d_$H2_1);$addHandler(this.$i_1,"mouseover",this.$$d_$Gv_1);$addHandler(this.$i_1,"mouseout",this.$$d_$HQ_1);$addHandler(this.$i_1,"mousedown",this.$$d_$HC_1);$addHandler(this.$i_1,"mouseup",this.$$d_$Cv_1);$addHandler(this.$h_1,"mouseover",this.$$d_$Gu_1);$addHandler(this.$h_1,"mouseout",this.$$d_$HP_1);$addHandler(this.$h_1,"mousedown",this.$$d_$HB_1);$addHandler(this.$h_1,"mouseup",this.$$d_$Cu_1)},get_$Bb_0:function(){return "Spinner"},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$E_1,$p0)},$AN_0:function(){if(!this.get_enabled())return false;this.$E_1.focus();return true},$5C_1:function($p0){this.onBeginFocus();if(!this.get_enabled())return;this.$0_0.set_$s_1(this);this.$Ch_1($p0);CUI.Utility.$AH(this.$E_1)},$6E_1:function($p0){this.onEndFocus();if(!this.get_enabled())return;this.$3n_1&&this.$5I_1();this.$Ch_1($p0)},$4i_1:false,$Ch_1:function($p0){this.$4i_1=!this.$4i_1;if(this.$4i_1)this.$7h_1($p0);else this.$7k_1($p0)},$A0_1:function($p0){this.$d_0();if(!this.get_enabled())return;if(!this.$IL_1()){this.$3X_1();return}var $v_0=1;this.get_stateProperties()["ChangeType"]="manual";this.get_stateProperties()["ChangedByMouse"]=false;this.get_displayedComponent().raiseCommandEvent(this.$6S_1,$v_0,this.get_stateProperties())},$Ed_0:function(){this.$A0_1(null)},$7h_1:function($p0){if(!this.get_enabled())return;CUI.Utility.ensureCSSClassOnElement(this.$E_1,"ms-cui-spn-txtbx-hover");CUI.Utility.ensureCSSClassOnElement(this.$i_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-spn-btndown-ctl-hover")},$7k_1:function($p0){if(!this.get_enabled())return;if(!this.$4i_1){CUI.Utility.removeCSSClassFromElement(this.$E_1,"ms-cui-spn-txtbx-hover");CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-down");CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-down")}},$Gv_1:function($p0){if(!this.get_enabled())return;this.$7h_1($p0);CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$i_1,"ms-cui-spn-btnup-hover")},$HQ_1:function($p0){if(!this.get_enabled())return;!this.$3n_1&&this.$Cv_1($p0);this.$7k_1($p0);this.$4i_1&&CUI.Utility.ensureCSSClassOnElement(this.$i_1,"ms-cui-spn-btnup-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-hover")},$HC_1:function($p0){if(!this.get_enabled())return;this.$4L_1=true;if($p0.button){this.$5I_1();return}this.$7s_1(1);CUI.Utility.ensureCSSClassOnElement(this.$i_1,"ms-cui-spn-btnup-down")},$Cv_1:function($p0){if(!this.get_enabled())return;this.$5I_1();this.$0_0.set_$s_1(this);CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-down")},$9u_1:function($p0){if(!this.get_enabled())return;if(!this.$1o_1(this.$J_1,this.$o_1+$p0*this.$J_1.$61_0))if(this.$o_1<this.$J_1.$3I_0)this.$1o_1(this.$J_1,this.$J_1.$3I_0);else{this.$3X_1();return}var $v_0=9;this.get_stateProperties()["ChangeType"]="increase";this.get_stateProperties()["ChangedByMouse"]=this.$4L_1;this.get_displayedComponent().raiseCommandEvent(this.$6S_1,$v_0,this.get_stateProperties())},$Gu_1:function($p0){if(!this.get_enabled())return;this.$7h_1($p0);CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-spn-btndown-hover")},$HP_1:function($p0){if(!this.get_enabled())return;!this.$3n_1&&this.$Cu_1($p0);this.$7k_1($p0);this.$4i_1&&CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-spn-btndown-ctl-hover");CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-hover")},$HB_1:function($p0){if(!this.get_enabled())return;this.$4L_1=true;if($p0.button){this.$5I_1();return}this.$7s_1(CUI.Controls.Spinner.$7S);CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-spn-btndown-down")},$Cu_1:function($p0){if(!this.get_enabled())return;this.$5I_1();this.$0_0.set_$s_1(this);CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-down")},$9S_1:function($p0){if(!this.get_enabled())return;if(!this.$1o_1(this.$J_1,this.$o_1-$p0*this.$J_1.$61_0))if(this.$o_1>this.$J_1.$3J_0)this.$1o_1(this.$J_1,this.$J_1.$3J_0);else{this.$3X_1();return}var $v_0=9;this.get_stateProperties()["ChangeType"]="decrease";this.get_stateProperties()["ChangedByMouse"]=this.$4L_1;this.get_displayedComponent().raiseCommandEvent(this.$6S_1,$v_0,this.get_stateProperties())},$Cr_1:function($p0){if(!this.get_enabled())return;this.$4L_1=false;var $v_0=$p0.rawEvent.keyCode;if($v_0===27)this.$3X_1();else if($v_0===13){this.$A0_1($p0);$p0.preventDefault()}else return},$3n_1:false,$Gy_1:function($p0){if(!this.get_enabled())return;if(this.$3n_1)return;this.$4L_1=false;var $v_0=$p0.rawEvent.keyCode;if($v_0===38){this.$7s_1(1);CUI.Utility.ensureCSSClassOnElement(this.$i_1,"ms-cui-spn-btnup-down")}else if($v_0===40){this.$7s_1(CUI.Controls.Spinner.$7S);CUI.Utility.ensureCSSClassOnElement(this.$h_1,"ms-cui-spn-btndown-down")}else return;this.$3n_1=true},$H2_1:function($p0){if(!this.get_enabled())return;if(!this.$3n_1)return;this.$5I_1();CUI.Utility.removeCSSClassFromElement(this.$i_1,"ms-cui-spn-btnup-down");CUI.Utility.removeCSSClassFromElement(this.$h_1,"ms-cui-spn-btndown-down");this.$3n_1=false},$Dw_1:function(){this.$5J_1++;this.$9u_1(this.$C8_1())},$Dv_1:function(){this.$5J_1++;this.$9S_1(this.$C8_1())},$7s_1:function($p0){if(this.$3F_1>-1||this.$4x_1>-1)return;if($p0===1)this.$9u_1(1);else this.$9S_1(1);if($p0===1)this.$4x_1=window.setTimeout(this.$$d_$ID_1,500);else this.$4x_1=window.setTimeout(this.$$d_$IC_1,500)},$5I_1:function(){if(this.$4x_1>-1){window.clearTimeout(this.$4x_1);this.$4x_1=-1}if(this.$3F_1>-1){window.clearInterval(this.$3F_1);this.$3F_1=-1;this.$4k_1=1;this.$5J_1=0}},$ID_1:function(){if(this.$3F_1!==-1)return;this.$3F_1=window.setInterval(this.$$d_$Dw_1,this.$6M_1)},$IC_1:function(){if(this.$3F_1!==-1)return;this.$3F_1=window.setInterval(this.$$d_$Dv_1,this.$6M_1)},$C8_1:function(){var $v_0=this.$5J_1*this.$6M_1;if($v_0>=this.$4k_1*this.$B0_1&&this.$4k_1<=3)this.$4k_1++;return this.$4k_1},$Dd_1:function($p0){this.$o_1=$p0;this.$E_1.value=this.$9c_1($p0,this.$J_1.get_$2z_0());this.get_stateProperties()["Value"]=this.$o_1},get_value:function(){return this.$o_1},set_value:function($p0){if(!this.$1o_1(this.$J_1,$p0))throw Error.create("Invalid value");return $p0},get_unitString:function(){return this.$J_1.get_$2z_0()},set_unitString:function($p0){if(!this.$AX_1(this.$o_1.toString()+$p0)){this.$3X_1();throw Error.create("Invalid unit")}return $p0},$6u_1:false,$6t_1:false,get_$58_1:function(){if(!this.$6u_1){var $v_0=1.1,$v_1=$v_0.toLocaleString().substring(1,2);this.$6t_1=$v_1===",";this.$6u_1=true}return this.$6t_1},$IL_1:function(){var $v_0=this.$E_1.value;return this.$AX_1($v_0)},$AX_1:function($p0){var $v_0="(\\-)?[0-9]*[\\.,]?[0-9]+",$v_1=new RegExp($v_0);$p0=$p0.trim();if($p0.search($v_1))return false;var $v_2=$p0.replace($v_1,""),$v_3=$p0.replace($v_2,""),$v_4=$v_2.trim(),$v_5,$v_6,$v_7=false;if(this.get_$58_1()){$v_3=$v_3.replace(".","");if($v_3.indexOf(",")>-1){$v_7=true;$v_3=$v_3.replace(",",".")}}else $v_3=$v_3.replace(",","");$v_6=parseFloat($v_3);if(!CUI.ScriptUtility.isNullOrEmptyString($v_4))if(this.$J_1.$54_0($v_4))$v_5=this.$J_1;else $v_5=this.$C2_1($v_4);else $v_5=this.$J_1;return this.$1o_1($v_5,$v_6,$v_7)},$1o_1:function($p0,$p1,$p2){if(arguments.length<3)$p2=this.get_$58_1();if(!$p0)return false;var $v_0=$p0.$Dk_0($p1);if($v_0===CUI.Unit.$7Z)return false;else if($v_0===1)$p1=CUI.Controls.Spinner.$C4($p1,$p0);else if($v_0===2)$p1=$p0.$3J_0;else if($v_0===3)$p1=$p0.$3I_0;this.$E_1.value=this.$9c_1($p1,$p0.get_$2z_0(),$p2);this.$J_1=$p0;this.$o_1=$p1;this.$7O_1=$p2;this.get_stateProperties()["Unit"]=$p0.$3p_0;this.get_stateProperties()["Value"]=$p1;return true},$3X_1:function(){this.$E_1.value=this.$9c_1(this.$o_1,this.$J_1.get_$2z_0(),this.$7O_1)},$9c_1:function($p0,$p1,$p2){if(arguments.length<3)$p2=this.get_$58_1();var $v_0=$p0.toString();if($p2)$v_0=$v_0.replace(".",",");return $v_0+" "+$p1},$C2_1:function($p0){for(var $v_0=0;$v_0<this.$14_1.length;$v_0++)if(this.$14_1[$v_0].$54_0($p0))return this.$14_1[$v_0];return null},$9b_1:function($p0){for(var $v_0=0;$v_0<this.$14_1.length;$v_0++){if(this.$14_1[$v_0].$3p_0===$p0)return this.$14_1[$v_0];if(this.$14_1[$v_0].$54_0($p0))return this.$14_1[$v_0]}return null},$HT_0:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.$G_1))return;var $v_0=this.pollForStateAndUpdateInternal(this.get_$1_1().Command,this.get_$1_1().QueryCommand,this.get_stateProperties(),true),$v_1=this.$9b_1(this.get_stateProperties()["Unit"]);if(!this.$1o_1($v_1,this.get_stateProperties()["Value"]))throw Error.create("Invalid valid and/or unit returned when polling")},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$5P_1=null;this.$4R_1=null;this.$62_1=null;this.$4z_1=null;this.$G_1=null;this.$2j_1=null;this.$h_1=null;this.$E_1=null;this.$i_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.SplitButton=function($p0,$p1,$p2,$p3){this.$$d_onMenuButtonKeyPress=Function.createDelegate(this,this.onMenuButtonKeyPress);this.$$d_onMenuButtonABlur=Function.createDelegate(this,this.onMenuButtonABlur);this.$$d_onMenuButtonKeyboardFocus=Function.createDelegate(this,this.onMenuButtonKeyboardFocus);this.$$d_onMenuButtonBlur=Function.createDelegate(this,this.onMenuButtonBlur);this.$$d_onMenuButtonFocus=Function.createDelegate(this,this.onMenuButtonFocus);this.$$d_onMenuButtonClick=Function.createDelegate(this,this.onMenuButtonClick);this.$$d_onButtonKeyboardFocus=Function.createDelegate(this,this.onButtonKeyboardFocus);this.$$d_onButtonBlur=Function.createDelegate(this,this.onButtonBlur);this.$$d_onButtonFocus=Function.createDelegate(this,this.onButtonFocus);this.$$d_onMouseOut=Function.createDelegate(this,this.onMouseOut);this.$$d_onMouseOver=Function.createDelegate(this,this.onMouseOver);this.$$d_onDblClick=Function.createDelegate(this,this.onDblClick);this.$$d_onButtonClick=Function.createDelegate(this,this.onButtonClick);CUI.Controls.SplitButton.initializeBase(this,[$p0,$p1,$p2,$p3]);this.addDisplayMode("Large");this.addDisplayMode("Medium");this.addDisplayMode("Small")};CUI.Controls.SplitButton.prototype={$H_2:null,$Aj_2:null,$5Z_2:null,$4U_2:null,$2O_2:null,$9_2:null,$Al_2:null,$5a_2:null,$4V_2:null,$2n_2:null,$A_2:null,$Ao_2:null,$5d_2:null,$4X_2:null,$2p_2:null,createDOMElementForDisplayMode:function($p0){var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().Alt)?this.get_$1_2().LabelText:this.get_$1_2().Alt,$v_1=CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().MenuAlt)?$v_0:this.get_$1_2().MenuAlt;this.$9R_2=$p0;if(CUI.ScriptUtility.isNullOrUndefined($v_0))$v_0="";if(CUI.ScriptUtility.isNullOrUndefined($v_1))$v_1="";switch($p0){case "Large":this.$H_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Large",this.get_$1_2().Id,this.get_$1_2().Image32by32,this.get_$1_2().Image32by32Class,this.get_$1_2().Image32by32Top,this.get_$1_2().Image32by32Left,this.get_$1_2().Image16by16,this.get_$1_2().Image16by16Class,this.get_$1_2().Image16by16Top,this.get_$1_2().Image16by16Left,this.get_$1_2().LabelText,this.get_$1_2().Alt,this.get_$1_2().ToolTipTitle,true);this.$E5_0("Large");this.$E6_0($p0);return this.$H_2;case "Medium":this.$9_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Medium",this.get_$1_2().Id,this.get_$1_2().Image32by32,this.get_$1_2().Image32by32Class,this.get_$1_2().Image32by32Top,this.get_$1_2().Image32by32Left,this.get_$1_2().Image16by16,this.get_$1_2().Image16by16Class,this.get_$1_2().Image16by16Top,this.get_$1_2().Image16by16Left,this.get_$1_2().LabelText,this.get_$1_2().Alt,this.get_$1_2().ToolTipTitle,true);this.$E5_0("Medium");this.$E6_0($p0);return this.$9_2;case "Small":this.$A_2=CUI.Control.createTwoAnchorControlDOMElementCore(this,this.$0_0,"Small",this.get_$1_2().Id,this.get_$1_2().Image32by32,this.get_$1_2().Image32by32Class,this.get_$1_2().Image32by32Top,this.get_$1_2().Image32by32Left,this.get_$1_2().Image16by16,this.get_$1_2().Image16by16Class,this.get_$1_2().Image16by16Top,this.get_$1_2().Image16by16Left,this.get_$1_2().LabelText,this.get_$1_2().Alt,this.get_$1_2().ToolTipTitle,true);this.$E5_0("Small");this.$E6_0($p0);return this.$A_2;default:this.ensureValidDisplayMode($p0);return null}},$9R_2:null,$E5_0:function($p0){var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);this.$9R_2=$p0;switch($p0){case "Large":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$H_2=$v_0;this.$5Z_2=this.$H_2.childNodes[0];this.$Aj_2=this.$5Z_2.childNodes[0].childNodes[0];this.$4U_2=this.$H_2.childNodes[1];var $v_1=this.$4U_2.childNodes[0];this.$2O_2=null;for(var $v_2=0;$v_2<$v_1.childNodes.length;$v_2++){var $v_3=$v_1.childNodes[$v_2].tagName;if(!CUI.ScriptUtility.isNullOrUndefined($v_3)&&$v_3.toLowerCase()==="span"){this.$2O_2=$v_1.childNodes[$v_2].childNodes[0];break}}break;case "Medium":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$9_2=$v_0;this.$5a_2=this.$9_2.childNodes[0];this.$Al_2=this.$5a_2.childNodes[0].childNodes[0];this.$4V_2=this.$9_2.childNodes[1];this.$2n_2=this.$4V_2.childNodes[0].childNodes[0].childNodes[0];break;case "Small":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$A_2=$v_0;this.$5d_2=this.$A_2.childNodes[0];this.$Ao_2=this.$5d_2.childNodes[0].childNodes[0];this.$4X_2=this.$A_2.childNodes[1];this.$2p_2=this.$4X_2.childNodes[0].childNodes[0].childNodes[0];break}},$E6_0:function($p0){this.$W_2($p0)},$W_2:function($p0){var $v_0=null,$v_1=null;switch($p0){case "Large":$v_0=this.$5Z_2;$v_1=this.$4U_2;break;case "Medium":$v_0=this.$5a_2;$v_1=this.$4V_2;break;case "Small":$v_0=this.$5d_2;$v_1=this.$4X_2;break}$addHandler($v_0,"click",this.$$d_onButtonClick);$addHandler($v_0,"dblclick",this.$$d_onDblClick);$addHandler($v_0,"mouseover",this.$$d_onMouseOver);$addHandler($v_0,"mouseout",this.$$d_onMouseOut);$addHandler($v_0,"mouseover",this.$$d_onButtonFocus);$addHandler($v_0,"mouseout",this.$$d_onButtonBlur);$addHandler($v_0,"focus",this.$$d_onButtonKeyboardFocus);$addHandler($v_0,"blur",this.$$d_onButtonBlur);$addHandler($v_1,"click",this.$$d_onMenuButtonClick);$addHandler($v_1,"mouseover",this.$$d_onMenuButtonFocus);$addHandler($v_1,"mouseout",this.$$d_onMenuButtonBlur);$addHandler($v_1,"focus",this.$$d_onMenuButtonKeyboardFocus);$addHandler($v_1,"blur",this.$$d_onMenuButtonABlur);$addHandler($v_1,"keypress",this.$$d_onMenuButtonKeyPress)},$67_2:false,$AN_0:function(){if(!this.get_enabled())return false;var $v_0=this.get_displayedComponent().get_$2_0();if(!CUI.ScriptUtility.isNullOrUndefined($v_0)){if(this.$67_2||!this.$1p_2)$v_0=$v_0.childNodes[1];else $v_0=$v_0.childNodes[0];$v_0.focus();return true}return false},onEnabledChanged:function($p0){this.onEnabledChangedForControl($p0);this.onEnabledChangedForButton($p0);this.onEnabledChangedForMenu($p0)},get_$Bb_0:function(){return "SplitButton"},onEnabledChangedForControl:function($p0){var $v_0="ms-cui-disabled";if($p0){CUI.Utility.removeCSSClassFromElement(this.$H_2,$v_0);CUI.Utility.removeCSSClassFromElement(this.$9_2,$v_0);CUI.Utility.removeCSSClassFromElement(this.$A_2,$v_0)}else{CUI.Utility.ensureCSSClassOnElement(this.$H_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$9_2,$v_0);CUI.Utility.ensureCSSClassOnElement(this.$A_2,$v_0)}},$2T_2:true,onEnabledChangedForMenu:function($p0){CUI.Utility.setEnabledOnElement(this.$4U_2,$p0);CUI.Utility.setEnabledOnElement(this.$4V_2,$p0);CUI.Utility.setEnabledOnElement(this.$4X_2,$p0);this.$AC_2();this.$2T_2=$p0},$I6_2:function($p0){CUI.Utility.setEnabledOnElement(this.$4U_2,$p0);CUI.Utility.setEnabledOnElement(this.$4V_2,$p0);CUI.Utility.setEnabledOnElement(this.$4X_2,$p0)},$1p_2:false,onEnabledChangedForButton:function($p0){CUI.Utility.setEnabledOnElement(this.$5Z_2,$p0);CUI.Utility.setEnabledOnElement(this.$5a_2,$p0);CUI.Utility.setEnabledOnElement(this.$5d_2,$p0);this.$AB_2();this.$1p_2=$p0},onButtonClick:function($p0){$p0.preventDefault();this.$d_0();if(!this.get_enabled()||!this.$1p_2)return;this.$0_0.set_$59_1(this);this.$67_2=false;var $v_0=this.get_stateProperties();$v_0["CommandValueId"]=this.get_$1_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().Command,1,$v_0)},onDblClick:function($p0){$p0.preventDefault();this.$d_0();if(!this.get_enabled())return;this.onButtonClick($p0)},onMouseOver:function($p0){this.onBeginFocus();if(!this.get_enabled()||!this.$1p_2)return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandPreview))return;var $v_0=this.get_stateProperties();$v_0["CommandValueId"]=this.get_$1_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandPreview,5,$v_0)},onButtonKeyboardFocus:function($p0){this.$0_0.set_$s_1(this);this.$67_2=false;this.onButtonFocus($p0)},onButtonFocus:function($p0){this.onBeginFocus();if(!this.get_enabled()||!this.$1p_2)return;this.$GO_2()},onMouseOut:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandRevert))return;var $v_0=this.get_stateProperties();$v_0["CommandValueId"]=this.get_$1_2().CommandValueId;this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandRevert,6,$v_0)},onButtonBlur:function($p0){this.onEndFocus();if(!this.get_enabled()||!this.$1p_2)return;this.$AB_2()},onMenuButtonClick:function($p0){$p0.preventDefault();this.$d_0();if(!this.get_enabled()||!this.$2T_2)return;this.$0_0.$3l_1=false;this.$0_0.set_$59_1(this);this.$67_2=true;var $v_0=$p0.target;this.launchMenu($v_0);this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandMenuOpen,4,null)},onMenuButtonKeyboardFocus:function($p0){this.onMenuButtonFocus($p0);this.$67_2=true;this.$0_0.set_$s_1(this)},onMenuButtonFocus:function($p0){this.onBeginFocus();if(!this.get_enabled()||!this.$2T_2)return;this.$GP_2()},onMenuButtonBlur:function($p0){this.onEndFocus();if(!this.get_enabled()||this.$n_1||!this.$2T_2)return;this.$AC_2()},onMenuButtonABlur:function($p0){this.onEndFocus();if(!this.get_enabled()||!this.$2T_2)return;this.onMenuButtonBlur($p0)},onMenuButtonKeyPress:function($p0){this.$d_0();if(!this.get_enabled()||!this.$2T_2)return;if($p0.rawEvent.keyCode===13)this.$1H_1=true},onLaunchedMenuClosed:function(){this.$d_0();this.$1Y_2();this.get_displayedComponent().raiseCommandEvent(this.get_$1_2().CommandMenuClose,10,null);CUI.MenuLauncher.prototype.onLaunchedMenuClosed.call(this)},$1Y_2:function(){this.$AB_2();this.$AC_2()},$AB_2:function(){var $v_0=this.$7W_0();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;CUI.Utility.removeCSSClassFromElement($v_0.childNodes[1],"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement($v_0.childNodes[0],"ms-cui-ctl-light-hoveredOver")},$GO_2:function(){var $v_0=this.$7W_0();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;CUI.Utility.ensureCSSClassOnElement($v_0.childNodes[1],"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement($v_0.childNodes[0],"ms-cui-ctl-light-hoveredOver")},$AC_2:function(){var $v_0=this.$7W_0();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;CUI.Utility.removeCSSClassFromElement($v_0.childNodes[0],"ms-cui-ctl-split-hover");CUI.Utility.removeCSSClassFromElement($v_0.childNodes[1],"ms-cui-ctl-light-hoveredOver")},$GP_2:function(){var $v_0=this.$7W_0();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;CUI.Utility.ensureCSSClassOnElement($v_0.childNodes[0],"ms-cui-ctl-split-hover");CUI.Utility.ensureCSSClassOnElement($v_0.childNodes[1],"ms-cui-ctl-light-hoveredOver")},$HT_0:function(){var $v_0=this.$0_0.$6F_1(this.get_$1_2().Command,null,null),$v_1=true;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_2().CommandMenuOpen))$v_1=this.$0_0.$6F_1(this.get_$1_2().CommandMenuOpen,null,null);else $v_1=$v_0;if($v_1!==this.$2T_2||$v_0!==this.$1p_2){this.$1f_0=$v_1||$v_0;var $v_2=this.$2T_2&&this.$1p_2,$v_3=$v_1&&$v_0;$v_2!==$v_3&&this.onEnabledChangedForControl($v_3);this.$I6_2(this.$1f_0);$v_0!==this.$1p_2&&this.onEnabledChangedForButton($v_0);$v_1!==this.$2T_2&&this.onEnabledChangedForMenu($v_1);this.$2T_2=$v_1;this.$1p_2=$v_0}},dispose:function(){CUI.MenuLauncher.prototype.dispose.call(this);this.$H_2=null;this.$Aj_2=null;this.$5Z_2=null;this.$4U_2=null;this.$2O_2=null;this.$9_2=null;this.$Al_2=null;this.$5a_2=null;this.$4V_2=null;this.$2n_2=null;this.$A_2=null;this.$Ao_2=null;this.$5d_2=null;this.$4X_2=null;this.$2p_2=null},get_$1_2:function(){return this.$5_0}};CUI.Controls.TextBoxCommandProperties=function(){};CUI.Controls.TextBox=function($p0,$p1,$p2){this.$$d_$Cr_1=Function.createDelegate(this,this.$Cr_1);this.$$d_$7i_1=Function.createDelegate(this,this.$7i_1);this.$$d_$7j_1=Function.createDelegate(this,this.$7j_1);this.$$d_$6E_1=Function.createDelegate(this,this.$6E_1);this.$$d_$5C_1=Function.createDelegate(this,this.$5C_1);this.$$d_$9z_1=Function.createDelegate(this,this.$9z_1);CUI.Controls.TextBox.initializeBase(this,[$p0,$p1,$p2]);this.addDisplayMode("Medium")};CUI.Controls.TextBox.prototype={$E_1:null,get_value:function(){this.$9W_1();return this.$E_1.value},set_value:function($p0){this.$9W_1();if($p0)this.$E_1.value=$p0;else this.$E_1.value="";return $p0},$9W_1:function(){if(!this.$E_1){this.$E_1=CUI.Utility.$9Q("input");this.$E_1.type="text";CUI.Utility.$AP(this.$E_1,this.get_$1_1().ImeEnabled)}},createDOMElementForDisplayMode:function($p0){switch($p0){case "Medium":this.$9W_1();this.$E_1.id=this.$4_0;this.$E_1.setAttribute("mscui:controltype",this.get_$Bb_0());this.$E_1.setAttribute("role",this.get_$43_0());CUI.Utility.$27(this.get_$1_1(),this.$E_1);this.$E_1.className="ms-cui-tb";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_$1_1().MaxLength)){var $v_0=parseInt(this.get_$1_1().MaxLength);$v_0!==Number.NaN&&this.$E_1.setAttribute("maxlength",$v_0)}if(CUI.Utility.$15(this.get_$1_1().ShowAsLabel)){CUI.Utility.ensureCSSClassOnElement(this.$E_1,"ms-cui-tb-labelmode");this.$E_1.disabled=true}if(!CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().Width))this.$E_1.style.width=this.get_$1_1().Width;this.$W_1();return this.$E_1;default:this.ensureValidDisplayMode($p0);return null}},$E5_0:function($p0){var $v_0=$get(this.$4_0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Medium":this.$E_1=$v_0;break}},$E6_0:function($p0){this.$W_1()},$W_1:function(){$addHandler(this.$E_1,"change",this.$$d_$9z_1);$addHandler(this.$E_1,"focus",this.$$d_$5C_1);$addHandler(this.$E_1,"blur",this.$$d_$6E_1);$addHandler(this.$E_1,"mouseup",CUI.Utility.get_returnFalseHandler());$addHandler(this.$E_1,"mouseover",this.$$d_$7j_1);$addHandler(this.$E_1,"mouseout",this.$$d_$7i_1);$addHandler(this.$E_1,"keypress",this.$$d_$Cr_1)},onEnabledChanged:function($p0){if($p0)CUI.Utility.enableElement(this.$E_1);else CUI.Utility.disableElement(this.$E_1)},get_$Bb_0:function(){return "TextBox"},get_$43_0:function(){return "textbox"},$9z_1:function($p0){this.$d_0();if(!this.get_enabled())return;this.get_stateProperties()["Value"]=this.get_value();this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().Command,1,this.get_stateProperties());if(this.$0_0.get_$6G_1())this.$HT_0();else this.$6J_1(null)},$Ed_0:function(){this.$9z_1(null)},$6J_1:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$E_1))!CUI.ScriptUtility.isNullOrUndefined($p0)&&this.set_value($p0)},$AN_0:function(){if(!this.get_enabled())return false;this.$E_1.focus();return true},$5C_1:function($p0){this.onBeginFocus();if(!this.get_enabled())return;CUI.Utility.$AH(this.$E_1);this.$0_0.set_$s_1(this)},$6E_1:function($p0){this.onEndFocus();if(!this.get_enabled())return},$7j_1:function($p0){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandPreview))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandPreview,5,this.get_stateProperties())},$7i_1:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandRevert))return;this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandRevert,6,this.get_stateProperties())},$Cr_1:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined($p0)&&!CUI.ScriptUtility.isNullOrUndefined($p0.rawEvent))if($p0.rawEvent.keyCode===13){this.$9z_1($p0);$p0.preventDefault()}},$HT_0:function(){var $v_0=this.pollForStateAndUpdateInternal(this.get_$1_1().Command,this.get_$1_1().QueryCommand,this.get_stateProperties(),false);$v_0&&this.$6J_1(this.get_stateProperties()["Value"])},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$E_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.ToggleButtonCommandProperties=function(){};CUI.Controls.ToggleButton=function($p0,$p1,$p2){this.$$d_$Gx_1=Function.createDelegate(this,this.$Gx_1);this.$$d_$7i_1=Function.createDelegate(this,this.$7i_1);this.$$d_$7j_1=Function.createDelegate(this,this.$7j_1);this.$$d_onClick=Function.createDelegate(this,this.onClick);this.$$d_$6E_1=Function.createDelegate(this,this.$6E_1);this.$$d_$5C_1=Function.createDelegate(this,this.$5C_1);CUI.Controls.ToggleButton.initializeBase(this,[$p0,$p1,$p2]);this._id=$p1;this.addDisplayModes();this.get_stateProperties()["On"]=false};CUI.Controls.ToggleButton.prototype={_id:null,$H_1:null,$2u_1:null,$1F_1:null,$A_1:null,$9_1:null,$m_1:null,$1x_1:null,$2P_1:null,$2N_1:null,$1v_1:null,get_on:function(){return this.get_stateProperties()["On"]},set_on:function($p0){this.get_stateProperties()["On"]=$p0;this.setState($p0);return $p0},createComponentForDisplayModeInternal:function($p0){var $v_0;if($p0.startsWith("Menu")){$v_0=this.$0_0.$56_1(this.$4_0+"-"+$p0+this.$0_0.$2c_1(),$p0,this);this.$2u_1=this.get_$1_1().MenuItemId;this.$1F_1=this.get_$1_1().CommandValueId;if(CUI.ScriptUtility.isNullOrEmptyString(this.$1F_1))this.$1F_1=this.$2u_1}else $v_0=CUI.Control.prototype.createComponentForDisplayModeInternal.call(this,$p0);return $v_0},createDOMElementForDisplayMode:function($p0){return this.$3T_1($p0,true)},$3T_1:function($p0,$p1){switch($p0){case "Large":this.$H_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Large",this.get_$1_1(),false,false);this.$E5_0("Large");$p1&&this.$E6_0("Large");return this.$H_1;case "Medium":this.$9_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Medium",this.get_$1_1(),false,false);this.$E5_0("Medium");$p1&&this.$E6_0("Medium");return this.$9_1;case "Small":this.$A_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Small",this.get_$1_1(),false,false);this.$E5_0("Small");$p1&&this.$E6_0("Small");return this.$A_1;case "Menu":this.$m_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu",this.get_$1_1(),true,false);$p1&&this.$E6_0("Menu");return this.$m_1;case "Menu16":this.$1x_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu16",this.get_$1_1(),true,false);$p1&&this.$E6_0("Menu16");return this.$1x_1;case "Menu32":this.$2P_1=CUI.Control.createStandardControlDOMElement(this,this.$0_0,"Menu32",this.get_$1_1(),true,false);$p1&&this.$E6_0("Menu32");return this.$2P_1;default:this.ensureValidDisplayMode($p0);return null}},$9R_1:null,$E5_0:function($p0){this.$9R_1=$p0;var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);switch($p0){case "Large":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$H_1=$v_0;break;case "Medium":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$9_1=$v_0;break;case "Small":if(!CUI.ScriptUtility.isNullOrUndefined($v_0))this.$A_1=$v_0;break}},$E6_0:function($p0){switch($p0){case "Large":this.$W_1(this.$H_1,true);break;case "Medium":this.$W_1(this.$9_1,true);break;case "Small":this.$W_1(this.$A_1,true);break;case "Menu32":this.$W_1(this.$2P_1,false);break;case "Menu16":this.$W_1(this.$1x_1,false);break;case "Menu":this.$W_1(this.$m_1,false);break}},$W_1:function($p0,$p1){if($p1){$addHandler($p0,"mouseover",this.$$d_$5C_1);$addHandler($p0,"mouseout",this.$$d_$6E_1)}$addHandler($p0,"click",this.$$d_onClick);$addHandler($p0,"mouseover",this.$$d_$7j_1);$addHandler($p0,"mouseout",this.$$d_$7i_1);$addHandler($p0,"focus",this.$$d_$Gx_1);$addHandler($p0,"blur",this.$$d_$6E_1)},$AN_0:function(){if(!this.get_enabled())return false;var $v_0=this.get_displayedComponent().get_$2_0();$v_0.focus();return true},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$A_1,$p0);CUI.Utility.setEnabledOnElement(this.$9_1,$p0);CUI.Utility.setEnabledOnElement(this.$H_1,$p0);CUI.Utility.setEnabledOnElement(this.$m_1,$p0);CUI.Utility.setEnabledOnElement(this.$1x_1,$p0);CUI.Utility.setEnabledOnElement(this.$2P_1,$p0);if(this.get_on())if($p0)this.setState(true);else this.setState(false)},get_$Bb_0:function(){return "ToggleButton"},onStateChanged:function(){this.setState(this.get_stateProperties()["On"])},getDropDownDOMElementForDisplayMode:function($p0){var $v_0;switch($p0){case "Menu16":$v_0=this.$2N_1;break;case "Text":$v_0=this.$1v_1;break;default:$v_0=CUI.Utility.$3("span");break}if($v_0)return $v_0;return this.$Bg_1($p0)},$Bg_1:function($p0){switch($p0){case "Menu":this.$2N_1=this.$3T_1("Menu",false).cloneNode(true);return this.$2N_1;case "Menu16":this.$2N_1=this.$3T_1("Menu16",false).cloneNode(true);return this.$2N_1;case "Text":var $v_0=CUI.Utility.$3("a");CUI.Utility.$2J($v_0);this.$1v_1=CUI.Utility.$3("span");this.$1v_1.className="ms-cui-textmenuitem";CUI.UIUtility.setInnerText($v_0,this.get_$1_1().LabelText);this.$1v_1.appendChild($v_0);return this.$1v_1;default:return CUI.Utility.$3("span")}},deselect:function(){},getMenuItemId:function(){return this.$2u_1},getCommandValueId:function(){return this.$1F_1},focusOnDisplayedComponent:function(){this.receiveFocus()},getTextValue:function(){return this.get_$1_1().LabelText},receiveFocus:function(){this.onBeginFocus();var $v_0=this.get_displayedComponent();if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;$v_0.set_$1Q_2(true);!CUI.ScriptUtility.isNullOrUndefined(this.$m_1)&&this.$m_1.focus();!CUI.ScriptUtility.isNullOrUndefined(this.$1x_1)&&this.$1x_1.focus()},onMenuClosed:function(){this.$d_0()},onClick:function($p0){!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7704);this.$d_0();$p0.preventDefault();if(!this.get_enabled())return;this.$0_0.set_$59_1(this);var $v_0=1,$v_1=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection"){$v_0=3;this.get_stateProperties()["CommandValueId"]=this.$1F_1}this.get_stateProperties()["On"]=!this.get_stateProperties()["On"];this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().Command,$v_0,this.get_stateProperties());if(this.$0_0.get_$6G_1())this.$HT_0();else this.setState(this.get_stateProperties()["On"]);!CUI.ScriptUtility.isNullOrUndefined(CUI.PMetrics)&&CUI.PMetrics.perfMark(7705)},setState:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$A_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$A_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$A_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$9_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$9_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$9_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$H_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$H_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$H_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$2P_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$2P_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$2P_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$m_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$m_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$m_1,"ms-cui-ctl-on");if(!CUI.ScriptUtility.isNullOrUndefined(this.$1x_1))if($p0)CUI.Utility.ensureCSSClassOnElement(this.$1x_1,"ms-cui-ctl-on");else CUI.Utility.removeCSSClassFromElement(this.$1x_1,"ms-cui-ctl-on")},$48_1:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$2P_1)&&CUI.Utility.removeCSSClassFromElement(this.$2P_1,"ms-cui-ctl-disabledHoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$m_1)&&CUI.Utility.removeCSSClassFromElement(this.$m_1,"ms-cui-ctl-disabledHoveredOver");!CUI.ScriptUtility.isNullOrUndefined(this.$1x_1)&&CUI.Utility.removeCSSClassFromElement(this.$1x_1,"ms-cui-ctl-disabledHoveredOver")},$Gx_1:function($p0){this.$0_0.set_$s_1(this);this.$5C_1($p0)},$5C_1:function($p0){this.onBeginFocus();if(!this.get_enabled()){this.$48_1();return}var $v_0=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType($v_0)&&$v_0.set_$1Q_2(true);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandPreview))return;var $v_1=5,$v_2=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2==="OptionSelection"){$v_1=7;this.get_stateProperties()["CommandValueId"]=this.$1F_1}$v_0.raiseCommandEvent(this.get_$1_1().CommandPreview,$v_1,this.get_stateProperties())},$7j_1:function($p0){this.onBeginFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandPreview))return;var $v_0=5,$v_1=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection"){$v_0=7;this.get_stateProperties()["CommandValueId"]=this.$1F_1}this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandPreview,$v_0,this.get_stateProperties())},$6E_1:function($p0){this.onEndFocus();if(!this.get_enabled())return;var $v_0=this.get_displayedComponent();CUI.MenuItem.isInstanceOfType($v_0)&&$v_0.set_$1Q_2(false);if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandRevert))return;var $v_1=6,$v_2=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_2)&&$v_2==="OptionSelection"){$v_1=8;this.get_stateProperties()["CommandValueId"]=this.$1F_1}$v_0.raiseCommandEvent(this.get_$1_1().CommandRevert,$v_1,this.get_stateProperties())},$7i_1:function($p0){this.onEndFocus();if(!this.get_enabled())return;if(CUI.ScriptUtility.isNullOrUndefined(this.get_$1_1().CommandRevert))return;var $v_0=6,$v_1=this.get_$1_1().CommandType;if(!CUI.ScriptUtility.isNullOrUndefined($v_1)&&$v_1==="OptionSelection"){$v_0=8;this.get_stateProperties()["CommandValueId"]=this.$1F_1}this.get_displayedComponent().raiseCommandEvent(this.get_$1_1().CommandRevert,$v_0,this.get_stateProperties())},$HT_0:function(){var $v_0=this.pollForStateAndUpdateInternal(this.get_$1_1().Command,this.get_$1_1().QueryCommand,this.get_stateProperties(),false);$v_0&&this.setState(this.get_stateProperties()["On"])},addDisplayModes:function(){this.addDisplayMode("Small");this.addDisplayMode("Medium");this.addDisplayMode("Large");this.addDisplayMode("Menu");this.addDisplayMode("Menu16");this.addDisplayMode("Menu32")},dispose:function(){CUI.Control.prototype.dispose.call(this);this.$A_1=null;this.$9_1=null;this.$m_1=null;this.$1x_1=null;this.$2P_1=null;this.$2N_1=null;this.$1v_1=null},get_$1_1:function(){return this.$5_0}};CUI.Controls.JewelMenuLauncher=function($p0,$p1,$p2,$p3){this.$$d_onContextMenu=Function.createDelegate(this,this.onContextMenu);this.$$d_onKeyPress=Function.createDelegate(this,this.onKeyPress);this.$$d_onClick=Function.createDelegate(this,this.onClick);this.$$d_onBlur=Function.createDelegate(this,this.onBlur);this.$$d_onFocus=Function.createDelegate(this,this.onFocus);CUI.Controls.JewelMenuLauncher.initializeBase(this,[$p0,$p1,$p2,$p3]);this.addDisplayMode("Default")};CUI.Controls.JewelMenuLauncher.prototype={$G_2:null,$K_2:null,$29_2:null,$5T_2:null,$1M_2:null,$1d_2:null,$1O_2:null,$3A_2:null,$3m_2:false,$8t_2:null,$8m_2:null,$8s_2:null,$8j_2:null,$3K_2:null,$8n_2:null,$8l_2:null,createDOMElementForDisplayMode:function($p0){if($p0!=="Default"){this.ensureValidDisplayMode($p0);return null}var $v_0=CUI.ScriptUtility.isNullOrUndefined(this.get_properties().Alt)?"":this.get_properties().Alt;this.$G_2=CUI.Utility.$3("span");this.$G_2.id=this.get_properties().Id+"-Default";this.$G_2.className="ms-cui-jewel-jewelMenuLauncher";this.$K_2=CUI.Utility.$3("a");CUI.Utility.$2J(this.$K_2);this.$K_2.title=$v_0;this.$3m_2=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().LabelText);if(!this.$3m_2){this.$29_2=CUI.Utility.$3("img");this.$5T_2=CUI.Utility.$p(2,10,this.get_properties().Image,this.get_properties().ImageClass,this.$29_2,true,false,this.get_properties().ImageTop,this.get_properties().ImageLeft);this.$29_2.alt=$v_0;this.$K_2.appendChild(this.$5T_2)}else{var $v_1=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ImageLeftSide),$v_2=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().ImageRightSide);if($v_1){this.$1M_2=CUI.Utility.$3("span");this.$1M_2.className="ms-cui-jewel-left";this.$1M_2.id=this.get_properties().Id+"-Default-left";CUI.Utility.$25(this.$1M_2,this.get_properties().ImageLeftSide,this.get_properties().ImageLeftSideClass,this.get_properties().ImageLeftSideTop,this.get_properties().ImageLeftSideLeft,null,this.get_properties().Height);this.$1M_2.style.width=this.get_properties().ImageLeftSideWidth+"px";this.$1M_2.style.height=this.get_properties().Height+"px";this.$K_2.appendChild(this.$1M_2)}this.$1d_2=CUI.Utility.$3("span");this.$1d_2.className="ms-cui-jewel-middle";this.$1d_2.id=this.get_properties().Id+"-Default-middle";CUI.Utility.$25(this.$1d_2,this.get_properties().Image,this.get_properties().ImageClass,this.get_properties().ImageTop,this.get_properties().ImageLeft,null,this.get_properties().Height);this.$3A_2=CUI.Utility.$3("span");if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().LabelCss))this.$3A_2.style.cssText=this.get_properties().LabelCss;this.$3A_2.className="ms-cui-jewel-label";if(!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().Height))this.$3A_2.style.marginTop=Math.floor(parseInt(this.get_properties().Height)-14)/2+"px";CUI.UIUtility.setInnerText(this.$3A_2,this.get_properties().LabelText);this.$1d_2.appendChild(this.$3A_2);this.$K_2.appendChild(this.$1d_2);if($v_2){this.$1O_2=CUI.Utility.$3("span");this.$1O_2.className="ms-cui-jewel-right";this.$1O_2.id=this.get_properties().Id+"-Default-right";CUI.Utility.$25(this.$1O_2,this.get_properties().ImageRightSide,this.get_properties().ImageRightSideClass,this.get_properties().ImageRightSideTop,this.get_properties().ImageRightSideLeft,null,this.get_properties().Height);this.$1O_2.style.width=this.get_properties().ImageRightSideWidth+"px";this.$1O_2.style.height=this.get_properties().Height+"px";this.$K_2.appendChild(this.$1O_2)}}this.$E6_0($p0);this.$G_2.appendChild(this.$K_2);return this.$G_2},$E5_0:function($p0){this.ensureValidDisplayMode($p0);var $v_0=$get(this.$4_0+"-"+$p0);this.storeElementForDisplayMode($v_0,$p0);var $v_1=$v_0.childNodes[0];this.$G_2=$v_0;this.$K_2=$v_1;this.$3m_2=!CUI.ScriptUtility.isNullOrEmptyString(this.get_properties().LabelText);if(!this.$3m_2){this.$5T_2=this.$K_2.childNodes[0];this.$29_2=this.$5T_2.childNodes[0]}else{this.$1M_2=$get(this.$4_0+"-"+$p0+"-left");this.$1d_2=$get(this.$4_0+"-"+$p0+"-middle");if(this.$1d_2)this.$3A_2=this.$1d_2.firstChild;this.$1O_2=$get(this.$4_0+"-"+$p0+"-right")}},$E6_0:function($p0){this.ensureValidDisplayMode($p0);this.$8t_2=this.$$d_onFocus;this.$8m_2=this.$$d_onFocus;this.$8s_2=this.$$d_onBlur;this.$8j_2=this.$$d_onBlur;this.$3K_2=this.$$d_onClick;this.$8n_2=this.$$d_onKeyPress;$addHandler(this.$K_2,"mouseover",this.$8t_2);$addHandler(this.$K_2,"focus",this.$8m_2);$addHandler(this.$K_2,"mouseout",this.$8s_2);$addHandler(this.$K_2,"blur",this.$8j_2);$addHandler(this.$K_2,"click",this.$3K_2);$addHandler(this.$K_2,"keypress",this.$8n_2);if(Sys.Browser.agent===Sys.Browser.InternetExplorer){this.$8l_2=this.$$d_onContextMenu;$addHandler(this.$K_2,"contextmenu",this.$8l_2)}},dispose:function(){!CUI.ScriptUtility.isNullOrUndefined(this.$K_2)&&$clearHandlers(this.$K_2);this.$8t_2=null;this.$8m_2=null;this.$8s_2=null;this.$8j_2=null;this.$3K_2=null;this.$8n_2=null;this.$8l_2=null;CUI.MenuLauncher.prototype.dispose.call(this);this.$G_2=null;this.$K_2=null;this.$29_2=null;this.$5T_2=null;this.$1M_2=null;this.$1d_2=null;this.$1O_2=null;this.$3A_2=null},onEnabledChanged:function($p0){CUI.Utility.setEnabledOnElement(this.$K_2,$p0)},onFocus:function($p0){if(!this.get_enabled()||this.$n_1)return;this.$48_2()},onBlur:function($p0){if(!this.get_enabled()||this.$n_1)return;this.$1Y_2()},onClick:function($p0){$p0.preventDefault();if(!this.get_enabled()||CUI.ScriptUtility.isNullOrUndefined($p0)||$p0.button)return;if(this.$n_1){this.$52_1();return}this.$Cd_2()},onKeyPress:function($p0){if(!this.get_enabled())return;if(!$p0||!$p0.rawEvent)return;var $v_0=$p0.rawEvent.keyCode;if($v_0===13||$v_0===32||$v_0===40){this.$1H_1=true;if(this.$n_1)this.$52_1();else this.$Cd_2();$p0.preventDefault()}},onContextMenu:function($p0){!CUI.ScriptUtility.isNullOrUndefined($p0)&&$p0.preventDefault()},$Cd_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageDown))return;if(!this.$3m_2){this.$29_2.src=this.get_properties().ImageDown;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageDownClass))this.$29_2.className=this.get_properties().ImageDownClass}else{this.$1M_2&&CUI.Utility.$25(this.$1M_2,this.get_properties().ImageLeftSideDown,this.get_properties().ImageLeftSideDownClass,this.get_properties().ImageLeftSideDownTop,this.get_properties().ImageLeftSideDownLeft,null,this.get_properties().Height);CUI.Utility.$25(this.$1d_2,this.get_properties().ImageDown,this.get_properties().ImageDownClass,this.get_properties().ImageDownTop,this.get_properties().ImageDownLeft,null,this.get_properties().Height);this.$1O_2&&CUI.Utility.$25(this.$1O_2,this.get_properties().ImageRightSideDown,this.get_properties().ImageRightSideDownClass,this.get_properties().ImageRightSideDownTop,this.get_properties().ImageRightSideDownLeft,null,this.get_properties().Height)}this.launchMenuInternal(this.$K_2)},onLaunchedMenuClosed:function(){this.$1Y_2();this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuClose,10,null)},launchMenuInternal:function($p0){this.launchMenu($p0);this.get_displayedComponent().raiseCommandEvent(this.get_properties().CommandMenuOpen,4,null)},$48_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHover))return;if(!this.$3m_2){this.$29_2.src=this.get_properties().ImageHover;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHoverClass))this.$29_2.className=this.get_properties().ImageHoverClass}else{this.$1M_2&&CUI.Utility.$25(this.$1M_2,this.get_properties().ImageLeftSideHover,this.get_properties().ImageLeftSideHoverClass,this.get_properties().ImageLeftSideHoverTop,this.get_properties().ImageLeftSideHoverLeft,null,this.get_properties().Height);CUI.Utility.$25(this.$1d_2,this.get_properties().ImageHover,this.get_properties().ImageHoverClass,this.get_properties().ImageHoverTop,this.get_properties().ImageHoverLeft,null,this.get_properties().Height);this.$1O_2&&CUI.Utility.$25(this.$1O_2,this.get_properties().ImageRightSideHover,this.get_properties().ImageRightSideHoverClass,this.get_properties().ImageRightSideHoverTop,this.get_properties().ImageRightSideHoverLeft,null,this.get_properties().Height)}},$1Y_2:function(){if(CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageHover))return;if(!this.$3m_2){this.$29_2.src=this.get_properties().Image;if(!CUI.ScriptUtility.isNullOrUndefined(this.get_properties().ImageClass))this.$29_2.className=this.get_properties().ImageClass}else{this.$1M_2&&CUI.Utility.$25(this.$1M_2,this.get_properties().ImageLeftSide,this.get_properties().ImageLeftSideClass,this.get_properties().ImageLeftSideTop,this.get_properties().ImageLeftSideLeft,null,this.get_properties().Height);CUI.Utility.$25(this.$1d_2,this.get_properties().Image,this.get_properties().ImageClass,this.get_properties().ImageTop,this.get_properties().ImageLeft,null,this.get_properties().Height);this.$1O_2&&CUI.Utility.$25(this.$1O_2,this.get_properties().ImageRightSide,this.get_properties().ImageRightSideClass,this.get_properties().ImageRightSideTop,this.get_properties().ImageRightSideLeft,null,this.get_properties().Height)}},get_properties:function(){return this.$5_0},$Fq_2:function(){this.$K_2.focus()}};Type.registerNamespace("CUI.Page");CUI.Page.CommandDispatcher=function(){this.$2x_0={}};CUI.Page.CommandDispatcher.prototype={$2x_0:null,$CY_0:function(){},$7D_0:0,getNextSequenceNumber:function(){if(this.$7D_0+1<0)throw Error.create("Command Dispatcher sequence numbers overflowed into negative numbers.");return ++this.$7D_0},peekNextSequenceNumber:function(){return this.$7D_0+1},getLastSequenceNumber:function(){return this.$7D_0},executeCommand:function(commandId,properties){return this.$Fe_0(commandId,properties,this.getNextSequenceNumber())},$Fe_0:function($p0,$p1,$p2){var $v_0=this.$2x_0[$p0];if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;else if(Array.isInstanceOfType($v_0)){for(var $v_1=$v_0,$v_2=false,$v_3=0;$v_3<$v_1.length;$v_3++){var $v_4=$v_1[$v_3];if(this.callCommandHandler($v_4,$p0,$p1,$p2))$v_2=true}return $v_2}else return this.callCommandHandler($v_0,$p0,$p1,$p2)},isCommandEnabled:function(commandId){var $v_0=this.$2x_0[commandId];if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;else if(Array.isInstanceOfType($v_0)){for(var $v_1=$v_0,$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];if(this.callCommandHandlerForEnabled($v_3,commandId))return true}return false}else return this.callCommandHandlerForEnabled($v_0,commandId)},$CF_0:function($p0){return this.$2x_0[$p0]},registerCommandHandler:function(commandId,handler){if(CUI.ScriptUtility.isNullOrUndefined(commandId)||CUI.ScriptUtility.isNullOrUndefined(handler))throw Error.create("commandId and handler may not be null or undefined");var $v_0=this.$2x_0[commandId];if(CUI.ScriptUtility.isNullOrUndefined($v_0))this.$2x_0[commandId]=handler;else if(Array.isInstanceOfType($v_0))!Array.contains($v_0,handler)&&Array.add($v_0,handler);else{if($v_0===handler)return;var $v_1=[];Array.add($v_1,$v_0);Array.add($v_1,handler);this.$2x_0[commandId]=$v_1}},unregisterCommandHandler:function(commandId,handler){if(CUI.ScriptUtility.isNullOrUndefined(commandId)||CUI.ScriptUtility.isNullOrUndefined(handler))throw Error.create("commandId and handler may not be null or undefined");var $v_0=this.$2x_0[commandId];if(CUI.ScriptUtility.isNullOrUndefined($v_0))return;else if(Array.isInstanceOfType($v_0))Array.remove($v_0,handler);else if($v_0===handler)this.$2x_0[commandId]=null},registerMultipleCommandHandler:function(component,commands){for(var $v_0=0;$v_0<commands.length;$v_0++)this.registerCommandHandler(commands[$v_0],component)},unregisterMultipleCommandHandler:function(component,commands){for(var $v_0=0;$v_0<commands.length;$v_0++)this.unregisterCommandHandler(commands[$v_0],component)},callCommandHandler:function(handler,commandId,properties,sequenceNumber){return handler.handleCommand(commandId,properties,sequenceNumber)},callCommandHandlerForEnabled:function(handler,commandId){return handler.canHandleCommand(commandId)}};CUI.Page.FocusManager=function($p0){CUI.Page.FocusManager.initializeBase(this);this.$2W_1=$p0;this.$q_1=[];this.$3M_1={};this.$1a_1=[];this.$3D_1={}};CUI.Page.FocusManager.prototype={$1a_1:null,$3M_1:null,$2W_1:null,$3D_1:null,$CY_0:function(){},$CP_1:function(){this.$3D_1={};for(var $v_0=this.$1a_1.length,$v_1=0;$v_1<$v_0;$v_1++){var $v_2=this.$1a_1[$v_1];this.$3D_1[$v_2]=$v_2}},requestFocusForComponent:function(component){if(CUI.ScriptUtility.isNullOrUndefined(component))return false;if(Array.contains(this.$1a_1,component))return true;Array.add(this.$1a_1,component);this.$CP_1();component.receiveFocus();return true},releaseFocusFromComponent:function(component){if(CUI.ScriptUtility.isNullOrUndefined(component))return false;if(!Array.contains(this.$1a_1,component))return true;Array.remove(this.$1a_1,component);this.$CP_1();component.yieldFocus();return true},releaseAllFoci:function(){this.$3D_1={};for(var $v_0=this.$1a_1.length,$v_1=$v_0-1;$v_1>=0;$v_1--){var $v_2=this.$1a_1[$v_1];Array.remove(this.$1a_1,$v_2);$v_2.yieldFocus()}return true},getFocusedComponents:function(){return Array.clone(this.$1a_1)},handleCommand:function(commandId,properties,sequenceNumber){var $v_0=this.$CF_0(commandId);if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;else if(Array.isInstanceOfType($v_0)){for(var $v_1=$v_0,$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];if(CUI.ScriptUtility.isNullOrUndefined(this.$3D_1[$v_3]))continue;if(this.callCommandHandler($v_3,commandId,properties,sequenceNumber))return true}return false}else{if(CUI.ScriptUtility.isNullOrUndefined(this.$3D_1[$v_0]))return false;return this.callCommandHandler($v_0,commandId,properties,sequenceNumber)}},canHandleCommand:function(commandId){var $v_0=this.$CF_0(commandId);if(CUI.ScriptUtility.isNullOrUndefined($v_0))return false;else if(Array.isInstanceOfType($v_0)){for(var $v_1=$v_0,$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];if(CUI.ScriptUtility.isNullOrUndefined(this.$3D_1[$v_3]))continue;if(this.callCommandHandlerForEnabled($v_3,commandId))return true}return false}else{if(CUI.ScriptUtility.isNullOrUndefined(this.$3D_1[$v_0]))return false;return this.callCommandHandlerForEnabled($v_0,commandId)}},$q_1:null,$BI_1:function($p0){if(Array.contains(this.$q_1,$p0))return;this.registerMultipleCommandHandler($p0,$p0.getFocusedCommands());Array.add(this.$q_1,$p0)},$Hp_1:function($p0){if(!Array.contains(this.$q_1,$p0))return;this.unregisterMultipleCommandHandler($p0,$p0.getFocusedCommands());this.releaseFocusFromComponent($p0);Array.remove(this.$q_1,$p0)},executeCommand:function(commandId,properties){throw Error.create("ExecuteCommand should not be called on the main CommandDispatcher of the page, not the FocusManager")},registerCommandHandler:function(commandId,handler){CUI.Page.CommandDispatcher.prototype.registerCommandHandler.call(this,commandId,handler);if(CUI.ScriptUtility.isNullOrUndefined(this.$3M_1[commandId])){this.$2W_1.$v_1.registerCommandHandler(commandId,this);this.$3M_1[commandId]=0}var $v_0=this.$3M_1[commandId];this.$3M_1[commandId]=$v_0+1},unregisterCommandHandler:function(commandId,handler){CUI.Page.CommandDispatcher.prototype.unregisterCommandHandler.call(this,commandId,handler);var $v_0=this.$3M_1[commandId];if(!CUI.ScriptUtility.isNullOrUndefined($v_0)&&$v_0>0){this.$3M_1[commandId]=--$v_0;if($v_0<=0){this.$2W_1.$v_1.unregisterCommandHandler(commandId,this);delete this.$3M_1[commandId]}}},getNextSequenceNumber:function(){throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},peekNextSequenceNumber:function(){throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},getLastSequenceNumber:function(){throw Error.create("The FocusManager does not issue command sequence numbers.  This is only done by the main CommandDispatcher of the page.")},callCommandHandler:function(handler,commandId,properties,sequenceNumber){if(!Array.contains(this.$1a_1,handler))return false;return handler.handleCommand(commandId,properties,sequenceNumber)},callCommandHandlerForEnabled:function(handler,commandId){if(!Array.contains(this.$1a_1,handler))return false;return handler.canHandleCommand(commandId)}};CUI.Page.PageManager=function(){this.$$d_$A2_1=Function.createDelegate(this,this.$A2_1);CUI.Page.PageManager.initializeBase(this);this.$q_1=[];this.$5L_1={};this.$v_1=new CUI.Page.CommandDispatcher;this.$4d_1=new CUI.Page.FocusManager(this);this.$7N_1=new CUI.Page.UndoManager(this);this.$21_1=[];this.$2w_1=this.$$d_$A2_1;$addHandler(window,"unload",this.$2w_1)};CUI.Page.PageManager.initialize=function(){if(!CUI.ScriptUtility.isNullOrUndefined(CUI.Page.PageManager._instance))return;CUI.Page.PageManager._instance=CUI.Page.PageManager.createPageManager();CUI.Page.PageManager._instance.initializeInternal()};CUI.Page.PageManager.createPageManager=function(){return new CUI.Page.PageManager};CUI.Page.PageManager.get_instance=function(){!CUI.Page.PageManager._instance&&CUI.Page.PageManager.initialize();return CUI.Page.PageManager._instance};CUI.Page.PageManager.prototype={$2w_1:null,initializeInternal:function(){this.$v_1.$CY_0();this.$7N_1.$CY_0();this.$4d_1.$CY_0();this.$v_1.registerCommandHandler("appstatechanged",this)},$A2_1:function($p0){this.dispose()},dispose:function(){!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon())&&this.get_ribbon().$Fn_1();this.$4d_1=null;this.$7N_1=null;this.$v_1=null;this.$21_1=null;this.$q_1=null;$removeHandler(window,"unload",this.$2w_1)},$v_1:null,get_commandDispatcher:function(){return this.$v_1},$4d_1:null,get_focusManager:function(){return this.$4d_1},$7N_1:null,get_undoManager:function(){return this.$7N_1},$8J_1:null,get_$9Y_1:function(){if(!this.$8J_1)this.$8J_1=new Sys.EventHandlerList;return this.$8J_1},$3x_1:null,get_ribbon:function(){return this.$3x_1},set_ribbon:function(value){if(value===this.$3x_1)return value;if(CUI.ScriptUtility.isNullOrUndefined(value)&&!CUI.ScriptUtility.isNullOrUndefined(this.$3x_1)){this.removeRoot(this.$3x_1);this.$3x_1=null}else if(!Array.contains(this.$21_1,value)){this.addRoot(value);this.$3x_1=value}return value},add_ribbonInited:function(value){this.get_$9Y_1().addHandler("RibbonInited",value)},remove_ribbonInited:function(value){this.get_$9Y_1().removeHandler("RibbonInited",value)},onComponentBuilt:function(root,componentId){this.pollRootState(root);if(CUI.Ribbon.isInstanceOfType(root)){var $v_0=this.get_$9Y_1().getHandler("RibbonInited");$v_0&&$v_0(this,Sys.EventArgs.Empty)}},onComponentCreated:function(root,componentId){if(CUI.Ribbon.isInstanceOfType(root)&&CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon()))this.set_ribbon(root);else this.addRoot(root)},$21_1:null,addRoot:function(root){if(Array.contains(this.$21_1,root))throw Error.create("This Root has already been added to the PageManager");Array.add(this.$21_1,root);root.set_rootUser(this)},removeRoot:function(root){if(!Array.contains(this.$21_1,root))throw Error.create("This Root has not been added to the PageManager.");Array.remove(this.$21_1,root);root.set_rootUser(null)},disposeAllRoots:function(){this.$3x_1=null;for(var $v_0=0;$v_0<this.$21_1.length;$v_0++){var $v_1=this.$21_1[$v_0];$v_1.dispose()}this.$21_1=[]},$q_1:null,$5L_1:null,getPageComponentById:function(id){return this.$5L_1[id]},addPageComponent:function(component){!CUI.ScriptUtility.isNullOrUndefined(this.$5L_1[component.getId()])&&Error.create("A PageComponent with id: "+component.getId()+" has already been added to the PageManger.");if(!CUI.ScriptUtility.isNullOrUndefined(this.$q_1)&&!Array.contains(this.$q_1,component)){this.$5L_1[component.getId()]=component;component.init();this.$v_1.registerMultipleCommandHandler(component,component.getGlobalCommands());Array.add(this.$q_1,component);component.isFocusable()&&this.$4d_1.$BI_1(component)}},removePageComponent:function(component){if(CUI.ScriptUtility.isNullOrUndefined(this.$q_1)||!Array.contains(this.$q_1,component))return;this.$v_1.unregisterMultipleCommandHandler(component,component.getGlobalCommands());Array.remove(this.$q_1,component);component.isFocusable()&&this.$4d_1.$Hp_1(component);this.$5L_1[component.getId()]=null},executeRootCommand:function(commandId,properties,commandInfo,root){return this.$v_1.executeCommand(commandId,properties)},isRootCommandEnabled:function(commandId,root){return this.$v_1.isCommandEnabled(commandId)},onRootRefreshed:function(root){!CUI.ScriptUtility.isNullOrUndefined(root)&&this.pollRootState(root)},handleCommand:function(commandId,properties,sequenceNumber){if(commandId==="appstatechanged"){for(var $v_0=0;$v_0<this.$21_1.length;$v_0++){var $v_1=this.$21_1[$v_0];this.pollRootState($v_1);$v_1.$l_0&&$v_1.$26_0()}return true}return false},$90_1:false,get_rootPollingInProgress:function(){return this.$90_1},pollRootState:function(root){try{this.$90_1=true;root.pollForStateAndUpdate()}finally{this.$90_1=false}},changeCommandContext:function(commandContextId){if(!CUI.ScriptUtility.isNullOrUndefined(this.get_ribbon()))return this.get_ribbon().selectTabByCommand(commandContextId);return false},canHandleCommand:function(commandId){return commandId==="appstatechanged"},restoreFocusToRibbon:function(){!this.get_ribbon().restoreFocus()&&this.get_ribbon().setFocus()}};CUI.Page.UndoManager=function($p0){this.$8z_0=CUI.Page.UndoManager.$2e;this.$2W_0=$p0;this.$1P_0=[];this.$1C_0=[];this.$2Z_0={}};CUI.Page.UndoManager.prototype={$2W_0:null,$2Z_0:null,$1P_0:null,$1C_0:null,$CY_0:function(){this.$2W_0.$v_1.registerCommandHandler("GlobalUndo",this);this.$2W_0.$v_1.registerCommandHandler("GlobalRedo",this);this.$2W_0.$v_1.registerCommandHandler("grpedit",this)},addUndoSequenceNumber:function(sequenceNumber){this.$Hh_0(sequenceNumber);sequenceNumber!==this.$8z_0&&this.$FA_0()},addRedoSequenceNumber:function(sequenceNumber){this.$Hg_0(sequenceNumber)},get_oldestSequenceNumber:function(){if(!this.$1P_0.length)return CUI.Page.UndoManager.$2e;var $v_0=CUI.Page.UndoManager.$2e,$v_1=CUI.Page.UndoManager.$2e;if(this.$1P_0.length>0)$v_0=this.$1P_0[this.$1P_0.length-1];if(this.$1C_0.length>0)$v_1=this.$1C_0[0];if($v_0===CUI.Page.UndoManager.$2e)return $v_0;else return $v_0},$F8_0:function(){var $v_0=this.$HW_0();if($v_0===CUI.Page.UndoManager.$2e)return;var $v_1={};$v_1["SequenceNumber"]=$v_0;this.$2W_0.$v_1.executeCommand("Undo",$v_1)},$F7_0:function(){var $v_0=this.$HU_0();if($v_0===CUI.Page.UndoManager.$2e)return;var $v_1={};$v_1["SequenceNumber"]=$v_0;this.$8z_0=this.$2W_0.$v_1.peekNextSequenceNumber();this.$2W_0.$v_1.executeCommand("Redo",$v_1)},$HU_0:function(){if(!this.$1C_0.length)return CUI.Page.UndoManager.$2e;var $v_0=this.$1C_0[0];Array.removeAt(this.$1C_0,0);this.$2Z_0[$v_0.toString()]=null;return $v_0},$Hg_0:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$2Z_0[$p0.toString()])){if(this.$1P_0[0]!==$p0)throw Error.create("This command sequence number is already on the undo or the redo stack but it is not ontop of the redo stack.  Pushing it would result in out of sequence redo and undo stacks.");return}Array.insert(this.$1C_0,0,$p0);this.$2Z_0[$p0.toString()]=$p0},$HW_0:function(){if(!this.$1P_0.length)return CUI.Page.UndoManager.$2e;var $v_0=this.$1P_0[0];Array.removeAt(this.$1P_0,0);this.$2Z_0[$v_0.toString()]=null;return $v_0},$Hh_0:function($p0){if(!CUI.ScriptUtility.isNullOrUndefined(this.$2Z_0[$p0.toString()])){if(this.$1P_0[0]!==$p0)throw Error.create("This command sequence number is already on the stack and not on top.  Pushing it would result in an out of sequence undo stack.");return}Array.insert(this.$1P_0,0,$p0);this.$2Z_0[$p0.toString()]=$p0},$FA_0:function(){for(var $v_0=0;$v_0<this.$1C_0.length;$v_0++){this.$2Z_0[this.$1C_0[$v_0].toString()]=null;Array.remove(this.$1C_0,this.$1C_0[$v_0])}Array.clear(this.$1C_0)},invalidateUndoSequenceNumber:function(sequenceNumber){for(var $v_0=this.$1P_0.length-1;$v_0>-1;$v_0--){var $v_1=this.$1P_0[$v_0];if($v_1<=sequenceNumber){Array.removeAt(this.$1P_0,$v_0);this.$2Z_0[$v_1.toString()]=null}}while(this.$1C_0.length>0&&this.$1C_0[0]<=sequenceNumber){this.$2Z_0[this.$1C_0[0].toString()]=null;Array.removeAt(this.$1C_0,0)}},canHandleCommand:function(commandId){if(commandId==="GlobalUndo")return this.$1P_0.length>0;else if(commandId==="GlobalRedo")return this.$1C_0.length>0;else if(commandId==="grpedit")return true;return false},handleCommand:function(commandId,properties,sequenceNumber){switch(commandId){case "GlobalUndo":this.$F8_0();return true;case "GlobalRedo":this.$F7_0();return true}return false}};Type.registerNamespace("Commands");Commands.CommandIds=function(){};Commands.GlobalRedoProperties=function(){};Commands.RedoProperties=function(){};Commands.GlobalUndoProperties=function(){};Commands.UndoProperties=function(){};Mscrm.CommandInformation.registerClass("Mscrm.CommandInformation");Mscrm.ContextualGroupInfo.registerClass("Mscrm.ContextualGroupInfo");Mscrm.CommandBarBase.registerClass("Mscrm.CommandBarBase",Mscrm.CrmUIControl);Mscrm.CommandBarMenu.registerClass("Mscrm.CommandBarMenu");Mscrm.CommandBarMoreMenu.registerClass("Mscrm.CommandBarMoreMenu",Mscrm.CommandBarMenu);Mscrm.CommandBar.registerClass("Mscrm.CommandBar",Mscrm.CommandBarBase);Mscrm.CommandBarBuildOptions.registerClass("Mscrm.CommandBarBuildOptions");Mscrm.CommandBarBuilder.registerClass("Mscrm.CommandBarBuilder");Mscrm.TemplateGenerator.registerClass("Mscrm.TemplateGenerator");Mscrm.CommandBarConstants.registerClass("Mscrm.CommandBarConstants");Mscrm.CommandBarControl.registerClass("Mscrm.CommandBarControl");Mscrm.ButtonControl.registerClass("Mscrm.ButtonControl",Mscrm.CommandBarControl);Mscrm.MenuAwareControl.registerClass("Mscrm.MenuAwareControl",Mscrm.CommandBarControl);Mscrm.FlyoutAnchorControl.registerClass("Mscrm.FlyoutAnchorControl",Mscrm.MenuAwareControl);Mscrm.ToggleButtonControl.registerClass("Mscrm.ToggleButtonControl",Mscrm.CommandBarControl);Mscrm.SplitButtonControl.registerClass("Mscrm.SplitButtonControl",Mscrm.MenuAwareControl);Mscrm.CustomTabControl.registerClass("Mscrm.CustomTabControl",Mscrm.MenuAwareControl);Mscrm.CheckBoxControl.registerClass("Mscrm.CheckBoxControl",Mscrm.ToggleButtonControl);Mscrm.SpinnerCommandProperties.registerClass("Mscrm.SpinnerCommandProperties");Mscrm.SpinnerControl.registerClass("Mscrm.SpinnerControl",Mscrm.CommandBarControl);Mscrm.CommandHandler.registerClass("Mscrm.CommandHandler",CUI.Page.PageComponent);Mscrm.CommandHandlerWrapper.registerClass("Mscrm.CommandHandlerWrapper",CUI.Page.PageComponent);Mscrm.AlwaysEnabledCommandHandler.registerClass("Mscrm.AlwaysEnabledCommandHandler",CUI.Page.PageComponent);CUI.DataSource.registerClass("CUI.DataSource",null,Sys.IDisposable);Mscrm.CrmDataSource.registerClass("Mscrm.CrmDataSource",CUI.DataSource);Mscrm.DynamicMenuCommandHandler.registerClass("Mscrm.DynamicMenuCommandHandler",Mscrm.CommandHandler);Mscrm.CommandData.registerClass("Mscrm.CommandData",Mscrm.CrmUIComponent,Mscrm.ICommandData);Mscrm.RibbonData.registerClass("Mscrm.RibbonData",Mscrm.CommandData);Mscrm.RibbonHeaderScaling.registerClass("Mscrm.RibbonHeaderScaling");Mscrm.RibbonManager.registerClass("Mscrm.RibbonManager",Mscrm.CrmUIControl);Mscrm.RibbonNavigationModel.registerClass("Mscrm.RibbonNavigationModel");Mscrm.CommandBarData.registerClass("Mscrm.CommandBarData",Mscrm.CommandData);CUI.QueryRecord.registerClass("CUI.QueryRecord");CUI.DeclarativeTemplateBuildContext.registerClass("CUI.DeclarativeTemplateBuildContext");CUI.CommandInformation.registerClass("CUI.CommandInformation");CUI.DisabledCommandInfoProperties.registerClass("CUI.DisabledCommandInfoProperties");CUI.BuildOptions.registerClass("CUI.BuildOptions");CUI.BuildContext.registerClass("CUI.BuildContext");CUI.DataNodeWrapper.registerClass("CUI.DataNodeWrapper");CUI.Builder.registerClass("CUI.Builder",null,Sys.IDisposable);CUI.CommandEventArgs.registerClass("CUI.CommandEventArgs",Sys.EventArgs);CUI.Component.registerClass("CUI.Component",null,CUI.IMenuItem,Sys.IDisposable);CUI.Menu.registerClass("CUI.Menu",CUI.Component);CUI.ContextMenu.registerClass("CUI.ContextMenu",CUI.Menu);CUI.ContextMenuDock.registerClass("CUI.ContextMenuDock",CUI.Component);CUI.Control.registerClass("CUI.Control",null,Sys.IDisposable,CUI.IMenuItem);CUI.MenuLauncher.registerClass("CUI.MenuLauncher",CUI.Control,CUI.IModalController);CUI.ContextMenuLauncher.registerClass("CUI.ContextMenuLauncher",CUI.MenuLauncher);CUI.RootProperties.registerClass("CUI.RootProperties");CUI.ContextMenuRootProperties.registerClass("CUI.ContextMenuRootProperties",CUI.RootProperties);CUI.Root.registerClass("CUI.Root",CUI.Component,Sys.IDisposable);CUI.ContextMenuRoot.registerClass("CUI.ContextMenuRoot",CUI.Root);CUI.ControlProperties.registerClass("CUI.ControlProperties");CUI.ControlComponent.registerClass("CUI.ControlComponent",CUI.Component);CUI.DataQueryResult.registerClass("CUI.DataQueryResult");CUI.DataQuery.registerClass("CUI.DataQuery");CUI.Gallery.registerClass("CUI.Gallery",CUI.Component);CUI.Jewel.registerClass("CUI.Jewel",CUI.Root);CUI.JewelBuildContext.registerClass("CUI.JewelBuildContext",CUI.BuildContext);CUI.JewelBuildOptions.registerClass("CUI.JewelBuildOptions",CUI.BuildOptions);CUI.JewelBuilder.registerClass("CUI.JewelBuilder",CUI.Builder);CUI.MenuItem.registerClass("CUI.MenuItem",CUI.ControlComponent);CUI.MenuLauncherControlProperties.registerClass("CUI.MenuLauncherControlProperties",CUI.ControlProperties);CUI.BrowserUtility.registerClass("CUI.BrowserUtility");CUI.MenuSection.registerClass("CUI.MenuSection",CUI.Component);CUI.QAT.registerClass("CUI.QAT",CUI.Root);CUI.QATBuildContext.registerClass("CUI.QATBuildContext",CUI.BuildContext);CUI.QATBuildOptions.registerClass("CUI.QATBuildOptions",CUI.BuildOptions);CUI.QATBuilder.registerClass("CUI.QATBuilder",CUI.Builder);CUI.RibbonPeripheralSection.registerClass("CUI.RibbonPeripheralSection");CUI.ContextualGroup.registerClass("CUI.ContextualGroup",null,Sys.IDisposable);CUI.Template.registerClass("CUI.Template");CUI.DeclarativeTemplate.registerClass("CUI.DeclarativeTemplate",CUI.Template);CUI.RibbonComponent.registerClass("CUI.RibbonComponent",CUI.Component);CUI.Group.registerClass("CUI.Group",CUI.RibbonComponent);CUI.GroupPopup.registerClass("CUI.GroupPopup",CUI.Component);CUI.Layout.registerClass("CUI.Layout",CUI.RibbonComponent);CUI.GroupPopupLayout.registerClass("CUI.GroupPopupLayout",CUI.Layout);CUI.RootEventCommandProperties.registerClass("CUI.RootEventCommandProperties");CUI.RibbonEventCommandProperties.registerClass("CUI.RibbonEventCommandProperties",CUI.RootEventCommandProperties);CUI.CommandContextSwitchCommandProperties.registerClass("CUI.CommandContextSwitchCommandProperties");CUI.Ribbon.registerClass("CUI.Ribbon",CUI.Root);CUI.RibbonCommand.registerClass("CUI.RibbonCommand");CUI.RibbonBuildContext.registerClass("CUI.RibbonBuildContext",CUI.BuildContext);CUI.RibbonBuildOptions.registerClass("CUI.RibbonBuildOptions",CUI.BuildOptions);CUI.RibbonBuilder.registerClass("CUI.RibbonBuilder",CUI.Builder);CUI.Row.registerClass("CUI.Row",CUI.Component);CUI.ScalingStep.registerClass("CUI.ScalingStep");CUI.Scaling.registerClass("CUI.Scaling");CUI.Section.registerClass("CUI.Section",CUI.RibbonComponent);CUI.Strip.registerClass("CUI.Strip",CUI.RibbonComponent);CUI.Tab.registerClass("CUI.Tab",CUI.RibbonComponent);CUI.TemplateManager.registerClass("CUI.TemplateManager");CUI.RootUser.registerClass("CUI.RootUser");CUI.ButtonDock.registerClass("CUI.ButtonDock",CUI.Component);CUI.Toolbar.registerClass("CUI.Toolbar",CUI.Root);CUI.ToolbarBuildContext.registerClass("CUI.ToolbarBuildContext",CUI.BuildContext);CUI.ToolbarBuildOptions.registerClass("CUI.ToolbarBuildOptions",CUI.BuildOptions);CUI.ToolbarBuilder.registerClass("CUI.ToolbarBuilder",CUI.Builder);CUI.ToolTip.registerClass("CUI.ToolTip",CUI.Component);CUI.Unit.registerClass("CUI.Unit");CUI.Utility.registerClass("CUI.Utility");CUI.ScriptUtility.registerClass("CUI.ScriptUtility");CUI.UIUtility.registerClass("CUI.UIUtility");CUI.ListNode.registerClass("CUI.ListNode");CUI.List.registerClass("CUI.List",null,IEnumerable);CUI.ListEnumerator.registerClass("CUI.ListEnumerator",null,IEnumerator);CUI.JsonXmlElement.registerClass("CUI.JsonXmlElement");CUI.Controls.ColorStyle.registerClass("CUI.Controls.ColorStyle");CUI.Controls.ColorPickerResult.registerClass("CUI.Controls.ColorPickerResult");CUI.Controls.ContextMenuControlProperties.registerClass("CUI.Controls.ContextMenuControlProperties",CUI.MenuLauncherControlProperties);CUI.Controls.ContextMenuControl.registerClass("CUI.Controls.ContextMenuControl",CUI.ContextMenuLauncher);CUI.Controls.Button.registerClass("CUI.Controls.Button",CUI.Control,CUI.IMenuItem,CUI.ISelectableControl);CUI.Controls.CheckBoxCommandProperties.registerClass("CUI.Controls.CheckBoxCommandProperties");CUI.Controls.ToggleButton.registerClass("CUI.Controls.ToggleButton",CUI.Control,CUI.IMenuItem,CUI.ISelectableControl);CUI.Controls.CheckBox.registerClass("CUI.Controls.CheckBox",CUI.Controls.ToggleButton);CUI.Controls.ColorPickerCommandProperties.registerClass("CUI.Controls.ColorPickerCommandProperties");CUI.Controls.ColorPicker.registerClass("CUI.Controls.ColorPicker",CUI.Control,CUI.IMenuItem);CUI.Controls.ComboBoxCommandProperties.registerClass("CUI.Controls.ComboBoxCommandProperties");CUI.Controls.DropDown.registerClass("CUI.Controls.DropDown",CUI.MenuLauncher);CUI.Controls.ComboBox.registerClass("CUI.Controls.ComboBox",CUI.Controls.DropDown);CUI.Controls.DropDownCommandProperties.registerClass("CUI.Controls.DropDownCommandProperties");CUI.Controls.FlyoutAnchor.registerClass("CUI.Controls.FlyoutAnchor",CUI.MenuLauncher);CUI.Controls.GalleryButtonCommandProperties.registerClass("CUI.Controls.GalleryButtonCommandProperties");CUI.Controls.GalleryButton.registerClass("CUI.Controls.GalleryButton",CUI.Control,CUI.ISelectableControl);CUI.Controls.InsertTableCommandProperties.registerClass("CUI.Controls.InsertTableCommandProperties");CUI.Controls.InsertTable.registerClass("CUI.Controls.InsertTable",CUI.Control);CUI.Controls.LabelCommandProperties.registerClass("CUI.Controls.LabelCommandProperties");CUI.Controls.Label.registerClass("CUI.Controls.Label",CUI.Control);CUI.Controls.MRUSplitButton.registerClass("CUI.Controls.MRUSplitButton",CUI.Controls.DropDown);CUI.Controls.Separator.registerClass("CUI.Controls.Separator",CUI.Control);CUI.Controls.SpinnerCommandProperties.registerClass("CUI.Controls.SpinnerCommandProperties");CUI.Controls.Spinner.registerClass("CUI.Controls.Spinner",CUI.Control);CUI.Controls.SplitButton.registerClass("CUI.Controls.SplitButton",CUI.MenuLauncher);CUI.Controls.TextBoxCommandProperties.registerClass("CUI.Controls.TextBoxCommandProperties");CUI.Controls.TextBox.registerClass("CUI.Controls.TextBox",CUI.Control);CUI.Controls.ToggleButtonCommandProperties.registerClass("CUI.Controls.ToggleButtonCommandProperties");CUI.Controls.JewelMenuLauncher.registerClass("CUI.Controls.JewelMenuLauncher",CUI.MenuLauncher);CUI.Page.CommandDispatcher.registerClass("CUI.Page.CommandDispatcher");CUI.Page.FocusManager.registerClass("CUI.Page.FocusManager",CUI.Page.CommandDispatcher,CUI.Page.ICommandHandler);CUI.Page.PageManager.registerClass("CUI.Page.PageManager",CUI.RootUser,CUI.Page.ICommandHandler,CUI.IRootBuildClient);CUI.Page.UndoManager.registerClass("CUI.Page.UndoManager",null,CUI.Page.ICommandHandler);Commands.CommandIds.registerClass("Commands.CommandIds");Commands.GlobalRedoProperties.registerClass("Commands.GlobalRedoProperties");Commands.RedoProperties.registerClass("Commands.RedoProperties");Commands.GlobalUndoProperties.registerClass("Commands.GlobalUndoProperties");Commands.UndoProperties.registerClass("Commands.UndoProperties");Mscrm.CommandBarBuilder.$Aa=new RegExp("Mscrm[.]HomepageGrid[.][0-9a-zA-Z._-]*[.]Chart[.][0-9a-zA-Z._-]*");Mscrm.CommandBarBuilder.$AZ=new RegExp("Mscrm[.]HomepageGrid[.][0-9a-zA-Z._-]*[.]VisualizationTab[.][0-9a-zA-Z._-]*");Mscrm.TemplateGenerator.$6P=null;Mscrm.TemplateGenerator.$6Q=null;Mscrm.TemplateGenerator.$6o=null;Mscrm.TemplateGenerator.$7H=null;Mscrm.TemplateGenerator.$6X=null;Mscrm.TemplateGenerator.$6R=null;Mscrm.TemplateGenerator.$7G=null;Mscrm.TemplateGenerator.$5K=false;Mscrm.CommandBarConstants.commandBarMenuClass="ms-crm-CommandBar-Menu";Mscrm.CommandBarConstants.associatedGridCommandBarMenuClass="ms-crm-AssociatedGridCommandBar-Menu";Mscrm.CommandBarConstants.chartsCommandBarMenuClass="ms-crm-ChartsCommandBar-Menu";Mscrm.CommandBarConstants.chartsPaneCommandBarMenuClass="ms-crm-chartsPaneCommand-Bar";Mscrm.CommandBarConstants.chartsDesignerCommandBarMenuClass="ms-crm-chartDesignerCommand-Bar";Mscrm.CommandBarConstants.commandBarItemClass="ms-crm-CommandBarItem";Mscrm.CommandBarConstants.menuLabelClass="ms-crm-Menu-Label";Mscrm.CommandBarConstants.menuLabelClassHovered="ms-crm-Menu-Label-Hovered";Mscrm.CommandBarConstants.menuTextClass="ms-crm-MenuItem-TextRTL";Mscrm.CommandBarConstants.moreMenuButton="moreCommands";Mscrm.CommandBarConstants.chartsMoreMenuButton="moreChartsCommands";Mscrm.CommandBarConstants.chartsDesignerMoreMenuButton="moreChartDesignerCommands";Mscrm.CommandBarConstants.moreMenuButtonSpan="moreCommandsSpan";Mscrm.CommandBarConstants.moreMenuButtonImage="ms-crm-moreCommand-image";Mscrm.CommandBarConstants.commandBarButtonClass="ms-crm-CommandBar-Button";Mscrm.CommandBarConstants.commandBarButtonTemplate="CommandBarButtonTemplate";Mscrm.CommandBarConstants.commandBarSplitButtonTemplate="CommandBarSplitButtonTemplate";Mscrm.CommandBarConstants.commandBarflyOutAnchorTemplate="CommandBarFlyoutAnchorTemplate";Mscrm.CommandBarConstants.commandBarCustomTabTemplate="CommandBarCustomTabTemplate";Mscrm.CommandBarConstants.commandBarCheckBoxTemplate="CommandBarCheckBoxTemplate";Mscrm.CommandBarConstants.commandBarSpinnerTemplate="CommandBarSpinnerTemplate";Mscrm.CommandBarConstants.maxButtonWidth=200;Mscrm.CommandBarConstants.maxIPadButtonWidth=200;Mscrm.CommandBarConstants.maxChartCommandsForDisplay=3;Mscrm.CommandBarConstants.toggleButtonActive="ms-crm-CommandBarToggleButton-Active";Mscrm.CommandBarConstants.commandBarLeftOffset=20;Mscrm.CommandBarConstants.commandBarRightOffset=0;Mscrm.CommandBarConstants.commandBarButtonGap=10;Mscrm.CommandBarConstants.chartCommandBarLeftOffset=0;Mscrm.CommandBarConstants.chartCommandBarRightOffset=10;Mscrm.CommandBarConstants.chartCommandBarButtonGap=15;Mscrm.CommandBarConstants.recordNavId="contextualActionBar";Mscrm.CommandBarConstants.animationDelayBetweenButtons=125;Mscrm.CommandBarConstants.animationIntervalForSingleButton=300;Mscrm.CommandBarConstants.slidingWidth=20;Mscrm.SpinnerCommandProperties.ChangedByMouse="ChangedByMouse";Mscrm.SpinnerCommandProperties.ChangeType="ChangeType";Mscrm.SpinnerCommandProperties.Value="Value";Mscrm.SpinnerCommandProperties.Unit="Unit";Mscrm.SpinnerControl.$7S=-1;Mscrm.RibbonHeaderScaling.$DF=["ms-cui-tts","ms-cui-tts-scale-1","ms-cui-tts-scale-2","ms-cui-tts-scale-2"];Mscrm.RibbonManager.$9G=0;Mscrm.RibbonManager.$75=null;Mscrm.RibbonManager.$5p=false;Mscrm.RibbonNavigationModel.$BB=new RegExp("Mscrm\\.SubGrid\\.[^.]+\\.ContextualTabs");Mscrm.RibbonNavigationModel.$9B=new RegExp("^[^|]+\\|[^|]+\\|"+Mscrm.RibbonContexts.subGridStandard+"\\|Mscrm\\.SubGrid\\.[^.]+\\.ContextualTabs$");Mscrm.RibbonNavigationModel.$7J=new RegExp("^[^|]+\\|[^|]+\\|"+Mscrm.RibbonContexts.subGridAssociated+"\\|Mscrm\\.SubGrid\\.[^.]+\\.ContextualTabs$");CUI.DataNodeWrapper.ATTRIBUTES="attrs";CUI.DataNodeWrapper.CHILDREN="children";CUI.DataNodeWrapper.NAME="name";CUI.DataNodeWrapper.ALIGNMENT="Alignment";CUI.DataNodeWrapper.ALT="Alt";CUI.DataNodeWrapper.CLASSNAME="Classname";CUI.DataNodeWrapper.COLOR="Color";CUI.DataNodeWrapper.COMMAND="Command";CUI.DataNodeWrapper.CONTEXTUALGROUPID="ContextualGroupId";CUI.DataNodeWrapper.CSSCLASS="CssClass";CUI.DataNodeWrapper.DARKBLUE="DarkBlue";CUI.DataNodeWrapper.DECIMALDIGITS="DecimalDigits";CUI.DataNodeWrapper.DESCRIPTION="Description";CUI.DataNodeWrapper.DISPLAYCOLOR="DisplayColor";CUI.DataNodeWrapper.DISPLAYMODE="DisplayMode";CUI.DataNodeWrapper.DIVIDER="Divider";CUI.DataNodeWrapper.ELEMENTDIMENSIONS="ElementDimensions";CUI.DataNodeWrapper.GREEN="Green";CUI.DataNodeWrapper.GROUPID="GroupId";CUI.DataNodeWrapper.id="Id";CUI.DataNodeWrapper.INDEX="Index";CUI.DataNodeWrapper.INTERVAL="Interval";CUI.DataNodeWrapper.LABELTEXT="LabelText";CUI.DataNodeWrapper.LAYOUTTITLE="LayoutTitle";CUI.DataNodeWrapper.LIGHTBLUE="LightBlue";CUI.DataNodeWrapper.LOWSCALEWARNING="LowScaleWarning";CUI.DataNodeWrapper.MAGENTA="Magenta";CUI.DataNodeWrapper.MAXHEIGHT="MaxHeight";CUI.DataNodeWrapper.MAXIMUMVALUE="MaximumValue";CUI.DataNodeWrapper.MAXWIDTH="MaxWidth";CUI.DataNodeWrapper.MENUITEMID="MenuItemId";CUI.DataNodeWrapper.MESSAGE="Message";CUI.DataNodeWrapper.MINIMUMVALUE="MinimumValue";CUI.DataNodeWrapper.namE_CAPS="Name";CUI.DataNodeWrapper.ONEROW="OneRow";CUI.DataNodeWrapper.ORANGE="Orange";CUI.DataNodeWrapper.POPUP="Popup";CUI.DataNodeWrapper.POPUPSIZE="PopupSize";CUI.DataNodeWrapper.PURPLE="Purple";CUI.DataNodeWrapper.SCROLLABLE="Scrollable";CUI.DataNodeWrapper.SEQUENCE="Sequence";CUI.DataNodeWrapper.SIZE="Size";CUI.DataNodeWrapper.STYLE="Style";CUI.DataNodeWrapper.TEAL="Teal";CUI.DataNodeWrapper.TEMPLATEALIAS="TemplateAlias";CUI.DataNodeWrapper.THREEROW="ThreeRow";CUI.DataNodeWrapper.TITLE="Title";CUI.DataNodeWrapper.TWOROW="TwoRow";CUI.DataNodeWrapper.TYPE="Type";CUI.DataNodeWrapper.VALUE="Value";CUI.DataNodeWrapper.YELLOW="Yellow";CUI.DataNodeWrapper.RIBBON="Ribbon";CUI.DataNodeWrapper.QAT="QAT";CUI.DataNodeWrapper.JEWEL="Jewel";CUI.DataNodeWrapper.TABS="Tabs";CUI.DataNodeWrapper.CONTEXTUALTABS="ContextualTabs";CUI.DataNodeWrapper.CONTEXTUALGROUP="ContextualGroup";CUI.DataNodeWrapper.TAB="Tab";CUI.DataNodeWrapper.SCALING="Scaling";CUI.DataNodeWrapper.MAXSIZE="MaxSize";CUI.DataNodeWrapper.SCALE="Scale";CUI.DataNodeWrapper.GROUP="Group";CUI.DataNodeWrapper.GROUPS="Groups";CUI.DataNodeWrapper.LAYOUT="Layout";CUI.DataNodeWrapper.SECTION="Section";CUI.DataNodeWrapper.OVERFLOWSECTION="OverflowSection";CUI.DataNodeWrapper.ROW="Row";CUI.DataNodeWrapper.CONTROL="ControlRef";CUI.DataNodeWrapper.OVERFLOWAREA="OverflowArea";CUI.DataNodeWrapper.STRIP="Strip";CUI.DataNodeWrapper.CONTROLS="Controls";CUI.DataNodeWrapper.MENU="Menu";CUI.DataNodeWrapper.MENUSECTION="MenuSection";CUI.DataNodeWrapper.TEMPLATE="Template";CUI.DataNodeWrapper.TEMPLATES="Templates";CUI.DataNodeWrapper.RIBBONTEMPLATES="RibbonTemplates";CUI.DataNodeWrapper.GROUPTEMPLATE="GroupTemplate";CUI.DataNodeWrapper.GALLERY="Gallery";CUI.DataNodeWrapper.colors="Colors";CUI.DataNodeWrapper.color="Color";CUI.DataNodeWrapper.toggleButton="ToggleButton";CUI.DataNodeWrapper.comboBox="ComboBox";CUI.DataNodeWrapper.dropDown="DropDown";CUI.DataNodeWrapper.button="Button";CUI.DataNodeWrapper.splitButton="SplitButton";CUI.DataNodeWrapper.flyoutAnchor="FlyoutAnchor";CUI.DataNodeWrapper.galleryButton="GalleryButton";CUI.DataNodeWrapper.insertTable="InsertTable";CUI.DataNodeWrapper.label="Label";CUI.DataNodeWrapper.mruSplitButton="MRUSplitButton";CUI.DataNodeWrapper.spinner="Spinner";CUI.DataNodeWrapper.textBox="TextBox";CUI.DataNodeWrapper.checkBox="CheckBox";CUI.DataNodeWrapper.colorPicker="ColorPicker";CUI.DataNodeWrapper.separator="Separator";CUI.DataNodeWrapper.jewelMenuLauncher="JewelMenuLauncher";CUI.DataNodeWrapper.BUTTONDOCK="ButtonDock";CUI.DataNodeWrapper.BUTTONDOCKS="ButtonDocks";CUI.DataNodeWrapper.CENTERALIGN="Center";CUI.DataNodeWrapper.LEFTALIGN="Left";CUI.DataNodeWrapper.RIGHTALIGN="Right";CUI.DataNodeWrapper.TOOLBAR="Toolbar";CUI.DataNodeWrapper.LARGE="Large";CUI.DataNodeWrapper.MEDIUM="Medium";CUI.DataNodeWrapper.SMALL="Small";CUI.DataNodeWrapper.DIVIDERAFTER="DividerAfter";CUI.DataNodeWrapper.DIVIDERBEFORE="DividerBefore";CUI.DataNodeWrapper.$7o=null;CUI.RibbonPeripheralSection.tabRowLeft="TabRowLeft";CUI.RibbonPeripheralSection.tabRowRight="TabRowRight";CUI.RibbonPeripheralSection.qatRowCenter="QATRowCenter";CUI.RibbonPeripheralSection.qatRowRight="QATRowRight";CUI.TemplateManager.$6s=null;CUI.Unit.$7Z=-1;CUI.Utility.$CX=["","ms-cui-img-5by3","ms-cui-img-13by13","ms-cui-img-16by16","ms-cui-img-32by32","ms-cui-img-48by48","ms-cui-img-64by48","ms-cui-img-72by96","ms-cui-img-96by72","ms-cui-img-96by96","ms-cui-img-56by24","ms-cui-img-2by16"];CUI.Utility.$C7=["","Size16by16","Size32by32","Size48by48","Size64by48","Size72by96","Size96by72","Size96by96","Size128by128","Size190by30","Size190by40","Size190by50","Size190by60"];CUI.Utility.$CV=[0,0,0,0,0,0,0,0,0,0,7,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,1,0,0,0,2,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,5,0];CUI.Utility.$1J=["","&quot;","&amp;","&#39;","&lt;","&gt;"," ","<br>","&nbsp;","<b>","<i>","<p>","<u>","</b>","</i>","</p>","</u>"];CUI.Utility.$Ds=false;CUI.Utility.$Dr=false;CUI.Utility.$8V=false;CUI.Utility.$8U=false;CUI.Utility.$8W=false;CUI.Utility.$8Q=false;CUI.Utility.$8X=false;CUI.Utility.$8R=false;CUI.Utility.$4e=0;CUI.Utility.$8N=false;CUI.Utility.$6r=0;CUI.Utility.$8M=false;CUI.Utility.$8S=false;CUI.Utility.$8T=false;CUI.Utility.$7A=null;CUI.ScriptUtility.emptyString="";CUI.Controls.CheckBoxCommandProperties.On="On";CUI.Controls.CheckBoxCommandProperties.CommandValueId="CommandValueId";CUI.Controls.ColorPickerCommandProperties.Color="Color";CUI.Controls.ColorPickerCommandProperties.Style="Style";CUI.Controls.ColorPicker.$7=-10;CUI.Controls.ComboBoxCommandProperties.SelectedItemId="SelectedItemId";CUI.Controls.ComboBoxCommandProperties.IsFreeForm="IsFreeForm";CUI.Controls.ComboBoxCommandProperties.Value="Value";CUI.Controls.DropDownCommandProperties.SelectedItemId="SelectedItemId";CUI.Controls.DropDownCommandProperties.Value="Value";CUI.Controls.GalleryButtonCommandProperties.On="On";CUI.Controls.GalleryButtonCommandProperties.CommandValueId="CommandValueId";CUI.Controls.InsertTableCommandProperties.Rows="Rows";CUI.Controls.InsertTableCommandProperties.Columns="Columns";CUI.Controls.LabelCommandProperties.Value="Value";CUI.Controls.SpinnerCommandProperties.ChangedByMouse="ChangedByMouse";CUI.Controls.SpinnerCommandProperties.ChangeType="ChangeType";CUI.Controls.SpinnerCommandProperties.Value="Value";CUI.Controls.SpinnerCommandProperties.Unit="Unit";CUI.Controls.Spinner.$7S=-1;CUI.Controls.TextBoxCommandProperties.Value="Value";CUI.Controls.ToggleButtonCommandProperties.On="On";CUI.Controls.ToggleButtonCommandProperties.CommandValueId="CommandValueId";CUI.Page.PageManager._instance=null;CUI.Page.UndoManager.$2e=-1;Commands.CommandIds.ApplicationStateChanged="appstatechanged";Commands.CommandIds.GlobalRedo="GlobalRedo";Commands.CommandIds.Redo="Redo";Commands.CommandIds.GlobalUndo="GlobalUndo";Commands.CommandIds.Undo="Undo";Commands.GlobalRedoProperties.SequenceNumber="SequenceNumber";Commands.RedoProperties.SequenceNumber="SequenceNumber";Commands.GlobalUndoProperties.SequenceNumber="SequenceNumber";Commands.UndoProperties.SequenceNumber="SequenceNumber";var g_cuiXMLDOMDocument=null,g_cuiXMLParser=null;CUI.NativeUtility=function(){};CUI.NativeUtility.createXMLDocFromString=function(xml){return CUI.NativeUtility.createXMLDocFromStringCore(xml,false)};CUI.NativeUtility.createXMLDocFromStringCore=function(xml,newObj){if(window.ActiveXObject){var msxmlDomDoc=newObj?null:g_cuiXMLDOMDocument;if(!msxmlDomDoc)try{msxmlDomDoc=new ActiveXObject("MSXML.DomDocument");if(!newObj)g_cuiXMLDOMDocument=msxmlDomDoc}catch(e){}msxmlDomDoc!=null&&msxmlDomDoc.loadXML(xml);return msxmlDomDoc}else if(DOMParser){var domParser=newObj?null:g_cuiXMLParser;if(!domParser){domParser=new DOMParser;if(!newObj)g_cuiXMLParser=domParser}return domParser.parseFromString(xml,"text/xml")}else if(window.XMLHttpRequest){var request=new XMLHttpRequest;request.open("GET","data:text/xml;charset=utf-8,"+xml,false);request.send(null);return request.responseXML()}return null};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();CUI.NativeUtility.setInnerText=function(elem,text){var doc=elem.ownerDocument;if(doc.createTextNode){var textNode=doc.createTextNode(text);elem.innerHTML="";elem.appendChild(textNode)}else elem.innerText=text};CUI.NativeUtility.ecmaScriptStringLiteralEncode=function(str){if(null==str||typeof str=="undefined")return "";for(var strIn=new String(str),strOut=[],ix=0,max=strIn.length,ix=0;ix<max;ix++){var charCode=strIn.charCodeAt(ix);if(charCode>4095)strOut.push("\\u"+charCode.toString(16).toUpperCase());else if(charCode>255)strOut.push("\\u0"+charCode.toString(16).toUpperCase());else if(charCode>127)strOut.push("\\u00"+charCode.toString(16).toUpperCase());else{var c=strIn.charAt(ix);switch(c){case "\n":strOut.push("\\n");break;case "\r":strOut.push("\\r");break;case '"':strOut.push("\\u0022");break;case "%":strOut.push("\\u0025");break;case "&":strOut.push("\\u0026");break;case "'":strOut.push("\\u0027");break;case "(":strOut.push("\\u0028");break;case ")":strOut.push("\\u0029");break;case "+":strOut.push("\\u002b");break;case "/":strOut.push("\\u002f");break;case "<":strOut.push("\\u003c");break;case ">":strOut.push("\\u003e");break;case "\\":strOut.push("\\\\");break;default:strOut.push(c)}}}return strOut.join("")};CUI.NativeUtility.ffClick=function(elm){var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);elm.dispatchEvent(evt)};CUI.NativeUtility.getAttribute=function(attributes,index){return attributes[index]};CUI.NativeUtility.returnFalse=function(){return false};var g_records=[];CUI.PMetrics=function(){};CUI.PMetrics.perfMark=function(marker){var r={};r.m=marker;r.mt=new Date;if(g_records){if(g_records.length==1e3)g_records=[];g_records.push(r)}};CUI.PMetrics.perfReport=function(){if(!g_records)return;var l=g_records.length;if(l>0){var _elmResults=document.getElementById("perf-markers");if(!_elmResults){_elmResults=document.createElement("div");_elmResults.id="perf-markers";_elmResults.style.display="none"}var r,rstr="";for(i=0;i<l;i++){r=g_records[i];if(r)rstr+="<p><span class='time'>"+r.mt.format("MM/dd/yyyy HH:mm:ss.fffffff")+"</span><span class='marker'>"+r.m+"</span><var class='milliseconds'>"+r.mt.getTime()+"</var></p>"}_elmResults.innerHTML+=rstr;document.body.appendChild(_elmResults);g_records=[]}};CUI.PMetrics.perfClear=function(){g_records=[]};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("CUI.js")