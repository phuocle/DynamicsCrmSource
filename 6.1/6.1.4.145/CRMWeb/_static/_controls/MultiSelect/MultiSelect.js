Type.registerNamespace("Mscrm");Mscrm.MultiSelect=function(parent){this.$$d_$a_0=Function.createDelegate(this,this.$a_0);this.$$d_$b_0=Function.createDelegate(this,this.$b_0);this.$$d_$Y_0=Function.createDelegate(this,this.$Y_0);this.$$d_$Z_0=Function.createDelegate(this,this.$Z_0);this.$0_0=Mscrm.Menu.createMenu();this.$0_0.set_stylePrefix(Mscrm.MenuStyles.multiSelectStylePrefix);this.$0_0.set_propagateStyle(false);this.$0_0.set_isModal(true);this.$0_0.set_shiftVertical(false);this.$0_0.set_footer(this.$W_0());this.$9_0={};this.$6_0=new Array(0);this.$2_0=new Array(0);this.$4_0=document.createElement("a");this.$4_0.setAttribute("href","#");this.$4_0.style.styleFloat=Mscrm.Utilities.get_isLeftToRight()?"right":"left";this.$4_0.style.display="inline";$addHandler(this.$4_0,"click",this.$$d_$Z_0);$addHandler(this.$4_0,"keydown",this.$$d_$Y_0);this.$4_0.tabIndex=-1;this.$5_0=Mscrm.ImageStrip.getImage(Mscrm.CrmUri.create(this.$P_0));this.$5_0.setAttribute("alt",IsNull(this.$7_0)?"":this.$7_0);this.$5_0.setAttribute("class","ms-crm-Lookup");this.$5_0.removeAttribute("width");this.$5_0.removeAttribute("height");this.$4_0.appendChild(document.createElement("span"));XUI.Html.DomUtils.GetFirstChild(this.$4_0).appendChild(this.$5_0);this.$3_0=document.createElement("input");this.$3_0.type="text";this.$3_0.setAttribute("contentEditable","false");this.$3_0.style.width="85%";this.$3_0.setAttribute("readonly","true");Sys.UI.DomElement.addCssClass(this.$3_0,"ms-crm-ReadOnly");$addHandler(this.$3_0,"keydown",this.$$d_$Y_0);var $v_0=document.createElement("span");$v_0.appendChild(this.$3_0);$v_0.setAttribute("width","85%");parent.appendChild(this.$4_0);parent.appendChild($v_0)};Mscrm.MultiSelect.prototype={$P_0:"/_imgs/MultiSelect/multiselect_btn_on.gif",$T_0:"/_imgs/MultiSelect/multiselect_btn_dis.gif",$3_0:null,$J_0:"",get_selectedItemsDisplayDefault:function(){return this.$J_0},set_selectedItemsDisplayDefault:function(value){this.$J_0=value;return value},$0_0:null,$4_0:null,$5_0:null,$7_0:null,get_iconToolTip:function(){return this.$7_0},set_iconToolTip:function(value){this.$7_0=value;this.$5_0.setAttribute("alt",IsNull(this.$7_0)?"":this.$7_0);return value},setFloat:function(){this.$5_0.setAttribute("style",Mscrm.Utilities.get_isLeftToRight()?"float:right; display:inline":"float:left; display:inline")},$G_0:null,get_headerText:function(){return this.$G_0},set_headerText:function(value){this.$G_0=value;this.$0_0.set_header(this.$X_0());return value},$I_0:null,get_okCallback:function(){return this.$I_0},set_okCallback:function(value){this.$I_0=value;return value},$E_0:null,get_cancelCallback:function(){return this.$E_0},set_cancelCallback:function(value){this.$E_0=value;return value},$9_0:null,$6_0:null,$2_0:null,$M_0:false,$Y_0:function($p0){switch($p0.keyCode){case 13:case 32:if($p0.target===this.$4_0||$p0.target===this.$3_0){$p0.stopPropagation();$p0.preventDefault();this.$S_0()}break}},$Z_0:function($p0){if(this.get_disabled())return;this.$S_0()},addMultiSelectOption:function(item){var $v_0=this.$2_0.length;this.$2_0[$v_0]=item;this.$M_0&&this.$R_0(item);item.get_checked()&&this.$D_0()},addOption:function(title,value,isChecked,optionGroupName){var $v_0=new Mscrm.MultiSelectOption(title,value,isChecked,optionGroupName);this.addMultiSelectOption($v_0);return $v_0},$R_0:function($p0){var $v_0=$p0.$Q_0;if(isNullOrEmptyString($v_0)){if(IsNull(this.$9_0[""])){var $v_3=this.$6_0.length;this.$9_0[""]=$v_3;this.$6_0[$v_3]=0}$v_0=""}if(IsNull(this.$9_0[$v_0]));for(var $v_1=0,$v_2=this.$9_0[$v_0],$v_4=0;$v_4<=$v_2;$v_4++)$v_1+=this.$6_0[$v_4];this.$6_0[$v_2]=this.$6_0[$v_2]+1;$p0.$U_0();this.$0_0.insertItem($p0.$1_0,$v_1);$p0.get_checked()&&this.$D_0()},addOptionGroup:function(group){var $v_0=this.$6_0.length;this.$9_0[group.$A_0]=$v_0;this.$6_0[$v_0]=1;this.$0_0.addItem(group.$1_0)},$X_0:function(){var $v_0=document.createElement("DIV");$v_0.className="ms-crm-MultiSelect-HeaderFooter";$v_0.innerHTML='<table cellpadding=0 cellspacing=0 width="100%" height="100%"><tr><td style="vertical-align: middle; text-align: center"><span style="text-align: center; width:100%; white-space: nowrap"><nobr title="'+CrmEncodeDecode.CrmHtmlAttributeEncode(this.$G_0)+'">'+CrmEncodeDecode.CrmHtmlEncode(this.$G_0)+"</nobr></span></td></tr></table>";return $v_0},$W_0:function(){var $v_0=document.createElement("DIV");$v_0.className="ms-crm-MultiSelect-HeaderFooter";$v_0.style.textAlign=Mscrm.Utilities.get_isLeftToRight()?"right":"left";var $v_1=document.createElement("button");$v_1.innerHTML=Mscrm.Utilities.decorateAccessKey(window.LOCID_CTRL_MULTIS_BTN_OK);$v_1.accessKey=Mscrm.Utilities.getAccessKey(window.LOCID_CTRL_MULTIS_BTN_OK);$v_1.className="ms-crm-Button";$v_1.style.margin="2px";$v_1.style.minWidth="70px";$addHandler($v_1,"click",this.$$d_$b_0);$v_0.appendChild($v_1);var $v_2=document.createElement("button");$v_2.innerHTML=Mscrm.Utilities.decorateAccessKey(window.LOCID_CTRL_MULTIS_BTN_CANCEL);$v_2.accessKey=Mscrm.Utilities.getAccessKey(window.LOCID_CTRL_MULTIS_BTN_CANCEL);$v_2.className="ms-crm-Button";$v_2.style.margin="2px";$v_2.style.minWidth="70px";$addHandler($v_2,"click",this.$$d_$a_0);$v_0.appendChild($v_2);return $v_0},$L_0:false,get_isDirty:function(){return this.$L_0},set_isDirty:function(value){this.$L_0=value;return value},$O_0:false,get_disabled:function(){return this.$O_0},set_disabled:function(value){this.$O_0=value;this.$5_0.setAttribute("src",value?this.$T_0:this.$P_0);this.$3_0.disabled=value;this.$4_0.disabled=value;return value},clear:function(){this.$2_0=new Array(0);this.$0_0.clear();this.$3_0.value=this.$J_0},$b_0:function($p0){for(var $v_0=this.$0_0.get_menuItems(),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1].get_reference();if($v_2.$H_0)continue;var $v_3=$v_2.get_$V_0();if($v_3!==$v_2.get_checked()){this.$L_0=true;$v_2.set_checked($v_3)}}this.$D_0();this.$0_0.hide();!IsNull(this.$I_0)&&this.$I_0(this)},$a_0:function($p0){for(var $v_0=this.$0_0.get_menuItems(),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1].get_reference();if($v_2.$H_0)continue;$v_2.$c_0()}this.$0_0.hide();!IsNull(this.$E_0)&&this.$E_0(this)},$D_0:function(){for(var $v_0="",$v_1=0;$v_1<this.$2_0.length;$v_1++)if(this.$2_0[$v_1].get_checked())if(!isNullOrEmptyString($v_0))$v_0=String.format(window.LOCID_CTRL_MULTIS_SEP,$v_0,this.$2_0[$v_1].$C_0);else $v_0=this.$2_0[$v_1].$C_0;if(isNullOrEmptyString($v_0))this.$3_0.value=this.$J_0;else this.$3_0.value=$v_0;this.$4_0.style.display="";this.$4_0.style.display="inline"},$S_0:function(){var $v_0=Mscrm.Utilities.getXYPos(this.$3_0,!Mscrm.Utilities.get_isLeftToRight()),$v_1=parseInt($v_0["x"],10),$v_2=parseInt($v_0["y"],10)+this.$3_0.offsetHeight;if(!this.$M_0){this.$M_0=true;for(var $v_3=0;$v_3<this.$2_0.length;$v_3++)this.$R_0(this.$2_0[$v_3])}this.$0_0.set_left($v_1);this.$0_0.set_top($v_2);this.$0_0.set_width(this.$3_0.offsetWidth);this.$0_0.set_focusElementOnHide(this.$3_0);this.$0_0.refresh();this.$0_0.show()},refresh:function(){this.$0_0.refresh()},selectAll:function(toSelect){for(var $v_0=this.$2_0.length,$v_1=0;$v_1<$v_0;$v_1++)this.$2_0[$v_1].set_checked(toSelect);this.$D_0()},selectItem:function(value,toSelect){for(var $v_0=0;$v_0<this.$2_0.length;$v_0++)if(this.$2_0[$v_0].$A_0===value){if(this.$2_0[$v_0].get_checked()!==toSelect){this.$2_0[$v_0].set_checked(toSelect);this.$D_0()}break}},getSelectedItems:function(){for(var $v_0=new Array(0),$v_1=0,$v_2=0;$v_2<this.$2_0.length;$v_2++)if(this.$2_0[$v_2].get_checked()){$v_0[$v_1]=this.$2_0[$v_2];$v_1++}return $v_0}};Mscrm.MultiSelectOption=function(title,value,isChecked,optionGroupName){this.$$d_$d_0=Function.createDelegate(this,this.$d_0);this.$A_0=value;this.$H_0=false;this.$8_0=isChecked;this.$C_0=title;this.$Q_0=optionGroupName;this.$B_0=false};Mscrm.MultiSelectOption.prototype={$H_0:false,$Q_0:null,$1_0:null,$A_0:null,get_value:function(){return this.$A_0},$C_0:null,get_title:function(){return this.$C_0},$8_0:false,get_checked:function(){return this.$8_0},set_checked:function(value){this.$8_0=value;this.$N_0(value);return value},$B_0:false,get_$V_0:function(){if(this.$B_0)return this.$1_0.get_auxIconPath()===Mscrm.MultiSelectOption.$F;else return this.$8_0},$U_0:function(){if(this.$B_0)return;this.$B_0=true;this.$1_0=Mscrm.MenuItem.createMenuItem(this.$C_0);this.$1_0.set_reference(this);this.$1_0.set_stylePrefix(Mscrm.MenuStyles.multiSelectStylePrefix);this.$1_0.set_renderFormat(Mscrm.MenuItem.formaT_AUX_IMAGE_SEP_TITLE);this.$1_0.set_auxIconPath(this.$8_0?Mscrm.MultiSelectOption.$F:Mscrm.MultiSelectOption.$K);this.$1_0.set_isAuxAnchorFocusable(false);this.$1_0.set_actionCallback(this.$$d_$d_0);this.$1_0.set_auxActionCallback(this.$$d_$d_0);this.$1_0.set_hideOnAuxAction(false);this.$1_0.set_hideOnAction(false)},$d_0:function($p0){$p0.get_reference().$N_0($p0.get_auxIconPath()===Mscrm.MultiSelectOption.$K)},$c_0:function(){this.$N_0(this.$8_0)},$N_0:function($p0){if(!this.$B_0)return;if($p0){this.$1_0.set_auxIconPath(Mscrm.MultiSelectOption.$F);this.$1_0.set_auxIconTooltip(window.LOCID_CTRL_MULTIS_SELECT)}else{this.$1_0.set_auxIconPath(Mscrm.MultiSelectOption.$K);this.$1_0.set_auxIconTooltip(window.LOCID_CTRL_MULTIS_UNSELECT)}}};Mscrm.MultiSelectOptionGroup=function(title,value){this.$A_0=value;this.$H_0=true;this.$1_0=Mscrm.MenuItem.createMenuItem(title);this.$1_0.set_isFocusable(false);this.$1_0.set_reference(this);this.$1_0.set_stylePrefix("MS-header")};Mscrm.MultiSelectOptionGroup.prototype={$H_0:false,$1_0:null,$A_0:null,get_value:function(){return this.$A_0}};Mscrm.MultiSelect.registerClass("Mscrm.MultiSelect");Mscrm.MultiSelectOption.registerClass("Mscrm.MultiSelectOption");Mscrm.MultiSelectOptionGroup.registerClass("Mscrm.MultiSelectOptionGroup");Mscrm.MultiSelectOption.$F="/_imgs/MultiSelect/multiselect_checked.png";Mscrm.MultiSelectOption.$K="/_imgs/MultiSelect/multiselect_unchecked.png"