Type.registerNamespace("Mscrm");Mscrm.ICommandBarHandler=function(){};Mscrm.ICommandBarHandler.registerInterface("Mscrm.ICommandBarHandler");Mscrm.IEntityCommand=function(){};Mscrm.IEntityCommand.registerInterface("Mscrm.IEntityCommand");Mscrm.IIncidentCommandBarHandler=function(){};Mscrm.IIncidentCommandBarHandler.registerInterface("Mscrm.IIncidentCommandBarHandler");Mscrm.ILeadCommandBarHandler=function(){};Mscrm.ILeadCommandBarHandler.registerInterface("Mscrm.ILeadCommandBarHandler");Mscrm.IOpportunityCommandBarHandler=function(){};Mscrm.IOpportunityCommandBarHandler.registerInterface("Mscrm.IOpportunityCommandBarHandler");Mscrm.IPageHandler=function(){};Mscrm.IPageHandler.registerInterface("Mscrm.IPageHandler");Mscrm.IRefreshPageHeader=function(){};Mscrm.IRefreshPageHeader.registerInterface("Mscrm.IRefreshPageHeader");Mscrm.LeadCommandBarAction=function(){};Mscrm.LeadCommandBarAction.prototype={none:0,qualify:1,disqualify:2};Mscrm.LeadCommandBarAction.registerEnum("Mscrm.LeadCommandBarAction",false);Mscrm.AccountPageHandler=function(){Mscrm.AccountPageHandler.initializeBase(this)};Mscrm.AccountPageHandler.prototype={$I_2:false,$S_2:null,$D_2:null,$y_2:function(){if(this.$I_2)return;this.$I_2=true;isNullOrEmptyString(this.$D_2)&&this.retrieveFlyoutLayout();Mscrm.RefreshPageHandler.prototype.initializeDeleteRecordFlyout.call(this);this.$1B_2()},processFlyoutLayout:function(){this.$D_2=Mscrm.JsonUtilities.getJsonString(this._flyoutLayoutRequest.responseText);var $v_0=null,$$t_6,$$t_7;$$t_7=Mscrm.JsonUtilities.tryGetParsedJson(this.$D_2,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7;for(var $v_1=$v_0,$$arr_2=$v_1,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_2=$$arr_2[$$idx_4];if($v_2.ActionName==="Delete")this.$S_2=$v_2}},deleteRecord:function(){if(this.isRefreshForm())if(window.UseTabletExperience){this.$y_2();if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}else{this._deleteFlyout.show($P_CRM("#deleteButton"));this._deleteFlyoutVisible=true}}else Mscrm.RefreshPageHandler.prototype.deleteRecord.call(this)},$1B_2:function(){var $v_0=this.$S_2.DivLayout;Mscrm.RefreshPageHandler.prototype.setDeleteFlyoutDialog.call(this,$v_0)}};Mscrm.CampaignResponsePageHandler=function(){};Mscrm.CampaignResponsePageHandler.convert=function(doConvert,createNewLead,customer,quote,order,opportunity,account,contact,currency){var $v_0=function($p1_0){return Mscrm.CampaignResponsePageHandler.$1p(doConvert,createNewLead,customer,quote,order,opportunity,account,contact,currency,$p1_0)};Mscrm.CampaignResponsePageHandler.$12(Mscrm.InlineCommands.ConvertResponse,$v_0,Mscrm.CampaignResponsePageHandler.$10,Mscrm.CampaignResponsePageHandler.$l)};Mscrm.CampaignResponsePageHandler.convertAndQualifyLead=function(leadId,createAccount,createContact,createOpportunity,campaignId,campaignType,opportunityParentId,opportunityParentType,suppressDuplicateDetection,showNew){var $v_0=function($p1_0){return Mscrm.CampaignResponsePageHandler.$2t(leadId,createAccount,createContact,createOpportunity,campaignId,campaignType,opportunityParentId,opportunityParentType,suppressDuplicateDetection,$p1_0)},$v_1=Mscrm.CampaignResponsePageHandler.$4u;if(showNew)$v_1=Mscrm.CampaignResponsePageHandler.$4Q;Mscrm.CampaignResponsePageHandler.$12(Mscrm.InlineCommands.CampaignResponseConvertAndQualifyLead,$v_0,$v_1,Mscrm.CampaignResponsePageHandler.$l)};Mscrm.CampaignResponsePageHandler.close=function(state){var $v_0=function($p1_0){return Mscrm.CampaignResponsePageHandler.$2r(state,$p1_0)};Mscrm.CampaignResponsePageHandler.$12(Mscrm.InlineCommands.CampaignResponseClose,$v_0,Mscrm.CampaignResponsePageHandler.$10,Mscrm.CampaignResponsePageHandler.$l)};Mscrm.CampaignResponsePageHandler.closeAndDisqualifyLead=function(leadId,leadStatus){var $v_0=function($p1_0){return Mscrm.CampaignResponsePageHandler.$2q(leadId,leadStatus,$p1_0)};Mscrm.CampaignResponsePageHandler.$12(Mscrm.InlineCommands.CampaignResponseCloseAndDisqualifyLead,$v_0,Mscrm.CampaignResponsePageHandler.$10,Mscrm.CampaignResponsePageHandler.$l)};Mscrm.CampaignResponsePageHandler.copy=function(){var $v_0=function($p1_0){return Mscrm.CampaignResponsePageHandler.$2u($p1_0)};Mscrm.CampaignResponsePageHandler.$12(Mscrm.InlineCommands.CampaignResponseCopy,$v_0,Mscrm.CampaignResponsePageHandler.$10,Mscrm.CampaignResponsePageHandler.$l)};Mscrm.CampaignResponsePageHandler.$1p=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8,$p9){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><convert>{2}</convert><createnewlead>{3}</createnewlead><customer>{4}</customer><quote>{5}</quote><order>{6}</order><opportunity>{7}</opportunity><account>{8}</account><contact>{9}</contact><currency>{10}</currency><dataxml>{11}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode($p0.toString()),CrmEncodeDecode.CrmXmlEncode($p1.toString()),CrmEncodeDecode.CrmXmlEncode($p2.toString()),CrmEncodeDecode.CrmXmlEncode($p3.toString()),CrmEncodeDecode.CrmXmlEncode($p4.toString()),CrmEncodeDecode.CrmXmlEncode($p5.toString()),CrmEncodeDecode.CrmXmlEncode($p6),CrmEncodeDecode.CrmXmlEncode($p7),CrmEncodeDecode.CrmXmlEncode($p8),CrmEncodeDecode.CrmXmlEncode($p9));return $v_0};Mscrm.CampaignResponsePageHandler.$2t=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8,$p9){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><leadid>{2}</leadid><createaccount>{3}</createaccount><createcontact>{4}</createcontact><createopportunity>{5}</createopportunity><campaignid>{6}</campaignid><campaigntype>{7}</campaigntype><opportunityparentid>{8}</opportunityparentid><opportunityparenttype>{9}</opportunityparenttype><suppressduplicatedetection>{10}</suppressduplicatedetection><dataxml>{11}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($p1),CrmEncodeDecode.CrmXmlEncode($p2.toString()),CrmEncodeDecode.CrmXmlEncode($p3.toString()),CrmEncodeDecode.CrmXmlEncode($p4),CrmEncodeDecode.CrmXmlEncode($p5),CrmEncodeDecode.CrmXmlEncode($p6),CrmEncodeDecode.CrmXmlEncode($p7),CrmEncodeDecode.CrmXmlEncode($p8.toString()),CrmEncodeDecode.CrmXmlEncode($p9));return $v_0};Mscrm.CampaignResponsePageHandler.$2r=function($p0,$p1){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><state>{2}</state><dataxml>{3}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode($p0.toString()),CrmEncodeDecode.CrmXmlEncode($p1));return $v_0};Mscrm.CampaignResponsePageHandler.$2q=function($p0,$p1,$p2){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><leadid>{2}</leadid><leadstatus>{3}</leadstatus><dataxml>{4}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($p1.toString()),CrmEncodeDecode.CrmXmlEncode($p2));return $v_0};Mscrm.CampaignResponsePageHandler.$2u=function($p0){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name><dataxml>{2}</dataxml></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode($p0));return $v_0};Mscrm.CampaignResponsePageHandler.$5Q=function($p0){return false};Mscrm.CampaignResponsePageHandler.$12=function($p0,$p1,$p2,$p3){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_0="",$$t_6,$$t_7;if($$t_7=Mscrm.InlineEditDataService.isValidFormData(Mscrm.CampaignResponsePageHandler.$5Q,$p0,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7){var $v_1=$p1($v_0);Mscrm.CampaignResponsePageHandler.$21($p0,$v_1,$p2,$p3)}};Mscrm.CampaignResponsePageHandler.$21=function($p0,$p1,$p2,$p3){Mscrm.InlineEditDataService.get_dataService().set_succeedCallback($p2);Mscrm.InlineEditDataService.get_dataService().set_errorCallback($p3);Mscrm.InlineEditDataService.execute($p0,$p1)};Mscrm.CampaignResponsePageHandler.$10=function($p0){return Mscrm.CampaignResponsePageHandler.$4E($p0)};Mscrm.CampaignResponsePageHandler.$4E=function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(IsNull($v_0))return false;var $v_1=Xrm.Internal.getEntityCode($v_0.TypeName);Mscrm.ReadFormUtilities.openInSameFrame($v_1,$v_0.Id);Mscrm.InlineEditDataService.refreshGridOnStateChange();return true};Mscrm.CampaignResponsePageHandler.$4u=function($p0){Mscrm.ReadFormUtilities.forceReload(Mscrm.EntityTypeCode.CampaignResponse,Mscrm.InlineEditDataService.get_formEntity().get_recordId(),Mscrm.InlineEditDataService.get_formId());return true};Mscrm.CampaignResponsePageHandler.$4Q=function($p0){for(var $v_0=$p0["entities"],$$arr_2=$v_0,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_1=$$arr_2[$$idx_4],$v_2=Xrm.Internal.getEntityCode($v_1.Name);openObj($v_2,$v_1.Id,null,null,Mscrm.NavigationMode.NavigationModeNewWindow,null)}Mscrm.ReadFormUtilities.forceReload(Mscrm.EntityTypeCode.CampaignResponse,Mscrm.InlineEditDataService.get_formEntity().get_recordId(),Mscrm.InlineEditDataService.get_formId());return true};Mscrm.CampaignResponsePageHandler.$l=function($p0){if(!IsNull($p0["_error"])){var $v_0=$p0["_error"];alert($v_0.Description);return true}return false};Mscrm.CommonActivityPageHandler=function(){};Mscrm.CommonActivityPageHandler.executeCommand=function(commandNumber,openNewRecord){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_1="",$$t_5,$$t_6;if(!($$t_6=Mscrm.InlineEditDataService.isValidFormData(null,commandNumber,$$t_5={val:$v_1}),$v_1=$$t_5.val,$$t_6))return;Mscrm.InlineEditDataService.get_dataService().set_succeedCallback(function($p1_0){return Mscrm.CommonActivityPageHandler.$2y($p1_0,openNewRecord)});Mscrm.InlineEditDataService.get_dataService().set_errorCallback(Mscrm.CommonActivityPageHandler.$2g);Mscrm.InlineEditDataService.execute(commandNumber,Mscrm.CommonActivityPageHandler.$2s($v_0,$v_1))}};Mscrm.CommonActivityPageHandler.$2y=function($p0,$p1){if(!$p1)return Mscrm.CommonActivityPageHandler.$2R($p0);else return true};Mscrm.CommonActivityPageHandler.$2R=function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0),$v_1=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[Mscrm.InlineEditDataService.get_formEntity().get_typeName()];if(IsNull($v_0))return false;Mscrm.ReadFormUtilities.forceReload($v_1,$v_0.Id,Mscrm.InlineEditDataService.get_formId());return true};Mscrm.CommonActivityPageHandler.$2g=function($p0){if(!IsNull($p0["_error"])){var $v_0=$p0["_error"];alert($v_0.DisplayText);return true}return false};Mscrm.CommonActivityPageHandler.$2s=function($p0,$p1){var $v_0="",$v_1=Mscrm.InlineEditDataService.get_formId(),$v_2=$p0.get_isNew()?"{00000000-0000-0000-0000-000000000000}":$p0.get_recordId(),$v_3="Completed",$v_4=-1;$v_0=String.format("<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml><newStatusCode>{4}</newStatusCode><newStateCode>{5}</newStateCode></Input>",CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode($p0.get_typeName()),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($p1),CrmEncodeDecode.CrmXmlEncode($v_4.toString()),CrmEncodeDecode.CrmXmlEncode($v_3.toString()));return $v_0};Mscrm.ContactPageHandler=function(){Mscrm.ContactPageHandler.initializeBase(this)};Mscrm.ContactPageHandler.prototype={$I_2:false,$S_2:null,$D_2:null,$y_2:function(){if(this.$I_2)return;this.$I_2=true;isNullOrEmptyString(this.$D_2)&&this.retrieveFlyoutLayout();Mscrm.RefreshPageHandler.prototype.initializeDeleteRecordFlyout.call(this);this.$1B_2()},processFlyoutLayout:function(){this.$D_2=Mscrm.JsonUtilities.getJsonString(this._flyoutLayoutRequest.responseText);var $v_0=null,$$t_6,$$t_7;$$t_7=Mscrm.JsonUtilities.tryGetParsedJson(this.$D_2,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7;for(var $v_1=$v_0,$$arr_2=$v_1,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_2=$$arr_2[$$idx_4];if($v_2.ActionName==="Delete")this.$S_2=$v_2}},deleteRecord:function(){if(this.isRefreshForm())if(window.UseTabletExperience){this.$y_2();if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}else{this._deleteFlyout.show($P_CRM("#deleteButton"));this._deleteFlyoutVisible=true}}else Mscrm.RefreshPageHandler.prototype.deleteRecord.call(this)},$1B_2:function(){var $v_0=this.$S_2.DivLayout;Mscrm.RefreshPageHandler.prototype.setDeleteFlyoutDialog.call(this,$v_0)}};Mscrm.ContractDetailRefreshPageHandler=function(){Mscrm.ContractDetailRefreshPageHandler.initializeBase(this)};Mscrm.ContractDetailRefreshPageHandler.prototype={postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$1v_2()},postRefresh:function(){Mscrm.RefreshPageHandler.prototype.postRefresh.call(this);this.$1v_2()},$1v_2:function(){var $v_0=window._bUseDiscountAsPercentage;if(!IsNull($v_0)){var $v_1=null;if($v_0)$v_1=Xrm.Page.ui.controls.get("discount");else $v_1=Xrm.Page.ui.controls.get("discountpercentage");!IsNull($v_1)&&$v_1.setDisabled(true)}}};Mscrm.ContractDetailPageHandler=function(){Mscrm.ContractDetailPageHandler.initializeBase(this)};Mscrm.ContractDetailPageHandler.prototype={buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.ContractDetailCancel:return this.$38_1();default:return this.createCommandWithDefaultParameter()}},$38_1:function(){var $v_0=this.$1_0,$v_1=$v_0,$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStateString>{3}</newStateString><dataxml>{4}</dataxml></Input>";$v_2=String.format($v_3,this.get_primaryEntity().get_recordId(),this.get_primaryEntity().get_typeName(),Mscrm.InlineEditDataService.get_formId(),$v_1,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2}};Mscrm.ContractPageHandler=function(){Mscrm.ContractPageHandler.initializeBase(this)};Mscrm.ContractPageHandler.prototype={buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.ContractHold:case Mscrm.InlineCommands.ContractReleaseHold:case Mscrm.InlineCommands.ContractInvoice:return this.$3A_1();case Mscrm.InlineCommands.ContractRenew:return this.$39_1();case Mscrm.InlineCommands.ContractClone:return this.$37_1();case Mscrm.InlineCommands.ContractCancel:return this.$36_1();default:return this.createCommandWithDefaultParameter()}},$3A_1:function(){var $v_0="",$v_1=this.$1_0["NewStateCode"],$v_2=this.$1_0["NewStatusCode"],$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newState>{3}</newState><newStatusCode>{4}</newStatusCode><dataxml>{5}</dataxml></Input>";$v_0=String.format($v_3,this.get_primaryEntity().get_recordId(),this.get_primaryEntity().get_typeName(),Mscrm.InlineEditDataService.get_formId(),$v_1,$v_2,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_0},$39_1:function(){var $v_0=this.$1_0["rcIncludeCancelledLines"],$v_1=this.$1_0["statusCode"],$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><rcIncludeCancelledLines>{3}</rcIncludeCancelledLines><newStatusCode>{4}</newStatusCode><dataxml>{5}</dataxml></Input>";$v_2=String.format($v_3,this.get_primaryEntity().get_recordId(),this.get_primaryEntity().get_typeName(),Mscrm.InlineEditDataService.get_formId(),$v_0,$v_1,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2},$37_1:function(){var $v_0=this.$1_0,$v_1=$v_0,$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><ccIncludeCancelledLines>{3}</ccIncludeCancelledLines><dataxml>{4}</dataxml></Input>";$v_2=String.format($v_3,this.get_primaryEntity().get_recordId(),this.get_primaryEntity().get_typeName(),Mscrm.InlineEditDataService.get_formId(),$v_1,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2},$36_1:function(){var $v_0=this.$1_0["cancellationDate"],$v_1=this.$1_0["statusCode"],$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><ccCancellationDate>{3}</ccCancellationDate><newStatusCode>{4}</newStatusCode><dataxml>{5}</dataxml></Input>";$v_2=String.format($v_3,this.get_primaryEntity().get_recordId(),this.get_primaryEntity().get_typeName(),Mscrm.InlineEditDataService.get_formId(),$v_0,$v_1,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2}};Mscrm.EmailCommandHandler=function(){this.$$d_$3Y_1=Function.createDelegate(this,this.$3Y_1);Mscrm.EmailCommandHandler.initializeBase(this)};Mscrm.EmailCommandHandler.prototype={get_commandSucceedCallback:function(){return this.$$d_$3Y_1},buildCommandXml:function(){return this.$2v_1("sendType" in this.$1_0?this.$1_0["sendType"].toString():"")},$3Y_1:function($p0){var $v_0=$p0["_extraParams"];if(IsNull($v_0))return false;var $v_1=IsNull($v_0["sendType"])?"":$v_0["sendType"].toString(),$v_2=IsNull($v_0["sendSucceed"])?false:Boolean.parse($v_0["sendSucceed"].toString());delete $p0._extraParams;var $v_3=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_3)){var $v_4=$v_3.Id;Mscrm.RefreshPageHandler.$J=true;if($v_1==="send")if($v_2){var $v_5=Mscrm.PageManager.get_instance(),$v_6={};$v_6["isCheckPoint"]=false;$v_5.raiseEvent(Mscrm.ScriptEvents.UpdatePageInformation,$v_6);(new Mscrm.RefreshPageHandler).close()}else Xrm.Utility.openEntityForm(Mscrm.InternalUtilities.EntityNames.Email,$v_4,{});else Xrm.Utility.openEntityForm(Mscrm.InternalUtilities.EntityNames.Email,$v_4,null);Mscrm.InlineEditDataService.refreshGridOnStateChange()}return true},$2v_1:function($p0){var $v_0="",$v_1="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml><sendType>{4}</sendType></Input>";$v_0=String.format($v_1,CrmEncodeDecode.CrmXmlEncode(isNullOrEmptyString(this.get_primaryEntity().get_recordId())?"{00000000-0000-0000-0000-000000000000}":this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode(this.$7_0),CrmEncodeDecode.CrmXmlEncode($p0));return $v_0}};Mscrm.IncidentPageHandler=function(){this.$$d_$2z_2=Function.createDelegate(this,this.$2z_2);this.$$d_$30_2=Function.createDelegate(this,this.$30_2);this.$$d_$2L_2=Function.createDelegate(this,this.$2L_2);Mscrm.IncidentPageHandler.initializeBase(this)};Mscrm.IncidentPageHandler.prototype={$1F_2:0,$2e_2:"notescontrolactivityContainer_notescontrol",postPageRender:function(){Mscrm.RefreshPageHandler.prototype.postPageRender.call(this);if(this.isRefreshForm()){isNullOrEmptyString(Mscrm.RefreshPageHandler.getEntityIdFromPage())&&Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(this.$$d_$2L_2);this.$58_2()}},postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);if(this.isRefreshForm()){isNullOrEmptyString(Mscrm.RefreshPageHandler.getEntityIdFromPage())&&this.$4G_2();if(Mscrm.Utilities.isProcessForm()){var $v_0=_activityTypeCode;!IsNull(Mscrm.ActivityContainer)&&!IsNull($v_0)&&-1!==$v_0&&Mscrm.ActivityContainer.initializeActivityContainer()}}},$55_2:function(){var $v_0=this._formData["customerid"];if("otypename" in $v_0)if($v_0["otypename"].toString()===Mscrm.EntityLogicalNames.Account)this.$1F_2=Mscrm.EntityTypeCode.Account;else this.$1F_2=Mscrm.EntityTypeCode.Contact},getQuickFormLoadOrder:function($p0){Mscrm.RefreshPageHandler.prototype.getQuickFormLoadOrder.call(this,$p0);if(this.isRefreshForm()&&Mscrm.Utilities.isProcessForm())if(isNullOrEmptyString(Mscrm.RefreshPageHandler.getEntityIdFromPage())){var $v_0=_activityTypeCode;if(!IsNull($v_0)&&Mscrm.EntityTypeCode.PhoneCall===$v_0)$p0["8e0b7c1e-f5a0-4e7d-b04d-4ca8d5c5ca80"]=Mscrm.InlineEditLoadOrder.onFormLoad;$p0["bdb0ae1c-32fa-4374-b637-8dafe107bc44"]=Mscrm.InlineEditLoadOrder.deferred}else if("customerid" in this._formData){this.$55_2();switch(this.$1F_2){case Mscrm.EntityTypeCode.Account:$p0["b028db32-3619-48a5-ac51-cf3f947b0ef3"]=Mscrm.InlineEditLoadOrder.onFormLoad;$p0["707fc57b-c5e6-471b-a180-e37ed28a38e2"]=Mscrm.InlineEditLoadOrder.deferred;break;case Mscrm.EntityTypeCode.Contact:$p0["707fc57b-c5e6-471b-a180-e37ed28a38e2"]=Mscrm.InlineEditLoadOrder.onFormLoad;$p0["b028db32-3619-48a5-ac51-cf3f947b0ef3"]=Mscrm.InlineEditLoadOrder.deferred;break}}},navigateToNewEntity:function(){var $v_0=_activityTypeCode,$v_1="formid="+this._formData["_formId"];if(!IsNull($v_0)&&-1!==$v_0)$v_1+="&activitytypecode="+$v_0;$v_1+="&setlastviewed="+false;$v_1+="&rof="+true;$v_1+="&theme="+window.RefreshFormTheme;$v_1+=Mscrm.ReadFormUtilities.$2B(Mscrm.EntityTypeCode.Incident);openObj(Mscrm.EntityTypeCode.Incident,null,$v_1)},$2L_2:function($p0,$p1){$p1.get_command()===Mscrm.InlineCommands.Save&&this.$4r_2($p1.get_jsonData());if(!isNullOrEmptyString($p1.get_entityReference().Id))!Mscrm.InlineEditDataService.get_dataService().get_isDisposed()&&Mscrm.InlineEditDataService.get_dataService().remove_formRefreshed(this.$$d_$2L_2)},$58_2:function(){var $v_0=$get("header_process_relatedcases");if(!IsNull($v_0)){var $v_1=$v_0.getAttribute(Mscrm.InlineEditConstants.HtmlAttributeForAttributeLogicalName);$v_1==="existingcase"&&$v_0.setAttribute(Mscrm.InlineEditConstants.HtmlAttributeForRelatedEntityLookupType,"relatedcaseslookup")}},$4G_2:function(){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){Mscrm.InlineEditInitializerUtility.initializeEditViewsForAttributeIds(["caseorigincode"]);var $v_1=$v_0.get_attributes().get("caseorigincode");if(!IsNull($v_1)){var $v_2=this.$5H_2();if($v_2!==-1){$v_1.resetValue($v_2);$v_1.fireOnChange()}}}},$5H_2:function(){var $v_0=_activityTypeCode;if(!IsNull($v_0)&&-1!==$v_0)switch($v_0){case Mscrm.EntityTypeCode.PhoneCall:return 1;case Mscrm.EntityTypeCode.Email:return 2;case Mscrm.EntityTypeCode.WebWizard:return 3;default:return -1}return -1},$4r_2:function($p0){if(!this.isRefreshForm()&&!Mscrm.Utilities.isProcessForm())return;var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0),$v_1=$find("__Page_crmEventManager"),$v_2=$find(this.$2e_2);if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.Id)&&!IsNull($v_1)&&!IsNull($v_2)){var $v_3={};$v_3["entityID"]=$v_0.Id;$v_1.raiseEvent(Mscrm.ScriptEvents.RefreshActivitiesWall,$v_3,$v_2)}},launchProcessControlConfiguration:function(){Mscrm.RefreshPageHandler.editSalesProcess()},$E_2:null,get_commandSucceedCallback:function(){return this.$E_2},set_commandSucceedCallback:function($p0){this.$E_2=$p0;return $p0},buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.IncidentCancel:return this.$3D_2();case Mscrm.InlineCommands.IncidentResolve:return this.$3E_2();case Mscrm.InlineCommands.Reactivate:this.$E_2=this.$$d_$30_2;return this.$3C_2();case Mscrm.InlineCommands.IncidentCheckForOpenActivities:this.$E_2=this.$$d_$2z_2;return this.$3F_2();default:return this.createCommandWithDefaultParameter()}},$30_2:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(IsNull($v_0))return false;var $v_1=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[Mscrm.InlineEditDataService.get_formEntity().get_typeName()];Mscrm.ReadFormUtilities.forceReload($v_1,$v_0.Id,Mscrm.InlineEditDataService.get_formId());Xrm.Internal.refreshParentGrid(Mscrm.EntityTypeCode.Incident,"",Xrm.Page.data.entity.getId());return true},$3D_2:function(){var $v_0=this.$1_0["StatusCode"],$v_1="",$v_2="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStatusCode>{3}</newStatusCode><dataxml>{4}</dataxml></Input>";$v_1=String.format($v_2,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$3E_2:function(){var $v_0=this.$1_0["StatusCode"],$v_1=this.$1_0["ActivityXml"],$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStatusCode>{3}</newStatusCode><activityXml>{4}</activityXml><dataxml>{5}</dataxml></Input>";$v_2=String.format($v_3,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),$v_1,CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2},$3F_2:function(){var $v_0=this.$1_0["inputCommand"],$v_1="",$v_2="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStatusCode>{3}</newStatusCode><dataxml>{4}</dataxml></Input>";$v_1=String.format($v_2,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$3C_2:function(){var $v_0="Active",$v_1=this.$1_0["StatusCode"],$v_2="",$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStateCode>{3}</newStateCode><newStatusCode>{4}</newStatusCode><dataxml>{5}</dataxml></Input>";$v_2=String.format($v_3,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2},$2z_2:function($p0){var $v_0=-1;if(!IsNull(this.$1_0))$v_0=this.$1_0["inputCommand"];var $v_1=Mscrm.InlineEditUtilities.getEntityReference($p0);if(IsNull($v_1))return false;if($v_0===Mscrm.InlineCommands.IncidentResolve)this.$34_2($v_1.Id);else this.$2x_2();return true},$34_2:function($p0){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_closecase.aspx");$v_0.get_query()["pId"]=$p0;$v_0.get_query()["pType"]=Mscrm.EntityTypeCode.Incident;var $v_1=new Mscrm.CrmDialog($v_0,window.document,400,391,null);$v_1.setCallbackInfo("performActionAfterCloseCase",this,null);return $v_1.show()},$2x_2:function(){var $v_0=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx"),null,520,195,null);$v_0.setCallbackInfo("performActionAfterCancelCase",this,null);return $v_0.show()},performActionAfterCloseCase:function($p0){if($p0){var $v_0=Mscrm.InlineEditDataService.save(Xrm.SaveMode.deactivate,null,null,true);if($v_0.get_success()){var $v_1={};$v_1["ActivityXml"]=$p0.ActivityXml;$v_1["StatusCode"]=$p0.StatusCode;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.IncidentResolve,$v_1)}}return true},performActionAfterCancelCase:function($p0){if($p0){var $v_0={};$v_0["StatusCode"]=$p0.StatusCode;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.IncidentCancel,$v_0)}return true},reloadAfterCaseCloseOrCancelForOutlook:function(){var $v_0=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[Mscrm.InlineEditDataService.get_formEntity().get_typeName()];Mscrm.ReadFormUtilities.forceReload($v_0,Mscrm.InlineEditDataService.get_formEntity().get_recordId(),Mscrm.InlineEditDataService.get_formId())}};Mscrm.InvoicePageHandler=function(){this.$$d_$2P_1=Function.createDelegate(this,this.$2P_1);Mscrm.InvoicePageHandler.initializeBase(this)};Mscrm.InvoicePageHandler.prototype={buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.InvoiceGetProducts:return this.$1V_1();case Mscrm.InlineCommands.InvoicePaid:case Mscrm.InlineCommands.InvoiceCancel:return this.$3G_1();case Mscrm.InlineCommands.RecalculateRecord:this.set_commandSucceedCallback(this.$$d_$2P_1);return this.createCommandWithDefaultParameter();default:return this.createCommandWithDefaultParameter()}},$1V_1:function(){var $v_0=this.$1_0["OpportunityID"],$v_1="",$v_2="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><gpOpportunityId>{3}</gpOpportunityId><dataxml>{4}</dataxml></Input>";$v_1=String.format($v_2,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$3G_1:function(){var $v_0=this.$1_0,$v_1="",$v_2=$v_0,$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStatusCode>{3}</newStatusCode><commandType>{4}</commandType><dataxml>{5}</dataxml></Input>";$v_1=String.format($v_3,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode(this.$H_0.toString()),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$2P_1:function($p0){return false}};Mscrm.LeadPageHandler=function(){this.$$d_$25_2=Function.createDelegate(this,this.$25_2);this.$$d_$2L_2=Function.createDelegate(this,this.$2L_2);this.$$d_$2w_2=Function.createDelegate(this,this.$2w_2);this.$$d_$4n_2=Function.createDelegate(this,this.$4n_2);this.$$d_$4I_2=Function.createDelegate(this,this.$4I_2);this.$$d_$3W_2=Function.createDelegate(this,this.$3W_2);Mscrm.LeadPageHandler.initializeBase(this)};Mscrm.LeadPageHandler.$1A=function($p0){var $v_0=$P_CRM(".ui-selected"),$v_1;if($p0.which===40||$p0.which===9&&!$p0.shiftKey){$v_1=$v_0.next();if(!$v_1.length)$v_1=$P_CRM("#selectedstateconvertlead").children(":first-child")}else{$v_1=$v_0.prev();if(!$v_1.length)$v_1=$P_CRM("#selectedstateconvertlead").children(":last-child")}$v_1.hasClass("li-flyoutlistitem")&&Mscrm.LeadPageHandler.$1C($v_1,$v_0)};Mscrm.LeadPageHandler.$2F=function($p0){var $v_0=$P_CRM($p0.target);if(!$v_0.hasClass("li-flyoutlistitem"))return;var $v_1=$P_CRM(".ui-selected");Mscrm.LeadPageHandler.$1C($v_0,$v_1)};Mscrm.LeadPageHandler.$1C=function($p0,$p1){$p1.addClass("ui-selectee");$p1.removeClass("ui-selected");$p0.removeClass("ui-selectee");$p0.addClass("ui-selected");$p0.focus()};Mscrm.LeadPageHandler.$2H=function($p0,$p1,$p2,$p3,$p4){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!$v_0.get_isNew()){Mscrm.InlineEditDataService.setCallback($p3,$p4);Mscrm.LeadPageHandler.$49($p0,$p1,$p4,$p2);Mscrm.InlineEditDataService.refreshGrid()}};Mscrm.LeadPageHandler.$49=function($p0,$p1,$p2,$p3){Mscrm.MetricsReporting.instance().addMetric("Lead Qualify","RO Form");var $v_0=Mscrm.Utilities.createGuid(),$v_1="",$v_2=Mscrm.Utilities.createGuid(),$v_3=Mscrm.Utilities.createGuid(),$v_4="",$v_5=false,$v_6=true,$v_7=true,$v_8=true,$v_9=-1,$v_A=false,$v_B=false,$v_C=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_C.get_attributes().get("transactioncurrencyid"))&&!IsNull($v_C.get_attributes().get("transactioncurrencyid").get_value()))$v_1=$v_C.get_attributes().get("transactioncurrencyid").get_value()[0].id;if(isNullOrEmptyString($v_1))$v_1=$p1;if(!IsNull($v_C.get_attributes().get("parentaccountid"))&&!IsNull($v_C.get_attributes().get("parentaccountid").get_value())){$v_2=$v_C.get_attributes().get("parentaccountid").get_value()[0].id;if(!isNullOrEmptyString($v_2))$v_B=true}if(!IsNull($v_C.get_attributes().get("parentcontactid"))&&!IsNull($v_C.get_attributes().get("parentcontactid").get_value())){$v_3=$v_C.get_attributes().get("parentcontactid").get_value()[0].id;if(!isNullOrEmptyString($v_3))$v_A=true}if(!IsNull($v_C.get_attributes().get("companyname")))$v_4=$v_C.get_attributes().get("companyname").get_value();if(!isNullOrEmptyString($v_4))$v_5=true;if($v_B&&$v_A){$v_5=false;$v_6=false;$v_0=$v_2;$v_9=1;$p3=true}else if($v_B){$v_5=false;$v_6=true;$v_0=$v_2;$v_9=1}else if($v_A)if(!isNullOrEmptyString($v_4)){$v_5=true;$v_6=false;$v_0=$v_2;$v_9=1}else{$v_5=false;$v_6=false;$v_0=$v_3;$v_9=2}var $v_D="",$$t_J,$$t_K;if(!($$t_K=Mscrm.InlineEditDataService.isValidFormData($p2,Mscrm.InlineCommands.LeadQualify,$$t_J={val:$v_D}),$v_D=$$t_J.val,$$t_K))return;var $v_E=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlOpportunityParentId>{3}</qlOpportunityParentId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlOpportunityParentType>{4}</qlOpportunityParentType>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlOppCurrencyId>{5}</qlOppCurrencyId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlCreateOpportunity>{6}</qlCreateOpportunity>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlCreateContact>{7}</qlCreateContact>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlCreateAccount>{8}</qlCreateAccount>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlSuppressDuplicateDetection>{9}</qlSuppressDuplicateDetection>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<qlShowNew>{10}</qlShowNew>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<newStateCode>1</newStateCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<newStatusCode>{11}</newStatusCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<dataxml>{12}</dataxml>\r\n\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_C.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_C.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode($v_9.toString()),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($v_8.toString()),CrmEncodeDecode.CrmXmlEncode($v_6.toString()),CrmEncodeDecode.CrmXmlEncode($v_5.toString()),CrmEncodeDecode.CrmXmlEncode($p3.toString()),CrmEncodeDecode.CrmXmlEncode($v_7.toString()),CrmEncodeDecode.CrmXmlEncode($p0.toString()),CrmEncodeDecode.CrmXmlEncode($v_D));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.LeadQualify,$v_E)};Mscrm.LeadPageHandler.$47=function($p0,$p1,$p2){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!$v_0.get_isNew()){Mscrm.InlineEditDataService.setCallback($p1,$p2);Mscrm.LeadPageHandler.$48($p0,$p2);Mscrm.InlineEditDataService.refreshGrid()}};Mscrm.LeadPageHandler.$48=function($p0,$p1){Mscrm.MetricsReporting.instance().addMetric("Lead Diqualify","RO Form");var $v_0="",$$t_5,$$t_6;if(!($$t_6=Mscrm.InlineEditDataService.isValidFormData($p1,Mscrm.InlineCommands.LeadDisqualify,$$t_5={val:$v_0}),$v_0=$$t_5.val,$$t_6))return;var $v_1=Mscrm.InlineEditDataService.get_formEntity(),$v_2=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ulNewStatus>{3}</ulNewStatus>\r\n\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_1.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_1.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($p0.toString()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.LeadDisqualify,$v_2)};Mscrm.LeadPageHandler.prototype={$9_2:false,$5_2:null,$V_2:null,$I_2:false,$N_2:null,$f_2:null,$D_2:null,$1P_2:null,$1K_2:false,$8_2:null,$16_2:null,$1H_2:false,$1N_2:null,$1M_2:null,$S_2:null,$3X_2:function(){if(this.$1H_2)return;isNullOrEmptyString(this.$D_2)&&this.retrieveFlyoutLayout();this.$8_2=new Mscrm.InlineFlyOutDialog;var $v_0=$P_CRM("<div id='DuplicateWarning' aria-live='polite' aria-relevant='all' tabindex='-1'></div>");$v_0.append(this.$16_2.DivLayout);this.$8_2.setContent($v_0);this.$3H_2();this.$8_2.set_hideFlyOutOnCancelClick(true);this.$8_2.initialize($v_0);this.$8_2.get_options().set_focusOnFirstTabbable(false);this.$8_2.get_jQueryDialog().dialog("option",this.$8_2.get_options().toJQueryDialogOptions());this.$8_2.setButtonsVisibility();this.$57_2();this.$3I_2();$P_CRM("#DuplicateWarning_flyOut").keydown(this.$$d_$3W_2);this.$1o_2("#MatchContact-dupWarnFlyout");this.$1o_2("#MatchAccount-dupWarnFlyout");this.$1H_2=true},$1o_2:function($p0){$P_CRM($p0).bind(Mscrm.StateChangeEvents.commit,this.$$d_$4I_2)},$4I_2:function($p0){var $v_0="#"+$p0.target.parentNode.id,$v_1=$P_CRM($v_0).children(".ms-crm-Inline-Value");if($v_1.hasClass("ms-crm-Inline-EmptyValue"))$v_1.addClass("dupWarnFlyout-EmptyValue");else $v_1.removeClass("dupWarnFlyout-EmptyValue")},$3H_2:function(){var $v_0=new Array(2);$v_0[0]=new Mscrm.FlyOutButton(this.$16_2.ConfirmButtonString,this.$$d_$4n_2);$v_0[1]=new Mscrm.FlyOutButton(this.$16_2.CancelButtonString,this.$$d_$2w_2);this.$8_2.get_options().setButtons($v_0);this.$8_2.get_options().set_isDirty(false)},$57_2:function(){this.$8_2.get_options().set_modal(true);this.$8_2.get_options().set_closeOnEscape(true);this.$8_2.set_position(Mscrm.FlyOutPosition.bottom);this.$8_2.get_options().set_width(350);this.$8_2.get_options().set_minHeight(200);this.$8_2.get_options().set_showTitlePane(false)},$4n_2:function(){if(!this.$1M_2.get_isValid()||!this.$1N_2.get_isValid())return;this.$8_2.hide();this.$4o_2(true)},$3I_2:function(){var $$t_0;this.$1u_2("#MatchContact-dupWarnFlyout",Mscrm.EntityLogicalNames.Contact,$$t_0={val:this.$1N_2}),this.$1N_2=$$t_0.val;var $$t_1;this.$1u_2("#MatchAccount-dupWarnFlyout",Mscrm.EntityLogicalNames.Account,$$t_1={val:this.$1M_2}),this.$1M_2=$$t_1.val;this.$56_2()},$1u_2:function($p0,$p1,$p2){var $v_0=$P_CRM($p0),$v_1="",$v_2="",$v_3="",$v_4=null;switch($p1){case Mscrm.EntityLogicalNames.Contact:$v_2="parentcontactid";$v_3="8623E039-9D66-430E-AC94-38138C3B4E3A";break;case Mscrm.EntityLogicalNames.Account:$v_2="parentaccountid";$v_3="0B31AFD8-A4CC-4911-B08A-51B86B20309F";break;default:break}$v_4=this._formData[$v_2];$v_1=String.format("{0}_i",$p0);if($v_4["_visible"].toString()==="none")$v_4=null;Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_5=Mscrm.InlineControlFactory.getLookupAttributeMetadataJson($v_2,$p1,$v_3,false);$p2.val=Mscrm.InlineControlFactory.createControl($v_0,$v_5,$v_4,Mscrm.InlineEditControlMode.normal);$p2.val.get_dataContext().set_emptyValuePlaceholder(window.LOCID_IEC_CLICKTOSELECT);var $$t_A=this;$v_0.children(".ms-crm-Inline-Value").bind(Mscrm.StateChangeEvents.edit,function($p1_0){$P_CRM($v_1).trigger("click");$p1_0.stopPropagation()});$p2.val.renderForRead();$p2.val.initializeAndRenderEditView()},$56_2:function(){$P_CRM("#MatchContact-dupWarnFlyout_i").attr("isDeDupLookup","1");$P_CRM("#MatchAccount-dupWarnFlyout_i").attr("isDeDupLookup","1");this.$24_2("#MatchContact-dupWarnFlyout_lookupTable");this.$24_2("#MatchAccount-dupWarnFlyout_lookupTable")},$24_2:function($p0){var $v_0=$P_CRM($p0);$v_0.removeAttr("class");$v_0.removeAttr("style");$v_0.attr("class","dupWarnFlyout-table")},$3W_2:function($p0){switch($p0.which){case 27:this.$8_2.hide();break}},$2w_2:function(){this.$8_2.hide();this.$1H_2=false;this.$8_2.dispose()},$4o_2:function($p0){var $v_0=!this.needToShowFlyout(1)?this.$N_2.DefaultStatus:this.$1P_2,$$t_4=this,$$t_5=this;Mscrm.LeadPageHandler.$2H(Number.parseInvariant($v_0),this.$N_2.TransactionCurrencyId,$p0,function($p1_0){$$t_4.$9_2=false;return $$t_4.$2M_2($p1_0)},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);$$t_5.$9_2=false;return true})},$1c_2:function(){if(this.$I_2)return;this.$5_2=new Mscrm.InlineFlyOutDialog;this.$5_2.get_options().set_showButtonPane(false);this.$5_2.get_options().set_modal(true);this.$5_2.get_options().set_closeOnEscape(true);var $$t_3=this;this.$5_2.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_3.$9_2=false});var $$t_4=this;this.$5_2.bind(Mscrm.FlyOutDialogEventName.confirmed,function($p1_0){$$t_4.$9_2=false});var $$t_5=this;this.$5_2.bind(Mscrm.FlyOutDialogEventName.visibleChanged,function($p1_0){$$t_5.$9_2=$$t_5.$5_2.get_visible();if(!$$t_5.$9_2){$$t_5.$V_2.unbind("keydown");$$t_5.$V_2.unbind("mouseover");$$t_5.$5_2.dispose()}});isNullOrEmptyString(this.$D_2)&&this.retrieveFlyoutLayout();if(window.UseTabletExperience){Mscrm.RefreshPageHandler.prototype.initializeDeleteRecordFlyout.call(this);this.$1B_2()}this.$I_2=true},$25_2:function($p0){switch($p0.which){case 13:var $v_0=$P_CRM($p0.target);$v_0.trigger("selectableselected");break;case 9:if($p0.target.tagName==="LI"){$p0.preventDefault();Mscrm.LeadPageHandler.$1A($p0)}break;case 38:case 40:$p0.target.tagName==="LI"&&Mscrm.LeadPageHandler.$1A($p0);break;case 27:this.$5_2.hide();this.$5_2.dispose();this.$9_2=false;break}$p0.stopImmediatePropagation()},$2M_2:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_0)){var $v_1=$v_0.Id;Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Opportunity,$v_1)}Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},disqualify:function(){if(this.isRefreshForm()){setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.StartOpenFlyOut);this.$1c_2();if(this.$9_2){this.$5_2.hide();this.$5_2.dispose();this.$9_2=false;return}if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}if(this.needToShowFlyout(2)){var $v_0=this.getFlyoutLayoutDiv(2);this.$2W_2($v_0,2);this.$5_2.show($P_CRM("#disqualifyLead"),null);var $v_1=$P_CRM(String.format(".li-flyoutlistitem[attributeValue={0}]",this.$f_2.DefaultStatus));$v_1.focus();$v_1.addClass("ui-selected");$v_1.removeClass("ui-selectee");this.$9_2=true}else this.$1y_2(this.$f_2.DefaultStatus);setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.FinishOpenFlyOut)}},$1y_2:function($p0){Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization();var $$t_3=this,$$t_4=this;Mscrm.LeadPageHandler.$47(Number.parseInvariant($p0),function($p1_0){$$t_3.$9_2=false;return $$t_3.$4d_2($p1_0)},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);$$t_4.$9_2=false;return true})},$4d_2:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(Mscrm.InlineEditDataService.get_formEntity()&&isNullOrEmptyString(Mscrm.InlineEditDataService.get_formEntity().get_recordId()))!IsNull($v_0)&&Mscrm.InlineEditDataService.get_formEntity().set_recordId($v_0.Id);!isNullOrEmptyString($v_0.Id)&&Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Lead,$v_0.Id);Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},qualify:function(){if(this.isRefreshForm()){setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.StartOpenFlyOut);Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization();this.$1c_2();if(this.$9_2){this.$5_2.hide();this.$5_2.dispose();this.$9_2=false;return}if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}if(this.needToShowFlyout(1)){var $v_0=this.getFlyoutLayoutDiv(1);this.$2W_2($v_0,1);this.$5_2.show($P_CRM("#qualifyLead"),null);var $v_1=$P_CRM(String.format(".li-flyoutlistitem[attributeValue={0}]",this.$N_2.DefaultStatus));$v_1.focus();$v_1.addClass("ui-selected");$v_1.removeClass("ui-selectee");this.$9_2=true}else this.$2N_2(this.$N_2.DefaultStatus);setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.FinishOpenFlyOut)}},$2N_2:function($p0){var $v_0=false,$v_1="",$$t_6,$$t_7;if(!($$t_7=Mscrm.InlineEditDataService.isValidFormData(null,Mscrm.InlineCommands.LeadQualify,$$t_6={val:$v_1}),$v_1=$$t_6.val,$$t_7))return;if(IsNull(this._formData["parentcontactid"])&&IsNull(this._formData["parentaccountid"]))$v_0=true;var $$t_8=this,$$t_9=this;Mscrm.LeadPageHandler.$2H(Number.parseInvariant($p0),this.$N_2.TransactionCurrencyId,$v_0,function($p1_0){$$t_8.$9_2=false;return $$t_8.$2M_2($p1_0)},function($p1_0){$$t_9.$9_2=false;if(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"ErrorCode").toString()===Mscrm.LeadPageHandler.$1z.toString()){$$t_9.$3X_2();$$t_9.$8_2.show($P_CRM("#qualifyLead"),null);var $v_2=$P_CRM("#DuplicateWarning-confirm");$v_2.focus();return true}Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);return true})},deleteRecord:function(){if(this.isRefreshForm())if(window.UseTabletExperience){this.$1c_2();if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}else{this._deleteFlyout.show($P_CRM("#deleteButton"));this._deleteFlyoutVisible=true}if(this.$9_2){this.$5_2.hide();this.$9_2=false}}else Mscrm.RefreshPageHandler.prototype.deleteRecord.call(this)},postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$1h_2()},$1h_2:function(){var $v_0=Xrm.Page.data.entity.attributes.get("parentcontactid");if(!IsNull($v_0)){var $$t_2=this;Mscrm.LeadPageHandler.$w=function($p1_0){$$t_2.$4a_2()};$v_0.addOnChange(Mscrm.LeadPageHandler.$w)}},postPageRender:function(){this.isRefreshForm()&&Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(this.$$d_$2L_2);Mscrm.RefreshPageHandler.prototype.postPageRender.call(this)},close:function(){if(!Mscrm.InlineEditDataService.get_dataService().get_isDisposed()){Mscrm.InlineEditDataService.get_dataService().remove_formRefreshed(this.$$d_$2L_2);var $v_0=Xrm.Page.data.entity.attributes.get("parentcontactid");!IsNull($v_0)&&!IsNull(Mscrm.LeadPageHandler.$w)&&$v_0.removeOnChange(Mscrm.LeadPageHandler.$w)}Mscrm.RefreshPageHandler.prototype.close.call(this)},$2L_2:function($p0,$p1){this.$4s_2()},activate:function(){if(this.isRefreshForm()){Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization();var $$t_3=this,$$t_4=this;Mscrm.InlineEditDataService.activate("Open",function($p1_0){if(!IsNull($$t_3._formData["leadid"])){var $v_0=$$t_3._formData["leadid"];Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Lead,$v_0["value"]);Mscrm.InlineEditDataService.refreshGridOnStateChange()}return true},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);$$t_4.$9_2=false;return true})}},$4a_2:function(){this.$1K_2=true},$4s_2:function(){var $v_0=$find("Stakeholders");if(!IsNull($v_0)&&this.$1K_2){this.$1K_2=false;$v_0.Refresh()}},$2W_2:function($p0,$p1){var $v_0=$P_CRM(String.format("<div id='{0}' ></div>","leadAction")),$v_1=$P_CRM("<ol style='margin:1px;padding:0px;' class='ui-selectable selectedstateconvertlead' id='selectedstateconvertlead'></ol>");$v_1.append($p0);$v_0.append($v_1);this.$5_2.setContent($v_0);this.$V_2=$P_CRM("#selectedstateconvertlead");this.$V_2.keydown(this.$$d_$25_2);this.$V_2.mouseover(Mscrm.LeadPageHandler.$2F);this.$V_2.selectable();var $$t_4=this;this.$V_2.bind("selectableselected",function(){if($p1===1)$$t_4.$2N_2($$t_4.$2C_2());else $p1===2&&$$t_4.$1y_2($$t_4.$2C_2());$$t_4.$5_2.hide();$$t_4.$V_2.unbind("selectableselected")});this.$5_2.set_position(Mscrm.FlyOutPosition.bottom);this.$5_2.get_options().set_width(200);this.$5_2.get_options().set_minHeight(10);this.$5_2.get_options().set_showTitlePane(false);($p1===2?this.$f_2.StatusCount:this.$N_2.StatusCount)>11&&this.$5_2.get_options().set_height(272)},$2C_2:function(){var $v_0=$P_CRM(".ui-selected");this.$1P_2=$v_0.attr("attributeValue");return this.$1P_2},getFlyoutLayoutDiv:function($p0){var $v_0="";switch($p0){case 1:$v_0=this.$N_2.DivLayout;break;case 2:$v_0=this.$f_2.DivLayout;break}return $v_0},processFlyoutLayout:function(){this.$D_2=Mscrm.JsonUtilities.getJsonString(this._flyoutLayoutRequest.responseText);var $v_0,$$t_6,$$t_7;$$t_7=Mscrm.JsonUtilities.tryGetParsedJson(this.$D_2,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7;for(var $v_1=$v_0,$$arr_2=$v_1,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_2=$$arr_2[$$idx_4];if($v_2.LeadActionName==="Qualified")this.$N_2=$v_2;if($v_2.LeadActionName==="Disqualified")this.$f_2=$v_2;if($v_2.LeadActionName==="DupWarnFlyout")this.$16_2=$v_2;if($v_2.LeadActionName==="Delete")this.$S_2=$v_2}},needToShowFlyout:function($p0){switch($p0){case 1:return this.$N_2.StatusCount>1;case 2:return this.$f_2.StatusCount>1;default:return false}},launchProcessControlConfiguration:function(){},$1B_2:function(){var $v_0=this.$S_2.DivLayout;Mscrm.RefreshPageHandler.prototype.setDeleteFlyoutDialog.call(this,$v_0)}};Mscrm.ProductPageHandler=function(){};Mscrm.ProductPageHandler.convert=function(toKit){var $v_0=Mscrm.ProductPageHandler.$1p();Mscrm.ProductPageHandler.$21(toKit?Mscrm.InlineCommands.ProductConvertToKit:Mscrm.InlineCommands.ProductConvertFromKit,$v_0,Mscrm.ProductPageHandler.$10,Mscrm.ProductPageHandler.$l)};Mscrm.ProductPageHandler.$21=function($p0,$p1,$p2,$p3){Mscrm.InlineEditDataService.get_dataService().set_succeedCallback($p2);Mscrm.InlineEditDataService.get_dataService().set_errorCallback($p3);Mscrm.InlineEditDataService.execute($p0,$p1)};Mscrm.ProductPageHandler.$10=function($p0){return Mscrm.ProductPageHandler.$4v($p0)};Mscrm.ProductPageHandler.$l=function($p0){if(!IsNull($p0["_error"])){var $v_0=$p0["_error"];alert($v_0.DisplayText);return true}return false};Mscrm.ProductPageHandler.$4v=function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(IsNull($v_0))return false;Mscrm.ReadFormUtilities.forceReload(Mscrm.EntityTypeCode.Product,$v_0.Id,Mscrm.InlineEditDataService.get_formId());return true};Mscrm.ProductPageHandler.$1p=function(){var $v_0=String.format("<Input><id>{0}</id><name>{1}</name></Input>",CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formEntity().get_typeName()));return $v_0};Mscrm.OpportunityPageHandler=function(){this.$$d_$3c_2=Function.createDelegate(this,this.$3c_2);this.$$d_$20_2=Function.createDelegate(this,this.$20_2);Mscrm.OpportunityPageHandler.initializeBase(this)};Mscrm.OpportunityPageHandler.$4W=function($p0,$p1){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p0,$p1);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityReopen,$v_1)}};Mscrm.OpportunityPageHandler.$4T=function($p0,$p1){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p0,$p1);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityAddRelatedQuote,$v_1)}};Mscrm.OpportunityPageHandler.$4S=function($p0,$p1){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p0,$p1);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityAddRelatedOrder,$v_1)}};Mscrm.OpportunityPageHandler.$4R=function($p0,$p1){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p0,$p1);var $v_1=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityAddRelatedInvoice,$v_1)}};Mscrm.OpportunityPageHandler.$4V=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){Mscrm.MetricsReporting.instance().addMetric("Opportunity Close As Won","RO Form");var $v_0=Mscrm.InlineEditDataService.get_formEntity(),$v_1="",$$t_B,$$t_C;if(!($$t_C=Mscrm.InlineEditDataService.isValidFormData($p6,Mscrm.InlineCommands.OpportunityCloseAsWon,$$t_B={val:$v_1}),$v_1=$$t_B.val,$$t_C))return;var $v_2="<opportunityclose>\r\n\t\t\t\t\t\t\t\t\t\t<actualrevenue>{0}</actualrevenue>\r\n\t\t\t\t\t\t\t\t\t\t<activityid>{1}</activityid>\r\n\t\t\t\t\t\t\t\t\t\t<opportunityid>{2}</opportunityid>\r\n\t\t\t\t\t\t\t\t\t\t<description>{3}</description>\r\n\t\t\t\t\t\t\t\t\t\t<actualend>{4}</actualend>\r\n\t\t\t\t\t\t\t\t\t\t<subject>{5}</subject>\r\n\t\t\t\t\t\t\t\t\t</opportunityclose>";$v_2=String.format($v_2,CrmEncodeDecode.CrmXmlEncode($p1),CrmEncodeDecode.CrmXmlEncode(Mscrm.Utilities.createGuid()),CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($p2),CrmEncodeDecode.CrmXmlEncode($p3),CrmEncodeDecode.CrmXmlEncode($p0));if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p5,$p6);var $v_3=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dataxml>{3}</dataxml>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<opportunitydisplayname>{4}</opportunitydisplayname>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<opportunityclosexml>{5}</opportunityclosexml>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<newStateCode>1</newStateCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<newStatusCode>{6}</newStatusCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode($p4));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityCloseAsWon,$v_3)}};Mscrm.OpportunityPageHandler.$4U=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){Mscrm.MetricsReporting.instance().addMetric("Opportunity Close As Lost","RO Form");var $v_0=Mscrm.InlineEditDataService.get_formEntity(),$v_1="<opportunityclose>\r\n\t\t\t\t\t\t\t\t\t\t<actualrevenue>{0}</actualrevenue>\r\n\t\t\t\t\t\t\t\t\t\t<activityid>{1}</activityid>\r\n\t\t\t\t\t\t\t\t\t\t<opportunityid>{2}</opportunityid>\r\n\t\t\t\t\t\t\t\t\t\t<description>{3}</description>\r\n\t\t\t\t\t\t\t\t\t\t<actualend>{4}</actualend>\r\n\t\t\t\t\t\t\t\t\t\t<subject>{5}</subject>\r\n\t\t\t\t\t\t\t\t\t\t<competitorid>{6}</competitorid>\r\n\t\t\t\t\t\t\t\t\t</opportunityclose>";$v_1=String.format($v_1,CrmEncodeDecode.CrmXmlEncode($p1),CrmEncodeDecode.CrmXmlEncode(Mscrm.Utilities.createGuid()),CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($p2),CrmEncodeDecode.CrmXmlEncode($p3),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($p5));var $v_2="",$$t_C,$$t_D;if(!($$t_D=Mscrm.InlineEditDataService.isValidFormData($p7,Mscrm.InlineCommands.OpportunityCloseAsLost,$$t_C={val:$v_2}),$v_2=$$t_C.val,$$t_D))return;if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.get_recordId())){Mscrm.InlineEditDataService.setCallback($p6,$p7);var $v_3=String.format("<Input>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<id>{0}</id>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<name>{1}</name>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<formId>{2}</formId>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<dataxml>{3}</dataxml>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<opportunitydisplayname>{4}</opportunitydisplayname>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<opportunityclosexml>{5}</opportunityclosexml>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<newStateCode>2</newStateCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<newStatusCode>{6}</newStatusCode>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Input>",CrmEncodeDecode.CrmXmlEncode($v_0.get_recordId()),CrmEncodeDecode.CrmXmlEncode($v_0.get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode($p0),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($p4));Mscrm.InlineEditDataService.execute(Mscrm.InlineCommands.OpportunityCloseAsLost,$v_3)}};Mscrm.OpportunityPageHandler.prototype={$A_2:false,$C_2:false,$4_2:null,$3_2:null,$I_2:false,$i_2:null,$G_2:null,$O_2:null,$b_2:null,$h_2:null,$F_2:null,$M_2:null,$g_2:null,$a_2:null,$B_2:null,$L_2:null,$S_2:null,$D_2:null,closeAsLost:function(){if(this.isRefreshForm()){Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization();var $v_0=new Mscrm.Performance.PerformanceStopwatch("CloseAsLost");$v_0.start();this.$y_2();if(this.$A_2){this.$4_2.hide();this.$A_2=false}if(this.$C_2){this.$3_2.hide();this.$C_2=false}else{this.$2c_2();this.$2b_2();this.$3_2.show($P_CRM("#closeAsLost"));this.$1X_2(2);this.$a_2.resetLayout();!this.$3_2.get_jQueryDialog().hasClass("ui-flyout-dialog-opportunity-content")&&this.$3_2.get_jQueryDialog().addClass("ui-flyout-dialog-opportunity-content");this.$C_2=true;if(this.$L_2&&this.$L_2.ValidStatusReasonOptions.length===1){var $v_1=$P_CRM("#"+this.$F_2.get_editView().get_editElementId());$v_1.select()}this.$2a_2();$v_0.stop()}if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}}},closeAsWon:function(){if(this.isRefreshForm()){Mscrm.DeferredInlineEditOnDemandInitializer.get_instance().completeDeferredInitialization();var $v_0=new Mscrm.Performance.PerformanceStopwatch("CloseAsWon");$v_0.start();this.$y_2();if(this.$C_2){this.$3_2.hide();this.$C_2=false}if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}if(this.$A_2){this.$4_2.hide();this.$A_2=false}else{this.$2c_2();this.$2b_2();this.$1X_2(1);this.$4_2.show($P_CRM("#closeAsWon"));this.$b_2.resetLayout();!this.$4_2.get_jQueryDialog().hasClass("ui-flyout-dialog-opportunity-content")&&this.$4_2.get_jQueryDialog().addClass("ui-flyout-dialog-opportunity-content");this.$A_2=true;if(this.$B_2&&this.$B_2.ValidStatusReasonOptions.length===1){var $v_1=$P_CRM("#"+this.$G_2.get_editView().get_editElementId());$v_1.select()}this.$2a_2();$v_0.stop()}}},deleteRecord:function(){if(this.isRefreshForm())if(window.UseTabletExperience){this.$y_2();if(this.$C_2){this.$3_2.hide();this.$C_2=false}if(this.$A_2){this.$4_2.hide();this.$A_2=false}if(this._deleteFlyoutVisible){this._deleteFlyout.hide();this._deleteFlyoutVisible=false}else{this._deleteFlyout.show($P_CRM("#deleteButton"));this._deleteFlyoutVisible=true}}else Mscrm.RefreshPageHandler.prototype.deleteRecord.call(this)},reOpen:function(){if(this.isRefreshForm()){var $$t_4=this,$$t_5=this;Mscrm.OpportunityPageHandler.$4W(function($p1_0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_1=$v_0.Id;Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Opportunity,$v_1);Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);return true})}},$1g_2:function($p0){var $v_0=$find($p0);!IsNull($v_0)&&$v_0.Refresh()},addRelatedQuote:function(){if(this.isRefreshForm()){var $$t_4=this,$$t_5=this;Mscrm.OpportunityPageHandler.$4T(function($p1_0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_1=$v_0.Id;openItem(Mscrm.EntityTypeCode.Quote,$v_1,Mscrm.NavigationMode.NavigationModeNewWindow,null);Mscrm.InlineEditDataService.refreshGridOnStateChange();$$t_4.$1g_2("quote");return true},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);return true})}},addRelatedOrder:function(){if(this.isRefreshForm()){var $$t_4=this,$$t_5=this;Mscrm.OpportunityPageHandler.$4S(function($p1_0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_1=$v_0.Id;openItem(Mscrm.EntityTypeCode.SalesOrder,$v_1,Mscrm.NavigationMode.NavigationModeNewWindow,null);Mscrm.InlineEditDataService.refreshGridOnStateChange();$$t_4.$1g_2("Order");return true},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);return true})}},addRelatedInvoice:function(){if(this.isRefreshForm()){var $$t_4=this,$$t_5=this;Mscrm.OpportunityPageHandler.$4R(function($p1_0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_1=$v_0.Id;openItem(Mscrm.EntityTypeCode.Invoice,$v_1,Mscrm.NavigationMode.NavigationModeNewWindow,null);Mscrm.InlineEditDataService.refreshGridOnStateChange();$$t_4.$1g_2("Invoice");return true},function($p1_0){Mscrm.ErrorStatusControl.showError(Mscrm.JsonUtilities.getAttributeFromErrorJson($p1_0,"DisplayText"),true);return true})}},launchProcessControlConfiguration:function(){},$2a_2:function(){var $v_0="",$v_1=null;if(this.$A_2){$v_1=$P_CRM("#closeAsWon-confirm");$v_0=this.$G_2.get_dataContext().get_editValue()}else if(this.$C_2){$v_1=$P_CRM("#closeAsLost-confirm");$v_0=this.$F_2.get_dataContext().get_editValue()}if(!IsNull($v_1))if(isNullOrEmptyString($v_0))this.$11_2($v_1,false,window.LOCID_REVENUECANNOTBENULL);else this.$11_2($v_1,true,"")},$y_2:function(){if(this.$I_2)return;this.$I_2=true;isNullOrEmptyString(this.$D_2)&&this.retrieveFlyoutLayout();this.$4_2=new Mscrm.InlineFlyOutDialog;this.$4_2.set_hideFlyOutOnConfirmClick(false);var $$t_8=this;this.$4_2.bind(Mscrm.FlyOutDialogEventName.overlayClicked,function($p1_0){$$t_8.$A_2=false;$$t_8.$j_2($$t_8.$4_2);$$t_8.$X_2(1);$$t_8.$4_2.hide()});var $$t_9=this;this.$4_2.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_9.$A_2=false;$$t_9.$j_2($$t_9.$4_2);$$t_9.$X_2(1)});var $$t_A=this;this.$4_2.bind(Mscrm.FlyOutDialogEventName.confirmed,function($p1_0){if($$t_A.$1q_2(1)){$$t_A.$A_2=false;$$t_A.$4_2.hide()}});var $$t_B=this;this.$4_2.bind(Mscrm.FlyOutDialogEventName.visibleChanged,function($p1_0){$$t_B.$A_2=$$t_B.$4_2.get_visible();!$$t_B.$A_2&&$$t_B.$j_2($$t_B.$4_2)});this.$54_2();this.$3_2=new Mscrm.InlineFlyOutDialog;this.$3_2.set_hideFlyOutOnConfirmClick(false);var $$t_C=this;this.$3_2.bind(Mscrm.FlyOutDialogEventName.overlayClicked,function($p1_0){$$t_C.$C_2=false;$$t_C.$j_2($$t_C.$3_2);$$t_C.$X_2(2);$$t_C.$3_2.hide()});var $$t_D=this;this.$3_2.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_D.$C_2=false;$$t_D.$j_2($$t_D.$3_2);$$t_D.$X_2(2)});var $$t_E=this;this.$3_2.bind(Mscrm.FlyOutDialogEventName.confirmed,function($p1_0){if($$t_E.$1q_2(2)){$$t_E.$C_2=false;$$t_E.$3_2.hide()}});var $$t_F=this;this.$3_2.bind(Mscrm.FlyOutDialogEventName.visibleChanged,function($p1_0){$$t_F.$C_2=$$t_F.$3_2.get_visible();!$$t_F.$C_2&&$$t_F.$j_2($$t_F.$3_2)});this.$53_2();if(window.UseTabletExperience){Mscrm.RefreshPageHandler.prototype.initializeDeleteRecordFlyout.call(this);this.$1B_2()}this.$2h_2()},$3j_2:function($p0){if($p0===this.$3_2)return [this.$F_2,this.$g_2,this.$a_2,this.$M_2];if($p0===this.$4_2)return [this.$b_2,this.$G_2,this.$O_2];return null},$j_2:function($p0){for(var $$arr_1=this.$3j_2($p0),$$len_2=$$arr_1.length,$$idx_3=0;$$idx_3<$$len_2;++$$idx_3){var $v_0=$$arr_1[$$idx_3];$v_0.get_dataContext().set_editValue("");$v_0.blur();if($v_0.get_isValid());}},processFlyoutLayout:function(){this.$D_2=Mscrm.JsonUtilities.getJsonString(this._flyoutLayoutRequest.responseText);var $v_0=null,$$t_6,$$t_7;$$t_7=Mscrm.JsonUtilities.tryGetParsedJson(this.$D_2,$$t_6={val:$v_0}),$v_0=$$t_6.val,$$t_7;for(var $v_1=$v_0,$$arr_2=$v_1,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_2=$$arr_2[$$idx_4];if($v_2.OpportunityActionName==="Lost")this.$L_2=$v_2;if($v_2.OpportunityActionName==="Won")this.$B_2=$v_2;if($v_2.OpportunityActionName==="Delete")this.$S_2=$v_2}},$1q_2:function($p0){var $v_0="",$v_1="",$v_2="",$v_3="",$v_4="";if(this.$1X_2($p0)){var $$t_6,$$t_7,$$t_8,$$t_9,$$t_A;this.$3b_2($p0,$$t_6={val:$v_4},$$t_7={val:$v_0},$$t_8={val:$v_1},$$t_9={val:$v_2},$$t_A={val:$v_3}),$v_4=$$t_6.val,$v_0=$$t_7.val,$v_1=$$t_8.val,$v_2=$$t_9.val,$v_3=$$t_A.val;if(!isNullOrEmptyString($v_3))this.$35_2($p0,$v_4,$v_2,$v_0,$v_1,$v_3);else return false}else return false;return true},$35_2:function($p0,$p1,$p2,$p3,$p4,$p5){if($p0===2){var $v_0="",$v_1=$P_CRM("#_lost_competitor_lookupTable"),$v_2=$v_1.find("#lookupItem");$v_0=$v_2.attr("oid");var $$t_H=this,$$t_I=this;Mscrm.OpportunityPageHandler.$4U($p2,$p5,$p4,$p3,$p1,$v_0,function($p1_0){if(!IsNull($p1_0)){var $v_3=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_4=$v_3.Id;$$t_H.$2S_2();Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Opportunity,$v_4);Mscrm.InlineEditDataService.refreshGridOnStateChange();return true}return false},function($p1_0){$$t_I.$A_2=false;return false})}else{var $$t_J=this,$$t_K=this;Mscrm.OpportunityPageHandler.$4V($p2,$p5,$p4,$p3,$p1,function($p1_0){var $v_5=Mscrm.InlineEditUtilities.getEntityReference($p1_0),$v_6=$v_5.Id;$$t_J.$2S_2();Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.EntityTypeCode.Opportunity,$v_6);Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},function($p1_0){$$t_K.$A_2=false;return false})}},$3b_2:function($p0,$p1,$p2,$p3,$p4,$p5){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();$p5.val="";$p2.val="";$p1.val="";if($p0===1&&this.$B_2.ValidStatusReasonOptions.length===1)$p1.val=this.$B_2.ValidStatusReasonOptions[0].Value.toString();else if($p0===2&&this.$L_2.ValidStatusReasonOptions.length===1)$p1.val=this.$L_2.ValidStatusReasonOptions[0].Value.toString();if(1===$p0){if(!isNullOrEmptyString(this.$G_2.get_dataContext().get_editValue().trim()))$p5.val=Mscrm.NumberUtility.locStringToFloat(this.$G_2.get_dataContext().get_editValue()).toString();if(!isNullOrEmptyString(this.$O_2.get_dataContext().get_editValue().trim()))$p2.val=FormatUtcDate(Mscrm.DateTimeUtility.parseDate(this.$O_2.get_dataContext().get_editValue()));$p3.val=this.$b_2.get_dataContext().get_editValue();if(isNullOrEmptyString($p1.val))$p1.val=this.$i_2.get_dataContext().get_editValue()}else{if(!isNullOrEmptyString(this.$F_2.get_dataContext().get_editValue().trim()))$p5.val=Mscrm.NumberUtility.locStringToFloat(this.$F_2.get_dataContext().get_editValue()).toString();if(!isNullOrEmptyString(this.$M_2.get_dataContext().get_editValue().trim()))$p2.val=FormatUtcDate(Mscrm.DateTimeUtility.parseDate(this.$M_2.get_dataContext().get_editValue()));$p3.val=this.$a_2.get_dataContext().get_editValue();if(isNullOrEmptyString($p1.val))$p1.val=this.$h_2.get_dataContext().get_editValue()}$p4.val=this.$27_2(5)},$2c_2:function(){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_0=this.$27_2(1),$v_1="";if(!isNullOrEmptyString($v_0)){var $v_3=this.$1b_2(this.$B_2.RevenuePrecision);$v_1=Mscrm.NumberUtility.addFormatting(Number.parseInvariant($v_0.toString()),$v_3)}this.$G_2.get_dataContext().set_editValue($v_1);var $v_2=Mscrm.DateTimeUtility.today();this.$O_2.get_dataContext().set_editValue(Mscrm.DateTimeUtility.formatDate($v_2));this.$F_2.get_dataContext().set_editValue($v_1);this.$M_2.get_dataContext().set_editValue(Mscrm.DateTimeUtility.formatDate($v_2))},$1b_2:function($p0){Mscrm.InlineEditInitializerUtility.initializeEditViewsForAttributeIds(["estimatedvalue"]);var $v_0=$P_CRM("#header_estimatedvalue_i");if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.attr("acc")))return parseInt($v_0.attr("acc"));$v_0=$P_CRM("#estimatedvalue_i");if(!IsNull($v_0)&&!isNullOrEmptyString($v_0.attr("acc")))return parseInt($v_0.attr("acc"));return $p0},$1X_2:function($p0){if($p0===1)return this.$G_2.get_isValid()&&this.$O_2.get_isValid()&&this.$b_2.get_isValid()&&!isNullOrEmptyString(this.$G_2.get_dataContext().get_editValue().trim())&&!isNullOrEmptyString(this.$O_2.get_dataContext().get_editValue().trim());else{this.$g_2.blur();return this.$F_2.get_isValid()&&this.$M_2.get_isValid()&&this.$g_2.get_isValid()&&this.$a_2.get_isValid()&&!isNullOrEmptyString(this.$F_2.get_dataContext().get_editValue().trim())&&!isNullOrEmptyString(this.$M_2.get_dataContext().get_editValue().trim())}},$2b_2:function(){var $v_0=$P_CRM("#won-revenue");$v_0=$v_0.find(".ms-crm-CurrencySymbol-Refresh");$v_0.children().first().text(this.$19_2());var $v_1=$P_CRM("#lost-revenue");$v_1=$v_1.find(".ms-crm-CurrencySymbol-Refresh");$v_1.children().first().text(this.$19_2())},$27_2:function($p0){var $v_0="";switch($p0){case 1:$v_0="estimatedvalue";break;case 5:$v_0="name";break;default:return ""}if($v_0.length>0){Mscrm.InlineEditInitializerUtility.initializeEditViewsForAttributeIds([$v_0]);if(!IsNull(Mscrm.InlineEditDataService.get_formEntity().get_attributes().get($v_0))&&!IsNull(Mscrm.InlineEditDataService.get_formEntity().get_attributes().get($v_0).get_value()))return Mscrm.InlineEditDataService.get_formEntity().get_attributes().get($v_0).get_value()}return ""},$26_2:function($p0){var $v_0=this.$3d_2($p0),$v_1,$v_2=null;if($p0===1){$v_2=this.$B_2.ValidStatusReasonOptions;$v_1="closeAsWon_flyOut"}else{$v_2=this.$L_2.ValidStatusReasonOptions;$v_1="closeAsLost_flyOut"}var $v_3=new Array(5);$v_3[0]=String.format("#{0}-reason",$v_0);$v_3[1]=String.format("#{0}-closedate",$v_0);$v_3[2]=String.format("#{0}-revenue",$v_0);$v_3[3]=String.format("#{0}-competitor",$v_0);$v_3[4]=String.format("#{0}-description",$v_0);var $v_4=$P_CRM($v_3[0]).children().first();if($v_2.length===1){$v_4.addClass("won-lost-statusreason-label");$v_4.text($v_2[0].Label);$v_4.attr("defaultvalue",$v_2[0].Value.toString())}else{$v_4.addClass("won-lost-inline-edit-control");if($p0===1)this.$i_2=Mscrm.InlineControlFactory.createInlinePicklistControlForDom($v_4,"_"+$v_3[0],$v_2,$v_1);else this.$h_2=Mscrm.InlineControlFactory.createInlinePicklistControlForDom($v_4,"_"+$v_3[0],$v_2,$v_1)}var $v_5=$P_CRM($v_3[1]).children().first();if(this.$1D_2($v_5))if($p0===1)this.$O_2=Mscrm.InlineControlFactory.createInlineDateTimeControlForDom($v_5,"_"+$v_3[1],Mscrm.AttributeFormat.date,null,$v_1);else this.$M_2=Mscrm.InlineControlFactory.createInlineDateTimeControlForDom($v_5,"_"+$v_3[1],Mscrm.AttributeFormat.date,null,$v_1);var $v_6=$P_CRM($v_3[2]).children().first();if(this.$1D_2($v_6)){var $v_9;if($p0===1){$v_9=this.$1b_2(this.$B_2.RevenuePrecision);this.$G_2=Mscrm.InlineControlFactory.createInlineMoneyControlForDom($v_6,"_"+$v_3[2],this.$B_2.MinRevenueValue,this.$B_2.MaxRevenueValue,$v_9,this.$19_2(),$v_1,Mscrm.AttributeRequiredLevel.required,$P_CRM("#won-revenue-label").text())}else{$v_9=this.$1b_2(this.$L_2.RevenuePrecision);this.$F_2=Mscrm.InlineControlFactory.createInlineMoneyControlForDom($v_6,"_"+$v_3[2],this.$B_2.MinRevenueValue,this.$B_2.MaxRevenueValue,$v_9,this.$19_2(),$v_1,Mscrm.AttributeRequiredLevel.required,$P_CRM("#lost-revenue-label").text())}}var $v_7=$P_CRM($v_3[3]).children().first();if(this.$1D_2($v_7))this.$g_2=Mscrm.InlineControlFactory.createInlineLookupControlForDomWithDisableState($v_7,"_"+$v_3[3],Mscrm.EntityLogicalNames.Competitor,"50299B9B-1092-451C-A19D-CCCF16AE2EA8",!this.$L_2.HasPermissionsToAssignCompetitor,$v_1);var $v_8=$P_CRM($v_3[4]).children().first();if(this.$1D_2($v_8))if($p0===1)this.$b_2=Mscrm.InlineControlFactory.createInlineTextAreaControlForDom($v_8,"_"+$v_3[4],this.$B_2.MaxDescriptionLength,$v_1);else this.$a_2=Mscrm.InlineControlFactory.createInlineTextAreaControlForDom($v_8,"_"+$v_3[4],this.$B_2.MaxDescriptionLength,$v_1);this.$5L_2($v_0)},$2h_2:function(){!IsNull(this.$i_2)&&this.$P_2(this.$i_2.get_editView().get_editElementId());this.$P_2(this.$G_2.get_editView().get_editElementId());this.$P_2(this.$O_2.get_editView().get_editElementId());this.$P_2(this.$b_2.get_editView().get_editElementId());!IsNull(this.$h_2)&&this.$P_2(this.$h_2.get_editView().get_editElementId());this.$P_2(this.$F_2.get_editView().get_editElementId());this.$P_2(this.$M_2.get_editView().get_editElementId());this.$P_2(this.$g_2.get_editView().get_editElementId());this.$P_2(this.$a_2.get_editView().get_editElementId())},$P_2:function($p0){var $v_0=$P_CRM("#"+$p0);$v_0.parents(".ms-crm-Inline-Edit").first().bind("state-validated",this.$$d_$20_2);$v_0.parents(".ms-crm-Inline-Edit").first().keydown(this.$$d_$3c_2)},$2S_2:function(){!IsNull(this.$i_2)&&this.$Q_2(this.$i_2.get_editView().get_editElementId());this.$Q_2(this.$G_2.get_editView().get_editElementId());this.$Q_2(this.$O_2.get_editView().get_editElementId());this.$Q_2(this.$b_2.get_editView().get_editElementId());!IsNull(this.$h_2)&&this.$Q_2(this.$h_2.get_editView().get_editElementId());this.$Q_2(this.$F_2.get_editView().get_editElementId());this.$Q_2(this.$M_2.get_editView().get_editElementId());this.$Q_2(this.$g_2.get_editView().get_editElementId());this.$Q_2(this.$a_2.get_editView().get_editElementId())},$Q_2:function($p0){var $v_0=$P_CRM("#"+$p0);$v_0.parents(".ms-crm-Inline-Edit").first().unbind("state-validated",this.$$d_$20_2)},$20_2:function($p0){var $v_0=arguments[1],$v_1=null,$v_2="";if(this.$A_2){$v_1=$P_CRM("#closeAsWon-confirm");$v_2=this.$G_2.get_dataContext().get_editValue()}else if(this.$C_2){$v_1=$P_CRM("#closeAsLost-confirm");$v_2=this.$F_2.get_dataContext().get_editValue()}if(!IsNull($v_1)&&isNullOrEmptyString($v_2))this.$11_2($v_1,false,window.LOCID_REVENUECANNOTBENULL);else if(!IsNull($v_1)&&!IsNull($v_0)&&!$v_0.isValid)this.$11_2($v_1,false,$v_0.errorText);else!IsNull($v_1)&&!IsNull($v_0)&&$v_0.isValid&&!isNullOrEmptyString($v_2)&&this.$11_2($v_1,true,"")},$11_2:function($p0,$p1,$p2){if($p1){$p0.removeAttr("disabled");$p0.removeAttr("title")}else{$p0.attr("disabled","disabled");$p0.attr("title",$p2)}},$5L_2:function($p0){var $v_0=String.format("#_{0}_description_i",$p0),$v_1=$P_CRM($v_0);$v_1&&$v_1.height("100px")},$19_2:function(){var $v_0=$P_CRM(".ms-crm-CurrencySymbol-Refresh");if($v_0&&$v_0.length>0)return XUI.Html.GetText($v_0[0]);else return this.$B_2.BaseCurrencySymbol},$1D_2:function($p0){if(!IsNull($p0)&&$p0.length>0)return true;else return false},$3d_2:function($p0){if($p0===1)return "won";else return "lost"},$54_2:function(){var $v_0=this.$2A_2(1),$v_1=$P_CRM(String.format("<div id='{0}' ></div>","closeAsWon"));$v_1.append($v_0);this.$4_2.setContent($v_1);this.$4_2.set_position(Mscrm.FlyOutPosition.bottom);this.$4_2.get_options().set_height(434);this.$4_2.get_options().set_width(332);this.$4_2.get_options().set_modal(true);this.$4_2.get_options().set_letjQueryHandleTabbing(true);$P_CRM("#closeAsWon_flyOut").keydown(this.$$d_$3c_2);this.$4_2.get_options().set_showTitlePane(false);this.$26_2(1)},$3c_2:function($p0){switch($p0.which){case 27:if(this.$A_2){this.$4_2.hide();this.$A_2=false;this.$X_2(1);$p0.stopImmediatePropagation()}if(this.$C_2){this.$3_2.hide();this.$C_2=false;this.$X_2(2);$p0.stopImmediatePropagation()}$p0.stopImmediatePropagation();break;case 13:if(document.activeElement.id==="closeAsWon-cancel"){this.closeAsWon();this.$X_2(1);$p0.stopImmediatePropagation()}if(document.activeElement.id==="closeAsLost-cancel"){this.closeAsLost();this.$X_2(2);$p0.stopImmediatePropagation()}$p0.stopImmediatePropagation();break;case 127:case 46:case 8:this.$20_2($p0);$p0.stopImmediatePropagation();break}},$X_2:function($p0){var $v_0=null;if($p0===1)$v_0=$P_CRM("#closeAsWon");else $v_0=$P_CRM("#closeAsLost");if(Mscrm.Utilities.isIE())$v_0.focus();else $v_0.find("a").focus()},$53_2:function(){var $v_0=this.$2A_2(2),$v_1=$P_CRM(String.format("<div id='{0}' ></div>","closeAsLost"));$v_1.keydown(this.$$d_$3c_2);$v_1.append($v_0);this.$3_2.setContent($v_1);this.$3_2.set_position(Mscrm.FlyOutPosition.bottom);this.$3_2.get_options().set_height(436);this.$3_2.get_options().set_width(332);this.$3_2.get_options().set_modal(true);this.$3_2.get_options().set_letjQueryHandleTabbing(true);$P_CRM("#closeAsLost_flyOut").keydown(this.$$d_$3c_2);this.$3_2.get_options().set_showTitlePane(false);this.$26_2(2)},$2A_2:function($p0){switch($p0){case 2:return this.$L_2.DivLayout;case 1:return this.$B_2.DivLayout}return ""},$1B_2:function(){var $v_0=this.$S_2.DivLayout;Mscrm.RefreshPageHandler.prototype.setDeleteFlyoutDialog.call(this,$v_0)}};Mscrm.OpportunityPageHandler.OpportunityCommandBarAction=function(){};Mscrm.OpportunityPageHandler.OpportunityCommandBarAction.prototype={none:0,won:1,lost:2};Mscrm.OpportunityPageHandler.OpportunityCommandBarAction.registerEnum("Mscrm.OpportunityPageHandler.OpportunityCommandBarAction",false);Mscrm.CampaignActivityPageHandler=function(){Mscrm.CampaignActivityPageHandler.initializeBase(this)};Mscrm.CampaignActivityPageHandler.prototype={postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$59_2();this.$3U_2();this.$3T_2()},$3T_2:function(){if(window.IsCampaignActivityTemplate)for(var $v_0=["scheduledstart","scheduledend","actualstart","actualend","ownerid"],$$arr_1=$v_0,$$len_2=$$arr_1.length,$$idx_3=0;$$idx_3<$$len_2;++$$idx_3){var $v_1=$$arr_1[$$idx_3],$v_2=Xrm.Page.ui.controls.get($v_1),$v_3=Xrm.Page.data.entity.attributes.get($v_1);if(!IsNull($v_2)){$v_2.setDisabled(true);$v_3.setValue(null)}}},$3U_2:function(){this.$1x_2("actualstart");this.$1x_2("actualend");var $v_0=Xrm.Page.data.entity.attributes.get("statuscode");if(!IsNull($v_0)){var $v_1=$v_0.getValue();if(!IsNull($v_1)&&$v_1!==1){var $v_2=Xrm.Page.ui.controls.get("channeltypecode");!IsNull($v_2)&&$v_2.setDisabled(true)}}},$1x_2:function($p0){var $v_0=Xrm.Page.ui.controls.get($p0);!IsNull($v_0)&&$v_0.setDisabled(true)},$59_2:function(){var $v_0=false;if(window.IsCampaignActivityDistributed)$v_0=true;var $v_1=Xrm.Page.ui.navigation.items.get("navBulkOperationSuccesses");!IsNull($v_1)&&$v_1.setVisible($v_0);var $v_2=Xrm.Page.ui.navigation.items.get("navBulkOperationFailures");!IsNull($v_2)&&$v_2.setVisible($v_0)},getCampaignActivityAction:function($p0,$p1){return this.$5O_2(this.$3h_2($p0,$p1),$p0)},$3h_2:function($p0,$p1){var $v_0=_String.empty;if(Mscrm.SessionInfo.isOnline()&&!$p1&&window.UserHasCreateActivityPrivilege)switch($p0){case 3:$v_0="listletter";break;case 7:$v_0="listemail";break;case 1:$v_0="listphone";break;case 5:$v_0="listfax";break;case 2:$v_0="listappointment";break;case 4:$v_0=this.$1a_2("letterviamailmerge");break;case 6:$v_0=this.$1a_2("faxviamailmerge");break;case 8:$v_0=this.$1a_2("emailviamailmerge");if(!window.IsMarketingExecutionEnabled)$v_0="emailviamailmergeoff";break;default:$v_0=_String.empty;break}return $v_0},$1a_2:function($p0){if(Xrm.Page.context.isOutlookClient())if(window.UserHasMailMergePrivilege)return $p0;else return "invalidchannel";else return _String.empty},$5O_2:function($p0,$p1){if(!isNullOrEmptyString($p0))return $p0;if(!$p1)$p0="nochannel";else if($p1===4||$p1===6||$p1===8)$p0="invalidmailmergechannel";else $p0="invalidchannel";return $p0}};Mscrm.CampaignPageHandler=function(){Mscrm.CampaignPageHandler.initializeBase(this)};Mscrm.CampaignPageHandler.prototype={postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$3t_2()},$3t_2:function(){if(this.get_primaryEntity().get_isNew()){var $v_0=false,$v_1="extraqs",$v_2="template",$v_3=Xrm.Page.context.getQueryStringParameters();if($v_1 in $v_3){var $v_4=$v_3[$v_1].toString();$v_0=$v_4.indexOf("template=1")>0}else if($v_2 in $v_3){var $v_5=$v_3[$v_2].toString();$v_0=$v_5==="1"?true:false}if($v_0){Mscrm.RefreshPageHandler.get_uiManager().set_formTitle(window.LOCID_CAMPAIGN_NEWTEMPLATE);var $v_6="istemplate",$v_7=String.format("header_{0}",$v_6),$v_8=Xrm.Page.ui.controls.get($v_7),$v_9=Xrm.Page.data.entity.attributes.get($v_6);if(!IsNull($v_9)&&!IsNull($v_8)){$v_8.setDisabled(false);$v_9.setValue(1);$v_8.setDisabled(true)}}}}};Mscrm.QueuePageHandler=function(){Mscrm.QueuePageHandler.initializeBase(this)};Mscrm.QueuePageHandler.$5J=function($p0){try{!IsNull(Mscrm.QueuePageHandler.$q)&&Mscrm.InlineEditDataService.get_dataService().remove_formRefreshed(Mscrm.QueuePageHandler.$q)}catch($$e_1){}};Mscrm.QueuePageHandler.prototype={postPageRender:function(){if(this.isRefreshForm()){var $$t_0=this;Mscrm.QueuePageHandler.$q=function(){refreshGrid("queuemembersgrid")};Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(Mscrm.QueuePageHandler.$q);$addHandler(window,"unload",Mscrm.QueuePageHandler.$5J);Mscrm.RefreshPageHandler.prototype.postPageRender.call(this)}}};Mscrm.QuotePageHandler=function(){this.$$d_$2I_2=Function.createDelegate(this,this.$2I_2);Mscrm.QuotePageHandler.initializeBase(this)};Mscrm.QuotePageHandler.prototype={postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$2O_2()},postPartialInlineInitialization:function($p0){Mscrm.RefreshPageHandler.prototype.postPartialInlineInitialization.call(this,$p0);this.$1h_2()},$1h_2:function(){var $v_0=Xrm.Page.data.entity.attributes.get("effectiveto");!IsNull($v_0)&&$v_0.addOnChange(this.$$d_$2I_2,false)},$2I_2:function($p0){this.$2O_2()},$2O_2:function(){var $v_0=Xrm.Page.data.entity.attributes.get("statecode");if($v_0){var $v_1=$v_0.getText(),$v_2=Xrm.Page.data.entity.attributes.get("effectiveto").getValue();if(!isNullOrEmptyString($v_1)&&!IsNull($v_2))if((new Date).getTime()>$v_2&&($v_1.toUpperCase()===Mscrm.QuotePageHandler.QuoteState.toString(0).toUpperCase()||$v_1.toUpperCase()===Mscrm.QuotePageHandler.QuoteState.toString(1).toUpperCase())){var $v_3=window.LOCID_QUOTE_EXPIRED;this.setFormNotification($v_3,"WARNING","QuoteExpiryNotification")}else this.clearFormNotification("QuoteExpiryNotification")}},clearFormNotification:function($p0){var $v_0=$find("crmNotifications");if(IsNull($v_0))return false;return $v_0.clearFormNotification($p0)},setFormNotification:function($p0,$p1,$p2){var $v_0=$find("crmNotifications");if(IsNull($v_0))return false;return $v_0.setFormNotification($p0,$p1,$p2)}};Mscrm.QuotePageHandler.QuoteState=function(){};Mscrm.QuotePageHandler.QuoteState.prototype={draft:0,active:1,won:2,closed:3};Mscrm.QuotePageHandler.QuoteState.registerEnum("Mscrm.QuotePageHandler.QuoteState",false);Mscrm.QuoteCommandHandler=function(){this.$$d_$4q_1=Function.createDelegate(this,this.$4q_1);this.$$d_$4p_1=Function.createDelegate(this,this.$4p_1);Mscrm.QuoteCommandHandler.initializeBase(this)};Mscrm.QuoteCommandHandler.prototype={$E_1:null,get_commandSucceedCallback:function(){return this.$E_1},set_commandSucceedCallback:function($p0){this.$E_1=$p0;return $p0},buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.QuoteGetProducts:return this.$1V_1();case Mscrm.InlineCommands.QuoteAccept:this.$E_1=this.$$d_$4p_1;return this.$3M_1();case Mscrm.InlineCommands.QuoteCreateOrder:this.$E_1=this.$$d_$4p_1;return this.createCommandWithDefaultParameter();case Mscrm.InlineCommands.QuoteCloseQuote:this.$E_1=this.$$d_$4q_1;return this.$3N_1();case Mscrm.InlineCommands.QuoteCreateRevision:return this.$3O_1();default:return this.createCommandWithDefaultParameter()}},$1V_1:function(){var $v_0=this.$1_0["OpportunityID"],$v_1="",$v_2="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><gpOpportunityId>{3}</gpOpportunityId><dataxml>{4}</dataxml></Input>";$v_1=String.format($v_2,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$4p_1:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_0)){var $v_1=$v_0.Id;Xrm.Utility.openEntityForm(Mscrm.EntityLogicalNames.SalesOrder,$v_1,null)}Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},$4q_1:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_0)){var $v_2=$v_0.Id;Xrm.Utility.openEntityForm(Mscrm.EntityLogicalNames.Quote,$v_2,null)}Mscrm.InlineEditDataService.refreshGridOnStateChange();var $v_1=this.$1_0["CloseOpp"]?this.$1_0["CloseOpp"]:false;if($v_1){var windowOpener=window.top.opener;windowOpener!=null&&windowOpener.Xrm.Page.data!=null&&windowOpener.Xrm.Page.data.entity!=null&&windowOpener.Xrm.Page.data.entity.getEntityName()==Mscrm.InternalUtilities.EntityNames.Opportunity&&windowOpener.Xrm.Page.data.refresh(true)}return true},$3M_1:function(){var $v_0="",$v_1=this.$1_0["NewStatusCode"],$v_2=this.$1_0["CloseDate"],$v_3=this.$1_0["Description"],$v_4=this.$1_0["CloseQpportunity"],$v_5=this.$1_0["UseRevenue"],$v_6=this.$1_0["ActualRevenue"],$v_7="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><aqNewStatus>{3}</aqNewStatus><aqCloseDate>{4}</aqCloseDate><aqDescription>{5}</aqDescription><aqCloseOpportunity>{6}</aqCloseOpportunity><aqUseGivenRevenue>{7}</aqUseGivenRevenue><aqActualRevenue>{8}</aqActualRevenue><dataxml>{9}</dataxml></Input>";$v_0=String.format($v_7,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode($v_3),CrmEncodeDecode.CrmXmlEncode($v_4),CrmEncodeDecode.CrmXmlEncode($v_5),CrmEncodeDecode.CrmXmlEncode($v_6),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_0},$3N_1:function(){var $v_0=this.$1_0["NewStatus"],$v_1=this.$1_0["CloseDate"],$v_2="<opportunityclose/>",$v_3=0,$v_4=0,$v_5=this.$1_0["ReviseQuote"],$v_6=this.$1_0["CloseOpp"],$v_7=this.$1_0["Description"];if($v_6){$v_3=this.$1_0["OpportunityStatus"];$v_4=this.$1_0["OpportunityState"];$v_2=this.$1_0["ActivityXml"]}var $v_8=this.get_primaryEntity().get_recordId().replace("{","").replace("}",""),$v_9="",$v_A="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><cqNewStatus>{3}</cqNewStatus><cqCloseDate>{4}</cqCloseDate><cqActivityXml>{5}</cqActivityXml><cqReviseQuote>{6}</cqReviseQuote><cqCloseOpp>{7}</cqCloseOpp><coDescription>{8}</coDescription><cqOppStatus>{9}</cqOppStatus><cqOppState>{10}</cqOppState><dataxml>{11}</dataxml></Input>";$v_9=String.format($v_A,CrmEncodeDecode.CrmXmlEncode($v_8),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0.toString()),CrmEncodeDecode.CrmXmlEncode($v_1),$v_2,CrmEncodeDecode.CrmXmlEncode($v_5.toString()),CrmEncodeDecode.CrmXmlEncode($v_6.toString()),CrmEncodeDecode.CrmXmlEncode($v_7),CrmEncodeDecode.CrmXmlEncode($v_3.toString()),CrmEncodeDecode.CrmXmlEncode($v_4.toString()),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_9},$3O_1:function(){var $v_0=this.$1_0,$v_1=$v_0,$v_2="",$v_3=this.get_primaryEntity().get_recordId().replace("{","").replace("}",""),$v_4="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><crCloseQuote>{3}</crCloseQuote><dataxml>{5}</dataxml></Input>";$v_2=String.format($v_4,CrmEncodeDecode.CrmXmlEncode($v_3),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_1.toString()),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_2}};Mscrm.MoreCommandsMenu=function(parentElementId){this.$$d_$25_0=Function.createDelegate(this,this.$25_0);this.$u_0="#"+parentElementId};Mscrm.MoreCommandsMenu.$2F=function($p0){var $v_0=$P_CRM($p0.target);if(!$v_0.hasClass("moreMenuUnselected")){$v_0=$v_0.parents("li");if($v_0.length!==1)return}var $v_1=String.format(".{0}","moreMenuSelected"),$v_2=$P_CRM($v_1);Mscrm.MoreCommandsMenu.$1C($v_0,$v_2)};Mscrm.MoreCommandsMenu.$1C=function($p0,$p1){$p1.addClass("moreMenuUnselected");$p1.removeClass("moreMenuSelected");$p0.removeClass("moreMenuUnselected");$p0.addClass("moreMenuSelected");$p0.find("a").focus()};Mscrm.MoreCommandsMenu.prototype={$t_0:false,$6_0:null,$e_0:null,$I_0:false,$u_0:null,$1J_0:null,$1E_0:null,$1I_0:0,$25_0:function($p0){switch($p0.which){case 13:var $v_0=$P_CRM($p0.target);$v_0.click();break;case 9:if($p0.target.tagName==="A"||$p0.target.tagName==="LI"){$p0.preventDefault();this.$1A_0($p0)}break;case 38:case 40:($p0.target.tagName==="A"||$p0.target.tagName==="LI")&&this.$1A_0($p0);break;case 27:this.$6_0.hide();this.$t_0=false;var $$t_2=this;window.setTimeout(function(){$P_CRM($$t_2.$u_0).children(":first-child").focus()},1);break}$p0.stopImmediatePropagation()},$1A_0:function($p0){var $v_0=String.format(".{0}","moreMenuSelected"),$v_1=$P_CRM($v_0),$v_2=null;if($p0.which===40||$p0.which===9&&!$p0.shiftKey){$v_2=$v_1.next();if(!$v_2.length)$v_2=$P_CRM("#moreCommandsList").children(":first-child");$v_2.focus()}else if($p0.which===38||$p0.which===9&&$p0.shiftKey){$v_2=$v_1.prev();if(!$v_2.length)$v_2=$P_CRM("#moreCommandsList").children(":last-child");$v_2.focus()}$v_2&&($v_2.hasClass("ms-crm-RefreshForm-MoreMenu")||$v_2.hasClass("actiondropdownitemcontent"))&&Mscrm.MoreCommandsMenu.$1C($v_2,$v_1)},get_position:function(){return isNullOrEmptyString(this.$1J_0)?Mscrm.FlyOutPosition.bottom:this.$1J_0},set_position:function(value){this.$1J_0=value;return value},get_dialog:function(){return this.$6_0},set_dialog:function(value){this.$6_0=value;return value},processAndShowMenu:function(){this.$3v_0();if(this.$t_0){this.$6_0.hide();this.$t_0=false;return}var $v_0=this.$3i_0();this.$3J_0($v_0);this.$6_0.show($P_CRM(this.$u_0),null);this.$1I_0=this.$6_0.get_jQueryDialog().dialog("open").height();var $v_1=$P_CRM("#footerActivatedState_text").offset(),$v_2=$P_CRM(this.$u_0).offset(),$v_3=$v_1.top-$v_2.top;$v_3<this.$1I_0&&this.$6_0.get_jQueryDialog().dialog("option","position",[this.$6_0.get_dialogLeft(),$v_2.top-this.$1I_0]);var $v_4=$P_CRM("#moreCommandsList").children(":first-child");$v_4.addClass("moreMenuSelected");$v_4.removeClass("moreMenuUnselected");$v_4.focus();$P_CRM("#moreCommandsList IMG").removeClass("moreMenuUnselected");this.$t_0=true},$3v_0:function(){if(this.$I_0)return;this.$6_0=new Mscrm.FlyOutDialog;this.$6_0.get_options().set_showButtonPane(false);this.$6_0.get_options().set_modal(true);this.$6_0.get_options().set_closeOnEscape(true);this.$6_0.set_shouldDisposeContent(false);var $$t_2=this;this.$6_0.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_2.$2E_0()});var $$t_3=this;this.$6_0.bind(Mscrm.FlyOutDialogEventName.closed,function($p1_0){$$t_3.$2E_0()});this.$I_0=true},$3J_0:function($p0){var $v_0=$P_CRM("<div class='ui-flyout-dialog-moreCommands'></div>"),$v_1=$P_CRM("<ul id='moreCommandsList'></ul>");$v_1.append($p0);$v_0.append($v_1);this.$1E_0=$v_0;this.$6_0.setContent($v_0);this.$e_0=$P_CRM("#moreCommandsList");this.$e_0.keydown(this.$$d_$25_0);this.$e_0.mouseover(Mscrm.MoreCommandsMenu.$2F);var $$t_7=this;this.$e_0.find("li").each(function($p1_0,$p1_1){var $v_2=$P_CRM($p1_1),$v_3=$v_2.attr("onclick");$v_2.click(function(){$$t_7.$6_0.hide();window.setTimeout($v_3,0)});$v_2.removeAttr("onclick")});this.$6_0.set_position(this.get_position());this.$6_0.get_options().set_width(200);this.$6_0.set_actionDropDownHeightAdjustment(0);this.$6_0.get_options().set_minHeight(10);this.$6_0.get_options().set_showTitlePane(false)},$3i_0:function(){var $v_0=$P_CRM(this.$u_0+"_Menu");return $v_0.html()},$2E_0:function(){this.$e_0.unbind("keydown");this.$e_0.unbind("mouseover");this.$t_0=false;this.$I_0=false;this.$6_0.dispose();this.$6_0=null;this.$1E_0.remove();this.$1E_0=null}};Mscrm.RefreshPageCommand=function(){this.$$d_defaultCommandErrorCallback=Function.createDelegate(this,this.defaultCommandErrorCallback);this.$$d_defaultCommandSucceedCallback=Function.createDelegate(this,this.defaultCommandSucceedCallback)};Mscrm.RefreshPageCommand.prototype={$1_0:null,get_commandData:function(){return this.$1_0},get_commandErrorCallback:function(){return null},set_commandErrorCallback:function(value){value=null;return value},$H_0:0,get_commandNumber:function(){return this.$H_0},get_commandSucceedCallback:function(){return null},set_commandSucceedCallback:function(value){value=null;return value},$7_0:"",get_entityFormData:function(){return this.$7_0},set_entityFormData:function(value){this.$7_0=value;return value},get_primaryEntity:function(){return Mscrm.InlineEditDataService.get_formEntity()},buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.Assign:return this.$3B_0();default:return this.createCommandWithDefaultParameter()}},executeCommand:function(commandNumber,commandData){if(!IsNull(this.get_primaryEntity())){this.$1_0=commandData;this.$H_0=commandNumber;Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();var $v_0="",$$t_4,$$t_5;if(!($$t_5=Mscrm.InlineEditDataService.isValidFormData(null,commandNumber,$$t_4={val:$v_0}),$v_0=$$t_4.val,$$t_5))return;this.$7_0=$v_0;var $v_1=this.buildCommandXml();if(this.get_commandSucceedCallback())Mscrm.InlineEditDataService.get_dataService().set_succeedCallback(this.get_commandSucceedCallback());else Mscrm.InlineEditDataService.get_dataService().set_succeedCallback(this.$$d_defaultCommandSucceedCallback);if(this.get_commandErrorCallback())Mscrm.InlineEditDataService.get_dataService().set_errorCallback(this.get_commandErrorCallback());else Mscrm.InlineEditDataService.get_dataService().set_errorCallback(this.$$d_defaultCommandErrorCallback);if((Mscrm.InlineCommands.IncidentResolve===commandNumber||Mscrm.InlineCommands.IncidentCancel===commandNumber)&&isOutlookHostedWindow())Mscrm.InlineEditDataService.execute(commandNumber,$v_1,true);else if(Mscrm.InlineCommands.RecalculateRecord===commandNumber)Mscrm.InlineEditDataService.execute(commandNumber,$v_1,false,true);else Mscrm.InlineEditDataService.execute(commandNumber,$v_1)}},createCommandWithDefaultParameter:function(){var $v_0="",$v_1="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><dataxml>{3}</dataxml></Input>";$v_0=String.format($v_1,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_0},addToQueue:function(){var $v_0="addtoqueue",$v_1=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_1)){var $v_2=window._etc,$v_3=$v_1.get_recordId(),$v_4={};$v_4["action"]=$v_0;$v_4["objectType"]=$v_2;$v_4["recordId"]=$v_3;Mscrm.FormAction.handleActionMenuClick($v_4)}},defaultCommandErrorCallback:function(errorData){if(!IsNull(errorData["_error"])){var $v_0=errorData["_error"];Mscrm.ErrorStatusControl.showCrmMessage(Mscrm.ErrorInformation.createErrorInfo($v_0.Code,$v_0.Description,$v_0.SerializedException));return true}return false},defaultCommandSucceedCallback:function(jsonData){return this.$2R_0(jsonData)},$2R_0:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(IsNull($v_0))return false;var $v_1=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[Mscrm.InlineEditDataService.get_formEntity().get_typeName()];Mscrm.ReadFormUtilities.forceReload($v_1,$v_0.Id,Mscrm.InlineEditDataService.get_formId());return true},$3B_0:function(){var $v_0="",$v_1=this.$1_0["OwnerId"],$v_2=this.$1_0["OwnerType"],$v_3="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><ownerId>{3}</ownerId><ownerType>{4}</ownerType><dataxml>{5}</dataxml></Input>";$v_0=String.format($v_3,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_0}};Mscrm.RefreshPageCommandHandler=function(){};Mscrm.RefreshPageCommandHandler.executeCommand=function(commandNumber,commandData){var $v_0;switch(commandNumber){case Mscrm.InlineCommands.InvoiceGetProducts:case Mscrm.InlineCommands.InvoicePaid:case Mscrm.InlineCommands.InvoiceCancel:case Mscrm.InlineCommands.InvoiceLock:case Mscrm.InlineCommands.InvoiceUnlock:(new Mscrm.InvoicePageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.EmailSend:$v_0=Mscrm.InlineEditDataService.get_dataService().validateAndFireSaveEvents(Xrm.SaveMode.send,Mscrm.InlineEditDataService.get_formEntity());if($v_0.get_code()===Mscrm.SaveResponseCode.validationSuccessful||$v_0.get_code()===Mscrm.SaveResponseCode.formNotDirty){Xrm.Page.data.setFormDirty(false);(new Mscrm.EmailCommandHandler).executeCommand(commandNumber,commandData)}break;case Mscrm.InlineCommands.FaxSend:$v_0=Mscrm.InlineEditDataService.get_dataService().validateAndFireSaveEvents(Xrm.SaveMode.faxSend,Mscrm.InlineEditDataService.get_formEntity());if($v_0.get_code()===Mscrm.SaveResponseCode.validationSuccessful||$v_0.get_code()===Mscrm.SaveResponseCode.formNotDirty){Xrm.Page.data.setFormDirty(false);(new Mscrm.RefreshPageCommand).executeCommand(commandNumber,commandData)}break;case Mscrm.InlineCommands.QuoteAccept:case Mscrm.InlineCommands.QuoteActivate:case Mscrm.InlineCommands.QuoteCloseQuote:case Mscrm.InlineCommands.QuoteCreateOrder:case Mscrm.InlineCommands.QuoteCreateRevision:case Mscrm.InlineCommands.QuoteGetProducts:(new Mscrm.QuoteCommandHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.ContractCancel:case Mscrm.InlineCommands.ContractClone:case Mscrm.InlineCommands.ContractHold:case Mscrm.InlineCommands.ContractInvoice:case Mscrm.InlineCommands.ContractReleaseHold:case Mscrm.InlineCommands.ContractRenew:(new Mscrm.ContractPageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.ContractDetailCancel:(new Mscrm.ContractDetailPageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.Assign:(new Mscrm.RefreshPageCommand).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.AddToQueue:(new Mscrm.RefreshPageCommand).addToQueue();break;case Mscrm.InlineCommands.OrderLock:case Mscrm.InlineCommands.OrderUnlock:case Mscrm.InlineCommands.OrderCancelOrder:case Mscrm.InlineCommands.OrderFulfillOrder:case Mscrm.InlineCommands.OrderProcessOrder:case Mscrm.InlineCommands.SalesOrderGetProducts:(new Mscrm.SalesOrderPageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.IncidentCancel:case Mscrm.InlineCommands.IncidentResolve:var $v_1=new Mscrm.IncidentPageHandler;$v_1.executeCommand(commandNumber,commandData);isOutlookHostedWindow()&&$v_1.reloadAfterCaseCloseOrCancelForOutlook();break;case Mscrm.InlineCommands.IncidentCheckForOpenActivities:(new Mscrm.IncidentPageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.RecalculateRecord:(new Mscrm.SalesOrderPageHandler).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.RenewEntitlement:(new Mscrm.RefreshPageCommand).executeCommand(commandNumber,commandData);break;case Mscrm.InlineCommands.Reactivate:Mscrm.RefreshPageCommandHandler.$3n(commandNumber,commandData);break;default:break}};Mscrm.RefreshPageCommandHandler.$3n=function($p0,$p1){var $v_0=Mscrm.InlineEditDataService.save(Xrm.SaveMode.reactivate,null,null,true);if($v_0.get_success()){!isNullOrEmptyString($v_0.get_recordId())&&Mscrm.InlineEditDataService.get_formEntity().set_recordId($v_0.get_recordId());var $v_1=Xrm.Page.data.entity.getEntityName();switch($v_1){case Mscrm.EntityLogicalNames.Incident:(new Mscrm.IncidentPageHandler).executeCommand($p0,$p1);break;default:break}}};Mscrm.RefreshPageHandler=function(){this.$$d_$5D_1=Function.createDelegate(this,this.$5D_1);this.$$d_$5E_1=Function.createDelegate(this,this.$5E_1);this.$$d_$5G_1=Function.createDelegate(this,this.$5G_1);this.$$d_$4M_1=Function.createDelegate(this,this.$4M_1);this.$$d_$4H_1=Function.createDelegate(this,this.$4H_1);this.$$d_$4J_1=Function.createDelegate(this,this.$4J_1);this.$$d_processFlyoutLayout=Function.createDelegate(this,this.processFlyoutLayout);this.$$d_retrieveFlyoutLayoutCallBack=Function.createDelegate(this,this.retrieveFlyoutLayoutCallBack);this.$$d_$3Q_1=Function.createDelegate(this,this.$3Q_1);this.$$d_$2f_1=Function.createDelegate(this,this.$2f_1);this.$$d_$50_1=Function.createDelegate(this,this.$50_1);this.$$d_$4e_1=Function.createDelegate(this,this.$4e_1);this.$$d_postInitializeProcessControl=Function.createDelegate(this,this.postInitializeProcessControl);this.$$d_$40_1=Function.createDelegate(this,this.$40_1);this.$$d_$3z_1=Function.createDelegate(this,this.$3z_1);this.$$d_$3y_1=Function.createDelegate(this,this.$3y_1);this.$$d_$4Z_1=Function.createDelegate(this,this.$4Z_1);this.$$d_$2I_1=Function.createDelegate(this,this.$2I_1);this.$$d_$4c_1=Function.createDelegate(this,this.$4c_1);this.$$d_$2j_1=Function.createDelegate(this,this.$2j_1);this.$$d_$2p_1=Function.createDelegate(this,this.$2p_1);this.$$d_$4B_1=Function.createDelegate(this,this.$4B_1);this.$$d_$4g_1=Function.createDelegate(this,this.$4g_1);this.$$d_$4X_1=Function.createDelegate(this,this.$4X_1);this.$$d_$4P_1=Function.createDelegate(this,this.$4P_1);this.$$d_$4K_1=Function.createDelegate(this,this.$4K_1);this.$$d_$2J_1=Function.createDelegate(this,this.$2J_1);this.$$d_$46_1=Function.createDelegate(this,this.$46_1);this.$$d_onResize=Function.createDelegate(this,this.onResize);this.$p_1=new Array(0);this.$T_1=new Array(0);this.$n_1=new Array(0);this.$18_1=-1;this.$1k_1=new Mscrm.MetricsStopwatch("InitializeInlineEditControls (Full)");Mscrm.RefreshPageHandler.initializeBase(this)};Mscrm.RefreshPageHandler.get_instance=function(){return Mscrm.RefreshPageHandler.$Z};Mscrm.RefreshPageHandler.set_instance=function(value){Mscrm.RefreshPageHandler.$Z=value;return value};Mscrm.RefreshPageHandler.get_forceNavigationAway=function(){return Mscrm.RefreshPageHandler.$J};Mscrm.RefreshPageHandler.set_forceNavigationAway=function(value){Mscrm.RefreshPageHandler.$J=value;return value};Mscrm.RefreshPageHandler.populateNotifications=function(notifications){var $v_0=$find("crmNotifications");!IsNull($v_0)&&$v_0.SetNotifications(notifications,Mscrm.NotificationSource.server)};Mscrm.RefreshPageHandler.promptSaveOnMobileSafari=function(eventObject){if(Mscrm.CrmBrowser.get_currentBrowser().get_isMobileSafari()&&Mscrm.ReadFormUtilities.promptOnClose()&&!confirm(window.LOCID_FORMS_SAVE_CONFIRM_TITLE)){eventObject.preventDefault();eventObject.stopPropagation();return false}else return true};Mscrm.RefreshPageHandler.getEntityIdFromPage=function(){return _id};Mscrm.RefreshPageHandler.$29=function(){return window._etc};Mscrm.RefreshPageHandler.handleError=function(error){if(error.RedirectToEdit)if(Mscrm.Utilities.isMobileRefresh())window.history.back();else Mscrm.ReadFormUtilities.openEditForm()};Mscrm.RefreshPageHandler.$4t=function(){var $v_0=Xrm.Page.ui;if(IsNull($v_0.controls))$v_0.controls=new Mscrm.ClientApiCollection;var $v_1=document.getElementsByTagName("iframe");if(!IsNull($v_1))for(var $v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2],$v_4=$v_3.attributes.getNamedItem("id"),$v_5=$v_3.attributes.getNamedItem("url"),$v_6=$v_3.attributes.getNamedItem("isWebResource");if(!IsNull($v_5)){var $v_8=Mscrm.CrmUri.create($v_5.value);if($v_8.get_isWebResource()&&!IsNull($v_6)&&$v_6.value==="True")continue}else continue;if(!IsNull($v_4)&&$v_4.value==="notescontrol"||Mscrm.InlineEditCommonUtilities.isSubgridIframe($v_3.getAttribute("src").toString()))continue;var $v_7=new Mscrm.InlineIFrameControlView($v_3);$v_0.controls.add($v_7);Mscrm.InlineEditInitializerUtility.associateControlWithParentSection($v_1[$v_2],$v_7)}};Mscrm.RefreshPageHandler.keyDownHandler=function(eventArgs){switch(eventArgs.keyCode){case 13:if(!IsNull(eventArgs.target)){var $v_0=eventArgs.target.attributes.getNamedItem("onclick");if(!IsNull($v_0)&&$v_0.value.startsWith("Mscrm.ReadFormUtilities.openLookup(")){var $v_1=true,$v_2=eventArgs.target.attributes.getNamedItem("resolved");if(!IsNull($v_2)&&$v_2.value==="false")$v_1=false;Mscrm.ReadFormUtilities.openLookup($v_1,eventArgs);window.event.cancelBubble=true}}break;case 68:if(eventArgs.ctrlKey){Mscrm.CommandBarActions.deletePrimaryRecord(Xrm.Page.data.entity.getId(),Xrm.Page.data.entity.getEntityName());eventArgs.preventDefault();eventArgs.stopPropagation()}break;case 123:eventArgs.shiftKey&&Mscrm.RefreshPageHandler.$2V(eventArgs);break;case 83:if(eventArgs.altKey&&eventArgs.ctrlKey)return;if(eventArgs.shiftKey&&eventArgs.ctrlKey){!Mscrm.InlineEditDataService.get_busy()&&(new Mscrm.RefreshPageHandler).saveAndNew();eventArgs.preventDefault();eventArgs.stopPropagation()}else if(eventArgs.ctrlKey)Mscrm.RefreshPageHandler.$2V(eventArgs);else if(eventArgs.altKey){var $v_3=Mscrm.RefreshPageHandler.$4z(eventArgs);$v_3.get_code()!==Mscrm.SaveResponseCode.saveSpecial&&(new Mscrm.RefreshPageHandler).close()}break}};Mscrm.RefreshPageHandler.$4z=function($p0){var $v_0=null;if(!Mscrm.InlineEditDataService.get_busy()){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();$v_0=Mscrm.InlineEditDataService.save(Xrm.SaveMode.saveAndClose,Mscrm.RefreshPageHandler.$1j,null,false)}$p0.preventDefault();$p0.stopPropagation();return $v_0};Mscrm.RefreshPageHandler.$2V=function($p0){if(!Mscrm.InlineEditDataService.get_busy()){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();Mscrm.InlineEditDataService.save(Xrm.SaveMode.save,Mscrm.RefreshPageHandler.$1j,null,false)}$p0.preventDefault();$p0.stopPropagation()};Mscrm.RefreshPageHandler.$3r=function(){var $v_0=new Mscrm.ReadFormUIManager,$v_1=new Mscrm.ReadFormDataManager,$v_2=Mscrm.RefreshPageHandler.getEntityIdFromPage(),$v_3=_etn,$v_4=new Mscrm.ReadFormEntityWrapper($v_2,$v_3);$v_1.entity=$v_4;Xrm.Page.data=$v_1;Xrm.Page.ui=$v_0};Mscrm.RefreshPageHandler.get_uiManager=function(){return Xrm.Page.ui};Mscrm.RefreshPageHandler.$4x=function($p0,$p1,$p2){if(!IsNull($p0)&&$p0.readyState===4){$p0.onreadystatechange=null;if($p0.status===200)$p1();else if($p2){var $v_0=new Mscrm.ExceptionInformation;$v_0.RedirectToEdit=true;Mscrm.RefreshPageHandler.handleError($v_0)}}};Mscrm.RefreshPageHandler.$32=function(){Mscrm.Utilities.traceCurrentTime("CleanupEventHandlersEntry");if(!IsNull(Mscrm.RefreshPageHandler.$v))for(var $v_0=Mscrm.RefreshPageHandler.$1Z(),$v_1=0;$v_1<$v_0.length;$v_1++){if(IsNull($v_0[$v_1]))continue;for(var $v_2=$v_0[$v_1].get_attributes(),$v_3=$v_2.getLength(),$v_4=0;$v_4<$v_3;$v_4++){var $v_5=$v_2.get($v_4);if(!IsNull($v_5))!$v_5.get_isVirtual()&&$v_5.get_submitModeValue()!==Xrm.SubmitMode.never&&$v_5.removeOnChange(Mscrm.RefreshPageHandler.$v)}}};Mscrm.RefreshPageHandler.$3Z=function(){var $v_0=Mscrm.RefreshPageHeader.get_instance();if(!IsNull($v_0.get_applicationInitDeferredStatements())&&$v_0.get_applicationInitDeferredStatements().length>0){var $v_1=new Mscrm.Performance.PerformanceStopwatch("Eval ApplicationInitDeferredStatements");$v_1.start();Sys.Application.beginCreateComponents();eval($v_0.get_applicationInitDeferredStatements());Sys.Application.endCreateComponents();$v_1.stop()}};Mscrm.RefreshPageHandler.createFormDataEntity=function(id,recordId,typeName,relationshipName,recordName){var $v_0={id:id,recordId:recordId,typeName:typeName,relationshipName:relationshipName,recordName:recordName};Mscrm.CrmUIComponent.crmCreate(Mscrm.FormDataEntity,$v_0,null,null,null)};Mscrm.RefreshPageHandler.$3e=function(){var $v_0=Mscrm.JsonUtilities.getJsonString(_activityFeedsState),$v_1=null,$$t_3,$$t_4,$v_2=($$t_4=Mscrm.JsonUtilities.tryGetParsedJson($v_0,$$t_3={val:$v_1}),$v_1=$$t_3.val,$$t_4);if(IsNull($v_2))return $v_1;else return null};Mscrm.RefreshPageHandler.$42=function(){var $v_0=$get("notescontrol");if(!IsNull($v_0)){var $v_1=XUI.Html.DomUtils.GetFirstChild($v_0);if(!IsNull($v_1)){var $v_2=XUI.Html.DomUtils.GetFirstChild($v_1);if(!IsNull($v_2)&&($v_2.getAttribute("tabid")==="ActivityFeedsSystemTab"||$v_2.getAttribute("tabid")==="ActivityFeedsTab"))return true}}return false};Mscrm.RefreshPageHandler.$1Y=function(){var $v_0=Mscrm.RefreshPageHandler.$3e();return !IsNull($v_0)&&!IsNull($v_0["IsConfigured"])&&$v_0["IsConfigured"].toLowerCase()==="true"&&!IsNull($v_0["IsWallEnabled"])&&$v_0["IsWallEnabled"].toLowerCase()==="true"};Mscrm.RefreshPageHandler.$2K=function($p0){if(!IsNull($p0)){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_0)){$P_CRM("#crmFormSubmitId").val($v_0.Id);var $$t_2=$v_0.TypeCode;$P_CRM("#crmFormSubmitObjectType").val($$t_2.$$d_toString||($$t_2.$$d_toString=Function.createDelegate($$t_2,$$t_2.toString)));$P_CRM("#crmFormSubmitObjectTypeName").val($v_0.TypeName)}}};Mscrm.RefreshPageHandler.$1j=function($p0){raiseEvent(Mscrm.ScriptEvents.ReloadCommandBar,null,null);Mscrm.FormNavControl.enableNavLinks();typeof Mscrm.ActivityContainer!=="undefined"&&Mscrm.ActivityContainer.enableActivityCommandBar();var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);Mscrm.InlineEditUtilities.addEntityToRecent($v_0);Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.executeCallbacksAssociatedWithGlobalQuickCreate(Mscrm.GlobalQuickCreate.QuickCreateCallbackType.saveSuccess,$v_0);return false};Mscrm.RefreshPageHandler.get_$c=function(){return window._etc};Mscrm.RefreshPageHandler.switchProcess=function(){if(IsNull(Mscrm.RefreshPageHandler.$x)){var $v_0=$P_CRM(document.body);Mscrm.RefreshPageHandler.$x=new Mscrm.SwitchProcessFlyOut($v_0,Mscrm.InlineEditDataService.get_formEntity().get_recordId(),Mscrm.InlineEditDataService.get_formEntity().get_typeName());Mscrm.RefreshPageHandler.$x.add_processSwitched(Mscrm.RefreshPageHandler.$4O)}Mscrm.RefreshPageHandler.$x.show()};Mscrm.RefreshPageHandler.$4O=function($p0,$p1){Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.RefreshPageHandler.get_$c(),Mscrm.InlineEditDataService.get_formEntity().get_recordId())};Mscrm.RefreshPageHandler.editSalesProcess=function(){var $v_0=$get("processControlProcessInfo");if(!IsNull($v_0)){var $v_1=$v_0.attributes.getNamedItem("data-id");if(!IsNull($v_1)){var $v_2=$v_1.value;safeWindowOpen(Mscrm.CrmUri.create("/Tools/ProcessControl/bpfConfigurator.aspx?id="+CrmEncodeDecode.CrmUrlEncode($v_2)),"","height=800,width=1040",false,true)}}};Mscrm.RefreshPageHandler.checkRefreshForm=function(){return Mscrm.ReadFormUtilities.isRefreshForm()};Mscrm.RefreshPageHandler.$1i=function($p0){var $v_0=Mscrm.RefreshPageHandler.$1f();if($v_0){if(!IsNull($p0))$p0.rawEvent.returnValue=window.LOCID_FORMS_SAVE_CONFIRM_TITLE;return LOCID_FORMS_SAVE_CONFIRM_TITLE}};Mscrm.RefreshPageHandler.$1Z=function(){var $v_0=new Array(0);$v_0[$v_0.length]=Mscrm.InlineEditDataService.get_formEntity();if(IsNull(Mscrm.QuickFormBehavior))return $v_0;for(var $v_1=Mscrm.QuickFormBehavior.getAllQuickFormBehaviors(),$v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];if(!$v_3.get_isDisposed())$v_0[$v_0.length]=$v_3.get_formDataEntityObject()}return $v_0};Mscrm.RefreshPageHandler.$28=function(){var $v_0={};if(IsNull(Mscrm.QuickFormBehavior))return $v_0;for(var $v_1=Mscrm.QuickFormBehavior.getAllQuickFormBehaviors(),$$arr_2=$v_1,$$len_3=$$arr_2.length,$$idx_4=0;$$idx_4<$$len_3;++$$idx_4){var $v_2=$$arr_2[$$idx_4];if(IsNull($v_2.get_formDataEntityObject()))continue;$v_0[$v_2.get_formDataEntityObject().get_id()]=$v_2.get_uniqueId()}return $v_0};Mscrm.RefreshPageHandler.$2T=function(){!IsNull(Mscrm.InlineEditDataService.get_dataService())&&Mscrm.InlineEditDataService.resetParameters()};Mscrm.RefreshPageHandler.$1f=function(){if(Mscrm.RefreshPageHandler.checkRefreshForm()){if(Mscrm.RefreshPageHandler.$J){Mscrm.RefreshPageHandler.$2T();return false}Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();for(var $v_0=false,$v_1=Mscrm.RefreshPageHandler.$1Z(),$v_2=Mscrm.RefreshPageHandler.$28(),$v_3=0;$v_3<$v_1.length;$v_3++){var $v_4=$v_1[$v_3];if(IsNull($v_4))continue;if($v_4.get_isDirty()&&Mscrm.Utilities.isMobileRefresh())return true;if(!$v_4.get_isNew()){var $v_5=null;if(!$v_4.get_isDirty())continue;if($v_4.get_id()===Mscrm.InlineEditDataService.get_formEntity().get_id())$v_5=Mscrm.InlineEditDataService.get_dataService().saveData(Xrm.SaveMode.saveAndClose,true);else{var $v_6=$v_2[$v_4.get_id()];if(isNullOrEmptyString($v_6))continue;$v_5=Mscrm.InlineEditDataService.get_dataService().quickFormSaveData($v_6,false)}if(!$v_5.get_success()){$v_0=true;break}}else if($v_4.get_isDirty()){$v_0=true;break}}return $v_0}return false};Mscrm.RefreshPageHandler.$1e=function($p0){Mscrm.QuickFormInlineEditDomHelper.cleanup();!Mscrm.InlineEditDataService.get_pageNavigation()&&Mscrm.InlineEditDataService.refreshGrid(true);Mscrm.InlineEditDataService.set_pageNavigation(false);Mscrm.InlineEditDataService.set_isPreviewForm(false);!isOutlookHostedWindow()&&$removeHandler(window,"beforeunload",Mscrm.RefreshPageHandler.$1i);$removeHandler(window,"unload",Mscrm.RefreshPageHandler.$1e);Mscrm.RefreshPageHandler.$32();Mscrm.RefreshPageHandler.$33()};Mscrm.RefreshPageHandler.$33=function(){Mscrm.CssMediaQueryEvaluator.get_instance().dispose();window.RecordData=null;window.FormLayout=null;window.perfDict=null;Mscrm.Obsolete.RenderVariables.removeVariables();Mscrm.GlobalEvents.documentUnload(null)};Mscrm.RefreshPageHandler.$2U=function($p0){if(!window.UseTabletExperience)return;Mscrm.InlineEditDataService.saveCachedFormData();Mscrm.RefreshPageHandler.$1e($p0)};Mscrm.RefreshPageHandler.$31=function(){Mscrm.InlineEditDataService.checkState()};Mscrm.RefreshPageHandler.isBusinessProcessPresent=function(){return Mscrm.Utilities.isBusinessProcessPresent()};Mscrm.RefreshPageHandler.prototype={$Y_1:null,_formData:null,_flyoutLayoutRequest:null,$1L_1:false,$17_1:null,$1n_1:null,$1m_1:null,$R_1:null,_entitiesMetadata:null,_deleteFlyoutVisible:false,_deleteFlyout:null,get_formLayoutTemplate:function(){return this.$Y_1},get_processControlInitializer:function(){return Mscrm.RefreshPageHandler.$U},get_firstFormAreaSectionControls:function(){return $P_CRM("#rofContainer .ms-crm-Form-AreaContainer .ms-crm-FormSection").first().find(".ms-crm-Field-Data-Print")},get_secondFormAreaSectionControls:function(){return $P_CRM("#rofContainer .ms-crm-Form-AreaContainer .ms-crm-FormSection").eq(1).find(".ms-crm-Field-Data-Print")},dispose:function(){$P_CRM(window).unbind("resize-header",this.$$d_onResize);$removeHandler(document,"keyup",this.$$d_$46_1);$removeHandler(document,"keydown",Mscrm.RefreshPageHandler.keyDownHandler);Mscrm.Utilities.safeDispose(Mscrm.RefreshPageHandler.$U);Mscrm.RefreshPageHandler.$U=null;var $v_0=$get("form_pic_image_link");if(!IsNull($v_0)){$removeHandler($v_0,"click",this.$$d_$2J_1);$removeHandler($v_0,"keydown",this.$$d_$4K_1)}this.$18_1!==-1&&window.clearInterval(this.$18_1);$P_CRM(window).unbind("resize",this.$$d_onResize);!IsNull(this._deleteFlyout)&&this._deleteFlyout.dispose();if(typeof crmFormOnUnloadHandler=="function")window.RefreshFormScriptEnabled!=null&&window.RefreshFormScriptEnabled&&crmFormOnUnloadHandler();Mscrm.InlineEditDataService.get_dataService().dispose();Mscrm.RefreshPageHeader.get_instance().dispose();Mscrm.Utilities.destroyObject(Xrm.Page.ui);Mscrm.Utilities.destroyObject(this)},initialize:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("RefreshPageHandler.Initialize");$v_0.start();this.$2o_1();Mscrm.RefreshPageHandler.$3r();this.$4j_1();$addHandler(document,"keyup",this.$$d_$46_1);$addHandler(document,"keydown",Mscrm.RefreshPageHandler.keyDownHandler);if(this.isRefreshForm()){this.$3L_1();if(!IsNull(this._formData["_formId"])){Mscrm.InlineEditDataService.set_formId(this._formData["_formId"]);Mscrm.InlineEditDataService.set_isPreviewForm(this.$1L_1)}window.UseTabletExperience&&$P_CRM("body").addClass("tablet")}else Mscrm.ReadFormUtilities.hideProgressIndicator();$P_CRM(window).bind("unload",this.$$d_$4P_1);$v_0.stop();Mscrm.Utilities.isMobileRefresh()&&window.setTimeout(this.$$d_$4X_1,0)},$4P_1:function($p0){$P_CRM(window).unbind("unload",this.$$d_$4P_1);this.dispose()},$4X_1:function(){var $v_0=$P_CRM("#rofContainer"),$v_1=$P_CRM(".recordTitle");$v_0.length>0&&!$v_1.length&&$v_0.css("top",Mscrm.MobileUtility.isMastheadHidden()?"36px":"80px")},$5M_1:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("RefreshPageHandler.UpdatePageHeader");$v_0.start();var $v_1=Mscrm.RefreshPageHeader.get_instance(),$v_2=new Mscrm.Performance.PerformanceStopwatch("Eval ClientVariables");$v_2.start();for(var $v_3=$v_1.get_clientVariables(),$v_6=0;$v_6<$v_3.length;$v_6++){var $v_7=$v_3[$v_6];eval("window."+$v_7.Key+" = "+$v_7.Value)}$v_2.stop();var $v_4=new Mscrm.Performance.PerformanceStopwatch("Set WrpcTokens");$v_4.start();for(var $v_5=$v_1.get_wrpcTokens(),$v_8=0;$v_8<$v_5.length;$v_8++){var $v_9=$v_5[$v_8],$v_A=Mscrm.CrmUri.create($v_9.Key),$v_B=Mscrm.WrpcTokenFuncs.getCrmWrpcToken($v_A);!$v_B&&Mscrm.WrpcTokenFuncs.setCrmWrpcToken($v_A,$v_9.Value,$v_1.get_tokenTimestamp())}$v_4.stop();$v_0.stop();var $$t_C=this;Mscrm.OnLoadDeferredExecutor.queueCallback(function(){$$t_C.$4F_1()},0)},$4F_1:function(){for(var $v_0=this.$3m_1(),$v_1=new Array(0),$v_3=0;$v_3<$v_0.length;$v_3++){var $v_4=$v_0[$v_3].Key,$v_5=this.$1d_1($v_0[$v_3].Key);$v_5=this.$2Z_1($v_5);var $v_6=Number.parseInvariant($v_0[$v_3].Value);if(!$v_6&&$v_5.startsWith("/_static/")&&$v_5.endsWith(".js"))Array.add($v_1,$v_5);else{var $v_7=Mscrm.CrmUri.create(this.$2Z_1($v_4));if($v_6===1){this.$T_1[this.$T_1.length]=$v_7;continue}if($v_6>0||!$v_7.get_isLocalServer())this.$p_1[this.$p_1.length]=$v_7;else Array.add(this.$n_1,$v_7)}}var $v_2=new Mscrm.MetricsStopwatch("RefreshPageHandler.LoadScripts");$v_2.start();loadScriptsAdv($v_1);var $$t_8=this;notifyOnAllScriptsLoaded(function(){$v_2.stop();$$t_8.staticScriptsLoadedCallback()})},$2Z_1:function($p0){var $v_0=$p0.indexOf("?ver=");if($v_0>0)$p0=$p0.substr(0,$v_0);return $p0},staticScriptsLoadedCallback:function(){this.$4D_1();var $v_0={};$v_0["sourceUri"]=Mscrm.Utilities.getContentUrl(null);raiseEvent(Mscrm.ScriptEvents.StaticScriptsLoaded,$v_0,null);this.$4A_1();this.postInitializeProcessControl()},$4A_1:function(){var $v_0=this.$$d_$4g_1;if(!IsNull(this.$n_1)&&this.$n_1.length>0){var $v_1=new Mscrm.MetricsStopwatch("RefreshPageHandler.LoadDynamicScripts");$v_1.start();var $v_2=Mscrm.RefreshPageHeader.get_instance(),$$t_5=this;$v_2.add_scriptLoaded(function($p1_0,$p1_1){$v_1.stop();window.setTimeout($v_0,0)});$v_2.loadScriptsUsingAjax(this.$n_1)}else $v_0()},$3m_1:function(){var $v_0=Mscrm.RefreshPageHeader.get_instance(),$v_1={},$v_2=new Array(0),$v_3=$P_CRM("script"),$$t_E=this;$v_3.each(function($p1_0,$p1_1){var $v_A=$P_CRM($p1_1).attr("src");if(!isNullOrEmptyString($v_A)){var $v_B=$$t_E.$1d_1($v_A);$v_1[$v_B]=true}});for(var $v_4=PageScriptIncludes,$v_6=0;$v_6<$v_4.length;$v_6++)$v_1[$v_4[$v_6]]=true;for(var $v_5=$v_0.get_scriptIncludes(),$v_7=0;$v_7<$v_5.length;$v_7++){var $v_8=$v_5[$v_7].Key,$v_9=this.$1d_1($v_5[$v_7].Key);if(!IsNull($v_1[$v_9]))continue;Array.add($v_2,new Mscrm.NameValuePair($v_8,$v_5[$v_7].Value))}return $v_2},$1d_1:function($p0){return $p0.toLowerCase().trim()},$4g_1:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("Eval ScriptBlocks");$v_0.start();Mscrm.OnLoadDeferredExecutor.releaseCallbacks(3);Mscrm.RefreshPageHandler.$4t();this.$3u_1();this.$3w_1();var $v_1=Mscrm.RefreshPageHeader.get_instance();if($v_1.get_applicationInitStatements().length>0){Sys.Application.beginCreateComponents();eval($v_1.get_applicationInitStatements());Sys.Application.endCreateComponents()}for(var $v_2=$v_1.get_scriptBlocks(),$v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3];eval($v_4.Value)}Mscrm.OnLoadDeferredExecutor.queueCallback(this.$$d_$4B_1,2);$v_0.stop()},$3q_1:function($p0){var $v_0=new Mscrm.Performance.PerformanceStopwatch("InitializeBingMapControl");$v_0.start();this.$2Q_1()&&RefreshBingMap(this._formData,$p0);$v_0.stop()},$4B_1:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("LoadExternalScript");$v_0.start();for(var $v_1=0;$v_1<this.$p_1.length;$v_1++)Mscrm.CrmHeader.setScriptFile(this.$p_1[$v_1]);Mscrm.OnLoadDeferredExecutor.queueCallback(this.$$d_$2p_1,2);$v_0.stop()},$2d_1:false,$22_1:false,$4C_1:function(){var $v_0=new Mscrm.MetricsStopwatch("LoadScripts - Post Viewport Init");$v_0.properties={IsAsync:true};$v_0.start();var $v_1=0,$$t_4=this,$v_2=function(){$v_1++;if($v_1>=$$t_4.$T_1.length){$$t_4.$2d_1=true;$$t_4.$22_1&&$$t_4.$1t_1();$v_0.stop()}};if(IsNull(this.$T_1)||!this.$T_1.length)$v_2();else for(var $v_3=0;$v_3<this.$T_1.length;$v_3++)Mscrm.CrmHeader.get_scriptLoader().loadScriptAsync(this.$T_1[$v_3],$v_2)},$2p_1:function(){var $$t_1=this,$v_0=function(){if($$t_1.isRefreshForm()){$$t_1.focusControlOnInit($$t_1._formData);!IsNull(Mscrm.ActivityContainer)&&Mscrm.ActivityContainer.set_parentFormInitializationCompleted(true)}};this.$3q_1($v_0);!this.$2Q_1()&&$v_0()},$2j_1:function(){Mscrm.InlineEditUtilities.addEntityToRecent(Mscrm.InlineEditUtilities.getEntityReference(this._formData))},$46_1:function($p0){switch($p0.keyCode){case 69:$p0.altKey&&!$p0.ctrlKey&&Mscrm.ReadFormUtilities.openEditForm();break}},$5K_1:function(){if(this.isRefreshForm())return;var $v_0=$get("editButton");if(!IsNull($v_0))$v_0.title=CrmEncodeDecode.CrmHtmlDecode(this._formData["_editButtonToolTip"]);var $v_1=$get("closeForm");if(!IsNull($v_1))$v_1.title=CrmEncodeDecode.CrmHtmlDecode(this._formData["_closeButtonToolTip"])},$2n_1:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("BindData");$v_0.start();this.$2m_1();Mscrm.RefreshPageHandler.$2K(this._formData);Mscrm.RefreshPageHandler.get_uiManager().set_formTitle(this._formData["_readOnlyFormTitle"]);this.postDataBinding();this.$5N_1();this.$5K_1();window.UseTabletExperience&&this.$2i_1();$v_0.stop()},$2m_1:function(){if(Mscrm.Utilities.isMobileRefresh()||typeof _activityFeedsState==="undefined")return;var $v_0=_activityFeedsState,$v_1=Mscrm.JsonUtilities.getJsonString($v_0),$v_2=null,$$t_3,$$t_4;$$t_4=Mscrm.JsonUtilities.tryGetParsedJson($v_1,$$t_3={val:$v_2}),$v_2=$$t_3.val,$$t_4;_activityFeedsStateDictionary=$v_2},$4l_1:function(){Mscrm.ReadFormControl.WebResourceImageControl.processImageWebResourcesForTab(null,this.$Y_1["webResources"])},$4k_1:function(){this.$Y_1=Mscrm.RefreshPageHeader.get_instance().set_formLayoutTemplate(window.FormLayout);this.$5M_1();this.$2n_1();this.$3x_1();this.postPageRender()},$3x_1:function(){var $$t_0=this;Mscrm.OnLoadDeferredExecutor.queueCallback(function(){masterWindow().setFormMode(_etc,"RO");$$t_0.$4l_1()},2);Mscrm.OnLoadDeferredExecutor.queueCallback(this.$$d_$2j_1,2)},postPageRender:function(){if(this.isRefreshForm()){var $v_0=$get("form_pic_image");if(!IsNull($v_0))if(!this.$45_1($v_0))$v_0.src=Mscrm.CrmUri.create("/_imgs/ContactPhoto.png").toString();else $v_0.src=Mscrm.CrmUri.create($v_0.src).toString();this.$17_1=$get("HeaderTilesWrapperLayoutElement");if(!IsNull(this.$17_1)){this.$1n_1=$P_CRM(".ms-crm-HeaderTilesWrapperElement");this.$1m_1=$P_CRM(".ms-crm-HeaderTileElement",$P_CRM(this.$17_1));$P_CRM(window).bind("resize",this.$$d_onResize)}this.$3s_1()}},$45_1:function($p0){if(IsNull($p0))return false;var $v_0=Mscrm.CrmUri.create($p0.src).get_query(),$v_1=$v_0["Attribute"];if(!isNullOrEmptyString($v_1)&&!$v_1.localeCompare("entityimage")&&!isNullOrEmptyString($v_0["Timestamp"]))return true;return false},$3s_1:function(){var $v_0=$get("form_pic_image_link");if(!IsNull($v_0)){$addHandler($v_0,"click",this.$$d_$2J_1);$addHandler($v_0,"keydown",this.$$d_$4K_1)}},$4K_1:function($p0){$p0.keyCode===13&&this.$2J_1($p0)},$2J_1:function($p0){if(!window.IS_LIVE&&Mscrm.Utilities.isIosDevice()&&!window.IS_CLAIMS)return;if(this.$43_1()&&!Mscrm.InlineEditDataService.get_formEntity().get_isDisabled()){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_imageupload.aspx");$v_0.get_query()["entityId"]=Mscrm.RefreshPageHandler.getEntityIdFromPage();$v_0.get_query()["entityName"]=Mscrm.InlineEditDataService.get_formEntity().get_typeName();$v_0.get_query()["attributeName"]="entityimage";var $v_1=Mscrm.DialogSize.imageUploadControlHeight,$v_2=Mscrm.DialogSize.imageUploadControlWidth,$v_3=Mscrm.Utilities.createCallbackFunctionObject("imageUploadCallback",this,null,false),$v_4=new Mscrm.CrmDialog($v_0,null,$v_2,$v_1,null);$v_4.setCallbackReference($v_3);$v_4.show()}},imageUploadCallback:function(imageSource){if(!isNullOrEmptyString(imageSource))$get("form_pic_image").src=imageSource},$43_1:function(){if(!isNullOrEmptyString(Mscrm.RefreshPageHandler.getEntityIdFromPage()))return true;return false},postPartialInlineInitialization:function(views){this.isRefreshForm()&&this.$1h_1(views)},postInlineInitialization:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("PostInlineInitialization");$v_0.start();!IsNull(Mscrm.BusinessRulesScript)&&Mscrm.BusinessRulesScript.Initialize();this.$41_1();var $v_1=Mscrm.RefreshPageHeader.get_instance().get_scriptBlocksOnLoad();if(!IsNull($v_1))for(var $v_2=0;$v_2<$v_1.length;$v_2++){var $v_3=$v_1[$v_2];eval($v_3.Value)}$v_0.stop()},$41_1:function(){Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Onload Handler Start",1);var $v_0=new Mscrm.MetricsStopwatch("InvokeOnloadHandlers");$v_0.start();try{window.RefreshFormScriptEnabled!=null&&window.RefreshFormScriptEnabled&&crmFormOnLoadHandler();Mscrm.InlineEditDataService.isNew()&&Xrm.Page.data.setFormDirty(false)}catch($$e_1){}$v_0.stop();Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Onload Handler Finish",1)},$2Q_1:function(){var $v_0=window.self.RefreshBingMap;if(IsNull($v_0)||Mscrm.Utilities.isGlobalQuickCreateForm())return false;return true},$1h_1:function($p0){for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=$p0[$v_0],$v_2=$find($v_1.get_dataContext().get_attribute().get_dataAttributeId());!IsNull($v_2)&&!$v_2.get_isVirtual()&&$v_2.get_submitModeValue()!==Xrm.SubmitMode.never&&$v_2.get_controls().getLength()===1&&$v_2.addOnChange(Mscrm.RefreshPageHandler.$v,false)}},$2I_1:function($p0){Mscrm.InlineEditDataService.get_dataService().resetAutoSaveInterval();if(!IsNull($p0)){var $v_0=Mscrm.ErrorStatusControl.get_statusBar().get_result();if(!IsNull($v_0)){var $v_1=$p0.getEventSource();!IsNull($v_1)&&$v_1.getName()===$v_0.attributeName&&$v_1.getParent().getClientId()===$v_0.parentFormDataEntityId&&Mscrm.ErrorStatusControl.hide(Mscrm.MessageRanks.error)}}},$4c_1:function(){var $v_0=this._formData["_notifications"];Mscrm.RefreshPageHandler.populateNotifications($v_0)},$4j_1:function(){this._formData=window.RecordData;Xrm.Page.context.saveMode=-1;if(!IsNull(this._formData)){!Mscrm.Utilities.isGlobalQuickCreateForm()&&setPageTitle(CrmEncodeDecode.CrmHtmlDecode(this._formData["_readFormTitle"].toString()));!IsNull(this._formData["dataReqId"])&&setAttributeInWindow("dataReqId",this._formData["_dataReqId"].toString());if(!IsNull(this._formData["_entity"])){var $v_0=Mscrm.InlineEditUtilities.getEntityReference(this._formData);setAttributeInWindow("_primaryFieldValue",$v_0.Name)}if(!IsNull(_isPreviewForm))this.$1L_1=_isPreviewForm;this.$4k_1();this.$4i_1(window.FormLayout["entityMetadata"])}else{var $v_1=new Mscrm.ExceptionInformation;$v_1.RedirectToEdit=true;Mscrm.RefreshPageHandler.handleError($v_1)}},$5N_1:function(){var $v_0=document.getElementsByTagName("iframe");if(!IsNull($v_0))for(var $v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if("subgrid_iframe"===$v_2.className){var $v_3=$v_2.attributes.getNamedItem("url"),$v_4=$v_3.value;if(!IsNull($v_4))$v_3.value=$v_4+"&id="+CrmEncodeDecode.CrmUrlEncode(_id)+"&etc="+CrmEncodeDecode.CrmUrlEncode(_etc)+"&formId="+CrmEncodeDecode.CrmUrlEncode(this._formData["_formId"])}}},$4i_1:function($p0){var $v_0=new Mscrm.Performance.PerformanceStopwatch("ProcessEntityMetadata");$v_0.start();this._entitiesMetadata={};for(var $v_1=0;$v_1<$p0.length;$v_1++){for(var $v_2=$p0[$v_1],$v_3=$v_2.FormId,$v_4=$v_2.Attributes,$v_5=$v_2.UnboundControls,$v_6={},$v_7=0;$v_7<$v_4.length;$v_7++)$v_6[$v_4[$v_7].LogicalName]=$v_4[$v_7];if($v_5)for(var $v_8=0;$v_8<$v_5.length;$v_8++)$v_6[$v_5[$v_8].LogicalName]=$v_5[$v_8];this._entitiesMetadata[$v_3]=$v_6}$v_0.stop()},$4D_1:function(){var $v_0=new Mscrm.Performance.PerformanceStopwatch("LoadProcessControl");$v_0.start();if(typeof ProcessControl!=="undefined"){Mscrm.RefreshPageHandler.$U=new ProcessControl.Services.ProcessControlInitializer;Mscrm.RefreshPageHandler.$U.initialize(this._formData)}$v_0.stop()},$2o_1:function(){$P_CRM(window).bind("resize-header",this.$$d_onResize)},onResize:function(resizeEvent){var $v_0=new Mscrm.Performance.PerformanceStopwatch("RefreshPageHandler.OnResize");$v_0.start();this.$4w_1();this.$4L_1();$v_0.stop()},$4w_1:function(){Mscrm.Utilities.setRefreshHeaderLayout(this.$17_1,this.$1n_1,this.$1m_1)},$4L_1:function(){Mscrm.Utilities.setRefreshFormLayout()},$3w_1:function(){Mscrm.OnLoadDeferredExecutor.queueCallback(this.$$d_$4c_1,2)},$3u_1:function(){Mscrm.RefreshPageHandler.$v=this.$$d_$2I_1;Mscrm.RefreshPageHandler.$1O=this.$$d_$4Z_1;var $$t_3=this;window.setTimeout(function(){$$t_3.$1k_1.start();Mscrm.InlineEditInitializationManager.get_instance().add_inlineEditInitializationCompleted($$t_3.$$d_$3y_1);Mscrm.InlineEditInitializationManager.get_instance().add_inlineEditPartialInitializationCompleted($$t_3.$$d_$3z_1);var $v_0={};$$t_3.getQuickFormLoadOrder($v_0);Mscrm.QuickFormInlineEditDomHelper.initialize($v_0);Mscrm.InlineEditInitializationManager.get_instance().add_inlineEditViewportInitializationCompleted($$t_3.$$d_$40_1);Mscrm.InlineEditInitializationManager.get_instance().initializeForROForm($$t_3._entitiesMetadata);if(window.UseTabletExperience)$addHandler(window,"unload",Mscrm.RefreshPageHandler.$2U);else{!$$t_3.$1L_1&&!isOutlookHostedWindow()&&$addHandler(window,"beforeunload",Mscrm.RefreshPageHandler.$1i);$addHandler(window,"unload",Mscrm.RefreshPageHandler.$1e)}Mscrm.RefreshPageHandler.$1T=function($p2_0,$p2_1){$$t_3.$5P_1($p2_1)};Mscrm.InlineEditDataService.get_dataService().add_preValidation(Mscrm.RefreshPageHandler.$1T)},0)},postDataBinding:function(){if(this.isRefreshForm()){var $$t_A=this;$P_CRM("div["+Mscrm.InlineEditConstants.HtmlAttributeForQuickFormCollectionBegin+"]").each(function($p1_0,$p1_1){var $v_0=$p1_1.getAttribute(Mscrm.InlineEditConstants.HtmlAttributeForQuickFormAttributeLogicalName);if(!isNullOrEmptyString($v_0)&&$v_0 in $$t_A._formData){var $v_1=$$t_A._formData[$v_0],$v_2="otypename" in $v_1?$v_1["otypename"]:null,$v_3=$P_CRM.parseJSON($p1_1.getAttribute(Mscrm.InlineEditConstants.HtmlAttributeQuickFormChildIds)),$$dict_6=$v_3;for(var $$key_7 in $$dict_6){var $v_4={key:$$key_7,value:$$dict_6[$$key_7]},$v_5=$P_CRM(String.format("div[{0}='{1}']",Mscrm.InlineEditConstants.HtmlAttributeForUniqueId,$v_4.key),$p1_1);if(!IsNull($v_5))if(!IsNull($v_2)&&$v_5.attr(Mscrm.InlineEditConstants.HtmlAttributeForRelatedEntityLogicalName)===$v_2)$v_5.show();else $v_5.hide()}}})}},getQuickFormLoadOrder:function(loadOrder){},$3z_1:function($p0,$p1){if(IsNull($p1.get_views()))return;this.postPartialInlineInitialization($p1.get_views())},$3y_1:function($p0,$p1){if(!this.$2d_1){this.$22_1=true;return}this.$1t_1()},$1t_1:function(){var $v_0=new Mscrm.MetricsStopwatch("CompleteInlineEditInitialization");$v_0.start();Mscrm.RefreshPageHandler.$3Z();this.initializeSfaTabsControl();Mscrm.OnLoadDeferredExecutor.releaseCallbacks(2);Mscrm.InlineEditInitializationManager.get_instance().remove_inlineEditInitializationCompleted(this.$$d_$3y_1);Mscrm.InlineEditInitializationManager.get_instance().remove_inlineEditPartialInitializationCompleted(this.$$d_$3z_1);setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.StartOnPageRefreshed);if(!Mscrm.Utilities.isMobileRefresh()&&!Mscrm.RefreshPageHandler.$1S){var $$t_4=this;this.$18_1=window.setInterval(function(){Mscrm.RefreshPageHandler.$31()},1e3);Mscrm.RefreshPageHandler.$1S=true}setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.FinishOnPageRefreshed);setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.StartPostInitialization);Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(Mscrm.RefreshPageHandler.$1O);var $$t_5=this;Mscrm.OnLoadDeferredExecutor.queueCallback(function(){$$t_5.postInlineInitialization();setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.FinishPostInitialization);Mscrm.InlineEditCommonUtilities.setIFramesSourceUrls(null);if(!IsNull(Mscrm.FormInputControl.LinkControlInitializer)){var $v_2=new Mscrm.Performance.PerformanceStopwatch("InitializeAllLinkControls");$v_2.start();Mscrm.FormInputControl.LinkControlInitializer.initializeAllLinkControls();$v_2.stop()}var $v_1=new Mscrm.Performance.PerformanceStopwatch("FinalizeProcessControl");$v_1.start();$$t_5.finalizeProcessControl();$v_1.stop();Mscrm.InlineEditDataService.isNew()&&Mscrm.InlineEditDataService.get_dataService().setDirty(true);setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.ControlsInitializationComplete);refreshRibbon(3,false,true);!Mscrm.Utilities.isMobileRefresh()&&Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.showGlobalQuickCreate();if(Mscrm.Utilities.isIosDevice()){var $v_3=$get("tdAreas");if(!IsNull($v_3)){$v_3.style.overflow="hidden";window.setTimeout(function(){$v_3.style.overflow="auto"},0)}}$v_0.stop();$$t_5.$1k_1.stop();setPerfMarkerTimestamp(Mscrm.RefreshFormMarker.InlineEditInitializationCompleted);Mscrm.Performance.PerformanceMarkerManager.get_instance().addMarker("Form Full Controls Init",1);Mscrm.MetricsCollector.collectAndReportClientMetrics(2)},2)},$40_1:function($p0,$p1){var $v_0=new Mscrm.Performance.PerformanceStopwatch("InlineEditViewportInitializationCompleted");$v_0.start();Mscrm.OnLoadDeferredExecutor.releaseCallbacks(1);this.$4C_1();$v_0.stop()},postInitializeProcessControl:function(){if(IsNull(this._entitiesMetadata)){window.setTimeout(this.$$d_postInitializeProcessControl,25);return}if(!this.hasProcessControl()||!this.isRefreshForm())return;Mscrm.RefreshPageHandler.$U.postInitialize(this._entitiesMetadata)},finalizeProcessControl:function(){if(!this.hasProcessControl()||!this.isRefreshForm())return;Mscrm.RefreshPageHandler.$U.completeInitialization()},hasProcessControl:function(){return Mscrm.Utilities.hasProcessControl()},focusControlOnInit:function(formData){if(!this.isRefreshForm()||Mscrm.Utilities.isMobileRefresh())return;var $v_0=!IsNull(formData["_entitydisabled"])&&formData["_entitydisabled"]==="1";if(!$v_0&&IsNull(Mscrm.InlineEditUtilities.get_activeControl())){var $v_1=this.getRootControlsContainerForInitialFocus(formData),$v_2=this.getFirstEnabledControlView($v_1);if(IsNull($v_2)){$v_1=this.$4y_1();$v_2=this.getFirstEnabledControlView($v_1)}if(!IsNull($v_2))if(Mscrm.InlineEditDataService.isNew()){var $$t_4=$v_2;window.setTimeout($$t_4.$$d_goToEditState||($$t_4.$$d_goToEditState=Function.createDelegate($$t_4,$$t_4.goToEditState)),0)}else{var $$t_5=$v_2;window.setTimeout($$t_5.$$d_goToPreFocusState||($$t_5.$$d_goToPreFocusState=Function.createDelegate($$t_5,$$t_5.goToPreFocusState)),0)}}},$4y_1:function(){return this.get_secondFormAreaSectionControls()},getRootControlsContainerForInitialFocus:function(formData){return this.get_firstFormAreaSectionControls()},$3p_1:function(){var $v_0=$get("WebResource_RecordWall");while(true)if(!IsNull($v_0))if(!isNullOrEmptyString($v_0.className)&&$v_0.className==="ms-crm-InlineTab-Read"){$v_0.style.display="none";return}else $v_0=$v_0.parentNode;else return},$3L_1:function(){if(this.isRefreshForm()){Xrm.Page.data=null;var $v_0=window._id,$v_1=window._etn;if(IsNull($v_0)||IsNull($v_1))throw Error.create("_id or _etn is not defined on page, creating form data entity fail!");Sys.Application.beginCreateComponents();var $v_2=null;if(!IsNull(this._formData)){var $v_3=Mscrm.InlineEditUtilities.getEntityReference(this._formData);$v_2=IsNull($v_3)?null:$v_3.Name}Mscrm.RefreshPageHandler.createFormDataEntity(Mscrm.ClientApiConstants.primaryEntityId,$v_0,$v_1,"",$v_2);Sys.Application.endCreateComponents();if(!IsNull(this._formData)){!IsNull(this._formData[Mscrm.InlineEditDataService.entityDisabledKey])&&Mscrm.InlineEditDataService.get_formEntity().set_isDisabled(this._formData[Mscrm.InlineEditDataService.entityDisabledKey]==="1");!IsNull(this._formData["_formstate"])&&Mscrm.InlineEditDataService.get_formEntity().set_formState(this._formData["_formstate"])}Mscrm.InlineEditDataService.get_formEntity().add_onIsDisabledChanged(Mscrm.ErrorStatusControl.onEntityIsDisabledChangedHandler)}},$52_1:function(){var $v_0=$get("notescontrol");if(!IsNull($v_0)){if($v_0.nodeName.toUpperCase()==="IFRAME"||!Mscrm.RefreshPageHandler.$42())return;var $v_1=Mscrm.RefreshPageHandler.$1Y(),$v_2=XUI.Html.DomUtils.GetFirstChild($v_0);if(!IsNull($v_2)){var $v_3=$v_1?"":"none",$v_4=XUI.Html.DomUtils.GetFirstChild($v_2);if(Mscrm.Utilities.isIosDevice()&&!IsNull($v_4)&&$v_4.getAttribute("tabid")==="ActivityFeedsSystemTab")$v_4.style.display=$v_3;else if(!IsNull($v_4)&&$v_4.getAttribute("tabid")==="ActivityFeedsTab"){$v_4.style.display=$v_3;var $v_6=XUI.Html.DomUtils.GetNextSibling($v_4);if(!IsNull($v_6)&&$v_6.getAttribute("tabid")==="ActivityFeedsSystemTab")$v_6.style.display=$v_3}var $v_5=XUI.Html.DomUtils.GetFirstChild(XUI.Html.DomUtils.GetLastChild($v_0));if(Mscrm.Utilities.isIosDevice()&&!IsNull($v_5)&&$v_5.getAttribute("tabid")==="ActivityFeedsSystemTab")$v_5.style.display=$v_3;else if(!IsNull($v_5)&&$v_4.getAttribute("tabid")==="ActivityFeedsTab"){$v_5.style.display=$v_3;var $v_7=XUI.Html.DomUtils.GetNextSibling($v_5);if(!IsNull($v_7)&&$v_7.getAttribute("tabid")==="ActivityFeedsSystemTab")$v_7.style.display=$v_3}}!$v_1&&$v_0.getAttribute("DefaultTabId")===Mscrm.SfaTabsConstants.ActivityFeedsTabId&&$v_0.setAttribute("DefaultTabId",Mscrm.SfaTabsConstants.ActivitiesTabId)}},initializeSfaTabsControl:function(){this.$52_1();Mscrm.Utilities.traceCurrentTime("InitializeSfaTabsControlEntry");this.$R_1=$find("notescontrol");var $v_0=typeof Mscrm.CaseResearchConstants!=="undefined"?$find(Mscrm.CaseResearchConstants.activitiesWallId):null;!Mscrm.Utilities.isProcessForm()&&isNullOrEmptyString(Mscrm.RefreshPageHandler.getEntityIdFromPage())&&this.$3p_1();if(!IsNull(this.$R_1)||!IsNull($v_0)){if(!IsNull(this.$R_1)){this.$R_1.set_shouldDeferDataProcessing(true);this.$R_1.updateParentEntity(Mscrm.InlineEditUtilities.getEntityReference(this._formData));this.$R_1.setActivityFeedsTabState(Mscrm.RefreshPageHandler.$1Y());var $$t_3=this;Mscrm.RefreshPageHandler.$1R=function($p1_0,$p1_1){$$t_3.$R_1.refresh($p1_1.get_entityReference())};Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(Mscrm.RefreshPageHandler.$1R)}!IsNull($v_0)&&$v_0.setActivityFeedsTabState(Mscrm.RefreshPageHandler.$1Y())}Mscrm.OnLoadDeferredExecutor.queueCallback(this.$$d_$4e_1,2);Mscrm.Utilities.traceCurrentTime("InitializeSfaTabsControlExit")},$4e_1:function(){!IsNull(this.$R_1)&&this.$R_1.processData()},$4Z_1:function($p0,$p1){Mscrm.Utilities.traceCurrentTime("PageRefreshedEntry");if(!IsNull($p1.get_jsonData())&&!(Mscrm.InlineEditDataService.errorKey in $p1.get_jsonData())){var $v_0=$p1.get_jsonData()["_notifications"];!IsNull($v_0)&&Mscrm.RefreshPageHandler.populateNotifications($v_0);Mscrm.RefreshPageHandler.$2K($p1.get_jsonData());this.postRefresh()}Mscrm.Utilities.traceCurrentTime("PageRefreshedExit")},postRefresh:function(){},$5P_1:function($p0){$p0.set_validationResult(Mscrm.RefreshPageHandler.get_uiManager().validateControlsForEntity($p0.get_entityId(),!$p0.get_autoSave()))},getFlyoutLayoutUrl:function(){return this._formData["_flyoutlayoutUrl"]},getFirstEnabledControlView:function(control){if(IsNull(control))return null;for(var $v_0=Mscrm.RefreshPageHandler.get_uiManager().controls,$v_1=0;$v_1<control.length;$v_1++){var $v_2=control.eq($v_1).children().first();if(!IsNull($v_2)&&!IsNull($v_2.attr("id"))){var $v_3=$v_0.get($v_2.attr("id"));if(!IsNull($v_3)&&$v_3.getVisible())if(!Mscrm.IFormUIControl.isInstanceOfType($v_3)||$v_3.isVisibleInTree())if(!Mscrm.IFormUIControl.isInstanceOfType($v_3)||$v_3.isVisibleInTree())if(!$v_3.get_disabled())return $v_3}}return null},saveAndNew:function(){var $v_0=this.$2Y_1(Xrm.SaveMode.saveAndNew);!IsNull($v_0)&&($v_0.get_success()||$v_0.get_code()===Mscrm.SaveResponseCode.saveCanceled)&&!$v_0.get_navigationCanceled()&&this.navigateToNewEntity()},$5I_1:function(){if(Mscrm.RefreshPageHandler.checkRefreshForm()){for(var $v_0=true,$v_1=Mscrm.RefreshPageHandler.$1Z(),$v_2=Mscrm.RefreshPageHandler.$28(),$v_3=0;$v_3<$v_1.length;$v_3++){var $v_4=$v_1[$v_3];if(IsNull($v_4))continue;if($v_4.get_id()===Mscrm.InlineEditDataService.get_formEntity().get_id())continue;if(!$v_4.get_isNew()){var $v_5=null,$v_6=$v_2[$v_4.get_id()];if(isNullOrEmptyString($v_6))continue;$v_5=Mscrm.InlineEditDataService.get_dataService().quickFormSaveData($v_6,false);if(!$v_5.get_success()){$v_0=false;break}}else if($v_4.get_isDirty()){$v_0=false;break}}return $v_0}return true},navigateToNewEntity:function(){Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.RefreshPageHandler.get_$c(),null,true)},save:function(){if(this.isRefreshForm()&&!(Mscrm.InlineEditDataService.get_busy()&&Mscrm.InlineEditDataService.isNew())){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();return Mscrm.InlineEditDataService.save(Xrm.SaveMode.save,Mscrm.RefreshPageHandler.$1j,this.$$d_$50_1,false)}return null},$2Y_1:function($p0){var $v_0=null;if(this.isRefreshForm()&&!(Mscrm.InlineEditDataService.get_busy()&&Mscrm.InlineEditDataService.isNew())){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();$v_0=Mscrm.InlineEditDataService.save($p0,null,null,true);if(!$v_0.get_success())return $v_0;raiseEvent(Mscrm.ScriptEvents.ReloadCommandBar,null,null);setAttributeInWindow("_primaryFieldValue",$v_0.get_recordName());setAttributeInWindow("_id",$v_0.get_recordId());Mscrm.InlineEditDataService.refreshGrid();if(Mscrm.InlineEditDataService.isNew()){var $v_1=Mscrm.InlineEditUtilities.getEntityReference(this._formData);$v_1.Id=$v_0.get_recordId();$v_1.Name=$v_0.get_recordName();Mscrm.InlineEditUtilities.addEntityToRecent($v_1)}try{if(this.$5I_1())Mscrm.RefreshPageHandler.$J=true}catch($$e_3){Mscrm.RefreshPageHandler.$J=false}return $v_0}return $v_0},saveAndClose:function(){var $v_0=this.$2Y_1(Xrm.SaveMode.saveAndClose);!IsNull($v_0)&&($v_0.get_success()||$v_0.get_code()===Mscrm.SaveResponseCode.saveCanceled)&&$v_0.get_code()!==Mscrm.SaveResponseCode.saveSpecial&&!$v_0.get_navigationCanceled()&&closeWindowScript()},$50_1:function($p0){Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.executeCallbacksAssociatedWithGlobalQuickCreate(Mscrm.GlobalQuickCreate.QuickCreateCallbackType.saveFail);return false},create:function(){if(this.isRefreshForm())var $v_0=this.save()},deleteRecord:function(){if(this.isRefreshForm()){var $v_0=Mscrm.InlineEditDataService.get_formEntity(),$v_1=$v_0.get_recordId(),$v_2={};$v_2["action"]="delete";$v_2["objectType"]=Mscrm.RefreshPageHandler.get_$c();$v_2["recordId"]=$v_1;Mscrm.InlineEditDataService.set_pageNavigation(true);Mscrm.FormAction.handleActionMenuClick($v_2)}},initializeDeleteRecordFlyout:function(){this._deleteFlyout=new Mscrm.FlyOutDialog;var $$t_3=this;this._deleteFlyout.bind(Mscrm.FlyOutDialogEventName.canceled,function($p1_0){$$t_3._deleteFlyoutVisible=false});var $$t_4=this;this._deleteFlyout.bind(Mscrm.FlyOutDialogEventName.confirmed,function($p1_0){$$t_4.$3R_1();$$t_4._deleteFlyoutVisible=false});var $$t_5=this;this._deleteFlyout.bind(Mscrm.FlyOutDialogEventName.visibleChanged,function($p1_0){$$t_5._deleteFlyoutVisible=false})},$3R_1:function(){var $$t_0=this;Mscrm.InlineEditDataService.deleteRecord(function(){window.UseTabletExperience&&Mscrm.InlineEditDataService.refreshGrid();Mscrm.Utilities.closeCurrentWindow();return true})},setDeleteFlyoutDialog:function(flyoutContent){var $v_0=$P_CRM("<div id='{0}' ></div>");$v_0.append(flyoutContent);this._deleteFlyout.setContent($v_0);this._deleteFlyout.set_position(Mscrm.FlyOutPosition.bottom);this._deleteFlyout.get_options().set_height(170);this._deleteFlyout.get_options().set_width(555);this._deleteFlyout.get_options().set_modal(true);this._deleteFlyout.get_options().set_showTitlePane(false)},activate:function(){if(this.isRefreshForm()){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();Mscrm.InlineEditDataService.activate("Active",this.$$d_$2f_1,null)}},$2f_1:function($p0){var $$t_2=this;window.setTimeout(function(){Mscrm.InlineEditDataService.refreshGridOnStateChange();var $v_0=Mscrm.RefreshPageHandler.getEntityIdFromPage();Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.RefreshPageHandler.get_$c(),$v_0)},1);return true},deactivate:function(){if(this.isRefreshForm()){Mscrm.InlineEditUtilities.tryResetFocusOnActiveControl();Mscrm.InlineEditDataService.deactivate("Inactive",-1,this.$$d_$3Q_1,null)}},$3Q_1:function($p0){var $$t_2=this;window.setTimeout(function(){Mscrm.InlineEditDataService.refreshGridOnStateChange();var $v_0=Mscrm.RefreshPageHandler.getEntityIdFromPage();Mscrm.ReadFormUtilities.openInSameFrame(Mscrm.RefreshPageHandler.get_$c(),$v_0)},1);return true},shareRecord:function(){this.isRefreshForm()&&this.launchContextualAction("share")},emailLink:function(){if(this.isRefreshForm()){var $v_0=Mscrm.RefreshPageHandler.get_uiManager(),$v_1=$v_0.get_formTitle(),$v_2=Mscrm.InlineEditDataService.get_formEntity(),$v_3=$v_2.get_recordId();Mscrm.FormAction.sendFormShortcut(true,CrmEncodeDecode.CrmHtmlDecode($v_1),$v_3,$v_2.get_typeName())}},launchContextualAction:function(formaction){if(this.isRefreshForm()){var $v_0=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_0)){var $v_1=$v_0.get_recordId(),$v_2={};$v_2["action"]=formaction;$v_2["objectType"]=Mscrm.RefreshPageHandler.get_$c();$v_2["recordId"]=$v_1;Mscrm.FormAction.handleActionMenuClick($v_2)}}},openFormEditor:function(){if(this.isRefreshForm()){var $v_0=Mscrm.InlineEditDataService.get_formId();Mscrm.FormEditor.OpenFormEditor(Mscrm.RefreshPageHandler.get_$c(),"main",$v_0,-1)}},isRefreshForm:function(){return Mscrm.RefreshPageHandler.checkRefreshForm()},follow:function(){Follow.FollowCommands.followFromForm(Mscrm.RefreshPageHandler.getEntityIdFromPage(),Mscrm.InlineEditDataService.get_formEntity().get_typeName(),Mscrm.RefreshPageHandler.$29())},unFollow:function(){Follow.FollowCommands.unfollowFromForm(Mscrm.RefreshPageHandler.getEntityIdFromPage(),Mscrm.InlineEditDataService.get_formEntity().get_typeName(),Mscrm.RefreshPageHandler.$29())},close:function(){if(this.isRefreshForm()){var $v_0=Mscrm.RefreshPageHandler.$1f();if($v_0)if(!confirm(window.LOCID_FORMS_SAVE_CONFIRM_TITLE))return;Mscrm.RefreshPageHandler.$2U(null);closeWindowScript()}},retrieveFlyoutLayout:function(){var $v_0=this.getFlyoutLayoutUrl(),$v_1=Mscrm.CrmUri.create($v_0);this._flyoutLayoutRequest=new XMLHttpRequest;this._flyoutLayoutRequest.open("GET",$v_1.toString(),false);this._flyoutLayoutRequest.onreadystatechange=this.$$d_retrieveFlyoutLayoutCallBack;this._flyoutLayoutRequest.send(null)},retrieveFlyoutLayoutCallBack:function(){Mscrm.Utilities.traceCurrentTime("RetrieveFlyoutLayoutCallBackEntry");Mscrm.RefreshPageHandler.$4x(this._flyoutLayoutRequest,this.$$d_processFlyoutLayout,false);Mscrm.Utilities.traceCurrentTime("RetrieveFlyoutLayoutCallBackExit")},processFlyoutLayout:function(){return},$s_1:null,$r_1:null,$2i_1:function(){Mscrm.Utilities.traceCurrentTime("AddHeadTileActionsEntry");var $v_0="ontouchend" in document;this.$r_1=$P_CRM("#HeaderTilesWrapperLayoutElement");this.$s_1=$P_CRM("#ms-crm-HeaderTilesTitleWrapperElement");var $v_1=$v_0?"touchstart":"mousedown",$v_2=$P_CRM("#headertile-expand-button");$v_2.on($v_1,this.$$d_$4J_1);var $v_3=$P_CRM("#headertile-collapse-button");$v_3.on($v_1,this.$$d_$4H_1);$P_CRM(window).on("navControlToggled",this.$$d_$4M_1);Mscrm.Utilities.traceCurrentTime("AddHeadTileActionsExit")},$4J_1:function($p0){this.$3a_1();this.$1s_1()},$4H_1:function($p0){this.$1r_1();this.$23_1()},$4M_1:function($p0){if(arguments.length<2)return;this.$1r_1();var $v_0=arguments[1];if($v_0)this.$23_1();else this.$1s_1()},$1r_1:function(){this.$r_1.removeClass("expanded");this.$r_1.addClass("collapsed")},$3a_1:function(){this.$r_1.removeClass("collapsed");this.$r_1.addClass("expanded")},$23_1:function(){this.$s_1.removeClass("collapsed");this.$s_1.addClass("expanded")},$1s_1:function(){this.$s_1.removeClass("expanded");this.$s_1.addClass("collapsed")},$1Q_1:0,$15_1:0,$5G_1:function($p0){$p0.preventDefault();var $v_0=$p0.originalEvent;this.$1Q_1=$v_0.pageX},$5E_1:function($p0){$p0.preventDefault();var $v_0=$p0.originalEvent;this.$15_1=$v_0.pageX},$5D_1:function($p0){$p0.preventDefault();if(this.$15_1<=0)return;var $v_0=Math.abs(this.$15_1-this.$1Q_1);$v_0>50&&this.$2l_1();this.$5F_1()},$5F_1:function(){this.$1Q_1=0;this.$15_1=0},$2l_1:function(){perfResults(true)}};Mscrm.ReadFormUtilities=function(){};Mscrm.ReadFormUtilities.openEditForm=function(){if(window.UseTabletExperience){var $v_0=Mscrm.MobileUtility.getMobileUrl(2,window._etn,window._id,true);Mscrm.ReadFormUtilities.$5B($v_0)}else{var $v_1=Mscrm.CrmUri.create(window.location.href);$v_1.get_query()["rof"]=false;if(Mscrm.ReadFormUtilities.isRefreshForm()){var $v_2=Mscrm.InlineEditDataService.get_formEntity();if(!IsNull($v_2)){var $v_3=$v_2.get_recordId();if($v_2.get_isCreateMode()&&$v_2.get_isDirty()){var $v_4=Mscrm.InlineEditDataService.get_dataService().saveData(Xrm.SaveMode.save,true);if(!$v_4.get_success())return;$v_3=$v_4.get_recordId()}if(!isNullOrEmptyString($v_3))$v_1.get_query()["id"]=$v_3}}try{window._switchingToClassic=true;window.location.href=$v_1.toString()}catch($$e_5){}}};Mscrm.ReadFormUtilities.keyDownHandler=function(eventArgs){Mscrm.RefreshPageHandler.keyDownHandler(eventArgs)};Mscrm.ReadFormUtilities.openLookup=function(resolved,domEvent){if(!IsNull(resolved))if(resolved)openlui(domEvent);else alert(window.LOCID_RO_UNSUPPORTED_ACTION)};Mscrm.ReadFormUtilities.onClickInlineMultiLookupItemReadMode=function(domEvent){var $v_0=domEvent.target;if(IsNull($v_0))return;if(domEvent.ctrlKey||Mscrm.ReadFormUtilities.isInlineMultipleLookupDeactivated($v_0)){var $v_1=$v_0.getAttribute("onCtrlClick");if(!IsNull($v_1)){var $v_2=$v_1.toString();if(Mscrm.Utilities.get_ieBrowserVersion()!==8)event=domEvent;eval(String.format($v_2))}domEvent.stopPropagation()}};Mscrm.ReadFormUtilities.isInlineMultipleLookupDeactivated=function(lookupItemSpan){if(!IsNull(lookupItemSpan)){var $v_0=lookupItemSpan.parentNode.parentNode,$v_1=$v_0.getAttribute(Mscrm.InlineEditConstants.HtmlAttributeForControlMode);if(!IsNull($v_1)&&$v_1.toString().trim()===Mscrm.InlineEditControlMode.deactivated)return true}return false};Mscrm.ReadFormUtilities.initializeReadForm=function(){Mscrm.ReadFormUtilities.$2=Mscrm.ReadFormUtilities.$3l();Mscrm.ReadFormUtilities.$2.initialize()};Mscrm.ReadFormUtilities.get_pageHandler=function(){return Mscrm.ReadFormUtilities.$2};Mscrm.ReadFormUtilities.removeOnBeforeUnloadHandler=function(){$removeHandler(window,"beforeunload",Mscrm.RefreshPageHandler.$1i)};Mscrm.ReadFormUtilities.handleUrlClick=function(urlElement){if(!IsNull(urlElement)){var $v_0=XUI.Html.DomUtils.GetFirstChild(urlElement).nodeValue;if(!IsNull($v_0)){$v_0=$v_0.trim();switch(validateUrlProtocol($v_0)){case 0:$v_0=Mscrm.ReadFormUtilities.$4h($v_0);break;case 1:break;default:return}var $v_1=Mscrm.CrmUri.createForOrganization($v_0,null);$v_1.checkParamsNoEqual=true;safeWindowOpen($v_1,"","height="+window.screen.availHeight*.75+",width="+window.screen.availWidth*.75+",scrollbars=1,resizable=1,status=1,toolbar=1,menubar=1,location=1",false,true)}}};Mscrm.ReadFormUtilities.handlePhoneNumberClick=function(phoneNumberElement){if(!IsNull(phoneNumberElement)){var $v_0=XUI.Html.DomUtils.GetFirstChild(phoneNumberElement).nodeValue;Mscrm.ReadFormUtilities.openPhoneClient($v_0)}};Mscrm.ReadFormUtilities.openPhoneClient=function(phoneNumber){var $v_0="ActivitiesTab";if(!IsNull(phoneNumber)){var $v_1=window.PHONE_NUMBER_DEFAULT_COUNTRY_CODE,$v_2=window.USE_SKYPE_PROTOCOL;Mscrm.Shortcuts.openPhoneWindow(phoneNumber,$v_1,$v_2.toString());if(!IsNull(Mscrm.ActivityContainerConstants)){var $v_3=Mscrm.ActivityContainerConstants.activityDivIdPrefix+Mscrm.ActivityContainerConstants.phoneCallEntityTypeCode.toString();if(!IsNull($get($v_3))){var $v_4=$find("notescontrol");$v_4&&$v_4.setActiveTab($v_0);Mscrm.ActivityContainer.focusOnPhoneActivity()}}}};Mscrm.ReadFormUtilities.$4h=function($p0){if(!$p0.toLowerCase().startsWith("http://")&&!$p0.toLowerCase().startsWith("https://"))$p0="http://"+$p0;return $p0};Mscrm.ReadFormUtilities.handleEmailAddressClick=function(addressElement){if(!IsNull(addressElement)){var $v_0=XUI.Html.DomUtils.GetFirstChild(addressElement).nodeValue;if(!IsNull($v_0)){var $v_1=new RegExp("^[0-9a-zA-Z._-]+@[0-9a-zA-Z._-]+\\.[a-zA-Z]{2,5}$");if(!$v_1.test($v_0))return;Mscrm.Shortcuts.openEmailForm($v_0,"","")}}};Mscrm.ReadFormUtilities.isTabVisible=function(tabId){var $v_0=true;if(!isNullOrEmptyString(tabId)){var $v_1=$get(tabId+"_content");if(!IsNull($v_1)&&!isNullOrEmptyString($v_1.style.display))$v_0=false}return $v_0};Mscrm.ReadFormUtilities.toggleTab=function(tabId){if(isNullOrEmptyString(tabId))return;if(!Mscrm.ReadFormUtilities.isTabVisible(tabId)){Mscrm.ReadFormUtilities.showTab(tabId);var $v_0=$P_CRM($get(tabId+"_Expander")),$v_1=$v_0.parents().first();$v_1.trigger("InlineTabStateChange",null)}else Mscrm.ReadFormUtilities.hideTab(tabId)};Mscrm.ReadFormUtilities.showTab=function(tabId){if(isNullOrEmptyString(tabId))return;Mscrm.ReadFormUtilities.$44()&&Mscrm.ReadFormUtilities.$5A();var $v_0=window.top.document.getElementById("crmRibbonManager");if(Mscrm.Utilities.isRefreshForm()){$v_0.style.visibility="visible";Mscrm.ReadFormUtilities.$3V()}var $v_1=tabId+"_content",$v_2=$get($v_1);Mscrm.ReadFormUtilities.$51($v_2);if(Mscrm.ReadFormUtilities.isTabVisible(tabId))return;$v_2.style.display="";$v_1=tabId+"_Expander";var $v_3=$get($v_1);$v_3.setAttribute("src","/_imgs/tab_section_down.png");$v_3.setAttribute("alt",window.LOCID_FORM_TABHEADER_COLLAPSE);$v_3.className="ms-crm-InlineTabExpander ms-crm-ImageStrip-tab_down";Mscrm.InlineEditCommonUtilities.setIFramesSourceUrls($v_2);!IsNull(Mscrm.ReadFormUtilities.$2)&&Mscrm.ReadFormControl.WebResourceImageControl.processImageWebResourcesForTab(tabId,Mscrm.ReadFormUtilities.$2.$Y_1["webResources"])};Mscrm.ReadFormUtilities.$44=function(){var $v_0=$P_CRM("div#areaForm").css("display");return $v_0==="none"};Mscrm.ReadFormUtilities.$5A=function(){var $v_0=Mscrm.ReadFormUtilities.getFormAreasContainer();XUI.Html.DomUtils.ForEachChild($v_0,function($p1_0){$P_CRM($p1_0).css("display","none");return false});$P_CRM("div#areaForm").css("display","");Mscrm.Details.currentArea=null};Mscrm.ReadFormUtilities.$3V=function(){var $v_0=$get("FormTitle");if(!IsNull($v_0)){var $v_1=XUI.Html.DomUtils.GetFirstChild($v_0);if(!IsNull($v_1)&&!IsNull($v_1.getAttribute("formTitleText"))){var $v_2=$v_1.getAttribute("formTitleText").toString();if(!isNullOrEmptyString($v_2)){$v_1.title=$v_2;$v_1.style.cursor="default"}}$clearHandlers($v_0);$v_0.style.cursor="default"}};Mscrm.ReadFormUtilities.getFormAreasContainer=function(){var $v_0=$get("tdAreas"),$v_1=XUI.Html.DomUtils.GetFirstChild($v_0);if($v_1.className==="ms-crm-IE7-Height-Fix-Dummy-Container-ReadForm")$v_0=$v_1;return $v_0};Mscrm.ReadFormUtilities.hideTab=function(tabId){if(isNullOrEmptyString(tabId))return;var $v_0=tabId+"_content",$v_1=$get($v_0);$v_1.style.display="none";$v_0=tabId+"_Expander";var $v_2=$get($v_0);$v_2.setAttribute("src","/_imgs/tab_section_right.png");$v_2.setAttribute("alt",window.LOCID_FORM_TABHEADER_EXPAND);$v_2.className="ms-crm-InlineTabExpander ms-crm-ImageStrip-tab_right"};Mscrm.ReadFormUtilities.$51=function($p0){var $v_0=Mscrm.InlineEditCommonUtilities.getTab($p0);if(!IsNull($v_0)){var $v_1=$v_0.parentNode;$v_1.scrollIntoView()}};Mscrm.ReadFormUtilities.showKBCheckBoxKeyDownHandler=function(eventArgs){switch(eventArgs.keyCode){case 32:if(Mscrm.Utilities.isFirefox())break;if(!Mscrm.ReadFormUtilities.isRefreshForm())break;if(IsNull(eventArgs.target))break;var $v_0=eventArgs.target.attributes.getNamedItem("onclick");!IsNull($v_0)&&!isNullOrEmptyString($v_0.value)&&eventArgs.target.click();break}};Mscrm.ReadFormUtilities.toggleArticleViewer=function(id){var $v_0=$get(id+"_d");if(!IsNull($v_0)){$v_0.style.height="auto";XUI.Html.DomUtils.GetChildElementAt($v_0,0).style.display=""}var $v_1=$get(id);if(!IsNull($v_1.getAttribute("url"))&&!$v_1.src.endsWith($v_1.getAttribute("url")))$v_1.src=$v_1.getAttribute("url");$v_1.style.display=$v_1.style.display==="none"?"inline":"none"};Mscrm.ReadFormUtilities.get_forceNavigationAway=function(){return Mscrm.RefreshPageHandler.$J};Mscrm.ReadFormUtilities.set_forceNavigationAway=function(value){Mscrm.RefreshPageHandler.$J=value;return value};Mscrm.ReadFormUtilities.launchProcessControlConfiguration=function(){Mscrm.ReadFormUtilities.execute(Mscrm.InlineCommands.LaunchProcessControlConfiguration)};Mscrm.ReadFormUtilities.execute=function(command){switch(command){case Mscrm.InlineCommands.Save:Mscrm.ReadFormUtilities.$2.save();break;case Mscrm.InlineCommands.DeleteRecord:Mscrm.ReadFormUtilities.$2.deleteRecord();break;case Mscrm.InlineCommands.Reactivate:Mscrm.ReadFormUtilities.$2.activate();break;case Mscrm.InlineCommands.Deactivate:Mscrm.ReadFormUtilities.$2.deactivate();break;case Mscrm.InlineCommands.LeadQualify:Mscrm.ReadFormUtilities.$2.qualify();break;case Mscrm.InlineCommands.LeadDisqualify:Mscrm.ReadFormUtilities.$2.disqualify();break;case Mscrm.InlineCommands.OpenEditForm:Mscrm.ReadFormUtilities.openEditForm();break;case Mscrm.InlineCommands.SaveAndNew:Mscrm.ReadFormUtilities.$2.saveAndNew();break;case Mscrm.InlineCommands.CreateChild:var $v_0=new RemoteCommand("CustomerService","GetEntityQuickCreateOption");$v_0.SetParameter("entityCode",Mscrm.InternalUtilities.EntityTypeCode.Incident);var $v_1=$v_0.Execute(),$v_2=false;if($v_1&&$v_1.Success)$v_2=$v_1.ReturnValue;var $v_3=$find(Mscrm.ClientApiConstants.primaryEntityId),$v_4=$v_3.get_recordId(),$v_5=Mscrm.EntityPropUtil.EntityTypeName2CodeMap[$v_3.get_typeName()];if($v_2){var $v_6=1e3,$v_7=new Mscrm.GlobalQuickCreate.CreateChildCaseGlobalQuickCreateCallbacks("NavBarGloablQuickCreate",$v_6,Mscrm.ReadFormUtilities.$3o);Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.launchGlobalQuickCreate($v_7,window.INCIDENT_DISPLAYNAME,Mscrm.EntityTypeCode.Incident,null,$v_4,$v_5)}else{var $v_8="_CreateFromId="+$v_4;$v_8+="&_CreateFromType="+$v_5;openObj(Mscrm.EntityTypeCode.Incident,null,$v_8)}break;case Mscrm.InlineCommands.LoadHelp:loadHelp();break;case Mscrm.InlineCommands.OpportunityCloseAsWon:Mscrm.ReadFormUtilities.$2.closeAsWon();break;case Mscrm.InlineCommands.OpportunityCloseAsLost:Mscrm.ReadFormUtilities.$2.closeAsLost();break;case Mscrm.InlineCommands.OpportunityReopen:Mscrm.ReadFormUtilities.$2.reOpen();break;case Mscrm.InlineCommands.OpportunityAddRelatedQuote:Mscrm.ReadFormUtilities.$2.addRelatedQuote();break;case Mscrm.InlineCommands.OpportunityAddRelatedOrder:Mscrm.ReadFormUtilities.$2.addRelatedOrder();break;case Mscrm.InlineCommands.OpportunityAddRelatedInvoice:Mscrm.ReadFormUtilities.$2.addRelatedInvoice();break;case Mscrm.InlineCommands.ShareRecord:Mscrm.ReadFormUtilities.$2.shareRecord();break;case Mscrm.InlineCommands.EmailLink:Mscrm.ReadFormUtilities.$2.emailLink();break;case Mscrm.InlineCommands.FormEditor:Mscrm.ReadFormUtilities.$2.openFormEditor();break;case Mscrm.InlineCommands.Follow:Mscrm.ReadFormUtilities.$2.follow();break;case Mscrm.InlineCommands.UNFollow:Mscrm.ReadFormUtilities.$2.unFollow();break;case Mscrm.InlineCommands.LaunchProcessControlConfiguration:if(Mscrm.ILeadCommandBarHandler.isInstanceOfType(Mscrm.ReadFormUtilities.$2)){Mscrm.MetricsReporting.instance().addMetric("Sales Process Configurator","Launched from Lead");Mscrm.ReadFormUtilities.$2.launchProcessControlConfiguration()}else if(Mscrm.IOpportunityCommandBarHandler.isInstanceOfType(Mscrm.ReadFormUtilities.$2)){Mscrm.MetricsReporting.instance().addMetric("Sales Process Configurator","Launched from Opportunity");Mscrm.ReadFormUtilities.$2.launchProcessControlConfiguration()}else if(Mscrm.IIncidentCommandBarHandler.isInstanceOfType(Mscrm.ReadFormUtilities.$2)){Mscrm.MetricsReporting.instance().addMetric("Sales Process Configurator","Launched from Incident");Mscrm.ReadFormUtilities.$2.launchProcessControlConfiguration()}break;case Mscrm.InlineCommands.SwitchProcess:Mscrm.RefreshPageHandler.switchProcess();break;case Mscrm.InlineCommands.Create:Mscrm.ReadFormUtilities.$2.create();break;case Mscrm.InlineCommands.Close:Mscrm.ReadFormUtilities.$2.close();break;default:break}return};Mscrm.ReadFormUtilities.openInSameFrame=function(objectTypeCode,entityId,readOnlyForm){var $v_0=null;if(!IsNull(readOnlyForm))$v_0="rof="+readOnlyForm;$v_0+=Mscrm.ReadFormUtilities.$2B(objectTypeCode);Mscrm.ReadFormUtilities.isRefreshForm()&&Mscrm.InlineEditDataService.set_pageNavigation(true);openObj(objectTypeCode,entityId,$v_0)};Mscrm.ReadFormUtilities.$2B=function($p0){var $v_0="",$v_1=Xrm.Page.context.getQueryStringParameters();if(!IsNull($v_1)){var $v_2=$v_1["_CreateFromId"],$v_3=$v_1["_CreateFromType"];if(!isNullOrEmptyString($v_2)&&!isNullOrEmptyString($v_3))if(Mscrm.EntityPropUtil.isActivityTypeCode($p0)&&Mscrm.EntityTypeCode.Incident!==$p0){$v_0+="&pId="+$v_2;$v_0+="&pType="+$v_3}else{$v_0+="&_CreateFromId="+$v_2;$v_0+="&_CreateFromType="+$v_3}else if(Mscrm.EntityPropUtil.isActivityTypeCode($p0))$v_0+=Mscrm.ReadFormUtilities.$3f($v_1)}return $v_0};Mscrm.ReadFormUtilities.$3f=function($p0){var $v_0="",$v_1=$p0["pId"],$v_2=$p0["pName"],$v_3=$p0["pType"];if(!isNullOrEmptyString($v_1)&&!isNullOrEmptyString($v_3)){$v_0+="&pId="+$v_1;if(!IsNull($v_2))$v_0+="&pName"+$v_2;$v_0+="&pType="+$v_3}return $v_0};Mscrm.ReadFormUtilities.forceReload=function(objectTypeCode,entityId,formId){if(!isNullOrEmptyString(entityId)&&!isNullOrEmptyString(formId)){Mscrm.RefreshPageHandler.$J=true;reloadReadForm(objectTypeCode,entityId,formId,false)}};Mscrm.ReadFormUtilities.hideProgressIndicator=function(){var $v_0=$get("containerLoadingProgress");if(!IsNull($v_0))$v_0.style.display="none"};Mscrm.ReadFormUtilities.refreshGridAndForm=function(objectTypeCode,entityId){Mscrm.ReadFormUtilities.openInSameFrame(objectTypeCode,entityId);window.setTimeout(Mscrm.InlineEditDataService.refreshGrid,1)};Mscrm.ReadFormUtilities.$3o=function($p0){refreshGrid(Mscrm.CreateChildCaseConstants.childCasesGrid)};Mscrm.ReadFormUtilities.addImageToControl=function(control,image){if(!IsNull(control))if(!IsNull(image)){control.set_labelIcon(image);return true}return false};Mscrm.ReadFormUtilities.addIconToControl=function(control,attributeFormat){if(!IsNull(control)){var $v_0=null;switch(attributeFormat){case Mscrm.AttributeFormat.email:$v_0="/_imgs/refreshCommandBar/EmailLink_16.png";break;case Mscrm.AttributeFormat.phone:$v_0="/_imgs/Phone_16.png";break;default:break}return Mscrm.ReadFormUtilities.addImageToControl(control,$v_0)}return false};Mscrm.ReadFormUtilities.showCustomerCard=function(card){if(!IsNull(card)){card.addClass("ms-crm-CustomerQf");var $v_0=card.find("div.ms-crm-FormSection-Container").first();if(!IsNull($v_0)){$v_0.addClass("ms-crm-CustomerDetails");$v_0.next().addClass("ms-crm-CustomerTable")}card.parents("tr").first().show()}};Mscrm.ReadFormUtilities.hideCustomerCard=function(card){!IsNull(card)&&card.parents("tr").first().hide()};Mscrm.ReadFormUtilities.overrideQuickFormTableSettings=function(tableElement){if(!IsNull(tableElement)){var $v_0=tableElement.find("td").first();$v_0.addClass("ms-crm-CustomerTableReadonly")}};Mscrm.ReadFormUtilities.quickFormSaveDataForContact=function(linkControl){var $v_0=Mscrm.QuickFormBehavior.getBehaviorById("985d2950-2f4c-4a9e-876c-4b2c364561fa");Mscrm.ReadFormUtilities.$d=linkControl;if(!IsNull($v_0)){$v_0.add_successEvent(Mscrm.ReadFormUtilities.$1U);var $v_1=$v_0.save();if(Mscrm.SaveResponseCode.saveSuccessfullyInitiated!==$v_1.get_code()){$v_0.remove_successEvent(Mscrm.ReadFormUtilities.$1U);Mscrm.ReadFormUtilities.$d.get_flyOutDialog().set_hideFlyOutOnConfirmClick(false)}else Mscrm.ReadFormUtilities.$d.get_flyOutDialog().set_hideFlyOutOnConfirmClick(true)}};Mscrm.ReadFormUtilities.quickFormClearDataForContact=function(){var $v_0=Mscrm.QuickFormBehavior.getBehaviorById("985d2950-2f4c-4a9e-876c-4b2c364561fa");!IsNull($v_0)&&$v_0.clear()};Mscrm.ReadFormUtilities.$1U=function($p0,$p1){Mscrm.QuickFormBehavior.getBehaviorById($p1.get_uniqueId()).remove_successEvent(Mscrm.ReadFormUtilities.$1U);var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId),$v_1=$v_0.get_attributes().get("customerid");if(!IsNull($v_1)){var $v_2=Mscrm.ReadFormUtilities.$3k($p1.get_entityReference());if(!IsNull(Mscrm.ReadFormUtilities.$d)&&!isNullOrEmptyString(Mscrm.ReadFormUtilities.$d.get_hostId())){var $v_3=Mscrm.FormControlInputBehavior.GetBehavior(Mscrm.ReadFormUtilities.$d.get_hostId());!IsNull($v_3)&&$v_3.get_view().get_editView().discard(false)}$v_1.set_value($v_2);$v_1.fireOnChange()}};Mscrm.ReadFormUtilities.$3k=function($p0){var $v_0=[],$v_1={};$v_1["id"]=$p0.Id;$v_1["entityType"]=$p0.TypeName;$v_1["name"]=$p0.Name;$v_0[0]=$v_1;return $v_0};Mscrm.ReadFormUtilities.$3l=function(){var $v_0=null;if(Mscrm.ReadFormUtilities.isRefreshForm()){var $v_1=_etn;switch($v_1){case Mscrm.EntityLogicalNames.Account:if(window.UseTabletExperience)$v_0=new Mscrm.AccountPageHandler;break;case Mscrm.EntityLogicalNames.CampaignActivity:$v_0=new Mscrm.CampaignActivityPageHandler;break;case Mscrm.EntityLogicalNames.Campaign:$v_0=new Mscrm.CampaignPageHandler;break;case Mscrm.EntityLogicalNames.Contact:if(window.UseTabletExperience)$v_0=new Mscrm.ContactPageHandler;break;case Mscrm.EntityLogicalNames.ContractDetail:$v_0=new Mscrm.ContractDetailRefreshPageHandler;break;case Mscrm.EntityLogicalNames.Incident:$v_0=new Mscrm.IncidentPageHandler;break;case Mscrm.EntityLogicalNames.Lead:$v_0=new Mscrm.LeadPageHandler;break;case Mscrm.EntityLogicalNames.Opportunity:$v_0=new Mscrm.OpportunityPageHandler;break;case Mscrm.EntityLogicalNames.Quote:$v_0=new Mscrm.QuotePageHandler;break;case Mscrm.EntityLogicalNames.SystemUser:$v_0=new Mscrm.SystemUserPageHandler;break;case Mscrm.EntityLogicalNames.Queue:$v_0=new Mscrm.QueuePageHandler;break;case Mscrm.EntityLogicalNames.Sla:$v_0=new Mscrm.SlaPageHandler;break;default:$v_0=new Mscrm.RefreshPageHandler;break}}if(!$v_0)$v_0=new Mscrm.RefreshPageHandler;Mscrm.RefreshPageHandler.$Z=$v_0;return $v_0};Mscrm.ReadFormUtilities.isRefreshForm=function(){return Mscrm.Utilities.isRefreshForm()};Mscrm.ReadFormUtilities.promptOnClose=function(){return Mscrm.RefreshPageHandler.$1f()};Mscrm.ReadFormUtilities.resetParameters=function(){Mscrm.RefreshPageHandler.$2T()};Mscrm.ReadFormUtilities.$5B=function($p0){$p0.setQueryParameter("aste","true");var $v_0=$get("rofContainer");$v_0.style.position="absolute";var $v_1=window.document.createElement("div");$v_1.id="inlineMEEdit";$v_1.style.top="40px";$v_1.style.left="85px";$v_1.style.zIndex=3e3;$v_1.style.position="absolute";$v_1.style.overflowY="auto";var $v_2=window.top.document.createElement("iframe");$v_2.id="inlineMEFrame";$v_2.src=Mscrm.CrmUri.create($p0.toString()).toString();$v_2.style.width=400+"px";$v_2.style.height=600+"px";$v_2.style.borderWidth="1px";$v_2.style.borderColor="#D6D6D6";$v_2.style.borderStyle="solid";$v_1.appendChild($v_2);window.top.document.body.appendChild($v_1);var $v_3=window.top.document.createElement("div");$v_3.id="backDiv";$v_3.style.position="absolute";$v_3.style.top="0";$v_3.style.left="0";$v_3.style.zIndex=$v_1.style.zIndex-1;$v_3.style.width=window.top.document.body.clientWidth.toString()+"px";$v_3.style.height=window.top.document.body.clientHeight.toString()+"px";XUI.Html.SetOpacity($v_3,.5);$v_3.style.backgroundColor="gray";window.top.document.body.appendChild($v_3);$addHandler($v_3,"orientationchange",Mscrm.ReadFormUtilities.$4Y);$addHandler($v_3,"touchstart",Mscrm.FloatingDialog.stopTouchMoveEvents);$addHandler($v_3,"touchmove",Mscrm.FloatingDialog.stopTouchMoveEvents);$addHandler(window.top,"focus",Mscrm.ReadFormUtilities.maintainInlineMEFocus)};Mscrm.ReadFormUtilities.$4Y=function($p0){var $v_0=$get("backDiv");if(!IsNull($v_0)){$v_0.style.width=window.top.document.body.clientWidth.toString()+"px";$v_0.style.height=window.top.document.body.clientHeight.toString()+"px"}};Mscrm.ReadFormUtilities.maintainInlineMEFocus=function(eventArgs){var $v_0=window.top.document.getElementById("inlineMEFrame");!IsNull($v_0)&&!IsNull($v_0.contentWindow.focus)&&window.setTimeout(function(){$v_0.contentWindow.focus()},0)};function OpenItemForceSubmit(){var $v_0=XUI.Html.CreateDomEvent("Event");openlui(new Sys.UI.DomEvent($v_0))}function prepareForEmbeddedEditClose(embeddedWindow){$addHandler(embeddedWindow.frameElement,"load",$2D)}function $2D($p0){var $v_0=$p0.target;$removeHandler($v_0,"load",$2D);disposeInlineME();var $v_1=$v_0.contentWindow.RenderMode;$v_1==="read"&&window.location.reload(true)}function disposeInlineME(){$removeHandler(window.top,"focus",Mscrm.ReadFormUtilities.maintainInlineMEFocus)}Mscrm.RefreshPageScriptReference=function(){};Mscrm.RefreshPageScriptReference.prototype={order:0,scriptUri:null,scriptElement:null};Mscrm.RefreshPageHeader=function(){this.$1l_0=$P_CRM("head");this.$o_0=new Sys.EventHandlerList};Mscrm.RefreshPageHeader.get_instance=function(){return Mscrm.RefreshPageHeader.$Z||(Mscrm.RefreshPageHeader.$Z=new Mscrm.RefreshPageHeader)};Mscrm.RefreshPageHeader.prototype={$m_0:null,$1G_0:0,$Y_0:null,get_$K_0:function(){return this.$Y_0["header"]},loadScriptsUsingAjax:function($p0){this.$m_0=new Array($p0.length);this.$1G_0=0;for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=new Mscrm.RefreshPageScriptReference;$v_1.scriptUri=$p0[$v_0];$v_1.order=$v_0;var $v_2=new jQueryAjaxOptions,$$t_F=this;$v_2.success=function($p1_0,$p1_1,$p1_2){var $v_3=null;$v_3=this;var $v_4=$p1_0.toString(),$v_5=$$t_F.$3P_0($v_3,$v_4);$v_3.scriptElement=$v_5;$$t_F.$m_0[$v_3.order]=$v_3;++$$t_F.$1G_0;if($$t_F.$1G_0===$$t_F.$m_0.length){$$t_F.$2k_0($$t_F.$m_0);$$t_F.$m_0=null}};var $$t_G=this;$v_2.error=function($p1_0,$p1_1,$p1_2){if($p1_0.readyState&&!IsNull($p1_2)){var $v_6=null;$v_6=this;var $v_7=IsNull($p1_1)?"Error:":$p1_1;if(!IsNull($v_6))$v_7=String.format("{0} : {1}",$p1_1,$v_6.scriptUri.get_path());catchError($v_7,window.location.href,0,true)}};$v_2.url=$v_1.scriptUri.toString();$v_2.dataType="text";$v_2.context=$P_CRM($v_1).get(0);$P_CRM.ajax($v_2)}},$3P_0:function($p0,$p1){var $v_0=$P_CRM("<script>");$v_0.attr("type","text/javascript");var $v_1=!IsNull($p0.scriptUri);if(!$v_1);!IsNull($p0.scriptUri)&&!isNullOrEmptyString($p0.scriptUri.toString())&&$v_0.attr("id",$p0.scriptUri.toString());var $v_2=String.format("//@ sourceURL={0}",$p0.scriptUri);$p1+=$v_2;$v_0.get(0).text=$p1;return $v_0},$2k_0:function($p0){for(var $v_0=0;$v_0<$p0.length;$v_0++){var $v_1=$p0[$v_0];if($v_1.order!==$v_0);this.executeScriptInGlobalContext($v_1)}this.fireEvent("ScriptLoaded",new Sys.EventArgs)},executeScriptInGlobalContext:function($p0){if($P_CRM.browser.msie)this.$1l_0.append($p0.scriptElement);else{var $v_0=$p0.scriptElement.text();window.setTimeout($v_0,0)}},dispose:function(){Mscrm.Utilities.destroyObject(this.$o_0);Mscrm.Utilities.destroyObject(this)},get_jQueryTemplates:function(){return this.get_$K_0().JQueryTemplates},get_clientVariables:function(){return this.get_$K_0().ClientVariables},get_wrpcTokens:function(){return this.get_$K_0().WrpcTokens},get_scriptBlocks:function(){return this.get_$K_0().ScriptBlocks},get_scriptBlocksOnLoad:function(){return this.get_$K_0().ScriptBlocksOnLoad},get_styleIncludes:function(){return this.get_$K_0().StyleIncludes},get_scriptIncludes:function(){return this.get_$K_0().ScriptIncludes},get_tokenTimestamp:function(){return this.get_$K_0().TokenTimestamp},get_applicationInitStatements:function(){return this.get_$K_0().ApplicationInitStatements},get_applicationInitDeferredStatements:function(){return this.get_$K_0().ApplicationInitDeferredStatements},get_formLayoutTemplate:function(){return this.$Y_0},set_formLayoutTemplate:function($p0){this.$Y_0=$p0;return $p0},add_scriptLoaded:function($p0){this.$o_0.addHandler("ScriptLoaded",$p0)},remove_scriptLoaded:function($p0){this.$o_0.removeHandler("ScriptLoaded",$p0)},setStyleSheet:function($p0){Mscrm.CrmHeader.setStyleSheet($p0)},setStyleSheetString:function($p0){Mscrm.CrmHeader.setStyleSheetString($p0)},fireEvent:function($p0,$p1){var $v_0=this.$o_0.getHandler($p0);!IsNull($v_0)&&$v_0(this,$p1)}};Mscrm.SalesOrderPageHandler=function(){this.$$d_$2P_1=Function.createDelegate(this,this.$2P_1);this.$$d_$4m_1=Function.createDelegate(this,this.$4m_1);Mscrm.SalesOrderPageHandler.initializeBase(this)};Mscrm.SalesOrderPageHandler.prototype={$E_1:null,get_commandSucceedCallback:function(){return this.$E_1},set_commandSucceedCallback:function($p0){this.$E_1=$p0;return $p0},buildCommandXml:function(){switch(this.$H_0){case Mscrm.InlineCommands.OrderCancelOrder:case Mscrm.InlineCommands.OrderFulfillOrder:return this.$3K_1();case Mscrm.InlineCommands.SalesOrderGetProducts:return this.$1V_1();case Mscrm.InlineCommands.OrderProcessOrder:this.$E_1=this.$$d_$4m_1;return this.createCommandWithDefaultParameter();case Mscrm.InlineCommands.RecalculateRecord:this.$E_1=this.$$d_$2P_1;return this.createCommandWithDefaultParameter();default:return this.createCommandWithDefaultParameter()}},$1V_1:function(){var $v_0=this.$1_0["OpportunityID"],$v_1="",$v_2="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><gpOpportunityId>{3}</gpOpportunityId><dataxml>{4}</dataxml></Input>";$v_1=String.format($v_2,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_1},$3K_1:function(){var $v_0=this.$1_0["newStatus"],$v_1=this.$1_0["CloseDate"],$v_2=this.$1_0["Description"],$v_3="",$v_4="<Input><id>{0}</id><name>{1}</name><formId>{2}</formId><newStatusCode>{3}</newStatusCode><closeDate>{4}</closeDate><description>{5}</description><commandType>{6}</commandType><dataxml>{7}</dataxml></Input>";$v_3=String.format($v_4,CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_recordId()),CrmEncodeDecode.CrmXmlEncode(this.get_primaryEntity().get_typeName()),CrmEncodeDecode.CrmXmlEncode(Mscrm.InlineEditDataService.get_formId()),CrmEncodeDecode.CrmXmlEncode($v_0),CrmEncodeDecode.CrmXmlEncode($v_1),CrmEncodeDecode.CrmXmlEncode($v_2),CrmEncodeDecode.CrmXmlEncode(this.$H_0.toString()),CrmEncodeDecode.CrmXmlEncode(this.$7_0));return $v_3},$4m_1:function($p0){var $v_0=Mscrm.InlineEditUtilities.getEntityReference($p0);if(!IsNull($v_0))if(Mscrm.EntityLogicalNames.Invoice===$v_0.TypeName)Xrm.Utility.openEntityForm(Mscrm.EntityLogicalNames.Invoice,$v_0.Id,null);else Mscrm.ReadFormUtilities.forceReload($v_0.TypeCode,$v_0.Id,Mscrm.InlineEditDataService.get_formId());Mscrm.InlineEditDataService.refreshGridOnStateChange();return true},$2P_1:function($p0){return false}};Mscrm.SlaPageHandler=function(){this.$$d_$4f_2=Function.createDelegate(this,this.$4f_2);Mscrm.SlaPageHandler.initializeBase(this)};Mscrm.SlaPageHandler.$5C=function(){var $v_0="applicablefrompicklist";Mscrm.SlaPageHandler.$W=new Mscrm.SlaContainer;var $v_1=Mscrm.SlaPageHandler.$W.get_applicableFromPicklist();$v_1.set_requiredLevel(2);var $v_2=$get($v_0+"_c"),$v_3=!IsNull($v_2)?XUI.Html.DomUtils.GetFirstChild($v_2):null;!IsNull($v_3)&&Mscrm.Form.setFieldRequiredOrRecommended($v_3.parentNode,2,window.LOCID_FORM_REQUIRED_ALT)};Mscrm.SlaPageHandler.prototype={postPartialInlineInitialization:function($p0){Mscrm.RefreshPageHandler.prototype.postPartialInlineInitialization.call(this,$p0)},postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);if(this.isRefreshForm()){this.$1w_2();this.$4b_2();Mscrm.SlaPageHandler.$5C()}},postPageRender:function(){Mscrm.RefreshPageHandler.prototype.postPageRender.call(this);this.isRefreshForm()&&Mscrm.InlineEditDataService.get_dataService().add_formRefreshed(this.$$d_$4f_2)},$4f_2:function($p0,$p1){$p1.get_command()===Mscrm.InlineCommands.Save&&this.$1w_2();!isNullOrEmptyString($p1.get_entityReference().Id)&&Mscrm.InlineEditDataService.get_dataService().remove_formRefreshed(this.$$d_$4f_2)},$4b_2:function(){Mscrm.SlaPageHandler.$W=new Mscrm.SlaContainer;var $v_0=null,$v_1=null;$v_0=new RemoteCommand("CustomerService","RetrieveAttributeList");$v_1=$v_0.Execute();if($v_1.Success){var $v_2=XUI.Xml.LoadXml($v_1.ReturnValue),$v_3=Mscrm.SlaPageHandler.$W.get_applicableFromPicklist(),$v_4=Mscrm.SlaPageHandler.$W.get_applicableFromPicklistAttribute();if(IsNull($v_3)||IsNull($v_4))return;$v_3.set_doNotSubmit(true);$v_4.set_submitModeValue(Xrm.SubmitMode.never);$v_4.set_isNumberCheckRequired(false);for(var $v_5=XUI.Xml.SelectNodes($v_2,"defaultdata/options/option",null),$v_6=[],$v_9=0;$v_9<$v_5.length;$v_9++){var $v_A=$v_5[$v_9],$v_B=this.$3g_2($v_A,"value"),$v_C=new Mscrm.FormInputControl.PicklistOption(XUI.Xml.GetText($v_A),$v_B);$v_6[$v_9]=$v_C}$v_3.set_options($v_6);$v_3.get_element().setAttribute("size",$v_6.length.toString());var $v_7=Mscrm.InlineEditDataService.get_formEntity(),$v_8=$v_7.get_attributes().get("applicablefrom");$v_4.loadOptionsFromSelectControl($v_3.get_element());!IsNull($v_6[0])&&$v_4.set_value($v_6[0].DataValue);if(IsNull($v_8.get_value()))$v_8.set_value($v_6[0].DataValue);else for(var $v_D=0;$v_D<$v_6.length;$v_D++)if($v_6[$v_D].DataValue.toString()===$v_8.get_value().toString()){$v_4.set_value($v_6[$v_D].DataValue);$v_3.set_disabled(true)}$v_4.fireOnChange()}else Mscrm.ErrorStatusControl.showError(window.LOCID_GENERIC_MESSAGE)},$3g_2:function($p0,$p1){var $v_0=null;if(!IsNull($p0))if($p0.attributes.getNamedItem($p1))$v_0=$p0.attributes.getNamedItem($p1).nodeValue;return $v_0},$1w_2:function(){Mscrm.SlaPageHandler.$W=new Mscrm.SlaContainer;var $v_0=Mscrm.SlaPageHandler.$W.get_applicableFromPicklist(),$v_1=Xrm.Page.data.entity.attributes.get("applicablefrom").getValue();if(IsNull($v_1)||!$v_1.length)return;else{$v_0.set_dataValue($v_1);Xrm.Page.ui.controls.get("applicablefrompicklist").setDisabled(true)}}};Mscrm.SlaContainer=function(){};Mscrm.SlaContainer.prototype={$13_0:null,$14_0:null,get_applicableFromPicklist:function(){if(IsNull(this.get_applicableFromPicklistAttribute()))return null;if(!IsNull(this.$13_0))return this.$13_0;var $v_0=Xrm.Page.ui.controls.get("applicablefrompicklist");this.$13_0=Mscrm.FormControlInputBehavior.GetBehavior($v_0.get_editView().get_editElementId());return this.$13_0},get_applicableFromPicklistAttribute:function(){if(!IsNull(this.$14_0))return this.$14_0;var $v_0=$find(Mscrm.ClientApiConstants.primaryEntityId);this.$14_0=$v_0.get_attributes().get("applicablefrompicklist");return this.$14_0}};Mscrm.SystemUserPageHandler=function(){Mscrm.SystemUserPageHandler.initializeBase(this)};Mscrm.SystemUserPageHandler.$1W=function($p0){var $v_0=$p0.getControlType();$v_0!==Mscrm.FormControlClientApiType.iFrame&&$v_0!==Mscrm.FormControlClientApiType.webResource&&$v_0!==Mscrm.FormControlClientApiType.subGrid&&$p0.setDisabled(true)};Mscrm.SystemUserPageHandler.$k=function($p0){var $v_0=Xrm.Page.ui.controls.get($p0);!IsNull($v_0)&&Mscrm.SystemUserPageHandler.$1W($v_0)};Mscrm.SystemUserPageHandler.$z=function($p0,$p1){$p0.removeOption($p1)};Mscrm.SystemUserPageHandler.prototype={postInlineInitialization:function(){Mscrm.RefreshPageHandler.prototype.postInlineInitialization.call(this);this.$4N_2()},$3S_2:function(){var $$t_2=this;Xrm.Page.ui.controls.forEach(function($p1_0,$p1_1){Mscrm.SystemUserPageHandler.$1W($p1_0)})},$4N_2:function(){if(window.IS_LIVE&&window._bIsOsdpOrg)if(window._bIsNewEntity)this.$3S_2();else if(!IsNull(window._bDisableProperties))for(var $v_1=window._bDisableProperties.split(";"),$$arr_1=$v_1,$$len_2=$$arr_1.length,$$idx_3=0;$$idx_3<$$len_2;++$$idx_3){var $v_2=$$arr_1[$$idx_3];Mscrm.SystemUserPageHandler.$k($v_2);$v_2==="firstname"&&Mscrm.SystemUserPageHandler.$k("fullname");$v_2==="address1_country"&&Mscrm.SystemUserPageHandler.$k("address1_composite")}else{Mscrm.SystemUserPageHandler.$k("domainname");Mscrm.SystemUserPageHandler.$k("windowsliveid")}var $v_0=Xrm.Page.ui.controls.get("accessmode");if($v_0)if(window.IS_LIVE){Mscrm.SystemUserPageHandler.$z($v_0,2);var $v_3=Xrm.Page.data.entity.attributes.get("accessmode");if(!IsNull($v_3)&&$v_3.getValue()!==3)Mscrm.SystemUserPageHandler.$z($v_0,3);else Mscrm.SystemUserPageHandler.$1W($v_0)}else{Mscrm.SystemUserPageHandler.$z($v_0,3);Mscrm.SystemUserPageHandler.$z($v_0,4);window._bAccessNotReadOnly&&Mscrm.SystemUserPageHandler.$z($v_0,2)}window.IS_LIVE&&Mscrm.SystemUserPageHandler.$k("setupuser")}};Mscrm.SystemUserPageHandler.SystemUserAccessMode=function(){};Mscrm.SystemUserPageHandler.SystemUserAccessMode.prototype={readWrite:0,administrative:1,readOnly:2,supportUser:3,nonInteractive:4};Mscrm.SystemUserPageHandler.SystemUserAccessMode.registerEnum("Mscrm.SystemUserPageHandler.SystemUserAccessMode",false);Type.registerNamespace("Mscrm.ReadFormControl");Mscrm.ReadFormControl.WebResourceImageControl=function(){};Mscrm.ReadFormControl.WebResourceImageControl.processImageWebResourcesForTab=function(tabId,webResourcesInfo){if(!IsNull(webResourcesInfo))for(var $v_0=0;$v_0<webResourcesInfo.length;$v_0++){var $v_1=webResourcesInfo[$v_0].tabId;if((isNullOrEmptyString(tabId)||$v_1===tabId)&&Mscrm.ReadFormUtilities.isTabVisible($v_1)){var $v_2=$get(webResourcesInfo[$v_0].id);if(!IsNull($v_2))if($v_2.clientHeight>0)Mscrm.ReadFormControl.WebResourceImageControl.$2X($v_2);else $addHandler($v_2,"load",Mscrm.ReadFormControl.WebResourceImageControl.$2G)}}};Mscrm.ReadFormControl.WebResourceImageControl.$2G=function($p0){var $v_0=$p0.target;Mscrm.ReadFormControl.WebResourceImageControl.$2X($v_0);$removeHandler($v_0,"load",Mscrm.ReadFormControl.WebResourceImageControl.$2G)};Mscrm.ReadFormControl.WebResourceImageControl.$2X=function($p0){Mscrm.Utilities.processImageWebResource($p0);var $v_0=$p0.attributes.getNamedItem("resizeMode").value;switch($v_0){case Mscrm.WebResourceConstants.sizeModeSpecific:$p0.parentNode.parentNode.style.height=$p0.style.height;break;case Mscrm.WebResourceConstants.sizeModeStretchMaintainAspectRatio:break;case Mscrm.WebResourceConstants.sizeModeStretchToFit:default:$p0.parentNode.parentNode.style.height="";break}};Mscrm.RefreshPageCommand.registerClass("Mscrm.RefreshPageCommand",null,Mscrm.IEntityCommand);Mscrm.RefreshPageHandler.registerClass("Mscrm.RefreshPageHandler",Mscrm.RefreshPageCommand,Mscrm.IPageHandler,Mscrm.ICommandBarHandler);Mscrm.AccountPageHandler.registerClass("Mscrm.AccountPageHandler",Mscrm.RefreshPageHandler,Mscrm.ICommandBarHandler);Mscrm.CampaignResponsePageHandler.registerClass("Mscrm.CampaignResponsePageHandler");Mscrm.CommonActivityPageHandler.registerClass("Mscrm.CommonActivityPageHandler");Mscrm.ContactPageHandler.registerClass("Mscrm.ContactPageHandler",Mscrm.RefreshPageHandler,Mscrm.ICommandBarHandler);Mscrm.ContractDetailRefreshPageHandler.registerClass("Mscrm.ContractDetailRefreshPageHandler",Mscrm.RefreshPageHandler);Mscrm.ContractDetailPageHandler.registerClass("Mscrm.ContractDetailPageHandler",Mscrm.RefreshPageCommand);Mscrm.ContractPageHandler.registerClass("Mscrm.ContractPageHandler",Mscrm.RefreshPageCommand);Mscrm.EmailCommandHandler.registerClass("Mscrm.EmailCommandHandler",Mscrm.RefreshPageCommand);Mscrm.IncidentPageHandler.registerClass("Mscrm.IncidentPageHandler",Mscrm.RefreshPageHandler,Mscrm.IIncidentCommandBarHandler,Mscrm.ICommandBarHandler);Mscrm.InvoicePageHandler.registerClass("Mscrm.InvoicePageHandler",Mscrm.RefreshPageCommand);Mscrm.LeadPageHandler.registerClass("Mscrm.LeadPageHandler",Mscrm.RefreshPageHandler,Mscrm.ILeadCommandBarHandler,Mscrm.ICommandBarHandler);Mscrm.ProductPageHandler.registerClass("Mscrm.ProductPageHandler");Mscrm.OpportunityPageHandler.registerClass("Mscrm.OpportunityPageHandler",Mscrm.RefreshPageHandler,Mscrm.IOpportunityCommandBarHandler,Mscrm.ICommandBarHandler);Mscrm.CampaignActivityPageHandler.registerClass("Mscrm.CampaignActivityPageHandler",Mscrm.RefreshPageHandler);Mscrm.CampaignPageHandler.registerClass("Mscrm.CampaignPageHandler",Mscrm.RefreshPageHandler);Mscrm.QueuePageHandler.registerClass("Mscrm.QueuePageHandler",Mscrm.RefreshPageHandler,Mscrm.ICommandBarHandler);Mscrm.QuotePageHandler.registerClass("Mscrm.QuotePageHandler",Mscrm.RefreshPageHandler);Mscrm.QuoteCommandHandler.registerClass("Mscrm.QuoteCommandHandler",Mscrm.RefreshPageCommand);Mscrm.MoreCommandsMenu.registerClass("Mscrm.MoreCommandsMenu");Mscrm.RefreshPageCommandHandler.registerClass("Mscrm.RefreshPageCommandHandler");Mscrm.ReadFormUtilities.registerClass("Mscrm.ReadFormUtilities");Mscrm.RefreshPageScriptReference.registerClass("Mscrm.RefreshPageScriptReference");Mscrm.RefreshPageHeader.registerClass("Mscrm.RefreshPageHeader",null,Mscrm.IRefreshPageHeader);Mscrm.SalesOrderPageHandler.registerClass("Mscrm.SalesOrderPageHandler",Mscrm.RefreshPageCommand);Mscrm.SlaPageHandler.registerClass("Mscrm.SlaPageHandler",Mscrm.RefreshPageHandler);Mscrm.SlaContainer.registerClass("Mscrm.SlaContainer");Mscrm.SystemUserPageHandler.registerClass("Mscrm.SystemUserPageHandler",Mscrm.RefreshPageHandler);Mscrm.ReadFormControl.WebResourceImageControl.registerClass("Mscrm.ReadFormControl.WebResourceImageControl");Mscrm.LeadPageHandler.$w=null;Mscrm.LeadPageHandler.$1z=-2147220685;Mscrm.QueuePageHandler.$q=null;Mscrm.RefreshPageHandler.divTemplate="<div id='{0}' ></div>";Mscrm.RefreshPageHandler.$x=null;Mscrm.RefreshPageHandler.$U=null;Mscrm.RefreshPageHandler.crmNavBarId="crmNavBar";Mscrm.RefreshPageHandler.$1S=false;Mscrm.RefreshPageHandler.$J=false;Mscrm.RefreshPageHandler.$v=null;Mscrm.RefreshPageHandler.$1O=null;Mscrm.RefreshPageHandler.$1T=null;Mscrm.RefreshPageHandler.$1R=null;Mscrm.RefreshPageHandler._deleteFlyoutWidth=555;Mscrm.RefreshPageHandler._deleteFlyoutHeight=170;Mscrm.RefreshPageHandler.$Z=null;Mscrm.ReadFormUtilities.$2=null;Mscrm.ReadFormUtilities.tableSelector=".ms-crm-FormSection";Mscrm.ReadFormUtilities.customerDetailsSelector="div.ms-crm-FormSection-Container";Mscrm.ReadFormUtilities.quickFormClass="ms-crm-CustomerQf";Mscrm.ReadFormUtilities.customerDetailsClass="ms-crm-CustomerDetails";Mscrm.ReadFormUtilities.customerTableClass="ms-crm-CustomerTable";Mscrm.ReadFormUtilities.resizeHeaderEventName="resize-header";Mscrm.ReadFormUtilities.$d=null;Mscrm.RefreshPageHeader.$Z=null;Mscrm.SlaPageHandler.$W=null