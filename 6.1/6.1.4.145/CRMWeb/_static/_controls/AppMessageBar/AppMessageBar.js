Type.registerNamespace("Mscrm");Mscrm.MessageType=function(){};Mscrm.MessageType.prototype={activateNow:0,downloadCrmOutlookClient:1,scheduleUpgrade:2,notifications:3,usersWithoutRoleAlert:4,activateMobileSubscription:5,systemAlerts:6,storageLimitWarning:7,storageLimitChanged:8,freeTestInstanceAvailable:9,previewEnding:10,popOutRecord:11,useOffice365Credentials:12,transitionPrepare:13,transitionSoon:14,transitionComplete:15,enableS2SAlert:16,previewTerms:17,unsupportedChromeVersion:18};Mscrm.MessageType.registerEnum("Mscrm.MessageType",false);Mscrm.SeverityLevel=function(){};Mscrm.SeverityLevel.prototype={information:0,warning:1};Mscrm.SeverityLevel.registerEnum("Mscrm.SeverityLevel",false);Mscrm.ClientType=function(){};Mscrm.ClientType.prototype={webClient:0,outlookOnline:1,outlookOffline:2};Mscrm.ClientType.registerEnum("Mscrm.ClientType",false);Mscrm.DeploymentModel=function(){};Mscrm.DeploymentModel.prototype={live:0,onPremise:1};Mscrm.DeploymentModel.registerEnum("Mscrm.DeploymentModel",false);Mscrm.ButtonAction=function(){};Mscrm.ButtonAction.prototype={activateNowBillingAdmin:0,activateNowNonBillingAdmin:1,downloadCrmOutlookClient:2,scheduleUpgrade:3,notifications:4,usersWithoutRoleAlert:5,activateMobileSubscription:6,systemAlerts:7,storageLimitWarning:8,storageLimitChanged:9,freeTestInstanceAvailable:10,previewEnding:11,popOutRecord:12,useOffice365Credentials:13,transitionPrepare:14,transitionSoon:15,transitionComplete:16,enableS2SAlert:17,previewTerms:18,unsupportedChromeVersion:19};Mscrm.ButtonAction.registerEnum("Mscrm.ButtonAction",false);Mscrm.AppMessageBar=function(element){this.$$d_$c_3=Function.createDelegate(this,this.$c_3);this.$$d_$h_3=Function.createDelegate(this,this.$h_3);this.$$d_$O_3=Function.createDelegate(this,this.$O_3);this.$$d_$P_3=Function.createDelegate(this,this.$P_3);this.$$d_$X_3=Function.createDelegate(this,this.$X_3);this.$$d_$Y_3=Function.createDelegate(this,this.$Y_3);this.$$d_$W_3=Function.createDelegate(this,this.$W_3);this.$$d_$j_3=Function.createDelegate(this,this.$j_3);this.$$d_$S_3=Function.createDelegate(this,this.$S_3);this.$$d_$T_3=Function.createDelegate(this,this.$T_3);this.$$d_$R_3=Function.createDelegate(this,this.$R_3);this.$$d_$g_3=Function.createDelegate(this,this.$g_3);this.$E_3=Date.parseInvariant("01/01/0001");this.$7_3=-1;Mscrm.AppMessageBar.initializeBase(this,[element])};Mscrm.AppMessageBar.prototype={$K_3:null,$5_3:null,$L_3:null,$F_3:null,$3_3:null,$8_3:null,$C_3:null,$6_3:null,$1_3:0,$0_3:null,$D_3:false,$M_3:false,$N_3:false,$J_3:32,get_actualHeight:function(){return this.$J_3},set_actualHeight:function(value){this.$J_3=value;return value},$A_3:false,get_isVisible:function(){return this.$A_3},set_isVisible:function(value){this.$A_3=value;return value},initialize:function(){Mscrm.CrmUIControl.prototype.initialize.call(this);this.$K_3=$get("messageBarIcon");this.$5_3=$get("crmAppMessageBar");this.$5_3.style.display="none";this.$L_3=$get("crmAppMessageBarTitle");this.$F_3=$get("crmAppMessageBarHyperlink");this.$3_3=$get("crmAppMessageBarButton");this.$8_3=$get("crmAppMessageBarButtonText");this.$C_3=$get("crmAppMessageBarCloseButton");this.$6_3=$get("crmAppMessageBarCloseButtonImage");this.$U_3()},handleEvent:function(eventCode,parameters,sourceComponent){switch(eventCode){case Mscrm.ScriptEvents.WindowResize:this.$d_3(parameters);break;case Mscrm.ScriptEvents.PageLoaded:if(!this.$N_3){var $$t_3=this;window.setTimeout(function(){$$t_3.$b_3()},2e3)}break;case Mscrm.ScriptEvents.SignOutRequested:this.$N_3=true;break;case Mscrm.ScriptEvents.UpdateAppNotification:if(parameters["add"])this.addMessage(parameters["message"]);else this.removeMessage(parameters["messageId"]);this.$B_3();break}return null},addMessage:function(newMessage){if(!IsNull(newMessage)){if(!IsNull(this.$0_3))Array.insert(this.$0_3,0,newMessage);else this.$0_3=[newMessage];this.$7_3--}},removeMessage:function(messageId){if(!IsNull(this.$0_3)&&!IsNull(messageId)&&this.$0_3[0].Id===messageId){Array.removeAt(this.$0_3,0);if(this.$0_3.length>0){this.$7_3--;if(this.$1_3>0)this.$1_3--}}},$U_3:function(){$addHandler(this.$3_3,"click",this.$$d_$g_3);$addHandler(this.$3_3,"mousedown",this.$$d_$R_3);$addHandler(this.$3_3,"mouseup",this.$$d_$T_3);$addHandler(this.$3_3,"mouseover",this.$$d_$S_3);$addHandler(this.$3_3,"mouseout",this.$$d_$T_3);$addHandler(this.$C_3,"click",this.$$d_$j_3);$addHandler(this.$6_3,"mousedown",this.$$d_$W_3);$addHandler(this.$6_3,"mouseup",this.$$d_$Y_3);$addHandler(this.$6_3,"mouseover",this.$$d_$X_3);$addHandler(this.$6_3,"mouseout",this.$$d_$Y_3)},$B_3:function(){if(Mscrm.Utilities.isIosDevice()||typeof this.$0_3==="undefined"||!this.$0_3){this.$Q_3();return}if(!Mscrm.AppMessageBarUtility.$V(this.$0_3[this.$1_3].Id,this.$0_3[this.$1_3].OverrideCancellationTime)){this.$a_3();this.$Z_3()}else{this.$D_3=false;this.$H_3(true)}},$Z_3:function(){var $v_0=Mscrm.EnumConverterMessageBar.messageTypeToEnum(this.$0_3[this.$1_3].MessageType.toString());if($v_0===1)if(this.$f_3()||this.$M_3||this.$e_3())this.$H_3(false);else{var $v_4=this.$0_3[this.$1_3].Data.anyType;this.$3_3.setAttribute("href",$v_4);this.$3_3.setAttribute("target","_blank")}else if($v_0===13||$v_0===14||$v_0===15||$v_0===12){var $v_5=this.$0_3[this.$1_3].Data.anyType;if($v_5==="transitionwizard"){this.$3_3.setAttribute("href","#");this.$3_3.setAttribute("target","_self")}else{this.$3_3.setAttribute("href",$v_5);this.$3_3.setAttribute("target","_blank")}}else{this.$3_3.setAttribute("href","#");this.$3_3.setAttribute("target","_self")}XUI.Html.SetText(this.$L_3,this.$0_3[this.$1_3].Title);var $v_1=this.$0_3[this.$1_3].MessageText;if(Object.getType($v_1)===String)XUI.Html.SetText(this.$F_3,$v_1.toString());else XUI.Html.SetText(this.$F_3,"");XUI.Html.SetText(this.$8_3,this.$0_3[this.$1_3].ActionButtonText);this.$C_3.title=this.$0_3[this.$1_3].CloseButtonTooltip;var $v_2=this.$K_3,$v_3=Mscrm.EnumConverterMessageBar.severityLevelToEnum(this.$0_3[this.$1_3].SeverityLevel.toString());$v_2.className=Mscrm.AppMessageBarUtility.getIconImageStrip($v_3)},$f_3:function(){if(typeof MS_CRM_CLIENT_OUTLOOK_INSTALLED!=="undefined")return MS_CRM_CLIENT_OUTLOOK_INSTALLED;else return false},$e_3:function(){return !(window.navigator.platform=="Win32"||window.navigator.platform=="Windows")},$g_3:function($p0){switch(Mscrm.EnumConverterMessageBar.buttonActionToEnum(this.$0_3[this.$1_3].ButtonAction.toString())){case 0:var $$t_1=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.ActivateNowBillingAdmin($$t_1.$0_3[$$t_1.$1_3].Data.anyType)},1);var $$t_2=this;window.setTimeout(function(){$$t_2.$4_3(false)},3e3);break;case 1:var $$t_3=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.ActivateNowNonBillingAdmin($$t_3.$0_3[$$t_3.$1_3].Data.anyType)},1);var $$t_4=this;window.setTimeout(function(){$$t_4.$4_3(true)},3e3);break;case 18:var $$t_5=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.PreviewTerms($$t_5.$0_3[$$t_5.$1_3].Data.anyType)},1);break;case 2:this.$M_3=true;var $$t_6=this;window.setTimeout(function(){$$t_6.$4_3(false)},3e3);break;case 3:var $$t_7=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.scheduleUpgrade()},1);break;case 5:var $$t_8=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.usersWithoutRoleAlert()},1);break;case 7:var $$t_9=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.showSystemAlerts()},1);var $$t_A=this;window.setTimeout(function(){$$t_A.$4_3(false)},3e3);break;case 8:var $$t_B=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.StorageLimitWarning($$t_B.$0_3[$$t_B.$1_3].Data.anyType)},1);var $$t_C=this;window.setTimeout(function(){$$t_C.$4_3(true)},3e3);break;case 9:var $$t_D=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.StorageLimitChanged($$t_D.$0_3[$$t_D.$1_3].Data.anyType)},1);var $$t_E=this;window.setTimeout(function(){$$t_E.$4_3(true)},3e3);break;case 10:var $$t_F=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.FreeTestInstanceAvailable($$t_F.$0_3[$$t_F.$1_3].Data.anyType)},1);var $$t_G=this;window.setTimeout(function(){$$t_G.$4_3(true)},3e3);break;case 11:var $$t_H=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.PreviewEnding($$t_H.$0_3[$$t_H.$1_3].Data.anyType)},1);var $$t_I=this;window.setTimeout(function(){$$t_I.$4_3(false)},3e3);break;case 12:var $$t_J=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.PopOutRecord($$t_J.$0_3[$$t_J.$1_3].Data)},1);var $$t_K=this;window.setTimeout(function(){$$t_K.$4_3(false)},3e3);break;case 14:case 15:case 16:var $$t_L=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.TransitionButton($$t_L.$0_3[$$t_L.$1_3].Data.anyType)},1);var $$t_M=this;window.setTimeout(function(){$$t_M.$4_3(true)},3e3);break;case 13:var $$t_N=this;window.setTimeout(function(){$$t_N.$4_3(false)},3e3);break;case 17:var $$t_O=this;window.setTimeout(function(){Mscrm.AppMessageBarActions.enableS2SAlert()},1);var $$t_P=this;window.setTimeout(function(){$$t_P.$4_3(false)},3e3);break;default:break}},$H_3:function($p0){if(this.$7_3===this.$1_3)return;this.$7_3=this.$1_3;$p0&&Mscrm.AppMessageBarUtility.$i(this.$0_3[this.$1_3].Id,this.$0_3[this.$1_3].OverrideCancellationTime);if(this.$1_3!==this.$0_3.length-1){XUI.Html.SetOpacity(this.$5_3,1);if(!this.$D_3){this.$1_3++;this.$B_3()}else this.$P_3()}else this.$Q_3()},$a_3:function(){this.$A_3=true;this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null);this.$5_3.style.display=""},$Q_3:function(){this.$A_3=false;this.raiseEvent(Mscrm.ScriptEvents.RequestResize,null);this.$5_3.style.display="none"},$W_3:function($p0){var $v_0=this.$6_3;$v_0.className="ms-crm-ImageStrip-msgbar_close_button_click"},$Y_3:function($p0){var $v_0=this.$6_3;$v_0.className="ms-crm-ImageStrip-msgbar_close_button_cold"},$X_3:function($p0){var $v_0=this.$6_3;$v_0.className="ms-crm-ImageStrip-msgbar_close_button_hover"},$R_3:function($p0){this.$8_3.className="ms-crm-msgbar_button_click"},$T_3:function($p0){this.$8_3.className="ms-crm-msgbar_button_cold"},$S_3:function($p0){this.$8_3.className="ms-crm-msgbar_button_hover"},$j_3:function($p0){this.$4_3(true)},$4_3:function($p0){this.$D_3=true;this.$H_3($p0)},$P_3:function(){var $v_0=XUI.Html.GetOpacity(this.$5_3);if($v_0>0){$v_0-=.1;$v_0=parseFloat($v_0.toFixed(1));XUI.Html.SetOpacity(this.$5_3,$v_0);window.setTimeout(this.$$d_$P_3,100)}else{this.$1_3++;this.$B_3();this.$O_3()}},$O_3:function(){var $v_0=XUI.Html.GetOpacity(this.$5_3);if($v_0<1){$v_0+=.1;$v_0=parseFloat($v_0.toFixed(1));XUI.Html.SetOpacity(this.$5_3,$v_0);window.setTimeout(this.$$d_$O_3,100)}},$d_3:function($p0){$p0=$p0[this.get_id()];if(typeof $p0["height"]!=="undefined"){var $v_0=$p0["height"],$v_1=$p0["width"];this.set_height($v_0);this.set_width($v_1)}},$b_3:function(){if(Mscrm.DateTimeUtility.localDateTimeNow()-this.$E_3<=3e5)return;else this.$E_3=Mscrm.DateTimeUtility.localDateTimeNow();var $v_0=new RemoteCommand("MessageBar","GetAllMessages");$v_0.ErrorHandler=this.$$d_$h_3;$v_0.SetParameter("clientType",0);var $v_1=this.$$d_$c_3,$v_2=$v_0.Execute($v_1)},$h_3:function($p0,$p1){},$c_3:function($p0,$p1){this.$1_3=0;this.$7_3=-1;this.$0_3=null;if($p0.Success){this.$0_3=$p0.ReturnValue.Message;if(typeof this.$0_3==="undefined")this.$0_3=null;else if(typeof this.$0_3.length==="undefined"||!this.$0_3.length)this.$0_3=[$p0.ReturnValue.Message];this.$B_3()}}};Mscrm.AppMessageBarActions=function(){};Mscrm.AppMessageBarActions.get_ContentFrameId=function(){Mscrm.AppMessageBarActions.$9="contentIFrame0";var $v_0=window.top.document.getElementById("crmContentPanel");if(!IsNull($v_0)){var $v_1=$v_0.attributes.getNamedItem("currentContentId");if(!IsNull($v_1)&&$v_1.specified)Mscrm.AppMessageBarActions.$9=$v_1.value}return Mscrm.AppMessageBarActions.$9};Mscrm.AppMessageBarActions.ActivateNowBillingAdmin=function(data){var $v_0=data[0],$v_1=data[1];confirm($v_0)&&openStdWin($v_1,"_blank",window.screen.availWidth*.9,window.screen.availHeight*.9,"status=1,resizable=1,scrollbars=1")};Mscrm.AppMessageBarActions.ActivateNowNonBillingAdmin=function(data){window.location.href=data};Mscrm.AppMessageBarActions.usersWithoutRoleAlert=function(){if(!isNullOrEmptyString(Mscrm.AppMessageBarActions.get_ContentFrameId())){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId());if(!IsNull($v_0)){var $v_1="{61289874-49FB-43FF-AFF0-00380E820515}",$v_2=Mscrm.CrmUri.create("/_root/homepage.aspx");$v_2.get_query()["etc"]=8;$v_2.get_query()["pagemode"]="iframe";$v_2.get_query()["sitemappath"]="Settings|System_Setting|nav_administration";$v_2.get_query()["viewid"]=$v_1;$v_2.get_query()["viewtype"]=1039;$v_0.setAttribute("src",$v_2.toString())}}};Mscrm.AppMessageBarActions.showSystemAlerts=function(){try{window.top.goTo("Workplace","MyWork","nav_traces")}catch($$e_0){try{window.goTo("Workplace","MyWork","nav_traces")}catch($$e_1){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId());$v_0.setAttribute("src","/_root/tracewall.aspx")}}};Mscrm.AppMessageBarActions.scheduleUpgrade=function(){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId()),$v_1=Mscrm.CrmUri.create("/tools/Admin/addon/systemaddons.aspx");$v_0.setAttribute("src",$v_1.toString())};Mscrm.AppMessageBarActions.StorageLimitWarning=function(data){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId());$v_0.setAttribute("src",data)};Mscrm.AppMessageBarActions.StorageLimitChanged=function(data){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId());$v_0.setAttribute("src",data)};Mscrm.AppMessageBarActions.NavigateContentFrameTo=function(data){var $v_0=$get(Mscrm.AppMessageBarActions.get_ContentFrameId());$v_0.setAttribute("src",data)};Mscrm.AppMessageBarActions.TransitionButton=function(data){data==="transitionwizard"&&Mscrm.AppMessageBarActions.NavigateContentFrameTo("/tools/Admin/addon/systemaddons.aspx?opentransitionwizard=true")};Mscrm.AppMessageBarActions.FreeTestInstanceAvailable=function(data){var $v_0=String.format("status=1,resizable=1,scrollbars=1,width={0},height={0}",window.screen.availWidth*.9,window.screen.availHeight*.9);window.open(data.toString(),"_blank",$v_0)};Mscrm.AppMessageBarActions.PreviewEnding=function(data){var $v_0=String.format("status=1,resizable=1,scrollbars=1,width={0},height={0}",window.screen.availWidth*.9,window.screen.availHeight*.9);window.open(data.toString(),"_blank",$v_0)};Mscrm.AppMessageBarActions.PopOutRecord=function(data){var $v_0=data[0],$v_1=data[1],$v_2=data[2],$v_3=data[3];openObj($v_0,$v_1,$v_2.get_queryString(),null,Mscrm.NavigationMode.DefaultNavigationMode,$v_3)};Mscrm.AppMessageBarActions.enableS2SAlert=function(){openStdWin(Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=2164dd44-6f89-430c-9c7b-abfa44320df0"),null,520,530,null)};Mscrm.AppMessageBarActions.PreviewTerms=function(data){var $v_0=String.format("status=1,resizable=1,scrollbars=1,width={0},height={0}",window.screen.availWidth*.9,window.screen.availHeight*.9);window.open(data.toString(),"_blank",$v_0)};Mscrm.AppMessageBarUtility=function(){};Mscrm.AppMessageBarUtility.getIconImageStrip=function(severityLevel){switch(severityLevel){case 0:return "ms-crm-ImageStrip-msgbar_icn_info";default:return "ms-crm-ImageStrip-msgbar_icn_info"}};Mscrm.AppMessageBarUtility.$i=function($p0,$p1){var $v_0=new Date,$v_1=new Date($v_0.getFullYear()+100,1,1);if(typeof $p1==="undefined"||isNullOrEmptyString($p1))document.cookie=CrmEncodeDecode.CrmNameValueEncode(Mscrm.AppMessageBarUtility.$G($p0))+"="+Mscrm.AppMessageBarUtility.$I+";expires="+$v_1.toUTCString()+";";else document.cookie=CrmEncodeDecode.CrmNameValueEncode(Mscrm.AppMessageBarUtility.$G($p0))+"="+$p1+";expires="+$v_1.toUTCString()+";"};Mscrm.AppMessageBarUtility.$V=function($p0,$p1){var $v_0=Mscrm.AppMessageBarUtility.$G($p0),$v_1=document.cookie.indexOf(CrmEncodeDecode.CrmNameValueEncode($v_0));if($v_1!==-1){var $v_2,$v_3=document.cookie.indexOf(";",$v_1+$v_0.length);if($v_3===-1)$v_2=document.cookie.substr($v_1+$v_0.length+1);else{var $v_4=$v_1+$v_0.length+1;$v_2=document.cookie.substr($v_4,$v_3-$v_4)}if($v_2!==Mscrm.AppMessageBarUtility.$I)try{var $v_5=new Date(Date.parse($p1)),$v_6=new Date(Date.parse($v_2));if($v_5>$v_6)return false}catch($$e_9){}return true}return false};Mscrm.AppMessageBarUtility.$G=function($p0){return "CRM_MSG_BAR_"+$p0};Mscrm.EnumConverterMessageBar=function(){};Mscrm.EnumConverterMessageBar.severityLevelToEnum=function(severityLevel){switch(severityLevel){case "Information":return 0;case "Warning":return 1;default:return 0}};Mscrm.EnumConverterMessageBar.messageTypeToEnum=function(messageType){switch(messageType){case "ActivateNow":return 0;case "PreviewTerms":return 17;case "DownloadCrmOutlookClient":return 1;case "ScheduleUpgrade":return 2;case "UsersWithoutRoleAlert":return 4;case "SystemAlerts":return 6;case "StorageLimitWarning":return 7;case "StorageLimitChanged":return 8;case "FreeTestInstanceAvailable":return 9;case "PreviewEnding":return 10;case "PopOutRecord":case "11":return 11;case "UseOffice365Credentials":return 12;case "TransitionPrepare":return 13;case "TransitionSoon":return 14;case "TransitionComplete":return 15;case "EnableS2SAlert":return 16;default:return 0}};Mscrm.EnumConverterMessageBar.buttonActionToEnum=function(buttonAction){switch(buttonAction){case "ActivateNowBillingAdmin":return 0;case "ActivateNowNonBillingAdmin":return 1;case "PreviewTerms":return 18;case "DownloadCrmOutlookClient":return 2;case "ScheduleUpgrade":return 3;case "UsersWithoutRoleAlert":return 5;case "SystemAlerts":return 7;case "StorageLimitWarning":return 8;case "StorageLimitChanged":return 9;case "FreeTestInstanceAvailable":return 10;case "PreviewEnding":return 11;case "PopOutRecord":case "12":return 12;case "UseOffice365Credentials":return 13;case "TransitionPrepare":return 14;case "TransitionSoon":return 15;case "TransitionComplete":return 16;case "EnableS2SAlert":return 17;default:return 0}};Mscrm.AppMessageBar.registerClass("Mscrm.AppMessageBar",Mscrm.CrmUIControl);Mscrm.AppMessageBarActions.registerClass("Mscrm.AppMessageBarActions");Mscrm.AppMessageBarUtility.registerClass("Mscrm.AppMessageBarUtility");Mscrm.EnumConverterMessageBar.registerClass("Mscrm.EnumConverterMessageBar");Mscrm.AppMessageBarActions.$9=null;Mscrm.AppMessageBarUtility.$I="HideMessage"