Type.registerNamespace("Mscrm");Mscrm.pricelevelid_setadditionalparams=function(context){var oLookup=Mscrm.FormControlInputBehavior.GetBehaviorForForm("pricelevelid");AddTransactionCurrencyParam(oLookup)};Mscrm.opportunityid_setadditionalparams=function(context){var oLookup=Mscrm.FormControlInputBehavior.GetBehaviorForForm("opportunityid");AddTransactionCurrencyParam(oLookup)};Mscrm.Form_onload=function(){var effectiveto=Xrm.Page.data.entity.attributes.get("effectiveto"),effectivefrom=Xrm.Page.data.entity.attributes.get("effectivefrom");Xrm.Page.ui.getFormType()!=Mscrm.SdkFormType.readOnlyForm&&Xrm.Page.ui.getFormType()!=Mscrm.SdkFormType.disabledForm&&EnableDisableShippingAddress();if(!Mscrm.InternalUtilities.JSTypes.isNull(effectiveto)&&!Mscrm.InternalUtilities.JSTypes.isNull(effectivefrom)){var effectivetoCtrl=effectiveto.controls.get(0),effectivefromCtrl=effectivefrom.controls.get(0);if(!Mscrm.InternalUtilities.JSTypes.isNull(effectivefromCtrl.get_editControlBehavior())&&!Mscrm.InternalUtilities.JSTypes.isNull(effectivetoCtrl.get_editControlBehavior())){var effectivefromCtrlBehavior=effectivefromCtrl.get_editControlBehavior(),effectivetoCtrlBehavior=effectivetoCtrl.get_editControlBehavior();effectivetoCtrlBehavior.set_prevDataValue(CloneDate(effectiveto.getValue()));effectivefromCtrlBehavior.set_prevDataValue(CloneDate(effectivefrom.getValue()))}}var navigation=Xrm.Page.ui.navigation;if(!Mscrm.InternalUtilities.JSTypes.isNull(navigation)&&!Mscrm.InternalUtilities.JSTypes.isNull(navigation.items)){var ordersNavLink=navigation.items.get("navOrders");if(!Mscrm.InternalUtilities.JSTypes.isNull(ordersNavLink))Xrm.Page.data.entity.attributes.get("statecode").getText()=="Draft"&&ordersNavLink.setVisible(false)}};function Mscrm_effective_common_onchange(CtrlName){var effectiveto=Xrm.Page.data.entity.attributes.get("effectiveto"),effectivefrom=Xrm.Page.data.entity.attributes.get("effectivefrom");if(!Mscrm.InternalUtilities.JSTypes.isNull(effectiveto)&&!Mscrm.InternalUtilities.JSTypes.isNull(effectivefrom)){var effectivetoCtrl=effectiveto.controls.get(0),effectivefromCtrl=effectivefrom.controls.get(0);if(Mscrm.InternalUtilities.JSTypes.isNull(effectivefromCtrl.get_editControlBehavior())||Mscrm.InternalUtilities.JSTypes.isNull(effectivetoCtrl.get_editControlBehavior()))return;if(CtrlName==="effectivefrom")return IsEffectiveFromDateLessThanEffectiveToDate(effectivefrom,effectiveto,effectivefromCtrl.get_editControlBehavior(),LOCID_EFFECTIVEDATE_TO_LT_FROM,CtrlName);else return IsEffectiveFromDateLessThanEffectiveToDate(effectivefrom,effectiveto,effectivetoCtrl.get_editControlBehavior(),LOCID_EFFECTIVEDATE_TO_LT_FROM,CtrlName)}}Mscrm.effectivefrom_onchange=function(){Mscrm_effective_common_onchange("effectivefrom")};Mscrm.effectiveto_onchange=function(){Mscrm_effective_common_onchange("effectiveto")};function IsEffectiveFromDateLessThanEffectiveToDate(oStartDateAtt,oEndDateAtt,oSourceCtrl,sMsg,CtrlType){var oStartDate=oStartDateAtt.getValue(),oEndDate=oEndDateAtt.getValue();if(!IsNull(oStartDate)&&!IsNull(oEndDate)&&oStartDate.getTime()>oEndDate.getTime()){!IsNull(sMsg)&&alert(sMsg);oSourceCtrl.set_dataValue(CloneDate(oSourceCtrl.get_prevDataValue()));if(CtrlType==="effectivefrom")oStartDateAtt.setValue(oSourceCtrl.get_prevDataValue());else oEndDateAtt.setValue(oSourceCtrl.get_prevDataValue());return false}else{oSourceCtrl.set_prevDataValue(CloneDate(oSourceCtrl.get_dataValue()));return true}}Mscrm.willcall_onchange=function(){EnableDisableShippingAddress()};Mscrm.transactioncurrencyid_onchange=function(){OnTransactionCurrencyChange()}