Type.registerNamespace("Mscrm");Mscrm.defaultuomid_setadditionalparams=function(context){var defaultUomScheduleAttributes=Xrm.Page.data.entity.attributes.get("defaultuomscheduleid");if(!Mscrm.InternalUtilities.JSTypes.isNull(defaultUomScheduleAttributes.getValue("defaultuomscheduleid"))&&defaultUomScheduleAttributes.getValue("defaultuomscheduleid").length>0){var parentId=defaultUomScheduleAttributes.getValue("defaultuomscheduleid")[0].id,fetchXml='<filter type="and"><condition attribute="uomscheduleid" operator="like" value="'+parentId+'"/></filter>';Xrm.Page.ui.controls.get("defaultuomid").addCustomFilter(fetchXml)}};Mscrm.pricelevelid_setadditionalparams=function(context){var sProductId=Xrm.Page.data.entity.getId();if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(sProductId)){var lookupBehavior=Mscrm.FormControlInputBehavior.GetBehaviorForForm("pricelevelid");lookupBehavior.AddParam("parentId",sProductId)}};Mscrm.Form_onload=function(){var formType=Xrm.Page.ui.getFormType();formType!=Xrm.FormType.readOnly&&formType!=Xrm.FormType.disabled&&UpdateQuantityOnHandDecimals();var navigation=Xrm.Page.ui.navigation;if(!Mscrm.InternalUtilities.JSTypes.isNull(navigation)&&!Mscrm.InternalUtilities.JSTypes.isNull(navigation.items)){var kitsNavLink=navigation.items.get("navKits");!Mscrm.InternalUtilities.JSTypes.isNull(kitsNavLink)&&kitsNavLink.setVisible(IsKit())}ShowNotificationIfNeccesary();var defaultuomidControl=Xrm.Page.ui.controls.get("defaultuomid"),defaultuomscheduleidControl=Xrm.Page.ui.controls.get("defaultuomscheduleid"),defaultuomscheduleidAttributes=Xrm.Page.data.entity.attributes.get("defaultuomscheduleid");if(!Mscrm.InternalUtilities.JSTypes.isNull(defaultuomidControl)&&!Mscrm.InternalUtilities.JSTypes.isNull(defaultuomscheduleidControl)&&!Mscrm.InternalUtilities.JSTypes.isNull(defaultuomscheduleidAttributes)){Mscrm.InternalUtilities.JSTypes.isNull(defaultuomscheduleidAttributes.getValue())&&defaultuomidControl.setDisabled(true);if(formType!=Xrm.FormType.create&&formType!=Xrm.FormType.disabled){defaultuomscheduleidControl.setDisabled(true);var pricelevelid=Xrm.Page.ui.controls.get("pricelevelid");!Mscrm.InternalUtilities.JSTypes.isNull(pricelevelid)&&pricelevelid.setDisabled(false)}}};Mscrm.defaultuomscheduleid_onchange=function(){var defaultuomidCtrl=Xrm.Page.ui.controls.get("defaultuomid"),defaultuomidAttributes=Xrm.Page.data.entity.attributes.get("defaultuomid"),defaultuomscheduleAttributes=Xrm.Page.data.entity.attributes.get("defaultuomscheduleid");defaultuomidCtrl.setDisabled(Mscrm.InternalUtilities.JSTypes.isNull(defaultuomscheduleAttributes.getValue()));defaultuomidCtrl.getDisabled()&&defaultuomidAttributes.setValue([])};Mscrm.quantitydecimal_onchange=function(){UpdateQuantityOnHandDecimals()};Mscrm.pricelevelid_onchange=function(){ShowNotificationIfNeccesary()};function UpdateQuantityOnHandDecimals(){var quantityonhand=Xrm.Page.data.entity.attributes.get("quantityonhand"),quantitydecimal=Xrm.Page.data.entity.attributes.get("quantitydecimal");if(!Mscrm.InternalUtilities.JSTypes.isNull(quantityonhand)){var acc=quantitydecimal.getValue();if(Mscrm.InternalUtilities.JSTypes.isNull(acc))acc=0;quantityonhand.setPrecision(acc)}}function ShowNotificationIfNeccesary(){var formType=Xrm.Page.ui.getFormType(),defaultPriceListAttributes=Xrm.Page.data.entity.attributes.get("pricelevelid");if(formType!=Xrm.FormType.create&&(Mscrm.InternalUtilities.JSTypes.isNull(defaultPriceListAttributes)||Mscrm.InternalUtilities.JSTypes.isNull(defaultPriceListAttributes.getValue()))){var notificationText=LOCID_ERRORMISSINGPLPRE+" "+LOCID_ERRORMISSINGPL;Xrm.Page.ui.setFormNotification(notificationText,"WARNING","product_missing_default_price_list")}else Xrm.Page.ui.clearFormNotification("product_missing_default_price_list")}function IsKit(){var isKit=Xrm.Page.data.entity.attributes.get("iskit");return !Mscrm.InternalUtilities.JSTypes.isNull(isKit)?isKit.getValue():false}