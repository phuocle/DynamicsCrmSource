Type.registerNamespace("Mscrm");Mscrm.SystemUserInviteStatusCode=function(){};Mscrm.SystemUserInviteStatusCode.prototype={invitationNotSent:0,invited:1,invitationNearExpired:2,invitationExpired:3,invitationAccepted:4};Mscrm.SystemUserInviteStatusCode.registerEnum("Mscrm.SystemUserInviteStatusCode",false);Mscrm.CampaignActivityState=function(){};Mscrm.CampaignActivityState.prototype={open:0,closed:1,canceled:2};Mscrm.CampaignActivityState.registerEnum("Mscrm.CampaignActivityState",false);Mscrm.CommandBarActions=function(){};Mscrm.CommandBarActions.addToQueue=function(objectType){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_addtoqueue.aspx");$v_0.get_query()["iObjType"]=objectType;$v_0.get_query()["iTotal"]="1";var $v_1=new Xrm.DialogOptions;$v_1.height=235;$v_1.width=450;Xrm.Internal.openDialog($v_0.toString(),$v_1,[Xrm.Page.data.entity.getId()],null,Mscrm.CommandBarActions.createRefreshFormCallback())};Mscrm.CommandBarActions.assignObject=function(objectType){if(typeof objectType!==Mscrm.InternalUtilities.TypeNames.NumberType)objectType=parseInt(objectType,10);var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Internal.getEntityName(objectType);if($v_1===Mscrm.InternalUtilities.EntityNames.Incident||Xrm.Utility.isActivityType($v_1))Mscrm.CommandBarActions.assignQueue($v_0,objectType);else{var $v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_frmassign.aspx");$v_2.get_query()["pId"]=$v_0;$v_2.get_query()["pType"]=objectType;$v_2.get_query()["iObjType"]=objectType;$v_2.get_query()["iTotal"]="1";var $v_3=new Xrm.DialogOptions;switch($v_1){case Mscrm.InternalUtilities.EntityNames.SLA:case Mscrm.InternalUtilities.EntityNames.ConvertRule:case Mscrm.InternalUtilities.EntityNames.RoutingRule:$v_3.height=320;break;case Mscrm.InternalUtilities.EntityNames.Workflow:$v_3.height=290;break;default:$v_3.height=285;break}$v_3.width=Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile?506:456;var $v_4=Mscrm.CommandBarActions.assignObjectAction;Xrm.Internal.openDialog($v_2.toString(),$v_3,null,null,$v_4)}};Mscrm.CommandBarActions.assignQueue=function(entityId,objectType){if(typeof objectType!==Mscrm.InternalUtilities.TypeNames.NumberType)objectType=parseInt(objectType,10);var $v_0=Xrm.Internal.getEntityName(objectType),$v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_assignqueue.aspx");$v_1.get_query()["iObjType"]=objectType;$v_1.get_query()["iTotal"]="1";$v_1.get_query()["sQType"]="1";$v_1.get_query()["FromForm"]="1";var $v_2,$v_3;if($v_0===Mscrm.InternalUtilities.EntityNames.Incident){$v_1.get_query()["uid"]=entityId;$v_2=456;$v_3=300}else if(Xrm.Utility.isActivityType($v_0)){$v_2=500;$v_3=310}else return;var $v_4=new Xrm.DialogOptions;$v_4.height=$v_3;$v_4.width=$v_2;var $v_5=Mscrm.CommandBarActions.assignObjectAction;Xrm.Internal.openDialog($v_1.toString(),$v_4,null,null,$v_5)};Mscrm.CommandBarActions.assignObjectAction=function(returnValue){if(returnValue){var $v_0=returnValue["OwnerId"];if($v_0){var $v_1=returnValue["OwnerType"];if(typeof $v_1!==Mscrm.InternalUtilities.TypeNames.NumberType)$v_1=parseInt($v_1,10);var $v_2=Xrm.Internal.getEntityName($v_1),$v_3=Xrm.Page.data.entity.getId(),$v_4=Xrm.Page.data.entity.getEntityName();Xrm.Page.context.saveMode=Xrm.SaveMode.assign;if(Mscrm.Utilities.isRefreshForm())Xrm.Page.data.save().then(function(){Mscrm.CommandBarActions.$G($v_4,$v_3,$v_2,$v_0)},Mscrm.CommandBarActions.$3);else Mscrm.CommandBarActions.$G($v_4,$v_3,$v_2,$v_0);Xrm.Page.context.saveMode=-1}}};Mscrm.CommandBarActions.$G=function($p0,$p1,$p2,$p3){Xrm.Internal.messages.assign($p0,$p1,$p2,$p3).then(function(){if(Mscrm.CommandBarActions.isMobileCompanionApp())Xrm.Page.data.refresh(true);else if(!IsNull(window.top)){var $v_0=window.top.Sys.Application.findComponent("crmPageManager");!IsNull($v_0)&&$v_0.raiseEvent(Mscrm.ScriptEvents.ReloadPage,null)}},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.associateManyToMany=function(gridControl,parent,child,relationshipName){if(gridControl.getRelationshipRoleOrdinal()===2){var $v_1=parent;parent=child;child=$v_1}var $v_0=[child];Xrm.Internal.messages.associate(parent,relationshipName,$v_0).then(function($p1_0){!Mscrm.InternalUtilities.JSTypes.isNull(gridControl)&&gridControl.refresh()},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.associateOneToMany=function(gridControl,parent,child,relationshipAttributeName){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(relationshipAttributeName))return;var $v_0=[relationshipAttributeName];Xrm.Internal.messages.retrieve(child.LogicalName,child.Id.toString(),$v_0).then(function($p1_0){var $v_1=$p1_0.get_entity();if($v_1.hasValue(relationshipAttributeName)){var $v_2=$v_1.getValue(relationshipAttributeName),$v_3=$v_2.Id;if($v_3.equals(parent.Id))return;var $v_4=parseInt("0x80048478",16),$v_5=Xrm.Internal.getErrorMessage($v_4);Mscrm.CommandBarActions.$B($v_4,$v_5)}else{$v_1.initializeValue(relationshipAttributeName,parent,6);$v_1.get_changedFieldNames().addRange([relationshipAttributeName]);Xrm.Internal.messages.update($v_1).then(function($p2_0){!Mscrm.InternalUtilities.JSTypes.isNull(gridControl)&&gridControl.refresh()},Mscrm.CommandBarActions.actionFailedCallback)}},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.resolve=function(){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))return;if(!Xrm.Page.data.getIsValid())return;var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_ConfirmResolve.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_1=new Xrm.DialogOptions;$v_1.height=200;$v_1.width=600;var $v_2=0;if(Mscrm.CommandBarActions.isServiceMetadataAvailable())Xrm.Internal.messages.getValidStatusTransition(Xrm.Page.data.entity.getId(),1).then(function($p1_0){$v_2=$p1_0.get_result();switch($v_2){case 1:$v_0.get_query()["reason"]="novalidstatustransition";Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,null);break;case 2:$v_0.get_query()["reason"]="activeactivities";var $v_3=Mscrm.CommandBarActions.performActionAfterConfirmCancel;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_3);break;case 3:Mscrm.CommandBarActions.commonForResolve();break;case 4:var $v_4=Mscrm.CrmUri.create("/_common/error/dlg_error.aspx");$v_4.get_query()["hresult"]="0x80044411";Xrm.Internal.openDialog($v_4.toString(),$v_1,null,null,null);break}},function($p1_0){return});else Mscrm.CommandBarActions.$q()};Mscrm.CommandBarActions.performActionAfterConfirmCancel=function(returnValue){!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)&&Mscrm.CommandBarActions.commonForResolve()};Mscrm.CommandBarActions.$q=function(){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))return;var resolveCase={};resolveCase["inputCommand"]=Mscrm.InlineCommands.IncidentResolve;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.IncidentCheckForOpenActivities,resolveCase)};Mscrm.CommandBarActions.$d=function(){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))return;var cancelCase={};cancelCase["inputCommand"]=Mscrm.InlineCommands.IncidentCancel;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.IncidentCheckForOpenActivities,cancelCase)};Mscrm.CommandBarActions.commonForResolve=function(){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_closecase.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_1=new Xrm.DialogOptions;$v_1.height=391;$v_1.width=400;var $v_2=Mscrm.CommandBarActions.performActionAfterCloseCase;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)};Mscrm.CommandBarActions.performActionAfterCloseCase=function(returnValue){var $v_0=false;if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_1=Xrm.Page.data.entity.getId(),$v_2=function(){Xrm.Page.data.refresh(true)};Xrm.Page.data.save().then(function(){Mscrm.CommandBarActions.performResolveCase(returnValue,$v_1,$v_2)},Mscrm.CommandBarActions.$3);$v_0=true}return $v_0};Mscrm.CommandBarActions.performResolveCase=function(returnValue,caseId,successCallback){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_0={},$v_1={},$v_2=new Array(4),$v_3="incidentid";$v_2[0]=$v_3;$v_0[$v_3]=6;$v_1[$v_3]=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Incident,new Microsoft.Dynamics.Client.Core.Framework.Guid(caseId));$v_3="timespent";$v_2[1]=$v_3;$v_0[$v_3]=5;$v_1[$v_3]=returnValue.TimeSpent;$v_3="description";$v_2[2]=$v_3;$v_0[$v_3]=14;$v_1[$v_3]=returnValue.Description;$v_3="subject";$v_2[3]=$v_3;$v_0[$v_3]=14;$v_1[$v_3]=returnValue.Subject;var $v_4=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.IncidentResolution,Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty()),$v_5=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_4,$v_1,$v_0,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_5.get_changedFieldNames().addRange($v_2);Xrm.Internal.messages.closeIncident($v_5,returnValue.StatusCode).then(successCallback,Mscrm.CommandBarActions.actionFailedCallback)}};Mscrm.CommandBarActions.cancel=function(){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))return;if(!Xrm.Page.data.getIsValid())return;var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_ConfirmCancel.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_1=new Xrm.DialogOptions;$v_1.height=200;$v_1.width=600;var $v_2=0;if(Mscrm.CommandBarActions.isServiceMetadataAvailable())Xrm.Internal.messages.getValidStatusTransition(Xrm.Page.data.entity.getId(),2).then(function($p1_0){$v_2=$p1_0.get_result();switch($v_2){case 1:$v_0.get_query()["reason"]="novalidstatustransition";Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,null);break;case 2:$v_0.get_query()["reason"]="activeactivities";var $v_3=Mscrm.CommandBarActions.performActionAfterConfirmCancelCase;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_3);break;case 3:var $v_4=Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx");$v_4.get_query()["pId"]=Xrm.Page.data.entity.getId();$v_1.height=230;$v_1.width=520;var $v_5=Mscrm.CommandBarActions.performActionAfterCancelCase;Xrm.Internal.openDialog($v_4.toString(),$v_1,null,null,$v_5);break;case 4:var $v_6=Mscrm.CrmUri.create("/_common/error/dlg_error.aspx");$v_6.get_query()["hresult"]="0x80044411";Xrm.Internal.openDialog($v_6.toString(),$v_1,null,null,null);break}},function($p1_0){return});else Mscrm.CommandBarActions.$d()};Mscrm.CommandBarActions.performActionAfterConfirmCancelCase=function(returnValue){if(returnValue){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();var $v_1=new Xrm.DialogOptions;$v_1.height=230;$v_1.width=520;var $v_2=Mscrm.CommandBarActions.performActionAfterCancelCase;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)}};Mscrm.CommandBarActions.performActionAfterCancelCase=function(returnValue){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){Xrm.Page.context.saveMode=Xrm.SaveMode.save;Xrm.Page.data.save().then(function(){var $v_0=Xrm.Page.data.entity.getId(),$v_1=2;Xrm.Internal.messages.setState(Mscrm.InternalUtilities.EntityNames.Incident,$v_0,$v_1,returnValue.StatusCode).then(function(){Xrm.Page.data.refresh(true)},Mscrm.CommandBarActions.actionFailedCallback)},Mscrm.CommandBarActions.$3)}};Mscrm.CommandBarActions.reactivate=function(){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_reactivate.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();var $v_1=new Xrm.DialogOptions;$v_1.height=200;$v_1.width=600;var $v_2=0;if(Mscrm.CommandBarActions.isServiceMetadataAvailable())Xrm.Internal.messages.getValidStatusTransition(Xrm.Page.data.entity.getId(),0).then(function($p1_0){$v_2=$p1_0.get_result();if($v_2===1){$v_0.get_query()["reason"]="novalidstatustransition";$v_1.height=230;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,null)}else{$v_1.height=190;$v_1.width=535;var $v_3=Mscrm.CommandBarActions.performActionAfterReactivateCase;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_3)}},function($p1_0){return});else{$v_1.height=190;$v_1.width=535;var $v_4=Mscrm.CommandBarActions.performActionAfterReactivateCase;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_4)}};Mscrm.CommandBarActions.performActionAfterReactivateCase=function(returnValue){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue.StatusCode))if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile){var $v_0=0;Xrm.Internal.messages.setState(Mscrm.InternalUtilities.EntityNames.Incident,Xrm.Page.data.entity.getId(),$v_0,returnValue.StatusCode).then(function(){Xrm.Page.data.refresh(true)},Mscrm.CommandBarActions.actionFailedCallback)}else{var $v_1={};$v_1["StatusCode"]=returnValue.StatusCode;Mscrm.RefreshPageCommandHandler.executeCommand(Mscrm.InlineCommands.Reactivate,$v_1)}};Mscrm.CommandBarActions.runRoutingRuleAndClose=function(){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_routecase.aspx");$v_0.get_query()["iTotal"]=1;var $v_1=new Xrm.DialogOptions;$v_1.height=200;$v_1.width=400;var $v_2=Mscrm.CommandBarActions.performActionAfterRunRoutingRule;Xrm.Internal.openDialog($v_0.toString(),$v_1,[Xrm.Page.data.entity.getId()],null,$v_2)};Mscrm.CommandBarActions.performActionAfterRunRoutingRule=function(result){if(!Mscrm.InternalUtilities.JSTypes.isNull(result)&&result.toString()==="false")return;else if(Mscrm.CommandBarActions.isMobileCompanionApp())window.setTimeout(function(){Xrm.Page.ui.close()},200);else Mscrm.Utilities.closeCurrentWindow()};Mscrm.CommandBarActions.createChildCase=function(){var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Page.data.entity.getEntityName();if(Mscrm.CommandBarActions.isMobileCompanionApp())Xrm.Utility.create($v_1,new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Incident,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_0)),null,null,null);else Mscrm.ReadFormUtilities.execute(Mscrm.InlineCommands.CreateChild)};Mscrm.CommandBarActions.isNotChildCase=function(){var $v_0=null;if(!IsNull(Xrm.Page.data)&&!IsNull(Xrm.Page.data.entity)&&!IsNull(Xrm.Page.data.entity.attributes))$v_0=Xrm.Page.data.entity.attributes.get("parentcaseid");return !($v_0&&$v_0.getValue())};Mscrm.CommandBarActions.openNewRecord=function(entityLogicalName,parentEntityAttributes,callback){if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(entityLogicalName))return;Xrm.Utility.create(entityLogicalName,null,null,parentEntityAttributes,callback)};Mscrm.CommandBarActions.changeState=function(action,entityId,entityName){Mscrm.CommandBarActions.handleStateChangeAction(action,entityId,entityName)};Mscrm.CommandBarActions.handleStateChangeAction=function(action,entityId,entityName){var $v_0=250,$v_1=420,$v_2=Xrm.Internal.getEntityCode(entityName),$v_3=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri(action,$v_2,1);$v_3.get_query()["iObjType"]=$v_2;$v_3.get_query()["iTotal"]="1";$v_3.get_query()["sIds"]=entityId;$v_3.get_query()["confirmMode"]="1";var $v_4=[action,entityId,entityName],$v_5=new Xrm.DialogOptions;$v_5.height=$v_0;$v_5.width=$v_1;var $v_6=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.performActionAfterStateChange,$v_4);Xrm.Internal.openDialog($v_3.toString(),$v_5,[entityId],null,$v_6)};Mscrm.CommandBarActions.createCallbackFunctionFactory=function(func,parameters){return function(retValue){parameters.unshift(retValue);return func.apply(null,parameters)}};Mscrm.CommandBarActions.performActionAfterStateChange=function(returnInfo,action,entityId,entityName){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnInfo)&&returnInfo){var $v_0=returnInfo,$v_1=Mscrm.CommandBarActions.$O($v_0["iStatusCode"]),$v_2=Mscrm.CommandBarActions.$O($v_0["iStateCode"]),$v_3=0;switch(entityName){case Mscrm.InternalUtilities.EntityNames.Account:case Mscrm.InternalUtilities.EntityNames.Contact:case Mscrm.InternalUtilities.EntityNames.SystemUser:if(action==="activate"){$v_2=0;Xrm.Page.context.saveMode=Xrm.SaveMode.reactivate}else if(action==="deactivate"){$v_2=1;Xrm.Page.context.saveMode=Xrm.SaveMode.deactivate}break;case Mscrm.InternalUtilities.EntityNames.Entitlement:if(action==="activate")$v_2=1;else if(action==="deactivate")$v_2=0;break;case Mscrm.InternalUtilities.EntityNames.CampaignActivity:if(action==="deactivatecampactivity"){$v_3=Xrm.SaveMode.deactivate;var $v_4=new Mscrm.CampaignActivityStateHandler;$v_4.setDates($v_0["iStartDate"],$v_0["iEndDate"]);$v_4.updateState()}break}if(action==="activate")$v_3=Xrm.SaveMode.reactivate;else if(action==="deactivate")$v_3=Xrm.SaveMode.deactivate;Xrm.Page.context.saveMode=$v_3;Mscrm.CommandBarActions.setState(entityId,entityName,$v_2,$v_1)}};Mscrm.CommandBarActions.$O=function($p0){return $p0?parseInt($p0.toString()):-1};Mscrm.CommandBarActions.closeActivity=function(entityId,entityName){Mscrm.CommandBarActions.handleStateChangeAction("deactivate",entityId,entityName)};Mscrm.CommandBarActions.markActivityComplete=function(entityId,entityName,closeWindow,entityToOpen,entityIdToOpen){if(entityName!==Mscrm.InternalUtilities.EntityNames.Appointment)if(entityName===Mscrm.InternalUtilities.EntityNames.SocialActivity)Mscrm.CommandBarActions.setState(entityId,entityName,1,1,closeWindow,entityToOpen,entityIdToOpen);else Mscrm.CommandBarActions.setState(entityId,entityName,1,-1,closeWindow,entityToOpen,entityIdToOpen);else Mscrm.CommandBarActions.setState(entityId,entityName,-1,3,closeWindow,entityToOpen,entityIdToOpen)};Mscrm.CommandBarActions.isMobileCompanionApp=function(){return Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile};Mscrm.CommandBarActions.refreshForm=function(){Xrm.Page.data.refresh(true)};Mscrm.CommandBarActions.createRefreshFormCallback=function(){var $v_0=Mscrm.CommandBarActions.refreshForm;return $v_0};Mscrm.CommandBarActions.actionFailedCallback=function(response){var $v_0=response.get_organizationServiceFault();if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_1=$v_0.get_errorCode();Mscrm.CommandBarActions.$B($v_1,response.get_message(),$v_0.get_responseOuterXml())}};Mscrm.CommandBarActions.$W=function($p0){!Mscrm.CommandBarActions.isMobileCompanionApp()&&Xrm.Internal.raiseRecordsDeletedEvent($p0)};Mscrm.CommandBarActions.$3=function($p0){var $v_0=$p0.errorCode,$v_1=$p0.message;Mscrm.CommandBarActions.$B($v_0,$v_1)};Mscrm.CommandBarActions.selectResourceString=function(resourceStringMoca,resourceString){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return Xrm.Internal.getResourceString(resourceStringMoca);else return Xrm.Internal.getResourceString(resourceString)};Mscrm.CommandBarActions.$B=function($p0,$p1,$p2){var $v_0="0x"+($p0<0?4294967295+$p0+1:$p0).toString(16).toUpperCase();if($v_0.startsWith("0x8004E1"))switch($v_0){case "0x8004E108":case "0x8004E121":case "0x8004E117":case "0x8004E123":case "0x8004E122":case "0x8004E113":$p1=Xrm.Internal.getErrorMessage($p0);break;default:$p1=Xrm.Internal.getErrorMessage(Mscrm.CommandBarActions.$M);break}else switch($p0){case -2147220891:case -2147224494:break;default:var $v_1=Xrm.Internal.getErrorMessage($p0);if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_1))$p1=$v_1;break}Xrm.Internal.openErrorDialog($p0,$p1,$p2)};Mscrm.CommandBarActions.qualifyLeadQuick=function(){if(!IsNull(Mscrm.LeadCommandActions)){Mscrm.LeadCommandActions.qualifyLeadQuick();return}Mscrm.CommandBarActions.qualifyLeadAs(-1)};Mscrm.CommandBarActions.qualifyLeadAs=function(qualifyStatus){if(Mscrm.InternalUtilities.JSTypes.isNull(Xrm.Page.data.entity.getId()))return;if(!Xrm.Page.data.getIsValid())return;Xrm.Page.context.saveMode=Xrm.SaveMode.qualify;Xrm.Page.data.save().then(function(){Mscrm.CommandBarActions.$p(qualifyStatus)},Mscrm.CommandBarActions.$3);Xrm.Page.context.saveMode=-1};Mscrm.CommandBarActions.$p=function($p0){Mscrm.CommandBarActions.getTransactionCurrencyId(function($p1_0){Mscrm.CommandBarActions.$C($p0,$p1_0,false)},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.disqualifyLeadQuick=function(){if(!IsNull(Mscrm.LeadCommandActions)){Mscrm.LeadCommandActions.disqualifyLeadQuick();return}Mscrm.CommandBarActions.disqualifyLeadAs(-1)};Mscrm.CommandBarActions.disqualifyLeadAs=function(disqualifyStatus){Xrm.Page.context.saveMode=Xrm.SaveMode.disqualify;var $v_0=2;Mscrm.CommandBarActions.setState(Xrm.Page.data.entity.getId(),Mscrm.InternalUtilities.EntityNames.Lead,$v_0,disqualifyStatus);Xrm.Page.context.saveMode=-1};Mscrm.CommandBarActions.$C=function($p0,$p1,$p2){var $v_0=null,$v_1=null,$v_2=null,$v_3=null,$v_4=false,$v_5=false,$v_6=Mscrm.InternalUtilities._String.Empty,$v_7=false,$v_8=true,$v_9=true,$v_A=Mscrm.CommandBarActions.$9(Mscrm.CommandBarActions.$A("campaignid")),$v_B=null,$v_C=Mscrm.CommandBarActions.$A("parentaccountid");$v_0=Mscrm.CommandBarActions.$9($v_C);if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0)){$v_5=true;$v_2=$v_C.name}var $v_D=Mscrm.CommandBarActions.$A("parentcontactid");$v_1=Mscrm.CommandBarActions.$9($v_D);if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_1)){$v_4=true;$v_3=$v_D.name}var $v_E=Xrm.Page.getAttribute("companyname");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_E)){var $v_J=$v_E.getValue();if(!Mscrm.InternalUtilities.JSTypes.isNull($v_J))$v_6=$v_J}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_6))$v_7=true;if($v_5&&$v_4){$v_7=false;$v_8=false;$v_B=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Account,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_0))}else if($v_5){$v_7=false;$v_8=true}else if($v_4)if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_6)){$v_7=true;$v_8=false}else{$v_7=false;$v_8=false;$v_B=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Contact,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_1))}var $v_F=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Lead,new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId())),$v_G=Mscrm.InternalUtilities._String.isNullOrWhiteSpace($p1)?null:new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Lead,new Microsoft.Dynamics.Client.Core.Framework.Guid($p1)),$v_H=Mscrm.InternalUtilities._String.isNullOrWhiteSpace($v_A)?null:new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Campaign,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_A)),$v_I=function($p1_0){var $v_K=-2147220685;if($p1_0.get_organizationServiceFault().get_errorCode()===$v_K)Mscrm.CommandBarActions.$n($v_0,$v_1,$v_2,$v_3,$p0,$p1);else Mscrm.CommandBarActions.actionFailedCallback($p1_0)};Xrm.Internal.messages.qualifyLead($v_F,$v_7,$v_8,$v_9,$v_G,$v_B,$v_H,$p0,$p2).then(function($p1_0){for(var $v_L=$p1_0,$v_M=null,$v_N=0;$v_N<$v_L.get_createdEntities().length;$v_N++)if($v_L.get_createdEntities()[$v_N].LogicalName===Mscrm.InternalUtilities.EntityNames.Opportunity){$v_M=$v_L.get_createdEntities()[$v_N];break}if(!Mscrm.InternalUtilities.JSTypes.isNull($v_M)){var $v_O=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());Xrm.Internal.refreshParentGrid($v_O,"",Xrm.Page.data.entity.getId());Xrm.Utility.openEntityForm($v_M.LogicalName,$v_M.Id.toString(),{})}},$v_I)};Mscrm.CommandBarActions.$n=function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0=Mscrm.CrmUri.create("/SFA/Leads/Dialogs/dup_warning.aspx");$v_0.get_query()["parentAccountId"]=$p0;$v_0.get_query()["parentContactId"]=$p1;$v_0.get_query()["parentAccountName"]=$p2;$v_0.get_query()["parentContactName"]=$p3;$v_0.get_query()["qualifyStatus"]=$p4;$v_0.get_query()["transactionCurrencyId"]=$p5;var $v_1=new Xrm.DialogOptions;$v_1.width=400;$v_1.height=300;var $v_2=Mscrm.CommandBarActions.performActionAfterHandleLeadDuplication;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)};Mscrm.CommandBarActions.performActionAfterHandleLeadDuplication=function(returnValue){var $v_0=returnValue.qualifyStatus,$v_1=returnValue.transactionCurrencyId,$v_2=returnValue.parentAccountId,$v_3=returnValue.parentContactId,$v_4=returnValue.parentAccountName,$v_5=returnValue.parentContactName;Mscrm.CommandBarActions.$a("parentaccountid",$v_4,$v_2,Mscrm.InternalUtilities.EntityNames.Account);Mscrm.CommandBarActions.$a("parentcontactid",$v_5,$v_3,Mscrm.InternalUtilities.EntityNames.Contact);if(Xrm.Page.data.entity.getIsDirty())Xrm.Page.data.save().then(function(){Mscrm.CommandBarActions.$C($v_0,$v_1,true)},Mscrm.CommandBarActions.$3);else Mscrm.CommandBarActions.$C($v_0,$v_1,true)};Mscrm.CommandBarActions.$A=function($p0){var $v_0=Xrm.Page.getAttribute($p0);if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_2=$v_0.getValue();if(!Mscrm.InternalUtilities.JSTypes.isNull($v_2))return $v_2[0]}var $v_1=new Xrm.LookupObject;return $v_1};Mscrm.CommandBarActions.$9=function($p0){var $v_0=null;if(!Mscrm.InternalUtilities.JSTypes.isNull($p0))$v_0=$p0.id;return $v_0};Mscrm.CommandBarActions.$a=function($p0,$p1,$p2,$p3){var $v_0=Xrm.Page.getAttribute($p0);if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)&&!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($p2)){if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0.getValue()))if($v_0.getValue()[0].id===$p2)return;var $v_1=new Xrm.LookupObject;$v_1.entityType=$p3;$v_1.id=$p2;$v_1.name=$p1;var $v_2=new Array(1);$v_2[0]=$v_1;$v_0.setValue($v_2);Xrm.Page.data.setFormDirty(true)}};Mscrm.CommandBarActions.getTransactionCurrencyId=function(succeedCallback,errorCallback){var $v_0=Xrm.Page.getAttribute("transactioncurrencyid");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_3=$v_0.getValue();if(!Mscrm.InternalUtilities.JSTypes.isNull($v_3)&&$v_3.length>0){succeedCallback($v_3[0].id);return}}var $v_1=Xrm.Page.context.getUserId(),$v_2=["transactioncurrencyid","organizationid"];Xrm.Internal.messages.retrieve(Mscrm.InternalUtilities.EntityNames.SystemUser,$v_1,$v_2).then(function($p1_0){var $v_4=$p1_0.get_entity();if($v_4.hasValue("transactioncurrencyid"))succeedCallback($v_4.getValue("transactioncurrencyid").Id.toString());else{$v_1=$v_4.getValue("organizationid").toString();$v_2=["basecurrencyid"];Xrm.Internal.messages.retrieve(Mscrm.InternalUtilities.EntityNames.Organization,$v_1,$v_2).then(function($p2_0){var $v_5=$p2_0.get_entity();succeedCallback($v_5.getValue("basecurrencyid").Id.toString())},errorCallback)}},errorCallback)};Mscrm.CommandBarActions.convertToOpportunity=function(successCallback,errorCallback,targetEntitySubject,activityId,activityTypeCode,customerId,customerTypeCode,ownerId,ownerTypeCode,leadId,currencyId,campaignId,campaignTypeCode,logResponse){var $v_0=Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty().toString(),$v_1=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Opportunity,Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty(),targetEntitySubject),$v_2={},$v_3={},$v_4=new Array(0),$v_5="name";$v_2[$v_5]=targetEntitySubject;$v_3[$v_5]=14;$v_4[$v_4.length]=$v_5;if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(currencyId)&&currencyId!==$v_0){$v_5="transactioncurrencyid";var $v_7=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.TransactionCurrency,new Microsoft.Dynamics.Client.Core.Framework.Guid(currencyId));$v_2[$v_5]=$v_7;$v_3[$v_5]=6;$v_4[$v_4.length]=$v_5}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(campaignId)&&campaignId!==$v_0){$v_5="campaignid";var $v_8=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(campaignTypeCode?Xrm.Internal.getEntityName(campaignTypeCode):Mscrm.InternalUtilities.EntityNames.Campaign,new Microsoft.Dynamics.Client.Core.Framework.Guid(campaignId));$v_2[$v_5]=$v_8;$v_3[$v_5]=6;$v_4[$v_4.length]=$v_5}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(leadId)&&leadId!==$v_0){$v_5="leadid";var $v_9=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Lead,new Microsoft.Dynamics.Client.Core.Framework.Guid(leadId));$v_2[$v_5]=$v_9;$v_3[$v_5]=6;$v_4[$v_4.length]=$v_5}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(customerId)&&customerId!==$v_0){$v_5="customerid";var $v_A=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Internal.getEntityName(customerTypeCode),new Microsoft.Dynamics.Client.Core.Framework.Guid(customerId));$v_2[$v_5]=$v_A;$v_3[$v_5]=6;$v_4[$v_4.length]=$v_5}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(ownerId)&&ownerId!==$v_0){$v_5="ownerid";var $v_B=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Internal.getEntityName(ownerTypeCode),new Microsoft.Dynamics.Client.Core.Framework.Guid(ownerId));$v_2[$v_5]=$v_B;$v_3[$v_5]=6;$v_4[$v_4.length]=$v_5}var $v_6=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_1,$v_2,$v_3,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_6.get_changedFieldNames().addRange($v_4);Xrm.Internal.messages.convertActivity(activityId,Xrm.Internal.getEntityName(activityTypeCode),$v_6,Mscrm.InternalUtilities.EntityNames.Opportunity,logResponse).then(successCallback,errorCallback)};Mscrm.CommandBarActions.deletePrimaryRecord=function(id,entityName){var $v_0=450,$v_1=205,$v_2=null,$v_3=Xrm.Internal.getEntityCode(entityName),$v_4=[id],$v_5=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete.aspx");$v_5.get_query()["iObjType"]=$v_3;$v_5.get_query()["iTotal"]="1";$v_5.get_query()["sIds"]=id;switch(entityName){case Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster:$v_5=Mscrm.CrmUri.create("/activities/act_dlgs/dlg_seriesaction.aspx");$v_5.get_query()["actionType"]="6";$v_5.get_query()["iTotal"]="1";$v_5.get_query()["insDel"]=Mscrm.CommandBarActions.$o();$v_0=520;$v_1=240;break;case Mscrm.InternalUtilities.EntityNames.Appointment:var $v_6=Xrm.Page.data.entity.attributes.get("instancetypecode");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_6)&&$v_6.getValue().toString()!=="0"&&$v_6.getValue().toString()!=="1"){$v_5=Mscrm.CrmUri.create("/activities/act_dlgs/dlg_seriesaction.aspx");$v_5.get_query()["actionType"]="5";$v_5.get_query()["iTotal"]="1";$v_5.get_query()["eId"]=id;$v_0=380;$v_1=270}break;case Mscrm.InternalUtilities.EntityNames.Account:$v_5=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete_account.aspx");$v_5.get_query()["iObjType"]=$v_3;$v_5.get_query()["iTotal"]="1";$v_5.get_query()["sIds"]=id;$v_0=450;$v_1=250;break;case Mscrm.InternalUtilities.EntityNames.Contact:$v_5=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete_contact.aspx");$v_5.get_query()["iObjType"]=$v_3;$v_5.get_query()["iTotal"]="1";$v_5.get_query()["sIds"]=id;$v_0=450;$v_1=250;break}$v_2=[$v_3,id];var $v_7=new Xrm.DialogOptions;$v_7.height=$v_1;$v_7.width=$v_0;var $v_8=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.CommandBarActions.performActionAfterDelete,$v_2);Xrm.Internal.openDialog($v_5.toString(),$v_7,$v_4,null,$v_8)};Mscrm.CommandBarActions.performActionAfterDelete=function(result,objectType,recordId){if(result){Mscrm.CommandBarActions.$W([recordId]);Xrm.Page.data.setFormDirty(false);Xrm.Internal.refreshParentGrid(objectType,"",recordId);window.setTimeout(function(){Xrm.Page.ui.close()},200)}};Mscrm.CommandBarActions.$o=function(){if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))return true;var $v_0=Xrm.Page.data.entity.attributes.get("seriesstatus");return !!$v_0&&(!$v_0.getValue()||$v_0.getValue())};Mscrm.CommandBarActions.isRefreshForm=function(){if(Mscrm.CommandBarActions.isMobileCompanionApp())return true;return Mscrm.InternalUtilities.Utilities.isRefreshForm()};Mscrm.CommandBarActions.alwaysEnabled=function(){return true};Mscrm.CommandBarActions.isIpadOnpremise=function(){if(Xrm.Page.context.isCrmOnline())return false;if(Mscrm.CommandBarActions.isMobileCompanionApp()||!Mscrm.InternalUtilities.Utilities.isIosDevice())return false;return true};Mscrm.CommandBarActions.isClaimsAuth=function(){return window.IS_CLAIMS};Mscrm.CommandBarActions.isServiceMetadataAvailable=function(){if(Mscrm.InternalUtilities.Utilities.checkIfServiceMetaDataAvailable())return true;return false};Mscrm.CommandBarActions.isServiceMetadataNotAvailable=function(){if(!Mscrm.InternalUtilities.Utilities.checkIfServiceMetaDataAvailable())return true;return false};Mscrm.CommandBarActions.disassociate=function(gridControl,selectedRecords){if(!selectedRecords)selectedRecords=gridControl.getSelectedRecordReferences();for(var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Page.data.entity.getEntityName(),$v_2=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference($v_1,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_0)),$v_3=gridControl.getRelationshipName(),$v_4=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.Relationship($v_3),$v_5=new Array(selectedRecords.length),$v_6=0;$v_6<selectedRecords.length;$v_6++){var $v_7=selectedRecords[$v_6],$v_8=Xrm.Internal.getEntityName($v_7.TypeCode);$v_5[$v_6]=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference($v_8,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_7.Id.toString()))}Xrm.Internal.messages.disassociate($v_2,$v_4,$v_5).then(function($p1_0){!Mscrm.InternalUtilities.JSTypes.isNull(gridControl)&&gridControl.refresh()},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.opportunityClose=function(isWon){if(!Xrm.Page.data.getIsValid())return;var $v_0=Xrm.Page.data.entity.getId();if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0))return;if(Xrm.Page.data.entity.getIsDirty())Xrm.Page.data.save().then(function(){Mscrm.CommandBarActions.$c(isWon)},Mscrm.CommandBarActions.$3);else Mscrm.CommandBarActions.$c(isWon)};Mscrm.CommandBarActions.$c=function($p0){var $v_0=Mscrm.CrmUri.create("/SFA/opps/dlg_closeopp.aspx");$v_0.get_query()["pId"]=Xrm.Page.data.entity.getId();$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Opportunity;$v_0.get_query()["won"]=$p0;var $v_1=new Xrm.DialogOptions;$v_1.height=420;$v_1.width=Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile?500:450;var $v_2=Mscrm.CommandBarActions.performActionAfterOpportunityClose;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)};Mscrm.CommandBarActions.performActionAfterOpportunityClose=function(returnValue){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_0=Xrm.Page.data.entity.getId(),$v_1=function(){Xrm.Page.data.refresh(true)};Mscrm.CommandBarActions.$V(returnValue,$v_0,$v_1)}};Mscrm.CommandBarActions.opportunityReopen=function(){Mscrm.CommandBarActions.setState(Xrm.Page.data.entity.getId(),Mscrm.InternalUtilities.EntityNames.Opportunity,0)};Mscrm.CommandBarActions.$V=function($p0,$p1,$p2){if(!Mscrm.InternalUtilities.JSTypes.isNull($p0)){var $v_0={},$v_1={},$v_2=new Array(4),$v_3="opportunityid";$v_2[0]=$v_3;$v_0[$v_3]=6;$v_1[$v_3]=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Opportunity,new Microsoft.Dynamics.Client.Core.Framework.Guid($p1));$v_3="actualrevenue";$v_2[1]=$v_3;$v_0[$v_3]=8;$v_1[$v_3]=$p0.actualRevenue;$v_3="description";$v_2[2]=$v_3;$v_0[$v_3]=14;$v_1[$v_3]=$p0.description;$v_3="actualend";$v_2[3]=$v_3;$v_0[$v_3]=2;$v_1[$v_3]=Xrm.Internal.parseDate($p0.actualEnd);if(!Mscrm.InternalUtilities.JSTypes.isNull($p0.competitor)){$v_3="competitorid";$v_2[4]=$v_3;$v_0[$v_3]=6;$v_1[$v_3]=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.Competitor,new Microsoft.Dynamics.Client.Core.Framework.Guid($p0.competitor))}var $v_4=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.OpportunityClose,Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty()),$v_5=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_4,$v_1,$v_0,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_5.get_changedFieldNames().addRange($v_2);if($p0.state===1)Xrm.Internal.messages.winOpportunity($v_5,$p0.reason).then($p2,Mscrm.CommandBarActions.actionFailedCallback);else Xrm.Internal.messages.loseOpportunity($v_5,$p0.reason).then($p2,Mscrm.CommandBarActions.actionFailedCallback)}};Mscrm.CommandBarActions.opportunityRecalculate=function(){Xrm.Page.data.refresh(true)};Mscrm.CommandBarActions.saveAsCompleted=function(){var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Page.data.entity.getEntityName();Xrm.Page.context.saveMode=Xrm.SaveMode.saveAsCompleted;Mscrm.CommandBarActions.setState($v_0,$v_1,1,-1,true)};Mscrm.CommandBarActions.saveForm=function(saveMode){if(Mscrm.InternalUtilities._String.isNullOrWhiteSpace(saveMode))Xrm.Page.data.entity.save();else Xrm.Page.data.entity.save(saveMode)};Mscrm.CommandBarActions.bookOrReschedule=function(isInvocationSourceFormInfra,isValidated){Mscrm.CommandBarActions.bookOrRescheduleWithCallback(isInvocationSourceFormInfra,isValidated,null)};Mscrm.CommandBarActions.bookOrRescheduleWithCallback=function(isInvocationSourceFormInfra,isValidated,succeedCallback){if(Mscrm.InternalUtilities.JSTypes.isNull(isValidated)||!isValidated)if(!Xrm.Page.data.getIsValid())return;if(Mscrm.CommandBarActions.$m())return;if(!Xrm.Page.context.isOutlookOnline()){Xrm.Page.data.entity.save();return}var $v_0=Xrm.Page.data.entity.getEntityName(),$v_1=Mscrm.CommandBarActions.createAppointmentRecord();if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId()))Xrm.Internal.messages.book($v_1).then(function($p1_0){Mscrm.CommandBarActions.$Q($p1_0,$v_0,isInvocationSourceFormInfra,succeedCallback)},Mscrm.CommandBarActions.actionFailedCallback);else Xrm.Internal.messages.reschedule($v_1).then(function($p1_0){Mscrm.CommandBarActions.$Q($p1_0,$v_0,isInvocationSourceFormInfra,succeedCallback)},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.createAppointmentRecord=function(){var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Page.data.entity.getEntityName(),$v_2={};$v_2["isalldayevent"]=0;$v_2["seriesstatus"]=0;$v_2["organizer"]=10;$v_2["isnthmonthly"]=0;$v_2["isnthyearly"]=0;$v_2["isweekdaypattern"]=0;$v_2["isregenerate"]=0;$v_2["stageid"]=15;$v_2["processid"]=15;var $v_3=Mscrm.SdkSerializationHelper.getEntityObject($v_1,Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0)?Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty():new Microsoft.Dynamics.Client.Core.Framework.Guid($v_0),$v_2),$v_4=5,$v_5=Xrm.Page.getAttribute("statuscode");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_5)&&!Mscrm.InternalUtilities.JSTypes.isNull($v_5.getValue()))$v_4=$v_5.getValue();$v_3.initializeValue("statuscode",$v_4,13);!$v_3.get_changedFieldNames().contains("statuscode")&&$v_3.get_changedFieldNames().addRange(["statuscode"]);var $v_6=Xrm.Page.getAttribute("isalldayevent"),$v_7=false;if(!Mscrm.InternalUtilities.JSTypes.isNull($v_6))$v_7=$v_6.getValue();$v_3.initializeValue("isalldayevent",$v_7,0);return $v_3};Mscrm.CommandBarActions.$m=function(){if(Mscrm.CommandBarActions.isMobileCompanionApp())return false;if(Xrm.Page.data.entity.getEntityName()!==Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster)return false;var $v_0=window._appointId;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0))return false;Mscrm.CommandBarActions.addRecurrenceSdkCall($v_0);return true};Mscrm.CommandBarActions.addRecurrenceSdkCall=function(appointmentId){var $v_0=Mscrm.CommandBarActions.createAppointmentRecord();Xrm.Internal.messages.addRecurrence($v_0,Microsoft.Dynamics.Client.Core.Framework.Guid.tryCreate(appointmentId)).then(function($p1_0){var $v_1=$p1_0.get_id(),$v_2=Xrm.Page.data.entity.attributes.get("activityid");!Mscrm.InternalUtilities.JSTypes.isNull($v_2)&&$v_2.setValue($v_1.toString());Xrm.Internal.refreshParentGrid(Mscrm.EntityTypeCode.ActivityPointer,Mscrm.InternalUtilities._String.Empty,Xrm.Page.data.entity.getId());Xrm.Page.data.setFormDirty(false);Xrm.Page.data.refresh(false)},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.$Q=function($p0,$p1,$p2,$p3){var $v_0=Xrm.Internal.getEntityCode($p1);if($p0.get_validationResult().get_validationSuccess()){var $v_1=$p0.get_validationResult().get_activityId().toString(),$v_2=Xrm.Page.data.entity.attributes.get("activityid");!Mscrm.InternalUtilities.JSTypes.isNull($v_2)&&$v_2.setValue($v_1);var $v_3=Xrm.Page.data.entity.attributes.get("ownerid"),$v_4=$v_3.getIsDirty();if($v_4&&!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(Xrm.Page.data.entity.getId())){window.DoNotScheduleAppointment=true;Xrm.Page.data.save().then(function(){!Mscrm.InternalUtilities.JSTypes.isNull($p3)&&$p3(null)},null)}else Mscrm.CommandBarActions.saveAndRefresh($v_0,$v_1,$p3)}else if(!$p2){if($v_0!==-1){Xrm.Page.ui.clearFormNotification("BookOrRescheduleSaveError");var $v_5=new Xrm.DialogOptions;$v_5.height=300;$v_5.width=600;var $v_6=Mscrm.CrmUri.create("/SM/ActivityScheduling/SchedulingNotificationsDialog.aspx?activityType="+$v_0),$v_7=[$p3],$v_8=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.dialogAction,$v_7);Xrm.Internal.openDialog($v_6.toString(),$v_5,$p0.get_notifications(),null,$v_8)}}else for(var $$arr_D=$p0.get_notifications(),$$len_E=$$arr_D.length,$$idx_F=0;$$idx_F<$$len_E;++$$idx_F){var $v_9=$$arr_D[$$idx_F],$v_A="ERROR";switch($v_9.get_severity()){case 1:$v_A="ERROR";break;case 2:$v_A="WARNING";break;case 3:$v_A="INFORMATION";break}Xrm.Page.ui.clearFormNotification("BookOrRescheduleSaveError");Xrm.Page.ui.setFormNotification($v_9.get_message(),$v_A,"BookOrRescheduleSaveError")}};Mscrm.CommandBarActions.saveAndRefresh=function(etc,id,succeedCallback){Xrm.Page.data.setFormDirty(false);Xrm.Internal.refreshParentGrid(etc,Mscrm.InternalUtilities._String.Empty,id);var $v_0=Xrm.Page.data.entity.getEntityName();if($v_0===Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster||$v_0===Mscrm.InternalUtilities.EntityNames.Appointment)Xrm.Page.data.refreshAppointment(id).then(function(){Mscrm.CommandBarActions.$R(id,succeedCallback)},null);else Xrm.Page.data.refresh(false).then(function(){Mscrm.CommandBarActions.$R(id,succeedCallback)},null)};Mscrm.CommandBarActions.$R=function($p0,$p1){if(!Mscrm.InternalUtilities.JSTypes.isNull($p1)){var $v_0=Xrm.Page.data.entity.attributes.get("subject"),$v_1={},$v_2={};$v_2["Id"]=$p0;$v_2["Name"]=$v_0.getValue();$v_2["TypeDisplayName"]=Xrm.Page.data.entity.getEntityName();$v_2["TypeName"]=Xrm.Page.data.entity.getEntityName();$v_2["TypeCode"]=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());$v_1["_entity"]=$v_2;$p1($v_1)}};Mscrm.CommandBarActions.dialogAction=function(result,succeedCallback){switch(result){case "Save":Xrm.Page.ui.clearFormNotification("recurrenceDescription");var $v_0=Xrm.Page.getAttribute("statuscode");!Mscrm.InternalUtilities.JSTypes.isNull($v_0)&&!$v_0.getIsDirty()&&$v_0.setValue(5);window.DoNotScheduleAppointment=true;Xrm.Page.data.save().then(function(){!Mscrm.InternalUtilities.JSTypes.isNull(succeedCallback)&&succeedCallback(null)},null);break;default:break}};Mscrm.CommandBarActions.sendInvite=function(){if(Xrm.Page.data.getIsValid()){var $v_0=Mscrm.CommandBarActions.$j();if(!$v_0){Mscrm.CommandBarActions.$X();return}var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_confirm_invitereset.aspx");Mscrm.CommandBarActions.$b($v_1,Mscrm.CommandBarActions.confirmInviteReset,400,200)}};Mscrm.CommandBarActions.confirmInviteReset=function($p0){if(!Mscrm.InternalUtilities.JSTypes.isNull($p0))$p0&&Mscrm.CommandBarActions.$X()};Mscrm.CommandBarActions.$X=function(){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_sendinvite.aspx");$v_0.get_query()["userid"]=Xrm.Page.data.entity.getId();$v_0.get_query()["isform"]=true;Mscrm.CommandBarActions.$b($v_0,Mscrm.CommandBarActions.performSendInviteAction,450,270)};Mscrm.CommandBarActions.performSendInviteAction=function($p0){if(!Mscrm.InternalUtilities.JSTypes.isNull($p0))$p0&&Xrm.Internal.messages.inviteUser(Xrm.Page.data.entity.getId()).then(function(){Xrm.Page.data.refresh(true)},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.$j=function(){var $v_0=Xrm.Page.data.entity.attributes.get("invitestatuscode");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0))return $v_0.getValue();return 0};Mscrm.CommandBarActions.$b=function($p0,$p1,$p2,$p3){var $v_0=new Xrm.DialogOptions;$v_0.width=$p2;$v_0.height=$p3;Xrm.Internal.openDialog($p0.toString(),$v_0,null,null,$p1)};Mscrm.CommandBarActions.sendFormShortcut=function(usingEmail,form){if(Mscrm.CommandBarActions.isRefreshForm()){var $v_0=Xrm.Page.data.entity;Mscrm.CommandBarActions.$f(usingEmail,CrmEncodeDecode.CrmHtmlDecode($v_0.getPrimaryAttributeValue()),$v_0.getId(),$v_0.getEntityName())}else Mscrm.RibbonActions.sendFormShortcutLegacy(usingEmail,form)};Mscrm.CommandBarActions.sendSelectedRecordsUrl=function(useEmail,records,entityTypeCode){if(Mscrm.CommandBarActions.isMobileCompanionApp())Mscrm.CommandBarActions.$g(records,entityTypeCode);else Mscrm.Utilities.sendSelectedRecordsUrl(useEmail,records,entityTypeCode)};Mscrm.CommandBarActions.$f=function($p0,$p1,$p2,$p3){if(Mscrm.CommandBarActions.isMobileCompanionApp()){var $v_0=Mscrm.CommandBarActions.$L(Xrm.Page.context.getClientUrl().toString(),Xrm.Internal.getEntityCode($p3),$p2),$v_1=Mscrm.CommandBarActions.$K("",$p1,$v_0,"");Xrm.Internal.openUrl($v_1)}else Mscrm.FormAction.sendFormShortcut($p0,$p1,$p2,$p3)};Mscrm.CommandBarActions.$g=function($p0,$p1){if(Mscrm.InternalUtilities.JSTypes.isNull($p0)||!$p0.length){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("LOCID_ACTION_NOITEMSELECTED"));return}if($p0.length>10){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("LOCID_MAX_RECORDS_ERROR"));return}for(var $v_0=Xrm.Page.context.getClientUrl().toString(),$v_1="",$v_4=0;$v_4<$p0.length;$v_4++){if($v_4>0)$v_1+="\r\n\r\n";$v_1+=$p0[$v_4].Name;$v_1+="\r\n";$v_1+="<";$v_1+=Mscrm.CommandBarActions.$L($v_0,$p1,$p0[$v_4].Id);$v_1+=">"}var $v_2="";if($p0.length===1)$v_2=$p0[0].Name;var $v_3=Mscrm.CommandBarActions.$K("",$v_2,$v_1.toString(),"");Xrm.Internal.openUrl($v_3)};Mscrm.CommandBarActions.$L=function($p0,$p1,$p2){var $v_0=Mscrm.CrmUri.create($p0+"/userdefined/edit.aspx?etc="+CrmEncodeDecode.CrmUrlEncode($p1.toString())+"&id="+CrmEncodeDecode.CrmUrlEncode($p2));return $v_0.toString()};Mscrm.CommandBarActions.$K=function($p0,$p1,$p2,$p3){var $v_0="mailto:",$v_1=$p0;if(!Mscrm.InternalUtilities.JSTypes.isNull($p0)&&$p0.length>0){var $v_2=$p0.lastIndexOf("@");if($v_2>=0&&$v_2<$p0.length)$v_1=CrmEncodeDecode.CrmUrlEncode($p0.substr(0,$v_2))+"@"+CrmEncodeDecode.CrmUrlEncode($p0.substr($v_2+1));else $v_1=CrmEncodeDecode.CrmUrlEncode($p0)}$v_0=$v_0+$v_1+"?";if(!Mscrm.InternalUtilities.JSTypes.isNull($p1)&&$p1.length>0)$v_0=$v_0+"subject="+CrmEncodeDecode.CrmUrlEncode($p1)+"&";if(!Mscrm.InternalUtilities.JSTypes.isNull($p3)&&$p3.length>0)$v_0=$v_0+"cc="+CrmEncodeDecode.CrmUrlEncode($p3)+"&";if(!Mscrm.InternalUtilities.JSTypes.isNull($p2))$v_0=$v_0+"body="+CrmEncodeDecode.CrmUrlEncode($p2);return $v_0};Mscrm.CommandBarActions.activate=function(entityId,entityName){if(Mscrm.CommandBarActions.isMobileCompanionApp()||Mscrm.Utilities.isRefreshForm()){var $v_0=0;switch(entityName){case Mscrm.InternalUtilities.EntityNames.CampaignResponse:Mscrm.CommandBarActions.campaignResponseActivate(entityId,entityName,$v_0);return;case Mscrm.InternalUtilities.EntityNames.ConvertRule:Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.ConvertRule,"activate",entityId,false);return;case Mscrm.InternalUtilities.EntityNames.DuplicateRule:case Mscrm.InternalUtilities.EntityNames.Quote:$v_0=1;break;case Mscrm.InternalUtilities.EntityNames.Contract:$v_0=2;break;case Mscrm.InternalUtilities.EntityNames.RoutingRule:Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.RoutingRule,"activate",entityId,false);return;case Mscrm.InternalUtilities.EntityNames.SLA:Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.SLA,"activate",entityId,false);return}if(Mscrm.InternalUtilities.Utilities.enforceStateTransitions(entityName))Mscrm.CommandBarActions.$2(Xrm.Internal.getEntityCode(entityName),"activate",entityId,false);else{Xrm.Page.context.saveMode=Xrm.SaveMode.reactivate;Mscrm.CommandBarActions.setState(entityId,entityName,$v_0)}}else{var $v_1=Xrm.Internal.getEntityCode(entityName);Mscrm.FormAction.changeState("activate",$v_1,6)}};Mscrm.CommandBarActions.campaignResponseActivate=function(entityId,entityName,stateCode){var $v_0=Mscrm.CrmUri.create("/MA/CampaignResponse/Dialogs/dlg_reactivateCampaignResponse.aspx"),$v_1=[entityId,entityName,stateCode],$v_2=new Xrm.DialogOptions;$v_2.height=300;$v_2.width=535;var $v_3=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.CommandBarActions.performActionAfterReactivateCampaignResponse,$v_1);Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,$v_3)};Mscrm.CommandBarActions.performActionAfterReactivateCampaignResponse=function(returnValue,entityId,entityName,stateCode){if(returnValue){Mscrm.CommandBarActions.setState(entityId,entityName,stateCode);if(!stateCode)CAMPAIGNRESPONSE_STATE="Open"}};Mscrm.CommandBarActions.deactivate=function(entityId,entityName){if(Mscrm.CommandBarActions.isMobileCompanionApp()||Mscrm.Utilities.isRefreshForm()){var $v_0=1;switch(entityName){case Mscrm.InternalUtilities.EntityNames.DuplicateRule:$v_0=0;break;case Mscrm.InternalUtilities.EntityNames.ConvertRule:Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.ConvertRule,"deactivate",entityId,false);return;case Mscrm.InternalUtilities.EntityNames.RoutingRule:Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.RoutingRule,"deactivate",entityId,false);return;case "sla":Mscrm.CommandBarActions.$2(Mscrm.EntityTypeCode.SLA,"deactivate",entityId,false);return}if(Mscrm.InternalUtilities.Utilities.enforceStateTransitions(entityName)){Mscrm.CommandBarActions.$2(Xrm.Internal.getEntityCode(entityName),"deactivate",entityId,false);return}Xrm.Internal.getStatusOptionsFromStateCode(entityName,$v_0).then(function($p1_0){if(IsNull($p1_0)||$p1_0.length<=1){Xrm.Page.context.saveMode=Xrm.SaveMode.deactivate;Mscrm.CommandBarActions.setState(entityId,entityName,$v_0)}else Mscrm.CommandBarActions.changeState("deactivate",entityId,entityName)},function(){Xrm.Page.context.saveMode=Xrm.SaveMode.deactivate;Mscrm.CommandBarActions.setState(entityId,entityName,$v_0)})}else{var $v_1=Xrm.Internal.getEntityCode(entityName);Mscrm.FormAction.changeState("deactivate",$v_1,5)}};Mscrm.CommandBarActions.deactivateCampaign=function(entityId){var $v_0="<fetch version='1.0' mapping='logical'><entity name='campaignactivity'><attribute name='activityid' /><filter type='and'><condition attribute='regardingobjectid' operator='eq' value='"+entityId+"' /></filter><filter type='and'><condition attribute='statecode' operator='eq' value='0' /></filter><filter type='and'><condition attribute='statuscode' operator='ne' value='5' /></filter><filter type='and'><condition attribute='statuscode' operator='ne' value='6' /></filter></entity></fetch>";Xrm.Internal.messages.retrieveMultiple($v_0).then(function($p1_0){if($p1_0.get_entityCollection().get_count()>0)Xrm.Internal.openErrorDialog(-2140980991,"");else{Xrm.Page.context.saveMode=Xrm.SaveMode.deactivate;Mscrm.CommandBarActions.setState(entityId,Mscrm.InternalUtilities.EntityNames.Campaign,1)}},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.setState=function(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen){if(Mscrm.InternalUtilities.JSTypes.isNull(Xrm.Page.data.entity.getId()))return;if(!Xrm.Page.data.getIsValid())return;if(typeof statusCode==="undefined")statusCode=-1;else if(stateCode===-1){Xrm.Internal.getStateCodeFromStatusOption(entityName,statusCode).then(function($p1_0){stateCode=$p1_0;Mscrm.CommandBarActions.$E(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen)},function(){Mscrm.CommandBarActions.$E(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen)});return}Mscrm.CommandBarActions.$E(entityId,entityName,stateCode,statusCode,closeWindow,entityToOpen,entityIdToOpen)};Mscrm.CommandBarActions.$E=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $v_0=function($p1_0){if(!$p0||!$p0.length)$p0=Xrm.Page.data.entity.getId();Xrm.Internal.messages.setState($p1,$p0,$p2,$p3).then(function($p2_0){if(typeof $p4!=="undefined"&&$p4){if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($p5)&&!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($p6)){!Mscrm.CommandBarActions.isMobileCompanionApp()&&Xrm.Page.ui.close();Xrm.Utility.openEntityForm($p5,$p6,null)}else{Mscrm.CommandBarActions.$D($p0,$p1);Xrm.Page.ui.close()}return}if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($p5)&&!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($p6))Xrm.Utility.openEntityForm($p5,$p6,null);else{Xrm.Page.data.refresh(true);Mscrm.CommandBarActions.$D($p0,$p1)}},Mscrm.CommandBarActions.actionFailedCallback)},$v_1=false;try{$v_1=Mscrm.InlineEditDataService.get_busy()}catch($$e_9){}!$v_1&&Xrm.Page.data.save().done($v_0)};Mscrm.CommandBarActions.$2=function($p0,$p1,$p2,$p3){var $v_0=function($p1_0){var $v_1=550,$v_2=200,$v_3=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri($p1,$p0,1),$v_4=new Array(1);$v_4[0]=$p2;if(Mscrm.InternalUtilities.Utilities.enforceStateTransitions(Xrm.Internal.getEntityName($p0))){$v_3.get_query()["iId"]=$p2;$v_1=500;$v_2=250}var $v_5=new Xrm.DialogOptions;$v_5.height=$v_2;$v_5.width=$v_1;var $v_6=[$p0,$p2,$p3],$v_7=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.refreshFormPage,$v_6);Xrm.Internal.openDialog($v_3.toString(),$v_5,$v_4,null,$v_7)};Xrm.Page.data.save().then($v_0,Mscrm.CommandBarActions.$3)};Mscrm.CommandBarActions.refreshFormPage=function(dialogReturnValue,entityTypeCode,entityId,closeWindow){if(!IsNull(dialogReturnValue)&&dialogReturnValue&&!IsNull(entityId)&&!IsNull(entityTypeCode)){Mscrm.CommandBarActions.$D(entityId,Xrm.Page.data.entity.getEntityName());!IsNull(closeWindow)&&closeWindow&&Xrm.Page.ui.close();Xrm.Utility.openEntityForm(Xrm.Page.data.entity.getEntityName(),entityId,null)}};Mscrm.CommandBarActions.$D=function($p0,$p1){if($p1){var $v_0=Xrm.Internal.getEntityCode($p1);Xrm.Internal.refreshParentGrid($v_0,"",$p0)}};Mscrm.CommandBarActions.isSlaActive=function(slaId){var $v_0=new RemoteCommand("CustomerService","IsSlaActive");$v_0.SetParameter("slaId",slaId);var $v_1=$v_0.Execute();return $v_1.ReturnValue};Mscrm.CommandBarActions.isSlaDefault=function(slaId){var $v_0=new RemoteCommand("CustomerService","IsSlaDefault");$v_0.SetParameter("slaId",slaId);var $v_1=$v_0.Execute();return $v_1.ReturnValue};Mscrm.CommandBarActions.updateSlaIfNoDefaultSlaExists=function(slaId){var $v_0=new RemoteCommand("CustomerService","UpdateSlaIfNoDefaultSlaExists");$v_0.SetParameter("slaId",slaId);var $v_1=$v_0.Execute();return $v_1.ReturnValue};Mscrm.CommandBarActions.setDefaultSla=function(entityId,entityName){if(Mscrm.CommandBarActions.isSlaActive(entityId)){var $v_0=Mscrm.CommandBarActions.updateSlaIfNoDefaultSlaExists(entityId);if(!IsNull($v_0)&&IsNull($v_0.length))refreshRibbon();else if(entityName.toString()===Mscrm.InternalUtilities.EntityTypeCode.SLA.toString()){var $v_1=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("defaultsla_confirm",Mscrm.EntityTypeCode.SLA,1),$v_2=new Array(1);$v_2[0]=entityId;var $v_3=new Mscrm.CrmDialog($v_1,$v_2,600,200,null);$v_3.show()}}else alert(window.LOCID_SLADEFAULT_INACTIVE_MSG)};Mscrm.CommandBarActions.sharePointDocumentEdit=function(gridControl,records){setPerfMarkerTimestamp("EditSharepointDocumentStart");var $v_0="",$v_1="",$v_2=Mscrm.CommandBarActions.$6(gridControl);if(!IsNull($v_2)&&records.length===1){var $v_3=$v_2.GetRecordsFromInnerGrid(true)[0][0],$v_4=Mscrm.CommandBarActions.$P($v_2,$v_3);$v_0=Mscrm.CommandBarActions.$N($v_3,$v_2);$v_1=Mscrm.CommandBarActions.$h($v_3,$v_2);if(!isNullOrEmptyString($v_0)||!isNullOrEmptyString($v_1))Mscrm.CommandBarActions.$F($v_1,$v_0);else{var $v_5=["absoluteurl","editurl"],$v_6=null;Mscrm.CommandBarActions.$S();Xrm.Internal.messages.retrieve(Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_4,$v_5).then(function($p1_0){$v_6=$p1_0.get_entity();$v_0=$v_6.getValue("absoluteurl").toString();$v_1=$v_6.getValue("editurl").toString();Mscrm.CommandBarActions.$F($v_1,$v_0)},Mscrm.CommandBarActions.actionFailedCallback)}}};Mscrm.CommandBarActions.openSharePointLocation=function(gridControl,records){setPerfMarkerTimestamp("OpenInSharepointStart");var $v_0="",$v_1=Mscrm.CommandBarActions.$6(gridControl);if(!IsNull($v_1)&&records.length===1){var $v_2=$v_1.GetRecordsFromInnerGrid(true)[0][0],$v_3=Mscrm.CommandBarActions.$P($v_1,$v_2);$v_0=Mscrm.CommandBarActions.$N($v_2,$v_1);var $v_4="";if(!isNullOrEmptyString($v_0))Mscrm.CommandBarActions.$T($v_0,$v_4);else{Mscrm.CommandBarActions.$S();var $v_5=["absoluteurl"];Xrm.Internal.messages.retrieve(Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_3,$v_5).then(function($p1_0){var $v_6=$p1_0.get_entity();$v_0=$v_6.getValue("absoluteurl").toString();Mscrm.CommandBarActions.$T($v_0,"")},Mscrm.CommandBarActions.actionFailedCallback)}}};Mscrm.CommandBarActions.newSharePointDocument=function(gridControl,documentType){setPerfMarkerTimestamp("NewSharePointDocumentStart");var $v_0=Mscrm.CommandBarActions.$6(gridControl);if(!IsNull($v_0)){var $v_1=$v_0.GetParameter("locationId"),$v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_"+CrmEncodeDecode.CrmUrlEncode("newdocument")+".aspx");$v_2.get_query()["regardingObjectId"]=Xrm.Page.data.entity.getId();$v_2.get_query()["regardingTypeCode"]=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());$v_2.get_query()["locationId"]=$v_1;$v_2.get_query()["documentType"]=documentType;var $v_3=new Xrm.DialogOptions;$v_3.height=200;$v_3.width=400;var $v_4=[gridControl],$v_5=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.newDocument,$v_4);Xrm.Internal.openDialog($v_2.toString(),$v_3,null,null,$v_5)}};Mscrm.CommandBarActions.newDocument=function(returnValue,gridControl){if(IsNull(returnValue))return;setPerfMarkerTimestamp("NewSharePointDocumentStart");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-1.11.3.min.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CommandBarActions.$4();var $v_0=returnValue["documentType"],$v_1=returnValue["regardingObjectId"],$v_2=returnValue["regardingTypeCode"],$v_3=returnValue["locationId"];if(IsNull($v_3))$v_3=Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty().toString();var $v_4=returnValue["filename"]+$v_0;Xrm.Internal.messages.newDocument($v_4,$v_1,$v_2,$v_3).then(function($p1_0){Mscrm.CommandBarActions.$F($p1_0.get_editLink(),null);setPerfMarkerTimestamp("NewSharePointDocumentSDKEnd");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()},Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands)};Mscrm.CommandBarActions.openSharePoint=function(gridControl,primaryEntityTypeCode){var $v_0=Mscrm.CommandBarActions.$6(gridControl),$v_1=$v_0.GetParameter("locationId");if(isNullOrEmptyString($v_1))$v_1="";Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Xrm.Internal.messages.fetchSiteUrl($v_1,Xrm.Page.data.entity.getId(),primaryEntityTypeCode).then(function($p1_0){var $v_2=$p1_0;window.open($v_2.get_siteAndLocationUrl(),"_blank")},Mscrm.CommandBarActions.actionFailedCallback)};Mscrm.CommandBarActions.$6=function($p0){var $v_0=$p0.get_id(),$v_1=$find($v_0);return $v_1};Mscrm.CommandBarActions.sharePointUpload=function(gridControl,primaryEntityTypeCode){var $v_0=Xrm.Page.data.entity.getId(),$v_1=primaryEntityTypeCode,$v_2=gridControl.get_id(),$v_3=$find($v_2),$v_4=$v_3.GetParameter("locationId"),$v_5=Mscrm.CrmUri.create("/_grid/cmds/dlg_"+CrmEncodeDecode.CrmUrlEncode("SP_upload")+".aspx");$v_5.get_query()["pid"]=$v_0;$v_5.get_query()["pType"]=$v_1;$v_5.get_query()["locationId"]=$v_4;if(isOutlookHostedWindow()){var $v_6=openStdDlg($v_5,window.self,550,230,true,false);$v_6&&Mscrm.CommandBarActions.refreshParentGridSP(gridControl)}else openStdWin($v_5,buildWinName(null),550,230,null)};Mscrm.CommandBarActions.refreshParentGridSP=function(gridControl){if(!IsNull(gridControl)){setPerfMarkerTimestamp("SharepointGridRefreshStart");gridControl.refresh();setPerfMarkerTimestamp("SharepointGridRefreshEnd")}};Mscrm.CommandBarActions.refreshParentGridSPForUpload=function(entityId){setPerfMarkerTimestamp("SharepointGridRefreshStart");var $v_0=Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_1=Mscrm.EntityTypeCode.SharePointDocument;Xrm.Internal.refreshParentGrid($v_1,$v_0,entityId);setPerfMarkerTimestamp("SharepointGridRefreshEnd")};Mscrm.CommandBarActions.deleteSharePointRecords=function(gridControl,records){setPerfMarkerTimestamp("DeleteSharePointRecordsDialogLoadStart");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CommandBarActions.$4();var $v_0=gridControl.get_id(),$v_1="",$v_2="",$v_3=$find($v_0),$v_4=$v_3.GetParameter("locationId");if(!IsNull($v_3)){var $v_5=$v_3.GetRecordsFromInnerGrid(true),$v_6=new Array(4),$v_7="locationid",$v_8="regardingobjectid",$v_9="documentid",$v_A="sharepointdocumentid",$v_B=new Array($v_5.length),$v_C=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Page.data.entity.getEntityName(),new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()));$v_6[0]=$v_7;$v_6[1]=$v_8;$v_6[2]=$v_9;$v_6[3]=$v_A;for(var $v_I=0;$v_I<$v_5.length;$v_I++){var $v_J={},$v_K={};$v_J[$v_7]=14;$v_J[$v_9]=5;$v_J[$v_A]=15;$v_J[$v_8]=6;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_4))$v_K[$v_7]="";else $v_K[$v_7]=$v_4;$v_K[$v_8]=$v_C;var $v_L=$v_5[$v_I][0];$v_1=Mscrm.CommandBarActions.$5($v_L,$v_3);$v_K[$v_9]=$v_1;$v_2=Mscrm.CommandBarActions.$7($v_L,$v_3);$v_K[$v_A]=$v_2;var $v_M=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.SharePointDocument,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_2)),$v_N=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_M,$v_K,$v_J,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_N.get_changedFieldNames().addRange($v_6);$v_B[$v_I]=$v_N}var $v_D=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection($v_B,false,$v_5.length,false),$v_E=Mscrm.CrmUri.create("/_grid/cmds/dlg_sp_delete.aspx");$v_E.get_query()["iObjType"]=Mscrm.EntityTypeCode.SharePointDocument;$v_E.get_query()["iTotal"]=records.length;var $v_F=[$v_D,gridControl],$v_G=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.deleteSharePointAction,$v_F),$v_H=new Xrm.DialogOptions;$v_H.width=570;$v_H.height=205;setPerfMarkerTimestamp("DeleteSharePointRecordsDialogLoadEnd");Xrm.Internal.openDialog($v_E.toString(),$v_H,null,null,$v_G)}};Mscrm.CommandBarActions.deleteSharePointAction=function(isDialogCanceled,entityCollection,gridControl){if(isDialogCanceled){Mscrm.CommandBarActions.$1();return}setPerfMarkerTimestamp("DeleteSharePointRecordsSDKStart");if(entityCollection)Xrm.Internal.messages.deleteDocument(entityCollection).then(function(){setPerfMarkerTimestamp("DeleteSharePointRecordsSDKEnd");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()},function($p1_0){Mscrm.CommandBarActions.actionFailedCallback($p1_0);Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()});else Mscrm.CommandBarActions.$1()};Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands=function(response){Mscrm.CommandBarActions.actionFailedCallback(response);Mscrm.CommandBarActions.$1()};Mscrm.CommandBarActions.checkout=function(gridControl){setPerfMarkerTimestamp("CheckoutSharePointDocumentStart");var $v_0=gridControl.get_id(),$v_1=$find($v_0),$v_2=$v_1.GetParameter("locationId");if(!IsNull($v_1)){var $v_3=$v_1.GetRecordsFromInnerGrid(true)[0][0],$v_4=Mscrm.CommandBarActions.$5($v_3,$v_1),$v_5=Mscrm.CommandBarActions.$7($v_3,$v_1);Mscrm.CommandBarActions.checkoutFile($v_2,$v_4,$v_5,gridControl)}};Mscrm.CommandBarActions.checkoutFile=function(locationId,documentId,entityId,gridControl){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CommandBarActions.$4();var $v_0={},$v_1={},$v_2=new Array(3),$v_3="documentid";$v_2[0]=$v_3;$v_0[$v_3]=14;$v_1[$v_3]=documentId;$v_3="regardingobjectid";var $v_4=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Page.data.entity.getEntityName(),new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()));$v_1[$v_3]=$v_4;$v_0[$v_3]=6;$v_2[1]=$v_3;$v_3="locationid";$v_2[2]=$v_3;$v_0[$v_3]=14;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(locationId))$v_1[$v_3]="";else $v_1[$v_3]=locationId;var $v_5=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.SharePointDocument,new Microsoft.Dynamics.Client.Core.Framework.Guid(entityId)),$v_6=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_5,$v_1,$v_0,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_6.get_changedFieldNames().addRange($v_2);setPerfMarkerTimestamp("CheckoutSharePointDocumentSDKStart");Xrm.Internal.messages.checkoutFiles($v_6).then(function($p1_0){setPerfMarkerTimestamp("CheckoutSharePointDocumentSDKEnd");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()},Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands)};Mscrm.CommandBarActions.discardCheckoutFile=function(locationId,documentId,entityId,gridControl){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-1.11.3.min.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CommandBarActions.$4();var $v_0={},$v_1={},$v_2=new Array(3),$v_3="documentid";$v_2[0]=$v_3;$v_0[$v_3]=14;$v_1[$v_3]=documentId;$v_3="regardingobjectid";var $v_4=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Page.data.entity.getEntityName(),new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()));$v_1[$v_3]=$v_4;$v_0[$v_3]=6;$v_2[1]=$v_3;$v_3="locationid";$v_2[2]=$v_3;$v_0[$v_3]=14;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString(locationId))$v_1[$v_3]="";else $v_1[$v_3]=locationId;var $v_5=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.SharePointDocument,new Microsoft.Dynamics.Client.Core.Framework.Guid(entityId)),$v_6=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_5,$v_1,$v_0,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_6.get_changedFieldNames().addRange($v_2);setPerfMarkerTimestamp("DiscardCheckoutSharePointDocumentSDKStart");Xrm.Internal.messages.discardCheckoutFiles($v_6).then(function($p1_0){setPerfMarkerTimestamp("DiscardCheckoutSharePointDocumentSDKEnd");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()},Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands)};Mscrm.CommandBarActions.discardCheckout=function(gridControl){setPerfMarkerTimestamp("DiscardCheckoutSharePointDocumentDialogStartLoad");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-1.11.3.min.js"),true);if(!IsNull(gridControl)){var $v_0=Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_1=gridControl.get_id(),$v_2=$find($v_1),$v_3=$v_2.GetParameter("locationId");if(!IsNull($v_2)){var $v_4=$v_2.GetRecordsFromInnerGrid(true)[0][0],$v_5=Mscrm.CommandBarActions.$5($v_4,$v_2),$v_6=Mscrm.CommandBarActions.$7($v_4,$v_2);if(!isNullOrEmptyString($v_5)){var $v_7=Mscrm.CrmUri.create("/_grid/cmds/dlg_discardcheckout.aspx");$v_7.get_query()["spId"]=$v_5;$v_7.get_query()["entityId"]=$v_6;$v_7.get_query()["entityName"]=$v_0;$v_7.get_query()["locationId"]=$v_3;var $v_8=new Xrm.DialogOptions;$v_8.height=200;$v_8.width=400;var $v_9=[gridControl],$v_A=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.discardDialogClose,$v_9);setPerfMarkerTimestamp("DiscardCheckoutSharePointDocumentDialogEndLoad");Xrm.Internal.openDialog($v_7.toString(),$v_8,null,null,$v_A)}}}};Mscrm.CommandBarActions.discardDialogClose=function(returnValue,gridControl){if(IsNull(returnValue))return;setPerfMarkerTimestamp("DiscardCheckoutSharePointDocumentStart");var $v_0=returnValue["entityId"],$v_1=returnValue["documentId"],$v_2=returnValue["locationId"];Mscrm.CommandBarActions.discardCheckoutFile($v_2,$v_1,$v_0,gridControl)};Mscrm.CommandBarActions.checkIn=function(gridControl){setPerfMarkerTimestamp("CheckinSharePointDocumentDialogLoadStart");var $v_0=Mscrm.InternalUtilities.EntityNames.SharePointDocument,$v_1=gridControl.get_id(),$v_2=$find($v_1),$v_3=$v_2.GetParameter("locationId");if(!IsNull($v_2)){var $v_4=$v_2.GetRecordsFromInnerGrid(true)[0][0],$v_5=Mscrm.CommandBarActions.$5($v_4,$v_2),$v_6=Mscrm.CommandBarActions.$7($v_4,$v_2),$v_7=Mscrm.CrmUri.create("/_grid/cmds/dlg_checkin.aspx");$v_7.get_query()["spId"]=$v_5;$v_7.get_query()["entityId"]=$v_6;$v_7.get_query()["entityName"]=$v_0;$v_7.get_query()["locationId"]=$v_3;var $v_8=new Xrm.DialogOptions;$v_8.height=360;$v_8.width=540;var $v_9=[gridControl],$v_A=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.dialogCheckInClose,$v_9);setPerfMarkerTimestamp("CheckinSharePointDocumentDialogLoadEnd");Xrm.Internal.openDialog($v_7.toString(),$v_8,null,null,$v_A)}};Mscrm.CommandBarActions.dialogCheckInClose=function(returnValue,gridControl){if(IsNull(returnValue))return;setPerfMarkerTimestamp("CheckinSharePointDocumentStart");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-1.11.3.min.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CommandBarActions.$4();var $v_0=returnValue["entityId"],$v_1=returnValue["documentId"],$v_2=returnValue["isRetain"],$v_3=returnValue["comments"],$v_4=returnValue["locationId"],$v_5=new Array(3),$v_6={},$v_7={},$v_8="documentid";$v_6[$v_8]=14;$v_7[$v_8]=$v_1;$v_5[0]=$v_8;$v_8="regardingobjectid";var $v_9=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Page.data.entity.getEntityName(),new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()));$v_7[$v_8]=$v_9;$v_6[$v_8]=6;$v_5[1]=$v_8;$v_8="locationid";$v_5[2]=$v_8;$v_6[$v_8]=14;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_4))$v_7[$v_8]="";else $v_7[$v_8]=$v_4;var $v_A=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.SharePointDocument,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_0)),$v_B=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_A,$v_7,$v_6,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_B.get_changedFieldNames().addRange($v_5);setPerfMarkerTimestamp("CheckinSharePointDocumentSDKStart");Xrm.Internal.messages.checkInFiles($v_B,$v_3,$v_2).then(function($p1_0){setPerfMarkerTimestamp("CheckinSharePointDocumentSDKEnd&GridRefreshStart");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);setPerfMarkerTimestamp("CheckinSharePointDocumentRefreshGridEnd");Mscrm.CommandBarActions.$1()},Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands)};Mscrm.CommandBarActions.sharePointEditDocumentProperties=function(gridControl){setPerfMarkerTimestamp("EditPropertiesSharePointDocumentDialogStartLoad");var $v_0=gridControl.get_id(),$v_1=$find($v_0),$v_2=$v_1.GetParameter("locationId");if(!IsNull($v_1)){var $v_3=$v_1.GetRecordsFromInnerGrid(true)[0][0],$v_4=$v_1.getCellValue("oid",$v_3);if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_4)){var $v_5=Mscrm.CrmUri.create("/_grid/cmds/dlg_"+CrmEncodeDecode.CrmUrlEncode("editdocumentproperties")+".aspx");$v_5.get_query()["oid"]=$v_4;$v_5.get_query()["regardingId"]=Xrm.Page.data.entity.getId();$v_5.get_query()["regardingTypeCode"]=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());var $v_6={};$v_6["sharePointDocumentId"]=$v_4;var $v_7=$v_1.getCellValue("documentid",$v_3),$v_8=$v_1.getCellValue("fullname",$v_3),$v_9=Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_1.getCellValue("title",$v_3))?"":$v_1.getCellValue("title",$v_3),$v_A=$v_1.getCellValue("author",$v_3),$v_B=$v_1.getCellValue("sharepointcreatedon",$v_3),$v_C=$v_1.getCellValue("sharepointmodifiedby",$v_3),$v_D=$v_1.getCellValue("modified",$v_3);if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_7)||Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_8)||Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_A)||Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_B)||Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_C)||Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_D)){$v_5.get_query()["useFallback"]=1;$v_6["useFallback"]=1}else{$v_5.get_query()["documentId"]=$v_7;$v_5.get_query()["useFallback"]=0;$v_6["useFallback"]=0;$v_6["documentId"]=$v_7;$v_6["fullName"]=$v_8;$v_6["title"]=$v_9;$v_6["createdBy"]=$v_A;$v_6["createdOn"]=Mscrm.CommandBarActions.$U($v_B);$v_6["modifiedBy"]=$v_C;$v_6["modifiedOn"]=Mscrm.CommandBarActions.$U($v_D)}$v_5.get_query()["locationId"]=$v_2;var $v_E=new Xrm.DialogOptions;$v_E.width=600;$v_E.height=270;var $v_F=[gridControl],$v_G=Mscrm.CommandBarActions.createCallbackFunctionFactory(Mscrm.CommandBarActions.sharePointUpdateDocumentProperties,$v_F);setPerfMarkerTimestamp("EditPropertiesSharePointDocumentDialogEndLoad");Xrm.Internal.openDialog($v_5.toString(),$v_E,$v_6,null,$v_G)}}};Mscrm.CommandBarActions.$U=function($p0){var $v_0=ParseUtcDate($p0);$v_0=new Date($v_0.getFullYear(),$v_0.getMonth(),$v_0.getDate(),$v_0.getHours(),$v_0.getMinutes());return $v_0};Mscrm.CommandBarActions.sharePointUpdateDocumentProperties=function(returnValue,gridControl){if(IsNull(returnValue))return;setPerfMarkerTimestamp("EditPropertiesSharePointDocumentStart");Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/jquery-1.11.3.min.js"),true);Mscrm.CommandBarActions.$4();var $v_0={},$v_1={},$v_2=returnValue["locationId"],$v_3=new Array(5),$v_4="documentid",$v_5="fullname",$v_6="title",$v_7="regardingobjectid",$v_8="locationid";$v_3[0]=$v_4;$v_3[1]=$v_5;$v_3[2]=$v_6;$v_3[3]=$v_7;$v_3[4]=$v_8;$v_0[$v_4]=5;$v_0[$v_5]=14;$v_0[$v_6]=14;$v_0[$v_8]=14;if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_2))$v_1[$v_8]="";else $v_1[$v_8]=$v_2;$v_1[$v_4]=returnValue["documentId"];$v_1[$v_5]=isNullOrEmptyString(returnValue["extension"])?returnValue["name"]:returnValue["name"]+returnValue["extension"];$v_1[$v_6]=returnValue["title"];var $v_9=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Page.data.entity.getEntityName(),new Microsoft.Dynamics.Client.Core.Framework.Guid(Xrm.Page.data.entity.getId()));$v_1[$v_7]=$v_9;$v_0[$v_7]=6;var $v_A=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.SharePointDocument,new Microsoft.Dynamics.Client.Core.Framework.Guid(returnValue["sharePointDocumentId"])),$v_B=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_A,$v_1,$v_0,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_B.get_changedFieldNames().addRange($v_3);setPerfMarkerTimestamp("EditPropertiesSharePointDocumentStartSDK");Xrm.Internal.messages.editDocumentProperties($v_B).then(function(){setPerfMarkerTimestamp("EditPropertiesSharePointDocumentSDKEnd");Mscrm.CommandBarActions.refreshParentGridSP(gridControl);Mscrm.CommandBarActions.$1()},Mscrm.CommandBarActions.actionFailedCallbackForSharePointCommands)};Mscrm.CommandBarActions.$1=function(){var $v_0=window.document.getElementById("associatedGridRibbon"),$v_1=$v_0.children[0];$v_0.style.cursor="default";$v_1.style.visibility="visible"};Mscrm.CommandBarActions.$4=function(){var $v_0=window.document.getElementById("associatedGridRibbon"),$v_1=$v_0.children[0];$v_0.style.cursor="wait";$v_1.style.visibility="hidden"};Mscrm.CommandBarActions.$7=function($p0,$p1){return $p1.getCellValue("oid",$p0)};Mscrm.CommandBarActions.$5=function($p0,$p1){var $v_0=$p1.getCellValue("documentid",$p0);return isNullOrEmptyString($v_0)?"-1":$v_0};Mscrm.CommandBarActions.$N=function($p0,$p1){return $p1.getCellValue("absoluteurl",$p0)};Mscrm.CommandBarActions.$h=function($p0,$p1){return $p1.getCellValue("editurl",$p0)};Mscrm.CommandBarActions.$P=function($p0,$p1){return $p0.getCellValue("oid",$p1)};Mscrm.CommandBarActions.$S=function(){Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxyFramework.js"),true);Mscrm.CrmHeader.setScriptFile(Mscrm.CrmUri.create("/_static/_common/scripts/CrmServiceProxy.js"),true)};Mscrm.CommandBarActions.$F=function($p0,$p1){if(!isNullOrEmptyString($p0)){setPerfMarkerTimestamp("EditSharepointDocument_NewWindowOpen");window.open($p0,"_blank")}else!isNullOrEmptyString($p1)&&Mscrm.CommandBarActions.$s($p1)};Mscrm.CommandBarActions.$s=function($p0){if(!isNullOrEmptyString($p0)){setPerfMarkerTimestamp("EditSharepointDocument_NewWindowOpen");window.open($p0,"_blank")}};Mscrm.CommandBarActions.$T=function($p0,$p1){if(!isNullOrEmptyString($p0)){for(var $v_0=$p0.split("/"),$v_1=0;$v_1<$v_0.length-1;$v_1++)$p1+=$v_0[$v_1]+"/";setPerfMarkerTimestamp("OpenInSharepointOpenNewWindow");window.open($p1,"_blank")}};Mscrm.CloseOpportunityDialogResult=function(){};Mscrm.CloseOpportunityDialogResult.prototype={actualEnd:null,actualRevenue:null,description:null,state:0,reason:0,competitor:null};Mscrm.ResolveCaseDialogResult=function(){};Mscrm.ResolveCaseDialogResult.prototype={StatusCode:0,TimeSpent:0,Description:null,Subject:null,ActualEnd:null};Mscrm.GridCommandActions=function(){};Mscrm.GridCommandActions.activate=function(gridControl,records,entityTypeCode,callback){var $v_0=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("activate",entityTypeCode,records.length),$v_1=Xrm.Internal.getEntityName(entityTypeCode),$v_2=500,$v_3=200;if(Mscrm.InternalUtilities.Utilities.enforceStateTransitions($v_1))if(records.length===1)$v_0.get_query()["iId"]=records[0].Id;if($v_1===Mscrm.InternalUtilities.EntityNames.Workflow&&records.length>0){$v_0.get_query()["iObjSubtype"]=gridControl.getCellValue("type",records[0].Id);var $v_4=new RemoteCommand("CustomerService","GetRendererObjectTypeCode");$v_4.SetParameter("workflowId",records[0].Id);var $v_5=$v_4.Execute();if($v_5.Success){var $v_6=$v_5.ReturnValue;if(!IsNull($v_6)&&($v_6===Mscrm.InternalUtilities.EntityNames.SLA||$v_6===Mscrm.InternalUtilities.EntityNames.SLAItem||$v_6===Mscrm.InternalUtilities.EntityNames.RoutingRule||$v_6===Mscrm.InternalUtilities.EntityNames.ConvertRule)){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("LOCID_ACTIVATE_WORKFLOW"));return}}}else if($v_1===Mscrm.InternalUtilities.EntityNames.CampaignResponse&&records.length>0)$v_0.get_query()["bulkChangeStateMode"]="1";else if($v_1===Mscrm.InternalUtilities.EntityNames.SystemUser)$v_3=210;else if($v_1===Mscrm.InternalUtilities.EntityNames.SLA)$v_0.get_query()["iId"]=records[0].Id;Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_0,records,$v_2,$v_3,Mscrm.InternalUtilities.JSTypes.isNull(callback)?Mscrm.GridCommandActions.createRefreshGridCallback(gridControl):callback)};Mscrm.GridCommandActions.assignSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("assign",entityTypeCode,selectedRecords.length),$v_1=false,$v_2=false,$v_3=456,$v_4=310,$v_5=Xrm.Internal.getEntityName(entityTypeCode);if(Xrm.Utility.isActivityType($v_5)&&Mscrm.InternalUtilities.Utilities.isUserDefinedEntityObjectTypeCode(entityTypeCode))$v_1=true;switch($v_5){case Mscrm.InternalUtilities.EntityNames.QueueItem:$v_2=true;$v_1=true;break;case Mscrm.InternalUtilities.EntityNames.ActivityPointer:case Mscrm.InternalUtilities.EntityNames.Email:case Mscrm.InternalUtilities.EntityNames.Fax:case Mscrm.InternalUtilities.EntityNames.PhoneCall:case Mscrm.InternalUtilities.EntityNames.Letter:case Mscrm.InternalUtilities.EntityNames.Appointment:case Mscrm.InternalUtilities.EntityNames.ServiceAppointment:$v_2=true;$v_1=true;break;case Mscrm.InternalUtilities.EntityNames.Incident:case Mscrm.InternalUtilities.EntityNames.CampaignResponse:case Mscrm.InternalUtilities.EntityNames.CampaignActivity:case Mscrm.InternalUtilities.EntityNames.Task:$v_1=true;break;case Mscrm.InternalUtilities.EntityNames.SLA:case Mscrm.InternalUtilities.EntityNames.ConvertRule:case Mscrm.InternalUtilities.EntityNames.RoutingRule:$v_4=320;break}if($v_1&&!Mscrm.InternalUtilities.JSTypes.isNull(selectedRecords)){$v_0=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("assignqueue",entityTypeCode,selectedRecords.length);$v_0.get_query()["sQType"]=1;$v_3=500;$v_4=310;if($v_2){for(var $v_6=new Sys.StringBuilder,$v_7=0;$v_7<selectedRecords.length;$v_7++){$v_7>0&&$v_6.append(",");$v_6.append(selectedRecords[$v_7].TypeCode.toString())}$v_0.get_query()["sSubTypes"]=$v_6.toString()}if(selectedRecords.length>0)$v_0.get_query()["uid"]=selectedRecords[0].Id}Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_0,selectedRecords,$v_3,$v_4,Mscrm.GridCommandActions.createRefreshGridCallback(gridControl))};Mscrm.GridCommandActions.addToQueue=function(gridControl,records,entityTypeCode){for(var $v_0=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("addtoqueue",entityTypeCode,records.length),$v_1=false,$v_2=new Sys.StringBuilder,$v_3=0;$v_3<records.length;$v_3++){if(entityTypeCode!==records[$v_3].TypeCode)$v_1=true;$v_3>0&&$v_2.append(",");$v_2.append(records[$v_3].TypeCode.toString())}if($v_1){$v_0.get_query()["iIndex"]=0;$v_0.get_query()["sSubTypes"]=$v_2.toString()}Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_0,records,450,235,Mscrm.GridCommandActions.createRefreshGridCallback(gridControl))};Mscrm.GridCommandActions.qualifyLeadQuick=function(gridControl,records,entityTypeCode){if(!IsNull(Mscrm.LeadGridCommandActions)){Mscrm.LeadGridCommandActions.qualifyLeadQuick(gridControl,records,entityTypeCode);return}Mscrm.GridCommandActions.qualifyLeadAs(gridControl,records,entityTypeCode,-1)};Mscrm.GridCommandActions.qualifyLeadAs=function(gridControl,records,entityTypeCode,statusCode){Mscrm.GridCommandActions.$H(gridControl,records,entityTypeCode,true,statusCode)};Mscrm.GridCommandActions.disqualifyLeadQuick=function(gridControl,records,entityTypeCode){if(!IsNull(Mscrm.LeadGridCommandActions)){Mscrm.LeadGridCommandActions.disqualifyLeadQuick(gridControl,records,entityTypeCode);return}Mscrm.GridCommandActions.disqualifyLeadAs(gridControl,records,entityTypeCode,-1)};Mscrm.GridCommandActions.disqualifyLeadAs=function(gridControl,records,entityTypeCode,statusCode){Mscrm.GridCommandActions.$H(gridControl,records,entityTypeCode,false,statusCode)};Mscrm.GridCommandActions.$H=function($p0,$p1,$p2,$p3,$p4){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_convertlead.aspx");$v_0.get_query()["iObjType"]=$p2;$v_0.get_query()["iTotal"]=$p1.length;$v_0.get_query()["qualify"]=$p3;$v_0.get_query()["qlShowNew"]=false;$v_0.get_query()["ulNewStatus"]=$p4;Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_0,$p1,400,200,Mscrm.GridCommandActions.createRefreshGridCallback($p0))};Mscrm.GridCommandActions.addNewFromSubGrid=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){if(!Mscrm.CommandBarActions.isMobileCompanionApp())return;var $v_0=Xrm.Internal.getEntityName(gridTypeCode),$v_1=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Internal.getEntityName(parentEntityTypeCode),new Microsoft.Dynamics.Client.Core.Framework.Guid(parentEntityId)),$v_2=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelationshipReference(gridControl.getRelationshipName(),gridControl.getRelationshipAttributeName(),gridControl.getRelationshipRoleOrdinal(),gridControl.getRelationshipType());Xrm.Utility.create($v_0,$v_1,$v_2,null,null)};Mscrm.GridCommandActions.addActivityToFormFromSubgridFromClassic=function(activityType,parentEntityId,parentEntityTypeCode){if(!Mscrm.CommandBarActions.isMobileCompanionApp())return;var $v_0=Xrm.Internal.getEntityName(activityType),$v_1=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Internal.getEntityName(parentEntityTypeCode),new Microsoft.Dynamics.Client.Core.Framework.Guid(parentEntityId));$v_1.Name=Xrm.Page.data.entity.getPrimaryAttributeValue();Xrm.Utility.create($v_0,$v_1,null,null,null)};Mscrm.GridCommandActions.deactivate=function(gridControl,records,entityTypeCode,defaultCloseState,callback){var $v_0=600,$v_1=270,$v_2="",$v_3=null,$v_4=Xrm.Internal.getEntityName(entityTypeCode);switch($v_4){case Mscrm.InternalUtilities.EntityNames.BusinessUnit:$v_0=650;$v_1=280;for(var $v_7=0;$v_7<records.length;$v_7++)$v_2+=records[$v_7].Id;break;case Mscrm.InternalUtilities.EntityNames.DiscountType:case Mscrm.InternalUtilities.EntityNames.Account:case Mscrm.InternalUtilities.EntityNames.Contact:$v_1=200;break;case Mscrm.InternalUtilities.EntityNames.Workflow:if(records.length>0){$v_3=gridControl.getCellValue("type",records[0].Id);var $v_8=new RemoteCommand("CustomerService","GetRendererObjectTypeCode");$v_8.SetParameter("workflowId",records[0].Id);var $v_9=$v_8.Execute();if($v_9.Success){var $v_A=$v_9.ReturnValue;if(!IsNull($v_A)&&($v_A===Mscrm.InternalUtilities.EntityNames.SLA||$v_A===Mscrm.InternalUtilities.EntityNames.SLAItem||$v_A===Mscrm.InternalUtilities.EntityNames.RoutingRule||$v_A===Mscrm.InternalUtilities.EntityNames.ConvertRule)){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("LOCID_DEACTIVATE_WORKFLOW"));return}}}break;case Mscrm.InternalUtilities.EntityNames.CampaignActivity:case Mscrm.InternalUtilities.EntityNames.CampaignResponse:$v_1=250;$v_0=400;break;case Mscrm.InternalUtilities.EntityNames.ActivityPointer:for(var $v_5=records[0],$v_B=1;$v_B<records.length;$v_B++)if(records[$v_B].TypeCode!==$v_5.TypeCode){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Grid_Apply_Rule_Heterogenous_Activity_Type_Records_Selected"));return}switch($v_5.TypeCode){case Mscrm.InternalUtilities.EntityTypeCode.SocialActivity:Mscrm.InternalUtilities._Script.alert(Mscrm.CommandBarActions.selectResourceString("Grid_Apply_Rule_Social_Activity_Type_Records_Selected_For_Invalid_Action","LOCID_SOCIAL_ACTIVITY_ACTIONERR"));return;case Mscrm.InternalUtilities.EntityTypeCode.Email:Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Grid_Apply_Rule_Selected_Emails"));return;case Mscrm.InternalUtilities.EntityTypeCode.CampaignResponse:case Mscrm.InternalUtilities.EntityTypeCode.CampaignActivity:if(defaultCloseState===1){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Grid_Apply_Rule_Selected_Records"));return}break}entityTypeCode=$v_5.TypeCode;break}var $v_6=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("deactivate",entityTypeCode,records.length);$v_6.get_query()["sIds"]=$v_2;if(records.length===1)$v_6.get_query()["iId"]=records[0].Id;$v_6.get_query()["bulkChangeStateMode"]="1";if(!Mscrm.InternalUtilities.JSTypes.isNull(defaultCloseState))$v_6.get_query()["iStateCode"]=defaultCloseState;if(!Mscrm.InternalUtilities.JSTypes.isNull($v_3))$v_6.get_query()["iObjSubtype"]=$v_3;Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_6,records,$v_0,$v_1,Mscrm.InternalUtilities.JSTypes.isNull(callback)?Mscrm.GridCommandActions.createRefreshGridCallback(gridControl):callback)};Mscrm.GridCommandActions.canMarkComplete=function(records){for(var $v_0=0;$v_0<records.length;$v_0++){var $v_1=records[$v_0].TypeCode;if($v_1!==Mscrm.InternalUtilities.EntityTypeCode.Email&&$v_1!==Mscrm.InternalUtilities.EntityTypeCode.CampaignActivity&&$v_1!==Mscrm.InternalUtilities.EntityTypeCode.CampaignResponse)return true}return false};Mscrm.GridCommandActions.isBulkSaveAsCompletedValid=function(entityTypeCode){if(Mscrm.CommandBarActions.isMobileCompanionApp())return true;var $v_0=Xrm.Internal.getEntityName(entityTypeCode);if(Xrm.Utility.isActivityType($v_0)){if(Xrm.Page.context.isOutlookClient()&&entityTypeCode===Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer)entityTypeCode=Mscrm.GridCommandActions.$8();switch(entityTypeCode){case Mscrm.InternalUtilities.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.InternalUtilities.EntityTypeCode.CampaignActivity:case Mscrm.InternalUtilities.EntityTypeCode.CampaignResponse:case Mscrm.InternalUtilities.EntityTypeCode.Email:return false;default:return true}}else return false};Mscrm.GridCommandActions.isBulkSaveAsCancelledValid=function(entityTypeCode){if(Mscrm.CommandBarActions.isMobileCompanionApp())return true;var $v_0=Xrm.Internal.getEntityName(entityTypeCode);if(Xrm.Utility.isActivityType($v_0)){if(Xrm.Page.context.isOutlookClient()&&entityTypeCode===Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer)entityTypeCode=Mscrm.GridCommandActions.$8();switch(entityTypeCode){case Mscrm.InternalUtilities.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.InternalUtilities.EntityTypeCode.Email:return false;default:return true}}else return false};Mscrm.GridCommandActions.isBulkSetRegardingValid=function(entityTypeCode,records){var $v_0=Xrm.Internal.getEntityName(entityTypeCode);if(Xrm.Utility.isActivityType($v_0)){if(Xrm.Page.context.isOutlookClient()&&entityTypeCode===Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer)entityTypeCode=Mscrm.GridCommandActions.$8();switch(entityTypeCode){case Mscrm.InternalUtilities.EntityTypeCode.ActivityPointer:for(var $v_1=0;$v_1<records.length;$v_1++)if(records[$v_1].TypeCode===Mscrm.InternalUtilities.EntityTypeCode.CampaignActivity)return false;return true;case Mscrm.InternalUtilities.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.InternalUtilities.EntityTypeCode.CampaignActivity:return false;default:return true}}else return false};Mscrm.GridCommandActions.createRefreshGridCallback=function(gridControl){var $v_0=null;if(Mscrm.CommandBarActions.isMobileCompanionApp()||Xrm.Page.context.isOutlookClient()){var $v_1=Mscrm.GridCommandActions.RefreshGrid;$v_0=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_1,[gridControl])}return $v_0};Mscrm.GridCommandActions.$8=function(){return window.external.getParameter("viewOtc")};Mscrm.GridCommandActions.resolveCase=function(selectedCaseData,gridControl){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_ConfirmResolve.aspx"),$v_1=selectedCaseData.toString();if(Mscrm.CommandBarActions.isMobileCompanionApp())$v_1=Microsoft.Dynamics.Client.Core.Framework.Guid.formatToUpper(selectedCaseData.Id);$v_0.get_query()["pId"]=$v_1;$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_2=new Xrm.DialogOptions;$v_2.height=250;$v_2.width=600;var $v_3=0,$v_4=null;Xrm.Internal.messages.getValidStatusTransition($v_1,1).then(function($p1_0){$v_3=$p1_0.get_result();switch($v_3){case 1:$v_0.get_query()["reason"]="novalidstatustransition";Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,null);break;case 2:$v_0.get_query()["reason"]="activeactivities";var $v_5=Mscrm.GridCommandActions.performActionAfterConfirmCancel;$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_5,[$v_1,gridControl]);Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,$v_4);break;case 3:var $v_6=Mscrm.CrmUri.create("/CS/cases/dlg_closecase.aspx");$v_6.get_query()["pId"]=$v_1;$v_2.height=391;$v_2.width=400;var $v_7=Mscrm.GridCommandActions.performActionAfterCloseCase;$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_7,[$v_1,gridControl]);Xrm.Internal.openDialog($v_6.toString(),$v_2,null,null,$v_4);break;case 4:var $v_8=Mscrm.CrmUri.create("/_common/error/dlg_error.aspx");$v_8.get_query()["hresult"]="0x80044411";Xrm.Internal.openDialog($v_8.toString(),$v_2,null,null,null);break}},function($p1_0){return})};Mscrm.GridCommandActions.performActionAfterConfirmCancel=function(returnValue,caseId,gridControl){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_closecase.aspx");$v_0.get_query()["pId"]=caseId;$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_1=new Xrm.DialogOptions;$v_1.height=391;$v_1.width=400;var $v_2=Mscrm.GridCommandActions.performActionAfterCloseCase,$v_3=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_2,[caseId,gridControl]);Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_3)}};Mscrm.GridCommandActions.performActionAfterCloseCase=function(returnValue,caseId,gridControl){var $v_0=false;if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_1=function(){gridControl.refresh()};Mscrm.CommandBarActions.performResolveCase(returnValue,caseId,$v_1);$v_0=true}return $v_0};Mscrm.GridCommandActions.cancelCase=function(selectedCaseData,gridControl){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_ConfirmCancel.aspx"),$v_1=selectedCaseData.toString();if(Mscrm.CommandBarActions.isMobileCompanionApp())$v_1=Microsoft.Dynamics.Client.Core.Framework.Guid.formatToUpper(selectedCaseData.Id);$v_0.get_query()["pId"]=$v_1;$v_0.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Incident;var $v_2=new Xrm.DialogOptions;$v_2.height=200;$v_2.width=600;var $v_3=0,$v_4=null;Xrm.Internal.messages.getValidStatusTransition($v_1.toString(),2).then(function($p1_0){$v_3=$p1_0.get_result();switch($v_3){case 1:$v_0.get_query()["reason"]="novalidstatustransition";Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,null);break;case 2:$v_0.get_query()["reason"]="activeactivities";var $v_5=Mscrm.GridCommandActions.performActionAfterConfirmCancelCase;$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_5,[$v_1,gridControl]);Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,$v_4);break;case 3:var $v_6=Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx");$v_6.get_query()["pId"]=$v_1;$v_2.height=230;$v_2.width=520;var $v_7=Mscrm.GridCommandActions.performActionAfterCancelCase;$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_7,[$v_1,gridControl]);Xrm.Internal.openDialog($v_6.toString(),$v_2,null,null,$v_4);break;case 4:var $v_8=Mscrm.CrmUri.create("/_common/error/dlg_error.aspx");$v_8.get_query()["hresult"]="0x80044411";Xrm.Internal.openDialog($v_8.toString(),$v_2,null,null,null);break}},function($p1_0){return})};Mscrm.GridCommandActions.performActionAfterConfirmCancelCase=function(returnValue,caseId,gridControl){if(returnValue){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_cancel.aspx");$v_0.get_query()["pId"]=caseId;var $v_1=new Xrm.DialogOptions;$v_1.height=230;$v_1.width=520;var $v_2=Mscrm.GridCommandActions.performActionAfterCancelCase,$v_3=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_2,[caseId,gridControl]);Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_3)}};Mscrm.GridCommandActions.performActionAfterCancelCase=function(returnValue,caseId,gridControl){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)&&!Mscrm.InternalUtilities.JSTypes.isNull(returnValue.StatusCode)){var $v_0=2;Xrm.Internal.messages.setState(Mscrm.InternalUtilities.EntityNames.Incident,caseId,$v_0,returnValue.StatusCode).then(function(){gridControl.refresh()},Mscrm.CommandBarActions.actionFailedCallback)}};Mscrm.GridCommandActions.runRoutingRule=function(gridControl,selectedCases){if(IsNull(selectedCases)||!selectedCases.length)return;for(var $v_0=new Array(selectedCases.length),$v_5=0;$v_5<selectedCases.length;$v_5++)if($v_0.length>0)$v_0[$v_5]=selectedCases[$v_5].Id;var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_routecase.aspx");$v_1.get_query()["iTotal"]=selectedCases.length;var $v_2=new Xrm.DialogOptions;$v_2.width=460;$v_2.height=250;var $v_3=Mscrm.GridCommandActions.performActionAfterRunRoutingRule,$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_3,[gridControl]);Xrm.Internal.openDialog($v_1.toString(),$v_2,$v_0,null,$v_4)};Mscrm.GridCommandActions.performActionAfterRunRoutingRule=function(returnValue,gridControl){!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)&&returnValue&&gridControl.refresh()};Mscrm.GridCommandActions.setRegarding=function(gridControl,records,entityTypeCode){for(var $v_0=500,$v_1=240,$v_2=new Sys.StringBuilder,$v_4=0;$v_4<records.length;$v_4++){if(records[$v_4].TypeCode===Mscrm.InternalUtilities.EntityTypeCode.SocialActivity){Mscrm.InternalUtilities._Script.alert(Mscrm.CommandBarActions.selectResourceString("Grid_Apply_Rule_Social_Activity_Type_Records_Selected_For_Invalid_Action","LOCID_SOCIAL_ACTIVITY_ACTIONERR"));return}$v_4>0&&$v_2.append(",");$v_2.append(records[$v_4].TypeCode.toString())}var $v_3=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("setregarding",entityTypeCode,records.length);$v_3.get_query()["sSubTypes"]=$v_2.toString();Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_3,records,$v_0,$v_1,Mscrm.GridCommandActions.createRefreshGridCallback(gridControl))};Mscrm.GridCommandActions.deleteRecords=function(gridControl,records,entityTypeCode){var $v_0=false,$v_1=570,$v_2=205,$v_3=250,$v_4=false,$v_5=null,$v_6=null,$v_7=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("delete",entityTypeCode,records.length),$v_8=Xrm.Internal.getEntityName(entityTypeCode),$v_9=Mscrm.GridCommandActions.PerformActionAfterDeleteFromGrid;$v_6=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_9,[gridControl,records]);if(Xrm.Utility.isActivityType($v_8)){$v_0=true;$v_4=true}switch($v_8){case Mscrm.InternalUtilities.EntityNames.BulkOperation:switch(gridControl.GetParameter("viewid")){case "{FD4DF17C-386E-4E29-9D31-529A568A3BBC}":case "{BA825777-1A7B-4837-8778-B86904D1115C}":case "{83DC2389-0A4C-4249-A5D3-BA1AB401FF1C}":case "{2C9E8543-3E3B-4F8D-AEDF-B8A43446619D}":$v_7.get_query()["iObjSubType"]="7";break}break;case Mscrm.InternalUtilities.EntityNames.Queue:$v_7=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("delete_queue",entityTypeCode,records.length);if(records.length===1)$v_7.get_query()["sIds"]=records[0].Id.toString();$v_1=480;break;case Mscrm.InternalUtilities.EntityNames.ImportMap:for(var $v_D=new Sys.StringBuilder,$v_E=0;$v_E<records.length;$v_E++){$v_E>0&&$v_D.append(";");$v_D.append(records[$v_E].Id)}$v_7=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("delete_importmap",entityTypeCode,records.length);$v_7.get_query()["sIds"]=$v_D.toString();$v_0=true;break;case Mscrm.InternalUtilities.EntityNames.RecurringAppointmentMaster:var $v_F=1;switch(gridControl.GetParameter("viewid")){case "{4805B7C1-218B-4FAD-95A5-D5708E3CCFC0}":case "{E9D20D36-01F3-4830-BB29-3D8A6E9DB557}":$v_F=2;break}$v_7=Mscrm.CrmUri.create("/activities/act_dlgs/dlg_seriesaction.aspx");$v_7.get_query()["actionType"]="6";$v_7.get_query()["iTotal"]=records.length;$v_7.get_query()["insDel"]=$v_F===1;break;case Mscrm.InternalUtilities.EntityNames.Appointment:case Mscrm.InternalUtilities.EntityNames.ActivityPointer:if(records.length===1)if(typeof gridControl.getCellValue!==Mscrm.InternalUtilities.TypeNames.UndefinedType){var $v_G=gridControl.getCellValue("instancetypecode",records[0].Id);if(Mscrm.InternalUtilities.JSTypes.isNull($v_G)&&Mscrm.CommandBarActions.isMobileCompanionApp()){if(Xrm.Page.context.client.getClientState()!=="Online")return;Xrm.Internal.messages.retrieve($v_8,records[0].Id.toString(),["instancetypecode"]).then(function($p1_0){if(Mscrm.InternalUtilities.JSTypes.isNull($p1_0))return;var $v_H=$p1_0.get_entity();$v_G=$v_H.getValue("instancetypecode").getValue("value").toString();if($v_G!=="0"&&$v_G!=="1")Mscrm.GridCommandActions.$I(records,$v_6);else Mscrm.GridCommandActions.$J($v_4,$v_7,records,$v_1,$v_0?$v_3:$v_2,$v_6,$v_5)},Mscrm.CommandBarActions.actionFailedCallback);return}else if($v_G!=="0"&&$v_G!=="1"){Mscrm.GridCommandActions.$I(records,$v_6);return}}break;case Mscrm.InternalUtilities.EntityNames.Equipment:if(records.length>0){var $v_I=Xrm.Internal.getResourceString("MenuItem_Delete_Equipment_Confirm_Part1")+"\n\n"+Xrm.Internal.getResourceString("MenuItem_Delete_Equipment_Confirm_Part2");if(confirm($v_I))Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_7,records,570,250,null,$v_5);else return}return;case Mscrm.InternalUtilities.EntityNames.Contract:if(records.length===1)$v_7.get_query()["sIds"]=records[0].Id;break;case Mscrm.InternalUtilities.EntityNames.QueueItem:$v_0=true;$v_4=true;break;case Mscrm.InternalUtilities.EntityNames.Solution:if(records.length!==1){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Message.SolutionHomePage.OnlySelectOne"));return}$v_7.get_query()["sIds"]=records[0].Id;break;case Mscrm.InternalUtilities.EntityNames.SystemForm:$v_7.get_query()["sIds"]=records[0].Id;break;case Mscrm.InternalUtilities.EntityNames.Audit:if(records.length===1){var $v_J=gridControl.getCellValue("number",records[0].Id);if($v_J==="1"){if(gridControl.get_pageRecordCount()===1){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Audit.LogManagement.InUsePartition"));return}var $v_K=gridControl.getCellValue("enddatetimeraw",records[0].Id);$v_7.get_query()["iAuditEndDate"]=$v_K}else{Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("Audit.LogManagement.SelectOldest"));return}}break;case Mscrm.InternalUtilities.EntityNames.SharePointSite:$v_7=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("delete_sharepointsite",entityTypeCode,records.length);break;case Mscrm.InternalUtilities.EntityNames.Calendar:$v_7.get_query()["cType"]="1";break;case Mscrm.InternalUtilities.EntityNames.Workflow:for(var $v_A=new Sys.StringBuilder,$v_L=0;$v_L<records.length;$v_L++){$v_L>0&&$v_A.append(";");var $v_M=new RemoteCommand("CustomerService","GetRendererObjectTypeCode");$v_M.SetParameter("workflowId",records[0].Id);var $v_N=$v_M.Execute();if($v_N.Success){var $v_O=$v_N.ReturnValue;if(!IsNull($v_O)&&($v_O===Mscrm.InternalUtilities.EntityNames.SLA||$v_O===Mscrm.InternalUtilities.EntityNames.SLAItem||$v_O===Mscrm.InternalUtilities.EntityNames.RoutingRule||$v_O===Mscrm.InternalUtilities.EntityNames.ConvertRule)){Mscrm.InternalUtilities._Script.alert(Xrm.Internal.getResourceString("LOCID_DELETE_WORKFLOW"));return}}$v_A.append(records[$v_L].Id)}$v_7.get_query()["sIds"]=$v_A.toString();break;case Mscrm.InternalUtilities.EntityNames.Account:$v_7=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete_account.aspx");$v_7.get_query()["iObjType"]=entityTypeCode;$v_7.get_query()["iTotal"]=records.length;$v_7.get_query()["sIds"]=records[0].Id;break;case Mscrm.InternalUtilities.EntityNames.Contact:$v_7=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete_contact.aspx");$v_7.get_query()["iObjType"]=entityTypeCode;$v_7.get_query()["iTotal"]=records.length;$v_7.get_query()["sIds"]=records[0].Id;break;case Mscrm.InternalUtilities.EntityNames.OpportunityProduct:for(var $v_B=new Array(records.length),$v_P=0;$v_P<records.length;$v_P++)$v_B[$v_P]=records[$v_P].Id;var $v_C=[];if(Mscrm.CommandBarActions.isMobileCompanionApp())$v_C[0]=$v_B[0];else{$v_C[0]=window.parent;$v_C[1]=$v_B;$v_C[2]=window.self}$v_5=$v_C;$v_7=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("deleteqoiproduct",entityTypeCode,records.length);$v_7.get_query()["sParentId"]=Xrm.Page.data.entity.getId();break;case Mscrm.InternalUtilities.EntityNames.CalendarRule:$v_7.get_query()["cType"]=gridControl.GetParameter("calendarType");$v_7.get_query()["holidayCalendarId"]=$get("calendarid").value;break;default:if(entityTypeCode===9802||entityTypeCode===9805){for(var $v_Q=new Array(records.length),$v_R=0;$v_R<records.length;$v_R++)$v_Q[$v_R]=records[$v_R].Id.split(":")[2];$v_5=$v_Q}break}Mscrm.GridCommandActions.$J($v_4,$v_7,records,$v_1,$v_0?$v_3:$v_2,$v_6,$v_5)};Mscrm.GridCommandActions.RefreshGrid=function(returnValue,gridControl){(Mscrm.CommandBarActions.isMobileCompanionApp()||!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)&&returnValue)&&gridControl.refresh()};Mscrm.GridCommandActions.PerformActionAfterDeleteFromGrid=function(returnValue,gridControl,records){if(Mscrm.CommandBarActions.isMobileCompanionApp()){gridControl.refresh();return}if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)&&returnValue){if(!Mscrm.InternalUtilities.JSTypes.isNull(records)&&records.length>0){for(var $v_0=new Array(records.length),$v_1=0;$v_1<records.length;$v_1++)$v_0[$v_1]=records[$v_1].Id;Mscrm.CommandBarActions.$W($v_0)}gridControl.refresh()}};Mscrm.GridCommandActions.$i=function($p0){for(var $v_0=new Sys.StringBuilder,$v_1=0;$v_1<$p0.length;$v_1++){$v_1>0&&$v_0.append(",");$v_0.append($p0[$v_1].TypeCode.toString())}return $v_0.toString()};Mscrm.GridCommandActions.$I=function($p0,$p1){var $v_0=Mscrm.CrmUri.create("/activities/act_dlgs/dlg_seriesaction.aspx");$v_0.get_query()["actionType"]="5";$v_0.get_query()["eId"]=$p0[0].Id;Mscrm.InternalUtilities.GridUtilities.executeStandardAction($v_0,$p0,380,270,$p1)};Mscrm.GridCommandActions.$J=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){if($p0)$p1.get_query()["sSubTypes"]=Mscrm.GridCommandActions.$i($p2);Mscrm.InternalUtilities.GridUtilities.executeStandardAction($p1,$p2,$p3,$p4,$p5,$p6)};Mscrm.GridCommandActions.opportunityClose=function(selectedOpportunities,won){var $v_0=selectedOpportunities[0],$v_1=Mscrm.CrmUri.create("/SFA/opps/dlg_closeopp.aspx");$v_1.get_query()["pId"]=$v_0.Id;$v_1.get_query()["pType"]=Mscrm.InternalUtilities.EntityTypeCode.Opportunity;if(!Mscrm.InternalUtilities.JSTypes.isNull(won))$v_1.get_query()["won"]=won;var $v_2=new Xrm.DialogOptions;$v_2.width=450;$v_2.height=420;var $v_3=Mscrm.GridCommandActions.performActionAfterOpportunityClose,$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_3,[$v_0]);Xrm.Internal.openDialog($v_1.toString(),$v_2,null,null,$v_4)};Mscrm.GridCommandActions.performActionAfterOpportunityClose=function(returnValue,selectedOpportunity){if(!Mscrm.InternalUtilities.JSTypes.isNull(returnValue)){var $v_0=selectedOpportunity.Id.toString(),$v_1=selectedOpportunity.Name,$v_2=function(){Xrm.Internal.refreshParentGrid(Mscrm.InternalUtilities.EntityTypeCode.Opportunity,$v_1,$v_0)};Mscrm.CommandBarActions.$V(returnValue,$v_0,$v_2)}};Mscrm.GridCommandActions.opportunityReopen=function(selectedOpportunities){for(var $v_0=0,$v_1=-1,$v_2=0;$v_2<selectedOpportunities.length;$v_2++){var $v_3=selectedOpportunities[$v_2].Id.toString();Xrm.Internal.messages.setState(Mscrm.InternalUtilities.EntityNames.Opportunity,$v_3,$v_0,$v_1).then(function(){Xrm.Internal.refreshParentGrid(Mscrm.InternalUtilities.EntityTypeCode.Opportunity,"",$v_3)},Mscrm.CommandBarActions.actionFailedCallback)}};Mscrm.GridCommandActions.createNewLineItem=function(targetEntityTypeCode,primaryEntityTypeCode,primaryEntityId){if(!Mscrm.CommandBarActions.isMobileCompanionApp())return;var $v_0=Xrm.Page.grid;if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_1=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Xrm.Internal.getEntityName(primaryEntityTypeCode),new Microsoft.Dynamics.Client.Core.Framework.Guid(primaryEntityId)),$v_2=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelationshipReference($v_0.getRelationshipName(),$v_0.getRelationshipAttributeName(),$v_0.getRelationshipRoleOrdinal(),$v_0.getRelationshipType());Xrm.Utility.create(Xrm.Internal.getEntityName(targetEntityTypeCode),$v_1,$v_2,null,null)}};Mscrm.SdkSerializationHelper=function(){};Mscrm.SdkSerializationHelper.getEntityObject=function($p0,$p1,$p2){var $v_0=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference($p0,$p1),$v_1={},$v_2={},$v_3=new Array(Xrm.Page.data.entity.attributes.getLength()),$v_4=0,$v_5=$p1!==Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty();Xrm.Page.data.entity.attributes.forEach(function($p1_0,$p1_1){var $v_7=$p1_0;if($v_7.getSubmitMode()!=="never")if($v_5&&$v_7.getIsDirty()||!$v_5){var $v_8=$v_7.getValue(),$v_9=$v_7.getName(),$v_A=$p2[$v_9];if(Mscrm.InternalUtilities.JSTypes.isNull($v_A))$v_A=Mscrm.SdkSerializationHelper.$k($v_7);if(Mscrm.InternalUtilities.JSTypes.isNull($v_8))$v_1[$v_9]=null;else $v_1[$v_9]=Mscrm.SdkSerializationHelper.$l($v_8,$v_A);$v_2[$v_9]=$v_A;$v_3[$v_4++]=$v_9}});$v_1["patternendtype"]=$v_1["patternendtype"]||-1;var $v_6=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_0,$v_1,$v_2,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_6.get_changedFieldNames().addRange($v_3);return $v_6};Mscrm.SdkSerializationHelper.$l=function($p0,$p1){switch($p1){case 10:for(var $v_0=$p0,$v_1=new Array($v_0.length),$v_5=0;$v_5<$v_0.length;$v_5++){var $v_6=$v_0[$v_5],$v_7=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference(Mscrm.InternalUtilities.EntityNames.ActivityParty,Microsoft.Dynamics.Client.Core.Framework.Guid.get_empty()),$v_8={},$v_9={};$v_8["partyid"]=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference($v_6.entityType,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_6.id),$v_6.name);$v_9["partyid"]=6;var $v_A=new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityRecord($v_7,$v_8,$v_9,{},{},new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.RelatedEntityCollection(new Array(0)));$v_A.get_changedFieldNames().add("partyid");$v_1[$v_5]=$v_A}return Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection.createFromEntities($v_1);case 6:var $v_2=$p0,$v_3=$v_2[0];return new Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference($v_3.entityType,new Microsoft.Dynamics.Client.Core.Framework.Guid($v_3.id),$v_3.name);case 2:var $v_4=$p0;$v_4=new Date($v_4.getFullYear(),$v_4.getMonth(),$v_4.getDate(),$v_4.getHours(),$v_4.getMinutes());return $v_4;default:return $p0}};Mscrm.SdkSerializationHelper.$k=function($p0){var $v_0=$p0.getAttributeType();switch($v_0){case "boolean":return 0;case "datetime":return 2;case "integer":return 5;case "lookup":var $v_1=$p0,$v_2=!!$v_1&&$v_1.getIsPartyList();if($v_2)return 10;return 6;case "optionset":return 11;case "string":case "memo":return 14;case "money":return 8;case "decimal":return 3;case "double":return 4;default:throw Error.create(String.format("attributeType '{0}' is not supported",$v_0))}};Mscrm.CampaignActivityStateHandler=function(){};Mscrm.CampaignActivityStateHandler.$Y=function($p0){var $v_0=Xrm.Page.data.entity.attributes.get("statecode");if(!Mscrm.InternalUtilities.JSTypes.isNull($v_0)){var $v_1=$v_0.getValue();window.CampaignActivityState=Mscrm.CampaignActivityState.toString($v_1);Xrm.Page.ui.refreshRibbon()}$v_0.removeOnChange(Mscrm.CampaignActivityStateHandler.$Y)};Mscrm.CampaignActivityStateHandler.prototype={setDates:function(actualStartDate,actualEndDate){this.$Z_0(actualStartDate,"actualstart");this.$Z_0(actualEndDate,"actualend")},updateState:function(){var $v_0=Xrm.Page.data.entity.attributes.get("statecode");$v_0.addOnChange(Mscrm.CampaignActivityStateHandler.$Y)},$Z_0:function($p0,$p1){if(Mscrm.InternalUtilities.JSTypes.isNull($p0))return;var $v_0=$p0.toString();if(Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_0))return;var $v_1=ParseUtcDate($v_0);if(!Mscrm.InternalUtilities.JSTypes.isNull($v_1)){var $v_2=Xrm.Page.data.entity.attributes.get($p1);this.$e_0($p1);$v_2.setValue($v_1)}},$e_0:function($p0){this.$r_0($p0,false)},$r_0:function($p0,$p1){var $v_0=Xrm.Page.ui.controls.get($p0);!Mscrm.InternalUtilities.JSTypes.isNull($v_0)&&$v_0.getDisabled()!==$p1&&$v_0.setDisabled($p1)}};Mscrm.CommandBarActions.registerClass("Mscrm.CommandBarActions");Mscrm.CloseOpportunityDialogResult.registerClass("Mscrm.CloseOpportunityDialogResult");Mscrm.ResolveCaseDialogResult.registerClass("Mscrm.ResolveCaseDialogResult");Mscrm.GridCommandActions.registerClass("Mscrm.GridCommandActions");Mscrm.SdkSerializationHelper.registerClass("Mscrm.SdkSerializationHelper");Mscrm.CampaignActivityStateHandler.registerClass("Mscrm.CampaignActivityStateHandler");Mscrm.CommandBarActions.$M=-2147163904;Type.registerNamespace("Mscrm.InternalUtilities");Mscrm.InternalUtilities.ClientApiUtility=function(){};Mscrm.InternalUtilities.ClientApiUtility.operationFailedCallback=function(response){var $v_0=response.errorCode,$v_1=response.message;Mscrm.InternalUtilities.ClientApiUtility.$1($v_0,$v_1)};Mscrm.InternalUtilities.ClientApiUtility.$1=function($p0,$p1){var $v_0="0x"+($p0<0?4294967295+$p0+1:$p0).toString(16).toUpperCase();if($v_0.startsWith("0x8004E1"))switch($v_0){case "0x8004E108":case "0x8004E121":case "0x8004E117":case "0x8004E123":case "0x8004E122":case "0x8004E113":$p1=Xrm.Internal.getErrorMessage($p0);break;default:$p1=Xrm.Internal.getErrorMessage(Mscrm.InternalUtilities.ClientApiUtility.$0);break}else if($p0!==-2147220891){var $v_1=Xrm.Internal.getErrorMessage($p0);if(!Mscrm.InternalUtilities.JSTypes.isNullOrEmptyString($v_1))$p1=$v_1}Xrm.Internal.openErrorDialog($p0,$p1)};Mscrm.InternalUtilities.ClientApiUtility.createRefreshGridCallback=function(gridControl){var $v_0=null;if(Mscrm.InternalUtilities.ClientApiUtility.isMobileCompanionApp()||Xrm.Page.context.isOutlookClient()){var $v_1=Mscrm.GridCommandActions.RefreshGrid;$v_0=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_1,[gridControl])}return $v_0};Mscrm.InternalUtilities.ClientApiUtility.isMobileCompanionApp=function(){return Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile};Mscrm.InternalUtilities.ClientApiUtility.registerClass("Mscrm.InternalUtilities.ClientApiUtility");Mscrm.InternalUtilities.ClientApiUtility.$0=-2147163904