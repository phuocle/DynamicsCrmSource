Type.registerNamespace("Mscrm");Mscrm.IncidentActions=function(){};Mscrm.IncidentActions.resolveCase=function(selectedCaseData,gridControl){Mscrm.GridCommandActions.resolveCase(selectedCaseData,gridControl)};Mscrm.IncidentActions.cancelCase=function(selectedCaseData,gridControl){Mscrm.GridCommandActions.cancelCase(selectedCaseData,gridControl)};Mscrm.IncidentActions.runRoutingRule=function(gridControl,selectedCases){Mscrm.GridCommandActions.runRoutingRule(gridControl,selectedCases)};Mscrm.RibbonActions=function(){};Mscrm.RibbonActions.isRefreshForm=function(){return Mscrm.CommandBarActions.isRefreshForm()};Mscrm.RibbonActions.notOnMarketingListOrListUnlocked=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListUnLocked()};Mscrm.RibbonActions.notOnMarketingListOrListActive=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListActive()};Mscrm.RibbonActions.alwaysEnabled=function(){return Mscrm.CommandBarActions.alwaysEnabled()};Mscrm.RibbonActions.isAutoSaveEnabled=function(){return Xrm.Page.context.getIsAutoSaveEnabled()};Mscrm.RibbonActions.isBulkSetRegardingValid=function(entityTypeCode,records){return Mscrm.GridCommandActions.isBulkSetRegardingValid(entityTypeCode,records)};Mscrm.RibbonActions.saveForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("");else Mscrm.RibbonActions.saveLegacyForm(form,"Save")};Mscrm.RibbonActions.saveAndCloseForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("saveandclose");else Mscrm.RibbonActions.saveLegacyForm(form,"SaveAndClose")};Mscrm.RibbonActions.saveAndNewForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("saveandnew");else Mscrm.RibbonActions.saveLegacyForm(form,"SaveAndNew")};Mscrm.RibbonActions.sendFormShortcut=function(usingEmail,form){Mscrm.CommandBarActions.sendFormShortcut(usingEmail,form)};Mscrm.RibbonActions.openNewRecord=function(entityLogicalName,gridControl){if(Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp()){Mscrm.CommandBarActions.openNewRecord(entityLogicalName,null,null);return}if(!IsNull(gridControl)&&gridControl.isLiteSubGrid())if(entityLogicalName===Mscrm.InternalUtilities.EntityNames.ActivityPointer&&gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid){gridControl.addButtonClickHandler();return}else if(Mscrm.GridRibbonActions.OpenQuickCreateFormForNewRecord(gridControl))return;Xrm.Utility.openEntityForm(entityLogicalName,null,null)};Mscrm.RibbonActions.openObjFromClassic=function(entityTypeCode){Mscrm.RibbonActions.openNewRecord(Xrm.Internal.getEntityName(entityTypeCode),null)};Mscrm.RibbonActions.isEntitlementActive=function(){var $v_0=true;if(!IsNull(Xrm.Page.data)&&!IsNull(Xrm.Page.ui)){var $v_1=Xrm.Page.data.entity.attributes.get("statecode");if(Xrm.Page.data.entity.getEntityName()==="entitlement")if(Xrm.Page.ui.getFormType()===4)$v_0=true;else $v_0=false;else if(Xrm.Page.ui.getFormType()===4&&(!IsNull($v_1)&&$v_1.getText()==="Inactive"))$v_0=false;else $v_0=true}return $v_0};Mscrm.RibbonActions.enableAddCaseForContract=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACT))return window.ADDCASE_ENABLED_FOR_CONTRACT;else return true};Mscrm.RibbonActions.enableAddCaseForContractLine=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACTLINE))return window.ADDCASE_ENABLED_FOR_CONTRACTLINE;else return true};Mscrm.XrmRibbonActionUtilities=function(){};Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp=function(){return Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile};Mscrm.List=function(){};Mscrm.List.convertLead=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.qualifyLeadQuick(gridControl,records,entityTypeCode)};Mscrm.OpportunityActions=function(){};Mscrm.OpportunityActions.close=function(selectedOpportunities,won,gridControl){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile){Mscrm.GridCommandActions.opportunityClose(selectedOpportunities,won);return}typeof Mscrm.OpportunityActions!=="undefined"&&Mscrm.OpportunityActions.closeLegacy(selectedOpportunities,won,gridControl)};Mscrm.GridRibbonActions=function(){};Mscrm.GridRibbonActions.deleteRecords=function(gridControl,records,entityTypeCode){if(Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp()){Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode);return null}switch(entityTypeCode){case Mscrm.EntityTypeCode.QuoteDetail:case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.UserQuery:if(typeof Mscrm.Grid!=="undefined")return Mscrm.Grid.deleteRecords(gridControl,records,entityTypeCode);return null;default:if(typeof Mscrm.GridCommandActions!=="undefined")Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode);else if(typeof Mscrm.Grid!=="undefined")return Mscrm.Grid.deleteRecords(gridControl,records,entityTypeCode);return null}};Mscrm.GridRibbonActions.canMarkComplete=function(records){return Mscrm.GridCommandActions.canMarkComplete(records)};Mscrm.GridRibbonActions.gridDisassociate=function(typeCode,gridControl,firstSelectedItemId){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile){Mscrm.CommandBarActions.disassociate(gridControl,null);return}Mscrm.GridRibbonActions.gridDisassociateLegacy(typeCode,gridControl,firstSelectedItemId)};Mscrm.GridRibbonActions.isBulkSaveAsCancelledValid=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.outlook&&Xrm.Page.context.client.getClientState()==="Offline")return false;return Mscrm.GridCommandActions.isBulkSaveAsCancelledValid(entityTypeCode)};Mscrm.GridRibbonActions.isBulkSaveAsCompletedValid=function(entityTypeCode){return Mscrm.GridCommandActions.isBulkSaveAsCompletedValid(entityTypeCode)};Mscrm.GridRibbonActions.addNewFromSubGridStandard=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){if(!Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp())Mscrm.GridRibbonActions.addNewFromSubGridStandardLegacy(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl);else Mscrm.GridCommandActions.addNewFromSubGrid(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl)};Mscrm.GridRibbonActions.addToQueue=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.addToQueue(gridControl,records,entityTypeCode)};Mscrm.GridRibbonActions.assignSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode)};Mscrm.GridRibbonActions.setRegarding=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.setRegarding(gridControl,records,entityTypeCode)};Mscrm.GridRibbonActions.activate=function(gridControl,records,entityTypeCode,callback){Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode,callback)};Mscrm.GridRibbonActions.deactivate=function(gridControl,records,entityTypeCode,defaultCloseState,callback){Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState,callback)};Mscrm.GridRibbonActions.notOnMarketingListOrListUnlocked=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListUnLocked()};Mscrm.GridRibbonActions.notOnMarketingListOrListActive=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListActive()};Mscrm.FormAction=function(){};Mscrm.FormAction.changeState=function(action){var $v_0=Xrm.Page.data.entity.getId(),$v_1=Xrm.Page.data.entity.getEntityName();Mscrm.CommandBarActions.changeState(action,$v_0,$v_1)};Mscrm.FormAction.assignObject=function(objectType){if(typeof objectType!==Mscrm.InternalUtilities.TypeNames.NumberType)objectType=parseInt(objectType,10);Mscrm.CommandBarActions.assignObject(objectType)};Mscrm.IncidentActions.registerClass("Mscrm.IncidentActions");Mscrm.RibbonActions.registerClass("Mscrm.RibbonActions");Mscrm.XrmRibbonActionUtilities.registerClass("Mscrm.XrmRibbonActionUtilities");Mscrm.List.registerClass("Mscrm.List");Mscrm.OpportunityActions.registerClass("Mscrm.OpportunityActions");Mscrm.GridRibbonActions.registerClass("Mscrm.GridRibbonActions");Mscrm.FormAction.registerClass("Mscrm.FormAction")