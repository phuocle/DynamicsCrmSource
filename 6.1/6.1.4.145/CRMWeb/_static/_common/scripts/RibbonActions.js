Type.registerNamespace("Mscrm");Mscrm.ExportDialogArguments=function(){};Mscrm.ExportDialogReturnValue=function(){};Mscrm.ExportDialogResult=function(){};Mscrm.ExportDialogResult.prototype={cancel:-1,currentPage:0,allPages:1,liveList:2,livePivot:3,currentPageExcel:4,allPagesExcel:5};Mscrm.ExportDialogResult.registerEnum("Mscrm.ExportDialogResult",false);Mscrm.DetectDuplicateArguments=function(){};Mscrm.ReportResult=function(){};Mscrm.ReportResult.prototype={cancel:-1,selected:0,view:1,defaultResult:2};Mscrm.ReportResult.registerEnum("Mscrm.ReportResult",false);Mscrm.TeamActions=function(){};Mscrm.TeamActions.addTeamMembers=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("addtoteam",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,records,500,225)};Mscrm.TeamActions.removeTeamMembers=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("removefromteam",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,records,540,230)};Mscrm.TeamActions.manageTeamRoles=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("role",entityTypeCode,records.length),$v_1=500,$v_2=330;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.TeamActions.isTeamTypeOwnerType=function(){var $v_0=Xrm.Page.getAttribute("teamtype");if(!IsNull($v_0)){var $v_1=$v_0.getValue();if(0===$v_1)return true;else return false}return true};Mscrm.TeamActions.enableOwnerTeamCommands=function(gridControl){for(var $v_0=gridControl,$v_1=$v_0.GetRecordsFromInnerGrid(true),$v_2=3,$v_3=false,$v_4=0;$v_4<$v_1.length;++$v_4){var $v_5=$v_1[$v_4][$v_2];if(parseInt($v_5.getAttribute("teamtype"),10)===0){$v_3=true;break}}return $v_3};Mscrm.UserQueryActions=function(){};Mscrm.UserQueryActions.filterGridByType=function(gridControl,commandProperties){if(!commandProperties)return;var $v_0=commandProperties["SourceControlId"];Mscrm.UserQueryActions.changeViewTitle(Mscrm.UserQueryActions.$k($v_0));var $v_1=$v_0.split(".");Mscrm.UserQueryActions._queryTargetTypeCode=Number.parseInvariant($v_1[$v_1.length-1]);Mscrm.UserQueryActions.refreshGrid(gridControl)};Mscrm.UserQueryActions.$k=function($p0){var $v_0=XUI.Xml.SelectSingleNode(Mscrm.UserQueryActions.get_$G(),"/Menu/MenuSection/Controls/Button[@Id='"+$p0+"']",null),$v_1="";if(!IsNull($v_0))$v_1=$v_0.attributes.getNamedItem("LabelText").nodeValue;return $v_1};Mscrm.UserQueryActions.refreshGrid=function(gridControl){gridControl.SetParameter("returnedtypecode",Mscrm.UserQueryActions._queryTargetTypeCode.toString(10));gridControl.SetParameter("customquery","FilterByObjectType");var $v_0=$get(gridControl.get_id()+"_SavedNewQuerySelector");if($v_0.nodeValue===window.LOCID_SEARCH_RESULTS)quickFind(gridControl);else handleView(null,gridControl)};Mscrm.UserQueryActions.setEntityDefaultView=function(selectedRecords){try{var $v_0=selectedRecords[0];setDefaultEntityView(Mscrm.UserQueryActions._queryTargetTypeCode,$v_0.Id,$v_0.TypeCode)}catch($$e_2){}};Mscrm.UserQueryActions.populateRecordType=function(commandProperties){if(!IsNull(Mscrm.UserQueryActions.get_$G())){commandProperties["PopulationXML"]=XUI.Xml.XMLSerializer.serializeToString(Mscrm.UserQueryActions.get_$G());commandProperties["SuppressCommandIncludes"]=true}};Mscrm.UserQueryActions.get_$G=function(){if(IsNull(Mscrm.UserQueryActions.$8)){var $v_0="userquery",$v_1="userquery|NoRelationship|SubGridStandard|Mscrm.SubGrid.userquery.MainTab.View.RecordType",$v_2=new RemoteCommand("AdvancedFind","GenerateRecordTypeMenuXml");$v_2.SetParameter("entityLogicalName",$v_0);$v_2.SetParameter("menuId",$v_1);var $v_3=$v_2.Execute();if($v_3.Success)Mscrm.UserQueryActions.$8=XUI.Xml.LoadXml($v_3.ReturnValue)}return Mscrm.UserQueryActions.$8};Mscrm.UserQueryActions.changeViewTitle=function(entityName){var $v_0=String.format(window.LOCID_AF_SVDVIEWTITLE,entityName),$v_1=$get("userQueries"),$v_2=$get("newViewSelector",$v_1);Sys.UI.DomElement.removeCssClass($v_2,"ms-crm-View-Entity-OverflowName");$v_2.style.width="";$v_2.innerHTML=CrmEncodeDecode.CrmHtmlEncode($v_0);$v_2.title=$v_0;var $v_3=$get("viewSelectorContainer").clientWidth/2,$v_4=$v_2.clientWidth;$v_4=$v_4<$v_3?$v_4:$v_3;$v_4=$v_4?$v_4:50;Sys.UI.DomElement.addCssClass($v_2,"ms-crm-View-Entity-OverflowName");$v_2.style.width=$v_4.toString()+"px"};Mscrm.Campaign=function(){};Mscrm.Campaign.newTemplate=function(){openObjEx(Mscrm.EntityTypeCode.Campaign,Mscrm.EntityTypeCode.None,null,"?template=1",null)};Mscrm.Campaign.copyCampaign=function(campaignId,saveAsTemplate){var $v_0=new RemoteCommand("MarketingAutomation","CopyCampaign",null);$v_0.SetParameter("campaignId",campaignId);$v_0.SetParameter("saveAsTemplate",saveAsTemplate.toString());var $v_1=$v_0.Execute(),$v_2=$v_1.ReturnValue;openObj(Mscrm.EntityTypeCode.Campaign,$v_2,null,null,Mscrm.NavigationMode.NavigationModeInline,null);Mscrm.Utilities.refreshParentGrid(Mscrm.EntityTypeCode.Campaign,campaignId)};Mscrm.IncidentActions=function(){};Mscrm.IncidentActions.cancelCase=function(caseId,gridControl){Mscrm.Utilities.isRefreshForm()&&Mscrm.ReadFormUtilities.execute(Mscrm.InlineCommands.IncidentCancel,null);if(Mscrm.CommandBarActions.isServiceMetadataAvailable())switch(Mscrm.FormAction.isValidStatusReasonTransition(caseId,2)){case 1:Mscrm.IncidentActions.$J(caseId,gridControl,"novalidstatustransition");break;case 2:Mscrm.IncidentActions.$J(caseId,gridControl,"activeactivities");break;case 3:Mscrm.IncidentActions.$B(caseId,gridControl,"performActionAfterCancelCase",null,"/CS/cases/dlg_cancel.aspx?pId="+caseId,520,230,false);break}else Mscrm.IncidentActions.performActionAfterConfirmCancelCase(true,caseId,gridControl)};Mscrm.IncidentActions.$B=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){var $v_0=[$p0,$p1],$v_1=Mscrm.Utilities.createCallbackFunctionObject($p2,Mscrm.IncidentActions,$v_0,$p7),$v_2=new Mscrm.CrmDialog(Mscrm.CrmUri.create($p4),$p3,$p5,$p6,null);$v_2.setCallbackReference($v_1);return $v_2.show()};Mscrm.IncidentActions.$J=function($p0,$p1,$p2){var $v_0=Mscrm.CrmUri.create("/CS/cases/dlg_ConfirmCancel.aspx");$v_0.get_query()["pId"]=$p0;$v_0.get_query()["pType"]=Mscrm.EntityTypeCode.Incident;$v_0.get_query()["reason"]=$p2;Mscrm.IncidentActions.$B($p0,$p1,"performActionAfterConfirmCancelCase",null,"/CS/cases/dlg_ConfirmCancel.aspx?reason="+$p2,600,250,false)};Mscrm.IncidentActions.performActionAfterConfirmCancelCase=function(returnValue,caseId,gridControl){var $v_0=false;if(returnValue)$v_0=Mscrm.IncidentActions.$B(caseId,gridControl,"performActionAfterCancelCase",window.document,"/CS/cases/dlg_cancel.aspx?pId="+caseId,400,391,false);return $v_0};Mscrm.IncidentActions.performActionAfterCancelCase=function(returnValue,caseId,gridControl){if(returnValue){var $v_0=new RemoteCommand("CustomerService","CancelCase");$v_0.SetParameter("caseId",caseId);$v_0.SetParameter("newStatus",returnValue.StatusCode);$v_0.Execute();gridControl&&gridControl.refresh()}};Mscrm.IncidentActions.resolveCase=function(caseId,gridControl){Mscrm.FormAction.resolveCase(caseId,gridControl)};Mscrm.IncidentActions.runRoutingRule=function(gridControl,records){if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}for(var $v_0=new Array(records.length),$v_4=0;$v_4<records.length;$v_4++)if($v_0.length>0)$v_0[$v_4]=records[$v_4].Id;var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_routecase.aspx");$v_1.get_query()["iTotal"]=records.length;var $v_2=new Mscrm.CrmDialog($v_1,$v_0,460,250,null),$v_3=$v_2.show();$v_3&&$v_3&&gridControl&&gridControl.refresh()};Mscrm.IncidentActions.caseFlow=function(activityTypeCode){var $v_0=Mscrm.CrmUri.create("/_forms/read/page.aspx");$v_0.get_query()["formid"]=Mscrm.IncidentActions.$H;$v_0.get_query()["activitytypecode"]=activityTypeCode;$v_0.get_query()["setlastviewed"]=false;$v_0.get_query()["rof"]=true;$v_0.get_query()["theme"]=window.RefreshFormTheme;openObj(Mscrm.EntityTypeCode.Incident,"",$v_0.get_queryString())};Mscrm.IncidentActions.isNotChildCase=function(){var $v_0=null;if(!IsNull(Xrm.Page.data)&&!IsNull(Xrm.Page.data.entity)&&!IsNull(Xrm.Page.data.entity.attributes))$v_0=Xrm.Page.data.entity.attributes.get("parentcaseid");return !($v_0&&$v_0.getValue())};Mscrm.IncidentActions.isRefreshFormAccessible=function(){var $v_0=new RemoteCommand("CustomerService","IsRefreshFormAccessible");$v_0.SetParameter("formId",Mscrm.IncidentActions.$H);var $v_1=$v_0.Execute();return !!$v_1&&$v_1.ReturnValue};Mscrm.Article=function(){};Mscrm.Article.articleRibbonActions=function(gridControl,selectedRecords,entityTypeCode,action){var $v_0=Mscrm.GridRibbonActions.$0(action,entityTypeCode,selectedRecords.length),$v_1=600,$v_2=200;if(action==="articleview"){$v_0=Mscrm.CrmUri.create("/CS/articles/viewer/default.aspx");$v_0.get_query()["id"]=selectedRecords[0].Id;$v_1=650;$v_2=500}Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,$v_1,$v_2)};Mscrm.ImportFileActions=function(){};Mscrm.ImportFileActions.deleteAllRecordsForCurrentImportFile=function(gridControl,records,entityTypeCode){var $v_0="deleteimportedrecords";doAction(gridControl.get_id(),entityTypeCode,$v_0,null)};Mscrm.ImportFileActions.deleteAllRecordsForCurrentImport=function(gridControl,records,entityTypeCode){var $v_0="deleteallimportedrecords";doAction(gridControl.get_id(),entityTypeCode,$v_0,null)};Mscrm.EmailServerProfileActions=function(){};Mscrm.EmailServerProfileActions.SetDefaultFromGrid=function(records){Mscrm.EmailServerProfileActions.setDefault(records[0].Id);refreshRibbon()};Mscrm.EmailServerProfileActions.SetDefaultFromForm=function(){var $v_0=$find("crmForm");if(!$v_0.IsValid(false))return;Mscrm.EmailServerProfileActions.setDefault($v_0.get_objectId());refreshRibbon()};Mscrm.EmailServerProfileActions.setDefault=function(id){var $v_0=new RemoteCommand("EmailServerProfileService","SetDefaultProfile",null);$v_0.SetParameter("emailServerProfileId",id);$v_0.Execute()};Mscrm.EmailServerProfileActions.IsOrgDefaultProfileFromGrid=function(records){return Mscrm.EmailServerProfileActions.IsOrgDefaultProfile(records[0].Id)};Mscrm.EmailServerProfileActions.IsOrgDefaultProfileFromForm=function(){var $v_0=$get("crmFormSubmit");return Mscrm.EmailServerProfileActions.IsOrgDefaultProfile($v_0.crmFormSubmitId.value)};Mscrm.EmailServerProfileActions.IsOrgDefaultProfile=function($p0){var $v_0=new RemoteCommand("EmailServerProfileService","IsDefaultProfile",null);$v_0.SetParameter("emailServerProfileId",$p0);var $v_1=$v_0.Execute();if($v_1.Success&&$v_1.ReturnValue)return true;else return false};Mscrm.EmailServerProfileActions.NewExchangeEmailServerProfile=function(){Mscrm.EmailServerProfileActions.$V("ServerType=Exchange")};Mscrm.EmailServerProfileActions.NewOtherEmailServerProfile=function(){Mscrm.EmailServerProfileActions.$V("ServerType=Other")};Mscrm.EmailServerProfileActions.$V=function($p0){openObj(Mscrm.EntityTypeCode.EmailServerProfile,null,$p0,"",Mscrm.NavigationMode.NavigationModeNewWindow,null)};Mscrm.List=function(){};Mscrm.List.copyTo=function(gridControl,records,entityTypeCode){var $v_0="copyto",$v_1=[gridControl,$v_0,entityTypeCode,records,400,250],$v_2=Mscrm.Utilities.createCallbackFunctionObject("takeAction",Mscrm.List,$v_1,false);LookupObjectsWithCallback($v_2,null,"single","4300",0,null,"listType=static",1,1,false,"","","","577EA96E-B1F6-499b-98A7-ABB5BE8233F9",null,null,null,null,null,null,null,null,null)};Mscrm.List.takeAction=function(lookupItems,gridControl,actionName,entityTypeCode,records,windowWidth,windowHeight){if(IsNull(lookupItems)||!lookupItems.items.length)return;var $v_0=lookupItems.items[0].id,$v_1=lookupItems.items[0].type,$v_2=Mscrm.GridRibbonActions.$0(actionName,entityTypeCode,records.length);$v_2.get_query()["itemObjectId"]=$v_0;$v_2.get_query()["itemObjectTypeCode"]=$v_1;windowWidth=IsNull(windowWidth)?400:windowWidth;windowHeight=IsNull(windowHeight)?250:windowHeight;Mscrm.GridRibbonActions.$1($v_2,gridControl,records,windowWidth,windowHeight)};Mscrm.List.addToCampaign=function(gridControl,records,entityTypeCode){var $v_0="addtocampaign",$v_1=[gridControl,$v_0,entityTypeCode,records,475,250],$v_2=Mscrm.Utilities.createCallbackFunctionObject("takeAction",Mscrm.List,$v_1,false);LookupObjectsWithCallback($v_2,null,"single","4400",0,null,null,1,1,false,"","","","",null,null,null,null,null,null,null,null,null)};Mscrm.List.manageMembers=function(gridControl,records,entityTypeCode,objectId,form){if(Xrm.Page.data.entity.attributes.get("type").getValue())OpenDynamicListQuery(entityTypeCode,gridControl.get_id(),objectId);else OpenManageMembersWizard(entityTypeCode,gridControl.get_id(),objectId,440,450)};Mscrm.List.manageMembersForm=function(form){var $v_0=Xrm.Page.data.entity.attributes.get("createdfromcode").getValue();if(Xrm.Page.data.entity.attributes.get("type").getValue())OpenDynamicListQuery($v_0,null,Xrm.Page.data.entity.getId());else OpenManageMembersWizard($v_0,null,Xrm.Page.data.entity.getId(),440,450)};Mscrm.List.copyListMembers=function(gridControl,records,entityTypeCode,objectId){var $v_0="copylistmember";doAction(gridControl.get_id(),entityTypeCode,$v_0,"")};Mscrm.List.removeFromList=function(gridControl,records,entityTypeCode){var $v_0="delete";doActionEx(gridControl.get_id(),Mscrm.EntityTypeCode.ListMember,window.parent.$get("crmFormSubmit").crmFormSubmitId.value,$v_0)};Mscrm.List.createOpportunityForMembers=function(gridControl){var $v_0=Xrm.Page.data.entity,$v_1=$v_0.attributes.get("createdfromcode").getValue(),$v_2=null;if(gridControl)$v_2=gridControl.get_id();else switch($v_1){case Mscrm.EntityTypeCode.Account:$v_2="accounts";break;case Mscrm.EntityTypeCode.Contact:$v_2="contacts";break;default:throw Error.invalidOperation("Operation is invalid for this list.")}var $v_3=Mscrm.List.$j($v_2);doActionExArray($v_2,$v_1,$v_0.getId(),"createopportunity",Mscrm.EntityTypeCode.ListMember,"",$v_3)};Mscrm.List.$j=function($p0){var $v_0=$find($p0),$v_1=[];if(!IsNull($v_0)){var $v_2=$v_0.get_innerGrid();if(IsNull($v_2)){var $v_3=$v_0.get_selectedRecords();if(IsNull($v_3)||!$v_3.length)$v_3=$v_0.get_allRecords();for(var $v_4=0;$v_4<$v_3.length;$v_4++)$v_1[$v_4]=$v_3[$v_4].Id}else{var $v_5=$v_0.get_innerGrid().get_selectedRecords();if(IsNull($v_5)||!$v_5.length)$v_5=$v_2.get_allRecords();for(var $v_6=0;$v_6<$v_5.length;$v_6++)$v_1[$v_6]=$v_5[$v_6][0]}}return $v_1};Mscrm.List.isAccountOrContactMemberType=function(objectTypeCode){var $v_0=Xrm.Page.data.entity.attributes.get("createdfromcode");if(!$v_0)return false;var $v_1=IsNull(objectTypeCode)?$v_0.getValue():objectTypeCode;if($v_1===Mscrm.EntityTypeCode.Account||$v_1===Mscrm.EntityTypeCode.Contact)return true;return false};Mscrm.List.copyDynamicListToStatic=function(id){if(Xrm.Page.data.entity.getIsDirty()){alert(window.LOCID_FORM_DIRTY);return}var $v_0=Mscrm.CrmUri.create("/MA/Lists/dlg_copytostatic.aspx"),$v_1=[id],$v_2=new Mscrm.CrmDialog($v_0,null,450,200,null);$v_2.setCallbackInfo("copyDynamicListToStaticCallback",Mscrm.List,$v_1);$v_2.show()};Mscrm.List.copyDynamicListToStaticCallback=function(isCopy,id){if(isCopy){var $v_0=new RemoteCommand("MarketingAutomation","CopyDynamicListToStatic",null);$v_0.SetParameter("listId",id);var $v_1=$v_0.Execute(),$v_2=$v_1.ReturnValue;openObj(Mscrm.EntityTypeCode.List,$v_2,null,null,Mscrm.NavigationMode.NavigationModeInline,null);Mscrm.Utilities.refreshParentGrid(Mscrm.EntityTypeCode.List,id)}};Mscrm.List.isACLFormAndOffline=function(gridTypeCode,gridControl){var $v_0=true;if(!Mscrm.SessionInfo.isOnline()){if(IsNull(gridControl))return false;var $v_1=gridControl.GetParameter("relName");if(gridTypeCode===Mscrm.EntityTypeCode.List)switch($v_1){case "listlead_association":case "listcontact_association":case "listaccount_association":$v_0=false;break;default:break}}return $v_0};Mscrm.List.convertLead=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.qualifyLeadQuick(gridControl,records,entityTypeCode)};Mscrm.MailboxActions=function(){};Mscrm.MailboxActions.launchMailboxFromForm=function(){if(typeof DefaultMailboxId=="undefined")return;var $v_0=DefaultMailboxId;Mscrm.MailboxActions.$T($v_0)};Mscrm.MailboxActions.launchMailboxFromGrid=function(records){if(records.length!==1){alert(LOCID_LAUNCHMAILBOX_NOrMultipleItemSelected);return}var $v_0=records[0];Mscrm.MailboxActions.$s($v_0.Id,$v_0.TypeCode)};Mscrm.MailboxActions.$s=function($p0,$p1){var $v_0=new RemoteCommand("MailboxService","RetrieveDefaultMailboxId",null);$v_0.SetParameter("objectId",$p0);$v_0.SetParameter("objectTypeCode",$p1);var $v_1=$v_0.Execute();Mscrm.MailboxActions.$T($v_1.ReturnValue)};Mscrm.MailboxActions.$T=function($p0){openObj(Mscrm.EntityTypeCode.Mailbox,$p0,"","",Mscrm.NavigationMode.NavigationModeNewWindow,null)};Mscrm.MailboxActions.TestAccessFromForm=function(){var $v_0=$get("crmFormSubmit"),$v_1=new Mscrm.EntityReference;$v_1.Id=$v_0.crmFormSubmitId.value;$v_1.TypeCode=Number.parseInvariant($v_0.crmFormSubmitObjectType.value);if($v_1.TypeCode===Mscrm.EntityTypeCode.Mailbox){var $v_2=new RemoteCommand("MailboxService","IsTestAccessRunning",null);$v_2.SetParameter("mailboxId",$v_1.Id);var $v_3=$v_2.Execute();if($v_3&&$v_3.ReturnValue){alert(window.LOCID_TESTACCESS_ALREADYRUNNING);return}}else if($v_1.TypeCode===Mscrm.EntityTypeCode.EmailServerProfile)if(!Mscrm.MailboxActions.$o($v_1.Id)){alert(window.LOCID_NO_MAILBOX_ASSOCIATED);return}Mscrm.MailboxActions.$9(null,[$v_1],null,530,220,false,1);Mscrm.MailboxActions.$W()};Mscrm.MailboxActions.$W=function(){var $v_0=$find("crmForm");!IsNull($v_0)&&$v_0.SubmitCrmForm(4,false,true,false,false)};Mscrm.MailboxActions.$o=function($p0){var $v_0=new RemoteCommand("EmailServerProfileService","IsAnyActiveMailboxAssociated",null);$v_0.SetParameter("emailServerProfileId",$p0);var $v_1=$v_0.Execute();return !!$v_1&&$v_1.ReturnValue};Mscrm.MailboxActions.TestAccessFromGrid=function(gridControl,records,allRecords){var $v_0=gridControl.get_entityTypeCode()===Mscrm.EntityTypeCode.Mailbox,$v_1=$v_0?300:220;Mscrm.MailboxActions.$9(gridControl,records,allRecords,530,$v_1,$v_0,1)};Mscrm.MailboxActions.ApplyDefaultsFromForm=function(){var $v_0=$get("crmFormSubmit"),$v_1=new Mscrm.EntityReference;$v_1.Id=$v_0.crmFormSubmitId.value;$v_1.TypeCode=Number.parseInvariant($v_0.crmFormSubmitObjectType.value);Mscrm.MailboxActions.$9(null,[$v_1],null,530,220,false,0);Mscrm.MailboxActions.$W()};Mscrm.MailboxActions.ApplyDefaultsFromGrid=function(gridControl,records,allRecords){Mscrm.MailboxActions.$9(gridControl,records,allRecords,530,300,true,0)};Mscrm.MailboxActions.$9=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_applymailboxsettings.aspx");$v_0.get_query()["showrecordselection"]=$p5;$v_0.get_query()["recordobjecttypecode"]=$p1[0].TypeCode;$v_0.get_query()["dialogmode"]=$p6;var $v_1={};$v_1["gridcontrol"]=$p0;$v_1["selectedrecords"]=$p1;$v_1["allrecords"]=$p2;openStdDlg($v_0,$v_1,$p3,$p4,false,$p5,"maximize:no;minimize:no")};Mscrm.MailboxActions.ApproveEmailFromGrid=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"approve_emailaddress",null)};Mscrm.MailboxActions.RejectEmailFromGrid=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"reject_emailaddress",null)};Mscrm.QueueItem=function(){};Mscrm.QueueItem.queueManipulation=function(gridControl,records,entityTypeCode,queueAction){for(var $v_0=gridControl,$v_1=$v_0.GetRecordsFromInnerGrid(true),$v_3=0;$v_3<records.length;$v_3++){var $v_4=$v_1[$v_3],$v_5=$v_4[3],$v_6=$v_5.getAttribute("queueitemid");records[$v_3].Id=$v_6;records[$v_3].TypeCode=Mscrm.EntityTypeCode.QueueItem}var $v_2=Mscrm.GridRibbonActions.$0(queueAction,entityTypeCode,records.length);if(queueAction==="queueitemrouting"||queueAction==="queueitempick"){if(queueAction==="queueitemrouting"){if(records.length===1)$v_2.get_query()["objectId"]=records[0].Id;$v_2.get_query()["queueid"]=gridControl.GetParameter("qid")}Mscrm.GridRibbonActions.$1($v_2,gridControl,records,500,250)}else if(queueAction==="queueitemroute"||queueAction==="queueitemworkon")Mscrm.GridRibbonActions.$1($v_2,gridControl,records,500,350);else Mscrm.GridRibbonActions.$1($v_2,gridControl,records,450,200)};Mscrm.QueueItem.queueItemDetail=function(gridControl,records,entityTypeCode,queueAction){if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(records.length!==1){alert(window.LOCID_CUSTMSG_TOOMANY_REC);return}var $v_0=gridControl,$v_1=$v_0.GetRecordsFromInnerGrid(true),$v_2=$v_1[0],$v_3=$v_2[3],$v_4=$v_3.getAttribute("queueitemid");openItem(entityTypeCode,$v_4.toString(),0,null)};Mscrm.QueueItem.hasQueueIdChanged=function(){var $v_0=$get("crmQueueSelector");if(!IsNull($v_0)){var $v_1=$v_0.options[$v_0.selectedIndex],$v_2=$v_1.getAttribute("isdefault");if(!isNullOrEmptyString($v_2)&&Boolean.parse($v_2))return false;else return true}return false};Mscrm.QueueItem.entityQueueItemDetail=function(objectId){var $v_0=new RemoteCommand("QueueItem","GetQueueItemId",null);$v_0.SetParameter("objectId",objectId);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=$v_1.ReturnValue.toString(),$v_3=XUI.Xml.LoadXml($v_2),$v_4=XUI.Xml.SelectNodes($v_3,"/queueitems/queueitem",null);if($v_4.length===1)openItem(Mscrm.EntityTypeCode.QueueItem,XUI.Xml.GetText($v_4[0]),0,null);else if($v_4.length>1)alert(window.RECORD_ADDED_TO_MULTIPLE_QUEUES);else alert(window.RECORD_ADDED_TO_NO_QUEUE)}};Mscrm.QuickCampaign=function(){};Mscrm.QuickCampaign.quickCampaignSelectedItems=function(gridControl,records,entityTypeCode,totalRecordCount){if(!totalRecordCount)totalRecordCount=gridControl.get_totalRecordCount();if(entityTypeCode===Mscrm.EntityTypeCode.List)if(records.length>1)alert(window.LOCID_MINICAMP_TOOMANY_RECORDS);else{var $v_0=new Array(2);$v_0[0]="statecode";$v_0[1]="membertype";$v_0.type="string";var $v_1=new RemoteCommand("MarketingAutomation","RetrieveList",null);$v_1.SetParameter("id",records[0]);$v_1.SetParameter("columns",$v_0);var $v_2=$v_1.Execute();if($v_2.Success){var $v_3=$v_2.ReturnValue,$v_4=XUI.Xml.LoadXml($v_3),$v_5=XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_4,"/list/statecode",null));if($v_5==="Inactive")alert(window.LOCID_MC_CANNOT_RUN_INACTLST);else{var $v_6=parseInt(XUI.Xml.GetText(XUI.Xml.SelectSingleNode($v_4,"/list/membertype",null)));Mscrm.QuickCampaign.runMiniCampaign(gridControl,records,entityTypeCode,totalRecordCount,1,$v_6)}}}else Mscrm.QuickCampaign.runMiniCampaign(gridControl,records,entityTypeCode,totalRecordCount,1,entityTypeCode)};Mscrm.QuickCampaign.quickCampaignCurrentPage=function(gridControl,selectedRecordIds,entityTypeCode){if(!gridControl.get_totalRecordCount())alert(window.LOCID_MINICAMP_NORECORDS_MSG);else Mscrm.QuickCampaign.runMiniCampaign(gridControl,selectedRecordIds,entityTypeCode,gridControl.get_pageRecordCount(),2,entityTypeCode)};Mscrm.QuickCampaign.quickCampaignAllPages=function(gridControl,selectedRecordIds,entityTypeCode){if(!IsNull(gridControl.GetParameter("queryapi"))){alert(window.LOCID_QC_CANNOT_RUN_ASSO);return}if(Mscrm.GridRibbonActions.$R(gridControl.GetParameter("viewid"))){alert(window.LOCID_MINICAMP_CANNOT_RUN);return}if(!gridControl.get_totalRecordCount())alert(window.LOCID_MINICAMP_NORECORDS_MSG);else Mscrm.QuickCampaign.runMiniCampaign(gridControl,selectedRecordIds,entityTypeCode,gridControl.get_totalRecordCount(),3,entityTypeCode)};Mscrm.QuickCampaign.runMiniCampaign=function(gridControl,selectedRecords,entityTypeCode,totalRecordCount,mcOption,createdFromOtc){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=selectedRecords.length;$v_0["ObjectTypeCode"]=entityTypeCode;$v_0["MCOption"]=mcOption;$v_0["CreatedFromOtc"]=createdFromOtc;switch(mcOption){case 1:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_SELECTED;$v_0["Ids"]=selectedRecords;$v_0["GridXml"]="";break;case 2:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_ALLONPAGE;$v_0["Ids"]=selectedRecords;$v_0["GridXml"]="";break;case 3:$v_0["MCOptionTitle"]=window.LOCID_MC_SELECTION_ALL;$v_0["Ids"]="";$v_0["GridXml"]=gridControl.get_gridXml();break;default:catchError("Invalid option value passed to RunMiniCampaign().",window.location.href,0,true);break}var $v_1=Mscrm.CrmUri.create("/MA/MiniCampaign/MiniCampaign.aspx");(new Mscrm.CrmDialog($v_1,$v_0,parseInt(window.LOCID_MC_WINDOW_WIDTH,10),parseInt(window.LOCID_MC_WINDOW_HEIGHT,10),null)).show()};Mscrm.ReportActions=function(){};Mscrm.ReportActions.viewReport=function(gridControl,records){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$F(gridControl,$v_0.Id),$v_2=gridControl.getCellValue("filename",$v_0.Id);Mscrm.ReportUtil.viewReport($v_1,$v_0.Id,$v_2,"run",null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.editReportFilter=function(gridControl,records){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$F(gridControl,$v_0.Id),$v_2=gridControl.getCellValue("filename",$v_0.Id);Mscrm.ReportUtil.viewReport($v_1,$v_0.Id,$v_2,"editfilter",null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.editReport=function(records){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(records.length===1){var $v_0=records[0],$v_1=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.ReportPropertyDialog),$v_2=Mscrm.CrmUri.create("/CRMReports/reportproperty.aspx");$v_2.get_query()["id"]=$v_0.Id;openStdWin($v_2,buildWinName($v_0.Id),$v_1.Width,$v_1.Height,null)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.reportScheduleWizard=function(gridControl,records,entityTypeCode){if(records.length===1){var $v_0=records[0],$v_1=Mscrm.ReportActions.$F(gridControl,$v_0.Id);if($v_1===Mscrm.ReportViewType.viewInSrs){var $v_2=new Xrm.DialogOptions;$v_2.width=700;$v_2.height=550;var $v_3=Mscrm.CrmUri.create("/CRMReports/ReportSchedule/ScheduleWizard.aspx");$v_3.get_query()["id"]=$v_0.Id;var $v_4=[entityTypeCode],$v_5=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.ReportActions.exportResultWizardCallback,$v_4);Xrm.Internal.openDialog($v_3.toString(),$v_2,null,null,$v_5)}else alert(window.LOCID_NON_SRS_FILTERSCHEDULE)}else alert(window.LOCID_CUSTMSG_TOOMANY_REC)};Mscrm.ReportActions.exportResultWizardCallback=function(result,entityTypeCode){result&&Mscrm.Grid.auto(entityTypeCode,null)};Mscrm.ReportActions.$F=function($p0,$p1){return parseInt($p0.getCellValue("reporttypecode",$p1),10)};Mscrm.Goal=function(){};Mscrm.Goal.recalculateGoalAndRefreshGrid=function(gridControl,records){if(confirm(window.LOCID_GOALRECALCULATE_WARNING)){!Mscrm.PageManager.isOutlookProxyPage()&&gridControl.ShowLoadingMessage();Mscrm.Goal.recalculateGoal(records[0].Id,gridControl)}};Mscrm.Goal.recalculateGoalAndRefreshForm=function(recordId){if(confirm(window.LOCID_GOALRECALCULATE_WARNING)){var $v_0=$find("crmForm");$v_0.SubmitCrmForm(66,false,true,false,false)}};Mscrm.Goal.recalculateGoal=function(recordId,gridControl){var $v_0=new RemoteCommand("GoalManagement","RecalculateGoal",null);$v_0.SetParameter("goalId",recordId);if(gridControl)var $v_1=$v_0.Execute(function($p1_0,$p1_1){$p1_0.Success&&gridControl.refresh()});else var $v_2=$v_0.Execute()};Mscrm.Goal.hasFiscalSettingsChanged=function(){if(window.HAS_FISCALSTARTDATE_CHANGED)return true;else return false};Mscrm.Goal.realignFiscalDatesForm=function(recordId){var $v_0=67,$v_1=$find("crmForm");if($v_1.get_isDirty()){alert(window.LOCID_FORM_DIRTY);return}else{var $v_2=Mscrm.CrmUri.create("/SFA/goal/dlg_confirmRealign.aspx"),$v_3=[$v_1,$v_0],$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.Goal.performActionAfterRealignGoal,$v_3),$v_5=new Xrm.DialogOptions;$v_5.height=200;$v_5.width=450;Xrm.Internal.openDialog($v_2.toString(),$v_5,null,null,$v_4)}};Mscrm.Goal.performActionAfterRealignGoal=function(resultValue,crmForm,realignFiscalDates){if(resultValue){var $v_0=Mscrm.FormControlInputBehavior.GetBehavior("fiscalyear"),$v_1=Mscrm.FormControlInputBehavior.GetBehavior("fiscalperiod");Mscrm.PostBackUtil.createHiddenInput("fiscalyear",$v_0.get_dataValue());Mscrm.PostBackUtil.createHiddenInput("fiscalperiod",$v_1.get_dataValue());crmForm.SubmitCrmForm(realignFiscalDates,false,true,false,false)}};Mscrm.Goal.isFiscalPeriodGoal=function(){if(window.IS_FISCALPERIOD_GOAL)return true;else return false};Mscrm.Goal.isRootGoal=function(){if(window.IS_ROOT_GOAL)return true;else return false};Mscrm.Goal.fiscalSettingsAreSame=function(gridControl){var $v_0=true;if(gridControl){var $v_1=gridControl.GetParameter("relName");if($v_1==="goal_parent_goal"&&window.HAS_FISCALSETTING_CHANGED)$v_0=false}return $v_0};Mscrm.Goal.isFormStateNotDisabled=function(){if(window.VAR_IS_FORM_DISABLED==="1")return false;else return true};Mscrm.OpportunityActions=function(){};Mscrm.OpportunityActions.closeLegacy=function(selectedOpportunities,won,gridControl){Mscrm.GridCommandActions.opportunityClose(selectedOpportunities,won)};Mscrm.OpportunityActions.close=function(selectedOpportunities,won,gridControl){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile){Mscrm.GridCommandActions.opportunityClose(selectedOpportunities,won);return}typeof Mscrm.OpportunityActions!=="undefined"&&Mscrm.OpportunityActions.closeLegacy(selectedOpportunities,won,gridControl)};Mscrm.RollupField=function(){};Mscrm.RollupField.isTotalLessThanThree=function(gridControl){if(!IsNull(gridControl))if(gridControl.get_totalRecordCount()<3)return true;else return false;return true};Mscrm.SalesLiterature=function(){};Mscrm.SalesLiterature.sendAsEmail=function(id){var $v_0=new RemoteCommand("ActivitiesWebService","CreateEmailFromSalesLiterature",null);$v_0.SetParameter("salesLiteratureId",id);var $v_1=$v_0.Execute(null);if($v_1.Success){var $v_2=$v_1.ReturnValue;if(!IsNull($v_2)&&$v_2.length>0)openObj(Mscrm.EntityTypeCode.Email,$v_2,"");else alert(window.LOCID_SALESLIT_NO_DOCUMENTS)}};Mscrm.SystemUserActions=function(){};Mscrm.SystemUserActions.newMultipleUsers=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=new Xrm.DialogOptions;$v_0.width=800;$v_0.height=530;var $v_1=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx");$v_1.get_query()["WizardId"]="2631659F-A668-4A48-833B-D20E187B5A89";var $v_2=Mscrm.SystemUserActions.refreshSystemUserGrid;Xrm.Internal.openDialog($v_1.toString(),$v_0,null,null,$v_2)};Mscrm.SystemUserActions.refreshSystemUserGrid=function(result){result&&Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)};Mscrm.SystemUserActions.newUser=function(){locAddRelatedToNonForm(Mscrm.EntityTypeCode.SystemUser,Mscrm.EntityTypeCode.BusinessUnit,_gCurrentBusinessUnitId,"")};Mscrm.SystemUserActions.promoteToAdmin=function(records){if(records.length===1){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_promotetoadmin.aspx");$v_0.get_query()["userid"]=records[0];var $v_1=openStdDlg($v_0,records,300,200);!IsNull($v_1)&&Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)}else alert(LOCID_PROMOTETOADMIN_MULTIPLE)};Mscrm.SystemUserActions.manageRoles=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("role",entityTypeCode,records.length),$v_1=500,$v_2=330;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.sendInviteForLive=function(records){var $v_0=450,$v_1=270,$v_2;if(records.length===1){$v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_sendinvite.aspx");$v_2.get_query()["userid"]=records[0].Id;$v_2.get_query()["isform"]=false;var $v_3=[records[0].Id.toString()],$v_4=new Xrm.DialogOptions;$v_4.height=$v_1;$v_4.width=$v_0;var $v_5=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.SystemUserActions.performActionAfterSendInviteForLive,$v_3);Xrm.Internal.openDialog($v_2.toString(),$v_4,records,null,$v_5)}else{$v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_sendmultipleinvite.aspx");for(var $v_6=new Sys.StringBuilder,$v_8=0;$v_8<records.length;$v_8++){var $v_9=records[$v_8];!$v_6.isEmpty()&&$v_6.append(",");$v_6.append($v_9.Id)}$v_2.get_query()["sIds"]=$v_6;var $v_7=new Mscrm.CrmDialog($v_2,records,$v_0,$v_1,null);$v_7.setCallbackInfo("performActionAfterSendInviteForLive",Mscrm.SystemUserActions,null);$v_7.show()}};Mscrm.SystemUserActions.performActionAfterSendInviteForLive=function(returnInfo,userId){!IsNull(returnInfo)&&returnInfo&&Xrm.Internal.messages.inviteUser(userId).then(function(){Mscrm.Grid.auto(Mscrm.EntityTypeCode.SystemUser,null)},function($p1_0){var $v_0=$p1_0.get_organizationServiceFault();if(!IsNull($v_0)){var $v_1=$v_0.get_errorCode();Xrm.Internal.openErrorDialog($v_1,$p1_0.get_message())}})};Mscrm.SystemUserActions.changeBusinessUnit=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("changeorg",entityTypeCode,records.length),$v_1=420,$v_2=325;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.changeManager=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("changeparent",entityTypeCode,records.length),$v_1=400,$v_2=225;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.SystemUserActions.isCurrentUser=function(userId){if(!IsNull(userId)){userId=userId.toLowerCase();if(userId.charAt(0)==="{")userId=userId.substr(1);if(userId.charAt(userId.length-1)==="}")userId=userId.substr(0,userId.length-1);if(typeof _gCurrentUserId=="undefined")return false;return userId===_gCurrentUserId}return false};Mscrm.SystemUserActions.isInviteUserEnabled=function(){return _bIsInviteUserEnabled};Mscrm.SystemUserActions.isSystemAdministrator=function(){if(typeof _bIsSystemAdministrator=="undefined")return false;return _bIsSystemAdministrator};Mscrm.SystemUserActions.setDevErrorsQuery=function(commandProperties){commandProperties["On"]=_bIsShowDevErrorsEnabled};Mscrm.SystemUserActions.addExistingMemberFromSubGridStandard=function(gridControl){confirm(LOCID_CONFIRM_REMOVAL_FROM_TERR)&&Mscrm.GridRibbonActions.addExistingFromSubGridStandard(Mscrm.EntityTypeCode.SystemUser,gridControl)};Mscrm.SystemUserActions.removeMembers=function(objectId,gridControl,records){var $v_0=Mscrm.GridRibbonActions.$0("removeusers",9003,records.length);$v_0.get_query()["teamid"]=objectId;var $v_1=460,$v_2=225;Mscrm.GridRibbonActions.$1($v_0,gridControl,records,$v_1,$v_2)};Mscrm.EntitlementActions=function(){};Mscrm.EntitlementActions.renewEntitlement=function(entitlementId){var $v_0=new RemoteCommand("CustomerService","RenewEntitlement");$v_0.SetParameter("entitlementId",entitlementId);$v_0.SetParameter("newStatus",Mscrm.EntitlementActions.$Y);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=Mscrm.Utilities.tryParseGuid($v_1.ReturnValue.toString());if(!isNullOrEmptyString($v_2)){openObj(Mscrm.EntityTypeCode.Entitlement,$v_2);Mscrm.Utilities.refreshParentGrid(Mscrm.EntityTypeCode.Entitlement,$v_2)}}};Mscrm.EntitlementActions.Cancel=function(gridControl,selectedRecords){if(!selectedRecords)return;var $v_0=window.LOCID_ENTITLEMENT_CANCEL_TH_LT;if(selectedRecords.length>$v_0){alert(String.format(window.LOCID_ENTITLEMENT_CANCEL_TH_MSG,$v_0.toString()));return}for(var $v_1=new Array(selectedRecords.length),$v_4=0;$v_4<selectedRecords.length;$v_4++)$v_1[$v_4]=selectedRecords[$v_4].Id;var $v_2=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/_grid/cmds/dlg_cancel.aspx?iId="+$v_1.toString()+"&iTotal="+selectedRecords.length+"&iObjType=9700"),$v_1,520,230,null),$v_3=$v_2.show();$v_3&&$v_3&&gridControl&&gridControl.refresh()};Mscrm.EntitlementActions.GetSelectedMatrix=function(gridControl){for(var $v_0=gridControl.GetRecordsFromInnerGrid(true),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=new Array(3);$v_2[0]=$v_0[$v_1][0];var $v_3=$v_0[$v_1][3];$v_2[1]=$v_3.getAttribute("attribute");$v_2[2]=$v_3.getAttribute("entity");$v_0[$v_1]=$v_2}return $v_0};Mscrm.EntitlementActions.PerformActionAfterCancelEntitlement=function(returnValue,gridControl){if(returnValue)gridControl&&gridControl.refresh()};Mscrm.GridRibbonActions=function(){};Mscrm.GridRibbonActions.deleteRecords=function(gridControl,records,entityTypeCode){if(Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp()){Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode);return null}switch(entityTypeCode){case Mscrm.EntityTypeCode.QuoteDetail:case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.UserQuery:if(typeof Mscrm.Grid!=="undefined")return Mscrm.Grid.deleteRecords(gridControl,records,entityTypeCode);return null;default:if(typeof Mscrm.GridCommandActions!=="undefined")Mscrm.GridCommandActions.deleteRecords(gridControl,records,entityTypeCode);else if(typeof Mscrm.Grid!=="undefined")return Mscrm.Grid.deleteRecords(gridControl,records,entityTypeCode);return null}};Mscrm.GridRibbonActions.canMarkComplete=function(records){return Mscrm.GridCommandActions.canMarkComplete(records)};Mscrm.GridRibbonActions.gridDisassociate=function(typeCode,gridControl,firstSelectedItemId){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile){Mscrm.CommandBarActions.disassociate(gridControl,null);return}Mscrm.GridRibbonActions.gridDisassociateLegacy(typeCode,gridControl,firstSelectedItemId)};Mscrm.GridRibbonActions.isBulkSaveAsCancelledValid=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.outlook&&Xrm.Page.context.client.getClientState()==="Offline")return false;return Mscrm.GridCommandActions.isBulkSaveAsCancelledValid(entityTypeCode)};Mscrm.GridRibbonActions.isBulkSaveAsCompletedValid=function(entityTypeCode){return Mscrm.GridCommandActions.isBulkSaveAsCompletedValid(entityTypeCode)};Mscrm.GridRibbonActions.addNewFromSubGridStandard=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){if(!Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp())Mscrm.GridRibbonActions.addNewFromSubGridStandardLegacy(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl);else Mscrm.GridCommandActions.addNewFromSubGrid(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl)};Mscrm.GridRibbonActions.addToQueue=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.addToQueue(gridControl,records,entityTypeCode)};Mscrm.GridRibbonActions.assignSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){Mscrm.GridCommandActions.assignSelectedRecords(gridControl,selectedRecords,entityTypeCode)};Mscrm.GridRibbonActions.setRegarding=function(gridControl,records,entityTypeCode){Mscrm.GridCommandActions.setRegarding(gridControl,records,entityTypeCode)};Mscrm.GridRibbonActions.activate=function(gridControl,records,entityTypeCode,callback){Mscrm.GridCommandActions.activate(gridControl,records,entityTypeCode,callback)};Mscrm.GridRibbonActions.deactivate=function(gridControl,records,entityTypeCode,defaultCloseState,callback){Mscrm.GridCommandActions.deactivate(gridControl,records,entityTypeCode,defaultCloseState,callback)};Mscrm.GridRibbonActions.notOnMarketingListOrListUnlocked=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListUnLocked()};Mscrm.GridRibbonActions.notOnMarketingListOrListActive=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListActive()};Mscrm.GridRibbonActions.addActivityFromGrid=function(activityType,contentId,entityReference){Mscrm.AddActivity.addActivityToSelectedObject(activityType,contentId,entityReference[0])};Mscrm.GridRibbonActions.shareSelectedRecords=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("share",entityTypeCode,selectedRecords.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,885,500)};Mscrm.GridRibbonActions.openInstallSPGridLink=function(){var $v_0="http://go.microsoft.com/fwlink/?LinkId=390020";safeWindowOpen(Mscrm.CrmUri.create($v_0),"SPInstallGrid","location=1, width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.GridRibbonActions.changeSharePointDocumentLocation=function(gridControl,documentLocationId){if(!IsNull(gridControl)){gridControl.SetParameter("locationId",documentLocationId);gridControl.refresh()}};Mscrm.GridRibbonActions.changeDocumentLocationState=function(commandProperties,gridControl,locationId,sequence){if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("locationId");if(!IsNull($v_0))commandProperties["On"]=$v_0===locationId;else commandProperties["On"]=!sequence}};Mscrm.GridRibbonActions.validateSharePointSites=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_sharepoint_validate.aspx");if(Sys.Browser.agent===Sys.Browser.Firefox){for(var $v_1=new Array(0),$v_5=0;$v_5<selectedRecords.length;$v_5++)$v_1[$v_5]=selectedRecords[$v_5].Id;var $v_2=[gridControl],$v_3=Mscrm.Utilities.createCallbackFunctionObject("validateSharePointSitesCallback",Mscrm.GridRibbonActions,$v_2,false),$v_4=new Mscrm.CrmDialog($v_0,$v_1,800,580,null);$v_4.setCallbackReference($v_3);$v_4.show()}Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,800,580,null,true)};Mscrm.GridRibbonActions.validateSharePointSitesCallback=function(result,gridControl){!IsNull(gridControl)&&gridControl.refresh()};Mscrm.GridRibbonActions.bulkEdit=function(gridControl,records,entityTypeCode){if(records.length===1){var $v_0=getParentEntityIdParams();if(IsNull($v_0)||!$v_0.length)$v_0="rof=false";else $v_0+="&rof=false";if(!IsNull(gridControl)){var $v_2=gridControl;if(!IsNull($v_2))try{$v_2.get_innerGrid().openSelectedRecord($v_0);return}catch($$e_5){}}var $v_1=records[0];openObj($v_1.TypeCode,$v_1.Id,$v_0)}else{var $v_3;if(entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer){for(var $v_4=records[0],$v_5=1;$v_5<records.length;$v_5++)if(records[$v_5].TypeCode!==$v_4.TypeCode){alert(window.LOCID_HETROGENEOUS_ACTIVITY);return}$v_3=Mscrm.GridRibbonActions.$0("bulkedit",$v_4.TypeCode,records.length)}else $v_3=Mscrm.GridRibbonActions.$0("bulkedit",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_3,gridControl,records,1e3,700)}};Mscrm.GridRibbonActions.addNotes=function(gridControl,records,entityTypeCode){var $v_0=530,$v_1=500,$v_2=Mscrm.GridRibbonActions.$0("addnotes",entityTypeCode,records.length);$v_2.get_query()["sSubTypes"]=Mscrm.GridRibbonActions.$l(records);Mscrm.GridRibbonActions.$1($v_2,gridControl,records,$v_0,$v_1)};Mscrm.GridRibbonActions.cancelContractDetail=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("cancel",entityTypeCode,records.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,records,610,200)};Mscrm.GridRibbonActions.isBulkAddNotesValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode))switch(entityTypeCode){case Mscrm.EntityTypeCode.Email:case Mscrm.EntityTypeCode.SocialActivity:return false;default:return true}else return false};Mscrm.GridRibbonActions.isBulkEditValid=function(entityTypeCode){if(Mscrm.EntityPropUtil.isActivityTypeCode(entityTypeCode)){if(isRichClient()&&entityTypeCode===Mscrm.EntityTypeCode.ActivityPointer)entityTypeCode=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));switch(entityTypeCode){case Mscrm.EntityTypeCode.RecurringAppointmentMaster:return false;default:return true}}else return false};Mscrm.GridRibbonActions.isValidForExportDataTemplate=function(entityTypeCode){return Mscrm.EntityPropUtil.isImportableTypeCode(entityTypeCode)};Mscrm.GridRibbonActions.changeFormStateRecords=function(gridControl,records,entityTypeCode,formRenderState){return Mscrm.Grid.changeFormStateRecords(gridControl,records,entityTypeCode,formRenderState)};Mscrm.GridRibbonActions.associateChildCase=function(gridControl,records,entityTypeCode){if(!records)return;var $v_0=Mscrm.GridRibbonActions.$0("mergemultiple",entityTypeCode,records.length);if(records.length<2){alert(window.LOCID_ASSCO_LESS_RECORDS);return}var $v_1=window.MAX_CHILD_INCIDENT_NUMBER;if(records.length>$v_1){alert(String.format(window.LOCID_ASSCO_TOOMANY_RECORDS,$v_1.toString()));return}$v_0.get_query()["requestType"]="associatechild";var $v_2=[false,gridControl,"associatechild",entityTypeCode],$v_3=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.GridRibbonActions.showMessageAfterMergeAssocAndRefreshGrid,$v_2);Mscrm.GridRibbonActions.$1($v_0,gridControl,records,800,570,$v_3)};Mscrm.GridRibbonActions.setAsDefault=function(gridControl,records,entityTypeCode){var $v_0=records[0].Id,$v_1=new RemoteCommand("CustomerService","IsSlaActive");$v_1.SetParameter("slaId",$v_0);var $v_2=$v_1.Execute();if($v_2.ReturnValue){var $v_3=new RemoteCommand("CustomerService","UpdateSlaIfNoDefaultSlaExists");$v_3.SetParameter("slaId",$v_0);var $v_4=$v_3.Execute(),$v_5=$v_4.ReturnValue;if(!IsNull($v_5)&&IsNull($v_5.length))gridControl.refresh();else if($v_5.toUpperCase()===$v_0.replace("{","").replace("}","").toUpperCase())alert(window.LOCID_SLADEFAULTED_MSG);else{var $v_6=Mscrm.GridRibbonActions.$0("defaultsla_confirm",entityTypeCode,records.length),$v_7=[false,gridControl],$v_8=Mscrm.Utilities.createCallbackFunctionObject("refreshGridAfterMerge",Mscrm.GridRibbonActions,$v_7);Mscrm.GridRibbonActions.$1($v_6,gridControl,records,600,200,$v_8)}}else alert(window.LOCID_SLADEFAULT_INACTIVE_MSG)};Mscrm.GridRibbonActions.syncDefaultQueueMembers=function(records){var $v_0=records[0].Id,$v_1=new RemoteCommand("CustomerService","UpdateQueueMembers");$v_1.SetParameter("queueId",$v_0);var $v_2=$v_1.Execute();if($v_2.ReturnValue)alert("Members of the Team synced with Queue Members");else alert("Sync is valid for Default Queues only or There are no members for the Team to sync with Queue")};Mscrm.GridRibbonActions.mergeRecords=function(gridControl,records,entityTypeCode){if(!records)return;var $v_0=2,$v_1;switch(entityTypeCode){case Mscrm.EntityTypeCode.Incident:if(records.length<2){alert(window.LOCID_MERGE_LESS_RECORDS);return}$v_1=Mscrm.GridRibbonActions.$0("mergemultiple",entityTypeCode,records.length);$v_0=window.MAX_INCIDENT_MERGE_NUMBER;$v_1.get_query()["requestType"]="merge";if(records.length>$v_0){alert(String.format(window.LOCID_MERGE_CASE_TOOMANY_RECORDS,$v_0.toString()));return}break;default:$v_1=Mscrm.GridRibbonActions.$0("merge",entityTypeCode,records.length);if(records.length>$v_0){alert(window.LOCID_MERGE_TOOMANY_RECORDS);return}break}for(var $v_2=new Sys.StringBuilder,$v_6=0;$v_6<records.length;$v_6++){$v_6>0&&$v_2.append(";");$v_2.append(records[$v_6].Id)}$v_1.get_query()["sIds"]=$v_2.toString();var $v_3,$v_4;if(entityTypeCode===Mscrm.EntityTypeCode.Incident){$v_3=[false,gridControl,"merge",entityTypeCode];$v_4=Mscrm.GridRibbonActions.showMessageAfterMergeAssocAndRefreshGrid}else{$v_3=[false,gridControl];$v_4=Mscrm.GridRibbonActions.refreshGridAfterMerge}var $v_5=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory($v_4,$v_3);Mscrm.GridRibbonActions.$1($v_1,gridControl,records,800,570,$v_5)};Mscrm.GridRibbonActions.showMessageAfterMergeAssocAndRefreshGrid=function(result,forceRefresh,gridControl,requestType){if(result||forceRefresh){Mscrm.GridRibbonActions.refreshGridAfterMerge(result,false,gridControl);var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_incidentmessages.aspx");$v_0.get_query()["requestType"]=requestType;$v_0.get_query()["messageContent"]=result.toString();var $v_1=new Mscrm.CrmDialog($v_0,null,450,200,null);$v_1.show()}};Mscrm.GridRibbonActions.refreshGridAfterMerge=function(result,forceRefresh,gridControl){(result||forceRefresh)&&gridControl.refresh()};Mscrm.GridRibbonActions.recalculateFromGrid=function(gridControl,selectedRecords,entityTypeCode){var $v_0=null,$v_1=Mscrm.GridRibbonActions.$0("recalc_opps",entityTypeCode,selectedRecords.length);if(selectedRecords&&selectedRecords.length>=1){for(var $v_2=new Sys.StringBuilder,$v_4=0;$v_4<selectedRecords.length;$v_4++){$v_4>0&&$v_2.append(";");$v_2.append(selectedRecords[$v_4].Id)}var $v_3=[];$v_3[0]=$v_2;$v_0=$v_3}Mscrm.GridRibbonActions.$1($v_1,gridControl,selectedRecords,400,250,null,true,$v_0)};Mscrm.GridRibbonActions.detectDuplicatesAllRecords=function(gridControl,entityTypeCode,totalRecordCount){if(!IsNull(gridControl.GetParameter("queryapi"))){alert(window.LOCID_DEDUPE_CANNOT_RUN_ASSO);return}if(Mscrm.GridRibbonActions.$R(gridControl.GetParameter("viewid"))){alert(window.LOCID_DEDUPE_CANNOT_RUN);return}if(!totalRecordCount){alert(window.LOCID_DEDUPE_NORECORDS_MSG);return}var $v_0=new Mscrm.DetectDuplicateArguments;$v_0.ObjectTypeCode=entityTypeCode;$v_0.iOption=2;$v_0.GridXml=gridControl.get_gridXml();$v_0.Ids="";$v_0.ViewName=gridControl.get_viewTitle();Mscrm.GridRibbonActions.$M($v_0)};Mscrm.GridRibbonActions.detectDuplicatesSelectedRecords=function(entityTypeCode,recordIds){var $v_0=new Mscrm.DetectDuplicateArguments;$v_0.ObjectTypeCode=entityTypeCode;$v_0.iOption=1;$v_0.GridXml="";$v_0.Ids=recordIds;$v_0.ViewName="";Mscrm.GridRibbonActions.$M($v_0)};Mscrm.GridRibbonActions.bulkDelete=function(gridControl){var $v_0=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=A50E9478-8EC9-45ab-B927-FDFFF64A0729");if(!IsNull(gridControl)){var $v_3=gridControl.GetParameter("otc"),$v_4="";if(!isNullOrEmptyString($v_3)){$v_4=$v_3;var $v_5=gridControl.GetParameter("viewid"),$v_6=gridControl.GetParameter("viewtype");if(!isNullOrEmptyString($v_5)&&!isNullOrEmptyString($v_6))$v_4=$v_4+","+$v_6+","+$v_5;$v_0.get_query()["WizardInput"]=$v_4}}var $v_1=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.BulkDeleteWizardDialog),$v_2=new Xrm.DialogOptions;$v_2.width=$v_1.Width;$v_2.height=$v_1.Height;Xrm.Internal.openDialog($v_0.toString(),$v_2,null,null,null)};Mscrm.GridRibbonActions.addToList=function(gridControl,records,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("addtolist",entityTypeCode,records.length),$v_1=Mscrm.CrmUri.create(window.location.search);if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}for(var $v_2=true,$v_5=0;$v_5<records.length&&$v_2;$v_5++)if(records[$v_5].TypeCode!==records[0].TypeCode)$v_2=false;if(!$v_2){alert(window.LOCID_HETEROGENOUS_TYPES);return}var $v_3=$v_1.get_query()["listId"]||"",$v_4="";if($v_1.get_query()["invoker"]!=="listmembers"){var $v_6=[$v_0,gridControl,records],$v_7=Mscrm.Utilities.createCallbackFunctionObject("setPropertiesAndMakeCall",Mscrm.GridRibbonActions,$v_6,false);LookupObjectsWithCallback($v_7,null,"single","4300",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString())+"&listType="+CrmEncodeDecode.CrmUrlEncode("static"),1,1,false,"","","","577EA96E-B1F6-499b-98A7-ABB5BE8233F9",null,null,null,null,null,null,null,null,null);return}Mscrm.GridRibbonActions.$U($v_3,$v_4,$v_0,gridControl,records)};Mscrm.GridRibbonActions.setPropertiesAndMakeCall=function(lookupItems,actionUri,gridControl,records){var $v_0,$v_1;if(!IsNull(lookupItems)&&lookupItems.items.length>0){$v_0=lookupItems.items[0].id;$v_1=lookupItems.items[0].type;Mscrm.GridRibbonActions.$U($v_0,$v_1,actionUri,gridControl,records)}};Mscrm.GridRibbonActions.$U=function($p0,$p1,$p2,$p3,$p4){$p2.get_query()["itemObjectId"]=$p0;$p2.get_query()["itemObjectTypeCode"]=$p1;Mscrm.GridRibbonActions.$1($p2,$p3,$p4)};Mscrm.GridRibbonActions.addConnection=function(records,connectToMe){if(records.length!==1){alert(window.LOCID_CUSTMSG_TOOMANY_REC);return}var $v_0=records[0],$v_1="?pId="+CrmEncodeDecode.CrmUrlEncode($v_0.Id)+"&pType="+CrmEncodeDecode.CrmUrlEncode($v_0.TypeCode.toString());if(connectToMe)$v_1=$v_1+"&connectToMe=true";openObj(Mscrm.EntityTypeCode.Connection,"",$v_1)};Mscrm.GridRibbonActions.sendCurrentViewUrl=function(useEmail,gridControl){var $v_0=gridControl.get_viewTitle();if(IsNull($v_0)||$v_0===window.LOCID_SEARCH_RESULTS||gridControl.get_viewIsUserOwned()||Mscrm.GridRibbonActions.$r(gridControl.GetParameter("viewid"))){alert(window.LOCID_ERROR_INVALID_VIEW);return}var $v_1=Mscrm.Shortcuts.getViewUrl();if(isOutlookHostedWindow()){var $v_2=$v_1.get_query()["extraqs"];if($v_2&&$v_2.length>0){for(var $v_3="ver=",$v_4=null,$v_5=($v_2.startsWith("?")?$v_2.substr(1):$v_2).split("&"),$v_6=0;$v_6<$v_5.length;++$v_6)if($v_5[$v_6].startsWith($v_3)){$v_4=$v_5[$v_6];break}if($v_4)if($v_5.length===1)delete $v_1.get_query().extraqs;else $v_1.get_query()["extraqs"]=$v_2.replace($v_4,"")}}Mscrm.GridRibbonActions.$a(gridControl,$v_1);Mscrm.Utilities.sendViewUrl(useEmail,$v_1,$v_0,gridControl.GetParameter("viewid"),gridControl.GetParameter("viewtype"))};Mscrm.GridRibbonActions.$a=function($p0,$p1){var $v_0=$p0.GetParameter("otc");if(!IsNull($v_0)&&Mscrm.EntityPropUtil.isActivityTypeCode(parseInt($v_0,10))){var $v_1=$p0.GetParameter("otn");if(!IsNull($v_1))$p1.get_query()["type"]=$v_1}};Mscrm.GridRibbonActions.sendBulkEmail=function(gridControl,recordIds,entityTypeCode,totalRecordCount){if(recordIds.length>0){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=recordIds.length;$v_0["Ids"]=recordIds;$v_0["GridXml"]=gridControl.get_gridXml();var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_bulkemail.aspx");$v_1.get_query()["bulkemail"]="true";$v_1.get_query()["multiPage"]="false";$v_1.get_query()["objectTypeCode"]=entityTypeCode;var $v_2=new Mscrm.CrmDialog($v_1,$v_0,600,620,null);$v_2.show()}else alert(window.LOCID_EMAIL_NORECORDS_MSG)};Mscrm.GridRibbonActions.webMailMerge=function(gridControl,recordIds,entityTypeCode,totalRecordCount){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(recordIds.length>0){var $v_0={};$v_0["TotalRecords"]=totalRecordCount;$v_0["SelectedRecords"]=recordIds.length;$v_0["Ids"]=recordIds;$v_0["GridXml"]=gridControl.get_gridXml();var $v_1=Mscrm.CrmUri.create("/_grid/cmds/dlg_webmailmerge.aspx");$v_1.get_query()["objectTypeCode"]=entityTypeCode;var $v_2=new Xrm.DialogOptions;$v_2.height=620;$v_2.width=600;Xrm.Internal.openDialog($v_1.toString(),$v_2,$v_0,null,null)}else alert(window.LOCID_ACTION_NOITEMSELECTED)};Mscrm.GridRibbonActions.$S=function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0=String.format("{0}_gridcontrol_quickcreate",$p3.get_id()),$v_1=$p3.get_element().style.zIndex+990,$v_2=$p3.GetParameter("entitydisplayname"),$v_3=String.format("globalqctimestamps_{0}",$p3.get_id());if(!$p5){var $$t_A=$p3;Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.launchGlobalQuickCreate(new Mscrm.GlobalQuickCreate.GridControlGlobalQuickCreateCallbacks($v_0,$v_1,$$t_A.$$d_refresh||($$t_A.$$d_refresh=Function.createDelegate($$t_A,$$t_A.refresh))),$v_2,$p0,$v_3 in $p4?$p4[$v_3]:null,$p2,$p1)}else{var $$t_B=$p3;Mscrm.GlobalQuickCreate.GlobalQuickCreateBehavior.launchGlobalQuickCreate(new Mscrm.GlobalQuickCreate.GridControlGlobalQuickCreateCallbacks($v_0,$v_1,$$t_B.$$d_refresh||($$t_B.$$d_refresh=Function.createDelegate($$t_B,$$t_B.refresh))),$v_2,$p0,!IsNull($p4)&&$v_3 in $p4?$p4[$v_3]:null)}};Mscrm.GridRibbonActions.$O=function($p0){if(!IsNull($p0)&&$p0.isLiteSubGrid())if($p0.get_gridType()===Mscrm.GridControl.inlineSubGrid){var $v_0=String.format("globalqctimestamps_{0}",$p0.get_id()),$v_1=Mscrm.InlineEditUtilities.getLinkedDataObject($P_CRM($p0.get_element()));if(!IsNull($v_1)&&$v_0 in $v_1)return $v_1}else if($p0.GetParameter("IsQuickCreateEnabled")==="1"){var $v_2={};$v_2["formts"]=$p0.GetParameter("formts");$v_2["mdts"]=$p0.GetParameter("mdts");$v_2["userts"]=$p0.GetParameter("userts");$v_2["businessRulesVersion"]=$p0.GetParameter("businessRulesVersion");return $v_2}return null};Mscrm.GridRibbonActions.openAssociatedGridViewOnLiteGridStandard=function(gridTypeCode,gridControl){Mscrm.Grid.openAssociatedGridViewOnLiteGridStandard(gridTypeCode,gridControl)};Mscrm.GridRibbonActions.addNewFromSubGridStandardLegacy=function(gridTypeCode,parentEntityTypeCode,parentEntityId,primaryControl,gridControl){if(parentEntityTypeCode===Mscrm.EntityTypeCode.Opportunity&&(gridTypeCode===Mscrm.EntityTypeCode.Quote||gridTypeCode===Mscrm.EntityTypeCode.SalesOrder||gridTypeCode===Mscrm.EntityTypeCode.Invoice))Mscrm.GridRibbonActions.$Z(gridTypeCode);else if(gridTypeCode===Mscrm.EntityTypeCode.BulkOperation)CreateMiniCampaign();else if(gridTypeCode===Mscrm.EntityTypeCode.ActivityPointer&&gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid)gridControl.addButtonClickHandler();else if(Mscrm.EntityPropUtil.isActivityTypeCode(gridTypeCode)&&gridTypeCode!==Mscrm.EntityTypeCode.ActivityPointer&&gridTypeCode!==Mscrm.EntityTypeCode.CampaignActivity&&gridTypeCode!==Mscrm.EntityTypeCode.CampaignResponse&&!IsNull(primaryControl)){var $v_0=primaryControl.get_selectedRecords()[0];Mscrm.AddActivity.addActivityToSelectedObject(gridTypeCode,null,$v_0)}else{var $v_1=Mscrm.GridRibbonActions.$O(gridControl),$v_2=!IsNull(gridControl)&&gridControl.isLiteSubGrid();if($v_2&&!IsNull($v_1))Mscrm.GridRibbonActions.$S(gridTypeCode,parentEntityTypeCode,parentEntityId,gridControl,$v_1,false);else{var $v_3=$v_2;switch(gridTypeCode){case Mscrm.EntityTypeCode.KbArticle:gridTypeCode=Mscrm.EntityTypeCode.NewKbArticle;break;case Mscrm.EntityTypeCode.CampaignActivity:$v_3=false;break}locAddRelatedToNonForm(gridTypeCode,parentEntityTypeCode,parentEntityId,"",$v_3)}}};Mscrm.GridRibbonActions.$p=function(){var $v_0=Mscrm.CrmUri.create(window.location.href);if($v_0.get_query()["dashboardType"])return true;return false};Mscrm.GridRibbonActions.OpenQuickCreateFormForNewRecord=function(gridControl){if(Mscrm.GridRibbonActions.$p())return false;var $v_0=Mscrm.GridRibbonActions.$O(gridControl);if(!IsNull($v_0)){Mscrm.GridRibbonActions.$S(gridControl.get_entityTypeCode(),0,null,gridControl,$v_0,true);return true}return false};Mscrm.GridRibbonActions.$Z=function($p0){var $v_0=-1;switch($p0){case Mscrm.EntityTypeCode.SalesOrder:$v_0=21;break;case Mscrm.EntityTypeCode.Quote:$v_0=22;break;case Mscrm.EntityTypeCode.Invoice:$v_0=23;break}var $v_1=window.parent.customAddRelatedItem;if(IsNull($v_1))$v_1=customAddRelatedItem;$v_1($v_0)};Mscrm.GridRibbonActions.addExistingFromSubGridStandard=function(gridTypeCode,gridControl){if(Mscrm.GridRibbonActions.$I(gridTypeCode,gridControl))return;if(gridControl.isLiteSubGrid()&&(gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid||gridControl.get_gridType()===Mscrm.GridControl.associatedGrid))gridControl.addButtonClickHandler();else Mscrm.Grid.addExistingFromSubGridStandard(gridTypeCode,gridControl,0,null)};Mscrm.GridRibbonActions.addExistingFromSubGridAssociated=function(gridTypeCode,gridControl){if(Mscrm.GridRibbonActions.$I(gridTypeCode,gridControl))return;if(gridControl.isLiteSubGrid()&&(gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid||gridControl.get_gridType()===Mscrm.GridControl.associatedGrid))gridControl.addButtonClickHandler();else Mscrm.Grid.addExistingFromSubGridAssociated(gridTypeCode,gridControl,0,null)};Mscrm.GridRibbonActions.$I=function($p0,$p1){var $v_0=$p1.GetParameter("viewid");if(!isNullOrEmptyString($v_0)&&$v_0==="{23FB1036-E41D-4D75-8AA7-27569B5B6512}"){var $v_5=Xrm.Page.data.entity.getEntityName();if($v_5==="incident"){Mscrm.ServiceRefreshUtilities.openCaseResearchFlyOut();return true}return false}var $v_1=$p1.GetParameter("relName");if($v_0==="{58FB20FF-D5BE-406F-908E-C777E9DEDF5F}"||$v_0==="{38A21FFB-4E32-4038-BEB9-03172A0DD034}"||$v_0==="{FC71D030-7A82-4B51-BDE8-29B24B7ABF9D}"||$v_0==="{00000000-0000-0000-00AA-000010001003}"){Mscrm.Grid.checkInParentAndInvoke("locAssocObjMember",$p0,"",$v_1,$p1.GetParameter("roleOrd"),null,0);return true}var $v_2=$p1.GetParameter("roleOrd"),$v_3=Xrm.Page.data.entity.getId(),$v_4=Xrm.Internal.getEntityCode(Xrm.Page.data.entity.getEntityName());switch($v_1){case "List_BulkOperations":locAssocObjList($p0,$v_1,null,0);return true;case "campaignlist_association":if($p0===Mscrm.EntityTypeCode.List){Mscrm.Grid.checkInParentAndInvoke("locAssocObjCampaign",$p0,"subType=targetLists",$v_1,$v_2,null,0);return true}return false;case "campaignactivitylist_association":Mscrm.Grid.checkInParentAndInvoke("locAssocObjCampaignActivity",$p0,"",$v_1,$v_2,$v_3,$v_4);return true}return false};Mscrm.GridRibbonActions.gridDisassociateLegacy=function(typeCode,gridControl,firstSelectedItemId){if(!IsNull(gridControl))if(gridControl.isLiteSubGrid()&&gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid)if(typeCode===Mscrm.EntityTypeCode.Connection)gridControl.DeleteConnectionAndRefresh();else{var $v_0=gridControl.GetParameter("relName"),$v_1=Number.parseInvariant(gridControl.GetParameter("oType")),$v_2=gridControl.GetParameter("oId");if(!IsNull(firstSelectedItemId)&&$v_0==="campaignlist_association"){Mscrm.GridRibbonActions.$h(typeCode,gridControl,firstSelectedItemId,$v_0,$v_1,$v_2);return}gridControl.DisassociateAndRefresh($v_0,$v_1,$v_2,typeCode)}else{var $v_3="associationName={0}&roleOrd={1}",$v_4=gridControl.GetParameter("relName"),$v_5=gridControl.GetParameter("roleOrd"),$v_6=gridControl.get_id();$v_3=String.format($v_3,CrmEncodeDecode.CrmUrlEncode($v_4),CrmEncodeDecode.CrmUrlEncode($v_5));var $v_7=$get("crmFormSubmit");if($v_7)doActionEx($v_6,typeCode,$v_7.crmFormSubmitId.value,"disassociate",$v_7.crmFormSubmitObjectType.value,$v_3);else doActionEx($v_6,typeCode,window.parent.$get("crmFormSubmit").crmFormSubmitId.value,"disassociate",window.parent.$get("crmFormSubmit").crmFormSubmitObjectType.value,$v_3)}};Mscrm.GridRibbonActions.$h=function($p0,$p1,$p2,$p3,$p4,$p5){if($p3!=="campaignlist_association")return;var $v_0=Mscrm.InternalUtilities.GridUtilities.generateStandardActionUri("disassociate",$p0,1);$v_0.get_query()["iParentType"]=$p4;$v_0.get_query()["sParentId"]=$p5;$v_0.get_query()["iId"]=$p2;$v_0.get_query()["associationName"]=$p3;var $v_1=new Xrm.DialogOptions;$v_1.width=400;$v_1.height=200;var $v_2=function(){!(typeof gridControl==="undefined")&&gridControl.Refresh()};Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)};Mscrm.GridRibbonActions.enableWorkflowOnGrid=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("isWorkflowSupported");if($v_0.toUpperCase()==="TRUE")return true}return false};Mscrm.GridRibbonActions.disableForSocialActivityView=function(gridControl){if(!IsNull(gridControl)&&Mscrm.GridRibbonActions.$q(gridControl.GetParameter("viewid")))return true;return false};Mscrm.GridRibbonActions.$q=function($p0){switch($p0){case "{E3CA8AD6-C682-4383-B54E-82641EF83206}":case "{DB576E56-6591-402D-848B-D6F9D626DAA3}":case "{AE2B791C-8210-49D3-BA16-3110AF6864A4}":case "{3354F296-99AF-45EF-8223-88ED59A7F478}":case "{C26EF3A5-0D49-42D3-ABD9-0D75E5F849E3}":case "{9E28442C-413E-4E5B-B3ED-1DCFFE9F43A9}":case "{CE7337DF-90B4-4940-8751-0C7BF8CD50EB}":case "{436918CB-693E-43F1-AE90-48AE3FA21C61}":case "{DF8137B5-B580-4806-8A26-385B83CFB5BF}":return true}return false};Mscrm.GridRibbonActions.launchOnDemandWorkflow=function(gridControl,records,entityTypeCode,workflowId){var $v_0=workflowId,$v_1=new Array(records.length);if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}for(var $v_2=true,$v_3=0;$v_3<records.length&&$v_2;$v_3++){if(records[$v_3].TypeCode!==records[0].TypeCode)$v_2=false;$v_1[$v_3]=records[$v_3].Id}if(!$v_2){alert(window.LOCID_HETEROGENOUS_TYPES);return}if(isNullOrEmptyString(workflowId)){var $v_4=[entityTypeCode,records,$v_1],$v_5=Mscrm.Utilities.createCallbackFunctionObject("setObjectIdAndRunWorkflow",Mscrm.GridRibbonActions,$v_4,false);LookupObjectsWithCallback($v_5,null,"single","4703",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString()),0,1,false,"","","","45102185-B1B4-422B-A3BF-F1BA9C6E130A",null,null,null,null,null,null,null,null,"{45102185-B1B4-422B-A3BF-F1BA9C6E130A}");return}Mscrm.GridRibbonActions.runWorkflow($v_0,entityTypeCode,records,$v_1)};Mscrm.GridRibbonActions.setObjectIdAndRunWorkflow=function(lookupItems,entityTypeCode,records,ids){var $v_0;if(IsNull(lookupItems)||!lookupItems.items.length)return;$v_0=lookupItems.items[0].id;Mscrm.GridRibbonActions.runWorkflow($v_0,entityTypeCode,records,ids);return};Mscrm.GridRibbonActions.runWorkflow=function(itemObjectId,entityTypeCode,records,ids){var $v_0=Mscrm.CrmUri.create("/_grid/cmds/dlg_runworkflow.aspx");$v_0.get_query()["iObjType"]=entityTypeCode;$v_0.get_query()["iTotal"]=records.length;$v_0.get_query()["wfId"]=itemObjectId;var $v_1=new Xrm.DialogOptions;$v_1.height=230;$v_1.width=560;Xrm.Internal.openDialog($v_0.toString(),$v_1,ids,null,null)};Mscrm.GridRibbonActions.runScript=function(records,objectTypeCode){if(IsNull(records)||!records.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(records.length>1){alert(window.LOCID_GRID_TOO_MANY_RECORDS_IWF);return}if(records[0].TypeCode===Mscrm.InternalUtilities.EntityTypeCode.SocialActivity){alert(Mscrm.CommandBarActions.selectResourceString("Grid_Apply_Rule_Social_Activity_Type_Records_Selected_For_Invalid_Action","LOCID_SOCIAL_ACTIVITY_ACTIONERR"));return}var $v_0=[records],$v_1=Mscrm.Utilities.createCallbackFunctionObject("runDialog",Mscrm.GridRibbonActions,$v_0,false);LookupObjectsWithCallback($v_1,null,"single","4703",0,null,"membertypecode="+CrmEncodeDecode.CrmUrlEncode(records[0].TypeCode.toString()),0,0,false,"","","","5DC43D17-D871-4470-B9D7-5B64AC2AF436",null,null,null,null,null,null,null,null,"{5DC43D17-D871-4470-B9D7-5B64AC2AF436}")};Mscrm.GridRibbonActions.runDialog=function(lookupItems,records){if(!IsNull(lookupItems))if(0!==lookupItems.items.length){var $v_0=lookupItems.items[0].id,$v_1=records[0],$v_2=$v_1.Id,$v_3=Mscrm.CrmUri.create("/cs/dialog/rundialog.aspx");$v_3.get_query()["DialogId"]=$v_0;$v_3.get_query()["ObjectId"]=$v_2;$v_3.get_query()["EntityName"]=records[0].TypeName;openStdWin($v_3,buildWinName(null),615,480,null)}};Mscrm.GridRibbonActions.openSelectedRecordInNewWindow=function(selectedRecords){var $v_0=selectedRecords[0],$v_1={};$v_1["etc"]=$v_0.TypeCode;$v_1["id"]=$v_0.Id;$v_1["pagetype"]="entityrecord";$v_1["newWindow"]=true;var $v_2=Mscrm.PageManager.get_instance();if(!IsNull($v_2)){var $v_3=$v_2.get_eventManager();!IsNull($v_3)&&$v_3.raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_1,null)}};Mscrm.GridRibbonActions.exportToExcel=function(gridControl,entityTypeCode){Mscrm.ExportGridToExcel.exportToExcel(gridControl,entityTypeCode)};Mscrm.GridRibbonActions.validQueryApiForXlsx=function(gridControl){if(IsNull(gridControl))return false;var $v_0=gridControl.GetParameter("queryapi");if(isNullOrEmptyString($v_0))return true;switch($v_0){case "CRMIncident.RollupRelatedByObject":case "CRMContract.RollupRelatedByObject":case "CRMQuote.RollupRelatedByObject":case "CRMOpportunity.RollupRelatedByObject":case "CRMSalesOrder.RollupRelatedByObject":case "CRMInvoice.RollupRelatedByObject":case "CRMActivity.RollupRelatedByParty":case "CRMActivity.RollupByParty":case "BizMerchant.RetrieveChildBusinesses":case "BizMerchant.RetrieveTeams":case "BizMerchant.RetrieveUsers":case "BizTeam.RetrieveMembers":case "BizUser.RetrieveTeams":case "BulkOperation.RetrieveResponsesForMiniCampaign":case "Campaign.RetrieveCampaignActivitiesForCampaign":case "Campaign.RetrieveCampaignResponsesForCampaign":case "Campaign.RetrieveRelatedEntities":case "CampaignActivity.RetrieveItems":case "CRMAccount.RetrieveSubAccounts":case "CRMAccount.RetrieveSubContacts":case "CRMActivity.RetrieveByObject":case "CRMActivity.RetrieveByParty":case "CRMCompetitor.RetrieveByObject":case "CRMConnection.RetrieveByObject":case "CRMContact.RetrieveSubContacts":case "CRMContract.RetrieveByObject":case "CRMContractDetail.RetrieveByContract":case "CRMDiscount.RetrieveByObject":case "CRMIncident.RetrieveByObject":case "CRMInvoice.RetrieveByObject":case "CRMInvoice.RetrieveContacts":case "CRMInvoiceDetail.RetrieveByObject":case "CRMKnowledgeBaseRecord.RetrieveByObject":case "CRMOpportunity.RetrieveByObject":case "CRMOpportunityProduct.RetrieveByObject":case "CRMProduct.RetrieveByObject":case "CRMProduct.RetrieveKitProducts":case "CRMProduct.RetrieveSubstitutes":case "CRMProductPriceLevel.RetrieveByObject":case "CRMQuote.RetrieveByObject":case "CRMQuote.RetrieveContacts":case "CRMQuoteDetail.RetrieveByObject":case "CRMSalesLiterature.RetrieveByObject":case "CRMSalesLiteratureItem.RetrieveByObject":case "CRMSalesOrder.RetrieveByObject":case "CRMSalesOrder.RetrieveContacts":case "CRMSalesOrderDetail.RetrieveByObject":case "CRMSalesPerson.RetrieveByTerritory":case "CRMSharePointDocumentLocation.RetrieveSubSharePointDocumentLocations":case "CRMSharePointSites.RetrieveSharePointSubSites":case "CRMTask.RetrieveByObject":case "CustomEntityService.RetrieveByObject":case "CustomEntityService.RetrieveRelatedObjects":case "CustomerOpportunityRole.RetrieveRelated":case "Import.RetrieveImportFailures":case "SecRole.RetrieveTeamRoles":case "SecRole.RetrieveUserRoles":case "SharePointDocument.RetrieveDocument":case "SMResource.RetrieveEquipmentByBusinessUnit":case "SMSite.RetrieveMembers":return true;default:return false}};Mscrm.GridRibbonActions.validDataProviderForXlsx=function(gridControl){if(IsNull(gridControl))return false;var $v_0=gridControl.getProperty("dataProvider");if(isNullOrEmptyString($v_0))return true;switch($v_0){case "Microsoft.Crm.Application.Platform.Grid.GridDataProviderQueryBuilder":case "Microsoft.Crm.Application.Controls.ActivitiesGridDataProvider":case "Microsoft.Crm.Application.Controls.DuplicateRuleGridDataProvider":case "Microsoft.Crm.Application.Controls.BulkDeleteFailureGridDataProvider":case "Microsoft.Crm.Application.Controls.TeamGridDataProvider":case "Microsoft.Crm.Application.Controls.ReportGridDataProvider":case "Microsoft.Crm.Application.Controls.ProductFamilyGridDataProvider":case "Microsoft.Crm.Application.Controls.ProductGridDataProvider":case "Microsoft.Crm.Application.Controls.MetricDetailGridDataProvider":case "Microsoft.Crm.Application.Controls.DynamicPropertyOptionSetItemGridDataProvider":case "Microsoft.Crm.Service.Application.Controls.EntitlementChannelGridDataProvider":case "Microsoft.Crm.Service.Application.Controls.ConvertRuleGridDataProvider":case "Microsoft.Crm.Service.Application.Controls.CasesGridDataProvider":return true;default:return false}};Mscrm.GridRibbonActions.runReport=function(commandProperties,gridControl,recordIds){Mscrm.RunReportFromGrid.runReport(commandProperties,gridControl,recordIds)};Mscrm.GridRibbonActions.runReportFromAppGrid=function(gridControl,recordIds,filterable,reportId,reportType,fileName){Mscrm.RunReportFromGrid.$X(gridControl,recordIds,filterable,reportId,reportType,fileName)};Mscrm.GridRibbonActions.print=function(gridControl){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}Mscrm.PrintFromGrid.print(gridControl)};Mscrm.GridRibbonActions.addCustomerRelationship=function(gridControl,selectedRecords,entityTypeCode){if(IsNull(selectedRecords)||!selectedRecords.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(selectedRecords.length===1)locAddRelatedToNonForm(Mscrm.EntityTypeCode.CustomerRelationship,entityTypeCode,selectedRecords[0].Id,"");else alert(window.LOCID_RELATIONSHIPS_TOO_MANY)};Mscrm.GridRibbonActions.addCustomerOpportunityRole=function(gridControl,selectedRecords,entityTypeCode){if(IsNull(selectedRecords)||!selectedRecords.length){alert(window.LOCID_ACTION_NOITEMSELECTED);return}if(selectedRecords.length===1)locAddRelatedToNonForm(Mscrm.EntityTypeCode.CustomerOpportunityRole,entityTypeCode,selectedRecords[0].Id,"");else alert(window.LOCID_RELATIONSHIPS_TOO_MANY)};Mscrm.GridRibbonActions.reclassify=function(gridControl,selectedRecords,entityTypeCode){var $v_0=Mscrm.GridRibbonActions.$0("reclassify",entityTypeCode,selectedRecords.length);Mscrm.GridRibbonActions.$1($v_0,gridControl,selectedRecords,420)};Mscrm.GridRibbonActions.isContractInvoiced=function(){if(IsNull(window.CONTRACT_INVOICED))return false;else return window.CONTRACT_INVOICED};Mscrm.GridRibbonActions.$0=function($p0,$p1,$p2){return Mscrm.Grid.generateStandardActionUri($p0,$p1,$p2)};Mscrm.GridRibbonActions.$1=function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7){return Mscrm.Grid.executeStandardAction($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7)};Mscrm.GridRibbonActions.$N=function($p0,$p1,$p2,$p3,$p4,$p5){return Mscrm.Grid.executeStandardActionInternal($p0,$p1,$p2,$p3,$p4,$p5)};Mscrm.GridRibbonActions.$M=function($p0){var $v_0=Mscrm.CrmUri.create("/WebWizard/WizardContainer.aspx?WizardId=3E4792DF-42CC-4b6b-B7E6-E197B4986EFF");$v_0=Mscrm.CrmUri.updateCrmUriHostAndScheme($v_0);var $v_1=new Xrm.DialogOptions;$v_1.width=parseInt(window.LOCID_DEDUPE_WINDOW_WIDTH,10);$v_1.height=parseInt(window.LOCID_DEDUPE_WINDOW_HEIGHT,10);Xrm.Internal.openDialog($v_0.toString(),$v_1,$p0,null,null)};Mscrm.GridRibbonActions.$l=function($p0){return Mscrm.Grid.getSubTypesString($p0)};Mscrm.GridRibbonActions.$A=function($p0){for(var $v_0=$p0.children.length-1;$v_0>=0;$v_0--)$p0.removeChild($p0.children[$v_0])};Mscrm.GridRibbonActions.$2=function($p0,$p1,$p2){var $v_0=document.createElement("input");$v_0.type="hidden";$v_0.name=$p1;$v_0.value=$p2;$p0.appendChild($v_0)};Mscrm.GridRibbonActions.$P=function($p0){var $v_0=$p0.GetParameter("isFetchXmlNotFinal");if(!isNullOrEmptyString($v_0))return !Mscrm.Utilities.parseBoolean($v_0);return false};Mscrm.GridRibbonActions.$R=function($p0){switch($p0){case "{C147F1F7-1D78-4D10-85BF-7E03B79F74FA}":case "{CFBCD7AF-AEE5-4E45-8ECC-C040D4020581}":case "{9818766E-7172-4D59-9279-013835C3DECD}":case "{927E6CD8-B3ED-4C20-A154-B8BD8A86D172}":case "{AFE23D8A-6651-474D-B8EE-90210A8231F6}":case "{FE961BBB-E5EA-44BA-AFF3-DB1D8BBBA18B}":return true}return false};Mscrm.GridRibbonActions.$r=function($p0){switch($p0){case "{ED1F0041-4F6B-4171-8757-4AC44C2FCAFA}":case "{8FBA639E-CD73-DF11-805D-00155DB1891A}":case "{A2927069-E4DC-4E8F-8FB1-D2F6C40C427E}":case "{8EF40D37-0868-440C-AF6B-CAC0C62E78E3}":case "{D234426E-1F37-4944-9255-50E19B541C4C}":case "{5E586DB6-222A-4ea3-8BD0-A85EE0FF52C3}":case "{DA5750D5-60A6-4ac7-A58A-A90CD2B1AF0A}":case "{AB582FB0-A846-453e-AD88-77F75CE91264}":case "{974C65FE-C789-48fe-B510-7AE579B9B5C6}":case "{6DFBA3A1-6DF3-4140-831B-B385C7E92B64}":case "{EF3CDB5B-71ED-4e73-92B2-ED6D47156521}":case "{F33B0C61-C5A9-4881-8275-C2DC63626251}":case "{B69375FB-61EF-433e-A4C2-031856F9A9E5}":case "{2EF7FF1D-8CCD-4422-86C4-4A48FE1F4B1D}":case "{634739A8-D8E5-41bb-B7DF-C121BD18E4B4}":case "{8DD58E14-0138-47d4-BA2D-A7DC76094D05}":case "{A596FF84-88FD-4eea-84F6-335B357E176A}":case "{31DAE384-A86F-DF11-986C-00155D2E3002}":case "{0894C803-4B27-DF11-893C-00155D26C21D}":case "{0E24F0D5-C2E1-4B3D-9F43-E9C817C811DF}":case "{01053369-B068-DF11-AE90-00155D2E3002}":case "{9C60DC64-4B27-DF11-893C-00155D26C21D}":case "{61F1B589-3DAF-45E1-96BF-9BF7B12AF252}":case "{2AAE0E9A-29A7-440D-8DD4-6FD37B8A156F}":case "{00000000-0000-0000-00AA-000010001028}":case "{460F1FAD-2673-DF11-986C-00155D2E3002}":case "{2D5E1400-F86D-DF11-986C-00155D2E3002}":case "{00000000-0000-0000-00AA-000010001021}":case "{00000000-0000-0000-00AA-000010001027}":case "{45B0D1D8-8D57-DF11-A5A2-00155D2A9005}":case "{8735625E-5657-DF11-A5A2-00155D2A9005}":return true}return false};Mscrm.RibbonActions=function(){};Mscrm.RibbonActions.isRefreshForm=function(){return Mscrm.CommandBarActions.isRefreshForm()};Mscrm.RibbonActions.notOnMarketingListOrListUnlocked=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListUnLocked()};Mscrm.RibbonActions.notOnMarketingListOrListActive=function(entityTypeCode){if(Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile)return true;if(entityTypeCode!==Mscrm.EntityTypeCode.List)return true;return isListActive()};Mscrm.RibbonActions.alwaysEnabled=function(){return Mscrm.CommandBarActions.alwaysEnabled()};Mscrm.RibbonActions.isAutoSaveEnabled=function(){return Xrm.Page.context.getIsAutoSaveEnabled()};Mscrm.RibbonActions.isBulkSetRegardingValid=function(entityTypeCode,records){return Mscrm.GridCommandActions.isBulkSetRegardingValid(entityTypeCode,records)};Mscrm.RibbonActions.saveForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("");else Mscrm.RibbonActions.saveLegacyForm(form,"Save")};Mscrm.RibbonActions.saveAndCloseForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("saveandclose");else Mscrm.RibbonActions.saveLegacyForm(form,"SaveAndClose")};Mscrm.RibbonActions.saveAndNewForm=function(form){if(Mscrm.RibbonActions.isRefreshForm())Mscrm.CommandBarActions.saveForm("saveandnew");else Mscrm.RibbonActions.saveLegacyForm(form,"SaveAndNew")};Mscrm.RibbonActions.sendFormShortcut=function(usingEmail,form){Mscrm.CommandBarActions.sendFormShortcut(usingEmail,form)};Mscrm.RibbonActions.openNewRecord=function(entityLogicalName,gridControl){if(Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp()){Mscrm.CommandBarActions.openNewRecord(entityLogicalName,null,null);return}if(!IsNull(gridControl)&&gridControl.isLiteSubGrid())if(entityLogicalName===Mscrm.InternalUtilities.EntityNames.ActivityPointer&&gridControl.get_gridType()===Mscrm.GridControl.inlineSubGrid){gridControl.addButtonClickHandler();return}else if(Mscrm.GridRibbonActions.OpenQuickCreateFormForNewRecord(gridControl))return;Xrm.Utility.openEntityForm(entityLogicalName,null,null)};Mscrm.RibbonActions.openObjFromClassic=function(entityTypeCode){Mscrm.RibbonActions.openNewRecord(Xrm.Internal.getEntityName(entityTypeCode),null)};Mscrm.RibbonActions.isEntitlementActive=function(){var $v_0=true;if(!IsNull(Xrm.Page.data)&&!IsNull(Xrm.Page.ui)){var $v_1=Xrm.Page.data.entity.attributes.get("statecode");if(Xrm.Page.data.entity.getEntityName()==="entitlement")if(Xrm.Page.ui.getFormType()===4)$v_0=true;else $v_0=false;else if(Xrm.Page.ui.getFormType()===4&&(!IsNull($v_1)&&$v_1.getText()==="Inactive"))$v_0=false;else $v_0=true}return $v_0};Mscrm.RibbonActions.enableAddCaseForContract=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACT))return window.ADDCASE_ENABLED_FOR_CONTRACT;else return true};Mscrm.RibbonActions.enableAddCaseForContractLine=function(){if(!IsNull(window.ADDCASE_ENABLED_FOR_CONTRACTLINE))return window.ADDCASE_ENABLED_FOR_CONTRACTLINE;else return true};Mscrm.RibbonActions.$6=function($p0,$p1){if(IsNull($p0))return false;try{if(!IsNull($p0[$p1])){$p0[$p1]();return true}else if(Sys.UI.Control.isInstanceOfType($p0)){var $v_0=$get($p0.get_id());$v_0[$p1]();return true}}catch($$e_3){}return false};Mscrm.RibbonActions.$n=function($p0,$p1){if(IsNull($p0))return false;try{$p0[$p1]();return true}catch($$e_2){}return false};Mscrm.RibbonActions.print=function(primaryControl,selectedControl){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.RibbonActions.$6(primaryControl,"Print"))if(!IsNull(selectedControl))Mscrm.RibbonActions.$6(selectedControl,"Print");else{var $v_0=document.getElementsByTagName("iframe");if($v_0&&$v_0.length>0)try{var $v_1=$v_0[0].contentWindow,$v_2=$v_1.Sys.Application.findComponent("crmGrid");if($v_2)$v_2.Print();else alert(window.LOCID_ACTION_UNSUPPORTED_ERROR)}catch($$e_5){alert(window.LOCID_ACTION_UNSUPPORTED_ERROR);return}}};Mscrm.RibbonActions.openAdvancedFind=function(selectedControl,primaryControl,newMode){var $v_0=true;if(IsNull(primaryControl)&&!IsNull(selectedControl)&&!newMode){var $v_1=$find(selectedControl.get_id()+"_filterSet");if(!IsNull($v_1)&&$v_1.isFilterSetDirty())$v_0=confirm(window.LOCID_GF_AFWARNING)}if($v_0)try{if(!IsNull(primaryControl)&&Mscrm.FormControl.isInstanceOfType(primaryControl))primaryControl.openAdvancedFind();else{var $v_2=$find("crmContentPanel");if($v_2&&Mscrm.ContentPanel.isInstanceOfType($v_2))$v_2.get_contentWindow().openAdvFind();else{var $v_3="crmGrid";if(!IsNull(selectedControl))$v_3=selectedControl.get_id();openAdvFind($v_3,newMode)}}}catch($$e_7){var $v_4=Mscrm.CrmUri.create("/main.aspx");$v_4.get_query()["pagetype"]="advancedfind";var $v_5=(new Date).getTime(),$v_6=openStdWin($v_4,"_blank",900,600,null),$v_7=(new Date).getTime();window.setTimeout(function(){Mscrm.RibbonActions.setPerfMarkers($v_6,$v_5,$v_7)},2e3)}};Mscrm.RibbonActions.setPerfMarkers=function(instance,beforeWindowOpenTimestamp,afterWindowOpenTimestamp){if(!Mscrm.SessionInfo.isOutlookClient()){instance.BeforeWindowOpenTimestamp=beforeWindowOpenTimestamp;instance.AfterWindowOpenTimestamp=afterWindowOpenTimestamp}};Mscrm.RibbonActions.exportToExcel=function(gridControl){Mscrm.RibbonActions.$6(gridControl,"ExportToExcel")};Mscrm.RibbonActions.saveLegacyForm=function(form,methodName){if(Mscrm.Utilities.isEdge()||Mscrm.Utilities.isIE10OrHigher())!IsNull(document.activeElement)&&document.activeElement.tagName.toLowerCase()==="input"&&$P_CRM(document.activeElement).blur();if(Mscrm.FormProxyForRibbon.isInstanceOfType(form)){form=form.get_crmFormControl();Mscrm.RibbonActions.$n(form,methodName);return}Mscrm.RibbonActions.$6(form,methodName)};Mscrm.RibbonActions.closeForm=function(form){Mscrm.RibbonActions.$6(form,"CloseRecord")};Mscrm.RibbonActions.addActivityOnForm=function(activityTypeCode){Mscrm.AddActivity.addActivityToForm(activityTypeCode,null)};Mscrm.RibbonActions.addNoteToRecord=function(parentTypeCode,parentId){openObjEx(Mscrm.EntityTypeCode.Annotation,parentTypeCode,parentId)};Mscrm.RibbonActions.addFileToRecord=function(parentTypeCode,parentId){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.Annotation),$v_1=$v_0.Url;$v_1.get_query()["hideDesc"]="1";$v_1.get_query()["pId"]=parentId;$v_1.get_query()["pType"]=parentTypeCode;openStdWin($v_1,buildWinName(),500,175,null)};Mscrm.RibbonActions.openSettings=function(){var $v_0=Mscrm.CrmUri.create("/tools/personalsettings/dialogs/personalsettings.aspx"),$v_1=new Xrm.DialogOptions;$v_1.height=695;$v_1.width=950;var $v_2=Mscrm.RibbonActions.openSettingsCallback;Xrm.Internal.openDialog($v_0.toString(),$v_1,null,null,$v_2)};Mscrm.RibbonActions.openSettingsCallback=function(retValue){retValue&&Mscrm.Utilities.reloadPage()};Mscrm.RibbonActions.close=function(){var $v_0=Mscrm.ScriptEvents.NavigateClose;if(Mscrm.NavigationMode.DefaultNavigationMode===Mscrm.NavigationMode.NavigationModeInline)$v_0=Mscrm.ScriptEvents.NavigateBackCheckpoint;Mscrm.PageManager.get_instance().raiseEvent($v_0,null)};Mscrm.RibbonActions.sendFormShortcutLegacy=function(usingEmail,form){if(!usingEmail&&!Mscrm.Utilities.get_ieBrowserVersion()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0;if(Mscrm.FormProxyForRibbon.isInstanceOfType(form)){form=form.get_crmFormControl();$v_0=form}else if(isInstanceOfTypeAcrossFrames(form,Mscrm.FormControl))$v_0=form;else $v_0=$find("crmForm");var $v_1=null;if(isInstanceOfTypeAcrossFrames($v_0,Mscrm.FormControl))$v_1=$v_0.get_primaryFieldValue();try{Mscrm.FormAction.sendFormShortcut(usingEmail,$v_1)}catch($$e_4){}};Mscrm.RibbonActions.addPrimaryToMarketingList=function(typeCode){doAction(null,typeCode,"addtolist",Xrm.Page.data.entity.getId().toString())};Mscrm.RibbonActions.submitPrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"submit",null)};Mscrm.RibbonActions.approvePrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"approve",null)};Mscrm.RibbonActions.unpublishPrimary=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"unpublish",null)};Mscrm.RibbonActions.articleView=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"articleview",null)};Mscrm.RibbonActions.approveEmail=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"approve_emailaddress",null)};Mscrm.RibbonActions.rejectEmail=function(gridControl,typeCode){doAction(gridControl.get_id(),typeCode,"reject_emailaddress",null)};Mscrm.RibbonActions.openConvertRule=function(sourceTypeCode){var $v_0=null,$v_1=Xrm.Page.data.entity.getId();if($v_1){var $v_2=new RemoteCommand("CustomerService","GetConvertRuleId");$v_2.SetParameter("queueId",$v_1);$v_2.SetParameter("sourceTypeCode",sourceTypeCode);var $v_3=$v_2.Execute();if($v_3.Success)$v_0=$v_3.ReturnValue}if($v_0&&$v_0.length>1)openFrmObj("?id="+$v_0+"&sourcetypecode="+sourceTypeCode,"",Mscrm.EntityTypeCode.ConvertRule,null,Mscrm.NavigationMode.NavigationModeNewWindow,null);else openFrmObj("?sourcetypecode="+sourceTypeCode+"&_CreateFromId="+$v_1+"&_CreateFromType="+Mscrm.EntityTypeCode.Queue,"",Mscrm.EntityTypeCode.ConvertRule,null,Mscrm.NavigationMode.NavigationModeNewWindow,null)};Mscrm.RibbonActions.showVisualization=function(gridControl,toggleVisualization){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if($v_2.isChartEnabled()&&$v_2.isGridEnabled())if(!IsNull($v_2)){$v_2.showVisualization(toggleVisualization);refreshRibbon()}}};Mscrm.RibbonActions.hideVisualization=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if($v_2.isChartEnabled()&&$v_2.isGridEnabled())if(!IsNull($v_2)){$v_2.hideVisualization();refreshRibbon()}}};Mscrm.RibbonActions.applyChartType=function(chartType){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.applyChartType(chartType,false)};Mscrm.RibbonActions.applyTopBottom=function(isTop,count){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.appendTopBottom(count.toString(),isTop,false,true)};Mscrm.RibbonActions.applyTopBottomCustom=function(isTop){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.appendTopBottomCustom(isTop,false)};Mscrm.RibbonActions.clearTopBottom=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.clearTopBottom()};Mscrm.RibbonActions.closeDesigner=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){$v_0.showVisualizationPane();$v_0.exitDesigner()}};Mscrm.RibbonActions.saveVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.saveVisualization()};Mscrm.RibbonActions.saveAndCloseVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.saveAndCloseVisualization()};Mscrm.RibbonActions.copyVisualization=function(){if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.saveChart(true)};Mscrm.RibbonActions.editVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.switchMode(Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode)};Mscrm.RibbonActions.expandVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.expandVisualization()};Mscrm.RibbonActions.createNewVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.switchMode(Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)};Mscrm.RibbonActions.importVisualization=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl"),$v_1;if(!IsNull($v_0))$v_1=true;else $v_1=false;$v_0.importVisualization($v_1)};Mscrm.RibbonActions.exportVisualization=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}if(!Mscrm.PageManager.isFlatUIPage()&&!Mscrm.PageManager.isOutlookProxyPage())return;var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.exportVisualization()};Mscrm.RibbonActions.refreshVisualization=function(domEvent){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)){$v_0.showVisualizationPane(false);$v_0.refreshVisualizationPane(domEvent)}};Mscrm.RibbonActions.changeCompositeControlLayout=function(selectedEntityTypeCode,gridControl,layoutMode){var $v_0=false;if(!Mscrm.PageManager.isFlatUIPage()&&!($v_0=Mscrm.PageManager.isOutlookProxyPage()))return;if(!IsNull(gridControl)){var $v_1=false,$v_2=gridControl.get_id()+"_visualizationCompositeControl",$v_3=$find($v_2);if(layoutMode!==parseInt($v_3.get_compositeLayout(),10))$v_1=true;var $v_4=gridControl.get_id()+"_paneControl",$v_5=$find($v_4);if(!$v_1&&!$v_0){if(IsNull($v_5)||!$v_5.isVisualizationPaneVisible())Mscrm.RibbonActions.showVisualization(gridControl,false);else $v_5.getParameter("paneSize")===Mscrm.VisualizationPaneMode.collapsedSize&&$v_5.showVisualizationPane();return}if(!IsNull($v_5)&&$v_5.isPaneInDesignerMode()&&!$v_5.confirmCloseDesigner())return;var $v_6=Mscrm.Utilities.getContentUrl(null);if(Mscrm.EntityPropUtil.isActivityTypeCode(selectedEntityTypeCode))$v_6.get_query()["type"]=gridControl.GetParameter("otn");var $v_7=layoutMode.toString(),$v_8=$v_3.getVisualizationPaneParameter("CurrentVisualizationId"),$v_9=$v_3.getVisualizationPaneParameter("CurrentVisualizationType"),$v_A=Mscrm.RibbonActions.$m($v_4),$v_B=$v_A===Mscrm.VisualizationPaneMode.none||$v_A===Mscrm.VisualizationPaneMode.collapsedSize?Mscrm.VisualizationPaneMode.defaultSize:$v_A;$v_6.get_query()["layout"]=$v_7;$v_6.get_query()["visualizationId"]=$v_8;$v_6.get_query()["visualizationType"]=$v_9;$v_6.get_query()["visualizationPaneMode"]=$v_B;var $v_C=$v_3.getVisualizationPaneParameter("vizPaneViewId"),$v_D=$v_3.getVisualizationPaneParameter("vizPaneViewType");if(!isNullOrEmptyString($v_D)&&!isNullOrEmptyString($v_C)){delete $v_6.get_query().viewId;delete $v_6.get_query().viewType;$v_6.get_query()["viewid"]=$v_C;$v_6.get_query()["viewtype"]=$v_D}var $v_E={};$v_E["uri"]=$v_6.toString();$v_E["name"]=buildWinName(null);var $v_F=Mscrm.VisualizationActions.createVizParamsDictionary($v_7,$v_8,$v_9,$v_B,$v_3.getVisualizationPaneParameter("vizPanePrimaryEntityName"),$v_3.getVisualizationPaneParameter("IsDashboardComponent"));Mscrm.VisualizationActions.fireEventForStickyVisualization($v_F);if($v_0)if($v_1)getOutlookHostedWindow().changeVisualizationLayout(!layoutMode);else getOutlookHostedWindow().showVisualization(true);Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.NavigateRequest,$v_E)}};Mscrm.RibbonActions.assignVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.assignVisualization()};Mscrm.RibbonActions.shareVisualization=function(){var $v_0=$find("crmGrid_paneControl");!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.shareVisualizations()};Mscrm.RibbonActions.$m=function($p0){var $v_0=$find($p0);if(!IsNull($v_0))if(!isNullOrEmptyString($v_0.getParameter("paneSize"))){var $v_1=$v_0.getParameter("paneSize").toString();if($v_1===Mscrm.VisualizationPaneMode.resizeMode)$v_1=Mscrm.VisualizationPaneMode.defaultSize;return $v_1}return Mscrm.VisualizationPaneMode.none};Mscrm.RibbonActions.showChartLayoutQuery=function(commandProperties,gridControl,layoutMode){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))if($v_1.isVisualizationPaneVisible())commandProperties["On"]=layoutMode===$v_1.getParameter("compositeLayout");else commandProperties["On"]=false}};Mscrm.RibbonActions.showVisualizationQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))commandProperties["On"]=$v_1.isVisualizationPaneOpen();else commandProperties["On"]=false}};Mscrm.RibbonActions.visualizationOffQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))commandProperties["On"]=!$v_1.isVisualizationPaneVisible();else commandProperties["On"]=true}};Mscrm.RibbonActions.deleteVisualization=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);!IsNull($v_1)&&$v_1.deleteVisualization()}};Mscrm.RibbonActions.addRelatedToNonForm=function(relatedTypeCode,primaryTypeCode){locAddRelatedToNonForm(relatedTypeCode,primaryTypeCode,$get("crmFormSubmit").crmFormSubmitId.value,"")};Mscrm.RibbonActions.addRelatedAddress=function(relatedTypeCode){AddRelatedAddress(relatedTypeCode,$get("crmFormSubmit").crmFormSubmitObjectType.value,$get("crmFormSubmit").crmFormSubmitId.value)};Mscrm.RibbonActions.addFormToMarketingList=function(primaryTypeCode){doAction(null,primaryTypeCode,"addtolist",$get("crmFormSubmit").crmFormSubmitId.value)};Mscrm.RibbonActions.openFormProperties=function(id,objectTypeCode){var $v_0=Mscrm.CrmUri.create("/_forms/properties/properties.aspx");$v_0.get_query()["id"]=id;$v_0.get_query()["objTypeCode"]=objectTypeCode;var $v_1=new Mscrm.CrmDialog($v_0,null,420,505,null);$v_1.show()};Mscrm.RibbonActions.openEntitlementTemplate=function(){var $v_0=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/entitlements/lookup_template.aspx"),window,370,370,null);$v_0.show()};Mscrm.RibbonActions.openHelpLegalLink=function(){safeWindowOpen(Mscrm.CrmUri.create(window.CRM_ONLINE_LEGAL_LINK),"MSCRMLegal","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.RibbonActions.openHelpPrivacyLink=function(){safeWindowOpen(Mscrm.CrmUri.create(window.CRM_ONLINE_PRIVACY_LINK),"MSCRMPrivacy","width=790, height=500, menubar=1, toolbar=1, status=1, scrollbars=1, resizable=1",true)};Mscrm.RibbonActions.goTo=function(areaId,groupId,subareaId){try{window.top.goTo(areaId,groupId,subareaId)}catch($$e_3){window.goTo(areaId,groupId,subareaId)}};Mscrm.RibbonActions.runReportFromFormRibbon=function(commandProperties,control){var $v_0=commandProperties["SourceControlId"],$v_1=$v_0.substr($v_0.length-38),$v_2=Mscrm.ReportUtil.get_reportInformation()[$v_1];control.RunReport($v_2.Filterable,$v_1,$v_2.ReportType,$v_2.FileName)};Mscrm.RibbonActions.addConnectionFromForm=function(objectId,objectTypeCode,primaryControl,connectToMe){var $v_0=String.format("pId={0}&pType={1}",CrmEncodeDecode.CrmNameValueEncode(objectId),CrmEncodeDecode.CrmNameValueEncode(objectTypeCode.toString()));if(connectToMe)$v_0=String.format("{0}&connectToMe=true",$v_0);openObj(Mscrm.EntityTypeCode.Connection,"",$v_0,null,Mscrm.NavigationMode.NavigationModeNewWindow,null)};Mscrm.RibbonActions.openEntityEditor=function(selEntityTypeCode,primEntityTypeCode){var $v_0=selEntityTypeCode;if(!$v_0)$v_0=primEntityTypeCode;var $v_1=String.format("def_category={0}&def_type={1}",Mscrm.EntityTypeCode.Entity,$v_0);openObj(Mscrm.EntityTypeCode.Solution,window.DEF_SOL_ID,$v_1)};Mscrm.RibbonActions.designView=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("otc");if(!isNullOrEmptyString($v_0)){var $v_1=Mscrm.FormEditor.getEntityId(parseInt($v_0,10)),$v_2=String.format("entityId={0}",$v_1);openObj(Mscrm.EntityTypeCode.SavedQuery,gridControl.GetParameter("viewid"),$v_2)}else openObj(Mscrm.EntityTypeCode.SavedQuery,gridControl.GetParameter("viewid"))}};Mscrm.RibbonActions.createSystemView=function(selEntityTypeCode){var $v_0=String.format("objectTypeCode={0}",selEntityTypeCode);openObj(Mscrm.EntityTypeCode.SavedQuery,"",$v_0)};Mscrm.RibbonActions.manageViews=function(selEntityTypeCode){var $v_0=String.format("def_category={0}&def_type={1}&def_subcat={2}",Mscrm.EntityTypeCode.Entity,selEntityTypeCode,"view");openObj(Mscrm.EntityTypeCode.Solution,window.DEF_SOL_ID,$v_0)};Mscrm.RibbonActions.refreshGrid=function(gridControl){!IsNull(gridControl)&&gridControl.refresh()};Mscrm.RibbonActions.createPersonalView=function(selectedControl){Mscrm.RibbonActions.openAdvancedFind(selectedControl,null,true)};Mscrm.RibbonActions.neverEnabled=function(){return false};Mscrm.RibbonActions.enableExportToExcel=function(){return true};Mscrm.RibbonActions.enableWorkflowOnForm=function(){if(!IsNull(window.IS_WORKFLOWENABLED_FORM)&&window.IS_WORKFLOWENABLED_FORM)return true;return false};Mscrm.RibbonActions.hasSecuredFields=function(){if(!IsNull(window.HAS_SECURED_FIELDS))return window.HAS_SECURED_FIELDS;return false};Mscrm.RibbonActions.canCustomizeVisualization=function(){if(!IsNull(window.CAN_CUSTOMIZE_VISUALIZATION))return window.CAN_CUSTOMIZE_VISUALIZATION;return false};Mscrm.RibbonActions.gridFiltersToggle=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0)){$v_0.ToggleFilters();refreshRibbon()}}};Mscrm.RibbonActions.gridFiltersQuery=function(commandProperties,gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0))commandProperties["On"]=$v_0.IsFilterEnabled()}};Mscrm.RibbonActions.gridFiltersSaveAsNewView=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");!IsNull($v_0)&&$v_0.Save(true)}};Mscrm.RibbonActions.gridFiltersSaveToCurrentView=function(gridControl){if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");!IsNull($v_0)&&$v_0.Save(false)}};Mscrm.RibbonActions.saveAsDefaultGridView=function(){setDefaultView();Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.DefaultViewChanged,null)};Mscrm.RibbonActions.isSystemQuerySelected=function(gridControl){return !Mscrm.RibbonActions.isUserQuerySelected(gridControl)};Mscrm.RibbonActions.isUserQuerySelected=function(gridControl){if(Mscrm.PageManager.isOutlookProxyPage())return !Mscrm.RibbonActions.isSystemViewLoaded(gridControl);if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_SavedNewQuerySelector",$v_1=$find($v_0);if(!IsNull($v_1)&&$v_1.showNewVSControl&&!$v_1.showOriginalSelectBox){var $v_3=parseInt($v_1.selectedViewType,10);return Mscrm.EntityTypeCode.UserQuery===$v_3}$v_0=gridControl.get_id()+"_SavedQuerySelector";var $v_2=$get($v_0);if(!IsNull($v_2)){var $v_4=$v_2.options[$v_2.selectedIndex],$v_5=$v_4.Type;if(!IsNull($v_5)&&parseInt($v_5,10)===Mscrm.EntityTypeCode.UserQuery)return true}}return false};Mscrm.RibbonActions.isUserQueryVisualizationSelected=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))if($v_0.isVisualizationPaneVisible()){var $v_1=$v_0.getPaneChildElement("visualizationList");if($v_0.get_visualizationType()===Mscrm.EntityTypeCode.UserQueryVisualization)return true}return false};Mscrm.RibbonActions.isDrilldownMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.checkIfDrilldownMode();return false};Mscrm.RibbonActions.isFormDesignValid=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.ActivityPointer:return false;default:return Mscrm.Utilities.isUserUsingBaseLanguage()}};Mscrm.RibbonActions.isShareValid=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.ActivityPointer:return false;default:return true}};Mscrm.RibbonActions.isBulkEditEnabledForEntity=function(entityTypeCode){switch(entityTypeCode){case Mscrm.EntityTypeCode.AccountAddress:case Mscrm.EntityTypeCode.ActivityMimeAttachment:case Mscrm.EntityTypeCode.ActivityParty:case Mscrm.EntityTypeCode.ActivityPointer:case Mscrm.EntityTypeCode.ActivityScheduling:case Mscrm.EntityTypeCode.Annotation:case Mscrm.EntityTypeCode.AnnualFiscalCalendar:case Mscrm.EntityTypeCode.ApplicationFile:case Mscrm.EntityTypeCode.AppLicense:case Mscrm.EntityTypeCode.AppOfflineFilter:case Mscrm.EntityTypeCode.Appointment:case Mscrm.EntityTypeCode.AppSalesPerson:case Mscrm.EntityTypeCode.AppWorkflowInstance:case Mscrm.EntityTypeCode.AsyncOperation:case Mscrm.EntityTypeCode.Attribute:case Mscrm.EntityTypeCode.AttributeMap:case Mscrm.EntityTypeCode.AttributePicklistValue:case Mscrm.EntityTypeCode.Audit:case Mscrm.EntityTypeCode.BulkDeleteFailure:case Mscrm.EntityTypeCode.BulkDeleteOperation:case Mscrm.EntityTypeCode.BulkDeleteWizardDialog:case Mscrm.EntityTypeCode.BulkOperation:case Mscrm.EntityTypeCode.BulkOperationLog:case Mscrm.EntityTypeCode.BusinessUnit:case Mscrm.EntityTypeCode.BusinessUnitMap:case Mscrm.EntityTypeCode.BusinessUnitNewsArticle:case Mscrm.EntityTypeCode.Calendar:case Mscrm.EntityTypeCode.CalendarRule:case Mscrm.EntityTypeCode.ClientUpdate:case Mscrm.EntityTypeCode.ColumnMapping:case Mscrm.EntityTypeCode.CompetitorAddress:case Mscrm.EntityTypeCode.Connection:case Mscrm.EntityTypeCode.ConnectionRole:case Mscrm.EntityTypeCode.ConstraintBasedGroup:case Mscrm.EntityTypeCode.ContactAddress:case Mscrm.EntityTypeCode.Contract:case Mscrm.EntityTypeCode.ContractDetail:case Mscrm.EntityTypeCode.ContractTemplate:case Mscrm.EntityTypeCode.CustomerAddress:case Mscrm.EntityTypeCode.CustomerOpportunityRole:case Mscrm.EntityTypeCode.CustomerRelationship:case Mscrm.EntityTypeCode.Discount:case Mscrm.EntityTypeCode.DiscountType:case Mscrm.EntityTypeCode.DisplayString:case Mscrm.EntityTypeCode.DisplayStringMap:case Mscrm.EntityTypeCode.DocumentIndex:case Mscrm.EntityTypeCode.DuplicateDetectionDialog:case Mscrm.EntityTypeCode.DuplicateRecord:case Mscrm.EntityTypeCode.DuplicateRule:case Mscrm.EntityTypeCode.DuplicateRuleCondition:case Mscrm.EntityTypeCode.Email:case Mscrm.EntityTypeCode.EmailHash:case Mscrm.EntityTypeCode.Entity:case Mscrm.EntityTypeCode.EntityMap:case Mscrm.EntityTypeCode.EntityRelationship:case Mscrm.EntityTypeCode.EntityRelationshipRole:case Mscrm.EntityTypeCode.Equipment:case Mscrm.EntityTypeCode.Fax:case Mscrm.EntityTypeCode.FieldPermission:case Mscrm.EntityTypeCode.FieldSecurityProfile:case Mscrm.EntityTypeCode.FilterTemplate:case Mscrm.EntityTypeCode.FixedMonthlyFiscalCalendar:case Mscrm.EntityTypeCode.GoalRollupQuery:case Mscrm.EntityTypeCode.HolidayCalendarRule:case Mscrm.EntityTypeCode.ImportData:case Mscrm.EntityTypeCode.ImportEntity:case Mscrm.EntityTypeCode.ImportFile:case Mscrm.EntityTypeCode.ImportJob:case Mscrm.EntityTypeCode.ImportLog:case Mscrm.EntityTypeCode.ImportMap:case Mscrm.EntityTypeCode.ImportWizardDialog:case Mscrm.EntityTypeCode.IncidentResolution:case Mscrm.EntityTypeCode.IntegrationStatus:case Mscrm.EntityTypeCode.InternalAddress:case Mscrm.EntityTypeCode.InterProcessLock:case Mscrm.EntityTypeCode.Invoice:case Mscrm.EntityTypeCode.InvoiceDetail:case Mscrm.EntityTypeCode.IsvConfig:case Mscrm.EntityTypeCode.KbArticle:case Mscrm.EntityTypeCode.KbArticleComment:case Mscrm.EntityTypeCode.KbArticleTemplate:case Mscrm.EntityTypeCode.LeadAddress:case Mscrm.EntityTypeCode.Letter:case Mscrm.EntityTypeCode.License:case Mscrm.EntityTypeCode.ListMember:case Mscrm.EntityTypeCode.LocalizedLabel:case Mscrm.EntityTypeCode.LookUpMapping:case Mscrm.EntityTypeCode.MailMergeTemplate:case Mscrm.EntityTypeCode.Metric:case Mscrm.EntityTypeCode.MonthlyFiscalCalendar:case Mscrm.EntityTypeCode.NewKbArticle:case Mscrm.EntityTypeCode.None:case Mscrm.EntityTypeCode.Notification:case Mscrm.EntityTypeCode.NotWorkingWorkShift:case Mscrm.EntityTypeCode.OccurrenceCalendarRule:case Mscrm.EntityTypeCode.OccurringWorkShift:case Mscrm.EntityTypeCode.OpportunityClose:case Mscrm.EntityTypeCode.OpportunityProduct:case Mscrm.EntityTypeCode.OptionSet:case Mscrm.EntityTypeCode.OrderClose:case Mscrm.EntityTypeCode.Organization:case Mscrm.EntityTypeCode.OrganizationStatistic:case Mscrm.EntityTypeCode.OrganizationUI:case Mscrm.EntityTypeCode.OwnerMapping:case Mscrm.EntityTypeCode.PhoneCall:case Mscrm.EntityTypeCode.PickListMapping:case Mscrm.EntityTypeCode.PluginAssembly:case Mscrm.EntityTypeCode.PluginType:case Mscrm.EntityTypeCode.PluginTypeStatistic:case Mscrm.EntityTypeCode.Privilege:case Mscrm.EntityTypeCode.PrivilegeObjectTypeCodes:case Mscrm.EntityTypeCode.ProcessSession:case Mscrm.EntityTypeCode.ProductPriceLevel:case Mscrm.EntityTypeCode.Publisher:case Mscrm.EntityTypeCode.QuarterlyFiscalCalendar:case Mscrm.EntityTypeCode.Queue:case Mscrm.EntityTypeCode.QueueItem:case Mscrm.EntityTypeCode.QuoteClose:case Mscrm.EntityTypeCode.QuoteDetail:case Mscrm.EntityTypeCode.RecurrenceCalendarRule:case Mscrm.EntityTypeCode.RecurringAppointmentMaster:case Mscrm.EntityTypeCode.RecurringWorkShift:case Mscrm.EntityTypeCode.Relationship:case Mscrm.EntityTypeCode.RelationshipRole:case Mscrm.EntityTypeCode.RelationshipRoleMap:case Mscrm.EntityTypeCode.Report:case Mscrm.EntityTypeCode.ReportPropertyDialog:case Mscrm.EntityTypeCode.ResourceGroupExpansion:case Mscrm.EntityTypeCode.ResourceSpec:case Mscrm.EntityTypeCode.RibbonCommand:case Mscrm.EntityTypeCode.RibbonContextGroup:case Mscrm.EntityTypeCode.RibbonCustomization:case Mscrm.EntityTypeCode.RibbonDiff:case Mscrm.EntityTypeCode.RibbonRule:case Mscrm.EntityTypeCode.RibbonTabToCommandMap:case Mscrm.EntityTypeCode.Role:case Mscrm.EntityTypeCode.RolePrivileges:case Mscrm.EntityTypeCode.RoleTemplate:case Mscrm.EntityTypeCode.RoleTemplatePrivileges:case Mscrm.EntityTypeCode.RollupField:case Mscrm.EntityTypeCode.SalesLiterature:case Mscrm.EntityTypeCode.SalesLiteratureItem:case Mscrm.EntityTypeCode.SalesOrderDetail:case Mscrm.EntityTypeCode.SavedQuery:case Mscrm.EntityTypeCode.SavedQueryVisualization:case Mscrm.EntityTypeCode.ScriptErrorDetailsDialog:case Mscrm.EntityTypeCode.ScriptErrorDialog:case Mscrm.EntityTypeCode.SdkMessage:case Mscrm.EntityTypeCode.SdkMessageFilter:case Mscrm.EntityTypeCode.SdkMessagePair:case Mscrm.EntityTypeCode.SdkMessageProcessingStep:case Mscrm.EntityTypeCode.SdkMessageProcessingStepImage:case Mscrm.EntityTypeCode.SdkMessageProcessingStepSecureConfig:case Mscrm.EntityTypeCode.SdkMessageRequest:case Mscrm.EntityTypeCode.SdkMessageRequestField:case Mscrm.EntityTypeCode.SdkMessageResponse:case Mscrm.EntityTypeCode.SdkMessageResponseField:case Mscrm.EntityTypeCode.SemiAnnualFiscalCalendar:case Mscrm.EntityTypeCode.Service:case Mscrm.EntityTypeCode.ServiceAppointment:case Mscrm.EntityTypeCode.ServiceEndpoint:case Mscrm.EntityTypeCode.ServiceRestrictionCalendarRule:case Mscrm.EntityTypeCode.SharePointDocumentLocation:case Mscrm.EntityTypeCode.SharePointSite:case Mscrm.EntityTypeCode.Site:case Mscrm.EntityTypeCode.SiteMap:case Mscrm.EntityTypeCode.Solution:case Mscrm.EntityTypeCode.SolutionComponent:case Mscrm.EntityTypeCode.SolutionExportWizard:case Mscrm.EntityTypeCode.SolutionImportWizard:case Mscrm.EntityTypeCode.Subject:case Mscrm.EntityTypeCode.Subscription:case Mscrm.EntityTypeCode.SubscriptionClients:case Mscrm.EntityTypeCode.SubscriptionManuallyTrackedObject:case Mscrm.EntityTypeCode.SubscriptionSyncInfo:case Mscrm.EntityTypeCode.SystemForm:case Mscrm.EntityTypeCode.SystemUser:case Mscrm.EntityTypeCode.SystemUserPrincipals:case Mscrm.EntityTypeCode.Task:case Mscrm.EntityTypeCode.Team:case Mscrm.EntityTypeCode.Template:case Mscrm.EntityTypeCode.Territory:case Mscrm.EntityTypeCode.TimeOffCalendarRule:case Mscrm.EntityTypeCode.TimeZoneDefinition:case Mscrm.EntityTypeCode.TimeZoneLocalizedName:case Mscrm.EntityTypeCode.TimeZoneRule:case Mscrm.EntityTypeCode.TransactionCurrency:case Mscrm.EntityTypeCode.TransformationMapping:case Mscrm.EntityTypeCode.TransformationParameterMapping:case Mscrm.EntityTypeCode.UnresolvedAddress:case Mscrm.EntityTypeCode.UnresolvedEmailParty:case Mscrm.EntityTypeCode.UoM:case Mscrm.EntityTypeCode.UserFiscalCalendar:case Mscrm.EntityTypeCode.UserForm:case Mscrm.EntityTypeCode.UserQuery:case Mscrm.EntityTypeCode.UserQueryVisualization:case Mscrm.EntityTypeCode.UserSettings:case Mscrm.EntityTypeCode.ViewAttribute:case Mscrm.EntityTypeCode.WebResource:case Mscrm.EntityTypeCode.WebWizard:case Mscrm.EntityTypeCode.WizardAccessPrivilege:case Mscrm.EntityTypeCode.WizardPage:case Mscrm.EntityTypeCode.Workflow:case Mscrm.EntityTypeCode.WorkflowDependency:case Mscrm.EntityTypeCode.WorkflowLog:case Mscrm.EntityTypeCode.WorkflowWaitSubscription:return false;default:return true}};Mscrm.RibbonActions.isDeleteVisualizationEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))if($v_0.isVisualizationPaneVisible())if(Mscrm.RibbonActions.isUserQueryVisualizationSelected()&&!$v_0.isVisualizationListEmpty()&&!$v_0.checkIfDrilldownMode()&&!$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isSystemViewLoaded=function(gridControl){if(!IsNull(gridControl)&&gridControl.GetParameter("viewtype")===Mscrm.EntityTypeCode.SavedQuery.toString())return true;return false};Mscrm.RibbonActions.canEnableSaveButton=function(gridControl){try{if(!IsNull(gridControl)){var $v_0=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_0))return $v_0.CanEnableFilters()&&$v_0.IsFilterEnabled()}}catch($$e_2){}return false};Mscrm.RibbonActions.canEnableFiltersOnGrid=function(gridControl){try{if(!IsNull(gridControl)){var $v_0=gridControl.GetParameter("enableFilters");if(isNullOrEmptyString($v_0)){var $v_1=$find(gridControl.get_id()+"_filterSet");if(!IsNull($v_1))return $v_1.CanEnableFilters()}else{gridControl.SetParameter("enableFilters","");return Mscrm.Utilities.parseBoolean($v_0)}}}catch($$e_3){}return false};Mscrm.RibbonActions.enableChartsButton=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if(!IsNull($v_2)&&!$v_2.enableChartButton())return false;return true}return false};Mscrm.RibbonActions.disableButtonsWhenChartMaximized=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id()+"_paneControl",$v_1=$find($v_0);if(!IsNull($v_1))if($v_1.getParameter("paneSize")===Mscrm.VisualizationPaneMode.expandedSize)return false}return true};Mscrm.RibbonActions.enableSetDefaultGridViewButton=function(){var $v_0="crmGrid_SavedNewQuerySelector",$v_1=$find($v_0);if(!IsNull($v_1)&&$v_1.showNewVSControl&&!$v_1.showOriginalSelectBox)return $v_1.selectedViewId!==$v_1.quickFindQuery&&$v_1.selectedViewId!==$v_1.userSelectedDefaultView;var $v_2=$get($v_0);if(!IsNull($v_2)&&$v_2.DataValue!==window.LOCID_SEARCH_RESULTS){var $v_3=$v_2.options[$v_2.selectedIndex],$v_4=$v_3.getAttribute("isdefault");if(!isNullOrEmptyString($v_4)&&Boolean.parse($v_4))return false;else return true}return false};Mscrm.RibbonActions.faxFormHasSend=function(){return !IsNull(window.CRM_FAXFORM_SEND_ALLOWED)&&window.CRM_FAXFORM_SEND_ALLOWED};Mscrm.RibbonActions.enableAssignShareChartButton=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&!$v_0.isVisualizationListEmpty()){var $v_1=$v_0.get_visualizationId();if($v_0.get_visualizationType()===Mscrm.EntityTypeCode.UserQueryVisualization)return true}return false};Mscrm.RibbonActions.isOutlookExplorerOrInspector=function(){return isOutlookHostedWindow()&&getOutlookHostedWindow().ParentFrameAvailable};Mscrm.RibbonActions.enableRibbonOnSubGrid=function(gridControl){if(!IsNull(gridControl)){var $v_0=gridControl.get_id(),$v_1=$v_0+"_visualizationCompositeControl",$v_2=$find($v_1);if(!IsNull($v_2))if(!$v_2.isGridEnabled())return false}return true};Mscrm.RibbonActions.showVisualizationToolsRibbon=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.isVisualizationPaneVisible()&&$v_0.isPaneInDesignerMode();else return false};Mscrm.RibbonActions.isVisualizationPaneInDesignerMode=function(){return Mscrm.RibbonActions.$Q()};Mscrm.RibbonActions.isComplexChart=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0))return $v_0.get_isComplexChart();return false};Mscrm.RibbonActions.isVisualizationPaneInRuntimeMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&!$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isVisualizationPaneInRuntimeOrEditMode=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&($v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.DesignerInEditMode||$v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.RuntimeMode))return true;return false};Mscrm.RibbonActions.isSaveAsChartEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()){if(Mscrm.RibbonActions.isVisualizationPaneInRuntimeMode()){if($v_0.checkIfDrilldownMode())return false;return !$v_0.isVisualizationListEmpty()}else if($v_0.get_paneMode()===Mscrm.VisualizationPaneRenderingModes.DesignerInNewMode)return false;return true}return false};Mscrm.RibbonActions.isDefaultVisualizationModule=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isDefaultVisualizationModule())return false;return true};Mscrm.RibbonActions.isSaveChartEnabled=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&Mscrm.RibbonActions.$Q())return true;return false};Mscrm.RibbonActions.isFetchxmlQuery=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isCustomQuery())return true;return false};Mscrm.RibbonActions.$Q=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&$v_0.isVisualizationPaneVisible()&&$v_0.isPaneInDesignerMode())return true;return false};Mscrm.RibbonActions.isChartSelected=function(){var $v_0=$find("crmGrid_paneControl");if(!IsNull($v_0)&&!$v_0.isVisualizationListEmpty())return true;return false};Mscrm.RibbonActions.isIEBrowser=function(){return Mscrm.Utilities.isIE()};Mscrm.RibbonActions.isIos=function(){return Mscrm.Utilities.isIosDevice()};Mscrm.RibbonActions.canApplyChartType=function(chartType){var $v_0=$find("crmGrid_paneControl");if($v_0)return $v_0.canApplyChartType(chartType);return false};Mscrm.RibbonActions.isTopBottomEnabled=function(){var $v_0=false,$v_1=$find("crmGrid_paneControl");if($v_1)$v_0=$v_1.isTopBottomEnabledForSelectedSeries();return $v_0};Mscrm.RibbonActions.primaryControlIsNotFormProxy=function(primaryControl){if(primaryControl&&Mscrm.FormProxyForRibbon)return !isInstanceOfTypeAcrossFrames(primaryControl,Mscrm.FormProxyForRibbon);return true};Mscrm.RibbonActions.formPageDeveloperTabEnableRule=function(primaryControl){if(Mscrm.Utilities.isUserUsingBaseLanguage())return Mscrm.RibbonActions.primaryControlIsNotFormProxy(primaryControl);else return false};Mscrm.RibbonActions.gridPageDeveloperTabEnableRule=function(){if(Mscrm.Utilities.isUserUsingBaseLanguage())return true;else return false};Mscrm.RibbonActions.canAttachFile=function(entityTypeCode){if(Mscrm.EntityTypeCode.ActivityPointer===entityTypeCode||Mscrm.EntityTypeCode.Email===entityTypeCode)return false;else return true};Mscrm.RibbonActions.enableCancelForContractLineSubGrid=function(){if(!IsNull(window.CONTRACT_INVOICED_OR_ACTIVE))return window.CONTRACT_INVOICED_OR_ACTIVE;else return false};Mscrm.RibbonActions.enableDeleteForContractLineSubGrid=function(){if(!IsNull(window.CONTRACT_DRAFT_OR_CANCEL_OR_EXPIRE))return window.CONTRACT_DRAFT_OR_CANCEL_OR_EXPIRE;else return false};Mscrm.RibbonActions.canPromoteActivityToResponse=function(){if(!IsNull(window.LOCID_PROMOTE_TO_RESPONSE)){var $v_0=String.format("{0}",window.LOCID_PROMOTE_TO_RESPONSE);return Boolean.parse($v_0)}else return false};Mscrm.RibbonActions.canPromoteEmailToResponse=function(){if(!IsNull(window.LOCID_PROMOTE_EMAIL_TO_RESPONSE)){var $v_0=String.format("{0}",window.LOCID_PROMOTE_EMAIL_TO_RESPONSE);return Boolean.parse($v_0)}else return false};Mscrm.RibbonActions.isServiceRefreshEnabled=function(){return Mscrm.FeatureControl.get_Current().isFeatureEnabled(Mscrm.FeatureNames.RefreshService)};Mscrm.RibbonActions.isSharepointS2SConfigurationEnabled=function(){return Mscrm.FeatureControl.get_Current().isFeatureEnabled(Mscrm.FeatureNames.SharePointS2S)};Mscrm.RibbonActions.isSharePointSiteConfigured=function(){var $v_0=$get("gridBodyTable");if($v_0){var $v_1=$v_0.getAttribute("siteNotFound");if($v_1)return false}return true};Mscrm.RibbonActions.isRecordHasActiveSharePointDocLocation=function(){var $v_0=$get("gridBodyTable");if($v_0){var $v_1=$v_0.getAttribute("folderpath"),$v_2=$v_0.getAttribute("documentLocationDisabled"),$v_3=$v_0.getAttribute("folderRenamed");if($v_1||$v_2||$v_3)return false}return true};Mscrm.RibbonActions.isRecordHasActiveOrRenamedSharePointDocLocation=function(){if(!Mscrm.RibbonActions.isRecordHasActiveSharePointDocLocation()){var $v_0=$get("gridBodyTable");if($v_0){var $v_1=$v_0.getAttribute("folderRenamed");if(!$v_1)return false}}return true};Mscrm.RibbonActions.isNetBreezeAvailable=function(){return Mscrm.FeatureControl.get_Current().isFeatureEnabled(Mscrm.FeatureNames.SocialInsights)};Mscrm.RibbonActions.onTabSwitch=function(commandProperties){raiseTabSwitchEvent(commandProperties)};Mscrm.RibbonActions.onRootEvent=function(commandProperties){raiseRibbonRootEvent(commandProperties)};Mscrm.RibbonActions.isParentInactive=function(){var $v_0=Xrm.Page.data.entity.getEntityName(),$v_1=Xrm.Page.data.entity.getId(),$v_2=new RemoteCommand("CustomerService","IsParentRecordInactive");$v_2.SetParameter("entityName",$v_0);$v_2.SetParameter("entityId",$v_1);var $v_3=$v_2.Execute();if($v_3.Success)return $v_3.ReturnValue;return true};Mscrm.XrmRibbonActionUtilities=function(){};Mscrm.XrmRibbonActionUtilities.isMobileCompanionApp=function(){return Xrm.Page.context.client.getClient()===Xrm.ClientNames.mobile};Mscrm.ExportGridToExcel=function(){};Mscrm.ExportGridToExcel.doExportToExcel=function(gridControl,entityTypeCode){var $v_0=Mscrm.ExportGridToExcel.$f(gridControl,entityTypeCode);if(!Mscrm.SessionInfo.isOutlookClient()||Mscrm.SessionInfo.getClientMajorVersion()<5){var $v_1=[gridControl,"exportFrame"];$v_0.setCallbackInfo("performExcelExport",Mscrm.ExportGridToExcel,$v_1)}$v_0.show()};Mscrm.ExportGridToExcel.performExcelExport=function(dialogResult,gridControl,target){if(dialogResult){var $v_0=null,$v_1=dialogResult.result;Mscrm.ExportGridToExcel.$t("DownloadOptions");Mscrm.ExportGridToExcel.$c();switch($v_1){case -1:return;case 0:case 1:case 4:case 5:$v_0=Mscrm.ExportGridToExcel.$d($v_1,gridControl,target);break;case 2:$v_0=Mscrm.ExportGridToExcel.$K(gridControl,"dynamicXlsx",dialogResult.useSqlQuery,gridControl.get_gridXml(),dialogResult.fetchXml,dialogResult.layoutXml,target);break;case 3:$v_0=Mscrm.ExportGridToExcel.$K(gridControl,"pivotXlsx",dialogResult.useSqlQuery,gridControl.get_gridXml(),dialogResult.fetchXml,dialogResult.layoutXml,target);break}$v_0.submit()}};Mscrm.ExportGridToExcel.$f=function($p0,$p1){var $v_0=$p0.get_pageNumber()>1||$p0.get_hasMorePages();if(isRichClient()&&$p1===Mscrm.EntityTypeCode.ActivityPointer&&Mscrm.SessionInfo.getOutlookMajorVersion()>11)$p1=Number.parseInvariant(getOutlookHostedWindow().getParameter("viewOtc"));var $v_1=Mscrm.CrmUri.create("/_grid/print/export_dlg.aspx");$v_1=Mscrm.CrmUri.updateCrmUriHostAndScheme($v_1);$v_1.get_query()["multipage"]=$v_0?"1":"0";$v_1.get_query()["otc"]=$p1;$v_1.get_query()["TotalRecordCount"]=$p0.get_totalRecordCount().toString();$v_1.get_query()["PageRecordCount"]=$p0.get_pageRecordCount().toString();var $v_2=new Mscrm.ExportDialogArguments;$v_2.layoutXml=Mscrm.ExportGridToExcel.$b($p0.get_gridXml());var $v_3=$p0.GetParameter("effectiveFetchXml"),$v_4=$p0.GetParameter("fetchXml");if(!isNullOrEmptyString($v_3))$v_2.effectiveFetchXml=$v_3;if(!isNullOrEmptyString($v_4))$v_2.fetchXml=$v_4;$v_2.gridControl=$p0;$v_1.get_query()["DuplicateColumnsPresent"]=Mscrm.ExportGridToExcel.$i($p0.get_gridXml())?"1":"0";$v_1.get_query()["viewid"]=$p0.GetParameter("viewid");$v_1.get_query()["viewtype"]=$p0.GetParameter("viewtype");$v_1.get_query()["isFetchFinal"]=Mscrm.GridRibbonActions.$P($p0)?"1":"0";var $v_5=$p0.GetParameter("oId");if(!IsNull($v_5))$v_1.get_query()["oid"]=$v_5;var $v_6=parseInt(window.LOCID_EXPORT_WINDOW_WIDTH,10),$v_7=parseInt(window.LOCID_EXPORT_WINDOW_HEIGHT,10),$v_8=new Mscrm.CrmDialog($v_1,$v_2,$v_6,$v_7,null);return $v_8};Mscrm.ExportGridToExcel.$b=function($p0){var $v_0=new Sys.StringBuilder,$v_1=XUI.Xml.LoadXml($p0),$v_2=false;try{$v_0.append('<grid name="excelGrid" select="0" icon="0" preview="0">');var $v_3=XUI.Xml.SelectSingleNode($v_1,"grid/parameters/layoutXml",null),$v_4=XUI.Xml.LoadXml(XUI.Xml.GetText($v_3)),$v_5=XUI.Xml.SelectSingleNode($v_4,"grid/row",null);$v_0.append(XUI.Xml.XMLSerializer.serializeToString($v_5));$v_0.append("</grid>")}catch($$e_7){$v_2=true;$v_0.clear()}if($v_2){$v_0.append('<grid name="excelGrid" select="0" icon="0" preview="0"><row name="excelRow">');for(var $v_6=XUI.Xml.SelectNodes($v_1,"grid/columns/column",null),$v_7=0;$v_7<$v_6.length;$v_7++){var $v_8=$v_6[$v_7];if(!IsNull($v_8)){var $v_9=$v_8.attributes.getNamedItem("width"),$v_A=$v_8.attributes.getNamedItem("fieldname");if(!IsNull($v_9)&&!isNullOrEmptyString($v_9.nodeValue)&&!IsNull($v_A)&&!isNullOrEmptyString($v_A.nodeValue)){$v_0.append('<cell width="');$v_0.append(CrmEncodeDecode.CrmXmlAttributeEncode($v_9.nodeValue));$v_0.append('" name="');$v_0.append(CrmEncodeDecode.CrmXmlAttributeEncode(XUI.Xml.GetText($v_8)));$v_0.append('" />')}}}$v_0.append("</row></grid>")}return $v_0.toString()};Mscrm.ExportGridToExcel.$i=function($p0){for(var $v_0=XUI.Xml.LoadXml($p0),$v_1=XUI.Xml.SelectNodes($v_0,"grid/columns/column",null),$v_2=[],$v_3=0;$v_3<$v_1.length;$v_3++){var $v_4=$v_1[$v_3];if(!IsNull($v_4)){var $v_5=$v_4.attributes.getNamedItem("isHidden");if(!IsNull($v_5)&&!isNullOrEmptyString($v_5.nodeValue))if($v_5.nodeValue==="true")continue;var $v_6=$v_4.attributes.getNamedItem("label");if(!IsNull($v_6)&&!isNullOrEmptyString($v_6.nodeValue)){if(Array.contains($v_2,$v_6.nodeValue))return true;Array.add($v_2,$v_6.nodeValue)}}}return false};Mscrm.ExportGridToExcel.$d=function($p0,$p1,$p2){var $v_0=$p1.get_gridXml(),$v_1=IsNull($p1.GetParameter("effectiveFetchXml"))?"":$p1.GetParameter("effectiveFetchXml"),$v_2=document.getElementsByName("gridExportStatic")[0];if(!IsNull($v_2))Mscrm.GridRibbonActions.$A($v_2);else{$v_2=document.createElement("form");$v_2.name="gridExportStatic";$v_2.method="post";$v_2.style.display="none";document.body.appendChild($v_2)}Mscrm.GridRibbonActions.$2($v_2,"gridXml",$v_0);Mscrm.GridRibbonActions.$2($v_2,"fetchXml",$v_1);var $v_3=$p0===5||$p0===1;Mscrm.GridRibbonActions.$2($v_2,"printAllPages",$v_3?"1":"0");var $v_4=Mscrm.GridRibbonActions.validDataProviderForXlsx($p1),$v_5=Mscrm.GridRibbonActions.validQueryApiForXlsx($p1);$v_4&&$v_5&&Mscrm.GridRibbonActions.$2($v_2,"exportType","xlsx");$v_2.action=Mscrm.CrmUri.create("/_grid/print/print_data.aspx").toString();$v_2.target=$p2;return $v_2};Mscrm.ExportGridToExcel.$c=function(){var $v_0=$get("exportFrame");if(!IsNull($v_0))return;$v_0=document.createElement("iframe");$v_0.id="exportFrame";$v_0.setAttribute("name","exportFrame");$v_0.setAttribute("style","display: none");document.body.appendChild($v_0);$v_0.contentWindow.name="exportFrame"};Mscrm.ExportGridToExcel.$K=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $v_0=document.getElementsByName("gridExportLive")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$A($v_0);else{$v_0=document.createElement("form");$v_0.setAttribute("name","gridExportLive");$v_0.setAttribute("method","post");$v_0.setAttribute("target",$p6);$v_0.setAttribute("action",Mscrm.CrmUri.create("/_grid/print/export_live.aspx").toString());document.body.appendChild($v_0)}var $v_1=document.createElement("div");$v_1.style.height="72pt";$v_1.style.width="72pt";$v_1.style.visibility="hidden";document.body.appendChild($v_1);var $v_2=$v_1.offsetWidth;$v_1.parentNode.removeChild($v_1);Mscrm.GridRibbonActions.$2($v_0,"gridXml",$p3);Mscrm.GridRibbonActions.$2($v_0,"xdpi",$v_2.toString());Mscrm.GridRibbonActions.$2($v_0,"exportType",$p1);Mscrm.GridRibbonActions.$2($v_0,"useSqlQuery",$p2?"1":"0");Mscrm.GridRibbonActions.$2($v_0,"fetchXml",isNullOrEmptyString($p4)?"":$p4);Mscrm.GridRibbonActions.$2($v_0,"layoutXml",isNullOrEmptyString($p5)?"":$p5);Mscrm.GridRibbonActions.$2($v_0,"viewid",$p0.GetParameter("viewid"));Mscrm.GridRibbonActions.$2($v_0,"viewtype",$p0.GetParameter("viewtype"));return $v_0};Mscrm.ExportGridToExcel.$t=function($p0){var $v_0=window.top.document.getElementsByTagName("Head");if(!IsNull($v_0)&&$v_0.length){var $v_1=window.top.document.getElementsByTagName("Head")[0];if(!IsNull($v_1)){var $v_2=$v_1.getElementsByTagName("meta");if(!IsNull($v_2)&&$v_2.length)for(var $v_3=0;$v_3<$v_2.length;$v_3++){var $v_4=$v_2[$v_3].getAttribute("name");!IsNull($v_4)&&$v_4===$p0&&$v_1.removeChild($v_2[$v_3])}}}};Mscrm.ExportGridToExcel.exportToExcel=function(gridControl,entityTypeCode){if(Mscrm.Utilities.isIosDevice()){Xrm.Utility.alertDialog(Xrm.Internal.getResourceString("LOCID_UNSUPPORTED_RIBBONACTION"),null);return}var $v_0=false;if(gridControl.GetParameter("LoadOnDemand")==="1"){$v_0=true;gridControl.SetParameter("LoadOnDemand","0")}Mscrm.ExportGridToExcel.doExportToExcel(gridControl,entityTypeCode);$v_0&&gridControl.SetParameter("LoadOnDemand","1")};Mscrm.DashboardRibbonActions=function(){};Mscrm.DashboardRibbonActions.$3=function(){try{if(!IsNull(Mscrm.DashboardRibbonActions.$4)&&!Mscrm.DashboardRibbonActions.$4.get_isDisposed())return Mscrm.DashboardRibbonActions.$4}catch($$e_0){}Mscrm.DashboardRibbonActions.$4=$find("dashboardSelector");if(IsNull(Mscrm.DashboardRibbonActions.$4))Mscrm.DashboardRibbonActions.$4=window.parent.Sys.Application.findComponent("dashboardSelector");if(IsNull(Mscrm.DashboardRibbonActions.$4)){var $v_0=document.getElementsByTagName("iframe");if($v_0&&$v_0.length>0){var $v_1=$v_0[0].contentWindow;Mscrm.DashboardRibbonActions.$4=$v_1.Sys.Application.findComponent("dashboardSelector")}}return Mscrm.DashboardRibbonActions.$4};Mscrm.DashboardRibbonActions.$5=function($p0){if(!IsNull($p0)){if(!$p0.get_dashboardItems().length)return false;return true}return false};Mscrm.DashboardRibbonActions.isAnyDashboardSelected=function(){return Mscrm.DashboardRibbonActions.$5(Mscrm.DashboardRibbonActions.$3())};Mscrm.DashboardRibbonActions.isUserFormSelected=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItemType");if(!IsNull($v_1)&&parseInt($v_1.value,10)===Mscrm.EntityTypeCode.UserForm)return true}return false};Mscrm.DashboardRibbonActions.isUserDefaultDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItem").value,$v_2=$v_0.get_selector().attributes.getNamedItem("userDefaultItem");if(!IsNull($v_2))if($v_2.value.toLowerCase()===$v_1)return true}return false};Mscrm.DashboardRibbonActions.isUserDefaultModule=function(){var $v_0=Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.GetSelectedAreaSubAreaIds,null),$v_1=$v_0[0],$v_2=window.parent.Sys.Application.findComponent("navBar");if($v_2){var $v_3=Mscrm.CrmUri.create($v_2.get_homeNode().Action["PageUrl"]);if(!IsNull($v_3.get_query()["sitemappath"])&&$v_3.get_query()["sitemappath"].toString().split("|")[0]===$v_1["areaId"].toString())return true}return false};Mscrm.DashboardRibbonActions.deleteDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=Mscrm.CrmUri.create("/_grid/cmds/dlg_delete.aspx");$v_3.get_query()["iObjType"]=$v_2.toString();$v_3.get_query()["iTotal"]="1";$v_3.get_query()["sIds"]=$v_1;var $v_4=new Mscrm.CrmDialog($v_3,[$v_1],405,205,null);$v_4.setCallbackInfo("refreshDashboardCallback",Mscrm.DashboardRibbonActions,null);$v_4.show()}};Mscrm.DashboardRibbonActions.refreshDashboardCallback=function(returnInfo){!IsNull(returnInfo)&&returnInfo&&Mscrm.DashboardRibbonActions.refreshDashboardSelector(null,true,false)};Mscrm.DashboardRibbonActions.assignDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=new Mscrm.EntityReference;$v_2.TypeCode=$v_0.get_currentType();$v_2.Id=$v_1;var $v_3=[$v_2],$v_4=Mscrm.GridRibbonActions.$0("assign",$v_2.TypeCode,1),$v_5=[],$v_6=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.DashboardRibbonActions.refreshDashboardCallback,$v_5),$v_7=Mscrm.GridRibbonActions.$N($v_4,$v_3,456,310,null,$v_6);Mscrm.Utilities.isModalDialogSupported()&&Mscrm.DashboardRibbonActions.refreshDashboardCallback($v_7)}};Mscrm.DashboardRibbonActions.shareDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=new Mscrm.EntityReference;$v_3.TypeCode=$v_2;$v_3.Id=$v_1;var $v_4=[$v_3],$v_5=Mscrm.GridRibbonActions.$0("share",$v_3.TypeCode,1),$v_6=Mscrm.GridRibbonActions.$N($v_5,$v_4,800,480,null)}};Mscrm.DashboardRibbonActions.saveDashboardAs=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)){var $v_1=$v_0.get_currentItem().toLowerCase(),$v_2=$v_0.get_currentType(),$v_3=$v_0.getDashboardNode($v_1),$v_4="";if(!IsNull($v_3.attributes.getNamedItem("desc")))$v_4=XUI.Xml.GetText($v_3.attributes.getNamedItem("desc"));var $v_5="";if(!IsNull($v_3.attributes.getNamedItem("display")))$v_5=XUI.Xml.GetText($v_3.attributes.getNamedItem("display"));var $v_6={};$v_6.sName=$v_5;$v_6.sDescription=$v_4;var $v_7=[$v_1,$v_2],$v_8=Mscrm.Utilities.createCallbackFunctionObject("saveAsDashboardCallback",Mscrm.DashboardRibbonActions,$v_7,false),$v_9=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/AdvancedFind/QueryProperties.aspx?feature=dashboard"),$v_6,500,310,null);$v_9.setCallbackReference($v_8);$v_9.show()}};Mscrm.DashboardRibbonActions.saveAsDashboardCallback=function(dashboardInfo,dashboardId,dashboardTypeCode){if(!IsNull(dashboardInfo)){var $v_0=new RemoteCommand("DashboardWebService","SaveCopyOfDashboard",null);$v_0.SetParameter("sourceDashboardId",dashboardId);$v_0.SetParameter("sourceDashboardObjectTypeCode",dashboardTypeCode);$v_0.SetParameter("name",dashboardInfo.sName);$v_0.SetParameter("description",dashboardInfo.sDescription);var $v_1=$v_0.Execute();if($v_1.Success){var $v_2=$v_1.ReturnValue;Mscrm.DashboardRibbonActions.refreshDashboardSelector($v_2,true,false);var $v_3=Mscrm.DashboardRibbonActions.$3();$v_3.get_selector().setAttribute("defaultItem",dashboardId);refreshRibbon();$v_3.updateStickyDashboardUrl($v_2)}}};Mscrm.DashboardRibbonActions.refreshDashboardPage=function(){var $v_0=$find("crmPageManager");!IsNull($v_0)&&$v_0.raiseEvent(Mscrm.ScriptEvents.OnDashboardRefresh,null)};Mscrm.DashboardRibbonActions.setUserDefaultDashboard=function(){var $v_0=Mscrm.DashboardRibbonActions.$3();if(Mscrm.DashboardRibbonActions.$5($v_0)&&!IsNull($v_0.get_selector().attributes.getNamedItem("CurrentItem"))){var $v_1=$v_0.get_selector().attributes.getNamedItem("CurrentItem").value,$v_2=new Sys.StringBuilder;$v_2.append("<usersettings>");$v_2.append("<defaultdashboardid>");$v_2.append($v_1);$v_2.append("</defaultdashboardid>");$v_2.append("</usersettings>");var $v_3=new XMLHttpRequest,$v_4=Mscrm.CrmUri.create("/Tools/PersonalSettings/cmds/cmd_update.aspx");$v_3.open("POST",$v_4.toString(),false);Mscrm.Utilities.setResponseTypeToMSXml($v_3);Mscrm.WrpcTokenFuncs.setTokenInHeader($v_3,$v_4);$v_3.send($v_2.toString());var $v_5=$v_3.responseXML,$v_6=XUI.Xml.SelectSingleNode($v_5,"/error",null);if(IsNull($v_6)){$v_0.get_selector().setAttribute("userDefaultItem",$v_1);refreshRibbon()}Mscrm.XmlUtil.handleXMLErr($v_5,true)}};Mscrm.DashboardRibbonActions.editDashboard=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=Mscrm.CrmUri.create(Mscrm.DashboardRibbonActions.$C),$v_1=Mscrm.DashboardRibbonActions.$3(),$v_2=$v_1.get_selector().attributes.getNamedItem("CurrentItem").value,$v_3=$v_1.get_selector().attributes.getNamedItem("CurrentItemType").value,$v_4="&formId="+$v_2+"&dashboardType="+$v_3;$v_0.get_query()["extraqs"]=$v_4;if(isOutlookHostedWindow())openStdWin($v_0,buildWinName(null),Mscrm.DashboardRibbonActions.$E,Mscrm.DashboardRibbonActions.$D,null);else{$v_0=Mscrm.CrmUri.create("/tools/dashboardEditor/dashboardEditor.aspx?");$v_0.get_query()["dashboardType"]=$v_3;$v_0.get_query()["formId"]=$v_2;$v_0.get_query()["pagemode"]="iframe";var $v_5={};$v_5["uri"]=$v_0.toString();$v_5["preservePreviousContent"]=true;Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.Navigate,$v_5)}};Mscrm.DashboardRibbonActions.createNewDashboard=function(){if(Mscrm.Utilities.isIosDevice()){alert(window.LOCID_UNSUPPORTED_RIBBONACTION);return}var $v_0=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/tools/dashboardeditor/dialogs/dashboardlayoutdialog.aspx"),null,800,450,null);$v_0.setCallbackInfo("dashboardLayoutDialog",Mscrm.DashboardRibbonActions,null);$v_0.show()};Mscrm.DashboardRibbonActions.dashboardLayoutDialog=function(dashboardInfo){if(!IsNull(dashboardInfo))if(isOutlookHostedWindow()){var $v_0=Mscrm.CrmUri.create(Mscrm.DashboardRibbonActions.$C),$v_1="&layoutId="+dashboardInfo+"&dashboardType="+Mscrm.EntityTypeCode.UserForm;$v_0.get_query()["extraqs"]=$v_1;openStdWin($v_0,buildWinName(null),Mscrm.DashboardRibbonActions.$E,Mscrm.DashboardRibbonActions.$D,null)}else{var $v_2=Mscrm.CrmUri.create("tools/dashboardEditor/dashboardEditor.aspx?");$v_2.get_query()["dashboardType"]=Mscrm.EntityTypeCode.UserForm;$v_2.get_query()["layoutId"]=dashboardInfo;$v_2.get_query()["pagemode"]="iframe";var $v_3={};$v_3["uri"]=$v_2.toString();$v_3["preservePreviousContent"]=true;Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.Navigate,$v_3)}};Mscrm.DashboardRibbonActions.refreshDashboardSelector=function(dashboardId,refreshDashboard,calledFromEditor){var $v_0=Mscrm.DashboardRibbonActions.$3();if(!IsNull($v_0)&&!$v_0.get_isDisposed()){dashboardId=Mscrm.DashboardRibbonActions.$u(dashboardId);$v_0.hide();calledFromEditor&&$v_0.set_reloadNeeded(true);var $v_1=new RemoteCommand("DashboardWebService","DashboardSelectorContent",null);$v_1.SetParameter("showNewDashboard",true);var $v_2=Mscrm.PageManager.get_instance().raiseEvent(Mscrm.ScriptEvents.GetSelectedAreaSubAreaIds,null),$v_3=$v_2[0];!IsNull($v_3)&&$v_1.SetParameter("siteMapPath",$v_3["sitemappath"]);var $v_4=$v_1.Execute();$v_4.Success&&$v_0.loadList($v_4.ReturnValue,dashboardId,refreshDashboard)}};Mscrm.DashboardRibbonActions.$u=function($p0){if(isNullOrEmptyString($p0))return $p0;if(!$p0.startsWith("{"))$p0="{"+$p0;if(!$p0.endsWith("}"))$p0=$p0+"}";return $p0};Mscrm.DashboardEditorRibbonActions=function(){};Mscrm.DashboardEditorRibbonActions.showPropertiesDialog=function(){var $v_0=$get("dashboardNameInput"),$v_1=$get("dashboardDescriptionInput"),$v_2="",$v_3="";if(!IsNull($v_0)&&!IsNull($v_1)){$v_2=$v_0.value;$v_3=$v_1.value}var $v_4={};$v_4.sName=$v_2;$v_4.sDesc=$v_3;var $v_5=new Mscrm.CrmDialog(Mscrm.CrmUri.create("/Tools/DashboardEditor/Dialogs/DashboardProperties.aspx"),$v_4,500,310,null);$v_5.setCallbackInfo("dashboardProperties",Mscrm.DashboardEditorRibbonActions,null);$v_5.show()};Mscrm.DashboardEditorRibbonActions.dashboardProperties=function(dashboardInfo){var $v_0=$get("dashboardNameInput"),$v_1=$get("dashboardDescriptionInput");if(!IsNull(dashboardInfo)&&!IsNull($v_0)&&!IsNull($v_1)){$v_0.value=dashboardInfo.sName;$v_1.value=dashboardInfo.sDesc}};Mscrm.PrintFromGrid=function(){};Mscrm.PrintFromGrid.print=function($p0){Mscrm.PrintFromGrid.$g($p0)};Mscrm.PrintFromGrid.$g=function($p0){var $v_0=$p0.get_hasMorePages()||$p0.get_pageNumber()>1;if(!$v_0){Mscrm.PrintFromGrid.printCallBack(0,$p0);return}var $v_1=Mscrm.CrmUri.create("/_grid/print/print_dlg.aspx"),$v_2=new Xrm.DialogOptions;$v_2.height=parseInt(window.LOCID_PRINT_WINDOW_HEIGHT,10);$v_2.width=parseInt(window.LOCID_PRINT_WINDOW_WIDTH,10);var $v_3=[$p0],$v_4=Mscrm.InternalUtilities.GridUtilities.createCallbackFunctionFactory(Mscrm.PrintFromGrid.printCallBack,$v_3);Xrm.Internal.openDialog($v_1.toString(),$v_2,null,null,$v_4)};Mscrm.PrintFromGrid.printCallBack=function($p0,$p1){var $v_0=$p0;if(!IsNull($v_0)&&$v_0!==-1){var $v_1=Mscrm.CrmUri.create("/_grid/print/print.aspx").toString(),$v_2="print"+buildWinName($p1.GetParameter("viewid")),$v_3="status=1,resizable=1,scrollbars=0",$v_4=780,$v_5=500;if(isOutlookHostedWindow()){var $v_6="gridXml="+CrmEncodeDecode.CrmUrlEncode($p1.get_gridXml());$v_6+="&printAllPages="+CrmEncodeDecode.CrmUrlEncode($v_0.toString());PostToNewWindow($v_1,$v_2,$v_4,$v_5,$v_3,$v_6)}else{openStdWin(Mscrm.CrmUri.create(""),$v_2,$v_4,$v_5,$v_3);var $v_7=Mscrm.PrintFromGrid.$e($v_0,$p1.get_gridXml());$v_7.action=$v_1;$v_7.target=$v_2;$v_7.submit()}}};Mscrm.PrintFromGrid.$e=function($p0,$p1){var $v_0=document.getElementsByName("gridPrint")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$A($v_0);else{$v_0=window.document.createElement("form");$v_0.setAttribute("name","gridPrint");$v_0.setAttribute("method","post");$v_0.style.display="none";window.document.body.appendChild($v_0)}Mscrm.GridRibbonActions.$2($v_0,"gridXml",$p1);Mscrm.GridRibbonActions.$2($v_0,"printAllPages",$p0.toString());return $v_0};Mscrm.RunReportFromGrid=function(){};Mscrm.RunReportFromGrid.runReport=function(commandProperties,gridControl,recordIds){var $v_0=commandProperties["SourceControlId"],$v_1=$v_0.substr($v_0.length-38),$v_2=Mscrm.ReportUtil.get_reportInformation()[$v_1],$v_3=$v_2.Filterable,$v_4=$v_2.ReportType,$v_5=$v_2.FileName;Mscrm.RunReportFromGrid.$X(gridControl,recordIds,$v_3,$v_1,$v_4,$v_5)};Mscrm.RunReportFromGrid.$X=function($p0,$p1,$p2,$p3,$p4,$p5){var $v_0=2,$v_1=$p0.GetParameter("effectiveFetchXml");if($p2){var $v_2=Mscrm.CrmUri.create("/_grid/cmds/dlg_runreport.aspx");$v_2.get_query()["id"]=$p3;$v_2.get_query()["numselected"]=$p1.length;$v_2.get_query()["enableview"]=Mscrm.GridRibbonActions.$P($p0)?"1":"0";var $v_3=new Mscrm.CrmDialog($v_2,null,450,400,null),$v_4=[$p0,$p1,$p2,$p3,$p4,$p5,$v_1];$v_3.setCallbackInfo("performActionAfterRunReport",Mscrm.RunReportFromGrid,$v_4);$v_3.show()}else Mscrm.RunReportFromGrid.performActionAfterRunReport($v_0,$p0,$p1,$p2,$p3,$p4,$p5,$v_1)};Mscrm.RunReportFromGrid.performActionAfterRunReport=function(runMode,gridControl,recordIds,filterable,reportId,reportType,fileName,fetchXml){if(filterable)if(IsNull(runMode))runMode=-1;if(runMode===-1)return;var $v_0=Mscrm.WindowInformation.getWindowInformation(Mscrm.EntityTypeCode.Report),$v_1=$v_0.Url,$v_2=shouldLaunchPageInOutlookHostedWindow($v_1),$v_3,$v_4=null;switch(runMode){case 1:$v_3=Mscrm.RunReportFromGrid.$L($v_1,reportId,fileName,"fetch");if($v_2)$v_4="fetchxml="+CrmEncodeDecode.CrmUrlEncode(fetchXml)+"\n\n";else Mscrm.GridRibbonActions.$2($v_3,"fetchxml",fetchXml);break;case 0:for(var $v_5=new Sys.StringBuilder,$v_7=0;$v_7<recordIds.length;$v_7++){$v_7>0&&$v_5.append(";");$v_5.append(recordIds[$v_7])}$v_3=Mscrm.RunReportFromGrid.$L($v_1,reportId,fileName,"records","recordstype="+CrmEncodeDecode.CrmUrlEncode(gridControl.GetParameter("otc")));if($v_2)$v_4="records="+CrmEncodeDecode.CrmUrlEncode($v_5.toString())+"\n\n";else Mscrm.GridRibbonActions.$2($v_3,"records",$v_5.toString());break;case 2:default:Mscrm.ReportUtil.viewReport(reportType,reportId,fileName,"run",null);return}var $v_6=buildWinName(null);if($v_2)PostToNewWindow($v_3.action,$v_6,$v_0.Width,$v_0.Height,null,$v_4);else{var $v_8=buildWindowFeatures($v_0.Width,$v_0.Height,null);safeWindowOpen(Mscrm.CrmUri.create("/_static/loading.htm"),$v_6,$v_8,true);$v_3.target=$v_6;$v_3.submit()}};Mscrm.RunReportFromGrid.$L=function($p0,$p1,$p2,$p3,$p4){var $v_0=document.getElementsByName("gridViewReport")[0];if(!IsNull($v_0))Mscrm.GridRibbonActions.$A($v_0);else{$v_0=window.document.createElement("form");$v_0.setAttribute("name","gridViewReport");$v_0.setAttribute("method","post");$v_0.setAttribute("style","display: none");$v_0=window.document.body.appendChild($v_0)}$p0.get_query()["action"]="run";$p0.get_query()["id"]=$p1;$p0.get_query()["helpID"]=$p2;if(!IsNull($p3))$p0.get_query()["context"]=$p3;!IsNull($p4)&&$p0.appendToQuery("&"+$p4);$v_0.action=$p0.toString();return $v_0};Mscrm.ExportDialogArguments.registerClass("Mscrm.ExportDialogArguments");Mscrm.ExportDialogReturnValue.registerClass("Mscrm.ExportDialogReturnValue");Mscrm.DetectDuplicateArguments.registerClass("Mscrm.DetectDuplicateArguments");Mscrm.TeamActions.registerClass("Mscrm.TeamActions");Mscrm.UserQueryActions.registerClass("Mscrm.UserQueryActions");Mscrm.Campaign.registerClass("Mscrm.Campaign");Mscrm.IncidentActions.registerClass("Mscrm.IncidentActions");Mscrm.Article.registerClass("Mscrm.Article");Mscrm.ImportFileActions.registerClass("Mscrm.ImportFileActions");Mscrm.EmailServerProfileActions.registerClass("Mscrm.EmailServerProfileActions");Mscrm.List.registerClass("Mscrm.List");Mscrm.MailboxActions.registerClass("Mscrm.MailboxActions");Mscrm.QueueItem.registerClass("Mscrm.QueueItem");Mscrm.QuickCampaign.registerClass("Mscrm.QuickCampaign");Mscrm.ReportActions.registerClass("Mscrm.ReportActions");Mscrm.Goal.registerClass("Mscrm.Goal");Mscrm.OpportunityActions.registerClass("Mscrm.OpportunityActions");Mscrm.RollupField.registerClass("Mscrm.RollupField");Mscrm.SalesLiterature.registerClass("Mscrm.SalesLiterature");Mscrm.SystemUserActions.registerClass("Mscrm.SystemUserActions");Mscrm.EntitlementActions.registerClass("Mscrm.EntitlementActions");Mscrm.GridRibbonActions.registerClass("Mscrm.GridRibbonActions");Mscrm.RibbonActions.registerClass("Mscrm.RibbonActions");Mscrm.XrmRibbonActionUtilities.registerClass("Mscrm.XrmRibbonActionUtilities");Mscrm.ExportGridToExcel.registerClass("Mscrm.ExportGridToExcel");Mscrm.DashboardRibbonActions.registerClass("Mscrm.DashboardRibbonActions");Mscrm.DashboardEditorRibbonActions.registerClass("Mscrm.DashboardEditorRibbonActions");Mscrm.PrintFromGrid.registerClass("Mscrm.PrintFromGrid");Mscrm.RunReportFromGrid.registerClass("Mscrm.RunReportFromGrid");Mscrm.UserQueryActions._queryTargetTypeCode=Mscrm.EntityTypeCode.None;Mscrm.UserQueryActions.$8=null;Mscrm.IncidentActions.$H="{4a63c8d1-6c1e-48ec-9db4-3e6c7155334c}";Mscrm.EntitlementActions.$Y=-1;Mscrm.DashboardRibbonActions.$4=null;Mscrm.DashboardRibbonActions.$C="/main.aspx?pagetype=dashboardeditor";Mscrm.DashboardRibbonActions.$E=window.screen.availWidth*.9;Mscrm.DashboardRibbonActions.$D=window.screen.availHeight*.9